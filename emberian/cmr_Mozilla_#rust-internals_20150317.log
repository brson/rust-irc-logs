[00:00:09] <Manishearth> arielb1: yeah, that's what I meant by a MWE
[00:00:30] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Connection closed)
[00:01:36] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[00:02:56] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[00:06:48] *** Quits: jxv (jxv___@moz-qneod7.pk6i.d98i.030a.2602.IP) (Connection closed)
[00:07:06] <eddyb> nrc: you know what's interesting... ty::unsize_ty does this work of creating a new type from instructions... but we always know the new type :|
[00:09:07] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[00:09:25] <eddyb> nrc: the only mildly useful thing would be a field "path" in the case of UnsizeStruct
[00:09:43] <eddyb> nrc: I gtg to sleep though, I'll continue tomorrow
[00:10:52] *** Quits: joneshf-laptop (joneshf@moz-4olupj.ucdavis.edu) (Ping timeout: 121 seconds)
[00:13:42] *** Quits: James (quassel@moz-t5os7p.range86-163.btcentralplus.com) (Ping timeout: 121 seconds)
[00:19:35] *** Quits: arielb1 (Ariel@moz-fvcu0s.red.bezeqint.net) (Quit: Ex-Chat)
[00:19:47] *** Joins: jamwt (jamwt@moz-noo6hc.jamwt.com)
[00:20:41] <jamwt> hey all.. getting a fun LLVM internals issue
[00:20:43] <jamwt> rustc: /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/llvm/include/llvm/IR/Instructions.h:1001: void llvm::ICmpInst::AssertOK(): Assertion `(getOperand(0)->getType()->isIntOrIntVectorTy() || getOperand(0)->getType()->isPtrOrPtrVectorTy()) && "Invalid operand types for ICmp instruction"' failed.
[00:36:04] *** Joins: jgallagher (john@moz-6ge.dhn.131.24.IP)
[00:37:40] <cmr> jamwt: can you get a backtrace?
[00:38:11] <jamwt> using RUST_BACKTRACE ?  or using gdb ?
[00:38:20] <jamwt> RUST_BACKTRACE does nothing, it seems
[00:38:38] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[00:38:39] <jamwt> I also tried --emit=llvm-ir, but it fails on that assertion before any IR is printed
[00:39:56] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[00:40:20] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:42:03] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[00:43:16] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[00:43:17] <jamwt> cmr: https://gist.github.com/jamwt/7507c2b1e2cd00af34d7
[00:46:50] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[00:47:28] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[00:47:34] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[00:53:37] *** Quits: mib_h5mizm (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:53:55] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[00:56:05] <rprichard> acrichto: I think this commit (https://github.com/rprichard/rust/commit/87d15c43ba32d274f12a815c79e48cc70eb4dc87) will fix the Linux build failure. I'm waiting for several builds to finish to test the idea (including two without my change).
[00:56:11] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[00:57:48] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:58:31] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:59:03] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:02:07] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[01:03:21] <acrichto> rprichard: hm, looks plausible!
[01:03:34] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:04:12] <rprichard> One of my builds finished; I reproduced the problem by omitting -j from make and building both 32-bit and 64-bit hosts.
[01:04:48] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:06:28] <acrichto> hm interesting, my build doing that hasn't finished yet
[01:06:31] <acrichto> but it didn't hit a bug anywehre
[01:07:19] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[01:12:40] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[01:12:57] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:20:44] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:21:04] <brson> here's an example of the kind of report i'm generating for crate regression testing https://gist.github.com/brson/9b097289efe6e8e094da
[01:21:33] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:22:33] <acrichto> brson: whoa nice!
[01:22:45] <acrichto> are the crates gonna be clickable to logs?
[01:24:13] <brson> acrichto: yes
[01:24:17] <acrichto> nice
[01:25:39] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[01:27:31] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[01:29:42] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[01:34:39] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:35:41] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:36:27] *** Quits: osa1_ (omer@moz-o4q.6no.54.68.IP) (Ping timeout: 121 seconds)
[01:36:47] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[01:39:27] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[01:40:20] *** Quits: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com) (Quit: )
[01:45:56] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:46:36] <jamwt> any logging I could enable to figure out exactly what is attempting to be translated when that LLVM assert kicks in?
[01:47:03] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:47:38] <reem> turning on logging in trans can cause explosive amounts of output, so be careful
[01:50:01] *** Joins: Florob_ (Florob@moz-je09t8.de)
[01:50:02] *** Quits: Florob_ (Florob@moz-je09t8.de) (Quit: leaving)
[01:50:24] <jamwt> yeah, I did that, and actually it caused some other ICE to happen.. :-(
[01:50:34] <jamwt> seemingly when it was trying to stringify some type
[01:50:43] <jamwt> bounds check
[01:58:45] *** Quits: swgillespie (swgillespie@moz-upj.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:02:43] <rprichard> I've been having this intermittent problem where libstd-XXX.rlib lists collections as the first dependency rather than core (according to rustc -Z ls). Normally, core is first. It breaks test/compile-fail/method-suggestion-no-duplication.rs.
[02:02:59] <rprichard> Has anyone else seen this?
[02:04:42] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Connection closed)
[02:04:55] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[02:05:15] <rprichard> It seems to only happen when I cross-compile to i686-unknown-linux-gnu.
[02:06:02] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[02:06:11] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[02:06:17] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[02:16:00] *** Joins: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP)
[02:16:08] *** Quits: ytain (ytain@moz-44k.q8p.140.24.IP) (Quit: Textual IRC Client: www.textualapp.com)
[02:17:01] *** Joins: brson (brson@moz-ncl.7vl.56.172.IP)
[02:17:02] *** ChanServ sets mode: +o brson
[02:19:08] <cmr> So today I was pleased to discovered we live in a brave new UFCS future.
[02:19:26] <cmr> when I did V::Foo::bar() with an associated typed
[02:19:49] <Yurume> does it work out of the box? great.
[02:19:55] <cmr> yup!
[02:20:17] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[02:20:51] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[02:21:37] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[02:23:12] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[02:35:30] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[02:36:00] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[02:37:45] *** Joins: reem (reem@moz-dfnrsi.coob.q2h1.0009.2601.IP)
[02:40:17] *** Joins: dpc (dpc@moz-a8v.6sn.162.73.IP)
[02:55:39] *** Quits: arrrrrrrrr (arrrrrrrrs@moz-69t4ps.dynamic.qsc.de) (Ping timeout: 121 seconds)
[03:02:32] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[03:05:40] *** Quits: ^BR (br@moz-egk.dm6.194.78.IP) (Client exited)
[03:07:18] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[03:07:26] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[03:07:41] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[03:09:41] *** Joins: ^BR (br@moz-egk.dm6.194.78.IP)
[03:15:31] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[03:21:06] *** sunfish is now known as sunfish-away
[03:26:34] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[03:33:08] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:33:50] <erickt> kmc / sfackler / burntsushi: I've been doing a lot of work on my ast builder if you've got interest in using it: https://github.com/erickt/rust-aster
[03:34:48] <erickt> also https://github.com/erickt/rust-quasi. I've just recently landed porting serde away from using the syntax::ext::generic to it, and imo it's much easier to write syntax extensions in it
[03:35:03] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[03:35:50] *** Quits: kimundi (kimundi@moz-vchv39.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:36:08] <nrc> erickt: how is your rust-quasi different from the existing quasi-quoter?
[03:36:38] <erickt> nrc: not too much at the moment beyond being also ported to aster
[03:36:42] <kmc> bstrie: ^
[03:36:48] <kmc> we were talking today about fuzzing rustc
[03:36:50] *** Joins: kimundi (kimundi@moz-8ivgis.dip0.t-ipconnect.de)
[03:37:00] <kmc> and using the improved astbuilder for that
[03:37:18] <erickt> nrc: I've been doing some small fixes that I've been syncing upstream
[03:37:20] <nrc> erickt: the `.add().u32(1).u32(2);` example looks nice!
[03:37:25] <erickt> :)
[03:37:45] <nrc> does it scale well to larger expressions? Or like items?
[03:37:51] <Murarth> So, the IpAddr type is private now?
[03:38:28] <huon> erickt: very nice :)
[03:38:34] <erickt> nrc: it does support making a handful of itmes
[03:39:06] <huon> erickt: (btw, the doc link seems to be dead http://erickt.github.io/rust-aster/ ?)
[03:39:11] <erickt> here's my serde code that works pretty well https://github.com/erickt/rust-serde/blob/master/serde_macros/src/de.rs
[03:39:31] <erickt> yeah! I know I wanted to bug hoverbear today on why his doc guide wasn't working for me :(
[03:40:16] <erickt> I wonder if project specific sites doesn't play well with my top-level erickt.github.io site
[03:40:25] <huon> it works for me
[03:40:34] <huon> (at least, something similar to what you hvae, not precisely the same)
[03:41:18] *** kimundi is now known as zz_kimundi
[03:41:25] <erickt> hm
[03:41:31] <huon> oh, right: http://erickt.github.io/rust-aster/aster/index.html
[03:41:37] <huon> there's an extra rust- in the URL
[03:41:42] <erickt> oh!
[03:41:52] <huon> I guess https://github.com/erickt/rust-aster/blob/master/.travis.yml#L9 needs to be adjusted
[03:42:45] <erickt> thanks!
[03:42:49] <erickt> I was so confused
[03:45:14] <nrc> nice!
[03:45:39] <erickt> huon: I fixed the link while I figure out how to fix travis :) now I just need to add documentation
[03:47:24] <huon> erickt: maybe we should just forget this discussion so you have an excuse for not documenting...
[03:47:25] <huon> :P
[03:47:33] <erickt> haha
[03:48:08] <erickt> nrc: ultimately with quasi I was hoping to see if I could things like get rid of the cx in `quote_expr!(cx, ...)`
[03:48:14] *** zz_kimundi is now known as kimundi
[03:48:31] <erickt> also it was a nice stress test for aster
[03:49:41] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[03:52:05] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[03:52:16] *** Quits: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP) (Ping timeout: 121 seconds)
[03:54:04] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Quit: WeeChat 1.1.1)
[03:54:46] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[03:55:29] <huon> nrc: ping
[03:55:46] <nrc> huon: pong
[03:56:23] <huon> nrc: I'm going to try to setup an instance of highfive for my own repos, any tricks/tips?
[03:56:46] <nrc> hmmm
[03:57:10] <nrc> not really, it should be pretty straightforward - just duplicate the GH hook
[03:57:30] <nrc> configuring apache was the most annoying bit, but I don't think I can remember the ins and outs of that
[03:57:39] <huon> oh, hm
[03:58:38] <nrc> there needs to be a config file which is not in the repo
[03:59:00] <nrc> it looks like:
[03:59:04] <nrc> [github]
[03:59:05] <nrc> user = rust-highfive
[03:59:07] <nrc> password = ...
[03:59:08] <nrc> token = ...
[03:59:11] <nrc> with ... obviously replaced
[03:59:18] <nrc> but I don't think you even need the password
[03:59:29] <nrc> just the token you generate for the user
[03:59:48] <nrc> (if it does need the password, then we should change highfive)
[04:01:11] <huon> ok, great
[04:01:41] <huon> what's apache being used for?
[04:01:53] <nrc> running the web server
[04:01:56] <huon> oh, are they run as *CGI?
[04:02:04] <nrc> yeah
[04:02:13] <huon> ok
[04:02:16] <nrc> (the newpr one)
[04:02:18] <XMPPwocky> i wonder if it'd be possible to patch rustc-resolve to spit out everything you can do with a particular type
[04:02:21] <XMPPwocky> and feed that to rustdoc
[04:02:40] <nrc> most of the other highfive things run on node.js
[04:02:49] <nrc> but newpr is a cgi script
[04:03:15] <huon> nrc: ok
[04:03:18] <huon> nrc: thanks
[04:03:22] <nrc> np
[04:03:56] <nrc> XMPPwocky: you don't know that at the resolve stage, you need to run trait matching first
[04:04:06] <nrc> but the general idea is a fine one
[04:04:28] <nrc> you could probably add that info to the save-analysis dump without too much bother
[04:04:52] *** Joins: quantheory (quantheory@moz-m50t2f.44nj.jtvf.0001.2601.IP)
[04:05:14] <nrc> (I think rustdoc should run off save-analysis, but it is a huge job to convert it)
[04:11:01] <XMPPwocky> would also be exceedingly handy for autocomplete / IDEs
[04:14:05] <nrc> yes, it would
[04:14:36] <nrc> I want to make save-analysis available as an API for that kind of use case
[04:22:52] *** Quits: brson (brson@moz-ncl.7vl.56.172.IP) (Ping timeout: 121 seconds)
[04:24:12] <richo> are there helpers for the various types in libsyntax? eg, matching on a &syntax::ptr::P<syntax::codemap::Spanned<syntax::ast::Stmt_>> that I got from an Item is going to be a lot of typing
[04:27:34] *** Joins: semarie (semarie@moz-1jo0ne.badexample.net)
[04:38:05] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (Connection closed)
[04:38:57] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[04:42:25] *** Quits: reem (reem@moz-dfnrsi.coob.q2h1.0009.2601.IP) (Connection closed)
[04:44:24] <jamwt> okay, think I figured it out.. gonna try to replicate it in the playpen
[04:46:43] <huon> richo: I believe it should just be `foo.node`?
[04:49:03] <jamwt> boom
[04:49:08] <jamwt> http://is.gd/yYChkD
[04:49:34] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:51:32] <richo> yeah thanks huon, I just worked that out too
[04:51:36] <richo> I should really fix my racer install
[04:51:57] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (Connection closed)
[04:52:10] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[04:55:11] <jamwt> cmr: fyi, following up on my LLVM assert earlier.. http://is.gd/yYChkD
[04:55:15] <jamwt> I'll file a bug
[04:56:47] <huon> nrc: do you have a script for setting webhooks?
[04:59:04] <Luqman> jamwt: hmm, cc me on that bug (luqmana on github)
[05:00:02] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[05:03:18] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[05:03:31] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[05:04:12] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[05:04:45] <bstrie> wow, so strings are ordered. is that well-defined in UTF-8, or do we do some normalizing implicitly
[05:05:51] <huon> UTF-8 has a single encoding of each code-point, so yes, it's well defined
[05:12:55] <bstrie> huon: okay, so we don't do any normalizing then and just store codepoints as we receive them? so a string key of a U followed by a combining umlaut would not collide with a string key of a U-with-umlaut?
[05:15:23] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[05:15:25] <quantheory> If we want to conserve information while reading and writing valid UTF-8, it's hard to imagine a good alternative.
[05:16:13] <bstrie> I'm not criticizing, just curious about the implementation details
[05:17:41] <quantheory> Oh, don't get me wrong. Honestly, I'm in one of those lines of software work where Unicode is almost totally irrelevant. I just find it hard to picture doing normalization for something that could be "zero-cost".
[05:17:58] <quantheory> The OsStr representations were controversial enough as-is.
[05:20:24] <bstrie> I look forward to one day having a supplemental unicode lib that lets us variously normalize or location-aware-collate on-demand
[05:21:33] <quantheory> Indeed.
[05:25:09] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[05:26:57] *** Quits: O01eg (o01eg@moz-sok.5l5.112.37.IP) (Client exited)
[05:28:01] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[05:32:07] *** Quits: ^BR (br@moz-egk.dm6.194.78.IP) (Client exited)
[05:37:50] <huon> bstrie: we don't do any normalisation automatically
[05:46:16] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Connection closed)
[05:48:11] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[05:48:28] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[05:48:51] *** Quits: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[05:53:09] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[05:56:06] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[06:00:47] *** Joins: jmitchell (textual@moz-o8p.pug.156.104.IP)
[06:01:05] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[06:08:34] *** Quits: xilec (Mibbit@moz-g6k.oht.161.46.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:11:06] *** Joins: kushal (kdas@moz-0mh.qv9.142.202.IP)
[06:11:15] *** Quits: jmitchell (textual@moz-o8p.pug.156.104.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:12:48] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[06:14:05] *** Joins: grant ({0}grant@moz-63ubas.in.charter.com)
[06:15:00] *** grant is now known as {0}grant
[06:16:23] *** Quits: {0}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[06:16:39] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[06:16:50] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[06:16:58] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[06:18:00] *** Joins: mib_fy63d5 (Mibbit@moz-juv.9o3.252.72.IP)
[06:23:07] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[06:23:45] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[06:25:31] *** Quits: mib_fy63d5 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:26:55] *** Joins: mib_tu8wk7 (Mibbit@moz-juv.9o3.252.72.IP)
[06:27:20] *** Quits: quantheory (quantheory@moz-m50t2f.44nj.jtvf.0001.2601.IP) (Quit: Leaving)
[06:27:20] *** Quits: mib_tu8wk7 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:27:39] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[06:30:09] <huon> nrc: \o/ https://github.com/huonw/simple_parallel/pull/3#issuecomment-82146673
[06:31:02] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[06:37:20] <theme> I hope that this is the nail in the coffin for all major counterarguments to my RFC
[06:37:21] <theme> https://github.com/rust-lang/rfcs/pull/956#issuecomment-82149001
[06:37:48] *** Quits: dpc (dpc@moz-a8v.6sn.162.73.IP) (Ping timeout: 121 seconds)
[06:39:07] <theme> reem, Gankro, any comments?
[06:39:38] <reem> theme: I'm not convinced by that code sample.
[06:39:44] <theme> why?
[06:40:02] <theme> It's from gcc
[06:40:03] <reem> theme: Nobody is saying that no code *can* be written which has bad behavior under these cases
[06:40:18] <theme> reem, my point is that doing that has a performance penalty
[06:40:27] <reem> I'm sure there are *tons* of things in the gcc codebase which would be really bad rust
[06:40:28] <theme> and the standard library should be as fast as possible
[06:40:46] <theme> sorting is the bottleneck of just too many things
[06:41:29] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[06:41:29] <Mutabah> theme: Incorrect behavior is expected when you incorrectly implement comparison traits.
[06:41:54] <Mutabah> As long as the std code doesn't crash, it should be valid
[06:42:22] <Mutabah> (I.e. if code incorrectly implements PartialOrd, std still should crash. It's free to return garbage data or panic)
[06:43:12] <reem> Mutabah: It should not cause memory unsafety
[06:43:12] <theme> Mutabah, the problem is that the gcc implementation (which I believe is one of the fastest implementations) segfaults on incorrect comparisons
[06:43:22] <theme> and *that* is unsafe
[06:43:29] <theme> segfault, not panic
[06:43:29] *** Quits: njn (chatzilla@moz-gok.4b2.214.203.IP) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0a1/20150315153114])
[06:43:38] <reem> theme: IMO a sort routine which causes segfaults when comparisons go awry is not rusty code
[06:43:45] <reem> but that's sort of the point of the whole RFC
[06:43:48] <reem> so that's not really an argument
[06:44:01] <theme> reem, so... you want a suboptimal sort?
[06:44:13] <Mutabah> theme: A checked sort, not suboptimal
[06:44:25] <theme> Mutabah, checked translates to slow
[06:44:29] <Mutabah> I.e. one that does basic bounds checking (which can be easily predicted by the CPU at runtime)-
[06:45:39] <reem> theme: If you show me two idiomatic rust sorting implementations, and one of them segfaults on bad comparisons and is actually faster than one which doesn't, that would go a long way to convincing me.
[06:45:49] <theme> hmm
[06:45:51] <reem> and sorting is the most direct case
[06:45:57] <reem> other code is going to be slowed down even less
[06:46:13] *** Joins: miselin (miselin@moz-c77.igu.11.203.IP)
[06:47:33] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[06:52:34] <theme> seriously, wtf
[06:52:55] <theme> Nobody cared to profile the speed difference in relying on strict weak ordering in C++?
[06:54:37] *** Joins: wipplerscs (Mibbit@moz-juv.9o3.252.72.IP)
[06:56:01] <reem> theme: It's also of much higher relevance to see how rust and rustc compile the code.
[06:56:20] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[06:57:01] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:57:39] <theme> reem, I think that looking at C++ is more revalent
[06:58:03] <theme> since gcc's optimization is sort of what we might expect from a future rustc
[06:59:02] <reem> maybe
[06:59:23] <reem> I'd still be way more convinced by rust, which is pervasively safe instead of like C or C++, which is pervasively unsafe.
[06:59:59] *** Quits: wipplerscs (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:00:20] *** Joins: lfairy (lfairy@moz-kv8hut.vf.net.nz)
[07:02:37] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[07:03:38] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[07:04:27] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[07:07:26] *** Quits: det (chris@moz-7bbmke.lv.cox.net) (Ping timeout: 121 seconds)
[07:10:42] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:11:28] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[07:13:45] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Connection closed)
[07:14:06] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[07:15:57] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[07:16:26] *** Joins: dinfuehr_ (dinfuehr@moz-sb03m1.highway.telekom.at)
[07:17:19] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[07:18:23] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Ping timeout: 121 seconds)
[07:20:18] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[07:20:32] *** Quits: dinfuehr_ (dinfuehr@moz-sb03m1.highway.telekom.at) (Ping timeout: 121 seconds)
[07:21:30] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Connection closed)
[07:21:51] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[07:22:30] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[07:22:30] *** ChanServ sets mode: +o nrc
[07:23:02] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:23:03] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[07:23:06] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Connection closed)
[07:23:30] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[07:23:44] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[07:23:47] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:26:03] *** Quits: untitaker (untitaker@moz-1nefhg.highway.telekom.at) (Ping timeout: 121 seconds)
[07:28:05] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[07:28:25] *** Quits: lfairy (lfairy@moz-kv8hut.vf.net.nz) (Ping timeout: 121 seconds)
[07:30:29] *** Joins: lfairy (lfairy@moz-kv8hut.vf.net.nz)
[07:31:04] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[07:31:15] *** Joins: untitaker (untitaker@moz-kp2con.highway.telekom.at)
[07:36:01] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Ping timeout: 121 seconds)
[07:36:55] *** Quits: lfairy (lfairy@moz-kv8hut.vf.net.nz) (Connection closed)
[07:39:48] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Ping timeout: 121 seconds)
[07:44:14] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[07:48:03] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[07:54:02] *** Quits: eddyb (eddyb@moz-l1n.kjd.26.188.IP) (Ping timeout: 121 seconds)
[08:00:05] *** Quits: sprang (sprang@moz-bll05b.zoominternet.net) (Ping timeout: 121 seconds)
[08:02:31] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[08:05:30] <zwarich> reem: radix sort is OP anyways
[08:06:02] <zwarich> and you can radix sort arbitrary polynomial datatypes
[08:06:21] <reem> it's not fair to all the other sorting algorithms
[08:09:48] <huon> nrc: Gankro: barosl: I wrote some scripts for webhooks etc.: https://github.com/huonw/repo-admin
[08:11:15] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[08:11:35] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[08:14:20] <zwarich> but is there any reason to believe that in-place qsort is any slower because of this?
[08:14:36] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[08:14:38] <zwarich> err the in-place partition in qsort
[08:16:00] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[08:17:02] <zwarich> one could argue that the default sort should be both stable and in-place (to avoid blowing the stack on carefully chosen input)
[08:17:40] <huon> by in-place you mean non-recursive?
[08:18:16] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[08:18:39] <huon> fwiw, Rust's builtin sort is stable, out-of-place (allocates a chunk of memory), non-recursive
[08:18:41] <zwarich> huon: constant additional space
[08:19:00] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[08:19:17] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[08:19:56] <huon> zwarich: right, but you can have non-constant additional space without blowing the stack?
[08:20:27] <zwarich> huon: I'd go further and say you can't have that either, but I guess it's okay
[08:20:36] <zwarich> afaik the only stable sorts with O(1) extra space and asymptotically optimal time behavior are variants of merge and radix sort
[08:20:48] <zwarich> and I doubt you'd want either for a std lib
[08:21:01] <huon> zwarich: doing an allocation can be considered blowing the stack?
[08:21:35] <zwarich> huon: in a systems language you often want to be able to sort without heap allocation
[08:22:30] <zwarich> I guess I forgot that Rust's current sort does that :P
[08:22:40] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[08:23:31] *** Joins: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de)
[08:24:12] <reem> iirc libcore provides a non-allocating sort for slices
[08:24:36] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[08:26:19] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[08:26:46] *** Joins: det (chris@moz-7bbmke.lv.cox.net)
[08:27:23] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[08:28:53] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[08:29:20] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[08:29:20] *** ChanServ sets mode: +o pcwalton
[08:31:47] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[08:32:18] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[08:34:30] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[08:35:48] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[08:36:06] <Manishearth> Gankro: around?
[08:36:28] <Manishearth> actually nvm
[08:38:11] <huon> zwarich: yes, I agree, but blowing the stack is something specific?
[08:38:24] <huon> (i.e. using too much stack space)
[08:40:06] <zwarich> huon: well, blowing the stack is probably more likely to cause an unrecoverable failure than allocation
[08:40:35] *** Joins: dinfuehr (dinfuehr@moz-fqa45o.public.telering.at)
[08:41:15] <zwarich> huon: eventually some recursive C/C++ programs that handle arbitrary data implement their own stack overflow checking
[08:43:22] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[08:44:02] *** Quits: dinfuehr (dinfuehr@moz-fqa45o.public.telering.at) (Connection closed)
[08:45:03] *** Joins: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net)
[08:45:32] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[08:47:39] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[08:48:32] *** Quits: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[08:49:22] <bluss> I thought that rust's sort allocates
[08:50:23] <theme> bluss, it does
[08:50:33] <bluss> only avoids it for short slices
[08:51:17] <barosl> huon, That's great, are you planning to add the Travis support too?
[08:51:53] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[08:51:53] *** ChanServ sets mode: +o pcwalton
[08:52:13] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[08:52:57] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[08:52:57] *** ChanServ sets mode: +o pcwalton
[08:55:37] *** Joins: imperio (Mibbit@moz-opqtbe.abo.bbox.fr)
[08:55:52] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[08:59:48] *** Quits: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de) (Connection closed)
[09:00:14] *** Joins: killercup (killercup@moz-7hemed.wlan.uni-bonn.de)
[09:00:31] *** Quits: Kxepal (Miranda@moz-og7jv6.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[09:01:59] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:02:17] *** Quits: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net) (Quit: )
[09:02:36] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[09:03:06] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[09:03:57] <theme> How many percent slower would you think I can call "significantly slower"?
[09:04:19] <theme> I'm profiling a program to make an argument supporting an RFC
[09:04:36] <imperio> I guess from 20%, it's a "lot" more slow
[09:04:44] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[09:05:40] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[09:06:40] <Mutabah> theme: 5% (I think that's the classic level for statistical significance)
[09:06:40] *** Quits: killercup (killercup@moz-7hemed.wlan.uni-bonn.de) (Connection closed)
[09:06:48] *** Joins: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de)
[09:06:56] <Mutabah> theme: make sure to run sufficiently long/large tests to prove the difference
[09:07:31] *** Joins: zmack (zmack@moz-1oe.89t.76.82.IP)
[09:09:17] * theme increases the benchmark size
[09:10:10] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[09:10:17] <theme> Now I have a 40 MB array -_-
[09:10:44] <theme> I only have to run `cargo bench` once, right?
[09:10:51] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[09:12:16] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[09:12:43] <Mutabah> theme: Run it multiple times, there may be noise
[09:17:46] *** Joins: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP)
[09:18:33] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[09:26:08] *** Quits: det (chris@moz-7bbmke.lv.cox.net) (Ping timeout: 121 seconds)
[09:29:08] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[09:29:36] <theme> Mutabah, why do I have to run it multiple times?
[09:29:37] * Mutabah is away (Screen Detached)
[09:29:45] <theme> -_-
[09:30:25] <imperio> theme: to have more precise results. Like he said, there may be noise
[09:30:46] <theme> I thought that cargo bench already does that
[09:31:06] <theme> and if an iteration is longer, does cargo bench run less iterations?
[09:31:40] <imperio> sorry but I don't know about that...
[09:34:41] <theme> Is 0.8 seconds per iteration too high or too low?
[09:34:41] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[09:34:44] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[09:35:19] <theme> the two versions I am benchmarking have a difference of 0.06 seconds
[09:36:08] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[09:36:12] <imperio> I think it's too little...
[09:36:33] <imperio> can't you make longer tests ?
[09:36:42] <imperio> the longer the better for me
[09:36:44] <theme> I'm sorting 40 MB arrays now...
[09:36:58] <imperio> well
[09:37:03] <imperio> try with 400 then =D
[09:37:11] <theme> Maybe I should change from u32 to u8...
[09:41:06] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[09:44:06] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Quit: Leaving)
[09:46:22] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[09:50:58] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[09:50:58] *** ChanServ sets mode: +o nrc
[09:55:47] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:58:44] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Connection closed)
[09:59:51] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[10:03:31] *** Joins: arrrrrrrrr (arrrrrrrrs@moz-69t4ps.dynamic.qsc.de)
[10:04:23] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[10:04:37] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[10:04:46] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[10:06:32] *** Joins: det (chris@moz-2pbdg1.lv.cox.net)
[10:11:47] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[10:16:12] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[10:16:52] <theme> I'm back with profiling results!
[10:17:07] <theme> I'm not sure whether I did something wrong, but I got a 15% difference!
[10:19:25] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[10:20:15] *** Quits: Skyler (Skyler@moz-e93b35.sd.cox.net) (Client exited)
[10:22:20] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[10:25:45] <imperio> that's something !
[10:25:54] <theme> Mutabah, still there?
[10:25:56] *** Quits: kushal (kdas@moz-0mh.qv9.142.202.IP) (Ping timeout: 121 seconds)
[10:28:55] <Mutabah> yes
[10:29:23] <Mutabah> Not really my call to make if that is significant enough
[10:29:23] <theme> Mutabah, I got 15% difference in running time
[10:29:58] * theme is creating a gist
[10:33:01] *** Joins: kushal (kdas@moz-dbin9j.202.sitibroadband.in)
[10:37:34] *** Joins: Skyler (Skyler@moz-e93b35.sd.cox.net)
[10:39:01] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[10:51:09] <theme> Here is my results and code https://github.com/rust-lang/rfcs/pull/956#issuecomment-82267862
[10:53:59] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[10:58:31] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[10:59:31] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[11:03:37] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Ping timeout: 121 seconds)
[11:04:33] *** Joins: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com)
[11:04:59] *** Joins: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net)
[11:05:40] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[11:07:49] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[11:11:03] *** Joins: eddyb (Mibbit@moz-gua2rr.lbi.ro)
[11:11:32] *** Joins: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com)
[11:12:09] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[11:15:46] <imperio> btw, is there a particular reason that two entry in the same Enum can't have the same value ?
[11:16:40] <eddyb> imperio: enum variants are supposed to be distinct
[11:17:05] <eddyb> doener: are you around? I'm seeing a failure I can't reproduce https://github.com/rust-lang/rust/pull/23376
[11:17:27] <eddyb> doener: I'm wondering if nopt-t means tests are ran without optimizations... should I try to do that?
[11:17:42] <imperio> eddyb: a lot of C enums don't agree. When binding, it's really problematic
[11:18:16] <eddyb> imperio: C enums are not Rust enums
[11:18:26] <eddyb> imperio: use bitflags! or just constants
[11:18:41] <eddyb> doener: nope, CNR even without optimizations
[11:18:56] <eddyb> doener: this better not be OSX being broken again
[11:19:04] <eddyb> quality software
[11:19:22] <eddyb> that reminds me we never reported the linker bug
[11:19:51] <imperio> is it possible to group constants in a same "type" ?
[11:19:52] <eddyb> imperio: I think bindgen just outputs constants
[11:20:14] <imperio> eddyb: I never succeed to compile it so I don't know...
[11:24:52] *** Quits: eddyb (Mibbit@moz-gua2rr.lbi.ro) (Quit: http://www.mibbit.com ajax IRC Client)
[11:34:42] *** Joins: arielb1 (Ariel@moz-fvcu0s.red.bezeqint.net)
[11:34:42] *** Quits: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[11:34:51] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[11:37:43] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[11:40:39] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[11:42:07] <Manishearth> bah there is no eddyb
[11:43:20] <Manishearth> who else has agood knowledge of the AST?
[11:43:27] <Manishearth> need feedback on a PR
[11:48:08] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[11:52:03] *** Joins: cmr|mib (Mibbit@moz-t37.gf6.5.96.IP)
[11:52:40] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[11:58:53] <Manishearth> munksgaard: btw, https://github.com/rust-lang/rust/pull/23428 might be useful for you
[11:59:54] <munksgaard> Manishearth: Ah, very nice! 
[12:00:04] * theme loves comments
[12:00:34] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[12:00:38] <munksgaard> I've been considering doing something similar myself, just haven't gotten around to it :)
[12:01:09] *** Joins: eibwen (eibwen@moz-p2t07k.dip0.t-ipconnect.de)
[12:01:13] <theme> What is the latest nightly?
[12:01:46] *** Joins: ytain (ytain@moz-44k.q8p.140.24.IP)
[12:01:59] <theme> playbot, VERSION
[12:02:00] -playbot- "rustc 1.0.0-nightly (30e1f9a1c 2015-03-14) (built 2015-03-15)"
[12:02:04] <theme> looks wrong ^
[12:06:47] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Ping timeout: 121 seconds)
[12:07:05] <arrrrrrrrr> >It's likely that benchmarking will not be stable for 1.0. The good news is you only need it for tests though!
[12:07:12] <arrrrrrrrr> the nerve on this guy
[12:07:23] <arrrrrrrrr> *of
[12:07:44] <Manishearth> munksgaard: this was on my todo list for months
[12:12:55] <theme> Why don't we define Sync as `impl<T> Sync for T where &T: Send`?
[12:15:00] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[12:18:38] <cmr|mib> aturon: nmatsakis: While Self is now allowed to appear in trait implementations, it cannot be used to qualify associated items for the trait being implemented. Is this intentional?
[12:19:02] <cmr|mib> (That is, you need to use the <Self as Trait>::Foo syntax)
[12:21:05] *** Joins: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at)
[12:21:28] <kimundi> theme: because thats the wrong direction?
[12:21:39] <kimundi> theme: As in, that would be wrong
[12:21:51] <kimundi> oh wait
[12:21:55] <kimundi> now i see what you mean
[12:22:08] <kimundi> hmm
[12:23:16] <kimundi> theme: Interesting idea, you might want to open an RFC-repo issue with that idea and an explanation of how it would improve matters
[12:23:42] <kimundi> theme: (How would it improve matters, btw?)
[12:24:07] <huon> theme: how do you write the implementation of `Send` for `&T`?
[12:24:43] <huon> theme: specifically: https://github.com/rust-lang/rust/blob/master/src/libcore/marker.rs#L408
[12:25:09] <theme> hmm
[12:26:03] <theme> huon, instead of implementing Sync for T, you implement Send for &T
[12:26:36] <theme> When I think about implementing Sync and Send, I always translate "T implements Sync" to "&T implements Send"
[12:27:05] <theme> kimundi, I'm just asking
[12:27:11] <theme> not sure which is better
[12:27:53] <theme> wait a sec
[12:28:11] <theme> huon, `unsafe impl<'a, T: Sized> Send for &'a T where T: Sync {}`
[12:28:24] <theme> huon, `unsafe impl<'a, T: Sized> Send for &'a T where &T: Send {}`
[12:28:28] <theme> Does that work?
[12:28:35] <theme> not sure about coherence
[12:28:43] <huon> no, that won't work
[12:28:48] <theme> nvm
[12:28:59] <huon> well, `Send for &'a T where &T: Send` is pointless
[12:29:01] <theme> huon, "instead of implementing Sync for T, you implement Send for &T"
[12:29:10] <huon> but yeah, that approach may work :)
[12:29:14] * theme just got confused by the PhantomData above for no reason
[12:29:48] <theme> How does default traits go with that?
[12:29:59] <theme> Or is this idea broken?
[12:38:22] *** Joins: eddyb (eddyb@moz-l1n.kjd.26.188.IP)
[12:40:40] *** Quits: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de) (Quit: Bye)
[12:40:49] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[12:41:40] *** Quits: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com) (Ping timeout: 121 seconds)
[12:42:17] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[12:46:52] <doener> eddyb: I wish that was using assert_eq :-(
[12:47:11] <eddyb> doener: that's what I did locally when I fixed it (big surprise, 0)
[12:47:47] <doener> eddyb: oh! what was the problem?
[12:47:48] <eddyb> doener: it was caused by
[12:47:50] <eddyb> wtf
[12:47:56] <cmr|mib> In the past I did a huge find-replace for assert!(a == b) to replace with assert_eq!(a, b), someone should do one again.
[12:47:57] <eddyb> doener: PEBKAC
[12:48:09] <cmr|mib> Doesn't always work, but usually doe.
[12:48:10] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[12:48:16] <eddyb> doener: I never pushed the fixed version :|
[12:48:28] <doener> heh
[12:48:31] <eddyb> doener: I was looking in gitk to make sure I didn't forget to put the changes in the commit
[12:49:01] <eddyb> doener: I wouldn't have figured it out if I didn't try to link you to https://github.com/rust-lang/rust/pull/23376/files#diff-20958e65a2c7470dce572c38cd80cb3eR471
[12:49:27] <eddyb> doener: the type_is_structural condition is gone from my version of that commit
[12:54:19] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[12:55:26] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[12:57:11] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[12:59:44] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[13:02:50] *** Joins: c0170_ (c0170@moz-bb29a4.cambridge.arm.com)
[13:03:32] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[13:05:14] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[13:07:58] *** Joins: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de)
[13:08:22] <arrrrrrrrr> why is &[u8] passed by reference?
[13:09:34] <eddyb> arrrrrrrrr: because of how inflexible trans has grown to be
[13:09:48] <arrrrrrrrr> solution: add an extern "C"
[13:09:56] <eddyb> wat
[13:10:06] <eddyb> &[T] is not defined in any C ABI
[13:10:07] <arrrrrrrrr> if you add extern "C", it's passed by value
[13:10:13] <arrrrrrrrr> I'm just telling you how it is
[13:10:36] <eddyb> arrrrrrrrr: that's the *completely separate* FFI implementation doing something *arbitrary* for a case it doesn't support
[13:10:37] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[13:10:56] <eddyb> arrrrrrrrr: doener is working on passing large function arguments in multiple pointer-sized arguments, AFAIK
[13:10:58] <arrrrrrrrr> &[T] is just a struct with two fields and the struct is even marked repr(C), so
[13:11:03] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[13:11:05] <eddyb> but we would still use allocas inside a function :(
[13:11:09] <eddyb> arrrrrrrrr: no it's not
[13:11:22] <eddyb> the struct is just a mirror, it's not used by the compiler
[13:11:29] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[13:11:46] <arrrrrrrrr> as long as the struct is exactly what &[T] is in memory, you know how to pass it via the C abi
[13:12:54] <doener> arrrrrrrrr: gimme a week or two, I hope to have the ABI refactoring done then, and then we'll pass slices by value
[13:12:55] <eddyb> except you don't, there is nothing inherently struct-like about &[T] in the compiler
[13:12:56] *** Quits: c0170_ (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[13:13:18] <eddyb> "by value" doesn't mean much to me... is it on the stack? because that's not amazing
[13:13:30] <arrrrrrrrr> eddyb: two registers
[13:13:47] <eddyb> you have to be specific when talking about larger-than-pointer/register/w/e values
[13:13:55] <eddyb> arrrrrrrrr: right, that's not what "byval" does AFAIK
[13:14:29] <eddyb> arrrrrrrrr: do you have a playpen link for `extern "C"`? are you looking at IR, or asm?
[13:15:00] <doener> arrrrrrrrr: that depend on the target. x86 would still pass on the stack AFAIK
[13:15:09] <doener> *depends
[13:15:40] <arrrrrrrrr> http://is.gd/cS6dbO
[13:15:41] <doener> eddyb: I mean that &[T] gets passed as two values, *T and len
[13:16:22] <eddyb> doener: well, I know what *you* mean because we've talked about it
[13:16:56] <doener> arrrrrrrrr: I have a patch that generates that for rust ABI functions as well. But the {i64, i64} is bad, thus I'm waiting until I have it fixed to generate two independent arguments
[13:16:58] <arrrrrrrrr> *I* mean that it's passed like a struct with two pointer sized fields is passed in C.
[13:17:41] <doener> arrrrrrrrr: which, in LLVM IR, would mean two independent arguments, not a single {i64, i64}
[13:17:53] <eddyb> how is {i64, i64} even working?
[13:18:13] <doener> arrrrrrrrr: AFAICT, that only works by chance, because LLVM passes structs as if each field was its own argument
[13:18:31] <eddyb> I don't recall being able to get clang to generate those kinds of aggregates
[13:18:48] <doener> eddyb: it doesn't, it splits them into two i64 (see above)
[13:18:49] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[13:19:12] <eddyb> wait, so if LLVM already passes them like that... can't clang use the feature?
[13:19:18] <doener> we used to even pass e.g. {i8, i8, i8, i8} as an FCA, meaning that it ate 4 regs on x86_64
[13:19:37] <eddyb> doener: does *anything* use the fact that aggreggates are passed as separate arguments?
[13:19:38] <eddyb> LOL
[13:19:39] <doener> eddyb: worse codegen I suppose, just like all the other FCA usages we used to have
[13:19:48] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Quit: Leaving...)
[13:19:55] * eddyb wonders what arrays do
[13:20:08] <doener> eddyb: also causes the extra extractvalue instructions
[13:21:16] <eddyb> why is it even there then?
[13:21:29] * eddyb thinks LLVM has some personality issues
[13:21:38] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[13:22:23] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[13:23:46] *** Joins: minzh (minzh@moz-njk.vg0.96.122.IP)
[13:29:12] *** Joins: simukis (nagisa@moz-pol184.mif.vu.lt)
[13:31:53] <Manishearth> queue back to one PR, as it should be
[13:32:17] <eddyb> I haven't pushed mine yet
[13:33:48] *** Quits: arielb1 (Ariel@moz-fvcu0s.red.bezeqint.net) (Ping timeout: 121 seconds)
[13:35:45] <eddyb> nmatsakis: whoa you sneaked this past me https://github.com/rust-lang/rust/pull/23423
[13:38:15] <eddyb> and it will break my PR
[13:38:30] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[13:38:43] <nmatsakis> eddyb: how so?
[13:38:55] <eddyb> nmatsakis: you changed DST code
[13:39:15] <nmatsakis> ah, true, I did
[13:39:22] <nmatsakis> nothing too deep though
[13:39:36] <nmatsakis> well, 
[13:39:39] <eddyb> nmatsakis: well, yeah, but, you added onto the cruft that I remove later :P
[13:39:47] <nmatsakis> the fact that you can't always generate the "info" from scratch is sort of deep
[13:39:53] <eddyb> +          MK_UPCAST_VTABLE: FnOnce() -> ValueRef,
[13:40:04] <eddyb> lol
[13:40:18] <eddyb> nmatsakis: I plan to redo the whole UnsizeKind thing
[13:41:04] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[13:41:21] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[13:41:50] <eddyb> nmatsakis: do you have anymore code or plans in that area, that I should know about?
[13:42:19] <eddyb> do we need an RFC to allow upcasting to supertraits?
[13:43:02] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[13:44:00] <eddyb> nmatsakis: I'm very surprised, though, I don't expect that trans::consts code to work at all
[13:44:37] <eddyb> nmatsakis: because it assumes it started with a Sized type, so it doesn't bother to extract the data pointer
[13:46:52] *** Joins: c0170_ (c0170@moz-bb29a4.cambridge.arm.com)
[13:46:55] *** Joins: arielb1 (Ariel@moz-fvcu0s.red.bezeqint.net)
[13:47:18] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[13:47:23] <nmatsakis> eddyb: it's possible it doesn't, actually
[13:47:45] <nmatsakis> eddyb: now that you mention it, I don't think I wrote tests targeting the const case
[13:47:52] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[13:48:02] <eddyb> nmatsakis: I can't blame you, because...
[13:48:17] <eddyb> playbot: const FOO: &'static mut FnMut() = || {}; FOO()
[13:48:18] -playbot- error: internal compiler error: no type for node 63: expr { } (id=63) in fcx 0x7f95b7bed268
[13:48:18] -playbot- note: the compiler unexpectedly panicked. this is a bug.
[13:48:18] -playbot- output truncated; full output at: http://bit.ly/1GR3GaS
[13:48:58] <SimonSapin> Linux nightlies seem to be failing with llvm-config: No such file or directory
[13:49:12] <SimonSapin> Is this a known problem?
[13:49:51] <eddyb> nmatsakis: I supposedly made that work (even if I'm missing a &mut, it's irrelevant), except I didn't write tests for it (since it was intended for closures in functions) and typeck still doesn't recurse into constants properly
[13:52:41] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[13:56:18] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[13:56:20] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[13:57:11] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[13:57:47] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[13:58:54] *** Joins: mib_8uyu9a (Mibbit@moz-juv.9o3.252.72.IP)
[14:00:11] *** Quits: simukis (nagisa@moz-pol184.mif.vu.lt) (Ping timeout: 121 seconds)
[14:07:03] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[14:07:47] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[14:09:54] <eddyb> nmatsakis: I really don't like that closure there. I would've passed the existing info to unsized_info, if present, because it must be used then
[14:10:10] <eddyb> nmatsakis: that would have prevented an incomplete implementation in trans::consts, too
[14:10:33] <eddyb> (I think I'll fit that in one of my local commits, if you're not against)
[14:10:47] <nmatsakis> eddyb: I don't quite understand what you mean but I'm not against it
[14:10:56] <nmatsakis> I don't love this closure either
[14:11:19] <eddyb> nmatsakis: existing_info: Option<ValueRef>
[14:11:24] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[14:12:09] <Manishearth> eddyb: why is LitBinary using an Rc?
[14:12:37] <Manishearth> http://doc.rust-lang.org/syntax/ast/enum.Lit_.html
[14:12:49] <XMPPwocky> Manishearth: iirc some sort of interning-y thing
[14:13:01] <Manishearth> O.o
[14:13:53] <eddyb> Manishearth: why not? :P
[14:13:59] <eddyb> oh I meant to correct you on something
[14:14:05] <Manishearth> Rc feels strange for interning
[14:14:12] <Manishearth> eddyb: i nthe docs?
[14:14:12] <eddyb> it's not interened, really
[14:14:14] <Manishearth> please do
[14:14:51] <eddyb> Manishearth: in ExprMethodCall, all the vector elements are arguments, including the first
[14:15:31] <eddyb> Manishearth: imagine that "5".parse::<i32>() was written like .parse::<i32>("5")
[14:15:56] <eddyb> as sugar for <_>::parse::<i32>("5")
[14:16:09] <eddyb> which is sugar for... wherever that method is, StrExt?
[14:17:02] <eddyb> Manishearth: the Rc thing is because Lit is cloned... it should be Copy IMO but that would mean a binary data interner
[14:17:28] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[14:18:01] <Manishearth> eddyb: any way to make that clear without making it confusing?
[14:18:10] <eddyb> Manishearth: the method call?
[14:18:14] <Manishearth> yes
[14:18:25] <Manishearth> because the docs should be clear on what it means :P
[14:18:26] <eddyb> just mention that the first argument is the receiver, used to look up the method
[14:18:45] <Manishearth> that's stil lconfusing, sort of :P
[14:18:54] <Manishearth> I don't mind having a 10 line explanation here
[14:18:55] <eddyb> and maybe exemplify: a.foo::<T, U>(b, c) is stored as foo, <T, U> and [a, b, c]
[14:19:16] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[14:19:58] <Manishearth> eddyb: how does autoderef interact with this?
[14:20:15] <Manishearth> a.foo(b) might actually be foo(&a, b)
[14:20:27] <Manishearth> but we don't know that at parse time
[14:20:57] <eddyb> Manishearth: that's why there's no 1:1 mapping, the sugar "expands" in typeck
[14:21:04] <Manishearth> bah
[14:21:17] <Manishearth> and before typeck, what is a.foo(b) stored as?
[14:21:24] <eddyb> foo, [a, b]
[14:21:28] <Manishearth> or does typeck rewrite the exprmethodcalls?
[14:21:36] <Manishearth> so after typeck it becomes foo, [&a, b]?
[14:21:37] *** Quits: c0170_ (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[14:21:46] <eddyb> no, side-tables are used for adjustments
[14:21:49] <Manishearth> wut
[14:22:53] <eddyb> Manishearth: librustc is side-table central
[14:22:55] <eddyb> central-table?
[14:23:04] <Manishearth> what?
[14:23:14] <eddyb> Manishearth: okay
[14:23:53] <eddyb> Manishearth: have you never seen this before? https://github.com/rust-lang/rust/blob/master/src/librustc/middle/ty.rs#L658
[14:24:07] <eddyb> Manishearth: almost every single field is a Vec or a HashMap
[14:24:16] <Manishearth> eddyb: ah
[14:24:36] <Manishearth> so where does the autoderef stuff go?
[14:29:28] *** Quits: arrrrrrrrr (arrrrrrrrs@moz-69t4ps.dynamic.qsc.de) (Client exited)
[14:30:41] <Manishearth> eddyb: I just added a parenthetical about it being the receiver
[14:31:05] *** Joins: ^BR (br@moz-egk.dm6.194.78.IP)
[14:32:30] *** Joins: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP)
[14:32:41] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[14:37:10] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[14:37:51] *** Quits: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP) (Quit: Konversation terminated!)
[14:37:55] *** Joins: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP)
[14:38:37] *** sunfish-away is now known as sunfish
[14:38:57] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[14:39:52] <eddyb> Manishearth: you still have "the remaining" which is technically incorrect
[14:39:59] <SimonSapin> I’m getting "error: type `geom::point::Point2D<util::geometry::Au>` does not implement any method in scope named `encode`" even though Both Point2D and Au implement Encodable, any idea what that could be?
[14:40:28] <eddyb> SimonSapin: what's the actual impl Point2D has?
[14:40:36] <eddyb> and does rustc give you 0 suggestions?
[14:40:39] <Manishearth> eddyb: how is that incorrect?
[14:40:41] <Manishearth> I have a vector
[14:40:47] <Manishearth> it has a first element, and the remaining elements
[14:40:58] <eddyb> Manishearth: *all* the elements are arguments
[14:41:11] <imperio> SimonSapin: I'm pretty sure you imported Encodable but did you import it ?
[14:41:17] <Manishearth> eddyb: didn't say they weren't
[14:41:24] <Manishearth> " and the remaining elements are the rest of the arguments"
[14:41:26] *** Joins: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net)
[14:41:29] <SimonSapin> eddyb: Point2D has #[derive(RustcEncodable)], Au has impl Encodable for Au
[14:41:29] <Manishearth> the first one *is* special
[14:41:30] <eddyb> Manishearth: "remaining"... oh
[14:41:40] <eddyb> Manishearth: "rest" wasn't there initially (or I never saw it)
[14:41:55] <SimonSapin> eddyb: and the error is in another #[derive(RustcEncodable)]
[14:42:02] <Manishearth> and the fact is that ExprMethodCall is confusing -- what one expects is `a.foo(b,c)` to be a, [b,c], except it's [a,b,c]
[14:42:07] *** Quits: osa1_ (omer@moz-k6evqk.cq72.dsk6.000f.2601.IP) (Ping timeout: 121 seconds)
[14:42:11] <Manishearth> which is why I'm trying to clarify this
[14:42:13] <SimonSapin> and yes, the module has use rustc_serialize::{Encoder, Encodable};
[14:42:14] <eddyb> SimonSapin: do any of those types use associated items?
[14:42:27] <Manishearth> the "regular" method call is  one where a and b,c are different
[14:42:30] <eddyb> Manishearth: execpt a, [b, c] is wrong
[14:42:34] <Manishearth> eddyb: sure
[14:42:40] <Manishearth> but we have to be clear about it
[14:42:43] <eddyb> the location of the first argument is
[14:42:44] <eddyb> Manishearth: well
[14:42:46] <SimonSapin> eddyb: I don’t understand, aren’t associated items on traits?
[14:43:10] <eddyb> Manishearth: the obvious solution seems to be to just point out what each thing is, in your example
[14:43:26] <Manishearth> eddyb: can yo ugive some examples of method calls of different types?
[14:43:27] <SimonSapin> the error is on #[derive(RustcEncodable, Copy)] pub struct AbsolutePositionInfo { pub stacking_relative_position_of_absolute_containing_block: Point2D<Au>,
[14:43:28] <eddyb> Manishearth: foo, <Bar, Baz> and [x, a, b, c, d]
[14:43:43] <eddyb> Manishearth: on *your* own x.foo::<Bar, Baz>(a, b, c, d)
[14:44:26] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[14:44:30] <eddyb> SimonSapin: I meant, uses of associated types in structures - because deriving doesn't work with those
[14:44:43] <eddyb> (erickt has a branch to fix it but it hasn't been merged yet AFAICT)
[14:44:57] <Manishearth> eddyb: yeah, but an example of the other calling convention?
[14:45:05] <SimonSapin> they don’t
[14:45:07] <eddyb> Manishearth: "the other"?
[14:45:14] <Manishearth> eddyb: <_>::parse
[14:45:15] <Manishearth> that one
[14:45:22] <eddyb> Manishearth: that's an ExprPath
[14:45:54] <eddyb> Manishearth: that was mostly... for you, not for the docs
[14:45:56] <Manishearth> eddyb: lemme rephrase that, is there a way of creatign an ExprMethodCall where all of the arguments are actually in the argument list?
[14:46:20] <Manishearth> Or is that an ExprCall that's really a method call in disguise
[14:46:29] <eddyb> which one?
[14:46:48] <Manishearth> <Ty as Trait>::foo(a,b,c,d) is the same as a.foo(b,c,d), right?
[14:46:54] <eddyb> let f = Debug::fmt; f(a, b, c); is entirely valid
[14:46:56] <Manishearth> but the former is a Call I guess?
[14:47:04] *** Quits: arielb1 (Ariel@moz-fvcu0s.red.bezeqint.net) (Ping timeout: 121 seconds)
[14:47:16] <eddyb> Manishearth: the same module adjustments, and other `foo` methods in scope
[14:47:18] <Manishearth> I'm jus twondering if there are other ways of getting an ExprmethodCall
[14:47:24] <eddyb> Manishearth: there are not
[14:47:27] <Manishearth> okay
[14:47:39] <imperio> someone knows what path I have to add in my environment in order to remove this error: "rustc: error while loading shared libraries: librustc_driver-4e7c5e5c.so: cannot open shared object file: No such file or directory"
[14:47:42] <imperio> ?
[14:47:50] <imperio> I'm on centOS
[14:47:52] <Manishearth> imperio: the rlib dir?
[14:48:00] <eddyb> Manishearth: maybe .parse("5") confused you, sorry :(
[14:48:05] <imperio> Manishearth: yep but I can't find it
[14:48:10] <Manishearth> eddyb: yeah, it did , but no problem
[14:48:20] <Manishearth> imperio: src/lib/rustlib?
[14:48:23] <SimonSapin> eddyb: looks like we have two versions of rustc-serialize :]
[14:48:23] <Manishearth> sorry, nto src
[14:48:24] *** Joins: rajat (rajat@moz-p1g.l4p.189.205.IP)
[14:48:47] <eddyb> imperio: rustlib/$target/lib/
[14:48:58] <Manishearth> yeah that
[14:49:24] <imperio> eddyb: Manishearth: I installed it the "normal" way, so I'm looking for the one with rustup script
[14:49:31] <Manishearth> ah
[14:49:36] <Manishearth> imperio: use multirust :P
[14:49:44] <imperio> (not working working directly on source sright now)
[14:49:51] <imperio> multirust ?
[14:50:00] <Manishearth> imperio: oh you're going to like this
[14:50:16] <Manishearth> imperio: https://github.com/brson/multirust
[14:50:20] <imperio> Manishearth: I hope. Looking for it on github
[14:50:27] <imperio> and you've been faster than me
[14:50:41] <Manishearth> lets you maintain multiple toolchains
[14:50:48] <Manishearth> in parallel
[14:50:49] <imperio> O.o
[14:50:55] <imperio> ok, that's totally cool
[14:51:15] *** Quits: jevin (jevin@moz-sra.ovp.12.72.IP) (Quit: Textual IRC Client: www.textualapp.com)
[14:51:20] <Manishearth> imperio: so I have a nightly installed, a servo one installed (We download our own snapshot and store it locally, but it's hard to use outside of the servo dir)
[14:51:37] <Manishearth> I aslo have a 32bit nightly, and  a link to a stage1 and stage2 rust build
[14:51:42] <Manishearth> which I think I broke,but meh
[14:52:12] <imperio> I totally need a 32 bit installation. It's furiously interesting !
[14:53:12] <imperio> hum...
[14:53:12] <Manishearth> imperio: you'd have to use the custom toolchain, by downloading the 32bit nightly and doing `multirust update --installer=32-rust.tgz,cargo.tgz`
[14:53:40] <Manishearth> sorry, `multirust update some-name-here --installer=...`
[14:53:50] <imperio> Manishearth: You're reading my mind, I was looking for that haha
[14:54:03] <Manishearth> and `multirust update rust-build --link-local=/path/to/rust`
[14:54:07] <Manishearth> check the readme
[14:54:28] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[14:56:55] <eddyb> Manishearth: multirust should be the only installer
[14:57:40] <Manishearth> eddyb: lol
[14:57:51] <Manishearth> i sometimes mess up whilst gdb'ing multirust 
[14:58:16] <eddyb> rustup is sad
[14:58:58] <eddyb> Manishearth, WindowsBunny: I wonder what issues there are preventing unpriviledged installs on windows
[14:59:47] <imperio> hum...
[14:59:52] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[14:59:55] <imperio> still the same issue
[14:59:59] <imperio> really weird
[15:00:05] *** Joins: arielb1 (Ariel@moz-m8ps8c.red.bezeqint.net)
[15:00:41] <imperio> it doesn't find the librustc_driver (and the other too I guess...) even if I set the LD_LIBRARY_PATH variable, very annoying
[15:01:04] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[15:01:14] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:01:16] *** Joins: scialex (scialex@moz-j5mi8i.cs.brown.edu)
[15:01:31] <eddyb> imperio: and the lib name it expects is in that directory you added to LD_LIBRARY_PATH?
[15:02:03] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:02:04] <imperio> yep
[15:02:57] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[15:03:03] <imperio> eddyb: I found out what was wrong, I forgot to restart my terminal...
[15:03:26] <imperio> how losing 10 minutes for nothing :'(
[15:03:51] <eddyb> imperio: that's what I call "getting lucky"
[15:04:17] <eddyb> 10 minutes is nothing compared to the hours you might have spent
[15:06:28] *** Quits: Amaranth (travis@moz-1raqsl.cpe.cableone.net) (Quit: Sleep time...)
[15:08:01] *** Quits: minzh (minzh@moz-njk.vg0.96.122.IP) (A TLS packet with unexpected length was received.)
[15:11:11] *** Quits: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[15:11:27] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[15:11:28] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[15:15:12] *** Joins: simukis1 (nagisa@moz-pol184.mif.vu.lt)
[15:15:14] *** Parts: simukis1 (nagisa@moz-pol184.mif.vu.lt) ()
[15:15:28] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[15:15:47] *** Joins: simukis1 (nagisa@moz-pol184.mif.vu.lt)
[15:15:48] *** Parts: simukis1 (nagisa@moz-pol184.mif.vu.lt) ()
[15:26:21] *** Joins: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com)
[15:27:47] *** Joins: c0170_ (c0170@moz-bb29a4.cambridge.arm.com)
[15:27:54] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[15:29:07] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[15:29:22] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[15:30:19] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[15:30:58] <imperio> eddyb: "getting lucky" would have been that I remember to restart the terminal from the start ^^
[15:34:06] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[15:34:10] *** Joins: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com)
[15:36:36] *** Quits: mib_8uyu9a (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:38:24] *** Joins: arielby (Mibbit@moz-vae.rli.210.31.IP)
[15:38:52] *** Joins: dinfuehr_ (dinfuehr@moz-c3vkgr.highway.telekom.at)
[15:40:57] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[15:41:11] *** Quits: dinfuehr (dinfuehr@moz-sb03m1.highway.telekom.at) (Ping timeout: 121 seconds)
[15:41:13] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[15:41:30] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[15:42:35] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[15:42:56] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[15:45:20] *** Joins: O01eg (o01eg@moz-h0qgsf.ncbs.4n8f.2698.2a02.IP)
[15:46:59] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[15:48:18] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[15:51:31] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:52:04] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:52:20] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[15:52:38] *** Joins: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com)
[15:54:18] *** Quits: dinfuehr_ (dinfuehr@moz-c3vkgr.highway.telekom.at) (Connection closed)
[15:55:35] *** Quits: arielby (Mibbit@moz-vae.rli.210.31.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:57:55] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[16:00:03] *** Joins: Nekit1234007 (nekit@moz-2vpc3e.broadband.iskratelecom.ru)
[16:00:22] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:00:22] *** ChanServ sets mode: +o brson
[16:03:58] *** Joins: sprang (sprang@moz-bll05b.zoominternet.net)
[16:13:17] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[16:17:38] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[16:21:31] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[16:21:55] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:22:40] *** Quits: c0170_ (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[16:22:50] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[16:23:44] <WindowsBunny> hi eddyb
[16:24:41] <WindowsBunny> eddyb: It's just a matter of creating the installer in a way that allows unprivileged installs
[16:25:23] <WindowsBunny> eddyb: brson generally does things related to the installer, so you can ask him for more information
[16:25:26] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[16:25:50] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[16:27:03] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[16:30:22] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[16:31:14] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[16:31:52] *** Joins: aepsil0n (eduard@moz-olphsm.hsi8.kabel-badenwuerttemberg.de)
[16:32:37] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:33:44] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[16:35:26] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
[16:38:10] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (A TLS packet with unexpected length was received.)
[16:38:20] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:38:25] *** Quits: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[16:38:31] *** Quits: imperio (Mibbit@moz-opqtbe.abo.bbox.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[16:39:54] *** Joins: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP)
[16:40:47] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[16:41:03] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[16:43:22] *** Joins: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net)
[16:43:22] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[16:43:26] *** Quits: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net) (A TLS packet with unexpected length was received.)
[16:51:15] *** Joins: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net)
[16:52:35] *** Joins: dpc (dpc@moz-a8v.6sn.162.73.IP)
[16:56:03] *** Quits: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[16:56:41] *** Quits: aepsil0n (eduard@moz-olphsm.hsi8.kabel-badenwuerttemberg.de) (Connection closed)
[17:05:29] <barosl> acrichto, Please update Homu!
[17:06:18] *** Quits: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:13:40] *** Joins: Amaranth (travis@moz-7203lo.cpe.cableone.net)
[17:13:49] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[17:17:10] <Manishearth> barosl: what new features do we have this time? :D
[17:17:18] *** Quits: zmack (zmack@moz-1oe.89t.76.82.IP) (Connection closed)
[17:17:25] <barosl> Only one, just the approval comment improvement
[17:17:37] <Manishearth> Amaranth: also, the build *jsut* started, so you can update homu without any wastage
[17:18:15] <Manishearth> * acrichto 
[17:18:30] <barosl> Manishearth, The state is lost only when Homu has some breaking changes, so this time it is not the case
[17:19:00] <acrichto> oh perfect!
[17:19:15] <barosl> (So you can update Homu at any time)
[17:19:33] <Manishearth> barosl: nice
[17:20:02] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[17:20:40] <acrichto> barosl: Manishearth: updated
[17:20:47] <Manishearth> \o/
[17:20:50] <barosl> Thanks
[17:23:21] <Yurume> acrichto, are we going to stabilize std::num::strconv for 1.0?
[17:23:36] <aturon> Yurume: that's not currently planned
[17:23:40] <acrichto> Yurume: that... is a good question! probably definitely not as-is
[17:23:49] <aturon> from_str_radix will likely be stabilized
[17:23:51] <acrichto> but as-is we have no stable method of converting a string to an integer in a non-base-10 format
[17:23:58] * acrichto ducks out to aturon :)
[17:24:17] <aturon> Yurume: do you need functionality beyond what from_str_radix provides?
[17:24:32] *** Quits: Rym (y@moz-859.d1r.39.217.IP) (Ping timeout: 121 seconds)
[17:24:36] <aturon> at one point we discussed making strconv essentially private; certainly its public API has not been scrutinzed yet
[17:24:39] *** Quits: arielb1 (Ariel@moz-m8ps8c.red.bezeqint.net) (Ping timeout: 121 seconds)
[17:24:48] <Yurume> no. but well, isn't strconv just for float right now?
[17:25:07] <Yurume> aturon, that makes me relieved.
[17:25:32] <aturon> strconv is basically just revealing a few bits of implementation for from_str_radix and so on
[17:25:35] <Yurume> I'm slowly preparing my strconv PR (which replaces the current float printing routine with an entirely new one)
[17:25:36] *** Quits: scialex (scialex@moz-j5mi8i.cs.brown.edu) (Quit: Leaving)
[17:25:51] <aturon> ah! is that PR against std, then?
[17:25:59] *** Quits: dpc (dpc@moz-a8v.6sn.162.73.IP) (Ping timeout: 121 seconds)
[17:26:02] <Yurume> and its interface will be... at best... only slightly compatible to the current one.
[17:26:03] <aturon> (this seems like something that could also work in crates.io)
[17:26:11] <Yurume> it can be in libcore either
[17:26:15] <Yurume> it does not allocate
[17:27:42] <aturon> Yurume: to be clear, what i mean is: in general for new APIs we are encouraging to start out in the crates.io ecosystem for a while, to gain experience and usage, before being brought into std and stabilized
[17:27:52] <aturon> (we've migrated various things out of std, in fact)
[17:28:39] <Yurume> aturon, well, I was a bit unclear about the motivation: it is going to replace std::fmt::Display/UpperExp/LowerExp impls for floats.
[17:29:03] <Yurume> so as long as the strconv remains semi-private (and not stabilized), it's fine
[17:29:14] <aturon> ah ok, so this is mainly an implementation improvement 
[17:29:18] <aturon> sounds good :)
[17:29:19] <Yurume> yes
[17:29:32] <Yurume> actually, we have two duplicate impls for that :S
[17:29:36] <Yurume> libcore has another
[17:29:44] <Yurume> (derived and stripped from libstd)
[17:29:46] *** Joins: ctennis (ctennis@moz-su6.e72.137.99.IP)
[17:30:12] <Yurume> my plan was to remove or at least move std::num::strconv into libcore and implement the relevant bits in libcore
[17:31:31] <aturon> Yurume: sounds great! feel free to make the module private while you're at it
[17:31:40] <Yurume> yup, thanks!
[17:32:07] <Yurume> aturon, FYI, https://github.com/lifthrasiir/rust-strconv/tree/master/src/flt2dec is the current work
[17:32:21] *** Joins: pcwalton (pcwalton@moz-u92.384.6.71.IP)
[17:32:21] *** ChanServ sets mode: +o pcwalton
[17:34:16] <SimonSapin> Can I have `T == U` instead of `T: Trait` in a where clause? E.g. `where Self::Item == char`
[17:35:07] <Manishearth> SimonSapin: yes
[17:35:12] <Manishearth> try it with a single = sign
[17:35:15] <Manishearth> then wait a month
[17:35:27] <aturon> lol
[17:35:32] <SimonSapin> wat?
[17:35:37] <Manishearth> SimonSapin: try it
[17:35:39] <aturon> SimonSapin: you can only get equality constraints via associated types
[17:35:51] <aturon> SimonSapin: Self: Iterator<Item = char>
[17:35:56] <SimonSapin> Manishearth: well we don’t have static analysis for RFCs yet :p
[17:35:57] <Manishearth> It understands = constraints whilst parsing, but it doesn't do anything with them
[17:36:26] <SimonSapin> aturon: I see, thanks. And yes, this is for an associated type.
[17:37:16] <Manishearth> or more accurately, it complains about them
[17:38:18] *** Joins: arielb1 (Ariel@moz-33pn30.red.bezeqint.net)
[17:38:32] <kimundi> nmatsakis: I have a question about borrows. In a function signature in general, what decides wheter a borrow is mutable or not? Eg the general case of fn<'a>(Foo<'a>) -> Bar<'a>
[17:39:42] <nmatsakis> kimundi: I don't understand the question
[17:40:48] <kimundi> nmatsakis: fn<'a>(&'a T) -> &'a T would do a shared borrow, fn<'a>(&'a mut T) -> &'a mut T a mutable borrow. I'm wondering how that gets decided in the general case of fn<'a>(T<'a>) -> U<'a>
[17:41:40] <kimundi> Is it a variance property of the lifetime parameter? Or a "hidden" property based on wether the types contain a &mut or not?
[17:41:49] <nmatsakis> kimundi: whether a shared or mutable borrow occurs is not really a property of a fn sig?
[17:42:06] <nmatsakis> I mean the borrow occurs when you write &T or &mut T
[17:42:10] <nmatsakis> in the caller side
[17:42:15] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[17:43:31] <kimundi> nmatsakis: Hm...
[17:43:35] <aturon> nmatsakis: so, i'm brainstorming ways to deal with http://is.gd/SticUd
[17:43:51] <aturon> nmatsakis: basically, the problem is that [] notation involves an auto-ref, and with maps that interacts with Borrow
[17:44:09] <aturon> nmatsakis: in particular, we have String: Borrow<str> but not String: Borrow<&str>
[17:44:39] <aturon> i'm wondering if it would be reasonable to provide an impl of T: Borrow<&U> when T: Borrow<U>
[17:44:58] <aturon> but that would involve some transmuting around lifetime restrictions i'm not sure is reasonable
[17:45:15] <nmatsakis> I don't know if you could do that
[17:45:23] <nmatsakis> you'd have to produce an arbitrary number of indirections
[17:45:27] <nmatsakis> where are you going to allocate all those pointers?
[17:45:37] <nmatsakis> or am I missing something
[17:46:18] <nmatsakis> is this an argument for IndexGet taking its argument by value after all :)
[17:46:27] <aturon> hahaha
[17:46:36] <aturon> i don't think so
[17:46:41] <nmatsakis> I confess I find it a bit hard to remember whether I am supposed to write foo[key] vs foo[&key], given foo.get(&key) 
[17:47:24] <aturon> seems... late to consider changing that
[17:47:52] *** Quits: pcwalton (pcwalton@moz-u92.384.6.71.IP) (Client exited)
[17:48:04] <nmatsakis> I know
[17:48:17] *** Joins: Gankro_ (Mibbit@moz-i2bsgd.scs.carleton.ca)
[17:48:28] <aturon> (i feel like we carefully thought through the various scenarios last time around, in any case)
[17:48:58] <Gankro_> huon: What's your take on the unsafe Ord stuff now that we have a concrete example?
[17:49:13] <aturon> nmatsakis: OTOH, this could argue for more flexibility re: auto-ref, as with +
[17:50:36] <nmatsakis> aturon: true.
[17:51:36] <arielb1> nmatsakis: about my PR
[17:51:46] <arielb1> [23424]
[17:52:00] <arielb1> what's the deal with where clauses on Self::A?
[17:52:07] <arielb1> I mean, in the comment
[17:52:20] *** Joins: Rym (y@moz-859.d1r.39.217.IP)
[17:53:02] <arielb1> Thinking about it, if we have a where clause vs. projection
[17:53:15] <arielb1> then if there are type variables, we can unify wrong
[17:53:31] <arielb1> the where clause could be Self::A : Foo<()>
[17:53:39] <arielb1> and the typevar Self::A : Foo<bool>
[17:53:50] <arielb1> *the projection bound be type A : Foo<Bool>
[17:56:58] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[17:58:59] *** Joins: jdm (jdm@moz-i5m.05u.207.66.IP)
[17:59:08] <kimundi> nmatsakis: What I meant earlier: If I call fn(&T) -> &T twice and keep the return value, it works as a shared borrow. If I call fn(&mut T) -> &mut T or fn(&mut T) -> &T twice, rustc would complain about more than one mutable borrow. I'm wondering what decides the difference there in the general case of fn<'a>(T<'a>) -> U<'a> - is it just T<'a> being copyable?
[18:00:48] <nmatsakis> kimundi: it has nothing to do with the fn being called, it is a mutable borrow if you do `&mut x` on the caller side. The return type only matters in that it affects the duration of that loan
[18:01:15] <aturon> acrichto: mind kicking off a snapshot?
[18:01:20] <acrichto> aturon: already done!
[18:01:23] <aturon> :D
[18:01:46] <kimundi> nmatsakis: Right, but what if this is all behind generic abstractions that don't know about whether a concrete & or &mut was involved?
[18:02:34] *** Quits: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[18:02:58] <nmatsakis> arielb1: https://github.com/arielb1/rust/commit/eeace7c2e16b8405ad42acbb4e40526eafda917c#commitcomment-10243007
[18:03:35] <arielb1> what happens with default methods?
[18:03:46] <kimundi> nmatsakis: So only the lifetime of the return value is relevant to determine the duration, but what that borrow gets classified as is determined by how it was started, which is always a concrete expelicit or implicit &foo or &mut foo ?
[18:03:55] <eddyb> kimundi: yes
[18:04:02] <nmatsakis> arielb1: default methods always have such conflicts because they have all the bounds from the assoc types in the trait in their environment
[18:04:13] <nmatsakis> kimundi: yes, that is correct
[18:04:31] <Gankro_> aturon: What's the status of Extend<&T>, T: Clone and Entry v3?
[18:04:50] <nmatsakis> kimundi: after region inference, you basically have at the start of each borow a kind (mut vs imm) and a duration -- and nothing matters after that, you can do whatever you want within that duration 
[18:05:14] <kimundi> nmatsakis: interesting!
[18:05:14] <nmatsakis> kimundi: region inference just picks the smallest durations it can to satisify the basic lifetime constraints (that a pointer's lifetime should only get smaller, basically)
[18:05:32] <nmatsakis> by "you can do whatever you want" I of course mean, whatever the type rules permit
[18:05:37] <nmatsakis> considering that the data is loaned
[18:06:12] <kimundi> where "get smaller" is determined by the variances of the lifetime parameters involved?
[18:06:31] <arielb1> nmatsakis: sure
[18:06:31] <arielb1> can't we add the PolyTraitRef to projections too?
[18:06:32] <kimundi> (Or does variance factor into another place?)
[18:07:07] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[18:08:52] <aturon> Gankro_: the Extend RFC i think is probably ready to bring up for team discussion (it hasn't been prioritized because not a backcompat hazard)
[18:09:10] <aturon> Gankro_: Entry v3, also ready
[18:09:24] <aturon> Gankro_: i will make sure both of these get discussed this week
[18:09:27] <aturon> thanks for the ping
[18:09:58] *** Joins: James (quassel@moz-t5os7p.range86-163.btcentralplus.com)
[18:17:52] *** Joins: Kxepal (Miranda@moz-bf65kn.pppoe.mtu-net.ru)
[18:18:20] <Gankro_> acrichto: it looks like all that's left of gh18424 is by-need/predicate. Is there another issue for implementing those?
[18:18:21] <[o__o]> Implement collections reform: https://github.com/rust-lang/rust/issues/18424
[18:18:58] <aturon> Gankro_: sadly, we can't really impl them
[18:19:05] <aturon> unless we get negative bounds or specialization
[18:19:14] <aturon> due to unboxed closures landing in the interim
[18:19:25] *** Quits: Kxepal (Miranda@moz-bf65kn.pppoe.mtu-net.ru) (Connection closed)
[18:20:08] *** Joins: Kxepal (Miranda@moz-bf65kn.pppoe.mtu-net.ru)
[18:21:43] <Gankro_> aturon: Neither of which have an RFC, yeah?
[18:22:09] <aturon> Gankro_: there's an RFC for negative bounds, but it's tricky and we're finding that it can lead to coherence issues
[18:22:14] <aturon> https://github.com/rust-lang/rfcs/pull/586
[18:22:27] <arielb1> nmatsakis: dropping the projection can lead to ambiguities being ignored
[18:22:32] <aturon> Gankro_: basically i think it's ok for that part of collections reform to fall by the wayside for now,
[18:22:40] <aturon> Gankro_: and we can revisit if/when we get some of these power tools
[18:22:42] <arielb1> in an inference context
[18:23:16] <arielb1> but I guess we have to accept it
[18:23:56] <Gankro_> aturon: What kind of specialization would be needed? Weak-blanket impls?
[18:24:15] <aturon> Gankro_: yep
[18:25:23] <rprichard> SimonSapin: The Linux build failures are my fault. Sorry about that. The next build should be good, but #80 began before my fix was merged. https://github.com/rust-lang/rust/pull/23429
[18:26:02] <Gankro_> aturon: Any hopeful-timeline for that sort of thing? (I can't even remember what Predicate/By-Need was for)
[18:26:13] <SimonSapin> rprichard: no worries, thanks for the fix!
[18:26:18] <aturon> Gankro_: hm, you see IndexMut being used often for maps?
[18:26:30] <aturon> Gankro_: we're working on the post-1.0 timeline right now, actually
[18:26:59] <aturon> Gankro_: i think specialization is pretty high-priority, because it can help resolve a number of problems we've been running into with coherence, but ... there's a lot of stuff to do :)
[18:27:37] <Gankro_> aturon: I vaguely recall seeing a lot of indexmut on maps, but it's all kinda hazy to be honest
[18:28:00] <aturon> Gankro_: ok, was this in std as far as you recall?
[18:28:08] <aturon> (if so it would show up quickly)
[18:28:10] <Gankro_> Nah, we don't really use maps much
[18:28:19] <aturon> or rustc, sorry
[18:28:22] <Gankro_> Rustdoc and Rustc might
[18:28:23] <aturon> in the distro is what i mean
[18:29:36] <Gankro_> I know at least one guy was going something like reading out string args into a map and then assuming that they had to be there using indexing. Possibly something that should be using a custom struct and a serialization framework; I didn't really audit the cod emuch
[18:29:55] <Gankro_> Oh shti Ihave to proctor a test like right now
[18:29:55] <kimundi> acrichto: Hm, just discovered that to_uppercase/to_lowercase change for char. I'm not sure if changing them to return iterators was the right thing to do
[18:30:06] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:30:06] *** ChanServ sets mode: +o pcwalton
[18:30:08] <Gankro_> g2g
[18:30:15] <acrichto> kimundi: how so?
[18:31:43] <kimundi> acrichto: The old one char behavior is the defined unicode way to do simple case mapping. By changing the methods to return iterators, you changed them to a very buggy implementantion of the extend case mapping. Buggy because its broken for any value that should return more than one char
[18:32:38] <kimundi> That is, I see two distinct operations there, and the change made the current interface-implementantion combo wrong for both of them
[18:33:19] <acrichto> kimundi: you're saying that the fact that it *can* return multiple chars is wrong?
[18:33:31] <kimundi> Say I want simple case mapping so that & -> &. I can no longer use the current implementantion at all, because at some arbitrary point it could get "fixed" to do & -> SS
[18:33:51] <aturon> SimonSapin: ^
[18:34:05] <kimundi> Its wrong if it doesn't actually implement that
[18:35:07] <acrichto> sure, but it sounds like you're saying we should abandon the change entirely, making it impossible to *ever* implement it
[18:35:27] <aturon> acrichto: kimundi is saying there shoudl be two APIs
[18:35:37] <aturon> the simple and the extended versions
[18:35:53] <kimundi> acrichto: I'm saying that right now the API is wrong for both interpretations of unicode case folding
[18:36:14] <kimundi> its wrong for the single case because, well it returns an iterator
[18:36:31] <kimundi> its wrong for the mult char case because well the iterator does never actually return more than one char atm
[18:36:43] <eddyb> kimundi: and changing semantics would be wrong?
[18:36:43] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[18:37:05] <eddyb> kimundi: I mean, you don't agree with eventual changes to the iterator?
[18:37:07] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[18:37:15] <kimundi> eddyb: No thats fine.
[18:37:24] <acrichto> kimundi: please keep in mind that we're running on a tight schedule though which is why the current multi-char mapping is not implemented, it would probably be more helpful to assume that it does implement it (e.g. that's what's planned)
[18:37:38] <kimundi> What I disagree with is that the current API has 0 ways to get a defined correct case mapping :P
[18:37:44] <acrichto> so factually yes it is incorrect today, but that's not what it's meant to be
[18:38:01] <acrichto> as in, we did not design it with that in mind
[18:38:14] <aturon> kimundi: note, https://github.com/rust-lang/rfcs/pull/986
[18:38:51] <kimundi> acrichto: Thats a acceptable reasoning, but also a bit weird to throw away the existing correct implementation and replacing it with a incorrect implementation of a related algorithm
[18:39:25] <acrichto> kimundi: sure but remember that we're very resource constrained, we still have a huge amoutn of the stdlib to stabilize so right now our priority is APIs
[18:39:37] <acrichto> we will need to take time to catch up the impls sometimes but that can be done backwards compatibly
[18:39:48] <acrichto> this is all a game of prioritizations for us as we have a tight schedule and a whole lot to do
[18:40:03] <nmatsakis> arielb1: I agree that picking the where-clause over the projection is not as general as one might like to be; this is why there is a FIXME and an open issue
[18:40:10] <eddyb> which reminds me, is the `const fn` discussion scheduled?
[18:40:43] <kimundi> acrichto: I understand, but the change seems pointless nevertheless, as the old behavior was not wrong, and is now impossible to use
[18:40:51] <eddyb> acrichto: because I have a bunch of mass deprecation to do after a const-fn-enabled snapshot (assuming it gets accepted)
[18:41:36] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[18:41:37] <kimundi> acrichto: Of course if the idea is that we will not provide the simple case folding variant at all, thats a bit different...
[18:41:48] <acrichto> kimundi: I think it's unfair to call this change pointless, it clearly is intended to allow us to implement the full set of unicode case mappings, calling out the very specific impl today seems somewhat irrelevant
[18:42:21] <acrichto> eddyb: you may want to talk to pnkfelix who is sheperding
[18:42:23] <aturon> eddyb: it's very close to a decision. however, note that this may partly be contingent on landing it as an "experiment" feature, i.e. not something we would be in a position to un-gate for 1.0
[18:42:48] <aturon> (which means that we can't plan to use it in stable 1.0 APIs)
[18:43:23] <kimundi> acrichto: Sorry, "pointless" was uncalled for there
[18:43:59] <aturon> kimundi: i'm curious whether you think we should provide both forms of the API side-by-side?
[18:44:12] <acrichto> kimundi: sry brb
[18:44:34] <kimundi> aturon: That would seem more logical to me given that both are unicode defined  and one of them is implemented already.
[18:45:39] <kimundi> aturon: That is, renaming the existing methods to to_uppercase_basic or so would seem more honest and useful for users
[18:47:16] <kimundi> aturon: (The old existing one-char methods I mean)
[18:47:19] <sfackler> seems to me like it's a bit of a tradeoff between giving people that are familiar with unicode the tools they expect and helping people who aren't and "just want to make a into A"
[18:47:30] <sfackler> one option would be to do both
[18:47:40] <sfackler> have to_uppercase that does "something reasonable"
[18:47:57] <sfackler> and then explicit variants for basic and the other one
[18:49:51] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[18:50:33] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[18:53:14] <kimundi> (Hm, random idea: char.to_upper::<T>() where T == Ascii, CharBasic or CharExtended)
[18:53:24] *** Joins: njn (chatzilla@moz-gok.4b2.214.203.IP)
[18:53:32] <kimundi> ((Silly random idea of course))
[18:54:04] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[18:55:44] *** Joins: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP)
[18:56:01] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[18:56:29] <eddyb> aturon: wait, what?
[18:57:09] <eddyb> aturon: for some reason I got the impression *definitions* of such functions would be gated, not uses. my bad
[18:57:24] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[18:57:35] <eddyb> aturon: would be a shame to have all those _INIT constants in 1.0 proper :(
[18:58:07] <eddyb> and the delay means we might not be able to remove static mut
[18:58:30] <eddyb> it surely can be deprecated once const-fn is in
[19:00:01] <eddyb> aturon: I will have to work with what I have, I guess
[19:00:39] <eddyb> (is there ever an end to compiler development?)
[19:02:30] *** Joins: scialex (scialex@moz-j5mi8i.cs.brown.edu)
[19:04:23] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[19:06:39] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[19:06:39] *** ChanServ sets mode: +o nrc
[19:09:14] <kimundi> eddyb: Probably in a decade or so rustc is stable enough to enter maintaining phase  :P
[19:10:08] *** Quits: jdm (jdm@moz-i5m.05u.207.66.IP) (Connection closed)
[19:10:14] *** Joins: jdm (jdm@moz-i5m.05u.207.66.IP)
[19:13:09] <eddyb> kimundi: after being rewritten once a year?
[19:14:18] <eddyb> parts of rs0 could probably be turned into actual efficient code, but there's a lot of manual stuff in rustc which has more or less of a reason
[19:15:58] *** Quits: Mutabah (tpg@moz-o8p.jbh.56.203.IP) (Ping timeout: 121 seconds)
[19:18:31] *** Quits: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[19:19:16] <SimonSapin> kimundi: what does "so that & -> &" mean?
[19:20:00] <kimundi> SimonSapin: AH, sorry. I meant 'ß' -> 'ß' vs 'ß' -> "SS"
[19:20:02] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[19:20:13] <kimundi> (mixed up the sigils and then typed the wrong one :P)
[19:21:22] *** Joins: Mutabah (tpg@moz-hklpnj.mutabah.net)
[19:21:27] *** Quits: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[19:23:21] <SimonSapin> kimundi: Oh, ok. So the plan was to not provide simple mapping in std only the mappings including SpecialCasing.txt
[19:23:30] *** Quits: James (quassel@moz-t5os7p.range86-163.btcentralplus.com) (Ping timeout: 121 seconds)
[19:23:48] <SimonSapin> kimundi: also case, folding (in order to do caseless matching) is not quite the same as lower/upper case mapping
[19:24:06] <kimundi> SimonSapin: Right
[19:25:19] <kimundi> SimonSapin: So, the idea is to not provide simple case mapping at all?
[19:27:07] <SimonSapin> kimundi: The idea was to have one "default" lowercase mapping in std (similarly uppercase) that does the Right Thing (as much as possible without language info) for people who don’t care about the difference between all the different flavors of Unicode mapping
[19:27:37] <SimonSapin> if you specifically want the simple mapping that doesn’t change the number of code point, that would be in a yet-to-be-written crate.io library
[19:27:44] <kimundi> SimonSapin: I see
[19:40:58] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[19:41:43] <aturon> eddyb: sorry, stepped out for lunch
[19:42:00] <eddyb> aturon: np
[19:42:11] <brson> I've moved the fott archives to my own blog for now https://brson.github.io/fott.html
[19:42:12] <aturon> eddyb: well, so the problem is that we would need to stabilize some const fns for constructors, no?
[19:42:19] <aturon> eddyb: afaict that would involve ungating the feature
[19:42:50] <aturon> and, while i'm in favor of the feature, i'm not sure that the APIs it would effect in std need it so desperately that we should fast-track it
[19:43:12] <eddyb> aturon: I personally understood that const fn *definitions* would be gated
[19:43:24] <aturon> eddyb: right, but isn't that enough?
[19:43:30] <aturon> oh, i see what you mean
[19:43:52] <aturon> still, if we marked such a definition #[stable] and allowed it to be used on stable rust,
[19:44:00] <aturon> we're effectively committing to some form of const fn in the future, no?
[19:44:01] <eddyb> then we couldn't remove constness from it
[19:44:03] <kimundi> aturon: idea for getting around it: provide macros for initialization that just expand to the const fn. Afaik macros can use feature gated stuff?
[19:44:09] <eddyb> *sigh*
[19:44:12] <eddyb> wait
[19:44:31] <eddyb> kimundi: that's... clever? nobody suggested it until now
[19:44:35] <aturon> kimundi: that's a possibility, but in some sense macros are a competing feature here
[19:44:47] <eddyb> kimundi: it still has namespacing problems
[19:44:51] <aturon> eddyb: hm, it was discussed in the meeting where we talked about const fn
[19:45:01] <eddyb> aturon: not this specific form
[19:45:22] <eddyb> (as a proxy, not as the actual impl)
[19:45:28] <eddyb> aturon: but it's a nasty hack
[19:45:45] <aturon> i see; i guess as usual i'm focused on the user-facing API, primarily
[19:46:19] <eddyb> mk_atomic_usize!(5) is more flexible than ATOMIC_USIZE_INIT
[19:47:06] <eddyb> aturon: but still leaves me disgusted. using the same API at runtime and in consts is the only viable option in the short and long term IMO
[19:47:40] <aturon> so, personally, i feel OK having the _INIT constants stable for now, on track for deprecation once const fns are ungated
[19:48:49] <eddyb> aturon: I will replace them everywhere we can use the feature gate, though
[19:49:40] <eddyb> aturon: it's going to be so much easier once I don't have to duplicate code for staging and touch files into the past to avoid stage0 builds
[19:49:45] <aturon> eddyb: sounds like a good compromise
[19:49:46] <aturon> yes
[19:49:50] <kimundi> #[stable] const ATOMIC_USIZE_INIT = Atomic::new(0); ?
[19:50:09] <eddyb> kimundi: don't forget the type :(
[19:50:35] <aturon> kimundi: on another note, had an interesting lunch conversation today that led to a question for the Pattern API
[19:51:00] <kimundi> eddyb: I was not sure whether it would be more atrocious to ellide the type, or to write the wrong one there because I don't remember it right :P
[19:51:06] <aturon> kimundi: someone was implementing it for Boyer-Moore matching, and we were wondering whether reject steps were required to fall on utf8 boundaries
[19:51:13] *** Joins: munksgaard (munksgaard@moz-1i4.hq0.225.130.IP)
[19:51:54] <simukis> anybody with OS X could help me with getting integral type of C typedef? 
[19:51:56] <aturon> kimundi: my intuition is that, since the reject doesn't have to cover the maximal space, it also doesn't need to fall on boundaries
[19:52:01] <eddyb> kimundi: AtomicUsize
[19:52:05] <eddyb> kimundi: there's no generics :(
[19:52:15] <aturon> kimundi: (because what really matters is the transition between matches and rejections)
[19:52:19] <eddyb> kimundi: and we can't add generics without const fn in traits
[19:52:51] <kimundi> aturon: Hm... So having them not fall on them is potentially problematic because it means the indices could only actually be used at Match/Reject boundaries
[19:53:13] *** Quits: rprichard (rprichard@moz-5p9.cva.188.67.IP) (Connection closed)
[19:53:27] <aturon> kimundi: right. i think the only other place they're used, though, is at the *start* of a rejection sequence, which would always be on a boundary
[19:53:30] <kimundi> aturon: But maybe thats fine for all potential uses, and it would certianly simplify some things in the existing impl as well
[19:53:35] <faern> simukis: I have osx, what do you want me to do?
[19:53:35] <kimundi> yeah
[19:53:44] <aturon> kimundi: ok. we can always relax the contract later on
[19:53:58] <aturon> kimundi: btw, how are you feeling about the API overall? we are starting to consider stabilization
[19:54:00] <kimundi> yep.
[19:54:26] <simukis> faern: could you retrieve me a type of `rlim_t` C type? It should be somewhere in either `/usr/include/sys/resource.h` or `/usr/include/sys/types.h`
[19:54:32] <eddyb> dat utf8x4 tho
[19:55:31] <faern> simukis: typedef __uint64_t  rlim_t;
[19:55:41] <simukis> faern: nice, thanks!
[19:55:45] <faern> simukis: np
[19:55:57] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[19:56:48] <simukis> faern: while you’re here, could you get me RLIMIT_* constants out of the header files into some gist as well?
[19:56:50] <kimundi> aturon: So, I don't really have any additional thoughts than initially yet, and the RFC did not yet get fully implemented. (Btw, there is a PR by shep-home that fixes some of the existing iterator impls)
[19:57:14] <simukis> (or just gist the relevant headers in full)
[19:57:57] <aturon> kimundi: ok. FWIW, i think we will try for the strategy of stabilizing the StrExt-level API first, leaving Pattern and Searcher unstable while we get more experience -- those are the APIs likeliest to want more tweaking. /cc acrichto 
[19:58:20] <kimundi> aturon: Right, that was the plan as I understood it
[19:58:38] <acrichto> kimundi: btw is https://github.com/rust-lang/rust/pull/23269 ready to go?
[19:58:59] <kimundi> aturon: I have to ask though, how does that work? You are allowed to use types fulfilling unstable trait bounds?
[19:59:28] <acrichto> kimundi: I'm interpreting it as "this function will always take at least the same set of inputs"
[19:59:34] <acrichto> so it means the set of trait implementors cannot shrink
[19:59:45] *** Quits: ctennis (ctennis@moz-su6.e72.137.99.IP) (Quit: Leaving...)
[20:00:04] <aturon> ultimately, we will want the stability lint to prevent such mixtures of stable and unstable, i think
[20:00:10] <kimundi> acrichto: Yes, that PR is fine so far.
[20:00:20] <aturon> but we're still in an unusual situation of trying to get the first pass for 1.0 done
[20:00:27] <acrichto> kimundi: ok, thanks!
[20:02:10] <kimundi> shep-home: ping, your PR needs a rebase :)
[20:02:25] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:03:38] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[20:05:02] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:05:02] *** ChanServ sets mode: +o pcwalton
[20:07:22] <faern> simukis: I'm on it
[20:08:55] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[20:09:14] *** Quits: jdm (jdm@moz-i5m.05u.207.66.IP) (Connection closed)
[20:09:21] *** Joins: jdm (jdm@moz-f1mer4.ckpj.s0pt.0450.2001.IP)
[20:09:23] <faern> simukis: https://gist.github.com/faern/3e4c1e7dff7977a83a85
[20:09:33] <simukis> faern: thanks!
[20:10:08] <kimundi> aturon: Hm, if Reject can fall on non-utf8, then it almost seems like we might just need RejectStart(usize) and RejectEnd(usize) - except its probably still easier to have that as a number of Reject(usize, usize) pairs
[20:10:47] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[20:11:00] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[20:13:11] <aturon> kimundi: hm, interesting! i do get the sense that the pairs may be easier to implement, but maybe having a simpler interface to Searchers is more important
[20:13:25] <aturon> huon: are you around by chance? i have a derive question
[20:13:54] *** Joins: onix (Mibbit@moz-g6k.oht.161.46.IP)
[20:13:55] *** Joins: Tobba|Laptop (Tobba@moz-o13d22.bredband.telia.com)
[20:16:09] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[20:16:32] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[20:17:42] *** Joins: zmack (zmack@moz-1oe.89t.76.82.IP)
[20:18:02] <eddyb> barosl: <3 https://github.com/rust-lang/rust/pull/23376#issuecomment-82539503
[20:18:03] *** Quits: Tobba|Laptop (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[20:20:02] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:20:42] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:20:42] *** ChanServ sets mode: +o pcwalton
[20:21:02] <acrichto> nmatsakis: how comfortable are you marking MarkerTrait as #[stable]?
[20:21:06] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:21:44] *** Quits: zmack (zmack@moz-1oe.89t.76.82.IP) (Ping timeout: 121 seconds)
[20:23:58] <acrichto> aturon: https://gist.githubusercontent.com/alexcrichton/08e3b0298b89305da46f/raw/3828f5da250bb04016c8cab49eb49e6512276a1b/gistfile1.txt :(
[20:24:22] <acrichto> aturon: the As<[T]> may not work out...
[20:25:42] <nmatsakis> acrichto: comfortable, seems harmless enough to me
[20:25:43] <Gankro_>  acrichto: boooo coherence :(
[20:25:58] <nmatsakis> acrichto: maybe it will someday be deprecated or something but I don't see how it could cramp our style
[20:26:11] <acrichto> nmatsakis: ok cool
[20:28:04] <eddyb> acrichto: As there is interesting...
[20:28:12] <eddyb> acrichto: what's it for?
[20:28:18] <aturon> acrichto: hm, right, so we can't use that and also allow "deep" conversion
[20:28:26] <aturon> or comparison, i guess
[20:28:28] <eddyb> have you considered the bound-targeting coercions?
[20:29:24] <eddyb> (as for the actual example, you seem to want [_] and an Element associated type. which is not a thing right now)
[20:30:00] <aturon> eddyb: context: https://github.com/rust-lang/rust/pull/23288
[20:31:08] <acrichto> aturon: yeah :(
[20:31:16] <acrichto> eddyb: allowing [T] == Vec<T>
[20:31:26] <acrichto> eddyb: right now it leverages #[old_orphan_check] to enable that
[20:34:33] <sfackler> I personally won't shed many tears if that goes away
[20:34:51] <eddyb> acrichto: bound-targeting coercions might be able to handle that
[20:35:12] <eddyb> acrichto: but they're a late idea :(
[20:35:17] <eddyb> blaenk: ping ^^
[20:35:28] <blaenk> yeah ;_;
[20:35:32] <aturon> acrichto: nmatsakis: it occurs to me that this same coherence limitation will prevent us from e.g. adding `impl<T> To<MyType<T>> for [T]` in downstream crates
[20:35:33] <eddyb> acrichto: I don't even know what nmatsakis thinks of them
[20:35:33] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[20:35:51] <acrichto> aturon: oh dear...
[20:35:53] <aturon> eddyb: what are bound-targetting coercions? something like a deref coercion that triggers based on target bounds?
[20:35:54] <eddyb> As/To traits are cool but a bit hard to get right
[20:36:21] <eddyb> aturon: yupp, attempting possible coercions until one matches the expected type
[20:36:37] <aturon> eddyb: i've been pestering nmatsakis a bit about the same idea :)
[20:36:46] <blaenk> aturon: I'll link you more info about it
[20:36:49] <eddyb> aturon: or rather, *the bounds* on the expected inference variable type
[20:36:56] <Gankro_> Has `As/To` been accepted yet?
[20:37:02] <aturon> eddyb: ... and he seems to be coming around at least for deref coercions, but not in the near future
[20:37:20] <aturon> Gankro_: it hasn't been merged, but there was a decision to accept it, yes
[20:37:29] <eddyb> aturon: it doesn't seem incredibly hard to handle, but...
[20:37:44] <acrichto> aturon: this means that we can't have `To<Vec<T>> for [T]`
[20:37:53] <aturon> Gankro_: (it would be considered somewhat experimental -- basically, we want to try to land it and see what problems we run into)
[20:38:02] <aturon> acrichto: oy vey
[20:38:18] <aturon> i feel like i'm running into coherence problems daily...
[20:38:19] <Gankro_> aturon: Was it at all mentioned that `As<T>` is completely different from `as T`, which is a bit confusig?
[20:38:36] <aturon> Gankro_: i'm not sure if that came up in the RFC itself, but i've certainly raised it with people
[20:38:44] <aturon> Gankro_: however, it's already a problem with our as_foo convention
[20:38:55] <eddyb> acrichto, aturon: maybe this is related? https://www.reddit.com/r/rust/comments/2z8tf1/why_isnt_trait_construction_over_associated_types/
[20:39:09] <Gankro_> aturon: Yeah, but it's convention vs trait; `As<T>` sounds like an operator trait
[20:39:18] <aturon> Gankro_: ah, good point
[20:39:22] * aturon cries
[20:39:40] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[20:39:44] <Gankro_> aturon: The Rust in your head is so beautiful, but it can never get out
[20:39:45] * WindowsBunny wipes away aturon's tears
[20:39:50] <aturon> lol
[20:39:55] <aturon> y'all are the best :)
[20:39:58] <steveklabnik> barosl: nice change away from the strikethrough, i really like that new message :)
[20:40:20] <steveklabnik> barosl: excellent emoji choice :)
[20:40:46] <blaenk> aturon: https://github.com/rust-lang/rfcs/pull/803#issuecomment-77677349
[20:40:46] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[20:41:03] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[20:41:51] <WindowsBunny> aturon: Don't worry, I'm just stealing your tears to drink them later ;)
[20:42:04] <aturon> blaenk: thanks! that is indeed exactly the same idea i was bugging nmatsakis about, i think inspired by kimundi's Pattern API
[20:42:29] <aturon> WindowsBunny: as long as they result in more winapi bindings, it's all good
[20:44:27] *** Quits: cmr|mib (Mibbit@moz-t37.gf6.5.96.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:45:01] *** Quits: semarie (semarie@moz-1jo0ne.badexample.net) (A TLS packet with unexpected length was received.)
[20:45:14] *** Joins: jdm_ (jdm@moz-i5m.05u.207.66.IP)
[20:46:03] <kimundi> Ah, _that_'s what is meant with bound-based coercion
[20:46:26] <kimundi> bound-targeting, that is
[20:47:18] *** Quits: jdm (jdm@moz-f1mer4.ckpj.s0pt.0450.2001.IP) (Ping timeout: 121 seconds)
[20:47:21] <kimundi> Very much in favor of that one :P
[20:47:27] <blaenk> YEAH :D
[20:47:52] <Gankro_> bstrie: How goes the rust-sucks project?
[20:48:47] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[20:48:47] *** ChanServ sets mode: +o pnkfelix
[20:50:17] <reem> Is the idea that As/To coercions call a method?
[20:50:27] <reem> if so doesn't that introduce possibly large amounts of implicit behavior?
[20:50:47] <aturon> reem: no, they're not new operators or anything
[20:50:48] <aturon> https://github.com/rust-lang/rfcs/pull/529
[20:51:09] <aturon> just traits to avoid the proliferation of AsPath, AsSlice, Str, IntoOsString, AsOsStr, etc etc etc
[20:51:11] <reem> oh ok cool I've wanted general conversion traits too
[20:52:01] *** Joins: rprichard (rprichard@moz-b05bme.en8f.d045.0009.2601.IP)
[20:52:30] <aturon> acrichto: i take it back, `impl<T> To<MyType<T>> for [T]` is ok
[20:52:44] <acrichto> aturon: really? I tried it out and it didn't work
[20:52:45] <aturon> acrichto: the covered first rule just says that T has to be covered by a local type, but it is in that example
[20:53:11] <aturon> hm really? https://github.com/rust-lang/rust/blob/2c2879bbce4177552ce26c6445dcb7027a1245c7/src/test/run-pass/coherence-cow-1.rs
[20:53:19] <acrichto> aturon: https://gist.github.com/alexcrichton/337d5585963f415c3d56
[20:53:48] *** Parts: rajat (rajat@moz-p1g.l4p.189.205.IP) ()
[20:53:57] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[20:54:08] <aturon> hmm ok, either i'm misunderstanding the rule or something isn't right in the implementation
[20:54:22] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[20:54:31] <reem> I thought the rule is also that a generic param can't be used before it's covered
[20:54:34] <acrichto> that test you linked do has Self owning T
[20:54:37] <reem> so the use in [T] first is problematic?
[20:54:59] <aturon> acrichto: reem: but in that test, T appears uncovered first, within Self
[20:55:20] <aturon> nmatsakis: halp
[20:55:20] *** Joins: wolenber (Mibbit@moz-sloa1b.wa.comcast.net)
[20:55:28] <nmatsakis> aturon: background?
[20:55:32] *** Quits: wolenber (Mibbit@moz-sloa1b.wa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:55:36] <aturon> is https://gist.github.com/alexcrichton/337d5585963f415c3d56 working as expected?
[20:56:03] <aturon> i may have misremembered how the covered first rule was supposed to work, but https://github.com/rust-lang/rust/blob/2c2879bbce4177552ce26c6445dcb7027a1245c7/src/test/run-pass/coherence-cow-1.rs suggests that the above gist should work
[20:56:09] <nmatsakis> sadly yes 
[20:56:27] <nmatsakis> well, in that case it's all within the self type
[20:56:44] <aturon> ok, i assumed the use of Pair there was supposed to work the same as having multiple inputs
[20:56:58] <nmatsakis> no, unfortunately not
[20:57:10] * nmatsakis dreads reopening these wounds
[20:57:34] <nmatsakis> but I feel like we've come across a few examples now where the covered first rule just isn't so great
[20:57:38] <nmatsakis> I guess PartialEq
[20:57:51] <nmatsakis> is the othe rone
[20:57:55] <reem> Any rule that isn't "every impl is allowed" is going to have some nasty cases
[20:58:12] <nmatsakis> yes, agreed
[20:58:18] <nmatsakis> but that doesn't mean we have to settle for the nasty cases we've got ;)
[20:58:34] <nmatsakis> but
[20:58:44] <nmatsakis> I don't know of a better choice unless we add some annotation
[20:58:57] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[20:59:13] <nmatsakis> which isn't -- I guess -- out of the question, but...I'm not thrilled about
[20:59:41] <aturon> yeah, though i'm not sure what annotation we would even use here
[20:59:42] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[20:59:51] <nmatsakis> I'm thinking of the "self-vs-auxiliary" concept
[21:00:07] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[21:00:12] <nmatsakis> if you extended the coverage rule to includde not just Self but also other type parameters that were annotated
[21:00:17] <aturon> ah, yes
[21:00:19] <nmatsakis> perhaps the first N parameters where N begins as 1 (just Self)
[21:00:25] <nmatsakis> then you could get both PartialEq and To to work like you wanted
[21:00:29] <nmatsakis> at the cost of 
[21:00:33] <nmatsakis> impls like
[21:00:42] <nmatsakis> impl<A,B> To<B> for Box<A> or something
[21:00:48] <nmatsakis> well
[21:00:53] *** Joins: reem (reem@moz-9m5ss2.coob.q2h1.0009.2601.IP)
[21:00:59] <nmatsakis> impl<A,B:FromBox<A>> To<B> for Box<A>
[21:01:11] <aturon> hm, yes
[21:01:14] <aturon> speaking of impls like that,
[21:01:26] <aturon> one way to address this problem is to introduce traits doing the conversion in the opposite direction
[21:01:30] <aturon> that is, with inputs reversed
[21:01:33] <aturon> with blanket impls
[21:01:34] <nmatsakis> yes
[21:01:39] <aturon> but... that seems brittle and overcomplicated
[21:01:45] <nmatsakis> feels very unnatural somehow
[21:01:54] <aturon> yes
[21:01:59] <aturon> ok, meeting time
[21:02:02] <nmatsakis> yes
[21:02:15] <nmatsakis> fn foo<T>(x: T) where String:From<T>
[21:02:31] <nmatsakis> we'd get to debate about a second set of names like as/to/into :)
[21:02:33] * reem actually likes the super-general, where-clause-oriented single trait approach
[21:02:39] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:03:00] <eddyb> nmatsakis: makes you wonder what concepts are hiding in our traits that 1.x will not properly express
[21:03:02] <aturon> reem: i could potentially get behind it too, but only with some additional elision
[21:03:10] <nmatsakis> I have this feeling that
[21:03:19] <nmatsakis> reordering the traits will also produce edge cases we are not happy with
[21:03:21] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:06:43] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[21:08:18] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[21:09:02] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[21:09:28] *** Quits: Amaranth (travis@moz-7203lo.cpe.cableone.net) (Quit: Sleep time...)
[21:10:10] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[21:11:47] *** Quits: ytain (ytain@moz-44k.q8p.140.24.IP) (Quit: Textual IRC Client: www.textualapp.com)
[21:12:43] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:13:13] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:13:21] *** Quits: jdm_ (jdm@moz-i5m.05u.207.66.IP) (Quit: )
[21:18:42] *** Quits: arielb1 (Ariel@moz-33pn30.red.bezeqint.net) (Quit: Ex-Chat)
[21:20:13] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[21:22:01] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[21:22:05] *** Joins: jgallagher (john@moz-6ge.dhn.131.24.IP)
[21:26:49] *** Joins: marsel (user@moz-5r8.6df.180.94.IP)
[21:26:54] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[21:27:05] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:29:55] *** Joins: Amaranth (travis@moz-1raqsl.cpe.cableone.net)
[21:30:21] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:30:32] *** Joins: srh (User@moz-tvc5sp.sntcca.sbcglobal.net)
[21:32:33] *** Joins: jdm (jdm@moz-mu9.06r.98.75.IP)
[21:35:22] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[21:36:05] *** Quits: Gankro_ (Mibbit@moz-i2bsgd.scs.carleton.ca) (Quit: http://www.mibbit.com ajax IRC Client)
[21:37:08] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:38:01] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:39:17] *** Quits: munksgaard (munksgaard@moz-1i4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[21:40:09] *** Quits: srh (User@moz-tvc5sp.sntcca.sbcglobal.net) (Quit: Leaving)
[21:42:08] <kimundi> How does $crate work exactly? does it expand to the name of the crate, or to the proper full path to it?
[21:43:15] <kimundi> mod foo { extern crate macro_provider; macro!() } // would htat expand $crate as foo::macro_provider?
[21:43:53] <kmc> you can't import macros from an `extern crate` except at the crate root
[21:44:12] <kimundi> ah, okay
[21:44:14] <kmc> it would be reasonable to allow it, and expand to the full path
[21:44:21] <kmc> but that's backwards-compatible
[21:44:39] <kmc> I'm still not really sold on `extern crate` inside modules
[21:45:22] <kimundi> the crate root is a module as well :P
[21:46:14] <kimundi> I see it as useful for bigger crates that make use of different libraries in independ parts
[21:46:36] <kimundi> no need to clobber the "global namespace" in the crate for that
[21:47:16] <brson> my feature-gating patch made it all the way through doc tests for the first time.
[21:47:23] <brson> rebasing again now
[21:47:35] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[21:48:03] <huon> aturon: I'm around now
[21:48:28] <aturon> huon: meeting with acrichto will ping again shortly after
[21:49:08] <steveklabnik> brson: wooo
[21:49:31] <huon> aturon: ok
[21:50:43] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[21:50:43] *** ChanServ sets mode: +o pcwalton
[21:52:35] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[21:53:13] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[21:53:13] <simukis> acrichto: err, discovered an issue with the concat! trick I did in println!
[21:53:45] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:54:12] *** Joins: bjz (bjz@moz-lailbo.tpgi.com.au)
[21:56:18] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:57:27] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:57:48] *** Quits: jdm (jdm@moz-mu9.06r.98.75.IP) (Connection closed)
[21:58:14] *** Joins: jdm (jdm@moz-mu9.06r.98.75.IP)
[21:58:17] *** Quits: bjz (bjz@moz-lailbo.tpgi.com.au) (Ping timeout: 121 seconds)
[22:00:02] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:01:07] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:03:09] *** Quits: jdm (jdm@moz-mu9.06r.98.75.IP) (Connection closed)
[22:03:17] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:03:44] *** Joins: jdm (jdm@moz-mu9.06r.98.75.IP)
[22:04:11] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[22:04:39] <simukis> guys
[22:04:41] <simukis> we have an issue
[22:04:43] <simukis> https://pastebin.mozilla.org/8826184
[22:05:33] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[22:05:35] <sfackler> kmc: "extern crate" outside the root is useful in cases where you have a #[cfg(..)]'d module, like #[cfg(test)] mod test { extern crate test; extern crate test_helpers; ... }
[22:05:48] <sfackler> or modules that provide feature-gated functionality like this one: https://github.com/sfackler/rust-postgres/blob/master/src/types/uuid.rs
[22:05:59] <simukis> https://pastebin.mozilla.org/8826186 this is the difference between write! and writeln! (and now print! and println! too)
[22:06:09] <sfackler> but those are the only two exceptions I personally make to putting extern crates at the root
[22:06:39] * simukis applies his hand to his face at high velocity because he forgot about play.rustlang.org
[22:06:45] <kmc> sfackler: I propose #[cfg(...)] in { extern crate test; extern crate test_helpers; ... }
[22:06:54] <kmc> i have a postponed RFC to that effect
[22:07:23] <sfackler> doesn't cover this case though: https://github.com/sfackler/rust-postgres/blob/master/src/types/mod.rs#L55-L56
[22:07:50] <sfackler> it's not the biggest deal in the world to just have a #[cfg(feature = "uuid")] at the crate root
[22:07:52] <sfackler> but...
[22:08:18] <kmc> #[cfg(feature = "uuid")] in { extern crate uuid; mod uuid; }
[22:08:28] <kmc> (er, you'd probably have to change one of the names)
[22:09:22] *** Joins: jdm_ (jdm@moz-mu9.06r.98.75.IP)
[22:09:25] *** Quits: jdm (jdm@moz-mu9.06r.98.75.IP) (Connection closed)
[22:10:19] *** Joins: acharles (acharles@moz-nemm4b.fosshotel.is)
[22:13:32] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:14:02] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:26:15] *** Joins: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com)
[22:27:17] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[22:28:08] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[22:39:21] *** Joins: jxv (jxv___@moz-qneod7.pk6i.d98i.030a.2602.IP)
[22:40:16] <acrichto> simukis: ohd ear
[22:40:19] <acrichto> that is unfortunate
[22:40:57] <bstrie> acrichto: mind letting me inside?
[22:41:19] <acrichto> bstrie: omw
[22:43:55] <simukis> die tydesc, die!
[22:47:30] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[22:47:46] <blaenk> no solicitors bstrie
[22:47:51] <blaenk> sry
[22:48:09] <blaenk> trying to sell us custom jvm impl
[22:48:09] *** Quits: scialex (scialex@moz-j5mi8i.cs.brown.edu) (Quit: Leaving)
[22:49:16] *** Joins: arrrrrrrrr (arrrrrrrrs@moz-69t4ps.dynamic.qsc.de)
[22:49:26] <arrrrrrrrr> pnkfelix: as is not about bits, e.g. f64 as u64
[22:49:34] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[22:49:35] <arrrrrrrrr> as can mean many things
[22:49:46] <arrrrrrrrr> e.g. &X as &Trait
[22:49:46] <pnkfelix> arrrrrrrrr: okay, yes, that's a counter-example
[22:50:14] <pnkfelix> arrrrrrrrr: though as pcwalton pointed out during the mtg, `as` for float<->int conversions may well be an anti-pattern anyway
[22:50:59] <pnkfelix> arrrrrrrrr: and arguably `&X as &Trait` would be better off expressed via type-ascription. maybe.
[22:51:06] <arrrrrrrrr> soon
[22:51:17] * nrc is just about to remove that as a valid cast...
[22:51:22] <arrrrrrrrr> you already don't need &X as &Trait today
[22:51:26] <arrrrrrrrr> &X coerces to &Trait
[22:51:33] <pnkfelix> arrrrrrrrr: right
[22:52:11] <pnkfelix> arrrrrrrrr: the point is that people *are* using it for bit-casts, and so this conflation of uses may be a problem overall
[22:52:40] <aturon> huon: ok, ready to chat 
[22:52:54] <aturon> huon: so, FromPrimitive is one of the next items on the stabilization list
[22:53:07] <aturon> it exists largely because of the derive support, for enums
[22:53:41] <aturon> (where `as` allows you to go from an enum to a numeric value, but there's no way back beside this derive mechanism)
[22:53:48] <huon> aturon: (whoops, just stepping out for a few minutes, will read backscroll, though)
[22:54:21] <aturon> huon: there are some possible ideas for a more principled approach to enum<->number conversion, but in the meantime people are relying on FromPrimitive
[22:54:50] <carllerche> Is there something like PhantomData but for lifetimes?
[22:55:07] <aturon> huon: so i'm interested in some shorter-term solution. one problem with FromPrimitive is that it is basically a whole bunch of conversion traits in one, where many conversions can fail dynamically
[22:55:27] <aturon> huon: i was wondering if it would be feasible to instead use something like a generic From trait, instantiated with a particular numeric type
[22:55:32] <arrrrrrrrr> carllerche: PhantomData<&'a ()>
[22:56:11] <carllerche> thanks
[22:56:57] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[23:03:01] <kmc> bstrie: how's it going :)
[23:06:14] *** Joins: mystor_ (mystor@moz-5cj.r78.15.130.IP)
[23:07:00] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[23:10:03] *** Joins: ikorin (ikorin@moz-3j6ic5.corp.etonreve.com)
[23:10:38] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:13:34] *** Quits: jdm_ (jdm@moz-mu9.06r.98.75.IP) (Quit: )
[23:15:43] <huon> aturon: back
[23:16:00] <blaenk> sup huon
[23:16:09] <blaenk> huon sup
[23:16:10] <huon> aturon: you mean get deriving to instantiate various From<u8> impls?
[23:16:14] <huon> blaenk: o/
[23:17:02] <huon> aturon: I believe that should be feasible
[23:17:21] <aturon> huon: well, ideally for arbitrary numeric types
[23:17:32] <aturon> oh maybe that's what "various" means :)
[23:17:33] <bstrie> kmc: I'm currently wondering what the odds are that these patches will apply cleanly :P
[23:18:10] <huon> aturon: yeah :)
[23:18:35] <aturon> huon: this would also enable more static checking, i imagine? and avoid the need for Option returns, as a result
[23:18:53] <huon> aturon: (I'm not sure if deriving supports parameterised traits now, but it shouldn't be a hard addition)
[23:18:56] <huon> aturon: yeah, seems like it
[23:18:57] <aturon> huon: one question is just what the syntax would look like, since i don't think `#[derive(From<u8>)]` is allowed
[23:19:03] <huon> ah, yeah :(
[23:19:32] <aturon> do you think this is something that could be done in the 1.0-ish timeframe?
[23:19:39] <sfackler> aturon: derive(From(u8, i32)]?
[23:19:48] <huon> aturon: getting the <u8> syntax... ?
[23:19:51] <aturon> works for me :)
[23:19:57] <huon> aturon: or just this in general?
[23:20:01] <aturon> huon: no, just getting this form of derive generally
[23:20:05] *** Joins: swgillespie (swgillespie@moz-upj.3un.220.167.IP)
[23:20:14] <huon> aturon: yeah
[23:20:15] <aturon> so that we can nix FromPrimitive but keep the functionality in a reasonably clean way
[23:20:20] <aturon> great news! :)
[23:20:22] <huon> aturon: as long as the trait exists
[23:20:32] <huon> (obviously... :P )
[23:20:33] <aturon> haha, that, i will take care of
[23:22:46] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.3.92.1)
[23:25:05] <sfackler> aturon: do we have a settled upon convention for Debug output for lists, maps, sets etc? Should they be Foo [a, b] or just [a, b]?
[23:26:13] <aturon> sfackler: https://github.com/aturon/rfcs/blob/show-string-guidelines/text/0000-show-string-guidelines.md#debugging-fmtdebug
[23:26:29] <aturon> sfackler: i believe today's use [a, b] or so
[23:27:31] <sfackler> I'm going to make a pass replacing all of the collections debug impls with ones that use the debug builders and am wondering if I should change the builder APIs to not ask for a name for maps and sets or make the debug impls add names in
[23:28:19] <reem> I'd want names for maps and sets
[23:28:37] <sfackler> cool
[23:28:38] <aturon> sfackler: reem: there's been a bunch of back-and-forth changes about this, cc acrichto 
[23:28:46] <aturon> i don't think it matters too much
[23:29:11] <reem> ya it's definitely not a huge deal either way
[23:29:15] <aturon> https://github.com/rust-lang/rust/pull/22157
[23:29:36] <aturon> i would basically take that PR at the standing interpretation of the RFC :)
[23:29:41] <aturon> as*
[23:30:26] <acrichto> sfackler: I think the resolution was to do one way at one point and the other way at another point
[23:30:30] <acrichto> I forget which was the most recent conclusion
[23:30:53] <aturon> conclusion: we don't know :)
[23:31:03] <acrichto> sfackler: if you were to remove the request to pass a name in I might accidentally overlook that aspect and r+ anyway
[23:32:32] *** Quits: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com) (Ping timeout: 121 seconds)
[23:32:34] *** Joins: brson (brson@moz-832.7vl.56.172.IP)
[23:32:34] *** ChanServ sets mode: +o brson
[23:32:35] <acrichto> aturon: how do you feel about stabilizing Iterator::cloned
[23:32:47] <acrichto> oh wait right the Deref generalization I didn't like
[23:32:51] <acrichto> grr nvmd
[23:33:02] <aturon> acrichto: would be good to explore the fallout from removing that
[23:33:12] <aturon> we're finding increasingly that that sort of blanket impl can cause coherence problems
[23:33:21] <acrichto> I don't think we can define it otherwise
[23:33:26] <acrichto> e.g. what would the signature look like?
[23:33:34] * acrichto shhould try again
[23:34:38] *** Quits: marsel (user@moz-5r8.6df.180.94.IP) (Ping timeout: 121 seconds)
[23:35:12] <aturon> acrichto: hm, because of lack of equality constraints, basically?
[23:36:05] <aturon> acrichto: can you add type parameters 'a, T and say Self::Iterator<Item=&'a T>?
[23:36:12] <aturon> acrichto: (and T: Clone)
[23:36:37] <acrichto> fn cloned<'a, T: 'a>(self) -> Cloned<Self>     where Self: Iterator<Item=&'a T>, T: Clone
[23:36:41] <acrichto> that's the signature I ended up with
[23:36:44] <aturon> yes
[23:36:44] <acrichto> that... seems wrong though
[23:36:50] <acrichto> e.g. shouldn't `cloned` have no type parameters on it?
[23:36:57] <acrichto> (as it does today)
[23:37:20] <acrichto> I'd be wary of stabilizing that precise signature
[23:37:30] <aturon> well, they're being introduced as names for the deref projection
[23:37:38] <acrichto> but shouldn't it be:
[23:37:49] <acrichto> fn cloned(self) -> Cloned<Self> where Self::Item = &T, T: Clone
[23:37:52] <acrichto> er hm
[23:37:53] <acrichto> no you're right
[23:37:59] <acrichto> maybe that is what the sig should look like
[23:38:02] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[23:38:06] <aturon> well, that's the intuition, but you need existentials in `where`
[23:38:13] <acrichto> oh right yes
[23:38:19] <aturon> and the generic is acting as the quantifier instead
[23:38:21] <acrichto> ok, this is probably good enough
[23:38:26] <huon> does someone know of someone better suited to review https://github.com/rust-lang/rust/pull/23457 ? (maybe acrichto?)
[23:38:39] <aturon> acrichto: that said, i'm not sure it's actually clearer than the current, more flexible signature...
[23:38:45] <kmc> bstrie: which patches?
[23:38:47] <acrichto> huon: sure, I can take over
[23:39:16] <acrichto> aturon: I feel like it's better than generalizing over Deref
[23:39:42] <acrichto> no one's gonna actually write a type parameter on the cloned method anyway
[23:39:46] <acrichto> and the struct contents are still I: Iterator
[23:39:47] <aturon> acrichto: unfortunately, since it's a trait, we can't generlize in the future
[23:40:07] <acrichto> hm, how so?
[23:40:14] <acrichto> (no one is overriding this method)
[23:40:26] <aturon> well, today it's in IteratorExt, so yes
[23:40:36] <aturon> but tomorrow it will be in Iterator (thanks sfackler!)
[23:41:00] <aturon> OTOH it's fairly useless to override, so maybe we could change the signature without breakage in practice
[23:41:01] <acrichto> true, but no one's gonna actually override
[23:41:20] <sfackler> speaking of that it seems like homu hasn't picked up the r+ on this? https://github.com/rust-lang/rust/pull/23438
[23:42:12] <aturon> acrichto: anyway, i don't have a strong preference here; we don't have a good convention in place for bounding by Deref
[23:42:18] <acrichto> sfackler: oh nrc probably isn't actually a reviewer
[23:42:24] <acrichto> nick29558118183 probably is
[23:42:37] <sfackler> ah, awkward
[23:42:40] <aturon> (when it shows up in a trait impl, it can be problematic for coherence, but here it doesn't matter)
[23:42:48] <sfackler> there it goes
[23:43:19] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[23:44:25] <acrichto> aturon: yeah I feel like this is a case of "technically a breaking change, but not practically"
[23:45:11] *** Quits: Diamond (dick@moz-s67uin.ok.cox.net) (Quit: Leaving.)
[23:48:41] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[23:48:52] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[23:49:15] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[23:49:41] <nrc> ah crap, I knew there was somewhere I forgot to update with the GH name change
[23:50:14] <acrichto> nrc: I added it though, so you should be good to go now at least :P
[23:50:27] <nrc> woo! thanks acrichto 
[23:54:13] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[23:54:29] *** Joins: arrrrrrr1 (arrrrrrrrs@moz-gjrm1c.dynamic.qsc.de)
[23:57:07] *** Quits: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com) (Connection closed)
[23:57:18] *** Quits: arrrrrrrrr (arrrrrrrrs@moz-69t4ps.dynamic.qsc.de) (Ping timeout: 121 seconds)
[23:59:26] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[23:59:41] <theme> Oh... great
[23:59:52] <theme> Someone *else* decided to oppose my RFC
[23:59:57] <theme> https://github.com/rust-lang/rfcs/pull/956#issuecomment-82504890
