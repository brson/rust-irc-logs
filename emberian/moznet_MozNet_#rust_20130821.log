[00:00:23] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[00:00:40] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[00:01:14] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[00:01:55] <graydon> 6% of LLVM-time is spent in memory fence and pthread rwlocks
[00:01:57] <graydon> grum
[00:02:15] <sully> I am getting super baffled about this rustpkg thing
[00:03:08] <ecr> brson: here's an idea. Listener.listen() takes self by value and gives you an Acceptor, which is basically an iterator over incoming connections.
[00:03:22] *** Joins: relrod (relrod@moz-AABB5D31.redhat.com)
[00:04:48] <brson> graydon: so far I can't even reproduce the original valgrind regression
[00:06:09] <graydon> brson: want me to try? which rev?
[00:06:52] <brson> graydon: no, not quite yet. it looks like there were some intermediate commits that don't show up on irfy. i can do some more bisection here i think
[00:07:29] *** Joins: zz_kimundi (kimundi@moz-7079BD56.dip0.t-ipconnect.de)
[00:07:49] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[00:07:53] *** zz_kimundi is now known as kimundi
[00:08:17] <graydon> pcwalton: bounced again
[00:08:32] <graydon> r=me for all subsequent attempts on that
[00:08:44] <cmr> brson: quite a lot of intermediate commits, if you're talking about the memory graphs
[00:08:58] <brson> cmr: yes. trying to diagnose that big pink regression
[00:08:58] <cmr> my bench setup is entirely borked right now
[00:09:26] <graydon> they're not updating. possibly because dbaupp's scripts need all results and we're not posting any -vg or -all results presently
[00:09:35] <toddaaro> pcwalton: based on what you said about explicit Self stuff in the runtime I think you should close the tree to land, otherwise every single runtime PR ever is going to bounce yours
[00:10:01] *** Quits: brendan (brendaneic@moz-68B19832.public.wayport.net) (Quit: brendan)
[00:11:25] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[00:12:09] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[00:12:10] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:12:11] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b32bf8d to 143cd978f: 02http://git.io/N3iJvQ
[00:12:11] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:12:12] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:12:12] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/9r1tcA
[00:12:12] <ghrust> 13rust/06auto 1497555e8 15Eric Reed: Derive Clone for IpAddr and SocketAddr
[00:12:12] <ghrust> 13rust/06auto 14f68514c 15Eric Reed: Do not execute the callback before cleaning up resources.
[00:12:12] <ghrust> 13rust/06auto 1488f7183 15Eric Reed: Instruct event loops to ignore SIGPIPE when constructed....
[00:12:14] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:13:36] <toddaaro> pcwalton: also, what is going on in this PR?
[00:13:37] <bblum> this fix contains a comment that says "Danger!!!"
[00:13:40] <bblum> c.c
[00:14:09] <toddaaro> pcwalton: the removal of the type paramater from thse use is really syntactically horrifying, is this some sort of temporary bug?
[00:14:22] <toddaaro> the 
[00:14:55] <toddaaro> "let sched: ~Scheduler = Local::take();" bothers me compared to let sched = Local::take::<Scheduler>();
[00:14:56] *** Parts: lizzard (ehenry@moz-5A4BE8E8.dsl.static.sonic.net) ()
[00:15:22] <bblum> yeah, that doesn't look great
[00:15:23] <ecr>  woo! now hopefully nothing in the test suite broke my IO PR since yesterday.
[00:15:46] <bblum> toddaaro: a parallel usage that looks better is, like, "let foo: HashMap<Foo> = bar.iter().map(...).collect()"
[00:16:10] * graydon perfectly willing to close tree, fwiw. just need notice to turn off bors.
[00:16:15] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:17:06] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[00:18:13] <toddaaro> bblum: hm, yea I guess it can go either way
[00:18:41] <brson> toddaaro bblum: Self type parameters are going to be added back in a different form. Current proposal is I think `Local::<for Scheduler>::take()`
[00:18:43] <toddaaro> but skimming it over there are 125 changed files and I know every PR of mine certainly will conflict
[00:18:52] <bblum> "for Scheduler"?
[00:18:57] <bblum> hmm
[00:19:08] <brson> yeah, to disambiguate it from non-self typarams
[00:19:21] <bblum> where 'non-self' refers to?
[00:19:23] <toddaaro> would the syntax in use now post-change also stay?
[00:19:43] <brson> bblum: `trait Foo<T: NonSelfTyParam>`
[00:20:03] <brson> `Foo::<for Bar, Baz>::quux()`
[00:20:24] <bblum> i'm not sure i understand where the ambiguity is
[00:23:11] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr)
[00:23:35] <bjz> bblum: say if the associated function has type params on it as well
[00:24:36] <bjz> impl<T> X<T> { fn x<U>() -> X { ... } } X::new::<???>()
[00:25:15] <bjz> X::<T>::x::<U>()
[00:25:22] <bblum> oh, i see
[00:25:38] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:25:50] <bjz> the verbosity is a little... ugly, but at least you can be explicit now
[00:26:12] <bjz> I've had loads of trouble with this in the past
[00:26:44] <bjz> you'd have to do X::x::<T, U>()
[00:27:05] <bjz> but when T itself took type params things just got insane
[00:27:19] <bjz> (no combination of params I tried worked)
[00:28:11] <bjz> eg: impl <T, U: Foo<T>> X<U> { ... }
[00:29:37] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[00:30:22] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[00:32:07] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:35:06] *** Parts: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) ()
[00:36:02] *** Quits: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se) (Ping timeout)
[00:36:22] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[00:36:24] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[00:37:57] *** Quits: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[00:38:10] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:38:18] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[00:39:17] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[00:39:55] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[00:39:58] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[00:41:35] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[00:41:50] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[00:44:26] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[00:44:26] *** ChanServ sets mode: +o dherman
[00:47:39] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[00:49:17] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[00:49:35] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[00:49:45] *** Quits: heftig (heftig@moz-2A9BA790.dip0.t-ipconnect.de) (Ping timeout)
[00:50:45] * bstrie filling out mozilla summit travel form
[00:50:50] * bstrie "This form is due no later than July 31st, 2013"
[00:50:55] * bstrie received from on august 16
[00:51:08] * bstrie :(
[00:51:16] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Ping timeout)
[00:51:31] *** Joins: heftig (heftig@moz-B80FE22D.dip0.t-ipconnect.de)
[00:51:35] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[00:51:52] *** Quits: relrod (relrod@moz-AABB5D31.redhat.com) (Ping timeout)
[00:52:01] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[00:52:02] *** ChanServ sets mode: +o dherman
[00:52:22] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:52:47] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Client exited)
[00:55:26] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:55:31] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[00:55:31] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[00:55:52] *** Joins: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com)
[00:56:22] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[00:57:14] *** Joins: relrod (relrod@moz-AABB5D31.redhat.com)
[00:57:49] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[01:02:42] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:03:10] *** Quits: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:04:29] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[01:05:29] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[01:06:32] *** Joins: ab (alex@BC9D99CC.37C1012D.FE617B51.IP)
[01:06:44] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:07:52] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:08:02] *** Joins: richard|s (mindginati@moz-C1729134.dsl.clear.net.nz)
[01:08:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:11:21] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[01:11:33] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[01:12:19] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[01:12:48] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:13:15] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:13:57] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[01:15:07] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[01:20:04] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[01:24:15] *** Joins: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[01:25:37] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[01:25:37] *** ChanServ sets mode: +o dherman
[01:26:21] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[01:26:51] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:28:42] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:29:56] *** Quits: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:32:07] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[01:36:24] *** nrc is now known as nrc|afk
[01:38:03] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:38:47] <acrichto> graydon: was the bors scanning frequency turned up to 10 minutes to get around rate limiting?
[01:38:50] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[01:39:18] *** Quits: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[01:41:10] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[01:41:25] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:41:58] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[01:41:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/9r1tcA
[01:41:58] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[01:45:00] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[01:47:16] <vadimcn> I see upwards of 200 tests marked "xfail-fast".   Does anyone remember what are the reasons for marking a test in this way?   I've tried removing xfail-fast on a few of them and they seem to pass "make check-fast" just fine, at least on Windows...
[01:48:06] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[01:48:30] <cmr> something about symbol names iirc
[01:48:32] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[01:48:33] <acrichto> vadimcn: most of those are just because the windows test runner concatenates all tests instead of testing in isolation, so things like `extern mod` don't always work
[01:48:34] <cmr> maybe not
[01:48:53] <acrichto> vadimcn: at least that's why I always use xfail-fast
[01:48:56] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[01:49:12] <brson> vadimcn: it happens for lots of possibly transient reasons that are often not investigated. if it seems to pass on windows then please do un-xfail
[01:49:53] <vadimcn> ok.  
[01:49:54] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[01:50:00] <vadimcn> Also, it would appear that unit tests are not run on Windows either?
[01:50:36] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[01:50:53] <brson> vadimcn: not sure. std and extra should be run as part of check-fast (imo) but i wouldn't be surprised if that's not happening
[01:51:24] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[01:51:31] <nmatsakis> graydon: pong
[01:51:37] <vadimcn> brson: to the best of my understanding, they aren't
[01:51:51] <brson> cmr: re your lz4 patch, is lz4 adjustable to different compression ratios and can we possibly set it to the lightest ratio to get better perf?
[01:51:57] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:51:57] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/nzZY1w
[01:51:57] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:51:59] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:51:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/o6p1TQ
[01:51:59] <ghrust> 13rust/06auto 14352ac2e 15toddaaro: Fixed a memory leak caused by the singleton idle callback failing to close correctly. The problem was that the close function requires running inside a callback in the event loop, but we were trying to close the idle watcher after the loop returned from run. The fix was to just call run again to process this callback. There is an additional tweak to move the initialization logic fully into bootstrap, so 
[01:52:02] <ghrust> 13rust/06auto 14d56b9b1 15bors: auto merge of #8656 : toddaaro/rust/idle-opt+cleaning, r=brson...
[01:52:02] *** Joins: z0w0 (corrz@C3BC732A.9254B1A4.F22F0031.IP)
[01:52:04] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:52:05] <cmr> brson: there are only two modes.
[01:52:13] <cmr> brson: terrible-compression, and bad-compression :P
[01:52:28] <vadimcn> brson: which would explain why I see some fail when I run "make check-stage[N]-std"
[01:53:20] *** Joins: maik_ (maik___@moz-31CCDD8A.dip0.t-ipconnect.de)
[01:53:21] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:53:38] <cmr> brson: it'd probably be better to check out lzma2, which is configurable
[01:53:45] <cmr> better compression too
[01:54:04] <cmr> http://tukaani.org/xz/ liblzma
[01:54:11] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[01:54:22] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[01:54:47] <cmr> I was in the middle of writing bindings for liblzma before I got distrated and stopped
[01:56:44] *** Quits: maik_ (maik___@moz-31CCDD8A.dip0.t-ipconnect.de) (Ping timeout)
[01:56:44] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[02:00:16] <nmatsakis> graydon: do you have any idea what 0xffffffff810940d0 is in the profiles?
[02:03:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:05:16] <nmatsakis> bblum: r+'d
[02:07:29] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Quit: Leaving)
[02:07:54] <brson> vadimcn: I would r+ a patch that turned on stdtest and extratest for `make check-fast`. the windows bots have plenty of perf to spare
[02:09:55] <vadimcn> I just tried running "make check-stage1-std" and it failed on the first #[should-fail] test
[02:10:11] <vadimcn> Which is probably why they are not run on Windows
[02:10:58] <vadimcn> They can be turned on after my stack unwinding PR goes through
[02:12:50] <brson> vadimcn: should_fail tests generally have #[ignore(cfg(windows))] also, though I guess people have getting lax about it since we're not even testing anymore
[02:13:17] <vadimcn> in compiletests, not in unit tests
[02:14:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:14:15] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[02:14:20] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[02:15:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[02:16:22] *** Quits: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr) (Ping timeout)
[02:16:49] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[02:16:49] *** ChanServ sets mode: +o tjc
[02:17:13] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:17:26] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[02:19:21] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[02:21:39] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[02:25:06] <brson> cmr: the benchmarks i'm looking at don't seem to show lzma2 being faster than gzip
[02:25:17] <brson> cmr: do you know anything about lzop?
[02:25:56] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Quit: No Ping reply in 180 seconds.)
[02:26:02] <strcat> brson: lzo/lz4 are faster but don't compress as well
[02:26:38] <brson> i'm most concerned with speed
[02:26:40] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[02:26:48] <cmr> metadata is huge
[02:26:53] <strcat> brson: http://code.google.com/p/lz4/ there's a little chart there
[02:27:48] <strcat> lz4's high compression mode would compress about as well, and about as fast, but decompress 6x faster
[02:28:05] <cmr> I found that to be false
[02:28:11] * strcat shrugs
[02:28:14] <cmr> It compressed slower, made larger output, but was much faster decompressing
[02:28:15] <brson> high-compression decompresses *faster*?
[02:28:35] <strcat> brson: yeah it spends more work compressing
[02:28:36] <cmr> brson: compared to gzip
[02:28:44] <strcat> so it's smaller than the low compression mode and can be read faster
[02:28:45] <cmr> no?
[02:28:45] <brson> what I'm most concerned about is `make check` speed. it's hard to guess wither compresses slow/decompresses fast is a good tradeof
[02:28:46] * cmr looks
[02:29:21] <cmr> brson: well, revive my branch and measure make check I guess?
[02:29:26] <cmr> it shouldn't be too rotted
[02:29:31] <brson> cmr: do you remember if we compared total `make check` time under lz4 or if we just compared individual compiles?
[02:29:38] <brson> ok, i'll try that
[02:29:38] <strcat> brson: LZMA2 is similar (huge compression time, short decompression) but it leans waaaaay towards getting the best compression ratio
[02:29:41] <cmr> brson: I just looked at individual compiles iirc
[02:30:04] * strcat would try lzo, lz4 and lz4_hc
[02:30:05] <cmr> I also looked at the build, not the testsuite, and the build got slower because decompression took longer
[02:30:13] <strcat> you could also try snappy but..... snappy is apparently not very good on non-x86
[02:30:27] <strcat> maybe not true anymore
[02:30:44] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[02:30:53] <brson> i'm thinking though that we should just add a mode that completely turns off compression on the bots, which makes the whole endeavor moot
[02:31:06] <brson> not compressing at all is going to be faster than any compression
[02:31:47] <Peng> if disk I/O is a problem, compressing can be faster
[02:32:08] <brson> possibly yeah
[02:32:17] <cmr> it's going to be in the disk cache after the first run, and then subsequently loaded from the cache during the next few thousand
[02:32:51] <strcat> brson: does it load all the metadata to memory and then stop touching it? or does it keep reading?
[02:33:53] <brson> strcat: the entire metadata segment is loaded and decompressed at once
[02:34:12] <strcat> brson: do we use mmap + MADV_SEQUENTIAL? that'd probably help at least a bit
[02:34:21] <cmr> we get it from llvm
[02:34:25] <strcat> oh
[02:34:27] <strcat> and LLVM surely does
[02:35:33] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[02:35:37] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[02:36:05] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[02:36:07] <cmr> brson: iirc metadata is decompressed, and then the EBML is decoded every single time it's accessed, and decoding ebml is quite slow, it would also be beneficial (few percent speedup) to only decode it once
[02:36:19] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:36:51] <cmr> unfortunately we don't have a better way of encoding than ebml atm
[02:37:06] <ChrisMorgan> XML?
[02:37:08] <cmr> it and json are the only encoders/decoders supported by extra::serialize
[02:37:38] <cmr> ChrisMorgan: ebml : xml :: bson : json
[02:39:16] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[02:39:30] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[02:39:33] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[02:40:11] <SingingBoyo> what's the best way to declare global string constants for use as json keys?  keep having to use CONSTANT.to_owned() everywhere.
[02:40:24] <cmr> SingingBoyo: that is the best way unfortunately
[02:41:15] <strcat> json could use stringref
[02:41:17] <strcat> if that landed
[02:41:34] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[02:41:45] <strcat> or not, maybe not worth the cost
[02:41:56] <cmr> it'd still need to_owned(), you can't have a static ~str, and it takes ownership
[02:42:43] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Quit: Leaving)
[02:45:20] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[02:46:03] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[02:49:12] * brson dinner
[02:50:20] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[02:50:53] <bjz> SingingBoyo: you could have functions that return the keys
[02:52:04] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[02:52:22] <bjz> SingingBoyo: maybe generated with a macro? Magybe not ideal though
[02:54:09] <SingingBoyo> bjz: I don't know if I want my code to look like I'm calling my constants all the time.  got it working with to_owned everywhere for now, might look at it again later
[02:54:11] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[02:55:03] <bjz> mm
[02:55:06] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[02:55:29] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[02:56:01] <bjz> SingingBoyo: it can get frustrating, but it is useful to get feedback as to where copies/allocations are occuring
[02:57:26] <SingingBoyo> bjz: yeah I really don't want to copy my strings, but it seems like I need to in order to use the json module.
[02:58:05] <bjz> might be a limitation on the JSON module side of things. dunno
[02:59:51] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[02:59:56] *** Joins: lahwran (lahwran@lahwran.net)
[03:00:07] *** Joins: kimundi_ (kimundi@moz-BFDA4039.dip0.t-ipconnect.de)
[03:00:30] * strcat wonders if a 3MiB size increase from 0.7.1733.g2246d56 to 0.7.1773.ga8c3fe4 is worth bisecting
[03:00:57] *** Quits: kimundi (kimundi@moz-7079BD56.dip0.t-ipconnect.de) (Ping timeout)
[03:00:57] *** kimundi_ is now known as kimundi
[03:01:30] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:01:32] *** nrc|afk is now known as nrc
[03:01:41] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[03:03:17] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:04:14] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[03:05:41] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:06:35] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:06:37] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[03:08:06] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:08:32] *** sam113101 is now known as sam113101_afk
[03:08:32] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[03:08:50] *** sam113101_afk is now known as sam113101
[03:09:41] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:11:42] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[03:11:54] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:11:54] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/o6p1TQ
[03:11:54] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:11:56] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[03:11:59] *** Joins: bjzaba (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[03:11:59] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[03:12:09] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[03:12:55] *** Quits: heftig (heftig@moz-B80FE22D.dip0.t-ipconnect.de) (Quit: Quitting)
[03:14:21] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:16:01] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[03:17:26] *** Joins: heftig (heftig@moz-B80FE22D.dip0.t-ipconnect.de)
[03:20:39] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:21:52] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:21:52] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/p3Ii-Q
[03:21:52] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:21:54] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:21:54] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/JofkWg
[03:21:54] <ghrust> 13rust/06auto 14369f7fa 15Ben Blum: Prevent Send, Freeze, and Sized from being manually implemented. Close #8517.
[03:21:54] <ghrust> 13rust/06auto 1469322d9 15Ben Blum: Allow traits to use builtin kinds as supertraits for #7083.
[03:21:54] <ghrust> 13rust/06auto 144ca2e55 15Ben Blum: Add tests for #7083.
[03:21:55] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:30:40] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:32:24] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:32:25] *** ChanServ sets mode: +o dherman
[03:34:03] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[03:35:46] <SingingBoyo> is there a way to combine four options into one?  so if one or more is None, the result is None, otherwise it's Some(resultOfMethod)
[03:36:28] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[03:36:42] <strcat> SingingBoyo: chain
[03:37:42] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[03:38:20] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[03:40:27] <enix> rusts support for simd types is pretty sweet
[03:40:39] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[03:41:08] <enix> i have pure rust, constant time AES-CBC decryption running at 50% speed of a lookup based imlementation
[03:41:29] <bjzaba> we have simd?
[03:42:06] <enix> yes - #[simd]
[03:42:18] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[03:42:36] <enix> you can find pre-defined simd types in std::unstable::simd
[03:42:39] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[03:42:59] <enix> however, it seems like some stuff doesn't work cross-crate; but you can define your own simd types to overcome that
[03:43:58] <enix> in my case, i'm really just using them for their bigger register sizes, though
[03:44:19] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[03:44:32] <aatch> SingingBoyo, depends on what you want to do, precisely
[03:44:55] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[03:45:11] <SingingBoyo> aatch:  basically I'm pulling four values out of a map using find, then want to call a method that takes those values
[03:46:15] <SingingBoyo> aatch: but the method takes ~str values, and I have four Option<~str> values.
[03:46:31] <aatch> SingingBoyo, well you could use .chain and nest it for each one.
[03:46:41] <aatch> It's not the prettiest, but it would work.
[03:47:22] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:47:48] <aatch> Hmm, on second thoughts, that wouldn't work.
[03:48:44] <SingingBoyo> aatch: nested map might be what I want though
[03:49:14] <aatch> No, it would. Sorry, I'm messing up between `map` and `chain`
[03:51:13] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[03:51:38] <aatch> so it'd be something like `do opt1.chain |v1| { do opt2.chain |v2| { do opt3.chain |v3| { do opt4.chain |v4| { do_something(v1,v2,v3,v4) } } } }`
[03:52:42] <aatch> (or Some(do_something(...)))
[03:53:40] <SingingBoyo> yeah.  though for Some(...) you can just use opt4.map |v4| { do_something(...) }
[03:53:58] <SingingBoyo> which may or may not ruin readability but the whole thing is ugly anyway/
[03:53:59] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[03:54:33] <aatch> SingingBoyo, I don't think there is pretty way to do it...
[03:56:10] <bjzaba> aatch: it could also get ugly if you want to do multiple .with_c_strs
[03:56:18] <bjzaba> for example
[03:56:20] <bjzaba> :/
[03:56:23] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:56:35] <SingingBoyo> wish we had either monad support or currying. ah well.
[03:56:40] <bjzaba> mm
[03:56:52] <bjzaba> yup
[03:56:54] <aatch> Sometimes code is a bit ugly.
[03:57:17] *** Joins: ChrisMorgan (chris@moz-577E5F7F.its.monash.edu.au)
[03:57:29] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[03:57:40] <SingingBoyo> wonder if it's possible to write a macro to 'curry' a function into a bunch of smaller functions that take the next argument
[03:58:55] <Eridius> maybe with a recursive macro?
[03:59:03] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[04:01:52] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:01:52] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145668c83 to 14d56b9b1: 02http://git.io/N3iJvQ
[04:01:52] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:01:54] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:01:54] <ghrust> 01[13rust01] 15bors pushed 11 new commits to 06auto: 02http://git.io/ptHvGQ
[04:01:54] <ghrust> 13rust/06auto 146e19248 15Tim Chevalier: testsuite: Tests for #6458. Closes #6458
[04:01:54] <ghrust> 13rust/06auto 14cc60518 15Tim Chevalier: std/extra: changing XXX to FIXME; cleanup...
[04:01:55] <ghrust> 13rust/06auto 1489899fd 15Tim Chevalier: extra: change alloc to take &mut self, as per XXX comment
[04:01:57] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:05:20] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[04:14:41] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:16:21] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:17:15] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:17:18] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:17:18] *** ChanServ sets mode: +o brson
[04:18:25] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[04:18:58] *** Quits: wilkie (wilkie@moz-A435EAAD.pitbpa.fios.verizon.net) (Ping timeout)
[04:19:08] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[04:21:05] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[04:21:27] <klutzy> is jemalloc used on windows?
[04:21:37] <SingingBoyo> is there a way to consume something like a json::String to just get the value from it?
[04:23:52] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:24:31] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:24:38] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[04:24:59] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[04:25:10] *** Joins: wilkie (wilkie@moz-A435EAAD.pitbpa.fios.verizon.net)
[04:26:07] *** Joins: mibitzi__ (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[04:27:16] *** Quits: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[04:27:27] *** Joins: mibitzi (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[04:27:49] *** Quits: mibitzi__ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[04:28:20] *** Joins: brson (brson@5F06B402.AD1E507F.3688B332.IP)
[04:28:20] *** ChanServ sets mode: +o brson
[04:29:15] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Client exited)
[04:30:11] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[04:31:13] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:34:05] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[04:37:22] * lkuper is kind of stoked that `M-x package-install rust-mode RET` Just Worked, just now
[04:37:28] <lkuper> thanks, whoever did that!
[04:39:08] <klutzy> seems like buildbot does not build jemalloc on windows, right? there is no "jemalloc" in stdio
[04:39:33] <klutzy> I'm curious of it because my machine tries to build jemalloc and fails
[04:41:00] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Quit: Leaving)
[04:41:27] <brson> klutzy: i think we do use jemalloc on windows
[04:41:52] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:41:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14895ac46 to 14d56b9b1: 02http://git.io/N3iJvQ
[04:41:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:41:53] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:41:53] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Mnk_Nw
[04:41:53] <ghrust> 13rust/06auto 144457d2b 15Do Nhat Minh: fix for #8088 (Cannot name a struct field `new` due to ancient syntax)...
[04:41:53] <ghrust> 13rust/06auto 1400dd9e9 15bors: auto merge of #8573 : mrordinaire/rust/struct-new-as-field-name, r=alexcrichton...
[04:41:54] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:44:07] <klutzy> brson: I'm looking recent buildlog http://buildbot.rust-lang.org/builders/auto-win-32-opt/builds/1006
[04:44:25] <klutzy> but I can't find "jemalloc" on make log
[04:46:01] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[04:46:35] <brson> klutzy: oh, hey I don't see the build rule that *actually links jemalloc*
[04:46:36] <brson> lol
[04:46:47] <brson> maybe we're not building it at all
[04:47:19] <klutzy> oh wow
[04:47:53] <brson> klutzy: but you say you have a jemalloc-related build error?
[04:47:54] *** Quits: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[04:48:13] <klutzy> brson: yes!
[04:48:37] <brson> oh, maybe i'm looking at the wrong workspace
[04:48:38] *** Joins: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net)
[04:48:40] *** Joins: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[04:48:41] <brson> oof
[04:52:36] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[04:54:13] <brson> klutzy: my previous assesment was wrong and I can't explain why the windows bot doesn't mention jemalloc
[04:59:33] *** Quits: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP) (Ping timeout)
[05:00:29] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[05:10:14] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[05:12:36] *** Joins: mihneadb (Mihnea@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[05:15:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:16:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[05:21:39] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Quit: Leaving)
[05:23:02] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[05:23:33] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[05:23:35] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:23:40] <klutzy> brson: made an issue for record https://github.com/mozilla/rust/issues/8662
[05:25:40] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[05:26:00] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[05:26:38] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Input/output error)
[05:26:49] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[05:27:26] <olsonjeffery> brson: ping
[05:29:07] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[05:31:32] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[05:32:19] <brson> olsonjeffery: pong
[05:33:09] <olsonjeffery> brson: curious if you want homing io stuff for FileStream to land that patch
[05:33:47] <olsonjeffery> and i guess, would be cool if you, acrichto and me could talk about pipe, etc work
[05:34:38] <acrichto> I've got a few minutes if you guys do as well
[05:34:49] <olsonjeffery> process spawning in libuv has all of the stuff to get the fd to write to child processes (strictly speaking it's hooked up to a pipe)
[05:35:08] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[05:35:50] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[05:36:16] <acrichto> it doesn't have to be a uv_pipe_t though, you can redirect from previous file descriptors and things like that. And I think even arbitrary uv_stream_t works as well
[05:36:56] <olsonjeffery> nice
[05:37:06] <acrichto> https://github.com/mozilla/rust/pull/8645/files#L15R56
[05:37:13] <acrichto> those are the options that libuv gives us
[05:37:40] <acrichto> although the stream/pipe bindings aren't tested at all yet, just pipes at a bare minimum are used
[05:37:55] <acrichto> I haven't looked too much into libuv's pipes, but it looks like you create pipes and then attach them to other streams and things maybe?
[05:38:24] *** Quits: veddan (viktor@moz-C79BC80B.csbnet.se) (Client exited)
[05:39:15] <brson> olsonjeffery: no, homing is not necessary for landing
[05:39:18] <acrichto> there's some cool stuff you can do like sending file descriptors over a pipe, but making bindings for that could get interesting
[05:39:21] <bjzaba> rusti: macro_rules ! foo(($name:ident) => ("$name")) foo!(hi)
[05:39:25] -rusti- "$name"
[05:39:30] <bjzaba> :/
[05:39:35] <brson> do either of you know what limitations uv pipes have on windows?
[05:39:54] <bjzaba> pauls: why does that not work? ^
[05:40:16] <brson> acrichto: does your patch actually replace std::run?
[05:40:17] <bjzaba> rusti: macro_rules ! foo(($name:ident) => (stringify!(name))) foo!(hi)
[05:40:18] -rusti- "name"
[05:40:25] <acrichto> just from looking at the uv.h header it says that unix pipes are "domain sockets" and windows pipes are "named pipes" so if those have known limitations I imagine that uv has the same
[05:40:35] <acrichto> brson: it reimplements the std::run interface
[05:40:42] <acrichto> entirely on libuv
[05:40:46] <acrichto> include child I/O
[05:40:52] <brson> damn you did that fast
[05:41:03] <olsonjeffery> yeah it looks nice
[05:41:11] <acrichto> turns out an excellently written runtime helps a lot :)
[05:41:28] <acrichto> like once I saw how olsonjeffery was doing things and I started doing the same, everything fit together so nicely
[05:41:41] <brson> go team!
[05:42:23] <acrichto> it's not as nice as I would like though
[05:42:48] <acrichto> libuv gives us some more information about the process which we're not surfacing, but I think that it'd be better to do that separately with a redesign of the std::run interface as well
[05:42:51] <brson> ok, I'll definitely spend tomorrow looking through all this. sorry i didn't get to it today
[05:42:53] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[05:43:05] <aatch> bjzaba, that first macro doesn't work because macros work on syntax objects and a string literal is a single syntax object.
[05:43:15] <acrichto> brson: no problem at all :)
[05:43:19] <aatch> rusti: macro_rules ! foo(($name:ident) => (stringify!($name))) foo!(hi)
[05:43:20] -rusti- "hi"
[05:43:21] <brson> are there going to be any problems merging olsonjeffery's patch and acrichto's? is there overlap?
[05:43:31] <olsonjeffery> rtio and uvio
[05:43:33] <acrichto> I would imagine that there's lots of conflicts
[05:43:34] <olsonjeffery> possile conflicts there
[05:43:41] <bjzaba> aatch: yeah I did that before^
[05:43:53] <olsonjeffery> rust_uv.cpp also i imagine?
[05:44:00] <olsonjeffery> i have a bunch of merge conflicts there to sort out against master
[05:44:21] <olsonjeffery> i added helpers to get all of the open(2) bitmasks, then removed them in subsequent commits
[05:44:46] <olsonjeffery> good times. i should probably squash my PR and remove that altogether
[05:46:24] <olsonjeffery> brson: also, one initial comment from graydon was that i punted to lseek(2) in order to make the Seek trait happen.. it's encapsulated in UvFileStream. he suggested removing that and using positional read/write for everything and keeping track of the seek cursor on our end
[05:46:26] *** Quits: valenting (Thunderbir@8758046C.84D5EFD5.FB866788.IP) (Ping timeout)
[05:46:43] <brson> olsonjeffery: agreed
[05:46:51] <olsonjeffery> ok. so ill do that.
[05:47:11] <olsonjeffery> im fine with letting acrichto's change go first and ill rebase atop of that
[05:47:18] <olsonjeffery> that'll give me a chance to do the homing io stuff
[05:47:47] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[05:49:22] <brson> acrichto: does rt::process deal with multithreading yet?
[05:49:37] <brson> i.e. implement HomedIO
[05:49:41] <acrichto> brson: yes
[05:50:02] <olsonjeffery> brson: feelings on seeking outside of the file boundary? the man pages for fseek, pread, pwrite, etc don't specify here
[05:50:34] <olsonjeffery> to "do it right", id have to impl uv_fs_stat(), i guess, to get the file size so we can fail when seek'ing or attempting to read/write outside of that boundary?
[05:50:56] <brson> olsonjeffery: can you look into what other sane libraries do?
[05:51:05] <olsonjeffery> ok
[05:51:06] <steven_is_false> Hi. So I have a really crazy idea that I got while playing around with Java, and I wanted to get feedback on it. http://pastebin.mozilla.org/ . In rust exec would take a function fn(&mut T) for some T. I know this looks extremely weird but the alternative has each Actor object have a kill, and a join method which is terrible complicated.
[05:51:31] <acrichto> olsonjeffery: if it's just an internal cursor, it could just report errors for subsequent reads writes, but doing what other libraries do probably also seems best
[05:52:06] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[05:52:19] <brson> olsonjeffery:  does uv's read and write give us feedback when reading an out-of-bounds offset?
[05:52:27] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[05:52:42] <brson> i.e. do we *need* to go do a seperate fstat?
[05:52:52] <brson> i guess we'd have to if seek is a different op than read/write
[05:53:09] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Connection reset by peer)
[05:53:27] *** Quits: telotortium (rmi1@moz-90BFA359.dhcp.mdsn.wi.charter.com) (Ping timeout)
[05:53:34] <brson> that is unless we do what acrichto suggested and wait until the read/write to error
[05:53:39] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[05:54:05] <acrichto> it'd be more "performant" with on less syscall, but I'm not sure anyone would ever notice. If you're writing a pure-seek benchmark it doesn't really mean much anyway
[05:54:47] <steven_is_false> Basically, my idea allows one to have logical workers which can be garbage collected.
[05:55:53] <steven_is_false> How will Rust's garbage collector respond to short lived objects?
[05:56:13] <brson> steven_is_false: your link is missing some info
[05:56:13] <steven_is_false> If one generates lots, and lots of little threads that's not going to cause any problems right?
[05:56:34] <steven_is_false> brson: http://pastebin.mozilla.org/2891818 Sorry.
[05:58:07] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:58:19] <steven_is_false> Would this actually work in Rust though with GC even if only one thread would touch a value T at a time?
[05:58:25] *** Quits: brson (brson@5F06B402.AD1E507F.3688B332.IP) (Ping timeout)
[05:59:31] *** Joins: telotortium (rmi1@moz-90BFA359.dhcp.mdsn.wi.charter.com)
[05:59:32] <steven_is_false> Basically, this is emulating lazy evaluation with threads so I expect some smarter implemention could be made.
[06:00:04] *** Joins: brson (brson@5D3B67E3.71E1659D.DFB5E910.IP)
[06:00:04] *** ChanServ sets mode: +o brson
[06:00:19] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[06:01:14] <steven_is_false> So here's a user of the class to clear up how it's supposed to work http://pastebin.mozilla.org/2891840
[06:01:18] *** Joins: RMF_ (RMF@100FCB1B.10FB11BA.8D19547B.IP)
[06:01:46] *** Quits: RMF (RMF@moz-BE8171F5.dsl.telepac.pt) (Ping timeout)
[06:01:52] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:01:52] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Mnk_Nw
[06:01:52] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:03:13] <brson> steven_is_false: i don't fully understand yet, but lots of small tasks is not going to be a problem
[06:03:22] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:03:32] <steven_is_false> brson: Cool.
[06:03:56] *** Quits: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:03:59] <olsonjeffery> brson: i found conflicting docs for reading-beyond-eof on linux.. http://linux.die.net/man/3/read <-- says will set errno to EOVERFLOW
[06:04:05] <steven_is_false> On the JVM, or Rust, or both?
[06:04:06] <olsonjeffery> but i don't have read(3) on my machine
[06:04:12] <brson> steven_is_false: rust
[06:04:16] <olsonjeffery> and read(2) and pread(2) don't specify EOVERFLOW
[06:04:24] <steven_is_false> good :)
[06:04:52] <brson> steven_is_false: you want to spawn &fn's into subtasks though?
[06:05:28] <olsonjeffery> anyways. im gonna crash. python's seek/read docs don't say anything. that's where i stopped my search. will continue tomorrow.
[06:05:53] <brson> olsonjeffery: ok. thanks!
[06:06:38] <steven_is_false> brson: Java doesn't have destructors so I can't do what I'd do in Rust which is make each actor quit when the destructor ends. By inverting the control flow though I can have a pattern which should be garbage collected well.
[06:07:13] <steven_is_false> As for rust, having actors have destructors is kind of annoying.
[06:10:20] *** Quits: graydon (graydon@moz-F14EE0DB.cable.teksavvy.com) (Ping timeout)
[06:11:50] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[06:11:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/r0aURA
[06:11:51] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[06:11:53] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:11:53] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/4rq4RQ
[06:11:53] <ghrust> 13rust/06auto 14c4b4cb3 15Andreas Martens: Fix segfault when calling tuple struct constructor as extern fn...
[06:11:53] <ghrust> 13rust/06auto 1429ab2da 15Andreas Martens: Add assertions to test
[06:11:53] <ghrust> 13rust/06auto 1448dded9 15bors: auto merge of #8580 : bytewiseand/rust/tuple-struct-ctor-ptr, r=alexcrichton...
[06:11:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:15:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[06:15:52] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:17:01] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[06:20:26] *** Joins: sebcrozet (sebcrozet@moz-2517AE39.w80-13.abo.wanadoo.fr)
[06:21:29] *** Joins: jaen (jaen@moz-2014FA91.neoplus.adsl.tpnet.pl)
[06:22:05] *** Joins: fabiand (fabiand@moz-6D2DCF21.adsl.alicedsl.de)
[06:22:59] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[06:28:50] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[06:29:20] *** Quits: richard|s (mindginati@moz-C1729134.dsl.clear.net.nz) (Quit: brb)
[06:29:21] *** Quits: brson (brson@5D3B67E3.71E1659D.DFB5E910.IP) (Quit: leaving)
[06:30:11] *** kimundi is now known as zz_kimundi
[06:31:19] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0.1/20130814063812])
[06:32:50] *** Joins: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[06:32:59] <bjzaba> rusti: macro_rules ! foo(($name:ident) => (stringify!($name was not loaded))) foo!(hi)
[06:33:00] -rusti- "hi was not loaded"
[06:33:04] *** Joins: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it)
[06:33:13] <bjzaba> rusti: macro_rules ! foo(($name:ident) => (stringify!(fail!($name was not loaded)))) foo!(hi)
[06:33:14] -rusti- "fail ! ( hi was not loaded )"
[06:33:30] <bjzaba> rusti: macro_rules ! foo(($name:ident) => (fail!(stringify!($name was not loaded)))) foo!(hi)
[06:33:33] -rusti- pastebinned 9 lines of output: http://ix.io/7rN
[06:33:57] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[06:34:24] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[06:35:01] <bjzaba> rusti: macro_rules ! foo(($name:ident) => ({ let n = stringify!($name); fail!("%s was not loaded", n)})) foo!(hi)
[06:35:03] -rusti- pastebinned 9 lines of output: http://ix.io/7rO
[06:35:57] <bjzaba> rusti: macro_rules ! foo(($name:ident) => ({ let n = stringify!($name); fmt!("%s was not loaded", n)})) foo!(hi)
[06:35:57] -rusti- ~"hi was not loaded"
[06:36:03] <bjzaba> rusti: macro_rules ! foo(($name:ident) => (fmt!(stringify!($name was not loaded)))) foo!(hi)
[06:36:04] -rusti- <anon>:5:50: 5:82 error: first argument to fmt! must be a string literal.
[06:36:04] -rusti- <anon>:5          macro_rules ! foo(($name:ident) => (fmt!(stringify!($name was not loaded)))) foo!(hi)
[06:36:04] -rusti-                                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[06:36:05] -rusti- application terminated with error code 101
[06:36:51] <aatch> rusti: macro_rules ! foo(($name:ident) => ({ let n = stringify!($name); fail!("%s was not loaded", n); })) let hi = 1; foo!(hi)
[06:36:53] -rusti- pastebinned 9 lines of output: http://ix.io/7rP
[06:37:00] <steven_is_false> Yeah! I found a bug in my actor code. Also this: http://pastebin.mozilla.org/2891991
[06:37:23] *** Quits: untwisted (untwisted@moz-D29D1803.reverse.softlayer.com) (Quit: Lost terminal)
[06:38:09] <steven_is_false> Actually, it's still buggy but I don't want to fix it right now.
[06:38:21] <bjzaba> aatch: it's because rusti is assigning to r
[06:38:43] <bjzaba> aatch: it can't infer the type if the expression evals to !
[06:38:47] <steven_is_false> goodnight
[06:38:49] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[06:38:52] <bjzaba> or something
[06:39:14] <bjzaba> rusti: let x = fail!();
[06:39:16] -rusti- pastebinned 9 lines of output: http://ix.io/7rQ
[06:39:34] <dbaupp> rusti: macro_rules ! foo(($name:ident) => (fail!(stringify!($name was not loaded)))) if true { foo!(hi) }
[06:39:35] -rusti- task <unnamed> failed at 'hi was not loaded', <anon>:5
[06:39:35] -rusti- application terminated with error code 101
[06:39:39] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[06:40:33] <dbaupp> aatch, bjzaba: are either of you planning to go to the summit?
[06:40:48] <bjzaba> dbaupp: where is it?
[06:41:01] <bjzaba> dbaupp: if it is across the lake then no
[06:41:04] <bjzaba> :P
[06:41:13] <dbaupp> bjzaba: toronto, california, or brussels
[06:41:25] <bjzaba> yeah, unfortunately no
[06:41:26] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[06:41:34] * dbaupp can't either :(
[06:41:35] * bjzaba is poor
[06:41:51] * dbaupp wishes there was one in auckland
[06:42:04] *** sankha94 is now known as sankha93_
[06:42:07] <bjzaba> or melbourne!
[06:42:11] <bjzaba> :P
[06:42:23] <dbaupp> get mozilla to open an office there :P
[06:42:35] <bjzaba> hey graydon!
[06:42:56] <bjzaba> mozilla -> melbourne x)
[06:43:04] <bjzaba> (jk)
[06:43:04] *** Joins: threecreepio (jdp@moz-71E164C9.cust.bredbandsbolaget.se)
[06:51:25] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:51:58] *** Quits: mihneadb (Mihnea@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Quit: Leaving)
[06:54:11] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[06:55:00] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[06:55:51] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[06:59:26] *** Quits: ChrisMorgan (chris@moz-577E5F7F.its.monash.edu.au) (Ping timeout)
[06:59:28] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[06:59:51] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[07:01:29] *** Quits: z0w0 (corrz@C3BC732A.9254B1A4.F22F0031.IP) (Client exited)
[07:01:31] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[07:02:47] *** Joins: Ms2ger (Ms2ger@moz-590E79FE.adsl-dyn.isp.belgacom.be)
[07:03:27] *** Quits: threecreepio (jdp@moz-71E164C9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[07:10:22] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[07:15:13] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[07:15:40] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:16:10] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[07:17:20] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[07:19:14] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[07:22:29] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[07:22:54] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:23:20] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[07:23:56] *** Joins: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com)
[07:31:53] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:31:53] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/4rq4RQ
[07:31:53] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:35:35] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[07:35:58] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[07:36:37] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Quit: eatkinson)
[07:38:01] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[07:40:03] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[07:41:47] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[07:41:50] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:41:50] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/kYLd6g
[07:41:50] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:41:51] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:41:51] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/5wYwrg
[07:41:51] <ghrust> 13rust/06auto 146863d1b 15Flaper Fesp: Make rekillable consistent with unkillable...
[07:41:51] <ghrust> 13rust/06auto 147674528 15Flaper Fesp: Testing rekillable fails when called from outside an unkillable block
[07:41:52] <ghrust> 13rust/06auto 14908a3bc 15Flaper Fesp: Don't make the runtime exit on illegal calls
[07:41:54] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:42:35] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:45:13] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[07:46:14] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[07:46:20] *** Joins: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[07:48:21] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:59:02] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[07:59:39] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[08:01:19] *** Joins: nawfel (Mibbit@A51225A0.C663C91B.DFAB1F33.IP)
[08:01:48] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:01:48] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143be2722 to 1448dded9: 02http://git.io/N3iJvQ
[08:01:48] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:01:50] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[08:01:50] <ghrust> 01[13rust01] 15bors pushed 11 new commits to 06auto: 02http://git.io/6YjbjQ
[08:01:50] <ghrust> 13rust/06auto 142bc999a 15Daniel Micay: container: inline contains_key default method
[08:01:50] <ghrust> 13rust/06auto 140d72f60 15Daniel Micay: iterator: add a `range_inclusive` function...
[08:01:51] <ghrust> 13rust/06auto 1446fc549 15Daniel Micay: rm obsolete integer to_str{,_radix} free functions
[08:01:53] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[08:04:10] <nawfel> hello, does the rust scheduler support private job queues like the ones described here http://gameangst.com/?p=526
[08:04:55] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[08:07:37] <nawfel> hello, does the rust scheduler support private job queues like the ones described here http://gameangst.com/?p=526
[08:11:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:13:54] *** Joins: ab (alex@BC9D99CC.37C1012D.FE617B51.IP)
[08:14:18] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[08:14:24] *** Joins: engla (engla@moz-9B69FE7C.selucle.dyn.perspektivbredband.net)
[08:15:33] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[08:16:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:17:37] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Quit: fine)
[08:17:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:19:06] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[08:20:34] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:22:39] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[08:24:50] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[08:27:18] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:28:26] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[08:31:54] *** Joins: thesnowdog (doug@9696D125.8E46834.6F17036B.IP)
[08:34:29] <nawfel> hello, does the rust scheduler support private job queues like the ones described here http://gameangst.com/?p=526
[08:37:10] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[08:37:45] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[08:45:10] *** Quits: nawfel (Mibbit@A51225A0.C663C91B.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:47:43] *** Quits: engla (engla@moz-9B69FE7C.selucle.dyn.perspektivbredband.net) (Ping timeout)
[08:50:09] *** Parts: bjzaba (brendanzab@B398BE78.F804C29E.D35A31DF.IP) ()
[08:50:24] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[08:57:23] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[08:57:39] *** Joins: maik_ (maik___@moz-31CCDD8A.dip0.t-ipconnect.de)
[08:58:58] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[09:00:19] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[09:00:43] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[09:01:37] *** Joins: sigma (sigma@moz-C2B7BE7A.range86-151.btcentralplus.com)
[09:02:14] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Ping timeout)
[09:02:23] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[09:05:04] *** Joins: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au)
[09:05:07] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[09:05:15] <maik_> bjz, has it landed yet?
[09:07:02] <bjz> no
[09:07:22] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[09:07:44] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[09:08:29] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[09:09:15] *** Quits: cdidd (cdidd@moz-B69D8D91.broadband.corbina.ru) (Ping timeout)
[09:10:10] *** Joins: cdidd (cdidd@moz-523C3FF8.broadband.corbina.ru)
[09:12:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:12:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/6YjbjQ
[09:12:35] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:16:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:18:00] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:22:26] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:22:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wNxjyw
[09:22:26] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:22:29] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:22:29] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/SEmy6A
[09:22:29] <ghrust> 13rust/06auto 1487761c1 15Jan Kobler: extract_grammar symnames...
[09:22:29] <ghrust> 13rust/06auto 14c5c4a63 15Jan Kobler: insert space...
[09:22:29] <ghrust> 13rust/06auto 14c87d798 15bors: auto merge of #8585 : jankobler/rust/extract-grammar-01, r=catamorphism...
[09:22:29] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:31:37] <sebcrozet> Hi, Iâ€™ve got a weird ICE after PR #8519 landed.
[09:32:15] <sebcrozet> Here is the code: https://gist.github.com/sebcrozet/6292270
[09:32:28] *** AutomatedTester|AFK is now known as AutomatedTester
[09:33:00] <dbaupp> sebcrozet: it worked before?
[09:33:09] <sebcrozet> dbaupp: yes
[09:35:10] <dbaupp> sebcrozet: can you get a backtrace from rust_begin_unwind?
[09:36:02] <sebcrozet> dbaupp: how ?
[09:36:24] <dbaupp> sebcrozet: do you have gdb?
[09:37:02] <dbaupp> (I'm building myself a new rust now; but it's having to build LLVM so it'll be a little while.)
[09:38:48] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[09:39:32] <sebcrozet> dbaupp: I have gdb. But It does not give me a backtraceâ€¦
[09:40:35] <dbaupp> `gdb --args rustc fail_index_1.rs`, `break rust_begin_unwind` (`y` if it asks you a question) `run` and then `where`
[09:41:02] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[09:44:21] <sebcrozet> dbaupp: this gives me an internal GDB error :(
[09:45:10] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[09:47:15] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[09:48:39] <dbaupp> sebcrozet: !
[09:48:41] <dbaupp> weird
[09:50:23] <dbaupp> need to run gdb inside gdb :P
[09:52:31] *** Quits: sigma (sigma@moz-C2B7BE7A.range86-151.btcentralplus.com) (Ping timeout)
[09:53:08] <darkf> huh, is there no str.to_lower()?
[09:55:00] *** Joins: engla (engla@moz-14524F0F.selucle.dyn.perspektivbredband.net)
[09:55:29] *** Quits: sebcrozet (sebcrozet@moz-2517AE39.w80-13.abo.wanadoo.fr) (Client exited)
[09:56:00] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[09:56:21] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[09:56:22] <dbaupp> darkf: nope, requires full unicode handling to do properly (which we don't have yet)
[09:56:35] <darkf> ah OK
[09:56:50] <dbaupp> darkf: there's str.to_ascii_lower() I think, which handles A to a, but not Ã„ to Ã¤.
[09:56:57] *** Joins: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr)
[09:58:31] *** Quits: thesnowdog (doug@9696D125.8E46834.6F17036B.IP) (Ping timeout)
[09:58:31] <dbaupp> sebcrozet: ok! I've got a new rust that exhibits the ICE, along with a backtrace: https://gist.github.com/huonw/f7ec339a50a1aa9c4dfb
[09:59:08] <darkf> dbaupp: ah, that will work as a stopgap, thanks
[09:59:20] <dbaupp> sebcrozet: would you like to file the bug?
[09:59:34] <sebcrozet> dbaupp: yep
[10:00:40] *** Quits: engla (engla@moz-14524F0F.selucle.dyn.perspektivbredband.net) (Ping timeout)
[10:05:55] *** Quits: maik_ (maik___@moz-31CCDD8A.dip0.t-ipconnect.de) (Ping timeout)
[10:06:12] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:10:45] <dbaupp> aatch: ping
[10:11:29] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[10:14:47] *** Quits: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net) (Ping timeout)
[10:16:02] <sebcrozet> dbaupp: here is the issue: https://github.com/mozilla/rust/issues/8664
[10:16:40] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:18:20] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[10:19:54] *** Joins: fyolnish_ (fyolnish@moz-BE2BAE5B.miinet.jp)
[10:20:29] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:21:34] *** Quits: fyolnish_ (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:21:37] <dbaupp> sebcrozet: cool; commented :)
[10:23:16] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:24:54] *** Quits: sankha93_ (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[10:29:24] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:30:54] *** Joins: maik (maik___@moz-EC658D8.dip0.t-ipconnect.de)
[10:32:55] <nmatsakis> bjz: almost done... :)
[10:37:18] *** Quits: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP) (Ping timeout)
[10:39:45] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[10:40:56] *** Quits: maik (maik___@moz-EC658D8.dip0.t-ipconnect.de) (Ping timeout)
[10:41:25] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[10:41:51] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:41:51] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SEmy6A
[10:41:51] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:42:19] *** Joins: maik (maik___@moz-E219D459.dip0.t-ipconnect.de)
[10:44:48] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[10:44:55] *** Quits: maik (maik___@moz-E219D459.dip0.t-ipconnect.de) (Ping timeout)
[10:47:07] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[10:47:12] *** Joins: maik (maik___@moz-EFB9F13E.dip0.t-ipconnect.de)
[10:48:50] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Ping timeout)
[10:51:45] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:51:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GuFlVg
[10:51:45] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:51:45] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:51:45] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/82JuiA
[10:51:45] <ghrust> 13rust/06auto 14a106613 15Andreas Martens: Fix ICE when calling static and static function pointers...
[10:51:45] <ghrust> 13rust/06auto 14cc0c6fd 15Andreas Martens: Add assertions and cross crate tests
[10:51:46] <ghrust> 13rust/06auto 145ac7fa9 15bors: auto merge of #8594 : bytewiseand/rust/static-fn-ptr, r=Aatch...
[10:51:48] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:54:30] *** Joins: novabyte (Instantbir@moz-D1C6C853.mullvad.net)
[10:54:45] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bbl)
[10:55:24] *** Joins: fyolnish (fyolnish@moz-F91E1EF6.uqwimax.jp)
[10:57:34] *** Quits: maik (maik___@moz-EFB9F13E.dip0.t-ipconnect.de) (Ping timeout)
[10:57:48] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[10:57:55] *** Quits: fyolnish (fyolnish@moz-F91E1EF6.uqwimax.jp) (Ping timeout)
[10:58:23] *** Joins: thesnowdog (doug@15B51297.CDB23781.6F17036B.IP)
[10:58:46] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[10:58:54] *** Joins: maik (maik___@moz-13EA8983.dip0.t-ipconnect.de)
[11:00:26] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[11:02:06] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[11:13:57] *** Quits: maik (maik___@moz-13EA8983.dip0.t-ipconnect.de) (Ping timeout)
[11:15:23] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[11:17:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[11:18:40] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[11:19:58] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[11:25:25] *** Joins: Florob (Florob@moz-39532932.de)
[11:26:25] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Quit: WeeChat 0.4.2-dev)
[11:28:05] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[11:31:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[11:31:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145ac7fa9 to 14c87d798: 02http://git.io/N3iJvQ
[11:31:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[11:31:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:31:47] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/S9YrNg
[11:31:47] <ghrust> 13rust/06auto 14ed6694a 15Vadim Chugunov: Fixed -Z print-link-args
[11:31:47] <ghrust> 13rust/06auto 14c8354ff 15Vadim Chugunov: Rename functional-struct-update.rs to avoid tripping Windows installer detector....
[11:31:47] <ghrust> 13rust/06auto 14201e555 15bors: auto merge of #8595 : vadimcn/rust/print_link_args, r=alexcrichton...
[11:31:48] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[11:35:24] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[11:38:26] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[11:45:40] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[11:46:40] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[11:47:13] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[11:47:16] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[11:47:29] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[11:52:33] *** Quits: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au) (Client exited)
[11:57:39] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[12:01:45] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:01:45] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14201e555 to 14c87d798: 02http://git.io/N3iJvQ
[12:01:45] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:01:45] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:01:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/I0nA4A
[12:01:46] <ghrust> 13rust/06auto 14b66cdb1 15Steven Fackler: Delete std::rt::io::net::http...
[12:01:46] <ghrust> 13rust/06auto 144c75e92 15bors: auto merge of #8600 : sfackler/rust/http, r=brson...
[12:01:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:04:17] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[12:17:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[12:19:00] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[12:19:27] *** Quits: jaen (jaen@moz-2014FA91.neoplus.adsl.tpnet.pl) (Ping timeout)
[12:20:00] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[12:22:04] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[12:28:06] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[12:29:05] *** Joins: victorporof (victorporo@256FD045.43CE31D0.9B1E38F4.IP)
[12:31:27] *** Joins: diverse (Mibbit@moz-601F0275.static.mtpk.ca.charter.com)
[12:33:59] <sebcrozet> That is weird. Since #8328 landed, Iâ€™ve got a huge performance regression on my projects.
[12:34:19] <sebcrozet> Everything is like 75% slower :(
[12:35:08] <sebcrozet> Any idea what this PR changed which could affect performances that much?
[12:36:45] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[12:40:45] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[12:41:49] *** Joins: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[12:42:25] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[12:44:52] *** Quits: Liothen (liothen@moz-80EF0CD7.spkn.qwest.net) (Quit: Textual IRC Client: www.textualapp.com)
[12:49:03] <dbaupp> sebcrozet: are you sure it's that PR?
[12:49:33] <dbaupp> (but, that's an LLVM update so arbitrary things may've changed; I guess it strange to be a regression though.)
[12:49:49] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[12:50:01] <sebcrozet> dbaupp: 100% sure. I have one compiler exactly at this commit, and another one at the commit right before.
[12:50:19] <sebcrozet> dbaupp: And I have much better performances with the older one.
[12:50:39] <dbaupp> oh! file a bug! :)
[12:50:53] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[12:52:01] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[12:52:03] <sebcrozet> dbaupp: Iâ€™d like to but I dont have any small example showing the regressionâ€¦
[12:53:26] <dbaupp> probably doesn't matter; some example at all is better than no example. (and some filed-bug is better than no filed-bug) :)
[12:54:26] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[12:54:37] <sebcrozet> dbaupp: ok.
[12:55:33] *** Joins: mw (mw@moz-DBFB40E7.adsl.highway.telekom.at)
[13:00:42] *** Quits: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[13:02:22] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[13:02:29] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[13:03:46] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:04:41] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[13:10:58] *** Quits: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it) (Client exited)
[13:12:32] *** Joins: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it)
[13:13:32] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[13:15:11] *** Quits: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[13:15:12] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[13:16:52] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[13:17:00] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[13:17:40] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[13:19:20] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[13:19:44] *** Joins: victorporof_ (victorporo@256FD045.43CE31D0.9B1E38F4.IP)
[13:20:11] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[13:20:47] *** Quits: victorporof (victorporo@256FD045.43CE31D0.9B1E38F4.IP) (Ping timeout)
[13:21:47] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:21:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/I0nA4A
[13:21:47] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:26:24] *** zz_kimundi is now known as kimundi
[13:29:54] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[13:30:34] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:31:45] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:31:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/k8FiwA
[13:31:45] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:31:47] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:31:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MPJJtg
[13:31:47] <ghrust> 13rust/06auto 14337c406 15Seo Sanghyeon: Add sysconf names for Android
[13:31:47] <ghrust> 13rust/06auto 149765f33 15bors: auto merge of #8602 : sanxiyn/rust/sysconf, r=graydon...
[13:31:48] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:33:02] *** Joins: [squiddy] (squiddy@moz-A5352A4F.adsl.alicedsl.de)
[13:33:03] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[13:33:40] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[13:36:44] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[13:37:52] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[13:39:12] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[13:39:38] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[13:39:58] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[13:40:37] *** Joins: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[13:40:37] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Connection reset by peer)
[13:42:11] <mw> hi everybody, does someone know of a way to find out the parent of an AST node (that is still available in middle::trans)?
[13:43:41] *** Joins: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP)
[13:43:44] <mw> what I really want to do, is reconstruct the module chain that leads to some type or function
[13:44:51] <mw> like when I have something like the following mod A { mod B { mod C { fn fun(){} }}}
[13:46:05] <mw> I want to get ahold of the ast::items representing A, B, and C, but I only know the node_id of A::B::C::fun
[13:47:05] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[13:47:31] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Ping timeout)
[13:47:56] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[13:48:53] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[13:49:03] *** victorporof_ is now known as victorporof
[13:49:34] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Ping timeout)
[13:51:00] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[13:51:19] *** Quits: sankha93 (uid12218@moz-31ABA2C0.irccloud.com) (Quit: )
[13:52:43] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[13:53:52] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[13:54:55] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[13:55:09] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[13:55:49] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[13:58:07] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[14:01:06] *** RMF_ is now known as RMF
[14:01:33] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[14:02:47] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[14:03:58] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[14:03:59] *** Joins: mindcat (mindcat@2DE37087.C6D6E0F5.857BDFA9.IP)
[14:04:00] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[14:04:19] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:05:59] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[14:08:50] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[14:12:04] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[14:12:04] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[14:12:22] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[14:12:35] <SimonSapin> If Iâ€™m using Python with Jinja2 to generate Rust codeâ€¦ did something go horribly wrong?
[14:13:20] <sigma> horribly right
[14:14:25] <sigma> I did it for some very mechanical parser code I was writing, it was faster than manually typing up 100+ states
[14:14:47] <SimonSapin> sigma: with jinja as well?
[14:14:56] <sigma> nope, mako
[14:14:59] <sigma> but with python
[14:15:01] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Input/output error)
[14:15:14] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[14:15:40] <SimonSapin> Iâ€™m wondering if I should ship jinja with Servo and make it part of the build, or commit the generated code
[14:15:43] <sigma> it was the first thing that came up when I googled python templating, so I went with it
[14:16:26] <SimonSapin> (importing jinja from a zip file)
[14:16:38] <Ms2ger> Make it part of the build
[14:16:42] <dbaupp> is the generator sufficiently complicated that jinja is a necessity?
[14:17:14] <SimonSapin> not really, but string substitution is not enough
[14:17:19] <Ms2ger> We've still got some autogenerated code in Gecko that was generated by code that's lost in the mists of history
[14:17:27] <SimonSapin> I need "for loops"
[14:17:48] <dbaupp> I heard python had for loops ;P
[14:17:48] <SimonSapin> and havenâ€™t really found something in between 
[14:18:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:18:05] <dbaupp> Ms2ger: sounds horrible
[14:18:32] <Ms2ger> Even better: the output was data tables in an undocumented format
[14:18:55] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[14:19:18] <SimonSapin> dbaupp: well, Iâ€™d like to have a mostly-rust file with templating in the middle, rather than just doing string manipulation in python
[14:19:40] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:19:41] <SimonSapin> if only for syntax highlighting
[14:19:43] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[14:20:28] <dbaupp> yeah, that is nicer.
[14:21:10] * dbaupp has been known to use template.<target-language-ext> with a REPLACE_THIS marker
[14:22:24] <SimonSapin> yeah, that would work for simple string substitution
[14:23:35] *** Quits: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com) (Quit: threecreepio)
[14:24:37] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[14:25:23] *** Joins: jaen (jaen@FB01674D.56B727FE.4B52F012.IP)
[14:26:20] <orshem> hi everyone. is there a raw string type in Rust? something like r"foo bar"?
[14:26:20] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[14:26:34] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[14:27:03] <SimonSapin> orshem: do you mean string literals where \ is not special?
[14:27:30] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[14:28:28] <orshem> SimonSapin, yes, without escaping of any kind
[14:29:30] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Quit: jorendorff)
[14:29:52] *** Parts: mw (mw@moz-DBFB40E7.adsl.highway.telekom.at) ()
[14:29:56] <dbaupp> orshem: nope
[14:29:57] <SimonSapin> I think there is not. But if you can deal with having a separate file, include_str!("filename") gives a string value
[14:30:19] <SimonSapin> include_bin!("filename") gives &[u8]
[14:30:33] <SimonSapin> or maybe ~[u8]. Bytes, any way
[14:30:40] <kimundi> orshem: No, but it's something that came up once or twiche, and might make it into the language someday
[14:31:16] <orshem> SimonSapin, that's too much trouble :(
[14:31:30] *** Joins: josh (josh@moz-D3896A24.dhcp.dlth.mn.charter.com)
[14:31:46] <orshem> kimundi, dbaupp: it's a shame. it's very handy for regexs and the like
[14:32:20] <dbaupp> I think the main reason it doesn't exist is because no-one's needed it a lot yet
[14:32:21] <SimonSapin> orshem: well, we donâ€™t have regexps either :) At least in libstr/extra
[14:32:38] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[14:32:45] <orshem> SimonSapin, anybody working on a regex library? 
[14:32:54] <dbaupp> (and, depending on the syntax, it's backwards compatible, so it can be added later.)
[14:33:06] <SimonSapin> orshem: I think there are bindings for pcre around
[14:33:10] <dbaupp> orshem: ssbr was, but they're distracted by life at the moment
[14:33:10] <kimundi> orshem: Eventual regex support was actually one of the situation where the 'maybe in the future' statement came from :)
[14:33:42] <dbaupp> orshem: their plan/research: https://github.com/mozilla/rust/wiki/Lib-re
[14:36:01] *** Quits: fabiand (fabiand@moz-6D2DCF21.adsl.alicedsl.de) (Client exited)
[14:39:07] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[14:39:32] *** Joins: fabiand (fabiand@moz-6D2DCF21.adsl.alicedsl.de)
[14:40:15] *** Joins: jdm (jdm@179C3C4D.7BD02DAB.59660190.IP)
[14:40:21] <orshem> dbaupp, that's a very well written plan
[14:40:36] <orshem> so who's implementing this? :)
[14:43:25] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[14:44:07] <orshem> (i'm still reading it)
[14:44:40] <dbaupp> ssbr aka Devin Jeanpierre
[14:44:53] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[14:44:56] <orshem> from the last sentences it seems like he has already part of it working.
[14:46:31] <mindcat> this type `~[~str]`, how to print them out?
[14:47:34] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:48:15] <dbaupp> rusti: let strs: ~[~str] = ~[~"foo", ~"bar"]; for s in strs.iter() { println(*s) }
[14:48:15] -rusti- foo
[14:48:16] -rusti- bar
[14:48:16] -rusti- ()
[14:48:33] <nmatsakis> mindcat: you can use fmt!("%?"), or perhaps str::connect, or what dbaupp just did :)
[14:48:51] <nmatsakis> rusti: let strs = ~[~"foo", ~"bar"]; strs.connect(", ")
[14:48:52] -rusti- ~"foo, bar"
[14:49:03] <mindcat> ouch
[14:49:11] <nmatsakis> ouch?
[14:49:17] <mindcat> ...nothing
[14:49:56] <mindcat> I am going try it, thanks :D
[14:50:01] <dbaupp> rusti: let strs: ~[~str] = ~[~"foo", ~"bar"]; println(strs.connect("\n"))
[14:50:02] -rusti- foo
[14:50:02] -rusti- bar
[14:50:02] -rusti- ()
[14:50:39] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[14:51:45] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[14:51:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/MPJJtg
[14:51:45] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[14:52:19] <nmatsakis> bjz: https://github.com/mozilla/rust/pull/8666
[14:52:46] <bjz> wooo!
[14:52:47] <nmatsakis> r? ^ if anyone's interested, fairly straightforward, mostly removing special cases
[14:52:48] <bjz> :D
[14:53:00] <nmatsakis> not sure who's around with reviewing powers :)
[14:53:05] *** Quits: jaen (jaen@FB01674D.56B727FE.4B52F012.IP) (Ping timeout)
[14:53:14] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[14:54:46] * dbaupp is
[14:54:56] * dbaupp isn't sure he's "qualified" to review it though
[14:55:34] <Florob> Has there been any work done on adding TBAA metadata for LLVM?
[14:56:04] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[14:56:43] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[14:57:03] *** Joins: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP)
[14:57:08] <mindcat> nmatsakis: I am using rust 0.7, "let strs: ~[~str] = ~[~"foo", ~"bar"]; for s in  strs.iter() { println(*s) }
[14:57:20] <mindcat> " not work
[14:58:06] <mindcat> http://paste.ubuntu.com/6010554/
[14:58:14] <bjz> nmatsakis: I am, but I'd be afraid to r+ it
[14:59:01] <dbaupp> mindcat: ah, you'll need `for strs.iter().advance |s| { println(*s) }`, since the for loop syntax has changed since 0.7
[14:59:12] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[14:59:31] <bjz> nmatsakis: all I can say after reviewing is a small pedantry: why not use the method? assert!(is_not_null(self.llbuilder))
[14:59:36] <dbaupp> Florob: don't think so, but I think strcat has a reasonable plan/idea of what's necessary.
[14:59:45] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[15:00:40] <bjz> mindcat: I would reccomend using the master branch
[15:00:53] <mindcat> dbaupp: thanks, I learned this. :D
[15:00:59] *** Quits: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP) (Quit: dave1629)
[15:01:03] <mindcat> bjz: I will try it :D
[15:01:15] <bjz> :
[15:01:21] <bjz> :)
[15:01:42] <bjz> it is much improved over 0.7
[15:01:45] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:01:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/-HWUhQ
[15:01:45] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:01:48] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[15:01:48] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/zaBpig
[15:01:48] <ghrust> 13rust/06auto 14c64f963 15Kevin Ballard: Implement .size_hint() on new vec iterators
[15:01:48] <ghrust> 13rust/06auto 148741770 15Kevin Ballard: Update size_hint()s on std::iterator Iterators...
[15:01:49] <ghrust> 13rust/06auto 14bf90634 15bors: auto merge of #8604 : kballard/rust/iter-size-hint, r=graydon...
[15:01:51] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[15:02:18] *** Joins: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP)
[15:02:46] *** Quits: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP) (Quit: dave1629)
[15:03:30] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[15:03:48] <mindcat> bjz: cloning now :D
[15:06:27] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[15:12:17] *** Quits: jdm (jdm@179C3C4D.7BD02DAB.59660190.IP) (Ping timeout)
[15:12:45] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[15:12:48] *** Joins: jdm (jdm@E43B2B97.F72F0E.59660190.IP)
[15:14:15] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[15:14:27] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:15:01] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[15:17:45] *** Joins: threecreepio (jdp@moz-71E164C9.cust.bredbandsbolaget.se)
[15:18:26] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[15:19:31] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[15:19:43] <darkf> is there a way to have a macro such that f!(xyz) expands to ("xyz", xyz_) ?
[15:20:05] <darkf> having trouble on the adding the underscore to an ident bit
[15:20:15] <pauls> darkf: it's not currently possible.
[15:20:22] <darkf> aw
[15:20:39] <pauls> darkf: technically, you can expand to *that particular thing*, but I bet you want something that's not possible.
[15:21:27] <darkf> pauls: I just have functions named with underscores that I'd like a macro to expand to, so f!(some_fn) references some_fn_
[15:21:42] <pauls> ...because the `concat_idents!(...)` syntax extension can only be invoked in expression position.
[15:22:06] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[15:22:35] <pauls> darkf: oh, huh. If the function definition doesn't need to be generated, then you can do it.
[15:22:49] <darkf> right, it already exists
[15:24:10] *** Joins: jaen (jaen@moz-43EC3853.play-internet.pl)
[15:24:13] <ion> Oh, awesome. Rust seems to have strong typing between numeric types, like in Haskell but unlike most other otherwise strongly typed languages.
[15:24:31] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:25:25] <pauls> `concat_idents!` is pretty close to useless currently, but congratulations for finding a use for it.
[15:25:55] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[15:26:00] <darkf> pauls: it won't accept concat_identifiers!($name, _) and _ is not considered an ident so I think it is still useless!
[15:26:09] <lkuper> Any ideas why my llvm build might be breaking?  gist: https://gist.github.com/lkuper/6295904/raw/301ab3ec0ec75e32a29ab52bf0d15bf7cb915c90/gistfile1.txt (cc: echristo, etc.)
[15:26:13] <pauls> darkf: oh, darn.
[15:26:20] <pauls> So close!
[15:26:24] <darkf> indeed
[15:29:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:35:47] *** Joins: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP)
[15:38:34] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Input/output error)
[15:39:28] <mindcat> rusti: random()
[15:39:29] -rusti- <anon>:5:9: 5:15 error: unresolved name `random`.
[15:39:29] -rusti- <anon>:5          random()
[15:39:29] -rusti-                   ^~~~~~
[15:39:29] -rusti- error: aborting due to previous error
[15:39:29] -rusti- application terminated with error code 101
[15:41:05] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Ping timeout)
[15:41:52] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[15:44:21] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:45:41] <SimonSapin> Maybe I donâ€™t need Jinja after all. https://github.com/SimonSapin/snippets/blob/master/stupid_templates.py (Custom template engine written in one hour!)
[15:46:01] *** Quits: mindcat (mindcat@2DE37087.C6D6E0F5.857BDFA9.IP) (Ping timeout)
[15:46:01] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[15:48:21] *** Joins: mindcat (mindcat@2DE37087.C6D6E0F5.857BDFA9.IP)
[15:50:52] *** Quits: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[15:50:59] *** Joins: veddan (viktor@moz-C79BC80B.csbnet.se)
[15:51:12] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[15:52:52] *** Quits: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP) (Quit: dave1629)
[15:52:53] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[15:54:19] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:54:44] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[15:55:05] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:55:11] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[15:55:15] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[15:55:34] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:56:18] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:57:26] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:57:44] <leonvv> When do the debug!() functions actually print something? Is there some kind of compiler flag?
[15:57:53] <cmr> leonvv: yes. --cfg debug
[15:58:01] <leonvv> cmr: Thanks!
[15:58:04] <cmr> plus an environment variable: RUST_LOG=crate=4
[15:58:26] *** Quits: jaen (jaen@moz-43EC3853.play-internet.pl) (Ping timeout)
[15:58:44] <nmatsakis> bjz: I guess because I forgot the method existed
[15:59:32] <pnkfelix> leonv: One more thing: If you want to see debug!() from rustc, pass 'â€”enable-debug' to configure.
[15:59:49] <cmr> crate being the name of your crate btw
[16:01:11] <doomlord> Added Rust support to Geany , wrote a tags parser for it..  https://github.com/geany/geany  .. so it gets to browse structs/impls etc 
[16:02:53] <nmatsakis> pnkfelix: want to review a PR in borrowck (not immediately, necessarily)? or do you not have time?
[16:03:10] <nmatsakis> pnkfelix: just wondering who to assign and wondering if you were curious in looking a bit into that code, it's a relatively small PR
[16:03:22] <nmatsakis> https://github.com/mozilla/rust/pull/8667
[16:03:35] <pnkfelix> nmatsakis: Sure, assign it to me.
[16:03:44] <leonvv> pnkfelix: Thanks, will keep it in mind
[16:03:52] <pnkfelix> nmatsakis: If I can't finish up this other work soon, I'll let you know.
[16:03:58] <nmatsakis> pnkfelix: done.
[16:04:56] *** Quits: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it) (Ping timeout)
[16:05:50] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[16:07:39] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[16:14:23] *** Joins: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP)
[16:14:44] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[16:17:02] *** Quits: RMF (RMF@100FCB1B.10FB11BA.8D19547B.IP) (Ping timeout)
[16:20:53] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[16:21:01] *** Quits: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP) (Quit: dave1629)
[16:21:41] *** Joins: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP)
[16:21:47] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[16:21:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/zaBpig
[16:21:47] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[16:22:02] *** Quits: dave1629 (dave@9CC8090B.474E6E0A.DDE5D3F6.IP) (Quit: dave1629)
[16:22:28] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[16:22:31] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[16:22:38] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[16:23:31] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[16:24:15] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[16:25:25] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:28:34] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[16:29:18] <toddaaro> did pcwalton's PR land?
[16:29:57] *** Joins: nawfel (Mibbit@DAA7216A.4A976D97.DFAB1F33.IP)
[16:30:09] <nawfel> hello, does the rust scheduler support private job queues like the ones described here http://gameangst.com/?p=526
[16:30:30] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:30:57] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[16:31:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[16:31:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/bffXGg
[16:31:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[16:31:46] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[16:31:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Zp-kCg
[16:31:47] <ghrust> 13rust/06auto 14ac3bc9c 15Kevin Ballard: Fix mod_floor() for uint primitive types
[16:31:47] <ghrust> 13rust/06auto 14e664781 15bors: auto merge of #8610 : kballard/rust/mod_floor, r=alexcrichton...
[16:31:47] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[16:31:52] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[16:32:44] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[16:32:54] <maik> nawfel, yes
[16:33:21] <maik> nawfel, i just skimped over it but it should be fairly simple 
[16:34:28] <toddaaro> nawfel: not right now, still trying to get the core scheduler/runtime going
[16:34:33] <maik> nawfel, you create one task that collects incoming futures. Then you spawn your async task create a future and send it to the queue
[16:34:39] <toddaaro> nawfel: but that is an interesting article, thanks for pointing us to it
[16:34:57] <toddaaro> nawfel: (I'm assuming the feature you are interested is specifically the low-priority queues?)
[16:34:58] <maik> toddaaro, did I understand something wrong?
[16:35:33] <toddaaro> maik: maybe, we have mostly that design, but we don't have private queues with the low-priority setting for doing low-priority work
[16:36:39] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[16:36:45] <maik> toddaaro, oh I wrote my own priority queue a few days ago
[16:36:45] <toddaaro> ah, so our setup is more advanced in that we use work-stealing for the public pool
[16:36:58] <toddaaro> maik: for what usecase?
[16:37:01] <maik> toddaaro, but I build it on top of the current task system
[16:37:07] <toddaaro> interesting
[16:37:31] <toddaaro> once we get the scheduler going I have way too many thoughts on all kinds of stuff we can do for priorities, latency, networking integration, etc.
[16:37:34] <maik> it's probably very inefficient
[16:37:38] <toddaaro> but that is all still "future work"
[16:38:30] <toddaaro> nawfel: this is a really good article! one of the things we have been wondering is "what do game people want in concurrency/parallelism libraries like ours" but we don't have anyone from that domain to tell us these things, and they aren't really published in the usual academic venues
[16:38:50] <toddaaro> nawfel: I'll put this in the issue tracker as a study todo
[16:39:08] <nawfel> toddaaro: thank you :D
[16:39:47] *** Joins: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:39:55] *** AutomatedTester is now known as AutomatedTester|AFK
[16:40:06] *** Joins: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com)
[16:40:15] <maik> I just have tasks sending messages to my priority queue. The messages are encapsulated in an adt Message(data,priority_level). Then I add it to vector and sort it. that's basically it
[16:41:40] *** Quits: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[16:41:41] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:41:54] <maik> was more a learning experience 
[16:42:02] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[16:43:20] <maik> nawfel, super interesting blog, thanks
[16:43:46] <bstrie> is the isaac generator ever used anymore? I thought we replaced it with a rust rng
[16:43:57] <nawfel> maik: not at all :)
[16:44:38] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Input/output error)
[16:45:40] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[16:45:53] <nawfel> toddaaro: do you mean by issue tracker this https://github.com/mozilla/rust/issues
[16:46:20] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[16:47:33] <toddaaro> https://github.com/mozilla/rust/issues/8668
[16:47:38] <toddaaro> nawfel: yep, that is what I put up
[16:48:20] <echristo> lkuper: llvm and clang out of step with each other?
[16:48:39] <toddaaro> nawfel: not sure how familiar you are with Rust, we just swapped over to a brand new runtime written almost entirely in Rust and are working out the kinks / trivial optimizations
[16:49:32] <toddaaro> nawfel: once this process settles in a couple months we will likely start "making it awesome" from a feature point of view, but what sort of things that would entail is not well thought out
[16:50:41] <nawfel> toddaaro: i know, i am a big Rust news follower, i saw the videos about it in air.mozilla.org
[16:51:09] <nawfel> it == new scheduler
[16:51:36] <lkuper> echristo: perhaps?  it turns out to not actually be a problem wrt being able to build rust (I don't build with clang).
[16:51:45] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[16:52:03] <echristo> lkuper: most likely issue. and yeah, not surprising there either.
[16:52:58] <echristo> bbiab
[16:53:00] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[16:53:50] <cmr> bstrie: the rust rng *is* isaac
[16:54:07] <cmr> it's an algorithm, not a library
[16:54:15] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[16:55:18] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:55:28] <toddaaro> nawfel: are you actually a game development person or do you just find articles from the field?
[16:56:00] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:56:12] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[16:56:12] *** ChanServ sets mode: +qo graydon graydon
[16:56:40] <nawfel> toddaaro: no, i just found the blog when googling for dlmalloc
[17:00:19] *** Quits: nawfel (Mibbit@DAA7216A.4A976D97.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:00:32] <maik> how do I get values out of unit structs? like struct Message<T> (T,int); how do I get the first value? only with a match?
[17:00:58] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:01:40] <kimundi> maik: match or let pattern matching
[17:02:31] <kimundi> rusti: struct Foo(int); let Foo(x) = Foo(45); x
[17:02:32] -rusti- 45
[17:03:24] *** Quits: jdm (jdm@E43B2B97.F72F0E.59660190.IP) (Ping timeout)
[17:03:35] <maik> kimundi, thnks
[17:03:37] <maik> thanks*
[17:04:00] <cmr> that's not a unit struct
[17:04:04] <cmr> unit structs are `struct Foo;`
[17:04:08] <cmr> that's a tuple struct
[17:04:15] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:04:15] *** ChanServ sets mode: +o tjc
[17:05:18] <bstrie> cmr: I'm talking specifically about the files in "src/rt/isaac"
[17:05:23] <bstrie> which are C++
[17:05:45] <bstrie> what I'm asking is if those can be removed
[17:06:01] <cmr> try it and see? :)
[17:06:12] <cmr> I think it's unused
[17:07:12] <cmr> nope, still used
[17:07:16] *** Joins: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net)
[17:07:16] <cmr> in rust_rng.cpp
[17:07:23] <cmr> where *that* is used, I don't know
[17:08:30] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:08:53] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[17:08:57] <diverse> Why does the compiler think ~"foo" is type &'static str when I'm doing this: ~"foo".append("bar")?
[17:09:09] *** Quits: StarLight (StarLight@7A2D5F01.505A3D91.F1EF1E39.IP) (Ping timeout)
[17:09:18] <cmr> diverse: ~("foo".append("bar"))
[17:09:19] <bstrie> diverse: try (~foo)
[17:09:24] <cmr> is how that is seen
[17:09:28] <bstrie> order of operations
[17:09:34] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[17:09:49] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[17:09:53] <diverse> I see, thank you guys.
[17:11:05] *** Quits: threecreepio (jdp@moz-71E164C9.cust.bredbandsbolaget.se) (Ping timeout)
[17:12:07] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:12:20] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[17:12:20] *** ChanServ sets mode: +o dherman
[17:13:35] *** Joins: StarLight (StarLight@moz-B18EBA4B.dynamic.avangarddsl.ru)
[17:16:01] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:16:01] *** ChanServ sets mode: +o brson
[17:16:10] <maik> do we have a sorting example somewhere?
[17:17:18] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:17:18] *** ChanServ sets mode: +o pcwalton
[17:17:43] <toddaaro> brson: if you are interested I put up my tabled async-opt stuff as 'async-opt', also put up a new metabug that is sort of outreachy https://github.com/mozilla/rust/issues/8668
[17:17:54] <kmc> is there a convenient way to iterate a vector and get copies of its elements, by value?
[17:17:57] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[17:18:31] <toddaaro> pcwalton: did your PR land? if not, you should close the tree for an hour or so to get it to. I read over some of the change list and I'd be incredibly impressed if you landed it without a short close.
[17:18:37] <cmr> kmc: v.iter().map(|x| x.clone()) ?
[17:18:43] <pcwalton> toddaaro: no, yours bounced it :)
[17:18:47] <pcwalton> I have to fix it
[17:19:04] <pcwalton> still haven't fixed the fallout
[17:19:11] <toddaaro> pcwalton: yea, you are up against p>0 runtime PRs breaking it every single time
[17:19:17] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[17:19:40] <olsonjeffery> brson: so i was able to get clarification on pread/pwrite behavior beyond EOF .. pread will return zero bytes or EINVAL if the offset is bigger than max file size and pwrite will grow the file and pad the gap w/ zeros
[17:19:58] <kmc> cmr: was hoping for a bit shorter than that, but ok
[17:20:16] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:20:17] <olsonjeffery> i think that behavior is acceptable and will trickle down, automagically, into seek stuff.. although there are some edge cases
[17:20:31] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[17:20:35] <olsonjeffery> like not detecting eof when seek'ing beyond EOF.. you wouldn't get the EOF flag set until a subsequent read
[17:20:42] <olsonjeffery> but then i guess posix isn't much better in this regard
[17:21:09] <olsonjeffery> in any case, we have enough to move forward. i got homing io done.. so ill knock that stuff out and rebase against master
[17:21:45] <olsonjeffery> and kudos to ecr for that, btw.. it's pretty spiffy. although the transmute call in Drop is sadface
[17:22:31] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:22:38] <olsonjeffery> although i wonder if there would be a better way to trap/force that .home_for_io part ..
[17:22:50] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[17:23:30] <olsonjeffery> like push the Local::borrow::<Scheduler>() into a library and have it take an Option<SchedHandle> .. None would preserve the existing behavior but a Some(handle) would do the .home_for_io for you
[17:23:33] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:23:33] *** ChanServ sets mode: +o pcwalton
[17:23:42] <olsonjeffery> anywho.
[17:24:10] *** Joins: Florob (Florob@moz-39532932.de)
[17:24:59] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:25:20] *** Joins: Sergio965 (sergiobz@9486F51E.A082DA0B.3A99D594.IP)
[17:26:00] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:29:22] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[17:29:29] <kmc> ooh, tricky, I just discovered that a missing trait bound can cause a type error which is seemingly unrelated to the trait
[17:29:45] <kmc> if you were relying on calling a trait method by autoderef
[17:30:07] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:30:33] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[17:33:24] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[17:34:08] <maik> I am assuming this ( https://gist.github.com/MaikKlein/6297436 ) is not the low priority job queue that this article is referring too right?  http://gameangst.com/?p=526
[17:34:20] <Sergio965> Is there any way to reference a symbol provided by the linker in Rust?
[17:34:40] *** Quits: novabyte (Instantbir@moz-D1C6C853.mullvad.net) (Quit: bye bye)
[17:34:41] <kmc> Sergio965: you should be able to declare it within extern { ... } like anything provided by C code
[17:34:49] <cmr> Sergio965: `static`, `static mut`, and `fn`, in extern blocks
[17:35:04] <Sergio965> Ah, alrighty. I'll give it a shot.
[17:35:10] <Sergio965> Thanks.
[17:37:38] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[17:38:02] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:40:30] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:40:36] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[17:40:38] <lkuper> nmatsakis: r? if you have a chance: https://github.com/mozilla/rust/pull/8669
[17:40:49] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[17:42:22] <nmatsakis> lkuper: hey neat 
[17:42:35] <nmatsakis> lkuper: is this basically purely mechanical?
[17:42:47] <lkuper> nmatsakis: yep
[17:43:08] <nmatsakis> lkuper: I take it you left super_tys?
[17:43:15] <lkuper> nmatsakis: the only "super_" things that I had to leave in were a couple that were being explicitly called
[17:43:15] <lkuper> yeah
[17:43:17] <nmatsakis> lkuper: I think that's the only one that's "overridden" (can't remember)
[17:43:19] <nmatsakis> ok
[17:43:47] <nmatsakis> lkuper: r+
[17:44:01] <nmatsakis> lkuper: I'm going to trust you to have copied-and-pasted without introducing typos :)
[17:45:48] *** Joins: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:45:53] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:46:53] <lkuper> nmatsakis: that's entirely too high a level of trust!
[17:47:07] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:47:27] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[17:47:27] <nmatsakis> lkuper: yeah well it's all versioned ;)
[17:47:32] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[17:48:24] <lkuper> super_fn_sigs was the other one aside from super_tys
[17:48:44] <lkuper> it could possibly be cleaned up even more but this was the low-hanging fruit
[17:48:58] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[17:51:47] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:51:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Zp-kCg
[17:51:48] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:53:05] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:55:36] *** Joins: nawfel (Mibbit@DAA7216A.4A976D97.DFAB1F33.IP)
[17:56:13] *** Quits: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[17:56:42] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Quit: jorendorff)
[17:57:25] <strcat> acrichto: looking into the changes to the default passes atm
[17:57:38] <acrichto> strcat: cool, thanks
[17:58:00] <strcat> but the loop vectorization and slp vectorization things were new things to enable - it wouldn't be slower because of that
[17:58:03] *** Joins: bent_ (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:58:08] <acrichto> that's what worries me
[17:58:50] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[17:58:52] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:58:53] *** bent_ is now known as bent
[17:59:25] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[17:59:51] <strcat> so, at -O1, simplify-libcalls was removed (already done0
[17:59:56] *** bent is now known as IRCMonkey36761
[17:59:59] <strcat> same at -O2
[18:00:04] <acrichto> yeah that entire pass was deleted
[18:00:05] <strcat> same at -O3
[18:00:11] <strcat> doesn't seem there are any differences
[18:00:12] <brson> olsonjeffery: your suggestions about seek sound good
[18:00:14] <acrichto> interesting...
[18:00:15] <strcat> other than that
[18:00:19] *** Quits: nawfel (Mibbit@DAA7216A.4A976D97.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:00:26] *** Joins: tgummerer (tgummerer@moz-6DEE6C6B.retail.telecomitalia.it)
[18:00:36] <strcat> clang is different now afaik, in that it enables loop-vectorize at -O2 and slp vectorize at -O3
[18:00:41] <strcat> but that isn't part of LLVM's opt yet
[18:01:03] *** Quits: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[18:01:28] *** IRCMonkey36761 is now known as bent
[18:01:45] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[18:01:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/w30zuQ
[18:01:45] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[18:01:47] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[18:01:47] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/2W1UfQ
[18:01:47] <ghrust> 13rust/06auto 1483f4bee 15Florian Zeitz: Add Unicode decomposition mappings to std::unicode
[18:01:47] <ghrust> 13rust/06auto 142675f3e 15Florian Zeitz: Add canonical combining class to std::unicode
[18:01:48] <ghrust> 13rust/06auto 143d720c6 15Florian Zeitz: Add support for performing NFD and NFKD on strings
[18:01:50] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[18:02:11] <acrichto> strcat: it doesn't look like there was much of a regression on isrustfastyet except for the time to build llvm itself
[18:02:39] <toddaaro> rusti: for i in 3.times { rtdebug!("%?", i); }
[18:02:39] -rusti- <anon>:5:28: 5:35 error: macro undefined: 'rtdebug'
[18:02:39] -rusti- <anon>:5          for i in 3.times { rtdebug!("%?", i); }
[18:02:39] -rusti-                                      ^~~~~~~
[18:02:39] -rusti- application terminated with error code 101
[18:02:55] <strcat> it's totally possible that we are missing passes
[18:03:23] <cmr> toddaaro: macros don't escape their crate
[18:03:26] <Sergio965> For managed boxes, does the scheduler run the garbage collector routinely?
[18:03:26] <toddaaro> rusti: for i in range(0u, 3u) { i }
[18:03:27] -rusti- <anon>:5:9: 6:5 error: mismatched types: expected `()` but found `uint` (expected () but found uint)
[18:03:27] -rusti- <anon>:5          for i in range(0u, 3u) { i }
[18:03:27] -rusti- <anon>:6     };
[18:03:27] -rusti- error: aborting due to previous error
[18:03:27] -rusti- application terminated with error code 101
[18:03:33] <toddaaro> rusti: for i in range(0u, 3u) { i; }
[18:03:34] -rusti- <anon>:5:34: 5:35 warning: path statement with no effect [-W path-statement (default)]
[18:03:35] -rusti- <anon>:5          for i in range(0u, 3u) { i; }
[18:03:35] -rusti-                                            ^
[18:03:35] -rusti- ()
[18:03:38] <cmr> Sergio965: no
[18:03:38] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Connection reset by peer)
[18:03:45] <Sergio965> cmr: When does the GC run?
[18:03:56] <toddaaro> someday I need to learn enough rust that I can write a for loop without massive effort
[18:03:57] <cmr> Sergio965: on GC allocations
[18:03:59] <cmr> ...I think
[18:04:04] <cmr> graydon would know more
[18:04:21] <cmr> or, it *can* be run on GC allocations, but won't necessarily
[18:04:24] <graydon> there is no independent "gc run" right now
[18:04:27] <acrichto> Sergio965: right now it's all refcounting, so there's no "running gc" really except that when a task exits it annihilates all gc allocations
[18:04:29] <graydon> it is still refcounting
[18:04:35] *** Joins: xorcon (Mibbit@moz-ACDE7EEC.mozilla.com)
[18:04:57] <Sergio965> Right, but when are @ freed? They're not freed when they go out of scope, are they?
[18:05:05] <graydon> Sergio965: when @ drops to 0
[18:05:14] <graydon> like when its refcount drops, which, yes, is at scope-end
[18:05:17] <Sergio965> And when is the reference count decreased?
[18:05:19] <Sergio965> Hmm.
[18:05:26] <kmc> each @-box has a refcount and the box is freed when the refcount hits zero
[18:05:28] *** Joins: eschweic1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:05:29] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[18:05:34] <xorcon> hello, a basic question which might have been answered. i've been reading the tutorial and it says static variables need to by type annotated but let variables do not. Why is this so?
[18:06:07] <kmc> Sergio965: if you've used shared_ptr in C++ it's very similar.  the pointer itself has a constructor and destructor which increment/decrement a refcount on the box
[18:06:17] <cmr> xorcon: rust doesn't do global inference, only function-local inference.
[18:06:51] *** Quits: Sergio965 (sergiobz@9486F51E.A082DA0B.3A99D594.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[18:07:00] <strcat> Sergio965: you want to use extra::rc right now, if you want refcounting
[18:07:01] <strcat> er
[18:07:07] <strcat> too late for that ;p
[18:08:06] <xorcon> cmr: thanks, rust is building right now, so i might follow up with more questions
[18:08:49] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:08:50] <strcat> acrichto: afaik we're not missing anything
[18:09:01] <acrichto> graydon: there have been reports of a large regression in performance with the llvm upgrades -- https://github.com/mozilla/rust/issues/8665, is the ratcheting/benchmark data collected somewhere right now to see if we can narrow it down?
[18:09:07] <acrichto> strcat: :(
[18:09:54] <strcat> llvm-as < /dev/null | opt -O1 -disable-output -debug-pass=Arguments |& tail -1 | tr ' ' '\n' | tail -n +4
[18:09:59] <strcat> and for -O2 and -O3
[18:10:14] <strcat> should be identical to our passes.rs, except it follows clang and adds loop-vectorize + some loop ones
[18:10:16] <strcat> at -O3
[18:11:02] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:11:47] <graydon> acrichto: benchmarks are collected, yes
[18:11:52] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[18:11:53] <graydon> acrichto: ratchets aren't turned on for most of them
[18:12:08] <acrichto> those wouldn't happen to be graphed anywhere right now would they?
[18:12:56] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Quit: Leaving)
[18:13:17] *** Joins: jorendorff (jorendorff@moz-EB2239CF.hfc.comcastbusiness.net)
[18:14:11] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[18:14:15] *** Quits: tgummerer (tgummerer@moz-6DEE6C6B.retail.telecomitalia.it) (Ping timeout)
[18:14:46] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[18:14:46] <strcat> oh loop-unroll is enabled at -O1 in opt
[18:14:48] <strcat> hm
[18:14:49] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[18:15:17] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:15:17] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[18:15:22] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[18:15:26] *** Quits: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:16:33] *** Joins: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com)
[18:17:52] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:17:59] <strcat> anyway
[18:18:03] <strcat> I think clang does run more than us
[18:18:18] <strcat> it has a function pass, module pass and codegen pass
[18:18:24] <strcat> all we explicitly define is a module pass
[18:18:59] <acrichto> I remember hearing about this before, but it doesn't mean that we're not running function optimizations, right?
[18:19:26] <strcat> I don't know what we're running
[18:19:32] <strcat> I don't know how to print what we're passing to LLVM
[18:19:41] *** Joins: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu)
[18:19:46] <strcat> we are mixing and matching a bunch of APIs, some of which may add this stuff automatically
[18:19:50] <strcat> it's not the normal LLVM API
[18:20:00] <strcat> can't compare to clang easily
[18:20:02] <strcat> code wise
[18:20:14] <strcat> we could easily be missing dozens of passes
[18:20:17] <strcat> I have no idea how to check.
[18:20:27] <acrichto> that's unfortunate... would you mind posting your findings to that bug? This looks like it warrants further investigation
[18:20:27] <strcat> but it didn't regress
[18:20:30] <strcat> it's the same as before
[18:20:33] <strcat> nothing changed
[18:20:38] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[18:20:51] <acrichto> the 10% regression in the example on the bug wasn't small though
[18:20:54] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[18:21:00] <strcat> yeah but it wasn't from this.
[18:21:05] <strcat> this has been a problem since forever
[18:21:20] <acrichto> I don't think so as well, but it would also be nice to be more certain about the llvm passes that we're running
[18:21:44] <strcat> clang has the ability to print the flags it's passing to LLVM, so if we could figure out to do that it would be helpful
[18:21:47] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[18:22:07] <strcat> or maybe it's LLVM printing it out
[18:22:14] <strcat> when you do -mllvm -debug-pass=Arguments
[18:22:17] <strcat> with clang
[18:22:28] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:22:29] <acrichto> we can pass custom passes to llvm, but not on top of other passes, it resets the list
[18:22:43] <strcat> the module pass is *not* the only pass that clang runs
[18:22:54] <strcat> we are not configuring the whole stack
[18:22:56] <strcat> here is what clang runs
[18:23:15] <strcat> http://ix.io/7sy
[18:23:18] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:23:25] <strcat> we *only* explicitly pass a similar set of switches as the 2nd line
[18:23:33] <strcat> we do not do the 1st or 3rd line, at least explicitly
[18:23:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[18:23:37] <strcat> and we don't fully match the 2nd line
[18:23:46] <strcat> I really don't think it's right to be doing it the way we are
[18:23:49] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:23:53] <acrichto> what's the significance of the separate lines?
[18:23:59] <strcat> they are separate passes.
[18:24:10] <strcat> clang runs a function pass (the first), a module pass (the 2nd) and a codegen pass (the 3rd)
[18:24:14] <strcat> I have *no idea* what we run
[18:24:25] <acrichto> oh that's interesting
[18:24:46] <strcat> but I know we are doing stuff wrong
[18:24:46] *** Quits: jorendorff (jorendorff@moz-EB2239CF.hfc.comcastbusiness.net) (Quit: jorendorff)
[18:24:52] <strcat> we never set notti/basictti/x86tti
[18:24:56] <strcat> for one thing
[18:25:01] <acrichto> that's really good info though, I certainly don't mind investigating this later tonight
[18:25:52] <Sergio965> Does Rust now depend on no C++ code for the runtime?
[18:25:54] <strcat> acrichto: http://clang.llvm.org/doxygen/BackendUtil_8cpp_source.html
[18:26:01] <orshem> strcat, acrichto: i've also seen some slowdown with the update
[18:26:06] <strcat> they use a pass manager
[18:26:21] <orshem> but it's not the first time i'm seeing a slowdown
[18:26:26] <orshem> they come amd go :)
[18:26:37] <acrichto> orshem: if you could get some concrete numbers/benchmark that slows down, that would be awesome
[18:26:39] <strcat> orshem: a slowdown on what?
[18:26:42] *** Joins: jorendorff (jorendorff@moz-EB2239CF.hfc.comcastbusiness.net)
[18:27:09] *** Quits: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[18:27:38] <orshem> acrichto, strcat well i've some code that i've written, about 10 files and a test file exercise all of them, it's not large, but not small either
[18:28:02] <orshem> went from 6.4s to 8
[18:28:05] <strcat> so it's measurably slower with -O enabled?
[18:28:07] <strcat> since when?
[18:28:15] <orshem> i'm using o3
[18:28:28] <orshem> i've updated rust after the llvm update
[18:28:31] <ecr> Sergio965: I think the only remaining C++ code is bindings into libraries (i.e. libuv). You might want to double check with brson though.
[18:28:32] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:28:39] *** Quits: jorendorff (jorendorff@moz-EB2239CF.hfc.comcastbusiness.net) (Ping timeout)
[18:28:45] <strcat> orshem: not necessarily the LLVM update causing it though
[18:28:53] <strcat> without bisecting it there's no way to know
[18:29:05] <orshem> yeah can't be sure becasue i'm updating rust once every few days
[18:29:30] <orshem> i saw the llvm update, i was sure i was gonna see a speedup, so i updated :)
[18:29:33] *** Quits: eschweic1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[18:29:34] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:29:54] <brson> toddaaro: have your idle opts landed yet?
[18:30:18] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[18:30:29] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[18:30:41] <strcat> acrichto: anyway we're doing it wrong
[18:30:46] <strcat> we should go back to using a pass manager
[18:30:57] <strcat> and make sure we're running a function pass, a module pass and a codegen pass
[18:30:59] *** Joins: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:31:00] <acrichto> what's the difference?
[18:31:07] <strcat> we are manually specifying passes
[18:31:09] <brson> ecr Sergio965: there is still some 1st-party C++ code but it can all be converted to either Rust or C with varying amounts of effort, an activity which I highly-aprove of. We also depend on C++ for unwinding still, but cmr has been looking into fixing that
[18:31:15] <strcat> and we are not detecting the things we are supposed to be detecting
[18:31:17] <strcat> like target info
[18:31:35] <strcat> acrichto: we shouldn't be manually specifying passes like this unless we want to do it right
[18:31:41] <strcat> and we *aren't* doing it right
[18:31:49] <acrichto> strcat: so a pass manager is auto-populated based on optimization levels?
[18:32:05] <strcat> acrichto: yes, but you need 3 pass managers
[18:32:10] <strcat> acrichto: http://clang.llvm.org/doxygen/BackendUtil_8cpp_source.html just look at this
[18:32:13] <strcat> it's what's we should be doing
[18:32:15] <strcat> and we're not.
[18:32:21] *** Joins: dave1629 (dave@4749ECC6.2F87036F.DDE5D3F6.IP)
[18:32:42] <strcat> if we used the real LLVM API this would be easier :s
[18:32:56] <strcat> there's not a 1:1 mapping from the C API to what clang does
[18:33:06] <acrichto> we can always write our own wrappers though
[18:33:19] <acrichto> or even just a helper LLVMRustMakeTheDefaultManagers()
[18:33:27] <strcat> anyway I'm surprised it works at all right now
[18:33:31] <strcat> since we don't set up target info
[18:33:40] <strcat> it probably isn't optimizing with cost models
[18:34:07] <strcat> but really who knows, we could be running all of this twice by accident
[18:34:19] <strcat> need a way to print them out
[18:34:57] <acrichto> yeah that would be nice
[18:35:13] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:35:36] <acrichto> strcat: what are the -mllvm and -debug-pass=Arguments doing? is the second one what's printing out what's being run?
[18:35:46] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:35:49] <strcat> -mllvm means "pass stuff to LLVM"
[18:35:57] <strcat> and then it passes -debug-pass=Arguments to LLVM
[18:36:01] <strcat> I don't know how to do it with the C API
[18:36:56] <strcat> but yeah I think it is totally wrong
[18:37:01] *** Joins: itdaniher (bzlandfill@moz-A52EACB9.bstnma.east.verizon.net)
[18:37:06] <strcat> probably why it won't vectorize
[18:37:08] <strcat> missing target info.
[18:38:18] *** Joins: itdaniher_ (it@moz-A52EACB9.bstnma.east.verizon.net)
[18:38:27] <itdaniher_> running into some issues with the rust-sdl and the new runtime
[18:38:27] *** Quits: itdaniher (bzlandfill@moz-A52EACB9.bstnma.east.verizon.net) (Quit: CGI:IRC (EOF))
[18:38:36] <strcat> acrichto: there was a regression when we originally switched away from the pass manager
[18:38:41] <strcat> and I have no idea if it was ever fixed
[18:38:47] <toddaaro> brson: yes, they are in now
[18:39:07] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:39:15] <itdaniher_> trying to use pipes to communicate between the graphics thread & other threads; with the limitation that rust-sdl needs to be in its own thread
[18:39:45] <brson> toddaaro: nice!
[18:40:04] <Sergio965> When does unwinding occur? I thought everything was doing using the Result trait?
[18:40:06] <strcat> but yeah we are missing function pass, codegen pass, target info, inlining configuration
[18:40:20] <brson> Sergio965: fail!
[18:40:23] *** Joins: valenting (Thunderbir@662B8DC.3F30A7E5.FB866788.IP)
[18:40:31] <strcat> we do set an optimization level
[18:41:12] <itdaniher_> my attempted solution involves something like task::task().sched_mode(task::SingleThreaded).spawn_with(pData, fn foo(pData))
[18:41:22] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[18:41:36] <itdaniher_> trying to spawn a task in a different scheduler running in its own thread, passing it a port
[18:41:50] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:41:56] <Sergio965> brson: Even if I've defined my own fail!?
[18:41:57] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[18:42:49] <Sergio965> (that doesn't unwind)
[18:42:53] <strcat> acrichto: imo we should remove the passes argument from rustc
[18:42:54] <strcat> and copy clang
[18:43:11] <strcat> it's wrong to override the whole stack anyway
[18:43:15] <strcat> since you need target info
[18:43:34] <strcat> -mllvm appends
[18:44:04] <acrichto> how do we pass the target info to llvm? isn't it attached to the module?
[18:44:30] <strcat> acrichto: by copying this clang file
[18:44:35] <strcat> and throwing out everything we do right now
[18:44:45] <strcat> because it's ridiculously bad
[18:45:00] <strcat> acrichto: if we define custom passes like we do, we are responsible for target info
[18:45:02] <strcat> and we don't do it.
[18:45:20] <acrichto> I'm curious how this would numerically affect the benchmarks
[18:45:37] <strcat> more importantly we would likely stop having certain codegen bugs
[18:45:55] <strcat> especially on ARM
[18:46:26] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[18:46:48] <acrichto> I presume that's because we're not passing target info correctly?
[18:46:53] <strcat> we aren't passing it
[18:47:09] <strcat> our custom module pass is broken afaik
[18:47:23] <strcat> it's not using a cost module, alignment info, etc.
[18:47:27] <strcat> cost model*
[18:47:38] <acrichto> that's unfortunate...
[18:47:56] <strcat> and I don't know what we are actually *doing*
[18:48:10] <strcat> are we running a function pass? are we still running the default module pass and then this one? what's in our codegen pass?
[18:48:29] <strcat> I'm not surprised that we hit weird LLVM issues and have perf issues :s
[18:49:09] <bstrie> incoming rust article: http://relistan.com/a-week-with-mozilla-rust/
[18:49:31] <bstrie> someone with time on their hands ought to go through and see if the code looks nice
[18:49:48] *** Parts: itdaniher_ (it@moz-A52EACB9.bstnma.east.verizon.net) ()
[18:50:28] <brson> Sergio965: no, if you make your own fail! then there's no unwinding, unless you consider that the standard library contains fail! that still can unwind
[18:50:52] <Sergio965> I wrote my own standard library.
[18:51:06] <Sergio965> Well, based on the Rust standard library.
[18:51:08] <brson> Sergio965: cool!
[18:51:15] <Sergio965> (but for bare metal)
[18:51:20] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[18:52:29] <Sergio965> But still, I get a call to _Unwind_Resume.
[18:52:42] <strcat> acrichto: and we have out-of-date tables with lists of passes
[18:52:43] <tjc> straw poll for other Rust developers: by default, do you build optimized or unoptimized these days?
[18:53:19] <strcat> anyway
[18:53:21] <acrichto> tjc: optimized
[18:53:28] <strcat> going to try setting it back to defaults
[18:53:52] <acrichto> strcat: thanks for looking into this, I'll do some more investigation tonight and see if I can't come up with something
[18:53:58] <Luqman> tjc: unoptimized if i'm just testing at stage1
[18:55:54] <strcat> acrichto: the C API is missing half of what we'd need
[18:56:08] <strcat> :\
[18:56:09] <acrichto> yeah I was never very impressed with LLVM's C api
[18:56:18] <strcat> http://llvm.org/docs/doxygen/html/group__LLVMCTransformsPassManagerBuilder.html
[18:56:22] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[18:56:27] *** Joins: sstangl (sstangl@moz-DB4A9C19.scl3.mozilla.com)
[18:56:39] <Sergio965> brson: This happens when I try to allocate using ~.
[18:58:32] <acrichto> strcat: is that the thing that we want? Right now we're calling LLVMCreatePassManager and then calling LLVMAddTargetData on the return value
[18:58:44] <strcat> acrichto: yes but we don't add the tti info passes.
[18:58:50] <acrichto> strcat: but does the PassManagerBuilder basically populate all the passes itself?
[18:58:52] <strcat> we need a way to print out what we're adding
[18:58:58] <strcat> acrichto: no, because we override it
[18:58:59] *** Joins: someguy (Mibbit@BB89402E.6B7DFD81.73686190.IP)
[18:59:03] <strcat> at least I think we do 
[18:59:08] *** Quits: xorcon (Mibbit@moz-ACDE7EEC.mozilla.com) (Quit: http://www.mibbit.com ajax IRC Client)
[18:59:09] <brson> Sergio965: rustc will still be generating landing pads for unwinding. it's possible there may be a rustc flag to disable them, or if not, to add such a flog
[18:59:09] <strcat> it's *entirely* possible that we append everything to the end
[18:59:15] <acrichto> we don't use the Builder at all
[18:59:24] <strcat> acrichto: we used to
[18:59:29] <acrichto> strcat: librustc/back/passes.rs ?
[18:59:34] <acrichto> oh wait nvmd
[18:59:36] <strcat> acrichto: anyway really, before we can do anything we need debug printing
[18:59:36] <brson> Sergio965: rustc will will also generate implicit calls to the `fail_` lang item for various reasons
[18:59:42] <strcat> acrichto: we *need* to find out what the hell we are doing :P
[18:59:51] <strcat> there's no way to know what
[18:59:55] <strcat> from the code
[18:59:59] <strcat> not documented
[19:00:04] *** Joins: allonhadaya (Mibbit@moz-5509948E.nyc.biz.rr.com)
[19:00:29] <strcat> I'm 99% sure we're missing the fn pass though
[19:00:37] <strcat> acrichto: http://llvm.org/docs/doxygen/html/group__LLVMCCorePassManagers.html#gacace2d072a4735931738af64cc6fc170 separate functions
[19:00:40] <strcat> we're not running those
[19:00:56] <toddaaro> rusti: 100 * 99 / 2
[19:00:57] -rusti- 4950
[19:01:04] <brson> Sergio965: for some use cases we may want alternate unwinding strategies, like 'return unwind' that is basically like having all functions return an implicit Result type
[19:01:08] <acrichto> strcat: yeah we're just calling RunPassManager
[19:01:40] <acrichto> strcat: it's not clear though that it's *not* running function psases
[19:01:47] <toddaaro> rusti: let mut x = 0; for i in range(1u, 100u) { x += i }; x
[19:01:48] -rusti- 4950
[19:01:55] <strcat> acrichto: well nothing is clear without figuring out how to do debug-pass=Arguments
[19:02:00] <strcat> if we can do that, I can fix it
[19:02:06] <strcat> I can't find anything about it
[19:02:10] <mindcat> rusti: random()
[19:02:10] -rusti- <anon>:5:9: 5:15 error: unresolved name `random`.
[19:02:10] -rusti- <anon>:5          random()
[19:02:11] -rusti-                   ^~~~~~
[19:02:11] -rusti- error: aborting due to previous error
[19:02:11] -rusti- application terminated with error code 101
[19:02:13] <strcat> going to end up digging through clang with grep
[19:03:24] <mindcat> rusti: let x = 2147483647*2;
[19:03:25] -rusti- <anon>:5:13: 5:14 warning: unused variable: `x` [-W unused-variable (default)]
[19:03:25] -rusti- <anon>:5          let x = 2147483647*2;
[19:03:25] -rusti-                       ^
[19:03:25] -rusti- ()
[19:03:55] <mindcat> rusti: let x = 2147483647*2147483647; x
[19:03:56] -rusti- 4611686014132420609
[19:04:44] <mindcat> can I can bring this bot to my home? :p
[19:05:06] <acrichto> strcat: http://llvm.org/docs/doxygen/html/PassManager_8cpp_source.html looks like that's where it's printing the passes
[19:05:10] <toddaaro> are the buildbots multi-socket?
[19:05:31] *** Joins: victorporof_ (victorporo@256FD045.43CE31D0.9B1E38F4.IP)
[19:05:51] <tjc> mindcat: you can build and use rusti locally if you check out the rust distribution! :-)
[19:06:23] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[19:06:28] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:06:31] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[19:06:46] *** Quits: victorporof (victorporo@256FD045.43CE31D0.9B1E38F4.IP) (Ping timeout)
[19:07:05] <tjc> whee, waiting for four compiles at once
[19:07:07] <tjc> we're living in the future
[19:07:09] <strcat> acrichto: yeah, I don't see where this stuff is in the C API
[19:07:14] <mindcat> tjc: really? I mean this IRC bot copy...
[19:07:34] <acrichto> strcat: well we're already reaching into the c++ for TimePassesIsEnable for "-Z time-passes"
[19:08:18] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:08:34] <tjc> mindcat: well, running rusti on your own machine does everything the IRC bot does, and more :-)
[19:08:41] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[19:08:52] <strcat> rusti the bot is just rustc
[19:10:45] <strcat> https://github.com/thestinger/rust-playpen I put the web version on github
[19:10:50] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:10:51] <kmc> i have bad luck with local rusti
[19:11:00] <kmc> when I type "2+2" it thinks for about 4 seconds and then segfaults
[19:11:17] <strcat> the irc bot is the same as the web one but uses a slightly different script in that bin dir
[19:11:21] <mindcat> tjc: but, I want deploy a rusti in somewhere... yes, I have a server.
[19:11:43] <ecr> kmd: odd, mine does that too
[19:12:24] <tjc> mindcat: oh, I see! ask strcat, then :-)
[19:12:39] <strcat> mindcat: https://github.com/thestinger/rust-playpen is http://strcat.zapto.org:8000/
[19:12:50] *** Quits: allonhadaya (Mibbit@moz-5509948E.nyc.biz.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[19:13:20] <strcat> the irc bot just uses this script instead http://ix.io/7sB
[19:13:20] <mindcat> strcat: I going try it, thanks :D
[19:13:39] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:13:42] <strcat> the initialization script is arch linux specific though
[19:13:49] <strcat> since it uses pacstrap to make linux roots
[19:13:56] <toddaaro> rusti: unsafe { let *mut x = 293423223453; x += 1 }
[19:13:56] -rusti- <anon>:5:22: 5:23 error: unexpected token: `*`
[19:13:56] -rusti- <anon>:5          unsafe { let *mut x = 293423223453; x += 1 }
[19:13:56] -rusti-                                ^
[19:13:56] -rusti- application terminated with error code 101
[19:14:05] <toddaaro> rusti: unsafe { let mut* x = 293423223453; x += 1 }
[19:14:05] -rusti- <anon>:5:25: 5:26 error: unexpected token: `*`
[19:14:06] -rusti- <anon>:5          unsafe { let mut* x = 293423223453; x += 1 }
[19:14:06] -rusti-                                   ^
[19:14:06] -rusti- application terminated with error code 101
[19:14:13] <toddaaro> rusti: unsafe { let mut *x = 293423223453; x += 1 }
[19:14:14] -rusti- <anon>:5:26: 5:27 error: unexpected token: `*`
[19:14:14] -rusti- <anon>:5          unsafe { let mut *x = 293423223453; x += 1 }
[19:14:14] -rusti-                                    ^
[19:14:14] -rusti- application terminated with error code 101
[19:14:21] <strcat> and playpen is going to end up depending on systemd >= v206 soon
[19:14:25] <strcat> due to cgroups totally changing 
[19:14:32] <toddaaro> rusti: unsafe { let *x = 293423223453; x += 1 }
[19:14:32] -rusti- <anon>:5:22: 5:23 error: unexpected token: `*`
[19:14:32] -rusti- <anon>:5          unsafe { let *x = 293423223453; x += 1 }
[19:14:32] -rusti-                                ^
[19:14:32] -rusti- application terminated with error code 101
[19:14:39] <strcat> the kernel is switching them to be single-writer, so you will have to depend on an init system to use them
[19:14:41] <toddaaro> rusti: unsafe { let x* = 293423223453; x += 1 }
[19:14:41] -rusti- <anon>:5:23: 5:24 error: expected `;` but found `*`
[19:14:41] -rusti- <anon>:5          unsafe { let x* = 293423223453; x += 1 }
[19:14:41] -rusti-                                 ^
[19:14:41] -rusti- application terminated with error code 101
[19:15:50] <mindcat> strcat: oh no. your website does not work, it tell me "undefined".
[19:16:12] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); x += 1 }
[19:16:12] -rusti- <anon>:5:88: 5:94 error: binary operation + cannot be applied to type `*mut uint`
[19:16:13] -rusti- <anon>:5          use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); x += 1 }
[19:16:13] -rusti-                                                                                                  ^~~~~~
[19:16:13] -rusti- error: aborting due to previous error
[19:16:14] -rusti- application terminated with error code 101
[19:16:24] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); x; }
[19:16:25] -rusti- <anon>:5:88: 5:89 warning: path statement with no effect [-W path-statement (default)]
[19:16:25] -rusti- <anon>:5          use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); x; }
[19:16:25] -rusti-                                                                                                  ^
[19:16:25] -rusti- ()
[19:16:33] <strcat> mindcat: hm, where does it say undefined?
[19:16:57] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut ~[] = transmute(293423223453); x[2]; }
[19:16:58] -rusti- <anon>:5:58: 5:59 error: expected type, found token RBRACKET
[19:16:58] -rusti- <anon>:5          use std::cast::transmute; unsafe { let x: *mut ~[] = transmute(293423223453); x[2]; }
[19:16:58] -rusti-                                                                    ^
[19:16:58] -rusti- application terminated with error code 101
[19:16:59] <mindcat> strcat: "evaluate" button, down side.
[19:17:04] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut [] = transmute(293423223453); x[2]; }
[19:17:04] -rusti- <anon>:5:57: 5:58 error: expected type, found token RBRACKET
[19:17:05] -rusti- <anon>:5          use std::cast::transmute; unsafe { let x: *mut [] = transmute(293423223453); x[2]; }
[19:17:05] -rusti-                                                                   ^
[19:17:05] -rusti- application terminated with error code 101
[19:17:17] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); *x; }
[19:17:18] -rusti- ()
[19:17:35] <toddaaro> rusti: use std::cast::transmute; unsafe { let x: *mut uint = transmute(293423223453); *x }
[19:17:35] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[19:17:42] <toddaaro> woooo!
[19:17:45] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[19:17:47] <strcat> mindcat: what's the code you are evaluating? just the default?
[19:17:58] <mindcat> strcat: just default.
[19:18:02] * strcat is using it and it works
[19:18:03] <SingingBoyo> toddaaro: did you just spend that long trying to get a segfault?
[19:18:07] *** Joins: tgummerer (tgummerer@moz-6DEE6C6B.retail.telecomitalia.it)
[19:18:07] <toddaaro> SingingBoyo: maybe
[19:18:12] <toddaaro> SingingBoyo: I'm kinda bad at rust
[19:18:22] <strcat> mindcat: which browser?
[19:18:30] <strcat> maybe my js isn't very portable
[19:18:35] <SingingBoyo> toddaaro: it would've taken me longer.  I'm just wondering why you'd try for a segfault...
[19:18:42] <mindcat> strcat: I am using Arch Linux, Google Chromium 28.0.1500.95 (213514)
[19:19:05] <toddaaro> SingingBoyo: I feel obligated
[19:19:09] *** Quits: valenting (Thunderbir@662B8DC.3F30A7E5.FB866788.IP) (Ping timeout)
[19:19:12] * strcat tries chromium
[19:19:33] <mindcat> x86-64
[19:20:34] <SingingBoyo> strcat: doesn't work for me with chromium on Ubuntu
[19:21:00] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[19:21:09] <mindcat> :D
[19:21:43] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:21:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2W1UfQ
[19:21:43] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:22:08] <SingingBoyo> mindcat, strcat: works with firefox though
[19:23:19] <mindcat> SingingBoyo: Ok, let me try it.
[19:23:46] * mindcat : Firefox... its here.
[19:23:54] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[19:24:02] <toddaaro> rusti: use extra::fileinput; for input_vec_state(pathify([~"/etc/hostname"]) |line, state| { io::println(fmt!("%s, line)) } 
[19:24:03] -rusti- <anon>:7:19: 7:20 error: unknown start of token: ?
[19:24:03] -rusti- <anon>:7     println(fmt!("%?", r))
[19:24:03] -rusti-                             ^
[19:24:03] -rusti- application terminated with error code 101
[19:24:21] <toddaaro> rusti: use extra::fileinput; for input_vec_state(pathify([~"/etc/hostname"]) |line, state| { io::println(fmt!("%s", line)) } 
[19:24:21] -rusti- <anon>:6:4: 6:5 error: incorrect close delimiter: `}`
[19:24:21] -rusti- <anon>:6     };
[19:24:22] -rusti-              ^
[19:24:22] -rusti- application terminated with error code 101
[19:24:26] <mindcat> SingingBoyo: yea, it is working.
[19:24:29] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[19:24:35] <toddaaro> rusti: use extra::fileinput; for input_vec_state(pathify([~"/etc/hostname"]) |line, state| { io::println(fmt!("%s", line)); };
[19:24:36] -rusti- <anon>:6:4: 6:5 error: incorrect close delimiter: `}`
[19:24:36] -rusti- <anon>:6     };
[19:24:36] -rusti-              ^
[19:24:36] -rusti- application terminated with error code 101
[19:24:47] <toddaaro> rusti: use extra::fileinput; for input_vec_state(pathify([~"/etc/hostname"])) |line, state| { io::println(fmt!("%s", line)); };
[19:24:47] -rusti- <anon>:5:80: 5:81 error: expected `in`, found `|`
[19:24:48] -rusti- <anon>:5          use extra::fileinput; for input_vec_state(pathify([~"/etc/hostname"])) |line, state| { io::println(fmt!("%s", line)); };
[19:24:48] -rusti-                                                                                          ^
[19:24:48] -rusti- application terminated with error code 101
[19:25:00] <mindcat> strcat: Firefox 23.0 is working.
[19:25:27] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:25:41] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:26:23] <toddaaro> rusti: use extra::fileinput; let input = FileInput::from_vec(pathify([~"/etc/hostname"])); for input.each_line |line| { io::println(line) };
[19:26:25] -rusti- line longer than 150 columns, pastebinned 4 lines of output: http://ix.io/7sE
[19:27:08] <toddaaro> rusti: use extra::fileinput; let input = FileInput::from_vec(pathify([~"/etc/hostname"])); for input.each_line() |line| { io::println(line) };
[19:27:10] -rusti- line longer than 150 columns, pastebinned 4 lines of output: http://ix.io/7sF
[19:27:34] <SingingBoyo> rusti: use extra::fileinput; let input = fileInput::from_vec(pathify([~"/etc/hostname"])); do input.each_line |line| { io::println(line) };
[19:27:36] -rusti- pastebinned 23 lines of output: http://ix.io/7sG
[19:27:38] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[19:27:49] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:27:57] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[19:27:57] <SingingBoyo> rusti: use extra::fileinput; let input = fileinput::from_vec(pathify([~"/etc/hostname"])); do input.each_line |line| { io::println(line) };
[19:27:59] -rusti- pastebinned 17 lines of output: http://ix.io/7sH
[19:28:29] <bblum> brson: ok, when i said i had an idea to fix the race, i thought i could do it without making the wake() (common-case) path have to use any extra xchgs, but i cannot actually get away with doing that after all
[19:28:43] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[19:28:49] <SingingBoyo> toddaaro: now you've got me curious about what this'll do once it works
[19:28:52] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[19:29:46] <toddaaro> rusti: use extra::fileinput; do input_vec_state(pathify([~"/etc/hostname")) |line, _state| { io::println(line); }
[19:29:46] -rusti- <anon>:5:75: 5:76 error: incorrect close delimiter: `)`
[19:29:47] -rusti- <anon>:5          use extra::fileinput; do input_vec_state(pathify([~"/etc/hostname")) |line, _state| { io::println(line); }
[19:29:47] -rusti-                                                                                     ^
[19:29:47] -rusti- application terminated with error code 101
[19:29:54] <toddaaro> rusti: use extra::fileinput; do input_vec_state(pathify([~"/etc/hostname"])) |line, _state| { io::println(line); }
[19:29:58] -rusti- pastebinned 17 lines of output: http://ix.io/7sI
[19:30:09] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:30:36] <SingingBoyo> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"/etc/hostname"])) |line, _state| { io::println(line); 
[19:30:36] -rusti- <anon>:8:0: 8:1 error: file ended with unbalanced delimiters
[19:30:37] -rusti- <anon>:8 }
[19:30:37] -rusti-          ^
[19:30:37] -rusti- application terminated with error code 101
[19:30:44] <SingingBoyo> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"/etc/hostname"])) |line, _state| { io::println(line); }
[19:30:46] -rusti- pastebinned 11 lines of output: http://ix.io/7sJ
[19:30:49] *** Quits: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu) (Ping timeout)
[19:30:59] <toddaaro> rusti: use extra::fileinput;
[19:31:00] -rusti- <anon>:5:13: 5:29 warning: unused import [-W unused-imports (default)]
[19:31:00] -rusti- <anon>:5          use extra::fileinput;
[19:31:00] -rusti-                       ^~~~~~~~~~~~~~~~
[19:31:00] -rusti- ()
[19:31:16] <SingingBoyo> rusti: use extra::fileinput::*; use std::io; do input_vec_state(pathify([~"/etc/hostname"])) |line, _state| { io::println(line); }
[19:31:18] -rusti- pastebinned 8 lines of output: http://ix.io/7sK
[19:31:43] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:31:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GfIWRw
[19:31:43] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:31:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:31:46] <ghrust> 01[13rust01] 15bors pushed 11 new commits to 06auto: 02http://git.io/YWWqYQ
[19:31:46] <ghrust> 13rust/06auto 14f3dd29c 15Patrick Walton: librustc: Remove `&const` and `*const` from the language....
[19:31:46] <ghrust> 13rust/06auto 145ed2f2d 15Patrick Walton: librustc: Add support for type parameters in the middle of paths....
[19:31:47] <ghrust> 13rust/06auto 14f45159b 15Patrick Walton: librustc: Ensure that type parameters are in the right positions in paths....
[19:31:49] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:31:52] <toddaaro> rusti: use extra::fileinput::{pathify, input_vec_state}; do input_vec_state(pathify([~"/etc/hostname"])) |line, _state| { std::io::println(line); }
[19:31:54] -rusti- pastebinned 8 lines of output: http://ix.io/7sL
[19:32:16] *** Joins: valenting (Thunderbir@662B8DC.3F30A7E5.FB866788.IP)
[19:32:33] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:32:37] <SingingBoyo> rusti: use extra::fileinput::*; use std::io; do input_vec_state(pathify([~"/etc/hostname"], true)) |line, _state| { io::println(line); true}
[19:32:38] -rusti- task <unnamed> failed at 'called `Result::unwrap()` on `Err` value: error opening /etc/hostname', /build/rust-git/src/rust/src/libstd/result.rs:120
[19:32:39] -rusti- application terminated with error code 101
[19:33:42] *** Quits: mindcat (mindcat@2DE37087.C6D6E0F5.857BDFA9.IP) (Quit: Lost terminal)
[19:33:50] <toddaaro> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"~/.bashrc"]), true) |line, _state| { std::io::println(line); true}
[19:33:52] -rusti- pastebinned 8 lines of output: http://ix.io/7sM
[19:34:12] *** Joins: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu)
[19:34:27] <toddaaro> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"~/.bashrc"], true)) |line, _state| { std::io::println(line); true}
[19:34:27] -rusti- task <unnamed> failed at 'called `Result::unwrap()` on `Err` value: error opening ~/.bashrc', /build/rust-git/src/rust/src/libstd/result.rs:120
[19:34:28] -rusti- application terminated with error code 101
[19:34:47] <toddaaro> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"~/.bash_profile"], true)) |line, _state| { std::io::println(line); true}
[19:34:48] -rusti- task <unnamed> failed at 'called `Result::unwrap()` on `Err` value: error opening ~/.bash_profile', /build/rust-git/src/rust/src/libstd/result.rs:120
[19:34:48] -rusti- application terminated with error code 101
[19:35:15] <acrichto> strcat: ok yeah I've been looking into these passes, and we're definitely doing things *very* differently than clang. It's all pretty standard though, so it should be easy enough to fix up. I'll try to whip up something tonight and see how well it works
[19:35:21] <toddaaro> rusti: use extra::fileinput::*; do input_vec_state(pathify([~"/timezone"], true)) |line, _state| { std::io::println(line); true}
[19:35:22] -rusti- task <unnamed> failed at 'called `Result::unwrap()` on `Err` value: error opening /timezone', /build/rust-git/src/rust/src/libstd/result.rs:120
[19:35:22] -rusti- application terminated with error code 101
[19:35:29] <Sergio965> brson: I define the fail_ langitem and define my own fail! macro. I'm unsure how to get rid of the unwind reference.
[19:35:46] <toddaaro> SingingBoyo: it looks like strcat shielded himself from this :/
[19:36:11] *** Quits: fabiand (fabiand@moz-6D2DCF21.adsl.alicedsl.de) (Quit: Verlassend)
[19:36:20] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[19:36:37] <SingingBoyo> toddaaro: I think it's sandboxed, yeah.
[19:37:33] *** Quits: tgummerer (tgummerer@moz-6DEE6C6B.retail.telecomitalia.it) (Ping timeout)
[19:37:41] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:38:04] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[19:39:16] *** Quits: someguy (Mibbit@BB89402E.6B7DFD81.73686190.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:39:25] *** Quits: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net) (Ping timeout)
[19:40:37] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[19:41:46] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:42:11] <strcat> toddaaro: it runs in a sandbox
[19:42:15] <strcat> it does have access to the filesystem
[19:42:19] <strcat> but it's a filesystem all to itself
[19:43:08] *** Joins: someguy (Mibbit@BB89402E.6B7DFD81.73686190.IP)
[19:43:20] <toddaaro> I have to figure out what names to guess
[19:44:15] <strcat> rusti: std::str::from_bytes(std::run::process_output("ps", [~"ax"]).output)
[19:44:27] <toddaaro> whoa that is a library
[19:44:30] <toddaaro> I tried to find that one
[19:44:34] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("ps", [~"ax"]).output))
[19:44:39] <strcat> hm
[19:44:41] <strcat> rusti: 2
[19:44:42] -rusti- 2
[19:44:47] <toddaaro> rusti: 2+2
[19:44:47] -rusti- 4
[19:44:50] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("ps", []).output))
[19:44:54] <strcat> wat
[19:45:09] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("echo", []).output))
[19:45:18] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("echo", [~"foo"]).output))
[19:45:19] <SingingBoyo> is it allowed to run processes?
[19:45:39] <strcat> depends on what syscalls it uses
[19:46:01] *** Joins: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de)
[19:47:28] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:48:24] <Sergio965> brson: Looks like -Z no-landing-pads is what I was looking for.
[19:48:55] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[19:49:03] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[19:49:18] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[19:50:16] <strcat> ok the problem was just that chromium doesn't implement XHR properly
[19:50:53] <strcat> http://code.google.com/p/chromium/issues/detail?id=119256 *sigh*
[19:51:42] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[19:51:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c89c616 to 140c6cc11: 02http://git.io/N3iJvQ
[19:51:42] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[19:51:45] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:51:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/tKuZHQ
[19:51:45] <ghrust> 13rust/06auto 1446672d2 15Jed Davis: Remove discriminant symbols....
[19:51:45] <ghrust> 13rust/06auto 1418144b1 15bors: auto merge of #8546 : jld/rust/discrim-symbol-rm, r=pcwalton...
[19:51:46] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:55:33] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[20:00:44] *** Quits: maik (maik___@moz-8068AB43.dip0.t-ipconnect.de) (Ping timeout)
[20:03:30] <eatkinson> error: illegal lifetime parameter name: `'self`
[20:03:40] <eatkinson> is there a fundamental reason i can't do this ^?
[20:04:33] *** Joins: victorporof (victorporo@256FD045.43CE31D0.9B1E38F4.IP)
[20:04:50] <SingingBoyo> eatkinson: self is reserved for use as name of the current object in impl fns, afaik
[20:05:46] *** Quits: victorporof_ (victorporo@256FD045.43CE31D0.9B1E38F4.IP) (Ping timeout)
[20:06:05] <eatkinson> hmm
[20:06:31] <eatkinson> SingingBoyo: what i would like to do is this: pub fn child_iter<'a,E:Iterator<&'a mut FlowContext>>(&'a mut self) -> E
[20:06:59] <eatkinson> SingingBoyo: but apparently i can't 'a inside the Iterator
[20:07:08] <eatkinson> *can't use 'a inside the iterator
[20:10:33] <nmatsakis> eatkinson: this is a bug
[20:10:37] *** Quits: valenting (Thunderbir@662B8DC.3F30A7E5.FB866788.IP) (Ping timeout)
[20:11:21] *** Quits: someguy (Mibbit@BB89402E.6B7DFD81.73686190.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:12:10] <Sergio965> Hmm. I'm a bit confused as to how garbage collection works for managed pointers. With an owned pointer, I see that once the pointer goes out of scope, the memory is freed. But when a managed pointer, this doesn't appear to be the case. When is the memory freed for a managed pointer?
[20:12:12] <eatkinson> nmatsakis: yeah i've run into it before. can't seem to find a workaround for this case though...
[20:12:20] <Sergio965> But with*
[20:12:22] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Client exited)
[20:13:21] <SingingBoyo> eatkinson: does pub fn child_iter<'a>(&'a mut self) -> Iterator<&'a mut FlowContext> work?  Might need to be ~Iterator because it's a trait.
[20:16:51] <SingingBoyo> Sergio965: I think they're just reference counted, possibly with cycle detection though I'm not sure about that.
[20:16:56] <eatkinson> SingingBoyo: yeah that'll work but i think it will use dynamic method dispatch
[20:18:00] <Sergio965> SingingBoyo: They are reference counted, yeah, but who increments and decrements the reference count? And when is cycle detection done? Is there some kind of periodically running garbage collector?
[20:19:36] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[20:20:23] <Ms2ger> match key.len() { _ if foo(key.len()) ...
[20:20:39] <Ms2ger> Is there no better way to refer to the second key.len() there?
[20:20:56] <joelteon> x if foo(x)
[20:21:15] <SingingBoyo> Sergio965: I don't use them often so my knowledge is limited, but afaik it's incremented wherever a move/copy would occur for an owned pointer, and decremented when a variable referencing it goes out of scope.
[20:21:21] <Ms2ger> I though it was something like that, thanks
[20:21:23] <fread2281> Sergio965: no cycle collection, GC is in the works. I'd imagine it's semantically similar to extra::rc::Rc where the refcount is incremented on borrow and decremented when it goes out of scope
[20:21:59] <olsonjeffery> brson graydon : one impl detail of us owning the seek cursor internally .. can't do SeekEnd w/o a file stat.. unless someone knows a better way?
[20:22:01] <Sergio965> SingingBoyo, fread2281: Interestingly enough, I the pointer mutable (let mut x = @bla), it is freed when it goes out of scope. It is not freed if it is immutable.
[20:22:03] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[20:22:04] <Sergio965> if*
[20:22:37] <Sergio965> If the pointer is mutable*
[20:22:43] <graydon> Sergio965: the inc/dec actions are inserted by the compiler
[20:22:52] <strcat> Sergio965: it's not going to be reference counted in the future though
[20:22:55] <graydon> Sergio965: cycles are currently only collected at task termination
[20:22:55] <strcat> so you can't rely on that
[20:23:08] <graydon> Sergio965: it will be a tracing gc as soon as we can get memory use low enough
[20:23:11] <strcat> the only thing you can rely on is that it will all be freed when the task ends
[20:23:15] <Sergio965> strcat: What's it going to be? Tracing?
[20:23:16] <Sergio965> I see.
[20:23:17] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[20:23:27] <strcat> you can use extra::rc for reference counted pointers
[20:23:31] <graydon> (eventually we hope to use a mostly-copying collector, but that's a ways out)
[20:23:39] <kmc> Sergio965: incrementing / decrementing happens when the pointers themselves are created and destroyed
[20:23:54] <kmc> it's like smart pointers in C++
[20:24:05] <Sergio965> Is there a reason an immutable pointer isn't freed when it goes out of scope?
[20:24:09] <kmc> a value of type @T has a constructor which increments a refcount on the corresponding box, and a destructor which decrements it
[20:24:10] <Sergio965> (But the mutable one is?)
[20:24:12] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:24:12] *** ChanServ sets mode: +o tjc
[20:24:14] <strcat> but @ doesn't do it like C++ because it doesn't have move semantics
[20:24:18] <strcat> it doesn't work sanely
[20:24:29] <strcat> x = @5 has a refcount of 2
[20:24:33] <kmc> Sergio965: makes more sense to talk about freeing the box, rather than freeing the pointer
[20:24:44] <Sergio965> Freeing the box, right, kmc .
[20:24:49] <SingingBoyo> is there still debate over whether or not to remove @-ptrs entirely?
[20:25:01] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[20:25:10] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:25:17] <kmc> and why do you say that immutable pointers to managed boxes (or do you mean pointers to immutable managed boxes?) don't decrement?
[20:25:18] <Sergio965> strcat: Two? One by the variable, and the other?
[20:25:39] <strcat> Sergio965: the refcount it starts with
[20:25:42] <strcat> anyway you really don't want to use @.
[20:25:47] <kmc> the key difference with extra::rc is that extra::rc a) prevents cycles statically, using traits; b) has move semantics (so if you want to bump the refcount you have to .clone())
[20:25:50] <kmc> iirc
[20:25:59] <kmc> of course sometimes cycles are useful
[20:26:06] <strcat> and extra::rc doesn't have a 4-word header
[20:26:26] <Sergio965> strcat: I guess I don't know if I want to use @ or not.
[20:26:27] <kmc> right, because it doesn't need to get linked into the list that the task-exit cycle collector traverses
[20:26:32] <mm> What is a "word" in this context?  machine-pointer?
[20:26:45] <strcat> Sergio965: there's no use case for @ beyond the syntactic sugar right now
[20:27:04] <strcat> it has a 4-word header instead of 1-word like Rc, and does a refcount on any pass/assign/return
[20:27:07] <Sergio965> What about structured with cycles?
[20:27:07] <SingingBoyo> does extra::rc have a way to get weak-ptrs, and allow cycles through that?
[20:27:14] <kmc> there's a lot of code in Servo which assumes that @ boxes are refcounted :/
[20:27:15] <Sergio965> structures*
[20:27:18] <kmc> that's gonna be fun to fix
[20:27:25] <strcat> kmc: well it should be using Rc ;p
[20:27:31] <strcat> Sergio965: they are going to leak until the end of a task because there is no gc yet
[20:27:42] <strcat> so you likely don't want to make cycles
[20:27:49] <Sergio965> I see. I suppose that's what I'm seeing.
[20:28:39] <strcat> SingingBoyo: no, it doesn't pay the cost of weak pointers
[20:28:55] <kmc> strcat: yep!
[20:28:56] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Client exited)
[20:29:27] <kmc> how would you implement weak pointers with refcounting, anyway
[20:29:31] <brson> olsonjeffery: I can't think of anything better than fstat
[20:29:45] <strcat> kmc: there are 2 choices
[20:29:54] <strcat> one way is to add a linked list of weak pointers to the box
[20:30:15] <strcat> and then when it frees itself, it walks the weak pointers and marks them dead
[20:30:36] <strcat> the other way is to split the box into 2 parts, where one part has the object and the other has the counts (one for strong refs, one for weak refs)
[20:31:03] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:31:04] <strcat> and when strong refs get to 0 you free the object, when weak refs and strong refs are 0 you can free the count alloc
[20:31:43] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[20:32:00] <kmc> mm
[20:32:03] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[20:32:09] <strcat> anyway obviously there is a cost to supporting that :)
[20:32:21] <olsonjeffery> brson: k.. im gonna map that out, including the struct.. so will take a little time. i guess if you have any feedback on my PR as it stands, just throw it over the fence and ill address it
[20:32:29] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Connection reset by peer)
[20:32:29] *** Joins: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[20:32:40] <mm> kmc: ;)
[20:32:45] <kmc> haha
[20:32:49] <kmc> you must get that a lot
[20:32:59] <mm> yes :P
[20:33:00] <strcat> kmc: also to actually *use* a weak pointer you have to convert it to a strong ptr
[20:33:02] <strcat> it's just a huge pain
[20:33:03] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[20:33:03] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[20:33:06] <kmc> strcat: yeah I figured
[20:33:12] <strcat> http://en.cppreference.com/w/cpp/memory/weak_ptr
[20:33:28] <kmc> I think Servo will eventually want weak pointers into the SpiderMonkey heap...
[20:33:31] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:33:32] <strcat> and ofc you have the failure case where the object is freed and you don't realize
[20:34:47] *** Quits: Ms2ger (Ms2ger@moz-590E79FE.adsl-dyn.isp.belgacom.be) (Quit: nn)
[20:36:21] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[20:39:01] <brson> olsonjeffery: going to look at it now
[20:39:24] <olsonjeffery> brson: well give 10 minutes, then and ill push up more tests and updates
[20:39:28] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[20:39:41] <olsonjeffery> i pretty much have everything but the internal seek cursor done
[20:39:48] <brson> olsonjeffery: do what you need to. it's going to take me time
[20:39:54] * olsonjeffery nods
[20:39:58] * brson lazy and tired
[20:40:07] <kimundi> strcat: Why not add an third 'StrongRc' ? have fast Rc, and a pair of StrongRc and WeakRc
[20:40:10] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[20:40:58] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[20:41:42] <strcat> kimundi: we could but then someone has to choose between the 2 ways to implement it
[20:41:44] <strcat> ;p
[20:42:06] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:42:06] *** ChanServ sets mode: +o tjc
[20:42:07] <kimundi> strcat: Just do what c++ does?
[20:42:28] <strcat> C++ doesn't specify an implementation
[20:42:39] <strcat> can look at what libc++ does
[20:42:48] <strcat> it has to do atomic refcounting, etc. so their needs are different
[20:43:04] <strcat> kimundi: we would also need the same for every type of arc
[20:43:06] <strcat> it's a pain
[20:44:10] <kimundi> yeah
[20:44:30] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[20:45:31] *** Quits: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP) (Ping timeout)
[20:46:35] *** Joins: kasey (Kasey@moz-569EFDE8.dhcp.trlk.ca.charter.com)
[20:48:47] *** Parts: kasey (Kasey@moz-569EFDE8.dhcp.trlk.ca.charter.com) ()
[20:49:56] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[20:50:13] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:51:34] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[20:52:19] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:52:56] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:53:04] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:53:18] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:53:34] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:53:35] <strcat> rusti: @5.repr()
[20:53:36] -rusti- <anon>:5:10: 6:5 error: type `<VI0>` does not implement any method in scope named `repr`
[20:53:36] -rusti- <anon>:5          @5.repr()
[20:53:36] -rusti- <anon>:6     };
[20:53:36] -rusti- error: aborting due to previous error
[20:53:36] -rusti- application terminated with error code 101
[20:53:43] <strcat> rusti: use std::unstable::raw::Repr; @5.repr()
[20:53:43] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[20:53:44] -rusti- <anon>:5:40: 6:5 error: type `<VI0>` does not implement any method in scope named `repr`
[20:53:44] -rusti- <anon>:5          use std::unstable::raw::Repr; @5.repr()
[20:53:44] -rusti- <anon>:6     };
[20:53:44] -rusti- error: aborting due to previous error
[20:53:46] -rusti- application terminated with error code 101
[20:53:47] <strcat> hrm
[20:54:05] <strcat> rusti: use std::unstable::raw::Repr; let x = @5u; x.repr()
[20:54:06] -rusti- 140264035323184
[20:54:09] <strcat> uh.
[20:54:19] <strcat> rusti: use std::unstable::raw::Repr; let x = @5u; unsafe { *x.repr() }
[20:54:20] -rusti- {ref_count: 1, type_desc: (0x60b0e0 as *()), prev: (0x0 as *()), next: (0x0 as *()), data: 5}
[20:54:31] <strcat> rusti: use std::unstable::raw::Repr; let mut x = @5u; x = @10; unsafe { *x.repr() }
[20:54:32] -rusti- <anon>:5:47: 5:48 warning: value assigned to `x` is never read [-W dead-assignment (default)]
[20:54:32] -rusti- <anon>:5          use std::unstable::raw::Repr; let mut x = @5u; x = @10; unsafe { *x.repr() }
[20:54:32] -rusti-                                                         ^
[20:54:32] -rusti- {ref_count: 2, type_desc: (0x60b1c0 as *()), prev: (0x0 as *()), next: (0x0 as *()), data: 10}
[20:54:37] <strcat> ref_count 2.
[20:54:45] <strcat> so yeah, @ is evil right now ;p
[20:55:02] <strcat> rusti: use std::unstable::raw::Repr; let mut x = @5u; println(*x.to_str()); x = @10; unsafe { *x.repr() }
[20:55:02] -rusti- <anon>:5:64: 5:76 error: type ~str cannot be dereferenced
[20:55:02] -rusti- <anon>:5          use std::unstable::raw::Repr; let mut x = @5u; println(*x.to_str()); x = @10; unsafe { *x.repr() }
[20:55:03] -rusti-                                                                          ^~~~~~~~~~~~
[20:55:03] -rusti- error: aborting due to previous error
[20:55:03] -rusti- application terminated with error code 101
[20:55:10] <strcat> rusti: use std::unstable::raw::Repr; let mut x = @5u; println((*x).to_str()); x = @10; unsafe { *x.repr() }
[20:55:11] -rusti- 5
[20:55:11] -rusti- {ref_count: 2, type_desc: (0x60f020 as *()), prev: (0x0 as *()), next: (0x0 as *()), data: 10}
[20:55:29] <strcat> rusti: use std::unstable::raw::Repr; let mut x = @5u; println((*x).to_str()); { x = @10 }; unsafe { *x.repr() }
[20:55:30] -rusti- 5
[20:55:30] -rusti- {ref_count: 1, type_desc: (0x60f020 as *()), prev: (0x0 as *()), next: (0x0 as *()), data: 10}
[20:56:02] <strcat> rusti: use std::rc::Rc; Rc::new(5)
[20:56:04] -rusti- pastebinned 8 lines of output: http://ix.io/7sS
[20:56:15] <strcat> rusti: use std::rc::Rc; Rc::from_const(5u)
[20:56:17] -rusti- pastebinned 8 lines of output: http://ix.io/7sT
[20:56:20] <strcat> rusti: use std::rc::Rc; Rc::from_freeze(5u)
[20:56:22] -rusti- pastebinned 8 lines of output: http://ix.io/7sU
[20:56:27] <strcat> ugh
[20:56:28] *** Quits: dave1629 (dave@4749ECC6.2F87036F.DDE5D3F6.IP) (Quit: dave1629)
[20:56:31] <strcat> rusti: use extra::rc::Rc; Rc::from_freeze(5u)
[20:56:32] -rusti- {ptr: (0x7fee9c000d30 as *())}
[20:56:48] *** Joins: dave1629 (dave@4749ECC6.2F87036F.DDE5D3F6.IP)
[20:57:51] <strcat> rusti: use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p: (int, uint) = std::cast::transmute(*x.borrow()); p
[20:57:51] -rusti- <anon>:5:101: 5:135 error: call to unsafe function requires unsafe function or block
[20:57:52] -rusti- <anon>:5          use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p: (int, uint) = std::cast::transmute(*x.borrow()); p
[20:57:52] -rusti-                                                                                                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[20:57:52] -rusti- error: aborting due to previous error
[20:57:53] -rusti- application terminated with error code 101
[20:58:04] <strcat> rusti: use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p: (int, uint) = unsafe { std::cast::transmute(*x.borrow()); } p
[20:58:06] -rusti- line longer than 150 columns, pastebinned 4 lines of output: http://ix.io/7sV
[20:58:10] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:58:14] <strcat> rusti: use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p: (int, uint) = unsafe { std::cast::transmute(*x.borrow()); }; p
[20:58:16] -rusti- line longer than 150 columns, pastebinned 5 lines of output: http://ix.io/7sW
[20:58:19] <strcat> rusti: use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p: (int, uint) = unsafe { std::cast::transmute(*x.borrow()) }; p
[20:58:21] -rusti- pastebinned 7 lines of output: http://ix.io/7sX
[20:58:22] * strcat gives up
[20:58:53] <strcat> rusti: use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p:& (int, uint) = unsafe { std::cast::transmute(x) }; p
[20:58:53] -rusti- <anon>:5:36: 5:37 warning: value assigned to `x` is never read [-W dead-assignment (default)]
[20:58:54] -rusti- <anon>:5          use extra::rc::Rc; let mut x = Rc::from_send(5); x = Rc::from_send(5); let p:& (int, uint) = unsafe { std::cast::transmute(x) }; p
[20:58:54] -rusti-                                              ^
[20:58:54] -rusti- &(5, 1)
[21:00:13] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[21:00:58] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:01:11] <acrichto> graydon: ping
[21:01:16] <graydon> acrichto: pong
[21:01:30] <acrichto> graydon: when you mentioned writef, you meant as the actual function name, not macro name, right?
[21:01:58] <graydon> acrichto: both?
[21:02:07] *** Quits: dave1629 (dave@4749ECC6.2F87036F.DDE5D3F6.IP) (Quit: dave1629)
[21:02:16] <acrichto> graydon: ok
[21:02:32] <graydon> acrichto: I don't know. fmt!() is well loved by now but fmtf!() seems like it's pushing the banishment-of-vowels habit to the breaking point
[21:03:01] <acrichto> yeah I agree
[21:03:52] <acrichto> graydon: is it too weird to have ifmt implemented by sprintf, and writef implemented by writef ?
[21:04:02] <acrichto> or rather fmt implemented by sprintf
[21:04:04] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[21:04:22] <graydon> might as well start adding macros like thbbft (https://i.chzbgr.com/maxW500/1075222784/hB4D47A66/)
[21:04:22] *** Quits: Palmik (palmik@moz-CC484FDD.tmcz.cz) (Quit: Lost terminal)
[21:04:34] <kmc> LLVM is padding the spaces between aligned blocks with 90 90 90 90 90 instead of the fancier multi-byte nops! for shame!
[21:04:36] <graydon> um
[21:04:38] <nmatsakis> has anyone tried out the new debug support?
[21:04:49] <strcat> kmc: could be because we aren't doing proper target info
[21:04:53] <graydon> nmatsakis: I confess I have not. I'm a terrible person.
[21:04:57] <strcat> nothing can really be blamed on LLVM at this point ;p
[21:05:06] <graydon> acrichto: that is weird, yes
[21:05:14] <kmc> ;)
[21:05:22] <pauls> That one's easy; Test Html-to-BBcode Formatting Template.
[21:05:49] <strcat> kmc: would servo actually be *implementing* a refcounted pointer with weak references? or just using one provided by spidermonkey
[21:06:02] <strcat> (and writing a wrapper around it)
[21:06:02] * kmc ack --thpppt
[21:06:03] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:06:05] <kmc> strcat: I don't know
[21:06:31] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:06:59] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[21:07:15] <strcat> graydon: cgroups got a lot harder to use :(
[21:07:24] <graydon> acrichto: I assume fmt!() is the eventual function name for produce-a-string, yes?
[21:07:43] <strcat> my 20 lines of C becomes 150+ lines of dbus wrangling
[21:07:45] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[21:07:47] <acrichto> graydon: yeah I didn't plan on changing that
[21:07:48] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[21:08:18] <graydon> acrichto: or should we make fmt!() send to a writer by default, and sfmt!() produce a string writer, write to it, and return the result?
[21:08:31] <graydon> acrichto: somehow sfmt seems less awful to me than fmtf
[21:08:45] <graydon> maybe I am just a hopeless person to ask on this
[21:08:46] <acrichto> neither option seems ideal though
[21:09:04] <graydon> no, they both read like hairballs
[21:09:28] <acrichto> if we're following C-like things, fmt! goes to stdout, sfmt! comes back as a string and ffmt! takes a writer
[21:09:30] * graydon patiently waiting for someone else clever to suggest something
[21:09:42] <graydon> hm. that's not .. _too_ bad?
[21:09:46] <acrichto> ffmt is awful
[21:09:57] <Eridius> why not leave fmt!() as returning a string, and fmtto!() as writing to a writer?
[21:10:09] <Eridius> or fmt_to!()
[21:10:21] <graydon> that's how we arrived at writef!()
[21:10:28] <strcat> or just use Extendable instead of a writer
[21:10:35] <graydon> extendable?
[21:10:43] <erickt> strcat: by cgroups, are you referring to the linux kernel cgroups?
[21:10:46] <strcat> erickt: yes
[21:10:54] <graydon> strcat: they hitched it to _dbus_?!
[21:10:56] <strcat> rusti: let mut xs = ~[1, 2]; xs.extend(range(3, 10)); xs
[21:10:58] -rusti- pastebinned 7 lines of output: http://ix.io/7sZ
[21:11:06] <strcat> rusti: let mut xs = ~[1, 2]; xs.extend(&mut range(3, 10)); xs
[21:11:07] -rusti- ~[1, 2, 3, 4, 5, 6, 7, 8, 9]
[21:11:09] <acrichto> Eridius: I was thinking it'd be nice to have a parallel to C-like {,s,f}printf, but that may be too much to ask for
[21:11:18] <erickt> strcat: are you making a binding to dbus?
[21:11:22] <strcat> graydon: well, the kernel people decided the current API is insane
[21:11:37] <strcat> erickt: I've thought about it, decided I am not that crazy yet though
[21:11:38] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:11:38] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/tKuZHQ
[21:11:38] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:11:44] <strcat> graydon: so it's becoming single-writer
[21:11:49] * graydon weeps
[21:11:51] <strcat> so the single writer will be systemd or upstart
[21:11:56] <strcat> and you will have to talk to them over dbus
[21:12:07] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[21:12:07] <erickt> strcat: whatcha working on with dbus and cgroups?
[21:12:18] <strcat> erickt: well, I have dozens of little cgroup things
[21:12:22] <strcat> all of them are going to break \o/
[21:12:30] <strcat> rusti: "I'm one"
[21:12:31] -rusti- "I\'m one"
[21:12:36] * graydon would give serious money to arrive in a future with only one init-replacement
[21:12:47] * erickt has been wanting to play with cgroups since they first came out
[21:12:58] <strcat> graydon: in theory that's systemd, but canonical wants to make their own userland
[21:13:03] <strcat> they also made their own X replacement.
[21:13:26] <graydon> eponysterical
[21:13:39] <strcat> the xorg/intel people made wayland
[21:13:47] <erickt> the universe abhorrs a single init
[21:13:52] <graydon> yeah I've been watching this unfold
[21:14:25] <strcat> graydon: http://ix.io/7lx the new way of making a cgroup :s
[21:14:26] <graydon> I can barely believe I'm seeing it
[21:14:28] <nmatsakis> jld: ping
[21:14:29] <strcat> unless systemd exposes a C API
[21:14:43] <strcat> they have a lot of nice C APIs already but... they like keeping things private
[21:14:54] <strcat> they are going to kill dbus anyway
[21:15:00] <Ke> is there a problem with having alternatives
[21:15:04] <graydon> who's going to kill dbus?
[21:15:11] <strcat> graydon: systemd + the kernel people
[21:15:19] <Ke> everything is becoming systemd compatible in any case
[21:15:22] <graydon> kill .. how?
[21:15:26] <kmc> i thought they were moving dbus into the kernel...
[21:15:29] <kmc> in order to kill it?
[21:15:33] <strcat> graydon: https://github.com/gregkh/kdbus
[21:15:46] <strcat> kmc: well it's shares none of the API
[21:15:48] <strcat> and that's the awful part.
[21:16:12] <strcat> systemd has an internal sd_bus library that will switch to wrapping kdbus, and then I guess it will be exposed as a public C library
[21:16:24] <strcat> they really hate dbus
[21:16:28] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[21:16:33] <strcat> the *implementation* at least
[21:16:36] <graydon> Ke: I have no problem with alternatives existing. I have a slight problem with large parties who are playing an infrastructure role for zillions of downstreams seemingly discounting the costs of differentiation on their dependencies.
[21:16:58] <strcat> wayland is just a little shim over a bunch of libraries/modules where the real work was done
[21:17:07] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[21:17:08] <strcat> so it's silly to make another frontend to those libraries
[21:17:13] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Client exited)
[21:17:24] <strcat> since that's the actual API for applications/toolkits
[21:17:32] <strcat> same implementation... different API - why? ;p
[21:18:10] <strcat> wayland is just IPC for shared memory buffers really - the application draws decorations, handles input, and so on
[21:18:28] <strcat> (or really, the toolkit the app uses)
[21:18:58] <graydon> mhm
[21:19:06] <graydon> well, this is all getting quite far afield for a PL-related channel
[21:19:12] <graydon> sorry, didn't mean to drag us off topic
[21:19:16] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:19:19] <Earnestly> It's fun, I don't mind
[21:19:21] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:19:22] <strcat> well, the relevant part is figuring out how to bind dbus in rust
[21:19:24] <strcat> ;]
[21:19:30] <strcat> the current awful dbus API.
[21:19:34] <tjc> What's the new thing to break on in gdb instead of upcall_fail?
[21:19:45] <graydon> yeah. I'm curious insofar as it means we have yet more worries about how to bind to reasonable parts of the linux userspace. but we'll cross that bridge when we get there.
[21:19:47] <erickt> tjc: rust_begin_unwind
[21:19:51] <tjc> erickt: thanks
[21:20:25] <strcat> maybe it's the type of thing Encoder could do
[21:20:34] <strcat> need to serialize stuff to the weird dbus types
[21:21:36] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:21:36] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/LAqvUw
[21:21:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:21:38] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:21:38] <ghrust> 01[13rust01] 15bors pushed 10 new commits to 06auto: 02http://git.io/7WaP7Q
[21:21:38] <ghrust> 13rust/06auto 14369f7fa 15Ben Blum: Prevent Send, Freeze, and Sized from being manually implemented. Close #8517.
[21:21:38] <ghrust> 13rust/06auto 1469322d9 15Ben Blum: Allow traits to use builtin kinds as supertraits for #7083.
[21:21:39] <ghrust> 13rust/06auto 144ca2e55 15Ben Blum: Add tests for #7083.
[21:21:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:22:23] <erickt> strcat: not sure if I mentioned this before, but I'm contemplating doing another redesign of serialize.rs. I'm considering rewriting it to use iterators instead of recursive closures
[21:23:28] <erickt> my little mockups suggest it may be a bit faster
[21:24:18] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[21:24:26] <strcat> acrichto: are we actually near the tip of LLVM now?
[21:24:45] *** Joins: jclements (jclements@moz-CFCDCB39.dhcp.snlo.ca.charter.com)
[21:24:47] <acrichto> strcat: we're at something like llvm master from 2 days ago
[21:24:55] <erickt> plus I'd like to support directly decoding from a json string into a rust structure, rather than parse to json::Json, then decode it into a structure
[21:25:19] <bblum> ecr: do any of your uses of deschedule_..and_then() in the IO code require that the closure's environment live on the invoking task's stack, instead of being passed into the closure by-value?
[21:25:29] <erickt> graydon: there's some possibility this might help with the metadata encoding/decoding too
[21:25:34] <graydon> erick: this sounds good, I've been meaning to politely ask about just that :)
[21:25:51] <erickt> graydon: no need to be polite :)
[21:26:09] <graydon> erick: (direct json + maybe using something a little more incremental / iteratey)
[21:26:39] <graydon> erick: it's also .. I'm not sure what exactly is causing it but there's an awful lot of code being generated for serialization presently
[21:26:58] <graydon> erickt: might just be the usual "type_use isn't figuring out what to recycle" issue.
[21:27:04] <erickt> the only problem is writing a recursive iterator for an n-ary enum is a royal pain in the butt
[21:27:07] <graydon> (sorry erick, nick-completion misfire)
[21:27:23] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:27:28] <erickt> erick: there can be only one!!
[21:27:30] <strcat> there's always the glib approach to serialization :P
[21:27:31] <jld> nmatsakis: pong
[21:27:42] <erickt> strcat: what's that?
[21:27:55] <strcat> mmap + directly writing stuff to it ;)
[21:28:00] <strcat> well, reading usually
[21:28:02] <erickt> heh
[21:28:17] <strcat> I think that's what dconf does
[21:28:47] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: WeeChat 0.4.2-dev)
[21:28:48] <erickt> graydon: I was originally going to put off my iterator serializer until we got generators, but I might just bite the bullet and write the ugly state machine now
[21:28:54] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[21:29:07] <strcat> https://wiki.gnome.org/dconf#Design similar to our use case
[21:29:16] <strcat> Since a typical GNOME login consists of thousands of reads and ideally 0 writes, dconf is optimised for reads. Typically, reading a key from dconf involves zero system calls and zero context switches. This is achieved with a simple file format that doubles both as the storage format for data in dconf and as an IPC mechanism between the clients and the server. 
[21:29:26] <strcat> but yeah it's really a hack.
[21:29:36] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[21:30:12] <strcat> since it's write-once
[21:30:29] <erickt> strcat: neat. vaguely reminds me of http://kentonv.github.io/capnproto/
[21:30:45] *** Quits: jclements (jclements@moz-CFCDCB39.dhcp.snlo.ca.charter.com) (Quit: jclements)
[21:31:00] <nmatsakis> jld: how hard would it be to make Option<extern "C" fn(...)> represented as a single ptr? presumably fairly esay?
[21:31:59] <strcat> so what they have is an on-disk endian-independent hash table
[21:32:50] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[21:33:19] <Eridius> nmatsakis: are `extern "C" fn(...)`s non-nullable?
[21:33:37] <Eridius> nmatsakis: making that non-nullable would rule out the ability to add weak-linking for extern fns?
[21:33:40] *** Joins: jclements (jclements@moz-CFCDCB39.dhcp.snlo.ca.charter.com)
[21:33:40] <Eridius> s/?//
[21:34:01] <strcat> nmatsakis: I think you just need to update mono_data_classify
[21:34:04] <strcat> in trans/common.rs
[21:34:14] <strcat> to return MonoNonNull for extern fn
[21:34:24] <jld> nmatsakis: Should be pretty easy?  The routine that... uh, what strcat just said.
[21:34:29] <strcat> I investigated what it would take for slices
[21:35:19] <strcat> and it probably makes sense to add an attribute for Rc, etc.
[21:36:04] <toddaaro> rusti: use std::unstable::atomics::*; let x = AtomicUint::new(120); x.compare_and_swap(120, 5, Relaxed)
[21:36:05] -rusti- <anon>:5:70: 5:71 error: cannot borrow immutable local variable as mutable
[21:36:05] -rusti- <anon>:5          use std::unstable::atomics::*; let x = AtomicUint::new(120); x.compare_and_swap(120, 5, Relaxed)
[21:36:05] -rusti-                                                                                ^
[21:36:05] -rusti- error: aborting due to previous error
[21:36:06] -rusti- application terminated with error code 101
[21:36:13] <toddaaro> rusti: use std::unstable::atomics::*; let mut x = AtomicUint::new(120); x.compare_and_swap(120, 5, Relaxed)
[21:36:14] -rusti- 120
[21:36:29] <toddaaro> rusti: use std::unstable::atomics::*; let mut x = AtomicUint::new(120); x.compare_and_swap(100, 5, Relaxed)
[21:36:30] -rusti- 120
[21:36:49] <toddaaro> that is interesting
[21:37:16] <ecr> bblum: I don't think so
[21:37:30] <erickt> strcat: it probably wouldn't be too hard to combine mmap, capnproto, and a wrapper read-only hashmap to get your on-disk endian-independent hash table
[21:37:55] <erickt> that wouldn't need deserialization
[21:38:17] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[21:38:20] <strcat> just bswaps
[21:38:33] *** Quits: jclements (jclements@moz-CFCDCB39.dhcp.snlo.ca.charter.com) (Quit: jclements)
[21:38:35] <strcat> on big endian archs... which no one uses ;p
[21:39:18] *** Joins: simon (simon@moz-CBE4BB13.cable.teksavvy.com)
[21:39:19] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Connection reset by peer)
[21:40:12] *** Quits: simon (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: WeeChat 0.4.2-dev)
[21:40:17] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[21:41:09] <toddaaro> rusti: use std::unstable::atomics::*; let mut x = AtomicUint::new(120); x.compare_and_swap(100, 5, Relaxed); x.load(SeqCst)
[21:41:10] -rusti- 120
[21:41:19] <toddaaro> rusti: use std::unstable::atomics::*; let mut x = AtomicUint::new(120); x.compare_and_swap(120, 5, Relaxed); x.load(SeqCst)
[21:41:20] -rusti- 5
[21:43:03] <ecr> bblum: do you want me to go through and check?
[21:43:34] <bblum> ecr: no... i think my question was off track anyway
[21:43:38] *** Quits: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu) (Quit: Textual IRC Client: www.textualapp.com)
[21:44:11] <ecr> bblum: alright. I'm pretty sure all my uses of it would be once functions.
[21:45:41] * ecr dreams of eliminating all these cells with once functions...
[21:46:46] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[21:48:40] <erickt> graydon: do you have a sense of whether or not the fact that metadata needs to be deserialized is an issue? Say we converted it over to using iterators and everything was inlined properly. Would it be fast enough? or do you think we still might need an on disk format that could be mmaped into a hash table?
[21:48:57] <SingingBoyo> do vectors not have a filter method?
[21:49:10] <strcat> SingingBoyo: they do, via the iterator
[21:49:13] <erickt> SingingBoyo: try ~[1,2,3].iter().filter(|x| x>2)
[21:49:33] <SingingBoyo> strcat, erickt: ah okay, thanks
[21:49:33] <strcat> although with two derefs ;p
[21:49:38] <graydon> erick: I think it needs to have a format we can mmap-in-a-hashtable in order to find the right chunk for, but then the chunk should be deserialized
[21:49:42] <graydon> grr sorry erick
[21:49:55] <graydon> erickt: ^^ I mean, that's pretty much what we do now, or try to
[21:50:02] <Eridius> erickt: you'll need |&x| there
[21:50:19] <Eridius> oh yeah, two derefs like strcat said. bah
[21:50:22] <strcat> graydon: we could just directly write our object representations out with a conversion to a common endian though
[21:50:27] <graydon> erickt: there are broad tables that point to specific sub-tables and then it bottoms out in custom encodings and/or straight serialization within the chunks, for the ASTs.
[21:50:54] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[21:50:56] <graydon> strcat: define "directly"
[21:51:00] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[21:51:01] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[21:51:02] <olsonjeffery> brson: ah, wow. thanks for catching that stuff i removed in rust_uv.cpp .. i thought i had preserved that when i merged.
[21:51:04] *** Quits: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca) (Ping timeout)
[21:51:06] *** Quits: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[21:51:25] <graydon> strcat: I mean, if it's not the format the program needs in memory .. 
[21:51:43] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[21:51:48] *** Joins: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca)
[21:51:58] <strcat> graydon: we could have fixed-size vectors, tuples, enums, etc. though
[21:52:02] <strcat> directly mmap'ed
[21:52:09] *** Joins: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[21:52:09] *** Joins: Liothen (liothen@moz-80EF0CD7.spkn.qwest.net)
[21:52:10] <strcat> just not references
[21:52:25] <graydon> strcat: or wrong-endian / wrong-width ints
[21:52:47] <graydon> if you can convince llvm to treat a pointer as "byte swap when you read through it", let me know!
[21:52:47] <strcat> yeah but the hash table would bswap when it returned a value to you, and it would only have fixed-size ints
[21:53:11] <graydon> oh, just for the outermost hashtable(s), sure
[21:53:24] <strcat> graydon: well you would only have 1 table, and namespace your keys
[21:53:26] <graydon> I'm talking about things like "an AST we pulled out of the metadata section for inlining"
[21:53:27] *** Joins: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca)
[21:53:50] <olsonjeffery> brson: would actually be cool if there was a random tmpfile name generator somewhere, like in rt::test::* or something.
[21:53:56] <olsonjeffery> like how there is with the newrt tcp tests
[21:54:13] <erickt> olsonjeffery: what about extra::tempfile?
[21:54:16] <toddaaro> rusti: for i in range(1u, 3) { io::println("%u", i); }
[21:54:18] -rusti- pastebinned 11 lines of output: http://ix.io/7t1
[21:54:38] <toddaaro> rusti: for i in range(1u, 3) { io::println(fmt!("%u", i)); }
[21:54:40] -rusti- pastebinned 11 lines of output: http://ix.io/7t2
[21:54:41] <graydon> strcat: that's a substantial data structure. it'd be super cool if we could somehow just dump a static of that, mmap it into memory and then use it w/o any "deserialization", but I don't think LLVM will let us decorate a pointer into such an mmap in such a way that it insulates against arch differences.
[21:54:51] <toddaaro> rusti: for i in range(1u, 3) { std::io::println(fmt!("%u", i)); }
[21:54:52] -rusti- 1
[21:54:52] -rusti- 2
[21:54:52] -rusti- ()
[21:54:55] <olsonjeffery> erickt: this is for file io.. so i need filenames to create as part of test
[21:54:56] <olsonjeffery> +s
[21:55:00] <toddaaro> rusti: for i in range(0u, 3) { std::io::println(fmt!("%u", i)); }
[21:55:01] -rusti- 0
[21:55:01] -rusti- 1
[21:55:01] -rusti- 2
[21:55:01] -rusti- ()
[21:55:20] <toddaaro> ok that is some quirky range function, is that the norm and I just never knew?
[21:55:37] <strcat> it's the norm in 0-indexed array languages
[21:55:50] <Eridius> strcat: is it? I thought it was just a pythonism
[21:55:53] <brson> olsonjeffery: yes rt::test could use something for that purpose
[21:56:06] <strcat> Eridius: it comes from C for loops, or even before then
[21:56:13] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Input/output error)
[21:56:13] <erickt> graydon / strcat: I may then start helping dwrensha with capnproto-rust for that outer hashmap. I'd rather leverage someone else's work doing the bit twiddling than write my own mmap-compatible structure
[21:56:14] <strcat> a C for loop can't easily loop over [a..b]
[21:56:21] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:56:23] <toddaaro> hm, so Scala includes the 3 by default
[21:56:39] <Eridius> strcat: oh I thought the question was about range(), not about the [a,b) behavior.
[21:56:41] <toddaaro> so that is the norm I'm used to, I didn't realize there was variation
[21:56:46] <erickt> graydon / strcat: but first I'll look into the iterator serializers
[21:56:47] <SingingBoyo> toddaaro: Scala has Int.to and Int.until
[21:56:50] <Eridius> strcat: but yeah a for loop can, as long as b is not the max representable value
[21:56:53] <toddaaro> SingingBoyo: ohhh, yes
[21:56:57] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[21:57:00] <strcat> Eridius: well that's what I mean
[21:57:07] <strcat> if b is a variable
[21:57:12] <SingingBoyo> toddaaro: you use to for inclusive, until for things like loops over arrays
[21:57:26] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[21:57:36] <graydon> erickt: I'm curious about capnproto but also a little unsure about its stability. seems to be pretty fast moving target.
[21:57:45] <toddaaro> SingingBoyo: yea, it is coming back to me now, that is one of Scala's nicer attributes
[21:58:18] <SingingBoyo> toddaaro: yeah, lots of little well-named methods that keep code nice and readable.
[21:58:26] <erickt> graydon: understood. I'll treat it as a low priority experiment.
[21:59:07] <erickt> graydon: fortunately it does have a nice pedigree though. It's made by the ex-googler that made protocol buffers version 2
[21:59:37] <graydon> erickt: yeah, I read it over, it looks promising
[22:00:07] <SingingBoyo> do vectors have a method for consuming themselves and producing a new vector that has an additional element?
[22:00:27] <strcat> SingingBoyo: move_iter
[22:00:36] <strcat> if you really want to do it in 1 expr you could
[22:01:12] <SingingBoyo> strcat: everything's in iterators, isn't it.
[22:01:14] <strcat> rusti: ~[1, 2, 3].move_iter().chain(Some(4).move_iter()).to_owned_vec()
[22:01:14] -rusti- <anon>:5:10: 5:32 error: type `[<VI2>, .. 3]` does not implement any method in scope named `move_iter`
[22:01:15] -rusti- <anon>:5          ~[1, 2, 3].move_iter().chain(Some(4).move_iter()).to_owned_vec()
[22:01:15] -rusti-                    ^~~~~~~~~~~~~~~~~~~~~~
[22:01:15] -rusti- error: aborting due to previous error
[22:01:15] -rusti- application terminated with error code 101
[22:01:17] <Eridius> SingingBoyo: why do you need a method to do that?
[22:01:22] <strcat> rusti: (~[1, 2, 3]).move_iter().chain(Some(4).move_iter()).to_owned_vec()
[22:01:23] -rusti- ~[1, 2, 3, 4]
[22:01:29] <Eridius> rusti: let xs = ~[1,2,3]; { xs.push(4); xs }
[22:01:30] -rusti- <anon>:5:30: 5:32 error: cannot borrow immutable local variable as mutable
[22:01:30] -rusti- <anon>:5          let xs = ~[1,2,3]; { xs.push(4); xs }
[22:01:30] -rusti-                                        ^~
[22:01:30] -rusti- error: aborting due to previous error
[22:01:30] -rusti- application terminated with error code 101
[22:01:37] <Eridius> rusti: let mut xs = ~[1,2,3]; { xs.push(4); xs }
[22:01:38] -rusti- ~[1, 2, 3, 4]
[22:01:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[22:01:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14653f027 to 1418144b1: 02http://git.io/N3iJvQ
[22:01:38] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[22:01:39] <strcat> or you could just copy it and push 4 ;p
[22:01:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[22:01:40] <ghrust> 01[13rust01] 15bors pushed 12 new commits to 06auto: 02http://git.io/K1dIag
[22:01:40] <ghrust> 13rust/06auto 146e19248 15Tim Chevalier: testsuite: Tests for #6458. Closes #6458
[22:01:40] <ghrust> 13rust/06auto 14cc60518 15Tim Chevalier: std/extra: changing XXX to FIXME; cleanup...
[22:01:40] <ghrust> 13rust/06auto 1489899fd 15Tim Chevalier: extra: change alloc to take &mut self, as per XXX comment
[22:01:42] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[22:01:45] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:01:51] <strcat> but I assume you want to do some sort of  conversion
[22:02:32] <SingingBoyo> strcat: I'm filtering out some things and then trying to add a new element after.  don't really want to make something mutable just for that.
[22:02:40] <strcat> rusti: ~[1, 2, 3].move_iter().filter(chain(Some(4).move_iter()).to_owned_vec()
[22:02:40] -rusti- <anon>:6:4: 6:5 error: incorrect close delimiter: `}`
[22:02:40] -rusti- <anon>:6     };
[22:02:40] -rusti-              ^
[22:02:41] -rusti- application terminated with error code 101
[22:02:42] <strcat> er
[22:02:43] <SingingBoyo> I think I'm really looking for lists, though
[22:02:44] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[22:02:52] <strcat> rusti: ~[1, 2, 3].move_iter().filter(|x| x & 1 == 0).chain(Some(4).move_iter()).to_owned_vec()
[22:02:54] -rusti- pastebinned 8 lines of output: http://ix.io/7t5
[22:02:57] <strcat> rusti: ~[1, 2, 3].move_iter().filter(|&x| x & 1 == 0).chain(Some(4).move_iter()).to_owned_vec()
[22:02:59] -rusti- pastebinned 8 lines of output: http://ix.io/7t6
[22:03:15] <strcat> rusti: (~[1, 2, 3]).move_iter().filter(|&x| x & 1 == 0).chain(Some(4).move_iter()).to_owned_vec()
[22:03:16] -rusti- ~[2, 4]
[22:03:18] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:03:19] <strcat> ugh why does that parse like that
[22:04:38] <nmatsakis> strcat: because ~ is a unary operator and dot binds more tightly.
[22:05:03] <strcat> nmatsakis: it was more of a rhetorical question :)
[22:05:15] <SingingBoyo> I think the standard library really needs an Iterable trait that has defaults for things like filter and map.  writing .move_iter() or .iter() for filtering is just weird, IMO
[22:05:25] <strcat> you'd always have to write move_iter
[22:05:31] <strcat> there has to be a default, for Iterable
[22:05:36] <strcat> I assume it would be by-ref
[22:06:00] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[22:06:15] <nmatsakis> oh :)
[22:06:33] <erickt> SingingBoyo: I believe there's a commented out trait that tries to do that
[22:06:40] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[22:06:53] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[22:06:57] <SingingBoyo> strcat:  why would it require move_iter?  might be filter_move and map_move to consume the values, but other than that...
[22:07:14] <strcat> because there are 20+ iterator adaptors
[22:07:19] <erickt> SingingBoyo: it's trying to extend every type that implements Iterator, but there's a bug with that code
[22:07:37] <strcat> and there are by-ref, by-move, by-mut-ref, by-slice-chunks, by-slice-windows, etc. iterators
[22:07:45] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[22:08:03] <SingingBoyo> erickt: any idea where that is? I might take a look and see if I can convince it to work
[22:08:08] <strcat> separating adaptors from iterators means you don't need n*m methods, you need n iterators and m adaptors
[22:08:49] <SingingBoyo> strcat: well yes, but convenience methods for by-ref and by-move would be nice
[22:09:07] <strcat> we're not going to have 2 versions of each adaptor though
[22:09:16] *** Joins: jamil_1 (quassel@moz-2FB0F793.wateen.net)
[22:09:24] <strcat> it could just be called .consume() instead of move_iter
[22:09:39] <erickt> SingingBoyo: the actual problem is a compiler bug.
[22:10:08] <erickt> strcat: there was an RFC and a call made by graydon to rename .consume() to .move_iter()
[22:10:20] <strcat> oh
[22:10:28] <SingingBoyo> strcat: why not just a trait that required iter() and move_iter(), then have default method definitions that use those to define filter/filter_move, map/map_move?
[22:12:16] <strcat> because I don't think .bar_foo() is better than .foo().bar() if it means adding more complexity
[22:12:29] <erickt> SingingBoyo: looks like it got removed
[22:13:12] <strcat> SingingBoyo: I don't think they can be default methods
[22:13:16] <strcat> hm
[22:13:44] <SingingBoyo> strcat: wouldn't it be x.bar_foo() vs x.[move_]iter().bar_foo()?
[22:13:44] <strcat> it's going to get really mad about & &'self []
[22:13:50] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[22:13:56] *** Quits: jamil_1 (quassel@moz-2FB0F793.wateen.net) (Ping timeout)
[22:16:46] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Ping timeout)
[22:17:12] <SingingBoyo> well, maybe I'll try it out sometime, see if I can come up with something.
[22:17:13] <SingingBoyo> it's kind of trivial but it'd be more intuitive for people coming from haskell/scala.
[22:19:06] <toddaaro> I'm getting a segfault in jemalloc, what would cause that?
[22:19:21] <erickt> strcat: this would be a good example for why it'd be nice to be able to have type expression constraints
[22:19:58] <toddaaro> happening in "bitmap_set" in an arena code thing
[22:19:59] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[22:20:30] <erickt> strcat: we could have a `impl<T: Iterator + Move> MoveFilterIterator for T` whose .filter() works with moves, and `impl<T: Iterator + !Move> FilterIterator for T` for reference iterators
[22:21:23] <engla> you can use filter_map if you need to move while you filter
[22:21:35] <toddaaro> brson: ping
[22:21:52] <toddaaro> brson: know what to do about jemalloc segfaulting?
[22:22:04] <erickt> or maybe it'd be `impl<T: Move, IT: Iterator<T> MoveFilterIterator<T> ...` and `impl<T: !Move, Iterator<&T> FilterIterator<&T> ...` or something
[22:24:04] <brson> toddaaro: first I would find out if it's overflowing the stack
[22:24:16] <toddaaro> brson: what is the check for that?
[22:24:20] <toddaaro> brson: I asked it for 64MB
[22:25:51] <brson> toddaaro: the way i check is by breaking at the segfault in gdb and looking at `info frame` at both ends of the callstack. it'll list a saved stack pointer somewhere and the difference should be less than 2MB. if it's more then you've probably hit the end of the stack
[22:26:12] <dolphinling> Does the foreign function interface have support for variadic c functions?
[22:26:54] <erickt> dolphinling: I'd be surprised if it did
[22:27:39] <toddaaro> brson: how do I get to the other side of the callstack?
[22:27:47] <dolphinling> erickt: The documentation doesn't say anything about it so I'm not hopeful, but I figured it was worth asking
[22:28:03] <toddaaro> brson: ah, found it
[22:28:12] <erickt> if I remember correcty, variadic c functions have a surprisingly obnoxious ABI
[22:29:36] <ecr> brson: ping
[22:30:42] <ecr> dolphinling: I'm pretty sure it doesn't support variadic c functions right now. not sure what the plan for that is.
[22:30:47] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:31:01] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[22:32:43] *** Joins: mib_67dujv (Mibbit@moz-C09F376E.dhcp.psdn.ca.charter.com)
[22:34:34] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[22:34:34] *** ChanServ sets mode: +o dherman
[22:34:38] <toddaaro> brson: looks like no stack overflow
[22:35:06] *** Quits: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:35:14] <toddaaro> brson: delta of 1856
[22:35:51] *** Joins: lmandel (lmandel@moz-BBE3ABD.mv.mozilla.com)
[22:36:12] <toddaaro> brson: I'll do a make clean and confirm it stays
[22:36:16] <toddaaro> oh duh
[22:36:26] <toddaaro> I changed a struct, yea that was almost certainly NO_REBUILD
[22:36:36] <toddaaro> I was just talking about how reliably it segfaults randomly when you do that too
[22:37:27] <toddaaro> we should rename it VERY_VERY_UNSAFE_NO_REBUILD
[22:38:11] <sully> make crash
[22:39:17] *** Quits: mib_67dujv (Mibbit@moz-C09F376E.dhcp.psdn.ca.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[22:40:09] <ecr> hopes: deleted
[22:40:29] <toddaaro> I'm about to put up a PR for VERY_VERY_UNSAFE_NO_REBUILD as the name
[22:41:32] <olsonjeffery> ecr: hey wanted to say that the homing io stuff is pretty slick..
[22:41:45] <olsonjeffery> would it be possible to bottleneck all scheduler borrows through that check?
[22:42:06] <olsonjeffery> like, take an Option<SchedHandle> or something and keep the old borrow path if None
[22:43:14] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[22:43:21] *** Quits: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr) (Quit: Gone)
[22:47:34] <bstrie> Luqman: ping
[22:47:47] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:47:53] <ecr> olsonjeffery: not sure. I'll look into it
[22:47:59] <ecr> and thanks :)
[22:48:34] *** Joins: mib_cq05yz (Mibbit@3207FDF4.63607F49.DAACBEF1.IP)
[22:48:58] <SingingBoyo> does rustpkg work reliably?  if my shell scripts keep expanding with more crates it's going to get unwieldy fast...
[22:50:56] <tjc> SingingBoyo: it works, but there are some missing features
[22:51:18] <toddaaro> oh no
[22:51:28] <toddaaro> make clean; make check-stage1-std still has the segfault
[22:51:35] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:51:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148f057de to 1418144b1: 02http://git.io/N3iJvQ
[22:51:36] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:51:36] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[22:51:36] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/3q5vIw
[22:51:36] <ghrust> 13rust/06auto 14a106613 15Andreas Martens: Fix ICE when calling static and static function pointers...
[22:51:36] <ghrust> 13rust/06auto 14cc0c6fd 15Andreas Martens: Add assertions and cross crate tests
[22:51:37] <ghrust> 13rust/06auto 140f6dd53 15Andreas Martens: Split cross-crate test into own test and xfail-fast it
[22:51:39] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[22:52:48] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[22:54:10] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:54:22] <toddaaro> brson: I put my code in a branch named cld, still segfaulting in jemalloc, doesn't look like a stack overflow
[22:54:26] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[22:55:00] <ecr> olsonjeffery: could you elaborate on that scheduler borrow idea?
[22:55:12] <ecr> just want to make sure I'm looking at the right thing
[22:55:56] <olsonjeffery> well if you look at how it's used, in practice
[22:56:18] <olsonjeffery> self.home_for_io always immediately preceeds a scheduler call to deschedule the running task
[22:57:06] <ecr> hm
[22:57:22] <brson> toddaaro: you may want to try reverting jemalloc and seeing if it still segfaults. `git log --grep jemalloc` to find it
[22:57:34] <toddaaro> brson: k, I'll do that
[22:58:22] <brson> olsonjeffery ecr: appropos to your discussion and https://github.com/mozilla/rust/issues/8674. I/O probably *also* needs to call task::unkillable before blocking
[22:58:33] <toddaaro> brson: it is likely related to how I allocate a 8000000 element array: "raw: ~[AtomicPtr::new(intrinsics::uninit()), ..8000000]"
[22:58:59] <bblum> oh god toddaaro 
[22:59:02] <bblum> use ptr::null()
[22:59:05] <bblum> gross
[22:59:11] <toddaaro> wait ptr::null() exists?
[22:59:21] <toddaaro> I thought I asked about that and got told it didn't
[23:00:09] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:00:27] <strcat> rusti: 0 as *int
[23:00:28] -rusti- 0
[23:00:31] <ecr> olsonjeffery: well it doesn't for things like socket control functions (socketname, control_congestion, etc.), but it's a common enough pattern that I could make a variant on home_for_io and gives you the scheduler too. part of the contract would be that the closure is responsible using the scheduler to start the next operation (otherwise it'll drop into the abyss).
[23:00:43] <toddaaro> rusti: std::ptr::null()
[23:00:46] -rusti- pastebinned 6 lines of output: http://ix.io/7t9
[23:00:48] <strcat> rusti: unsafe { *(0 as *int) }
[23:00:49] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[23:00:55] <ecr> actually, it's a pretty clean divide for async libuv functions needing the scheduler
[23:01:02] <ecr> and sync functions not needing it
[23:01:13] <ecr> that's probably a good thing to split apart
[23:01:30] <toddaaro> rusti: let x: *mut uint = std::ptr::null()
[23:01:30] -rusti- <anon>:6:4: 6:5 error: expected `;` but found `}`
[23:01:31] -rusti- <anon>:6     };
[23:01:31] -rusti-              ^
[23:01:31] -rusti- application terminated with error code 101
[23:01:33] *** Quits: mib_cq05yz (Mibbit@3207FDF4.63607F49.DAACBEF1.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:01:34] <toddaaro> rusti: let x: *mut uint = std::ptr::null();
[23:01:35] -rusti- <anon>:5:28: 5:45 error: mismatched types: expected `*mut uint` but found `*<V5>` (values differ in mutability)
[23:01:35] -rusti- <anon>:5          let x: *mut uint = std::ptr::null();
[23:01:35] -rusti-                                      ^~~~~~~~~~~~~~~~~
[23:01:35] -rusti- error: aborting due to previous error
[23:01:37] -rusti- application terminated with error code 101
[23:01:43] <toddaaro> rusti: let x: * uint = std::ptr::null();
[23:01:43] -rusti- <anon>:5:13: 5:14 warning: unused variable: `x` [-W unused-variable (default)]
[23:01:44] -rusti- <anon>:5          let x: * uint = std::ptr::null();
[23:01:44] -rusti-                       ^
[23:01:45] -rusti- ()
[23:01:45] <Luqman> bstrie: pong
[23:01:48] <toddaaro> rusti: let x: * uint = std::ptr::null(); x
[23:01:49] -rusti- 0
[23:01:52] <toddaaro> rusti: let x: * uint = std::ptr::null(); *x
[23:01:53] -rusti- <anon>:5:43: 5:45 error: dereference of unsafe pointer requires unsafe function or block
[23:01:53] -rusti- <anon>:5          let x: * uint = std::ptr::null(); *x
[23:01:53] -rusti-                                                     ^~
[23:01:54] -rusti- error: aborting due to previous error
[23:01:56] -rusti- application terminated with error code 101
[23:01:59] <toddaaro> rusti: let x: * uint = std::ptr::null(); unsafe { *x }
[23:02:00] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[23:02:44] <ecr> brson: I'll go through at add those calls then. I translated all the UDP stuff to use run_in_mt_newsched_task and used the oneshot pipe trick to make sure no deadlocks would happen. I have an idea for restructuring TCP to split out listen from accept too.
[23:02:54] *** Quits: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP) (Ping timeout)
[23:03:31] *** nrc is now known as nrc|afk
[23:03:33] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:04:23] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[23:05:24] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[23:05:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:06:11] <jmgrosen> any (simple) way to get an Iterator over lines from a Reader?
[23:06:31] <dbaupp> jmgrosen: nope
[23:06:37] <jmgrosen> dbaupp, aww, ok
[23:06:40] <bstrie> jmgrosen: I think in the future there will be an .each_line iterator
[23:06:44] <bstrie> just now now because io is bad
[23:06:44] <ecr> not yet. I want to make IO iterator based eventually
[23:06:58] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:06:58] <dbaupp> jmgrosen: well, I guess you can read the whole thing into a string and use .line_iter
[23:07:20] <jmgrosen> dbaupp: yeah, although i'm parsing a fairly large file, so i'd rather not do that
[23:08:02] <dbaupp> jmgrosen: yeah, unfortunately you're left with the .each_line internal iterator
[23:08:17] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[23:09:29] <bblum> do compile-fail tests fail if the compiler ICEs versus if it doesn't?
[23:09:42] *** Quits: [squiddy] (squiddy@moz-A5352A4F.adsl.alicedsl.de) (Quit: Leaving)
[23:10:00] <strcat> bblum: they're to test error messages, I think if the compiler ICEs it will just not pass
[23:10:09] <strcat> because it won't be the message it's looking for
[23:10:16] <strcat> just won't pass*
[23:10:35] <bblum> strcat: what if it also produces the desired error
[23:10:40] <bblum> in a ddition to an ice
[23:10:46] <strcat> it'd probably pass.
[23:10:55] <strcat> it's fuzzy matching
[23:11:04] <dbaupp> it might test exit code too?
[23:12:02] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[23:15:14] <ecr> do we have a way to force a function to consume an argument passed to it (i.e. make a type linear rather than affine)?
[23:16:13] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[23:16:49] *** Joins: cowboyd (cowboyd@moz-AEF2A134.austin.res.rr.com)
[23:17:02] <dbaupp> ecr: fn foo(linear: ~x), I guess
[23:17:35] <toddaaro> I think the issue is ensuring "proper" consumption
[23:17:40] <toddaaro> and not just destruction
[23:17:44] <jmgrosen> anyone seen this ICE before? "task <unnamed> failed at 'parse_region: bad input', /path/to/rust/src/librustc/metadata/tydecode.rs:264"
[23:17:49] <SingingBoyo> any particular reason for not having a json::Json::to_pretty_str(&self) when json::to_pretty_str(&json::Json) exists?
[23:18:32] <Eridius> SingingBoyo: probably not. I'm guessing that's just older code
[23:18:40] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[23:18:42] <ecr> dbaupp: that's still affine. foo isn't forced to give away x in it's body
[23:18:58] <strcat> rusti: fn foo<T: Drop>(x: T) {}
[23:18:59] -rusti- <anon>:5:25: 5:26 warning: unused variable: `x` [-W unused-variable (default)]
[23:18:59] -rusti- <anon>:5          fn foo<T: Drop>(x: T) {}
[23:18:59] -rusti-                                   ^
[23:18:59] -rusti- ()
[23:19:02] <sammykim> Is there anyone who have built rust for android in two days?
[23:19:24] <dbaupp> ecr: oh, I guess I'm misunderstanding the question
[23:19:24] <strcat> ecr: how do you make them pass it though?
[23:19:26] <SingingBoyo> Eridius: figures.  well, time to file a bug and maybe fix it and make a PR.
[23:20:30] <ecr> basically, I want to take a closure that will get the scheduler and I want to force the closure to do something with the scheduler that will consume it (i.e. do a scheduling op) instead of just letting it drop out of scope at deallocate it (letting the scheduler fall into the abyss)
[23:21:03] <toddaaro> ecr: we could make consmption return a ConsumedScheduler token
[23:21:17] <ecr> and then require the closure to return that to me
[23:21:19] <bblum> what happened to the //^~ ERROR syntax?
[23:21:24] <bblum> it does not seem to work anymore
[23:21:25] <strcat> ecr: make them return (foo, call)?
[23:21:45] <bblum> oh ~^
[23:22:09] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:22:28] <leonvv> Can anyone tell me why I get this error: "`TcpListener` does not implement any method in scope named `accept`", while it's declared here: https://github.com/mozilla/rust/blob/master/src/libstd/rt/io/net/tcp.rs#L127
[23:22:30] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[23:22:40] *** Parts: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) ()
[23:23:15] <acrichto> leonvv: make sure you have the Listener trait in-scope
[23:24:14] <leonvv> acrichto: Thanks, that solved it.
[23:24:49] <acrichto> leonvv: whenever you impl something, you can think of it as adding methods to the thing on the left, so the methods weren't actually added to TcpListener and you've got to have the Listener trait in scope so resolve can find the method
[23:25:08] <acrichto> left as in `impl Trait for Type` -- Trait is on the left
[23:25:16] <acrichto> and `impl Type` has Type on the left
[23:25:47] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[23:25:47] *** ChanServ sets mode: +o tjc
[23:26:28] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:26:40] <SingingBoyo> where's the ToStr trait defined? also does anything actually use it?
[23:27:00] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[23:27:02] <acrichto> SingingBoyo: std::to_str, and lots of things implement it (it's in the prelude by default as well)
[23:27:54] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:28:34] <leonvv> acrichto: I always thought that traits where just a way of making sure a struct has some particular methods, never knew you need to have the trait itself in scope in order to have access to them
[23:28:46] *** ozten is now known as ozten|afk
[23:29:08] <acrichto> leonvv: it's true, you've probably been using a fair number of trait-based methods by default, but the prelude automatically imports the most common traits so you're not doing that everywhere
[23:29:41] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[23:29:44] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[23:30:16] *** Quits: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[23:30:25] <leonvv> acrichto: I see, thanks for all the info
[23:30:33] <acrichto> np
[23:30:36] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[23:31:12] <bstrie> anyone need a roommate for the toronto summit? if not I'll have to take my chances with the roulette
[23:32:17] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[23:32:42] *** Quits: cowboyd (cowboyd@moz-AEF2A134.austin.res.rr.com) (Client exited)
[23:34:01] * SingingBoyo wishes there was a Vancouver summit.  Someday...
[23:34:20] * dbaupp wishes there was a southern hemisphere summit
[23:34:44] <aatch> dbaupp, I agree
[23:34:50] <eschweic> Is it legal to use iter().find(â€¦) and mutate the returned object?
[23:34:58] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[23:35:12] <aatch> I could probably make an aus summit
[23:35:22] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:35:22] <ChrisMorgan> That'd be mut_iter, probably
[23:35:27] <aatch> eschweic, if you use mut_iter() (or whatever) then yes.
[23:35:48] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[23:36:17] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[23:36:17] *** ChanServ sets mode: +o tjc
[23:36:20] *** Quits: igl (igl@moz-63733429.adsl.alicedsl.de) (Ping timeout)
[23:36:40] <aatch> the only illegal thing is doing something that would invalidate the iterator itself, but changing elements is fine.
[23:36:50] <eschweic> aatch: okay. The issue I'm running into is `cannot borrow an `&mut` in a `&` pointer; try an `&mut` instead` within the find
[23:36:56] *** Joins: igl (igl@moz-684C758E.adsl.alicedsl.de)
[23:36:57] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[23:37:13] <brson> ecr: excellent. thanks
[23:37:19] <aatch> eschweic, code?
[23:38:12] *** ozten|afk is now known as ozten
[23:38:15] <sfackler> brson: r? https://github.com/mozilla/rust/pull/8607 I had to do the same thing to ReaderByteConversions
[23:38:36] <bstrie> dbaupp: you should organize RUSTCON SOUTHERN HEMISPHERE '012 for all the oceania folks
[23:39:04] <aatch> bstrie, 2012?
[23:39:54] *** Joins: dherman (dherman@moz-7B0110AD.mv.mozilla.com)
[23:39:55] *** ChanServ sets mode: +o dherman
[23:40:50] <dbaupp> aatch: 3012
[23:41:01] <SingingBoyo> aatch: I guess we're inventing time travel here too
[23:41:02] <dbaupp> you know, just as we start getting stable :P
[23:41:23] *** Joins: dherman_ (dherman@moz-BBE3ABD.mv.mozilla.com)
[23:41:47] *** Quits: dherman (dherman@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[23:41:47] *** dherman_ is now known as dherman
[23:41:53] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Ping timeout)
[23:41:54] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Quit: WeeChat 0.4.2-dev)
[23:42:04] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[23:44:05] <SingingBoyo> aw drat.  just got the new llvm.  time to go buy, cook, and eat dinner.
[23:45:48] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[23:47:26] <eschweic> aatch: unfortunately, the line itself isn't too helpful since it involves structs that I didn't write
[23:47:30] <eschweic> match self.children.mut_iter().find(|x| pipeline_id == x.child.pipeline.id)
[23:47:33] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Connection reset by peer)
[23:47:36] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[23:47:48] <eschweic> aatch: the x.child.pipeline.id is what triggers the error
[23:48:34] <dbaupp> eschweic: what's the error?
[23:48:44] *** ozten is now known as ozten|afk
[23:48:54] <eschweic> dbaupp: cannot borrow an `&mut` in a `&` pointer; try an `&mut` instead
[23:49:17] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[23:49:34] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Connection reset by peer)
[23:49:36] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[23:49:46] <dbaupp> woah, how strange
[23:49:56] <aatch> eschweic, that should work, might be a bug...
[23:50:06] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[23:50:07] <dbaupp> are you sure it's the find that's the bug?
[23:50:25] <dbaupp> s/bug/problem/
[23:50:49] <engla> so child or pipeline or id is a &mut inside a struct
[23:50:50] <eschweic> dbaupp: as far as I can tell, x in this case becomes a &&mut pointer
[23:51:02] <engla> ah right
[23:51:39] <pcwalton> that's not a bug
[23:51:40] <aatch> actually, eschweic, where does the caret point to? The start of `x.child.pipeline.id` or the end?
[23:51:55] <eschweic> aatch: the start
[23:51:57] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Connection reset by peer)
[23:52:00] *** Joins: maxli1 (maxli@B5559308.9C54E60.2FA4EA88.IP)
[23:52:01] <pcwalton> &mut inside & is a nasty corner case that we have to severely restrict
[23:52:13] <pcwalton> or else arbitrary casts would be possible in the safe language
[23:52:17] <dbaupp> eschweic: yeah, but you should be able to access it immutably in the find (?)
[23:53:13] <pcwalton> you can't access &mut behind & immutably
[23:53:29] <eschweic> I was hoping |&x| would work, but I can't dereference
[23:53:43] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[23:53:46] <dbaupp> pcwalton: so if you have a & &mut then there's nothing you can do with it?
[23:53:47] <eschweic> hmm, I'll just have to find another way to do this I guess
[23:53:52] <pcwalton> dbaupp: you can access fields
[23:53:56] <pcwalton> you can read
[23:53:58] <pcwalton> that's about it
[23:54:24] <dbaupp> isn't that exactly what eschweic is doing?
[23:54:30] <aatch> pcwalton, but that's all that it is doing there ^
[23:54:34] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[23:54:43] <pcwalton> hmm, no borrow?
[23:54:46] <pcwalton> weird
[23:54:52] <pcwalton> that might be a bug, nmatsakis?
[23:54:58] <aatch> it's just field access, no methods.
[23:55:54] *** Joins: ofeldt (ofeldt@moz-7DA3D443.dip0.t-ipconnect.de)
[23:55:56] *** Joins: RMF (RMF@100FCB1B.10FB11BA.8D19547B.IP)
[23:56:02] *** Joins: josedonizetti (josedonize@moz-CA73D699.cpe.teksavvy.com)
[23:56:27] <eschweic> does the eq(&self) method count?
[23:56:32] <pcwalton> yeah, possibly a bug
[23:56:34] *** Quits: ofeldt- (ofeldt@moz-390582E3.dip0.t-ipconnect.de) (Ping timeout)
[23:56:36] <pcwalton> eschweic: yup
[23:56:40] <pcwalton> eq requires an immutable borrow
[23:57:10] <aatch> eschweic, so id isn't just an int?
[23:57:21] <eschweic> no, it's a newtype struct
[23:57:37] <mm> Should I be compiling Rust with something other than the default "make" target?
[23:57:42] <pcwalton> eschweic: just copy out the thing
[23:57:44] <mm> 'cause I don't get it to compile until I "make install"
[23:57:46] <pcwalton> and then use == on the copy
[23:57:51] <aatch> eschweic, hmm, then it's implicitlu copyable, so just copy it out.
[23:57:57] <mm> "make" seems to just do stage0?
[23:58:12] <eschweic> aatch: pcwalton: okay, will do. Thanks!
[23:58:17] <aatch> mm, just make will work.
[23:58:24] <mm> Well, it doesn't :P
[23:59:07] <bblum> https://github.com/mozilla/rust/pull/8677 r anybody
