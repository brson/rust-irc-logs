[00:05:34] <acrichto> Gankro: ok just finished reading the unwinding part of TURPL
[00:05:42] <acrichto> it all looks good to me basically, nothing seems inaccurate
[00:05:48] <acrichto> although I didn't scrutinize the code examples too too much
[00:05:56] <acrichto> only thing I wrote down was:
[00:05:57] <acrichto> > However, anything and everything can panic
[00:05:58] <acrichto> May want to clarify to indicate that the compiler won't necessarily inject random panics, but arbitrary code (e.g. a function pointer) must be a candidate for panicking.
[00:06:30] <Gankro> Ah, good point
[00:18:07] *** Joins: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP)
[00:38:57] *** Joins: SilverKey (SilverKey@moz-liif3j.res.rr.com)
[00:43:32] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[01:29:56] *** Quits: SilverKey (SilverKey@moz-liif3j.res.rr.com) (Quit: ZZZzzz…)
[02:17:10] *** Quits: kimundi (kimundi@moz-q19o2l.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:18:14] *** Joins: kimundi (kimundi@moz-19ni9q.0bdc.4hmp.57bc.2002.IP)
[03:13:32] *** Joins: SilverKey (SilverKey@moz-liif3j.res.rr.com)
[03:52:47] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[04:24:15] *** Quits: SilverKey (SilverKey@moz-liif3j.res.rr.com) (Quit: ZZZzzz…)
[04:31:56] *** Joins: rustbot (havvy@moz-tb54ql.airspeedinternet.net)
[05:37:04] *** Quits: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP) (Connection closed)
[06:18:11] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[06:54:59] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[08:06:43] *** Joins: ChrisMorgan (ChrisMorgan@moz-tnttvc.comindico.com.au)
[08:54:42] *** Quits: ChrisMorgan (ChrisMorgan@moz-tnttvc.comindico.com.au) (Ping timeout: 121 seconds)
[09:22:40] *** Joins: ChrisMorgan (ChrisMorgan@moz-tnttvc.comindico.com.au)
[09:27:36] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[09:37:49] *** Quits: ChrisMorgan (ChrisMorgan@moz-tnttvc.comindico.com.au) (Ping timeout: 121 seconds)
[09:40:02] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Connection closed)
[09:51:36] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[09:53:48] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[11:40:29] <bluss> acrichto: I'm working on an improvement for the memset / read_to_end issue, I'll try to improve Vec::resize anyway
[13:08:41] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[14:21:23] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[14:24:59] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[14:49:28] *** Joins: SilverKey (SilverKey@moz-liif3j.res.rr.com)
[15:08:51] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[15:31:36] <acrichto> bluss: nice!
[15:55:06] <bluss> acrichto: yes it turned out nice I think. Isn't it a bit weird to have this dual mode method resize instead of two separate methods?
[15:55:47] <bluss> acrichto: Both commits are actually important, speeding up creating BufReader (used by stdin) too
[15:56:22] <acrichto> bluss: yeah there's a reason resize is still unstable :)
[15:56:40] <bluss> ok
[17:33:04] <bluss> acrichto: I don't really know how inline(always) works there, but the intention is that it should be inlined in the two locations where it's used
[17:33:28] <acrichto> bluss: yeah but it should be fine to omit, I doubt LLVM *wouldn't* inline it
[17:33:40] <acrichto> inline(always) can be a fairly serious compile-time and code size hazard
[17:33:47] <acrichto> servo has run into tons of problem with it in the past due to over-use
[17:33:57] <acrichto> generally unless you measure that it's necessary then it should be omitted
[17:36:09] <bluss> if I omit it now I have to re-measure to validate perf
[17:36:49] <acrichto> I highly doubt it will affect perf at all
[17:36:50] <bluss> acrichto: but does it matter if it's a private function that's only used twice? I mean, does the inline attribute affect vec::from_elem and Vec::resize in some way?
[17:37:01] <acrichto> bluss: a function call is nothign compared to copying a 1MB chunk of bytes
[17:37:13] <acrichto> bluss: #[inline(always)] leaks out b/c it is lined across crates
[17:37:26] <acrichto> bluss: b/c those two are inlined we then have to also inline the new method
[17:37:28] <bluss> ah but inlining is not about omitting the function call, it's for llvm to see more so that it can do the right optimizations
[17:37:58] <acrichto> bluss: only for context, not for the types involved (which are already monomorphized)
[17:37:59] <bluss> if it leaks out then it's definitely not doing what I intended
[17:38:04] <acrichto> llvm can already turn that into a memset even if it's never inlined
[17:38:36] <bluss> well ok then. I'm mostly thinking about the with_capacity() and extend_elem inside from_elem to be compiled in context with each other
[17:38:54] <acrichto> yeah the only workhorse involved here is the loop
[17:38:59] <acrichto> and that doesn't need to be inlined to optimize well
[17:39:19] <bluss> I'm never sure without trying it
[17:40:24] <bluss> acrichto: should I squash in the fixes?
[17:40:30] <acrichto> yes please!
[17:44:12] <bluss> acrichto: done
[17:47:38] *** Quits: SilverKey (SilverKey@moz-liif3j.res.rr.com) (Quit: ZZZzzz…)
[17:55:23] <bluss> acrichto: great!
[18:17:20] <kimundi> Hm, the VidyoDesktop Arch package I installed segfaults...
[18:57:43] <bluss> Gankro: http://cglab.ca/~abeinges/blah/turpl/_book/other-reprs.html#repr%28u8%29,-repr%28u16%29,-repr%28u32%29,-repr%28u64%29  this has an error
[18:57:52] <bluss> Gankro: it has an effect on non-C like enums
[18:58:18] <bluss> Gankro: I tried to doc it but it turns out repr(i64) is buggy on 32-bit platforms so this didn't land yet https://github.com/rust-lang/rust/pull/25651
[18:58:35] <Gankro> bluss: yeah that's kinda ehy I said it didn't
[18:58:40] <bluss> lol
[18:58:44] <bluss> but it does
[18:58:46] <bluss> :)
[19:00:42] <bluss> Gankro: what do you think of the concept of “unsafe-critical” code. I.e. code that unsafe blocks depend on for correctness
[19:00:51] <bluss> the whole module of Vec or LinkedList is a good example
[19:01:36] <bluss> as mentioned here: https://www.reddit.com/r/rust/comments/3cgaui/trying_to_find_why_python_is_twice_as_fast_as/cswgil1?context=1
[19:01:48] <bluss> StrSearcher uses no blocks of unsafe, it's just an unsafe trait
[19:02:14] <bluss> so everything it does is “unsafe-critical” because the output of the algorithm will be used for unchecked slicing
[19:02:37] <bluss> (implementing unsafe traits doesn't feel as dangerous as it should)
[19:03:01] <Gankro> bluss: I guess what I meant was "there is no meaningful/reasonable/well-defined affect on non-c-like enums"
[19:03:22] <bluss> ah but it is well defined, it just had a bug
[19:03:34] <Gankro> Is it well defined? Where is it documented?
[19:03:51] <bluss> in my PR, we agreed this was a correct description to add to the reference
[19:04:10] <bluss> we didn't decline the description, it just was held up by a bug
[19:04:19] <Gankro> Ah
[19:04:29] <Gankro> I interpretted the PR as "wait shit, this defn is wrong"
[19:06:34] <Gankro> re: unsafe-critical... It's a bit hard to nail down...
[19:06:44] <Gankro> In particular, basically all code is technically unsafe critical
[19:07:00] <bluss> hehe maybe it's a heatmap
[19:08:23] <bluss> is it really? Most unsafe blocks should depend on very few variables
[19:25:06] <Gankro> Any code you call into needs to be trusted, for one
[19:25:43] <Gankro> So basically you have to trust the whole stdlib to not fuck up
[19:58:27] <sfackler> aturon: vidyeo is still complaining about the license server for me
[19:59:23] <Gankro> sfackler: sounds like we're going google hangout
[19:59:27] <sfackler> cool
[20:01:21] <aturon> (we're getting ready, be there momentarily)
[20:01:34] <aturon> https://etherpad.mozilla.org/rust-libs-triage
[20:01:54] <aturon> hangout: https://plus.google.com/hangouts/_/mozilla.com/rust-libs?authuser=1&hceid=YXR1cm9uQG1vemlsbGEuY29t.569bo6bnpd5d0ipi5c0he2gceg
[20:03:16] <kimundi> Seems I need to install a plugin for thgat as well...
[20:03:54] <burntsushi> kimundi: google-talkplugin in the AUR
[20:04:06] <kimundi> AH, didn't find that one
[20:04:09] <burntsushi> aturon: that link is broken for me. my browser says it's a redirect loop o_0
[20:05:39] *** Parts: kimundi (kimundi@moz-19ni9q.0bdc.4hmp.57bc.2002.IP) ("leaving")
[20:05:44] <aturon> burntsushi: seems to be working for others...
[20:05:52] *** Joins: kimundi (kimundi@moz-19ni9q.0bdc.4hmp.57bc.2002.IP)
[20:06:04] <burntsushi> aturon: looks like it works in firefox but not chrome
[20:07:28] <aturon> kimundi: any luck?
[20:08:09] <kimundi> I'm connected, apparently
[20:08:24] <aturon> kimundi: can you hear us?
[20:08:59] <kimundi> yeah
[20:13:14] <acrichto> https://etherpad.mozilla.org/rust-libs-triage
[20:33:28] *** Joins: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com)
[20:38:46] *** Quits: rustbot (havvy@moz-tb54ql.airspeedinternet.net) (Ping timeout: 121 seconds)
[20:43:44] *** Quits: blank_name (blank_name@moz-onojo8.mi.frontiernet.net) (Ping timeout: 121 seconds)
[20:56:25] *** Joins: SilverKey (SilverKey@moz-liif3j.res.rr.com)
[21:04:05] <aturon> great meeting, thanks everybody!
[22:30:36] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:10:07] *** Joins: blank_name (blank_name@moz-i7g.dq5.36.50.IP)
[23:42:48] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
