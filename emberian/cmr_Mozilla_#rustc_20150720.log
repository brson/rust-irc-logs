[00:10:10] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:14:25] *** Quits: blank_na1e (blank_name@moz-ms6nj1.mi.frontiernet.net) (Quit: leaving)
[00:15:29] *** Joins: blank_name (blank_name@moz-ms6nj1.mi.frontiernet.net)
[02:48:37] *** Quits: kimundi (kimundi@moz-kjthpr.63qo.amhv.57bc.2002.IP) (Ping timeout: 121 seconds)
[02:53:44] *** Joins: kimundi (kimundi@moz-cd45a7.dip0.t-ipconnect.de)
[02:56:19] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[04:20:11] *** eddyb_ is now known as eddyb
[05:03:26] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[05:24:56] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[05:30:28] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[05:49:15] *** Joins: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net)
[06:06:32] *** Quits: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net) (Connection closed)
[06:08:12] *** Joins: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net)
[06:39:35] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[06:39:41] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Quit: leaving)
[06:39:43] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[06:59:46] *** Joins: doener (doener@moz-fnh.n4j.147.5.IP)
[07:31:03] *** Quits: mystor (sid79584@moz-761b3h.charlton.irccloud.com) (Ping timeout: 121 seconds)
[07:31:15] *** Quits: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com) (Ping timeout: 121 seconds)
[07:31:45] *** Quits: jroesch (sid26078@moz-o13a59.charlton.irccloud.com) (Connection closed)
[07:32:49] *** Quits: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net) (Client exited)
[07:52:57] *** Joins: jroesch (sid26078@moz-o13a59.charlton.irccloud.com)
[07:53:41] *** Joins: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com)
[07:54:22] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[08:00:39] *** Joins: mystor (sid79584@moz-761b3h.charlton.irccloud.com)
[08:54:42] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[09:00:44] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[11:36:31] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[11:50:10] *** Joins: arielby (Mibbit@moz-gdrjsj.tau.ac.il)
[12:32:51] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[12:48:30] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[13:28:48] <doener> eddyb: ping
[13:29:05] <eddyb> I'm here
[13:29:13] <eddyb> for a bit
[13:30:48] *** Joins: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com)
[13:31:04] <doener> eddyb: https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/expr.rs#L393-L400 -- why do we need the if-else there? autoref already checks for sizedness and ref_fat_ptr just creates an extra copy of the fat ptr (which is already ByRef)
[13:32:06] <eddyb> oh one of those weird things
[13:32:25] <eddyb> doener: maybe autoref didn't use to check for sizedness
[13:32:36] <doener> llvm easily gets rid of the copy, but that happens in SROA and it fails to preserve !nonnull metadata on the load
[13:32:39] <eddyb> doener: you need the copy due to ownership nonsense
[13:33:11] <eddyb> consider Box<Trait> -> &Trait
[13:34:04] <eddyb> doener: I think autoref always makes a copy, too
[13:34:21] <eddyb> oh
[13:34:31] <eddyb> doener: does ref_fat_ptr make a copy of the lvalue datum just created?
[13:34:46] <doener> eddyb: yep
[13:35:02] <eddyb> try removing that if
[13:35:31] <eddyb> trans_addr_of should be merged with autoref IMO
[13:35:36] <doener> eddyb: bootstraps just fine
[13:35:46] <doener> didn't run the testsuite yet
[13:36:24] <eddyb> I don't know which of trans_addr_of and autoref is cleaner
[13:36:35] <eddyb> they're both a bit odd due to DSTs
[13:38:10] <doener> eddyb: https://play.rust-lang.org/?gist=7a4032b9c68d5fde5cd5&version=stable
[13:38:34] <doener> eddyb: the __fat_ptr seems extraneous
[13:38:44] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[13:38:45] <doener> (and is the copy introduced by ref_fat_ptr)
[13:38:56] <eddyb> sure is
[13:39:15] <eddyb> doener: I think ref_fat_ptr used to be passed the value directly
[13:39:20] <eddyb> without a to_lvalue_datum
[13:39:32] <eddyb> but that had issues of its own
[13:39:43] <eddyb> the copy wasn't removed when to_lvalue_datum was added
[13:40:17] <eddyb> https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/expr.rs#L2237
[13:40:31] <eddyb> this makes use of auto_ref with potentially DST types
[13:40:50] <eddyb> but when that support was added to auto_ref, ref_fat_ptr wasn't removed
[13:41:06] <doener> ok, so I'll go and kill it
[13:42:50] <doener> eddyb: thanks!
[15:52:56] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[16:39:13] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:39:14] *** ChanServ sets mode: +qo brson brson
[17:36:56] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[18:57:51] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[19:18:46] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[19:48:06] *** Quits: arielby (Mibbit@moz-gdrjsj.tau.ac.il) (Quit: bye)
[20:38:52] *** Joins: arielb1 (Ariel@moz-onoegh.red.bezeqint.net)
[20:40:32] *** Joins: achanda (achanda@moz-fr1.spq.217.162.IP)
[20:51:44] *** Quits: eddyb (eddyb@moz-iut.q07.26.188.IP) (Connection closed)
[20:52:23] *** Joins: eddyb (eddyb@moz-6s1.6n6.26.188.IP)
[21:18:34] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[21:26:31] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[21:42:11] <nmatsakis> jroesch: hmm so I need to issue warnings (not errors) for failed WF obligations in some cases; I am debating between instantiating a new fulfillment context, or just putting this information into the cause
[21:42:48] <nmatsakis> (these are things that would become errors after one release cycle)
[21:42:57] <nmatsakis> I think i'll go with the cause
[21:44:06] <nmatsakis> seems maybe a bit sketchy w/r/t caching, but given that the warning is saying "your code is broke" it's probably ok
[21:50:32] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[22:04:41] <arielb1> nmatsakis: the function-body warnings?
[22:04:44] <arielb1> or misc. item warnings?
[22:06:49] <arielb1> for the item warnings we already create a new infercx
[22:06:57] <arielb1> just need to set it to uncached
[22:07:32] <arielb1> I don't think the fn-body warnings break any real code
[22:07:37] <arielb1> through we would need to check that
[22:10:03] <nmatsakis> arielb1: I know that code breaks because I tested it :)
[22:10:18] <arielb1> nmatsakis: for fn-body?
[22:10:21] <arielb1> what kind of code?
[22:10:36] <arielb1> that would be good to add to the RFC
[22:10:55] <nmatsakis> I don't really know what you mean by "fn body" but code breaks on my branch; in some cases, it's checks that we are at least trying to do, I'm not sure why the errors aren't reported now. 
[22:10:57] <arielb1> "what does this break"
[22:11:06] <jroesch> nmatsakis: sorry my wifi dropped out,  I think putting it in the cause is probably fine
[22:11:11] <arielb1> nmatsakis: there are basically 3 changes
[22:11:16] <nmatsakis> the RFC mentions that I plan to update it with this info once I have it fully gathered up
[22:11:18] <arielb1> the TyTuple/TyVec bugfix
[22:11:19] <nmatsakis> and I do :)
[22:11:32] <arielb1> the misc. item-type changes (impls, methods, etc.)
[22:12:13] <arielb1> and checking of calls in function bodies
[22:12:30] <arielb1> and other stuff in function bodies (I think calls are most important there)
[22:12:34] <jroesch> nmatsakis: also with the new transactional scheme it should be okay wrt to caching
[22:12:51] <nmatsakis> jroesch: indeed
[22:14:25] <arielb1> new transactional scheme?
[22:19:16] <jroesch> For the fulfillment context
[22:20:01] <arielb1> jroesch: right
[22:20:17] <arielb1> new?
[22:23:32] <jroesch> First should I say? The one I'm working on in parallel to a couple more research-y things
[22:25:08] *** Quits: arielb1 (Ariel@moz-onoegh.red.bezeqint.net) (Quit: Ex-Chat)
[23:59:25] *** Quits: achanda (achanda@moz-fr1.spq.217.162.IP) (Connection closed)
