[00:00:03] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[00:00:06] *** Joins: mib_fvqahu (Mibbit@moz-CBD76C21.bb.online.no)
[00:00:26] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[00:01:03] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[00:03:05] *** Quits: vq (vq@moz-65A5483F.tbcn.telia.com) (Ping timeout)
[00:03:56] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[00:04:07] *** Quits: Kauhsa (kauhsa@moz-A78B2D1A.fi) (Ping timeout)
[00:04:10] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:04:10] *** ChanServ sets mode: +ao brson brson
[00:04:15] *** Joins: vq (vq@moz-65A5483F.tbcn.telia.com)
[00:04:17] *** Quits: ion (ion@heh.fi) (Ping timeout)
[00:05:24] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[00:05:24] *** ChanServ sets mode: +ao dherman dherman
[00:05:31] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[00:05:51] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:08:04] *** Joins: ion (ion@heh.fi)
[00:09:17] *** Joins: Kauhsa (kauhsa@moz-A78B2D1A.fi)
[00:10:12] *** Quits: vq (vq@moz-65A5483F.tbcn.telia.com) (Ping timeout)
[00:11:14] *** Joins: vq (vq@moz-65A5483F.tbcn.telia.com)
[00:11:29] *** Quits: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com) (Quit: bye, bye)
[00:11:46] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[00:12:30] *** Joins: lenstr (lenstr@11335774.9636F313.7A27613B.IP)
[00:14:09] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[00:14:16] *** Quits: lenstr (lenstr@11335774.9636F313.7A27613B.IP) (Ping timeout)
[00:14:30] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[00:14:46] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[00:15:11] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[00:15:13] <kmc> actually I think Rust is potentially a great language for crypto code, better than C and asm
[00:15:38] <kmc> cause we have about as much performance control as C, with memory safety
[00:15:47] <strcat> kmc: you have to pick one
[00:15:55] <strcat> if you don't use unsafe array indexing it's going to be slow
[00:16:13] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[00:16:43] <tiffany> unless you have dependant types
[00:16:44] <kmc> but the rapid change in the compiler would worry me
[00:16:52] <strcat> I don't think rust is great at providing safety in low-level inner loops
[00:17:13] <kmc> strcat: a lot of crypto algorithms work on fixed-size buffers and/or a streaming / iterator interface
[00:17:16] <kmc> e.g. block ciphers and hashes
[00:17:23] <strcat> it's good at making those low-level primitives safe externally and having most of the program be safe
[00:17:31] <tiffany> dependant types open up optimizations like removing bounds checks
[00:17:40] <strcat> kmc: unless your indexing is all via constants you'll have bounds checks
[00:17:41] *** Joins: zslayton_ (Mibbit@moz-4806B979.nyc.res.rr.com)
[00:17:54] <strcat> if you can't do it entirely via iterators
[00:18:03] <bascule> kmc: if you're using a streaming crypto API directly you're probably doing it wrong, heh
[00:18:12] <bascule> hashes are a different story
[00:18:15] <kmc> llvm can't optimize out checks  for i in range(0,16) { ... a[i] ... } ?
[00:18:19] <kmc> bascule: hm, why's that?
[00:18:44] <bascule> kmc: authenticated encryption? o_O
[00:18:54] <kmc> that's a good point
[00:19:04] <kmc> i was thinking more about hashes, yeah
[00:19:38] *** Quits: ion (ion@heh.fi) (Ping timeout)
[00:19:58] *** Quits: Kauhsa (kauhsa@moz-A78B2D1A.fi) (Ping timeout)
[00:20:19] *** Joins: ofeldt (ofeldt@moz-52873563.dip0.t-ipconnect.de)
[00:21:03] <strcat> kmc: it won't necessarily be able to optimize that out - how does it know how long the array is?
[00:21:13] <strcat> even if it's a fixed-size array, LLVM doesn't necessarily know how long it is
[00:21:18] *** Quits: ofeldt- (ofeldt@moz-FDBE325.dip0.t-ipconnect.de) (Ping timeout)
[00:21:59] <kmc> let a: [u8, ..16]
[00:22:01] <kmc> it won't know?
[00:22:02] <strcat> kmc: http://ix.io/9jS example
[00:22:06] <strcat> it can't optimize that out
[00:22:12] <strcat> kmc: if it's a local variable it can optimize it out
[00:22:15] <kmc> too bad :<
[00:22:16] <strcat> it probably won't be though
[00:22:28] <olsonjeffery> can tuples be used as generic params?
[00:22:35] <kmc> yep
[00:22:38] <strcat> LLVM does a lot less than people seem to expect it to ;p
[00:22:39] *** Joins: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net)
[00:23:13] <tiffany> it does a lot more microopts than people expect it to, and less type-system-based opts than people expect it to
[00:23:24] <strcat> it doesn't have a type system
[00:23:25] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[00:23:35] <strcat> LLVM types are just for layout
[00:23:59] <tiffany> yeah, that's what I meant
[00:24:25] *** Quits: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[00:24:27] <kmc> i see
[00:24:32] <strcat> kmc: actually in this case we generate a load
[00:24:36] <strcat> so it can optimize out
[00:24:41] <tiffany> it doesn't remove bounds checks because it doesn't know when it can because the type information doesn't make its way down
[00:24:44] <strcat> because we're asserting that it's that size
[00:24:55] <strcat> but there are many cases when it won't
[00:26:06] <dbaupp> can we give LLVM more info to work with?
[00:26:11] <strcat> sure
[00:26:15] <strcat> we could write an LLVM pass
[00:26:22] <strcat> and use metadata to communicate arbitrary information to it
[00:26:41] <strcat> kmc: http://ix.io/9jU this sample is on the bug tracker, but it's not really a bug per se
[00:26:56] <strcat> has to output a bounds check
[00:27:21] *** Joins: lfox (lfox@moz-8C19C973.nyc.res.rr.com)
[00:27:29] <dbaupp> strcat: I mean specifically to the already extant passes, e.g. making the example you gave above behave as if it were a local.
[00:28:00] <strcat> dbaupp: by injecting different redundancies you can give it more information
[00:28:06] <strcat> but it may not be able to optimize those out
[00:28:21] <strcat> if you have to copy a large array, it may not then be able to optimize that out
[00:32:21] *** Quits: skade (skade@moz-7A703D87.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:33:19] *** Joins: ctult (Mibbit@moz-ADEF9FB8.bois.qwest.net)
[00:33:32] <ctult> I can't seem to get SDL to work on Windows
[00:33:32] *** Joins: skade (skade@moz-7A703D87.pools.arcor-ip.net)
[00:34:13] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[00:34:17] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[00:34:22] <ctult> I tried typing "rustpkg install sdl", but that gave an error, then I downloaded it and tried running "rustpkg build sdl", but that didn't work either.
[00:34:39] *** Joins: ion (ion@heh.fi)
[00:35:06] *** Joins: Kauhsa (kauhsa@moz-A78B2D1A.fi)
[00:35:13] *** Quits: skade (skade@moz-7A703D87.pools.arcor-ip.net) (Ping timeout)
[00:35:46] <dwrensha> ctult: perhaps try asking on #rust-gamedev
[00:36:02] <ctult> ok, thank you
[00:38:25] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[00:39:57] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[00:40:20] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:40:30] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[00:41:46] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[00:42:02] <olsonjeffery> is there a tut out there on storing borrowed pointers in structs?
[00:42:11] *** Quits: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch) (Input/output error)
[00:42:32] <kmc> not that i've seen... you'll need to put a lifetime parameter on your struct
[00:42:45] <kmc> struct Foo<'t> { bar: &'t int }
[00:44:08] <olsonjeffery> yeah.. ive got that..
[00:44:14] <olsonjeffery> how do you instantiate?
[00:44:21] <olsonjeffery> im putting together a gist w/ my current code and compiler spre
[00:44:23] <olsonjeffery> spew
[00:44:56] <kmc> Foo { bar: &n }
[00:45:06] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[00:45:34] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Hibernating, be back soon.)
[00:45:47] <sbalmos> kmc: Are there any tutorial sections or docs, ML posts, or anything on guidelines when/where lifetimes are needed?
[00:45:48] <olsonjeffery> https://gist.github.com/olsonjeffery/7883899
[00:46:27] <olsonjeffery> so there im using a ctor pattern
[00:46:42] <olsonjeffery> i want if i could get it to pass with raw destruction in the scope id normally call the ctor?
[00:46:47] <olsonjeffery> raw construction, even
[00:46:50] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[00:47:01] <dwrensha> try putting "-> ZoneView<'a>" in the signature of the function
[00:47:03] <achin> shouldn't new return a ZoneView<'a> ?
[00:47:43] <kmc> sbalmos: http://static.rust-lang.org/doc/master/tutorial-borrowed-ptr.html#returning-borrowed-pointers
[00:47:57] <olsonjeffery> nice! thanks
[00:48:01] *** Joins: fournm (Aria@moz-ABB60BA0.austin.res.rr.com)
[00:48:11] <achin> that is a weird error message, though:  expected `hf::ux::ZoneView<>` but found `hf::ux::ZoneView<>`
[00:48:13] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[00:48:30] <strcat> sbalmos: whenever you're using borrowed pointers, you're using lifetimes
[00:48:38] <strcat> every borrowed pointer has a lifetime
[00:48:44] <strcat> it's just not always explicitly named
[00:48:50] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:48:51] <sbalmos> right, most times it's implied
[00:48:56] <olsonjeffery> achin: so i had already added annotation in a few places
[00:49:04] <olsonjeffery> that was the one that i missed (and it hadn't occured to me, either!)
[00:49:17] *** Joins: MrOrdinaire (Mibbit@FBE4BDD6.9B93F280.FD383126.IP)
[00:49:24] <olsonjeffery> in any event. hoooray.
[00:50:07] <achin> i find named lifetimes not terribly intuitive
[00:50:30] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[00:51:06] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Ping timeout)
[00:51:16] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[00:51:33] <strcat> achin: it's the same concepts as unnamed ones
[00:52:11] <achin> yes, but with unnamed lifetimes, i don't often consciencely think of or about them
[00:52:34] <strcat> so you just run into errors you don't understand - I don't think that's good
[00:52:38] <olsonjeffery> a heavy cognitive burden for cheap references that are guaranteed to not be null
[00:52:45] <achin> strcat: one of them might have been a bug
[00:52:52] <olsonjeffery> such is our lot
[00:52:55] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:53:04] <olsonjeffery> i spent a few hours on what turned out to be an NRE last week.
[00:53:06] <olsonjeffery> so, yeah.
[00:53:13] <strcat> olsonjeffery: it doesn't have to do with them being null or not
[00:53:14] <kmc> "guaranteed not to be null" is not the interesting part
[00:53:21] <achin> (i mean, one case where i ran into an error that i didn't understand might have been a bug.  i don't know, but i can share it if you care to look)
[00:53:38] <dbaupp> fwiw, I've found that once lifetimes "click" they're pretty intuitive. (of course, me saying this doesn't help make them click...)
[00:53:41] <strcat> whether or not they're nullable is unrelated to lifetimes
[00:53:56] <strcat> if you understand how to write C or C++, you understand rust lifetimes (other than learning the syntax)
[00:54:22] <kmc> the interesting thing about references is that they're guaranteed to point to a valid object and not to something which was already freed
[00:54:27] <olsonjeffery> i know better than to disagree with you.
[00:54:27] <ezyang> Doesn't mean you'll understand the borrow checker tough :) 
[00:54:33] <kmc> and also they're guaranteed not to change out from under you
[00:54:41] <kmc> if you hold a reference then nobody else holds a mutable reference
[00:54:47] <kmc> so they solve use-after-free and iterator invalidation
[00:54:47] <strcat> ezyang: I expect anyone who is a C or C++ programmer will have no problem with understanding the borrow checking rules
[00:54:56] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[00:55:01] <strcat> they may find the restrictions frustrating
[00:55:07] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:55:27] <strcat> but they are not complicated, and it's not hard to understand why they exist if you know how to write correct C (or C++)
[00:55:30] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[00:55:36] <aatch> The interesting thing is that C++, at least, already has most (if not all) of the information Rust uses for lifetime checking. It's just not exposed.
[00:55:54] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[00:55:56] <aatch> It's how compilers can warn about returning a pointer to a stack variable.
[00:56:18] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Hibernating, be back soon.)
[00:56:21] <dbaupp> aatch: the mutability borrow-checking probably doesn't fit into a C++ context?
[00:56:22] <olsonjeffery> strcat: ah! the ol' No True C Dev fallacy!
[00:56:27] <achin> (here is a borrowing example that i was never able to figure out : https://gist.github.com/eminence/9797683ba549e1a45fcd )
[00:56:30] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:56:30] *** ChanServ sets mode: +ao brson brson
[00:56:32] <strcat> olsonjeffery: no, not anything to do with "true" C developers
[00:56:39] <strcat> if you can write C, you understand lifetimes and ownership
[00:56:52] <aatch> dbaupp, it does not, true, hence why I said lifetime checking, not borrow checking.
[00:57:02] <aatch> (though I admit they are close concepts)
[00:57:03] <olsonjeffery> simultaneously, admitting you don't understand lifetimes and ownership means you can't write C?
[00:57:08] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[00:57:11] <olsonjeffery> beucase i can certainly write C, yet here i am.
[00:57:13] <olsonjeffery> asking questions.
[00:57:17] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[00:57:21] <ezyang> strcat: I guess that's probably true. 
[00:57:23] <strcat> asking questions doesn't mean you don't understand the concepts
[00:57:25] <o11c> achin: isn't 'self special?
[00:57:34] <aatch> o11c, nope
[00:57:39] <strcat> it means you don't fully understand rust's implementation of them, which is not documented, so I don't expect anyone understands it other than nmatsakis 
[00:57:47] <strcat> (other than long source code comments)
[00:58:24] *** Quits: nkoep (nik@moz-C40D4157.pool.mediaways.net) (Client exited)
[00:58:31] <o11c> achin: also, are you sure you really want to *allocate* the MyFoo from new ?
[00:58:32] <strcat> a C function like this
[00:58:35] <achin> i saw some examples where 'self seemed to the the convension for naming a lifetime for a struct.  dunno if that's still considered rustomatic
[00:58:36] <strcat> const *char foo() {}
[00:58:46] <strcat> you need to understand lifetimes/ownership to use that
[00:58:49] <aatch> achin, it *used* to be required.
[00:58:51] <achin> o11c: i'm not sure that matters in my example
[00:59:00] <strcat> since it's const, it *probably* doesn't hand you ownership of anything
[00:59:17] <strcat> there is likely an associated lifetime that's not static
[00:59:32] <strcat> with strerror, the lifetime is until the next strerror call
[00:59:45] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[00:59:46] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[00:59:55] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[00:59:56] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[01:00:15] <achin> indeed, i am certain every c/c++ programmer has said to themselfs at least once "i wonder if this pointer has been freed yet"
[01:00:19] <strcat> const char *foo, rather
[01:00:39] <strcat> when you pass a pointer to a C API, you need to know what it expects
[01:00:46] <aatch> strcat, I'm glad I'm not the only one that does that.
[01:00:48] <strcat> you need to know how long it expects the pointer to live
[01:00:52] <strcat> or whether it takes ownership of it
[01:01:08] <aatch> Which has to be documented in comments.
[01:01:09] <strcat> glib APIs annotate this with 'transfer-full' in the documentation if it transfers ownership
[01:01:27] <strcat> it's really hard to write gtk/glib code correctly due to the manual refcounting though
[01:01:32] <aatch> And can't be easily enforced (in C at least).
[01:01:52] <aatch> C++11 allows you to make move-only objects though.
[01:01:56] <aatch> Which is nice.
[01:02:09] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[01:02:11] <strcat> aatch: it also only move ctors to throw, and types to be unmoveable
[01:02:13] <strcat> ;p
[01:02:34] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[01:02:42] <aatch> strcat, I do not understand that sentence.
[01:02:47] <o11c> I miss not being able to specify a move ctor in rust
[01:02:56] <strcat> aatch: a move constructor can throw an exception
[01:03:03] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[01:03:06] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[01:03:18] <strcat> so consider a vector wanting to resize itself when it's full
[01:03:28] <strcat> if it uses moves, it can't do a transactional resize
[01:03:29] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[01:03:34] <strcat> since it can't keep around an old copy
[01:03:35] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[01:03:41] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:03:46] <strcat> and if the move constructor throws... it's all screwed
[01:03:55] <strcat> so C++11 had to add programmable noexcept annotations
[01:04:03] <achin> o11c: so things seemed to look OK in my example (at least with regard to the lifetimes) ?
[01:04:07] <aatch> strcat, oh yeah. I remember watching a talk from GoingNative about that.
[01:04:11] <strcat> noexcept(some_expression_evaluating_to_bool)
[01:04:19] <strcat> and you can use metaprogramming to branch on noexcept
[01:04:41] <strcat> and not every type has to have a move constructor at all
[01:04:53] <strcat> you can have types you can't move *or* copy
[01:05:13] <strcat> a type can have a dependency on the address it's placed at
[01:05:14] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[01:05:14] *** Quits: ion (ion@heh.fi) (Ping timeout)
[01:05:25] <aatch> How collections that had a strong exception safety guarantee can't actually guarantee it with move construction.
[01:05:29] *** Quits: Kauhsa (kauhsa@moz-A78B2D1A.fi) (Ping timeout)
[01:05:40] <strcat> exception safety is a huge PITA
[01:05:53] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[01:05:53] <o11c> I miss not being able to specify nomove also ...
[01:06:00] <strcat> it's why C++ containers separate pop from front
[01:06:08] <strcat> on stuff like queues
[01:06:23] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:06:24] <strcat> moving or copying the object out of the queue could throw
[01:06:27] <strcat> and now the queue is broken
[01:06:57] <strcat> now, lets say you want to write a *thread-safe* queue
[01:07:04] <strcat> pop and is_empty have to be one operation
[01:07:04] <aatch> Hence `noexcept`
[01:07:18] <strcat> so either it only works for noexcept types (via enable_if, I guess)
[01:07:22] <strcat> or static_assert
[01:07:26] <strcat> hm
[01:07:32] <strcat> anyway
[01:07:42] <strcat> you could also have them allocate an object in advance and assign to it
[01:07:48] <strcat> but that's not going to work with RAII
[01:07:59] <strcat> and assigning can throw!
[01:08:07] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[01:08:21] * strcat hates unwinding
[01:08:30] <aatch> strcat, oh yeah, "a = b" can potentionally throw!
[01:08:38] <strcat> aatch: it likely does throw
[01:08:49] <strcat> a = std::move(b); *probably* can't throw for most types
[01:08:53] <strcat> but it could
[01:08:55] <strcat> ;p
[01:09:01] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[01:09:07] <strcat> aatch: so, I think what C++ vectors do is...
[01:09:12] <strcat> in C++03, allocate a whole new vector
[01:09:15] <strcat> copy construct all elements
[01:09:22] <strcat> then get rid of the old one
[01:09:31] <strcat> in C++11, the same thing - except instead of copying, it can use move_if_noexcept
[01:09:56] <strcat> http://en.cppreference.com/w/cpp/utility/move_if_noexcept which... is predefined for convenience
[01:10:13] <aatch> strcat, yep. Thats what I remember from the talk.
[01:10:23] <aatch> (I think it was Scott Meyer)
[01:10:52] <strcat> garbage collection and unwinding in rust have a lot of gotchas too
[01:10:59] <strcat> I am happier without either
[01:11:09] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:11:13] <strcat> garbage collection + destructors without a finally statement, doesn't seem like a great thing
[01:11:42] <strcat> but please, lets not have finally, and lets not have types that have to deal with the possibility of being destroyed but still having refs to them
[01:11:49] <strcat> that's what GC pushes you towards though
[01:11:57] <strcat> and then every method gains a failure case
[01:12:02] <strcat> more unwinding fun!
[01:12:24] <aatch> strcat, yeah, I'm not a fan of unwinding either.
[01:13:23] <aatch> I know that LLVM avoids exceptions (and RTTI) for performance reasons.
[01:13:42] <strcat> LLVM aborts on logic errors, out-of-resource errors, etc. though
[01:13:56] <strcat> it only actually tries to handle recoverable runtime errors
[01:14:16] <o11c> abort on error is sensible except when running unit tests
[01:14:19] <strcat> using anything but unwinding to handle pretty much unrecoverable error cases makes the APIs too painful
[01:14:54] <strcat> o11c: it works if you run unit tests in processes, which is nice for isolation and bad for quickly running them ;p
[01:15:10] *** Quits: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru) (Ping timeout)
[01:15:23] <strcat> although forking each unit test wouldn't be that slow
[01:15:30] <strcat> on windows you couldn't make that fast
[01:15:35] <o11c> actually ... if you only start a new process when one unit test *fails* ...
[01:15:52] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[01:15:53] *** Joins: ion (ion@heh.fi)
[01:16:06] <strcat> o11c: yeah it could do something like spawn 100 tests per process and then if it aborts, narrow down which test in that process failed
[01:16:29] * strcat shrugs
[01:16:31] <o11c> you can find which test failed by checking output or something
[01:16:32] *** Joins: Kauhsa (kauhsa@moz-A78B2D1A.fi)
[01:16:36] *** Joins: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru)
[01:16:37] <o11c> or using pipes to control it
[01:17:13] *** Quits: fournm (Aria@moz-ABB60BA0.austin.res.rr.com) (Ping timeout)
[01:17:13] <aatch> It wouldn't be the easiest thing to implement, but it would work without being horribly slow.
[01:17:17] <o11c> the individual processes are still start through the test harness
[01:19:02] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[01:19:16] <aatch> o11c, I assumed that it would be a master process, which spawns a child process, if that process aborts abnormally, find where it got to and start a new process starting from there.
[01:19:24] <aatch> Repeat until all tests are run.
[01:19:53] <o11c> yeah ... and assuming you explicitly feed the child, you can even put parallelization in there
[01:20:33] <aatch> o11c, so you use spawned processes like a poor-mans thread pool?
[01:20:35] <strcat> o11c: on the other hand I really don't mind manually segregating tests into modules
[01:20:42] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[01:20:48] <strcat> o11c: and I don't mind running the test module in gdb to catch the abort and get a stack trace
[01:21:23] <strcat> convenient to do it that way since you can see all the variable values
[01:21:29] <strcat> often obvious why it failed
[01:22:31] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[01:22:41] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[01:22:49] <achin> sometimes it's easier to get a stack trace on failure (in case you forget to run your tests via gdb)
[01:23:02] *** Quits: mib_fvqahu (Mibbit@moz-CBD76C21.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[01:23:04] <strcat> rust won't print a stack trace on failure, though
[01:23:22] <achin> i know :(
[01:23:40] *** Joins: gamakichi (Mibbit@EF9F3DF6.22D11F2B.CA867444.IP)
[01:24:10] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[01:24:30] <pnkfelix> achin: by the way, that code snippet you wrote reminded me for this: https://github.com/mozilla/rust/issues/10766
[01:26:11] * achin hits the subscribe button
[01:26:17] <pnkfelix> achin: (your example was a more complicated construction, and I suspect it ran into a different issue in the borrow checking.)
[01:26:47] <pnkfelix> achin: but I want to double-check.  I will probably add your example to that ticket.
[01:26:59] <achin> please go ahead.  thanks for looking!
[01:30:30] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[01:32:19] *** Joins: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu)
[01:35:24] <ctult> What is the difference between 'static' and 'let'?  Does 'static' just disallow you from shadowing?
[01:35:43] *** Joins: foobar (foobar@moz-4C1E443F.clients.kiwiirc.com)
[01:35:55] <foobar> Hi
[01:36:09] <foobar> How can I convert ~"name" into a vector of chars ?
[01:36:36] <strcat> foobar: there is a char iterator for slices
[01:36:45] <o11c> foobar: destructively or copy?
[01:36:50] <strcat> ctult: let defines a local variable on that function call's stack frame
[01:37:12] *** Joins: derek_c (derek@moz-A43430DA.cit.cornell.edu)
[01:37:14] <strcat> static defines a statically initialized one not on the call stack
[01:37:26] <ctult> oh
[01:37:27] <foobar> @strcat So I can do: `for char in ~"name" {} ` correct ?
[01:37:45] <strcat> rusti: for c in "foo".iter() { println!("{}", c) }
[01:37:46] -rusti- f
[01:37:46] -rusti- o
[01:37:46] -rusti- o
[01:37:46] -rusti- ()
[01:38:04] <strcat> rusti: for c in "foo".byte_iter() { println!("{}", c) }
[01:38:05] -rusti- 102
[01:38:05] -rusti- 111
[01:38:05] -rusti- 111
[01:38:05] -rusti- ()
[01:38:06] <foobar> w00t
[01:38:10] <strcat> (these are renamed in master though)
[01:38:27] <derek_c> let k = ~"sup"; for c in k.iter() {println!("{}", c)}
[01:38:32] <derek_c> rusti: let k = ~"sup"; for c in k.iter() {println!("{}", c)}
[01:38:32] <foobar> I was using: for char in "foo".bytes()
[01:38:32] -rusti- s
[01:38:33] -rusti- u
[01:38:33] -rusti- p
[01:38:33] -rusti- ()
[01:38:49] <strcat> foobar: well in master they're chars and bytes
[01:38:49] <foobar> Wonderful
[01:38:57] <foobar> yep, I'm using master
[01:39:00] <strcat> rusti is out of date
[01:39:10] <strcat> because it runs in a sandbox and rust's I/O is buggy
[01:39:16] <strcat> doesn't work properly via a pipe
[01:39:21] *** Parts: rfw (rfw@moz-7D453A5B.rfw.name) (WeeChat 0.4.1)
[01:39:24] <foobar> So, I need to copy that over to a vector.
[01:39:32] <strcat> foobar: you can use collect
[01:39:34] <foobar> Would you hear my thinking process ?
[01:39:41] <strcat> sure
[01:39:46] <foobar> I want to learn how to figure stuff out.
[01:39:47] <foobar> So
[01:40:05] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[01:40:07] <foobar> I need to allocate a std::vec with the size of the length of "foo"
[01:40:16] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:40:32] <foobar> It needs to be mutable so that I can insert chars every iteration
[01:40:38] <strcat> foobar: you don't know the length in chars until you've iterated through it
[01:40:46] <strcat> ~[T] is a dynamically sized array
[01:40:48] <strcat> you can push to it
[01:41:00] *** Quits: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP) (Client exited)
[01:41:13] <strcat> collect will do it for you
[01:41:29] <strcat> http://static.rust-lang.org/doc/master/std/iter/trait.Iterator.html
[01:41:30] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[01:41:33] <MrOrdinaire> foobar: you can also reserve space for a vec with std::vec::with_capacity
[01:41:35] <foobar> collect will iterate a generate a new vector with each char?
[01:41:51] <strcat> foobar: no
[01:41:56] <foobar> I was coding down to what @MrOrdinairde said
[01:42:00] <strcat> foobar: ~[T] is a dynamically sized array - it can be pushed to
[01:42:20] <strcat> capacity is just reserved space, you can continue pushing after the initial capacity is passed, it just doubles it every time it gets full
[01:42:34] <foobar> oh
[01:42:36] <strcat> it's a high-level container type
[01:42:38] <MrOrdinaire> strcat: it saves moving the values over, though ;)
[01:42:50] <strcat> you don't know the capacity, though
[01:42:53] <strcat> you know an upper bound
[01:42:55] <strcat> not the exact capacity
[01:43:04] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[01:43:10] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[01:43:14] <strcat> the # of bytes in the string is the maximum number of chars, but it could have 1/4 of that number
[01:43:17] <cmr> Should the FromIterator for vec shrink_to_fit afterwards?
[01:43:24] <MrOrdinaire> strcat: I see
[01:43:30] <strcat> cmr: it should be conservative
[01:43:31] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:43:42] <strcat> the upper bound can be huge
[01:43:56] <strcat> it should only pre-allocate the lower bound if there is one
[01:44:17] <strcat> now what you do in your own code might be different
[01:44:25] <strcat> but the generic API can't just allocate the upper bound in space
[01:44:41] <strcat> anyway it won't really matter
[01:45:15] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[01:45:43] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[01:46:12] *** Quits: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru) (Ping timeout)
[01:46:39] *** Joins: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru)
[01:46:47] *** Quits: lfox (lfox@moz-8C19C973.nyc.res.rr.com) (Quit: ZZZzzz…)
[01:46:58] <strcat> if you want to push 100000 elements to an array starting at 2 capacity you will need at most 17 reallocations
[01:47:11] <strcat> but it uses realloc so some of those reallocations may be elided by the allocator
[01:47:26] *** Quits: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu) (Ping timeout)
[01:47:37] * o11c wishes for an allocator that exposed more information
[01:47:43] *** Joins: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu)
[01:47:47] <o11c> like "realloc but only if it's in-place"
[01:47:48] <foobar> @strcat you rock man
[01:47:50] <strcat> o11c: jemalloc does
[01:47:50] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[01:47:53] <foobar> It worked
[01:48:21] <strcat> o11c: rust values can always be moved so realloc works either way, though
[01:48:46] <strcat> o11c: the jemalloc API is...
[01:48:53] <strcat> int rallocm(void **ptr, size_t *rsize, size_t size, size_t extra, int flags);
[01:49:27] <strcat> you pass a ptr and it changes it to a ptr to an allocation of the new size
[01:49:33] <strcat> writes the real size of the new alloc to rsize
[01:49:42] <strcat> allocates 'extra' extra bytes *if possible*
[01:49:47] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[01:50:08] *** Quits: houzi (houzi@moz-4F6A1E26.getinternet.no) (Ping timeout)
[01:50:08] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[01:50:09] <strcat> and to flags, you can pass an alignment, you can ask it to zero the new memory, and you can ask it to fail if it can't do it in-place
[01:50:11] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Connection reset by peer)
[01:50:14] <strcat> + you can use specific arenas
[01:50:14] <o11c> ooh, pretty
[01:50:15] <foobar> dude, Rustaceans are super cool.
[01:50:26] *** Quits: derek_c (derek@moz-A43430DA.cit.cornell.edu) (Quit: Leaving)
[01:50:33] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[01:50:34] *** Joins: derek_c (derek@moz-A43430DA.cit.cornell.edu)
[01:50:36] <cmr> o11c: not using the lowest common denominator allocator API yields quite a few benefits :)
[01:50:41] <achin> there is no question for which #rust does not have an answer
[01:50:41] <strcat> o11c: jemalloc is pretty cool... what sucks is that it manages the pools with rbtrees and it's not fast
[01:50:53] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Connection reset by peer)
[01:50:59] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[01:51:02] <derek_c> how do I find documentation about ~str?  Typing ~str into the search bar doesn't return anything
[01:51:04] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:51:16] <cmr> derek_c: ~str is a built-in type, due to a bug there is no documentation generated for it.
[01:51:24] <o11c> achin: P = NP?
[01:51:24] <cmr> derek_c: you can look at the traits in std::str though.
[01:51:26] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:51:26] <strcat> o11c: really good at handling fragmentation... really good at handling threads, etc.
[01:51:35] <strcat> fast at allocating small objects (size classes!)
[01:51:38] <strcat> nice API
[01:51:48] <strcat> if only it used an O(1) data structure for the pools ;p
[01:51:50] <o11c> everybody does size classes I thought ...
[01:51:52] <derek_c> cmr: hmm that's pretty inconvenient considering people use built-in types a lot
[01:51:57] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[01:52:00] <achin> o11c: "not yet"  :P
[01:52:17] <o11c> strcat: why does an allocator need anything more than a linked list?
[01:52:40] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:53:02] <strcat> o11c: performance
[01:53:09] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:53:10] <strcat> o11c: if you only use a free list, free is O(n)
[01:53:22] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[01:53:23] <strcat> o11c: anyway the rbtree isn't for managing free spots in pools
[01:53:26] <strcat> it's for finding the right pool
[01:53:31] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:53:48] <achin> will placement new be the mechanism by which rust code can use a custom allocator?
[01:53:49] <strcat> jemalloc manages a bunch of 4MiB slabs for small (<=4MiB) allocations
[01:53:50] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:53:59] <cmr> achin: yes
[01:54:04] <strcat> well not really
[01:54:12] <strcat> placement new as proposed works at smart pointer level
[01:54:22] <strcat> allocators are low-level than smart pointer implementations
[01:54:31] <cmr> well
[01:54:37] <o11c> strcat: er, isn't that just an array lookup?
[01:54:44] <cmr> yeah, won't be able to change what everything else uses.
[01:54:46] <strcat> o11c: no
[01:54:57] <achin> hmm
[01:55:21] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:55:21] *** ChanServ sets mode: +ao brson brson
[01:55:29] <ctult> I read through the official Rust tutorial, and found nothing about types.  Could someone explain how they work, and/or how they are different from OCaml/F#?
[01:55:30] <strcat> o11c: malloc and free can be O(1) on average and one has to be O(log n) worst-case in a really smart allocator
[01:55:39] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[01:55:46] <achin> so if i wanted my ~FooStruct to be created in space alloc'd by my own allocator, i can do that, but if i wanted to do the same for a ~str i'm out of luck?
[01:55:49] <strcat> ctult: what about types specifically?
[01:56:24] <ctult> strcat: The syntax
[01:56:27] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[01:56:28] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[01:56:31] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[01:56:31] *** ChanServ sets mode: +o tjc
[01:56:36] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[01:56:43] <strcat> ctult: well, I don't really know what you mean :)
[01:56:57] <strcat> user-defined types are structs or enums
[01:57:10] <ctult> oh
[01:57:17] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[01:57:22] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[01:57:42] <ctult> strcat: How would I make a generic number type that could support both int and float?
[01:58:02] <strcat> enum Number { Int(int), Float(f64) }
[01:58:09] <o11c> ctult: enum and then LOTS of impl'ing
[01:58:11] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[01:58:14] <strcat> ctult: did you look at the tutorial for master?
[01:58:17] <strcat> it's a lot better now
[01:58:30] <ctult> Yes, but I did not quite understand it, I guess
[01:58:43] <strcat> http://static.rust-lang.org/doc/master/tutorial.html#implementing-a-linked-list specifically that
[01:58:54] *** Quits: SingingBoyo (SingingBoy@F8739140.B0AB8E61.7A95930C.IP) (Ping timeout)
[01:59:00] <ctult> Because in OCaml, doing this would just be type Number = int | float
[01:59:13] <achin> the Shape/Circle example is a pretty good one, i think
[01:59:14] <tautologico> type Number = Int of int | Float of float
[01:59:25] <ctult> Yes, thank you
[01:59:28] <ctult> I am tired right now :O
[01:59:41] <strcat> isn't that just the same as enum Number { Int(int), Float(f64) } ?
[01:59:44] <tautologico> yes
[01:59:47] <tautologico> same thing
[01:59:50] <ctult> I think?
[01:59:55] <tautologico> pattern matching and everything
[02:00:00] *** Joins: yichoi_ (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[02:00:23] <derek_c> is there any rust syntax that can supersede a long if-else-if chain?
[02:00:31] <strcat> match
[02:00:48] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[02:00:54] <derek_c> strcat: but I'm not matching an element; just testing a list of conditions
[02:02:08] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[02:02:08] <MrOrdinaire> derek_c: could you give an example?
[02:02:16] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Quit: mcpherrin)
[02:02:32] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[02:02:43] <achin> i assume the conditions aren't really related
[02:02:54] <derek_c> MrOrdinaire: I mean like, if a > b {} else if c > d {} else if e > f {} ....
[02:03:21] <derek_c> I tried match true {condition => {}, condition => {}}
[02:03:22] <derek_c> doen
[02:03:25] <derek_c> doesn't work though
[02:03:44] *** Quits: foobar (foobar@moz-4C1E443F.clients.kiwiirc.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[02:03:56] *** Quits: yichoi_ (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[02:04:22] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[02:04:51] <o11c> you can do match if ... but I don't see the benefit really
[02:05:22] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Quit: leaving)
[02:05:47] <strcat> if you have a list of unrelated conditions to check, that's what if-else is for
[02:06:11] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[02:06:22] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:06:22] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[02:06:42] <achin> pnkfelix: thanks again for taking a closer look at my issue
[02:06:45] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Quit: Changing server)
[02:07:00] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[02:07:16] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[02:07:17] *** ChanServ sets mode: +ao pcwalton pcwalton
[02:07:21] <ctult> Would this be the implementation of the Option monad: enum Option<T> { Some(T), None } ?
[02:07:36] <pnkfelix> achin: no problem, it helps me to have concrete examples like this to force me to understand the borrow checker better
[02:07:38] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[02:07:41] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[02:07:50] <pcwalton> ctult: that exists in the standard library
[02:08:02] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:08:11] <ctult> pcwalton: Yes, I know, but would that be the proper implementaion?
[02:08:14] <strcat> yes
[02:08:15] <pcwalton> yes
[02:08:17] <ctult> ok
[02:08:30] <strcat> rusti: enum Maybe<T> { Just(T), Nothing } Just(5)
[02:08:31] -rusti- Just(5)
[02:08:36] <strcat> rusti: enum Maybe<T> { Just(T), Nothing } Just("foo")
[02:08:36] <pnkfelix> ctult: modulo the impl for the other operations, right ?
[02:08:36] -rusti- Just("foo")
[02:08:44] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[02:08:46] <pnkfelix> ctult: gotta prove those laws!
[02:09:06] <achin> i find that reading the source to some of the simple stdlib types is really useful
[02:09:12] <ctult> pnkfelix: ;)  Too lazy
[02:09:24] <ctult> strcat: That Number type you supplied earlier, how would you implement it?
[02:09:34] <strcat> hm?
[02:09:44] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[02:09:47] <ctult> strcat: enum Number { Int(int), Float(f64) };
[02:09:51] <tautologico> what do you want to implement on it? 
[02:09:56] <tautologico> the type is just that
[02:10:12] <ctult> Implement was the wrong word
[02:10:12] <tautologico> you could implement addition, multiplication and other ops for instance
[02:10:12] <cmr> ctult: that's exactly what is in libstd, too :)
[02:10:13] *** Quits: derek_c (derek@moz-A43430DA.cit.cornell.edu) (Ping timeout)
[02:10:21] *** Quits: gamakichi (Mibbit@EF9F3DF6.22D11F2B.CA867444.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:10:32] *** Quits: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu) (Ping timeout)
[02:11:00] <ctult> How would you create a value of the number type?
[02:11:10] <tautologico> Int(5)
[02:11:11] <cmr> Int(foo) or Float(foo)
[02:11:14] <tautologico> Float(3.2)
[02:11:17] <strcat> rusti: enum Number { Int(i64), Float(f64) } Int(5)
[02:11:18] -rusti- Int(5i64)
[02:11:25] <cmr> The variant names become constructors, functions of that type returning Number
[02:11:37] <strcat> rusti: enum Value { Int(i64), Float(f64), Array(~[Value]) } Array(~[Int(5), Float(5.5)])
[02:11:37] -rusti- Array(~[Int(5i64), Float(5.5f64)])
[02:11:57] <strcat> rusti: enum Value { Int(i64), Float(f64), Array(~[Value]) } Array(~[Int(5), Float(5.5), Array(~[Int(5)]))])
[02:11:58] -rusti- <anon>:9:105: 9:106 error: incorrect close delimiter: `)`
[02:11:58] -rusti- <anon>:9         enum Value { Int(i64), Float(f64), Array(~[Value]) } Array(~[Int(5), Float(5.5), Array(~[Int(5)]))])
[02:11:58] -rusti-                                                                                                                   ^
[02:11:58] -rusti- application terminated with error code 101
[02:12:09] <strcat> rusti: enum Value { Int(i64), Float(f64), Array(~[Value]) } Array(~[Int(5), Float(5.5), Array(~[Int(5)])])
[02:12:10] -rusti- Array(~[Int(5i64), Float(5.5f64), Array(~[Int(5i64)])])
[02:12:10] <hoverbear> rusti is awesome.
[02:12:21] <achin> rustbot 
[02:12:49] <SiegeLord> Incidentally... why isn't rusti the bot shipped with rust?
[02:13:01] <SiegeLord> Not a true REPL, but maybe better than nothing?
[02:13:02] <hoverbear> I thought it was?
[02:13:03] <cmr> SiegeLord: https://github.com/thestinger/rust-playpen/blob/master/bin/irc.sh
[02:13:05] <cmr> have a blast.
[02:13:06] <strcat> rusti the bot is 99% a sandboxing implementation
[02:13:11] <achin> also, si rustbot written in rust?
[02:13:19] <SiegeLord> I'm not saying it's not a 10 line bash script
[02:13:20] <cmr> achin: see above link
[02:13:22] <aatch> SiegeLord, it's not even a REPL, just a REP
[02:13:25] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[02:13:26] <cmr> heh
[02:13:28] <SiegeLord> But it's a 10 line bashcript that could be shipped with Rust
[02:13:33] <strcat> it's a sandboxing implementation written in C, a few lines of bash and a bit of python
[02:13:47] <achin> what about the irc implementation?
[02:13:51] <strcat> a python lib
[02:14:10] <achin> clearly rust needs an irc library
[02:14:12] <aatch> There is somebody implementing an IRC library in Rust though.
[02:14:19] <strcat> https://github.com/thestinger/playpen is the only non-trivial bit
[02:14:35] <SiegeLord> aatch, Well, the script could be a loop... I definitely saw a script like that a few days ago
[02:14:42] *** Joins: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu)
[02:14:47] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[02:14:47] <hoverbear> achin: Every language needs an IRC lib
[02:14:48] <strcat> which reminds me that I *still* haven't remembered to compile a kernel with CLONE_NEWUSER support
[02:14:56] * strcat does that
[02:15:03] <achin> all my friends like to write irc bot frameworks.  i figure i'll join them by writing on in rust
[02:15:09] <cmr> strcat: over break one of my to-dos is fix whatever bug is making rusti die
[02:15:21] <cmr> IRC bot frameworks are super boring :(
[02:15:25] <strcat> cmr: switch rustc to native I/O ;p
[02:15:28] <achin> cmr: nonsense
[02:15:30] <cmr> strcat: #[no_uv];
[02:15:32] <aatch> Ok, maybe there isn't.
[02:15:39] <strcat> cmr: sure
[02:15:45] <cmr> That has stdin/stdout
[02:15:50] <cmr> Mind trying with that addition?
[02:15:57] <strcat> later maybe
[02:15:59] <cmr> k
[02:16:06] <cmr> I'll try it after finals if you don't get to it :p
[02:16:12] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:16:28] *** Quits: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu) (Ping timeout)
[02:16:44] <cmr> Considering how long I've been writing TWiR, you'd think I wouldn't have to go to a previous post to remember the format...
[02:17:05] <SiegeLord> Why remember it when you can go to previous post to look it up ;)
[02:17:25] <pnkfelix> cmr: oh by the way
[02:17:36] <pnkfelix> cmr: I gave a presentation on Rust last week
[02:17:43] <pnkfelix> cmr: but I don't think they have the video live yet ...
[02:17:46] <cmr> pnkfelix: slides?
[02:17:53] *** Joins: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu)
[02:17:59] <cmr> also just post it to reddit and it will appear on TWiR, like magic
[02:18:00] * strcat is tempted to make nightly VM images with rust-git
[02:18:02] <cmr> ;p
[02:18:16] <pnkfelix> cmr: true dat
[02:18:24] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:18:26] <strcat> rusti: 2
[02:18:31] -rusti- timeout triggered!
[02:18:32] <achin> twirrrrrrrr
[02:18:34] <strcat> still broken
[02:18:36] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:18:39] <cmr> ah well
[02:18:42] <aatch> achin, This Week in Rust
[02:18:43] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:18:46] <pnkfelix> cmr: okay well I'll post it to reddit then
[02:18:54] <strcat> bugs don't seem to fix themselves these days
[02:18:58] <achin> aatch: yes indeed
[02:19:09] <strcat> rusti: 2222222222222
[02:19:09] <pnkfelix> cmr: I'm figuring out (/ making) a url for the slides
[02:19:09] -rusti- 2222222222222
[02:19:42] <cmr> strcat: contributions have cut off by like 30-40% since summer ended.
[02:20:04] <achin> will you maybe see an up-tick during the winter break?
[02:20:28] <cmr> and that drop would be larger if it weren't for achin's inhuman PR output
[02:20:28] <aatch> Hmm, anybody else encountered a bunch of missing symbols during linking stage2 of the compiler?
[02:20:33] <strcat> a lot of the summer contributions are from mozilla interns
[02:20:45] <cmr> erm, s/achin/acricto/
[02:20:48] <cmr> achin: (no offense)
[02:20:52] <achin> cmr: yes!  when you round up, my number of PRs is zero!
[02:20:54] <aatch> stage1 sorry
[02:21:44] <achin> my school had a 5 week winter break.  that seems long enough to dive in to some non-trivial bugs
[02:22:00] <cmr> achin: go for it! :)
[02:22:43] <achin> sadly, i've graduated and no longer get 5 week winter vacations :)
[02:23:01] <cmr> pft, nights and weekends.
[02:23:03] <aatch> achin, I feel your pain.
[02:23:41] <aatch> I'm looking forward to my 2-week holiday over christmas (first one in ~year)
[02:24:12] <achin> cmr: yeah, i wish i could :/  my using my brain all day, it's not often in the mood to be fully engaged post-dinner
[02:24:20] * cmr can relate
[02:25:24] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[02:26:10] <achin> at usually, my to-do list is about 20 times longer than i can actually do.  but, somehow, progress is made.  i wrote a simple nbt parser in rust last night
[02:26:29] <achin> and then got ICE'd and went to bed
[02:26:32] *** Joins: derek_c (derek@moz-31B7A1AE.cit.cornell.edu)
[02:31:32] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[02:32:03] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[02:34:14] *** Quits: ctult (Mibbit@moz-ADEF9FB8.bois.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:34:28] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[02:36:21] <cmr> http://www.reddit.com/r/rust/comments/1sikak/ask_cmr_to_do_things/
[02:36:28] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:36:57] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:38:08] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[02:38:17] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[02:38:21] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[02:38:38] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:38:44] *** Joins: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net)
[02:38:49] <derek_c> cmr: :)
[02:40:20] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[02:40:52] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[02:41:02] <derek_c> cmr: are you a student?
[02:41:07] *** Quits: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP) (Ping timeout)
[02:41:12] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[02:41:52] <cmr> yes
[02:41:55] *** Joins: tcr (tcr@moz-1EBF1EAD.olin.edu)
[02:42:20] *** Quits: tcr (tcr@moz-1EBF1EAD.olin.edu) (Client exited)
[02:42:29] <tautologico> what's -> ! as a return type?
[02:42:39] <cmr> tautologico: diverging, "never returns"
[02:42:40] <derek_c> cmr: what year are you in?
[02:42:44] <cmr> derek_c: freshman
[02:42:45] *** Joins: tcr (tcr@moz-1EBF1EAD.olin.edu)
[02:42:51] <tautologico> cmr: thanks
[02:42:55] <derek_c> cmr: like, a first-year student?
[02:42:58] <cmr> yes
[02:42:59] <derek_c> undergraduate?
[02:43:01] <cmr> yep
[02:43:06] <derek_c> holy shit
[02:43:10] <derek_c> I'm impressed
[02:43:17] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:43:30] <achin> can i ask where you go to school?
[02:43:34] <cmr> http://clarkson.edu/
[02:43:39] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[02:43:46] <derek_c> I'm a sophomore
[02:44:07] * strcat feels like adding a dozen lang items
[02:44:14] <achin> are you getting any school credit for all your rust work, cmr ?
[02:44:26] *** Quits: tcr (tcr@moz-1EBF1EAD.olin.edu) (Ping timeout)
[02:44:29] <aatch> strcat, lol, seems a little extreme...
[02:44:37] <cmr> achin: no, probably won't until I have some free credits to pour into it.
[02:44:40] <strcat> need one for every built-in type so I can implement methods on them
[02:44:48] <cmr> (ie, 3 or 4 semesters down the road)
[02:44:53] <cmr> strcat: +1
[02:45:03] <strcat> I'll start with vector slices...
[02:45:24] <strcat> oh wow the lang items aren't a horrific mess anymore
[02:45:58] <strcat> method resolve is ofc ;]
[02:46:09] <cmr> it's also a hack in trans for type_id
[02:46:14] *** Joins: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP)
[02:46:20] <cmr> lang items need to be type checked :(
[02:46:31] <strcat> partially type-checked
[02:46:37] <strcat> I want to be able to add default methods to stuff like Eq
[02:46:50] <cmr> yeah that'd be fine
[02:47:00] <aatch> 'lets_do_this!'
[02:47:04] <strcat> it'd be trivial to type-check them
[02:47:06] <cmr> we at least need to check that the things the compiler is emitting calls to are actually there.
[02:47:16] <strcat> I know which function the check would go to do it
[02:47:40] <strcat> coherence is weird though
[02:47:44] <aatch> and "There are $num_lang_items:expr lang items."
[02:47:51] <aatch> Amusing macro is amusing.
[02:48:13] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[02:48:25] *** Joins: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net)
[02:48:27] <derek_c> say I have a lengthy constant calculation in a function, like let x = 1024 * 1024 * ... * 1024.  Is rustc smart enough to calculate it only once?
[02:48:35] <achin> cmr: yeah, that sounds about right.  my first 2 years were pretty much all filled up with taking pre-req classes
[02:48:37] <derek_c> or every time the function is invoked?
[02:48:43] <strcat> derek_c: look at the LLVM IR
[02:48:48] *** Joins: garthk (garth@moz-B118B14A.static.internode.on.net)
[02:48:50] <aatch> derek_c, it can normally constant fold pretty well
[02:48:54] *** Parts: garthk (garth@moz-B118B14A.static.internode.on.net) ()
[02:48:56] <strcat> rustc -O --emit-llvm -S -o - foo.rs
[02:49:02] <strcat> where foo.rs is a little pub function you want to test
[02:49:05] <strcat> rustc -O --emit-llvm -S -o - --lib foo.rs
[02:49:08] *** Quits: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net) (Client exited)
[02:49:09] <strcat> easier, don't need main that way
[02:49:13] <cmr> lkuper: ohh, the trifecta quote was you?
[02:49:27] <derek_c> kk thanks
[02:49:28] <aatch> depends on what *exactly* you're doing.
[02:49:32] <lkuper> cmr: yep
[02:49:36] <derek_c> cmr: how did you get involved with Rust?
[02:49:54] <cmr> derek_c: long story short: HN post
[02:49:54] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[02:50:13] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:50:15] <derek_c> cmr: did you intern at mozilla or something?
[02:50:18] <cmr> no
[02:50:22] <strcat> vim number highlighting seems messed up now
[02:50:31] <cmr> ChrisMorgan: you broke it!
[02:50:51] <ChrisMorgan> What's broken about it?
[02:51:06] <aatch> derek_c, many people just got interested in Rust and started to contribute.
[02:51:16] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[02:51:27] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[02:51:28] <cmr> derek_c: I want to use Rust, but Rust isn't usable, so I'm trying to make it better.
[02:51:33] <derek_c> aatch: yeah, I asked cmr specifically because he seems to be *really involved*
[02:51:36] <achin> you don't get involved with rust, rust gets involved with you.  
[02:52:02] * aatch would do more if he had more time
[02:52:07] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:52:08] <derek_c> I consider myself involved too. contributing to some Rust repos already
[02:52:28] <strcat> derek_c: anyway definitely the best way to figure that out is to look at the IR (for high-level optimizations) or asm (for both) and build an intuition about what LLVM is able to do
[02:52:49] <derek_c> strcat: ok I will give it a try. thanks :)
[02:53:04] <aatch> It's somewhat surprising what LLVM is able (and isn't) to do
[02:53:18] <derek_c> I like how Rust reminds me of OCaml a lot
[02:53:30] <cmr> the bootstrap compiler was written in ocaml
[02:53:38] <cmr> it and sml were influences
[02:53:48] <derek_c> cmr: yeah? that sounds about right
[02:53:51] <aatch> Graydon was a big fan of ML
[02:53:54] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:54:03] <achin> ah, i was wondering what the first compiler was written in
[02:54:07] <aatch> (Graydon is the creator of Rust and former project lead)
[02:54:16] <derek_c> there are lots of things I like about OCaml, syntax-wise specifically. really surprised it wasn't more popular
[02:54:42] *** Joins: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net)
[02:54:49] <aatch> I know that variable declarations and pattern matching are taken from ML.
[02:55:04] * strcat doesn't think --target-feature works ;\\
[02:55:09] <cmr> achin: lore says that the first Rust compiler written in Rust took a full day to translate.
[02:55:20] <achin> OCaml was one of the languages used in my intro to CS class.  i've very rarely seen it elsewhere
[02:55:41] <achin> i think unity is written in ocaml?
[02:55:43] <aatch> Yeah, apparently the Ocaml compiler was absolutely awful.
[02:55:55] <cmr> I would doubt that
[02:55:58] <aatch> achin, Unity? as in the game framework?
[02:56:04] <cmr> if anything F#, but I'd expect C++ or C#
[02:56:06] <achin> wait no.  sorry, Unison
[02:56:08] <aatch> 'cos that's written in C++
[02:56:10] <achin> the file sync tool
[02:56:12] <aatch> C# sorry
[02:56:19] <lkuper> The bootstrap compiler was never really intended to be good.  It was just intended to get Rust off the ground.
[02:56:37] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[02:56:49] <strcat> should have just dropped it from a high place
[02:56:54] <lkuper> :)
[02:57:05] <aatch> lkuper, I wasn't criticising, just parroting what nmatsakis said :)
[02:57:12] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[02:57:28] <tautologico> the ocaml compilers are far from awful
[02:57:35] <achin> http://www.seas.upenn.edu/~bcpierce/unison//svn-instructions.html
[02:57:41] <cmr> tautologico: no, the rust compiler written in ocaml
[02:57:43] <achin> uh, i mean http://www.cis.upenn.edu/~bcpierce/unison/
[02:57:47] <tautologico> unison is written in ocaml
[02:58:03] <lkuper> aatch: yeah, you're not wrong :)
[02:58:08] <tautologico> unison is cool, though little known
[02:58:33] <achin> it's a core part of agrif's workflow.  i've never been able to get it to fit for me
[02:58:34] <aatch> I know that if I was intending to bootstrap a language, I wouldn't waste time on the first-run compiler.
[02:58:35] <lkuper> I feel like I know lots of people who use Unison, but...they're all PL academics
[02:58:58] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[02:59:02] <lkuper> my advisor has it running in a two-second loop
[02:59:22] <derek_c> Jane Street the financial company is known for use OCaml in production
[02:59:25] <achin> for some reason, i don't trust myself to use it correctly
[02:59:31] <derek_c> https://ocaml.janestreet.com/
[02:59:32] <lkuper> it's great for syncing things you don't want to put into version control
[02:59:35] <lkuper> executables and stuff
[02:59:46] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[03:00:15] <achin> i'd be on a train somewhere and think "doh, i forgot to run unison!"
[03:00:20] <nielsle> I once lost a weeks work due to unison. I think that I stooped it halfway during the process and when I started it again the halfwritten files were newer than the originals.
[03:00:32] <strcat> lkuper: if you're keeping a history of them, they might as well be in git/hg (maybe not your code/text repo)
[03:00:56] <strcat> lkuper: stuff like http://sparkleshare.org/ does that anyway ;p
[03:01:08] <lkuper> strcat: yeah, I don't think the point is to keep a history of the executables, just to have the most recent one on all machines you might want to have it on
[03:01:29] <lkuper> at least, that's the way I've seen people use it...I never got in the habit
[03:01:50] <achin> git-annex might also have a good workflow for mixing binaries and git
[03:02:08] <derek_c> I'm matching a ~str against a bunch of `&'static str` and the compiler is complaining.  how do I get around that?
[03:02:25] <derek_c> like match some_var {"a" => {}, "b" => {}}
[03:02:30] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[03:02:33] <strcat> derek_c: .as_slice()
[03:02:39] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[03:02:46] <strcat> or id::<&str>(some_var)
[03:03:04] <aatch> derek_c, either turn the string into a slice or put '~' before each string in the pattern. (The first is probably better)
[03:03:07] <sp3d> oh, I love unison
[03:03:42] <derek_c> I see thanks
[03:04:41] <aatch> derek_c, patterns mirror construction of the type, so you don't have to worry about a `~"foo"` pattern allocating.
[03:04:56] <ChrisMorgan> strcat/cmr: what's wrong with the Vim number highlighting?
[03:05:03] <strcat> ChrisMorgan: 5.0
[03:05:11] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[03:05:21] <strcat> the 0 is a different color
[03:05:28] *** Joins: mib_47vhgd (Mibbit@moz-68235C3E.customer.broadstripe.net)
[03:05:42] <strcat> and the suffix (f32/f64) doesn't get highlighted
[03:06:03] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[03:06:17] <MrOrdinaire> strcat: whoa, what does id do?
[03:06:29] <strcat> fn id<T>(x: T) { x }
[03:06:30] <aatch> MrOrdinaire, T -> T
[03:06:33] <cmr> MrOrdinaire: forces coercion
[03:06:43] <strcat> rusti: fn id<T>(x: T) { x } id(5)
[03:06:45] -rusti- <anon>:9:25: 9:26 error: mismatched types: expected `()` but found `T` (expected () but found type parameter)
[03:06:45] -rusti- <anon>:9         fn id<T>(x: T) { x } id(5)
[03:06:45] -rusti-                                   ^
[03:06:45] -rusti- error: aborting due to previous error
[03:06:45] -rusti- application terminated with error code 101
[03:06:50] <strcat> rusti: fn id<T>(x: T) -> T { x } id(5)
[03:06:50] <MrOrdinaire> cmr: sounds a lot like transmute?
[03:06:51] -rusti- 5
[03:06:56] <strcat> MrOrdinaire: no
[03:06:56] <cmr> MrOrdinaire: no, nothing like it.
[03:07:03] <strcat> rusti: fn id<T>(x: T) -> T { x } id(5.5)
[03:07:03] -rusti- 5.5
[03:07:04] <cmr> transmute unsafely bitcasts from one type to another
[03:07:08] <cmr> id just returns whatever you pass it.
[03:07:10] <ChrisMorgan> strcat: I presume that your colour scheme is highlighting Float differently from Number?
[03:07:10] <strcat> rusti: fn id<T>(x: T) -> T { x } id::<f64>(5.5)
[03:07:10] -rusti- 5.5f64
[03:07:12] <cmr> it's the identity function.
[03:07:14] <strcat> rusti: fn id<T>(x: T) -> T { x } id::<f32>(5.5)
[03:07:15] -rusti- 5.5f32
[03:07:17] <strcat> ChrisMorgan: yes
[03:07:18] <brson> cmr: is this finals week or next?
[03:07:23] <cmr> brson: this
[03:07:25] <strcat> ChrisMorgan: zenburn - integers are blue, floats are purple
[03:07:27] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[03:07:28] *** Quits: zz_kimundi (kimundi@moz-7496AA85.dip0.t-ipconnect.de) (Ping timeout)
[03:07:43] <MrOrdinaire> strcat: how can it cast from ~str to &str?
[03:07:48] <strcat> MrOrdinaire: it doesn't cast
[03:07:52] <strcat> ~str coerces to &str
[03:07:54] <cmr> MrOrdinaire: it doesn't, the compiler automatically does that coercion.
[03:07:54] <strcat> whenever necessary
[03:08:11] <strcat> rusti: let x = ~"foo"; let y: &str = x; y[0]
[03:08:11] <ChrisMorgan> strcat: I hadn't thought of that, and 5.0 should be highlighted as rustFloat, but the 0 is being taken as rustDecNumber. My colour scheme has Float and Number the same, so I didn't notice that fact.
[03:08:11] -rusti- 102u8
[03:08:38] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[03:08:42] <MrOrdinaire> isn't there a 'no-returning-borrowed-pointer' rule somewhere? Or am I mistaken?
[03:08:51] <dbaupp> cmr: maybe you should not be in #rust :P
[03:08:52] <ChrisMorgan> See, this is why my Vim stuff still needs reviews (whoever it was that approved that said that he *trusted* me!)
[03:09:00] <cmr> dbaupp: nah next final is wednesday ;p
[03:09:01] <strcat> MrOrdinaire: you can return a borrowed pointer
[03:09:08] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[03:09:11] <dbaupp> cmr: isn't that tomorrow?
[03:09:15] <dbaupp> oh, wait, timezones
[03:09:22] <achin> rust should ship with a script to copy the vim stuff into the right places (or maybe i should just symlink them into place?)
[03:09:24] <cmr> ChrisMorgan: what you need is some god-awful theme that gives everything a different color.
[03:09:25] <ChrisMorgan> dbaupp: it's still yesterday where they all are :-)
[03:09:29] <strcat> MrOrdinaire: the return type has to have the same lifetime as the thing it's based on
[03:09:37] <strcat> so if it's not just generic type parameters, you have to mark it
[03:09:57] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:09:59] <strcat> if you have 'id<T>(x: T) -> T' and you pass in &'a int, the return is automatically &'a int
[03:10:42] *** Joins: zz_kimundi (kimundi@moz-19623CE3.dip0.t-ipconnect.de)
[03:10:46] <strcat> rusti: fn id<T>(x: T) -> T { x } let x = 5; *id(&x)
[03:10:46] -rusti- 5
[03:10:58] <strcat> rusti: fn id<'a>(x: &'a int) -> &'a int { x } let x = 5; *id(&x)
[03:10:59] -rusti- 5
[03:11:07] *** zz_kimundi is now known as kimundi
[03:11:24] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[03:11:28] <cmr> http://cmr.github.io/blog/2013/12/09/this-week-in-rust
[03:11:48] <achin> twirrrrr
[03:11:57] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[03:12:05] <ChrisMorgan> strcat: the float highlighting is nice and easy to fix—the problem is that the special rule for highlighting "5." as a float was written *after* the normal one and so took precedence, so one like "5.0f32" was being highlighted as two separate floats—"5." and "0f32". So I just shift the special case up and it's fine.
[03:13:08] <strcat> \o/
[03:13:15] *** Quits: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net) (Quit: Leaving)
[03:13:17] *** Quits: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru) (Ping timeout)
[03:13:25] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[03:13:30] *** Joins: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net)
[03:13:30] <MrOrdinaire> strcat: so is it like `&5 as &int`?
[03:13:30] *** Joins: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru)
[03:15:29] <strcat> MrOrdinaire: hm?
[03:15:39] <achin> cmr: "Path::new has been renamed back to Path::init."    <-- this seems to be the opposite of what the linked PR says?   ("Rename the *::init() functions back to *::new()")
[03:15:42] <dbaupp> cmr: you have two links to the sodium oxide reddit pag
[03:15:43] <dbaupp> e
[03:15:45] <strcat> MrOrdinaire: id doesn't do anything
[03:15:54] <strcat> it's just sometimes a convenient place to put a type annotation
[03:15:54] <aatch> MrOrdinaire, no, it's just the identity function.
[03:16:17] <strcat> let x: T = foo(); is a statement, id::<T>(foo()) is an expression
[03:16:22] <aatch> f(x) = x
[03:16:26] <cmr> dbaupp: poo
[03:16:48] <strcat> aatch: pfft, haskell syntax > math syntax
[03:16:52] <strcat> f x = x
[03:16:54] <strcat> ;p
[03:17:14] <cmr> dbaupp: this is what happens when I get distracted
[03:17:26] * strcat is never not distracted ;\
[03:17:48] <strcat> so I managed to get methods to resolve for `char`
[03:17:53] <cmr> and now I'm going to bed.
[03:17:56] <strcat> but it doesn't seem right
[03:18:01] <cmr> oops, not before I send twir to the ml
[03:18:03] <cmr> jeaye: I won't forget you!
[03:18:07] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:18:16] *** Quits: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net) (Quit: Leaving)
[03:18:23] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[03:18:23] <jeaye> There's nothing to remember anymore. >.<
[03:18:23] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:18:25] <MrOrdinaire> strcat, aatch: I see
[03:18:26] <jeaye> I'm fading away.
[03:18:30] <MrOrdinaire> strcat, aatch: thanks
[03:18:37] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[03:18:51] <cmr> Nooooo. Work eating you up?
[03:19:15] * strcat paints jeaye black
[03:19:20] <jeaye> Work, sickness, other projects.
[03:19:34] <jeaye> Life.
[03:19:44] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[03:19:47] <cmr> ! surely health and life doesn't take precedence over rust!
[03:20:00] <strcat> death, taxes and rust
[03:20:02] <brson> twir! yay!
[03:20:06] <aatch> jeaye, stupid life. If only my landlord understood.
[03:20:09] <achin> cmr: maybed you meant to link to #10697 instead of #10796?
[03:20:15] <jeaye> aatch: They never do.
[03:20:40] <cmr> achin: I don't think so?
[03:20:55] <achin> then i am confused
[03:21:00] <cmr> I-menu, whatever it does, seems unimportant and not a breaking change.
[03:21:11] <cmr> oops I have them backwards.
[03:22:00] * cmr actually goes to bed
[03:24:20] *** Joins: fournm (Aria@moz-ABB60BA0.austin.res.rr.com)
[03:25:34] <aatch> Well whatever my compiling issue was, it seems to have been fixed by cleaning the build dir
[03:28:51] <strcat> um, how do you step through a branch when the if {} else {} is on one line?
[03:29:39] <strcat> I guess I have to step through instructions...
[03:30:02] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[03:30:32] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[03:30:32] *** ChanServ sets mode: +o tjc
[03:30:38] <ChrisMorgan> strcat: BTW, blame aatch for giving r+ to https://github.com/mozilla/rust/pull/10793 which broke the float highlighting for you
[03:30:48] <aatch> I REGRET NOTHING!
[03:30:51] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[03:31:04] <strcat> so... this doesn't work at all
[03:31:41] *** Joins: p_adams (p_adams@moz-6E953D23.dhcp.stls.mo.charter.com)
[03:31:49] <strcat> I think I need to make #[lang = "char"] struct Char { ... } get treated as if it's char rather than hacking away at this resolve stuff
[03:32:01] * strcat shrugs
[03:32:44] <ChrisMorgan> strcat: r? https://github.com/mozilla/rust/pull/10888
[03:33:08] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[03:35:49] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[03:35:50] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:36:12] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[03:37:01] <ChrisMorgan> '''Memory usage when compiling librustc has been killed by 130MB with some well-placed indirection.''' "killed"? I would have said "reduced", myself.
[03:37:11] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Client exited)
[03:37:21] <achin> death to those megabytes
[03:37:36] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[03:39:19] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[03:41:15] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[03:42:07] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Ping timeout)
[03:42:09] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[03:42:14] *** Quits: rootnode (rootnode@moz-7FAB5E8.ip1.george24.com) (Ping timeout)
[03:42:22] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[03:44:38] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[03:45:37] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[03:45:42] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[03:45:45] *** Quits: MrOrdinaire (Mibbit@FBE4BDD6.9B93F280.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:46:00] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:46:50] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[03:47:45] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:51:14] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Quit: Leaving)
[03:51:56] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[03:52:03] *** Quits: b (b@moz-55CA322E.org) (Ping timeout)
[03:52:03] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[03:53:18] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[03:55:18] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: Entscheidungsproblem)
[03:56:25] *** Quits: p_adams (p_adams@moz-6E953D23.dhcp.stls.mo.charter.com) (Quit: WeeChat 0.4.2)
[03:57:49] <hoverbear> achin: It's important to be violent with your memory.
[03:58:31] <hoverbear> If it isn't afraid of you, you'll get smacked in the head with pages and pages of frames.
[03:59:08] <ChrisMorgan> rusti: macro_rules! x (( { $( $x:ident; )* } ) => ()) x!({y;})  // Can anyone help me circumvent this bug?
[03:59:08] -rusti- <anon>:9:61: 9:62 error: Local ambiguity: multiple parsing options: built-in NTs ident ('x') or 1 other options.
[03:59:08] -rusti- <anon>:9         macro_rules! x (( { $( $x:ident; )* } ) => ()) x!({y;})  // Can anyone help me circumvent this bug?
[03:59:09] -rusti-                                                                       ^
[03:59:09] -rusti- application terminated with error code 101
[04:00:33] <achin> hoverbear: spoken like someone who's lost a few hard fought battles with his memory
[04:00:47] <hoverbear> achin: I had amnesia at one point actually.
[04:00:49] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[04:00:56] *** Quits: derek_c (derek@moz-31B7A1AE.cit.cornell.edu) (Ping timeout)
[04:01:07] <Yurumechan> rusti: macro_rules! x (( { $( $x:ident; )+ } ) => ()) x!({y;})
[04:01:07] -rusti- <anon>:9:61: 9:62 error: Local ambiguity: multiple parsing options: built-in NTs ident ('x') or 1 other options.
[04:01:07] -rusti- <anon>:9         macro_rules! x (( { $( $x:ident; )+ } ) => ()) x!({y;})
[04:01:07] -rusti-                                                                       ^
[04:01:08] -rusti- application terminated with error code 101
[04:02:06] *** Quits: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net) (Quit: leaving)
[04:02:07] <Yurumechan> rusti: macro_rules! x (( { $( $x:ident );+; } ) => ()) x!({y;})
[04:02:07] -rusti- <anon>:9:62: 9:63 error: Local ambiguity: multiple parsing options: built-in NTs ident ('x') or 1 other options.
[04:02:07] -rusti- <anon>:9         macro_rules! x (( { $( $x:ident );+; } ) => ()) x!({y;})
[04:02:07] -rusti-                                                                        ^
[04:02:07] -rusti- application terminated with error code 101
[04:02:36] <Yurumechan> hmm i dont know why
[04:02:52] <ChrisMorgan> Yurumechan: I tried that too :-(
[04:03:04] <dbaupp> rusti: macro_rules! x (( { $( [ $x:ident; ] )+ } ) => ()) x!({[y;]})
[04:03:04] -rusti- <anon>:1:0: 1:0 error: unexpected token: `<eof>`
[04:03:04] -rusti- <anon>:1 #[feature(globs, macro_rules, struct_variant)];
[04:03:04] -rusti-          ^
[04:03:04] -rusti- application terminated with error code 101
[04:03:54] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[04:03:57] <dbaupp> rusti: macro_rules! x (( $( [ $x:ident; ] )+ ) => ( () )) x!([y;])
[04:03:58] -rusti- ()
[04:04:11] <dbaupp> ChrisMorgan: ^
[04:04:14] *** Joins: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[04:04:21] <dbaupp> rusti: macro_rules! x (( $( [ $x:ident; ] )+ ) => ( () )) x!([y;] [z;])
[04:04:22] -rusti- ()
[04:04:44] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[04:04:48] *** Joins: b (b@moz-55CA322E.org)
[04:05:14] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[04:05:40] <ChrisMorgan> dbaupp: but I've got to have two sets of groups, so the nesting is essential, which is the "unexpected token: `<eof>`" case.
[04:05:51] <ChrisMorgan> (If I can't figure this out, my attempt to use macros to make syntax::parse::token maintainable will fail, as I must have two sets of repeating groups in the macro.)
[04:06:40] <dbaupp> ChrisMorgan: the eof is when the RHS is completely empty
[04:06:56] <dbaupp> (at least, it was above)
[04:07:12] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[04:07:15] <ChrisMorgan> Ah yes, so it was.
[04:08:12] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[04:08:55] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Client exited)
[04:09:26] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[04:09:32] <ChrisMorgan> OK, I'm ending up settling for parenthesising each line; `{ (x, y, z); (x, y, z); }` works fine, even though `{ x, y, z; x, y, z; }` doesn't. Weird. Very weird.
[04:09:53] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[04:11:12] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[04:11:59] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[04:12:55] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131112160018])
[04:13:40] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: WeeChat 0.4.2)
[04:14:22] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[04:14:26] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[04:15:27] <aatch> Goddamn X authorisation is confusing...
[04:16:19] <achin> let ssh deal with it whenever possible
[04:16:42] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Ping timeout)
[04:16:44] <aatch> achin, I mean X11
[04:17:34] <achin> yeah.  i find that things work the best when you don't touch X11 auth stuff and use X11 forwarding over ssh
[04:17:53] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:18:03] <aatch> achin, not really an option when implementing the X11 protocol...
[04:18:16] <achin> ha!  good luck!
[04:18:30] <aatch> The rest is actually relatively sensible.
[04:18:56] <aatch> It's just that authorisation consists of: "It's a thing, we don't define anything there"
[04:19:44] *** Joins: ctult (Mibbit@moz-ADEF9FB8.bois.qwest.net)
[04:20:22] <ctult> I am trying to build glfw-rs on Windows, and it keeps throwing errors.  Does it work on Windows yet?
[04:21:33] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[04:21:33] *** ChanServ sets mode: +o jdm
[04:21:44] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[04:22:13] *** Quits: celeron55 (perttu@moz-D552F2C7.netplaza.fi) (Ping timeout)
[04:24:39] <sfackler> ctult: what errors? it may just be out of date
[04:24:51] *** Joins: celeron55 (perttu@moz-D552F2C7.netplaza.fi)
[04:25:23] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[04:25:57] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[04:25:59] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:26:01] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[04:26:50] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[04:27:01] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[04:28:26] *** Joins: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com)
[04:28:52] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[04:29:18] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[04:31:24] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:31:29] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[04:32:44] <bstrie> is it possible for us to statically determine if a given function ever allocates on the heap?
[04:33:29] <ChrisMorgan> bstrie: do you mean theoretically possible or currently‐implemented possible?
[04:33:29] <sfackler> iirc there's a lint for heap allocation
[04:33:44] <sfackler> not sure if it can attach to a function though
[04:35:07] <ctult> sfackler: I am building it from source, here is the error: http://pastebin.com/n4FfMvuc
[04:35:49] <sfackler> ctult: glfw-rs builds against the master branch of github.com/mozilla/rust, not 0.8
[04:35:58] <bstrie> ChrisMorgan: I was reading TWiR and saw that str::from_utf8 no longer allocates, and was wondering if perhaps it would be possible to have an attribute #[never_allocates] to enforce that in the future against regressions
[04:36:10] <sfackler> you'll probably need to check out a commit from around the time 0.8 was released
[04:36:17] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[04:36:20] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[04:36:35] <ctult> sfackler: I tried it on my master build on my other computer, and it didn't work
[04:37:07] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[04:37:23] <mcpherrin> cmr: TWiR has the wrong link on std::util::ignore has been renamed to std::util::drop, to better reflect what it does.
[04:37:27] <sfackler> if it's the same error, then it seems like it's master from before the &fn(Foo) -> |Foo| change
[04:37:37] *** Quits: zslayton_ (Mibbit@moz-4806B979.nyc.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[04:41:04] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Quit: Leaving...)
[04:41:18] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[04:42:47] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[04:44:04] *** Quits: Jesin (Jesin@moz-47E5520D.cc.lehigh.edu) (Quit: Leaving)
[04:45:14] * pradeep likes the latest Rust tutorial - much clearer
[04:46:30] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:46:53] *** Joins: gdey (Mibbit@moz-E4449B64.sd.sd.cox.net)
[04:48:29] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[04:48:29] *** ChanServ sets mode: +o tjc
[04:48:36] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:50:38] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[04:51:51] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[04:53:03] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[04:53:06] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[04:54:02] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[04:54:39] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:55:11] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[04:55:42] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[04:56:18] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[04:58:17] <eddyb> cmr: I see what you're doing there :D
[04:58:25] *** Joins: ctult_ (Mibbit@moz-ADEF9FB8.bois.qwest.net)
[04:58:26] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[04:58:51] <ctult_> Does anyone have a windows build of a fairly recent rust-master?  My computer is hating me right now.
[04:59:00] <ezyang> so, can someone explain to me where in the manual the difference between matches on lvalues/rvalues is explained (as described here: https://github.com/mozilla/rust/issues/10858#issuecomment-30151024 ) 
[04:59:27] <dbaupp> ezyang: it likely isn't explained
[05:00:24] <ezyang> oh, ok 
[05:00:29] <ezyang> PR time! 
[05:01:54] <eddyb> ctult_: you can always try the snapshot compiler :P
[05:02:36] <ctult_> 7eddyb: ?
[05:03:45] <dbaupp> eddyb: that will now/soon only for #[no_std] builds, since we're just distributing a statically linked rustc binary.
[05:03:56] <dbaupp> s/only/only work/
[05:04:19] <ctult_> 7dbaupp: What is this mystical snapshot compiler?
[05:04:39] *** Joins: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net)
[05:04:50] <klutzy> I have one on revision 61443dc
[05:05:16] <eddyb> dbaupp: oh well...
[05:05:37] <klutzy> but I'm on linux so I can't promise if it even works :p
[05:06:27] *** Quits: bleibig (bleibig@moz-B4D9C5AF.hsd1.ca.comcast.net) (Ping timeout)
[05:06:46] <ctult_> 7klutzy: Ok.  If it is not too much of a hassle, that would be great. :D
[05:07:10] <ChrisMorgan> ctult_: the snapshot compiler is a build of just rustc which is downloaded and used to build rustc.
[05:07:15] <ChrisMorgan> (And the rest.)
[05:07:53] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Ping timeout)
[05:08:10] *** Joins: bleibig (bleibig@moz-B4D9C5AF.hsd1.ca.comcast.net)
[05:08:11] <dbaupp> ctult_: rust is bootstrapped, since the code is almost entirely in Rust; so to be able to start building the codebase, you need to have a rust compiler. These are   compiled by some of the infrastructure Rust has, and saved on a webserver to be downloaded on demand.
[05:08:27] <dbaupp> that saved compiler is the "snapshot".
[05:08:34] <klutzy> ctult_: http://klutzy.nanabi.org/tmp/rust-61443dc.win32.tgz
[05:08:57] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[05:08:58] <ctult_> 7dbaupp: I assumed as such, but I couldn't find anything about it.
[05:09:19] <ctult_> 7klutzy: Many thanks.
[05:09:32] <ChrisMorgan> ctult_: your text is persistently orange.
[05:09:40] <klutzy> ctult_: it is built on mingw-w64, but it's 32-bit and the relevant dlls are included
[05:09:43] <dbaupp> ctult_: https://github.com/mozilla/rust/wiki/Note-compiler-snapshots
[05:10:03] <klutzy> so it basically works like mingw one
[05:10:13] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[05:10:14] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:10:26] <dbaupp> g3xzh: ping
[05:10:39] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: )
[05:10:39] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[05:11:25] <ctult_> ChrisMorgan: sorry, some weird setting apperently
[05:11:35] *** Quits: bleibig (bleibig@moz-B4D9C5AF.hsd1.ca.comcast.net) (Ping timeout)
[05:11:38] *** Quits: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net) (Ping timeout)
[05:11:39] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:11:43] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[05:11:47] <klutzy> I thought I've built windows one yesterday.. but it might be a dream since I can't find it now
[05:12:07] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:12:16] *** Parts: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) ()
[05:12:37] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:12:40] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[05:12:46] *** Parts: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) ()
[05:12:52] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:15:14] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[05:17:19] <eddyb> cmr: I'd borrow you for my variadics, but there's better suggestions out there :P
[05:19:36] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[05:20:01] <ezyang> I use Hans Jørgen's nightlies, they seem to work quite well: https://launchpad.net/~hansjorg/+archive/rust 
[05:20:52] <ezyang> Who do I need to bug to get people to apply a commit? 
[05:21:58] <ChrisMorgan> ezyang: they'll tend to be reacted to fairly quickly (within hours) but you can normally get a response faster still with a "r? https://github.com/mozilla/rust/pull/NNNNN" line in here.
[05:22:03] <dbaupp> ezyang: have you open a PR on github? (assuming it's for mozilla/rust)
[05:22:15] <dbaupp> *opened
[05:22:19] <ChrisMorgan> ("r?" meaning "Could someone please review this?")
[05:22:50] <ezyang> r? https://github.com/mozilla/rust/pull/10822 
[05:23:05] <ezyang> WEll, it is reviewed 
[05:23:42] <dbaupp> ezyang: you appear to have not fixed strcat's comment about 'init'?
[05:23:52] *** Joins: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net)
[05:24:12] <ezyang> oh, oops, I wonder hwo I missed that. 
[05:24:34] <bjz> ctult_: beep
[05:24:56] <ChrisMorgan> After you've done that, add a comment to it saying that you've fixed it or drop a line in here and you should get a r+ or something else to change
[05:25:22] <ezyang> r? https://github.com/mozilla/rust/pull/10822 
[05:25:30] <ezyang> (sorry, am I doing this right?) 
[05:27:17] *** Joins: houzi (houzi@moz-4F6A1E26.getinternet.no)
[05:27:20] <dbaupp> ezyang: r+, thanks :)
[05:27:52] <ezyang> sweet 
[05:28:24] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[05:29:38] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Input/output error)
[05:31:16] <ChrisMorgan> ezyang: yep, that's right. (Don't worry about making slip-ups either; I'm not aware of anyone in this community with a tendency to biting the heads off newcomers.)
[05:31:47] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[05:32:55] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[05:33:32] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:37:21] *** Quits: ctult_ (Mibbit@moz-ADEF9FB8.bois.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:38:01] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[05:38:42] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[05:39:00] *** Quits: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr) (Ping timeout)
[05:40:57] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[05:41:03] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:41:31] * o11c blinks. Wow, there really *is* a lack of head-biters here.
[05:43:34] <ezyang> :) 
[05:43:48] <ezyang> OK, I'm trying to figure out how the manual should be adjusted for https://github.com/mozilla/rust/issues/10858#issuecomment-30151024 
[05:44:03] <ezyang> Now, I am a little confused: Niko's comment suggests that *x is an lvalue 
[05:44:24] <ezyang> However, the manual states that "Path, field and index expressions are lvalues" 
[05:44:33] <dbaupp> sounds like a bug
[05:44:36] <ezyang> And I don't think the unary dereference operator is any of these. What does that mean? 
[05:44:39] <ezyang> OK... 
[05:44:42] <dbaupp> since `*x = 1` is perfectly valid
[05:44:46] <ezyang> yeah 
[05:44:51] <ChrisMorgan> o11c: yes, the Rust community is a delightful one at present. That will inevitably change, of course; it will be our duty then to try to keep it as nice as possible, where at present we've had very little difficulty achieving that.
[05:47:31] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[05:47:31] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:47:38] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[05:48:23] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:49:01] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[05:50:05] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:50:30] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[05:51:03] <ezyang> https://github.com/mozilla/rust/issues/10890 
[05:51:15] * eddyb wishes people would name themselves on cmr's pad
[05:51:30] <ezyang> what is cmr's pad? 
[05:52:09] <eddyb> ezyang: https://etherpad.mozilla.org/dVXGixuou0 - from http://www.reddit.com/r/rust/comments/1sikak/ask_cmr_to_do_things/
[05:52:31] <ezyang> oh, I see :) 
[05:52:55] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[05:53:16] *** Quits: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP) (Ping timeout)
[05:53:46] *** Joins: lpy (lpy@13C7F3A.F09091A8.1348A864.IP)
[05:53:53] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[05:53:56] <Heather> hello
[05:54:12] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: WeeChat 0.4.2)
[05:54:56] <sfackler> I tried to name myself but it doesn't seem to have stuck :(
[05:55:51] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[05:56:00] <eddyb> sfackler: I think you disconnected
[05:56:01] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[05:56:14] <Heather> I failed to build rust today
[05:56:44] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[05:57:19] <ezyang> One of the weirdest things I find about Rust syntax is that I can mat against @ or ~ 
[05:57:22] *** Quits: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net) (Connection reset by peer)
[05:57:23] <ezyang> *match 
[05:57:44] <eddyb> ezyang: those are dereference patterns
[05:57:59] <ezyang> Soooo not mentioned in the manual :) 
[05:58:21] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[05:58:22] <eddyb> the manual is outdated and the tutorial is incomplete :/
[05:58:28] <WebeWizard> Wizzaaarrrd
[05:58:37] <ezyang> well, hopefully I can submit some PRs which make it less outdated :) 
[05:59:29] <ezyang> Why isn't &mut a valid match dereference? 
[05:59:35] <ezyang> *dereference patterns 
[06:00:02] <eddyb> ezyang: because the mutability is taken from &/&mut... hmm
[06:00:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[06:00:41] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[06:00:51] <eddyb> rusti: let mut x = 5; { let &mut y = &mut x; y = 10; } x
[06:00:53] -rusti- pastebinned 7 lines of output: http://sprunge.us/VRCZ
[06:01:04] <ezyang> Right now it syntax errors 
[06:01:07] <eddyb> rusti: let mut x = 5; { let mut &y = &mut x; y = 10; } x
[06:01:08] -rusti- pastebinned 6 lines of output: http://sprunge.us/IDZM
[06:01:09] <ezyang> I can file a bug report on that too 
[06:01:23] <eddyb> rusti: let mut x = 5; { let &y = &mut x; y = 10; } x
[06:01:24] -rusti- pastebinned 8 lines of output: http://sprunge.us/XDTb
[06:01:34] <eddyb> it sure looks like a bug
[06:01:44] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[06:01:47] <eddyb> rusti: let mut x = 5; { let mut y = *&mut x; y = 10; } x
[06:01:49] -rusti- pastebinned 7 lines of output: http://sprunge.us/eLXf
[06:01:59] <ChrisMorgan> ezyang: largely I wouldn't worry too much about fixing up slight things in the tutorial and manual; they're going to be being replaced wholesale, so there are probably more useful things to work on.
[06:02:09] <Heather> repair rust !
[06:02:17] <eddyb> ezyang: the last one does what &mut y should do
[06:02:19] <ezyang> oh. Well. 
[06:02:24] *** Joins: derek_c (derek@moz-31B7A1AE.cit.cornell.edu)
[06:02:28] <Heather> please.
[06:02:44] <ezyang> Well, this one seems like a legit bug 
[06:03:26] <ezyang> ChrisMorgan: What timescale are they going to be rewritten in? If it's giong to be another year, might as well fix it if it's easy... 
[06:03:57] <aatch> Hmm, this seems like an issue... can't use 'return' in a closure.
[06:04:13] <ChrisMorgan> ezyang: I'm expecting significant rewriting within a couple of months.
[06:04:14] <eddyb> myeah. someone should fix that
[06:04:24] <sfackler> aatch: iirc it's a holdover from the old for loop syntax
[06:04:43] *** Joins: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net)
[06:04:45] <aatch> I mean, I don't *need* it. But otherwise I end up with 5 nested conditions.
[06:04:49] <aatch> sfackler, I figured.
[06:04:50] <ChrisMorgan> I recall brson or pcwalton saying a few weeks back that it should be reinstated.
[06:04:51] <eddyb> aatch: I don't expect it to be harder than removing checker code from rustc :P
[06:05:05] <aatch> eddyb, yeah, should be fairly easy.
[06:05:09] <aatch> Just annoying.
[06:05:17] <eddyb> add to cmr's growing TODO list :))
[06:05:53] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:05:55] <ezyang> eddyb: let mut x = 5; { let &mut y = &mut x; y = 10; } x <-- good test case for the bugreport? 
[06:06:19] <eddyb> ezyang: add assert_eq!(x, 5); at the end
[06:06:40] <eddyb> so assigning y should work, but it shouldn't change the value of x
[06:07:17] <eddyb> ezyang: it should also work with let &mut y = &x;
[06:07:26] <aatch> What's the bug report?
[06:07:27] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:07:45] <eddyb> missing support for &mut in patterns
[06:08:16] <aatch> eddyb, I'm not sure if that's actually a bug or not.
[06:08:21] <ezyang> hang on, that code snippet does compile on latest Rust 
[06:08:30] <eddyb> ezyang: hahaha I thought you checked first
[06:08:42] <ezyang> Well, I checked... two days ago 
[06:08:49] <eddyb> rusti: version
[06:08:50] <ezyang> I guess it got fixed in the meantime. Hang on. 
[06:08:50] -rusti- "rustc 0.8"
[06:09:08] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[06:09:15] <aatch> recent versions of rustc break inside strcat's sandbox.
[06:09:33] <eddyb> I knew that some of these issues were fixed some time ago, I thought &mut wasn't because you complained. should've asked first
[06:09:41] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[06:09:51] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[06:09:53] <ezyang> Well, it sounds like it was fixed very recently! 
[06:11:31] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[06:11:55] <WebeWizard> i always compile against the nightly build
[06:12:52] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[06:14:26] *** Quits: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:14:59] <ezyang> Hm, if it were up to me, lvalue matches would get their own syntax. Ah well. 
[06:15:03] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[06:15:21] <aatch> ezyang, what do you mean?
[06:15:34] <ezyang> I'm not really sure how it would work 
[06:15:44] <ezyang> but basically I feel like the semantic difference is great enough that they shouldn't be punned 
[06:16:17] <ezyang> ?r https://github.com/mozilla/rust/pull/10892 
[06:16:18] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[06:16:31] <ezyang> Mostly because I had it halfway done before someone informed me that the manual was gonna get rewritten :o) 
[06:17:02] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[06:23:28] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[06:24:44] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[06:28:32] <ezyang> oh, oops, 
[06:28:43] <ezyang> r? https://github.com/mozilla/rust/pull/10892 
[06:29:02] *** Quits: lpy (lpy@13C7F3A.F09091A8.1348A864.IP) (Ping timeout)
[06:29:15] <ezyang> Can someone concisely explain to me the difference between Option<~T> and ~Option<T>? 
[06:29:39] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[06:30:11] <eddyb> ezyang: the former is a nullable pointer
[06:31:01] <eddyb> ezyang: the latter always allocates size_of::<T>() + (0 to 8. 0 only if T is a pointer itself) bytes
[06:31:07] *** Quits: zslayton (Mibbit@81EB2473.5F4BC84E.66C78B76.IP) (Ping timeout)
[06:31:29] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[06:31:43] *** Quits: ctult (Mibbit@moz-ADEF9FB8.bois.qwest.net) (Ping timeout)
[06:32:15] <sfackler> ezyang: if you're familiar with C++, it's like difference between *vector<int> and vector<*int>
[06:32:22] <benh> meh
[06:32:29] *** Quits: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net) (Ping timeout)
[06:32:29] <benh> there's not really that much of a difference, is there...
[06:32:37] <benh> conceptually they do the same thing
[06:32:45] <eddyb> the main difference is the memory usage
[06:32:48] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[06:32:54] <benh> could be optimized, maybe?
[06:32:57] <geomyidae> I Thought I understood it (as sfackler described) until the second part of what eddy said
[06:33:36] <benh> Well, it's a non-null pointer to a tag bit and a T
[06:33:39] <eddyb> ~Option<T> for non-pointer types T is ~(u8, T), and that may include padding
[06:33:58] <eddyb> on x64 it can 8 bytes larger than T
[06:34:13] <benh> non-(non-nullable pointer)
[06:34:14] <eddyb> (the (u8, T) box, not the pointer to it)
[06:34:14] <benh> :3
[06:34:47] <eddyb> benh: meh, only unsafe pointers are nullable AFAIK
[06:35:04] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[06:35:45] <eddyb> geomyidae: does that make sense? or is it just surprising?
[06:36:00] <geomyidae> The former is intuitive. There's either a ptr, or nothing.
[06:36:29] <geomyidae> The latter, the tag bit, and ~(u8, T) big made sense
[06:36:45] <benh> "Either there's a pointer to an allocated box, or no pointer and no box. In the latter, there's always a box that contains either a thing or nothing."
[06:36:47] <geomyidae> So, yes. heh, thanks
[06:37:36] <eddyb> enums in general waste a ton of space
[06:37:50] <geomyidae> I guess I didn't know|realize until now that that's how Option|enums were implemented....
[06:38:16] *** Parts: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) ()
[06:38:23] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[06:39:18] <eddyb> Either<u32, (u8, u32)> uses 3 * 4 bytes instead of 2 * 4 bytes (which it technically could)
[06:39:22] <benh> I've been thinking for the case where the space overhead is a problem, we could have some sort of magical PackedEnum<T> type that just collapses all the tag fields of a nested enum T at the cost of having to call .unpack() or whatever before matching against the enum or taking pointers inside it or w/e
[06:39:52] <ezyang> OK, the follow-up question is, how would you mutate a &mut Option<~T> such that you get back a ~T and the location is left with None? 
[06:39:52] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[06:40:08] <eddyb> ptr.take()?
[06:40:17] <eddyb> I was going to write something manual, but I think that's a thing
[06:40:39] <benh> I think you need .take().unwrap() though
[06:40:48] <ezyang> Oh, is this Option's take? 
[06:41:01] <benh> rusti: let i: Option<int> = None.take(); i
[06:41:02] -rusti- <anon>:9:29: 9:33 error: cannot borrow immutable static item as mutable
[06:41:02] -rusti- <anon>:9         let i: Option<int> = None.take(); i
[06:41:02] -rusti-                                       ^~~~
[06:41:02] -rusti- error: aborting due to previous error
[06:41:02] -rusti- application terminated with error code 101
[06:41:18] <benh> rusti: let i: Option<int> = (&mut None).take(); i
[06:41:18] -rusti- <anon>:9:30: 9:39 error: cannot borrow immutable static item as mutable
[06:41:19] -rusti- <anon>:9         let i: Option<int> = (&mut None).take(); i
[06:41:19] -rusti-                                        ^~~~~~~~~
[06:41:19] -rusti- error: aborting due to previous error
[06:41:19] -rusti- application terminated with error code 101
[06:41:22] <benh> boo
[06:41:35] <benh> but yeah Option has a take that does something ;)
[06:41:52] <bblum> the option dance is eternal
[06:41:52] *** Joins: skade (skade@moz-3DC698FE.pools.arcor-ip.net)
[06:41:56] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:42:07] <ezyang> yeah, seems like a pretty common thing :) 
[06:42:19] <eddyb> it's actually a very nice trick, I plan to use it so that Option<~Decoder> gets a method to return Option<DecodeResult> and maybe invalidate the original Decoder (to free temporary data structures)
[06:42:24] <bblum> rusti: let mut x = Some(5); x.take_unwrap()
[06:42:25] -rusti- 5
[06:42:30] <benh> ah!
[06:42:47] <ezyang> It is a pretty annoying that in many cases, it's not possible to do it more safely than an unwrap(), since the pattern match results in a borrow that obstructs the take 
[06:42:47] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[06:42:48] <benh> oh, it's just .take().unwrap(), not magic :(
[06:43:19] <eddyb> benh: can reuse #[packed] for enums and deny taking a nested enum by reference
[06:43:41] <benh> hmm
[06:43:42] <ezyang> Follow follow up question: Is there a way to immediately trash a borrow (promising that I'll never use it later) so that I can take out a new borrow against the original pointer? 
[06:43:50] <o11c> eddyb: I can imagine that would often lead to Option<Option<DecodeResult>> ...
[06:43:51] <eddyb> OH, OH, I HAD AN IDEA. heh. I forget so many of them
[06:44:10] <benh> ezyang: }
[06:44:10] <benh> :(
[06:44:25] <ezyang> ok, so thread it out of the context and resume there... :-( 
[06:44:34] <benh> I'm not sure if there's a better way
[06:44:48] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[06:44:50] <ezyang> wait, crap, I can't do that, then my other branches are not in tail position anymore 
[06:45:02] <benh> I think the way the lifetime system works is that regions are lexical scopes?
[06:45:08] *** Joins: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com)
[06:45:34] <eddyb> o11c: well, no. you would keep Option<~Decoder> and Option<~DecodeResult> - you can always get a partial &'self DecodeResult from Decoder, but at some point, you get a Some(DecodeResult) which you rebox and stop using the decoder altogether
[06:46:19] <eddyb> ezyang: take moves, so I'm not sure what the borrow problem is
[06:46:28] <ezyang> eek, and I can't move the tail-calls in the other branches outside, because the borrows don't last long enough. 
[06:46:50] <ezyang> eddyb: Well, the problem here is the &mut I was going to take on? 
[06:46:53] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[06:46:53] <SiegeLord> You'd think that since &mut references move you'd be able to just do let _ = a;
[06:46:56] <ezyang> Yeah, I matched on it >_< 
[06:47:02] <SiegeLord> But I guess the borrow checker isn't smart enough for that
[06:47:31] <ezyang> (because I wanted to find out if it was None or Some) 
[06:47:45] <eddyb> ezyang: erm, I think I see what you mean. there's surely ways to do this
[06:47:58] *** Joins: lenstr (lenstr@B24129E9.9636F313.7A27613B.IP)
[06:48:20] <benh> yeah, turn back the clock and make everything a @ box and just bump the refcount instead of borrowing and freezing :>
[06:48:39] <eddyb> ezyang: {let mut x = None; swap(self, &x); x}
[06:48:55] *** Joins: findow (Mibbit@727894BC.3BD0D21.65B957D6.IP)
[06:49:00] <eddyb> since that's what this is, a swap
[06:49:15] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:49:17] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Quit: Leaving)
[06:49:22] <ezyang> benh: :< 
[06:49:24] <eddyb> well, &mut x, but you get the idea
[06:49:46] <eddyb> swap itself calls cast::forget on the temporary, to work around the borrow checker
[06:49:47] <findow> I heard of that the pointer type @ and ~ will be removed. true or false?
[06:50:00] <eddyb> @T is deprecated in favor of Gc<T>
[06:50:04] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[06:50:07] <eddyb> ~T is still a topic of discussion
[06:50:25] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[06:50:26] <benh> @ is already behind a feature gate, it's basically removed except no one got around to making the compiler work without it
[06:50:28] <eddyb> well, you would want to use Rc<T> most of the time instead of Gc<T>
[06:50:44] <ezyang> eddyb: Hm, so are you suggesting I use a swap to... no I don't see it 
[06:51:00] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[06:51:11] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:51:14] <eddyb> ezyang: you can't do let x = *self; *self = None; but look at it, it's a swap!
[06:51:18] <findow> the reason is for performance?
[06:51:41] <eddyb> findow: @T has garbage-collection semantics but uses ref-counting and is a total disaster
[06:51:49] *** Joins: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net)
[06:52:44] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[06:52:50] <ezyang> hmm, is that what I wanted here? Hmmmm 
[06:53:15] <ezyang> OK, so what I want to do is to swap out the value before I match on it 
[06:53:22] <ezyang> And then swap back in the thing I actually want? 
[06:53:27] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[06:53:41] <geomyidae> am  I supposed to have rust-bindgen generate stuff for u_char, u_long, etc?
[06:54:00] <ezyang> For concreteness, here is the code I am playing around with right now: http://lpaste.net/96814 
[06:54:00] <findow> eddyb so the safety improves after changes, right?
[06:54:18] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[06:54:39] <benh> man, ezyang's code looks way too much like real code instead of the toy examples i'm used to looking at in rust ;)
[06:54:49] <eddyb> findow: not safety. @T is not designed well, and soon enough we should be able to implement it completely in the library
[06:54:53] <myname> why is ~T a topic of discussion?
[06:55:01] <ezyang> benh: haha, whoops 
[06:55:09] *** Quits: skade (skade@moz-3DC698FE.pools.arcor-ip.net) (Quit: Textual IRC Client: www.textualapp.com)
[06:55:33] <benh> myname: sigils are now politically incorrect so there's interest in transitioning towards Uniq<T> or something
[06:55:49] <benh> and "box 42" for the ~value case seems pretty popular
[06:55:57] <myname> :(
[06:55:59] *** Joins: mib_dcpbkt (Mibbit@485A320A.C8FB44D6.16DF60A1.IP)
[06:55:59] <benh> (box(Rc) 42 etc for custom smartpointers)
[06:56:05] <myname> i liked ~
[06:56:20] <sfackler> it may stay as sugar for Uniq<T> or whatever
[06:56:26] <benh> (ezyang: is that out of ghc?)
[06:56:36] <ezyang> benh: Yep! 
[06:56:50] *** Quits: fournm (Aria@moz-ABB60BA0.austin.res.rr.com) (Quit: Leaving)
[06:57:00] <eddyb> ezyang: soooo (btw, gists look a little better because of syntax highlighting).... I'm not seeing where you want to assign
[06:57:09] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[06:57:09] <findow> ebbyb ok
[06:57:45] <ezyang> sorry, I'll gist it next time 
[06:57:46] <benh> (weren't we gonna throw out Either at some point?)
[06:57:55] <ezyang> right in the fail!("XXX") 
[06:58:10] *** Quits: mib_dcpbkt (Mibbit@485A320A.C8FB44D6.16DF60A1.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:58:10] <ezyang> I want to modify prev_link to remove the block from the free list 
[06:58:12] <eddyb> ezyang: but take and (put? put_back?) should work for that pattern (each of them is a swap)
[06:58:20] *** Quits: findow (Mibbit@727894BC.3BD0D21.65B957D6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:58:37] <myname> benh: for what reason, now?
[06:58:55] <benh> myname: something like "no one in the compiler used it" i believe
[06:58:57] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[06:59:08] <sfackler> and Left and Right are enormously undescriptive
[06:59:09] <myname> :S
[06:59:10] <benh> https://github.com/mozilla/rust/issues/9157
[06:59:11] <ezyang> eddyb: OK, I'll give it a try 
[06:59:23] <ezyang> sfackler: Sorry :) I'll code up an enum next time 
[06:59:24] <o11c> benh: that syntax looks ambiguous
[06:59:51] <benh> o11c: Apparently disambiguates towards the box(ThisIsAnAllocator) case
[07:00:17] <o11c> I don't like that adding parentheses around an expression can change the meaning
[07:00:20] <ezyang> hey, I can define enums in functions, yay 
[07:01:12] <eddyb> ezyang: thinking some more, maybe you want something crazy like foo.put(match foo.take { Some(bar) => if bar.moo() {None} else {Some(bar)}, None => None })
[07:01:19] <eddyb> ezyang: well, no. dammit, this is complicated
[07:01:25] <ezyang> No, because of the tail recursion 
[07:01:43] <ezyang> eddyb: btw, I posted the C code that is being ported, in case my current approach is obfuscating the intent 
[07:02:27] <sfackler> ezyang: you can put a bunch of stuff inside of a function, modules, functions, types, impls, use, etc
[07:02:34] <ezyang> \o/ 
[07:02:47] <benh> modules inside functions sound evil
[07:02:55] <benh> how can you `use` things in them?
[07:03:01] <ezyang> (random random question: is the Rust syntax highlighter for vim supposed to treat variadic enum constructors and nullary enum constructors differently?) 
[07:03:03] <eddyb> by putting use at the top of the function
[07:03:11] <sfackler> fn foo() { use something::bar; bar(); }
[07:03:12] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: bye!)
[07:03:14] *** Joins: newb (Mibbit@727894BC.3BD0D21.65B957D6.IP)
[07:03:17] <eddyb> use is block-scoped
[07:03:25] <eddyb> benh: but you know that, right?
[07:03:33] <benh> that's not what I mean, let me type it up
[07:04:02] <eddyb> it's going to be contrieved, isn't it?
[07:04:03] <sfackler> modules inside of functions aren't very useful except for rusti 
[07:04:20] <newb> would somebody explain how does Rust meet fast and safety at the same time?
[07:04:26] <sfackler> which is basically just "fn main() { println!("{}", { <YOUR CODE HERE> }); }" iirc
[07:04:34] <benh> I mean in fn main() { use something::bar; mod something { fn bar() {} } bar(); }
[07:04:35] <eddyb> ezyang: ok, I know
[07:04:43] <eddyb> ezyang: oh, someone said it already. heh
[07:04:48] <benh> the `use` doesn't work because it has to take an absolute path from the crate root
[07:05:01] <benh> but there's no path from the crate root to the mdule nested inside main(?)
[07:05:02] <sfackler> self::something::bar might work
[07:05:14] <eddyb> that's what I was about to say
[07:05:15] <benh> doesn't seem to
[07:05:21] <ezyang> eddyb: Hang on, what did someone say already? 
[07:05:22] <benh> self probably refers to the current mod
[07:05:26] <eddyb> ezyang: it's the let _ = bd; that doesn't work yet
[07:05:40] <eddyb> benh: oh that sucks. I didn't realize that was the case
[07:05:59] <ezyang> gotcha 
[07:06:06] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[07:06:17] <eddyb> ezyang: tail recursion is what makes your example tricky
[07:06:42] <ezyang> So, I'm not wedded to that. I did it because I couldn't get the borrow checker to behave with regards to prev_link as the iterator variable 
[07:06:53] <eddyb> ezyang: aaaand I know how to fix it :D. return early for all cases *but* the XXX one
[07:07:13] <ezyang> so, return go; and then have a continuation? 
[07:07:17] <ezyang> you clever bastard :) 
[07:07:20] *** Quits: newb (Mibbit@727894BC.3BD0D21.65B957D6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:07:27] <eddyb> ezyang: then you can just put *prev_link = None; return Left(*bd); at the end of the function
[07:07:33] <carter> ezyang: are you implmeenting some of the ghc GC in rust?
[07:07:45] <eddyb> since that's the case that didn't return early. it will work since you're no longer in the match scope
[07:07:48] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[07:07:48] *** Quits: benh (ben@moz-4A0366D2.org) (Ping timeout)
[07:07:56] <ezyang> I have no idea how far I'm going. This is just some (advisor-approved) fun, maybe I'll get some good ideas 
[07:08:02] <ezyang> yep 
[07:08:03] <carter> cool!
[07:08:18] <eddyb> ezyang: not sure what you mean by continuation though
[07:08:31] <ezyang> erm, the stuff that happens outside the match after 
[07:08:32] <carter> "callback"
[07:08:37] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:08:46] <carter> is another name
[07:08:47] <eddyb> since it's just regular control-flow
[07:08:57] <ezyang> yeah, I'm just thinking about how it'd get compiled 
[07:09:06] <carter> doesn't rust lack tail calls?
[07:09:15] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:09:16] <ezyang> guaranteed tail calls! 
[07:09:17] *** Joins: benh (i@moz-70A9C109.pool.mediaways.net)
[07:09:23] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[07:09:27] <ezyang> though, I have no clue if llvm will be able to figure this loop out. 
[07:09:30] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Ping timeout)
[07:09:31] <myname> won't llvm fix that like most of the time?
[07:10:08] *** Quits: lenstr (lenstr@B24129E9.9636F313.7A27613B.IP) (Client exited)
[07:10:14] <carter> wait, really?
[07:10:16] <myname> will llvm "fix" non-tail-recursive call into tail-recursive ones?
[07:10:32] <carter> ezyang: wait, rust does have tail calls?
[07:10:36] <carter> i thought it was a nope
[07:10:41] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[07:11:08] <benh> It doesn't have the very general tail recursion that some people apparently expect, but afaik it doesn't do worse than C
[07:11:09] <ezyang> Rust does not have guaranteed TCO 
[07:11:28] <ezyang> but apparently LLVM can help sometimes 
[07:11:28] <carter> yeah
[07:11:31] <carter> ohh
[07:11:36] <carter> for self calls?
[07:11:46] <eddyb> ezyang: https://gist.github.com/eddyb/f928b7ea44802d1a20d6
[07:12:08] <ezyang> I had just coded that up :) 
[07:12:11] <benh> self calls and calls to functions with identical signatures, i suppose
[07:12:19] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[07:12:31] <eddyb> ezyang: but I can't see that as a continuation, and it bugs me >_>
[07:12:37] <ezyang> well, your code has the wrong semantics, but it's just one swap 
[07:12:46] <ezyang> *extra 
[07:12:51] *** Joins: dd (chatzilla@F63B62E8.8AE8A320.7C0F3359.IP)
[07:12:57] <ezyang> eddyb: Well, it's only a continuation because there's a function call to go 
[07:13:04] <ezyang> I'm just too used to compiling Haskell in my head 
[07:14:26] <eddyb> well, asssuming TCO, return go is a jump, everything else is regular old control flow
[07:14:50] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[07:14:53] <ezyang> Yeah, that seems like a plausible compilation strategy for LLVM 
[07:15:20] <eddyb> *however*, call -> jump seems silly when it can be just loop-ified
[07:15:29] <ezyang> uh oh 
[07:15:34] <eddyb> (and further loop optimizations applied)
[07:15:42] <ezyang> "cannot borrow `*prev_link` as mutable more than once at a time" 
[07:15:43] <ezyang> Noooo 
[07:15:53] <ezyang> why did the previous borrow get hoisted up 
[07:16:05] <eddyb> ezyang: what are you trying to do outside the match case?
[07:16:27] *** Quits: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net) (Ping timeout)
[07:16:31] <ezyang> https://gist.github.com/ezyang/7886849 
[07:17:11] <eddyb> oooh, that looks better. you still have extra parens around your if conditions
[07:17:22] <ezyang> oh, is idiomatic rust to omit the parens? 
[07:17:26] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Hibernating, be back soon.)
[07:17:27] <eddyb> yes
[07:18:33] <eddyb> you can keep editing that gist, just tell me when to refresh
[07:18:50] <ezyang> oh boy, I can edit gists 
[07:18:53] <eddyb> the ; after the match case is also extraneous
[07:19:19] <eddyb> and you don't need "return" at the end of the function
[07:19:24] <ezyang> OK 
[07:19:29] <eddyb> so, uhm... why doesn't it work?
[07:19:39] <eddyb> ezyang: where's the first borrow reported at?
[07:19:41] *** Quits: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[07:19:45] *** Joins: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP)
[07:19:47] *** Quits: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[07:19:49] <benh> meh... if you use `return` on one function exit i'd probably use it for all of them
[07:19:52] <ezyang>  &Some(ref mut bd) 
[07:19:59] *** Joins: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com)
[07:20:00] <eddyb> right, that's it
[07:20:07] *** Joins: mib_hj7r41 (Mibbit@9BE163B0.70578880.F102451D.IP)
[07:20:08] <eddyb> ezyang: hehe, I know how to solve that. I think
[07:20:26] <eddyb> ezyang: move that condition to a pattern guard
[07:20:26] *** Quits: FreeFull (freefull@moz-79FD0D17.as13285.net) (Quit: )
[07:20:32] <mib_hj7r41> j
[07:20:34] <benh> isn't that that huge problem?
[07:20:39] <ChrisMorgan> ezyang: Rust convention uses snake_case for locals, functions and methods rather than camelCase.
[07:20:44] <benh> that caused the weird insert_or_update_with hashtable method?
[07:20:50] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[07:20:59] <ezyang> ChrisMorgan: duly noted 
[07:21:35] <eddyb> ezyang: so your early returns become &Some(ref mut bd)  if bd.meta.blocks as uint != n =>
[07:22:00] <ezyang> OK, let me try that 
[07:22:02] <benh> ... that is, the scope of this borrow isn't the lexical scope of the match, but the lifetime 'a which necessarily extends past the prev_link.take() outside the match, because it's part of the function signature?
[07:22:02] <eddyb> ezyang: and then you can probably even move the other case back in the match, since you removed the borrow
[07:22:05] <ezyang> Why do you think this will work? 
[07:22:33] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[07:22:48] <eddyb> ezyang: let me finish writing it :D
[07:23:11] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[07:23:19] <ezyang> benh: interpreting your comment 
[07:24:04] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[07:24:06] <eddyb> ezyang: it's a little crazy, but it should work https://gist.github.com/eddyb/7886876
[07:25:40] <ezyang> ok, let's give it a try 
[07:26:19] <eddyb> what I was saying earlier about the loop... calling go is letting the loop spin one more time, after updating some variables, returning (from all the other places) is breaking out the loop
[07:26:33] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[07:26:39] <ezyang> note the first Some case needs to bind bd, but I can bind it ref bd, I think 
[07:27:07] <eddyb> ezyang: hmmm
[07:27:59] <eddyb> ezyang: you can have a full pattern, like &Some(~Block {BlockMeta {blocks, ..} ..}) and it should then work
[07:28:02] <ezyang> OK, so with PerfectMatch still on the outside this works 
[07:28:24] <ezyang> It does not work on the inside though 
[07:28:48] <ezyang> oh, I see 
[07:28:58] <eddyb> ezyang: since none of those borrow, it just gets the value of blocks
[07:29:57] <eddyb> a loop would probably be easier (in some cases) to make sense of
[07:30:12] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:30:30] <eddyb> since you're traversing a linked list
[07:31:52] <eddyb> ezyang: I guess you'll be interested in the planned support for Gc<T>, some kind of Traceable madness
[07:32:19] <carter> whats that?
[07:32:37] <carter> (Gc<T>)
[07:33:09] <benh> If this is an allocator I'm not sure building it on top of a Gc is really the goal ;)
[07:33:27] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[07:34:36] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[07:35:05] <eddyb> benh: I meant ezyang could reuse the machinery that will make garbage collection possible. right now it's not really
[07:35:12] <eddyb> unless you go for something conservative
[07:36:00] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[07:37:10] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[07:37:11] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[07:37:24] *** Quits: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:38:01] <benh> ah :>
[07:38:07] <benh> sorry, i completely misunderstood ;)
[07:38:42] <benh> I'm still sad that the way that borrowing works is not matching our intuition in is example :(
[07:39:42] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:40:12] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[07:41:02] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:41:15] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[07:41:25] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[07:41:31] *** Quits: mib_47vhgd (Mibbit@moz-68235C3E.customer.broadstripe.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:42:21] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:43:04] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[07:44:02] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:48:26] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[07:48:58] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:49:21] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[07:49:23] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:51:33] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[07:51:55] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:52:54] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[07:53:15] <mcpherrin> Hello rustafarians, does anyone in the bay area have a DEC VT?
[07:53:40] <mcpherrin> Mine's not working (keyboard error) so I'd like to either test it with a different keyboard or the keyboard on a different VT
[07:56:52] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[07:57:53] *** Joins: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP)
[08:02:23] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[08:03:21] <eddyb> I remember someone mentioned typestates recently. I see what they mean, when I have relationships between 4 values and there's things one could assume (the entire structure has a constant enum value, and depending on that, some positions can be always a multiple of something)
[08:03:22] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[08:03:44] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[08:05:00] <eddyb> ehm, my bit magic is rusty, but how does this even work? (slightly offtopic) https://github.com/coapp-packages/libpng/blob/CoApp/pngwtran.c#L310-L317
[08:06:47] <ChrisMorgan> eddyb: I was probably the one that mentioned typestate. Bear in mind that in practice it wasn't as useful as it should have been, and you can do most of what it did by other means if desired (e.g. shadow generics such as File<Open> and File<Closed>)
[08:07:37] <ChrisMorgan> eddyb: what do you mean, how does it work? I'm not certain what you don't understand about it.
[08:07:41] <eddyb> when row_info->bit_depth == 8 and bit_depth->gray == 1 it should translate an array of bytes from 1 bit to 8 bits, i.e. 0 => 0 and 1 => 0xff
[08:07:41] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Ping timeout)
[08:08:10] <eddyb> I'm not seeing how shifting 1 can produce something which has all 8 lower bits set
[08:08:24] <ezyang> sorry, was afk for a bit 
[08:08:37] <eddyb> ChrisMorgan: OMG I'm stupid
[08:08:41] <ChrisMorgan> Signed overflow
[08:08:55] <eddyb> mnope. the loop actually runs 8 times
[08:09:01] <myname> i'd say |= is pretty relevant
[08:09:29] <ChrisMorgan> eddyb: yeah, I hadn't tried actually penetrating the logic yet.
[08:09:34] <eddyb> I thought the loop was over the shift_start/dec arrays
[08:09:40] <ChrisMorgan> Glad to have been a rubber ducky :-)
[08:10:00] * eddyb should have breakfast before attempting to write such complicated code
[08:10:11] <eddyb> well, I'm pretty sure I can do it better than that
[08:10:29] <strcat> ChrisMorgan: signed overflow is UB in C
[08:10:30] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[08:10:47] <TeXitoi> eddyb: (1 << 3) - 1 ?
[08:10:50] <ChrisMorgan> strcat: UB?
[08:10:56] <strcat> undefined behaviour
[08:11:05] <eddyb> TeXitoi: not really
[08:11:18] <ChrisMorgan> Really? I didn't know that.
[08:11:22] <strcat> gcc and llvm explicitly treat it as undefined and optimize with the assumption that it can't happen, too
[08:11:56] <strcat> LLVM has nsw (no-signed-wrap) and nuw (no-unsigned-wrap) for marking overflow as undefined, and C uses nsw on signed integer operations
[08:12:02] <ChrisMorgan> Curse C and its undefined behaviour…
[08:12:05] *** Quits: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Input/output error)
[08:12:43] <eddyb> so for 1-bit I have *0xff, 2-bit is *0x55, 4-bit is *0x11 and 8-bit is *0x01 (but that's different)
[08:13:01] <eddyb> hehe, those are the same as the masks they use when downsampling
[08:13:06] <ezyang> eddyb: Yes, you're right, doing the deep pattern match works 
[08:13:24] <strcat> for example, `for (int x = 0; opaque_condition(); x++) {}` does this terminate? it can be assumed it does, because otherwise `x` would overflow and that never happens in a valid C program
[08:13:29] <ezyang> It is too bad the borrow checker can't see through these equivalences 
[08:13:54] <eddyb> it probably needs some kind of escape analysis
[08:13:56] <ezyang> eddyb: Do you think it's possible to write this as a loop? I would quite like it if I could do it that way. 
[08:14:06] <eddyb> ezyang: it's actually really easy
[08:15:06] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[08:15:13] <eddyb> ezyang: anything you pass-through is an unchanged local variable. everything else is a mutated local variable. returns are breaks (or just returns from a function with the loop as its main body) and return go is just letting the loop spin again
[08:15:16] <ezyang> updated gist with latest working code 
[08:16:09] <eddyb> ezyang: this is actually what LLVM does in that case, if it doesn't go for a tail jump
[08:16:37] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[08:16:56] <ezyang> So, I may have done it wrong, but when I tried to write it in that style I had problems with the borrow checker 
[08:17:22] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[08:17:23] <geomyidae> I'm really confused, and Ive been reading too much about plants and animals and mammals and farms and cows :P
[08:17:54] <eddyb> ezyang: go is generic over the lifetime, which can be useful sometimes
[08:17:55] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Connection reset by peer)
[08:17:56] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[08:18:28] <eddyb> ezyang: but I don't think it's that because you return the result with the same lifetime
[08:18:47] <ezyang> well, when I last attempted it, managing the lifetime of prev_link was the biggest problem 
[08:18:52] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[08:19:44] *** sam113101 is now known as sam113101_afk
[08:19:55] <ezyang> heh, there's a take, but there's no put 
[08:19:59] *** sam113101_afk is now known as sam113101
[08:20:29] *** Quits: mib_hj7r41 (Mibbit@9BE163B0.70578880.F102451D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:20:31] *** Quits: dd (chatzilla@F63B62E8.8AE8A320.7C0F3359.IP) (Connection reset by peer)
[08:21:04] <eddyb> ezyang: well, put is just *self = value; *I think*
[08:21:14] <eddyb> ezyang: there might be something smarter which does a swap
[08:21:25] <ezyang> oh, it turns out I do need swap 
[08:21:37] <eddyb> ezyang: do you?
[08:21:40] *** benh is now known as benh_
[08:21:52] <eddyb> ezyang: when you loop, you need to change prev_link, not *prev_link
[08:21:57] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[08:21:58] *** Joins: benh (ben@moz-4A0366D2.org)
[08:22:02] *** Quits: benh_ (i@moz-70A9C109.pool.mediaways.net) (Quit: leaving)
[08:22:09] <eddyb> mut prev_link: &mut Whatever
[08:22:10] <ezyang> Sorry, I'm not working on the looping 
[08:22:14] <eddyb> eeeh ok
[08:22:16] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[08:22:24] <ezyang> So, the code I pasted has a bug: 
[08:22:32] <ezyang> when I get a PerfectMatch, it chops off the list wherever it is. 
[08:22:42] <eddyb> ah, I see
[08:22:42] <ezyang> So I need to do a pointer dance to stick the tail back onto prev-link 
[08:22:53] *** Quits: derek_c (derek@moz-31B7A1AE.cit.cornell.edu) (Ping timeout)
[08:22:54] <ezyang> I, uh, think that's a swap 
[08:23:41] <eddyb> oh, wow, while_some
[08:23:44] <ezyang> ok, got it 
[08:23:48] <eddyb> so much high-level goodness in here
[08:23:51] <ezyang> gist updated 
[08:24:47] <ezyang> OK, I guess I'll try to loopify this 
[08:24:55] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[08:24:56] <eddyb> ezyang: that's a shift, I think
[08:25:17] <eddyb> two swaps, one of the targets is initially None
[08:25:25] <ezyang> I don't see any applicable function in the stdlib which is named shift 
[08:25:33] <ezyang> but OK, if that's what it's called, I'll call it that :) 
[08:25:33] <eddyb> nah, just thinking out loud
[08:25:40] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[08:25:50] <eddyb> ezyang: or a rotate, rather
[08:26:49] <eddyb> let bd = None; swap(prev_link, bd); swap(prev_link, bd.link.p); bd
[08:27:01] <ezyang> aha! 
[08:27:19] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:27:40] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:28:38] *** Joins: rootnode (rootnode@moz-7FAB5E8.ip1.george24.com)
[08:28:40] <eddyb> so (bd.link.p, bd, prev_link) = (None, prev_link, bd.link.p)
[08:28:57] <ezyang> ...can yoou actually do that? 
[08:28:58] <eddyb> but you're using all 3 results, so it's not exactly a rotation
[08:29:05] *** Quits: cdidd (cdidd@moz-96E36BB0.broadband.corbina.ru) (Input/output error)
[08:29:10] <eddyb> ezyang: not really, just showing what happens
[08:29:26] <eddyb> *prev_link = bd.link.p.take();
[08:29:31] <eddyb> instead of the swap
[08:30:14] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:30:14] <ezyang> oh, should I use that? 
[08:30:19] <eddyb> yes
[08:30:48] <ezyang> cool-cakes 
[08:31:01] * eddyb should've figured that out. since it's really removing from a linked list
[08:31:26] *** Joins: cdidd (cdidd@moz-DAECF479.broadband.corbina.ru)
[08:32:06] <eddyb> you would technically want a high level replace function, so you can do prev_link.replace(|bd| bd.link.p.take()) (and it would return bd)
[08:32:08] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[08:32:25] <ezyang> I can code one of those up easy 
[08:32:46] <ezyang> Hmm, I can't break with a return value 
[08:33:04] <eddyb> ezyang: you would either set a local and break or return directly
[08:33:29] <eddyb> mutate *almost* does the job
[08:33:44] *** Joins: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch)
[08:34:19] <eddyb> but the take_unwrap() and the second assignment with take() should be enough
[08:34:41] * eddyb likes to fiddle with high-level constructs
[08:35:14] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[08:35:35] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[08:36:29] <ezyang> ok, here's the stupid first version 
[08:36:35] <ezyang> gist updated 
[08:36:46] <eddyb> that reminds me I could try to work on a LLVM patch to optimize things like fn fib(i: uint) {if i < 2 {i} else {fib(i-1) + fib(i-2)}} into an a loop with N / 2 iterations
[08:37:18] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[08:37:41] <eddyb> ezyang: looks good
[08:37:47] <ezyang> well, it doesn't borrow-check ;) 
[08:37:56] <eddyb> eeeeh. what now?
[08:38:03] <ezyang> (on the bottom) 
[08:38:20] <myname> eddyb: how'd you do that?
[08:38:21] <ezyang> borrow checker thinks the "let mut bd" is a second borrow from the &Some(ref mut bd) pattern match 
[08:38:43] <ezyang> which is kind of weird, since they're on different control paths 
[08:39:58] <eddyb> myname: I've written about it before, it's a context "shift" (or rotate), which requires N * M operations (where M is 2 here) but it can be optimized into a loop which does M operations and has N / M iterations
[08:40:10] *** Joins: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net)
[08:40:44] <eddyb> ezyang: try to not borrow it, then
[08:40:45] <killerswan> ok, so `--test-shard` is an awesome parameter
[08:40:58] <eddyb> ezyang: nvm
[08:41:05] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[08:41:09] <ezyang> uh, I don't think I can manage that ;-) 
[08:41:09] <eddyb> I can't see a way to fix that problem
[08:41:35] <ezyang> ok, back to the tail-recursive version we go! 
[08:42:44] <eddyb> ezyang: but how did that work?
[08:42:48] <eddyb> it's the same... problem. I think
[08:42:52] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[08:42:52] <ezyang> The tail recursive version? 
[08:42:59] <ezyang> hmmmm 
[08:43:16] *** Joins: dd (chatzilla@F63B62E8.8AE8A320.7C0F3359.IP)
[08:43:19] <ezyang> I bet... 
[08:43:25] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:43:27] <ezyang> The borrow checker is getting confused by the loop 
[08:43:29] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[08:43:35] <ezyang> and that the "reuse" is actually over two different loop iterations 
[08:43:36] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[08:44:01] <ezyang> I filed a different bug about this: https://github.com/mozilla/rust/issues/10876 
[08:44:16] <eddyb> myname: so f(i) = g(f(i - 1), f(i - 2), ..., f(i -k)) is actually a range(0, i).reduce((f(0), f(1), .., f(k - 1)), |(x1, x2, ..., xk)| (x2, .., xk, g(x1, x2, ..., xk)))
[08:45:39] <eddyb> myname: which is that costly context rotation thing that you can optimize to a loop which does k applications of g, one for each slot of the k-sized context
[08:48:30] *** Joins: fabiand (fabiand@moz-C3EB22E8.adsl.alicedsl.de)
[08:49:02] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[08:49:31] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[08:50:14] <WebeWizard> is Path.is_file(), Path.exists(), etc being removed? It still compiles, but it's not in the master doc
[08:50:37] *** flaper87|afk is now known as flaper87
[08:53:01] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[08:53:31] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[08:55:15] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[08:56:21] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[08:56:36] *** Joins: Ferreus (ferreus@moz-7C671BF4.dip0.t-ipconnect.de)
[08:57:35] *** Joins: derek_c (derek@moz-31B7A1AE.cit.cornell.edu)
[08:58:38] *** Quits: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com) (Quit: Lost terminal)
[09:00:18] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[09:00:58] *** Joins: shmoo (Mibbit@moz-8880FE99.hsd1.ca.comcast.net)
[09:01:04] *** Joins: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr)
[09:01:15] *** Parts: shmoo (Mibbit@moz-8880FE99.hsd1.ca.comcast.net) ()
[09:02:31] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Input/output error)
[09:02:39] * ezyang is about to do something incredibly unsafe 
[09:08:40] <derek_c> say I'm given a string S and a variable V.  I want to access V's field whose name is S.  How can I do that?
[09:09:33] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[09:09:35] <ezyang> V.S? 
[09:09:45] <ezyang> oh, I see, it's a string 
[09:09:48] <ezyang> "use a hashtable" 
[09:10:25] *** Joins: mib_q3slhk (Mibbit@8CA41291.DAD92AC8.D216A595.IP)
[09:10:28] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[09:11:56] *** Quits: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[09:12:18] <derek_c> ezyang: not suitable for my purpose
[09:12:23] <derek_c> guess there is no way?
[09:12:33] <pnkfelix> derek_c: rust does not really have a reflection facility
[09:12:53] <ezyang> you could manually compute the table 
[09:13:24] <pnkfelix> derek_c: (a lot of the necessary pieces are there, e.g. we keep around much of the necessary metadata to support `format!("{:?}", x)` )
[09:13:49] <ezyang> I wish there was a "you need to have FOO lock taken out to call this function" static check in Rust 
[09:14:04] <derek_c> pnkfelix: I see. thanks :)
[09:14:40] *** Joins: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de)
[09:14:47] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Quit: Leaving.)
[09:18:26] <dbaupp> killerswan: what does --test-shard do?
[09:19:12] <dbaupp> ezyang: you could have it as a method on an object that is returned by a function that takes that lock
[09:19:30] <dbaupp> (and have the lock released in the dtor of that object)
[09:20:19] <Yurume> derek_c: why do you need that? are you writing some sort of... Java beans? ;)
[09:20:44] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[09:20:54] <killerswan> when you build tests, that's one of the flags available to your test binary
[09:21:08] <killerswan> and so you can specify a fraction of your tests to run
[09:21:09] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:21:35] <dbaupp> killerswan: oh, so you can parallelise the runs across machines; makes sense.
[09:22:34] *** Joins: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[09:23:14] <killerswan> something like that (although it may drop benchmarks and I will probably file that bug :D)
[09:24:08] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[09:24:19] *** Quits: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Ping timeout)
[09:26:25] *** Joins: oberstet (quassel@moz-F75409F7.dynamic.mnet-online.de)
[09:29:52] <ezyang> dbaupp: oh, nifty idea! 
[09:30:41] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[09:32:54] <dbaupp> ezyang: you probably want something like `struct Whatever { priv x: () }` so that it can't be constructed outside that module.
[09:32:59] *** Quits: mib_q3slhk (Mibbit@8CA41291.DAD92AC8.D216A595.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:33:14] *** Joins: smarty (Mibbit@F63B62E8.8AE8A320.7C0F3359.IP)
[09:34:07] <ezyang> I can also just have a function require a reference to the lock object to be passed to it, right? 
[09:34:43] *** Quits: Kxepal (Miranda@moz-BEA1ED22.pppoe.mtu-net.ru) (Ping timeout)
[09:35:07] *** Joins: rca (rcatolino@7F54AB21.28091F66.520D6FA6.IP)
[09:35:24] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:35:54] <dbaupp> ezyang: well, a combination of both, I think
[09:36:13] *** Joins: beifeng (Mibbit@90BAFE10.A765EABF.C7DB8B78.IP)
[09:36:29] <dbaupp> i.e. fn something(x: &LockObject), but you want to guarantee that someone can't just magic up a LockObject to pass to something.
[09:36:40] <ezyang> oh yes, still need the priv 
[09:37:28] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[09:38:16] *** Joins: Kxepal (Miranda@moz-84D27387.pppoe.mtu-net.ru)
[09:38:37] *** Quits: nfroidure (nfroidure@moz-318AEEBC.w90-18.abo.wanadoo.fr) (Quit: Ex-Chat)
[09:39:09] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[09:40:57] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[09:43:06] *** Quits: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch) (Input/output error)
[09:47:07] <ezyang> Hmm, is Rust's type-system strong enough to support multiple lock objects, by some existential quantification or rank-2 polymorphism? 
[09:47:24] <ezyang> so, you create some data and the corresponding lock, and only that lock can be used for that data. 
[09:49:39] *** Quits: fabiand (fabiand@moz-C3EB22E8.adsl.alicedsl.de) (Quit: Verlassend)
[09:50:36] *** Joins: nfroidure (nfroidure@moz-318AEEBC.w90-18.abo.wanadoo.fr)
[09:50:41] <pradeep> ~/quit
[09:50:42] *** Quits: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[09:51:30] <dbaupp> ezyang: we have existentials via trait objects, but not rank-2 generics
[09:52:03] <dbaupp> ezyang: i'm not sure I understand your question well enough to be able to say anything more.
[09:52:37] <ezyang> So, essentially, suppose you need to create a managed mutable box which needs you to take out a lock before you edit it 
[09:53:01] <ezyang> So you want a function create :: (@Box, ~Lock) 
[09:53:22] <ezyang> But if Lock is that simple type, then I can use any lock created this way to synchronize any other box created this way 
[09:53:56] *** Quits: derek_c (derek@moz-31B7A1AE.cit.cornell.edu) (Quit: Leaving)
[09:54:10] <ezyang> So, traits are probably not strong enough 
[09:54:20] <ezyang> (note this is all academic and I'm sure there are other ways of pulling this off) 
[09:54:58] <dbaupp> hm
[09:55:00] * dbaupp thinks
[09:55:39] <dbaupp> Why not Locked<@Box>, or something of that ilk?
[09:55:56] <ezyang> Why, because it could escape, of course :) 
[09:56:00] <ezyang> @Locked<Box> would probably DTRT 
[09:56:02] *** Quits: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de) (Ping timeout)
[09:56:18] <dbaupp> ah, yes, @ doesn't play nice.
[09:58:03] *** Joins: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de)
[09:59:10] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[09:59:45] *** Quits: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de) (Ping timeout)
[10:00:56] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[10:01:40] <eddyb> ezyang: I think ArcMutex in rust-core does something like that
[10:02:02] *** Joins: nkoep (nik@moz-D34D8194.pool.mediaways.net)
[10:02:37] <eddyb> but I don't even know if it's complete yet
[10:03:08] <ezyang> hm 
[10:03:21] *** Joins: fabiand (fabiand@moz-C3EB22E8.adsl.alicedsl.de)
[10:03:25] <eddyb> and less of a clue about std
[10:03:47] <eddyb> ezyang: but you need Arc, don't you?
[10:04:10] <ezyang> I actually don't have any need atm, I'm just thinking about it because I know I eventually will 
[10:04:39] <eddyb> do you need this for cross-task/thread shareability?
[10:04:54] <eddyb> or just some recursive thing?
[10:04:57] <ezyang> The immediate itch is global state 
[10:05:01] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[10:05:04] <ezyang> but then I started wondering about it in general 
[10:05:13] *** kimundi is now known as zz_kimundi
[10:05:28] <eddyb> Rc<RefCell<T>> is safe, but not shareable
[10:06:05] <eddyb> (and mutable, since you seem to want that)
[10:06:40] <eddyb> ezyang: also see RWArc for safe mutable and shareable
[10:07:19] <ezyang> ok, time to go to bed 
[10:07:34] <eddyb> sleep well
[10:07:38] <ezyang> I think I will try to write a extended tutorial on linked lists for my blog; post it here first by you guys :) 
[10:07:47] <eddyb> ezyang: and don't let the race bugs bite!
[10:08:02] <ezyang> there's heisenbugs in my, oh wait, maybe not! 
[10:08:40] <eddyb> ezyang: btw, I have a thread-safe allocator, not very different from your list thing, using atomic operations
[10:09:03] *** Quits: smarty (Mibbit@F63B62E8.8AE8A320.7C0F3359.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:09:08] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Quit: Leaving.)
[10:09:22] <eddyb> but size classes are easier to deal with than "best fit"
[10:10:18] <eddyb> ezyang: you might want thread-local allocation pools, with the result of the allocation being safe to free from a different thread
[10:11:49] <eddyb> the allocator I was talking about actually has one partial free list per CPU, so multicore environments don't need synchronization
[10:13:37] *** Quits: dd (chatzilla@F63B62E8.8AE8A320.7C0F3359.IP) (Ping timeout)
[10:14:55] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[10:15:57] *** Joins: dd (chatzilla@9BE163B0.70578880.F102451D.IP)
[10:17:49] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[10:19:57] *** Joins: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de)
[10:20:22] *** Quits: dd (chatzilla@9BE163B0.70578880.F102451D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131115110315])
[10:21:05] *** Joins: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch)
[10:22:48] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[10:23:15] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[10:23:57] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[10:26:09] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[10:26:56] *** Quits: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de) (Ping timeout)
[10:26:57] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[10:28:08] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Quit: Leaving.)
[10:28:28] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[10:28:33] *** Joins: peterdn (chatzilla@moz-3DA3F15F.as13285.net)
[10:29:03] *** Joins: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de)
[10:29:09] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[10:31:02] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[10:31:08] *** Joins: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP)
[10:31:11] *** Joins: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp)
[10:33:37] *** Quits: jviereck (Adium@moz-EBEE827D.dip0.t-ipconnect.de) (Ping timeout)
[10:35:51] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[10:38:17] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[10:38:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[10:38:43] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[10:40:11] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[10:40:34] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[10:42:25] *** Joins: mr_pants (Mibbit@moz-23C212B0.dynamic.qsc.de)
[10:42:35] <mr_pants> Is there an X11 wrapper for rust?
[10:46:55] *** Quits: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP) (Ping timeout)
[10:47:39] <cmr> mr_pants: https://github.com/Aatch/rust-xcb
[10:48:31] <dbaupp> (that hasn't been updated for 5 months, so won't work out of the box.)
[10:48:40] <mr_pants> Unfortunately xcb has no docs. I'm more interested in an xlib wrapper.
[10:48:52] <cmr> xlib is just a wrapper for xcb :P
[10:49:08] <cmr> one doesn't exist to my knowledge. wrap what you need, I guess
[10:49:24] <cmr> (and the docs are the protocol docs)
[10:49:27] <eddyb> what should I use for a function pointer? ptr::null() doesn't cast to extern "C" fn
[10:49:41] <cmr> eddyb: it transmutes to one though
[10:49:49] <eddyb> eeeehm
[10:50:06] <cmr> *nothing* casts to a function pointer
[10:50:08] <dbaupp> eddyb: if you need a nullable extern fn, Option<extern "C" fn>
[10:50:11] <eddyb> http://static.rust-lang.org/doc/master/std/ptr/externfnpointers/index.html
[10:50:31] <dbaupp> eddyb: wat?
[10:50:32] <eddyb> that was linked from the search :(
[10:50:43] <dbaupp> file a bug
[10:50:58] <cmr> cc me
[10:51:03] <eddyb> I guess the search found something that's not there
[10:51:17] <cmr> well, it's there.
[10:51:30] <cmr> the fact that it isn't getting an index page is a bug
[10:51:36] <dbaupp> it's private
[10:52:10] <cmr> hm, we aren't generating anything for private stuff anymore
[10:52:21] <dbaupp> rusti: extern "C" fn f() {} extern "C" fn g() {} (f == g, f == f,  g == g)
[10:52:22] -rusti- (false, true, true)
[10:52:37] <dbaupp> rusti: extern "system" fn f() {} extern "system" fn g() {} (f == g, f == f,  g == g)
[10:52:38] -rusti- pastebinned 8 lines of output: http://sprunge.us/EhIL
[10:52:50] <dbaupp> oh
[10:52:57] * dbaupp though 'system' was a valid ABI
[10:53:01] <cmr> it is, on master
[10:53:07] <dbaupp> ah
[10:53:11] *** Joins: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com)
[10:53:18] <dbaupp> rusti: fn f() {} fn g() {} (f == g, f == f,  g == g)
[10:53:19] -rusti- pastebinned 11 lines of output: http://sprunge.us/ZEfg
[10:53:28] <eddyb> should externfnpointers it be pub?
[10:53:30] <eddyb> s/it//
[10:53:37] <eddyb> I'm not sure what's going on
[10:53:38] <cmr> no, doesn't need to be.
[10:53:40] <cmr> it's just impls.
[10:54:13] *** Joins: Ms2ger (Ms2ger@moz-664B2345.ugent.be)
[10:55:05] *** Joins: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il)
[10:56:06] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[10:56:45] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[10:57:30] <eddyb> there
[10:57:38] <mr_pants> cmr: The protocol being the docs doesn't really help me when the official docs contain essential links that go to 404 and comments like "here we should document which arguments can be passed"....
[10:57:42] <eddyb> dbaupp: https://github.com/mozilla/rust/issues/10899 fwiw
[10:58:05] <cmr> mr_pants: I mean, the XML has everything that is valid.
[10:58:14] <cmr> X isn't all that great in general
[10:58:16] *** Joins: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP)
[10:58:26] <cmr> but I don't think it has a doc problem.
[10:59:07] <mr_pants> no? http://xcb.freedesktop.org/XcbUtil/ "The online API documentation can be found ---> here <---"
[11:09:25] <benh> 404 :D
[11:09:46] <mr_pants> I sometimes see code like this: let (a, b) = f(); let a = ~a; Isn't this redefining the type of a? Is the new a shadowing the old one? Why is this allowed?
[11:10:32] <benh> mr_pants: it's a new variable, it can have whatever type it wants. We like shadowing, so it's allowed. :)
[11:10:44] <cmr> mr_pants: it's called a "rebinding". It does redefine the type, but it's a new binding (variable), so it's fine
[11:10:58] <benh> Particularly popular special case let mut x = ....; mutate x a bit; let x = x; now it's not mutable anymore
[11:13:07] <mr_pants> How is the state of editor integration? Are there plans for something like syntastic+libclang for rust?
[11:13:17] <cmr> Syntastic already works for rust
[11:13:45] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[11:14:22] <friggle> cmr: I'm not sure about the comment on your etherpad that fixing rusti just needs opting in to native I/O in rustc
[11:14:40] <friggle> cmr: my understanding is that even if it "works" as before, it still needs a major rethink to be what people expect from a repl
[11:14:51] <cmr> friggle: I didn't say that it did.
[11:14:59] <cmr> And I'm not talking about that rusti
[11:15:04] <cmr> I mean rusti-the-bot
[11:15:21] <friggle> cmr: ah, thanks for clearing up
[11:15:48] *** Quits: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net) (Quit: killerswan)
[11:16:02] <dbaupp> mr_pants: the current design of the compiler doesn't lend itself to a libclang style binding, unfortunately. :(
[11:16:36] <cmr> syntastic uses rustc --parse-only
[11:16:56] <mr_pants> cmr: It doesn't really work for me besides the basic "give me all identifiers that start with these letters".
[11:17:13] <cmr> mr_pants: eh? syntastic is syntax error highlighting, not completion.
[11:17:22] <mr_pants> ah, you are right
[11:17:41] <mr_pants> I meant youcompleteme
[11:17:43] <cmr> mm
[11:17:51] <dbaupp> does --parse-only expand macros?
[11:18:28] <cmr> dbaupp: no
[11:18:36] <dbaupp> cmr: good
[11:19:09] <mr_pants> Something like this: http://i.imgur.com/8xMApxf.gif
[11:19:15] <cmr> mr_pants: proper completion isn't going to happen anytime soon, the compiler isn't structured for it. requires lots of really hard things like partial parsing.
[11:19:26] <cmr> there *is* ctags support though.
[11:19:43] <cmr> And generating a list of things that can be completed out of a crate that already compiles is near trivial.
[11:19:53] <cmr> (the rustdoc json could be used for that)
[11:21:03] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[11:21:26] *** zz_kimundi is now known as kimundi
[11:21:49] <eddyb> the only C++ IDE with decent completion support (and other fancy things) that I've used is kdevelop4
[11:22:20] <cmr> which pales in comparison to visual studio :p
[11:22:48] <eddyb> I don't know what's with Java, probably its triviality, that makes all Java IDEs quite lovely to use (if you ignore the language)
[11:22:51] <eddyb> cmr: does it?
[11:23:03] <cmr> yes
[11:23:39] <eddyb> that's... unexpected - what does VS have that kdevelop doesn't? is there some kind of comparison somewhere?
[11:23:59] <cmr> it just works better, more complete and polished.
[11:24:16] <dbaupp> eddyb: probably also because the only way to write Java and avoid RSI is to have an IDE that does 90% of the typing for you, so people have put effort into them. :P
[11:24:28] <cmr> why is it unexpected? people pay $10k/yr for visual studio :p
[11:24:54] <eddyb> dbaupp: compare a Java parser with a C++ one, for example
[11:25:10] <eddyb> that's what I've hit when I tried to make my own code refactoring tool
[11:25:21] <dbaupp> eddyb: stop bringing logic to the flamewar. :P
[11:26:01] <eddyb> cmr: just personal experience, I take it?
[11:26:07] <cmr> eddyb: it's not really subject
[11:26:09] <cmr> ive
[11:26:12] <cmr> how well the autocompletion works
[11:26:29] <eddyb> well... it works
[11:26:34] <cmr> but yes
[11:27:05] <eddyb> it actually hit me in the face when I opened C++ file, having worked in Rust for some time now
[11:27:44] <eddyb> *a C++ file
[11:29:11] <eddyb> oh, that's sad, I forgot I disabled parsing in this session just so I don't have to deal with background jobs and magic-whatever misidentifying rust code as C++
[11:29:27] <eddyb> so I can't fool around with it just to tell you how good it is
[11:29:56] <eddyb> cmr: I don't remember VS coloring identifiers
[11:30:24] <cmr> erm, your memory is definitely flawwed, unless you were using a truly ancient VS
[11:30:30] <eddyb> like, one color per defined identifier
[11:31:06] <eddyb> cmr: this laptop hasn't had windows on it, ever. that's 3 years +
[11:31:07] <cmr> each identifier gets its own color?
[11:31:45] <eddyb> cmr: yeah. so int len = vec.len(); would have different colors for the two len's
[11:31:55] <cmr> anyway I don't mean to fanboy VS, it's just a very nice C++ IDE
[11:32:02] <cmr> I don't remember if it does that either
[11:32:09] <cmr> I thought you meant any identifier at all
[11:32:37] <eddyb> uhm, no, nano and kwrite can do that :P
[11:32:41] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Quit: 전 이만 갑니다.)
[11:32:45] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[11:32:52] <eddyb> any two semantically identical identifiers, let's say
[11:33:04] <eddyb> wait, rust has a perfect name for this: absolute paths :P
[11:34:22] <eddyb> cmr: it was actually coloring some Rust code which was mis-identified as C++. I have to look some time into its C++ parsing backend, maybe I can easily wrap rustc in a module
[11:34:50] <eddyb> no idea how ctags works, but it has that, I might try that at some point, too
[11:34:55] <eddyb> I should make a TODO list dammit
[11:35:06] <cmr> etherpad is good for that ;p
[11:35:28] <dbaupp> eddyb: here's a good TODO list https://etherpad.mozilla.org/dVXGixuou0
[11:35:40] <dbaupp> they might even get done for you :P
[11:36:05] <dbaupp> cmr: (two listings of regex support!)
[11:36:09] <eddyb> I have an addition and an entry
[11:36:16] <cmr> ssbr: get cracking!
[11:36:39] <eddyb> dbaupp: uhm, where?
[11:37:05] <dbaupp> eddyb: "look into #3591" and "- regexp support"
[11:37:08] <eddyb> ahaha
[11:37:54] <dbaupp> cmr: did we really already try using native for rusti?
[11:37:57] <cmr> yes
[11:37:59] <cmr> last night
[11:38:04] <cmr> well, #[no_uv];
[11:38:14] <dbaupp> i.e. on rustc itself?
[11:38:25] <cmr> oh, hm
[11:38:40] <dbaupp> since the problem is the actual compiler invocation failing, aiui
[11:38:51] <cmr> I don't remember
[11:39:21] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[11:39:26] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[11:39:45] <cmr> I might write something simple like lua's patterns, re regex.
[11:39:54] <eddyb> please compile. I've fixed enough syntax errors already
[11:40:39] <eddyb> this is what I get for not writing tests first - I can't check a partial implementation so I went ahead and wrote it all down
[11:41:08] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[11:41:27] <dbaupp> eddyb: you can write tests now, right?
[11:41:39] <eddyb> dbaupp: yeah, after it compiles ^_^
[11:41:54] *** Quits: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il) (Ping timeout)
[11:41:54] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[11:45:00] <eddyb> dbaupp: I know I have an entire function with closures that won't borrow-check
[11:45:41] <eddyb> I'm so used to JS where you can just add twenty utility closures and make your life easy
[11:46:24] *** Quits: Ms2ger (Ms2ger@moz-664B2345.ugent.be) (Ping timeout)
[11:47:31] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[11:48:00] <eddyb> dbaupp: wait, no errors yet... can I capture a mutable local into multiple closures?
[11:48:23] *** Joins: vmx (vmx@moz-4923A51.dip0.t-ipconnect.de)
[11:48:36] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:48:47] <cmr> rusti: let mut x = 5; let y = || x += 5; let z = || x += 10; y(); z(); x
[11:48:48] -rusti- 20
[11:49:15] <eddyb> yes! :D
[11:49:19] *** Quits: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp) (Ping timeout)
[11:49:22] *** Joins: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp)
[11:50:04] <eddyb> cmr: I guess the rules are more relaxed than &mut. I was hoping for that, so I left the code in its abusive state :P
[11:52:06] <cmr> rusti: let mut x = 5; let y = || x += 5; let z = || y(); y(); z(); x
[11:52:07] -rusti- 15
[11:52:24] <cmr> I wonder if that is supposed to work.
[11:52:49] <cmr> rusti: let mut x = 5; let y = || x += 5; let z = || y(); let a = &x; y(); z(); x
[11:52:50] -rusti- <anon>:9:62: 9:63 warning: unused variable: `a` [-W unused-variable (default)]
[11:52:50] -rusti- <anon>:9         let mut x = 5; let y = || x += 5; let z = || y(); let a = &x; y(); z(); x
[11:52:51] -rusti-                                                                        ^
[11:52:51] -rusti- 15
[11:53:15] <cmr> I wonder if that only works because x isn't affine
[11:53:25] <cmr> nmatsakis: ^ is that broken?
[11:53:48] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[11:54:28] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:54:49] <eddyb> png.rs:684:12: 684:41 error: cannot move out of dereference of & pointer
[11:54:51] <eddyb> why :(
[11:55:27] <eddyb> oh wow, I've written over 800 lines for this
[11:56:24] <eddyb> I don't see what it means, because the pattern is: IdatInflate(left, mut stream) => {
[11:57:07] <eddyb> oh, the match is over self.state, where self is &mut
[11:57:19] <eddyb> this kind of thing is really confusing
[11:57:33] <pnkfelix> cmr: nmatsakis has said in the past that he needs to represent &const borrows in rustc (even if we don't offer that kind of borrow in the language) because of something with closures.  I wonder if what you are seeing here are &const borrows?
[11:58:26] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[11:58:30] <cmr> pnkfelix: surely not, since it is still mutable through that reference? I thought &const meant "mutable but not through me"
[11:58:38] <eddyb> rusti: let mut x = 5; let y = || x += 5; let z = || y(); let a = &mut x; y(); z(); x
[11:58:38] -rusti- <anon>:9:62: 9:63 warning: unused variable: `a` [-W unused-variable (default)]
[11:58:39] -rusti- <anon>:9         let mut x = 5; let y = || x += 5; let z = || y(); let a = &mut x; y(); z(); x
[11:58:39] *** Joins: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca)
[11:58:39] -rusti-                                                                        ^
[11:58:39] -rusti- 15
[11:58:46] <eddyb> O_O
[11:59:25] <pnkfelix> cmr: Hmm, I had stepped ahead of your example and had tried to make concrete aliases, so I guess they were the &const's I was thinking of
[11:59:26] <cmr> rusti: let mut x = 5; let y = |zzz: &mut int| *zzz += x; y(&mut x)
[11:59:27] -rusti- ()
[11:59:30] <cmr> rusti: let mut x = 5; let y = |zzz: &mut int| *zzz += x; y(&mut x); x
[11:59:30] <pnkfelix> cmr: liek this:
[11:59:31] -rusti- 10
[11:59:36] <cmr> That is assuredly broken.
[11:59:37] <pnkfelix> rusti: let mut x = 5; let y = || x += 5; let z = || y(); let _a = &x; let _w = || _a; let x1 = *_w(); y(); let x2 = *_w(); z(); [x1, x2, x]
[11:59:37] -rusti- [5, 10, 15]
[11:59:54] <cmr> hm
[12:00:08] <pnkfelix> cmr: ah, your example does look broken
[12:00:11] <eddyb> cmr: you didn't capture x as mutable in the closure
[12:00:23] <cmr> rusti: let mut x = 5; let y = |zzz: &mut int| x += *zzz; y(&mut x); x
[12:00:24] -rusti- 10
[12:00:37] <eddyb> that surely breaks aliasing
[12:00:56] * eddyb wonders if this is fixed in master
[12:00:57] <pnkfelix> rusti: version
[12:00:58] -rusti- "rustc 0.8"
[12:01:41] *** Joins: jensnockert (jensnocker@moz-250D9518.wireless.lu.se)
[12:02:20] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[12:02:31] <eddyb> just because of one ~ ptr, I now have to redesign the structure of this entire thing
[12:02:51] <cmr> that's how ownership works, yup :)
[12:02:52] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[12:03:36] <eddyb> do we have a non-Option-based primitive to ... no, that wouldn't work. swap requires you something to put in its place
[12:03:57] <cmr> uninit() is a thing
[12:04:01] <eddyb> state: Option<State> feels too derpy. but I guess I can use that to signal that it finished
[12:04:22] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[12:04:26] <eddyb> cmr: no, because other code can actually (while it doesn't) access that value
[12:05:20] <eddyb> I guess I'll have something like self.state.mutate(|state| self.next_state(state, data));
[12:06:40] <dbaupp> rusti: let mut x = 5; let y = |zzz: &mut int| (&mut x, zzz); println!("{:?}", y(&mut x))
[12:06:41] -rusti- pastebinned 101 lines of output: http://sprunge.us/hLTj
[12:06:50] <dbaupp> 101 o_O
[12:07:12] <eddyb> because format!
[12:07:28] <eddyb> wait, what?
[12:07:39] <eddyb> why would println! use format!? that's silly
[12:08:00] <cmr> what
[12:08:03] <cmr> why wouldn't it
[12:08:04] <eddyb> print! and println! should use write!
[12:08:07] <cmr> that's the whole point of println!
[12:08:19] <eddyb> which doesn't allocate an intermediary string
[12:08:46] <cmr> well, they use format_args on master
[12:09:41] <cmr> (directly, not through format!)
[12:10:00] *** Joins: mib_laenkt (Mibbit@C6F22A9A.1C233438.79933D60.IP)
[12:10:14] *** Quits: mib_laenkt (Mibbit@C6F22A9A.1C233438.79933D60.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:12:02] <sanxiyn> Is there a writeup on Rust's replacable event loop mechanism?
[12:12:27] <cmr> sanxiyn: I don't think so
[12:12:38] <cmr> convince acrichto to write some docs
[12:12:52] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[12:13:56] <sanxiyn> (Doc could build a simple example, say, beginning of event loop using glib)
[12:16:00] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[12:16:16] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[12:18:53] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[12:19:20] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[12:23:37] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[12:24:25] *** Joins: morphevs1 (Adium@moz-EC7BBA41.uzh.ch)
[12:24:25] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Connection reset by peer)
[12:25:50] *** Quits: mr_pants (Mibbit@moz-23C212B0.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[12:26:37] <TobiasFar> is there a way to write C accessible libraries in Rust?
[12:26:48] <cmr> TobiasFar: sure
[12:26:53] <cmr> #[no_mangle]
[12:27:06] <cmr> extern "C" fn accessible_from_c() { ... }
[12:27:21] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[12:27:29] <TobiasFar> cmr: will give that a try, thanks
[12:27:52] <dbaupp> TobiasFar, cmr: that should be `pub extern "C" ...`
[12:27:56] <cmr> ah, yes.
[12:28:00] <dbaupp> (aiui)
[12:28:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[12:34:55] *** Quits: morphevs1 (Adium@moz-EC7BBA41.uzh.ch) (Quit: Leaving.)
[12:37:10] <TobiasFar> is there a way to tell "rust build --lib" to create a static lib (.a)?
[12:37:51] <dbaupp> what version of Rust do you have?
[12:38:04] <dbaupp> (we very recently gained static linking)
[12:38:09] <TobiasFar> 0.8
[12:38:24] <dbaupp> ah
[12:38:30] <TobiasFar> do i need newer rust?
[12:38:35] <dbaupp> no static linking with 0.8 unfortunately
[12:38:37] <dbaupp> yeah
[12:38:45] <TobiasFar> okay..then i'll build it from source
[12:39:11] <dbaupp> awesome :)
[12:39:19] <cmr> TobiasFar: there are nightlies for arch, ubuntu, and some others: https://github.com/mozilla/rust/wiki/Doc-packages,-editors,-and-other-tools
[12:41:22] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[12:41:26] *** Joins: morphevs (Adium@moz-EC7BBA41.uzh.ch)
[12:43:05] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[12:43:58] *** Quits: morphevs (Adium@moz-EC7BBA41.uzh.ch) (Connection reset by peer)
[12:43:58] *** Joins: morphevs1 (Adium@moz-EC7BBA41.uzh.ch)
[12:44:13] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[12:45:54] *** Quits: morphevs1 (Adium@moz-EC7BBA41.uzh.ch) (Quit: Leaving.)
[12:51:18] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[12:51:33] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[12:59:44] *** Joins: akairobotto (Mibbit@C5C92391.35A75BF5.E8E9A8EF.IP)
[13:01:05] *** Quits: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com) (Ping timeout)
[13:01:13] *** Joins: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com)
[13:05:46] *** Joins: Ms2ger (Ms2ger@moz-664B2345.ugent.be)
[13:06:05] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Connection reset by peer)
[13:07:56] <akairobotto> is there an int to string function? I'm trying variations on int::to_str and from_int functions suggested by different blogs, but I get an unresolved name error.
[13:08:11] <cmr> rusti: let x = 42; x.to_str()
[13:08:12] -rusti- pastebinned 35 lines of output: http://sprunge.us/cMDR
[13:08:24] <cmr> rusti: let x: int = 42; x.to_str()
[13:08:25] -rusti- ~"42"
[13:08:43] <cmr> akairobotto: almost any blog post you see is going to be out of date.
[13:08:51] *** Parts: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com) (bye)
[13:09:09] <dbaupp> rusti: println!("{}", 42); format!("{}", 42)
[13:09:10] -rusti- 42
[13:09:10] -rusti- ~"42"
[13:09:12] <akairobotto> I pretty quickly came to that conclusion :) Thanks for the help!
[13:10:03] *** Quits: akairobotto (Mibbit@C5C92391.35A75BF5.E8E9A8EF.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:10:05] * ChrisMorgan wishes people would either keep posts up to date or clearly mark things as no longer applicable—or at the very least have a big banner at the top saying that being more than two weeks since the date of publication it's likely to be wrong
[13:10:30] <cmr> https://github.com/mozilla/rust/wiki/Docs-How-do-I-%22X%22-in-Rust%3F
[13:10:39] <cmr> Let's try and maintain that page, using questions asked in IRC
[13:10:47] *** Joins: w3lcome (Mibbit@moz-33A75FFD.home.otenet.gr)
[13:11:19] <dbaupp> "How do I converting an int to a string?"
[13:11:22] <pnkfelix> cmr: Couldn't have chosen an easy name to link?  :(
[13:11:37] * pnkfelix doesn't like having to encode quotation marks
[13:11:37] <heftig> dbaupp: in base 89, plz
[13:12:01] <pnkfelix> (or question marks for that matter)
[13:12:11] <dbaupp> cmr: "Docs-FAQ-Cheatsheet" or something
[13:12:13] <cmr> pnkfelix: https://github.com/mozilla/rust/wiki/Docs-Code-FAQ better?
[13:12:15] <dbaupp> ?
[13:12:16] <cmr> heh
[13:13:06] <cmr> FAQ-Cheatsheet is better
[13:13:11] <pnkfelix> i agree
[13:13:22] <cmr> https://github.com/mozilla/rust/wiki/Docs-FAQ-Cheatsheet
[13:14:21] *** Joins: morphevs (Adium@moz-407FE8B.uzh.ch)
[13:14:45] <cmr> hm
[13:14:54] <cmr> can't have links in code blocks
[13:16:09] *** Joins: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com)
[13:16:40] <cadence> Is there a way to skip running the benchmark tests when running `make check-stage1-std`?
[13:17:15] <dbaupp> cadence: `make ... NO_BENCH=1` iirc
[13:18:45] <cadence> dbaupp: Yay! Thank you.
[13:20:20] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[13:21:09] <sanxiyn> dbaupp: Added to https://github.com/mozilla/rust/wiki/Note-testsuite
[13:21:50] *** kimundi is now known as zz_kimundi
[13:22:02] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[13:22:46] <cadence> Thanks sanxiyn
[13:22:47] *** Quits: morphevs (Adium@moz-407FE8B.uzh.ch) (Quit: Leaving.)
[13:23:13] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[13:24:41] *** Joins: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[13:24:58] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[13:24:59] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[13:25:49] *** Joins: apoelstra (username@moz-C92A9641.sw.biz.rr.com)
[13:28:11] <dbaupp> cmr: fwiw, the other Doc pages are just `Doc-...` rather than `Docs-...`
[13:28:19] <cmr> oops
[13:28:20] *** Quits: tcr (tcr@moz-749D5EF5.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[13:28:30] <cmr> in the sidebar it's Docs, so I assumed.
[13:28:47] <cmr> This meta-tag system is gross :(
[13:30:13] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:30:58] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[13:32:39] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[13:36:56] *** Quits: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP) (Quit: victorporof)
[13:37:37] <apoelstra> is there an equivalent of strpos in rust?
[13:37:51] <apoelstra> i'd like to convert a (character) hex digit to a number
[13:38:35] <cmr> rusti: let x: Option<int> = std::num::from_str_radix("a", 16);
[13:38:37] -rusti- <anon>:9:12: 9:13 warning: unused variable: `x` [-W unused-variable (default)]
[13:38:37] -rusti- <anon>:9         let x: Option<int> = std::num::from_str_radix("a", 16);
[13:38:37] -rusti-                      ^
[13:38:37] -rusti- ()
[13:38:40] <cmr> rusti: let x: Option<int> = std::num::from_str_radix("a", 16); x
[13:38:41] -rusti- Some(10)
[13:38:59] <apoelstra> derp, thx
[13:39:09] <ChrisMorgan> apoelstra: strpos would be http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html#tymethod.find_str I think?
[13:39:17] <cadence> Or http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html#tymethod.contains_char ?
[13:39:59] <sanxiyn> Just .find
[13:40:38] <sanxiyn> http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html#tymethod.find
[13:41:09] *** Parts: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com) ()
[13:41:19] *** Joins: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com)
[13:41:39] <ChrisMorgan> (`find` if you only care about characters, `find_str` if you need to check for a string, which is what strpos does.)
[13:41:56] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[13:42:22] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[13:44:41] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[13:46:25] *** Quits: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca) (Quit: canhtak)
[13:48:32] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[13:48:41] *** Joins: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com)
[13:50:18] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[13:52:02] *** Joins: morphevs (Adium@moz-407FE8B.uzh.ch)
[13:52:46] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:54:40] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[13:54:58] *** Quits: jensnockert (jensnocker@moz-250D9518.wireless.lu.se) (Input/output error)
[13:55:30] *** Joins: jensnockert (jensnocker@moz-250D9518.wireless.lu.se)
[13:56:19] <bstrie> hahaha
[13:56:27] <bstrie> so yesterday's grace hopper google doodle had a bug
[13:56:34] <bstrie> that google quickly fixed
[13:56:49] <bstrie> but apparently, due to the semantics of cobol, it wasn't actually a bug at all
[13:57:03] <Ms2ger> Cobol, eh
[13:57:07] <cmr> she did invent it
[13:57:13] <bstrie> she also invented bugs
[13:57:15] *** Quits: jensnockert (jensnocker@moz-250D9518.wireless.lu.se) (Ping timeout)
[13:57:16] <bstrie> also, she invented the navy
[13:57:26] <Ms2ger> And the internet?
[13:57:29] <cmr> and the nanosecond!
[13:58:11] <eddyb> bstrie: how did I miss it :(
[13:58:19] <cmr> I also missed it
[13:58:32] <bstrie> eddyb cmr http://www.google.com/doodles/grace-hoppers-107th-birthday
[13:58:46] <eddyb> I just opened that
[13:58:49] <cmr> ooh
[13:58:54] <cmr> the one I was previously looking at wasn't animated
[13:58:56] <cmr> it was just static
[13:59:00] <eddyb> doesn't look interactive
[13:59:22] <bstrie> in the original version, they (accidentally??) reversed the "BirthYear" and "CurrentYear" variables in the code she's typing
[13:59:31] <bstrie> hence it would have calculated her negative age
[13:59:43] <bstrie> but because cobol variables apparently don't have a sign unless you tell them to, it would have been correct anyway
[13:59:51] <cmr> lol
[13:59:58] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[14:00:00] <eddyb> so negating an unsigned is noop?
[14:00:14] <eddyb> -1 is so useless!
[14:01:53] *** zz_kimundi is now known as kimundi
[14:03:59] *** Joins: Hildar (Mibbit@moz-7F4621B6.cable.virginm.net)
[14:05:38] *** Joins: jensnockert (jensnocker@moz-250D9518.wireless.lu.se)
[14:09:06] <Hildar> How do I do a foreach() over a ~[~T]?
[14:09:15] <ChrisMorgan> bstrie: was .pagename { position: fixed } on /r/rust your idea? Could you please change it to absolute? Having it scroll down is a nuisance.
[14:09:31] <Ms2ger> for x in y.iter() {}
[14:09:52] <ChrisMorgan> Hildar: `for ref ~item in vec.iter() { ... }` if you want to borrow the ~T to a &T
[14:10:01] <cmr> gah that's awful
[14:10:11] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[14:10:23] <ChrisMorgan> (Actually, I take that back, need to check what vec.iter does.)
[14:10:32] <cmr> ChrisMorgan: ~[T] -> Iterator<&T>
[14:10:34] <cmr> T here is ~T
[14:10:38] <cmr> So, Iterator<&~T>
[14:10:47] <TobiasFar> can rust take advantage of multiple cores? i see it maxing out one core for minutes :/
[14:10:48] <ChrisMorgan> Yeah, I take back what I said. 
[14:11:02] <cmr> TobiasFar: The build? No, except for LLVM.
[14:11:05] <ChrisMorgan> `for item in vec.iter() { ... }` will have item being &~T.
[14:11:06] <TobiasFar> the build, yes
[14:11:06] <cmr> It's largely serial.
[14:11:19] <TobiasFar> ahh...ok
[14:11:57] *** Quits: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp) (Client exited)
[14:12:02] <ChrisMorgan> You do get a *slight* benefit from using something like `make -j4`, but assuming you don't need to build LLVM it's not significant.
[14:12:28] <cmr> rustc needs to be parallelized, but it's a big project, and not a priority.
[14:12:42] <Hildar> ChrisMorgan: 	for ref ~x in self.components.iter() {x.update();} results in "expected identifier, found path"
[14:13:15] <ChrisMorgan> Hildar: don't use `ref ~x`, use just `x`. I was wrong.
[14:13:49] <ChrisMorgan> (What I wrote should be syntactically sound, but I guess with the improper desugaring implementation it's not even doing it properly as a pattern.)
[14:13:49] <Hildar> ChrisMorgan: 	for ref ~x in self.components.iter() {x.update();} results in "expected identifier, found path"
[14:13:52] <Hildar> sorry
[14:13:57] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[14:14:53] *** Quits: MOeltjenbruns (goofy@moz-D9C12442.hsd1.mn.comcast.net) (Connection reset by peer)
[14:15:10] <Hildar> Hmm, "for mut x in self.componenets.iter(){x.update()}" complains that x isn't mutable.
[14:15:26] <cmr> it isn't
[14:15:33] <cmr> for x in self.components.mut_iter()
[14:15:42] *** Quits: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net) (Ping timeout)
[14:15:59] <Hildar> cmr: and now I feel like an idiot *facedesk* Thanks
[14:16:03] *** Joins: zslayton (Mibbit@moz-4806B979.nyc.res.rr.com)
[14:16:21] <ChrisMorgan> Hildar: (just confirming it's all clear) with iter(), x is of type &~T; you need mut_iter() to get &mut ~T.
[14:16:27] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:16:51] <Hildar> ChrisMorgan I understand now, thanks.
[14:16:55] <ChrisMorgan> Good.
[14:17:04] <cmr> Also, just to get &T, it's `for &~ ref x in xs.iter()`
[14:17:16] <eddyb> task 'test::test_load' failed at 'called `Result::unwrap()` on an `Err` value'
[14:17:37] * ChrisMorgan shudders
[14:17:38] <eddyb> wasn't there supposed to be an easy way to show the error (if it's ~str or similar)?
[14:17:52] <cmr> eddyb: no, that has since been removed.
[14:18:02] <eddyb> I don't want to pattern-match :(
[14:18:03] <cmr> Reslt uses to have a ToStr bound on the Err type.
[14:18:12] <cmr> Result used*
[14:18:47] <eddyb> surely it could impl<T, U: ToStr> Result<T, U> {fn no_idea_how_to_call_this....
[14:19:00] <ChrisMorgan> &: make a reference; ~: dereference owned pointer; ref: dereference borrowed pointer. Operate right to left. Not exactly pretty. (Will the ~ in there change to `box` in the new scheme, or `unbox`, or `boxed`, or something else, or—?)
[14:19:07] <cmr> ChrisMorgan: no, other way around.
[14:19:25] <eddyb> ref creates a reference, & dereferences
[14:19:26] <cmr> & to match out of the reference, ~ to match out of the owned box, ref to create a reference.
[14:19:31] <ChrisMorgan> *Sigh.*
[14:19:34] * ChrisMorgan is going to bed
[14:19:52] <cmr> it's the type signature, but with the meaning inverted
[14:20:53] <eddyb> is there an assert_ok!?
[14:21:05] *** Joins: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net)
[14:21:05] *** Quits: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net) (Connection reset by peer)
[14:21:13] <cmr> assert!(x.ok().is_some())
[14:21:25] <eddyb> but that doesn't tell you the error
[14:21:33] <cmr> nothing tells you the error.
[14:21:35] *** Joins: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net)
[14:21:35] <eddyb> which is why I'm even asking
[14:21:36] <cmr> there doesn't have to be an error
[14:22:03] <eddyb> I'll try assert_eq!(x.err(), None)
[14:22:15] *** Joins: IRCMonkey28809 (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[14:22:24] *** Quits: IRCMonkey28809 (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: IRCMonkey28809)
[14:23:16] *** Joins: IRCMonkey12882 (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[14:23:42] *** IRCMonkey12882 is now known as sw17ch
[14:25:04] *** Quits: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com) (Quit: http://www.mibbit.com ajax IRC Client)
[14:25:56] <eddyb> well, pattern matching works better >_> Err(m) => fail!(m),
[14:27:45] <ChrisMorgan> eddyb: don't forget you can make a macro yourself if you want
[14:28:50] <eddyb> until I memorize the macro_rules syntax, I don't want to touch it if I can help it
[14:28:58] *** Joins: veddan (viktor@moz-C79BC80B.csbnet.se)
[14:29:03] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:35:05] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Input/output error)
[14:35:32] *** Joins: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net)
[14:36:07] *** jorendorff_away is now known as jorendorff
[14:37:45] <ChrisMorgan> eddyb: it's pretty simple: `macro_rules! assert_ok { ($expr:expr) => ( match $expr { Ok(_) => (), Err(e) => fail!("expected Ok(..), got an Err: `{:?}`", e) } ) }` [you may well want `Err(ref e)` instead]
[14:39:41] <TobiasFar> can one tell rustc to name the output just libfoo.a without d67fafba3a49ef-0.0 ?
[14:39:44] <apoelstra> is there a way i can use the SHA functions in librustpkg/sha1.rs in my code?
[14:39:50] <apoelstra> or is that just part of the build system?
[14:40:08] <bstrie> ChrisMorgan: that might as well just be a function, rather than a macro :P
[14:40:09] <ChrisMorgan> apoelstra: it's not publicly exported
[14:40:41] <ChrisMorgan> bstrie: it could be done as a function just as effectively. So could assert and assert_eq.
[14:40:56] *** Quits: Hildar (Mibbit@moz-7F4621B6.cable.virginm.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:41:11] <bstrie> perhaps we should convert them to functions
[14:41:14] <bstrie> macro abuse! :)
[14:43:09] * eddyb wishes functions could be overloaded
[14:43:27] <eddyb> .expect(message) and .expect()
[14:43:29] <ChrisMorgan> bstrie: I take it back; assert_eq! can be, but assert! can't be—it can have additional arguments to be passed to fail!
[14:43:44] <ChrisMorgan> Plus there's the line number matter. Macro gives correct line numbers; function doesn't.
[14:43:51] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Quit: Leaving)
[14:43:55] <bstrie> I don't like using macros as a poor man's variadic arguments
[14:44:15] <bstrie> ChrisMorgan: rather, the line! macro gives the correct line number, iirc. you could call that from a function
[14:44:16] <ChrisMorgan> bstrie: I think getting the file/line number right is their most important feature.
[14:44:18] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[14:44:37] <bstrie> or I guess that would probably give you the line number ofthe assert function
[14:44:38] <bstrie> hm
[14:44:38] <ChrisMorgan> bstrie: but then it's the line number of the function rather than that of the caller.
[14:44:49] *** Quits: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net) (Ping timeout)
[14:45:24] *** Quits: peterdn (chatzilla@moz-3DA3F15F.as13285.net) (Ping timeout)
[14:45:37] <bstrie> eddyb: looks like you really just wish we had default arguments :)
[14:45:59] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[14:46:32] *** Quits: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net) (Ping timeout)
[14:46:37] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[14:46:51] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:46:57] <eddyb> well, yeah, that would also work, with message=self.err()
[14:47:12] <eddyb> but it's trickier
[14:48:37] *** Joins: flowsnake (flowsnake@moz-10902DAB.cable.virginm.net)
[14:48:55] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[14:49:06] *** Joins: peterdn (chatzilla@moz-3DA3F15F.as13285.net)
[14:50:43] *** kimundi is now known as zz_kimundi
[14:51:57] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[14:52:03] *** Joins: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP)
[14:52:16] *** zz_kimundi is now known as kimundi
[14:54:05] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[14:55:00] *** Quits: beifeng (Mibbit@90BAFE10.A765EABF.C7DB8B78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:55:23] <nmatsakis> cmr: what you're seeing there is that the borrowck treatment of closures is still unsound (#2202)
[14:55:40] <nmatsakis> cmr: this is fixed in one of my two big in-progress patches (#3511, #2202)
[14:55:57] <nmatsakis> cmr: but it's not yet ready to land (though it does bootstrap)
[14:56:29] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[14:57:36] *** Quits: jensnockert (jensnocker@moz-250D9518.wireless.lu.se) (Input/output error)
[14:58:09] *** Quits: JanC (janc@moz-8704C2E9.dsl.scarlet.be) (Ping timeout)
[14:59:22] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[15:02:49] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[15:03:45] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:03:59] *** Joins: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp)
[15:04:18] *** Joins: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP)
[15:06:15] <TobiasFar> can i tell rust to output libs for 32bit architecture?
[15:06:46] <cmr> TobiasFar: --target=...
[15:06:55] <cmr> i686-unknown-linux-gnu for linux
[15:08:25] <TobiasFar> but during rust's build process, the rust libs are probably only build for one architecture, right?
[15:08:56] <cmr> yes, but you can pass --target=... to the configure script.
[15:09:20] <TobiasFar> cmr: ah..ok...will give that a try
[15:09:32] <cmr> (it should be a fairly quick rebuild, since it only needs to build the libs.
[15:11:08] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[15:11:34] <eddyb> test test::bench_load ... bench:         0 ns/iter (+/- 0) = 400000 MB/s
[15:11:40] <eddyb> wait, how can it be that fast/
[15:11:41] <eddyb> ?
[15:11:58] <eddyb> is the bench harness broken?
[15:12:01] <cmr> either it's getting DCE'd, or it took too long and it gave up.
[15:12:08] <cmr> both of which are known and expected behaviors.
[15:12:12] <eddyb> :(
[15:12:28] *** Quits: fhahn (fhahn@moz-7924DB5C.vie.surfer.at) (Ping timeout)
[15:12:35] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[15:13:28] *** Joins: JanC (janc@moz-E531FDF1.dsl.scarlet.be)
[15:14:43] *** Joins: RageOfThou (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[15:14:52] <eddyb> it does something for the (faster?) libpng binding: test test::bench_load ... bench:    129313 ns/iter (+/- 52565) = 3 MB/s
[15:14:59] *** Quits: RageOfThou (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Quit: Leaving)
[15:15:11] <eddyb> but it doesn't say how many iterations it ran
[15:15:23] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[15:20:22] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[15:21:11] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[15:21:40] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[15:24:59] *** kimundi is now known as zz_kimundi
[15:25:37] *** Joins: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se)
[15:26:05] *** Joins: beifeng (Mibbit@90BAFE10.A765EABF.C7DB8B78.IP)
[15:26:28] *** Joins: jvshahid (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP)
[15:26:45] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[15:26:55] *** Joins: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net)
[15:29:26] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[15:29:50] *** Joins: bjustin (bjustin@moz-8FC28563.sierrabravo.net)
[15:31:32] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:31:42] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Client exited)
[15:31:56] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[15:32:02] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:37:55] *** Quits: vmx (vmx@moz-4923A51.dip0.t-ipconnect.de) (Quit: Leaving)
[15:38:47] <apoelstra> what is the correct way to tell rustc to link with C object files?
[15:39:14] <bstrie> apoelstra: is the -L compiler flag what you're looking for?
[15:39:15] *** Quits: ssbr (devin@moz-8EC4F450.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[15:39:21] <apoelstra> if i do #[link_args = "sha-wrapper.o"] it tries to link sha-wrapper.o multiple times
[15:39:23] <cmr> no, that's search path.
[15:39:36] <bstrie> <--- not a systems programmer
[15:39:38] <cmr> apoelstra: link_args is the right way to do it.
[15:40:20] <apoelstra> cmr: ok, is it a bug then that whatever i put into link_args shows up twice on the command line?
[15:40:25] <apoelstra> or am i doing something wrong?
[15:40:33] <cmr> apoelstra: if it is I've never seen it before, you're probably doing something wrong.
[15:41:56] <apoelstra> ok, in hash.rs I have set link_args
[15:42:02] <apoelstra> and in two different files i have "mod hash"
[15:42:09] <cmr> yeah that's entirely wrong.
[15:42:16] <cmr> read the module tutorial
[15:42:40] <cmr> http://static.rust-lang.org/doc/master/tutorial.html#crates-and-the-module-system
[15:43:40] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[15:43:45] *** Joins: jvns (bork@87D98E32.4046EB22.428F94DD.IP)
[15:43:51] <achin> what part of that is wrong? 
[15:44:02] <cmr> achin: multiple `mod hash;`
[15:44:15] <apoelstra> achin: it says, "mod" is pretty-much like #include, you're going to have bad things happen if you use it twice
[15:44:34] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[15:45:10] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[15:45:19] <achin> oh, using it twice in the same crate?
[15:45:36] <cmr> or ever, yeah :p
[15:46:15] <achin> surely two different projects that want to use the hash module would each need to use "mod hash;", right?
[15:46:30] <cmr> why would two different projects be using a module and not a crate?
[15:46:53] <achin> because... uhh.., because?
[15:46:59] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[15:48:44] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[15:50:00] <achin> yes i think i see how.  i had gotten some thigns mixed up and conflated in my head
[15:50:16] <achin> s/how/now/
[15:51:25] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:51:35] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[15:51:56] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[15:54:25] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[15:55:21] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[15:55:39] *** Joins: ssbr (devin@moz-8EC4F450.lightspeed.sntcca.sbcglobal.net)
[15:57:19] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:57:56] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[15:58:14] *** Quits: jvns (bork@87D98E32.4046EB22.428F94DD.IP) (Client exited)
[16:00:14] *** Parts: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) ()
[16:01:49] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[16:03:43] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[16:03:46] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: jlong)
[16:04:13] *** Joins: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP)
[16:04:40] *** Quits: StarLight (StarLight@90A4DCD2.D5479371.F1EF1E39.IP) (Ping timeout)
[16:05:20] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[16:06:20] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[16:07:11] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:08:08] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[16:08:25] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[16:09:03] *** Joins: StarLight (StarLight@11677ED8.2BF90289.F1EF1E39.IP)
[16:09:19] *** Joins: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[16:09:19] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[16:09:57] *** Joins: AvianFlu_ (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[16:10:59] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[16:10:59] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Ping timeout)
[16:12:20] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[16:13:37] *** Quits: Ms2ger (Ms2ger@moz-664B2345.ugent.be) (Quit: bbl)
[16:14:12] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[16:14:16] <apoelstra> in my hash.rs, i have defined pub trait Hashable { ... }
[16:14:24] <samx> Trying to compile rust from master (on osx), but it's failing :-(..  The error is:  http://pastebin.com/ABu4DtJ1     Anyone know how to get around that?
[16:14:27] <apoelstra> then in main.rs i have "mod hash"
[16:14:33] <apoelstra> but when i do "  let hash = hash::Hashable::to_hash (transaction);
[16:14:41] <apoelstra> it says hash::Hashable::to_hash is unresolved
[16:14:57] <cmr> apoelstra: gist your code.
[16:15:15] <cmr> it's hard to help with only partial details
[16:16:00] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[16:18:30] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[16:18:30] <eddyb> how can I keep spawn'd tasks alive until they're all in one point?
[16:19:02] <bstrie> eddyb: have them wait for a signal from the parent task, which is waiting on a signal from all child tasks?
[16:19:24] <eddyb> with port and chan?
[16:19:29] <bstrie> sure
[16:19:38] <bstrie> but I ain't no expert on concurrency
[16:19:40] <eddyb> this is going to be nuts
[16:20:08] <bstrie> how would you prefer to do it?
[16:20:11] *** Quits: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr) (Ping timeout)
[16:20:25] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[16:20:26] <eddyb> I don't know
[16:20:45] <apoelstra> hash.rs: http://pastebin.com/zLGbVHKU
[16:20:50] <apoelstra> main.rs: http://pastebin.com/rqL7Z6if
[16:20:56] <apoelstra> together those exhibit the problem
[16:21:32] <cmr> there's a semaphore in extra::sync but it appears to not be public
[16:22:11] <cmr> apoelstra: to_hash is a method.
[16:22:16] <eddyb> apoelstra: you have to call .to_hash on something that's Hashable
[16:22:35] <cmr> apoelstra: so you need to impl Hashable for Transaction.
[16:22:36] <eddyb> apoelstra: like, transaction.to_hash()
[16:22:48] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:23:00] <apoelstra> eddyb: cmr: then i get type `transaction::Transaction` does not implement any method in scope named `to_hash`
[16:23:21] <cmr> you need to impl Hashable for transaction.
[16:23:37] <cmr> http://static.rust-lang.org/doc/master/tutorial.html#generics
[16:23:51] <apoelstra> cmr: line 14 of my main.rs pastebin
[16:24:04] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[16:24:15] <cmr> oh hm
[16:24:19] <cmr> ah
[16:24:22] <eddyb> apoelstra: you need to use hash::Hashable;
[16:24:26] <cmr> `use hash::Hashable` at the top of main.rs
[16:24:47] <apoelstra> hmm, that does it
[16:25:25] <apoelstra> i'd prefer to explicitly say that to_hash comes from hash::Hashable tho
[16:25:36] *** Joins: jvshahid_ (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP)
[16:25:37] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[16:25:39] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[16:25:45] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[16:25:48] <cmr> not possible yet.
[16:25:54] <apoelstra> ok, thanks
[16:26:14] *** Quits: jvshahid (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP) (Ping timeout)
[16:26:27] *** Joins: FreeFull (freefull@moz-EF0F03F3.as13285.net)
[16:27:10] *** Joins: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP)
[16:30:55] *** Joins: jstevans1 (Instantbir@6F907BF0.83BCE10.DDE5D3F6.IP)
[16:33:35] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[16:36:38] <Diamond> is there anything in std::num that relies on rt? ie is there anything preventing it from being used verbatim in freestanding rust?
[16:36:47] <cmr> Diamond: shouldn't be, on.
[16:36:48] <cmr> *no
[16:36:57] <Diamond> cmr: thanks
[16:38:27] *** Joins: mib_zpgi1a (Mibbit@moz-23C212B0.dynamic.qsc.de)
[16:38:47] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:38:59] <mib_zpgi1a> How do I exit a program gracefully? Something like os::exit(1)
[16:39:02] *** Joins: vmx (vmx@moz-B510001A.pools.arcor-ip.net)
[16:39:35] <hoverbear> I got an arch box building last night... Tonight I'm going to work on tooling it for Arch... Looks like I'll be making a Vagrant VM instead of a Docker... more portable anyways.
[16:39:36] <cmr> mib_zpgi1a: there's no such thing as a graceful exit, if you're using std::os::exit
[16:40:02] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[16:40:11] <mib_zpgi1a> cmr: I don't understand
[16:40:22] <cmr> mib_zpgi1a: the only real way to do it is to structure your program so that you can tell all tasks to exit.
[16:40:45] <cmr> exit doesn't run destructors.
[16:40:49] <cmr> also, I meant std::libc::exit
[16:41:34] <mib_zpgi1a> my program is single task. I want something like fn usage() { bla; exit(0); }. Is libc::exit the right choice here?
[16:41:46] *** Quits: GeneralMaximus (ankur@135D17DC.B2987149.1228A288.IP) (Quit: Computer has gone to sleep.)
[16:41:48] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:41:48] <cmr> yes
[16:42:41] *** Quits: zslayton (Mibbit@moz-4806B979.nyc.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:42:51] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[16:42:59] *** Quits: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP) (Client exited)
[16:43:04] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[16:43:39] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[16:46:02] *** Joins: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP)
[16:46:24] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[16:48:14] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[16:49:05] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Client exited)
[16:49:49] *** Quits: alex-abreu (alex@moz-4B4D75AD.rev.sfr.net) (Ping timeout)
[16:50:37] <mib_zpgi1a> how do I tell rust that a function never returns?
[16:50:38] *** Joins: alex-abreu (alex@moz-4B4D75AD.rev.sfr.net)
[16:50:54] <cmr> fn foo() -> ! { ... }
[16:51:11] *** Quits: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP) (Quit: colinsurprenant)
[16:51:52] <bstrie> it's like being in elementary school
[16:52:00] <bstrie> "hey rust this function totally returns... NOT!"
[16:52:34] *** Joins: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net)
[16:52:37] <mib_zpgi1a> #[fixed_stack_segment] is deprecated, right?
[16:52:40] <bstrie> yes
[16:52:46] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[16:54:31] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[16:55:30] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:55:31] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[16:55:41] *** Quits: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net) (Ping timeout)
[16:56:02] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[16:57:24] *** Joins: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP)
[17:00:30] *** flaper87 is now known as flaper87|afk
[17:01:25] <mib_zpgi1a> are there rust docs that can be accessed from the command line?
[17:01:45] <cmr> not yet.
[17:02:01] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[17:02:03] <cmr> I'm going to work on getting rustdoc to spit out man pages today.
[17:02:19] <mib_zpgi1a> nice
[17:02:29] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[17:03:44] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:04:26] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[17:04:35] <Scriptor> does rust's basic map implementation mutate the returned list as it builds it up?
[17:05:14] <cmr> Scriptor: what do you mean? what returned list? which map?
[17:05:17] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:06:05] <FreeFull> Maybe rustdoc should spew out something that can be processed with pandoc
[17:06:15] <Scriptor> I'm not sure what Rust's exact equivalent is, but map as in the map function (map(f, [1,2,3]) -> [f(1), f(2), f(3)])
[17:06:25] <cmr> ah, that.
[17:06:25] *** Quits: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[17:06:38] <cmr> on iterators, it just returns another iterator
[17:06:42] <cmr> .next() applies the function
[17:06:55] <Scriptor> ah, got it
[17:06:56] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[17:07:13] <Scriptor> so iterators are lazy-ish?
[17:07:15] *** Joins: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com)
[17:07:19] <cmr> pretty much
[17:07:52] <FreeFull> I still want a REPL
[17:08:00] <cmr> FreeFull: we used to do that. too slow, too limiting in what we output (at least when we used markdown)
[17:08:06] <Scriptor> just as an aside, I'm surprised no one's figured out a map implementation that's not either: 1. lazy, 2. needs to call reverse, 3. blows the stack
[17:08:06] *** Quits: osa1__ (omer@moz-8FDAB45C.hsd1.il.comcast.net) (Ping timeout)
[17:08:12] <FreeFull> Probably there won't be one in time for 1.0
[17:08:28] <cmr> FreeFull: unless you or someone else implements it, no.
[17:08:34] <FreeFull> Scriptor: Why would you need to call reverse?
[17:08:57] <Scriptor> FreeFull: if you use a tail recursive implementation (and want to maintain immutability) you end up building the list backwards
[17:09:16] <mib_zpgi1a> What is the correct way to initialize a large struct? Do I have to create temporary variables for all fields, compute the values, and move the fields into the struct all at once or can I incrementally fill the struct without temporary variables?
[17:09:28] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[17:09:29] <FreeFull> Oh, I see
[17:09:31] <Scriptor> I think one of the ocaml core guys cites this as why he prefers the non-tail-recursive map implementation
[17:09:32] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:09:34] <FreeFull> Yeah, you're right about that
[17:09:37] *** Joins: g3xzh (g3xzh@67C6887A.F9017BC2.CB858787.IP)
[17:09:42] <cmr> FreeFull: "figured out"? it's super simple :|
[17:09:49] <cmr> erm, @Scriptor
[17:10:08] <FreeFull> I'm just too used to laziness by now I suppose
[17:10:38] <Scriptor> cmr: wait, how?
[17:10:58] <cmr> let ys = std::vec::with_capacity(xs); for x in xs.iter() { ys.push(f(x)); } ys
[17:11:13] <Scriptor> wait, does .push mutate?
[17:11:22] <cmr> well yeha
[17:11:29] <pnkfelix> cmr: I think Scriptor's talking about a different problem
[17:11:29] <Scriptor> "(and want to maintain immutability)"
[17:11:57] <Scriptor> obviously if you're okay with mutability then the solution's trivial
[17:11:59] <cmr> iterators aren't immutable in rust either.
[17:12:04] <Scriptor> right, but they're lazy
[17:12:08] <cmr> ok
[17:12:18] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[17:12:22] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[17:12:29] <cmr> Ah, the (and want to maintain immutability) part was in a separate line
[17:12:44] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:12:47] <Scriptor> right, sorry for the confusion
[17:12:52] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[17:14:11] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[17:14:13] <cmr> Scriptor: well, a cheap way to avoid reversing the list is to have a doubly linked list and a flag for direction ;p
[17:14:19] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[17:14:23] <cmr> which is still conceptually a reverse
[17:14:53] <Scriptor> that's cheating ;)
[17:14:57] <cmr> Pft!
[17:15:12] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Client exited)
[17:15:16] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:15:29] <Scriptor> I'm just surprised that laziness appears to be the best solution
[17:15:34] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[17:17:58] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[17:18:01] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[17:19:55] *** Joins: ferminter (Mibbit@C2F316A1.C153A91D.70845BE5.IP)
[17:20:02] *** zz_kimundi is now known as kimundi
[17:20:45] *** Joins: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr)
[17:20:47] *** Parts: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr) ()
[17:23:12] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[17:23:51] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[17:24:36] *** Joins: Ms2ger (Ms2ger@moz-97D6582B.adsl-dyn.isp.belgacom.be)
[17:26:20] <hoverbear> Scriptor: You obviously need to use haskell more.
[17:26:55] <Scriptor> hoverbear: nah, I like haskell and laziness
[17:27:29] <hoverbear> Scriptor: Would you say you're eager for more laziness?
[17:27:33] <Ms2ger> Ugh, haskell :)
[17:27:41] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:27:48] <Scriptor> hoverbear: strictly speaking
[17:28:40] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[17:28:56] *** Quits: morphevs (Adium@moz-407FE8B.uzh.ch) (Quit: Leaving.)
[17:30:15] <bstrie> I'd learn haskell, but I'm too lazy
[17:30:57] <hoverbear> I like the language, but I find myself hitting a wall every time I try to use Cabal or Compile or anything...
[17:31:15] <hoverbear> I mean, who makes a package manager you can't uninstall with?
[17:31:25] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[17:32:16] <hoverbear> Hahaha, from my slides:    Q. What's one way to terminate a process? A. Do something illegal.
[17:32:39] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:33:13] <bstrie> get stuck in an infinite loop -> jaywalk
[17:34:06] <hoverbear> Get into a deadlock -> Spy on the entire world and splice undersea fibers?
[17:34:18] <cmr> too soon
[17:34:29] <hoverbear> cmr: What do you mean? It hasn't stopped yet.
[17:34:33] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:35:26] *** Quits: mib_zpgi1a (Mibbit@moz-23C212B0.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[17:37:53] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:38:23] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[17:38:44] <sw17ch> hoverbear: i've also been bothers that the `ghc-pkg unregister` functionality isn't baked into cabal
[17:39:09] *** Joins: g3xzh_ (g3xzh@67C6887A.F9017BC2.CB858787.IP)
[17:39:19] <hoverbear> sw17ch: Or that my "print hello world" binary was almost 700 kb?
[17:39:34] <sw17ch> hoverbear: that's more forgivable :)
[17:39:47] <cmr> that's about the size of the smallest rust hello world using libstd.
[17:39:48] <sw17ch> (how long ago was that, btw? dynlibs are relatively recent)
[17:39:49] <hoverbear> sw17ch: Yeah, that didn't bother me so much.
[17:40:06] *** Quits: g3xzh (g3xzh@67C6887A.F9017BC2.CB858787.IP) (Ping timeout)
[17:40:07] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[17:40:28] <hoverbear> sw17ch: that was just over a month ago
[17:40:39] *** Joins: zenon (Mibbit@moz-2E43177.dynamic.qsc.de)
[17:41:32] <zenon> In traits, does Self stand for the type that implements the trait?
[17:41:45] <cmr> zenon: yes.
[17:41:53] <cmr> it's basically an implicit type parameter
[17:41:55] <sw17ch> hoverbear: ghc -O3 hello.hs -dynamic -o hello
[17:42:05] <sw17ch> 12k
[17:42:13] <sw17ch> rather than 1m
[17:42:14] <sw17ch> :)
[17:42:33] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[17:42:33] *** ChanServ sets mode: +o jdm
[17:43:01] <hoverbear> lolwtf.
[17:43:01] *** Joins: gdey_ (gdey@moz-E4449B64.sd.sd.cox.net)
[17:43:13] <sw17ch> it's static by default
[17:43:37] <hoverbear> sw17ch, cmr: https://gist.github.com/Hoverbear/6352892ca68908962728 <-- COmpiles to a 7.3 MB file on my mac
[17:43:48] <cmr> yup
[17:44:02] <cmr> Try -Z lto if you have a recent rustc
[17:44:28] <cmr> (ie, past 18 hours)
[17:44:34] <hoverbear> Hah :)
[17:44:37] <cmr> rustc -O -Z prefer-dynamic is 12K
[17:44:39] <hoverbear> That'll improve though right?
[17:44:45] *** Joins: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca)
[17:44:47] <cmr> ... maybe
[17:44:50] <acrichto> hoverbear: the most recent rust brings that down to 2.7MB by default, LTO will bring it down to 1.6MB
[17:44:53] *** Quits: oberstet (quassel@moz-F75409F7.dynamic.mnet-online.de) (Client exited)
[17:44:56] <acrichto> those are the best wins we're going to get for now
[17:45:03] <hoverbear> Cool. :)
[17:45:22] <acrichto> but if size is a worry, then -Z prefer-dynamic is definitely the way to go
[17:45:25] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[17:45:44] <bstrie> acrichto: oh, is static linking the default now?
[17:45:48] <hoverbear> Hey, Haskell has had what, over a decade? Rust has lots of time to imrpove.
[17:45:52] <sw17ch> hoverbear: using -static with gcc and a hello world c program also results in a 750k binary
[17:46:00] <bstrie> hoverbear: haskell has been around since like 1991 :P
[17:46:05] <acrichto> bstrie: yes, we prefer static linking by default
[17:46:14] * sw17ch also prefers static linking
[17:46:15] <hoverbear> bstrie: Yes. So over a decade.
[17:46:19] <sw17ch> it gets one out of dependency hell more quickly
[17:46:20] <acrichto> although we fall back on to dynamic linking if rlibs are missing
[17:46:26] <bstrie> nifty
[17:46:33] <acrichto> i.e. if you depend on librustc you'll be dynamically linked
[17:46:38] <bstrie> acrichto: so what's even left to do after LTO works?
[17:46:48] * hoverbear recompiles his rust.
[17:46:58] <bstrie> for reducing binary size, I mean
[17:47:03] <acrichto> bstrie: not a whole lot, I got done pretty much everything that I wanted to get done
[17:47:14] <acrichto> the real game changer will be actually looking at code and seeing what we can shave off
[17:47:17] <cmr> "Make the runtime smaller" I guess
[17:47:22] <acrichto> like changing the structure of the runtime/libraries
[17:47:26] <bstrie> ok
[17:47:29] <hoverbear> See if that damn lazy hoverbear needs to get his crap together and make that image.
[17:47:29] <acrichto> no more low hanging fruit
[17:47:39] *** Quits: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP) (Quit: victorporof)
[17:47:51] <bstrie> hoverbear: you are single handedly destroying this language
[17:48:00] <hoverbear> bstrie: It's true, all that hovering.
[17:48:25] <hoverbear> Compiling Rust on a macbook air, madness I tell you
[17:48:38] <bstrie> so there's this game called Rust
[17:48:43] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[17:48:45] <bstrie> which has a reddit, named /r/playrust
[17:48:49] <bstrie> but everyone tries /r/rust first
[17:48:59] <bstrie> and nobody seems to realize that this is not the right place to post links
[17:49:21] <bstrie> so I have been gradually adding the words "THE RUST PROGRAMMING LANGUAGE" all over the page
[17:49:24] <hoverbear> Solution: Someone needs to port Rust to Rust.
[17:49:26] *** Joins: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[17:49:43] * acrichto just realized how many times "programming language" appears on reddit
[17:49:46] <bstrie> as of today it is in like four places on the page, including just below the submission links
[17:49:53] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[17:50:29] <hoverbear> bstrie: You should pull a http://www.reddit.com/r/woahdude , noone will mistaken it
[17:51:06] <bstrie> maybe for april fools
[17:51:09] <g3xzh_> can anyone explain me why i get this error: http://pastebin.com/gqthucT7
[17:51:11] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[17:51:15] <g3xzh_> thanks for any help
[17:51:22] <bstrie> g3xzh_: you're welcome
[17:51:34] <sfackler> g3xzh_: remove the semicolon after *x
[17:51:45] <sfackler> er,w wait
[17:51:46] <hoverbear> g3xzh_: You're not returning a result
[17:51:50] <sfackler> taht doesn't make sense
[17:52:08] <g3xzh_> sfackler: what i need to end the function with return?
[17:52:11] <hoverbear> g3xzh_: You're telling the compiler you'll return a float, but you implicitly return () after the loop.
[17:52:11] <bstrie> sfackler go home you are drunk
[17:52:11] <sfackler> yeah, add a "sum" line after the loop
[17:52:15] <sfackler> c.c
[17:52:29] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[17:52:36] <sfackler> bstrie: even worse, uncaffinated!
[17:52:44] <sfackler> (sp)
[17:52:46] <bstrie> g3xzh_: what's happening here is that the `for` loop doesn't have a return value
[17:52:58] <bstrie> (really its return value is (), but don't worry about that)
[17:53:08] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:53:21] <hoverbear> g3xzh_: https://gist.github.com/Hoverbear/47ae0f4ede85d4692a74
[17:53:36] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[17:53:36] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:54:08] <bstrie> g3xzh_: if you've read ruby code before, you've definitely seen the pattern that hoverbear uses there
[17:54:17] <bstrie> personally I just write `return sum;` :P
[17:54:19] <hoverbear> Or Coffeescript
[17:54:42] <bstrie> I don't bother with implicit returns if the expression is too big
[17:55:12] <hoverbear> I gotta say, this line is what made me like rust https://github.com/Hoverbear/rust-rosetta/blob/master/hailstone.rs#L43
[17:55:16] <SiegeLord> It's a bother to not type something? :P
[17:55:32] <Ms2ger> It's harder to read
[17:55:52] <zenon> How do you implement the event pattern in Rust? Such as onclick += handler1; onclick += handler2?
[17:56:07] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[17:56:21] <SiegeLord> After programming in Rust for a few months, implicit returns couldn't be more natural for me
[17:56:36] <cmr> Please don't call them implicit returns, that isn't what they are.
[17:56:37] <bstrie> don't get me wrong, I love them in small expressions
[17:56:39] <bstrie> very concise
[17:56:42] <SiegeLord> I don't know how I lived without them, before
[17:56:52] <hoverbear> SiegeLord: They're fully explicit. :-P
[17:57:01] <bstrie> cmr: give me a term, then :P
[17:57:02] <SiegeLord> The 'return' keyword is implicit :P
[17:57:03] <hoverbear> SiegeLord: Coffeescript has implicit returns... Rust does not.
[17:57:06] <cmr> I can't come up with on :(
[17:57:08] <cmr> *one
[17:57:13] <hoverbear> SiegeLord: The lack of semi-colon isn't.
[17:57:14] <bstrie> then you don't get to complain! :)
[17:57:23] <SiegeLord> Well, they are semi-implicit then ;)
[17:57:31] <hoverbear> The non-verbose returns.
[17:57:35] <cmr> People legitimately get confused, thinking the compiler will insert a "return" if you leave off the semicolon.
[17:57:36] *** Joins: reedlepee (Mibbit@moz-1D94468B.cin.ufpe.br)
[17:58:07] <bstrie> cmr: there's no effective difference, and the hard part of this construct *isn't* explaining to anyone how the "return" keyword works
[17:58:23] <cmr> wut
[17:58:36] <bstrie> if you're having trouble with this, it is guaranteed that you are from a C-family language where you have to type out "return"
[17:58:42] <myname> well, wouldn't it be that, if every block were its own function?
[17:58:52] <bstrie> hence we can construct our terminology to help these people out
[17:59:05] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[17:59:15] <hoverbear> Implicit returns ---> http://coffeescript.org/
[17:59:16] <sfackler> zenon: I would make a trait for the callback and then keep a vector of trait objects
[17:59:55] <sfackler> zenon: something like "trait EventHandler { fn handle(&mut self, event: Foo) } let handlers = ~[]; handlers.push(some_handler as ~EventHandler)"
[17:59:59] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:00:00] *** ChanServ sets mode: +ao brson brson
[18:00:10] <hoverbear> Fun fact: Implicit returns kind of suck, because you end up either having to add a "return" at the end of each function or having all your functions return weird junk.
[18:00:15] <sfackler> and then "for handler in handlers.mut_iter() { handler.handle(event) }"
[18:01:09] <zenon> sfackler: sounds reasonable
[18:01:44] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[18:02:04] <sp3d> hoverbear: or you can use semicolons
[18:02:14] <hoverbear> sp3d: That's why I like rust.
[18:02:24] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[18:02:41] <zenon> how do you humans feel about    match success { true => f(), false => g() }     . It's one line shorter than        if success { f() } else { g() }    .
[18:02:43] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[18:02:47] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:02:47] <hoverbear> sp3d: What I described above was for coffeescript. Rust's methods are slightly better.
[18:02:47] *** ChanServ sets mode: +ao brson brson
[18:02:51] <boredomist> could i get someone to weigh in on huonw's comments here? https://github.com/mozilla/rust/pull/10897
[18:03:05] <hoverbear> zenon: I love me some match statements.
[18:03:21] <Ms2ger> match success { true => f, false => g }()
[18:03:34] <g3xzh_> guys another question. i am new-ish to functional programming. can anyone explains me the structure of fold in rust. where i tell the function i use in fold, the accum variable and etc
[18:03:34] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[18:03:49] <heftig> match success { true => f, _ => g }()
[18:03:50] <g3xzh_> *explain
[18:04:05] *** Quits: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Input/output error)
[18:04:29] <bstrie> boredomist: I'm not sure if the obsolete warning is strictly necessary, if it would be a whole lot of work to implement
[18:04:38] <zenon> heftig: false looks better. If only false were 4 letters long. 
[18:04:42] <bstrie> boredomist: btw huonw is dbaupp in here
[18:05:02] <hoverbear> zenon: Solution: Make true 1 letter longer.
[18:05:10] <hoverbear> let truer = true
[18:05:13] <zenon> haha
[18:05:18] *** Joins: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP)
[18:05:29] <Ms2ger> g3xzh_, a.iter().fold(0, |a, &b| a + b)
[18:05:33] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Client exited)
[18:05:37] <zenon> hoverbear: then I have to change the vim highlighting too
[18:05:41] *** Quits: reedlepee (Mibbit@moz-1D94468B.cin.ufpe.br) (Quit: http://www.mibbit.com ajax IRC Client)
[18:05:43] <Ms2ger> hoverbear, let tru = true; let fls = false
[18:05:46] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[18:05:54] <heftig> { yea => f, nay => g }
[18:05:55] <boredomist> bstrie: ah, thanks
[18:06:07] <hoverbear> heftig: yay/nay is better.
[18:06:09] <g3xzh_> Ms2ger: a is the accumulator, right?
[18:06:13] <boredomist> bstrie: but the solution he proposed (while maybe not optimal) would be very easy to implement
[18:06:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:06:31] <sfackler> I've always thought Objective C's YES/NO was kind of hilarious
[18:06:32] <hoverbear> Someone needs to make a pirate lagnuage. You can declare a function with arrrrrrrrguments.
[18:06:38] <Ms2ger> g3xzh_, yes
[18:06:46] <g3xzh_> Ms2ger: thanks a lot
[18:06:50] <Ms2ger> Np
[18:07:40] <bstrie> boredomist: if it's easy, then yes, please do. we've had a lot of confusion from people regarding whether 'self is still a priveliged lifetime name, which is why I'm excited for this change to finally clear that up once and for all
[18:07:42] <heftig> Ms2ger: can the indirection actually be optimized out?
[18:07:57] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[18:08:04] <boredomist> bstrie: alright, will do
[18:08:05] <Ms2ger> heftig, you ask like you think I can do more than looking at the docs :)
[18:08:21] <boredomist> bstrie: are you happy with the error message he proposed? "obsolete syntax: invalid `'self` lifetime; the restrictions have been removed, use any ident other than `self` here."
[18:08:30] <heftig> hoverbear: { moo => f, baa = > g }
[18:08:41] <hoverbear> heftig: This isn't a farm.
[18:09:07] <zenon> why no ternary operator?
[18:09:21] <cmr> zenon: don't need one, `if` is already an expression
[18:09:30] <cmr> rusti: if true { 4 } else { 2 }
[18:09:31] -rusti- 4
[18:09:32] <zenon> but it's too long
[18:09:34] <cmr> rusti: if false { 4 } else { 2 }
[18:09:35] -rusti- 2
[18:09:49] <bstrie> boredomist: try "invalid lifetime name: 'self is no longer a special lifetime, use any non-keyword identifier here"
[18:09:50] <cmr> so write a macro for it
[18:10:09] <bstrie> boredomist: but obsolete warnings are temporary by definition, don't stress out over it too much :)
[18:10:14] <zenon> cmr: maybe. I certainly wouldn't put if else inside a function call
[18:10:15] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[18:10:15] *** ChanServ sets mode: +ao dherman dherman
[18:10:15] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[18:10:16] <cmr> t!($a:expr, $t:expr, $f:expr)
[18:10:17] <boredomist> bstrie: works for me, thanks :)
[18:10:20] *** Quits: Ferreus (ferreus@moz-7C671BF4.dip0.t-ipconnect.de) (Ping timeout)
[18:10:23] <cmr> zenon: why not?
[18:10:28] *** Quits: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com) (Ping timeout)
[18:10:29] <zenon> too noisy
[18:10:34] <cmr> I guess
[18:10:45] <hoverbear> heftig: If you're a chicken: { buck => buck, buck => buck }
[18:10:51] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[18:11:11] <bstrie> the ternary operator only saves you 8 characters
[18:11:19] <zenon> there should be a ternary operator. a custom ternary operator decreases readability
[18:11:30] <zenon> bstrie: 8 characters are a lot in a function call
[18:11:33] *** Quits: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp) (Client exited)
[18:11:48] <cmr> Adding language complexity adds language complexity.
[18:11:59] <bstrie> cmr says things that cmr says
[18:12:04] *** Joins: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp)
[18:12:32] <bstrie> zenon: what are you trying to do?
[18:12:45] <bstrie> I've never seen anyone use a ternary *in* a function call before
[18:13:13] <zenon> bstrie: libc::exit(success ? 0 : 1)
[18:13:19] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:13:33] <cmr> success as int
[18:14:04] <bstrie> rusti: let x = true; x as int
[18:14:04] <zenon> cmr: that's works in this case but not in general
[18:14:05] -rusti- 1
[18:14:06] <cmr> I suppose it'd need to be c_int
[18:14:15] <o11c> I must say I'm sad about the lack of true ternary operator
[18:14:16] <bstrie> cmr: got it backwards :P
[18:14:19] <o11c> but I can live with it
[18:14:43] <hoverbear> o11c: What do you mean?
[18:15:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:15:08] <cmr> bstrie: so I did
[18:15:09] <o11c> because if  {} else {} is a lot of characters
[18:15:18] <bstrie> zenon: the ternary operator is itself a special case. in general, you want an `if` or a `match`
[18:15:41] <cmr> macro_rules! t { ($cond:expr : $t:expr : $f:expr) => { if $cond { $t } else { $f } } }
[18:15:45] <cmr> (since ? isn't a token)
[18:15:45] *** Quits: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp) (Connection reset by peer)
[18:16:19] <zenon> libc::exit(1 - success as i32)           <--- absolutely disgusting
[18:16:25] *** Joins: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp)
[18:16:27] <cmr> also nonportable.
[18:16:39] <cmr> libc::exit isn't idiomatic in any case.
[18:16:41] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[18:16:59] <cmr> anyway, I've only wanted the ternary operator once or twice, and I don't think it's worth the language burden.
[18:17:17] <cmr> it's super out of place in an expression language
[18:17:30] <hoverbear> cmr: +1
[18:17:31] <bstrie> cmr: we used to have the ternary operator, it got removed in october 2011 :P
[18:17:31] <eddyb> cmr: oh wow this is very bad https://gist.github.com/eddyb/9078327e85b628f72a5a
[18:17:32] <SiegeLord> if/else length also impacts one line conditionals
[18:17:38] <SiegeLord> It's just an unfortunate syntax :P
[18:17:48] <zenon> cmr: with the ternary operator you can nest three branches in one line (without braces :) )
[18:17:52] <eddyb> vec::from_elem is 20 times slower than it should be
[18:18:09] <cmr> zenon: so you write the kind of code that I would never let past a review! :P
[18:18:15] <eddyb> you've got to wonder if the compiler has been slowed down by things like this all this time
[18:18:26] <cmr> eddyb: doubt it, compiler spends most of its time in llvm
[18:18:41] <cmr> it wasn't noticably faster when it was fixed
[18:18:50] <cmr> and nobody noticed the regression
[18:18:50] <eddyb> cmr: I now wish is-rust-slim-yet made graphs of benches
[18:18:57] <eddyb> cmr: wait, do you still have all the builds?
[18:18:59] <cmr> eddyb: write the code to run the benches :)
[18:19:01] <cmr> of course I do
[18:19:11] <eddyb> can you bisect without much trouble?
[18:19:14] <bstrie> zenon: *three* branches? don't tell me you're writing nested ternary operators...
[18:19:16] <cmr> yes
[18:19:17] *** Joins: avn (root@A669D891.1F6D5CA3.172227A7.IP)
[18:19:22] <cmr> 1823 builds and counting.
[18:19:47] <o11c> bstrie: serial ternary operators are quite readable
[18:19:59] <o11c> though I think php got the operator precedence wrong
[18:20:07] <eddyb> cmr: I'd start with https://github.com/mozilla/rust/commit/73540551e5051c524b5533a5ab3eb991dda4eaac and see if that broke strcat's fix
[18:20:11] <zenon> bstrie: when I feel especially brave
[18:20:33] <cmr> eddyb: which PR was that in
[18:20:37] <cmr> I only build PR merges
[18:20:51] <eddyb> should be at the bottom
[18:20:58] <cmr> oh that is a bors merge
[18:21:07] <bstrie> zenon: I mean, I do it too, but there's a special place in programmer hell for people like you and me :)
[18:21:11] <o11c> this is the same as with no parens: a ? b : (c ? d : (e ? f : g))
[18:21:22] <o11c> so if you put line breaks after the :s ...
[18:21:22] <eddyb> cmr: I think this https://github.com/mozilla/rust/commit/35f975b8
[18:21:23] <hoverbear> Use a matchhhh statement
[18:21:36] <cmr> hoverbear: it's an expression
[18:21:45] <hoverbear> Use a matchhhh expression*
[18:21:55] <bstrie> cmr: actually the `matchhhh` keyword *is* a statement
[18:21:56] <o11c> hoverbear: matches are annoying when it's a boolean you're branching on, not a series of (x == C)
[18:21:59] <bstrie> it's a very obscure feature
[18:22:57] <bstrie> o11c: since nothing in rust automatically coerces to a boolean, that's less of a factor than it is in C
[18:23:01] <cmr> eddyb: 48ns across the board
[18:23:06] <hoverbear> So, whenever I `sudo make install` to update my rust build I get this: https://gist.github.com/Hoverbear/bb2c98772a890dac99e3 Should I be worried?
[18:23:14] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[18:23:17] <eddyb> cmr: oh, so it's newer
[18:23:23] <bstrie> in fact I don't even think you can coerce to boolean explicitly
[18:23:29] <bstrie> rusti: let x = 1; x as bool
[18:23:29] -rusti- <anon>:9:19: 9:28 error: cannot cast as `bool`, compare with zero instead
[18:23:29] -rusti- <anon>:9         let x = 1; x as bool
[18:23:30] -rusti-                             ^~~~~~~~~
[18:23:30] -rusti- error: aborting due to previous error
[18:23:30] -rusti- application terminated with error code 101
[18:23:33] <bstrie> hahaha
[18:23:37] <bstrie> awesome error message
[18:23:56] <bstrie> +1 to whoever did that
[18:24:04] *** Quits: ferminter (Mibbit@C2F316A1.C153A91D.70845BE5.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:24:06] <cmr> strcat did
[18:24:11] <hoverbear> strcat+1
[18:24:15] <eddyb> smells of Java, but at least it fits in Rust
[18:24:18] <myname> "compare" sounds like equals
[18:24:23] <myname> but...
[18:24:29] <o11c> it's kind of funny, how strcat is an unsafe function ...
[18:24:30] *** Joins: mib_tfn0mh (Mibbit@moz-980DDEA5.columbus.res.rr.com)
[18:24:32] *** Parts: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Konversation terminated!)
[18:24:33] <SiegeLord> It could be equals depending on whether 0 is true or false
[18:24:36] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[18:24:54] <hoverbear> rusti: let x = 1; (x == 0) as bool
[18:24:54] -rusti- <anon>:9:19: 9:35 error: cannot cast as `bool`, compare with zero instead
[18:24:54] -rusti- <anon>:9         let x = 1; (x == 0) as bool
[18:24:55] -rusti-                             ^~~~~~~~~~~~~~~~
[18:24:55] -rusti- error: aborting due to previous error
[18:24:55] -rusti- application terminated with error code 101
[18:25:01] <cmr> rusti: let x = 1; x == 0
[18:25:02] -rusti- false
[18:25:03] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:25:04] <bstrie> let's change "cannot cast as bool" to "will not cast as bool"
[18:25:07] <eddyb> hoverbear: ok, that is funny
[18:25:40] <eddyb> bstrie: I'd do that, but I have to actually compile it to make sure all the tests work
[18:25:43] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:25:44] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:25:48] <hoverbear> rusti: let x = 1; !x as bool
[18:25:49] -rusti- <anon>:9:19: 9:29 error: cannot cast as `bool`, compare with zero instead
[18:25:49] -rusti- <anon>:9         let x = 1; !x as bool
[18:25:49] -rusti-                             ^~~~~~~~~~
[18:25:49] -rusti- error: aborting due to previous error
[18:25:49] -rusti- application terminated with error code 101
[18:25:52] <bstrie> eddyb: we know in our hearts that if you're casting an int as bool, SOMEWHERE you're trying to use it in an if statement
[18:26:08] <hoverbear> rusti: let x = 1; (!x == 0)
[18:26:08] -rusti- false
[18:26:17] <hoverbear> :S
[18:26:18] <cmr> !x is bitwise not
[18:26:19] <myname> rusti: let x = true; x as bool
[18:26:19] -rusti- <anon>:9:22: 9:31 error: cannot cast as `bool`, compare with zero instead
[18:26:19] -rusti- <anon>:9         let x = true; x as bool
[18:26:19] -rusti-                                ^~~~~~~~~
[18:26:19] *** Joins: osa1__ (omer@moz-8FDAB45C.hsd1.il.comcast.net)
[18:26:19] -rusti- error: aborting due to previous error
[18:26:19] -rusti- application terminated with error code 101
[18:26:23] <cmr> rusti: !1i
[18:26:24] -rusti- -2
[18:26:28] <cmr> rusti: !1u
[18:26:29] <hoverbear> rusti: let x = 1; (x != 0)
[18:26:31] -rusti- 18446744073709551614u
[18:26:31] -rusti- true
[18:26:44] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[18:26:48] <cmr> eddyb: uhhh this isn't good.
[18:26:54] <hoverbear> rusti: let x = 1; !(x != 0)
[18:26:55] -rusti- false
[18:26:56] <cmr> eddyb: we've regressed even in the set_memory case.
[18:27:01] <cmr> eddyb: up to 64ns
[18:27:02] <hoverbear> rusti: let x = 1; !!(x != 0)
[18:27:02] -rusti- true
[18:27:14] <myname> obviously rust cannot cast bool to bool
[18:27:20] <cmr> rusti: true as bool
[18:27:21] -rusti- <anon>:9:8: 9:20 error: cannot cast as `bool`, compare with zero instead
[18:27:21] -rusti- <anon>:9         true as bool
[18:27:21] -rusti-                  ^~~~~~~~~~~~
[18:27:21] -rusti- error: aborting due to previous error
[18:27:21] -rusti- application terminated with error code 101
[18:27:23] <cmr> heh
[18:27:26] <hoverbear> LOL.
[18:27:36] *** Quits: fyolnish (fyolnish@moz-444A81C9.uqwimax.jp) (Ping timeout)
[18:27:39] <cmr> I know why that happens
[18:27:42] <cmr> but it's not worth fixing
[18:27:52] <hoverbear> rusti: true == 0
[18:27:53] -rusti- <anon>:9:16: 9:17 error: mismatched types: expected `bool` but found `<VI0>` (expected bool but found integral variable)
[18:27:53] -rusti- <anon>:9         true == 0
[18:27:53] -rusti-                          ^
[18:27:53] -rusti- error: aborting due to previous error
[18:27:53] -rusti- application terminated with error code 101
[18:28:12] <hoverbear> Instructions unclear... Bool is not int.
[18:28:31] <zenon> What's the idiomatic way to wrap c functions that handle null pointer arguments in a special way? two functions or one function with an Option<T> argument?
[18:28:44] <myname> cmr: will it be a generic problem?
[18:28:45] <cmr> zenon: what do you mean in a special way?
[18:28:48] <eddyb> zenon: Option<&T> and Option<~T>
[18:28:59] <cmr> myname: no? `as bool` is entirely disabled.
[18:29:08] <myname> ah
[18:29:13] *** Quits: mib_tfn0mh (Mibbit@moz-980DDEA5.columbus.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[18:29:14] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[18:29:19] <cmr> zenon: Option<SomeNonNullablePointerType> optimizes into a nullable pointer.
[18:30:01] <FreeFull> What's the advantage of disabling as bool as contrasted to translating it into != falseyvalue?
[18:30:07] <zenon> cmr: XOpenDisplay(char *display_name); if display_name = NULL { display_name = $DISPLAY }
[18:30:09] <cmr> FreeFull: it's sound
[18:30:17] <hoverbear> rusti: let cake = "Let them eat it!"; match cake { x when x == "Let them eat it!" => println!(x), _ => println!("Wtf, hoverbear?") }
[18:30:18] -rusti- <anon>:9:54: 9:58 error: expected `=>` but found `when`
[18:30:18] -rusti- <anon>:9         let cake = "Let them eat it!"; match cake { x when x == "Let them eat it!" => println!(x), _ => println!("Wtf, hoverbear?") }
[18:30:18] -rusti-                                                                ^~~~
[18:30:18] -rusti- application terminated with error code 101
[18:30:25] <FreeFull> > true as int
[18:30:29] <hoverbear> rusti: let cake = "Let them eat it!"; match cake { x if x == "Let them eat it!" => println!(x), _ => println!("Wtf, hoverbear?") }
[18:30:31] -rusti- <anon>:9:93: 9:94 error: format argument must be a string literal.
[18:30:31] -rusti- <anon>:9         let cake = "Let them eat it!"; match cake { x if x == "Let them eat it!" => println!(x), _ => println!("Wtf, hoverbear?") }
[18:30:31] -rusti-                                                                                                       ^
[18:30:31] -rusti- application terminated with error code 101
[18:30:34] <FreeFull> rusti: true as int
[18:30:35] -rusti- 1
[18:30:48] <FreeFull> rusti: Some(3) as int
[18:30:48] -rusti- <anon>:9:8: 9:22 error: non-scalar cast: `std::option::Option<<VI0>>` as `int`
[18:30:49] -rusti- <anon>:9         Some(3) as int
[18:30:49] -rusti-                  ^~~~~~~~~~~~~~
[18:30:49] -rusti- error: aborting due to previous error
[18:30:49] -rusti- application terminated with error code 101
[18:31:03] <hoverbear> rusti: "Test" == "Test"
[18:31:04] -rusti- true
[18:31:07] <hoverbear> rusti: "Test" == "Test2"
[18:31:07] -rusti- false
[18:31:17] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:31:31] <eddyb> does &'static str eq short-circuit by identity?
[18:31:41] <cmr> can't specialize on lifetime, so no.
[18:32:00] <eddyb> well, I guess it doesn't matter
[18:32:45] <eddyb> you can always short-circuit, what I was thinking was replacing the entire check with a ref_eq (which only works in contained cases)
[18:32:48] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:33:01] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[18:33:02] <cmr> if the lengths are the same, yes.
[18:33:33] <hoverbear> rusti: let cake = "Let them eat it!"; match cake { x if (x == "Let them eat it!") => println!(x), _ => println!("Wtf, hoverbear?") }
[18:33:34] -rusti- <anon>:9:95: 9:96 error: format argument must be a string literal.
[18:33:34] -rusti- <anon>:9         let cake = "Let them eat it!"; match cake { x if (x == "Let them eat it!") => println!(x), _ => println!("Wtf, hoverbear?") }
[18:33:34] -rusti-                                                                                                         ^
[18:33:34] -rusti- application terminated with error code 101
[18:34:00] <eddyb> with a ref_eq short-circuit, you can get amortized O(1) eq when working with loads constant strings (since a difference should be caught fast enough)
[18:34:16] <eddyb> as a kind of poor man's interning
[18:34:23] <zenon> Does &T implicitly cast to Some(&T)?
[18:34:27] <cmr> zenon: no
[18:34:30] <zenon> too bad
[18:34:33] <cmr> There are no implicit casts.
[18:34:42] <cmr> There are a few coercions, but they're limited.
[18:34:54] <cmr> Rust is low on magic.
[18:34:57] <eddyb> that would actually be a nice one
[18:35:03] <eddyb> since Some(&T) is a noop
[18:35:11] <eddyb> (compared to &T)
[18:35:16] <cmr> Yay, more language surface to spec :|
[18:35:40] <hoverbear> cmr: It's done when there is nothing left to remove.
[18:35:53] <achin> would rust ever have implicit casts of numerics?  (for example int to uint)
[18:35:54] <bstrie> cmr: let's just introduce a ? operator for making options nicer :P
[18:35:56] <bstrie> &T?
[18:35:57] <eddyb> cmr: is there anything which can work with benchmark metrics?
[18:36:05] <cmr> eddyb: anything being?
[18:36:14] <eddyb> cmr: like, a tool to generate graphs from multiple metrics sets
[18:36:23] *** Joins: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net)
[18:36:28] <cmr> not that I know of.
[18:36:29] <hoverbear> I heard excel made graphs.
[18:36:35] <eddyb> hoverbear: *trollface*
[18:36:44] <bstrie> hoverbear: it used to. they removed it because it wasn't a popular feature
[18:36:46] <hoverbear> eddyb: I don't have excel. :(
[18:37:01] <myname> bstrie: let's combine it with ternary operator
[18:37:17] <eddyb> you end up with what? C#?
[18:37:22] <myname> &T??t?:f?x:y
[18:37:39] <hoverbear> myname: NO!
[18:38:20] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[18:38:20] <bstrie> hoverbear: too late, I already committed the code to implement it
[18:38:32] <bstrie> and... there, just finished compiling the release candidates
[18:38:35] <bstrie> 1.0 is out the door
[18:38:37] <hoverbear> bstrie: Hahaha
[18:38:39] <bstrie> everyone celebrate!
[18:38:42] <Sharp> That was fast!
[18:38:47] <hoverbear> bstrie: +1
[18:38:53] *** Joins: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com)
[18:39:00] <eddyb> how can you celebrate??!
[18:39:20] <hoverbear> eddyb: Type &T??t?:f?x:y 5 times fast
[18:39:25] <zenon> unsafe { f() } would be nicer if one could drop the { }
[18:39:41] <eddyb> and then it would be ambiguous
[18:39:46] <bstrie> eddyb: because now that 1.0 is out, we can all start complaining about what a terrible language this is! start work on the inevitable rust successor. dependent types look neat
[18:39:48] <hoverbear> zenon: Then how would you know what was unsafe?
[18:39:49] <eddyb> and pleasing. you want unsafe coe to be pleasing?
[18:40:17] <hoverbear> zenon: The idea is to discourage unsafe.
[18:40:20] <myname> eddyb: maybe we should force the unsafe keyword to be uppercase
[18:40:25] <zenon> hoverbear: the function call right after unsafe
[18:40:29] <SiegeLord> Aww... no more self/super and no more globs... Rust imports are getting more painful to use by the minute
[18:40:34] <Ms2ger> Make it nsf
[18:40:36] <bstrie> myname: https://github.com/mozilla/rust/issues/666
[18:40:47] <cmr> SiegeLord: eh?
[18:40:54] <eddyb> bstrie: shhh, variadic generics are still waiting. like, the lamest PR in the series needs nmatsakis to look over it
[18:41:02] <bstrie> SiegeLord: I don't think self and super are gated...
[18:41:04] <bstrie> are they?
[18:41:08] <SiegeLord> Will be
[18:41:09] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:41:10] <Ms2ger> eddyb, did you mean 'latest'?
[18:41:26] <eddyb> Ms2ger: and first!
[18:41:27] <hoverbear> bstrie: Graydon's comment at the end is priceless.
[18:41:43] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[18:42:05] <myname> bstrie: maybe not every idea i have is THAT bad
[18:42:15] <cmr> Oh it's tuesday
[18:42:32] <hoverbear> cmr: Does that mean you don't have to take anything on the channel seriously?
[18:42:42] <cmr> hoverbear: no, it means the meeting is today.
[18:42:47] <myname> only on mondays
[18:42:52] <cmr> but S:N is also way down today :(
[18:43:12] <hoverbear> cmr: Means I got a final tomorrow.
[18:43:20] <bstrie> cmr: look at the number of people in the channel
[18:43:40] *** Quits: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca) (Quit: canhtak)
[18:44:07] <hoverbear> bstrie: It's under 400!
[18:44:18] * bstrie is tempted to assign Brendan Eich to fix #666
[18:44:28] *** Quits: beifeng (Mibbit@90BAFE10.A765EABF.C7DB8B78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:44:56] <hoverbear> bstrie: Just make sure he knows he has a strict deadline of 11 days from now. And we're going to call it JavaRust.
[18:45:23] <bstrie> hoverbear: actually, we've been given permission from Sun to just call it "Java"
[18:45:35] *** Quits: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com) (Ping timeout)
[18:45:36] <o11c> personally, I'd prefer "evil" as a keyword rather than "unsafe"
[18:45:41] <hoverbear> bstrie: But that's oracle's trademark.
[18:45:49] *** Parts: cmr (moznet@moz-EC676DFE.members.linode.com) (WeeChat 0.4.2)
[19:05:54] *** Joins: cmr (moznet@moz-EC676DFE.members.linode.com)
[19:06:03] <SiegeLord> What if a space ray flips a ram bit and invalidates some logic
[19:06:04] *** Joins: heftig (heftig@moz-AA7C3444.dip0.t-ipconnect.de)
[19:06:09] <strcat> o11c: the bloat cost of exceptions without being able to sensibly recover in most cases
[19:06:09] *** Joins: fyolnish (fyolnish@moz-BB8B279A.uqwimax.jp)
[19:06:13] <o11c> SiegeLord: then you're screwed anyway
[19:06:14] * eddyb wants an effect system with propagating argument-dependent conditions
[19:06:18] <SiegeLord> How do you handle that using Option/Result?
[19:06:28] <strcat> SiegeLord: ECC handles it, no problem
[19:06:30] <SiegeLord> o11c: Not in a task model where memory is isolated
[19:06:52] <SiegeLord> What if there is a bug, how do you handle that using Option/Result?
[19:07:10] <strcat> how do you handle it via task failure? losing a task is going to screw over most programs
[19:07:25] <SiegeLord> You spawn tasks which are liable to fail
[19:07:42] <SiegeLord> Tasks are a failure boundary, I thought that was the point behind them
[19:07:51] <strcat> the point behind them is concurrency
[19:07:53] *** Quits: fyolnish (fyolnish@moz-BB8B279A.uqwimax.jp) (Ping timeout)
[19:07:58] <hoverbear> strcat+1
[19:08:12] <SiegeLord> They go hand in hand
[19:08:17] <strcat> for safe concurrency you need some extent of memory isolation, but you can still share concurrent data structures
[19:08:47] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[19:08:49] <strcat> the only way to preserve the 'exception safety' bit is for any concurrent data structures to poison themselves in dtors on failure
[19:09:05] <strcat> and then any other task accessing them has to fail
[19:09:07] <o11c> strcat: *please* don't fall into the C trap of holding performance above everything ... task failure is *useful*
[19:09:14] <strcat> so now you've got failure that's really hard to recover from
[19:09:30] <SiegeLord> Well, using concurrent structures is a price you pay
[19:09:33] <strcat> I fail to see it as very useful
[19:09:35] <cmr> I can truthfully say I've never wanted or used task failure.
[19:09:36] <SiegeLord> Don't use them in reliable software
[19:09:44] <acrichto> bstrie: select() as a function is going away, select! as a macro is being introduced
[19:09:47] <strcat> don't use concurrent data structures in reliable software? lol
[19:09:54] <eddyb> cmr: were you out for a while? I think I tried to tab-complete you a few minutes ago
[19:09:58] <strcat> no one will use a language forcing you to use message passing for everything
[19:10:05] <cmr> eddyb: I parted temporarily, yes.
[19:10:12] <strcat> it's not up to rust to be that opinionated
[19:10:15] <hoverbear> zenon see acrichto 's comment
[19:10:18] <SiegeLord> cmr: Have you run your software for months at a time, with people's lifes at stake?
[19:10:32] <Ms2ger> strcat, it's up to you to be opinionated? ;)
[19:10:36] <cmr> SiegeLord: Of course not, that's not the software I write.
[19:10:46] <cmr> Probably never will.
[19:10:46] <acrichto> bstrie: zenon: https://gist.github.com/alexcrichton/7896339
[19:10:52] <SiegeLord> Well, then of course you didn't use task failure :P
[19:11:02] <eddyb> strcat: see this madness https://github.com/mozilla/rust/issues/7136#issuecomment-30257859
[19:11:16] <strcat> SiegeLord: task failure doesn't work for truly reliable software
[19:11:19] <strcat> you can't just lose a whole task
[19:11:20] <cmr> JPL doesn't allow exceptions.
[19:11:30] <zenon> acrichto: very nice
[19:11:37] <strcat> it only works for really coarse "reliably" as in your browser loses a tab but not everything
[19:11:38] <cmr> afaict
[19:11:41] <strcat> that doesn't work for a train
[19:11:57] <nmatsakis> strcat: it works in many, many circumstances.
[19:12:14] <strcat> nmatsakis: but you could have used processes in those cases too
[19:12:28] <hoverbear> Can't you detect when a task fails and respawn it?
[19:12:55] <myname> bstrie: i like how that unsafe keyword issue got number 666
[19:13:09] <nmatsakis> strcat: sure. tasks are modeled on processes, but with less context-switching overhead, easier sharing of memory, and so on.
[19:13:09] <strcat> destructor fails during unwinding -> abort
[19:13:12] <strcat> out of memory -> abort
[19:13:14] <strcat> out of stack -> abort
[19:13:24] <strcat> processes? none of that is fatal
[19:13:40] *** Quits: g3xzh_ (g3xzh@67C6887A.F9017BC2.CB858787.IP) (Quit: Leaving)
[19:13:49] *** Joins: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca)
[19:13:51] <hoverbear> Goddamnit I hate it when IRC is more interesting than my course notes
[19:13:58] <strcat> nmatsakis: if infinite recursion aborts, it doesn't seem very robust
[19:14:07] <strcat> and that's really hard to handle without aborting
[19:14:08] <SiegeLord> hoverbear: Turn off IRC ;)
[19:14:10] <Ms2ger> hoverbear, no kidding
[19:14:29] <hoverbear> SiegeLord: It's OS class, frankly this is topic material.
[19:14:40] <SiegeLord> Hah, ok then
[19:14:53] <eddyb> hoverbear: I'd be surprised to see a course more interesting than the most interesting topic from any of the channels I am in at any given time
[19:14:58] <nmatsakis> strcat: I don't necessarily expect those to abort, even if they currently do -- though admittedly there is a point where structured recovery is impossible.
[19:15:19] <hoverbear> eddyb: I'm on one channel. :-P And most of the time IRC is damned boring.
[19:15:54] <zenon> is it rust style to align the => ?
[19:16:04] <hoverbear> zenon: I always do
[19:16:19] <hoverbear> (If reasonable)
[19:16:27] <eddyb> hoverbear: then again, I'm *that* guy who's so bored of everything in school that he ended up... 01,01SPOILERQSPOILERUSPOILERISPOILERTSPOILERTSPOILERISPOILERNSPOILERG
[19:16:39] <zenon> the question is if rustfmt will unalign my carefully aligned =.
[19:16:44] <eddyb> I've made that needlessly hard. should calm down
[19:17:07] <cmr> zenon: assuredly yes
[19:17:13] <hoverbear> eddyb: I have no idea what that says.
[19:17:15] <cmr> well
[19:17:23] * hoverbear learned there is such a thing as rustfmt?
[19:17:24] <eddyb> hoverbear: you do not have teh patience
[19:17:27] <strcat> nmatsakis: handling out-of-stack via unwinding means each task needs 2 stacks (one for dtors to run on) or at least reserved space, and you need unwind tables from the bottom up
[19:17:28] <cmr> no, if they're not separated by an empty line
[19:17:41] <eddyb> is rustfmt a thing... that works?
[19:17:44] <hoverbear> eddyb: quitting?
[19:17:57] <strcat> nmatsakis: and we'll be stuck with the prelude checks in every function
[19:18:00] <Ms2ger> hoverbear, SPOILER!
[19:18:00] <cmr> eddyb: it exists in my head
[19:18:15] <eddyb> hoverbear: thank you for voiding all that time spent writing it up. bstrie would sure appreciate that gesture
[19:18:18] <strcat> nmatsakis: which also means reserving an arbitrary amount of space for FFI again
[19:18:20] * strcat shrugs
[19:18:25] <hoverbear> eddyb: Sorry. :(
[19:18:31] <hoverbear> Ms2ger: Suck it up!
[19:18:43] <Ms2ger> :(
[19:19:02] <cmr> JFS disallows all exceptions.
[19:19:08] <strcat> JFS?
[19:19:12] <cmr> JSF, sorry.
[19:19:21] <eddyb> Java File System?
[19:19:26] <eddyb> Java Safe Functions?
[19:19:26] <cmr> Joint Strike Fighter
[19:19:27] <hoverbear> Finallyyyyy, OS is talking about VMs, shame I already knew the material.
[19:19:47] <cmr> Lockheed Martin released the guidelines they used for the software they used when developing those fighter planes.
[19:19:53] <strcat> cmr: well ofc, exceptions and truly reliably software are pretty opposed - they add a ridiculous number of hidden flow control paths
[19:19:57] <cmr> right
[19:20:01] <cmr> that's what I'm saying.
[19:20:04] <strcat> but for *sort of* reliable software it's useful
[19:20:10] <strcat> like a web browser crashing a tab and not the process
[19:20:13] *** Joins: gamakichi (Mibbit@moz-E1FF077C.rev.numericable.fr)
[19:20:27] <strcat> or a server losing a client and not all clients
[19:20:35] <strcat> but it's not very robust
[19:20:36] *** Quits: gdey_ (gdey@moz-E4449B64.sd.sd.cox.net) (Ping timeout)
[19:20:42] <o11c> killing clients is the use case I'm thinking of
[19:20:48] <eddyb> hahahaha
[19:20:57] <hoverbear> o11c: Try a knife.
[19:21:01] <strcat> if one of those requests goes into infinite recursion, everything is lost
[19:21:02] <o11c> that reminds me, I wrote something at midnight last night ...
[19:21:18] <strcat> or if one of the destructors does an out-of-bounds index while unwinding
[19:21:22] *** Joins: gdey_ (gdey@moz-E4449B64.sd.sd.cox.net)
[19:21:25] <o11c> [00:43:41] < o11c> wait a minute, there *is* a way to force your children to flush - just kill them, you can always make more later
[19:21:58] <strcat> on linux a context switch between threads isn't much cheaper than between processes
[19:22:07] <hoverbear> o11c: Yeah but raising children is such a pain.
[19:22:16] <strcat> and on freebsd
[19:22:27] <o11c> hoverbear: I'm using python
[19:22:41] <hoverbear> o11c: What you choose to mate with is your decision.
[19:22:52] <eddyb> random note: I realized (while killing chrome tabs so I have enough RAM to compile rustc) that an untouched new tab page uses 50MB. come on, that is ridiculous. servo has to do better than this. maybe at some point I'll replace chrome with servo so I can browse and compile rustc at the same time :P
[19:22:54] <gamakichi> does rust have ptr arithmetic right now?
[19:23:06] <eddyb> nope. you're welcome
[19:23:18] <cmr> gamakichi: depends on what you mean by pointer arithmetic.
[19:23:29] <hoverbear> eddyb: I know, Chrome is ridiculously.
[19:23:29] <sbalmos> pointer arithmetic's bad m'kay
[19:23:40] <gamakichi> cmr: it has partial support for it?
[19:23:42] <strcat> you can do pointer arithmetic in unsafe code
[19:23:42] <eddyb> (unless you want to obfuscate your code by doing idx[vec])
[19:24:03] <cmr> gamakichi: certain cases of it is undefined behavior
[19:24:11] <eddyb> there's no operator-based pointer arithmetic
[19:24:11] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[19:24:17] <eddyb> like +
[19:24:21] <gamakichi> cmr: is it a bug?
[19:24:29] <cmr> gamakichi: no
[19:24:29] <o11c> eddyb: yeah, I miss the days when chrome was fast
[19:24:41] <cmr> gamakichi: it's the same as ptr arith in C
[19:24:46] <cmr> (minus the syntax)
[19:25:05] <hoverbear> o11c: I miss the days when it didn't start on boot and hog boats of ram and have some stupid UI toolkits I don't use that suck.
[19:25:10] <eddyb> o11c: at least firefox is also fast now, since it has had competition all this time :P
[19:25:18] <gamakichi> I thought Rust was supposed to be better than C :p
[19:25:31] <gamakichi> where is it undefined exactly?
[19:25:41] *** Joins: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch)
[19:25:56] <eddyb> gamakichi: it's better than C in that it's harder to use (there's no operators, no indexing, etc.)
[19:25:59] <cmr> http://llvm.org/docs/LangRef.html#pointer-aliasing-rules
[19:26:10] <o11c> eddyb: same story with clang making gcc better
[19:26:11] <sfackler> if you index more than a byte past an allocation, the results are undefined
[19:26:29] <gamakichi> I see, thanks
[19:26:52] *** Joins: fyolnish (fyolnish@moz-BB8B279A.uqwimax.jp)
[19:27:11] *** Joins: engla_ (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[19:27:45] <eddyb> cmr: any luck with the bisection? (if you don't mind me asking)
[19:27:54] <cmr> eddyb: just started
[19:27:57] *** Quits: avn (root@A669D891.1F6D5CA3.172227A7.IP) (Quit: WeeChat 0.4.2)
[19:27:57] <strcat> gamakichi: it's intentionally undefined, otherwise it's slow
[19:28:03] <strcat> you can only use ptr arith in unsafe blocks
[19:28:27] <eddyb> cmr: ok :). I've done nothing since then on the PNG decoder because there's probably more than one unoptimized spot
[19:28:36] *** Quits: fyolnish (fyolnish@moz-BB8B279A.uqwimax.jp) (Ping timeout)
[19:28:36] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[19:28:42] <gamakichi> thanks strcat
[19:29:09] <eddyb> strcat: hey, you're here, I just remembered. do you know whether extra operations inside a loop breaks loop-idiom
[19:29:40] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[19:29:40] <hoverbear> eddyb: You just realized he was here?
[19:29:59] <eddyb> no, I just remembered that I wanted to ask him something when he wasn't here
[19:30:22] <eddyb> strcat: I'm not sure what is going on, but I see a redundant stack load/store pair inside a tight loop (that's supposed to be a memset, but it's not optimized as such) in --opt-level=3 code
[19:31:03] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[19:31:03] *** ChanServ sets mode: +ao brson brson
[19:31:17] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[19:31:32] *** Joins: Didac (Mibbit@FC1FBACE.41C2AF7D.84437BC5.IP)
[19:31:56] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[19:32:48] <cmr> eddyb: https://github.com/mozilla/rust/pull/8780
[19:33:04] <eddyb> O(log N) <3
[19:33:06] <hoverbear> pdf.js is absolutely wonderful.
[19:33:08] <o11c> eddyb: clang has difficulties optimizing stores into memset
[19:33:17] <eddyb> cmr: haha
[19:33:23] <strcat> eddyb: loop-idiom is not very bright
[19:33:27] <strcat> loop-vectorize is smarter
[19:33:28] <zenon> How do I spawn a function with a channel as an argument via a closure. I don't understand this error: error: cannot move out of captured outer variable in a heap closure
[19:33:34] <myname> pdf.js horribly collides with my custom css :(
[19:33:35] <strcat> chances are it misses loop-idiom and gets vectorized
[19:33:42] <o11c> eddyb: if you want LLVM to do good optimizations, you have to run the optimizers twice
[19:33:44] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[19:34:05] <cmr> zenon: 0.8?
[19:34:10] <zenon> yes
[19:34:14] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:34:16] <cmr> spawn_with
[19:34:29] <hoverbear> zenon: Weren't you just asking about select() for `master`?
[19:34:37] <eddyb> strcat: could you tell why this caused a regression? https://github.com/mozilla/rust/pull/8780/files
[19:34:40] <zenon> hoverbear: yes
[19:34:49] <hoverbear> zenon: Now you're asking about 0.8?
[19:34:51] <cmr> eddyb: it's spawning a task.
[19:35:00] <zenon> cmr: can you explain why I can't call the function in the closure?
[19:35:11] <eddyb> cmr: wait what how so? does finally do that?
[19:35:16] <zenon> hoverbear: 0.8 is in the arch repos
[19:35:17] <eddyb> but the code looks inlined
[19:35:26] <cmr> zenon: there are arch nightlies
[19:35:29] <hoverbear> zenon: Master is in strcat's repo. :)
[19:35:39] <zenon> link?
[19:35:47] <strcat> [thestinger]
[19:35:49] <strcat> SigLevel = Optional
[19:35:51] <strcat> Server = http://pkgbuild.com/~thestinger/repo/$arch
[19:36:10] <cmr> zenon: closures can be called more than once, you can't move into them.
[19:36:11] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:36:17] *** Quits: Didac (Mibbit@FC1FBACE.41C2AF7D.84437BC5.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:36:18] <cmr> zenon: since fixed on master with closure reform and proc()
[19:36:31] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[19:36:49] <cmr> eddyb: finally does, yes. and the answer is monomorphization.
[19:36:58] <cmr> ... I think
[19:37:25] <eddyb> cmr: I still see an *inlined* loop that's not optimized to a memset
[19:37:26] *** Quits: gamakichi (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[19:37:59] <cmr> eddyb: probably just an optimization happening at the wrong time. *shrug*
[19:38:38] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[19:39:24] <eddyb> cmr, strcat: https://gist.github.com/eddyb/9078327e85b628f72a5a#file-vec-from-elem-ll-L331-L339
[19:39:31] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[19:40:29] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[19:41:15] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[19:41:30] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[19:41:34] <eddyb> cmr: this doesn't look like it spawns a task https://github.com/mozilla/rust/blob/master/src/libstd/unstable/finally.rs
[19:41:48] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[19:42:09] <eddyb> cmr: and my code surely doesn't call enough things for a task
[19:42:15] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[19:42:21] <cmr> yeah I think I'm wrong about finally.
[19:42:35] <eddyb> but dtors are weird
[19:42:43] <mitsuhiko> how did i miss this? the toplevel domain for serbia is .rs
[19:42:51] <zenon> strcat: works :)
[19:42:56] <zenon> cmr: works with master :)
[19:43:02] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[19:43:03] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:43:09] <eddyb> mitsuhiko: reserve all .rs domains!
[19:43:10] <zenon> Is `rust` deprecated?
[19:43:27] <zenon> rust run test.rs etc
[19:43:34] *** Parts: canhtak (canhtak@moz-1D882009.wl.t.ulaval.ca) ()
[19:43:39] <sfackler> it's been deleted
[19:43:41] <cmr> zenon: not deprecated, but removed.
[19:43:51] <zenon> Is it coming back?
[19:44:04] <cmr> If someone maintains it
[19:44:17] <mitsuhiko> 74 eur per year. not too bad.
[19:44:17] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[19:45:13] <cmr> eddyb: yeah finally is something else.
[19:45:24] <cmr> eddyb: it just registers a dtor to run.
[19:46:38] *** Joins: mib_xy40cm (Mibbit@moz-F386D515.adsl2.static.versatel.nl)
[19:46:48] *** Quits: mib_xy40cm (Mibbit@moz-F386D515.adsl2.static.versatel.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[19:47:17] <zenon> chained function calls still not possible :(
[19:47:22] <eddyb> cmr: maybe the magic used for dtors causes UB
[19:47:47] <cmr> zenon: eh?
[19:47:58] <zenon> f().g() lifetime, etc
[19:48:14] * eddyb hates how rustc produces such unreadable LLVM output
[19:48:22] <eddyb> zenon: ah, that's a problem with stack temporaries
[19:48:29] <SiegeLord> It works for me...
[19:48:38] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:49:28] <olsonjeffery> yeah. happens w/ calling iter() on a fn that returns ~[T]
[19:49:28] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Connection reset by peer)
[19:49:41] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[19:50:02] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[19:50:49] *** Joins: mib_sx92pd (Mibbit@moz-36BEFC79.hsd1.pa.comcast.net)
[19:50:55] <hoverbear> mitsuhiko: lang.rs
[19:51:02] <eddyb> the solution is to extend the lifetime of stack temporaries, but you need to make sure you're not allowing for mistakes that end up keeping things alive more than the coder originally intended
[19:51:27] *** Quits: mib_sx92pd (Mibbit@moz-36BEFC79.hsd1.pa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:51:50] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[19:51:51] *** ChanServ sets mode: +ao brson brson
[19:52:33] <zenon> Given a chan, can I block until someone calls recv() on the other end?
[19:52:34] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[19:52:43] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[19:52:47] <cmr> zenon: see rendevouz
[19:53:10] *** Joins: lenstr (lenstr@C3391098.9636F313.7A27613B.IP)
[19:53:14] <eddyb> https://github.com/mozilla/rust/blob/master/src/libstd/unstable/finally.rs#L57 that macro seems dumb now that we don't use it
[19:53:45] *** Quits: gdey_ (gdey@moz-E4449B64.sd.sd.cox.net) (Quit: Leaving...)
[19:54:04] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[19:54:09] <zenon> cmr: can't find anything
[19:54:19] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:54:35] <eddyb> strcat: is there a pass to filter out exception stuff?
[19:54:41] <eddyb> eh-purge, maybe?
[19:54:46] <strcat> eddyb: eh-prune
[19:54:53] <strcat> or whatever it's called
[19:54:59] <strcat> eddyb: it only bubbles up though
[19:55:11] <strcat> any external calls have to be marked nounwind
[19:55:16] <eddyb> I'm seeing landing pads for the loop that that's obviously impossible to fail
[19:55:17] <strcat> and rust doesn't provide a way to deal with it
[19:55:24] <strcat> eddyb: run eh-prune
[19:55:27] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[19:55:34] <strcat> and maybe dead code elimination, *maybe*
[19:55:40] <strcat> adce
[19:55:51] <strcat> I think eh-prune might do it on its own though
[19:56:02] <eddyb> need to enable those by default
[19:56:09] <eddyb> warning: Unknown pass eh-prune, ignoring
[19:56:22] <strcat> eddyb: prune-eh
[19:56:32] <strcat> try without adce first
[19:56:33] <eddyb> eh
[19:57:44] *** Quits: gdey (Mibbit@moz-E4449B64.sd.sd.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:57:56] <eddyb> strcat:   %74 = landingpad { i8*, i32 } personality i32 ()* @upcall_rust_personality // still there :(
[19:58:16] <strcat> eddyb: is there a call in that function to something that's not nounwind?
[19:58:41] <eddyb> strcat: I can barely tell what's going on
[19:58:47] <strcat> eddyb: just look for call instructions
[19:58:55] <strcat> then check if those functions have the nounwind attribute
[19:59:19] <strcat> you probably have some external call LLVM thinks can unwind
[20:00:23] *** Quits: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP) (Quit: Leaving.)
[20:00:27] <strcat> gcc has __attribute__((nothrow)) to mark functions in headers as a way to deal with this
[20:00:32] <strcat> and it has -fno-unwind-tables + -fno-exceptions
[20:00:47] <o11c> wouldn't adding a nothrow attribute in *rust* be easy?
[20:00:58] <eddyb>   call void @_ZN8unstable4lang17fail_bounds_check18hcb910a4a141408bar8v0.9.preE({ i64, %tydesc*, i8*, i8*, i8 }* undef, i8* getelementptr inbounds ([7 x i8]* @str2140, i64 0, i64 0), i64 1, i64 %i.1184.i.i.i.i, i64 5)
[20:01:10] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[20:01:10] <eddyb> wait, no, bad copy
[20:01:25] <strcat> o11c: I don't think so
[20:01:26] <eddyb>   invoke void @"_ZN8unstable7finally18Drop$Finallyalizer4drop20h5b8c344136b8d92YtaS8v0.9.preE"(%"struct.std::unstable::finally::Finallyalizer[#1]"* %_d.i.i)
[20:01:30] <strcat> the issue is external functions
[20:01:37] <strcat> so yeah, you could add #[unsafe_nounwind]
[20:01:44] <strcat> but we should really just be reading headers with libclang
[20:01:48] <eddyb> strcat: invoke means exception-handling?
[20:02:14] <strcat> eddyb: invoke == call, but it goes to the specified landing pad if it unwinds
[20:02:34] <eddyb> strcat: see, that should be inlined
[20:03:38] <eddyb> so it's putting the vec::from_elem finalizer closure on the stack
[20:04:00] <eddyb> and then calling the drop method on the finalizer which will call that closure
[20:04:04] <strcat> meh, exceptions
[20:04:05] <strcat> ;p
[20:04:24] <eddyb> why can't it inline the drop?
[20:04:47] *** Joins: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP)
[20:04:48] <strcat> is it marked #[inline]?
[20:05:16] *** Quits: rca (rcatolino@7F54AB21.28091F66.520D6FA6.IP) (Ping timeout)
[20:05:18] <o11c> strcat: "really should be" sounds like the kind of thing that will be put off for years and we'll have to put up with unnecessary invokes
[20:05:28] *** Joins: rca (rcatolino@7F54AB21.28091F66.520D6FA6.IP)
[20:06:12] <strcat> I just want -Z no-unwind
[20:06:33] *** Joins: fyolnish (fyolnish@moz-A452A5CA.uqwimax.jp)
[20:06:37] *** Joins: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP)
[20:06:48] <strcat> don't output landing pads or invokes, mark everything nounwind ;p
[20:07:03] <zenon> does port.send block?
[20:07:20] <eddyb> strcat: https://github.com/mozilla/rust/blob/master/src/libstd/unstable/finally.rs#L66 (╯°□°）╯︵ ┻━┻)
[20:08:14] *** Quits: fyolnish (fyolnish@moz-A452A5CA.uqwimax.jp) (Ping timeout)
[20:09:14] <eddyb> I am not willing to recompile librustc to test that change
[20:09:40] <eddyb> is there a way to recompile only stage1-std and everything that depends on it?
[20:10:46] <eddyb> strcat: how do I static link?
[20:11:21] <Diamond> --staticlib
[20:11:43] <eddyb> I can probably get somewhere with LTO. but I doubt I have all the changes that I need to actually get LTO working
[20:12:31] <cyndis> zenon: http://static.rust-lang.org/doc/master/extra/comm/fn.rendezvous.html
[20:12:32] <boredomist> bstrie: dbaupp: r? https://github.com/mozilla/rust/pull/10897
[20:12:37] <strcat> eddyb: --rlib?
[20:12:53] <boredomist> added the "'self lifetime is no longer valid" error and a new test file for it
[20:15:28] <zenon> cyndis: thanks
[20:15:50] <eddyb> strcat: thanks, but it's easier if I can recompile stage1-std :/
[20:16:10] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[20:16:25] <eddyb> which I don't know to and I'm falling asleep
[20:16:29] <eddyb> *how to
[20:17:33] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[20:17:57] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[20:19:33] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[20:20:06] <eddyb> cmr: hah, the kisses. didn't see that one coming
[20:21:05] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[20:21:25] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[20:21:52] *** Joins: zslayton (Mibbit@81EB2473.5F4BC84E.66C78B76.IP)
[20:22:31] *** Quits: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP) (Quit: victorporof)
[20:24:36] *** Joins: gdey (gdey@moz-CD850554.static-ip.telepacific.net)
[20:24:42] *** Quits: gdey (gdey@moz-CD850554.static-ip.telepacific.net) (Client exited)
[20:24:45] *** Joins: gdey (gdey@moz-CD850554.static-ip.telepacific.net)
[20:25:44] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[20:26:15] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[20:27:42] <ezyang> Can I write a method with an argument ~self rather than &self? (so it uses up the thing it's called on) 
[20:28:38] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[20:28:43] <eddyb> ezyang: yes :D
[20:28:47] <ezyang> sweet 
[20:31:24] <eddyb> you use impl on ~T and use &mut self to change the pointer itself, if you want to
[20:32:24] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[20:35:22] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[20:35:41] *** Quits: Addle (quassel@moz-67A92E8A.cable.teksavvy.com) (Ping timeout)
[20:36:12] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[20:36:31] <eddyb> ezyang: if you have a trait, you can impl it for Option<~T> and do something fancy with .take(): https://github.com/eddyb/rust-png/commit/0bb2c101c9cf61c6a74db3b0efc4a1ed294eb836#diff-6c23291b20d72466c43880dd8e4a3cc7R756
[20:37:20] <ezyang> hmmk 
[20:37:31] <ezyang> Well, first, I have to figure out what the appropriate ownership structure of my code is 
[20:38:06] *** Joins: Addle (quassel@93529591.BA907378.971E19F6.IP)
[20:39:15] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:41:07] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[20:41:27] <ezyang> So, fractional ownership in Rust has to be implemented using unsafe {}, is that correct? 
[20:41:54] <ezyang> e.g. I have some vector and I want to split it into two different separately owned pieces 
[20:42:46] <strcat> it's already implemented for you, though
[20:42:52] *** Quits: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP) (Quit: Leaving.)
[20:42:53] <ezyang> Yeah, for vectors it is 
[20:43:13] <strcat> Rc (shared ownership), Cell/RefCell (dynamic mutability)
[20:43:32] <strcat> ezyang: do you just mean you want disjoint mutable views (as in mut_split_at) or actual shared ownership?
[20:43:53] <ezyang> Actual shared ownership. I'm splitting up mmap'd chunks of memory 
[20:44:25] <strcat> does it need to be mutable?
[20:44:42] <ezyang> Yeah, definitely. 
[20:44:57] <strcat> well then you're basically stuck with Rc<RefCell<MappedMemory>>
[20:45:42] *** Quits: t25 (manu@moz-5D020DB4.otago.ac.nz) (Ping timeout)
[20:46:18] <ezyang> Well, I was thinking I'd do something unsafe instead. I'll probably just not worry about deallocation right now 
[20:46:21] *** Joins: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP)
[20:47:13] *** Joins: t25 (manu@moz-5D020DB4.otago.ac.nz)
[20:49:35] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[20:50:36] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[20:54:16] * geomyidae__ is cursing whoever told him to use rust-bindgen
[20:54:22] <geomyidae__> two days later and I'm still fighting it
[20:54:44] <SiegeLord> What problems are you having?
[20:55:47] *** Joins: amphibulus (Mibbit@15E64609.6A8A1F30.A34EC3BB.IP)
[20:55:50] *** Parts: amphibulus (Mibbit@15E64609.6A8A1F30.A34EC3BB.IP) ()
[20:55:56] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[20:56:19] *** Quits: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP) (Quit: Leaving.)
[20:57:03] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[20:57:13] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[20:58:16] *** Joins: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP)
[20:59:15] *** Joins: Hildar (Mibbit@moz-7F4621B6.cable.virginm.net)
[20:59:49] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[21:00:15] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Ping timeout)
[21:00:40] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[21:01:40] <geomyidae__> I think they're manageable now. Had some personal issues with my clang install and headers and where Arch places them and then some linker error that was fixed when rust-bindgen fixed their build for rust-master. Anyway, it's just a bunch of C types that aren't matched up with the bindings I'd generated by hand that I guess I'm going ot have to cast or
[21:01:41] <geomyidae__> something. TBH I haven't looked at it a whole lot since last night and I was pretty tired when I called it quits.
[21:04:13] <geomyidae__> https://github.com/colemickens/pcapfe/blob/master/build_log.txt
[21:04:25] *** Joins: gdey_ (gdey@moz-CD850554.static-ip.telepacific.net)
[21:04:32] <geomyidae__> or mutability issues, anyway, nothing unmanageable, just that I had something working before starting over is all :P
[21:04:32] *** Quits: lenstr (lenstr@C3391098.9636F313.7A27613B.IP) (Ping timeout)
[21:05:16] *** Joins: frogmella (Mibbit@2AACB6E1.A033706C.284344F5.IP)
[21:05:42] *** Quits: gdey (gdey@moz-CD850554.static-ip.telepacific.net) (Ping timeout)
[21:06:27] <zenon> Can a write a custom destructor for something on the stack? let a = f(); a.close(); a.bla(); => compiler error: a not accessible
[21:06:31] *** Joins: fyolnish (fyolnish@moz-62C51E1E.uqwimax.jp)
[21:07:12] <benh> yeah. `close` can take `a` by value
[21:07:14] <sfackler> zenon: you can make close take self by value
[21:07:31] <benh> there's also the drop function in std that takes by value and then does nothing
[21:07:46] <benh> so if you have a regular destructor, you can just call drop() on `a` and it'll be inaccessible
[21:07:51] <sfackler> but instead of making a close method, I would just close in a Drop implementation
[21:08:32] <SiegeLord> I don't see 'drop' in the documentation... is it the search being broken again?
[21:08:44] <sfackler> SiegeLord: it's in the prelude
[21:08:50] <zenon> but then the whole struct is copied, no? sounds inefficient
[21:09:18] <sfackler> drop(foo) will usually inline and optimize to a direct call to foo's destructor
[21:09:26] <SiegeLord> sfackler: Should still be searchable, no?
[21:09:27] <strcat> s/usually//
[21:09:41] <strcat> inlining is a deterministic, iterative process
[21:09:44] <sfackler> SiegeLord: it should, but there are some weird javascript bugs that break search sometimes
[21:09:51] <SiegeLord> Heh
[21:09:52] <strcat> if it's below the inlining cost threshold and is a static call, it's inlined
[21:09:57] <SiegeLord> Is there an issue for these bugs?
[21:10:16] <sfackler> I think I filed it
[21:10:21] *** Quits: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch) (Quit: WeeChat 0.4.2)
[21:10:51] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[21:11:24] <zenon> rtest.rs:19:4: 19:13 error: explicit call to destructor rtest.rs:19     a.drop();
[21:11:40] <sfackler> zenon: you want drop(a), not a.drop()
[21:11:54] <sfackler> semi-confusingly :)
[21:12:21] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[21:12:26] <sfackler> std::prelude::drop is a function that takes a thing by value and does nothing with it
[21:13:03] <zenon> ah, I see
[21:13:26] <strcat> we should make it so that you can just call drop if you own the type
[21:14:07] *** Quits: fyolnish (fyolnish@moz-62C51E1E.uqwimax.jp) (Ping timeout)
[21:14:25] <sfackler> it would make drop a bit more magical than it already is, but it would be nice
[21:14:58] <strcat> preventing you from calling the method is already mgic
[21:15:00] <strcat> magic*
[21:15:17] <zenon> but that's not nice. why would I drop a file instead of closing it? if I write a method close(mut self) { ... }, is that going to be inlined too?
[21:15:17] <strcat> preventing you from calling it only in certain situations wouldn't be much more magical
[21:15:35] <strcat> zenon: because a file type in rust is going to be using a dtor for closing
[21:15:54] <strcat> and the way to obtain a file object will open a file
[21:16:25] <strcat> letting it go out of scope to close is almost always good enough
[21:17:50] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[21:17:50] *** ChanServ sets mode: +ao dherman dherman
[21:19:09] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[21:19:10] <zenon> but assuming that I want to write a custom dustructor: is close(self) { } going to be inlined automatically?
[21:19:36] <strcat> zenon: a custom destructor is a Drop implementation
[21:19:48] <strcat> inline is an LLVM optimization pass
[21:20:13] <strcat> it iteratively inlines any functions below the size threshold that have their implementation available
[21:20:47] <zenon> I sometimes see #[inline]. What's the meaning of that?
[21:21:24] <strcat> it adds an inline hint (raises the threshold) - usually not a good idea, and also enables cross-crate inlining for that function
[21:21:35] <strcat> although if you use LTO, cross-crate inlining works for any function
[21:21:42] <strcat> and #[inline] is just going to slow down the compile in that case
[21:22:38] <zenon> LTO?
[21:22:47] * geomyidae__ same quesiton
[21:22:59] <rpearl> link-time optimization
[21:23:12] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[21:24:01] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[21:24:01] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:24:42] *** Quits: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP) (Ping timeout)
[21:24:52] *** Joins: jvns (bork@87D98E32.4046EB22.428F94DD.IP)
[21:27:25] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: ZZZzzz…)
[21:28:39] *** Quits: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net) (Ping timeout)
[21:31:50] <bstrie> acrichto: that select macro looks really neat, is that implemented today?
[21:33:00] *** Joins: AbigailBuccaneer (jetbeard@moz-401B3EBC.cable.virginm.net)
[21:33:33] <acrichto> bstrie: only in my PR, not landed yet
[21:34:22] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[21:34:52] *** Quits: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP) (Client exited)
[21:35:48] *** Quits: bynaryshef (bynaryshef@moz-8DC69446.mem.bellsouth.net) (Quit: Leaving)
[21:36:10] *** Quits: fabiand (fabiand@moz-C3EB22E8.adsl.alicedsl.de) (Quit: Verlassend)
[21:37:33] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:39:18] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[21:39:22] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[21:40:44] *** Quits: alex-abreu (alex@moz-4B4D75AD.rev.sfr.net) (Ping timeout)
[21:41:22] *** Joins: enix_ (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[21:41:23] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[21:42:21] *** Joins: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[21:42:32] *** flaper87|afk is now known as flaper87
[21:42:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[21:42:57] *** Quits: Ms2ger (Ms2ger@moz-97D6582B.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:44:36] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[21:44:56] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:45:28] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:46:59] *** Quits: enix_ (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[21:47:08] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:48:05] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[21:48:09] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:48:51] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[21:49:09] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:49:14] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[21:49:54] *** sam113101 is now known as sam113101_afk
[21:50:49] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:51:25] *** Joins: refold (gman@moz-42D68426.a258.priv.bahnhof.se)
[21:52:50] *** Joins: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[21:52:57] *** Quits: vmx (vmx@moz-B510001A.pools.arcor-ip.net) (Quit: Leaving)
[21:53:56] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[21:55:00] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[21:56:23] *** Joins: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP)
[21:56:32] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:56:32] *** ChanServ sets mode: +o tjc
[21:59:11] *** Quits: nkoep (nik@moz-D34D8194.pool.mediaways.net) (Ping timeout)
[21:59:29] *** Quits: ptc (Adium@C527BAE3.AA178CE2.C16CA642.IP) (Quit: Leaving.)
[22:00:32] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:01:28] *** Quits: jvshahid_ (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP) (Ping timeout)
[22:01:47] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[22:02:54] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:03:56] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:04:06] <aatch> Hmm, I'm not liking the way the integer-reading functions just return 0 if something goes wrong...
[22:06:31] *** Joins: fyolnish (fyolnish@moz-61B95E.uqwimax.jp)
[22:07:27] *** Quits: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP) (Quit: colinsurprenant)
[22:08:12] *** Quits: fyolnish (fyolnish@moz-61B95E.uqwimax.jp) (Ping timeout)
[22:09:00] *** Joins: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com)
[22:10:49] *** Quits: ksev (DrunkenPan@moz-65085A9A.bredband.skanova.com) (Ping timeout)
[22:11:02] <sfackler> aatch: they should raise an underlying condition first though, right?
[22:12:37] *** Joins: g3xzh (g3xzh@moz-19E10D7.red.bezeqint.net)
[22:13:06] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:13:09] <aatch> sfackler, nope. They just use read (which doesn't raise the condition)
[22:13:35] <sfackler> but read will raise an io_error
[22:13:37] *** Joins: nkoep (nik@moz-5C99E1ED.vpn.rwth-aachen.de)
[22:13:53] <sfackler> or are you talking about eof behavior?
[22:14:15] <aatch> sfackler, I'm gonna say eof behaviour.
[22:14:36] <sfackler> that may be busted
[22:14:54] <sfackler> they should probably raise an io_error if it can't read enough bytes for the type it needs
[22:15:09] <sfackler> but the entire error handling process for io is being redone
[22:15:27] <aatch> especially since you have to try to read past the end before you know, effectively nessitating a check after every read.
[22:15:33] *** Joins: jvshahid (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP)
[22:15:43] *** Quits: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[22:16:50] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:17:34] *** sam113101_afk is now known as sam113101
[22:17:47] <bstrie> mitsuhiko: "Not many languages manages to implement map in a way that ["1", "2", "3"].map(parseInt) would result in [1, NaN, NaN]."  <-- this is horrifying
[22:18:11] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:18:17] <mitsuhiko> bstrie: what's horrifying is how many people defend this as being an awesome practical feature
[22:18:24] <aatch> bstrie, I hate javascript...
[22:18:25] <bstrie> haha
[22:18:29] <mitsuhiko> all i see is how you can never ever add any optional parameters to functions again without breaking backwards compatibility
[22:18:38] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[22:19:07] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[22:19:24] <bstrie> I like to think that rust has enough type-safety to neutralize mozilla's karma in this area
[22:19:28] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[22:20:43] * ChrisMorgan can cope with working in JavaScript but doesn't much like it as a language and really wants Rust + Emscripten to become practical
[22:20:52] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:21:41] *** jdm is now known as jdm|away
[22:22:01] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[22:22:26] <aatch> Oh god. Map passes *3* arguments to the callback.
[22:22:43] <aatch> `.map()` rather.
[22:23:19] <aatch> value, index, this(?)
[22:23:25] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[22:23:26] <aatch> in that order.
[22:24:12] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Ping timeout)
[22:24:18] <FreeFull> I'd rather have it be called something else than map if it does that
[22:24:41] * ChrisMorgan is never quite sure which side to take in arguments between JavaScript and things like PNaCl
[22:25:28] <FreeFull> Just take neither side
[22:25:30] <rossm> I do find .net's Select overload occasionally useful. it passes an index as the second parameter. but you'll always know you're calling it because static typing
[22:26:39] <strcat> rusti: for x in range(5, 10).enumerate().map(|a, b| a * b) { println!("{}", x) }
[22:26:42] -rusti- pastebinned 13 lines of output: http://sprunge.us/HAGR
[22:26:46] <ChrisMorgan> Seriously, having a weird and inconsistent API isn't terribly problematic—in a statically checked language. It's when you combine it with a language like JavaScript that it becomes particularly dangerous.
[22:26:52] <rossm> agreed
[22:26:53] <strcat> rusti: for x in range(5u, 10).enumerate().map(|a, b| a * b) { println!("{}", x) }
[22:26:54] -rusti- pastebinned 13 lines of output: http://sprunge.us/OeVV
[22:27:01] * strcat gives up
[22:27:06] <strcat> rusti: for x in range(5u, 10).enumerate().map(|(a, b)| a * b) { println!("{}", x) }
[22:27:13] -rusti- pastebinned 6 lines of output: http://sprunge.us/OGfC
[22:27:25] <tjc> ChrisMorgan: When in doubt, switch between sides of the argument every two days or so. That's the most fun.
[22:27:28] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[22:28:00] <ChrisMorgan> tjc: how about promoting yet another alternative instead?
[22:28:21] <ChrisMorgan> "Let's do typed JavaScript in XML!"
[22:28:35] <zenon> Does range(10, 1) work?
[22:28:37] <bstrie> rather, let's just use XML directly
[22:28:38] <tjc> ChrisMorgan: Oh, right -- add a third alternative, then rotate between all of them every day :-)
[22:28:39] <ChrisMorgan> (That being one example of such a thing.)
[22:29:00] <bstrie> rusti: for x in range(2, 1) { println!("{}", x); }
[22:29:01] -rusti- ()
[22:29:14] <ChrisMorgan> "Come on man, you're crazy saying that!" "Don't worry, I'll be on your side tomorrow. Just doin' the rounds…"
[22:29:18] <bstrie> rusti: for x in range(1,2).invert() { println!("{}", x); }
[22:29:19] -rusti- 1
[22:29:19] -rusti- ()
[22:29:22] <bstrie> zenon: ^
[22:29:27] <tjc> ChrisMorgan: well, the most important thing is sincerity
[22:29:34] <tjc> if you can fake that, you can win any programming language argument
[22:29:47] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[22:30:04] <hoverbear> Be hard on your opinions.
[22:30:05] <ChrisMorgan> Nah, that's not necessary at all. I find debates are often easiest to win when fighting on the side you don't believe.
[22:30:05] <aatch> "I zealously believe in this point of view! (today)"
[22:30:10] <bstrie> tjc: I win arguments by citing random websites that I know nobody will check
[22:30:17] <hoverbear> "
[22:30:19] <bstrie> it makes me seem authoritative
[22:30:34] <hoverbear> "When debating your opinions, fight like you're right, but listen like you're wrong."
[22:31:34] * ChrisMorgan still has a rankling experience of the academic scorn of Wikipedia in the one case where there was an uncited data point, which lost him ½ a mark of a 10 mark assignment, while citing contradictory school projects was completely fine
[22:32:26] <tjc> bstrie: I don't suppose you spend a lot of time editing Wikipedia... ;-)
[22:32:42] <tjc> ChrisMorgan: Well, that's why I said faking sincerity, rather than having it :-)
[22:33:07] <bstrie> tjc: the drudgery of having to cite real sources is what keeps me from rewriting rust's wikipedia page
[22:33:11] <ChrisMorgan> Even faking it isn't always necessary (depends on the audience).
[22:33:34] <tjc> bstrie: step 1: create a Rust wiki page, or even just post on the email list. step 2: cite it in wikipedia. step 3: profit
[22:33:37] <tjc> I'm not even kidding in this case
[22:33:41] *** sam113101 is now known as sam113101_afk
[22:33:42] <tjc> except about the profit part
[22:34:03] <ChrisMorgan> Yeah, you've got to be a sneaky PR firm to do that part.
[22:34:38] <strcat> tjc: meh that's not right
[22:34:48] *** Quits: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org) (Ping timeout)
[22:34:55] <strcat> just cite random books
[22:35:07] <strcat> no one is actually going to go find a copy of the book to check
[22:35:16] <bstrie> better yet, just invent books
[22:35:26] <aatch> Relevent xkcd: http://xkcd.com/978/
[22:35:26] <bstrie> nobody is going to check that it's fake
[22:36:05] <bstrie> aatch: I'm sad that randall hasn't yet made a comic about the "relevant xkcd" phenomenon, so that we could cite it every time someone cites a relevant xkcd
[22:36:08] <tjc> strcat: one of my favorite -- indirect -- Wikpedia edits is in the article on Haskell...
[22:36:21] <tjc> Somebody cited a Haskell mailing list post from me, about how "Haskell" is pronounced
[22:36:23] <indirect> I didn't do it
[22:36:34] <tjc> indirect: oops
[22:36:37] <indirect> :)
[22:36:39] <tjc> My mailing list post was totally uncited
[22:36:51] <strcat> tjc: the sqlite page cites audio clips with the author pronouncing it two different ways ;]
[22:36:52] <tjc> but somebody else added it to the Wikipedia on article to prove that Haskell was pronounced the way I'd said it was
[22:36:57] <indirect> secondary sources!
[22:36:57] <ChrisMorgan> Wow, 2½ months since 0.8? How did that happen?
[22:36:59] *** Joins: alan (alan@32702EE8.939109B2.FB082A98.IP)
[22:37:02] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[22:37:02] <indirect> that's all wikipedia needs :P
[22:37:05] <tjc> strcat: heh. it took me years to realize that "SQL" wasn't pronounced "sequel"
[22:37:12] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Connection reset by peer)
[22:37:19] * ChrisMorgan still, deliberately, pronounces it "sequel"
[22:37:21] <indirect> tjc: it's so much worse that ruby has a library named "sequel"
[22:37:25] *** Joins: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP)
[22:37:26] <Scriptor> most people I know pronounce it sequel
[22:37:27] <bstrie> tjc: wait, how is haskell pronounced?
[22:37:28] <aatch> bstrie, maybe he doesn't do it deliberately to stop the internet from stalling.
[22:37:32] <tjc> indirect: and does it have anything to do with databases?
[22:37:32] <indirect> so now you can't tell if they pronounce it that way, or if they are talking about the lib
[22:37:34] <strcat> tjc: well I find if you don't say 'sequel' people don't know what you're talking about
[22:37:36] <tjc> bstrie: stress on the first syllable
[22:37:37] <strcat> ;\
[22:37:42] <bstrie> aatch: some people just want to watch the world burn
[22:37:42] <indirect> tjc: predictably, it's an ORM
[22:37:47] <bstrie> tjc: you must be joking
[22:37:48] <tjc> huh, I'd been told by somebody that if you say it "sequel", you'll be outed as a noob
[22:37:50] <tjc> idk though
[22:37:59] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:37:59] <tjc> bstrie: About Haskell, you mean?
[22:38:03] <bstrie> yeah
[22:38:04] <Scriptor> hardly
[22:38:07] <bstrie> HA-skul
[22:38:13] <bstrie> ha-SKELL
[22:38:17] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[22:38:22] <bstrie> ^ latter just sounds better
[22:38:26] <Scriptor> really?
[22:38:29] <aatch> Clearly it's pronounced 'Suckwell' :P
[22:38:43] <Scriptor> I always thought 'erlang' would be better pronounced 'erlung'
[22:38:43] <bstrie> motion to pronounce "haskell" as "wooster"
[22:38:48] <tjc> bstrie: Every time I've talked to somebody who was on the Haskell committee, a GHC developer, etc., they pronounced it with the stress on the first syllable
[22:39:01] <aatch> In the kiwi accent those two sound pretty much identical.
[22:39:02] <ezyang> How do I cast a uint to a pointer? 
[22:39:05] * ChrisMorgan pronounces it with emphasis on both, Has - Kell
[22:39:09] <aatch> Yay for the schwa!
[22:39:10] <tjc> ezyang: you need an unsafe block
[22:39:14] <ChrisMorgan> Hass - Kell, rather
[22:39:20] <tjc> ChrisMorgan: in a good example of the "third option" strategy :-)
[22:39:27] <ezyang> tjc: Do I just do uint_thing as *mut T? 
[22:39:39] <tjc> ezyang: No, you also need to use unsafe::transmute
[22:39:40] <aatch> ChrisMorgan, makes it seem like a Klingon word.
[22:39:41] <tjc> if it's still called that
[22:39:42] <bstrie> tjc: if that's how the namesake for haskell actually pronounced his name, then I'm willing to accept it. but I'll never understand why the scayla people insist on scalla
[22:39:49] <tjc> in any case, there's a library function in std::unsafe
[22:39:58] * ChrisMorgan doesn't exactly get to hear people speaking of it much, but that's the pronunciation he heard initially from his brother who was using it in his degree
[22:40:01] <tjc> bstrie: I don't understand why some people pronounce Scala "scayla" :P
[22:40:04] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[22:40:09] * bstrie rages
[22:40:19] <tjc> my work here is done
[22:40:20] <ChrisMorgan> Scayla is the main pronunciation I've heard in Melbourne.
[22:40:30] <aatch> tjc, Troll Wins!
[22:40:32] <ezyang> transmute seems to be in std::cast 
[22:40:39] <ChrisMorgan> Yep. Biting is fun :-)
[22:40:55] <tjc> aatch: true story: I'm such a subtle troll that I spent almost 3 years working at Mozilla solely with the goal of trolling the channel after leaving ;-)
[22:40:55] <bstrie> is it too late to insist that this language be pronounced "roost"?\
[22:41:01] <aatch> ChrisMorgan, Baiting*?
[22:41:05] <tjc> bstrie: Rust needs more umlauts
[22:41:12] <bstrie> and can we roll the R?
[22:41:19] <bstrie> rrrroost
[22:41:21] <ChrisMorgan> aatch: no: biting the bait set by tjc
[22:41:21] <tjc> I can't
[22:41:23] <tjc> maybe you can
[22:41:42] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[22:41:48] <bstrie> tjc: then you should fork the language and change the pronunciation
[22:41:54] <tjc> bstrie: good idea
[22:42:18] <ChrisMorgan> Ŕüşṫ
[22:42:43] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[22:42:43] <dbaupp> rusti: 1u as *mut int
[22:42:44] -rusti- (0x1 as *mut ())
[22:42:56] <ChrisMorgan> Actually, I like ŧ more than ṫ.
[22:42:59] <dbaupp> ezyang: ^ works fine (although this may get removed in favour of transmute)
[22:43:16] <ezyang> Well, I think what I will do is make a custom uint_to_ptr function 
[22:43:26] <tjc> R̵̙̗̗̫̙̀͠u̴͡҉̣͎͚̫͇̗̙͇̫̹̝̺̝̼ś̵̛̬͉̞͠t̷̀͝͏̠͎͓͇̺̣̹̙̘̰̫
[22:43:26] <ezyang> it's too bad I can't 'impl uint { ... }' 
[22:43:50] <tjc> ezyang: overlapping instances
[22:43:52] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:43:56] <dbaupp> ezyang: yeah, need traits for built-ins
[22:43:57] <tjc> you can do it if you make a newtyped uint, though
[22:43:59] <dbaupp> tjc: ?
[22:44:07] <tjc> dbaupp: I thought the reason you can't do that is overlapping instances
[22:44:10] <tjc> aka coherence
[22:44:17] <dbaupp> tjc: isn't it just built-ins can't have non-trait impls?
[22:44:24] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[22:44:24] *** ChanServ sets mode: +ao pcwalton pcwalton
[22:44:26] <ChrisMorgan> tjc: now you're just being silly. I at least was being practical. :-)
[22:44:27] <dbaupp> (although this maybe a coherence thing?)
[22:44:32] <ezyang> felt like orphan problem to me... 
[22:44:32] <tjc> dbaupp: That's the rule, but I thought the reason for the rule was coherence
[22:46:09] <dbaupp> tjc: I guess, if allowed without restrictions, then one could have two crates with `impl uint { fn foo(&self) {} }`, which would lead to an upset compiler/linker
[22:46:42] <tjc> dbaupp: Right
[22:46:52] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[22:46:52] <tjc> and the problem -- as with overlapping instances -- is that you wouldn't know about the error till link time
[22:46:56] <dbaupp> I believe strcat has suggested a #[this_crate_owns_builtins] annotation, or using lang items, to allow direct impls; which would be nice for all the silly traits in str and vec.
[22:47:24] <strcat> associate each built-in with a lang item and allow impl'ing methods via the lang item or just if the crate defines that lang item
[22:47:41] <strcat> I'm not entirely sure what the best way to go about implementing it would be
[22:48:00] <strcat> I started on it by dealing with it in method resolve and it didn't work out
[22:48:15] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[22:48:27] *** Quits: gdey_ (gdey@moz-CD850554.static-ip.telepacific.net) (Client exited)
[22:48:28] <dbaupp> strcat: oh, you're working on it?
[22:48:30] *** Joins: gdey (gdey@moz-CD850554.static-ip.telepacific.net)
[22:48:42] <strcat> dbaupp: not really
[22:48:50] <strcat> I was just thinking about it by playing with it
[22:49:00] <dbaupp> experimenting with it, close enough :)
[22:50:37] *** Joins: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com)
[22:50:43] *** Joins: gdey_ (gdey@moz-CD850554.static-ip.telepacific.net)
[22:51:03] <ezyang> Does Rust have NewtypeDeriving? 
[22:51:05] <ezyang> (for traits) 
[22:51:37] <ezyang> Seems to be https://github.com/mozilla/rust/issues/8353 
[22:51:39] *** Quits: gdey (gdey@moz-CD850554.static-ip.telepacific.net) (Ping timeout)
[22:52:24] <dbaupp> ezyang: it's hard to do with the current design of #[deriving]
[22:52:53] <dbaupp> since that happens purely on the AST (same phase as macro expansion), i.e. no type information, and not even the method signatures of the traits.
[22:53:07] <ezyang> hmmk 
[22:53:13] <ezyang> Well, time to write a bunch of boilerplate. 
[22:53:17] <dbaupp> yup :(
[22:55:00] *** Quits: jvshahid (jvshahid@BE83DFD.50866E69.CA2DF2C0.IP) (Ping timeout)
[22:55:22] *** Quits: jstevans1 (Instantbir@6F907BF0.83BCE10.DDE5D3F6.IP) (Ping timeout)
[22:55:39] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[22:55:48] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Quit: Leaving)
[22:55:50] <dbaupp> bstrie: is rust meant to be lower case in the sidebar of /r/rust?
[22:56:04] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[22:56:32] <ezyang> whoa, foo<T>(0); is not valid syntax, Rust infers the parameter? Nifty 
[22:56:47] <dbaupp> foo::<T>(0) is the correct syntax for a type hint
[22:57:00] <ezyang> I see 
[22:57:01] <dbaupp> (and they are normally optional, yse)
[22:57:06] <dbaupp> s/se/es/
[22:57:29] <zenon> dbaupp: What's the purpose of ::?
[22:57:35] <ChrisMorgan> It's foo::<T>(0) rather than foo<T>(0) so that the syntax is unambiguous.
[22:57:42] <FreeFull> They are optional except sometimes when traits are used and things are ambiguous
[22:58:02] <ChrisMorgan> Otherwise, it could be `(foo < T) > 0`
[22:58:44] <zenon> Is Rust easy to parse?
[22:59:01] <FreeFull> ChrisMorgan: I guess it makes parsing easier
[22:59:12] <dbaupp> zenon: it's LL(1), apparently
[22:59:19] <ChrisMorgan> zenon: define "easy"!
[22:59:19] <dbaupp> (so yes)
[22:59:21] <FreeFull> LL(1) is good
[23:00:09] <zenon> ChrisMorgan: I've no idea actually.
[23:02:22] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[23:02:37] <tiffany> does LL(1) mean it has to backtrack by 1 token?
[23:02:55] <zenon> I've asked this before but didn't get any answers: Let's say I have a struct with many fields: {a, b, c, ..., z}. What's the best way to initialize such a struct if the initialization of the fields isn't trivial?
[23:02:57] *** sam113101_afk is now known as sam113101
[23:03:04] <dbaupp> tiffany: lookahead 1 token, iirc
[23:03:05] <mcpherrin> tiffany: It needs to look ahead 1 token
[23:03:10] <ChrisMorgan> https://en.wikipedia.org/wiki/LL_parser
[23:03:34] <dbaupp> zenon: defining variables and moving them all in in one go is the nicest way
[23:03:47] <ChrisMorgan> zenon: define nontrivial!
[23:03:47] <mcpherrin> I am unsure if Rust is LL(1) but it's probably LL(k) for some small k
[23:03:57] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:03:58] <dbaupp> `let a = ...; let b = ...; ... Struct { a: a, b: b, ... }`
[23:03:59] <ChrisMorgan> pcwalton assures us it's LL(1).
[23:04:10] <tjc> proof by pcwalton-said-so ;-)
[23:04:12] <zenon> ChrisMorgan: Multiple lines per field.
[23:04:27] *** Joins: mib_4e2wxi (Mibbit@moz-68235C3E.customer.broadstripe.net)
[23:04:34] <ChrisMorgan> Sounds like "appeal to authority".
[23:04:52] <pcwalton> you can usually convert LL(k) to LL(1) with left factoring.
[23:05:01] <pcwalton> I wrote a left factored version of Rust's grammar that was LL(1) a while ago.
[23:05:28] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[23:05:32] *** Quits: rca (rcatolino@7F54AB21.28091F66.520D6FA6.IP) (Ping timeout)
[23:05:46] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[23:05:48] <mcpherrin> pcwalton: If the LL(k) is unambigious, is the LL(1) guaranteed to be? I could be wrong, but I thought that was the main concern with that approach
[23:06:07] <pcwalton> I don't think it's guaranteed but it usually is in practice, and was for Rust IIRC.
[23:06:22] *** Joins: fyolnish (fyolnish@moz-61B95E.uqwimax.jp)
[23:06:32] <mcpherrin> Cool sticks.
[23:06:53] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[23:07:17] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:07:30] <cadence> Hi. I am trying to add a test for Issue 10863, but I'm having some trouble: https://github.com/mozilla/rust/pull/10863#issuecomment-30277749
[23:07:34] <tiffany> I think my parser combinator library is LL(1) but I don't really know these temrs
[23:07:46] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:08:03] *** Quits: fyolnish (fyolnish@moz-61B95E.uqwimax.jp) (Ping timeout)
[23:08:45] *** Quits: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP) (Client exited)
[23:08:47] <ezyang> man, this is so unsafe: https://gist.github.com/ezyang/7902078 
[23:09:04] <ezyang> I wonder if Rust has not-bounds-checked vectors 
[23:09:12] *** Quits: frogmella (Mibbit@2AACB6E1.A033706C.284344F5.IP) (Ping timeout)
[23:09:26] <strcat> ezyang: there are non-bounds-checked methods
[23:09:42] <ezyang> strcat: But the vector memory layout has to store length always, right? 
[23:09:51] <strcat> sure
[23:09:58] <pcwalton> just use malloc :P
[23:10:01] <pcwalton> if you don't want that
[23:10:01] <strcat> if you want speed you'll stay far away from ~[T] anyway
[23:10:04] <ezyang> pcwalton: I am using malloc 
[23:10:13] <ezyang> :o) 
[23:10:14] *** Quits: arpd (ben@moz-D42157B0.cable.virginm.net) (Client exited)
[23:10:17] <strcat> malloc ends up storing that data somewhere
[23:10:18] <ezyang> Aaaall the unsafe code >:-( 
[23:10:32] <pcwalton> strcat: really coarse grained though, often rounded up etc
[23:10:48] <strcat> yeah small allocations get rounded and it's stored implicitly
[23:10:52] <strcat> based on the addr range
[23:11:01] <strcat> glibc doesn't ;]
[23:11:20] <strcat> 2 byte allocation -> 16 bytes of metadata, 16 bytes of usable memory
[23:11:46] <strcat> https://sourceware.org/glibc/wiki/Development_Todo/Enhancing_malloc :(
[23:12:14] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[23:13:47] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[23:14:38] <hoverbear> strcat: Could you please PM me your rust-git repo? Sorry, I realize you have to repeat it a lot.
[23:15:34] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[23:15:38] <cadence> When I run the libstd tests via `make check-stage1-std NO_REBUILD=1 NO_BENCH=1 VERBOSE=1` and it fails with "task '<main>' failed at 'Some tests failed'", is there more insight into the failure that I can obtain somehow?
[23:15:39] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[23:16:52] <aatch> cadence, it should output which tests passed and which failed.
[23:17:03] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Client exited)
[23:17:37] <zenon> hoverbear: Maybe create an arch wiki page?
[23:17:48] *** Quits: vodik_ (simon@moz-FD4ADBC6.cable.teksavvy.com) (Quit: WeeChat 0.4.3-dev)
[23:18:01] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[23:18:03] <hoverbear> zenon: Writing it into a vm to test a environment building script atm.
[23:18:26] <cadence> aatch: It says that a test I am trying to add (test_process_output_io_error_file_not_found) is failing, but I don't know why.  It fails even when I comment out the asserts.
[23:18:34] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:18:54] <hoverbear> zenon: Ideally you'll eventually be able to go git clone someurl && cd vm && vagrant up, and get a full rust environment in about a minute.
[23:19:44] <cadence> See https://github.com/cadencemarseille/rust/commit/091347653adf307e3469bd1a6eb80ee402de03c2#diff-3
[23:19:52] <dbaupp> cadence: you can run it with `TESTNAME=test_process...` to only show that one
[23:19:58] <hoverbear> Anyone here use emacs for rust development?
[23:20:04] * dbaupp does
[23:20:22] <aatch> dbaupp, and I thought you were a good person! :P
[23:20:47] <aatch> cadence, it's possible something else is asserting.
[23:21:16] <hoverbear> dbaupp: Is there syntax files built into emacs for it?
[23:21:27] <ChrisMorgan> src/etc/emacs
[23:21:36] <ChrisMorgan> hoverbear: all the cool kids use Vim, you know :-)
[23:21:39] <tjc> hoverbear: the directory ChrisMorgan mentioned, in the rust repo, has the emacs mode, and instructions
[23:21:53] <tjc> shhh, this is a safe place for all regardless of preferred text editor :-)
[23:22:04] <hoverbear> ChrisMorgan: Thanks! I know, I'm trying to decide if I want to include it in this env by default
[23:22:09] <strcat> unless your preferred text editor is `ed`
[23:22:18] <ChrisMorgan> …
[23:22:19] <hoverbear> I prefer textmate tbh
[23:22:37] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[23:22:52] <mcpherrin> strcat: hey man, ed can be pretty convenient!
[23:22:58] <ChrisMorgan> dbaupp: any idea how the emacs mode compares with the Vim stuff?
[23:23:04] <strcat> ChrisMorgan: not everyone has a screen, you know, ed is environmentally friendly when you need to print lines with ink
[23:23:13] <strcat> mcpherrin: for what? ;p
[23:23:24] <mcpherrin> strcat: I work over very slow serial links sometimes :)
[23:23:36] <mcpherrin> where whole-screen refreshes take long :)
[23:23:38] <strcat> like, a modem from 1980?
[23:23:47] <mcpherrin> strcat: debug interfaces on hardware :P
[23:23:57] <tjc> magnetized needle, steady hand, etc.
[23:24:01] <dbaupp> ChrisMorgan: no, because I wouldn't sully myself by touching vim. :P 
[23:24:01] *** Quits: cadence (Mibbit@moz-F6E754C1.sub-70-209-14.myvzw.com) (Quit: http://www.mibbit.com ajax IRC Client)
[23:24:06] <strcat> but modern hardware has fancy jtag thingies
[23:24:14] <ChrisMorgan> Anyone got any idea how the two compare?
[23:24:24] <dbaupp> ChrisMorgan: (as in, I haven't used vim with the rust mode)
[23:24:28] <strcat> "modern" :p
[23:24:35] <hoverbear> I can barely use vim so I'm not one to say
[23:24:42] <ChrisMorgan> I think Vim is the text editor with the best Rust support at present, but I don't know how good the emacs mode is.
[23:25:39] <hoverbear> I always get freaked out when my VMs say they're reformatting /dev/sda :(
[23:25:47] <dbaupp> ChrisMorgan: it was rewritten relatively recently which improved it
[23:25:55] <dbaupp> there are still some problems with indentation etc.
[23:25:56] *** Quits: zenon (Mibbit@moz-2E43177.dynamic.qsc.de) (Ping timeout)
[23:26:22] <strcat> hoverbear: online ext4 resizing is the scariest thing
[23:26:31] *** Quits: zslayton (Mibbit@81EB2473.5F4BC84E.66C78B76.IP) (Ping timeout)
[23:26:37] *** Quits: w3lcome (Mibbit@moz-33A75FFD.home.otenet.gr) (Ping timeout)
[23:26:44] <hoverbear> strcat: When you're in gdisk and wondering if you got the sizes right?
[23:26:55] <dbaupp> ChrisMorgan: https://github.com/mozilla/rust/issues/8793 , I guess most don't apply to the vim mode?
[23:26:55] * ChrisMorgan did it to extend his 1GB loop disk from which he ran Ubuntu on his Android tablet to 2GB
[23:26:56] <strcat> no just because online resizing is a scary concept
[23:27:05] <hoverbear> strcat: Shit I know right?
[23:27:05] <strcat> resizing the partition without even unmounting it ;]
[23:27:08] <ChrisMorgan> The Vim indentation I wrote certainly isn't perfect, but it's pretty good overall.
[23:27:21] *** Quits: peterdn (chatzilla@moz-3DA3F15F.as13285.net) (Ping timeout)
[23:27:22] <strcat> ChrisMorgan: it's great!
[23:27:47] <hoverbear> ChrisMorgan: I like it! Iirc I had some indentation issues but otherwise was fine.
[23:27:51] <SiegeLord> What does this indentation do (I don't use vim)?
[23:27:53] * ChrisMorgan can name a couple of distinct bugs in it, but mostly it's sufficient
[23:28:00] *** Quits: gdey_ (gdey@moz-CD850554.static-ip.telepacific.net) (Quit: Leaving...)
[23:28:14] <ChrisMorgan> SiegeLord: largely it just makes sure that when you insert a new line the next line is at the right indentation.
[23:28:34] <ChrisMorgan> You can also use it to automatically normalise the indentation of blocks of code.
[23:28:35] <strcat> well or when you're auto-indenting some code
[23:28:38] <strcat> yeah
[23:28:45] <SiegeLord> Hmm... ok
[23:28:50] *** flaper87 is now known as flaper87|afk
[23:28:58] <ChrisMorgan> gg=G and the file is (mostly) correctly indented.
[23:29:16] <strcat> if I'm moving around code, I like to just be able to auto-indent rather than *thinking* and using >>/<< on sections ;p
[23:29:31] <SiegeLord> Is "correctly" in this case matching to Rust format guidelines?
[23:29:41] <strcat> SiegeLord: in most cases, yes
[23:29:52] <SiegeLord> So not too useful if you don't like them :P
[23:30:03] <ChrisMorgan> SiegeLord: resistance is futile!
[23:30:10] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[23:30:14] <strcat> vim has cinoptions to configure indent stuff but the rust indent file probably doesn't follow it
[23:30:15] <ChrisMorgan> Come and be assimilated! Enjoy the freedom!
[23:30:19] <SiegeLord> Until rustc starts complaining, I'm not switching ;)
[23:30:30] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[23:30:30] <strcat> SiegeLord: rustc --pretty
[23:30:37] <ChrisMorgan> strcat: it's directly based on cindent and the cindent rules will largely hold
[23:30:39] *** Quits: mib_4e2wxi (Mibbit@moz-68235C3E.customer.broadstripe.net) (Ping timeout)
[23:30:43] <strcat> ah
[23:30:51] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[23:30:57] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[23:31:04] *** Joins: mr_evil (Mibbit@moz-2E43177.dynamic.qsc.de)
[23:31:06] <SiegeLord> Well, when rustc starts rustc --pretty'ing my code before compiling... then I'll switch too :P
[23:31:08] * ChrisMorgan is far too lazy to implement it *really* properly and thoroughly
[23:31:37] <ChrisMorgan> Oh, cmr is doing that along with several dozen other things like rewriting the compiler in the next 3½ weeks :P
[23:32:18] <hoverbear> 2 space indents, block indented, please. :)
[23:32:25] <ChrisMorgan> No, four space indents.
[23:32:31] *** mr_evil is now known as zenon
[23:32:35] <hoverbear> 2 spaces!
[23:32:36] <SiegeLord> Yesss, more rebels!
[23:32:40] * dbaupp directs everyone to #rust-flamewars
[23:32:44] <SiegeLord> Down with the 4 space tyrrany!
[23:32:44] <mcpherrin> Three space indents!
[23:32:46] <hoverbear> 4 spaces sucks on small screeens
[23:32:50] <hoverbear> SPACES AND TABS.
[23:32:55] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:32:59] * strcat uses 1 space for awful xml-like stuff
[23:33:06] <mcpherrin> Personally I like 1 or 2, but we use 3 at work  :(
[23:33:10] * ChrisMorgan is feeling lonely in #rust-flamewars
[23:33:28] <o11c> I can't believe I once thought mixed tabs+spaces was a good idea
[23:33:32] <hoverbear> I once had a girl shame me for using capitalizations in my file names.
[23:33:35] <hoverbear> In public.
[23:33:37] <o11c> I blame the fact that I learned Java first
[23:33:48] <o11c> hoverbear: sounds like a keeper
[23:33:50] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[23:33:53] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:33:58] <hoverbear> o11c: She's pretty awesome.
[23:34:20] <jeaye> hoverbear: I use 2 spaces as well.
[23:34:25] <ChrisMorgan> dbaupp: a brief look at that metabug suggests the emacs stuff is having trouble with things like handling quotation marks correctly. I wonder whether it supports raw strings?
[23:34:28] <hoverbear> jeaye: +1
[23:34:33] <zenon> who came up with 4 spaces?
[23:34:36] <dbaupp> ChrisMorgan: I don't think so
[23:34:40] <ChrisMorgan> Those are things that I've got Vim handling correctly.
[23:34:42] <o11c> 4 spaces is pretty reasonable
[23:34:55] <o11c> if you run out of room, stop nesting so deeply
[23:34:59] <zenon> 1 tab is pretty reasonable :)
[23:35:04] <zenon> and 1 tab = 8 spaces
[23:35:06] <o11c> tabs are never reasonable
[23:35:19] <jeaye> ^
[23:35:21] *** Joins: mib_lkgyya (Mibbit@moz-64699B21.cust.bluewin.ch)
[23:35:30] <hoverbear> With textmate I can show invisble characters and use 2 space soft tabs, it's so bloody easy to see what block you're in.
[23:35:41] <hoverbear> Soft+1, great name.
[23:35:44] <strcat> can show invisible characters in vim or emacs too
[23:35:47] <zenon> tabs are pretty nice when you want to use backspace
[23:36:09] <hoverbear> zenon: Most editors support a "soft tabs" where it's spaces but they delete and indent like tabs.
[23:36:21] <o11c> zenon: um ... get a text editor made in the last 20 years?
[23:36:23] <jeaye> backspace works fine over 2 space indentations in vim
[23:36:54] <zenon> o11c: I'll stick to vim.
[23:36:55] <mcpherrin> I think we should stop representing source code as plain text :)
[23:37:04] <hoverbear> 4 spaces just sucks to use on a 11 inch screen you're already splitting in half
[23:37:04] <o11c> zenon: that's what I'm using
[23:37:10] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:37:13] <Hildar> We should use matrix-code for source code.
[23:37:16] <zenon> hoverbear: How do I activate that in vim and why isn't it activated in the rust syntax file?
[23:37:19] <ChrisMorgan> mcpherrin: represent it as SVG 2.0!
[23:37:28] <strcat> mcpherrin: we don't, we store it as compressed delta packs in git
[23:37:30] <o11c> screen size shouldn't matter, you should still keep 80 columns
[23:37:35] <strcat> mcpherrin: :)
[23:37:36] <mcpherrin> ChrisMorgan: I was going to suggest XML :-)
[23:37:37] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[23:37:46] <mcpherrin> Just serialized ASTs
[23:37:48] <zenon> o11c: vim is 22 years old, though
[23:37:50] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[23:37:52] <hoverbear> zenon: Here's my bare minimum config for vim: https://gist.github.com/Hoverbear/880f6255969b38a3f3b4
[23:38:01] <mcpherrin> Remove code formatting flamewars once and for all
[23:38:17] <hoverbear> mcpherrin: Code should be pixel based
[23:38:33] <hoverbear> So we can bring in all the art critics to help us decide the best algorithms.
[23:38:40] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:38:51] <ChrisMorgan> mcpherrin: (when I was following SVG 2.0 a little closer, things like connectors were on the plan, so you could have semantically meaningful flow charts as your code)
[23:38:57] <zenon> hoverbear: It's :set smarttab. Please add that to the rust syntax file.
[23:39:09] <hoverbear> zenon: ChrisMorgan: ^
[23:39:17] <mcpherrin> ChrisMorgan: Powerpoint slides.  They can have diagrams!
[23:39:28] <hoverbear> mcpherrin: Lets use UML.
[23:39:28] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[23:39:29] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[23:39:36] <strcat> zenon: I don't have smarttab on and it works fine
[23:39:36] <ChrisMorgan> Ooh, and that will help with adoption, too.
[23:39:50] <mcpherrin> hoverbear: When I used to attend free-food recruiting sessions in University, I had a resume that said I was only a proficient programmer in BASIC and Piet
[23:39:56] <strcat> zenon: set expandtab softtabstop=4 shiftwidth=4
[23:40:05] <mcpherrin> I brought piet code samples along too.
[23:40:13] <strcat> and `filetype indent plugin on` to make sure you're using the rust indent file
[23:40:20] <hoverbear> mcpherrin: Awesome. Yeah, next semester I'm going to those and building a rock solid resume.
[23:41:21] <dbaupp> mcpherrin: did you end up getting employed writing piet? ;P
[23:42:02] <mcpherrin> dbaupp: unfortunately not :P
[23:42:11] <jdm|away> mcpherrin: :D
[23:42:20] <hoverbear> mcpherrin: Keep at it, you'll get there one day.
[23:42:25] <zenon> strcat: Can you check? It doesn't work for me by default and works when I switch smarttab on. Maybe you have a different syntax file.
[23:42:45] <jdm|away> there should be a programming language that looks like a resume
[23:43:09] <dbaupp> latex
[23:43:17] <strcat> zenon: do you have filetype indent plugin on + softtabstop/shiftwidth/expandtab set?
[23:43:22] <o11c> hm, I remember one of the IOCCC entries told a story ...
[23:43:35] <strcat> afaik shiftwidth is the key thing
[23:44:06] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[23:44:09] * o11c doesn't get why sw and sts are different
[23:44:12] *** Quits: mib_lkgyya (Mibbit@moz-64699B21.cust.bluewin.ch) (Quit: http://www.mibbit.com ajax IRC Client)
[23:44:17] <o11c> at least ts has a specific meaning
[23:44:21] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:44:23] <ChrisMorgan> jdm|away: the point where you start to shudder is where you get recruiters that try to make their website look like programming—case in point, http://supercoders.com.au/
[23:44:54] <jdm|away> ChrisMorgan: oh goodness
[23:45:10] <dbaupp> ChrisMorgan: can you make the vim mode have the fisheye effect?
[23:45:14] <jdm|away> I like the bits going out of the box on the right
[23:45:17] <hoverbear> ChrisMorgan: :o
[23:45:41] <aatch> ChrisMorgan, that site offends me.
[23:45:46] * ChrisMorgan wonders if that website helps them to attract the wrong sort of developer
[23:45:52] <zenon> strcat: softtabstop=4 does the trick. However, one of them should be set in the syntax file.
[23:46:21] <aatch> As somebody that tries to ensure a good user experience in my software, that website offends every design sensibility I have.
[23:47:11] <ChrisMorgan> dbaupp: no, with Vim fisheye isn't a Vim feature, it's got to be a terminal feature. Only editors like emacs let you do `A-M-x Y-Z-a η-λ fisheye`.
[23:47:18] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:47:24] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[23:47:42] <strcat> vim has syntax highlighting for certain image formats
[23:47:56] <ChrisMorgan> Yeah, it's fun stuff.
[23:48:16] <ChrisMorgan> It's fun opening XPM files in Vim.
[23:49:00] <strcat> xpm is the best image format ever
[23:49:07] <strcat> especially since it's a valid C file ;p
[23:49:50] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[23:50:10] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[23:50:16] <strcat> dbaupp: https://paste.xinu.at/DzCj6/ ;)
[23:50:36] *** Joins: pepper_chico (pepper_chi@6D1D0FAA.4F150827.E4090502.IP)
[23:50:43] <ChrisMorgan> Example of using Vim for image editing (with screenshot): https://github.com/tpope/vim-afterimage
[23:52:05] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[23:52:16] <pepper_chico> tpope is a crazy dude
[23:52:32] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[23:52:35] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[23:52:51] <pepper_chico> but it's cool
[23:53:08] <hoverbear> That's awesome!
[23:53:24] <zenon> What does "cute" mean? I understand what it means with regard to little animals and the like but there seems te be another meaning. What is "cute code" or "cute text" or "being cute when writing some code"?
[23:53:25] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[23:53:59] <aatch> zenon, let me guess, english isn't your first language?
[23:54:05] <zenon> nope
[23:54:07] <sfackler> ChrisMorgan: "...but for stupid simple tweaks, it gets the job done." does it really? :P
[23:54:13] *** Joins: gdey (gdey@moz-CD850554.static-ip.telepacific.net)
[23:54:19] *** Quits: gdey (gdey@moz-CD850554.static-ip.telepacific.net) (Client exited)
[23:54:21] <hoverbear> zenon: Visually "pretty"
[23:54:22] *** Joins: gdey (gdey@moz-CD850554.static-ip.telepacific.net)
[23:54:23] <pepper_chico> just like an cute animal, small, beautiful, elegant
[23:54:34] <aatch> and not very useful.
[23:54:42] <pepper_chico> hahah
[23:54:55] <hoverbear> Cute code can be useful
[23:54:55] <aatch> Generally it's used in a condenscending way.
[23:55:42] <zenon> I like it. I want my code to be cute :D
[23:55:55] <strcat> pepper_chico: I wouldn't really associate it directly with beautiful/elegant
[23:56:08] <hoverbear> Cute code is the best
[23:56:10] <ChrisMorgan> The "not very useful" and "condescending" aspects focus on a second meaning; "cute" can also mean just looking nice, pretty, &c., as one would speak of a child being cute.
[23:56:39] <ChrisMorgan> There is, of course, significant nuance.
[23:56:40] <aatch> That's what I was going for.
[23:56:44] <hoverbear> Cute code also usually has a gratuitious amount of comments.
[23:56:47] *** Joins: mib_0zmfhq (Mibbit@moz-AA25B6CD.xgsspn.imtp.tachikawa.spmode.ne.jp)
[23:57:12] *** Quits: mib_0zmfhq (Mibbit@moz-AA25B6CD.xgsspn.imtp.tachikawa.spmode.ne.jp) (Quit: http://www.mibbit.com ajax IRC Client)
[23:57:13] <aatch> It's a figure of speech, but I normally hear it something like: "Cute trick, now do it properly"
[23:57:34] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: ZZZzzz…)
[23:57:44] <strcat> or used to refer to some helpless creature
[23:57:59] <pepper_chico> strcat, I do because it's what matters in the coding context, differently of the animal context. leaving that, just being pretty, I dunno how, is a weird thing
[23:58:07] <hoverbear> Hmm... I don't have anywhere to host this image.
[23:58:08] <strcat> we're programmed to think babies are 'cute' and in need of help, so small animals with wide eyes trigger the same thing
[23:58:12] <ChrisMorgan> strcat: yes, helpless and warm and fuzzy.
[23:58:40] *** Parts: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) ()
[23:59:19] <strcat> 'cute code' to me implies some clever code that's neat but not very useful
[23:59:27] <aatch> strcat, same here.
[23:59:48] <strcat> http://www.a1k0n.net/2011/07/20/donut-math.html like this
[23:59:50] <strcat> ;p
