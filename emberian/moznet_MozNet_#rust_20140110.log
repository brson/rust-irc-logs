[00:00:02] <jadbaires> are local non-mutable "variables" still called variables?
[00:00:13] <dbaupp> jadbaires: yes
[00:00:16] <mr_trousers> Does the GC in Rust's library deal with cycle detection?
[00:00:21] <dbaupp> mr_trousers: no
[00:00:29] <dbaupp> we don't actually have a GC at the moment
[00:00:30] <cmr> mr_trousers: there is no GC in the library
[00:00:34] <mr_trousers> :(
[00:00:38] <dbaupp> std::gc is just a placeholder for now
[00:00:55] <dbaupp> https://github.com/mozilla/rust/pull/11399 makes it not-a-placeholder
[00:01:15] <mr_trousers> dbaupp cmr: So, we only have reference counting?
[00:01:17] <dbaupp> (with a proper cycle-detecting GC)
[00:01:20] <kozikow> https://github.com/mozilla/rust/issues/10513 looks interesting and like a good way to learn a language
[00:01:20] <dbaupp> mr_trousers: for now, yes
[00:01:27] <cmr> mr_trousers: with Rc<T>, yes.
[00:01:52] *** Quits: dherman (dherman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: dherman)
[00:01:52] <dbaupp> mr_trousers: (although, the "GC" pointer @ doesn't leak completely: any cycles are collected when the task finishes)
[00:01:56] <mr_trousers> dbaupp cmr: So one must be careful not to introduce cycles :( That doesn't sound safe...
[00:01:59] <brson> seems like /list won't give a complete list atm because the 'server load is temporarily too heavy'
[00:02:21] <cmr> mr_trousers: right now Rc statically denies cycles with the type system.
[00:02:32] <mr_trousers> cmr: Oh, yay.
[00:02:45] <cmr> https://github.com/mozilla/rust/pull/10926 changes that
[00:03:01] <mr_trousers> cmr: Why on Earth would you want to change that
[00:03:13] <ecr> brson: do you just want the user count or the user list?
[00:03:16] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Client exited)
[00:03:19] <mr_trousers> Do you know how many memory leaks are caused in C++ by having cycles of shared_ptrs
[00:03:38] <brson> ecr: just the counts
[00:03:46] <pcwalton> mr_trousers: it forbids too many correct programs
[00:03:54] <pcwalton> C++ has implicit copy constructors
[00:03:57] <pcwalton> Rust doesn't, you have to use .clone()
[00:04:22] <strcat> I don't think you'll run into leaks of shared_ptr cycles frequently
[00:04:22] *** Quits: Arthur_D (Trillian@F5DA0532.2FA69ABE.701726B4.IP) (Z:lined (dronebot))
[00:04:29] <strcat> maybe in a monstrosity like firefox
[00:04:33] <strcat> but most programs aren't that large
[00:04:37] *** Joins: Arthur_D (Trillian@moz-E327D6BC.torservers.net)
[00:04:50] <pcwalton> it's common in Objective-C with closures, but that's because of ARC
[00:04:50] <ecr> brson: I can snag a screenshot for you
[00:04:52] <strcat> and they don't have stuff like integration with another GC to worry about
[00:05:03] <pcwalton> and because of no capture clauses
[00:05:21] <strcat> C++ closures aren't refcounted + you have capture clauses, so it'd be tricky
[00:05:21] <pcwalton> implicit-copy-of-self-in-a-closure is a *huge* cause of leaks in Obj-C
[00:05:24] <brson> ecr: thanks
[00:05:31] <pcwalton> but that doesn't apply to Rust
[00:05:39] <strcat> you'd probably have to put a std::function in a std::shared_ptr
[00:05:43] <strcat> and then capture the shared_ptr in it
[00:06:13] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[00:06:20] <mr_trousers> pcwalton strcat: How is having a cycle of a shared_ptr a correct program?
[00:06:20] *** Quits: pnkfelix (pnkfelix@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Ping timeout)
[00:06:36] <cmr> mr_trousers: our current way of preventing cycles is too strict, not cycles in general.
[00:06:42] <strcat> mr_trousers: well... that's sort of like saying a program isn't correct if you allocate an unnecessary 10K instead of the minimum 2K
[00:06:42] <pcwalton> mr_trousers: it's not, but the problem is that the type system ruled it out by not allowing you to put a shared_ptr in a shared_ptr, basically
[00:06:46] <ecr> brson: http://imgur.com/5hiGsa7
[00:06:46] <pcwalton> which was too restrictive
[00:06:52] <ecr> brson: we hit 411 earlier
[00:06:59] <pcwalton> I'm not saying I wouldn't love a way to prevent cycles statically, I would be 100% in favor of that
[00:07:07] <strcat> drop trait objects and closures
[00:07:18] <pcwalton> you'd also have to drop mutable @ pointers
[00:07:25] <pcwalton> it's just that we'd have to find a way that isn't too restrictive
[00:07:39] <pcwalton> and doesn't prevent other things that *aren't* cycles of @ pointers
[00:07:39] *** Quits: dapz (textual@moz-F958911.hsd1.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[00:07:40] *** Joins: igork (igork@moz-578E0B8C.broadband.corbina.ru)
[00:08:14] *** Quits: dkeenaghan (dkeenaghan@A9F153F4.DDE28F19.986A907C.IP) (Quit: Leaving)
[00:08:20] <mr_trousers> Can't the type system just enforce that you have to break up cycles with weak_ptrs?
[00:08:22] <pcwalton> rust's approach was like trying to prevent car accidents by banning cars
[00:08:22] *** Quits: nkoep (nik@moz-2139AD62.pool.mediaways.net) (Quit: Leaving)
[00:08:30] *** Quits: igork_3231 (Mibbit@moz-578E0B8C.broadband.corbina.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[00:08:33] <strcat> mr_trousers: how?
[00:08:36] <pcwalton> mr_trousers: don't think so
[00:08:40] <pcwalton> I don't know how
[00:08:52] <strcat> lets say you have Rc<RefCell<proc>>
[00:09:04] <strcat> and then you capture the Rc in a proc and assign it to the Rc
[00:09:10] <strcat> how do you prevent that?
[00:09:15] <pcwalton> strcat: oh, I see, by dropping trait objects and closures you mean dropping existential types
[00:09:20] <pcwalton> that still rules out some valid programs
[00:09:23] <pcwalton> e.g. singly linked lists of @
[00:09:27] <strcat> pcwalton: yeah, it wasn't really serious
[00:09:27] <pcwalton> but yes, it'd be easier
[00:09:34] <jhasse> mr_trousers pcwalton strcat: sorry for jumping into the discussion. What about using a "real" GC?
[00:09:41] <pcwalton> jhasse: I would love that solution :)
[00:09:47] <cmr> jhasse: well that doesn't help Rc
[00:09:48] <pcwalton> let's do that :)
[00:09:50] <strcat> jhasse: then you don't have scope-based destruction, so it's different
[00:09:52] <cmr> we'll have a real GC, sure.
[00:09:52] <pcwalton> but I think RC is also useful
[00:09:59] *** Quits: hjr3 (hradtke@moz-1ED9056D.lsanca.dsl-w.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[00:10:02] <strcat> Rc provides really lightweight scope-based destruction
[00:10:03] <jhasse> strcat: ah, forgot about that
[00:10:11] <pcwalton> when the overhead of a GC is too much, or you want deterministic destruction
[00:10:17] <pcwalton> Rust isn't opinionated as to memory management
[00:10:22] <pcwalton> it's opinionated as to other things
[00:10:40] <bascule> writing a real GC is easy, right pcwalton? ;)
[00:10:48] <strcat> Gc will use more resources to reach the same performance, and may be a problem with sockets, files or db connections inside
[00:10:53] <pcwalton> (well, it is actually opinionated in memory management, but it's more "convention over configuration" as opposed to "my way or the highway")
[00:11:07] <strcat> in exchange, it cleans up cycles and will be faster for a churn of short-lived objects
[00:11:13] *** jorendorff_away is now known as jorendorff
[00:11:18] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Ping timeout)
[00:11:30] <strcat> (well, if it's a good generational implementation which means it has to be precise first AFAIK)
[00:11:39] <ecl3ctic> Question: How should I declare a symbolic constant in Rust that I want to be put inline?
[00:11:43] <pcwalton> yeah, if you want a good generational impl
[00:11:50] *** Joins: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca)
[00:11:57] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:12:06] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[00:12:09] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[00:12:17] <acrichto> ecl3ctic: those are done with "static CONSTANT: Type = value;
[00:12:19] <acrichto> "
[00:12:21] <mr_trousers> If Rc does not allow valid programs, at that point just use Gc. I don't know why anyone would want to risk introducing memory leak vectors into Rust library.
[00:12:38] <strcat> mr_trousers: because scope-based destruction is important
[00:12:39] <pcwalton> having RC as an option is important for systems programming
[00:12:50] <ecl3ctic> acrichto: thanks
[00:12:53] <strcat> knowing your resource usage bounds is important
[00:12:56] <pcwalton> in a kernel, GC is an awful lot of overhead compared to RC
[00:12:58] <brson> ecr: thanks
[00:13:00] <strcat> don't want a dynamic failure because you run out of file descriptors
[00:13:12] <pcwalton> e.g. in an interrupt handler you might be tweaking reference counts, but you definitely can't stop the world
[00:13:31] <strcat> mr_trousers: also, GC in rust will be task-local
[00:13:32] <ecr> brson: no problem!
[00:13:44] <strcat> so refcounting is required for shared immutable/mutable data that's not a static global
[00:14:14] <strcat> for example, a multiple-producer/consumer queue needs to be atomically refcounted
[00:14:22] <mr_trousers> Okay
[00:14:29] <pcwalton> eddyb's change to use CamelCase in libsyntax is so good
[00:14:30] *** Joins: erickt (etryzelaar@moz-4A9FF4B2.public.wayport.net)
[00:14:38] <mr_trousers> But that example can exist using Rc as it is now
[00:15:00] *** Joins: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP)
[00:15:10] *** Parts: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP) ()
[00:15:11] <dbaupp> pcwalton: it's pretending to be idiomatic rust code now \o/
[00:15:21] <pcwalton> yup!
[00:15:28] <strcat> mr_trousers: rust needs to have a way to write data structures with parent ptrs without unsafe code or gc
[00:15:33] *** Joins: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP)
[00:15:39] <pcwalton> I have plenty of issues with naming in libsyntax but it just got a whole lot better
[00:15:41] <dbaupp> (it's amazing how much difference identifier naming makes in terms of code appearance)
[00:15:48] <strcat> as soon as you have things like files inside, gc becomes much less appropriate
[00:15:50] <dbaupp> *casing
[00:16:28] <ecr> strcat: doesn't Send ensure no gc?
[00:16:37] <strcat> ecr: sure
[00:16:41] <ecl3ctic> acrichto: the docs say that immutable static variables are stored in the read-only data section of a crate. Are you sure they'd end up inlined?
[00:17:01] <Tobba> they'll get inlined if they're just integers or something
[00:17:04] <strcat> ecr: why?
[00:17:13] <mr_trousers> strcat: Okay, yes I see what you're trying to say now... yea I don't know how else you'd implement a graph structure... hmmm
[00:17:25] <ecr> strcat: I'm trying to figure out what you want beyond what Send does
[00:17:25] <strcat> ecl3ctic: look at the asm/IR before worrying about micro-optimizations
[00:17:30] <acrichto> ecl3ctic: depends, if you take the address of them, they'll probably go in rodata, if you just use them by value then they'll all get inlined
[00:17:39] <strcat> ecr: what do you mean?
[00:17:52] <strcat> ecr: I'm just stating why Rc is useful
[00:17:58] *** Quits: dylukes (dylukes@23B8C449.AF8B4D87.E8393EEB.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:18:02] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[00:18:04] <strcat> and why bounds on Rc to prevent cycles are too restrictive
[00:18:05] <bascule> where did this page go?
[00:18:05] <strcat> so...
[00:18:06] <ecl3ctic> strcat: I'm not looking to optimize, I'm just looking to know what my code is doing ;)
[00:18:07] <bascule> https://github.com/mozilla/rust/wiki/Doc-language-FAQ
[00:18:11] <ecr> strcat: oh! sorry. i thought you were saying this was a thing we needed still
[00:18:18] <strcat> ecr: well...
[00:18:27] <acrichto> ecl3ctic: also we definitely make sure that they all get inlined because they're flagged as constant in LLVM and then LLVM knows that it can perform constant propagation on them
[00:18:37] <strcat> at some point I wrote Rc, and came up with a reasonable way of preventing cycles via Send/Freeze
[00:18:39] *** Quits: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP) (Quit: Leaving...)
[00:18:39] <acrichto> ecl3ctic: we also take measure to ensure that the value is inlined across crates
[00:18:40] <strcat> so
[00:18:42] <strcat> Rc isn't Send
[00:18:51] <strcat> so there was from_send, for Rc<T: Send>
[00:19:03] <strcat> if the inner type is Freeze, you can't ever alter the value to refer to itself
[00:19:06] <mr_trousers> cmr strcat: Wait. The proposal for relaxing Rc does not seem to introduce memory leaks...
[00:19:08] <strcat> so new() worked for Rc<T: Freeze>
[00:19:15] <strcat> anyway
[00:19:19] <strcat> that was quite restrictive
[00:19:27] <ecr> i'd imagine so
[00:19:31] <mr_trousers> You can't have a cycle of Strong references, right?
[00:19:31] <strcat> means no mutable trees or directed acyclic graphs with Rc
[00:19:37] <strcat> mr_trousers: you can
[00:19:46] <acrichto> mr_trousers: you can use RefCell to introduce mutability where it doesn't look like there is any
[00:19:59] <mr_trousers> Well that's a problem
[00:20:04] *** Joins: JamesDunne (Jaymz@moz-C84E6351.hsd1.il.comcast.net)
[00:20:13] <strcat> mr_trousers: this isn't specific to Rc
[00:20:16] <strcat> rust has channels
[00:20:22] <ecl3ctic> acrichto: that's great information. Thanks!
[00:20:25] <strcat> you can put a channel in itself
[00:20:38] <strcat> now you can have a memory leak
[00:20:42] <mr_trousers> Oh
[00:20:48] <mr_trousers> Hm
[00:20:48] <strcat> although I think you'd really have to go out of your way to do something like this
[00:21:04] <mr_trousers> But that's not a circular reference though, right?
[00:21:08] <acrichto> it's a little more complicated for channels, but you can certainly cause them to leak (especially with a shared channel
[00:21:10] <strcat> mr_trousers: it's a circular reference
[00:21:18] <strcat> acrichto: well, I mean a shared channel
[00:21:22] <JamesDunne> Greetings. I just encountered a compiler bug when compiliing with post-0.9 commitid 9d63403. I wish I could give you more details but it appears the instructions for submitting a bug report built into the error message diagnostic are faulty.
[00:21:45] <strcat> acrichto: wouldn't it be pretty hard to leak with the non-shared one? you'd have to pass the other end into itself
[00:21:48] <strcat> ;p
[00:21:55] *** Quits: Matthias247_ (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de) (Connection reset by peer)
[00:21:56] <acrichto> JamesDunne: a pastebin of the output should be sufficient
[00:22:06] <acrichto> strcat: I dunno fi the types would work out
[00:22:08] <dbaupp> JamesDunne: oh, you should file a bug report about those intructions being faulty ;P
[00:22:15] <strcat> acrichto: well, they would
[00:22:18] <ecr> wouldn't sending a channel along itself just end up freeing the thing? it's not useable after you send it...
[00:22:18] <dbaupp> JamesDunne: ( https://github.com/mozilla/rust/issues/new fwiw)
[00:22:18] <strcat> acrichto: just use a proc or trait object
[00:22:19] <JamesDunne> http://pastebin.com/gfTiJRck
[00:22:22] <acrichto> strcat: b/c Port<T> and Chan<T> would mean Chan<Port<T>> -> Chan<Port<Port<T>>> etc
[00:22:28] <strcat> ecr: no
[00:22:35] <JamesDunne> The RUST_LOG=rustc=1 env did nothing as far as I can tell
[00:22:38] <strcat> ecr: afaik at least
[00:22:46] <JamesDunne> And the wiki link to HOWTO submit a bug is a 404.
[00:22:46] <strcat> acrichto: yeah but Port<proc>
[00:22:52] <acrichto> JamesDunne: you probably need to recompiled some usptream dependencies
[00:22:53] <strcat> acrichto: now capture the other end and send it in
[00:22:56] <dbaupp> JamesDunne: sounds like you may need to recompile the rustsqlite page
[00:22:58] <dbaupp> *crate
[00:23:01] <jadbaires> "rustc --test" warns that main is dead code :/
[00:23:16] <strcat> jadbaires: it is dead code! ;p
[00:23:21] <mr_trousers> strcat: I am beyond my knowledge at this point, but is the problem of circular references fixable, too hard to fix, or not fixable?
[00:23:24] <JamesDunne> dbaupp: Good thinkin'. Let me try that. Forgot I had to recompile crates.
[00:23:30] <strcat> jadbaires: cfg(not(test)) I guess
[00:23:34] <jadbaires> strcat: true still :/
[00:23:42] *** Quits: erickt (etryzelaar@moz-4A9FF4B2.public.wayport.net) (Ping timeout)
[00:23:54] <mr_trousers> strcat: Er, circular references without memory leaks
[00:23:54] <acrichto> mr_trousers: in general memory leaks are a great thing to prevent, but forbidding them entirely has ended up hamstringing useful types to the point where they aren't that useful
[00:24:01] <acrichto> mr_trousers: it's also incredibly difficult to ban *all* memory leaks
[00:24:04] <strcat> mr_trousers: it is fixable with very strict type restrictions
[00:24:05] <JamesDunne> tada! That worked.
[00:24:09] <acrichto> mr_trousers: and as a result, we're starting to relax restrictions
[00:24:12] <strcat> so
[00:24:22] <acrichto> JamesDunne: yeah we need better error messages about instances like that :(
[00:24:26] <strcat> on any reference counted type that's non-Send (task-local) like Rc, you need a Freeze bound *or* a Send bound
[00:24:31] <strcat> so from_freeze/from_send ctors
[00:24:39] <strcat> on any sendable reference counted type, you need a Freeze bound
[00:24:42] <strcat> it's just far too strict
[00:24:53] <JamesDunne> acrichto: Indeed. I'll submit an issue report for the faulty instructions and missing message on lib*.a binary incompatibility.
[00:24:53] *** Joins: kzzch (kzzch@moz-BB97B490.washdc.fios.verizon.net)
[00:24:59] <strcat> rust doesn't try to prevent out-of-bounds array accesses, integer overflows and so on statically
[00:25:06] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[00:25:11] <strcat> so why try to prevent this kind of resource leak by crippling what you can express?
[00:25:19] <strcat> it's not a memory safety issue
[00:25:21] <dev14> Hi, I'm trying to create a profiler for Rust, I thought about having it work in a similar fashion to how -pg flag in gcc I would love some advice and feedback if possible? 
[00:25:32] <strcat> dev14: well, why not use perf?
[00:26:02] <JamesDunne> Is RUST_LOG=rustc=1 still relevant? I assume that was supposed to log more diagnostics to the console output.
[00:26:04] <acrichto> dev14: creating a more intrusive profiler would involve affecting codegen (modifying the compiler)
[00:26:22] <strcat> LLVM's PGO is actually intended to be usable with perf ;)
[00:27:04] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[00:27:23] <dev14> strcat, i'm not familiar with perf, could you please explain? And i did think about having to deal with having to modify the compiler, would this be alright?
[00:27:24] <mr_trousers> strcat: Yea but out-of-bounds, overflows, etc. will cause the task to fail, correct? A memory leak wouldn't...
[00:27:42] *** Quits: ecr (chatzilla@moz-8B5E7056.dhcp4.washington.edu) (Ping timeout)
[00:27:43] <strcat> dev14: which platform are you on?
[00:27:57] <strcat> mr_trousers: an overflow will be silent, fixed-size integers wrap on overflow
[00:28:03] <strcat> mr_trousers: out-of-bounds array access will abort/fail
[00:28:05] <brson> how do you output a .o file with rust?
[00:28:10] <strcat> brson: -c, but why?
[00:28:26] <brson> strcat: someone on reddit is interested in cross compiling
[00:28:44] <strcat> well, that doesn't really seem like how you'd do cross-compilation
[00:28:45] <acrichto> brson: you may want to recommend --staticlib as well (more officially supported)
[00:28:51] <mr_trousers> strcat: Hm. This is interesting. Are there any languages that are even more restrictive than Rust?
[00:29:03] <dev14> strcat: i'm on a osx platform, but i could work on any, why?
[00:29:14] <strcat> mr_trousers: ATS
[00:29:31] <strcat> dev14: well, there are lots of good profilers not needing modifications to the compiler
[00:29:42] <strcat> -pg isn't really a good profiler, perf is a lot better
[00:29:48] <acrichto> dev14: you should check out xcode's Instruments program, it's able to profile rust programs really well right now (but there are certainly more things that could be profiled better)
[00:29:51] <dbaupp> dev14: Instruments.app is apparently pretty good
[00:29:52] <strcat> I don't know much about apple's tooling so I can't say if it's better/worse
[00:30:00] <strcat> but perf is universally better than -pg
[00:30:24] <strcat> and callgrind/cachegrind + kcachegrind and the other valgrind tools are great too if you don't just want sampling
[00:30:26] <brson> strcat: well you go do your thing: http://www.reddit.com/r/rust/comments/1utyrb/how_does_one_crosscompile_with_rust/
[00:30:37] <dbaupp> dev14: (perf is a linux tool, if it's not clear)
[00:31:20] <mr_trousers> strcat: So are you saying that statically detecting memory leaks is too restrictive in general or too restrictive in the context of Rust's type system?
[00:31:47] <strcat> mr_trousers: too restrictive in the context of rust's type system
[00:31:48] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[00:31:56] <strcat> because rust has types like trait objects and closures
[00:32:02] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[00:32:30] *** Joins: mib_yvlwvu (Mibbit@moz-31AE5A5F.fbx.proxad.net)
[00:32:33] <strcat> so, lets call what those do type erasure (they have the same type regardless of what may be inside them)
[00:33:15] <strcat> I would guess that you would have a *very* hard time eliminating leaks from reference counting cycles in any language with that feature
[00:33:47] *** Quits: tupshin_ (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Client exited)
[00:34:11] <Tobba> I wonder if I can get away with making an llvm bitcode file containing a single forceinline function that returns an addrspec()'d pointer
[00:34:30] <dev14> strcat, arcichto, and dbaupp: thank you! let me look into perf and Xcode's instruments program, besides these are there any other resources you could recommend reading up on profilers? I've been doing research on it for the past few weeks, and good resources and articles are hard to come by. And I am interested in working on the compiler are there some places which you recommend I look at to start?
[00:34:39] <Tobba> actually I've got a better idea
[00:35:19] <mr_trousers> strcat: Hm. I don't understand how those features make it difficult to eliminate leaks from cycles... What do I need to learn in order to understand why?
[00:35:22] <acrichto> dev14: I'm not sure of much official documentation on perf/Instruments, but I've found google to be the best resource when figuring out how to use them (I still google every time I use perf)
[00:35:33] <strcat> mr_trousers: so you have Rc<Foo>
[00:35:46] <strcat> mr_trousers: the question you need to answer to prevent cycles is 'does Foo contain Rc<Foo>?'?
[00:35:52] <jadbaires> if a function f(...) is deadcode, the compiler also warns about all functions local to f being dead code...
[00:35:58] <acrichto> dev14: for working on the compiler itself, I'd just start out by reading some code (you'd be interested in src/librustc/middle/trans) and in general understanding how LLVM works (that's what we translate into for now)
[00:35:59] <jadbaires> that introduces a bit of noise
[00:36:01] *** Quits: mib_yvlwvu (Mibbit@moz-31AE5A5F.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:36:15] <strcat> mr_trousers: if Foo can just be ~Trait or proc where the inner types are erased (you have *no idea* what is in it), then you can't prevent cycles
[00:36:19] <mcpherrin> jadbaires: probably worth filing an issue for that
[00:36:28] <jadbaires> mcpherrin: that's what I was about to ask
[00:36:31] <mcpherrin> (or a pull request :) )
[00:36:32] <dbaupp> jadbaires mcpherrin: I think there is one already
[00:36:33] <acrichto> dev14: specifically, you could browse the issue tracker at https://github.com/mozilla/rust/issues and see if any bugs catch you fancy, I'd recommend taking a look at the E-easy bugs, but be warned that they may not all be so easy
[00:36:34] <strcat> rust has trait/closure bounds though, and that's how it worked with the Freeze/Send restrictions
[00:36:34] <dbaupp> maybe
[00:36:38] <Tobba> aw yeah, I think LLVM 3.4 actually fixed the load/store bugs with addrspec
[00:36:54] <jadbaires> dbaupp: oh ok, let me take a look
[00:37:14] <dbaupp> jadbaires: ah, seems not; I can't find one.
[00:37:28] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:38:06] <strcat> ugh
[00:38:10] <JamesDunne> Any interest in parallelizing compiler tasks?
[00:38:11] <strcat> I lost one of the Rc commits rebasing ;p
[00:38:22] <dbaupp> bstrie: are you in a PR hurricane right now?
[00:38:24] <strcat> git really hates moved files during rebases (or at least, I suck at dealing with them)
[00:38:26] <dbaupp> strcat: reflog \o/
[00:38:31] <JamesDunne> Bootstrapping a rustc compiler is currently 100% pegging only one core.
[00:38:36] <strcat> dbaupp: well it's fine, I still have the fine
[00:38:42] <strcat> er
[00:38:44] <strcat> file*
[00:38:45] <dbaupp> heh
[00:39:00] <dev14> archichto and star: thank you for your time, let me do some more research and take a look at the issues. I sincerely appreciate your time!
[00:39:10] <acrichto> JamesDunne: the compilation process is currently as parallel as it can be, the major paralellization opportunity is parallellizing LLVM optimizations/codegen itself
[00:39:12] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:39:24] <acrichto> dev14: of course! and feel free to ask any question on IRC, we all love to help :)
[00:39:46] <dev14> archito: definitely! :
[00:39:47] <dev14> :)
[00:39:52] <JamesDunne> acrichto: Do you mean to say that rustc is parallel already but the LLVM codegen side is not?
[00:39:57] <acrichto> JamesDunne: ah and I mean parallel in the sense of 'make' tasks
[00:40:01] <jadbaires> dbaupp: me neither
[00:40:08] <jadbaires> dbaupp: I'll report it then
[00:40:15] <acrichto> JamesDunne: rustc itself does not run anything in parallel, but all your cpu time is taken up in LLVM passes and optimizations
[00:40:23] <JamesDunne> Yeah, the make tasks are parallel but rustc only takes up one core itself.
[00:40:47] <mr_trousers> strcat: So currently Rc prevent Rc<Foo> from having an Rc<Foo> even though there may be no cycles at all?
[00:40:49] <acrichto> compilation in general is an inherently sequential process, but there are indeed parallel speedups you can get
[00:41:06] <strcat> mr_trousers: no, currently it's *even more* restrictive than that ;)
[00:41:17] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[00:41:22] <Tobba> anyone got a user defined language for notepad++?
[00:41:35] <mr_trousers> strcat: So it can't have an Rc<Foo> in the entire ownership tree?
[00:41:35] <Tobba> I'm getting tired of no syntax highlighting, rust is kinda hard to lex though
[00:41:37] *** Quits: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP) (Quit: dev14)
[00:41:49] <strcat> mr_trousers: well... if it's mutable, you can't
[00:42:00] <strcat> anyway these restrictions are being removed
[00:42:04] <strcat> atm, you can't make Rc cycles in safe code
[00:42:14] *** Quits: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP) (Ping timeout)
[00:42:16] <strcat> but anything you put into Rc has to be Freeze or Send
[00:42:17] <JamesDunne> I was just thinking of a simplistic divide and conquer approach for each compiler pass; one task per *.rs file or something like that.
[00:42:34] <mcpherrin> Tobba: if you make one, make sure to send a pull request
[00:42:44] <dbaupp> JamesDunne: there can by cyclic dependencies between .rs files within a crate
[00:42:48] <dbaupp> *be
[00:43:04] <SiegeLord> There needs to be a FAQ entry for rustc parallelization ;)
[00:43:05] <JamesDunne> Understood. You'd fan out and fan back in to resolve cycles.
[00:43:11] <JamesDunne> Ha
[00:43:20] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[00:43:30] <strcat> JamesDunne: either way, almost all the time is spent in LLVM passes
[00:43:36] <strcat> so it doesn't matter what you do at the frontend level
[00:43:43] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[00:43:51] <JamesDunne> Is LLVM thread-hostile then? Heh
[00:43:56] <strcat> it's not 'thread-hostile'
[00:44:08] <strcat> it's an optimizing compiler, so many of the operations it performs depend on others
[00:44:19] <mr_trousers> strcat: Yea, that's pretty restrictive for anything other than simple reference counting, eh?
[00:44:19] <strcat> it doesn't just optimize functions in isolation from the rest of the program
[00:44:24] *** Joins: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au)
[00:44:27] <SiegeLord> The key issue is that the compillation unit is the entire crate. It's as if librustc is one .c file
[00:44:35] <strcat> mr_trousers: well, it means you can't have tree/graph-like data structures that are mutable
[00:44:47] <strcat> you can use Rc atm for mutable data via from_send
[00:45:00] <ecl3ctic> the man page of rustc which I *thought* I just compiled from master says "rustc 0.7, July 2013"
[00:45:02] <strcat> you can use it for Freeze (immutable, since Rc is immutable) data and make trees or graphs
[00:45:06] <ecl3ctic> is that out of date?
[00:45:10] <geomyidae_> Is there room for a "getting a rust hello world on windows" or is it not as big a deal as the whiners are making it seem?
[00:45:12] <strcat> but ofc you have to start from the child nodes
[00:45:17] <acrichto> JamesDunne: LLVM is bulit to work in a multi-threaded environment, but not for one session of compilation. THere was a patch awhile back by intel to parallelize all of llvm passes, but it kinda lost wind and I don't think it's making any progress
[00:45:24] <strcat> geomyidae_: you install mingw, you install rust, it works fine
[00:45:32] <JamesDunne> Hmm that's a shame.
[00:45:39] * geomyidae_ doesn't seem worth making a blog post over then. thx
[00:45:42] <strcat> geomyidae_: with 0.8, it was more complicated
[00:45:46] <strcat> with 0.9 that's it
[00:45:59] <mr_trousers> strcat: So you can't make an immutable graph in Rust without Gc?
[00:46:07] <strcat> an in fact I plan on shipping a rust package for arch linux able to cross-compile to 32-bit/64-bit windows soon
[00:46:10] <strcat> and*
[00:46:22] <strcat> mr_trousers: you can make an immutable graph/tree with Rc
[00:46:25] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[00:46:25] <SiegeLord> Installing mingw is the hardest part of installing rust on Window
[00:46:26] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[00:46:27] <SiegeLord> s
[00:46:34] <JamesDunne> SiegeLord: Agreed
[00:46:39] <strcat> mr_trousers: anyway rust doesn't have a gc right now, Gc leaks cycles and doesn't prevent cycles
[00:46:48] <JamesDunne> I'm running Arch Linux in a VM on a Windows 7 host just to fiddle with Rust
[00:46:55] <strcat> well
[00:47:13] <Tobba> mcpherrin: the issue is the single quotes
[00:47:16] <JamesDunne> Finding a compiled binary of mingw64 gcc compiler is a tedious process. Newest binaries I could find were from 2011.
[00:47:19] <strcat> JamesDunne: pacman -S mingw-w64-toolchain and you can now make C/C++ windows binaries ;p
[00:47:22] *** Quits: eatkinson (eatkinson@moz-C52156BC.dsl.bell.ca) (Quit: eatkinson)
[00:47:24] <Tobba> they can be used for either char literals or lifetimes
[00:47:26] <dbaupp> Freshly minted page: https://github.com/mozilla/rust/wiki/Using-on-Windows
[00:47:28] <Tobba> OR labels
[00:47:30] <dbaupp> (fwiw)
[00:47:40] <jhasse> JamesDunne: why not use the mingw installer? (not mingw64)
[00:47:43] <JamesDunne> strcat: Lol. Thanks.
[00:47:45] <strcat> anyway I'll add mingw-w64 target support to the rust pkg
[00:47:48] <strcat> soon!
[00:47:49] <JamesDunne> Because it's not mingw64 heh.
[00:48:01] <mcpherrin> Tobba: You can look at what the other editor syntax hilighters do
[00:48:07] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[00:48:08] <mcpherrin> Tobba: I can't imagine they're that different
[00:48:08] <JamesDunne> We've have x64 for at least a decade now. Kinda pathetic to default to x86 targets.
[00:48:14] *** Quits: richo (richo@10726D5F.1B04FC3.5CC412D0.IP) (Quit: bai)
[00:48:14] <strcat> jhasse: mingw is pretty broken and can't build 64-bit binaries ;p
[00:48:18] <jhasse> strcat JamesDunne: I don't get mingw64. Why didn't the developers contribute to MinGW?
[00:48:21] <strcat> jhasse: broken thread-local storage, broken floating point
[00:48:28] <geomyidae_> splendid! now someone post it who isn't hellbanned ;)
[00:48:29] <mr_trousers> strcat: How can you make an immutable graph with Rc anyway? If two nodes refer to each other, how do you construct them without lazy evaluation in the language?
[00:48:33] <strcat> jhasse: they did contribute the code to MinGW
[00:48:34] <SiegeLord> mingw64 folks need to get their act together and come up with an easy installer like mingw did
[00:48:37] <strcat> the MinGW developers rejected it
[00:48:45] <JamesDunne> jhasse: Heh, no idea why they'd even need to be separate teams.
[00:48:58] <SiegeLord> Yeah, that was a nasty story... I read the email exchanges
[00:49:00] <JamesDunne> Ugh. Open-source drama.
[00:49:02] <ecl3ctic> is there a way to check the version of rustc?
[00:49:08] <dbaupp> ecl3ctic: rustc --version
[00:49:09] <strcat> jhasse: anyway, why not just use MinGW-w64 exclusively?
[00:49:12] <strcat> MinGW is useless
[00:49:26] <ecl3ctic> dbaupp: oh, well THAT makes sense
[00:49:30] <strcat> MinGW-w64 has a faster, more robust runtime with working floating point, more functions exposed and so on
[00:49:31] <JamesDunne> Show me a recent mingw64 binary lol
[00:49:32] <SiegeLord> mingw-w64 is a pain to install for one :P
[00:49:35] <jhasse> strcat: MinGW has an easier installer ;)
[00:49:48] <strcat> jhasse: I don't develop on windows so mingw-w64 is easier to use for me
[00:49:52] <jhasse> strcat: does mingw64 include msys?
[00:49:56] <strcat> jhasse: no
[00:49:56] <JamesDunne> You'd have to install mingw32, download all mingw64 code, build that, install, then you'll have a mingw64 bin.
[00:50:00] <SiegeLord> It took me hours to get it working... and then I had no msys
[00:50:05] <JamesDunne> Then start compiling rustc.
[00:50:09] <strcat> mingw-w64 is primarily people who develop on linux and want to make windows binaries afaik
[00:50:11] <SiegeLord> So I got the one from mingw proper, heh
[00:50:14] <klutzy> JamesDunne: you may install mingw-build installer
[00:50:30] <strcat> and I get the impression that the MinGW developers don't use what they make at all ;)
[00:50:37] <jadbaires> done https://github.com/mozilla/rust/issues/11429
[00:50:39] <strcat> it often has broken headers, and the runtime is *always* broken
[00:50:46] *** Joins: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net)
[00:50:48] <klutzy> mingw-build has joined to mingw-w64, so you may treat it as official one
[00:50:59] <jhasse> strcat: Okay. So there's the reason why not to use mingw-w64 exclusively ;)
[00:51:00] <SiegeLord> mingw-build didn't work for me
[00:51:05] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[00:51:07] <strcat> jhasse: what reason? :s
[00:51:07] <klutzy> (it lacks msys but it's not a hard one)
[00:51:15] <strcat> jhasse: afaik there are binaries... I just don't use them
[00:51:16] <JamesDunne> Anybody use CMake for rustc compilation? That'd generate VS201[023] project files for compilation on Windows.
[00:51:17] <jhasse> strcat: You are not cross compiling from linux
[00:51:26] <SiegeLord> It installs in a very strange directory (Program Files...)
[00:51:34] <strcat> jhasse: works fine when you're not cross-compiling from linux, just not what I use
[00:51:47] <jhasse> JamesDunne: You can tell it to create Makefiles on windows
[00:51:50] <strcat> so I can't tell you much about it beyond that it works because I installed mingw-w64 one time on windows before deciding it was the wrong way to go
[00:51:55] <klutzy> SiegeLord: hmm, I always install it at custom location without issue
[00:51:58] <JamesDunne> jhasse: Using which compiler? Lol
[00:51:58] *** Quits: azita (Azita@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: azita)
[00:52:04] <jhasse> strcat: ah ic
[00:52:14] *** Joins: dangets (dangets@moz-E9E4A77B.cpe.cableone.net)
[00:52:16] <jhasse> JamesDunne: rustc?
[00:52:17] <klutzy> (I have three mingw-w64 dirs :-/)
[00:52:18] <strcat> anyway I don't even want to debug windows binaries on windows
[00:52:29] <JamesDunne> The only "native" compiler on Windows is MSVC which can come with VS express, or try finding Intel's.
[00:52:31] <jadbaires> wait that's not excellent
[00:52:32] <strcat> I'd rather run them in wine so I have valgrind's suite and so on ;p
[00:52:36] <jadbaires> let me change it
[00:52:59] <JamesDunne> Then why the hell do we need mingw for a Windows build of rustc?
[00:53:05] <JamesDunne> Is it just for Make and friends?
[00:53:19] <strcat> JamesDunne: windows doesn't have a 'native' compiler/linker, it doesn't ship with one or have a package manager you can install one with
[00:53:21] <jhasse> strcat: true. I'm stuck with no proper wifi and graphics drivers for linux, so I have to use windows most of the time ;(
[00:53:25] <SiegeLord> klutzy: Oh, actually I guess that's what I ended up doing. I was shuffling between distros and forgot I stopped at mingw-builds >.>
[00:53:32] <JamesDunne> strcat: Hence why I said "native" :)
[00:53:40] <strcat> JamesDunne: asking people to install MSVC++ is just as bad (or worse) than saying install mingw/mingw-w64
[00:53:41] <dbaupp> JamesDunne: re cmake: https://mail.mozilla.org/pipermail/rust-dev/2014-January/007659.html (written by SiegeLord here)
[00:53:46] <jhasse> JamesDunne: rustc uses GCC
[00:53:54] <JamesDunne> strcat: I strongly disagree lol.
[00:53:56] <strcat> in addition to going out of their way to install something, they'll have to either pay for it or accept the restrictive Express terms of use
[00:54:01] <jhasse> strcat: IMO it's worse!
[00:54:28] <strcat> so... what are they going to run rustc from? cmd.exe? what debugger are they going to use?
[00:54:41] <JamesDunne> The alternative is to build from mingw32 and be limited to an x86 compiler exe?
[00:54:45] <JamesDunne> No thanks.
[00:54:49] <strcat> mingw64 works fine...
[00:54:52] <geomyidae_> To be fair, I wouldn't have known to mingw-get install gcc intuitively and I've used it in the past... though I wonder if that's better than the hodgepodged installer from a year or two ago
[00:54:53] <JamesDunne> If you can build it lol
[00:54:57] <strcat> JamesDunne: there are binaries
[00:55:01] <JamesDunne> Link
[00:55:11] *** Quits: dangets (dangets@moz-E9E4A77B.cpe.cableone.net) (Ping timeout)
[00:55:19] <strcat> JamesDunne: http://mingw-w64.sourceforge.net/download.php#automated-builds
[00:55:27] <strcat> Mingw-builds provides native toolchains for Windows. Builds are based on trunk version of the mingw-w64 runtime. It has an online installer.
[00:55:28] <Tobba> meh
[00:55:34] <Tobba> I got some sort of user defined language going
[00:55:34] <strcat> Win-builds provides toolchains and libraries to cross-compile for Windows or build natively. The builds are fully reproducible and the whole process is documented. It uses a package manager to enable painless installation and updates of all components.
[00:55:36] <JamesDunne> Been there. Find me a recent build :)
[00:55:45] <Tobba> I cant give it lexing of '' stuff with what notepad++ allows me to do though
[00:55:45] <JamesDunne> For running on Windows. Assuming no Linux install.
[00:55:53] <Tobba> think I need to make a full plugin with a lexer
[00:56:22] <JamesDunne> strcat: I think the key thing we're missing here is that Windows folks are running on Windows hosts, not Linux hosts.
[00:56:31] <strcat> JamesDunne: they have gcc 4.8.1 which is one point release behind the native version
[00:56:40] <strcat> JamesDunne: no, I am not missing that
[00:56:44] <strcat> mingw-w64 has builds for windows
[00:56:45] * geomyidae_ didn't know rust had windows cross compiling :D
[00:57:07] <strcat> geomyidae_: well... rust may not support cross-compilation to windows with mingw-w64 yet but I plan on fixing any issues
[00:57:19] <cmr> mingw-w64 works now.
[00:57:30] <strcat> JamesDunne: on that page, there are 2 sets of automatic builds for windows
[00:57:31] <JamesDunne> Most recent build that runs on Windows that I can find is dated 2011-08-22
[00:57:37] <strcat> JamesDunne: not true
[00:57:39] <strcat> again
[00:57:39] <nmatsakis> bstrie: regarding strings, actually there is some interaction, motsly in that I haven't integrated strings into the model; making them non-special-case would simplify matters,
[00:57:41] <strcat> go to that page
[00:57:41] <cmr> should only need a few changes to the configure/makefiles
[00:57:45] <klutzy> strcat: you should've link mingw-builds section >:)
[00:58:02] <nmatsakis> bstrie: otherwise we'd probably need a type like the old "str/5", which meant: a string of length 5 (but exactly 5)
[00:58:03] <klutzy> mingw-w64 download page is a mess I think
[00:58:13] <strcat> there are two sites they give
[00:58:17] <strcat> one has 4.8.1, one has 4.8.2
[00:58:19] <JamesDunne> Agreed. The download page is a mess. I cannot find what you're referencing strcat.
[00:58:24] <cmr> JamesDunne: http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/mingw-builds/
[00:58:29] <strcat> JamesDunne: http://mingw-w64.sourceforge.net/download.php scroll down
[00:58:33] <strcat> Mingw-builds provides native toolchains for Windows. Builds are based on trunk version of the mingw-w64 runtime. It has an online installer.
[00:58:38] <SiegeLord> I managed to get a 4.8.2 GCC... so it's possible XD
[00:58:39] <strcat> see that? builds of 4.8.1
[00:58:42] <strcat> Win-builds provides toolchains and libraries to cross-compile for Windows or build natively. The builds are fully reproducible and the whole process is documented. It uses a package manager to enable painless installation and updates of all components.
[00:58:45] <strcat> that has 4.8.2
[00:58:45] <JamesDunne> targeting win32? not win64?
[00:58:50] <strcat> JamesDunne: targets both...
[00:58:55] <strcat> it's listed right there
[00:59:16] <jhasse> wow seems that mingw-w64 does come with msys. I guess I will make the switch in the future
[00:59:18] <strcat> http://mingw-w64.sourceforge.net/download.php#mingw-builds http://mingw-w64.sourceforge.net/download.php#win-builds the two specific sections on that page I linked
[00:59:30] <strcat> jhasse: well, some builds may not come with it
[00:59:52] <strcat> win-builds does
[01:00:00] <strcat> more than msys
[01:00:01] <JamesDunne> win-builds.org does not show me a download link anywhere lol
[01:00:06] <SiegeLord> Wait, no... just 4.8.1.
[01:00:11] <SiegeLord> Still pretty recent
[01:00:16] <JamesDunne> And this is all incredibly obtuse.
[01:00:18] <strcat> win-builds has 4.8.2 + a bunch of libs
[01:00:26] <SiegeLord> More recent than my Linux, heh
[01:00:35] <strcat> JamesDunne: http://win-builds.org/ documentation/downloads right at the top
[01:01:01] <JamesDunne> got it
[01:01:03] <strcat> it has instructions and the downloads as part of that
[01:01:26] <JamesDunne> Incredibly painful to find
[01:01:31] * strcat shrugs
[01:01:54] <strcat> if you didn't want to crawl around the internet finding executables, you probably wouldn't be using windows ;p
[01:01:56] *** Joins: tibbim (Mibbit@moz-7DAB1F4C.hsd1.ca.comcast.net)
[01:01:57] <JamesDunne> This might be a factor in why nobody is running rustc on Windows lol
[01:02:09] <JamesDunne> Hah false. :)
[01:02:16] *** Joins: eatkinson (eatkinson@moz-C52156BC.dsl.bell.ca)
[01:02:45] <strcat> I just have to install mingw-w64-toolchain and I have the latest gcc (maybe a few days of lag) for making windows binaries ;p
[01:02:59] <JamesDunne> Nice, assuming Linux host right?
[01:03:11] <strcat> sure, I have a package manager to install this with
[01:03:24] <jhasse> JamesDunne: I'm using MinGW and building rustc myself
[01:03:38] <JamesDunne> jhasse: I'm still downloading mingw64 binaries from the downloader I downloaded lol
[01:03:55] *** Parts: tibbim (Mibbit@moz-7DAB1F4C.hsd1.ca.comcast.net) ()
[01:04:09] <rossm> I'm primarily a windows developer. I only use windows as a main OS and I write mostly C# for work. I use rust on linux because it seems pretty complicated to get going on windows. I'd use a compiler binary if I had one. but I'm not going to try and build from source on windows, or install weird dependencies.
[01:04:16] <dbaupp> fwiw, there's https://www.nuget.org/packages/Rust/ too
[01:04:27] <strcat> rossm: there are rust binaries for windows
[01:04:28] <dbaupp> (although it hasn't been updated for a while...)
[01:04:34] <strcat> mingw is not exactly a 'weird' dependency
[01:04:34] <rossm> in general if I use something on windows that has dependencies, I'd expect the binaries for it to be shipped alongside
[01:04:35] <JamesDunne> rossm: I share your concerns and attitude.
[01:04:44] <jhasse> rossm: Why don't you want to build from source?
[01:04:52] <rossm> what would I build it with?
[01:04:59] <strcat> rossm: so we should ship all of mingw ourselves?
[01:05:08] <JamesDunne> Is there a chocolatey package too?
[01:05:09] <jhasse> rossm: MinGW
[01:05:18] <jhasse> JamesDunne: yes
[01:05:18] <rossm> strcat I'm really inexperienced with shipping products like that, so I don't feel qualified to make a recommendation
[01:05:23] <JamesDunne> Ah sexy
[01:05:26] <rossm> only to offer my limited perspective
[01:05:37] <strcat> rossm: when you're shipping a developer tool to programmers, I don't think asking them to run the mingw-w64 installer is too much to ask
[01:05:52] <JamesDunne> strcat: FINDING the installer is the challenging part lol
[01:06:01] <strcat> I didn't find it challenging ;\
[01:06:02] <rossm> does the installer come with rust?
[01:06:06] <JamesDunne> Heh, and I'm thankful for that.
[01:06:10] *** Joins: negativezero (negativeze@moz-5445889D.public.wayport.net)
[01:06:13] <strcat> just go to the site, click downloads, click windows download, click download again, click download again
[01:06:16] <strcat> it's a PITA but it's not hard
[01:06:18] <SiegeLord> Still, adding the same sort of page that dbaupp linked to but for mingw w64 would be helpful
[01:06:18] <rossm> I would give up immediately if I had to go find mingw myself
[01:06:28] *** Joins: heftig_ (heftig@moz-728E5D04.dip0.t-ipconnect.de)
[01:06:31] <JamesDunne> But seriously, that mingw64 page is atrociously laid out. Why is win-builds separate from the automated builds section? I wouldn't scroll down any further than that section.
[01:06:34] <strcat> rossm: http://mingw-w64.sourceforge.net/ so, you can't find the downloads from here?
[01:06:39] *** Quits: mr_trousers (Mibbit@moz-4014DDC7.ga.at.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:07:01] <kzzch> woot. update get!
[01:07:03] <klutzy> JamesDunne: mingw-w64 itself provides source, not prebuilt binaries
[01:07:13] <JamesDunne> No one's claiming it's hard; it's just incredibly obtuse and not discoverable.
[01:07:14] <kzzch> seems like compilation is faster
[01:07:21] <rossm> I can. I saw when you linked earlier too. but I wouldn't have even bothered to google for it. I'd assume it was complicated and not try.
[01:07:26] <jhasse> strcat: I can't. I clicked Download Mingw-w64 and now i'm download a .tar.bz2
[01:07:32] <JamesDunne> Installing Arch Linux in a VM on Windows was more discoverable than mingw64 builds
[01:07:39] <klutzy> JamesDunne: but recently mingw-builds (project for binaries) has joined to mingw-w64
[01:07:44] *** Quits: heftig (heftig@moz-E952153C.dip0.t-ipconnect.de) (Ping timeout)
[01:07:44] <strcat> jhasse: where did you click that? the one listed as being for OS X? ;\
[01:07:56] <JamesDunne> klutzy: I'm not familiar with the mingw-builds or any of their variants heh.
[01:07:58] <strcat> I really can't understand why it's so hard to go down this list until you see the one marked as windows
[01:08:01] <strcat> and download it
[01:08:15] <strcat> tbh I feel like you're feigning the inability to find it
[01:08:17] <JamesDunne> strcat: Of course you can't; you're already familiar with the site and its whacked-out layout.
[01:08:21] <strcat> no
[01:08:24] <strcat> I'm not familiar with it
[01:08:30] <SiegeLord> Hey, it took me a few hours to get mingw-w64 installed :P
[01:08:34] <strcat> this is the first time I have gone to find the windows executables for mingw-w64
[01:08:36] <strcat> I do not use windows
[01:08:44] <rossm> it's extremely unusual to ask a person on windows to go find some dependency. this is reflected for example if the number of people who will play .net games in ludum dare. if you game requires .net, the number of people who will try it are very small. because they don't want to go find and download it
[01:08:45] <JamesDunne> Lol alright then
[01:08:51] <rossm> and I guarantee .net is easier to find than mingw
[01:09:08] <jhasse> rossm: But the people you're asking are developers
[01:09:15] <strcat> rossm: I don't think it's unusual for a programmer to be expected to find a developer tool or library they need
[01:09:16] <JamesDunne> Hm, and yeah, this mingw64 installer is taking is sweet time.
[01:09:19] <strcat> lets say you want to use SDL on windows
[01:09:22] <strcat> how are you going to get SDL?
[01:09:46] <JamesDunne> Go to the SDL page where they have a clear download link of windows static .lib files.
[01:09:56] <jhasse> rossm: When I was reading the list it was: "Mingw? Already got it. Git? Who hasnt? msys? Hell yeah. Ah okay so it's basically "./configure && make && make install" Nice!"
[01:10:02] <rossm> I'd google SDL and then download a binary. but if it crashed and told me to go find zlib or something, I may just give up
[01:10:07] <JamesDunne> Drop those somewhere on the filesystem and configure VS's linker path and include path
[01:10:16] <strcat> rossm: so, again, http://mingw-w64.sourceforge.net/download.php
[01:10:22] *** jorendorff is now known as jorendorff_away
[01:10:29] <klutzy> I always blame mingw for webpage mess :p I have to spend large seconds to find "download"
[01:10:31] <strcat> downloads for OS X, linux, windows
[01:10:31] <rossm> jhasse I saw you mention msys earlier. I hadn't heard of it, but it looks nice
[01:10:41] <strcat> yeah, you have to spend pointless time clicking through layers of links
[01:10:46] <strcat> but it is *not* hard to find
[01:10:51] <strcat> it's not laid out well
[01:10:58] <strcat> but I don't really understand the claim that it's hard to find
[01:11:20] <JamesDunne> Basically there were many false trails to trip you up starting from a simple google search for mingw64
[01:11:22] *** Joins: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP)
[01:11:36] <strcat> mingw-w64 -> click the top link (mingw-w64)
[01:11:48] <JamesDunne> Breadth-first search was done via google links ;)
[01:11:49] <strcat> I want a download, so I click Downloads
[01:12:00] <jhasse> strcat: where?
[01:12:13] <jhasse> strcat: ah okay. Got it. Continue
[01:12:34] <strcat> scroll down until you get to the windows builds (or search for 'windows' until you get there)
[01:12:46] <strcat> two choices: mingw-builds, win-builds
[01:12:54] <strcat>  Additional Software: GDB, Python, zlib, libiconv.  (mingw-builds)
[01:12:59] <strcat>  Additional Software: atk, c-ares, ca-certificates, cairo, curl, dbus, ecore, edje, eet, eina, elementary, embryo, evas, evil, expat, flexdll, fontconfig, freetype, gdk-pixbuf2, gettext, giflib, glib-networking, glib2, gmp, gnutls, gperf, gtk+2, icu4c, libarchive, libffi, libjpeg, libmpc, libogg, libpng, libsoup, libtheora, libtiff, libvorbis, libxml2, lua, mpfr, nettle, ocaml, ocaml-findlib,
[01:13:01] <strcat> openssl, pango, pixman, pkg-config, sqlite, wget, win-iconv, winpthreads, x264, xz, zlib.  (win-builds)
[01:13:03] <strcat> so the obvious lazy choice is win-builds
[01:13:34] <strcat> which is a separate project (they build that whole list of stuff) and has a downloads link with instructions
[01:13:37] <rossm> anyway I'm really glad it sounds easier to get rust up and running in windows than I imagined it was. it's a bit of a hassle to use a linux VM for it. I'm definitely going to install it tonight
[01:13:40] * strcat shrugs
[01:13:42] <jhasse> strcat: okay so now I'm on win-builds.org. Documentation/Downloads?
[01:13:46] <strcat> jhasse: yes
[01:13:46] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[01:13:53] <strcat> and then just follow that - it should work, I can't tell you if it does ;p
[01:13:58] <JamesDunne> Now find the link buried deep in some stupid paragraph
[01:14:04] <geomyidae_> "hosted on Sourceforge" says a lot these days. :/
[01:14:06] <cmr> well it's in a table.
[01:14:09] <cmr> geomyidae_: yeah it really does
[01:14:21] <jhasse> strcat: there's no installer there
[01:14:29] <strcat> jhasse: there is, read the instructions for installing it ;p
[01:14:31] *** Joins: sssa (Mibbit@moz-624A376B.guap.ru)
[01:14:38] <strcat> 2. Getting and running the system
[01:14:44] <JamesDunne> strcat: See what I mean? Too much reading, too much clicking around.
[01:14:50] <geomyidae_> buried in a paragraph, no kidding, wow.
[01:14:55] <strcat> JamesDunne: sure, I agree, it takes 5 minutes instead of 10 seconds
[01:14:57] <jadbaires> what'd be the downside to use closures everywhere instead of functions? is it just a efficiency issue or is there more to it than that?
[01:15:02] <JamesDunne> until you finally stumble upon a dumb paragraph and the link is buried
[01:15:13] *** Quits: sssa (Mibbit@moz-624A376B.guap.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[01:15:19] <strcat> JamesDunne: not rust's fault that windows developers haven't set up an easy to use open-source compiler download ;p
[01:15:36] <strcat> instead there's this crap hosted on sourceforge
[01:15:46] <JamesDunne> strcat: Agreed
[01:15:46] <geomyidae_> Not rust's fault, but it will be (and is) where people direct their frustration
[01:15:53] <JamesDunne> Exactly
[01:15:54] <strcat> geomyidae_: why though?
[01:15:58] <jhasse> strcat: what about including http://win-builds.org/stable/win-builds-bundle-1.3-rc2.zip in rust's instructions?
[01:16:01] <strcat> want to use C++11 on windows? it is not easier
[01:16:08] <strcat> jhasse: that makes sense
[01:16:19] <strcat> submit a pull request ;p
[01:16:25] * strcat will r+ it if someone does
[01:16:28] <JamesDunne> Just listing on rust's tutorial page some links to mingw64 builds would be vastly simpler, assuming you could keep said links alive and pointing to the relevant win-builds page
[01:16:34] <jhasse> strcat: Actually it's very easy. MSVC++ is in c++11 mode by default
[01:16:44] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[01:16:45] <strcat> jhasse: MSVC++ doesn't support all of C++11, it's missing lots of important parts
[01:16:48] <strcat> so no
[01:17:03] <JamesDunne> jhasse: Actually with VS2013, C++11 support is much better.
[01:17:10] <Tobba> MSVC++ supports most of the nice stuff
[01:17:10] <JamesDunne> jhasse: Oops I meant to strcat:
[01:17:14] <strcat> still missing tons
[01:17:15] <Tobba> I've never found something I need that it doesnt support
[01:17:16] <jhasse> strcat: so does g++ :P (try std::map::emplace)
[01:17:17] <strcat> clang and gcc have complete C++11 support 
[01:17:26] <strcat> jhasse: g++ has complete C++11 support
[01:17:31] <JamesDunne> So require a clang windows build; forget mingw.
[01:17:33] *** jorendorff_away is now known as jorendorff
[01:17:33] <strcat> as does libc++
[01:17:37] <geomyidae_> strcat, I could say a lot of things, but I'll just be uh, not too pessimistic. I do know that in tech communities, hn/irc... a good way to get an answer is to start with an insult. The typical linux trope... need your wifi fixed? join #linux and say "linux sucks because my wifi doesn't work". Similarly, I can either come to #rust and whine about not being
[01:17:37] <geomyidae_> able to figure our mingw or try #mingw on freenode, but I'm laughing at that suggestion myself...
[01:17:46] <JamesDunne> Is there a clang win64 binary installer somewhere?
[01:17:57] <geomyidae_> (certainly not saying it /should/ be that way)
[01:18:16] <strcat> JamesDunne: maybe, but you probably want msys for gdb, etc.
[01:18:27] <JamesDunne> strcat: LLVM has no debugger?
[01:18:37] <strcat> lldb is really immature and it's *weird*
[01:18:45] <JamesDunne> Lol ok.
[01:18:47] <strcat> although, OS X does use lldb in xcode now afaik
[01:18:53] <strcat> but with xcode's frontend which takes away a lot of the weird.
[01:19:00] <JamesDunne> gdb is a separate beast from mingw64 though, yes?
[01:19:31] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:19:37] <strcat> JamesDunne: well... I'd assume it comes with mingw-builds/win-builds
[01:19:41] <strcat> it'd be sad if they didn't ship it
[01:19:42] <SiegeLord> I somehow have it in my mingw-builds folder
[01:20:00] <JamesDunne> MinGW64 install took 11 minutes for me
[01:20:01] <SiegeLord> What mingw-w64 is missing is msys
[01:20:14] *** Quits: bgmerrell (bgmerrell@moz-AFAF64AB.members.linode.com) (Quit: leaving)
[01:20:22] <JamesDunne> rust-0.9 installer, install to C:\Program Files (x86)\Rust ????
[01:20:34] <jhasse> JamesDunne: yes
[01:20:37] <SiegeLord> I think you need msys for actually building rustc
[01:20:41] <JamesDunne> Gross.
[01:20:42] <jhasse> it adds the bin folder to the PATH
[01:20:43] <strcat> SiegeLord: yeah, you do
[01:20:54] <jhasse> JamesDunne: why?
[01:21:03] *** Joins: RaFromBRC (RaFromBRC@moz-DB4A9C19.scl3.mozilla.com)
[01:21:15] <JamesDunne> Well, for one, the (x86) implies a 32-bit compiler
[01:21:16] <strcat> SiegeLord: hm, do you need it to build LLVM? or does it build in MSVC++, etc.
[01:21:19] <strcat> via cmake
[01:21:33] <strcat> I guess you need cmake though
[01:21:33] <JamesDunne> And two, I usually prefer to install compiler suites to C:\ or D:\ or whatever.
[01:21:36] <strcat> so...
[01:22:01] <strcat> oh I forgot to push rust 0.9 to the arch repos
[01:22:04] <strcat> oops.
[01:22:29] <Tobba> argh
[01:22:34] <Tobba> there needs to be a builtin typeof! macro
[01:22:37] *** Quits: nobody (nobody@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[01:22:46] <strcat> Tobba: not possible to do that with a macro
[01:22:48] *** Joins: dangets (dangets@moz-E9E4A77B.cpe.cableone.net)
[01:22:54] *** Joins: nobody (nobody@moz-7E09A266.neo.res.rr.com)
[01:22:58] <strcat> would need to be a language feature
[01:22:59] <Tobba> well, more like syntax extension
[01:22:59] <jhasse> JamesDunne: MSVC++ is a 32 bit compiler and installs to Program Files (x86) ;)
[01:23:03] <Tobba> like asm! is
[01:23:09] <Tobba> currently typeof is a reserved keyword
[01:23:12] <strcat> Tobba: not possible with a syntax ext either ;p
[01:23:15] <JamesDunne> rust installer definitely needs some love given to the end-user.
[01:23:18] <Tobba> well shit
[01:23:21] <JamesDunne> jhasse: Hah true
[01:23:22] <strcat> afaik there's something like an __asm__ keyword
[01:23:35] *** Joins: pyon (user@BCC41BDF.6C782DF8.1C8C8CE9.IP)
[01:23:42] <cmr> JamesDunne: well it's not like it's had any work done on it recently
[01:23:47] <jadbaires> why are values allowed in type declarations? e.g. type a = fn(x:int)->int;    is it for self documentation purposes? 
[01:23:49] <dbaupp> Tobba: what do you want it for?
[01:23:53] <jhasse> JamesDunne: I think 64 bit compiler wouldn't result in any noticable speed up anyway
[01:23:54] <JamesDunne> jhasse: But I'd expect any recent software written to be 64-bit native or at least 64-bit friendly
[01:24:05] <Tobba> I have this macro which calls an external function
[01:24:06] <strcat> JamesDunne: it is 64-bit native/friendly
[01:24:11] <Tobba> with the offset of a field
[01:24:18] <strcat> JamesDunne: but rust uses mingw upstream (not mingw-w64)
[01:24:19] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:24:21] *** Quits: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:24:22] <Tobba> then I need to cast the result to a pointer to that field and dereference it
[01:24:22] <JamesDunne> strcat: Then why is it in Program Files (x86)?
[01:24:26] <strcat> JamesDunne: because windows
[01:24:26] <Tobba> but I need a proper type to do that
[01:24:28] <JamesDunne> Lol
[01:24:29] <cmr> JamesDunne: as long as I've been a contributor I've never seen any changes to it.
[01:24:33] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Quit: Leaving.)
[01:24:42] <strcat> JamesDunne: it's just a bit of a pain to switch to mingw-w64 because of snapshotting
[01:24:44] <jadbaires> and by value I'm referring to the x in type a = fn(x:int)->int;
[01:24:52] <cmr> jadbaires: yes.
[01:24:55] <dbaupp> Tobba: you can probably do a hack with type inference
[01:25:02] <strcat> JamesDunne: would have been good to use it from the start
[01:25:03] <Tobba> I had an idea
[01:25:08] <JamesDunne> Let me rephrase; I'd expect software *packaged* to be 64-bit native, or at least offer both compiled versions
[01:25:08] <jhasse> JamesDunne: that's only the installer. It would be no problem to build a 64 bit version of rustc for Windows. But why?
[01:25:11] <Tobba> with a temp var which is set to something like
[01:25:11] <strcat> but I don't think the rust devs knew mingw-w64 existed then
[01:25:22] <jadbaires> cmr: thanks... for a moment that looked almost like dependent types, so I was wondering
[01:25:27] <strcat> JamesDunne: well... if graydon had been aware of mingw-w64 years ago ;p
[01:25:29] <Tobba> transmute::<int, *CoreState>(0).field
[01:25:31] <Tobba> just to get the type
[01:25:32] <JamesDunne> Heh
[01:25:42] <dbaupp> Tobba: have a function like `fn cast_to_type_of<T>(general_pointer: *(), _as_type_of: &value) -> *T { general_pointer as *T }`
[01:25:45] <JamesDunne> I'm just saying - these are first impressions from downloading the installer
[01:25:59] <dbaupp> Tobba: and then call it like `cast_to_type_of(ptr, &some_example_value)`
[01:26:02] *** Quits: alan_andrade (alan_andra@94147F3C.3C8440C4.B7838CA6.IP) (Input/output error)
[01:26:08] <jhasse> JamesDunne: okay, I get your point ;)
[01:26:25] <dbaupp> Tobba: (I guess your transmute there would work perfectly)
[01:26:25] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[01:26:25] <strcat> it's an open-source project - the stuff that gets fixed depends on who contributes
[01:26:28] <jhasse> the installer should also be hidpi aware
[01:26:30] <Tobba> macro_rules! getCoreState(($f:ident) => {unsafe{let r = transmute::<int, *CoreState>(0).$f; r = transmute(_getState(offsetof_!(CoreState, $f))); r}})
[01:26:31] <Tobba> I think this works
[01:26:34] <JamesDunne> It gives you: nothing. No hints on how to get started, gives you an x86 exe, doesn't add to your $PATH, etc.
[01:26:42] <strcat> if it sucks on freebsd, it's because freebsd users aren't contributing
[01:26:48] <strcat> so, stop complaining and submit pull requests
[01:26:51] <JamesDunne> I would gladly contribute :)
[01:26:52] <dbaupp> Tobba: `let mut r = ...`, but eah
[01:26:55] <dbaupp> *yeah
[01:26:57] * strcat shrugs
[01:26:59] *** Joins: eagleflo (aku@moz-14928E87.fi)
[01:27:00] <Tobba> ah, right
[01:27:08] <strcat> arch has rust 0.9 now ;p
[01:27:20] <cmr> So is Rust hip now? We're at the top of HN
[01:27:28] <Tobba> HN?
[01:27:31] <cmr> hacker news
[01:27:34] <cmr> http://semver.org/
[01:27:34] <Tobba> oh boy
[01:27:36] <cmr> erm
[01:27:38] <cmr> https://news.ycombinator.com/
[01:27:41] <Tobba> I was skeptic about rust when I first saw it
[01:27:41] <strcat> although in a matter of minutes it will have the rust-git build anyway...
[01:27:44] <Tobba> but oh my
[01:27:45] <mcpherrin> cmr: Mozilla always wins at HN 'cause all the mozillians upvote and talk about things ;)
[01:28:03] <JamesDunne> Oh yeah, I forgot you guys were Mozilla.
[01:28:06] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Ping timeout)
[01:28:44] <cmr> "you guys"
[01:28:55] <cmr> probably less than 1% of the rust contributors?
[01:29:04] <JamesDunne> Like I know who's who on IRC after 2 days :P
[01:29:10] <JamesDunne> So, "you guys" it is.
[01:29:21] *** Quits: dbaupp (Thunderbir@moz-BB237A70.lns20.syd6.internode.on.net) (Ping timeout)
[01:29:31] <mcpherrin> cmr: in terms of people, but in terms of code written much higher :P
[01:29:35] <cmr> deffers
[01:29:36] <jhasse> strcat: I am ;) But I'm not interested in improving the installer to improve the impression which rust makes to other people. IMHO that should be the job of a mozilla employee, because it's mozilla's goal that rust becomes popular, isn't it?
[01:29:43] *** Joins: dbaupp (Thunderbir@moz-BB237A70.lns20.syd6.internode.on.net)
[01:30:15] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[01:30:19] <cmr> jhasse: windows isn't a focus right now. if it isn't done by the time it needs to be done, it will be done.
[01:30:39] <JamesDunne> Then why post on HN incurring buzz?
[01:30:45] <mcpherrin> The "getting started" on all platforms kinda sucks
[01:30:47] <strcat> JamesDunne: that wasn't posted by a core developer
[01:30:55] <JamesDunne> Are you assuming everyone is a Linuxer?
[01:30:58] <strcat> if by 'core' developer you mean 'receives a salary'
[01:30:59] <JamesDunne> Ok
[01:31:01] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Client exited)
[01:31:08] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[01:31:10] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[01:31:10] *** ChanServ sets mode: +ao pcwalton pcwalton
[01:31:16] <strcat> JamesDunne: almost everyone contributing to rust right now uses OS X or linux
[01:31:22] <strcat> so... that's what is solid
[01:31:26] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[01:31:29] <JamesDunne> Fair enough
[01:31:29] <strcat> freebsd support isn't solid, windows support isn't solid
[01:31:30] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[01:31:40] <strcat> and there's no support for solaris, aix, hp-ux, and so on ;p
[01:31:40] *** Quits: ramitos (ramitos@moz-60679625.socal.res.rr.com) (Connection reset by peer)
[01:31:44] <JamesDunne> I can pitch in to Windows support if it would be accepted.
[01:31:45] <strcat> openbsd, netbsd - no support
[01:31:49] <mcpherrin> JamesDunne: It would be.
[01:32:16] <cmr> JamesDunne: definitely!
[01:32:21] <strcat> anyway unless someone is going to pay me, I know *I* have no motivation to work on making rust work well on windows
[01:32:45] <JamesDunne> strcat: Lol, I kinda picked that up
[01:32:51] <mcpherrin> I do, but I don't have the free time right now :/
[01:32:53] <dbaupp> JamesDunne: vadimcn and klutzy are the people to communicate with if you wish to help :) (they have done the vast majority of the recent windows support improvements)
[01:33:07] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[01:33:15] <JamesDunne> dbaupp: Very good. Where's the rust-installer exe src?
[01:33:21] <lurk_> Is there any interest in using rust as a game dev language?
[01:33:27] <strcat> lurk_: lots
[01:33:31] <rossm> lurk yes, a lot
[01:33:34] <dbaupp> JamesDunne: no idea :)
[01:33:34] <ecl3ctic> lurk_: me!
[01:33:38] <lurk_> I would imagine Windows would be important for that then
[01:33:40] <JamesDunne> dbaupp:  lol
[01:33:40] <strcat> in fact I'd say there's more interest in game dev and os dev with rust than anything else
[01:33:51] <jhasse> JamesDunne: https://github.com/mozilla/rust/tree/master/src/etc/pkg
[01:34:01] <JamesDunne> lurk_: Aye. As would, probably, a SteamOS binding. Heh
[01:34:07] <strcat> lurk_: sure, via cross-compilation ;p
[01:34:14] <strcat> JamesDunne: we support SteamOS
[01:34:19] <dbaupp> there's a whole IRC channel for each of gamedev and osdev (#rust-gamedev and #rust-osdev respectively)
[01:34:22] <JamesDunne> jhasse: Ahh I was so close. I went poking around in there but didn't find the installer.
[01:34:23] <ecl3ctic> lurk_: I'll just develop for SteamOS ;)
[01:34:25] <strcat> SteamOS is just Debian.
[01:34:28] *** Quits: negativezero (negativeze@moz-5445889D.public.wayport.net) (Ping timeout)
[01:34:41] <JamesDunne> And Android is just Linux
[01:34:46] <strcat> JamesDunne: except it's not
[01:34:49] <JamesDunne> Lol
[01:34:51] <strcat> SteamOS is actually just Debian
[01:34:55] <strcat> that's... what it is
[01:35:05] <lucian> well, SteamOS sort of implies bindings for SDL and the other things it ships with. but not really an issue
[01:35:06] <jhasse> lurk_: I'm a game dev and using rust on windows. The thing is: I'm already used to msys and mingw so I have no interest in improving the windows installer. Rust itself works fine on windows
[01:35:06] <bitcrusher> it has some modifications
[01:35:13] <JamesDunne> There's that opaque binary static lib and API stuff though
[01:35:15] <jack> I can't put a chan in HashSet?
[01:35:17] <strcat> lucian: we have sdl2 bindings
[01:35:27] <dbaupp> jack: it's not hashable?
[01:35:28] <jack> i will have to derive my own iterbytes i guess
[01:35:32] <strcat> JamesDunne: afaik, to support steam you mostly just need to be using sdl2
[01:35:36] <JamesDunne> Honestly, haven't looked into SteamOS dev details at all, so I'll just hush now.
[01:35:38] <strcat> and the in-game interface and so on will Just Work
[01:35:45] <lucian> strcat: sure. i just meant SteamOS implies debian + a few libs + steam client api
[01:35:48] <JamesDunne> Ah nice
[01:35:56] <dbaupp> jack: (iterbytes won't be #[deriving]able for any struct containing a chan if it doesn't have one already)
[01:35:58] <lucian> strcat: none of that is an issue, i was nitpicking
[01:36:01] <bjz> btw folks, #rust-gamedev is a thing
[01:36:15] <bjz> for gamedev discussion :)
[01:36:25] <bitcrusher> sadly it is full of idlers
[01:36:33] <strcat> JamesDunne: in fact they hired one of the sdl developers...
[01:36:35] <ecl3ctic> bjz: it's too quiet over there :P
[01:36:36] <lucian> i'm getting really confused on how i should make a persistent vector using Arc :(
[01:36:42] <bjz> bitcrusher: we do talk
[01:36:42] *** Joins: ramitos (ramitos@moz-60679625.socal.res.rr.com)
[01:36:43] <JamesDunne> strcat: Very cool!
[01:36:45] <strcat> afaik sdl2 has a lot to do with valve
[01:36:50] <dbaupp> bitcrusher: it gets discussion every so often
[01:37:01] <JamesDunne> sdl1.2 was kinda a mess; haven't bothered with sdl2 yet
[01:37:03] <strcat> they were using it for their source ports to linux before it was released (maybe even their earlier OS X ones - dunno!)
[01:37:03] <bjz> bitcrusher: if you start up a conv, we do
[01:37:22] <strcat> JamesDunne: yeah, sdl2 is a huge improvement, there's a nice feature list at http://wiki.libsdl.org/MigrationGuide
[01:37:34] <bjz> bitcrusher: I also direct support for my libs over there
[01:37:34] <strcat> although I have the user perspective of the improvements
[01:37:43] *** Joins: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP)
[01:37:52] <strcat> I don't know how much they improved the API because I've only used sdl2 and not sdl1.2 as a developer...
[01:37:56] <JamesDunne> does sdl2 have anything to do with Sam L?
[01:37:57] *** Quits: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: It is tiem!)
[01:38:13] <JamesDunne> sdl1.2 was quite buggy regarding pushing pixels around
[01:38:21] <bjz> strcat: the event handling is hard to wrap because it uses a huge union :(
[01:38:35] <strcat> bjz: well I haven't used it from rust ;p
[01:38:58] <SiegeLord> What's hard to wrap about a union :P
[01:38:59] <jhasse> JamesDunne: I hope not
[01:39:08] <JamesDunne> lol
[01:39:13] <SiegeLord> Easier than wrapping callbacks
[01:39:19] <bjz> SiegeLord: well, it isn't hard to wrap
[01:39:36] <bjz> SiegeLord: but to do it with a nice api is hard
[01:39:41] <strcat> JamesDunne: well, valve is using it for l4d2, tf2, hl2 and so on so it must work pretty well ;p
[01:39:41] *** Joins: krdln (Mibbit@moz-C271714F.dynamic.chello.pl)
[01:39:52] <SiegeLord> I dunno about SDL2, but with Allegro5 I just use an enum
[01:40:03] <JamesDunne> sdl1.2? heh yeah, one can get it to work eventually.
[01:40:05] <SiegeLord> Just return a variant... and you're done
[01:40:11] <strcat> JamesDunne: no I mean sdl2
[01:40:11] <jhasse> strcat: Valve is using it? It must be buggy like hell ...
[01:40:18] <JamesDunne> Oh. I wouldn't know anything about that then.
[01:40:26] <strcat> they started using sdl2 before it was released
[01:40:26] <bjz> SiegeLord: requires added copying
[01:40:35] <strcat> and hired the dev
[01:40:45] <JamesDunne> Acquihire.
[01:40:54] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[01:40:58] <SiegeLord> bjz: Not going to be a performance drain
[01:41:03] <JamesDunne> "We'll take you and all of your SDLs too"
[01:41:05] <cmr> it's not really a acquihire when there's no company acquisation going on.
[01:41:24] <JamesDunne> Intellectual property
[01:41:30] <cmr> ... it's still open source
[01:41:32] <JamesDunne> If you want to give it a label of some kind I guess
[01:41:37] <cmr> it's just hiring a person
[01:41:38] <lucian> he still owns it, unless he assigned copyright
[01:41:41] <JamesDunne> I didn't imply proprietary
[01:41:45] <JamesDunne> Nevermind, bad term.
[01:42:04] <strcat> lucian: they don't require a CLA though
[01:42:10] <SiegeLord> bjz: The most frequent event will be a timer... which is 60FPS. 60FPS of copying a 120 byte structure won't show up on any profiler
[01:42:19] <jadbaires> cmr: I understand the idea of having variable names on types as documentation, but it gets a bit confusing with currying no?
[01:42:20] <bjz> SiegeLord: ah ok
[01:42:29] <jadbaires> cmr: e.g.        let fact_aux = |n:uint| -> |m:int| -> () {...}
[01:42:30] <strcat> lucian: I think valve doesn't really care much about sdl2 or their own games as much as they about third party devs on steam using it
[01:42:34] <cmr> jadbaires: then don't use them.
[01:42:38] <cmr> jadbaires: they're not requires
[01:42:40] <cmr> *required
[01:42:51] <lucian> strcat: i meant code that existed when they hired him. i doubt they asked him to assign copyright of work he did in his own time, so no acquiring of anything at all
[01:42:54] <SiegeLord> The next most frequent will be keyboard events... but that'll be even slower
[01:42:54] <strcat> ah
[01:43:16] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[01:43:31] <strcat> bjz: we should pick up support for reading headers with libclang anyway
[01:43:34] <jadbaires> cmr: I wasn't trying to, to be honest, I was declaring curried functions wrong (it's a bit different from haskell)
[01:44:04] <cmr> jadbaires: (that's also not possible)
[01:44:10] <strcat> bjz: all you really need from rust is it to read the header and make a struct with the right size/alignment
[01:44:18] <jadbaires> cmr: curried closures...
[01:44:25] *** Joins: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com)
[01:46:11] <JamesDunne> Alright, let's see how far I can get in tuning up the Windows side of things... No promises.
[01:46:31] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:46:44] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[01:47:54] <Tobba> Rust on windows will hopefully at least be improved in 1.0
[01:48:11] <JamesDunne> Tobba: Not if nobody works on it. :)
[01:48:22] <strcat> luckily 1.0 isn't going to be for a while ;p
[01:48:26] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[01:48:34] <Tobba> for a good windows build mingw either needs to be cut off, staticaly linked or just have relevant files included
[01:48:35] <cmr> Tobba: it will be
[01:48:40] <cmr> we're not releasing with poor windows support.
[01:48:45] <cmr> it's a blocker
[01:48:51] <Tobba> I think the third is a reasonable option except for the issues with path stuff that brings
[01:48:58] <JamesDunne> Good to know. I'm thinking of cutting out mingw here.
[01:49:01] *** btm_home is now known as btm_work
[01:49:08] <wycats_> am I missing something here: https://github.com/chris-morgan/rust-http/blob/master/src/http/server/request.rs#L221
[01:49:12] <wycats_> I don't see a url field
[01:49:14] <Tobba> I tried to compile it outside of mingw
[01:49:16] <Tobba> it was one hell of a disaster
[01:49:21] <jhasse> Tobba: statically linnked isn't possible afaik (GPL)
[01:49:27] <Tobba> goddamnit stallman
[01:49:33] <cmr> wycats_: doesn't exist yet.
[01:49:36] <JamesDunne> lol
[01:49:40] <cmr> jhasse: LGPL, not GPL
[01:49:43] <wycats_> nice
[01:49:53] <strcat> jhasse: afaik it's GPL with linking exceptions and LGPL
[01:50:03] <cmr> wycats_: the field it references does yet to exist 
[01:50:06] <strcat> so it can probably be statically linked if you ship linkable object files too
[01:50:12] <wycats_> cmr: does it?
[01:50:18] <jhasse> strcat: ah nice! Even on the tool side? (Not libstdc++)
[01:50:18] <Tobba> it shouldent be that hard to cut it out though
[01:50:30] <cmr> wycats_: it doesn't exist; it has yet to exist
[01:50:32] <strcat> jhasse: well... on the tool side, no, because they're binaries
[01:50:34] <cmr> (sorry, tired, a bit loopy)
[01:50:41] <wycats_> what is happening here
[01:50:43] <Tobba> llvm works fine on windows
[01:50:48] <strcat> jhasse: maybe LLD can be used as a library, dunno
[01:50:56] <Tobba> so it should be doable, I just dont see how a mingw -> windows cross compile would take place
[01:50:57] <jhasse> Tobba: I'm for "relevant files included"
[01:50:57] <cmr> wycats_: the `url` field is to-do
[01:50:58] <Tobba> also the linker yeah
[01:51:05] <wycats_> cmr: seems legit
[01:51:16] <wycats_> which form should I expect to get?
[01:51:45] <Tobba> though, in theory, I can use msvc to build all the LLVM wrappers
[01:51:57] <Tobba> then just staticaly link those to my llvm build
[01:52:00] <strcat> Tobba: linker (LLD isn't very mature), debugger (lldb isn't very mature either), C99 runtime, etc.
[01:52:10] <jhasse> JamesDunne: where do you want to cut ot mingw?
[01:52:12] <strcat> like the C99 math support
[01:52:12] <Tobba> yeah I see linker being an issue
[01:52:14] <ecl3ctic> is there a shorthand way to label all of a struct's fields as private without going through each one? Is something like priv {} or priv: valid?
[01:52:16] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[01:52:24] <strcat> ecl3ctic: don't make the struct public ;p
[01:52:31] <JamesDunne> jhasse: Say, out of the entire compilation chain on Windows. I'm just poking around at the moment.
[01:52:50] <ecl3ctic> strcat: I want private fields, public methods :P
[01:52:52] <Tobba> including relevant files would work but yeah ugh
[01:53:06] <Tobba> it would also make adding rust to the path dangerous if you have mingw on your path already
[01:53:09] <jhasse> JamesDunne: I think it's much easier to include needed parts from MinGW in the windows installer
[01:53:12] <cmr> ecl3ctic: not yet
[01:53:18] <Tobba> unless you rename all the files, whcih I guess
[01:53:20] <strcat> at the very least we need a linker and C99 runtime support
[01:53:36] <jhasse> Tobba: A simple check if gcc is already in the path should fix that
[01:53:36] <strcat> the math stuff is the important part
[01:53:38] <Tobba> doesnt llvm have a c99 runtime
[01:53:41] <ecl3ctic> cmr: ok, thanks
[01:53:49] <jadbaires> wait, maybe I misunderstood, we can't curry closures?  e.g. something like this  let aux2 : |int| -> (|int| -> int) =  |x| |y| x+y+1;
[01:54:00] <strcat> Tobba: no, LLVM doesn't have a C library
[01:54:00] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[01:54:10] <cmr> jadbaires: correct, we cannot.
[01:54:12] <jhasse> Tobba: or an option to NOT install the mingw files. People with mingw installed would propably know what they are doing
[01:54:15] <Tobba> ah right, only a c++ one
[01:54:25] <Tobba> jhasse: probably, easy to miss an option though
[01:54:25] <strcat> they have the compiler support lib (compiler-rt), libc++/libc++abi and a libunwind reimplementation
[01:54:31] <cmr> jadbaires: the inner closure reference the outer closure's environment, and it can't return it because that'd be memory unsafe.
[01:54:49] <jhasse> Tobba: not for people used to the mingw installer :P
[01:54:55] *** Joins: flounder (Mibbit@moz-38276AA6.guam.net)
[01:55:06] <jhasse> Tobba: or msysgit
[01:55:08] <strcat> Tobba: LLD is really not ready though, unless you are okay with only having static linking...
[01:55:09] <jadbaires> cmr: ohh...
[01:56:24] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Input/output error)
[01:57:01] <Tobba> oh geez
[01:57:05] <Tobba> C99 shouldent be that hard though
[01:57:09] <Tobba> we only use like what
[01:57:13] <Tobba> 10 functions?
[01:57:17] *** Joins: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au)
[01:57:31] <Tobba> 64 bit math stuff, I think llvm might invoke memcpy and memset
[01:57:31] <cmr> We can ship openlibm if we absolutely need to.
[01:57:33] *** Quits: dev14 (devarshdes@C8A1BC8D.6DB843DD.3FBA778E.IP) (Quit: dev14)
[01:57:41] <Tobba> thats basicaly it though
[01:58:03] <Tobba> and
[01:58:07] <Tobba> ah right float stuff, crap
[01:58:28] <Tobba> openlibm looks pretty okay though
[01:58:45] <Tobba> (rewrite it in rust!)
[01:58:54] <cmr> there's no point to that really.
[01:59:00] <cmr> a lot of work for no gain?
[01:59:02] <Tobba> of course not
[01:59:04] <cmr> who wants that :)
[01:59:22] <b1nd> cmr: https://github.com/mozilla/rust/issues/10535 can I have a go at this?
[01:59:24] <Tobba> self hosting and all that
[01:59:32] <cmr> b1nd: please do!
[01:59:47] *** Joins: ercxx (ercan@moz-88DD3A7E.dyn.optonline.net)
[01:59:55] <b1nd> no worries, just looking into how /doc works
[01:59:59] *** Joins: alan_andrade (alan_andra@C04DF67.9FF9096A.B7838CA6.IP)
[02:00:00] <b1nd> multiple main.js files etc
[02:00:15] <Tobba> I might end up reimplementing it anyways for my driver support library
[02:00:20] <Tobba> learning practices and all
[02:00:31] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[02:00:33] <cmr> b1nd: while you're at it, can you make the search search for two-character inputs too? possibly with a slight delay before actual search, for efficiency or whatnot.
[02:00:45] *** Parts: klaus (koz@moz-E49E7C4B.hsd1.wa.comcast.net) ()
[02:00:55] <b1nd> Yea will look into it
[02:01:16] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[02:01:17] <sam113101> RUST 0.9!!!!
[02:01:28] <sam113101> woooooooooo
[02:01:29] <cmr> thanks :)
[02:01:42] <Yurume> woo hoo
[02:01:50] <Tobba> anyone know whats coming up in 0.10
[02:01:50] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[02:01:52] <Yurume> and I have to migrate :)
[02:01:57] <Tobba> too many issues to go through and see what needs to be implemented
[02:02:10] <sam113101> I thought it would be 1.0 xDDD
[02:02:39] <cmr> Tobba: three months of development :)
[02:02:39] <dbaupp> sam113101: you're a little too optimistic :P
[02:02:56] <Tobba> works too
[02:02:58] <dbaupp> Tobba: (0.x releases aren't blocked on features)
[02:03:01] <strcat> Tobba: rust's releases are just tags on master every 3 months
[02:03:08] <strcat> there's no support post tagging or anything like that
[02:03:14] <Tobba> hah
[02:03:14] <JamesDunne> Inno Setup Compiler, y u suck so bad?
[02:03:16] <Yurume> strcat: tags that also act as a mild milestone, but yeah
[02:03:16] <strcat> there won't be any fixes for 0.9, it's done
[02:03:30] <Tobba> yeah I get that part
[02:03:31] <strcat> anyway 0.9 is old, use master ;p
[02:03:35] <cmr> heh
[02:03:37] <Yurume> lol
[02:03:37] <Tobba> hahahah
[02:03:40] <JamesDunne> lol
[02:03:41] <mcpherrin> strcat: hah 
[02:03:44] <Tobba> I need to recompile my repo now
[02:03:45] <cmr> I expected to see that, but not the day of!
[02:03:54] *** Quits: flounder (Mibbit@moz-38276AA6.guam.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:04:21] <wycats_> if I have a function in a struct field, how do I define the lifetime
[02:04:28] <wycats_> I think someone explained this to me before
[02:04:36] <b1nd> so what's the changes that happened with managed pointers?
[02:04:36] <strcat> wycats_: if you have a function, you don't have to
[02:04:36] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[02:04:37] <wycats_> I'm trying Foo<'a |&x, &y|>
[02:04:37] *** Quits: jhasse (jhass_000@moz-930A1FAF.ewe-ip-backbone.de) (Quit: Verlassend)
[02:04:39] <wycats_> but no dice
[02:04:42] <b1nd> they being deprecated/removed?
[02:04:45] <strcat> wycats_: if you have a closure (like that) you do
[02:04:58] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[02:05:01] <strcat> wycats_: struct Foo<'a> { x: 'a || -> bool }
[02:05:34] <wycats_> my closure is inside a generic
[02:05:47] <wycats_> https://www.irccloud.com/pastebin/BoYIrlwH
[02:06:04] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[02:06:08] <strcat> struct Foo<'a, T> { ... }
[02:06:19] <wycats_> 'a, || -> ...
[02:06:23] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[02:06:26] <strcat> wycats_: this pastebin doesn't load for me
[02:06:27] <dbaupp> wycats_: there's various problems with closures in structs
[02:06:31] <dbaupp> wycats_: sec
[02:06:31] <strcat> oh wait nvm it did
[02:06:43] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[02:06:43] <strcat> certainly took a while...
[02:07:04] <dbaupp> wycats_: https://github.com/mozilla/rust/issues/11211 (and 11209 and 11210)
[02:07:12] *** Quits: Arthur_D (Trillian@moz-E327D6BC.torservers.net) (Input/output error)
[02:07:25] <wycats_> is there a workaround?
[02:07:33] <dbaupp> don't think so :(
[02:07:42] <wycats_> :/
[02:07:59] <strcat> wycats_: use a function instead? although I don't really know what the issue is :)
[02:08:07] <ecl3ctic> Question: can you not index c-style pointers in Rust?
[02:08:18] <strcat> ecl3ctic: you can do pointer arithmetic
[02:08:24] <strcat> there isn't sugar for it, it's a function
[02:08:26] <ecl3ctic> such that when I want to do crazy unsafe stuff, I'm doing: i = *((x as uint + 4) as *uint);
[02:08:27] <Tobba> I think lldb is actually reasonably mature
[02:08:33] *** Quits: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net) (Quit: Leaving.)
[02:08:33] <Yurume> ecl3ctic: you can, via offset()
[02:08:33] <strcat> Tobba: on OS X
[02:08:39] <Tobba> hah
[02:08:41] <Tobba> fair point
[02:08:45] <Yurume> rusti:
[02:08:47] <Yurume> rusti: version
[02:08:51] <Tobba> in my case I dont think it matters though
[02:08:51] <Yurume> gone! :S
[02:08:53] <strcat> rusti is dead until cmr fixes it
[02:09:01] <strcat> don't want to keep an old version around
[02:09:21] <Tobba> I'm guessing lldbs support for hooking into other processes is kinda bad
[02:09:24] <Tobba> on linux
[02:09:24] <strcat> rustc doesn't currently work via pipes properly
[02:09:29] <Taneb> I wish I knew enough Rust to be able to help out with Rust
[02:09:37] <Tobba> I think it should work properly over a stub however
[02:09:37] <strcat> Tobba: I think it works a bit on linux ;p
[02:09:51] <strcat> I don't really expect that it works on windows though
[02:09:57] <ecl3ctic> Yurume: ah, that'll work
[02:10:13] <Tobba> strcat: I dont really need support like that
[02:10:19] <Tobba> I just need a good remote debugger
[02:11:05] <JamesDunne> Anybody familiar with Inno Setup Compiler? It seems the latest version does not want to compiler the installer...
[02:11:07] <Tobba> basicaly, you have to implement all this crap
[02:11:08] <Tobba> https://www.kernel.org/pub/linux/kernel/people/marcelo/linux-2.4/arch/mips/kernel/gdb-stub.c
[02:11:19] <Tobba> then I can use remote debugging perfectly, at least in theory
[02:12:39] <Tobba> heck, if I implement that right, I can debug real hardware with it
[02:12:55] <JamesDunne> I think it's just whining since I don't have CFG_RELEASE env set
[02:13:25] *** Joins: willingc_ (willingc@moz-B4760708.san.res.rr.com)
[02:13:25] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Connection reset by peer)
[02:13:51] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[02:14:01] <wycats_> strcat: I can use a function but I'd rather not
[02:14:17] <strcat> wycats_: do you call it more than once?
[02:14:29] <wycats_> yes, it's a handler for an HTTP request
[02:16:30] <jadbaires> is there a reason we can't type annotate random expressions?
[02:16:47] <strcat> id::<T>(x)
[02:17:37] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:17:41] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[02:20:45] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:20:55] *** jorendorff is now known as jorendorff_away
[02:21:13] *** Quits: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP) (Ping timeout)
[02:22:02] <kimundi> jadbaires: There has been talk about allowing  : T  for any expression, but is neither a priority not necessary to use Rust, so no one is trying to add it right now
[02:22:36] *** Quits: mleise (marco@moz-850E56A9.pools.arcor-ip.net) (Ping timeout)
[02:23:09] *** Quits: alan_andrade (alan_andra@C04DF67.9FF9096A.B7838CA6.IP) (Quit: Leaving...)
[02:24:53] *** Quits: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[02:25:51] *** Quits: dangets (dangets@moz-E9E4A77B.cpe.cableone.net) (Ping timeout)
[02:26:07] <wycats_> ahhhh yeah: https://gist.github.com/anonymous/8345971#file-main-rs-L44-L53
[02:26:48] <sam113101> will rust 1.0 be released in 2014?
[02:27:08] <ion> 2014 will be the year of Rust 1.0 on the desktop.
[02:28:30] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Quit: Leaving...)
[02:28:41] <jadbaires> kimundi: fair enough
[02:28:41] <brson> sam113101: yes
[02:28:44] *** Quits: JamesDunne (Jaymz@moz-C84E6351.hsd1.il.comcast.net) (Quit: Leaving.)
[02:29:24] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[02:29:58] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[02:30:11] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[02:31:08] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[02:32:29] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:33:13] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[02:33:40] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (Quit: ziad)
[02:34:15] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:34:46] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[02:36:24] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[02:37:26] *** Joins: kvark (Mibbit@moz-F30E0473.cpe.net.cable.rogers.com)
[02:37:34] <kvark> where did approx_eq go?
[02:37:39] *** jorendorff_away is now known as jorendorff
[02:37:54] <geomyidae_> :D someone writing a http router :D
[02:39:08] <dbaupp> kvark: removed as too specialised and easily replaced
[02:39:28] <dbaupp> kvark: (x - y).abs() < 1e-6, or whatever.
[02:39:31] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[02:39:36] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[02:39:37] *** ChanServ sets mode: +ao brson brson
[02:39:41] <kvark> bjz: ^ any plans to update cgmath-rs with that in mind?
[02:39:41] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: brson)
[02:39:42] *** Quits: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP) (Ping timeout)
[02:39:46] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[02:39:46] *** ChanServ sets mode: +ao brson brson
[02:40:38] <strcat> dbaupp: we probably have (x - y).abs() as a method
[02:40:53] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[02:40:56] <strcat> even C has fdim ;p
[02:40:57] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[02:40:58] *** ChanServ sets mode: +ao brson brson
[02:42:08] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[02:43:45] <carter> so Rust has plans for record subtyping?
[02:43:49] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[02:43:54] <cmr> carter: no
[02:44:03] <cmr> pointers to structs will have subtyping.
[02:44:06] <cmr> but not the values themselves.
[02:44:07] <carter> ok
[02:44:12] <carter> that works for me
[02:44:28] <carter> i'd still consider that record subtyping for polymorphic functions :)
[02:45:28] *** kimundi is now known as zz_kimundi
[02:46:11] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:46:37] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:47:01] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[02:47:07] <carter> cmr: because rust only have have polymophic code wrt pointers/refs right?
[02:47:13] *** jorendorff is now known as jorendorff_away
[02:48:20] <carter> i cant grammer
[02:48:47] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[02:48:47] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:50:44] *** Quits: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au) (Ping timeout)
[02:51:51] <cmr> carter: well it's the only thing it can have efficiently.
[02:52:03] <carter> cmr: well, its the only sane choice anyways
[02:52:13] <carter> anything else looks like having special magic traits
[02:52:17] <cmr> ie no matter what you're pointing at if it's inherited from X it's going to start with X, so anything expecting X will find what it's looking for.
[02:52:23] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:52:36] <carter> that does mean theres no diamon problem right?
[02:52:58] <carter> or is there "smash the two prefixes together"
[02:53:00] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[02:53:06] <carter> *diamond
[02:53:39] <carter> i don't care about normal OO anyways
[02:53:46] <carter> field subtyping is neat though
[02:53:56] *** Joins: negativezero (negativeze@moz-5AC92666.public.wayport.net)
[02:53:57] <carter> sounds like a sane, conservative thing
[02:53:58] <cmr> I don't know any details, don't have enough cycles to dedicate to it.
[02:54:05] <carter> ok
[02:54:08] <carter> i know zero
[02:54:09] <carter> :)
[02:54:11] <carter> now I know >0
[02:54:18] <carter> well, more than zero
[02:54:21] <carter> >>0
[02:54:25] <carter> looks like a hair do
[02:54:52] *** Joins: mib_d6ps8n (Mibbit@moz-B76B2A57.lightspeed.cicril.sbcglobal.net)
[02:55:19] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[02:55:41] <Tobba> is there any hack to do a static loop
[02:55:45] <ercxx> How do I make a c_schar from a str or a CString?
[02:55:49] <Tobba> or should I just use a macro
[02:55:58] <ercxx> or from a c_char
[02:56:02] <carter> Tobba: what do you mean by static loop?
[02:56:05] <carter> like a constant loop?
[02:56:09] <Tobba> yeah
[02:56:11] <carter> for 1 .. 7 do blah
[02:56:13] <carter> just write it that way
[02:56:17] <carter> llvm is decent at those
[02:56:22] <carter> and will unroll if it things its a good idea
[02:56:30] <carter> otoh, you could probably do a macro hack
[02:56:38] <Tobba> I need it to abuse generic externs
[02:56:39] <carter> but you may need to encode the number peano style 
[02:56:43] <Tobba> theres 32 exception handlers
[02:56:46] <carter> generic externs?
[02:56:53] <Tobba> well
[02:56:58] <Tobba> you can do
[02:57:04] <Tobba> extern fn foo()
[02:57:06] <carter> ok
[02:57:10] <Tobba> which makes it uncallable from rust, but you can get a pointer to it
[02:57:23] *** Joins: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP)
[02:58:13] <carter> umm, wait, is this ffi
[02:58:19] <Tobba> nope
[02:58:21] <carter> or making foo callable from other people?
[02:58:37] <Tobba> assigning it as an ISR
[02:58:42] <Tobba> ISR handler*
[02:58:48] <carter> ISR?
[02:58:53] <Tobba> interrupt service request
[02:59:15] <carter> ok
[02:59:25] *** Quits: jadbaires (jadrian@moz-9AE9F7C5.dsl.telepac.pt) (Quit: Konversation terminated!)
[02:59:27] <Tobba> interrupt service routine even
[02:59:29] <carter> is the code online somewhere?
[02:59:32] *** Joins: jadbaires (jadrian@7C3E5A47.7DF3BC65.6119BA41.IP)
[02:59:34] <Tobba> not atm
[02:59:35] <Tobba> I think I
[02:59:38] *** Quits: jadbaires (jadrian@7C3E5A47.7DF3BC65.6119BA41.IP) (Quit: Konversation terminated!)
[02:59:39] <Tobba> I've got this though, I think
[02:59:47] <carter> ok
[03:02:08] <Tobba> writing a kernel but 100% avoiding using C is the goal
[03:02:41] <strcat> http://www.menuetos.net/ ;p
[03:02:52] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[03:02:55] <Tobba> well, 100% rust + some asm glue
[03:05:59] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[03:08:04] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[03:08:09] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:08:12] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: 랜덤은 쇠퇴했습니다.)
[03:08:25] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[03:08:28] <dbaupp> carter: re struct inheritance, have you seen the proposal: http://smallcultfollowing.com/babysteps/blog/2013/10/24/single-inheritance/
[03:08:35] <carter> nope
[03:08:38] <carter> thanke
[03:08:41] <cmr> oh I thought that's what you refering too!
[03:08:43] <cmr> my bad
[03:09:27] <dbaupp> steveklabnik: nice slides
[03:09:32] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[03:09:45] <cmr> dbaupp: link?
[03:09:47] <Tobba> oh yeah, that presentation
[03:09:51] <Tobba> what happened to that, I need a lin
[03:09:53] <Tobba> k
[03:10:14] <dbaupp> http://steveklabnik.github.io/nobody_knows_rust/
[03:10:22] <cmr> thanks
[03:10:33] <Tobba> this thing is fancy, what is this
[03:10:56] <cmr> reveal.js
[03:11:13] <carter> cmr:  i've not heard of that blog post
[03:12:15] *** Joins: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net)
[03:12:16] <cmr> steveklabnik: your references slide is wrong! needs to be *mut
[03:12:21] <cmr> (http://steveklabnik.github.io/nobody_knows_rust/#/2/5)
[03:12:27] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[03:12:45] <cmr> also the do spawn isn't very suggary :(
[03:13:15] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:13:16] *** ChanServ sets mode: +ao dherman dherman
[03:13:18] <dbaupp> cmr: er, what?
[03:13:25] <dbaupp> cmr: there's no mutation there...
[03:13:37] <cmr> oh it's not *x = 1
[03:13:38] <cmr> sorry
[03:13:42] * cmr sits on his hands
[03:15:11] <dbaupp> steveklabnik: (FWIW, I would recommend using (and encouraging the use of) `println!("{}", ...)` rather than `println(....to_str())` though, since the former doesn't compulsorily allocate, while the latter does; although this may be less nice to explain in a quick intro.)
[03:16:22] *** Joins: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net)
[03:17:58] <`achin> holy crap this boxflippything is hot
[03:18:05] <carter> `achin: ?
[03:18:13] <`achin> dbaupp's thingy
[03:18:18] <Tobba> carter: http://steveklabnik.github.io/nobody_knows_rust/
[03:19:10] <dbaupp> `achin: (not actually mine... I'm just the messenger :) )
[03:19:32] <`achin> yes, but we like to praise the messenger at least as often as we shoot him
[03:19:55] <cmr> hahah
[03:19:59] <carter> what box flipping?
[03:20:04] <cmr> carter: in the slides
[03:20:10] <carter> ohhh
[03:20:13] <carter> i thought you meant pointers
[03:20:27] <Tobba> hahahah
[03:20:29] <carter> i think pandoc has support for this style slide
[03:20:31] *** Joins: aravindavk (aravinda@62ECDAD0.9EE11D7D.D2D1FAF0.IP)
[03:20:39] *** Quits: jeffdb (jeffbelg@moz-ABCAA64B.efi.com) (Quit: Leaving.)
[03:20:42] <carter> i was furiously reskmiing to see if i missed flipp tables
[03:20:46] <Yurume> is there any way to modify the rust-ci.org entry?
[03:20:49] <dbaupp>  (╯°□°）╯︵ ~@RcGc
[03:20:56] <carter> jah
[03:20:59] *** Quits: willingc_ (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[03:21:01] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[03:21:04] <cmr> Yurume: I think it uses the repositroy description from github
[03:21:11] <cmr> or actually nevermind
[03:21:12] <carter> Yurume: yeah, so edit the github
[03:21:13] <cmr> no, not afaik
[03:21:23] <dbaupp> Yurume: I'm not sure there's even a way to delete an entry from it
[03:21:25] <cmr> I forgot what rust-ci looked like for a sec :P
[03:21:28] <cmr> we need a rustage
[03:21:33] <cmr> (ie, a straight fork of hackage)
[03:21:41] <Yurume> rustage <3
[03:21:51] *** Joins: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP)
[03:22:03] <carter> cmr: hackage server is open source but a bit quirky
[03:22:06] <carter> who'd be hosting it?
[03:22:11] <cmr> probably mozilla
[03:22:21] <carter> granted, hacakge2 only *JUST* went live this fall
[03:22:30] <carter> and wasn't a very visbie project before
[03:22:41] <Yurume> anyway, I'll try Rust 0.9 and recent nightlies for Windows later this day and if it goes well I'll abandon the whole distinction between release and master for rust-encoding
[03:22:49] <carter> i'm building head now
[03:22:53] <carter> and damn does it take a whil
[03:23:05] <carter> cmr: i'm really opinionated about hackage2
[03:23:07] <Tobba> on something completely unrelated, does anyone have the frequency of a 14.31818MHz oscillator down to the hertz?
[03:23:11] <carter> partly because i'm famliiar with all the bugs
[03:23:15] <Tobba> I'm missing a digit
[03:23:23] <dbaupp> Tobba: google might ;)
[03:23:27] <Tobba> I tried
[03:23:28] *** Quits: zz_kimundi (kimundi@moz-9888D3CE.dip0.t-ipconnect.de) (Ping timeout)
[03:23:33] <dbaupp> oh
[03:23:38] *** Joins: evilpie (sid7877@moz-E77DEB21.irccloud.com)
[03:23:39] <Tobba> maybe some datasheets for them
[03:23:51] <cmr> Tobba: is it a divider of some other, more normal frequency maybe?
[03:23:52] *** Quits: FreeFull (freefull@moz-4A920176.as13285.net) (Ping timeout)
[03:23:56] <Tobba> nope
[03:24:04] <Tobba> it was used in television circuitry in the 80's
[03:24:18] <dbaupp> is the actual hardware guaranteed to be precise to the Hz?
[03:24:27] <Tobba> I dont know, probably is
[03:24:35] <Tobba> the thing is you have to drive the computers timing off it
[03:24:38] <Tobba> the RTC is dodgy as all hell
[03:25:08] <Tobba> well, the RTC is fine, but it doesnt give you much precision
[03:25:36] <Tobba> theres an interrupt meant to do it but its broken on a lot of motherboards because its just emulated in SMM anyways
[03:25:55] *** Quits: mib_d6ps8n (Mibbit@moz-B76B2A57.lightspeed.cicril.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:26:17] <Tobba> (good job dell!)
[03:26:32] *** Joins: zz_kimundi (kimundi@moz-1273C77B.dip0.t-ipconnect.de)
[03:26:54] *** zz_kimundi is now known as kimundi
[03:27:07] <carter> 14mhz is 14,000,000 HZ right?
[03:27:12] <Tobba> yeah
[03:27:12] <dbaupp> yes
[03:27:15] <carter> ok
[03:27:15] *** Quits: negativezero (negativeze@moz-5AC92666.public.wayport.net) (Ping timeout)
[03:27:20] <carter> somehow was getting confused
[03:27:24] <Tobba> I'm in the completely wrong channel for this anyways
[03:28:25] *** Quits: aravindavk (aravinda@62ECDAD0.9EE11D7D.D2D1FAF0.IP) (Ping timeout)
[03:28:37] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[03:29:11] <Tobba> ah right
[03:29:17] <Tobba> the freq is 1.1931816666...
[03:30:07] *** Joins: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au)
[03:30:10] <b1nd> what's happening with managed pointers?
[03:30:20] <Tobba> just gotta take the reciprocal of that and bam, 838095 picoseconds
[03:30:28] <carter> b1nd: they're not used
[03:30:44] <strcat> b1nd: @mut is gone, @ is behind a feature gate (so not really part of what is officially rust)
[03:30:55] <b1nd> oh k, so docs are being updated?
[03:30:55] <erickt> b1nd: we're replacing them with a library-implemented pointer
[03:31:01] <strcat> Rc provides reference counting, Gc will provide gc (but rust doesn't have a gc yet)
[03:31:07] <strcat> b1nd: well... no one has started updating them
[03:31:20] <strcat> unless you count the little shared ownership stub I wrote
[03:32:04] <b1nd> so there is only owned/borrowed pointers now?
[03:32:51] <Tobba> pretty much
[03:33:06] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[03:34:06] <itdaniher> convenient way to pass an arbitrary argument to rustc through rustpkg?
[03:34:29] <bstrie> strcat: re: the existence of #rust on freenode, I tried to get it removed long ago. but it's been registered by a random person and the freenode admins don't care
[03:34:35] <bstrie> so we just have to live with it
[03:34:36] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[03:34:47] <Tobba> theres a #rust on freenode?
[03:34:48] <Tobba> oh geez
[03:35:17] <bstrie> I mean, think about it. it's not like guido himself registered #python
[03:35:21] <strcat> bstrie: pfft, I know a freenode admin, I can do anything ;p
[03:35:27] <bstrie> and that is the correct number of hashes for the python channel
[03:35:37] <dbaupp> bstrie: have a bot that posts "visit #rust on i.m.o" every few minutes :P
[03:35:41] <strcat> or whatever they call themselves (sops? I forget how irc works ;p)
[03:35:49] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[03:35:51] <dbaupp> (or every time someone speaks)
[03:35:51] <bstrie> I really don't think having that channel is a big deal
[03:35:52] <strcat> ircops
[03:35:54] <strcat> whatever
[03:36:00] <bstrie> bjz and I send people here every day
[03:36:18] <bstrie> anyone lurking will see, repeatedly, that we send people here
[03:36:31] <bstrie> the few people who bother to read the topic will see the same
[03:37:28] <bstrie> I mean, really, what's the difference if the channel over there is #rust or ##rust? one way or the other someone is going to squat in there and leave an open channel
[03:38:13] <bstrie> strcat: however, if you *do* know a freenode admin, I'd love it if you could transfer the ownership of that channel to someone who is not just a random squatter :)
[03:38:37] <bstrie> I'd like to be able to, say, ever change the topic ever again
[03:38:42] <`achin> i confirm that #rust on freenode is the best #rust on freenode
[03:40:39] <ldunn> I haven't read the entire conversation, but have you tried talking to the current founder?
[03:40:53] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[03:42:17] <bstrie> ldunn: I spent months waiting for the current founder to come online. when I finally caught him and asked him to give me ops or whatever, he also gave ops to all his random friends and then vanished again
[03:42:42] <bstrie> and I'm bad at irc so I don't even know how to exercise my ops priveliges, or whatever it is that I have
[03:42:52] <bstrie> I don't even know how to tell what I have
[03:43:13] <strcat> bstrie: he probably didn't really give you op on chanserv
[03:43:21] <ldunn> I see a few rust-related people in the access list there now (including you), /msg chanserv access #rust list has more info
[03:43:26] <bstrie> I had enough power to change the topic
[03:43:27] <`achin> @ is the traditional sigal for chanops.  which i hearby rename to chanboxes
[03:43:28] <bstrie> that's all I know
[03:43:28] <ldunn> afaict he did, actually
[03:43:30] *** Joins: pnathan (Adium@moz-A8921E45.tukw.qwest.net)
[03:43:32] <strcat> oh nvm then
[03:43:41] <strcat> bstrie: are you identified?
[03:43:41] <bstrie> how do I enable mod powers then
[03:43:47] <bstrie> I am
[03:44:02] <bstrie> if I wasn't then #python would autokick me
[03:44:05] <ldunn> /msg chanserv op #rust should do it
[03:44:06] <Luqman> speaking of #rust, it can get confusing when your in 3 different #rust'x xD
[03:44:29] <bstrie> oh cool that worked
[03:44:31] <bstrie> ldunn: thanks
[03:44:33] <ldunn> np
[03:46:55] <kvark> a rather base question: supposing I got my own ApproxEq, is there a way to have it implemented automatically for everything that implements Float?
[03:47:10] <geomyidae> steveklabnik: if I might be so nosy, do you write much rust yourself? It's interesting to me that you seem to write docs for it but don't have any rust repos. or do you contribute to the language? just curious.
[03:47:20] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[03:48:40] *** Joins: Afuna (sid21127@moz-31ABA2C0.irccloud.com)
[03:49:01] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[03:49:03] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[03:49:57] <santiago> Are green threads still made with a segmented/growing stack? I thought it was decided to do away with that. 
[03:50:16] <strcat> santiago: nope, they aren't
[03:50:24] <strcat> when the new runtime was implemented, segmented stacks weren't implemented
[03:50:32] <strcat> and then later, it was decided to not reimplement them
[03:50:39] <santiago> OK, thanks. 
[03:52:17] <acrichto> kvark: impl<T: Float> MyApproxEq for T 
[03:52:45] <kvark> somehow I thought it's not going to work
[03:53:25] <kvark> because then we may have impl<T:Float2> MyApproxEq for T, and then there can be a type satisfying both Float and Float2 (for example), which causes a conflict
[03:53:38] <dbaupp> kvark: doing that will disallow any other impls
[03:53:42] <`achin> that won't be automatic, though -- right? you still have to provide a body for all the functions MyApproxEq requires
[03:53:59] <kvark> I'll try that
[03:54:13] <cmr> kvark: impl <T: Float> ..., denies all other implementations of MyApproxEq atm
[03:54:28] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[03:55:51] <geomyidae> are port/chans used for simple signaling like cleaning up and/or stopping tasks?
[03:55:57] <kvark> cmr: that is definitely not something I'd like to get
[03:56:28] <geomyidae> Ooh, I could wrap my chan/port contents with something that is an enum ( Thing, StopSignal ) maybe
[03:57:01] <cmr> kvark: no way to work around it atm :( a hacky way is to use a macro that impls MyApproxEq and invoke it for each type you want that impls Float
[03:57:02] <kvark> what is the point then? we had ApproxEq, which was implemented for Float, and which we could implement for anything else. Now if we make MyApproxEq, we have to chose either to have it for Float or to something else. Am I missing something here?
[03:57:15] <cmr> it's a bug.
[03:57:19] <kvark> cmr: that's what I did initially, was hoping for a better way
[03:57:21] <kvark> uh ok
[03:57:25] <kvark> good to know it's a bug
[03:57:43] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[03:58:22] <dbaupp> kvark: fwiw, iirc, ApproxEq was manually implemented for f32 and f64, not just for all Float's
[03:58:50] <kvark> ah, so we definitely lost nothing then by removing it
[03:58:55] <kvark> okie, thanks
[03:58:59] *** Quits: kzzch (kzzch@moz-BB97B490.washdc.fios.verizon.net) (Quit: WeeChat 0.4.1)
[03:59:26] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:02:07] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:02:07] *** ChanServ sets mode: +ao dherman dherman
[04:02:19] <bstrie> steveklabnik: ping
[04:03:00] *** Quits: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net) (Quit: Leaving.)
[04:03:51] <bstrie> steveklabnik: in http://steveklabnik.github.io/nobody_knows_rust/#/2/7 , you have `do spawn || {` rather than `do spawn {`
[04:07:02] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[04:07:09] <bstrie> steveklabnik: in http://steveklabnik.github.io/nobody_knows_rust/#/2/16 your highlighting is weird
[04:08:47] *** Quits: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au) (Quit: z0w0)
[04:08:50] <Tobba> I think thats the presentation library itself trying to highlight and miserably failing
[04:09:17] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[04:09:31] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[04:11:19] *** Joins: Kjelle (karl@moz-58495553.static.spa.siw.siwnet.net)
[04:11:30] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[04:11:43] *** Quits: Kjelle (karl@moz-58495553.static.spa.siw.siwnet.net) (Quit: )
[04:13:00] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:15:39] *** jorendorff_away is now known as jorendorff
[04:16:35] *** Joins: negativezero (negativeze@moz-AF1C6D8D.nyc.res.rr.com)
[04:17:22] *** Quits: eatkinson (eatkinson@moz-C52156BC.dsl.bell.ca) (Quit: eatkinson)
[04:17:38] *** Quits: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (Ping timeout)
[04:18:09] <kvark> can I get a bit more help on ApproxEq? https://gist.github.com/kvark/8346917
[04:18:46] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:18:52] <cmr> kvark: try let eps: Self = ...
[04:19:15] <kvark> but eps is not supposed to be Self
[04:19:32] <kvark> Self is not the same as T, and eps needs to be T
[04:19:38] <cmr> oh i suppose it isn't
[04:19:43] <cmr> hrm
[04:20:28] <kvark> looks like rust still has issues with static trait functions
[04:20:36] <kvark> I thought we are past that nonsense :)
[04:20:50] <cmr> I think it's not infering the Self type... try fn approx_epsilon(_hack: Option<Self>)
[04:20:57] <cmr> and approx_epsilon(None::<Self>)
[04:21:08] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[04:22:09] <kvark> that kinda worked
[04:22:39] <kvark> I wonder why I cant do: let eps = Self::approx_epsilon()
[04:22:39] <geomyidae> Is there guidance on Chan<PacketStruct> vs Chan<~PacketStruct>?
[04:22:55] <dbaupp> geomyidae: is PacketStruct large?
[04:22:59] <cmr> geomyidae: it's an optimization. apply it after measuring :)
[04:23:04] <dbaupp> geomyidae: and, are you sending a lot of messages?
[04:23:14] <geomyidae> < 65536
[04:23:19] <geomyidae> and yes
[04:23:47] <dbaupp> I was thinking large as in 50+ bytes
[04:23:52] <aatch> probably ~PacketStruct then
[04:23:52] <geomyidae> cmr: honestly, I would even take guidance on which to default to, but I'm inferring that the owner pointer is the optimization in this case?
[04:23:59] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[04:23:59] *** ChanServ sets mode: +o jdm
[04:24:00] <cmr> geomyidae: yeah it is.
[04:24:01] <dbaupp> yes
[04:24:07] <cmr> I lean toward values by default.
[04:24:21] <dbaupp> using an owned pointer means it copies one word around, using it unboxed means it has to copy the whole struct
[04:24:27] <cmr> at some point hitting the allocator becomes less expensive than copying.
[04:24:36] <dbaupp> (copy it into the internal queue, and then copy it out on the otherside)
[04:24:37] <cmr> at what point is a very nuanced question :)
[04:24:38] <geomyidae> dbaupp: is it actually copying it though?
[04:24:48] <geomyidae> oh
[04:24:49] <dbaupp> geomyidae: the bytes that the struct/pointer take up
[04:24:51] <aatch> geomyidae, when sending? yes?
[04:24:54] <aatch> yes*
[04:24:59] <dbaupp> *it is copying
[04:25:01] <aatch> (I am not asking)
[04:25:20] *** jorendorff is now known as jorendorff_away
[04:25:31] *** Quits: negativezero (negativeze@moz-AF1C6D8D.nyc.res.rr.com) (Ping timeout)
[04:25:39] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Input/output error)
[04:26:06] <kvark> cmr: can we be able to do Self::approx_epsilon in future?
[04:26:21] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[04:26:22] <cmr> kvark: unknown
[04:26:27] <cmr> A lot of people want it.
[04:26:32] <cmr> I think pcwalton plans on adding it
[04:26:39] <kvark> oh cool
[04:26:51] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[04:27:07] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[04:27:09] <kvark> was just thinking about potential candidates for my future contributions
[04:27:14] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[04:27:42] <cmr> that'd be a hard one.
[04:28:00] <kvark> ok...
[04:28:07] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[04:32:37] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[04:33:02] *** Joins: aravindavk (aravinda@62ECDAD0.9EE11D7D.D2D1FAF0.IP)
[04:33:03] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[04:34:07] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[04:34:11] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:34:33] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[04:35:48] *** Joins: peros (Mibbit@moz-1689688F.dyn.optonline.net)
[04:36:07] *** Quits: peros (Mibbit@moz-1689688F.dyn.optonline.net) (Quit: http://www.mibbit.com ajax IRC Client)
[04:36:14] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[04:36:38] <Tobba> does rust currently do overflow checks?
[04:36:41] <cmr> Tobba: yes.
[04:36:47] <Tobba> I have some code that relies on integer overflow behaviour
[04:37:00] <cmr> oh not integer overflow
[04:37:02] <cmr> stack overflow
[04:37:08] <Tobba> ah
[04:37:26] <bjz> there is checked_add etc
[04:37:35] <Tobba> yeah I needed unchecked
[04:37:35] <itdaniher> for doing rustc dev work, how can I convince make to build stage whatever, rather than going through 0..2?
[04:37:40] <bjz> and saturating math
[04:37:42] <cmr> unchecked is the default.
[04:37:46] <cmr> itdaniher: make stageN-rustc
[04:37:49] <bjz> look in std::num
[04:37:54] <itdaniher> thanks cmr!
[04:38:06] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Connection reset by peer)
[04:38:18] <Tobba> did some nice stuff with how it handles time
[04:38:23] <ercxx> is there a magic way of creating a rust vector from a pointer to the first element of a C array?
[04:38:30] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:38:38] <aatch> ercxx, yes, in vec::raw
[04:38:44] <cmr> ercxx: slice_from_buf iirc
[04:38:48] <ercxx> aatch: thank you
[04:40:56] <Tobba> how does func() and proc() work right now?
[04:41:04] <cmr> func() isn't a thing
[04:41:44] <Tobba> wait shit
[04:42:31] <Tobba> proc() though
[04:42:46] <cmr> its environment is heap-allocated, and you can move into its environment.
[04:42:46] <Yurume> did you mean fn()?
[04:42:49] <cmr> it can only be called once.
[04:42:52] <cmr> fn() is just a function pointer
[04:43:06] <Tobba> yeah I'm gonna need fn() for this
[04:43:20] <cmr> fn() is shorthand for extern "Rust" fn()
[04:43:30] <Tobba> is there any way to declare a function like a closure
[04:43:34] <Yurume> ||
[04:43:36] <Tobba> so I can inline this
[04:43:37] <Tobba> right
[04:43:47] <Yurume> let x: |uint| -> uint = |x| x+1;
[04:43:49] <Yurume> etc.
[04:44:06] <Yurume> (that's originally &fn(uint) -> uint, if you know 0.8)
[04:45:01] <Tobba> if I use || i get "expected extern fn but found fn"
[04:45:08] <cmr> || isn't a function type
[04:45:11] <cmr> well
[04:45:17] <cmr> it can't be used in place of fn()
[04:45:22] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:45:22] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[04:45:24] <cmr> You should probably *take* a || rather than a fn()
[04:45:31] <Yurume> Tobba: || is like &-ptr, so it should be used with lifetimes in general
[04:45:33] <Yurume> yeah
[04:45:35] <Tobba> || needs heap alloc though doesnt it
[04:45:37] <Yurume> fn() coerces to ||
[04:45:38] <cmr> no
[04:45:40] <cmr> proc() does
[04:45:40] <Tobba> oh
[04:45:42] <cmr> || is a stack closure
[04:45:59] <Tobba> yep that worked
[04:46:08] <Tobba> now to see if transmuting this into a pointer will break everything
[04:46:32] <cmr> Tobba: how is the porting effort going so far? finding rust pleasant?
[04:46:40] <Tobba> yeah this is pleasant
[04:46:51] <cmr> awesome :)
[04:46:53] <Tobba> the unsafe blocks for globals get a bit silly but since everything is an expression its fine
[04:46:58] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:47:05] <Tobba> plus if something goes wrong its easy to pin it at something
[04:47:07] <cmr> is that the only roadbump so far?
[04:47:09] <Tobba> Ctrl+F unsafe
[04:47:16] <Tobba> I wouldent call that a roadbump even
[04:47:25] <Tobba> its good behaviour since they *are* unsafe
[04:47:38] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:47:39] <Yurume> so let me summarize: || is a stack closure and it has both a function pointer and its (lifetime-limited) env, fn() is short for extern "Rust" fn() and since it only has a function pointer it can be coerced into ||, proc() is a heap-allocated call-once function and it has both a function pointer and an owned env (which can be borrowed as || as well).
[04:47:57] *** Joins: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP)
[04:48:01] <Tobba> ah
[04:48:02] <cmr> Yurume: proc() can't be borrowed as ||
[04:48:02] <Yurume> in most cases the function arguments should use ||
[04:48:04] <Tobba> I need fn() then
[04:48:05] <cmr> it's unsafe to call it twice.
[04:48:08] <Yurume> cmr: wait, sorry
[04:48:10] <Yurume> yeah
[04:48:26] <Tobba> I was just hoping to be able to inline the function, oh well
[04:48:27] <Yurume> cmr: I think it was the case for old ~fn(), right?
[04:48:32] <cmr> Yurume: yeah
[04:48:34] <Yurume> (non-once ~fn())
[04:48:56] <Yurume> Tobba: so || should be what you use in most cases, proc() is there for spawn and some other cases
[04:49:07] <Tobba> yeah
[04:49:17] <Tobba> in this case passing an IRQ handler
[04:49:21] <cmr> yeah you want fn()
[04:49:22] <Tobba> which can be called basicaly anytime
[04:49:23] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[04:49:31] <cmr> I think we should support fn() { ... }
[04:49:40] <Yurume> you cannot have an env, so it should be fn()
[04:49:50] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[04:50:00] <cmr> ie anonymous fn as expression
[04:50:06] <Tobba> cmr: but yep, the experience has been really smooth actually, oh yeah, that mutable [] constant thing
[04:50:26] <Tobba> which is a bug anyways
[04:51:22] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[04:52:34] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:53:04] *** Quits: Reisen (m@moz-A0F67AD4.org) (Ping timeout)
[04:53:24] *** Quits: qlkzy (qlkzy@moz-A97B5CE9.members.linode.com) (Ping timeout)
[04:53:33] *** Quits: robertknight (robertknig@moz-DF72422D.members.linode.com) (Ping timeout)
[04:53:33] *** Quits: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (Ping timeout)
[04:53:41] *** Quits: Zuchto (chat@moz-1FF744E2.members.linode.com) (Ping timeout)
[04:53:54] *** Quits: XgF (quassel@moz-86690AAD.london1.uk.e43.eu) (Ping timeout)
[04:53:54] *** Quits: whitequark (whitequark@moz-BC42D267.whitequark.org) (Ping timeout)
[04:53:54] *** Quits: mgax (mgax@moz-B9399889.grep.ro) (Ping timeout)
[04:53:55] *** Joins: XgF (quassel@moz-86690AAD.london1.uk.e43.eu)
[04:54:49] *** Joins: Reisen (m@moz-A0F67AD4.org)
[04:54:52] *** Joins: qlkzy (qlkzy@moz-A97B5CE9.members.linode.com)
[04:55:12] <Tobba> what I love is that I've actually only had everything crash once, and that was me setting the CPUs task registers up wrong
[04:55:44] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Client exited)
[04:56:37] *** Joins: whitequark (whitequark@moz-BC42D267.whitequark.org)
[04:57:13] <kvark> rusti: struct A<T>(T); let A(t) = A(1.0);
[04:57:14] <b1nd> cmr: where is the file in repo that generates the main.js files?
[04:57:54] <b1nd> doc/std/main.js etc etc
[04:58:09] *** Joins: robertknight (robertknig@moz-DF72422D.members.linode.com)
[04:58:25] <cmr> b1nd: https://github.com/mozilla/rust/blob/master/src/librustdoc/html/static/main.js
[04:58:33] <b1nd> thanks
[04:58:40] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[04:58:55] <kvark> I'm failing to decompose a single-field struct that has a generic parameter
[04:59:04] <kvark> something like that: struct A<T>(T); let A(t) = A(1.0);
[04:59:09] *** Quits: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP) (Client exited)
[04:59:20] <cmr> hm
[04:59:33] *** Joins: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP)
[04:59:34] <kvark> error: mismatched types: expected `cgmath::transform::Transform3D<f64>` but found `cgmath::transform::Transform3D<BUG[0u]>` (expected f64 but found type parameter)
[04:59:45] <cmr> hahah
[04:59:49] <kvark> BUG[0u]
[04:59:51] <cmr> I haven't seen that in a while
[05:00:07] <bjz> haha
[05:00:09] <bjz> wut
[05:00:29] <kvark> bjz: I'm trying to get cgmath working again
[05:00:56] <bjz> oh neat, I was going to do that this afternoon, but you're welcome to
[05:01:06] <kvark> all done except for this one transform test, where it requires decomposition of Transform3D, and that fails
[05:01:14] <cmr> kvark: does let A(t: f64) = A(1.0);
[05:01:16] <cmr> work?
[05:01:19] <bjz> oh nice
[05:01:20] <cmr> or maybe A(1.0f64)
[05:01:22] *** Quits: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP) (Ping timeout)
[05:02:06] *** Quits: Kxepal (Miranda@moz-81616591.pppoe.mtu-net.ru) (Quit: Kxepal)
[05:02:18] <kvark>  error: expected `,` but found `:`
[05:02:23] *** Joins: Kxepal (Miranda@moz-81616591.pppoe.mtu-net.ru)
[05:02:23] <cmr> feh
[05:02:28] <kvark> doesn't allow me to set the type
[05:02:48] <kvark> and 1.0f64 is really not an option in our actual case...
[05:03:10] <cmr> might just need to add an .unwrap() method or something
[05:03:16] <kvark> yeah
[05:03:21] <kvark> would be useful
[05:03:29] <kvark> wait, I can add it myself
[05:05:46] <kvark> ok, that worked surprisingly
[05:05:48] <kvark> thanks cmr!
[05:06:02] *** Joins: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP)
[05:06:16] *** Joins: tristramh (tris@moz-6683D731.lns20.syd6.internode.on.net)
[05:06:39] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[05:08:05] <b1nd> cmr: made a temporary fix for searching paths, will be working on this issue more to completely refactor for fixing path searching
[05:08:08] <kvark> bjz: https://github.com/bjz/cgmath-rs/pull/21
[05:08:23] <kvark> off too sleep, will see your feedback tomorrow
[05:13:21] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:13:42] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[05:13:54] *** Quits: gwty (gwtypc@D1719613.914FDA14.F44414AF.IP) (Ping timeout)
[05:14:02] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[05:14:21] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[05:17:40] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:21:53] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[05:22:13] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[05:24:11] *** Quits: lenstr (lenstr@49CCCAE.9636F313.7A27613B.IP) (Quit: Leaving...)
[05:24:45] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:26:29] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[05:26:38] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:28:35] <ecl3ctic> how does one give a type an alias?
[05:28:43] <cmr> type Foo<T> = Bar<T>
[05:28:45] *** Quits: sindork_ (sindork@ABFA98AB.DD47BB48.F7A44A1B.IP) (Client exited)
[05:28:51] <ecl3ctic> I tried "type PackIntPtr = *u32"
[05:29:02] <ecl3ctic> but I get unresolved name errors
[05:29:05] <cmr> note that you still need to use Foo::methods(), the type alias isn't "complete"
[05:29:49] <cmr> ecl3ctic: example?
[05:30:18] <ecl3ctic> one sec
[05:31:33] <ecl3ctic> I may just be putting type names in wrong places, I'll have the answer to that in a sec
[05:32:28] <ecl3ctic> okay, yep, it was just a misunderstanding of Rust's syntax where I actually used the alias
[05:32:31] <ecl3ctic> the alias is fine :)
[05:33:25] <ecl3ctic> thanks
[05:33:34] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Quit: Leaving.)
[05:35:05] *** Quits: abacus (snoonan_mo@moz-F95B9243.hsd1.wa.comcast.net) (Ping timeout)
[05:35:26] *** Joins: [a]bacus (snoonan_mo@moz-F95B9243.hsd1.wa.comcast.net)
[05:35:56] *** [a]bacus is now known as abacus
[05:36:47] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:38:32] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[05:42:58] <ecl3ctic> is there any way to reserve n elements of space in an indefinite-sized vector?
[05:43:11] <cmr> vec::with_capacity(n)
[05:43:15] <cmr> or, v.reserve(n)
[05:43:31] <ecl3ctic> awesome, thanks
[05:43:43] <ecl3ctic> where do I look to find all the documentation on vectors?
[05:43:52] <ecl3ctic> because they're half built-in to the language
[05:43:57] <ecl3ctic> so it's not all in std is it?
[05:44:06] <cmr> none of them are built-in
[05:44:08] <cmr> http://static.rust-lang.org/doc/0.9/std/vec/index.html
[05:44:11] <cmr> the traits there
[05:44:18] <cmr> erm that's supposed to be a master link..
[05:44:30] <cmr> close enough
[05:44:43] <ecl3ctic> I'll fix it :)
[05:44:49] <ecl3ctic> thanks for the help
[05:44:57] <cmr> np
[05:45:06] *** Joins: nebopolis (Mibbit@moz-D2A4BDA1.static.ftbg.wi.charter.com)
[05:45:07] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[05:45:15] *** Joins: bitemyapp (callen@95EE74F7.F6EF2525.EE6E63A5.IP)
[05:45:35] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:45:35] *** ChanServ sets mode: +ao dherman dherman
[05:45:40] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[05:46:26] *** Joins: prooftechnique (prooftechn@moz-1C9C6B71.hsd1.vt.comcast.net)
[05:47:09] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[05:47:31] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:47:57] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:49:39] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[05:50:11] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:50:13] <Tobba> heh
[05:50:14] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[05:50:14] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[05:50:15] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[05:50:19] <Tobba> it warns me that my fail_ lang_item is never used
[05:50:59] *** Quits: xitology (xi@85437D54.5AFA3E4.CEDFC552.IP) (Ping timeout)
[05:51:12] <eddyb> IIRC, fail_ is for division by zero
[05:51:22] *** Joins: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au)
[05:52:02] <Tobba> modulo by zero too
[05:52:15] <Tobba> it never actually gets used but if I use any modulo or division it says I need it
[05:52:20] <Tobba> (even on modulo with a constant)
[05:52:27] <Tobba> that should probably be fixed actually
[05:52:43] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[05:54:32] <eddyb> Tobba: so dead code knows better than whatever requires the lang item?
[05:54:35] *** Quits: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP) (Client exited)
[05:54:41] <Tobba> nah
[05:54:50] <Tobba> modulo or division by constants require the fail_ lang item
[05:54:53] <dbaupp> eddyb: dead code just doesn't look at lang items
[05:55:09] <Tobba> I'm actually getting dead code on a lang item
[05:55:13] <Tobba> I should get the latest master though
[05:55:23] <dbaupp> eddyb: (i.e. it should consider lang items to be used always)
[05:56:23] <muricula> I have a compile error:  error: borrowed value does not live long enough
[05:56:29] <muricula> What does this mean/
[05:56:30] <muricula> ?
[05:57:05] <eddyb> muricula: the error message knows more than us ;). could you gist it and the relevant portion of code?
[05:57:28] <eddyb> (it generally means that you took a borrowed reference to something and the reference outlives the value)
[05:57:49] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:58:04] <muricula> http://pastebin.osuosl.org/5011/
[05:58:36] <muricula> lines 32
[05:58:38] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[05:59:22] <eddyb> muricula: &false is only valid in that statement. you're creating a temporary bool with the value false and taking a reference to it
[05:59:27] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[05:59:56] <eddyb> muricula: wait, are you trying to assign to the slice?
[06:00:01] <muricula> yes
[06:00:21] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[06:00:25] <eddyb> for y in slice.mut_iter() {yval += 1; if value % yval == 0 {*y = false;}}
[06:00:26] *** Joins: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP)
[06:01:07] <eddyb> muricula: you need to assign false to the location that y points to, instead of replacing y with a reference to a temporary containing false :P
[06:01:11] *** Joins: benjamin__ (benjamin@moz-2D6D1ED1.dip0.t-ipconnect.de)
[06:01:20] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[06:01:20] *** ChanServ sets mode: +ao dherman dherman
[06:01:24] *** Quits: tristramh (tris@moz-6683D731.lns20.syd6.internode.on.net) (Ping timeout)
[06:01:27] <muricula> I need to derefernce it I think?
[06:01:47] <sanxiyn> Yes
[06:01:55] <eddyb> see the code I wrote above (you also need mut_iter because iter gives you immutable references)
[06:01:55] <dbaupp> Tobba: I filed https://github.com/mozilla/rust/issues/11440
[06:02:16] <muricula> So while we're at it, the compiler says that in line 9 I'm using a borrowed value
[06:02:56] <muricula> errr moved valued
[06:03:25] <eddyb> muricula: both functions take ~[bool], they should take slices instead. mutable or immutable, depending on whether you mutate the values or not
[06:04:24] <muricula> I think I want to mutate tehm
[06:04:32] <eddyb> &mut [bool]
[06:05:07] <eddyb> instead of the mutable yval, you could have slice.mut_iter().enumerate() and add value to that. the entire function could very well be an iterator
[06:05:52] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[06:06:16] <eddyb> muricula: btw, primesieve breaks the iterator contract. you can't iterate a slice and modify it at the same time
[06:06:36] <eddyb> (that means it will throw more errors)
[06:07:01] *** Quits: sellout (Adium@moz-76D71F1A.hlrn.qwest.net) (Ping timeout)
[06:07:07] <eddyb> the outer for can be a for i in range(0, primes.len()), read primes[i] then use a mut_iter
[06:08:55] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:09:07] <Tobba> also, can there be a #[warn(unused_argument)], currently args count as variables
[06:09:23] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[06:09:34] <Tobba> specially with lang_items the warnings are annoying as I cant use all the info it gives me
[06:09:35] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[06:09:38] *** Quits: halorgium (z@moz-7A333983.spork.in) (Ping timeout)
[06:09:43] <dbaupp> just prefix the variables with a _
[06:09:48] <dbaupp> or call them _
[06:09:51] <Tobba> that works?
[06:09:56] <Tobba> neat
[06:10:02] <dbaupp> see the code in that issue^
[06:10:08] *** Joins: halorgium (z@moz-7A333983.spork.in)
[06:10:12] <dbaupp> the only warning is the dead_code one
[06:10:55] <Tobba> I think modulo and divisions with constants requiring fail_ sort of deserves an issue
[06:11:11] <Tobba> though its super minimal
[06:11:26] <muricula> eddyb: I made the changes you suggested, but line 32 is still wrong
[06:11:26] <dbaupp> file one
[06:11:38] <Tobba> yeah I'll do that later today I think
[06:12:06] <eddyb> muricula: *y = false;?
[06:12:19] <muricula> mismatched types, and cannot be dereferenced. Yes
[06:12:31] <brson> bstrie: that was awesome that you had your own release notes prepared today and put them up as a comment on every story
[06:13:09] <eddyb> muricula: new code?
[06:13:17] <muricula> sure
[06:13:54] <muricula> http://pastebin.osuosl.org/5016/
[06:16:18] *** Joins: tristramh (tris@moz-95F467FE.lns20.syd6.internode.on.net)
[06:17:50] <eddyb> muricula: sorry, I wasn't explicit enough: for (y, yval) in slice.mut_iter().enumerate() {if value % (value + yval) {*y = false;}}
[06:19:20] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Quit: Leaving)
[06:19:29] <Tobba> one annoying thing is that you get warnings about pointless unsafe blocks in macros
[06:19:40] <Tobba> (warning over having nested unsafe blocks)
[06:20:19] *** Quits: heftig_ (heftig@moz-728E5D04.dip0.t-ipconnect.de) (Quit: Quitting)
[06:21:15] <dbaupp> Tobba: yeah, I get annoyed by that one too
[06:21:33] <eddyb> Tobba: move the unsafety in a helper function
[06:21:56] <Tobba> it wouldent work I think
[06:21:57] <Tobba> it uses transmute
[06:22:06] <Tobba> actually yeah I can do that
[06:22:09] <Tobba> but it would be terrible
[06:22:49] <muricula> eddyb: Uhhhh... another error. Thanks for your help, I really want this to work and compile.
[06:23:02] <muricula> cannot borrow immutable vec content as mutable, line 27
[06:23:06] <eddyb> muricula: mut_slice_from instead of slice_from?
[06:23:27] <muricula> It compiles!
[06:23:28] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[06:24:07] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Input/output error)
[06:24:08] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Input/output error)
[06:25:04] *** Joins: wcrichto (will@moz-62F118F0.client.mchsi.com)
[06:27:21] *** Quits: wcrichto (will@moz-62F118F0.client.mchsi.com) (Quit: leaving)
[06:27:48] *** Joins: wcrichto (will@moz-62F118F0.client.mchsi.com)
[06:28:47] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:31:04] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[06:32:09] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[06:32:37] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Connection reset by peer)
[06:32:52] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[06:32:58] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[06:32:59] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Client exited)
[06:33:40] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[06:33:52] *** Quits: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca) (Quit: canhtak)
[06:35:24] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[06:36:43] *** Quits: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Ping timeout)
[06:37:57] *** Joins: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP)
[06:39:20] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[06:39:34] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[06:39:58] *** Quits: tristramh (tris@moz-95F467FE.lns20.syd6.internode.on.net) (Ping timeout)
[06:42:40] *** Joins: sedman (sedman@E4D2F0A.47298EC7.57E8EAD3.IP)
[06:42:50] *** Joins: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de)
[06:43:16] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[06:43:19] *** Quits: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Ping timeout)
[06:43:37] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[06:44:29] *** Quits: mib_do4frm (Mibbit@285A12BB.D6EE7B4D.99FEC5C4.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:45:12] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:48:15] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[06:48:42] *** Quits: bitcrusher (Mibbit@moz-9148CDF7.hsd1.wa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:50:00] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[06:52:16] *** Quits: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131205075310])
[06:52:18] *** Joins: Zuchto (chat@moz-1FF744E2.members.linode.com)
[06:54:17] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[06:54:36] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[06:55:13] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[06:56:55] *** Joins: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP)
[06:57:59] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[06:58:42] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:58:45] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[06:58:58] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[07:00:03] <brson> really loving all the rustdocs we're generating now
[07:01:05] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[07:01:08] *** Joins: dev14 (devarshdes@moz-4EB22C7B.san.res.rr.com)
[07:01:40] *** Joins: mib_812vy2 (Mibbit@EFD67BFC.FFC027EE.F239D495.IP)
[07:01:47] <mib_812vy2> sup
[07:01:54] <mib_812vy2> I have a few questions.
[07:01:57] *** Joins: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net)
[07:02:03] <mcpherrin> I have answers!
[07:02:12] <mcpherrin> you've come to the right place.
[07:02:12] <mib_812vy2> lulzzzzz
[07:02:19] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Client exited)
[07:02:24] *** Quits: mib_812vy2 (Mibbit@EFD67BFC.FFC027EE.F239D495.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:02:48] <muricula> eddyb: Thanks for your help, it now works
[07:03:15] *** Quits: nobody (nobody@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[07:03:32] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[07:04:48] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Ping timeout)
[07:06:20] *** Joins: hoopeekoo (Mibbit@moz-46A2DF43.elisa-laajakaista.fi)
[07:06:35] *** Quits: hoopeekoo (Mibbit@moz-46A2DF43.elisa-laajakaista.fi) (Quit: http://www.mibbit.com ajax IRC Client)
[07:21:46] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:23:22] *** Quits: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[07:24:16] *** Joins: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP)
[07:24:38] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[07:24:45] *** Joins: negativezero (negativeze@moz-AF1C6D8D.nyc.res.rr.com)
[07:26:06] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[07:26:52] *** Joins: mib_e3uzbj (Mibbit@moz-C1AEDE6D.resnet.ucsc.edu)
[07:27:11] *** Quits: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0/20140106141415])
[07:27:48] *** Quits: mib_e3uzbj (Mibbit@moz-C1AEDE6D.resnet.ucsc.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[07:29:01] *** Joins: jaen (jaen@138A5D71.4C038AE9.C4431F0E.IP)
[07:29:06] *** Quits: wcrichto (will@moz-62F118F0.client.mchsi.com) (Quit: leaving)
[07:29:49] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Ping timeout)
[07:30:01] *** Quits: pnathan (Adium@moz-A8921E45.tukw.qwest.net) (Quit: Leaving.)
[07:31:40] *** Joins: nobody (nobody@moz-7E09A266.neo.res.rr.com)
[07:31:44] *** Quits: lennart (lennart@moz-DE70D6F.stanford.edu) (Ping timeout)
[07:31:44] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[07:31:44] *** ChanServ sets mode: +ao pcwalton pcwalton
[07:32:23] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[07:33:59] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[07:35:24] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[07:35:31] *** Joins: pzol (pzol@322A273C.DEB41A6D.AADC76B.IP)
[07:35:39] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[07:35:55] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[07:37:11] *** Joins: Ms2ger (Ms2ger@D324D80C.3387515C.187A1082.IP)
[07:39:45] <pzol> would be good if rust -c would return the build number, wouldn't it?
[07:39:46] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Client exited)
[07:39:52] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[07:40:08] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[07:41:30] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:41:56] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[07:43:16] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[07:44:02] *** Quits: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:44:47] *** Joins: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP)
[07:48:31] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:49:27] *** Joins: quiggle (Mibbit@moz-1C58E518.lightspeed.sndgca.sbcglobal.net)
[07:49:38] <mcpherrin> pzol: you mean rustc -v?
[07:49:45] <pzol> mcpherrin yes!
[07:50:21] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[07:50:51] *** Quits: quiggle (Mibbit@moz-1C58E518.lightspeed.sndgca.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:51:11] <strcat> pzol: it contains the git commit id
[07:51:40] <strcat> it'd be nice if it actually used the git describe version
[07:51:48] <strcat> instead of a hardcoded number for the actual version
[07:51:50] *** flaper87|afk is now known as flaper87
[07:52:02] <strcat> but it means figuring out a way to insert it into the attributes
[07:57:28] *** Joins: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com)
[07:59:11] *** Quits: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[07:59:40] *** Joins: Puddles (Mibbit@FBB0C0CF.6E00F15C.8D85FBA3.IP)
[07:59:59] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[08:00:17] <Puddles> I just updated to rust 0.9 and I don't have the rust executable
[08:00:20] <Puddles> I have rustc
[08:00:30] <Puddles> Was the rust executable removed?
[08:02:06] *** Quits: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[08:02:14] <strcat> Puddles: yes
[08:02:17] <strcat> it's in the release notes
[08:02:30] <pzol> strcat my output just says rustc 0.9\nhost: x86_64-apple-darwin
[08:03:01] <strcat> pzol: the commit id is left out for the releases because they correspond to a tag
[08:03:07] <strcat> if we used git describe it would be automatic
[08:03:26] <strcat> 0.9 is git described as 0.9
[08:03:41] <pzol> strcat so if I get head I'll get a different one?
[08:03:42] <strcat> 22 commits since 0.9 is 0.9-22-gd28317d (where that's a commit id)
[08:03:49] *** Quits: Puddles (Mibbit@FBB0C0CF.6E00F15C.8D85FBA3.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:03:51] <pzol> strcat cool thanks :)
[08:04:03] <strcat> pzol: yes, but atm it's hardcoded to 0.10-pre with a commit id in parens instead of using git describe
[08:04:12] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[08:04:23] <pzol> strcat that's fine ;)
[08:04:24] <strcat> and it has to be manually updated so there are points at which it says 0.9 when it's not 0.9 yet, and when it says 0.9 and it's past 0.9
[08:04:30] <strcat> but it does have a commit id
[08:04:59] <strcat> Name                 Old Version  New Version         Net Change
[08:05:00] <strcat> rust                 0.9-2                           -119.61 MiB
[08:05:02] <strcat> thestinger/rust-git               0.9.22.gd28317d-1   119.26 MiB
[08:05:09] *** Quits: KindOne (KindOne@moz-8C02EB21.dynamic.ip.windstream.net) (Ping timeout)
[08:05:17] <strcat> rustc calls itself...
[08:05:34] <strcat> rustc 0.9 (d28317d 2014-01-09 14:56:19 -0800)
[08:05:36] <flaper87> Is there a way to use structs defined in C shared libraries without redefining them in rust? 
[08:05:41] <flaper87> I'm working on this: https://github.com/FlaPer87/rust-proton/blob/master/src/proton/proton.rs
[08:05:49] <flaper87> It like the first time I use Rust's FFI
[08:05:59] <marc_> How can I get to the fd of a File without using fs_open?
[08:06:04] <strcat> flaper87: no, not at this point
[08:06:11] <strcat> you can use bindgen to define them automatically
[08:06:12] <flaper87> strcat: ok, thanks
[08:06:22] <strcat> if they have different definitions per platform, you have to deal with the mess yourself
[08:06:32] <strcat> using libclang for this would be *great*.
[08:06:33] <flaper87> strcat: mmh, any example of how to do that ?
[08:06:59] <strcat> #[cfg(target_os = "...")]
[08:07:10] <strcat> or target_endian/target_word_size/target_arch
[08:07:14] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[08:07:46] <flaper87> they've the same definition for all platforms
[08:08:22] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[08:08:38] <flaper87> strcat: oh you mean this bindgen https://github.com/crabtw/rust-bindgen
[08:08:42] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[08:09:19] *** Joins: KindOne (KindOne@moz-6E4315B4.dynamic.ip.windstream.net)
[08:09:41] *** Joins: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com)
[08:10:21] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[08:10:25] *** Joins: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com)
[08:10:59] <flaper87> strcat: thanks
[08:11:12] *** Quits: dev14 (devarshdes@moz-4EB22C7B.san.res.rr.com) (Quit: dev14)
[08:11:41] *** Quits: oldmanstan (glesica@moz-CA910636.net) (Ping timeout)
[08:11:43] *** Joins: oldmanstan (glesica@moz-CA910636.net)
[08:12:07] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[08:12:39] *** Quits: dignan (dignan@37A38C73.9CE91D06.839F6EC0.IP) (Ping timeout)
[08:12:41] *** Joins: dignan (dignan@37A38C73.9CE91D06.839F6EC0.IP)
[08:12:41] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[08:14:03] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[08:14:20] *** Quits: ercxx (ercan@moz-88DD3A7E.dyn.optonline.net) (Quit: WeeChat 0.4.2)
[08:18:34] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Ping timeout)
[08:19:04] <pzol> help!! why am I getting a use of moved value: `list` here https://gist.github.com/pzol/8348507
[08:19:55] *** Joins: bheylin (brianheyli@moz-8255E94E.adsl.online.nl)
[08:19:58] *** Quits: bheylin (brianheyli@moz-8255E94E.adsl.online.nl) (Quit: bheylin)
[08:20:05] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[08:21:08] <Ms2ger> length() takes the list by value, so it consumes the value
[08:21:21] <Ms2ger> You should make it take &List<T>
[08:21:43] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[08:22:14] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[08:23:00] *** Joins: spritey (stevenle@B430424C.84237685.D74CC41D.IP)
[08:23:06] <spritey> sup peeps
[08:23:14] *** Quits: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net) (Ping timeout)
[08:24:38] *** Quits: darthdeu (darthdeus@62EE3073.3B96A244.4E88690D.IP) (Quit: Linkinus - http://linkinus.com)
[08:25:45] <pzol> Ms2ger fn length<T>(xs: &List<T>) -> uint { ??
[08:25:59] *** Joins: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net)
[08:26:14] <Ms2ger> Yep
[08:26:21] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[08:26:22] *** Joins: darthdeus (darthdeus@62EE3073.3B96A244.4E88690D.IP)
[08:29:42] <pzol> Ms2ger I changed it https://gist.github.com/pzol/8348507 but now it says error: cannot move out of dereference of & pointer :(
[08:30:30] <Ms2ger> Drop the * on that line
[08:30:52] *** Joins: vgeddes (vincent.ge@D39159A6.A061E14C.E3F3D89E.IP)
[08:31:36] <pzol> Ms2ger then I get  mismatched types: expected `&List<T>` but found an enum or structure pattern
[08:31:39] *** Quits: spritey (stevenle@B430424C.84237685.D74CC41D.IP) (Quit: leaving)
[08:32:24] * Ms2ger frowns
[08:32:55] <Ms2ger> Try match xs { &Empty => 0, &Cons(_, rest) => 1 + length(rest) }
[08:34:04] <dbaupp> match *xs { Empty => 0 , Cons(_, ref rest) => 1 + length(rest) }
[08:34:19] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[08:34:21] <dbaupp> the key point being the `ref`
[08:34:32] *** Joins: derek_c (derek@F79E2534.80543B4A.7E5576EA.IP)
[08:34:42] <Ms2ger> Ah, ref
[08:36:02] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[08:36:35] *** Quits: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP) (Client exited)
[08:36:40] *** Joins: benjamin_ (benjamin@moz-C9D9B603.dip0.t-ipconnect.de)
[08:36:49] *** Quits: benjamin__ (benjamin@moz-2D6D1ED1.dip0.t-ipconnect.de) (Ping timeout)
[08:38:02] *** Joins: mib_uytjbx (Mibbit@9B989C8B.CBEFAABC.E6A9881D.IP)
[08:38:27] <pzol> dbaupp error: mismatched types: expected `&List<<V6>>` but found `&~List<T>` (expected enum List but found ~-ptr)
[08:38:43] *** Quits: mib_uytjbx (Mibbit@9B989C8B.CBEFAABC.E6A9881D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:38:56] <pzol> dbaupp it complains about the rest in the 1 + length(rest)
[08:39:15] *** Joins: bheylin (brianheyli@837B6557.E7BADBF1.B0C2132F.IP)
[08:39:34] <Ms2ger> pzol, update your gist?
[08:39:49] <pzol> Ms2ger updated!
[08:41:30] <Ms2ger> Okay, making it length(*rest) again seems to work
[08:41:47] <pzol> Ms2ger yes it does :)
[08:41:57] <pzol> Ms2ger dbaupp  thanks :)
[08:42:00] <Ms2ger> Np :)
[08:42:27] *** Quits: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[08:43:18] *** Quits: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (Quit: Lost terminal)
[08:44:43] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[08:45:03] *** Quits: io2 (io2@moz-871549F5.home.otenet.gr) (Ping timeout)
[08:45:55] *** Quits: pyon (user@BCC41BDF.6C782DF8.1C8C8CE9.IP) (Ping timeout)
[08:46:42] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[08:47:29] *** Quits: io2 (io2@moz-871549F5.home.otenet.gr) (Quit: )
[08:48:23] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[08:48:26] *** Joins: Phoop (sid20507@moz-31ABA2C0.irccloud.com)
[08:49:03] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[08:49:22] <pzol> Ms2ger I am still confused WHY it needs a pointer to the list, and for instance fn head() doesn't?
[08:49:27] *** Joins: sk (sk@45DB4C5B.86598B04.24EDD759.IP)
[08:49:49] *** Joins: mitja (Mibbit@B14D1387.F3F635F6.3E006838.IP)
[08:50:06] <mitja> Hi, is there a way to reset an iterator?
[08:50:48] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[08:51:33] <dbaupp> mitja: not in general
[08:52:10] <dbaupp> you can .clone() some iterators; so clone it before iterating and then "reset" is just taking the clone and starting again
[08:52:23] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[08:52:54] <mitja> thanks
[08:53:43] *** Quits: mitja (Mibbit@B14D1387.F3F635F6.3E006838.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:54:39] *** Quits: prooftechnique (prooftechn@moz-1C9C6B71.hsd1.vt.comcast.net) (Quit: )
[08:54:58] *** Quits: bheylin (brianheyli@837B6557.E7BADBF1.B0C2132F.IP) (Quit: bheylin)
[08:55:29] *** Quits: nebopolis (Mibbit@moz-D2A4BDA1.static.ftbg.wi.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[08:58:56] *** Joins: dv (dv@4E84A121.6B684CF9.27E2265F.IP)
[08:59:09] *** Quits: vgeddes (vincent.ge@D39159A6.A061E14C.E3F3D89E.IP) (Ping timeout)
[09:02:18] *** Quits: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au) (Ping timeout)
[09:02:37] *** Quits: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[09:03:38] *** Joins: gd (Mibbit@moz-CFB96525.cnrs-imn.fr)
[09:04:11] *** Joins: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au)
[09:05:37] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:06:01] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[09:06:52] *** Joins: TisButMe (Mibbit@moz-5233EFA9.w92-144.abo.wanadoo.fr)
[09:06:54] <TheHydroImpulse> Anybody know if there's up-to-date LLVM bindings for Rust?
[09:07:09] *** Quits: b1nd (b1nd@moz-5A306E04.lns17.ken.bigpond.net.au) (Ping timeout)
[09:07:15] <derek_c> A typical contribution flow is: 1. pull  2. edit (and add tests)  3. rebase (if necessary)  4. make check  5. submit pull request. correct?
[09:07:33] <derek_c> and 0. find or open an issue
[09:09:42] <blaenk> "Note that returning large unboxed values via boxes is unnecessary. A large value is returned via a hidden output parameter, and the decision on where to place the return value should be left to the caller:"
[09:10:00] <blaenk> does that mean like, I return values normally, and the way that the caller specifies is how they're returned? like the example it gives is
[09:10:04] <bvssvni> where can I find more information about the bytes! macro?
[09:10:05] <blaenk> let x = ~foo();
[09:10:22] <blaenk> so that means that if foo() returned a huge value, since I did ~foo();, it's fine cause it's passed through the box?
[09:10:30] <blaenk> or not passed through the box but written directly into the box
[09:10:33] <blaenk> so it's not being copied?
[09:11:06] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[09:11:14] <dv> derek_c: shouldn't you branch?
[09:11:28] <derek_c> dv: indeed. but other than that?
[09:11:39] <derek_c> I'm asking this because make check is taking a long time
[09:11:57] <derek_c> just wondering if there is any shortcut for small changes
[09:12:42] *** Quits: gd (Mibbit@moz-CFB96525.cnrs-imn.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[09:12:57] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[09:14:06] <eddyb> blaenk: if you do let x = foo(); it's passing a pointer to an uninitialized stack region of the right size
[09:14:29] <blaenk> oh ok, so no copies there either?
[09:14:44] <eddyb> nope, that's what you quoted *actually* meant
[09:14:54] *** Quits: eholk (eholk@moz-58C5EE6F.wavecable.com) (Ping timeout)
[09:16:00] <eddyb> blaenk: there's no placing big structures on the stack either, for passing arguments by value
[09:16:27] *** Joins: mib_ieumf8 (Mibbit@1035CE69.3B77C3EE.D0FCF0C0.IP)
[09:16:29] *** Quits: mib_ieumf8 (Mibbit@1035CE69.3B77C3EE.D0FCF0C0.IP) (Quit: mib_ieumf8)
[09:17:11] <blaenk> "if you do let x = foo(); it's passing a pointer to an uninitialized stack region of the right size"
[09:17:48] <blaenk> sorry having trouble understanding that, what gets passed that pointer?
[09:19:12] *** Joins: eholk (eholk@moz-58C5EE6F.wavecable.com)
[09:19:23] <eddyb> blaenk: so if foo returns Foo, it's doing let x: Foo; /* uninitialized */; foo(&x);
[09:19:40] <Yurume> blaenk: the compiler automatically transforms `fn foo() -> BigStruct` into something like `fn foo(_ret: &mut BigStruct)` and every call to `foo` to allocate `BigStruct` in the stack.
[09:19:41] <blaenk> ohh I see
[09:19:47] <blaenk> thanks eddyb I appreciate it
[09:20:01] <blaenk> thanks too Yurume 
[09:20:20] <blaenk> eddyb: when you said "there's no placing big structures on the stack either, for passing arguments by value"
[09:20:27] <blaenk> does that mean something similar also occurs for arguments?
[09:20:48] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[09:21:11] *** Joins: evil_CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:21:23] <eddyb> blaenk: yes, large structures are also passed by reference
[09:21:30] <blaenk> that's neat :D
[09:21:45] <Ms2ger> So... What is "large"? :)
[09:21:51] <eddyb> > register
[09:22:44] <blaenk> nice
[09:23:35] <eddyb> (it's technically possible to push the entire structure on the stack, but we don't do that. I can't see how you could do that for the return value)
[09:23:59] <eddyb> much easier to use references, and LLVM optimizes them fairly well
[09:25:26] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[09:25:28] <Yurume> eddyb: technically that's also possible but needs a somewhat different ABI... 
[09:26:15] <eddyb> Yurume: build the return value on the stack and... do a dance to return?
[09:26:44] <eddyb> (the return PC would be above the return value)
[09:26:58] *** Quits: evil_CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[09:27:18] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[09:27:27] <Yurume> eddyb: or having a separate stack area between the last stack frame and arguments for return values. (it would be pretty much same as the current scheme)
[09:28:02] <Yurume> <-- arg4 arg3 arg2 arg1 arg0 ret saved_callee ...
[09:28:07] *** Joins: moostik (Icedove@moz-53E05E9C.w92-151.abo.wanadoo.fr)
[09:28:11] <eddyb> Yurume: oooh, implicit return pointer. not enough locality though
[09:28:39] <eddyb> (unless LLVM supports something like that by itself, it wouldn't be optimized well)
[09:28:50] <Yurume> yeah
[09:29:12] <Yurume> that's also why non-generic ~-ptr is not useful for many functions
[09:29:42] *** Joins: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za)
[09:31:27] *** Joins: int3_ (int3_@F90F9A7.83793537.D1416617.IP)
[09:31:50] *** Quits: eholk (eholk@moz-58C5EE6F.wavecable.com) (Ping timeout)
[09:32:36] *** Joins: eholk (eholk@moz-58C5EE6F.wavecable.com)
[09:38:48] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[09:39:34] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[09:40:26] *** Quits: eholk (eholk@moz-58C5EE6F.wavecable.com) (Ping timeout)
[09:41:19] *** Joins: eholk (eholk@moz-58C5EE6F.wavecable.com)
[09:44:52] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[09:45:22] *** Joins: alsm (asm@moz-EDA9E7AA.emea.ibm.com)
[09:49:40] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:49:55] *** Quits: aravindavk (aravinda@62ECDAD0.9EE11D7D.D2D1FAF0.IP) (Ping timeout)
[09:51:23] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[09:52:21] *** Joins: rca (rcatolino@6A636113.7FFEF089.2CE09D78.IP)
[09:54:27] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[09:58:57] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[09:59:03] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[10:00:55] *** Quits: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au) (Ping timeout)
[10:02:32] *** Quits: int3_ (int3_@F90F9A7.83793537.D1416617.IP) (Ping timeout)
[10:02:59] *** Joins: int3_ (int3_@F90F9A7.83793537.D1416617.IP)
[10:07:16] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Quit: WeeChat 0.4.2)
[10:08:33] *** Joins: andre (andre@CA528A4A.45A4338E.8EE27E6.IP)
[10:09:04] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[10:09:17] *** Joins: mouse (mouse@moz-373942D2.dhcp.yndx.net)
[10:09:35] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Ping timeout)
[10:11:52] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[10:13:03] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[10:13:13] *** Quits: StarLight (StarLight@moz-3D7D8B48.dynamic.avangarddsl.ru) (Ping timeout)
[10:13:32] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[10:15:17] <pzol> need help with match -- error: cannot move out of dereference of & pointer it gives me https://gist.github.com/pzol/8348507
[10:16:04] <kimundi> pzol: head() gfunction, right?
[10:16:22] <pzol> kimundi yes!
[10:16:22] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Connection reset by peer)
[10:16:40] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[10:16:43] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[10:17:07] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Quit: WeeChat 0.4.2)
[10:17:09] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[10:17:38] *** Joins: StarLight (StarLight@moz-F30410F.pppoe.avangarddsl.ru)
[10:17:59] <kimundi> pzol: Okay, so: Your length function currently takes a &List<T>, because returning the length does not require you modifing the list. However, for head() you _do want_ to modify the List, so taking a &List will not work
[10:18:27] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[10:18:36] <pzol> kimundi I don't want to modify the list, that's not the intention
[10:18:45] <pzol> I want to return the first value in the list
[10:19:01] <kimundi> pzol: okay, then you basically want a head() that clones the first element and returns that copy
[10:19:04] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Connection reset by peer)
[10:19:08] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[10:19:25] <eddyb> kimundi: why not return a borrowed pointer?
[10:19:34] <kimundi> Do'h, right
[10:19:37] <kimundi> that would work too
[10:19:50] <ecl3ctic> Is it intentional for the compiler to give errors when you pass a uint to a function expecting a u64 on x86-64?
[10:19:52] <eddyb> when the answer is "clone", you might as well be doing something wrong
[10:20:07] <eddyb> ecl3ctic: yes. the code is supposed to compile on ia32 as well
[10:20:27] <eddyb> ecl3ctic: transmute will work on x64 and fail on ia32
[10:20:35] <kimundi> pzol: Okay, so you have three option for writing a head(): return the head element itself, removing it from the List in the process, returning a copy of the head element, which is discouraged to do, or returning a reference to the head element
[10:20:53] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[10:20:54] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Quit: Ferreus)
[10:21:06] *** Joins: patrickkim_ (Mibbit@93E02D7B.BACDE851.97B9B372.IP)
[10:21:22] <pzol> kimundi ok, 3rd one, how do you write it in the match?
[10:21:26] <eddyb> pzol: https://gist.github.com/pzol/8348507#file-list_test-rs-L19 Some(value) here. the function will look like fn head<'a, T>(xs: &'a List<T>) -> Option<&'a T>
[10:21:29] *** Quits: patrickkim_ (Mibbit@93E02D7B.BACDE851.97B9B372.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:21:36] <kimundi> pzol: For returning a reference, change head to fn head<T, 'a>(xs: &'a List<T>) -> Option<&'a T> 
[10:21:48] <kimundi> and then remove the * in the Some
[10:22:01] <ecl3ctic> eddyb: that makes sense... but does it make sense for malloc in particular to take a u64 instead of a malloc?
[10:22:06] <ecl3ctic> eddyb: that's where my issue lies
[10:22:16] <ecl3ctic> instead of a uint*
[10:22:17] <ecl3ctic> ha
[10:22:21] <pzol> what's the difference between <'a, T> and <T, 'a> ??
[10:22:21] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[10:22:29] <eddyb> ecl3ctic: no, malloc should use uint
[10:22:54] <eddyb> pzol: I don't think there is any difference (implemented). just like <A, B> and <B, A>
[10:23:01] <kimundi> pzol: none, except that I accidentially swapped the order, and we have the rule that lifetimes names come first
[10:23:07] <pzol> kimundi ufff :)
[10:23:09] <eddyb> we do?
[10:23:21] <kimundi> eddyb: yes
[10:23:37] <eddyb> kimundi: can't wait for the PR that fixes rusti to get through :D
[10:23:48] <eddyb> it's been too loong
[10:23:49] <kimundi> yeah, me too :)
[10:23:54] <kimundi> indeed
[10:24:13] <kimundi> strcat writing rusti to begin with was a godsend
[10:24:44] <ecl3ctic> eddyb: ok so malloc wants a u64, should I file a bug for that?
[10:25:19] <eddyb> ecl3ctic: which malloc?
[10:25:34] <ecl3ctic> std::libc::funcs::c95::stdlib::malloc
[10:26:06] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[10:26:40] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[10:27:10] <eddyb> ecl3ctic: the problem is that size_t & friends are defined with #[cfg], instead of using the invariant that (u)int == (u)intptr_t
[10:27:45] <eddyb> you could file an issue for that, if one isn't already there
[10:29:24] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[10:30:04] <ecl3ctic> eddyb: I can't see one
[10:31:31] <eddyb> ecl3ctic: "Use `uint` for `uintptr_t` and similarly sized types in `std::libc`" is what I would name it
[10:32:22] <ecl3ctic> eddyb: ok, but I have no idea what that means :)
[10:32:35] <ecl3ctic> eddyb: you can file it if you want so you can word it up right
[10:32:42] <ecl3ctic> I'm not familiar with the compiler
[10:32:49] <eddyb> ecl3ctic: this is all in the library
[10:33:12] <ecl3ctic> eddyb: I'm not familiar with the compiler OR the library :P
[10:33:22] <eddyb> uintptr_t is an unsigned integer C type the size of a pointer
[10:33:25] *** Quits: int3_ (int3_@F90F9A7.83793537.D1416617.IP) (Ping timeout)
[10:33:41] <ecl3ctic> oh ok
[10:34:16] <eddyb> size_t is used to represent sizes/lengths, for most architectures (all the ones supported by rustc) it's the same as uintptr_t
[10:35:03] <pzol> couldn't it be implied that the lifetime should be the same for function like fn head<'a, T: Clone>(xs: &'a List<T>) -> Option<&'a T> {} -- I mean this is just boilerplate code 
[10:35:17] <eddyb> pzol: not really
[10:35:19] <ecl3ctic> uintptr_t seems to be defined as uint already, but size_t is defined as u64 according to the docs
[10:35:34] *** Quits: abacus (snoonan_mo@moz-F95B9243.hsd1.wa.comcast.net) (Ping timeout)
[10:35:35] <eddyb> ecl3ctic: oh, right, that's interesting. I was just looking at that
[10:35:39] <kimundi> pzol: Not in the general case - and why are using clone now? :P
[10:35:43] <ecl3ctic> is the issue just the definition of size_t then?
[10:35:57] <eddyb> std::libc does #[cfg(target_arch = "x86_64")] type size_t = u64;
[10:36:10] <pzol> kimundi removed it already -> fn head<'a, T>(xs: &'a List<T>) -> Option<&'a T> {
[10:36:26] <kimundi> pzol: Lifetimes can be implied in one case: if you only consume them and not return them - and there we allow it
[10:36:51] <eddyb> ecl3ctic: there's two or three types similar to size_t, they should all be fixed. I thought uintptr_t had the same problem, my bad
[10:36:51] <pzol> so why can't it be implied in this case => fn head<'a, T>(xs: &'a List<T>) -> Option<&'a T> {} ??
[10:37:11] <kimundi> pzol: however, if you want to return a reference, then you need to tell the compiler what lifetime it is supposed to have
[10:37:14] <eddyb> pzol: because it could be wrong
[10:37:21] <ecl3ctic> eddyb: well if size_t is for sizes then doesn't it make sense for it to be the full word size?
[10:37:31] <kimundi> pzol: The function could also return a &'static T if it wanted
[10:37:33] <ecl3ctic> eddyb: shouldn't malloc take a uintptr_t instead?
[10:37:56] <eddyb> ecl3ctic: no. the reason size_t can be uint is that it's the same size as uint for all supported architectures
[10:38:13] <eddyb> size_t should be fixed, malloc is just a victim
[10:38:58] <eddyb> pzol: you could have a borrowed pointer inside List and return that
[10:39:02] <pzol> eddyb kimundi ok...  somebody should maybe write a more extensive turorial on pointers and lifetime... this 
[10:39:13] <kimundi> pzol: Basically, we require to _name_ lifetimes in such situations to tell the compiler which lifetime is _linked_ to which other lifetime - there is no other way except whole-crate function signature inference to figure that out
[10:39:35] *** Joins: int3_ (int3_@F90F9A7.83793537.D1416617.IP)
[10:39:48] <eddyb> actually, with the rvalue lifetimes (and maybe generic auto-borrow), it should be easier to construct recursive data structures on the stack :D
[10:40:45] *** Joins: gwty (gwtypc@B8F3004.2F30E97E.27560D6E.IP)
[10:40:55] <kimundi> Consider fn foo<'a>(&'a A, &'a B) -> &'a C vs fn foo<'a, 'b>(&'a A, &'b B) -> &'b C vs fn foo<'a, 'b>(&'a A, &'b B) -> &'static C
[10:40:55] <eddyb> (but the definitions for operator overloads still don't allow for sugar with such DAGs)
[10:41:17] <kimundi> without lifetime names, they are all the same, with them, they are all different
[10:42:58] *** Joins: [a]bacus (snoonan_mo@moz-F95B9243.hsd1.wa.comcast.net)
[10:43:20] *** [a]bacus is now known as abacus
[10:44:09] <pzol> yeah... but most cases will be much simpler
[10:45:01] <kimundi> all simple cases where you don't return a reference don't require you to name lifetimes
[10:45:52] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[10:47:09] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[10:47:34] <kimundi> The alternative is to have a bunch of special cases and defaults - we used to have that, and it made lifetimes way more magic and incomprehensible than they are, because you never knew whan to add them and when not
[10:47:50] *** Quits: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za) (Ping timeout)
[10:48:24] <kimundi> Now we basically tread them like generic type parameters: If you need them, you need to explicitly define and use them
[10:49:14] <kimundi> fn foo<'a A>(&'a A)
[10:49:28] <kimundi> err, fn foo<'a, A>(&'a A)
[10:49:37] *** Joins: mib_t1qb5d (Mibbit@6AD345E5.19847752.2F9DE622.IP)
[10:49:50] *** Joins: gd (Mibbit@moz-CFB96525.cnrs-imn.fr)
[10:50:00] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[10:50:16] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[10:50:19] <ecl3ctic> eddyb: ok, so before I post the issue, is it just size_t or types like ssize_t, http://static.rust-lang.org/doc/master/std/libc/types/os/arch/posix88/typedef.ssize_t.html, and blksize_t as well
[10:50:22] <gd> Hi everybody. Is there a way NOT to link to libc with rustc?
[10:50:30] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[10:50:57] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[10:51:20] <eddyb> gd: what for?
[10:51:29] <eddyb> ecl3ctic: blksize_t looks too weird, just size_t and ssize_t, I guess
[10:51:44] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[10:52:10] <Ms2ger> bikeshed_t?
[10:55:06] *** Quits: spacetime (quassel@moz-CAB487E6.rishab.in) (Ping timeout)
[10:55:09] *** Joins: spacetime (quassel@moz-CAB487E6.rishab.in)
[10:55:17] *** Joins: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de)
[10:55:26] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[10:56:07] <gd> eddyb : I've created some small tools to use on a remote and not up to date server (internal one, no access to the internet). I have nothing to compile stuff on it except intel compilers. I don't want to create these tools in C. I've tried out Go which can create full static binaries that are working very well. I'd like to do the same with Rust if possible.
[10:56:21] <gd> * remote server
[10:56:50] <eddyb> gd: what operating system?
[10:56:53] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[10:57:06] <gd> cent os... an old one
[10:57:28] <eddyb> gd: and what's the problem with linking to a shared libc?
[10:58:51] <gd> That kind of errors.. /lib64/libc.so.6: version `GLIBC_2.14' not found
[10:58:57] <eddyb> aaah
[10:59:23] <eddyb> gd: copy libc.so.6 (I hope it's 6) from your cent os and link against that, instead
[11:00:20] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[11:00:27] *** Quits: mib_t1qb5d (Mibbit@6AD345E5.19847752.2F9DE622.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:03:30] <gd> eddyb : I'll do that. Thanks. But it seems weird for a compiled language to require libc. 
[11:03:42] <eddyb> gd: erm, why?
[11:05:46] <eddyb> Go must be containing manual definitions of Linux system calls, which is taking it a bit too far
[11:06:33] <rca> eddyb: go links everything statically by default iirc. It probably does that for libc as well.
[11:06:40] <igork> maybe they just statically link libc, not sure if thtats possible
[11:06:56] <eddyb> that's risky
[11:06:58] <rca> and i agree that's taking it a bit too far :)
[11:07:00] <gd> I understand. I also understand they've done it because it was more convenient for them to reimplement that instead of implementing dynamic linking.
[11:07:32] *** Quits: io2 (io2@moz-871549F5.home.otenet.gr) (Ping timeout)
[11:07:43] <eddyb> (static linking with specific versions of libraries can lead to incompatibilities - more so than going to linux syscalls directly)
[11:07:57] *** Joins: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za)
[11:08:35] *** Joins: nkoep (nik@moz-C574095A.pool.mediaways.net)
[11:09:16] <rca> plus when you work in the same company that wrote gold, you probably have access to people who *know* dynamic linking.
[11:09:19] <gd> But, in the end of the day, go binaries are working just everywhere I tried even on a very old lappy with debian 3 on it. (This is not a rant, I'm just trying to figure out)
[11:09:58] <geal> is there a way to skip some stages in the rustc compilation?  Or recompile only the lib I want?
[11:10:08] <eddyb> geal: what are you working on?
[11:10:14] <eddyb> gd: it's still possible in Rust, but FFI is much easier to use
[11:10:26] <geal> eddyb: https://github.com/mozilla/rust/issues/11201
[11:10:52] *** Quits: int3_ (int3_@F90F9A7.83793537.D1416617.IP) (Ping timeout)
[11:11:17] <geal> my laptop is a bit slow, so I build on my server (quad core), but it still takes a long time...
[11:11:21] <eddyb> geal: so, libnative?
[11:11:24] <geal> yep
[11:11:40] <eddyb> geal: make rustc-stage1, I guess
[11:11:43] <gd> eddyb : what do you mean?
[11:12:14] <eddyb> gd: it's trivial to use C functions from Rust code. implementing all linux syscalls manually is harder
[11:12:36] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[11:13:31] <gd> eddyb : got it. Thanks.
[11:14:16] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[11:17:04] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[11:18:11] *** Joins: jackneill (jackneill@moz-5CBC0CBA.pool.digikabel.hu)
[11:20:21] <gd> eddyb : your solution is not really convenient. libc is really a central piece of the system, I can't just copy it somewhere and tell rustc to use it. All the other libs are incompatible. I'd better install rust directly on the server. Not sure whether it will compile though. Thank you anyway, I've learned new stuff today.
[11:20:28] *** Joins: Arthur_D (Trillian@4C6DBBFE.447CD3C0.2D7E49EB.IP)
[11:21:16] *** Joins: heftig (heftig@moz-D746319F.unitymedia.biz)
[11:21:20] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[11:21:45] *** Joins: killerswan (kevin.cant@E9A7755D.F485DE6D.5604FD67.IP)
[11:22:44] <igork> btw, what is rust-way to distribute binary programs? ship with own libc?
[11:23:11] <sigma> gd: we have that problem at work, the way we get around it is by building our binaries on an older distro, eg centos5, then the binaries will work on anything newer thanks to glibc's backwards compat.
[11:23:45] <sigma> The trick will be to find the older glibc that supports all the symbols the rust toolchain needs
[11:24:08] <sigma> oldest*
[11:25:17] <rca> i know there's a ubuntu ppa for lucid. It must build with 2.13.
[11:26:11] <gd> sigma : good idea. I'll do it as a workaround, hoping rust dev will come with something better in a few releases :)
[11:27:49] <sigma> It's not so much a rust issue as a shared library issue, Red Hat have a nice workaround for running new compiler toolchains against old glibcs, but it's gcc specific, I don't know if there is anything similar for llvm
[11:29:26] <gd> igork : not a good idea. libc is really a central part of your system. Virtually everything links to it. If you ship another version, chances are very high that you would break everything (if the provided libc is located in a system lib directory).
[11:29:47] <sigma> https://access.redhat.com/site/documentation/en-US/Red_Hat_Developer_Toolset/2/html/User_Guide/chap-Red_Hat_Developer_Toolset.html in case you're interested
[11:29:54] <sigma> wow that link was bigger than I thought
[11:31:17] *** Quits: kanru (kanru@moz-99690620.hinet-ip.hinet.net) (Input/output error)
[11:31:27] <rca> gd: about your issue, have you tried to do the opposite, copy libc, and other dependencies of rustc, to your server and run with LD_LIBRARY_PATH pointing to them ?
[11:32:15] *** Quits: benjamin_ (benjamin@moz-C9D9B603.dip0.t-ipconnect.de) (Ping timeout)
[11:32:16] <sigma> rca: that's a recipe for disaster
[11:32:39] <sigma> it's possible, but it's not something you'd ever want to run in production
[11:32:44] *** Joins: ofeldt (ofeldt@moz-3A4AA409.dip0.t-ipconnect.de)
[11:32:54] <rca> sigma: you don't want to run rust in production anyway.
[11:32:56] <Mathuin> I've got a new project idea: a rustic (pun intended) DPLL SAT-Solver
[11:32:57] <sigma> (not that anyone should run rust in production just yet)
[11:32:59] <rca> not right now
[11:33:23] <dbaupp> eddyb et al.: go does reimplement libc to be entirely statically linked
[11:33:27] <gd> sigma : didn't know that (for RHat). Definitely interesting. 
[11:33:38] *** Quits: ofeldt- (ofeldt@moz-C6A1CDAA.dip0.t-ipconnect.de) (Ping timeout)
[11:33:46] <dbaupp> derek_c: there are some shortcuts for doing `make check`
[11:33:52] <sigma> rca: My point was that it's still a bit of a hack compared to just building in a chroot with an older glibc
[11:33:59] <ecl3ctic> eddyb: I finally got around to posting an issue, after reading up on size_t first: https://github.com/mozilla/rust/issues/11447
[11:34:03] <derek_c> dbaupp: like what?
[11:34:05] <dbaupp> derek_c: https://github.com/mozilla/rust/wiki/Note-testsuite contains the full list of things
[11:34:31] <dbaupp> derek_c: if you're working on libstd or libextra, `make check-stage2-std NO_REBUILD=1` is amazing
[11:34:42] <dbaupp> do a `make` once to get a new-enough compiler
[11:34:56] <dbaupp> and then run that command until the tests you've written are passing
[11:35:22] <derek_c> dbaupp: so it will use the compiler built by the first `make`?
[11:35:25] <dbaupp> yes
[11:35:34] *** Quits: blaenk (blaenk@moz-C270A5EA.lsanca.dsl-w.verizon.net) (Quit: Leaving)
[11:35:37] *** Joins: JIghtuse (jightuse@5ACC7636.C3AC81A2.906273CD.IP)
[11:35:42] <derek_c> dbaupp: is there a way to make it use my system Rust?
[11:35:54] <dbaupp> `rustc lib.rs` in the appropriate directory
[11:35:55] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[11:36:04] <dbaupp> assuming your system Rust is new enough
[11:36:27] <derek_c> dbaupp: I'm sorry?
[11:36:52] <dbaupp> derek_c: you can compile the crates directly
[11:36:53] *** Joins: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com)
[11:36:58] <rca> sigma: i wholeheartedly agree, but it can be useful, and is sometimes easier to integrate with the rest of the system. 
[11:37:02] <dbaupp> `cd src/libstd; rustc lib.rs`
[11:37:14] <dbaupp> will build libstd without optimsations (which is pretty quick)
[11:37:23] <derek_c> dbaupp: ah ok. but don't I need to use the --test flag?
[11:37:25] <dbaupp> to build the test runner `rustc --test lib.rs`
[11:37:25] <sigma> rca: I would be in complete agreement for any library except libc :)
[11:37:29] <dbaupp> and then `./std`
[11:37:37] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[11:37:37] <derek_c> dbaupp: very nice. thanks!
[11:37:43] <dbaupp> (you can pass `./std some_string` to filter the tests taht are run)
[11:37:55] *** Quits: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP) (Input/output error)
[11:38:06] <dbaupp> (You can also do the filtering with `make ... TESTNAME=some_string` when using the makefiles.
[11:38:06] <dbaupp> )
[11:38:10] *** Joins: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP)
[11:38:20] *** Quits: spacetime (quassel@moz-CAB487E6.rishab.in) (Ping timeout)
[11:38:21] *** Joins: spacetime (quassel@moz-CAB487E6.rishab.in)
[11:39:10] <rca> sigma: honestly if your libc is too old, any solution other than upgrading yout distro will have downsides. Even the chroot solution consist in having a subsystem up-to-date in an older system. When upgrading isn't an option, well prepare for hacks.
[11:40:45] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Quit: Leaving.)
[11:41:04] <derek_c> dbaupp: what's the difference between stage 1 tests and stage 2 tests?
[11:41:39] <dbaupp> derek_c: do you know the difference between stage1 and stage2 in the Rust bootstrap?
[11:41:46] <derek_c> dbaupp: no
[11:41:54] <dbaupp> derek_c: https://github.com/mozilla/rust/wiki/Note-compiler-snapshots
[11:42:10] <dbaupp> stage<n> tests are the test suite run with the stage<n> compiler
[11:42:38] <derek_c> dbaupp: thanks!
[11:46:57] *** Quits: sedman (sedman@E4D2F0A.47298EC7.57E8EAD3.IP) (Ping timeout)
[11:50:16] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[11:51:03] *** Joins: mleise (marco@moz-850E56A9.pools.arcor-ip.net)
[11:51:36] <gd> Thanks for your answers. Bye.
[11:51:39] *** Parts: gd (Mibbit@moz-CFB96525.cnrs-imn.fr) ()
[11:51:57] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[11:58:57] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Input/output error)
[11:59:01] *** Joins: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net)
[11:59:10] <bjz> did there used to be a `resource` keyword?
[11:59:16] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:59:32] <bjz> looking at: https://github.com/marijnh/CodeMirror/blob/master/mode/rust/rust.js#L6
[11:59:36] <bjz> bstrie: ^
[12:00:01] *** Quits: Ferreus (ferreus@moz-8FF65811.dip0.t-ipconnect.de) (Ping timeout)
[12:02:12] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:03:01] <eddyb> bjz: heard it mentioned. something that predates (and might have been obsoleted by) Drop
[12:03:21] *** Joins: int3_ (int3_@F90F9A7.83793537.D1416617.IP)
[12:03:22] <bjz> so many old keywords here
[12:05:05] <dbaupp> bjz: yeah, from what I can work out "resource"s were things that needed clean-up (i.e. destructors)
[12:05:40] <bjz> I'm guessing `claim` and `check` were old typestate things
[12:05:57] *** Joins: bheylin (brianheyli@moz-300B2629.vanguardgames.net)
[12:08:32] *** Joins: jdeng (Mibbit@moz-6548813B.blktn6.nsw.optusnet.com.au)
[12:09:35] <jdeng> Hey, why function literal like "let f = fn(a) { a + 1 }" is not allowed now?
[12:10:11] <jdeng> It is like closure, but does not refer to the stack.
[12:10:12] <eddyb> o_O that was allowed?
[12:10:24] <eddyb> let f = |a| a+1; works
[12:10:42] <jdeng> But I don't want a closure, it is not sendable.
[12:10:46] <dbaupp> bjz: don't know about claim (from the word, I'd guess it's something to do with resources), but check was typestate
[12:11:04] <dbaupp> jdeng: the old `fn(a) { ... }` was just another way to write a closure, iirc.
[12:11:13] <jdeng> I want a sendable function, that can be invoke multiple times.
[12:11:22] *** Joins: jadbaires (jadrian@moz-9AE9F7C5.dsl.telepac.pt)
[12:11:32] <dbaupp> I guess we could have anonymous plain functions.
[12:11:36] <bjz> jdeng: you mean 'sendable function'?
[12:11:38] <eddyb> jdeng: that closure has the type 'static |int| -> int
[12:11:42] <bjz> woops
[12:11:45] <eddyb> jdeng: which should be sendable ;)
[12:11:48] <bjz> jdeng: you mean 'sendable closure'?
[12:12:02] <jdeng> Yes, I want that
[12:12:22] <eddyb> just store it as 'static |...| -> ... and it should be fine
[12:12:34] <bjz> eddyb: he wants a closure
[12:12:54] <jdeng> How to write a sendable closure or function
[12:13:07] <eddyb> jdeng: do you want to capture stack variables?
[12:13:14] <jdeng> The one I can figure out now is writing plain function.
[12:13:21] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[12:13:34] <jdeng> Currently I don't need to capture stack vars.
[12:13:45] *** Quits: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za) (Ping timeout)
[12:13:49] <jdeng> Closure is not sendable.
[12:13:57] <eddyb> even when it's not capturing anything?
[12:14:15] <jdeng> but I want a sendable function, that is it.
[12:14:20] <eddyb> then there might be an issue about 'static |...| -> ... not being Send or something like that
[12:14:58] *** Joins: Ferreus (ferreus@moz-103584E6.dip0.t-ipconnect.de)
[12:15:06] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[12:15:16] <ecl3ctic> can someone please explain this error to me:
[12:15:18] <ecl3ctic> error: cannot borrow `*self` as mutable because it is also borrowed as immutable btpool.rs:114 		self.chain_stack_manager.lock( ||{self.__request_chain()} )
[12:15:30] <ecl3ctic> chain_stack_manager is a mutex
[12:15:44] <ecl3ctic> this is in a function with &mut self
[12:15:57] <ecl3ctic> request_chain takes a &mut self
[12:16:16] <jdeng> Do you mean writing something like 'static |a| -> a + 1 ?
[12:16:29] <jdeng> But the compiler ejects this syntax.
[12:17:21] <eddyb> jdeng: 'static is in the type
[12:17:58] *** Joins: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za)
[12:18:01] <jdeng> eddyb: then how to define such a closure? An example?
[12:18:17] <eddyb> jdeng: so, if you want to store a closure, you need to put a lifetime on it. like 'a |ArgTypes| -> RetType. that lifetimes is 'static if the closure doesn't capture anything
[12:18:44] <eddyb> jdeng: if let f = |a| a + 1; isn't sendable, then that's a bug
[12:18:58] *** Joins: Sorella (quildreen@D2D1E5DD.81EFC25A.A95FAE2B.IP)
[12:21:27] <dbaupp> eddyb: I just checked, it's not send
[12:21:52] <jdeng> eddyb: Yes, I try it in some generic code but the compiler complains it is not sendable.
[12:22:04] <kimundi> ecl3ctic: Well, the labda does a &mut self borrow, and you pass it to a function that does a &mut self borrow, which emans two different &mut borrows to the same thing exists at the same time, which is not allowed for muatble references
[12:22:06] *** Quits: gamakichi (Mibbit@moz-CD3EFF74.cs.virginia.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[12:22:20] *** Joins: bletch (Mibbit@B9BBA2B7.E0D718C1.BDAE6B1E.IP)
[12:22:27] <bletch> hello
[12:22:29] <dbaupp> jdeng: do you realise you can write `fn f(a: int) -> int { a + 1 }` whereever you want, and pass `f`?
[12:22:58] <jdeng> Yes, that's my current solution.
[12:23:02] <dbaupp> e.g. `fn send_a_function() { fn f(a: int) -> int { a + 1 } some_channel.send(f) }`
[12:23:04] <dbaupp> oh, good :)
[12:23:48] <eddyb> dbaupp: it's still a bug
[12:23:48] <jdeng> But as there is a proc(..) {...},  I just guess there is one for plain fn.
[12:24:06] <dbaupp> eddyb: yes
[12:24:14] <eddyb> jdeng: there's nothing required for plain fn, a 'static closure should work just as well
[12:24:49] <ecl3ctic> kimundi: why does the error message say "also borrowed as immutable" then?
[12:24:50] <dbaupp> eddyb: (i was just making sure you knew that it doesn't work with the current compiler)
[12:25:00] <jdeng> But I still don't know how to create a static closure.
[12:25:05] <ecl3ctic> kimundi: as opposed to mentioning exactly what you said :)
[12:25:29] *** Quits: bletch (Mibbit@B9BBA2B7.E0D718C1.BDAE6B1E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:25:32] <kimundi> ecl3ctic: might just be a bug, or maybe the &mut gets borrowd as a & somewhere in between
[12:25:41] <eddyb> jdeng: I told you already, |a| a + 1 is a 'static closure. anything that doesn't capture locals is a 'static closure
[12:25:54] <jdeng> eddyb: |..| {...} doesn't work.
[12:25:56] <kimundi> eddyb: Is it?
[12:25:58] <ecl3ctic> kimundi: perhaps the lambda catches it as immutable?
[12:26:02] <jdeng> eddyb: now I see.
[12:26:09] <eddyb> jdeng: which is why I said it's a bug that it's not Send
[12:26:38] <jdeng> eddyb: I see. Thanks
[12:27:11] <kimundi> ecl3ctic: lambdas in general can be thought of as capturing mutable, so thats probably not it. however, labdas used also to have the type &fn(), so maybe thats just legacy cruft or so. But this is all baseless assumptions from me ;)
[12:27:21] <jdeng> Has this bug been reported?
[12:27:37] <eddyb> doesn't look like it, but my github-issue-search-fu is low
[12:28:12] *** Quits: bheylin (brianheyli@moz-300B2629.vanguardgames.net) (Quit: bheylin)
[12:28:52] <dbaupp> eddyb: the correct solution to github-issue-search is to do a pile of bug triage to get them all into your browser history :P
[12:28:57] <kimundi> A lambda that doesn't capture anything should just coerce to a static function fn(...) -> ... ideally, which in turn would coerce to 'static |...| -> ...
[12:29:18] <eddyb> kimundi: no, that complicates things
[12:29:43] <kimundi> eddyb: But it would be more useful
[12:30:10] <kimundi> allowing you to pass lambdas to functiosn that want raw function pointers
[12:30:23] <kimundi> (Irrelevant to this isuue here though)
[12:30:26] <eddyb> why would a function want raw function pointers?
[12:30:40] <eddyb> I switched some kernel code from extern "Rust" fn to 'static ||
[12:30:56] <kimundi> FFI? 
[12:30:57] <dbaupp> closures are fat
[12:31:16] <dbaupp> fn() is one word, || is two
[12:31:46] <eddyb> yeah, I thought about making 'static || thin, the problem is that you still can pass it to a function which wants 'a ||
[12:31:52] *** Quits: killerswan (kevin.cant@E9A7755D.F485DE6D.5604FD67.IP) (Ping timeout)
[12:31:57] <dbaupp> yep
[12:32:15] <dbaupp> but you can just stick on a zero word at that point
[12:32:35] *** Joins: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca)
[12:33:31] <eddyb> dbaupp: I guess typeck could treat non-capturing closures differently, and add coercion
[12:33:41] <kimundi> Hm - I could imagine that making 'static || thin would not always work
[12:34:37] <eddyb> we can use the same coercion as for fn -> || (if we remove the env ptr from bare fn's)
[12:35:50] <eddyb> and cmr/dbaupp had a pretty good idea (that they dismissed in a way) - one fn -> closure adapter per fn type
[12:36:00] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[12:36:09] *** Quits: cdidd (cdidd@moz-12BB9471.broadband.corbina.ru) (Ping timeout)
[12:36:29] <kimundi> Don't you just need to lazyly emitt such a adapter for every static function you want to apss as a lanbda?
[12:36:30] <eddyb> (passing the fn ptr in the env slot. it should work well enough, if the adapter is just a function call, no bitcasts)
[12:37:07] <eddyb> kimundi: the problem with that is you can coerce a random extern "Rust" fn, you don't always start from literals
[12:37:20] <eddyb> s/literals/direct references to functions/
[12:37:25] <kimundi> right
[12:38:01] <eddyb> it's really just one IR instruction. maybe two, for the return. and it should be easy to inline it
[12:39:35] <kimundi> Do you mean like this: take random function pointer. Define one closure that just calls its env field as a function pointer. coerce any function pointer passed as a lambda to a tuple of fn pointer to that adapter function and individual fn pointer
[12:40:13] <dbaupp> eddyb: not always easy to inline it, it called by a virtual call 
[12:40:18] *** Joins: mib_guvjjx (Mibbit@moz-150F5176.dhcp.ftwo.tx.charter.com)
[12:40:36] *** Joins: cdidd (cdidd@moz-FCE79F7A.broadband.corbina.ru)
[12:40:40] <jdeng> I thought we have three literal fn() {}, || {} and proc() {} for different fn types.
[12:40:40] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Connection reset by peer)
[12:40:44] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[12:40:46] <eddyb> kimundi: pretty much
[12:40:58] <kimundi> fn adapter(self) { self() } fn random_fn() {}  let lambda = transmute((adapter, random_fn))
[12:41:03] <jdeng> eddyb: you remind me that the first two coerce to || {}, right ?
[12:41:17] *** Joins: bachm (Mibbit@moz-4A19983C.ip227.fastwebnet.it)
[12:41:27] <jdeng> eddyb: so you think current || {} has a bug
[12:41:27] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Client exited)
[12:41:45] <eddyb> jdeng: more like an overlooked detail
[12:42:12] <kimundi> wait, fn() {} is not a literal
[12:42:38] <jdeng> kimundi: I thought we have. Now I know it's not.
[12:42:49] <kimundi> Ah okay
[12:43:30] <bachm> is there a way to disallow "manual construction", like in Point{x: 24, y:56}, and instead force the user to call Point::new(24,56)?
[12:43:35] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[12:43:40] <kimundi> bachm: Yes: make the fields private
[12:43:54] <jdeng> Personally I think that three types of literals is more consistent.
[12:43:59] <kimundi> put "priv" on them
[12:44:27] *** Quits: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net) (Quit: Leaving.)
[12:44:38] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[12:45:16] <dbaupp> jdeng: you can write a macro `func!((x: int) -> int { ... })` that expands to `{ fn some_name(x: int) -> int { ... } some_name }`
[12:45:57] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[12:46:54] <jdeng> dbaupp: in a function call like map(vec, func!(...)) , does it work?
[12:47:13] <eddyb> jdeng: why not take a closure in map?
[12:47:16] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[12:47:28] <jdeng> I guess fn declaration is not an expression
[12:47:34] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[12:47:41] <eddyb> jdeng: func!(...) is an expression
[12:47:46] <eddyb> (because it's in a block)
[12:47:53] <eddyb> b | (TC::ReachesBorrowed).when(region != ty::ReStatic) // hmm
[12:48:05] <jdeng> eddyb: I just make an example, where I want a plain fn expression
[12:48:25] <eddyb> why not a closure?
[12:48:45] <jdeng> because closure is not send now.
[12:49:03] <eddyb> jdeng: might be in a couple hours :P
[12:49:19] <ecl3ctic> kimundi: my error persists
[12:49:24] <ecl3ctic> http://pastebin.mozilla.org/3981592
[12:49:26] <eddyb> dbaupp: okay, so 'a || is treated as &'a Trait + &'a T
[12:49:34] <jdeng> eddyb: great.
[12:49:36] *** Quits: alsm (asm@moz-EDA9E7AA.emea.ibm.com) (Ping timeout)
[12:49:48] <ecl3ctic> it seems that accessing the mutex of my struct through self prevents me from mutating self
[12:50:05] <ecl3ctic> - in the lambda given to that mutex
[12:50:05] <eddyb> &'static Trait isn't Send, pretty sure
[12:50:11] <ecl3ctic> that makes mutexes kinda stupid
[12:50:16] <ecl3ctic> (for that purpose)
[12:50:25] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[12:50:33] <ecl3ctic> but if I copy the mutex first then everything is dandy
[12:50:36] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[12:51:11] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[12:51:21] <kimundi> ecl3ctic: Thats about what is to be expected with the ruels around &mut
[12:51:29] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[12:51:31] <kimundi> eddyb: Well, you need to give trait bounds
[12:51:35] *** Joins: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP)
[12:51:36] *** Quits: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP) (Quit: mindcat)
[12:51:39] <dbaupp> oh, you can force a closure to be send!
[12:51:41] <kimundi> &'static Trait:Send is :P
[12:51:44] <dbaupp> 'static ||:Send
[12:51:48] <eddyb> hahaha
[12:51:49] <dbaupp> is the type
[12:51:58] *** Joins: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP)
[12:52:06] <ecl3ctic> kimundi: so what's the solution I should be using?
[12:52:12] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[12:52:19] <eddyb> dbaupp: feels a little dumb
[12:52:21] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[12:52:21] <dbaupp> let f: 'static ||:Send = || {}; fn test_send<T: Send>(_: T) {} test_send(f) runs for me
[12:52:34] <kimundi> ecl3ctic: Not sure
[12:52:39] *** Quits: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP) (Quit: leaving)
[12:52:43] <kimundi> ecl3ctic: Is the clone() solution bad?
[12:52:51] <eddyb> jdeng: see dbaupp's example
[12:52:54] *** Joins: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP)
[12:53:06] *** Quits: mindcat (mindcat@9A2A4FAD.297EFC2A.57E3C596.IP) (Quit: leaving)
[12:53:09] <eddyb> dbaupp: okay then, I won't try to force all 'static to be Send
[12:53:27] <ecl3ctic> kimundi: well it's a hack solution...
[12:53:45] <ecl3ctic> kimundi: It's usable - I doubt it will affect performance
[12:53:50] <kimundi> ecl3ctic: wait, is the data the one &mut borrow is accessing disjoint with the data the other &mut is accessing? that is, do they point at non-overlapping parts of the struct?
[12:54:28] *** Joins: mindcat (mindcat@CFA3850B.9B7EF212.2BCF2E43.IP)
[12:54:34] <kimundi> If yes, then it is safe to mutably borrow both parts at the same time
[12:54:43] <ecl3ctic> kimundi: self.mutex isn't touched in __request_chain
[12:54:51] <ecl3ctic> if that's what you're asking
[12:55:21] <kimundi> ecl3ctic: Okay. can you refactor the struct so that it has two fields: mutex and everything else?
[12:55:53] <ecl3ctic> kimundi: everything else in a sub-struct?
[12:55:56] <kimundi> yes
[12:56:16] <ecl3ctic> kimundi: I could, but isn't that a hack solution as well?
[12:56:18] <eddyb> struct Locked<T> {lock: Lock, data: T}
[12:56:26] <ecl3ctic> kimundi: I suppose that's a smart way to do it though
[12:56:26] <eddyb> ^ doesn't look like a hack to me
[12:57:04] *** Joins: xitology (xi@85437D54.5AFA3E4.CEDFC552.IP)
[12:57:14] <kimundi> If you do that, you can do "let &Struct { ref mut mutex, ref mut other} = self" and end up with two disjoint &mut borrows without any unsafe code
[12:57:14] <eddyb> fn lock(&mut Locked<T>) -> (&mut Lock, &mut T), maybe?
[12:57:42] <jdeng> dbaupp: do you mean that I can define sendable closure now?
[12:57:42] *** Quits: mib_guvjjx (Mibbit@moz-150F5176.dhcp.ftwo.tx.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[12:58:17] <eddyb> why is &'static Trait not Send, btw?
[12:58:40] <eddyb> &'static T seems to be Send, so what could a &Trait hide?
[12:58:43] <ecl3ctic> eddyb, kimundi: that sounds like it will work
[12:59:36] <dbaupp> jdeng: yes, you have to annotate the types explicitly though, like `let f: 'static |int|:Send -> int = ...;` so it's actually worse than defining a normal `fn`
[12:59:37] *** Joins: dangets (dangets@moz-E9E4A77B.cpe.cableone.net)
[12:59:39] <kimundi> eddyb: It could hide managed pointers, for example
[12:59:49] *** Quits: int3_ (int3_@F90F9A7.83793537.D1416617.IP) (Ping timeout)
[13:00:13] <eddyb> kimundi: could it, though?
[13:01:18] <kimundi> Hm, I guess it couldn't , at least not in the non existing env :P
[13:01:49] <kimundi> nmatsakis would probably know more
[13:02:04] <dbaupp> eddyb: it could contain a type like `#[no_send] struct Foo;` placed in a static
[13:02:07] *** Joins: Earnestly (earnest@moz-E86D50FA.dyn.plus.net)
[13:02:12] <eddyb> dbaupp: dammit
[13:02:18] * dbaupp wins
[13:02:38] <dbaupp> although, arguably, it makes zero sense to put non-sendable things in statics.
[13:02:41] * kimundi assigns one rusty iron star to dbaupp 
[13:02:55] <eddyb> so this is just a matter of implying both 'static *and* Send to non-capturing closures
[13:03:02] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:03:07] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Connection reset by peer)
[13:03:09] <eddyb> s/to/for/
[13:03:15] <mindcat> dbaupp: any non-block tcp reader?
[13:05:06] *** Joins: int3_ (int3_@F90F9A7.83793537.D1416617.IP)
[13:05:38] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[13:07:14] <dbaupp> mindcat: don't know
[13:09:14] *** Joins: limodou (Mibbit@48886CF5.74B75FBD.91B4046D.IP)
[13:09:37] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:09:37] *** ChanServ sets mode: +o jdm
[13:10:58] *** Joins: benjamin_ (benjamin@moz-C9D9B603.dip0.t-ipconnect.de)
[13:13:49] <ecl3ctic> ecl3ctic: eddyb, kimundi Yep, you guys had the right idea. My code works and is probably better off than it was before
[13:14:02] <kimundi> nice!
[13:14:05] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[13:14:07] *** Joins: vmx (vmx@moz-A59BF2ED.pools.arcor-ip.net)
[13:14:12] <ecl3ctic> I essentially wrapped my non-thread-safe struct in a thread-safe version
[13:15:48] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[13:17:01] *** Joins: pheleas_frog (Mibbit@moz-150F5176.dhcp.ftwo.tx.charter.com)
[13:18:08] <bstrie> bjz: indeed, a resource was a thing that needed destruction
[13:18:26] <bjz> bstrie: so weird
[13:18:45] <bjz> bstrie: once 1.0 is done there needs to be some sort of rust retrospective
[13:18:52] <bstrie> bjz: I'm not sure it was ever fully implemented, we got rid of them in favor of a `drop` member on structs that would define a function to run as a destructor
[13:19:16] <derek_c> dbaupp: how do you compile only a certain stage?
[13:19:19] <bstrie> bjz: I'd love to write one :P
[13:19:21] <bjz> wasn't there `dtor`?
[13:19:32] <bjz> or was that something else...
[13:19:34] <dbaupp> derek_c: I don't think you can do that
[13:19:41] <bstrie> if there was then it's lost to my memory, or perhaps predates me
[13:19:45] <dbaupp> bjz: `drop` used to be special
[13:19:49] <bstrie> there was a lot of rust history that I wasn't around for :P
[13:19:52] <dbaupp> bstrie: does anything predate you? :P
[13:19:57] <bjz> ah yeah, memory is hazy
[13:20:04] <bstrie> there are some things that pcwalton has mentioned that were definitely before my time
[13:20:27] <bjz> bstrie: I would love to look at the really early stuff - before it was on git
[13:20:54] <bstrie> bjz: surely you've seen http://brson.github.io/archaea/ ?
[13:21:04] <bjz> yep!
[13:21:08] <bstrie> I mean, yes, it only goes back as far as git
[13:21:09] *** Joins: jpoirier (jpoirier@moz-150F5176.dhcp.ftwo.tx.charter.com)
[13:21:34] <bstrie> before that I wouldn't have been surprised if it was using svn... or monotone
[13:21:46] <bstrie> since graydon worked on monotone
[13:22:20] <bstrie> or perhaps, single-handedly devised monotone. his name is the most prominent on the paper
[13:22:42] <bjz> would be cool to have that old repo archived, if it still existed
[13:23:15] *** Quits: pheleas_frog (Mibbit@moz-150F5176.dhcp.ftwo.tx.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[13:23:25] <bjz> it's important history
[13:23:31] <bjz> heh - wtf: http://brson.github.io/archaea/spawn-fn.html at "13/33 2011-10-13 15:37:07 -0700 Convert tests to use bare-fn spawn "
[13:23:40] <bjz> fn# x(&&args: (str, int)) { 
[13:23:50] <bjz> what is the `#`?
[13:23:51] <kimundi> haha
[13:24:04] <bjz> I know the argument modes
[13:24:10] <bjz> (guhhhh)
[13:26:02] <bstrie> bjz: see two versions later, "Remove temporary fn# syntax"
[13:26:10] <bjz> ohhh
[13:26:13] <bjz> transitional
[13:26:18] <bjz> bootstrappy
[13:26:32] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[13:26:39] <infynyxx> Hi there, in Rust 0.8, there used to be rust binary for running commands like: rust test <file> and rust run <file>; but seems like that binary is not present in 0.9? Is it removed?
[13:26:54] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[13:27:14] <bjz> infynyxx: the tool was removed due to it not being actively maintained by anyone
[13:27:15] <bstrie> infynyxx: yes, it was removed. and it was basically only ever a thin wrapper over rustc. it might come back one day once we have more tools
[13:27:16] <bjz> :(
[13:27:27] <bjz> rust stats
[13:27:29] <bjz> :)
[13:27:35] <bstrie> yeah I think that one's a good idea
[13:27:43] <infynyxx> ah thx for the info
[13:27:50] <dbaupp> rust stats?
[13:28:22] * kimundi doesn't know what his bigger mistake was - letting the rust tool rot, or writing it in the first place
[13:28:22] <infynyxx> it was easy to to run and test with those commands just like in go :)
[13:28:23] <bstrie> dbaupp: the idea was to have a tool that just looks at your code and spits out random but useless statistics, like the proportion of mutable to immutable variables that you use
[13:28:30] <bjz> dbaupp: bstrie was talking about the proportion of mutable to immutable vars
[13:28:40] <bjz> oh, heh, beat me to it bstrie 
[13:28:55] <bjz> LOC would be good too :)
[13:29:23] <dbaupp> number of lines with `let` followed by a variable containing 'u' in its name
[13:29:39] <bjz> yes!
[13:29:43] <kimundi> "rust clippy" - opens up an helpful assistant for compile errors
[13:29:50] <bstrie> average line length
[13:29:52] <dbaupp> number of instances of 4 lines in a row with trailing semicolons
[13:30:02] *** Quits: KindOne (KindOne@moz-6E4315B4.dynamic.ip.windstream.net) (Ping timeout)
[13:30:04] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[13:30:14] <bstrie> proportion of safe to unsafe code
[13:30:15] <dbaupp> number of bitwise operations performed on i16s
[13:30:26] <dbaupp> (excluding xor, of course)
[13:30:52] <bjz> bstrie: was there a different function syntax at one stage?
[13:31:02] <bjz> bstrie: "Remove temporary fn# syntax"
[13:31:12] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[13:31:55] <bstrie> bjz: given the prior commit message regarding moving to "bare fn spawn", it seems as though previously all spawning required a closure
[13:32:13] <bjz> interesting
[13:32:31] <bstrie> so maybe when they transitioned to allowing you to spawn bare fns, they first transitioned to a fn# construct that was just a bare fn with an empty environment
[13:32:49] <bstrie> but I'm just guessing
[13:32:52] <bjz> mmk
[13:32:58] <bstrie> october 2011 was when I was first hearing about rust :P
[13:32:59] <bjz> this one is a gem: http://brson.github.io/archaea/writealias.html
[13:33:11] <bjz> fn f(mutable &point p) { 
[13:33:13] *** Joins: killerswan (kevin.cant@E9A7755D.F485DE6D.5604FD67.IP)
[13:33:29] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[13:33:31] <bjz> type point = rec(int x, int y, mutable int z);  // old record syntax
[13:33:50] *** Joins: KindOne (KindOne@AF1B46C7.A8EAE74D.34F73994.IP)
[13:34:00] <bjz> dbaupp: oh, `check` must have been `assert`
[13:34:12] <bjz> if you look at that example
[13:34:23] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[13:34:25] *** Quits: int3_ (int3_@F90F9A7.83793537.D1416617.IP) (Client exited)
[13:34:57] <derek_c> how do you compile rustdoc directly?  Seems like it can't find libsyntax
[13:35:54] <derek_c> I mean, just doing `rustc lib.rs` doesn't work
[13:36:46] *** Quits: limodou (Mibbit@48886CF5.74B75FBD.91B4046D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:36:59] <bstrie> hm, no idea
[13:37:41] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[13:39:06] <kimundi> derek_c: rustdoc needs compile libraries - directly compiling it invloves a bootstrap
[13:40:07] *** Quits: dangets (dangets@moz-E9E4A77B.cpe.cableone.net) (Ping timeout)
[13:40:35] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[13:40:52] <derek_c> so is there a way faster than doing `make` all over again?
[13:42:29] <JIghtuse> just updated few tiny programs for rosettacode for Rust 0.9. Cool error message, folks http://rosettacode.org/wiki/Find_limit_of_recursion#Rust
[13:43:28] <bjz> JIghtuse: you found our lovecraft!
[13:43:41] <bjz> we get to see that less and less these days ... :(
[13:43:41] *** Joins: mib_vu3np3 (Mibbit@397D1D95.A06619EC.79045CC5.IP)
[13:43:49] *** Quits: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net) (Ping timeout)
[13:43:54] <derek_c> kimundi: ^
[13:44:27] *** Quits: mib_vu3np3 (Mibbit@397D1D95.A06619EC.79045CC5.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:45:03] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[13:46:03] <dbaupp> JIghtuse: is that compiling with or without optimisations?
[13:46:45] <JIghtuse> dbaupp: without, just "rustc recursion.rs"
[13:46:58] <kimundi> derek_c: You can use stage1 make targets to get something that only recompiles everything once, and there might be a stage1 target for rustdoc that does the minimum work neccessary - I don't know what the target is called though
[13:47:42] *** Joins: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net)
[13:48:11] <krdln> btw, why this function isn't tail called even with optimizations? Seems to be a trivial example for llvm
[13:48:15] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[13:48:31] <JIghtuse> dbaupp: optimized version go up to 25904
[13:48:56] <JIghtuse> --opt-level 3
[13:49:40] <dbaupp> krdln: good question, seems peculiar
[13:50:01] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[13:50:02] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Quit: Leaving.)
[13:50:35] *** Joins: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[13:50:35] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Connection reset by peer)
[13:51:03] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[13:52:42] <JIghtuse> I like that now it aborts on some assertion rather than failing with segfault
[13:52:44] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[13:54:06] <derek_c> kimundi: are you suggesting me to use the libs under stage1/lib?
[13:54:51] <dbaupp> JIghtuse: in theory, the error message should be something like "error: task <main> overflowed its stack"
[13:55:23] <kimundi> derek_c: Is you goal to hack on rustdoc, or to use it?
[13:55:38] <derek_c> kimundi: to hack it
[13:56:24] <derek_c> kimundi: so I'm trying to figure out the fastest way to compile it
[13:56:35] <kimundi> derek_c: Okay, then I'd try to find the stage0 and stage1 make targets for rustdoc in rusts makefile, and build it with the makefile. Try the stage0 one first, and if taht doesn't work use the stage1 one
[13:57:21] <kimundi> however, I think nothing depends on rustdoc, so you could probably just bootstrap regualry?
[13:57:22] *** Quits: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au) (Quit: http://www.mibbit.com ajax IRC Client)
[13:58:00] <kimundi> what happens if you "make", touch a file from rustdoc, and then "make" again?
[13:58:24] *** Joins: refold (gman@moz-42D68426.a258.priv.bahnhof.se)
[13:58:25] <kimundi> wait, I can test that
[13:58:32] <JIghtuse> dbaupp: I can try to fix it. I just need to clone github repo, now I build rust from archive
[13:58:48] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[14:00:04] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[14:00:26] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[14:00:31] <derek_c> kimundi: actually you are quite right... I can just make again :)
[14:00:36] <derek_c> kimundi: thanks!
[14:04:23] <dbaupp> JIghtuse: I mean normally stack overflow prints that error message
[14:04:48] <dbaupp> JIghtuse: I guess the `println!()` is changing something
[14:05:06] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[14:06:06] <JIghtuse> oh, really, it works without printing
[14:06:08] <eddyb> oh yeah, it might be overflowing in println!
[14:06:54] <eddyb> how about changing a static mut from a green thread (to catch the stack overflow)?
[14:07:21] <eddyb> though then it's really trivial to optimize into an infinite loop
[14:09:39] <JIghtuse> task was to find recursion depth, so loop is not fit here
[14:10:20] <JIghtuse> eddyb: I am going to read about threads now
[14:10:55] <eddyb> I mean, LLVM will optimize it to a loop since it doesn't do anything on the stack, just adds 1 to a static mut
[14:11:15] <JIghtuse> oh, I see
[14:11:17] *** Quits: atomical (atomical@moz-DEDB4821.nuwlan.northwestern.edu) (Quit: atomical)
[14:11:27] *** Joins: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP)
[14:13:34] *** Joins: atomical (atomical@moz-DEDB4821.nuwlan.northwestern.edu)
[14:14:51] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[14:14:54] *** Quits: atomical (atomical@moz-DEDB4821.nuwlan.northwestern.edu) (Quit: atomical)
[14:16:01] *** Joins: atomical (atomical@moz-DEDB4821.nuwlan.northwestern.edu)
[14:16:39] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[14:17:03] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[14:17:35] <bstrie> I'm amused by the person on reddit who's so happy about having nested comments
[14:17:58] <bstrie> considering that we, you know, started out with those, and then removed them at some point...
[14:19:22] <Ms2ger> Nested comments!
[14:20:11] *** Joins: dylukes (dylukes@241B57EB.AF8B4D87.E8393EEB.IP)
[14:20:22] <dylukes> I can't get defining a trait on a function type to work </3.
[14:20:24] <dylukes> Darn :p
[14:20:32] <dylukes> I'll have to box it in a struct I guess.
[14:21:40] *** Quits: jdeng (Mibbit@moz-6548813B.blktn6.nsw.optusnet.com.au) (Quit: http://www.mibbit.com ajax IRC Client)
[14:22:56] <kimundi> dylukes: which function type?
[14:23:01] <dylukes> &fn ... ?
[14:23:06] <dylukes> I couldn't use bare types. 
[14:23:23] <eddyb> &fn is not a type
[14:23:34] <kimundi> dylukes: what eddyb said
[14:23:43] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[14:23:46] <dylukes> I was trying impl<'self, S, T> Foobar<S, T> for &fn(S) -> T { ... }
[14:23:47] <kimundi> dylukes: for what function type do you want to impl a trait?
[14:23:49] <eddyb> dylukes: maybe you want to impl a trait on a closure type?
[14:23:57] <dylukes> eddyb What do closure types look like?
[14:23:59] <eddyb> |S| -> T
[14:24:09] <dylukes> Is that in 0.8?
[14:24:15] <kimundi> dylukes: Do you want to impl for function pointers or closures
[14:24:18] <eddyb> why on earth are you using 0.8?
[14:24:24] <kimundi> dylukes: Use 0.9, we just released :P
[14:24:29] <dylukes> Oh you did?
[14:24:30] <dylukes> Awesome.
[14:24:44] <eddyb> dylukes: you need a good excuse to not use master
[14:25:00] <kimundi> yup, which means we have approximately a week till we can start telling people they should use master again xD
[14:25:01] <eddyb> you need even a better excuse to use the previous to last release :P
[14:25:07] <dylukes> You guys are on top of keeping the homebrew bottles up :p
[14:25:13] <dylukes> eddyb It wasn't yesterday!
[14:25:32] <eddyb> 0.8 is so last year
[14:25:34] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[14:25:48] * kimundi is happy that the master links for docs and downloads are now above the 0.9 links on rust-lang.org
[14:25:57] <dylukes> wait, rust run is gone D:?
[14:26:02] <kimundi> yeah
[14:26:07] <dylukes> Boo >p<
[14:26:17] <eddyb> dylukes: how did you manage to not get shouted at until now?
[14:26:22] <dylukes> I was asleep?
[14:26:25] <kimundi> haha
[14:26:37] <kimundi> eddyb: Nah, we don't shout
[14:26:42] <eddyb> must be a quiet one, clever enough to get around without help
[14:27:00] <kimundi> eddyb: We just recommended in a freindly way to use a version people do actually maintain :P
[14:27:56] <eddyb> hehe, .exe links to https://github.com/mozilla/rust/wiki/Using-Rust-on-Windows
[14:28:19] <dylukes> impl<S,T> Foobar<S, T> for |S| -> T 
[14:28:21] <kimundi> dylukes: Anyway, with 0.9 the trait impl would look like this: impl<'a> Trait for 'a |...| -> ...
[14:28:31] <dylukes> it hasn't been working for me :\
[14:28:43] <eddyb> https://github.com/mozilla/rust/blob/0.9/RELEASES.txt I wish this was .md :/
[14:28:51] <kimundi> impl<'a, S, T> Trait for 'a |S| -> T
[14:28:51] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Broken pipe)
[14:28:58] <kimundi> eddyb: Heh, yeah
[14:29:06] <dylukes> kimundi right but then say if I have a function
[14:29:07] <kimundi> eddyb: FOund it hard to read too :P
[14:29:08] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[14:29:16] <dylukes> fn foo<A>() → ('a |A| → |A|)
[14:29:24] <bachm> are lifetimes going to be revisited to make them less clunky?
[14:29:30] <dylukes> It won't unify the return type with 'a |S| → |T|
[14:29:38] <eddyb> o_O
[14:29:41] <dbaupp> bachm: what's clunky about them?
[14:29:45] <kimundi> bachm: No, this already the less clunky we could manage
[14:29:48] <dylukes> Well, with Trait<S, T>
[14:29:52] <eddyb> |A|->|A|?
[14:30:03] <eddyb> how can you even return a closure like that?
[14:30:05] <dylukes> |A| → A 
[14:30:06] <dylukes> XD
[14:30:21] <dylukes> Hey rust had accepted the type. I made the typo there too...
[14:30:24] <eddyb> dylukes: S can be the same as T, in an impl
[14:30:29] <dylukes> I know.
[14:30:45] <dylukes> impl<'a, S,T> Foo<S, T> for ('a |S| -> T) {
[14:30:45] <dylukes>     fn foo<A>() -> ('a |A| -> A) { ... }
[14:30:50] <dylukes> This doesn't work/
[14:30:52] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[14:31:03] <dylukes> error: method `foo` has an incompatible type: expected trait Foo but found fn
[14:31:06] <eddyb> dylukes: how did you define the trait?
[14:31:21] <bachm> well, the compiler error messages are not always easy to understand when it comes to lifetimes, and I have to use them a lot for relatively simple tasks
[14:31:27] <dylukes> trait Foo<S, T> { fn foo<A>() → &Foo<A, A> }
[14:31:44] *** Joins: nical (nico@87C1F78E.1DE10CA8.D8E68FF6.IP)
[14:31:45] <eddyb> (is your IRC client doing that? it's slightly unnerving :P)
[14:32:08] <eddyb> dylukes: why are S and T unused?
[14:32:13] <kimundi> bachm: well, the error messages certainly can always improved, and not all corners are fully worked out - but they are an integral part of how rusts references work
[14:32:15] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[14:32:15] <dbaupp> bachm: the error messages may be improved
[14:32:20] <dylukes> I just needed the parameters to be there :p.
[14:32:23] <dbaupp> heh
[14:32:40] <dylukes> They're to specify, I guess, source and target types
[14:32:43] <bachm> I understand that lifetimes are essential for safety
[14:33:00] <eddyb> dylukes: well, it's obvious. &Foo<A, A> is an explicit type
[14:33:12] <eddyb> dylukes: you can't replace it with another explicit type
[14:33:18] <dylukes> Ah :\.
[14:33:25] <dylukes> Is there any way to use the trait in the return type?
[14:33:31] <dylukes> Or has the knot not yet been tied? 
[14:33:36] <eddyb> something tells me you don't need both Foo<A, A> and Foo<S, T>
[14:33:50] <eddyb> (that is, they don't have to be the same trait)
[14:33:59] <dylukes> I'd really like them to be.
[14:34:17] <dylukes> Ah wait idea
[14:34:19] <eddyb> dylukes: you have to show me what you actually need for me to help you
[14:34:30] <dylukes> Let me struggle with it for a sec.
[14:34:31] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[14:35:26] <marc_> Can you do function calls in a match statement - e.g. matching on a str with is_empty()
[14:35:49] <eddyb> marc_: you can use if/else or a guard in match
[14:36:16] <Tobba> hm
[14:36:22] *** Quits: mleise (marco@moz-850E56A9.pools.arcor-ip.net) (Ping timeout)
[14:36:28] <eddyb> dylukes: there's a simple transform which you can use in lieu of HKT, it involves traits and generics, but I need to know your usecase
[14:36:33] <Tobba> I have a spawn function which creates a coroutine, I should use proc() for that right?
[14:36:35] <dylukes> HKT?
[14:36:38] <dylukes> ah.
[14:36:43] <dylukes> No I think I've got something.
[14:36:46] <cmr> Tobba: yes.
[14:36:52] *** Joins: mouse_ (mouse@moz-45757DCA.dhcp.yndx.net)
[14:36:53] <Tobba> why does proc() need the heap though
[14:37:23] *** Quits: mouse_ (mouse@moz-45757DCA.dhcp.yndx.net) (Quit: Ex-Chat)
[14:37:24] <eddyb> Tobba: so it can be sent between tasks
[14:37:31] *** Joins: mleise (marco@moz-850E56A9.pools.arcor-ip.net)
[14:37:41] <Tobba> define "task"
[14:37:42] <eddyb> it needs the heap to store its captures
[14:37:48] *** Quits: mouse (mouse@moz-373942D2.dhcp.yndx.net) (Ping timeout)
[14:37:50] <cmr> well that's not the reason.
[14:37:59] <Tobba> if it has no captures though?
[14:38:10] <Tobba> I get the capture thing but yeah
[14:38:13] <eddyb> Tobba: then you can use a 'static||:Send instead
[14:38:14] <Tobba> I need to dodge the heap here
[14:38:25] <cmr> just use a fn() then
[14:38:40] <Tobba> fair enough
[14:38:42] <eddyb> (or yeah, a bare fn if you don't like juggling the type system)
[14:38:48] <Tobba> (fn() { } syntax needs to be a thing)
[14:39:08] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[14:39:14] <Tobba> its just heap allocation are slow, dont make any sense in this case, oh and they may end up doing allocations in an IRQ handler which does Bad Things
[14:39:46] <bachm> would it be possible to have semi-automatically inferred lifetimes? as in, the user simply says "this ref has a lifetime" like here https://gist.github.com/bachm/71aad505ad44d877d5e9
[14:39:47] <eddyb> Tobba: 'static || is my preferred solution here
[14:40:05] <dbaupp> eddyb: I get this sense of deja vu :P
[14:40:22] <eddyb> dbaupp: and I get tired :)
[14:40:26] <bstrie> bachm: we do infer lifetimes all over the place. anytime you ever see a &, there's a lifetime being inferred
[14:40:40] <bachm> currently I have to put <&'a> and 'a in several places for a single reference with a lifetime
[14:40:54] <bstrie> bachm: we only make you specify lifetimes in function signatures when I want to tie the lifetime of an input parameter to that of the output parameter
[14:41:21] <cmr> bachm: I don't think it'd be possible for structures without getting weird. Open an issue
[14:41:42] <Tobba> eddyb: on the other hand, I do need captures
[14:41:49] <Tobba> the function will actually get called instantly however
[14:41:58] <bstrie> I don't know if opening an issue will help. we used to try to infer lifetimes on structs and ran into all sorts of problems
[14:41:58] <Tobba> not sure if I can get away with a closure or not
[14:41:59] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:41:59] *** ChanServ sets mode: +ao dherman dherman
[14:42:25] <cmr> bstrie: well at the very least nmatsakis will chime in on it and close it :)
[14:43:14] <Tobba> it gets a separate stack, so logically its doable, but eh
[14:45:15] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Quit: Leaving.)
[14:45:20] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:46:46] *** Joins: Fatalnix (bhodgins@moz-1F0BEDCC.static.gwi.net)
[14:46:50] <Fatalnix> Good morning
[14:47:01] <Fatalnix> I was told to come here so here I am
[14:47:13] <cmr> morning :)
[14:47:45] <Tobba> basicaly, I have a spawn function that allocates a new stack and is meant to run a passed closure in there, I want to avoid allocations but still be able to use captures
[14:48:22] <cmr> Tobba: can the closure ever outlive its creator?
[14:48:36] <Tobba> if it yields, yes
[14:48:37] *** Joins: alsm (asm@660E716B.CAAD3E7C.524E1A8C.IP)
[14:48:41] <cmr> you can't use || then
[14:48:46] <Tobba> actually wait
[14:48:52] <Tobba> the closure may keep running further than the creator
[14:48:57] <Tobba> the closure object dies instantly though
[14:49:16] <Tobba> as long as it copies over all captures to the new stack its fine
[14:49:21] <cmr> well it still has a references to the stack it was created in.
[14:49:28] <Fatalnix> ooh, 0.9 become stable this morning?
[14:49:34] <cmr> Fatalnix: "stable"
[14:49:39] <cmr> Fatalnix: it was released yesterday.
[14:49:44] <Fatalnix> ah
[14:49:57] <cmr> our releases are just development snapshots atm
[14:50:03] <cmr> every 3 months we cut one.
[14:50:03] <eddyb> Tobba: oooh. you want some kind of unboxed closure
[14:50:24] <Fatalnix> cmr: your nickname seems very familiar
[14:50:25] <eddyb> Tobba: that you can place somewhere else (like the new stack)
[14:50:32] <Fatalnix> except I guess anyone could have come up with it
[14:50:34] <Fatalnix> heh
[14:50:35] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:50:37] <Tobba> eddyb: yeah I'm not sure exactly how to do this
[14:50:45] <cmr> I don't recognize you, so
[14:50:49] <Fatalnix> okay!
[14:50:54] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[14:50:54] * Fatalnix is now free
[14:50:55] <eddyb> Tobba: you can always use a trait method instead of a closure
[14:50:58] *** jorendorff_away is now known as jorendorff
[14:51:09] <Tobba> not exactly sure how that'd work
[14:51:15] <cmr> eddyb: there's no way to avoid the allocation with that though.
[14:51:21] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[14:51:27] <eddyb> cmr: generic function?
[14:51:38] <Tobba> eh, allocations may not be that bad
[14:51:38] <cmr> hm perhaps
[14:51:52] *** Quits: dylukes (dylukes@241B57EB.AF8B4D87.E8393EEB.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[14:51:54] <Tobba> but I want to avoid them because 1. I havent written an allocator yet 2. slowness 3. tends to end badly
[14:52:14] <eddyb> though I'm not sure of the model to know how well it would interact
[14:52:21] <Tobba> like, IRQ handlers cant perform allocations
[14:52:31] <Tobba> because it might end up allocating during an allocation
[14:52:49] <eddyb> Tobba: what's the connection between IRQ handlers and coroutines?
[14:53:05] <Tobba> IRQ handlers may need to spawn a coroutine
[14:53:06] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[14:53:12] <eddyb> oh, and, IRQ handlers can perform allocations :)
[14:53:15] <Tobba> IRQ handlers get a hilariously tiny stack and cant really do anything other than send more commands to HW
[14:53:30] <Tobba> yeah I realize they actually need to do so to allocate the coroutine
[14:53:30] *** Joins: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP)
[14:53:49] <eddyb> there's something very wrong with your allocator if it's not reentrant
[14:53:52] <Tobba> I dont want to make the allocator function have interrupts disabled though because it might be slow
[14:54:16] <eddyb> I have a lock-free iterator that even works with multiple physical cores
[14:54:19] *** Quits: kvanb (kvanb@moz-25C48B43.lns11.lon.bigpond.net.au) (Quit: kvanb)
[14:54:20] <Tobba> eddyb: it might end up locking a section of the structure then interrupting
[14:54:28] <dbaupp> eddyb: *lock-free allocator?
[14:54:35] <eddyb> err, no idea how I managed to do that
[14:54:39] <Tobba> oh shit
[14:54:40] <eddyb> yeah, allocator
[14:54:41] <Tobba> thats kinda neat
[14:54:45] <Tobba> I need to work on that actually
[14:55:02] <eddyb> Tobba: it's a simplified version of the Slam allocator in pedigree
[14:55:02] <Tobba> I think I can technically make mine lock free except for a few sections where I will need to disable interrupts
[14:55:19] <Tobba> though its gonna be a massive waste of time if an IRQ triggers and allocates
[14:55:27] <Tobba> if it touches anything it'll get confused to hell and need to redo the process
[14:55:29] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[14:55:29] <Fatalnix> Wow this channel is active
[14:55:31] <eddyb> the original C++ version locks the page allocation part, but I think that can be lock-free as well
[14:55:53] <Tobba> yeah, my idea was to use a red-black tree where the nodes are laid out to perfectly fit one page
[14:56:08] <marc_> mismatched types: expected `std::option::Option<&str>` but found `std::option::Option<&str>` (lifetime mismatch)
[14:56:13] <marc_> I'm sure that error can be improved :-)
[14:56:14] <eddyb> why a tree? sounds complicated
[14:56:16] <Tobba> if I need to allocate another set of nodes I can just allocate one page too much in the kernel part and use the extra page for the structures
[14:56:22] <Tobba> arbitary allocation sizes
[14:56:28] <cmr> marc_: it didn't used to tell you there was a lifetime mismatch :)
[14:56:31] <Tobba> with semi-best fit allocation
[14:56:35] <marc_> haha
[14:56:43] <eddyb> Tobba: how about size classes?
[14:56:45] <marc_> (btw I know what the error is and fixed it)
[14:56:48] <cmr> marc_: the problem with adding lifetimes to the reported types is that they lifetimes more likely than not are inferred and implicit.
[14:56:49] <Tobba> eh
[14:56:54] <Tobba> its all about just finding a range X long
[14:57:00] <Tobba> which fits as well as possible
[14:57:11] <eddyb> with compile-time known sizes, an allocation is just a function call with no arguments
[14:57:16] <Tobba> in my case I can get a best fit with a probability of 1/(log n)
[14:57:20] <Tobba> log2*
[14:57:23] <eddyb> the function is ~20 instructions long or something
[14:57:54] <eddyb> I don't think you can beat that with trees
[14:58:05] <Tobba> thats just the page allocator though
[14:58:17] <Tobba> I was gonna have a specialized allocator for <=32 byte structures
[14:58:18] <eddyb> your case or my case?
[14:58:23] <Tobba> my case
[14:58:42] <Tobba> the only actual runtime allocated structures would be events and handles
[14:59:05] *** Joins: dylukes (dylukes@moz-CBB6286B.wireless.pitt.edu)
[14:59:07] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[14:59:36] <dylukes> eddyb https://gist.github.com/DylanLukes/8355771
[14:59:44] <eddyb> Tobba: ah. I don't waste any space starting with sizeof(uintptr_t) bytes (where half of the allocation is a pointer, to simplify freeing)
[14:59:45] <dylukes> here's a more concrete example (fleshed out towards what I want to do)
[14:59:45] <Tobba> interesting slam allocator though
[15:00:16] <eddyb> I removed some bloat that apparently wasn't required. (don't confuse SLAM for something in the linux kernel, it's only in pedigree AFAIK)
[15:00:26] <Tobba> linux has some SLAM thing too
[15:00:27] <dylukes> I want to do it more like
[15:00:28] <dylukes> fn compose<A, B, C>(Self<B, C>, Self<A, B>) -> Self<A, C>;
[15:00:29] <dylukes> but I can't.
[15:00:30] <Tobba> which is of course even worse
[15:00:39] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[15:00:52] <Tobba> tree would be pretty few instructions though
[15:00:58] <Tobba> though a few branches
[15:00:59] <dylukes> Could use Self in the trait bounds though :p
[15:01:12] <eddyb> dylukes: you want HKTs, and there's a transform to not use HKTs. but I don't have time right now to fiddle with your code, sorry
[15:01:18] <eddyb> Tobba: ttyl
[15:01:24] <dylukes> Can you point me in the direction of a link?
[15:01:28] <Tobba> I think you're right though, I can probably make it lock free
[15:01:43] *** Quits: jaen (jaen@138A5D71.4C038AE9.C4431F0E.IP) (Ping timeout)
[15:02:47] <eddyb> dylukes: <A, B<?>> ... B<A> (speculative HKT notation) => <A, B: HelperTrait<A>> (so B becomes a regular type instead of a generic)
[15:03:06] <dylukes> And HelperTrait can't be Self?
[15:03:18] <eddyb> no, Self is not generic
[15:03:25] <eddyb> dylukes: though you can use the full trait name
[15:03:34] <dylukes> Isn't that what I did in that github?
[15:03:37] <dylukes> gist*
[15:03:38] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[15:03:53] <dylukes> i.e. fn id<A, AA: Category<A, A>>() -> AA;
[15:03:54] <WebeWizard> Wiizzaarrrd
[15:05:26] <eddyb> dylukes: you were using |A|->A in *formal* generic params
[15:06:02] <dylukes> Ah okay. :\
[15:06:18] <dylukes> Well, I realise you don't have the time to fiddle, but do you have a link to related reading?
[15:06:27] <dylukes> I'm not entirely sure how to modify my code.
[15:06:36] <dylukes> i.e. what HelperTrait would be in this case
[15:07:01] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Input/output error)
[15:07:10] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:07:19] *** Joins: bjustin (bjustin@moz-8FC28563.sierrabravo.net)
[15:08:13] *** Quits: carter (carter@moz-3589B90B.c.ircrelay.com) (Ping timeout)
[15:08:41] *** Joins: carter (carter@moz-3589B90B.c.ircrelay.com)
[15:09:19] *** Quits: rca (rcatolino@6A636113.7FFEF089.2CE09D78.IP) (Quit: leaving)
[15:10:09] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[15:11:07] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[15:12:12] *** Quits: vgeddes (vincent.ge@moz-87365B01.dynamic.isadsl.co.za) (Ping timeout)
[15:13:16] *** Joins: ferminter (Mibbit@moz-8E1B3F2F.adsl-surfen.hetnet.nl)
[15:13:42] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[15:15:01] *** Quits: refold (gman@moz-42D68426.a258.priv.bahnhof.se) (Quit: leaving)
[15:15:31] *** Joins: liszt (liszt@moz-A0A4C524.reverse.softlayer.com)
[15:15:36] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[15:16:48] *** Joins: rustler (Mibbit@B3E6C425.48CB2271.5419EADB.IP)
[15:17:22] <marc_> Erm, what is the opposite of #[cfg(test)] - i.e. I don't want to compile main()
[15:17:23] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[15:17:33] *** Joins: escalant3 (uid14896@moz-31ABA2C0.irccloud.com)
[15:17:41] <marc_> https://github.com/mozilla/rust/wiki/Doc-attributes#conditional-compilation
[15:17:43] <rustler> Hey guys, does Rust have a package manager?
[15:18:08] <cmr> rustler: rustpkg, but it's not 100% working yet.
[15:18:22] <cmr> marc_: #[cfg(not(test))] ?
[15:18:28] <cmr> marc_: main isn't compiled with --test
[15:18:36] <cmr> (or, if it is, it's never run)
[15:18:38] <dylukes> Anyone know anything about this HKT transform?
[15:18:44] <marc_> Yeah, its not run
[15:18:49] <Tobba> that page actually
[15:18:55] *** Quits: dylukes (dylukes@moz-CBB6286B.wireless.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:18:57] *** Quits: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[15:18:58] <Tobba> isnt #[link] depracated now
[15:19:00] <marc_> Thanks
[15:19:06] <Tobba> (crate linkage attributes section)
[15:19:07] <cmr> Tobba: yes
[15:19:18] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[15:19:21] *** Quits: rustler (Mibbit@B3E6C425.48CB2271.5419EADB.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:19:30] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Ping timeout)
[15:19:32] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:19:45] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[15:20:42] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[15:21:57] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[15:22:26] *** Joins: banananana (ba@E7E2A35D.6F99A8B0.2AADDDA7.IP)
[15:22:54] <derek_c> how do you claim an issue?
[15:23:00] <derek_c> i.e. get assigned?
[15:23:07] <cmr> make a comment :)
[15:23:11] <cmr> there's no formal process
[15:23:38] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Ping timeout)
[15:23:42] *** Joins: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr)
[15:23:45] *** Joins: mwillsey (Mibbit@moz-26DE65CF.res.cmu.edu)
[15:23:52] <derek_c> cmr: I see
[15:24:01] <Tobba> oh boy, time to rewrite the ELF loader
[15:24:15] <Tobba> argueably the most insanely unsafe and shitty code section of my old codebase
[15:24:31] <cmr> Tobba: btw rust-bindgen can generate structure definitions out of headers
[15:24:36] <cmr> probably useful for elf :)
[15:24:45] <Tobba> thats pretty neat
[15:24:52] <Tobba> I dont have rust-bindgen atm though
[15:24:57] <Tobba> the structs arent that big anyways
[15:24:59] <cmr> ah and you're on windows
[15:25:01] *** Joins: dylukes (dylukes@moz-CBB6286B.wireless.pitt.edu)
[15:25:05] <cmr> so getting libclang is probably going to be a pita
[15:25:14] <Tobba> I have LLVM and clang compiled actually
[15:25:25] <Tobba> (through large amounts of black magic)
[15:25:30] <dylukes> compiled on what?
[15:25:34] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Quit: bye)
[15:25:35] <Tobba> windows
[15:25:38] <dylukes> Oh, ok.
[15:25:48] <Tobba> only had to edit like half of all build related files of the sodding thing
[15:25:54] <dylukes> Any idea what eddyb meant about the HKT transformation?
[15:25:58] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[15:25:59] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[15:26:15] * cmr has never heard of said transformation
[15:26:23] <kimundi> dylukes: I do - he just walked me htrough it erlier :P
[15:26:29] <dylukes> Would you mind sharing it :)?
[15:26:32] <kimundi> through it earlier*
[15:26:45] *** Quits: pzol (pzol@322A273C.DEB41A6D.AADC76B.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:26:48] <dylukes> This was my attempt
[15:26:48] <dylukes> https://gist.github.com/DylanLukes/8355771
[15:26:59] <Tobba> what the shit
[15:27:02] <klutzy> for rust-bindgen use, you may use some prebuilt clang I think (I used something but forgot where to download)
[15:27:09] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:27:09] *** ChanServ sets mode: +ao dherman dherman
[15:27:13] <Tobba> llvm has some snapshots
[15:27:21] <Tobba> they're crappy though, no llvm bins
[15:27:27] <kimundi> dylukes: I'll take a look at your gist, in the emantime you can take a look at mine ;) https://gist.github.com/Kimundi/8350824
[15:27:39] <dylukes> ice?
[15:27:58] <dylukes> oh h
[15:28:01] <dylukes> oh hm *
[15:29:39] <marc_> io::IoError{kind: FileNotFound
[15:29:58] <kimundi> dylukes: The ICE comment is an unrelated bug
[15:29:58] <marc_> Shouldn't File::open rather return a Result?
[15:30:14] <cmr> marc_: error handling in IO is an open question
[15:30:15] <kimundi> dylukes: Something todo with the lifetime paramter - the actual transformation is identical in both cases
[15:30:29] <kimundi> dylukes: The first file in thjat gist compiles
[15:30:29] <marc_> OK
[15:30:36] <dylukes> Ah okay... :\
[15:30:46] <kimundi> sorry :\
[15:31:11] *** Joins: dev14 (devarshdes@E5E7B410.3BA5A963.4A7DC8C.IP)
[15:31:19] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[15:32:15] <derek_c> Can someone take a look at this and tell me if you think it's worth being added to libextra?
[15:32:17] <derek_c> https://github.com/derekchiang/rust-object-stream
[15:32:43] <derek_c> wrote it for my own project but thought it might be useful to other people too
[15:33:00] <cmr> derek_c: if it was generic over encoder/decoder, yes.
[15:33:07] <cmr> (for example, I'd want to plug in rust-msgpack)
[15:33:17] <derek_c> cmr: that makes sense
[15:35:31] *** Joins: rca (rcatolino@6A636113.7FFEF089.2CE09D78.IP)
[15:35:38] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[15:36:18] <kimundi> dylukes: Hm... I must say not knowing what your code is supposed to do and the immense number of type parameters makes it pretty hard for me right now to find a way to apply the transformation, or even find out if it actually apllies here :P
[15:36:19] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[15:36:26] <dylukes> Heh, alrighty.
[15:36:32] <dylukes> I'm taking a look, your code gave me an idea.
[15:37:00] *** Quits: banananana (ba@E7E2A35D.6F99A8B0.2AADDDA7.IP) (Quit: Verlassend)
[15:37:42] *** jorendorff is now known as jorendorff_away
[15:38:11] <dylukes> kimundi maybe this will help?
[15:38:33] <dylukes> https://gist.github.com/DylanLukes/8356537
[15:38:52] *** jorendorff_away is now known as jorendorff
[15:39:54] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:40:42] <kimundi> dylukes: Hm, could you stub out a generic function that uses your traits (similar to my gist) ? I'm terrible at reasoning about stuff without having a clear starting point xD
[15:40:50] <dylukes> haha okay
[15:41:29] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[15:41:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:41:55] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[15:42:34] <kimundi> fn id<A, I: Arrow<A, A>>() -> I { |a: A| -> A { a } } // that doesn't work - the yfunction is generic over Arrow<A, A>, but you'Re returning a specific type (|A| -> A)
[15:42:36] <dbaupp> wahoo, my mostly-tracing garbage collector compiles
[15:42:45] <Ms2ger> Eek
[15:42:51] <dbaupp> now just to finish the fail!("unimplemented") sections...
[15:42:54] <SiegeLord> It'd be neat if you could chain writers/readers...
[15:42:56] *** Quits: mindcat (mindcat@CFA3850B.9B7EF212.2BCF2E43.IP) (Quit: leaving)
[15:43:02] <cmr> dbaupp: all of them? :>
[15:43:08] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[15:43:09] <dbaupp> SiegeLord: I think std::io::util has something?
[15:43:09] <SiegeLord> Doing a write(mem_writer.get_ref()) seems like a hack
[15:43:10] <cmr> SiegeLord: there's one somewhere that allows that.
[15:43:14] *** Joins: mindcat (mindcat@CFA3850B.9B7EF212.2BCF2E43.IP)
[15:43:20] <dbaupp> cmr: nah, just the important bits :P
[15:43:25] <cmr> SiegeLord: http://static.rust-lang.org/doc/master/std/io/util/struct.ChainedReader.html
[15:43:41] <SiegeLord> That just chains readers together
[15:43:42] <cmr> there's no ChainedWriter, not sure how that would even work.
[15:43:53] <dbaupp> cmr: (as in the part that actually registers the result of the tracing with the garbage collector, the rest is mostly done)
[15:43:56] <SiegeLord> I want to set the output of one writer to be the input of a different reader
[15:44:12] <cmr> a Pipe!
[15:44:31] <cmr> a better name would probably be FusedStream or sth..
[15:44:39] <cmr> that'd probably be useful yeah.
[15:44:44] <Ms2ger> And some pipe-weed!
[15:45:19] <erickt> Ms2ger: and second breakfasts?
[15:45:30] *** Joins: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP)
[15:45:31] <Ms2ger> Yes please
[15:46:01] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[15:46:54] *** Joins: mib_3rt3ov (Mibbit@moz-9D997EA6.cust.bluewin.ch)
[15:47:05] *** Quits: mib_3rt3ov (Mibbit@moz-9D997EA6.cust.bluewin.ch) (Quit: http://www.mibbit.com ajax IRC Client)
[15:48:40] <mwillsey> hi there, could someone explain why i need a lifetime parameter here: https://gist.github.com/anonymous/8356793
[15:48:50] *** Quits: gkostyanikov (gkostyanik@67DBF1F9.2AEE264E.CA6E2165.IP) (Ping timeout)
[15:49:33] <cmr> mwillsey: ProcessConfig is parameterized by lifetime of the strings you give it
[15:49:43] <cmr> so your struct needs to be too.
[15:50:06] <cmr> that is, struct Job<'a> { config: process:ProcessConfig<'a>, bg: bool }
[15:50:32] <mwillsey> ah ok thank you
[15:51:16] <mwillsey> and when i need to impl Job, it still complains about a lifetime
[15:51:16] <WebeWizard> can someone link me the info on lifetimes? I've been avoiding them because i don't understand them
[15:51:54] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:52:14] *** Quits: Kxepal (Miranda@moz-81616591.pppoe.mtu-net.ru) (Ping timeout)
[15:52:34] <kimundi> mwillsey: If you want to impl methods for Job, you need to write a generic impl that is generic over the lifetime: impl<'a> Job<'a> { ... }
[15:52:35] *** Joins: Earnestea (earnest@moz-E86D50FA.dyn.plus.net)
[15:52:44] <Tobba> I think with how I designed everything I should be able to do something like this now
[15:52:44] <kimundi> WebeWizard: Just ask away
[15:52:45] <Tobba> let header = data.substruct::<ElfHeader>(0);
[15:52:50] <Tobba> this is going to rock
[15:52:59] *** Quits: dev14 (devarshdes@E5E7B410.3BA5A963.4A7DC8C.IP) (Quit: dev14)
[15:53:14] <kimundi> WebeWizard: But also: http://static.rust-lang.org/doc/master/guide-lifetimes.html
[15:53:28] *** Quits: dylukes (dylukes@moz-CBB6286B.wireless.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:53:28] <WebeWizard> kimundi: thanks, that's what i was hunting for :)
[15:53:30] <Tobba> heh
[15:53:36] <Tobba> documentation needs to also have @ killed off
[15:53:37] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[15:53:40] *** Quits: Earnestly (earnest@moz-E86D50FA.dyn.plus.net) (Ping timeout)
[15:53:41] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[15:53:51] <Mathuin> nope
[15:54:01] <Mathuin> it's only hidden behind a feature gate
[15:54:08] <kimundi> Tobba: Indeed
[15:54:09] <Tobba> its gonna get removed though
[15:54:18] <Mathuin> (btw, feature gates are a great idea)
[15:54:34] <derek_c> cmr: if only the Decoder trait had a `fn new(rd: &'a mut io::Reader) -> Decoder<'a>` and the Encoder trait had a `fn new<'a>(wr: &'a mut io::Writer) -> Encoder<'a>`, I would be able to make it generic
[15:54:39] <kimundi> The @ sigil at least has no reason to still be in the lifetime tutorial :P
[15:54:45] <Tobba> ^
[15:54:54] <derek_c> so that I could construct encoders/decoders in a generic way
[15:55:08] <kimundi> In fact, let me see if I can just remove it there...
[15:55:24] <derek_c> should I modify the Encoder and Decoder traits in libextra accordingly?
[15:55:28] *** Joins: bgmerrell (bgmerrell@moz-AFAF64AB.members.linode.com)
[15:55:34] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[15:55:34] *** ChanServ sets mode: +o jdm
[15:55:37] *** Joins: Kxepal (Miranda@moz-D214BAA1.pppoe.mtu-net.ru)
[15:57:30] <Tobba> is there a better way to do this
[15:57:37] <erickt> derek_c: I'm not sure if those should be static methods on Encoder/Decoder, but they could be good adaptor fns in serialize.rs
[15:57:37] <Tobba> I basicaly have something that returns an Option
[15:57:53] <Tobba> then I match that, if its none, the function returns none, otherwise I go on with the other stuff
[15:58:06] <Tobba> is there a way to do that without a lot of bollocks
[15:58:15] <Tobba> wait, everything is an expression, I just had an idea
[15:58:26] *** Quits: diverse (diverse@moz-ED94B8D.oc.oc.cox.net) (Ping timeout)
[15:59:05] *** flaper87 is now known as flaper87|afk
[15:59:23] *** Joins: ray (bernhard@moz-FF531B82.vie.surfer.at)
[16:00:03] *** Joins: diverse (diverse@moz-ED94B8D.oc.oc.cox.net)
[16:00:13] <ray> i saw Option as type, is this similar to haskells maybe and scalas option?
[16:00:59] <bstrie> ray: yes, exactly
[16:01:03] <ray> as for general concepts, do you program OOP in rust? or functional? or maybe like js with types?
[16:01:24] <lucian> rust's type system is in most ways a subset of haskell's
[16:01:43] <lucian> traits are type classes, enums are sum types, structs are product types
[16:01:57] <bstrie> ray: I'm not sure how to describe it. we don't have classes, so it's not really OOP as you'd expect from C++ or java.
[16:02:22] <ray> maybe a mix of scala and javascript?
[16:02:38] <lucian> it's basically strict haskell with C syntax
[16:02:53] <Tobba> oh yes
[16:02:54] <kimundi> Hm, I think rather than removing @ from the lifetime tutorial now, it would make more sense to wait for box to properly work with ~, Gc and Rc, and then use those new forms instead
[16:02:55] <Tobba> I can do this
[16:02:57] <Tobba> let header = match (data.substruct::<ElfHeader>(0)) { Some(data) => { data }, None => return None };
[16:03:00] <Tobba> this is excellent
[16:03:00] <ray> i see thanks :)
[16:03:02] <lucian> closer to scala than JS if anything, but much simpler in most ways
[16:03:21] *** Joins: AvianFlu_ (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[16:03:42] <ray> would you recommend learning haskell well before going rust?
[16:04:00] <ray> i think im lacking a bit in the functional department :P
[16:04:01] <Tobba> I never really learned haskell properly but I think I figured out rust just fine
[16:04:22] <bachm> rust is easier to learn than haskell imo
[16:04:32] <Tobba> I never liked haskell because its a goddamn mess
[16:04:35] <`achin> learn both at the same time!
[16:04:40] <kimundi> Tobba: Heh, now write a macro that encapsulates it as let header = unwrap_or_return_none!(data.substruct::<ElfHeader>(0)) ;)
[16:04:54] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:04:56] <Tobba> kimundi: I'll have to throw in an error code there too
[16:05:02] <Tobba> actually I should make some OptionError thing
[16:05:04] <lucian> ray: if you're comfortable with imperative languages, you'll likely learn rust faster than haskell
[16:05:13] <Tobba> where it can return an error code too
[16:05:15] <lucian> Tobba: Result?
[16:05:17] <kimundi> Tobba: We have that, its called Result
[16:05:21] <Tobba> ah
[16:05:27] <Tobba> I'll port that over then
[16:05:44] <kimundi> enum Result<T, E> { Ok(T), Err(E)}
[16:05:50] <Tobba> yeah
[16:05:53] <ray> and btw, rust is meant as a replacement for c++ right?
[16:06:00] <lucian> largely, yes
[16:06:01] <Tobba> pretty much I guess
[16:06:16] <ray> ok good, will look into it then :) thanks so far
[16:06:18] <Tobba> I'm writing a kernel/OS, aiming to not have a single bit of C++ in there
[16:06:28] <Tobba> except for maybe LLVM, because I'm not gonna rewrite that shit
[16:06:57] <kimundi> ray: Well, not "meant", but its goal is certainly to be good at where C++ is good at and provide memory safety in addition to that
[16:07:30] *** Quits: Ferreus (ferreus@moz-103584E6.dip0.t-ipconnect.de) (Ping timeout)
[16:07:31] <kimundi> So, it can be seen as a possible replacement of C++
[16:07:34] <ray> yeah, i just want to have something with the same benefits because i hate c++
[16:07:54] <Tobba> I dont really hate C++ but, but C++ is really shitty
[16:07:55] <`achin> can't rust also be seen as a replacement for C?
[16:07:58] <kimundi> Heh, I'm still waiting for someone to write a "C++ for Rustics" for me ;)
[16:08:08] <Tobba> hahahaha
[16:08:14] <Tobba> C++ is basicaly C with a tumor
[16:08:23] <ray> Tobba: well said :D
[16:08:33] <kimundi> Serioslly, all I know about C++ I learned from lurking in this channel
[16:08:43] <lucian> `achin: sure, Rust is still way simpler than C++
[16:08:47] <ray> and undefined behaviour
[16:08:54] <Tobba> hahaha yeah
[16:08:55] <bstrie> ray: honestly you can write Rust in the style of C and it will work just fine
[16:08:59] <Tobba> clang is an asshole with undefined behaviour too
[16:09:11] <Tobba> if you say, forget a return statement, its undefined behaviour
[16:09:15] <igork> noob question, is this the shortest way to init struct variable with default values? 
[16:09:16] *** Quits: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca) (Quit: canhtak)
[16:09:20] <Tobba> so they call it intentional that it marks it unreachable and dies in a fire
[16:09:21] <`achin> (for example, you'd often write a C library if you wanted something that can be bound to any other language.  rust would also be a good choiceh ere)
[16:09:21] <bstrie> anyone saying that writing rust is like writing haskell is drastically misleading you :P
[16:09:33] <Tobba> rust has the good parts of haskell basicaly
[16:09:37] <kimundi> `achin: (Btw, tab completing your name is annoying on a German keyboard :P)
[16:09:38] <igork> let x : MyStruct = Default::default();
[16:09:43] <bstrie> just because we also have a strict compiler doesn't mean that the languages themselves feel the same at all
[16:09:54] <bstrie> we're not pure and we're not lazy and we don't have monads
[16:10:02] <`achin> kimundi: i tried to pick a name that woudln't cause people to tabcomplete me instead of acrichto.  i'm not sure i've succeded
[16:10:12] <`achin> would an underscore be better?
[16:10:13] <kimundi> igork: Well, its certainly not the shortest one, but the recommended one for a default value
[16:10:20] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[16:10:25] <igork> i thought it was something like: let x  = MyStruct {}
[16:10:25] <lucian> bstrie: and no higher-kinded types :)
[16:10:33] *** Joins: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca)
[16:10:39] <kimundi> `achin: Oh, you succeded alright ;)
[16:10:52] *** Joins: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[16:10:57] *** `achin is now known as _achin
[16:11:07] <bstrie> lucian: yes, it's a feature of rust to not have that feature :P we can't have people saying that rust is just "C++ with monads", that would be awful awful marketing that we'd never live down
[16:11:09] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Connection reset by peer)
[16:11:12] <kimundi> `achin: In my case a _ would be nicer, but you don't need to change it just because of that :P
[16:11:13] <igork> kimundi: got it, thanks
[16:11:14] <_achin> maybe this will be better
[16:11:16] <bachm> rust has many convenient features such as immutable by default
[16:11:18] <bstrie> monads are verboten
[16:11:30] <lucian> bstrie: i said nothing about monads! :)
[16:11:41] <lucian> bstrie: just Promises, or something
[16:11:46] <bstrie> you said HKT!! and once you have those, people will feel the despicable urge to write monads :)
[16:11:57] <bstrie> who even needs a functor anyway!!
[16:12:16] * lucian raises hand
[16:12:36] * kimundi throws his todays university assignment that involved haskell at bstrie
[16:12:48] <Tobba> what really makes me love rust is that while writing this kernel, I've never crashed anything with code that hasent messed with the CPU (which I've pretty much only crashed by passing invalid task state segments)
[16:12:53] * bstrie throws kimundi at lucian 
[16:13:15] <Tobba> oh and traits
[16:13:18] <Tobba> traits rock
[16:13:18] <_achin> there's a lot of throwing in here
[16:13:30] * kimundi does a backflip around lucian, but then lands wrong and akwardly falls down
[16:13:40] <WebeWizard> surround it with try/catch
[16:13:40] *** Joins: mib_zs8ps1 (Mibbit@moz-DF071ACF.ds1-aboes.adsl.cybercity.dk)
[16:14:14] <kimundi> Tobba: That's the haskell effect. Once you finally convinced the compiler, code is usually correct :P
[16:14:15] * lucian re-sheaths his applicative
[16:14:33] <Tobba> yep
[16:15:03] <Tobba> I've actually sort of got multitasking, but no actual syscalls so I cant run anything, heh
[16:15:10] <lucian> bstrie: i would say that while most code looks and feels nothing like haskell, the APIs you build and the abstractions you use end up being similar
[16:15:12] <kimundi> nice
[16:15:22] <Tobba> read: sort of
[16:15:38] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:15:50] <bstrie> lucian: I don't know about that... we don't have custom operators really
[16:16:05] <bstrie> seems like APIs would be much different
[16:16:20] <lucian> bstrie: well ADTs and traits expressing the same idea can only vary so much
[16:16:20] *** Joins: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net)
[16:16:36] *** Joins: litfan (Mibbit@moz-6B63129B.micron.com)
[16:16:37] <Tobba> oh and, I want to do this sort of like this right
[16:16:39] <Tobba> fn substruct<T, 'a>(&self, offset: uint) -> Option<&'a T> {
[16:17:03] <Tobba> the return value will refer to data only valid as long as where it came from lives
[16:17:45] <bstrie> heh, this is the first time in memory that I haven't had to change the examples in the wikipedia article between versions
[16:17:46] *** Joins: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP)
[16:17:59] <Tobba> hahahaha
[16:18:03] *** Quits: jvoorhis (jvoorhis@moz-E191DB04.ptld.qwest.net) (Ping timeout)
[16:19:10] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:22:01] <kimundi> Tobba: What is this code example meant to do exactly?
[16:22:19] <Tobba> basicaly, I have an array of anything
[16:22:27] <Tobba> in this case, u8's
[16:22:51] <kimundi> Ah, so it is a array, okay
[16:22:52] <Tobba> the function gets a reference to a struct, with its pointer inside of the data of the array
[16:23:00] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[16:23:02] <kimundi> fn substruct<T, 'a>(&'a self, offset: uint) -> Option<&'a T> should express that nicely
[16:23:25] <Tobba> so basicaly, if I have an elf file as a [u8], I can get the header by doing substruct::<ElfHeader>(0)
[16:23:33] <Tobba> woo safety
[16:25:06] <kimundi> hm, its not really safe though, is it? If you pass the wrong offset, you get garbage casted to the ElfHeader
[16:25:28] <Tobba> it does length checks
[16:25:30] <Tobba> returns an Option
[16:25:39] <Tobba> if you get a None, that means it didnt fit
[16:25:45] <kimundi> well sure
[16:25:53] <kimundi> but what if you do substruct::<ElfHeader>(1)
[16:26:16] <kimundi> I mean that kind of possible unsafety :)
[16:26:19] <Tobba> it gets it at offset 1, if it doesnt fit, returns None
[16:26:28] <Tobba> oh
[16:26:31] *** Quits: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[16:26:32] <Tobba> hm
[16:26:38] <Tobba> I need to make sure its readonly structs I guess
[16:26:43] <Tobba> otherwise overlaps are unsafe
[16:26:56] <Tobba> it doesnt return mutables anyways actually
[16:26:57] <kimundi> that is already enforced by the &'a self
[16:27:05] <Tobba> hm yeah
[16:27:12] <Tobba> it should be safe then
[16:27:59] <bstrie> eevee: much as I hate to temper your enthusiasm, it would be a mistake to consider 0.9 as a stable anything :P
[16:28:06] <kimundi> but yeah, overlaps and similar are problems that are still technically possible - of course you could just say "this is good enough" - I don't think the code gets nicer if you try to solve it properly
[16:28:49] <kimundi> Tobba: What are the types the fields of ElfHeader are defined as?
[16:29:07] <Tobba> its just craploads of integers of varying sizes?
[16:29:20] <kimundi> Depending on type, you could initialize them with an out of range value, which can introduce memory unsafety
[16:29:27] *** Joins: entro (centro@moz-6398EFDF.dclient.hispeed.ch)
[16:29:32] <Tobba> I mean yeah the substruct thing is kinda unsafe
[16:29:34] <kimundi> okay, that would not lead to unsafety directly
[16:29:40] <Tobba> its not perfect but eh
[16:29:46] <kimundi> yeah, good enough
[16:29:51] <Tobba> as long as you dont shove pointers in there its fine
[16:30:05] <Tobba> modifying the array it points to is probably a bad idea too
[16:30:30] <Tobba> I dont think I can solve it cleaner than this though
[16:30:34] <kimundi> Tobba: The compiler won't led you, as long as you have the & borrow
[16:30:42] *** Joins: mib_6jhc21 (Mibbit@28FA4E2A.CB253588.4A5F0685.IP)
[16:31:07] <Tobba> should have a builtin trait for structures without pointers
[16:31:09] *** Joins: maxli (maxli@moz-B19F68ED.student.cs.uwaterloo.ca)
[16:31:15] <Tobba> would be able to make this perfectly safe with that
[16:31:28] <kimundi> As long as you have a & reference to any part of a type laying around, that variable is immutable
[16:31:43] *** Quits: maxli (maxli@moz-B19F68ED.student.cs.uwaterloo.ca) (Quit: Leaving.)
[16:32:02] *** Joins: hashbang42 (Mibbit@5B66D85A.3A7C9FB1.FFE8C4AF.IP)
[16:32:15] *** Joins: achim (achim@moz-C6C49A81.dip0.t-ipconnect.de)
[16:32:53] *** Joins: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP)
[16:32:56] *** Quits: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[16:33:24] *** Quits: hashbang42 (Mibbit@5B66D85A.3A7C9FB1.FFE8C4AF.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:33:28] *** Joins: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP)
[16:34:01] *** Joins: shmoo (Mibbit@moz-7BDD1761.fbx.proxad.net)
[16:34:33] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[16:34:57] *** Quits: shmoo (Mibbit@moz-7BDD1761.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[16:35:00] *** Joins: SiegeLord (sl@DA150354.2815CC0B.9BCC850D.IP)
[16:35:09] *** Joins: schmoo (Mibbit@moz-7BDD1761.fbx.proxad.net)
[16:35:48] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[16:36:21] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[16:37:50] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[16:38:44] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[16:40:05] *** Quits: wting (wting@E31B3884.E538DA90.20F09BA6.IP) (Quit: leaving)
[16:41:23] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[16:41:38] *** Quits: litfan (Mibbit@moz-6B63129B.micron.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:42:12] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[16:43:04] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[16:43:06] <Tobba> Rust makes error handling such a breeze though, its amazing
[16:43:07] *** Joins: chaliy (Mibbit@ADB0F19.9A083485.A602395A.IP)
[16:43:14] <Tobba> in C and C++ error handling was madness
[16:44:20] *** Joins: wting (wting@E31B3884.E538DA90.20F09BA6.IP)
[16:45:02] <chaliy> Hello, is there any lib for rust to work with XML in DOM model?
[16:47:07] <Tobba> I dont think theres an XML lib atm
[16:47:13] <Tobba> that shouldent be too hard to write though
[16:47:26] <Mathuin> I don't fully agree with you Tobba 
[16:47:36] *** Quits: alsm (asm@660E716B.CAAD3E7C.524E1A8C.IP) (Ping timeout)
[16:47:50] <Mathuin> in C there's errno and the handy err() and errx() BSD extensions
[16:47:58] <benh> Tobba: because of Result and pattern matching?
[16:48:03] <Tobba> p much
[16:48:11] <Tobba> also because you dont need 10 lines of cleanup code all over the place
[16:52:15] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[16:52:50] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:52:50] *** ChanServ sets mode: +ao dherman dherman
[16:52:54] *** Quits: derek_c (derek@F79E2534.80543B4A.7E5576EA.IP) (Ping timeout)
[16:53:03] *** Joins: Matthias247 (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de)
[16:53:25] <chaliy> @Tobba thank you for response, but this does not sound like a solution for me, XML is quite complex
[16:53:50] <Tobba> actually yeah, XML is pretty complex if you want to parse it properly
[16:53:56] <kvark> Where did std::io::Decorator go?
[16:53:58] <bstrie> have you tried using regexes?
[16:54:01] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[16:54:36] <Mathuin> XML can't be parsed by regexes
[16:54:48] <Mathuin> use a proper parser
[16:54:57] <Mathuin> I'd advise using JSON instead of XML
[16:55:13] <Ms2ger> I'd advise most things instead of XML :)
[16:55:14] <Tobba> depends on what you're doing
[16:55:33] <Tobba> suddenly reminded of those applications that have json config files + a strict parser
[16:55:44] <Tobba> I hate whoever came up with that
[16:55:44] <Mathuin> XML is a pain to parse
[16:55:59] <bstrie> Mathuin: nah regexes can do EVERYTHING
[16:56:01] <Mathuin> and for config files, I'd use a Lua DSL
[16:56:07] <Mathuin> false bstrie 
[16:56:10] <bstrie> I program entirely in regexes
[16:56:11] <kimundi> http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags
[16:56:19] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[16:56:20] *** Joins: pyon (user@A16F2BE6.A9B419CB.1C8C8CE9.IP)
[16:56:29] <Mathuin> it's proven that they can't match stuff with nested parenthesis IIRC
[16:56:31] <bstrie> I wrote a javascript transpiler so that I can manipulate the DOM via regexes
[16:57:05] <Ms2ger> Mathuin, theoretical regixes can't
[16:57:19] *** Quits: mib_zs8ps1 (Mibbit@moz-DF071ACF.ds1-aboes.adsl.cybercity.dk) (Quit: http://www.mibbit.com ajax IRC Client)
[16:57:20] <bstrie> Mathuin: I was actually performing an experiment to see how long it would take for someone to post kimundi's stack overflow link
[16:57:34] <bstrie> three minutes
[16:57:35] <bstrie> disappointing
[16:57:38] <kimundi> Darn real world, muddling up perfectly fine definitions of regular expressions :P
[16:57:51] <Ms2ger> But most regex implementations can do more than regular languages
[16:58:49] <Tobba> I just realized how shitty porting this to big endian machines is gonna be
[16:58:53] *** Quits: Fatalnix (bhodgins@moz-1F0BEDCC.static.gwi.net) (Quit: Lost terminal)
[16:59:01] <Tobba> solution: screw big endian
[16:59:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:59:23] <Tobba> I dont think anything actual uses it except for mipsbe, and nearly all of those have mipsel modes too dont they
[16:59:46] <lucian> ppc
[16:59:50] *** Joins: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[17:00:01] <Tobba> powerpc is big endian?
[17:00:04] <kimundi> Tobba: just put a #[cfg] attribute around your code, that replaces your kernel with a single function that prints out NOPE! on big endian machines :P
[17:00:09] <bstrie> no, particle projection cannons
[17:00:17] <lucian> yep. it does tend to have instructions to manipulate le data
[17:00:26] <Tobba> kimundi: printing code is dependant on byte order
[17:00:27] <Matthias247> ARM can also use BE
[17:00:36] <Tobba> yeah but noone actually does that
[17:00:40] <Tobba> unless you're manipilating BE data
[17:00:42] <lucian> Matthias247: yeah, but modern arm is le, and ARM64 is strictly le
[17:00:47] <Mathuin> «While it is true that asking regexes to parse arbitrary HTML is like asking Paris Hilton to write an operating system, it's sometimes appropriate to parse a limited, known set of HTML.»
[17:00:57] <lucian> as odd as le is to humans, it's kind of the default
[17:00:58] <Mathuin> may be true for XML 
[17:01:03] <Tobba> actually, someone should add a specifier that explictly specifies which byte order a field is stored in
[17:01:05] <kimundi> Tobba: print ONPE\n! then :P
[17:01:12] <Tobba> with automatic swapping
[17:01:21] <Tobba> kimundi: it'd end up writing the character as the color
[17:01:21] <bstrie> lucian: haha, I thought by "le data" you were just lapsing into french...
[17:01:26] <Tobba> you'd just see rainbow gibberish
[17:01:37] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:01:39] <kimundi> Just like in old homecomputers!
[17:01:51] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[17:01:57] <lucian> bstrie: hah. i should CAPITALIZE things for clarity, i'm probably scarred by SQL inputs without syntax highlighting
[17:02:17] *** Joins: dylukes (dylukes@moz-B8E82644.wireless.pitt.edu)
[17:02:22] <pyon> What is the difference between File::open_mode raising an error condition and returning None?
[17:02:23] <kvark> where did std io Decorator go?
[17:02:37] <kimundi> kvark: What did that do?
[17:02:55] <Matthias247> the question I'm always asking myself is why BE is used for network procotols when nearly every cpu has to change it to LE
[17:03:06] <kimundi> kvark: I know that the whole io module got replaced since 0.8, maybe it just doesn'T have a new incarnation?
[17:03:19] *** Quits: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:03:24] <kvark> kimundi: I assume it accessed the internal buffer of Writer/Reader
[17:03:31] <Tobba> I dont know
[17:03:33] *** Quits: mleise (marco@moz-850E56A9.pools.arcor-ip.net) (Quit: Leaving.)
[17:03:33] <lucian> Matthias247: that was not always the case. also, BE is easier for humans by a bit
[17:03:35] <Tobba> networking in general is a wreck
[17:03:36] <kvark> kimundi: must have changed very recently
[17:03:45] <Tobba> honestly, LE is easier for me at this point
[17:03:54] *** Joins: jhasse (jhasse@moz-3B266AF0.ewe-ip-backbone.de)
[17:04:00] <Tobba> I read numbers in the wrong order sometimes nowadays
[17:04:04] <Matthias247> lucian: yes.  I also find BE easier to read
[17:04:32] <Tobba> left being least significant actually makes a lot more sense
[17:04:38] <Tobba> its just about getting used to it
[17:05:00] <Matthias247> but normal number systems are the other way :)
[17:05:22] <Tobba> who gives a shit about normal people anyways
[17:05:25] <lucian> that might be offensive to people that speak RLT languages
[17:05:42] <Tobba> <insert unicode RTL here>
[17:05:51] <Matthias247> and the contents of the LE data (bits or decimal numbers) are also displayed most significant first
[17:05:52] <Tobba> which idiot designed the unicode control code stuff anyways
[17:05:55] <Tobba> that shit is a goddamn nightmare
[17:05:56] *** jdm is now known as jdm|f00ding
[17:06:10] <Tobba> and the only way to strip them is a lookup table iirc
[17:06:42] <lucian> Tobba: i believe they're like that so you can freely mix RTL and LTR text
[17:06:52] <Tobba> yeah but its rediclous
[17:06:57] <Tobba> they're plastered all over the unicode space iirc
[17:07:04] <Tobba> and theres a crapload of them
[17:07:15] <Tobba> and no proper way to isolate them
[17:07:26] <Tobba> so you need to write code to add additional controls to cancel the previous ones out, its a massive wreck
[17:07:30] *** Quits: atomical (atomical@moz-DEDB4821.nuwlan.northwestern.edu) (Quit: atomical)
[17:07:47] <Tobba> http://xkcd.com/1137/
[17:07:52] *** Quits: jadbaires (jadrian@moz-9AE9F7C5.dsl.telepac.pt) (Quit: Konversation terminated!)
[17:07:59] *** Joins: jadbaires (jadrian@7C3E5A47.7DF3BC65.6119BA41.IP)
[17:08:11] *** Joins: derek_c (derek@moz-497E6734.tmlgb.datafoundry.com)
[17:08:26] <Tobba> not to mention unicode lets you do bollocks like zalgo text
[17:08:36] <Tobba> which generally breaks everything and is a nightmare to deal with
[17:08:56] <Tobba> h̵̰̘̦̖͖̹ͦ̇ͫ̔ͨ̓ͥ̏ͨ͡e̢̨̍̂́̅̓̃ͪ͋ͣ͗͏̵͓̻͔̮̰̖̣̝ͅ ̵̛̲̮̗̤͎͉̦̘̘̉̊̉̑ͦ͐̿̈ͬ̚͘c̵̷͕̭͇̳̺̣͕̖̰̰͓͚͓͒͛̅͋̉̑ͮ̊͌ͦ́͡ͅo̿ͧ́̈̾͗̏͛̏͏̟̺̹͚m̑̉̈͆ͤͧ͗̿͊̑̂͛͌̀̚̕҉͙̖̼̗͟e̡̨͔̲͍̺̜̹̼̎̿ͣͮͣͫ̈́̈ͤͨ̇̀ͫ̅ͪ́̚͢͞ş͈̩͍̭̣̯̂ͪͤ̉͛ͤ̒͐͒͘ͅ
[17:08:56] *** Quits: pyon (user@A16F2BE6.A9B419CB.1C8C8CE9.IP) (Client exited)
[17:09:10] *** Quits: negativezero (negativeze@moz-AF1C6D8D.nyc.res.rr.com) (Ping timeout)
[17:09:11] <Mathuin> «Never mind the bollocks, ...»
[17:09:32] <benh> Looks like my terminal is zalgoproof :D
[17:09:34] *** Quits: mib_6jhc21 (Mibbit@28FA4E2A.CB253588.4A5F0685.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:09:35] <Tobba> for most HTML based stuff, zalgo text breaks so much stuff
[17:09:42] <Tobba> hexchat is also zalgoproof, it just crams it all in a single line
[17:10:00] <Tobba> benh: though that probably means japanese is broken or something
[17:10:07] <Tobba> full width characters woo *barf*
[17:10:11] *** Joins: alonlevy (alon@moz-30492E92.bb.netvision.net.il)
[17:10:50] <benh> I don't speak it anyway, I hope the japanese have the good sense to use a better terminal ;)
[17:11:20] <benh> though japanese looks better than zalgo in the terminal at least
[17:11:59] <Tobba> and lets not forget
[17:12:00] <Tobba> 💩 
[17:12:08] <Tobba> (still no klingon)
[17:12:10] *** Joins: atomical (atomical@moz-C92D67E2.library.northwestern.edu)
[17:14:23] <whitequark> Tobba: well, unicode is complex, because its domain is complex
[17:14:36] <Tobba> also because they screwed it up and clusterfucked it to no end
[17:14:50] <Tobba> the only way to deal with it is massive sprawling lookup tables per-character
[17:14:51] <whitequark> and all other options are even worse.
[17:14:59] <Tobba> and those are a pain in the ass to deal with because they just tossed everything around
[17:15:30] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[17:15:40] <derek_c> is there a limit for how large a vector can be
[17:15:41] <derek_c> ?
[17:15:43] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:15:58] <Ms2ger> Yes, it's bounded by the available memory
[17:16:23] <Ms2ger> And I suspect by the range of a uint
[17:16:32] <derek_c> Ms2ger: that's what I was wondering
[17:16:56] <derek_c> how to index into a vector if it has more than the max uint of elements
[17:17:27] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:18:10] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[17:18:18] *** Joins: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP)
[17:18:20] <Tobba> if you have more than max of uint
[17:18:28] <Tobba> you have definitely exceeded your available memory
[17:18:38] *** Quits: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP) (Quit: dev14)
[17:18:55] <Tobba> uint is a u64 on 64 bit iirc
[17:19:02] <Tobba> and u32 on 32 bit
[17:19:17] <dylukes> Is it legal to get a reference to a closure?
[17:19:17] <Tobba> if you exceed that you'll be using far more than the memory limit of the addressing model anyways, so yeah
[17:19:29] <kimundi> it is impossible to have more than uint max value items in a vector, as the machine could not address them all
[17:19:42] *** Quits: chaliy (Mibbit@ADB0F19.9A083485.A602395A.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:19:52] *** Joins: Ferreus (ferreus@moz-82D586A6.pools.arcor-ip.net)
[17:19:57] <kimundi> dylukes: You can get a reference to anything, as long as the lifetimes match
[17:21:07] <dylukes> Hm.
[17:23:30] <dylukes> um
[17:23:34] <dylukes> I think I might have found a bug :|
[17:23:44] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:23:47] <Tobba> file an issue!
[17:24:01] <Tobba> (well, ask in the IRC first if you're not sure)
[17:24:15] <dylukes> I'm confirming... I've just somehow broken stdout
[17:24:22] <dylukes> or at least this program compiles, and then silently fails..?
[17:24:34] <dylukes> oh wait
[17:25:09] <Tobba> segfaults?
[17:25:49] <dylukes> :0
[17:25:51] <dylukes> I think I got it.
[17:25:55] <dylukes> and no, that was me being silly.
[17:25:56] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[17:26:13] *** Quits: ray (bernhard@moz-FF531B82.vie.surfer.at) (Quit: Leaving.)
[17:26:13] *** Joins: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr)
[17:26:27] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[17:28:08] *** Quits: synackse (jordyd@moz-5289C68.jax.bellsouth.net) (Ping timeout)
[17:28:13] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[17:29:04] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[17:29:25] <derek_c> what's the best way to create a string of the same char?
[17:29:28] <derek_c> like 0000000000000000
[17:29:34] <derek_c> given a length?
[17:30:33] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[17:30:35] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[17:30:50] *** vfetwnuncszu is now known as dcrewi
[17:31:18] *** Joins: pyon (user@A16F2BE6.A9B419CB.1C8C8CE9.IP)
[17:32:00] <pyon> Is there any function to create a large ~[u8], without explicitly initializing its contents to anything in particular?
[17:32:15] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[17:32:28] <cmr> pyon: vec::with_capacity(n)
[17:32:35] <pyon> cmr: Nice, thanks!
[17:32:38] <cmr> the *length* will be 0, but it will be an n-sized allocation.
[17:33:03] <cmr> it's a bit unfortunate that the cheatsheet isn't on a wiki anymore, it's a pain to have to go through a PR to change it.
[17:33:22] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:33:30] <Tobba> why is size_of unsafe
[17:33:44] <cmr> Tobba: is it?
[17:33:46] <cmr> which size_of
[17:33:50] <Tobba> the intrinsic
[17:33:54] <Tobba> apparently, at least
[17:33:56] <cmr> ah all intrinsics are unsafe.
[17:34:04] <cmr> I think there's an issue open for that somewhere.
[17:34:14] <Tobba> yeah that should probably be fixed, lots of them arent unsafe
[17:34:17] <cmr> it's because all fn decls in an extern { } are unsafe.
[17:34:20] *** Quits: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP) (Connection reset by peer)
[17:35:07] <Tobba> all different number types should be comparable too
[17:35:11] *** Joins: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP)
[17:35:18] <dylukes> Hm
[17:35:19] <Tobba> since theres really no reason you cant compare them
[17:35:21] <dylukes> well now I have "This message reflects a bug in the Rust compiler."
[17:35:23] <dylukes> So... 
[17:35:31] <Tobba> adding different integer types is weird, but theres nothing wrong in comparing them
[17:35:46] <cmr> Tobba: it'd be doable with the overloading hack
[17:35:57] <Tobba> hm yeah
[17:35:59] <Tobba> it should be default though
[17:36:05] <cmr> I do not agree.
[17:36:40] <cmr> well
[17:36:41] <cmr> maybe
[17:36:51] <Tobba> it would avoid programmer stupidity
[17:37:15] <Tobba> if you want to compare a float to an integer you would probably cast the integer to a float, while casting the float to an int might perfectly make sense and be faster
[17:37:38] <pyon> Tobba: So 2.2 == 2 by default???
[17:37:46] <Tobba> nah
[17:38:04] <Tobba> just stuff like 2.2 > 2
[17:38:08] *** Quits: synackse (jordyd@moz-5289C68.jax.bellsouth.net) (Quit: synackse)
[17:38:16] <Tobba> the compiler can probably figure that stuff out easier than the programmer
[17:38:40] *** Joins: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr)
[17:38:47] <Matthias247> I think no implicit conversions apart from the safe ones is fine
[17:38:52] <pyon> Tobba: Admittedly, explicitly casting numeric types is annoying, but it is faaar less annoying than bugs caused by implicit casting.
[17:39:00] <Tobba> it wouldent really be a conversion
[17:39:10] <Tobba> it would just be that the operator supports all types and can figure out what to do with them
[17:39:14] <Tobba> not just floats, differently sized integer types too
[17:39:27] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[17:39:49] *** Joins: dredozubov (dredozubov@EC6EC1F6.27163FAA.806C54C8.IP)
[17:40:15] <SingingBoyo> rusti: 2.2 as int > 2
[17:40:24] <Tobba> it would be more like
[17:40:33] <Tobba> 2.2 > 2 as float
[17:40:54] <Tobba> okay, maybe not on float types
[17:41:01] <Tobba> since equals with floats gets weird as heck
[17:41:08] <pyon> Tobba: Narrowing and extending introduces covariance/contravariance hell.
[17:41:10] <Tobba> but it makes perfect sense with differently sized integers
[17:41:26] <Tobba> plus I think llvm supports that
[17:41:55] *** Joins: flu- (chain@moz-5E956C03.se.net)
[17:41:57] <icebattle> What is the syntax for a fn that returns a function?
[17:42:14] <Tobba> fn foo() -> fn() I think
[17:42:20] *** Joins: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP)
[17:42:24] <flu-> Greetings! Any rust-bindgen users lurking about that wouldn't mind helping me build the latest master by chance?
[17:42:36] *** Quits: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[17:42:37] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[17:42:47] <pyon> icebattle: The syntax for a function type is "|ParamType, ParamType, ParamType| -> ResultType" starting from 0.9, me thinks.
[17:43:04] <kimundi> icebattle: What kind of function? We have stack closures, raw function pointers, once-callable heap closures
[17:43:18] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[17:43:24] <benh> rip, returning multiply-callable heap closures :(
[17:43:45] <cmr> pyon: that's a closure, not all function types.
[17:43:48] <Tobba> I wonder if multiple return values would be feasible
[17:43:49] <pyon> Oh.
[17:43:55] <benh> Tobba: tuples
[17:43:56] <Tobba> I guess you could return a tuple
[17:43:57] <Tobba> yeah
[17:44:04] <kimundi> benh: Eh, they will return somehow once closures generate unique types :P
[17:44:29] *** Quits: alonlevy (alon@moz-30492E92.bb.netvision.net.il) (Ping timeout)
[17:44:32] <benh> Yeah but there's someone on the ml who can't do their homework until then
[17:44:40] <icebattle> Looking for a regular stack closure
[17:45:02] <kimundi> icebattle: 'a |A, ...| -> B then
[17:45:17] *** Joins: judder (maradukewa@391D0079.5121DAAD.78E362FE.IP)
[17:45:18] <icebattle> I want to be able to hand that function off to other functions, though
[17:45:22] <pyon> icebattle: I would simply return a regular struct that only exposes certain desired functions in its impl.
[17:45:37] <icebattle> that's a possibility, I guess
[17:46:15] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:46:16] *** ChanServ sets mode: +ao brson brson
[17:46:38] <pyon> Errr... actually s/certain desired functions/a single function/
[17:47:07] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:47:52] <dylukes> hrm
[17:48:00] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:48:30] *** Joins: bheylin (brianheyli@moz-8255E94E.adsl.online.nl)
[17:48:52] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:49:00] <dylukes> I'm having trouble getting a closure to be accepted for assignment to a reference to it as a trait...
[17:49:00] <bjz> flu-: yeah I'm not sure how many folks are using it
[17:49:11] <bjz> flu-: I normally hand write my bindings
[17:49:15] <dylukes> things like 
[17:49:16] <dylukes> error: mismatched types: expected `&H` but found `&|A| -> C` (expected type parameter but found fn)
[17:49:21] <bjz> flu-: I find it easier
[17:49:35] *** Quits: dylukes (dylukes@moz-B8E82644.wireless.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:49:51] <bjz> flu-: jack might have some libs using bindgen in servo though
[17:49:51] <SiegeLord> flu-, If you need any help, then it's probably because your rustc is too old, or rust-bindgen hasn't been updated
[17:50:12] *** Quits: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net) (Ping timeout)
[17:50:15] <jack> bjz, flu-: we don't use bindgen that i know of. at least not past the intiial skeleton
[17:50:20] *** jdm|f00ding is now known as jdm
[17:50:23] <jack> we hand edit them now
[17:50:27] <bjz> yeah
[17:50:41] <bjz> I find bindings need humans involved
[17:50:44] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:50:47] <jack> i think the rust-egl stuff was generated initially, then hand edited after that.
[17:50:58] <SiegeLord> They do... but rust-bindgen is a better starting point than the original header ;)
[17:50:59] <jack> that's the newest binding we've added
[17:51:05] <flu-> SiegeLord: I'm on the latest rustc from master (built last night) and the latest rust-bindgen master (from this morning)
[17:51:09] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[17:51:19] <jack> for starters, rust-bindgen better be doing allow(dead_code) or you will get a ton of warnings.
[17:51:37] <flu-> I may be facing a clang library issue. The problem is undefined reference errors for a number of clang_* functions
[17:51:57] <SiegeLord> Oh right, forgot about that... you need a recent clang for it
[17:52:11] <flu-> bjz: I'm trying to update the ImageMagick library bindings, hand writing those isn't exactly my idea of fun :-)
[17:52:28] <Tobba> is there any way to make dynamicaly sized types right now
[17:52:31] <bjz> Ahh... ImageMagick -_-#
[17:52:34] <Tobba> I have this constructor function
[17:52:36] <flu-> SiegeLord: That figures. Ubuntu isn't the speediest about keeping their packages up to date
[17:52:43] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[17:52:44] <SiegeLord> I built my own clang for bindgen
[17:52:49] <Tobba> I want it to return a type where the size depends on the contents
[17:52:52] <SiegeLord> Kind of a pain, but doable
[17:52:55] <flu-> I'll go down the path of building from source! Time to stay brave
[17:53:01] <SiegeLord> Good luck!
[17:53:03] <Tobba> that or I could somehow allocate its data on the stack but I dont see how it'd work
[17:53:17] <flu-> thanks!
[17:53:18] <bjz> flu-: welcome to the wonderful world of rust :D
[17:54:08] <kimundi> Tobba: If you want to return something with varying size, you need pointer indirection
[17:54:15] <kimundi> Tobba: And then use trait objects
[17:54:21] <Tobba> how would I do that
[17:54:24] *** Joins: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net)
[17:54:26] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[17:54:48] <kimundi> fn() -> ~Trait { ~value_that_implements_trait }
[17:54:58] <Tobba> oh boy
[17:54:59] <kimundi> fn foo() -> ~Trait { ~value_that_implements_trait }
[17:55:03] <Tobba> that needs the heap sadly though?
[17:55:09] <Tobba> was trying to avoid that since this is solely on the stack
[17:55:13] <kimundi> well, & is also possibkle
[17:55:24] <benh> I don't think codegen can deal with variably-sized return types.
[17:55:41] <pyon> Are stack closures always non-copyable?
[17:55:45] <kimundi> fn foo<'a>(a: &'a A) -> &'a Trait { a }
[17:55:53] <kimundi> pyon: yes
[17:56:04] <Tobba> I can just declare it fixed, but eh
[17:56:13] *** Quits: schmoo (Mibbit@moz-7BDD1761.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:56:14] <Tobba> I kinda wanna get away from all restrictions
[17:56:16] <pyon> kimundi: What if the closure only closes over copyable stuff? Even then?
[17:56:19] <derek_c> do you guys receive Bitcoins for contributing to Rust?
[17:56:24] <derek_c> I just did
[17:56:26] <whitequark> derek_c: yeah
[17:56:27] <kimundi> pyon: even then
[17:56:34] <derek_c> oh well
[17:56:45] <derek_c> that should be on the contribution guide :)
[17:57:05] <cmr> it's some silly third-party service.
[17:57:06] <benh> I don't think it's an official feature
[17:57:16] <derek_c> realistically, I just need 100000000000 more commits to become a billionaire
[17:57:30] *** Parts: gkw (fuzz2lin@moz-BBE3ABD.mv.mozilla.com) ()
[17:57:41] <kimundi> Tobba: You can allocate the object on the stack even, if you do this: fn foo(f: |&Trait| ) { let x = value_implementing_trait; f(&x); }
[17:57:59] <Tobba> I have no idea what is going on there
[17:58:04] <kimundi> And then call like foo(|traitobject|  { /* my code */ })
[17:58:12] *** Quits: dredozubov (dredozubov@EC6EC1F6.27163FAA.806C54C8.IP) (Input/output error)
[17:58:49] <Tobba> hm
[17:58:57] *** Joins: dylukes (dylukes@moz-29F81A5.wireless.pitt.edu)
[17:59:06] <kimundi> Of course, I don't know your exact usecase, so this might not help you :P
[17:59:15] <Tobba> yeah I dont think it does
[17:59:22] <Tobba> basicaly, I have an ElfLoader struct
[17:59:30] <Tobba> it has this constructor thing that does the loading
[17:59:39] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:59:42] <Tobba> I have to keep track of all the segments I loaded for the address translation later on
[17:59:50] <Tobba> the number of segments is known beforehand
[17:59:51] *** Joins: cheese_cast (raspinudo@moz-FB14AB08.hsd1.ca.comcast.net)
[18:01:11] <Tobba> actually, could unsized types help here?
[18:01:15] <Tobba> even though they're not implemented yet
[18:01:25] <pyon> In 0.8, the do notation worked for arbitrary functions, why does it only work for functions returning () in 0.9? :-O
[18:01:44] *** Quits: nical (nico@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[18:01:54] <kimundi> Tobba: What exactly is the source of the unsizedness there?
[18:02:23] <kimundi> pyon: To make it obvious that you create a heap allocation if you use the do sugar
[18:02:24] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Ping timeout)
[18:02:29] *** Quits: heftig (heftig@moz-D746319F.unitymedia.biz) (Ping timeout)
[18:02:30] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[18:02:30] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:02:50] <kimundi> pyon: That is, now the do suagr only works with proc, which does a heap allocation
[18:03:15] <pyon> Why would it do a heap allocation? :-O
[18:03:43] <cmr> pyon: so that the closure isn't tied to a given lifetime.
[18:03:48] <cmr> or, rather, procedure
[18:03:54] <pyon> Oh.
[18:03:58] <cmr> such a silly name, I hope we can come up with a better one sometime.
[18:04:01] *** Quits: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP) (Ping timeout)
[18:04:17] <pyon> kimundi: cmr: That behavior is new to 0.9, right?
[18:04:21] <cmr> pyon: yes.
[18:04:22] <pyon> I mean, the heap allocation.
[18:04:27] <pyon> Ah!
[18:04:28] *** Joins: FreeFull (freefull@moz-27B28976.as13285.net)
[18:04:28] <cmr> well, kinda.
[18:04:32] <cmr> ~fn used to exist.
[18:04:37] <cmr> proc() is ~once fn in the old notation
[18:05:10] <cmr> do used to work with any closure type.
[18:05:14] <cmr> now it only works with proc()
[18:05:20] <pyon> So now the do notation is primarily for spawning tasks and the like, not as general-purpose as it was in 0.8, right?
[18:05:36] <cmr> correct
[18:05:39] <kimundi> do was changed because before it was not obvious wether it created a stack closure that does not allocate, or a heap closure that does allocate
[18:05:45] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:05:45] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[18:06:01] <pyon> Ah, makes sense, makes sense. :-)
[18:06:18] <eddyb> dylukes: sorry, I was away, and now there's too much backlog :(
[18:06:22] <dylukes> No worries.
[18:06:26] <dylukes> I'm retrying things.
[18:06:29] <dylukes> I'll come back later.
[18:06:31] <dylukes> Gotta go talk to pro.
[18:06:32] <dylukes> prof*
[18:06:34] *** Quits: dylukes (dylukes@moz-29F81A5.wireless.pitt.edu) (Quit: Textual IRC Client: www.textualapp.com)
[18:06:39] <bascule>  13_4__8__ 9_11__12_  13_4__ 8_9__11_    13_ 4_8_   11__12_ 13_ 4_ 
[18:06:43] <bascule> 4|  8_9__11|  12_ 13\4|_ 8_9|  11_ 12\  4/ 8\\ 9\ 11/ 12/ 13| 4| 8|
[18:06:43] <cmr> FRIDAY!
[18:06:45] <bascule> 8| 9|_  12| 13|_4) 8|| 9|11| 12| 13| 4|/ 8_ 9\11\ 12V 13/| 4| 8| 9|
[18:06:48] <bascule> 9|  11_12| 13|  4_ 8< 9| 11|12| 13|_4| 8/ 9__11_ 12\| 13| 4|8_|9_|11_|
[18:06:51] <bascule> 11|_12|   4|_8| 9\_11\_12__13|_4__8_/9_/   12\13_\4_| 8(9_|11_|12_)
[18:06:54] <bascule>                                         
[18:07:20] <derek_c> bascule: wow that's cool
[18:07:32] <bascule> lolol
[18:08:01] *** Quits: benjamin_ (benjamin@moz-C9D9B603.dip0.t-ipconnect.de) (Ping timeout)
[18:08:59] *** Joins: dredozubov (dredozubov@EC6EC1F6.27163FAA.806C54C8.IP)
[18:09:07] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:09:07] *** ChanServ sets mode: +ao brson brson
[18:09:08] *** Quits: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net) (Quit: ziad)
[18:09:13] * kimundi is everytime sad if he sees bascules friday message, because its usually 7pm here at that point
[18:09:30] <cmr> heh
[18:09:33] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Input/output error)
[18:09:47] *** Quits: synackse (jordyd@moz-5289C68.jax.bellsouth.net) (Quit: synackse)
[18:10:02] <bascule> kimundi: PARTYTIME!
[18:10:02] <kvark> I don't recognize bascule paintings... since Mibbit sucks
[18:10:09] *** Joins: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP)
[18:10:57] <kimundi> bascule: Heh, sadly I'm one of those unsociable guys who doesn't get the concept of a party :P
[18:11:00] *** Joins: cojennin (uid23526@moz-E77DEB21.irccloud.com)
[18:11:04] <bascule> :(
[18:11:11] <bascule> surely you have something to do on a friday night?
[18:11:15] <cmr> Rust!
[18:11:24] <cmr> that's my fridays :p
[18:11:31] *** Quits: derek_c (derek@moz-497E6734.tmlgb.datafoundry.com) (Quit: Leaving)
[18:11:38] <bascule> haha seems good
[18:11:39] <bascule> lol
[18:12:17] * eddyb gets parties very well, except he doesn't get them often :/
[18:14:03] *** Joins: earlzlap (earlz@ED11D7F2.3A0412A8.3D8DAE4F.IP)
[18:14:13] *** Quits: SiegeLord (sl@DA150354.2815CC0B.9BCC850D.IP) (Quit: Leaving)
[18:14:29] * jdm has quiet nights with the kittens on fridays
[18:14:48] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[18:15:39] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[18:15:44] *** Quits: bachm (Mibbit@moz-4A19983C.ip227.fastwebnet.it) (Quit: http://www.mibbit.com ajax IRC Client)
[18:15:50] <eddyb> and by "not often" I mean I went to the freshmen ball thing 3 years ago
[18:16:00] *** Quits: krdln (Mibbit@moz-C271714F.dynamic.chello.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[18:18:30] <adridu59> kvark: it doesn't suck, just doesn't use a monospaced font
[18:18:57] <Tobba> monospaced fonts are best fonts
[18:19:05] <Ms2ger> eddyb, party like it's... 2010?
[18:20:07] <Tobba> though apparently monospaced fonts give mere mortals headaches
[18:21:05] <Tobba> probably due to the inconsistent kerning, but nonetheless
[18:21:18] <eddyb> (and one recently, the only 18th birthday I went to, and probably the last one I'll be invited to - not because I do bad things or anything like that)
[18:21:36] <eddyb> anyways, I'm weird, I should stop talking about myself now
[18:22:28] *** Joins: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP)
[18:22:40] <Ms2ger> Keming?
[18:22:52] * Ms2ger passes eddyb a beer
[18:23:21] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[18:24:27] *** Quits: victorporof (victorporo@5EC92F85.71368607.9B1E38F4.IP) (Quit: victorporof)
[18:24:35] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[18:24:37] <eddyb> Ms2ger: rıope, I don't drink alcohol
[18:24:50] <Ms2ger> Clever, sir
[18:25:00] * kvark passes eddyb a glass of milk
[18:25:12] <Ms2ger> How long did that take? :)
[18:25:54] * kvark joined the non-drinkers club more than half a life ago
[18:26:04] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[18:26:17] *** Joins: mleise (marco@moz-850E56A9.pools.arcor-ip.net)
[18:26:31] <eddyb> Ms2ger: did what take?
[18:26:38] <Ms2ger> rı
[18:28:04] <eddyb> some smartass decided to put lots of compose stuff on the romanian layout, even though the only special chars *ever* are ăâîșț
[18:28:09] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[18:28:26] <eddyb> so I can do ° with AltGr + double-press 5
[18:28:46] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[18:29:22] <Tobba> hah, what
[18:29:28] <Tobba> thats useful though
[18:29:51] <eddyb> that ı is AltGr+8 then i. AltGr+double 8 is ˙ (dot above) which means it subtracts the dot from things that already have the dot
[18:29:52] *** Quits: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net) (Ping timeout)
[18:30:09] <Ms2ger> Heh
[18:30:09] <eddyb> Tobba: yeah, but not in the language. 25°C is really easy to type fluently ;)
[18:30:18] <Ms2ger> I've got  next to 0
[18:30:26] <Tobba> swedish doesnt have that at all
[18:30:26] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (No route to host)
[18:30:29] <Tobba> we have ½ though
[18:30:31] <Tobba> (WHY)
[18:30:40] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[18:31:25] <eddyb> interrobang and other crazy things require mashing the right ctrl/shift/alt/winkey combo
[18:31:41] *** Quits: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[18:31:50] <eevee> i love me some compose key
[18:31:52] <eddyb> those are somewhat more generic than the AltGr+something
[18:32:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:32:01] <kimundi> ° and ^ are right next to the 1 for me :|
[18:32:10] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:32:23] <Tobba> altgr + chars need to do more things
[18:32:30] <Ms2ger> No, that's 
[18:32:31] <Tobba> needs*
[18:32:32] *** Quits: bheylin (brianheyli@moz-8255E94E.adsl.online.nl) (Quit: bheylin)
[18:32:33] <eddyb> I guess that smartass was just being lazy, ß and § smell of copy-paste
[18:32:37] <cmr> ctrl-shift-alt-winkey !?!?
[18:32:41] <cmr> What input method are you using
[18:32:55] <eddyb> oh, yeah. ₁₂₃₄₅₆₇₈₉₀₋
[18:33:03] <kimundi> Well for my layout AltGr it does æſðđŋħł for the homerow :P
[18:33:13] <eddyb> ¹²³⁴⁵⁶⁷⁸⁹⁰⁻⁼
[18:33:19] <eddyb> you can tell it's rather easy :)
[18:33:19] <Tobba> ¹²³⁴⁵⁶⁷⁸⁹
[18:33:23] <Tobba> though this is a GTK thing actually
[18:33:25] <kimundi> ¹²³¼½¬{[]}\ł€¶ŧ←↓→øþ»«¢„“”µ·…–
[18:33:38] <eddyb> cmr: Romanian default
[18:33:40] <Tobba> you can superscript numbers in gtk applications on windows
[18:33:43] <Tobba> for some reason
[18:34:07] <eddyb> cmr: I looked at the rules once, it includes some generic compose rules
[18:34:09] <kimundi> ¸ <- wtf is that even?
[18:34:18] <Tobba> its useless though because if you do some stuff like 2¹⁶
[18:34:20] <Ms2ger> kimundi,  - c?
[18:34:22] <Tobba> it looks missmatched as hell
[18:34:29] <kimundi> c¸cç
[18:34:30] <eddyb> Tobba: doesn't here :)
[18:34:32] <kimundi> huh
[18:34:36] <Tobba> dangit gtk
[18:35:04] <Ms2ger> 'CEDILLA' (U+00B8)
[18:35:17] <eddyb> ǫi, įs yoųr screen ḋirty?
[18:35:27] <Ms2ger> There's weird shit in Unicode
[18:36:00] <Tobba> unicode is horrible
[18:36:05] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[18:36:09] <Tobba> mostly because theres at least 5 different ways to represent every single character
[18:36:09] <eddyb> cmr: I once made a reversed ?, I think and then spent half an hour trying to reproduce it
[18:36:23] *** Quits: egghead (egghead@7851DE85.C82F6435.20F09BA6.IP) (Ping timeout)
[18:36:23] <Tobba> swedish ä is at least 4 ways I know of
[18:36:27] <kimundi> Tobba: At least its horrible enough that its hard to make it more horrible than it already is :P
[18:36:31] *** Quits: earlzlap (earlz@ED11D7F2.3A0412A8.3D8DAE4F.IP) (Ping timeout)
[18:36:45] <Tobba> actually like 10 ways
[18:36:47] <kimundi> Tobba: Well, there is normalisation
[18:36:50] <Tobba> yeah
[18:36:53] <Tobba> which is a PITA
[18:36:57] <Tobba> gigantic loopup table hell
[18:37:04] <eddyb> AltGr+Right Shift+Right Winkey+double-press the /? key => ¿
[18:37:08] *** Joins: pnkfelix (pnkfelix@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[18:37:12] <Tobba> and normalization is expensive as all hell
[18:37:18] <eevee> compose ? ? → ¿
[18:37:52] <eddyb> �
[18:38:09] <kimundi> ·…·
[18:38:23] <eddyb> that was a reversed interrobang, I think. my client can't render it in the chat log, just in the input box
[18:38:32] <eddyb> compose ? !
[18:38:35] <Ms2ger> ..
[18:38:45] <Tobba> unicode what did you DO
[18:38:49] *** Joins: rca_ (rcatolino@moz-F434D9F9.adsl.proxad.net)
[18:38:54] <Tobba> implementing font rendering is actually even worse than normalization
[18:38:56] <eddyb> °⁼°
[18:39:00] <Tobba> you have to do normalization, and reverse normalization
[18:39:13] <Tobba> first, normalize the text
[18:39:21] <Tobba> then if theres a character you cant render, fuck it up until you can render it
[18:39:31] *** Quits: rca (rcatolino@6A636113.7FFEF089.2CE09D78.IP) (Ping timeout)
[18:39:43] <eevee> i need some composes for emoji and wingdings
[18:39:50] <eddyb> Tobba: I wanted to implement proper monospace rendering (so box-drawing lines touch each-other) in pedigree's console, but I got dizzy when I got close to the font rendering stuff
[18:40:06] *** Joins: alonlevy (alon@moz-30492E92.bb.netvision.net.il)
[18:40:15] <Tobba> I wanted to implement a unicode capable console
[18:40:22] <Tobba> I wanted to die 5 minutes later of thinking about it
[18:40:28] <kimundi> ·–·· ––– ––– –·–  ··  –·–· ·– –·  –– ––– ·–· ··· ·
[18:40:39] <luz> ¹²³⁴⁵⁶⁷⁸⁹⁰
[18:40:45] <eddyb> luz: you're late
[18:40:52] <luz> oh
[18:40:53] <eddyb> Tobba: after some time, someone else made it draw lines for the line-drawing escape codes instead of the respective Unicode chars
[18:40:55] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:41:00] *** Quits: entro (centro@moz-6398EFDF.dclient.hispeed.ch) (Input/output error)
[18:41:06] <Tobba> hahahahah
[18:41:30] <kimundi> line drawing escape code?
[18:42:00] *** Quits: gwty (gwtypc@B8F3004.2F30E97E.27560D6E.IP) (Ping timeout)
[18:42:05] <eddyb> the only references for weird escape codes I have are konsole source and pedigree TUI source
[18:42:06] *** Joins: nherman (user@moz-33E3C0FF.hsd1.wa.comcast.net)
[18:42:18] <luz> urxvt has been nicest to me with unicode and fallbacks/etc
[18:42:24] <eddyb> did you know konsole can do full 24-bit RGB colors?
[18:42:38] *** Quits: killerswan (kevin.cant@E9A7755D.F485DE6D.5604FD67.IP) (Ping timeout)
[18:43:11] <jhasse> eddyb: finalterm
[18:43:11] <anasyrma> fun urxvt fact: if it can't parse a color spec, it uses pink instead
[18:43:19] <eddyb> I think fish might be able to take advantage of it
[18:43:25] <anasyrma> "unable to parse color '%s', using pink instead."
[18:43:36] <luz> ₀₁₂₃₄₅₆₇₈₉
[18:43:44] <luz> i'm not late again right
[18:44:22] <c-a> how do I get a mutable raw pointer to a fixed length vector?
[18:44:53] <kimundi> c-a get a reference, and cast it to raw pointer
[18:44:56] <cmr> c-a: .as_mut_ptr()
[18:44:59] *** Quits: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP) (Quit: dev14)
[18:45:04] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[18:45:12] <cmr> it *should* coerce to a slice.
[18:45:18] <cmr> but if not, .as_mut_slice().as_mut_ptr()
[18:45:29] *** Joins: zq (p@moz-4C4640FD.com)
[18:45:32] <kimundi> let v = [1, 2, 3]; let p = &mut v as *mut [int, ..3];
[18:45:47] <zq> how do parameterized trait declarations correspond to haskell's typeclasses?
[18:46:09] *** Joins: dredozub_ (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[18:46:09] *** Quits: dredozubov (dredozubov@EC6EC1F6.27163FAA.806C54C8.IP) (Broken pipe)
[18:51:06] *** Joins: mhoye (mhoye@moz-C14EAE67.vs.heavycomputing.ca)
[18:51:19] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Ping timeout)
[18:51:23] *** Quits: jhasse (jhasse@moz-3B266AF0.ewe-ip-backbone.de) (Quit: Verlassend)
[18:52:16] *** rca_ is now known as rca
[18:52:33] <eddyb> zq: parametrized? in which way?
[18:53:05] *** Quits: nherman (user@moz-33E3C0FF.hsd1.wa.comcast.net) (Quit: leaving)
[18:53:13] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[18:53:44] *** Joins: entro (centro@moz-6398EFDF.dclient.hispeed.ch)
[18:53:48] <eddyb> (I hope it's not the Self issue that I have to keep explaining again and again and nobody else takes my side. trait inheritance != bounds on Self)
[18:53:53] *** Joins: heftig (heftig@moz-EA1B9033.unitymedia.biz)
[18:54:57] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[18:55:14] <cmr> I still don't see  how it isn't
[18:55:16] <cmr> even niko says it is!
[18:55:22] <eddyb> dammit
[18:56:18] <eddyb> cmr: but it led dbaupp to affirming that something bogus like bound inferrence should be present
[18:57:11] <eddyb> trait Foo<T: Bar>{} fn foo<A, B: Foo<A>>(){} I say that function definition is wrong, missing Bar bound on A
[18:58:19] <zq> eddyb: trait Seq<T> { .. }
[18:58:20] <eddyb> he said "no, we should infer the Bar bound" (which came from a Haskeller trying to apply a Haskell concept in Rust. which works for most things, but trait inheritance isn't one of them)
[18:58:45] <zq> i'm guessing that this corresponds to multiparam typeclass instances in haskell
[18:59:22] <eddyb> oh, not inheritance, move on :)
[19:00:02] <zq> huh?
[19:00:39] *** Joins: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP)
[19:00:45] *** Quits: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP) (Client exited)
[19:01:32] <eddyb> zq: there's one thing I know that people coming from Haskell are going to get confused over, but you're not using it, so ignore me
[19:02:22] <zq> my original question stands, though
[19:02:59] <zq> trait Blah { .. } implicitly declares a polymorphic type var: self
[19:03:04] *** Joins: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP)
[19:03:52] <Tobba> whats the idiomatic way to do C style enums
[19:04:27] <kimundi> Tobba: Uhm, enum Foo { Bar, Baz, Qux } ?
[19:04:35] <Ms2ger> = 0?
[19:04:48] <Tobba> wait, that works?
[19:04:53] <Tobba> oh geez, it all makes sense now
[19:04:56] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:04:57] <kimundi> Tobba: Well, yeah
[19:05:03] <Matthias247> you need #[repr(C)] when they should be compatible
[19:05:20] *** Joins: zippity (Mibbit@moz-78A888FB.scansafe.net)
[19:05:28] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[19:05:32] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[19:05:32] *** ChanServ sets mode: +ao brson brson
[19:05:39] <Matthias247> otherwise rust will use only  1 byte for the enum when sufficient
[19:05:40] *** Parts: zippity (Mibbit@moz-78A888FB.scansafe.net) ()
[19:06:07] <Tobba> also whats the usual naming rules
[19:06:24] <kimundi> Tobba: Do you expect more than "a list of unit-like variants" froma c-like enum?
[19:06:28] <bstrie> snake_case for functions, CamelCase for everything else
[19:06:43] <kimundi> Tobba: CamelCase for types and enum variants, snake_Case for everything else
[19:06:47] <kimundi> ALLCAPS for constants
[19:06:47] <bstrie> er, snake_case for variables too
[19:07:01] <kimundi> whoops, snake_case
[19:07:06] <Tobba> I've gone with
[19:07:11] <Tobba> CamelCase for types and emums
[19:07:12] <bstrie> we are terrible at explaining this
[19:07:17] <Tobba> camelCase for variables and functions
[19:07:32] *** Joins: earlzlap (earlz@ED11D7F2.3A0412A8.3D8DAE4F.IP)
[19:07:32] <kimundi> The latter is not Rust style
[19:07:43] <Tobba> yeah I've come to realize that
[19:07:47] *** Parts: synackse (jordyd@moz-5289C68.jax.bellsouth.net) ()
[19:07:48] <Tobba> snake_case is more readable anyways
[19:07:54] <bstrie> quick, everyone shun Tobba 
[19:07:57] *** Quits: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP) (Connection reset by peer)
[19:08:08] <Tobba> time for some quick refactoring
[19:08:11] *** Joins: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP)
[19:08:32] <kimundi> quick, everyone shun bstrie for saying that
[19:08:40] <Tobba> meta shunning
[19:08:42] <Tobba> oh dear
[19:08:58] * Ms2ger shuns kimundi 
[19:09:10] * bstrie shuns Ms2ger 
[19:09:12] <Tobba> meta-meta shunning
[19:09:15] * kimundi uses mirror image - the shun is reflected
[19:09:17] <Tobba> well shit
[19:09:23] <bstrie> shuncursion
[19:09:27] <bstrie> shunception
[19:09:31] <bstrie> we have to shun deeper
[19:09:32] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[19:09:41] <Tobba> this got to messy when the mirror got involved
[19:10:56] <luz> there are lints for enforcing rust naming rules
[19:11:13] <luz> and they will probably be enabled by default soon
[19:11:25] <steveklabnik> is that true?
[19:11:27] <steveklabnik> that'd be great.
[19:11:47] <Tobba> perfect
[19:11:52] <Tobba> still using camelCase for struct vars
[19:11:56] <Tobba> ah screw it I'll fix all that later
[19:11:58] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:12:16] <Tobba> currently I have an enum named ElfType, with each thing in it named ElfTypeX
[19:12:18] <luz> https://github.com/mozilla/rust/issues/11432 and https://github.com/mozilla/rust/pull/11457
[19:12:19] <Tobba> feels a bit silly naming it like that
[19:12:47] <Tobba> oh, so the lints are in already?
[19:12:50] <Tobba> any idea on enabling them?
[19:12:57] <bstrie> Tobba: what variants of elves do you have
[19:13:02] <bstrie> DarkElf
[19:13:07] <bstrie> GreyElf
[19:13:10] <bstrie> SludgeElf
[19:13:14] <bstrie> ?
[19:13:27] <Tobba> dark executable and linkable format
[19:13:30] <Tobba> :V
[19:13:37] <eddyb> bstrie: I watched Thor 2 a week ago. dark elves lol
[19:13:43] <Tobba> doing kernel dev, not game dev, big difference in what names mean
[19:13:57] <Tobba> I should probably write ELF not Elf
[19:14:00] <bstrie> right, I was hopeful that you were making a game rather than doing boring systems stuff :P
[19:14:01] <Tobba> ... yeah I should do that
[19:14:13] <Tobba> bstrie: I plan on making a game
[19:14:18] <Tobba> inside of the system I wrote
[19:14:33] <luz> i think you have to enable the lints in your source with #[warn] until https://github.com/mozilla/rust/issues/11458 is fixed or they're default
[19:14:34] <bstrie> you should make a game about ELFs
[19:14:35] <Tobba> with a software renderer, obviously
[19:14:37] <bstrie> and DWARFs
[19:14:50] <Matthias247> lol
[19:14:59] <Tobba> any idea about the warn names
[19:15:04] *** Joins: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[19:15:33] <luz> -W with no arguments or -W help lists all of them
[19:15:40] <Tobba> ah
[19:17:28] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:17:28] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:17:43] *** Joins: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP)
[19:17:54] <Tobba> #[warn(non-camel-case-types)];
[19:17:57] <Tobba> gives me an unexpected -
[19:18:04] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[19:18:05] <eddyb> non_camel_case_types
[19:18:08] <Tobba> ah
[19:18:21] *** Parts: zq (p@moz-4C4640FD.com) ()
[19:18:31] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[19:18:35] <dv> shouldn't that be nonCamelCaseTypes
[19:18:45] <Tobba> hahaha
[19:18:51] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[19:18:52] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:19:46] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[19:19:58] *** Quits: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP) (Quit: dev14)
[19:20:16] *** Quits: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP) (Quit: Leaving...)
[19:21:34] <FrozenCow> how far along is rustpkg nowadays?
[19:21:37] <SingingBoyo> anyone know why rust build is failing with 'can't find -lrustrt'?
[19:22:21] <erickt> SingingBoyo: try doing a "make clean && make"
[19:23:04] <SingingBoyo> erickt: this is a fresh install though, just cloned.  still worth a try?
[19:23:12] *** jorendorff is now known as jorendorff_away
[19:23:38] <erickt> SingingBoyo: was this the first build?
[19:23:52] <SingingBoyo> erickt: yup
[19:24:09] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[19:24:09] <erickt> SingingBoyo: you could also try doing just another "make". I think there's a race on building one of the dependencies
[19:25:10] <SingingBoyo> erickt: ah.  alright, I'll give it a try.
[19:25:19] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[19:26:41] *** Joins: voodoo123x (voodoo123@1E9343E1.96B49069.E713419E.IP)
[19:27:04] *** Quits: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Connection reset by peer)
[19:27:16] *** Joins: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[19:27:16] *** Quits: voodoo123x (voodoo123@1E9343E1.96B49069.E713419E.IP) (Connection reset by peer)
[19:27:54] <Tobba> I was considering writing a darkengine reimplementation in Rust, which has actually been done
[19:28:07] <Tobba> if you do that and rewrite the osm stuff you can actually play thief/ss2, which is awesome
[19:28:19] <c-a> cmr, .as_mut_ptr() works perfect, thanks
[19:28:25] <Tobba> well, noone has done one in rust yet
[19:28:44] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[19:29:06] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[19:29:30] *** jorendorff_away is now known as jorendorff
[19:30:10] <bstrie> Tobba: hahaha, what
[19:30:22] <bstrie> how hard is it to rewrite this engine
[19:30:27] <Tobba> I dunno
[19:30:29] <bstrie> because now I really want to play those games in rust
[19:30:31] <Tobba> look up opendarkengine
[19:30:42] <Tobba> iirc that kinda worked
[19:30:51] <Tobba> though the OSM part would probably be a pain in the ass
[19:31:23] <Tobba> I dont think I could do it, but it'd be fun to mess with
[19:32:02] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:32:19] *** Joins: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP)
[19:32:41] *** Quits: earlzlap (earlz@ED11D7F2.3A0412A8.3D8DAE4F.IP) (Ping timeout)
[19:33:15] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[19:33:38] <Tobba> if you were to reimplement the OSM, getting something like the last level of SS2 working would be your best bet
[19:33:39] *** Joins: goran (goran@B83196FF.C26CF587.3C521BE1.IP)
[19:35:04] *** Quits: vmx (vmx@moz-A59BF2ED.pools.arcor-ip.net) (Quit: Leaving)
[19:35:34] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[19:36:21] *** Quits: JIghtuse (jightuse@5ACC7636.C3AC81A2.906273CD.IP) (Quit: Leaving.)
[19:37:04] *** Quits: andre (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: leaving)
[19:38:57] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Client exited)
[19:39:19] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[19:41:01] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[19:41:02] *** Joins: elux (peter@B6F21F4B.1F20BC31.2170E5F.IP)
[19:42:12] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Ping timeout)
[19:42:49] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[19:42:49] *** ChanServ sets mode: +ao dherman dherman
[19:43:09] *** Quits: FreeFull (freefull@moz-27B28976.as13285.net) (Ping timeout)
[19:43:57] *** Joins: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr)
[19:45:03] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[19:45:07] <geomyidae_> so if I need to send and receive udp packets and use the contents of the packets to do a hashmap insert and lookup on recv/send (respectively)... should I be using an RWArc<HashMap<>> or should I have two tasks, each with their own copy of the hashmap and either send copies of the hashmap or the hashmap updates between the two threads?
[19:45:12] <geomyidae_> Is one more idiomatic than the other
[19:46:34] *** Joins: alsm (asm@660E716B.CAAD3E7C.524E1A8C.IP)
[19:46:58] <Matthias247> not possible to use 1 task for send and receive?
[19:48:56] <kimundi> geomyidae_: I guess the most idiomatic would be to use a concurrent hashmap :P
[19:48:56] *** Quits: alsm (asm@660E716B.CAAD3E7C.524E1A8C.IP) (Quit: Leaving)
[19:48:58] *** Joins: tdc (santegoeds@moz-7ECA6D65.range86-178.btcentralplus.com)
[19:49:33] <geomyidae_> Matthias247: the sending task needs to be able to do a lookup in the hashmap and the receiving task will make entries into the hashmap
[19:49:39] <kimundi> geomyidae_: In absence of that, either could be the better solution, depending on usecase
[19:49:55] *** Quits: dev14 (devarshdes@A0749843.44436F6C.3FBA778E.IP) (Quit: dev14)
[19:50:13] <kimundi> depends on how often the map gets written/read
[19:50:22] <Matthias247> so you already have the 2 tasks?
[19:50:32] <geomyidae_> Yeah
[19:50:46] <geomyidae_> I mean, I could have a low read timeout and read/write in the same task, but that seems a bit wonky.
[19:51:18] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[19:51:25] <Matthias247> I would guess the more ideomatic rust way would to send the changes from the receiving task to the writing task
[19:52:20] <Matthias247> if you use a shared map then you could run into problem that there could be several updates to the map until the writing task ccould send it
[19:52:32] <Matthias247> however this could also be desired by you. don't know
[19:52:52] <geomyidae_> That... does seem like it would be easy to do and would fit with my requirements.
[19:52:58] <Matthias247> so it's a question if you want to forward all changes or only a complete state from time to time
[19:53:24] <geomyidae_> Yeah, I like the way you've framed it, a lot actually.
[19:53:41] <Tobba> is there going to be any support for non-constant repeat counts?
[19:53:48] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[19:54:17] *** jld is now known as jld|lunch
[19:55:32] <SingingBoyo> geomyidae_: the other option is to have a third task that manages the hashmap.  Though that might not be worth it with only two tasks that access the hashmap.
[19:55:34] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[19:57:11] *** Joins: voodoo123x (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[19:57:11] *** Quits: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Connection reset by peer)
[19:57:15] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[19:57:35] *** Joins: dylukes (dylukes@FDA2B4C5.8733FE32.E8393EEB.IP)
[19:57:38] <dylukes> kimundi hey
[19:57:47] <kimundi> hm?
[19:57:50] <dylukes> I'm not exactly clear on how your matchable.rs is HKT :\
[19:58:00] <dylukes> You mean how Matcher is?
[19:58:10] *** Quits: Sorella (quildreen@D2D1E5DD.81EFC25A.A95FAE2B.IP) (Quit: Ex-Chat)
[19:58:14] <kimundi> It might not be 
[19:58:21] <dylukes> My problem seems to be more with the closure types and rust's inability to unify them with traits they have impls for :\.
[19:58:39] <dylukes> i.e. impl<...> Arrow<A, B> for |A| → B { ... }
[19:58:49] <dylukes> if I have a function returning an Arrow<A,B> and I return |A| → B it doesn't unify.
[19:59:06] <kimundi> Honestly, all I know is that this is was eddyb wanted to show you, not wether that actually fits your usecase well :P - I don't really "get" HKT myself
[19:59:10] <Tobba> ugh
[19:59:16] <Tobba> I have a struct with this constructor thing
[19:59:23] <dylukes> i.e. fn const(b: B) → Arrow<A, B> { |a: A| → B { b } }
[19:59:27] <Tobba> the struct contains a data field which is passed to the constructor
[19:59:33] <kimundi> dylukes: Well, thats to be expected
[19:59:36] <Tobba> I cant figure out how to give the data value a proper lifetime
[19:59:38] <dylukes> How so kimundi?
[19:59:53] <dylukes> er sorry
[20:00:07] <dylukes> fn const<A, B, F: Arrow<A,B>(b: B) → F { |a: A| → B { b } }
[20:00:14] <dylukes> it will complain that it got |A| → B, not F.
[20:00:14] <kimundi> dylukes: The closure is a specific type, Arrow<A, B> is not a type. It would be a unboxed trait, but such a thing is not possible
[20:00:21] <dylukes> Even though |A| → B should be an instance of F.
[20:00:31] <dylukes> see my correction haha.
[20:00:49] <kimundi> fn const<A, B, F: Arrow<A,B>(b: B) → F means the _Caller_ gets to decide what type F is going to be
[20:01:12] <dylukes> I'm just trying to make a trait for things that 1) have identities, 2) compose
[20:01:14] <kimundi> you can'T just internally force F to be the specific type |A| -> B
[20:01:16] <dylukes> like functions, pipes, etc
[20:01:28] <dylukes> Okay what do you suggest if this is in the impl for a trait?
[20:01:45] <dylukes> This is my trait.
[20:01:46] <dylukes> https://gist.github.com/DylanLukes/8361554
[20:01:51] <dylukes> For example.
[20:02:32] <dylukes> So I can't decide what type H is based on the input :\.
[20:03:18] <dylukes> It should be "the same" arrow type as the two being composed :\
[20:04:21] <kimundi> Not sure if that is expressible - certianly not with that gist
[20:04:30] <dylukes> Hrm.
[20:05:35] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[20:07:22] *** Joins: Jesin (Jesin@moz-4B662E55.washdc.fios.verizon.net)
[20:07:30] <dylukes> i think part of the problem is, Arrow<A, B> and Arrow<B,C> don't necessarily compose.
[20:07:45] <kimundi> yeah
[20:07:48] <dylukes> They might not be values of the *same particular* struct impl'd for Arrow.
[20:07:55] <dylukes> And I'm not sure how to express that without HKT.
[20:07:57] <kimundi> yes
[20:08:25] <dylukes> Since I'd need to be able to do T: Arrow (where T: (*, *) → *) 
[20:08:37] <dylukes> and then T<A,B> and T<B,C> would denote two of the "same" arrow instances.
[20:08:48] <dylukes> gah, g2g :\
[20:08:50] <dylukes> I'm not sure...
[20:08:55] *** Quits: dylukes (dylukes@FDA2B4C5.8733FE32.E8393EEB.IP) (Quit: Textual IRC Client: www.textualapp.com)
[20:09:43] *** Quits: dredozub_ (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[20:11:04] *** Quits: goran (goran@B83196FF.C26CF587.3C521BE1.IP) (Ping timeout)
[20:11:12] *** Quits: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr) (Quit: Gone)
[20:12:48] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[20:13:13] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[20:14:35] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:17:38] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[20:18:19] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[20:19:56] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[20:24:55] *** Joins: goran (goran@B83196FF.C26CF587.3C521BE1.IP)
[20:27:23] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[20:27:52] *** Joins: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[20:27:52] *** Quits: voodoo123x (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Connection reset by peer)
[20:31:26] <Tobba> hm
[20:32:06] <Tobba> trying to figure out how to attach lifetimes properly to an object on the stack
[20:32:24] <cmr> for what purpose / example?
[20:32:38] <Tobba> I have this struct with a &[u8] member
[20:32:56] <Tobba> which the static "constructor" sets up with its argument
[20:33:32] <cmr> struct Foo<'a> { bytes: &'a [u8] } impl<'a> Foo<'a> { fn new<'b>(bs: &'b [u8]) -> Foo<'b> { Foo { bytes: bs } } }
[20:33:40] * cmr *cough*
[20:33:45] <cmr> wee bit ugly.
[20:34:02] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[20:34:29] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[20:34:34] *** Joins: FreeFull (freefull@moz-D824BA79.as13285.net)
[20:34:41] <Tobba> oh, I tried that
[20:34:44] <Tobba> I forgot the lifetime on the return value
[20:34:47] <Tobba> on the -> part
[20:34:50] <cmr> mm
[20:35:24] <Tobba> yep that works, thanks
[20:35:48] <Tobba> I asked earlier but, is there any plans to support non-constant repeat counts on arrays?
[20:35:50] <Tobba> pretty sure thats doable
[20:36:02] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[20:36:16] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[20:36:34] *** Joins: egghead (egghead@7851DE85.C82F6435.20F09BA6.IP)
[20:36:46] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[20:36:51] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[20:37:09] <cmr> No, and it isn't. Not without having an alloca.
[20:37:16] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[20:37:21] <cmr> [T, .. non_constant] isn't a fixed-size array
[20:37:25] <Tobba> I know
[20:37:26] *** Joins: danieleggert_2 (Mibbit@moz-4E2DB390.superkabel.de)
[20:37:31] <Tobba> LLVM supports alloca though afaik?
[20:38:16] *** Joins: GreyKnight (GK@moz-4E38896B.range86-176.btcentralplus.com)
[20:38:46] <Tobba> well, it definitely does, but I dont know if it can handle non-constant elemant numbers
[20:38:48] <Tobba> element*
[20:38:58] <whitequark> cmr: would [T, ..non_constant] even make sense typing-wise? you'd need to introduce dependent types
[20:39:25] <Tobba> it wouldent really
[20:39:39] <whitequark> or if you erase the size, you just get &[T]
[20:39:52] <Tobba> which would be alright, wouldent it
[20:39:53] <cmr> Tobba: it does support non-constant alloca's, just checked.
[20:40:04] <cmr> alloca i8 %4
[20:40:05] <Tobba> &[T] makes sense for a dynamicaly sized array
[20:40:06] <cmr> for example.
[20:40:22] <cmr> The reason *I* don't want to add alloca to the language is that it makes stack frames non-fixed-size.
[20:40:32] <Tobba> hm, yeah
[20:40:32] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[20:40:34] <cmr> And I don't like that. It screws with all of the stack size analysis I want to do in the future.
[20:40:44] <GreyKnight> I am compiling rustc (by which I mean llvm) in preparation for starting my adventure
[20:40:45] <Tobba> it does assist in dodging the heap though
[20:40:55] <cmr> it does.
[20:41:09] <whitequark> cmr: wouldn't stack size analyses be broken anyway by, say, simple recursion?
[20:41:11] <cmr> you could write an alloca yourself, with inline asm.
[20:41:27] <Tobba> modifying esp is a bad idea
[20:41:30] <Tobba> specially for performance
[20:41:31] <whitequark> so either way one should restrict oneself to a subset of the language for them to work
[20:41:35] <Tobba> also it causes LLVM to crap out iirc
[20:41:47] <Tobba> clobbering esp can cause llvm to crap out iirc*
[20:41:49] <cmr> whitequark: yes, but the same style guides that forbid such recursion also forbid alloca... maybe we could allow it.
[20:41:54] <cmr> our __morestack definitely can't handle it.
[20:41:56] <whitequark> cmr: exactly my point
[20:42:02] <whitequark> yes, __morestack is a problem.
[20:42:08] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[20:42:09] <Tobba> is __morestack even used anymore
[20:42:10] <cmr> and our planned stack check with unwinding definitely can't handle it.
[20:42:13] <Tobba> I thought segmented stacks were disabled
[20:42:15] <cmr> Tobba: yes, for stack size checking.
[20:42:16] <whitequark> but it should be removed anyway in favor of a more general solution
[20:43:13] <cmr> I'm not convinced we can have efficient stack checking with alloca, or with unwinding on overflow.
[20:43:50] <Tobba> runtime stack checking with alloca would be fine
[20:43:51] <whitequark> cmr: why would allocas prevent efficient stack overflow checking?
[20:43:54] <Tobba> unwinding might be a problem though
[20:44:01] *** Joins: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[20:44:43] *** Quits: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net) (Ping timeout)
[20:44:52] <danieleggert_2> Where would I find a pointer to figure out how to write a library in Rust (that C code can link against)?
[20:45:03] <cmr> whitequark: because now we can't just probe the stack a fixed number of times, we need to add probes on alloca.
[20:45:30] *** Quits: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[20:45:30] <Tobba> it would just need to be probes on dynamic allocs though
[20:45:41] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Ping timeout)
[20:45:42] <cmr> yes
[20:45:58] <cmr> I'm not fully convinced that alloca is a bad idea, but I'm pretty sure it is.
[20:46:26] <Tobba> it introduces the same kinda crashes as divisions by zero, kind of
[20:46:35] <whitequark> that
[20:46:40] <cmr> danieleggert_2: http://static.rust-lang.org/doc/master/guide-ffi.html
[20:46:43] <whitequark> *that's not really related to dynamically sized alloca
[20:46:46] <Tobba> unpredictable, triggerable by user input
[20:46:54] <whitequark> you will have unchecked crashes with recursion, too
[20:47:17] <cmr> stack checks are a matter of memory safety, div by zero is a correctness porlbme.
[20:47:19] <cmr> *problem
[20:47:21] <whitequark> they're pretty much equivalent for most purposes, except the lowest level concerns
[20:47:27] <danieleggert_2> cmr: I want to do the opposite: Write a function in Rust, and main() in C
[20:47:33] <cmr> danieleggert_2: the same thing applies.
[20:47:40] <danieleggert_2> Ok. Thanks.
[20:47:54] <cmr> danieleggert_2: you need #[no_mangle] extern "C", and you can just use the symbol names as you'd expect.
[20:48:06] <Ke> the @-boxes are dead now?
[20:48:10] <cmr> (sections 8 and 9 are the most important)
[20:48:14] <cmr> Ke: they're behind a feature gate.
[20:48:44] <Ke> that meanss deprecated I guess?
[20:48:46] <danieleggert_2> cmr: I'll give it a try.
[20:48:48] *** Joins: lkuper (lkuper@802AC8C7.A0D37E9B.51B6877.IP)
[20:49:02] <cmr> yep
[20:49:06] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[20:50:24] *** Quits: cheese_cast (raspinudo@moz-FB14AB08.hsd1.ca.comcast.net) (Ping timeout)
[20:50:54] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[20:52:53] *** Parts: judder (maradukewa@391D0079.5121DAAD.78E362FE.IP) ()
[20:53:52] *** Parts: danieleggert_2 (Mibbit@moz-4E2DB390.superkabel.de) ()
[20:54:16] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[20:54:28] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[20:54:39] <Tobba> reminded me actually, I have to implement a refcounted ptr
[20:54:48] <Tobba> does std::Rc work yet
[20:55:02] <cmr> of course
[20:55:12] <cmr> std::rc::Rc
[20:55:35] <Tobba> excellent
[20:55:59] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[20:57:35] *** Joins: Mathnerd314 (Mibbit@DD760FDD.60D7EA1F.459A737F.IP)
[20:58:03] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:58:05] <diverse> how is your kernel port doing Tobba?
[20:58:06] *** Quits: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Connection reset by peer)
[20:58:13] <Tobba> reasonably
[20:58:22] *** Joins: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[20:58:22] <Tobba> I got a bit stuck and distracted implementing the ELF loader for drivers
[20:58:28] <pyon> What are the use cases for std::io::fs::File and std::rt::rtio::RtioFileStream?
[20:58:48] *** jdm is now known as jdm|away
[20:59:00] <cmr> pyon: rtio::RtioFileStream is the trait that would be used to implement a rutnime.
[20:59:01] <cmr> *runtime
[20:59:14] <cmr> std::io is the high-level interface that abstracts over any runtime
[20:59:20] <cmr> (see the Runtime trait, somewhere in std::rt)
[20:59:44] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[20:59:49] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[21:00:22] <pyon> Ah!
[21:00:37] <Tobba> is there any way to cast an integer to an enum
[21:00:57] <cmr> not safely.
[21:01:05] <cmr> there's #[deriving(FromPrimitive)]
[21:01:17] <Tobba> hm
[21:01:20] <cmr> safely, you could do a match on the integer and return the correct enum variant.
[21:01:27] <Tobba> yeah I was considering that
[21:01:30] <Tobba> ah fuck it I'll do that
[21:01:31] <pyon> cmr: In general, I cannot get my hands on an object of a type that implements Runtime, IoFactory or RtioFileStream, right?
[21:01:36] <cmr> unsafely, you could compare it to the variant with the largest value and transmute it.
[21:01:43] <Tobba> I fucking love everything being an expression
[21:01:50] <cmr> pyon: you can, using some of the stuff in std::rt
[21:03:19] *** Joins: mib_id7x2s (Mibbit@moz-8370D1B9.bredband.comhem.se)
[21:03:20] <diverse> Tobba: despite the challenges, sounds like you are having fun.
[21:03:28] *** Quits: mib_id7x2s (Mibbit@moz-8370D1B9.bredband.comhem.se) (Quit: http://www.mibbit.com ajax IRC Client)
[21:03:29] <Tobba> rust is an amazing language
[21:03:48] <diverse> :)
[21:04:00] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[21:04:33] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[21:05:03] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[21:06:00] <Tobba> all ELF loaders I write become messy
[21:06:06] <Tobba> though with some macros this should become reasonable
[21:06:11] <Tobba> let pheader = match (data.substruct::<ELFProgram>(((header.programOffset as uint) + (header.programHeaderSize as uint)*(i as uint)))) { Some(d) => d, None => return Err("Program header outside of file") };
[21:06:21] *** Quits: ferminter (Mibbit@moz-8E1B3F2F.adsl-surfen.hetnet.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[21:06:57] *** Quits: sk (sk@45DB4C5B.86598B04.24EDD759.IP) (Quit: Leaving)
[21:07:20] *** Quits: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Ping timeout)
[21:07:46] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[21:08:56] *** Quits: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de) (Quit: Verlassend)
[21:08:58] <Tobba> diverse: though I'm soon to get to the really nonfun part: allocators
[21:09:11] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Ping timeout)
[21:09:26] <Tobba> completely illogical, impossible to debug, impossible to think through
[21:09:33] <Tobba> though enums will hopefully make this nicer to deal with
[21:09:55] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[21:10:11] <diverse> Tobba: ouch, yeah I heard about using allocators being an issue in your earlier discussions for kernel dev
[21:10:33] *** Joins: lennart (lennart@moz-DE70D6F.stanford.edu)
[21:10:36] <Tobba> its basicaly just, actually this shouldent be *that* bad
[21:10:47] <Tobba> theres a nice circular dependency where the allocator needs to allocate memory too
[21:10:55] <Tobba> its a mess to sort out
[21:11:11] *** Joins: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP)
[21:11:42] <Tobba> however, if I manage to get a working allocator, thinks get really fun
[21:13:16] <diverse> I think the Rust devs would love to hear how you pull it off. :)
[21:15:22] <Tobba> one issue I have with this though is that I have to predict how big each node becomes
[21:16:02] <Tobba> and find the largest power of two - 1 of nodes that fit into 4096 bytes
[21:16:03] <pyon> So, how do I get my hands on a std::rt::rtio::RtioFileStream so that I can pread or pwrite it?
[21:16:11] *** Joins: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net)
[21:16:26] *** Quits: rca (rcatolino@moz-F434D9F9.adsl.proxad.net) (Quit: Lost terminal)
[21:16:32] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[21:17:43] *** Quits: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP) (Ping timeout)
[21:17:52] <pyon> Or, rather, how do I get my hands on a std::rt::rtio::IoFactory so that I can use it to get my hands on a std::rt::rtio::RtioFileStream?
[21:18:28] *** Joins: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP)
[21:18:31] *** Joins: dkeenaghan (dkeenaghan@A9F153F4.DDE28F19.986A907C.IP)
[21:18:32] *** Joins: ercxx (ercan@moz-88DD3A7E.dyn.optonline.net)
[21:18:38] <diverse> Tobba: if a node gets larger than 4096 bytes, do you discard it?
[21:18:49] <Tobba> uh, basicaly
[21:19:04] <Tobba> one node is like, it'll probably be like 10 bytes in rust due to options
[21:19:07] <Tobba> bit inefficient, fuck it for now
[21:19:18] *** Joins: kvanb (kvanb@moz-25C48B43.lns11.lon.bigpond.net.au)
[21:19:21] <Tobba> I have to know their size at compile time to find the optimal size is the issue
[21:19:31] <Tobba> I dont really know if the size of something is "predictable" when enums get involved
[21:19:45] <pyon> Oh, never mind... The sequence is rather long: std::rt::rtio::LocalIo::borrow -> std::rt::rtio::LocalIo::get -> etc.
[21:20:17] <GreyKnight> pyon: try not to get RSI :-)
[21:20:57] <pyon> RSI?
[21:21:03] <kimundi> Tobba: Well, a enum type also just has a static size
[21:21:03] <Tobba> repeated strain injury
[21:21:07] <pyon> Oh.
[21:21:11] <pyon> lol
[21:21:12] <Tobba> yeah, not sure how big it'll be though
[21:21:22] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[21:21:44] <kimundi> Tobba: usually size of biggest variant + 1 word
[21:21:52] <Matthias247> std::mem::size_of tells you :)
[21:21:55] <Tobba> 1 word or 1 byte?
[21:22:00] <Tobba> yeah but I have to do it at compile town
[21:22:06] <Matthias247> 1byte
[21:22:08] <Tobba> I'll just throw in some failures if it goes miserably w rong
[21:22:10] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[21:22:10] *** vfetwnuncszu is now known as dcrewi
[21:22:18] *** Joins: valenting (Thunderbir@23EF5095.ECBF5C84.FB866788.IP)
[21:22:19] <Matthias247> 1 word if you use #[repr(C)]
[21:22:30] <kimundi> its just a tagged value - alignment will ususally make that 1 word afaik
[21:22:36] <Tobba> actually
[21:22:37] <Tobba> I can cheat here
[21:22:40] <kimundi> tagged union*
[21:22:43] <Tobba> and make it so each node is actually a single enum
[21:23:02] <Tobba> with Red(LMANode), Red(LMANodeBlock), Black(LMANode), Black(LMANodeBlock)
[21:23:19] <Tobba> 5 bytes per node
[21:23:45] <eddyb> what are those?
[21:23:53] *** Joins: khodzha (khodzha@58A7E199.A859D9FD.CA6E2165.IP)
[21:23:54] *** Quits: khodzha1 (khodzha@DBBBFFE1.3E410295.CA6E2165.IP) (Ping timeout)
[21:24:23] *** Joins: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de)
[21:24:37] <fabiand> congrats to 0.9
[21:26:00] <phil_> 0.9 is released?
[21:26:02] <Tobba> though the lifetimes of this structure is gonna be hell
[21:26:09] <Tobba> phil_: since like what, yesterday
[21:26:13] <phil_> damn
[21:26:17] <phil_> ive been living under a rock
[21:26:35] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[21:26:40] <phil_> im just waiting for 1.0 though tbh
[21:26:46] <phil_> something more stable in the long term
[21:26:49] <bstrie> phil_: better get back under your rock then!
[21:26:52] <bstrie> we'll let you know
[21:26:59] <phil_> nah in the meantime
[21:27:01] <Ms2ger> And HN will :)
[21:27:03] <phil_> ill be messing with master
[21:27:05] *** Quits: heftig (heftig@moz-EA1B9033.unitymedia.biz) (Quit: Quitting)
[21:27:39] <Tobba> DSTs are going to rock
[21:28:14] <pyon> std::rt::rtio::RtioFileStream::{pread, pwrite} take "&mut self". How do I allow two different references to the same RtioFileStream object to pread or pwrite to non-overlapping slices of the file?
[21:28:26] <pyon> Concurrently, that is.
[21:28:46] *** Joins: voodoo123x (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP)
[21:28:46] *** Quits: voodoo123 (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Connection reset by peer)
[21:29:40] *** Joins: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[21:30:17] *** Quits: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de) (Quit: Verlassend)
[21:31:33] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[21:31:42] <diverse> bstrie is right though, if you plan on waiting for 1.0, you might as get comfy under that rock
[21:31:54] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[21:33:05] *** Quits: achim (achim@moz-C6C49A81.dip0.t-ipconnect.de) (Quit: Computer has gone to sleep.)
[21:33:25] <diverse> while bstrie and everyone enjoys a rust master mojito ;)
[21:33:41] <cmr> pyon: not possible.
[21:33:55] <cmr> not safely at least.
[21:34:36] <Tobba> is there any reason you cant equal enums?
[21:34:41] <pyon> Dang. Now I have to drop down to (essentially) C. :-(
[21:34:43] <cmr> Tobba: #[deriving(Eq)]
[21:35:06] <cmr> pyon: I mean you can do it unsafely with a transmute. But I wouldn't recommend it :)
[21:35:08] <Tobba> heh, I dont have the Eq lang item
[21:35:12] <Tobba> I should fix that
[21:35:36] <Tobba> error: use of undeclared module `::std::cmp`
[21:35:38] <Tobba> seriously?
[21:35:45] <cmr> ah yes that.
[21:35:48] <pyon> cmr: I can guarantee nobody will attempt to pread or pwrite the same portion of the file. I just want to avoid opening like 200 descriptors to the same file, just so I can manipulate different portions.
[21:37:17] *** Joins: ktt3ja (ktt3ja@moz-54586A12.washdc.fios.verizon.net)
[21:37:23] <Tobba> would defining the Eq lang_item somewhere work
[21:37:26] <Tobba> or is something hardcoded
[21:37:48] <cmr> it's hardcoded unfortunately :(
[21:37:56] <Tobba> well shit
[21:37:59] <eddyb> Tobba: I proposed automatically re-exporting lang items under a special top-level module so that deriving can use it from there instead of std
[21:38:00] <Tobba> I'll abuse a pattern match
[21:38:23] <eddyb> Tobba: you can always have a top-level std module :P
[21:38:41] *** Joins: cheese_cast (raspinudo@moz-FB14AB08.hsd1.ca.comcast.net)
[21:38:46] <eddyb> mod std {mod cmp {pub use lang_items::Eq;}}
[21:38:54] *** Quits: jackneill (jackneill@moz-5CBC0CBA.pool.digikabel.hu) (Ping timeout)
[21:38:56] <eddyb> (that should be pub mod)
[21:39:32] <Matthias247> pyon: I think it's better not to mess with those fds directly, because they are normally written from threads in the threadpool of libuv. Would be hard to determine when what happens
[21:39:33] <Tobba> yeah that'd be better
[21:39:34] <diverse> eddyb: wait, so 'use' is sugar for that?
[21:39:51] <eddyb> sugar for what?
[21:40:03] <cmr> diverse: use isn't sugar for anything.
[21:40:20] <ktt3ja> what does the `#[lang=".."]` attribute do?
[21:40:23] <eddyb> use is just an "import". pub means it's also exported
[21:40:35] <cmr> ktt3ja: defines that the following item fulfills a language item.
[21:40:41] <cmr> http://static.rust-lang.org/doc/master/rust.html#language-items
[21:40:47] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:40:59] *** jld|lunch is now known as jld
[21:41:08] *** jdm|away is now known as jdm
[21:41:19] <Tobba> is there any reason you cant index a *mut u8
[21:41:36] <cmr> Tobba: you can't index any type that doesn't implement Index.
[21:41:37] *** Quits: tdc (santegoeds@moz-7ECA6D65.range86-178.btcentralplus.com) (Quit: Leaving)
[21:41:47] <Ms2ger> You can through a method call, I think?
[21:41:51] <Tobba> ah
[21:41:53] <Ms2ger> offset_something?
[21:41:54] <cmr> yeah, .offset()
[21:41:55] <Tobba> I have to implement Index for it then
[21:42:00] <Tobba> or that yeah
[21:42:02] <cmr> or not use [] :)
[21:42:02] <eddyb> Tobba: nono don't do that :)
[21:42:12] <eddyb> unsafe pointers are hard to use for a reason
[21:42:16] <Matthias247> std::ptr::offset
[21:42:17] <Tobba> fair enough
[21:42:31] *** Joins: koute (kouteiheik@moz-8F718F09.neoplus.adsl.tpnet.pl)
[21:42:32] <Tobba> also offset + mutables is the most annoying thing ever
[21:42:46] <eddyb> if it semantically corresponds to a &mut [u8], cast it to that
[21:43:30] *** Joins: twi (Adium@moz-DC24E4B0.static.tpgi.com.au)
[21:43:34] <Tobba> I want to keep it unsafe
[21:43:40] <Tobba> because the shit I'm doing with it IS radically unsafe
[21:43:46] *** Quits: not_gavin (gavin@E04DED12.5AA33DAB.2321E71E.IP) (No route to host)
[21:43:52] <cmr> Index is safe-only.
[21:43:57] *** Quits: nkoep (nik@moz-C574095A.pool.mediaways.net) (Quit: Leaving)
[21:44:04] *** Joins: not_gavin (gavin@E04DED12.5AA33DAB.2321E71E.IP)
[21:46:09] <Tobba> there needs to be a mutable version of offset though
[21:46:20] <ktt3ja> cmr: why do you need to define lang item if it's already there?
[21:46:21] <Tobba> casting between everything is getting rediclous
[21:46:31] <cmr> ktt3ja: it isn't already there.
[21:46:44] <cmr> ktt3ja: the standard library defines the language items. if you're not using the stdlib, you need to define them yourself.
[21:47:10] <Ke> tutorial mentions destructors but not, how you can create them by yourself
[21:47:21] <cmr> Ke: implement the Drop trait.
[21:47:24] <Tobba> implement the Drop trait iirc
[21:47:25] <GreyKnight> impl Drop
[21:47:31] <GreyKnight> hey I was right :-D
[21:47:35] <ktt3ja> cmr: oh, I get it now
[21:47:38] <Tobba> I think I'm getting this
[21:47:41] <GreyKnight> (why isn't it "Droppable" BTW?)
[21:47:43] <Ke> is there some listing of traits
[21:47:55] <cmr> GreyKnight: We don't use *able, as a mater of tyle.
[21:47:57] <cmr> *style
[21:48:03] <cmr> Ke: not really?
[21:48:04] <Ms2ger> *stylable
[21:48:12] <Tobba> whats the recommended naming
[21:48:17] *** Quits: synackse (jordyd@moz-5289C68.jax.bellsouth.net) (Quit: synackse)
[21:48:21] <Ke> ok thanks
[21:48:21] <diverse> GreyKnight: and it's not rust style to be verbose apparently -_-
[21:48:23] <cmr> https://github.com/mozilla/rust/wiki/Note-style-guide
[21:48:32] <cmr> Ke: there's the API docs, but there's no master list or anything.
[21:48:36] <GreyKnight> surprised it's not "Drp" ;-)
[21:48:41] <Ms2ger> "D"
[21:48:43] <eddyb> Derp
[21:48:54] <cmr> "dtr T { ... }"
[21:49:02] <eddyb> cmr: sheesh
[21:49:08] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[21:49:26] <eddyb> that's a source for nightmares right there
[21:49:28] <Ke> yup
[21:49:38] <GreyKnight> dtr?
[21:50:03] <cmr> hypothetical super short syntax for giving a type T a destructor :)
[21:50:03] <Ms2ger> dtor
[21:50:07] <cmr> (dtor is short for destructor)
[21:50:54] *** Quits: voodoo123x (voodoo123@9A7D7532.E41C179B.EDDD61E1.IP) (Quit: Bye)
[21:51:11] <eddyb> cmr: ~T{self.foo();}
[21:51:22] <cmr> mmm even better
[21:51:31] <cmr> I looked for a unicode bulldozer but couldn't find one
[21:51:36] <cmr> (was going to make an APL joke)
[21:51:36] <eddyb> hahaha
[21:51:40] <Ms2ger> impl ~T for ~T { ... }
[21:51:51] <eddyb> Ms2ger: don't even go there
[21:51:56] <Ms2ger> :D
[21:52:10] <diverse> wth?
[21:52:25] <eddyb> oh, hey, can we do impl (+Point->Point) for Point?
[21:52:26] <GreyKnight> cmr: how about ☠
[21:52:33] *** Joins: kermie (Mibbit@moz-B234C23B.rev.numericable.fr)
[21:52:35] <eddyb> to impl Add<Point, Point>
[21:52:43] <cmr> GreyKnight: ohh not bad.
[21:52:46] <eddyb> or impl (Point+Point)->Point
[21:53:03] <Ms2ger> impl (Point  Point) -> Point
[21:53:22] <Tobba> I have this static_alloc_array thing which returns a &mut [T]
[21:53:31] <Tobba> should I make it call init() on the object before returning it
[21:53:31] <cmr> impl (Foo ☢ Foo)
[21:53:43] *** Joins: bheylin (brianheyli@moz-8255E94E.adsl.online.nl)
[21:54:00] <cmr> Tobba: what's init do?
[21:54:08] <Tobba> the init intrinsic
[21:54:11] <cmr> ah
[21:54:19] <eddyb> Ms2ger: heeeey, cross vs dot
[21:54:19] <cmr> maybe? I don't think so.
[21:54:24] <pyon> What is the syntax for transmuting a "&T" into a "&mut T"?
[21:54:34] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[21:54:38] <GreyKnight> ♻
[21:54:39] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Connection reset by peer)
[21:54:40] <Ms2ger> /* Don't do that */
[21:54:41] <cmr> pyon: let x: &mut T = transmute_mut(foo);
[21:54:45] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[21:54:50] <pyon> cmr: ty!
[21:54:52] <cmr> in an unsafe block, of course.
[21:55:02] <eddyb> pyon: you're sure you don't want to use Cell or RefCell?
[21:55:14] <ion> pyon: “What could possibly go wrong?”
[21:55:14] *** Joins: syst3mw0rm (quassel@moz-162AE103.compute-1.amazonaws.com)
[21:55:26] <pyon> eddyb: Really sure. I want *concurrent* writes to different portions of the same file.
[21:55:44] <Ms2ger> split()?
[21:56:07] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:56:08] <Ms2ger> Or mut_split_at
[21:56:19] *** Quits: FreeFull (freefull@moz-D824BA79.as13285.net) (Connection reset by peer)
[21:56:23] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[21:56:26] <cmr> Ah that's a good idea!
[21:56:30] <cmr> Use std::os::MemoryMap :)
[21:56:57] <eddyb> Ms2ger: maybe we should allow custom operators, like Haskell (#[lang=">.>"] maybe?) - but allow any Unicode symbols :P
[21:57:10] <Ms2ger> Well, how about...
[21:57:14] <eddyb> it's a shame I can't type a dot or a cross with this layout...
[21:57:16] <Ms2ger> NO NO NO NO NO NO NO NO NO NO NO
[21:57:16] <diverse> eddyb: lovely ♥
[21:57:19] <pyon> cmr: But that is not compatible with std:io::fs::File, is it?
[21:57:30] <cmr> pyon: no
[21:58:01] *** Quits: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net) (Ping timeout)
[21:58:31] *** Quits: nobody (nobody@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[21:58:34] <eddyb> parsing isn't that bad, though precedence could be an issue
[21:58:44] <GreyKnight> IMO 😻  would be the best operator
[21:58:50] <pyon> eddyb: Parsing Haskell is insane.
[21:58:58] <Ms2ger> s/Parsing//
[21:59:02] *** Joins: nobody (nobody@moz-7E09A266.neo.res.rr.com)
[21:59:21] <pyon> I mean, Haskell is a joy to program in, but I would not like to write a parser for it.
[21:59:26] *** Joins: bletch (Mibbit@A102AA62.87262080.406B3504.IP)
[21:59:49] *** Quits: bletch (Mibbit@A102AA62.87262080.406B3504.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:00:10] *** Joins: mib_2otfl9 (Mibbit@A102AA62.87262080.406B3504.IP)
[22:00:16] <eddyb> we don't have that kind of pattern matching, but traits should do - as long as we fix the multiple non-conflicting implementations issue
[22:00:21] *** Quits: mib_2otfl9 (Mibbit@A102AA62.87262080.406B3504.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:01:21] <pyon> The main thing Rust's pattern matching needs to compete with Haskell's is a "continue" instruction for returning to the "match", when inside of a case.
[22:01:33] <diverse> ˙·٠•●♥ Pattern Matching ♥●•٠·˙
[22:01:39] <cmr> wouldn't that just make it a loop?
[22:01:44] <pyon> cmr: Indeed.
[22:01:56] <eddyb> pyon: put it in a loop?
[22:01:56] <pyon> cmr: It would eliminate lots of "loop { match ..." boilerplate.
[22:02:00] <GreyKnight> diverse: p😻 ttern m😻 tching
[22:02:17] <eddyb> Rust doesn't have function-level pattern matching, which is quite powerful in Haskell
[22:02:24] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Ping timeout)
[22:02:42] <pyon> eddyb: The main use for function-level pattern matching is making recursive functions.
[22:02:50] <eddyb> hmm, come to think of it, the ES7 plan for overridable operators implements dynamic dispatch in a way similar to a static fn(A, B) -> R method on an Operation<A, B> trait
[22:02:56] <pyon> Which is why, in an imperative language, the analog would be allowing "match" to loop.
[22:03:14] <eddyb> recursive functions should be optimized into a loop by LLVM
[22:03:30] <pyon> eddyb: Pretty sure that does not play nicely with lifetime management.
[22:03:47] <eddyb> sometimes it plays nicer than a loop
[22:04:01] *** Joins: dev14 (devarshdes@B4276BCF.C06AD1DD.3FBA778E.IP)
[22:04:56] <pyon> In Haskell, which does not have a notion of lifetimes, loops and recursion are equivalent. But, in a language with lifetimes and destructors, the difference is that recursion creates a stack of not-yet-deallocated objects.
[22:05:44] *** Quits: dev14 (devarshdes@B4276BCF.C06AD1DD.3FBA778E.IP) (Quit: dev14)
[22:06:02] <pyon> (Well, perhaps not, if you use move semantics to move everything into the recursive call, but now *that* is ugly.)
[22:06:44] *** Quits: kermie (Mibbit@moz-B234C23B.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[22:06:47] *** Joins: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP)
[22:07:12] *** Joins: negativezero (negativeze@moz-4E59833B.public.wayport.net)
[22:07:54] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[22:08:08] *** Joins: mib_jjp7dh (Mibbit@FC961F87.FE01CCA2.2662C207.IP)
[22:09:12] *** Quits: mib_jjp7dh (Mibbit@FC961F87.FE01CCA2.2662C207.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:09:48] *** Quits: kvanb (kvanb@moz-25C48B43.lns11.lon.bigpond.net.au) (Quit: kvanb)
[22:10:10] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[22:11:00] <flu-> So I'm updating some rust code that I wrote back in June. Where would be the best place to find a summary of changes to things like closure syntax and glob import statements?
[22:11:11] <cmr> flu-: changelog
[22:11:15] <cmr> https://github.com/mozilla/rust/blob/master/RELEASES.txt
[22:11:22] <flu-> got it - thanks cmr!
[22:11:35] <GreyKnight> woohoo rustc finally built :-D
[22:11:45] <cmr> you could also browse through http://cmr.github.io/blog/categories/this-week-in-rust/, breaking changes are listed first.
[22:12:19] <diverse> cmr: getting a 404 on that
[22:12:26] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[22:12:55] <eddyb> pyon: what would be interesting, perhaps, a break with an expression to "return" a value from a loop
[22:12:59] <cmr> diverse: cannot repro
[22:13:09] <cmr> diverse: did your irc client highlight the comma?
[22:13:09] <SiegeLord> diverse: Lose the trailing comma
[22:13:12] <diverse> ah, stupid terminal feature that opens the link with the ','
[22:13:50] <eddyb> pyon: and a way to do a fold with a for loop. combine those three features into one and it might look good
[22:14:05] <diverse> cmr: yeah it highlights the ',' with it, unfortunately
[22:14:06] <SiegeLord> It's a valid URL, strictly speaking
[22:14:28] <SiegeLord> One just has to properly delimit one's URL fragments ;)
[22:14:41] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[22:14:47] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[22:15:10] <SiegeLord> http://en.wikipedia.org/wiki/,
[22:16:15] <pyon> eddyb: Yes!
[22:16:29] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[22:16:49] *** Joins: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de)
[22:16:58] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[22:17:07] *** Joins: mintwurm (Mibbit@moz-DDBF516C.unity-media.net)
[22:17:14] <mintwurm> hi
[22:17:32] <mintwurm> is there an estimate when the official tutorial will be updated to rust 0.9 ?
[22:17:38] <pyon> eddyb: Actually, I have been thinking about this slightly different version - make "loop" break by default (with the value of the last expression), eliminate the "break" keyword, and make "loop" a "continuable context" of sorts.
[22:17:41] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[22:17:43] <mintwurm> the website already has a link to manual (0.9)
[22:17:44] <cmr> mintwurm: it was released upgraded to 0.9
[22:17:59] *** Quits: twi (Adium@moz-DC24E4B0.static.tpgi.com.au) (Connection reset by peer)
[22:18:00] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[22:18:06] <mintwurm> cmr: in the manual text there are still @ pointers 
[22:18:09] *** Joins: twi (Adium@moz-DC24E4B0.static.tpgi.com.au)
[22:18:12] <mintwurm> i thought those were deprecated
[22:18:15] <cmr> They are.
[22:18:19] <cmr> They still exist, though.
[22:18:27] *** Quits: wting (wting@E31B3884.E538DA90.20F09BA6.IP) (Quit: leaving)
[22:18:45] *** Quits: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[22:18:52] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:19:02] <pyon> eddyb: That way, "loop" would be an expression like everything else in the language.
[22:19:17] *** Quits: negativezero (negativeze@moz-4E59833B.public.wayport.net) (Ping timeout)
[22:19:19] <mintwurm> cmr, my bad
[22:19:25] <mintwurm> i meant tutorial not manual
[22:19:32] <mintwurm> in the tutorial for 0.9 on the rust website
[22:19:35] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Connection reset by peer)
[22:19:35] <cmr> ah
[22:19:35] *** Joins: ptc1 (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:19:36] *** ptc1 is now known as ptc
[22:19:47] <cmr> well, the tutorial that is up is the tutorial that will continue to be up for 0.9
[22:19:51] <cmr> we don't backport fixes.
[22:19:58] <eddyb> "oops"
[22:20:06] <mintwurm> but the tutorial is severely misleading
[22:20:07] <cmr> oops indeed :)
[22:20:16] <GreyKnight> oh that is why I was confused then :-)
[22:20:19] <mintwurm> it shows the use of @ for managed pointers
[22:20:20] <cmr> I thought I had removed @ from the tutorial, though...
[22:20:32] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[22:20:59] <diverse> it wouldn't hurt to update the 0.9 tutorial anyway, right?
[22:21:02] <pyon> @ has been removed from the language?
[22:21:11] <eddyb> cmr: you bad grep-fu doomed us all to an @pocalypse!
[22:21:12] <diverse> pyon: no, behind a feature gate
[22:21:14] <cmr> pyon: it's behind a feature flag.
[22:21:19] <mintwurm> pyon: its deprecated
[22:21:19] <pyon> cmr: diverse: Ah!
[22:21:20] <cmr> eddyb: no, I don't think I ever sent the PR.
[22:21:24] <eddyb> *your (and my bad grammer)
[22:21:44] <pyon> mintwurm: Nice. :-)
[22:21:46] <mintwurm> @ is quite present in the tutorial
[22:21:49] <eddyb> cmr: part of your TODO list?
[22:22:10] *** Quits: Arthur_D (Trillian@4C6DBBFE.447CD3C0.2D7E49EB.IP) (Quit: Verlassend)
[22:22:19] <mintwurm> oh, i got to leave
[22:22:22] <mintwurm> bye
[22:22:31] *** Quits: mintwurm (Mibbit@moz-DDBF516C.unity-media.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:23:59] <koute> Is there a good reason for this or is this just an arbitrary limitation? "error: cannot provide an extension implementation where both trait and type are not defined in this crate"
[22:24:25] <cmr> koute: otherwise you wouldn't be able to link arbitrary crates together, method names could collide.
[22:25:09] <koute> Couldn't those methods be made private only?
[22:25:26] <cmr> Hm, probably.
[22:25:40] *** Joins: quibbit (Mibbit@BCC297D1.3B817DBB.67D94052.IP)
[22:25:43] *** Quits: twi (Adium@moz-DC24E4B0.static.tpgi.com.au) (Quit: Leaving.)
[22:25:53] <GreyKnight> are there any non-@ tutorials then? :-)
[22:26:04] <cmr> GreyKnight: the tutorial doesn't *only* use @
[22:26:07] <cmr> but it includes @
[22:26:15] <Matthias247> just skip the lines with @s ;)
[22:26:31] <GreyKnight> s/^.*@.*$//
[22:26:34] *** Quits: entro (centro@moz-6398EFDF.dclient.hispeed.ch) (Quit: Leaving)
[22:26:46] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[22:26:47] <quibbit> Show me Rust's functional programming features!
[22:26:49] <cmr> rust for rubyists doesn't have any.
[22:27:44] <eddyb> quibbit: stack closures. you can do some things, but not all of them
[22:27:45] *** Quits: quibbit (Mibbit@BCC297D1.3B817DBB.67D94052.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:28:06] <eddyb> I still hope I can get variadic generics in before 1.0 - where is nmatsakis btw?
[22:29:06] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[22:29:41] <cmr> eddyb: he doesn't work full-time on rust you know
[22:30:01] <eddyb> cmr: just saying that I haven't seen him around
[22:30:28] <GreyKnight> cmr: why not, what are we paying him for?! :o)
[22:30:38] <flu-> hmm, are we not using *.rc files for crate metadata anymore?
[22:30:45] <eddyb> as in, not at all last week. though there's a lot of chatter during the night here. gotta love timezones :(
[22:30:59] <cmr> GreyKnight: he's a research engineer.
[22:31:06] <cmr> flu-: no
[22:31:17] <cmr> flu-: the convention is to use lib.rs for libraries and main.rs for binaries.
[22:31:19] <flu-> cmr: The guide says lib.rs now - is that correct?
[22:31:21] <cmr> yes.
[22:31:23] <flu-> gotcha, thanks again 
[22:32:46] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:32:58] <SingingBoyo> anyone know how rust-http is doing?  specifically whether it'd work for using github APIs?
[22:33:06] <cmr> SingingBoyo: it should, yes.
[22:33:15] <cmr> ChrisMorgan wants to rewrite it.
[22:33:56] <eddyb> GreyKnight: maybe he works more and chats less. I should learn to do that
[22:35:07] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[22:35:33] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[22:35:55] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[22:37:07] <lennart> I keep getting "error: cannot provide an extension implementation where both trait and type are not defined in this crate"
[22:37:11] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[22:37:18] <lennart> so is there no way to implement imported traits for imported types?
[22:37:23] <cmr> lennart: no.
[22:37:30] <ktt3ja> how do I compare a @str with a &'static str?
[22:37:43] <cmr> ktt3ja: "foo" == s should work
[22:37:47] <cmr> if not, s.as_slice()
[22:37:49] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[22:39:05] <lennart> so then is one's best bet submitting pull requests on relevent libraries? :)
[22:39:11] <ktt3ja> cmr: thanks :)
[22:39:24] <cmr> lennart: you can use a newtype to wrap the type you want to implement the trait for, and implement the trait for that newtype.
[22:39:36] <cmr> (`struct NewType(OldType);`)
[22:40:02] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[22:40:37] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:40:49] <lennart> ah, right, thanks
[22:43:30] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[22:43:33] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:43:34] *** Quits: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se) (Quit: Ex-Chat)
[22:45:02] *** Joins: wting (wting@E31B3884.E538DA90.20F09BA6.IP)
[22:45:11] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[22:45:53] <igork> if i understand correctly, #[deriving(...)] only works for predefined subset of traits? i mean if i want add support for my trait then i need to hack compiler?
[22:45:59] *** Quits: blank_name (blank_name@C5C84EB0.9E887BEB.53C6B850.IP) (Quit: leaving)
[22:46:07] <cmr> igork: atm yes.
[22:47:23] <pyon> In what order are Rust objects destroyed? Fields before struct, or fields after struct?
[22:47:58] *** Quits: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP) (Client exited)
[22:48:02] <cmr> pyon: fields after struct. how would fields before struct even work?
[22:48:06] <igork> cmr, thanks. its was just theoretical question, trying to feel limits of language...
[22:48:09] <pyon> Oh, right.
[22:48:27] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[22:48:27] <cmr> igork: there's a pull request (loadable syntax extensions) that paves the way for custom deriving.
[22:48:50] <cmr> igork: it doesn't let you use #[deriving(CustomTrait)] yet, but you could write a #[deriving_CustomTrait] (ie, new attribute).
[22:48:54] *** Quits: bheylin (brianheyli@moz-8255E94E.adsl.online.nl) (Quit: bheylin)
[22:49:16] *** Quits: GreyKnight (GK@moz-4E38896B.range86-176.btcentralplus.com) (Quit: zzz)
[22:49:59] <igork> cmr, aha, cool. will look into it
[22:50:24] *** Joins: bheylin (brianheyli@moz-8255E94E.adsl.online.nl)
[22:50:26] <eddyb> cmr: does it allow you to use the fancy ext::deriving tools?
[22:50:37] <eddyb> maybe those should be refactored to make it even easier :D
[22:50:43] <cmr> if they're public.
[22:50:50] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:51:05] <eddyb> cmr: well, the entire module tree is public :P
[22:51:50] *** Quits: bheylin (brianheyli@moz-8255E94E.adsl.online.nl) (Quit: bheylin)
[22:51:55] <eddyb> (I know there's a deriving::generic which makes it easier to construct generic derived impls)
[22:54:55] *** Quits: fabiand (fabiand@moz-D097DE75.adsl.alicedsl.de) (Quit: Verlassend)
[22:55:05] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[22:55:51] *** Joins: blank_name (blank_name@C5C84EB0.9E887BEB.53C6B850.IP)
[22:55:56] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[22:56:38] <flu-> Again, I've got a rust-bindgen specific question (related to this issue - https://github.com/crabtw/rust-bindgen/issues/29 ) has anyone found a way to deal with this shy of ripping out all references to va_list in the bindings?
[22:56:46] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[22:57:36] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:57:51] <cmr> flu-: we don't suport va_list's
[22:58:05] <cmr> you just won't be able to bind those functions.
[22:58:10] <flu-> I saw something similar in the September 2013 logs for this channel
[22:58:34] <flu-> ok, so ripping 'em out is actually the right thing to do. 
[22:58:47] <cmr> yep
[23:01:33] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[23:02:06] <flu-> &str used to have an "as_c_str" method - what's the preferred way to convert &str to char* now?
[23:03:27] *** Quits: goran (goran@B83196FF.C26CF587.3C521BE1.IP) (Quit: leaving)
[23:04:45] <Ms2ger> with_c_str?
[23:04:49] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:05:07] <flu-> Ms2ger: checking...
[23:05:41] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (Ping timeout)
[23:06:33] <flu-> Ms2ger: looks good. Thanks for that. Time to go digging around the stdlib docs for a while
[23:06:36] *** Joins: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP)
[23:07:04] <Ms2ger> Np
[23:07:16] <eddyb> hmm, couldn't with_c_str use alloca (for relatively small strings) so it doesn't allocate when that would be an extra overhead?
[23:08:15] <flu-> *shrug* - I just want my 7 month old code to compile with 0.9 :-)
[23:09:04] <eddyb> (I remember strcat talking about extern "llvm" and directly accessing llvm.* intrinsics - does that work without any other changes?)
[23:09:18] *** Quits: synackse (jordyd@moz-5289C68.jax.bellsouth.net) (Quit: synackse)
[23:11:48] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[23:11:50] <Matthias247> eddyb: I guess CString could contain a fixed size buffer as member which would allow that
[23:12:12] <Matthias247> if the size is bigger than the fixed size than allocate, otherwise use the fixed size
[23:12:20] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[23:12:47] <erickt> hrm, I thought I made a faster with_c_str that uses alloca for small strings...
[23:13:00] <cmr> we don't have alloca?
[23:13:25] <erickt> cmr: I mean a `[u8, .. 16]` on the stack
[23:13:27] <erickt> or something
[23:13:29] <cmr> ah
[23:13:33] *** Joins: kzzch (kzzch@moz-BB97B490.washdc.fios.verizon.net)
[23:14:23] <erickt> cmr / flu-: yep I did make one. c_str::with_c_str does use a stack buffer for strings < 128 bytes
[23:15:11] <erickt> err, I mean `"foo".with_c_str(...)`
[23:15:28] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[23:16:04] *** Quits: Ms2ger (Ms2ger@D324D80C.3387515C.187A1082.IP) (Quit: nn)
[23:16:25] *** Joins: mib_mhwrg6 (Mibbit@moz-124D67EB.neoplus.adsl.tpnet.pl)
[23:16:59] <Matthias247> erick: ah, i see it
[23:17:08] <Matthias247> // The length of the stack allocated buffer for `vec.with_c_str()`
[23:17:08] <Matthias247> static BUF_LEN: uint = 128;
[23:17:14] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[23:17:30] <cmr> erickt: does it at least branch before doing so, so that it doesn't unconditionally suck up stack?
[23:17:45] <cmr> I suppose I could look
[23:17:48] <cmr> :p
[23:17:54] <erickt> cmr: it does
[23:18:02] <erickt> I'm not sure if that matters though
[23:18:14] *** Joins: int3_ (int3_@6647F17C.C24D7B6A.EC6C369A.IP)
[23:18:29] <erickt> I thought llvm allocas the whole stack frame at once for a function body
[23:18:43] <dbaupp> cmr: eating 128 bytes of stack a time! how utterly irresponsible
[23:18:48] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[23:18:49] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Ping timeout)
[23:18:50] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[23:18:51] <cmr> it'd be a branch and a function call, yeah.
[23:18:59] <cmr> dbaupp: :P
[23:19:09] *** Quits: mib_mhwrg6 (Mibbit@moz-124D67EB.neoplus.adsl.tpnet.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[23:19:31] *** Parts: egghead (egghead@7851DE85.C82F6435.20F09BA6.IP) (WeeChat 0.3.7)
[23:20:35] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[23:21:11] <Matthias247> I like the rust doc with the ability to switch to the source code really good
[23:21:21] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[23:21:37] <Matthias247> especially because the source code is really good readable (compared to a c++ stdlib)
[23:21:50] *** Joins: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au)
[23:22:14] <dbaupp> wait until we get allocator support!
[23:23:14] *** Quits: Valtis (Valtis@moz-7A6DF574.kymp.net) (Ping timeout)
[23:23:28] *** Joins: a_m0d|home (a_m0d@moz-322A4DE4.acanac.net)
[23:23:42] *** Joins: Valtis (Valtis@moz-7A6DF574.kymp.net)
[23:23:55] *** Parts: kozikow (textual@36D12E7.4B9DC31C.413A0BDB.IP) (Textual IRC Client: www.textualapp.com)
[23:28:41] *** Quits: Matthias247 (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de) (Connection reset by peer)
[23:30:13] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:30:57] *** Quits: alonlevy (alon@moz-30492E92.bb.netvision.net.il) (Ping timeout)
[23:32:49] *** sam113101 is now known as sam113101_afk
[23:32:54] *** sam113101_afk is now known as sam113101
[23:34:26] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[23:34:34] *** Joins: Matthias247 (Matthias24@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de)
[23:34:40] *** Joins: WebeWizard (Mibbit@moz-7CCD1DAE.ks.ks.cox.net)
[23:34:44] *** Quits: valenting (Thunderbir@23EF5095.ECBF5C84.FB866788.IP) (Quit: valenting)
[23:35:05] <WebeWizard> hey guys. How do you suppose I go about converting something like an int in base 10 to hex?
[23:36:02] <WebeWizard> let x: int = 42; let y: ~str = x.to_str_radix(16);
[23:36:08] <WebeWizard> is the closest i've seen
[23:36:38] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[23:37:49] <ercxx> w
[23:37:52] *** Quits: TisButMe (Mibbit@moz-5233EFA9.w92-144.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[23:37:58] <ercxx> sorry
[23:39:19] *** Quits: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[23:40:27] *** Joins: mitja (Mibbit@B14D1387.F3F635F6.3E006838.IP)
[23:40:40] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[23:40:46] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Input/output error)
[23:41:51] *** Joins: synackse (jordyd@moz-5289C68.jax.bellsouth.net)
[23:43:05] <WebeWizard> nvm, forget I said anything
[23:44:01] *** Joins: dangets (dangets@moz-E9E4A77B.cpe.cableone.net)
[23:44:36] *** Quits: lkuper (lkuper@802AC8C7.A0D37E9B.51B6877.IP) (Quit: lkuper)
[23:45:33] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[23:45:38] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:47:14] *** Joins: mw1001_ (mw1001@moz-17825C76.cable.virginm.net)
[23:47:15] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[23:49:19] *** Joins: demize (kyrias@moz-D002D976.kyriasis.com)
[23:49:22] *** Quits: mw1001_ (mw1001@moz-17825C76.cable.virginm.net) (Quit: Ex-Chat)
[23:49:48] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[23:51:03] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[23:52:07] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:52:10] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[23:53:05] *** Joins: arcnor (arcnor@moz-C48B224D.lns20.syd7.internode.on.net)
[23:54:00] <arcnor> hi there, I have a very noob question
[23:54:17] <arcnor> where is exactly the rust compiler (rustc) getting the definition of println, for example?
[23:54:21] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[23:54:40] <arcnor> I know it comes from the libstd, but I don't see the file itself on my system
[23:54:41] * geomyidae_ wants a rust meetup in seattle
[23:55:42] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[23:56:50] <SiegeLord> arcnor: http://static.rust-lang.org/doc/master/src/std/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libstd/io/stdio.rs.html#228-233 ?
[23:57:05] <diverse> http://static.rust-lang.org/doc/master/std/io/stdio/index.html
[23:57:20] <SiegeLord> lol at that link length though... rustdoc is very thorough about making sure the paths are right
[23:57:23] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[23:57:27] <arcnor> yeah, I know it comes from that file, but maybe I didn't formulate my question correctly :)
[23:57:35] <arcnor> is rustc reading that file at all?
[23:57:49] <arcnor> or it knows the definition just reading the dylib/so file?
[23:57:56] *** Quits: atomical (atomical@moz-C92D67E2.library.northwestern.edu) (Ping timeout)
[23:58:04] <diverse> because it's in the prelude, which is included in all rust programs
[23:58:04] <SiegeLord> Oh, the definition is inside the library file
[23:58:20] <dbaupp> arcnor: there is a pile of Rust specific metadata in the so/dylib
[23:58:24] <arcnor> my problem is, I'm creating a plugin for an IDE, and I don't know if the user needs to have the sources lying around or they only need to have rustc
[23:58:32] <arcnor> ohh, I see
[23:59:12] <dbaupp> there's a description of the various output formats here http://static.rust-lang.org/doc/master/rust.html#linkage
[23:59:16] *** Joins: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net)
[23:59:17] <arcnor> so the "correct" way of reading definitions will be reading the libraries metadata themselves, as they are the source of truth, then
[23:59:24] <dbaupp> yes
[23:59:43] <dbaupp> the library metadata is our equivalent to C/C++ header files
[23:59:55] <arcnor> that's very smart :)
