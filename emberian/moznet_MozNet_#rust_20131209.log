[00:02:39] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[00:03:44] *** Joins: schnozzle (Mibbit@moz-B6D4F407.protectedgroup.com)
[00:04:10] *** Quits: schnozzle (Mibbit@moz-B6D4F407.protectedgroup.com) (User has been banned from Mozilla (no spamming here))
[00:04:19] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[00:06:27] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[00:06:55] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[00:07:44] <aatch> For reference on the "not recompile things that haven't changed" front, it's not as simple as it seems. Everybody thinks of the C-style recompilation, but forgets about the fact that changing 1 file in C++ can require rebuilding a large portion of the project.
[00:08:57] <SiegeLord> That "can" is a big difference from Rust's "absolutely will"
[00:09:02] <aatch> Since C++ headers can often contain actual code (because of templates), there can be long chains of dependencies that require a rebuild of a lot of code simply because of a single file change.
[00:10:00] <dbaupp> apparently firefox(?) is moving to just cat-ing all the C++ files together and compiling in one big chunk and seeing dramatic performance improvements.
[00:10:01] <aatch> SiegeLord, the point is that Rust has a similar issue in that dependencies aren't neatly separated.
[00:10:47] <SiegeLord> Sure, but in C++ you have a choice not to do that by avoiding templates/using techniques like PIMPL
[00:11:15] <SiegeLord> If you make your C++ project so brittle, you've got only yourself to blame
[00:11:17] <FreeFull> Headers are flawed anyway
[00:11:41] <dbaupp> SiegeLord: one can use crates to achieve something similar in Rust?
[00:12:02] <SiegeLord> Yes, but I think there's a different mentality
[00:12:40] <SiegeLord> Crates are advertised as totality of a library/executable
[00:12:49] <SiegeLord> rustpkg is incapable of dealing with multiple crates etc
[00:13:00] <SiegeLord> The whole ecosystem today is built upon large crates
[00:13:22] <dbaupp> the current behaviour of rustpkg shouldn't be taken as the "true"/desired behaviour.
[00:13:29] <dbaupp> bugs, etc.
[00:13:35] <SiegeLord> It's a design bug
[00:15:18] <FreeFull> Rust isn't at 1.0 yet
[00:15:38] <SiegeLord> I'm not really seeing proposals for this :P
[00:15:42] <SiegeLord> *to fix this
[00:15:55] <SiegeLord> "just use multiple crates" and "parallelize LLVM" are sort of unrealistic
[00:16:08] *** Quits: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo)
[00:16:10] <aatch> SiegeLord, what do you propose then?
[00:16:23] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[00:16:47] <dbaupp> Random fact: rust has precisely 333 contributors according to github.
[00:16:48] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[00:16:57] <SiegeLord> I don't know of a good solution
[00:16:59] <dbaupp> SiegeLord: the LLVM_parallelisation is already done
[00:17:05] <dbaupp> s/_/-/
[00:17:06] <SiegeLord> I'd have to explore how other languages do it
[00:17:08] <dbaupp> by others
[00:17:12] <dbaupp> (intel, iirc)
[00:17:18] <dbaupp> it just needs to be merged
[00:17:24] <SiegeLord> Well, if it works, then great ;)
[00:17:28] * dbaupp hopes that it will actually be merged.
[00:17:46] <SiegeLord> It's still not an answer to incremental compillation
[00:18:21] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[00:18:34] <SiegeLord> Recompiling 1000 objects in parallel will still be slower than just recompiling one
[00:19:08] <aatch> SiegeLord, but doing that properly is less realistic than parallelize LLVM.
[00:19:20] <o11c> I've thought a lot about how to avoid the header problem but keep separate compilation
[00:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[00:19:34] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[00:19:41] <o11c> The brief version is: *generate* headers as one of several intermediate stages
[00:19:45] *** Quits: saati (s@moz-11469F61.harmless.hu) (Ping timeout)
[00:19:50] <o11c> don't be afraid to create half a dozen intermediate files
[00:20:12] <aatch> As in, the amount of work that the compiler needs to support it is significant.
[00:20:18] *** Quits: Ke (jkarlson@moz-785A3407.org.aalto.fi) (Ping timeout)
[00:20:22] *** Joins: ofeldt- (ofeldt@moz-FDBE325.dip0.t-ipconnect.de)
[00:20:22] <SiegeLord> Well, you can do separate compillation with D without headers
[00:21:09] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[00:21:15] <o11c> it doesn't necessarily mean a C-style header ... the important thing is that it doesn't change just because the actual source file changed
[00:21:18] *** Quits: ofeldt (ofeldt@moz-7F23E0EE.dip0.t-ipconnect.de) (Ping timeout)
[00:21:32] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Client exited)
[00:21:51] <SiegeLord> I'd maybe propose some sealed module idea... which is sort of like an implicit crate
[00:22:01] <SiegeLord> But that's just an idea I had 10 seconds ago
[00:22:17] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[00:22:21] <SiegeLord> Is this really a thing that languages with modules do not have separate compillation?
[00:22:33] <o11c> the only sensible granulaites for separate recompilation are per-function or per-file
[00:22:46] <aatch> I'm not saying there's no benefit to incremental recompilation, but touting it as some sort of cure-all is silly.
[00:23:20] <o11c> aatch: In C++, I can keep my headers small and compile fast.
[00:23:31] <o11c> I hate waiting for the compiler
[00:23:42] *** Joins: Ke (jkarlson@moz-785A3407.org.aalto.fi)
[00:24:24] <aatch> o11c, yes, but sometimes that isn't an option. Performance-critical code can often rely on inlining to get the speed they need. Meaning needing code in headers.
[00:24:42] <aatch> Template usage also requires code in headers.
[00:25:02] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[00:25:02] *** Joins: saati (s@moz-11469F61.harmless.hu)
[00:25:07] <aatch> I get that you have the option to not use those features, but you are intentionally crippling the language.
[00:25:21] <o11c> that's why I'm talking about more intermediate steps
[00:25:47] <o11c> you have the original source, the original source in basic llvm form, the original source in llvm form with inlining, ...
[00:26:09] <o11c> for templates, you can have an earlier stage do dynamic dispatch and a later version do static dispatch
[00:26:13] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[00:27:00] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:27:00] *** ChanServ sets mode: +ao brson brson
[00:27:42] *** Quits: vmx (vmx@moz-48553030.pools.arcor-ip.net) (Quit: Leaving)
[00:27:43] <aatch> Again, I'm not saying this isn't something we should do, but it's difficult to implement. Pretty much the entire compiler is designed with the assumption that the entire crate is available.
[00:28:07] *** Quits: peterdn (chatzilla@moz-3DA3F15F.as13285.net) (Ping timeout)
[00:28:14] <o11c> yeah ... but that's why I'm considering this as the most important problem *before* I write my own compiler
[00:28:25] <o11c> All the other problems with C++ are relatively easy to fix.
[00:28:40] <SiegeLord> I wonder what the thought process behind crate as a compillation unit were...
[00:28:57] <SiegeLord> *was
[00:28:59] <aatch> SiegeLord, it's much easier to reason about.
[00:29:01] <o11c> And if I am forced to make all my templates be java-style generics? So be it.
[00:29:23] <aatch> From a type-checking/correctness point-of-view.
[00:29:37] <SiegeLord> Anyway, if multiple crates is the proposed answer... then the ecosystem (rustpkg etc) needs to support that painlessly
[00:31:21] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[00:31:54] *** Joins: cadence (Mibbit@moz-3CEDD29C.sub-70-209-7.myvzw.com)
[00:32:22] <cadence> Hmmm. I'm stumped. I am trying to add a test for https://github.com/mozilla/rust/pull/10863
[00:32:35] <cadence> but I keep getting: error: type `&std::path::posix::Path` does not implement any method in scope named `join`
[00:33:18] <dbaupp> cadence: you might need `use path::GenericPath;` to import the trait
[00:33:29] <aatch> cadence, you probably haven't imported the trait you need that /does/ have join
[00:33:45] <dbaupp> (the method is from a trait, and to call methods from a trait one needs that trait to be in scope.)
[00:33:55] <dbaupp> in scope unqualified, that is.
[00:34:50] <cadence> dbaupp: I tried that, but I get the same error.
[00:35:18] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[00:35:40] <dbaupp> cadence: hm, do you have a sub `mod`? (if so, is the `use` in that submodule?)
[00:35:42] <cadence> Here is what I have: http://pastebin.com/aG6dSKjc
[00:36:05] <dbaupp> hm, peculiar.
[00:36:07] <cadence> This is within the `mod tests`
[00:36:23] <cadence> of src/libstd/run.rs
[00:37:22] <cadence> (the test is currently incorrect because `expected_e_kind` should be FileNotFound - I am doing this to make sure that my test works.)
[00:37:37] <cadence> (but the test should compile regardless)
[00:38:33] <cadence> Maybe I am running the tests incorrectly?
[00:38:50] <cadence> I am using: make check-stage1-std
[00:39:04] <cadence> Also: make check-stage1-std NO_REBUILD=1
[00:40:55] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[00:41:26] <dbaupp> those should work
[00:41:34] * dbaupp can't tell what is wrong
[00:42:14] <cadence> dbaupp: Can you try pasting that in to your working copy of `src/libstd/run.rs`?
[00:42:18] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[00:42:44] <cadence> (within `mod tests`)
[00:44:02] <dbaupp> cadence: yup, sure; I'm building now
[00:44:15] <cadence> Thanks.
[00:44:57] <dbaupp> (assert!(false) can just be fail!(), btw.)
[00:45:19] *** sam113101 is now known as sam113101_afk
[00:45:20] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[00:45:29] <cadence> Oh, okay. I'll use that. Plus, it gives me a chance to add a message.
[00:45:36] <dbaupp> ok, I see the error message
[00:46:04] <dbaupp> you can do the same with assert: assert!(cond, "message with formatting {} {}", 1, whatever)
[00:46:20] *** Quits: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch) (Input/output error)
[00:46:45] <cadence> dbaupp: You see the "does not implement any method in scope named `join`" error as well?
[00:47:03] <dbaupp> yeah
[00:47:10] *** kimundi is now known as zz_kimundi
[00:47:38] <cadence> Do you think that this is a bug?
[00:48:56] <dbaupp> not sure
[00:49:44] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[00:49:58] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[00:50:06] *** sam113101_afk is now known as sam113101
[00:51:18] <dbaupp> hm, I'm so confused. using `fn foo<G: GenericPath>(x: &G) -> G { x.join("script") } foo(temp_dir.path())` complains about the lack of method
[00:51:30] <dbaupp> (well, lack of GenericPath implementation)
[00:52:10] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[00:52:20] <dbaupp> OH!
[00:52:32] <dbaupp> I think this is due to the weirdness of testing libstd
[00:53:57] <dbaupp> the extra which you are importing TempDir from was compiled with a different version of libstd, so `use path::GenericPath` is importing a different trait (same name, same functionality, but defined in different crates (as far as the compiler knows) so different traits.)
[00:54:19] <dbaupp> I think `use realstd::path::GenericPath` might be a hack to get around this.
[00:55:15] <dbaupp> cadence: also, btw, there is io::result which takes a closure and will automatically catch the condition and convert it to a Result, which might be slightly nicer than manually doing so
[00:55:24] <dbaupp> anyway, gtg.
[00:55:34] <cadence> Okay. Thank you so much!
[00:55:46] <cadence> See you around...
[00:56:01] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[00:56:23] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[00:57:03] *** Quits: cadence (Mibbit@moz-3CEDD29C.sub-70-209-7.myvzw.com) (Quit: http://www.mibbit.com ajax IRC Client)
[00:57:24] <ChrisMorgan> http://stackoverflow.com/questions/20456601/why-cant-i-reuse-a-funtions-borrowed-pointer - is the behaviour I describe correct? And is the actual behaviour reasonable?
[00:58:06] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[00:58:59] *** Joins: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[00:59:23] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[01:00:08] *** Quits: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com) (Ping timeout)
[01:01:09] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[01:01:20] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Quit: Linkinus - http://linkinus.com)
[01:01:34] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[01:02:09] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:02:27] *** sam113101 is now known as sam113101_afk
[01:02:50] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[01:02:55] *** sam113101_afk is now known as sam113101
[01:03:31] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[01:03:52] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[01:05:19] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[01:07:44] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[01:08:44] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:08:45] *** Joins: snerd (motk@moz-D21A06DF.members.linode.com)
[01:09:11] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[01:09:57] *** Quits: refold (gman@moz-42D68426.a258.priv.bahnhof.se) (Quit: leaving)
[01:10:13] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[01:10:27] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[01:13:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:13:47] *** jorendorff_away is now known as jorendorff
[01:15:14] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:17:07] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[01:17:28] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[01:18:15] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[01:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[01:21:09] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[01:23:16] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[01:25:27] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Client exited)
[01:28:32] *** Joins: hjr3 (hradtke@moz-842BF853.hsd1.ca.comcast.net)
[01:31:59] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[01:32:01] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[01:33:23] *** Quits: nkoep (nik@moz-4F8C991D.vpn.rwth-aachen.de) (Client exited)
[01:34:02] *** Quits: blinky (Mibbit@moz-CBD76C21.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[01:38:05] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[01:39:07] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:39:33] *** Joins: kzzch (kzzch@moz-3652E738.pools.spcsdns.net)
[01:39:54] *** kzzch is now known as headcrash
[01:40:00] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:40:45] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[01:41:57] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[01:42:23] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:42:45] <mark_edward> why is the map provided by libstd a hashmap and not an rbtree like in C++ std::map?what are the pros/cons?
[01:43:14] <Amanieu> binary tree are ordered, hashmaps aren't
[01:43:40] <o11c> hashmap has a slightly smaller average-case O() and better cache behavior
[01:43:45] <Amanieu> that means that you can iterate through a binary tree and get all the elements in sorted order
[01:43:48] <Amanieu> but not with a hashmap
[01:43:59] <o11c> treemap has better worst case behavior and offers more operations
[01:44:02] <Amanieu> this is why they are called unordered_map in C++
[01:45:45] *** Quits: jnicholls (uid19542@moz-A42E5B7B.irccloud.com) (Ping timeout)
[01:45:45] *** Quits: jack_ (uid19593@moz-A42E5B7B.irccloud.com) (Ping timeout)
[01:46:44] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:46:48] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[01:46:48] *** ChanServ sets mode: +ao brson brson
[01:47:34] *** Joins: jack_ (uid19593@moz-A42E5B7B.irccloud.com)
[01:47:57] *** Joins: jnicholls (uid19542@moz-A42E5B7B.irccloud.com)
[01:48:02] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[01:49:34] *** Joins: terje (terje@F5FDF11B.1D1EB2D6.85889BB1.IP)
[01:49:38] <headcrash> i just tried the sample code from the closure chapter of the master tutorial and it threw up an error
[01:49:42] <headcrash> error: expected type, found token BINOP(OR)
[01:50:25] <sfackler> which sample?
[01:50:38] <headcrash> er, hold on, i'm not running master so that might be the issue
[01:51:07] <headcrash> nvm, it's my fault
[01:51:17] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:51:26] <o11c> ^ 90% of bug reports ever
[01:51:28] <achin> if i have a enum that i want to be compariable, what is more rustic:  implemnt the Eq trait?  or use #[deriving(Eq)] ?
[01:51:37] <hoverbear> o11c: I think more than that.
[01:51:55] <sfackler> achin: deriving(Eq) implements the Eq trait for you
[01:52:30] <achin> and using deriving is considered idiomatic?
[01:52:34] <dbaupp> ChrisMorgan: https://github.com/mozilla/rust/wiki/Doc-under-construction-FAQ#noncopyable-stack-closures
[01:53:37] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:53:51] <ChrisMorgan> dbaupp: then is borrowing the closure as &|| valid?
[01:54:09] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:54:40] *** Quits: sam113101 (sam113101@moz-83612DFD.us-west-2.compute.amazonaws.com) (Quit: ZNC - http://znc.in)
[01:54:42] <sfackler> achin: yep, unless the definition of equality for your type isn't the "obvious" one, deriving saves a bunch of typing
[01:54:50] <achin> sfackler: cool.  thanks
[01:55:03] <achin> next question:  how can i get fail!() to produce a stacktrace?
[01:55:50] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[01:55:53] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[01:56:47] <sfackler> I don't think there's any backtrace machinery hooked up to failure anymore. you can run in GDB and "catch throw" to break on failure though
[01:56:55] *** Joins: Sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[01:57:09] *** Joins: sam113101 (sam113101@moz-83612DFD.us-west-2.compute.amazonaws.com)
[01:57:35] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[01:57:40] <achin> ah.  are there other macros that would produce a backtrace?
[01:57:53] <achin> (either now, or in the future)
[01:57:59] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[01:58:31] <headcrash> some of this stuff is so over my head :/
[01:59:47] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[02:00:49] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[02:01:06] <sfackler> achin: There used to be a way to dump a backtrace optionally but when Rust switched to the new runtime, I think it got killed off. IIRC it's definitely something that should make it back into the language
[02:01:20] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:01:27] <dbaupp> ChrisMorgan: yeah, that works, I think.
[02:01:33] <achin> cool.  thanks for the info sfackler 
[02:02:28] <headcrash> can someone point me towards a good resource on closures? not necessarily for rust but just the concept in general?
[02:03:07] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[02:03:07] <dbaupp> ChrisMorgan: I think the fundamental problem is || is effectively &mut Env (implementing a hypothetical "Callable" trait), and, apparently || doesn't get reborrowed as "easily" as &mut does.
[02:03:16] <dbaupp> (i.e. at all.)
[02:04:47] *** Joins: headcras1 (kzzch@moz-3652E738.pools.spcsdns.net)
[02:05:28] *** Quits: headcrash (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[02:07:04] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[02:07:27] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:07:27] *** ChanServ sets mode: +ao dherman dherman
[02:08:43] *** Quits: yusukesuzuki (yusukesuzu@moz-FEE44B6.net220148245.t-com.ne.jp) (Ping timeout)
[02:08:46] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:09:00] *** Joins: yusukesuzuki (yusukesuzu@moz-FEE44B6.net220148245.t-com.ne.jp)
[02:10:59] *** Joins: telotort1um (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net)
[02:12:13] *** Quits: telotortium (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net) (Ping timeout)
[02:12:40] *** Quits: hjr3 (hradtke@moz-842BF853.hsd1.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:13:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:13:44] *** jorendorff is now known as jorendorff_away
[02:15:30] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[02:15:45] <bjz> headcras1: var acc = 0; var f = (x) -> { acc += x; print(acc); } f(1); f(2); f(1); // 1 3 4
[02:16:11] <bjz> http://en.wikipedia.org/wiki/Closure_%28computer_science%29
[02:16:18] *** jorendorff_away is now known as jorendorff
[02:17:54] *** Quits: headcras1 (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[02:18:01] <FreeFull> Shouldn't acc be mutable?
[02:18:14] <bjz> FreeFull: pseudo code
[02:18:39] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[02:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[02:20:10] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[02:21:10] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[02:21:52] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[02:22:46] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[02:23:40] <aatch> FreeFull, if you notice, that's also not how you write closures in Rust, we don't have `var` as a keyword and you can't pass an integer to `print`
[02:25:37] *** Joins: kzzch (kzzch@moz-3652E738.pools.spcsdns.net)
[02:27:08] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[02:29:05] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[02:29:52] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[02:30:06] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Connection reset by peer)
[02:32:25] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[02:35:48] <kzzch> so a closure allows a function to access a variable in the enclosing scope, that seems easy enough to understand.
[02:36:32] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[02:38:04] *** Joins: kzzch_ (kzzch@moz-3652E738.pools.spcsdns.net)
[02:38:43] *** Quits: kzzch (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[02:42:01] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Ping timeout)
[02:43:01] *** Joins: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net)
[02:43:16] *** Joins: kzzch (kzzch@moz-3652E738.pools.spcsdns.net)
[02:43:55] *** Quits: kzzch_ (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[02:45:48] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[02:47:08] <dwrensha> dbaupp: thanks for the r+
[02:47:25] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[02:48:12] *** jorendorff is now known as jorendorff_away
[02:48:52] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Quit: Leaving.)
[02:48:54] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[02:49:38] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[02:50:04] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[02:52:12] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[02:53:52] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[02:53:55] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[02:55:12] *** Quits: JanC (janc@moz-6323E888.dsl.scarlet.be) (Connection reset by peer)
[02:57:13] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[02:57:27] *** Quits: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr) (Ping timeout)
[03:00:29] *** sam113101 is now known as sam113101_afk
[03:02:32] <aatch> kzzch, a slightly better way to think about it is a function that implicitly takes variables in the enclosing scope as parameters (similar to 'this' in C++ or Java methods). That helps with understanding stuff like moving in closures.
[03:03:25] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:03:34] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[03:04:24] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[03:04:45] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[03:06:26] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[03:06:45] *** Joins: richard|s (mindginati@C6B91567.BE7F70E3.260B031E.IP)
[03:06:54] *** Quits: richard|s (mindginati@C6B91567.BE7F70E3.260B031E.IP) (Quit: brb)
[03:08:10] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[03:08:54] *** Quits: zz_kimundi (kimundi@moz-F44E1D84.dip0.t-ipconnect.de) (Ping timeout)
[03:09:02] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[03:11:47] *** Joins: zz_kimundi (kimundi@moz-7496AA85.dip0.t-ipconnect.de)
[03:11:59] *** Joins: JanC (janc@moz-8704C2E9.dsl.scarlet.be)
[03:12:15] *** zz_kimundi is now known as kimundi
[03:15:19] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[03:15:55] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[03:16:33] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[03:16:55] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[03:18:17] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[03:18:31] <kzzch> ah, that's another thing, I have no idea what move is.
[03:18:36] *** Joins: kristof (kristof@moz-C03E0B57.lightspeed.frokca.sbcglobal.net)
[03:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[03:19:32] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:19:41] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[03:20:14] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[03:21:07] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[03:21:09] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[03:21:32] <kzzch> I ran into it a couple of times while trying to get my bot working.
[03:22:45] <kzzch> i'm basically learning everything at the same time as i'm trying to learn rust because i never learned c++
[03:22:52] <dbaupp> kzzch: the tutorial has a very recently gained a new section http://static.rust-lang.org/doc/master/tutorial.html#implementing-a-linked-list which include some coverage of "move semantics"
[03:24:25] <dbaupp> *include
[03:24:26] <dbaupp> s
[03:24:27] <dbaupp> :/
[03:24:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[03:27:08] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[03:27:19] <kzzch> thanks, makes sense when i actually read it instead of skimming over it :p
[03:27:35] <kzzch> now i understand the errors I was getting :D
[03:28:10] <dbaupp> strcat: ^ (your tutorial works)
[03:28:22] <dbaupp> kzzch: awesome :D
[03:28:49] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[03:29:13] <kzzch> It's definitely Improved from the .8 tutorial, the syntax is getting easier to understand as well
[03:29:48] <kzzch> i'm learning quite a lot from you guys, it's almost like drinking from a firehose!
[03:31:18] *** Joins: kzzch_ (kzzch@moz-3652E738.pools.spcsdns.net)
[03:31:30] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[03:31:55] *** Quits: kzzch (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[03:32:35] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[03:32:57] <sfackler> welp, I was wondering why librustc was taking so long to build until I realized that sublime text had eaten up all of my memory and I was swapping c.c
[03:34:25] *** Quits: kzzch_ (kzzch@moz-3652E738.pools.spcsdns.net) (Quit: leaving)
[03:38:16] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:39:38] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[03:40:13] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:40:13] *** ChanServ sets mode: +ao dherman dherman
[03:40:30] *** Joins: headcrash (kzzch@moz-3652E738.pools.spcsdns.net)
[03:40:47] *** Quits: headcrash (kzzch@moz-3652E738.pools.spcsdns.net) (Quit: Ex-Chat)
[03:41:12] *** Joins: headcrash (kzzch@moz-3652E738.pools.spcsdns.net)
[03:41:47] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[03:42:11] *** Quits: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net) (Quit: leaving)
[03:42:12] <achin> is there any documenation on the types of macros i have available in a #[test] function?
[03:42:23] <strcat> nothing special
[03:42:43] <sfackler> all of the usual ones
[03:42:45] <sfackler> assert!
[03:42:56] <strcat> it just counts failure as the test failing
[03:42:58] <achin> where are those documented?  or is assert! the only one around?
[03:43:08] <headcrash> so is .9 coming soon?
[03:43:14] <sfackler> assert_eq!, assert_approx_eq!
[03:43:34] <achin> (also, it looks like we are all very excited about talking about assertions)
[03:43:34] <sfackler> achin: they're in a big string in libsyntax/ext/expand.rs :P
[03:43:42] <strcat> headcrash: sure, they're time-based tags on master - they're not supported releases, and don't have any work put into them beyond releasing them
[03:44:03] <achin> sfackler: thanks
[03:44:04] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[03:44:06] <sfackler> it's even better when you define your own macros
[03:44:15] <sfackler> macro_rules! my_thing(..)
[03:44:16] <strcat> headcrash: every 3 months a tag is made on master
[03:44:34] <achin> sfackler: :)
[03:45:07] <strcat> 0.10, 0.11, 0.12, etc. will follow shortly after unless the course is changed
[03:45:16] <headcrash> strcat: ah, i see
[03:46:16] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[03:47:14] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:47:33] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[03:47:54] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[03:48:02] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[03:49:39] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[03:52:21] <achin> i feel like this is a stupid question but:  how to return a borrowed reference to a owned string in a struct?   fn get_name(&self) -> &str { &self._name}  gives me (expected &str but found &-ptr)
[03:53:05] <o11c> achin: don't you need a lifetime on that?
[03:53:08] <sfackler> achin: self.name.as_slice()
[03:53:15] <sfackler> &str is different than &~str
[03:53:25] <achin> i thought i needed a lifetime, but i was going to let the compiler tell me that
[03:53:27] <sfackler> strs are a bit weird
[03:53:32] <o11c> also, pretty sure that str doesn't exist, so &self._name doesn't make sense
[03:53:51] <dbaupp> sfackler: speaking of strings being weird, did you fix the &@"doc" thing?
[03:53:52] <sfackler> &self._name makes total sense
[03:53:54] <sfackler> dbaupp: yep
[03:54:02] <o11c> sfackler: I mean, not as &str
[03:54:16] <achin> this is a method in struct MyFoo {_name: ~str} 
[03:54:17] <sfackler> weirdly, *name == "doc" doesn't typecheck but "doc" == *name does
[03:54:41] <dbaupp> sfackler: yes, known bug
[03:55:08] <dbaupp> sfackler: the method resolution (and thus the sugared-operator resolution) looks only at the LHS
[03:55:13] <sfackler> @"str" doesn't work as a pattern either, but @ is going away anyways so who cares
[03:55:24] <dbaupp> so it sees @str and expects the RHS to be @str too
[03:55:30] <o11c> I keep hearing "is going away" ... why isn't it GONE yet?
[03:55:35] <sfackler> ah
[03:55:46] <dbaupp> (oh, you @mentioned me, for some reason I didn't get an email... weird.)
[03:56:02] <sfackler> o11c: waiting on a smart pointer trait iirc
[03:57:02] *** Joins: jdm (jdm@moz-78156D60.dsl.teksavvy.com)
[03:57:02] *** ChanServ sets mode: +o jdm
[03:57:09] <sfackler> and someone brave enough to get a change that touches basically all of rustc merged :P
[03:57:20] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[03:59:01] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[03:59:13] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[03:59:19] <achin> sfackler: thanks for the hint about as_slice
[03:59:48] <dbaupp> sfackler: oh, also, do you reckon you could move the if condition out of the if ...  { ... }, because it might neater/easier to read as `let has_doc = ...; if !has_doc { .. }` instead of the big .any closure.
[03:59:52] *** Joins: madalynn (Mibbit@301B022B.3DF27355.F7F60E06.IP)
[04:00:32] *** Quits: madalynn (Mibbit@301B022B.3DF27355.F7F60E06.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:01:00] *** Quits: t25 (manu@moz-5D020DB4.otago.ac.nz) (Ping timeout)
[04:01:02] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[04:01:59] *** Joins: t25 (manu@moz-5D020DB4.otago.ac.nz)
[04:02:22] <sfackler> dbaupp: turns out there's a name method on Attribute, so the whole thing can reduce to any(|a| "doc" == a.name())
[04:02:54] <sfackler> just making sure it builds now
[04:03:24] *** Joins: onix (Mibbit@moz-6FC975B5.nc.res.rr.com)
[04:03:34] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[04:03:52] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[04:04:02] <dbaupp> sfackler: oh, yeah
[04:04:10] * dbaupp pretends he wasn't the one who added that
[04:04:32] <dbaupp> sfackler: wait. that means that #[doc] fn foo() { ... } is considered ok
[04:06:36] <sfackler> yeah, I guess it's safer to do it the other way
[04:09:00] <sfackler> dbaupp: updated
[04:09:00] *** Quits: headcrash (kzzch@moz-3652E738.pools.spcsdns.net) (Ping timeout)
[04:09:41] *** Quits: onix (Mibbit@moz-6FC975B5.nc.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[04:11:07] <dbaupp> sfackler: r+, thanks
[04:11:17] <achin> man, lifestuff stuff is verbose
[04:11:23] <achin> s/lifestuff/lifetime/
[04:12:08] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[04:12:38] <klutzy> hmm, I thought it is intentional to warn non-sugared doc. but it would be just meaningless
[04:12:39] <achin> ooh
[04:12:47] <achin> error: internal compiler error: Cannot relate bound region: ReEarlyBound(537, 0, a) <= ReInfer(45)
[04:13:18] <zslayton> achin: I just ran into that: https://github.com/mozilla/rust/issues/10868
[04:13:18] <dbaupp> klutzy: what do you mean?
[04:13:44] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[04:14:07] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[04:14:37] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[04:14:56] <klutzy> dbaupp: I thought #10853 is not-a-bug since lint explicitly checks it
[04:15:01] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[04:16:11] <sfackler> it can still be a bug :P
[04:16:12] <achin> zslayton: thanks.  i'll keep my eye on that
[04:17:11] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Ping timeout)
[04:17:12] <klutzy> but I now think the restriction is not necessary, so #10867 looks good :)
[04:18:47] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[04:19:23] *** Joins: mib_lgbovk (Mibbit@FAA54149.CBAF2324.ACDBB07.IP)
[04:20:12] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[04:20:13] <mib_lgbovk> anybody knows the differences between Rust and cyclone?
[04:21:01] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[04:22:20] *** Joins: ctult (Mibbit@moz-C24A11E7.bois.qwest.net)
[04:25:09] *** Joins: morton (Mibbit@3012F8E6.57BCE92B.268E2EF2.IP)
[04:25:19] <o11c> cyclone looks like it works on a much lower level
[04:26:23] *** Quits: mib_lgbovk (Mibbit@FAA54149.CBAF2324.ACDBB07.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:26:30] <ctult> I am trying to use the precompiled Rust build on Windows, but every time I use it, I get an error saying libpthread-2.dll is missing from my computer.  I tried rolling back GCC and renaming PThreadGC2.dll to libpthread-2.dll to no avail.
[04:26:31] <morton> sorry for disconnected (I asked about cyclone...)
[04:26:51] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[04:26:54] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[04:27:56] <morton> o11c so for a lower level usage, the cyclone and Rust could be equally used, and for higher, turning for Rust is better?
[04:28:02] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[04:28:45] <SiegeLord> Cyclone seems to take a different approach to dangling pointers
[04:29:07] <SiegeLord> I'm not sure I understand it... but otherwise it seems various features are different
[04:29:25] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Ping timeout)
[04:29:27] <SiegeLord> Like it has exceptions, but no C++ style generics
[04:30:06] <strcat> the person who asked is gone :)
[04:30:35] <SiegeLord> Well, I'm talking to myself partly ;)
[04:30:54] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:31:11] <SiegeLord> Not really impressed that it's homepage isn't loading though... heh
[04:31:20] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[04:31:23] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:32:00] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[04:35:03] *** Quits: jvns (bork@87D98E32.4046EB22.428F94DD.IP) (Ping timeout)
[04:35:26] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[04:36:20] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[04:36:35] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[04:37:42] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[04:37:52] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[04:38:00] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[04:38:05] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:38:25] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[04:39:49] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:40:04] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131112160018])
[04:40:24] *** Joins: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP)
[04:40:27] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:40:46] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:41:03] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[04:41:05] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:41:26] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[04:42:10] *** Quits: lenstr (lenstr@26B976A9.9636F313.7A27613B.IP) (Ping timeout)
[04:44:25] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[04:45:33] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[04:48:56] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:49:08] *** Quits: morton (Mibbit@3012F8E6.57BCE92B.268E2EF2.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:50:01] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[04:51:51] <erickt> quit
[04:51:53] <erickt> oops
[04:51:57] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Quit: leaving)
[04:52:31] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:54:04] <ChrisMorgan> erickt: re. "quit" "oops"—of course quit was a mistake. No one could want to quit #rust ;-)
[04:54:05] *** Joins: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[04:54:59] <ctult> I am trying to use the precompiled Rust build on Windows, but every time I use it, I get an error saying libpthread-2.dll is missing from my computer.  I tried rolling back GCC and renaming PThreadGC2.dll to libpthread-2.dll to no avail.
[04:55:07] <dbaupp> klutzy: ^
[04:55:21] <klutzy> ctult: what version do you use? 0.8 or master?
[04:55:26] <ctult> 0.8
[04:55:32] <ctult> Is there another Windows build?
[04:55:37] <ctult> or rather newer?
[04:55:38] *** Joins: semisight (alex@moz-16944F18.socal.res.rr.com)
[04:55:57] <erickt> ChrisMorgan: I could never quit rust. I did need to reboot though :)
[04:56:02] <klutzy> nope, I just confused ;)
[04:57:21] <klutzy> ctult: renaiming doesn't work? it seems strange. how did you run rustc?
[04:57:40] <klutzy> maybe $PATH misses mingw paths
[04:57:49] <ctult> ooooohhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
[04:58:43] <ctult> klutzy: You are a life saver.  It works perfectly now, thanks!  :D
[05:00:27] <semisight> is there a way to get rust to generate debug symbols on os x? I've added the '-Z debug-info' option but it still says dSYM is empty
[05:02:02] <strcat> -Z extra-debug-info
[05:03:08] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[05:03:48] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[05:04:19] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[05:04:40] <semisight> strcat: tried it
[05:04:44] <semisight> no go
[05:05:37] <semisight> on os x 10.9 for reference
[05:05:49] <dbaupp> acrichto: ^
[05:06:02] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[05:06:14] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[05:07:22] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[05:07:41] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[05:08:37] *** Quits: zslayton (Mibbit@moz-4806B979.nyc.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[05:08:49] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[05:08:54] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:10:14] <semisight> its a clean installation, only yesterday, recently reformatted machine
[05:10:15] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[05:10:34] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[05:12:57] <dbaupp> semisight: a clean installation of master, or 0.8?
[05:13:03] <semisight> master
[05:16:10] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[05:18:00] *** Quits: Sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Client exited)
[05:18:48] <lpy> Rust has no regexp?
[05:19:17] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[05:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[05:19:32] <semisight> lpy: not that I know of
[05:19:34] <dbaupp> lpy: not in the standard library yet
[05:19:38] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[05:19:44] *** Quits: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[05:19:46] <o11c> lpy: it's on the todo list for std, there are a couple of outside ones
[05:19:47] <semisight> there's rust-pcre but it's a bit old
[05:19:51] <dbaupp> lpy: people have written bindings to external libraries like pcre
[05:20:14] <lpy> :) thanks dbaupp o11c semisight
[05:20:27] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Connection reset by peer)
[05:20:39] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[05:20:41] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[05:20:41] <acrichto> semisight: dbaupp: I've never had debug symbols work on osx
[05:20:57] <semisight> acrichto: well I guess that solves that mystery
[05:21:03] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[05:21:09] <semisight> I do remember them working back around 0.5ish though...
[05:21:15] <o11c> https://github.com/mozilla/rust/wiki/Note-wanted-libraries#regular-expressions
[05:21:17] <acrichto> yeah it's turned off on the bots b/c apparently gdb needed root
[05:21:36] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[05:21:37] <dbaupp> lpy: https://github.com/cadencemarseille/rust-pcre apparently builds with the current master
[05:21:38] <semisight> ah, ok
[05:21:48] *** Quits: Liam` (quassel@6265EFB3.B1CCF5AA.217C7FCC.IP) (Ping timeout)
[05:21:49] *** Joins: Liam` (quassel@6265EFB3.B1CCF5AA.217C7FCC.IP)
[05:22:10] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[05:22:12] <dbaupp> the other "rust-pcre" ( https://github.com/uasi/rust-pcre ) doesn't, though 
[05:22:33] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:22:45] *** Joins: scroy (user@moz-C21D3E9A.hsd1.il.comcast.net)
[05:22:47] *** Quits: scroy (user@moz-C21D3E9A.hsd1.il.comcast.net) (Client exited)
[05:23:28] <lpy> dbaupp: wow! I will take a look thanks.
[05:23:50] <carter> who would I talk to if I wanted to figure out adding nice simd to rust? (i've been working out the type system implications for doing so to haskell, and i think some of the same ideas would suite rust nicely)
[05:24:48] <dbaupp> rusti: std::unstable::simd::f64x2(1.0, 2.0) * std::unstable::simd::f64x2(3.0, 4.0)
[05:24:49] -rusti- std::unstable::simd::f64x2(3f64, 8f64)
[05:25:08] <dbaupp> carter: I know sanxiyn and jensnockert were interested/did work on it
[05:25:13] <carter> ok
[05:25:14] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[05:25:18] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[05:25:19] <dbaupp> (that^ support is due to sanxiyn.)
[05:25:21] <carter> sounds liek they're not online rgght now
[05:25:25] <carter> what support?
[05:25:26] <dbaupp> yes
[05:25:33] *** Joins: iMadper (user@9612DFDD.697E8DD6.6D2830D2.IP)
[05:25:39] <carter> ""that^"" meaning?
[05:25:42] <dbaupp> carter: what I just got 'rusti' to execute
[05:26:02] <carter> oh yeah
[05:26:03] <carter> the short vectors
[05:26:06] <dbaupp> yes
[05:26:15] <dbaupp> not full simd at all.
[05:26:22] <carter> nope :) 
[05:26:27] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[05:26:29] <carter> LLVMs data model of simd is a bit more general though
[05:26:51] <dbaupp> yeah, arbitrary vectors of scalars, right?
[05:26:55] <carter> yes
[05:27:00] <carter> and shuffles
[05:27:07] <carter> plus various unportable intrinsics
[05:27:18] <carter> the key thing: many ops need certain args fixed at compile time
[05:27:27] <strcat> it's general but it only creates them if the target has them, and I don't think a target has to lower everything
[05:27:34] <dbaupp> carter: I believe jens did start some work in that direction, but was struggling to make the compiler understand it.
[05:27:44] <carter> dbaupp: ah
[05:28:00] <dbaupp> carter: ( https://github.com/jensnockert if you wish to contact him)
[05:28:11] <carter> thought: am I right in thinking Rust has the rule "all polymorphims must be monomorphized"?
[05:28:17] <carter> *generics
[05:28:20] <strcat> carter: yes
[05:28:22] <carter> ok
[05:28:34] <carter> that plus type level numbers would suffice 
[05:28:43] <carter> which are kinda there with the static vectors
[05:29:01] <bjz> yep, you are correct carter 
[05:29:07] <carter> ok
[05:29:12] <bjz> with monomorphisation, that s
[05:29:17] <bjz> *is
[05:29:50] <carter> yeah
[05:30:06] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[05:30:07] <bjz> carter: what do you mean by "type level numbers"? parameterising over constants?
[05:30:23] <carter> well
[05:30:29] <carter> heres a good example
[05:30:31] <carter> in clang
[05:30:50] <carter> theres __builtin_shuffle(v1,v2,shuffleMix)
[05:30:56] <carter> shuffleMix can't be a variable
[05:31:08] <carter> it has to be a literal array of valid indices from v1 and v2
[05:31:18] <carter> and then llvm generates a sequence of shuffle / permutation operations
[05:31:21] <carter> to build the resulting vector
[05:31:40] <carter> using target specific simd
[05:32:17] <carter> in haskell i'm probably going to need a type "Static a"
[05:32:35] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[05:32:37] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[05:32:42] <carter> which is only constructable by writing a constant literal expression (including type constructors)
[05:32:59] <carter> to be able to even try to type check that shuffle operation
[05:33:00] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[05:33:52] <carter> so builtin shuffle would have a type like shuffle :: Vector n a -> Vector m a -> Vector k Int-> Vector k a
[05:33:53] <sfackler> carter: &'static [Foo] should work for that
[05:33:55] <carter> roughly
[05:33:58] <carter> oh
[05:33:59] <carter> hrmm
[05:34:02] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[05:34:16] <carter> whats  'static mean?
[05:34:18] <carter> and why the tick?
[05:34:23] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[05:34:25] <sfackler> 'foo is the syntax for a lifetime
[05:34:30] <sfackler> &'static [Foo] is saying
[05:34:46] <sfackler> that it's a pointer to an array of Foos that has the static lifetime
[05:34:55] <sfackler> which is the lifetime of the program
[05:35:00] <carter> and whats a static lifetime? that it must have been fixed at compile time?
[05:35:05] <sfackler> yep
[05:35:13] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[05:35:15] <carter> does that enforce the constant literal expression requirement?
[05:35:27] *** Parts: semisight (alex@moz-16944F18.socal.res.rr.com) ()
[05:35:35] <carter> or is there still a notion of init time
[05:35:49] <sfackler> no, it's compile time constant
[05:35:58] <carter> sweet
[05:36:01] <sfackler> but it's not required to be a literal passed into the function
[05:36:08] <carter> ok
[05:36:20] <sfackler> you could do static FOO: &'static [Foo] = [...]; my_thing(FOO)
[05:36:40] <carter> urk
[05:36:55] <carter> soo, is it possible to write a function that returns something with that type?
[05:37:04] <carter> (trying to understand the ramification)
[05:37:23] <carter> i'm leary of that weaker version of static
[05:37:38] <carter> because then it makes compiling the simd operations a slightly non local operation
[05:37:40] <sfackler> yeah, you can return something with a static lifetime, but keep in mind that it's still a pointer to somewhere in .rodata
[05:37:50] <sfackler> for this you may actually need some compiler support
[05:37:53] <carter> yeah
[05:37:55] <carter> ok
[05:38:05] <carter> if a function can return a static pointer
[05:38:13] <carter> then this notion of static is too weak
[05:38:23] <carter> 'cause yo could construct something that returns one of two possible vectors
[05:38:33] <carter> and then llvm would panic
[05:38:33] <sfackler> yeah
[05:38:44] <carter> ok
[05:38:57] <carter> and making llvm panick would be sad
[05:38:57] <sfackler> you could do it as a syntax extension
[05:38:58] <carter> and not ok
[05:39:00] <carter> yeah
[05:39:06] <sfackler> which would enforce the literal requirements
[05:39:07] <carter> it'd need that plus type system support
[05:39:21] <carter> afaict
[05:40:30] <carter> would such a patch be likely to be seriously considere? (motivated by type safe / llvm panick proof shuffles?)
[05:40:49] *** Joins: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net)
[05:41:19] <carter> (in guesstimation)
[05:41:53] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[05:43:30] <sfackler> it seems pretty reasonable
[05:43:54] <carter> is this jens fellow on irc ever?
[05:43:58] <sfackler> you should probably ask around tomorrow when more of the core dev team is around
[05:44:01] <SiegeLord> Can you not stick that argument into the function name?
[05:44:09] <carter> SiegeLord:?
[05:44:14] <carter> oh
[05:44:14] <carter> nope
[05:44:26] <carter> SiegeLord: it could be any of many permuations
[05:44:31] <SiegeLord> I see
[05:44:40] <carter> and thats a hack that doesn't scale to adding new operations
[05:44:51] <carter> i did that hack to add prefetch various to ghc HEAD 2 months ago
[05:45:07] <carter> as a deliberate thorn to motivate adding proper static data
[05:45:35] <carter> theres many operations on many architectures, where thers some 8bit constant that needs to be fixed at compile time
[05:45:43] *** Quits: xitology (xi@85437D54.5AFA3E4.CEDFC552.IP) (Quit: Ex-Chat)
[05:45:46] <carter> 2^8 adds up :)
[05:46:05] <carter> prefetch0  through prefetch3 is plenty as is
[05:46:05] <carter> !
[05:46:22] <carter> SiegeLord: the key bit is I want SIMD and other things to be friendly to mortals
[05:46:24] <carter> even high schoolers
[05:46:31] <carter> they aren't that hard
[05:46:37] <carter> (to use poorly )
[05:46:40] <carter> :)
[05:46:54] <SiegeLord> I wonder how this will play with the rest of Rust... what would fn foo(static a: int) mean?
[05:46:54] <carter> its just currently  you can only really get them via c/c++
[05:47:04] <SiegeLord> How does C++ handle it?
[05:47:04] <carter> It means it has to be a compile time integer constant
[05:47:17] <carter> the same way c does probably
[05:47:22] <carter> they have a magic intrinsic
[05:47:38] <carter> and some comple time error if you don't make it static
[05:47:44] <carter> llvm doesn't check its intrinsics
[05:47:56] <carter> and sometimes optimization makes the constantss properly placed
[05:48:02] <carter> else it kinda will panic or something
[05:48:09] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[05:48:11] <SiegeLord> It seems to me foo(1) and foo(2) will have to produce two different functions
[05:48:13] <bjz> carter: "so builtin shuffle would have a type like shuffle :: Vector n a -> Vector m a -> Vector k Int-> Vector k a" so you mean dependent types?
[05:48:18] <carter> nope
[05:48:25] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[05:48:26] <carter> well
[05:48:31] <bjz> carter: that looks like an idris signature
[05:48:35] <carter> haskell
[05:48:45] <bjz> I know, but the types
[05:48:46] <carter> the proper type exactly
[05:48:52] <carter> i think haskelly
[05:48:58] <carter> i then write ti in the target lang
[05:48:59] <carter>  :)
[05:49:03] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Ping timeout)
[05:49:20] <bjz> concat : Vect n a -> Vect m a -> Vect (n + m) a
[05:49:33] <carter> bjz: it should be  shuffle :: Vector n a -> Vector m a -> Static( Vector k (Fin m + n)) -> Vector k a
[05:49:37] <carter> yeah
[05:49:37] <bjz> that's an idris signature using dependent types
[05:49:49] <carter> that'd be the "precise type"
[05:49:55] <carter> idris is cool
[05:49:58] <bjz> drop : (n : Nat) -> Vect (n + m) a -> Vect m a
[05:49:58] <carter> i need to find the time to play with it
[05:50:08] <bjz> repeat : (n : Nat) -> a -> Vect n a
[05:50:20] <carter> jah
[05:50:20] <bjz> yeah, it's cool
[05:50:30] <carter> is that on the Rust horizon in a few years?
[05:50:30] <carter> :p
[05:50:39] <SiegeLord> What if you do foo(static a:int) { let b = [1, ..a]; }
[05:50:47] <SiegeLord> That's definitely different code per function
[05:50:52] <carter> yeah
[05:50:57] <carter> that'd be fine i think
[05:51:05] <bjz> doubt it, unfortunately. maybe paraqmeterising over constants, but I doubt full dependent types
[05:51:05] <carter> you just couldn't have functions return static a
[05:51:26] <SiegeLord> So that syntax is wrong, and what you really want is fn foo<a:int>()
[05:51:36] <bjz> yep
[05:51:39] <SiegeLord> And that has been on the the todo list for a while
[05:51:47] <carter> it has?
[05:51:47] <carter> link
[05:51:49] <carter> ?
[05:51:56] <SiegeLord> Except I'm not sure how that works with an intrinsic
[05:52:02] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[05:52:13] <carter> nope
[05:52:33] <carter> static a would be the type of constant literal expressions of type a
[05:52:46] <bjz> carter: I don't think there is an actual link out there, but it is talked about quite a bit
[05:52:54] <carter> ok
[05:53:07] <bjz> we need it for implementing traits on fixed length vectors
[05:53:13] <carter> ok
[05:53:15] *** Joins: xitology (xi@85437D54.5AFA3E4.CEDFC552.IP)
[05:53:17] <carter> SIMD :)
[05:53:19] <bjz> that's a huge pita
[05:53:46] <carter> i think it'd have to be a different syntax than <blah:Int>
[05:53:55] <carter> because doesn't that already get used for type level terms?
[05:54:03] <carter> and ambiguity is a confuser
[05:54:10] <bjz> yeah :/
[05:54:16] <bjz> annoying
[05:54:23] <carter> whatever, if i hack this out, i'll make up <<>> or [< >] or soemthing
[05:54:29] <bjz> <T: Trait>
[05:54:32] <carter> and thems omeone else can make it perdy
[05:54:42] <bjz> mm, we really need this
[05:54:53] <SiegeLord> Lifetimes go there too, and they have nothing to do with the type :P
[05:55:09] <carter> aren't lifetimes a sort of type thought?
[05:55:21] <bjz> they are, imo
[05:55:43] <carter> ok, just making sure the half decade i spent trying to be a type system expert hadden't expired :)
[05:55:50] <bjz> haha
[05:56:02] <bjz> what kind of stuff do you work on?
[05:56:10] <SiegeLord> No less so than giving a compile time constant that will result in different code per constant :P
[05:56:18] <carter> SiegeLord: nope
[05:56:37] <carter> how code generation works != types
[05:56:45] <SiegeLord> E.g. the struct Foo<a: int> will create a new Foo for each value of a
[05:56:52] <carter> sure
[05:56:52] <bjz> SiegeLord: code gen is an implementation detail
[05:56:57] <carter> yup
[05:57:22] <carter> it could be emiting whitespace bytecode
[05:57:30] <carter> granted, woudl be sad and slow and unreadable then 
[05:57:43] <carter> bjz: good questions
[05:57:47] <carter> so
[05:57:56] <carter> historically, end of hs / early undergrad, I was deep into pl
[05:57:57] <SiegeLord> Well, either way... that struct proves that these integers are a type thing
[05:58:03] *** Joins: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP)
[05:58:11] <carter> type level things are types
[05:58:14] <carter> but not always
[05:58:26] <carter> we agree in idea, not in the reasons
[05:58:33] <carter> and thats ok
[05:58:41] <strcat> carter: there are 'kinds' already, traits automatically implemented by the compiler that you're unable to implement
[05:58:49] <carter> sure
[05:58:50] <strcat> seems we could have a kind for integer constants
[05:58:50] <bjz> SiegeLord: they are type things (I think). look into dependent types
[05:58:59] <carter> strcat: nah, thats not what I need
[05:59:05] <carter> bjz: your are correct
[05:59:16] <SiegeLord> Well, then they get admitted to the <> club :P
[05:59:30] *** Quits: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP) (Ping timeout)
[05:59:32] <carter> strcat: that the examples i'm giving are just with ints is kinda an accident, not the key point
[05:59:38] <bjz> it would be great to have it generalised to constants of any type.
[05:59:46] <strcat> as in 'struct Foo<T: CInt> { xs: [int, ..T] }' Foo<10>
[05:59:47] <carter> bjz: thats what i'm tyring to work out for ghc
[05:59:51] <strcat> carter: well I don't get it then ;p
[05:59:59] <bjz> limiting it to integers is kinda...weird
[06:00:02] <carter> yup
[06:00:10] <bjz> carter: have you looked at D?
[06:00:16] <carter> not in a long long time
[06:00:24] <bjz> carter: since D2?
[06:00:29] <carter> no clue
[06:00:37] <carter> probably sometime before 2007
[06:00:43] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[06:00:45] <carter> or 2006
[06:00:58] <bjz> carter: it's not a theoretically beautiful lang, but the constant parameterisation is super handy
[06:01:11] <carter> do you have a handy link to an example?
[06:01:26] <carter> the issue is that its no quite constant parameterization here
[06:01:27] <SiegeLord> D doesn't allow arbitrary types either
[06:01:36] <SiegeLord> It's only integers and strings
[06:01:41] <carter> yuck
[06:01:43] *** Quits: KindOne (KindOne@moz-F99B80DB.dynamic.ip.windstream.net) (Ping timeout)
[06:01:50] <bjz> SiegeLord: really?
[06:02:00] <carter> part of the reason why i'm trying to do it generally
[06:02:23] <carter> is that for haskell / GHC, i want to make it easy to have static / compile time fixed data structures
[06:02:40] <carter> that are precomputed / laid out in the object code
[06:02:45] <carter> like those little twiddle arrays etc
[06:03:07] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[06:03:22] <carter> bjz: back to your question
[06:03:27] <SiegeLord> No, looks like it's a number and strings
[06:03:37] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[06:03:42] <carter> so floats too
[06:03:47] <carter> or rationals also?
[06:03:48] <SiegeLord> Yes
[06:03:51] <bjz> http://dlang.org/template.html#TemplateValueParameter
[06:03:56] <SiegeLord> No rationals in D
[06:03:59] <bjz> "Template value parameter types can be any type which can be statically initialized at compile time"
[06:04:13] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:04:23] <carter> sweet
[06:04:23] <carter> ok
[06:04:23] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[06:04:24] <SiegeLord> Well, it doesn't work here :P
[06:04:28] <carter> why not?
[06:04:56] <SiegeLord> D's manual is even less accurate than Rust's
[06:05:00] <carter> ahhh
[06:05:07] <carter> so theyre living a dream thats a lie?
[06:05:09] <carter> sad
[06:05:13] <strcat> SiegeLord: that's impressive
[06:05:14] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[06:05:14] <carter> bjz: so i left grad school 2 years ago for the oldest of reasons: terrible advising in the middle of no where is a terrible idea
[06:05:30] *** Joins: KindOne (KindOne@ED707493.99EE53D4.34F73994.IP)
[06:05:30] <bjz> ack
[06:05:30] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[06:05:37] <carter> i've been in nyc doing tech consulting + slowly working on some of my own project 
[06:05:37] <carter> s
[06:05:51] <carter> with my own wee consulting company of my own wellposed.com
[06:06:00] *** Joins: ithobani (Mibbit@B0172753.AB615128.58B1C2DD.IP)
[06:06:00] <bjz> so you're interested in Rust?
[06:06:05] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[06:06:11] <vadimcn> acrichto: r? https://github.com/mozilla/rust/pull/10874
[06:06:16] <carter> bjz: i'll get to that
[06:06:22] *** Quits: ithobani (Mibbit@B0172753.AB615128.58B1C2DD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:06:51] *** Quits: mcarberry (mcarberry@moz-BE1C9F3F.lightspeed.frokca.sbcglobal.net) (Ping timeout)
[06:07:31] <carter> bjz: so one thing i've been slowly working on since January 2012 has  been "how do i build less terrible tools for data analysis, in a decent language thats fast like haskell"
[06:07:50] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[06:07:59] <bjz> interesting
[06:08:16] <carter> and since september 2012 i've been slowlyworking on "how do I design a better numerical linear algebra substrate, 'cause everything is inextensible and hard to reasonab about"
[06:08:52] <bjz> does the laziness of haskell work against you?
[06:08:55] <carter> nope
[06:09:00] <carter> i write REALLY strict code
[06:09:20] <carter> good haskell code is lazy in compositions, strict in the tight inner loops
[06:09:28] <carter> laziness gives you some compositionality for high level bits
[06:09:57] <carter> my own current major gripe is the lack of good simd
[06:10:28] <bjz> mm
[06:11:35] <carter> which i'm planning on fixing by next fall i hope
[06:11:46] <carter> step 1 is having a good way of enforcing static args
[06:11:55] <carter> for operations that need them
[06:13:10] <carter> anyways
[06:13:36] <carter> bjz: so to actually do a better job doing a decent numerical lib, I actually need really really fancy type system support
[06:13:58] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Input/output error)
[06:15:38] <carter> but i'm really happy with whats come out design wise
[06:15:57] <carter> i have a really really compositional way to build new fancy array layouts
[06:16:15] <carter> and also reason about the memory locality quality of operations
[06:16:39] <carter> bjz: rust is *just* expressive enough currently that I think i can encode some of the basic ideas
[06:17:02] <carter> will need HKT and other fancy machinery 
[06:17:18] <bjz> yeah
[06:17:28] <carter> like, with the haskell type class model i have
[06:17:29] <bjz> the devs are open to HKT
[06:17:41] <carter> you can add a new array layout 
[06:17:43] <carter> and compose layouts
[06:17:57] <carter> so say you wanted a zigzag array layout
[06:18:01] <carter> for rank n arrays
[06:18:17] <carter> you could do any arbitrary hierarchicacl interleaving
[06:18:22] <carter> of that layout and other layouts
[06:18:40] <carter> so I can currently write Row Major of 4x4 ColumnMajor of 2x2 RowMajor of Floats
[06:18:45] <bjz> so you want to enforce that in the type system, statically?
[06:18:46] <carter> or other things
[06:18:52] <bjz> yeah, me too
[06:18:55] <carter> well, yeah, 
[06:19:04] <bjz> https://github.com/bjz/cgmath-rs
[06:19:17] <carter> have you looked at the itnernals for stuff like numpy or pandas? its a flustercluck
[06:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[06:19:24] <bjz> haha
[06:19:32] <bjz> nope
[06:19:47] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[06:19:48] * bjz assumes that is a blessing
[06:19:58] <carter> yup
[06:20:08] <carter> you've heard of them though I hope
[06:20:19] <bjz> I have heard of numpy
[06:20:22] <carter> basically every hot path in pandas is one off cython/ccode
[06:20:28] <carter> pandas == dataframe thingy
[06:21:04] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[06:21:40] <carter> bjz: cool, i'm looking at the linked nalagebra lib
[06:22:07] <geomyidae>  ./bindgen -o rustpcap-autogen.rs /usr/include/pcap/pcap.h
[06:22:07] <geomyidae> /usr/include/sys/types.h:146:10: fatal error: 'stddef.h' file not found
[06:22:07] <geomyidae> halp
[06:22:21] <carter> like, to actuaully have the type information about memory locality quality, rust'd need something liek type families
[06:22:38] <bjz> carter: I aimed high at the beginning with mine, then aimed progressively lower :P
[06:22:40] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[06:22:55] <bjz> carter: lots of re-writes
[06:23:02] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[06:23:10] <carter> <=4dim === much saner lifestyle choices
[06:24:46] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[06:25:06] <bjz> we need to also have another look at std::num
[06:25:09] <SiegeLord> geomyidae: Do you have stddef.h on your system?
[06:25:53] <geomyidae> yes, in /usr/lib/gcc/x86_64-unknown-linux-gnu/4.8.2/include
[06:25:57] <carter> bjz: my solution to stuff has been "become a core haskell/ ghc person, so i can force nice things to happen'
[06:26:01] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[06:26:13] <bjz> carter: I was responsible for doing lots of regigging of the traits (I needed them for cgmath), along with lots of help from other folks, but I think we could do better
[06:26:22] <carter> cool
[06:26:22] <SiegeLord> geomyidae: Maybe pass that directory to bindgen and see what happens?
[06:26:27] <carter> i'd probably agree
[06:26:28] <bjz> carter: well, being better by being dumber
[06:26:33] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Hibernating, be back soon.)
[06:26:40] <carter> oh?
[06:26:41] <carter> explain
[06:26:54] <strcat> carter: I think associated types are like type families, right? and probably what rust will eventually get
[06:26:57] <strcat> and associated constants
[06:26:58] <carter> ok
[06:26:58] <carter> yes
[06:27:03] <carter> those would be AMAZING
[06:27:14] <carter> associated types ARE type families, but with better coherency
[06:27:17] <bjz> making the traits dumber, and more implementation driven would allow folks to create their own numeric abstractions easier
[06:27:18] <carter> though both are useful
[06:27:28] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[06:27:31] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[06:27:31] <bjz> just an idea though
[06:27:35] <carter> bjz: just don't repeat the mistakes of the haskell ones
[06:27:40] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[06:27:42] <carter> i've been bitten by the shitty ones in haskell base libs
[06:27:56] <strcat> well I think atm rust's stdlib has terrible usage of traits
[06:28:03] <carter> how so?
[06:28:03] <strcat> I think there are a lot of mistakes
[06:28:12] <strcat> well for example Ord and Eq are like haskell, without any rules
[06:28:12] <carter> edumacate me
[06:28:15] <strcat> floats implement them
[06:28:20] <strcat> so we have TotalOrd and TotalEq too
[06:28:21] <carter> i'm ok with that
[06:28:21] <bjz> at the moment we have a frankenstein's monster of abstract algebra and stuff
[06:28:22] *** Joins: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP)
[06:28:22] <strcat> and it's a PITA
[06:28:28] <carter> oh?
[06:28:32] <carter> bjz: thats better than the otehr way around
[06:28:40] <carter> bjz: what if you had trait aliases
[06:28:48] <carter> that let you implmeent an ensemble of traits
[06:28:51] <carter> in one go?
[06:28:53] <bjz> https://github.com/mozilla/rust/issues/4819
[06:29:13] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[06:29:22] <carter> i'm ok with eq and ord on flaots
[06:29:32] <carter> if you use float equality wrong its your fault :)
[06:29:47] <strcat> so can code assume they're total then?
[06:29:51] <strcat> lets say you write a tree
[06:29:52] <bjz> strcat: isn't that a tradeoff for practicalities sake?
[06:29:59] <strcat> what practicality does it give?
[06:30:04] <carter> sanity
[06:30:07] <strcat> generic min/max aren't even right for floats
[06:30:12] <carter> nope, they're fine
[06:30:17] <strcat> they're not
[06:30:20] <carter> well
[06:30:22] <carter> what would be a better one
[06:30:24] <carter> tell me that
[06:30:33] <carter> i agree they're not ideal
[06:30:35] <strcat> they give different answers than the IEEE754 min/max are supposed to
[06:30:37] <carter> they're a tradeoff
[06:30:39] <carter> ok
[06:30:40] <carter> thats wrong
[06:30:47] <carter> at least obey ieee
[06:30:54] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[06:30:57] <strcat> but if they're implemented via Ord they can't
[06:31:13] <bjz> strcat: that's why we need specialised impls
[06:31:23] <strcat> so anything using Ord basically has to specialize for floats
[06:31:27] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[06:31:30] <strcat> and lots of stuff (maps, sets) can't be sanely implemented
[06:31:44] <strcat> so why is it implemented for floats again? if it doesn't truly give you code reuse ;p
[06:32:04] <carter> overridable instances
[06:32:09] <carter> idea
[06:32:14] <carter> what about traits with default instances
[06:32:25] <carter> default implementations
[06:32:35] <strcat> there are default methods
[06:32:44] <strcat> so yes, min/max can be default methods
[06:32:44] <bjz> strcat: I don't want to have to rewite 'Point' just for f32 and f64
[06:32:52] <strcat> what is Point?
[06:32:57] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[06:32:59] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[06:33:36] <strcat> carter: you'll end up moving a *lot* of functionality into the trait to make it right for floats
[06:33:47] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[06:33:53] <carter> eh
[06:34:02] <carter> i mean more so you coudl ahve a min/max etc ops
[06:34:11] <carter> be their own colleciton of ops
[06:34:24] <carter> min and max make sense on partial ords too, soemtimes
[06:34:35] <carter> floats are a partial ord right?
[06:34:56] <carter> yup
[06:35:03] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[06:35:13] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[06:35:14] <strcat> carter: yeah there are just certain unordered values
[06:35:27] <bjz> https://github.com/mozilla/rust/blob/master/src/libstd/num/mod.rs#L35
[06:35:34] <alan_andrade> hi, I have a question.
[06:35:37] <alan_andrade> let program = args[0];
[06:35:40] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[06:35:48] <alan_andrade> println!("{:?}", program);
[06:35:51] <strcat> carter: for example with Eq, a == b doesn't imply !(a != b) if floats can implement it
[06:36:00] <alan_andrade> Why thats not possible? 
[06:36:01] <strcat> that's a problem for hash tables
[06:36:22] <alan_andrade> Why do I have to add the `to_slice` method at the end ?
[06:36:27] <carter> strcat: well, eq is wrong for floats anyways
[06:36:29] <bjz> alan_andrade: what is `args`?
[06:36:31] <carter> except when its ok
[06:36:38] * Eridius returns from vacation
[06:36:41] <alan_andrade> args = os::args()
[06:36:42] <carter> theres 2 notions of equality in floats
[06:36:42] <strcat> if you insert (NaN, 5) and then insert (NaN, 10), you will have 2 key-value pairs in the hash table
[06:36:52] *** Quits: Chimmy (ctimothy@moz-1DB1FE6E.hsd1.wa.comcast.net) (Quit: leaving)
[06:36:55] <strcat> repeat 1000 times, you've significantly degraded the hash table perf
[06:36:58] <bjz> alan_andrade: oh, because you are trying to move it out of an array maybe
[06:37:05] <strcat> it's a DoS issue, which is why rust uses SipHash in the first place
[06:37:19] *** Joins: greentealover (greentealo@E5F0B6E9.D636C253.FE90BC23.IP)
[06:37:28] <carter> well three: "they'll pretty print the same", "do they have the same in memory  rep" and "the distance between them is zero"
[06:37:45] *** Quits: greentealover (greentealo@E5F0B6E9.D636C253.FE90BC23.IP) (Quit: Leaving...)
[06:37:47] <strcat> IEEE754 defines a total ordering for floats too
[06:37:52] <alan_andrade> @bjz I just want the value args[0] is storing 
[06:37:54] <carter> use, using the bits model
[06:37:55] <strcat> but it's too slow to make sense in the real world
[06:38:05] <carter> strcat: i thought it was just using the bits rep
[06:38:09] <bjz> alan_andrade: you could .clone() it
[06:38:13] <Eridius> I'm seeing `pub fn main` in some spots. What's the reason for that, since `fn main` seems to work?
[06:38:52] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[06:39:12] <strcat> carter: maybe
[06:39:19] <alan_andrade> @bjz .clone() worked; .as_slice() worked; &args[0] worked. I don't know why :(
[06:39:30] <strcat> carter: you can encode the same number in more than 1 way and it appears to not consider them equal
[06:39:31] <alan_andrade> @bjz would you help me understanding ?
[06:39:32] <strcat> so it's a PITA too
[06:39:42] <carter> oh, you mean denormalized vs normalized
[06:39:43] <carter> yeah
[06:39:58] <bjz> alan_andrade: what happens when you just do args[0]?
[06:40:04] <carter> well, end of the day, any application using floats as numbers
[06:40:16] <carter> really should be doing   dist(x,y)< epsilion
[06:40:20] <carter> rather than x == y 
[06:40:22] <alan_andrade> hostname.rs:16:6: 16:13 note: `(*args)[]` moved here because it has type `~str`, which is moved by default (use `ref` to override)
[06:40:22] <alan_andrade> hostname.rs:16   let program = args[0]; //.clone(); //.as_slice();
[06:40:31] <strcat> carter: so why implement Eq? ;p
[06:40:36] <carter> for codecs
[06:40:39] *** Joins: mib_h91ik0 (Mibbit@5E4A5D6.D2EFAE37.9EC0BFD4.IP)
[06:40:46] <carter> and other things that use them in other ways
[06:40:47] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Quit: Bye)
[06:40:50] <strcat> they can still compare them without Eq, just not in generic code
[06:40:51] <carter> (ab)use them
[06:40:55] <carter> tre
[06:40:58] *** Quits: mib_h91ik0 (Mibbit@5E4A5D6.D2EFAE37.9EC0BFD4.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:41:06] <strcat> and you could write trait PartialEq
[06:41:06] <carter> 'cause people have feelings about this i guess
[06:41:15] <strcat> and impl<T: Eq> PartialEq for T { ... }
[06:41:22] <strcat> if you really want it
[06:41:24] <strcat> + impl it for floats
[06:41:31] <strcat> and you'll have to feel bad about it ;p
[06:41:46] <bjz> alan_andrade: Rust moves by default
[06:41:53] <alan_andrade> error: use of partially moved value: `args`
[06:42:02] <carter> hehe
[06:42:06] <carter> well, g2g
[06:42:06] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[06:42:07] <carter> night all
[06:42:09] <strcat> alan_andrade: have you read about move semantics in the tutorial?
[06:42:10] <carter> tanks
[06:42:12] <strcat> \o
[06:42:16] <bjz> alan_andrade: do you know what 'move' means?
[06:42:32] <bjz> o/
[06:42:36] <alan_andrade> ohhhh, so by doing let a = args[0]; `a` will be now the pointer to whatever args[0] whas pointing to ?
[06:43:17] <alan_andrade> @strcat I haven't read it. That will help me understand
[06:43:29] * strcat recommends going through http://static.rust-lang.org/doc/master/tutorial.html#implementing-a-linked-list
[06:43:35] <strcat> fairly fresh off the presses
[06:44:32] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[06:45:13] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[06:45:20] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[06:45:46] *** Joins: overfl0w (overfl0w@moz-635F0D19.range217-42.btcentralplus.com)
[06:46:55] <alan_andrade> all right, thanks a lot @bjz and @strcat
[06:47:22] <bjz> alan_andrade: in let a = args[0]; the identifier `a` is now bound to the unboxed value at `args[0]`. This is more efficient than copying the value to a. But that means you now can access the rest of `args` for the rest of the program. You can instead either clone the value at args[0] using `.clone()`, or get a reference to it using `&args[0]`
[06:48:00] <strcat> or coerce it to a slice
[06:48:02] <bjz> alan_andrade: if args[0] is a ~str, you could also get the slice by doing args[0].as_slice()
[06:48:09] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[06:48:15] <bjz> strcat: oh, does that coerce?
[06:48:27] <strcat> yes, arrays and strings coerce to slices
[06:48:27] <bjz> & args[0]?
[06:48:31] <strcat> bjz: no
[06:48:55] <strcat> rusti: let xs: ~str = ~"foo"; let ys: &str = xs; ys[0]
[06:48:55] -rusti- 102u8
[06:49:01] <alan_andrade> wow, that was an incredible explanation.
[06:49:14] <bjz> alan_andrade: I might have got some things wrong
[06:49:26] <bjz> alan_andrade: but I think that is the gist of it
[06:49:44] <strcat> the key is that rust's only built-in form of copying is a shallow copy - ~str is a ptr, so x = y; with ~str is a ptr copy
[06:49:47] <alan_andrade> now I know what's up with the `as_slice()` method
[06:49:53] <strcat> and ~str has a destructor, making it move ownership on a shallow copy
[06:50:16] <strcat> you wouldn't want the dtor called multiple times, or the borrow check rules to be broken
[06:50:29] <bjz> alan_andrade: other languages like C++ copy by default, but Rust moves by default to make sure things are more efficient
[06:50:50] <alan_andrade> got it
[06:50:50] <bjz> alan_andrade: that means by reading the code you can be certain what's copying
[06:51:06] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[06:51:08] *** Quits: kristof (kristof@moz-C03E0B57.lightspeed.frokca.sbcglobal.net) (Ping timeout)
[06:51:55] <bjz> alan_andrade: only thing to note is that primitive values like ints and floats implicitly copy. also composite data types composed of types that can implicitly copy, also implicitly copy (I think)
[06:52:25] <strcat> bjz: all types can be implicitly copied
[06:52:33] <strcat> a subset of types consider that to be a move of ownership
[06:52:39] <bjz> struct V(int, int); let v = V(1, 2); let u = v; (v, u)
[06:52:50] <bjz> rusti: struct V(int, int); let v = V(1, 2); let u = v; (v, u)
[06:52:51] -rusti- (main::V(1, 2), main::V(1, 2))
[06:52:52] <strcat> there's no concept of implicit copying anymore, just of moves of ownership
[06:52:57] <bjz> strcat: ohh
[06:53:09] <bjz> strcat: ok, thanks for that
[06:53:30] <strcat> rusti: let mut x = ~5; x = y; /* implicit copy, but `y` can't be used */; y = ~10; /* now it can be! */ (x, y)
[06:53:31] -rusti- pastebinned 11 lines of output: http://sprunge.us/eKjg
[06:53:33] <strcat> er
[06:53:42] <bjz> strcat: so my explanation was back-to-front before
[06:53:49] <strcat> rusti: let mut x = ~5; let y = x; /* implicit copy, but `x` can't be used */; x = ~10; /* now it can be! */ (x, y)
[06:53:50] -rusti- (~10, ~5)
[06:54:32] <strcat> bjz: yeah I think it's better to be clear that a move of ownership is a semantic thing - the implementation is a copy, and you can see that
[06:54:37] <bjz> 'if it has a destructor, it moves ownership, if not it implicitly copies.'
[06:54:54] <strcat> well I would just say, if it has a dtor it moves ownership on an implicit copy
[06:55:00] <strcat> an explicit clone is required to not move
[06:55:15] <strcat> Clone describes the minimal work to turn &T (no ownership of the value) to a fresh T
[06:55:33] *** Joins: lpy_ (lpy@12172131.F09091A8.1348A864.IP)
[06:56:13] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[06:56:19] <strcat> bjz: for example &mut also moves
[06:56:25] <strcat> as does a closure
[06:56:41] <strcat> although you can 'reborrow' them
[06:56:43] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[06:57:55] <bjz> yep
[06:58:00] *** Quits: jdm (jdm@moz-78156D60.dsl.teksavvy.com) (Quit: Lost terminal)
[06:58:24] *** Quits: overfl0w (overfl0w@moz-635F0D19.range217-42.btcentralplus.com) (Ping timeout)
[06:59:11] <bjz> fn f<T: Drop>(x: T) { x } f(~2)
[06:59:20] <bjz> rusti: fn f<T: Drop>(x: T) { x } f(~2)
[06:59:20] -rusti- <anon>:9:34: 9:35 error: failed to find an implementation of trait std::ops::Drop for ~int
[06:59:21] -rusti- <anon>:9         fn f<T: Drop>(x: T) { x } f(~2)
[06:59:21] -rusti-                                            ^
[06:59:21] -rusti- application terminated with error code 101
[06:59:35] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[06:59:43] <bjz> strcat: will that go away when ~-boxes are implemented in the libs?
[06:59:53] <strcat> bjz: if they are
[07:00:07] <strcat> rust-core's Vec implements Drop, for example
[07:00:09] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:00:19] <bjz> ooh
[07:00:20] *** Joins: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net)
[07:00:22] <strcat> I'll have to add a Uniq type implementing it to write trees with allocator support
[07:00:22] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[07:00:48] <strcat> trees with allocator support are pretty important if you're sending them between tasks because you might want a cache aligned allocator
[07:01:00] *** Quits: FreeFull (freefull@moz-79FD0D17.as13285.net) (Quit: )
[07:01:02] *** Quits: lpy_ (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[07:03:52] *** Quits: ktt3ja (ktt3ja@moz-D69B60E4.hsd1.va.comcast.net) (Quit: Leaving)
[07:04:22] *** Joins: fabiand (fabiand@moz-60ACEF09.adsl.alicedsl.de)
[07:05:38] *** Joins: garthk (garth@moz-B118B14A.static.internode.on.net)
[07:07:15] *** Quits: ctult (Mibbit@moz-C24A11E7.bois.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:08:12] <alan_andrade> How can I know all the methods I can use when working with vectors (or arrays?)
[07:08:48] <alan_andrade> I've been looking in std::vec but those aren't all are they ?
[07:08:51] <dbaupp> alan_andrade: unfortunately the easiest way is probably `grep 'pub fn' vec.rs` in libstd
[07:09:17] <alan_andrade> ohhh
[07:09:22] <alan_andrade> let me try
[07:09:47] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[07:09:50] <dbaupp> alan_andrade: since they (due to bugs) have to be implemented via traits, and the fact that a vector (and any other built-in type) implements a trait is only listed on the trait page
[07:09:56] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[07:09:58] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[07:10:02] <dbaupp> [they == the methods]
[07:10:08] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:10:45] <alan_andrade> @dbaupp awesome, now I can find the one I was looking for: 'tail()'
[07:11:38] <alan_andrade> thanks man
[07:11:54] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:12:46] *** Joins: ferris (Mibbit@moz-617F0DD0.hsd1.va.comcast.net)
[07:13:17] *** Joins: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch)
[07:15:16] *** Joins: ferrist (funktion@moz-617F0DD0.hsd1.va.comcast.net)
[07:15:26] *** Quits: ferris (Mibbit@moz-617F0DD0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:15:45] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:17:29] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:17:37] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[07:18:20] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[07:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[07:21:02] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[07:21:02] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[07:21:35] *** Joins: morphevs1 (Adium@moz-FC4FBD68.uzh.ch)
[07:21:35] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:22:13] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:22:31] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[07:23:20] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Quit: Leaving)
[07:23:38] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[07:23:52] *** Joins: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se)
[07:23:55] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:24:04] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Ping timeout)
[07:25:18] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[07:25:21] *** Quits: morphevs1 (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:27:52] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[07:27:58] *** Quits: telotort1um (rmi1@moz-C8F8CE6.hsd1.ca.comcast.net) (Ping timeout)
[07:28:39] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:30:19] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:31:19] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[07:31:56] *** Quits: jstevans (Instantbir@2EEF7823.589CEA99.B7830B68.IP) (Ping timeout)
[07:32:18] *** Quits: dreamer_ (Patryk@90E8C08F.8480A87C.DDAA0084.IP) (Quit: Leaving)
[07:34:51] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Client exited)
[07:35:12] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:36:34] *** Joins: morphevs1 (Adium@moz-FC4FBD68.uzh.ch)
[07:36:34] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:36:59] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:37:22] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[07:40:40] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:41:00] *** Parts: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) ()
[07:41:07] *** Joins: oberstet (quassel@moz-E001390B.dynamic.mnet-online.de)
[07:41:18] *** Joins: lpy (lpy@E3B0CC86.F09091A8.1348A864.IP)
[07:42:21] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:44:28] *** Joins: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP)
[07:45:00] *** Quits: lpy (lpy@E3B0CC86.F09091A8.1348A864.IP) (Client exited)
[07:45:02] <ezyang> Hmm, it is surprisingly difficult to extract a single mutable pointer to an item in a list, to mutate later 
[07:45:19] <ezyang> (For the case when, for example, you're trying to match for the "best" item of the list) 
[07:47:14] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:47:32] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[07:49:03] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:51:22] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[07:51:38] *** Joins: morphevs2 (Adium@moz-FC4FBD68.uzh.ch)
[07:51:41] *** Quits: morphevs1 (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:51:46] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:52:04] <ezyang> What does it mean when the borrow checker complains "cannot borrow more than once"; "second borrow occurs here", where the locations of the first and the second error are the same? 
[07:52:32] *** Quits: morphevs2 (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:52:33] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[07:52:50] *** Joins: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP)
[07:53:14] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:53:14] *** Joins: morphevs1 (Adium@moz-FC4FBD68.uzh.ch)
[07:53:42] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[07:54:21] *** Quits: morphevs1 (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[07:54:22] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[07:54:46] *** Quits: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP) (Quit: Computer has gone to sleep.)
[07:55:28] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[07:56:06] <ezyang> oh, apparently, that is what it does when there's a loop 
[07:56:19] *** Joins: Ms2ger (Ms2ger@moz-7C292AC.adsl-dyn.isp.belgacom.be)
[07:58:57] <klutzy> sounds like we need different error message for loop
[08:00:15] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:02:00] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:02:05] <ezyang> filing' bug 
[08:02:26] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[08:06:34] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:08:07] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Quit: Kxepal)
[08:08:09] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[08:08:21] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:08:25] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[08:08:31] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[08:08:45] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:09:02] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[08:09:35] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:10:03] *** Quits: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se) (Ping timeout)
[08:10:14] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[08:10:58] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[08:11:19] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:13:07] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:13:10] *** Quits: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP) (Quit: pyrac)
[08:13:42] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[08:14:25] *** Joins: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP)
[08:14:53] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:15:08] *** Joins: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com)
[08:15:33] *** Joins: vadimcn_ (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[08:15:36] *** Quits: vadimcn (chatzilla@91A9CD53.76F9E272.DA40C4B3.IP) (Ping timeout)
[08:15:37] *** vadimcn_ is now known as vadimcn
[08:17:17] *** Quits: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Input/output error)
[08:18:07] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[08:19:28] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:21:03] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[08:21:07] *** Quits: AvianFlu (AvianFlu@moz-C1C884AB.nyc.res.rr.com) (Connection reset by peer)
[08:21:10] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:21:37] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[08:22:18] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[08:22:58] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[08:24:00] *** Quits: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP) (Ping timeout)
[08:25:23] *** flaper87|afk is now known as flaper87
[08:25:56] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:27:40] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:28:26] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[08:29:17] *** Joins: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch)
[08:32:30] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:32:54] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[08:34:19] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:34:36] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[08:34:51] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[08:35:08] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:38:49] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:39:27] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Ping timeout)
[08:40:30] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:40:42] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[08:42:04] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[08:43:02] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[08:44:37] *** Quits: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il) (Ping timeout)
[08:45:14] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:46:48] *** Joins: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il)
[08:46:56] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:49:22] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[08:52:01] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:52:05] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[08:52:26] *** Quits: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il) (Ping timeout)
[08:53:07] <geomyidae> main.rs:138:20: 138:45 error: type `std::hashmap::HashMap<~[u8],~str>` does not implement any method in scope named `decode`
[08:53:07] <geomyidae> main.rs:138                     map.decode(&mut decoder);
[08:53:07] <geomyidae>                                 ^~~~~~~~~~~~~~~~~~~~~~~~~
[08:53:07] <geomyidae> But I've got `use extra::serialize::Decodable` pulling in the trait, right?
[08:53:43] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[08:58:08] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[08:58:57] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:59:52] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[09:00:56] <cmr> geomyidae: decode isn't a method, it's an associated function
[09:01:18] <cmr> so, let x: HashMap<~[u8], ~str> = Decodable::decode(&mut decoder);
[09:03:03] <ezyang> Does anyone else find it weird that while Rust does not have TCO, the borrow checker is a lot happier when you write algorithms recursively? 
[09:03:44] <cmr> ezyang: *guaranteed* TCO
[09:03:47] <cmr> llvm will do TCO when it can
[09:03:52] <ezyang> yes, I stand corrected 
[09:03:58] <cmr> (but destructors make it hard)
[09:04:25] <ezyang> cmr: I'm still trying to figure out how to remove an element from an owned mutable linked list :-( 
[09:04:42] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[09:05:10] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[09:06:08] *** Quits: Ms2ger (Ms2ger@moz-7C292AC.adsl-dyn.isp.belgacom.be) (Quit: bbl)
[09:07:40] <kimundi> ezyang: Do you know about util::swap() ?
[09:07:47] <ezyang> yep 
[09:08:18] *** Joins: nkoep (nik@moz-C40D4157.pool.mediaways.net)
[09:08:28] <ezyang> the big problem is not actually performing the swap, but convincing Rust that the accounting locals (borrowed pointers) are OK 
[09:08:57] <cmr> Honestly I don't see the point of fighting the compiler about it, I'd just use unsafe code.
[09:09:04] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[09:09:05] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:09:07] <cmr> The borrow checker still isn't complete and has known problems.
[09:09:14] <ezyang> boo 
[09:09:25] <ezyang> I think it's a kind of interesting academic exercise 
[09:12:18] <geomyidae> I'm a bit confused, the encoder api writes to a stream, but the json decoder expects a preloaded json object? It can't pull from a stream? Is there a reason that is obvious that isn't to me?
[09:14:01] <cmr> geomyidae: what do you mean?
[09:14:16] <geomyidae> http://static.rust-lang.org/doc/master/extra/json/struct.Decoder.html
[09:14:32] <geomyidae> new takes a Json object, but encoder: http://static.rust-lang.org/doc/master/extra/json/struct.Encoder.html takes a Writer
[09:14:48] <geomyidae> I would have expected Decoder to take/wrap a Reader
[09:15:33] <cmr> geomyidae: you want to be using json::from_reader, probably.
[09:16:22] <cmr> Encoder writes JSON to the stream, Decoder returns Rust values *from JSON*, not from a stream.
[09:16:36] <cmr> extra::serialize is quite weird, IMO
[09:17:03] <geomyidae> right, I had kinda figured that out but found it weird from an api standpoint was all
[09:17:08] <cmr> yeah
[09:17:17] <geomyidae> thanks for from_reader though, it does look like what I want more or less right nw
[09:17:32] <cmr> it returns a json object that you can pass to the decoder
[09:17:39] <geomyidae> mhm
[09:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[09:20:38] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[09:21:05] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[09:22:27] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[09:25:13] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[09:26:26] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[09:31:52] *** Joins: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com)
[09:35:02] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[09:36:06] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[09:37:52] *** Joins: Kxepal (Miranda@moz-BEA1ED22.pppoe.mtu-net.ru)
[09:38:13] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:38:22] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[09:39:12] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[09:39:35] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[09:41:15] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[09:43:26] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:43:26] *** Quits: nkoep (nik@moz-C40D4157.pool.mediaways.net) (Ping timeout)
[09:44:50] *** Quits: sprang (sprang@moz-920A95C4.hsd1.ca.comcast.net) (Ping timeout)
[09:46:01] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[09:47:19] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[09:47:44] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[09:48:40] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[09:50:55] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[09:51:03] *** Joins: Ferreus (ferreus@moz-4FD9061F.dip0.t-ipconnect.de)
[09:52:23] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[09:53:06] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[09:54:53] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[09:55:35] *** Joins: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr)
[09:55:45] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[09:55:45] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[09:56:06] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:56:12] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[09:58:51] *** Quits: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo)
[09:58:54] *** Joins: jviereck (Adium@moz-9B96A933.dip0.t-ipconnect.de)
[09:59:00] *** Joins: nkoep (nik@moz-61EB5487.vpn.rwth-aachen.de)
[09:59:02] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[09:59:07] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[10:00:35] *** Joins: Ms2ger (Ms2ger@moz-664B2345.ugent.be)
[10:00:48] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:01:32] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[10:01:40] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[10:02:51] *** Quits: iMadper (user@9612DFDD.697E8DD6.6D2830D2.IP) (Client exited)
[10:03:07] *** Quits: garthk (garth@moz-B118B14A.static.internode.on.net) (Ping timeout)
[10:03:07] *** Quits: photex (photex@399640B9.24E301D6.9510F13D.IP) (Ping timeout)
[10:03:33] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Ping timeout)
[10:03:41] *** Quits: meTaAU (admin@moz-9BDF415A.lns20.per1.internode.on.net) (Ping timeout)
[10:03:58] *** Quits: phil_ (phil@684D2576.37BA1B1C.20F09BA6.IP) (Ping timeout)
[10:04:09] *** Quits: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP) (Ping timeout)
[10:04:22] *** Quits: sfackler (sfackler@moz-AEECCEBA.com) (Ping timeout)
[10:04:28] *** Quits: heftig (heftig@moz-8E8EC722.dip0.t-ipconnect.de) (Quit: Quitting)
[10:04:31] *** lpy is now known as lpy|dinner
[10:04:36] *** Quits: egghead (egghead@7851DE85.C82F6435.20F09BA6.IP) (Ping timeout)
[10:05:05] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[10:05:26] *** Joins: phil_ (phil@684D2576.37BA1B1C.20F09BA6.IP)
[10:05:28] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:05:37] *** Quits: celeron55 (perttu@moz-D552F2C7.netplaza.fi) (Ping timeout)
[10:05:44] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[10:06:36] *** Joins: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP)
[10:06:41] *** Joins: photex (photex@399640B9.24E301D6.9510F13D.IP)
[10:06:45] *** Joins: sfackler (sfackler@moz-AEECCEBA.com)
[10:07:02] *** Joins: egghead (egghead@7851DE85.C82F6435.20F09BA6.IP)
[10:07:06] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[10:07:15] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:07:28] *** Joins: celeron55 (perttu@moz-D552F2C7.netplaza.fi)
[10:08:22] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Connection reset by peer)
[10:08:23] *** Joins: morphevs1 (Adium@moz-FC4FBD68.uzh.ch)
[10:08:30] *** Quits: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP) (Ping timeout)
[10:08:48] *** Quits: phil_ (phil@684D2576.37BA1B1C.20F09BA6.IP) (Ping timeout)
[10:08:52] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[10:09:59] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[10:10:00] *** Joins: meTaAU (admin@moz-9BDF415A.lns20.per1.internode.on.net)
[10:10:04] *** Quits: morphevs1 (Adium@moz-FC4FBD68.uzh.ch) (Ping timeout)
[10:10:15] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[10:10:36] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[10:11:55] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:12:17] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[10:12:49] *** Joins: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP)
[10:13:36] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:14:10] <geomyidae> not sure if I'm doing it wrong, but from_reader seems to be stuck https://github.com/colemickens/pcapfe/blob/master/main.rs#L140
[10:14:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[10:14:45] *** Quits: Torwegia (ubuntu@moz-193FD65D.us-west-2.compute.amazonaws.com) (Ping timeout)
[10:15:07] <geomyidae> It's not buffered output, but wireshark says I'm sending the right data, at least, what looks to be the right json data over several frames
[10:16:27] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Quit: Leaving.)
[10:16:38] <cmr> mmm, from_reader uses .read_to_end
[10:16:47] <cmr> Sockets only end when they get closed.
[10:18:04] *** Joins: Torwegia (ubuntu@moz-193FD65D.us-west-2.compute.amazonaws.com)
[10:18:22] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:19:40] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[10:20:10] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:20:31] *** Joins: fyolnish_ (fyolnish@moz-BE2BAE5B.miinet.jp)
[10:20:51] *** Joins: phil_ (phil@684D2576.37BA1B1C.20F09BA6.IP)
[10:21:03] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:21:32] *** Quits: Ferreus (ferreus@moz-4FD9061F.dip0.t-ipconnect.de) (Quit: WeeChat 0.4.2)
[10:22:17] *** Quits: fyolnish_ (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:24:48] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:24:52] <eddyb> cmr: oh wow https://www.youtube.com/watch?v=LyDliT0GZpE "they know what to do, but they can't do what they know"
[10:25:04] *** Joins: Ferreus (ferreus@moz-4FD9061F.dip0.t-ipconnect.de)
[10:25:05] <eddyb> maybe offtopic, but it describes me very well
[10:25:43] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[10:25:53] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[10:26:01] *** Joins: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP)
[10:26:21] <eddyb> that said, I should go back to trying to get this PNG decoder finished
[10:26:28] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:27:38] *** Quits: ferrist (funktion@moz-617F0DD0.hsd1.va.comcast.net) (Ping timeout)
[10:28:55] *** Quits: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[10:31:02] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[10:31:10] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[10:31:16] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:31:36] *** Joins: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP)
[10:31:52] *** Joins: peterdn (chatzilla@moz-3DA3F15F.as13285.net)
[10:32:56] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:33:20] *** Quits: recrack (recrack@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[10:35:16] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[10:35:58] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Quit: Leaving.)
[10:37:45] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:39:01] *** Quits: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr) (Ping timeout)
[10:39:35] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:40:55] *** Quits: zmthy (tim@moz-C2881CC3.ecs.vuw.ac.nz) (Quit: leaving)
[10:44:13] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:45:09] *** Joins: fyolnish (fyolnish@moz-2F2C024D.uqwimax.jp)
[10:45:54] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:46:31] *** Joins: morphevs (Adium@moz-FC4FBD68.uzh.ch)
[10:50:41] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:51:26] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[10:51:30] *** Quits: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP) (Quit: pyrac)
[10:52:19] *** Quits: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch) (Input/output error)
[10:52:26] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:56:11] *** Quits: jviereck (Adium@moz-9B96A933.dip0.t-ipconnect.de) (Quit: Leaving.)
[10:57:04] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[10:57:11] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[10:58:52] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[10:59:02] *** Joins: TisButMe (Mibbit@moz-40463609.w80-9.abo.wanadoo.fr)
[11:02:32] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[11:02:45] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Quit: Konversation terminated!)
[11:02:46] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[11:03:25] *** Quits: fyolnish (fyolnish@moz-2F2C024D.uqwimax.jp) (Quit: Bye)
[11:03:39] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:04:48] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[11:05:01] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[11:05:23] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[11:05:24] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:05:24] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[11:08:16] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:10:06] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:11:24] *** Joins: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch)
[11:11:34] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[11:11:49] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:16:40] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:18:23] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:22:38] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[11:23:01] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:24:44] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:28:28] <klutzy> does `make install` work?
[11:28:45] <klutzy> I'm getting: Aborting install because more than one library matching libstd-*.so is present in build tree x86_64-unknown-linux-gnu/stage2/lib: . Stop.
[11:28:49] *** Joins: jackneill (jackneill@moz-1EE14E.pool.digikabel.hu)
[11:28:55] <klutzy> (make clean && make install)
[11:29:30] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:29:31] <cmr> klutzy: there are some transient problems with the build system atm.
[11:30:55] *** Quits: Ms2ger (Ms2ger@moz-664B2345.ugent.be) (Ping timeout)
[11:30:59] <klutzy> cmr: hmm, are there other similar issues like this?
[11:31:11] <cmr> klutzy: I think most of them have been fixed by now
[11:31:16] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:31:21] <cmr> (static linking initially broke quite a few things)
[11:31:31] <cmr> klutzy: how many files matching libstd-*.so are in that dir?
[11:32:56] <klutzy> cmr: uh.. second `make install` worked ok. don't know why though
[11:34:35] <klutzy> cmr: anyway there are only one libstd-*.so at the dir
[11:34:48] <cmr> mm, ok
[11:35:57] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:37:39] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:38:53] *** lpy|dinner is now known as lpy
[11:41:47] *** Joins: Hildar (Mibbit@moz-FD6A998D.in-addr.btopenworld.com)
[11:42:23] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:44:05] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:45:25] *** Joins: vmx (vmx@moz-3F547149.pools.arcor-ip.net)
[11:48:53] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:49:34] *** kimundi is now known as zz_kimundi
[11:49:41] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[11:50:12] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[11:50:34] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:50:52] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[11:51:54] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[11:53:07] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[11:54:55] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[11:55:19] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[11:57:01] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[11:57:24] <ChrisMorgan> Remember that `make clean` doesn't clear out $PREFIX.
[11:57:35] <Boreeas> Is there a way to make a vector of mutable objects
[11:57:39] <Boreeas> i.e. ~[mut Partition]
[11:57:52] <cmr> Boreeas: Your understanding of mutability is wrong.
[11:57:57] <eddyb> Boreeas: ~[Partition], as long as it's in a mutable slow
[11:57:59] <eddyb> *slot
[11:58:07] <cmr> With ~[T], the T is always mutable.
[11:58:27] <eddyb> rusti: let mut v = ~[0, 1]; v[0] = 2; v
[11:58:28] -rusti- ~[2, 1]
[11:58:41] <cmr> Values are always mutable, but whether you can mutate them or not depends on where they are stored.
[11:59:04] <eddyb> ChrisMorgan: I was curious if you had valuable insights for designing a streaming decoder in Rust
[11:59:18] <eddyb> I am doing something, but I'm not sure it's going to work that well
[12:01:42] <Boreeas> How do I tell rustc that the values are can be mutated then? Maybe I'm going at this wrong, but essentially what I have is a "struct Partition { summands: ~[uint] }, and I got a method that returns a vector of Partitions. I  want to push a value into each summands vector in each partition
[12:01:50] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:02:34] <cmr> `let mut partitions = foo.partitions(); partitions.push(...);`
[12:02:46] <cmr> `let mut partitions = foo.partitions(); partitions[0].push(...);`, rather
[12:02:58] <cmr> Guh, there should be a .summands in there somewhere
[12:03:01] <cmr> But that's the gist of it.
[12:03:18] <Boreeas> Ah, okay
[12:03:20] <Boreeas> Thanks
[12:03:32] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:07:04] *** Quits: nkoep (nik@moz-61EB5487.vpn.rwth-aachen.de) (Ping timeout)
[12:08:20] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:10:01] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:10:28] *** Joins: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP)
[12:10:56] <ChrisMorgan> eddyb: Rust is really great for state machines. e.g. `enum State { ... } let mut state = Start; loop { action(); state = match state { Start => { ...; Foo }, Foo if cond => { ...; Bar }, ... }`
[12:13:34] <eddyb> ChrisMorgan: I have a function that returns Result<(uint, State), ~str> - where the uint is the numbers of bytes it advanced
[12:14:48] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:15:17] <ChrisMorgan> In error cases you may well still want the state; some errors are recoverable. (Of course, this varies from case to case.)
[12:16:17] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[12:16:20] <ChrisMorgan> rust-http has a certain quantity of state machine in it, but they tend to be local grammars.
[12:16:25] <eddyb> my errors are all fatal. I guess I could add an interface to emit warnings, but it doesn't make much sense here
[12:16:28] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:16:41] <eddyb> and everything else is pretty much what you described. context: PNG decoder
[12:16:52] <cmr> Having worked with joyent's http parser, I strongly recommend *not* structuring it as a state machine.
[12:17:04] <cmr> It might be a bit cleaner in Rust, but it still turns into a massive mess.
[12:17:09] <ChrisMorgan> Joyent's HTTP parser is a disaster.
[12:17:27] <ChrisMorgan> It's impressive that it works *at all*. But it's got loads of ugly bugs and bad behaviours.
[12:17:28] *** Joins: w3lcome (Mibbit@EAD96774.6B9C41FA.6316A47C.IP)
[12:18:25] <eddyb> cmr: eeh, comparing non-idiomatic C to idiomatic Rust...
[12:19:14] <cmr> eddyb: even the idiomatic state machine in extra::terminfo gets messy.
[12:19:36] <cmr> (terminfo/parm.rs)
[12:21:15] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:21:16] <ChrisMorgan> cmr: as it stands, rust-http is just a *little* too high‐level; I need to make it so that a lower‐level approach is convenient—giving a header iterator, then a body reader [and then a trailer header iterator, if desired].
[12:21:48] *** Quits: Sgeo (quassel@moz-D0F30617.dyn.optonline.net) (Connection reset by peer)
[12:22:57] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:23:55] *** Quits: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com) (Ping timeout)
[12:24:23] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[12:25:55] *** Joins: nkoep (nik@moz-C40D4157.pool.mediaways.net)
[12:26:58] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[12:27:27] * ChrisMorgan sometimes wishes typestate was still around in some form; state machines often have certain methods which require a certain state to be valid, typestate meant that you could compile that in rather than leaving it to runtime assertions.
[12:27:44] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:27:45] <ChrisMorgan> (I know that you can do things like create new objects for different states and restrict it that way.)
[12:27:57] <cmr> ChrisMorgan: afaik typestate still left in assertions.
[12:29:23] <ChrisMorgan> cmr: from my understanding of typestate (it was gone before I started, which saddened me a little—it had been one of the features I'd liked the look of much earlier on), it meant that you could make it so that calling a method when the state was going to be wrong would fail at compilation time.
[12:29:27] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:31:13] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[12:33:03] *** Joins: mib_moaqq9 (Mibbit@moz-CBD76C21.bb.online.no)
[12:33:55] *** Joins: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP)
[12:34:13] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:35:55] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:39:27] *** Joins: sprang (sprang@moz-824FD61F.hsd1.ca.comcast.net)
[12:40:06] <eddyb> it's a little annoying when I have to do this, because the type of Ok is different: Err(m) => Err(m)
[12:40:07] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[12:40:40] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:42:20] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:43:11] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[12:43:47] *** Joins: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com)
[12:45:30] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[12:45:59] *** Joins: vishrut (Mibbit@9AC9DFD0.40030DA0.CA052C06.IP)
[12:46:39] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[12:47:07] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:48:41] *** Quits: morphevs (Adium@moz-FC4FBD68.uzh.ch) (Ping timeout)
[12:48:47] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:48:52] *** Joins: deLta30 (quassel@E22A2412.2B853011.ADE57C3C.IP)
[12:49:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[12:50:19] *** Quits: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com) (Client exited)
[12:51:03] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[12:51:53] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Ping timeout)
[12:53:35] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[12:55:15] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[12:56:21] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[12:57:49] *** Joins: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com)
[13:00:00] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[13:00:08] *** Quits: jxs (joaoxsouls@moz-A7EE0DAF.compute-1.amazonaws.com) (Ping timeout)
[13:01:04] <friggle> ChrisMorgan: is joyent's http parser a different lineage to the mongrel parser?
[13:01:32] <ChrisMorgan> friggle: yes, mongrel uses a ragel-based parser.
[13:01:40] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[13:01:40] *** zz_kimundi is now known as kimundi
[13:01:44] <ChrisMorgan> Whereas the joyent parser is just an utter monstrosity.
[13:02:09] <friggle> ChrisMorgan: have you considered adopting the mongrel parser?
[13:02:13] *** Quits: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com) (Client exited)
[13:02:37] <ChrisMorgan> friggle: rust-http is written in Rust and only Rust. External dependencies like that are absolutely out.
[13:02:59] *** Quits: vishrut (Mibbit@9AC9DFD0.40030DA0.CA052C06.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:03:12] *** Joins: morphevs (Adium@moz-F455D934.uzh.ch)
[13:03:15] <ChrisMorgan> (Using the Ragel grammar is not necessarily out, but the brief examination I took of what it does led me to believe that it would probably not add value.)
[13:03:42] <friggle> ChrisMorgan: I thought someone had a rust backend for ragel (probably way out of date). Anyway, fair enough
[13:04:09] <ChrisMorgan> Yes, that was erickt's.
[13:04:31] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[13:04:32] <kimundi> eddyb: Hm, that Err(m) => Err(m) sounds like you want .map_err() :P
[13:04:41] <kimundi> err, just map()
[13:05:20] <eddyb> kimundi: eh, I kinda need the match
[13:05:41] <eddyb> but err => err wouldn't work, that's my point
[13:06:04] *** flaper87 is now known as flaper87|afk
[13:06:28] <kimundi> eddyb: Right, because its not the right type
[13:06:30] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[13:07:55] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[13:08:12] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[13:12:54] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[13:14:01] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[13:14:34] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[13:14:40] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[13:15:56] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[13:16:20] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[13:17:39] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[13:18:42] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[13:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[13:20:01] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:21:32] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[13:25:13] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[13:27:42] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[13:27:44] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:29:16] *** Quits: pyrac (pyrac@7976C2F7.73C89388.AD05C589.IP) (Quit: pyrac)
[13:29:26] *** Joins: Sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[13:30:56] *** Joins: jstevans (Instantbir@EB54EACE.1D53A164.B7830B68.IP)
[13:32:37] *** Quits: jstevans (Instantbir@EB54EACE.1D53A164.B7830B68.IP) (Ping timeout)
[13:34:39] *** Joins: sigma (sigma@moz-A17EB325.range86-184.btcentralplus.com)
[13:40:39] *** Joins: refold (gman@moz-42D68426.a258.priv.bahnhof.se)
[13:41:27] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[13:41:43] *** Joins: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP)
[13:41:56] *** Quits: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[13:42:50] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[13:43:45] *** Quits: osa1__ (omer@moz-8FDAB45C.hsd1.il.comcast.net) (Ping timeout)
[13:45:20] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[13:45:51] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[13:46:01] <mletterle> Happy Monday rustopia!
[13:46:48] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:47:31] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[13:48:12] <bstrie> *rustralia
[13:49:00] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[13:49:09] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[13:51:11] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[13:56:20] *** Joins: jvns (bork@moz-DE62990.nyc.res.rr.com)
[14:01:15] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[14:01:39] *** Joins: tcr (tcr@66796279.4683C875.9D2C3D3E.IP)
[14:04:50] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[14:05:25] *** flaper87|afk is now known as flaper87
[14:06:12] *** jorendorff_away is now known as jorendorff
[14:10:30] *** Quits: deLta30 (quassel@E22A2412.2B853011.ADE57C3C.IP) (Connection reset by peer)
[14:11:39] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[14:12:23] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[14:12:57] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:13:35] *** Joins: deLta30 (quassel@58B8874B.43774B36.F7B44A7.IP)
[14:14:20] *** Joins: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP)
[14:14:20] *** ChanServ sets mode: +o jdm
[14:16:24] *** Joins: mudpit (Mibbit@moz-FFC03272.libero.it)
[14:16:45] *** Quits: mudpit (Mibbit@moz-FFC03272.libero.it) (Quit: http://www.mibbit.com ajax IRC Client)
[14:17:09] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[14:17:33] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Ping timeout)
[14:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[14:19:35] *** Joins: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP)
[14:19:48] *** Joins: Ms2ger (Ms2ger@moz-7C292AC.adsl-dyn.isp.belgacom.be)
[14:20:05] *** Joins: rca (rcatolino@moz-E7ABCBEC.adsl.proxad.net)
[14:21:02] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[14:22:47] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[14:24:03] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[14:25:36] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[14:26:23] *** Quits: jvns (bork@moz-DE62990.nyc.res.rr.com) (Ping timeout)
[14:27:17] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[14:28:16] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[14:28:48] *** jorendorff is now known as jorendorff_away
[14:31:39] *** Joins: lfox (lfox@moz-8C19C973.nyc.res.rr.com)
[14:35:04] <bstrie> wycats_: hope you're feeling better!
[14:36:56] *** Joins: pyrac (pyrac@moz-D335AC7D.math.u-bordeaux1.fr)
[14:39:13] *** Quits: tcr (tcr@66796279.4683C875.9D2C3D3E.IP) (Client exited)
[14:39:33] *** Joins: tcr (tcr@66796279.4683C875.9D2C3D3E.IP)
[14:39:53] <eddyb> I can't update to master: Unable to checkout 'eac6ff795c40778683e42b0c6ab6f6adaceb391d' in submodule path 'src/llvm'
[14:40:02] <eddyb> fatal: reference is not a tree: eac6ff795c40778683e42b0c6ab6f6adaceb391d
[14:40:12] <bstrie> make clean?
[14:41:01] <bstrie> seems like this sort of thing just happens sometimes, forcing you to delete the llvm directory and build it again
[14:41:14] *** Quits: tcr (tcr@66796279.4683C875.9D2C3D3E.IP) (Ping timeout)
[14:41:19] <eddyb> yeah, that's what I did, rm -rf src/llvm and git checkout src/llvm
[14:41:22] <klutzy> git submodule sync and update?
[14:41:41] <eddyb> though I'm not sure what the checkout does
[14:41:56] <eddyb> configure is cloning src/llvm so all is fine
[14:47:32] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[14:47:36] *** jorendorff_away is now known as jorendorff
[14:48:05] <agrif> hey guys. is there a way to tell rust that an expression should have a certain type?
[14:48:11] <agrif> without using let and assigning it to a variable
[14:48:23] <agrif> something like expr :: Type in haskell
[14:48:33] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[14:48:53] <bstrie> agrif: if you're calling a function, you can do `foo::<type>()`
[14:49:13] <agrif> ah-hah!
[14:49:23] <agrif> that'll do
[14:49:29] <agrif> thanks!
[14:49:29] <pnkfelix> agrif: Note that bstrie's example is telling it how to instantiate the type parameters of `foo`
[14:50:11] <pnkfelix> agrif: though I believe that one could use this feature to implement `expr :: Type` as a function.  (Something like `fn is_type<T>(x: T) { x }`)
[14:50:24] <agrif> so if I'm calling a function on a trait that has type fn foo(...) -> Self, will that work?
[14:50:47] <eddyb> agrif: ahh, you want the type for which the trait is implemented?
[14:50:52] <agrif> yeah
[14:51:05] <agrif> which isn't an explicit type parameter
[14:51:29] <eddyb> I think from_str is a fn<T> which uses FromStr<for T>
[14:51:53] <eddyb> agrif: if it's the return type of a function, inference will work, just like an explicit type in let
[14:52:12] <agrif> yeah, except the type that it will infer it as is a trait object
[14:52:16] <eddyb> agrif: right now it's not possible to do Trait<for T>, which is what you'd need
[14:52:16] <agrif> which is not helpful
[14:52:22] *** Joins: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se)
[14:52:35] <eddyb> agrif: why would it do that?
[14:52:44] <agrif> because I'm returning it as a trait object
[14:53:02] <agrif> but inside the function, I have a dispatch table to create different types that all implement that trait
[14:54:05] <eddyb> agrif: oh, I see what you mean. you have to use a helper function like pnkfelix suggested, if you don't want temporaries
[14:54:18] <agrif> :/
[14:55:01] <eddyb> to_type::<T>(foo.bar()) // doesn't look that bad
[14:55:10] <agrif> if casts influenced the type inferrer, that would be enough
[14:55:13] <agrif> but they don't seem to
[14:55:19] <eddyb> well, no, Foo::bar(...) is your case
[14:55:49] <eddyb> agrif: casts are for scalars, not inference/high-level-conversion
[14:56:15] <agrif> I still feel like "var as Type" should tell the inferrer at least that "var is something I could cast to Type"
[14:56:23] <agrif> and for higher level stuff, that's just Type
[14:56:30] *** Joins: jviereck (Adium@moz-CAFF94BC.dip0.t-ipconnect.de)
[14:56:41] <eddyb> I don't disagree that it can be better, though
[14:57:00] *** Joins: skade (skade@30BBD5E6.505237C9.CAE22B62.IP)
[14:57:01] <pnkfelix> agrif: here is full example illustration of what eddyb is suggesting: https://gist.github.com/pnkfelix/7873480
[14:57:01] <agrif> Foo::bar() as T looks so much purtier :P
[14:57:24] *** Quits: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP) (Input/output error)
[14:57:28] <agrif> I got it. that's what I'll end up using
[14:57:30] <eddyb> agrif: the proper way to do this is Foo::<for T>::bar(...), but we don't have that "for" syntax yet
[14:57:35] *** Quits: pyrac (pyrac@moz-D335AC7D.math.u-bordeaux1.fr) (Quit: pyrac)
[14:57:41] <agrif> ah, ok
[14:57:57] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Client exited)
[14:58:10] <agrif> it does make things like FromPrimitive sort of akward to use now
[14:58:13] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[14:58:20] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[14:58:49] *** Joins: pyrac (pyrac@moz-D335AC7D.math.u-bordeaux1.fr)
[14:58:50] *** Joins: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP)
[14:59:07] *** kimundi is now known as zz_kimundi
[14:59:24] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Quit: Leaving...)
[15:00:37] *** Quits: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP) (Input/output error)
[15:03:23] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[15:05:00] *** Quits: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP) (Input/output error)
[15:05:20] *** Joins: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP)
[15:05:26] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[15:06:18] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[15:07:34] <agrif> oh while I'm here, is there any chance that macros have some symbol-pasting ability I don't see anywhere?
[15:07:47] <bstrie> symbol-pasting?
[15:07:58] <agrif> symbol joining, maybe
[15:08:08] <eddyb> concat_idents!, I think
[15:08:08] <agrif> in the c preprocessor it's ##
[15:08:11] <eddyb> but it might be broken
[15:08:29] <agrif> oh, I'll look in that direction then, thanks
[15:10:30] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[15:10:31] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[15:11:34] *** sam113101_afk is now known as sam113101
[15:12:15] <agrif> it does appear to be broken
[15:12:33] <agrif> ah well, that's probably for the best
[15:13:26] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[15:14:04] *** Joins: tcr (tcr@66796279.4683C875.9D2C3D3E.IP)
[15:14:16] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[15:14:35] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[15:16:02] *** Quits: tcr (tcr@66796279.4683C875.9D2C3D3E.IP) (Ping timeout)
[15:16:22] *** Quits: Jesin (Jesin@moz-63C897DA.res.lehigh.edu) (Quit: Leaving)
[15:18:10] *** Quits: taotetek (taotetek@E90CF190.930C8FCA.20F09BA6.IP) (Quit: WeeChat 0.4.2)
[15:19:23] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[15:21:15] *** Quits: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP) (Ping timeout)
[15:21:15] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[15:23:17] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[15:25:40] *** Joins: ianj (ianjneu@moz-7140CF01.ccs.neu.edu)
[15:26:10] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:26:48] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[15:29:34] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:31:17] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[15:34:54] <eddyb> what triggers a partial llvm build?
[15:35:03] <cmr> llvm was updated.
[15:35:20] <eddyb> something failed and now it's missing a binary but it won't build anything for it
[15:35:28] <eddyb> i.e. there's no proper dependency chain
[15:35:39] <eddyb> /bin/sh: /home/eddy/Projects/rust/x86_64-unknown-linux-gnu/llvm/Release+Asserts/bin/llvm-mc: No such file or directory
[15:35:55] <cmr> make clean-llvm; make
[15:36:17] <eddyb> eeeh, I don't want that. I want a partial rebuild
[15:36:27] <eddyb> since I've already cleaned once today
[15:37:04] <cmr> well "partial rebuild" isn't really a thing that exists.
[15:37:11] <eddyb> >:(
[15:37:13] <cmr> `make llvm` will do things
[15:37:19] <cmr> but what else would you expect?
[15:37:21] <eddyb> right now it thinks it finished
[15:37:25] <eddyb> but it didn't
[15:37:30] <cmr> well, if it thinks it is, it is
[15:37:40] <eddyb> but it's missing a binary
[15:37:43] <eddyb> (at least one)
[15:37:45] <cmr> but it isn't!
[15:37:52] <pnkfelix> eddyb: have you looked at mk/llvm.mk ?
[15:38:14] <pnkfelix> eddyb: you could delete whatever file $$(LLVM_CONFIG_$(1)) corresponds to
[15:40:20] *** Joins: jvns (bork@87D98E32.4046EB22.428F94DD.IP)
[15:40:38] <eddyb> rm x86_64-unknown-linux-gnu/llvm/Release+Asserts/bin/llvm-config # does something, thanks pnkfelix :D
[15:41:21] *** Joins: IRCMonkey37989 (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[15:41:29] *** Quits: IRCMonkey37989 (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: IRCMonkey37989)
[15:41:53] <eddyb> ok, so I get the same error back:  /home/eddy/Projects/rust/x86_64-unknown-linux-gnu/llvm/Release+Asserts/lib/libLLVMInstCombine.a(InstructionCombining.o): In function `llvm::InstCombiner::visitGetElementPtrInst(llvm::GetElementPtrInst&)': InstructionCombining.cpp:(.text+0x60bf): undefined reference to `llvm::InstCombiner::visitBitCast(llvm::BitCastInst&)'
[15:42:29] <pnkfelix> eddyb: well, at that point, I'm not sure what you can do without cleaning llvm
[15:42:50] <pnkfelix> eddyb: since that looks like an error you're getting from the llvm build itself.
[15:42:54] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[15:43:02] <cmr> eddyb: did you re-configure?
[15:43:02] <eddyb> well, my laptop shut down during a LLVM build. let me try removing some of the files involved
[15:43:07] <cmr> (after the clean)
[15:43:09] <eddyb> cmr: erm, no
[15:43:24] <Ms2ger> Try removing any empty files
[15:43:28] <eddyb> the LLVM tree was clean, AFAICT
[15:43:54] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[15:45:41] <eddyb> pnkfelix: ouch, this is really dangerous. I apparently interrupted the creation of an .a archive, and it's missing files. I thought things like this were supposed to not be saved on disk in the proper place before completion
[15:46:31] <pnkfelix> eddyb: search me, I've never looked at the llvm build logic.
[15:46:44] *** Joins: dredozubov (dredozubov@D698DD84.5B945A24.CEFD53F7.IP)
[15:47:08] <eddyb> llvm[4]: Building Release+Asserts Archive Library libLLVMInstCombine.a # no, it's redoing this, and it's still wrong. hmm
[15:47:17] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[15:47:19] <SiegeLord> That's kind of a problem with make itself... you don't get that feature by default
[15:47:32] <SiegeLord> You can emulate it, but I guess LLVM folks didn't?
[15:47:54] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[15:48:00] <cmr> they primarily use cmake iirc
[15:49:23] <pnkfelix> cmr: doesn't cmake just generate make (or visual studio project, etc) ?
[15:49:42] <cmr> pnkfelix: yes, but it *does* have the aforementioned feature
[15:49:47] <eddyb> okay, apparently removing the entire directory used by an archive works. there's a Makefile in there, maybe that's causing incomplete builds
[15:50:13] <pnkfelix> cmr: Oh, as in the files it generates should adhere to the rule that eddyb mentioned?  (or "could adhere to it" ?)
[15:50:29] <cmr> yeah
[15:51:24] <eddyb> this might have been stale makefiles, I'm not sure
[15:51:54] <eddyb> since I didn't re-./configure *and* I had a spontaneous anti-meltdown shutdown
[15:52:34] <eddyb> my fault for trying to speed the build up during winter (with heat on and no open windows, etc.)
[15:53:55] *** Quits: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch) (Quit: WeeChat 0.4.2)
[15:56:18] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[15:56:33] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:57:29] *** Joins: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr)
[15:57:44] <eddyb> weird, just removing those Makefiles and the libraries they are responsible for isn't enough
[15:58:12] <eddyb> unless the libraries are fine and their user is broken. oh the joy of patching up a build
[16:00:02] *** Quits: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[16:00:05] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[16:00:28] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:00:29] *** ChanServ sets mode: +ao dherman dherman
[16:00:29] *** Joins: zslayton (Mibbit@81EB2473.5F4BC84E.66C78B76.IP)
[16:02:46] *** Quits: morphevs (Adium@moz-F455D934.uzh.ch) (Quit: Leaving.)
[16:02:59] *** Joins: docbrown (docbrown@5CE9D448.F0B9EFB2.7F8758CE.IP)
[16:03:32] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[16:04:04] *** Quits: StarLight (StarLight@moz-B6134C8F.dynamic.avangarddsl.ru) (Ping timeout)
[16:05:23] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[16:05:43] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:08:05] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[16:08:05] *** Joins: StarLight (StarLight@90A4DCD2.D5479371.F1EF1E39.IP)
[16:08:51] *** Joins: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[16:15:02] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[16:16:05] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[16:16:11] *** Quits: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se) (Client exited)
[16:16:28] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[16:19:17] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[16:19:22] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[16:21:06] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[16:22:16] *** Joins: FreeFull (freefull@moz-79FD0D17.as13285.net)
[16:22:50] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[16:23:04] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[16:23:04] *** ChanServ sets mode: +o jdm
[16:23:13] *** Joins: sellout (sellout-@moz-AE26682A.hlrn.qwest.net)
[16:25:27] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Client exited)
[16:25:29] <eddyb> rusti: enum Foo {Bar = 0, Baz = 1} let a = 0 as Foo;
[16:25:30] -rusti- <anon>:9:44: 9:52 error: non-scalar cast: `<VI0>` as `main::Foo`
[16:25:31] -rusti- <anon>:9         enum Foo {Bar = 0, Baz = 1} let a = 0 as Foo;
[16:25:31] -rusti-                                                      ^~~~~~~~
[16:25:31] -rusti- error: aborting due to previous error
[16:25:31] -rusti- application terminated with error code 101
[16:25:34] <eddyb> eeeh
[16:25:48] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[16:26:06] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[16:27:28] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Ping timeout)
[16:28:23] *** sam113101 is now known as sam113101_afk
[16:28:34] *** sam113101_afk is now known as sam113101
[16:28:35] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[16:29:30] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[16:30:37] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[16:30:39] <eddyb> rusti: enum Foo {Bar = 0, Baz = 1} let x = 0u8; match x {Bar => "bar", Baz => "baz" }
[16:30:40] -rusti- pastebinned 8 lines of output: http://sprunge.us/fUgC
[16:30:51] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[16:31:12] <eddyb> rusti: enum Foo {Bar = 0, Baz = 1} let x = 0u8; match x {Bar as u8 => "bar", Baz as u8 => "baz", _ => "eh" }
[16:31:12] -rusti- <anon>:9:62: 9:64 error: expected `=>` but found `as`
[16:31:13] -rusti- <anon>:9         enum Foo {Bar = 0, Baz = 1} let x = 0u8; match x {Bar as u8 => "bar", Baz as u8 => "baz", _ => "eh" }
[16:31:13] -rusti-                                                                        ^~
[16:31:13] -rusti- application terminated with error code 101
[16:32:31] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Ping timeout)
[16:35:19] *** Quits: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr) (Ping timeout)
[16:37:27] <wycats_> If people are worried I'm in a decent amount of pain but I'll be ok
[16:38:15] <wycats_> I got the best surgeon in Oregon to fuse my verbtebra
[16:38:20] <wycats_> Which was necessary
[16:38:29] <bstrie> wycats_: :(
[16:38:35] <cmr> wait what happened
[16:38:51] <wycats_> I fell through my ceiling
[16:38:55] <cmr> wat
[16:39:03] <mletterle> (o_O)
[16:39:14] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[16:39:15] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[16:40:03] <sbalmos> yow
[16:40:15] <sbalmos> wycats_: Trying to pull a Clark Griswold?
[16:40:41] <wycats_> I was just running some coax
[16:40:51] <wycats_> And stepped on the drywall instead of a beam
[16:40:58] <wycats_> I was being careful to
[16:41:13] <wycats_> It was dark upstairs and light downstairs so it was mega disorienting
[16:41:25] <sbalmos> :(
[16:41:31] <achin> :(
[16:41:39] <sbalmos> Done that many times (running coax, Cat5, etc in the attic)
[16:42:09] <achin> i try to lay out some plywood sheets over the beam to provide a catwalk
[16:42:42] *** Joins: doomlord__ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[16:42:48] *** Joins: heftig (heftig@moz-8E8EC722.dip0.t-ipconnect.de)
[16:42:54] *** Quits: doomlord__ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Client exited)
[16:45:26] *** Quits: Dessimat0r (Dessimat0r@3258E608.E588CE06.9A579328.IP) (Ping timeout)
[16:46:28] *** Quits: pyrac (pyrac@moz-D335AC7D.math.u-bordeaux1.fr) (Ping timeout)
[16:46:56] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[16:47:27] *** Joins: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP)
[16:47:37] *** Quits: dredozubov (dredozubov@D698DD84.5B945A24.CEFD53F7.IP) (Ping timeout)
[16:47:40] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:48:11] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[16:48:27] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:48:32] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:48:56] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[16:49:17] *** Joins: dredozubov (dredozubov@D698DD84.5B945A24.CEFD53F7.IP)
[16:49:39] *** Quits: jviereck (Adium@moz-CAFF94BC.dip0.t-ipconnect.de) (Quit: Leaving.)
[16:50:09] *** jorendorff is now known as jorendorff_away
[16:53:41] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[16:54:38] *** Quits: Hildar (Mibbit@moz-FD6A998D.in-addr.btopenworld.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:56:21] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[16:56:48] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[16:57:45] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[16:58:40] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[16:59:00] *** Joins: morphevs (Adium@moz-C5EAB99D.dclient.hispeed.ch)
[17:00:03] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[17:01:06] *** Joins: AvianFlu_ (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[17:01:45] <eddyb> does &&mut not work?
[17:01:50] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Ping timeout)
[17:01:57] <eddyb> does it have to be &mut &mut?
[17:02:14] <cmr> & &mut
[17:02:21] <cmr> but & &mut does not make the inner &mut mutable
[17:02:27] <cmr> it'd break the aliasing rules
[17:02:30] <cmr> (iirc)
[17:02:51] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Quit: Leaving)
[17:02:51] *** Quits: AvianFlu_ (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Quit: Leaving...)
[17:02:59] *** Joins: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[17:03:11] <eddyb> eeeh
[17:03:58] *** Joins: jstevans (Instantbir@moz-4901188E.bootp.virginia.edu)
[17:04:57] *** Joins: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net)
[17:05:52] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:05:56] *** Joins: kzzch (kzzch@moz-991A24E8.hsd1.va.comcast.net)
[17:05:59] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[17:06:00] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Ping timeout)
[17:06:07] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[17:08:03] *** Quits: mib_moaqq9 (Mibbit@moz-CBD76C21.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[17:08:05] *** Quits: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net) (Ping timeout)
[17:08:14] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[17:08:40] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[17:10:52] *** Quits: fixplz (uid18459@moz-A42E5B7B.irccloud.com) (Quit: Connection closed for inactivity)
[17:11:09] <jvns> when using rust-core, what does "error:  requires `strdup_uniq` lang_item" mean? It happens when I write 'let a = ~"hello";'
[17:11:37] <cmr> jvns: it means it needs the strdup_uniq lang item :p
[17:11:42] <cmr> looks like rust-core doesn't support ~str
[17:12:22] <jvns> hmm okay
[17:12:25] <jvns> and "allocation of `int` requires `exchange_malloc` lang_item" is similar
[17:12:32] <jvns> what is a lang item?
[17:12:40] <cmr> Oh, it probably just doesn't support ~ at all.
[17:12:44] *** Joins: sanxiyn (tinuviel@62C85FC9.1C19B322.6A273BE4.IP)
[17:12:48] <cmr> Lang items are ways the compiler exposes its internals.
[17:12:55] <cmr> It will emit calls to them for various things.
[17:13:15] <jvns> sort of like system calls, but for the compiler
[17:13:17] <cmr> It's a way to avoid magic.
[17:13:21] <cmr> basically yeah
[17:13:38] <cmr> gcc and clang also have them, but they don't use lang items, they just use specific symbol names.
[17:13:43] <cmr> (see compiler-rt and libgcc_
[17:13:49] <jvns> hmm okay
[17:14:06] <jvns> so I don't actually care about ~ too much, I'm really just trying to find a way to test memory allocation
[17:14:42] <cmr> see heap.rs
[17:15:34] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[17:15:47] <jvns> hmm okay so there's malloc_raw
[17:15:59] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[17:16:17] *** Quits: skade (skade@30BBD5E6.505237C9.CAE22B62.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:16:56] *** Quits: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP) (Quit: Computer has gone to sleep.)
[17:17:11] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[17:17:21] *** Joins: Dessimat0r (Dessimat0r@3258E608.E588CE06.9A579328.IP)
[17:17:30] *** Joins: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net)
[17:18:03] <eddyb> cmr: didn't you have an exchange_malloc attribute on malloc_raw?
[17:18:20] <jvns> hmm I don't understand how to write nontrivial code without having ~
[17:18:44] <eddyb> cmr: err, mistaken you for strcat
[17:18:51] <jvns> is it still possible to allocate new objects?
[17:19:05] <eddyb> jvns: ~ should be working, are you compiling against rust-core with --cfg libc?
[17:19:09] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[17:19:15] <jvns> let me see!
[17:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[17:19:34] <eddyb> you need to implement your own malloc/free, though
[17:19:43] <eddyb> this is where the dumb linear allocator would come in handy
[17:19:51] <sanxiyn> eddyb: Language items are at libstd/unstable/lang.rs
[17:19:56] <eddyb> sanxiyn: rust-core
[17:19:59] <jvns> yeah I'm okay with implementing my own malloc/free
[17:20:02] <sanxiyn> ah ok
[17:20:44] <jvns> haha apparently I need to define a bunch of other things
[17:20:45] <kzzch> what's the best way to go from .8 to master?
[17:20:49] <eddyb> jvns: strcat didn't let me add magic to rust-core, that would allow you to do something fancy like this https://github.com/thestinger/rust-core/pull/4/files#diff-2b6cca58e645b4220166115e47f8af57R9
[17:21:03] <cmr> kzzch: install master, fix errors.
[17:21:19] <eddyb> jvns: there's no special code in that example, just a static definition
[17:21:32] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[17:21:35] <jvns> eddyb: do you know about these pthread_mutex_* functions?
[17:21:51] <eddyb> jvns: hehe, remember when I was surprised you weren't having much trouble?
[17:21:52] <jvns> can I just make stubs for them as long as I don't have thread?
[17:21:54] <jvns> =)
[17:22:04] <jvns> they're runtime errors, not compiler errors
[17:22:11] <eddyb> they're link errors
[17:22:13] <jvns> oh yeah
[17:22:14] <jvns> that
[17:22:15] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[17:22:15] <jvns> :)
[17:22:24] <jvns> but if I don't allocate any memory they don't happen
[17:22:28] <eddyb> jvns: it's easier, add #[cfg(pthread)] before two modules in rust-core/src/lib.rs
[17:22:29] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Client exited)
[17:22:30] <pauls> agrif: yes; I wrote `concat_idents!` before I realized it was useless without identifier-position macros
[17:22:45] *** Quits: ekiara (emk@moz-9B1940E9.tech.co.ke) (Ping timeout)
[17:22:50] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[17:22:51] *** Joins: ekiara (emk@moz-9B1940E9.tech.co.ke)
[17:23:01] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Ping timeout)
[17:23:04] *** Joins: squiddy (squiddy@moz-C306D4F8.adsl.alicedsl.de)
[17:23:11] <eddyb> jvns: err, core/mod.rs
[17:23:13] *** Quits: jaeman (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Ping timeout)
[17:23:16] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[17:23:35] <jvns> eddyb: where does the #[cfg(pthread)] need to go?
[17:23:39] <eddyb> jvns: before pub mod concurrent; and pub mod thread; - that will make them config-gated, so unless you add --cfg pthread, they won't be required
[17:23:48] * eddyb just had to look at his own modified file
[17:23:52] *** sam113101 is now known as sam113101_afk
[17:23:55] <jvns> oh neat
[17:23:58] *** Quits: dredozubov (dredozubov@D698DD84.5B945A24.CEFD53F7.IP) (Input/output error)
[17:24:09] <hoverbear> cmr: I have lingering concerns about using Docker for the prebuilt env... I think maybe a vagrant box might work best.
[17:24:16] <eddyb> again, strcat didn't want to do that himself. eh
[17:24:28] <sanxiyn> hoverbear: How do they differ?
[17:24:31] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Ping timeout)
[17:25:01] <jvns> how do I combine two #[cfg()]s?
[17:25:07] <eddyb> jvns: you don't need to
[17:25:10] <cmr> jvns: #[cfg(and(a, b))]
[17:25:16] *** sam113101_afk is now known as sam113101
[17:25:21] <hoverbear> sanxiyn: Docker is linux-only and is basically a souped up chroot that uses aufs.... Vagrant basically makes virtualbox images for you.
[17:25:21] <eddyb> jvns: wait, nvm, what cmr said
[17:25:23] <jvns> :)
[17:25:25] <sanxiyn> cmr: Does that actually work?
[17:25:27] <cmr> sanxiyn: yes
[17:25:27] <eddyb> jvns: I actually did it wrong here
[17:25:36] <eddyb> but what does cfg(a, b) do?
[17:25:39] <eddyb> I thought that was and
[17:25:46] <cmr> nothing
[17:25:47] <eddyb> while two different attributes was or
[17:26:17] <eddyb> jvns: as for the implementation, something like this should work (I think you can do it even in assembly): https://github.com/pcmattman/rustic/blob/master/src/rusty.c#L26
[17:26:35] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:26:48] *** Joins: mib_zosghv (Mibbit@moz-26059D6D.dynamic.qsc.de)
[17:26:56] <eddyb> jvns: sorry for not pushing strcat to make this proper >_>
[17:27:04] *** Quits: reyre (reyre@moz-89E9865B.com) (Quit: ZNC - http://znc.in)
[17:27:13] <jvns> we should make a pull request! :)
[17:27:23] <sanxiyn> cmr: Doesn't work for me
[17:27:29] <sanxiyn> cmr: cfg(a, b) does though
[17:27:31] <cmr> hm..
[17:27:35] <cmr> I wodner if that got changed
[17:27:46] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:27:48] <Luqman> carter: nope, always been like that :P
[17:27:49] <sanxiyn> As I recall it was always this way
[17:27:59] <jvns> hmm, cfg(and(a,b)) seems fine to me 
[17:28:04] <Luqman> there is not() though
[17:28:21] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[17:28:30] <sanxiyn> jvns: Is the thing actually configured in when you compile with --cfg a --cfg b?
[17:28:44] <jvns> I didn't test that
[17:28:55] <eddyb> wait, what I did worked
[17:28:56] <cmr> yeah they're right.
[17:29:02] *** Joins: reyre (reyre@moz-89E9865B.com)
[17:29:12] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[17:29:12] *** ChanServ sets mode: +ao brson brson
[17:29:15] <eddyb> jvns: there isn't any cfg on the two modules I named
[17:29:18] <sanxiyn> IIRC Luqman is the one who implemented this :)
[17:29:36] <jvns> eddyb: I see a cfg(libc) on them
[17:29:39] *** Quits: Ferreus (ferreus@moz-4FD9061F.dip0.t-ipconnect.de) (Ping timeout)
[17:29:50] <eddyb> jvns: which one?
[17:29:57] <jvns> on concurrent and thread
[17:30:02] <eddyb> strcat tends to push force :(
[17:30:02] *** sam113101 is now known as sam113101_afk
[17:30:10] <jvns> yeah cfg(a, b) works
[17:30:25] <eddyb> jvns: then that's what you should use, so --cfg libc won't pull them
[17:30:27] <sanxiyn> jvns: I think this probably should be fixed. :(
[17:30:31] *** sam113101_afk is now known as sam113101
[17:30:39] <jvns> sanxiyn: what should be fixed?
[17:30:52] <sanxiyn> Should be cfg(and(a, b))
[17:31:11] <sanxiyn> It isn't clear from cfg(a, b) whether it's and or or.
[17:31:30] <jvns> oh, yeah
[17:32:12] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[17:33:10] *** Joins: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP)
[17:33:34] *** Quits: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch) (Ping timeout)
[17:33:52] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Ping timeout)
[17:33:54] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:34:19] <jvns> eddyb: https://github.com/thestinger/rust-core/pull/30 
[17:35:06] <kzzch> i got an error during ./configure on the main branch
[17:35:11] <kzzch> Type int64_t required but not found
[17:35:25] <sanxiyn> Eh oh
[17:35:34] <eddyb> jvns: good luck! he told me he wouldn't that that yet :P
[17:35:35] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[17:35:40] <jvns> :)
[17:35:42] *** Quits: mib_zosghv (Mibbit@moz-26059D6D.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[17:35:54] <sanxiyn> kzzch: Paste full log somewhere?
[17:35:54] <jvns> maybe more votes will convince him
[17:36:06] <jvns> for now I'll just use my fork
[17:36:32] <eddyb> jvns: yeah, that's what I was planning on doing. right now I'm fiddling with a streaming PNG decoder :3
[17:36:34] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[17:37:30] <jvns> haha
[17:37:37] <jvns> ugh git submodules
[17:37:40] <jvns> how do they even
[17:38:22] <sanxiyn> eddyb: What is different for streaming?
[17:38:30] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:39:19] *** Quits: kzzch (kzzch@moz-991A24E8.hsd1.va.comcast.net) (Quit: brb)
[17:39:36] *** Joins: tcr (tcr@66796279.4683C875.9D2C3D3E.IP)
[17:39:47] *** Joins: smodo (tadnr@moz-6398EFDF.dclient.hispeed.ch)
[17:39:49] <eddyb> sanxiyn: you don't store the entire file in memory
[17:40:06] *** zz_kimundi is now known as kimundi
[17:41:41] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:41:46] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: carter)
[17:41:49] *** Quits: squiddy (squiddy@moz-C306D4F8.adsl.alicedsl.de) (Quit: Leaving)
[17:41:53] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[17:42:15] <jdm> jvns: that is the correct response to submodules
[17:42:24] <jdm> it is too bad that servo literally has 30 of them
[17:42:41] <jvns> ugh ugh they are the worst
[17:42:42] <jdm> or at least did at one point; I'm certain it's more than 20 still
[17:42:44] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:42:49] <jvns> 1 is too many
[17:43:27] <eddyb> sanxiyn: so what I have is a state machine that is updated when data comes in - you can feed it one byte at a time and it will still work
[17:44:05] <sanxiyn> eddyb: How does one get the decoded output?
[17:44:27] <eddyb> hah, now I want to have a test where you send an IDAT chunk for one pixel out of 16x16 and it ends up in the pixel array
[17:44:41] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[17:45:12] *** Quits: docbrown (docbrown@5CE9D448.F0B9EFB2.7F8758CE.IP) (Client exited)
[17:45:15] *** Joins: osa1__ (omer@moz-8FDAB45C.hsd1.il.comcast.net)
[17:45:16] <eddyb> sanxiyn: I'll have something like Option<Image> - once the header is parsed, you can actually get an usable image from there. it's initially fully transparent and it's filled as the data comes in
[17:45:18] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[17:46:12] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[17:46:50] <cmr> Hm, do any of the browsers have streaming PNG?
[17:47:20] <eddyb> I don't know - I think libpng supports some form of it, so they could use that
[17:47:37] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[17:47:56] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[17:48:12] <eddyb> cmr: I have to learn how to create benchmarks
[17:48:23] <cmr> https://github.com/mozilla/rust/wiki/Doc-unit-testing
[17:49:08] <eddyb> cmr: oooh, that's actually very nice
[17:49:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[17:49:32] <cmr> the bench harness starts giving up on statistical significance after 1ms though
[17:49:43] <cmr> it's not appropriate for everything
[17:49:55] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[17:50:18] *** Joins: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr)
[17:50:20] <eddyb> reminds me of jsperf, but it probably needs some work to get to that stage
[17:50:20] *** Parts: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr) ()
[17:51:08] <eddyb> (I think jsperf uses a library, which would be more appropriate to compare the bench harness to, but I can't remember what it's called)
[17:51:47] <cmr> http://benchmarkjs.com/ :p
[17:52:05] *** Quits: tcr (tcr@66796279.4683C875.9D2C3D3E.IP) (Client exited)
[17:52:30] *** Joins: tcr (tcr@66796279.4683C875.9D2C3D3E.IP)
[17:53:25] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:53:26] <sanxiyn> cmr: I think all browsers do progressive image loading
[17:53:35] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[17:53:36] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:54:11] *** Quits: tcr (tcr@66796279.4683C875.9D2C3D3E.IP) (Ping timeout)
[17:54:39] <eddyb> sanxiyn: oh, right, interlacing and whatnot actually work
[17:55:32] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:56:26] *** Quits: deLta30 (quassel@58B8874B.43774B36.F7B44A7.IP) (Connection reset by peer)
[17:57:31] *** Quits: w3lcome (Mibbit@EAD96774.6B9C41FA.6316A47C.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:57:58] *** Quits: sanxiyn (tinuviel@62C85FC9.1C19B322.6A273BE4.IP) (Quit: Bye)
[17:59:16] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[17:59:57] *** Joins: deLta30 (quassel@7B57E6A9.43FC6F29.E7E9D4A8.IP)
[18:01:10] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:02:05] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[18:02:15] *** Quits: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP) (Ping timeout)
[18:03:04] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[18:04:21] *** Joins: amro (quassel@CC16DC52.8AAAF769.FAAB0799.IP)
[18:05:04] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[18:05:12] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[18:06:23] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[18:06:26] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[18:06:56] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:07:11] *** Joins: AvianFlu_ (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[18:07:17] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[18:07:18] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (NickServ (GHOST command used by AvianFlu_))
[18:07:21] *** AvianFlu_ is now known as AvianFlu
[18:07:31] *** Quits: amro (quassel@CC16DC52.8AAAF769.FAAB0799.IP) (Ping timeout)
[18:08:37] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[18:09:01] <synackse> Wasn't there a "rusti" at some point?
[18:09:05] <cmr> yes.
[18:09:11] *** Joins: kzzch (kzzch@moz-991A24E8.hsd1.va.comcast.net)
[18:09:25] <Ms2ger> It wasn't maintained
[18:09:26] <kzzch> I think there's something wrong with my c libraries...
[18:09:30] <synackse> Ah
[18:09:31] *** Joins: Hildar (Mibbit@moz-7F4621B6.cable.virginm.net)
[18:09:33] *** Joins: kristof (kristof@moz-C03E0B57.lightspeed.frokca.sbcglobal.net)
[18:09:46] <synackse> Is the code still out there?
[18:09:46] <kzzch> rust configure stops with an error and rvm won't successfully build ruby
[18:10:04] <cmr> synackse: in the git history, yes.
[18:10:33] <pnkfelix> jvns: cmr: I don't think cfg(and(…))  exists.
[18:10:51] <pnkfelix> cmr: oh sorry, didn't catch up with backlog before typing
[18:11:00] <pnkfelix> cmr: jvns: this is documented on https://github.com/mozilla/rust/issues/2119
[18:12:23] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:12:44] <pnkfelix> You express things via sum-of-products, where multiple separate attributes are each or-clause (disjunction), and then multiple arguments within a cfg are and'ed together (conjunction).
[18:13:48] <Ms2ger> So a CNF?
[18:14:28] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[18:14:57] <pnkfelix> Ms2ger: no, that's AND of OR's, according to wikipedia
[18:15:08] <Ms2ger> DNF, then
[18:15:12] <Ms2ger> Oh
[18:15:21] <Ms2ger> Yeah, I thought that was what you were saying
[18:15:28] * Ms2ger needs to learn how to read
[18:15:37] <cmr> reading is hard
[18:15:40] <cmr> almost as hard as counting!
[18:15:58] <kzzch> https://drive.google.com/file/d/0B7p-awaKr-gPS0JSR1ZmSUNEQ2c/edit?usp=sharing
[18:16:02] <achin> 0, 1, infinity
[18:16:09] <kzzch> heres a link the the log file if anyone's interested
[18:16:21] * pnkfelix likes when terms encode their definitions.  Except for when he doesn't like it.
[18:16:26] <cmr> kzzch: what system are you on?
[18:16:30] <kzzch> ubuntu
[18:16:37] <cmr> do you have build-essential installed?
[18:17:15] <kzzch> yes
[18:17:34] <kzzch> i did apt-get update and upgrade as well as dist-upgrade then restarted and i'm still getting the error
[18:17:52] *** Quits: morphevs (Adium@moz-C5EAB99D.dclient.hispeed.ch) (Quit: Leaving.)
[18:18:03] <cmr> weird.
[18:18:11] <kzzch> but it's fishy that rvm can't build ruby and it's giving me a similar error about int types
[18:18:25] *** Joins: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP)
[18:18:27] <cmr> Did you accidentally nuke stdint.h?
[18:18:40] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[18:18:55] <kzzch> I don't think so
[18:19:15] *** Quits: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP) (Quit: Computer has gone to sleep.)
[18:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[18:19:29] <kzzch> Unless the initial update I did when I got to the library messed it up somehow
[18:19:41] <kzzch> not sure if i can check to see what was upgraded
[18:19:54] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[18:20:00] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: willingc)
[18:20:03] *** Joins: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr)
[18:20:05] *** Parts: mikezaby (mikezaby@moz-4BF6308B.home.otenet.gr) ()
[18:20:25] <kzzch> clearly something happened
[18:20:40] *** sam113101 is now known as sam113101_afk
[18:21:04] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[18:22:00] <jvns> What's the equivalent of sizeof(int) in Rust?
[18:22:03] *** Quits: deLta30 (quassel@7B57E6A9.43FC6F29.E7E9D4A8.IP) (Client exited)
[18:22:11] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:22:11] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:22:22] <eddyb> jvns: size_of::<int>()
[18:22:33] *** Joins: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP)
[18:22:35] <jvns> eddyb: thanks!
[18:22:35] <eddyb> jvns: from std::mem and I think core::mem
[18:23:27] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Ping timeout)
[18:23:47] <kzzch> seems to be something wrong with stdint.h and stdio.h
[18:24:34] *** Quits: lfox (lfox@moz-8C19C973.nyc.res.rr.com) (Quit: ZZZzzz…)
[18:25:15] *** Quits: kristof (kristof@moz-C03E0B57.lightspeed.frokca.sbcglobal.net) (Quit: WeeChat 0.4.2)
[18:25:23] <eddyb> kzzch: find the package they're in and then force reinstall that package, that should work
[18:25:34] <eddyb> you can also move them out of the way first
[18:26:46] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[18:29:13] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[18:31:41] *** Quits: GeneralMaximus (ankur@DDF2AAC0.BFE65AB8.1228A288.IP) (Quit: Computer has gone to sleep.)
[18:34:50] <jvns> size_of<uint>() gives me the error "error: unresolved name `uint`. Did you mean ..."
[18:35:01] <cmr> size_of::<uint>()
[18:35:53] <jvns> ah ha
[18:36:04] <jvns> this has happened before
[18:36:27] <sbalmos> it will happen again
[18:36:51] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[18:37:05] *** Joins: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP)
[18:38:34] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[18:39:13] *** Joins: lfox (lfox@moz-8C19C973.nyc.res.rr.com)
[18:39:56] *** Joins: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP)
[18:39:58] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Ping timeout)
[18:40:17] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:40:37] <jvns> oh sweet I got llvm to explode
[18:40:50] <jvns> http://sprunge.us/VWcD
[18:40:57] <cmr> yeah that can happen.
[18:41:09] <cmr> do you have / can you make a minimal testcase?
[18:41:09] <jvns> cmr: what does it mean?
[18:41:18] <jvns> yeah I might be able to make one
[18:41:18] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[18:41:19] <cmr> WHO KNOWS
[18:41:21] <cmr> erm
[18:41:22] <jvns> I'm trying to write a malloc
[18:41:22] <cmr> capslock
[18:41:27] <jvns> =)
[18:41:34] * jvns tries to compile it by itself
[18:41:42] <sbalmos> Stop fiddling with memory. :D
[18:41:44] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:43:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:43:28] <jvns> cmr: this is the broken code: http://sprunge.us/ZPbO
[18:43:46] <cmr> that's pleasantly small
[18:43:49] <cmr> now, open an issue :P
[18:43:58] <jvns> ,3
[18:44:00] <jvns> *<3
[18:44:42] *** Quits: myname (myname@F6BC1CBC.2C5F047.A0197E77.IP) (Ping timeout)
[18:45:04] <jvns> "LLVM code doesn't compile when trying to do pointer arithmetic"?
[18:45:25] <cmr> "LLVM assertion"
[18:45:40] <jvns> "LLVM assertion fails"?
[18:45:44] <cmr> no
[18:45:46] <cmr> well
[18:45:48] <cmr> sure, if you want.
[18:45:54] <cmr> Just "LLVM assertion" is fine
[18:46:44] <jvns> thanks
[18:47:54] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[18:48:57] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[18:50:07] <bstrie> rusti: struct S;impl std::ops::Shl<S,()>for S{fn shl(&self,_:&S)->(){()}}let(size_of,uint)=(S,S);    size_of<<uint>()
[18:50:08] -rusti- false
[18:50:27] <cmr> bstrie wai
[18:50:30] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[18:50:42] <bstrie> jvns: ^ add these definitions to your project to hide the size_of<uint>() error you were seeing before
[18:50:51] <eddyb> wat
[18:50:57] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[18:51:01] <bstrie> ...presuming that you remember to type << instead of <
[18:51:14] <bstrie> sadly rust doesn't let me overload the less-than operator :(
[18:51:15] <eddyb> Ord is typeist
[18:51:19] *** Joins: jmbto (jmbto@moz-FE174E29.fbx.proxad.net)
[18:51:22] <jvns> bstrie: <3
[18:51:36] <eddyb> discriminates against different types
[18:51:50] <eddyb> I'd rename it to Ood for that
[18:51:57] <jvns> cmr: made an issue! =D
[18:52:05] <bstrie> Ood == Orb of destruction
[18:52:24] <jvns> is there anything I could do to this code to make it more likely to compile without changing the compiler? https://github.com/mozilla/rust/issues/10883
[18:53:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:53:04] <eddyb> jvns: are you sure you need rust-core?
[18:53:14] <jvns> oh, I don't
[18:53:16] <jvns> good point
[18:53:41] <eddyb> jvns: rename that malloc function to foo and try to remove as much logic from it, as long as it still fails to compile
[18:53:56] <kzzch> bloody hell. how it's telling me i need gcc 3.0 or higher when i've got 4.8 installed
[18:54:35] *** Joins: myname (myname@F6BC1CBC.2C5F047.A0197E77.IP)
[18:55:00] <jvns> eddyb: if I remove rust-core, I get "error: requires `start` lang_item"
[18:55:10] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[18:55:46] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[18:55:49] <eddyb> jvns: and no_std
[18:55:53] <bstrie> kzzch: in numeric systems where the radix is an imaginary number, it's entirely possible for 4.8 to be less than 3.0
[18:56:22] <jvns> eddyb: if I remove no_std it compiles
[18:56:31] <bstrie> https://en.wikipedia.org/wiki/Quater-imaginary_base
[18:56:49] <eddyb> jvns: errrr
[18:57:14] *** Joins: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP)
[18:57:29] <eddyb> jvns: so it's rust-core + that code?
[18:57:37] <jvns> eddyb: seems like
[18:57:50] <eddyb> jvns: do you have gdb handy? you might be able to get a stack trace
[18:58:22] <jvns> a stack trace of LLVM?
[18:58:27] <eddyb> since it requires rust-core (and I think your personal clone, too)
[18:58:29] <eddyb> jvns: myeah
[18:58:33] <kzzch> how the hell do i tell it i have the correct version?
[18:58:39] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[18:58:51] <bstrie> kzzch: are you on windows?
[18:58:55] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:59:01] <cmr> kzzch: you can't tell it, it checks.
[18:59:27] <kzzch> bstrie:ubuntu
[18:59:34] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[18:59:55] <bstrie> kzzch: is it llvm that's failing to build?
[18:59:57] <kzzch> meh, there's something wrong with the 4.8 libs. rbenv won't build ruby either
[19:00:23] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[19:00:39] <kzzch> both of them failed on some sort of duplicate definition in stdint.h
[19:00:40] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:04:24] <jvns> I guess in the meantime I can use a malloc written in C :)
[19:04:43] <sbalmos> jvns: Don't cave in!
[19:04:46] <sbalmos> :D
[19:05:04] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:05:09] *** Quits: heftig (heftig@moz-8E8EC722.dip0.t-ipconnect.de) (Ping timeout)
[19:05:53] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[19:06:23] *** Quits: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP) (Ping timeout)
[19:06:59] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[19:07:50] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[19:08:20] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[19:08:45] <pcwalton> brson: https://github.com/mozilla/rust/commit/1755408d1a58684b6c9bce11aeceb18a1ec2d66e
[19:09:10] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[19:09:14] *** Joins: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il)
[19:11:15] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[19:12:57] <eddyb> pcwalton: oh wow that's a lot
[19:13:03] <pcwalton> yeah, it's hilarious
[19:13:05] <bstrie> pcwalton: were these all things caught by the dead-code elimination pass?
[19:13:08] <pcwalton> yeah
[19:13:10] <pcwalton> presumably
[19:13:33] <eddyb> jvns: the problem here is the function name
[19:13:40] <jvns> eddyb: yeah, I just realized
[19:13:47] <sbalmos> wow
[19:13:54] <eddyb> jvns: it's normally renamed to malloc1
[19:13:59] <jvns> hahahaha
[19:14:03] <eddyb> (so it doesn't work anyway)
[19:14:03] <jvns> what.
[19:14:13] <eddyb> jvns: because rust-core imports a function with the same name
[19:14:20] <jvns> interesting
[19:14:31] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[19:14:41] <eddyb> jvns: oh, I know, it's obvious now
[19:15:14] <eddyb> jvns: try to use the same function signature as rust-core's core::heap::malloc (the one imported from C)
[19:15:15] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[19:15:15] *** ChanServ sets mode: +ao dherman dherman
[19:18:15] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[19:18:41] <jvns> hmm I still get the same error
[19:19:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[19:19:28] *** Joins: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP)
[19:20:08] *** Quits: jmbto (jmbto@moz-FE174E29.fbx.proxad.net) (Client exited)
[19:20:13] *** Joins: slimer (Mibbit@moz-23C212B0.dynamic.qsc.de)
[19:20:50] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[19:21:09] <slimer> Is it possible to declare an "extern "C"" function ussafe?  extern "C" fn cb(...) { ... }
[19:21:18] <slimer> *unsafe
[19:21:32] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[19:21:44] <eddyb> slimer: not yet. it's a bug
[19:21:50] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[19:21:56] <slimer> eddyb: thanks
[19:22:16] <bstrie> eddyb: I thought all extern C functions were unsafe
[19:22:34] <cmr> that's just extern { ... } I thought
[19:22:35] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[19:22:38] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[19:22:47] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[19:24:08] <slimer> Let's say I want to give a callback to an external C function. This callback has to have "C" calling convention. Can I give a closure "C" calling convention?
[19:24:39] <jvns> hmm making the malloc type match doesn't seem to help: http://sprunge.us/GeOZ
[19:24:40] <cmr> no
[19:24:45] <cmr> closures are entirely different beasts.
[19:24:48] <eddyb> slimer: a closure has a different repr than a simple function pointer, so no way that would work
[19:25:17] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[19:26:01] *** jorendorff_away is now known as jorendorff
[19:26:26] *** jorendorff is now known as jorendorff_away
[19:26:49] <jvns> eddyb: do you know if it's possible to implement malloc in rust?
[19:26:55] *** Joins: mib_3slj4u (Mibbit@moz-FF13B583.rev.numericable.fr)
[19:27:00] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[19:27:01] *** Quits: mib_3slj4u (Mibbit@moz-FF13B583.rev.numericable.fr) (Quit: mib_3slj4u)
[19:27:09] <kzzch> i don't see why you wouldn't be able to
[19:27:12] <pcwalton> acrichto: replied to https://github.com/pcwalton/rust/commit/18801c31bcfc1204dc8ca3481c83a66f06d1795a#src-libstd-rt-rtio-rs-P28
[19:27:13] *** Joins: morton (Mibbit@moz-FF13B583.rev.numericable.fr)
[19:27:27] <jvns> I guess I could call it `malloc1` and then call it from a C function called `malloc`. 
[19:27:44] *** Joins: jhasse (jhasse@moz-69BF8F0F.ewe-ip-backbone.de)
[19:27:54] <eddyb> jvns: it would work. so hacky
[19:27:57] <kzzch> i imagine you'd have to reimplement it if you were trying to write an os from scratch in rust without the gc
[19:28:11] <jvns> kzzch: yes, that's what I'm doing
[19:28:29] *** jorendorff_away is now known as jorendorff
[19:28:42] *** Quits: morton (Mibbit@moz-FF13B583.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[19:29:05] <kzzch> there's a rust channel specifically for osdev isn't there?
[19:29:05] <acrichto> pcwalton: replied back, but I basically think that 'static is a bit too limiting, I don't think it's quite safe and we may as well attempt to keep some things safe in the runtime
[19:29:11] <cmr> #rust-osdev, yes.
[19:29:12] <jvns> kzzch: the problem is that I can't figure out how to define a function called "malloc" in Rust without it crashing
[19:29:19] <pcwalton> acrichto: I had severe borrow check problems when I tried 'a
[19:29:23] <pcwalton> that was what I first tried
[19:29:30] *** Quits: alonlevy (alon@moz-D8EFCED8.bb.netvision.net.il) (Ping timeout)
[19:29:51] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:29:55] <slimer> What's the difference between &extern "C" fn() and extern "C" fn() ?
[19:30:18] <cmr> slimer: one is a pointer to a function pointer, one is a function pointer.
[19:30:20] <pcwalton> acrichto: &'mut will borrow the entire EventLoop, is the problem
[19:30:45] <rfw> [C/wc
[19:30:51] <rfw> er sorry, wrong window
[19:30:58] <pcwalton> I think we maybe need not &'a mut but rather just &'a?
[19:31:24] <slimer> cmr: But &fn() is just a function pointer, right?
[19:31:41] <cmr> slimer: &fn() doesn't exist right now
[19:31:45] <cmr> but no, fn() is a function pointer
[19:31:50] <cmr> &fn() was previously a closure
[19:31:54] <cmr> it's now known as ||
[19:31:57] <pcwalton> I can try to do it again
[19:32:22] <jhasse> hi! I'm trying to install sax wrapper using "rustpkg install github.com/bjz/sax-rs", but rustpkg tells me "supplied path for package dir does not exist, and couldn't interpret it as a URL fragment". Is there something missing in the repository or am I doing something else wrong?
[19:32:31] <cmr> jgraham: rustpkg bug
[19:34:26] *** Quits: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP) (Quit: WeeChat 0.4.3-dev)
[19:34:44] <slimer> cmr: I'm still using 0.8. If fn() gives me an error (obsolete syntax). What's the syntax for function pointer in 0.8?
[19:34:50] *** Joins: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net)
[19:34:55] <cmr> slimer: extern "Rust" fn()
[19:36:01] <jhasse> cmr: okay thx
[19:38:47] <slimer> As far as I can see I can pass functions as closue arguments but not the other way around. When should I use function pointer arguments instead of closue arguments?
[19:39:23] <cmr> slimer: when you don't want the environment, for calling convention reasons.
[19:40:11] *** Quits: oberstet (quassel@moz-E001390B.dynamic.mnet-online.de) (Client exited)
[19:40:41] <acrichto> pcwalton: hmm, how does &'a mut IoFactory fail?
[19:40:43] <kzzch> :/
[19:40:44] <slimer> what do you mean by environment? Is calling functions which were passed as closure arguments more expensive?
[19:40:55] <cmr> No, not at all.
[19:40:57] <kzzch> now my compiler can't create executables :/
[19:41:03] <acrichto> pcwalton: or rather Option<&'a mut IoFactory>
[19:41:06] <cmr> kzzch: it sounds like your system is slowly exploding.
[19:41:15] <pcwalton> acrichto: I am going to try again and see why it fails
[19:41:16] <pcwalton> I forget
[19:41:24] <kzzch> well, i just reinstalled build-essentials, llvm, and clang
[19:41:41] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[19:41:44] <cmr> slimer: closures have an implicit argument which is to the environment they capture, so stuff like:
[19:42:02] <cmr> rusti: let x = 52; let y = || { x + 32 }; y()
[19:42:03] -rusti- 84
[19:42:04] <cmr> works
[19:42:17] <kzzch> i was looking forward to getting stuff accomplished today but i've wasted at least two hours fighting my tools :/
[19:42:50] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[19:42:51] *** Joins: jmbto (jmbto@moz-FE174E29.fbx.proxad.net)
[19:42:55] <Ms2ger> That's not a nice thing to call us :(
[19:43:10] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Quit: WeeChat 0.4.3-dev)
[19:43:57] <slimer> cmr: Ok, but what reason do I have not to allow that if there is no performance penalty for function pointer arguments?
[19:44:07] <cmr> slimer: different ABI
[19:44:09] *** Joins: Earnestly (earnest@88884C6.A3735F9C.39C00A7A.IP)
[19:44:28] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[19:44:47] <slimer> cmr: So I only have to restrict myself to function pointers if I want a different ABI?
[19:45:02] <jmbto> hi
[19:45:04] <cmr> well, really only when interacting with C
[19:45:13] <slimer> cmr: got it, thanks
[19:45:19] <cmr> extern "C", not extern "Rust"
[19:45:37] <jmbto> http://static.rust-lang.org/doc/0.8/std/rt/io/file/fn.open.html > is there like, a easy way to create and write to a text file in rust 0.8?
[19:45:54] <cmr> jmbto: https://github.com/cmr/rust-examples/blob/master/file.rs
[19:46:28] <jmbto> oh neat
[19:46:30] <Hildar> Hmm, seem that "use Somename::Somename" doesn't work (because the class would shadow the module name), but it doesn't cause a warning.
[19:46:41] <Hildar> s/class/struct
[19:47:08] <jmbto> cmr, any chances that snippet will change by 0.9/1.0/who knows?
[19:47:17] <cmr> jmbto: yes, it already is changed.
[19:47:26] <jmbto> hum ok
[19:47:29] <jmbto> thank you
[19:47:33] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[19:47:45] *** Quits: jhasse (jhasse@moz-69BF8F0F.ewe-ip-backbone.de) (Quit: Verlassend)
[19:48:04] <kzzch> holy hell
[19:48:07] <kzzch> i fixed it
[19:48:56] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Quit: WeeChat 0.4.3-dev)
[19:48:56] <kzzch> it was bad symlinks
[19:49:10] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[19:49:38] <slimer> Is it possible to put the return value of a function call on the stack without having to declare a temporary variable? This gives me a lifetime error: match CString::new(p, false).as_str() { ...
[19:49:53] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[19:50:34] <pnkfelix> slimer: i think we're still working out what set of rules to use for that
[19:51:03] <pnkfelix> slimer: see e.g. https://github.com/mozilla/rust/issues/3511
[19:51:22] *** Quits: lfox (lfox@moz-8C19C973.nyc.res.rr.com) (Ping timeout)
[19:51:55] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[19:53:31] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[19:54:04] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[19:55:02] *** Joins: heftig (heftig@moz-59A46850.dip0.t-ipconnect.de)
[19:55:08] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:55:47] <kzzch> w00t! compiling ALL THE THINGS!
[19:56:11] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[19:57:05] *** Quits: slimer (Mibbit@moz-23C212B0.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[19:57:27] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[20:00:34] *** Quits: sellout (sellout-@moz-AE26682A.hlrn.qwest.net) (Quit: Leaving.)
[20:04:32] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[20:06:44] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[20:09:03] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[20:11:44] *** Quits: jack (jack@moz-DF5A9AA3.members.linode.com) (Quit: leaving)
[20:11:55] <bstrie> so in september chrome introduced a bug that broke our company's internal business web application
[20:12:06] <bstrie> the bosses finally coerced me into browser-sniffing to fix it
[20:12:11] <bstrie> spent a day implementing the fix
[20:12:22] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:12:23] <bstrie> and turns out chrome fixed the bug two days ago
[20:12:36] <bstrie> as a result, this is the smallest bugfix ever
[20:13:08] <cmr> lol
[20:13:20] <sbalmos> heh
[20:13:20] <bstrie> I'm tempted to walk into my boss' office and just say "the fix is in live" and then when I see the astonished look on his face, have a cow-orker release some doves behind me
[20:13:34] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[20:13:35] <bstrie> and make like, magic hand gestures
[20:13:38] *** jack_ is now known as jack
[20:13:41] <sbalmos> bstrie: Do it. Boss need be none the wiser.
[20:13:49] <sbalmos> bstrie: Might lead to a bonus. :D
[20:13:55] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[20:15:15] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[20:15:32] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[20:15:48] <Hildar> Messing about with visibility of things again, https://gist.github.com/xv8m4g3r/38a78446c9790e2aa637 there is no warning if a 'use' fails because the name already exists. I could understand if this was from a glob, but not when I ask for it by name.
[20:15:58] <bstrie> sbalmos: nah they would probably think I hacked the system or something
[20:16:10] *** Joins: MOeltjenbruns (goofy@moz-D9C12442.hsd1.mn.comcast.net)
[20:16:27] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:16:28] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[20:16:30] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:16:42] <bstrie> my company is voluntarily sox-compliant, so they would probably not be too pleased at the idea of a programmer installing code into a production environment
[20:16:50] <bstrie> btw, sox sux
[20:17:13] <Ms2ger> Red?
[20:17:16] <sbalmos> but they keep your feet and servers warm
[20:17:35] <bstrie> Hildar: that doesn't sound right
[20:17:37] <Ms2ger> Compiling rust already does that
[20:18:17] *** Joins: vishrut (Mibbit@457345D9.5B8BE43D.BE4CF869.IP)
[20:19:09] <Hildar> bstrie: I thought it sounded wonky. I presume that it is "working as intended", but it could do with a lint warning.
[20:19:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[20:20:21] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Client exited)
[20:20:51] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[20:20:59] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[20:21:01] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:21:11] <bstrie> Hildar: I have never been able to understand our module shadowing rules, especially in the presence of modules and submodules that have the same name
[20:21:25] <bstrie> maybe we should just forbid a submodule from having the same name as any of its parents :)
[20:21:36] <bstrie> Hildar: can you file a bug?
[20:22:31] *** Quits: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP) (Ping timeout)
[20:22:41] <Hildar> bstrie: I sure can.
[20:22:47] <bstrie> thanks!
[20:25:33] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[20:25:33] *** ChanServ sets mode: +o tjc
[20:28:40] *** Quits: t25 (manu@moz-5D020DB4.otago.ac.nz) (Ping timeout)
[20:29:34] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[20:31:14] *** Joins: t25 (manu@moz-5D020DB4.otago.ac.nz)
[20:32:14] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[20:33:04] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[20:35:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:35:38] <geomyidae__> btw, what's the fix for from_str reading to the end of the buffer for Json? Should it count { and } and then stop when it knows to stop? Should I modify my protocol so that I send the length and then read that into a buffer and from_json that?
[20:39:50] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:40:19] *** Joins: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch)
[20:42:04] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[20:43:40] <o11c> geomyidae__: hm?
[20:43:46] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[20:43:55] <sfackler> geomyidae__: I've hacked around it like this: https://github.com/sfackler/rust-postgres/blob/master/types/mod.rs#L349
[20:44:21] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[20:45:36] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Quit: Viivan loppu.)
[20:45:50] *** Joins: IRCMonkey32650 (sellout-@moz-94C19942.hsd1.co.comcast.net)
[20:46:06] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[20:46:57] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:47:06] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[20:47:06] *** ChanServ sets mode: +ao dherman dherman
[20:47:20] *** IRCMonkey32650 is now known as sellout
[20:47:30] *** Joins: fenster (Mibbit@7D23FB12.C51ECAA6.1F734B95.IP)
[20:47:41] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:48:40] *** Quits: fenster (Mibbit@7D23FB12.C51ECAA6.1F734B95.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:49:04] <hoverbear> bstrie: What's sox?
[20:52:17] *** Quits: vishrut (Mibbit@457345D9.5B8BE43D.BE4CF869.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:52:47] <jeaye> hoverbear: Sound eXchange?
[20:53:04] <hoverbear> jeaye: I think you're pulling my leg
[20:53:18] <jeaye> YANK
[20:53:32] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[20:53:32] <jeaye> https://en.wikipedia.org/wiki/SoX
[20:53:35] *** Joins: sam (sam@7711C295.C8C6FF5E.4065847B.IP)
[20:54:07] <hoverbear> jeaye: Ok, but I don't think that's what he was talking about. :)
[20:54:17] <jeaye> Yeah, yeah. Probably not.
[20:54:51] <hoverbear> Bah, I feel like I wasted my weekend on Docker instead of Rust
[20:55:12] <jeaye> Aren't those shoes, Dockers?
[20:55:12] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[20:55:23] <hoverbear> jeaye: It's also a fancy word for LXC containers
[20:55:55] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[20:57:34] <sam> time to update to newest master.. fingers crossed..
[20:58:17] <nathan7> hoverbear: Linux Containers containers!
[20:58:39] <hoverbear> nathan7: Now you're really pulling my leg
[20:58:56] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[21:00:46] <hoverbear> Maybe I'll just use http://www.packer.io/ and build an image.
[21:01:08] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[21:02:35] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:04:10] *** Joins: rca_ (rcatolino@7F54AB21.28091F66.520D6FA6.IP)
[21:04:22] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[21:04:32] *** Joins: alan_ (alan@32702EE8.939109B2.FB082A98.IP)
[21:04:37] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[21:04:37] *** alan_ is now known as alan
[21:05:34] *** Quits: rca (rcatolino@moz-E7ABCBEC.adsl.proxad.net) (Ping timeout)
[21:05:36] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:06:46] <ezyang> oh hey, Rust got a dead code check 
[21:07:10] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:07:12] <ezyang> How do I turn it off? 
[21:07:22] <pcwalton> ezyang: #[allow(dead_code)] iirc
[21:07:34] *** Quits: synackse (synackse__@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[21:07:41] <ezyang> coolio 
[21:10:38] <acrichto> sfackler: btw tools like that I want to add to something like an io::util module
[21:11:09] <sfackler> the limitedreader thing?
[21:11:12] <acrichto> things like a /dev/null sink, a /dev/zero reader, a limit reader, a tee reader, a duplication thing
[21:11:15] <acrichto> but yeah
[21:11:23] <acrichto> that's a useful type to have on hand
[21:11:23] <sfackler> I was thinking of pulling it in, yeah
[21:12:12] <sfackler> I always feel a bit bad about making a thing called "util" though
[21:12:22] <acrichto> yeah :(
[21:12:24] <sfackler> since it usually stands for "I can't think of where to put these" :P
[21:12:34] <acrichto> io::tools
[21:12:38] <acrichto> (don't do that)
[21:12:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:12:45] <sfackler> haha
[21:14:16] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[21:14:23] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:16:53] *** Quits: Ms2ger (Ms2ger@moz-7C292AC.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:17:52] <bstrie> more util noooooo
[21:17:59] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[21:18:47] *** Joins: arpd (ben@moz-D42157B0.cable.virginm.net)
[21:18:47] <Hildar> std::io::util::utils?
[21:18:48] <jeaye> Then if those have commonalities, we can make an io::util::util
[21:18:59] <Hildar> Oh wow, great minds think alike.
[21:19:01] <bstrie> std::util::io::util::util::utils
[21:19:22] <tautologico> std::str::from_utf8 now changes the vector in place, but how can I return a ~str to the string? use transmute?
[21:19:26] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[21:19:39] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[21:20:05] <sfackler> from_utf8_owned(buf.to_owned()) ?
[21:20:07] <arpd> Is it possible to use the match construct with a `str`?
[21:20:20] <tautologico> sfackler: thanks
[21:20:24] <ChrisMorgan> arpd: yes, it is, but it may not be what you want.
[21:20:28] <acrichto> rusti: match "foo" { "foo" => println!("yay"), _ => println!("oh no!") }
[21:20:28] -rusti- yay
[21:20:29] -rusti- ()
[21:20:31] <acrichto> arpd: ^
[21:20:34] <acrichto> like that?
[21:20:43] <ChrisMorgan> arpd: if you've got a ~str, match on x.as_slice().
[21:20:53] <ezyang> So, I'm trying to do "Some(~ref mut bd) => go(&mut bd.link.p)" where the thing I'm matching over is a Option<~T>, but Rust "cannot borrow immutable dereference of ~ pointer as mutable". So what's the correct way to spell this? 
[21:21:04] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[21:21:30] <ezyang> if I drop the twiddle in the match I get "cannot borrow immutable anonymous field as mutable" 
[21:22:07] <ChrisMorgan> arpd: as for why you need the .as_slice() to match against a ~str, the branches would otherwise need to be ~str (e.g. ~"foo"), which is a pointless allocation.
[21:22:14] <ChrisMorgan> rusti: match ~"foo" { "foo" => println("yay"), _ => println("oh no!") }
[21:22:15] -rusti- <anon>:9:23: 9:31 error: mismatched types: expected `~str` but found `&'static str` (str storage differs: expected ~ but found &'static )
[21:22:15] -rusti- <anon>:9         match ~"foo" { "foo" => println("yay"), _ => println("oh no!") }
[21:22:15] -rusti-                                 ^~~~~~~~
[21:22:15] -rusti- error: aborting due to previous error
[21:22:16] -rusti- application terminated with error code 101
[21:22:21] <ChrisMorgan> rusti: match (~"foo").as_slice() { "foo" => println("yay"), _ => println("oh no!") }
[21:22:22] -rusti- yay
[21:22:22] -rusti- ()
[21:22:26] *** Joins: lenstr (lenstr@11335774.9636F313.7A27613B.IP)
[21:22:28] *** Quits: Blei (philipp@moz-B2F9E4BD.cust.bluewin.ch) (Quit: WeeChat 0.4.2)
[21:22:50] <arpd> That makes sense, thanks for the clarification ChrisMorgan,
[21:23:19] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[21:23:28] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:25:07] *** Joins: jviereck (Adium@moz-CAFF94BC.dip0.t-ipconnect.de)
[21:25:10] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[21:25:28] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[21:25:52] <sfackler> ChrisMorgan: I don't think that's an allocation, it's just a match pattern
[21:26:07] <sfackler> or it at least shouldn't be an allcoation
[21:26:48] *** sam113101_afk is now known as sam113101
[21:26:49] *** Quits: jviereck (Adium@moz-CAFF94BC.dip0.t-ipconnect.de) (Ping timeout)
[21:26:51] <g3xzh> hi guys - how can rustc add symbols for debugging from gdb?
[21:26:55] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[21:27:05] <sfackler> g3xzh: compile with -Z extra-debug-info
[21:27:28] <g3xzh> sfackler: like rustc -Z extra-debug-info my_code.rs?
[21:27:36] <strcat> yes
[21:27:36] <acrichto> pcwalton: I couldn't LTO all of rustc, it hit an llvm assertion :(
[21:27:59] <g3xzh> okay - 10x guys
[21:28:07] *** Quits: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net) (Ping timeout)
[21:28:11] <strcat> acrichto: not surprising, could be because we have an extern block using different types
[21:28:37] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[21:28:38] <acrichto> strcat: no, this is for all of rustc, this is unrelated to that bug
[21:28:47] <acrichto> Instruction does not dominate all uses
[21:28:51] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[21:29:03] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[21:29:04] <acrichto> I ran into this awhile ago and upgrading LLVM ended up just fixing it
[21:29:49] <strcat> it's a bug you can get from generating invalid IR
[21:30:22] <strcat> I think it just means that a register is used without it being guaranteed that all paths define that register
[21:30:23] <acrichto> weird, b/c they're all independently valid, but merging them all causes the bug
[21:30:29] *** Quits: jackneill (jackneill@moz-1EE14E.pool.digikabel.hu) (Ping timeout)
[21:31:00] <acrichto> there's some defnition in SSA that I never quite grasped, it may have been domination but I forget which one it is
[21:31:11] *** Joins: bjustin (bjustin@moz-8FC28563.sierrabravo.net)
[21:31:18] <acrichto> immediate dominator, that's the one that I never fully grasped
[21:31:48] <g3xzh> gdb doesn't catch the breakpoint i have asked for
[21:31:53] <jdm> http://mozillamemes.tumblr.com/post/29632512055/want-to-write-code-in-rust-youd-better-develop
[21:31:57] <g3xzh> b stats.rs:151
[21:32:04] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[21:32:04] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Client exited)
[21:32:06] <jdm> wow, was it only a year ago that we did the big shift to no static strings?
[21:32:26] <g3xzh> is there anything at the manual about debuging rs code from gdb?
[21:32:34] <jdm> g3xzh: no
[21:32:44] <acrichto> g3xzh: what platform are you on?
[21:32:48] <jdm> it requires experimentation and asking questions, since it's still fairly new
[21:32:50] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:32:54] <g3xzh> linux x86-64
[21:33:06] <jdm> g3xzh: did gdb report that it set the breakpoint correctly?
[21:33:07] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:33:10] <acrichto> interesting, it should work well on linux
[21:33:16] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Quit: Leaving)
[21:33:43] <g3xzh> jdm: (gdb) b stat.rs :151
[21:33:43] <g3xzh> `��
[21:33:43] <g3xzh> Make breakpoint pending on future shared library load? (y or [n]) y
[21:34:09] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[21:34:16] <g3xzh> (gdb) info breakpoints 
[21:34:16] <g3xzh> Num     Type           Disp Enb Address    What
[21:34:16] <g3xzh> 1       breakpoint     keep y   <PENDING>  stat.rs :151
[21:34:29] <jdm> g3xzh: did you see a line about the pending breakpoint being resolved later on after you started running the program?
[21:34:39] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:34:55] <g3xzh> jdm: hmm... i guess no
[21:35:32] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[21:35:46] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[21:36:21] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[21:37:09] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[21:38:23] *** Quits: fabiand (fabiand@moz-60ACEF09.adsl.alicedsl.de) (Quit: Verlassend)
[21:38:45] <ChrisMorgan> sfackler: you don't think `match ~"foo" { ~"bar" => (), _ => () }` will allocate the ~"bar"? I'd need to check up on that, but I would at least start with the assumption that it will.
[21:39:58] <sfackler> ChrisMorgan: I mean, you can do things like "match foo { SomeEnum { bar: ~"bar", .. } => {} }" but I don't think that it creates a SomeEnum
[21:40:03] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[21:40:30] <sfackler> also, if you try to do "match foo { @"foo" => {} }" you get a compile error saying that you can't allocate a vector in a constant expression
[21:40:35] <hoverbear> This looks awesome: http://www.cs.indiana.edu/~eholk/papers/hips2013.pdf Totally gonna play around.
[21:41:21] <ezyang> Under what circumstances can you take a mutable borrowed reference to a ~T pointer? 
[21:41:44] <bstrie> ezyang: when its owner is mutable, I think
[21:41:58] <ezyang> OK, how about a reference to a field of T in ~T? 
[21:42:15] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[21:42:56] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[21:43:00] *** Quits: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[21:43:18] <bstrie> ezyang: I believe you can't immutably reference something if it is already mutably referenced somewhere in scope
[21:44:10] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[21:45:48] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:46:37] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:47:02] <kmc> hi ezyang!
[21:47:06] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[21:47:10] <ezyang> kmc: hallo 
[21:47:22] <ezyang> The borrow checker is kicking my ass ^_^ 
[21:47:25] <kmc> yeah, if a mutable reference exists then it's the only reference to that thing
[21:48:22] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[21:48:25] <hoverbear> ezyang: Remember that it is trying to catch bugs that would otherwise kick you in the ass later in other languages :)
[21:48:38] <ezyang> Hm. I knew that on an intellectual level, but I don't know how to apply it here. 
[21:49:11] <kmc> and yeah, mutability is inherited through ownership
[21:49:30] <kmc> so the contents of an ~-box are mutable if the ~T is stored in a "let mut", an @mut, or other mutable ownership roots
[21:49:53] <ezyang> (What I'm really trying to do: delete an item matching some predicate off of mutable linked list) 
[21:50:09] <ezyang> Hmm. So is there a way to induce a pattern match to put it in a mutable ownership root? 
[21:50:13] <ezyang> I guess that's what ref mut is for 
[21:50:30] <kmc> you can use "ref mut" in patterns
[21:50:37] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[21:50:38] <kmc> match foo { Some(ref mut x) => ... }
[21:50:46] <ezyang> OK, but when I do that I get "cannot borrow immutable anonymous field as mutable" 
[21:50:51] *** Quits: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP) (Ping timeout)
[21:50:53] <kmc> can you pastebin your code?
[21:51:03] <ezyang> hang on, figured it out! 
[21:51:04] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[21:52:04] <ezyang> Aha. I kept thinking of 'let mut' as "give me some mutable location on the stack" 
[21:52:27] <kmc> well, it is that
[21:52:56] <ezyang> Well, it also is a mutable root, which is the important other point 
[21:52:59] <kmc> but the mutability also transfers to owned boxes, transitively
[21:53:00] <kmc> right
[21:53:49] <kmc> instead of thinking of ~T as a pointer you can think of it as a T by value, which is magically shrunk down to word size, and also allows recursive data structures
[21:54:14] <kmc> as strcat points out, we aren't semantically required to allocate boxes in the case where T is already word size
[21:56:40] *** Quits: victorporof (victorporo@C8C495F5.E3195F0D.9B1E38F4.IP) (Quit: victorporof)
[21:57:27] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Quit: )
[21:58:02] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[22:01:57] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[22:02:06] <o11c> kmc: what about the raw address, though?
[22:02:34] <kimundi> o11c: what about it?
[22:03:04] <kmc> you mean like  let x = ~3; borrow::to_uint(&x) ?
[22:04:02] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[22:04:10] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[22:04:43] <o11c> er, that would be &~int, I'm just talking about ~int as *int
[22:04:59] <kimundi> that... should be disencouraged anyway :P
[22:05:12] <kimundi> Is that even legal today?
[22:05:21] *** Quits: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net) (Quit: Leaving)
[22:05:32] <kimundi> rusti: &5u as *int
[22:05:33] -rusti- <anon>:9:8: 9:11 error: mismatched types: expected `*int` but found `&uint` (expected int but found uint)
[22:05:33] -rusti- <anon>:9         &5u as *int
[22:05:33] -rusti-                  ^~~
[22:05:33] -rusti- error: aborting due to previous error
[22:05:33] -rusti- application terminated with error code 101
[22:05:43] <kimundi> rusti: &5u as *uint
[22:05:44] -rusti- (0x7fd024626100 as *())
[22:05:49] <kimundi> rusti: ~5u as *uint
[22:05:50] -rusti- <anon>:9:8: 9:20 error: non-scalar cast: `~uint` as `*uint`
[22:05:50] -rusti- <anon>:9         ~5u as *uint
[22:05:50] -rusti-                  ^~~~~~~~~~~~
[22:05:50] -rusti- error: aborting due to previous error
[22:05:50] -rusti- application terminated with error code 101
[22:05:58] *** Quits: g3xzh (g3xzh@moz-67055F60.red.bezeqint.net) (Ping timeout)
[22:06:13] <kimundi> Seems like no
[22:06:16] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:07:12] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[22:07:14] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[22:07:30] <kmc> anyway I don't think there's much guarantee about those raw pointers
[22:07:47] <kmc> if ~int has the same repr as int then the &~int and the &int will have the same numerical value
[22:07:50] <kmc> shrug
[22:08:04] <o11c> so how *do* you pass a pointer to some C code that wants to keep it around for a while?
[22:09:00] <kmc> do you want to transfer ownership into C code?
[22:09:12] <geomyidae__> sfackler: I'm not 100% sure what I'm looking at here to be honest, although it looks potentially useful? Re: json/limitedreader
[22:10:18] <sfackler> geomyidae__: it may not work for you, but my use case was that I have a Reader, and I know that the next X bytes of it are going to be a Json stream
[22:10:21] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[22:10:34] <sfackler> but the json from_reader function seems to run past the end of the json object its parsin
[22:10:40] <o11c> kmc: no
[22:10:45] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:10:52] <sfackler> so I wrote that wrapper to make a new reader that's restricted to the number of bytes I'm expecting it to use
[22:11:03] <kmc> o11c: then you have the problem of making sure it stays alive on the Rust side
[22:11:06] <o11c> kmc: ownership is still in Rust and the drop() will clear out the reference in C
[22:11:11] <kmc> there are different techniques for that
[22:11:12] <kmc> ah
[22:11:33] <kmc> (is this question still about hypothetical representation for ~int, or more generally?)
[22:11:49] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[22:12:11] <tiffany> how much does the representation of ~ differ based on the type it's used for?
[22:12:17] <tiffany> is it just a * for sized types?
[22:12:18] <kmc> anyway there's http://static.rust-lang.org/doc/master/std/ptr/fn.to_unsafe_ptr.html and also plain old cast::transmute
[22:12:29] <o11c> (representation of ~int ... I'm not yet to the point of actually writing rust code)
[22:12:48] <kmc> tiffany: well for one thing ~str and ~[T] are different creatures from ~T, because str and [T] aren't types on their own
[22:13:02] <kmc> also I believe that the representation of ~T depends on whether T transitively contains any @-boxes
[22:13:13] <kmc> if it does, the ~T is linked into a task-wide list of things to be freed at shutdown
[22:13:16] <kmc> I could be wrong about this
[22:13:26] *** Quits: refold (gman@moz-42D68426.a258.priv.bahnhof.se) (Quit: leaving)
[22:13:50] <kmc> (that affects the representation of the box, and maybe where the pointer points to, but the ~T value itself is still just a single pointer iirc)
[22:14:02] <kmc> and ~Trait is two pointers, vtable and object
[22:14:39] <heftig> kmc: why would the task-wide list be needed?
[22:15:24] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Client exited)
[22:15:29] *** Quits: jmbto (jmbto@moz-FE174E29.fbx.proxad.net) (Quit: Leaving)
[22:15:45] *** Joins: tcr (tcr@moz-1A21C25B.olin.edu)
[22:17:25] *** Quits: tcr (tcr@moz-1A21C25B.olin.edu) (Ping timeout)
[22:17:56] <arpd> is there some way to get the vector from the range(n,nn) function?
[22:18:19] <strcat> heftig: to deal with cycles of @
[22:18:26] *** Joins: moostik (Icedove@moz-698B575F.w86-212.abo.wanadoo.fr)
[22:18:32] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[22:19:15] <kimundi> arpd: sure
[22:19:16] <sfackler> arpd: range(n,m).to_owned_vector()
[22:19:24] <arpd> thank you sfackler
[22:19:25] <sfackler> or range(n,m).collect() more generally
[22:20:03] <ezyang> Rust can't capture dynamic environment in fn? Laaame 
[22:20:21] *** Quits: TisButMe (Mibbit@moz-40463609.w80-9.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[22:20:21] <strcat> ezyang: rust has closures
[22:20:21] <kimundi> ezyang: hm?
[22:20:37] <strcat> ezyang: a function is just code, no environment, a closure is both
[22:21:31] <ezyang> Shouldn't Rust be able to do something clever for immutable variables? 
[22:21:43] <sfackler> clever in what way
[22:22:07] <kimundi> A immutable variable is not the same as a compiletime constant
[22:22:16] <ezyang> OK, sure 
[22:22:26] <Hildar> Is there a nicer way I'm missing to pull this off? http://pastebin.com/sxHRm6Z5
[22:22:46] <rntz> ezyang: what do you mean by "capture dynamic environment in fn"?
[22:22:47] <strcat> ezyang: if you capture an environment dynamically, you need an environment
[22:22:52] <strcat> therefore, you need a closure
[22:22:54] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[22:23:04] <kimundi> Hildar: Well, you don'T need to cast to call the methods
[22:23:13] <rntz> do you mean... close over variables? if so, I thought rust could do that.
[22:23:21] <rntz> if not I am confused.
[22:23:22] <strcat> in *closures*
[22:23:28] <strcat> functions don't have an environment
[22:23:32] <rntz> ...
[22:23:40] <rntz> the terminology has changed from under my feet, apparently
[22:23:40] <kimundi> Hildar: And you also don't need to explicitly take a &mut pointer to call a method that uses &mut self, just store the variables in a mutable slot
[22:23:45] <strcat> rntz: it didn't change
[22:24:00] <strcat> fn foo() {} has always defined a bare function without an environment
[22:24:00] <rntz> strcat: we were always at war with eastasia!
[22:24:10] <strcat> rntz: no, really, this has always been the terminology
[22:24:19] <strcat> closures are a function ptr + an environment
[22:24:29] <strcat> I don't think it has ever been the case in rust that functions had environments
[22:24:32] <tjc> strcat is right
[22:24:40] <rntz> huh, I had thought that fn foo(x: int) { fn bar() { ... can reference x ... } }?
[22:24:47] <pnkfelix> rntz: at one time the keyword `fn` *was* used for the type of closures
[22:24:47] <strcat> rntz: it can't
[22:24:51] <kimundi> Maybe the confusion is, that for quite some time, &fn() and ~fn() was rusts closure type
[22:25:00] <tjc> yes, that might well be the source of confusion
[22:25:05] <rntz> ah. yes, maybe.
[22:25:12] <tjc> the syntax for fn expressions didn't mirror the type syntax
[22:25:14] <benh> I really liked it better when the & and ~ came after the fn, too
[22:25:20] <tjc> benh: you can't win
[22:25:29] <strcat> fn() was a function, &fn/@fn/~fn were closures (function ptr + environment ptr)
[22:25:30] <tjc> (as in, people complained about fn& and fn~ being ugly, too)
[22:25:34] <benh> yeah :(
[22:25:38] <benh> tjc: of course they were all wrong!
[22:25:55] <tjc> benh: well, it is true that 90% of people on the Internet are wrong
[22:25:57] <geomyidae__> sfackler: okay, that's kind of what I was planning on doing, I was trying to avoid having to send the length ahead of time. I don't fully grok what happens when trying to do something like this over UDP, what if the length precursor isn't received and then data is, etc. But that's not a Rust issue, thats a my-understanding-of-udp-protos issue I guess
[22:26:01] <Hildar> kimundi: main.rs:11:1: 11:33 error: cannot borrow immutable dereference of & pointer as mutable (if I get rid of the muts from the cast)
[22:26:08] <benh> Did anyone fix the parser yet to allow ~fn() as ~T with T=fn()?
[22:26:32] <pcwalton> really old rust didn't even have closures :)
[22:26:34] <sfackler> geomyidae__: iirc in UDP if your read doesn't provide a buffer large enough for the entire message, the rest is thrown away
[22:26:36] *** Quits: rca_ (rcatolino@7F54AB21.28091F66.520D6FA6.IP) (Ping timeout)
[22:26:45] <kimundi> Hildar: Hm, what is the definition of MainComponent and update/draw =
[22:26:51] <rntz> pcwalton: is that "really, old rust ..." or "(really old) rust..."
[22:26:52] <rntz> ?
[22:26:55] <pcwalton> (really old) rust
[22:26:58] <rntz> ok.
[22:27:08] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:27:18] <FreeFull> Older than 0.8?
[22:27:22] <pcwalton> pre-0.1
[22:27:25] <pcwalton> instead it had a "bind" form that allowed you to bind arguments and effectively construct a closure that way
[22:27:31] * pcwalton has been around a while
[22:27:38] <geomyidae__> so just read aggressively, check the first n-bytes for a length arg, read the rest as json?
[22:27:44] *** Joins: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP)
[22:27:56] <Hildar> http://pastebin.com/FRQRk3D3
[22:27:56] <geomyidae__> but then again, wouldn't I be able to just skip the length, read aggresively, and then chuck everything I got into the json reader?
[22:28:00] <o11c> I wish SCTP were better supported
[22:28:06] <o11c> SCTP makes network programming *easy*
[22:28:14] <geomyidae__> agh, I should just wait until I can go home and pull up docs and test code easier
[22:28:14] <sfackler> geomyidae__: yeah, unless there's something after the json bit
[22:28:17] <sfackler> and you have to frame
[22:28:29] <ezyang> man, recursion makes everything better :< 
[22:29:06] <pnkfelix> ezyang: what is your goal here ?
[22:29:19] <ezyang> I'm still trying to remove an element from an owned mutable linked list 
[22:29:19] <pnkfelix> ezyang: are you attempting to provide constructive criticism, or merely to troll ?
[22:29:32] <rntz> pnkfelix: pretty sure ezyang isn't trying to troll
[22:29:36] <pcwalton> seemed like an honest request to me
[22:29:42] <ezyang> I converted the code from looping to recursion and now the borrow checker is much happier 
[22:29:43] <pcwalton> recursion makes linked lists much easier.
[22:29:50] <pcwalton> I recommend recursion
[22:29:55] <pnkfelix> okay, last few comments were not clear to me.  (e.g. complaining about lack of closures)
[22:29:56] <pcwalton> also
[22:30:01] <pcwalton> linked lists are hard in Rust
[22:30:04] <strcat> the destructor will be recursive before optimization anyway
[22:30:27] <pcwalton> we should maybe have a FAQ saying "don't implement a non-GC'd linked list to learn Rust" ;)
[22:30:30] <Eridius> hrm, there seems to be no good way to convert a [T, ..N] to a &mut [T]. I would have expected an .as_mut_slice() method
[22:30:32] <ezyang> haha 
[22:30:34] <strcat> pcwalton: well that's why it's perfect for the tutorial :),  http://static.rust-lang.org/doc/master/tutorial.html#implementing-a-linked-list
[22:30:35] <tjc> heh
[22:30:48] <tjc> a dual of the tutorial that just consists of a list of ways to not learn Rust ;-)
[22:30:49] <strcat> needs to be expanded more
[22:31:00] <ezyang> pnkfelix: Sorry, I was complaining about the lack of closures because I was using fn and not || 
[22:31:07] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Ping timeout)
[22:31:12] * strcat doesn't know a better way to teach about allocation/references
[22:31:22] <pcwalton> actually, I should say, linked lists are fine
[22:31:24] <pnkfelix> ezyang: okay yeah I'm sorry too, I did not have enough context.
[22:31:24] <benh> tjc: maybe we should just write the "what i wish i had known before i started learning rust" article now instead of having it show up on hn in a year or two!
[22:31:35] <pcwalton> but you have to know EVERYTHING about Rust's borrow checking and uniqueness to implement one
[22:31:45] <pcwalton> so if you want to explain everything about it, then that's a good way to do it
[22:31:50] <pcwalton> because it will cover everything
[22:32:04] <ezyang> I mean, seems like a pretty good tutorial for borrow checking to me. I wish the tutorial went in more depth 
[22:32:14] <pcwalton> but if you just want to "get stuff done", then implementing a linked list isn't a good warmup for Rust
[22:32:37] <pcwalton> unless you use Rc
[22:33:34] <strcat> non-intrusive singly linked lists are basically the bubble sort of data structures anyway
[22:33:52] <ezyang> So, here's an honest question: should I use a closure or just lambda lift a function? 
[22:34:05] <ezyang> (I'm just defining a helper function for the recursive step) 
[22:34:12] <strcat> the lambda syntax declares a closure
[22:34:15] <rntz> "lambda lift"?
[22:34:26] <tjc> ezyang: if you don't care about memory usage, use a closure
[22:34:37] <tjc> if you do care about memory usage, you probably still want to use a closure :-)
[22:34:49] <tjc> the distinction is there for people who want it to be clear in their code when they're heap-allocating and when they're not
[22:35:07] <strcat> tjc: well we only have borrowed stack closures and procs (heap once fns) now
[22:35:09] <ezyang> I mostly care about LLVM managing to TCO it 
[22:35:14] <tjc> strcat: Ah, true
[22:35:15] <Hildar> Well, I found the simple solution to my problem. use 'use' and get my trait into scope, and I can call my functions without taking a &-pointer and casting it.
[22:35:40] <ezyang> lambda lift = convert captured variables into arguments for the function 
[22:35:40] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[22:36:02] <strcat> although I don't think spawn should take a proc - I think it should take a generic type with a self-by-value run method
[22:36:14] <strcat> and procs will implement the trait
[22:36:24] <rntz> strcat: that strikes me as unnecessary generalization
[22:36:43] <strcat> a task tree or thread pool really doesn't want to allocate for each task
[22:36:46] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:36:46] <kimundi> Hildar: He, was just about to answer - Traits indeed need to be in scope for methods to be callable on them.
[22:36:52] <rntz> unless rust doesn't let you just give it the pointer to the appropriate method on such an object
[22:36:59] *** Joins: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP)
[22:37:10] <strcat> rntz: proc == an allocation, if it has an environment
[22:37:38] <ChrisMorgan> rntz: I think it'd be found to be convenient in some other ways also.
[22:37:42] <Hildar> kimundi: Or, as I found out, you cast it to the trait type (which is both slower and more verbose ^^). Thanks for the help.
[22:37:45] <strcat> the point of a task tree (or a less complex thread pool) is to greatly reduce the size of work you need to use to gain speed from parallelism
[22:38:02] <strcat> if you need to allocate for each task, that raises the bar again
[22:38:17] <rntz> strcat: ah, blech. I guess.
[22:38:42] <rntz> have you done a benchmark demonstrating this is *actually* a problem?
[22:39:05] <bstrie> hey reddit users, I updated the front page css and comments section css. make sure it looks good in your browser of choice
[22:39:25] <bstrie> or at least not terrible
[22:39:31] <strcat> rntz: I don't really need to benchmark - allocating + adding two numbers is a whole lot more expensive than adding two numbers
[22:39:47] <ChrisMorgan> Verdict of dead code check: I like it; it detected a bit in rust-http, most notably a few test functions that were lacking the #[test] annotation.
[22:39:51] <rntz> strcat: and your whole program is just allocating and adding two numbers, is that right?
[22:40:02] <strcat> rntz: again, this is an issue for task trees
[22:40:04] <sfackler> strcat: and the atomic operations required to spin up a new task to add two numbers will be far more expensive than the addition as well
[22:40:09] <achin> bstrie: no obvious breakage over here
[22:40:12] <strcat> sfackler: I don't think you need atomic operations
[22:40:17] <bstrie> achin: cool
[22:40:19] <strcat> I'm not talking about rust tasks
[22:40:27] <strcat> I'm talking about a thread pool or task tree
[22:40:30] <strcat> where tasks do not have stacks
[22:40:35] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[22:41:01] <strcat> and many atomic operations really aren't very expensive
[22:41:48] <bstrie> hoverbear: https://en.wikipedia.org/wiki/Sarbanes%E2%80%93Oxley_Act
[22:42:07] <pnkfelix> On the flip side of this, what would be the cost of the suggested generalization (to spawn to take a Runnable trait instead of solely proc) ?   I find it hard to imagine any, beyond divergence w.r.t how spawn is used idiomatically
[22:42:25] <strcat> pnkfelix: well it would be the same for code using procs
[22:42:37] <SiegeLord> Is this Runnable trait not the same as the Func trait?
[22:42:42] <hoverbear> bstrie: Ah, ok, a bunch of rules.
[22:42:48] <rntz> complexity of language specification. complexity of understanding code. a temptation to unnecessarily add boilerplate for "efficiency" without having tested whether that is *actually* your bottleneck. 
[22:42:48] <strcat> SiegeLord: it would take self by-value
[22:42:50] <strcat> not &mut self
[22:42:53] <SiegeLord> I see
[22:43:01] <sfackler> strcat: are these tasks enforced to not use any stack memory at compile time or something?
[22:43:13] <SiegeLord> I'd call it the Proc trait then ;)
[22:43:17] <strcat> sfackler: TBB-style tasks just don't have stacks
[22:43:19] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[22:43:25] <strcat> you don't need a stack if you don't context switch
[22:43:26] <pnkfelix> strcat: … as in current code would go unchanged?  
[22:43:32] <strcat> pnkfelix: yes
[22:43:42] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[22:43:43] <rntz> generally, if there is one obvious way to do something in a language, I am in favor of it being the only way to do it. it saves a lot of cognitive load in the long run.
[22:43:50] <strcat> the only reason to add it to the thread (or rust task) spawning functions would be to mirror the thread pool and task tree APIs
[22:44:09] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[22:44:14] <strcat> rntz: allocating for every thread pool job is too much overhead
[22:44:23] <strcat> it means you have to chop up work into bigger blocks
[22:44:28] <strcat> so it's less of an abstraction
[22:44:40] <pnkfelix> strcat: okay, that was my understanding.  (I just meant divergence in what other code people might then choose to write, not in what we currently write)
[22:44:42] <rntz> I don't really understand what your use case is.
[22:44:51] <dbaupp> benh: fwiw, re ~fn, the parser isn't broken; it was explicitly chosen to emit an error message on that to make updating nicer.
[22:44:53] <SiegeLord> I don't think having a trait for something is much of a cognitive load... traits are omnipresent in Rust
[22:44:59] <rntz> I am more concerned with getting across my general viewpoint than in arguing against this specific thing.
[22:45:09] <strcat> rntz: the goal of a task tree/graph or naive thread pool is to allow dividing up work into tiny blocks
[22:45:18] <dbaupp> benh: in any case, writing ~fn is a little like writing `~&'static int`, i.e. very strange.
[22:45:19] <strcat> with minimal overhead compared to serial code
[22:45:30] <strcat> so, each job has to be a few bytes
[22:45:33] *** Quits: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:45:36] <strcat> no stack, no context switches
[22:45:52] <rntz> (I am concerned by your certainty that your performance argument is correct in the absence of benchmarks, but maybe you just know your domain very well)
[22:45:52] <strcat> this is where the work-stealing queue acrichto wrote will excel
[22:45:58] <strcat> it's not as important with rust tasks
[22:46:02] <strcat> because they are high overhead anyway
[22:46:13] *** Quits: peterdn (chatzilla@moz-3DA3F15F.as13285.net) (Ping timeout)
[22:46:24] <rntz> oh, are you building a task system for a fork-join model of parallel computation?
[22:46:34] <strcat> well that's what I'm talking about, yes
[22:46:40] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Connection reset by peer)
[22:46:44] <rntz> ahh.
[22:46:54] <rntz> um. I think you are pretty much screwed if you want it to work the way you describe.
[22:47:02] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[22:47:05] <strcat> rntz: why?
[22:47:09] <strcat> TBB tasks work this way
[22:47:43] <strcat> it has a pool of threads, each one with a work-stealing deque, and then it has a global queue for the whole pool
[22:47:50] <rntz> my previous advisor was working on such a thing. even with a fairly state of the art implementation, you still got *much* better performance if your code manually stopped generating tasks at a certain point.
[22:47:57] <strcat> they run a task to completion on *their* stack
[22:48:04] <strcat> if they need to block on a task, they run it on the same stack
[22:48:07] <rntz> strcat: yes, I know how work-stealing scheduling works.
[22:48:31] <rntz> I was working on a garbage collector for a fork-join system which used a work-stealing scheduler
[22:48:50] *** Joins: SingingBoyo (SingingBoy@F8739140.B0AB8E61.7A95930C.IP)
[22:48:57] <strcat> you can do better than a chase-lev deque
[22:49:19] <strcat> there are queues where you can steal more than 1 job
[22:49:24] <strcat> I guess they are tree-like
[22:49:30] <pcwalton> strcat: is there a faster way to lock a C mutex other than pthread_mutex_lock
[22:49:37] <rntz> admittedly, it is quite possible our system was not state-of-the-art enough. but my general impression was, no matter how good your scheduler, the overheads are still large enough that you don't want to split the problem up into its tiniest granularities
[22:49:46] <strcat> pcwalton: no, but pthread_mutex_lock is pretty fast
[22:49:56] <pcwalton> it has a function call's worth of overhead.
[22:50:06] *** jorendorff is now known as jorendorff_away
[22:50:08] <rntz> strcat: yeah, another of the grad students was working on a project to make deques with fast splitting for graph algorithms
[22:50:09] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[22:50:39] <strcat> rntz: you don't want to split it up as much as possible, but the task scheduler itself should strive to make that possible
[22:50:45] <strcat> it should do anything it can to make that work
[22:50:59] <strcat> in fact, on a consumer machine with 8 cores I doubt you want lock-free algorithms at all
[22:51:20] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[22:51:51] <rntz> anyway, this still strikes me as exactly the kind of complicated performance concerns that benchmarks are a Good Idea for.
[22:52:15] <rntz> rather than reasoning your way into "I need to do work on X feature" and finding out that actually it was Y that was the problem all along.
[22:52:42] <rntz> but you probably know more than I
[22:52:56] <pcwalton> strcat: checking a TLS variable before each mutex lock makes the mutex 3% slower
[22:52:59] <pcwalton> and that's on Mac
[22:53:02] <pcwalton> where TLS variables are very slow.
[22:53:12] <strcat> pcwalton: afaik they're fast since 10.8
[22:53:23] <strcat> pcwalton: mutexes might be slow on OS X
[22:53:24] <pcwalton> it's not fast for me, compiles into a function call.
[22:53:26] *** Quits: kzzch (kzzch@moz-991A24E8.hsd1.va.comcast.net) (Quit: leaving)
[22:53:29] <pcwalton> so checking to see whether you're in 1:1 or M:N context is not bad
[22:53:42] <pcwalton> I'll try on linux.
[22:53:51] <strcat> pcwalton: in a statically linked binary on linux it's a ptr offset
[22:53:57] <strcat> in a dynamically linked one it's a call to the linker
[22:54:05] <strcat> unless you use those weird local-exec things
[22:54:09] *** Joins: tcr (tcr@7C181A70.200CF5B8.9D2C3D3E.IP)
[22:55:48] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[22:56:35] <pcwalton> they're 8% slower checking TLS
[22:56:45] <pcwalton> on linux.
[22:56:47] <strcat> so not very significant
[22:56:49] <pcwalton> yeah
[22:57:18] <strcat> pcwalton: are you just locking/unlocking immediately? or is this more complex
[22:57:27] <pcwalton> lock unlock immediately.
[22:57:37] <pcwalton> not inlined pthread_mutex_lock/pthread_mutex_unlock
[22:57:43] <pcwalton> so that the compiler is not optimizing it out (checked asm)
[22:58:16] <pcwalton> this is with a check before both lock *and* unlock
[22:58:49] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:59:13] * strcat is curious if it's the function call or atomic ops
[22:59:22] *** Joins: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP)
[22:59:31] <pcwalton> not sure. is there any way to inline the pthread_mutex_lock call?
[23:00:02] <strcat> I don't think there would be an easy way
[23:00:17] <pnkfelix> pcwalton: Are you just benchmarking?  If so, do you have a baseline to compare against here, e.g. calling a no-op out-of-line function instead of pthread_mutex_lock ?
[23:00:17] <strcat> cross-library LTO isn't solved (except partially by acrichto for rust :P)
[23:00:39] <acrichto> strcat: what would the missing pieces be other than LTO with native libraries?
[23:00:46] <pcwalton> pnkfelix: https://gist.github.com/pcwalton/7882676
[23:00:59] <strcat> acrichto: well we do a bad job with generics and inline functions, in general
[23:01:04] <pcwalton> switch the // line with the line above it
[23:01:08] <pnkfelix> pcwalton: thx
[23:01:10] <pcwalton> to go from checking-flag to not-checking-flag
[23:01:15] <strcat> acrichto: not really stuff specific to LTO, but stuff that would involve changing how LTO works
[23:01:26] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:01:34] *** Quits: lenstr (lenstr@11335774.9636F313.7A27613B.IP) (Client exited)
[23:01:47] <strcat> it would be really nice to not require recompiling a generic container for each crate if you were doing LTO anyway
[23:02:00] <strcat> need C++11 style exports of generic instantiations
[23:02:31] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[23:02:35] <acrichto> there was a bug on that, but that was also about pre-instantiation
[23:02:49] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[23:03:50] *** Quits: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:04:00] *** Joins: skade (skade@moz-7A703D87.pools.arcor-ip.net)
[23:04:20] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[23:04:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:06:06] *** Quits: alan (alan@32702EE8.939109B2.FB082A98.IP) (Ping timeout)
[23:06:16] *** Quits: vmx (vmx@moz-3F547149.pools.arcor-ip.net) (Quit: Leaving)
[23:06:22] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[23:07:14] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:07:43] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:07:43] *** ChanServ sets mode: +ao brson brson
[23:07:46] *** Quits: sellout (sellout-@moz-94C19942.hsd1.co.comcast.net) (Quit: Leaving.)
[23:09:37] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:10:44] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[23:13:09] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Quit: Leaving)
[23:15:02] <pcwalton> acrichto: r? https://github.com/mozilla/rust/pull/10791
[23:15:29] <strcat> huh, musl has really slow mutexes
[23:15:50] * strcat isn't sure if his glibc has lock elision on
[23:15:52] <strcat> probably not
[23:15:55] <pcwalton> Mac mutexes are quite a bit slower
[23:16:00] <pcwalton> than glibc ones
[23:17:23] *** jorendorff_away is now known as jorendorff
[23:17:46] <benh> is Cell going away for good, completely?
[23:17:55] <benh> or are you just removing Cells where you can use procs/raii now?
[23:18:10] <Eridius> I believe I'm finished with the safe rust-lua (Lua 5.1) bindings, if anyone is interested: https://github.com/kballard/rust-lua
[23:19:21] <ChrisMorgan> benh: Cell in its present form is dying, being replaced with more specific things for more specific tasks, like Mut, I believe.
[23:20:03] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:20:32] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[23:21:00] *** kimundi is now known as zz_kimundi
[23:21:50] <Eridius> wow, 7.5MB for a sample program
[23:22:12] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[23:22:21] <acrichto> Eridius: it'll be down to 2.7MB soon!
[23:22:35] <acrichto> and 1.6MB if you're willing to wait to the heat death of the universe for LTO to finish
[23:22:49] <Eridius> heh
[23:22:54] <Eridius> acrichto: what's the big drop from?
[23:22:58] <acrichto> metadata
[23:23:01] <Eridius> nice
[23:23:06] <acrichto> if you look at that executable, about 4.5MB of it is just metadata
[23:23:09] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[23:23:10] <Eridius> eek
[23:23:14] <acrichto> rust executables have no need to have metadata in them
[23:23:36] <Eridius> my liblua-*.rlib is 706KB. That also seems high :/
[23:23:46] <dbaupp> mostly metadata, presumably?
[23:23:49] <acrichto> eh, that I'm not too worried about
[23:23:54] <Eridius> I'm hoping that's mostly metadata
[23:23:56] <acrichto> if you run 'ar x liblua.rlib'
[23:24:00] <acrichto> you can take a look at the contents
[23:24:06] <acrichto> oh wait no that patch hasn't landed
[23:24:13] <acrichto> the metadata isn't in a separate file just yet
[23:24:18] <Eridius> that apparently just created a file __.SYMDEF SORTED
[23:24:34] <acrichto> although that rlib will get larger b/c we're gonna stop compressing metadata and also inserting bytecode into rlibs
[23:24:38] *** Quits: arpd (ben@moz-D42157B0.cable.virginm.net) (Ping timeout)
[23:24:45] <acrichto> disk space is cheap!
[23:24:58] <Eridius> on another note, I feel like rustc should have an option to print the name of the library it will create, so my Makefile can query it
[23:25:11] <acrichto> jack is working on that (making the crate hash computable)
[23:25:14] <Eridius> yay
[23:25:43] <acrichto> if you run 'gobjdump -h foo.o' though
[23:25:48] <acrichto> you can find out the size of the metadata section
[23:25:54] <Eridius> foo.o?
[23:26:01] <acrichto> whatever was extracted from liblua.rlib
[23:26:18] <Eridius> oh it did create a lua.o file, I didn't notice
[23:26:22] <Eridius> I don't have gobjdump though
[23:26:33] <acrichto> do you have homebrew?
[23:26:36] <Eridius> yes
[23:26:38] <ChrisMorgan> acrichto: those that say "disk space is cheap" haven't tried working in a 1GB disk image.
[23:26:40] <acrichto> brew install binutils I think
[23:26:55] <acrichto> ChrisMorgan: one installation of rust is cheap! :D
[23:26:55] <o11c> my / is 10GB, and I keep hitting that
[23:27:17] *** Quits: jvns (bork@87D98E32.4046EB22.428F94DD.IP) (Ping timeout)
[23:27:30] <Eridius> acrichto: there's a section __note.rustc (according to `otool -l`) that's 230kB
[23:27:48] <acrichto> that'd be it
[23:27:57] <acrichto> oh man that's how it works!
[23:28:05] <acrichto> I was just looking at otool's help to figure that out
[23:28:36] <ChrisMorgan> On my Android tablet I initially had a 1GB loop disk for my Ubuntu installation, when I was needing to do some Java stuff on it at the start of the year (for Uni! Honest! I wouldn't do it myself!) I decided it to be insufficient and extended it to 2GB. (Figuring out how to do that was fun. Basically, tack another GB of 0 onto the file with dd, then a command to resize the ext4 partition inside.)
[23:29:22] <ChrisMorgan> That tablet already doesn't have enough memory to build rustc (1GB for everything isn't quite enough, and Android is vicious about killing memory hogs), but it can build other things fine.
[23:31:41] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Ping timeout)
[23:31:45] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[23:31:49] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[23:31:54] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:33:22] *** Quits: colinsurprenant (colin@F692E1FE.8D7057CF.30F15291.IP) (Quit: colinsurprenant)
[23:34:05] *** Joins: arpd (ben@moz-D42157B0.cable.virginm.net)
[23:35:13] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[23:35:25] <kmc> what's the syntax for labeled loops & breaks these days?
[23:35:41] <cmr> 'foo while { ... continue 'foo; }
[23:35:42] <acrichto> rusti: 'a: loop { break 'a; }
[23:35:43] <cmr> I thought
[23:35:44] -rusti- ()
[23:35:47] <cmr> it's break?
[23:37:27] <kmc> thanks
[23:38:43] * ChrisMorgan thinks that syntax is quite ugly but can think of no improvements whatsoever
[23:38:47] *** jorendorff is now known as jorendorff_away
[23:39:11] <aatch> ChrisMorgan, labeled breaks aren't common, so it's not too big a deal.
[23:39:42] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[23:39:52] <tjc> in fact, we don't necessarily want to encourage using labeled breaks :-)
[23:40:26] *** flaper87 is now known as flaper87|afk
[23:40:48] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[23:41:14] <ChrisMorgan> aatch: "Whaaa—what does this code do? What is a lifetime doing here? What does it mean?"
[23:41:32] <kmc> in searching tickets for the syntax I discovered that labeled break was added for precisely the thing I'm using it for now, which is to say porting Gecko's HTML5 parser, which is machine-translated from Java (!)
[23:41:43] <tjc> yep
[23:41:52] <cmr> wat
[23:41:56] <tjc> that is indeed why we added them
[23:42:04] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[23:42:06] <aatch> That... what...
[23:42:26] <aatch> You're porting a C++ translation of Java code?
[23:42:35] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[23:42:37] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[23:43:09] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[23:43:28] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Quit: ZNC - http://znc.in)
[23:43:54] <tjc> writing a translator from Java to Rust, I'm assuming?
[23:44:02] <tjc> or at least, one that's good enough to translate the Gecko parser
[23:44:05] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[23:44:14] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:44:14] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[23:47:44] <kmc> right
[23:48:00] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:48:00] <kmc> converting the existing Java→C++ translator (which is written in Java) to output Rust instead
[23:48:03] <kmc> it's...
[23:48:11] * kmc is at a loss for words
[23:48:49] <AutomatedTester> kmc: a thing of beauty?
[23:49:06] * AutomatedTester takes his trolling mouth away...
[23:49:08] <AutomatedTester> :P
[23:50:02] <AutomatedTester> kmc: https://twitter.com/AutomatedTester/status/410164294257369088 is fitting to a similar situation that I had earlier
[23:50:24] *** Joins: zmthy (tim@moz-C2881CC3.ecs.vuw.ac.nz)
[23:50:52] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[23:52:20] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: ZZZzzz…)
[23:52:26] *** Quits: ianj (ianjneu@moz-7140CF01.ccs.neu.edu) (Quit: leaving)
[23:53:11] *** Joins: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com)
[23:54:09] <HollyRain> why rust is unsuited to writing crypto code? I say it becasue code related to crypto was removed from standard package
[23:54:57] <strcat> it's not necessarily unsuited to writing crypto code
[23:55:03] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[23:55:03] <HollyRain> it looks that the safer languages for such code are asm and C
[23:55:08] <strcat> we just don't have a domain expert to write it
[23:55:24] <strcat> and some other domain experts to audit the code they write
[23:56:01] <kmc> right, it's that the Rust team doesn't want to include crypto code in the std lib and vouch for its security
[23:56:10] <kmc> nothing to do with the Rust language
[23:56:23] *** Quits: Hildar (Mibbit@moz-7F4621B6.cable.virginm.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:56:34] <strcat> there are algorithms designed to be secure from side channel attacks at an algorithmic level but they are the exception
[23:56:42] <strcat> for example AES is really, really prone to timing attacks
[23:56:56] <strcat> even though AES is pretty simple to implement, implementing it right would be really hard
[23:57:07] <HollyRain> I though that it could be due to optimizations done by LLVM, which are not necessary good for crypto code
[23:57:20] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:57:20] <kmc> HollyRain: the same would apply to C code compiled with clang, though
[23:57:29] <strcat> if you do branches or table lookups based on secrets
[23:57:33] <strcat> it's vulnerable to timing attacks
[23:57:42] <strcat> and you also don't know what the optimizers are going to do to your code
[23:58:02] <strcat> and we don't have even a crappy tool like `volatile`
[23:58:10] <strcat> you could write it all in inline asm ;p
[23:58:41] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
