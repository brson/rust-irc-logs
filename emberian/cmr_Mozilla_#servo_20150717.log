[00:01:08] * pcwalton grumbles at hacking gyp files to find Qt
[00:02:11] *** Quits: akiss (akiss@moz-quen0b.pool.digikabel.hu) (Connection closed)
[00:05:42] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[00:08:33] *** Joins: figaro (Mibbit@moz-hu6.nja.252.72.IP)
[00:10:10] *** Joins: rn10950_ (rn10950@moz-bntlu7.dyn.optonline.net)
[00:11:26] *** Quits: rn10950_ (rn10950@moz-bntlu7.dyn.optonline.net) (Quit: )
[00:11:30] *** Joins: rn10950_ (rn10950@moz-bntlu7.dyn.optonline.net)
[00:11:32] *** Quits: rn10950 (rn10950@moz-vfitoc.dyn.optonline.net) (Ping timeout: 121 seconds)
[00:11:37] *** rn10950_ is now known as rn10950
[00:12:07] <mrobinson> pcwalton: Qt uses gyp?
[00:12:11] <pcwalton> Skia does
[00:12:14] <pcwalton> for the debugger
[00:12:19] <mrobinson> Aah!
[00:12:23] <pcwalton> and those have hardcoded paths to Qt
[00:12:26] <pcwalton> that do not match mine
[00:12:39] <pcwalton> so now I'm stumbling through Google Code spambot comments to try to figure out how to change that path
[00:12:40] <pcwalton> to no avil
[00:12:41] <pcwalton> avail
[00:13:24] * pcwalton hates gyp
[00:13:37] <pcwalton> I know everyone hates CMake but CMake does the same thing as gyp except that you can actually find help on CMake because it has users who aren't Google
[00:14:04] *** Quits: figaro (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:17:05] *** Quits: pcwalton (pcwalton@moz-vst.p2i.254.50.IP) (Client exited)
[00:21:45] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[00:21:46] *** ChanServ sets mode: +o pcwalton
[00:28:17] *** Quits: m_khvoinitsky (quassel@moz-c4esiv.mp2c.6dnu.04f8.2a01.IP) (A TLS packet with unexpected length was received.)
[00:32:17] *** Quits: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com) (Connection closed)
[00:36:38] *** chmanchester is now known as chmanchester|afk
[00:42:54] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:43:09] *** Quits: tikue (tim@moz-n71.k1b.0.198.IP) (Ping timeout: 121 seconds)
[00:43:17] *** Joins: bholley (bholley@moz-opfa2j.ca.comcast.net)
[00:45:03] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:45:19] *** Joins: bholley (bholley@moz-opfa2j.ca.comcast.net)
[00:46:03] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:56:33] *** Joins: mccr8 (mccr8@moz-m84lpe.ca.comcast.net)
[00:56:51] <pcwalton> ok, getting some numbers as to the batching strategy of head-of-tree Skia-GL on wikipedia
[00:58:08] <pcwalton> The Hunger Games article has 995 triangles, which Skia organizes into 29 batches with state changes between each one
[00:59:11] <gw> that's not awful, although intuitively it feels like more batches than necessary
[00:59:31] <pcwalton> it doesn't seem good
[00:59:35] <gw> (without knowing the content exactly)
[00:59:47] <gw> that probably scales quite badly with large pages I guess
[00:59:49] <pcwalton> it feels like way more batches than necessary, but the question is how much that matters
[00:59:54] <pcwalton> I'll simulate that workload on webrast
[01:00:39] <pcwalton> there's like no complex clipping needed on wikipedia, the only reason to change batches that much is to make your shaders do less work
[01:00:43] <pcwalton> at least, I don't think there is
[01:01:11] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[01:01:17] <gw> or, for example, if you need to switch texture etc between atlas pages
[01:01:24] <pcwalton> yeah
[01:01:27] <pcwalton> that's true
[01:01:46] <gw> but that wouldn't explain 29 batches by itself one would hope :)
[01:01:46] <pcwalton> I'll plug this into webrast and see how much the state changes are hurting
[01:02:12] *** Joins: je_julie (uid29643@moz-2q4j9e.brockwell.irccloud.com)
[01:03:05] <pcwalton> oh, also the batches are extremely unbalanced
[01:03:17] <pcwalton> about half of them eyeballing it look like 1-rect batches
[01:04:01] <gw> yea, that's always the trick bit with batching, if you miss a few potential optimizations, you suddenly end up with 10% good batches and 90% awful batches
[01:05:01] <pcwalton> yeah
[01:10:14] *** Quits: till (till@moz-1mj0dg.adsl.alicedsl.de) (Ping timeout: 121 seconds)
[01:14:55] *** Parts: fkaa (fkaa@moz-501od2.business.telia.com) ("")
[01:18:08] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Connection closed)
[01:26:49] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[01:29:23] *** Quits: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru) (Quit: Lost terminal)
[01:30:02] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[01:31:37] <pcwalton> ok, I tested Skia's batching strategy on that workload (still random rects though; I need to draw the same rects skia is)
[01:32:13] <pcwalton> when using the webrast shader on NVIDIA it seems 72% slower to batch at that granularity as opposed to one batch (I think one batch is possible on Wikipedia)
[01:32:33] <pcwalton> on Intel the effect is magnified; 3.1x slower to batch at that granularity as opposed to one
[01:32:56] <pcwalton> which makes sense, NVIDIA's drivers are probably smarter at working around suboptimal access patterns
[01:33:09] *** Joins: tikue (tim@moz-n71.k1b.0.198.IP)
[01:33:43] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[01:33:43] <pcwalton> on NVIDIA, the webrast shader for that workload seems 32% slower than a shader that just paints a solid color, so that's an upper bound on the amount of speedup Skia-GL can get from using multiple shaders and draw calls
[01:33:51] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[01:34:46] <pcwalton> on Intel, I was still unable to see any difference from using a 1-line shader as opposed to a 10-line shader, but I'm of course willing to believe that with a different workload it could show up :)
[01:34:52] <pcwalton> tomorrow I can try mobile
[01:36:14] <pcwalton> switching shaders seems essentially free for this workload on NVIDIA; the overhead is just from multiple draw calls -- but that overhead is large
[01:36:25] <gw> interesting numbers
[01:38:02] <pcwalton> it looks good so far. more investigation will be needed
[01:38:09] <pcwalton> but I'm guardedly optimistic
[01:38:42] <pcwalton> interestingly, it strikes me as possible that Wikipedia is a good case for Skia-GL (due to no clipping) and that pages that use rounded rects and gradients more will be harder for Skia-GL to do well on
[01:38:59] <pcwalton> but some of the overhead is fixed no matter what, so it's hard to say
[01:40:49] <gw> true. once we get a bit further along we should probably pick 5-10 real world pages with different kinds of display lists so we make sure we don't optimize only for one layout type
[01:42:04] <pcwalton> yup
[01:44:16] *** Quits: mccr8 (mccr8@moz-m84lpe.ca.comcast.net) (Quit: quit)
[01:44:54] <pcwalton> the 30% overhead of the webrast shader over a more specialized shader for just drawing colored boxes is unfortunate, and I would like to get that down
[01:45:37] <pcwalton> (I think it's likely that 30% is overestimating real-world overhead though as most shaders used on Web pages have to do at least one texture lookup)
[01:48:27] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[01:53:22] *** Quits: enaqx_ (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[01:55:18] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[01:55:20] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[01:55:22] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[02:02:50] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[02:07:00] *** Quits: kimundi (kimundi@moz-22v.6le.188.87.IP) (Ping timeout: 121 seconds)
[02:08:47] *** Joins: kimundi (kimundi@moz-nu14gg.pjbh.jk0h.57bc.2002.IP)
[02:11:14] *** Quits: not_gavi1 (gavin@moz-46i.6l4.14.76.IP) (A TLS packet with unexpected length was received.)
[02:11:14] *** Quits: gavin (gavin@irc.mozilla.org) (A TLS packet with unexpected length was received.)
[02:12:39] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:15:18] *** Joins: waffles (wafflespean@moz-9eg.co9.193.113.IP)
[02:16:10] *** Joins: not_gavin (gavin@moz-46i.6l4.14.76.IP)
[02:16:14] *** Joins: gavin (gavin@irc.mozilla.org)
[02:25:29] *** Joins: montezuma (Mibbit@moz-hu6.nja.252.72.IP)
[02:28:02] *** Quits: MrZeus (MrZeus@moz-ecvk02.skybroadband.com) (Ping timeout: 121 seconds)
[02:28:43] *** Quits: montezuma (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:33:42] *** Quits: tikue (tim@moz-n71.k1b.0.198.IP) (Connection closed)
[02:39:49] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[02:39:49] -ghservo- [13servo] 15bors-servo 04force-pushed 06homu-tmp from 140dfe881 to 14acf47a0: 02http://git.io/veK6S
[02:39:49] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[02:42:41] *** Quits: mwu (mwu@moz-rcj0fv.nj.comcast.net) (Quit: Leaving)
[02:45:36] *** Quits: playjax (chatzilla@moz-e1dpeh.optusnet.com.au) (Connection closed)
[02:46:21] *** Joins: bdero (bran@moz-nr0176.b90n.1kaj.018d.2601.IP)
[03:06:40] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[03:10:56] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[03:10:56] -ghservo- [13servo] 15bors-servo pushed 5 new commits to 06auto: 02http://git.io/vmVRc
[03:10:56] -ghservo- 13servo/06auto 14e5f4bd5 15Ms2ger: Split up WebSocketTaskHandler....
[03:10:56] -ghservo- 13servo/06auto 14142afdc 15Ms2ger: Remove the receiver field from WebSocket....
[03:10:56] -ghservo- 13servo/06auto 140cb9eb9 15Ms2ger: Set the WebSocket's Sender from the ConnectionEstablishedTask....
[03:10:56] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[03:10:59] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[03:10:59] -ghservo- [13servo] 15bors-servo closed pull request #6568: Implement Range#insertNode (06master...06delete_range) 02http://git.io/vq4wY
[03:10:59] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[03:19:57] *** Quits: rn10950 (rn10950@moz-bntlu7.dyn.optonline.net) (Quit: )
[03:21:23] *** Quits: laleh (Adium@moz-h8636h.mobile.uci.edu) (Quit: Leaving.)
[03:28:16] *** Joins: rn10950 (rn10950@moz-bntlu7.dyn.optonline.net)
[03:46:00] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[03:52:26] *** Quits: dwins (dwins@moz-9sdv1c.va.comcast.net) (A TLS packet with unexpected length was received.)
[03:59:00] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[04:02:29] *** Joins: dwins (dwins@moz-9sdv1c.va.comcast.net)
[04:09:11] *** Joins: crowbot1 (nodebot@moz-qcjj8v.compute-1.amazonaws.com)
[04:09:11] *** Quits: crowbot (nodebot@moz-u1duud.compute-1.amazonaws.com) (Connection closed)
[04:31:33] *** Joins: dlight (dlight@moz-93j.p25.135.177.IP)
[04:40:41] *** Joins: mib_bt3l0i (Mibbit@moz-hu6.nja.252.72.IP)
[04:45:32] *** Quits: mib_bt3l0i (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:46:41] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[04:54:08] *** Joins: bholley (bholley@moz-opfa2j.ca.comcast.net)
[04:54:22] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:02:45] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[05:14:03] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[05:16:00] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[05:18:12] *** Quits: mmatyas (mmatyas@moz-4lg94m.inf.u-szeged.hu) (Ping timeout: 121 seconds)
[05:18:36] *** Joins: Mouq (amoquin@moz-4sjrj2.ca.comcast.net)
[05:22:38] *** Quits: Mouq (amoquin@moz-4sjrj2.ca.comcast.net) (Ping timeout: 121 seconds)
[05:25:34] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[05:36:43] *** Joins: aravindavk (aravinda@moz-m6j.f0d.244.121.IP)
[05:39:50] *** Joins: playjax (chatzilla@moz-6ssl7m.optusnet.com.au)
[05:40:41] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[05:48:12] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[05:48:14] *** Joins: bholley (bholley@moz-opfa2j.ca.comcast.net)
[06:01:05] *** Quits: playjax (chatzilla@moz-6ssl7m.optusnet.com.au) (Connection closed)
[06:21:30] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[06:21:59] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[06:23:36] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[06:27:41] *** Joins: bogdan_maris (Instantbird@moz-662.esi.231.62.IP)
[06:32:06] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (Ping timeout: 121 seconds)
[06:40:25] *** Quits: njn (chatzilla@moz-270n86.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 42.0a1/20150713004157])
[06:40:42] *** Joins: enaqx (enaqx@moz-er7.i97.73.37.IP)
[06:51:08] *** Joins: m_khvoinitsky (quassel@moz-c4esiv.mp2c.6dnu.04f8.2a01.IP)
[06:52:52] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[06:52:55] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[06:53:44] *** Quits: enaqx (enaqx@moz-er7.i97.73.37.IP) (Ping timeout: 121 seconds)
[06:57:49] *** Quits: dlight (dlight@moz-93j.p25.135.177.IP) (Ping timeout: 121 seconds)
[07:01:10] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[07:02:44] *** Joins: dbaron (dbaron@moz-fe6shd.m8rt.25se.06b8.2a02.IP)
[07:06:11] *** Joins: Ms2ger (Ms2ger@moz-u01.vup.182.91.IP)
[07:07:16] *** Quits: waffles (wafflespean@moz-9eg.co9.193.113.IP) (Ping timeout: 121 seconds)
[07:10:10] *** Joins: enaqx (enaqx@moz-er7.i97.73.37.IP)
[07:10:58] *** Joins: dlight (dlight@moz-1pmpc1.gvt.net.br)
[07:16:11] *** Joins: doener (doener@moz-fnh.n4j.147.5.IP)
[07:22:58] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[07:22:59] *** ChanServ sets mode: +o pcwalton
[07:23:13] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:23:14] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[07:31:08] *** Joins: akiss (akiss@moz-quen0b.pool.digikabel.hu)
[07:36:45] *** Quits: FreeFull (freefull@moz-5141vd.range86-184.btcentralplus.com) (Ping timeout: 121 seconds)
[07:38:00] *** Quits: dbaron (dbaron@moz-fe6shd.m8rt.25se.06b8.2a02.IP) (Connection closed)
[07:38:19] *** Joins: dbaron (dbaron@moz-fe6shd.m8rt.25se.06b8.2a02.IP)
[07:38:35] *** Quits: akiss (akiss@moz-quen0b.pool.digikabel.hu) (Connection closed)
[07:38:50] *** Joins: FreeFull (freefull@moz-ol27r7.range86-144.btcentralplus.com)
[07:47:10] *** Joins: kmicu (kmicu@moz-uga.edn.218.91.IP)
[07:48:13] *** Quits: enaqx (enaqx@moz-er7.i97.73.37.IP) (A TLS packet with unexpected length was received.)
[07:53:16] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[07:53:16] -ghservo- [13rust-cssparser] 15SimonSapin pushed 2 new commits to 06master: 02http://git.io/vmwCy
[07:53:16] -ghservo- 13rust-cssparser/06master 1458d35ee 15Simon Sapin: Link to the Editorâ€™s Draft
[07:53:16] -ghservo- 13rust-cssparser/06master 146646666 15Simon Sapin: Use new URL for the Editorâ€™s Draft.
[07:53:16] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[07:54:35] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[07:54:35] -ghservo- [13rust-cssparser] 15rustdoc 04force-pushed 06gh-pages from 14f8f8622 to 149d8e51e: 02http://git.io/KTRsYw
[07:54:35] -ghservo- 13rust-cssparser/06gh-pages 149d8e51e 15: Update documentation
[07:54:35] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[08:03:26] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[08:04:57] *** Joins: bombless (bombless@moz-gbd.puq.21.116.IP)
[08:08:43] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[08:09:00] *** Joins: nefzaoui (nefzaoui@moz-kbk.7qe.228.41.IP)
[08:10:43] *** Joins: jviereck (Adium@moz-pqri8u.dclient.hispeed.ch)
[08:15:57] *** Joins: akiss (akiss@moz-c6colr.inf.u-szeged.hu)
[08:16:27] *** Quits: dzbarsky (Adium@moz-mukjmn.fios.verizon.net) (Quit: Leaving.)
[08:18:01] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[08:22:01] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[08:22:01] -ghservo- [13servo] 15Ms2ger 04force-pushed 06clamp-enforce-range from 143c5d7b9 to 147e4db69: 02http://git.io/vqK4O
[08:22:01] -ghservo- 13servo/06clamp-enforce-range 147e4db69 15snf: Add Clamp and EnforceRange support for webidl arguments.
[08:22:01] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[08:22:20] *** Joins: mmatyas (mmatyas@moz-4lg94m.inf.u-szeged.hu)
[08:27:31] *** Quits: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com) (Quit: Connection closed for inactivity)
[08:27:32] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[08:31:33] *** Joins: ProgramFOX (ProgramFOX@moz-oob.vol.86.89.IP)
[08:44:37] *** Quits: jviereck (Adium@moz-pqri8u.dclient.hispeed.ch) (Quit: Leaving.)
[08:49:47] *** Joins: Boddlnagg (Patrick@moz-l2hlf9.hrz.tu-darmstadt.de)
[08:50:45] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[08:59:06] *** Joins: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru)
[09:03:24] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[09:14:49] *** Joins: waffles (wafflespean@moz-l3c.43b.136.123.IP)
[09:16:49] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[09:16:49] -ghservo- [13servo] 15Ms2ger opened issue #6649: `list-style-image` grabs width/height attributes off the element 02http://git.io/vmwyM
[09:16:49] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[09:24:20] *** Joins: Elaine (Elaine@moz-35s2fm.members.linode.com)
[09:33:32] *** Quits: Boddlnagg (Patrick@moz-l2hlf9.hrz.tu-darmstadt.de) (Quit: Leaving.)
[09:35:50] *** Joins: Boddlnagg (Patrick@moz-l2hlf9.hrz.tu-darmstadt.de)
[09:41:04] *** Joins: jviereck (Adium@moz-g3fov2.ethz.ch)
[09:41:40] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[09:56:00] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[09:56:17] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[09:58:18] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Client exited)
[09:59:33] *** Quits: jviereck (Adium@moz-g3fov2.ethz.ch) (Quit: Leaving.)
[10:05:06] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[10:10:56] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Connection closed)
[10:12:49] *** Joins: mukilan (mukilan@moz-mu4.o0o.164.122.IP)
[10:14:47] *** Quits: Boddlnagg (Patrick@moz-l2hlf9.hrz.tu-darmstadt.de) (Quit: Leaving.)
[10:24:55] *** Quits: francis36012 (francis3601@moz-quu9je.cg.shawcable.net) (Quit: leaving)
[10:28:24] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[10:30:07] *** Quits: dwins (dwins@moz-9sdv1c.va.comcast.net) (Quit: Leaving...)
[10:49:26] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[10:56:11] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[11:04:35] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Connection closed)
[11:04:56] *** Joins: playjax (chatzilla@moz-6ssl7m.optusnet.com.au)
[11:05:55] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[11:07:47] *** Joins: till (till@moz-alincr.adsl.alicedsl.de)
[11:08:35] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:11:21] *** Joins: Guest53 (textual@moz-rvv.00r.255.109.IP)
[11:24:06] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[11:24:13] *** Quits: kmicu (kmicu@moz-uga.edn.218.91.IP) (Ping timeout: 121 seconds)
[11:31:30] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[11:32:29] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:32:31] *** Joins: kmicu (kmicu@moz-uga.edn.218.91.IP)
[11:36:24] *** Quits: bdero (bran@moz-nr0176.b90n.1kaj.018d.2601.IP) (Ping timeout: 121 seconds)
[11:55:19] *** Joins: eibwen (eibwen@moz-0f4tt9.dip0.t-ipconnect.de)
[12:00:25] *** Quits: aravindavk (aravinda@moz-m6j.f0d.244.121.IP) (Ping timeout: 121 seconds)
[12:10:26] *** Joins: Nashenas88 (Nashenas88@moz-of81j9.miamfl.sbcglobal.net)
[12:14:07] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[12:14:07] *** ChanServ sets mode: +qo jdm jdm
[12:14:57] *** Quits: Nashenas88 (Nashenas88@moz-of81j9.miamfl.sbcglobal.net) (Client exited)
[12:19:50] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[12:25:06] <larsberg> Has anybody been asking their googley friends to check out some of our PRs? It sounds like pre-release Chrome builds inside the 'plex are crashing on the reviews and the reviewable folks would like to know more, if we have any names we can point them at - https://github.com/Reviewable/Reviewable/issues/127
[12:25:06] <crowbot1> Issue #127: NETWORK_ERR: XMLHttpRequest Exception 101 - https://github.com/Reviewable/Reviewable/issues/127
[12:29:05] <jdm> wow
[12:29:54] *** Joins: Boddlnagg (Patrick@moz-k09fhk.dyn.telefonica.de)
[12:33:16] *** Joins: bdero (bran@moz-91hi89.mit.edu)
[12:34:26] <Manishearth> larsberg: Google is trying to ddos servo
[12:34:30] <Manishearth> we shall fight back
[12:35:33] <Manishearth> larsberg: pythonesque works at google and contributes to rust, perhaps he's poking at servo?
[12:35:46] <Manishearth> oh, no longer at google
[12:41:53] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[12:41:53] -ghservo- [13servo] 15bors-servo merged 06auto into 06homu-tmp: 02http://git.io/vmVRc
[12:41:53] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[12:42:08] <jdm> larsberg: mac1 is continuing to hit #6350
[12:42:08] <crowbot1> Issue #6350: Panic on "could not initialize thread_rng" in websocket test - https://github.com/servo/servo/issues/6350
[12:44:12] <larsberg> jdm: I saw the mail - will look into it now, before I head to the gym. Very confusing, as I thought I fixed it, but it does look like apple rolld out another firmware update, which often rolls back any system updates :-/
[12:45:05] <larsberg> jdm: hrm, `ulimit -n` is returning 4096, so I'm a bit confused (though should be enough now; it was the default 256 limit that kept killing us)
[12:45:13] <jdm> :<
[12:46:05] <larsberg> at least, that's in a new shell. Maybe I forgot a reboot, as the buildbot client would also need a HUP as its spawned shells may be inheriting old process limits... hrm
[12:47:38] *** Quits: ProgramFOX (ProgramFOX@moz-oob.vol.86.89.IP) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0/20150630154324])
[12:49:21] *** Joins: mib_lcuvve (Mibbit@moz-hu6.nja.252.72.IP)
[12:49:26] <larsberg> oh, gah, it's mac1, but running on servo-mac2. I rebooted the wrong thing... doing now
[12:50:40] * larsberg considers using roman numerals vs. arabic numerals or letters to make it easier to avoid confusing these assignments
[12:50:52] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[12:50:56] <jdm> heh
[12:51:20] <Ms2ger> Ceterum censeo we should link macN to servo-macN
[12:52:55] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Ping timeout: 121 seconds)
[12:53:12] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[12:53:45] <larsberg> Not a big fan of that - the builders go down all the time, and having the build float means that I can handle it at my (relative) leisure
[12:54:33] <larsberg> (e.g., I bet people didn't know that we lose one of either the linux or mac builders pretty much weekly, due to some borked auto-update or similar)
[12:55:16] <Ms2ger> Then I think we should get releng to manage our machines already :)
[12:56:10] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[12:56:10] -ghservo- [13servo] 15Ms2ger opened pull request #6650: Various layout cleanup. (06master...06layout-cleanup) 02http://git.io/vmoey
[12:56:10] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[12:56:35] <Ms2ger> r? ^
[12:56:41] <larsberg> Only if we're a priority. Right now, if I open a ticket at linode / macstadium, there are humans kicking machines / replacing drives / fixing things 24/7. I'd hate to lose that (i.e., return to our previous internally-managed experience).
[12:56:59] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[12:57:37] *** Quits: cparis (cparis@moz-id5hlj.hawaiiantel.net) (Ping timeout: 121 seconds)
[12:59:08] *** Quits: bombless (bombless@moz-gbd.puq.21.116.IP) (Quit: Leaving)
[12:59:34] *** Joins: Boddlnagg1 (Patrick@moz-k09fhk.dyn.telefonica.de)
[13:00:29] *** Quits: Boddlnagg (Patrick@moz-k09fhk.dyn.telefonica.de) (Ping timeout: 121 seconds)
[13:00:38] *** Joins: ahal (ahal@moz-b8e0a0.cpe.pppoe.ca)
[13:00:43] *** Joins: cparis (cparis@moz-svc.nmm.234.72.IP)
[13:01:01] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (Ping timeout: 121 seconds)
[13:01:39] *** Quits: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com) (Ping timeout: 121 seconds)
[13:01:55] *** Quits: dmarcos (sid15240@moz-9ahsin.ealing.irccloud.com) (Ping timeout: 121 seconds)
[13:02:31] *** Joins: dmarcos (sid15240@moz-9ahsin.ealing.irccloud.com)
[13:02:36] *** Quits: mystor (sid79584@moz-761b3h.charlton.irccloud.com) (Ping timeout: 121 seconds)
[13:03:19] *** Joins: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com)
[13:03:22] *** Joins: mystor (sid79584@moz-761b3h.charlton.irccloud.com)
[13:03:47] *** Joins: dwins (dwins@moz-9sdv1c.va.comcast.net)
[13:04:29] *** Quits: mib_lcuvve (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:05:54] *** jandem-away is now known as jandem
[13:11:37] <Ms2ger> larsberg, you know #6350 is an issue, not a PR, right? :)
[13:11:37] <crowbot1> Issue #6350: Panic on "could not initialize thread_rng" in websocket test - https://github.com/servo/servo/issues/6350
[13:12:30] <larsberg> Ms2ger: thanks for the heads-up! Trying to do too many things at once this morning. Should just go to the gym :-)
[13:13:08] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[13:13:42] * larsberg will wait to see what happens with http://build.servo.org/builders/mac1/builds/2549
[13:15:00] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[13:16:05] <nox> Ms2ger: Need some script reviews?
[13:16:56] <Ms2ger> nox, #6613? :)
[13:16:56] <crowbot1> Issue #6613: Implement the Form Owner concept - https://github.com/servo/servo/pull/6613
[13:17:35] <nox> Ouch, I hate you. :D
[13:17:46] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Connection closed)
[13:17:54] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[13:17:54] *** ChanServ sets mode: +qo jdm jdm
[13:19:18] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[13:22:02] *** Quits: bogdan_maris (Instantbird@moz-662.esi.231.62.IP) (Client exited)
[13:23:23] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[13:23:23] -ghservo- [13servo] 15bors-servo 04force-pushed 06auto from 146a2d4ee to 14acf47a0: 02http://git.io/A9I6iA
[13:23:23] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[13:23:26] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[13:23:26] -ghservo- [13servo] 15bors-servo pushed 7 new commits to 06auto: 02http://git.io/vmom9
[13:23:26] -ghservo- 13servo/06auto 143e2c441 15Ms2ger: Move the traversal traits into the traversal module.
[13:23:26] -ghservo- 13servo/06auto 144b08cea 15Ms2ger: Scope the allowed unsafe code in traversal.rs.
[13:23:26] -ghservo- 13servo/06auto 14c018863 15Ms2ger: Stop using Option in ThreadSafeLayoutNodeChildrenIterator::parent_node.
[13:23:26] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[13:24:40] <larsberg> ha! "Unexpected results: 1 (TIMEOUT: 1)", but at least I fixed the file handles issue.
[13:25:27] * jdm bets it's the SSL error again
[13:25:34] <jdm> that one is killing our CI productivity
[13:26:19] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[13:26:19] -ghservo- [13servo] 15larsbergstrom closed issue #6350: Panic on "could not initialize thread_rng" in websocket test 02http://git.io/vI78Z
[13:26:19] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[13:27:02] <jdm> larsberg: soooooooo
[13:27:05] <larsberg> jdm: is that an infra issue you need me focus the eye of sauron at?
[13:27:07] <jdm> that timeout is the rng thing
[13:27:14] <jdm> (pid:23089) "thread 'WebSocket connection to ws://localhost:8888/empty-message' panicked at 'could not initialize thread_rng: Too many open files (os error 24)', src/libstd/rand/mod.rs:161"
[13:27:26] <larsberg> wait, what? urgh.
[13:27:39] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[13:27:50] <larsberg> how many open files do you need? more than 4k? :-/
[13:27:57] *** Quits: waffles (wafflespean@moz-l3c.43b.136.123.IP) (Quit: C'yall later...)
[13:28:01] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Connection closed)
[13:28:05] <larsberg> I can try to set it to a gadzillion instead. 
[13:28:36] <Elaine> Hrm, I wonder if thread_rng should try and use a single FD per process with something like lazy_static.
[13:28:56] <Elaine> Does it even ever close the /dev/urandom fd?
[13:30:15] <nox> jdm: I changed child_inserted(self, child) into children_changed(self, added_nodes, removed_nodes, previous_sibling, next_sibling).
[13:32:37] <nox> From what I see from current code, inserting a DocumentFragment with N children in a <style> triggers the CSS parsing N times.
[13:32:50] *** Joins: cakecatz (cakecatz@moz-o0s5rh.sannet.ne.jp)
[13:33:42] *** Joins: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de)
[13:36:28] *** Quits: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru) (A TLS packet with unexpected length was received.)
[13:37:27] <Manishearth> larsberg: did you jsut @bors retry on an issue? O.o
[13:37:27] *** Joins: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru)
[13:38:02] <Manishearth> or does that do something?
[13:39:01] <larsberg> Manishearth: I was confused. Ms2ger straightened me out :-) I have left those comments there on that issue to preserve my shame for all eternity.
[13:39:08] <Elaine> :D
[13:39:40] <Elaine> Looks like librand reseeds the thread_rng from /dev/urandom every 32KiB of randomness, and doesn't keep the fd around, so it's temporary (seems unfortunate, but on recent Linux it will use getrandom(2) so I guess that doesn't affect me as much speed-wise)
[13:40:26] <Manishearth> larsberg: hah
[13:41:52] <jdm> Ms2ger: so #5846 is waiting for review...
[13:41:52] <crowbot1> Issue #5846: Implement Worker.prototype.terminate() - https://github.com/servo/servo/pull/5846
[13:45:30] <Ms2ger> jdm, :/
[13:46:29] * Ms2ger goes and rebases it
[13:49:13] <jgraham> Ms2ger: Speaking of reviewâ€¦ :)
[13:49:46] <Ms2ger> Let's see if my WS PR goes through this time
[13:50:41] <SimonSapin> Does creating and dropping Root have a runtime cost?
[13:50:54] <Ms2ger> Yes
[13:51:11] <SimonSapin> Ms2ger: Is that why selector matching uses .get_unsound_ref_forever() ?
[13:51:15] <Ms2ger> No
[13:51:56] <Ms2ger> Not sure how that came to be exactly
[13:52:11] <Ms2ger> Probably because the API made it hard to avoid
[13:52:14] <SimonSapin> what do you think of changing the &'a Element impl to Root<Element>? That would allow removing get_unsound_ref_forever, but would involve creating roots to traverse the tree
[13:52:34] <Ms2ger> I think that would probably make sense
[13:53:02] <SimonSapin> Ok. Iâ€™m trying that while applying https://github.com/servo/rust-selectors/pull/37
[13:53:03] <crowbot1> PR #37: Simplify some APIs - https://github.com/servo/rust-selectors/pull/37
[13:58:27] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[13:58:28] -ghservo- [13servo] 15jdm closed pull request #6304: Preparing request for async (06master...06request-refactor) 02http://git.io/vICfN
[13:58:28] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[13:59:48] *** Joins: vikaton (uid59278@moz-0a9h81.ealing.irccloud.com)
[14:01:05] *** Quits: vikaton (uid59278@moz-0a9h81.ealing.irccloud.com) (Quit: )
[14:03:42] *** Joins: hyunjune (Mibbit@moz-272.h9k.13.59.IP)
[14:07:18] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[14:08:12] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[14:08:12] -ghservo- [13servo] 15bors-servo pushed 0 new commits to 06homu-tmp: 02http://git.io/vmogv
[14:08:12] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[14:08:55] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[14:14:52] *** Joins: canhtak (jeremy@moz-kcs.u0t.149.5.IP)
[14:15:28] *** Quits: agile (mike@moz-m71dqt.rcsntx.sbcglobal.net) (Connection closed)
[14:16:53] *** Joins: agile (mike@moz-m71dqt.rcsntx.sbcglobal.net)
[14:17:47] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[14:19:29] *** Quits: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de) (Quit: Leaving.)
[14:21:51] *** Quits: playjax (chatzilla@moz-6ssl7m.optusnet.com.au) (Connection closed)
[14:21:58] <jdm> only 28 PRs marked as waiting for review
[14:22:00] <jdm> progress!
[14:22:39] <jgraham> Ms2ger: So your strategy isto keep bitrotting me so you never have to do review? :p
[14:26:32] *** Joins: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de)
[14:27:30] <Ms2ger> jgraham, my goal is to stop touching websockets by the end of the week :)
[14:29:24] <nox> I'll start reviewing stuff again soon.
[14:30:49] *** Quits: je_julie (uid29643@moz-2q4j9e.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[14:31:37] *** Joins: elemongw (textual@moz-h6tesn.dynamic.cyta.gr)
[14:32:11] <Ms2ger> Looks like njn added a println to worker.rs
[14:37:52] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Connection closed)
[14:38:57] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[14:38:57] -ghservo- [13servo] 15Ms2ger created 06terminate (+7 new commits): 02http://git.io/vmoH9
[14:38:57] -ghservo- 13servo/06terminate 14d6dde6d 15Joe Wilm: Implement Worker.prototype.terminate()...
[14:38:57] -ghservo- 13servo/06terminate 14ac171a2 15Joe Wilm: fixup! Implement Worker.prototype.terminate()
[14:38:57] -ghservo- 13servo/06terminate 149bbaf92 15Joe Wilm: fixup! Implement Worker.prototype.terminate()
[14:38:57] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[14:39:17] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[14:39:17] -ghservo- [13servo] 15bors-servo 04force-pushed 06homu-tmp from 146a2d4ee to 14e8169a8: 02http://git.io/veK6S
[14:39:17] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[14:39:40] *** Quits: elemongw (textual@moz-h6tesn.dynamic.cyta.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[14:40:15] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[14:41:01] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Connection closed)
[14:43:28] *** Quits: canhtak (jeremy@moz-kcs.u0t.149.5.IP) (Client exited)
[14:45:17] * larsberg grumbles at the tests that seem to require more than 10k open file handles...
[14:47:56] <jdm> that seems... not good
[14:49:42] <Ms2ger> Nice
[14:49:59] <Manishearth> larsberg: network stuff, or?
[14:50:08] <Ms2ger> I guess websockets
[14:50:17] <Manishearth> that's one file handle per, right?
[14:50:22] <Manishearth> 10k websockets is also a lot
[14:50:55] <Manishearth> (a lot in that I can't imagine why we'd need so many open simultaneously)
[14:55:17] *** Parts: Boddlnagg1 (Patrick@moz-k09fhk.dyn.telefonica.de) ()
[14:55:22] *** Joins: Boddlnagg1 (Patrick@moz-k09fhk.dyn.telefonica.de)
[14:55:31] *** Quits: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de) (Quit: Leaving.)
[14:56:25] <Ms2ger> Maybe we leak something?
[14:57:03] *** Joins: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com)
[14:57:39] <larsberg> Is it intentional that if I do `./mach test-wpt test/wpt/web-platform-tests/websockets/constructor/004.html` it launches a visible Servo window that just sits around until it times out?
[14:57:47] * larsberg is testing on servo-mac2, where it failed last.
[14:58:00] <Ms2ger> Yes
[14:58:05] <larsberg> That's the test that failed the last two times.
[14:58:06] <Ms2ger> Add --no-pause
[14:59:27] <larsberg> hrm, boo, running isolated and with --no-pause it succeeds (ran 162 tests; 0 unepxected results)
[14:59:51] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[14:59:51] -ghservo- [13servo] 15jdm opened issue #6651: Static analysis doesn't catch `RefCell<Option<DOMException>>` 02http://git.io/vmopo
[14:59:51] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[15:01:00] *** Quits: dbaron (dbaron@moz-fe6shd.m8rt.25se.06b8.2a02.IP) (Quit: 8403864 bytes have been tenured, next gc will be global.)
[15:03:06] *** Quits: hyunjune (Mibbit@moz-272.h9k.13.59.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:06:52] *** Quits: acgtyrant (acgtyrant@moz-v9p.mqv.201.115.IP) (Quit: å •å…¥ /dev/null)
[15:11:36] <larsberg> Ms2ger: actually, without --no-pause, will the test *ever* timeout? I've left it up for ~10 minutes now and it's just sitting there.
[15:11:53] <Ms2ger> No
[15:12:03] <Ms2ger> I mean, it'll timeout, but it won't close on its own
[15:12:47] <Manishearth> jdm: what's the context you put RefCell<Option<DE>> in?
[15:13:04] *** Quits: FreeFull (freefull@moz-ol27r7.range86-144.btcentralplus.com) (Ping timeout: 121 seconds)
[15:13:04] <Manishearth> I think we just need to walk_ty there. clippy and humpty do that, we can too
[15:13:38] <larsberg> aha, thanks
[15:14:22] <larsberg> hrm, `lsof -p PID | wc -l` on it for servo shows 301, which is a bunch but not gonna hit that 10k limit even with a decent number of concurrent wpt runners.
[15:14:58] <jdm> Manishearth: it was in a PR
[15:15:10] <jdm> in a field of a dom_struct
[15:15:24] <Manishearth> ah thanks
[15:15:26] *** Joins: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de)
[15:17:05] <Ms2ger> Manishearth, we need checks for RefCell too
[15:17:50] <Manishearth> Ms2ger: no we don't, not with walk_ty
[15:18:05] <Manishearth> Ms2ger: with walk_ty we check all type parameters for badness
[15:18:07] <Ms2ger> As opposed to DOMRefCell
[15:18:15] <Manishearth> oh that way
[15:18:16] <Manishearth> sure sure
[15:18:25] <Manishearth> That's pretty E-Easy really
[15:18:37] <Manishearth> well not E-Easy
[15:18:43] <Manishearth> E-Ms2ger-can-do-it :P
[15:18:57] <Manishearth> (I'll do it on the flight tomorrow or otherwise next week)
[15:18:59] <Ms2ger> Pff
[15:21:02] <aweinstock> I finally got copy-to-clipboard working under x11! (I had a really silly unsafe C union bug that shouldn've taken this long to resolve)
[15:21:29] <jdm> aweinstock: \o/
[15:21:45] <Manishearth> aweinstock: :D
[15:21:54] <Manishearth> next step: rewrite x11 in rust so it never happens again
[15:22:25] <jdm> x12
[15:22:42] <Ms2ger> x314
[15:22:49] <Manishearth> Y11
[15:22:51] <aweinstock> Manishearth: the bug was in my code (I was transmuting an XEvent to an XSelectionEvent instead of an XSelectionRequestEvent)
[15:22:59] <Manishearth> aweinstock: rewrite yourself in rust then :)
[15:23:15] <jdm> rrrrrrrrrgh
[15:23:21] <jdm> friggin' hyper upgrade
[15:23:21] <Ms2ger> https://pastebin.mozilla.org/8839826
[15:23:25] <aweinstock> (it could've been much worse, the bug could've had the right value in that field and silently worked rather than silently failed)
[15:23:49] <jdm> I've spent this morning doing reviews and retrying the same two PRs
[15:24:06] <Manishearth> Ms2ger: are you doing some macro magic? O.o
[15:24:10] <Ms2ger> None
[15:24:20] <Manishearth> code pls?
[15:24:51] *** Quits: Noah_ (Noah@moz-tfe.coa.101.46.IP) (Quit: bye!)
[15:25:48] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[15:25:48] -ghservo- [13servo] 15Ms2ger pushed 1 new commit to 06terminate: 02http://git.io/vmKLs
[15:25:48] -ghservo- 13servo/06terminate 140d740d6 15Ms2ger: Rebase
[15:25:48] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[15:26:51] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[15:26:51] -ghservo- [13servo] 15Ms2ger opened pull request #6652: Implement Worker.prototype.terminate(). (06master...06terminate) 02http://git.io/vmKLy
[15:26:51] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[15:27:01] *** Joins: Noah_ (Noah@moz-tfe.coa.101.46.IP)
[15:27:26] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[15:27:26] -ghservo- [13servo] 15Ms2ger closed pull request #5846: Implement Worker.prototype.terminate() (06master...06implement-worker-terminate) 02http://git.io/vfXRB
[15:27:26] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[15:27:29] <Ms2ger> Manishearth, ^
[15:27:37] <Manishearth> Ms2ger: is that whole thing inside a format!?
[15:27:40] <Manishearth> wait no it isn't
[15:29:32] <Ms2ger> jdm, I just messed around until it compiled, I'll look at it more closely tomorrow
[15:29:36] <jdm> heh
[15:30:23] <Ms2ger> (I'll be out tonight)
[15:30:44] *** Joins: marcusklaas (marcus@moz-g5v.3q0.208.213.IP)
[15:34:28] *** Joins: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP)
[15:34:28] *** ChanServ sets mode: +o pcwalton
[15:38:37] <larsberg> gah, been staring at this stupid builder issue for the last 3 hours - heading to the gym and hopefully I'll be more clear-headed afterwards.
[15:39:18] <Ms2ger> jack, yt?
[15:40:20] <jack> Ms2ger: for an hour or so, yes
[15:46:23] *** Ms2ger is now known as firebotbot
[15:46:47] <aweinstock> how do I tell mach/cargo to update a dependency?
[15:46:50] <mystor> firebotbot: ?
[15:47:54] *** Joins: FreeFull (freefull@moz-ol27r7.range86-144.btcentralplus.com)
[15:51:25] <jack> aweinstock: ./mach update-cargo -p package
[15:53:42] <Manishearth> firebotbot: !help
[15:53:55] <Manishearth> perhaps only firebot can talk to firebotbot?
[15:54:20] <Manishearth> also, mystor, looks like your patch is going to be internet famous after this Flash fiasco
[15:54:22] <firebotbot> firebotbot, coffee
[15:54:25] <Manishearth> what
[15:54:36] * firebotbot makes itself some coffee
[15:54:46] <Manishearth> oh, I see who you are
[15:54:49] <mystor> firebotbot is Ms2ger I think
[15:54:54] <Manishearth> yeah
[15:54:55] *** firebotbot is now known as Ms2ger
[15:55:40] <mystor> Manishearth: I'm glad :P. ehsan saved the glamorous patch for me.
[15:56:57] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[16:01:30] <mystor> Manishearth: Also, I think you have a different definition of internet famous than me
[16:02:53] *** Quits: Boddlnagg1 (Patrick@moz-k09fhk.dyn.telefonica.de) (Quit: Leaving.)
[16:04:41] *** Quits: marcusklaas (marcus@moz-g5v.3q0.208.213.IP) (Ping timeout: 121 seconds)
[16:06:53] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[16:07:24] <Manishearth> mystor: intern presentation title "How I got rid of Flash on GitHub and saved the world"
[16:07:42] <Ms2ger> Heh
[16:08:17] *** Quits: bdero (bran@moz-91hi89.mit.edu) (Ping timeout: 121 seconds)
[16:09:01] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[16:09:15] *** Quits: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP) (Ping timeout: 121 seconds)
[16:11:55] <Ms2ger> <mib_gt1ifa> Ms2ger, pass the message on that I miss the weekly servo updates.  Those were great.
[16:12:54] <Manishearth> :)
[16:13:03] <Manishearth> THEY SHALL RETURN
[16:14:30] *** Joins: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP)
[16:14:30] *** ChanServ sets mode: +o pcwalton
[16:14:54] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[16:16:28] <Ms2ger> pcwalton, how do you feel about something like https://github.com/Ms2ger/servo/commit/f4eb35bb03ae94e35065d18eeb7daf7ccef7705f ?
[16:19:12] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[16:19:12] -ghservo- [13servo] 15SimonSapin created 06selectors (+1 new commit): 02http://git.io/vmK2S
[16:19:12] -ghservo- 13servo/06selectors 1454c85be 15Simon Sapin: Update rust-selectors...
[16:19:12] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[16:20:02] <pcwalton> mmm, I'm concerned about the perf of get_pseudo_element_type()
[16:20:03] <pcwalton> LLVM will not optimize it into what was there before
[16:20:13] <pcwalton> involves a jump table probably
[16:20:26] <Ms2ger> Is that hot?
[16:21:09] <Ms2ger> I guess with this design it'd be easier to just remove it
[16:21:22] *** Quits: Guest53 (textual@moz-rvv.00r.255.109.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:23:44] <pcwalton> I think it might be
[16:23:44] <pcwalton> pseudos are checked all the time
[16:23:44] <pcwalton> might be possible to rework it to not make that function hot though (or remove it entirely)
[16:23:44] <pcwalton> yeah
[16:25:26] <SimonSapin> Ms2ger: does this look better than before? https://github.com/servo/servo/compare/selectors
[16:25:48] <SimonSapin> making rust-selectors only know about elements, not nodes
[16:26:53] *** Joins: mwu (mwu@moz-rcj0fv.nj.comcast.net)
[16:28:51] *** Joins: bholley (bholley@moz-opfa2j.ca.comcast.net)
[16:29:18] *** ahal is now known as ahal|afk
[16:29:35] *** Quits: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP) (Ping timeout: 121 seconds)
[16:30:35] *** Joins: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com)
[16:36:25] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[16:37:47] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[16:44:20] *** Quits: akiss (akiss@moz-c6colr.inf.u-szeged.hu) (Ping timeout: 121 seconds)
[16:46:12] *** Quits: cakecatz (cakecatz@moz-o0s5rh.sannet.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:48:48] <Manishearth> Ms2ger: https://users.rust-lang.org/t/label-shadowing-by-himself-warning/2119/3
[16:51:32] *** Joins: Jackneill (Jackneill@moz-c8rb4e.pool.digikabel.hu)
[16:54:31] <Ms2ger> SimonSapin, I'll try to look tomorrow
[16:54:44] *** Joins: laleh (Adium@moz-h8636h.mobile.uci.edu)
[16:57:20] *** Quits: Ms2ger (Ms2ger@moz-u01.vup.182.91.IP) (Quit: nn)
[17:08:05] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[17:08:05] -ghservo- [13servo] 15boghison opened issue #6653: (Merge and) delete some of the branches 02http://git.io/vmK5g
[17:08:05] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[17:08:48] *** Joins: jdm (jdm@moz-9n7g0e.ckpj.s0pt.0450.2001.IP)
[17:08:48] *** ChanServ sets mode: +qo jdm jdm
[17:10:59] *** chmanchester|afk is now known as chmanchester
[17:11:49] *** Joins: mskrzypkows (maciej@moz-p1fe5s.adsl.tpnet.pl)
[17:11:52] *** Quits: mtsr (mtsr@moz-b5lsuq.yourbnc.co.uk) (Ping timeout: 121 seconds)
[17:14:37] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[17:16:49] *** ahal|afk is now known as ahal
[17:19:31] *** Quits: mukilan (mukilan@moz-mu4.o0o.164.122.IP) (A TLS packet with unexpected length was received.)
[17:23:44] *** Quits: Asandari (Asandari@moz-emp96u.cable.teksavvy.com) (Ping timeout: 121 seconds)
[17:24:38] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[17:26:45] *** Joins: MrZeus (MrZeus@moz-ecvk02.skybroadband.com)
[17:27:50] *** Joins: Asandari (Asandari@moz-emp96u.cable.teksavvy.com)
[17:27:51] *** Joins: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com)
[17:33:18] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[17:34:03] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[17:34:51] *** Quits: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de) (Quit: Leaving.)
[17:39:27] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[17:43:12] *** Quits: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru) (A TLS packet with unexpected length was received.)
[17:43:58] *** Joins: Nekit1234007 (nekit@moz-t2fg7e.broadband.iskratelecom.ru)
[17:44:22] *** Quits: mskrzypkows (maciej@moz-p1fe5s.adsl.tpnet.pl) (Ping timeout: 121 seconds)
[17:45:23] *** Joins: bdero (bran@moz-nr0176.b90n.1kaj.018d.2601.IP)
[17:50:07] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[17:50:07] -ghservo- [13servo] 15aweinstock314 opened pull request #6654: Add copy-to-clipboard feature under x11 (06master...06add-x11-copy-to-clipboard) 02http://git.io/vm6kE
[17:50:07] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[17:50:38] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[17:53:44] *** Joins: Savago (Savago@moz-8hd.3b6.246.162.IP)
[17:54:41] <aweinstock> could someone please review #6654 and the associated changes in rust-clipboard?
[17:54:42] <crowbot1> Issue #6654: Add copy-to-clipboard feature under x11 - https://github.com/servo/servo/pull/6654
[17:54:46] <nox> DOM is made of pain.
[17:56:34] *** Joins: sneakyness (textual@moz-tmbr33.biz.rr.com)
[17:57:16] *** Joins: mskrzypkows (maciej@moz-osliff.adsl.tpnet.pl)
[17:59:40] <mskrzypkows> Hi! I'm adding new method to DocumentMethods trait, as I see it's declaration should be created automaticaly but it's not, I have error: method `HasFocus` is not a member of trait `DocumentMethods`. What should I do to have declaration created?
[18:00:13] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (A TLS packet with unexpected length was received.)
[18:00:18] <nox> mskrzypkows: It needs to exist in Document.webidl.
[18:00:50] <jdm> mmm, reading x11 FFI is so fun
[18:01:01] <nox> Is it just me, or in the DOM spec queuing a mutation record sometimes happens after the mutation, and some other times before it?
[18:01:24] *** Joins: tikue (tim@moz-n71.k1b.0.198.IP)
[18:01:56] <mskrzypkows> nox: OK, thx :-)
[18:03:21] *** Joins: dzbarsky (Adium@moz-9s9.cu6.73.173.IP)
[18:05:12] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[18:05:39] <larsberg> jdm: it's like a little window into what life was like in 1994
[18:06:03] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[18:06:03] *** ChanServ sets mode: +o brson
[18:07:58] <aweinstock> larsberg: I actually looked it up earlier today, xlib's been out since 1985 (I've only been around since 1994)
[18:09:41] * Manishearth starts singing 1985
[18:11:19] <Manishearth> aweinstock: also, hi fellow 1994 person
[18:11:44] <zmike_> did someone say...x11???
[18:11:56] <Manishearth> uh oh
[18:12:22] <aweinstock> zmike_: I finally got my copy-to-clipboard stuff to work (by fixing a subtle C-union/transmute bug that had eluded me for weeks)
[18:12:39] <zmike_> tremendous
[18:12:53] <aweinstock> I think jdm's reviewing it at the moment
[18:13:09] <zmike_> rust ffi+x11 is not the greatest combination of things that I've worked on
[18:13:39] <mwu> xcb was suppose to save us
[18:13:53] <zmike_> xcb doesn't make things any better
[18:13:59] <zmike_> it's just a different implementation
[18:14:00] <Manishearth> aweinstock: zmike works on wayland (I think?)
[18:14:17] <zmike_> Manishearth: no, you've discovered my secret!
[18:14:19] * zmike_ runs
[18:16:05] * larsberg sees wayland-rs in zmike_'s future :-)
[18:16:16] <zmike_> noooope nope nope nope nope
[18:16:23] <aweinstock> wayland is intended to be the modern replacement for X11, right?
[18:16:44] <zmike_> some might say such a thing
[18:17:46] <zmike_> in totally unrelated news, I recommend that nobody ever try to implement a nested wayland compositor
[18:17:55] <zmike_> not that I'm working on such a thing or have any knowledge of it
[18:19:54] <Manishearth> oh nesting things reminded me that I forgot to leave a increased-stack-size (i.e. 1GB) hodor.rs compile running on my work machine before leaving. Had the batch file set up and all. It would even notify me (sort of) when done. :(
[18:20:20] *** Quits: tikue (tim@moz-n71.k1b.0.198.IP) (Connection closed)
[18:21:11] <Manishearth> oh well. once I'm back in college I can find a machine to run it on.
[18:23:04] <Manishearth> though they'd probably reformat it the next day anyway so that wouldn't pan out
[18:28:50] *** Joins: cakecatz (cakecatz@moz-o0s5rh.sannet.ne.jp)
[18:29:16] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[18:29:16] -ghservo- [13servo] 15bors-servo 04force-pushed 06homu-tmp from 14e8169a8 to 146a2d4ee: 02http://git.io/veK6S
[18:29:16] -ghservo- 13servo/06homu-tmp 14e5f4bd5 15Ms2ger: Split up WebSocketTaskHandler....
[18:29:16] -ghservo- 13servo/06homu-tmp 14142afdc 15Ms2ger: Remove the receiver field from WebSocket....
[18:29:16] -ghservo- 13servo/06homu-tmp 140cb9eb9 15Ms2ger: Set the WebSocket's Sender from the ConnectionEstablishedTask....
[18:29:16] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[18:29:56] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[18:33:58] *** Quits: mskrzypkows (maciej@moz-osliff.adsl.tpnet.pl) (Ping timeout: 121 seconds)
[18:44:46] *** Quits: dwins (dwins@moz-9sdv1c.va.comcast.net) (A TLS packet with unexpected length was received.)
[18:47:14] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (Ping timeout: 121 seconds)
[18:51:04] *** Quits: bdero (bran@moz-nr0176.b90n.1kaj.018d.2601.IP) (Ping timeout: 121 seconds)
[18:51:19] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[18:52:40] *** Quits: cakecatz (cakecatz@moz-o0s5rh.sannet.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[18:53:13] *** AutomatedTester|AFK is now known as AutomatedTester
[18:54:21] *** Joins: filsmick (filsmick@moz-0qapam.abo.wanadoo.fr)
[18:56:47] *** Quits: filsmick (filsmick@moz-0qapam.abo.wanadoo.fr) (Quit: )
[18:57:16] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:57:16] *** ChanServ sets mode: +o pcwalton
[19:11:05] *** Quits: ahal (ahal@moz-b8e0a0.cpe.pppoe.ca) (Connection closed)
[19:11:23] *** Joins: ahal (ahal@moz-b8e0a0.cpe.pppoe.ca)
[19:11:38] *** Joins: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP)
[19:11:51] *** Joins: mib_lxdh56 (Mibbit@moz-hu6.nja.252.72.IP)
[19:17:11] *** Quits: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP) (Connection closed)
[19:17:13] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[19:21:21] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[19:38:05] <cimes> so who wants to help me figure out a segfault in unsafe code trying to get_mut from a hashmap?
[19:38:50] <jdm> that sounds fun!
[19:39:18] <cimes> jdm, i'm glad you think so.  http://pastebin.com/axQe0Ffi
[19:39:39] <jdm> cimes: what's the unsafe bit?
[19:40:51] <cimes> jdm, this is my time.rs file in profile_traits: http://pastebin.com/dYxtr0Sa
[19:41:06] <cimes> i won't be offended if you throw up
[19:41:33] <jdm> ohmy
[19:41:55] <mrobinson> pcwalton: Thoughts on modifying the BufferMap to store NativeSurfaces instead LayerBuffers?
[19:41:56] <cimes> yeah i know it looks terrible with the static hashmap and trying to read mut Heartbeat from it
[19:42:47] <cimes> i wrote a test program that did something similar and it didn't crash
[19:43:24] <jdm> cimes: try Box::into_raw instead of transmuting it?
[19:43:39] <jdm> I fear that it's being destroyed in doing so
[19:44:00] <jdm> cimes: oh wait
[19:44:14] <jdm> cimes: you're storing an *Arc<HashMap> in a *HashMap
[19:44:53] <jdm> cimes: yeah, that's going to not work: http://doc.servo.org/src/alloc/arc.rs.html#159
[19:45:29] <jdm> this is why indiscriminate use of transmute is frowned upon :)
[19:46:25] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[19:47:34] <pcwalton> mrobinson: what would that entail exactly? I'm not sure I follow
[19:47:45] <cimes> jdm, let me take that out and give it another try.  I would not have thought Arc would cause that kind of problem and since I was already in the hashmap functions I wouldn't have noticed by the trace
[19:48:10] <mrobinson> pcwalton: Right now the BufferMap holds LayerBuffers which in turn hold a NativeSurface. When you extract the LayerBuffer from the map, you need to update it with all the new details.
[19:48:24] <mrobinson> pcwalton: My proposal is to store just the NativeSurface and simply create a new LayerBuffer to wrap it each time.
[19:48:37] <pcwalton> hmm, if you can get that working, it sounds like it makes sense
[19:48:55] <mrobinson> pcwalton: I have a version in my working tree. :) 
[19:49:05] <pcwalton> ok, I'd be happy to review that patch then
[19:49:06] <mrobinson> pcwalton: I wanted to ask since you originally wrote the BufferMap.
[19:51:17] <cimes> jdm, huzzah! it didn't crash! Thanks, you're my hero today
[19:51:44] *** Joins: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de)
[19:52:11] <jdm> cimes: :D
[19:52:57] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[19:52:57] -ghservo- [13servo] 15bors-servo pushed 0 new commits to 06homu-tmp: 02http://git.io/vmogv
[19:52:57] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[19:54:54] *** Joins: bdero (bran@moz-00brh6.hfc.comcastbusiness.net)
[19:57:08] <mrobinson> pcwalton: Great! This is the rust-layers part: https://github.com/servo/rust-layers/pull/194
[19:57:08] <crowbot1> PR #194: Have NativeSurface store their size - https://github.com/servo/rust-layers/pull/194
[19:57:25] <mrobinson> pcwalton: Necessary because the map needs to understand the dimensions and memory usage of the surfaces.
[19:57:46] <pcwalton> ok, I'm confused now as to what this is gaining over wrapping NativeSurface in LayerBuffer
[19:57:56] <pcwalton> if you're adding the fields of LayerBuffer to NativeSurface, what has this gained?
[19:58:11] <pcwalton> (just trying to understand)
[19:58:37] <mrobinson> pcwalton: Sure, LayerBuffers have more fields which aren't important to NativeSurfaces, such as painting resolution and whether the content was rasterized with the GPU.
[19:59:14] <mrobinson> As well as screen position and content age.
[19:59:28] <pcwalton> if you create a layer buffer to wrap it, then where do you get that information if you aren't storing it anymore? do you already know that information from elsewhere at the time you create the layer buffer?
[20:00:04] <mrobinson> pcwalton: Yes, the information is determined from the BufferRequest.
[20:00:13] <pcwalton> ok, that makes sense
[20:00:34] <mrobinson> It never really carries over from one painting to another, except for perhaps whether gpu painting is enabled.
[20:03:52] *** Quits: Jackneill (Jackneill@moz-c8rb4e.pool.digikabel.hu) (A TLS packet with unexpected length was received.)
[20:04:13] *** Quits: dzbarsky (Adium@moz-9s9.cu6.73.173.IP) (Quit: Leaving.)
[20:04:27] *** Quits: bholley (bholley@moz-opfa2j.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[20:10:23] *** Joins: tikue (tim@moz-n71.k1b.0.198.IP)
[20:11:59] *** Joins: Guest53 (textual@moz-rvv.00r.255.109.IP)
[20:12:30] *** Joins: dzbarsky (Adium@moz-mukjmn.fios.verizon.net)
[20:18:18] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[20:19:16] *** Quits: dzbarsky (Adium@moz-mukjmn.fios.verizon.net) (Quit: Leaving.)
[20:22:00] *** Quits: jviereck (Adium@moz-psu032.dip0.t-ipconnect.de) (Quit: Leaving.)
[20:22:26] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[20:23:05] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:23:05] -ghservo- [13servo] 15jdm 04deleted 064587-equiv at 14ecd779c: 02http://git.io/vmiUE
[20:23:05] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:23:20] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[20:23:20] -ghservo- [13servo] 15jdm 04deleted 06cookies at 14887e90e: 02http://git.io/vmiU6
[20:23:20] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[20:23:56] <gw> pcwalton: got some initial perf numbers / results for https://i.imgur.com/xq8WSJV.png - https://pastebin.mozilla.org/8839861 - obviously take with a large grain of salt for now...
[20:24:17] <mwu> associated consts are a lot less useful than I thought they would be.
[20:25:24] <mwu> can't do things like T::SOME_CONST
[20:25:47] <huon> there's an RFC for fixing that, fortunately
[20:26:11] <mwu> huon: do you think it would be easy to fix?
[20:26:25] <mwu> wrote a pile of code assuming that would work
[20:26:50] <huon> mwu: no idea
[20:26:54] <mwu> hmm
[20:27:02] <mwu> guess I'll just have to go poke at it
[20:27:11] <huon> https://github.com/rust-lang/rfcs/pull/1062
[20:27:12] <crowbot1> PR #1062: Constants that depend on type parameters in generic code - https://github.com/rust-lang/rfcs/pull/1062
[20:27:23] *** Joins: Ms2ger (Ms2ger@moz-u01.vup.182.91.IP)
[20:27:44] <pcwalton> gw: interesting
[20:28:09] <pcwalton> gw: for the record, the Wikipedia page for The Hunger Games seems to render in 2.31 ms on Skia-GL when fully warmed
[20:29:05] <gw> what resolution is that at? that seems quite reasonable
[20:29:08] <pcwalton> 800x600
[20:29:12] <gw> ok
[20:29:23] *** AutomatedTester is now known as AutomatedTester|AFK
[20:31:15] *** Quits: bdero (bran@moz-00brh6.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[20:32:30] <gw> pcwalton: I get 1.52 ms for https://en.wikipedia.org/wiki/The_Hunger_Games, although I don't have a comparable skia-gl number. I suspect it could easily get < 1 ms for that page once batching properly
[20:32:54] <pcwalton> yeah, we have different GPUs so the numbers are not directly comparable
[20:33:11] *** AutomatedTester|AFK is now known as AutomatedTester
[20:33:14] <pcwalton> I could run it on mine to compare against Skia-GL if you wanted to send me the code
[20:33:27] <pcwalton> I have a modified Skia debugger that runs benchmarks
[20:33:34] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[20:33:34] -ghservo- [13servo] 15jdm 04deleted 06parserinterrupt2 at 1452680bb: 02http://git.io/vmiLY
[20:33:34] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[20:33:40] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:33:40] -ghservo- [13servo] 15SimonSapin created 06rustdoc-private (+1 new commit): 02http://git.io/vmiLs
[20:33:40] -ghservo- 13servo/06rustdoc-private 14c85bfe1 15Simon Sapin: Include private items in `./mach doc` and http://doc.servo.org/...
[20:33:40] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:33:56] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:33:56] -ghservo- [13servo] 15jdm 04deleted 06wpt_20150330 at 146a56baa: 02http://git.io/vmiLW
[20:33:56] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:34:06] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[20:34:06] -ghservo- [13servo] 15jdm 04deleted 06deref at 144b8c88e: 02http://git.io/vmiLl
[20:34:06] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[20:34:21] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[20:34:21] -ghservo- [13servo] 15jdm 04deleted 06jgraham-css-stability at 145829181: 02http://git.io/vmiLR
[20:34:21] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[20:34:31] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:34:31] -ghservo- [13servo] 15jdm 04deleted 06geom-snake-case at 14835ed9b: 02http://git.io/vmiLz
[20:34:31] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:34:50] <Ms2ger> Hey, my branches
[20:34:52] <gw> Its a bit hard to get building at the moment (won't work on mac yet either), but as soon as it's in an easy to build state I'll send it your way
[20:34:59] <larsberg> edunham: do you know how releng configures their OSX machines? We're running into file descriptor limits (https://github.com/servo/servo/pull/6635) and I've spent most of today trying all the magic I could find on the internets to work around it, but am getting nowhere...
[20:34:59] <crowbot1> PR #6635: Spawn a thread for WebSocket messages. - https://github.com/servo/servo/pull/6635
[20:35:02] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[20:35:02] -ghservo- [13servo] 15jdm 04deleted 06jack-auto at 14f624af6: 02http://git.io/vmiLP
[20:35:02] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[20:35:16] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:35:16] -ghservo- [13servo] 15jdm 04deleted 06profile-image-decoding at 14d4658d2: 02http://git.io/vmiLd
[20:35:16] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:35:35] *** Quits: Guest53 (textual@moz-rvv.00r.255.109.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[20:35:37] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:35:37] -ghservo- [13servo] 15jdm 04deleted 06canvas-for-svg at 146969470: 02http://git.io/vmitf
[20:35:37] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:35:45] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:35:45] -ghservo- [13servo] 15jdm 04deleted 06gonkup at 148a57219: 02http://git.io/vmitT
[20:35:45] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:36:21] <edunham> larsberg: I do not. Is this something the macstadium guys might be able to advise on?
[20:37:13] <Manishearth> larsberg: did you tell the machines to unix harder?
[20:37:29] <larsberg> edunham: Not sure; I may check on #build first to see if they have any insights. I assume that pretty much everybody doing serious builds on OSX machines has to turn off anemic limits.
[20:37:38] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:37:38] -ghservo- [13servo] 15jdm 04deleted 06revert-6344-ws-tests at 1401d337d: 02http://git.io/vmity
[20:37:38] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:37:41] <Manishearth> Firefox runs the same tests, yes?
[20:37:49] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:37:49] -ghservo- [13servo] 15jdm 04deleted 06rollup at 14299257e: 02http://git.io/vmitH
[20:37:49] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:37:49] <SimonSapin> larsberg: Is there a "more magic" switch?
[20:38:11] <larsberg> SimonSapin: I keep pushing it, but it's not doing anything...
[20:38:14] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[20:38:14] -ghservo- [13servo] 15jdm 04deleted 06rustup_mini at 14b757881: 02http://git.io/vmitp
[20:38:14] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[20:38:29] <larsberg> Manishearth: Yeah, but you know servo and threads/file descriptors/literally any other OS resource except for memory :-)
[20:38:29] <Manishearth> And those errors come from wptserve or Servo? (The source of the file descriptor overload, not the place the error comes from)
[20:38:32] <SimonSapin> (http://www.catb.org/jargon/html/magic-story.html)
[20:38:38] <larsberg> Manishearth: Yeah, WPT
[20:38:39] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[20:38:39] -ghservo- [13servo] 15jdm 04deleted 06the_little_rustup_that_could at 14a6d3ea3: 02http://git.io/vmiqT
[20:38:39] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[20:38:45] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:38:45] -ghservo- [13servo] 15SimonSapin opened pull request #6655: Include private items in `./mach doc` and http://doc.servo.org/ (06master...06rustdoc-private) 02http://git.io/vmiqk
[20:38:45] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:38:47] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[20:38:47] -ghservo- [13servo] 15jdm 04deleted 06tmp at 14ee54c89: 02http://git.io/vmiqL
[20:38:47] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[20:39:01] <Manishearth> SimonSapin: +1 on docpr
[20:39:13] <SimonSapin> Manishearth: r?
[20:39:27] <Manishearth> done
[20:39:33] <SimonSapin> cool
[20:39:37] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:39:37] -ghservo- [13servo] 15jdm closed issue #6653: (Merge and) delete some of the branches 02http://git.io/vmK5g
[20:39:37] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:40:29] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[20:40:29] -ghservo- [13servo] 15bors-servo 04force-pushed 06auto from 14e8169a8 to 14acf47a0: 02http://git.io/A9I6iA
[20:40:29] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[20:40:30] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[20:40:30] -ghservo- [13servo] 15bors-servo pushed 1 new commit to 06auto: 02http://git.io/vmiqy
[20:40:30] -ghservo- 13servo/06auto 14a24783d 15bors-servo: Auto merge of #6655 - servo:rustdoc-private, r=Manishearth...
[20:40:30] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[20:40:46] <gw> pcwalton: are you able to run your skia-gl benchmarks on a linux box, or will I need to get it working on mac first?
[20:41:25] <Manishearth> larsberg: and why does wptserve need so many filedescriptors?
[20:41:45] <Manishearth> though if it is a wptserve thing fx build probably has a solution :)
[20:42:14] <larsberg> Manishearth: I was investigating, and just one servo process running one set of WPT tests uses ~300 fds
[20:42:25] <larsberg> (at idle, after the tests complete)
[20:42:40] <Manishearth> so it's servo?
[20:42:43] <Manishearth> hm
[20:43:12] <larsberg> assuming the error message coming back from thread_rng isn't bogus
[20:43:39] <larsberg> but I removed 99% of the messages by increasing the number of files; now there's just the one in the websocket test (and it's reliable)
[20:43:47] <larsberg> that test also passes when run solo on that machine :-/
[20:44:49] <Manishearth> larsberg: doesn't happen on linux?
[20:45:47] <larsberg> Manishearth: nope
[20:45:56] <Manishearth> hm
[20:47:58] <Manishearth> larsberg: so we're using a threadlocal random number generator which talks to /dev/urandom -- how many threads do we have? 
[20:48:15] *** Joins: _Y_ (chatzilla@moz-dbqqhr.isp.telekom.rs)
[20:48:35] <larsberg> Manishearth: probably less than 200, but I wouldn't totally bet on it :-)
[20:48:39] <_Y_> Hi Rusties :)
[20:48:52] <Manishearth> larsberg: so that should be 200 filedescriptors, not a problem I guess?
[20:49:23] <_Y_> Anyone on that can help me describe html5ever CAPI for tree builder?
[20:49:35] * Manishearth wonders how a spawn-200-threads-and-block program with thread_rng would run
[20:49:48] <Manishearth> larsberg: this happens on servo-mac*? I can poke at it sunday maybe
[20:50:32] <larsberg> Manishearth: Yeah, I'm not really sure how we're hitting the limit. Or even if it's fd or sockets (assuming they both bubble up to the same OS error message).
[20:51:09] <mccr8> fwiw, people have had problems with e10s Firefox running out of fds.
[20:51:18] <larsberg> Manishearth: Thanks, ideas appreciated. I think I have all the info in the bug, including everything I've tried. You may need the root passwords, though, which IIRC jack/edunham/I don't share widely
[20:51:41] *** Quits: tikue (tim@moz-n71.k1b.0.198.IP) (Ping timeout: 121 seconds)
[20:52:07] <larsberg> mccr8: Thanks for the info! I was curious when #build didn't have anything to say - usually if we're doing something dumb on Servo they're pretty much instantaneous at pointing it out to me :-)
[20:52:39] <jdm> _Y_: what do you mean?
[20:52:50] <mccr8> larsberg: oh you mean in the test infrastructure. I meant people running it on desktop. ;)
[20:53:41] <pcwalton> gw: I think it should work on Linuxâ€¦ all I modified was the Qt-based debugger
[20:53:43] <pcwalton> let me upload my work
[20:53:51] <Manishearth> larsberg: I thought I can just ssh to servo-mac*?
[20:53:57] *** Joins: ldng (ldng@moz-j945dl.abo.bbox.fr)
[20:54:03] <Manishearth> oh, root
[20:54:19] <Manishearth> larsberg: I'm not going to try and find the osx more-magic switch
[20:54:41] <Manishearth> you can't trust me with osx root, I barely know my way around osx regular :)
[20:54:54] <Manishearth> I want to diagnose the issue on our side
[20:55:01] <Manishearth> there's a chance we're doing something silly in our code
[20:55:04] <_Y_> jdm, Well, I'm not super sure what CAPI for tree builder, or more precisely TreeSink should look like?
[20:55:16] <larsberg> Manishearth: Sounds great! No worries, really - we can blow away and restore a builder in ~ an hour.
[20:55:18] <gw> pcwalton: ok, thanks. I'll try to get mine working on mac + uploaded next week
[20:55:43] <_Y_> SimonSapin and I talked about building a CAPI that works like html5ever::driver::parse_xml
[20:55:55] <Manishearth> larsberg: yes, but with me at the wheel you'll be doing that *every* hour :P
[20:56:59] <_Y_> however that method operates on TreeSink, so I'm not sure if I should create a default TreeSink impl, or imitate how kmc made tokenizer
[20:58:06] <pcwalton> gw: https://github.com/pcwalton/skia/tree/benchmarking -- build the Skia debugger, load a Skia picture, check OpenGL and uncheck Raster, resize to the size you want, then use Benchmarks > Start OpenGL Benchmark
[20:58:10] <_Y_> by default TreeSink impl, I mean create a C structure that will serve as a DOM
[20:58:20] <SimonSapin> _Y_: I imagine it could be similar to the tokenizer C API: a C struct with some function pointers, one per trait method
[20:58:31] <SimonSapin> and a trait impl that calls these function pointers
[20:58:52] <SimonSapin> no DOM in the C API, just a tree builder with callbacks
[20:59:43] <_Y_> oh, great! That's where I was headed. 
[21:00:52] <SimonSapin> one thing that needs to be figured out though is the lifetime of handles
[21:00:56] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[21:00:56] -ghservo- [13rust-layers] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/vminO
[21:00:56] -ghservo- 13rust-layers/06auto 14f4857ce 15Martin Robinson: Have NativeSurface store their size...
[21:00:56] -ghservo- 13rust-layers/06auto 149f77239 15bors-servo: Auto merge of #194 - mrobinson:native-surface-size, r=pcwalton...
[21:00:56] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[21:01:10] <mrobinson> pcwalton: Thanks!
[21:01:21] *** Quits: kmicu (kmicu@moz-uga.edn.218.91.IP) (Client exited)
[21:01:31] <SimonSapin> _Y_: rust types can have an implicit Drop, but that would need to be a callback in the C API
[21:01:33] <SimonSapin> same with Clone
[21:01:49] *** Quits: tomaka (Pierre@moz-qrfl5c.abo.wanadoo.fr) (Ping timeout: 121 seconds)
[21:01:54] <SimonSapin> unless the tree builder could be modified to not need Clone on handles
[21:02:12] <gw> pcwalton: thanks. I'll do some comparisons on monday, and let you know
[21:02:29] <pcwalton> cool :)
[21:03:04] <_Y_> @SimonSapin, when you say lifetime, you mean like Rust notion of lifetimes, correct?
[21:03:04] <gw> pcwalton: does your webrast use freetype on mac? (I assume you're working on mac?)
[21:03:06] <pcwalton> I'm going to try to browse with Chromium for a bit and look at how long Skia is spending rasterizing assets and building shaders on the CPU
[21:03:09] <pcwalton> gw: yup, it does
[21:03:23] <pcwalton> I'm looking at switching to glyphy for the actual rasterization though
[21:03:35] <pcwalton> because it can go straight to SDF without an intermediate raster surface
[21:03:55] <gw> pcwalton: ok, shouldn't be too hard to get my lib working on mac then. will let you know when that's working. I do think going straight to sdf might be a good win
[21:04:00] <pcwalton> that would actually let me throw out the raster surface->SDF conversion code entirely
[21:04:06] <gw> yep
[21:04:09] <pcwalton> which is great because those routines are always slow or imprecise
[21:04:27] *** Joins: mtsr (mtsr@moz-40gpj7.yourbnc.co.uk)
[21:05:21] <pcwalton> in particular, the question I want to answer is "how much time does layout usually take compared to skia's rasterization/shader building?"
[21:05:35] <SimonSapin> _Y_: I mean who is responsible for freeing/destroying things
[21:05:36] <pcwalton> if the answer is "layout is usually slower", then pipelining should be a large win
[21:05:56] <SimonSapin> if C API handles are raw pointers, this wonâ€™t happen automatically
[21:06:13] <pcwalton> also, "how long does skia's CPU rasterization/shader building/texture upload take compared to the draw calls", which will also answer how much of a benefit pipelining is
[21:06:29] <_Y_> yeah, but doesn't C API come with free function?
[21:06:38] <_Y_> at least in tokenizer?
[21:06:48] <SimonSapin> _Y_: the tree sink struct might need a destroy_handle function pointer, that would be called from a Drop impl in Rust
[21:12:07] <pcwalton> larsberg: ping
[21:12:56] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[21:12:56] -ghservo- [13rust-layers] 15bors-servo closed pull request #194: Have NativeSurface store their size (06master...06native-surface-size) 02http://git.io/vmaDR
[21:12:56] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[21:13:55] <_Y_> SimonSapin: Sorry, I'm a bit confused. Drop impl in Rust of what - Handle, TreeSink C API or ?
[21:14:25] <gw> pcwalton: yep, makes sense
[21:16:37] <SimonSapin> _Y_: letâ€™s that you have a DOM tree in C where nodes are reference counter. You have node_incref and node_decref functions that take node* pointers
[21:17:02] <_Y_> ok
[21:17:08] <SimonSapin> youâ€™re gonna give these pointers to html5ever as handles
[21:17:26] *** Joins: dzbarsky (Adium@moz-mukjmn.fios.verizon.net)
[21:17:37] <SimonSapin> In Rust, youâ€™re gonna have a wrapper for these pointers, letâ€™s call it CHandle
[21:17:42] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[21:17:42] -ghservo- [13servo] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/vmi8E
[21:17:42] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[21:17:45] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[21:17:45] -ghservo- [13servo] 15bors-servo pushed 7 new commits to 06auto: 02http://git.io/vmi8u
[21:17:45] -ghservo- 13servo/06auto 143e2c441 15Ms2ger: Move the traversal traits into the traversal module.
[21:17:45] -ghservo- 13servo/06auto 144b08cea 15Ms2ger: Scope the allowed unsafe code in traversal.rs.
[21:17:45] -ghservo- 13servo/06auto 14c018863 15Ms2ger: Stop using Option in ThreadSafeLayoutNodeChildrenIterator::parent_node.
[21:17:45] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[21:17:50] <_Y_> aha
[21:17:50] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[21:17:50] -ghservo- [13servo] 15bors-servo closed pull request #6655: Include private items in `./mach doc` and http://doc.servo.org/ (06master...06rustdoc-private) 02http://git.io/vmiqk
[21:17:50] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[21:18:21] <SimonSapin> _Y_: TreeSink wants CHandle to implement Clone, and sometimes it will drop handles
[21:18:43] <_Y_> aha
[21:18:46] <SimonSapin> Clone for CHandle should call node_incref, and Drop for CHandle should call node_decref
[21:19:00] *** Quits: lerc (quassel@moz-e698gn.telstraclear.net) (Connection closed)
[21:19:03] <_Y_> ok, that makes perfect sense
[21:19:04] <SimonSapin> but html5ever doesnâ€™t know about node_{inc,dec}ref, unless you tell it about it
[21:19:22] <SimonSapin> so, the struct full of function pointers need to have two more function pointers for node_{inc,dec}ref
[21:19:25] <SimonSapin> â€¦ probably
[21:20:06] *** Joins: Lurkin (Lurkin@moz-a8i1kp.mpls.qwest.net)
[21:20:26] *** AutomatedTester is now known as AutomatedTester|AFK
[21:20:43] <pcwalton> does anyone have a list of the current Servo->Gecko integration projects handy?
[21:21:04] <pcwalton> (perhaps a link to some of the Whistler talks to that effect?)
[21:22:08] <SimonSapin> that is, unless you can prove that Clone or Drop is never used on handles. Clone is easy: remove the bound in the TreeSink trait and see if you can make it compile. Drop is more tricky. I donâ€™t know how to prove statically that itâ€™s never used, but you can use a "drop bomb" to make sure at run time that itâ€™s not used
[21:22:08] <jdm> pcwalton: you could probably find them off of https://bugzilla.mozilla.org/show_bug.cgi?id=1135640, but https://bugzilla.mozilla.org/show_bug.cgi?id=1151899 and https://bugzilla.mozilla.org/show_bug.cgi?id=1175322 and https://bugzilla.mozilla.org/show_bug.cgi?id=1161350 are relevant
[21:22:20] *** Quits: Ms2ger (Ms2ger@moz-u01.vup.182.91.IP) (Ping timeout: 121 seconds)
[21:22:25] <SimonSapin> a "drop bomb" is a Drop impl that panics or aborts
[21:22:31] *** Quits: ahal (ahal@moz-b8e0a0.cpe.pppoe.ca) (A TLS packet with unexpected length was received.)
[21:22:37] <pcwalton> jdm: thanks, very helpful!
[21:24:53] <_Y_> I see
[21:27:09] *** Joins: enaqx (enaqx@moz-dtk.cpv.163.188.IP)
[21:27:16] <SimonSapin> _Y_: hum, I donâ€™t know if skipping drop actually works
[21:28:12] <SimonSapin> well, the tree builder probably requires it, but it might not be a good idea anyway
[21:28:19] <_Y_> Well tests are comprehensive, they are bound to trigger the drop
[21:28:31] <_Y_> probably*
[21:29:59] *** Quits: jdm (jdm@moz-9n7g0e.ckpj.s0pt.0450.2001.IP) (Quit: )
[21:31:07] *** Quits: dlight (dlight@moz-1pmpc1.gvt.net.br) (A TLS packet with unexpected length was received.)
[21:33:05] *** Joins: Guest53 (textual@moz-rvv.00r.255.109.IP)
[21:33:11] <SimonSapin> hum, I just tried, and removing Clone seems more tricky than I thought
[21:33:13] <SimonSapin> so nevermind that
[21:33:33] <SimonSapin> go with clone_handle and drop_handle callbacks
[21:34:27] *** Quits: dzbarsky (Adium@moz-mukjmn.fios.verizon.net) (Quit: Leaving.)
[21:38:59] <_Y_> well, if you say it's tricky, I'll believe it ;)
[21:39:37] *** AutomatedTester|AFK is now known as AutomatedTester
[21:40:28] *** Quits: WindowsBunny (Peter@moz-vlal7g.east.verizon.net) (Ping timeout: 121 seconds)
[21:40:41] <_Y_> What other callbacks are needed? I assume append_doctype, append_comment, etc.
[21:41:04] <_Y_> so most with possible exception of same node?
[21:41:31] <SimonSapin> one per TreeSink method, basically
[21:42:23] <SimonSapin> hum, if CHandle only contains a *mut raw pointer maybe you can implement same_node with pointer equality
[21:43:20] *** Joins: WindowsBunny (Peter@moz-vlal7g.east.verizon.net)
[21:48:16] *** Joins: nefzaoui_ (nefzaoui@moz-82d.74g.227.41.IP)
[21:50:01] *** Quits: nefzaoui (nefzaoui@moz-kbk.7qe.228.41.IP) (Ping timeout: 121 seconds)
[21:51:28] *** Joins: elemongw (textual@moz-kluf9n.home.otenet.gr)
[21:52:09] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[21:54:14] *** Joins: dzbarsky (Adium@moz-mukjmn.fios.verizon.net)
[21:56:36] *** nefzaoui_ is now known as nefzaoui
[22:09:13] *** Quits: enaqx (enaqx@moz-dtk.cpv.163.188.IP) (Ping timeout: 121 seconds)
[22:11:38] *** Quits: Lurkin (Lurkin@moz-a8i1kp.mpls.qwest.net) (Quit: Leaving)
[22:18:42] *** Quits: Guest53 (textual@moz-rvv.00r.255.109.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:22:15] *** Quits: _Y_ (chatzilla@moz-dbqqhr.isp.telekom.rs) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0/20150630154324])
[22:25:18] *** Joins: wilfredh (uid159@moz-md9so9.brockwell.irccloud.com)
[22:27:01] *** Quits: elemongw (textual@moz-kluf9n.home.otenet.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:27:07] *** Joins: elemongw (textual@moz-kluf9n.home.otenet.gr)
[22:39:31] *** Joins: mylainos (Thunderbird@moz-om04d1.abo.bbox.fr)
[22:39:51] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[22:39:51] *** ChanServ sets mode: +o pcwalton
[22:41:09] *** Quits: mylainos (Thunderbird@moz-om04d1.abo.bbox.fr) (Client exited)
[22:41:37] <SimonSapin> Well, `extern crate` and `use` items being documented is a bit noisy, but itâ€™s worth it I think http://doc.servo.org/servo/index.html
[22:41:53] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[22:41:53] -ghservo- [13servo] 15SimonSapin 04deleted 06rustdoc-private at 14c85bfe1: 02http://git.io/vmiQU
[22:41:53] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[22:46:33] *** Joins: dwins (dwins@moz-9sdv1c.va.comcast.net)
[22:52:41] *** Joins: bdero (bran@moz-nr0176.b90n.1kaj.018d.2601.IP)
[22:55:56] *** Quits: kimundi (kimundi@moz-nu14gg.pjbh.jk0h.57bc.2002.IP) (Ping timeout: 121 seconds)
[22:56:51] <larsberg> pcwalton: I assume you were just asking for the rust-in-gecko projects? if so, jdm's pointer is the best for all of the ongoing work, though the majority of the stuff linked to that is related to build system integration, figuring out how to ride the trains, etc.
[22:57:25] <larsberg> pcwalton: The two projects furthest along are rillian's work on the mp4 container stuff and valentin's work on rust-url integration. 
[22:57:55] *** Quits: nefzaoui (nefzaoui@moz-82d.74g.227.41.IP) (Quit: Keep RTL safe. Bye.)
[22:57:57] <larsberg> One of the biggest items we need to do is multi-file build system support (hooking up deps file generation, etc. so that incremental and distributed-cached builds work)
[22:58:21] * larsberg should create some sort of tracking document thingie for all the various work going on
[22:59:27] <Manishearth> larsberg: spreadsheet of doom?
[23:00:35] <larsberg> Manishearth: I should do it all in powerpoint, just so people think that years of microsoft planning exercises warped me forever :-)
[23:00:57] *** Joins: kimundi (kimundi@moz-bsafd4.bs4k.bqfc.57bc.2002.IP)
[23:00:59] <Manishearth> larsberg: when I had to make a presentation (I later didn't have to, so I started but never finished), I made it in beamer
[23:01:51] <larsberg> Manishearth: we literally did some of the early mockups of our new editor UI ideas (with semi-working effects) in powerpoint
[23:01:53] <Manishearth> beamer is just enough for my presentations. I like to use the slides as hints (so any figures and code go there, but bullet points are fewer) and beamer looks quite clean with those
[23:02:17] <Manishearth> hah
[23:02:44] *** Quits: elemongw (textual@moz-kluf9n.home.otenet.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[23:02:47] <larsberg> Manishearth: I've sat through too many hours of hideous beamer presentations at academic conferences to ever use it again. Since it's just latex, most people just move each figure from their paper into a slide, add a ton of bullet points and... 55 minutes of the most painful talks ever :-)
[23:03:05] <Manishearth> but since I mostly worked for powerpoint using beamer to present to my team would be ... fun
[23:03:08] <larsberg> I twitch a little bit whenever I see the default theming 
[23:03:24] <Manishearth> I have my own. Not the default, but not hideous like the other defaults
[23:03:26] *** Joins: elemongw (textual@moz-kluf9n.home.otenet.gr)
[23:04:06] <Manishearth> larsberg: I think what a lot of folks do (certainly, my classmates do it and I've stoped them on various occasions when reviewing their slides) is that they just put everything in the slides
[23:04:25] <Manishearth> (and some put everything in the slides and still end up using the board for their presentations)
[23:05:06] <Manishearth> what folks seem to fail to understand is that these aren't lecture notes, slides are a place for stuff that can't be spoken, and outlines when stuff can be spoken
[23:05:27] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[23:05:27] -ghservo- [13rust-layers] 15mrobinson opened pull request #195: Send NativeSurfaces with BufferRequests (06master...06buffer-request-native-surface) 02http://git.io/vmibV
[23:05:27] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[23:05:33] <Manishearth> talks where people just read from the slides are the worst
[23:07:35] *** Quits: ldng (ldng@moz-j945dl.abo.bbox.fr) (Quit: Leaving)
[23:07:52] <Manishearth> larsberg: I dunno. I'm still pretty enamoured by latex. I'm fluent enough in it to be able to ditch openoffice/libreoffice/office completely and do all my document-making in it (though I don't tikz much). I think for the past three years the only time I've opened  *Office is when someone else sends me something or when I have to submit in a particular format
[23:08:02] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[23:08:07] <Manishearth> (and of course for the past two months when I worked on office :P)
[23:08:36] *** Quits: elemongw (textual@moz-kluf9n.home.otenet.gr) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[23:08:43] *** Joins: elemongw (textual@moz-kluf9n.home.otenet.gr)
[23:08:43] <Manishearth> though now markdown is my default doc-writing language. but it doesn't make pretty pdfs.
[23:14:56] *** Quits: mib_lxdh56 (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:14:57] *** Quits: dwins (dwins@moz-9sdv1c.va.comcast.net) (Quit: Leaving...)
[23:16:13] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[23:16:29] *** Joins: rohin (rohin@moz-6lrl3i.user.start.ca)
[23:23:38] *** Quits: MrZeus (MrZeus@moz-ecvk02.skybroadband.com) (Ping timeout: 121 seconds)
[23:23:40] *** Quits: rohin (rohin@moz-6lrl3i.user.start.ca) (Ping timeout: 121 seconds)
[23:24:13] <larsberg> Manishearth: related to previous conversations on #6635, do you suspect that we're just leaking file handles like mad?
[23:24:13] <crowbot1> Issue #6635: Spawn a thread for WebSocket messages. - https://github.com/servo/servo/pull/6635
[23:24:37] <larsberg> e.g., that thread_rng isn't closing properly when the thread exits and is just leaking the handle to a global or suchlike?
[23:25:11] <larsberg> The feeling in #build was that even if we can increase all the things to make the tests eek by, we need to fix the bad.
[23:26:49] <Manishearth> larsberg: yes
[23:27:11] <Manishearth> that's what I wanted to investigate
[23:27:19] <Manishearth> though it would be a linux issue too in that case
[23:28:36] *** Quits: cimes (cimes@moz-sfmbhq.il.comcast.net) (Ping timeout: 121 seconds)
[23:28:36] <larsberg> well, all of linux's default limits on the same things are 1-2 orders of magnitude larger, from what I can tell :-)
[23:28:45] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[23:28:47] <larsberg> (or just set to `unlimited`)
[23:32:38] *** Quits: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com) (Quit: quit)
[23:34:59] <Manishearth> ah
[23:35:04] <Manishearth> that could do it
[23:37:54] *** Joins: MrZeus (MrZeus@moz-ecvk02.skybroadband.com)
[23:39:54] *** Quits: mwu (mwu@moz-rcj0fv.nj.comcast.net) (Quit: Leaving)
[23:41:30] *** Joins: cimes (cimes@moz-sfmbhq.il.comcast.net)
[23:45:28] *** Quits: Savago (Savago@moz-8hd.3b6.246.162.IP) (Client exited)
[23:45:29] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[23:45:29] -ghservo- [13servo] 15jdm opened issue #6656: Intermittent timeout in /html/semantics/document-metadata/the-base-element/base_href_empty.html 02http://git.io/vmPU9
[23:45:29] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[23:45:40] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[23:45:40] -ghservo- [13servo] 15bors-servo 04force-pushed 06homu-tmp from 146a2d4ee to 14e6538c0: 02http://git.io/veK6S
[23:45:40] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[23:46:40] <Manishearth> larsberg: I'm able to run 2000 threads simultaneously here
[23:48:29] *** AutomatedTester is now known as AutomatedTester|AFK
[23:49:12] <Manishearth> larsberg: /tmp/rngtest/rng on mac1
[23:49:29] <Manishearth> https://gist.github.com/Manishearth/945a88f17cb092fd2904
[23:49:32] <Manishearth> runs fine
[23:52:10] <Manishearth> larsberg: so it's something weird that servo's doing with its threads
[23:52:42] <Manishearth> or it's not the fds opened by thread rng
[23:56:54] *** Quits: dzbarsky (Adium@moz-mukjmn.fios.verizon.net) (Quit: Leaving.)
[23:58:07] *** Joins: kaksmet (kaksmet@moz-8igmlf.se.alltele.net)
[23:58:15] *** Quits: kaksmet (kaksmet@moz-8igmlf.se.alltele.net) (Quit: )
[23:59:01] <Manishearth> larsberg: I upped it to 200000 and something happened, but that may be the OS running out of threads
