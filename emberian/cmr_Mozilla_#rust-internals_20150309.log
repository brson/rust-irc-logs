[00:00:19] *** Joins: chc4 (chc4@moz-pdo0at.ma.comcast.net)
[00:01:51] <cmr> nmatsakis: larsberg: I got accepted to an REU in math for the summer, working on automated deduction with http://people.clarkson.edu/~clynch/  
[00:02:15] <cmr> I'm going to have *plenty* of spare time to work on Rust/personal projects during and especially on either side of it, though.
[00:04:22] <larsberg> cmr: Congrats on getting accepted! 
[00:04:33] <cmr> Thanks!
[00:05:43] *** Joins: {0}grant ({0}grant@moz-63ubas.in.charter.com)
[00:05:47] <erickt> cmr: awesome!
[00:05:48] <larsberg> cmr: At the risk of losing some Rust (and hence Servo) contributions, though, don't shortchange the REU. Opportunities to work closely/locally with a very strong mentor are few and far between, and it wouldn't be the worst thing in the world to spend a full summer on automated theorem proving.
[00:06:29] <larsberg> If you do find yourself with lots of extra time and idle hands, though, I certainly wouldn't say no :-)
[00:06:48] <cmr> Yeah, we'll see what happens.
[00:08:18] <cmr> I have nearly two months of downtime on either side of it, and I want to try and get a paper published next year...
[00:08:22] <cmr> it sounds like fun!
[00:18:11] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[00:18:12] *** ChanServ sets mode: +o pnkfelix
[00:18:18] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[00:23:03] *** Joins: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP)
[00:31:13] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-jj6h6t.dynamic.qsc.de) (Ping timeout: 121 seconds)
[00:36:37] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[00:36:37] *** ChanServ sets mode: +o pcwalton
[00:36:41] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[00:58:28] *** Joins: avikpal (avikpal@moz-60o.cvs.194.117.IP)
[00:59:45] *** Joins: quantheory (quantheory@moz-m50t2f.44nj.jtvf.0001.2601.IP)
[01:01:56] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[01:02:23] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:02:56] *** Quits: Rym (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[01:03:56] *** Joins: japaric_ (japaric@moz-b44.k15.230.201.IP)
[01:04:51] *** Joins: reem (reem@moz-29h7tb.coob.q2h1.0009.2601.IP)
[01:05:33] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[01:17:39] *** Joins: corallok (corallok@moz-k1scau.res.rr.com)
[01:18:31] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[01:26:07] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:28:08] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:32:11] *** Quits: avikpal (avikpal@moz-60o.cvs.194.117.IP) (Connection closed)
[01:33:12] *** Joins: avikpal (avikpal@moz-60o.cvs.194.117.IP)
[01:33:22] *** Quits: reem (reem@moz-29h7tb.coob.q2h1.0009.2601.IP) (Connection closed)
[01:33:43] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:36:40] <steveklabnik> Manishearth: saw that, thanks :)
[01:37:06] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Client exited)
[01:40:38] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:42:06] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[01:45:27] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:50:06] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:50:11] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:51:26] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[01:52:26] <quantheory> Blegh, it still seems like implementing associated constants requires doing some part of th monomorphization-ish work early, or moving some checks (or parts thereof) down to trans.
[01:52:55] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:55:19] <quantheory> E.g. `fn foo<T: Int>(x: T) { match x { T::ZERO...T::ONE => y, _ => z } }`
[01:57:23] <huon> what check has to be moved to trans for that?
[01:59:24] <quantheory> Well, I don't think that that's the best way necessarily, but check_const and check_match seem to assume that all expressions can be fully evaluated by the time they run?
[02:00:14] *** Quits: tjakubo_ (tom@moz-783qe0.res.rr.com) (Quit: WeeChat 1.1)
[02:00:40] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[02:04:20] <nrc> aiui any use of assoc consts in const position will require a fully resolved trait ref
[02:04:35] <nrc> so that eg is not OK
[02:05:59] <nrc> partially resolved assoc consts are not const
[02:06:18] <nrc> as you say, to make that work you have to monomorphise in type checking
[02:09:13] *** Quits: avikpal (avikpal@moz-60o.cvs.194.117.IP) (Connection closed)
[02:10:59] *** Quits: Nekit1234007 (nekit@moz-vfr.64q.51.84.IP) (A TLS packet with unexpected length was received.)
[02:11:00] <cmr> Does anyone know if we have account management turned on on users.rlo on purpose?
[02:11:28] *** Joins: p1start (p1start@moz-nftjhe.org)
[02:12:03] <cmr> I know we purposefully *disabled* it on internals.rlo when we set that up.
[02:15:42] *** Quits: enix (enix@moz-0mgr2v.fios.verizon.net) (Ping timeout: 121 seconds)
[02:16:29] *** Joins: enix (enix@moz-0mgr2v.fios.verizon.net)
[02:18:09] *** Joins: tjakubo_ (tom@moz-8iol6l.sub-166-255-18.myvzw.com)
[02:19:58] *** Quits: Diggsey (diggsey@moz-rsuokg.dsl.pipex.com) (Ping timeout: 121 seconds)
[02:22:52] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:23:30] <quantheory> nrc: I think that this is something that probably has to be dealt with eventually, since for instance allowing sizeof in constant expressions leads to the same issue.
[02:24:02] <quantheory> If you allow it in generic code, that is.
[02:25:40] <nrc> true
[02:26:01] <nrc> I don't know if that is a goal though
[02:28:15] <richo> Where should I start reading for the machinery to turn a Parser into an AST? reading through the impl for Parser it relates to being driven iteratively, rather than just saying "consume my reader and give me an Option<ast>"
[02:30:22] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[02:33:04] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[02:33:10] *** Joins: reem (reem@moz-8dkc8s.coob.q2h1.0009.2601.IP)
[02:34:17] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Quit: no terrible)
[02:38:23] *** Joins: kushal (kdas@moz-3tt6sl.202.sitibroadband.in)
[02:54:39] *** Joins: mib_apfp6n (Mibbit@moz-juv.9o3.252.72.IP)
[02:56:43] *** Quits: corallok (corallok@moz-k1scau.res.rr.com) (Quit: Leaving)
[02:58:13] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[03:02:17] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (Ping timeout: 121 seconds)
[03:06:46] *** Quits: mib_apfp6n (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:15:59] *** Quits: tjakubo_ (tom@moz-8iol6l.sub-166-255-18.myvzw.com) (Quit: WeeChat 1.1)
[03:23:07] *** Joins: barosl_ (barosl@moz-7vg.qma.67.220.IP)
[03:25:33] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Ping timeout: 121 seconds)
[03:33:05] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[03:33:51] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Client exited)
[03:34:13] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[03:44:01] *** Quits: zz_kimundi (kimundi@moz-abbsvi.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:45:05] <theme> Why is ExactSizeIterator not an unsafe trait?
[03:45:05] *** Quits: japaric_ (japaric@moz-b44.k15.230.201.IP) (Ping timeout: 121 seconds)
[03:46:25] <Mutabah> theme: Would breaking that contract cause crashes (outside of unsafe code assuming that contract)
[03:46:44] *** Joins: zz_kimundi (kimundi@moz-fjbps4.dip0.t-ipconnect.de)
[03:46:45] *** zz_kimundi is now known as kimundi
[03:48:21] <theme> Mutabah, what functions in the stdlib use it?
[03:48:34] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[03:50:09] <theme> What functions in the stdlib use ExactSizeIterator?
[03:51:05] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[03:55:49] <gus> Currently rust installs two copies of (almost) all the lib*.so dylibs: one set into /usr/lib for runtime linker, and another set into /usr/lib/rustlib/*/lib for loading of metadata/symbols/whatever at compile-time.
[03:56:15] <gus> As far as I can work out these actually come from 2 different stages of the rust build process, which is a bit odd.
[03:57:27] <gus> Can/should the compile-time dylibs be symlinks back to the run-time libs to save space?  (A lot like regular C libraries have a libfoo.so -> libfoo-1.0.so symlink - one for compiler, and the other for run-time linker)
[03:57:33] *** Quits: ytain (ytain@moz-f5jvis.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[03:57:47] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[03:58:23] <gus> (although in the rust case the two have the same filename, so don't read too much into my use of the C precedent)
[03:58:29] <Mutabah> gus: I think they're actually different. rustc is built from a snapshot, not master
[03:58:57] <Mutabah> The version of libstd used by rustc is different to the one used by new code
[03:59:37] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Client exited)
[03:59:49] <gus> Hrm.  As much as I could unravel the process, I think the run-time set come from stage1(?) and the compile-time set come from stage2.
[04:00:03] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[04:00:08] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[04:00:33] <gus> They're both _meant_ to be built from the same/new source but they clearly aren't bytewise identical.
[04:01:07] <goffrie> in a fully bootstrapped compiler, why wouldn't they be identical?
[04:01:11] <gus> .. and clearly the two would be radically different in a cross-compile scenario.
[04:01:46] <gus> goffrie: an excellent question.  There's a comment in the makefiles saying "ideally" they would be identical, and that they're getting rebuilt again "to test for convergence".
[04:02:44] <gus> goffrie: in the C world (for example), compilers typically embed timestamps and have hash-ordering differences in different compiler runs.  There are various projects underway to remove those differences now that being able to verify your compiler output is considered more important than it once was.
[04:03:20] <gus> https://wiki.debian.org/ReproducibleBuilds <- for example.
[04:05:13] <WindowsBunny> I assume once rustc does reproducible builds, we'll have a test to ensure it stays that way?
[04:05:26] <goffrie> hm, my `rustc` works fine with both the lib/ and rustlib/*/lib/ libraries
[04:06:25] <nrc> I never liked the shadowing rules for lifetimes, but they drive me nuts for constructors
[04:07:14] <nrc> I feel like the compiler is patronising me and I'm programming like a week 1 student who hasn't understood scoping yet
[04:07:30] * nrc blames Javascript
[04:08:10] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (A TLS packet with unexpected length was received.)
[04:09:09] <JustAPerson> are there only shadowing rules for lifetimes?
[04:10:05] <nrc> lifetime params aren't allowed to shadow like type params
[04:10:46] <nrc> eventually it will be a lint, but that is complicated, so for now we just error
[04:11:16] * WindowsBunny demands more lints
[04:11:28] <WindowsBunny> My pocket needs more
[04:12:22] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[04:16:26] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (Ping timeout: 121 seconds)
[04:20:16] *** Quits: reem (reem@moz-8dkc8s.coob.q2h1.0009.2601.IP) (Connection closed)
[04:21:20] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Connection closed)
[04:21:52] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[04:25:11] <theme> I made RFC PR for making cmp traits unsafe
[04:25:15] <theme> https://github.com/rust-lang/rfcs/pull/956
[04:26:13] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:26:25] <WindowsBunny> theme: I like that deriving works fine still
[04:27:05] <theme> My idea had mixed positive/negative feedback so far
[04:27:15] <theme> not sure if this is *actually* a good idea
[04:27:22] <Mutabah> WindowsBunny: I think because it silently failed for a while, and people got annoyed
[04:27:27] <theme> But I think that is the least of evils
[04:27:33] *** Joins: semarie (semarie@moz-5gr25r.telostor.ca)
[04:27:52] <theme> Mutabah, are you talking about my RFC?
[04:28:11] <Mutabah> theme: not directly
[04:30:15] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[04:30:19] <theme> The precise (formal) guarantees for those traits turned out to be slightly complicated
[04:30:31] <theme> looks a bit like line noise :/
[04:33:33] <theme> whoops
[04:33:44] <theme> I missed <= and >=
[04:38:31] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:39:40] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[04:46:48] * kmc daydreams... o O ( impl<T> Shared<T> for Singlethreaded { type T = Rc<RefCell<T>>; }  impl<T> Shared<T> for Multithreaded { type T = Arc<Mutex<T>>; }
[04:46:51] <kmc> )
[04:47:48] <theme> kmc, ???
[04:52:27] <kmc> probably shouldn't use 'T' for both names, lol
[04:52:42] <kmc> i got carried away thinking about ml functors
[04:54:08] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[04:54:43] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:03:41] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:10:39] *** Quits: enix (enix@moz-0mgr2v.fios.verizon.net) (Ping timeout: 121 seconds)
[05:12:14] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[05:12:22] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (A TLS packet with unexpected length was received.)
[05:14:52] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[05:15:03] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[05:15:23] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[05:17:08] <awe> acrichto: so, does https://github.com/aatxe/rust/commit/077d72deb9e1bf1e4de42d3809e4e831e27e0a94 make sense?
[05:18:34] <awe> acrichto: Not entirely clear from what LorenVS said.
[05:25:12] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[05:27:10] <Sergio> acrichto: I don't understand your last comment on https://github.com/rust-lang/rust/pull/23163.
[05:28:07] <Sergio> If you add 'where T: Sized', then is_null won't be defined for [T] either.
[05:28:26] <Sergio> Well, for T = [A].
[05:28:57] *** Joins: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP)
[05:29:12] <acrichto> awe: yes that's what I would expect (you may want to comment on the issue saying you've got it), although you may also wish to add a test or two
[05:29:20] <acrichto> Sergio: yes
[05:29:20] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Connection closed)
[05:29:47] <acrichto> Sergio: if the goal is to "fix the ICE" then that also fixes the ICE without possibly introducing future bugs
[05:30:09] <Sergio> Well, this doesn't fix the ICE - the ICE's issue is that it doesn't take into account fat pointers.
[05:30:25] <Sergio> My suggestion was more in line with yours, I'm suggesting we change impl<T: ?Sized> PtrExt for *const T to impl<T: Sized> PtrExt for *const T
[05:30:28] <awe> acrichto: I did include in my comment that I had already implemented it. :p
[05:30:49] <awe> acrichto: My comment was just me saying that I didn't entirely understand it even though I did it.
[05:30:49] <Sergio> Then, add a impl<T> PtrExt for *const [T].
[05:31:17] <awe> acrichto: Also, you should take a look at my AsPath PR for dynamic_lib when you get the chance.
[05:31:29] <Sergio> (which calls repr or the slice pointer (or transmutes) into a Slice and compares the data pointer to zero)
[05:31:36] *** Joins: p1start (p1start@moz-nftjhe.org)
[05:31:46] <Sergio> a raw::Slice, that is.
[05:32:02] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[05:32:10] <acrichto> Sergio: perhaps, I'd have to think on those kinds of specific impls though
[05:32:24] <acrichto> awe: ah ok, and yes I'll look at it soon :)
[05:32:28] <acrichto> just dealing with backlog
[05:32:33] <awe> Yeah, no worries.
[05:32:34] <acrichto> easy to get to "easy things" first :)
[05:32:35] <Sergio> How else would this work?
[05:32:42] <Sergio> It seems that *const T is a DST itself.
[05:32:59] * awe is somewhat pleased that he made a PR that is not considered "easy things."
[05:33:02] <acrichto> Sergio: we could add a compiler intrinsics which pulls out the pointer for example
[05:33:22] <Sergio> Doesn't that just move the specific implementation into the compiler?
[05:33:34] <acrichto> Sergio: yes, but it also enables it work for all trait objects
[05:33:37] <acrichto> which a manual impl does not
[05:33:54] <Sergio> Can you have a *const TraitObject?
[05:34:24] <acrichto> perhaps not yet, but you should be able to
[05:34:45] <Sergio> I can't think of a good reason to have that.
[05:37:12] <nrc> *const anything is never DST - the size is always one or words
[05:37:34] <nrc> and you can have *const TraitObject - it is an unsafe fat pointer
[05:38:58] <Sergio> What do you mean by 'one or words'?
[05:39:10] <Sergio> Are you saying it's always a multiple of sizeof(uint)?
[05:39:16] <Sergio> usize*
[05:40:23] <Sergio> I guess it's not a DST because given a T, the size of *const T is known.
[05:40:47] <Sergio> Nonetheless, the compiler doesn't seem to know that *const T can be > sizeof(usize).
[05:45:00] *** sunfish-away is now known as sunfish
[05:48:46] *** Quits: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP) (Connection closed)
[05:57:23] *** Joins: eerie (eerie@moz-v3eps5.red.bezeqint.net)
[06:03:35] *** Joins: mib_paqwaa (Mibbit@moz-juv.9o3.252.72.IP)
[06:05:38] *** Quits: mib_paqwaa (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:07:49] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:22:02] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:22:10] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[06:22:36] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:23:38] *** Quits: O01eg (o01eg@moz-tku.38l.112.37.IP) (Client exited)
[06:24:38] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[06:29:35] *** Joins: mib_pidp9m (Mibbit@moz-juv.9o3.252.72.IP)
[06:30:22] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[06:30:34] *** Joins: eddyb_ (eddyb@moz-72m.eg8.166.109.IP)
[06:30:38] *** Joins: eerie_ (eerie@moz-nbbdu3.red.bezeqint.net)
[06:31:08] *** Joins: minzh_ (minzh@moz-97h.bjh.14.103.IP)
[06:31:24] *** Joins: p1start (p1start@moz-nftjhe.org)
[06:32:31] *** Quits: eerie (eerie@moz-v3eps5.red.bezeqint.net) (Ping timeout: 121 seconds)
[06:32:35] <eddyb_> acrichto: we've always used allocation during panicking as a reason for aborting on OOM - but what about using the lowest bit of the pointer to indicate a singleton-like 'static error?
[06:33:09] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[06:33:22] <eddyb_> panicking in a destructor called during unwinding is still a messy issue
[06:33:28] *** Quits: eerie_ (eerie@moz-nbbdu3.red.bezeqint.net) (Connection closed)
[06:33:35] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[06:33:38] <theme> eddyb_, I filed an issue somewhere about that
[06:33:51] <eddyb_> theme: oh, cool
[06:34:04] <theme> but only on JoinGuard
[06:34:16] <theme> which I found in my actual code
[06:34:26] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (Ping timeout: 121 seconds)
[06:34:32] <theme> eddyb_, https://github.com/rust-lang/rust/issues/23172
[06:34:45] * eddyb_ is ambivalent about unwinding
[06:34:48] <eddyb_> theme: thanks
[06:34:53] <theme> eddyb_, maybe you should hurry :)
[06:35:01] <theme> judging from what you said on #rust-offtopic
[06:35:27] <eddyb_> the nick is like it is because I'm mobile
[06:35:49] * eddyb_ wishes he could use one emoji to indicate that
[06:36:25] <theme> eddyb_, http://www.fileformat.info/info/unicode/char/1f4f1/index.htm
[06:36:53] *** Quits: mib_pidp9m (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:38:36] <eddyb_> eddybðŸ“´
[06:38:42] <eddyb_> can't find anything better
[06:38:57] <eddyb_> theme: but IRC doesn't let you use unicode in nicks
[06:39:17] <eddyb_> the protocol might be fine, I guess, but servers are not
[06:39:58] <WindowsBunny> eddyb_: If only IRC had support for display nicknames
[06:40:09] <Sergio> What are display nicknames?
[06:40:25] <WindowsBunny> a nick you can change, without actually changing your nick
[06:40:50] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[06:41:11] <WindowsBunny> and it would be able to use arbitrary unicode, instead of being limited to a small subset of ascii
[06:41:12] <theme> eddyb_, doesn't display properly in hexchat
[06:41:34] <WindowsBunny> eddyb_: Displays fine in pidgin because I am explicitly using a font with emoji
[06:44:11] *** Quits: minzh_ (minzh@moz-97h.bjh.14.103.IP) (Ping timeout: 121 seconds)
[06:44:22] *** Quits: det (chris@moz-7bbmke.lv.cox.net) (Connection closed)
[06:45:33] *** Quits: eddyb_ (eddyb@moz-72m.eg8.166.109.IP) (Ping timeout: 121 seconds)
[06:46:19] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[06:51:58] *** Joins: det (chris@moz-7bbmke.lv.cox.net)
[06:52:48] *** Quits: det (chris@moz-7bbmke.lv.cox.net) (Connection closed)
[06:53:02] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[06:53:05] *** Joins: det (chris@moz-7bbmke.lv.cox.net)
[06:54:54] *** Joins: O01eg (o01eg@moz-o2hta1.3od4.4n8f.2698.2a02.IP)
[06:58:43] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[06:58:55] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:02:26] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Ping timeout: 121 seconds)
[07:03:16] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[07:03:19] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[07:03:30] *** Quits: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP) (Connection closed)
[07:04:19] *** Joins: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP)
[07:06:33] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:14:11] *** Joins: mib_9yzf6j (Mibbit@moz-juv.9o3.252.72.IP)
[07:15:04] *** Quits: mib_9yzf6j (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:21:01] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[07:21:02] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[07:22:09] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[07:24:24] *** Quits: untitaker (untitaker@moz-odi003.highway.telekom.at) (Ping timeout: 121 seconds)
[07:26:39] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[07:29:52] *** Joins: untitaker (untitaker@moz-p0ucu9.highway.telekom.at)
[07:32:32] *** Joins: shachaf (shachaf@moz-evr8ss.members.linode.com)
[07:35:34] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:38:35] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[07:40:03] *** Joins: mib_z1xsy2 (Mibbit@moz-juv.9o3.252.72.IP)
[07:40:33] *** Quits: mib_z1xsy2 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:41:02] *** Quits: quantheory (quantheory@moz-m50t2f.44nj.jtvf.0001.2601.IP) (Quit: Leaving)
[07:45:31] *** Quits: hugod (user@moz-rr6.jmo.24.70.IP) (Ping timeout: 121 seconds)
[07:48:49] *** Quits: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[07:52:42] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[07:53:42] *** Joins: hugod (user@moz-885.jmo.24.70.IP)
[07:59:38] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[08:00:26] *** Joins: rustical (dida@moz-55rvi2.dclient.hispeed.ch)
[08:03:41] *** Joins: sinclair (chatzilla@moz-o36q4q.xnet.co.nz)
[08:04:03] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[08:07:30] *** Quits: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP) (Connection closed)
[08:09:02] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[08:16:17] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[08:20:49] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[08:22:02] *** Joins: arrrrrrr1 (arrrrrrrrs@moz-jj6h6t.dynamic.qsc.de)
[08:23:34] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[08:27:24] *** Joins: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de)
[08:28:37] *** Joins: imperio (Mibbit@moz-opqtbe.abo.bbox.fr)
[08:34:33] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[08:34:36] *** Joins: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP)
[08:40:47] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[08:42:31] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[08:42:54] *** Quits: reem (reem@moz-t0lj4l.coob.q2h1.0009.2601.IP) (Connection closed)
[08:43:35] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[09:09:32] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[09:10:26] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[09:15:00] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[09:17:02] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[09:18:16] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[09:20:03] *** Quits: larhat (Adium@moz-eou.8og.232.213.IP) (Quit: Leaving.)
[09:22:42] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Ping timeout: 121 seconds)
[09:23:55] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:23:57] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[09:24:50] *** Joins: Diggsey (diggsey@moz-u3erf7.dsl.pipex.com)
[09:25:25] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[09:25:25] *** ChanServ sets mode: +o nrc
[09:28:05] <Mutabah> How does rust differentiate 'if a < b { }' from 'if a < B {field: 0} { }'
[09:28:33] <Mutabah> I.e. stop a block from being interpreted as a structure literal
[09:28:56] <arrrrrrr1> you have to add parenthesis
[09:29:18] <Mutabah> Yeah... just I have code that compiles in rustc, but my code interprets as a structure literal
[09:29:26] <Mutabah> (my code = my rust parser)
[09:29:54] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:30:10] <arrrrrrr1> before the parenthesis rule there was the "is there a `something_something:` at the start" rule
[09:31:00] <Mutabah> ah
[09:31:46] <Mutabah> Wait, how recent is the parenthesis rule?
[09:32:21] <munksgaard> eddyb: You there? When I change with_attrs as you suggested and simply call that from get_attrs_opt in ty.rs, I get the following weird error: https://gist.github.com/Munksgaard/a2500bdae9d4104af4b1
[09:32:25] <arrrrrrr1> not that recent
[09:33:23] <arrrrrrr1> gh14885
[09:33:23] <[o__o]> libsyntax: Disallow struct literals after `if`, `while`, `match`, and: https://github.com/rust-lang/rust/pull/14885
[09:33:25] <munksgaard> eddyb: Compared to this branch: https://github.com/Munksgaard/rust/tree/get_attrs_opt, the only thing I've done is changed get_attrs_opt to return `Some(Cow::Borrowed(tcx.map.attrs(did.node)))`
[09:34:03] <Mutabah> arrrrrrr1: Oh, you need parens to make it interpret as a struct literal?
[09:34:20] <arrrrrrr1> that's what the PR says
[09:36:03] <Mutabah> Funtime! (getting that RFC implemented in my parser)
[09:36:33] *** Joins: laumann (laumann@moz-fso.hq0.225.130.IP)
[09:40:32] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (A TLS packet with unexpected length was received.)
[09:41:51] *** Joins: eddyb_ (eddyb@moz-8nm.t0c.166.109.IP)
[09:43:49] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[09:48:04] *** Joins: eibwen (eibwen@moz-964jo8.dip0.t-ipconnect.de)
[09:48:35] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[09:49:19] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[09:49:19] *** ChanServ sets mode: +o nrc
[09:52:47] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[09:54:58] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (A TLS packet with unexpected length was received.)
[09:56:19] *** Joins: minzh (minzh@moz-97h.bjh.14.103.IP)
[10:00:23] *** Quits: minzh (minzh@moz-97h.bjh.14.103.IP) (Ping timeout: 121 seconds)
[10:02:20] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[10:04:36] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[10:09:08] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[10:11:03] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Connection closed)
[10:11:25] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[10:27:26] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[10:29:13] *** Quits: kmcguire (kmcguire@moz-c955nf.res.rr.com) (Ping timeout: 121 seconds)
[10:29:24] *** Quits: eddyb_ (eddyb@moz-8nm.t0c.166.109.IP) (Quit: Bye)
[10:33:48] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[10:38:21] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[10:39:13] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[10:44:07] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[10:55:00] <simukis> huon: ping
[10:55:34] *** Joins: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com)
[10:56:35] <arrrrrrr1> what code has to be changed to provide tar.xz nightlies for linux?
[10:56:53] <simukis> mk/dist.mk, most likely
[10:58:45] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[10:58:48] <Manishearth> Can someone close this?
[10:58:49] <Manishearth> https://github.com/rust-lang/rust/pull/23180
[10:58:52] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[11:00:08] <arrrrrrr1> >Net Upgrade Size:      -166.89 MiB
[11:00:10] <arrrrrrr1> yoooooo
[11:03:17] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[11:04:17] <barosl_> Manishearth, Wut? Why is it not automatically closed?
[11:04:23] *** barosl_ is now known as barosl
[11:04:34] <Manishearth> barosl: not sure
[11:04:42] <barosl> Ah, due to the merge conflict state?
[11:04:44] <Manishearth> yes
[11:04:53] *** Joins: Sindriava (textual@moz-hegob1.wendulka.net)
[11:04:57] <barosl> GitHub's way toooo smart
[11:05:33] <arrrrrrr1> cargo test takes a long time to compile suddenly. was there a performance regression?
[11:05:43] <Manishearth> lol
[11:06:17] <barosl> arrrrrrr1, I saw an issue on reddit, which links to https://github.com/rust-lang/cargo/issues/1386
[11:06:49] <arrrrrrr1> no, it does compile
[11:06:57] <arrrrrrr1> it should compile
[11:07:00] <arrrrrrr1> it just takes very long
[11:07:12] *** Quits: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP) (Ping timeout: 121 seconds)
[11:08:32] <arrrrrrr1> man, cargo test is completely useless for multithreaded programs
[11:09:07] <Manishearth> why?
[11:09:19] <Manishearth> Use scoped threads
[11:09:23] <arrrrrrr1> because it doesn't have a --nocapture option.
[11:09:43] <arrrrrrr1> so if one thread deadlocks you can't see the panic in the other thread that caused the deadlock
[11:10:13] <Manishearth> ah
[11:10:33] <arrrrrrr1> of course this will automatically be fixed once test stops capturing anything
[11:11:48] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[11:12:12] *** Joins: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP)
[11:12:14] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[11:12:23] *** Quits: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[11:12:44] <arrrrrrr1> ~/rust/comm$ time cargo bench --no-run
[11:12:46] <arrrrrrr1>    Compiling comm v0.0.1 (file:///home/julian/rust/comm)
[11:12:48] <arrrrrrr1> cargo bench --no-run  60.34s user 0.43s system 99% cpu 1:01.18 total
[11:12:50] <arrrrrrr1> jesus christ
[11:14:10] *** Joins: doener (doener@moz-cpsld2.hsi08.unitymediagroup.de)
[11:14:40] <arrrrrrr1> doener: was there a compile time regression recently?
[11:15:23] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[11:16:43] <doener> arrrrrrr1: define "recently" ;-)
[11:16:53] <arrrrrrr1> one week
[11:17:27] <doener> nothing I recall
[11:17:48] <doener> which part is affected?
[11:17:57] <arrrrrrr1> cargo test
[11:18:52] <arrrrrrr1> I have a crate here that takes 33 seconds to compile with cargo test. I think it didn't take that long before.
[11:18:58] <doener> I meant, is it llvm, or type checking, or whatever
[11:19:05] <arrrrrrr1> let's see
[11:20:01] <arrrrrrr1> ohh, running rustc --test only takes 22 seconds
[11:20:11] <arrrrrrr1> maybe it's because cargo uses -g ?
[11:20:20] <arrrrrrr1> there was a change that fixed debuginfo handling
[11:20:31] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Connection closed)
[11:21:05] <theme> Are there any types that implement PartialEq or PartialOrd with Rhs that is not Self?
[11:21:36] <theme> I'm trying to deal with the issue quantheory pointed out here: https://github.com/rust-lang/rfcs/pull/956#discussion_r26022293
[11:23:28] *** Joins: ytain (ytain@moz-f5jvis.dsl.teksavvy.com)
[11:24:10] *** Joins: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP)
[11:25:32] <arrrrrrr1> doener: turns out it's the cargo overhead. cargo increases the compile time by 7 seconds
[11:25:46] <arrrrrrr1> just running the same command directly is 7 seconds faster
[11:25:56] <doener> woah
[11:26:08] <doener> that's a lot
[11:26:12] <arrrrrrr1> I was probably not using cargo before which is why it feels slower now
[11:26:20] <Manishearth> doener: btw!
[11:26:29] <Manishearth> close this!
[11:26:30] <Manishearth> https://github.com/rust-lang/rust/pull/23180
[11:26:34] <Manishearth> :)
[11:28:01] <arrrrrrr1> oh, it's probably because cargo test builds the library itself AND the test binary
[11:28:03] <arrrrrrr1> wtf
[11:29:07] <arrrrrrr1> yo, it does
[11:29:58] <theme> why do PartialEq and PartialOrd even need type parameters?
[11:30:15] <theme> is comparing with Self not enough?
[11:31:42] <Mutabah> theme: So you can compare with other types
[11:31:56] <Mutabah> e.g. BigInt with int
[11:33:16] <Manishearth> (if you want to)
[11:33:30] <Manishearth> thx, doener 
[11:33:37] <theme> Mutabah, there is a little problem here
[11:34:35] <theme> Mutabah, does PartialEq have to be transitively implemented?
[11:34:55] <theme> There is a rule that it must be symmetrically implemented already: http://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html
[11:35:33] <theme> My RFC ended up stumbling upon that
[11:35:34] <theme> https://github.com/rust-lang/rfcs/pull/956
[11:37:13] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[11:38:19] <huon> arrrrrrr1: cargo test runs doc tests, which need the library compiled
[11:39:02] * theme initially thought that huon was playing as a pirate
[11:39:33] <kimundi> theme: I guess with negative trait bounds the std lib could provide generic impls that ensure transitivity
[11:40:00] <kimundi> Wait, that might not work, hm...
[11:41:33] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[11:42:06] <arrrrrrr1> huon: are there doc benchmarks?
[11:42:12] <theme> kimundi, any ideas?
[11:42:45] <simukis> arrrrrrr1: this also applies to #[bench] and #[test] functions that may be inside the library
[11:43:06] <arrrrrrr1> simukis: rustc manages to run those without building the library
[11:43:37] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[11:44:15] <simukis> huon: any idea why after https://github.com/rust-lang/rust/pull/23206/files uses of print! complains about unstable anyway, even though Iâ€™ve added #[allow_internal_unstable] attribute? Iâ€™ll get you some output in a moment
[11:44:23] <simukis> arrrrrrr1: rustc runs tests?!
[11:44:35] <arrrrrrr1> simukis: when you compile with --test it does
[11:44:48] <simukis> does it really? /me goes to check.
[11:45:30] <arrrrrrr1> we're comparing cargo test --no-run and rustc --test so I hope you're not talking about actually running the executable which takes the same time for both
[11:46:09] <simukis> arrrrrrr1: > rustc manages to __run__ those without building the library
[11:46:12] <simukis> which is why it confused me
[11:46:43] <simukis> rustc does not build any dependencies itself and cargo is overzealous in building the dependencies
[11:46:45] <huon> arrrrrrr1: there's not doc benchmarks
[11:47:33] <huon> simukis: yeah, I'll need to see the output :)
[11:47:44] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[11:47:52] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:49:13] <arrrrrrr1> can rustc build a crate in parallel?
[11:49:34] <Manishearth> arrrrrrr1: how would it do that?
[11:49:40] <Manishearth> rustc only builds one crate at a time
[11:49:50] <Manishearth> or mor eaccurately
[11:49:55] <Manishearth> rustc's job is building a single crate
[11:50:01] <theme> arrrrrrr1, cargo can sometimes build crates in parallel
[11:50:04] <Manishearth> building multiple crate's is Cargo's job
[11:50:08] <Manishearth> and cargo does do this
[11:50:13] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[11:50:21] <arrrrrrr1> I'm talking about "a" crate, singular
[11:50:35] <Manishearth> Asking rustc to build crates in parallel doesn't make sense becasue rustc can't handle more than one crate at a time anyway. That's out of its domain
[11:50:37] <doener> arrrrrrr1: -C codegen-units=n
[11:50:39] <Manishearth> Ah
[11:50:41] <Manishearth> ^that
[11:50:43] <simukis> huon: https://pastebin.mozilla.org/8824869 some of the output
[11:50:50] <doener> arrrrrrr1: it's currently broken though, IIRC
[11:51:50] <doener> arrrrrrr1: and AFAIK it comes at the cost of potentially worse results because it might miss some optimizations across codegen units
[11:52:19] <huon> simukis: when do these errors occur?
[11:52:34] <simukis> huon: make check-stage1
[11:52:50] <simukis> huon: not sure building which crate exactly yet, because I run that with -j8
[11:52:54] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[11:53:21] <huon> simukis: I expect that those errors are output in stage0, and then disappear in later stages
[11:53:26] * doener still reads the post-install message as "Rust is ready to troll"
[11:53:39] <simukis> huon: ok, let me try to build till stage2 then
[11:53:40] <huon> simukis: (since the stage0 compiler doesn't understand the attribute)
[11:55:50] *** Quits: Sindriava (textual@moz-hegob1.wendulka.net) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:56:16] <arrrrrrr1> codegen-units=2 gives me an llvm assert. how sad
[11:57:24] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[11:59:13] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[11:59:30] *** Quits: imperio (Mibbit@moz-opqtbe.abo.bbox.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[12:03:06] *** Joins: Nekit1234007 (nekit@moz-vfr.64q.51.84.IP)
[12:04:01] *** Joins: Sindriava (textual@moz-hegob1.wendulka.net)
[12:10:06] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Quit: Leaving...)
[12:10:18] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[12:18:48] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[12:21:31] <simukis> huon: still getting https://pastebin.mozilla.org/8824873 in stage2
[12:22:15] *** Quits: Sindriava (textual@moz-hegob1.wendulka.net) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[12:22:56] <simukis> so this means that while it doesnâ€™t warn about `stdout()` used directly in println!, but stil warns about io::Write::write_fmt which is indirectly used in write!
[12:24:10] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[12:24:39] *** Joins: ctennis (ctennis@moz-su6.e72.137.99.IP)
[12:25:16] <huon> simukis: that is expected and by-design :)
[12:25:49] <huon> #[allow_internal_unstable] only applies to things directly contained in the given macro, and doesn't affect things introduced by nested macro calls
[12:26:00] <huon> adding the attribute to write! would fix it
[12:29:25] *** Quits: tedh (tedh@moz-ctbj7i.il.comcast.net) (Ping timeout: 121 seconds)
[12:30:40] <arrrrrrr1> what's the expected compile time improvement with codegen-units?
[12:35:59] <doener> arrrrrrr1: https://github.com/rust-lang/rust/pull/16367
[12:36:40] <arrrrrrr1> >2.3x
[12:36:42] <arrrrrrr1> holy shit
[12:36:49] <arrrrrrr1> how is fixing this not a high priority issue?
[12:37:07] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[12:37:48] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[12:37:49] *** ChanServ sets mode: +o pnkfelix
[12:37:54] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[12:38:30] *** Joins: Sindriava (textual@moz-hegob1.wendulka.net)
[12:38:33] *** Quits: Sindriava (textual@moz-hegob1.wendulka.net) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[12:40:05] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Quit: Leaving)
[12:42:16] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[12:42:36] <eddyb> arrrrrrr1: last I looked at it, it was broken during the move from task to thread or something
[12:43:16] <eddyb> arrrrrrr1: the driving part of it (~50 lines IIRC) needs to be updated to use JoinGuard
[12:43:25] <eddyb> not sure how much work has been done since
[12:44:37] <simukis> eddyb: AFAIR we codegen it not entirely corectly as well.
[12:44:56] * simukis unsure
[12:47:04] <arrrrrrr1> >error: Discriminant overflowed!
[12:47:06] <arrrrrrr1> that's a new one
[12:47:06] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[12:47:31] <arrrrrrr1> https://gist.github.com/anonymous/e7f09605bb13d6bfa28d
[12:47:34] <arrrrrrr1> god damn it
[12:48:14] <arrrrrrr1> even repr(i32) doesn't change it
[12:48:33] <eddyb> arrrrrrr1: the overflow is i64...
[12:48:44] <eddyb> oh
[12:48:45] <arrrrrrr1> so -1 + 1 is an overflow in i64?
[12:48:46] <eddyb> arrrrrrr1: haha
[12:49:01] <eddyb> arrrrrrr1: what if it's -1i32?
[12:49:03] <arrrrrrr1> anyway, repr(C) is c_int in this range
[12:49:03] <WindowsBunny> lol arrrrrrr1
[12:49:20] <WindowsBunny> repr(C) is a piece of shit for enums
[12:49:33] <WindowsBunny> I always use repr(i32) for winapi instead
[12:49:43] <arrrrrrr1> what's the difference?
[12:49:53] <eddyb> WindowsBunny: look what arrrrrrr1 said :|
[12:50:13] <eddyb> arrrrrrr1: the literal is not really typed, sadly
[12:50:20] <WindowsBunny> eddyb: Yeah I know, C style enums are shitty in Rust :P
[12:50:24] <arrrrrrr1> eddyb: literals have isize type iirc
[12:50:33] <arrrrrrr1> literals in enum discriminants
[12:50:42] <eddyb> still
[12:50:58] <eddyb> arrrrrrr1: have you tried -1i32?
[12:51:00] <huon> they're clearly some unsigned type
[12:51:11] <huon> (i.e. probably not isize)
[12:51:12] <arrrrrrr1> eddyb: same thing
[12:51:16] <eddyb> that's odd
[12:51:38] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[12:51:38] <eddyb> arrrrrrr1: is it the automatic increment, i.e. does it go away if you set the second one to 0?
[12:51:41] <arrrrrrr1> at least literals have size = sizeof isize
[12:51:44] <arrrrrrr1> which is also broken
[12:51:59] <eddyb> constant literals are not typed :P
[12:52:05] *** Joins: tedh (tedh@moz-bdfmnv.sub-70-194-71.myvzw.com)
[12:52:19] <arrrrrrr1> eddyb: it is the increment
[12:52:22] <arrrrrrr1> huon: https://gist.github.com/mahkoh/e15d29c1f891b05b7efc
[12:52:50] <eddyb> hmm
[12:52:54] <huon> weird that the compiler stores it differently to the type it states :)
[12:53:14] <eddyb> arrrrrrr1: is it an error or an ICE?
[12:53:17] <arrrrrrr1> error
[12:53:21] <eddyb> uhm...
[12:53:23] <arrrrrrr1> or wait
[12:53:28] <arrrrrrr1> let me check again just to make sure
[12:53:31] <eddyb> only const_eval makes nice errors
[12:53:40] <arrrrrrr1> yes, src/av/mod.rs:36:5: 36:13 error: Discriminant overflowed!
[12:53:45] <eddyb> and we don't use const_eval to increment the discriminants
[12:53:50] <doener> error, Disr is u64 so it's always unsigned
[12:53:54] <eddyb> oh we might be using
[12:53:57] <eddyb> doener: *sigh*
[12:54:16] <eddyb> would i64 hurt anything?
[12:54:22] <arrrrrrr1> you can't really do it as one fixed type. both u64 and i64 enums are possible
[12:54:31] <arrrrrrr1> you should probably store (sign, u64)
[12:54:44] <eddyb> we might need to make it unaware of signedness
[12:55:07] <eddyb> and have operations interpret that signedness
[12:55:30] <theme> i65?
[12:55:33] <arrrrrrr1> fun fact: you can't write all C enums in rust with repr(C)
[12:56:27] <huon> such as?
[12:56:38] <kimundi> Well, yeah. Using Rusts enums as C-style ones is doomed from the start, but for some reason people keep wanting to do and support it :P
[12:56:43] <pnkfelix> is anyone else having trouble connecting to play.rust-lang.org on firefox?  i am trying to figure out if this is a local problem for me, or something with Europe, or something world-wide
[12:56:52] <arrrrrrr1> oh my, it works when I remove the #[derive]
[12:57:03] <huon> pnkfelix: works for me
[12:57:03] <doener> pnkfelix: works for me (from Germany)
[12:57:05] <pnkfelix> (I am getting "Secure Connetion Failed" warnings.)
[12:57:15] <pnkfelix> Again, this is on Firefox for me; Chrome works
[12:57:18] <Yurume> pnkfelix: I had a problem from the workspace
[12:57:29] <arrrrrrr1> check this out: http://is.gd/jzYDxk
[12:57:30] <Yurume> but I used Chrome there
[12:57:31] <huon> pnkfelix: (I was testing in firefox)
[12:57:31] <doener> (using Iceweasel, i.e. Debian's Firefox)
[12:57:41] <huon> (nightly)
[12:57:41] <pnkfelix> okay.  mrrh.
[12:57:50] <theme> pnkfelix, there should be an advanced option somewhere
[12:57:54] <pnkfelix> (Firefox 36.0.1)
[12:57:56] <theme> to enter the site
[12:58:18] <theme> It's just a warning, right?
[12:58:32] <theme> pnkfelix, btw is it http or https?
[12:58:34] <pnkfelix> theme: I've seen that for other self-signed certificate type issues, but I am not seeing the option in this case
[12:58:37] <pnkfelix> theme: it is https
[12:59:00] <theme> why does playpen even need https?!
[12:59:09] <pnkfelix> theme: attempting to connect via http:// redirects to https://
[12:59:15] <theme> O_o
[12:59:23] <arrrrrrr1> https://github.com/rust-lang/rust/issues/23221
[12:59:33] <eddyb> I see the certificate issue but only on my phone
[12:59:56] <pnkfelix> eddyb: yeah I saw it on my tablet over the weekend
[13:00:10] <theme> hmmm... comodo RSA...
[13:02:00] *** Joins: srh (User@moz-kpck8b.public.wayport.net)
[13:02:25] <theme> arrrrrrr1, wtf is this bug?
[13:02:38] <eddyb> oh oh
[13:02:41] <arrrrrrr1> theme: just some integer overflow fallout
[13:02:43] <eddyb> arrrrrrr1: I know ho to debug this :D
[13:02:56] <theme> but seriously, -1 to 0 is an overflow?
[13:03:02] <theme> -2 to -1 doesn't overflow
[13:03:04] <huon> theme: that is why it is a bug
[13:03:09] <doener> theme: -1 as u64 + 1
[13:03:10] <huon> it shouldn't be happening
[13:03:16] <theme> lol
[13:03:21] <pnkfelix> theme: I'm betting internally we're doing what doener says
[13:03:21] *** Joins: bombless (bombless@moz-mpkd63.0v2u.0v40.0da8.2001.IP)
[13:03:44] <eddyb> arrrrrrr1: RUST_BACKTRACE=1 rustc -Z treat-err-as-bug
[13:04:00] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[13:04:11] <theme> apparently, there is nothing special about -1 except that it causes a bug
[13:05:02] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[13:05:03] <huon> there is a lot special about -1, especially in relation to this bug
[13:05:33] <theme> and that's quite a long issue name
[13:05:40] <doener> theme: two's complement, -1 is all ones, so interpreting it as u64 it's the largest possible number, add one and you get yourself an overflow
[13:05:47] <theme> doener, I know
[13:06:21] <theme> but it's still funny
[13:07:14] <eddyb> so what about a Copy impl triggers that bug?
[13:07:41] <theme> O_o
[13:07:55] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[13:09:02] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[13:09:19] <arrrrrrr1> why does this not work: http://is.gd/chiHOK
[13:09:53] <huon> is the Copy related?
[13:10:02] <pnkfelix> whoa that's wild
[13:10:04] <arrrrrrr1> not in this case
[13:10:08] <pnkfelix> I wonder if we make it zero-sized or somethning
[13:10:13] <arrrrrrr1> probably
[13:10:14] <huon> arrrrrrr1: https://github.com/rust-lang/rust/issues?q=is%3Aissue+is%3Aopen+unsupported+representation :)
[13:10:31] <arrrrrrr1> but repr should overwrite the zero size representation
[13:10:40] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[13:10:42] <arrrrrrr1> >Nov 5, 2013
[13:10:44] <arrrrrrr1> nice
[13:10:58] <doener> haha, repr(u32) rejects -1 for the discriminant, but repr(u64) doesn't
[13:10:58] <pnkfelix> no not zero-sized according to mem::size_of
[13:11:02] *** Joins: eddyb_ (eddyb@moz-hpe.8it.25.188.IP)
[13:11:16] *** Quits: eddyb (eddyb@moz-d6d.4h8.25.188.IP) (Ping timeout: 121 seconds)
[13:11:18] <arrrrrrr1> doener: what target?
[13:11:32] <doener> arrrrrrr1: x86_64
[13:12:04] <huon> arrrrrrr1: clearly it doesn't affect much non-trivial code, then
[13:12:06] <arrrrrrr1> doener: because on 32 bit you can't have enums larger than 32 bit anyway
[13:13:00] <arrrrrrr1> huon: clearly!
[13:16:09] <doener> arrrrrrr1: hm? That is unrelated to the target, Disr is always u64
[13:16:23] <arrrrrrr1> doener: enum discriminants must be isize
[13:18:05] <doener> arrrrrrr1: in rust? no
[13:18:30] <arrrrrrr1> playbot: std::u64::MAX
[13:18:32] -playbot- 18446744073709551615
[13:18:43] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Quit: Lost terminal)
[13:19:35] *** Quits: tedh (tedh@moz-bdfmnv.sub-70-194-71.myvzw.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[13:20:57] <arrrrrrr1> doener: you're right. repr(C) enum discriminants must be isize
[13:24:35] <arrrrrrr1> (which is incorrect)
[13:26:59] *** Joins: Zoxc (Zoxc@moz-g6sljr.bb.online.no)
[13:30:23] <arrrrrrr1> was there an issue about replacing usize/isize with more appropriate types?
[13:34:43] *** Joins: larhat (Adium@moz-8v4.af0.232.213.IP)
[13:38:05] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[13:38:35] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[13:38:39] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[13:39:14] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[13:40:07] <pnkfelix> arrrrrrr1: there was the audit, maybe that is what you are thinking of?
[13:40:22] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[13:40:38] <arrrrrrr1> I though there was an issue. Making repr(C) not take isize would have belonged there.
[13:41:16] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[13:43:00] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[13:44:16] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[13:45:46] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[13:45:55] <pnkfelix> arrrrrrr1: the audit was gh22240 but that was only about surveying the stdlib; this sounds like a distinct issue against rustc itself, maybe?
[13:45:55] <[o__o]> Audit integer types in the standard library: https://github.com/rust-lang/rust/issues/22240
[13:46:05] <arrrrrrr1> maybe
[13:47:00] *** Joins: Sindriava (textual@moz-jrsnms.fit.cvut.cz)
[13:48:52] <simukis> https://pastebin.mozilla.org/8824888 am I going crazy or this is really not supposed to work
[13:49:13] <eddyb_> simukis: staging?
[13:49:21] <eddyb_> hmm
[13:49:31] <eddyb_> I think there's a place you have to add the feature or something
[13:50:09] <simukis> wait, does #![feature] apply to #[macro_use] mods?
[13:51:58] <Gankro> With apologies to pczarn, can someone else review https://github.com/rust-lang/rust/pull/21973 ? I'm swamped with school
[13:52:54] *** Quits: srh (User@moz-kpck8b.public.wayport.net) (Quit: Leaving)
[13:54:29] <arrrrrrr1> >antisymmetry: if a < b then !(a > b) and vice versa;
[13:54:33] <arrrrrrr1> what does this mean?
[13:54:57] *** Joins: aochagavia (Mibbit@moz-jgp6eg.static.ziggozakelijk.nl)
[13:55:15] <aochagavia> what is a good way to debug compiler code? does calling println! work?
[13:55:48] <simukis> aochagavia: gdb
[13:55:54] <simukis> (or lldb)
[13:56:37] *** Quits: bombless (bombless@moz-mpkd63.0v2u.0v40.0da8.2001.IP) (Quit: Leaving)
[13:56:40] <aochagavia> how steep is the learning curve of gdb? I have never used it
[13:56:54] <cmr> aochagavia: shallow
[13:57:34] <cmr> "break" to set a breakpoint, "finish" to step out of a function, "step" to move forward one line, going into function calls if any, "next" to move forward one line skipping function calls if any, "cont" to continue execution normally.
[13:57:44] <cmr> "print x" to print the value of symbol x at that point
[13:57:52] <aochagavia> is it possible to inspect the value of a variable?
[13:58:13] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[13:58:22] <aochagavia> I see...
[13:58:50] <simukis> printing rust-compiled-values is non trivial. You need to have at least some knowledge of what rust structures look like when compiled
[14:00:11] <aochagavia> thanks for the help, I'll see how far I get
[14:01:24] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[14:02:18] *** Parts: aochagavia (Mibbit@moz-jgp6eg.static.ziggozakelijk.nl) ()
[14:03:14] *** Quits: Sindriava (textual@moz-jrsnms.fit.cvut.cz) (Connection closed)
[14:03:19] *** Joins: Sindriava (textual@moz-jrsnms.fit.cvut.cz)
[14:04:01] *** eddyb_ is now known as eddyb
[14:07:31] <simukis> huon: ping
[14:07:41] <SimonSapin> Do we have a blog post or something I can point to about what "stable" really means?
[14:08:09] <SimonSapin> what precise promises we are making or not about 1.0
[14:08:21] <pnkfelix> SimonSapin: let me look
[14:08:51] <pnkfelix> SimonSapin: I assume you do not find http://blog.rust-lang.org/2014/10/30/Stability.html sufficient ?
[14:09:24] <SimonSapin> Thanks, I was only looking at http://blog.rust-lang.org/2015/02/13/Final-1.0-timeline.html and http://blog.rust-lang.org/2014/12/12/1.0-Timeline.html
[14:15:15] <Gankro> arrrrrrr1: Antisymmetry just says that the < relation doesn't have cycles
[14:15:23] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[14:16:03] <WindowsBunny> Stuff related to exceptions under the MS ABI
[14:16:04] <WindowsBunny> http://reviews.llvm.org/rL231328
[14:16:24] <WindowsBunny> Might be useful for us for when we want to get better unwind support on windows
[14:16:26] <WindowsBunny> ricky26: ^
[14:20:47] <Zoxc> That's for C++ exceptions only?
[14:21:20] <WindowsBunny> yeah, but it shows how stuff like destructors and things work
[14:23:32] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[14:29:00] *** Parts: simukis (nagisa@moz-8t068g.static.zebra.lt) ("")
[14:29:00] *** Joins: eddyb_ (eddyb@moz-stt.82i.25.188.IP)
[14:29:03] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[14:29:05] *** Quits: eddyb (eddyb@moz-hpe.8it.25.188.IP) (Connection closed)
[14:30:23] *** Joins: ytain2 (ytain@moz-d93rt6.dsl.teksavvy.com)
[14:30:32] <arrrrrrr1> Gankro: I know what antisymmetry means, but I don't think that description is correct.
[14:30:38] <arrrrrrr1> the one on the docs
[14:31:00] *** Quits: ytain2 (ytain@moz-d93rt6.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[14:32:40] *** Quits: ytain (ytain@moz-f5jvis.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[14:35:23] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[14:36:21] <arrrrrrr1> <, >, <=, >=, and == are the only comparison operators, right?
[14:36:51] <goffrie> !=
[14:36:56] <arrrrrrr1> right, thanks
[14:39:32] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[14:39:57] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[14:47:32] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[14:50:14] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[14:50:25] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[14:50:58] *** Joins: petrochenkov (Mibbit@moz-4val3f.broadband.corbina.ru)
[14:53:42] *** Joins: evanfarrar (evanfarrar@moz-7vs.bl6.251.207.IP)
[14:56:50] <petrochenkov> Hi. In rustc_trans can ValueRef have an aggregate type like { i8*, i64 }? I had an impression that { i8*, i64 } should lie somewhere in memory and ValueRef can be a pointer to it - { i8*, i64 }*.
[14:57:23] <eddyb_> petrochenkov: first-class aggregates are a thing, so yes
[14:57:51] <eddyb_> (constants are nested aggregates and they're represented with ValueRef)
[15:01:34] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[15:01:51] *** Quits: Sindriava (textual@moz-jrsnms.fit.cvut.cz) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[15:05:33] <petrochenkov> Hm, I see. I read about them in LLVM docs but haven's seen them in trans so far.
[15:05:49] *** Joins: Sindriava (textual@moz-jrsnms.fit.cvut.cz)
[15:06:25] <petrochenkov> The problem is that the type of slice in match discriminant suddenly turned from { i8*, i64 }* to this { i8*, i64 } after seemingly unrelated changes in byte string literal patterns.
[15:08:32] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[15:08:33] *** ChanServ sets mode: +o brson
[15:09:23] <aturon> acrichto: when you're around, can we talk about https://github.com/rust-lang/rust/pull/23161
[15:10:13] <aturon> SimonSapin: as a follow-up to pnkfelix's response, we also plan to clarify exactly what kinds of changes are allowed to stable APIs via an RFC during the beta period
[15:10:25] <SimonSapin> aturon: ok, cool
[15:10:40] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Client exited)
[15:10:49] <SimonSapin> aturon: btw, weâ€™re not at "All 1.0 modules stable on nightly" yet, right?
[15:11:08] <aturon> SimonSapin: not quite, but we should be there this week
[15:11:14] <SimonSapin> ok
[15:11:16] <aturon> SimonSapin: https://github.com/rust-lang/rust/issues/22500
[15:11:26] <SimonSapin> and is `test` part of this?
[15:11:51] <aturon> SimonSapin: no, i believe that test was going to be provided via crates.io
[15:12:17] <SimonSapin> aturon: how would that work with `rustc --test` or `cargo test`?
[15:13:07] <aturon> SimonSapin: I believe the plan was to keep some internal version as well, but I'm not sure of the details -- acrichto has been managing non-std/facade crates and he could tell you more
[15:13:17] <aturon> SimonSapin: (he should be around in a little while)
[15:16:23] <pnkfelix> has anyone else seen the debug info tests fail when run from compiletest, but manually running the test under lldb and recreating the steps works?
[15:16:49] *** Joins: c0170_ (c0170@moz-bb29a4.cambridge.arm.com)
[15:16:58] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[15:16:59] <pnkfelix> (I assume that my manual recreation is not faithful in some way, but I am putting off dissecting compiletest itself until absolutely necessary)
[15:19:19] *** Quits: Sindriava (textual@moz-jrsnms.fit.cvut.cz) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[15:19:49] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[15:21:06] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[15:25:51] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[15:26:48] <pnkfelix> (and even running the python driver script by hand works too. Seems like something must be up with my environment, or with how compiletest is firing off subprocesses)
[15:27:18] *** Joins: kmcguire_ (kmcguire@moz-pg1gb9.biz.rr.com)
[15:27:26] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[15:29:34] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[15:29:37] *** Quits: Kxepal (Miranda@moz-dk82d1.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[15:30:19] *** Quits: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com) (Ping timeout: 121 seconds)
[15:31:00] *** Joins: Kxepal (Miranda@moz-ml537c.pppoe.mtu-net.ru)
[15:31:36] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[15:31:44] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[15:34:07] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[15:34:35] <arrrrrrr1> it turns out that Rust's <= operator is completely broken
[15:34:45] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[15:34:54] <arrrrrrr1> it makes guarantees that are not just hard but *impossible* to implement
[15:35:52] <arrrrrrr1> how is it called when a trait cannot be implemented for a type if neither are defined in my crate?
[15:36:36] <arrrrrrr1> coherence rules
[15:36:44] <arrrrrrr1> coherence rules and the <= are fundamentally incompatible
[15:36:58] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[15:38:45] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[15:40:21] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[15:44:02] *** Quits: petrochenkov (Mibbit@moz-4val3f.broadband.corbina.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[15:47:11] <SimonSapin> arrrrrrr1: what guarantees?
[15:47:30] <acrichto> aturon: I'm here now
[15:47:37] <arrrrrrr1> SimonSapin: I'm writing it down right now. Give me another hour max.
[15:47:49] <SimonSapin> acrichto: https://github.com/rust-lang/rust/issues/22500#issuecomment-77876882
[15:48:13] <acrichto> SimonSapin: for now I don't think we're actually planning to move it out, but we're also not planning to make it stable
[15:48:27] <acrichto> SimonSapin: this means we don't have a great story for benchmarks, but we do have a stable story for #[test]
[15:48:34] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Quit: leaving)
[15:48:59] <arrrrrrr1> there should probably be a better story for test so that people can use other test frameworks that plug into rustc
[15:49:11] <arrrrrrr1> so the test framework exposes a certain api and rustc does the rest
[15:50:00] <aturon> arrrrrrr1: that's the long-term plan for sure
[15:50:05] <SimonSapin> acrichto: I support libraries can have benchmarks behind a Cargo feature disabled by default
[15:50:13] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[15:50:17] <SimonSapin> s/support/suppose/
[15:50:23] <aturon> acrichto: did you have a PR to do something more aggressive than that before?
[15:50:37] <arrrrrrr1> aturon: it's already possible when you pass --extern=blabla to rustc where blabla is a crate named test. but that's probably accidental
[15:50:50] <arrrrrrr1> and the interface is not documented
[15:50:56] <arrrrrrr1> (or only somewhat documented)
[15:51:00] <acrichto> aturon: I don't have a PR but we do have plans
[15:51:01] <arrrrrrr1> (not stable at least)
[15:51:35] <aturon> arrrrrrr1: yeah, i think the stabilization of the command-line args is an ongoing thing
[16:00:19] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:01:44] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:02:18] *** Joins: Sindriava (textual@moz-jrsnms.fit.cvut.cz)
[16:02:30] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[16:03:37] <acrichto> aturon: btw Ihttps://github.com/rust-lang/rust/issues/22932 has me a little worried
[16:03:50] <acrichto> aturon: I'm not sure we'll want to stabilize precisely that interface of panic!()
[16:04:00] <acrichto> the whole panic-with-anything-if-only-one-argument
[16:04:10] <acrichto> I had forgotten you can do something like panic!(4)
[16:04:30] <aturon> acrichto: yes, we need to resolve that
[16:04:41] <aturon> acrichto: maybe its priority should be updated
[16:04:58] <acrichto> hm yes I'll switch to P-high
[16:05:03] <acrichto> for specifically that case
[16:05:04] <aturon> acrichto: after we get the major stability stuff wrapped up early this week, we should go through the P-backcompat-libs 1.0 beta stuff
[16:05:15] <acrichto> agreed
[16:08:15] *** Joins: vadimcn (uid46608@moz-o7asbu.uxbridge.irccloud.com)
[16:11:27] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Connection closed)
[16:16:37] *** Quits: Sindriava (textual@moz-jrsnms.fit.cvut.cz) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:17:28] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[16:17:56] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[16:19:42] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[16:20:29] <simukis> does anybody else know anything about allow_internal_unstable attribute?
[16:21:33] *** Joins: ytain (ytain@moz-d93rt6.dsl.teksavvy.com)
[16:22:04] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[16:23:35] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[16:26:01] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:30:40] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[16:33:00] <munksgaard> eddyb_: ping
[16:34:45] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[16:34:46] *** ChanServ sets mode: +o pnkfelix
[16:44:16] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[16:45:33] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:45:33] *** ChanServ sets mode: +o pcwalton
[16:46:28] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[16:46:39] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:46:39] *** ChanServ sets mode: +o pcwalton
[16:46:42] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:46:47] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[16:47:38] *** Quits: c0170_ (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[16:48:45] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[16:50:49] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[16:51:13] *** Joins: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP)
[16:52:21] *** Joins: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com)
[16:52:42] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Ping timeout: 121 seconds)
[16:53:59] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:53:59] *** ChanServ sets mode: +o pcwalton
[16:55:20] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[16:55:53] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:55:53] *** ChanServ sets mode: +o pcwalton
[16:56:03] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[16:56:14] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[16:56:19] *** Joins: pcwalton (pcwalton@moz-7fd.v3g.198.71.IP)
[16:56:19] *** ChanServ sets mode: +o pcwalton
[16:57:40] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[16:58:06] <sfackler> simukis: i've poked around with it a bit
[17:01:25] <kmc> erickt: I'm starting an experimental project that needs fast auto-(de)serialization; should I use serde2?
[17:02:46] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[17:03:21] *** Joins: James (quassel@moz-5qldmp.range109-148.btcentralplus.com)
[17:05:58] *** Joins: Guest63_ (textual@moz-qfs.570.70.83.IP)
[17:06:28] *** Quits: {0}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[17:06:34] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Ping timeout: 121 seconds)
[17:06:42] <arrrrrrr1> Gankro: why does HashMap require Eq?
[17:06:55] <cmr> arrrrrrr1: hash collisions.
[17:07:00] *** Quits: Guest63_ (textual@moz-qfs.570.70.83.IP) (Connection closed)
[17:07:00] *** Joins: Guest63 (textual@moz-6gq.t8s.78.166.IP)
[17:07:09] <arrrrrrr1> sure but why is PartialEq not good enough?
[17:08:18] <arrrrrrr1> Eq is not stronger than PartialEq except for Copy types and even then it's not more powerful in almost all situations
[17:09:01] <kimundi> hu? how is Copy relevant there?
[17:09:04] <cmr> you need a == a, otherwise you'll insert a value, collide, and never get it back out.
[17:09:13] *** Joins: scialex (scialex@moz-j5mi8i.cs.brown.edu)
[17:09:25] <arrrrrrr1> cmr: a == a only makes sense for copy types. if you insert a non-copy type, a is no longer accessible
[17:09:32] <arrrrrrr1> so you can't call .get(a)
[17:09:38] *** Quits: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[17:09:55] <cmr> eh? Clone, and other means of constructing identical values shouldn't be ruled out.
[17:10:08] <nathan7> PartialEq would lead to memory leaks, no? You'd be able to insert an infinite amount of NaNs
[17:10:22] <erickt> kmc: serde2 is now serde! :D
[17:10:24] <arrrrrrr1> the rules for Eq say "a == a".
[17:10:34] <nathan7> yes
[17:10:42] <cmr> the method takes references...
[17:10:45] <arrrrrrr1> it makes no sense to say that is true for, uh, other a
[17:10:46] <erickt> kmc: I actually released a proper crate last night
[17:10:56] <Gankro> nathan7: Yeah, infinite NaNs for sure
[17:11:06] <erickt> kmc: currently porting burntsushi's cbor over to it
[17:11:08] <arrrrrrr1> cmr: so you're practically interpreting the rule as `a == a` if `a == a`
[17:11:21] <cmr> arrrrrrr1: no, that would be symmetricity.
[17:11:31] <Manishearth> Copy has nothing to do with this
[17:12:05] <erickt> kmc: how fast of a serialization do you want though? if super duper fast, you probably should at least check out capnproto
[17:12:07] <Gankro> arrrrrrr1: If you insert a value that a != a, you litterally would never find it on a lookup
[17:12:14] <Manishearth> ^
[17:12:26] <erickt> kmc: I'm curious though how bincode will do when it's ported to serde
[17:12:27] <arrrrrrr1> the point is that you cannot define what this `a == a` even means except locally. the rule does not require `let b = a; b == a`.
[17:12:59] <arrrrrrr1> Gankro: I'm aware but I don't see the problem.
[17:13:15] <arrrrrrr1> memory leaks are not an unsafety issue
[17:13:36] <Gankro> arrrrrrr1: It's not requiring Eq for memory safety
[17:13:45] <Gankro> It's requiring it for foot-gun avoidance
[17:13:50] <kmc> erickt: thanks
[17:14:03] <kmc> i think i will use bincode for now
[17:14:04] <arrrrrrr1> like having a hashmap with f64 keys.
[17:14:06] <erickt> kmc: whatcha serializing?
[17:14:12] <kmc> don't want to write external schemas like capnp
[17:14:21] <erickt> :)
[17:14:30] <Gankro> If you want to assert that your PartialEq type is *really* Eq for you, then you can newtype accordingly
[17:14:39] <kmc> erickt: I'll let you know if/when it works ;)
[17:14:42] <Gankro> Opting into the footgun
[17:14:54] <arrrrrrr1> true
[17:14:55] <erickt> kmc: yeah capnp is certainly not free to use
[17:15:21] <kimundi> arrrrrrr1: Anyway, the Eq trait takes references, so you can require that a == a for any a, because its actually (&a).eq(&a)
[17:16:11] <arrrrrrr1> kimundi: not if you've inserted a into the map. because then you have to call .get with another a
[17:16:39] <kimundi> which can still be the same one logically
[17:16:56] *** Quits: pcwalton (pcwalton@moz-7fd.v3g.198.71.IP) (Client exited)
[17:16:56] <kimundi> would you argue that 5 and 5 are different a's?
[17:17:07] <arrrrrrr1> "the same": you mean `==`. now we're again at the `a == a` if `a == a` ("logically")
[17:17:56] <kimundi> The whole thing depends on having a defined notion of what the identity of a value is supposed to be in regard to a total order
[17:18:43] <Gankro> bits(a) = bits(b) -> a == b?
[17:19:04] <kimundi> So its just "a == a (logically)", because any other interpretation of a == a is not defined to begin with
[17:20:04] <kimundi> Gankro: That would be one possible definition for a type
[17:20:31] <kimundi> Gankro: Like, thats the definition of integers, but not of floats
[17:20:51] <arrrrrrr1> Gankro: no, NaN
[17:21:13] <Gankro> are there multiple bit patterns for NaN?
[17:21:16] <arrrrrrr1> not true for slices either
[17:21:27] <arrrrrrr1> Gankro: they are the same but the RHS does not hold
[17:21:35] <kimundi> Gankro: Yes, and also the same one still compares to false
[17:21:37] <arrrrrrr1> the bits are the same
[17:21:38] <Gankro> arrrrrrr1: .... which is why it's not Eq
[17:21:57] <cmr> bits(a) = bits(b) -/> a == b
[17:21:59] <arrrrrrr1> Gankro: but you said `bits(a) = bits(b) -> a == b` which does not hald for NON
[17:22:01] <arrrrrrr1> *NAN
[17:22:02] <cmr> consider Box<T>
[17:22:15] <Gankro> arrrrrrr1: I'm saying that's the req for Eq
[17:22:21] <arrrrrrr1> Gankro: it's not
[17:22:25] <kimundi> Gankro: Thats wrong then
[17:22:33] <arrrrrrr1> &1 == &1
[17:22:40] <arrrrrrr1> (and they are Eq I'd hope)
[17:22:41] *** Quits: laumann (laumann@moz-fso.hq0.225.130.IP) (Ping timeout: 121 seconds)
[17:22:45] <kimundi> They are
[17:23:00] <cmr> The bit representation of a value has nothing to do with Eq
[17:23:09] <cmr> you can implement eq as `true` and be correct.
[17:23:16] <Gankro> Well obviously it doesn't hold in general (although i could hand-waive "behind a pointer and with irrelevant fields ignored")
[17:23:18] <kimundi> playbot: let a = &1; let b = &1; (a == b, a as *const _, b as *const _)
[17:23:19] -playbot- (true, 0x7ff93241b080, 0x7ff93241b080)
[17:23:36] <arrrrrrr1> silly optimization
[17:23:41] <kimundi> (darn optimizations :P)
[17:23:46] <Gankro> kimundi: Hah, optimization wins!
[17:24:12] <kimundi> playbot: let a = Box::new(1); let b = Box::new(1); (&*a == &*b, &*a as *const _, &*b as *const _)
[17:24:13] -playbot- (true, 0x7ff42b023008, 0x7ff42b023018)
[17:24:15] <Gankro> But bits(a) = bits(b) is a decent intuitive notion
[17:24:23] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
[17:24:32] <kimundi> Gankro: For a given type, maybe
[17:24:38] <Gankro> cmr: Eq = true actually satisfies my condition
[17:24:41] <kimundi> Gankro: But there are exceptions in both directions
[17:25:27] <Gankro> Actually no I litterally can't think of *anything* for which my statement is false
[17:25:55] *** Quits: Murarth (Murarth@moz-c6ubhh.phnx.qwest.net) (Quit: I have come here to chew bubblegum and kick ass. And I'm all out of bubblegum.)
[17:25:58] <Gankro> bits(a) = bits(b) means they are indistinguishable since in Rust you can't include your address as your identity
[17:26:01] <cmr> All implementors of Eq will need to satisfy that condition, since equality is extrinsic.
[17:26:21] *** Joins: Murarth (Murarth@moz-na7fhc.dyn.nltelcom.net)
[17:26:30] <Gankro> So actually I totally stand by bits(a) = bits(b) -> a = b
[17:26:55] <kimundi> Gankro: I guess... But only for Eq, not for PartialEq
[17:27:01] <cmr> But == ties into PartialEq! :P
[17:27:14] <Gankro> cmr: Did I write a ==?
[17:27:31] <cmr> No, but there's no comparison = operator in Rust
[17:27:37] <kimundi> Fine, only for {Eq, PartialEq}, not {PartialEq} :P
[17:27:53] <Gankro> kimundi: Yeah but PartialEq is like no-rules, right?
[17:28:00] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[17:28:22] <cmr> the only thing PartialEq doesn't have is reflexivity.
[17:28:35] <imperio> acrichto: what test / error message were you talking about ? gh23156
[17:28:35] <[o__o]> Remove proc keyword: https://github.com/rust-lang/rust/pull/23156
[17:28:35] <Gankro> 0.o weird
[17:28:37] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[17:29:15] <kimundi> Yeah, that sounds weird :P
[17:30:00] *** Joins: nodweber_ (nodweber@moz-knt.fgq.178.5.IP)
[17:30:14] <Gankro> What's the use in having PartialEq kinda-well-behaved?
[17:30:19] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Connection closed)
[17:30:31] <cmr> It specifies the behavior of floats accurately.
[17:30:34] *** Joins: pcwalton (pcwalton@moz-u92.384.6.71.IP)
[17:30:34] *** ChanServ sets mode: +o pcwalton
[17:30:59] <Gankro> cmr: So? Floats can specify whatever they want.
[17:31:07] <Gankro> On their own terms
[17:35:59] *** Quits: Guest63 (textual@moz-6gq.t8s.78.166.IP) (Ping timeout: 121 seconds)
[17:38:11] *** Joins: Guest63 (textual@moz-6gq.t8s.78.166.IP)
[17:42:25] <acrichto> imperio: the test that you removed, it would perhaps be nice to ensure that the syntax continues to not parse, it just has an updated error message
[17:44:07] <kimundi> cmr: It makes sense to me to have Eq be defined as being equivalence on a total order, and PartialEq as operator overload for == and to be usable with floats. But defining PartialEq in terms of floats seems weird
[17:44:09] <imperio> acrichto: this one ? https://github.com/rust-lang/rust/pull/23156/files#diff-bc5ce65fef82d909db2d80d2c4ecbb0fL1
[17:44:26] <cmr> kimundi: I agree completely.
[17:44:35] *** Joins: japaric (japaric@moz-6af.asf.237.190.IP)
[17:44:38] <imperio> acrichto: or this one https://github.com/rust-lang/rust/pull/23156/files#diff-bc5ce65fef82d909db2d80d2c4ecbb0fL1 ?
[17:44:44] <imperio> sorry but I'm kinda confused
[17:46:38] *** Joins: Guest63_ (textual@moz-qfs.570.70.83.IP)
[17:46:45] *** Quits: Guest63 (textual@moz-6gq.t8s.78.166.IP) (Ping timeout: 121 seconds)
[17:49:02] <Yurume> FYI: I think I've almost completed floating point to decimal portion of rust-strconv: https://github.com/lifthrasiir/rust-strconv#flt2dec
[17:49:39] <Yurume> I think this will become a (big) PR in the future, but anyone interested may review this first. :)
[17:49:55] <Yurume> at least, it is fast.
[17:50:51] *** japaric is now known as japaric|afk
[17:52:41] *** Quits: scialex (scialex@moz-j5mi8i.cs.brown.edu) (Quit: Leaving)
[17:52:56] *** Quits: Murarth (Murarth@moz-na7fhc.dyn.nltelcom.net) (Quit: Screw you guys. I'm going home.)
[17:53:11] *** Joins: Murarth (Murarth@moz-c6ubhh.phnx.qwest.net)
[17:54:11] *** Joins: ^BR (br@moz-egk.dm6.194.78.IP)
[17:56:12] *** Quits: nodweber_ (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[17:57:09] <arrrrrrr1> SimonSapin: https://github.com/rust-lang/rfcs/pull/956#issuecomment-77906756
[17:57:19] <arrrrrrr1> ^ regarding PartialOrd, PartialEq, etc.
[18:01:12] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[18:01:16] *** Quits: Guest63_ (textual@moz-qfs.570.70.83.IP) (Ping timeout: 121 seconds)
[18:01:44] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Quit: leaving)
[18:01:59] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[18:02:54] *** Quits: pcwalton (pcwalton@moz-u92.384.6.71.IP) (Client exited)
[18:03:21] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Connection closed)
[18:03:28] <acrichto> imperio: those were the same link? it doesn't really matter what test so long as there is a test that the syntax no longer parses
[18:06:08] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[18:06:10] *** Quits: doener (doener@moz-cpsld2.hsi08.unitymediagroup.de) (Quit: leaving)
[18:10:53] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[18:15:17] *** Joins: jxv (jxv___@moz-2celrt.res.rr.com)
[18:18:27] <imperio> acrichto: ok, thx
[18:22:22] *** Joins: bstrie (ben@moz-avu3ju.members.linode.com)
[18:22:22] *** ChanServ sets mode: +o bstrie
[18:24:21] <pnkfelix> cmr: kimundi: I suspect the solution here is to divorce our operator-overloading system from the traits that are used to attach semantic meaning to those operators.
[18:24:29] <pnkfelix> cmr: kimundi: there was an RFC about this, let me see ...
[18:25:22] <pnkfelix> i think this RFC is the relevant one: https://github.com/rust-lang/rfcs/pull/399
[18:25:24] <bstrie> Gankro: regarding http://www.reddit.com/r/rust/comments/2yfc41/how_much_memory_does_a_struct_with_optional_field/cp99lfx , I don't think this optimization is actually implemented yet
[18:25:34] <cmr> pnkfelix: I feel like we've had this same discussion before and came to the same consensus.
[18:26:10] <pnkfelix> cmr: when/if that's done, maybe we'll just deprecate PartialEq.  I dunno.
[18:26:33] <cmr> bstrie: Luqman implemented it.
[18:27:08] *** Quits: o11c (ben@moz-9bd9kh.customer.t3.se) (Ping timeout: 121 seconds)
[18:27:33] <pnkfelix> Weird, my debuginfo problem does not show up during `make check-stage2`; only `make check-stage1` ...
[18:27:52] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[18:27:52] *** ChanServ sets mode: +o nrc
[18:28:26] <steveklabnik> brson: thank you for multirust, i've been using it for a week and it's been wonderful
[18:28:56] <cmr> +1
[18:29:15] <cmr> and a +3 from the people here who use rust and also appreciate it
[18:30:51] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Connection closed)
[18:31:34] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[18:31:35] *** ChanServ sets mode: +o pnkfelix
[18:33:23] <bstrie> cmr: is it in the nightlies yet? because the optimization isn't happening with the latest nightly
[18:34:34] <Manishearth> cmr: close please
[18:34:34] <Manishearth> https://github.com/rust-lang/rust/pull/23210
[18:35:04] <cmr> richo beat me
[18:36:26] *** Joins: arielb1 (Ariel@moz-804827.red.bezeqint.net)
[18:36:50] <richo> hah
[18:37:26] <richo> sorry Manishearth, I've been trying to be really diligent about getting my commits neat on rust, so I normally rebase the snot out of my PR's. Next time if it's in a rollup I'll just add fixes to the branch though
[18:37:32] <Manishearth> richo: it's okay :)
[18:37:33] *** Quits: rovar (rovar@moz-m2j7h0.dyn.optonline.net) (Connection closed)
[18:37:34] <richo> thanks for sheparding those branches out for me!
[18:37:55] <Manishearth> even if you rebase, just letting me know about the fix is enough
[18:38:04] <Manishearth> I believe in this specific case I actually fixed it before you did
[18:38:20] <Manishearth> usually I comment on the PRs which I fix with a link to the fix commit
[18:38:29] <Manishearth> this time I didn't because I did it from a phone 
[18:38:36] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Connection closed)
[18:38:37] <richo> yeah, I saw your fix
[18:38:42] <richo> and then rebased it into my branch
[18:38:57] <richo> (Specifically because my branch was next in line after the rollup, and if the rollup failed I didn't want to waste builder time)
[18:39:00] <Manishearth> yeah
[18:39:02] <Manishearth> it's strange though
[18:39:04] <richo> otherwise I wouldn't have bothered
[18:39:07] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[18:39:08] *** ChanServ sets mode: +o pnkfelix
[18:39:15] <Manishearth> usually github shows "no changes" when this happens
[18:39:30] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[18:39:36] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[18:39:43] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[18:39:48] <Luqman> cmr: no bstrie is right, the opt doesn't go through enums currently.
[18:39:49] <pnkfelix> wow my attempts to run a bunch of `make check-stage1-debuginfo-lldb` somehow keeps killing my OS X kernel
[18:40:14] <pnkfelix> (time to try just one and see if that can at least run)
[18:40:53] *** Joins: o11c (ben@moz-9bd9kh.customer.t3.se)
[18:41:28] <bstrie> Luqman: do you happen to be working on that? :)
[18:42:24] <Luqman> bstrie: no, not at the moment :P
[18:42:26] *** Joins: laumann (laumann@moz-n9e72h.0.fullrate.dk)
[18:42:48] <richo> pnkfelix: actually paniccing? Do you have a stack?
[18:43:00] * richo is a purveyor of fine XNU crashes
[18:43:11] <richo> it was faulting lldb on me the other day
[18:43:51] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Connection closed)
[18:43:53] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[18:43:53] *** ChanServ sets mode: +o pnkfelix
[18:44:55] *** Quits: o11c (ben@moz-9bd9kh.customer.t3.se) (Ping timeout: 121 seconds)
[18:46:12] <pnkfelix> (and in fact, running even just one seems to have killed my kernel.)
[18:46:31] <pnkfelix> richo: sorry, I missed your message before, because my machine died
[18:47:17] <pnkfelix> richo: this is not a panic; the tests are failing, but the output seems to indicate that they are failing because e.g. the attempt to run the command `p *a` fails to find the symbol `a`.  (it *is* able to set the requested break points AFAICT)
[18:48:29] <richo> wait, sorry
[18:48:42] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[18:48:43] <richo> if the tests are failing, how is it killing your kernel?
[18:48:47] <richo> I think I'm confused
[18:53:15] <lahwran> who would I have to talk to to get a newer android builder, or the current one updated to android 21? android made a backwards-incompatible change (requiring PIE executables, as opposed to simply allowing them) and it's not getting tested against the new version with this restriction
[18:53:16] <pnkfelix> richo: well, on one git clone, the tests are failing, and that's all that is happening
[18:53:32] <pnkfelix> richo: but when I backtracked to git master, and tried running the tests there
[18:53:38] <pnkfelix> richo: it consistently kills my machine
[18:53:43] <pnkfelix> richo: https://github.com/rust-lang/rust/issues/23227
[18:53:54] <pnkfelix> caveat: this is an older version of the OS
[18:54:37] *** Joins: {0}grant ({0}grant@moz-63ubas.in.charter.com)
[18:54:41] <richo> fascinating. If you wanted to grab a crashdump I Would be super interested in looking at it
[18:54:58] <pnkfelix> richo: do you know where OS X stashes them?
[18:55:03] *** Quits: Kxepal (Miranda@moz-ml537c.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[18:55:15] <imperio> acrichto: can you re-take a look please ? is that what you wanted me to do ? gh23156
[18:55:15] <[o__o]> Remove proc keyword: https://github.com/rust-lang/rust/pull/23156
[18:55:29] <pnkfelix> (i keep hitting the "Send report to Apple" button on the crash reporter, but forgetting to try to archive the dialog box)
[18:55:36] <richo> pnkfelix: it should be in /Library/Logs/DiagnosticReports if you still have it
[18:57:37] <bstrie> Luqman: care to comment with details? https://github.com/rust-lang/rust/issues/23228
[18:58:46] *** Joins: nodweber_ (nodweber@moz-knt.fgq.178.5.IP)
[18:59:23] *** Joins: Kxepal (Miranda@moz-ml537c.pppoe.mtu-net.ru)
[19:00:02] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Quit: rcirc on GNU Emacs 24.3.92.1)
[19:00:42] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[19:02:16] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[19:07:32] <nrc> acrichto, aturon, nmatsakis: could someone merge type ascription RFC please? https://github.com/rust-lang/rfcs/pull/803
[19:07:41] *** Joins: o11c (ben@moz-9bd9kh.customer.t3.se)
[19:08:29] *** Quits: rustical (dida@moz-55rvi2.dclient.hispeed.ch) (Ping timeout: 121 seconds)
[19:08:30] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[19:08:30] *** ChanServ sets mode: +o pcwalton
[19:09:09] *** Joins: mr_boo (Mibbit@moz-juv.9o3.252.72.IP)
[19:10:04] <aturon> nrc: did you talk to wycats about it yet?
[19:11:05] <aturon> (afaik he hasn't replied on the thread yet, just want to make sure he's satisfied about his concerns)
[19:13:30] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Quit: Leaving)
[19:13:41] *** Quits: {0}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[19:16:33] <nrc> aturon: he commented (https://github.com/rust-lang/rfcs/pull/803#issuecomment-77572297) and nmatsakis replied
[19:16:44] <nrc> I guess I could reply too
[19:17:04] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[19:18:11] <eddyb_> nrc: \o
[19:18:43] *** Quits: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com) (Ping timeout: 121 seconds)
[19:18:47] <eddyb_> nrc: I was wondering if there was any progress with DST coercions. I hope I mentioned I am fine with something marked unstable for 1.0
[19:19:44] <nrc> eddyb_: Yeah, I've been discussing with nmatsakis, I think we almost happy with a design based around automatic coercions (like DST5, but simpler) and a trait to opt-in
[19:20:01] <nrc> I should write it up, probably tomorrow
[19:20:02] <nmatsakis> nrc: I hadn't merged because I was hoping to hear more from wycats, I imagine he was pretty busy last week due to emberconf, I'll try to ping him some more
[19:20:29] <nrc> nmatsakis: ok, I'm just writing a reply to him now
[19:21:09] *** Joins: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com)
[19:21:12] <eddyb_> nrc: <3
[19:21:24] <eddyb_> kimundi: ^ things are looking up
[19:21:58] *** Joins: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at)
[19:24:14] *** Quits: arielb1 (Ariel@moz-804827.red.bezeqint.net) (Ping timeout: 121 seconds)
[19:24:48] *** Joins: arielb1 (Ariel@moz-804827.red.bezeqint.net)
[19:29:43] *** Joins: eerie (eerie@moz-nbbdu3.red.bezeqint.net)
[19:32:29] *** Quits: larhat (Adium@moz-8v4.af0.232.213.IP) (Quit: Leaving.)
[19:35:07] *** Joins: apasel422 (Mibbit@moz-vehgv3.ma.comcast.net)
[19:36:28] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Ping timeout: 121 seconds)
[19:38:57] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[19:39:25] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[19:43:40] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[19:45:54] <kimundi> nrc: Curious, can you give a short explanation why opt-in trait at all, if automatic coercion works?
[19:46:35] <nrc> kimundi: because coercion is scary and we don't want structs stumbling into it by accident
[19:46:42] *** Quits: laumann (laumann@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[19:47:05] <nrc> also conservative - we can remove opt-in backwards compatibly, but not add it
[19:47:06] <kimundi> nrc: makes sense
[19:47:52] *** Joins: laumann (laumann@moz-n9e72h.0.fullrate.dk)
[19:50:34] <nmatsakis> kimundi: I'd favor opt-in for an additional reason
[19:50:43] <kimundi> nmatsakis: Oh?
[19:51:06] <nmatsakis> I'd like it to be that, by default, if you have a struct with a field of type `T`, you can change that field to the type `Box<T>` without breaking clients
[19:51:13] <nmatsakis> this seems like a reasonable refactoring to want to do 
[19:51:18] <nmatsakis> (and by extension Vec<T>)
[19:51:24] <nmatsakis> in particular it preserves the ownership model
[19:51:36] <nmatsakis> this would not be true if we silently opted you in to automatic coercions
[19:51:48] <nmatsakis> seems "anti-abstraction" to me
[19:51:53] <kimundi> Hm... Can you give an example?
[19:51:55] <nmatsakis> exposing details of your type you did not agree to expose
[19:52:10] <nmatsakis> sure, you could not change
[19:52:29] <nmatsakis> struct Foo<T> { field1: u32, field2: u32, data: *const T }
[19:52:29] <nmatsakis> to
[19:52:42] <nmatsakis> struct Foo<T> { data: Box<FooInternal<T>> }
[19:52:50] <nmatsakis> struct FooInternal<T> { field1: u32, field2: u32, data: *const T }
[19:53:06] <nmatsakis> because we can't autocoerce the thin pointer when it's in the heap
[19:53:14] <nmatsakis> er, we can't convert the thin ptr to fat
[19:53:26] <nmatsakis> you mgiht want to do this to reduce the footprint on your stack etc
[19:53:33] <kimundi> Ah, of course
[19:53:49] <nmatsakis> I've got forwards compat on the brain lately ;)
[19:54:16] *** Quits: laumann (laumann@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[19:54:48] <kimundi> nmatsakis: Hm, so would it be able to support that refactoring at all?
[19:55:00] <kimundi> nmatsakis: With any of the schemes?
[19:55:24] <kimundi> Or is this something that would not work in general?
[19:56:38] <kimundi> Or actually, trying to think about how that example and Rc<T> differ... Just the double pointer indirection that breaks it?
[19:57:23] <nmatsakis> kimundi: that does not work at all, but the point is, you have to opt into it
[19:57:29] <nmatsakis> that is
[19:57:32] <nmatsakis> you know you're breaking it :)
[19:57:37] <kimundi> heh :)
[19:57:38] <nmatsakis> and also
[19:57:43] *** Joins: brson (brson@moz-mj1.c9m.56.172.IP)
[19:57:43] *** ChanServ sets mode: +o brson
[19:57:49] <nmatsakis> you don't have types that didn't intend to be used as fat pointers accidentally being used that way,
[19:57:50] <kimundi> Was the idea behind the manual coercion method to make such cases work?
[19:57:53] <nmatsakis> and then accidentally breaking clients
[19:57:59] <nmatsakis> yes that was one motivation
[19:58:05] <nmatsakis> protecting the abstraction of types
[19:58:08] <kimundi> makes sense
[19:58:16] <nmatsakis> but I don't think it's that imp't
[19:58:26] <nmatsakis> that is, I don't see people wanting to make this transformation that often,
[19:58:31] <kimundi> yeah
[19:58:33] <nmatsakis> and it's maybe even good if
[19:58:38] <nmatsakis> you have to drop the autocoercion to do it
[19:58:48] <nmatsakis> since it'd probably require some reallocation 
[19:58:52] <nmatsakis> which perhaps ought to be made explicit
[19:59:07] <nmatsakis> but as I said I'd like that this is not just a surprising consequence
[19:59:16] <kimundi> this all also sounds suspiciously like DerefMove
[19:59:41] <nmatsakis> ...maybe? I'm not sure I see the connection but I'm ready to believe there is one
[20:00:04] * nmatsakis tries to page DerefMove back in 
[20:00:05] <kimundi> Well, overloadable automatic by-value cast from T to U
[20:00:19] <kimundi> Which afaik both coercions and DerefMOve would amount to
[20:00:35] <nmatsakis> I just remember I had some concerns about getting the traits just right in that case to ensure that type-checking was possible (it's easy to make it impossible with deref...)
[20:00:53] <nmatsakis> well, DerefMove doesn't seem so automatic
[20:01:13] <nmatsakis> in that you need the `*` or a `.`, no?
[20:01:23] <kimundi> Sure, but apart from that
[20:01:52] *** Quits: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at) (Connection closed)
[20:02:10] <kimundi> (I could also imagine it being automatic with an extended  DerefCoercion semantic that coerces T -> U if T: DerefMove<U>)
[20:02:17] <nmatsakis> so, apart from the fact that it is not automatic, it is a lot like an automatic coercion ;)
[20:02:34] <nmatsakis> yes, if we added that extend semantic, that would be automatic
[20:03:56] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[20:04:40] <nmatsakis> (anyway I'm pretty happy with the opt-in version)
[20:04:54] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[20:05:11] <kimundi> nmatsakis: Re: requiring to write a cast method manually - I really should write a RFC about having a "Trait" marker trait. Could write something like fn cast<Tr: Trait, T: Tr>(self: Box<T>) -> Box<Tr> with it
[20:05:57] <kimundi> let x: Box<Display> = boxed_int.cast::<Display>();
[20:07:13] <nmatsakis> yes, I've thought about it from time to time -- but I intend to try and hold the line on deep new type system features for a while. I think we've dug ourselves into a bit of a hole atm that I want to dig out of first, in terms of getting a good, solid impl of the features we have where we understand more deeply the interactions...
[20:07:19] <nmatsakis> :)
[20:07:23] <steveklabnik> nmatsakis: +1
[20:07:33] <steveklabnik> as much as that means 'no HKT for 1.1' :p
[20:07:34] *** Joins: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at)
[20:07:34] <steveklabnik> hahah
[20:07:37] <kimundi> nmatsakis: Heh, yeah I fully understand :)
[20:07:51] *** Joins: doener (doener@moz-cpsld2.hsi08.unitymediagroup.de)
[20:07:58] * kimundi nevertheless holds out for a deeper hole
[20:08:01] <nmatsakis> :)
[20:08:19] <blaenk> pass the shovel kimundi
[20:08:45] <blaenk> i think if we keep digging we'll come out on the other end, in HKT land
[20:10:50] <kimundi> There we'll be probably told that we could have gotten there faster if we just abstracted over the digging tool
[20:15:21] <aturon> nrc: ok, wycats says he'll be around for the core team meeting today so we'll try to get some resolution there.
[20:15:35] <blaenk> how bout dat custome preludes eh
[20:16:12] <arielb1> I think that we want some design exploration for CTFE
[20:16:41] <arielb1> I mean, people seem to want "CTFE"
[20:16:50] <arielb1> and they mean several things by it
[20:17:59] <arielb1> some people just want more control over monomorphic instantiation
[20:18:02] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[20:18:25] <arielb1> some want C++-style dynamically-kinded types
[20:18:41] *** Quits: eerie (eerie@moz-nbbdu3.red.bezeqint.net) (Connection closed)
[20:20:50] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[20:21:42] *** Quits: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at) (Connection closed)
[20:22:03] *** Joins: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at)
[20:24:21] *** Quits: James (quassel@moz-5qldmp.range109-148.btcentralplus.com) (Ping timeout: 121 seconds)
[20:24:21] *** Joins: mib_rluhxo (Mibbit@moz-agf8s8.lv.cox.net)
[20:24:25] <acrichto> aturon: why the rename of parent to without_file?
[20:24:28] * acrichto liked parent
[20:24:34] *** Quits: mib_rluhxo (Mibbit@moz-agf8s8.lv.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:24:35] <imperio> someone knows where the reserved keywords are ?
[20:24:41] <aturon> acrichto: hahaha, i *knew* that was coming :)
[20:25:04] <aturon> acrichto: the problem is that `parent` is misleading in a couple ways
[20:25:07] *** Quits: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at) (Connection closed)
[20:25:11] *** Joins: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at)
[20:25:13] <aturon> e.g. if there are symlinks involved
[20:25:27] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[20:25:28] <aturon> note also the change so that foo/.. has no parent
[20:25:29] <simukis> imperio: what do you mean?
[20:25:34] <acrichto> aturon: isn't this somewhat standard terminology though?
[20:26:06] <aturon> acrichto: there's some precedent, but others use things like `dir` (as opposed to `file_name`), which i could live with
[20:26:13] <simukis> aturon: without file doesnâ€™t work if the last component of the path is not file
[20:26:21] <aturon> simukis: right, that's the idea
[20:26:31] <acrichto> aturon: I'd vote for dir_name, dir, or something parent even (C++ uses parent_path)
[20:26:44] <imperio> simukis: I'm currently moving 'proc' from keywords to reserved keywords (I thin there is a separation)
[20:27:15] <simukis> so youâ€™re planning to do a syscall everytime path is split into stem and last component?
[20:27:24] <aturon> simukis: nope
[20:27:26] <aturon> :)
[20:27:46] <simukis> imperio: it should be in the same file you deleted proc from
[20:27:48] <aturon> basically, it just takes the syntactic path without the last component,
[20:28:03] <aturon> unless that component is ..
[20:28:04] <imperio> simukis: I'm gonna take another look then. Thx !
[20:28:12] <simukis> oh well, in UNIX everything is a file anyway.
[20:28:28] <simukis> who cares if it has some dumb directory bit and execution permissions set
[20:28:32] <aturon> right, this is mostly to align with the use of `file_name` to designate the "final" component
[20:28:37] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[20:28:55] <aturon> acrichto: do you understand my worry here? and are you on board with the semantics wrt .. ?
[20:28:56] <imperio> simukis: yep but not all works like it (inotify doesn't work on /proc :'( )
[20:29:11] <acrichto> aturon: hm I didn't quite get to that just yet, let me re-read
[20:29:17] <simukis> imperio: inotify is filesystem dependent functionality
[20:29:24] <imperio> yep
[20:29:46] <simukis> inotify doesnâ€™t work on network attached storage either
[20:29:54] <simukis> even though its all files and directories
[20:29:54] <imperio> and /proc can be read just like normal files and stuff, so that's really annoying that it doesn't work
[20:30:12] <imperio> simukis: Hum... I didn't know that !
[20:30:37] <brson> i'm going to take a look at that regression in the rpath code
[20:33:39] <acrichto> aturon: oh so 'foo/..'.without_file() == "foo/.." ?
[20:33:46] <acrichto> b/c you'd actually be going backwards otherwise?
[20:34:28] <aturon> acrichto: you get `None` back (and `false` from `pop`)
[20:34:54] <acrichto> ah right
[20:34:55] <aturon> but yes, semantically removing the `..` is not what you want :)
[20:35:18] <aturon> note that all these methods are *trivial* on top of the iterator, so it's very easy to do something different in the case that you need it;
[20:35:24] <aturon> this is really about the right defaults
[20:36:48] <acrichto> aturon: hm, this is definitely different than other libs, python/ruby/go all have the "parent" of "foo/.." as "foo"
[20:37:01] <acrichto> although I do understand how it is "semantically not so correct"
[20:37:21] <imperio> acrichto: I moved proc to reserved keywords, r? please ? ^^ gh23156
[20:37:21] <[o__o]> Remove proc keyword: https://github.com/rust-lang/rust/pull/23156
[20:37:30] <acrichto> imperio: yes I will get to that, don't worry
[20:37:38] <aturon> acrichto: yeah, i find it hard to imagine a situation where you are relying on that behavior
[20:37:48] <acrichto> imperio: it works best if you leave a comment on the RFC, it's tough to respond to things super quickly in IRC, even if asked a few times
[20:37:58] <imperio> acrichto: I just notified you, we're not in a hurry, don't worry
[20:38:05] <acrichto> aturon: does boost work this way?
[20:38:12] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[20:38:20] <imperio> acrichto: I did it like this since you were here but I'll leave a comment too
[20:38:38] <acrichto> aturon: hm even boost has the parent of "foo/.." as "foo"
[20:38:48] <aturon> acrichto: right, their spec is directly in terms of the iterator
[20:39:00] <acrichto> ah so you just tweaked the iterator itself
[20:39:19] <aturon> acrichto: i'm willing to bow to precedent, i just wish i understood the rationale
[20:40:07] <acrichto> aturon: in theory isn't the spec a little simpler if parent() returned all but the last component of the iterator?
[20:40:14] <acrichto> which I think is how C++ defined it at least
[20:40:17] <aturon> yes
[20:40:18] <acrichto> The resulting path is constructed by appending all elements in a range [begin(), --end()) to an empty path. 
[20:40:20] <aturon> the spec is indeed simpler
[20:40:29] <aturon> in fact, with their spec, you don't even need to return an option
[20:40:35] <acrichto> so although it may not be morally correct, it does seem to have quite a bit of precedent
[20:40:45] <acrichto> I'm a fan of not returning an Option :)
[20:40:52] <aturon> heh
[20:41:19] <aturon> i would be happier if i saw some code that used this and really wanted this semantics, though
[20:41:24] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Connection closed)
[20:41:44] <acrichto> aturon: an example is the -o flag of the compiler
[20:41:47] <aturon> acrichto: iirc, the main use for parent you had was basically popping off a given file so that you could then join some stuff
[20:41:52] <acrichto> when you say -o foo we place all output in "foo".parent()
[20:41:56] <aturon> rigth
[20:42:14] <aturon> so there, you're just happy to assume that `foo` isn't `..`
[20:42:15] <acrichto> which is definitely "not correct" if you say `-o foo/..`
[20:42:28] <acrichto> but then again that says you want to output to a directory...
[20:42:28] <imperio> what's the equivalent of read_link for hard link please ?
[20:42:29] <aturon> the main other reason that you might want to yield an Option is for recursive uses
[20:42:32] <aturon> walking up to the top of the path
[20:42:41] <imperio> nevermind, I found
[20:42:42] <acrichto> ah right
[20:43:04] <aturon> blaenk: if you're around, would enjoy your input into the above discussion
[20:43:07] <aturon> anyway, g2g for a minute
[20:43:12] <blaenk> alright will read
[20:43:30] <imperio> or not... Is there a function for that ?
[20:43:39] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[20:45:02] *** Quits: semarie (semarie@moz-5gr25r.telostor.ca) (A TLS packet with unexpected length was received.)
[20:45:28] *** Quits: ctennis (ctennis@moz-su6.e72.137.99.IP) (Quit: Leaving...)
[20:51:32] *** Joins: dinfuehr_ (dinfuehr@moz-l21rck.highway.telekom.at)
[20:51:46] <imperio> in the new fs mod there is no way to open a directory ?
[20:53:31] *** Quits: mr_boo (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:54:05] *** Quits: dinfuehr (dinfuehr@moz-apridg.highway.telekom.at) (Ping timeout: 121 seconds)
[20:55:43] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[20:58:07] <blaenk> imperio: what was way in old_fs?
[20:58:11] <arrrrrrr1> has anyone ever benchmarked spawning new processes in rust?
[20:58:58] <imperio> blaenk: I didn't look but I think I was good not doing thing correctly. I'm trying to use realpath but can't find what's the module to import
[20:59:19] <blaenk> i dont think that's in std
[20:59:35] <blaenk> you can probably find source of this http://doc.rust-lang.org/rustc/util/fs/fn.realpath.html and copy it
[20:59:44] <blaenk> since linking with rustc is probably not what you want
[20:59:59] <imperio> that's... weird
[21:00:10] <imperio> why providing a function if we can't import it ?
[21:00:22] <blaenk> it's not providing it, it's in the rustc crate
[21:00:24] <blaenk> in the compiler
[21:00:26] <blaenk> for internal use
[21:00:30] <imperio> erf
[21:00:39] <blaenk> should probably be exposed eventually though
[21:00:41] <imperio> that function is so useful ><
[21:00:44] <blaenk> yeah
[21:00:59] <imperio> is there a RFC to add it in libstd ?
[21:01:02] <blaenk> you should find the source, it's probably not that big
[21:01:23] <blaenk> I think acrichto recently made an rfc issue (not pr) outlining possible std::fs expansions and realpath was one of those
[21:01:26] <imperio> blaenk: yep but that's a big loss
[21:01:30] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[21:01:38] <blaenk> why's it a loss?
[21:01:40] <imperio> blaenk: yes, I'm part of it
[21:01:46] <blaenk> it's a shame it's not in std but if it works
[21:02:03] <imperio> i was speaking about the fact to not give access to realpath to people
[21:02:07] <blaenk> ah yeah
[21:02:10] <blaenk> thought you meant for your own use
[21:02:11] <huon> simukis: pong
[21:02:22] <simukis> huon: never mind ðŸ˜Š
[21:02:28] <blaenk> imperio: https://github.com/rust-lang/rust/issues/11857
[21:02:34] <imperio> no no, I wan't it for everyone (ya, I'm a nice guy haha)
[21:02:44] <blaenk> yeah I agree it'd be useful to have in std
[21:02:58] <imperio> oh nice !
[21:03:04] <imperio> then it'll be implemented after
[21:03:04] <blaenk> especially because there are symlinks in windows now, or something like them
[21:03:22] <blaenk> imperio: this is the issue I meant https://github.com/rust-lang/rfcs/issues/939
[21:03:27] <imperio> if rust bind windows' API, I'm so happy =D
[21:03:29] <blaenk> notice the second to last bullet point
[21:04:35] <imperio> Hum... That's weird I didn't pay attention the first time I read it...
[21:04:44] <blaenk> he has added more things over time
[21:04:47] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[21:04:53] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[21:04:54] *** Quits: kushal (kdas@moz-3tt6sl.202.sitibroadband.in) (Quit: Leaving)
[21:04:54] <imperio> yes and that's nice !
[21:05:02] <imperio> I can't wait to work on this RFC =D
[21:05:13] <imperio> meanwhille, I'll use c realpath function
[21:05:49] <blaenk> you should use the one in rustc, it's already setup to accept and return std::paths etc
[21:05:56] <blaenk> just copy it over to your code
[21:06:05] <imperio> ok, you convinced me
[21:06:16] <blaenk> https://github.com/rust-lang/rust/blob/cc722a4dd3e8110a8bf7e62eea977e99e3a3d128/src/librustc_back/fs.rs#L18
[21:06:20] <nrc> Anyone else seeing an ICE in driver::build_output_filenames ?
[21:06:45] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[21:06:57] <imperio> blaenk: https://github.com/rust-lang/rust/blob/cc722a4dd3e8110a8bf7e62eea977e99e3a3d128/src/librustc_back/fs.rs#L21
[21:07:05] <imperio> oh
[21:07:09] <imperio> you already put the link
[21:07:10] <imperio> erf
[21:07:12] <blaenk> :)
[21:07:28] <doener> nrc: with -o?
[21:07:34] <nrc> doener: yes
[21:07:58] <doener> nrc: gh23218
[21:07:58] <[o__o]> ICE on `rustc -o filename prog.rs`: https://github.com/rust-lang/rust/issues/23218
[21:09:41] <nrc> thanks!
[21:13:16] <bstrie> SF office folks, is there a sign-up sheet for use of the downstairs community space? acrichto aturon 
[21:14:06] *** Quits: dinfuehr_ (dinfuehr@moz-l21rck.highway.telekom.at) (Connection closed)
[21:14:54] <bstrie> I ask because I would like to make use of the community space for some rust stuff, and my exact plans will depend on how full the schedule seems to be
[21:16:48] *** Joins: dinfuehr (dinfuehr@moz-l21rck.highway.telekom.at)
[21:19:48] <brson> bstrie: you might ask jess lin, who is the facilities coordinator at sf. jesslin@mozilla.com
[21:20:31] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:21:43] <gleb> nmatsakis: possibly a silly question: could typeck be run before coherence checking (which takes non-negligible time) to catch its errors earlier?
[21:21:46] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:21:47] <bstrie> brson: thanks
[21:22:10] <bstrie> I am also just, like, sitting outside the building right now wondering if I should go in and ask the receptionist
[21:22:20] <blaenk> naaaaaaaaah
[21:24:25] <brson> bstrie: i know that acrichto and aturon are in a meeting until 3
[21:24:31] *** Joins: mystor (mystor@moz-5cj.r78.15.130.IP)
[21:24:47] <brson> pcwalton as well
[21:24:51] <nmatsakis> gleb: not easily atm -- perhaps with some refactoring -- right now typeck sort relies on the guarantees coherence gives
[21:25:10] <Gankro> Did someone ping me in the last few hours?
[21:25:11] <nrc> how do I trigger a private item in public interface error?
[21:25:16] <gleb> nmatsakis:  thanks
[21:25:26] <nrc> I can't seem to trigger it
[21:25:46] <brson> aturon acrichto pcwalton: bstrie needs to be let in the building!
[21:26:01] <steveklabnik> we're all in the meeting
[21:26:11] *** Quits: apasel422 (Mibbit@moz-vehgv3.ma.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:26:46] <steveklabnik> i just brought it up
[21:27:16] *** Joins: bjz (bjz@moz-lailbo.tpgi.com.au)
[21:27:17] <aturon> brson: acrichto is letting him in
[21:28:13] *** Quits: dinfuehr (dinfuehr@moz-l21rck.highway.telekom.at) (Connection closed)
[21:28:26] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:28:48] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:29:37] <bstrie> aturon: hm? someone is letting me in?
[21:29:44] <aturon> bstrie: alex is on the way
[21:29:57] <bstrie> aturon: I am sitting outside the door to the community space
[21:31:25] <imperio> the try! macro isn't supposed to prevent failing ?
[21:32:36] <simukis> imperio: it just bubbles the Err case up the caller stack
[21:32:45] *** Quits: mystor (mystor@moz-5cj.r78.15.130.IP) (Connection closed)
[21:32:51] *** Joins: mystor (mystor@moz-5cj.r78.15.130.IP)
[21:33:11] *** Quits: mystor (mystor@moz-5cj.r78.15.130.IP) (Connection closed)
[21:33:32] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:33:32] *** Joins: mystor (mystor@moz-5cj.r78.15.130.IP)
[21:33:35] <imperio> hum...
[21:33:40] <imperio> then I don't get the problem
[21:34:29] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:34:38] *** Quits: mystor (mystor@moz-5cj.r78.15.130.IP) (Connection closed)
[21:34:42] *** Joins: mystor_ (mystor@moz-5cj.r78.15.130.IP)
[21:35:02] <blaenk> imperio: ?
[21:35:27] <bstrie> imperio: the try macro is there to provide a standard way to bubble up errors
[21:35:37] <imperio> blaenk: the realpath fails everywhere, that's an horror
[21:35:41] *** Quits: tjakubow (tom@moz-ag87jj.fios.verizon.net) (Quit: WeeChat 1.1.1)
[21:35:55] <bstrie> imperio: by failing, do you mean panic?
[21:36:13] <simukis> imperio: you actually want it to ignore errors instead of reporting them to the user?
[21:36:17] <blaenk> lol i said same thing before dropping; <blaenk> by failing you mean panicing?
[21:36:33] <imperio> simukis: I want to override them and replace an Err by an empty Ok
[21:36:45] *** Quits: bjz (bjz@moz-lailbo.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[21:36:49] <imperio> bstrie: yes, I mean panicking ^^
[21:37:37] <imperio> https://github.com/rust-lang/rust/blob/cc722a4dd3e8110a8bf7e62eea977e99e3a3d128/src/librustc_back/fs.rs#L58
[21:37:40] <bstrie> imperio: try doesn't panic
[21:37:41] <imperio> this line is the problem
[21:38:04] <imperio> bstrie: oh ?
[21:38:12] <imperio> that's official, I don't understand something
[21:38:15] *** Joins: bjz (bjz@moz-lailbo.tpgi.com.au)
[21:38:22] <imperio> when try! executes it doesn't go to the next line
[21:38:33] *** Quits: bjz (bjz@moz-lailbo.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[21:38:56] <bstrie> imperio: in the error case, try! will return from the function with an Err
[21:39:09] <imperio> ok, that's what I figured out
[21:39:14] <simukis> https://github.com/rust-lang/rust/blob/cc722a4dd3e8110a8bf7e62eea977e99e3a3d128/src/libcore/macros.rs#L157
[21:39:18] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:39:27] *** Joins: doomlord_mbp (textual@moz-tv67ph.range86-148.btcentralplus.com)
[21:39:32] <simukis> best way to understand what a macro does, is of course, reading its source
[21:39:45] <bstrie> imperio: if you're curious about a macro, you can read the expansion by doing `rustc --pretty expanded foo.rs`
[21:39:49] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:40:04] <imperio> bstrie: thx for the tip, didn't that !
[21:40:27] <simukis> you need -Z unstable-options for --pretty to work
[21:40:42] <imperio> ok, I try it
[21:40:43] <bstrie> that must be new
[21:42:39] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:44:52] *** Quits: mystor_ (mystor@moz-5cj.r78.15.130.IP) (Connection closed)
[21:45:10] *** Joins: mystor (mystor@moz-5cj.r78.15.130.IP)
[21:45:16] *** Quits: arielb1 (Ariel@moz-804827.red.bezeqint.net) (Connection closed)
[21:46:20] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:50:49] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[21:51:21] <imperio> YES ! I did it ! I totally ignore errors and it works, perfect =D
[21:51:30] <sfackler> kmc: published a new unix-socket version btw
[21:51:53] *** Joins: tedh (tedh@moz-02itmj.sub-70-194-66.myvzw.com)
[21:52:28] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[21:54:48] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:55:37] *** Quits: doomlord_mbp (textual@moz-tv67ph.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[21:55:38] <kmc> thx
[21:56:07] <doener> that second movzbl seems pointless, right? https://gist.github.com/dotdash/73db268461313b0a3091
[21:57:24] *** Quits: ytain (ytain@moz-d93rt6.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[21:57:57] <cmr> doener: it clears the upper 24 bits of eax, for the cmp with 0xf
[21:58:51] <Luqman> yup, move with zero extend from byte to longword
[21:58:52] <doener> cmr: yeah, but eax was last written by a movzbl, so they should already be cleared
[21:59:02] <doener> cmr: in the first line
[21:59:05] <cmr> oh I see
[21:59:11] <cmr> how interesting
[22:01:38] *** Joins: njn (chatzilla@moz-mrqno0.iinet.net.au)
[22:01:59] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[22:02:14] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:02:39] *** Quits: mystor (mystor@moz-5cj.r78.15.130.IP) (Connection closed)
[22:03:22] <arrrrrrr1> how do I enable processor dependent codegen?
[22:03:40] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:03:55] *** Joins: laumann (laumann@moz-n9e72h.0.fullrate.dk)
[22:04:45] <huon> -C has various things
[22:04:47] <cmr> arrrrrrr1: -C target-cpu=<model>
[22:04:48] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[22:04:54] <cmr> there's no -march=native though
[22:04:54] <arrrrrrr1> thanks
[22:05:00] <arrrrrrr1> cmr: why not?
[22:05:06] *** Joins: reem (reem@moz-lbqjd2.coob.q2h1.0009.2601.IP)
[22:05:12] <doener> ENOTIMPL
[22:05:40] <doener> oh damn... forgot to set RUSTFLAGS='-C debug-assertions' again :-(
[22:06:50] *** Joins: ytain (ytain@moz-d93rt6.dsl.teksavvy.com)
[22:07:04] <kmc> sfackler: any way to create a UnixStream from an existing open fd?
[22:07:08] <kmc> another PR? :)
[22:07:17] <sfackler> not right now :)
[22:07:48] <sfackler> (the current functionality is exactly what was needed to get rust-postgres to work)
[22:07:51] <sfackler> and no more
[22:08:10] <kmc> heh
[22:08:12] <kmc> ok
[22:08:26] <kmc> that function wouldn't actually be `unsafe`, right?
[22:08:47] <sfackler> i was thinking about exactly that
[22:09:02] <sfackler> ideally there'd be some way of asking the kernel what domain + kind a socket had
[22:09:08] <sfackler> and the thing could return a result
[22:09:14] *** Quits: reem (reem@moz-lbqjd2.coob.q2h1.0009.2601.IP) (Ping timeout: 121 seconds)
[22:10:17] <sfackler> if that ability doesn't exist, it wouldn't be *memory unsafe*, just sketchy in general I guess
[22:10:44] <kmc> yeah
[22:10:50] *** Quits: tedh (tedh@moz-02itmj.sub-70-194-66.myvzw.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:10:59] <sfackler> aturon: any ideas on conventions for these kinds of constructors? ^
[22:11:01] <kmc> the kernel can't trust anything userspace says about fds
[22:12:15] <sfackler> yeah, worse case all the calls fail and the close maybe tramples some poor unsuspecting fd
[22:14:21] <sfackler> *worst
[22:14:32] <arrrrrrr1> cmr: is it march or mcpu?
[22:14:33] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:14:56] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:16:21] <sfackler> hmm, so it looks like you can get the socket type from getsockopt, but not the domain
[22:19:19] <arrrrrrr1> brson: ping
[22:19:59] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[22:22:00] <brson> arrrrrrr1: pong
[22:22:48] <arrrrrrr1> brson: could you enable tar.xz generation so that people can choose between tar.gz and tar.xz? the server is not very fast.
[22:22:50] <imperio> kmc: kernel space doesn't have same fds than user space if I remember well, so that seems... logical ?
[22:24:38] <kmc> imperio: fds are identifiers for kernel resources, held by userspace
[22:25:14] <kmc> the word "file" is a red herring, the important thing isn't that they implement read() and write() but that they implement dup2(), epoll(), and (ugh) SCM_RIGHTS
[22:25:36] <kmc> most any kernel resource in UNIX that *isn't* named by a fd is a huge pain in the ass
[22:25:55] <kmc> fds are the closest UNIX has to capabilities
[22:26:10] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[22:26:12] <imperio> The only fds are used in kernel space were socket
[22:26:16] <imperio> and drivers
[22:26:22] <kmc> and kernels like Linux have gradually added enough features that you can build a capabilities based least privileges system on top
[22:26:24] <imperio> that count has files ?
[22:26:31] <kmc> as long as you have a way to disable all the POSIX crap
[22:26:34] <kmc> (sandboxing)
[22:26:36] <kmc> imperio: I don't understand
[22:26:43] <kmc> file descriptors are part of the kernel's interface to userspaceq
[22:26:57] <imperio> sorry
[22:26:59] <imperio> bad word
[22:27:03] <kmc> the kernel's own interfaces for reading a file on disk would be completely different
[22:27:11] <imperio> replace "are used" by "I have used"
[22:27:17] <imperio> too tired once again...
[22:27:27] <Gankro> Security prof rants about how bitcoin is crap and kmc rants about how POSIX is crap. Would be a good day if I wasn't so exhausted
[22:27:37] <imperio> kmc: I think I didn't fully understand this kernel part since I never used it...
[22:27:41] <brson> arrrrrrr1: i'm considering adding either .bz2 or .xz
[22:28:35] <arrrrrrr1> brson: from the stats I've seen xz is smaller. I remember one project deprecating bz2 in favor of gz and xz because bz2 gives you neither best speed nor best compression. don't remember which one it was.
[22:28:56] <imperio> kmc: I remember the need to translate pointers to user space with copy_to_user
[22:29:00] <aturon> sfackler: i may be missing context -- are you talking about possibly-failing conversions, or something more?
[22:29:20] <imperio> but I thought it was needed to do something similar with fds
[22:29:38] *** Quits: laumann (laumann@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[22:29:57] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[22:30:19] <arrrrrrr1> brson: I believe it was debian
[22:31:11] <Gankro> brson: On that note are there any plans for a torrent of 1.0?
[22:31:12] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:31:21] <brson> Gankro: nope
[22:31:49] <Gankro> brson: Think it would be worth it if an impl fell out of the sky?
[22:31:50] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:32:16] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:32:22] <carllerche> Is there a way to return a FnOnce from a function?
[22:32:32] <brson> Gankro: I don't think there will be much demand
[22:32:50] <Gankro> carllerche: Only box'd :(
[22:33:04] <carllerche> :-/
[22:33:23] <Gankro> carllerche: post 1.0 we should get `-> impl FnOnce` syntax to allow it
[22:34:17] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[22:34:29] <Gankro> aturon: Do we plan to migrate any existing APIs to -> impl when that becomes possible?
[22:34:55] <huon> Gankro: in std?
[22:35:05] <Gankro> huon: yeah
[22:35:06] <aturon> Gankro: it's a little unclear. that's a case that would be breaking in principle, but maybe not in practice
[22:35:08] <awe> acrichto: I cannot seem to write a test for shutting down a UDP socket that doesn't give me "Socket is not connected (os error 57)"
[22:35:32] <awe> acrichto: Is the idea to call shutdown while it's blocking on something?
[22:35:41] <aturon> Gankro: though it also depends on exactly how the feature is implemented
[22:35:43] <Gankro> aturon: Yeah, it's iffy. It would be nice to make a lot of iterators just impl's. Avoid all the newtyping. But that would suck for storing them.
[22:35:55] <arrrrrrr1> how do I build rustllvm?
[22:36:02] <aturon> Gankro: right, so part of the question is how you can refer to these types
[22:36:30] <aturon> Gankro: we've thought about that if you have `fn something(...) -> impl SomeTrait`, then you could actually refer to the return type via `something::type` or some such
[22:36:40] <acrichto> awe: oh interesting, I wonder if shutdown just doesn't work at all with udp sockets
[22:36:44] <aturon> Gankro: if that's possible, the existing newtypes could actually become aliases for that
[22:36:45] <Gankro> aturon: Woah
[22:36:48] <aturon> Gankro: :D
[22:37:06] <Gankro> Although that's a weird different implementation-specific thing
[22:37:22] <aturon> what do you mean by implementation-specific?
[22:37:24] <aturon> like, for a trait?
[22:37:33] <Gankro> Like you're exposing the actual method that yields it?
[22:37:49] <aturon> no, that's not the intention
[22:38:03] <aturon> it's more that the grammar of type includes paths through functions returning `impl Trait`
[22:38:17] <aturon> you can think of it like a semi-anonymous newtype
[22:38:24] <aturon> or one whose name is the name of the function
[22:38:45] <aturon> acrichto: ok so, getting back to path... i think i'll just bow to precedent and go with parent, and happily go through .. etc
[22:38:58] <aturon> acrichto: main remaining question is: what to do with empty path
[22:39:11] <aturon> acrichto: i.e. should it still return Option
[22:39:18] <acrichto> aturon: I think I'm fine continuing to return an Option
[22:39:28] <Gankro> aturon: I mean like if you have a struct store it, it's like saying "oh this is the iter from <blah>"
[22:39:34] <acrichto> aturon: although when you say empty path, if we returned option, what would the parent of "/" be?
[22:39:38] <huon> aturon: Gankro: how are we expecting to handle say, things that are Iterator and Clone and ...? `-> impl Iterator<Item = T> + Clone + ...`?
[22:40:13] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[22:40:22] <Gankro> huon: Fair point. Probably a good argument for keeping it explicit for us.
[22:40:27] <aturon> acrichto: probably Some(""), and for "" you'd get None
[22:40:34] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[22:40:59] <acrichto> aturon: hm, that would be pretty surprising to me
[22:41:09] *** Joins: tedh (tedh@moz-ctbj7i.il.comcast.net)
[22:41:16] <acrichto> aturon: e.g. the "walk to root" where you call .parent() and for each stage you join() something to check existence
[22:41:23] <arrrrrrr1> does configure clone the whole llvm tree?
[22:41:30] *** Joins: Guest63 (textual@moz-56c.qli.61.176.IP)
[22:41:34] <aturon> acrichto: alternatively we could stick with the earlier semantics and yield None for `/`
[22:41:42] <aturon> Gankro: so, to be clear, the struct itself would be generic
[22:41:47] <aturon> Gankro: huon: let me make an example
[22:41:56] <acrichto> aturon: yeah I think I'd expect None for both the root path as well as the empty paht
[22:42:06] <acrichto> although I could be bonkers
[22:42:44] <arrrrrrr1> at 100kb per second this will take an hour
[22:42:52] <aturon> Gankro: huon: https://gist.github.com/aturon/61e8645cc8b49abb21b8
[22:43:05] *** Quits: imperio (Mibbit@moz-8otf3a.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:43:21] <Gankro> aturon: Sucks that you have to opt into generics to store what is ultimately a concrete type
[22:43:22] <aturon> Gankro: huon: oops, fixed a bug, refresh
[22:43:40] <aturon> Gankro: oh, if you want to store a concrete one, you don't ahve to opt in
[22:43:45] <aturon> Gankro: let me show you :)
[22:44:53] <aturon> Gankro: huon: bottom of https://gist.github.com/aturon/61e8645cc8b49abb21b8
[22:45:11] <aturon> probably the `as Foo` isn't even needed there
[22:45:13] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:45:18] <Gankro> aturon: Yeah ok that's what I figured
[22:45:31] *** Quits: Skyler (Skyler@moz-e93b35.sd.cox.net) (Client exited)
[22:45:36] *** Joins: Skyler (Skyler@moz-e93b35.sd.cox.net)
[22:45:42] <aturon> acrichto: no i agree, that's how i initially set it up, but it does differ from boost!
[22:45:49] * aturon shrugs
[22:45:53] <huon> aturon: ok
[22:46:03] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:46:19] <huon> I guess the Iterator + Clone + ... approach may not scale for some examples in std
[22:46:28] <aturon> huon: yep, you want trait aliases
[22:46:45] <aturon> including a way to talk about e.g. this thing is DoubleEnded if the underlying iterator is
[22:47:02] <aturon> the need for that was one reason I closed the original RFC, to wait for deeper design
[22:47:09] <aturon> Gankro: huon: incidentally, this feature encompasses some portion of HKT to be useful
[22:47:12] <huon> like, fn transform<I: Iterator>(x: I) -> /* something that contains I */
[22:47:14] <huon> ?
[22:47:17] <aturon> yes
[22:47:24] <aturon> most of the iterator adapters have this shape,
[22:47:33] <aturon> but most of them are basically "forwarding" in some way,
[22:47:46] <aturon> so you can have a single trait alias that explains the bounds you get, and use it uniformly
[22:48:57] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[22:49:33] *** Quits: evanfarrar (evanfarrar@moz-7vs.bl6.251.207.IP) (Connection closed)
[22:51:34] <eddyb_> nmatsakis: so you disagree with my view on Copy?
[22:51:45] *** Quits: jxv (jxv___@moz-2celrt.res.rr.com) (Connection closed)
[22:52:12] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:53:05] <Gankro> aturon: The more I think about it, the more I think you'd really only want  `-> impl Iterator` for type erasure of <mess of chaining>
[22:53:26] <Gankro> for some fake definition of type-erasure that isn't what that means at all\
[22:53:30] <aturon> Gankro: hm, why's that? newtypes are a pain
[22:54:05] <Gankro> aturon: -> impl Iterator + DoubleEndedIterator + Clone + Copy + ... *vomit*
[22:54:29] <aturon> right, so my hope is that trait aliases can cover most of that issue
[22:54:33] <aturon> but i may be wrong about that :)
[22:54:45] <Gankro> aturon: Plus the wrapper HKT issue
[22:54:53] <aturon> Gankro: what's that?
[22:55:02] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[22:55:13] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:55:22] <Gankro> e.g. replacing Map<I, F> with Iterator ??contains I and F??
[22:56:09] <aturon> hm, still not sure i follow. if you have a fn with generic args, those are included in the ::type thing
[22:56:20] *** Joins: tjakubow (tom@moz-783qe0.res.rr.com)
[22:56:32] <eddyb_> aturon: uhm
[22:56:37] <eddyb_> aturon: you're missing ::Output
[22:56:48] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[22:56:50] <aturon> eddyb_: ?
[22:57:01] <eddyb_> unless function::type is not typeof function
[22:57:09] <aturon> it is not
[22:57:10] <eddyb_> in which case, that's very confusing
[22:57:12] <aturon> heheh
[22:57:16] <Gankro> aturon: I'm far too sleepless and marking-undergrad-maths-brain-dead to possibly reason accurately right now :)
[22:57:18] <aturon> it's a strawman
[22:57:27] <huon> eddyb_: we don't need to bikeshed syntax now :)
[22:57:37] <eddyb_> aturon: can we just have <typeof SomeType::iter>::Output?
[22:57:44] <eddyb_> huon: this is not really a syntax bikeshed
[22:57:47] <aturon> eddyb_: it's a hypothetical way of naming the otherwise-anonymous newtype in -> impl SomeTrait
[22:58:07] <eddyb_> aturon: we already have a way of extracting return types from function types
[22:58:19] <aturon> eddyb_: ahh, i see what you're getting at
[22:58:20] <eddyb_> naming a function type is far more valuable in general
[22:58:41] <aturon> that's an interesting idea, i hadn't thought of going through the Fn traits here
[22:58:47] <eddyb_> aturon: I thought of function::type exactly for this purpose. but then, there's some typeof proposal floating around
[22:59:06] <eddyb_> either is fine, though I prefer typeof in the long term
[22:59:23] <aturon> yes
[22:59:26] <aturon> eddyb_: thanks for this insight!
[22:59:45] <eddyb_> I am mostly trying to grasp some context here :D
[22:59:46] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[22:59:57] <aturon> eddyb_: https://gist.github.com/aturon/61e8645cc8b49abb21b8 ICYMI
[23:00:17] <eddyb_> that's what I was looking at
[23:00:20] <aturon> hehe ok
[23:00:31] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[23:00:32] <huon> eddyb_: it is a bikeshed :) (since the details of extracting the return type aren't so important to the actual semantics we were discussing)
[23:00:36] <eddyb_> aturon: I'm guessing it's nothing concrete, just someone opening up discussion again?
[23:00:46] <burntsushi> kmc: there is also cbor, which is basically binary JSON. one advantage to using it is that it implements a spec that has implementations in other languages.
[23:00:49] <aturon> anyway, i will have to tell nmatsakis about this thought, the last time i was thinking about this was before unboxed closures so i'd never thought of the unification
[23:00:56] <huon> that's not to say we can't discuss it, of course ;)
[23:01:14] <aturon> huon: fwiw i think eddyb_ is pointing out a pretty interesting semantic unification here
[23:01:26] <aturon> namely, that we don't necessarily need a separate feature to get at the return type for -> impl Trait
[23:01:30] <eddyb_> aturon: you need to be able to name function types for other things, fwiw
[23:01:35] <aturon> but rather that the ability is already there, in some sense
[23:01:45] <aturon> eddyb_: yes, i see how this fits together now
[23:01:51] <burntsushi> erickt: about porting cbor to serde: that's very cool! i'm not sure if you noticed, but there are two decoder implementations in the crate. one works like JSON (intermediate representation). the other is direct to the value and is *much* faster, but i've put off implementing struct decoding since it seems hard.
[23:01:53] <huon> aturon: right, but we can presuppose that that feature exists when discussing the semantics of impl Trait :)
[23:01:59] <eddyb_> since they're supposed to be zero-sized, they're useful as named closures of sorts
[23:02:05] <huon> it doesn't totally matter how it exists, as long as it does
[23:02:10] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[23:02:30] <erickt> burntsushi: I did see.
[23:02:31] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[23:02:42] <aturon> huon: "I hear you like bikesheds, so I started a bikeshed over whether we're bikeshedding" (teasing, teasing!)
[23:02:52] <huon> :D
[23:03:04] <eddyb_> aturon: is `const FOO = |foo| foo.bar();` too much to ask for, I wonder?
[23:03:24] <eddyb_> it feels like it's overlapping a lot with functions
[23:03:36] <aturon> eddyb_: oh man
[23:03:38] <eddyb_> (and I guess it might not work without enough annotations)
[23:03:47] <erickt> burntsushi: that's not that dissimilar to serde::json, where there's a serializer/deserializer to and from raw strings and another serializer/deserializer to a Value type
[23:04:08] <aturon> eddyb_: it is probably too much at this juncture. alas, we will probably have to leave some unifications undone
[23:04:36] <burntsushi> erickt: ah right. do you need two implementations though? i thought serde enabling decoding into an enum type like `Json`?
[23:04:37] <eddyb_> aturon: btw, did I ask you about associated constants and the associated items RFC?
[23:04:55] <erickt> burntsushi: but as opposed to rust-serialize it doesn't need an intermediate value
[23:04:59] <aturon> eddyb_: don't recall, what about them? (all i know is, it would be nice if they were implemented :-)
[23:05:28] <eddyb_> erickt: do you have anything which does lazy decoding of a buffer? or maybe I should say, it only stores what it can't trivially get from the buffer
[23:05:51] <eddyb_> aturon: I'm struggling to clean up the way methods and associated types are represented in the AST
[23:06:13] <eddyb_> aturon: in order to implement associated constants ;). what I'm wondering if the RFC is supposed to cover them
[23:06:25] *** Joins: theme_ (theme@moz-i3mhhb.asianet.co.th)
[23:06:36] <eddyb_> aturon: I think it was written before the const/static split, so it talks about constants using the `static` keyword
[23:07:05] <aturon> eddyb_: ahha, i see. my assumption was that we'd interpret the RFC as talking about const
[23:07:12] *** Quits: goffrie (uid69670@moz-1c9019.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[23:07:19] <eddyb_> aturon: but someone has to patch it, no?
[23:07:28] <eddyb_> aturon: I guess it's low priority
[23:07:45] <aturon> eddyb_: i don't think anyone *has* to -- we have a lot of RFCs with outdated Rust in them
[23:07:47] <erickt> burntsushi: see https://github.com/erickt/rust-serde/blob/master/src/json/value.rs
[23:07:53] <aturon> eddyb_: but i also would not object!
[23:08:01] <eddyb_> aturon: we obviously need multi-repo PRs
[23:08:08] <aturon> hahahaha
[23:08:14] <eddyb_> change syntax? update all the highlighting files, cargo, RFCs
[23:08:24] <burntsushi> erickt: that is very exciting! :D
[23:08:25] <eddyb_> heck, why not fix the entirety of crates.io
[23:08:26] <erickt> burntsushi: it supports serializing arbitrary things into a Value, deserializing into a Value, and as well as a Value itself can be a serializer and deserializer
[23:08:42] <aturon> eddyb_: i guess this is a someone transient problem though, after 1.0
[23:08:58] <eddyb_> aturon: automated refactoring tools is what we're missing
[23:09:17] <erickt> eddyb_: hm...
[23:09:19] <eddyb_> I've been holding off on trying to do anything interesting about that because I'd rather start with a proto-IDE
[23:09:48] <aturon> so much fun stuff to do :)
[23:09:57] <erickt> eddyb_: you mean like if you're processing a buffer, return a &str pointer inside said buffer instead of allocating a string?
[23:10:08] <eddyb_> erickt: yupp, stuff like that
[23:10:17] <erickt> eddyb_: yep!
[23:10:35] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[23:10:46] <eddyb_> it does not apply to JSON, but there's binary formats where you can have iterators instead of vectors, and everything is an accessor
[23:11:04] <erickt> eddyb_: it gets a little tricky, but the protocol does allow a deserializer to pass a &str to a visitor
[23:11:05] <eddyb_> there's binary formats which are impossible to deserialize into a sane structure
[23:11:24] <eddyb_> anything with absolute offsets is very fun
[23:11:24] <burntsushi> eddyb_, erickt: cbor actually has that, they call it "indefinite length encoding." i'd love to be able to expose something like that.
[23:11:40] <burntsushi> eddyb_, erickt: for strings, maps and arrays
[23:11:57] <erickt> eddyb_: ah in that sense serde is eager
[23:12:09] <nrc> do I need some configure flag to get debug! working now?
[23:12:19] <eddyb_> erickt: I guess it's lazy in the same sense that infinite recursion is computable if it's lazy :P
[23:12:28] <theme_> nrc, something like env_logger?
[23:12:34] <doener> nrc: worse, you need RUSTFLAGS='-C debug-assertions'
[23:12:38] <eddyb_> nrc: in the compiler?
[23:12:42] <eddyb_> doener: wait, what?
[23:12:44] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[23:12:50] <theme_> doener, what is that?
[23:12:59] <brson> aturon: this patch impls Error for the mpsc Error type. should the new impls start unstable or go straight to stable https://github.com/rust-lang/rust/pull/23125
[23:13:00] <eddyb_> debug! is optimized out now?
[23:13:05] <theme_> eddyb_, yes
[23:13:10] <nrc> doener: thanks
[23:13:15] <nrc> also, :-(
[23:13:23] <eddyb_> does it make our compiler take less to compile?
[23:13:42] <theme_> eddyb_, so that debug!() can be used in performance-critical parts
[23:13:45] <aturon> brson: stable is fine for that
[23:13:53] <theme_> I put my debug!()s in a hot loop
[23:14:02] <aturon> nrc: btw we're ready to move forward with type ascription, i think nmatsakis will merge
[23:14:06] <erickt> eddyb_: ah, well I guess it's eager-ish. you pass a serializer/deserializer a visitor, and that visitor gets called on whatever is the next value
[23:14:12] <nrc> aturon: good, thanks!
[23:14:18] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[23:14:20] *** Joins: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP)
[23:14:22] * eddyb_ wants debuginfo to contain Debug impls
[23:14:50] <erickt> eddyb_: but that value could be a compound structure, so that triggers the serializer to pass another visitor to the serializee's visitor 
[23:15:04] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[23:15:09] <theme_> Can anybody explain what is going on in this comment? https://github.com/rust-lang/rfcs/pull/956#issuecomment-77906756
[23:15:09] <eddyb_> cause you just need to pass that and an object pointer to some fixed function
[23:15:16] <eddyb_> and you're pretty printing stuff
[23:15:20] <eddyb_> from the debugger
[23:15:25] <erickt> eddyb_: so in short, the serializee's visitor will be fully evaluated, but you can always pass another serializee visitor to the serializer
[23:15:36] <nrc> doener: do I need to configure or will make clean do when I change RUST_FLAGS?
[23:16:17] <doener> nrc: "make clean" should be sufficient. And it's RUSTFLAGS, without the underscore
[23:16:20] <eddyb_> nrc: RUSTFLAGS don't trigger anything
[23:16:27] <nrc> thanks
[23:16:33] <eddyb_> which is nice, most of the time
[23:16:40] <awe> [18:36:40]  <@acrichto>	awe: oh interesting, I wonder if shutdown just doesn't work at all with udp sockets
[23:16:51] <awe> acrichto: yeah, I got mixed signals from docs (as I tried to express).
[23:17:17] <nrc> theme: ask arrrrrrr1, it's his comment
[23:17:21] *** Quits: kmcguire_ (kmcguire@moz-pg1gb9.biz.rr.com) (Ping timeout: 121 seconds)
[23:17:22] <erickt> eddyb_: someday it'd be nice to play with something along the lines of kmc's interruptable html5ever parser
[23:17:23] <nrc> (iirc)
[23:18:03] <theme_> heh... I found a variant of this bug: https://github.com/rust-lang/rust/issues/23221
[23:18:08] <theme_> http://is.gd/ebmqKe
[23:18:19] <theme_> overflow checking.... failed -_-
[23:18:25] <eddyb_> erickt: you mean, state machines?
[23:18:29] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[23:18:43] <erickt> eddyb_: but I'm not quite sure what you're supposed to do with the in-progress data
[23:19:19] <eddyb_> oh
[23:19:22] <eddyb_> erickt: on-line decoders?
[23:19:30] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[23:19:37] <erickt> eddyb_: yeah. serde's already filled with state machines :)
[23:19:53] <eddyb_> erickt: well, my PNG one was doing ring buffers or something similar
[23:20:17] <eddyb_> basically, you keep storing until you can advance at least one step
[23:20:24] <eddyb_> erickt: unless you're talking about something harder
[23:20:26] *** eddyb_ is now known as eddyb
[23:21:01] <brson> anybody can review vim prs? https://github.com/rust-lang/rust.vim/pull/14
[23:21:12] <erickt> eddyb: I think so, but I got to run. lets chat in a bit
[23:21:49] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[23:22:02] <theme_> Filed a bug: https://github.com/rust-lang/rust/issues/23235
[23:22:07] <theme_> overflow checking is hard :/
[23:22:25] <eddyb> arrrrrrr1: I really like that mathematical explanation
[23:23:09] <arrrrrrr1> eddyb: b-but PartialEq, Ord, etc. are literally derived from there.
[23:23:09] <eddyb> I've seen some other mentions of those issues, but this comment is the kind of thing you get gold for on reddit
[23:23:16] <theme_> arrrrrrr1, are you mahkoh?
[23:23:22] <arrrrrrr1> theme_: yes
[23:23:40] <theme_> arrrrrrr1, care to explain this? https://github.com/rust-lang/rfcs/pull/956#issuecomment-77906756
[23:23:43] <theme_> I don't understand it
[23:23:49] <eddyb> theme_: all of it?
[23:24:01] <theme_> I am not sure what is the stance of arrrrrrr1 
[23:24:02] <arrrrrrr1> I'm not quite sure how to explain a 200 lines comment via IRC
[23:24:06] <eddyb> you could... read it? or point out a specific part of it
[23:24:10] <theme_> arrrrrrr1, what is your stance
[23:24:22] <theme_> the "How to improve the situation" part
[23:24:37] <eddyb> theme_: that the current model is incorrectly using mathematical terminology
[23:24:37] <arrrrrrr1> theme_: making it unsafe is a good idea. but if we're already making a breaking change, then we should remove the current traits and replace them by better ones (also unsafe)
[23:24:41] <theme_> I find it unrelated to the first half
[23:24:48] <theme_> arrrrrrr1, eh?
[23:25:35] <arrrrrrr1> the traits that are currently being used are derived from certain mathematical properties that don't apply to Rust. therefore they are suboptimal
[23:25:35] <theme_> arrrrrrr1, lt, gt, eq, ne can be defined in terms of le and ge
[23:25:45] <theme_> right?
[23:26:02] <arrrrrrr1> theme_: no
[23:26:22] <theme_> arrrrrrr1, a.lt(b) == a.le(b) && !(a.ge(b))
[23:26:30] <eddyb> arrrrrrr1: what would f32 implement?
[23:26:42] <arrrrrrr1> eddyb: StrongOrd
[23:26:48] <eddyb> keep in mind we should be able to use comparison operators on types that contain them
[23:26:48] <theme_> what O_o
[23:26:50] <eddyb> arrrrrrr1: hmm
[23:26:56] <eddyb> arrrrrrr1: so what would implement WeakOrd?
[23:27:04] <theme_> arrrrrrr1, is my lt definition OK?
[23:27:13] <eddyb> because floats are like the only reason the current PartialOrd exists
[23:27:40] <arrrrrrr1> eddyb: I've given an example in that section for something that implements WeakEq
[23:27:46] <theme_> eddyb, what is the reason that PartialOrd exists for non-Self?
[23:28:13] <eddyb> arrrrrrr1: I asked about WeakOrd
[23:28:24] <arrrrrrr1> eddyb: I meant WeakOrd
[23:28:27] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[23:28:28] <eddyb> uhm
[23:28:30] <arrrrrrr1> (there is no WeakEq)
[23:28:53] <arrrrrrr1> theme_: because you want to do things like Some(0) <= 1
[23:29:01] <eddyb> arrrrrrr1: do you?
[23:29:06] <theme_> arrrrrrr1, can't I do Some(0) <= Some(1)
[23:29:09] <arrrrrrr1> eddyb: sometimes!
[23:29:22] <arrrrrrr1> theme_: yeah but <= 1 is shorter
[23:29:24] <eddyb> theme_: it's mostly polymorphism stuff
[23:29:31] <eddyb> arrrrrrr1: I don't think that's implemented (is it?)
[23:29:39] <arrrrrrr1> eddyb: I don't think so
[23:29:42] <eddyb> theme_: Vec<T> vs &[T]
[23:29:49] <eddyb> theme_: String and str and Cow<str>
[23:29:50] <theme_> eddyb, just add &
[23:29:56] <theme_> eddyb, again, just add &
[23:29:56] <eddyb> theme_: it doesn't work like that
[23:30:12] <theme_> eddyb, just transform into &[T] and &str
[23:30:14] <theme_> right?
[23:30:19] <eddyb> it's not trivial
[23:30:30] <eddyb> maybe with bound-targeting coercions it could work with less impls, in general
[23:30:40] <eddyb> but it's not a given
[23:30:56] * theme_ finds one more unrecognized jargon
[23:31:06] <eddyb> theme_: it's an idea blaenk had
[23:31:43] <theme_> btw who the hell is using my nick?
[23:31:45] <theme_> theme
[23:32:12] <eddyb> theme_: https://github.com/rust-lang/rfcs/pull/803#issuecomment-77681858
[23:32:44] <theme_> hmm
[23:33:15] *** theme_ is now known as theme
[23:33:39] <theme> btw got my old nick back ^_^
[23:33:55] <theme> now... what is that link...
[23:34:46] <theme> eddyb, can't you just do something like `&*vec < slice`?
[23:35:59] <eddyb> theme: direct comparisons are easy to fix
[23:36:03] <eddyb> but think of the generics
[23:36:15] <eddyb> theme: HashMap needs to compare String and str
[23:36:20] *** Quits: tjakubow (tom@moz-783qe0.res.rr.com) (Ping timeout: 121 seconds)
[23:36:21] <theme> oh...
[23:36:27] * theme opens the docs
[23:36:36] <eddyb> see the Q on HashMap::get
[23:36:39] *** Quits: nodweber_ (nodweber@moz-knt.fgq.178.5.IP) (Quit: Leaving...)
[23:37:34] <theme> eddyb, nope
[23:37:39] <theme> eddyb, still just comparing to self
[23:37:51] <eddyb> HashMap<String, T>
[23:37:53] <eddyb> K = String
[23:37:55] <eddyb> Q = str
[23:38:05] <theme> eddyb, which PartialEq are you talking about?
[23:38:11] <theme> I only see Eq there
[23:38:14] <eddyb> theme: unless you're saying the BorrowFrom stuff is handling it
[23:38:22] <eddyb> which might be the case
[23:38:35] <theme> it is
[23:38:42] <eddyb> theme: might be useful to grep for :\s*PartialEq<
[23:39:33] *** Joins: tjakubow (tom@moz-783qe0.res.rr.com)
[23:40:12] <theme> eddyb, what is that regex?
[23:40:26] <theme> oh... wait
[23:40:28] *** Quits: ytain (ytain@moz-d93rt6.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[23:40:32] <theme> I saw :\ as a face O_o
[23:41:01] <theme> hmm
[23:42:25] <theme> 4 results outside cmp
[23:43:09] *** Quits: Guest63 (textual@moz-56c.qli.61.176.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[23:43:33] <theme> eddyb, nope
[23:43:46] <theme> all 4 of them are using PartialEq to implement equality
[23:43:50] <theme> so that's circular
[23:46:00] <theme> Any *real* use cases for non-Self PartialEq/PartialOrd
[23:46:12] <eddyb> theme: it might have been used at one point
[23:46:16] <eddyb> now I'm not sure
[23:46:24] <eddyb> Gankro: ^^ any ideas?
[23:46:34] * theme thinks about demolishing their type parameters
[23:46:37] <eddyb> or rather, information
[23:47:32] <eddyb> theme: they definitely precede deref coercions
[23:47:52] <theme> eddyb, do they precede the collections' Borrow?
[23:48:20] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[23:48:24] <eddyb> theme: that I do not know
[23:48:50] <huon> impl<A, B> PartialEq<[B]> for [A] where A: PartialEq<B>
[23:48:56] <huon> cannot be replaced, afaik
[23:49:17] <theme> huon, that's begging the question
[23:49:24] <huon> why?
[23:49:28] <theme> I asked for a usage of non-Self PartialEq
[23:49:32] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Connection closed)
[23:49:33] <eddyb> OH
[23:49:34] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[23:49:37] <theme> and you gave an implementation of non-Self PartialEq
[23:49:48] <huon> how does one compare [String] == [&str] without that?
[23:49:59] <eddyb> playbot: ["foo", "bar"] == vec!["foo".to_string(), "bar".to_string()]
[23:50:01] -playbot- true
[23:50:04] <theme> huon, does anybody even have to do that?
[23:50:34] <huon> theme: is your question "does anyone want to compare slices"?
[23:50:47] <huon> because yes, you can end up with a slice of String and a slice of &str
[23:50:58] <acrichto> awe: hm ok, if you want to ping me on the PR I'll try to research this and see what's up as well
[23:51:11] <awe> acrichto: Okay, will do.
[23:51:36] *** Quits: eibwen (eibwen@moz-964jo8.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[23:51:39] <huon> theme: (there's lots of tests that do that sort of comparison)
[23:51:52] <huon> create some vector of strings, and compare to a hardcoded expected answer
[23:52:07] *** Joins: jxv (jxv___@moz-qneod7.pk6i.d98i.030a.2602.IP)
[23:52:29] <theme> hmm
[23:53:04] <Gankro> theme largely just conveniences that I'm aware of
[23:53:13] *** Joins: arrrrrrrrr (arrrrrrrrs@moz-qpv06f.dynamic.qsc.de)
[23:53:24] <huon> the type parameters allow us to behave more like mathematics, with isomorphic types being able to be compared
[23:53:33] <huon> "value-isomorphic"
[23:53:36] <theme> huon, you can convert that to an iterator and compare that
[23:53:46] <theme> slightly unergonomic, though
[23:53:49] <eddyb> comparing iterators is not fun
[23:54:11] <huon> yes, you can write `std::iter::order::eq(foo.iter().map(|string| &*string), slice.iter().cloned())` 
[23:54:57] <Gankro> theme maybe ask aturon or japaric|afk 
[23:55:00] <arrrrrrrrr> "more like mathematics"
[23:55:07] <arrrrrrrrr> but <= is fundamentally broken
[23:55:14] <huon> arrrrrrrrr: irrelevant
[23:55:21] <theme> huon, you can just add a `borrow_eq` function
[23:55:30] <huon> theme: to what?
[23:55:37] <theme> to iter::order
[23:55:40] <Gankro> theme still less convenient than ==
[23:55:46] <huon> theme: what about doubleborrow_eq
[23:55:59] <huon> etc.
[23:56:01] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-jj6h6t.dynamic.qsc.de) (Ping timeout: 121 seconds)
[23:56:09] <theme> oh wait
[23:56:15] <Gankro> arrrrrrrrr: please stop trolling
[23:56:17] <huon> adding endless special cases is sad :)
[23:56:22] <theme> we can add .borrowed() to IteratorExt
[23:56:32] <arrrrrrrrr> Gankro: what are you even talking about
[23:56:38] <huon> would really be .reref()
[23:57:01] <theme> arrrrrrrrr, I added a comment https://github.com/rust-lang/rfcs/pull/956#issuecomment-77969917
[23:57:26] <arrrrrrrrr> Gankro: well?
[23:57:49] <huon> arrrrrrrrr: he is clearly talking about your non-contributive comment
[23:57:55] <Gankro> arrrrrrrrr: I'm in a super shitty mood, so not exactly the best judge but you've seemed extra antagonistic lately
[23:58:29] <arrrrrrrrr> Gankro: like what?
[23:59:07] <Gankro> arrrrrrrrr: I'm nto trying to make a case. Not in the mood to troll chat logs to do so.
[23:59:17] <theme> Is an RFC with 6 unresolved questions too many?
[23:59:29] <bstrie> theme: not necessarily
[23:59:38] <theme> here: https://github.com/theemathas/rfcs/blob/unsafe-cmp/text/0000-unsafe-cmp.md#unresolved-questions
[23:59:47] <Gankro> theme: I'd say it'd a warning sign that the design should be tightened up. But it might be acceptable
[23:59:48] <theme> just added the 6th
[23:59:53] <arrrrrrrrr> Gankro: if you've nothing to say then maybe you should not have posted it in the first place
