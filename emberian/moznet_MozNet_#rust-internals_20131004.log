[00:03:55] *** Quits: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP) (Quit: Leaving)
[00:04:00] *** Joins: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP)
[00:04:08] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[00:04:17] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[00:04:40] *** Quits: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP) (Client exited)
[00:04:50] *** Joins: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP)
[00:06:55] *** Quits: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP) (Quit: Leaving)
[00:07:00] *** Joins: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP)
[00:13:22] *** Quits: jdm (jdm@37A83DB4.49EECAFD.30BE9F17.IP) (Quit: Lost terminal)
[00:14:22] *** Quits: kmc (keegan@moz-D2A53639.compute-1.amazonaws.com) (Ping timeout)
[00:37:29] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[00:56:48] *** Joins: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com)
[01:08:52] <cmr> acrichto: woot!
[01:09:02] <cmr> acrichto: is that using the semantics agreed upon at the meeting?
[01:19:49] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:21:08] *** Joins: Yurume_ (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:21:33] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[01:53:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:59:12] *** Joins: kermi (Mibbit@1A165CA0.13E9D2A1.57DA49D3.IP)
[02:00:31] *** Quits: kermi (Mibbit@1A165CA0.13E9D2A1.57DA49D3.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:01:42] *** Joins: nrc (nrc@3496663E.C1499D0.396E4C6D.IP)
[02:14:41] *** Quits: nrc (nrc@3496663E.C1499D0.396E4C6D.IP) (Ping timeout)
[02:39:23] *** Quits: zz_kimundi (kimundi@moz-3DB68F29.dip0.t-ipconnect.de) (Ping timeout)
[02:42:47] *** Joins: zz_kimundi (kimundi@moz-C29F3EBA.dip0.t-ipconnect.de)
[02:42:48] *** zz_kimundi is now known as kimundi
[03:12:04] *** Joins: nrc (nrc@3496663E.C1499D0.396E4C6D.IP)
[03:17:37] <sfackler> is there anything to abstract away keeping a global data structure in a static mut? the use case here is to fix the threading issues with dynamic_library
[03:18:59] <aatch> sfackler, you could use functions to access it.
[03:19:48] <aatch> And use a mutex for access control
[03:19:51] <sfackler> yeah
[03:20:01] <sfackler> oh wait, dlopen already reference counts
[03:20:31] <sfackler> I guess it just needs a mutex then?
[03:21:33] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:21:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/L7dYkQ
[03:21:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:21:33] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:21:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/PFTKyg
[03:21:34] <ghrust> 13rust/06auto 14fbd5639 15Seo Sanghyeon: Correctly report errors for ambiguous default methods
[03:21:34] <ghrust> 13rust/06auto 143f32898 15bors: auto merge of #9711 : sanxiyn/rust/ambiguous-default-method, r=alexcrichton...
[03:21:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:22:20] <aatch> sfackler, depends on the usage, but yeah.
[03:22:37] *** Quits: tikue_ (tikue_star@63FEC8FF.CD72397.689607DE.IP) (Ping timeout)
[03:27:51] <sfackler> wow, unstable::sync::atomically is poorly named
[03:29:54] <sfackler> hmm, can libstd depend on libextra?
[03:30:00] <cmr> sfackler: no
[03:30:17] <sfackler> are there any mutexes in libstd?
[03:30:37] <sfackler> the only one I see is in extra::sync
[03:31:45] <cmr> std::unstable::sync::Exclusive
[03:32:49] <sfackler> thanks
[03:33:37] <sfackler> is rust_little_lock not something I should use?
[03:34:29] <acrichto> sfackler: we're hoping to phase that out
[03:34:45] <acrichto> there is a LittleLock in unstable/sync though
[03:35:33] <sfackler> and that'll give me actual atomicity?
[03:37:09] <sfackler> is there a way to register to run something at runtime initialization? I need to be able to initialize a global lock :/
[03:37:58] <cmr> No
[03:38:46] <sfackler> hmm, really what I want is an equivalent of PTHREAD_MUTEX_INITIALIZER
[03:39:48] <sfackler> I guess i can use a static mut AtomicOption<LittleLock> but that's pretty sadface
[03:41:50] <sfackler> asdfasdfasdfasdfasdf I can't use that because I can't statically initialize the AtomicOption
[03:45:45] *** Quits: nrc (nrc@3496663E.C1499D0.396E4C6D.IP) (Ping timeout)
[03:47:20] <sfackler> acrichto: in https://github.com/mozilla/rust/issues/9137 you said that it looks like the issues are due to races on errno, but errno is supposedly thread local on all posix conforming platforms. the do atomically should actually work there :/
[03:48:04] <sfackler> oh, it's using dlerror, not errno
[03:48:15] <acrichto> I always forget that errno is thread local
[03:48:38] <sfackler> dlerror is not, unfortunately
[03:48:52] <acrichto> yes, I believe your analysis is correct
[03:48:59] <acrichto> man thread-local functions would be awesome
[03:49:09] <acrichto> well... nvmd
[03:49:45] <cmr> rust tasks can migrate betwixt threads
[03:49:47] <sfackler> so I think it may actually be impossible to create a global mutex without requiring a function call to initialize it first
[03:49:51] <cmr> But surely there's a threadsafe dl?
[03:50:15] <cmr> sfackler: the general solution to that is to make it an Option<...> and have it set to none, and check if it's none any time it'd be used.
[03:50:39] <sfackler> but that isn't thread safe! and AtomicOption can't be statically initialized
[03:51:05] <sfackler> The dlerror() function need not be reentrant. A function that is not required to be reentrant is not required to be thread-safe.
[03:51:05] <cmr> sfackler: And generally one does that by having a constructor function that returns a struct, and the only way to call methods is through that struct that can only be gotten through initialization
[03:51:51] <sfackler> right, but we have to guarantee that that struct is a singleton in the case of dynamic library loading
[03:52:36] <sfackler> I guess I could just use a raw pointer and atomic_compare_and_swap D:
[03:53:07] <cmr> Wait
[03:53:16] <cmr> pub static INIT_ATOMIC_BOOL : AtomicBool = AtomicBool { v: 0 };
[03:53:31] <cmr> Can you use that? :P
[03:53:54] <sfackler> I could spin on an atomic bool, but that's kind of sad as well
[04:12:49] *** Yurume_ is now known as Yurume
[04:25:24] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[04:31:32] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:31:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/PFTKyg
[04:31:32] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:36:36] <sfackler> how awful does this seem? https://github.com/sfackler/rust/commit/a248981b1c1ac4622d7346d1ad15979efc5eeb5c
[04:36:37] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:36:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/kJko4Q
[04:36:37] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:36:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:36:39] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/VJWq1w
[04:36:39] <ghrust> 13rust/06auto 141c35643 15Alex Crichton: Implement feature-gating for the compiler...
[04:36:39] <ghrust> 13rust/06auto 14353f77b 15Alex Crichton: Add appropriate #[feature] directives to tests
[04:36:39] <ghrust> 13rust/06auto 1430a18c2 15bors: auto merge of #9703 : alexcrichton/rust/compiler-features, r=cmr...
[04:36:42] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[04:41:32] <aatch> sfackler, it's not amazing, but if it's just for opening the file then it could be worse
[04:42:26] <aatch> I'd definitely say a better way should be used, I just don't know what that way is (probably requires better support for concurrency primitives)
[04:44:51] <sfackler> If we had a statically-initializable mutex, that'd be a more reasonable solution
[04:47:05] <sfackler> could someone push that to try on a windows bot? I think that https://github.com/mozilla/rust/issues/8818 is probably just the threading issue
[04:49:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:49:38] <ghrust> 01[13rust01] 15cmr 04force-pushed 06try from 1424d6a0b to 14d8a3716: 02http://git.io/k471pw
[04:49:38] <ghrust> 13rust/06try 14d8a3716 15Steven Fackler: I am bad and I should feel bad
[04:49:38] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:50:51] <cmr> sfackler: done
[04:50:56] <sfackler> thanks
[04:51:23] <cmr> sfackler: http://buildbot.rust-lang.org/builders/try-win/builds/613
[04:56:06] <sfackler> hmm, I actually don't think that it is a threading issue on windows
[05:02:17] *** Joins: jensnockert (jensnocker@moz-45A1CE58.mobileonline.telia.com)
[05:03:13] *** Quits: jensnockert (jensnocker@moz-45A1CE58.mobileonline.telia.com) (Connection reset by peer)
[05:30:42] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[05:30:51] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:30:51] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14d8a3716 to 14608729c: 02http://git.io/k471pw
[05:30:51] <ghrust> 13rust/06try 141bf8b61 15Tim Chevalier: rustpkg: Make rustpkg tests stop comparing dates...
[05:30:51] <ghrust> 13rust/06try 14608729c 15Tim Chevalier: rustc: Check that the output file is writeable before linking...
[05:30:51] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[05:32:29] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[05:37:10] *** Joins: pnkfelix (pnkfelix@37A83DB4.49EECAFD.30BE9F17.IP)
[05:56:35] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[05:56:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/5IEk-A
[05:56:35] <ghrust> 13rust/06auto 14fa41150 15Benjamin Herr: Remove specific errors for very old obsolete syntax...
[05:56:35] <ghrust> 13rust/06auto 14e44b40c 15bors: auto merge of #9712 : ben0x539/rust/obsolete-syntax, r=pcwalton...
[05:56:35] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[05:57:15] *** Joins: lbergstrom (Adium@moz-7DDD1300.ifiber.telenet-ops.be)
[05:57:45] <cmr> sfackler: so the win32 build failed, it isn't a synchronization bug? *Was* there a synchronization bug to begin with?
[06:00:43] <sfackler> there was a synchronization bug on linux/bsd/osx/android since dlerror isn't thread safe
[06:01:09] <sfackler> the windows error is some problem with cos not being linked into the test binary
[06:10:08] *** Quits: pnkfelix (pnkfelix@37A83DB4.49EECAFD.30BE9F17.IP) (Quit: Leaving.)
[06:11:36] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Client exited)
[06:12:13] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:15:08] *** kimundi is now known as zz_kimundi
[06:32:51] *** Quits: lbergstrom (Adium@moz-7DDD1300.ifiber.telenet-ops.be) (Quit: Leaving.)
[06:44:51] <cmr> I love how scp will happily copy a local file to a local file :\
[06:47:36] *** Joins: jensnockert (jensnocker@moz-605A9437.wireless.lu.se)
[06:49:07] <benh> cmr: did you suddenly gain a file named after a remote host in your working directory? :)
[06:49:18] <cmr> benh: yup! :p
[06:49:20] *** Quits: jensnockert (jensnocker@moz-605A9437.wireless.lu.se) (Connection reset by peer)
[06:49:39] *** Joins: jensnockert (jensnocker@moz-605A9437.wireless.lu.se)
[06:50:16] *** Joins: jensnock_ (jensnocker@moz-605A9437.wireless.lu.se)
[06:50:16] *** Quits: jensnockert (jensnocker@moz-605A9437.wireless.lu.se) (Connection reset by peer)
[06:50:23] <cmr> http://docs.octayn.net/
[06:50:25] <cmr> sfackler: ^
[06:50:40] <cmr> hm, 403
[06:51:15] *** Quits: jensnock_ (jensnocker@moz-605A9437.wireless.lu.se) (Connection reset by peer)
[06:51:20] *** Joins: jensnockert (jensnocker@moz-605A9437.wireless.lu.se)
[06:53:11] *** Quits: jensnockert (jensnocker@moz-605A9437.wireless.lu.se) (Connection reset by peer)
[06:53:58] *** Joins: jensnockert (jensnocker@moz-605A9437.wireless.lu.se)
[06:59:56] <sfackler> awesome!
[07:09:57] *** Joins: lbergstrom (Adium@7AF98CCC.7F57627B.81A53753.IP)
[07:10:01] *** Quits: lbergstrom (Adium@7AF98CCC.7F57627B.81A53753.IP) (Input/output error)
[07:24:30] *** Joins: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP)
[07:24:39] *** Quits: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP) (Input/output error)
[07:26:35] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:26:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/5IEk-A
[07:26:35] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:29:20] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[07:29:41] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:32:05] *** Joins: schubidu25 (schubidu25@moz-FAE37203.superkabel.de)
[07:34:23] <benh> :o
[07:54:47] *** Quits: jensnockert (jensnocker@moz-605A9437.wireless.lu.se) (Input/output error)
[07:58:37] *** flaper87|afk is now known as flaper87
[09:01:37] *** flaper87 is now known as flaper87|afk
[09:07:16] *** flaper87|afk is now known as flaper87
[11:13:48] *** Joins: lbergstrom (Adium@moz-7DDD1300.ifiber.telenet-ops.be)
[11:15:26] *** flaper87 is now known as flaper87|afk
[11:16:16] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[11:16:16] *** ChanServ sets mode: +qo brson brson
[11:17:17] *** Joins: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP)
[11:23:56] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[11:32:15] *** Quits: schubidu25 (schubidu25@moz-FAE37203.superkabel.de) (Client exited)
[11:38:39] *** Joins: nrc (nrc@3496663E.C1499D0.396E4C6D.IP)
[11:40:35] <benh> pnkfelix: I only made with_str_from_to pub out of a desire for consistency with with_str_from (which is used a great total of once outside of the lexer, in parse/comment.rs), I guess it's not a very sound decision :)
[11:41:58] <pnkfelix> benh: yeah I don't really mind, it was more something where I figured "a doc comment isn't as important if it weren't a pub function".
[11:42:42] <benh> I do rather think with_str_from ought to have a doc comment because its behavior of excluding the rdr.curr character is a bit non-obvious :)
[11:43:02] <benh> I'll give you both and make my helper non-pub and document it!
[11:43:19] <pnkfelix> benh: Ah, adding a comment to both does sound like the best of both worlds.
[11:51:48] <pnkfelix> benh: (doing a build now, but might as well ask while it builds): The ad-hoc policy you put into pprust.rs, am I right that it will tend to favor raw string over normal string for "
[11:51:49] <pnkfelix> n
[11:51:51] <pnkfelix> argh
[11:52:00] <pnkfelix> benh: For "\n\n\n" ?
[11:52:04] <benh> yeah :(
[11:52:35] <benh> I went with it because comparing one length to another is the least ambiguous thing I could think of
[11:53:23] <pnkfelix> benh: mm.  Maybe you could have \n and \t count as two characters in both contexts, so that all other things being equal, it will use a normal string there?
[11:53:45] <benh> but note that the --pretty normal mode of rustc doesn't apparently invoke that code for string literals, from what I can tell it tokenizes the original source again and just emits slices of that for literals unless you use --pretty expanded or so
[11:54:26] <pnkfelix> benh: okay, I haven't tried the new code out yet on concrete examples
[11:58:01] <benh> Ideally the pretty printer would try to compromise between ugly literal linebreaks in string literals and breaking the 100 column limit with overlong string literals, but that's starting to sound a bit tricky :)
[11:58:47] <pnkfelix> benh: yeah.  fine-tuning the prettty-printer need not hold up this patch
[12:00:29] *** flaper87|afk is now known as flaper87
[12:02:14] <benh> I'm not really happy with the multiline string situation in rust personally, I think they're confusing to read in about all situations, don't play well with indentation, etc
[12:02:55] <benh> so I'd bias the prettyprinter to avoid raw strings where possible :)
[12:04:35] <benh> This is probably down to coming up with a set of example strings and prefered prettyprinting modes and finetuning some scoring function, hm
[12:08:04] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:11:29] *** Quits: nrc (nrc@3496663E.C1499D0.396E4C6D.IP) (Ping timeout)
[12:17:07] <pnkfelix> benh: the PR looks good to me except for the doc issue with the snowman character
[12:17:45] <pnkfelix> benh: do you think you'll have time to resolve that in some manner, or should I try to investigate our options there ?
[12:18:12] <nmatsakis> benh: do you mean that you don't like the `\` in a string idea?
[12:18:22] * nmatsakis loves that
[12:18:33] <pnkfelix> nmatsakis: what idea?
[12:18:39] <benh> pnkfelix: I don't even seem to build pdfs locally and forgot that there's more to the docs than just viewing them with github's built-in markdown renderer. I'll have to look at it but feel free to suggest non-snowman pdf-compatible characters :)
[12:19:08] <nmatsakis> i.e., "foo....\\n     bar" converts to "foo....bar"
[12:19:25] <pnkfelix> benh: okay, if you're not building pdf's locally ( it used to require pandoc + pdflatex, I think ), then I'll look into it and suggest something.
[12:19:34] <nmatsakis> where \\n is "\" and a newline
[12:19:56] <pnkfelix> nmatsakis: so would "fooâ€¦.
[12:19:58] <benh> nmatsakis: I'm almost onboard with that, but it doesn't work so well if you want a newline and then some indentation in the string, I think
[12:20:01] <pnkfelix> aregh!
[12:20:27] <nmatsakis> benh: it's not for encoding multiline strings?
[12:20:37] <nmatsakis> benh: it's for spreading a single line string across multiple source lines
[12:20:39] <pnkfelix> nmatsakis: so would "fooâ€¦.\n    bar"  would keep the spaces, while "fooâ€¦.\\n    bar"  would drop them?
[12:20:43] <nmatsakis> benh: so maybe i'm just discussing something different
[12:20:45] <benh> Yeah, it's fine for that
[12:21:07] <nmatsakis> pnkfelix: I don't know what "foo...\n   bar" does now? note: by \n I mean a newline in the source, not the characters "\n"
[12:21:14] <nmatsakis> pnkfelix: i'd personally make it an error :)
[12:21:37] <pnkfelix> nmatsakis: right.  Right now I think we just allow newlines in the source.  A string is terminated by a double-quote, and the lexer will keep scanning across newlines.  I think.
[12:22:21] <nmatsakis> yeah, I think that should prob be limited to raw strings? but I don't have a strong opinion
[12:23:18] <pnkfelix> nmatsakis: i think I'd keep the current behavior, for some reason I thought some people expressed happiness with it at some point recently...
[12:23:25] <nmatsakis> as I said, no storng opinion
[12:23:28] <nmatsakis> *strong
[12:23:55] <benh> I'd like to do something silly like making strings two-dimensional, so an embedded newline would cause whitespace to be skipped up to the horizonal position of the opening "
[12:24:03] *** Quits: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP) (Quit: Leaving.)
[12:24:05] <benh> but i suspect there's... no consensus for that ;)
[12:26:30] *** Joins: dbaupp (Thunderbir@moz-B03A1B7A.pa.nsw.optusnet.com.au)
[12:34:14] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[12:34:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[12:41:26] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Ping timeout)
[12:46:08] *** Joins: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP)
[12:46:26] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[12:46:27] *** ChanServ sets mode: +qo brson brson
[12:47:45] *** Quits: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP) (Quit: Leaving.)
[12:51:37] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[12:51:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/WZAJpA
[12:51:37] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[12:51:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[12:51:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/El_3BQ
[12:51:39] <ghrust> 13rust/06auto 14cdb7701 15Alex Crichton: rustdoc: Document what's going on throughout...
[12:51:39] <ghrust> 13rust/06auto 14dfe29e2 15bors: auto merge of #9704 : alexcrichton/rust/rustdoc-comments, r=huonw...
[12:51:39] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[12:57:08] *** Quits: dbaupp (Thunderbir@moz-B03A1B7A.pa.nsw.optusnet.com.au) (Ping timeout)
[12:58:57] *** flaper87 is now known as flaper87|afk
[13:02:36] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Ping timeout)
[13:18:31] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[13:30:20] *** flaper87|afk is now known as flaper87
[13:40:50] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[13:40:50] *** ChanServ sets mode: +qo brson brson
[13:43:09] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[13:43:09] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[13:43:37] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[13:45:19] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[13:46:41] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[13:59:48] *** Quits: lbergstrom (Adium@moz-7DDD1300.ifiber.telenet-ops.be) (Quit: Leaving.)
[14:06:33] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[14:06:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/El_3BQ
[14:06:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[14:11:38] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[14:11:38] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/sYzUNQ
[14:11:38] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[14:11:43] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[14:11:43] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/dLAtIQ
[14:11:43] <ghrust> 13rust/06auto 141a6b6c4 15Vadim Chugunov: Package system runtime dependencies into snapshots
[14:11:43] <ghrust> 13rust/06auto 144e59ab0 15Vadim Chugunov: Package system runtime dependencies into Windows distribution.
[14:11:44] <ghrust> 13rust/06auto 148bb55db 15bors: auto merge of #9662 : vadimcn/rust/package-runtime-deps, r=brson...
[14:11:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[14:24:13] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Ping timeout)
[14:27:15] *** Joins: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP)
[14:30:22] *** flaper87 is now known as flaper87|afk
[14:34:30] *** Quits: pnkfelix (pnkfelix@7AF98CCC.7F57627B.81A53753.IP) (Quit: Leaving.)
[14:34:50] *** zz_kimundi is now known as kimundi
[14:38:03] *** flaper87|afk is now known as flaper87
[14:38:35] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:39:05] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[14:40:52] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[14:53:46] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[15:21:40] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[15:21:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/dLAtIQ
[15:21:40] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[15:30:23] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[15:30:23] <ghrust> 01[13rust01] 15alexcrichton merged 06auto into 06snap-stage3: 02http://git.io/St0XzQ
[15:30:23] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[15:44:11] *** flaper87 is now known as flaper87|afk
[15:58:00] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[15:58:01] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[16:14:48] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[16:23:08] *** Quits: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu) (Ping timeout)
[16:23:08] *** Quits: pauls (pauls@moz-7140CF01.ccs.neu.edu) (Ping timeout)
[16:23:09] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Ping timeout)
[16:23:24] *** Joins: pauls (pauls@moz-7140CF01.ccs.neu.edu)
[16:23:28] *** Joins: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu)
[16:23:33] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[16:32:43] *** Joins: mizar99 (onur@E08635D0.26969B75.8D47ACD1.IP)
[16:36:53] *** Quits: StarLight (StarLight@moz-9E22BD9B.pppoe.avangarddsl.ru) (Connection reset by peer)
[16:56:26] *** flaper87|afk is now known as flaper87
[16:58:14] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[16:58:41] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[16:59:38] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Connection reset by peer)
[16:59:53] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[17:05:25] *** Joins: tjc (tjc@7EA5F9ED.C1499D0.396E4C6D.IP)
[17:05:25] *** ChanServ sets mode: +o tjc
[17:06:11] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[17:07:56] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[17:17:33] *** Joins: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net)
[17:22:19] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[17:28:29] *** Quits: mizar99 (onur@E08635D0.26969B75.8D47ACD1.IP) (Quit: Leaving)
[17:40:02] *** flaper87 is now known as flaper87|afk
[17:40:29] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[17:40:56] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[17:42:40] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[17:45:48] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[17:46:11] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[17:46:50] *** Quits: pauls (pauls@moz-7140CF01.ccs.neu.edu) (Quit: Ignore me!!)
[18:01:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[18:01:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Sj7dfw
[18:01:43] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[18:01:43] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[18:01:44] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ZNtbkg
[18:01:44] <ghrust> 13rust/06auto 14bf6b198 15flo-l: fix some examples in std::rand::Rng
[18:01:44] <ghrust> 13rust/06auto 14a9d54ac 15bors: auto merge of #9715 : flo-l/rust/doc-fixes, r=alexcrichton
[18:01:44] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[18:17:18] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:17:37] *** Quits: tjc (tjc@7EA5F9ED.C1499D0.396E4C6D.IP) (Quit: zzzzzzzzzz)
[18:17:37] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:22:06] *** Joins: tjc (tjc@2E747C8D.C1499D0.396E4C6D.IP)
[18:22:06] *** ChanServ sets mode: +o tjc
[18:27:44] *** Quits: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca) (Input/output error)
[18:38:52] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[18:43:36] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[18:43:45] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[18:55:54] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:56:00] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[19:04:49] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[19:04:52] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[19:10:08] *** Quits: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net) (Ping timeout)
[19:20:38] <Yurume> can someone test this snippet at master? http://codepad.org/BAa7PxzQ
[19:21:08] <cmr> Yurume: llvm assertion
[19:21:59] <Yurume> yeah, I'm not sure what issue is relevant with this error
[19:25:39] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[19:27:04] <Yurume> uhm, how much size does Option<&T> take where T is a trait: one word plus two pointers?
[19:27:35] <cmr> Sounds right.
[19:31:39] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:31:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ZNtbkg
[19:31:39] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:33:38] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[19:36:37] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:36:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pT7kJg
[19:36:37] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:36:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:36:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/YM5LfQ
[19:36:39] <ghrust> 13rust/06auto 149ac175c 15blake2-ppc: rustc: Use static strings in a few literals...
[19:36:39] <ghrust> 13rust/06auto 14c5295f9 15bors: auto merge of #9717 : blake2-ppc/rust/rustc-static-str, r=alexcrichton...
[19:36:39] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:40:46] <Yurume> cmr, I cannot track the bug further, so I gave up and filed an issue: https://github.com/mozilla/rust/issues/9719
[19:42:48] <Eridius> hrm, maybe I should turn llvm assertions back on, if you can get them without hacking the compiler..
[19:43:22] <cmr> Eridius: yeah
[19:53:41] *** Quits: tjc (tjc@2E747C8D.C1499D0.396E4C6D.IP) (Quit: Places to go, people to annoy)
[20:00:54] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[20:00:54] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[20:04:17] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[20:10:23] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[20:22:14] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:33:20] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[20:35:03] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[20:46:41] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[20:46:41] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/YM5LfQ
[20:46:41] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[20:59:13] *** Joins: tikue_ (tikue_star@4DE61C68.AE5E2FB1.689607DE.IP)
[21:06:21] *** Quits: tikue_ (tikue_star@4DE61C68.AE5E2FB1.689607DE.IP) (Ping timeout)
[21:15:36] *** Joins: tikue_ (tikue_star@A50B7535.3B4A6B80.689607DE.IP)
[21:19:26] *** Quits: tikue_ (tikue_star@A50B7535.3B4A6B80.689607DE.IP) (Ping timeout)
[21:21:30] *** Joins: steveklabnik (steveklabn@moz-389D91E.public.wayport.net)
[21:22:24] *** Joins: tikue_ (tikue_star@A50B7535.3B4A6B80.689607DE.IP)
[21:26:02] *** Quits: tikue_ (tikue_star@A50B7535.3B4A6B80.689607DE.IP) (Ping timeout)
[21:26:31] *** Joins: stevekla1nik (steveklabn@moz-389D91E.public.wayport.net)
[21:32:14] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[22:16:23] <acrichto> cmr: when you get a chance, could you benchmark https://github.com/alexcrichton/rust/commit/f0d8b0ddaa9687cd86de05a7d26dbdd4b5d63bdc ?
[22:17:08] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:17:46] <cmr> Whoa why is it using 400MB :S
[22:18:02] <acrichto> I'm not 100% positive it's just this ccache map
[22:18:10] <acrichto> that's what I'm hoping the benchmark will confirm :P
[22:18:38] <acrichto> it's also doing some shady business with csearch::maybe_get_item_ast which may be the source of all the memory
[22:18:46] <acrichto> but this pass is basically a huge spike in memory consumption
[22:19:03] <cmr> Is this the less-mem branch?
[22:19:11] <acrichto> yeah
[22:19:26] <acrichto> I have a feeling that the map isn't actually the source of all the memory hogging
[22:20:16] <cmr> It'll be about 15 minutes
[22:20:24] <cmr> (building now)
[22:21:44] <acrichto> thanks!
[22:35:26] <cmr> acrichto: doesn't look like it: http://i.imgur.com/Eo4iOzK.png
[22:35:45] <acrichto> hmm...
[22:35:52] <acrichto> cmr: I may have another for you soon
[22:36:03] <cmr> I ain't goin' anywhere
[22:36:39] *** Quits: steveklabnik (steveklabn@moz-389D91E.public.wayport.net) (Ping timeout)
[22:36:44] *** Quits: stevekla1nik (steveklabn@moz-389D91E.public.wayport.net) (Ping timeout)
[22:46:17] <acrichto> cmr: https://github.com/alexcrichton/rust/commit/9b74510de523c42878c6bb6fde1e1107d1e743e6 
[22:46:17] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[22:46:24] <acrichto> same branch, different commit
[22:48:36] <cmr> Should be a few more minutes, since I only have to rebuild librustc
[22:50:26] <acrichto> sweet
[22:50:36] <acrichto> cmr: I've told you you're awesome, right?
[22:50:53] <cmr> All I do is make graphs :P
[22:52:03] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[22:52:52] <cmr> Oh, nvm, it'll be a bit more
[22:54:10] <cmr> silly staging
[22:55:57] <cmr> acrichto: bingo: http://i.imgur.com/ULAUMtq.png
[22:56:41] <cmr> Although that's only 200MB
[22:56:45] <cmr> That's still ridiculous
[22:58:29] <engla> still exciting to cut memory by hundreds of MB
[22:59:26] <cmr> yuop!
[22:59:34] <acrichto> cmr: nice!
[22:59:34] <cmr> Now the peak is in linking
[22:59:37] <cmr> Where it *should* be
[22:59:56] <acrichto> our we still have 600MB of stuff lying aruond after translation
[23:00:03] <acrichto> I don't think we have 600MB of LLVM stuf
[23:00:08] <acrichto> although I could be wrong...
[23:01:03] <cmr> I've wondered if we can run compilation in a separate task and then drop the task entirely, but not running any destructors on the llvm stuff, and just run LLVM in a separate thread.
[23:01:29] <acrichto> that's an interesting idea...
[23:01:37] <acrichto> in theory all we need is the llcx and llmod
[23:01:42] <cmr> yeah, that was my thought
[23:01:53] <cmr> last time I brought it up pcwalton said something I don't remember
[23:01:55] *** Joins: nrc (nrc@3496663E.C1499D0.396E4C6D.IP)
[23:02:29] <acrichto> hm, it may be worth looking into again
[23:02:35] <acrichto> if we can get to < 1GB memory on the peak
[23:02:38] <acrichto> that'd be sweet
[23:03:54] *** Joins: brson (brson@moz-7DDD1300.ifiber.telenet-ops.be)
[23:03:55] *** ChanServ sets mode: +qo brson brson
[23:07:46] *** Quits: brson (brson@moz-7DDD1300.ifiber.telenet-ops.be) (Ping timeout)
[23:10:23] <acrichto> cmr: do you generate graphs in a different manner with those imgur links than you do on irfy
[23:10:43] <acrichto> b/c with imgur it looks like linking and translation have the same peaks, but irfy shows that the linking portion has a much smaller peak
[23:11:00] <cmr> acrichto: no
[23:11:06] <acrichto> weird
[23:11:12] <cmr> I mean
[23:11:14] <cmr> yes
[23:11:16] <cmr> no, they're not the same :p
[23:11:21] <cmr> those graphs are generated in the browser by some js dbaupp wrote
[23:11:27] <cmr> using d3 I think?
[23:11:33] <cmr> Mine are made with matplotlib
[23:11:44] <acrichto> I just find it weird that the peaks are so different
[23:11:58] <acrichto> the timeline also looks real differnet, but I figure one is with optimizations and one isn't
[23:12:09] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[23:12:09] *** ChanServ sets mode: +qo brson brson
[23:12:10] <acrichto> actually that would explain it
[23:12:20] <acrichto> optimized LLVM modules are mch much smaller than non-optimized ones
[23:12:35] <cmr> Ah, yeah, the irfy benches use -O
[23:12:44] <acrichto> ah, that would probably explain it
[23:13:06] <acrichto> what'd be really cool is to see what llvm pass was running when
[23:13:41] <cmr> It would be cool! But we can't get that information :(
[23:14:31] <acrichto> I'm gonna try to see what's still lying around from rustc after trans
[23:14:36] <acrichto> and hopefully eliminate all of it
[23:14:43] <acrichto> won't help the peak at all, but I'll sleep better at night :P
[23:16:29] <engla> acrichto: I've got another minichange for rustc. It feels like it should save a few cycles. https://github.com/mozilla/rust/pull/9723  do you have time to review? (I'm still running make check on this)
[23:17:11] <acrichto> haha minichange
[23:17:13] <acrichto> I like that name
[23:17:36] <acrichto> lgtm
[23:18:29] <cmr> Want me to bench it?
[23:19:06] <acrichto> I doubt it'd change much
[23:19:18] <acrichto> but you never know...
[23:19:24] <acrichto> cleaner code is better code
[23:20:04] <engla> cmr: I think it's down in the noise
[23:21:07] <cmr> mm
[23:21:37] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:21:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/BZzP8A
[23:21:37] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:21:41] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:21:41] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/i1W5mg
[23:21:41] <ghrust> 13rust/06auto 1487294c2 15blake2-ppc: Avoid cloning the stack on every `push_ctxt` call in trans...
[23:21:41] <ghrust> 13rust/06auto 148cb3426 15bors: auto merge of #9723 : blake2-ppc/rust/trans-no-push-ctxt-clone, r=alexcrichton...
[23:21:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:21:54] <engla> must be something remaining since local_data could only store @
[23:23:34] <acrichto> oh wait duh
[23:23:37] <acrichto> the ident interner
[23:23:40] <acrichto> is still sitting in TLS
[23:24:11] <acrichto> there's also the whole Session, but that's expected to stick around
[23:24:25] * acrichto ->
[23:24:32] <cmr> -> where?
[23:26:39] <cmr> I take it that means he is leaving/has left :P
[23:36:10] <engla> I guess
[23:38:41] *** Quits: nrc (nrc@3496663E.C1499D0.396E4C6D.IP) (Ping timeout)
[23:46:46] *** Joins: erickt (Adium@79611EE9.A51CB73B.6FBF6D51.IP)
[23:52:40] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[23:55:08] *** Joins: erickt1 (Adium@79611EE9.A51CB73B.6FBF6D51.IP)
[23:55:08] *** Quits: erickt (Adium@79611EE9.A51CB73B.6FBF6D51.IP) (Connection reset by peer)
[23:57:45] *** Quits: erickt1 (Adium@79611EE9.A51CB73B.6FBF6D51.IP) (Ping timeout)
