[00:12:46] *** Quits: James (quassel@moz-dkk1ha.range86-163.btcentralplus.com) (Ping timeout: 121 seconds)
[00:17:07] *** Quits: goyox86 (textual@moz-rvv.00r.255.109.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[00:17:25] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[00:21:32] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[00:23:17] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[00:26:23] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[00:26:24] *** ChanServ sets mode: +ao erickt erickt
[00:27:40] *** Quits: yjv_ (yjv@moz-ll38tk.pa.comcast.net) (Connection closed)
[00:32:10] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[00:33:02] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[00:33:12] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[00:33:59] <Ericson2314> eddyb: think I just though of how to exploit token trees for some parallel parsing
[00:34:12] <Ericson2314> working on POC
[00:36:05] <eddyb> lol
[00:36:44] <Ericson2314> yeah pretty lolsy
[00:37:35] *** Quits: X67r (user@moz-6a2pbf.mullvad.net) (Quit: leaving)
[00:40:47] <eddyb> Ericson2314: probably better than the status quo no matter how silly it may be
[00:42:22] <steveklabnik> Rym: in theory you could git bisect to figure it out, but that would take a while O_O
[00:43:38] <Ericson2314> wat i am getting error with Struct<'x, I + 'x> ( /* no use of 'x */); saying 'x is unused
[00:43:49] <Ericson2314> is just using it in the bound not good enough?
[00:44:16] <eddyb> steveklabnik: asking arielb1 is easier :P
[00:44:27] <eddyb> steveklabnik: it's likely one of his changes anyway
[00:44:45] <eddyb> Ericson2314: yeah, it's not good enough
[00:44:49] <steveklabnik> hehe
[00:44:50] <steveklabnik> truth
[00:44:51] <eddyb> Ericson2314: it's like not having it at all
[00:45:15] <eddyb> Ericson2314: if you really want to parametrize Struct, you need PhantomData
[00:46:14] <Ericson2314> ok
[00:50:11] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:50:40] *** Joins: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP)
[00:59:42] <eddyb> oh
[00:59:52] <eddyb> Ericson2314: so I was sugesting \token for escapes
[01:00:02] <eddyb> Ericson2314: and I realized that's more or less quoting
[01:01:17] <eddyb> Ericson2314: macro_rules! do_it { () => { macro_rules! nested \{ ($x:expr) => ($x + $x) } nested!(1) } }
[01:01:37] <eddyb> Ericson2314: \(...), \[...]  and \{...} are "quoted sequences"
[01:01:50] <eddyb> I was worried that if we allowed this, you would have to escape everything
[01:02:47] <eddyb> macro_rules! capture { ($x:expr) => { macro_rules! nested { \($y:expr) => ($x + \$y) } [nested!(1), nested!(2)] } }
[01:03:26] <eddyb> it's not ', but it looks fine to me
[01:05:13] <Gankro> Ericson2314: Without a usage there's no reasonable way to choose the variance of the lifetime
[01:05:33] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:05:36] <Ericson2314> Gankro: ah
[01:05:43] <Ericson2314> hmm, reading those eddyb
[01:06:42] <eddyb> so basically any token-tree can be quoted, more or less
[01:07:14] <eddyb> and the transcriber skips looking at $ and other things inside, just unquotes it
[01:07:44] <Ericson2314> what is a quoted seq, a token?
[01:08:03] <eddyb> a seq is a token-tree, so a quoted seq would be a different kind of token-tree
[01:08:09] <Ericson2314> ok
[01:08:22] <eddyb> we used to have some magic to automatically quote nested macro_rules invocations, but I think that was hardcoding the name
[01:08:27] <eddyb> which is a nono
[01:08:40] <Ericson2314> oh yeah, yuk
[01:09:08] <Ericson2314> on a diffferent note, I am getting wack error messages about a FnMut bound in an early return
[01:09:35] *** Quits: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP) (Connection closed)
[01:10:21] *** Joins: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP)
[01:11:11] <Ericson2314> eddyb would we true to parse TT-macro defs before parsing actual rust?
[01:15:58] <eddyb> would we true?
[01:19:47] <Ericson2314> s/true/try/
[01:23:25] <eddyb> not sure what you mean... have the macro definitions available before parsing their invocations?
[01:23:39] <eddyb> the design is specifically the way it is to avoid that
[01:24:17] <eddyb> Nim has cleaner "templates" but AFAIK you can't just dump anything in them
[01:24:24] <eddyb> maybe if you have some kind of quoted token stream
[01:26:51] <Ericson2314> i mean if our macros are supposed to operate on token trees
[01:27:30] <Ericson2314> should we be able to deal with higher-order macros before parsing actual rust?
[01:29:53] <eddyb> yeah, they work on token-trees
[01:30:10] <eddyb> Ericson2314: a few months ago pczarn did some work towards making HOMies possible
[01:31:39] *** Joins: summerlight (summerlight@moz-lb3.6do.193.175.IP)
[01:35:07] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:37:49] <Ericson2314> cool
[01:37:57] <Ericson2314> well i g2g but will post the parsing thing after
[01:38:12] <eddyb> Ericson2314: but they don't work well due to the escaping problem
[01:38:30] <eddyb> Ericson2314: otherwise you could pass ($x:expr) => ($x + $x) to a macro
[01:38:52] <eddyb> $lhs:tt => $rhs:tt would match that
[01:39:05] <eddyb> actually, that might work *right now*
[01:40:53] <eddyb> macro_rules! apply2 { ($a:expr, $b:expr; $($mac:tt)*) => { macro_rules! nested { $(mac)* } (nested!(a), nested!(b)) } } apply2!(2, 5; ($x:expr) => ($x + $x))
[01:40:58] <eddyb> oops
[01:41:03] <eddyb> playbot: macro_rules! apply2 { ($a:expr, $b:expr; $($mac:tt)*) => { macro_rules! nested { $(mac)* } (nested!(a), nested!(b)) } } apply2!(2, 5; ($x:expr) => ($x + $x))
[01:41:04] -playbot- output truncated; full output at: http://bit.ly/1G2cBE4
[01:42:18] <eddyb> Ericson2314: probably quoting interfering with it
[01:42:33] <eddyb> that logic I mentioned might still be in
[01:42:45] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[01:44:46] *** Joins: Feyn (aram@moz-5vj.68e.115.42.IP)
[01:46:38] <Gankro> nrc: I feel this bikeshed in my bones
[01:47:00] <Gankro> It may be the only bikeshed I have ever truly cared about
[01:47:07] <Gankro> Mostly that reem is wrong
[01:47:18] <Gankro> about where clause alignment
[01:47:34] <Elaine> Anyone on a StrangeBSD (not Free, not Open) that can poke at poll.h and tell me if pollfd has more than the standard 3 fields?
[01:47:49] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[01:47:50] <nrc> I feared the bikeshed
[01:48:14] <eddyb> nrc: I welcome the bikeshed
[01:48:32] <eddyb> nmatsakis has used too many variations
[01:48:47] <eddyb> I often see 3 different styles in 3 consecutive functions
[01:48:50] <Elaine> he must be stopped!!!!
[01:48:52] <Elaine> :P
[01:48:55] <nrc> ha! that is so true
[01:49:06] <Elaine> RFC 1190, aka nmatsakis's intervention.
[01:49:35] <eddyb> I don't like { on its own line because it looks out of place compared to everything else
[01:49:49] <nrc> I believe the style I proposed is one of them, but I might be wrong
[01:49:52] <Elaine> My tastes are the same as eddyb's.
[01:50:04] <nrc> see I like, it adds some nice visual separation between signature and body
[01:50:06] <eddyb> but you need *something* with where clauses
[01:50:13] <Elaine> But I really don't care as long as my vim and rustfmt agree.
[01:50:22] <nrc> and makes it easy when scanning the left hand margin
[01:50:24] <eddyb> because otherwise you have `where` and the first line of code at the same level
[01:50:28] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Connection closed)
[01:50:33] <eddyb> and that's annoying
[01:50:41] *** Joins: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP)
[01:50:44] <nrc> also, I'm used to it because that is Gecko style
[01:51:11] <eddyb> also Pedigree but I've always used same-line for my own projects
[01:51:24] <eddyb> https://github.com/rust-lang/rfcs/pull/1190#issuecomment-118672905 I've already stated my preference
[01:51:43] <eddyb> multi-line where clauses might still be suboptimal, but that impl block is delicious
[01:52:15] <eddyb> I could have it printed on edible paper and eat it nom nom
[01:52:33] <eddyb> (on a totally unrelated note, where is WindowsBunny?)
[01:52:41] <reem> Gankro: nothing else is comfortable imo
[01:52:44] <Elaine> they were around earlier.
[01:52:53] <reem> if you indent them once they end up lining up with the statements in the function
[01:52:58] <reem> if you indent them twice it looks bizarre
[01:53:08] <eddyb> reem: where?
[01:53:13] <reem> if you stick them on the end and put bounds on the next line it‚Äôs the same problem
[01:53:15] <WindowsBunny> eddyb: here
[01:53:16] <reem> yes
[01:53:25] <eddyb> reem: have you tried not indenting them?
[01:53:32] <WindowsBunny> eddyb: Oh, you mean why my opinion is not yet on that rfc?
[01:53:36] <reem> eddyb: that is what I usually do 
[01:53:36] <Gankro> reem: I'm really sorry that you suffer from this disease
[01:53:40] <eddyb> reem: lovely
[01:53:56] <reem> eddyb: or if it fits after the return type I put it there
[01:54:00] <eddyb> though I don't see you on the RFC
[01:54:16] <eddyb> WindowsBunny: no, just food things
[01:54:30] <WindowsBunny> eddyb: food things? o_0
[01:54:49] <eddyb> WindowsBunny: like edible paper with sugary syntax highlighted code
[01:55:05] <eddyb> Elaine: why would you bring leading comma to the Rust community?
[01:55:11] <Elaine> :)
[01:55:18] <eddyb> I tried reading npm code once
[01:55:26] <Elaine> it's good enough for js, it's good enough for rust!
[01:55:32] <reem> leading comma‚Äôs are way too popular in js
[01:55:38] <Elaine> they aren't popular enough!
[01:55:47] <ytain> i prefer { on its own line, I speak from experience and in dealing with the finance guys who audit the source code
[01:55:49] <eddyb> reem: I think it's Stockholm syndrome
[01:55:54] <eddyb> reem: I haven't seen them before npm
[01:56:00] <Elaine> it's the premier unambiguous comma placement.
[01:56:00] <WindowsBunny> eddyb: Oh, I think your idea is cool
[01:56:08] <eddyb> WindowsBunny: it's not entirely original
[01:56:08] <reem> it makes sense in the context of using one var for a bunch of new variables
[01:56:08] <WindowsBunny> eddyb: like, really cool
[01:56:22] <eddyb> (like, not at all. thank Quxxy)
[01:56:25] <WindowsBunny> eddyb: I don't care, I'm going to nom on it
[01:56:39] <eddyb> oh, the edible paper
[01:56:41] <reem> since it‚Äôs harder to screw up and do var x;\n y; when you meant var x,\n y;
[01:56:45] <Gankro> Elaine: No it's stupid because it just makes prepending hurt instead
[01:56:45] <eddyb> I forgot what we were talking about :P
[01:57:00] <reem> but the easier thing is to just use var x; var y; or don‚Äôt bother forward-declaring everything
[01:57:12] <eddyb> let, yo
[01:57:50] <reem> Gankro: what is your preference for where clauses?
[01:58:16] <eddyb> https://www.google.ro/search?q=leading+commas+considered+harmful
[01:58:23] <eddyb> first result: Syntactically Significant Whitespace Considered Harmful
[01:58:24] <eddyb> lol
[01:58:29] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[01:58:35] <Elaine> see, nobody hates it!
[01:58:56] <eddyb> I was seriously hoping that would produce something
[01:58:56] <reem> ‚ÄúX considered harmful‚Äù is borderline clickbait at this point
[01:59:40] <Gankro> reem: https://gist.github.com/Gankro/daf2040a379d1a3a365f
[02:00:02] <Gankro> (the return may be same-line depending on how long the args are)
[02:00:18] <reem> oh jeez, return type on new line *and* newline before braces
[02:00:34] <eddyb> and unaligned ->
[02:00:49] <reem> I can‚Äôt stand braces on their own line, so I am predisposed to dislike this solution
[02:01:21] <eddyb> Elaine, reem: we brace our stand
[02:01:35] <eddyb> {^}
[02:01:42] <Gankro> It makes it easier for me to basically enter panic-mode tokenizing until I hit the body
[02:02:00] <reem> compare to https://gist.github.com/reem/69a753a3be82104cdf34
[02:02:04] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[02:02:06] <ytain> question regarding the {, if it's not on a new line, it could cause some problems for text editors that fold (hide) the block within the curly braces
[02:02:08] <eddyb> Gankro: ahhhh ahaha
[02:02:11] <Gankro> "reject tokens until I hit  brace on own line"
[02:02:14] <reem> nearly half the lines
[02:02:21] <eddyb> ytain: only if the editor does it wrong
[02:02:44] <ytain> eddyb I know
[02:02:50] <eddyb> the only issues I have with kate is that it remember folded code even if the delimiters have moved. not rebase-friendly
[02:03:02] <eddyb> and I can't get it to wipe its cache, though I know what file it's in
[02:03:04] <Gankro> reem: I'm not concerned with saving lines on super-complicated fn declaration
[02:03:41] <reem> mmm, true, but I think where clauses often show up in non-complicated fn‚Äôs too
[02:04:01] <reem> and there compression helps
[02:04:04] <eddyb> like anything taking a closure
[02:04:08] <Elaine> I have a personal vendetta against <T: Foo> in preference to where clauses.
[02:04:30] <reem> I basically only use <T: Foo> if it‚Äôs one bound and there are no more than two type variables
[02:04:38] <Gankro> Elaine: That's a twisty sentence; do you favour <T: Foo> or not?
[02:04:40] *** Joins: skeuomor1 (skeuomorf@moz-uql.u9l.32.197.IP)
[02:04:47] <Elaine> Gankro: I do not favour <T: Foo>
[02:04:50] <reem> otherwise it pushes the start of the argument list too far to the right
[02:04:59] <eddyb> Elaine: would be nice if given certain arbitrary requirements <T> could be omitted
[02:05:14] *** Quits: summerlight (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[02:05:20] <Elaine> eddyb: eh, I think that'd just be confusing about the scope of type parameters, especially once we have functors.
[02:05:37] <reem> more than that, adding struct T; to a file would explode everything
[02:06:00] *** Quits: skeuomorf (skeuomorf@moz-j60.sa8.32.197.IP) (Ping timeout: 121 seconds)
[02:06:15] <eddyb> hehehe
[02:06:32] <eddyb> Elaine: yeah, I know. type systems are hard to make pretty
[02:06:48] <eddyb> and usable, at the same time
[02:07:56] <Gankro> Should use jblows syntax: fn foo(x: $T, y: T, z: $U) -> T {
[02:08:38] <reem> not bad actually, but we get enough bad PR for sigil soup already (even though we killed most of the sigils‚Ä¶)
[02:08:40] *** Joins: summerlight (summerlight@moz-lb3.6do.193.175.IP)
[02:08:48] *** Joins: Havvy (Havvy@moz-tb54ql.airspeedinternet.net)
[02:08:55] *** Quits: skeuomor1 (skeuomorf@moz-uql.u9l.32.197.IP) (Ping timeout: 121 seconds)
[02:08:57] <Elaine> reem: now we get crap for Rc<RefCell<T>>!
[02:09:05] <Elaine> Just wait until we add @mut back, and people love it.
[02:09:25] <Gankro> Elaine: At least we don't have `Rc Refcell T`
[02:09:50] <Elaine> Gankro: I think you mean 'a refcell rc :P
[02:09:57] <reem> Rc{<[RefCell{<[T]>}]>} muahaha
[02:10:13] <Elaine> lol
[02:10:33] <Gankro> Should use XML
[02:10:53] <Elaine> Yeah, syntax is too annoying, let's just straight to the structure.
[02:11:15] <reem> honestly though our current syntax is pretty annoying for making lots of small functions, especially composed out of one another
[02:11:35] <reem> so many redundant types and blocks
[02:11:46] <Gankro> reem: start submitting PRs to slag ;)
[02:12:02] <Elaine> What's slag?
[02:12:14] <reem> I wish we had a shorthand for one-expr functions, fn name(a, b) = other(a) + other(b);
[02:12:42] * reem also wonders what slag is
[02:12:53] <Gankro> Elaine: But real talk `where for<'a> F:` or `where F: for<'a>` 
[02:12:58] <Gankro> WAT
[02:13:01] <Gankro> clipboard plz
[02:13:29] <Gankro> Elaine: reem: https://github.com/mystor/slag/blob/master/examples/example.slag
[02:13:42] <reem> for<‚Äòa> F and F: for<‚Äòa> have different semantics?
[02:13:48] <Elaine> ohhh
[02:13:58] <Elaine> "Should I use this: no"
[02:14:00] <Elaine> nice.
[02:14:01] <reem> oooh coffeerust 
[02:14:24] <Elaine> it's... simple too.
[02:14:26] <Elaine> too simple.
[02:14:30] <Elaine> this can't be correct.
[02:14:37] <Gankro> Elaine: It's really not
[02:15:00] <Gankro> semicolon placement is incredibly context sensitive in Rust
[02:15:07] <Elaine> yeah
[02:16:55] <Gankro> Which I think is a proof that Rust is a terrible language and we should feel bad :P
[02:18:25] <eddyb> <3 animal support
[02:18:45] <Havvy> Gankro:  Nah, it's because Rust makes the same mistake as C of using `[]` for indexing. ;)
[02:19:18] <WindowsBunny> Havvy: The solution is to expand our keyboards
[02:19:24] *** Quits: kimundi (kimundi@moz-22fjhj.o533.1q3j.4fe2.2002.IP) (Ping timeout: 121 seconds)
[02:19:31] <Gankro> Only functions, no operators
[02:19:37] *** Quits: cods (fred@moz-g6qd4k.net) (Ping timeout: 121 seconds)
[02:20:11] <eddyb> Gankro: and first-class lvalues?
[02:20:19] <eddyb> WE MUST RESIST
[02:20:28] <Gankro> eddyb: I don't know what that means
[02:20:37] <eddyb> Gankro: do you know what T& is in C++?
[02:20:38] <Gankro> I'm going to assume that's the same as first class agregates
[02:20:43] <eddyb> no, it's not
[02:20:54] <eddyb> you can return this kind of reference from a function and write
[02:20:56] <Havvy> Only functions, no operators = FORTH
[02:21:00] <eddyb> f(x) = g(x);
[02:21:08] <eddyb> and that would perform an assignment
[02:21:33] <Havvy> The assignment would be to *T, right?
[02:21:45] <eddyb> no, T&
[02:21:49] <eddyb> map[key] = value in C++ is map.operator[](key) = value
[02:22:06] <eddyb> you could implement operator() instead and use it like map(key) = value
[02:22:19] <eddyb> C++ *does not need* to use [] for indexing
[02:22:40] <eddyb> it's like one of the few languages ever that lets you do that
[02:23:11] <eddyb> it's also well known for its use of <> and the highly convoluted type resolution logic during parsing
[02:23:20] <Havvy> I can only imagine that it would cause a lot of confusion in Rust.
[02:23:36] <eddyb> Gankro: can you smell the irony?
[02:24:06] <eddyb> C++ is the only language I know which can cleanly handle () for indexing
[02:24:31] <Gankro> Doesn't like scala do that or something?
[02:24:32] <eddyb> on library-defined collections and whatnot
[02:24:39] <eddyb> Gankro: I think Scala's is hackier
[02:24:51] <eddyb> (ignoring the elephant in the room, first-class lvalues)
[02:25:00] <reem> implement Fn(K) -> &V/FnMut(K) -> &mut V for your map type and you can get very close with *map(key) = value; in rust
[02:25:11] *** Joins: kimundi (kimundi@moz-d91h8n.dip0.t-ipconnect.de)
[02:25:20] <eddyb> Gankro: apparently they have sugar for expr(expr) = expr
[02:25:41] <eddyb> it's a GC language so array(i) copies
[02:25:59] <eddyb> JS could've done what Scala does, more or less
[02:26:23] <WindowsBunny> C++'s lvalue & stuff is pretty cool
[02:29:34] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[02:33:04] *** Quits: petercommand (peter@moz-geqcp0.com) (Ping timeout: 121 seconds)
[02:33:05] *** Joins: adu (ajr@moz-99ult9.md.comcast.net)
[02:33:22] <Gankro> nrc: I want this to beat int/uint
[02:34:13] *** Joins: petercommand (peter@moz-geqcp0.com)
[02:34:35] *** Quits: ytain (ytain@moz-upqesl.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[02:35:40] <Gankro> I need this to beat int/uint
[02:37:59] <nrc> :-(
[02:38:56] <Gankro> nrc: ?
[02:43:58] <nrc> I was hoping that everyone would agree with my proposal without debate and I could get it merged by the end of the week :-p
[02:44:15] <eddyb> nrc: that's what I thought about '_
[02:44:41] <eddyb> but then niko went on vacation
[02:44:46] * nrc remembers to read the comments on that...
[02:45:04] <eddyb> nrc: I am fine with disabling elision but I want some consensus
[02:46:29] <nrc> Yeah, I guess we need to discuss with Niko. On the plus side it does seem like something everyone wants, just need to agree on the exact semantics
[02:48:06] <Gankro> wait what
[02:48:09] <Gankro> disabling elision
[02:48:13] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:52:29] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[02:57:15] <Gankro> yesss burntsushi feed the chaosss
[03:04:52] <eddyb> Gankro: that was about the '_ RFC
[03:05:38] <Gankro> eddyb: It would be nice to not have the RFC written in terms of random implementation details of the compiler
[03:06:14] <eddyb> Gankro: that was mostly to point out that "hey we have to work around '_ being a valid named lifetime"
[03:06:25] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Connection closed)
[03:06:29] <eddyb> Gankro: but I'll rewrite it once a consensus is reached on elision
[03:16:34] *** Joins: semarie (semarie@moz-lv0q9f.bpv6.bg1u.41d0.2001.IP)
[03:20:09] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[03:20:09] *** ChanServ sets mode: +ao erickt erickt
[03:22:46] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[03:26:20] *** Quits: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[03:31:10] *** Quits: rustbot (havvy@moz-tb54ql.airspeedinternet.net) (Ping timeout: 121 seconds)
[03:33:11] *** Quits: Havvy (Havvy@moz-tb54ql.airspeedinternet.net) (Ping timeout: 121 seconds)
[03:35:56] *** Joins: RC9 (RCIX@moz-c24.dfa.8.198.IP)
[03:36:48] *** Joins: Havvy (Havvy@moz-tb54ql.airspeedinternet.net)
[03:37:17] *** Joins: rustbot (havvy@moz-tb54ql.airspeedinternet.net)
[03:37:45] *** Joins: ptalbot_ (ptalbot@moz-6oebfn.dyn.as47377.net)
[03:38:31] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[03:38:59] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[03:40:36] *** Joins: yjv_ (yjv@moz-ll38tk.pa.comcast.net)
[03:41:48] *** Quits: ptalbot_ (ptalbot@moz-6oebfn.dyn.as47377.net) (Ping timeout: 121 seconds)
[03:42:19] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[03:44:17] <Elaine> nrc: It seems like everyone agrees with eddyb at least ;)
[03:44:49] *** Quits: yjv_ (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[03:45:49] *** Joins: p1start (p1start@moz-nftjhe.org)
[03:46:00] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[03:47:59] <nrc> people are really allergic to newline braces. They should hack on the compiler more - I'm a convert!
[03:48:42] <Mutabah> nrc: "newline braces" being ... -> RetType \\ { \\ ?
[03:51:23] <nrc> yes
[03:52:31] <Mutabah> I tend to like that form too
[03:52:48] <Mutabah> but it does depend on what the body is... I'm messy/pragmatic :D
[03:53:58] *** Joins: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP)
[03:58:27] <nrc> I tend to like less compact layouts more and more recently - extra whitespace makes things easier to scan quickly
[03:58:53] <nrc> I don't mind scrolling too much either
[03:59:12] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Connection closed)
[04:08:38] *** Joins: summerlight_ (summerlight@moz-lb3.6do.193.175.IP)
[04:09:32] *** Joins: rkruppe (chatzilla@moz-a35phg.diu2.0rth.0908.2a02.IP)
[04:12:20] *** Quits: summerlight (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[04:12:38] *** Quits: adu (ajr@moz-99ult9.md.comcast.net) (Client exited)
[04:13:39] *** Quits: rkruppe (chatzilla@moz-a35phg.diu2.0rth.0908.2a02.IP) (Ping timeout: 121 seconds)
[04:19:05] <Gankro> +1
[04:19:34] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[04:19:53] <Gankro> Too many people traumatized by K&R zealots
[04:20:18] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[04:21:03] <eddyb> haha there's new comments
[04:21:35] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[04:22:01] *** Quits: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[04:22:28] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[04:22:48] *** Tuba is now known as Tobba
[04:24:20] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[04:27:01] <reem> I honestly cannot stand { on a newline
[04:27:24] <reem> soooo much wasted space
[04:27:41] * Gankro is hyped that the hype is building
[04:28:18] <eddyb> wait
[04:28:41] <eddyb> Gankro: so while that hype is going on, a new RFC PR was opened
[04:28:45] <nrc> more whitespace => easier to read, source code as typographic art
[04:29:05] <Gankro> nrc: Can we require code to be written with caligraphy pens?
[04:29:10] <eddyb> "I propose splitting the AST into a libsyntax version that is specialised for syntactic operation and will eventually be stabilised for use by syntax extensions and tools"
[04:29:58] <nrc> Gankro: yes! But only if you can write with strict monospacing
[04:30:02] <eddyb> nrc: okay, for, if let and while let are good enough reasons to specialize the AST
[04:30:42] <nrc> I'm on an RFC roll!
[04:30:43] <eddyb> stabilizing the AST does not seem reasonable to me, and I like the direction syntex is taking
[04:30:45] <reem> nrc: I see where you are coming from, but I‚Äôd rather be able to keep more things in view
[04:31:08] <eddyb> nrc: so one thing we were discussing a while back, is using type parameters to specialize the AST, to "turn off" variants
[04:31:10] <nrc> eddyb: that is a very long term goal
[04:31:19] <nrc> (specialising)
[04:32:01] <eddyb> plugging ! (or just some Void empty enum) as a type param would make some variants disappear from ADT layout and codegen
[04:32:04] <nrc> I believe it is necessary in the long term for the sake of tools
[04:32:24] <eddyb> so what I'm wondering is...
[04:32:31] <eddyb> is it worth to have both a HIR and a MIR?
[04:32:38] *** Joins: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP)
[04:33:00] <eddyb> with a MIR you could expand for loops during/around typeck
[04:33:05] <nrc> eddyb: more long term I think the HIR and AST should diverge more - e.g., HIR will have done partial name resolution, etc
[04:33:46] <nrc> I think it is worth having a hir and mir - they are both optimised for very different tasks - HIR is not great for borrow checking or trans, MIR is not great for type checking
[04:34:06] <eddyb> ehm, why wouldn't it be?
[04:34:12] <eddyb> (MIR and typeck)
[04:34:18] <nrc> I imagine there would be a tonne of lowering you could do post-type check converting HIR to MIR
[04:34:33] <eddyb> not exactly
[04:34:39] <eddyb> nrc: the lowering *is* typeck
[04:34:57] <nrc> The kind of MIR we've been discussing is pretty low level, it removes a tonne of info, almost certainly too much to allow type checking
[04:35:01] <eddyb> that's what MIR was always about, making typeck lower the AST into something typed and with explicit adjustments
[04:35:13] <eddyb> nrc: ah, different discussions
[04:35:18] <nrc> right, that is the HIR-> MIR lowering in my mind
[04:35:21] <eddyb> sounds more like LIR than MIR from where I stand
[04:35:58] <nrc> heh, a LIR to me would be an SSA thing similar to LLVM IR, but a little higher level - knows about far pointers, DPS, etc.
[04:37:05] <eddyb> I think I see the issue: I wasn't saying you would typeck *on* the MIR, but rather typeck *into* it
[04:37:10] <nrc> reem: I guess it comes down to preference - I don't value seeing more things at once too highly - I tend to have multiple windows/desktops if I need to, or just make the font smaller
[04:37:30] <nrc> eddyb: ah right, then I think we are in agreement :-)
[04:37:32] <ChrisMorgan> nrc: could you add syntax highlighting on your comments (change the opening ``` to ```rust, presuming you‚Äôre using that form of code blocking)?
[04:37:43] <reem> nrc: It certainly is a matter of opinion, that much is clear :)
[04:37:53] <eddyb> ChrisMorgan: he gets away with it because I don't have permissions on the RFC repo
[04:38:14] <eddyb> I started editing other people's issue descriptions to add syntax highlighting on rust-lang/rust
[04:38:24] <eddyb> hope it's not against the CoC
[04:38:26] <reem> except for the placement of {, putting it on the same line is objectively better :P
[04:39:12] <Gankro> reem: That's the zealotry I expect!
[04:39:14] <aatch> eddyb, unless you modify the meaning of the text, I doubt it.
[04:39:17] <nrc> ChrisMorgan: I'm not sure I want to - I think looking at the style in black in white is useful, using syntax highlighting means we might rely on things getting coloured a certain way, and then we are at the mercy of the tools
[04:39:36] <ChrisMorgan> nrc: I do, of course, have a hidden agenda in requesting this thing.
[04:39:40] <nrc> * black and white
[04:40:26] <aatch> eddyb, I've made similar edits, like wrapping backtraces in "```"
[04:40:39] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[04:41:01] <eddyb> nrc: I like neutral bold for keywords
[04:41:15] <eddyb> makes them easier to spot than regular thin colored code IME
[04:41:29] <ChrisMorgan> nrc: standard usage *will* be highlighted, however. GitHub‚Äôs styles are comparatively subtle, too (for me, the standard keywords are a bold reddish color (ctermfg=161)).
[04:41:38] <eddyb> then again, at 7pt there's barely any difference :P
[04:42:37] <eddyb> I like how nobody commented on the impl Trait in my example
[04:42:37] <ChrisMorgan> eddyb: that‚Äôs distressingly tiny.
[04:43:03] <eddyb> ChrisMorgan: I needed it on my rather small laptop screen and then I adjusted
[04:43:06] * ChrisMorgan noticed and smiled
[04:43:33] <eddyb> changed KDE font size to it (though I don't know how to make chrome downscale everything)
[04:45:13] <ChrisMorgan> eddyb: I tried comparatively large text at one point (16px/12pt instead of 11‚Äì13px) and was surprised at how much easier it was to work with, even though I could read the smaller stuff with no trouble. I‚Äôve kept the comparatively large text. I apply that rule elsewhere, too‚Äîweb pages I design will stay at font-size: 16px as a rule rather than silly things like 12px.
[04:45:51] <nrc> eddyb: I could tell you if you used Firefox :-)
[04:46:00] <eddyb> I knew someone was going to say that
[04:46:20] <nrc> Once we're done bikeshedding on formatting, we can sort out colours for syntax highlighting...
[04:46:26] <eddyb> I couldn't get firefox to work without leaking memory such that closing all tabs would still use more than 1GB of RAM
[04:46:27] <Gankro> nrc: devPixelsPerPx is a top-10 flag, if only for the name
[04:46:57] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[04:47:02] <nrc> Gankro: that's what I use
[04:47:11] <Gankro> Right up there with chrome's allow-file-access-from-files
[04:47:17] <nrc> (although to make things bigger, rather than smaller)
[04:47:22] <ChrisMorgan> nrc: I use Firefox, can you tell me how to downscale everything in Chrome?
[04:47:49] <Gankro> ChrisMorgan: Run chrome in emscripten in firefox?
[04:47:56] <nrc> ChrisMorgan: step 1: close Chrome, step 2: open Firefox, ...
[04:48:13] <ChrisMorgan> My idea was downscaling it to zero with `killall chrome`.
[04:48:24] *** Quits: swgillespie (swgillespie@moz-pcs.a8v.130.12.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[04:48:43] <WindowsBunny> ChrisMorgan: My font size is just big enough so that I can fit two 100 column editors side by side on my 1080p screen
[04:49:22] <nrc> eddyb: dodgy extension? Firefox is generally pretty good at not leaking now. If you have that kind of leak with no extensions, you should file a bug and get njn to help you debug it - it'll be fun!
[04:49:34] * njn ducks
[04:49:51] <eddyb> I have enough fun *without* mucking with my browser more than twice a month tyvm
[04:49:59] <ChrisMorgan> Hmm, for me on my 1920√ó1080 laptop screen, my terminal is 212√ó60.
[04:50:26] <njn> eddyb: FWIW, all roads lead to about:memory
[04:51:35] * ChrisMorgan could not seriously contemplate using Chrome as his primary browser; whose idea was a single tab line per window with infinitely shrinkable tabs?
[04:52:04] <eddyb> ChrisMorgan: it scales!
[04:52:12] <Gankro> ChrisMorgan: You're describing firefox...
[04:52:15] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[04:52:27] <eddyb> I learned to use a web browser without named tabs, basically
[04:52:43] <nrc> ChrisMorgan: this might be a great UI hack for the fact that memory use with lots of tabs is terrible with Chrome
[04:52:46] <ChrisMorgan> Gankro: no I‚Äôm not, for two reasons: (a) scrolling rather than infinitely shrinking; (b) Tree Style Tab.
[04:52:49] <eddyb> relative spatial memory aka "somewhere on the far left"
[04:52:59] <ChrisMorgan> nrc: that‚Äôs my guess.
[04:53:02] <Gankro> ChrisMorgan: Bah! Extension heathens!
[04:53:09] <eddyb> nrc: yeah but that's not how you use Chrome
[04:53:18] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[04:53:19] <eddyb> nrc: you open the activity manager and kill all your processes
[04:53:30] <nrc> interesting UI...
[04:53:31] <eddyb> then you can keep 300 tabs open with barely any RAM usage
[04:53:40] <eddyb> I need something to automate this
[04:53:43] <reem> I just this extension which freezes tabs that I haven‚Äôt looked at in a while
[04:53:47] <sp3d> is content-addressed tabs a common browsing paradigm these days?
[04:53:56] <eddyb> reem: does it evict the tab from RAM?
[04:53:57] <reem> so I have like 100 tabs in chrome and very low memory usage
[04:54:08] <eddyb> ugh I need that
[04:54:11] <reem> ‚Äúvery low‚Äù
[04:54:15] <reem> less than chrome without it
[04:54:34] <reem> it‚Äôs called The Great Suspender
[04:54:43] <eddyb> btw, my editor can do 295 columns on my 1440x1050 (IIRC, or maybe it's smaller) LCD
[04:55:12] *** Joins: Quxxy (chatzilla@moz-0nv.jkp.167.59.IP)
[04:55:27] <eddyb> and that's with wasteful 20px-ish sidebars on both sides and line numbers and folding markers and a 100px-wide scrollmar (w/ minimap)
[04:55:57] <eddyb> and 74 rows
[04:56:18] <ChrisMorgan> eddyb: I have a total of 4px wasted horizontally on normal windows.
[04:56:51] <ChrisMorgan> My IRC client lives in its own workspace (i3 window manager) and has title/border turned off, so it has no horizontal space wastage at all.
[04:57:14] <eddyb> just got rid of the sidebars: 306 columns
[04:57:47] <eddyb> 138 on half the screen width, which is what it normally stays at
[04:58:49] <eddyb> nrc: my issue with duplicating the AST is mainly that it already sucks to maintain
[04:59:15] <eddyb> it feels like there should be a nicer way to handle it
[05:00:07] <ChrisMorgan> My sizes are really quite neat: with a terminal taking half the screen width, columns=106, which is just right for textwidth=100 plus line numbers in Vim ‚ò∫
[05:00:22] <eddyb> nrc: oh oh oh
[05:03:01] <eddyb> nrc: I left a comment, I finally see a way this HIR thing could work
[05:03:32] <eddyb> nrc: I've been pondering flattening some of the T in AST
[05:05:15] <eddyb> nrc: that's probably the biggest win so far, nested items suck so bad :D
[05:15:55] <Mutabah> Anyone know why rustc isn't including libcore in my link (using a custom target, and referencing libraries that use libcore)
[05:18:56] *** Quits: eddyb (eddyb@moz-h7s.q07.26.188.IP) (Connection closed)
[05:19:36] *** Joins: eddyb (eddyb@moz-413.q07.26.188.IP)
[05:20:02] <Mutabah> Actually... it's not including dependencies in the link, just explicits (and the implicit std) crates
[05:27:00] *** Joins: ptalbot_ (ptalbot@moz-6oebfn.dyn.as47377.net)
[05:27:23] *** Quits: O01eg (o01eg@moz-v6j7mj.otiq.4n8f.2698.2a02.IP) (Client exited)
[05:28:59] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[05:33:14] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[05:37:06] <eddyb> uh oh https://github.com/rust-lang/rust/pull/26493#issuecomment-118727111
[05:37:17] <eddyb> I want cl91 on IRC
[05:39:11] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[05:39:15] <Mutabah> eddyb: Random - What do you think of having #[cfg] in libcore for floating-point? gh#26749
[05:39:15] <[o__o]> Fixes #26449: https://github.com/rust-lang/rust/pull/26749
[05:41:09] <eddyb> Mutabah: soft float sounds nicer
[05:42:08] <sfackler> acrichto: ping
[05:42:43] <Mutabah> eddyb: yeah, just I'm not sure if LLVM allows it any more.
[05:43:28] *** Quits: ptalbot_ (ptalbot@moz-6oebfn.dyn.as47377.net) (Connection closed)
[05:44:52] <Gankro> is nmatsakis back monday?
[05:46:17] <eddyb> it is monday :P
[05:46:25] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[05:46:50] <Mutabah> Only if you're east of UTC-5
[05:53:19] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[05:53:36] <acrichto> sfackler: pong
[05:53:52] <Gankro> eddyb: I have instantly embraced the perfection of pacific time. It's god-tier.
[05:55:48] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[05:56:52] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[06:00:29] <sfackler> acrichto: I'm making a PR that stabilizes std::time, Duration except for span and deletes the Display impl since it seems not very decided on. Seem like a reasonable point to start a discussion?
[06:00:41] <acrichto> sfackler: sgtm
[06:00:41] <sfackler> there's no tracking issue so I figure i'll just open the PR for that purpose
[06:00:45] <sfackler> and post a thing on internals
[06:00:51] <acrichto> r+
[06:00:54] <acrichto> (for process)
[06:02:01] <sfackler> i'll open another for socket timeouts, but that one should be pretty straightforward and depends on duration landing
[06:02:22] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[06:02:25] <acrichto> that *may* want to wait for the std::net RFC
[06:02:33] <acrichto> but I think that will be decided on this week anyway
[06:02:42] <sfackler> does #[stable(...)] not inherit?
[06:02:48] <acrichto> no
[06:02:51] <sfackler> ah
[06:04:01] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:04:13] *** Quits: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP) (Quit: Leaving)
[06:07:26] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[06:07:56] *** Joins: zxq9 (ceverett@moz-qsm369.mesh.ad.jp)
[06:09:10] <Manishearth> sfackler: the other ones do iirc
[06:09:51] *** Joins: oli_obk__ (Mibbit@moz-7bq.0sb.52.141.IP)
[06:10:42] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[06:11:00] <ChrisMorgan> RFC: lint, default deny, complaining of &T or &mut T parameters or return types in the signatures of #[no_mangle] functions, saying that you will need to use *const T or *mut T instead.
[06:11:13] <ChrisMorgan> (Inspired by http://stackoverflow.com/questions/31238348/calling-rust-method-from-c-with-array-parameters.)
[06:11:22] <Elaine> ChrisMorgan: #[no_mangle], not extern "C"?
[06:11:53] <ChrisMorgan> Sorry, extern "C" functions is what I meant, not #[no_mangle] functions.
[06:11:59] <Elaine> np
[06:12:13] <ChrisMorgan> For that matter, #[no_mangle] should be forbidden on anything not marked extern "C"‚Ä¶
[06:12:18] <Elaine> It should be an extension of the ctypes lint.
[06:13:03] <ChrisMorgan> Actually, `extern fn foo() { }` versus `extern "C" fn foo() { }`: what is the ABI of the former?
[06:13:08] <Elaine> "C"
[06:15:03] <reem> what is the reason ABIs are specified in strings instead of using dents?
[06:15:05] <reem> idents*
[06:16:12] <Mutabah> reem: So - can be used?
[06:17:33] <reem> what ABIs use/would use -?
[06:17:52] <Mutabah> rust-intrinsic does
[06:18:29] <reem> I see
[06:18:49] <huon> Mutabah: no reason that can't be _ ;P
[06:19:19] <huon> reem: I guess it started out as just copying C++, and never changing
[06:21:00] <reem> ah C++ does it
[06:21:01] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[06:21:03] <reem> that makes sense
[06:21:11] * reem is still kind of a C++ noob
[06:21:29] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[06:21:56] *** Quits: genbattle (genbattle@moz-4v0.gkd.16.182.IP) (Ping timeout: 121 seconds)
[06:22:33] <Mutabah> Ah, yes it does
[06:22:49] <Mutabah> That's another half-decent reason
[06:22:54] <Mutabah> And it gives flexability
[06:22:58] *** Joins: Elaine2 (Mibbit@moz-k8i.h73.153.128.IP)
[06:23:26] <Mutabah> you could use 'extern "rust:1.0"' to annotate that a function uses v1.0 of the rust ABI
[06:23:38] <WindowsBunny> Mutabah: extern "üí©"
[06:23:42] <Elaine2> Random idea: Integrate #[deriving] deeper into the compiler such that #[deriving] generates no code, but registers that "an impl is possible" and then when one is requested, instantiate it on demand (ideally with some sort of cache, when other crates also possibly have an impl"
[06:24:07] <Mutabah> Elaine2: What would that gain?
[06:24:20] <Elaine2> Faster compile times and less codegen bloat.
[06:24:24] <WindowsBunny> Mutabah: It would help compile times for crates that have thousands of things with #[derive] ?
[06:24:26] <Elaine2> #[deriving] is actually quite slow.
[06:24:30] <WindowsBunny> *cough winapi cough*
[06:24:39] <Mutabah> ah
[06:24:46] <Elaine2> It's not as slow as it used to be but it's still noticable.
[06:24:52] <Elaine2> measurable, rather.
[06:24:55] <Manishearth> Elaine2: +1
[06:25:07] <Elaine2> Manishearth: Cool, go implement it :D
[06:25:19] * Elaine2 has to run.
[06:25:22] *** Quits: Elaine2 (Mibbit@moz-k8i.h73.153.128.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:25:39] <Manishearth> WindowsBunny: Elaine2 I got a huge improvement in expansion time memory usage when I did something to reduce a single copy in #[derive]
[06:25:48] <Manishearth> I'm thinking derive has a rather large impact
[06:26:12] <Manishearth> Elaine: not sure how to make this work efficiently cross-crate
[06:26:34] <WindowsBunny> Manishearth: 5.530 in translation, 3.888 in LLVM passes and 5.593 in type checking for winapi
[06:27:05] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Ping timeout: 121 seconds)
[06:27:26] <WindowsBunny> 1.153 in const checking?
[06:27:29] <WindowsBunny> dafuq is const checking
[06:27:46] <Mutabah> WindowsBunny: Typechecking of 'const' items?
[06:27:54] <WindowsBunny> and 1.271 in borrow checking...
[06:28:20] <WindowsBunny> I wonder what would happen if I remove every single #[derive] in winapi
[06:28:28] <Mutabah> Actually, probably more checking that const expressions don't contain invalid types
[06:28:34] <Mutabah> s/types/operations/
[06:29:07] <WindowsBunny> Mutabah: Surely it shouldn't take over a second though?
[06:29:27] <WindowsBunny> Most of the consts are fairly trivial literals
[06:29:51] *** Quits: Kingsquee (kingsley@moz-k72lip.bchsia.telus.net) (Ping timeout: 121 seconds)
[06:30:01] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[06:30:21] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[06:32:44] *** Joins: cods (fred@moz-b0j6vk.tuxee.net)
[06:34:01] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:34:44] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[06:35:39] *** Joins: RCIX (RCIX@moz-vnmep7.ph.cox.net)
[06:37:16] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[06:37:50] *** Quits: RC9 (RCIX@moz-c24.dfa.8.198.IP) (Ping timeout: 121 seconds)
[06:40:30] *** Quits: Murarth (Murarth@moz-ap5.hnl.166.46.IP) (Quit: I have come here to chew bubblegum and kick ass. And I'm all out of bubblegum.)
[06:40:45] *** Joins: Murarth (Murarth@moz-jpotpi.phnx.qwest.net)
[06:42:05] *** Quits: summerlight_ (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[06:44:21] *** cods is now known as spoc
[06:45:42] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[06:46:31] *** Joins: cods_ (fred@moz-g6qd4k.net)
[06:52:24] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Ping timeout: 121 seconds)
[07:00:09] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[07:00:09] *** ChanServ sets mode: +ao erickt erickt
[07:02:05] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[07:05:07] *** Joins: RCIX (RCIX@moz-vnmep7.ph.cox.net)
[07:05:14] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[07:17:14] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[07:18:08] <Ericson2314> eddyb: http://is.gd/oo0tMg
[07:18:39] *** Joins: bjz (bjz@moz-0j4.2c9.87.203.IP)
[07:18:57] <Ericson2314> the one thing is `fork` needs to use associated types
[07:19:16] <Ericson2314> so that it can clone &mut I -> I where I: Iterator
[07:19:29] *** Quits: bjz (bjz@moz-0j4.2c9.87.203.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[07:19:53] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[07:19:54] *** Joins: bjz (bjz@moz-0j4.2c9.87.203.IP)
[07:20:22] <Ericson2314> I.E TakeWhile<&mut TakeWhile<&mut I>> "clones" to TakeWhile<TakeWhile<I>>
[07:21:04] *** Quits: bjz (bjz@moz-0j4.2c9.87.203.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[07:21:30] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[07:23:09] <Ericson2314> For paralellism, when you know that the current non-terminal will consume the next n token trees, no matter how those token trees parse, you can parse those n token trees + rest of the stream in parallel
[07:36:49] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Ping timeout: 121 seconds)
[07:41:35] *** Joins: Kingsquee (kingsley@moz-k72lip.bchsia.telus.net)
[07:45:57] *** Quits: Quxxy (chatzilla@moz-0nv.jkp.167.59.IP) (Ping timeout: 121 seconds)
[07:47:08] *** cods_ is now known as cods
[07:48:32] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[07:53:11] *** Joins: doener (doener@moz-fnh.n4j.147.5.IP)
[07:58:38] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[08:03:32] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[08:23:19] *** Joins: Quxxy (chatzilla@moz-0nv.jkp.167.59.IP)
[08:35:34] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[08:35:58] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[08:36:45] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[08:47:13] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[08:50:30] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Connection closed)
[08:54:48] <Mutabah> So... anyone know if/how rustc links in libstd's dependencies
[09:00:12] <WindowsBunny> Mutabah: Don't rlibs have metadata describing all their rlib dependencies?
[09:01:06] <Mutabah> That's what I thought
[09:01:35] <Mutabah> I may be tripping it by linking against a rust .so
[09:02:47] *** Joins: RCIX (RCIX@moz-vnmep7.ph.cox.net)
[09:04:38] <Mutabah> https://gist.github.com/thepowersgang/b4a48fe24e8c5403bc2c
[09:05:10] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[09:05:29] <Mutabah> No mention of libcore.rlib or libtifflin_syscalls.rlib in the cc command
[09:05:38] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[09:09:48] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[09:10:26] *** Joins: stormpat (stormpat@moz-kc1n3j.bb.dnainternet.fi)
[09:11:10] <canndrew> are there any tools/scripts laying around for scraping crates.io?
[09:12:09] <canndrew> i assume there must be...
[09:13:22] *** Joins: p1start (p1start@moz-nftjhe.org)
[09:14:54] *** Joins: bgamari (bgamari@moz-gfcbko.hsi8.kabel-badenwuerttemberg.de)
[09:19:54] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:24:42] <canndrew> nvm, found @brson's github profile
[09:28:28] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Ping timeout: 121 seconds)
[09:38:49] *** Quits: njn (chatzilla@moz-270n86.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 41.0a1/20150629152944])
[09:39:19] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[09:48:18] *** Joins: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP)
[09:49:27] *** Joins: vmx (vmx@moz-gmnopr.dip0.t-ipconnect.de)
[10:04:41] *** Joins: wcosta (wander@moz-8st.m6e.98.179.IP)
[10:16:31] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[10:37:05] <Mutabah> awww... I think that rustc is seeing that it's dynamicly linking against something that uses std's deps, and thus not linking against them itself
[10:38:05] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[10:38:05] *** ChanServ sets mode: +ao erickt erickt
[10:38:44] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:40:10] <eddyb> Ericson2314: so you wrote a named closure
[10:40:14] *** Joins: James (quassel@moz-dkk1ha.range86-163.btcentralplus.com)
[10:40:33] <eddyb> Ericson2314: did you see my Fn0 adapter?
[10:40:57] <eddyb> Ericson2314: although that wouldn't be applicable here, nvm
[10:42:45] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[10:45:45] <WindowsBunny> Mutabah: good luck fixing it :D
[10:46:06] <Mutabah> WindowsBunny: Yeah... I'm not 100% sure that's what's happening, but it makes a bit of sense
[10:50:38] *** Quits: blank_name (blank_name@moz-r8p.iv2.183.192.IP) (Ping timeout: 121 seconds)
[10:51:52] <Mutabah> well, it's definitely related to the presense of the dylib in libstd
[10:54:02] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[10:54:40] *** Joins: pczarn (piotr@moz-9un7t9.izacom.pl)
[10:57:41] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[10:57:45] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[10:58:14] <Mutabah> Solution - Don't do a dylib
[10:58:16] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[11:00:25] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[11:02:27] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[11:07:39] *** Quits: Jesin (Jesin@moz-fa9lmm.fios.verizon.net) (Quit: Leaving)
[11:07:45] *** Joins: skeuomor1 (skeuomorf@moz-uql.u9l.32.197.IP)
[11:15:35] *** Joins: arielb1 (Mibbit@moz-uk7sll.tau.ac.il)
[11:18:06] *** Quits: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP) (Connection closed)
[11:18:38] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:19:49] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[11:20:18] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:21:06] *** Quits: bdero (bran@moz-0e2lk5.sns9.e6pb.0197.2601.IP) (Ping timeout: 121 seconds)
[11:21:29] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[11:22:00] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:26:02] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[11:26:07] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[11:26:13] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[11:44:18] *** Joins: Sho (sho@moz-rv6.np6.168.95.IP)
[11:51:29] *** Quits: pkondzior (sid768@moz-8nse48.tooting.irccloud.com) (Quit: )
[11:51:44] *** Joins: pkondzior (sid768@moz-nrgp4s.highgate.irccloud.com)
[11:53:04] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[11:57:41] *** Quits: pczarn (piotr@moz-9un7t9.izacom.pl) (Ping timeout: 121 seconds)
[12:06:38] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[12:06:50] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[12:07:23] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Connection closed)
[12:07:32] *** Joins: eddyb (eddyb@moz-413.q07.26.188.IP)
[12:09:48] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[12:11:15] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[12:13:14] *** Quits: rovar (rovar@moz-96effg.dyn.optonline.net) (Quit: Leaving)
[12:13:47] *** Joins: amyers (amyers@moz-qn874b.zip.zayo.com)
[12:25:47] *** Joins: bdero (bran@moz-91hi89.mit.edu)
[12:26:40] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[12:26:40] *** ChanServ sets mode: +ao erickt erickt
[12:26:49] *** Quits: Nashenas88 (Nashenas88@moz-of81j9.miamfl.sbcglobal.net) (Client exited)
[12:29:57] *** Joins: ytain (ytain@moz-upqesl.dsl.teksavvy.com)
[12:31:26] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[12:33:08] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[12:33:17] *** Quits: James (quassel@moz-dkk1ha.range86-163.btcentralplus.com) (Ping timeout: 121 seconds)
[12:45:05] *** Quits: huhlig (sid17687@moz-mn7d1j.tooting.irccloud.com) (Quit: )
[12:45:15] *** Joins: huhlig (sid17687@moz-mt3sa2.highgate.irccloud.com)
[12:51:57] *** Quits: iu (iu@moz-6263qv.cc.cmu.edu) (Quit: )
[12:58:55] *** Joins: RCIX (RCIX@moz-7ju.b9c.143.98.IP)
[12:59:16] *** Joins: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de)
[13:10:10] *** Quits: jack (sid19593@moz-81tj3u.tooting.irccloud.com) (Quit: )
[13:10:14] *** Joins: jack (sid19593@moz-fhlsm9.highgate.irccloud.com)
[13:15:19] *** Joins: summerlight_ (summerlight@moz-lb3.6do.193.175.IP)
[13:23:25] *** Joins: tamird (textual@moz-ie2.6pc.167.190.IP)
[13:25:02] *** Joins: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca)
[13:25:28] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[13:25:37] *** Joins: pczarn (piotr@moz-9un7t9.izacom.pl)
[13:27:41] *** Quits: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca) (Connection closed)
[13:29:08] *** Joins: goyox86 (textual@moz-6gq.t8s.78.166.IP)
[13:42:19] *** Quits: Feyn (aram@moz-5vj.68e.115.42.IP) (Quit: Leaving)
[13:42:48] *** Quits: amyers (amyers@moz-qn874b.zip.zayo.com) (Connection closed)
[13:42:58] *** Joins: amyers (amyers@moz-qn874b.zip.zayo.com)
[13:52:29] *** Joins: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca)
[13:57:29] *** Joins: waffles (wafflespean@moz-rvs.948.23.1.IP)
[14:04:43] *** Quits: stormpat (stormpat@moz-kc1n3j.bb.dnainternet.fi) (Quit: Textual IRC Client: www.textualapp.com)
[14:06:15] *** Joins: proc (proc@moz-98bci9.dip0.t-ipconnect.de)
[14:06:54] *** Quits: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca) (Connection closed)
[14:11:51] *** Quits: skeuomor1 (skeuomorf@moz-uql.u9l.32.197.IP) (Ping timeout: 121 seconds)
[14:14:12] *** Quits: jyyou (jyyou@moz-hskqde.members.linode.com) (Quit: WeeChat 1.2)
[14:14:48] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Connection closed)
[14:15:25] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[14:17:02] *** Joins: jyyou (jyyou@moz-nhbjfr.bo6r.4bjo.8900.2400.IP)
[14:18:35] *** Joins: skeuomor1 (skeuomorf@moz-uql.u9l.32.197.IP)
[14:19:57] <tamird> @richo you about?
[14:22:45] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[14:25:56] *** Joins: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net)
[14:26:47] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[14:31:03] *** Joins: pudgetta (Mibbit@moz-hu6.nja.252.72.IP)
[14:35:07] *** Quits: goyox86 (textual@moz-6gq.t8s.78.166.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[14:43:40] <SimonSapin> I‚Äôm having doubts about https://github.com/rust-lang/rfcs/blob/master/text/0446-es6-unicode-escapes.md 4 or 8 digits *is* arbitrary, but \u{} is also a lot of noise
[14:44:43] <Mutabah> SimonSapin: It's wordy, but nicely deliniated, and relatively rare to actually need it
[14:45:30] <SimonSapin> Mutabah: `Debug for str` uses it for everything non-ascii
[14:45:40] <Mutabah> point
[14:45:53] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[14:46:28] <eddyb> SimonSapin: there was some move towards allowing more unescaped characters in it, I think
[14:48:08] <SimonSapin> perhaps https://en.wikipedia.org/wiki/Graphic_character#Unicode
[14:49:34] <eddyb> SimonSapin: is there any existing predicate for "uniquely distinguishable"?
[14:50:09] <SimonSapin> eddyb: do you mean not homograph? https://en.wikipedia.org/wiki/IDN_homograph_attack
[14:50:25] <eddyb> SimonSapin: with ASCII, presumably, yeah
[14:51:56] <SimonSapin> a quick search yields http://unicode.org/reports/tr36/
[14:53:40] *** Quits: pudgetta (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:54:00] <SimonSapin> I don‚Äôt think `Debug for str` should go into that particular can of worms
[14:54:42] *** skeuomor1 is now known as skeuomorf
[14:56:35] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
[15:00:41] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Quit: Konversation terminated!)
[15:00:50] *** Joins: eddyb (eddyb@moz-413.q07.26.188.IP)
[15:06:56] *** Quits: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[15:16:40] *** Quits: steshaw (sid30841@moz-gkeoob.tooting.irccloud.com) (Quit: )
[15:16:53] *** Joins: steshaw (sid30841@moz-mij4a1.highgate.irccloud.com)
[15:16:59] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[15:18:38] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[15:23:59] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[15:29:16] <Mutabah> *sigh* Looks like I'll need a cross-compiling gcc
[15:29:29] <Mutabah> (sorry, meant that for -osdev)
[15:32:48] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[15:35:20] *** Joins: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr)
[15:38:11] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:41:14] *** Quits: Murarth (Murarth@moz-jpotpi.phnx.qwest.net) (Quit: I have come here to chew bubblegum and kick ass. And I'm all out of bubblegum.)
[15:41:41] *** Joins: Murarth (Murarth@moz-ki0.hnl.166.46.IP)
[15:47:45] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[15:54:43] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[15:59:53] *** Quits: vmx (vmx@moz-gmnopr.dip0.t-ipconnect.de) (Quit: Leaving)
[16:07:41] <steveklabnik> nmatsakis: are you back today?
[16:09:40] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[16:09:40] *** ChanServ sets mode: +ao erickt erickt
[16:09:47] *** Quits: tamird (textual@moz-ie2.6pc.167.190.IP) (Ping timeout: 121 seconds)
[16:10:37] *** Joins: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de)
[16:13:14] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[16:13:19] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[16:15:58] *** Joins: yjv_ (yjv@moz-ll38tk.pa.comcast.net)
[16:16:31] *** Quits: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr) (Connection closed)
[16:16:52] *** Joins: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr)
[16:22:16] *** Quits: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr) (Connection closed)
[16:22:17] *** Joins: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr)
[16:25:42] *** Quits: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net) (Connection closed)
[16:27:43] *** Joins: blank_name (blank_name@moz-onojo8.mi.frontiernet.net)
[16:30:03] *** Quits: summerlight_ (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[16:31:26] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[16:33:39] *** Quits: Pierre_M (Pierre_M@moz-2vs15r.slkc.qwest.net) (Ping timeout: 121 seconds)
[16:39:00] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[16:39:26] <arielb1> are :'static bounds supposed to be supported?
[16:39:31] <arielb1> 'a:'static?
[16:40:20] <steveklabnik> hm
[16:40:29] <steveklabnik> 'a would have to be 'static there, right?
[16:40:32] <arielb1> yes
[16:40:35] <huon> seems kinda pointless, but presumably they shouldn't misbehave
[16:40:46] <arielb1> should it be an error?
[16:40:49] <arielb1> (currently it is an ICE)
[16:41:20] <huon> doesn't ICE for me?
[16:41:26] <huon> https://play.rust-lang.org/?gist=65c2ec1d64439e5ac1ee&version=nightly
[16:41:31] <arielb1> rusti: fn foo<'a>() where 'a: 'static {}
[16:41:32] -playbot- output truncated; full output at: http://bit.ly/1JJxXht
[16:41:37] <arielb1> rusti: fn foo<'a>() where 'a: 'static {} ()
[16:41:39] -playbot- output truncated; full output at: http://bit.ly/1TgUQu8
[16:41:53] <huon> playbot: fn foo<'a:' static>() {}
[16:41:54] -playbot- <anon>:9:19: 9:21 error: unterminated character constant: ' 
[16:41:54] -playbot- <anon>:9         fn foo<'a:' static>() {}
[16:41:54] -playbot- output truncated; full output at: http://bit.ly/1JJy0cQ
[16:41:59] <huon> playbot: fn foo<'a: 'static>() {}
[16:42:00] -playbot- <anon>:9:20: 9:27 error: use of undeclared lifetime name `'static` [E0261]
[16:42:00] -playbot- <anon>:9         fn foo<'a: 'static>() {}
[16:42:00] -playbot- output truncated; full output at: http://bit.ly/1TgUXG6
[16:42:15] <arielb1> huon: resolve doesn't support it trivially
[16:42:20] <arielb1> only in where-clauses
[16:42:35] * huon is treating the compiler as a black-box
[16:43:02] <arielb1> resolve is still != typeck
[16:43:23] <huon> maybe, but both places are wrong.
[16:43:41] <arielb1> in different ways
[16:43:49] <huon> this is pointless.
[16:46:06] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[16:47:26] <eddyb> wait
[16:48:22] <eddyb> https://github.com/rust-lang/rust/pull/26598/files#diff-9694c2dab1b4140752e569e4b1ba58c4R236
[16:48:33] <eddyb> I can't remember if this change affected how 'static is treated in bounds
[16:48:48] <eddyb> arielb1: but I might have noticed the resolve_lifetime oddity
[16:48:55] *** Joins: eljay (eljay@moz-fmte10.skybroadband.com)
[16:49:10] <eddyb> arielb1: yeah, here: https://github.com/rust-lang/rust/pull/26598/files#diff-9694c2dab1b4140752e569e4b1ba58c4R691
[16:49:25] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[16:49:28] <eddyb> that's the fix
[16:49:33] *** chmanchester|afk is now known as chmanchester
[16:49:41] <arielb1> for the 'static business?
[16:49:46] <eddyb> yupp, just that one line
[16:49:52] <arielb1> (I guessed)
[16:49:59] *** Joins: O01eg (o01eg@moz-o26ib5.rk9t.4n8f.2698.2a02.IP)
[16:50:43] <eddyb> I needed some funkier logic for visit_lifetime_ref to handle '_ both as a named lifetime and in the case it is undeclared
[16:53:13] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:53:13] *** ChanServ sets mode: +o brson
[16:54:03] <brson> this week i'm going to do twir, production user outreach, testing the new crater cli, and following up on what i started with stdx
[16:54:28] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[16:54:31] <brson> nrc: by laptop is broken so i am working on 'your' benchmark machine for a bit
[16:56:02] <brson> also order food for the meetup i guess
[16:56:12] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[16:56:14] <brson> erickt: is there anything i need to do before wednesday besides order some food
[16:56:28] <brson> erickt: unless you tell me something better to eat it's going to be pizza again
[16:56:33] <brson> no pressure
[16:57:10] <steveklabnik> psssh as if any food could be better than pizza
[16:57:21] <steveklabnik> :)
[16:59:10] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Connection closed)
[17:00:47] <brson> restarted mac3/4
[17:01:07] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[17:03:56] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:03:57] *** ChanServ sets mode: +o brson
[17:04:52] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[17:05:23] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:05:24] *** ChanServ sets mode: +o brson
[17:05:46] *** Joins: pitdicker (pitdicker@moz-328u1s.adsl.online.nl)
[17:07:33] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[17:14:27] <pitdicker> acrichto: Thanks for looking at https://github.com/rust-lang/rust/pull/26772
[17:14:42] <pitdicker> can you give me a hint where I should add tests?
[17:17:02] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Connection closed)
[17:18:48] <sfackler> pitdicker: there is most likely a block of tests at the bottom of src/libstd/fs.rs
[17:19:44] <pitdicker> ahh, yes. Thank you!
[17:20:33] *** Joins: thirtythreeforty (yourname@moz-31dpoq.hypertech.com)
[17:24:01] *** rovar_ is now known as rovar
[17:24:35] <thirtythreeforty> I was told to ask here if there has been any recent progress on non-lexical borrow scopes.  That's the thing I run into the most.
[17:30:39] *** Quits: blank_name (blank_name@moz-onojo8.mi.frontiernet.net) (Ping timeout: 121 seconds)
[17:31:15] *** Quits: yjv_ (yjv@moz-ll38tk.pa.comcast.net) (Connection closed)
[17:32:15] <brson> thirtythreeforty: i don't think anybody is working on it now
[17:32:36] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[17:32:41] *** Joins: blank_name (blank_name@moz-onojo8.mi.frontiernet.net)
[17:33:29] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[17:33:37] <thirtythreeforty> brson: that's too bad.  Not too high-priority I guess?
[17:34:29] *** Joins: mlrutherford (OxMLR@moz-92lj8j.3fkl.4isk.6000.2605.IP)
[17:34:42] <huon> I think there's work on compiler-internal refactorings that will make non-lexical borrows work better
[17:34:42] *** Joins: pcwalton (pcwalton@moz-7sa3hj.static-ip.telepacific.net)
[17:34:42] *** ChanServ sets mode: +o pcwalton
[17:36:08] <thirtythreeforty> Do they "sort of" work now? I was under the impression that borrows are grammatically tied to scopes.
[17:36:10] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[17:36:28] *** Quits: pcwalton (pcwalton@moz-7sa3hj.static-ip.telepacific.net) (Connection closed)
[17:37:00] *** Joins: pcwalton (pcwalton@moz-7sa3hj.static-ip.telepacific.net)
[17:37:00] *** ChanServ sets mode: +o pcwalton
[17:37:24] <brson> thirtythreeforty: that's right, there's other high-priority work to be done now
[17:38:08] <thirtythreeforty> Alright.  Thought I'd ask, thanks.
[17:44:58] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[17:45:02] *** Quits: jevin (jevin@moz-sra.ovp.12.72.IP) (Quit: Textual IRC Client: www.textualapp.com)
[17:46:57] *** Quits: pcwalton (pcwalton@moz-7sa3hj.static-ip.telepacific.net) (Client exited)
[17:47:05] *** Joins: jespino (jespino@moz-nuliq9.user.ono.com)
[17:47:25] <jespino> hi
[17:47:42] <jespino> I'm new, and i'm writting a PR in the libstd
[17:48:24] <jespino> but every time i want to try the changes i compile with make, and this compile a lot of thinks and take a lot of time
[17:49:08] <jespino> I want to know, is there any way to improve the write/compile/try loop speed?
[17:49:57] <steveklabnik> well, 'make' rebuilds everything
[17:50:23] <steveklabnik> there are other targets that can help
[17:50:52] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[17:52:01] <steveklabnik> so, make check-stageN will run tests for just that stage
[17:52:32] <steveklabnik> i don't do a lot of rustc hacking, but 'make check-stage1' should help, id imagine
[17:52:47] <steveklabnik> and of course -j for paralell threads
[17:53:11] <steveklabnik> if you're just adding to std
[17:53:22] <jespino> I already using -j, improve the speed, but not enough
[17:53:28] <huon> `make check-stage1-std NO_REBUILD=1` will be the fastest way
[17:53:43] <steveklabnik> yeah
[17:53:46] <huon> (well, including if you specify the various parallelism options)
[17:53:52] <steveklabnik> beat me to it :)
[17:54:03] <doener> using -j for the actual test target is not always ideal, because the test runner uses multiple threads
[17:54:17] <doener> I usually use "make -j8 rustc-stage1 && make check-stage1"
[17:54:18] <huon> yeah
[17:54:21] * huon does the same
[17:54:43] <jespino> :) thanks!
[17:54:50] * arielb1 prefers make -j8 rustc-stage2 && make check-stage1
[17:55:01] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[17:55:02] <arielb1> builds stage2 libs in parallel
[17:55:25] <huon> but check-stage1 doesn't need anything from stage2?
[17:55:30] <arielb1> huon: it does
[17:55:36] <arielb1> rustc-test
[17:55:39] <arielb1> etc.
[17:55:58] <jespino> other question, is anywhere a documentation about rust internals development?
[17:56:08] <arielb1> jespino: code comments
[17:56:21] <huon> oh, as in the libs for the compiler used to build stage2
[17:57:08] <jespino> arielb1: ok, thanks!
[17:57:10] <jespino> :)
[17:57:14] *** Quits: waffles (wafflespean@moz-rvs.948.23.1.IP) (Quit: C'yall soon...)
[17:57:43] *** Quits: poorman (poorman@moz-vid7t6.res.rr.com) (Quit: )
[17:58:44] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[18:01:04] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Ping timeout: 121 seconds)
[18:02:24] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:02:24] *** ChanServ sets mode: +o pcwalton
[18:05:36] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[18:10:11] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[18:17:33] *** Joins: Pierre_M (Pierre_M@moz-g3a.5hf.152.12.IP)
[18:18:17] *** Quits: blank_name (blank_name@moz-onojo8.mi.frontiernet.net) (Quit: leaving)
[18:18:23] *** Joins: Pierre_M_ (Pierre_M@moz-2vs15r.slkc.qwest.net)
[18:19:04] *** Joins: blank_name (blank_name@moz-onojo8.mi.frontiernet.net)
[18:19:42] *** Quits: ytain (ytain@moz-upqesl.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[18:20:20] *** Joins: X67r (user@moz-jqpmr2.mullvad.net)
[18:22:03] *** Quits: Pierre_M (Pierre_M@moz-g3a.5hf.152.12.IP) (Ping timeout: 121 seconds)
[18:26:27] <brson> does I-nominated still cause *somebody* to triage issues?
[18:26:50] <brson> i feel completely out of the loop on triage
[18:26:53] <steveklabnik> iirc it's still used by subteams, yeah?
[18:26:56] <steveklabnik> i feel out of the loop too
[18:32:06] *** Quits: Quxxy (chatzilla@moz-0nv.jkp.167.59.IP) (Ping timeout: 121 seconds)
[18:35:24] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[18:36:40] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[18:39:05] *** chmanchester is now known as chmanchester|afk
[18:45:31] *** Joins: eddyb_ (eddyb@moz-413.q07.26.188.IP)
[18:46:20] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Ping timeout: 121 seconds)
[18:52:44] <richo> Anyone interested in proofing an RFC? (I'm about 80% sure this is something we want, but I'd like to have a couple of people read it before I actually submit it)
[18:53:40] <sfackler> richo: I can take a look
[18:54:06] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[18:55:12] <richo> https://github.com/richo/rfcs/blob/opaque-aliases/text/0000-opaque-types.md
[18:55:30] *** Joins: eerie (eerie@moz-qbn2t0.red.bezeqint.net)
[18:56:26] <arielb1> richo: the drawbacks to unit structs aren't too clear
[18:56:38] <arielb1> you don't need to destructure when using a unit struct
[18:56:40] <arielb1> you can just .0
[18:56:57] *** Joins: eibwen (eibwen@moz-v66ehg.dip0.t-ipconnect.de)
[18:57:12] *** chmanchester|afk is now known as chmanchester
[18:57:31] <arielb1> and they shouldn't have FFI problems
[18:57:37] <arielb1> they should have the same layout as without
[18:57:44] <arielb1> definitely with #[repr(C)]
[18:57:51] <arielb1> and also without
[18:58:10] <eddyb_> adding a new keyword is pretty much a nono
[18:58:34] <arielb1> richo: rustc_llvm uses *const () because it is ancient
[18:58:50] <eddyb_> *const Void, rather
[18:58:56] <eddyb_> rustc_llvm should use lifetimes
[18:59:10] <arielb1> eddyb_: lifetimes/
[18:59:11] <arielb1> ?
[18:59:25] <eddyb_> yeah, usually the objects you create in a context are tied to that context
[18:59:39] <eddyb_> why not put lifetimes in the extern {}?
[18:59:57] <arielb1> that would require threading them around
[19:00:02] <eddyb_> mhmm
[19:00:14] <eddyb_> code that doesn't have lifetimes already in trans is wrong
[19:00:26] <eddyb_> passing ValueRef around is wrong
[19:00:29] <eddyb_> and it causes very fun bugs
[19:00:38] <eddyb_> concurrency ones, too, with codegen-units
[19:00:45] <arielb1> concurrency?
[19:00:46] *** eddyb_ is now known as eddyb
[19:00:48] <eddyb> arielb1: yupp
[19:00:54] <arielb1> do we run rustc in parallel?
[19:00:59] <eddyb> we run LLVM in parallel
[19:01:15] <eddyb> you can trivially end up with a ValueRef from a module in a different module
[19:01:22] <arielb1> won't that cause a crash?
[19:01:43] <eddyb> depends what LLVM is doing with it
[19:02:24] <eddyb> also using a ValueRef from a function in a different function
[19:02:40] <eddyb> best case scenario, some sanity check pass finds it. but that doesn't always happen IME
[19:02:43] <arielb1> eddyb: not except for constant?
[19:03:05] <eddyb> arielb1: "from a function" as in, local to that function
[19:03:24] <arielb1> like ssavars?
[19:03:40] <arielb1> *that* should cause "broken function found"
[19:03:40] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[19:04:14] <arielb1> is nmatsakis back?
[19:04:23] <nmatsakis> I am...
[19:04:39] <eddyb> arielb1: maybe now it does in all possible situations. or so at least I hope it does
[19:04:45] <bluss> brson: did you manage to fix the nightly builder?
[19:04:48] <arielb1> nmatsakis: hi
[19:04:53] <eddyb> arielb1: it's still nasty to debug
[19:05:00] <arielb1> I found a few new soundness issues while you were
[19:05:02] <arielb1> away
[19:05:37] <brson> bluss: i restarted the mac bots. if that's the only problem then yes
[19:05:41] <brson> i'll kick off a nightly right now
[19:05:54] <bluss> brson: great!
[19:05:58] <nmatsakis> arielb1: I saw the one about traits and dropck, I have to read it, it looked to me like it might be a dup though
[19:06:19] <nmatsakis> arielb1: I'm trying to catch up on citations etc right now but if you want to send me links to make sure I see them, it'd be helpful
[19:06:30] <arielb1> nmatsakis: dup of ?
[19:06:37] <brson> we've also had some beta backports so could start a new beta right now if anybody feels the urge
[19:07:18] <richo> arielb1: are you sure? I read it again last night and it has eg, `pub enum Value {}; pub type ValueRef = *const Value;`
[19:07:49] <arielb1> richo: rustc_llvm is ancient
[19:07:52] <nmatsakis> arielb1: let me validate my hopthesis
[19:08:04] <arielb1> *const Void, *const () - doesn't matter
[19:08:13] <brson> i'm definitely going to try to work 'hopthesis' into my bar banter tonight
[19:08:16] <arielb1> richo: ^
[19:08:26] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[19:08:31] <arielb1> rustc_llvm comes from the days before .0 through
[19:08:36] <richo> sure
[19:09:00] *** Quits: arielb1 (Mibbit@moz-uk7sll.tau.ac.il) (Quit: need to go)
[19:09:56] <eddyb> richo: you would get more support if the intent was automatic "deriving" of trait impls on the newtype
[19:10:14] <eddyb> but even that is better achieved on top of the existing tuple structs
[19:10:44] <richo> but so, if I pass a tuple struct to an extern fn, it's it basically UB that will probably always work?
[19:11:07] <richo> eg, I don't think it's actually specified that `struct Foo(u8)` and `u8` are equivalent?
[19:12:10] <eddyb> with #[repr(C)]... actually, hmm
[19:12:22] <eddyb> I don't know how we define that
[19:12:56] <eddyb> playbot: #[repr(C)] struct Foo(u8, u8); extern { fn foo(_: Foo); } unsafe { foo(Foo(0, 0)); }
[19:12:58] -playbot- output truncated; full output at: http://bit.ly/1fhUmFT
[19:13:32] <eddyb> no warnings, no nothing. hmpf
[19:13:41] <eddyb> playbot: #[repr(C)] struct Foo; extern { fn foo(_: Foo); } unsafe { foo(Foo); }
[19:13:42] -playbot- output truncated; full output at: http://bit.ly/1dHZH7u
[19:16:44] <eddyb> richo: I really don't know what to say
[19:17:04] <richo> hah
[19:17:32] <eddyb> richo: newtype wrappers should definitely be a thing, and I've wanted a layout optimization (treating an unary tuple struct as the type inside for all intents and purposes) for a while now
[19:17:47] <richo> I'm genuinely interested in feedback. I'm pretty sure that the thing I personally want is a way to make type aliases opaque, the ergos of having to .0 everywhere seem pretty miserable
[19:17:56] <eddyb> it's just non-trivial to add given recursive types so I've waited for LLVM to get rid of pointee types
[19:18:25] *** Quits: Mutabah (tpg@moz-hklpnj.mutabah.net) (Ping timeout: 121 seconds)
[19:18:30] <eddyb> richo: you seem to also want to use subtyping
[19:18:42] *** Joins: Mutabah (tpg@moz-hklpnj.mutabah.net)
[19:18:46] <eddyb> (using the opaque type as the inner one. but only in the same module?)
[19:19:32] <richo> plausibly? that's an interesting point. In my strawman, I would have expected `pub opaque type ...` to be reasonable
[19:20:07] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[19:20:29] <eddyb> richo: maybe I got it wrong, how would you use a value of that type?
[19:20:52] <eddyb> what interactions are there between T and an opaque newtype of T?
[19:21:05] <richo> the obvious usecase is that you intend for an upstream consumer to be able to hold a value, and then pass it back into a visibile function
[19:21:18] <eddyb> (it's also specifically not an "alias". an "alias" is identical. this is a newtype)
[19:21:37] <richo> ah, ok. Using the right terms will probably help :)
[19:21:39] <eddyb> richo: "visible" function?
[19:21:47] <richo> should I just sketch out some code?
[19:21:54] <eddyb> sure, I was hoping for that
[19:22:05] <richo> (I think T and newtype(T) shouldn't have any overlap without a manual cast)
[19:22:09] <eddyb> a minimal example of packing/unpacking would be good, I guess
[19:22:11] <eddyb> richo: ah!
[19:22:23] <richo> I thought I put that in the doc, but I might have left it out
[19:22:33] <richo> `newtype as T` should dtrt
[19:22:47] <eddyb> value.0 is shorter than value as T :P
[19:22:55] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[19:22:58] <eddyb> but I could see `as T` working
[19:23:14] <eddyb> far more reasonable than any form of subtyping
[19:23:56] <richo> it's definitely shorter, but it seems to mix up it's concerns
[19:24:02] <brson> anybody else have opinions about putting the stage number in rustc's version output https://github.com/rust-lang/rust/pull/26599
[19:24:28] <richo> I guess you could argue that safe wrappers for foreign functions should be responsible anyway
[19:24:30] <richo> hrm
[19:24:33] <steveklabnik> i feel vaguely like the 'leaving it out for stage2+'
[19:24:56] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[19:26:15] <larsberg> brson: I agree with steveklabnik. Putting anything in whatever the "final" stage is in is just asking for production users to hardcode it in their build scripts when doing autotools-style version checks and relegating the compiler team to introducing "stage1.2.27" to avoid renaming "stage2" and breaking builds :-)
[19:26:48] <richo> eddyb: as a really tiny example (I can write more later) https://gist.github.com/b75004be65d913bc7cfb
[19:27:06] * larsberg has seen horrors piled on horrors in the detection rules in configure scripts...
[19:27:24] <richo> it seems reasonable that other crates should be able to get their hands on a Foo and pass it around. Sort of unclear if they ought to be able to unwrap it, but I suspect they should
[19:27:31] *** Quits: Mutabah (tpg@moz-hklpnj.mutabah.net) (Ping timeout: 121 seconds)
[19:27:33] *** Joins: Mutabah (tpg@moz-hklpnj.mutabah.net)
[19:27:56] <richo> Actually
[19:28:07] <richo> Can this just be done with deref coercions now?
[19:29:19] <eddyb> maybe
[19:29:27] <richo> I think that might be the thing that I want
[19:29:35] <eddyb> I really don't know what you API looks like. there's a few variations on newtypes that you can use
[19:29:36] <richo> *foo is shorter than foo.0 :)
[19:29:43] *** Quits: jespino (jespino@moz-nuliq9.user.ono.com) (Ping timeout: 121 seconds)
[19:30:08] <iu> Hi there! I asked this before but on #rust; I‚Äôd like to ask it here, if you don‚Äôt mind. What is the reason for not implementing Error for String and &str?
[19:31:23] <doener> bluss: btw, did you make a PR to improve the std implementation of PartialEq for [T] and order::{eq, ne}, too? If not, I'll go ahead and make one
[19:34:29] <Elaine> https://www.reddit.com/r/rust/comments/3cc527/twir_86/
[19:35:26] <bluss> doener: I didn't, I assumed you were working on it
[19:35:28] <iu> It feels so natural to pass a string as an error, but it might be a bad practice, which I don‚Äôt realize.
[19:35:31] *** Quits: Mutabah (tpg@moz-hklpnj.mutabah.net) (Ping timeout: 121 seconds)
[19:35:51] *** Quits: untitaker (untitaker@moz-8kcbnd.highway.telekom.at) (Ping timeout: 121 seconds)
[19:36:40] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Connection closed)
[19:36:56] <doener> bluss: my brain hurt after looking at that stuff for too long so I spent the rest of the weekend playing vidya ;-)
[19:37:24] <doener> bluss: I'll go ahead and do the PR then, just didn't want to create duplicate work
[19:37:33] <bluss> great
[19:38:43] *** Joins: untitaker (untitaker@moz-tn5pb3.highway.telekom.at)
[19:39:22] <jroesch> bluss: you commented on that recently reported inference error with extend? could you clarify I'm trying to work on some P-high type checker issues
[19:40:26] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[19:40:39] <bluss> jroesch: yes. It's not a language regression, just expected regression in inferrence on .extend() specifically due to library changes
[19:40:49] <bluss> jroesch: so it seems it's not an important bug
[19:40:53] <jroesch> cool, that's what I thought you were implying :)
[19:40:58] *** Joins: Mutabah (tpg@moz-hklpnj.mutabah.net)
[19:41:29] <bluss> I thought it was pretty explicit
[19:41:50] <jroesch> it was just didn't know about extend 
[19:42:09] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[19:42:18] <jroesch> I thought we had regressed inference in some weird way
[19:42:22] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[19:42:22] *** ChanServ sets mode: +o pcwalton
[19:42:35] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[19:43:33] <sfackler> jroesch: there is gh26813 - ok in stable, ok in nightly but broken on 1.3 beta
[19:43:33] <[o__o]> Regression on beta for trait bounds on supertrait's associated items: https://github.com/rust-lang/rust/issues/26813
[19:43:38] <sfackler> probably just needs some commit backporte
[19:43:41] <sfackler> *backported
[19:44:49] <jroesch> sfackler: cool I'll look into it, just trying to find some work to fill the gaps of time on default type parameter fallback (which is almost done)
[19:46:05] *** Quits: pitdicker (pitdicker@moz-328u1s.adsl.online.nl) (Quit: Ik ga weg)
[19:49:37] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[19:50:19] *** Joins: reedlepee (Mibbit@moz-hu6.nja.252.72.IP)
[19:51:31] *** Joins: eddyb_ (eddyb@moz-413.q07.26.188.IP)
[19:53:37] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Ping timeout: 121 seconds)
[19:53:47] <eddyb_> nmatsakis: I'm a bit worried that https://github.com/rust-lang/rfcs/pull/756 doesn't reflect the current situation
[19:54:05] <nmatsakis> eddyb_: in what respect?
[19:54:42] <eddyb_> I recall only one use of closures via trait objects in the crates I've used
[19:54:53] <eddyb_> and that was &mut FnMut(&mut FnMut(...))
[19:55:08] <eddyb_> (i.e. generics wouldn't have worked)
[19:55:40] <eddyb_> but I could live in a bubble, so...
[19:55:55] <eddyb_> nmatsakis, brson: would it be possible to run a grep across all crates.io source, for `&(mut )\|`?
[19:56:16] <eddyb_> ` *` instead of ` `, I guess
[19:57:09] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[19:57:44] *** Joins: jespino (jespino@moz-nuliq9.user.ono.com)
[19:59:24] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[19:59:48] *** eddyb_ is now known as eddyb
[20:00:09] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[20:00:18] <jroesch> bluss: I hadn't seen that you responded, now realize my question was stupid :)
[20:00:18] <nrc> brson: can you let me know when you're done using it and I'll restart then
[20:00:22] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[20:00:30] <brson> nrc: sure
[20:01:32] <Elaine> "LLD's COFF linker can now link a working 64-bit debug build of Chrome. chrome.dll takes 24 seconds (vs 48 seconds for linking it with MSVC)."
[20:02:04] <brson> eddyb: crater can't do it but i have another tool that can pretty easily. I'll start downloading crates
[20:02:19] *** Quits: eerie (eerie@moz-qbn2t0.red.bezeqint.net) (Connection closed)
[20:02:31] <Elaine> Also, https://github.com/scross99/llvm-abi looks like it might be useful as a central point of collaboration in the future.
[20:02:46] <eddyb> brson: having a common setup where we can run queries would be useful, I would think
[20:02:57] <brson> eddyb: yes, i would like that
[20:03:09] *** Quits: semarie (semarie@moz-lv0q9f.bpv6.bg1u.41d0.2001.IP) (Ping timeout: 121 seconds)
[20:03:33] <brson> eddyb: what is `&(mut )\|` looking for?
[20:04:05] <eddyb> egrep '&(mut *)?\|' is the correct version, sorry
[20:04:05] <bluss> jroesch: oh don't worry. that explains why I thought I was already clear enough
[20:04:20] <eddyb> brson: closures with & or &mut before the opening |
[20:04:25] <Elaine> brson: I just saw stdx yesterday. It's looking great, and your readme is fantastic.  http://brson.github.io/temple-of-rust/ is glorious.
[20:04:42] <eddyb> wait, that's still not flexible enough. '&\s*(mut)?\s*\|'
[20:05:11] *** Joins: arielb1 (Ariel@moz-2i0s5u.red.bezeqint.net)
[20:06:07] <eddyb> the other grep I mentioned last week was '\'_[^\'a-zA-Z0-9_]' (for the '_ RFC)
[20:06:26] <brson> Elaine: thanks :)
[20:06:58] <eddyb> Elaine: wat
[20:07:12] <steveklabnik> haha that page is awesome
[20:07:16] <reem> hahaha
[20:07:21] <reem> that‚Äôs great
[20:07:30] <eddyb> oh stdx is on the users forum
[20:07:39] <Elaine> (the latin reads "Safe, Parallel, Fast" btw)
[20:08:22] <eddyb> oh look it's extra
[20:08:30] <Elaine> yeah pretty much.
[20:08:39] <bluss> eddyb: probably way higher quality than extra
[20:09:10] <bluss> it was so long ago
[20:09:39] <eddyb> brson: I want a temple t-shirt nao
[20:09:55] <Elaine> I was thinking it'd make an excellent patch.
[20:10:02] <eddyb> oh
[20:12:20] *** Joins: genbattle (genbattle@moz-4v0.gkd.16.182.IP)
[20:12:27] <eddyb> or metal pins. or insignias. lots of choices
[20:12:59] <Elaine> a flag on a treehouse
[20:15:46] <brson> eddyb: i still don't understand what i'm grepping for with this closure issue. there are a number of instances of '&mut |'
[20:16:27] <eddyb> brson: listing them would be enough. the distribution is the interesting bit
[20:16:47] <eddyb> brson: we didn't know how closures were going to used before the old ones were ripped out
[20:17:35] <eddyb> I believe there's not as many uses of dynamic dispatch as one might have assumed when unboxed closures were introduced
[20:18:07] <eddyb> you could have replaced |A| -> R with &mut FnMut(A) -> R, but new code doesn't do that *by default*
[20:18:37] <eddyb> brson: I'm expecting the RFC to have no real impact on ergonomics
[20:19:17] <eddyb> because the usecase from last year, that it is based on, is no longer common
[20:19:27] <brson> eddyb: https://gist.github.com/brson/f8ec7bcdf54e5d18419f
[20:19:36] <eddyb> thank you :D
[20:20:11] <eddyb> let cb: &mut |&[u8]| -> bool = unsafe { &mut *cb_ptr };
[20:20:13] <eddyb> hehe
[20:21:00] <doener> bluss: hrm, I'm super confused as to why LLVM removes the bounds checks in a checked counted loop in eq() for slices, but not in an "almost" identical benchmark 
[20:21:44] <doener> bluss: "almost" because it's using the shorter length (i.e. generic zip, instead of specific for eq())
[20:22:29] *** Quits: proc (proc@moz-98bci9.dip0.t-ipconnect.de) (Quit: Gotta eat my pizza)
[20:22:29] <eddyb> the piston2d-*_graphics ones I knew about already, I'm surprised there's only the exact cases that I remember seeing
[20:23:16] <bluss> doener: is this in any preexisting code in libcore?
[20:24:08] <eddyb> brson: this might be too good to be true. what about egrep '&(mut *)?\|' - does that return much more results?
[20:24:31] <eddyb> (I really don't want to post something on the RFC without making damn sure I'm not missing significant cases)
[20:24:39] <eddyb> brson: wait, no
[20:24:56] <eddyb> brson: regex is hard. the other one, '&\s*(mut)?\s*\|'
[20:24:59] *** Quits: amyers (amyers@moz-qn874b.zip.zayo.com) (Ping timeout: 121 seconds)
[20:25:02] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[20:26:16] <eddyb> brson: if you have the tools public somewhere, I could download and run it myself - worst case, I get to use that 2TB USB3 drive that's only catching dust these days
[20:27:56] <brson> eddyb: all i'm doing is running the dl-cargo-packages script from here https://github.com/brson/stabworld#basic-usage
[20:28:00] <brson> then grepping the 'sources' dir
[20:28:13] <eddyb> brson: great, thanks again!
[20:28:22] <brson> np
[20:28:55] *** Joins: eddyb_ (eddyb@moz-413.q07.26.188.IP)
[20:32:39] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Ping timeout: 121 seconds)
[20:34:38] <eddyb_> nmatsakis: when do you think could '_ be merged? would it be at least 2 more weeks for the RFC process?
[20:34:57] <doener> bluss: it's definitely the fact that it's using the min length instead comparing the length, which is weird, because obviously the min length also guarantees the the bounds check won't trigger
[20:35:20] <eddyb_> nmatsakis: most of the stuff I want to do in the compiler can't progress without it
[20:35:47] <eddyb_> I believe pythonesque had some trans::Block changes that could be nicer with it, too
[20:38:14] <arielb1> nmatsakis: do you have an opinion on the unsoundness?
[20:38:54] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[20:40:06] <bluss> doener: I'm sorry I don't know llvm so well. Do you mean you are looking at a use of  zip(&[], &[]) ?
[20:40:28] <doener> bluss: let me gist my code
[20:42:12] <huon> doener: does optimising it more help? (i.e. running `opt -O3` on it or something)
[20:42:24] <doener> huon: nope
[20:47:20] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[20:48:07] *** eddyb_ is now known as eddyb
[20:48:16] *** Joins: vmx (vmx@moz-kcirof.pools.vodafone-ip.de)
[20:50:53] *** Quits: pczarn (piotr@moz-9un7t9.izacom.pl) (Ping timeout: 121 seconds)
[20:51:27] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[20:51:51] <doener> bluss: sorry, got distracted... https://gist.github.com/dotdash/5eb509fe2926649cdec9
[20:52:18] <doener> bluss: in slow.rs, the bounds checks remain, in fast.rs, they're eliminated
[20:54:08] *** Joins: p1start (p1start@moz-nftjhe.org)
[20:54:43] *** Quits: jespino (jespino@moz-nuliq9.user.ono.com) (Ping timeout: 121 seconds)
[21:00:54] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[21:01:39] <bluss> doener: is something missing on the black box line in slow.rs? it doesn't seem to do any operation
[21:02:34] <bluss> doener: I'd be tempted to "import" ZipSlices into libcore for this or write out the get_unchecked() loop explicitly
[21:02:53] <bluss> doener: I just guess that we want better zipped loops in many places
[21:03:48] <eddyb> brson: what happens if I run the script again?
[21:04:09] <bluss> doener: by the way, eq should use the == operator for sanity I think
[21:04:10] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[21:04:10] *** ChanServ sets mode: +ao erickt erickt
[21:04:46] <bluss> doener: the idea is to pass on the underlying semantics(?) so if we compare a slice of f32 with ==, I think it should call == on each pair(?)
[21:04:59] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[21:05:37] <bluss> hm maybe it doesn't matter, but then I don't know why we have two methods in the partialeq trait
[21:06:26] *** Quits: reedlepee (Mibbit@moz-hu6.nja.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:06:43] <brson> eddyb: it will only download new crates and not touch existing ones
[21:06:56] <doener> bluss: is there a case where things can be equal and non-equal at the same time? (or neither equal nor non-equal?)
[21:07:05] <eddyb> brson: :D
[21:07:18] <eddyb> very nice
[21:07:39] <eddyb> glium_macros-0.0.1\src\uniforms.rs
[21:07:41] <eddyb> welp
[21:07:54] * doener always forgets about all the floating corner cases
[21:09:29] *** Quits: RCIX (RCIX@moz-7ju.b9c.143.98.IP) (Ping timeout: 121 seconds)
[21:10:13] <bluss> doener: I don't know anything like that
[21:10:42] <bluss> doener: I still think a generic eq should forward to eq, and ne to ne
[21:10:44] <bluss> if possible
[21:11:17] <bluss> maybe I'm totally wrong
[21:11:23] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[21:11:27] <eddyb> bluss: that is correct
[21:11:36] <huon> bluss: what else would it forward too?
[21:11:45] <bluss> eq could use ne
[21:12:14] <huon> as in, !x.ne(y) (or !(x != y)) instead of x.eq(y) (x == y)
[21:12:16] <huon> ?
[21:12:32] <bluss> huon: see doener's gist above
[21:13:04] <huon> oic
[21:13:12] <bluss> so it uses != in eq. It could use == instead. I don't know if it matters, but the old code was careful to do it
[21:13:38] <bluss> is it silly?
[21:14:22] *** Joins: RC9 (RCIX@moz-2vc.dfa.8.198.IP)
[21:16:14] *** Quits: filsmick (filsmick@moz-8qcdgt.abo.wanadoo.fr) (Quit: )
[21:18:05] *** Joins: Pierre_M__ (Pierre_M@moz-g3a.5hf.152.12.IP)
[21:19:07] *** Quits: iu (iu@moz-6263qv.cc.cmu.edu) (Ping timeout: 121 seconds)
[21:19:56] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[21:21:30] *** Quits: Pierre_M_ (Pierre_M@moz-2vs15r.slkc.qwest.net) (Ping timeout: 121 seconds)
[21:21:38] *** Quits: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[21:23:32] *** Joins: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de)
[21:23:49] *** Joins: summerlight_ (summerlight@moz-lb3.6do.193.175.IP)
[21:24:02] *** Joins: RCIX (RCIX@moz-vnmep7.ph.cox.net)
[21:26:29] *** Quits: RC9 (RCIX@moz-2vc.dfa.8.198.IP) (Ping timeout: 121 seconds)
[21:28:28] *** Quits: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[21:28:53] <doener> bluss: as I understand it, eq and ne are exclusive, it's either one or the other. I suppose using the matching function for the recursion was just done for consistency with the other order::* functions
[21:29:24] <doener> bluss: I'd be fine with !x.eq(y), but !(x == y) looks weird to me
[21:29:28] *** Quits: summerlight_ (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[21:30:03] <doener> ... and this is just crazy: if x == y {} else { return false } :-)
[21:30:40] * doener sees stuff like that way too often in production code across various code bases
[21:30:44] <brson> crater is embarking on a journey to build 10k crates right now
[21:31:03] * doener bids farewell to crater
[21:31:06] <steveklabnik> :)
[21:31:18] <WindowsBunny> acrichto: So, did you want my impl that uses CopyFile or the impl that uses CopyFileEx?
[21:31:51] <huon> doener: `if (x == y) == false { return false }` or `if let false = x == y { return false }` are clearly much better :P
[21:32:23] <doener> huon: OMG, rust is clearly the language of the future! So many new ways to hide your intent!
[21:32:26] <doener> :-p
[21:32:45] <bluss> doener: just call .eq(). If  !x.eq(y) is the right thing to do, then there's no pain in doing so
[21:32:47] <doener> the `let` one is really great
[21:32:53] <huon> steveklabnik: weird, I won't recognise you on github any more :P
[21:37:17] *** Joins: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de)
[21:37:25] <steveklabnik> heh
[21:37:31] <steveklabnik> i had that last one for like two years!
[21:37:40] <steveklabnik> so there'll be plenty of time to acclimate to this one :)
[21:38:37] <Elaine> :+1: to changing avatars ;)
[21:38:38] <eddyb> I just clicked your name to get to your github profile
[21:38:46] <eddyb> apparently that opens a PM tab
[21:40:06] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[21:41:33] <Elaine> nrc: r? https://github.com/nrc/rustaceans.org/pull/165
[21:46:29] <eddyb> Elaine: are you going to change your github username?
[21:46:40] <Elaine> I don't know yet.
[21:46:46] <Elaine> Probably not.
[21:46:59] <Elaine> At least not until this digital identity dies entirely and I start anew.
[21:47:26] <eddyb> https://github.com/Elaine looks almost completely unused
[21:47:34] <eddyb> (with 3 rails repos)
[21:47:35] <Elaine> I had to fight to get cmr in the first place.
[21:48:01] <sfackler> oh, that's who elaine is
[21:48:05] <sfackler> >_>
[21:49:37] <jroesch> heh, when we were in whistler we were all confused for 10m where a new ops that none of us knew had come from 
[21:49:48] <sfackler> yeah
[21:50:46] <Elaine> :)
[21:52:11] *** Joins: Pierre_M_ (Pierre_M@moz-2vs15r.slkc.qwest.net)
[21:52:27] <nrc> Elaine: it was extremely painless for me to get nrc on GH - just emailed them with a little evidence I used the id and told them that the existing user was dormant, they deleted the account and I claimed it in like 30 mins
[21:53:01] * huon joins the avatar-changing party
[21:53:12] <doener> huon: welcome! :-)
[21:53:22] <Elaine> nrc: yeah, that's what ended up happening for me too.
[21:53:49] <nrc> Elaine: re rustaceans, don't know why the bot didn't pick that up, will merge manually, give me a little time (it's kinda non-trivial)
[21:55:00] <Elaine> np
[21:55:16] *** Quits: Pierre_M__ (Pierre_M@moz-g3a.5hf.152.12.IP) (Ping timeout: 121 seconds)
[21:57:07] <nrc> hmm, looks like GH is having some issues with its web hooks at the moment
[21:57:13] <nrc> that does not bode well for bors
[21:57:25] <nrc> brson, acrichto: have you noticed anything? ^
[21:58:06] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[21:58:12] <arielb1> nrc: are you proposing an after-macros+resolution HIR, or something else?
[21:58:24] *** Joins: ytain (ytain@moz-upqesl.dsl.teksavvy.com)
[21:59:10] <nrc> arielb1: I am currently proposing an after-macros, before resolution HIR, but also proposing that it will probably evolve into an after-resolution HIR in the not too distant future
[21:59:45] <arielb1> by moving resolution to the AST?
[22:00:06] <arielb1> resolution already kind-of uses the AST
[22:00:21] <arielb1> mtwt_tables
[22:00:26] <eddyb> term_grid-0.1.1/src/lib.rs:impl<'_> convert::From<&'_ str> for Cell {
[22:00:37] <eddyb> I honestly didn't expect anyone to use it
[22:00:44] <nrc> resolution will be part of the lowering step from AST to HIR
[22:00:53] <brson> erickt: food is ordered for weds
[22:00:53] <arielb1> "part of"
[22:00:58] <arielb1> resolution isn't bottom-up
[22:01:00] <arielb1> or top-down
[22:02:11] <eddyb> sxd-xpath-0.1.1 and term_grid-0.1.1 both use '_
[22:02:24] <eddyb> brson: where can I find the list of crates that build on stable?
[22:02:33] <arielb1> through trans isn't 100% top-down and we manage
[22:02:36] <nrc> I view resolution as, essentially a function from the AST to a bunch of tables, then lowering is a function from the AST + those tables -> HIR
[22:02:49] <arielb1> nrc: that's "after resolution"
[22:03:17] <nrc> arielb1: right: "it will probably evolve into an after-resolution HIR in the not too distant future"
[22:03:41] <arielb1> when we clean resolution + macros properly?
[22:03:50] <eddyb> nrc: one more "neat possibility": path desugaring
[22:04:12] <arielb1> path desugaring?
[22:04:20] <nrc> arielb1: yes, although the two are a bit orthogonal
[22:04:25] <nrc> eddyb: what kind?
[22:05:02] <eddyb> Simple(Def) | WithSelf(Ty, Def) | WithSelfAndTrait(Ty, TraitRef, Def)
[22:05:11] <arielb1> WithSelf?
[22:05:27] <eddyb> Def is wrong there, oops
[22:05:30] <eddyb> arielb1: <T>::foo
[22:05:42] <arielb1> Path is currently a mess
[22:05:57] <arielb1> we should have an typeck-oriented Path after resolve
[22:06:17] <eddyb> Resolved(Def) | Associated(Ty, Name) | TraitAssociated(Ty, TraitRef, Name)
[22:06:19] <eddyb> maybe that
[22:06:35] <arielb1> eddyb: Ty = ast::Ty there ofc?
[22:06:42] <eddyb> or HIR::Ty
[22:07:13] <brson> eddyb: i don't have that information atm
[22:08:02] <eddyb> nmatsakis: only two crates that use '_, each with two occurrences. how bad do you think that is?
[22:08:28] <eddyb> I guess I should post this info on the appropriate RFCs
[22:09:16] <eddyb> brson: btw, the prelude_import build should succeed, there's only two non-syntex uses, both of them in pretty-printed output (which doesn't appear to be part of the source proper. and they have feature gates already)
[22:09:23] <nmatsakis> eddyb: two crates across crates.io? it occurred to me that if we wanted, we could just disable the "special meaning" for `'_` in cases where it is in scope, and lint against using it 
[22:09:39] <eddyb> nmatsakis: that's what the RFC and the sample implementation do
[22:10:03] <eddyb> also disabled without the feature gate, but that's mostly so it can be merged in "paranoid mode"
[22:10:20] <eddyb> nmatsakis: also without the lint
[22:10:54] <nmatsakis> eddyb: oh ok I didn't read the RFC in detail yet :) which is bad, I've just been assuming I can 'mostly guess' what it says ...
[22:11:21] <eddyb> and I thought reading every other row was problematic :P
[22:11:29] <eddyb> s/row/line
[22:12:04] <nmatsakis> eddyb: well I'd be fine with merging your PR in advance of the RFC itself, so long as it's properly feature-gated -- though I'd like to get a rough nod from other lang subteam members that they approve of the feature in *some* form 
[22:12:49] <eddyb> we also need consensus on the elision thing, but that sounds good
[22:13:09] <eddyb> I guess a few things should be tweaked - like the feature name
[22:15:00] <nmatsakis> eddyb: right my thought was we don't have to let consensus on the elision thing block you from making progress
[22:15:18] * nrc gives a rough nod
[22:16:03] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[22:18:02] *** Quits: eljay (eljay@moz-fmte10.skybroadband.com) (Quit: Leaving)
[22:18:06] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[22:19:51] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0/20150630154324])
[22:20:58] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[22:22:24] * nrc checks r/rust
[22:22:33] <nrc> I feel Gankro is trolling me
[22:22:38] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Quit: Konversation terminated!)
[22:22:47] *** Joins: eddyb (eddyb@moz-413.q07.26.188.IP)
[22:22:57] <pcwalton> proposal: replace metadata with a core dump of the compiler after trans, and then restart from the core dump when compiling a downstream crate
[22:23:03] * pcwalton flees
[22:23:05] <Elaine> nrc: oh he is.
[22:23:08] *** wcosta is now known as wcosta|afk
[22:23:26] <pcwalton> could do incremental compilation that way too
[22:24:02] <Elaine> pcwalton: excellent idea, we can use rr.
[22:24:31] <Gankro> nrc: The hype is real
[22:25:02] <pcwalton> oh, that's an even better idea: use PROT_NONE memory pages to figure out which data structures the compiler looked at when translating each function
[22:25:09] <pcwalton> then build the dependency graph
[22:25:11] <pcwalton> for incremental compilation
[22:25:52] <sfackler> pls
[22:26:02] <eddyb> how do you combine core dumps?
[22:26:10] <sfackler> you concatenate them!
[22:26:11] <pcwalton> eddyb: you don't need more than one dependency
[22:26:17] <eddyb> also, metadata is optimi-
[22:26:24] <eddyb> pcwalton: oh I thought it was a serious suggestion :P
[22:26:28] * pcwalton is trolling everyone
[22:27:49] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[22:28:39] *** Joins: summerlight_ (summerlight@moz-lb3.6do.193.175.IP)
[22:29:52] *** Quits: eibwen (eibwen@moz-v66ehg.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:31:23] *** Quits: bdero (bran@moz-91hi89.mit.edu) (Ping timeout: 121 seconds)
[22:34:20] *** Joins: njn (chatzilla@moz-270n86.iinet.net.au)
[22:34:50] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[22:35:37] *** Joins: yjv (yjv@moz-ll38tk.pa.comcast.net)
[22:39:58] *** Quits: yjv (yjv@moz-ll38tk.pa.comcast.net) (Ping timeout: 121 seconds)
[22:40:27] *** Joins: eddyb_ (eddyb@moz-413.q07.26.188.IP)
[22:40:38] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Connection closed)
[22:40:56] <eddyb_> nmatsakis: so I was looking for potential usecases of closure autoref
[22:41:34] <eddyb_> nmatsakis: in the compiler, there's like one sole interesting use of Fn/FnMut as trait objects:
[22:41:36] <eddyb_> src/librustc_typeck/coherence/mod.rs:                               mk_ptr: &Fn(Ty<'tcx>) -> Ty<'tcx>| {
[22:41:50] <eddyb_> and yeah, that's a closure taking a closure
[22:42:21] <nmatsakis> eddyb_: there are lots of bits of code that were rewritten in a rather awkward style due to recursion though
[22:42:33] <eddyb_> I believe *all* the usecases involve HOF
[22:42:43] <eddyb_> though most are boring
[22:42:49] <nmatsakis> I'm not sure why HOF is so relevant?
[22:43:02] <nmatsakis> or rather, I think there is lots of code that is not using a closure object
[22:43:04] <eddyb_> nmatsakis: because you can't have closures generic over closures
[22:43:05] <nmatsakis> but which arguably could/should
[22:43:15] <nmatsakis> yes, I figured out what you meant after the fact
[22:43:24] *** Quits: summerlight_ (summerlight@moz-lb3.6do.193.175.IP) (Ping timeout: 121 seconds)
[22:43:53] <nmatsakis> eddyb_: recursive cases as well benefit, or at least can generate fewer 'not especially helpful' copies of themselves
[22:44:17] <nmatsakis> in general though I'm not sure what the tradeoff is to be honest
[22:44:35] <nmatsakis> like what the threshold is where making N copies of the code outweights the benefits of having N copies of the code :)
[22:46:13] <eddyb_> and for closure expressions there's also a single interesting case:
[22:46:15] <eddyb_> src/librustc/middle/ty_fold.rs:    value.fold_with(&mut RegionFolder::new(tcx, &mut false, &mut |region, _current_depth| {
[22:47:13] <eddyb_> nmatsakis: presumably when you end up with functions that could be merged but they statically call different functions at certain points
[22:48:31] <eddyb_> nmatsakis: I would almost suggest teaching mergefunc how to reify those calls (and have the respective functions take an extra function pointer argument, that could bubble up, repeatedly)
[22:48:49] <nmatsakis> eddyb_: silently introduce vritual calls? doesn't feel very rusty
[22:49:01] <eddyb_> nmatsakis: they're not "virtual"
[22:49:10] <nmatsakis> calling through a function pointer is not virtual?
[22:49:31] <eddyb_> there's no practical difference between calling a function directly and calling through a function pointer
[22:49:40] <eddyb_> except for compiler optimizations
[22:49:54] <eddyb_> this would happen after all optimizations, the only cost would be passing that pointer around
[22:50:19] <Elaine> that's simply not true
[22:50:29] <eddyb_> it's general LLVM optimization that would probably help out in template-heavy C++ code as well
[22:50:32] <eddyb_> Elaine: what isn't?
[22:50:52] <Elaine> that there's no practical impact of indirect calls.
[22:50:52] <eddyb_> you're saying CPUs have a special path for immediate relative calls?
[22:51:00] <Elaine> yes, they do.
[22:51:05] <brson> the internet doesn't have a lot of hits for 'life before main' besides things from rust
[22:51:14] <brson> for some reason i thought this was a common term
[22:51:25] <brson> though maybe i'm rust-filter-bubbled
[22:51:56] <eddyb_> Elaine: great, I have been misinformed, now I have to actually research this
[22:52:33] *** eddyb_ is now known as eddyb
[22:52:52] <eddyb> Elaine: is it a x86 thing, or does it also happen on ARM/MIPS?
[22:53:12] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[22:53:51] *** Quits: apcully (user@moz-mao2lt.fl.comcast.net) (Ping timeout: 121 seconds)
[22:54:56] <Elaine> Not sure about the details on other architectures.
[22:55:18] *** Quits: mgottschlag (quassel@moz-27iuo2.hsi6.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[22:56:04] <eddyb> a far call has a latency of 23-32?!
[22:56:32] <eddyb> that's real-mode-only, not just any indirect call, right?
[22:57:29] <ChrisMorgan> Gah, on a fresh master build solicit (HTTP/2, used by hyper, used by my stuff) is ICEing ‚òπ
[22:57:35] <Elaine> I think near calls are still a thing, at least in terms of instruction encoding.
[22:57:35] <eddyb> a near call has a latency of 2 while a register indirect one has a latency of 3
[22:57:40] <ChrisMorgan> Encountered errors `[FulfillmentError(Obligation(predicate=Binder(TraitPredicate(<http::session::DefaultStream as core::cmp::PartialOrd>)),depth=1),Unimplemented)]` fulfilling during trans
[22:57:41] <jroesch> eddyb: is there any reason path instantiation would be different for a fn with a return type and one without it?
[22:57:57] <eddyb> Elaine: that's fixed
[22:57:59] <eddyb> oops
[22:58:01] <eddyb> ChrisMorgan: ^^
[22:58:03] <jroesch> eddyb: it appears my defaults collection code only works when there is a specified return type 
[22:58:15] <eddyb> ChrisMorgan: there's a PR open for it
[22:58:19] <eddyb> ask jroesch to review it
[22:58:39] <Elaine> eddyb: I'm trying to find the reference in intel's optzn manual but iirc it interferes with both branch prediction and instruction prefetch.
[22:58:40] <eddyb> jroesch: fn definitions?
[22:58:50] <eddyb> Elaine: yeah, that's what I was worried about
[22:58:51] <Elaine> and possibly the icache as well but I doubt that.
[22:59:09] <eddyb> annoying OO architectures
[22:59:18] <eddyb> OoO even
[22:59:40] *** Quits: vmx (vmx@moz-kcirof.pools.vodafone-ip.de) (Quit: Leaving)
[22:59:45] <brson> sfackler: are there any alternate loggers for the log crate besides env_
[22:59:46] <eddyb> Elaine: but I was hoping it was just the latency from the register
[22:59:47] <brson> _logger
[23:00:10] *** Quits: eddyb (eddyb@moz-413.q07.26.188.IP) (Quit: Konversation terminated!)
[23:00:19] *** Joins: eddyb (eddyb@moz-413.q07.26.188.IP)
[23:00:29] <Gankro> nrc: up to 51 comments on the RFC !!!
[23:00:43] <nrc> \0/
[23:00:48] <eddyb> Elaine: I'm looking at agner's right now
[23:01:05] <Elaine> eddyb: indirect branches are initially predicted not taken.
[23:01:31] <jroesch> eddyb: the bug is elsewhere, just realized I was mis-reading the debug output 
[23:01:53] <jroesch> eddyb: I've got defaults working just trying to make sure the conflict semantics follows the RFC
[23:02:11] <eddyb> oh wow, just like that
[23:03:04] <eddyb> jroesch: mind looking over this for a bit? https://github.com/rust-lang/rust/pull/26807
[23:03:25] <eddyb> ChrisMorgan: ^^ you'd need that patch to get rid of the ICE
[23:04:03] *** Joins: eibwen (eibwen@moz-v66ehg.dip0.t-ipconnect.de)
[23:04:17] *** Quits: arielb1 (Ariel@moz-2i0s5u.red.bezeqint.net) (Quit: Ex-Chat)
[23:05:00] <jroesch> eddyb: looks good, the only reason not to was possible performance
[23:05:06] <jroesch> possibly*
[23:05:14] <eddyb> yeah, but projections end up there
[23:05:28] <jroesch> this is one of the reasons we need to finish the normilization work
[23:06:41] <jroesch> seems strange it didn't trip a test case
[23:07:04] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[23:07:53] <jroesch> eddyb: looks like a mistake on my part in this commit https://github.com/eddyb/rust/commit/fb295a60b37fc2bc60fab29fad1863a174fa587c#diff-6186c8f94ed38371395958b0f332cc6aL1022
[23:07:57] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[23:08:14] *** Quits: eibwen (eibwen@moz-v66ehg.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[23:08:17] <eddyb> Elaine: found it, 3.14
[23:09:00] <eddyb> "The first time an indirect jump or indirect call is seen, it is predicted to go to the immediately following instruction. Therefore, an indirect jump or call should always be followed by valid code. Don't place a list of jump addresses immediately after an indirect jump or call."
[23:10:46] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Ping timeout: 121 seconds)
[23:13:26] <eddyb> Elaine: looks like there's no branch prediction penalty from Nehalem onward
[23:14:19] <eddyb> and on Haswell "Indirect jumps and indirect calls are predicted well."
[23:14:31] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Ping timeout: 121 seconds)
[23:15:00] <Elaine> eddyb: it's probably far worse on arm etc.
[23:15:01] *** Joins: annodomini (lambda@moz-d5t.ubv.222.209.IP)
[23:16:45] <eddyb> Elaine: but icache misses are also worse on ARM
[23:16:50] <eddyb> (just ask pcwalton)
[23:17:34] <pcwalton> they're worse in multicore ARM at least
[23:17:46] <pcwalton> since there's no per core L2
[23:17:49] <pcwalton> usually
[23:18:31] *** Quits: Kingsquee (kingsley@moz-k72lip.bchsia.telus.net) (Quit: Konversation terminated!)
[23:18:47] <eddyb> this looks decent http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0438h/BABEHAJJ.html
[23:19:18] <Elaine> Cortex-A15 are the highest end CPUs they offer.
[23:19:47] <Elaine> oh they have A17's now.
[23:20:49] <ytain> Elaine Tegra K1/X1 is based on Cortex A15
[23:21:58] <eddyb> that same entry isn't in A7 :/
[23:22:34] <eddyb> not even A9
[23:23:50] <eddyb> oh it's a sub-section
[23:25:15] <eddyb> Elaine: http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0434b/CHDIBCFC.html
[23:26:41] *** Joins: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP)
[23:26:51] <Elaine> eddyb: sounds good.
[23:27:00] <Elaine> at least for the A's.
[23:27:46] <Elaine> What's the flavor of the month for &str -> String?
[23:28:05] <Elaine> From?
[23:28:05] <bluss> .to_owned() I think
[23:28:14] <bluss> String::from too
[23:28:18] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[23:29:09] *** Joins: Peach (Peach@moz-500.6lb.246.96.IP)
[23:30:14] <eddyb> Elaine: looks like ARM11 is where ARM got a branch prediction unit
[23:30:40] <eddyb> huon: want to r? https://github.com/rust-lang/rust/pull/26807
[23:30:49] <eddyb> or anyone, really :P
[23:32:31] <acrichto> WindowsBunny: would CopyFileEx give us the size without calling stat() ?
[23:37:29] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Ping timeout: 121 seconds)
[23:39:49] <nagisa> acrichto: affirmative
[23:40:08] <acrichto> WindowsBunny: nagisa: ah then yeah that may be best, but not critically necessary
[23:40:31] <nagisa> you‚Äôd do it by setting lpProgressRoutine to non-null and using value you get by the last callback invocation
[23:41:18] <nagisa> (or any, really, callback has TotalFileSize field)
[23:42:40] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz‚Ä¶)
[23:46:25] *** chmanchester is now known as chmanchester|afk
[23:50:01] *** Quits: X67r (user@moz-jqpmr2.mullvad.net) (Quit: leaving)
[23:53:28] *** Joins: dcb (dcb@moz-4hh.6p3.217.74.IP)
[23:56:37] <acrichto> steveklabnik: gah you changed your avatar and now my life is upside down
[23:56:44] <bluss> eddyb: petrochenkov's observation on '_ is brilliant -- rustc made its own bed :)
[23:58:58] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Connection closed)
[23:59:01] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
