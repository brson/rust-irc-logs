[00:00:00] *** Quits: zooko (user@moz-42383A8.hsd1.co.comcast.net) (Ping timeout)
[00:00:13] <ChrisMorgan> brson: whew. Otherwise that would have been another release where a change that broke lots of things was made just before a release and the fix just after the release, rendering rust-http non-functional on that release (I think 0.8 was like that, though I never actually checked it thoroughly myself).
[00:00:20] <AlexMax> Right but if Rust is aiming to offer the speed of C++ but with fewer footguns...i dunno I'd just hate for there to be a 1.0 release and then some long blog-post about how this that and the other is some fundamental design problem that prevents it from displacing C++.
[00:00:30] <ChrisMorgan> (url has privacy issues. And hey! It was the problem last time, too!)
[00:00:45] <mcpherrin> AlexMax: Well there can always be a 2.0 :-P
[00:01:12] <AlexMax> Yeah, major version bumps of a language.
[00:01:23] * AlexMax peeks back at Python.
[00:01:29] <AlexMax> ....erm....
[00:01:29] *** Quits: rootnode (rootnode@moz-50470F7D.pools.arcor-ip.net) (Connection reset by peer)
[00:01:40] *** Joins: rootnode (rootnode@moz-50470F7D.pools.arcor-ip.net)
[00:01:52] <mcpherrin> Python is a little different...
[00:02:18] *** Quits: dherman (dherman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: dherman)
[00:02:22] <mcpherrin> What's interesting is that you could possibly call Rust 1.0 code from the Rust 2.0 FFI
[00:02:49] <mcpherrin> can't do that with python :)
[00:03:03] *** Joins: orospakr (orospakr@163E6AAB.15B0D379.C3C3A9D0.IP)
[00:03:09] *** Quits: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: tobytailor)
[00:03:17] <tiffany> if rust's type system doesn't do huge fundamental changes, it'd probably be easy enough to just straight up import a file as rust 1.0
[00:03:21] <tiffany> that'd be a big compiler though
[00:03:36] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[00:03:53] <mcpherrin> Well part of calling something 2.0 is that you implicitly have breaking changes
[00:04:09] <mcpherrin> I suppose if your code doesn't touch those broken parts you'd be okay.
[00:04:11] <tiffany> well I mean, rust 2.0 probably isn't going to remove & pointers
[00:04:21] <tiffany> or change the struct layout
[00:04:37] <mcpherrin> That's not a concern for the near future either way :p
[00:04:58] <tiffany> you can easily go further than what you usually do for C with the ffi
[00:05:25] <tiffany> if you're only using ffi then it depends on how much the ABI changes, especially for things like ~ pointers, I guess
[00:05:27] <mcpherrin> Rust 2.0 could have a rust 1.0 ffi
[00:05:32] *** Quits: james4k (james@moz-9BB5AE72.consolidated.net) (Ping timeout)
[00:06:36] <AlexMax> Is 1.0 rust going to require mingw?
[00:06:37] *** Joins: Kazimuth (james@moz-1AB3D702.hfc.comcastbusiness.net)
[00:06:38] <tiffany> what about changes to the runtime? can you have two different versions of the rust runtime in the same process?
[00:06:39] <dpc> Haha. This Travis-CI is cool thing. :)
[00:06:54] *** Quits: q66 (q66@moz-D66D80D.range86-132.btcentralplus.com) (Quit: Leaving)
[00:07:07] <mcpherrin> AlexMax: probably, unless somebody really ninjas up some msvc support
[00:07:14] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:07:18] <mcpherrin> Or LLVM really steps up their Windows game
[00:07:48] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[00:07:57] <AlexMax> why does rust even need mingw anyway?
[00:08:02] <AlexMax> like I said, I'm an outsider
[00:08:11] <mcpherrin> We need a C compiler and a linker
[00:08:20] *** Joins: SpaceWizard (Apollo@moz-E6F82C3A.maine.res.rr.com)
[00:08:36] <mcpherrin> the linker in particular is a problem
[00:08:42] <brson> AlexMax: I hope for rustc 1.0 not to require mingw at runtime, only at (rustc) build time
[00:10:15] *** Joins: james4k (james@moz-9BB5AE72.consolidated.net)
[00:10:57] <brson> we can get rid of the C compiler dependency and either pack in a GPL linker or pray lld comes through in time
[00:11:12] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:11:19] <SpaceWizard> What's changed in 0.10?
[00:11:43] <mcpherrin> brson: Or lock an intern in a closet with a stack of redbull and hope they come out with a working rust linker ;)
[00:11:44] *** Quits: rylev (rylev@moz-7A1F273F.cust.telecolumbus.net) (Connection reset by peer)
[00:11:47] <dpc> SpaceWizard: http://www.reddit.com/tb/224gc0
[00:11:55] *** Quits: orospakr (orospakr@163E6AAB.15B0D379.C3C3A9D0.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:11:57] *** Joins: seubert (etc@moz-A474784E.members.linode.com)
[00:12:08] *** Joins: rylev (rylev@moz-7A1F273F.cust.telecolumbus.net)
[00:14:47] <JustAPerson> Seems like running the tests (interested in run-make tests) touches something, preventing the tests from running again unnecessarily. How can I reset the tests so that they'll run again?
[00:15:48] <acrichto> JustAPerson: $target/test/run-make/*.ok
[00:15:53] <acrichto> those are the files that are touched
[00:16:57] <JustAPerson> acrichto: thank you!
[00:17:22] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[00:18:07] *** Quits: ChrisOei (ChrisOei@moz-53A9266A.blurb.com) (Client exited)
[00:18:22] *** Quits: rylev (rylev@moz-7A1F273F.cust.telecolumbus.net) (Client exited)
[00:23:21] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[00:23:42] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[00:25:27] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[00:26:06] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[00:27:12] *** Quits: frozendevil (Adium@moz-62FB197F.com) (Quit: Leaving.)
[00:28:24] *** Quits: carllerche (carllerche@moz-2B516F15.hsd1.or.comcast.net) (Quit: carllerche)
[00:29:03] *** Quits: jadbaires (jadrian@moz-9582D0E.dsl.telepac.pt) (Quit: Konversation terminated!)
[00:29:55] *** Joins: user (user@moz-6D27B7CC.nycmny.fios.verizon.net)
[00:30:06] <user> is rust stable enough to write production code?
[00:30:15] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[00:30:16] *** Quits: Denommus (user@7ACE3361.B4C8460.B9657DD5.IP) (Quit: going home)
[00:30:25] <cmr> user: depends on what you mean by "stable" and "production"
[00:30:38] <SiegeLord> If you need stability to write production code, then it is not
[00:30:38] *** Quits: eibwen (kvirc@moz-2CFC2C74.dip0.t-ipconnect.de) (Ping timeout)
[00:30:58] <cmr> a compiled binary is reliable, but compiling it on different days will yield breakage.
[00:30:58] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Client exited)
[00:31:01] <strcat> really depends on what you mean by 'stable'... if you mean that the language is no evolving, no
[00:31:11] <strcat> not evolving*
[00:31:17] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[00:31:19] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[00:31:25] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[00:31:28] <cmr> (I ran a single binary from the day static linking was merged until about a week ago)
[00:31:31] <user> i meant tectonic changes like like do spawn being deprecated
[00:31:41] <cmr> no.
[00:31:42] <o11c> a compiled binary is stable if it's *static* linked
[00:31:52] <cmr> o11c: or if you don't replace its dependencies
[00:32:14] <user> or libstd::tcp being rearranged to net::io::tcp or some such
[00:32:27] <user> or uv_main_loop totally disappearing
[00:32:41] <cmr> user: nah, none of that stuff is going to be marked #[stable] any time soon.
[00:33:03] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[00:33:07] <user> so they're liable to change in the future?
[00:34:49] <cmr> probably not too much,, but that's not a promise.
[00:36:27] *** Quits: celm (celm@28EA790F.C8D2EDAC.4E808C72.IP) (Input/output error)
[00:37:30] *** Parts: judder (maradukewa@BD9E6B94.126EFFE1.78E362FE.IP) ()
[00:40:15] *** Quits: andrew-__ (andrew-d_w@E04ADC0E.9DFA657C.CC0301A2.IP) (Input/output error)
[00:40:21] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[00:40:30] *** Joins: bakkdoor (bakkdoor@moz-20C011BF.dip.osnanet.de)
[00:40:36] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[00:41:05] *** Joins: benvie_ (bbenvie@5FD20F9A.53D07D95.EFF8B7BF.IP)
[00:41:09] <strcat> cmr: I'm sure the stdlib will change a lot
[00:41:34] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[00:41:51] <strcat> rust isn't close to being able to mark any of the I/O stuff as stable imo, it's still changing all the time
[00:42:00] *** Quits: richard|s_ (mindginati@moz-1E093B8E.dyn.cust.vf.net.nz) (Ping timeout)
[00:42:13] <strcat> stuff like std::fmt, std::iter, parts of std::vec - yeah, it could be stabilized soon
[00:42:26] <strcat> but it can't just be marked stable without discussion
[00:42:29] <strcat> or it's meaningless
[00:42:34] <strcat> will have to change in the future
[00:43:08] <strcat> rusti: $()
[00:43:12] -rusti- <anon>:11:9: 11:10 error: unexpected token: `$`
[00:43:12] -rusti- <anon>:11         $()
[00:43:12] -rusti-                   ^
[00:43:12] -rusti- playpen: application terminated with error code 101
[00:43:24] <strcat> rusti: !
[00:43:25] -rusti- <anon>:12:5: 12:6 error: unexpected token: `}`
[00:43:25] -rusti- <anon>:12     };
[00:43:25] -rusti-               ^
[00:43:25] -rusti- playpen: application terminated with error code 101
[00:43:30] *** Quits: bakkdoor (bakkdoor@moz-20C011BF.dip.osnanet.de) (Quit: Linkinus - http://linkinus.com)
[00:43:38] <tiffany> rusti: file!()
[00:43:41] -rusti- <anon>
[00:43:57] *** Joins: richard|s_ (mindginati@52C2689A.6E9E9E0.6400445B.IP)
[00:44:01] <strcat> huh?
[00:44:19] <tiffany> that was something I just remembered I wanted to try but couldn't at the time because rusti was down
[00:44:22] *** Quits: canhtak (canhtak@moz-9F7DB66C.wl.t.ulaval.ca) (Quit: canhtak)
[00:44:43] <strcat> rusti: include_str!("/usr/local/bin/irc.sh")
[00:44:47] -rusti- pastebinned 25 lines of output: http://ix.io/bsO
[00:44:49] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[00:45:06] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[00:45:33] <hirsch> can I call a fn in the same impl from a function with a mutable self?
[00:45:54] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[00:46:09] <cmr> hirsch: example?
[00:46:19] <cmr> you can call methods on self, certainly.
[00:46:35] *** Joins: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net)
[00:46:39] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[00:46:51] <hirsch> fn sim(&mut self) { self.other(); }
[00:47:52] <hirsch> Sorry, the example is not complete...
[00:48:44] <mmalecki> hm, what does rusti run that can run bash scripts from IRC? is this some sort of a bash irc framework?
[00:48:45] <hirsch> fn sim(&mut self) { for e in self.mut_iter() { mapself.other(); } }
[00:49:05] <hirsch> fn sim(&mut self) { for e in self.mut_iter() { self.other(); } }
[00:49:29] <strcat> mmalecki: https://github.com/thestinger/playpen
[00:50:07] <strcat> it doesn't use bash at all though, it just happens to be running a dash script in the sandbox
[00:50:15] <strcat> which runs rustc and then the produced binary
[00:50:40] <mmalecki> ohh, cool! didn't hear about playpen earlier, looks neat (besides that systemd part but oh well)
[00:50:45] <hirsch> the compiler complains that *self is already borrowed as mutable can I tell the compiler that self.other() doesn't change self?
[00:50:54] <mmalecki> how does it run those scripts basing on IRC input tho?
[00:51:16] <strcat> there's no other cgroup manager other than systemd
[00:51:22] <strcat> so there's nothing else *to* support
[00:51:27] <strcat> the old cgroup API is deprecated
[00:51:38] <mmalecki> oh? damn, when did that happen?
[00:51:58] <strcat> the kernel devs want to remove the current cgroup fs because it exposes way too many implementation details
[00:52:04] *** Joins: celm (celm@moz-1CF4AE70.hsd1.ca.comcast.net)
[00:52:07] <strcat> and is really not scaling to what people use it for
[00:52:30] <strcat> it doesn't support virtualization in containers and is racy since many programs are messing with it
[00:52:36] <strcat> it will be single-writer
[00:53:06] <strcat> I somewhat doubt that anyone else will write a cgroup manager though
[00:53:17] *** Quits: enos (jkingyens@moz-7A8F6201.hsd1.ca.comcast.net) (Quit: enos)
[00:53:42] <mmalecki> right, so C APIs are staying, but fs-based API is deprecated?
[00:53:52] <strcat> there's no C API
[00:54:15] <strcat> the current filesystem-based API is deprecated though
[00:54:58] <strcat> you're not supposed to use it directly anymore, I think in 3.15 it changes (the deprecated one will stay around for a long time, but you either get new cgroups *or* the deprecated API)
[00:55:02] <mmalecki> there is a kernel-level API, isn't there?
[00:55:14] <strcat> there are no syscalls
[00:55:51] <strcat> https://github.com/thestinger/playpen/commit/d3d222234ed1b373e813d67e7439fe5f881ebb62 that was my transition from the old API
[00:56:59] <strcat> the cgroups kernel maintainer really wants it non-hierarchy based and single-writer
[00:57:07] <strcat> with namespace support replacing a hierarchy
[00:57:36] * strcat shrugs
[00:57:47] <strcat> cgroups are one of the things broken with containers though
[00:57:51] <strcat> audit is another
[00:58:01] *** Quits: hirsch (Mibbit@moz-B73683DE.superkabel.de) (Quit: http://www.mibbit.com ajax IRC Client)
[00:59:24] <mmalecki> right, by kernel-level API I meant APIs which are accessible to kernel modules
[00:59:32] <strcat> ah
[00:59:36] <strcat> well I guess so
[00:59:40] *** Quits: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net) (Ping timeout)
[00:59:56] *** Quits: leowoe (Leo@moz-3F05B6B5.dip0.t-ipconnect.de) (Quit: Leaving.)
[01:00:05] *** Joins: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net)
[01:00:28] *** Quits: onelson (owen@moz-DD666EC5.laika.com) (Quit: Leaving)
[01:01:42] <mmalecki> so single-level namespaces instead of hierarchies?
[01:02:14] <strcat> no hierarchy at all
[01:02:21] <strcat> I think it will be tied to process namespaces
[01:02:27] <strcat> so in a container you can have a fresh cgroup fs
[01:02:53] <strcat> maybe it'll be a cgroup-specific namespace
[01:03:03] <strcat> it does need to be tied to process namespaces to work properly though
[01:03:05] <strcat> it's totally broken atm
[01:03:14] *** Quits: celm (celm@moz-1CF4AE70.hsd1.ca.comcast.net) (Quit: Leaving...)
[01:03:48] *** Quits: azakai (alon@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[01:04:48] <mmalecki> curious. the whole single-writer thing is a bit weird tho, since you basically can run systemd or a different cgroups controller, not two at the same time, right?
[01:04:58] <strcat> just one at a time
[01:05:03] *** Quits: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 28.0/20140314220517])
[01:06:02] *** Quits: james4k (james@moz-9BB5AE72.consolidated.net) (Ping timeout)
[01:07:32] *** Joins: enos (jkingyens@moz-BE1786F9.mycingular.net)
[01:07:34] <mmalecki> that's too bad actually. not a huge systemd fan here
[01:07:42] *** Quits: enos (jkingyens@moz-BE1786F9.mycingular.net) (Quit: enos)
[01:07:50] <strcat> there's no advantage to it being multi-writer
[01:08:01] <strcat> just means there are races and stuff doesn't get cleaned up properly
[01:08:27] <strcat> if a process (say, chromium) is killed, then the cgroups it created wouldn't be cleaned up - so that's a resource leak
[01:08:29] <mmalecki> right, I can totally see disadventages of being multiple writer, but imo being a single writer reduces the flexibility
[01:08:32] *** Joins: andrewd18 (andrew@moz-DAC9D29F.wi.res.rr.com)
[01:08:43] <strcat> the same flexibility is there - you ask the cgroup manager to do stuff for you
[01:09:00] <mmalecki> right, but you need to ask a specific cgroup manager, right?
[01:09:11] <mmalecki> like, you need to interact with systemd specifically
[01:09:14] *** Quits: jxv (jxv@moz-D1F0EBC3.socal.res.rr.com) (Quit: QUIT)
[01:09:45] *** Quits: ksf (ksf@moz-DAB90186.adsl.hansenet.de) (Quit: Leaving)
[01:09:56] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[01:10:18] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[01:10:26] <strcat> mmalecki: someone else could implement the same dbus api, but I doubt anyone else is really interested in doing the work
[01:10:52] *** Joins: james4k (james@moz-9BB5AE72.consolidated.net)
[01:11:19] *** Quits: nszceta (nszceta@moz-E458A7C0.pharm.pitt.edu) (Quit: Textual IRC Client: www.textualapp.com)
[01:11:25] <strcat> other init systems never had support for cgroups at all, even for reliably stopping services - I don't think they have interest in them
[01:11:56] <strcat> google is a big user of cgroups and will probably just keep using the old API until debian/ubuntu have finished their planned switch to systemd
[01:12:40] <mmalecki> right. I was gonna say, the fact that you have to talk to a specific group controller won't really matter since pretty much every distro is switching to systemd
[01:12:50] *** Joins: riteofpassage (RiteOfPass@FF1B00AD.C33E15E.EE6E63A5.IP)
[01:13:25] <strcat> the deprecated API will be around for a long time but it's broken by design in various ways
[01:13:33] <strcat> like there's a racy concept of a 'release agent'
[01:13:37] *** Joins: enos (jkingyens@moz-BE1786F9.mycingular.net)
[01:13:39] <strcat> and it fails to always tell you that you can clean up
[01:13:49] *** Quits: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net) (Ping timeout)
[01:13:58] <strcat> so you'll leak cgroups atm, pretty much no matter what you do, unless you poll and do a gc of them or something
[01:14:12] *** benvie_ is now known as benvie
[01:14:26] <strcat> rusti: fn foo() { loop {} } foo()
[01:14:29] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:14:30] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[01:14:32] -rusti- playpen: timeout triggered!
[01:14:34] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[01:14:37] <strcat> leaked cgroup
[01:14:38] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:15:11] <strcat> (it kills the process, and the kernel race causes it to never get a notification)
[01:15:38] * strcat used an atexit handler before... but meh
[01:15:49] <strcat> will just wait until it works properly now ;p
[01:16:11] <mmalecki> interesting. that was insightful :)
[01:16:18] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Ping timeout)
[01:16:24] <mmalecki> wish I could continue but gotta breakfast and sleep
[01:16:34] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[01:16:57] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:16:57] *** Quits: rchar (mark@16F93251.43AE57A3.2CFE048.IP) (Ping timeout)
[01:17:37] <benh> With libnative, what features does the presence of the runtime actually enable?
[01:17:49] <benh> Is it mostly just that the runtime needs to be there so the code in std can check which runtime it is?
[01:18:01] <mmalecki> thanks strcat :)
[01:18:18] *** Joins: canhtak (canhtak@moz-9F7DB66C.wl.t.ulaval.ca)
[01:18:40] <strcat> mmalecki: http://ix.io/bsQ there's what happens with it atm if you're curious (the broken with containers/namespaces part)
[01:18:55] <strcat> boot OS in container -> cgroup FS is totally shared with host ;\
[01:19:04] <strcat> (can see the leaked playpen cgroup from above)
[01:20:05] *** Quits: dpc (Mibbit@moz-88B014CD.nvidia.com) (Quit: http://www.mibbit.com ajax IRC Client)
[01:20:45] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[01:20:59] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[01:21:10] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[01:21:26] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[01:21:37] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[01:21:46] *** Joins: rchar (mark@16F93251.43AE57A3.2CFE048.IP)
[01:23:08] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[01:23:29] <Rusky> can I make a trait with some public and some private methods?
[01:24:08] <Rusky> wait I could just make a generic function on that trait in the module anyway
[01:24:29] <Rusky> if I can do "template specialization" that is?
[01:25:09] *** Quits: soumyaC (uid15286@moz-E77DEB21.irccloud.com) (Quit: Connection closed for inactivity)
[01:26:12] *** Joins: claudiu_ (claudiu@moz-6F0C4397.thefacebook.com)
[01:26:14] *** Quits: claudiu (claudiu@moz-6F0C4397.thefacebook.com) (Connection reset by peer)
[01:26:53] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:27:06] *** Quits: enos (jkingyens@moz-BE1786F9.mycingular.net) (Quit: enos)
[01:27:18] *** Quits: japaric_ (japaric@911E88BD.F9FFD430.3E85381A.IP) (Ping timeout)
[01:27:24] *** Joins: lpy (lpy@3B6F1F1D.F09091A8.1348A864.IP)
[01:27:31] *** Quits: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com) (Quit: Leaving.)
[01:28:15] *** Joins: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[01:28:34] *** Joins: japaric_ (japaric@F0EDDE6E.BD5E6C4A.766D0B82.IP)
[01:29:29] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[01:31:35] <cmr> well you don't need template specialization, the type parameter just needs to be bounded by that trait.
[01:31:46] <Rusky> I need a different implementation for each impl
[01:31:58] <cmr> ah
[01:32:13] <cmr> I believe a trait can have private methods, but I'm not sure
[01:33:03] <Rusky> it's saying "unnecessary visibility"
[01:33:19] <Rusky> "trait functions inherit visibility of the trait itself"
[01:33:29] <cmr> oh.
[01:34:26] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[01:36:06] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[01:40:46] <det> Writing a binary tree removal function in Rust is hard, had to really contort the code to make the borrow checker not complain.
[01:43:11] <strcat> lots of swaps :(
[01:43:24] <strcat> the option methods like swap_unwrap are helpful
[01:43:55] *** Joins: lpy_ (lpy@207F51B2.F09091A8.1348A864.IP)
[01:44:24] <det> ya, had to swap outside the scope
[01:44:49] <det> and do an explicit return in 1 case of the match, but fall through in the other
[01:44:51] *** Quits: lpy (lpy@3B6F1F1D.F09091A8.1348A864.IP) (Ping timeout)
[01:45:30] <det> maybe there are some tricks picked up as you learn to make it less painful
[01:46:23] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[01:49:58] *** Joins: Savago (Savago@202BED95.35A5082B.B8C5454C.IP)
[01:50:38] *** Joins: iopq (Instantbir@moz-8CB45329.hsd1.ca.comcast.net)
[01:51:04] <iopq> I'm trying to pattern match on two different things at the same time and I can't get my mind around it
[01:51:05] <iopq> 	let n = match args {
[01:51:05] <iopq> 		[_, n] => n,
[01:51:05] <iopq> 		_ => ~"100"
[01:51:05] <iopq> 	};
[01:51:05] <iopq> 	
[01:51:05] <iopq> 	match from_str::<int>(n) {
[01:51:05] <iopq> 		Some(x)=>for i in std::iter::range_inclusive(1, x) {
[01:51:05] <iopq> 		  println!("{}", fizzbuzz(i));
[01:51:05] <iopq> 		},
[01:51:06] <iopq> 		None=>println!("I need a real number")
[01:51:06] -concrete.mozilla.org- *** Channel msg/noticeflood detected (limit is 10 per 10 seconds), setting mode +M
[01:51:06] *** concrete.mozilla.org sets mode: +M 
[01:51:07] <iopq> 	}
[01:51:36] *** cmr sets mode: -M 
[01:51:40] <iopq> can I avoid doing two matches and somehow combine them
[01:51:43] <cmr> iopq: use a pastebin such as gist.github.com please
[01:52:04] *** Quits: rchar (mark@16F93251.43AE57A3.2CFE048.IP) (Ping timeout)
[01:52:29] <iopq> http://hastebin.com/litoyiloxi.coffee
[01:52:54] <iopq> it seems a little wasteful to put ~"100" on the heap just to from_str it a second later
[01:53:10] <iopq> when I really mean is default is an int that's 100
[01:55:15] <strcat> rusti: Some(2).get_or(5)
[01:55:18] -rusti- pastebinned 11 lines of output: http://ix.io/bsT
[01:55:26] <strcat> rusti: Some(2).unwrap_or(5)
[01:55:27] -rusti- 2
[01:55:30] <strcat> rusti: None::<int>.unwrap_or(5)
[01:55:31] -rusti- 5
[01:55:54] <strcat> rusti: None::<int>.expect("foo")
[01:55:55] -rusti- task '<main>' failed at 'foo', /build/rust-git/src/rust/src/libstd/option.rs:245
[01:55:56] -rusti- playpen: application terminated with error code 101
[01:56:00] <strcat> rusti: Some(2).expect("foo")
[01:56:01] -rusti- 2
[01:56:07] <strcat> no matches needed
[01:56:51] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[01:58:24] <iopq> wait what
[01:58:49] <strcat> Option is regular enum, it's not special, it has methods implemented on it
[01:59:18] <iopq> I don't know how to into Rust, how would I rewrite that code to use those methods?
[02:00:06] <strcat> well I'm not really sure what args is
[02:00:17] <iopq> 	let args = std::os::args();
[02:01:12] <iopq> if we eliminate the intermediate error message of needing a real number I wouldn't really miss it either
[02:01:19] <det> I dont know if remove_left can be written more simply: https://gist.github.com/anonymous/9966668
[02:01:54] <strcat> iopq: from_str::<int>(n).expect(error_message)
[02:02:39] <strcat> http://static.rust-lang.org/doc/master/std/option/enum.Option.html#method.expect
[02:03:09] <Florob> Besides [_, n] doesn't actually work anymore
[02:04:03] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[02:04:52] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[02:04:55] <iopq> florob: does it have anything to do with DST
[02:05:06] *** Joins: dranov (dranov@6D261496.94264913.FB866788.IP)
[02:05:34] <Florob> iopq, I think that change was in preparation to DSTs, yes.
[02:05:55] <cmr> it does work.
[02:06:08] <cmr> it just only matches against slices and arrays.
[02:06:18] <cmr> not vectors
[02:06:18] <strcat> yeah it still works
[02:06:32] <strcat> you can take a slice pointing into a vector though
[02:06:59] <Florob> Does it work with this syntax though, or is that &[_, n]?
[02:07:06] <strcat> it works with [_, n]
[02:07:50] <det> Can I map on an option without moving its contents ?
[02:08:07] <strcat> det: as_ref().map()
[02:08:16] <det> thanks
[02:08:31] <strcat> as_ref/as_mut do Option<T> -> Option<&T>/Option<&mut T>
[02:09:02] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[02:09:09] <iopq> I'm still confused as how to rewrite the code I have without having to heap allocate a string and just go straight to having a default that's an int
[02:10:00] <iopq> since I need to both make sure the first argument exists and is a valid int at the same time
[02:10:07] *** Parts: libfud (libfud@moz-73F272E4.res-cmts.eph2.ptd.net) ()
[02:10:18] <strcat> iopq: in the match arm handling an argument, put the code parsing it into an integer and calling expect(error)
[02:10:23] <strcat> and then put 100 in the other arm
[02:10:47] <strcat> rusti: match Some(5) { Some(x) => x + 1, 10 }
[02:10:47] -rusti- <anon>:11:46: 11:47 error: expected `=>` but found `}`
[02:10:47] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[02:10:47] -rusti- <anon>:11         match Some(5) { Some(x) => x + 1, 10 }
[02:10:47] -rusti-                                                        ^
[02:10:47] -rusti- playpen: application terminated with error code 101
[02:10:52] <strcat> rusti: match Some(5) { Some(x) => x + 1, _ => 10 }
[02:10:53] -rusti- 6
[02:11:04] *** Joins: mno2 (mno2@E1E0A0A3.621D86F0.CFF65E33.IP)
[02:11:11] <Florob> let n: int = args.iter().skip(1).next().and_then(|x| from_str(*x)).unwrap_or(100);
[02:11:44] <strcat> that's a really overcomplicated way of doing it ;p
[02:11:51] <strcat> just call get(1)
[02:11:56] <strcat> no need for an iterator there
[02:12:01] <Florob> If that would return an option, I would have
[02:12:09] <Florob> But get(1) fails
[02:12:30] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Ping timeout)
[02:12:51] *** Joins: p1start (rewi@moz-E7F3D014.org)
[02:13:04] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[02:13:07] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[02:13:30] *** Joins: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[02:13:48] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:14:07] *** Quits: claudiu_ (claudiu@moz-6F0C4397.thefacebook.com) (Input/output error)
[02:14:28] *** Joins: claudiu (claudiu@moz-6F0C4397.thefacebook.com)
[02:14:39] <strcat> rusti: let xs = ["foo", "10"]; from_str::<int>(*xs.get(1).expect("bar"))
[02:14:40] -rusti- Some(10)
[02:15:23] <Florob> rusti: let xs = vec!["foo", "10"]; from_str::<int>(*xs.get(1).expect("bar"))
[02:15:26] -rusti- pastebinned 11 lines of output: http://ix.io/bsY
[02:15:27] <iopq> strcat: ok, is this what you meant? http://hastebin.com/vedibahanu.coffee
[02:15:35] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:15:39] *** Joins: alex_abreu (alex@moz-7421D6C9.mc.videotron.ca)
[02:15:59] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[02:16:09] *** Quits: claudiu (claudiu@moz-6F0C4397.thefacebook.com) (Ping timeout)
[02:16:14] <strcat> iopq: yes
[02:16:23] <iopq> thanks, from my testing it works
[02:16:34] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (Quit: ziad)
[02:16:34] <strcat> although you could use `get`
[02:16:54] * strcat shrugs
[02:17:04] <strcat> (my example above didn't make sense)
[02:17:07] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[02:17:07] <det> The contortions of my remove_left function also ruined TCO :<
[02:17:38] <iopq> what is get?
[02:18:14] <iopq> http://static.rust-lang.org/doc/master/std/option/enum.Option.html?search=get not helping
[02:18:28] <strcat> iopq: a method on slices
[02:19:18] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:19:26] *** Quits: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com) (Quit: Leaving.)
[02:19:37] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[02:20:55] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[02:20:57] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[02:21:05] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Connection reset by peer)
[02:21:26] *** Joins: IanCormac84 (User@659E65F3.64D641E5.67DFF8B4.IP)
[02:21:37] <Florob> I have to say I'm a bit irritated that it appears most useful methods are only available on slices right now. And quirks like ImmutableVector::get() being semantically different from Vec<T>::get() don't really help :/
[02:22:42] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[02:23:01] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Quit: Leaving)
[02:23:31] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[02:23:37] *** Quits: user (user@moz-6D27B7CC.nycmny.fios.verizon.net) (Ping timeout)
[02:23:41] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[02:24:11] *** lpy_ is now known as lpy
[02:24:21] <cmr> Florob: it didn't used to be, it was removed to 
[02:24:29] *** Quits: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com) (Quit: Leaving.)
[02:24:35] <cmr> make porting code that used indexing more straightforward
[02:24:42] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[02:25:27] *** Joins: user (user@moz-6D27B7CC.nycmny.fios.verizon.net)
[02:26:30] *** Quits: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net) (Quit: Leaving.)
[02:27:00] *** Joins: alisdair (textual@moz-7E6FA9C4.bchsia.telus.net)
[02:27:07] *** Quits: Savago (Savago@202BED95.35A5082B.B8C5454C.IP) (Quit: Savago)
[02:27:26] <Florob> cmr, I don't really get why that couldn't just have been get_ref(). Also my impression is most code that uses indexing really shouldn't…
[02:27:29] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[02:28:00] <cmr> yeah, well, the reality is what it is.
[02:28:11] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[02:28:12] <cmr> once DST lands we can clean up Vec<T>
[02:28:22] *** Joins: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net)
[02:28:36] <cmr> really the only methods it should have are push, pop, grow, reserve, and possibly a few more.
[02:28:48] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[02:28:48] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[02:29:43] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Quit: csherratt)
[02:29:49] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[02:30:03] <Florob> huh, why? I'd think it'd ideally gain everything that the current ~[T] has, or it'll be rather painful to use
[02:30:45] *** Quits: dew (Instantbir@moz-D2186B13.static.stls.mo.charter.com) (Ping timeout)
[02:30:45] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[02:30:48] <cmr> because it will be autosliced.
[02:31:00] <cmr> it will have a Deref<[T]> implementation.
[02:31:12] <cmr> thus all methods on slices will also work on Vec<T>
[02:31:32] <Rusky> rusti: struct st { f: || } fn foo<'a>(s: &'a st, f: ||:'a) { s.f = f; }
[02:31:33] -rusti- <anon>:11:57: 11:59 error: `'static` is the only permissible region bound here
[02:31:33] -rusti- <anon>:11         struct st { f: || } fn foo<'a>(s: &'a st, f: ||:'a) { s.f = f; }
[02:31:33] -rusti-                                                                   ^~
[02:31:33] -rusti- error: aborting due to previous error
[02:31:34] -rusti- playpen: application terminated with error code 101
[02:31:36] <Rusky> why doesn't that work?
[02:31:55] <cmr> Rusky: http://static.rust-lang.org/doc/master/complement-cheatsheet.html#how-do-i-store-a-function-in-a-struct?
[02:31:57] *** Quits: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com) (Quit: Leaving.)
[02:32:22] <cmr> Rusky: specifically you want `'a ||`, not `||:'a`
[02:32:28] <Rusky> ah
[02:32:29] <cmr> Rusky: the bound is for kinds
[02:32:38] <cmr> http://static.rust-lang.org/doc/master/rust.html#type-kinds
[02:32:45] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[02:33:03] *** Quits: kimundi (kimundi@moz-B0C67194.dip0.t-ipconnect.de) (Ping timeout)
[02:33:20] <dLog> er, I think I did that wrong. I just send a PR just for review, but I think I should have attached it to #13287. I'm actually not 100% sure how to do that, which is why it ended up making a new #13298.
[02:33:22] *** Joins: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net)
[02:34:33] *** Joins: sodaplayer (sodaplayer@moz-A9992A94.slkc.qwest.net)
[02:34:39] <cmr> dLog: pull requests don't need to be attached to issue.
[02:34:41] <cmr> *issues
[02:35:00] <cmr> dLog: it's not even possible to do without using github's api, so don't worry about it :)
[02:35:03] <dLog> ah, alright. I guess I should have just referenced it in the PR comment?
[02:35:17] <cmr> yup
[02:35:34] <dLog> What's the proper way to do that? Just lead with "For #13287" or something?
[02:35:59] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[02:35:59] <cmr> Or "Fixes", if it actually closes the issue
[02:36:07] <dLog> I can edit that in, at least. Nah, it won't close it yet
[02:36:15] <cmr> ok, then that works.
[02:36:35] *** Joins: kimundi (kimundi@moz-DF1E95E2.dip0.t-ipconnect.de)
[02:36:55] <dLog> There we go, the reference shows up in the initial issue
[02:36:56] <dLog> thanks
[02:37:47] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[02:38:04] *** Joins: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net)
[02:38:26] *** Joins: phay (phay@16E8BAAB.D2C4A785.91986DB5.IP)
[02:39:09] *** Joins: bpicolo (Mibbit@moz-44D38470.hsd1.ca.comcast.net)
[02:39:12] *** Quits: lpy (lpy@207F51B2.F09091A8.1348A864.IP) (Connection reset by peer)
[02:39:32] <bpicolo> Where can I find like, a list of things that are standard to implement like ::new?
[02:39:43] *** Joins: lpy (lpy@1AF10827.F09091A8.1348A864.IP)
[02:39:54] <cmr> bpicolo: there is no list afaik
[02:40:01] <bpicolo> Ah =[
[02:40:49] *** kimundi is now known as zz_kimundi
[02:40:58] <cmr> #[deriving(Show, Eq, Ord, Hash)] is all of it, I think.
[02:43:08] *** Joins: exobit (foo@moz-90D1B547.nycmny.fios.verizon.net)
[02:43:33] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[02:44:27] *** Quits: sodaplayer (sodaplayer@moz-A9992A94.slkc.qwest.net) (Quit: WeeChat 0.4.3)
[02:44:57] *** Quits: canhtak (canhtak@moz-9F7DB66C.wl.t.ulaval.ca) (Quit: canhtak)
[02:45:31] *** Joins: lpy_ (lpy@207F51B2.F09091A8.1348A864.IP)
[02:45:38] *** Quits: dranov (dranov@6D261496.94264913.FB866788.IP) (Ping timeout)
[02:45:53] *** Quits: lpy (lpy@1AF10827.F09091A8.1348A864.IP) (Ping timeout)
[02:47:38] *** Quits: p1start (rewi@moz-E7F3D014.org) (Ping timeout)
[02:48:00] *** Joins: wilmoore (wilmoore@moz-4EF3CEBC.hsd1.co.comcast.net)
[02:48:18] *** Joins: canhtak (canhtak@moz-9F7DB66C.wl.t.ulaval.ca)
[02:49:53] *** zz_kimundi is now known as kimundi
[02:53:52] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:53:52] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:54:11] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:54:11] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:54:47] <bpicolo> Where was the part about renaming types?
[02:55:02] <bpicolo> Is that just type foo = bar?
[02:55:09] <cmr> that is a type alias or typedef, yes.
[02:55:26] <acrichto> Rusky: cmr: btw once #13268 lands the syntax will be "||: 'a"
[02:55:33] *** Quits: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net) (Client exited)
[02:55:41] *** Joins: guest22221 (guest2222@D0C70673.5D6710ED.284344F5.IP)
[02:55:50] *** Joins: guest22222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[02:55:53] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:55:53] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:55:53] *** Joins: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net)
[02:55:59] *** Quits: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Connection reset by peer)
[02:56:05] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:56:12] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:56:17] <bpicolo> acrichto: for typedefs?
[02:56:19] <bpicolo> cmr: Thanks!
[02:57:04] <acrichto> bpicolo: just for closures in general, the lifetime bound on the environment
[02:57:11] <bpicolo> acrichto:  Ah okay : )
[02:57:22] *** Quits: guest22221 (guest2222@D0C70673.5D6710ED.284344F5.IP) (Ping timeout)
[02:57:36] *** Quits: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net) (Ping timeout)
[02:58:22] *** Quits: guest22222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Ping timeout)
[02:58:49] *** Quits: richo (richo@moz-E6FCD5A0.hsd1.ca.comcast.net) (Ping timeout)
[02:59:53] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:59:54] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[03:00:05] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:00:06] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:02:41] <fmtq> obviously rust should have stream operators.
[03:03:34] <bpicolo> "error: use of undeclared module `i32`" = |
[03:04:00] *** Joins: CodeWar (CodeWar@moz-29959790.hsd1.ca.comcast.net)
[03:04:14] <fmtq> on a serious note, why #[...] syntax?
[03:04:25] <fmtq> why not, for instance #...
[03:04:38] <CodeWar> Layman question, what is the concept of "copyless message passing" 
[03:04:39] *** Quits: Kazimuth (james@moz-1AB3D702.hfc.comcastbusiness.net) (Client exited)
[03:05:47] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:05:59] *** Quits: user (user@moz-6D27B7CC.nycmny.fios.verizon.net) (Ping timeout)
[03:08:10] *** Joins: guest2222 (guest2222@moz-D1ED408B.tmodns.net)
[03:08:26] *** Joins: guest22221 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[03:09:04] *** Joins: guest22222 (guest2222@F2BAB083.5D6710ED.284344F5.IP)
[03:09:40] <bpicolo> https://gist.github.com/bpicolo/0d2288901ef150392e79  should this be roughly valid?
[03:09:56] *** Quits: guest2222 (guest2222@moz-D1ED408B.tmodns.net) (Ping timeout)
[03:10:09] *** Quits: guest22221 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Ping timeout)
[03:10:29] *** Joins: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[03:10:44] <bpicolo> I guess the question is whether #[deriving] works on typedefs
[03:10:44] <bpicolo> heh
[03:10:51] <acrichto> bpicolo: #[deriving] doesn't work on typedefs
[03:10:54] <acrichto> only on structs/enums
[03:10:56] <bpicolo> ahh
[03:11:05] <acrichto> CodeWar: when you send a message, it doesn't have to copy the entire message
[03:11:09] <bpicolo> hm.
[03:11:10] <acrichto> it's just a shallow copy of the contents
[03:11:19] <acrichto> as in, if it's a pointer, you're just moving a word around
[03:11:35] <CodeWar> acrichto:got it 
[03:11:44] *** Quits: guest22222 (guest2222@F2BAB083.5D6710ED.284344F5.IP) (Ping timeout)
[03:12:12] <acrichto> fmtq: the syntax of attributes is a long long long bikeshed, I'd recommend taking a look at https://github.com/mozilla/rust/issues/2569 if you're interested
[03:12:24] <acrichto> in short, #[foo = "bar"] looks not so great without the brackets
[03:12:39] <fmtq> hilarious 
[03:12:43] *** Joins: guest22221 (guest2222@moz-44B4FF60.tmodns.net)
[03:12:50] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[03:12:51] *** Quits: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Connection reset by peer)
[03:13:10] *** Joins: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[03:13:14] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[03:13:25] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[03:13:32] <bpicolo> Is Self just a placeholder in trait definition and not useful in impl>?
[03:13:40] <cmr> bpicolo: correct
[03:13:46] *** Quits: wilmoore (wilmoore@moz-4EF3CEBC.hsd1.co.comcast.net) (Ping timeout)
[03:13:47] <bpicolo> Gotcha
[03:13:55] <bpicolo> I thought it was self referential in impl for some reason
[03:14:05] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:14:27] *** Quits: guest22221 (guest2222@moz-44B4FF60.tmodns.net) (Ping timeout)
[03:15:26] *** Joins: dotfelix (dotfelix@E7FE6683.829DBEF3.40E092AA.IP)
[03:15:41] *** Joins: koonchun (matti@moz-EE8B4D5A.bb.dnainternet.fi)
[03:16:42] *** Joins: sodaplayer (sodaplayer@B751F89E.92DA27D1.9510F13D.IP)
[03:17:11] *** Joins: user (user@moz-6D27B7CC.nycmny.fios.verizon.net)
[03:18:01] *** Joins: wilmoore (wilmoore@moz-4EF3CEBC.hsd1.co.comcast.net)
[03:18:37] *** Joins: ramitos (ramitos@moz-E0D0224E.rev.vodafone.pt)
[03:18:40] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[03:19:17] *** Quits: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Ping timeout)
[03:19:19] <alan_andrade> Hello Rusties. If my library is supposed to fail! when a specific file is not present, how can I test that it actually fails ?
[03:19:50] <mcpherrin> alan_andrade: #[should_fail] on a #[test]
[03:19:55] <mcpherrin> see  https://github.com/mozilla/rust/wiki/Doc-unit-testing
[03:20:02] <alan_andrade> you the man! thnks.
[03:20:18] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[03:20:59] <bpicolo> Should I be able to reimplement traits for typedefs?
[03:21:11] *** Quits: CodeWar (CodeWar@moz-29959790.hsd1.ca.comcast.net) (Quit: Lingo - http://www.lingoirc.com)
[03:21:18] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:21:19] <bpicolo> I'm getting conflicting implementation errors
[03:21:24] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Ping timeout)
[03:21:26] <mcpherrin> bpicolo: I don't think so, you need to make a new type
[03:21:41] <bpicolo> How do I do that?
[03:21:43] <bpicolo> > <
[03:21:48] <mcpherrin> one element struct
[03:22:06] <mcpherrin> struct NewType(OldType);
[03:22:18] <bpicolo> Ahhhhhhh
[03:22:37] *** Quits: lpy_ (lpy@207F51B2.F09091A8.1348A864.IP) (Client exited)
[03:22:47] *** Joins: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca)
[03:22:52] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[03:23:08] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[03:23:50] *** Joins: lpy_ (lpy@207F51B2.F09091A8.1348A864.IP)
[03:24:13] <bpicolo> mcpherrin:  It seems to not like typecasts that way, though ? https://gist.github.com/bpicolo/0d2288901ef150392e79
[03:24:48] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[03:25:06] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[03:25:19] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[03:26:08] <mcpherrin> bpicolo: no, you've got to use a pattern to extract it
[03:26:33] <mcpherrin> not 'as'
[03:26:35] *** Quits: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com) (Ping timeout)
[03:26:51] <mcpherrin> let smallint(x) = smallint(1i16);
[03:27:01] <bpicolo> Hm
[03:27:10] <bpicolo> So my new struct isn't considered a numeric type?
[03:27:12] <mcpherrin> no
[03:27:13] <bpicolo> by the compiler
[03:27:15] <bpicolo> gotcha
[03:28:31] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[03:28:37] <bpicolo> That's uglier then. = |
[03:29:05] <Rusky> you can impl num for it
[03:29:08] <bpicolo> Oh?
[03:29:36] <bpicolo> ah
[03:29:51] <bpicolo> Thanks Rusky : )
[03:29:56] *** Quits: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[03:30:01] *** Quits: exobit (foo@moz-90D1B547.nycmny.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:30:09] *** Joins: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net)
[03:30:13] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[03:30:39] *** Quits: ramitos (ramitos@moz-E0D0224E.rev.vodafone.pt) (Quit: Textual IRC Client: www.textualapp.com)
[03:31:07] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:31:21] *** Quits: lpy_ (lpy@207F51B2.F09091A8.1348A864.IP) (Client exited)
[03:31:31] <bpicolo> So I'd have to implement every function in Num for  let x: smallint = 16 be valid, for example?
[03:31:50] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[03:33:12] *** Joins: libfud (libfud@moz-73F272E4.res-cmts.eph2.ptd.net)
[03:33:14] *** Joins: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP)
[03:33:41] *** Quits: tikue (tkuehn@CB7FC854.FAD414BA.D74CC41D.IP) (Client exited)
[03:34:56] <seanmonstar> huon: does fn foo(f: &Foo) work with Rc? let f = Rc<myFoo>; foo(f)? 
[03:35:36] <seanmonstar> Er, Rc::new(myFoo) 
[03:35:41] *** Joins: tobytailor (tobytailor@moz-CBD810C7.hsd1.ca.comcast.net)
[03:35:56] <libfud> http://sprunge.us/AdFe
[03:36:09] <libfud> why is (found, index) = compare_chars() illegal
[03:37:01] <mcpherrin> seanmonstar: Dereferencing an Rc<T> gives you a &T
[03:37:56] <mcpherrin> libfud: Various ways of making that work have been proposed
[03:38:21] <mcpherrin> libfud: It can't work with exactly that syntax and keeping the grammar LL(k)
[03:39:03] <bpicolo> mcpherrin:  How would I do the inverse pattern extraction (smallint -> i16)
[03:39:08] *** Joins: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net)
[03:39:25] <mcpherrin> bpicolo: let smallint(variablename) = 
[03:39:27] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[03:40:02] <bpicolo> Ahh. 
[03:40:09] <bpicolo> So don't need the actual term i16 anywhere.
[03:40:21] <mcpherrin> right, that's implicit in the type of smallint
[03:40:29] <seanmonstar> Type inference at work
[03:40:41] <bpicolo> Type inference?
[03:40:56] <mcpherrin> you don't have to type out types most of the time 'cause they can be inferred
[03:41:04] <mcpherrin> that's how things like "let foo = functioncall(); works
[03:41:04] *** Quits: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com) (Ping timeout)
[03:41:11] <seanmonstar> A sufficiently smart compiler can correctly guess the type
[03:41:13] <bpicolo> Oh, yeah. : )
[03:41:19] <cmr> bpicolo: the compiler can figure out the type of variables based on its usages.
[03:41:19] <bpicolo> terminology is still not my strong pont.
[03:41:26] <cmr> https://en.wikipedia.org/wiki/Type_inference
[03:41:33] <bpicolo> In fact, rust related things are still not even close to my strong point, heh
[03:41:49] <bpicolo> Not that type inference is by any means unique here.
[03:43:15] <bpicolo> If I want to implement http://static.rust-lang.org/doc/master/std/num/trait.Num.html for a type
[03:43:26] <bpicolo> do I need to implement all those in separate trait impl boxes
[03:43:34] <bpicolo> or can I go impl Num for foo {.....all this }
[03:44:13] <cmr> all you need is `impl Num for Foo {}`
[03:44:21] <cmr> but Foo needs to implement *all* of those other traits as well.
[03:44:48] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[03:44:50] *** Quits: drawoc (drawoc@moz-BAC1D3AB.res-cmts.sesh.ptd.net) (Quit: WeeChat 0.4.3)
[03:45:01] <bpicolo> Do I need to explicitly put impl Eq {} impl Zero... inside impl Num{}? Or just all relevant functions?
[03:45:16] <cmr> none of it goes inside the `impl Num ...`
[03:45:24] <bpicolo> Oh.
[03:45:48] <bpicolo> So I write all those others and then impl Eq{} is sort of a noop?
[03:46:30] <cmr> `impl Num for Foo { }` adds no methods to the type, correct.
[03:46:47] <bpicolo> Ahhh
[03:46:52] <bpicolo> Thanks cmr : )
[03:47:08] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[03:47:37] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Client exited)
[03:47:42] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[03:47:51] *** Quits: klaus (koz@moz-4486E876.hsd1.wa.comcast.net) (Quit: klaus)
[03:47:58] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[03:49:44] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Ping timeout)
[03:51:11] *** Joins: generalelectrix (Mibbit@moz-18E22694.hsd1.ca.comcast.net)
[03:52:38] <generalelectrix> I wrote a bunch of code using Result<(),T> as I had a lot of operations that would either succeed and return confirmation or an error message payload.  But now I have to return Ok(()) instead of Ok.
[03:52:38] *** Joins: reedlepee (Mibbit@3E3094EC.34458CF2.CC1A2609.IP)
[03:53:07] <generalelectrix> Is there a way around this besides defining my own thing like a Result that just has the variants Err(T) and Ok?
[03:53:12] <cmr> generalelectrix: no
[03:53:24] <cmr> that you were allowed to return Ok was a bug.
[03:53:36] <generalelectrix> No I was never allowed to return Ok
[03:53:40] <generalelectrix> I just hadn't compiled anything yet
[03:53:43] <generalelectrix> :)
[03:53:46] <cmr> ah ok.
[03:53:50] <generalelectrix> thanks!
[03:54:01] *** Joins: mcmansion (Mibbit@moz-224CFB73.hsd1.or.comcast.net)
[03:54:02] *** Joins: aravindavk (aravinda@1835D1B2.1436F502.C28A6AA4.IP)
[03:54:10] <mcmansion> hello!
[03:54:31] <cmr> (there was a bug around not needing parens for certain enum variants in some contexts, thought that might have been it)
[03:54:48] <dsrx> ABC - Always Be Compiling
[03:56:08] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[03:56:28] *** Quits: reedlepee (Mibbit@3E3094EC.34458CF2.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:57:53] *** Joins: guest2222 (guest2222@671874CA.F299E8.284344F5.IP)
[03:57:57] <generalelectrix> dsrx: indeed.  also, always write code on a machine that has the compiler installed...
[03:58:03] <dsrx> haha
[03:58:13] <generalelectrix> got a lot of "work" done today
[03:58:24] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Quit: Leaving)
[03:59:46] <bpicolo> Is there something I can implement for struct smallint(i16); such that let x:smallint = 16 is valid?
[03:59:56] <bpicolo> let x:  smallint = 16;
[03:59:59] <bpicolo> thanks emoticons
[04:01:00] <bpicolo> is that numcast + primitive stuff?
[04:01:55] *** Quits: mcmansion (Mibbit@moz-224CFB73.hsd1.or.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[04:02:08] <cmr> no
[04:02:22] <cmr> there is nothing that will allow that.
[04:03:14] <bpicolo> Pity.
[04:03:39] <cmr> that feature would be "generic numeric literals"
[04:03:52] <bpicolo> And would probably be overly difficult and mostly useless. : )
[04:03:53] <cmr> which nobody has written an RFC for yet, or even thought through very far.
[04:04:50] <Rusky> why can I not call a trait function on a struct that implements that trait
[04:04:55] * o11c <3 UDLs in C++
[04:05:08] <benh> Maybe the trait is not in scope
[04:05:12] <o11c> Rusky: you have to `use path::to::Trait`
[04:05:16] <o11c> yes, this is dumb
[04:05:21] <Rusky> weird
[04:05:33] <bpicolo> I was confused by that quite recently
[04:05:34] <bpicolo> heh
[04:05:34] <benh> or it's a trait object and the method has a Self parameter or something
[04:05:35] <o11c> std::prelude does this for a lot of traits
[04:05:41] *** Quits: mno2 (mno2@E1E0A0A3.621D86F0.CFF65E33.IP) (Quit: mno2)
[04:05:43] <cmr> it's not dumb, it's the only way to sanely support extension methods.
[04:05:50] <o11c> sigh
[04:05:57] <ChrisMorgan> It's like that for a very good reason, though. The only thing that's dumb (i.e. unintelligent) about it is that the compiler makes no suggestions.
[04:05:58] <o11c> I've explained *exactly* how it could be fixed before
[04:06:02] <bpicolo> type.method?
[04:06:09] <bpicolo> as opposed to instanceoftype.method?
[04:06:11] <Rusky> it's just confusing when you literally wrote the trait and impl in the same file and module
[04:06:30] <o11c> which is *exactly* the condition I suggested for auto-importing the methods
[04:06:44] <cmr> eugh auto-importing is not sane
[04:06:48] <Rusky> it would be nice to have a suggestion to import when it's from another module
[04:07:53] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[04:08:17] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[04:08:32] <ChrisMorgan> That introduces another point of not being fully forwards compatible; if I introduce a trait elsewhere with a method `method` and implement it, and then you go and do much the same thing in the place of the original trait, all of a sudden it's broken. (This is already an issue with you introducing new methods in the default impl, so perhaps extending it to do more bad stuff wouldn't be quite so bad, relatively…)
[04:08:37] *** Quits: guest2222 (guest2222@671874CA.F299E8.284344F5.IP) (Ping timeout)
[04:09:36] <bpicolo> Can you match on typedefs?
[04:09:54] <cmr> bpicolo: no, what would you be matching on?
[04:09:56] <bpicolo> Like, say I have type x= foo, type y=foo. Are they distinguishable?
[04:09:57] <ChrisMorgan> bpicolo: what do you mean?
[04:09:58] <cmr> no.
[04:10:01] <bpicolo> =/
[04:10:04] <ChrisMorgan> They're just aliases.
[04:10:08] <cmr> typedefs do not create new types, it's a type alias.
[04:10:14] <cmr> they are essentially erased after typeck.
[04:10:14] <Rusky> bpicolo: use newtypes- struct X(foo)
[04:10:24] <cmr> well, before typeck.
[04:10:37] <bpicolo> Rusky: But then I can't have let x: x = 16 be valid ;_;
[04:10:46] <Rusky> let x = X(16)
[04:10:54] <Rusky> what do you need it for?
[04:11:08] <bpicolo> Uhhh
[04:11:17] <bpicolo> User friendliness in a statically typed oRM
[04:11:19] <bpicolo> = |
[04:11:23] *** Quits: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net) (Quit: Leaving.)
[04:11:36] <bpicolo> syntactic sugar.
[04:11:40] <Rusky> yeah
[04:11:51] <bpicolo> I'm trying to find the right set of tradeoffs atm
[04:12:14] <bpicolo> Because I hate myself so I usually write small ORMs to learn languages.
[04:12:17] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Ping timeout)
[04:12:25] <bpicolo> This one is an interesting challenge.
[04:12:29] *** Joins: richo (richo@moz-1C569BCA.hsd1.ca.comcast.net)
[04:12:50] <bpicolo> TypeId::of<typealias> doesn't work, on another note. Should it?
[04:12:54] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[04:12:55] *** Joins: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net)
[04:12:59] <bpicolo> if it's just an alias.
[04:13:00] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[04:13:01] <ChrisMorgan> bpicolo: a sensible ORM in Rust will require writing syntax extensions. Are you using that approach?
[04:13:41] <bpicolo> Oh yes, It's macro polluted
[04:13:44] <bpicolo> Or will be
[04:13:52] <bpicolo> Well, there's one key macro
[04:14:12] <cmr> bpicolo: it's TypeId::of::<type>
[04:14:33] <bpicolo> That's the one really cool part ChrisMorgan, I can wrap a struct with a macro to define everything I need : )
[04:14:47] <bpicolo> cmr: Right, but it doesn't work on a typedef
[04:14:52] <bpicolo> Is that intended?
[04:15:01] <cmr> rusti: type x = int; std::intrinsics::TypeId::of::<x>()
[04:15:02] -rusti- <anon>:11:9: 11:22 warning: type `x` should have a camel case identifier, #[warn(non_camel_case_types)] on by default
[04:15:02] -rusti- <anon>:11         type x = int; std::intrinsics::TypeId::of::<x>()
[04:15:02] -rusti-                   ^~~~~~~~~~~~~
[04:15:02] -rusti- TypeId { t: 4150853580804116396 }
[04:15:14] <cmr> rusti: type x = int; std::intrinsics::TypeId::of::<int>()
[04:15:15] -rusti- <anon>:11:9: 11:22 warning: type `x` should have a camel case identifier, #[warn(non_camel_case_types)] on by default
[04:15:15] -rusti- <anon>:11         type x = int; std::intrinsics::TypeId::of::<int>()
[04:15:15] -rusti-                   ^~~~~~~~~~~~~
[04:15:16] -rusti- TypeId { t: 4150853580804116396 }
[04:15:20] *** Joins: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[04:15:22] <ChrisMorgan> bpicolo: I'd be expecting to use attributes rather than macros for it, decorating a struct definition and defining various traits from it in that way.
[04:15:34] <cmr> rusti: type X = int; std::intrinsics::TypeId::of::<int>() == std::intrinsics::TypeId::of::<X>()
[04:15:35] -rusti- true
[04:15:42] <bpicolo> Hmm
[04:15:42] <cmr> bpicolo: that's how it should and does behave
[04:15:50] <cmr> X isn't a different type than `int`
[04:15:55] <cmr> it *is* `int`
[04:15:56] <bpicolo> oh cmr, I'm totally missing the ()
[04:15:59] <bpicolo> You're right
[04:15:59] <cmr> by a different name
[04:16:01] <bpicolo> : )
[04:16:44] <bpicolo> ChrisMorgan: What do you mean by attributes?
[04:16:55] <bpicolo> found em..
[04:16:59] <ChrisMorgan> bpicolo: #[deriving(Foo)] is an attribute
[04:17:02] <cmr> bpicolo: http://static.rust-lang.org/doc/master/rust.html#attributes
[04:17:29] *** Joins: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net)
[04:18:34] *** Joins: pongad (pongad@moz-7E8AAD2E.res.gatech.edu)
[04:19:17] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[04:19:43] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[04:20:20] *** Quits: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net) (Connection reset by peer)
[04:20:50] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[04:20:58] *** Joins: Savago (Savago@202BED95.35A5082B.B8C5454C.IP)
[04:21:10] *** Quits: Savago (Savago@202BED95.35A5082B.B8C5454C.IP) (Quit: Savago)
[04:22:34] *** Joins: SpaceManiac (Tad@moz-6D089998.dorm.utexas.edu)
[04:22:49] *** Joins: fournm (Aria@moz-ABB60BA0.austin.res.rr.com)
[04:24:09] *** Joins: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net)
[04:24:45] <ChrisMorgan> sfackler: have you started writing the writing-your-own-syntax-extensions guide yet?
[04:24:53] <libfud> so naive string search without -O takes 20 seconds for a benchmark I'm using
[04:24:59] *** Joins: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net)
[04:25:03] <libfud> and with it, takes ~1.5 seconds
[04:25:11] <Eridius> libfud: I assume you're searching more than 1 string?
[04:25:14] <libfud> another algo I wrote (I think it's KMP)
[04:25:16] <libfud> yes Eridius 
[04:25:19] <ChrisMorgan> bpicolo: are you familiar with Python?
[04:25:26] <bpicolo> ChrisMorgan:  Intimately
[04:25:27] <libfud> takes ~5 seconds without -O and ~.5 with it
[04:25:32] <libfud> http://sprunge.us/KOcd
[04:25:32] <Eridius> libfud: also, are you using iterators? I expect they don't get translated into a tight loop without -O
[04:25:33] <libfud> naive
[04:25:36] <libfud> http://sprunge.us/IhbP
[04:26:00] <cmr> libfud: poor performance without -O is to be expected.
[04:26:04] <ChrisMorgan> bpicolo: you can write syntax extensions to do with an attribute anything a decorator can do, and even beyond (e.g. add new code like #[deriving])
[04:26:13] <libfud> cmr: I wasn't expecting that crazy leap
[04:26:27] <Eridius> libfud: why not? optimizations make it, well, optimal
[04:26:31] <bpicolo> ChrisMorgan: I can't find anything about actually writing an attribute
[04:26:44] <cmr> bpicolo: there is no documentation for writing syntax extensions.
[04:26:46] <libfud> Eridius: in the past for other algos passing -O did not show that much of an improvement
[04:26:46] <cmr> bug sfackler
[04:26:47] <ChrisMorgan> bpicolo: pester sfackler who wrote the code that lets you *do* it.
[04:26:49] <bpicolo> And they still might not cover the use case
[04:26:49] <libfud> it was noticeable
[04:26:50] <cmr> sfackler: WRITE DOCS!
[04:26:52] <libfud> but not on that scale
[04:27:05] <bpicolo> sfackler:  Yeah sfackler, I'm trying to make an ORM for YOUR postgres, man : P
[04:27:15] <Eridius> libfud: incidentally, I think you're over-using owned values
[04:27:25] <Eridius> I highly doubt parse_string_to_chars needs a ~str, I expect it can live with a &str
[04:27:28] <bpicolo> ChrisMorgan:  I do think macros cover much of what I'm thinking about nicely, however
[04:27:41] <Eridius> similarly find_string's key can probably be &str, and data can probably be &[&str]
[04:28:12] <Eridius> compare_chars also doesn't need owned vectors
[04:28:49] <bpicolo> ChrisMorgan:  When you say ANYTHING, do you reckon @property would be implementable?
[04:28:52] <libfud> this is probably true, Eridius, I need to educate myself on pointers
[04:29:16] <ChrisMorgan> bpicolo: sorry, that's not to do with the power of decorators, that's to do with the power of descriptors.
[04:29:18] <libfud> I don't feel comfortable using them frequently,and I need to really learn it
[04:29:32] *** Quits: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[04:29:33] <bpicolo> ChrisMorgan:  You are right, I was mixing syntax
[04:29:44] <bpicolo> Too many @s
[04:29:52] <ChrisMorgan> No, you can't do things like properties in Rust ☹
[04:29:57] <Eridius> libfud: don't think about it as pointers, think about ~T as an owned value and &T as a borrowed value
[04:30:07] <bpicolo> ChrisMorgan:  Shame
[04:30:15] <Eridius> ChrisMorgan: what are properties?
[04:30:24] *** Quits: canhtak (canhtak@moz-9F7DB66C.wl.t.ulaval.ca) (Quit: canhtak)
[04:30:32] *** Quits: koonchun (matti@moz-EE8B4D5A.bb.dnainternet.fi) (Ping timeout)
[04:30:35] <bpicolo> They let you define extra side effects on variable setting /getting in python, basically
[04:30:39] <SpaceManiac> when obj.x is secretly obj.getX()
[04:30:46] <ChrisMorgan> Eridius: properties in Python are things where you can effectively call methods for getters and setters and dellers.
[04:30:50] <Eridius> bpicolo: oh. so `foo.bar = 3` might run code?
[04:30:53] <ChrisMorgan> Yep.
[04:30:53] <bpicolo> yep
[04:30:59] <bpicolo> Very awesome for many things
[04:31:00] <Eridius> yeah... Rust's not gonna have that ;)
[04:31:03] <bpicolo> Well
[04:31:08] *** Quits: zwarich (zwarich@A89ECEB1.A86FC3A7.DE9B45B6.IP) (Input/output error)
[04:31:08] <Yurume> in D?
[04:31:09] <Eridius> foo.setBar(3) is good enough
[04:31:12] <cmr> it hides complexity and overhead
[04:31:16] * ChrisMorgan still holds out hope for Rust getting something like it
[04:31:19] <bpicolo> We SHOULD get something similar with [ ] overload eventually
[04:31:22] <ChrisMorgan> cmr: what, like Deref?
[04:31:23] <bpicolo> on some types
[04:31:26] <ChrisMorgan> &c.
[04:31:31] <cmr> ChrisMorgan: precisely like deref!
[04:31:32] <ChrisMorgan> And operators like +?
[04:31:38] <cmr> yup.
[04:32:09] <bpicolo> But yeah, that's why I'm mostly theorycrafting for this atm
[04:32:14] <Eridius> cmr: at least the lack of operator= overloading means that you can't use deref to do nasty tricks like return a struct that implements operator= to run code on value assignment ;)
[04:32:19] <bpicolo> There's a massive set of available tradeoffs
[04:32:21] <bpicolo> =/
[04:32:48] *** Joins: zwarich (zwarich@A89ECEB1.A86FC3A7.DE9B45B6.IP)
[04:32:50] <ChrisMorgan> .NET does properties well; they're simply syntax sugar in C# and VB.NET for GetX and SetX methods.
[04:33:17] <Yurume> ChrisMorgan: does it indeed delegate to GetX/SetX?
[04:33:24] <frozendevil> properties resolving to method calls is a pretty big headache in obj-c
[04:33:36] <ChrisMorgan> Yurume: a simple decompilation will indeed yield GetX and SetX method calls.
[04:33:40] <Yurume> oh
[04:33:41] <bpicolo> It's super handy for setting things as dirty though 
[04:33:45] <Eridius> frozendevil: it is?
[04:33:46] <bpicolo> : )
[04:33:49] *** Quits: user (user@moz-6D27B7CC.nycmny.fios.verizon.net) (Quit: leaving)
[04:34:14] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[04:34:21] <frozendevil> Eridius: mostly in terms of maintenance (read: @{}.mutableCopy)
[04:34:27] <Yurume> properties beside, I also have a concern about naming accessors...
[04:34:32] <Eridius> frozendevil: that's not a property! >_<
[04:34:40] <frozendevil> exactly :P
[04:34:48] <ChrisMorgan> Eridius: properties are just *so* useful for making code look nicer that I reckon a better than even chance of Rust's eventually getting them. Certainly not before 1.0, maybe not in 2.0, but eventually.
[04:34:57] *** Quits: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP) (Quit: colinsurprenant)
[04:34:58] <bpicolo> ^
[04:35:10] <Eridius> frozendevil: clang allowing you to use property call syntax for non-properties is quite annoying, but it's not really an actual problem, it just offends my sensibilities
[04:35:23] <bpicolo> Let's be honest, ORMs are 90% syntactic sugar
[04:35:36] <Eridius> ChrisMorgan: it looks nicer, but again, that comes at the cost of hidden complexity
[04:35:44] <frozendevil> also the warring factions of "only use selectors" vs "only use dot syntax" has made it difficult to effectively search some projects
[04:35:50] <ChrisMorgan> Eridius: sure. But there will always be hidden complexity.
[04:35:59] <ChrisMorgan> Even in machine code!
[04:36:09] <Yurume> random access memory? absurd!
[04:36:27] <bpicolo> yurume: How do you even get the right memory if it's random? No way that works.
[04:36:29] <Yurume> random accessible temporally sequential memory? :)
[04:36:36] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:37:16] <ChrisMorgan> bpicolo: "random access" means that you can access a random address in constant time.
[04:37:24] <bpicolo> ChrisMorgan:  I was being sarcastic
[04:37:26] <bpicolo> : P
[04:37:29] <Eridius> ChrisMorgan: now I'm wondering if it makes sense to add properties, just using different syntax than dot
[04:37:50] <Eridius> e.g. syntactical convenience but with the indicator that it's actually a property
[04:37:51] <ChrisMorgan> Eridius: that's one direction I've thought of.
[04:37:52] <cmr> sure, let's use the well-known "method invocation" syntax
[04:37:56] <Eridius> foo.@bar or somesuch (since we're giving up @)
[04:37:58] <cmr> :p
[04:37:58] <Eridius> cmr: :P
[04:38:04] <Yurume> Eridius: I'm actually thinking about ditching fields...
[04:38:16] <Eridius> Yurume: then how do you access data in a struct?
[04:38:20] <ChrisMorgan> cmr: what, like foo.bar() as a getter and foo.bar(Bar) as a setter?
[04:38:22] <bpicolo> I do wish I could call structs by string keys, Imma be honest
[04:38:42] <Eridius> ChrisMorgan: I think he just means foo.bar() and foo.setBar()
[04:38:45] <cmr> bpicolo: that's never efficient.
[04:38:49] <bpicolo> cmr: I agree
[04:38:52] <cmr> ChrisMorgan: what Eridius said
[04:38:59] <Yurume> Eridius: auto-generated accessors? (no, I'm kidding about it, I really meant ditching the public exposure of such fields.)
[04:39:06] <bpicolo> But like I said, orm's are 90% syntactic sugar!
[04:39:09] <ChrisMorgan> Eridius: but that's introducing genuine changes! the word "set"!
[04:39:14] <Eridius> Yurume: good news, struct fields are now private by default!
[04:39:19] <Yurume> yeah, I like it
[04:39:34] <Yurume> so the whole point of properties is making the accessor methods look like field accesses
[04:39:35] *** Quits: osa1 (omer@8543F1FD.A03A67DC.4329AE1A.IP) (Ping timeout)
[04:39:39] <bpicolo> yes
[04:39:41] <Yurume> and it is good for the forward compatibility
[04:39:42] * ChrisMorgan needs to get round to fixing up url and rust-http
[04:39:46] <Eridius> the downside is struct destructuring is gonna need field access, so just enforcing a policy of strictly private fields can get in the way of legitimate operations
[04:39:53] <Yurume> (when you originally had a field and now need it to be an accessor)
[04:40:09] <Eridius> Yurume: if you're worried about forward compatibility, just use properties everywhere instead of fields
[04:40:31] <Yurume> Eridius: yeah, I do it a lot.
[04:40:43] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Ping timeout)
[04:40:50] <Yurume> (except for enums, for the natural reason)
[04:40:55] <ChrisMorgan> #[deriving(properties)]
[04:40:56] <frozendevil> Eridius: it just seems like the kind of thing where if you can eliminate a "bad" option, you're better off for it. It just creates unneeded confusion esp. for newcomers. (e.x. the warning for "foo.copy = bar" is "no method 'setCopy' implemented" not "'copy' isn't a property", which is possibly more of a clang issue so I'm not sure how it fits into this conversation)
[04:40:56] <cmr> if you're worried about forward compatability, you need to be using trait objects anyway
[04:41:01] <Yurume> cmr: ;)
[04:41:02] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[04:41:05] <Eridius> Yurume: at the moment you actually can have private enum variants ;)
[04:41:10] <cmr> since otherwise you don't get ABI compat
[04:41:13] <Eridius> (although that may go away since it's not very useful)
[04:41:39] <Yurume> cmr: not relevant for source-level compatibility though.
[04:41:44] <cmr> indeed not
[04:41:45] <Eridius> frozendevil: I filed a radar a while ago asking for a compiler warning (preferably on by default) when using dot-syntax for non-properties
[04:41:51] <Eridius> frozendevil: I encourage you to file one too if you haven't already
[04:41:59] <frozendevil> not a bad idea
[04:42:10] *** Joins: quaddle (Mibbit@moz-2C53377F.natpool.nyu.edu)
[04:42:50] <Yurume> anyway, I feel the struct fields are at the unique position, and should be used with care for the public interface.
[04:43:28] <libfud> http://sprunge.us/gPQI
[04:43:30] <libfud> wait a second
[04:43:31] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[04:43:36] <Yurume> much like `public` fields in the C++ struct/class...
[04:43:41] <Eridius> Yurume: struct fields are just as much public API as public methods are
[04:43:42] <libfud> I think I've been doing an extremely unnecessary step
[04:43:45] <Eridius> *public struct fields
[04:43:50] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[04:44:02] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[04:44:04] <Eridius> libfud: which step?
[04:44:04] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[04:44:07] <libfud> I wrote parse_string_to_chars for a particular reason that I can't quite recall right now
[04:44:15] <libfud> but in compare_chars
[04:44:35] <libfud> why not directly compare the u8s in the string's index?
[04:44:37] <Yurume> libfud: I think you can simply convert &str into &[u8] (`.as_bytes()`)
[04:44:39] <Eridius> incidentally, parse_string_to_chars(s), if it does what I'm guessing it does, is equivalent to s.chars().to_owned_vec()
[04:44:44] *** Quits: quaddle (Mibbit@moz-2C53377F.natpool.nyu.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[04:44:51] *** Joins: dpc (Mibbit@3CA2DD5F.FAD414BA.D74CC41D.IP)
[04:45:14] <dpc> How can I have mutable aliases?
[04:45:14] <Eridius> libfud: comparing the strings as byte vectors should work fine, the only potential complication is the index at which it differs may point into the middle of a character
[04:45:15] <libfud> Eridius: just about
[04:45:17] <Yurume> valid UTF-8 sequences do not overlap with other sequences, so it should be safe
[04:45:33] <libfud> yeah
[04:45:34] <Eridius> there should be an appropriate string method you can use to back that up to the most recent character boundary, if it even matters
[04:45:40] <Eridius> dpc: you can't
[04:45:45] <Eridius> dpc: &mut very explicitly cannot alias with anything
[04:45:56] <Eridius> (well, anything that borrowck allows you to access)
[04:45:57] <Yurume> Eridius: if there *were* a match, then the match should be on the character boundary anyway, isn't it?
[04:46:16] <Eridius> Yurume: it returns the index at which it doesn't match
[04:46:16] <dpc> I have a Game class that manages Creature objects, and I just need to let Creature do some stuff here and there inside the map ...
[04:46:26] <Eridius> Yurume: that could be in the middle of a multi-byte character
[04:46:27] <Yurume> oh?
[04:46:59] <Yurume> I thought that was a potential replacement for `find_str` method (IIRC)
[04:47:11] <Eridius> dpc: presumably the Creature only does stuff when you call a method on it telling it to do stuff, yeah? Just pass the map to the Creature instead of giving each Creature a permanent reference to it
[04:47:15] *** Quits: tboyt (sid23344@moz-5F4AA75A.irccloud.com) (Ping timeout)
[04:47:24] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Quit: Leaving)
[04:47:30] *** Joins: tboyt (sid23344@moz-5F4AA75A.irccloud.com)
[04:47:31] <libfud> for the time being I'm just using ascii which is safe in this context
[04:47:46] <libfud> but if you feed it some indian or uh
[04:47:47] <libfud> japanese?
[04:47:49] <libfud> characters
[04:47:49] <dpc> Eridius: but then aliasing happens.
[04:47:55] <libfud> trying to remember the multibyte ones
[04:48:18] <dpc> Eridius: I'm passing mutable reference to Creature (&mut self) and the map itself that is also mutable.
[04:48:18] <Eridius> dpc: why? If you call Creature.doSomething(map) and it modifies the map and then returns, it no longer has a reference to the map
[04:48:26] <Eridius> dpc: at which point you can say anotherCreature.doSomething(map)
[04:48:27] <ChrisMorgan> libfud: beyond ASCII, *everything* is multibyte in UTF-8.
[04:48:50] <libfud> oh
[04:48:52] <Eridius> libfud: what if I give it ☃
[04:49:05] <libfud> how often do you have that in text files?
[04:49:08] <libfud> but point taken
[04:49:15] <libfud> oh right, web
[04:49:21] <Eridius> I put it in every single file I touch!
[04:49:22] <dpc> Eridius: The problem is the Creature is sitting on a list owned by Game and might need to modify other creatures (like call creature.was_hit()) or something.
[04:49:26] <Eridius> along with 💩
[04:49:32] <libfud> but touch creates an empty file!
[04:49:36] <Eridius> (which I hope came out right; I can't view it because mosh doesn't know the width of that char :/)
[04:49:44] <libfud> no need for such foul language
[04:49:54] <libfud> mosh?
[04:50:00] <libfud> irc client?
[04:50:03] <bpicolo> Eridius:  Snow men are important I can't blame you
[04:50:04] <Eridius> http://mosh.mit.edu
[04:50:05] <dpc> mosh is better ssh
[04:50:12] <Yurume> Eridius: it is much like a naive Windows user who put BOM to every single file one touch :p
[04:50:14] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[04:50:19] <Eridius> aw man, http://☃.com is now a parked page!
[04:50:20] <dpc> Cool stuff, I wish it was IPv6 ready.
[04:50:21] <Yurume> UTF-8 BOM, that is
[04:50:32] <Eridius> Yurume: ugh
[04:50:45] <Eridius> UTF-8 doesn't even HAVE a BOM! Fucking Windows editors being fucking stupid >_<
[04:50:50] *** Joins: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net)
[04:50:51] <Yurume> and eventually he/she breaks PHP
[04:51:05] <AlexMax> who actually ADDS that thing to a file
[04:51:11] <AlexMax> what editors actually do that?
[04:51:44] <Eridius> the BOM is really just zero-width non-breaking space. A UTF-8 file with a BOM is really just a UTF-8 file with a pointless character at the beginning
[04:51:47] <syatchmenoff> how do you get ~[] from Vec?
[04:52:10] <cmr> syatchmenoff: .move_iter().collect()
[04:52:17] <libfud> ~str does not implement shift
[04:52:18] <Eridius> AlexMax: World of Warcraft addons very frequently have the damn things in their .lua files, because of stupid Windows editors. Blizzard actually had to explicitly strip it out before loading the .lua files (and I know that because stock lua complains about it)
[04:52:20] <libfud> probably shift char then
[04:52:29] <syatchmenoff> cmr: thanks!
[04:52:30] <dpc> I'm puzzled how to deal with this aliasing stuff ... :/
[04:52:32] <Yurume> Eridius: I think U+FEFF ZERO WIDTH NO-BREAK SPACE indeed has an alias in Unicode
[04:52:41] <AlexMax> what bad editors actually do that
[04:52:42] <Eridius> Yurume: what do you mean, an alias?
[04:52:49] <Eridius> AlexMax: I have no idea. But it's always Windows users who produce these files
[04:53:05] <Yurume> Eridius: Unicode has a set of informal and formal aliases in the assignment.
[04:53:22] <klutzy> there is "proper" zwnb space; u+feff is originally only for eof but it got semantic of zwnb later
[04:53:31] <Yurume> yeah
[04:53:36] <Eridius> Yurume: the NamesList for U+FEFF contains BYTE ORDER MARK (BOM)
[04:53:41] <Eridius> and ZWNBSP
[04:53:41] <klutzy> s/eof/bom/
[04:53:50] *** Quits: andrewd18 (andrew@moz-DAC9D29F.wi.res.rr.com) (Quit: Leaving.)
[04:54:00] <libfud> wow
[04:54:02] <libfud> wait
[04:54:11] <Yurume> Eridius: and NameAlias also contains BOM for U+FEFF.
[04:54:12] <libfud> damnit I just realized I don't quite have it right
[04:54:13] <Eridius> klutzy: it did? I thought it was always a ZWNBSP specifically so editors that don't check for a BOM will still render the document correctly
[04:54:17] <klutzy> so there exist two zwnbsp and unicode explicitly discourages bom one for zwnb usage
[04:54:28] <Yurume> AFAIK NameAlias is for formal aliases, NamesList is for informative aliases
[04:54:42] <libfud> anyway
[04:54:50] <klutzy> Eridius: as I remember, BOM had zwnbsp semantic at unicode 1.x~2.x
[04:54:53] <libfud> removing parse_string_to_chars immediately improved the speed
[04:54:57] <Yurume> the formal name of the character is fixed once it gets assigned, as per the Unicode stability policy
[04:55:00] <klutzy> ugh
[04:55:04] <libfud> also I guess it's at a different index because u8 vice char
[04:55:04] <klutzy> Eridius: had no such semantic*
[04:55:05] <libfud> hm
[04:55:05] <Yurume> hence the current name... :S
[04:55:13] <bpicolo> libfud:  Nice
[04:55:18] <Yurume> (they are known to have many typos indeed)
[04:55:39] <Eridius> dpc: if I understand it correctly, your fundamental problem is you need to borrow a Creature from your game state so you can call a method on it, but you also need to pass the same GameState back to the creature, and said GameState needs to be mutable?
[04:55:48] <ChrisMorgan> libfud: I use multibyte characters *extremely* commonly—there are three that I commonly use in this line… ☺
[04:55:54] <Eridius> dpc: and so the problem is your Creature borrow is also borrowing the GameState, which prevents you from mutating it
[04:56:05] <dpc> Eridius: Correct. Exactly this.
[04:56:24] <dpc> And this is kind of common problem, but usually I'm able to refactor easily.
[04:56:24] <bpicolo> I still think unicode snowman looks like snoo =/
[04:56:38] <dpc> But sometimes it seems just impossible.
[04:56:39] <Eridius> dpc: suggestion: Instead of a ~[Creature] (or whatever you have), use a ~[Option<Creature>]. Instead of borrowing the Creature, you should .take() it to remove it from the list entirely. You can then mutably borrow the GameState to pass it to the creature. When you're done, swap it back into the list
[04:56:46] <libfud> semantic errors
[04:56:54] <libfud> I see that ellipsis ChrisMorgan 
[04:57:18] <klutzy> bom is bomb.. poor editor adds it automatically then php developer complains he can't change content-header
[04:57:26] <ChrisMorgan> libfud: that's one, two to go ☺
[04:57:34] <dpc> Eridius: Is that the general strategy to deal with this?
[04:57:41] <Eridius> dpc: I don't know. I just came up with it right now
[04:57:44] <bpicolo> ChrisMorgan:  Big dash?
[04:57:45] <Eridius> I've never had to deal with this situation before
[04:57:55] <ChrisMorgan> bpicolo: yes, U+2014 EM DASH
[04:57:59] <bpicolo> : )
[04:57:59] <libfud> well I see that... diglet too
[04:58:01] <libfud> whatever it is
[04:58:07] <Eridius> dpc: incidentally, this completely rules out the creature recursively modifying itself (which is a good thing)
[04:58:12] <bpicolo> ChrisMorgan:  Very appropriate for the next 9 months or so
[04:58:21] <Eridius> I mean, it can modify itself directly, but not accidentally via finding itself again in the GameState
[04:58:29] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[04:58:32] <Yurume> klutzy: I think it is actually a fault of PHP?
[04:58:38] <libfud> http://sprunge.us/cCWJ
[04:58:42] <Eridius> libfud: U+263A WHITE SMILING FACE
[04:58:44] <Yurume> PHP the template system should be separate from PHP the language
[04:58:45] <Eridius> that's what he used
[04:58:48] <ChrisMorgan> Indeed.
[04:59:01] <Eridius> The only downside I see to using irssi in my Terminal is my key bindings for various unicode things don't work :'(
[04:59:02] <klutzy> Yurume: well for everything it's fault of php
[04:59:04] <Eridius> (╯°□°）╯︵ ┻━┻
[04:59:10] <libfud> oh
[04:59:16] <ChrisMorgan> Eridius: what your compose key doesn't work?
[04:59:18] <Eridius> I have to instead hit ⌥Space to fire up Alfred, do it there, copy it, and paste it into my Terminal
[04:59:20] <libfud> I think I found the semantic error
[04:59:27] <ChrisMorgan> Oh, a Mac. Hah.
[04:59:32] *** Quits: janra (Janus@1CDC5701.A48867D7.52E4E107.IP) (Ping timeout)
[04:59:38] <bpicolo> Don't you laugh at we mac plebs
[04:59:44] * ChrisMorgan points his nose upwards like a true Linux snob
[04:59:45] <Eridius> ChrisMorgan: besides the fact that I actually use ctrl-key bindings for funky unicode things, I also have Option mapped to the meta key in Terminal (because that's extremely useful for a lot of things)
[04:59:56] *** Quits: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net) (Client exited)
[05:00:03] <dpc> Eridius: I like you idea. I"ll try it. Thanks.
[05:00:10] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Ping timeout)
[05:00:17] *** Joins: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net)
[05:01:04] <Eridius> dpc: another option is to use Cell<Creature> instead of Option<Creature> and use .borrow() to borrow the creature (and .try_borrow() when the creature itself is then trying to inspect the creatures list, because you can't recursively borrow), but I think that's actually more work than using the Option
[05:01:24] *** Quits: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Ping timeout)
[05:01:42] <dpc> Oh, yeah. I don't understand what Cell is doing... I should read about it.
[05:02:03] *** Quits: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net) (Ping timeout)
[05:02:03] <Eridius> dpc: Cell is dynamic borrowing that the compiler can't check
[05:02:15] *** Quits: SpaceWizard (Apollo@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[05:02:19] <Eridius> dpc: it allows you to have a mutable value that's stored in an otherwise-immutable location
[05:02:31] <dpc> Eridius: So every time someone is borrowing it will be done in runtime to check if there's no aliasing?
[05:02:33] <Eridius> but if you violate the borrow rules it fail!()s (e.g. borrow() when there's an existing borrow())
[05:02:47] <cmr> that's RefCell, not Cell
[05:02:47] <Eridius> dpc: only with Cell. It basically keeps a reference count of how many existing borrow()s there are
[05:02:54] <Eridius> oops did I say Cell?
[05:02:55] <Eridius> I meant RefCell
[05:03:00] *** Joins: benjamin_ (benjamin@moz-3A224608.dip0.t-ipconnect.de)
[05:03:03] <cmr> Cell does no checking whatsoever
[05:03:06] <Eridius> Cell is just a mutable location that requires the data to be copyable, and it just copies in and out. No borrowing
[05:03:11] <Eridius> RefCell is the dynamic borrow checking
[05:03:28] <dpc> And I can do try_borrow on RefCell?
[05:03:33] <Eridius> borrow checking done by the compiler has zero runtime overhead. Borrow checking done by RefCell needs to keep at least a reference count around (I haven't looked at the actual implementation)
[05:03:42] <Eridius> dpc: yes. But I don't think that actually gives you any benefit over the Option<T> approach
[05:03:44] <dpc> So as the creature will never eg. attack itself, I can just use try_borrow.
[05:03:48] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: )
[05:04:03] <Eridius> the only benefit is you don't have to remember to swap the Creature back into the list when you're done with it, but that's not much of a problem
[05:04:50] <dpc> I don't grok Cell ... Is there any article somewhere about it?
[05:05:04] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:05:04] <Eridius> Cell or RefCell? Cell is a very simple API, seen at http://static.rust-lang.org/doc/master/std/cell/struct.Cell.html
[05:05:10] <dpc> I understand what you're saying, but I'd like to have a deep understanding.
[05:05:24] <Eridius> it has .get(), which returns a copy of the data in it, and .set(), which changes its copy of the data (such that a subsequent .get() returns a copy of that new data)
[05:05:39] <cmr> dpc: there isn't really anything deep about it.
[05:05:45] <cmr> if you look at the source it's not that much code.
[05:05:50] <Eridius> as you'll see the data must have the Copy bound, which means copying it only requires a memcpy()
[05:06:01] <dpc> So it's just like a ... simple cache or an overlay?
[05:06:07] <cmr> it's neither of those.
[05:06:23] <cmr> it allows mutating the contents of a type when you only have an immutable reference.
[05:06:47] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Quit: Leaving.)
[05:06:58] <bpicolo> that sounds like a description of a pointer
[05:07:01] <bpicolo> almost
[05:07:01] <bpicolo> heh
[05:07:08] *** Quits: dsrx (tom@8B9E623D.B2983DC1.5670445F.IP) (Ping timeout)
[05:07:33] *** Joins: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP)
[05:07:39] <dpc> Seems like a Cell is kind of like a typesystem fence for something ...
[05:07:42] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:07:50] <dpc> RefCell seems easy to understand. :D
[05:08:05] <Eridius> dpc: that's pretty much accurate
[05:08:10] <cmr> Cell is a zero-overhead RefCell
[05:08:12] *** Joins: astropirate (astropirat@moz-6D82BAA4.hsd1.co.comcast.net)
[05:08:16] <astropirate> Hello friends
[05:08:16] <Yurume> (and type-limited)
[05:08:19] <Yurume> hi!
[05:08:20] <cmr> but by that virtue can only be used for simple types (Copy)
[05:08:26] <Eridius> cmr: zero-overhead in that there's no dynamic borrowing, but it does require copying bits around
[05:08:39] <Eridius> cmr: if my type is a [u8, ..64000] then that's a wee bit of an overhead
[05:09:03] <cmr> Eridius: well that's not implicit with Cell, you can tell that by looking at the type signature
[05:09:36] <Eridius> cmr: true. I see the distinction you're making now, and I agree
[05:09:38] <Eridius> there's no hidden overhead
[05:09:56] *** Quits: fournm (Aria@moz-ABB60BA0.austin.res.rr.com) (Quit: Leaving)
[05:10:44] *** Joins: dsrx (tom@moz-691F2A52.crystae.net)
[05:10:50] *** Joins: p1start (rewi@moz-E7F3D014.org)
[05:11:11] <dpc> If I have a Vec<~T> now, and I want to wrap it in RefCell, should I have Vec<RefCell<~T>> ?
[05:11:46] <Eridius> if you want a vector of independently-borrowable elements, yes
[05:11:51] *** Joins: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP)
[05:11:55] <Eridius> if you want a vector that has to be borrowed in its entirety you'd do RefCell<Vec<~T>>
[05:12:05] *** Joins: mno2 (mno2@E1E0A0A3.621D86F0.CFF65E33.IP)
[05:12:14] *** Quits: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[05:12:46] *** Quits: bpicolo (Mibbit@moz-44D38470.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:12:55] *** Joins: synackse (jordyd@2D608993.77F880E0.D9401097.IP)
[05:13:02] * dpc now: http://i1.kym-cdn.com/photos/images/original/000/234/739/fa5.jpg
[05:13:19] <cmr> I feel like that all the time
[05:13:25] <libfud> :D
[05:13:26] <libfud> I got it
[05:13:45] <libfud> finally works properly 
[05:13:54] *** Quits: tobytailor (tobytailor@moz-CBD810C7.hsd1.ca.comcast.net) (Quit: tobytailor)
[05:14:15] <libfud> truly println is the best debugging tool
[05:14:27] <libfud> well, maybe strace, but I haven't learned how to use that very well yet
[05:15:05] *** Quits: lerc (quassel@moz-82B68322.telstraclear.net) (Ping timeout)
[05:16:01] *** Joins: user (user@moz-6D27B7CC.nycmny.fios.verizon.net)
[05:17:41] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:17:50] <dpc> What do I do with this Ref / RefMut etc. ?
[05:17:57] <cmr> dereference it.
[05:18:02] <cmr> it will be autoderef'd
[05:18:14] <cmr> they're just raii guards that decrement the borrow count
[05:18:20] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[05:19:01] *** Quits: synackse (jordyd@2D608993.77F880E0.D9401097.IP) (Input/output error)
[05:19:51] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[05:20:01] *** Joins: oxum (anonymous@F7DD905A.892E3CAA.520CDC98.IP)
[05:20:49] <pongad> If tests fail, `make check -j*` should still exit with non-zero right?
[05:22:27] <frozendevil> in sprocketnes there are a bunch of functions declared with the extra <AM:AddressingMode<M>> notation (e.g. fn sta<AM:AddressingMode<M>>(&mut self, am: AM) { … }) I think I understand that that means AM is a type that implements the AddressingMode trait, but where is M supposed to come from?
[05:22:45] <frozendevil> the other implementation of the same function just takes a ~str
[05:23:01] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[05:23:28] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[05:23:50] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[05:24:24] *** Parts: libfud (libfud@moz-73F272E4.res-cmts.eph2.ptd.net) ()
[05:24:36] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[05:24:43] <cmr> pongad: yes
[05:24:59] <cmr> frozendevil: it's like saying <A, AM: AddressingMode<M>>
[05:25:14] *** Joins: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de)
[05:25:16] <pongad> cmr: Alright, wanted to make sure, thanks :D
[05:25:35] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[05:25:42] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[05:26:04] *** Quits: generalelectrix (Mibbit@moz-18E22694.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:26:06] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Input/output error)
[05:26:14] <frozendevil> cmr: I'm not sure I follow
[05:26:18] <frozendevil> I guess I have more reading to do
[05:26:25] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[05:26:26] <dpc> failed to find an implementation of trait ai::Actor for ~ai::Actor<no-bounds>
[05:26:42] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[05:26:46] <cmr> dpc: correct, trait objects do not implement the trait itself.
[05:26:51] *** Joins: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net)
[05:27:04] <cmr> they can't, in general; methods that use the `Self` type can never work in a type-erased context.
[05:27:22] <dpc> But I got it from Cell:borrow()
[05:27:24] <cmr> I've heard pcwalton say he wants to change that so that trait objects that *can* implement the respective trait, do.
[05:27:28] <dpc> It was working before ...
[05:27:52] <dpc> I had ~Actor (that were real objects implementing Actor
[05:28:07] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[05:28:13] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Input/output error)
[05:28:17] <dpc> Now I wrapped Vec<~Actor> with Vec<RefCell<~Actor>>
[05:28:25] *** Joins: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca)
[05:28:27] <dpc> cr.borrow_mut().tick(&mut *self.map, &mut *actor.borrow_mut(), &self.player)
[05:28:34] <dpc> And I'm trying to get this to work.
[05:28:49] *** Quits: luz (lu.cy@moz-CD18B14B.customer.cdi.no) (Input/output error)
[05:28:59] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[05:29:01] *** Joins: luzie (lu.cy@moz-CD18B14B.customer.cdi.no)
[05:29:13] <dpc> How did I wronged the holy typesystem this time. :(
[05:29:24] <frozendevil> cmr: what is the 'A' in your example?
[05:29:32] <cmr> frozendevil: a type parameter with no bounds
[05:30:04] <Eridius> frozendevil: reading up, I assume the M was previously declared. It may have been declared on an enclosing item
[05:30:22] <iopq> what's correct syntax, [_, n ..rest] or [_, n, ..rest]
[05:30:24] <Eridius> e.g. impl<M> Foo<M> { ... fn bar<AM:AddressingMode<M>> { ... } }
[05:31:01] <frozendevil> ahh
[05:31:07] <frozendevil> ok, that would be it
[05:31:57] <Eridius> ah yeah, impl<M:Mem> Cpu<M>
[05:32:01] <homa_rano> is there any syntax to get the rust compiler to emit a jump table with fallthrough between elements?
[05:32:11] <dpc> Is CellRef loosing some information about ~? :/
[05:32:13] <Eridius> homa_rano: AFAIK, no
[05:32:14] <frozendevil> hm, it doesn't like that
[05:32:43] <Eridius> frozendevil: ?
[05:32:45] <homa_rano> Eridius: ok, I guess I'll write it in c...
[05:32:47] <Eridius> dpc: what do you mean?
[05:32:59] *** Joins: enos (jkingyens@moz-BE1786F9.mycingular.net)
[05:33:15] <frozendevil> Eridius: as a learning experiment I'm trying to convert the bit decode_op macro in sprocketnes to a trait
[05:33:22] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[05:33:32] <iopq> this doesn't compile for me: [_, n ..rest] => from_str::<int>(n).expect("I need a real number")
[05:33:46] <dpc> Eridius: What I get from RefCell.borrow_mut() does not seem to work .
[05:34:06] *** Quits: ebalint (ebalint@moz-BFA5E762.inf.u-szeged.hu) (Ping timeout)
[05:34:09] <dpc> failed to find an implementation of trait ai::Actor for ~ai::Actor<no-bounds>
[05:34:15] <Eridius> frozendevil: ah. I do recall when pcwalton gave his SprocketNes talk it did seem that decode_op could be done as non-macro without losing any performance (presumably as a trait, as you're trying to do)
[05:34:16] <dpc> Seems like it lost it's bounds...
[05:34:27] <Eridius> dpc: trait objects don't have bounds by default anymore
[05:34:28] <cmr> homa_rano: we emit the same thing as clang for our matches, when it's against a simple C-like enum.
[05:34:39] <Eridius> I think the printing of it as <no-bounds> is because they used to have Send by default and so having no bounds was special
[05:34:49] <Eridius> cmr: he wants fallthrough
[05:34:54] <frozendevil> so does the "impl<M:Mem + Save> Save for Cpu<M>" notation mean that it's an implementation of the save Save trait for a 'Cpu' that already implements 'Mem'?
[05:35:04] <cmr> Ok, sure.
[05:35:08] <dpc> cr.tick(&mut *self.map, *actor.borrow_mut(), &self.player); - this used to work
[05:35:11] <cmr> homa_rano: also we have no fallthrough anywhere
[05:35:21] <homa_rano> cmr: good to know
[05:35:24] <dpc> cr.borrow_mut().tick(&mut *self.map,  &mut *actor.borrow_mut(), &self.player); - this does not
[05:35:34] <Eridius> frozendevil: no, the Cpu doesn't implement Mem. M implements both Mem and Save
[05:35:54] <Eridius> frozendevil: or to rephrase, it's an implementation of Save for all Cpu<M> where M itself implements Mem and Save.
[05:36:24] <Eridius> dpc: what is the type signature of tick?
[05:36:43] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[05:36:44] <dpc>  pub fn tick(&mut self, map : &mut Map, actor : &mut ai::Actor, player : &Creature) { 
[05:36:51] *** Quits: dotfelix (dotfelix@E7FE6683.829DBEF3.40E092AA.IP) (Quit: )
[05:37:10] <Eridius> dpc: and the type signature of actor?
[05:37:15] <frozendevil> Eridius: how can M already implement Save when that's the declaration of the implementation of Save?
[05:37:35] <Eridius> frozendevil: traits can be implemented on multiple types
[05:37:44] <dpc>   pub trait Actor { .... }
[05:37:45] <frozendevil> right
[05:38:12] <Eridius> frozendevil: the only restriction is if a trait is implemented in terms of another trait (e.g. `impl<T: Save> Foo for T`), no other impls of the trait are allowed (to avoid potential conflicts where a type would meet the requirements of both impls)
[05:38:13] <frozendevil> I guess I'm unclear on the usefulness of this notation
[05:38:24] *** Joins: araujo (araujo@moz-E7587DBE.collabora.co.uk)
[05:38:43] <Eridius> frozendevil: if M implements both Mem and Save (and I assume the actual concrete type used to represent memory does), then a Cpu using M also implements Save
[05:39:42] <dsrx> frozendevil: that kind of thing is useful for like, impl<T: Show> Show for LinkedList<T>
[05:39:56] *** Quits: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net) (Quit: zztr)
[05:40:04] <frozendevil> where each of its elements needs Show?
[05:40:13] <Eridius> frozendevil: well, where its element type needs Show
[05:40:16] <frozendevil> right
[05:40:18] <frozendevil> ok
[05:40:40] <Eridius> so in the Cpu case, I assume Saving the Cpu involves Saving its memory as well, so the memory must implement Save
[05:40:49] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[05:40:54] <Eridius> so the Cpu Save impl can say something like self.mem().save() or whatever
[05:41:14] <frozendevil> that makes sense
[05:41:30] <dpc> Eridius: Any idea? :)
[05:41:38] <frozendevil> this is definitely going to take some acclimation
[05:42:29] *** Quits: heftig (heftig@moz-48B7D9BF.dip0.t-ipconnect.de) (Quit: Quitting)
[05:42:33] <Eridius> dpc: sorry, doing too much at once. What is the actual type of the actor variable? It can't be `pub trait Actor { ... }` because that's not a type, that's a trait definition
[05:43:07] <dpc>  for (cr, actor) in self.creatures.mut_iter().zip(self.actors.mut_iter()) {                                    
[05:43:35] <dpc> actor is Vec<RefCell<~Actor>>
[05:43:57] <iopq> how do I pattern match on a vector and the rest of its elements?
[05:44:08] <cmr> iopq: [a, b, ..rest]
[05:44:16] <iopq> [_, n, ..rest] => from_str::<int>(n).expect("I need a real number")
[05:44:16] <cmr> iopq: you can only match against slices and arrays, however
[05:44:21] <iopq> gives me some borrow check error
[05:44:57] *** Joins: edwardw (Mibbit@EE646FE3.EE06708D.4BFBD933.IP)
[05:45:11] <iopq> fizzbuzz.rs:45:7: 45:8 error: cannot move out of `args[..]` because it is borrowed
[05:45:25] <Eridius> dpc: tick needs a &mut Actor. actor.borrow_mut() is a RefMut<~Actor>. *actor.borrow_mut() is a ~Actor. &mut *actor.borrow_mut() is a &mut ~Actor
[05:45:33] <Eridius> dpc: try &mut **actor.borrow_mut()
[05:45:51] <Eridius> actually hrm, that's gonna not work right because that's the non-mutable deref
[05:45:58] <cmr> iopq: ah, `ref n`
[05:46:05] <cmr> perhaps
[05:46:24] <Eridius> dpc: I already hate myself for typing this, but try &mut **&mut actor.borrow_mut()
[05:46:26] <dpc> Eridius: error: type `~ai::Actor<no-bounds>` cannot be dereferenced
[05:46:35] <dpc> Eridius: Hahaha. Let's try. :D
[05:46:37] <Eridius> oh hrm, not sure if &mut *~Trait actually works
[05:46:46] <santiago> Is there more documentation on "procedural macros?" I can't seem to find it on the site. 
[05:46:49] <Eridius> dpc: I typod
[05:46:54] <Eridius> dpc: &mut **&mut *actor.borrow_mut()
[05:47:02] <dpc> error: failed to find an implementation of trait ai::Actor for ~ai::Actor<no-bounds>
[05:47:34] <iopq> cmr: fizzbuzz.rs:45:41: 45:42 error: mismatched types: expected `&str` but found `&~str` (expected &str but found &-ptr)
[05:47:49] <dpc> Eridius: I'm trying different version of this but non of these seem to change anything.
[05:48:01] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Quit: Leaving.)
[05:48:08] <Eridius> dpc: ok, ~Trait is supposed to coerce to &Trait
[05:48:15] <dpc> Eridius: I get previous one or type `~ai::Actor<no-bounds>` cannot be dereferenced
[05:48:44] <dpc> dpc: I had to use &mut *actor before (without RefCell) I belive.
[05:48:44] <Eridius> dpc: a mutable ~Actor should implicitly turn into a &mut Actor when necessary
[05:48:53] <dpc> Eridius: But yeah, it was coorced to &mut Actor
[05:49:41] * Eridius is testing some stuff to do with RefCell
[05:50:17] <dpc> cr.borrow_mut().tick(&mut *self.map, *actor.borrow_mut(), &self.player); -> annot borrow immutable dereference of `~`-pointer as mutable
[05:50:22] <dpc> This is surprising.
[05:50:43] *** Joins: daschl (Adium@CB401D19.ED8EB9E6.127DF16D.IP)
[05:51:01] <Eridius> dpc: I don't think implicit coercion is sufficient to trigger DerefMut instead of Deref
[05:51:08] <Eridius> dpc: it's probably worth filing a ticket about, because it honestly should work
[05:51:22] <Eridius> but the only two ways I know of to trigger DerefMut is with `*foo = bar` or `&mut *foo`
[05:51:49] <frozendevil> so if I just naively add <M:Mem> to my impl (not assuming it will necessarily behave appropriately) like "impl OpConsumer<M:Mem> for Cpu<M>" it errors and says "use of undeclared type name `M`" on the 'impl' line… how is it determining that?
[05:51:59] <Eridius> similarly, I think there's a ticket open saying that &*~Trait should work, which would let you explicitly say what you want to do
[05:52:23] <Eridius> frozendevil: impl<M:Mem> OpConsumer for Cpu<M>
[05:52:34] <Eridius> (I'm assuming OpConsumer isn't actually parameterized with M itself)
[05:52:35] <frozendevil> ah, buh
[05:52:41] <Eridius> if it is then impl<M:Mem> OpConsumer<M> for Cpu<M>
[05:52:42] <dpc> Eridius: So I'm out of luck with this? :)
[05:52:48] <Eridius> dpc: hold on, experimenting
[05:53:47] <iopq> fixed it, this works: [_, ref n, ..] => from_str::<int>(*n).expect("I need a real number"),
[05:53:53] <iopq> thanks cmr
[05:54:06] <dpc> &mut *actor.borrow_mut() seems to be working fine, but this <no-bounds> seems to be working me.
[05:54:21] <Eridius> dpc: ignore the <no-bounds>
[05:54:37] <Eridius> it's just a quirk of how trait object types are printed right now
[05:54:47] *** Quits: brandon (brandon@moz-C052BBCD.nat.asu.edu) (Quit: WeeChat 0.4.3)
[05:55:06] <Eridius> dpc: &mut *actor.borrow_mut() should give you a &mut ~Actor, I thought. But maybe that implicitly coerces to &mut Actor?
[05:56:06] <Eridius> dpc: nope, in my test that gives the "failed to find an implementation of trait Foo for ~Foo"
[05:56:24] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:56:39] *** Quits: maxli (Adium@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[05:56:49] *** Joins: ahunt (ahunt@moz-6D6D79D6.cable.virginm.net)
[05:57:06] <dpc> Same here.
[05:57:06] *** Quits: SpaceManiac (Tad@moz-6D089998.dorm.utexas.edu) (Ping timeout)
[05:57:10] <Eridius> dpc: *&mut *actor.borrow_mut()
[05:57:17] <Eridius> :D
[05:57:46] <dpc> Eridius: You did it! :D
[05:57:57] <Eridius> actor.borrow_mut() is RefMut<~Actor>. &mut *actor.borrow_mut() is &mut ~Actor. *&mut *actor.borrow_mut() is a mutable ~Actor that can be implicitly coerced to &mut Actor
[05:57:59] <dpc> Why does it work? :D
[05:58:40] <dpc> I've read this line 3 times and I don't understand. :D
[05:58:42] <Eridius> the two weird parts here are 1) DerefMut requires &mut * to actually work, otherwise you get the immutable deref, and 2) ~Trait can only be coerced to &Trait implicitly, not explicitly
[05:59:00] <dpc> Ah. I see.
[05:59:03] <dpc> That makes sense now.
[05:59:04] <Eridius> if you just needed &Actor you'd do *foo.borrow_mut() (well, *foo.borrow())
[05:59:09] <o11c> trying to make my ~s turn into &s is always annoying
[05:59:10] <Eridius> because that gives you an ~Actor that gets implicitly coerced
[05:59:18] <dpc> Do you have the example code?
[05:59:26] <Eridius> but you need &mut Actor, and *foo.borrow_mut() is an immutable value, not a mutable one
[05:59:41] <Eridius> https://gist.github.com/kballard/9968948
[06:00:07] <Eridius> So basically the trick here is getting a value of the type ~Actor that is also mutable
[06:00:35] <Eridius> so you have to trigger DerefMut, by using &mut *actor.borrow_mut(). This leaves you with a mutable reference, which you then dereference to get a mutable value
[06:00:43] <Eridius> and that can then implicitly coerce
[06:01:02] <dpc> O_o
[06:01:16] <dpc> I keep hitting problems like this every time I'm doing something. :D
[06:01:35] <dpc> Ha. Now, I need to fix the function with a lifetimes ...
[06:01:37] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[06:01:40] <Eridius> every time? wow, bad luck. You just happened to stumble across a nasty corner of the language
[06:01:40] <dpc> Similiar problem. :D
[06:01:50] <dpc> I should be a beta tester. :D
[06:01:54] <Eridius> for all I know you're the first person to try to use &mut Trait objects in conjunction with DerefMut ;)
[06:02:15] *** Tomcat|afk is now known as Tomcat
[06:03:04] <cmr> probably are
[06:03:16] * cmr blames eddyb
[06:04:18] *** Quits: enos (jkingyens@moz-BE1786F9.mycingular.net) (Quit: enos)
[06:04:37] *** Quits: ehsanul (harish@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[06:04:52] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[06:04:57] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[06:04:59] <Eridius> I just filed a ticket as https://github.com/mozilla/rust/issues/13305
[06:05:08] * edwardw sends bunch of DerefMut's after eddyb.
[06:05:27] <eddyb> DerefMut with Trait? you need to wait for DST
[06:05:42] <frozendevil> ok, new strange thing that I don't know the proper incantation to google. The trait is "pub trait OpConsumer { … }" I'm implementing it as "impl OpConsumer for Disassembler { … }" and I get errors about "0 instead of 1" lifetime parameters and type arguments
[06:05:56] <Eridius> eddyb: I'm not sure how DST applies. The problem here is the rules for when DerefMut is used vs Deref
[06:06:15] <eddyb> frozendevil: Disassembler has lifetime parameters, I bet
[06:06:19] <cmr> eddyb: it's for a trait object.
[06:06:30] <cmr> not a trait itself.
[06:07:02] <frozendevil> ah, you can't just implement it on raw 'Disassembler' even if it doesn't use the parameters?
[06:07:13] <Eridius> frozendevil: Disassembler has both a lifetime parameter and a type argument
[06:07:36] <eddyb> cr.borrow_mut().tick(&mut *self.map, *actor.borrow_mut(), &self.player);
[06:07:52] <Eridius> frozendevil: you can't implement it on Disassembler because each possible concrete Disassembler type will need its own monomorphization of the trait functions
[06:08:02] <frozendevil> makes sense
[06:08:10] <Eridius> so you need to parameterize the trait impl even if you truly don't care what the parameter is
[06:08:13] <eddyb> dpc: you expected ~Trait to coerce to &mut Trait?
[06:08:31] <Eridius> eddyb: it should. It can if the value is mutable
[06:08:38] <eddyb> but that coercion is a hack
[06:08:54] <eddyb> making it work requires more hacks
[06:08:54] <Eridius> eddyb: that's why *&mut *actor.borrow_mut() works. It evaluates to the same ~Trait type but it ensures DerefMut is invoked
[06:09:04] <dpc> Eridius: https://github.com/mozilla/rust/issues/13307
[06:09:07] <Eridius> eddyb: unfortunately it's the only way to go from ~Trait to &Trait AFAIK
[06:09:29] <Eridius> dpc: augh I already filed that as https://github.com/mozilla/rust/issues/13305 a few minutes ago
[06:09:31] <eddyb> yay we have dupes
[06:09:40] <dpc> :( :D
[06:09:42] *** Joins: rootnode_ (rootnode@moz-50470F7D.pools.arcor-ip.net)
[06:10:18] *** Quits: rootnode (rootnode@moz-50470F7D.pools.arcor-ip.net) (Ping timeout)
[06:10:18] <eddyb> Eridius: ~T -> &T / &mut T (and the same with traits and [T]/str) is a hack
[06:10:20] *** Quits: rootnode_ (rootnode@moz-50470F7D.pools.arcor-ip.net) (Connection reset by peer)
[06:10:31] *** Joins: rootnode_ (rootnode@moz-50470F7D.pools.arcor-ip.net)
[06:10:40] <eddyb> Eridius: DST will solve this by allowing &mut **actor.borrow_mut()
[06:10:52] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[06:10:54] <Eridius> eddyb: will that invoke DerefMut properly?
[06:10:56] *** Joins: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net)
[06:10:58] <eddyb> Eridius: yes
[06:10:59] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: hoverbear)
[06:11:14] <eddyb> Eridius: &mut propagates the hint through multiple derefs
[06:11:20] <eddyb> (or a single star, if you have something like Rc<RefMut<Trait>>)
[06:11:24] <Eridius> oh nice
[06:11:39] <Eridius> can you comment to that effect on #13305, but leave the issue open to be verified after DST lands?
[06:11:44] <eddyb> after DST we can consider removing ~T -> &T/&mut T coercions
[06:12:03] *** Joins: rootnode__ (rootnode@moz-50470F7D.pools.arcor-ip.net)
[06:12:35] *** Quits: edwardw (Mibbit@EE646FE3.EE06708D.4BFBD933.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:12:39] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:12:40] *** Quits: jvoorhis (jvoorhis@moz-384E18AD.ptld.qwest.net) (Ping timeout)
[06:12:48] *** Quits: rootnode_ (rootnode@moz-50470F7D.pools.arcor-ip.net) (Ping timeout)
[06:12:55] *** Joins: onelson (owen@18CF7301.95770028.5B6BFE7D.IP)
[06:13:08] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:13:08] <Eridius> eddyb: I'd be in favor of removing ~T -> &T once we can say &*T
[06:13:16] <dpc> http://pastebin.com/N093CDRi So now this thing. :D
[06:13:26] <eddyb> Eridius: for T = Trait and T = [U], right?
[06:13:31] <Eridius> yes
[06:13:32] <eddyb> well, T: Unsized I mean
[06:15:01] <frozendevil> ah, well, I see now why he just used a macro
[06:15:12] <Eridius> frozendevil: oh?
[06:15:16] <Eridius> dpc: hmm
[06:15:23] <carllerche> there is no way to make a fn be callable by both mut and immutable variants of a type? The only way is to make a _mut version of the fn?
[06:15:24] <frozendevil> the return types
[06:15:39] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:15:42] <frozendevil> the disasembler returns a formatted string for logging, it doesn't just log
[06:15:52] <Eridius> carllerche: a method? if the method takes &self you can call it on a mutable variant
[06:15:56] <frozendevil> from all of the op methods
[06:16:03] <Eridius> carllerche: it's only if you need the method to behave differently depending on whether self is mutable, that you need separate methods
[06:16:20] <cmr> But for *functions* it can't do both.
[06:16:26] <frozendevil> the cpu either returns () or meaningful things
[06:16:32] <carllerche> Eridius: I am getting `error: cannot borrow `tracer` as immutable because it is also borrowed as mutable`
[06:16:40] <eddyb> carllerche: that's something else
[06:16:50] <eddyb> carllerche: can you show us that line?
[06:16:51] *** Joins: jackneill (jackneill@moz-9957FB4C.pool.digikabel.hu)
[06:16:57] <ctangent> hi all... i just wanted to say that I started a project in rust today and it's been an absolute joy so far :)
[06:16:59] <eddyb> it's likely the nested method call issue
[06:17:00] <cmr> I would think it'd be able to freeze it most of the time, perhaps not
[06:17:00] <Eridius> carllerche: you're trying to re-use tracer when you have an active &mut borrow
[06:17:05] <cmr> ctangent: that wears off ;p
[06:17:07] <Eridius> carllerche: you need to use that &mut borrow to produce the immutable & borrow
[06:17:09] <ctangent> hehe :)
[06:17:09] <carllerche> Eridius: Yeah, I am i guess
[06:17:14] <Eridius> carllerche: e.g. you need to re-borrow the &mut, not the original value
[06:17:22] <ctangent> i'm writing an interpreter and match has been awesome
[06:17:25] <eddyb> carllerche: are you doing foo.bar(foo.baz())?
[06:17:40] <Eridius> frozendevil: not sure what you mean. Can you point to an example?
[06:17:52] *** Joins: koonchun (matti@moz-EE8B4D5A.bb.dnainternet.fi)
[06:17:55] <carllerche> eddyb: https://gist.github.com/carllerche/afc97b2a9880f31ddc7f#file-my-rs-L9
[06:17:58] *** Joins: enos (jkingyens@moz-7A8F6201.hsd1.ca.comcast.net)
[06:18:13] <Eridius> carllerche: I assume tracer.start_span() borrows tracer?
[06:18:38] <Eridius> fn start_span<'a>(&'a mut self, x: int, s: &str) -> Span<'a> or somesuch
[06:18:42] <eddyb> carllerche: ah, nevermind me, not the same issue
[06:18:44] <carllerche> Eridius: it does, but it shouldn't "retain" the borrow after the fn returns
[06:18:52] *** Joins: edwardw (Mibbit@A8F743D9.7FBBB51F.BE7924BA.IP)
[06:19:01] <Eridius> carllerche: the return type must include the same lifetime, which keeps the borrow active
[06:19:01] <frozendevil> Eridius: CPU: "fn indirect_indexed_y(&mut self) -> MemoryAddressingMode", Disassembler "fn indirect_indexed_y(&mut self) -> ~str" 
[06:19:03] <eddyb> carllerche: you can wrap the lines using span in a block
[06:19:08] <Eridius> the borrow is tied to the lifetime, not the actual reference
[06:19:11] *** kimundi is now known as zz_kimundi
[06:19:23] <Eridius> carllerche: you need to restrict the lifetime of the borrow by giving it its own scope, as eddyb said
[06:19:26] <carllerche> Eridius: it does, but the return isn't used
[06:19:48] <carllerche> i guess the fact that the return isn't used tripped me up… since it seems safe to me :)
[06:19:51] <Eridius> ideally we'd have SSA for lifetimes eventually, which would let the borrow expire as soon as the value with the lifetime stops being used (as opposed to going out of scope), but who knows when that will ever be done
[06:20:01] <Eridius> carllerche: the return is span. you certainly are using it
[06:20:07] *** Quits: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:20:08] <carllerche> yep, wrapping it worked
[06:20:09] *** Quits: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de) (Input/output error)
[06:20:10] <eddyb> carllerche: the borrow checker is stricter than it could be
[06:20:27] <eddyb> hitting the "borrows shouldn't always be lexical" or whatever that name is
[06:20:28] <Eridius> frozendevil: do all methods in cpu that return MemoryAddressingMode return ~str in disasm?
[06:20:42] <Eridius> frozendevil: and conversely, all methods in disasm that return ~str return MemoryAddressingMode (or ~str) in cpu?
[06:20:42] <carllerche> Eridius: ah, i was thinking the return of the last fn before i borrow tracer again
[06:20:47] *** Tomcat is now known as Tomcat|sheriffduty
[06:20:51] <carllerche> eddyb: ok, got it
[06:20:53] <Eridius> carllerche: as long as span is in scope, tracer is considered to be borrowed
[06:21:05] <carllerche> I will remember scopes for the future
[06:22:05] <dpc> std::cell::Ref<,~map::Creature> , what up with this <, ?
[06:22:13] <Eridius> frozendevil: hmm, looks like it's not quite that simple
[06:22:13] <frozendevil> Eridius: everything in disasm returns ~str, most things in cpu return (), but some return ~str, some return MemoryAddressingMode, one returns AccumulatorAddressingMode and one returns ImmediateAddressingMode
[06:22:17] <frozendevil> yeah
[06:22:33] <Eridius> frozendevil: ok, you can do this with 4 type parameters to OpDecode (or whatever it's called
[06:22:44] <Eridius> disasm will implement OpDecode<~str, ~str, ~str, ~str>
[06:22:48] <frozendevil> I think it's probably still doable, but more work than I was expecting
[06:22:57] <Eridius> Cpu will implement OpDecode<(), MemoryAddressingMode, AccumulatorAddressingMode, ImmediateAddressingMode>
[06:23:06] <Eridius> and then you just use the type parameters as the return types of the appropriate methods
[06:23:16] <Eridius> (and the ones cpu returns ~str for can just be ~str instead of a type parameter)
[06:23:19] <frozendevil> seems reasonable
[06:23:28] <Eridius> this is pushing the boundaries of reasonable-ness though
[06:23:33] <frozendevil> yeah
[06:23:45] <Eridius> still an interesting exercise to implement, but the macro may actually be conceptually simpler
[06:23:52] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[06:24:34] *** Joins: aatch|mobile (aatch@moz-2BB0AC01.cable.telstraclear.net)
[06:24:43] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[06:24:57] <frozendevil> it feels like there's a higher level refactoring opportunity, but I'm not super comfortable manipulating whole projects yet 
[06:25:01] <frozendevil> even if this is fairly small
[06:25:13] <Eridius> You could also split this up into multiple traits
[06:25:31] <Eridius> OpDecodeAddressingMode<ImmediateAddressingMode, MemoryAddressingMode>
[06:25:35] <Eridius> and whatever the other groupings are
[06:25:43] <Eridius> and then have OpDecode : OpDecodeAddressingMode + OpDecodeFoo {}
[06:26:00] <Eridius> but that doesn't really buy you anything besides fewer type parameters on a given trait
[06:26:08] <frozendevil> like, I'm still not clear why you use "pub mod foo" to get foo's public methods, but "use foo::Bar" to get the Bar trait
[06:26:26] <Eridius> you don't use "pub mod foo" to get foo's public methods
[06:26:34] *** Quits: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net) (Quit: syatchmenoff)
[06:26:35] <Eridius> you use "pub mod foo" to declare a public module named foo inside the current module
[06:26:38] <Eridius> it's an item
[06:26:48] *** Quits: koonchun (matti@moz-EE8B4D5A.bb.dnainternet.fi) (Ping timeout)
[06:26:51] <Eridius> "pub mod foo;" will load it from foo.rs or foo/mod.rs, and "pub mod foo { ... }" has the definition inline
[06:27:04] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[06:27:06] <Eridius> meanwhile "use foo::Bar" brings foo::Bar into scope for path resolution
[06:27:22] <Eridius> and if Bar is a trait it makes the trait's methods callable (because trait methods are only callable if the trait is in scope)
[06:27:27] *** Joins: alkino_ (alkino@moz-18C36E4E.w92-151.abo.wanadoo.fr)
[06:28:23] <Eridius> frozendevil: if this confuses you, let me tell you about `pub use foo::Bar` ;) (that brings foo:Bar into scope, and then re-exports it from the current module)
[06:28:34] <Eridius> that's useful for when foo is private and you're trying to provide access to a component of it publicly
[06:28:42] <frozendevil> hrm
[06:28:51] *** Joins: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net)
[06:29:17] <Eridius> `pub use Baz = foo:Bar` renames it
[06:29:27] <Eridius> s/foo:Bar/foo::Bar/
[06:29:35] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Client exited)
[06:29:39] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[06:29:56] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[06:30:41] *** Joins: tikue (tikue@A7ECB14D.ADD881BB.D5A9E6FD.IP)
[06:31:42] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Ping timeout)
[06:32:09] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[06:32:09] *** Quits: astropirate (astropirat@moz-6D82BAA4.hsd1.co.comcast.net) (Quit: Leaving)
[06:33:50] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[06:34:16] *** Quits: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net) (Ping timeout)
[06:34:16] *** Quits: philix_ (felipe@moz-B08938FF.user.veloxzone.com.br) (Ping timeout)
[06:36:25] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[06:36:38] *** Joins: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net)
[06:37:16] *** Quits: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net) (Quit: syatchmenoff)
[06:38:15] *** Quits: richo (richo@moz-1C569BCA.hsd1.ca.comcast.net) (Ping timeout)
[06:38:15] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[06:39:27] *** Joins: pczarn (pczarn@moz-69A55FA.izacom.pl)
[06:39:52] <frozendevil> is this incorrect syntax "pub trait OpConsumer<A, B, C, D> {…}" ?
[06:40:00] *** pmoore|away is now known as pmoore
[06:40:12] <Eridius> frozendevil: yes
[06:40:17] <Eridius> wait no
[06:40:20] <Eridius> sorry I'm tired and misread
[06:40:31] <Eridius> for a moment I thought that was impl, not trait
[06:40:31] <Yurume> frozendevil: it is correct. what is your error message?
[06:40:35] <Yurume> ah
[06:40:44] <frozendevil> cpu.rs:109:2: 109:5 error: unexpected token: `lda`
[06:40:44] <frozendevil> cpu.rs:109 	lda(&mut self, am: AM) -> A;
[06:40:53] <Yurume> yeah, for impls the correct syntax is `impl<A,B,C,D> OpConsumer<A,B,C,D> { ... }`.
[06:41:01] <frozendevil> right
[06:41:09] <cmr> frozendevil: `fn lda`
[06:41:15] <frozendevil> oh, duh
[06:41:18] <frozendevil> I keep doing that
[06:41:41] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[06:41:43] <frozendevil> I was wondering why the syntax highlighting went off
[06:41:45] *** Quits: meyer (meyer@moz-A9CF56E4.hsd1.ca.comcast.net) (Quit: meyer)
[06:41:57] <cmr> yeah that's usually a good warning sign :)
[06:42:08] <Yurume> (with the up-to-date syntax file)
[06:42:18] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Ping timeout)
[06:42:20] *** Joins: ofeldt (ofeldt@moz-2D0BE399.dip0.t-ipconnect.de)
[06:43:13] *** Quits: ofeldt- (ofeldt@moz-4626A5F1.dip0.t-ipconnect.de) (Ping timeout)
[06:43:45] <frozendevil> are there any hilighters that use the compiler yet?
[06:44:01] <cmr> https://github.com/KokaKiwi/rust-highlight does
[06:44:03] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[06:44:05] <frozendevil> or whatever the librustc equivalent it
[06:44:16] <frozendevil> ah, cool
[06:44:16] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[06:44:37] <dpc> Anyone knows how to fix hits? http://pastebin.com/vRkXrgDN
[06:44:49] <dpc> RefCells + lifetimes + iterators
[06:45:03] <Yurume> try removing dots... (joking)
[06:45:08] <frozendevil> has there been any discussion about highlighting more meta things? like the frozen-ness of a var? 
[06:45:42] <cmr> frozendevil: that'd be very cool to see
[06:45:44] <Yurume> dpc: how is self.creatures defined?
[06:45:44] <frozendevil> (mostly just curious, I don't know how useful that would actually be)
[06:46:01] <cmr> frozendevil: it'd take a long time to run the analysis, so I don't think it'd be very good in syntax highlighting.
[06:46:02] <dpc> creatures: Vec<RefCell<~Creature>>,
[06:46:07] <Yurume> frozendevil: syntax definitions for editors? rustdoc highlighter?
[06:46:18] <cmr> but that'd be super awesome for some sort of code browser
[06:46:21] <cmr> like dxr
[06:46:31] <frozendevil> Yurume: ?
[06:46:44] <dpc> Yurume: I'm loosing the lifetime somwhere...
[06:46:52] <Yurume> dpc: the error message would help
[06:47:12] <carllerche> if a struct is allocated on the stack of a fn, when does it's lifetime end?
[06:47:20] <carllerche> as the very first thing when calling a fn
[06:47:24] <Eridius> dpc: I'm trying to repro right now
[06:47:31] <Yurume> frozendevil: there are many things that do the syntax highlighting...
[06:47:32] <cmr> carllerche: when the inmost block ends.
[06:47:35] <Eridius> carllerche: lifetime ends based on syntactical scope
[06:47:36] <Yurume> (and I'm context-free.)
[06:47:39] *** Quits: l4c (alex@moz-E557C5BE.mpls.qwest.net) (Ping timeout)
[06:47:45] <dpc> Yurume: http://pastebin.com/4pKsqWLY
[06:48:02] <dpc> Eridius: :) I'm hopeful.
[06:48:19] <frozendevil> is there a way to do something like "fn lda<AM:B|C|D>(&mut self, am: AM) -> A;"?
[06:48:30] <frozendevil> where AM is one of (B, C, D)
[06:48:43] <cmr> frozendevil: no, unfortunately.
[06:48:46] <carllerche> hmm, what generally causes "error: `tracer` does not live long enough"? I must be doing something wrong with lifetimes
[06:48:51] <frozendevil> hm
[06:48:53] <frozendevil> that's too bad
[06:49:01] <Eridius> frozendevil: how would you possibly use AM?
[06:49:03] <carllerche> maybe it's being moved out?
[06:49:08] <Yurume> dpc: aha, uhm, that would be problematic, since cr.borrow() returns an `Ref` intermediate value (for custom drop semantics) and its lifetime is bound to the current function scope.
[06:49:14] <Eridius> frozendevil: you don't know if it implements B so you can't call anything from B, you don't know if it implements C so you can't call anything from C,e tc
[06:49:28] <Eridius> frozendevil: basically, your code would have to treat it identically to <AM>, that is, having no bounds
[06:49:48] <frozendevil> Eridius: that sort of already how cpu is constructed
[06:49:52] <frozendevil> wait
[06:49:55] <Yurume> dpc: given your purposes, I think the solution is simply returning the `Ref` itself, not a borrowed reference from it.
[06:49:56] <Eridius> Yurume: the lifetime of Ref is tied to the lifetime of the RefCell
[06:50:02] <Eridius> Yurume: the lifetime of the RefCell should be 'a
[06:50:16] <frozendevil> hrm, yeah
[06:50:17] <dpc> yurume: borrow() is said to return Ref<'a, T>
[06:50:19] <frozendevil> this might be a dead end
[06:50:33] <Yurume> ugh?
[06:50:36] <Yurume> hmm...
[06:50:50] <Yurume> I'd better reproduce it
[06:50:51] <dpc> Yurume: And then defer returns &'a T
[06:50:56] *** Joins: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP)
[06:51:12] <Eridius> just reproduced
[06:51:25] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[06:51:36] <dpc> Yurume: I've tried returning RefCell but I had similiar problem. I'm loosing 'a somewhere before...
[06:52:17] <Eridius> crap
[06:52:33] <Eridius> the problem is Deref ties the lifetime of the returned value to the lifetime of self
[06:52:38] <Eridius> which is different than the lifetime parameter on Ref
[06:52:52] <dpc> Eridius: Really?
[06:53:00] <Eridius> it has to; that's how the trait is defined
[06:53:11] <carllerche>  ah crap, so, kind of interesting I guess… I made a fn my_fn<T: Eq>(a: T, b: T) and when I called it, I passed a &str, and a &'static str
[06:53:16] <carllerche> so it seems that the lifetimes conflict there
[06:53:26] <Eridius> dpc: but now that I think about it, this actually makes sense
[06:53:34] <Yurume> Eridius: ah really, fn deref<'a>(&'a self) -> &'a T.
[06:53:34] <frozendevil> Eridius: well, B, C, and D are already unified with AddressingMode<M>
[06:53:37] <Eridius> the derefence of the Ref can only possibly be valid while the Ref exists
[06:53:47] <Eridius> because when the Ref destructs it returns the dynamic borrow
[06:53:59] <Eridius> frozendevil: not sure what you mean
[06:54:08] <dpc> Eridius: I see.
[06:54:19] <dpc> Eridius: But can I return the Ref?
[06:54:20] <Eridius> dpc: basically, you can't return &'a ~Creature because you have no way of keeping the dynamic borrow alive
[06:54:21] <Yurume> Eridius, dpc: then my solution would indeed work
[06:54:24] <Eridius> you could return the Ref, yes
[06:54:25] <Yurume> (and I've tested it)
[06:54:54] *** Quits: pczarn (pczarn@moz-69A55FA.izacom.pl) (Input/output error)
[06:55:15] <Eridius> dpc: https://gist.github.com/kballard/9969457
[06:55:16] <Eridius> that works
[06:55:54] <dpc> Eridius: Ah! Indeed it works.
[06:56:02] <Eridius> frozendevil: what are you trying to accomplish with your <AM:B|C|D>?
[06:56:08] <dpc> Eridius: You win 2:0 against my problems.
[06:56:16] <frozendevil> I'm not sure what the right terms are… in this case functions that take either B, C, D are defined as taking <AM:AddressingMode<M>>(am: AM) in the CPU but I'm not sure there's a way to express that agnostically with the trait
[06:56:21] *** Joins: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net)
[06:57:09] <frozendevil> Eridius: there are some functions in cpu that take one of (MemoryAddressingMode, AccumulatorAddressingMode, ImmediateAddressingMode) and they accomplish that with <AM:AddressingMode<M>>
[06:57:16] <Eridius> dpc: \o/
[06:57:21] <frozendevil> in disasm they just take a str
[06:57:24] <frozendevil> er, ~str
[06:57:34] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[06:58:17] <Eridius> frozendevil: impl<M:Mem,AM:AddressingMode<M>> MyTrait<AM> for Cpu<M> {} ?
[06:58:39] <Yurume> Eridius: phew, fortunately the original `Ref::get` did the same thing as the current `Ref::deref` (http://static.rust-lang.org/doc/0.9/std/cell/struct.Ref.html), so there is no backward compatibility problem, it's just annoying.
[06:58:49] <frozendevil> hmm
[06:59:03] <Eridius> Yurume: phew indeed, but it would be wildly incorrect to behave differently
[06:59:12] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140402030201])
[06:59:36] <Yurume> I guess so
[06:59:43] <Yurume> unfortunate but have to deal with it
[06:59:59] <Eridius> that's what you get for using dynamic borrows
[07:00:28] *** Joins: philix (felipe@moz-B08938FF.user.veloxzone.com.br)
[07:00:30] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[07:00:33] <Yurume> drop beats. *drum*
[07:00:33] *** Joins: skade (skade@moz-1EC0F118.pools.arcor-ip.net)
[07:01:13] *** Joins: richo (richo@moz-E6FCD5A0.hsd1.ca.comcast.net)
[07:02:19] *** Joins: bourbaki (luesebrink@moz-8B9D6A18.dip0.t-ipconnect.de)
[07:02:24] <bourbaki> Greetings
[07:02:30] *** Quits: richard|s_ (mindginati@52C2689A.6E9E9E0.6400445B.IP) (Ping timeout)
[07:02:32] <mcpherrin> WELCOME
[07:02:59] *** user is now known as zq
[07:03:25] <bourbaki> What was that thingy called again that gives me "dependent typing" at runtime in Rust? Like the values for array count etc. It was called ... items.
[07:03:47] *** Quits: alisdair (textual@moz-7E6FA9C4.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:04:15] <tikue> tons of love for HKT in the r/rust thread
[07:04:20] <tikue> :3
[07:04:27] *** Joins: ehsanul (harish@moz-24DD2596.hsd1.ca.comcast.net)
[07:04:39] <tikue> but will a champion come forth?
[07:06:49] <bjz> bourbaki: could you define what you mean by 'dependent typing'?
[07:07:01] *** Quits: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:07:02] <TheHydroImpulse> tikue although quite a bit of unwarranted downvoting. Kinda feel bad about it, but there was plenty of valid concerns.
[07:07:45] <bjz> bourbaki: there is a pretty precise definition in type theory, but I have heard it used differently outside those circles
[07:08:08] <bjz> TheHydroImpulse: agreed
[07:08:14] *** Joins: WebeWizard (WebeWizard@moz-7CCD1DAE.ks.ks.cox.net)
[07:08:49] <bjz> TheHydroImpulse: whilst I don't necessarily agree that the counter-arguments hold, they were thoughtfully posed
[07:09:02] <tikue> TheHydroImpulse: bjz: I didn't see that much downvoting, overall
[07:09:28] <bourbaki> bjz: What i mean is not DT, but when you have an array like in C++ and you use values as parameters in the template.
[07:09:31] <tikue> the largest downvote magnet was chris-morgan's comment "One thing I want to avoid is Rust becoming an Academic language."
[07:09:38] <tikue> which honestly wasn't a very helpful comment imo
[07:09:41] *** Quits: mark_edward (mark@moz-E0F1AB04.hsd1.in.comcast.net) (Quit: Leaving)
[07:09:42] <bourbaki> Like std::array<int, 3>
[07:09:59] <TheHydroImpulse> tikue I feel like people, especially not familiar with HKTs have concerns, and that’s valid.
[07:10:14] <TheHydroImpulse> we shouldn’t mute them
[07:10:18] <bjz> tikue: yeah, I agree, that was a little odd
[07:10:24] *** Quits: ehsanul (harish@moz-24DD2596.hsd1.ca.comcast.net) (Ping timeout)
[07:10:34] <bjz> tikue: seeing as we have linear types and regions
[07:10:36] <bjz> :P
[07:10:46] <tikue> TheHydroImpulse: there are certainly valid concerns, but I don't think that was one of them
[07:10:50] <tikue> bjz++
[07:11:12] *** Joins: ehsanul (harish@moz-24DD2596.hsd1.ca.comcast.net)
[07:11:12] <tikue> to me, the motivation for HKT is DRYer code and nicer libraries
[07:11:14] <TheHydroImpulse> tikue by valid, I mean, someone has the right to have them. 
[07:11:16] <frozendevil> well, I guess a million errors is better than 1 error :P
[07:11:49] <tikue> TheHydroImpulse: well, sure. but "helpful" a valid opinion does not one make
[07:12:17] <tikue> anyway, I think it was a very useful discussion, and it was exciting to see the number of people interested
[07:12:23] <tikue> so thank you for the post :)
[07:13:03] <TheHydroImpulse> tikue your welcome :) Just something I wrote after working for 12 hours, so I didn’t spend to much time on it
[07:13:23] <bjz> TheHydroImpulse: thanks for the post, it was quite good
[07:13:28] <eddyb> >_>
[07:13:33] * eddyb steps away slowly
[07:13:50] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:14:02] <TheHydroImpulse> bjz thanks
[07:14:36] <tikue> anyway, it still remains to be seen if anyone will actually take it upon themselves to make a coherent RFC for HKTs...
[07:14:41] <tikue> that seems pretty daunting
[07:14:48] <bjz> tikue: indeed
[07:15:33] <bjz> tikue: we also need a more solid foundation for our current type system
[07:15:40] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:15:54] <Eridius> we need to support integral type parameters before we think about HKTs
[07:16:03] <TheHydroImpulse> yep, I think we can take advantage of the powerful inference in Rust.
[07:16:04] <bjz> tikue: and that in itself is hard enough
[07:16:05] <jdavis__> Why does Result.or_else() return a Result? Shouldn't it return the Ok value?
[07:16:09] <tikue> Eridius: that would be nice, yeah
[07:16:09] <cmr> We need a formal model of the type system before we do *anything*
[07:16:14] <cmr> jdavis__: Ok is not a type.
[07:16:19] <bourbaki> Do you guys want to add HKT in 1.0?
[07:16:19] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[07:16:21] <bjz> cmr: +1
[07:16:22] <cmr> jdavis__: Ok is a constructor for the Result type.
[07:16:37] <cmr> bourbaki: it's not 1.0 right now
[07:16:38] <Eridius> jdavis__: the else block returns a Result
[07:16:43] <tikue> bourbaki: one can dream :P but I _seriously_ doubt it
[07:16:48] <Eridius> jdavis__: Err(_).or_else(|| Err(_)) results in an Err(_)
[07:16:49] *** Joins: Ferreus (ferreus@moz-D25C01AC.dip0.t-ipconnect.de)
[07:17:02] <bjz> jdavis__: Result is a type that has two constructors, Ok and Err
[07:17:03] <tikue> i'd even go as far as to say that it certainly won't be in 1.0
[07:17:12] <Eridius> rephrase: Err(a).or_else(|_| Err(b)) results in Err(b)
[07:17:44] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[07:17:55] <bourbaki> cmr: Didnt you tell me what the values in the generics where called? Something items.
[07:18:03] <cmr> bourbaki: variants?
[07:18:12] <TheHydroImpulse> tikue yeah, most of the time would be spent on the RFC and getting the perfect design.
[07:18:13] <jdavis__> Yeah, I see that Result has two constructors. For Result<T,E> I would expect or_else to return T, else call the function argument
[07:18:14] <bjz> jdavis__: Result<T, U> is the type constructor, Ok(T) and Err(U) are the value constructors (I think)
[07:18:17] <cmr> bourbaki: wait, what items in generics? type parameters?
[07:18:33] <bourbaki> cmr: Yes value parameters is what i mean.
[07:18:34] <Eridius> jdavis__: or_else returns OK(T) or it returns the result of its function argument
[07:18:47] <Eridius> jdavis__: the result of the function argument may not be a T, which means or_else() can't just return T
[07:18:52] <bourbaki> cmr: Like a num for the array count or a method and the like.
[07:19:09] <frozendevil> thanks for the help everyone, I think I need to sleep on this
[07:19:25] *** Quits: c74d3 (c74d3a4ebb@moz-E2EAC718.oc.oc.cox.net) (Ping timeout)
[07:19:25] <tikue> TheHydroImpulse: there are less complex things that are currently stalled in design. namely, struct inheritance
[07:19:26] *** Quits: c74d (c74d@moz-E2EAC718.oc.oc.cox.net) (Ping timeout)
[07:19:27] <cmr> bourbaki: I honestly don't know what you're talking about.
[07:19:45] <bourbaki> cmr: Like in std::array<int, 3> 3 is a value not a type.
[07:19:56] <TheHydroImpulse> tikue oooo, well then…
[07:19:56] <bjz> bourbaki: we can't express that at the moment
[07:20:00] <jdavis__> OK, I understand now. I was trying to use or_else like a failure handler, but it doesn't quite work that way.
[07:20:01] <bourbaki> And i asked if Rust would get dependent types and someone said no.
[07:20:05] <frozendevil> like [T, ..4]?
[07:20:24] <bourbaki> bjz: I know but someone pointed out that Rust is not getting DT but something else ... items.
[07:20:28] <Eridius> jdavis__: if you don't care about the Err, you can use .ok().unwrap_or_else(f)
[07:20:33] <bourbaki> Like in C++ its just compile time.
[07:20:37] *** pmoore is now known as pmoore|away
[07:20:38] <bjz> bourbaki: rust might get the ability for types to be parameterised by values, but not real dependent types
[07:20:46] <eddyb> bourbaki: associated items
[07:20:50] *** Quits: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net) (Quit: Leaving.)
[07:20:51] <bourbaki> eddyb: THANKS :)
[07:20:52] <tikue> bjz: is there actually talk of that?
[07:20:54] <cmr> ah that one.
[07:21:10] <cmr> (DT -> DST)
[07:21:18] <bourbaki> DST?
[07:21:23] <jdavis__> Eridius: the problem is that I do care about the error. I just want to do a simple early return from the function if an error is encountered.
[07:21:28] <cmr> oh, you mean dependant types.
[07:21:29] <bjz> bourbaki: dynamically sized types
[07:21:36] <cmr> yeah that's never going to happen.
[07:21:38] <Eridius> jdavis__: if you care about the error than you can't possibly use an expression that returns T
[07:21:39] <cmr> not in rust, that is.
[07:21:41] <Eridius> because that throws away the error
[07:21:43] <jdavis__> And I was trying to avoid a verbose match statement.
[07:21:56] <Eridius> jdavis__: it sounds like you might want try!()
[07:22:11] <Eridius> which was a macro developed for use with I/O, but fundamentally, it works with any Result inside a function whose return type is the same typed Result
[07:22:12] <bjz> bourbaki: proper dependent types really need to be built in from the start - extremely hard to retrofit
[07:22:14] <jdavis__> I tried try!(), but I had difficulty making the types work out.
[07:22:20] <bourbaki> Whats the problem with DT? Too complicated not ... well rounded enough yet?
[07:22:25] <Eridius> so if your value is a Result<T,E> and the function returns a Result<_,E> then try!() should work
[07:22:33] <bourbaki> Ah i see :(
[07:22:59] <bourbaki> Is there any deep diving article on lifetimes yet you can point me to?
[07:23:01] <jdavis__> Eridius, the function that might error is from rust-postgres, so it returns a Result<T, E> where E is a special postgres error.
[07:23:11] <bourbaki> Eg like are lifetimes part of the type system etc.
[07:23:21] <eddyb> also, their cost outweigh their benefits (DT)
[07:23:30] <Eridius> jdavis__: and the function that you're currently in returns.. what?
[07:23:34] <bjz> bourbaki: I would also say, from my limited knowledge, that it seems like we still don't know enough about how to put them into a working language. idris is working hard on exploring that though
[07:23:49] <jdavis__> But I want my function to return a Result<T2, E2> where E2 is just a ~str or something generic.
[07:23:53] *** Quits: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:23:54] <bourbaki> One really cool thing about DT is that i can determine size of times at the time i load data.
[07:24:03] *** Joins: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net)
[07:24:12] <eddyb> "of times"?
[07:24:15] <bourbaki> bjz: Aye
[07:24:20] <Eridius> jdavis__: then you need to write that explicitly. How can rustc possibly know what precise error you want to return? The macro only works because it's the same error as from the result you're trying to unwrap
[07:24:22] <dpc> Does liftime analyzer has still bugs?
[07:24:23] <jdavis__> And the caller of that would try to extract a string from it and print it.
[07:24:35] <eddyb> dpc: "lifetime analyzer"?
[07:24:37] <Eridius> let x = match val { Ok(x) => x, Err(e) => return Err(~"wat") };
[07:24:46] <Eridius> dpc: it's called borrowck
[07:24:47] <jdavis__> Eridius, I was hoping if they both implement the Show trait, that would be enough.
[07:24:49] <Eridius> as in, the borrow checker
[07:24:58] <eddyb> well, regionck and borrowck
[07:25:06] <jdavis__> Eridius, because that's all the top level cares about: that it can turn it into a string.
[07:25:08] <eddyb> the former drives lifetime inference
[07:25:10] <Eridius> jdavis__: you'd have to tell it to actually convert the error to a ~str though
[07:25:20] <eddyb> the latter enforces borrow semantics
[07:25:26] <bjz> bourbaki: Rust has already taken on a ton by bringing linear types and regions into the fore
[07:25:31] <Eridius> eddyb: huh, I'd never heard of regionck as a separate thing before
[07:25:38] <Eridius> jdavis__: you could write your own macro if you want
[07:25:44] <jdavis__> Eridius, OK. So it sounds like I need a match statement for each rust-postgres call? 
[07:25:45] <eddyb> Eridius: it's the penultimate typeck stage
[07:25:50] <dpc> borrowck ... I see...
[07:25:55] <jdavis__> Oh, or some macros?
[07:25:56] <dpc> Well this Cells are killing me...
[07:25:58] <bourbaki> bjz: Where can i read about all this stuff? Without having to spend like all day on reddit and the lot :)?
[07:25:58] <eddyb> Eridius: before writeback (which saves the result of inference and whatnot)
[07:26:01] <bjz> bourbaki: Dependent types is another rabbit hole entirely. maybe for the next systems lang to tackle
[07:26:01] *** Quits: enos (jkingyens@moz-7A8F6201.hsd1.ca.comcast.net) (Quit: enos)
[07:26:05] *** Joins: enos (jkingyens@moz-7A8F6201.hsd1.ca.comcast.net)
[07:26:07] <bjz> bourbaki: check out idris
[07:26:12] <Eridius> macro_rules! mytry(($e:expr) => (match $e { Ok(x) => x, Err(e) => return Err(fmt!("{}", e) }))
[07:26:14] <bourbaki> bjz: Did quite liked it.
[07:26:15] <Eridius> jdavis__: ^
[07:26:16] <eddyb> bourbaki: there are docs in our compiler, btw
[07:26:16] <bjz> bourbaki: it has a really nice tutorial
[07:26:20] <dpc> Good name for a song.
[07:26:31] <eddyb> bjz: like, there is pretty much an entire borrowck paper, written in markdown
[07:26:35] <eddyb> err, bourbaki^^
[07:26:41] *** enos is now known as jkingyens
[07:26:42] <dpc> I'll fight will Cells tomorrow. Thanks for your help Eridius and everyone. GN
[07:26:46] <bourbaki> bjz: I had a close look at idris for some of my math problems but DT is not enough to solve them.
[07:26:49] <Eridius> dpc: good luck and good night
[07:26:49] *** Quits: dpc (Mibbit@3CA2DD5F.FAD414BA.D74CC41D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:26:50] <Yurume> .redditname a:after{content:" programming language does not have monads"}
[07:26:52] <jdavis__> Eridius, Oh, that could work for me. Thank you.
[07:27:00] <Yurume> what the hell is this XD
[07:27:00] <bourbaki> eddyb: On the github page of the compiler?
[07:27:06] <eddyb> bourbaki: in the source
[07:27:10] *** Quits: Dylan16807 (dylan@moz-4FD5B5C1.lightspeed.cntmoh.sbcglobal.net) (Connection reset by peer)
[07:27:17] <Yurume> (/r/rust custom CSS, that is)
[07:27:18] <bourbaki> Got an url at hand?
[07:27:23] <bjz> bourbaki: indeed - Rust is far closer to being a production quality language than idris
[07:27:25] <cmr> bourbaki: the biggest problem is that type inference in a dependently typed language is not possible
[07:27:34] *** Joins: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au)
[07:27:46] *** Quits: ctangent (textual@moz-67DD0115.hsd1.wa.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:27:50] <eddyb> cmr: you mean total type inference?
[07:27:56] <Eridius> jdavis__: alternatively you could skip the macro and just do try!(val.map_err(|e| e.to_str()))
[07:27:58] <bjz> cmr: you can do some
[07:28:17] <eddyb> bourbaki: so here's our inference http://static.rust-lang.org/doc/master/rustc/middle/typeck/infer/doc/index.html
[07:28:19] <bjz> cmr: and that is a big part of what idris is trying to work on
[07:28:25] <jdavis__> Eridius: oh, that works too, but I like the first one. Thanks again.
[07:28:28] <bourbaki> eddyb: Thank you very much
[07:28:40] <bjz> cmr: as far as I know, of course
[07:28:42] <eddyb> bourbaki: and this is the borrowck paper http://static.rust-lang.org/doc/master/rustc/middle/borrowck/doc/index.html
[07:28:52] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[07:29:02] <bjz> cmr: but total program inference is indeed apparently impossible
[07:30:00] <bjz> cmr: but listening to edwinb, the development process is far more type driven in idris than in haskell
[07:30:08] *** Joins: osa1 (omer@6CFF95AB.2545CD3.3688B332.IP)
[07:30:28] <bjz> cmr: you write the specification, then you work with the compiler towards the solution
[07:30:45] <cmr> eddyb: I don't know precisely where the boundary lies, but that is proven undecidable.
[07:31:16] <bjz> cmr: where as in haskell you write an implementation and let the tyoes fall out
[07:31:19] <bjz> *types
[07:31:38] <bourbaki> I think that this interactive approach is quite cool.
[07:31:40] <cmr> bjz: I haven't been following idris for a while
[07:31:46] <bourbaki> Agda has that also where you can work with holes.
[07:31:51] <bjz> cmr: np, nore have I 
[07:31:56] <eddyb> Rust requires more type info than Haskell
[07:32:11] *** Joins: Dylan16807 (dylan@moz-4FD5B5C1.lightspeed.cntmoh.sbcglobal.net)
[07:32:13] <eddyb> I wouldn't mind a toy Rust variant with DT
[07:32:18] <eddyb> it could be fun
[07:32:24] <eddyb> but I wouldn't write anything serious with it
[07:32:57] <bourbaki> Is anything planned like a build in code generator btw?
[07:33:05] <bourbaki> Like T4 or m4 and the lot.
[07:33:13] <eddyb> bourbaki: syntax extensions
[07:33:38] <eddyb> Rust code to generate Rust AST given an arbitrary set of tokens as input
[07:33:44] <bourbaki> Those are not macros though?
[07:33:47] <Eridius> I gave some thought today to the idea of writing a code transformer using librustc for syntax parsing, as a sort of more powerful alternative to CPP, but I couldn't come up with any actual practical use case
[07:33:56] <bjz> bourbaki: yeah, that is the same with idris - but they want it to be practical and fast - ie. useable for production code (not saying Agda is useless though, far from it). but it's still early days on that front
[07:33:57] *** Quits: devbug (quassel@moz-8C40558B.bchsia.telus.net) (Connection reset by peer)
[07:34:05] <eddyb> bourbaki: well, now I have to look up m4 :|
[07:34:21] <bjz> bourbaki: not sure re. code generators
[07:34:24] <Eridius> also, it's past 12:30. I should have been in bed an hour ago. Good night!
[07:34:26] <bjz> bourbaki: links?
[07:34:30] <eddyb> bourbaki: we do have powerful rule-based macros (also known as MBE i.e. macros by example)
[07:34:34] <bourbaki> bjz: http://en.wikipedia.org/wiki/GNU_m4
[07:34:39] <Eridius> eddyb: m4 is what autoconf is written in
[07:34:46] <alan_andrade> good night eridius : )
[07:34:46] <eddyb> pls no
[07:34:55] <bourbaki> bjz: http://msdn.microsoft.com/en-us/library/bb126445.aspx
[07:35:20] <Yurume> m4, ugh!
[07:35:49] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[07:35:53] <eddyb> bourbaki: have you played with rust macros yet?
[07:35:58] <bourbaki> What i mean is something like :) im not sure about m4 though but i am sure about the t4 thingy.
[07:36:12] <bourbaki> eddyb: Nope not yet, the problem with macros is they generate stuff i can not see.
[07:36:25] <eddyb> T4 looks like a silly version of a template string
[07:36:32] <eddyb> bourbaki: --pretty=expanded
[07:36:37] <bourbaki> Oh!
[07:36:52] <eddyb> not that, uhm, you ever need to look at the result
[07:37:09] <eddyb> (for your own macros, that is)
[07:37:15] <bourbaki> I guess.
[07:37:29] <eddyb> so why do you want to see what they generate?
[07:37:34] <cmr> debugging?
[07:37:35] <bourbaki> One problem i hate in C++ is when you start to run into a problem in your macros.
[07:37:36] <cmr> :p
[07:37:39] <eddyb> it's not like our pretty printer looks good :P
[07:37:49] <eddyb> bourbaki: there is no relationship between CPP and Rust's macros
[07:38:13] <bourbaki> Ok, i need to look into them deeper.
[07:38:23] <eddyb> bourbaki: Rust macros are hygienic (well, at least for local variables and loop labels) and syntactic, not textual
[07:39:04] *** Joins: marc_ (uid5324@moz-31ABA2C0.irccloud.com)
[07:39:08] <bourbaki> How do you debug Rust code anyway?
[07:39:16] <cmr> gdb
[07:39:22] <cmr> or println debugging
[07:39:32] <bourbaki> Ah debugging with chest hair :)
[07:39:44] <Yurume> or logging with debug!() etc.
[07:40:11] <Yurume> fine-grained unit testing also helps (cf. http://static.rust-lang.org/doc/master/guide-testing.html)
[07:40:11] <bourbaki> I am still tempted to write an editor with Qt, if i only had more time.
[07:40:27] <bourbaki> There is so much that you could visualize in Rust like the lifetime etc.
[07:40:50] <eddyb> bourbaki: Qt? may I suggest a kdevelop extension?
[07:40:51] <bjz> bourbaki: the CPP works on textual transformations, Rust macros works on AST transformations
[07:41:07] <eddyb> bourbaki: it already has powerful C++11 support
[07:41:10] <bourbaki> eddyb: Im on Windoze
[07:41:16] <eddyb> bourbaki: kde4 works on windows
[07:41:22] <bourbaki> Oh
[07:41:29] <cmr> (can confirm, ran it as my desktop for a while)
[07:41:48] <eddyb> at least the apps, not sure if you can replace the entire desktop environment with it
[07:41:56] <bourbaki> So i can use Kdevelop with Rust ?
[07:42:08] <cmr> well ... you can use it as much as any other text editor.
[07:42:09] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[07:42:14] <bourbaki> Ah :)
[07:42:17] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Ping timeout)
[07:42:18] <eddyb> bourbaki: I mean, if you want to add support to something
[07:42:25] <bourbaki> Well i would love to build something like Light Table
[07:42:27] <eddyb> might as well start with something that works well on C++
[07:42:32] <eddyb> bourbaki: me too :)
[07:42:40] <bourbaki> AHA :)
[07:42:55] <bourbaki> I think there is so much cool stuff you can do with source code.
[07:42:56] <eddyb> for a Rust-only IDE, I'd want to go full OpenGL
[07:43:00] <bourbaki> That is not part of any editor yet.
[07:43:06] <bourbaki> Dito
[07:43:14] *** Joins: Ms2ger (Ms2ger@moz-98421F60.adsl-dyn.isp.belgacom.be)
[07:43:29] *** Quits: skade (skade@moz-1EC0F118.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:43:46] <bourbaki> Is there anything planned yet for something like this?
[07:43:47] <eddyb> share 8bit text buffer with the GPU and render characters in the shader
[07:43:49] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[07:43:59] <eddyb> none of that RAM bloat :P
[07:44:08] <bourbaki> eddyb: Why not use freetype-gl?
[07:44:19] <eddyb> bourbaki: because you don't need a full thing
[07:44:36] <eddyb> you can optimize for size and speed with constraints like monospace
[07:45:07] <bourbaki> True, well that is not something i would like to lay my effords into though ;)
[07:45:12] <jensnockert> Except monospace doesn't usefully exist.
[07:45:32] <cmr> jensnockert: eddyb doesn't believe unicode is useful
[07:45:39] <bourbaki> Id rather like to point my interest to how to render code to convey the necessary idea for the current problem.
[07:45:39] <eddyb> my simple HTML5 text editor used, like, a few hundred bytes per byte of original source code
[07:45:43] <jensnockert> cmr: Ah, never mind me then.
[07:45:47] <cmr> :p
[07:45:48] <eddyb> cmr: I believe in optimizations ;)
[07:46:19] <eddyb> there is so much code under 0x7F that it would be silly to not optimize for it
[07:46:32] <jensnockert> Reminds me of a mail I got once, about non-standard alphabets.
[07:46:33] <bourbaki> Is there any project that works in a Rust IDE written in Rust?
[07:46:43] <eddyb> bourbaki: not AFAIK
[07:46:52] <dougxxx> atom has rust syntax hinting
[07:46:56] <cmr> I think it's silly to microoptimize *text editor font rendering* like that.
[07:46:57] <dougxxx> but its not in rust
[07:47:09] <eddyb> dougxxx: a lot of editors have Rust syntax highlighting
[07:47:10] <bjz> bourbaki: why not build a Rust plugin for lighttable?
[07:47:15] <eddyb> cmr: why?
[07:47:20] <cmr> when we developers work on machines with many dozens of megabytes of memory.
[07:47:29] <eddyb> cmr: it's one of the worst things in editors
[07:47:29] <bourbaki> bjz: Oh right. Could have a look at that first.
[07:47:34] <bourbaki> I need more time :))
[07:47:37] <cmr> saving an extra byte per character is not too useful.
[07:47:39] <bjz> bourbaki: I've looked into it
[07:47:46] <bourbaki> bjz: And to what end?
[07:47:57] <cmr> eddyb: uhh, I find the HCI parts far more worse than their font rendering...
[07:47:58] <bjz> bourbaki: we would need to at the very least just update the highlighter
[07:48:00] <eddyb> cmr: look at your browser's RAM usage and say that again to me
[07:48:07] <cmr> eddyb: I'm not defending the browser.
[07:48:13] <cmr> I will never defend the web.
[07:48:15] <bjz> bourbaki: more yummy features would have to wait though
[07:48:20] <bourbaki> bjz: Is it extensible enough to render something like lifetimes?
[07:48:24] <eddyb> UTF-16 in JS hurts like hell
[07:48:31] <bjz> bourbaki: I believe it would be
[07:48:35] <cmr> no it doesn't, the DOM does.
[07:48:45] <bourbaki> It would be cool if you could render the lifetime of an object.
[07:48:53] <cmr> also it's not utf16... it's an array of two-byte cells.
[07:49:00] <bourbaki> Like in debug canvas. So you see all functions that the objects life in etc.
[07:49:04] <bjz> bourbaki: what do you mean by 'render'?
[07:49:17] <bourbaki> bjz: I mean like a read thread through the code for the life time.
[07:49:23] <bourbaki> literally
[07:49:32] *** Joins: lerc (quassel@moz-82B68322.telstraclear.net)
[07:49:32] <bjz> I still don't understand
[07:49:36] <eddyb> bourbaki: I'm not aware of an editor with syntax highlighting not capable of working with Rust lifetimes :P
[07:49:43] <bourbaki> Sec
[07:49:44] *** Joins: twi (Adium@moz-429185BE.cust.vodafonedsl.it)
[07:49:54] <bjz> are you just talking highlighting?
[07:49:55] <eddyb> (their odd syntax, I mean)
[07:50:10] <bjz> or something interactive?
[07:50:15] <cmr> bourbaki is suggesting a way to visualize the lifetime of objects.
[07:50:17] <bourbaki> bjz: No let me find a video
[07:50:36] <cmr> (much like you can visualize the scope of something via indentation)
[07:50:42] <eddyb> cmr: what do you mean by "hcl" btw?
[07:50:43] <bourbaki> http://www.youtube.com/watch?v=3p9XUwIlhJg
[07:50:51] <cmr> eddyb: that's an eye, human computer interaction
[07:50:53] <bjz> bourbaki: yeah I didn't think you were talking about highlighting
[07:51:03] <bourbaki> This is something you have in the VS Ultimate version so you can debug through your source and you see the functions called.
[07:51:16] <eddyb> cmr: hah, so confused at first
[07:51:45] <bourbaki> What i want now is a canvas of functions that show where an object lives and highlight the object and its lifetime.
[07:51:59] <eddyb> cmr: actually, I think I remembered a better reason for wanting 8bit - minimal code pages to pre-render
[07:52:04] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[07:52:13] <bjz> bourbaki: that looks super cool
[07:52:25] <bourbaki> I would like to think about ways outside the usual text editor to render info.
[07:52:28] <eddyb> "functions called" reminds me of my tracer thing
[07:52:30] <bjz> bourbaki: I definitely thing debuggers deserve to have good guis
[07:52:32] <bourbaki> http://www.youtube.com/watch?v=PsPX0nElJ0k
[07:52:38] <bourbaki> This is a pretty cool concept also.
[07:52:41] <eddyb> and that other thing for JS
[07:53:29] <eddyb> the debugger canvas would work great with something like lldb
[07:53:47] <bourbaki> Also it would be cool if you could get stuff like metrics on your code in Rust with some kind of API
[07:53:52] <eddyb> bourbaki: but would you want lifetimes in a *debugger*?
[07:53:56] <bourbaki> Like that AST visitor in clang
[07:54:15] <eddyb> bourbaki: metrics? I know coverage tools work on Rust code, not sure exactly what you mean
[07:54:16] <bourbaki> eddyb: Hm not really but at the time you write code.
[07:54:16] *** Quits: edwardw (Mibbit@A8F743D9.7FBBB51F.BE7924BA.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:54:27] *** Quits: oxum (anonymous@F7DD905A.892E3CAA.520CDC98.IP) (Quit: ...)
[07:54:53] <eddyb> bourbaki: ah okay. you can totally add that in an editor that already shows you type info on mouseover or anything close to that
[07:54:55] <bourbaki> eddyb: I mean metrics like cyclomatic complexity, lines of code per function etc.
[07:55:05] <bourbaki> So you can show the metric while you write code.
[07:55:20] *** zz_kimundi is now known as kimundi
[07:56:03] *** Joins: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl)
[07:59:50] *** Quits: rootnode__ (rootnode@moz-50470F7D.pools.arcor-ip.net) (Ping timeout)
[07:59:57] *** Joins: codl (uid28108@moz-A42E5B7B.irccloud.com)
[08:00:33] *** Quits: wilmoore (wilmoore@moz-4EF3CEBC.hsd1.co.comcast.net) (Ping timeout)
[08:01:33] *** Quits: daschl (Adium@CB401D19.ED8EB9E6.127DF16D.IP) (Quit: Leaving.)
[08:03:20] *** Joins: c74d (c74d@moz-E2EAC718.oc.oc.cox.net)
[08:03:28] *** kimundi is now known as zz_kimundi
[08:04:49] *** Joins: c74d3 (c74d3a4ebb@moz-E2EAC718.oc.oc.cox.net)
[08:05:17] *** Quits: pongad (pongad@moz-7E8AAD2E.res.gatech.edu) (Quit: Leaving)
[08:07:53] *** Joins: daschl (Adium@CB401D19.ED8EB9E6.127DF16D.IP)
[08:08:35] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[08:08:47] *** zz_kimundi is now known as kimundi
[08:10:38] <bourbaki> And you need to find someone who writes a tutorial like Learn yourself a Haskell :)
[08:12:53] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Ping timeout)
[08:13:49] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:14:03] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[08:14:15] *** Quits: codl (uid28108@moz-A42E5B7B.irccloud.com) (Quit: Updating details, brb)
[08:14:16] *** Joins: codl (uid28108@moz-A42E5B7B.irccloud.com)
[08:15:31] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:15:46] *** Ms2ger is now known as Ms2ger|sad
[08:19:48] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Client exited)
[08:20:08] *** Joins: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP)
[08:20:15] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:21:49] *** Quits: DAddYE (DAddYE@79AC844.CB3251F2.284344F5.IP) (Ping timeout)
[08:22:42] <Ms2ger|sad> channel/Sender/Receiver will remain in the prelude?
[08:24:06] <bjz> Ms2ger|sad: whysosad
[08:24:19] <Ms2ger|sad> Certain news
[08:24:30] <bjz> but yes, it would actually be nice if they were removed
[08:24:34] <Ms2ger|sad> Also, upgrading Servo's rust
[08:24:47] <bjz> ahh
[08:24:59] <bjz> now that would be enough to make anyone sad
[08:25:03] <cmr> heh
[08:25:07] <Ms2ger|sad> Just wondering if I should keep the use's around for now
[08:25:09] <cmr> it's only been what
[08:25:21] <cmr> a month? since the last rust upgrade ;p
[08:25:45] * cmr doesn't know if the targetted rust version increased during the upgrade
[08:26:07] <cmr> Ms2ger|sad: I think keeping the `use` is a good idea, the prelude certainly isn't very stable beyond some of the traits
[08:26:33] <Ms2ger|sad> It was a month when I started two weeks ago :)
[08:26:42] <Ms2ger|sad> But then the end of the quarter came along
[08:27:16] *** Quits: alkino_ (alkino@moz-18C36E4E.w92-151.abo.wanadoo.fr) (Ping timeout)
[08:28:09] <bourbaki> Talking about the build, is there any chance there could be a portable nightly build for Windoze on the main page?
[08:28:12] *** Joins: mib_zfzzv2 (Mibbit@B2299EEB.2827C123.984CA6B1.IP)
[08:28:22] *** Quits: mib_zfzzv2 (Mibbit@B2299EEB.2827C123.984CA6B1.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:28:46] <cmr> bourbaki: only if there's a portable mingw
[08:28:49] *** Quits: zq (user@moz-6D27B7CC.nycmny.fios.verizon.net) (Ping timeout)
[08:28:52] <cmr> (and mays 
[08:28:55] <cmr> *msys etc)
[08:29:20] <bourbaki> Cant you just put everything in the same folder?
[08:29:22] *** Quits: daschl (Adium@CB401D19.ED8EB9E6.127DF16D.IP) (Quit: Leaving.)
[08:29:48] <cmr> maybe
[08:29:52] <cmr> not sure how it all works.
[08:30:06] <klutzy> we need gcc.exe and some dlls it uses
[08:30:07] <bourbaki> http://portableapps.com/node/18601
[08:30:34] <klutzy> don't know how big the portable package is
[08:30:40] <cmr> 5 years old. you really want to be using that? :)
[08:30:41] <bourbaki> Neither do i :)
[08:30:51] <bourbaki> Nope i can dig a bit
[08:30:56] <cmr> oh, updated in 2012
[08:30:58] <cmr> that's not too awful
[08:31:17] <bourbaki> http://sourceforge.net/projects/mingw/files/MSYS/Extension/msys-portable/
[08:31:33] <bourbaki> 2013/09/15
[08:31:41] <klutzy> hmm, my mingw-w64 dir (including gcc, g++, ...) is 400MB
[08:32:25] <klutzy> but most of them are not bin/
[08:33:26] *** Quits: onelson (owen@18CF7301.95770028.5B6BFE7D.IP) (Ping timeout)
[08:34:40] *** Parts: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au) (Leaving...)
[08:35:24] *** Quits: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP) (Quit: Verlassend)
[08:35:49] <Yurume> geal: (for the record, your rustfix tool has been submitted to /r/rust and I've commented some issues about it.)
[08:36:33] *** Quits: veddan (viktor@moz-C79BC80B.csbnet.se) (Ping timeout)
[08:36:35] <klutzy> rustc itself is quite portable - it only needs libgcc_s_dw2.dll and libstdc++-6.dll
[08:36:50] <klutzy> but when you tries to compile some code, it will complain gcc.exe is missing
[08:36:52] *** Joins: veddan (viktor@moz-C79BC80B.csbnet.se)
[08:37:12] <Yurume> klutzy: is mingw-w64 modular?
[08:37:20] <klutzy> yeah
[08:37:33] <klutzy> I actually have three mingw-w64 directories
[08:37:42] <Yurume> I think there was an issue about bundling MinGW or MinGW-w64 with rustc
[08:38:07] <dsrx> if I have the rust source, can i 'make docs' without needing to build everything?
[08:38:08] <Yurume> uh, I meant whether different parts of mingw-w64 can be installed independently from others
[08:38:24] <dsrx> i just want an offline copy of docs.rust-lang.org (especially since it seems to be offline atm)
[08:38:25] <klutzy> different parts?
[08:38:36] <cmr> dsrx: no
[08:38:39] <Yurume> klutzy: linker and nothing else
[08:38:50] <cmr> also the docs are up for me
[08:38:58] <dsrx> er doc.rust-lang.org
[08:39:03] <huon> seanmonstar: did you get an answer to your question about Rc<Foo> and fn foo(x: &Foo)?
[08:39:11] <bourbaki> What do i need gcc for when i compile a rust program?
[08:39:11] *** Joins: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP)
[08:39:11] <klutzy> Yurume: ah, in that manner - no easy way I know
[08:39:32] <Yurume> klutzy: MinGW got that feature fairly recently
[08:40:27] <dsrx> cmr: http://docs.rust-lang.org/doc/0.10/std/index.html times out for me on my vps and on my laptop
[08:40:51] <cmr> hm, and now for me too
[08:41:06] * Ms2ger|sad wonders why rustc is sitting around with 1.5GiB of memory and 4% CPU
[08:41:15] <cmr> Ms2ger|sad: linking?
[08:41:29] <Ms2ger|sad> Maybe
[08:41:31] <Ms2ger|sad> Ah, it's done
[08:41:32] <klutzy> Ms2ger|sad: don't you have 25 cores?
[08:41:35] <huon> Ms2ger|sad: it's clingy
[08:41:40] <huon> it doesn't want you to forget about it
[08:41:48] *** Quits: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net) (Quit: syatchmenoff)
[08:41:51] <Ms2ger|sad> Not going to forget...
[08:42:02] * Ms2ger|sad awaits the next stage
[08:42:05] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[08:42:22] <Yurume> Ms2ger|sad: next time run it with -Z time-passes?
[08:42:27] <Ms2ger|sad> I wish the build parallelized more
[08:42:47] <Ms2ger|sad> Yurume, I hope I can avoid building it for a while now...
[08:43:05] <Yurume> ah, building rustc? :p
[08:43:12] <huon> Ms2ger|sad: maybe it's doing (what it things is) a comedy routine to try to turn your frown upside down
[08:43:13] <Ms2ger|sad> Yep
[08:43:16] <huon> *thinks
[08:43:30] <Yurume> rustc needs --progress bar!
[08:43:43] * Ms2ger|sad accidentally turns huon upside-down
[08:43:48] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[08:43:53] <Yurume> uony?
[08:44:14] * Ms2ger|sad gives Yurume a gold star
[08:44:28] <klutzy> 587M    /home/it/usr/rust-portable/
[08:44:29] <huon> uonɥ
[08:44:32] *** Joins: soumyaC (uid15286@moz-E77DEB21.irccloud.com)
[08:44:34] <klutzy> not promising but it works
[08:44:43] <huon> (unfortunately not a valid irc nick :'( )
[08:45:00] <klutzy> (just copying all necessary mingw-w64 files to rust dir)
[08:45:34] <Ms2ger|sad> Boo, 7-bit IRC
[08:47:20] <Havvy> Yeah, nicks have to be ascii. :/
[08:47:29] <jensnockert> :(
[08:47:57] <huon> really?
[08:48:00] <huon> I've been doing this wrong
[08:48:03] *** huon is now known as ascii
[08:48:19] * cmr nails ascii to the wall, in the position Ms2ger|sad left him in
[08:48:45] *** jensnockert is now known as CP-1252
[08:48:53] <CP-1252> I'm such a rebel.
[08:49:42] *** Joins: pro (Mibbit@E83CF80C.8BCEADBE.50D07B2F.IP)
[08:49:44] <ascii> so disestablishmentarianism
[08:49:45] <Ms2ger|sad> IRC long predates unicode, of course
[08:50:14] <CP-1252> Except Unicode is older.
[08:50:35] *** CP-1252 is now known as jensnockert
[08:50:58] *** Joins: alonlevy (alon@35D0453C.31F49B3D.AB64B967.IP)
[08:51:26] <jensnockert> Well, technically IRC is older than the first published version of Unicode.
[08:51:32] <jensnockert> But only slightly.
[08:52:32] <cmr> but IRC didn't exist before IRC existed
[08:52:37] <cmr> so how could they have ever discovered it?
[08:52:49] <cmr> there was no one on irc to tell them how wrong they were as they were developing it
[08:53:00] <pro> is doc.rust-lang.org down?
[08:53:05] <jensnockert> cmr: /o\
[08:53:07] <cmr> pro: seems so :(
[08:53:15] <pro> :(
[08:53:15] <cmr> awful timing too
[08:53:22] <cmr> right after a release
[08:54:04] <cmr> it's working again for me now actually
[08:54:18] *** ascii is now known as huon
[08:54:29] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[08:55:04] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[08:55:25] *** Joins: skade (skade@moz-1EC0F118.pools.arcor-ip.net)
[08:56:30] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[08:56:38] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[08:56:53] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[08:57:54] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[09:00:01] *** Joins: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za)
[09:00:17] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[09:04:25] *** Joins: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP)
[09:05:02] <dsrx> hmmmm
[09:05:30] <dsrx> ln -s /usr/local/bin/rustdoc x86_64-apple-darwin/stage2/bin && NO_REBUILD=1 make docs
[09:05:42] *** pmoore|away is now known as pmoore
[09:05:46] <dsrx> ends with an error but I seem to have docs
[09:07:21] *** Joins: jviereck (Adium@moz-2BF376BC.dclient.hispeed.ch)
[09:10:00] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[09:10:01] *** Joins: mye (mye@moz-DCAB46ED.swh.uni-giessen.de)
[09:10:15] <huon> dsrx: what's the error?
[09:10:58] <dsrx> huon: https://www.refheap.com/71539
[09:11:04] *** Quits: mye (mye@moz-DCAB46ED.swh.uni-giessen.de) (Quit: So long, and thanks for all the fish!)
[09:11:18] *** Joins: mye (mye@D3BCC65C.AFBA3AA1.FD9D6DD1.IP)
[09:11:21] <dsrx> guessing i need to add the right thing to rustdoc -L
[09:11:47] <cmr> no, that won't help.
[09:12:09] *** Joins: Earnestly (earnest@moz-6CD1AB70.dyn.plus.net)
[09:12:14] <cmr> that has to do with rustc's weird sysroot mechanism.
[09:12:19] * huon hates that
[09:12:26] *** Quits: osa1 (omer@6CFF95AB.2545CD3.3688B332.IP) (Ping timeout)
[09:12:35] <huon> (adding the appropriate -L will fix it though.)
[09:12:38] <huon> won't it?
[09:12:38] <cmr> will it?
[09:12:52] <cmr> I don't think it did last I experimented with it
[09:13:04] <cmr> maybe sysroot is less stupid now
[09:13:07] <cmr> worth trying, perhaps.
[09:13:24] <cmr> We should really offer the docs in a tarball/zip though
[09:13:30] *** Quits: alonlevy (alon@35D0453C.31F49B3D.AB64B967.IP) (Ping timeout)
[09:13:44] <cmr> or bundle them with the nightlies
[09:13:57] <cmr> I hate to burden brson with more automation/infrastructure crap :(
[09:14:14] *** Quits: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP) (Quit: Verlassend)
[09:14:34] <huon> theoretically it's just adding an extra directory to the tar invocation, right?
[09:14:37] * huon investigates
[09:15:20] *** Joins: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP)
[09:15:25] <cmr> I thought the script used to bundle up and ship off the nightlies wasn't in tree but maybe it is
[09:15:31] * cmr waits for huon to finish investigating
[09:15:51] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[09:16:06] *** Joins: heftig (heftig@moz-33D186ED.unitymedia.biz)
[09:18:31] <huon> cmr: I believe it's mk/dist.mk
[09:19:13] <cmr> ohhh so it is
[09:19:40] <huon> this is weird
[09:19:42] <cmr> oh hey the installer manifest is in there too
[09:19:50] <huon> there's a `dist` target for windows
[09:19:56] <huon> but only "dist: $(MAYBE_DIST_TAR_SRC) dist-osx dist-tar-bins dist-docs" for non-windows
[09:20:03] <huon> i.e. what's up with bsd/linux?
[09:20:18] <cmr> bsd: the unloved child
[09:20:45] <huon> and linux the forgotten one?
[09:20:54] <cmr> heh
[09:21:04] <cmr> I'm guessing dist-tar-bins does it all
[09:21:09] <cmr> and that dist-osx is just for the .pkg
[09:21:30] <cmr> the "Primary targets" comment confirms this suspisciounadfafdsj
[09:21:34] <cmr> that word is impossible to spell
[09:21:35] * cmr gives up
[09:21:53] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Ping timeout)
[09:21:58] <Ms2ger|sad> suspicion?
[09:21:58] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[09:22:05] <cmr> smells right
[09:22:22] <cmr> I swear I'm getting worse and worse at english as time goes
[09:22:24] <cmr> on
[09:22:42] <cmr> I used to be able to into communication
[09:22:43] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[09:22:51] <Ms2ger|sad> To what?
[09:23:17] <huon> cmr: ah, right
[09:23:26] <cmr> Ms2ger|sad: ;p
[09:23:53] <cmr> Ms2ger|sad: http://knowyourmeme.com/memes/polandball
[09:23:59] <Ms2ger|sad> error: can't find crate for `servo_macros`
[09:24:05] * Ms2ger|sad wonders what the hell is up with that
[09:24:10] <Ms2ger|sad> On extern crate servo_macros = "macros";
[09:24:33] <huon> Ms2ger|sad: the correct search path?
[09:24:42] <huon> (and the crate id of that other crate is macros, right?)
[09:24:59] <Ms2ger|sad> This worked before the upgrade!
[09:25:00] <huon> cmr: so, anyway, why were we looking at this?
[09:25:04] <cmr> Ms2ger|sad: you're gunna want a #[phase(syntax)] on that
[09:25:07] <huon> oh, docs
[09:25:07] <cmr> huon: bundling docs
[09:25:14] <Ms2ger|sad> #[phase(syntax)]
[09:25:14] <Ms2ger|sad> extern crate servo_macros = "macros";
[09:25:38] <cmr> mmm
[09:25:41] *** Quits: intuxicated (intuxicate@437F2EC4.5F0D1BE1.BD3E1BB3.IP) (Client exited)
[09:25:41] <Ms2ger|sad> Hmm
[09:25:42] <Ms2ger|sad> #[feature(globs, macro_rules, struct_variant, managed_boxes, phase)];
[09:25:42] <Ms2ger|sad> #[feature(phase)];
[09:25:55] <Ms2ger|sad> Would it be bad to have phase twice?
[09:26:14] *** Quits: LRN (LRN@moz-EA80C63C.nationalcablenetworks.ru) (Quit: Leaving.)
[09:26:15] <cmr> nah I don't think it cares
[09:26:34] <Ms2ger|sad> Nope
[09:26:41] *** Joins: LRN (LRN@moz-EA80C63C.nationalcablenetworks.ru)
[09:29:58] *** Quits: pro (Mibbit@E83CF80C.8BCEADBE.50D07B2F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:30:09] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[09:31:11] <Ms2ger|sad> So where does it get the search path?
[09:31:32] *** Joins: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com)
[09:31:55] <cmr> it should be the normal search path
[09:31:56] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[09:32:03] <cmr> -L plus any $RUST_PATH entries
[09:33:21] *** Joins: nkoep (nik@moz-F87FACD6.pool.mediaways.net)
[09:33:54] <huon> cmr: so... how would the html docs sanely go in a binary package?
[09:34:00] <huon> i.e. they're not man pages
[09:34:15] <cmr> huon: just a `doc` subdir?
[09:34:20] <cmr> or `doc/html`
[09:34:33] <cmr> there is precedent for this
[09:34:39] <cmr> gtk/glib distribute html docs
[09:34:41] * Ms2ger|sad finds a pageful of command line
[09:34:47] *** Quits: skade (skade@moz-1EC0F118.pools.arcor-ip.net) (Connection reset by peer)
[09:35:02] *** Joins: skade (skade@moz-1EC0F118.pools.arcor-ip.net)
[09:35:20] <huon> cmr: ok
[09:35:34] * huon will attempt to Makefile
[09:36:19] <thiez> Why are Senders not :Send?
[09:36:22] <cmr> <3
[09:36:33] <Ms2ger|sad> Oh, hmm
[09:36:36] * Ms2ger|sad reconfigures
[09:36:55] <cmr> thiez: it *should* be?
[09:37:08] <thiez> cmr: it's explicitly marked 'NoShare'
[09:37:15] <thiez> http://static.rust-lang.org/doc/master/std/comm/struct.Sender.html
[09:37:16] <cmr> thiez: Send is not Share
[09:37:34] <cmr> rusti: let (s, r) = std::comm::channel(); spawn(proc() { s.send(42i) }); s.recv()
[09:37:37] <cmr> rusti: let (s, r) = std::comm::channel(); spawn(proc() { s.send(42i) }); r.recv()
[09:37:43] -rusti- pastebinned 11 lines of output: http://ix.io/btn
[09:37:43] -rusti- 42
[09:37:48] <huon> thiez: it's unsafe to have two threads using the one Sender to send
[09:37:51] <cmr> thiez: Share just means thread-safe.
[09:38:02] <cmr> (essentially)
[09:38:13] <cmr> and has more to do with multiple-ownership
[09:38:14] <huon> it's fine having several Senders sending to the same place, but not using by the one Sender value
[09:38:22] <huon> *but not by using
[09:38:54] *** Quits: jviereck (Adium@moz-2BF376BC.dclient.hispeed.ch) (Quit: Leaving.)
[09:39:01] <geal> Yurume: thanks!
[09:39:36] <geal> the tool is not perfect, but people seemed pleased with the quantity of work it spared them, so I'm happy :)
[09:39:37] <thiez> okay basically, I'm trying to send a (T,proc(T)->U,std::comm::Sender<U>), where T:Send and U:Send, and rust tells me 'error: instantiating a type parameter with an incompatible type `(T,proc(T)->U,std::comm::Sender<U>)`, which does not fulfill `Send`
[09:39:50] <huon> proc:Send
[09:39:59] <thiez> right
[09:40:00] <cmr> thiez: proc(T):Send -> U
[09:40:02] <huon> they no longer have the default Send bound
[09:40:09] <cmr> unless that PR didn't land yet
[09:40:13] * cmr checks
[09:40:19] <cmr> it did not
[09:40:25] <cmr> https://github.com/mozilla/rust/pull/13268
[09:40:42] *** Quits: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com) (Quit: Leaving)
[09:41:20] <Ms2ger|sad> Okay, better errors!
[09:41:44] <Ms2ger|sad> cmr, huon, thanks
[09:41:53] <huon> Ms2ger|sad: we helped? :P
[09:42:04] <thiez> thansk cmr, huon, it works now :)
[09:42:07] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[09:42:27] <Ms2ger|sad> Yeah, I figured out that the search path in the Makefile.in and the one that was used from the Makefile didn't match
[09:43:49] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[09:44:18] <huon> ah, detective work :)
[09:44:33] <eddyb> why so |sad?
[09:44:43] <Ms2ger|sad> Certain news
[09:44:52] <eddyb> monads?
[09:44:56] <cmr> looool
[09:44:59] <Ms2ger|sad> dylib output requested, but some depenencies could not be found in the dylib format
[09:45:03] <Ms2ger|sad> This is going to be fun...
[09:45:12] <huon> it doesn't list the dependencies?
[09:45:16] <cmr> Ms2ger|sad: add --crate-type=rlib,dylib to *everything*
[09:45:28] <Ms2ger|sad> I think I don't have the right submodule versions on this branch
[09:45:40] <Ms2ger|sad> So I'm going to get to go through all the submodules!
[09:45:40] *** Quits: riteofpassage (RiteOfPass@FF1B00AD.C33E15E.EE6E63A5.IP) (Quit: leaving)
[09:45:40] <huon> (or `#![crate_type="rlib"] #![crate_type="dylib"]`)
[09:45:45] <eddyb> --crate-type=*lib pls
[09:45:50] *** Quits: nkoep (nik@moz-F87FACD6.pool.mediaways.net) (Quit: Leaving)
[09:45:56] <Ms2ger|sad> 27 to go
[09:46:07] <huon> Ms2ger|sad: `grep`?/`find`?
[09:46:19] * huon assumes unix tools can fix any problem
[09:46:28] <Ms2ger|sad> Not git submodules, I don't think
[09:46:46] <Ms2ger|sad> The actual changes have been made, but I need to fetch master everywhere
[09:46:57] <cmr> "git submodule update"?
[09:47:24] <cmr> but yeah
[09:47:27] <cmr> submodules are a pain
[09:47:53] *** Quits: guest2222 (guest2222@1EEF8F2.50A2C647.5A42B74E.IP) (Ping timeout)
[09:50:32] *** pmoore is now known as pmoore|brb
[09:51:36] *** Joins: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl)
[09:51:57] <aochagavia> I am updating some code from 0.9 to 0.10 and have some questions
[09:52:07] <cmr> sure
[09:52:20] <aochagavia> I use a hashset, which was located in std::hashmap
[09:52:26] <cmr> collections::HashSet
[09:52:28] <aochagavia> I know that it is now in collections
[09:52:28] *** Quits: skade (skade@moz-1EC0F118.pools.arcor-ip.net) (Ping timeout)
[09:52:29] <aochagavia> but...
[09:52:34] <cmr> (;p)
[09:52:42] <aochagavia> if I use "use collections::hashmap::HashSet"
[09:52:49] <aochagavia> i get an error
[09:53:10] <cmr> You should `use collections::HashSet;`
[09:53:19] <cmr> all of the datastructures are reexported at the root
[09:53:22] *** Joins: mib_dcn8zi (Mibbit@moz-1ED3BE61.hsd1.ca.comcast.net)
[09:53:31] <cmr> What error are you getting though?
[09:53:45] <aochagavia> that doesn't work either
[09:53:56] <aochagavia> unresolved import
[09:54:09] *** Quits: mib_dcn8zi (Mibbit@moz-1ED3BE61.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[09:54:15] <cmr> hm
[09:54:27] <aochagavia> I get a suggestion: "maybe a missing extern crate?"
[09:54:35] <cmr> do you have `extern crate collections;`?
[09:54:54] <aochagavia> no
[09:55:01] *** Joins: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com)
[09:55:06] <aochagavia> do I have to include that?
[09:55:08] <cmr> yes.
[09:55:17] <cmr> you always need `extern crate foo;` to link to the `foo` crate.
[09:55:26] <cmr> `std` is the only one that's present by default.
[09:55:54] <aochagavia> I thought it would be done automatically...
[09:56:00] <cmr> http://static.rust-lang.org/doc/master/tutorial.html#crates-and-the-module-system
[09:56:01] *** Joins: stumpart (Mibbit@moz-93393D0A.hsd1.ca.comcast.net)
[09:57:27] <aochagavia> is there work going on in the module system
[09:57:34] <aochagavia> i?
[09:57:36] <aochagavia> *?
[09:57:36] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[09:57:41] <cmr> not really.
[09:57:58] *** Quits: stumpart (Mibbit@moz-93393D0A.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[09:58:27] <aochagavia> because it looks a little bit complicated
[09:58:39] <cmr> it is.
[09:58:49] <aochagavia> if you compare with other languages
[09:59:03] <cmr> there is https://github.com/rust-lang/rfcs/pull/18 open
[09:59:19] <doomlord_> steep learning curve but its good when you know how it works
[10:00:16] *** Joins: vgeddes (vincent.ge@moz-102C6E36.access.mtnbusiness.co.za)
[10:00:47] *** Joins: oberstet (quassel@moz-B47F62FA.dynamic.mnet-online.de)
[10:01:14] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[10:01:57] <aochagavia> what kind of benefits do you get from it?
[10:02:33] <doomlord_> nested modules do the job half done by classes and half done by namespaces, a bit cleaner
[10:03:40] *** pmoore|brb is now known as pmoore|away
[10:04:20] <aochagavia> and from things like extern?
[10:04:42] <doomlord_> extern is just splitting into libraries which can be compiled/distributed seperately
[10:05:00] <doomlord_> ^importing seperate units of compilation
[10:05:30] <doomlord_> within a module, its just internal organization (namespacing &  visibility)
[10:05:54] <kimundi> Btw, short version: mod == declare new modules in your crate, extern crate == link to existing library; use == create a shortcut to a definition. Paths in a `use` are absolute, that is relative to the crate root, because that's where you are defining the shortcuts to, while paths everywhere else are relative to the current module because they also use these shortcuts.
[10:05:55] <Ms2ger|sad> error: mismatched types: expected `&[&[u8]]` but found `[~[u8], .. 1]` ([] storage differs: expected `&` but found `~`)
[10:06:03] * Ms2ger|sad grumbles
[10:06:18] *** Quits: mno2 (mno2@E1E0A0A3.621D86F0.CFF65E33.IP) (Quit: mno2)
[10:07:08] *** Joins: redShadow (redShadow@9BDAF02B.D15F9219.1CCF65D9.IP)
[10:07:11] <aochagavia> What is SipHasher in HashSet?
[10:07:16] <aochagavia> that is something new
[10:07:37] <huon> yes, it allows for substituting different hashing algorithms
[10:07:47] <Ms2ger|sad> error: dylib output requested, but some depenencies could not be found in the dylib format
[10:07:47] <Ms2ger|sad> note: dylib not found: xlib
[10:07:48] <huon> e.g. specialised ones for certain usecases
[10:07:52] <Ms2ger|sad> depenencies, eh
[10:08:16] <doomlord_> are there any other attempts at an automatic c++ binder , i suppose there's swig.. i'd seen "rust-bindgen"
[10:08:48] <cmr> aochagavia: see also  https://mail.mozilla.org/pipermail/rust-dev/2014-February/008766.html
[10:08:53] *** Quits: p1start (rewi@moz-E7F3D014.org) (Ping timeout)
[10:09:09] <aochagavia> what do I have to do if I just want the default hashing algorithm?
[10:09:17] <huon> aochagavia: nothing
[10:09:25] <huon> HashSet<T> works fine
[10:09:32] <huon> due to default type parameters
[10:09:34] <aochagavia> ok
[10:10:16] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Ping timeout)
[10:10:31] *** Joins: skade (skade@moz-A9554E46.web.vodafone.de)
[10:10:43] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[10:11:14] <aochagavia> I get an error with this code: https://gist.github.com/aochagavia/48f8208141455ed3a1fa
[10:11:30] <aochagavia> "Use of undeclared type HashSet"
[10:11:33] <cmr> you need to `use collections::HashSet`
[10:11:37] <cmr> to bring the name into scope.
[10:12:06] <cmr> or otherwise qualify it in the struct as `possible_numbers: collections::HashSet<int>`
[10:12:08] <aochagavia> ok, thanks!
[10:12:11] <cmr> you really do not want that second ()
[10:12:15] <cmr> it doesn't do what you think it does
[10:13:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:13:39] <aochagavia> I have removed it
[10:13:55] <aochagavia> I thought that it was needed to set default hashing
[10:13:59] <cmr> nope
[10:14:07] <cmr> default really means default, it doesn't need to be specified.
[10:14:16] <cmr> `()` means "use the unit type"
[10:14:24] <aochagavia> ok
[10:14:38] <aochagavia> I still have that problem with unresolved import
[10:14:46] <aochagavia> the gist was a simplification
[10:14:53] <aochagavia> that one does work
[10:15:12] <cmr> ok, gist your actual code then?
[10:15:20] <aochagavia> ok
[10:15:23] *** Quits: redShadow (redShadow@9BDAF02B.D15F9219.1CCF65D9.IP) (Input/output error)
[10:15:24] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:16:29] <aochagavia> https://gist.github.com/aochagavia/93dbd5fa3f26f2080a8b
[10:17:28] <cmr> oh, different error.
[10:17:51] <cmr> replace .to_owned_vec() with .collect::<Vec<int>>()
[10:18:22] <cmr> .collect::<Vec<int>>().as_slice()
[10:18:23] <cmr> actually
[10:18:54] <cmr> that could be more efficient, you really only need to call .next() on the iterator twice, make sure the second one is None, and then unwrap the first one.
[10:20:34] <huon> let it =  self.possible_numbers.iter(); match (it.next(), it.next()) { (Some(a), None) => *a, _ => fail!(...) }
[10:20:37] <Ms2ger|sad> match (iter.next(), iter.next()) { (Some(x), None) => ..., _ => fail!() }?
[10:20:40] <Ms2ger|sad> Ha
[10:20:46] * huon was it
[10:20:49] <Ms2ger|sad> *let mut it
[10:20:57] <Novacha> Would anyone happen to know where to docs for <'a> are? I see it used a lot in the standard library
[10:21:08] <Ms2ger|sad> Search for "lifetime"
[10:21:21] <cmr> Novacha: http://static.rust-lang.org/doc/master/guide-lifetimes.html
[10:21:28] <huon> https://github.com/mozilla/rust/wiki/The-Rusticon
[10:21:45] <huon> (the section at the bottom is good for syntax)
[10:21:59] <Novacha> cmr, Ms2ger|sad: Thanks
[10:22:04] <Ms2ger|sad> Np
[10:22:48] *** Quits: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP) (Quit: brendan)
[10:23:13] <aochagavia> thank you!
[10:23:27] *** pmoore|away is now known as pmoore
[10:23:46] <Ms2ger|sad> Is it possible that [ source_string.as_bytes() ] used to coerce to &[&[u8]] but no longer does?
[10:24:05] <huon> Ms2ger|sad: yes, it's possible (&[...] should work)
[10:24:18] <Ms2ger|sad> Er
[10:24:25] <Ms2ger|sad> Sorry, wrong snippet
[10:24:31] <Ms2ger|sad> [ source_string.as_bytes().to_owned() ]
[10:24:31] <huon> hah
[10:24:37] <huon> yes, it's possible
[10:24:39] *** Joins: SpaceWizard (Apollo@moz-E6F82C3A.maine.res.rr.com)
[10:24:52] <huon> [source_string.as_bytes()] should work
[10:24:54] <cmr> would that actually have coerced? ~[] doesn't coerce to &[] when nested
[10:25:06] <huon> (... unless you start mutating source_string)
[10:25:21] <Ms2ger|sad> It seems to compile right now
[10:25:36] <Ms2ger|sad> I say seems because it's a call from within one submodule to an API in another
[10:26:17] *** Joins: stumpart (barrington@moz-93393D0A.hsd1.ca.comcast.net)
[10:29:07] *** Joins: doskey (daniel@moz-82F8E8BD.adsl.012.net.il)
[10:30:25] <aochagavia> I have still some problems with the imports
[10:30:28] <aochagavia> look here: https://gist.github.com/aochagavia/70ff7a67034523b3898a
[10:30:58] *** Quits: benjamin_ (benjamin@moz-3A224608.dip0.t-ipconnect.de) (Ping timeout)
[10:30:59] <doskey> Does anyone know the new syntax for linking against native libraries? What used to be --link-args="-l..."
[10:31:03] <cmr> `use` is relative to the root of the crate
[10:31:06] <huon> aochagavia: `use` is from the root of the crate, and `extern crate ...;` introduce the name in the current module
[10:31:09] *** Quits: TinFox (TinFox@F3D0A69D.9F4E79F1.F7512391.IP) (Ping timeout)
[10:31:10] <cmr> so you need `use self::collections::...`
[10:31:14] <cmr> doskey: -C link-args="..."
[10:31:24] <aochagavia> self???
[10:31:26] <huon> so the "real" path to collections is `test::collections::...`
[10:31:30] *** Parts: stumpart (barrington@moz-93393D0A.hsd1.ca.comcast.net) ()
[10:31:41] <aochagavia> ok...
[10:31:41] <huon> you can use `self::...` in an import to act like `./...` on the filesystem
[10:31:44] <huon> i.e. make it relative
[10:31:45] <cmr> aochagavia: yes, it means that path is relative to the current module.
[10:31:51] <aochagavia> ok
[10:31:55] <huon> you can also just put the `extern crate` in your main module
[10:31:59] <huon> (I recommend this)
[10:32:10] <huon> then `use collections::...` will work everywhere
[10:32:24] <doskey> cmr: Thanks! The documentation really needs to be updated...
[10:32:29] <aochagavia> ok...
[10:32:39] <cmr> doskey: which part is out of date?
[10:32:42] <aochagavia> this is really strange
[10:33:26] <doskey> cmr: The only place in the documentation that even talks about it, uses the old #[link ...] syntax
[10:33:36] <cmr> doskey: http://static.rust-lang.org/doc/master/guide-ffi.html#linking is up to date.
[10:33:46] <huon> doskey: that's the new #[link] syntax
[10:33:57] <cmr> #[link(...)] is used to link to libs now, not as a crate attribute.
[10:33:57] <huon> there were two; the one on the extern blocks is modern.
[10:34:42] <Yurume> geal: yeah! actually you can go surprisingly further with a search-and-replace approach. (sorry for late reply)
[10:34:45] *** Joins: TinFox (TinFox@F3D0A69D.9F4E79F1.F7512391.IP)
[10:34:52] <doskey> huh, then my fault, I guess I was using it incorrectly
[10:35:03] <cmr> well, not entirely your fault.
[10:35:10] <cmr> it has no examples.
[10:35:12] * cmr adds example.
[10:35:23] <cmr> oh, there are examples in the code blocks above.
[10:36:22] <doskey> cmr: so what is the difference between #![..] and #[..]?
[10:36:38] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[10:37:22] *** Quits: mawuli (mawuli@2760A9B5.4882C7ED.DE15C958.IP) (Connection timed out)
[10:37:35] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[10:37:49] *** Quits: pzol (pzol@86821BC.DEB41A6D.AADC76B.IP) (Ping timeout)
[10:37:51] <aochagavia> how do you solve trait implementation conflicts?
[10:37:56] *** Joins: mawuli (mawuli@2760A9B5.4882C7ED.DE15C958.IP)
[10:38:08] <huon> doskey: #![...] attaches to the containing thing and #[...] attaches to the next thing (e.g. `mod foo { #![bar] fn baz() {} }` puts the bar attribute on the foo module, but without the ! it would go on the baz function)
[10:38:14] <Havvy> huon:  quotes.burntelectrons.org/7251
[10:38:15] <aochagavia> I have implemented ToStr for a struct, but it says there is a conflict because it is also defined by std
[10:38:18] <huon> aochagavia: delete one of them
[10:38:34] <doomlord_> you need to make your own trait
[10:39:09] <doomlord_> ToStr gets generated i ithink ?
[10:39:15] *** Joins: pzol (pzol@86821BC.DEB41A6D.AADC76B.IP)
[10:39:29] <doomlord_> (Show ? #[deriving(Show)] .. ?)
[10:39:35] <aochagavia> I just want to override it
[10:39:38] <cmr> aochagavia: you cannot implement ToStr anymore.
[10:39:42] <cmr> aochagavia: you should instead implement Show.
[10:39:48] <aochagavia> ok, thanks
[10:39:52] <cmr> ToStr automatically uses the `Show` you define
[10:39:58] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:39:59] *** ChanServ sets mode: +o pnkfelix
[10:40:23] *** Joins: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP)
[10:40:24] <aochagavia> the only problem is now...
[10:40:25] *** Joins: patpatter (patpat@moz-21619C28.as13285.net)
[10:40:33] <aochagavia> "Attempt to implement an unexistent trait"
[10:40:52] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[10:41:15] <huon> aochagavia: which trait?
[10:41:22] <huon> Havvy: not loading for me :(
[10:41:29] <Havvy> :(
[10:41:37] *** Joins: mib_duqxrt (Mibbit@moz-4058A5B9.ge-0-2-0-712.arcnqu2.dk.customer.tdc.net)
[10:42:04] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[10:42:51] <doskey> huon: Thanks!
[10:43:48] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Ping timeout)
[10:43:56] <aochagavia> Show
[10:44:32] <huon> you'll need to import it from `std::fmt::Show`
[10:44:46] <huon> http://static.rust-lang.org/doc/master/std/fmt/index.html#formatting-traits has an example
[10:44:52] <huon> (scroll down a little)
[10:46:03] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:46:09] <aochagavia> thanks
[10:48:35] <cmr> Does anyone have some up to date, fair benchmarks comparing with C or C++?
[10:48:44] <huon> cmr: fasta?
[10:48:53] <cmr> do we win in it?
[10:49:02] <huon> easily
[10:49:06] <cmr> yay!
[10:49:12] <huon> http://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=fasta&lang=all&id=1&data=u64
[10:49:21] <huon> oh, huh?
[10:49:46] <huon> things seem to have changed :(
[10:49:48] <darnuria> We don't win. :o
[10:50:19] <huon> we used to be at 3.8 (i.e. 3rd behind haskell)
[10:50:28] <darnuria> http://benchmarksgame.alioth.debian.org/u64/program.php?test=fasta&lang=rust&id=1
[10:50:30] <cmr> ouchy
[10:50:37] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[10:50:37] <huon> looks like we got slower with the update to 0.10 :(
[10:50:52] <doomlord_>  i would have thought it would be the same when everything's working right . 
[10:50:54] *** Quits: patpatter (patpat@moz-21619C28.as13285.net) (Ping timeout)
[10:51:07] <huon> (lol, http://benchmarksgame.alioth.debian.org/u64/program.php?test=fasta&lang=rust&id=1#log it's not even warning free)
[10:51:16] *** Joins: alonlevy (alon@moz-99593F16.pop.bezeqint.net)
[10:51:32] <aochagavia> are DST incorporated in 0.10?
[10:51:34] <huon> doomlord_: rust has stronger type guarantees that C/C++ so theoretically we can be faster
[10:51:35] <cmr> aochagavia: no.
[10:51:47] *** Quits: phay (phay@16E8BAAB.D2C4A785.91986DB5.IP) (Quit: phay)
[10:51:48] * huon invokes sufficiently-smart-compiler
[10:51:57] <doomlord_> properly optimized c++ will have workarounds, it'll be messier though
[10:52:29] <doomlord_> 'its not how fast you are its how long your fast' i guess, or something like that
[10:52:46] <doomlord_> ^you're
[10:53:56] <doomlord_> ok so i gather 'fortran' has the aliasing rules that are the same as 'restrict' everywhere which is why its ahead of c++, perhaps its auto vectorizing better too
[10:54:34] <doomlord_> they must be saying 'standard c++' , rather than with platform specific compiler intrinsics & tweaks (i gather the actual c++ standard doesn't have restrict, its just added by platform vendors who need it..)
[10:55:41] *** Joins: oxum (anonymous@BE6B085.E5EFB142.520CDC98.IP)
[10:55:53] *** Joins: FrozenCow (FrozenCow@moz-54300F7F.upc-j.chello.nl)
[10:55:59] <darnuria> http://benchmarksgame.alioth.debian.org/u64q/benchmark.php?test=all&lang=rust&lang2=gpp&data=u64q Not so bad for an heavely devellopement language.
[10:56:14] <cmr> eugh
[10:56:21] <cmr> not faster, 10x slower at worst
[10:56:31] <Yoric> still reasonable
[10:56:34] <darnuria> `Not so bad` ;p
[10:56:35] <cmr> ouch mandelbrot hurts a lot.
[10:56:49] <darnuria> Maybe the implementation is the problem.
[10:57:07] <huon> better than 2000x as pidigits used to be :P
[10:57:20] <cmr> yeah
[10:57:22] <cmr> this is true
[10:57:48] <huon> we're not buffering for mandlebrot
[10:57:50] *** Quits: skade (skade@moz-A9554E46.web.vodafone.de) (Connection reset by peer)
[10:57:52] <doomlord_> but are these all safe code, with bounds checking etc.. vs unsafe c++
[10:57:55] <huon> fix that, and we'll be super fast
[10:58:05] <cmr> darnuria: want to fix that? :)
[10:58:23] *** Quits: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl) (Quit: Computer gone to sleep - Zzzz...)
[10:58:25] <huon> ~BufferedReader::new(std::io::stdout()) as ~Writer
[10:58:27] <huon> should be enough
[10:58:29] *** Quits: bourbaki (luesebrink@moz-8B9D6A18.dip0.t-ipconnect.de) (Connection reset by peer)
[10:59:09] <santiago> Does range() in a for loop really create an iterator? Or is that optimized away? 
[10:59:15] <cmr> santiago: usually optimized away.
[10:59:16] <huon> santiago: yes, and yes
[10:59:42] <huon> (an "iterator" is just a (generally) small struct with a .next() method, it's not some complicated thing like generators in python)
[10:59:43] *** Quits: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[11:00:09] <santiago> Sure. But calling a method is more work than incrementing an int by one. 
[11:00:13] <darnuria> cmr: I will look at it. But I promise nothing.
[11:00:19] <huon> santiago: optimisers are magical
[11:00:23] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:00:33] <doomlord_> most of the time shouldn't you basically be able to get a peice of c++ and a peice of rust and get the same asm, if you really want it. (unsafe stack hack? unsafe array access?)
[11:00:37] <cmr> santiago: not after inlining.
[11:00:41] <huon> (i.e. it will easily easily inline the method, optimising to the same thing as C/C++'s for(...))
[11:01:05] <santiago> Is there a way to output assembly with any sort of line markers or anything in it? 
[11:01:10] <kimundi> santiago: plain struct + static dispatch + inlining + optimization = identical assembly to a plain c-like for loop incrementing a integer
[11:01:29] *** Joins: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP)
[11:01:39] <cmr> santiago: well, you can use -g and look at the disassembly in gdb.
[11:01:47] <huon> -Z asm-comments
[11:01:59] <huon> but I don't think that necessarily has line markers
[11:02:24] <darnuria> outch the pidigit haskell implem is... `rude` http://benchmarksgame.alioth.debian.org/u32q/program.php?test=pidigits&lang=ghc&id=4
[11:02:28] <huon> (i.e. `rustc --emit=asm -Z asm-comments foo.rs`)
[11:02:32] <SiegeLord> Are default type bounds implemented? I recall talk about them...
[11:02:40] <cmr> huon: that doesn't actually do anything.
[11:02:41] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[11:02:43] <cmr> SiegeLord: default *bounds*? No.
[11:02:44] <huon> cmr: eh?
[11:02:49] <cmr> just default type parameters.
[11:02:50] <huon> it did last time I checked
[11:02:55] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[11:03:05] <SiegeLord> Err, that's what I meant... different meaning of bound
[11:03:16] <SiegeLord> What is the syntax?
[11:03:27] <cmr> huon: looking at asm right now, the only difference is #APP and #NO_APP at certain points...
[11:03:33] <santiago> -Z asm-comments appears to just add a bunch of # InlineAsm Start/End comments. 
[11:03:34] <huon> cmr: oh, it broke :(
[11:03:43] <huon> santiago: yeah, looks like it's broken... :/
[11:04:00] <cmr> SiegeLord: http://static.rust-lang.org/doc/master/src/collections/home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libcollections/hashmap.rs.html#676-691 is an example.
[11:04:19] * huon <3 our nice short doc source urls
[11:04:24] <cmr> I know right
[11:04:48] <cmr> because we need the *entire path* in the spans, right? :\
[11:04:57] <huon> darnuria: "rude"?
[11:06:05] <eddyb> maybe they meant "crude"?
[11:06:17] <eddyb> yay Perl
[11:07:06] <SiegeLord> Hmm, experimental feature error uses the wrong attribute syntax
[11:07:26] <SiegeLord> And it doesn't work
[11:07:26] <huon> SiegeLord: fix it
[11:07:28] <SiegeLord> Sad day
[11:07:45] <huon> src/librustc/front/feature_gate.rs
[11:07:45] *** Quits: alonlevy (alon@moz-99593F16.pop.bezeqint.net) (Ping timeout)
[11:07:49] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[11:07:56] <SiegeLord> fn test<T=int>(a: Option<T>) doesn't accept test(None)
[11:08:24] *** Quits: fabiand (fabiand@C7E0159D.8B38C502.16E13E53.IP) (Quit: Verlassend)
[11:08:29] <eddyb> ugh
[11:08:30] <huon> rusti: fn test<T = int>(_: Option<T>) {} test(None)
[11:08:40] -rusti- pastebinned 8 lines of output: http://ix.io/bto
[11:08:50] <eddyb> SiegeLord: to make that work, you'd need to implement inference fallbacks or "weak" hints
[11:08:54] <darnuria> huon: not beautifull*
[11:08:59] <cmr> rustilite: #![feature(default_type_params)] fn test<T = int>(_: Option<T>) { } test(None)
[11:09:00] -rustilite- <anon>:1:69: 1:73 error: expected item but found `test`
[11:09:00] -rustilite- <anon>:1 #![feature(default_type_params)] fn test<T = int>(_: Option<T>) { } test(None)
[11:09:00] -rustilite-                                                                              ^~~~
[11:09:00] -rustilite- playpen: application terminated with error code 101
[11:09:10] <cmr> rustilite: #![feature(default_type_params)] fn test<T = int>(_: Option<T>) { } fn main() { test(None); }
[11:09:10] -rustilite- <anon>:1:86: 1:90 error: cannot determine a type for this expression: unconstrained type
[11:09:10] -rustilite- <anon>:1 #![feature(default_type_params)] fn test<T = int>(_: Option<T>) { } fn main() { test(None); }
[11:09:11] -rustilite-                                                                                               ^~~~
[11:09:11] -rustilite- error: aborting due to previous error
[11:09:12] -rustilite- playpen: application terminated with error code 101
[11:09:17] *** Joins: jviereck (Adium@moz-96AC4C0A.ethz.ch)
[11:09:17] <cmr> rustilite: #![feature(default_type_params)] fn test<T = int>(_: Option<T>) { } fn main() { test(None::<uint>); }
[11:09:19] <eddyb> SiegeLord: I have no clue where to start in HM
[11:09:20] <huon> darnuria: the rust version, or the haskell version?
[11:09:25] <darnuria> huon: Haskell one.
[11:09:30] <darnuria> (pidigit)
[11:09:57] <huon> darnuria: I assume the person who wrote it wasn't trying to make it look good
[11:10:01] <eddyb> SiegeLord: is it even a normal thing to have?
[11:10:16] <huon> given they've written `  where k = j+1; t@(n,a,d)=k&s; (q,r)=(n*3+a)`divMod`d` :/
[11:10:25] <darnuria> huon: Yep I tried to make both then fastest and tiniest. ;)
[11:10:31] <darnuria> both the*
[11:10:51] <cmr> huon: with a small edit they could write "gonad" or "monad"!
[11:11:15] <huon> Havvy: hahaha, burntelectrons loads for me now
[11:11:56] <darnuria> Maybe caching the string on our benchmark and printing it at end could help. :)
[11:12:02] <huon> cmr: haha
[11:12:09] <eddyb> QDB?
[11:12:11] <huon> darnuria: that's effectively what a BufferedWriter does
[11:12:13] <eddyb> is that like bash.org?
[11:12:27] <huon> y
[11:12:29] <Ms2ger|sad> y
[11:12:37] <eddyb> down for me
[11:12:49] <darnuria> huon: Hmm Ok. I will look at the doc about it.
[11:13:05] <eddyb> huon: in this day and age, I prefer http://www.reddit.com/r/shittyircquotes/
[11:13:22] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[11:13:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:14:00] <darnuria> huon: Ok i see ;)
[11:14:26] *** Quits: james4k (james@moz-9BB5AE72.consolidated.net) (Ping timeout)
[11:14:53] *** Quits: jviereck (Adium@moz-96AC4C0A.ethz.ch) (Quit: Leaving.)
[11:15:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:15:45] *** Quits: Ms2ger|sad (Ms2ger@moz-98421F60.adsl-dyn.isp.belgacom.be) (Quit: bbl)
[11:15:47] <SiegeLord> eddyb: It happens every time you have a parametrized Option
[11:15:53] <SiegeLord> The None case becomes a pain to use
[11:16:18] <eddyb> SiegeLord: in the default type param case, it's tricky
[11:16:26] <SiegeLord> So I don't use it Option and make a separate function... but I thought default parameters would help
[11:16:30] <eddyb> yes, we could use that information, but... how?
[11:16:52] <cmr> when type inference fails try the default?
[11:17:00] <eddyb> but what is the default?
[11:17:03] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[11:17:05] <eddyb> we're talking *inference* here
[11:17:08] <cmr> int?
[11:17:15] <eddyb> cmr: why?
[11:17:21] <cmr> because fn foo<T=int> ?
[11:17:26] <SiegeLord> In my real case, it'd be <T, IT: Iterator<T>>(Option<IT>), so it's even worse
[11:17:31] <eddyb> cmr: that's just one function call
[11:17:40] <cmr> I don't see how that is relevant.
[11:17:54] <eddyb> cmr: inference works with disorganized information
[11:18:04] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[11:18:08] <cmr> if inference fails, look at the def of the typaram. if there's a default, substitute it in.
[11:18:54] <eddyb> I guess the simplest thing to do is to collect "weak hints" from type params that have defaults and have been substituted with ty_infer
[11:19:02] <eddyb> maybe ty_infer could hold a default
[11:19:06] <eddyb> hmmmm
[11:19:11] <eddyb> cmr: what if you unify defaults?
[11:19:19] <cmr> it looks really simple to me.
[11:19:24] <cmr> resolve.rs, L229
[11:19:29] <eddyb> resolve? lol
[11:19:31] <cmr> instead of erroring, substitute the default.
[11:19:42] <cmr> src/librustc/middle/typeck/infer/resolve.rs
[11:19:42] <eddyb> cmr: what does this have anything to do with resolution?
[11:19:47] <eddyb> aaaah that one
[11:19:59] <eddyb> cmr: where is the default?
[11:20:01] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[11:20:06] <eddyb> you can't see it, you can't smell it
[11:20:14] <eddyb> it could be at the other end of the rainbow
[11:20:21] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[11:20:36] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[11:20:54] <cmr> the t could hold it
[11:20:59] <cmr> we can always put it somewhere
[11:21:05] <cmr> I fail to see how this is so hard...
[11:21:13] <eddyb> (though I have been forming a solution. you can probably apply glb/lub/etc. on defaults. hmm)
[11:21:28] <eddyb> cmr: any ty::t? no that's not sane
[11:21:54] *** Joins: Kruppe (user@moz-1E8003E1.dsl.teksavvy.com)
[11:22:01] *** Joins: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP)
[11:23:11] <eddyb> I guess Bounds could hold it
[11:23:30] *** Joins: fabiand (fabiand@91363941.5291F4C0.16E13E53.IP)
[11:23:44] *** Joins: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de)
[11:24:44] <eddyb> cmr: unify.rs
[11:24:48] <eddyb> my head is spinning already
[11:24:49] <cmr> eddyb: I'm not in the business of sanity, I'm in the business of working features :p
[11:25:03] <darnuria> cmr: http://kib2.free.fr/pastebin/view_paste.php?id=234 not so easy.
[11:25:10] <eddyb> cmr: that's why you did what you did to huon earlier?
[11:25:20] *** Joins: mib_xcav3i (Mibbit@moz-BC35B421.pppoe.spdop.ru)
[11:25:53] <SiegeLord> So when do default types work?
[11:26:03] <cmr> SiegeLord: when they aren't inferred.
[11:26:10] <SiegeLord> Just when they are on a type?
[11:26:27] <SiegeLord> Can I make my own option type with a default type?
[11:26:29] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Client exited)
[11:27:10] <huon> darnuria: it should be BufferedWriter (not Reader), I think I typoed before
[11:27:21] *** Joins: qwerty_nor (Thunderbir@A5447B90.EDC74FC5.E19950A4.IP)
[11:27:27] <huon> SiegeLord: HashMap & HashSet have default types that work
[11:27:36] <cmr> rustilite: #![feature(default_type_params)] enum Maybe<T = int> { Just(T), Nothing } fn main() { let x: () = Nothing; }
[11:27:37] -rustilite- <anon>:1:99: 1:106 error: mismatched types: expected `()` but found `Maybe<<generic #1>>` (expected () but found enum Maybe)
[11:27:37] -rustilite- <anon>:1 #![feature(default_type_params)] enum Maybe<T = int> { Just(T), Nothing } fn main() { let x: () = Nothing; }
[11:27:37] -rustilite-                                                                                                            ^~~~~~~
[11:27:37] -rustilite- error: aborting due to previous error
[11:27:39] -rustilite- playpen: application terminated with error code 101
[11:27:47] <huon> (you may not have even known they had an extra param...)
[11:27:57] <eddyb> huon: Nothing::<>
[11:28:03] <cmr> rustilite: #![feature(default_type_params)] enum Maybe<T = int> { Just(T), Nothing } fn main() { let x: () = Nothing::<>; }
[11:28:04] <eddyb> (to get the default)
[11:28:04] -rustilite- <anon>:1:99: 1:110 error: mismatched types: expected `()` but found `Maybe<<generic #1>>` (expected () but found enum Maybe)
[11:28:04] -rustilite- <anon>:1 #![feature(default_type_params)] enum Maybe<T = int> { Just(T), Nothing } fn main() { let x: () = Nothing::<>; }
[11:28:04] -rustilite-                                                                                                            ^~~~~~~~~~~
[11:28:04] -rustilite- error: aborting due to previous error
[11:28:06] -rustilite- playpen: application terminated with error code 101
[11:28:11] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[11:28:12] <eddyb> wait, no, that doesn't work
[11:28:16] <eddyb> it's ignored :/
[11:28:24] <cmr> rustilite: #![feature(default_type_params)] enum Maybe<T = int> { Just(T), Nothing } fn main() { let mut x = Nothing; x = Just(42); }
[11:28:30] -rustilite- pastebinned 6 lines of output: http://ix.io/btp
[11:28:51] <cmr> rustilite: #![feature(default_type_params)] #[deriving(Show)] enum Maybe<T = u8> { Just(T), Nothing } fn main() { let mut x = Nothing; x = Just(42); x }
[11:28:55] -rustilite- pastebinned 5 lines of output: http://ix.io/btq
[11:29:04] <cmr> rustilite: #![feature(default_type_params)] #[deriving(Show)] enum Maybe<T = u8> { Just(T), Nothing } fn main() { let mut x = Nothing; x = Just(42); println!("{}", x); }
[11:29:07] -rustilite- pastebinned 4 lines of output: http://ix.io/btr
[11:30:06] <cmr> SiegeLord: and if we had HKT, your custom option could even get all the useful methods Option has too!
[11:30:20] *** Quits: WebeWizard (WebeWizard@moz-7CCD1DAE.ks.ks.cox.net) (Client exited)
[11:30:44] <SiegeLord> Err... I wonder how :P
[11:30:54] <huon> I realised (yet another) reason why Monad/Functor might not work so well for Rust
[11:31:13] <huon> we have too many closure types and different Monad/Functor instances want different onces
[11:31:15] <huon> *ones
[11:31:19] <SiegeLord> enum MyMeal<T> {Meat<T>, Potatoes}; let a = Meat; a.is_none()
[11:31:22] <SiegeLord> That's just nonsensical :P
[11:31:27] <huon> e.g. Future wants a proc, Iterators want ||
[11:31:34] <huon> Option wants stack-once
[11:31:36] <huon> etc.
[11:31:38] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[11:31:54] <cmr> that is a problem.
[11:32:07] <huon> SiegeLord: I think cmr was referring to things like .and_then
[11:32:18] <SiegeLord> Yeah, I guess that's not in the set of useful methods
[11:32:24] <SiegeLord> Except those are the methods I usually use ;P
[11:32:25] <SiegeLord> And map
[11:32:31] * cmr just uses == None
[11:32:37] <huon> map is just a special case of and_then :P
[11:32:46] <huon> cmr: requires the contents is Eq
[11:33:04] <cmr> *shrug* my contents are usually eq :p
[11:33:04] <huon> (probably) creates more code for nontrivial content types too
[11:33:15] <cmr> yeah
[11:33:16] <huon> at least until the optimiser kicks in
[11:33:18] <cmr> probably not ideal..
[11:33:29] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[11:33:30] * cmr notes to stop using == None
[11:34:23] <huon> cmr: https://github.com/mozilla/rust/pull/13309
[11:34:52] <cmr> 7M of docs! that's absurd.
[11:36:12] <SimonSapin> Yurume: Hi. What Rust version are you tracking in rust-encoding@master ?
[11:36:35] *** Quits: fabiand (fabiand@91363941.5291F4C0.16E13E53.IP) (Quit: Verlassend)
[11:36:41] <huon> cmr: $ du -s doc => 93820   doc
[11:37:00] <eddyb> cmr: okay, I think the magic is in lattice.rs
[11:38:17] <huon> cmr: we have individual files 6197 files in doc/...
[11:38:18] *** Joins: zq (user@moz-6D27B7CC.nycmny.fios.verizon.net)
[11:38:31] * huon retroactively reorders that sentence
[11:38:52] <eddyb> set_var_to_merged_bounds
[11:39:14] *** Joins: asmyers (quassel@2D30C89C.A07F7734.FAA4474F.IP)
[11:39:39] <eddyb> needs to merge defaults
[11:39:43] *** Quits: zq (user@moz-6D27B7CC.nycmny.fios.verizon.net) (Quit: leaving)
[11:41:48] *** Quits: mib_xcav3i (Mibbit@moz-BC35B421.pppoe.spdop.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[11:42:03] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[11:42:09] *** Joins: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com)
[11:43:11] <cmr> eddyb: see? I just manipulated you into fixing bugs ;p
[11:43:19] <cmr> "no that's not hard!"
[11:43:31] <eddyb> it still is hard
[11:43:31] *** Quits: happy-dude (Adium@moz-971AE571.alaures.clients.pavlovmedia.com) (Quit: Leaving.)
[11:43:39] <eddyb> the difference is that I kinda know what I'd have to do
[11:44:02] <eddyb> heeey next_ty_var_id
[11:44:36] <darnuria> huon: Yep I corrected it. but stdout() is actually already linebuffered. So using stdout_raw should be better?
[11:44:44] <eddyb> that inserts Root(Bounds { lb: None, ub: None }, 0u). could add default there
[11:44:50] <darnuria> huon: http://static.rust-lang.org/doc/master/std/io/stdio/index.html?search=stdout
[11:45:01] *** Joins: Kynes (Kynes@moz-3DC6C6E7.mit.edu)
[11:45:08] <eddyb> cmr: but I have to P!
[11:45:18] * cmr points to the bathroom
[11:45:26] <cmr> you were trained for this!
[11:45:36] *** Quits: Kruppe (user@moz-1E8003E1.dsl.teksavvy.com) (Ping timeout)
[11:45:56] <darnuria> pnkfelix: We must pick a date. Simon wants to comes to the next meeting!~
[11:46:09] <darnuria> SimonSapin: ^
[11:46:41] <SimonSapin> darnuria: maybe :)
[11:46:53] *** Joins: angdev (angdev@47A383CC.49F1C6BA.413CBA8C.IP)
[11:46:59] <eddyb> he comes
[11:47:01] <SimonSapin> the best would be if I can batch it with other travel
[11:48:12] <huon> darnuria: probably :)
[11:48:31] <huon> darnuria: you could also time them to see which is better :)
[11:49:02] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[11:49:30] <darnuria> huon: yep
[11:51:12] <geal> Yurume: well, I already did some fun stuff with the search and replace, like detecting if "extern crate extra;" is present, passing through the rest of the code, looking for extra::*, removing the extra:: part and adding extern crate X;" where extra was before
[11:51:13] *** Joins: alonlevy (alon@moz-A4A08D30.red.bezeqint.net)
[11:51:56] <geal> not doable directly with the regexp, but the python regexp replace method lets you pass a function in place of the second regexp
[11:52:12] <darnuria> huon: Can I ignore this warning? http://sebsauvage.net/paste/?dbe4767dffb6617c#1o1lpuR1xcYuBnolUZHRcz2YAIMSwrLhfQ4tqVJKWfw=
[11:52:51] <huon> darnuria: you can write `let _ = out.write_u8(...);`
[11:52:55] <huon> which just ignores the error
[11:53:21] <eddyb> but you shouldn't :/
[11:53:23] <SimonSapin> darnuria: possibly the meetup after next
[11:53:30] <eddyb> if you don't stop on error, who knows what can happen
[11:53:47] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[11:53:49] <huon> eddyb: this is a microbenchmark, I wouldn't think any other languages are handling io errors properly
[11:54:02] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[11:54:03] <eddyb> ah, heh
[11:54:12] <eddyb> huon: why u8 then, though?
[11:54:14] <cmr> huon: I wonder if the slowness is from switching to libnative...
[11:54:23] <eddyb> you don't want to write one byte at a time
[11:54:29] <cmr> that's the only major change I can think of...
[11:54:43] <huon> eddyb: buffered should be fine
[11:55:02] <eddyb> huon: ignore me :)
[11:55:13] <darnuria> huon: And the first one? About macro?
[11:55:30] <huon> eddyb: however the BufferedWriter.write method is rather complicated, I guess pushing to a vector might be faster
[11:55:42] <huon> but BufferedWriter is certainly easiest
[11:56:03] <huon> darnuria: `let _ = writeln!(...);`
[11:57:25] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Client exited)
[11:58:27] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[11:58:54] <darnuria> huon: Ok.
[11:58:59] <rofrol> hi
[11:59:15] <rofrol> how to get x/2.0 in rust?
[11:59:28] <rofrol> so I get float number not integer
[11:59:29] *** Joins: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl)
[11:59:34] <darnuria> huon: hmm as the output is binnary there is a way to test with printing without destroying the terminal? :)
[11:59:37] <huon> rusti: 1.0 / 2.0
[11:59:37] <cmr> `x as f64 / 2.0`
[11:59:38] -rusti- 0.5
[11:59:55] <huon> darnuria: ./foo > /dev/null (on linux or mac osx)
[11:59:56] <cmr> darnuria: ./foo > /dev/null
[12:00:00] <cmr> damn, too slow.
[12:00:43] <huon> or ./foo > tmpfile for something that will be more realistic for timing (possibly) 
[12:00:54] <darnuria> Yep I know. But with this your not recording printing.
[12:01:00] <darnuria> I will try with the file.
[12:01:14] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[12:01:56] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:01:59] <darnuria> Yep big difference with the file.
[12:02:00] <huon> the printing to /dev/null isn't free (it's just very cheap)
[12:02:04] <huon> oh, cool :D
[12:02:08] *** Quits: Ferreus (ferreus@moz-D25C01AC.dip0.t-ipconnect.de) (Ping timeout)
[12:02:24] *** Quits: oxum (anonymous@BE6B085.E5EFB142.520CDC98.IP) (Ping timeout)
[12:02:41] <huon> cmr: re libnative... I don't think the fasta one is using any threads or anything?
[12:02:52] <cmr> huon: it's still doing io...
[12:02:59] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[12:03:10] <cmr> it's the only change that would make sense to me.
[12:04:23] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[12:04:25] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[12:04:32] <huon> cmr: surely it's not 0.8 seconds of IO? :S
[12:05:02] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[12:05:07] <huon> (it's also using a bufferedwriter, fwiw.)
[12:08:40] <darnuria> huon: real    0m28.913s (with the actual implem) with ~io::BufferedWriter::new(io::stdio::stdout()): real    0m28.623s
[12:09:20] *** Joins: fabiand (fabiand@moz-2896AE16.adsl.alicedsl.de)
[12:09:33] <darnuria> time ./shootout-mandelbrot 16000 > /dev/null
[12:09:55] <darnuria> compiled with --opt-lvl=3`
[12:10:16] *** abinader_lunch is now known as abinader
[12:10:23] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[12:10:45] <strcat> huon: btw where are you putting the docs?
[12:10:50] <strcat> with this install thing
[12:10:55] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[12:10:56] <strcat> or does it not install them
[12:11:16] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[12:11:24] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[12:11:30] <darnuria> (quad core I5 debian with rustc 0.10-pre (397abb7 2014-03-12 00:32:03 -0700))
[12:11:31] <rofrol> huon, cmr: thanks
[12:11:32] <strcat> rust should put them in $(PREFIX)/doc/rust
[12:11:37] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Connection reset by peer)
[12:11:42] <huon> strcat: doesn't install them, just puts them the tarball
[12:11:49] <strcat> huon: can you install them too?
[12:11:55] <huon> strcat: don't know how :P
[12:12:20] *** Joins: benjamin_ (benjamin@moz-3A224608.dip0.t-ipconnect.de)
[12:12:56] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[12:12:58] <strcat> hm, where is the actual install.sh thing?
[12:13:03] <strcat> I'll bug brson later
[12:13:34] <huon> strcat: src/etc/install.sh
[12:13:39] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:14:36] <eddyb> cmr: what? http://imgur.com/a/GRIzy
[12:14:39] <darnuria> cmr: I see no difference with your proposition for the mandelbrot bench. snif :(
[12:15:11] <strcat> huon: well just copy whatever it does for the man page with the docs ;)
[12:15:20] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[12:15:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:17:16] <huon> strcat: maybe tomorrow, I have sleeping to do
[12:17:20] <huon> :)
[12:17:47] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[12:18:10] <huon> eddyb: oooh, maybe we should all act like that on mozilla/rust
[12:18:17] <darnuria> strcat: Owh nice licence wars.
[12:18:38] <strcat> darnuria: hm?
[12:18:44] <darnuria> strcat: sorry I mean eddyb 
[12:18:47] <strcat> oh
[12:19:02] *** Joins: Ferreus (ferreus@moz-B5D63601.dip0.t-ipconnect.de)
[12:19:13] <strcat> huon: https://github.com/thestinger/packages/blob/master/rust-git/PKGBUILD it sure would be nice if install.sh did that for me
[12:19:19] <strcat> I don't even install the docs atm :)
[12:19:21] <strcat> I should
[12:21:26] *** Joins: lpy (lpy@207F51B2.F09091A8.1348A864.IP)
[12:21:57] <darnuria> eddyb: Thanks. With this I understand why bsd/mit/etc licence is cool.
[12:22:04] <strcat> huon: I'll just report 10 bugs about this stuff in a bit
[12:23:11] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[12:28:25] *** Joins: dranov (dranov@1B0B11AA.A8779685.FB866788.IP)
[12:31:44] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[12:32:14] <Earnestly> strcat: Just wanted to point out that using `_gitname` is useless
[12:33:07] <strcat> sure
[12:33:15] <Earnestly> strcat: Also, it might be nicer to do `git describe | sed 's/-/.r/; s/-/./'`
[12:33:35] <strcat> it's just there because it's in the template
[12:33:41] <Earnestly> so you get (version).r(revision-since-tag).(last-commit)
[12:34:00] <Earnestly> *shrug*
[12:34:03] <strcat> I'm happy with the format git describe uses
[12:34:11] <strcat> I'm just changing it to make it a valid package version
[12:34:37] <Earnestly> Right, but using .r just helps to tell you where the version ends and the revisions begin
[12:35:02] <Earnestly> Because git used - to delineate that, but you can't use hyphens
[12:35:11] *** Joins: osa1 (omer@94EFD94F.BD5FF59B.AAC341FF.IP)
[12:35:28] <Earnestly> *shrug*, not important really, just bikeshedding
[12:36:22] *** Joins: Ms2ger (Ms2ger@moz-4A14BC33.ugent.be)
[12:36:44] *** Ms2ger is now known as Ms2ger|sad
[12:37:32] *** Joins: eibwen (kvirc@moz-6F69D9D5.dip0.t-ipconnect.de)
[12:40:40] *** Joins: hirsch (Mibbit@moz-93FB92D1.itwm.fhg.de)
[12:40:41] *** Quits: osa1 (omer@94EFD94F.BD5FF59B.AAC341FF.IP) (Quit: Konversation terminated!)
[12:41:31] <cmr> eugh how do you put a long link in docs without pissing off tidy?
[12:41:56] *** Joins: osa1 (omer@7480CF3D.7B7767E.3688B332.IP)
[12:42:07] *** Joins: klaus (koz@moz-4486E876.hsd1.wa.comcast.net)
[12:42:22] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[12:42:27] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[12:42:45] *** Quits: SpaceWizard (Apollo@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[12:43:23] <darnuria> cmr, huon: for mandelbrot the problem is not with the printing
[12:43:30] *** Joins: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl)
[12:43:39] <aochagavia> why is indexing not overloaded for Vec<T>?
[12:43:44] <darnuria> I commented all of the printing part of code And I get it : eal    0m26.340s
[12:43:54] <cmr> aochagavia: because it can't be yet.
[12:44:03] <hirsch> I've got a problem with range() after the requirement for uint indices was introduced. when you create a range(-1,5) the range silently casts the -1 to 18446744073709551615 and the iterator does nothing. Shouldn't range enforce uint too?
[12:44:07] <aochagavia> will it happen in the future?
[12:44:08] *** Joins: pczarn (pczarn@moz-69A55FA.izacom.pl)
[12:44:14] <darnuria> That possible to profile rust code?
[12:44:15] <cmr> aochagavia: yes.
[12:44:28] <cmr> darnuria: you can use the same tools you would use to profile C code to profile rust.
[12:44:31] <cmr> (besides gprof)
[12:44:42] <cmr> darnuria: so perf, Instruments.app, callgrind/cachegrind etc
[12:44:42] <strcat> those benchmarks should really be rewritten from scratch though
[12:44:45] <strcat> not incrementally improved
[12:44:49] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[12:44:57] <strcat> take the C implementation at the top of the benchmarks game, port it to rust 1:1
[12:45:00] <strcat> shouldn't be any slower
[12:45:35] <SiegeLord> Huh... rustdoc isn't hiding private fields
[12:45:42] <strcat> and make sure it actually produces the right output
[12:45:45] <strcat> atm many of them don't
[12:45:45] *** Quits: qwerty_nor (Thunderbir@A5447B90.EDC74FC5.E19950A4.IP) (Client exited)
[12:45:48] <darnuria> cmr: <3
[12:45:49] <cmr> hirsch: range() is generic over any type that implements Add, Ord, Clone and One.
[12:46:05] <SiegeLord> I wonder how it's implemented that it broke o_O
[12:46:24] <cmr> SiegeLord: it might just be looking for the priv keyword on fields..
[12:46:25] <hirsch> cmr: Yes I think what about introducing a Unsigned Trait
[12:46:28] <darnuria> strcat: Nice idea.
[12:46:35] <cmr> hirsch: we don't need one.
[12:46:40] <cmr> hirsch: you can say range::<uint>
[12:46:51] <cmr> hirsch: range isn't doing the "silent casting"
[12:46:58] <cmr> hirsch: -1 is a valid value, and just means UINT_MAX
[12:47:03] <cmr> (essentially)
[12:47:23] <hirsch> cmr: It's very unintuitive an error prone
[12:47:25] <cmr> SiegeLord: when I wrote that pass originally, the privacy pass didn't exist in a usable form.
[12:47:34] <SiegeLord> Ah
[12:47:52] <cmr> SiegeLord: since then it's been mostly-updated to use the information from rustc... but clearly not entirely :(
[12:47:56] <strcat> hirsch: range takes T for both arguments
[12:48:12] <strcat> hirsch: changing the requirements won't change the fact that range(1u, -1) is taking two uint
[12:48:27] <strcat> remove the implementation of - from unsigned integers
[12:48:31] <cmr> hirsch: what are you doing with range that you were using the results for an index anyway? :\
[12:48:44] <strcat> rusti: let x = 5u; -x
[12:48:45] -rusti- 18446744073709551611
[12:48:47] <SiegeLord> While C implementation might be a good start for the shootout benchmarks, I don't think it should be committed to the repository until it's rewritten :P
[12:48:50] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[12:48:56] <strcat> 08:44:57     strcat | take the C implementation at the top of the benchmarks game, port it to rust 1:1
[12:49:02] <strcat> SiegeLord: that's why I said port it 1:1 to rust
[12:49:12] <hirsch> cmr: imageprocessing (finding the pixel neighbourhood)
[12:49:27] <benh> Don't they subtract style points for looking like C code~
[12:49:31] *** flaper87|afk is now known as flaper87
[12:49:38] <SiegeLord> Yeah, 1:1 port is useless except for maybe having a baseline
[12:49:56] <strcat> SiegeLord: it's not useless, that's how the languages benchmarks game works
[12:50:08] <strcat> the code of a non-alternative isn't meant to be pretty
[12:50:20] <strcat> alternative implementations in a nice style are permitted, but that's not what the default one is
[12:50:40] <strcat> if someone submits a faster implementation, no matter how much uglier it is, it will replace the current implementation
[12:50:54] <strcat> so there's little point worrying about style, since someone else is just going to rewrite it and replace what you submit
[12:51:30] <strcat> the benchmarks game is using the ones from our repo unaltered, so the standard ones should be fast
[12:51:53] <strcat> maybe that means they can't reuse TreeMap or whatever
[12:52:06] <SiegeLord> I don't see the C++ submissions being identical to the C ones
[12:52:17] *** Joins: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP)
[12:52:34] <strcat> if someone submits a faster implementation, it will replace the current ones
[12:52:35] <benh> Has anyone just submitted a huge blop of inline assembly that's the compiler output for the fastest C version
[12:52:43] <strcat> benh: you're not allowed to use inline asm
[12:52:57] <SiegeLord> The C++ implementations aren't faster than the C ones
[12:53:01] <benh> Inline... llvm ir?
[12:53:19] <strcat> SiegeLord: if someone submits a faster implementation, it will replace the current ones
[12:53:24] <SiegeLord> They are about the same speed, just written in somewhat more C++ one
[12:53:24] <strcat> benh: not allowed either
[12:53:50] <strcat> SiegeLord: regardless of what they currently are, they'll be replaced as soon as someone does better
[12:54:07] <SiegeLord> So?
[12:54:27] <SiegeLord> Is there some obvious reason why 1:1 port is guaranteed to be faster?
[12:54:29] <strcat> so there's no point in making them artificially slower because they subjectively look better
[12:54:41] <strcat> SiegeLord: the current implementations are mostly really slow
[12:54:50] <strcat> a 1:1 port from C or C++ would be very easy and fast
[12:55:01] <SiegeLord> I don't think it's a big enough deal to resort to that
[12:55:23] <strcat> sure, just wait until we have an implementation of all of them and people are saying rust is 5x slower than C though
[12:55:24] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[12:55:34] <strcat> atm it doesn't show up in the normal view
[12:55:46] <strcat> since we're missing some and others produce the wrong output
[12:55:47] *** Joins: ganitsu (ganitsu@moz-BB2CB6E7.dialup.adsl.anteldata.net.uy)
[12:55:51] <SiegeLord> Then it'll be a big deal :P
[12:56:03] <SiegeLord> For a certain value of "big"
[12:56:14] <strcat> that's where people look to gauge the speed of languages
[12:56:17] <strcat> rust is useless if it's not fast
[12:56:30] <strcat> it would make the language look very bad if the implementations there were slow
[12:56:37] <SiegeLord> It's useless if you have to write everything in an unsafe {} block
[12:56:52] <strcat> you don't have to write everything in an unsafe block
[12:56:58] <strcat> you do have to write many inner loops in unsafe blocks
[12:57:05] <kimundi> As an aside: Doesn't correct C code map close enough to correct Rust code that a 1:1 port wouldn't be all that unidiomatic?
[12:57:08] <SiegeLord> You'll have to get the 1:1 implementation to be just as fast
[12:57:21] <strcat> HashMap uses unsafe code, it doesn't have to be - but it's faster
[12:57:31] <strcat> our ring buffer will need to use unsafe code, to avoid using 2x as much memory
[12:57:39] <strcat> every single tree data structure will need to use unsafe code to avoid being slower
[12:57:50] <strcat> we already use unsafe code everywhere
[12:57:56] <SiegeLord> Yes, and they provide safe API around those unsafe blocks
[12:58:04] <strcat> kimundi: in cases where there's no vector indexing, yes, it usually maps right to safe rust
[12:58:37] <strcat> SiegeLord: the benchmarks game is by definition a super hot spot, where unsafe code is meant to be used + audited to be correct
[12:58:49] *** Joins: Sorella (quildreen@AA4589ED.97245BEB.1ED99692.IP)
[12:58:50] <strcat> not overused, but used
[12:59:00] <strcat> porting 1:1 to C will mostly result in safe rust
[12:59:09] <strcat> just not on benchmarks where indexing slices is required
[12:59:14] <strcat> and even then it's contained
[12:59:40] *** Quits: mib_duqxrt (Mibbit@moz-4058A5B9.ge-0-2-0-712.arcnqu2.dk.customer.tdc.net) (Quit: http://www.mibbit.com ajax IRC Client)
[13:00:23] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[13:00:24] <strcat> rust doesn't provide the ability to write optimal code without using unsafe now and then
[13:00:49] <strcat> often you can build safe abstractions around the low-level code without a code, but often you can't
[13:01:11] <strcat> if you expect to be able to avoid a performance hit when avoiding unsafe code, rust will disappoint you
[13:01:40] <SiegeLord> You're missing the point
[13:01:44] <strcat> there's a trend towards more and more unsafe code in the stdlib
[13:01:46] <SiegeLord> There's already a lot of unsafe code in the stdlib
[13:01:49] <strcat> because you can micro-optimize nearly anything
[13:01:50] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[13:01:58] <SiegeLord> You shouldn't need more in simple tasks
[13:02:06] * Ms2ger|sad sees a wall of strcat-text
[13:02:07] <strcat> but you do need more
[13:02:18] <strcat> you need unsafe code to avoid useless bounds checks
[13:02:41] <strcat> that's just a fact, rust doesn't claim to provide the same level of performance in all or even most cases if you avoid unsafe
[13:02:57] <SiegeLord> You don't need to perform bounds checks in many cases
[13:03:02] <Ms2ger|sad> "useless" if you're sure you never have bugs
[13:03:24] *** Quits: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za) (Ping timeout)
[13:03:30] <strcat> Ms2ger|sad: language benchmarks game benchmarks have no use for memory safety
[13:03:43] <strcat> there's no security or correctness issue introduced by memory unsafety
[13:03:53] <strcat> your code needs to be bug-free either way
[13:04:11] <strcat> not everything is a web browser
[13:04:17] <strcat> memory safety is sometimes useless
[13:04:22] <doomlord_> useless bounds checks ... graphics would be full of them. data verified on loading, then immutable..
[13:04:24] <strcat> (as a guarantee from the language)
[13:04:46] *** Joins: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za)
[13:05:04] <Havvy> Could you imagine if the Linux kernal was guaranteed to be memory safe?
[13:05:31] <strcat> the linux kernel in rust would have fewer bugs, but it would certainly be filled with unsafe code
[13:05:39] <strcat> all of the userland<->kernel boundaries would be unsafe
[13:05:40] <SiegeLord> Yeah, I'm sure I'm going to trust a programmer that he things memory safety is useless :P
[13:05:42] *** pmoore is now known as pmoore|tea-break
[13:05:45] <SiegeLord> *thinks
[13:05:52] *** Joins: rootnode (rootnode@moz-7D8AB6F3.pools.arcor-ip.net)
[13:06:02] <cmr> in the shootout, though, it really is :\
[13:06:07] <strcat> SiegeLord: you have a problem if you have to cherry pick by words out of context to argue your point
[13:06:18] <strcat> I'll paste it again since you clearly misread it
[13:06:21] <doomlord_> there is always going to be a speed vs conveinience tradeoff IMO
[13:06:24] <strcat> 09:03:29     strcat | Ms2ger|sad: language benchmarks game benchmarks have no use for memory safety
[13:06:26] <strcat> 09:03:42     strcat | there's no security or correctness issue introduced by memory unsafety
[13:06:26] *** Joins: edwardw (Mibbit@EE646FE3.EE06708D.4BFBD933.IP)
[13:06:28] <strcat> 09:03:52     strcat | your code needs to be bug-free either way
[13:06:30] <strcat> 09:04:11     strcat | not everything is a web browser
[13:06:32] <cmr> as long as it produces the correct output for the input the shootout gives it... no one cares.
[13:06:32] <strcat> 09:04:17     strcat | memory safety is sometimes useless
[13:06:39] <Havvy> In the shootout, general memory safeness is useless.
[13:06:48] <SiegeLord> The shootout is more than just speed
[13:06:56] <cmr> sure, it's also memory usage
[13:06:59] <cmr> and code size.
[13:06:59] <strcat> it's just speed and memory usage
[13:07:03] <SiegeLord> You look at the code and see what garbage it is, and then you discount the metric
[13:07:13] <cmr> ok, that's for all of them though.
[13:07:21] <SiegeLord> No, that's not all of them
[13:07:22] <strcat> SiegeLord: if you write a really pretty rust implementation
[13:07:29] <SiegeLord> C looks as bad as C always looks
[13:07:30] <strcat> and I submit a really ugly one with 2x as much code and unsafe everywhere
[13:07:37] <strcat> the maintainer of the benchmarks game will replace yours with mine
[13:07:39] <SiegeLord> Now look at Haskell... is that how it always looks?
[13:07:40] <strcat> that's how the benchmarks game works
[13:07:46] <strcat> SiegeLord: that is how the benchmarks game is run
[13:07:56] <strcat> the fastest implementation is the one used/shown by default
[13:08:00] <strcat> doesn't matter what it looks like
[13:08:04] <SiegeLord> Despite that, the C implementation is still good looking
[13:08:15] <doomlord_> C's syntax is optimized for unsafe
[13:08:21] <strcat> and if I submit an uglier C implementation that's 10% faster, it will replace the current one
[13:08:28] <doomlord_> (well C's syntax can only do unsafe, hence the ugliness of safe C++)
[13:08:29] <SiegeLord> Go ahead :P
[13:08:40] <Earnestly> SiegeLord: Your arguments are basically a bit groundless.  Yes pretty code is pretty, but pretty code is irrelevant in benchmarks
[13:08:48] <strcat> in these benchmarks
[13:08:50] <strcat> at least
[13:09:00] <strcat> there is a use case for comparing the overhead of pretty vs. low-level code
[13:09:00] <Earnestly> You're refering to alioth?
[13:09:03] <strcat> the benchmarks game doesn't do that
[13:09:05] <strcat> and won't
[13:09:13] <strcat> if you want that, look elsewhere, it's not what the guy who runs it intends to do
[13:09:14] <SiegeLord> Earnestly: You've never ever heard somebody complaining that those benchmarks are useless because of the horrible code they use?
[13:09:22] <Earnestly> SiegeLord: Nope.
[13:09:24] <strcat> SiegeLord: so make a new benchmarks game
[13:09:25] <SiegeLord> I have
[13:09:27] <strcat> SiegeLord: this one doesn't do what you want
[13:09:30] <SiegeLord> And not just from me :P
[13:09:41] <Earnestly> SiegeLord: I've heard plenty of people complaining that benchmarks are pretty artificial
[13:10:00] <Earnestly> Assuming this is alioth
[13:10:06] <Earnestly> Even they have a disclaimer about it
[13:10:32] <strcat> SiegeLord: we are trying to get good rust implementations for a benchmarks game where the prettiness of the code is viewed as irrelevant (uglier implementations always replace prettier ones if the perf gain isn't insignificantr)
[13:10:49] <SiegeLord> Oh, now you're changing your tune
[13:10:51] <strcat> no
[13:10:56] <SiegeLord> Now it has to be a significant improvement
[13:10:57] <strcat> I'm not 'changing my tune'
[13:11:04] <strcat> SiegeLord: of course it does, it has to be a measurable improvement
[13:11:07] <Earnestly> SiegeLord: It has to be better to replace it
[13:11:10] <strcat> if you can't measure the improvement then it's not an improvement at all
[13:11:23] *** Quits: angdev (angdev@47A383CC.49F1C6BA.413CBA8C.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[13:11:27] <SiegeLord> So why start with an ugly implementation that can't be replaced by a prettier implementation that's just as fast?
[13:11:28] *** Joins: patpatter (patpat@moz-21619C28.as13285.net)
[13:11:29] *** Joins: Guest (textual@moz-77D0F250.nebulazone.fi)
[13:11:46] <Earnestly> They might
[13:11:51] <Earnestly> If you ask nicely :P
[13:11:52] <strcat> SiegeLord: a pretty implementation will replace an ugly implementation if it's not significantly slower
[13:11:53] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[13:11:54] <strcat> https://en.wikipedia.org/wiki/Statistical_significance
[13:11:57] <huon> why can't it be replaced with the prettier version?
[13:11:58] <SiegeLord> Might? Not according to everything you asked me
[13:12:06] <strcat> huon: it can be
[13:12:09] <SiegeLord> *told me
[13:12:11] <strcat> unless it can be measured to be slower
[13:12:37] <huon> strcat: I know it can be, I want to know why SiegeLord seems to think it can't be.
[13:12:44] <strcat> that's why the C++ ones are a bit higher level than C, people took older versions of the C ones and made them a bit cleaner (but then they fell behind as C was updated to more clever tricks)
[13:12:45] <SiegeLord> Because that's what I'm being told
[13:12:51] <huon> SiegeLord: no you're not
[13:13:01] *** Joins: angdev (angdev@B0D6B68D.344596AC.6B746DF2.IP)
[13:13:14] <huon> you're being told "speed is the utmost importance", prettiness is not a major consideration
[13:13:18] *** Joins: nszceta (nszceta@moz-E458A7C0.pharm.pitt.edu)
[13:13:19] <strcat> if there's a statistically significant win from using uglier code, the benchmarks game will use the uglier code
[13:13:33] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:13:35] <strcat> if there's not a statistically significant difference, then it will use the cleaner code
[13:13:37] <bstrie> huon: the april CSS tomfoolery continues
[13:13:37] * Ms2ger|sad yawns
[13:13:41] *** Joins: sk (sk@35CFDE22.E993C7C3.78DD174B.IP)
[13:13:41] <bstrie> Ms2ger|sad: why so sad
[13:13:54] <Ms2ger|sad> Certain news
[13:13:57] <Ms2ger|sad> And this discussion
[13:14:03] <Tobba> is there any MD5 implementation for rust yet
[13:14:06] <Tobba> or will I have to improvise
[13:14:07] <SiegeLord> Well, why didn't you say so before?
[13:14:24] *** Joins: jviereck (Adium@moz-7EADFADC.ethz.ch)
[13:14:28] <SiegeLord> Either way, that's exactly what I said earlier anyway
[13:14:38] *** Joins: jviereck1 (Adium@moz-1E767588.ethz.ch)
[13:14:43] *** Quits: jviereck (Adium@moz-7EADFADC.ethz.ch) (Max SendQ exceeded)
[13:14:46] *** Parts: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (WeeChat 0.4.3)
[13:14:51] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[13:15:16] <SiegeLord> Purposefully making the code ugly without any speed measurement is just being obtuse on purpose
[13:15:31] <bstrie> 09:13 < Ms2ger|sad> And this discussion
[13:15:32] <bstrie> 09:13 < Ms2ger|sad> And this discussion
[13:15:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:15:38] <bstrie> woops
[13:15:45] <bstrie> stupid touchpad
[13:15:46] <Ms2ger|sad> Yes
[13:15:47] <huon> SiegeLord: eh? strcat wasn't saying that either
[13:15:48] <SiegeLord> Not going to get statistical significance on a single bounds check per program launch
[13:16:06] <SiegeLord> All I asked was for the benchmark to be rewritten after the initial 1:1 port
[13:16:13] <SiegeLord> Why is that not allowed?
[13:16:16] <cmr> bstrie: I love when I swipe my fat paw against the computer to reach for my waterbottle or whtever and accidentaly pasting whatever code I was most recently editing into irc
[13:16:17] <huon> it's not not allowed
[13:16:18] <SiegeLord> Why is that heretical?
[13:16:31] <SiegeLord> Well, apparently it's bad enough of a suggestion to yell at me for 10 minutes
[13:16:45] <SiegeLord> Bah
[13:16:48] <cmr> :P
[13:17:10] <huon> SiegeLord: where on earth did you get the impression that making the code pretty wasn't allowed?
[13:17:20] *** Joins: tigrou3tac (fabien@moz-6E2397FF.fbx.proxad.net)
[13:17:21] <bstrie> who's yelling at whom
[13:17:25] <bstrie> I will yell at them
[13:17:29] *** Quits: lpy (lpy@207F51B2.F09091A8.1348A864.IP) (Client exited)
[13:17:31] *** kimundi is now known as zz_kimundi
[13:17:34] <huon> it's "if making the code pretty & slower" that's not allowed
[13:17:34] <bstrie> I will yell at everyone involved
[13:17:39] <huon> s/if/
[13:17:40] * Ms2ger|sad yells at bstrie 
[13:17:54] <SiegeLord> Yeah, that's not how it was put
[13:17:58] <Yoric> Stop yelling, I can't hear myself type.
[13:18:05] <bstrie> Ms2ger|sad: fortunately I refrain from yelling at sad people. I'll yell at you once you've regained your composure
[13:18:14] <Ms2ger|sad> Ha
[13:18:45] <huon> SiegeLord: yeah, it was, a 1-1 port will be a fast way to get to baseline fast code; making it safe/pretty and slower is bad. Making is safe/pretty and not slower is good.
[13:18:46] <Ms2ger|sad> So, why does split() give you empty entries?
[13:18:57] <SiegeLord> That's exactly what I said
[13:19:01] <huon> where?
[13:19:12] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[13:19:28] <SiegeLord> SiegeLord │ While C implementation might be a good start for the shootout benchmarks, I
[13:19:30] <SiegeLord>           │ don't think it should be committed to the repository until it's rewritten
[13:19:32] <SiegeLord>           │ :P                                                                         
[13:20:12] <Ms2ger|sad> That's not even close to what huon said
[13:20:35] <SiegeLord> Of course not, if you assume I'm retarded :P
[13:20:41] *** Joins: ramitos (ramitos@moz-53A6C51A.rev.vodafone.pt)
[13:20:55] <SiegeLord> Assuming the worst interpretation works well, right?
[13:21:21] <Ms2ger|sad> No, what I read there is "you shouldn't be allowed to submit not-pretty rust code"
[13:21:24] <SiegeLord> I said, "start with C code, rewrite it before commiting it"
[13:22:15] <huon> rewrite to what?
[13:22:38] <huon> any rewrite that makes it slower is essentially not acceptable
[13:22:40] <SiegeLord> Clearly, make is as pretty and slow as possible
[13:22:49] <SiegeLord> Because that's exactly what you do for a benchmark
[13:23:10] <huon> and with your emphasis previously it sounds like you're happy sacrificing a little speed for prettiness
[13:23:11] *** Quits: matp (matp@moz-16FE1E05.matp.at) (Ping timeout)
[13:23:13] *** jorendorff_away is now known as jorendorff
[13:23:14] <bstrie> everyone, please stop. what, exactly, are we arguing about?
[13:23:20] <huon> which isn't how one plays the benchmark game.
[13:23:40] <SiegeLord> Yes it is
[13:23:48] <SiegeLord> If it's not a significan decrease, it's fine
[13:24:07] <SiegeLord> You won't be able to benchmark one bounds check per program execution
[13:24:10] <huon> if it's not a (statistically) significant decrease then it's not a decrease
[13:24:30] <SiegeLord> Even though it's guaranteed to be slower
[13:24:39] <huon> both strcat and I are only talking about real-world measurable changes
[13:24:47] <huon> not theoretical "add up instruction count" changes
[13:24:47] <bstrie> are we seriously arguing about the benchmarks game
[13:25:00] <Ms2ger|sad> Yes
[13:25:10] * bstrie bans everyone in the channel
[13:25:12] <bstrie> rust is over, go home
[13:25:30] *** Parts: huon (huon@moz-EC676DFE.members.linode.com) (Leaving)
[13:25:34] <bstrie> haha
[13:25:38] *** Joins: huon (huon@moz-EC676DFE.members.linode.com)
[13:25:38] *** ChanServ sets mode: +o huon
[13:25:40] <bstrie> see, I can even ban ops
[13:25:43] <bstrie> huon felt my wrath
[13:25:58] <cmr> bstrie: have you tried nailing people to walls? I find it's very effective.
[13:26:15] <bstrie> I prefer hot glue, myself...
[13:26:23] <bstrie> a bit messy though
[13:26:34] <huon> btw, this started because we noticed our glorious poster-boy benchmark (fasta) is now slow
[13:26:37] <huon> :'(
[13:27:37] *** Joins: jim (Mibbit@moz-6968471.bstnma.fios.verizon.net)
[13:28:02] *** Parts: jim (Mibbit@moz-6968471.bstnma.fios.verizon.net) ()
[13:28:02] *** Quits: doskey (daniel@moz-82F8E8BD.adsl.012.net.il) (Quit: doskey)
[13:28:37] <SiegeLord> Put more unsafe in it
[13:29:03] <Havvy> bstrie:  Don't joke about the end of Rust!  :(
[13:29:32] <huon> oh, I actually know why it's slow
[13:29:39] *** Quits: angdev (angdev@B0D6B68D.344596AC.6B746DF2.IP) (Ping timeout)
[13:29:46] * huon remembers meeting this problem before
[13:29:56] <huon> it's https://github.com/mozilla/rust/issues/11751
[13:29:57] <bstrie> Havvy: the falcon cannot hear the falconer
[13:30:03] <huon> with the new Vec<> rather than ~[]
[13:30:23] <huon> so the innermost iterator has an extra unnecessary null check
[13:30:36] <huon> fixing that (somehow...) will make us fast again
[13:30:52] <SiegeLord> Not before I submit an implementation using malloc and *T :P
[13:31:39] <huon> SiegeLord: we were faster than the fastest C program before, so that would be a regression.
[13:32:39] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[13:32:41] *** Quits: rcxdude (rcxdude@moz-9D9E84CB.range86-130.btcentralplus.com) (Ping timeout)
[13:32:42] <huon> (if you feel like writing every benchmark in idiomatic code that ends up being faster than the C ones like fasta was, feel free; but I don't think that's a reasonable thing for us to expect to be able to do right now.)
[13:33:24] <vic> this "faster than C" obsession is unhealthy 
[13:33:32] <huon> not until we fix these iterator null-check issues and maybe get alias analysis etc. to be able to get LLVM doing everything we can
[13:33:37] <araujo> hello .. I have been checking about rust from time to time since its origin, and it looks like better and better every time I check, recent version looks so much 'cleaner' (at leats in syntax) than previous ones :)
[13:33:51] <bstrie> araujo: thanks :)
[13:33:57] * araujo pondering to start some pet project on it for fun
[13:34:01] <araujo> bstrie: :D
[13:34:02] <huon> vic: we're specifically talking about benchmarks where C is the top slot, so it's "faster than the best current language for the benchmark at hand"
[13:34:16] <huon> (not some vague "faster than C" handwaving.)
[13:34:16] <vic> huon: ok 
[13:34:25] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[13:35:11] *** Joins: rcxdude (rcxdude@moz-24B1F019.range86-179.btcentralplus.com)
[13:35:19] <huon> (although, to be 100% accurate it's often ada or fortran which is first.)
[13:35:22] <SiegeLord> If you do enough trials, you can get a significant difference with any non-zero improvement... I don't even see the shootout given confidence intervals on the numbers it shows
[13:35:22] <Earnestly> Being fast is a good thing otherwise you end up like another Go or Java, and I hope rust doesn't
[13:35:26] <doomlord_> showing its as fast as C when it wants to be is important
[13:35:43] <SiegeLord> *giving
[13:35:58] <doomlord_> i'm only here because i beleive rust will be as fast as C when it wants to be
[13:36:27] <Earnestly> Yep, and it's a systems programming language (meaning freestanding)
[13:36:40] <doomlord_> (^ but can do so whilst solving various frustrations with C++ ..)
[13:37:06] <Earnestly> There's not many systems programming languages made these days, Rust is the first in a long time afaik
[13:37:19] <doomlord_> refreshing change
[13:37:32] <Earnestly> Yeah, something other than just C and C++
[13:37:48] *** Joins: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP)
[13:38:56] <SiegeLord> Depending on your definition of 'systems' there have been plenty others made
[13:39:09] <Earnestly> freestanding
[13:39:40] *** pmoore|tea-break is now known as pmoore
[13:39:54] <Earnestly> No dependency on a standard library, basically letting you write your own malloc/pic controller, etc.
[13:40:05] <benh> i've devised a 'system' to render the contents of my database to html and send it to people's browsers! does that count!
[13:40:11] <Earnestly> No
[13:40:19] <SiegeLord> D fits all those criteria, I bet, if you gimp it enough
[13:40:32] <Earnestly> SiegeLord: D is freestanding?
[13:40:55] <huon> bstrie: do they actually use hatchets? the only videos I've seen are them bashing each other with rocks? ;P
[13:41:17] <benh> the D people are pretty adamant that you can use it without a GC, and from there it's probably got a decent C-like subset for that sort of thing...
[13:41:32] *** Joins: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us)
[13:42:18] *** Joins: qwerty_nor (Thunderbir@A5447B90.EDC74FC5.E19950A4.IP)
[13:42:24] <Earnestly> Apparently some people were mucking about with Go, trying to make it freestanding, but I don't think anything happened
[13:42:31] <Ms2ger|sad> benh, a 'system' to render the contents of my database to html and send it to people's browsers?
[13:42:36] <Ms2ger|sad> benh, patent grandted
[13:42:44] <Ms2ger|sad> granted*
[13:42:57] <huon> it's like a normal patent, but with an extra 1k
[13:42:58] <SiegeLord> Earnestly: Sure
[13:43:16] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[13:43:35] <Earnestly> SiegeLord: Hm, do you have a link?
[13:43:59] *** Quits: jviereck1 (Adium@moz-1E767588.ethz.ch) (Quit: Leaving.)
[13:44:47] <benh> :D
[13:46:02] <Earnestly> SiegeLord: At least I see kernels written in D, so it's likely true, that's nice
[13:46:17] <Earnestly> -nostdlib
[13:46:48] <Earnestly> "You must add the D runtime"
[13:47:01] <Earnestly> Fair enough, thanks
[13:47:09] <SiegeLord> I guess I'm having a hard time proving that there's no runtime, but I have a -noruntime switch and I called D from C right now
[13:47:15] *** Joins: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no)
[13:47:22] <SiegeLord> I'd have to look through the assembly to be super sure there's nothing there
[13:47:31] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[13:47:46] *** Joins: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca)
[13:48:18] *** Joins: mib_loous5 (Mibbit@46447242.24FD34AF.F2EC20BB.IP)
[13:48:23] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[13:48:32] <Earnestly> http://wiki.osdev.org/D covers it I think
[13:48:38] *** Quits: mib_loous5 (Mibbit@46447242.24FD34AF.F2EC20BB.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:49:00] <cmr> Earnestly: go has a big runtime, which makes it harder.
[13:49:08] <cmr> rust has the advantage of not needing a runtime anymore.
[13:49:14] <Earnestly> Exactly
[13:49:37] *** Joins: sankha93 (sankha93@7061CD01.D6BD0D91.22D41759.IP)
[13:49:48] <benh> btw, which bits of libnative actually require a runtime to be present?
[13:49:51] <aochagavia> Can someone tell me how to fix this? It is short: https://gist.github.com/aochagavia/9ba500a31f15575d55f3
[13:49:59] <benh> or a task object or w/e
[13:50:00] <huon> benh: that's a peculiar question
[13:50:09] <Earnestly> aochagavia: collections is gone afaik
[13:50:10] <huon> because libnative is the runtime
[13:50:17] <huon> do you mean libstd?
[13:50:24] *** Joins: somebody132 (Mibbit@moz-1292C2C5.dial-up.dsl.siol.net)
[13:50:31] <aochagavia> Earnestly: in 0.10 they are available
[13:50:33] <somebody132> Hello
[13:50:37] <cmr> Earnestly: other way around :p
[13:50:43] <Earnestly> Oh :/
[13:50:53] <somebody132> Can someone tell me the difference between nightly rust and 0.10 rust?
[13:50:57] <benh> huon: No, I'm trying to figure out in what way libnative depends on the runtime having been started properly
[13:51:10] <cmr> somebody132: git diff master..0.10
[13:51:20] <huon> benh: ... libnative is the runtime
[13:51:36] <huon> i.e. "starting the runtime properly" is "starting libnative properly"
[13:51:40] <benh> yes
[13:51:51] <benh> i mean starting libnative properly as opposed to just linking against it and hoping for the best
[13:51:52] *** Quits: somebody132 (Mibbit@moz-1292C2C5.dial-up.dsl.siol.net) (Quit: http://www.mibbit.com ajax IRC Client)
[13:51:52] <cmr> benh: so libnative kinda *is* the runtime. but most of the free-standing functions don't require a runtime present, is, native::io::file::open()
[13:52:00] <benh> right
[13:52:03] <SiegeLord> I wouldn't argue that Rust makes writing freestanding code a lot easier than D does though
[13:52:08] <huon> benh: these 3 http://static.rust-lang.org/doc/master/native/index.html#functions
[13:52:19] <benh> yeah, i've used these
[13:52:23] <huon> (one of them is required to be called to start the runtime)
[13:52:27] <SiegeLord> So you could say that Rust is the first at being... "good" as being a systems language ;)
[13:52:31] <cmr> I presume most of native::io isn't going to need a runtime.
[13:52:35] <SiegeLord> *at
[13:52:46] <huon> if you don't call them (or have the compiler implicitly call lang_start) then libnative isn't active
[13:52:50] <aochagavia> I have made some edits to make it more clear: https://gist.github.com/aochagavia/9ba500a31f15575d55f3
[13:53:00] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[13:53:02] <benh> i'm trying to figure out how far i could reasonably get starting a thread in C, calling rust code from it, and doing business as usual in the rust code despite nobody having called native::start() or w/e
[13:53:03] <cmr> aochagavia: it's not the H you are missing, it's the lifetime parameter.
[13:53:06] <huon> cmr: I don't think it's designed for use other than via the Runtime trait
[13:53:10] <cmr> aochagavia: it's not possible to return that type.
[13:53:16] *** vfetwnuncszu is now known as dcrewi
[13:53:22] <aochagavia> I will add it and see what happens
[13:53:26] <benh> I assume the problem is mainly that libstd tries to retrieve the task object out of tls, there is none, so it makes a sad face and aborts
[13:53:33] <huon> benh: starting a runtime inside the rust code when you need one?
[13:53:53] <SiegeLord> Can you start the runtime several times?
[13:53:55] <cmr> huon: I don't believe that to be true, given that nothing in native::io even uses the runtime besides the IoFactory impl.
[13:53:57] <huon> pub extern "c" fn foo() { native::run(proc() { my_code() }) }
[13:54:06] <huon> cmr: I meant the api
[13:54:33] <huon> (as in, the API isn't designed for public consumption, you can probably use it, but it might not be so nice)
[13:54:43] * cmr thinks it's pretty nice
[13:54:46] *** Quits: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP) (Quit: Textual IRC Client: www.textualapp.com)
[13:54:48] <SiegeLord> Right now, I start the runtime from a function called in a new thread created by C, and it works fine... so the only issue I'd think would be if that wasn't the sole entry point
[13:54:51] <benh> huon: well, ideally if i call rust a bunch of times it wouldn't need to start up and shut down the runtime every time
[13:54:51] <cmr> it's basically the same thing in std::io
[13:54:53] <aochagavia> cmr: it still doesn't work, I have updated the gist so that you can see my changes: https://gist.github.com/aochagavia/9ba500a31f15575d55f3
[13:55:00] <huon> I'll take your word for it
[13:55:01] <benh> would be neat if it could keep it running in the background
[13:55:08] <cmr> aochagavia: like I said, it's not possible to return that type.
[13:55:17] <huon> benh: you can use channels outside a runtime
[13:55:18] <cmr> aochagavia: you should be returning a vector.
[13:55:25] <huon> so you can have a background thread with the runtime in it
[13:55:26] <cmr> aochagavia: set1.difference(set2).collect()
[13:55:38] <benh> but i'm trying to ask how the state of everything actually differs between having started the libnative runtime or not
[13:55:43] <huon> recieving on a channel that has been passed back into the C and then passed into rust function calls
[13:55:44] *** Joins: derek_c (derek@moz-A43430DA.cit.cornell.edu)
[13:55:54] <aochagavia> cmd: I just need an iterator...
[13:55:59] *** Quits: vgeddes (vincent.ge@moz-102C6E36.access.mtnbusiness.co.za) (Ping timeout)
[13:56:12] <benh> i mean, the code is loaded, it probably just does a bunch of pthread stuff, maybe some tls stuff
[13:56:26] <benh> why can't it just do something native instead of aborting ;)
[13:56:38] *** Joins: paraze (paraze@moz-9E76094B.w90-27.abo.wanadoo.fr)
[13:56:49] <huon> because our current design means it supports different runtimes per task (not just per program)
[13:57:14] <aochagavia> cmr: I mean... I don't actually need a vector...
[13:57:28] *** Joins: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP)
[13:57:31] <huon> I guess we could some how default to libnative is the TLS stuff fails
[13:57:39] <huon> but that seems... unreliable.
[13:57:41] <aochagavia> cmr: Is there absolutely no way to do it without using a vector?
[13:57:41] <benh> yeah, i was thinking that
[13:57:46] *** Quits: aravindavk (aravinda@1835D1B2.1436F502.C28A6AA4.IP) (Ping timeout)
[13:57:56] <cmr> aochagavia: SetAlgebraItems keeps references to the original hashmaps, which will be destroyed/out of scope before you can return it.
[13:58:02] <huon> (and even more bloaty than what we currently have)
[13:58:04] <cmr> aochagavia: no, not really, or some other container.
[13:58:05] <benh> I mean, I was mostly thinking from the perspective of a C program that is not really aware of rust but is loading a rust plugin or something
[13:58:24] <benh> most of rust is gonna work just fine, which is great
[13:58:37] *** Quits: mawuli (mawuli@2760A9B5.4882C7ED.DE15C958.IP) (Ping timeout)
[13:58:41] <strcat> or a C program calling into rust on another thread
[13:58:41] <aochagavia> cmr: then I can use ~ and <'a> to make them last longer
[13:58:45] <strcat> C library*
[13:58:49] *** Joins: philix_ (felipe@moz-CB0FA9E2.user.veloxzone.com.br)
[13:58:52] <benh> but it seems like the distance between most and all isn't actually that great, and that being entirely transparent would be a big win I think
[13:59:06] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[13:59:27] *** Quits: philix (felipe@moz-B08938FF.user.veloxzone.com.br) (Ping timeout)
[13:59:41] <strcat> benh: wouldn't it be great if we just used 1:1 threading and none of this dynamic dispatch / setup was required? :P
[13:59:59] <aochagavia> cmr: nevermind... It seems that I don't understand completely how lifetimes work
[14:00:10] *** Joins: mr_fribble (Mibbit@moz-FF8F47D8.messagelabs.net)
[14:00:16] <benh> hey, some people like writing weird socket servers with lots of io overhead i guess
[14:00:16] <strcat> no 'runtime' other than the libc code before/after main you already get
[14:00:33] <strcat> benh: libgreen uses more memory per thread than libnative, measure it
[14:00:35] * strcat shrugs
[14:00:55] <strcat> it has the stack overhead + buffers in libuv overhead
[14:01:01] <strcat> + libuv thread pool, in many cases
[14:01:28] <strcat> imo there's no way it can be any lighter on resources, without arbitrarily making the stacks smaller
[14:01:30] <benh> I think a green threading model is pretty handy for some cases in an isolated rust program that doesn't have to pretend to be C
[14:01:36] *** Quits: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP) (Client exited)
[14:01:36] <strcat> when? ;p
[14:01:44] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[14:01:45] *** ChanServ sets mode: +o jdm
[14:01:47] *** Tomcat|sheriffduty is now known as Tomcat
[14:01:49] <strcat> keeping in mind that we don't (and won't) have segmented stacks
[14:01:51] <cmr> servo!
[14:01:55] <strcat> for what in servo?
[14:01:56] *** Joins: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP)
[14:02:03] <benh> isn't the green task switching overhead still lower until 1:1 threading gets usermode scheduling?
[14:02:03] * cmr doesn't know
[14:02:04] <strcat> when is it going to be useful to have threads that use more memory?
[14:02:12] <benh> in time, not memory, i guess
[14:02:18] <strcat> benh: context switch overhead is already pretty negligible
[14:02:19] <huon> strcat: excess ram that needs filling
[14:02:28] <strcat> benh: the overhead is from fair/pre-emptive scheduling
[14:03:05] <strcat> and that's pretty low with SCHED_BATCH on linux, and zero with user-mode scheduling on windows
[14:03:09] <benh> as opposed to unfair/cooperative "i guess i'm gonna yield now, who's next?" green schedulin?
[14:03:17] <benh> mh
[14:03:27] <benh> I guess you don't want to run servo with SCHED_BATCH though?
[14:03:36] *** Quits: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP) (Ping timeout)
[14:03:39] <strcat> benh: fair scheduling distributes approximately equal time to each task, which has overhead
[14:03:44] <strcat> benh: you can use SCHED_BATCH for an individual thread
[14:03:56] <strcat> SCHED_BATCH -> longer time slices, less caring about latency
[14:04:07] *** Joins: mawuli (mawuli@2760A9B5.4882C7ED.DE15C958.IP)
[14:04:23] <strcat> which is closer to not doing pre-emption
[14:04:24] *** Quits: mr_fribble (Mibbit@moz-FF8F47D8.messagelabs.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:04:46] <strcat> benh: also, green threads can't context switch on page faults
[14:05:22] <strcat> benh: one tasks accesses some memory not loaded from the disk -> entire green task scheduler is blocked
[14:05:33] <benh> 15:56 <@huon> benh: you can use channels outside a runtime <- ah, i got confused there in my toy test program because i also used a timer, which i can't use outside a runtime apparently, and didn't look closely enough... can i transparently use channels to communicate between threads that live in- and outside of a runtime?
[14:05:52] *** Quits: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us) (Ping timeout)
[14:06:00] <strcat> so you actually can't really write correct I/O with green threads atm
[14:06:01] <benh> strcat: gross :(
[14:06:01] <hirsch> rustc is crashing in this line: "static V: Vec<int> = vec!(-1);" is it a already known problem?
[14:06:22] <strcat> benh: user-mode scheduling on windows does handle that, along with switching on blocking syscalls
[14:06:43] <strcat> hirsch: well it's not something you can do
[14:06:46] <huon> benh: as long as you don't do any blocking operations outside a runtime, yes
[14:06:48] <strcat> it may or may not be a known bug, but it's invalid
[14:07:15] <benh> huon: Why is that?
[14:07:16] <huon> benh: (i.e. you can send freely, and ... try_recv(?) works, but the other recv variants don't.)
[14:07:26] <hirsch> strcat: Should I file a report as the error message suggest?
[14:07:33] <strcat> benh: imo something with no apparent benefits shouldn't lead to an enormous code for everyone else
[14:07:35] <benh> Does it try to suspend the current thread to the non-existing runtime?
[14:07:36] <strcat> hirsch: yes
[14:07:44] <hirsch> ok
[14:07:47] <strcat> enormous cost*
[14:07:49] <huon> benh: blocking essentially passes control back to a condition variable type thing (which is implemented differently for libgreen and libnative, i.e. needs the runtime)
[14:07:58] <benh> right
[14:08:19] <benh> strcat: I suspect you're convincing me
[14:08:33] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[14:08:33] <aochagavia> cmr: I am still fighting against this piece of code. I am using collect to generate a vector but there is an error which I cannot fix: https://gist.github.com/aochagavia/9ba500a31f15575d55f3
[14:09:02] <strcat> benh: and you need to call mmap + mprotect on spawning *any* task, green or not ;p
[14:09:09] <strcat> an additional clone call isn't such a big deal
[14:09:16] * strcat shrugs
[14:09:16] *** Quits: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[14:09:27] <benh> can't you amortize that by having a bunch of spare stacks
[14:09:31] <huon> (we do cache stacks for libgreen)
[14:09:37] <strcat> benh: glibc already does for 1:1 too
[14:09:51] <benh> does it amortize the clone calls too?
[14:10:06] <strcat> benh: no, but it's likely more expensive to retrieve a cached stack (cache miss) than call clone
[14:10:09] *** Tomcat is now known as Tomcat|afk
[14:10:12] <benh> (this is probably a very wrong way to use that word, sorry)
[14:10:15] <benh> oh, huh
[14:10:18] <strcat> context switches are not as expensive as some people like to pretend they are
[14:10:23] <benh> ok then
[14:10:40] <strcat> on 32-bit x86 they are expensive
[14:10:47] <strcat> on 64-bit they aren't
[14:11:00] <benh> What about on 32-bit smartphones
[14:11:06] <strcat> cheaper than 64-bit x86_64
[14:11:07] <aochagavia> Can somebody explain to me why this code is not valid? https://gist.github.com/aochagavia/9ba500a31f15575d55f3
[14:11:12] <strcat> x86 *
[14:11:14] <Ms2ger|sad> Context switches sure are hard for my brain :)
[14:11:29] <Havvy> Then your brain isn't 64bit.
[14:11:33] <strcat> benh: x86 had all those horrific things like segmented memory
[14:11:45] <strcat> and x86_64 dropped them + added the syscall instruction
[14:11:46] <benh> sweet
[14:11:46] <Ms2ger|sad> aochagavia, what's the error?
[14:12:35] <aochagavia> I am trying to use collect on a SetAlgebraItems object and the compiler complains that it contains ints instead of &ints
[14:12:41] <strcat> benh: technically glibc could probably cache threads themselves but it doesn't
[14:12:45] <Ms2ger|sad> Oh
[14:12:53] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[14:12:55] <aochagavia> literally: // Error: expected &ptr but found int
[14:13:05] <Ms2ger|sad> .map(|&x| x).collect()
[14:13:15] <strcat> benh: oh and as a bonus, 1:1 threads can actually be debugged - debuggers have thread support
[14:13:17] <strcat> ;p
[14:13:20] <pnkfelix> bstrie: wait, is the new reddit description for rust actually what the rust game *is* ?
[14:13:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:13:36] <strcat> benh: you can switch between threads in a debugger, and see the spawned threads
[14:13:40] <aochagavia> Ms2ger|sad: that made it! thank you...
[14:13:43] *** Quits: Guest (textual@moz-77D0F250.nebulazone.fi) (Ping timeout)
[14:13:47] *** Joins: Kruppe (user@moz-229E2B5E.dynamic.uwaterloo.ca)
[14:13:54] <strcat> benh: green threads don't have that, and also break anything like cachegrind/callgrind following code flow
[14:13:55] <aochagavia> Ms2ger|sad: do you know why we have to do that?
[14:14:07] <strcat> benh: so just by using it in your program, you make callgrind not work at all
[14:14:30] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[14:14:38] * strcat could go on ;p
[14:14:40] <huon> pnkfelix: I believe you can acquire clothes :P
[14:14:51] <Ms2ger|sad> aochagavia, in case it wasn't a set of ints, but, e.g. ~str, you can't really iterate over ~strs
[14:14:58] <pnkfelix> huon: yikes
[14:15:01] <benh> strcat: maybe you should write a blog post for when this comes up
[14:15:06] <Ms2ger|sad> aochagavia, so you have to iterate over &~str, or &T in general
[14:15:13] <strcat> benh: well I have to make a blog first
[14:15:13] <huon> pnkfelix: and possibly even things other than hatchets
[14:15:19] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Client exited)
[14:15:23] <benh> ok, a gist
[14:15:28] <Ms2ger|sad> aochagavia, did that come out understandable? :)
[14:15:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:15:47] <aochagavia> Ms2ger|sad: I think so... But without explanation it is impossible to know it
[14:15:55] *** Joins: jviereck (Adium@moz-1E767588.ethz.ch)
[14:16:11] <edwardw> aochagavia: try `let set1 = range(0,10).collect::<HashSet<int>>();` etc.
[14:16:51] <edwardw> `let mut set1 = ...` to be precise
[14:17:38] *** Joins: koonchun (matti@moz-C76D747C.dhcp.inet.fi)
[14:18:51] *** Quits: Kruppe (user@moz-229E2B5E.dynamic.uwaterloo.ca) (Ping timeout)
[14:18:52] <Ms2ger|sad> OH: "a compiler generator generator generator"
[14:20:09] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[14:20:10] *** Quits: philix_ (felipe@moz-CB0FA9E2.user.veloxzone.com.br) (Ping timeout)
[14:20:10] *** Joins: philix (felipe@moz-E99EB69.user.veloxzone.com.br)
[14:20:41] <aochagavia> edwardw: thanks for the tip
[14:20:52] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[14:21:29] <huon> stevekla1nik: the 'Pacabel' character on HN with whom you're discussing backward compatibility is a bit of a troll about that (they make very similar comments on every Rust thread, and seem to have some sort of vague mozilla hate). Feel free to not waste your time. :)
[14:23:52] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[14:24:22] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:24:30] *** Joins: yusukesuzuki-offline (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[14:24:41] *** Quits: Ferreus (ferreus@moz-B5D63601.dip0.t-ipconnect.de) (Quit: WeeChat 0.4.4-dev)
[14:25:06] *** Joins: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us)
[14:25:36] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[14:25:54] *** Quits: yusukesuzuki-offline (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[14:25:59] *** Quits: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP) (Quit: vhbit)
[14:26:44] *** Quits: edwardw (Mibbit@EE646FE3.EE06708D.4BFBD933.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:26:46] *** Joins: yusukesuzuki-off (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[14:26:52] *** jorendorff is now known as jorendorff_away
[14:27:33] <Ms2ger|sad> huon, hey, I'm quite happy with /vague/ Mozilla hate at this point
[14:27:46] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[14:28:03] <Yoric> Yeah, that's an improvement.
[14:28:47] *** Joins: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP)
[14:28:57] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Quit: Leaving.)
[14:29:06] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[14:29:10] *** Quits: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP) (Quit: Textual IRC Client: www.textualapp.com)
[14:29:29] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[14:29:34] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[14:29:55] *** Joins: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP)
[14:30:04] <huon> Ms2ger|sad: well I said "vague" because I've noticed them pop up a few firefox things; AFAIK they're rabidly offended by everything mozilla stands for, but I just haven't been those threads. :P
[14:30:22] *** Joins: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP)
[14:30:33] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[14:31:02] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[14:31:13] *** jorendorff_away is now known as jorendorff
[14:31:17] *** Joins: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP)
[14:32:00] *** Quits: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net) (Ping timeout)
[14:32:14] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[14:33:15] *** Quits: rcxdude (rcxdude@moz-24B1F019.range86-179.btcentralplus.com) (Ping timeout)
[14:33:26] *** Joins: Kruppe (user@moz-CF1D83B0.dynamic.uwaterloo.ca)
[14:33:56] *** Joins: judder (maradukewa@BD9E6B94.126EFFE1.78E362FE.IP)
[14:34:07] *** Quits: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP) (Client exited)
[14:34:28] *** Joins: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP)
[14:34:46] *** Joins: mib_bmbnyd (Mibbit@moz-F69B8202.hsi13.kabel-badenwuerttemberg.de)
[14:34:59] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[14:35:08] *** Joins: edwardw (edwardw@13A2FE5.E4C8743.30C05AB6.IP)
[14:35:10] *** Quits: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca) (Quit: Leaving.)
[14:35:19] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[14:35:49] *** Joins: rcxdude (rcxdude@moz-24B1F019.range86-179.btcentralplus.com)
[14:36:09] *** Quits: rylev (rylev@EA7E8A28.9008D2A4.59369754.IP) (Ping timeout)
[14:38:47] *** Quits: Ms2ger|sad (Ms2ger@moz-4A14BC33.ugent.be) (Ping timeout)
[14:39:16] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Ping timeout)
[14:39:32] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[14:40:03] <farcaller> should I submit 'internal compiler error: unexpected failure' bug if I cannot reliably provide a source to reproduce?
[14:41:07] <SiegeLord> The log may still be useful
[14:41:40] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[14:43:08] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[14:44:06] <aochagavia> how does size_hint work?
[14:44:39] <aochagavia> can I use it to know the amount of items that will be yielded by the iterator?
[14:44:40] *** Quits: Sorella (quildreen@AA4589ED.97245BEB.1ED99692.IP) (Ping timeout)
[14:44:50] <farcaller> SiegeLord: had rust-core compiled with older rust, recompiled -- no error
[14:45:55] *** Quits: koonchun (matti@moz-C76D747C.dhcp.inet.fi) (Ping timeout)
[14:46:33] *** Joins: voxpopuli (fanservice@EE3832E.191E59C5.689607DE.IP)
[14:47:19] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[14:48:40] *** Quits: mib_bmbnyd (Mibbit@moz-F69B8202.hsi13.kabel-badenwuerttemberg.de) (Quit: http://www.mibbit.com ajax IRC Client)
[14:49:31] *** Quits: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us) (Ping timeout)
[14:50:13] *** Quits: ramitos (ramitos@moz-53A6C51A.rev.vodafone.pt) (Quit: Computer has gone to sleep.)
[14:50:26] *** Quits: hirsch (Mibbit@moz-93FB92D1.itwm.fhg.de) (Quit: http://www.mibbit.com ajax IRC Client)
[14:50:47] *** Joins: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us)
[14:51:16] *** Joins: stumpart (barrington@moz-93393D0A.hsd1.ca.comcast.net)
[14:52:14] *** zz_kimundi is now known as kimundi
[14:52:36] *** Joins: mortisha (Mibbit@moz-F69B8202.hsi13.kabel-badenwuerttemberg.de)
[14:54:15] *** Quits: Nekit1234007_ (Nekit12340@BA29A3B9.E3D471A2.4707F662.IP) (Ping timeout)
[14:55:04] <kimundi> aochagavia: size_hint() on its own can give you a approximate lower/upper bound of how many items are going to be yielded by it, which can be used for preallocating datastructures. If the iterator also implements ExactSize, then the hint is exact and can be used for exact computations
[14:55:34] *** Quits: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net) (Ping timeout)
[14:55:48] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[14:58:37] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[14:58:52] *** Joins: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no)
[14:58:59] *** Joins: EastByte_ (EastByte@moz-76991A0C.ewe-ip-backbone.de)
[14:59:04] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[14:59:17] *** Quits: Kruppe (user@moz-CF1D83B0.dynamic.uwaterloo.ca) (Ping timeout)
[14:59:27] *** Quits: EastByte (EastByte@moz-BCB26749.ewe-ip-backbone.de) (Ping timeout)
[14:59:54] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[15:00:44] *** Joins: Sorella (quildreen@AA4589ED.97245BEB.1ED99692.IP)
[15:00:57] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[15:02:42] *** Joins: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net)
[15:03:17] *** Quits: sk (sk@35CFDE22.E993C7C3.78DD174B.IP) (Input/output error)
[15:03:31] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[15:04:08] *** Joins: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca)
[15:04:22] *** Quits: StarLight (StarLight@A28C84DE.EDD80F1A.F1EF1E39.IP) (Ping timeout)
[15:05:39] *** Joins: cschneid (cschneid@moz-CA025D57.ip.mcleodusa.net)
[15:07:51] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[15:08:06] *** Joins: StarLight (StarLight@moz-BE4805EE.dynamic.avangarddsl.ru)
[15:08:36] *** Joins: benjamin_____ (benjamin@moz-A884F8A1.dip0.t-ipconnect.de)
[15:08:39] *** Joins: Nekit1234007_ (Nekit12340@moz-49BE8E9E.dyn.broadband.iskratelecom.ru)
[15:09:12] *** Quits: benjamin_ (benjamin@moz-3A224608.dip0.t-ipconnect.de) (Ping timeout)
[15:09:15] *** Joins: daschl (Adium@241A3D04.D9093240.9C3DCB4C.IP)
[15:09:32] *** Quits: mye (mye@D3BCC65C.AFBA3AA1.FD9D6DD1.IP) (Ping timeout)
[15:12:41] *** Joins: ramitos (ramitos@moz-4AE1B148.rev.vodafone.pt)
[15:13:23] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:13:46] *** Quits: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us) (Ping timeout)
[15:15:31] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:15:56] *** Quits: Earnestly (earnest@moz-6CD1AB70.dyn.plus.net) (Ping timeout)
[15:16:00] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:16:45] *** Quits: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Input/output error)
[15:17:52] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Client exited)
[15:18:19] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Quit: csherratt)
[15:19:24] *** Joins: phay (phay@40C6FED8.67283D6.5AB2926A.IP)
[15:20:20] <SiegeLord> Is there a good way to clear the search page in rustdoc?
[15:20:28] *** Joins: mib_qcy82g (Mibbit@moz-5B90455D.cn.ru)
[15:20:42] <SiegeLord> You often end up at one when you go backwards in history
[15:20:57] <SiegeLord> Ah, escape does the trick
[15:21:10] *** Quits: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de) (Quit: Leaving.)
[15:21:39] *** Quits: osa1 (omer@7480CF3D.7B7767E.3688B332.IP) (Quit: Konversation terminated!)
[15:22:01] *** Joins: willingc (willingc@moz-F095E013.san.res.rr.com)
[15:22:01] *** Quits: ramitos (ramitos@moz-4AE1B148.rev.vodafone.pt) (Connection reset by peer)
[15:22:17] <Tobba> has anyone here gotten wxRust to work on windows?
[15:22:18] *** Quits: jviereck (Adium@moz-1E767588.ethz.ch) (Ping timeout)
[15:23:01] <Tobba> I'm considering just writing a support wrapper for myself because wxc is involved in some cmake/cthulhu mess
[15:24:12] *** Quits: voxpopuli (fanservice@EE3832E.191E59C5.689607DE.IP) (Ping timeout)
[15:24:27] *** Quits: phay (phay@40C6FED8.67283D6.5AB2926A.IP) (Quit: phay)
[15:25:54] *** Quits: mib_qcy82g (Mibbit@moz-5B90455D.cn.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[15:26:58] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[15:27:19] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:27:35] *** Quits: mortisha (Mibbit@moz-F69B8202.hsi13.kabel-badenwuerttemberg.de) (Quit: http://www.mibbit.com ajax IRC Client)
[15:28:30] *** Quits: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca) (Quit: Leaving.)
[15:28:59] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[15:29:49] <paraze> Hey :)
[15:29:54] <paraze> How many version left until the 1.0 ?
[15:30:44] *** Quits: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[15:31:24] *** Joins: Earnestly (earnest@moz-2C691159.dyn.plus.net)
[15:31:30] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[15:31:53] *** Quits: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[15:32:12] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:33:31] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[15:33:35] <Tobba> pretty sure its a "when its done" thing but going for 2014?
[15:33:47] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[15:33:51] <Tobba> and versions are just tags added every... 3 or 4 months?
[15:34:10] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[15:34:23] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[15:34:43] *** Quits: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP) (Ping timeout)
[15:35:22] *** Quits: themgt (themgt@moz-235071C6.dhcp.hckr.nc.charter.com) (Quit: themgt)
[15:35:53] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[15:36:15] <paraze> And what remains to be done ?
[15:36:34] <Tobba> every issue marked with uh...
[15:36:45] *** Quits: dpanth3r (dinofelis@228444B8.6B06001A.BB6F225C.IP) (Ping timeout)
[15:36:47] *** Joins: dpanth3r (dinofelis@228444B8.6B06001A.BB6F225C.IP)
[15:36:48] <Tobba> theres a tag for it, I forgot it
[15:36:57] <Tobba> also a milestone I think
[15:38:55] *** Joins: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[15:39:08] <edwardw> paraze: 1.0 issues: bit.ly/1dM8ii2 it's in the topic
[15:39:51] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[15:40:27] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[15:41:05] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[15:41:25] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[15:41:45] *** Joins: Ms2ger|sad (Ms2ger@moz-98421F60.adsl-dyn.isp.belgacom.be)
[15:42:06] <paraze> Wow, thx ^^ (and sorry, didn't see it)
[15:42:15] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[15:42:22] <paraze> And er.... good luck developers :p
[15:42:39] *** Joins: arturo (Mibbit@moz-E83B14F0.superkabel.de)
[15:43:13] *** Joins: bjustin (bjustin@moz-8FC28563.sierrabravo.net)
[15:43:53] *** Quits: arturo (Mibbit@moz-E83B14F0.superkabel.de) (Quit: http://www.mibbit.com ajax IRC Client)
[15:44:07] *** Quits: edwardw (edwardw@13A2FE5.E4C8743.30C05AB6.IP) (Ping timeout)
[15:44:08] *** Joins: arturo (arturo@moz-AF1E4A33.clients.kiwiirc.com)
[15:44:27] *** Quits: heftig (heftig@moz-33D186ED.unitymedia.biz) (Quit: Quitting)
[15:44:49] *** Quits: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za) (Input/output error)
[15:44:53] *** Quits: benvie (bbenvie@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[15:46:04] *** Joins: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za)
[15:47:31] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:47:51] *** Joins: adonohue (adonohue@3332E4C0.6B10AC3.E2F59BBC.IP)
[15:47:57] *** Joins: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us)
[15:48:34] *** yusukesuzuki-off is now known as yusukesuzuki
[15:48:40] <SiegeLord> :o rust-ci is down
[15:49:00] *** Joins: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca)
[15:49:26] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[15:49:48] *** jorendorff is now known as jorendorff_away
[15:49:51] <farcaller> is it possible to access a macro defined in one file from another in same crate?
[15:50:16] *** Quits: untitaker (untitaker@moz-6D4BDF9B.adsl.highway.telekom.at) (Ping timeout)
[15:50:16] <strcat> not really, you can only bubble them up
[15:50:18] <strcat> not down
[15:50:21] <strcat> if that makes sense
[15:50:38] <strcat> farcaller: put the macro in a module by itself and include it in multiple places
[15:50:43] *** Quits: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: tobytailor)
[15:50:58] *** Joins: edwardw (edwardw@42B94DF.16F55560.50B134B9.IP)
[15:52:06] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[15:52:33] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Quit: Leaving.)
[15:52:35] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[15:54:33] <farcaller> strcat: something like this: https://gist.github.com/farcaller/ad3b2685e1112f500e19? doesn't work for me
[15:54:55] *** Quits: arturo (arturo@moz-AF1E4A33.clients.kiwiirc.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[15:55:07] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[15:55:29] <bpicolo> sfackler:  Are you around?
[15:56:19] <farcaller> strcat: I can drop the macro in dedicated crate with #[macro_export]. It's just that I want everything in single crate
[15:56:31] <strcat> farcaller: works fine with a module
[15:56:33] <strcat> doesn't need a crate
[15:56:37] <strcat> just include the module more than once
[15:56:52] *** Quits: daschl (Adium@241A3D04.D9093240.9C3DCB4C.IP) (Quit: Leaving.)
[15:57:18] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[15:57:34] *** Joins: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[15:57:46] *** Quits: SpaceWizard (Apollo@moz-8A6454A9.ellsworth-hs.ellsworth.k12.me.us) (Ping timeout)
[15:58:07] *** Joins: untitaker (untitaker@moz-7C5370C.adsl.highway.telekom.at)
[15:59:42] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[15:59:44] <farcaller> strcat: changed to mod, still getting an error: https://gist.github.com/farcaller/ad3b2685e1112f500e19
[16:00:10] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[16:00:24] <strcat> farcaller: the module needs macro_escape
[16:01:50] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[16:02:10] *** Joins: astroch (astroch@46FC9279.474E6E0A.DDE5D3F6.IP)
[16:02:15] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Client exited)
[16:02:38] *** Joins: daschl (Adium@241A3D04.D9093240.9C3DCB4C.IP)
[16:02:41] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[16:02:45] *** Joins: csherratt (csherratt@moz-4D27AE59.eng.wind.ca)
[16:03:37] <farcaller> strcat: thanks!
[16:04:34] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[16:05:06] *** Joins: onelson (owen@moz-DD666EC5.laika.com)
[16:05:47] *** Quits: benjamin_____ (benjamin@moz-A884F8A1.dip0.t-ipconnect.de) (Ping timeout)
[16:06:54] *** Joins: mye (mye@moz-35E7816B.swh.uni-giessen.de)
[16:07:46] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[16:08:11] <farcaller> what's the modern rust way to do 'rustc --lib --emit-llvm -passes inline'? 'rustc --crate-type lib --emit bc ..?'
[16:08:23] <farcaller> trying to compile russt-core's support.rs
[16:08:41] *** Quits: twi (Adium@moz-429185BE.cust.vodafonedsl.it) (Quit: Leaving.)
[16:08:43] <strcat> --emit=ir --crate-type=lib
[16:08:49] <strcat> er
[16:08:59] <strcat> --emit=bc *
[16:09:11] <farcaller> what about -passes inline?
[16:09:19] <strcat> -C passes inline
[16:09:29] <farcaller> thanks
[16:09:29] <strcat> I'll update the README
[16:09:51] <strcat> -C passes=inline *
[16:10:20] *** Quits: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl) (Ping timeout)
[16:11:04] *** Joins: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[16:12:17] *** Joins: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net)
[16:13:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:13:50] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[16:14:23] <farcaller> and just to be sure, passing that .bc to llc and then to as is the simplest way, if I don't have cross-clang?
[16:14:40] <strcat> yes, although llc doesn't do the same optimization stack as clang/rustc
[16:15:00] <strcat> farcaller: you'll also need llvm-link to link the bytecode files together
[16:15:25] <farcaller> strcat: I get the object file which is linked by gnu ld directly
[16:15:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:16:00] <farcaller> any good reason to use llvm-link (that uses ld underneath, iirc)?
[16:16:10] <strcat> no it doesn't use ld underneath
[16:16:15] <farcaller> ah.
[16:16:17] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[16:16:20] <strcat> it takes more than one bc and makes another
[16:16:23] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[16:16:32] <strcat> LTO vs. separate compilation
[16:17:36] <farcaller> so I have main.o (my crate), libcore/core.o (extracted obj from libcore) and boot.o (C code). Linking all that with gnu ld, expected to add support.o (from support.rs) here as well
[16:17:43] *** pmoore is now known as pmoore|brb
[16:17:54] <paraze> Oh, I get a lot of errors with the new version, a lot of "mismatched types: expected `uint` but found `int`", have I to use a lot of "as uint" ?
[16:18:01] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Ping timeout)
[16:18:18] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[16:18:44] <farcaller> to get lto benefits, I need to get bc output from all that (apart from c code) and llvm-link it, right?
[16:19:15] <edwardw> paraze: maybe because of this one: https://github.com/mozilla/rust/pull/13257
[16:19:30] <edwardw> indices are now required to be uint
[16:19:50] *** Quits: csherratt (csherratt@moz-4D27AE59.eng.wind.ca) (Ping timeout)
[16:21:57] *** Quits: jdavis (jdavis@moz-1BE8A6A1.hsd1.ca.comcast.net) (Ping timeout)
[16:22:03] *** Joins: leowoe (Leo@moz-EFFAD7B5.dip0.t-ipconnect.de)
[16:22:31] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[16:23:22] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: ZZZzzz…)
[16:23:58] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[16:24:35] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[16:24:43] *** Quits: willingc (willingc@moz-F095E013.san.res.rr.com) (Client exited)
[16:25:08] *** Joins: hoverbea_ (hoverbear@726D908C.44E18222.E74D50F2.IP)
[16:25:51] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Ping timeout)
[16:29:06] *** Joins: csherratt (csherratt@moz-4D27AE59.eng.wind.ca)
[16:29:10] *** Quits: hoverbea_ (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[16:29:52] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[16:30:10] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[16:30:16] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[16:30:16] *** ChanServ sets mode: +o pnkfelix
[16:30:17] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[16:30:31] *** Quits: sankha93 (sankha93@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[16:32:13] *** Joins: willingc (willingc@moz-F095E013.san.res.rr.com)
[16:33:52] *** Joins: twi (Adium@moz-429185BE.cust.vodafonedsl.it)
[16:33:55] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[16:34:22] *** Joins: aravindavk (aravinda@1835D1B2.1436F502.C28A6AA4.IP)
[16:34:23] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[16:35:08] *** Quits: csherratt (csherratt@moz-4D27AE59.eng.wind.ca) (Connection reset by peer)
[16:35:20] <alan_andrade> What the #[inline] for ?
[16:36:26] <Tari> permits cross-crate inlining when LTO is off
[16:38:07] <farcaller> strcat: if I get .bc from rustc, then pass it to llvm-link and opt, it still means that I'm missing on some rustc link optimisations, no?
[16:38:09] <alan_andrade> gotcha
[16:38:15] <alan_andrade> thanks tari
[16:38:36] <strcat> farcaller: well opt isn't identical to clang
[16:39:02] *** Joins: csherratt (csherratt@moz-4D27AE59.eng.wind.ca)
[16:39:09] <strcat> but it's close
[16:39:20] <farcaller> strcat: what I want to have is highly optimised obj file that I can pass down to gnu ld. which way should I go?
[16:39:31] <strcat> llvm-link + opt + llc, or clang
[16:40:15] <strcat> (with -flto passed to clang)
[16:40:17] <farcaller> strcat: I will need to get the rust-core core.bc.deflate, unpack it and pass it to llvm-link as well, right?
[16:40:41] <farcaller> strcat: also I thought that rust's stack bounds check is link time, no?
[16:40:57] <strcat> farcaller: no you don't need to get that core.bc file
[16:41:02] <strcat> rustc already links it with your code
[16:41:07] <strcat> just pass -Z lto to rustc
[16:41:17] <farcaller> hm.
[16:41:25] <strcat> the bytecode output from rustc includes what you used from core.bc as long as you used -Z lto
[16:42:08] *** Quits: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za) (Ping timeout)
[16:42:26] *** Quits: csherratt (csherratt@moz-4D27AE59.eng.wind.ca) (Quit: csherratt)
[16:43:02] *** Quits: aravindavk (aravinda@1835D1B2.1436F502.C28A6AA4.IP) (Ping timeout)
[16:43:03] *** Joins: dradtke1 (dradtke@moz-849051B9.il.subnet.cable.rcn.com)
[16:43:20] <eddyb> the stack bounds check is IR -> assembly "time"
[16:44:29] <farcaller> so there's really no reason to mess with llvm-link unless I want lto optimisations from mem* in support.rs
[16:44:32] <dradtke1> does cloning a function pointer work for anyone?
[16:44:46] <dradtke1> I'm running into a weird error trying to derive Clone on a struct that contains one
[16:44:58] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:47:27] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Taking a nap.)
[16:48:03] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[16:49:25] <strcat> farcaller: yeah, it might make the binary smaller by an insignificant few bytes though
[16:49:50] *** Joins: orospakr (orospakr@E5F02728.3C7B6A44.86CC3CCD.IP)
[16:49:55] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[16:50:19] <Tobba> will a (u8, u8, u8, u8) become 4 bytes
[16:50:22] <farcaller> strcat: I can't get visibility on __aeabi_memset anyway: main.rs:(.text+0x10a2): undefined reference to `__aeabi_memset'
[16:50:23] <Tobba> or is that undefined
[16:50:30] <farcaller> strcat: (added it to support.rs: pub extern "C" fn __aeabi_memset(s: *mut u8, n: int, c: c_int))
[16:50:54] <farcaller> I guess I can live with two functions in my c code :)
[16:51:44] *** Joins: jdavis (jdavis@moz-1BE8A6A1.hsd1.ca.comcast.net)
[16:51:44] *** Joins: TeXitoi (sihem@moz-D37F3D03.eu)
[16:52:06] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Quit: Leaving.)
[16:53:56] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[16:54:01] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[16:54:34] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[16:56:30] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[16:56:38] *** Joins: nkoep (nik@moz-F87FACD6.pool.mediaways.net)
[16:56:41] *** Joins: SpaceManiac (Tad@moz-6DF2BCF0.dorm.utexas.edu)
[16:58:46] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[16:59:14] *** Joins: hirschen (hirschen@moz-B73683DE.superkabel.de)
[16:59:52] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[17:00:03] *** hirschen is now known as hirsch
[17:00:27] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[17:00:56] *** Joins: gp5st (jim@moz-14388241.hsd1.pa.comcast.net)
[17:00:56] <bascule>  13_4__8__ 9_11__12_  13_4__ 8_9__11_    13_ 4_8_   11__12_ 13_ 4_ 
[17:00:59] <bascule> 4|  8_9__11|  12_ 13\4|_ 8_9|  11_ 12\  4/ 8\\ 9\ 11/ 12/ 13| 4| 8|
[17:01:02] <bascule> 8| 9|_  12| 13|_4) 8|| 9|11| 12| 13| 4|/ 8_ 9\11\ 12V 13/| 4| 8| 9|
[17:01:05] <bascule> 9|  11_12| 13|  4_ 8< 9| 11|12| 13|_4| 8/ 9__11_ 12\| 13| 4|8_|9_|11_|
[17:01:08] <bascule> 11|_12|   4|_8| 9\_11\_12__13|_4__8_/9_/   12\13_\4_| 8(9_|11_|12_)
[17:01:11] <bascule>                                         
[17:01:19] <bpicolo> FRMXL?
[17:01:33] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[17:01:35] <bascule> FRIDAY!!!
[17:01:46] *** Quits: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP) (Quit: My Mac Pro has gone to sleep. ZZZzzz…)
[17:01:58] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[17:01:59] <SiegeLord> Anybody use Travis to upload docs to their gh-pages?
[17:02:32] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[17:02:57] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[17:02:57] *** Joins: khodzha1 (khodzha@731736BB.A859D9FD.CA6E2165.IP)
[17:03:01] *** Joins: rchar (mark@16F93251.43AE57A3.2CFE048.IP)
[17:03:04] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:03:18] <gp5st> hello. i'm obviously doing something very wrong, but I can't figure it out
[17:03:19] <gp5st> https://gist.github.com/jimktrains/9978755
[17:03:29] *** Quits: khodzha (khodzha@BA385EB4.A859D9FD.CA6E2165.IP) (Ping timeout)
[17:03:44] <gp5st> (i'm recompiling from master right now, but that version is what's installed at the moment)
[17:03:56] *** Parts: codl (uid28108@moz-A42E5B7B.irccloud.com) ()
[17:03:58] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[17:04:13] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[17:04:42] <SiegeLord> You want to use 'extern crate time;' instead of 'use time;'
[17:04:44] <benh> gp5st: use time; ---> extern crate time;
[17:04:47] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[17:04:49] *** Quits: leowoe (Leo@moz-EFFAD7B5.dip0.t-ipconnect.de) (Quit: Leaving.)
[17:05:05] <gp5st> benh: SiegeLord that also errors. one sec
[17:05:14] <benh> compiles with master, anyway
[17:05:31] <benh> 'use' is "here's a path to something that already exists, i want a shorter name for that path"
[17:05:34] *** Quits: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net) (Quit: ziad)
[17:05:55] <benh> 'extern crate' is "please load the rust lib with that name and put it into scope under that same name"
[17:05:57] <gp5st> extern crate time; gives the error: "error: expected `{` or `mod` but found `crate`"
[17:06:02] <gp5st> gotchya
[17:06:13] <benh> try extern mod time; then until your master compiler finishes building
[17:06:28] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[17:06:29] *** Joins: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP)
[17:06:44] *** Quits: orospakr (orospakr@E5F02728.3C7B6A44.86CC3CCD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:06:50] <benh> might be that the crate didn't exist back then either...
[17:06:50] <gp5st> can't find crate time:-/ I'll wait for master to compile. 
[17:07:01] <benh> could also use nightly/0.10 release binaries
[17:07:40] <gp5st> perhaps. i just have a habit of compiling from source.
[17:08:01] <gp5st> be back in a few minutes. thanks for your help.  I'll get a nightly build, try it, and go from there:)
[17:08:02] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[17:08:10] *** Quits: gp5st (jim@moz-14388241.hsd1.pa.comcast.net) (Quit: Leaving.)
[17:09:17] *** Quits: japaric_ (japaric@F0EDDE6E.BD5E6C4A.766D0B82.IP) (Ping timeout)
[17:09:22] *** Joins: japaric_ (japaric@1E5F324A.FD3D1332.95AFB88D.IP)
[17:10:13] *** Quits: Kxepal (Miranda@moz-73B536A.pppoe.mtu-net.ru) (Ping timeout)
[17:10:22] *** Quits: maxli (Adium@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[17:11:33] *** Joins: maxli (Adium@moz-B19F68ED.student.cs.uwaterloo.ca)
[17:11:53] *** Joins: celm (celm@28EA790F.C8D2EDAC.4E808C72.IP)
[17:12:36] *** jorendorff_away is now known as jorendorff
[17:13:00] *** Joins: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[17:13:11] *** Quits: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: tobytailor)
[17:13:19] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:13:54] *** Quits: Sorella (quildreen@AA4589ED.97245BEB.1ED99692.IP) (Ping timeout)
[17:14:23] *** Joins: Sorella (quildreen@moz-35210410.user3p.veloxzone.com.br)
[17:14:34] *** Joins: Kxepal (Miranda@moz-78168BB9.pppoe.mtu-net.ru)
[17:14:42] *** Joins: azakai (alon@moz-62518563.mtv2.mozilla.com)
[17:14:55] *** Quits: marc_ (uid5324@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[17:15:31] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:17:12] *** Joins: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[17:18:49] *** Joins: Zolrath (Mibbit@moz-858414B5.dhcp.snlo.ca.charter.com)
[17:19:13] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[17:19:47] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[17:19:48] *** Joins: Matthias247 (Miranda@moz-678B5E4A.hsi2.kabel-badenwuerttemberg.de)
[17:19:50] *** Joins: syatchmenoff (samy@moz-AB5B740D.hsd1.or.comcast.net)
[17:20:46] *** Joins: brendan (brendaneic@moz-62518563.mtv2.mozilla.com)
[17:20:50] *** Quits: daschl (Adium@241A3D04.D9093240.9C3DCB4C.IP) (Quit: Leaving.)
[17:20:53] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[17:21:10] *** Joins: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP)
[17:23:17] *** Joins: gp5st (james.keen@moz-BE2E31F9.pitbpa.fios.verizon.net)
[17:23:32] <gp5st> hey! so yeah, having a more recent build fixed that
[17:23:46] *** Quits: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[17:23:56] *** Joins: Rym (y@393F734D.E175BF4B.51C6DE68.IP)
[17:24:03] *** Quits: ehsanul (harish@moz-24DD2596.hsd1.ca.comcast.net) (Ping timeout)
[17:25:03] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: ZZZzzz…)
[17:27:16] *** Quits: io2 (io2@moz-EE406A5.home.otenet.gr) (Quit: ...take irc away, what are you? genius, billionaire, playboy, philanthropist)
[17:27:41] *** Quits: Zolrath (Mibbit@moz-858414B5.dhcp.snlo.ca.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[17:28:01] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[17:28:21] *** Parts: dradtke1 (dradtke@moz-849051B9.il.subnet.cable.rcn.com) ()
[17:28:31] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[17:29:37] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[17:29:51] *** Joins: kermi (Mibbit@moz-D4E86C09.mtu.briworks.net)
[17:30:09] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[17:30:16] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[17:30:24] *** Joins: q66 (q66@moz-D66D80D.range86-132.btcentralplus.com)
[17:30:35] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[17:30:41] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[17:30:52] *** Quits: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP) (Quit: colinsurprenant)
[17:31:21] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[17:32:08] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:32:30] *** jorendorff is now known as jorendorff_away
[17:32:39] *** Joins: jcd (jcdyer@moz-A3797E8E.hsd1.in.comcast.net)
[17:32:55] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[17:33:23] *** Quits: asmyers (quassel@2D30C89C.A07F7734.FAA4474F.IP) (Ping timeout)
[17:33:49] *** jorendorff_away is now known as jorendorff
[17:34:09] <kermi> is there a list of rust compiler error messages?
[17:34:21] *** Joins: themgt (themgt@moz-235071C6.dhcp.hckr.nc.charter.com)
[17:34:28] <strcat> kermi: no, they're spread out through librustc
[17:35:07] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[17:35:40] *** Joins: mib_b0r367 (Mibbit@moz-D4E86C09.mtu.briworks.net)
[17:35:51] *** Quits: adonohue (adonohue@3332E4C0.6B10AC3.E2F59BBC.IP) (Quit: adonohue)
[17:36:09] <kermi> ok thanks
[17:36:13] *** Quits: kermi (Mibbit@moz-D4E86C09.mtu.briworks.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:36:15] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[17:36:19] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Ping timeout)
[17:37:05] *** Joins: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP)
[17:37:17] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Ping timeout)
[17:37:27] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[17:37:38] *** Joins: mpiechotka (mpiechotka@moz-4FE2263C.dynamic.mnet-online.de)
[17:38:38] *** Joins: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP)
[17:39:08] *** Quits: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP) (Ping timeout)
[17:40:37] *** Quits: SpaceManiac (Tad@moz-6DF2BCF0.dorm.utexas.edu) (Connection reset by peer)
[17:40:39] <gp5st> sorry:( i have an i64. is there a nice way to convert it to a u64?
[17:40:39] *** Quits: patpatter (patpat@moz-21619C28.as13285.net) (Ping timeout)
[17:40:44] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[17:41:32] <Havvy> rusti:  100i64 as u64
[17:41:32] -rusti- 100
[17:41:46] <gp5st> oh, i wasn't familar with as
[17:41:50] *** Joins: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com)
[17:42:10] <bpicolo> it's for changing between numeric types
[17:42:18] <gp5st> thanks:)
[17:42:20] *** Quits: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Input/output error)
[17:42:20] <Havvy> Or between type wrappers.
[17:42:25] *** Joins: dpc (Mibbit@moz-88B014CD.nvidia.com)
[17:42:35] <dpc> Good morning everyone.
[17:42:40] <gp5st> g'morning
[17:42:55] <dpc> I have question about Cells / RefCell
[17:43:10] <TeXitoi> rusti: u64::from_primitive(100i64)
[17:43:13] -rusti- pastebinned 11 lines of output: http://ix.io/bu0
[17:43:18] <dpc> I'm dealing with a problem that I have object Game with a Vec<~Creature>
[17:43:39] <dpc> And sometimes I need to call one of the Creature with a mutable pointer to Game itself.
[17:43:53] <dpc> This would create an alias (mutable alias) and is not permited.
[17:44:24] <dpc> So I was told I could wrap ~Creature so that the Game contains Vec<RefCell<Creature>> and use borrow and borrow_try
[17:44:31] <dpc> And that would help.
[17:44:58] <dpc> But in my functions the borrowck still complains that Game is already borrowed with a mutable pointer.
[17:45:15] *** Quits: Nekit1234007_ (Nekit12340@moz-49BE8E9E.dyn.broadband.iskratelecom.ru) (Ping timeout)
[17:45:27] <Havvy> You can only borrow mutably a RefCell once at a time.
[17:45:39] <dpc> Yes, the RefCell
[17:45:59] <Havvy> You're borrowing it, calling some functions, and then trying to borrow it again.
[17:46:17] *** Joins: azita (Azita@moz-62518563.mtv2.mozilla.com)
[17:46:37] <dpc> http://pastebin.com/vp28d3zi
[17:46:45] *** Quits: aatch|mobile (aatch@moz-2BB0AC01.cable.telstraclear.net) (Client exited)
[17:46:48] *** Joins: aatch|mobile (aatch@moz-2BB0AC01.cable.telstraclear.net)
[17:47:04] *** Quits: oberstet (quassel@moz-B47F62FA.dynamic.mnet-online.de) (Client exited)
[17:47:51] <Havvy> Just pass 'self'
[17:48:04] *** Quits: astroch (astroch@46FC9279.474E6E0A.DDE5D3F6.IP) (Connection reset by peer)
[17:48:05] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:48:32] <dpc> Havvy: Doesn't change anything.
[17:48:42] *** Joins: astroch (astroch@46FC9279.474E6E0A.DDE5D3F6.IP)
[17:49:44] <Havvy> Oh, mutable iterator? I don't know how those work. :/
[17:49:52] <dpc> Well, in the loop, I think it's understandable.
[17:49:55] <dpc> But even without loop:
[17:50:03] <dpc> self.player.borrow_mut().act(self, action); 
[17:50:07] <Ms2ger|sad> Show your code
[17:50:20] <dpc> Is complaining that self is already borrowed (by self.player)
[17:50:28] *** Quits: mib_b0r367 (Mibbit@moz-D4E86C09.mtu.briworks.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:50:34] <Rym> dpc: Might be worth making a basic code example, hard to judge from type + random 3 lines out of context
[17:51:15] <dpc> https://github.com/dpc/rustyhex/blob/broken/src/game.rs#L39
[17:51:15] <Rym> and, are you running 0.10?
[17:51:23] <dpc> Yesterdays build.
[17:51:47] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[17:52:14] *** Quits: derek_c (derek@moz-A43430DA.cit.cornell.edu) (Ping timeout)
[17:52:35] *** Quits: q66 (q66@moz-D66D80D.range86-132.btcentralplus.com) (Ping timeout)
[17:53:22] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:53:59] <edwardw> dpc: try `let GameState { creatures: ref mut crs, map: ref mut map .. } = *self; ...` and uses crs and map instead of `self.creatures` and `self.map` afterwards 
[17:54:03] *** Joins: Jesse (jruderman@moz-62518563.mtv2.mozilla.com)
[17:54:57] <kimundi> dpc: The &mut self.map borrows self, which then doesn't allow you to reborrow it for the act call that uses it. The solution is to create non overlapping borrows for the parts of the struct, edwardw wrote how to do that
[17:55:44] <dpc> kimundi: An article?
[17:55:45] *** Joins: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu)
[17:55:55] <Havvy> dpc:  A line of IRC think.
[17:55:56] <kimundi> dpc: the irc message before mine ;)
[17:55:57] <edwardw> dpc: ^^ my reply
[17:56:14] <dpc> I don't see it.
[17:56:16] <Havvy> What is `ref` and how does it work would be a nice article though.
[17:56:18] <dpc> Ah.
[17:56:19] <dpc> The line.
[17:56:20] <dpc> OK.
[17:56:21] *** Quits: Mowah (Mowah@moz-8548F376.cust.bredbandsbolaget.se) (Ping timeout)
[17:56:30] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[17:56:50] *** Joins: espindola (espindola@moz-35429B8.dsl.teksavvy.com)
[17:56:51] <dpc> But if I'm going to do it like this, do I need RefCells at all?
[17:57:43] <kimundi> dpc: Depends. If this is the only problem, then you don't need refcells to solve it.
[17:57:54] <dpc> Hmmm ...
[17:58:02] <dpc> But how does it suppose to work...
[17:58:09] <dpc> I clone GameState ...
[17:58:23] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[17:58:26] <dpc> And in case of iteration a iterate of copy?
[17:58:35] <dpc> iterate over *
[17:58:47] <kimundi> Hm? That line doesn't clone anything.
[17:58:48] *** Quits: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP) (Quit: colinsurprenant)
[17:59:00] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[17:59:03] <edwardw> dpc: no, it doesn't clone. hence the `ref`
[17:59:29] <TeXitoi> you don't clone, you take &mut from the different fields, but you still can't give self to a function
[17:59:46] <Havvy> What does ref actually do?
[18:00:02] <Eridius> Havvy: it binds the identifier to a reference to the value, instead of to the value itself
[18:00:09] <TeXitoi> give you a reference to a field
[18:00:10] *** Quits: astroch (astroch@46FC9279.474E6E0A.DDE5D3F6.IP) (Ping timeout)
[18:00:14] *** Joins: Nekit1234007_ (Nekit12340@moz-49BE8E9E.dyn.broadband.iskratelecom.ru)
[18:00:29] <kimundi> let GameState { creatures: ref mut crs, map: ref mut map .. } = *self is pattern matching to get to the fileds, and then create mutable reference bindings to them. No copy of any kind is happening there.
[18:00:41] <Eridius> Havvy: `let x = &y` and `let ref = x` are identical. Ref is primarily useful when destructuring (so you can bind to fields or tuple elements)
[18:00:42] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:00:54] *** Quits: kanaka (joelm@moz-99213C1D.lightspeed.ftwotx.sbcglobal.net) (Ping timeout)
[18:01:19] <TeXitoi> let ref x = y
[18:01:20] <Havvy> But having `ref mut T` is almost like having a RefCell?
[18:01:25] <Ms2ger|sad> No
[18:01:27] <Eridius> incidentally if you want to re-use the field name as the binding name you can use shorthand `let GameState { ref mut creatures, ref mut map } = *self`
[18:01:28] <Ms2ger|sad> Not at all
[18:01:28] <kimundi> Havvy: Totally different
[18:01:38] <Eridius> Havvy: RefCell is dynamic borrowing that the compiler doesn't know about
[18:01:42] <kimundi> Havvy: ref mut T is just a &mut T
[18:01:46] <Eridius> Havvy: mutable references are borrowing checked by the compiler (with zero runtime overhead)
[18:02:18] *** Joins: andrew-d_w (andrew-d_w@834514BB.7A62F771.CC0301A2.IP)
[18:02:24] *** Quits: andrew-d_w (andrew-d_w@834514BB.7A62F771.CC0301A2.IP) (Input/output error)
[18:02:35] <Havvy> But both allow for changing what they reference in an otherwise immutable struct?
[18:02:41] <kimundi> no
[18:02:42] *** Quits: TeXitoi (sihem@moz-D37F3D03.eu) (Quit: leaving)
[18:02:46] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[18:03:05] <edwardw> if `self` isn't mutable, one can't do `ref mut`
[18:03:10] <kimundi> ref mut only allows you to create mutable references to parts of a mutable struct
[18:03:14] *** Quits: Kynes (Kynes@moz-3DC6C6E7.mit.edu) (Quit: Leaving)
[18:03:21] <Havvy> Oh.
[18:03:49] <dpc> kimundi: So can't I just do let ref mut creatures = *self.creatures ?
[18:04:35] <kimundi> dpc: That would be identical to `let creatures = &mut self.creatures;`, which you already have
[18:04:36] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[18:05:08] <edwardw> dpc: you also need a mutable `map`, so deconstructing them in one go
[18:05:21] <kimundi> dpc: The reason fort the big pattern match is that _both_ ref mut bindings are created at the same time, and both cause self to be mutably borrowed.
[18:05:25] *** Joins: kanaka (joelm@moz-99213C1D.lightspeed.ftwotx.sbcglobal.net)
[18:05:38] *** Joins: alkino_ (alkino@moz-18C36E4E.w92-151.abo.wanadoo.fr)
[18:05:50] <kimundi> If you create the borrows serially, then the first one will borrow self as well, and cause the second one to not compile
[18:06:31] *** Joins: astroch (astroch@56C52E10.8878667B.DDE5D3F6.IP)
[18:06:57] <dpc> kimundi: Oh. The problem is that at the end I wanted to pass whole *self instead of just self.map ...
[18:07:36] <kimundi> dpc: Not directly. We are still talking about `self.player.act(&mut *self.map, action);` right?
[18:08:18] <dpc> kimundi: Yeah, but it's kind of intermitent version ... but maybe I can just pass both creatures and map ...
[18:08:34] <kimundi> The arguments to act are evaluated before the call
[18:08:48] <kimundi> So `&mut *self.map` gets evaluated
[18:09:00] *** Joins: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP)
[18:09:19] <kimundi> which makes a borrow to map, which recursivly also causes self to be borrowed, because its borrowed from a field of self
[18:09:52] <kimundi> so now self is mutably borrowed, and thus inaccessible until the borrow ends
[18:09:52] <dpc> https://github.com/dpc/rustyhex/blob/broken/src/game.rs#L46 What's wrong with my syntax
[18:10:21] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[18:10:21] <kimundi> dpc: its not types to plug in there
[18:10:32] <kimundi> dpc: This is a pattern, not a type specifier
[18:10:40] *** Joins: alonlevy_ (alon@8401866A.B68CC56E.51B98CA5.IP)
[18:10:46] <edwardw> dpc: also, you need a trailing .. since there're other fields
[18:11:21] <kimundi> rusti: let (a, b): (int, int) = (1, 2); a + b
[18:11:22] -rusti- 3
[18:11:29] <kimundi> dpc: ^ Simpler example
[18:11:41] *** Quits: alonlevy (alon@moz-A4A08D30.red.bezeqint.net) (Ping timeout)
[18:11:49] *** Quits: colinsurprenant (colin@2AADC632.55903650.5DADCDAE.IP) (Quit: colinsurprenant)
[18:11:57] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[18:11:57] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:12:06] <kimundi> (a, b) is a pattern that creates the bindings a and b, the value you plug in there has type (int, int), and it gets initialized with the expression (1, 2)
[18:12:10] <dpc> I know about tuple destruction, but class destruction is something new.
[18:12:17] <Ms2ger|sad> *struct :)
[18:12:18] <kimundi> dpc: Its analog
[18:12:27] <edwardw> dpc: let me find you a sample: https://github.com/mozilla/rust/blob/master/src/librustdoc/html/render.rs#L267
[18:12:27] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[18:12:29] <Ms2ger|sad> kimundi, nono, it's digital
[18:12:33] <Ms2ger|sad> (Sorry)
[18:12:38] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[18:12:40] <Earnestly> kimundi: (You don't have to tell it (int, int), but yeah)
[18:12:52] <kimundi> rusti: struct Foo { data: int }; let Foo { data: x }: Foo = Foo { data: 4 }; x
[18:12:52] *** Quits: mawuli (mawuli@2760A9B5.4882C7ED.DE15C958.IP) (Ping timeout)
[18:12:53] -rusti- 4
[18:12:56] *** Joins: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[18:13:19] <kimundi> Earnestly: I'm explicit here to make the distinction between type and pattern grammar clear
[18:13:38] <Earnestly> Yeah, fair enough
[18:14:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:14:58] *** Quits: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Ping timeout)
[18:16:29] *** Quits: Sorella (quildreen@moz-35210410.user3p.veloxzone.com.br) (Ping timeout)
[18:16:46] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[18:16:52] *** Quits: Rym (y@393F734D.E175BF4B.51C6DE68.IP) (Ping timeout)
[18:16:53] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[18:17:07] *** Joins: Sorella (quildreen@moz-35210410.user3p.veloxzone.com.br)
[18:18:01] *** Joins: Rym (y@393F734D.E175BF4B.51C6DE68.IP)
[18:18:31] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Ping timeout)
[18:18:45] <Tobba> is Rc<~[u8]> safe as a ready only data thing?
[18:19:13] <Havvy> Tobba:  As long as you don't grow it, it's future-safe.
[18:20:20] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[18:21:01] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[18:21:14] <alan_andrade> :') the new homepage is beautiful 
[18:21:50] *** Joins: ehsanul (harish@moz-A9E56CFE.hfc.comcastbusiness.net)
[18:22:12] <pcwalton> yeah, it's great
[18:22:57] <Havvy> Wasn't the tutorial there before?
[18:23:02] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[18:23:37] <herrwolfe45> the website looks great, did it just change last night?
[18:23:57] <Havvy> As part of the 0.10 release I think.
[18:24:42] <strcat> Tobba: you'll be able to do Rc<[T]> in the future to avoid indirection
[18:24:52] <Tobba> excellent
[18:25:24] <Tobba> turns out SDL doesnt like images more than 16000 pixels tall
[18:25:31] <Tobba> why does this thing generate sprite sheets laid out like this anyways jesus christ
[18:26:04] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[18:26:11] *** Joins: alonlevy (alon@7BE996CA.2941FB7D.51B98CA5.IP)
[18:26:39] *** Quits: alonlevy_ (alon@8401866A.B68CC56E.51B98CA5.IP) (Ping timeout)
[18:27:05] *** Joins: heftig (heftig@moz-1C08282B.dip0.t-ipconnect.de)
[18:31:02] *** Joins: janra (Janus@1CDC5701.A48867D7.52E4E107.IP)
[18:32:47] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:33:48] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[18:34:27] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[18:34:28] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:34:51] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:37:16] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:37:38] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[18:37:38] *** ChanServ sets mode: +o jdm
[18:37:57] *** Quits: onelson (owen@moz-DD666EC5.laika.com) (Ping timeout)
[18:38:05] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:39:01] *** Quits: japaric_ (japaric@1E5F324A.FD3D1332.95AFB88D.IP) (Ping timeout)
[18:39:36] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Client exited)
[18:39:57] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[18:40:30] *** Parts: gp5st (james.keen@moz-BE2E31F9.pitbpa.fios.verizon.net) ()
[18:40:45] <carllerche> I'm not quite sure why the lifetime here is being set to "static" when everything is done in a fn body: https://gist.github.com/carllerche/c426ece39be0705ba6c2
[18:41:17] *** Joins: japaric_ (japaric@E527F424.ABE6A7FD.E5B504CC.IP)
[18:41:38] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[18:41:40] *** Joins: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de)
[18:42:50] <acrichto> carllerche: hm, it seems that the equal_to() method is getting instantiated with T = "&'static str", which is then trying to make get_s() return &'static str (and it keeps going upwards)
[18:42:55] <acrichto> I would expect that to work though...
[18:42:56] <acrichto> nmatsakis: ^
[18:43:43] <carllerche> acrichto: I would expect it to work too. I tried reproing in much simpler cases and the general concept works
[18:43:48] *** Quits: pczarn (pczarn@moz-69A55FA.izacom.pl) (Input/output error)
[18:44:01] <acrichto> carllerche: try doing equal_to("foo".as_slice())
[18:44:05] <acrichto> that may not help much though
[18:45:03] <carllerche> acrichto: that worked
[18:45:04] *** Quits: Jesse (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse)
[18:45:25] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[18:46:05] *** Quits: FrozenCow (FrozenCow@moz-54300F7F.upc-j.chello.nl) (Client exited)
[18:47:47] <carllerche> acrichto: would you say this is a bug to report?
[18:48:14] *** Quits: willingc (willingc@moz-F095E013.san.res.rr.com) (Client exited)
[18:48:23] <acrichto> carllerche: sure!
[18:48:25] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[18:48:34] <acrichto> it's likely a dupe of an existing one
[18:48:37] <acrichto> but I wouldn't know which :(
[18:48:45] <carllerche> how would you describe it?
[18:49:08] <acrichto> carllerche: maybe dupe of https://github.com/mozilla/rust/issues/8874
[18:49:35] <acrichto> hmm... "static lifetime being required too often" ?
[18:49:37] <acrichto> maybe...
[18:49:51] *** Quits: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[18:49:58] *** Quits: astroch (astroch@56C52E10.8878667B.DDE5D3F6.IP) (Ping timeout)
[18:50:07] *** Joins: onelson (owen@moz-DD666EC5.laika.com)
[18:50:49] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[18:50:56] <carllerche> acrichto: thx, filed ticket
[18:51:04] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[18:51:05] *** Joins: Jesse (jruderman@moz-62518563.mtv2.mozilla.com)
[18:51:16] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[18:53:04] *** Quits: onelson (owen@moz-DD666EC5.laika.com) (Ping timeout)
[18:54:58] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[18:55:07] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[18:55:50] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:55:54] *** Joins: jim (Mibbit@moz-6968471.bstnma.fios.verizon.net)
[18:56:24] *** Quits: jim (Mibbit@moz-6968471.bstnma.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[18:56:30] *** Quits: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: tobytailor)
[18:57:00] *** Joins: mib_8001w6 (Mibbit@3E3094EC.34458CF2.CC1A2609.IP)
[18:57:04] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:57:59] *** Joins: uzi_mantis (iz@F7C4E486.BB968208.DDE5D3F6.IP)
[18:58:26] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[18:58:50] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Quit: Leaving.)
[18:58:51] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[18:58:57] *** Quits: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu) (Quit: lkuper)
[18:59:44] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[19:00:16] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[19:00:44] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[19:01:11] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[19:01:23] <uzi_mantis> hey guys
[19:01:58] <uzi_mantis> i'm trying to create some global variables, but the compiler's telling me to go to hell
[19:02:03] <uzi_mantis> the offending code's here: http://pastebin.com/qph2CG2c
[19:02:20] *** Joins: mihneadb (mihneadb@moz-9897BD47.static.ziggozakelijk.nl)
[19:02:34] <uzi_mantis> we suspect that it's not working because root_node references holder and buffer, which are other global variables, and we're not sure how to resolve such a dependency...
[19:02:38] <kmc> what's the error message
[19:03:13] *** Quits: brendan (brendaneic@moz-62518563.mtv2.mozilla.com) (Quit: brendan)
[19:03:19] *** Quits: alkino_ (alkino@moz-18C36E4E.w92-151.abo.wanadoo.fr) (Ping timeout)
[19:03:41] *** Quits: jcd (jcdyer@moz-A3797E8E.hsd1.in.comcast.net) (Ping timeout)
[19:04:05] <uzi_mantis> never mind, there's no compiler error.  we know we can access the node object's fields, but when we try to implement a global variable for the node there is nothing i nthe fields.
[19:04:25] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:04:53] *** Joins: jcd (jcdyer@moz-A3797E8E.hsd1.in.comcast.net)
[19:05:37] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[19:05:51] <kmc> unrelatedly, is there an easy way to go from &[T] to ~[&T], or Vec<&T>?
[19:06:18] <Ms2ger|sad> .iter().collect()?
[19:07:38] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:07:51] *** Quits: rchar (mark@16F93251.43AE57A3.2CFE048.IP) (Ping timeout)
[19:08:40] <kmc> thanks
[19:08:58] <strcat> rusti: static xs: &'static [u8] = &[1, 2, 3]; xs.iter().collect::<Vec<u8>>()
[19:09:01] -rusti- pastebinned 14 lines of output: http://ix.io/bub
[19:09:11] <strcat> rusti: static xs: &'static [u8] = &[1, 2, 3]; xs.iter().collect::<Vec<&u8>>()
[19:09:11] -rusti- [1, 2, 3]
[19:09:20] <khodzha1> How can I import IpAddr? "use std::io::net::ip::IpAddr;" gives me "unresolved name `IpAddr::from_str`"
[19:09:51] <kmc> from_str is a method on the FromStr trait
[19:09:54] <Ms2ger|sad> Also import FromStr?
[19:10:19] <kmc> you have to write FromStr::from_str, or just from_str if you 'use' it
[19:10:19] *** Quits: nfroidure (nfroidure@moz-E753E331.w90-18.abo.wanadoo.fr) (Ping timeout)
[19:10:26] <kmc> and type inference will figure out which type to produce
[19:11:26] *** Joins: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[19:11:50] *** Quits: philix (felipe@moz-E99EB69.user.veloxzone.com.br) (Ping timeout)
[19:12:19] *** Joins: philix (felipe@moz-E99EB69.user.veloxzone.com.br)
[19:13:08] *** Quits: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Ping timeout)
[19:13:37] *** Joins: colinsurprenant (colin@moz-5C42464.static.videotron.ca)
[19:13:38] <khodzha1> ah, I thought FromStr is imported automatically, thanks
[19:13:39] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[19:14:16] *** Quits: philix (felipe@moz-E99EB69.user.veloxzone.com.br) (Ping timeout)
[19:15:24] *** Joins: gimpf (gimpf@moz-64945CFF.adsl.highway.telekom.at)
[19:15:32] *** Joins: Shrike (Mibbit@moz-A385F6B1.nat.bb.dnainternet.fi)
[19:15:34] <Ms2ger|sad> It used to be
[19:16:16] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[19:16:34] <uzi_mantis> how can one initialize a global struct in rust?
[19:16:52] <kmc> uzi_mantis: like you were doing
[19:16:59] *** Quits: mib_8001w6 (Mibbit@3E3094EC.34458CF2.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:17:08] <Havvy> static x: MyStruct = MyStruct {}
[19:17:20] *** Joins: philix (felipe@moz-DED8EF62.user.veloxzone.com.br)
[19:17:47] <Eridius> khodzha1, Ms2ger|sad: you don't need to import FromStr. The prelude defines a global function from_str(x) that calls the trait method for you
[19:18:02] <Ms2ger|sad> Eridius, not anymore
[19:18:03] *** Quits: colinsurprenant (colin@moz-5C42464.static.videotron.ca) (Quit: colinsurprenant)
[19:18:11] <Eridius> this is why FromStr was taken out of the prelude, because the expectation is you'd just say from_str("127.0.0.1") and it would produce an IpAddress if that's how it's used
[19:18:20] <Ms2ger|sad> Oh?
[19:18:22] *** Joins: Kruppe (user@moz-7EF8488A.dynamic.uwaterloo.ca)
[19:18:25] <Eridius> rusti: let x: Option<uint> = from_str("123"); x
[19:18:26] -rusti- Some(123)
[19:18:31] <Ms2ger|sad> Oh good
[19:18:33] *** Joins: onelson (owen@moz-DD666EC5.laika.com)
[19:18:39] <Eridius> Ms2ger|sad: only the trait was removed. The function is actually defined directly in prelude, it's not even a re-export
[19:19:08] <uzi_mantis> and assuming a mutable global variable that instantiates that struct, we should be able to modify and access the fields of that struct instance wherever, right?
[19:19:25] <Ms2ger|sad> Eep, mutable global variable?
[19:19:44] <kmc> uzi_mantis: you can only use "static mut" from inside unsafe code
[19:19:51] <khodzha1> Eridius: and can I specify type without variable?
[19:19:52] <kmc> but yes, otherwise that is true
[19:19:53] *** Quits: bleibig (bleibig@moz-B4D9C5AF.hsd1.ca.comcast.net) (Ping timeout)
[19:20:10] <Eridius> khodzha1: if you use it in a context that requires an IpAddress, sure
[19:20:18] <nmatsakis> acrichto: carllerche: I'd have to dig into that to say precisely what's the cause, be sure to cc me on the bug, thanks
[19:20:41] <Eridius> khodzha1: passing the result of from_str() to a function that expects an IpAddress will constrain the return type just as much as the variable type annotation did
[19:20:41] <khodzha1> Eridius: and if it just `match`? :)
[19:20:48] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:20:54] <carllerche> nmatsakis: done :) https://github.com/mozilla/rust/issues/13323
[19:21:11] <Eridius> khodzha1: You can try. I don't know if match is smart enough to accept an un-constrained type to match on and constrain it based on the match arms
[19:21:17] <farcaller> I remember someone told me that rust supports custom sections placement, but I lost the attribule name and cannot google it up. any hints?
[19:21:39] <Eridius> rusti: match from_str("123") { None => 0, Some(1u) => 1, Some(x) => x }
[19:21:40] -rusti- 123
[19:21:44] <Eridius> khodzha1: apparently the answer is yes
[19:21:51] <Eridius> match will handle that
[19:21:54] *** Joins: colinsurprenant (colin@moz-5C42464.static.videotron.ca)
[19:23:07] <Eridius> farcaller: apparently it's #[link_section]
[19:23:20] <Eridius> well, probably #[link_section="foo"] but I don't know for sure
[19:23:31] <farcaller> that one, thanks!
[19:23:39] * farcaller went rewriting all the ISRs in rust
[19:23:42] <Eridius> farcaller: it works on functions and statics, according to this documentation
[19:23:54] *** Quits: Shrike (Mibbit@moz-A385F6B1.nat.bb.dnainternet.fi) (Quit: http://www.mibbit.com ajax IRC Client)
[19:24:01] <Eridius> farcaller: I took this from cmr's PR to update the manual to, among other things, document all the attributes: https://github.com/cmr/rust/blob/b727bb7febf8662ce4b45e46985ff192490cbbb5/src/doc/rust.md#miscellaneous-attributes
[19:24:36] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:24:43] <Eridius> which has apparently been merged in but the website docs haven't updated yet. Are the bots still having issues with that?
[19:25:44] *** Joins: Shrike (leo@moz-A385F6B1.nat.bb.dnainternet.fi)
[19:27:44] *** pmoore|brb is now known as pmoore|away
[19:28:08] <Tobba> does is_whitespace handle fancy unicode whitespaces?
[19:28:14] <Tobba> some of which is questionable if it even is whitespace
[19:28:18] <Tobba> i.e invisible plus
[19:28:33] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:28:33] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:28:51] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[19:28:53] <mcpherrin> Tobba:  property::White_Space(c)
[19:28:53] *** Quits: Rym (y@393F734D.E175BF4B.51C6DE68.IP) (Ping timeout)
[19:28:57] <strcat> Tobba: yes it uses the unicode property
[19:29:02] <Tobba> oh, neart
[19:29:04] <Tobba> neat*
[19:29:07] *** Quits: Jesse (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse)
[19:29:10] <mcpherrin> as defined by http://en.wikipedia.org/wiki/Unicode_character_property#Whitespace
[19:29:12] <Tobba> we have one of those lookup tables built in?
[19:29:16] <strcat> Tobba: yes
[19:29:18] <Tobba> oh hell
[19:29:19] <strcat> look in std::char's source
[19:29:44] <strcat> and src/libstd/unicode.rs
[19:29:49] <Tobba> heh
[19:29:55] *** Joins: SpaceWizard (Apollo@moz-E6F82C3A.maine.res.rr.com)
[19:29:56] <Tobba> fun enough thats only the formal whitespaces
[19:30:07] <Tobba> zero width spaces arent in there
[19:30:16] *** Quits: IanCormac84 (User@659E65F3.64D641E5.67DFF8B4.IP) (Ping timeout)
[19:30:19] *** Joins: Rym (y@393F734D.E175BF4B.51C6DE68.IP)
[19:30:22] *** Quits: veddan (viktor@moz-C79BC80B.csbnet.se) (Ping timeout)
[19:30:27] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[19:30:39] <Tobba> I wonder if theres an Invisible attribute
[19:30:46] <Tobba> better yet: a Pointless attribute
[19:31:14] <johnsoft> is there a rust playground-type site anywhere?
[19:31:58] <johnsoft> I found rustpad but it looks like it's been down for a while
[19:32:22] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[19:32:46] <bpicolo> johnsoft:  For short things ask rusti here
[19:32:55] <bpicolo> : P
[19:33:14] <strcat> johnsoft: there's a web version of rusti, just needs hosting
[19:33:32] *** Quits: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[19:33:44] *** Joins: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP)
[19:33:52] <johnsoft> are there any irc clients with a multiline input box? :P
[19:34:07] <Rusky> pidgin has one
[19:34:07] <Rusky> but it splits lines
[19:34:20] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[19:34:52] <johnsoft> it'd be awesome to see the web version on rust-lang.org
[19:34:57] <Havvy> mIRC
[19:35:15] <Ms2ger|sad> Havvy, I hope you paid for it ;)
[19:35:19] <strcat> johnsoft: sure, just as soon as mozilla provides hosting for it ;p
[19:35:25] <Havvy> I use HexChat.
[19:35:34] <Ms2ger|sad> strcat, we can probably arrange that
[19:35:37] <strcat> playpen has existed for 10 months
[19:35:47] *** yusukesuzuki is now known as yusukesuzuki-off
[19:35:54] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[19:36:01] <strcat> although it's not longer just for rusti
[19:36:02] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[19:36:03] <strcat> it's a useful thing!
[19:36:39] <johnsoft> strcat- are you talking about rustpad too?
[19:36:46] <strcat> yes
[19:37:00] <strcat> rusti: range(0, 10).zip(range(20, 30)).collect::<Vec<int>>()
[19:37:02] -rusti- pastebinned 14 lines of output: http://ix.io/buc
[19:37:05] <strcat> rusti: range(0, 10).zip(range(20, 30)).collect::<Vec<(int, int)>>()
[19:37:05] *** pmoore|away is now known as pmoore
[19:37:05] -rusti- [(0, 20), (1, 21), (2, 22), (3, 23), (4, 24), (5, 25), (6, 26), (7, 27), (8, 28), (9, 29)]
[19:37:24] <strcat> johnsoft: I wrote a sandbox specifically for this kind of task, and there's an irc bot here + a web interface for it
[19:37:45] <mcpherrin> strcat: Is everything I need to spin up the web ui in the playpen repo?
[19:38:14] <strcat> mcpherrin: well, you need a recent linux distro
[19:38:21] *** Joins: kp (kp@4F7252F2.CEBBE496.E48CFF63.IP)
[19:38:25] <strcat> playpen is actually in the arch repos, but fedora would also work
[19:38:30] <strcat> maybe opensuse would work, dunno
[19:38:33] <johnsoft> I wonder how we could draw more attention to it
[19:38:36] <johnsoft> oh, I have an idea
[19:38:37] *** Joins: carllerche (carllerche@moz-F43E6AFB.hfc.comcastbusiness.net)
[19:38:51] <strcat> mcpherrin: rust-playpen repo has the web UI for running rust
[19:38:53] <johnsoft> hey guys, check out this cool GOLANG feature http://i.imgur.com/Bcm1Jgg.png
[19:39:05] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (Ping timeout)
[19:39:19] <seubert> i dont get it johnsoft 
[19:39:35] *** jorendorff is now known as jorendorff_away
[19:39:37] <bpicolo> where is rusti the hosted version?
[19:39:40] <bpicolo> github?
[19:40:08] <strcat> https://github.com/thestinger/playpen
[19:40:16] <strcat> https://github.com/thestinger/rust-playpen
[19:40:21] <benh> It's not so much hosted as ready-for-hosting, I suppose
[19:40:25] *** Joins: autra (augustin@moz-BE76895F.fbx.proxad.net)
[19:40:31] <seanmonstar> wut? compiletest.rs:1:1: 1:1 error: can't find crate for `native`
[19:40:40] <bpicolo> I might be able to set one up later
[19:40:41] *** pmoore is now known as pmoore|away
[19:40:46] *** Quits: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net) (Quit: Leaving.)
[19:40:54] <strcat> mcpherrin: for example installing playpen on arch and then running ./init.sh in that rust-playpen repo is enough
[19:40:56] *** jorendorff_away is now known as jorendorff
[19:41:00] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:41:03] <strcat> on fedora you'd just have to build playpen
[19:41:06] <strcat> the deps will already be there
[19:41:11] <strcat> since systemd uses libseccomp now
[19:41:14] <johnsoft> seubert- i figured golang comparisons were supposed to be flamebait around here
[19:41:43] <seubert> lol
[19:41:52] <strcat> mcpherrin: would need to alter init.sh for fedora, needs to do yum something something instead of pacstrap
[19:41:57] <strcat> hm
[19:42:03] * strcat shrugs
[19:42:14] <strcat> can't remember the last time I used yum and I never made containers with it ;p
[19:42:16] <mcpherrin> strcat: libseccomp 2.1.0 not going to do it for me? (you said 2.1.1 in specs)
[19:42:24] <strcat> mcpherrin: 2.1.0 will technically work
[19:42:28] <strcat> it just has bugs that are somewhat scary
[19:42:45] *** Parts: jcd (jcdyer@moz-A3797E8E.hsd1.in.comcast.net) ()
[19:42:52] <strcat> but I think they might only be bugs on non-x86
[19:42:56] <mcpherrin> strcat: okay, let me spawn an arch container to run it in then
[19:43:16] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[19:43:20] *** Joins: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net)
[19:44:15] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[19:44:39] <seanmonstar> why wouldnt compiletest.rs be able to find libnative?
[19:44:41] <strcat> I should probably put the little setuid wrapper for rust-playpen in the repo too... 
[19:45:05] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[19:45:10] <strcat> otherwise you'd have to run the python script as root which is bad ;)
[19:45:43] <strcat> well, s/setuid/SYS_CAP_CHROOT + SYS_CAP_ADMIN/ but it's functionality the same
[19:45:44] *** Joins: osa1 (omer@6CFF95AB.2545CD3.3688B332.IP)
[19:45:52] <strcat> until they finish silly user namespaces ;s
[19:45:54] *** Quits: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net) (Ping timeout)
[19:46:14] <mcpherrin> lol, CAP_ADMIN may as well just be root :P
[19:46:33] <strcat> mcpherrin: yeah
[19:46:34] *** Joins: tobytailor (tobytailor@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[19:46:41] <acrichto> seanmonstar: the dependencies weren't set up correctly for it, I think that was fixed recently
[19:46:42] <strcat> mcpherrin: because entering namespaces needs it
[19:46:53] <strcat> mcpherrin: until they finally throw out and completely rewrite user namespaces
[19:46:55] <strcat> cause they're broken.
[19:46:56] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:47:04] <strcat> mcpherrin: on the positive side, cgroups are being rewritting
[19:47:11] <strcat> mcpherrin: there's now a sane_behavior mount option!
[19:47:14] <acrichto> seanmonstar: or rather, it will be fixed once https://github.com/mozilla/rust/pull/13260 merges
[19:47:15] <strcat> sane_behavior=1
[19:47:17] <seanmonstar> acrichto: i haven't done anything special. just some changes in libstd, and make check-stage1 says compiletest cant find libnative
[19:47:23] *** Joins: p1start (rewi@moz-E7F3D014.org)
[19:47:24] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Ping timeout)
[19:47:25] <strcat> rewritten*
[19:47:29] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[19:47:37] <acrichto> seanmonstar: if you add #![no_start] to src/compiletest/compiletest.rs it should work ok
[19:47:47] <seanmonstar> oh, that pr is exactly my problem :D
[19:47:53] <strcat> sane_behavior -> mostly non-hierarchy, far simpler, race free, single writer cgroups
[19:47:53] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[19:47:57] <strcat> (but it's not done)
[19:47:59] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[19:48:10] <strcat> non-hierarchal*, can't type atm
[19:48:17] *** Quits: dranov (dranov@1B0B11AA.A8779685.FB866788.IP) (Ping timeout)
[19:49:12] *** Quits: autra (augustin@moz-BE76895F.fbx.proxad.net) (Ping timeout)
[19:49:12] *** Joins: jxv (jxv@moz-8FB92450.lightspeed.irvnca.sbcglobal.net)
[19:49:30] *** Quits: ganitsu (ganitsu@moz-BB2CB6E7.dialup.adsl.anteldata.net.uy) (Ping timeout)
[19:49:42] *** Joins: Jesse (jruderman@moz-62518563.mtv2.mozilla.com)
[19:49:44] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[19:49:48] *** Joins: dranov (dranov@1B0B11AA.A8779685.FB866788.IP)
[19:50:12] *** Joins: Mowah (Mowah@moz-8548F376.cust.bredbandsbolaget.se)
[19:50:42] *** Joins: rchar (mark@16F93251.43AE57A3.2CFE048.IP)
[19:50:50] *** Quits: colinsurprenant (colin@moz-5C42464.static.videotron.ca) (Quit: colinsurprenant)
[19:51:02] <strcat> mcpherrin: CAP_SYS_CHROOT is pretty bad too :), lets you escape a chroot
[19:51:07] <strcat> (sometimes)
[19:51:13] *** Joins: autra (augustin@moz-BE76895F.fbx.proxad.net)
[19:51:36] *** Joins: colinsurprenant (colin@moz-5C42464.static.videotron.ca)
[19:51:59] *** Joins: kbwt (Mibbit@moz-D8C495C6.w109-221.abo.wanadoo.fr)
[19:52:06] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[19:52:11] <mcpherrin> strcat: yeah, we use all this stuff at work for fault isolation but no way trusting it for security :P
[19:52:34] <strcat> mcpherrin: well, you can use it for security, just not if there's a root user in the container
[19:52:40] <strcat> root in container == root on host
[19:52:42] <strcat> atm
[19:52:49] <strcat> not intended to be that way...
[19:53:03] <kbwt> Hey, new to Rust here. Can anyone give me a quick summary of how Rust's ranges or iterator concepts compare to C++?
[19:53:06] <o11c> strcat: actually ...
[19:53:15] <strcat> user namespaces are broken atm.
[19:53:22] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[19:53:24] <o11c> I heard someone say that recent containers were actually impossible to escape
[19:53:31] <strcat> o11c: as root? far from it
[19:53:53] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Quit: Leaving.)
[19:53:53] <strcat> if user namespaces were done, and the kernel was bug-free, sure
[19:53:54] <o11c> I don't know how to prove it myself, but ... he specifically said he couldn't escape as root
[19:54:01] <strcat> o11c: well they're wrong :)
[19:54:09] <o11c> and he's the kind of person I trust on this
[19:54:11] *** Quits: Kruppe (user@moz-7EF8488A.dynamic.uwaterloo.ca) (Ping timeout)
[19:54:17] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[19:54:50] *** Quits: colinsurprenant (colin@moz-5C42464.static.videotron.ca) (Quit: colinsurprenant)
[19:55:09] <Rusky> kbwt: iterators are pretty similar to c++ iterators, but they implement a trait instead of just being a protocol and there are more of them for things besides just iterating over containers
[19:55:27] <strcat> o11c: for one example, cgroups aren't virtualized yet
[19:55:38] <strcat> o11c: /sys/fs/cgroup will be mounted in an OS container, but it's entirely shared with the host
[19:55:49] <o11c> 2013-12-14 21:01:20  MadCamel       and last month LXC containers hit a milestone: I actually wasn't able to find a way to break out of a container, even with root. Yay
[19:56:00] * strcat shrugs
[19:56:00] <kimundi> kbwt: Rusts iterators are also generally simpler implemented, and don't suffer from iterator invalidation due to rusts typesystem
[19:56:08] <strcat> o11c: you can break out though ;p
[19:56:12] <kbwt> Rusky: Can end iterators have a different type from regular iterators to implement sentinels efficiently?
[19:56:12] *** Quits: autra (augustin@moz-BE76895F.fbx.proxad.net) (Ping timeout)
[19:56:34] <strcat> o11c: user namespaces make uid/gid mappings in the container different
[19:56:37] *** Joins: radford (Adium@moz-AC76BE6B.dhcp.mtpk.ca.charter.com)
[19:56:38] <strcat> but they do not work
[19:56:55] <strcat> if they did, root in container != root on host
[19:57:10] <strcat> cgroup fs is still an issue though
[19:57:16] <o11c> strcat: I see only one way to resolve this conflict
[19:57:22] <Rusky> kbwt: not sure what you mean precisely, but the Iterator<a> trait has a next method that returns an Option<a> to signal the end with None
[19:57:24] *** Quits: nszceta (nszceta@moz-E458A7C0.pharm.pitt.edu) (Ping timeout)
[19:57:37] <o11c> strcat: let MadCamel set up a container, and let you try to escape it
[19:58:00] <strcat> o11c: how about I just show you
[19:58:06] <uzi_mantis> how can i declare an Option that contains an owned mutable?
[19:58:07] <kbwt> Rusky: oh, so it's more like Java iterators (i.e. they do not always come in pairs)?
[19:58:08] <kimundi> kbwt: Could you explain what you mean with end iterator and sentinel in this context?
[19:58:16] <uzi_mantis> e.g., Option<~mut str> ?
[19:58:33] <kimundi> kbwt: A iterator is generally one type in Rust that implements the Iterator trait
[19:58:33] <kbwt> kimundi: I just assumed it would be like in C++, where you almost always work with a pair of two iterators to denote a range
[19:58:59] <kimundi> kbwt: A range is expressed by having the iterator trait also implement DoubleEndedIterator
[19:59:06] <o11c> strcat: I'm quite sure that you can set up a container so that it's *not* secure
[19:59:22] <strcat> o11c: yes
[19:59:28] <strcat> o11c: but not an OS container
[19:59:32] <kimundi> rusti: for x in range(0, 3) { print!("{} ", x); }
[19:59:33] -rusti- 0 1 2 ()
[19:59:38] <kimundi> rusti: for x in range(0, 3).rev() { print!("{} ", x); }
[19:59:39] -rusti- 2 1 0 ()
[19:59:53] *** Quits: ahunt (ahunt@moz-6D6D79D6.cable.virginm.net) (Ping timeout)
[20:00:00] <strcat> o11c: if you don't mount the cgroup and proc fs, root inside a cgroup is scary but I don't know how you'd escape
[20:00:14] <kbwt> kimundi: really? but there are "forward ranges" in C++, that cannot be walked backwards
[20:00:20] <strcat> but *me* not being able to break out doesn't make it secure
[20:00:31] <kimundi> kbwt: walking backwards != double ended iterator
[20:00:57] <strcat> rusti: while true {}
[20:01:02] -rusti- <anon>:11:9: 11:22 warning: denote infinite loops with loop { ... }, #[warn(while_true)] on by default
[20:01:02] -rusti- <anon>:11         while true {}
[20:01:02] -rusti-                   ^~~~~~~~~~~~~
[20:01:02] -rusti- playpen: timeout triggered!
[20:01:27] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[20:01:28] <uzi_mantis> the error message we get from the compiler is: "cannpot borrow immutable dereference of ~ pointer as mutable"
[20:01:29] <Tobba> maybe I shouldent be using uint for offsets within an image
[20:01:34] <kbwt> kimundi: But DoubleEndedIterator requires next_back to be implemented which returns an element from the end of the range?
[20:01:37] <Tobba> but its technically only limited by the available address space so fuck if I know
[20:01:39] <kimundi> kbwt: A double ended iterator has a next() method that advances the start it until it reaches the end, and a next_back() method that advances the end until it reaches the start
[20:01:44] *** Joins: leowoe (Leo@moz-72D47201.dclient.hispeed.ch)
[20:01:50] <strcat> o11c: http://sprunge.us/ZcXR that shows the brokenness of cgroups
[20:01:56] <strcat> o11c: the playpen cgroup is from the host
[20:02:08] <Rusky> kbwt: there is a DoubleEndedIterator trait
[20:02:14] *** Quits: dranov (dranov@1B0B11AA.A8779685.FB866788.IP) (Ping timeout)
[20:02:18] <Rusky> oh hah you said it already
[20:02:39] *** Quits: rchar (mark@16F93251.43AE57A3.2CFE048.IP) (Ping timeout)
[20:02:42] <kimundi> kbwt: So its basically a range of values like 1, 2, 3, 4 where you pop of values from either end until there are none left
[20:02:43] <Rusky> kbwt: so basically some iterators are endless and some are not
[20:02:47] <strcat> kbwt: rust iterators are equivalent to D ranges or Boost.Range, not C++ iterators
[20:03:10] <strcat> kbwt: rust provides a memory safety guarantee, and non-range iterators couldn't provide that without a huge performance loss
[20:03:17] *** Joins: kbwt_ (Mibbit@moz-D8C495C6.w109-221.abo.wanadoo.fr)
[20:03:24] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[20:03:25] <geal> hum. This will probably look like a pretty stupid question, but how do I give a return code to my process? main wants to return ()
[20:03:31] <kbwt_> (woops, my Firefox crashed)
[20:03:32] <kimundi> kbwt: The for syntax simply pops of values from the start, and there is a adapter to switch start and end which can be used to invert that
[20:03:41] <strcat> 16:02:47       strcat | kbwt: rust iterators are equivalent to D ranges or Boost.Range, not C++ iterators
[20:03:42] <Eridius> geal: os::set_exit_status()
[20:03:43] <strcat> 16:03:09       strcat | kbwt: rust provides a memory safety guarantee, and non-range iterators couldn't provide that without a huge performance loss
[20:03:48] <geal> Eridius: thanks :)
[20:03:52] <strcat> and yeah, you can have stuff like infinite iterators
[20:03:55] <Eridius> geal: you still have to actually shut down the process, but that informs the start function what code to return
[20:04:05] <kbwt_> kimundi: strcat how would you do "input iterators"?
[20:04:08] *** Joins: q66 (q66@moz-769FF8DB.range86-167.btcentralplus.com)
[20:04:20] <strcat> kbwt_: you don't, just use an iterator of mutable references
[20:04:22] <uzi_mantis> are owned mutable variables possible..?
[20:04:29] <Eridius> geal: incidentally, if your process can't shut down by falling off the end of main (due to tasks being left alive that are blocked), you can always use libc::exit()
[20:04:32] <strcat> rusti: range(0, 10).cycle().take(10).collect::<Vec<int>>()
[20:04:32] -rusti- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[20:04:38] <strcat> rusti: range(0, 3).cycle().take(10).collect::<Vec<int>>()
[20:04:39] -rusti- [0, 1, 2, 0, 1, 2, 0, 1, 2, 0]
[20:04:41] *** Joins: csherratt (csherratt@moz-7685819.cpe.teksavvy.com)
[20:04:45] <strcat> cycle() returns an infinite iterator there
[20:04:46] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[20:04:50] <Eridius> uzi_mantis: an owned variable is mutable if the slot it's held in is mutable
[20:04:52] <Ms2ger|sad> uzi_mantis, were you using & instead of &mut somewhere?
[20:04:55] <kbwt_> strcat: oh, by "input iterator" I mean this: http://en.cppreference.com/w/cpp/concept/InputIterator
[20:04:59] <strcat> kbwt_: I know
[20:05:03] <kbwt_> strcat: essentially a single-pass iterator
[20:05:08] <strcat> kbwt_: oh
[20:05:09] <strcat> yes
[20:05:09] <kbwt_> not writable iterator
[20:05:11] <strcat> kbwt_: just Iterator
[20:05:13] <strcat> sorry ;)
[20:05:20] *** Joins: nszceta (nszceta@moz-9EFAFF40.wireless.pitt.edu)
[20:05:22] <geal> Eridius: thanks! That makes sense, but my C habit was surprised there :)
[20:05:28] <kbwt_> strcat: okay, that makes sense :)
[20:05:32] <strcat> Iterator is like InputRange in D
[20:05:39] <strcat> Iterator + Clone is like ForwardRange in D
[20:05:52] <strcat> DoubleEndedIterator is like a D BidirectionalRange
[20:06:00] <strcat> and those are probably the terms Boost.Range uses
[20:06:07] <kbwt_> strcat: cool, sounds very good
[20:06:31] <uzi_mantis> well, we have Option<~node>, and i want to make the ~node mutable 
[20:06:35] *** Joins: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP)
[20:06:44] <strcat> rusti: range(0, 3).rev().cycle().take(10).collect::<Vec<int>>()
[20:06:45] -rusti- [2, 1, 0, 2, 1, 0, 2, 1, 0, 2]
[20:06:54] <uzi_mantis> how can i go about changing the Option<~node> interface to make the ~node mutable when i unwrap the Option?
[20:07:01] <Eridius> geal: if you don't haev to call libc::exit() you shouldn't
[20:07:04] *** Joins: astroch (astroch@moz-DF5C3CE6.dhcp.embarqhsd.net)
[20:07:13] <strcat> (where the rev adaptor swaps next() with next_back())
[20:07:16] <kimundi> uzi_mantis: That depends on where you unwrap the option too, not on the option itself
[20:07:22] <Eridius> uzi_mantis: let mut x = opt.unwrap()
[20:07:23] *** Quits: kbwt (Mibbit@moz-D8C495C6.w109-221.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[20:07:51] <kimundi> uzi_mantis: That is, you need to unwrap it into a mutable local variable, or access it through a &mut and create a &mut reference to it.
[20:07:56] *** Joins: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP)
[20:08:08] <geal> Eridius: what are the cases that would require me to call libc::exit? Tasks that do not want to end?
[20:08:19] <strcat> kbwt_: I always forget the C++ terms now :P, I thought you meant what OutputIterator is
[20:08:24] *** Joins: colinsurprenant (colin@moz-5C42464.static.videotron.ca)
[20:08:35] <geal> is there a way to setup a task so that it automatically ends once the "main" task ends?
[20:08:44] <kbwt_> strcat: hehe, np, the C++ name really is confusing when you think of it that way
[20:08:54] <uzi_mantis> unwrapping it to a local mutable variable is what eridius has suggested, no?
[20:08:57] <kbwt_> strcat: One more question, how's Rust's "RAII"?
[20:09:03] <strcat> kbwt_: better than C++11
[20:09:18] <uzi_mantis> and the latter, accessing it through &mut, would be if i wanted to pass the ~node through function parameters?
[20:09:18] <strcat> kbwt_: every type can be moved, it's always done via memcpy - no move ctors
[20:09:27] <strcat> kbwt_: and it's the *default*
[20:09:27] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[20:09:29] *** Quits: mhenretty (sid11899@moz-5F4AA75A.irccloud.com) (Quit: )
[20:09:38] *** Joins: rchar (mark@16F93251.43AE57A3.2CFE048.IP)
[20:09:47] *** Joins: mhenretty (sid11899@moz-5F4AA75A.irccloud.com)
[20:09:47] <kbwt_> strcat: There are no move ctors at all?
[20:09:51] <strcat> kbwt_: no move ctors
[20:09:54] *** Quits: mye (mye@moz-35E7816B.swh.uni-giessen.de) (Quit: sleep message)
[20:09:55] <uzi_mantis> rusti: println("pls")
[20:09:56] -rusti- <anon>:11:9: 11:16 error: unresolved name `println`.
[20:09:57] <strcat> kbwt_: assign/passing/returning just does what C does
[20:09:57] -rusti- <anon>:11         println("pls")
[20:09:57] -rusti-                   ^~~~~~~
[20:09:57] -rusti- error: aborting due to previous error
[20:09:57] -rusti- playpen: application terminated with error code 101
[20:10:05] <strcat> kbwt_: and if the type has a destructor, it considers the source moved from
[20:10:06] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[20:10:09] *** Quits: colinsurprenant (colin@moz-5C42464.static.videotron.ca) (Ping timeout)
[20:10:16] <strcat> kbwt_: and doesn't call the dtor on it, and prevents using it unless it's reinitialized
[20:10:27] <kbwt_> strcat: wow, I've always wanted that for C++
[20:10:31] <Eridius> geal: tasks that don't want to end, that's precisely it
[20:10:33] *** Joins: claudiu_ (claudiu@CB447DD5.6B10AC3.E2F59BBC.IP)
[20:10:37] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[20:10:37] <geal> alright
[20:10:38] <Eridius> geal: a task pool doesn't exit until all tasks it spawned have exited
[20:10:44] <strcat> kbwt_: for example 'let x = y;' with a Vec<T> will just move it - to copy, you need y.clone()
[20:10:55] <Eridius> so if you spawn a task from the root task pool and it blocks forever, it will prevent your process from exiting naturally
[20:11:07] <kbwt_> strcat: the way move is done in C++ with "dead" states for moved-from objects always felt weird and potentially inefficient
[20:11:09] <Eridius> ideally you'd be able to shut down your tasks, but that's not always possible
[20:11:10] <strcat> kbwt_: also makes using stuff like Rc<T> (task-local shared_ptr) tend to lead to more efficient code, since you do few refcounts
[20:11:22] <strcat> kbwt_: atm, we do actually still have 'dead' states but it's planned to remove it
[20:11:30] <strcat> and it's a compiler implementation detail
[20:11:40] *** Quits: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP) (Ping timeout)
[20:11:41] <strcat> kbwt_: the language has to change semantics a bit
[20:11:41] <kbwt_> strcat: right, in C++ you have to bake it into your class's data layout
[20:11:48] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:11:55] <strcat> kbwt_: atm in rust, adding a custom destructor adds a 'drop flag' but that will go away
[20:11:55] *** Joins: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[20:11:57] <geal> yes, sometimes some code could hold in a separate task
[20:12:09] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[20:12:11] <kbwt_> strcat: so unless your type is a natural fit for dead states, like e.g. a smart pointer where you can simply set p_ = nullptr;
[20:12:20] <strcat> kbwt_: the language has to start forbidding certain patterns where a variable is *maybe* moved from
[20:12:21] <strcat> like
[20:12:28] <kbwt_> strcat: unless that's the case, it makes for extra indirection or boolean flags in your code that would otherwise not be there
[20:12:31] <strcat> if foo { bar(x) }
[20:12:35] <strcat> where bar takes `x` by-value
[20:12:42] <strcat> and `x` is a type with a dtor, so it moves
[20:12:43] <Eridius> strcat: is it going away because Rust will be precise about tracking whether the value has been dropped in code, or is it going away because someone figured out some place to store that information elsewhere?
[20:13:01] <strcat> that has to be a) forbidden or b) it has to destroy `x` in a hidden `else` branch
[20:13:04] <Eridius> strcat: that doesn't need to be forbidden, Rust just needs to add a boolean variable to track it
[20:13:06] <strcat> Eridius: because we can do it statically
[20:13:15] <strcat> Eridius: it does have a boolean
[20:13:17] <strcat> it's called the drop flag
[20:13:20] <Eridius> actually yeah, destroying in the hidden `else` is better, because x already can't be used after the if block
[20:13:25] <Eridius> strcat: I meant on the stack
[20:13:27] <strcat> ah
[20:13:27] *** Quits: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[20:13:33] *** Quits: carllerche (carllerche@moz-F43E6AFB.hfc.comcastbusiness.net) (Quit: carllerche)
[20:13:34] <strcat> Eridius: yes that would also work
[20:13:41] <kbwt_> strcat: these are exactly the things I've been thinking about with regards to C++'s move semantics, and it looks like Rust is actually solving them :)
[20:13:46] <Eridius> the only problem with destroying it in a hidden `else` is that can reorder the destructors so it's no longer FILO
[20:13:49] *** Joins: sankha93 (sankha93@7061CD01.D6BD0D91.22D41759.IP)
[20:13:51] *** Quits: alan_andrade_ (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Ping timeout)
[20:13:55] <Eridius> which means a boolean flag on the stack is probably correct
[20:14:13] <kbwt_> strcat: so I assume the compiler will only use a flag when needed, as determined by static analysis?
[20:14:24] <strcat> kbwt_: well, it uses the flag when there's a custom destructor
[20:14:25] <Eridius> kbwt_: most types don't have destructors
[20:14:33] *** Quits: rchar (mark@16F93251.43AE57A3.2CFE048.IP) (Ping timeout)
[20:14:34] <strcat> kbwt_: i.e. an implementation of the Drop trait
[20:14:46] <Eridius> and I would assume the implicit destructor for types with owned values can just zero out the pointer in lieu of needing any flag
[20:15:04] <strcat> kbwt_: so struct Foo { x: int } gets one word bigger if you do impl Drop for Foo { ... }
[20:15:06] *** Joins: umbridge (Mibbit@3E3094EC.34458CF2.CC1A2609.IP)
[20:15:19] <strcat> kbwt_: but it's something that's intended to be changed
[20:15:41] <Eridius> strcat: I can imagine a use for #[unsafe_no_drop_flag] in a future where the drop flag is gone, simply to prevent the unnecessary stack flag, but I don't know if there's any practical reason where it would actually matter
[20:15:45] <kbwt_> strcat: but the compiler could possibly elide the flag when the code the value is passed to doesn't move inside a branch, since it's just an implementation detail?
[20:16:07] <strcat> kbwt_: well in the future, there will likely be no flag at all - that struct will be the same size with/without a destructor
[20:16:15] *** jorendorff is now known as jorendorff_away
[20:16:16] <Eridius> kbwt_: today, a type with a custom destructor has a drop flag as part of the type. It can't be elided, because it affects the type layout
[20:16:19] <strcat> kbwt_: it will just handle moves statically (or use Eridius' stack flag suggestion)
[20:16:20] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[20:16:38] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[20:16:45] *** Joins: rchar (mark@16F93251.43AE57A3.2CFE048.IP)
[20:16:47] <kbwt_> Eridius: strcat: is it already possible to provide the drop trait implementation yourself (e.g. in the case of smart pointers)?
[20:16:55] <strcat> kbwt_: yes
[20:16:56] <kbwt_> when you can just zero the pointer value
[20:16:57] <kbwt_> great
[20:17:07] <strcat> kbwt_: there's #[unsafe_no_drop_flag] as a hack
[20:17:18] <strcat> zeroes the type instead (although we could switch it to zero a single field)
[20:17:35] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[20:17:40] *** Joins: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP)
[20:17:44] <Eridius> strcat: oh I didn't realize that actually zeroes the type. I assumed that just left it up to the destructor to track it
[20:17:56] <strcat> Eridius: a move zeroes the type with #[unsafe_no_drop_flag]
[20:17:59] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[20:18:03] <strcat> without it, the drop flag is zeroed
[20:18:31] <Eridius> although now that I think about it, the compiler does need some way to figure it out directly because the custom destructor can't choose whether or not to trigger destructors on its fields
[20:18:41] <kbwt_> hmm, couldn't there be an interface by which the class could specify its own logic for determining the drop flag?
[20:18:45] <Eridius> I've only used it on a struct that contained a *T, which I zeroed out manually (and tested manually)
[20:18:50] <strcat> kbwt_: well the drop flag is just going to go away
[20:18:58] <Eridius> kbwt_: no point. It's better to just remove it outright
[20:19:20] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Ping timeout)
[20:19:35] <kbwt_> strcat: Eridius: that sounds great, but I don't understand how you can completely eliminate it, regardless of the conditionality of the moves?
[20:19:53] <Eridius> kbwt_: a type is only destructed because the compiler emits a call to the destructor
[20:20:08] <Eridius> if the compiler can figure out how to avoid calling the destructor at all, then there is no need for the type to carry a drop flag
[20:20:17] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[20:20:25] *** Joins: frozendevil (Adium@moz-62FB197F.com)
[20:20:28] <strcat> kbwt_: because rust knows where ownership is transferred, the only problem is when ownership is transferred conditionally
[20:20:37] <kbwt_> strcat: exactly
[20:20:38] <Eridius> so in cases where a given value is always destructed at the same point in the code flow, no extra tracking is needed. And in cases where a value is conditionally moved, the compiler can use a stack flag to indicate that it did the move and therefore should not destruct later
[20:21:13] <strcat> kbwt_: if cond { foo(x) } where foo(x) moves `x` into the function just has to a) be forbidden, b) destroy `x` in a hidden else branch or c) use a flag on the stack
[20:21:21] <strcat> kbwt_: it doesn't need to be part of the types as it is now
[20:21:28] *** Quits: umbridge (Mibbit@3E3094EC.34458CF2.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:21:49] <Eridius> strcat: I really hope nobody seriously pushes for (a) or (b)
[20:22:03] <strcat> afaik niko wanted a)
[20:22:08] <Eridius> o_O
[20:22:09] <kbwt_> Eridius: strcat: oh, yeah, the stack flag or hidden else branch is what I was thinking already
[20:22:28] <kbwt_> isn't b) and c) pretty much equivalent anyway?
[20:22:34] <kimundi> Eridius: a) would just require a explict `else { drop(x); }` 
[20:22:36] <Tobba> whats the best way to do string -> number
[20:22:37] <Eridius> strcat: I get that forbidding it is easier to implement than correctly supporting it, but that's not a good reason to forbid it
[20:23:03] <Tobba> FromStr, it seems
[20:23:03] <Eridius> kimundi: That causes issues with destructor ordering though
[20:23:16] <strcat> kbwt_: c) would mean it's destroyed at the end of the scope
[20:23:19] <strcat> kbwt_: as it is now
[20:23:26] <strcat> kbwt_: b) would mean it's destroyed early
[20:23:31] <strcat> changes the RAII semantics
[20:23:34] <kbwt_> strcat: oh, I see, yeah
[20:23:36] <Eridius> kimundi: it also prevents me from saying something like `if (cond) { drop(raiiLock); doFoo(); }`, although I don't know how practically useful that example is
[20:23:36] <kimundi> Eridius: Technically it would not be a issue, as you explicit write it down in a way that reorders the destructors
[20:23:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:24:13] <Eridius> kimundi: it would be an issue because it would force you to reorder the destructors even if you don't want to
[20:24:25] <Jesse> http://www.zazzle.com/generic_cup_t_mugs-168953054069593498
[20:24:36] <Eridius> I suppose you could get around that by using Option<T> instead and calling .take() on it in the if branch, but that's just getting annoying
[20:24:53] *** Quits: mpiechotka (mpiechotka@moz-4FE2263C.dynamic.mnet-online.de) (Quit: mpiechotka)
[20:24:56] <Eridius> much better to just have the compiler use a simple boolean flag to indicate if it's been dropped
[20:25:04] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[20:25:14] <kbwt_> hmm, but "you don't pay for what you don't use"
[20:25:16] <Eridius> and hell, if you're really worried about optimizing for stack space, it could re-use a non-nullable pointer value inside the struct as the flag
[20:25:30] <Eridius> kbwt_: if you don't conditionally move a value the flag won't be needed
[20:25:42] <Eridius> the compiler would only have to insert it when it needs to conditionally drop at the end of scope
[20:25:47] <o11c> strcat: I'd favor b)
[20:25:56] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:25:58] <Eridius> o11c: b) I think is the absolute worst because it silently changes RAII semantics
[20:26:00] <o11c> but then, I also favor explicit moves ...
[20:26:11] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[20:26:15] <o11c> foo(move x) would not be a silent change
[20:26:23] <Eridius> that's not the change
[20:26:37] <Eridius> the change is if (false) { foo(x) } would cause x to be destructed at that point
[20:26:38] <kbwt_> b) is definitely problematic
[20:26:39] <Eridius> even though it was never moved
[20:27:39] <Eridius> ok, I seroiusly should be working. Stop having interesting discussions!
[20:27:42] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[20:27:42] <kbwt_> what are the realistic use cases where you would need conditional moves?
[20:27:54] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Connection reset by peer)
[20:28:04] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[20:28:13] <tfogal> hey all, i'm hitting an error on a "extern crate crname" line, but 'crname.rs' is in my current directory and i've done a 'rustc --crate-type lib crname.rs' on it.. am i misremembering how one builds/uses crates?
[20:28:15] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[20:28:24] *** Quits: csherratt (csherratt@moz-7685819.cpe.teksavvy.com) (No route to host)
[20:28:40] <Rusky> if it's a link error I think you need to add -L.
[20:28:51] <Eridius> fn foo(x: ~[int]) -> ~[int] { let y: ~[int]; if (x.len() > 0) { y = x; } else { y = ~[1, 2, 3]; } y }
[20:28:56] <o11c> I just don't like c), and a) would be annoying
[20:29:10] <o11c> it's not like you can *use* it anymore ...
[20:29:12] <o11c> hm
[20:29:14] <tfogal> Rusky: genuis.  thanks, knew I was forgetting something
[20:29:18] <o11c> except, that if the if() block returns ...
[20:29:23] <Eridius> o11c: why don't you like c)?
[20:29:45] <Eridius> o11c: it's not about being able to use the variable anymore, it's about the side-effects of destruction, e.g. RAII
[20:29:47] <o11c> Eridius: having a separate flag to convey knowledge that the source intends? How *could* I like that?
[20:29:57] *** Quits: leowoe (Leo@moz-72D47201.dclient.hispeed.ch) (Ping timeout)
[20:30:07] <Eridius> o11c: what do you mean? The flag is exactly equivalent to the value of the conditional
[20:30:27] *** Joins: leowoe (Leo@moz-72D47201.dclient.hispeed.ch)
[20:30:39] <Eridius> o11c: `if (test()) { foo(x) }` is identical to `let b = test(); if (b) { foo(x) }`
[20:30:52] <Eridius> o11c: the only difference here is the compiler would then preserve the value of b and use it again during destruction
[20:31:15] <o11c> it shouldn't *conditionally* destroy something at the end of the scope
[20:31:26] <o11c> it should either always destroy it there, or never destroy it there
[20:31:39] <Eridius> although it's not literally that, because e.g. `if (a) { if (b) { if (c) { ... } } } ` would actually need `a && b && c` as the value, so it's really simpler just to insert a separate flag and set it to 1 at the point of the move
[20:31:41] <o11c> which means either implicit else or explicit else
[20:31:44] *** Joins: willingc (willingc@moz-F095E013.san.res.rr.com)
[20:31:46] <Eridius> o11c: Rust _already_ conditionally destroys something
[20:31:52] <Eridius> c) matches the semantics we have today
[20:31:55] <o11c> I know, and I don't like it
[20:32:22] <o11c> actually ... given the if () { return } thing, explicit else may be better
[20:32:40] <Eridius> o11c: what do you mean? if you return from the if block then the whole point is moot
[20:32:46] *** Quits: Shrike (leo@moz-A385F6B1.nat.bb.dnainternet.fi) (Quit: leaving)
[20:32:47] <Eridius> because the compiler can statically tell whether to destruct it
[20:32:56] <kbwt_> c) is sensible, but it seems there should be a way to customize a type so that it can provide the flag on its own 
[20:33:16] <Eridius> kbwt_: why? Embedding the flag within the type is strictly worse than putting a boolean on the stack
[20:33:20] <strcat> kbwt_: in a local scope the space consumption doesn't seem important
[20:33:25] <kbwt_> although when I think about it, it makes no difference at all whether the flag is on the stack or the .. ^ yep what you said
[20:33:45] <Eridius> as I said, I could imagine the compiler providing an optimization such that it re-uses the value of a non-nullable pointer in the type as the flag instead of putting it on the stack, but that doesn't change anything visible to the user
[20:33:47] <kbwt_> you know, I'm very much preconditioned by the way moves work in C++
[20:33:56] <Eridius> whereas putting the flag in the type does because it increases the type's size by a word
[20:34:02] <o11c> (I actually do like C++ moves)
[20:34:04] <kbwt_> where the move constructor has to "disarm" the moved-from object, because its destructor will run
[20:34:14] <kbwt_> but honestly, I think C++ moves are wrong
[20:34:15] <Eridius> C++ moves are retrofitted onto a system that didn't have them
[20:34:19] <Eridius> it's completely unnecessary
[20:34:20] <kbwt_> c) is the right way to go
[20:34:31] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[20:34:34] <Eridius> *unnecessary in a language that doesn't have C++'s baggage
[20:34:35] <Rusky> shouldn't the flag be on the stack if only because it's the variable and not the value that is in charge of destruction
[20:34:56] <kbwt_> Rusky: yeah, it should be on the stack.
[20:35:03] <Eridius> and move constructors are wholly unnecessary in a language with regions, because the only reason to need a move constructor (besides disarming the original object so its destructor doesn't do anything) is to update any references to the object
[20:35:03] <kbwt_> The way C++ does it makes no sense.
[20:35:26] <Eridius> Rusky: the flag should be on the stack, yes. But the variable value is also on the stack.
[20:35:39] <Rusky> unless it's a ~
[20:35:49] <Eridius> I'm just saying rustc could optimize away the flag by re-using a non-nullable value field, but that again is purely just an optimization
[20:35:50] <kbwt_> but then the ~ is on the stack ;)
[20:35:55] <Eridius> Rusky: the ~ is on the stack, only the pointed-to value is on the heap
[20:36:06] <Tobba> hm
[20:36:11] <Eridius> and in fact ~T is the trivial example that doesn't need a stack flag, because ~ is non-nullable and therefore merely zeroing out the pointer is sufficient
[20:36:11] <Tobba> how am I meant to do f32::from_str
[20:36:15] <Tobba> that doesnt seem to work
[20:36:25] <Eridius> rusti: let x: Option<f32> = from_str(123.2); x
[20:36:26] -rusti- <anon>:11:39: 11:44 error: mismatched types: expected `&str` but found `<generic float #0>` (expected &str but found floating-point variable)
[20:36:26] -rusti- <anon>:11         let x: Option<f32> = from_str(123.2); x
[20:36:26] -rusti-                                                 ^~~~~
[20:36:26] -rusti- error: aborting due to previous error
[20:36:27] -rusti- playpen: application terminated with error code 101
[20:36:32] <Eridius> rusti: let x: Option<f32> = from_str("123.2"); x
[20:36:34] -rusti- Some(123.199997)
[20:36:35] <Eridius> Tobba: ^
[20:36:42] <Tobba> yeah I know that
[20:36:44] <Tobba> but its not that simple
[20:36:46] <Rusky> right, but because there are only some cases that the flag is needed
[20:36:52] <Tobba> I EXPLICTYL need it to return a f32
[20:36:56] <Rusky> it shouldn't be a part of the object itself
[20:37:01] <Eridius> Tobba: let x: f32 = from_str("123.2").unwrap()
[20:37:05] <Tobba> the type is unconstrained otherwise
[20:37:12] <Tobba> so no
[20:37:29] <Eridius> Tobba: your problem is the result type is unconstrained? So constrain it
[20:37:43] <Eridius> rusti: from_str::<f32>("123.2")
[20:37:44] -rusti- Some(123.199997)
[20:37:44] <Tobba> yeah that was the problem
[20:37:47] <Tobba> what
[20:37:49] <Tobba> I tried doing that
[20:37:53] <Tobba> god damnit
[20:37:59] <Eridius> did you try from_str<f32>() by any chance?
[20:38:04] <Tobba> I tried EXACTLY that
[20:38:14] <Tobba> odd
[20:38:20] <Rusky> example: T: Drop, ~T vs T- which one gets the flag?
[20:38:20] <Tobba> I found a way to constrain the type anyways
[20:38:25] *** Joins: bigbadben (bigbadben@moz-D67499C1.dhcp.klmz.mi.charter.com)
[20:38:28] <kbwt_> Eridius: imo even reusing non-nullable references by zeroing them out is only an optimization when you have to call a legacy function like C++'s delete operator which internally has a null check
[20:38:47] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[20:39:06] <Eridius> Rusky: neither. The stack gets the flag. I'm just saying that the value is on the stack and therefore a non-nullable field of the value can also serve double-duty as the flag
[20:39:10] <Eridius> instead of using a separate one
[20:39:22] <Eridius> but again, that's purely an optimization that the user cannot even tell is happening
[20:39:25] *** Quits: jackneill (jackneill@moz-9957FB4C.pool.digikabel.hu) (Input/output error)
[20:39:40] <Eridius> (outside of, say, creating multiple stack variables and taking their addresses as *T and comparing them to find out where they ended up on the stack)
[20:40:01] <kbwt_> yep, I like what I'm hearing. fingers crossed for c)
[20:40:03] <Eridius> kbwt_: what does legacy have to do with anything? This is about avoiding the call to the destructor.
[20:40:20] <Eridius> and I'm just saying a non-nullable field provides an optimization opportunity
[20:40:36] <Eridius> but I suspect that we've wasted more time talking about this optimization than it's even worth to take to implement it
[20:40:37] <Rusky> Eridius: oh got it- the stack flag can overlap the object itself
[20:40:41] <kbwt_> Eridius: That would be a case where you can call the "destructor"/legacy function anyway because it has a branch on != 0 internally
[20:40:41] <Eridius> exactly
[20:40:42] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Quit: Leaving.)
[20:40:48] <Tobba> okay
[20:40:53] <Tobba> the compiler really doesnt like this
[20:40:55] <Tobba> Vec::from_slice(value.split(',').map(|delay| -> f32 match from_str(delay) { Some(delay) => delay, None => 1.0f32 }).collect().as_slice())
[20:40:59] <kbwt_> Eridius: in all the other cases, like you say, it's merely a stack space optimization
[20:41:00] <bigbadben> hi, I do not mind reading the docs but where can I find more in depth docs about IO functions like tcp and sockets in rust? 
[20:41:02] <Tobba> the error output is pretty weird
[20:41:04] <Eridius> kbwt_: ok sure, if you know the destructor itself has a != 0 check internally then you can avoid conditionalizing it, but I don't think that's an issue
[20:41:13] <Tobba> rusti: let value = "1, 2, 3"; Vec::from_slice(value.split(',').map(|delay| -> f32 match from_str(delay) { Some(delay) => delay, None => 1.0f32 }).collect().as_slice())
[20:41:15] <kbwt_> Eridius: right
[20:41:16] -rusti- pastebinned 7 lines of output: http://ix.io/bum
[20:41:37] <Rusky> but yeah stack space optimizations aren't super useful
[20:41:50] <Eridius> Tobba: try |delay: &str|
[20:41:57] <Rusky> I would expect llvm's opts to be able to figure it out own their own anyway
[20:42:01] <Tobba> think I did
[20:42:11] <Tobba> Vec::from_slice(value.split(',').map(|delay: &str| -> f32 match from_str(delay) { Some(delay) => delay, None => 1.0f32 }).collect().as_slice())
[20:42:14] <Eridius> sometimes rustc can't properly constrain types across closure boundaries. I'm not sure why
[20:42:17] <Tobba> uh
[20:42:25] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[20:42:27] <Tobba> rusti: let value = "1, 2, 3"; Vec::from_slice(value.split(',').map(|delay: &str| -> f32 match from_str(delay) { Some(delay) => delay, None => 1.0f32 }).collect().as_slice())
[20:42:30] -rusti- pastebinned 7 lines of output: http://ix.io/bun
[20:42:42] <Ms2ger|sad> from_str(delay).or_default(1.0f32)
[20:42:43] <Eridius> oh I see, wrong type was unknown
[20:42:44] <Eridius> ditch the &str
[20:42:51] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[20:42:51] *** ChanServ sets mode: +o tjc
[20:43:09] <Eridius> Tobba: the problem is .collect() returns any type that implements FromIterator, and so it doesn't know how to constrain that because you're calling .as_slice() on it
[20:43:14] <kbwt_> what's the reason some people were for a)?
[20:43:19] <Tobba> ah, hm
[20:43:19] <Eridius> Tobba: try .collect::<Vec<f32>>()
[20:43:22] <Tobba> yeah
[20:43:43] <Tobba> yep that works, thanks
[20:43:46] <Eridius> kbwt_: I expect it's because it's simpler, and at least one person so far seems to dislike the semantics we have today
[20:44:06] <kimundi> rusti: let f = || -> uint 5; f()
[20:44:07] -rusti- 5
[20:44:13] <kimundi> huh, didn't know that parses
[20:44:20] <Tobba> it does
[20:44:21] <Tobba> its p neat
[20:44:25] <Eridius> kimundi: neither did I, but it makes sense
[20:44:33] <kimundi> yeah
[20:44:40] <Eridius> looks a bit weird though, I think I'd prefer to throw in {} when writing it
[20:44:52] <Eridius> goddammit, I was going to stop talking here and go back to work! >_<
[20:44:55] <kimundi> rusti: let f = || -> uint { 5 }; f() // less surprising here
[20:44:56] -rusti- 5
[20:45:01] <Tobba> rule of any of my projects
[20:45:06] <Tobba> if the comment // this is wizardry is above any code
[20:45:10] <Tobba> any horribleness is valid
[20:45:14] <kimundi> haha
[20:45:17] <dsrx> I prefer // this is sorcery
[20:45:18] <Tobba> even 300 letter long lines with no comments other than // wtf
[20:45:55] *** Quits: edwardw (edwardw@42B94DF.16F55560.50B134B9.IP) (Quit: Leaving...)
[20:46:28] <Tobba> I wonder how strict the bool parser is
[20:47:00] <kimundi> Tobba: what do you mean?
[20:47:14] <Tobba> if it only accepts true/false in from_str or if it'll take 0 and 1 too
[20:47:30] <kimundi> it should accept only "true" or "false"
[20:47:55] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:47:58] <Tobba> ... well
[20:48:00] *** jorendorff_away is now known as jorendorff
[20:48:01] <Tobba> it doesnt get hackier than this nayways
[20:49:04] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[20:49:05] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[20:49:10] <kimundi> rusti: from_str("2.0").or_default(1.0f32)
[20:49:13] -rusti- pastebinned 7 lines of output: http://ix.io/bux
[20:49:25] <kimundi> rusti: from_str("2.0").or(Some(1.0f32))
[20:49:26] -rusti- Some(2)
[20:49:30] <kimundi> rusti: from_str("2.0sdf").or(Some(1.0f32))
[20:49:31] -rusti- Some(1)
[20:49:40] <Tobba> rusti: from_str::<bool>("1")
[20:49:41] -rusti- None
[20:50:08] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[20:50:14] *** Joins: skade (skade@moz-6444221B.dip0.t-ipconnect.de)
[20:50:22] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[20:50:35] *** Joins: generalelectrix (Mibbit@6B286517.2650BBD6.8EE8B8D8.IP)
[20:51:01] *** Quits: espindola (espindola@moz-35429B8.dsl.teksavvy.com) (Input/output error)
[20:51:18] *** Quits: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: leaving)
[20:52:01] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:53:35] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:53:55] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[20:54:49] *** Joins: W0rmDr1nk (wormdrink@moz-CEAF0263.access.mtnbusiness.co.za)
[20:54:55] *** Quits: Rym (y@393F734D.E175BF4B.51C6DE68.IP) (Ping timeout)
[20:56:21] *** Joins: Rym (y@393F734D.E175BF4B.51C6DE68.IP)
[20:56:41] <Eridius> rusti: fn is_true(s: &str) -> bool { s == "y" || s == "yes" || from_str(s).or_else(|| let f = from_str(s); f.is_ok() && f != 0u) } (is_true("a"), is_true("1"), is_true("0"), is_true("yes"), is_true("no"))
[20:56:43] -rusti- pastebinned 7 lines of output: http://ix.io/buA
[20:57:02] <Eridius> rusti: fn is_true(s: &str) -> bool { s == "y" || s == "yes" || from_str(s).or_else(|| { let f = from_str(s); f.is_ok() && f != 0u) } } (is_true("a"), is_true("1"), is_true("0"), is_true("yes"), is_true("no"))
[20:57:04] -rusti- pastebinned 7 lines of output: http://ix.io/buB
[20:57:21] <Eridius> agh. Well, the idea is there. Tobba: ^
[20:57:21] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[20:57:23] * Eridius disappears again
[20:57:29] *** Joins: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP)
[20:57:44] <Tobba> hahahahah
[21:03:58] *** Joins: inlock (Mibbit@3B033EC5.8E64C8A4.D88E580A.IP)
[21:04:16] *** Joins: chris (Mibbit@moz-D362382.cp.telus.net)
[21:04:32] *** Joins: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl)
[21:04:57] <aochagavia> which version of Rust is used to write the compiler?
[21:05:25] <acrichto> aochagavia: we periodically create snapshots that are used to bootstrap new versions of the compiler
[21:05:36] <acrichto> we create new snapshots in an on-demand fashion
[21:05:39] <acrichto> (no particular version)
[21:06:01] <acrichto> we generally keep the compiler up to date with the language as much as possible
[21:06:13] <acrichto> the 0.10 compiler should be able to build the master compiler right now (but likely not for long)
[21:07:16] *** Quits: adonohue (adonohue@55513BD.95D3F462.59D8BB03.IP) (Quit: adonohue)
[21:07:52] <generalelectrix> what is the correct way to handle wrapping a C function that returns a C struct to use the result as a Rust struct?  I'd also like to pass the Rust struct back into C.
[21:08:09] *** Quits: Sorella (quildreen@moz-35210410.user3p.veloxzone.com.br) (Quit: Ex-Chat)
[21:08:33] *** Quits: chris (Mibbit@moz-D362382.cp.telus.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:08:49] <generalelectrix> Is there a way to do this without actually having to declare the specifics of the C struct in Rust if I don't need to access its fields directly in Rust?
[21:09:53] <acrichto> generalelectrix: you can have "pub enum MyCEnum {}" and then deal with *MyCEnum
[21:09:58] <acrichto> as long as you're only dealing with pointers
[21:10:07] <kimundi> generalelectrix: If you want to pass round the struct by value, you need to define a struct in Rust with identical layout.
[21:10:43] *** Quits: skade (skade@moz-6444221B.dip0.t-ipconnect.de) (Ping timeout)
[21:11:06] *** Quits: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de) (Input/output error)
[21:11:25] *** Quits: Nekit1234007_ (Nekit12340@moz-49BE8E9E.dyn.broadband.iskratelecom.ru) (Ping timeout)
[21:11:56] *** Joins: brendan (brendaneic@moz-62518563.mtv2.mozilla.com)
[21:12:24] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[21:12:24] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:12:40] <dsrx> huon: saw the PR for adding docs to the nightly tarballs, thanks! :)
[21:12:42] <aochagavia> acrichto: and what happens when you compile from 0?
[21:12:43] *** Quits: aatch|mobile (aatch@moz-2BB0AC01.cable.telstraclear.net) (Quit: AndroIRC - Android IRC Client ( http://www.androirc.com ))
[21:12:44] <generalelectrix> acrichto: hmm ok thanks, I think that might work.
[21:12:54] *** Joins: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net)
[21:13:09] <aochagavia> acrichto: do you always need to rely on a snapshot?
[21:13:22] <acrichto> aochagavia: there was an ocaml compiler at the very beginning
[21:13:52] <generalelectrix> arichto: why an enum for pointing to a struct?
[21:14:05] *** Joins: jviereck (Adium@moz-35DA1B1D.dip0.t-ipconnect.de)
[21:14:13] *** Joins: aatch|mobile (aatch@moz-2BB0AC01.cable.telstraclear.net)
[21:14:35] *** Quits: alan_andrade (alan_andra@moz-8862F69E.hsd1.ca.comcast.net) (Ping timeout)
[21:17:25] *** Quits: alonlevy (alon@7BE996CA.2941FB7D.51B98CA5.IP) (Ping timeout)
[21:17:34] <araujo> hello
[21:17:54] <araujo> managed boxes are like owned boxes but handled automatically by the GC?
[21:18:41] <araujo> also I don't find much references to this managed box concept in the latest docs, is this concept going to be deprecated or changed?
[21:18:59] <acrichto> generalelectrix: oh the enum is just creating something that's impossible to instantiate and impossible to look into
[21:19:09] <acrichto> generalelectrix: it's just giving you a type in rust to work with (you don't have to mirror it from C)
[21:19:10] <uzi_mantis> yo guys
[21:19:16] <uzi_mantis> how do i write a binary tree in rust
[21:19:39] <acrichto> araujo: managed boxes (@-boxes) are currently feature gated, and will likely change in the future. We're generally trying to discourage their use right now
[21:19:55] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[21:20:01] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:20:06] *** Joins: fuogo (Mibbit@762497ED.96F115D7.DDE5D3F6.IP)
[21:20:09] <aatch|mobile> uzi_mantis, well, how would you in another language? 
[21:20:20] <aochagavia> where is collect() defined?
[21:20:46] <aatch|mobile> aochagavia, std::iter
[21:20:47] <generalelectrix> arichto: ah ok I see that makes sense.  I found a pretty old example that declared something like type MYSTRUCT = ctypes::void though that is very out of date
[21:20:57] *** Quits: jxv (jxv@moz-8FB92450.lightspeed.irvnca.sbcglobal.net) (Quit: QUIT)
[21:21:09] <araujo> acrichto: aah I see
[21:21:10] <generalelectrix> arichto: is there a type in Rust that already represents a c pointer?
[21:21:13] <dpc> When I us ":mak" in Vim, rustc makes my Vim display weird.
[21:21:31] <araujo> generalelectrix: mm.. raw pointers?
[21:21:45] *** Quits: fuogo (Mibbit@762497ED.96F115D7.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:21:56] <acrichto> aochagavia: it's a function in the std::iter module, but implementations are found next to the containers that implement them
[21:22:24] <acrichto> generalelectrix: not particularly, there are many flavors, but you may be thinking of * pointers, (*int vs ~int)
[21:22:31] <aatch|mobile> generalelectrix, we have raw pointers that are mostly equivalent to C pointers. 
[21:22:46] *** Joins: curmet (Mibbit@762497ED.96F115D7.DDE5D3F6.IP)
[21:22:55] <curmet> hello
[21:22:56] <generalelectrix> araujo: ok, yes that makes sense.  here I guess declaring as an Enum with no variants gives some safety?
[21:23:11] <curmet> can someone look at this code and tell me why the last return statement cannot be executed?
[21:23:12] <curmet> http://pastebin.com/y68tN0g0
[21:23:43] <curmet> i get the following error: cannot move out of `self` because it is borrowed
[21:23:47] <curmet> how would i fix this
[21:24:07] <generalelectrix> acrichto: since the enum has no variants I can never construct one, so a raw pointer to one of those is just a raw pointer that has had a type lain on top of it to avoid just using a bare raw pointer?
[21:24:51] <apes> I'm trying to build the 0.10 release tarball from github, but I'm getting an error: ./configure: line 1005: /home/aaron/temp/rust-0.9/src/llvm/configure: No such file or directory
[21:24:57] <acrichto> generalelectrix: essentially yeah, and you can leverage the type system to hopefull catch some more possible bugs
[21:25:00] <apes> The nightly does not have this problem
[21:25:25] <dLog> I'm removing references to managed pointers from the tutorial. This is the last remaining instance of @ in tutorial.md, is there anything sensible I can change it to? "Casts to traits may only be done with compatible pointers so, for example, an `@Circle` may not be cast to an `~Drawable`."   I don't believe that works for e.g. &Circle, or does it?
[21:25:29] <apes> Well, that's the 0.9 release, but 0.10 has the same problem
[21:25:40] <generalelectrix> acrichto: thanks, I think this is a great solution.
[21:25:46] *** Joins: Nekit1234007_ (Nekit12340@6B5BB457.8C6C029.4707F662.IP)
[21:25:49] <acrichto> apes: what do you mean by "0.10 release tarball from github"? 
[21:25:58] <acrichto> apes: specifically the "from github" part
[21:26:00] *** Joins: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net)
[21:26:03] <apes> acrichto: https://github.com/mozilla/rust/releases
[21:26:08] *** Quits: mihneadb (mihneadb@moz-9897BD47.static.ziggozakelijk.nl) (Quit: Bye)
[21:26:13] <araujo> generalelectrix: mm.. better ask around, but what I understand is that raw pointers won't bring any kind of safety
[21:26:30] <acrichto> apes: those aren't officially supported, I recommend using the officially distributed version: http://static.rust-lang.org/dist/rust-0.10.tar.gz
[21:26:35] <curmet> im getting the following error: "cannot move out of `self` because it is borrowed" can someone help me with this?
[21:26:36] <araujo> if that's your concern/question
[21:26:39] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:26:42] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[21:26:45] <generalelectrix> araujo: I think it is inevitable to use them in this situation if the object in question will only live in C
[21:26:55] <acrichto> curmet: paste some code?
[21:27:10] <curmet> @arcrichto http://pastebin.com/y68tN0g0
[21:27:19] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[21:27:21] <araujo> generalelectrix: right
[21:27:30] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:28:05] <uzi_mantis> rusti: for i in range(0,1)
[21:28:05] -rusti- <anon>:12:5: 12:6 error: expected `{` but found `}`
[21:28:05] -rusti- <anon>:12     };
[21:28:05] -rusti-               ^
[21:28:05] -rusti- playpen: application terminated with error code 101
[21:28:23] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[21:28:41] <acrichto> curmet: try restraining the scopes of borrows with blocks, often if you do something like " { ... use a borrow .. } return moved_value" it will work ok
[21:28:47] <generalelectrix> araujo: the project I'm working on involves low-level communication with a serial port through ioctrl, so without re-declaring some of the objects involved in that interface in Rust I can't really get around using raw pointers and being careful in the C portion.
[21:29:03] *** Quits: aochagavia (Mibbit@moz-C82E8769.static.ziggozakelijk.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[21:29:11] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[21:29:25] <apes> acrichto: I did not realize the github repo was not official. The link you provided works, thank you.
[21:29:26] <acrichto> curmet: it's a little tough to see more without more code
[21:29:37] <curmet> but if the value is moved elsewhere can we return it?
[21:29:42] <bstrie> strcat: when describing rust iterators to C++ people, what C++ concept should I equate them to?
[21:29:49] <acrichto> apes: good to hear! I think the github release are more "they give this to us for free whether we want it or not"
[21:29:57] <strcat> bstrie: pairs of iterators, aka Boost.Range
[21:30:04] <acrichto> curmet: I'm not sure I follow
[21:30:16] <strcat> bstrie: which will probably become standard some day
[21:30:21] <bstrie> strcat: thanks
[21:30:24] <araujo> generalelectrix: raw pointers should be valid to interoperate with that foreign code, at least it sounds reasonable to me, though better check around, I just got back to check rust yesterday again, after been away from it since like pre-0.1 version , many things have been changing around here :)
[21:31:15] <o11c> acrichto: ugh, releases are not cool ... I have some code that won't build from a tarball unless the tarball was generated by 'make dist' ...
[21:31:20] <strcat> acrichto: yeah the github ones are just a tarball made from the tag, I hate them
[21:31:21] <curmet> acrichto: wouldn't the borrow go out of scope once the match statement leaves?
[21:31:24] <o11c> (which adds git info)
[21:31:24] *** Quits: uzi_mantis (iz@F7C4E486.BB968208.DDE5D3F6.IP) (Ping timeout)
[21:31:34] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[21:31:44] <strcat> acrichto: I have a some projects setting a VERSION define with git describe
[21:31:55] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[21:32:00] <strcat> and people open bugs saying the release tarball (that I don't think I can get rid of) is broken
[21:32:00] <o11c> yup
[21:32:01] * strcat cries
[21:32:03] *** Quits: lfox (lfox@moz-89EEE1BF.nyc.res.rr.com) (Quit: )
[21:32:09] <acrichto> curmet: scopes of borrows aren't always dictated by the lexical structure (there's an open bug on this), so sometimes you have to instruct it with more explicit blocks
[21:32:12] *** Quits: Loudergood (quassel@moz-78A0CE2E.hsd1.vt.comcast.net) (Connection reset by peer)
[21:32:17] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[21:32:19] <strcat> sometimes I really hate github
[21:32:48] <strcat> I like it better overall than gitorious/bitbucket though ;s
[21:32:50] <o11c> strcat: maybe you could inspect the directory name ?
[21:32:54] <curmet> acrichto: so something like { match{ ...borrow...}  } return moved_val?
[21:32:57] <strcat> o11c: heh
[21:33:02] <strcat> o11c: someone will find a way to break it
[21:33:09] <acrichto> curmet: that may work, yeah
[21:33:12] <o11c> yeah, I haven't done that either
[21:33:15] <curmet> acrichto: not sure what you mean by explicit blocks
[21:33:22] <acrichto> curmet: { ... }
[21:33:23] <o11c> I prefer saying "you must build from my tarball"
[21:33:34] <curmet> acrichto: just tried didnt work :/
[21:33:35] <o11c> (I use git archive and then replace version.make)
[21:33:43] <acrichto> curmet: what line is the error pointing at
[21:34:03] *** Joins: Loudergood (quassel@moz-78A0CE2E.hsd1.vt.comcast.net)
[21:34:04] <curmet> the last "return self;" line
[21:34:28] <acrichto> curmet: where does the error say that it was previously borrowed?
[21:34:57] <curmet> acrichto: at the match
[21:35:21] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[21:35:29] <acrichto> curmet: do you have a larger version of the code that I could try to tweak myself?
[21:36:41] <curmet> acrichto: i do but its pretty large. most if it isnt my own. its for my class and we're modifying a kernel so we're just using rust_core
[21:36:57] <curmet> acrichto: *simple kernel
[21:37:37] <acrichto> curmet: hm, so you changed it to { match ... { ... } } ?
[21:37:45] <acrichto> { match ... { ... } } return self;
[21:37:52] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Quit: Leaving.)
[21:38:07] <curmet> acrichto: yup
[21:38:09] *** Quits: generalelectrix (Mibbit@6B286517.2650BBD6.8EE8B8D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:38:28] <acrichto> curmet: what happens if you change &'a mut**x to &mut **x
[21:38:53] <nszceta> .
[21:38:54] *** Quits: tigrou3tac (fabien@moz-6E2397FF.fbx.proxad.net) (Ping timeout)
[21:39:15] *** Quits: nszceta (nszceta@moz-9EFAFF40.wireless.pitt.edu) (Quit: Textual IRC Client: www.textualapp.com)
[21:39:18] *** Joins: nszceta (nszceta@moz-9EFAFF40.wireless.pitt.edu)
[21:39:51] <curmet> acrichto: same thing. i also added blocks around the match 
[21:40:03] <acrichto> curmet: could you paste the current code?
[21:40:27] <acrichto> I think that there may be an open bug on this, I'm not sure why it's not working though
[21:40:34] <acrichto> this does look like it *should* work
[21:40:46] *** Quits: Ms2ger|sad (Ms2ger@moz-98421F60.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:41:07] <curmet> acrichto: http://pastebin.com/CCzuzLCw
[21:42:22] <acrichto> curmet: yeah sorry, I'm not entirely sure why it's not accepting that :(, if you can reduce it to a smaller test case, feel free to open an issue!
[21:42:52] <curmet> acrichto: aww darn. alrighty. thanks for the help! 
[21:43:25] *** Quits: oal (oal@26029749.1D466084.2CFD4520.IP) (Quit: Goodbye, cruel world.)
[21:43:35] *** Quits: themgt (themgt@moz-235071C6.dhcp.hckr.nc.charter.com) (Quit: Pogoapp - http://www.pogoapp.com)
[21:43:50] *** Joins: oal (oal@26029749.1D466084.2CFD4520.IP)
[21:45:06] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[21:45:41] *** Quits: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net) (Ping timeout)
[21:45:42] *** Quits: curmet (Mibbit@762497ED.96F115D7.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:47:46] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[21:48:58] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[21:49:05] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[21:50:37] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[21:50:43] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[21:51:25] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[21:52:42] *** Joins: mye (mye@moz-55C374B9.swh.uni-giessen.de)
[21:52:48] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[21:52:50] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[21:52:54] *** Quits: celm (celm@28EA790F.C8D2EDAC.4E808C72.IP) (Ping timeout)
[21:52:54] *** Joins: celm_ (celm@28EA790F.C8D2EDAC.4E808C72.IP)
[21:53:17] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[21:53:36] <dpc> Is there anything like RcMut ?
[21:54:06] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[21:54:17] <acrichto> dpc: Rc<RefCell<T>>
[21:54:31] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Quit: arturo)
[21:54:36] <dpc> Oh, my god. :D
[21:55:15] *** Quits: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net) (Ping timeout)
[21:55:27] <strcat> dpc: or Rc<Cell<T>> for a simple type with a dtor
[21:55:53] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[21:56:00] <dpc> Vec<Rc<RefCell<~Creature>>> vs Vec<Rc<RefCell<Creature>>> ?
[21:57:07] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[21:57:12] <Tobba> HashMap is weird
[21:57:18] <Tobba> am I meant to use ~str or &str as a key?
[21:57:53] <dpc> Does HashMap owns the keys?
[21:58:04] <Tobba> I have no clue, it should though
[21:58:10] <strcat> dpc: HashMap<K, V> stores K and V by-value
[21:58:17] <strcat> you can ofc use &Foo as a key type
[21:58:19] <Tobba> it should be ~str but then it really doesnt like finding things in it
[21:58:27] <aatch|mobile> Tobba, you can use either, but ~str is generally the one you want. 
[21:58:37] <Tobba> find() doesnt work for shit when you have ~str
[21:58:43] <Tobba> it wants an &~str for searching
[21:58:46] <strcat> Tobba: find takes &K, where K is ~str in this case
[21:58:47] <strcat> sure
[21:58:49] <strcat> use find_equiv
[21:58:50] <dpc> I I'd guess ~ is the way to go usually.
[21:59:02] <dpc> Sorry for repeating myself: Vec<Rc<RefCell<~Creature>>> vs Vec<Rc<RefCell<Creature>>> ?
[21:59:03] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[22:00:08] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:00:29] <tfogal> "cannot index a value of type `std::vec::Vec<*i8>`"   okay.. but why?  what's wrong with that vec that it can't be indexed?
[22:00:31] <strcat> dpc: no reason to use ~ inside Rc
[22:00:33] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:01:03] <Tobba> is there any easy way to get millisecond time?
[22:01:15] <strcat> the only reason to use ~ is when you have to (recursive type, dynamic dispatch via a trait object) or in rarer cases to avoid copying a large type when passing it around by-value
[22:01:16] <Tobba> oh, theres a libtime?
[22:01:17] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[22:01:20] <Tobba> well, then
[22:01:37] <aatch|mobile> tfogal, no index overloading for Vec at this time. Use get and get_mut. 
[22:01:45] <Tobba> (why can timespec store a negative nanosecond value?)
[22:01:53] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:02:07] *** Quits: patpat (patpat@moz-21619C28.as13285.net) (Quit: )
[22:02:48] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:03:12] <tfogal> aatch|mobile: gotcha, thanks!
[22:03:19] <strcat> Tobba: libtime is poorly 'designed'
[22:03:26] <strcat> it's just old cruft from a long time ago
[22:03:41] <Tobba> should support traits for math ops on it too, would be excellent
[22:03:53] <strcat> timespec is a POSIX type, it's not what a proper time library is going to expose
[22:03:55] <Tobba> so I guess that crate could use some work yeah
[22:04:04] <Tobba> time -> string functions
[22:04:08] <Tobba> string -> time functions
[22:04:13] <Tobba> (this is pretty much literally satan)
[22:04:14] <strcat> the whole thing needs to be thrown out and redone
[22:04:23] <Tobba> leap years? sure
[22:04:26] <Tobba> leap seconds? shit
[22:04:37] <strcat> it's a time library, not a date library
[22:04:48] <Tobba> I guess
[22:04:54] <Tobba> time does kinda involve dates too
[22:05:06] <strcat> you aren't going to have datetimes to nanosecond precision though
[22:05:32] *** flaper87 is now known as flaper87|afk
[22:05:53] <Tobba> well yeah
[22:05:54] *** Joins: Ferreus (ferreus@moz-AFFBCA6A.lsn.wtnet.de)
[22:06:03] <Tobba> but nonetheless, that should probably be in std
[22:06:15] <Tobba> even though you need a gigantic lookup table for it which has to be updated daily
[22:06:23] <Tobba> welcome to time keeping
[22:06:31] <strcat> for time zones
[22:06:34] <Tobba> (well not really daily, more like on a days notice)
[22:06:49] <strcat> a low level time library doesn't really need time zones
[22:07:04] <Tobba> then theres some shit like iirc isreali people in palestine follow another time zone
[22:07:21] <Tobba> well yeah, we probably should have a library for that though, its easily the most godawful thing ever to have to implement
[22:07:26] <strcat> it should just have simple monotonic/realtime clocks, sleep(reltime), sleep(abstime), basic operators, etc.
[22:07:32] <Tobba> yeah I guess
[22:08:11] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[22:09:19] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:09:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:09:51] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Ping timeout)
[22:10:19] *** Joins: pongad (pongad@moz-7E8AAD2E.res.gatech.edu)
[22:10:28] <pongad> Does anyone know what `powi` does?
[22:10:43] <strcat> raises to a power, where the power is given as an integer
[22:10:45] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:11:26] <pongad> Oh, so it's not an imaginary power right? :D
[22:11:42] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:11:47] <pongad> I was thinking pow(x, y) = x^(iy)
[22:11:57] <strcat> it's just like pow with an integer
[22:12:13] <strcat> the complex number stuff is separate in libc ;p
[22:12:35] *** Joins: rylev (rylev@FDA7C5E.8B1408EE.2DB0BBA1.IP)
[22:12:37] <strcat> cpow
[22:14:33] <Havvy> cpow; feel pow
[22:15:41] <kmc> does rustc have a module providing intrinsics for fancy SSE instructions? or can I import said intrinsics from LLVM? or should I just write inline asm
[22:15:56] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[22:16:20] <kmc> I'm looking not for generic SIMD types but rather individual platform-specific instructions
[22:17:06] *** Quits: jviereck (Adium@moz-35DA1B1D.dip0.t-ipconnect.de) (Quit: Leaving.)
[22:17:07] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[22:17:09] <pongad> strcat: So...in C, rint() might set FE_INEXACT, is there a way to get to that in Rust?
[22:17:19] <pongad> Otherwise rint() and nearbyint() are the same function
[22:17:26] <strcat> pongad: no, LLVM doesn't support floating point exceptions atm
[22:17:34] <strcat> it also doesn't support floating point rounding mode
[22:17:39] <strcat> any program using either has undefined behaviour
[22:17:53] <pongad> So...do we not include the two functions yet?
[22:18:20] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[22:18:25] *** Joins: jviereck (Adium@moz-35DA1B1D.dip0.t-ipconnect.de)
[22:18:26] <pongad> They are 2 of the 3 functions with the intrinsics but not defined in Float trait
[22:18:33] <strcat> pongad: there's no difference from rust's perspective
[22:18:41] <strcat> should only expose nearbyint
[22:19:07] <pongad> But nearbyint also uses fegetround too right?
[22:19:37] <strcat> well, I guess only round should be exposed
[22:19:42] <strcat> no nearbyint/rint
[22:19:51] <pongad> ok dokes
[22:20:05] *** Quits: qwerty_nor (Thunderbir@A5447B90.EDC74FC5.E19950A4.IP) (Ping timeout)
[22:20:07] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Ping timeout)
[22:20:38] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:21:38] <kmc> there is a way to import llvm intrinsics as rust functions, right?
[22:23:14] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:23:34] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:23:36] <pongad> strcat: Actually is there any reason why some functions want Self and others want &Self in Float?
[22:23:42] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[22:23:43] <pongad> strcat: They seem inconsistent
[22:23:51] <strcat> kmc: we expose most of the portable ones
[22:24:06] <strcat> kmc: for arch-specific ones, use #[link_name = "llvm.x86.*"] on an extern fn
[22:24:22] <kmc> okay
[22:24:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:24:37] <kmc> what type would I use for a 128-bit SSE input/output?
[22:24:53] <strcat> kmc: #[simd] struct Foo(f64, f64)
[22:25:18] <kmc> can I do #[simd] struct Foo([u8, ..16]) ?
[22:25:27] <strcat> kmc: no, have to write it 16 times
[22:25:33] <kmc> B|
[22:25:35] <kmc> ok
[22:26:04] *** Quits: abinader (sid21713@moz-A42E5B7B.irccloud.com) (Quit: )
[22:26:09] <strcat> pongad: because it was never really decided if it is meant for just the primitive f32/f64 (and one day f128) or for extended/arbititary precision types too
[22:26:11] <dsrx> there's an issue for that isn't there?
[22:26:13] <strcat> arbitrary*
[22:26:22] <strcat> kmc: it's going to improve
[22:26:26] <strcat> kmc: it's just an early sketch
[22:26:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:26:45] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[22:27:24] <dLog> er, getting used to GitHub here. Think I did something wrong. Is that was my PR commits should be if I'm only looking to send the last two ones here: http://i.imgur.com/N2iHJgI.png   The first two are in rust/master already by auto merging, and those other 5 are from the rebasing I did, which shows also as a commit just before my actual two new ones
[22:27:39] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:28:08] *** Joins: rust-newbie (Mibbit@moz-F789A697.hfc.comcastbusiness.net)
[22:28:24] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Ping timeout)
[22:28:33] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:28:40] <carllerche> For my own education, why is borrowing a ref as mutable more than once at a time in the same fn body dangerous?
[22:28:41] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[22:28:58] *** Quits: jviereck (Adium@moz-35DA1B1D.dip0.t-ipconnect.de) (Quit: Leaving.)
[22:29:07] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[22:29:08] <rust-newbie> Hi there! Is there a best-practices guide I should follow when using print() vs print!()? For example, is it better to use print(num) or print!("{}", num)?
[22:29:09] <pongad> strcat: OK, I'll keep the old def then, shouldn't be too hard to change after the fact
[22:29:21] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[22:29:27] <acrichto> carllerche: when you know that two pointers don't alias, you can say very interesting things about them, so we forbid two aliasing mutable pointers
[22:29:30] <pongad> rust-newbie: `print(num)` will probably give you an error :D
[22:29:38] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:29:57] <pongad> rust-newbie: print() only works with strings if my memory serves
[22:30:04] <rust-newbie> Er, excuse me, print(num.to_str())
[22:30:07] <strcat> carllerche: the basic reason is based on the borrow checker - aliasing mutable refs are unsafe for most types
[22:30:08] <pongad> rusti: print(2)
[22:30:08] -rusti- <anon>:11:9: 11:14 error: unresolved name `print`.
[22:30:08] -rusti- <anon>:11         print(2)
[22:30:09] -rusti-                   ^~~~~
[22:30:09] -rusti- error: aborting due to previous error
[22:30:09] -rusti- playpen: application terminated with error code 101
[22:30:24] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Ping timeout)
[22:30:27] <bjz> print(num.to_str()) is less efficiaent
[22:30:32] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:30:37] <bjz> efficient 
[22:30:43] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[22:30:44] <pongad> The lord has spoken!
[22:30:48] <bjz> you have to make an intermediate strung
[22:30:52] <strcat> carllerche: take a reference into a container, remove elements from the container through another ref
[22:30:53] <bjz> *string
[22:31:02] *** Quits: leowoe (Leo@moz-72D47201.dclient.hispeed.ch) (Ping timeout)
[22:31:02] <strcat> carllerche: take a reference into an enum, change the type of the enum through another ref
[22:31:05] <strcat> carllerche: etc.
[22:31:09] <carllerche> seems bad! :P
[22:31:11] *** Joins: leowoe (Leo@moz-72D47201.dclient.hispeed.ch)
[22:31:12] <rust-newbie> bjz: Does print!("{}", num) not create that intermediate string?
[22:31:17] <strcat> carllerche: yeah, dangling pointers
[22:31:21] <strcat> which rust prevents
[22:31:23] <hirsch> is it possible to match nested structures with enums in one match operation?
[22:31:26] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:31:28] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[22:31:33] <bjz> rust-newbie: no, it does not allocate
[22:31:59] <pongad> Wait what it doesn't?
[22:32:17] <pongad> Rust never cease to surprise me :D
[22:32:37] <huon> it sometimes does, e.g. I think `print!("{10.1}", num)` will allocate
[22:32:37] <rust-newbie> Thanks very much :)
[22:32:45] <huon> hirsch: yes
[22:33:10] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:33:20] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:33:35] *** Joins: devbug (quassel@moz-8C40558B.bchsia.telus.net)
[22:33:49] *** Quits: rust-newbie (Mibbit@moz-F789A697.hfc.comcastbusiness.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:34:10] <hirsch> huon: what's the syntax? match st { A{ elem:  Enum(..)} => ...}  ? 
[22:34:16] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:34:26] *** Quits: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca) (Quit: canhtak)
[22:35:11] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Ping timeout)
[22:35:40] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[22:35:41] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:38:34] *** Joins: generalelectrix (Mibbit@6B286517.2650BBD6.8EE8B8D8.IP)
[22:38:40] *** Quits: nszceta (nszceta@moz-9EFAFF40.wireless.pitt.edu) (Quit: Textual IRC Client: www.textualapp.com)
[22:38:42] *** Quits: rootnode (rootnode@moz-7D8AB6F3.pools.arcor-ip.net) (Ping timeout)
[22:38:47] <huon> rusti: struct Foo { x: A } enum A { B(int), C(f64) } match Foo { x: B(10) } { Foo { x: C(_) } => 1, Foo { x: B(3) } => 2, _ => 3 }
[22:38:47] -rusti- 3
[22:38:52] <huon> rusti: struct Foo { x: A } enum A { B(int), C(f64) } match Foo { x: B(3) } { Foo { x: C(_) } => 1, Foo { x: B(3) } => 2, _ => 3 }
[22:38:53] -rusti- 2
[22:38:59] <huon> rusti: struct Foo { x: A } enum A { B(int), C(f64) } match Foo { x: C(0.0) } { Foo { x: C(_) } => 1, Foo { x: B(3) } => 2, _ => 3 }
[22:39:01] -rusti- 1
[22:39:27] <huon> rusti: struct Foo { x: A } enum A { B(int), C(f64) } match Foo { x: C(123.5) } { Foo { x: C(c) } => c as int + 1.0, Foo { x: B(3) } => 2, _ => 3 }
[22:39:28] *** Quits: Rym (y@393F734D.E175BF4B.51C6DE68.IP) (Ping timeout)
[22:39:30] -rusti- pastebinned 5 lines of output: http://ix.io/buH
[22:39:32] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[22:39:34] <generalelectrix> I have a C function int tcgetattr(int fildes, struct termios *termios_p);  when I declare this in an extern { block in Rust, does it matter what type I declare the second field as, so long as its a pointer?
[22:39:37] <huon> rusti: struct Foo { x: A } enum A { B(int), C(f64) } match Foo { x: C(123.5) } { Foo { x: C(c) } => c as int + 1, Foo { x: B(3) } => 2, _ => 3 }
[22:39:38] -rusti- 124
[22:39:41] <huon> hirsch: ^
[22:39:47] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:39:48] *** Quits: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net) (Quit: Leaving.)
[22:39:55] *** Joins: Rym (y@393F734D.E175BF4B.51C6DE68.IP)
[22:40:09] <hirsch> huon: wow thanks
[22:40:10] <dLog> Anyone here have experience contributing through github? I'm looking to get a PR sent out quickly, but it doesn't seem right how it rebased
[22:40:22] <huon> generalelectrix: it needs to be `*mut termios` (assuming `termios` is the name of the struct you define in Rust)
[22:40:30] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[22:40:43] <generalelectrix> I'm attempting to avoid declaring the strut in Rust at all
[22:40:54] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:40:59] <generalelectrix> termios is already defined in a C library and I'd like to only ever pass pointers to them into Rust
[22:41:01] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[22:41:03] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:41:06] <MarcWeber> dLog: you should be able to rebase yourself and update the branch, the PR should pick your changes up then.
[22:41:39] <dLog> MarcWeber, I did, but it looks funny to me, but perhaps it is right: http://i.imgur.com/N2iHJgI.png
[22:41:47] <huon> generalelectrix: does every function interacting with the struct return/receive pointers?
[22:41:47] *** Quits: azita (Azita@moz-62518563.mtv2.mozilla.com) (Quit: azita)
[22:42:01] <generalelectrix> yes
[22:42:07] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:42:15] <dLog> only those bottom two are what I am looking to send. The first two are merged from yesterday, the middle 5 are what got rebased in, and the last extra one was where I did the rebase
[22:42:34] <huon> generalelectrix: `enum termios {}` is the conventional way to declare black box FFI types
[22:42:40] <generalelectrix> huon: I've defined in Rust an enum Termios {} so I can have a pointer to a term-
[22:42:42] <generalelectrix> exactly
[22:42:42] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[22:42:48] <huon> cool :)
[22:43:00] <pongad> I just realized that `make check -j` is not a great choice...
[22:43:16] *** Joins: saml_ (saml@BE83DFD.50866E69.CA2DF2C0.IP)
[22:43:19] <MarcWeber> dLog: why not do git rebase master (when being on your branch), and push -f that? Then history should be clean - you may want to test this on a temporarry branch name first: git checkout -b foo your-branch, then rebase foo on master and have a look whether history of foo is nicer
[22:43:28] *** Parts: MarcWeber (marc@moz-FC10E83F.de) ()
[22:43:32] <huon> generalelectrix: C's `T*`  <-> Rust's `*mut T`; C's `const T*` <-> Rust's `*T`
[22:43:41] <huon> generalelectrix: btw, have you seen rust-bindgen?
[22:43:47] *** Joins: rootnode (rootnode@moz-1E97D78F.pools.arcor-ip.net)
[22:44:01] <generalelectrix> huon: yes I have, but I need a minimal interface and wanted to write it myself for the experience
[22:44:16] *** Joins: canhtak (canhtak@moz-641FE58F.wl.t.ulaval.ca)
[22:45:34] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:45:42] <tfogal> I need a c95::c_char from a str.  i imagine i have to free this myself, which is fine, but i can't seem to get at it in the first place
[22:45:44] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:45:48] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[22:46:05] <tfogal> there's with_ref but that's not very convenient when i need go from an array of str to an array of *c_char
[22:46:29] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[22:46:33] <tfogal> ideas?
[22:46:48] <huon> tfogal: std::c_str
[22:47:01] <huon> most easily accessible via the with_c_str method on strings
[22:47:13] <huon> generalelectrix: ok :)
[22:47:45] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[22:47:55] <huon> Oh, with_ref must be what you're looking at
[22:48:20] <kmc> strcat: getting an ICE :(  https://gist.github.com/kmcallister/9984566
[22:48:40] *** Joins: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net)
[22:48:49] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:48:50] <tfogal> huon: thanks, but with_c_str deallocates when the block finishes.  in this case, i'd be fine with it converting when the function ends, but the block is too soon.
[22:48:57] <tfogal> errr
[22:48:58] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:49:01] <strcat> kmc: I meant you have to put #[link_name = "llvm.x86.specific_intrinsic"] on the function ;)
[22:49:01] <tfogal> s/converting/deallocating/
[22:49:17] <huon> tfogal: .to_c_str()
[22:49:19] <strcat> kmc: unsure about the error though
[22:49:23] <huon> gives a CString
[22:49:28] <strcat> kmc: maybe we don't support passing simd types to extern functions yet.
[22:49:33] <kmc> strcat: okay, I wasn't sure ^_^
[22:49:41] <strcat> kmc: maybe try 'extern "Rust" { }'
[22:50:01] <huon> tfogal: (btw with_c_str actually puts strings < 100 bytes straight on the stack, no heap allocation done)
[22:50:11] <tfogal> yes, but a CString still isn't a *c_char, and i have not yet seen a way to pull out the actual pointer
[22:50:18] * tfogal goes for another CString look
[22:50:20] <kmc> strcat: ok that eliminates the ICE anyway
[22:50:34] <strcat> kmc: which?
[22:50:58] <tfogal> oh maybe as_bytes does what i need
[22:50:59] * tfogal tries
[22:51:07] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:51:08] <kmc> extern "Rust"
[22:51:17] *** Quits: fabiand (fabiand@moz-2896AE16.adsl.alicedsl.de) (Quit: Verlassend)
[22:51:18] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[22:51:24] <huon> tfogal: you can just use .with_ref(|p| p)
[22:51:45] <huon> but make sure that the pointer you get out doesn't escape from the lifetime of the CString
[22:51:56] *** Quits: paraze (paraze@moz-9E76094B.w90-27.abo.wanadoo.fr) (Quit: Quitte)
[22:52:05] <huon> tfogal: if you just want &[u8] then .as_bytes() is fine, but do note that it can have interior NULs
[22:52:07] *** Joins: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP)
[22:52:20] <huon> and doesn't have a terminating NUL
[22:52:26] <tfogal> oh
[22:53:18] <tfogal> grumble.  maybe something else is wrong, then.
[22:53:51] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[22:55:08] *** Joins: tjc (tjc@5358A633.3778D849.1D6E592A.IP)
[22:55:08] *** ChanServ sets mode: +o tjc
[22:55:22] *** Quits: gimpf (gimpf@moz-64945CFF.adsl.highway.telekom.at) (Quit: Leaving.)
[22:56:57] *** Quits: inlock (Mibbit@3B033EC5.8E64C8A4.D88E580A.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:57:03] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[22:57:28] <kmc> error: internal compiler error: unimplemented foreign functions with Rust ABI
[22:57:29] <kmc> :/
[22:57:34] <strcat> heh
[22:57:36] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[22:57:49] <strcat> kmc: well, if it ICEs when passing SIMD types to an extern "C" function I guess you can't do it yet
[22:57:57] <kmc> that does seem to be the case
[22:58:03] <kmc> inline asm it is!
[22:58:14] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[22:58:27] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[22:58:46] <tfogal> bleh.  "got" it.  honestly i just gave up and used unwrap(), which gives me exactly the thing i need
[22:58:59] <tfogal> it memleaks, but i exec(2) right afterwards anyway, so i can live with a leak.
[22:59:02] *** Quits: brendan (brendaneic@moz-62518563.mtv2.mozilla.com) (Quit: brendan)
[22:59:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:59:59] *** Joins: ksf (ksf@moz-60045C32.adsl.hansenet.de)
[23:00:39] *** Quits: cschneid (cschneid@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[23:00:59] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:02:43] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:03:48] *** Quits: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP) (Quit: Leaving.)
[23:04:58] *** Quits: janra (Janus@1CDC5701.A48867D7.52E4E107.IP) (Ping timeout)
[23:05:12] *** Joins: brendan (brendaneic@moz-62518563.mtv2.mozilla.com)
[23:06:26] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[23:07:31] *** Quits: willingc (willingc@moz-F095E013.san.res.rr.com) (Ping timeout)
[23:07:36] *** Quits: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[23:09:44] *** Joins: patpat (patpat@moz-21619C28.as13285.net)
[23:11:31] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[23:15:29] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[23:18:40] <Rusky> is there a way to pass a dynamically sized 2d array as an argument
[23:18:57] <strcat> yes, just pass it like any other type
[23:19:01] <strcat> by-reference if you want
[23:19:13] <pongad> &[~[T]]?
[23:19:23] <pongad> I think I got it right
[23:19:24] <Rusky> as in, not an array of pointers, but an actual 2d array
[23:19:34] <Rusky> an array of unboxed arrays
[23:19:39] <pongad> oh
[23:19:40] <strcat> Rusky: sure
[23:19:57] <strcat> just use Vec<int>
[23:20:11] *** Quits: Matthias247 (Miranda@moz-678B5E4A.hsi2.kabel-badenwuerttemberg.de) (Connection reset by peer)
[23:20:11] *** Quits: frozendevil (Adium@moz-62FB197F.com) (Quit: Leaving.)
[23:20:11] <strcat> wrap it and index by row * n_cols + col
[23:20:17] <Rusky> eh I guess that works :P
[23:20:28] <strcat> that's how a dynamic 2d array is done
[23:20:39] <Rusky> I don't mean resizeable
[23:20:57] <Rusky> the use case is passing array literals to the function as a kind of dsl
[23:21:12] <Rusky> in c++ I'd probably pass the size of the arrays as a template argument
[23:21:16] <Rusky> but rust doesn't do that
[23:21:26] <strcat> I'm not sure I understand
[23:21:55] <strcat> like passing various sizes of std::array<T, n> in C++ to the same function?
[23:22:00] <o11c> Rusky: you're talking about [[int, ..m], ..n] ?
[23:22:02] <Rusky> fn foo(x: &[[T, ..x], ..y])
[23:22:03] <Rusky> yeah
[23:22:09] <o11c> but rust doesn't have integer template parameters
[23:22:14] <Rusky> exactly
[23:22:45] <strcat> Rusky: pass an iterator of slices
[23:22:59] <Rusky> ah that's an interesting idea
[23:23:11] *** Quits: c74d3 (c74d3a4ebb@moz-E2EAC718.oc.oc.cox.net) (Connection reset by peer)
[23:25:36] <Tobba> uh
[23:25:41] <Tobba> I have a pointer to a tuple with an f32 in it
[23:25:48] <Tobba> why cant I take that f32 out
[23:25:49] *** Joins: dotfelix (dotfelix@61336F9D.3702C509.CDA2360F.IP)
[23:26:19] <Tobba> in this instance t += frame.val1();
[23:26:34] <Tobba> frame has the type &(Vec<(u32, u32)>, f32)
[23:26:36] <Tobba> I dont see why this wouldent work
[23:26:50] <Tobba> but that is apparently moving out of a dereference
[23:27:13] *** Joins: derek_c (derek@moz-1578B046.cit.cornell.edu)
[23:27:23] *** Joins: fournm (Aria@moz-ABB60BA0.austin.res.rr.com)
[23:27:39] <strcat> Tobba: use ref1
[23:27:48] <strcat> val takes the tuple by-value
[23:28:03] <Tobba> its just copying an f32 by value though
[23:28:06] <Tobba> or wait
[23:28:10] <Tobba> oh it takes the whole tuple by value
[23:28:14] <kmc> error: couldn't allocate output register for constraint 'c'
[23:28:29] <kmc> gcc and clang are ok with this register constraint (it means %cx / %ecx / %rcx)
[23:28:31] <Tobba> llvm sucks at inline asm
[23:28:37] <Tobba> oh, it works in clang?
[23:28:38] <kmc> but... clang...
[23:28:40] <kmc> yeah
[23:28:44] <kmc> I made sure of that :)
[23:29:02] <o11c> isn't llvm's native register constraint system completely different from the gcc one (which clang implements?)
[23:29:15] *** Quits: brendan (brendaneic@moz-62518563.mtv2.mozilla.com) (Quit: brendan)
[23:29:19] *** Quits: dotfelix (dotfelix@61336F9D.3702C509.CDA2360F.IP) (Quit: )
[23:29:20] <Tobba> its register allocator is basicaly really stupid
[23:29:35] <o11c> (I don't know anything about llvm asm, I'm just basing this on some .ll code I saw once)
[23:29:39] <Tobba> there are lot of clever things it could do to work around situations but it just dies
[23:29:39] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[23:29:51] <Tobba> and usually is much less than clever
[23:29:59] <kmc> yeah, where can I read about the llvm constraint system?
[23:30:06] * kmc googles
[23:30:06] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[23:30:10] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: hjr3)
[23:30:49] <kmc> the few asms in libstd look pretty much like gcc syntax to me
[23:30:56] <kmc> but they aren't using specific registers
[23:31:15] * kmc . o O ( #[register="ecx"] let mut res: u32 = 0; )
[23:31:15] <mcpherrin> where's Luqman when you need him
[23:31:54] <mcpherrin> hmm looks like burntsushi might finish his regex RFC before I finish mine
[23:33:04] *** Joins: james4k (james@moz-9BB5AE72.consolidated.net)
[23:34:34] <Jesse> what does the o_O keyword do? is it like unsafe?
[23:34:53] <Jesse> disable all warnings for this block?
[23:34:53] <kmc> looks :D
[23:35:03] <kmc> er
[23:35:07] <kmc> that was meant to be just ":D"
[23:35:18] <kmc> it got tacked onto part of an unrelated complaint about LLVM
[23:35:51] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[23:36:54] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[23:37:14] *** Quits: Ferreus (ferreus@moz-AFFBCA6A.lsn.wtnet.de) (Quit: WeeChat 0.4.4-dev)
[23:37:35] <Tobba> so uh
[23:37:40] <Tobba> what is the proper way to disable libnative again
[23:37:44] <Tobba> with no_start it still seems to load it
[23:38:00] <Tobba> stdio still works fine etc
[23:38:44] <huon> println!() has a fall back to a call-c-directly io thing, iirc
[23:38:52] *** Joins: wilfred (uid159@moz-5F4AA75A.irccloud.com)
[23:39:06] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[23:39:20] <Tobba> nope
[23:39:24] <Tobba> its still running tons of windows functions
[23:39:30] <Tobba> or maybe that stuff is coded into libstd?
[23:39:35] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[23:39:47] <huon> tfogal: did you not see my suggestion for `.with_ref(|p| p)`? `let c_str = string.to_c_str(); let pointer = c_str.with_ref(|p| p);`
[23:40:15] <huon> Tobba: yes, hard coded into libstd
[23:40:18] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:40:21] <Tobba> fucks sake
[23:40:25] <huon> please!
[23:40:37] <huon> are you compiling something for windows?
[23:40:46] <Tobba> emscripten
[23:40:52] <Tobba> it only supports POSIX
[23:41:00] <Tobba> and cross compiling on mingw is...
[23:41:00] *** Joins: frozendevil (Adium@moz-A9D8109F.hsd1.wa.comcast.net)
[23:41:02] <Tobba> pretty damn broken
[23:41:30] <huon> what target are you specifying?
[23:41:38] <Tobba> I cant remember right now
[23:41:42] <Tobba> i386-linux-elf or something like that
[23:41:47] <Tobba> it would shit itself pretty badly when trying to link it
[23:42:09] <huon> I don't think that's a target triple rustc recognises is it?
[23:42:13] <Tobba> no
[23:42:18] <huon> ...
[23:42:20] <Tobba> (it actually is, but anyways)
[23:42:22] <Tobba> thats ont the point
[23:42:27] <Tobba> libstd needs a cross compile
[23:42:28] <huon> huh?
[23:42:35] <Tobba> i.e you need to rebuild the whole goddamn compiler
[23:42:44] <Tobba> to output linux binaries
[23:42:48] <Tobba> this doesnt function at all on mingw
[23:42:48] <huon> why do you expect compiling to a target triple that rustc doesn't support to work?
[23:42:52] <Tobba> uh
[23:42:55] <Tobba> this IS supported
[23:42:57] <Tobba> by the CONFIGURE SCRIPT
[23:43:01] <huon> oh
[23:43:03] <Tobba> I never said I was feeding it into rustc
[23:43:05] <huon> then why did you say "no"?
[23:43:09] <Tobba> because its not
[23:43:14] *** Joins: bpicolo (Adium@moz-B475EB64.static-ip.telepacific.net)
[23:43:19] <huon> eh? the configure script feeds it to rustc
[23:43:21] * huon is confused
[23:43:23] <Tobba> well I thought it was, rustc will actually recognize that
[23:43:30] <Tobba> the backend driver rustc uses
[23:43:32] <kmc> oh horray also if you do the standard C thing  asm("foo"  "bar"  "baz" : ...) (on multiple lines) then rust's asm!() silently drops all but the last line
[23:43:34] <Tobba> is the most retarded thing I've ever seen
[23:43:50] <Tobba> it just does string finding
[23:43:57] <Tobba> i386linux is completely valid
[23:44:15] <Tobba> actually, it might check for the -'s somewhere, but you get the point
[23:44:45] <Tobba> basicaly compiling a linux rustc on mingw doesnt work at all
[23:44:52] <Tobba> so I can only build emscripten binaries under linux I think
[23:44:57] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[23:45:15] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[23:45:29] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[23:45:46] <kmc> please don't use "retarded" as a pejorative
[23:45:47] <huon> so the problem here is mingw rustc's can't cross-compile?
[23:45:56] <Tobba> I think so
[23:46:00] <huon> have you filed a bug?
[23:46:03] <Tobba> I havent had time to mess with it because the builds take an hour
[23:46:19] <Tobba> the problem isnt that mingws rustc cant cross compile
[23:46:25] <Tobba> the makefile cant cross compile on mingw
[23:46:30] <Tobba> or something like that
[23:46:42] <huon> file a bug
[23:46:49] <Tobba> again the builds take an hour and I lost the logs of that due to a ton of AMD driver crashes
[23:46:56] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Ping timeout)
[23:47:02] <Tobba> well I cant file a bug if I dont know why it happens
[23:47:05] <Tobba> I only know "it doesnt work"
[23:47:11] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[23:47:32] <Tobba> (even though thats usually valid 90% of the time and gets you yelled at a lot anyways, this isnt one of those cases)
[23:47:50] <Tobba> I'll mess around with it when I can be arsed to have my machine hammered for an hour building it
[23:48:11] <Tobba> it takes like 3 attempts before it even gets to the failure point too, before that its just makefiles being makefiles
[23:48:13] <o11c> even if you can't provide *much* information, a bug report is still more useful than just complaining
[23:48:20] <Tobba> again
[23:48:25] <Tobba> I'll mess with it later jesus christ
[23:48:30] *** Joins: synackse (jordyd@2D608993.77F880E0.D9401097.IP)
[23:50:25] *** Quits: derek_c (derek@moz-1578B046.cit.cornell.edu) (Ping timeout)
[23:51:24] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:51:45] *** Quits: azakai (alon@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[23:51:46] *** Quits: synackse (jordyd@2D608993.77F880E0.D9401097.IP) (Input/output error)
[23:52:02] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[23:53:37] *** Quits: mye (mye@moz-55C374B9.swh.uni-giessen.de) (Quit: So long, and thanks for all the fish!)
[23:54:17] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Quit: I'm sure it's perfectly safe)
[23:55:10] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:56:37] *** Joins: jgrant (jgrant@55B0B969.8E42373.30200F38.IP)
[23:57:14] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:57:24] *** Quits: jgrant (jgrant@55B0B969.8E42373.30200F38.IP) (Quit: Leaving)
[23:57:25] *** Joins: jgrant (jgrant@55B0B969.8E42373.30200F38.IP)
[23:57:48] *** Quits: jgrant (jgrant@55B0B969.8E42373.30200F38.IP) (Quit: Leaving)
[23:57:48] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Taking a nap.)
[23:58:14] *** Joins: espindola (espindola@moz-35429B8.dsl.teksavvy.com)
[23:59:01] *** Joins: jng27 (jng27@55B0B969.8E42373.30200F38.IP)
[23:59:44] *** Joins: synackse (jordyd@2D608993.77F880E0.D9401097.IP)
