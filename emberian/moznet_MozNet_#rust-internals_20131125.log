[00:00:51] <aatch> I just don't see generators as double-ended things to start with. I mean, it's in the name. They "generate" values.
[00:01:09] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[00:02:16] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[00:02:27] <kimundi> So it boils down to whether having sugar for the non-gnerator use cases is worth it, then. I'd personally say yes, judging by the sheer size and redunancy of any of the std lib iterators impls, but I can also se how one could reach the opposite opinion
[00:02:37] <brson> jdm: lol
[00:03:13] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[00:04:53] <aatch> Also, the standard library isn't actually a good source to draw from when deciding what common code will be like.
[00:05:27] <aatch> Since you're more likely to be using the standard library iterators than implementing your own.
[00:07:13] <kimundi> As far as I can see, there a two use cases: generators that produce values in sequence, and iterators over values of a custom data structure
[00:08:05] <kimundi> If sugar for the first use case can also support the second one with minor modifications, I don'T see why not :P
[00:12:00] <aatch> kimundi, the issue is that it's hard for me to see how any sugar for the second one will feel "natural". Straight `yield expr` makes sense, since it mimics return syntax.
[00:12:42] <kimundi> Yeah, that is a issue
[00:13:26] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[00:14:03] <aatch> And for the second use case, I'm not sure how many cases still support double-ended iteration anyway. Since double-ended iteration only seems useful for ordered collections.
[00:14:10] <aatch> (i.e. vectors)
[00:14:52] <aatch> Or at least, have the suport make sense.
[00:16:24] <aatch> Trees have several different ways of traversing them, and there *is* a defined 'end' based on that traversal, but many tree implementations would require a full traversal to find said end first.
[00:18:01] * jdm wishes he could build a stage1 and install that
[00:18:09] <jdm> but make install makes me do all the stages
[00:18:10] <jdm> so sad
[00:21:32] <brson> jdm: it shouldn't be hard to fix that. I think there's a varibale in install.mk that controls which stage we install from
[00:21:42] <brson> you may just be able to override it on the command line
[00:21:57] <jdm> maybe I could even run the binary from the stage1 build dir
[00:22:35] <aatch> I guess I'd be more supportive of sugar for double-ended iteration if I could think of non-vector datastructure where it makes sense.
[00:23:15] <aatch> Oh, I have one! A DList.
[00:23:17] <strcat> doubly-linked lists, ring buffers
[00:23:33] <strcat> ropes (but you might consider those vectors)
[00:24:03] *** Joins: dbaupp (Thunderbir@29619B56.D5A1DCF.37681C44.IP)
[00:27:36] <aatch> I'm just not convinced that any syntax supporting it would be able to pull it's weight in terms of utility. In our PHP codebase, we only have 1 exposed generator method, and that's doing tree traversal
[00:27:59] <kimundi> Also, more complex operations than just iteration, like strings word_iter or split_ier for example
[00:28:37] *** Quits: jdm (jdm@moz-C9C12F65.dynamic.hinet.net) (Quit: Lost terminal)
[00:28:52] <kimundi> Iterating over subtree patterns maybe?
[00:30:08] <aatch> I'm not against double-ended iteration. I'm against trying to shoehorn support for it into generator syntax.
[00:35:45] <kimundi> Maybe a macro that just scraps off enough redunant syntax around the struct+impl Iterator+impl DoubleEndedIterator tripple would be enough for more complex situations... But I also think shoehorning double ended iteration in the yield fn syntax is possible :P
[00:39:14] <kimundi> We just need a readable way to express the little branches that happen in the control flow that way
[00:46:52] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:46:52] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1467f2c8c to 14b3ff24a: 02http://git.io/N3iJvQ
[00:46:52] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:47:00] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:47:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/qIRYyA
[00:47:00] <ghrust> 13rust/06auto 149a4c8da 15Kiet Tran: Add comments to ast, ast_map, ty, and pat_util
[00:47:00] <ghrust> 13rust/06auto 14861cced 15bors: auto merge of #10600 : ktt3ja/rust/add-doc, r=huonw...
[00:47:00] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:52:27] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[00:53:20] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[00:59:26] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Ping timeout)
[00:59:52] <kimundi> aatch: Would any of these two look less-shoehorny in your eyes? https://gist.github.com/Kimundi/7634654
[01:09:31] *** Joins: hack (chatzilla@moz-611CC244.rev.onenet.an)
[01:12:26] *** Joins: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au)
[01:14:32] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[01:15:32] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[01:20:30] *** kimundi is now known as zz_kimundi
[01:22:07] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[01:25:54] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[01:27:09] *** Joins: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au)
[01:47:47] *** Quits: brson (brson@EDE430AA.CB84766B.D1E74241.IP) (Ping timeout)
[01:52:08] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:52:08] *** ChanServ sets mode: +qo brson brson
[01:56:49] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:56:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qIRYyA
[01:56:49] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:58:33] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[01:59:10] *** Quits: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Connection reset by peer)
[02:02:32] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:02:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/s_5Wbg
[02:02:32] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:07:27] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:07:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/s_5Wbg
[02:07:27] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:07:32] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:07:32] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/T4lS1A
[02:07:32] <ghrust> 13rust/06auto 14c4978f0 15Florian Zeitz: Update unicode.py to reflect language changes
[02:07:32] <ghrust> 13rust/06auto 149f7a195 15Florian Zeitz: Update Unicode data to version 6.3
[02:07:33] <ghrust> 13rust/06auto 14df56533 15bors: auto merge of #10621 : Florob/rust/unicode63, r=cmr...
[02:07:36] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:09:22] <ktt3ja> should this one be pub? https://github.com/mozilla/rust/blob/master/src/libstd/run.rs#L187-L190
[02:13:23] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Ping timeout)
[02:14:04] *** Joins: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com)
[02:17:31] *** Quits: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net) (Quit: Jesse)
[02:19:38] <cmr> r? https://github.com/mozilla/rust/pull/10641
[02:20:40] <klutzy> acrichto: on #10631, is it unsound to use llvm with --disable-pthreads while llvm still uses (win32 native) threads?
[02:20:59] *** Quits: dbaupp (Thunderbir@29619B56.D5A1DCF.37681C44.IP) (Ping timeout)
[02:23:56] *** Joins: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net)
[02:25:31] *** Joins: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[02:25:52] <acrichto> klutzy: I was under the impression that --disable-pthreads turned off all locking inside of LLVM, but if it's still on with the flag then we should be good to go
[02:27:57] <klutzy> acrichto: llvm is configured with ENABLE_THREADS := 1 and HAVE_PTHREAD := 0, so I've presumed it's safe. (don't know if it really is)
[02:28:27] *** Joins: dbaupp (Thunderbir@29619B56.D5A1DCF.37681C44.IP)
[02:29:22] <klutzy> maybe the configuration is mainly used on msvc setting
[02:34:32] *** Quits: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net) (Quit: Jesse)
[02:45:37] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[02:57:32] *** Quits: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP) (Ping timeout)
[03:01:11] *** Joins: tikue_ (tkuehn@7101C711.2ACBBF24.689607DE.IP)
[03:03:13] *** Joins: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP)
[03:04:20] *** Quits: hack (chatzilla@moz-611CC244.rev.onenet.an) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131112160018])
[03:07:16] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:07:46] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:07:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14df56533 to 14861cced: 02http://git.io/N3iJvQ
[03:07:46] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:07:52] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:07:52] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/E15ukQ
[03:07:52] <ghrust> 13rust/06auto 142431ac3 15Luqman Aden: libextra: Remove @mut from term.
[03:07:52] <ghrust> 13rust/06auto 1409eca11 15bors: auto merge of #10637 : luqmana/rust/nmt, r=cmr...
[03:07:53] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:22:45] *** Quits: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP) (Ping timeout)
[03:26:15] *** Quits: zz_kimundi (kimundi@moz-7ED39474.dip0.t-ipconnect.de) (Ping timeout)
[03:26:25] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[03:26:59] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[03:28:26] *** Joins: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP)
[03:29:34] *** Joins: zz_kimundi (kimundi@moz-55BB9741.dip0.t-ipconnect.de)
[03:29:36] *** zz_kimundi is now known as kimundi
[03:32:21] <sfackler> acrichto: I'm planning on fixing the single-item macro expansion issue. the most straightforward solution to me seems like changing fold_item & co to return ~[@ast::item] instead of Option<@ast::item>, but that mandates an allocation for every item visited
[03:32:29] <sfackler> do you think that that'd be an issue?
[03:32:42] <cmr> sfackler: yes, that's going to be an issue.
[03:32:58] <cmr> The ast folder is already slow
[03:33:01] <sfackler> the alternative is to add some kind of anonymous module item that would either get expanded out or is handled speciall in resolve
[03:33:07] <sfackler> that's what I figured
[03:33:28] <cmr> The thinking about that issue iirc was to add some sort of "aggregate" node type.
[03:33:38] <dbaupp> enum HackSmallVec<T> { Zero, One(T), Many(~[T]) }
[03:33:44] <dbaupp> (would also work)
[03:33:51] <sfackler> I was considering that
[03:34:04] <sfackler> but it'd be a huge pain to reimplement all of the vector functionality you'd want
[03:34:15] <dbaupp> not necessarily?
[03:34:36] <dbaupp> I'd think .push and .push_to_vec(&mut ~[T]) would be most of the necessarily functionality?
[03:34:42] <dbaupp> *necessary
[03:34:51] <sfackler> too bad Rust does't have something like SmallVector { start: [T, ..N], rest: Option<~[T]> }
[03:34:56] <sfackler> you'd also want iter
[03:34:58] <sfackler> and move_iter
[03:35:03] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:36:19] <sfackler> cmr: would it be better to add a pass to expand the aggregate type out or have it stick around and be essentially an anoynymous module?
[03:36:31] <cmr> sfackler: dunno
[03:37:00] <cmr> I'd guess the first
[03:37:28] <dbaupp> (fwiw, I'd think that the smallvec solution would be easier than creating a whole new AST node.)
[03:38:08] <dbaupp> (and, when we get realy SmallVectors, it'll become sane.)
[03:38:13] <sfackler> yeah, could be
[03:38:20] <dbaupp> *real
[03:38:59] <cmr> it's hacky, but it should work. the only place that it should really effect is the folder, and anything constructing AST
[03:39:00] <sfackler> are types parameterized by an integer on the radar? or does that end up leading to turing complete horror like C++?
[03:39:46] <dbaupp> sfackler: depends how they're implemented
[03:40:42] <dbaupp> even just having enough power to write `impl<T, n: uint> Trait for [T, .. n]`, and disallow addition/comparison etc in types, would be nice.
[03:40:58] <sfackler> yeah
[03:41:03] <sfackler> that's all this would need
[03:42:05] <sfackler> is there any reason to not allow multi-statement macros along with multi-item macros?
[03:42:18] <dbaupp> no
[03:51:40] <cmr> rusti: /* foo **/
[03:51:40] -rusti- ()
[03:51:51] <sfackler> man, Index is not a great trait :(
[03:52:15] <cmr> Is it possible to express nested comments with EBNF?
[03:52:24] <cmr> (Updating the manual)
[03:53:20] <aatch> cmr, sure, just do it the same way you express all the other nested constructs.
[03:53:34] <cmr> aatch: I've never done such a thing
[03:53:50] <sfackler> cmr: something like "comment = /* (comment | text)+ */"?
[03:54:02] <aatch> what sfackler said
[03:54:04] <cmr> Ah, duh
[03:54:39] <aatch> it's just notation, so as long as it fairly clearly expresses intent, you should be fine.
[03:55:09] <dbaupp> sfackler: https://github.com/mozilla/rust/issues/6515
[03:55:11] * cmr hates pseudocode
[04:16:04] <cmr> Who was it that made the joke about rust devs having multiple source trees instead of goofing off while compiling?
[04:16:10] * cmr just made another workdir
[04:16:53] <cmr> ~/hacking/rust{,2,3} :P
[04:17:00] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:17:01] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/E15ukQ
[04:17:01] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:19:20] <klutzy> I have 6 rust repos on windows :p
[04:19:34] <klutzy> 3 on linux
[04:22:07] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:22:07] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/2h0Iuw
[04:22:07] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:22:11] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[04:22:12] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/6CsQ_w
[04:22:12] <ghrust> 13rust/06auto 14525878f 15Jannis Harder: std::trie: Fix find_mut for non-present keys...
[04:22:12] <ghrust> 13rust/06auto 14ca32743 15bors: auto merge of #10639 : jix/rust/fix_find_mut_in_trie, r=thestinger...
[04:22:12] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[04:26:36] *** Joins: jdm (jdm@579FEC0E.387F1B30.1A7D5C28.IP)
[04:26:36] <cmr> r? https://github.com/mozilla/rust/pull/10642
[04:34:01] <cmr> r? https://github.com/mozilla/rust/pull/10644
[04:34:22] *** Joins: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net)
[04:37:28] * cmr goes to bed
[05:04:51] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[05:08:44] *** Quits: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net) (Quit: Jesse)
[05:15:02] *** Joins: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net)
[05:26:55] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:26:55] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/6CsQ_w
[05:26:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:30:35] <acrichto> Luqman:  re 10645 I'm glad I added that assertion!
[05:31:51] <Luqman> acrichto: any idea what's tripping it up?
[05:32:01] <klutzy> Luqman: is the error only on windows?
[05:32:17] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:32:17] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/O0BDXg
[05:32:17] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[05:32:19] <acrichto> Luqman: running gdb as we speak
[05:32:22] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:32:22] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ArL64w
[05:32:22] <ghrust> 13rust/06auto 14acca9e3 15Alex Crichton: Remove linked failure from the runtime...
[05:32:22] <ghrust> 13rust/06auto 142cc1e16 15bors: auto merge of #10603 : alexcrichton/rust/no-linked-failure, r=brson...
[05:32:22] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:32:31] <klutzy> seems to work on linux
[05:32:41] <Luqman> klutzy: yep, i first ran into it with some other code that worked fine to me on linux and os x
[05:32:48] <Luqman> for me*
[05:33:31] <klutzy> uhh, I'm constantly typing rustc.exe on linux :(
[05:34:14] <Luqman> haha, i'm doing the opposite on windows :P
[05:34:25] <eddyb> rustc should work on windows :/
[05:34:37] <acrichto> rusti 0x2000
[05:34:41] <acrichto> rusti: 0x2000
[05:34:42] -rusti- 8192
[05:34:46] <klutzy> eddyb: on windows there are rustc.exe and rustc/ directory
[05:34:52] <eddyb> klutzy: ouch
[05:40:26] <acrichto> Luqman: so in gdb it segfaults trying to dereference the address 0xbadf00d
[05:40:33] <acrichto> 0xbaadf00d*
[05:41:51] <acrichto> Luqman: oh dear this is real bad, valgrind on windows would have caught this instantaneously
[05:42:37] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[05:43:38] <Luqman> gdb tells me it fails at: mov 0x8(%eax), %edx where eax is -1163005939 
[05:44:28] <acrichto> ah, fixed it
[05:45:13] <eddyb> not as good as 0xb00b1e55
[05:50:43] <acrichto> Luqman: https://github.com/mozilla/rust/pull/10646
[05:52:14] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[05:52:36] <Luqman> acrichto: awesome turn around time!
[05:52:45] <acrichto> haha
[05:52:56] <acrichto> working on a train is becoming my specialty
[05:53:40] <Luqman> haha, i actually crafted together the code in the issue on the train
[05:55:06] <dbaupp> acrichto: you've trained yourself to do it well?
[05:56:16] <acrichto> dbaupp: while respectable, I can escort you out now
[05:57:29] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[05:58:00] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:58:00] *** ChanServ sets mode: +qo brson brson
[05:58:11] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[05:58:20] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[05:58:27] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[05:58:27] *** ChanServ sets mode: +qo brson brson
[06:01:24] <jdm> who knows where the __morestack prelude is generated?
[06:01:43] <jdm> since I can't find that string in the compiler
[06:01:54] *** Joins: brson_ (brson@moz-BBE3ABD.mv.mozilla.com)
[06:02:24] <acrichto> jdm: llvm generates it
[06:02:44] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Ping timeout)
[06:02:57] <jdm> acrichto: any idea when?
[06:03:13] * jdm is trying to figure out if there's source lines associated with it
[06:03:17] <acrichto> jdm: during codegen, it's done at the last possible minute during frame lowering
[06:03:49] <acrichto> jdm: grep for adjustForSegmentedStacks
[06:03:51] <jdm> acrichto: would you expect to see it in the LLVMIR?
[06:04:10] <acrichto> jdm: no, it's not in the IR, it's a global compile option which only affects codegen
[06:04:31] <acrichto> I think it's not in the IR b/c you want to make sure it's incredibly efficient
[06:04:39] <acrichto> also the call to __morestack doesn't follow normal calling conventions I think
[06:04:46] <jdm> feh
[06:04:56] <klutzy> jdm: https://github.com/mozilla/rust/blob/e12bc239b4e85d0dedc5ba6e9f7ffa0b91ade634/src/librustc/lib/llvm.rs#L1698
[06:04:59] <klutzy> EnableSegstk: bool,
[06:05:02] <jdm> our IR is very similar to clang's output in terms of debug metadata
[06:05:13] <jdm> but we stop on the first instruction of the prelude for every function when stepping
[06:16:44] *** Quits: dbaupp (Thunderbir@29619B56.D5A1DCF.37681C44.IP) (Ping timeout)
[06:27:04] <eddyb> oi, this is bad: expansion adds 200MBs which aren't freed
[06:30:17] <jdm> grr, we're even marking the end of the preludes right in the DWARF information
[06:33:42] *** Quits: Jesse (jruderman@moz-2ECEC9F7.oc.oc.cox.net) (Connection reset by peer)
[06:35:37] * jdm gives up and drowns his sorrows in sushi
[06:35:49] *** Quits: jdm (jdm@579FEC0E.387F1B30.1A7D5C28.IP) (Quit: Lost terminal)
[06:42:04] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:42:04] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ArL64w
[06:42:04] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:47:11] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[06:47:11] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/prk3aA
[06:47:11] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[06:47:18] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:47:19] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/67BC6A
[06:47:19] <ghrust> 13rust/06auto 149fe8fc8 15Alex Crichton: Cache a task's stderr logger...
[06:47:19] <ghrust> 13rust/06auto 1407ad0cc 15bors: auto merge of #10635 : alexcrichton/rust/issue-10626, r=cmr...
[06:47:19] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:53:45] <eddyb> cmr: woooooo it compiled :D
[06:54:03] <eddyb> 5 seconds in borrowck but no significant memory usage there
[06:54:18] <eddyb> time: 10.314 s	resolution << that, however, uses over 500MB
[06:54:46] <eddyb> time: 80.692 s	type checking << and the memory usage peak is there, at 1.6GB total
[07:06:06] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[07:06:27] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:09:45] <eddyb> time: 2.419 s	privacy checking << eeeeh, pretty sure that's unnecessarily slow
[07:12:49] <ktt3ja> how do you get those time?
[07:13:05] <eddyb> -Z time-passes
[07:13:06] <ktt3ja> (asking for learning sake)
[07:13:34] <ktt3ja> what would a full command look like?
[07:16:14] <eddyb> rustc file.rs -Z time-passes
[07:16:33] <ktt3ja> thanks
[07:16:57] <eddyb> although I'm running it with a gdb mmap/mremap tracking script, so I can also see a rough estimate of the memory usage
[07:19:14] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[07:19:48] *** Joins: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net)
[07:22:48] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[07:30:31] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[07:31:32] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[07:31:33] *** Quits: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:31:57] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[07:45:36] *** Joins: ssbr (devin@moz-8EC4F450.lightspeed.sntcca.sbcglobal.net)
[07:46:57] *** Joins: teratorn (teratorn@moz-5363C32C.teratorn.org)
[07:47:00] <klutzy> I initially tried to fix ICE from `rustc --linker=` since it seemed easy
[07:47:18] <klutzy> but I realized I had to change std::run api
[07:47:34] <klutzy> I changed it, then I have to change other codes using it :p
[07:51:49] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[07:51:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/67BC6A
[07:51:49] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[07:55:12] <dbaupp> does anyone know how `--pretty normal` works?
[07:56:47] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:56:47] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/OglidQ
[07:56:47] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:01:39] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[08:02:16] *** flaper87|afk is now known as flaper87
[08:03:00] *** Quits: brson_ (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[08:06:30] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[08:06:30] *** ChanServ sets mode: +qo brson brson
[08:34:31] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:07:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:07:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ctk1oQ
[09:07:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:12:38] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:12:38] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/aMdsng
[09:12:38] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:31:39] *** Quits: Kxepal (Miranda@moz-88CB069F.pppoe.mtu-net.ru) (Ping timeout)
[09:34:31] *** Joins: Kxepal (Miranda@moz-AF2D243E.pppoe.mtu-net.ru)
[09:37:03] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:44:49] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[10:21:58] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:21:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/1Y5n2w
[10:21:58] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:27:03] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[10:27:03] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qlvg9w
[10:27:03] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[10:27:11] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[10:27:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/uKhHDw
[10:27:11] <ghrust> 13rust/06auto 14a7c1a4a 15Jason Orendorff: Fix spelling of "vacuum" in one of the abort quotes.
[10:27:11] <ghrust> 13rust/06auto 144043951 15bors: auto merge of #10643 : jorendorff/rust/master, r=alexcrichton
[10:27:11] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[10:51:44] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Quit: leaving)
[11:09:37] *** flaper87 is now known as flaper87|afk
[11:10:35] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[11:11:10] *** flaper87|afk is now known as flaper87
[11:37:44] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:37:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/uKhHDw
[11:37:44] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[11:42:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[11:42:40] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/4E7kfA
[11:42:40] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[11:42:49] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[11:42:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/HBS3sA
[11:42:49] <ghrust> 13rust/06auto 146fbe2a0 15Corey Richardson: rustdoc: pass through --cfg to rustc...
[11:42:49] <ghrust> 13rust/06auto 141746c02 15bors: auto merge of #10644 : cmr/rust/rustdoc_cfg, r=alexcrichton...
[11:42:49] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:02:04] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[12:06:00] *** Joins: quvarxa_ (chatzilla@moz-978E4C31.static.tpgi.com.au)
[12:06:11] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[12:06:11] *** quvarxa_ is now known as quvarxa
[12:07:20] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[12:20:05] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:20:05] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131118212339])
[12:57:05] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[12:57:05] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/HBS3sA
[12:57:05] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:03:12] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[13:03:12] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/9L14WQ
[13:03:12] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[13:16:59] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[13:17:36] *** Quits: tikue_ (tkuehn@7101C711.2ACBBF24.689607DE.IP) (Quit: tikue_)
[13:46:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:46:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d7e2208 to 141746c02: 02http://git.io/N3iJvQ
[13:46:39] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:46:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:46:40] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ugKaDw
[13:46:40] <ghrust> 13rust/06auto 146acf227 15Alex Crichton: Set uv's custom data before uv_read_start...
[13:46:40] <ghrust> 13rust/06auto 14fffacb3 15bors: auto merge of #10646 : alexcrichton/rust/issue-10645, r=luqmana...
[13:46:40] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:30:14] <nmatsakis> pnkfelix: ping
[14:30:19] <pnkfelix> nmatsakis: pong
[14:32:48] <eddyb> I can't do this :(
[14:32:50] <eddyb> echo 'extern mod rustc; fn main() {println!("{}", ::std::mem::size_of::<rustc::middle::ty::t_box>());}' | ~/Projects/rust/x*/stage1/bin/rustc -
[14:33:11] <eddyb> well, I want t_box_ - the problem is it tries to link against librustc.so
[14:33:36] <cmr> uh... how is that a problem? that's exactly what 'extern mod' does
[14:33:46] <eddyb> even when I link the libraries into the right directory, it still has a lot of missing symbols
[14:34:01] *** kimundi is now known as zz_kimundi
[14:34:07] <eddyb> about a hundred of these: /home/eddy/Projects/rust/x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib/librustc-8581899a03b03e-0.9-pre.so: undefined reference to `task::spawn::Drop$Taskgroup::drop::h8de9b84af5bc7d4mgaR::v0.9$x2dpre'
[14:51:42] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:51:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ugKaDw
[14:51:42] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:52:07] <eddyb> cmr: I just wanted to check the size of structure :(
[14:56:41] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:56:41] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/iJmT-Q
[14:56:41] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:56:50] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:56:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/GYxyMA
[14:56:50] <ghrust> 13rust/06auto 1498f47aa 15Steven Fackler: Fix typo in base64 test...
[14:56:50] <ghrust> 13rust/06auto 14f1bec46 15bors: auto merge of #10648 : sfackler/rust/base64-test, r=alexcrichton...
[14:56:50] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[15:00:47] <pnkfelix> nmatsakis: Soâ€¦ we already have different paths for how we allocate ~[T] depending on whether T contains_managed or not.
[15:01:16] <pnkfelix> nmatsakis: How sad might you be if I did something similar on ~T (and ~[T]) depending on whether T: Send ?
[15:04:02] <pnkfelix> nmatsakis: (My motivation is to maintain metadata to allow conservative scanning of ~T and ~[T]'s that could contain borrowed ptrs to @shared dataâ€¦)
[15:05:26] <pnkfelix> nmatsakis: (Which we cannot do, and probably do not want to do, across the board, since ~T and ~[T]'s that are :Send could be freed on a different task, which would at best gravely complicate maintaining such metadata)
[15:05:53] <nmatsakis> pnkfelix: that thought makes me quite sad? 
[15:06:04] <nmatsakis> pnkfelix: I'm not sure I fully understand tho
[15:06:15] <pnkfelix> nmatsakis: the desire to maintain metadata for conservative scanning of ~T and ~[T]'s ?
[15:06:27] <pnkfelix> nmatsakis: Sorry there were many thoughts in the above, where did you start feeling sad ?
[15:06:40] <nmatsakis> pnkfelix: the thought of having / preserving different alloc paths mostly
[15:06:46] <pnkfelix> nmatsakis: oh, maybe it was right where I sad "How sad might you be..."
[15:06:58] <pnkfelix> s/I sad/I said/
[15:07:02] <nmatsakis> pnkfelix: but I want to understand what the metadata is, what the cost of preserving it is, etc. Can we just always maintain it?
[15:07:17] <pnkfelix> nmatsakis: So, the problem is this:
[15:07:32] <pnkfelix> nmatsakis: Even if I resort to conservative stack scanning for the short term
[15:07:44] <pnkfelix> nmatsakis: one can put borrowed ptrs into ~T objects
[15:08:00] <pnkfelix> nmatsakis: â€¦ ugh, sorry, ~T memory.  (I'll try to avoid saying "objects")
[15:08:56] <pnkfelix> nmatsakis: and right now, global_heap::extract_malloc is just a thin wrapper around malloc_raw
[15:09:18] <pnkfelix> nmatsakis: So if one wants to find borrowed ptrs that have been stashed in ~T memory
[15:09:34] <pnkfelix> nmatsakis: (namely borrowed ptrs into @shared heap that have been stashed in ~T memory)
[15:09:34] <nmatsakis> pnkfelix: I think "object", while overloaded, is still the standard term for a malloc allocation :)
[15:10:04] <nmatsakis> pnkfelix: yes yes I follow. I think I am just grumpy at the thought of conservative stack scanning even.
[15:10:14] <pnkfelix> nmatsakis: nonetheless, Trait objects may open up their own ball of worms, so I want to avoid addressing them for now
[15:10:28] <nmatsakis> pnkfelix: because they are opaque?
[15:10:47] <nmatsakis> pnkfelix: we do stash the type descriptor in there, so we have access to the precise type at runtime...
[15:10:50] <pnkfelix> nmatsakis: because I don't yet know enough about their representation to know how to scan them, yes
[15:11:07] *** zz_kimundi is now known as kimundi
[15:11:07] <pnkfelix> nmatsakis: But yes, trait objects are probably easy.  Lets not get distracted by them.
[15:11:24] <pnkfelix> nmatsakis: So, I understand being grumpy at conservative stack scanning
[15:11:38] <pnkfelix> nmatsakis: but I'll be even more unhappy if we cannot ever implement it
[15:11:52] <pnkfelix> nmatsakis: because when we need to debug precise stack scanning
[15:11:55] <nmatsakis> pnkfelix: what I want to understand is: conservative stack scanning, a means to an end? or the end
[15:12:03] <pnkfelix> nmatsakis:  it will be very helpful to be able to switch over to conservative stack scannnig
[15:12:18] <pnkfelix> nmatsakis: (if we can trust it to actually be a conservative solution)
[15:12:21] <nmatsakis> pnkfelix: so are these headers you're thinking of going to be inline with the alloc or out-of-line?
[15:12:28] <pnkfelix> nmatsakis: I haven't decided yet
[15:12:35] <pnkfelix> nmatsakis: Either is an option, I think
[15:13:01] <pnkfelix> nmatsakis: I mean, no matter what, I'll have to deal with interior pointers into ~T memory
[15:13:25] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:13:29] <pnkfelix> nmatsakis: which means there's going to need to be some out-of-line metadata (or some other out-of-band invariant, e.g. BIBOP allocation)
[15:13:46] <pnkfelix> nmatsakis: So my current thinking is that I would put the metadata out-of-line
[15:13:53] <pnkfelix> nmatsakis: just to get something in there now
[15:13:54] <nmatsakis> pnkfelix: BIBOP?
[15:14:00] <pnkfelix> nmatsakis: Big Bag of Pages
[15:14:21] <nmatsakis> pnkfelix: "BI" = Big?? silly acronym. ok :)
[15:14:23] <pnkfelix> nmatsakis: Its a way of using the address space to categorize your memory
[15:14:30] <nmatsakis> pnkfelix: I can imagine
[15:14:51] <pnkfelix> nmatsakis: I didn't pick it out: http://www.memorymanagement.org/glossary/b.html#bibop
[15:14:54] <nmatsakis> pnkfelix: so how much work do you think it'd be to just maintain that metadata for all ~T allocations?
[15:15:10] <pnkfelix> nmatsakis: the problem is that if I maintain it for all ~T allocations
[15:15:17] <pnkfelix> nmatsakis: then it becomes global cross-task state to maintain
[15:15:22] <nmatsakis> I see
[15:15:29] <pnkfelix> nmatsakis: and it would be pointless
[15:15:34] <nmatsakis> pnkfelix: ok, I see where the `Send` idea came from :")
[15:15:46] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[15:15:47] <pnkfelix> nmatsakis: because, IIUC, if ~T is Send, then it cannot have borrowed nor shared ptrs
[15:16:04] <pnkfelix> nmatsakis: so there's sort of a lucky two-birds-one-stone thing here
[15:16:32] <nmatsakis> pnkfelix: yes right. though I'd say it's no coincidence.
[15:16:49] <pnkfelix> nmatsakis: yeah.  Luck had nothing to do with this brilliance.
[15:16:59] <nmatsakis> pnkfelix: brilliance I don't know
[15:17:08] <pnkfelix> nmatsakis: Maybe I should have written "brillants"
[15:17:16] <nmatsakis> pnkfelix: anyway, so basically there'd be metadata to maintain for non-Send allocations
[15:18:10] <nmatsakis> pnkfelix: seems not unreasonable. 
[15:18:22] <nmatsakis> pnkfelix: 
[15:18:44] <pnkfelix> nmatsakis: Okay.  There is a funny issue about whether it would end up burning us to continue using malloc() for the ~T
[15:19:07] <pnkfelix> nmatsakis: since a user-call to free() would appear to work.  Until the GC gets misled by the metadata.
[15:19:57] <pnkfelix> nmatsakis: but I don't know if we actually advertise compatbility with malloc/free on these puppies.
[15:20:21] <nmatsakis> pnkfelix: yeah I am aware of that complication. it's one of the reasons I get grumpy.
[15:20:45] <nmatsakis> pnkfelix: I at least don't consider the allocator we use for ~ to be specified
[15:21:10] <pnkfelix> nmatsakis: yeah it would probably be a big no-no to try to take advantage of the current implementation.
[15:21:27] <nmatsakis> pnkfelix: particularly if support for user-defined pointers becomes readily available
[15:21:32] <nmatsakis> pnkfelix: since people could do Malloc<T> or something
[15:22:09] <eddyb> why can't I just link against librustc :(?
[15:33:19] <eddyb> cmr: my stage1 libsyntax and librustc are newer than everything else o_O
[15:33:22] <eddyb> *confused*
[15:34:46] <eddyb> ahh, x86_64-unknown-linux-gnu/stage1/lib/ is really different than x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib
[15:35:51] <eddyb> cmr: lol, I've had to use stage0 rustc instead
[15:37:29] <eddyb> t_box_ is 168 bytes on x86_64, that's a lot
[15:42:48] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[15:42:52] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:44:04] <eddyb> Region is too big https://github.com/mozilla/rust/blob/master/src/librustc/middle/ty.rs#L477-L510 (72 bytes) to be used in vstore https://github.com/mozilla/rust/blob/master/src/librustc/middle/ty.rs#L144
[15:47:52] <pnkfelix> nmatsakis: ping
[15:48:41] <nmatsakis> pnkfelix: pong
[15:49:23] <pnkfelix> in `impl TypeContents` (in librustc/middle/ty.rs), why do the methods `is_sendable`/`is_static`/etc all take an unused ctxt argument
[15:49:26] *** Joins: hack (chatzilla@moz-611CC244.rev.onenet.an)
[15:49:33] <eddyb> but the biggest variant is:     ty_trait(DefId, substs, TraitStore, ast::Mutability, BuiltinBounds),
[15:49:50] <pnkfelix> nmatsakis: is that for some future refactoring?  Or is it an artifact from the past?
[15:50:01] <hack> hello mozillians! or shall I say rustzillians :)
[15:51:16] <hack> I would like to take a look of the dead fuzzer (which was part of an old version, 0.2 maybe?) can anyone guide me on how can I obtain it?
[15:53:03] <eddyb> (ty::substs, ty::TraitStore) is really large, 112 bytes
[15:55:15] <nmatsakis> pnkfelix: artifact of the past
[15:55:28] <nmatsakis> pnkfelix: used to be that vectors/strings were implicitly copyable iff the crate had an annotation
[15:55:57] <eddyb> I can't see why Region can be that big. alignment *everywhere* + uint being 8 bytes, maybe?
[15:56:39] <nmatsakis> pnkfelix: those were dark days
[15:56:53] <pnkfelix> nmatsakis: okay, so I won't worry about removing them.  thx.
[15:57:44] <eddyb> are we getting non-aligned enums any time soon?
[15:59:32] <eddyb> I'm counting 8 fields, where's the 9th?
[16:01:02] *** kimundi is now known as zz_kimundi
[16:01:28] <eddyb> 8 or 7. either I can't count, or it's that bad
[16:01:55] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[16:01:55] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GYxyMA
[16:01:55] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[16:02:44] <eddyb> dbaupp: were you suggesting u32 NodeIds? that would halve the size of some structures
[16:03:38] <eddyb> aaah, DefId is two words :(
[16:05:02] <eddyb> what's good about supporting 2^64-1 crates when I can barely build my single one?
[16:05:40] <eddyb> DefId is 16 bytes when it could be 4-5
[16:06:44] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:06:44] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qRxnZA
[16:06:44] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:06:49] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[16:06:49] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/aaY6EA
[16:06:49] <ghrust> 13rust/06auto 14ce44094 15Niko Matsakis: Add [mut_]shift_ref/[mut_]pop_ref functions, which return a pointer to the first/last item in the slice and modify the slice to exclude the returned item. Useful when writing iterators over mutable references.
[16:06:50] <ghrust> 13rust/06auto 14c830546 15Niko Matsakis: Modify iterators to make them safe with the new rules.
[16:06:52] <ghrust> 13rust/06auto 14f26768c 15Niko Matsakis: Test that reborrowing contents of an `&'a mut &'b mut` pointer can only...
[16:06:54] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[16:51:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[16:51:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1499ee5d2 to 14f1bec46: 02http://git.io/N3iJvQ
[16:51:39] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[16:51:50] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[16:51:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/UJa8_g
[16:51:50] <ghrust> 13rust/06auto 1420233b9 15Andreas Ots: std: IPv6 addresses are represented as eight groups of four HEXADECIMAL digits
[16:51:50] <ghrust> 13rust/06auto 14b938e9c 15bors: auto merge of #10650 : andreasots/rust/ipv6-is-in-hex, r=alexcrichton...
[16:51:50] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[16:53:29] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: leaving)
[16:55:27] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:00:49] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[17:13:01] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:18:01] <eddyb> why is id_range working on (signed) int::min/max?
[17:19:40] <eddyb> I hope I don't break it by moving to unsigned
[17:27:55] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[17:31:50] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:31:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/fePAJg
[17:31:50] <ghrust> 13rust/06auto 148624d5b 15Jed Davis: Represent C-like enums with a plain LLVM integer, not a struct....
[17:31:50] <ghrust> 13rust/06auto 144d5f8df 15bors: auto merge of #10652 : jld/rust/enum-unstruct, r=thestinger...
[17:31:51] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:35:54] <jack> how do I run a single run-pass test?
[17:36:57] *** zz_kimundi is now known as kimundi
[17:38:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[17:52:56] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[17:56:52] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[18:00:55] *** Quits: hack (chatzilla@moz-611CC244.rev.onenet.an) (Ping timeout)
[18:02:23] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[18:03:30] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[18:06:14] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[18:06:15] *** ChanServ sets mode: +o tjc
[18:10:50] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[18:11:03] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[18:16:43] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[18:16:43] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144d5f8df to 14f1bec46: 02http://git.io/N3iJvQ
[18:16:43] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[18:16:52] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[18:16:53] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/RI2L_w
[18:16:53] <ghrust> 13rust/06auto 1407e21c3 15Daniel Micay: rm #[mutable_doc]
[18:16:53] <ghrust> 13rust/06auto 14679a2c0 15bors: auto merge of #10653 : thestinger/rust/meaningless, r=huonw
[18:16:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[18:18:24] <cmr> What did mutable_doc even do?
[18:18:55] <strcat> nothing
[18:19:07] <strcat> it was added by accident somehow
[18:31:48] <jld> jack: `make check-stageN-pass TESTNAME=name-of-test` is one way.
[18:32:18] <jld> jack: Compiling and running the test manually also works.  I think the test runner will print out the commands if VERBOSE=1 is set.
[18:32:39] <cmr> run-pass are run with compiletest, sono.
[18:34:28] <jld> Looks like tests.mk checks $VERBOSE and adds --verbose to the compiletest args, and that does... stuff.
[18:38:24] *** Joins: hack (chatzilla@moz-611CC244.rev.onenet.an)
[18:40:38] *** Quits: hack (chatzilla@moz-611CC244.rev.onenet.an) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131112160018])
[18:49:51] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[18:52:29] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[18:52:29] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:03:20] <jack> jld: looks like check-stage1-cfail TESTNAME=foo
[19:03:22] <jack> thanks though :)
[19:14:50] <jack> I want to make pkgid attributes required to be unique. What's the best way to do that?
[19:15:49] <eddyb> cmr: pffft... how do I compile something against stage1 librustc.so, with only stage0 and stage1 built?
[19:15:53] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:15:56] <tjc> jack: unique globally?
[19:16:15] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[19:16:17] <cmr> eddyb: compile it with the stage1 rustc?
[19:16:51] <eddyb> cmr: let me try again, after a fresh rebuild. last time stage1 rustc wasn't seeing stage1 librustc.so
[19:17:33] <jack> tjc: unique in the crate
[19:17:50] <tjc> jack: you mean unique among the crate as well as all of its dependencies?
[19:17:51] <jack> ie, #[pkgid="foo"]; #[pkgid="bar"]; would be an error
[19:17:55] <tjc> oh, I see
[19:17:56] <tjc> that's easier
[19:18:15] <jack> we enforced uniqueness of link.name, but we're getting rid of that.
[19:18:28] <tjc> isn't there already code that does that for the linkage attributes, and it would just be a matter of changing it to apply to the new pkgid attribute instead?
[19:18:35] <jack> i don't quite understand if linkage metadata exists in the dylib/so/dll etc
[19:18:38] <tjc> like, I assume that already, you can't have link(name="foo") and then link(name="bar")
[19:18:42] <tjc> yes, it does exist there
[19:18:44] <jack> i mean, readable by non-rust things
[19:18:54] <tjc> oh, hmm
[19:18:55] <tjc> that, I don't know
[19:19:31] <jack> so the name="foo" name="bar" issue is in find_library_crate in loader
[19:19:48] <jack> but it seems to have hte linkage metas already, so i guess they must exist somewhere?
[19:20:03] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[19:20:26] <eddyb> cmr: there is a x86_64-unknown-linux-gnu/stage1/lib/librustc.so, but no libsyntax/librustc in x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib/
[19:20:56] <eddyb> cmr: previous attempts to symlink the libraries there were met with ICEs
[19:21:45] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:21:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/RI2L_w
[19:21:45] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:22:10] <eddyb> cmr: stage0 has librustc in the longer directory, that's what I used to test the "vanilla" sizes
[19:24:07] <nmatsakis> anybody have any clue what this could mean? make: *** [doc/std/index.html] Error 5
[19:24:10] <nmatsakis> occurs building windows
[19:24:14] <nmatsakis> er, building on windows
[19:24:15] <nmatsakis> http://buildbot.rust-lang.org/builders/auto-win-32-nopt-t/builds/1730/steps/compile/logs/stdio
[19:24:23] <eddyb> cmr: hmm, no, the symlink results in link failure, something doesn't match up.. and I don't want to build stage2 to find out :(
[19:25:31] <eddyb> I might have to, though
[19:26:45] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:26:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/LDkWiA
[19:26:45] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:26:53] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:26:53] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/gNyn9w
[19:26:53] <ghrust> 13rust/06auto 145005483 15klutzy: std::run: Use Result instead of condition...
[19:26:53] <ghrust> 13rust/06auto 14d8e3f49 15bors: auto merge of #10654 : klutzy/rust/run, r=pcwalton...
[19:26:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:28:43] <cmr> nmatsakis: hm, seems rustdoc is failing for some reason.
[19:28:53] <cmr> nmatsakis: is this the first time you've seen this failure?
[19:29:44] <eddyb> /home/eddy/Projects/rust/src/librustc/middle/astencode.rs:164:12: 164:20 error: comparison is useless due to type limits, #[deny(type_limits)] on by default
[19:30:01] <eddyb> oh common.... why does stage2 have to be strict?
[19:30:02] <jack> so resolve_crate runs as part of compilation?
[19:31:07] <nmatsakis> cmr: first time i've seen it, I was wondering if others had seen it before
[19:31:38] <nmatsakis> cmr: however, I've not run a full build locally with all the nits, so let me see if it reproduces here
[19:32:05] <cmr> nmatsakis: I haven't seen it, but I changed rustdoc recently, but a bunch of PRs have landed since then..
[19:32:14] <eddyb> no idea if making NodeId unsigned is a good idea or not *fuck it*
[19:34:47] <nmatsakis> eddyb: good idea is to make NodeId a newtype. unsigned is prob better but not importantly so.
[19:36:13] <eddyb> I used u32 instead of i32, was a bit arbitrary. it might screw up anything in metadata that uses type inference for (de)serialization
[19:38:47] <eddyb> I so hope this makes a difference ^_^
[19:40:35] <eddyb> compile_and_link: x86_64-unknown-linux-gnu/stage0/lib/rustc/x86_64-unknown-linux-gnu/bin/rustc
[19:41:01] <eddyb> so is that stage1 rustc? rustc/x86_64-unknown-linux-gnu/ being some kind of output dir?
[19:41:20] * eddyb is trying to not be confused
[19:41:39] *** Joins: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net)
[19:42:13] <eddyb> rusti: ::std::sys::size_of::<(u32, u32, u32, u32)>()
[19:42:14] -rusti- 16u
[19:43:02] <eddyb> rusti: ::std::sys::size_of::<Option<(u32, u32, u32, u32)>>()
[19:43:02] -rusti- 24u
[19:43:22] <eddyb> ^ is that BS fixed yet?
[19:43:32] <cmr> What BS?
[19:43:50] <cmr> Oh
[19:43:52] <cmr> Yes
[19:43:55] <cmr> jld: <3
[19:43:55] <eddyb> I remember a PR about enum discriminants, or was it an issue?
[19:44:03] <cmr> it was a pr
[19:44:56] <sfackler> it's still 24 for me there
[19:45:01] <sfackler> on top of master
[19:45:26] <sfackler> wait, I have a really old version of master here c.c
[19:45:33] <sfackler> nvm
[19:46:16] <jld> rusti: version
[19:46:17] -rusti- "rustc 0.8"
[19:46:24] <cmr> it's 20 here, as it should be.
[19:46:46] <eddyb> it's not going to stop growing, is it?
[19:46:55] <cmr> hm?
[19:46:59] <eddyb> I have failed, no obvious memory reduction :(
[19:47:53] <eddyb> I will try compiling my own testcase, which peaks higher than rustc (1.6GB - spends a lot of time in typeck)
[19:54:04] <Luqman> eddyb: so the way the 2 sets of libraries work is: $PREFIX/lib/lib{std,extra,syntax,rust*} are what rustc itself is linked against. While $PREFIX/lib/rustc/$TARGET/lib/lib{...} is what the binary you compiled will be linked against
[19:54:32] <Luqman> try ldd `which rustc` and ldd foo  (where foo is something outputted by rustc)
[19:55:42] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Connection reset by peer)
[19:55:56] <eddyb> Luqman: and they chain from one stage to the other, I guess
[19:56:30] <eddyb> s/other/next
[19:56:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:56:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d8e3f49 to 14679a2c0: 02http://git.io/N3iJvQ
[19:56:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:56:50] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:56:50] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/AjjOQA
[19:56:50] <ghrust> 13rust/06auto 14cd7a9b7 15Seo Sanghyeon: Remove arms_have_move_bindings
[19:56:50] <ghrust> 13rust/06auto 14eb5cbfe 15Seo Sanghyeon: Take &Pat
[19:56:50] <ghrust> 13rust/06auto 149028330 15Seo Sanghyeon: Take &Pat in visit_pat
[19:56:51] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:57:36] <eddyb> this is bad, the size of t_box_ hasn't changed
[19:57:53] <Luqman> eddyb: right so roughly, cp stageN/lib/rustc/lib/$TARGET/lib/* stage(N+1)/lib/*
[20:00:00] *** Joins: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP)
[20:00:25] <eddyb> stage0 rustc compiling against librustc has my changes
[20:00:52] <eddyb> hah, didn't need to build stage2 at all
[20:01:04] <Luqman> stage0 comes with just enough to run itself
[20:01:08] <Luqman> i.e. no target libs
[20:01:25] <Luqman> it then builds those target libs as part of the build process
[20:01:38] <eddyb> Luqman: yeah, it's just confusing at first to see which is using what
[20:01:48] <eddyb> but how is t_box_ unchanged when ast::DefId is halved?
[20:02:48] <Luqman> did you change the t_box_ struct?
[20:03:21] <eddyb> nvm, I was confused because I was comparing with stage0 which happened to include my changes. t_box_ is down by 16 bytes
[20:03:30] <eddyb> that's too little, though, was expecting more
[20:04:34] <Luqman> t_box_ is a struct with 2 uints & an sty
[20:04:43] <eddyb> sty is huge, though
[20:05:56] <Luqman> sty will be something like the size of the largest variant + discriminant
[20:06:11] <Luqman> i'm guessing largest variant is ty_trait?
[20:06:26] <eddyb> Luqman: I think so
[20:09:06] <eddyb> pub type Name = uint; // maybe I can shrink this one, too
[20:14:53] <Luqman> 168 middle::ty::t_box_
[20:14:54] <Luqman> 152 middle::ty::sty
[20:15:01] <Luqman> yep, those are huge
[20:16:54] <Luqman> though CrateContext (1640) and ctxt_ (1320) seem to take the cake
[20:20:07] *** Quits: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP) (Quit: tikue_)
[20:20:41] *** Joins: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP)
[20:21:52] *** Quits: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP) (Quit: tikue_)
[20:25:58] <Luqman> https://gist.github.com/luqmana/2940d391e3ef2754850d
[20:26:32] *** Joins: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP)
[20:27:27] *** Quits: tikue_ (tkuehn@60AB20BB.EB08480C.689607DE.IP) (Quit: tikue_)
[20:33:23] <eddyb> Luqman: eeeeh, how you do that?
[20:33:39] <eddyb> sorry, mom took me for a silly discussion. back to shrinking Name
[20:33:56] <Luqman> eddyb: -Z count-type-sizes
[20:34:07] <eddyb> sweet
[20:34:17] <cmr> Luqman: whoa, how long has that existed?
[20:34:28] <Luqman> that + a sort -k1rn
[20:34:38] <Luqman> cmr: quite a while
[20:34:44] * cmr had no idea :(
[20:34:56] <eddyb> static SELF_KEYWORD_NAME: uint = 8;
[20:35:03] <eddyb> can't it use Name instead of uint there?
[20:35:40] <eddyb> rusti: type Name = u32; static SELF_KEYWORD_NAME: Name = 8; SELF_KEYWORD_NAME
[20:35:41] -rusti- 8u32
[20:36:02] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[20:44:18] <eddyb> rusti: type Name = u32; 8 as Name
[20:44:18] -rusti- 8u32
[20:49:57] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[21:01:21] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[21:01:59] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:01:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AjjOQA
[21:01:59] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:03:33] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[21:07:03] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:07:03] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ExDvFg
[21:07:03] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:10:22] *** flaper87 is now known as flaper87|afk
[21:11:45] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:11:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ExDvFg
[21:11:45] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:11:52] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:11:52] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/mDKhTA
[21:11:52] <ghrust> 13rust/06auto 14b6ab4f2 15LeÌo Testard: Add an implementation of Encodable and Decodable for Rc. This will be needed to use Rc in place of @ in libsyntax.
[21:11:52] <ghrust> 13rust/06auto 14ae836c1 15LeÌo Testard: Implement IterBytes for Rc<T>.
[21:11:53] <ghrust> 13rust/06auto 14e632c44 15bors: auto merge of #10658 : LeoTestard/rust/serialize-rc, r=cmr...
[21:11:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:23:12] <nmatsakis> cmr: that rustdoc failure doesn't occur locally :(
[21:23:55] <cmr> nmatsakis: I'm glad! Slap a retry on it?
[21:24:49] <nmatsakis> cmr: yes I guess I will and cross fingers
[21:29:24] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: Lost terminal)
[21:29:45] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[21:31:01] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[21:32:10] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[21:38:54] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[21:39:17] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[21:39:17] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:43:39] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:43:39] *** ChanServ sets mode: +o tjc
[21:52:37] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:57:14] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: leaving)
[21:57:26] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[22:16:45] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[22:16:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/mDKhTA
[22:16:45] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[22:21:45] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:21:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/2T6pAw
[22:21:45] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:21:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[22:21:46] <ghrust> 01[13rust01] 15bors pushed 13 new commits to 06auto: 02http://git.io/J8ahFQ
[22:21:46] <ghrust> 13rust/06auto 14aca1775 15Patrick Walton: test: Remove most uses of `&fn()` from the tests.
[22:21:46] <ghrust> 13rust/06auto 14343bc1f 15Patrick Walton: librustc: Remove remaining uses of `&fn()` in favor of `||`.
[22:21:47] <ghrust> 13rust/06auto 1428263eb 15Patrick Walton: libsyntax: Remove the old-style borrowed closure type syntax from the...
[22:21:49] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[22:23:51] <ChrisMorgan> I'm concerned at the pattern I'm seeing with things like https://github.com/mozilla/rust/pull/10658, implementing various traits for Rc<T> if they're implemented for T. Where does it end? Why does the standard library get to be privileged in such things? I reckon these sorts of things are a smell.
[22:25:25] <tjc> ChrisMorgan: Not sure I understand? As far as I know, you can do that in any code, not just the standard library
[22:26:08] <ChrisMorgan> The fact that you *need* to do that and that you'll end up with quite a lot of specific code. That some traits will work and others won't, leading to a lack of consistency.
[22:27:03] <tjc> for Rc in particular? or in general?
[22:27:23] <ChrisMorgan> A case like Rc is probably quite difficult to generalise (I guess it's mostly that &self methods will operate on .borrow()), but I know it's common for other wrapping types to wish to implement the wrapped type's traits, delegate them to that field.
[22:28:02] <ChrisMorgan> (Those are probably better considered two distinct problems, but many of the symptoms are shared.)
[22:31:25] <ChrisMorgan> I don't have any solution for the former, though I can see you might have something like #[impl_traits_from_field("field_name")] (implications in cross-crate compilation arrangements not thought out, especially impl collisions). Mostly, it's just a verbosity and lack of consistency that is making me uneasy.
[22:32:16] <strcat> ChrisMorgan: not all the traits will be the same though
[22:33:01] <strcat> and we probably shouldn't impl those for every Gc<T> because they're not always right
[22:35:43] <ChrisMorgan> I know, the fact that you may not want it to be possible is what prevents it from being done sanely. It feels a little like the impl Trait for ~Trait business; in most cases (the significant majority, I think) it can be derived, but for some reason thus far we've not done it at all.
[22:36:10] <strcat> I don't think defining new smart pointers is common so I wouldn't worry too much about it
[22:37:17] <ChrisMorgan> (That's the first of the two problems I indicated.) Still, if we want their APIs to be friendly, we probably want to avoid the necessity of explicit .borrow() or whatever as much as possible?
[22:37:58] <strcat> ChrisMorgan: there will be deref overloading
[22:38:20] <ChrisMorgan> Good, I suppose that would fix up most things for that case.
[22:52:53] *** Joins: tikue_ (tkuehn@6E051717.B9B3942C.689607DE.IP)
[23:02:01] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:02:01] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1495b22e9 to 14e632c44: 02http://git.io/N3iJvQ
[23:02:01] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:34:23] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:35:54] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[23:35:54] *** ChanServ sets mode: +o tjc
[23:46:30] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[23:46:37] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:46:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140bd94bf to 14e632c44: 02http://git.io/N3iJvQ
[23:46:37] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:46:47] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[23:46:47] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/yDsmIw
[23:46:47] <ghrust> 13rust/06auto 14ce44094 15Niko Matsakis: Add [mut_]shift_ref/[mut_]pop_ref functions, which return a pointer to the first/last item in the slice and modify the slice to exclude the returned item. Useful when writing iterators over mutable references.
[23:46:48] <ghrust> 13rust/06auto 14c830546 15Niko Matsakis: Modify iterators to make them safe with the new rules.
[23:46:50] <ghrust> 13rust/06auto 14f26768c 15Niko Matsakis: Test that reborrowing contents of an `&'a mut &'b mut` pointer can only...
[23:46:52] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[23:47:10] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[23:47:10] *** ChanServ sets mode: +ao pcwalton pcwalton
