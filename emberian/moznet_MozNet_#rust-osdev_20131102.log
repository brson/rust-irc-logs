[00:00:08] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: ZZZzzz…)
[00:00:55] *** Quits: canhtak (canhtak@moz-14E3CE16.wl.t.ulaval.ca) (Ping timeout)
[00:01:45] *** Joins: canhtak (canhtak@moz-14E3CE16.wl.t.ulaval.ca)
[00:04:39] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[00:07:03] *** Parts: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) ()
[00:35:47] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: ZZZzzz…)
[00:56:14] *** Quits: dbaupp (Thunderbir@moz-B3C9E9E8.lns20.syd6.internode.on.net) (Ping timeout)
[00:59:18] *** Joins: dbaupp (Thunderbir@moz-B3C9E9E8.lns20.syd6.internode.on.net)
[01:04:45] *** Quits: canhtak (canhtak@moz-14E3CE16.wl.t.ulaval.ca) (Quit: canhtak)
[01:06:19] *** sam113101_afk is now known as sam113101
[01:12:37] <kmc> SYSCALL is pretty much the designated way to make system calls on AMD64
[01:12:42] <kmc> and SWAPGS exists to support it
[01:17:50] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[01:18:20] *** Joins: canhtak (canhtak@moz-14E3CE16.wl.t.ulaval.ca)
[01:18:52] <pcmattman> kmc: yup, and on x86 it's good to use it if it's present
[01:19:03] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[01:19:46] <kmc> can you use SWAPGS in 32-bit mode?
[01:20:53] <pcmattman> can't remember, don't think so
[01:21:04] <pcmattman> but syscall/sysenter are available, under a cpuid check
[01:21:27] <kmc> right
[01:22:42] * pcmattman hypocritically still uses int $nn for syscalls :)
[01:23:02] <pcmattman> (haven't invested the time to switch away from it)
[01:36:33] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[01:58:42] *** Quits: dbaupp (Thunderbir@moz-B3C9E9E8.lns20.syd6.internode.on.net) (Ping timeout)
[02:01:50] *** Quits: devbug_ (quassel@23AC5F12.9D950176.3655BBF5.IP) (Ping timeout)
[02:02:42] *** Joins: dbaupp (Thunderbir@moz-7FBF750E.lns20.syd6.internode.on.net)
[02:30:36] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:35:00] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[03:24:42] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[03:44:39] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:47:42] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[03:54:12] *** Joins: kimundi_ (kimundi@moz-CEF9AA1F.dip0.t-ipconnect.de)
[03:55:09] *** Quits: kimundi (kimundi@moz-F8D99315.dip0.t-ipconnect.de) (Ping timeout)
[03:55:09] *** kimundi_ is now known as kimundi
[03:56:18] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:03:10] *** kimundi is now known as zz_kimundi
[04:10:27] *** zz_kimundi is now known as kimundi
[05:11:08] *** Quits: canhtak (canhtak@moz-14E3CE16.wl.t.ulaval.ca) (Quit: canhtak)
[05:23:20] *** Quits: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb)
[05:29:38] *** Joins: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net)
[05:36:11] *** Joins: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[05:38:35] *** Quits: dbaupp (Thunderbir@moz-7FBF750E.lns20.syd6.internode.on.net) (Ping timeout)
[05:42:41] *** Joins: dbaupp (Thunderbir@moz-8F906C32.lns20.syd6.internode.on.net)
[05:45:19] *** Quits: dbaupp (Thunderbir@moz-8F906C32.lns20.syd6.internode.on.net) (Ping timeout)
[05:45:25] *** Joins: dbaupp (Thunderbir@moz-89FD7F5F.lns20.syd6.internode.on.net)
[05:47:08] *** Quits: dbaupp (Thunderbir@moz-89FD7F5F.lns20.syd6.internode.on.net) (Ping timeout)
[05:47:53] *** Joins: dbaupp (Thunderbir@moz-96FDCF0F.lns20.syd6.internode.on.net)
[06:25:28] *** Parts: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net) ()
[07:11:09] *** Quits: dbaupp (Thunderbir@moz-96FDCF0F.lns20.syd6.internode.on.net) (Ping timeout)
[07:14:44] *** Joins: dbaupp (Thunderbir@moz-4D38AB0E.lns20.syd6.internode.on.net)
[07:18:45] <eddyb9> pcmattman: hmm, so syscall/sysenter are like task switching optimized for syscalls?
[07:19:01] <pcmattman> not task switching so much as calling into the kernel
[07:19:14] <pcmattman> they are, IIRC, basically a slightly-more-complex function call that happens to drop to ring0
[07:19:47] <eddyb9> aha. do they switch stack?
[07:19:52] <pcmattman> that I can't remember
[07:20:32] <eddyb9> I remember reading something about interrupt handling, and stack switching would complicate my syscall gate
[07:21:28] <strcat> pfft, who needs a userland anyway
[07:21:28] <eddyb9> I guess it's important so you don't leak a lot of kernel addresses and other things to the userspace
[07:21:54] <eddyb9> strcat: I was considering LTO against the kernel for safe Rust programs
[07:22:09] <eddyb9> at least just to benchmark
[07:22:11] * pcmattman was considering making 'userspace' on Rust just... tasks
[07:22:15] <pcmattman> rustic*
[07:22:36] <pcmattman> no need for syscalls, just run everything SAS, using Rust's model to maintain safety
[07:23:18] <eddyb9> but you need the entire rustc inside the kernel to pull in apps
[07:23:42] <pcmattman> eddyb9: nah, not if you don't allow loading arbitrary applications at runtime
[07:23:51] <eddyb9> otherwise you can't prove it's safe at all
[07:23:59] <eddyb9> pcmattman: that sounds worse :/
[07:24:09] <pcmattman> worse?
[07:24:22] <dbaupp> pcmattman: installing something is recompiling the whole OS... ?
[07:24:27] <pcmattman> makes things significantly less general-purpose, sure
[07:24:32] <eddyb9> you're thinking of code signing?
[07:24:54] <pcmattman> more useful for things like a router OS for example, say
[07:25:09] <eddyb9> aaah, I see where you're going with this :)
[07:25:37] <eddyb9> uutils in the kernel, that'd be cool
[07:27:14] <pcmattman> theoretically easier to prove "safety" too
[07:28:44] <eddyb9> grep -r unsafe src && echo "this is unsafe" && false
[07:33:28] *** Quits: dbaupp (Thunderbir@moz-4D38AB0E.lns20.syd6.internode.on.net) (Ping timeout)
[07:34:35] <eddyb9> I've taken a look at paging, it's ridiculously simple :D
[07:35:44] <eddyb9> some of these things looked more arcane to me than they actually are
[07:36:41] <eddyb9> pcmattman: for BIOS emulation, I propose mapping (or even copying) the first 1MB to some other place, and leave the virtual first 1MB unmapped
[07:37:26] *** Joins: dbaupp (Thunderbir@moz-EA596755.lns20.syd6.internode.on.net)
[07:42:28] *** Parts: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Leaving...)
[08:01:55] <eddyb9> oh, that's silly GRUB, discarding the proper type of a region in memory maps
[08:02:05] <pcmattman> hm?
[08:02:16] <eddyb9> or rather, the multiboot legacy format
[08:02:32] <pcmattman> what's it doing?
[08:02:59] <eddyb9> pcmattman: there's no way to tell if an unusable region is actually ACPI reclaimable stuff or NVS
[08:03:26] <pcmattman> no, the multiboot format is literally just to tell you what RAM is usable and what RAM is not
[08:03:44] <pcmattman> your ACPI layer can do the rest, and is far better at it anyway
[08:05:36] <eddyb9> but the BIOS function used by GRUB has more types, and they are collapsed into a single "unusable"
[08:06:03] <pcmattman> what if GRUB can't use that BIOS function on a host?
[08:06:15] <pcmattman> oops, there goes your 'reliable' detection of ACPI reclaimable areas
[08:07:14] <pcmattman> generally speaking if you're using the memory map for more than just "tell me where all the free and immediately usable physical memory is" you're probably doing it wrong
[08:07:38] <eddyb9> I'm not sure I actually care that much about the ACPI info, more like bitching about discarding information
[08:09:19] * eddyb9 wonders if it would be wise to use a SlamAllocator backing on the free RAM below 1MB for BIOS emulation
[08:26:49] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[08:49:32] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[09:05:23] *** Joins: tiffnya (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[09:05:31] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[09:31:20] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Connection reset by peer)
[11:13:08] *** Quits: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb)
[11:49:04] *** Quits: tgummerer (tgummerer@moz-582025B2.members.linode.com) (Quit: Coyote finally caught me)
[12:14:45] *** tiffnya is now known as tiffany
[12:38:09] *** Joins: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca)
[12:46:37] <Leo`> hello
[12:51:46] <eddyb9> hmm, cirrus (the default VGA card emulated in qemu) has some acceleration. not sure if it's worth writing a driver for it, though
[12:52:26] <eddyb9> vmware would be better, does qemu support it at all?
[13:08:50] <eddyb9> well, there's a file for it...
[13:09:20] <eddyb9> pcmattman: do you know how good the qemu vmware-vga support is?
[13:12:11] <pcmattman> eddyb9: it's quite good
[13:12:43] <pcmattman> I know it's definitely good for 2D ops, no idea what its 3D stuff is like
[13:14:45] <eddyb9> oh, awesome :D
[13:18:38] <eddyb9> for some reason (most likely instructions not writing all the flags), my automatic analysis of the cirrus VGA ROM cuts off the mode setting code, I was curious what it's doing
[13:21:08] <eddyb9> hmm, you could possibly record port/MM IO writes for certain modes, and use those instead of emulating the ROM again :P
[13:27:15] *** sam113101 is now known as sam113101_afk
[13:31:54] *** Quits: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk) (Ping timeout)
[13:37:15] <eddyb9> what's with VBE_DISPI? is qemu cheating somehow?
[13:37:47] <pcmattman> are you referring to the bochs/qemu SVGA ROM?
[13:38:29] <eddyb9> wait, so it reads the width/height from somewhere... can that be used to set any crazy mode you can think of?
[13:38:50] <eddyb9> pcmattman: hw/vga.c in qemu, vga_get_resolution
[13:39:05] <pcmattman> vmware or cirrus?
[13:39:22] <eddyb9> common code. not sure if cirrus bypasses it
[13:39:42] <pcmattman> I'm pretty sure you can set just about any mode you like in qemu
[13:39:56] <pcmattman> it's just a window with a canvas
[13:40:19] <eddyb9> but from within the emulated OS?
[13:40:30] <pcmattman> sure, why not?
[13:40:55] * pcmattman has very arcane modes when he uses Linux/Windows inside VMware as it 'fits' to the window, which is not always a sane size
[13:41:04] <pcmattman> qemu is no different, I'm sure
[13:41:39] <eddyb9> I mean, I'm fine with that, but it looks like qemu took a shortcut and it can be abused
[13:42:46] <pcmattman> how so?
[13:43:47] <eddyb9> well, it does have maximum values for those registers
[13:44:42] <eddyb9> I'm surprised VBE has its own IO ports, I was expecting the GPU ROM to use the card's own IO capabilities
[13:46:15] <eddyb9> aaaaah, thank you debug #ifdef. this is bochs VBE, that makes more sense
[14:02:12] *** Joins: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk)
[14:09:04] *** Quits: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca) (Quit: canhtak)
[14:19:19] *** Joins: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca)
[15:07:03] *** Joins: eddyb (eddy@FE23D96E.F33C1089.FB866788.IP)
[15:08:15] *** sam113101_afk is now known as sam113101
[15:14:14] *** Quits: eddyb9 (eddy@FE23D96E.F33C1089.FB866788.IP) (Quit: Leaving)
[15:22:31] *** Joins: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[15:26:17] *** Joins: tgummerer (tgummerer@moz-582025B2.members.linode.com)
[16:09:05] *** Quits: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca) (Quit: canhtak)
[16:32:21] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: ZZZzzz…)
[16:52:20] *** Joins: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca)
[17:04:36] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[17:06:51] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: ZZZzzz…)
[17:23:17] *** Quits: tgummerer (tgummerer@moz-582025B2.members.linode.com) (Quit: Coyote finally caught me)
[17:58:18] *** Joins: pczarn (Mibbit@moz-69A55FA.izacom.pl)
[18:14:43] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Quit: WeeChat 0.3.9.2)
[18:29:51] *** Quits: pczarn (Mibbit@moz-69A55FA.izacom.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[18:42:42] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[18:49:31] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: ZZZzzz…)
[18:54:33] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[19:30:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:14] *** Quits: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb)
[20:43:49] *** Joins: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[20:44:11] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[21:25:27] *** Joins: geoffhill (geoffhill@moz-EED745AA.hsd1.wa.comcast.net)
[21:29:49] *** Quits: geoffhill (geoffhill@moz-EED745AA.hsd1.wa.comcast.net) (Ping timeout)
[21:40:05] *** Joins: geoffhill (geoffhill@514D668A.DB14657A.BCDF04A6.IP)
[21:41:55] *** Quits: geoffhill (geoffhill@514D668A.DB14657A.BCDF04A6.IP) (Ping timeout)
[22:21:10] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[22:37:55] *** Quits: jeffdb (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb)
[22:44:11] *** Quits: dbaupp (Thunderbir@moz-EA596755.lns20.syd6.internode.on.net) (Ping timeout)
[22:48:14] *** Joins: dbaupp (Thunderbir@moz-EA596755.lns20.syd6.internode.on.net)
[23:20:21] *** Quits: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca) (Quit: canhtak)
[23:20:35] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:30:41] *** Joins: canhtak (canhtak@moz-A161DED8.wl.t.ulaval.ca)
