[00:07:28] *** Quits: acharles (acharles@moz-dvfnah.static.qwest.net) (Client exited)
[00:22:08] *** Quits: simukis1 (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:38:23] *** Joins: acharles (acharles@moz-mi1459.static.qwest.net)
[00:41:30] <nrc> eddyb: ping?
[01:11:40] <eddyb> nrc: pong
[01:12:56] <nrc> eddyb: Hi, I was looking at DST coercions again. We don't work on structs where the last field is not a type param, which means we don't admit coercion for Mutex (this is now a regression since Mutex became unsized)
[01:13:17] <nrc> do you have an idea of how hard it would be to allow these kinds of nested struct coercions?
[01:14:35] <eddyb> Mutex... did what?
[01:14:39] <eddyb> or do you mean Mutex<T>?
[01:14:47] <eddyb> sorry
[01:14:49] <eddyb> T in Mutex<T>
[01:15:20] <eddyb> and how is it a regression?
[01:20:52] <nrc> so at the moment Mutex<[i32; 3]> <: Mutex<[i32]>
[01:20:58] <nrc> but with te DST coercions PR it is not
[01:21:11] <nrc> er &Mutex in the above
[02:12:40] *** Quits: zz_kimundi (kimundi@moz-ocelec.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:15:06] *** Joins: zz_kimundi (kimundi@moz-mmvhvu.dip0.t-ipconnect.de)
[02:15:07] *** zz_kimundi is now known as kimundi
[02:18:47] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[02:20:23] *** Quits: Rym_ (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[03:02:06] *** Joins: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP)
[03:04:08] *** Joins: p1start (p1start@moz-nftjhe.org)
[03:45:37] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[04:39:27] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[05:06:53] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[05:11:06] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[05:19:34] *** Joins: p1start (p1start@moz-nftjhe.org)
[05:53:29] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[05:57:47] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[05:58:37] *** Quits: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP) (Connection closed)
[06:47:41] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[06:51:56] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[06:57:45] *** Quits: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP) (Quit: Leaving)
[07:31:38] <eddyb> nrc: sorry, I fell asleep. but surely this has to work? https://github.com/rust-lang/rust/blob/master/src/libstd/sync/mutex.rs#L122
[07:31:50] <eddyb> nrc: let me look at the code again
[07:33:38] <eddyb> nrc: did you add this? https://github.com/rust-lang/rust/pull/24619/files#diff-7ae8095af1341d6551d39693f9eea381R2523
[07:34:53] <eddyb> no, wait, I seem to remember now
[07:36:26] <eddyb> nrc: this would be an easy problem to solve if it weren't for associated types
[07:38:39] <eddyb> nrc: you could recurse through the types and look at all the ty_param's, making sure only a single T is mentioned
[07:39:03] <eddyb> nrc: and then substitute the last field's type with substs_{a, b}
[07:39:13] <eddyb> (to get inner_{source, target})
[07:39:36] <eddyb> nrc: everything else should work
[07:41:47] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[07:46:05] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[08:05:43] *** Joins: laumann (thomas@moz-33d.hq0.225.130.IP)
[08:18:15] <eddyb> nrc: sorry for missing this case in the first place, I'm not sure the RFC even supports it
[08:35:56] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[08:40:14] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[08:52:46] <nrc> eddyb: I added the FIXME, the comment is yours
[08:53:00] <nrc> also, I se it landed \o/
[08:53:31] <eddyb> nrc: what do you think about the solution I'm suggesting?
[08:54:01] <eddyb> is it even worth to prevent changing more than a type parameter while fields' types remain the same? (associated types could result in this)
[08:55:46] <nrc> I think that should work
[08:56:21] <nrc> I think you have to enforce that no other types change - that could cause totally invalid type conversions, couldn't it?
[08:57:01] <nrc> .me is only intermittently at keyboard
[08:57:59] <eddyb> nrc: yeah, it could. there should be a function that takes a closure and calls the closure for every sub-type in a nested set of types, which should work for finding all the type params
[09:30:07] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[09:34:23] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[09:34:46] *** kimundi is now known as zz_kimundi
[09:48:41] <doener> nmatsakis: regarding the arith_offset, should that just be an intrinsic, or should I write an RFC for it being added as a method for raw pointers?
[10:02:57] *** Quits: nrc (nrc@moz-9luh02.xtra.co.nz) (Ping timeout: 121 seconds)
[10:03:36] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[10:03:37] *** ChanServ sets mode: +o pnkfelix
[10:17:16] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[10:23:44] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[10:24:17] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[10:27:40] *** Quits: globin (globin@moz-isrgf8.de) (Ping timeout: 121 seconds)
[10:28:32] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[10:29:37] *** Joins: globin (globin@moz-isrgf8.de)
[10:34:13] *** Quits: globin (globin@moz-isrgf8.de) (Ping timeout: 121 seconds)
[10:35:57] *** Joins: globin (globin@moz-isrgf8.de)
[11:18:26] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[11:22:44] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[11:34:15] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[11:39:57] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[11:49:59] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[13:16:53] <eddyb> huon: there doesn't seem to be a way to hook libsyntax's behavior of openening the file associated with a module. any suggestions?
[13:18:34] <eddyb> I would probably be fine with controlling file_to_filemap, which could be done by moving it to CodeMap and allowing the latter to be hooked
[13:19:05] <eddyb> huon: I'm mostly wondering whether a Box<FileProvider> in CodeMap is too much or not
[13:20:51] <nmatsakis> doener: hmm I'd say let's start with an intrinsic, but you should bring it up with aturon/acrichto -- in particular, we've been talking about the libs subteam having a lighterweight process for small additions, and I think this might qualify
[13:21:31] <eddyb> nmatsakis: any opinion on customizing file loading?
[13:23:38] <nmatsakis> eddyb: i.e., introducing an abstraction layer so that when we request a file, it goes through some interface to get the text?
[13:23:45] <nmatsakis> seems like a good idea to me
[13:24:27] <nmatsakis> probably could be quite simple, maybe even just "path -> String"?
[13:24:58] <eddyb> yeah. the diagnostics abstraction works out really well for me, and that one has a Box<Trait> I believe
[13:25:37] <eddyb> nmatsakis: hah, file_to_filemap is really inefficient
[13:25:58] <eddyb> it reads into a Vec<u8>, converts that to &str and then calls to_string
[13:26:43] <eddyb> while the new std::io should allow directly reading into a String
[13:27:27] <nmatsakis> eddyb: in general the filemap code...looks like it hasn't been changed much since it was first written as a port from the O'caml :)
[13:28:33] <eddyb> some of the codemap stuff is newer, but yes, all those parser::foo_bar_baz functions are not Rusty
[13:31:24] <eddyb> what's ParseSess doing with node IDs?
[13:32:46] <eddyb> "one that uses a HOF to parse anything" good o'caml
[13:41:41] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[14:04:50] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[14:34:56] *** zz_kimundi is now known as kimundi
[15:02:45] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[15:05:42] <acrichto> doener: just adding an intrinsic won't require an RFC, but exposing it as part of the public api of libstd (stable or unstable) would however require an RFC
[15:05:57] <acrichto> doener: but we've added stuff like NonZero in the past which translate to immediate wins without an RFC
[15:06:02] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[15:07:07] <doener> acrichto: I'll prepare the PR to just have the intrinsic for now
[15:07:28] <acrichto> doener: ok!
[16:03:46] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[16:23:52] *** Joins: arielb1 (Ariel@moz-2trv48.red.bezeqint.net)
[16:38:34] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:57:37] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Ping timeout: 121 seconds)
[17:11:45] *** Quits: Manishearth (manishearth@moz-8puj7k.net) (Ping timeout: 121 seconds)
[17:16:11] *** Quits: laumann (thomas@moz-33d.hq0.225.130.IP) (Ping timeout: 121 seconds)
[17:18:12] *** Joins: Manishearth (manishearth@moz-8puj7k.net)
[17:27:09] *** Quits: Manishearth (manishearth@moz-8puj7k.net) (Ping timeout: 121 seconds)
[17:28:18] *** Joins: Manishearth (manishearth@moz-8puj7k.net)
[17:33:56] *** Quits: Manishearth (manishearth@moz-8puj7k.net) (Ping timeout: 121 seconds)
[17:34:57] *** Joins: Manishearth (manishearth@moz-8puj7k.net)
[18:57:11] *** Joins: nrc (nrc@moz-9luh02.xtra.co.nz)
[18:57:11] *** ChanServ sets mode: +qo nrc nrc
[19:05:01] *** Joins: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de)
[19:06:24] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[19:07:13] *** nrc is now known as nrc|afk
[19:52:02] *** Quits: blank_na1e (blank_name@moz-9koqv8.mi.frontiernet.net) (Quit: leaving)
[19:53:12] *** Joins: blank_name (blank_name@moz-9koqv8.mi.frontiernet.net)
[20:19:34] *** Quits: acharles (acharles@moz-mi1459.static.qwest.net) (Client exited)
[20:19:59] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[20:47:05] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[20:58:15] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[21:02:28] *** Quits: blank_name (blank_name@moz-9koqv8.mi.frontiernet.net) (Ping timeout: 121 seconds)
[21:04:28] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[21:14:10] *** Joins: blank_name (blank_name@moz-lg2.tgt.79.172.IP)
[21:14:51] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[21:26:00] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[21:26:08] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[21:32:21] *** nrc|afk is now known as nrc
[21:37:25] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[21:42:13] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[21:51:57] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[21:51:57] *** ChanServ sets mode: +o pnkfelix
[22:13:57] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[22:21:32] *** Joins: Rym (y@moz-o80acm.range86-189.btcentralplus.com)
[22:33:19] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[22:42:01] *** Quits: arielb1 (Ariel@moz-2trv48.red.bezeqint.net) (Quit: Ex-Chat)
[22:46:12] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:57:09] <eddyb> nmatsakis: the API I was talking about: #25387
[22:57:14] <eddyb> awww no bots
[22:57:40] <eddyb> nmatsakis: gh25387
[22:57:46] <eddyb> still no?
[22:58:10] <eddyb> [o__o]: what's wrong with you?
[23:04:36] *** Quits: torch (demigod@moz-0fmp8g.org) (Quit: BitchX-1.2.1 -- just do it.)
[23:05:57] *** kimundi is now known as zz_kimundi
[23:07:45] <eddyb> nmatsakis: wish I could mark a PR as "this is stuff for an IDE" :P
[23:08:34] *** Quits: stl (stl@moz-h0r.qae.15.176.IP) (Ping timeout: 121 seconds)
[23:20:13] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[23:20:15] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[23:21:19] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[23:21:22] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[23:21:22] *** ChanServ sets mode: +qo brson brson
[23:24:02] *** Joins: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP)
[23:36:12] *** nrc is now known as nrc|afk
[23:49:37] *** Quits: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de) (Quit: Bye)
[23:51:03] *** Joins: stl (stl@moz-861.rr7.15.176.IP)
