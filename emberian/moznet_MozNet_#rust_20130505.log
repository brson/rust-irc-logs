[00:00:31] <goldfeld> alright! thanks for that, seems to have gotten me past that bump so on to the next..
[00:01:01] <jack> does HashMap::find not work on simple types? u8 keys are &u8. does it do equivalence by pointer or by value?
[00:01:14] <aatch> goldfeld, I do suggest building rust from the incoming branch though at the moment.
[00:01:26] <jack> also, u8 doesn't implement Equiv so find_equiv is right out :(
[00:02:47] <aatch> jack, it /should/ work. But there is a SmallIntMap, though it takes int keys, not u8
[00:03:03] <brson> Thad: maybe more like http://pastebin.mozilla.org/2375553
[00:03:23] <brson> Thad: the function will need to be defined still
[00:03:30] <Thad> brson: oh
[00:03:32] *** Joins: eavgerinos (Mibbit@moz-D669A741.dsl.dyn.forthnet.gr)
[00:03:38] <eavgerinos> Hello everybody
[00:03:53] <aatch> Hi Dr. Nick!
[00:04:10] <strcat> brson: https://github.com/mozilla/rust/pull/6241 r?
[00:04:18] <eavgerinos> Is there any MVC web framework for Rust?
[00:04:25] <aatch> eavgerinos, hahahahahaha
[00:04:31] <aatch> Sorry.
[00:04:33] <aatch> No.
[00:04:35] <eavgerinos> I don't care about the View layer :P I wanna build an api ;P
[00:05:27] <eavgerinos> aatch: OK, thanks
[00:06:09] <brson> eavgerinos: I don't think Rust is mature enough yet that anybody has attempted such a thing
[00:07:58] <eavgerinos> brson: Well, I find Rust's syntax eye-candy and of course <3 concurrency. It may not be mature enough yet, but worths a try
[00:08:37] <strcat> you could make libmicrohttpd bindings
[00:08:58] <aatch> eavgerinos, yeah, sorry, I just found it amusing. There is currently a proposal for a regex module and we are overhauling format string atm, so MVC library seems way out there for me.
[00:09:22] <strcat> jack: hashmap will work on simple types and borrowed pointers to stuff
[00:09:40] <goldfeld> aatch, do you suggest any simple yet throrough project in Rust so I can get my bearings on how the current syntax for these external mods and foreign functions should work?
[00:09:52] <strcat> jack: but for u8 you probably just want SmallIntMap anyway
[00:09:57] <eavgerinos> aatch: It's ok. :) I know my question sounded like "first-world problems"
[00:10:10] <aatch> eavgerinos, it was a legitimate question though
[00:10:20] <aatch> so that isn't what I was laughing about.
[00:10:44] *** Joins: leal (Mibbit@62817B46.F3F28D48.10894A1E.IP)
[00:11:13] <aatch> goldfeld, you could take a look at rust-xcb, which are bindings + wrappers to the xcb library
[00:11:14] <eavgerinos> aatch: I'm just like... 15 hours into Rust :P So, I am not so familiar with what it is designed to do
[00:11:39] <eavgerinos> aatch: Btw, I come from the Ruby | Clojure world
[00:12:02] <aatch> So it uses a lot foreign functions and also shows how to interact with them.
[00:12:09] <goldfeld> p.s. yay regex in std would be awesome
[00:12:34] <aatch> The code is automatically generated, so it's not the best code in the world though
[00:12:39] <goldfeld> thanks a bunch will look into it
[00:12:45] <aatch> https://github.com/Aatch/rust-xcb
[00:12:49] <strcat> brson: yay, snapshots :)
[00:13:19] <aatch> (yes, it is my work, what of it? :P)
[00:13:30] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[00:13:50] <goldfeld> actually I had already perused your github profile by the time you mentioned xcb
[00:14:02] <Jeaye> :P
[00:14:25] <strcat> brson: I could probably use &'static instead of @ to make it non-owned
[00:14:32] <strcat> anyway
[00:14:39] <strcat> I'd rather just fix that :)
[00:14:40] <aatch> eavgerinos, thats cool we take more from Ruby than clojure
[00:15:41] <aatch> eavgerinos, though I strong suggest reading up about the pointer types. Coming from your background they will likely be one of the hardest concepts.
[00:15:46] <goldfeld> yeah Rust is so sexy it almost makes me think C-syntax is cool again
[00:16:06] <aatch> goldfeld, C syntax has always been cool!
[00:16:14] * aatch puts on sunglasses
[00:16:16] <goldfeld> hrrmm
[00:16:23] <EXetoC> lies
[00:16:50] <goldfeld> you see, it's just my pinkies who keep telling me otherwise
[00:18:29] <eavgerinos> aatch: Well, I know about C pointers and I read a little about borrowed, owned, managed in Rust (not that I feel confident using them though)
[00:18:36] <leal> hi, any one care to help with a noob syntax question?
[00:18:50] <aatch> leal, we're all ears.. er fingers
[00:19:00] <leal> https://gist.github.com/leea/5519235
[00:19:11] <EXetoC> eyes?
[00:19:26] <leal> I can't figure out what the heck is wrong with that :|
[00:19:57] <Thad> brson: haha.. I going to home depot... I'm going to need a bigger shovel to dig this deeper hole.  So much FUN ! lol.. now I have to port libuv ! :)
[00:20:04] <leal> rustc fails with :
[00:20:15] <leal> BinaryTreeT.rs:8:37: 8:38 error: expected `;` or `}` after expression but found `:`                                                                                                   BinaryTreeT.rs:8     let tree = BinaryTree <int> {Left: None, Right: None, Data: 0};                                                                                               
[00:20:29] <eavgerinos> leal: an extra comma line 4 i guess
[00:20:42] *** Joins: kvark (Mibbit@moz-46F48A13.cpe.distributel.net)
[00:20:57] <eavgerinos> leal: not sure though I just started studying Rust
[00:20:58] <aatch> leal, remove the type paramater from the let tree...
[00:21:16] <aatch> so let tree = BinaryTree {...}
[00:21:32] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[00:21:58] <leal> ahh that worked.  Thanks!
[00:22:16] <aatch> leal, yeah, rust does type inference
[00:22:34] <aatch> so you often don't need to explicitly give the parameters
[00:23:02] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:23:33] <leal> ahh .. this is my first couple hours with rust so I still not sure where it's trying to be like C++ and where it's trying to be like ML :P
[00:23:33] <aatch> In the case of construction there. You'd specify the parameter in the type for the variable, so let tree : BinaryTree<int> = BinaryTree {...}
[00:24:05] <aatch> leal, also, you don't need to space out the '>'s
[00:25:21] <leal> got it.  That was one of the fixes trying to get it to compile hah
[00:25:55] <aatch> leal, fair enough. We get enough C++ programmers that do it out of habit though
[00:27:31] <leal> aatch, it's a nice feature for sure
[00:27:32] <strcat> aatch: you don't need to specify types though
[00:27:40] <strcat> only if you aren't using it anywhere that infers the type
[00:27:51] <aatch> strcat, I said that first
[00:27:55] <strcat> oh
[00:27:58] <strcat> I was dc'ed ;P
[00:28:00] * strcat is sorry
[00:28:06] <aatch> Then pointed out how you /would/ specify the type
[00:28:50] <aatch> And true, you exactly missed the point where I said it does type inference.
[00:30:24] <leal> on second thought, should extraneous type decorations be a syntax error? 
[00:30:28] <goldfeld> I'm getting all these "undeclared type name" over this code https://github.com/doy/rust-lua/blob/master/lua.rs, offending types are lua_State, c_int , c_char and lua_CFunction
[00:30:43] <aatch> leal, no, they are good for asserting things in code
[00:31:32] <leal> right. So isn't my earlier code an example?
[00:32:31] <EXetoC> I wonder if you need to do let foo: Foo<Bar> = Foo {...}
[00:32:33] <aatch> goldfeld, sub modules don't inherit the parent uses anymore
[00:32:57] <aatch> leal, nope, struct initialization doesn't allow type parameters
[00:33:09] <aatch> so what you had was already a syntax error
[00:33:13] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:33:43] <EXetoC> they're going to do something about this eventually IIRC
[00:34:02] <goldfeld> hmm, I see, I nee to replicate those inside
[00:34:02] <leal> ah ok
[00:34:09] <aatch> Error messages consist of like 10-15% of the open issues
[00:34:31] * aatch pulled those numbers out of his arse btw
[00:34:35] <Jesse> aatch: meaning you can't write Foo<Bar> { ... } or Foo::<Bar> { ... } ?
[00:34:35] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[00:35:18] <aatch> Jesse, I'm not sure of the exact syntax. Mostly because you have interaction with block-exprs and similar
[00:35:26] *** Joins: areece (quassel@moz-45E7CFA8.compute-1.amazonaws.com)
[00:35:35] *** Quits: areece (quassel@moz-45E7CFA8.compute-1.amazonaws.com) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[00:36:29] <aatch> basically, because you can write do function { stuff }, the parser doesn't know what you want.
[00:36:39] <aatch> It gets resolved later though
[00:38:02] <aatch> the ast(ish) for that would be [DO_KEYWORD, expr, block]
[00:39:32] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:39:56] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[00:40:06] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[00:41:05] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[00:42:54] *** Joins: catpig (catpig@moz-269D9D6D.dip0.t-ipconnect.de)
[00:43:15] <brson> not sure I'm ever going to get used to assert!(...)
[00:43:27] <aatch> brson, why not?
[00:44:17] <strcat1> brson: !x -> not x ;p
[00:44:46] <aatch> keywords for every one!
[00:44:53] <strcat1> http://en.cppreference.com/w/cpp/language/operator_alternative sure
[00:44:58] <strcat1> ;p
[00:45:03] * strcat1 is only half-serious
[00:45:06] *** strcat1 is now known as strcat
[00:45:45] <aatch> I know that the di- and tri-graphs cause issues trying to implement a decent parser
[00:45:52] <strcat> I find 'if not foo() { }' more readable than 'if !foo() {}' though
[00:46:15] <strcat> aatch: the alternate keywords were added later
[00:46:16] *** Joins: ssbr__ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[00:46:40] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[00:46:44] <strcat> 'The tokens were added to the standard in a 1995 amendment to the C90 standard.'
[00:46:57] <aatch> strcat, eh, I'm not against adding in a not operator
[00:47:03] <strcat> well I mean replacing !
[00:47:08] <strcat> duplicate ways of doing things is silly
[00:47:11] <strcat> I doubt it will happen though :)
[00:47:14] * aatch isn't too bothered by syntax
[00:47:28] <strcat> assert!(!foo())
[00:47:30] <strcat> vs
[00:47:32] <strcat> assert!(not foo())
[00:49:22] <strcat> brson: did you see https://github.com/mozilla/rust/pull/6241 ? my internet connection is acting up so I'm not if you got my message before
[00:53:15] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[00:53:39] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:53:53] <Thad> brson:  Good to know: The only thread limitation on Windows 64 is the amount of RAM.
[00:55:23] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[00:56:11] *** Quits: jaen (jaen@moz-BD5DBE19.play-internet.pl) (Ping timeout)
[00:57:04] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:58:22] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[00:58:31] *** Quits: ssbr__ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[00:58:43] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[00:59:03] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[00:59:06] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:00:48] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:00:57] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:02:39] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[01:02:43] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:03:12] <brson> strcat: I did, thanks. left a comment there
[01:03:13] <brson> bbl
[01:03:14] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Quit: leaving)
[01:04:44] *** Quits: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu) (Client exited)
[01:05:24] *** Quits: leal (Mibbit@62817B46.F3F28D48.10894A1E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[01:06:58] *** Quits: eavgerinos (Mibbit@moz-D669A741.dsl.dyn.forthnet.gr) (Quit: http://www.mibbit.com ajax IRC Client)
[01:07:21] *** Joins: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu)
[01:07:40] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:07:48] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:11:15] *** Joins: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net)
[01:11:46] *** Quits: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net) (Quit: dbaupp)
[01:11:50] *** Joins: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net)
[01:12:37] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[01:12:48] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:14:53] <aatch> steven_is_false, thanks for the xcb stuff. I added a from_raw_conn() static method to Connection as well
[01:15:03] <steven_is_false> aatch: Your welcome!
[01:16:32] <steven_is_false> aatch: After I get Rust Bindgen working I'm going to be working on glX, and probable am going to work on the XCB bindings in the future.
[01:17:02] <aatch> for glx?
[01:17:02] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[01:17:42] <steven_is_false> aatch: sure.
[01:22:08] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[01:23:24] <kvark> excuse me, is there a way to have an output library name without the hash-tail? (libX instead of libX-94839cbfe144198-0.1)
[01:23:38] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[01:23:51] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[01:24:49] <aatch> kvark, not as far as I'm aware
[01:25:34] <kvark> aatch: ah, ok... I'm just working on Makefile, and the semi-random output name doesn't bode well with it
[01:25:40] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[01:25:59] <aatch> kvark, it's not completely random though
[01:27:08] <aatch> I can't remember how it does it though.
[01:27:46] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:28:31] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:28:35] <steven_is_false> aatch: Couldn't one get the compiler to do it?
[01:28:57] <steven_is_false> Doh!
[01:28:59] <aatch> steven_is_false, what? output without the hash?
[01:29:12] <aatch> Or not rebuild?
[01:29:40] *** Joins: quvarxa (chatzilla@moz-C9831B8C.lns20.adl2.internode.on.net)
[01:29:43] <steven_is_false> Here was my dumb idea, rustc --ls libcrate | `unix-magic` 
[01:29:48] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[01:30:02] <steven_is_false> But to do that one would already need to know the crates name.
[01:30:33] <dbaupp> aatch: it's the hash of the metadata along with the dependencies hashes
[01:30:43] <aatch> dbaupp, ahh
[01:31:04] <aatch> steven_is_false, if that's what you would do, '-Z print-link-args' covers it
[01:31:08] <dbaupp> this happens in librustc/back/link.rs, and it doesn't look like it's disableable
[01:31:52] <aatch> unfortunately that requires getting past translation to work
[01:32:01] <aatch> so it's actually not worth it
[01:33:11] <aatch> wow, I actually decided to try using rusti. Failed giving it '1'
[01:33:21] <strcat> aatch: yep
[01:33:25] <dbaupp> aatch: yup... :(
[01:33:25] <strcat> it's great! ;p
[01:33:31] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[01:33:31] <dbaupp> rusti: 1
[01:33:32] <rusti> 1
[01:33:32] <strcat> convenient core dump generator
[01:33:44] <aatch> I knew it was broken... but... wow
[01:33:44] <dbaupp> that one works slightly better ;P
[01:34:08] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:34:10] *** Joins: Andrew (Mibbit@moz-91DB7BBE.cable.virginmedia.com)
[01:34:13] <kvark> I'm getting "exchange heap not empty on on exit1 dangling allocationsAborted (core dumped)" when my app finishes. Does anyone find that familiar?
[01:34:17] <aatch> rusti: io::println("Accept no crappy JIT substitutes")
[01:34:18] <rusti> Accept no crappy JIT substitutes
[01:34:25] <strcat> kvark: are you using unsafe anywhere?
[01:34:38] <kvark> yeah
[01:34:48] <strcat> well it indicates ~ leaks somewhere
[01:35:05] <kvark> uh ok, will check all unsafes. Thanks strcat!
[01:35:16] <strcat> it's *possible* that it's a compiler bug
[01:35:26] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:35:28] <strcat> but more likely to be a bug in an unsafe block (in your code or the stdlib)
[01:35:49] <kvark> strcat: so if one of my external libs leak, I'll get this too?
[01:35:56] <strcat> kvark: no
[01:36:00] <strcat> only from ~
[01:36:04] <kvark> hmm
[01:36:28] <strcat> have to use valgrind and check all the code paths to make sure you're handling errors right for other leaks
[01:36:43] <kvark> that's an idea
[01:36:57] <aatch> make sure you load the suppressions for valgrind though
[01:37:04] <strcat> https://github.com/linuxfood/rustsqlite/blob/master/sqlite.rc#L442 example of how easy it is to screw up ;p
[01:37:16] <strcat> sqlite requires that you close the connection if opening it fails
[01:37:22] * strcat should send a pull for that
[01:37:33] *** Quits: eevee (eevee@moz-6BEA2DBB.evrt.wa.frontiernet.net) (Quit: Lost terminal)
[01:37:52] <dbaupp> strcat: I dare you to do that
[01:38:00] <dbaupp> (you'd be even more of a superhero ;P )
[01:38:28] <strcat> the build server just made me my daily incoming package ;p
[01:38:33] <strcat> Net Upgrade Size:       -10.41 MiB
[01:38:35] <strcat> \o/
[01:38:40] <aatch> woo!
[01:39:11] <dbaupp> strcat: wow, what was the extra crap?
[01:39:48] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:39:52] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[01:40:10] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:40:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:40:34] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:40:52] <strcat> dbaupp: I got that sqlite thing wrong a few times before realizing so I just assume every binding does :)
[01:41:15] <strcat> closing a connection frees the internal storage it uses to do stuff like reporting errors
[01:41:23] <strcat> so need to do it even if it fails
[01:41:41] <Thad> ok, ok... I gotta understand this... Basically, in a nutshell, Rust is just looking for (and wired up to help find and use) a compiler toolchain on a Windows / Linux / Apple system...Right ?
[01:42:16] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:42:20] <aatch> Thad, it looks for gcc on windows
[01:42:31] <dbaupp> strcat: yeah, that's reasonable
[01:42:32] <Thad> The reason I ask is that I'm re-thinking that Cygwin might not be the ideal setup for this for Windows users.... before I put more work into this.
[01:42:42] <dbaupp> strcat: but why did 10 megs disappear from rust?
[01:42:53] <strcat> dbaupp: there was a 12MiB size regression
[01:42:57] <strcat> looks like 10.5MiB is fixed
[01:43:03] <strcat> another .5MiB was fixed from something else
[01:43:17] <strcat> dbaupp: because local heap stuff moved from C++ to the runtime and was being inlined everywhere
[01:43:19] <strcat> one of the reasons.
[01:43:34] <dbaupp> strcat: oh, is this the remove inlining on malloc/free pull request?
[01:43:45] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:43:52] <strcat> dbaupp: I assume so :)
[01:44:01] <strcat> anyway it's only for the local allocator
[01:44:37] <dbaupp> strcat: is that @ ?
[01:44:40] <strcat> yes
[01:44:42] <strcat> and ~ containing @
[01:45:08] <Thad> aatch: right...but Graydon and Brson mentioned to me that ideally they want to base off of Clang, and for me to go that route and help out with the Windows building.
[01:45:13] <dbaupp> ah, cool, so that and owned-~ are now on actually separate heaps?
[01:45:16] <strcat> Owned ~ uses the "exchange allocator" which *should* just be a raw malloc/free
[01:45:23] <strcat> dbaupp: well, "separate"
[01:45:28] <strcat> both are implemented on top of malloc atm
[01:45:32] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[01:45:44] <dbaupp> strcat: oh, just different pre/post-processing of malloc... cool.
[01:45:53] <strcat> dbaupp: the local heap will eventually be managed by gc
[01:46:11] <dbaupp> strcat: yeah
[01:46:18] *** Joins: akashj87_ (akash@3BD52CA6.D8B89461.35E3DDC8.IP)
[01:46:28] <strcat> dbaupp: sadly both have 4-word headers
[01:46:36] <strcat> exchange allocs shouldn't have it
[01:46:40] <aatch> Thad, that requires some other changes.
[01:46:44] <strcat> a library impl of unique ptrs is faster atm :(
[01:46:55] <dbaupp> strcat: oh, I though that was removed?
[01:46:58] <strcat> dbaupp: nope
[01:46:58] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[01:47:09] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[01:47:10] <strcat> dbaupp: every ~ has 4 extra words
[01:47:11] <dbaupp> what's it blocked on?
[01:47:13] *** Quits: akashj87 (akash@E34E36C9.45783465.35E3DDC8.IP) (Ping timeout)
[01:47:22] <strcat> dbaupp: something reads the ~ headers to see if they are managed or not
[01:47:32] *** Joins: eevee (eevee@moz-6BEA2DBB.evrt.wa.frontiernet.net)
[01:47:34] <strcat> I think it's the single biggest perf issue atm.
[01:47:36] <dbaupp> strcat: at runtime? ... :(
[01:47:39] <strcat> dbaupp: yep
[01:47:43] <strcat> I tried removing them
[01:47:45] <strcat> didn't work out
[01:48:00] <strcat> 10000000000 invalid reads -> segfault when it took the wrong path
[01:48:07] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:48:17] <dbaupp> that's always a good sign ;P
[01:48:33] <strcat> dbaupp: anyway glibc malloc allocs sizes in powers of 2
[01:48:36] <strcat> so...
[01:48:37] <strcat> starting at 16
[01:48:48] <strcat> so the header is 32-byte
[01:48:54] <strcat> minimum alloc size of ~ is 64-byte
[01:48:58] <strcat> instead of 16 like it should be
[01:49:02] <strcat> (well, ~() would be 32)
[01:49:18] <Thad> aatch: do you know which ?  they mentioned that also, but didn't elaborate yet.  I'm supposed to just try to get things running, compiling on Cygwin, but it's a hard climb...and now Brson says that I'll probably have to port libuv for Cygwin...but that sort of defeats the purpose of a systems language designed for a system.... Cygwin is not the "system" or "os", but rather Windows is......
[01:49:19] <Thad> ...Cygwin is just used as a compiler toolchain holder and Unix tools holder...
[01:49:19] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[01:49:25] <strcat> so small objects are consuming 4x the memory they should be ;p
[01:49:27] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:49:29] <aatch> Thad, The code in link_binary uses "gcc" on linux, "cc" on everything else. Unless you pass the --linker flag
[01:49:31] <strcat> it's very bad
[01:49:39] <dbaupp> strcat: that is pretty bad
[01:50:43] <Thad> aatch: if I pass the --linker flag... using... mingw64 perhaps ?
[01:51:10] <aatch> Thad, well it calls the program given to the flag as the linker
[01:51:17] <Thad> aatch: maybe the real problem is that I'm not feeding gcc or clang what I am really intending to build or output ?
[01:51:22] <aatch> and it pretty much has to be gcc-like
[01:51:57] <Thad> aatch: the Rust compiler on windows should eventually be a ... .exe ?
[01:52:58] <aatch> Thad, I'm not sure what you're getting at
[01:53:11] <Thad> aatch: I mean.. if I use the ming libraries (32 or 64 bit) then I should get native Windows output.... for Rust ?
[01:53:24] <aatch> Thad, maybe
[01:53:30] <aatch> What happens at the moment
[01:53:32] <aatch> ?
[01:53:38] <Thad> and not need or depend on MinGW or Cygwin after everything is compiled ?
[01:54:03] <aatch> Thad, you'd need one of them to supply a gcc-like linker
[01:54:04] <Thad> at the moment, on MinGW... I can compile Rust .5 with gcc
[01:54:35] <Thad> On Cygwin... everything is just... ERROR.  without lots of ifdef hell...for __CYGWIN__
[01:54:39] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:54:49] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[01:55:11] *** Joins: z0w0 (zack@moz-71B9A43D.lnse4.woo.bigpond.net.au)
[01:56:15] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[01:56:21] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[01:57:06] <aatch> Thad, what about MinGW64?
[01:57:20] <Thad> does it work ?
[01:57:34] <aatch> Thad, isn't that the end goal?
[01:57:45] <aatch> To get it running on MinGW64
[01:57:52] <Thad> yes... wait... do you mean MinGW-w64 ?
[01:58:01] *** Joins: cc (cc@moz-9962C9F4.rev.numericable.fr)
[01:58:08] <aatch> 64 bit version
[01:58:21] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[01:58:28] <aatch> I don't use windows so I don't know what things are called
[01:58:40] <Thad> link please ?
[01:58:54] <steven_is_false> I'm trying to compile bindings to glX but it doesn't seem to be going well. I'm invoking it like bindgen -l glx -o build/glx.rs -match glx.h /usr/include/glx.h -I /usr/include/linux and it's spitting out errors. Am I missing something?
[01:59:03] <aatch> Thad, I don't have a link...
[01:59:08] <aatch> I was asking you
[01:59:39] <aatch> I was informed that getting rust working on Cygwin was just a stepping stone to mingw64 support
[02:00:08] <aatch> steven_is_false, rust-bindgen is mostly broken I think
[02:00:22] <steven_is_false> aatch: oh.
[02:01:11] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:01:31] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:02:16] <dbaupp> aatch: I'm going to have a go at writing a basic writef! syntax extension, do you have any suggestions/ideas?
[02:02:51] <aatch> dbaupp, call out to the library as much as possible?
[02:02:56] *** Quits: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu) (Client exited)
[02:03:00] <aatch> in the generated ast
[02:03:15] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[02:03:19] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[02:03:31] <dbaupp> aatch: as in, .format_s(..), etc?
[02:03:37] <aatch> dbaupp, yep
[02:04:19] <dbaupp> ssbr: I was thinking, another reason for having re! as an syntax extension/macro is it gives compile time syntax checks/analysis of the regex
[02:04:19] <aatch> should 1, make the code itself nicer and 2, make the output of stuff like --pretty expanded a little more readable
[02:04:22] *** Quits: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu) (Ping timeout)
[02:04:24] <aatch> (though not much)
[02:04:28] <strcat> btw one of the problems with % is that it doesn't lend itself well to positional args
[02:04:34] <dbaupp> aatch: yup that reasonable
[02:04:34] <strcat> like {0}, {1}, {0}
[02:04:44] <strcat> which appears to be really, really important for i18n
[02:04:51] <dbaupp> strcat: the parser supports %{0}s / %{1}d
[02:05:00] <strcat> ah
[02:05:03] <aatch> strcat, we have %{1}s ${0}d
[02:05:05] <Thad> aatch: AH.. ok, so I think I have a better understanding... I HAVE TO cross compile first... configure: error: unsupported target triples "x86_64-w64-mingw32" found
[02:05:10] <strcat> aatch: what does d do?
[02:05:27] <dbaupp> strcat: generic integer
[02:05:44] <aatch> strcat, basically, 'd' is "as int", 'f' is as float and 's' is as string
[02:05:47] <Thad> aatch: and I have to do that with Msys and MinGW32
[02:06:05] <dbaupp> strcat: (and ? is "structural", as normal)
[02:06:06] <aatch> the reason for 'd' is that you can pass it things that make no sense with 's'
[02:06:20] <strcat> aatch: everything with a string representation can use s
[02:06:24] <strcat> works for python and other languages
[02:06:31] <aatch> so '%<16>d' is "as number with base 16"
[02:06:36] <strcat> yeah that makes sense
[02:06:41] <strcat> if you have modifiers specific to it
[02:06:50] <aatch> just bare '%d' would be identical to '%s' though
[02:08:00] <dbaupp> eurgh, I think I keep crashing rust with an OOM
[02:08:06] * dbaupp closes some programs
[02:08:31] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:08:41] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:08:54] <aatch> strcat, we did reduce the conversion list to 4 items, including '?'. 'd' and 'f' are there to handle stuff like base and precision.
[02:09:04] <strcat> aatch: yeah I think that's fine
[02:09:15] <strcat> I just really hate what it's like right now :) (fmt!)
[02:09:19] <dbaupp> aatch: should I indicate an error on %<16>s? (what about %<16>f? it makes sense for floats to be in other bases, right?)
[02:09:43] <aatch> dbaupp, there is precedent for floats in other bases
[02:10:02] <aatch> for 's', either error or ignore it
[02:10:17] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[02:10:21] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[02:10:24] <dbaupp> aatch: cool, also, I was thinking that ()'s might be nicer: %(16)d
[02:10:39] <dbaupp> aatch: I think I'll warn, for now
[02:10:52] <ssbr_> Having reliable internet sure would be great. Sorry.
[02:11:08] <aatch> if i set calc to base2(16) I get this: 1234.5678 /* 0x5e30a7/0x1388 */
[02:11:10] <ssbr_> dbaupp: a good point. I've added a section to the wiki page on API design
[02:11:44] <aatch> dbaupp, I kinda like the angle-brackets reminds me of Erlang bit syntax
[02:12:04] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[02:13:07] <dbaupp> aatch: presumably 10.5 = 'a.8' would the 'normal' output, rather than a fraction
[02:13:20] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[02:13:27] <aatch> dbaupp, yeah
[02:13:31] <dbaupp> aatch: ok, i'm fine with whatever... cosmetic changes are relative easy
[02:14:51] *** Quits: cc (cc@moz-9962C9F4.rev.numericable.fr) (Quit: cc)
[02:15:08] <steven_is_false> Hoorah! I've got bindgen working on glx.
[02:15:19] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:15:27] <dbaupp> steven_is_false: :D
[02:15:33] *** Joins: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu)
[02:15:37] <dbaupp> steven_is_false: did you have to patch it?
[02:15:42] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:15:58] <steven_is_false> dbaupp: No but I will. It uses reinterpret_cast instead of transmute_copy
[02:17:15] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[02:17:21] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[02:17:32] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[02:20:11] <Thad> aatch: libuv sees and uses winsock.c without problems using MinGW with gcc 4.5.2 ... it's a no brainer... I just need to get some helper scripts to do better HOST detection for Vista / Win7 / Win8 with Msys and then we're set...
[02:20:35] <Thad> so dropping Cygwin effort COMPLETELY.
[02:20:45] <aatch> Thad, ok then
[02:22:05] *** Quits: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net) (Quit: dbaupp)
[02:22:13] *** Joins: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net)
[02:22:47] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:22:50] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[02:23:30] *** Quits: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[02:25:11] *** Quits: catpig (catpig@moz-269D9D6D.dip0.t-ipconnect.de) (Quit: Verlassend)
[02:27:46] *** Joins: SiegeLord (sl@moz-56D7E78.bstnma.fios.verizon.net)
[02:31:43] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[02:32:06] *** Joins: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu)
[02:40:11] <steven_is_false> So, bindgen can't handle defines?
[02:40:22] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:40:22] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:42:05] *** Quits: reed (reed@tech.monkey) (Quit: So long, farewell, auf Wiedersehen, good night.)
[02:42:08] *** Joins: brson (brson@E9CDE21E.991753BB.CA4D1600.IP)
[02:42:08] *** ChanServ sets mode: +o brson
[02:45:02] <steven_is_false> I'll just use the cpp preprocessor
[02:46:10] <SiegeLord> It expanded macros just fine for me last time I tried it
[02:46:49] *** Joins: reed (reed@tech.monkey)
[02:47:56] *** Quits: zz_kimundi (kimundi@moz-1B78C5AF.dip0.t-ipconnect.de) (Ping timeout)
[02:48:20] *** Quits: Andrew (Mibbit@moz-91DB7BBE.cable.virginmedia.com) (Quit: http://www.mibbit.com ajax IRC Client)
[02:48:51] <aatch> dbaupp, for the conversions, do we want to write straight into a writer?
[02:49:17] <aatch> as the conversion is actually happening
[02:50:02] <steven_is_false> SiegeLord: So you did something like pub static GLX_VERSION_1_1 = GLX_VERSION_1_1; How did you get the right side to be evaluated but the right side not to?
[02:50:33] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[02:50:36] <SiegeLord> You can't bind C macros automatically
[02:51:03] *** Joins: zz_kimundi (kimundi@moz-FDD5BF22.dip0.t-ipconnect.de)
[02:51:10] <dbaupp> aatch: that's what I've implemented so far
[02:51:11] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:51:25] *** zz_kimundi is now known as kimundi
[02:52:30] <aatch> dbaupp, I mean, change the current conversion functions to write into a writer if possible, instead of returning a ~str or ~[u8]
[02:52:54] <aatch> Though I guess that interferes with padding and alignment
[02:54:32] <steven_is_false> If only cpp offered an option to to include the definitions in a file without including it in the actual output file.
[02:54:39] *** Quits: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu) (Client exited)
[02:55:03] <dbaupp> aatch: oh, for the moment I was just implementing it as an alternative to fmt, to see if it works
[02:55:33] <aatch> dbaupp, fair enough
[02:56:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:56:43] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[02:57:15] <steven_is_false> Welp thanks for all your help guys.
[02:57:17] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[03:16:54] <ssbr> man
[03:17:38] <ssbr> I hadn't read too deeply into the OBDD regexo stuff before writing the std re proposal. They have one algorithm that's really obvious in retrospect, and possibly _really_ useful for regexp related things, and I wish I knew about it earlier.
[03:18:11] <aatch> OBDD?
[03:18:17] <ssbr> ordered binary decision diagrams
[03:18:31] <ssbr> an efficient encoding of predicates / truth tables with quick manipulation
[03:18:35] <aatch> nice
[03:18:59] <ssbr> they use them to implement regexps, since the definition of a regexp can be stated in relational algebra
[03:19:17] <ssbr> and then they implement the remaining missing features, and they're like, "voila, efficient regexp implementation!"
[03:19:22] <ssbr> and it's like, what did you just do?
[03:19:44] <ssbr> the implementation of the remaining missing features is what interests me, since I hadn't seen it approached from this way before, and it might solve some problems I've run into in the past
[03:20:07] <aatch> Is that one of those "It's so simple I can't believe nobody though of it earlier" things?
[03:20:22] <ssbr> aatch: You know, I'm not sure
[03:20:32] <ssbr> it _is_ really simple to encode NFA simulation using OBDDs
[03:20:54] <ssbr> but OBDDs aren't popular outside of a few fields
[03:20:55] <dbaupp> aatch: I've got something very basic. just the minimum that I think might compile (without too much regard for style), but I've got to go so I can't test it.
[03:20:58] <dbaupp> aatch: https://gist.github.com/huonw/5519567
[03:21:12] <aatch> dbaupp, I'll give it a look
[03:21:23] <aatch> I just made a function for doing the field alignment
[03:21:25] <ssbr> I should really be saying ROBDDs
[03:21:34] <ssbr> (blah blah acronyms blah. everyone says BDDs anyway.)
[03:22:10] <dbaupp> aatch: (it requires adding rust-fmt as a submodule of core, and adding an empty "RTSpec" struct... just temporarily, since that was easier than thinking :P )
[03:22:11] <ssbr> anyway yeah, I need to find some time to quickly implement their stuff and figure out what parts of their approach might work really well in general
[03:22:23] <aatch> ROBDDs => Relatively Ordered Binary Decision Trees?
[03:22:44] <dbaupp> aatch: I haven't even run rustc on the file, so it's unlikely to compile
[03:22:47] <ssbr> reduced ordered binary decision diagram
[03:22:56] <dbaupp> aatch: anyway, gtg, talk later
[03:23:04] <aatch> dbaupp, see ya
[03:23:20] <ssbr> a binary decision diagram is a binary decision tree that ends in two decisions (true, false)
[03:23:29] <ssbr> and is generalized to a graph
[03:23:43] <ssbr> and then you make the decisions in a consistent order across any path (ordered), and then you collapse any redundancy (reduced)
[03:23:49] <ssbr> and then magically this data structure is super efficient
[03:23:54] <aatch> so makes sense for a regex, since it either matches or it doesn't
[03:24:08] <ssbr> aatch: right!
[03:24:17] <ssbr> aatch: except then how do you keep track of what parts of the regex matched what parts of the string?
[03:24:35] <ssbr> and then their answer, which surprised me, is "well, you don't. Just figure that out after the fact by path finding backwards through the NFA."
[03:25:19] <aatch> Making the assumption that the matching is the "slow" bit?
[03:25:57] <ssbr> I'm not really sure why this'd be any faster, actually, which is a thing that confuses me
[03:26:27] <ssbr> but it _is_ elegant, in that it lets you treat matching and submatch extraction separately, which is really good for some kinds of problems
[03:27:29] <ssbr> e.g. consider logical operators on regular languages: myregexp & myotherregexp. Performing these on tagged NFA is hard / unsolved problem. Performing these on NFA/DFA that aren't tagged is easy.
[03:27:50] <aatch> unfortunately, common usage of regexes pretty much requires submatch extraction of some kind
[03:27:57] <ssbr> so you can do logical operations on NFA/DFA arbitrarily, and then based on the results you can pull out which NFA and which DFA matched what
[03:28:15] <ssbr> so you get "for free" all the closure properties of NFA/DFA, but with submatch extraction added on
[03:28:39] <aatch> ssbr, so you take "(a)(b)(c)" and make 3 DFAs?
[03:28:47] <aatch> or NFAs
[03:28:52] <ssbr> aatch: nah nah, one NFA
[03:29:35] <ssbr> aatch: but if you intersect "(a)(b)(.)" and "(ab)c", you should get a regexp equivalent to "abc" where group 1 goes to "a", group 2 to "b", group 3 to "c", and group 4 to "ab"
[03:29:36] *** Quits: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Ping timeout)
[03:29:58] <ssbr> I found this unreasonably difficult using the Pike VM approach or Laurikari approach
[03:30:05] <ssbr> in that I didn't know how to do it at all
[03:30:26] <ssbr> but if you can pull matches separately, I think it becomes easy
[03:30:32] <ssbr> so that's neat
[03:30:44] <ssbr> (I might be wrong, I frequently think things are easy until I actually do them)
[03:31:05] <aatch> Right, because '|' in a regex is essentially just intersection?
[03:31:13] <ssbr> nah, union
[03:31:22] <aatch> Oh right
[03:31:34] * aatch always mixes up set-theory terms
[03:31:34] <ssbr> PCRE regexes don't have an intersection operator, for a bunch of reasonably good reasons
[03:31:50] <ssbr> except they do have assertions, which are like intersection sort of but not really
[03:32:25] <ssbr> but yeah, union works perfectly
[03:32:50] <ssbr> it's just the other operators that are surprisingly difficult depending on how you approach things (complement, intersection)
[03:34:50] <ssbr> I dunno. I've added a bunch more stuff to https://github.com/mozilla/rust/wiki/Lib-re
[03:35:03] <strcat> ssbr: what does re2 do? afaik they provide the linear complexity guarantee and it's still fast for common regexp
[03:35:05] <ssbr> I was pretty happy earlier this year when I found a generalization of Boyer-Moore that works on regexps
[03:35:44] <ssbr> strcat: they do thompson NFA with submatch extraction; O(nm) time and O(m) space
[03:36:05] <strcat> do they use that for non-pathological regexp too?
[03:36:10] <ssbr> yes
[03:36:38] <ssbr> strcat: there is a special category of especially non-pathological regexp, for which it uses a trivial linear scan
[03:36:45] <ssbr> which is faster than backtracking search
[03:37:13] <ssbr> but there's still regexps that are faster for backtracking search than RE2, because the overhead of NFA simulation is less than the overhead of backtracking a few times
[03:39:04] <ssbr> errrr, rather, the overhead of NFA simulation is more. :)   this was a complaint brought up earlier today.
[03:39:52] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[03:40:01] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[03:40:55] <Thad> how do I cross compile ??  http://pastebin.mozilla.org/2375934
[03:42:04] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:42:22] <aatch> Thad, doesn't look like it's getting the build path properly
[03:44:06] <Thad> aatch: ??? how can that be ?  it MADE the build path folder !!  C:\MinGW\msys\1.0\home\Thad\rust\x86_64-w64-mingw32  just fine and dandy...
[03:45:10] <aatch> Well the fact that it's trying to build /rustc.exe and not x86_64-w64-mingw32/stage0/bin/rustc.exe is likely the issue
[03:46:54] *** strcat is now known as thestinger
[03:47:15] * thestinger tries channel 1 instead of 11
[03:47:27] <thestinger> my neighbour's router is evil
[03:47:34] <Thad> aatch: well, I copied the config for i686 in the platform.mk ... does it need even more ? http://pastebin.mozilla.org/2375935
[03:47:35] <thestinger> has a super strong signal and seems to follow mine around...
[03:48:11] <aatch> thestinger, maybe your neighbour is doing it deliberately
[03:48:22] <thestinger> doubt it, they're out of the country ;p
[03:48:37] <thestinger> they spend half the year in france/argentina
[03:48:47] <thestinger> house has been robbed twice this year...
[03:49:15] <thestinger> anyway, as you may have noticed my wifi is terrible today ;p
[03:49:31] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:49:39] <aatch> Thad, no idea sorry
[03:50:34] <Thad> aatch: OK... back to .mk files I go...hunting.
[03:52:44] *** Joins: pseudoku (quassel@7E205F66.5B86C286.C28326FD.IP)
[03:52:48] *** Joins: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu)
[03:55:13] <pseudoku> What are the changes required in the runtime to allow rust functions to be called from a c function in a foreign thread (not created by rust runtime)?
[03:55:29] <aatch> pseudoku, technically none
[03:55:43] <aatch> But you can't use any features that require the runtime
[03:56:48] <pseudoku> aatch: and if i wanted to use the runtime features (at the very least communicating with other rust tasks with pipes)?
[03:57:03] *** Quits: akashj87_ (akash@3BD52CA6.D8B89461.35E3DDC8.IP) (Quit: Leaving)
[03:57:05] <aatch> pseudoku, that requires starting up the runtime.
[03:57:15] <aatch> Which is possible.
[03:58:01] <pseudoku> aatch: by starting up, do you mean creating a scheduler and task object or a new kernel?
[03:58:10] <aatch> kernel
[03:58:53] <aatch> you can call the built-in rust_start.
[03:59:40] <aatch> rust_start(main as *c_void, argc as c_int, argv, crate_map as *c_void) as int;
[04:00:06] <pseudoku> aatch: forgive me if this is obvious, but why do we need a new kernel, why can't we use the existing one and just create a dummy scheduler+task attached to the foreign thread?
[04:00:37] <aatch> because it also starts up the garbage collector and a bunch of other resources.
[04:01:10] <aatch> If there is already a kernel running, you /might/ be able to start up a new scheduler
[04:01:46] <aatch> I was assuming that you were thinking of embedding rust in some other environment.
[04:04:23] <aatch> Looks like the borrow checker has had quite a bit of improvement since the last snapshot
[04:04:54] <pseudoku> aatch: ok...let me explain what i'm trying to acheive. i am trying to write a binding for jackd, a real-time audio engine...the problem is jackd creates its own thread and executes a c callback function that the client provides in the new thread...this callback is executed by jackd whenever it needs more audio samples....I want to be able to use rust tasks to do the processing of audio samples in the callback
[04:05:37] <aatch> hmm, interesting
[04:06:11] <pseudoku> Apart from the non-real-time nature of rust runtime, i not sure how to callback into rust from the jack thread
[04:06:37] <pseudoku> and still use the tasks + other runtime features
[04:06:39] <aatch> Can you get the thread id or something?
[04:06:52] <pseudoku> aatch: let me check
[04:07:33] <pseudoku> aatch: yes...it is possible to retrieve the thread id
[04:08:09] <aatch> Ok, let me poke around the runtime code
[04:09:12] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[04:16:47] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Ping timeout)
[04:19:04] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (Quit: WeeChat 0.4.0)
[04:23:11] <aatch> pseudoku, how much control do you have over the thread jackd creates?
[04:27:03] <pseudoku> aatch: not much...but there is an api call that allows the client to override the thread creation function,,,but it is only used by WINE and the documentation warns against using it in normal clients
[04:28:15] *** Joins: SimonSapin (simon@moz-C4A83ED9.net-89-2-126.rev.numericable.fr)
[04:28:19] <aatch> The problem is that you need to have all the correct settings
[04:28:27] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[04:28:39] <aatch> for one, having enough space for thread-local storage
[04:29:00] <pseudoku> aatch: and I would like a generalized solution since other audio apis like portaudio also create their own thread 
[04:30:51] *** Quits: sp3d (a@moz-17CB39F1.fidnet.com) (Client exited)
[04:32:06] <pseudoku> aatch: this is the function that the clients can override : http://jackaudio.org/files/docs/html/group__ClientThreads.html#ga7f6e4000dad24f6742ecca4d9efa1b5a
[04:34:26] <aatch> pseudoku, currently, the use case is actually similar. The rust runtime needs to know about all threads that are doing rust stuff.
[04:35:47] *** Joins: sp3d (a@moz-17CB39F1.fidnet.com)
[04:35:53] <aatch> I mean, I'm still not sure if it's possible, but its certainly easier
[04:37:05] <pseudoku> right...but how would the scheduler/task created for the new thread interact with the kernel (in regards to lifetime, garbage collection and pipes)? 
[04:37:49] <aatch> Well if the kernel knows about it, then it should work.
[04:39:46] *** Quits: thestinger (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:40:05] <pseudoku> aatch: Go already has bindings for portaudio, and cross-thread callbacks seam to work http://code.google.com/p/rog-go/source/browse/exp/callback 
[04:40:14] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:40:52] <aatch> pseudoku, theres no technical reason other than the current code doesn't support it.
[04:41:32] <aatch> Making the current code support it isn't worth it because the scheduler is being re-written at the moment
[04:42:25] *** Quits: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu) (Client exited)
[04:44:21] <pseudoku> aatch: so are there any plans on exposing apis to allow the scheduler to attach to existing threads? and will the new scheduler allow embedding rust as you mentioned before?
[04:44:34] <aatch> pseudoku, ideally.
[04:46:22] <pseudoku> aatch, thanks for the help
[04:47:45] *** Quits: cdidd (cdidd@moz-5318450.broadband.corbina.ru) (Input/output error)
[04:50:26] <aatch> pseudoku, some of the new scheduler is in incoming and seems to be working code.
[04:50:58] <pseudoku> aatch, great! i'll check it out. Thanks
[04:55:18] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[04:56:06] *** Joins: thestinger (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:56:11] <yichoi> hmm tidy failed
[04:56:15] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:57:20] *** Quits: igl (igl@moz-80E26D1D.adsl.alicedsl.de) (Ping timeout)
[04:57:28] *** Joins: igl (igl@moz-289A4E28.adsl.alicedsl.de)
[05:04:33] *** Joins: akashj87 (akash@DC02D734.2921AF61.35E3DDC8.IP)
[05:06:23] <yichoi> i pushed new commit to exited pull request which failed on test
[05:07:44] <yichoi> can "@bors: retry" comment trigger to retry ?
[05:08:11] <thestinger> if it's by one of the people added as repo collaborators
[05:08:28] <thestinger> it won't work if there's a new commit though
[05:08:32] <thestinger> needs to be r+'ed again
[05:08:52] <thestinger> yichoi: which pull request?
[05:08:55] *** Quits: SiegeLord (sl@moz-56D7E78.bstnma.fios.verizon.net) (Quit: It's a joke. It's all a joke.)
[05:09:17] <yichoi> https://github.com/mozilla/rust/pull/6234
[05:10:26] <thestinger> yichoi: r+'ed :)
[05:11:07] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:11:07] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d816101 to 14d74ac9e: 02http://git.io/N3iJvQ
[05:11:07] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:11:07] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:11:07] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/fNaQbg
[05:11:07] <ghrust> 13rust/06auto 147ac6571 15Young-il Choi: rt: glob, globfree dummy function for android
[05:11:08] <ghrust> 13rust/06auto 14987ad9c 15Young-il Choi: rt: rust_android_dummy.cpp fix for make tidy
[05:11:08] <ghrust> 13rust/06auto 1429a2a1e 15bors: auto merge of #6234 : yichoi/rust/glob-dummy-pull, r=thestinger...
[05:11:10] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:11:27] *** thestinger is now known as strcat
[05:11:56] <yichoi> oh i got it
[05:12:07] <yichoi> thanks thestinger
[05:12:33] <yichoi> you now strcat
[05:12:42] <strcat> usually strcat on irc
[05:13:25] <strcat> my wifi is acting up and I accidentally /nick'ed wrong after it renamed me to strcat1 ;p
[05:14:22] <yichoi> oh you are. unfortunately I cannot fully focus on irc. sometimes i confused about you stinger or strcat :)
[05:15:31] * strcat is apparently confused too :)
[05:17:11] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:17:25] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130430204233])
[05:29:26] *** Quits: brson (brson@E9CDE21E.991753BB.CA4D1600.IP) (Ping timeout)
[05:33:51] *** Joins: brson (brson@E02A6CDD.75598729.B6A3AE99.IP)
[05:33:51] *** ChanServ sets mode: +o brson
[05:37:08] <aatch> I didn't realize there was a new snapshot!
[05:39:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[05:40:02] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[05:40:46] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[05:44:26] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[05:52:41] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Client exited)
[05:54:14] *** Joins: RagingDave (RagingDave@moz-3F31ACEF.pools.arcor-ip.net)
[05:55:35] <aatch> dbaupp, ping
[05:56:53] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[05:57:55] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz)
[06:02:08] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:02:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/fNaQbg
[06:02:08] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:03:14] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[06:08:47] <strcat> heh, the python libgit2 binding has use-after-free issues
[06:08:49] <strcat> ;\
[06:10:21] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130430204233])
[06:11:17] *** Quits: sp3d (a@moz-17CB39F1.fidnet.com) (Client exited)
[06:11:24] *** Quits: companion_cube (simon@moz-F48A362B.cedeela.fr) (Ping timeout)
[06:11:30] *** Joins: sp3d (a@moz-17CB39F1.fidnet.com)
[06:14:05] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.0)
[06:14:41] *** Joins: companion_cube (simon@moz-F48A362B.cedeela.fr)
[06:15:28] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[06:17:28] *** Quits: dymk (dymk@44EEE21C.A6E21E6E.5E500FC7.IP) (Ping timeout)
[06:20:21] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[06:25:57] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[06:26:07] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:27:20] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[06:27:36] *** Quits: brson (brson@E02A6CDD.75598729.B6A3AE99.IP) (Quit: leaving)
[06:27:50] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[06:31:22] *** Quits: RagingDave (RagingDave@moz-3F31ACEF.pools.arcor-ip.net) (Quit: Ex-Chat)
[06:31:34] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[06:31:34] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[06:33:17] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:43:41] *** Joins: boggle (boggle@moz-BCEB49E4.dip0.t-ipconnect.de)
[06:45:15] *** Joins: Nuigurumi (Mibbit@moz-9B13EB25.tokyo.ocn.ne.jp)
[06:45:22] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[06:46:34] <Nuigurumi> Are there sets in Rust, similar to Python's `set`?
[06:46:50] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[06:46:54] <aatch> Nuigurumi, as in "no duplicates" set?
[06:47:50] <Nuigurumi> set of unique elements, with operations like "union", "intersection" and stuff like that
[06:48:26] <aatch> Nuigurumi, HashSet: http://static.rust-lang.org/doc/core/hashmap.html#struct-hashset
[06:49:33] <Nuigurumi> Thanks, will go look...
[06:51:43] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[06:54:50] *** Quits: blitter (blitter@moz-7C98731E.dyn.centurytel.net) (Ping timeout)
[06:55:32] *** Joins: jaen (jaen@moz-9FF4C560.play-internet.pl)
[06:57:14] *** Quits: jaen (jaen@moz-9FF4C560.play-internet.pl) (Ping timeout)
[06:57:20] *** Joins: dymk (dymk@44EEE21C.A6E21E6E.5E500FC7.IP)
[06:57:54] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[06:58:31] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[07:00:16] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[07:00:41] <Nuigurumi> is there an example somewhere on how to use that thing?
[07:02:31] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:05:02] *** Quits: z0w0 (zack@moz-71B9A43D.lnse4.woo.bigpond.net.au) (Quit: Leaving.)
[07:05:49] *** Joins: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com)
[07:06:56] <Nuigurumi> Found some examples here: https://github.com/mozilla/rust/issues/1964
[07:07:01] <Nuigurumi> but they don't compile
[07:07:15] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[07:12:02] <dymk> Does Rust have a Pair type, a-la C++'s std::pair<>?
[07:12:29] <Nuigurumi> a tuple won't do?
[07:12:32] <eevee> is that like http://static.rust-lang.org/doc/0.6/core/either.html ?
[07:12:43] <eevee> oh, nm.  yes use a tuple
[07:12:52] <dymk> oh a tuple will do just fine, but it makes the code more readable
[07:13:08] <Nuigurumi> it isn't necessarily a pair, though
[07:13:26] <eevee> std::pair<A, B> is more readable than (A, B)?
[07:13:40] <dymk> eevee: when understanding what the code is doing, a bit, yeah
[07:14:18] <Nuigurumi> Is this code some older obsolete syntax? https://github.com/mozilla/rust/issues/1964
[07:14:32] <Nuigurumi> My rustc doesn't seem to understand 'import' statement...
[07:14:47] <dymk> it's old syntax, yes
[07:14:52] <dymk> when rust had import/export
[07:15:28] <Nuigurumi> so just how do I create a HashSet of, say, integers with the modern syntax?
[07:16:58] <dymk> "use std::map" instead of import
[07:17:17] <dymk> that should be after "extern mod std;" too
[07:17:40] <Nuigurumi> not 'core::hashmap'?
[07:18:02] <dymk> oh sorry, yeah core::hashmap
[07:18:19] <dymk> no need to use "extern mod std;" if it's in core
[07:19:32] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:19:42] <dbaupp> Nuigurumi: what version of rust are you using?
[07:20:10] <Nuigurumi> I think it's 0.6. On Windows.
[07:21:24] *** Quits: philix (philix@moz-451739D3.user.veloxzone.com.br) (Quit: philix)
[07:21:44] <dymk> Is anyone here familiar with the haar transform? 
[07:22:02] <dymk> I've gotten a working implementation, but I'm lost on why it works/what parts of it mean
[07:22:18] <dbaupp> Nuigurumi: https://github.com/mozilla/rust/blob/1e91595520d0538e6003dc9186f1b0df5c25b77a/src/test/bench/core-set.rs
[07:22:49] <dbaupp> Nuigurumi: Specifically, https://github.com/mozilla/rust/blob/1e91595520d0538e6003dc9186f1b0df5c25b77a/src/test/bench/core-set.rs#L161
[07:22:59] <dbaupp> and the bench_int function
[07:24:00] *** Joins: LQDH (andrew@moz-91DB7BBE.cable.virginmedia.com)
[07:24:00] <dbaupp> (the only `use` statement you need is the core::hashmap::linear one, and you don't need to `extern mod std` either.)
[07:25:05] <dbaupp> Nuigurumi: there's documentation about LinearSet here http://static.rust-lang.org/doc/0.6/core/hashmap_linear.html
[07:25:15] <dbaupp> Nuigurumi: and the 'set' methods are here http://static.rust-lang.org/doc/0.6/core/container.html#trait-set
[07:25:26] <dbaupp> aatch: I'm back!
[07:26:40] <dbaupp> aatch: is the copy of writef.rs that I have still the latest one?
[07:28:19] *** Joins: int3_ (int3_@moz-1692740B.subnet-248.amherst.edu)
[07:28:23] <Nuigurumi> I'll be damned.... this looks even scarier than Haskell...
[07:29:12] <dbaupp> Nuigurumi: unfortunately it is a bit that way at the moment... lack of clear documentation is hurting :(
[07:29:52] <dbaupp> (FWIW, the LinearSet thing has been renamed to the more sensible HashSet for 0.7)
[07:30:52] *** Quits: reed (reed@tech.monkey) (Quit: So long, farewell, auf Wiedersehen, good night.)
[07:31:30] <Nuigurumi> Oh, so the documentation on HashSet somebody gave me a link to was for the newer version and I can't possibly use it with 0.6? :)
[07:31:52] <dbaupp> Yup
[07:32:33] <joshua_> hmm ... so, I have an |enum Foo { F_a, F_b, F_c, F_d }|; I can |F_a as u8|, but I can't |0u8 as Foo|.  This seems unusual to me.
[07:32:50] <dymk> does Rust have a priority_queue implementation?
[07:33:05] <joshua_> dymk, it sure does!  it's called priority_queue!
[07:33:11] <dymk> woohoo! it's in std too
[07:33:22] <dymk> that's why I didn't find it at first :P
[07:33:38] <joshua_> use std::priority_queue::*; let mut q : PriorityQueue<YourThing> = PriorityQueue::new();
[07:34:19] <dbaupp> joshua_: what happens for `5u8 as Foo`? (That unsafe-ty is the reason it doesn't work)
[07:34:35] <joshua_> aha, yeah.
[07:34:44] <dbaupp> joshua_: have you optimised the router any more?
[07:34:54] <joshua_> I'm doing so now :-)
[07:35:02] <dbaupp> cool :)
[07:35:04] *** Joins: reed (reed@tech.monkey)
[07:35:29] <joshua_> so let's see, how would I unsafely cast that?
[07:35:54] <dbaupp> joshua_: um... cast::transmute might work
[07:36:18] <dbaupp> rusti: enum A { A, B, C } cast::transmute::<u32, A>(2)
[07:36:22] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/NDEL
[07:36:34] <dbaupp> rusti: enum A { A, B, C } unsafe { cast::transmute::<u32, A>(2) }
[07:36:35] <rusti> line longer than 100 columns, pastebinned: http://sprunge.us/jRVg
[07:36:44] <dbaupp> rusti: enum A { A, B, C } unsafe { cast::transmute::<u64, A>(2) }
[07:36:46] <rusti> C
[07:36:54] <joshua_> now we're cookign with gas.  okay.
[07:36:56] <dbaupp> rusti: enum A { A, B, C } unsafe { cast::transmute::<u64, A>(0) }
[07:36:57] <rusti> A
[07:37:10] <joshua_> and now for the real question of the day --
[07:37:15] <joshua_> rusti: enum A { A, B, C } unsafe { cast::transmute::<u64, A>(3) }
[07:37:16] <dbaupp> joshua_: it might be better to just use static constants
[07:37:17] <rusti> line longer than 100 columns, pastebinned: http://sprunge.us/QVZA
[07:37:39] *** Quits: heftig (heftig@moz-DDD67C1.dip0.t-ipconnect.de) (Ping timeout)
[07:38:15] *** Joins: heftig (heftig@moz-AD47C876.dip0.t-ipconnect.de)
[07:40:08] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[07:40:29] <joshua_> ha --
[07:40:30] <joshua_> router.rs:130:44: 130:45 error: No rules expected the token: {
[07:40:30] <joshua_> router.rs:130 macro_rules! Direction(($e: expr) => unsafe { cast::transmute::<uint, Direction>(($e) as uint) })
[07:40:30] <joshua_>                                                           ^
[07:40:38] <joshua_> "error: Nobody expected the Spanish inquisition!"
[07:41:12] <dbaupp> joshua_: I think you might need `=> { unsafe ... }`, maybe
[07:41:27] <joshua_> => ( unsafe { ... } )
[07:41:34] <joshua_> I was just mostly amused by the error
[07:41:46] *** Joins: doener (doener@moz-724BBC7C.unitymediagroup.de)
[07:42:20] <dbaupp> joshua_: also, I got fract2 down to 0.9s (from 1.1s) by macro-ising cost and pushc (and #[inline(always)]ing go) in router
[07:43:19] <joshua_> yeah, I'm using primary1 as my benchmark; I shaved 1 second (30.6s -> 29.5s) with inlining go, and then just shaved another second by turning the Direction vector into a u8
[07:43:42] <dbaupp> ooh nice
[07:45:19] <joshua_> I assume there isn't a 'newvar' that I can use in a macro?
[07:45:27] *** Quits: dymk (dymk@44EEE21C.A6E21E6E.5E500FC7.IP) (Quit: Leaving)
[07:45:46] <joshua_> i.e., macro_rules! cost(($c: expr) => ({let ___c = $c; grid.costs[___c.layer][___c.y][___c.x])});
[07:46:13] <joshua_> well, with one of those )s shifted, but yeah
[07:46:31] <Nuigurumi> I've finally succeeded in creating a set... Now to my next adventure - finding out how to iterate over it!... :)
[07:46:56] <joshua_> another half a second by doing that
[07:47:02] <dbaupp> joshua_: yeah
[07:49:41] *** Joins: berak (chatzilla@222E4CB8.FE11524D.16E13E53.IP)
[07:49:44] <joshua_> oh wow, kaboom
[07:49:52] <joshua_> I macroized that, and --
[07:49:53] <joshua_> joshua@bruges:~/school/coursera/vlsicad/assn4$ rustc -O router.rs
[07:49:53] <joshua_> Assertion failed: (getOperand(0)->getType() == cast<PointerType>(getOperand(1)->getType())->getElementType() && "Ptr must be a pointer to Val type!"), function AssertOK, file /Users/joshua/rust/rust-0.6/src/llvm/lib/VMCore/Instructions.cpp, line 1062.
[07:49:53] <joshua_> Abort trap: 6
[07:50:32] <dbaupp> Nuigurumi: .each :) (The BaseIter trait is impl'd for LinearSet)
[07:51:01] <dbaupp> joshua_: I got that when I used some macro variables without being parenthesised
[07:51:01] <aatch> dbaupp, hey, sorry was eating
[07:51:09] <dbaupp> aatch: np :)
[07:51:16] <aatch> And no, it's not
[07:51:27] <aatch> I managed to integrate everything into rustc though
[07:51:36] <aatch> Haven't tested anything, but it compiles
[07:51:38] <joshua_> that is moderately exciting, to be sure
[07:52:06] <Nuigurumi> I've found .each. But do I have to pass a function there, or can I just do stuff inside the curly braces somehow?
[07:52:34] <joshua_> indeed, if I let-bind all the variables on the way in, it does not detonate like that
[07:53:10] <dbaupp> aatch: :D
[07:53:26] <dbaupp> can you push to your fork of rust? :)
[07:53:32] <aatch> https://github.com/Aatch/rust/tree/new-fmt
[07:53:37] <joshua_> macroing pushc, another half second
[07:53:46] <dbaupp> joshua_: :)
[07:54:14] <dbaupp> Nuigurumi: for set.each |elem| { do stuff with elem }
[07:55:49] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[07:56:07] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:56:11] <joshua_> I guess flattening the three-coord system is probably what I want to do
[07:56:51] <aatch> dbaupp, output from writef!(writer, "%s", "Test") ->  { "Test".format_s(writer, ::core::fmt::RTSpec{,}); };
[07:57:46] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzzZZZzzz)
[07:58:24] <dbaupp> aatch: ah... it's annoying how empty structs are special-cased
[07:58:33] <dbaupp> but otherwise :D
[07:58:49] <aatch> dbaupp, yeah. It actually needs the new snapshot though
[07:58:51] <dbaupp> joshua_: sounds good... cache friendliness, etch
[07:59:05] <joshua_> yes
[07:59:29] <aatch> Because old borrow checker couldn't handle the Parser apparently
[07:59:37] <Nuigurumi> Is there a way to initialize LinearSet with a list literal?
[07:59:40] <dbaupp> aatch: oh, nice
[08:00:28] <aatch> dbaupp, as for your code, it didn't take much to get it to compile, a few wrong paths and typos, but otherwise fine
[08:01:38] *** Quits: RMF (RMF@moz-90B282A.dsl.telepac.pt) (Ping timeout)
[08:02:20] <dbaupp> aatch: yay
[08:02:37] <aatch> Although I may have hit a rustc bug
[08:02:46] <dbaupp> aatch: oh?
[08:02:59] <aatch> for Error, it kept complaining that it wasn't a struct
[08:03:06] <aatch> inside the pattern
[08:03:19] <aatch> I replaced it with just a _ for the moment
[08:03:52] <dbaupp> aatch: there was possible a pull request very recently about enums and structs that may've broken that
[08:03:58] <dbaupp> :(
[08:04:11] <aatch> https://gist.github.com/Aatch/5ab3272e4d95fdcdd5e5
[08:05:01] <dbaupp> aatch: that's pretty nice... does it compile?
[08:05:18] <dbaupp> (I've got a fix for the RTSpec {,} silliness)
[08:05:31] <aatch> dbaupp, nope
[08:05:40] <aatch> weird error though
[08:05:49] <aatch>  too few arguments to writef!
[08:06:01] <dbaupp> oh... :(
[08:06:02] *** Quits: quvarxa (chatzilla@moz-C9831B8C.lns20.adl2.internode.on.net) (Ping timeout)
[08:06:29] <aatch> Oh actually
[08:06:33] <aatch> thats expected
[08:06:38] <aatch> I changed a thing
[08:06:44] <dbaupp> (I'm compiling a version with writef! atm...)
[08:08:16] <dbaupp> I'm not sure how positional arguments should work with argument counts... should it be if there is any [x] or {x}, then every format requires that?
[08:08:26] *** Quits: Mowah (Mowah@moz-59D1A475.cust.bredbandsbolaget.se) (Ping timeout)
[08:09:29] <aatch> Well I think the idea is that each specifier advances to the next argument.
[08:09:52] <aatch> But setting {0} overrides that
[08:10:10] *** Quits: Nuigurumi (Mibbit@moz-9B13EB25.tokyo.ocn.ne.jp) (Quit: http://www.mibbit.com ajax IRC Client)
[08:10:26] <aatch> so '%{0}d %s' would do the same argument twice?
[08:10:42] <aatch> Or is that too confusing?
[08:11:03] *** Quits: boggle (boggle@moz-BCEB49E4.dip0.t-ipconnect.de) (Ping timeout)
[08:11:17] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[08:11:20] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[08:11:28] <dbaupp> aatch: yeah... that's what I wasn't sure about
[08:11:34] * dbaupp tests other languages
[08:11:42] <aatch> dbaupp, it doesn't compile atm because the format impls aren't public...
[08:12:05] <dbaupp> >>> '{0} {}'.format(1, 2)
[08:12:08] <dbaupp> ValueError: cannot switch from manual field specification to automatic field numbering
[08:12:19] <dbaupp> (python)
[08:12:25] <aatch> I gathered
[08:12:40] <aatch> Makes sense, so when you see a manual number, they all have to be from then on
[08:13:04] <aatch> '%s %s %{1}s' => 0 1 1
[08:13:17] <aatch> '%s %s %{1}s %s' => error
[08:14:15] <joshua_> hrm, this surprises me --
[08:14:25] <dbaupp> aatch: >>> '{} {0}'.format(1) gives the same error
[08:14:54] <aatch> I'd say that automatic until the first manual is reasonable though
[08:15:16] <aatch> since we can be fairly certain which ones they want until then
[08:15:24] <dbaupp> Yes that seems reasonable
[08:15:37] <joshua_> rusti: struct Silly<T> { data: ~[T], scale: int }; impl<T: Const> Silly<T> { fn get(&self, n: int) -> T { self.data[self.scale * n] } }
[08:15:38] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/ZBhX
[08:15:43] <dbaupp> aatch: similar for '%s %[0].[1]d'?
[08:16:07] <aatch> Yeah, keep things consistent
[08:16:14] <joshua_> I am surprised by the result there; since T: Const, I shouldn't *need* to copy out, no?
[08:16:14] <dbaupp> joshua_: ownership semantics!
[08:16:16] <aatch> though [*] will still be automatic
[08:16:25] <joshua_> but T: Const, it has no ownership?
[08:16:39] <dbaupp> joshua_: self.data is owned
[08:16:56] <joshua_> yes, but I'm indexing into it...?
[08:17:14] <joshua_> I guess I need T: Copy; I assume 'copy' on a u32 is painless?
[08:17:18] <dbaupp> rusti: struct Silly<T> { data: ~[T], scale: int }; impl<T: Const> Silly<T> { fn get(&self, n: int) -> T { match *self { Silly{data, scale} => data[scale * n] } } }
[08:17:19] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/DYTh
[08:17:19] <aatch> dbaupp, though would '%s %[0].[1]d', would the 'd' be argument 1?
[08:17:47] <dbaupp> joshua_: that might work
[08:17:53] <joshua_> sigh, oh well, okay
[08:18:03] <dbaupp> aatch: ... "error: ambiguous pattern" ?
[08:18:06] <dbaupp> (I'm not sure how to handle it)
[08:21:31] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Quit: boggle)
[08:21:38] <aatch> dbaupp, so only "%?" compiles
[08:21:47] <aatch> but it compiles
[08:23:52] <dbaupp> aatch: https://gist.github.com/huonw/5520112
[08:24:05] <dbaupp> (at the bottom)
[08:24:32] <aatch> cool
[08:24:37] <aatch> I thought that might be it
[08:25:02] <dbaupp> (it complains about borrowed values if I don't save stdout, we should do that to stop evaluating the writer multiple times, and the last line fails because of incorrect number of arguments)
[08:26:37] <aatch> We'll need a different specifier for the built-in format strings
[08:26:42] <joshua_> wow 1.35 seconds from flattening (and this even without any memory swizzling)
[08:28:22] <aatch> would having the format traits just take 3 arguments, flags, width and precision be enough?
[08:29:01] <aatch> would mean you don't need another struct too
[08:30:23] *** Joins: RMF (RMF@moz-90B282A.dsl.telepac.pt)
[08:31:27] <dbaupp> aatch: yes
[08:31:29] <dbaupp> probably
[08:31:39] <joshua_> and removing the safety check around the 'get' saved me .3 seconds, though I think I'll keep it with the safety (it's not worth the heartburn when I inevitably get it wrong)
[08:32:19] <aatch> would certainly make implementing the traits themselves easier
[08:32:25] <aatch> for us and end-users
[08:32:39] <dbaupp> aatch: yes
[08:32:48] <joshua_> dbaupp, anyway, a 15% speedup is nothing to sneeze at -- now to go after the algorithmic bits ;)
[08:32:53] <dbaupp> joshua_: :D
[08:33:12] <dbaupp> joshua_: there are also unsafe_get and unsafe_set functions for vector access without bounds checks
[08:33:35] <dbaupp> joshua_: (although branch prediction (I guess) has meant I've never seen a speed up from using them)
[08:33:50] <joshua_> yeah, though now they are called vec::raw::get; that's what saved me .3 seconds
[08:34:18] <dbaupp> joshua_: oooh
[08:34:44] <joshua_> (that's about .9%)
[08:36:11] *** Parts: berak (chatzilla@222E4CB8.FE11524D.16E13E53.IP) ()
[08:36:28] <joshua_> this brought runtime on industry1 down to 236s, which is extremely respectable
[08:38:33] <dbaupp> joshua_: what was it before? 300 or so?
[08:38:52] <joshua_> yeah
[08:39:01] <dbaupp> do you have any comparisons with other people's versions?
[08:39:49] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:40:17] *** Quits: Diablo-D3 (diablo@moz-20613698.port.east.myfairpoint.net) (Ping timeout)
[08:40:19] <joshua_> so, a bunch of it is algorithmic, too
[08:40:49] <joshua_> there are quite a lot of optimizations you can do in the mechanism to get better results faster
[08:41:10] <aatch> dbaupp, do you know how an enum variant expression is built in syntax::ext::build?
[08:41:23] <dbaupp> aatch: yes, give me a sec
[08:41:25] *** Joins: Diablo-D3 (diablo@moz-20613698.port.east.myfairpoint.net)
[08:41:31] <dbaupp> (I "know")
[08:41:42] *** Quits: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com) (Connection reset by peer)
[08:41:55] <dbaupp> it's actually just a function call
[08:41:59] <dbaupp> build::mk_call
[08:43:42] <dbaupp> (unless it's a struct variant, in which case mk_struct_e/mk_global_struct_e)
[08:44:23] <dbaupp> aatch: actually, maybe build::mk_call_global is required, if it's no locally definited
[08:44:25] <dbaupp> *defined
[08:44:53] <joshua_> 187s with this guy's C++/Qt (???) implementation ('on a two year old laptop'); 90 minutes on primary1 in Ruby (30s for us); 5400sec in Python (limited to 30s per net); some C++ impls in 214s (Pentium D @ 2.8GHz); 240 sec from the staff with a comparable algorithm to mine (Core2 Duo @ 2.26GHz)
[08:45:36] <joshua_> one fellow runs industry1 in 80 seconds (!!) on a Core i3 @ 3.30GHz
[08:45:42] <dbaupp> joshua_: ah, so algorithms are your next step?
[08:45:55] <dbaupp> (also, 90 minutes!!)
[08:46:15] <dbaupp> is the 80s person C++?
[08:46:19] <joshua_> yes, as I always say, microoptimize first such that the code is unmaintainable, and then you won't have to macrooptimize
[08:46:40] <joshua_> yes, a heroic 227 lines of C++
[08:47:23] <dbaupp> joshua_: of course, who wants the big gains of macrooptimisation when you can gain a percent here and there? :P
[08:47:41] <dbaupp> joshua_: shorter than yours :P
[08:48:01] <joshua_> yes, hence heroic
[08:48:27] <dbaupp> is it 4 statements per line?
[08:48:45] <joshua_> could be
[08:48:52] <joshua_> "My implementation, for comparison: C++, 227 lines (with some comments and various asserts). Runs industry1 in 80 seconds on a Core i3 @ 3.30GHz, or 95 seconds on a Core i5 @ 2.30GHz."
[08:49:06] <joshua_> (the same fellow said "I am also eager to do something in Rust, but had no chance yet.")
[08:49:50] <aatch> I managed to make Rust one line of code.
[08:49:58] <aatch> 400,000,000,000 characters long
[08:50:23] <joshua_> Yeah.  Given that this fellow said that they had comments and asserts, I'd imagine that the style has at least a modicum of sanity.
[08:50:36] *** Joins: quvarxa (chatzilla@moz-C9831B8C.lns20.adl2.internode.on.net)
[08:51:02] <aatch> comments get a lot of usage in obfuscation contests
[08:52:10] <joshua_> all true!
[08:55:02] <dbaupp> aatch: (I'll be away for a bit)
[08:55:05] <joshua_> yes, of course, the macrooptimizations make all the difference; moving to A* from Dijkstra search brought me from 25.9s to 13.5s
[08:56:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:57:08] <joshua_> (I now run industry1 in 111s)
[08:58:41] <aatch> joshua_, given rust's newness and it's memory safety, 111s vs 80s is pretty good.
[08:59:13] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:00:18] *** Joins: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com)
[09:01:01] <joshua_> yeah.  this machine is also an i7 @ 2.7GHz (though I expect mostly to be memory latency-sensitive)
[09:05:16] <aatch> I find it hilarious when people are like "Rust is like 10-15% slower than C++"
[09:05:41] *** Quits: LQDH (andrew@moz-91DB7BBE.cable.virginmedia.com) (Quit: Leaving.)
[09:05:44] <joshua_> yes
[09:05:51] <aatch> Cos I'm like "C++ has 20-30 years of development under its belt, Rust hasn't hit version 1"
[09:05:58] <joshua_> I would say it is more than 10-15% faster to write than C++, but sadly that is probably not true yet
[09:06:07] <joshua_> it is certainly 10-15% more pleasant to write than C++
[09:07:02] <joshua_> bedtime; thanks for yinz help
[09:07:04] <aatch> joshua_, take a look at this: https://github.com/Aatch/rust-fmt/blob/master/parse.rs
[09:07:11] <aatch> nvm
[09:07:22] <joshua_> yes, it is pretty to read (in the general case)
[09:07:32] <tiffany> why is rust more often compared to C++ over C?
[09:08:00] <aatch> tiffany, because C++ is closer. We don't have templates, but we do have generics
[09:08:06] <aatch> Stuff like that
[09:08:22] <joshua_> in my relearning of Rust for this cycle, though, the main source of pain is that the learning curve for the type system is most aptly compared to that of quantum mechanics
[09:08:27] <joshua_> "if you think you got it, you don't got it"
[09:08:47] <aatch> joshua_, that isn't helped by it changing a little bit each week
[09:09:09] <aatch> So it's more "you think you got it, then it got changed"
[09:09:46] *** Joins: spider-mario (spidermari@moz-EE4B8A09.rev.sfr.net)
[09:09:54] <joshua_> I was discussing it with a friend of mine (who was also learning rust, and rewriting a fairly major codebase in rust); after both of us (both relatively seasoned programmers experienced in a diverse set of programming languages) took an hour and a half to understand some really basic semantics, we came up with the quantum mechanics analogy
[09:10:25] <joshua_> I need to get around to distilling the lessons from that conversation (it was over IRC) to a more helpful form than 'your type system is complicated and you should feel bad'
[09:13:18] <joshua_> I think a lot of the "???" is that it just goes a lot deeper than the tutorial indicates; it tries to introduce it gently, but in reality, there's just a lot to it, leading to the instinctive 'agh!' reaction.  when we tried to figure it out based only on the semantics introduced in the initial tutorial, without reading the borrowed pointer tutorial, there was still a lot missing.
[09:13:25] <dbaupp> joshua_: nice work with the A*
[09:13:49] *** Joins: Mowah (Mowah@moz-59D1A475.cust.bredbandsbolaget.se)
[09:16:35] *** Quits: Diablo-D3 (diablo@moz-20613698.port.east.myfairpoint.net) (Ping timeout)
[09:17:27] <joshua_> dbaupp, amazingly, it improved the quality of results, for no readily discernable reason (successfully routing 908 nets, instead of just 870).  there are still a few more tricks up my sleeve yet that may increase runtime but will likely improve QoR further yet; we'll see...
[09:18:20] <dbaupp> joshua_: looking forward to seeing you win ;)
[09:18:41] <joshua_> I do credit Rust with making it possible to make that change so quickly.  the lack of partial assignability meant that as soon as it compiled, more or less, it was correct.
[09:19:38] <joshua_> ha.  I have already 'won' (in the sense that I have full credit).  sadly, it hasn't a leaderboard for best results.
[09:20:22] <dbaupp> yeah, I like languages like Haskell (and Rust, if you're careful) that have the compiled == good chance of correctness property
[09:20:54] <joshua_> yeah, last time I had that was when I was writing Standard ML (I never learned Haskell, but I imagine how that can be)
[09:21:04] <joshua_> anyway.  it sure is bed time.  thanks again
[09:22:37] *** Joins: bheylin (brianheyli@C709828D.E7BADBF1.B0C2132F.IP)
[09:24:19] *** Quits: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com) (Input/output error)
[09:27:35] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[09:28:00] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Client exited)
[09:39:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[09:42:10] <aatch> dbaupp, 12.format_d(writer, ::core::option::None(), ::core::option::None(), [], 10u);
[09:42:52] <indutny> hi guys
[09:42:57] <indutny> I've a question
[09:43:06] <indutny> can a function return ~[] as &[]?
[09:43:25] <indutny> provided that lifetime is specified
[09:43:53] *** Joins: tiffnya (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[09:44:14] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[09:44:26] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Connection reset by peer)
[09:44:59] *** tiffnya is now known as tiffany
[09:45:31] <aatch> indutny, nope, sorry
[09:45:52] <indutny> oook
[09:45:53] <indutny> thank you anyway
[09:46:11] <indutny> so that's possible only in unsafe ways, right?
[09:46:20] <aatch> if the caller doesn't know it's a ~, then it can't do the lifetime tracking for it
[09:46:23] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[09:46:41] <aatch> indutny, pretty much. Or ways that aren't any more efficient
[09:46:46] <indutny> hm...
[09:47:04] <indutny> got it
[09:47:41] *** Quits: bheylin (brianheyli@C709828D.E7BADBF1.B0C2132F.IP) (Quit: bheylin)
[09:48:00] <aatch> dbaupp, you lied to me! enum variants that don't have any data are path expressions
[09:49:00] <indutny> also
[09:49:03] <indutny> interesting thing
[09:49:09] <indutny> its possible to implement trait for enum
[09:49:15] <indutny> but not possible to use it
[09:49:21] <indutny> at least static methods
[09:49:31] <indutny> or am I doing something wrong?
[09:49:55] <aatch> depends on what you are doing.
[09:49:59] <aatch> However, you can'
[09:50:16] <aatch> can't do MyEnum::static_foo()
[09:50:30] <indutny> is there any reason for it?
[09:50:35] <aatch> You have to do MyTrait::static_foo()
[09:50:39] <indutny> aah
[09:50:42] <indutny> but
[09:50:45] <indutny> how will it work?
[09:50:48] <aatch> it's because of the way methods are resolved
[09:51:03] <aatch> if it can, it uses the inferred return type to pick the right one
[09:51:09] <indutny> oooh
[09:51:13] <indutny> that explains it
[09:51:19] <indutny> ok, thank you
[09:51:43] <aatch> at the moment, you can do MyTrait::static_foo::<MyEnum>() to supply it as well
[09:51:55] <aatch> Though that might not stick around
[09:51:57] *** Joins: z0w0 (zack@moz-68B9A0AF.lnse3.woo.bigpond.net.au)
[09:53:35] <indutny> heh
[09:54:18] <aatch> If it does disappear, there will be another way to explicitly supply the concrete type though.
[09:55:24] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:57:17] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Ping timeout)
[09:58:01] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[10:08:05] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Ping timeout)
[10:08:49] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[10:20:14] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:21:37] <indutny> stuck again :)
[10:24:10] *** Quits: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu) (Ping timeout)
[10:24:15] *** Joins: EXetoC (ex@moz-2DBEB1E4.customer.t3.se)
[10:25:06] <rfw> hm, how do i copy a vector and make it mutable?
[10:26:54] <doener> rfw: do you actually need a copy? You can make an existing vector mutable by assigning it to a mutable var
[10:27:02] *** Joins: judder (maradukewa@DABDEEA3.F2C0D0AC.78E362FE.IP)
[10:27:10] <rfw> doener: yeah, i really need a copy
[10:27:26] <rfw> i don't want to mess with the original vector's contents
[10:28:07] <doener> let mut copied = vector.clone(); 
[10:28:11] <doener> that should do then IIRC
[10:30:20] *** Joins: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[10:31:20] *** Joins: cc (cc@moz-9962C9F4.rev.numericable.fr)
[10:31:32] *** Quits: pseudoku (quassel@7E205F66.5B86C286.C28326FD.IP) (Ping timeout)
[10:32:26] *** Joins: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu)
[10:32:33] <rfw> doener: aha, thanks
[10:33:20] *** Joins: fabiand (fabiand@moz-536A963D.adsl.alicedsl.de)
[10:36:20] *** Quits: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Ping timeout)
[10:37:58] *** Quits: SimonSapin (simon@moz-C4A83ED9.net-89-2-126.rev.numericable.fr) (Ping timeout)
[10:39:59] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[10:40:15] <dbaupp> aatch: I didn't totally lie... enum variants with data are calls :P
[10:40:37] <dbaupp> aatch: is that the format method call?
[10:41:35] <aatch> Hmm, what?
[10:41:46] <aatch> Oh, that, yeah
[10:41:50] <dbaupp> aatch: 19:39:47 - aatch: dbaupp, 12.format_d(writer, ::core::option::None(), ::core::option::None(), [], 10u);
[10:41:58] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[10:42:39] <aatch> now it's 12u8.format_d(writer, ::core::option::None, ::core::option::None, [], 10u);
[10:42:43] *** Joins: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com)
[10:43:04] <dbaupp> aatch: ah, yes, being correct is probably more reliable ;P
[10:43:27] <dbaupp> have you pushed recently/is there anything I can do?
[10:44:32] <aatch> dbaupp, I'm just about to push the changes to writef!
[10:45:11] <aatch> It doesn't seem to like the method calls, but you got it working earlier so you can figure that out
[10:45:42] <aatch> I also changed the spans for the expressions
[10:45:59] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:46:06] <dbaupp> aatch: yeah, I've written quite a bit of syntax-extension code, so I'm happy to take that over if you'd like?
[10:46:34] <aatch> dbaupp, sure, I'll not have as much time now the weekend is over
[10:47:03] <dbaupp> aatch: same
[10:47:47] <aatch> dbaupp, fair enough lol. Well I just pushed my changes
[10:48:45] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:49:07] <dbaupp> ok, I'm currently in the middle of something on another branch, but i'll try to get to it soon-ish :)
[10:49:37] <aatch> Yeah. I have an early appointment tomorrow, so I'm gonna head off.
[10:49:44] <aatch> Talk to ya tomorrow.
[10:49:56] *** aatch is now known as aatch|bed
[10:50:36] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:51:38] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:51:53] <dbaupp> aatch|bed: cya
[10:53:31] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:53:50] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:55:31] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[10:56:02] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[10:56:30] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:56:41] *** Quits: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu) (Ping timeout)
[10:57:00] *** Joins: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu)
[10:57:50] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:58:07] *** Quits: akashj87 (akash@DC02D734.2921AF61.35E3DDC8.IP) (Quit: Leaving)
[10:59:38] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[11:00:35] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[11:06:35] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[11:10:07] *** Joins: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[11:11:07] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[11:11:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/mlz8Kg
[11:11:08] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[11:11:09] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[11:11:09] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/YPk5jw
[11:11:09] <ghrust> 13rust/06auto 148f2d71a 15Daniel Micay: small fix to the tutorial-ffi destructor example...
[11:11:09] <ghrust> 13rust/06auto 143b299e8 15bors: auto merge of #6244 : thestinger/rust/ffi, r=z0w0...
[11:11:10] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[11:14:58] *** Joins: hmax (hmax@moz-15514FA1.yandex.net)
[11:19:26] *** Joins: mib_40l9z4 (Mibbit@26BDC7F3.5EA5AB2D.9BA5B9B3.IP)
[11:19:33] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[11:28:22] *** Quits: mib_40l9z4 (Mibbit@26BDC7F3.5EA5AB2D.9BA5B9B3.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:29:16] *** Quits: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net) (Ping timeout)
[11:30:03] *** Joins: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net)
[11:31:47] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[11:31:55] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[11:39:48] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:41:27] *** Quits: arete (arete@moz-CC2E6F16.new.xen.prgmr.com) (Ping timeout)
[11:43:35] *** Joins: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net)
[11:47:19] *** Joins: jfredett (jfredett@moz-C01C350.bstnma.fios.verizon.net)
[11:50:07] *** Quits: jfredett (jfredett@moz-C01C350.bstnma.fios.verizon.net) (Ping timeout)
[11:51:11] *** Quits: libertas (libertas@AC2B2B0D.8ECC0B56.593B3862.IP) (Ping timeout)
[11:51:47] *** Joins: RageOfThou (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[11:51:48] *** Quits: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Connection reset by peer)
[11:55:36] *** Joins: libertas (libertas@554C17A.C07C8950.593B3862.IP)
[11:56:37] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:00:44] *** Quits: cc (cc@moz-9962C9F4.rev.numericable.fr) (Ping timeout)
[12:05:06] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:05:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/YPk5jw
[12:05:07] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:06:33] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[12:06:35] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[12:08:26] *** Joins: catpig (catpig@moz-BE63F2FC.dip0.t-ipconnect.de)
[12:09:44] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[12:10:46] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Quit: boggle)
[12:11:07] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:11:07] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wZOygQ
[12:11:07] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:11:08] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:11:08] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/6qyNyg
[12:11:08] <ghrust> 13rust/06auto 144dd0fa6 15Felix S. Klock II: Make build products depend on their target directories....
[12:11:08] <ghrust> 13rust/06auto 14495bceb 15Felix S. Klock II: Fix syntax: had to use escaped $$ to have an effect after first expansion.
[12:11:08] <ghrust> 13rust/06auto 14175a5ee 15Felix S. Klock II: Fix another goof: consistently use parent directory of target for rule....
[12:11:10] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:12:07] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[12:13:19] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[12:13:34] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[12:15:16] *** Quits: kvark (Mibbit@moz-46F48A13.cpe.distributel.net) (Quit: http://www.mibbit.com ajax IRC Client)
[12:31:36] <goldfeld> is there a way to create a module so that i can do e.g. mymodule::add(3); and that will act on an internal existing object or else create one, like a singleton with static method access?
[12:32:41] <goldfeld> or what is the idiomatic way to do something akin to a singleton in rust?
[12:34:15] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bb2mrw)
[12:35:10] <dbaupp> goldfeld: you can't have a global singleton (across all threads), but you can have a task-local one: http://static.rust-lang.org/doc/core/task_local_data.html
[12:35:26] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[12:36:33] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[12:37:01] <dbaupp> s/threads/tasks/
[12:37:28] <goldfeld> thanks for the link dbaupp, i'll see what i can come up with
[12:38:39] <dbaupp> goldfeld: there is an example here https://github.com/mozilla/rust/blob/incoming/src/libcore/rand.rs#L817
[12:39:05] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[12:39:18] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[12:39:55] <goldfeld> ah, even better, that will save me some head bashing
[12:41:16] <dbaupp> yeah, examples are always useful :)
[12:43:19] <goldfeld> especially as I'm just getting started and rust has a whole lot of concepts to grasp beyond my C and Java knowledge
[12:43:33] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[12:44:10] <goldfeld> so everything feels like I need to know these 6 things to do this and it's like a dependency loop on my brain
[12:44:40] <goldfeld> I *could* go over the whole tutorial before starting out but I like to learn getting my hands dirty
[12:45:06] <dbaupp> yeah, rust isn't the easiest language to learn right now (the documentation sorta sucks), so examples/looking at code is particularly helpful :)
[12:45:17] <goldfeld> so thanks a bunch
[12:45:47] <dbaupp> good luck with it (i'm sure there'll be someone on here willing to help if you get stuck)
[12:45:52] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[12:46:10] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[12:48:03] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[12:48:06] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[12:50:06] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[12:52:50] *** Joins: berak (chatzilla@6F1BD0A7.6062171A.1A5CC7E5.IP)
[12:53:03] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[12:53:22] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[12:55:04] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[12:55:12] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[12:55:22] *** Parts: berak (chatzilla@6F1BD0A7.6062171A.1A5CC7E5.IP) ()
[12:55:26] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:57:07] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[12:57:39] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[12:58:15] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[12:58:44] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[12:58:50] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[12:59:47] *** Quits: judder (maradukewa@DABDEEA3.F2C0D0AC.78E362FE.IP) (Ping timeout)
[13:00:05] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:00:25] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:02:07] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:02:11] *** Joins: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[13:04:42] *** Joins: cdidd (cdidd@moz-1CABC4F4.broadband.corbina.ru)
[13:06:06] *** Quits: quvarxa (chatzilla@moz-C9831B8C.lns20.adl2.internode.on.net) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130430204233])
[13:07:03] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:07:12] *** Quits: ssbr_ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:08:59] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[13:09:01] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:09:07] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[13:10:41] *** Joins: jfredett (jfredett@moz-C01C350.bstnma.fios.verizon.net)
[13:11:28] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[13:13:21] *** Quits: jfredett (jfredett@moz-C01C350.bstnma.fios.verizon.net) (Ping timeout)
[13:14:00] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:14:06] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:15:44] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[13:16:11] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:17:08] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[13:20:55] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:23:06] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[13:23:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/6qyNyg
[13:23:06] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[13:23:07] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:23:49] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[13:28:03] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:28:09] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Quit: boggle)
[13:29:59] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:33:58] <jyyou> after making small modifications, it is able to print hello world on rasspberry pi
[13:35:07] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:36:26] <kimundi> jyyou: Nice :)
[13:36:33] <ion> cool
[13:36:58] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:37:38] * kimundi has an terminal open on his pi with 'git pull' and './configure' in the backbuffer since two months
[13:38:57] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[13:40:07] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[13:41:53] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[13:43:26] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:43:49] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[13:44:07] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[13:44:40] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[13:47:15] *** Joins: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com)
[13:47:36] <Diablo-D3> I wonder if its possible to beat tcmalloc and jemalloc
[13:48:11] <Diablo-D3> the problem with jemalloc is its not numa ware
[13:48:20] <Diablo-D3> actually maybe it is
[13:49:32] *** Quits: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com) (Input/output error)
[13:51:08] *** Joins: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com)
[13:53:06] <kimundi> ssbr: ping
[13:54:24] *** Joins: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com)
[13:54:28] *** Quits: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com) (Quit: Cromulent)
[13:54:58] *** Joins: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com)
[13:55:23] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[13:55:51] *** Quits: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[13:56:07] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[13:56:29] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[13:57:56] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:00:00] *** Quits: hmax (hmax@moz-15514FA1.yandex.net) (Ping timeout)
[14:02:36] *** Quits: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com) (Quit: Leaving)
[14:03:55] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:05:06] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:07:57] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[14:10:15] *** Joins: cc (cc@moz-9962C9F4.rev.numericable.fr)
[14:10:30] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:11:25] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[14:11:57] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:12:41] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[14:17:26] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:18:07] *** Joins: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com)
[14:18:19] <Boreeas> How do I access code from another file (in the same directory) without compiling it as a crate first?
[14:19:07] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:20:29] <dbaupp> Boreeas: mod `filename`
[14:20:32] <dbaupp> ;
[14:20:52] <dbaupp> (without the .rs)
[14:20:57] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[14:21:35] <Boreeas> Ahh. So "extern mod" means "load a crate" and just "mod" means "load a file"?
[14:21:42] <dbaupp> Boreeas: yep
[14:23:25] <Boreeas> Great, thanks
[14:24:05] *** Joins: jensnock_ (jensnocker@CC60FA7.C48F2496.6049AABB.IP)
[14:24:06] *** Quits: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com) (Connection reset by peer)
[14:24:08] <dbaupp> Boreeas: also, you can use `#[path="dir/name/file.rs"] mod myname;` to control where/what-name the file is independently of the imported mod name
[14:24:11] <Diablo-D3> where mod is module?
[14:24:32] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:24:40] <Diablo-D3> the syntax probably should be changed to extern crate to make it less confusing
[14:24:43] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[14:25:04] <Diablo-D3> or just extern
[14:25:24] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Quit: Leaving.)
[14:25:33] *** Quits: jensnock_ (jensnocker@CC60FA7.C48F2496.6049AABB.IP) (Input/output error)
[14:25:42] <dbaupp> Diablo-D3: mod does stand for `module`
[14:25:48] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[14:25:54] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:26:13] <dbaupp> but I'm not sure the devs will agree with those other proposals... you can always suggest them though :)
[14:31:07] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:32:54] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:33:35] *** Joins: RagingDave (RagingDave@moz-3F31ACEF.pools.arcor-ip.net)
[14:35:35] *** Quits: cc (cc@moz-9962C9F4.rev.numericable.fr) (Quit: cc)
[14:38:04] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:39:56] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:40:39] *** Quits: spider-mario (spidermari@moz-EE4B8A09.rev.sfr.net) (Input/output error)
[14:42:13] <kimundi> Do we have any trait to construct a type in an empty form yet?
[14:43:29] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[14:43:47] <dbaupp> kimundi: Zero?
[14:43:52] <dbaupp> (sort-of)
[14:44:13] <kimundi> Eeehh. I'd rather not use that :)
[14:44:28] <dbaupp> yeah
[14:44:44] <dbaupp> if it's not a number, it'd be strange
[14:45:08] <kimundi> MEh, I'm just gonna add a new 'trait ConstructEmpty { fn new_empty() -> Self }'
[14:45:36] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:46:28] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[14:46:52] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:50:14] <engla> if it's a monoid zero might be good :-)
[14:52:01] *** Quits: dbaupp (Thunderbir@moz-91B99879.lns20.syd6.internode.on.net) (Ping timeout)
[14:52:06] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[14:52:28] <tristram> so, Im playing with rust trying to make a graph lib. I declared such a trait : trait Graph<Node, Edge> {
[14:52:44] <tristram> this implementation : impl<N:Hash+Eq,E> Graph<N,E> for HashMap<N, ~[(N,E)]>
[14:53:00] <tristram> and at last a function fn edge_count<N,E>(g: &Graph<N,E>) -> int 
[14:53:35] <tristram> but I get this error : error: mismatched types: expected `&Graph<<V148>,<V149>>` but found `core::hashmap::HashMap<int,~[(int,int)]>` (expected trait Graph but found struct core::hashmap::HashMap)
[14:53:53] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[14:55:11] <kimundi> tristram: Need more code, I think I know the reason, but its not for sure from what you posted
[14:56:02] *** Joins: benzi (benzi@ADD3CEDC.9D1D1610.301675BC.IP)
[14:56:02] <tristram> https://gist.github.com/Tristramg/5521034 this is the whole code
[14:57:27] <kimundi> where do you get the error?
[14:58:43] <tristram> src/graph.rs:92     if edge_count(g) != 0 {
[14:58:48] <kimundi> tristram: fn edge_count<N,E>(g: &Graph<N,E>) -> int expects a traitobject
[14:59:21] <kimundi> If you want to pass a type that implements the trait, you have to explicit cast it first
[14:59:36] <engla> What you probably want is   fn edge_count<N,E,G:Graph<N,E>>(g: &G) -> int
[14:59:39] <tristram> hrm, ok
[14:59:46] <kimundi> if edge_count(&g as &Graph) != 0 { or so
[15:00:21] <kimundi> alternative as engla said, don't take a trait object, but instead have a trait bound
[15:00:23] <engla> traits can be used both for dynamic types (traits as type names) or for "templates"
[15:01:09] <tristram> thanks, englas solution is closer to what I want
[15:03:37] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:04:36] <engla> I don't know rust well enough to know the pros of each way to do it
[15:04:48] <engla> in fact, I thought traits as type names was only possible with @
[15:06:10] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:07:16] <tristram> I biaised by the c++ template approach where you just need to implement the functions, no need to define traits and no casting
[15:07:31] <engla> :w
[15:07:43] <engla> oops sorry again for that typo
[15:07:51] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:08:11] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[15:08:27] <kimundi> engla: Recommended is the trait bound way, as it results in compiletime optmisations, But in theaory @Trait, &Trait, ~Trait all work in cases where you need dynamic polymorphism
[15:08:34] <engla> in rust they are called Generic Functions by the way
[15:08:41] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[15:11:33] *** Quits: z0w0 (zack@moz-68B9A0AF.lnse3.woo.bigpond.net.au) (Quit: Leaving.)
[15:12:09] *** Quits: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com) (Quit: Leaving)
[15:12:35] <tristram> as I already bothered you, would it be rust-ish to declare sur a free function as edge_count (opposed to member functions  which I believe is not possible to make generic)
[15:14:38] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:14:50] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:17:02] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[15:20:07] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:20:48] <engla> rust will allow default implementations in the future
[15:21:17] <engla> you could then implement edge_count in the trait and the impl could override it
[15:21:41] <tristram> oh nice :)
[15:21:48] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:23:36] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[15:23:37] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[15:24:06] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[15:27:23] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:28:50] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:34:36] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:34:53] *** Quits: benzi (benzi@ADD3CEDC.9D1D1610.301675BC.IP) (Quit: Textual IRC Client: www.textualapp.com)
[15:35:47] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:37:15] *** Joins: spider-mario (spidermari@CDCE9792.FB019E28.96B18764.IP)
[15:41:42] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:42:53] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[15:46:23] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[15:47:56] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:53:24] *** Joins: jviereck (Adium@moz-32288846.dclient.hispeed.ch)
[15:54:15] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:58:57] *** Quits: spider-mario (spidermari@CDCE9792.FB019E28.96B18764.IP) (Ping timeout)
[16:02:01] *** Joins: spider-mario (spidermari@CD9A4019.6D40DA80.EC2613E4.IP)
[16:02:13] *** Joins: nejucomo (nejucomo@moz-E784A595.privacyfoundation.ch)
[16:02:21] *** Quits: spider-mario (spidermari@CD9A4019.6D40DA80.EC2613E4.IP) (Input/output error)
[16:03:14] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:03:55] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[16:05:39] *** Joins: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com)
[16:12:51] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Quit: Leaving.)
[16:15:15] *** Quits: nejucomo (nejucomo@moz-E784A595.privacyfoundation.ch) (Ping timeout)
[16:16:03] *** Joins: Erik (Erik-S@moz-252DBA2.hsd1.co.comcast.net)
[16:17:26] *** Joins: nejucomo (nejucomo@moz-38369F9F.noisetor.net)
[16:20:44] *** Joins: Kambfhase (kvirc@moz-CA4B0C08.travedsl.de)
[16:22:47] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:24:58] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[16:25:43] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[16:28:07] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[16:30:08] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:30:09] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[16:31:01] *** Quits: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[16:31:07] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[16:31:49] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[16:39:57] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[16:39:58] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[16:43:10] *** Joins: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se)
[16:44:09] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:44:50] *** Quits: RageOfThou (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Ping timeout)
[16:45:48] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:45:50] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[16:46:03] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[16:46:03] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[16:47:26] *** strcat1 is now known as strcat
[16:47:28] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:48:31] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[16:48:32] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:51:13] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:52:55] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[16:57:01] *** Joins: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com)
[16:58:45] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:59:41] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[17:01:42] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[17:05:37] *** Joins: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[17:06:17] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:06:44] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[17:07:01] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[17:07:38] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[17:09:12] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Quit: Leaving.)
[17:10:07] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Quit: boggle)
[17:10:27] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[17:12:17] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:13:29] *** Quits: Cromulent (Cromulent@moz-5111C23B.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:13:43] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[17:15:03] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[17:17:58] *** Quits: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se) (Quit: webber46)
[17:20:32] *** Joins: philix (philix@moz-451739D3.user.veloxzone.com.br)
[17:20:44] *** Joins: LQDH (andrew@moz-91DB7BBE.cable.virginmedia.com)
[17:25:44] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:27:40] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[17:28:12] <Yurume> ...was @mut casting unsupported in 0.6?
[17:28:45] <Yurume> (i.e. @mut A as @mut CommonBase)
[17:30:19] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[17:39:21] *** Joins: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se)
[17:39:59] *** Quits: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu) (Quit: Leaving)
[17:45:31] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:46:14] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:46:25] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[17:46:41] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:46:48] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:47:14] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Quit: Leaving.)
[17:48:00] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[17:48:39] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[17:54:03] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[17:55:24] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[17:55:48] <strcat> nmatsakis: should I just reuse TC_MUTABLE for a #[non_const] attribute?
[17:56:00] <strcat> or #[mutable] I guess
[17:59:29] <nmatsakis> strcat: Yes, that sounds reasonable.
[17:59:50] <nmatsakis> strcat: btw, with #5910 fixed I now have rustc building. Going to rebase and push to try...
[18:00:04] <strcat> :)
[18:00:22] <nmatsakis> all in all there were ~ a dozen violations of @mut, mostly trivial to fix
[18:00:31] <strcat> not bad
[18:00:35] * strcat thought it would be much worse
[18:00:39] <nmatsakis> one nice thing: many of them had been marked with FIXMEs saying "unexplained crashes occur if you remove this copy"
[18:00:59] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:01:03] <nmatsakis> basically *all* of them were inserting into hashmaps while iterating
[18:01:18] <nmatsakis> in the the tricky cases, the inserting code was rather distant from the iterating code
[18:01:31] <nmatsakis> so essentially what I'm saying is: bugs one could easily have had in C++ or Java
[18:01:40] <strcat> nmatsakis: @mut as hash table keys is still a bit worrying
[18:01:47] <strcat> hashmap doesn't rely on unsafe code so I guess it doesn't matter
[18:02:02] <nmatsakis> strcat: well, using mutable data for hashtable keys is certainly always unwise...
[18:02:02] <strcat> but if you alter it externally it breaks the internal structure
[18:02:10] <strcat> ofc you could just write a buggy Hash or Eq ;p
[18:02:12] <nmatsakis> we could of course require Const (we used to)
[18:02:26] <nmatsakis> but yes it seems heavy-handed to me
[18:02:36] <nmatsakis> for example, your Hash might not be hashing data that is ever mutated
[18:02:39] <nmatsakis> e.g., an id or something
[18:02:41] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:02:52] <nmatsakis> though in such cases you'd *probalby* be better off using the id as the key
[18:02:57] * nmatsakis shrugs
[18:03:08] *** Joins: jviereck1 (Adium@moz-32288846.dclient.hispeed.ch)
[18:03:22] *** Joins: RageOfThou (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[18:03:24] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:03:26] *** Quits: jviereck (Adium@moz-32288846.dclient.hispeed.ch) (Connection reset by peer)
[18:03:43] <nmatsakis> I have no idea how to slice up the work on this branch into understandable commits at this point.
[18:03:50] <nmatsakis> I ... kind of doubt I should even try
[18:04:08] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:04:36] <nmatsakis> well, for now I will just git merge from incoming. maybe I'll try to make a central diff laer.
[18:04:39] <nmatsakis> *later
[18:05:36] <strcat> anyway I think #[non_const] can just be the solution for types like Cell
[18:05:43] <strcat> they still have to make themselves safe in regards to borrowing
[18:05:52] *** Joins: bheylin (brianheyli@moz-DAFB48D0.static.chello.nl)
[18:06:12] <strcat> but #[non_const] can tell the compiler not to assume it can be frozen (when it eventually uses llvm.invariant)
[18:06:28] <nmatsakis> I still hope to make Cell go away
[18:06:42] <nmatsakis> but yes if we fail, then #[mutable] seems like an ok sol'n
[18:06:44] <strcat> ideally :), but I think people will still end up with types like Cell for other reasons
[18:07:09] <nmatsakis> perhaps. It seems like a mutable option is fine
[18:07:30] <nmatsakis> but I can imagine that Cell will wind up existing for whatever reason
[18:07:50] * strcat just wants it for https://github.com/thestinger/rust/commit/2965024ad1158c363c041f7f6a9bc7c233206baf anyway
[18:08:13] *** Quits: Ralith (ralith@114DA04D.CD83ED0A.BCDF04A6.IP) (Ping timeout)
[18:08:23] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:09:39] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:11:36] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:12:05] *** Joins: gareth0 (gareth0@moz-E73DDF8.dynamic.dsl.as9105.com)
[18:14:08] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[18:14:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/XstSjw
[18:14:08] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[18:14:10] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[18:14:10] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/kCJ3Ag
[18:14:10] <ghrust> 13rust/06auto 14a0d8873 15Seo Sanghyeon: More accurate spans
[18:14:10] <ghrust> 13rust/06auto 14aca2a00 15Seo Sanghyeon: Fix span tests
[18:14:10] <ghrust> 13rust/06auto 146e6a4be 15bors: auto merge of #6208 : sanxiyn/rust/accurate-span, r=sanxiyn
[18:14:10] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[18:18:48] <bheylin> ls
[18:19:26] <Blei> .    ..
[18:21:08] *** Joins: dymk (dymk@moz-20905EBD.sub-70-211-69.myvzw.com)
[18:23:02] <bheylin> Blei: :)
[18:27:01] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[18:28:57] *** Quits: LQDH (andrew@moz-91DB7BBE.cable.virginmedia.com) (Quit: Leaving.)
[18:29:22] *** Joins: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu)
[18:29:28] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:30:39] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:31:20] *** Joins: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP)
[18:31:39] *** Quits: bheylin (brianheyli@moz-DAFB48D0.static.chello.nl) (Quit: bheylin)
[18:33:08] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[18:34:25] *** Joins: blitter (blitter@moz-7C98731E.dyn.centurytel.net)
[18:35:26] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:35:47] <strcat> nmatsakis: hmm, can't enums have custom destructors defined on them?
[18:36:07] <strcat> the TypeContents stuff only seems to check for struct
[18:36:48] <nmatsakis> strcat: good point, that's probably an oversight
[18:36:56] *** Quits: fabiand (fabiand@moz-536A963D.adsl.alicedsl.de) (Quit: Verlassend)
[18:37:37] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:37:46] <strcat> nmatsakis: what does a tuple/unit struct get treated as? just a ty_struct?
[18:37:58] <nmatsakis> strcat: yes.
[18:38:44] <nmatsakis> strcat: if you could make up a test that copies an enum with a dtor and file a bug, it'd be great
[18:38:50] <nmatsakis> (and/or a PR :)
[18:39:05] <strcat> nmatsakis: yeah I'll do it as part of this, if it turns out to actually be a bug
[18:39:12] <nmatsakis> it sounds like one
[18:39:17] <nmatsakis> but yes a test would verify
[18:39:25] * nmatsakis waits for llvm to build.
[18:39:31] <nmatsakis> that merge was not so painful as I feared---
[18:39:36] *** Quits: nejucomo (nejucomo@moz-38369F9F.noisetor.net) (Ping timeout)
[18:39:42] <nmatsakis> but then I haven't gotten to the rust build yet
[18:40:10] <strcat> foo.rs:5:0: 9:1 error: the Drop trait may only be implemented on structures
[18:40:12] <strcat> oh
[18:40:17] * strcat didn't realize that
[18:40:36] <doener> hm, I don't understand this: https://gist.github.com/dotdash/5521721
[18:40:39] <strcat> seems like you should be able to implement it on an enum though
[18:41:21] <doener> I can't use the private Foo trait in foo.rs itself, but I can access it cross-crate from bar.rs... Is that expected?
[18:41:30] <nmatsakis> strcat: yes, it does seem like that.
[18:41:42] <strcat> I'll file that bug instead :)
[18:41:43] <nmatsakis> doener: I ... think there may be an open bug on cross-crate privacy
[18:41:53] <nmatsakis> strcat: obviously it's equally expressive
[18:42:10] <strcat> https://github.com/mozilla/rust/issues/6250
[18:42:13] <nmatsakis> strcat: but I agree it's sort of inconsistent, enums and structs are supposed to be equivalent
[18:42:21] <nmatsakis> doener: https://github.com/mozilla/rust/issues/4732
[18:42:58] <doener> nmatsakis: thanks!
[18:43:31] <strcat> nmatsakis: http://ix.io/5uR/diff I'll make some run-fail tests and see if this works ;p
[18:43:57] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:44:38] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:44:58] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:45:51] *** Joins: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com)
[18:46:08] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:46:14] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:46:19] *** strcat1 is now known as strcat
[18:46:29] * strcat hates wireless N now
[18:47:47] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:48:06] <strcat> rusti: 1 + 1
[18:48:10] <rusti> 2
[18:48:11] <strcat> rusti: 1 + 1
[18:48:12] <rusti> 2
[18:48:17] *** Quits: rroels (rroels@moz-F4424B80.vub.ac.be) (Ping timeout)
[18:48:17] * nmatsakis wonders why the outcome of this is in doubt
[18:48:27] <nmatsakis> strcat: maybe factor out the "has_attr" code for enums/structs into a herlper
[18:48:28] <nmatsakis> *helper
[18:48:38] <nmatsakis> strcat: otherwise, that looks about right
[18:49:10] <nmatsakis> strcat: interestingly, this change *would* mean that Owned does not imply Const
[18:49:15] <strcat> there was actually an unused bit so I shifted some over one
[18:49:37] <strcat> I guess something got removed
[18:49:37] <nmatsakis> because you might have a struct tagged mutable but not non_owned
[18:49:46] <nmatsakis> it might be that we do not want this, I'm not sure.
[18:49:49] <strcat> it was like that before with mutable fields, right?
[18:49:54] <nmatsakis> yes, but they were being removed
[18:49:59] *** Joins: bheylin (brianheyli@E74A75A2.F993642.98C5AE08.IP)
[18:50:16] <nmatsakis> all that means is that maybe it should be that #[mutable] => #[non_owned] (which might suggest slightly different attribute structure)
[18:50:21] <strcat> for my use case, I only need non_owned_and_non_const
[18:50:51] <strcat> nmatsakis: well, #[non_owned] and #[mut_non_owned] ?
[18:50:57] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:51:17] *** Quits: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se) (Quit: webber46)
[18:51:19] <nmatsakis> perhaps. I am contemplating the implications of having such a structure.
[18:51:25] <nmatsakis> mainly it seems like this would mean that Cells cannot be sent
[18:51:38] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[18:52:06] <nmatsakis> which might be ok
[18:52:06] *** Quits: RageOfThou (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Quit: Leaving)
[18:52:15] <nmatsakis> anyway, carry on, but this is something to think about.
[18:52:21] *** Joins: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net)
[18:52:22] <nmatsakis> strcat: what *is* your use case? ref-counted @mut?
[18:52:42] <strcat> nmatsakis: yeah
[18:53:04] <strcat> restricted to T: Owned, so it needs #[non_owned] both to prevent cycles and make it non-sendable
[18:53:25] <strcat> and it seems like it needs to not be Const too
[18:53:51] <strcat> nmatsakis: https://github.com/mozilla/rust/pull/6241 that's the current implementation
[18:54:00] <strcat> using Option<@()> and Option<@mut ()> as a workaround
[18:54:14] <strcat> but that makes types containing it use the local allocator
[18:54:20] <nmatsakis> strcat: why restrict to T:Owned?
[18:54:59] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.0)
[18:54:59] <strcat> nmatsakis: easy way to prevent cycles
[18:55:06] *** Quits: jensnockert (jensnocker@moz-53969A22.mobileonline.telia.com) (Ping timeout)
[18:55:10] <nmatsakis> oh, right.
[18:55:30] <nmatsakis> duh.
[18:56:01] <strcat> dunno what ARC would do :), it's sendable right?
[18:56:04] <nmatsakis> disappointing, but reasonable. kind of heavy-handed.
[18:56:14] <strcat> yeah I hope a better solution can be found eventually
[18:56:17] <nmatsakis> what ARC would do for what?
[18:56:24] <strcat> nmatsakis: stopping cycles
[18:56:30] <nmatsakis> strcat: ARC is immutable
[18:56:32] <nmatsakis> Not a concern.
[18:56:40] <nmatsakis> oh, or do you mean the mutable variant
[18:56:48] <strcat> yeah
[18:56:54] <nmatsakis> it's plausible we could add a "non-recursive" tag
[18:57:08] <strcat> nmatsakis: is T: Owned not needed for the immutable reference counted ptr?
[18:57:29] <nmatsakis> strcat: well, it's needed so that it's sendable, but not for preventing cycles.
[18:57:54] <nmatsakis> strcat: basically the value you are putting in the ARC already exists before the ARC is made, and can't be changed afterwards
[18:57:56] <nmatsakis> strcat: so it can't refer to the ARC
[18:58:05] <strcat> can't have recursive ARCs?
[18:58:32] <nmatsakis> you cannot have an ARC that contains itself
[18:58:35] <nmatsakis> for the reason I just stated
[18:58:36] <strcat> ah right
[18:58:44] <nmatsakis> the ARC can contain other instances of the same type :)
[18:59:12] <strcat> well, for my Rc<T>
[18:59:19] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[18:59:21] <strcat> you could put @mut Rc<T> in it
[18:59:25] <strcat> if it lacked that bound
[18:59:26] <nmatsakis> it's definitely a severe limitation that a ref counted thing can't refer to any other ref counted thing
[18:59:34] <nmatsakis> but yes I see the problem
[18:59:51] * nmatsakis shrugs.
[18:59:56] <nmatsakis> I might be inclined to just leak and call it a day :)
[18:59:57] <strcat> I guess Rc could really have a Const bound
[19:00:09] <strcat> nmatsakis: well, it's kind of bad if it leaks because it won't be gone at task-cleanup
[19:00:22] <strcat> without making TLS stuff
[19:00:22] <nmatsakis> strcat: I mean, I know it's bad, don't get me wrong.
[19:00:38] <strcat> so... I could have 2 constructors for Rc
[19:00:41] <strcat> one T: Owned and one T: Const
[19:00:59] <nmatsakis> that's true
[19:01:10] <nmatsakis> b=abd 
[19:01:12] <nmatsakis> sorry
[19:01:41] <strcat> I think RcMut needs Owned though
[19:01:52] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[19:02:30] <strcat> hmm
[19:02:43] <strcat> not really
[19:02:53] <strcat> I think they can both have separate Const and Owned constructors
[19:03:29] <strcat> so the restriction would really end up being no @mut in Rc/RcMut, and no RcMut in RcMut
[19:03:52] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:05:21] <strcat> nmatsakis: I don't think that would be too bad.
[19:05:27] <strcat> you could make a persistent data structure with Rc that way
[19:05:33] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[19:06:08] *** Joins: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se)
[19:06:12] <nmatsakis> strcat: yeah, it sounds like a reasonable compromise
[19:07:27] *** Quits: Erik (Erik-S@moz-252DBA2.hsd1.co.comcast.net) (Ping timeout)
[19:08:04] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[19:08:54] *** Quits: jviereck1 (Adium@moz-32288846.dclient.hispeed.ch) (Quit: Leaving.)
[19:11:49] * nmatsakis holds breath as his merged version of rustc gets into stage2
[19:12:13] * nmatsakis realizes he is going to be holding his breath a long, long time
[19:15:02] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:15:02] <ghrust> 01[13rust01] 15nikomatsakis 04force-pushed 06try from 14bf67eb2 to 144300d4d: 02http://git.io/k471pw
[19:15:02] <ghrust> 13rust/06try 14202b8dc 15Niko Matsakis: adapt to snapshot
[19:15:02] <ghrust> 13rust/06try 14b5a7e8b 15Niko Matsakis: desnapshot
[19:15:02] <ghrust> 13rust/06try 14a896440 15Niko Matsakis: new borrow checker (mass squash)
[19:15:02] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:21:04] *** Quits: dymk (dymk@moz-20905EBD.sub-70-211-69.myvzw.com) (Ping timeout)
[19:21:18] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[19:21:52] *** Joins: dymk (dymk@44EEE21C.A6E21E6E.5E500FC7.IP)
[19:23:09] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:23:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/kCJ3Ag
[19:23:09] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:23:21] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[19:27:27] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[19:28:37] <strcat> nmatsakis: it works :)
[19:28:43] <strcat> attr-non_owned.rs:18:4: 18:7 error: instantiating a type parameter with an incompatible type `Foo`, which does not fulfill `Owned`
[19:28:45] <strcat> attr-non_owned.rs:18     bar(x);
[19:29:54] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[19:31:45] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[19:32:23] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:32:32] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[19:33:34] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[19:35:40] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Ping timeout)
[19:36:41] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[19:38:36] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[19:40:19] <nielsle> rusti let x = ~[1,2,3,4]; let y : &[int] = &x;
[19:40:52] <nielsle> Can you borrow the object that an owned vector points at?
[19:41:55] <nielsle> (I am toying around with a vector class, and I want something like v.to_array() for unit-testing)
[19:42:06] <strcat> yes
[19:42:08] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[19:42:29] <strcat> rusti: let xs = ~[1, 2, 3, 4]; let x0 = &xs[0]; x0
[19:42:31] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/eDeX
[19:42:42] <strcat> rusti: let xs = ~[1, 2, 3, 4]; let x0 = &xs[0]; fmt!("%?", x0)
[19:42:43] <rusti> ~"&1"
[19:42:48] <strcat> nielsle: you mean like that?
[19:42:59] <strcat> you can take & borrows deeper inside an & thing
[19:43:45] <nielsle> OK, so I can borrow an element withing the vector, but I cannot borrow the entire vector?
[19:43:59] <strcat> you can borrow the entire vector as a slice
[19:44:07] <strcat> and take slices into that slice
[19:44:14] <strcat> borrowed ptrs into the slices
[19:45:09] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:45:26] <nielsle> Thanks.
[19:45:32] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:45:34] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:45:53] *** Joins: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de)
[19:46:00] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:46:00] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:46:29] <Kambfhase> Yo dawg, I heard u liek pointers, so we put a pointer in your slice, so you can slice while you point.
[19:47:12] <EXetoC> could you repeat that?
[19:47:16] *** Joins: jviereck (Adium@moz-32288846.dclient.hispeed.ch)
[19:47:27] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[19:54:00] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:54:26] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[19:56:40] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[19:57:40] <nielsle> rusti: let xs = ~[1, 2, 3, 4]; let x0 : &[int]= xs.tailn(0); fmt!("%?", x0)
[19:57:41] <rusti> ~"&[1, 2, 3, 4]"
[19:58:12] <nielsle> That seems to work :)
[19:58:44] <strcat1> nmatsakis: https://github.com/mozilla/rust/pull/6251 does this look good?
[19:58:55] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[19:59:00] <doener> you shouldn't need the tailn call for that case
[19:59:12] <doener> rusti: let xs = ~[1, 2, 3, 4]; let x0 : &[int]= xs; fmt!("%?", x0)
[19:59:13] <rusti> ~"&[1, 2, 3, 4]"
[19:59:40] *** Joins: boggle_ (boggle@moz-7278888C.dip0.t-ipconnect.de)
[19:59:40] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Connection reset by peer)
[19:59:40] *** boggle_ is now known as boggle
[20:00:20] *** Joins: fabiand (fabiand@moz-536A963D.adsl.alicedsl.de)
[20:00:29] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:01:20] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130430204233])
[20:02:09] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[20:02:40] *** Joins: SimonSapin (simon@moz-C4A83ED9.net-89-2-126.rev.numericable.fr)
[20:04:20] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[20:06:16] *** Quits: bheylin (brianheyli@E74A75A2.F993642.98C5AE08.IP) (Quit: bheylin)
[20:06:29] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:06:30] <nielsle> Ah thanks :)
[20:07:16] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[20:09:01] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[20:09:09] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[20:09:23] *** Quits: Mowah (Mowah@moz-59D1A475.cust.bredbandsbolaget.se) (Ping timeout)
[20:09:35] *** Quits: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net) (Ping timeout)
[20:12:44] <dymk> Which module has the methods for determining if two vectors are unions?
[20:13:06] <dymk> doesn't look like core::vec has it, and I could have sworn I saw something like in somewhere in std
[20:15:32] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:16:14] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[20:16:34] <strcat1> dymk: sets (TrieSet, TreeSet, HashSet) implement those
[20:17:12] <strcat1> https://github.com/mozilla/rust/blob/incoming/src/libcore/container.rs#L60
[20:17:23] *** Quits: fabiand (fabiand@moz-536A963D.adsl.alicedsl.de) (Quit: Verlassend)
[20:17:27] <strcat1> could have versions for vectors too, haskell does for lists
[20:17:38] <strcat1> but they don't uphold exactly the same semantics
[20:17:45] <dymk> true
[20:18:24] <strcat1> TrieSet actually doesn't implement it yet ;p I was too lazy to make an external iterator
[20:18:31] <dymk> yeah, might make more sense to make a helper function to do it for vectors
[20:18:34] <dymk> haha
[20:18:46] <dymk> maybe I'll take a whack at implementing it
[20:19:32] *** Quits: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:20:53] *** Quits: cdidd (cdidd@moz-1CABC4F4.broadband.corbina.ru) (Input/output error)
[20:21:49] *** Joins: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net)
[20:21:53] *** Joins: ssbr (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[20:22:01] <nielsle> Can you do the cast without defining a temporary variable?  http://kib2.free.fr/pastebin/view_paste.php?id=107
[20:22:40] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Quit: Leaving)
[20:22:51] <doener> IIRC there's currently a problem with auto-borrowing for return values
[20:22:52] <Kambfhase> `x0 as &[int]`, maybe?
[20:22:56] <strcat1> nielsle: return type inference is buggy
[20:23:20] *** Joins: cdidd (cdidd@moz-951A83E1.broadband.corbina.ru)
[20:23:34] <nielsle> OK. Thanks for the help. I will go with this :)
[20:23:40] *** Quits: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net) (Ping timeout)
[20:23:48] <strcat1> nielsle: util::id::<&[int]>(self.data) if you really wanted ;p
[20:23:56] <doener> Kambfhase: that complains about a non-scalar cast. Which reminds me to ask that that means. So... what does that means?
[20:24:24] <strcat1> 'as' is only for casting scalars (the built-in primitive integers/floats)
[20:25:05] <Kambfhase> strcat1: thanks for covering my ass. didnt know that. :)
[20:25:32] <strcat1> 'as' only has to exist for usage in constant exprs
[20:25:48] *** Quits: boggle (boggle@moz-7278888C.dip0.t-ipconnect.de) (Quit: boggle)
[20:25:53] *** Quits: cdidd (cdidd@moz-951A83E1.broadband.corbina.ru) (Ping timeout)
[20:31:21] *** Quits: SimonSapin (simon@moz-C4A83ED9.net-89-2-126.rev.numericable.fr) (Ping timeout)
[20:35:57] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[20:36:02] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[20:36:07] *** Quits: jviereck (Adium@moz-32288846.dclient.hispeed.ch) (Ping timeout)
[20:37:26] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[20:39:17] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[20:40:21] *** Joins: bheylin (brianheyli@A92EA58F.8A733E51.EF374763.IP)
[20:42:43] *** Joins: nejucomo (nejucomo@moz-9127FDEC.torservers.net)
[20:42:52] *** Joins: cdidd (cdidd@moz-7F9BCE5D.broadband.corbina.ru)
[20:43:55] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:43:55] *** ChanServ sets mode: +o brson
[20:46:03] *** Quits: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:46:13] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:46:13] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:46:30] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:49:58] *** Quits: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu) (Ping timeout)
[20:53:29] *** Joins: rroels (rroels@moz-57D4C308.vub.ac.be)
[20:54:02] <strcat> rusti: 5
[20:54:07] <rusti> 5
[20:56:57] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[20:59:48] <engla> strcat: and @X as @Trait
[21:00:02] <engla> I mean foo as @Trait
[21:00:15] <strcat> engla: not needed anymore afaik
[21:00:46] <strcat> rusti: let x = @5; fn foo(x: @Ord) {}; foo(x)
[21:00:47] <engla> oh
[21:00:47] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/FfLT
[21:00:51] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[21:00:59] <strcat> hm, I guess it is
[21:08:01] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[21:08:52] <kimundi> strcat: Ah thing I was thinking about: Do you think it would be useful to have set!(a, b, c,...) and map!( a = 5, b = 2, ...) macros for initialising data structures?
[21:09:06] *** Quits: bheylin (brianheyli@A92EA58F.8A733E51.EF374763.IP) (Ping timeout)
[21:09:38] <strcat> from_iterable([1, 2, 3, 4, 5])
[21:09:49] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[21:09:53] <strcat> from_iterable([(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)])
[21:09:59] <strcat> don't think we need macros
[21:10:10] <strcat> I did want to add compile-time lookup tables if that's what you mean
[21:10:27] * strcat has to figure out how to make a syntax extension
[21:13:03] *** Quits: gareth0 (gareth0@moz-E73DDF8.dynamic.dsl.as9105.com) (Ping timeout)
[21:13:14] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[21:13:14] *** ChanServ sets mode: +o dherman
[21:13:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[21:13:53] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[21:14:08] <kimundi> strcat: Okay, I guess it would work without macros :) Does from_iterable() exist already?
[21:21:32] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[21:22:25] <Kambfhase> If anyone feels like having a coding challenge in rust, I have just added a new one, to my repo: https://github.com/Kambfhase/rust-challenge
[21:22:49] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[21:23:18] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[21:28:03] *** kimundi is now known as zz_kimundi
[21:30:57] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[21:31:16] *** Joins: Jesin (Jessin_@moz-A03A364F.cc.lehigh.edu)
[21:37:06] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[21:38:36] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[21:40:24] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[21:42:22] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[21:43:03] *** Quits: philix (philix@moz-451739D3.user.veloxzone.com.br) (Quit: philix)
[21:45:07] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Ping timeout)
[21:45:10] *** Quits: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se) (Quit: webber46)
[21:45:10] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Quit: Textual IRC Client: www.textualapp.com)
[21:45:41] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[21:45:53] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:46:04] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:46:07] *** strcat1 is now known as strcat
[21:46:11] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:46:12] *** Joins: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:46:16] *** Quits: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:46:18] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:47:55] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Input/output error)
[21:48:12] <steven_is_false> Ugh. I'm really frustrated with the current build system I'm using for my project. I have a big project with around 6 subprojects! 
[21:49:35] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[21:49:58] <steven_is_false> I'm really not sure what to do. I'm relying on Rust Bindgen, generating bindings to xlib, and glx, and using the xcb bindings, and using opengles as well. Also, I have a bunch of python scripts to integrate Blender.
[21:50:53] <steven_is_false> What's everyone else doing?
[21:53:45] *** zz_kimundi is now known as kimundi
[21:54:27] <kimundi> ssbr: ping
[22:01:17] *** Quits: Kambfhase (kvirc@moz-CA4B0C08.travedsl.de) (Connection reset by peer)
[22:03:09] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[22:06:59] *** Quits: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net) (Ping timeout)
[22:09:06] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[22:09:11] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[22:10:54] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[22:12:14] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Quit: This computer has gone to sleep)
[22:12:26] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[22:13:01] *** Joins: Erik (Erik-S@moz-252DBA2.hsd1.co.comcast.net)
[22:15:17] *** Quits: nejucomo (nejucomo@moz-9127FDEC.torservers.net) (Ping timeout)
[22:15:43] *** Joins: isaac (isaac@moz-F5F497CA.dyn.grandenetworks.net)
[22:17:56] *** Joins: nejucomo (nejucomo@8AA09B0D.23518FA3.CE794808.IP)
[22:21:01] *** Quits: isaac (isaac@moz-F5F497CA.dyn.grandenetworks.net) (Quit: leaving)
[22:21:37] *** Quits: RagingDave (RagingDave@moz-3F31ACEF.pools.arcor-ip.net) (Quit: Ex-Chat)
[22:22:07] *** Joins: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net)
[22:25:02] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[22:26:57] *** Quits: Mathnerd626 (quassel@moz-195E87F.rh.uchicago.edu) (Ping timeout)
[22:30:31] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[22:36:15] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Quit: Leaving)
[22:37:53] *** Joins: kesserich (Mibbit@moz-7ABC9BDB.hsd1.pa.comcast.net)
[22:38:15] <kesserich> hey everyone. i need some pretty basic help.  I suspect I am simply not thinking about this correctly.
[22:38:37] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[22:38:40] <kesserich> Basically, i have a function which i would like to give an empty vector and i would like to have said function insert strings into the vector.
[22:39:05] <kesserich> to avoid copying, i assume i would like to pass a borrowed pointer to the vector
[22:39:46] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[22:41:31] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[22:41:59] *** Quits: doener (doener@moz-724BBC7C.unitymediagroup.de) (Quit: leaving)
[22:42:35] <strcat> kesserich: you don't necessarily have to do that to avoid copying
[22:42:41] <strcat> you can pass it in as &mut ~[T]
[22:42:55] <strcat> but you can also pass it in by-value, which is only a ptr copy
[22:43:00] <strcat> and return it by value
[22:44:15] *** Quits: sully (sully@moz-45967CBE.emarhavil.com) (Ping timeout)
[22:44:27] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[22:44:45] <strcat> rusti: let xs = ~[1, 2, 3]; fn foo(xs: &mut ~[int]) { xs.push(4); }; foo(&mut xs); xs
[22:44:46] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/OhhQ
[22:45:43] *** Joins: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:46:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:46:33] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:47:01] *** aatch|bed is now known as aatch
[22:47:04] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:47:10] <strcat> kesserich: sorry, wifi really hates me ;p
[22:48:15] <aatch> strcat, #[non_owned]!
[22:48:21] <strcat> aatch: yep
[22:48:32] <strcat> for https://github.com/mozilla/rust/pull/6241 mostly
[22:48:32] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Client exited)
[22:48:39] <aatch> finally got around to it eh?
[22:48:43] <strcat> yeah :)
[22:48:48] <strcat> was easy ;p
[22:48:51] <strcat> didn't realize it would be
[22:48:56] <aatch> I saw that pull
[22:49:12] <aatch> Well Owned is normally inferred, right?
[22:49:31] <kesserich> strcat: so let me try to understand what is happening here.  you are creating an owned vector of integers. 
[22:49:47] <strcat> rusti_: let mut xs = ~[1, 2, 3]; fn foo(xs: &mut ~[int]) { xs.push(4); }; foo(&mut xs); xs
[22:49:48] <rusti_> ~[1, 2, 3, 4]
[22:49:51] <kesserich> when you call foo why do you then need the '& mut'
[22:49:59] <strcat> kesserich: to take a reference to it
[22:50:03] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[22:50:06] <strcat> the function takes &mut ~[int]
[22:50:17] <strcat> &mut [int] is only a slice, you can't change the size by appending
[22:50:22] <strcat> it's just a mutable view of elements
[22:50:28] <strcat> not a mutable reference to a vector
[22:50:31] <Tad> Rust still confuses me :P
[22:50:50] <aatch> Tad, it's mostly just the move vs copy vs borrow
[22:50:59] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[22:51:02] <strcat> rusti_: let mut xs = ~[1, 2, 3]; fn foo(mut xs: ~[int]) -> ~[int] { xs.push(4); xs }; foo(xs)
[22:51:04] <rusti_> more than 5 lines of output, pastebinned: http://sprunge.us/eHNX
[22:51:18] <strcat> rusti_: let xs = ~[1, 2, 3]; fn foo(mut xs: ~[int]) -> ~[int] { xs.push(4); xs }; foo(xs)
[22:51:19] <rusti_> ~[1, 2, 3, 4]
[22:51:21] <strcat> not much difference.
[22:51:21] <Tad> aatch, ehm. I'm only here because my bouncer won't let me take it off of my chan list
[22:51:27] <Tad> it kicks out errors when I do
[22:51:33] <kesserich> strcat: i thought that using &'s in the calling code was not nescessary to get borrowed pointers to owned boxes.
[22:51:45] <strcat> kesserich: ~[] isn't an owned box
[22:51:48] <kesserich> compute_distance(shared_box, unique_box);
[22:52:09] <strcat> kesserich: vectors and strings are part of the language syntax, they're a special case
[22:52:21] <kesserich> interesting
[22:52:36] <strcat> [1, 2, 3] is an [int, ..3] (fixed-size, unboxed)
[22:52:38] <aatch> str and [T] aren't types by themselves
[22:52:44] <strcat> ~[1, 2, 3] is just ~[int]
[22:52:52] <strcat> nmatsakis has a proposal to change these and make them not special cases
[22:53:07] <aatch> Which will be awesome! and much less confusing
[22:53:14] <strcat> by adding a concept of types without a known size (so you can't allocate them unboxed, like trait objects)
[22:53:34] <strcat> rusti_: let xs = ~[1, 2, 3]; fn foo(mut xs: ~[int]) -> ~[int] { xs.push(4); xs }; foo(xs)
[22:53:35] <rusti_> ~[1, 2, 3, 4]
[22:53:49] <strcat> kesserich: in that example xs gets moved into foo (pointer copy) and then returned by pointer-copy too
[22:53:58] <strcat> so it's not much more expensive, just less convenient most of the time
[22:54:10] <kesserich> strcat: the pointer copy is because of the borrow?
[22:54:19] <strcat> kesserich: no this is a 2nd example
[22:54:23] <strcat> no borrow in this
[22:54:31] <aatch> I used the take owned -> return owned pattern recently
[22:54:43] <aatch> Because one of the possible results was itself
[22:55:26] <strcat> http://static.rust-lang.org/doc/tutorial.html#move-semantics touched on there
[22:55:26] <kesserich> strcat: sorry, i am still confused.  let xs = ~[1,2,3] is declaring an vector of integers.  I assumed this was owned because of the sigital.  it is not?
[22:55:38] <aatch> kesserich, it is
[22:55:42] <strcat> kesserich: it's owned, but ~ doesn't mean 'owned box' there
[22:55:50] <strcat> ~[] is a dynamically sized owned vector
[22:55:55] <strcat> it's one unit
[22:56:38] <strcat> ~[1, 2, 3] is a dynamically sized vector, ~([1, 2, 3]) is a fixed-size vector in an owned box
[22:57:08] <strcat> ~[], &[], @[] are special cased in the syntax
[22:57:21] <strcat> for now
[22:57:24] *** Quits: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Quit: Leaving)
[22:57:37] <aatch> kesserich, think of it as this C struct: struct OwnedVec { void * data; unsigned int len }
[22:57:54] <aatch> (which is actually pretty close to the real representation)
[22:58:28] <aatch> and that struct is what you are passing around
[22:59:57] <kesserich> ok, i will accept that ~[] is a 'dynamically sized vector' and thus needs to make use of & to be borrowed.
[23:00:29] *** Quits: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[23:00:30] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:00:37] <kesserich> why then do we declare xs to be mutable in foos fn signature?
[23:00:56] <aatch> kesserich, because mutable borrows have different semantics
[23:00:59] <strcat> kesserich: that 2nd example isn't using a borrowed ptr
[23:01:13] <strcat> rusti: let mut xs = ~[1, 2, 3]; fn foo(xs: &mut ~[int]) { xs.push(4); }; foo(&mut xs); xs
[23:01:14] <rusti> ~[1, 2, 3, 4]
[23:01:18] <strcat> that uses a mutable borrowed ptre
[23:01:31] <strcat> rusti: let xs = ~[1, 2, 3]; fn foo(mut xs: ~[int]) -> ~[int] { xs.push(4); xs }; foo(xs)
[23:01:32] <rusti> ~[1, 2, 3, 4]
[23:01:42] <strcat> that's by-value (ptr-copy to pass, ptr-copy to return)
[23:02:22] <strcat> moves xs into the fn and then out
[23:02:41] <kesserich> >Since in owned boxes mutability is a property of the owner, not the box, mutable boxes may become immutable when they are moved, 
[23:02:59] <aatch> kesserich, true
[23:03:17] <strcat> kesserich: which example are you referring to?
[23:03:40] <kesserich> strcat: the link you provided on move semantics: http://static.rust-lang.org/doc/tutorial.html#move-semantics
[23:04:29] <strcat> mutability is created in two places: 'let mut' and '@mut'
[23:04:40] <strcat> those are the top-level owners
[23:04:50] <strcat> everything else inherits mutability from one of those places
[23:05:08] <strcat> & observes immutability, &mut observes mutability
[23:05:25] <kesserich> during the invocation of foo(), the vector is moved and now becomes owned by foo() in a mutable context.
[23:05:28] *** Quits: libertas (libertas@554C17A.C07C8950.593B3862.IP) (Quit: Lost terminal)
[23:05:35] <strcat> kesserich: yes
[23:05:45] *** Joins: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[23:05:59] <kesserich> after foo returns, the ownership transfered back to the calling code
[23:06:05] <strcat> yeah
[23:06:22] <strcat> in the &mut example, the calling code keeps ownership of it the whole time
[23:06:23] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[23:06:37] *** Quits: KindOne (KindOne@moz-AAA92C5A.dynamic.ip.windstream.net) (Ping timeout)
[23:06:43] <strcat> which is usually better (unless you *really* need to do something that needs ownership)
[23:07:38] <kesserich> strcat: so which examples is more performant.
[23:07:40] <kesserich> ?
[23:07:59] *** Joins: KindOne (KindOne@moz-AAA92C5A.dynamic.ip.windstream.net)
[23:08:16] <strcat> kesserich: neither really
[23:08:16] <aatch> kesserich, technically the mutable borrow, probably
[23:08:33] <aatch> but your looking at it being on the order of single instructions difference
[23:08:40] <strcat> rusti: sys::size_of::<~[int]>()
[23:08:40] <kesserich> interesting.
[23:08:40] <rusti> 8
[23:08:48] <strcat> it's only a ptr on the stack
[23:08:52] <strcat> so moving is a ptr copy
[23:08:52] <kesserich> the borrow is just passing a ptr.
[23:08:59] <aatch> rusti: sys::size_of::<&~[int]>(
[23:09:00] <rusti> foo.rs:6:4: 6:5 error: incorrect close delimiter: `}`
[23:09:00] <rusti> foo.rs:6     });
[23:09:00] <rusti>              ^
[23:09:04] <strcat> kesserich: yeah, and the other is doin two ptr copies
[23:09:06] <aatch> rusti: sys::size_of::<&~[int]>()
[23:09:07] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/TNKD
[23:09:09] <kesserich> let xs = ~[1, 2, 3]; fn foo(mut xs: ~[int]) -> ~[int] { xs.push(4); xs }; foo(xs)
[23:09:16] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[23:09:23] <aatch> rusti: sys::size_of::<&'static ~[int]>()
[23:09:24] <rusti> 8
[23:09:24] <strcat> foo(xs) is a ptr copy and returning xs is a ptr copy
[23:09:53] <kesserich> i'm surprised that the example i just pasted is copying the entire structure of xs
[23:09:55] <strcat> the compiler also generates a zero of xs when it moves
[23:10:08] <strcat> kesserich: it's not
[23:10:13] <strcat> it's only a pointer copy
[23:10:13] <kesserich> errr...isn't copying the entire structure
[23:10:17] *** Quits: Erik (Erik-S@moz-252DBA2.hsd1.co.comcast.net) (Quit: ~ Trillian - www.trillian.im ~)
[23:10:20] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[23:10:27] <strcat> kesserich: assignment/passing/returning is all by-shallow-copy
[23:10:39] <strcat> so when there's a destructor it moves ownership (to avoid a double free and other horrible things)
[23:10:57] <strcat> to pass by-copy you have to do an explicit copy in the caller
[23:10:58] <aatch> kesserich, why would it need to? The move semantics means the compiler will throw an error if you try to use xs after the call
[23:11:02] <strcat> foo(xs.clone())
[23:11:13] <strcat> in which case xs is still usable in the caller
[23:12:07] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[23:12:09] <kesserich> it seems to me that xs, the dynamically sized vector must be represented as some kind of data structure. And that by not using a borrowed pointer, the machine would have to copy the entire structure over to the new stack frame.
[23:12:23] <strcat> kesserich: it copies the pointer to memory on the heap
[23:12:40] <strcat> and considers it moved from in the caller (can no longer be used, and won't be destroyed by the caller)
[23:13:07] <strcat> it's not different than C
[23:13:09] <aatch> Oh right, I forgot that vectors are pointer to the vector representation, not the repr themselves
[23:13:27] <strcat> C does shallow copies too
[23:13:35] <strcat> a = b or foo(a) stops at pointers
[23:13:38] <kesserich> strcat: is that because it is a vector?  I mean, if i was to attempt the same thing with a large struct for instance, would it also only pass a pointer?
[23:13:50] <strcat> kesserich: if you have ~LargeStruct
[23:14:06] <kesserich> oh i see, it's a shallow copy, so it stops at pointers
[23:14:09] <strcat> kesserich: a move has to copy the unboxed part
[23:14:12] <strcat> yeah
[23:14:23] <kesserich> and the vector internally contains a pointer to all of its data
[23:14:34] <strcat> if LargeStruct is 64-bytes, passing it by-value is a 64-byte copy
[23:14:53] <strcat> returning it by-value implicitly allocates it in the caller and passes in a pointer for the callee to write to
[23:15:15] <kesserich> sorry, i haven't down memory management since uni.  I'm write clojure all day long.
[23:15:16] * aatch loves that return style
[23:15:19] <kesserich> done
[23:15:41] <strcat> kesserich: well it also works like python, if you want to think of it in higher-level terms
[23:15:50] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Quit: This computer has gone to sleep)
[23:16:05] <strcat> by-value assignment/passing/returning copies up to types that are handles/references
[23:16:13] <aatch> kesserich, don't worry, memory management is a difficult topic. This is why Rust exists to some extent
[23:16:26] <strcat> the difference is that rust considers that a move of ownership and stops you from still using it
[23:17:01] <strcat> (if it has a destructor)
[23:17:09] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[23:18:34] <kesserich> gotcha
[23:18:38] <strcat> kesserich: the tutorial really needs a *lot* more examples and better explanations of all this
[23:18:44] <strcat> I've slowly been working on it
[23:19:01] <kesserich> so how would i go about creating an empty vector? let mut results:  ~[~str] = []; will not compile
[23:19:09] <aatch> kesserich, ~[]
[23:19:23] <kesserich> oh duh :P
[23:19:31] <aatch> in fact, if it can infer the type, you don't even need the ~[~str] bit
[23:19:31] <kesserich> thanks
[23:20:10] <aatch> rusti: let mut v = ~[]; v.push(~"String"); v
[23:20:11] <rusti> ~[~"String"]
[23:20:23] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[23:22:51] <kesserich> that works. fantastic.  I appreciate everyone's help and patience.
[23:24:20] <kesserich> is there some documentation i can browser to help me understand vectors better?  I'm stil not clear on the meanings of the sigils with respect to vectors
[23:26:39] <strcat> kesserich: not really any good documentation for them yet
[23:27:04] <strcat> ~[int] and @[int] are the dynamic arrays, [int, ..n] is a fixed-size one
[23:27:14] <strcat> and then there are slices (views) &[int] and &mut [int]
[23:28:00] <strcat> the tutorial is actually *wrong* in that section
[23:28:03] <strcat> which isn't helpful...
[23:28:05] <kesserich> strcat: and all of these vector types live on the heap?
[23:28:16] <strcat> kesserich: ~[int] and @[int] do
[23:28:21] <strcat> [int, ..n] is unboxed
[23:28:22] <aatch> except for fixed size
[23:28:33] <strcat> &[int] is really a vector, it's a view of any vector
[23:28:36] <strcat> isn't really*
[23:29:32] <kesserich> and ~[int] is still owned in the sense that only one context can reference it at a time?
[23:29:51] <aatch> rusti: struct Foo { a:int, b:[u64..32] } sys::size_of::<Foo>()
[23:29:52] <rusti> foo.rs:5:35: 5:37 error: expected `]` but found `..`
[23:29:52] <rusti> foo.rs:5          struct Foo { a:int, b:[u64..32] } sys::size_of::<Foo>()
[23:29:52] <rusti>                                             ^~
[23:29:58] <aatch> rusti: struct Foo { a:int, b:[u64,..32] } sys::size_of::<Foo>()
[23:29:59] <rusti> 264
[23:30:22] <aatch> rusti: struct Foo { a:int, b:~[u64] } sys::size_of::<Foo>()
[23:30:24] <rusti> 16
[23:30:33] <strcat> kesserich: yes, ~[int] is a unique handle to a vector
[23:30:40] <strcat> you can have any number of slices into it
[23:30:51] <kesserich> but you still must explicitly borrow it...which is confusing
[23:31:01] <strcat> kesserich: well it coerces to a slice
[23:31:08] <strcat> kesserich: ~T coerces to &T
[23:31:15] <strcat> and ~[int] coerces to &[int]
[23:31:31] <strcat> if you want to change the size of the vector, you need more than a slice
[23:31:41] <kesserich> ahhhh
[23:31:44] <aatch> and mut ~T coerces to &mut T
[23:32:27] <kesserich> so with vectors a '&' is necessary to expliclity state the borrow or the compiler coerces it into a slice.
[23:32:35] <strcat> kesserich: yeah
[23:32:38] <strcat> it's similar to owned boxes though
[23:32:45] <strcat> ~T coerces to &T, not &~T
[23:33:18] <strcat> but you can't really do much with the fact you can see the box's handle
[23:33:26] <strcat> with a vector you need the handle to do stuff with length/capacity
[23:33:43] <kesserich> not sure i understand the distinction between &T and &~T
[23:34:08] <strcat> kesserich: well with &T you just see the element inside the box
[23:34:21] <strcat> with &~T you see the box's handle too
[23:34:22] <strcat> so say
[23:34:23] <aatch> &T is a borrowed pointer to T, &~T is a borrowed pointer to a owned box containing T
[23:34:33] <goldfeld> does () mean void? as in "expected () but found @
[23:34:34] <strcat> rusti: let mut x = ~5; x
[23:34:35] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/LDjP
[23:34:40] <goldfeld> @-ptr*
[23:34:45] <aatch> goldfeld, yep
[23:34:57] <aatch> you probably added a semicolon where you didn't mean to
[23:35:22] <aatch> or actually didn't add it
[23:35:24] <strcat> kesserich: ok for example if you have two &mut T
[23:35:26] <strcat> and you swap them
[23:35:41] <goldfeld> I think it may be because I'm returning a match that deals with @-ptr but my function hasn't been type annotated
[23:35:43] <strcat> you're doing moves of T
[23:35:49] <aatch> (swapped the error message around)
[23:36:01] <strcat> if you have &mut ~T and you swap them, you're doing moves of the pointer handle
[23:36:21] <aatch> goldfeld, you need to have -> @T 
[23:36:30] <aatch> unless it's closure
[23:36:33] <strcat> there's not much more you can do by having &mut ~T - but with a vector, the ~[] handle is what you need to push elements, pop elements, reserve space, etc.
[23:36:37] <aatch> Rust doesn't do return type inference
[23:36:52] <strcat> kesserich: you could think of ~[] as being a struct
[23:36:55] <EXetoC> "" == "-> ()" :>
[23:37:01] <strcat> kesserich: and &[] as being a borrow of *part* of the struct
[23:37:05] <goldfeld> yeah that solved it, thanks
[23:37:16] <strcat> kesserich: not the part with length/capacity, just the data
[23:37:41] <EXetoC> I like the way () works, because it simplifies generic programming
[23:37:48] <kesserich> strcat: ok, i see your point.
[23:37:59] <goldfeld> has anyone gotten vim's :make working for Rust? Mine says there's e.g. 7 quickfix entries but I can only jump to two
[23:38:01] <aatch> () is, like in a few language, a type and a value
[23:38:31] <goldfeld> it's working but a bit wacky
[23:38:56] <aatch> goldfeld, some of it is it not getting the right spans
[23:39:02] <strcat> goldfeld: need to change errorformat I guess
[23:39:12] <aatch> you occasionally get 0:1 spans
[23:39:21] <goldfeld> aatch: yeah, I really like rust's type system so far
[23:39:36] <strcat> deltas between daily builds of incoming aren't working out so well ;p
[23:39:42] <strcat> they're usually huge
[23:39:44] <goldfeld> hmm, yeah I figured it would be about the errorformat, but isn't that something a plugin should take care of?
[23:40:05] <aatch> goldfeld, if the plugin is designed to, yeah
[23:40:11] <goldfeld> I mean, I'll happily do it if no one has so far
[23:40:24] <goldfeld> love any opportunity to get down with regex
[23:40:31] *** Joins: jack (jack@EF36212C.8FA609AD.840029BC.IP)
[23:40:33] <aatch> goldfeld, go for it.
[23:40:44] <aatch> I'm a vim user too
[23:40:45] <goldfeld> or I guess people have but syntax changes break it frequently?
[23:41:00] <aatch> Actually the error format is pretty stable
[23:41:06] <strcat> goldfeld: there isn't a vim indent file yet either ;p
[23:41:10] <aatch> there was a recent change to the span underlining
[23:41:28] <aatch> strcat, I am just about to start work on the vim indent file lol
[23:41:34] <aatch> literally right now
[23:41:35] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[23:41:41] <strcat> goldfeld: ideally it would be set in etc/vim/ftplugin/rust.vim
[23:41:45] <strcat> (errorformat)
[23:41:49] <goldfeld> strcat: no? wting/rust.vim hasn't been annoying me with indentation
[23:41:57] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[23:42:04] <strcat> goldfeld: well it screws up on attributes and match
[23:42:06] <strcat> among other things
[23:42:08] <aatch> goldfeld, it doesn't handle a few things very well
[23:42:11] <goldfeld> I see
[23:42:14] <aatch> structs and enums too
[23:42:16] *** Quits: jack (jack@EF36212C.8FA609AD.840029BC.IP) (Ping timeout)
[23:42:24] <aatch> " Vim indent file
[23:42:24] <aatch> if exists("b:did_indent")
[23:42:24] <aatch> 	finish
[23:42:24] <aatch> endif
[23:42:24] <aatch> let b:did_indent = 1
[23:42:24] <aatch> setlocal smartindent
[23:42:28] <aatch> That is the indent file
[23:42:33] <strcat> http://pkgbuild.com/~thestinger/repo/x86_64/ *sigh*
[23:42:40] <strcat> delta to the last version is 16MiB ;p
[23:42:40] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[23:42:48] <aatch> strcat, woah!
[23:42:57] <strcat> but compressing the 83MiB package ends up at 26MiB which is hardly much worse...
[23:42:57] <aatch> What caused that?
[23:43:08] <strcat> aatch: dunno, that's just like a 12 hour difference
[23:43:22] <aatch> insane.
[23:43:28] <strcat> revision 902 since 0.6 to revision 914 since 0.6
[23:43:38] <aatch> I don't remember seeing any big pull reqs go through
[23:43:41] <strcat> maybe the codegen is really non-deterministic ;\
[23:44:14] <strcat> I could see different orderings of hash tables being amplified into changes in the binaries
[23:44:25] <strcat> since it's a delta of the machine code.
[23:44:37] <goldfeld> that's cool, I'll take a look at the errorformat and I'll ping you if I come up with something cool aatch, seems you're gonna get a plugin up on github? 
[23:45:02] <aatch> goldfeld, there is already a rust plugin in the rust repo
[23:45:24] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:45:34] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (NickServ (GHOST command used by strcat1))
[23:45:37] *** strcat1 is now known as strcat
[23:45:39] *** Joins: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:45:51] <aatch> src/etc/vim
[23:46:12] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:46:22] * strcat should just turn up xz compression from -6
[23:46:22] <goldfeld> well, that's pretty authoritative then, i'll see if i can get a pr there within a couple days
[23:46:24] *** Quits: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[23:46:35] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:48:05] *** Quits: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba) (Quit: Leaving)
[23:48:31] * aatch reads how to write an indent file
[23:48:32] *** Quits: nejucomo (nejucomo@8AA09B0D.23518FA3.CE794808.IP) (Client exited)
[23:50:36] *** Joins: MrFahrenheit (RageOfThou@moz-CF7139ED.dynamic.telemach.ba)
[23:58:41] *** Joins: nejucomo (nejucomo@68DD7008.27435823.DC56C324.IP)
[23:59:59] * aatch is turning off re-indenting on '#'
