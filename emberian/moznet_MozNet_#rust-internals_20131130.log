[00:10:27] <strcat> acrichto: https://github.com/mozilla/rust/pull/10730 thoughts?
[00:11:08] <dbaupp> strcat: why not ctlz8 etc?
[00:11:17] <strcat> dbaupp: they use a bool
[00:11:23] <strcat> an LLVM bool, so i1
[00:11:28] <dbaupp> ah
[00:55:52] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[00:56:31] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[00:57:00] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[00:59:31] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[00:59:38] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:00:09] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:06:29] *** Quits: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:08:05] *** Joins: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net)
[01:10:11] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[01:15:08] <jack> can someone explain to me what libstd is trying to link to with --cfg test? it has extern mod realstd(name="std") and extern mod extra(vers="0.9-pre"); etc
[01:15:18] <jack> it's failing with my pkgid changes, but i'm not sure why
[01:16:55] <jack> https://gist.github.com/metajack/7714151
[01:16:55] <ChrisMorgan> r? https://github.com/mozilla/rust/pull/10731 (and bors is being lazy!)
[01:19:53] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[01:21:00] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[01:21:21] *** kimundi is now known as zz_kimundi
[01:26:38] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:26:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148861043 to 1480991bb: 02http://git.io/N3iJvQ
[01:26:38] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:26:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[01:26:42] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/B2WPbA
[01:26:42] <ghrust> 13rust/06auto 14d3019af 15Chris Morgan: Fix double slashes in make paths....
[01:26:42] <ghrust> 13rust/06auto 145ba5756 15bors: auto merge of #10731 : chris-morgan/rust/fix-double-slashing, r=metajack...
[01:26:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[01:27:39] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[01:30:38] *** flaper87 is now known as flaper87|afk
[01:58:51] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[02:09:58] *** Quits: SiegeLord (sl@moz-C606190.bstnma.fios.verizon.net) (Quit: Leaving)
[02:12:19] *** Quits: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net) (Quit: dbaupp)
[02:13:01] *** Joins: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net)
[02:20:48] *** zz_kimundi is now known as kimundi
[02:34:58] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[02:37:37] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:37:37] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 147f78212 to 141370c7a: 02http://git.io/k471pw
[02:37:37] <ghrust> 13rust/06try 14e338a41 15Alex Crichton: Add generation of static libraries to rustc...
[02:37:37] <ghrust> 13rust/06try 149fbba7b 15Alex Crichton: Statically link librustrt to libstd...
[02:37:38] <ghrust> 13rust/06try 146d6ccb7 15Alex Crichton: Add a new run-make test directory...
[02:37:40] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:08:39] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[03:20:07] *** Quits: kimundi (kimundi@moz-E2132B33.dip0.t-ipconnect.de) (Ping timeout)
[03:23:59] *** Joins: kimundi (kimundi@moz-6B8BCD77.dip0.t-ipconnect.de)
[03:27:51] *** kimundi is now known as zz_kimundi
[03:33:17] *** Joins: lkuper (lkuper@moz-72054E1A.nyc.res.rr.com)
[03:34:38] *** zz_kimundi is now known as kimundi
[03:47:13] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:48:32] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:57:11] <cmr> https://news.ycombinator.com/item?id=6820844
[03:57:14] <cmr> We have all of those things.
[03:57:25] <cmr> We just need to document and polish how we present the language to impress people :D
[03:59:04] <dbaupp> cmr: only one of them is in the std lib though
[04:01:37] <cmr> dbaupp: well, they're all in separate libs in their "stdlib", so it seems like it'd be more like our extra conglomerate
[04:01:57] <cmr> afaikt
[04:02:16] <dbaupp> I guess so
[04:03:56] <strcat> life is easier if you just use libcurl like D ;p
[04:04:41] <strcat> ' DICT, FILE, FTP, FTPS, GOPHER, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMTP, SMTPS, TELNET and TFTP'
[04:05:30] <strcat> and it supports openssl, gnutls, nss, and at least 6 other ssl libs... yay? ;p
[04:05:36] <strcat> (and MIT licensed!)
[04:05:48] * strcat shrugs
[04:06:26] <strcat> obviously writing pure rust is nice, but leveraging existing libs would get you a lot more today
[04:07:01] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[04:07:01] *** ChanServ sets mode: +qo brson brson
[04:08:29] <cmr> yeah
[04:08:35] <cmr> there was libcurl bindings somewhere
[04:08:38] <cmr> at somepoint
[04:08:47] <strcat> it would be better now that we have vararg support
[04:09:11] <strcat> there are even async bindings you could hook up to libuv but I don't care about that ;p
[04:11:29] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[04:13:10] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[04:14:01] <ChrisMorgan> Hmm. Looks like something like `0b13` is actually turned into *two* tokens, 0b1 and 3. Yuck.
[04:15:07] <strcat> wat
[04:15:18] <strcat> well that makes sense...
[04:15:23] <strcat> because it's invalid
[04:15:29] <ChrisMorgan> rusti: macro_rules! ick(($num:expr $var:ident)=>(let $var = $num)) ick!(0xfmeissad); println!("{:?}", meissad);
[04:15:31] -rusti- 15
[04:15:31] -rusti- ()
[04:17:19] <ChrisMorgan> It's only in macros that it'll come through; after a number literal it expects ; or }
[04:17:49] * ChrisMorgan now tosses up what he should do about number highlighting in Vim
[04:19:34] <ChrisMorgan> My original plan had been error highlighting for "bad" literals, but I think I'll just remove the end-of-word constraint (leaving the not-quite-correct-but-close-enough start-of-word constraint in, so that in a literal like 0b13, the 3 won't be highlighted but the rest will)
[04:21:00] <strcat> cmr: well I plan on writing some anyway... ;p
[04:26:01] <strcat> this stupid performance ratchet test always fails for me
[04:26:12] <strcat> : [codegen] codegen/iterate-over-array.rs.clang-codegen-ratioregressed by 4.26%
[04:26:22] <strcat> why doesn't this happen to anyone else? :(
[04:46:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:46:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145ba5756 to 1480991bb: 02http://git.io/N3iJvQ
[04:46:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:46:47] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:46:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/gbSl_w
[04:46:47] <ghrust> 13rust/06auto 14d3019af 15Chris Morgan: Fix double slashes in make paths....
[04:46:47] <ghrust> 13rust/06auto 14afde602 15bors: auto merge of #10731 : chris-morgan/rust/fix-double-slashing, r=metajack...
[04:46:48] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:49:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:49:30] <ghrust> 01[13rust01] 15huonw 04force-pushed 06try from 141370c7a to 14f7a14e0: 02http://git.io/k471pw
[04:49:30] <ghrust> 13rust/06try 149cee36b 15Kiet Tran: Make reachable reusable in dead-code pass
[04:49:30] <ghrust> 13rust/06try 141415451 15Kiet Tran: Add dead-code warning pass
[04:49:30] <ghrust> 13rust/06try 14f7a14e0 15Kiet Tran: Remove dead codes
[04:49:31] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:53:28] <cmr> ktt3ja: ping
[04:54:16] <ktt3ja> cmr: pong
[04:54:30] <cmr> ktt3ja: it'd be useful to have a flag that counts unused `pub` things as dead too
[04:54:35] <cmr> Biggest usecase: rustc
[04:54:56] <cmr> it's librustc, and so a lot of things are pub. but, librustc is basically entirely self-contained, and many things that are dead should be removed.
[04:55:20] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:55:24] <ktt3ja> cmr: currently ReachableContext distinguishes between lib crate and bin crate, so my dead-code pass does, too
[04:56:14] <dbaupp> cmr, ktt3ja: that's not needed for the first implementation
[04:56:20] <ktt3ja> so if it's a pub item that's not externally seen in a lib crate, or it's a pub item that's never used in a bin crate, then it should be dead
[04:56:31] <ktt3ja> (assuming no bug :P)
[04:57:25] <cmr> well, it should be fairly easy then since librustc has a main
[04:57:34] <dbaupp> cmr: librustc is a library...
[04:57:51] <sfackler> acrichto: ping
[04:57:53] <cmr> dbaupp: it can be compiled as a bin too
[04:58:14] <cmr> (at which point it becomes 'rustc')
[04:58:31] <acrichto> sfackler: pong
[04:59:08] <dbaupp> cmr: no? I thought the bin was by src/driver
[04:59:12] <sfackler> BufferedWriter not flushing at drop time has been annoying me, so i'm thinking about making it do that. the two issues are 1) what do to about Decorator and 2) what happens if the flush fails
[04:59:20] <dbaupp> cmr: which imports it as an extern mod
[04:59:32] <sfackler> for 1, I'm probably just going to split Decorator into Decorator and MoveDecorator
[04:59:37] <acrichto> sfackler: safely implementing this means that the inner writer is Option<T>
[04:59:47] <dbaupp> acrichto: did you see https://github.com/mozilla/rust/issues/10710 , btw?
[04:59:48] <acrichto> I'm also not a fan of Decorator at all
[04:59:50] <acrichto> I've been meaning to remove it
[04:59:58] <sfackler> that works too
[05:00:02] <acrichto> dbaupp: I did, I did something earlier today...
[05:00:11] <acrichto> sfackler: but inner_mut_ref makes no sense for BufferedWriter
[05:00:17] <acrichto> you can corrupt the stream
[05:00:35] <acrichto> dbaupp: ah yay it's succeeding now
[05:00:36] <acrichto> http://buildbot.rust-lang.org/builders/doc
[05:00:47] <cmr> dbaupp: well, that also works.
[05:00:56] <sfackler> yeah, it seems like what you'd actually want is a method that consumes the bufferedwriter, flushes and then returns the underlynig stream
[05:01:00] <sfackler> *underlying
[05:01:03] <cmr> dbaupp: but src/librustc/lib.rs can be compiled as a bin directlyh
[05:01:17] <acrichto> sfackler: I think that Drop should flush, and inner() should become unwrap()
[05:01:25] <dbaupp> acrichto: oh, awesome
[05:01:26] <sfackler> ok
[05:01:28] <dbaupp> cmr: oh, really?
[05:01:38] <acrichto> sfackler: although perhaps the field with the writer should just be public
[05:01:44] <dbaupp> cmr: but the rustc binary itself is from src/driver, right?
[05:01:45] <acrichto> oh no nmvd
[05:01:51] <acrichto> then you can't unwrap + flush
[05:01:53] <sfackler> and then what happens when drop gets called in a failing task?
[05:02:09] <sfackler> I was thinking just trap all io_errors in that case
[05:02:10] <acrichto> how so?
[05:02:14] <sfackler> and hope for the best
[05:02:27] <acrichto> seems reasonable to me
[05:02:33] <acrichto> do io::ignore_io_error { ... }
[05:02:33] <cmr> dbaupp: yeah
[05:02:55] <cmr> on an unrelated note, strike suit zero is a really fun game (and runs on linux)
[05:03:06] <acrichto> omfg windows builds locally but not on bots urgh
[05:03:45] <acrichto> static linking is so close...
[05:04:48] <acrichto> sfackler: if you're feeling ambitious and want to remove the Decorator trait entirely, I would r+ that
[05:04:59] <acrichto> I'd want to run it by others first, but I don't imagine there will be much resistance
[05:05:07] <ChrisMorgan> acrichto: what gets done in its place for that common pattern?
[05:05:17] <acrichto> ChrisMorgan: just have a method unwra()
[05:05:18] <acrichto> unwrap()
[05:05:32] <acrichto> Decorator forces you to have inner_ref and inner_mut_ref
[05:05:38] <acrichto> you don't always wnat innter_mut_ref()
[05:05:45] <acrichto> in the case of all buffered things you can just corrupt the stream
[05:05:53] <acrichto> plus it's just another import at the top of the file which really isn't that useful
[05:08:02] <ChrisMorgan> I see it as useful for much more than IO.
[05:08:41] <acrichto> I fear it's "just another trait" that's taking the trait abstraction too far
[05:08:51] <acrichto> if you're wrapping something, then just have an 'unwrap' method, why have it in a trait?
[05:09:00] <acrichto> would you want to parameterize over a decorated thing?
[05:09:31] <ChrisMorgan> A good point. It does give a suggestion of a common interface, though beyond merely convention.
[05:09:55] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:09:55] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14f7a14e0 to 149d2e7c6: 02http://git.io/k471pw
[05:09:55] <ghrust> 13rust/06try 14e338a41 15Alex Crichton: Add generation of static libraries to rustc...
[05:09:55] <ghrust> 13rust/06try 149fbba7b 15Alex Crichton: Statically link librustrt to libstd...
[05:09:56] <ghrust> 13rust/06try 146d6ccb7 15Alex Crichton: Add a new run-make test directory...
[05:09:58] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:10:03] <ChrisMorgan> And Option.unwrap can fail, whereas inner() shouldn't.
[05:10:03] <acrichto> I also think that not everyone wanting to expose "inner_mut_ref" is a good argument for removal
[05:11:18] <sfackler> are there actually any use cases for inner_ref and inner_mut_ref?
[05:11:55] <acrichto> I can imagine inner_ref being wanted (reading statistics pehaps?)
[05:11:58] <dbaupp> inner_ref() == @mut SomethingImplingDecorator
[05:12:01] <acrichto> inner_mut_ref is dangerous though
[05:12:30] <ChrisMorgan> Used in rustc::metadata::encoder once.
[05:13:12] <acrichto> haha I wouldn't take the encoder as an example though
[05:13:15] <ChrisMorgan> (src/librustc/metadata/encoder.rs:1859)
[05:13:19] <sfackler> we could just kill off inner_mut_ref
[05:13:19] <acrichto> I was scrambling to remove std::io at that point
[05:13:32] <sfackler> potentially adding a method to create a new buffered writer with the buffer of an old one
[05:13:39] <acrichto> I don't think that the Decorator trait is worthwhile though
[05:13:40] <sfackler> to avoid having to reallocate
[05:13:59] <acrichto> it doesn't belong in the prelude, and it's just another import
[05:14:16] <ChrisMorgan> And in that case, wr.inner() would work fine instead of wr.inner_mut_ref(), wr is not needed any more
[05:14:58] <sfackler> ChrisMorgan: don't you want the opposite of inner in that case?
[05:15:09] <sfackler> you don't care about the writer but you want to reuse the buffer?
[05:15:42] <ChrisMorgan> sfackler: inner(self) -> T.
[05:16:36] <sfackler> right, but how does that help if you're trying to make a new buffered writer and don't want to allocate another 64k for a new buffer?
[05:16:55] <strcat> acrichto: the thing that makes me sad is the tokenizer in the compiler and json storing invalid values in char ;[
[05:17:05] <strcat> it's like Option didn't exist then...
[05:17:17] <ChrisMorgan> Erk, `wr.inner_ref().to_owned()` where `wr.inner()` would do what was desired :-/
[05:17:24] <acrichto> I think char was just more forgiving
[05:17:33] <strcat> acrichto: well it was, I did that change
[05:17:34] <acrichto> ChrisMorgan: you don't always own the outer buffer
[05:17:40] <acrichto> e.g @mut MemWriter
[05:17:40] <strcat> but it was still invalid
[05:17:46] <strcat> it wouldn't decode properly
[05:18:22] <ChrisMorgan> acrichto: I believe you do in that case, though (src/librustc/middle/astencode.rs:1345)
[05:18:48] <acrichto> ChrisMorgan: you can't move out of @
[05:18:56] <acrichto> once you move into it, it can never be moved out of
[05:19:09] <ChrisMorgan> Oh, so you actually can't use inner() on it?
[05:19:30] <acrichto> sadly no
[05:19:38] <dbaupp> http://buildbot.rust-lang.org/builders/try-mac/builds/710/steps/git/logs/stdio huh?
[05:19:38] <acrichto> although that's a bigger problem that @mut Writer is required
[05:19:47] <ChrisMorgan> Yeah.
[05:20:28] <ChrisMorgan> dbaupp: could not *parse*?
[05:20:38] <dbaupp> ChrisMorgan: presumably means the fetch failed
[05:20:45] <dbaupp> so the hash isn't in the repo
[05:21:04] <ChrisMorgan> But *parse*?
[05:22:33] <dbaupp> that's what git says
[05:22:46] <dbaupp> wait
[05:22:47] <dbaupp> hm
[05:26:46] <erickt1> dbaupp: r? https://github.com/mozilla/rust/pull/10727
[05:27:09] <erickt1> dbaupp: I added your suggestions
[05:27:23] <sfackler> acrichto: ugh, flush in drop won't work, running into the "vtables missing" ICE
[05:27:29] <dbaupp> erickt1: yay!
[05:27:41] <acrichto> sfackler: whoa haven't seen that one before
[05:27:42] <dbaupp> <3 un-@mut-ilating code.
[05:27:43] <erickt1> :) thanks for catching my gaps :)
[05:27:54] <sfackler> acrichto: generic destructors are totally broken
[05:28:09] * acrichto sighs
[05:28:16] <sfackler> apparently since calls to drop are inserted by llvm or something
[05:28:34] <acrichto> I knew they were broken but I didn't know they were that broken
[05:29:02] <ChrisMorgan> Yeah, generic drop has never worked. Method calls in a generic drop have been an ICE as long as I've been around and right from the start as far as I know.
[05:30:29] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:30:30] <ghrust> 01[13rust01] 15huonw 04force-pushed 06try from 149d2e7c6 to 146542de0: 02http://git.io/k471pw
[05:30:30] <ghrust> 13rust/06try 148c49653 15Kiet Tran: Make reachable reusable in dead-code pass
[05:30:30] <ghrust> 13rust/06try 1453f965d 15Kiet Tran: Add dead-code warning pass
[05:30:30] <ghrust> 13rust/06try 146542de0 15Kiet Tran: Remove dead codes
[05:30:31] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[05:31:49] <strcat> acrichto: you can't call methods from type bounds in generic dtors
[05:31:54] <strcat> I rant about it all the time! ;p
[05:31:55] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:31:55] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14afde602 to 1480991bb: 02http://git.io/N3iJvQ
[05:31:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:32:03] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[05:32:03] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/AHaPTA
[05:32:03] <ghrust> 13rust/06auto 1418ca312 15Erick Tryzelaar: Remove @ from json::Error
[05:32:03] <ghrust> 13rust/06auto 145b41df4 15Erick Tryzelaar: Remove some unnecessary impls from json
[05:32:03] <ghrust> 13rust/06auto 14f7b739c 15Erick Tryzelaar: extra: Rename json constructors into *::init
[05:32:05] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[05:32:16] * strcat doesn't really know how to fix it beyond rewriting half of trans
[05:33:02] <ChrisMorgan> Bah, another spurious failure... http://buildbot.rust-lang.org/builders/auto-mac-32-opt/builds/2708/steps/test/logs/stdio
[05:34:11] *** Quits: lkuper (lkuper@moz-72054E1A.nyc.res.rr.com) (Quit: lkuper)
[05:34:51] <ChrisMorgan> Why do we get so many spurious test failures there? And what can be done about it?
[05:37:34] <acrichto> if you can reproduce, we can fix it
[05:37:46] <acrichto> I try to reproduce almost all spurious failures I see
[05:37:47] <erickt1> Ugh. So I finally got my convert-serialization-to-a-token-stream working (yay! https://github.com/erickt/rust-serde) but it's slower than the old serializer :(
[05:37:50] <acrichto> I am unsuccessful on most
[05:38:23] <erickt1> stupid having to dynamically allocating a stack for a state machine...
[05:40:07] <dbaupp> erickt1: is that what perf tells you is the slow part?
[05:40:20] <strcat> callgrind! ;p
[05:40:33] <erickt1> dbaupp: I'm on a mac, and am having trouble getting instruments to work
[05:40:49] <Eridius> Why was Path::new() renamed to Path::init()?
[05:40:50] <dbaupp> erickt1: oh, I'll clone it and have a look.
[05:40:54] <erickt1> but I reduced my case down to a simple test case: https://gist.github.com/erickt/7715776
[05:41:05] <ChrisMorgan> acrichto: yes, I know. It's a nuisance and seems to be happening more and more frequently.
[05:41:12] <cmr> Eridius: new is going to be a keyword
[05:41:35] <Eridius> ugh, I hate that. `new Foo` looks so goddamn C++-like. And we already have a strong tradition of T::new() in our libraries
[05:41:42] <acrichto> ChrisMorgan: yeah I understand, but it's tough to fix problems which you have no idea how they're caused
[05:41:49] <erickt1> dbaupp:  it's a very-much microbenchmark. serde is the new version. it costs on average 20ns to malloc the stack, other than that the code's identical
[05:42:07] <Eridius> Honestly, the problem of people not realizing ~T does allocation is not one of syntax, but one of documentation
[05:42:07] <ChrisMorgan> Sure is. Oh for the consistent-and-crashy type of bug. So much easier to figure out what's going on.
[05:42:23] <cmr> Eridius: The problem isn't ~, the problem is that we need to support placement new.
[05:42:45] <cmr> (For gc/smart pointers)
[05:43:02] <Eridius> and there isn't some other way than to reserve `new` as a keyword?
[05:43:08] <erickt1> dbaupp: it might be a wash when dealing with larger structures. It's just frustrating after working on this for a couple weeks and it not being magically faster :)
[05:43:13] <cmr> The syntax is `new(expr1) expr2`, allocates expr2 in the thing expr1 evaluates to
[05:43:25] <Eridius> wow that's even more C++'y
[05:43:27] <dbaupp> erickt1: I see 2200ns/iter for extra and 2500ns/iter for serde, is that approximately what you see?
[05:43:36] <dbaupp> (well, the ratios at least.)
[05:43:59] <cmr> Eridius: if you have an alternate proposal, send it to the ML
[05:44:03] <erickt1> dbaupp: unoptimized, yeah. optimized it's about 600 vs 650 for me
[05:44:14] <dbaupp> oh, optimisations
[05:44:29] * dbaupp definitely didn't just forget about them <-<
[05:44:36] <erickt1> lol
[05:44:46] <cmr> Even more evidence --opt-level=2 should be the default!
[05:45:14] <dbaupp> ah, 370 to 410 now
[05:46:01] <erickt1> dbaupp: sadly what put me on this rewrite path was I had some other benchmarks that had an interator-style approach unoptimized as fast as the optimized extra::json version. I need to track down that benchmark and see what I was doing
[05:48:21] <dbaupp> yup, 50% of the time is spend in malloc and free if I do 1 million iterators of the body of the serde #[bench].
[05:48:31] * dbaupp guess part of that is the MemWriter allocation though.
[05:48:57] <erickt1> dbaupp: here's my old benchmark. it probably doesn't run at the moment: https://gist.github.com/erickt/7715806
[05:49:47] <erickt1> dbaupp: oh wait, that's not it
[05:50:41] <erickt1> shucks, I might have lost it
[05:52:10] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[05:56:35] <Eridius> cmr: proposal sent
[05:56:50] <cmr> Eridius: thanks!
[05:56:52] * cmr reads it
[05:57:29] <dbaupp> erickt1: I imagine it would be faster if we had a "small vec", so the allocation wasn't compulsory
[05:58:41] <erickt1> dbaupp: along those lines, I thought strcat proposed to make ~[] not allocate anything. That certainly would help me out in the trivial case
[05:59:23] <erickt1> dbaupp: a small vec would be pretty handy. I also heard that servo has plans on implementing one. Maybe we can get it landed in rust proper
[05:59:34] <dbaupp> erickt1: hm, you could try copying out libsyntax's opt_vec or small_vec just to test
[05:59:53] <cmr> it's waiting on the librification (I like how that almost sounds like liberation...) of vec from the language
[06:00:08] <dbaupp> (the former stores an empty vec as a null pointer, the latter stores one element vectors inline.)
[06:00:40] <erickt1> dbaupp: good idea. I'll try that next. Currently I'm expanding my micro benchmark to include lists to at least compare closures to the state machine
[06:03:31] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:03:31] <ghrust> 01[13rust01] 15huonw 04force-pushed 06try from 146542de0 to 14cae171f: 02http://git.io/k471pw
[06:03:31] <ghrust> 13rust/06try 14a0c37ae 15Kiet Tran: Add dead-code warning pass
[06:03:31] <ghrust> 13rust/06try 14cae171f 15Kiet Tran: Remove dead codes
[06:03:31] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:10:16] <erickt1> dbaupp: bah, it's even slower: https://gist.github.com/erickt/7715776. 1004 vs 1209
[06:10:43] <erickt1> stupid closures performing better than my bad state machines
[06:10:43] <dbaupp> erickt1: and for a longer list?
[06:12:15] <erickt1> dbaupp: yeah, even up to 21 strs in a vec: 5381 vs 6400
[06:12:36] <dbaupp> erickt1: hm, what's the longest that states gets?
[06:14:35] <erickt1> dbaupp: looks to be 2
[06:14:57] <dbaupp> so I guess reallocs aren't killing it.
[06:15:16] <dbaupp> either the allocs themselves, or something else entirely
[06:15:57] <erickt1> well first guess is the cpu is great at calling indirect function calls, whereas this state machine is a bit more opaque to it
[06:16:23] <dbaupp> possibly
[06:25:49] <acrichto> dbaupp: did you want two try builds running or is it ok to cancel the first?
[06:32:11] <dbaupp> acrichto: I guess it's ok to cancel the first one
[06:32:26] <dbaupp> acrichto: (I'm just pushing patches for ktt3ja)
[06:46:43] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[06:48:17] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[06:51:05] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:51:05] <ghrust> 01[13rust01] 15huonw 04force-pushed 06try from 14cae171f to 14a16f2dc: 02http://git.io/k471pw
[06:51:05] <ghrust> 13rust/06try 14434c01c 15Kiet Tran: Make reachable reusable in dead-code pass
[06:51:05] <ghrust> 13rust/06try 14974b952 15Kiet Tran: Add dead-code warning pass
[06:51:05] <ghrust> 13rust/06try 14a16f2dc 15Kiet Tran: Remove dead codes
[06:51:06] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:55:50] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[07:21:40] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[07:21:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143c3a5be to 1480991bb: 02http://git.io/N3iJvQ
[07:21:40] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[07:21:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:21:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/XDrGVA
[07:21:46] <ghrust> 13rust/06auto 146a2f3a0 15Seo Sanghyeon: Fix type inference for proc expressions
[07:21:46] <ghrust> 13rust/06auto 140486542 15bors: auto merge of #10728 : sanxiyn/rust/proc, r=cmr...
[07:21:47] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:43:25] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[07:45:15] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:45:15] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14a16f2dc to 14c482800: 02http://git.io/k471pw
[07:45:15] <ghrust> 13rust/06try 14e338a41 15Alex Crichton: Add generation of static libraries to rustc...
[07:45:15] <ghrust> 13rust/06try 149fbba7b 15Alex Crichton: Statically link librustrt to libstd...
[07:45:16] <ghrust> 13rust/06try 146d6ccb7 15Alex Crichton: Add a new run-make test directory...
[07:45:18] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:54:15] <acrichto> urgh fml https://github.com/mozilla/rust/issues/10734
[07:54:47] <Eridius> wow
[07:55:11] <Eridius> acrichto: I feel like I saw this before as a problem with `let _foo = ...`
[07:55:34] <cmr> acrichto: does it also do it withjust "let a = Foo;"?
[07:55:37] <Eridius> rusti: struct Foo; impl Drop for Foo { fn drop(&mut self) { println!("dropping"); } } if true { let _a = Foo; }
[07:55:38] -rusti- dropping
[07:55:38] -rusti- ()
[07:55:42] <Eridius> huh
[07:55:51] <acrichto> interesting, maybe it's a regression
[07:55:53] <cmr> yikes
[07:55:54] <Eridius> I see it twice on my local install
[07:55:56] <cmr> yeah
[07:55:57] <acrichto> cmr, can you confirm?
[07:55:59] <cmr> rusti: version
[07:56:01] -rusti- "rustc 0.8"
[07:56:01] *** Quits: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net) (Quit: Jesse)
[07:56:02] <Eridius> must be pretty new
[07:56:22] <Eridius> also I get the issue with `let a = Foo` too, so it's not a `let _foo` issue after all
[07:56:42] <cmr> acrichto: confirmed
[07:56:45] <cmr> that's miserable :\
[07:56:57] <acrichto> you have all the builds from 0.8-0.9pre lying around, right?
[07:57:07] <cmr> ah, that.
[07:57:13] <cmr> sure, I'll bisect.
[07:57:13] <acrichto> bisection magic, eh? eh?
[07:57:18] <acrichto> <3
[07:57:41] * acrichto finishes thinking that windows is awful, resumes thinking that debugging on windows is awful
[07:59:18] <Eridius> heh, `if { true } { ... }` doesn't exhibit the issue
[07:59:20] <cmr> acrichto: first, r? https://github.com/mozilla/rust/pull/10722
[07:59:43] <cmr> Eridius: neither does using an intermediate
[07:59:56] <acrichto> r+
[08:00:01] <Eridius> cmr: yeah, even a static doesn't repro it. I'm just amused at { true }
[08:00:13] <acrichto> we special-case "if true { ... }" in trans
[08:00:17] <cmr> yeah
[08:00:19] <acrichto> along with "if false { ... }"
[08:00:23] <acrichto> mainly for debug!
[08:00:25] <Eridius> acrichto: also apparently `if !false { ... }`
[08:00:39] <acrichto> we don't do much fanciness around our analysis
[08:00:39] <Eridius> and `if !!!false { ... }` ;)
[08:00:43] <acrichto> it only works for the literal true/false
[08:00:53] <Eridius> `if 0 == 0` works too
[08:00:58] <Eridius> (and by works I mean reproduces the issue)
[08:01:08] <Eridius> so if your special-case is literally for `if true` then that's not it
[08:01:23] <acrichto> hm, dunno then
[08:01:34] <acrichto> llvm magic
[08:03:28] <Eridius> I wonder if something is trying to constant-fold the expression, without actually replacing const statics with their values, before it gets to the trans special-case for `if true` ?
[08:06:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[08:06:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140486542 to 1480991bb: 02http://git.io/N3iJvQ
[08:06:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[08:06:49] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:06:49] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/a-pA8w
[08:06:49] <ghrust> 13rust/06auto 14fcc5358 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[08:06:49] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:08:19] <cmr> acrichto: #9747 brokeit, and you reviewed it
[08:08:23] <cmr> your fault!
[08:08:43] <acrichto> in match checking?!
[08:08:46] <acrichto> there's no way
[08:08:56] * cmr shrugs
[08:09:32] <acrichto> are you bisecting on commits or merges?
[08:10:01] <dbaupp> acrichto: merges
[08:10:03] <cmr> Wait!
[08:10:21] <acrichto> there are some dtor changes by strcat around that comit, those look more dubious
[08:10:21] <cmr> I'm reading the history wrong.
[08:10:22] <dbaupp> acrichto: well, commits directly to master
[08:11:12] <cmr> I apologize
[08:11:18] <cmr> #9751 broke it, yes.
[08:11:39] <acrichto> hm, this must have been a bug for a long time then
[08:11:44] <acrichto> that commit should not have broken anything
[08:11:56] <Eridius> cmr: random thought: what happens if you turn off the drop flag in 0.8?
[08:12:40] <cmr> Eridius: yeah that does it
[08:12:48] <Eridius> \o/
[08:12:59] * Eridius wonders if rusti should have a way to run code using 0.8
[08:13:11] <Eridius> acrichto: I just killed the `if true` special case and the problem went away
[08:13:14] <cmr> Want me to bisect it with unsafe_no_drop_flag?
[08:13:30] <cmr> well, I'd need to find a good commit first...
[08:13:39] <dbaupp> Eridius: rusti is using 0.8 now
[08:13:42] <dbaupp> rusti: version
[08:13:43] -rusti- "rustc 0.8"
[08:13:45] <acrichto> cmr: hm, not sure, I think someone who understands trans needs to weigh in on this
[08:13:55] <Eridius> dbaupp: oh it's not lying about that? why is it using 0.8? I thought it was supposed to track master
[08:14:05] <dbaupp> Eridius: master broke rusti
[08:14:13] <Eridius> rusti: #[no_drop_flag] struct Foo; impl Drop for Foo { fn drop(&mut self) { println!("dropping"); } } if true { let _a = Foo; }
[08:14:14] -rusti- dropping
[08:14:14] -rusti- ()
[08:14:19] <Eridius> did I get the attribute wrong?
[08:14:23] <Eridius> dbaupp: o_O
[08:14:24] <cmr> unsafe_no_drop_flag
[08:14:26] <dbaupp> rusti: made reading from stdin hang or crash or something
[08:14:27] -rusti- <anon>:9:14: 9:21 error: expected one of `; }` but found `reading`
[08:14:27] -rusti- <anon>:9          made reading from stdin hang or crash or something
[08:14:27] -rusti-                        ^~~~~~~
[08:14:27] -rusti- application terminated with error code 101
[08:14:30] <Eridius> rusti: #[unsafe_no_drop_flag] struct Foo; impl Drop for Foo { fn drop(&mut self) { println!("dropping"); } } if true { let _a = Foo; }
[08:14:31] -rusti- dropping
[08:14:31] -rusti- dropping
[08:14:31] -rusti- ()
[08:14:40] <Eridius> hmm, I wonder why rust doesn't complain about the wrong attribute
[08:14:49] <cmr> there'ss a PR for that in the queue
[08:14:58] <cmr> the short story is that attributes are for more than rustc to consume.
[08:15:41] <acrichto> cmr: if you could bisect the unsafe_no_drop_flag breakage, then that's probably the real issue here
[08:15:57] <acrichto> I think it's just something wrong with the special casing though
[08:16:04] <acrichto> some scopes are not being set up correctly
[08:16:11] <Eridius> acrichto: is it? I would assume the "real breakage" is the fact that the value is being dropped twice. The drop flag was just suppressing the second drop
[08:16:55] <acrichto> well yes, that's the problem
[08:17:05] <acrichto> and the special-casing of the codegen of "if true { ... }" is probably wrong
[08:17:12] <Eridius> presumably, yes
[08:17:18] <cmr> Well, I seem to not be able to reproduce on 0.7, unless no_drop_flag and unsafe_no_drop_flag had yet to exist.
[08:17:20] * Eridius doesn't understand trans in the slightest though
[08:17:48] <acrichto> cmr: don't sweat it too much, it'll probably just bisect the commit that introduced the "if true { ... }" optimization
[08:17:58] <cmr> yeah
[08:18:29] <Eridius> cmr: release-0.7 shows #[unsafe_no_drop_flag] in the source, so I guess it worked then
[08:18:31] <acrichto> e0685e22
[08:18:33] <acrichto> cmr: ^
[08:18:49] <acrichto> oh hm no
[08:18:52] <acrichto> that just changed it
[08:19:01] <cmr> (also I only build bors merges)
[08:19:16] <Eridius> acrichto: is there a point to bisecting it? That whole block of code must be wrong somehow. It doesn't particularly matter what commit introduced it
[08:19:19] <Eridius> since we know why it was introduced
[08:19:26] <acrichto> cmr: 4797dd40 that's the introduction
[08:20:33] <Eridius> acrichto: whoaaaa, `if false { } else { let _a = Foo; }` drops _three_ times!
[08:20:40] <acrichto> lovely!
[08:21:29] <cmr> acrichto: confirm, that PR introduced the bug.
[08:21:45] <cmr> that was a long time ago.
[08:22:02] <cmr> time sure does go fast.
[08:22:59] * acrichto just wants static linking to land
[08:23:12] <cmr> Me too!
[08:23:28] * cmr looks forward to not having to rebuild all of the things he uses every time heupdates rust
[08:23:40] <acrichto> that'd be sweet if our snapshots were just a rustc binary
[08:23:47] <acrichto> (they totally can be)
[08:24:18] <cmr> we'd be able to not snapshot on an ancient rhel box too!
[08:24:30] * Eridius wants static linking because the ability to distribute a binary to coworkers without having to install rust is very appealing
[08:24:31] <cmr> actually no
[08:24:39] <cmr> glibc, nvm
[08:24:43] <acrichto> we still have lots of dynamic deps
[08:24:47] <acrichto> namely libstdc++
[08:24:50] <cmr> yeah
[08:24:54] <Eridius> back at Apple I wrote a CLI utility in Go that I then gave to all my coworkers. Only reason I could do that is because Go statically linked the Go runtime/stdlib
[08:24:57] <acrichto> but I have a ptach to remove that, just doesn't work at all on windows
[08:25:11] <Eridius> acrichto: dynamic deps on OS-provided libraries is perfectly fine by me
[08:25:27] <acrichto> that's why we use some ancient rhel/centos/something though
[08:25:55] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:26:08] <acrichto> cmr: if you depend on libsyntax/librustdoc/librustc/librustpkg you'll still be dynamically linking though
[08:26:29] <acrichto> I only opted to build lib{std,extra,rustuv} as rlibs
[08:26:52] <cmr> multibuilder only uses std/extra
[08:26:58] <acrichto> wheee static binaries
[08:27:02] <acrichto> that are grossly too huge
[08:27:19] * acrichto also may have just fixed 10734
[08:27:26] <acrichto> whee two line changes
[08:27:51] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[08:28:43] <Eridius> acrichto: what change?
[08:29:00] <acrichto> lol didn't fix it
[08:31:54] <Eridius> I wish compiling librustc was faster :/
[08:32:35] <acrichto> Eridius: https://github.com/mozilla/rust/pull/10735/files
[08:33:23] <acrichto> that also explains the running three times issues
[08:33:29] <acrichto> destructors were getting translated 3 times...
[08:33:39] <cmr> woo
[08:33:54] <acrichto> now should I sleep, or wait for windows to pass on static linking
[08:34:00] <cmr> wait!
[08:34:11] <acrichto> I agree
[08:34:13] <cmr> because it's probably going to fail :p
[08:34:21] <acrichto> :(
[08:34:26] <acrichto> it's sad b/c you're right
[08:35:03] <Eridius> acrichto: hrm, I tried deleting those two trans_block_cleanups() already, which knocked off one drop on each branch (your extra bool param I guess is for the other). But why is trans_block_cleanups bad? Is it because the enclosing block is now treating the then (or else) as part of itself, and so was cleaning it up a second time?
[08:35:24] <cmr> I'm thinking we need a didalexlandanythingtoday.com, with statistics on retries and how may times it takes for your PRs to stick :P
[08:35:34] <acrichto> Eridius: wth_scope already runs destrutors
[08:35:38] <Eridius> ahh
[08:35:51] <acrichto> cmr: that site would just always be in huge letters "NO"
[08:36:02] <Eridius> my current attempt was removing with_scope() to see if it was behaving differently than the non-with_scope version, but that ended up in LLVM ERROR: Broken module, no Basic Block terminator!
[08:36:15] * Eridius guesses he needed to add something else with_scope() was doing automatically
[08:36:40] <acrichto> ofc android failed
[08:36:47] <cmr> lol
[08:36:49] <acrichto> error: cannot find -lpthread
[08:36:58] <acrichto> fml
[08:37:05] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[08:38:20] <acrichto> welp, now it's sleep time
[08:38:40] <cmr> nini
[08:38:44] <cmr> that means I should also sleep
[08:38:50] <cmr> so good night others
[08:38:52] <Eridius> acrichto: nice fix, but I'm not a fan of relying on ~3 in your test
[08:39:02] <Eridius> a malloc error is not a great thing to rely on to indicate a bug
[08:39:34] <acrichto> most platforms will die on a double-free
[08:39:52] <Eridius> you're still making an assumption about current behavior
[08:40:28] <cmr> use a static mut as a counter?
[08:40:34] <Eridius> cmr: just a field is fine
[08:40:52] <cmr> not if it's getting dropped?
[08:41:00] <acrichto> hm, I think I'll deal with that tmw
[08:41:01] <Eridius> cmr: drop gets &mut self
[08:41:08] <Eridius> acrichto: I just commented with code
[08:41:17] <cmr> yeah, but you can't *access* the struct after the drop
[08:41:25] <cmr> unless you mean check the field in drop...
[08:41:25] <Eridius> cmr: you don't have to. you just assert inside the drop
[08:41:27] <cmr> duh
[08:41:44] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:41:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14fcc5358 to 1480991bb: 02http://git.io/N3iJvQ
[08:41:44] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:41:46] <Eridius> we're not testing to make sure it's been dropped at all, we're testing to make sure it's not double-dropped
[08:41:51] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:41:51] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/G6touQ
[08:41:51] <ghrust> 13rust/06auto 14fe9b3e1 15Alex Crichton: Test fixes and merge conflicts
[08:41:51] <ghrust> 13rust/06auto 14d5aba1a 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[08:41:53] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:41:56] <Eridius> although I suppose it would be nice if we could test to make sure it's been dropped at all, just for sanity's sake
[08:42:53] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:45:57] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[08:46:20] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[08:51:44] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[09:04:05] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[09:21:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:21:43] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d5aba1a to 1480991bb: 02http://git.io/N3iJvQ
[09:21:43] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:21:47] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:21:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/G8pePg
[09:21:47] <ghrust> 13rust/06auto 14572635b 15Corey Richardson: Wrap the return value of the type_id intrinsic in an opaque box...
[09:21:47] <ghrust> 13rust/06auto 14156054f 15bors: auto merge of #10722 : cmr/rust/type_id_opaque, r=alexcrichton...
[09:21:48] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:22:59] *** Quits: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[09:23:10] *** Quits: tedh (tedh@moz-A5D1CAB7.public.wayport.net) (Ping timeout)
[09:26:26] *** Joins: tedh (tedh@moz-A5D1CAB7.public.wayport.net)
[09:32:19] *** Quits: Kxepal (Miranda@moz-62D3C795.pppoe.mtu-net.ru) (Ping timeout)
[09:34:21] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[09:36:03] <dbaupp> https://github.com/mozilla/rust/pull/10701 r?
[09:47:16] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[09:57:00] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[09:59:03] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[10:00:27] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[10:00:43] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[10:01:05] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[10:01:39] <eddyb> how I hate kernel panics :(
[10:02:58] <eddyb> during make check-stage1
[10:05:24] * ChrisMorgan has only once seen a kernel panic in real life
[10:06:46] <eddyb> ChrisMorgan: try hacking on rust on a laptop during the winter
[10:07:09] <ChrisMorgan> It's a little late in the year to do that now.
[10:07:31] * ChrisMorgan would have thought summer was a bigger problem, with overheating
[10:07:51] <eddyb> in the summer I have a big fan keeping it cool, but I can't use that now without risking getting a nasty cold or worse
[10:08:28] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[10:08:58] <eddyb> it's paradoxical, 20Â°C cooler during summer
[10:09:26] <eddyb> any idea what target builds librustdoc with stage1?
[10:09:32] <eddyb> (if any)
[10:09:46] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[10:11:45] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[10:13:37] <ChrisMorgan> eddyb: sounds like your laptop's cooling is seriously broken; have you tried a fan-stand thing? A friend of mine had a readily overheating laptop and did that and it lasted for another year or two before being eventually replaced.
[10:14:09] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[10:14:24] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[10:16:33] <eddyb> ChrisMorgan: why would it be broken?
[10:16:48] <eddyb> 70Â°C under heavy load
[10:16:54] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[10:16:56] <ChrisMorgan> eddyb: no idea. It may still seem to be working but not work properly.
[10:17:53] <ChrisMorgan> 70Â°C should be fine. I've had my CPU get over 100Â°C once or twice with nothing going wrong (shut down point is 105Â°C).
[10:18:33] <eddyb> I used to get random instant shutdowns, before I started underclocking my GPU
[10:18:34] <ChrisMorgan> (Building Rust with your laptop in your bag with only limited heat dissipation while you ride home? Probably not a good idea.)
[10:18:56] <eddyb> nah, it's on my desk, on top of a box, without the back cover
[10:19:12] <eddyb> the cooler just sits in open air
[10:19:16] <ChrisMorgan> That was my case, sensor readings were around 102Â°C!
[10:21:19] <eddyb> oh, there were also screen-freezes, but SSH was working. anyways, all of that is gone now
[10:21:47] <eddyb> just two or three kernel panics this year. I've come to realize that a blinking caps lock LED on my laptop means kernel panic :P
[10:24:02] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[10:24:58] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[10:27:58] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[10:31:57] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:31:57] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/G8pePg
[10:31:57] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:36:42] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:36:42] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/SR3H1g
[10:36:42] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:36:50] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[10:36:50] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/8Ji7xg
[10:36:50] <ghrust> 13rust/06auto 1418ca312 15Erick Tryzelaar: Remove @ from json::Error
[10:36:50] <ghrust> 13rust/06auto 145b41df4 15Erick Tryzelaar: Remove some unnecessary impls from json
[10:36:50] <ghrust> 13rust/06auto 14f7b739c 15Erick Tryzelaar: extra: Rename json constructors into *::init
[10:36:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[10:37:15] <eddyb> this again?
[10:43:31] *** Quits: bjz (bjz@moz-DD4A2A91.lnse2.cha.bigpond.net.au) (Ping timeout)
[10:51:04] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[10:56:36] <ChrisMorgan> It's interesting observing what the removal of jemalloc did to memory usage when compiling Rust. Has the reason why not so much memory is being freed in the middle (though the peak is much the same) been investigated further? http://huonw.github.io/isrustfastyet/mem/#df187a0,6b07d88
[10:57:43] <ChrisMorgan> (It was also demonstrably slower, by the looks of it, around 10%.)
[11:11:42] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:11:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1456c82bc to 14156054f: 02http://git.io/N3iJvQ
[11:11:42] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:32:52] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[11:34:57] *** Joins: bjz (bjz@moz-DD4A2A91.lnse2.cha.bigpond.net.au)
[11:46:49] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[11:48:07] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:01:46] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[12:01:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145c1ee5a to 14156054f: 02http://git.io/N3iJvQ
[12:01:46] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[12:01:50] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:01:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/66_wFg
[12:01:50] <ghrust> 13rust/06auto 147bb166e 15Alex Crichton: Don't run cleanups twice in "if true" blocks...
[12:01:50] <ghrust> 13rust/06auto 14eeaf2e1 15bors: auto merge of #10735 : alexcrichton/rust/issue-10734, r=cmr...
[12:01:51] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:02:34] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[12:08:08] <eddyb> cmr, nmatsakis: I have two ideas for removing @T/P<T> from Visitor, as it's used only by ast_map: make ast_map use a folder instead or have a P::from_ref(&T) -> P<T> which gives you a box from a borrowed pointer to the data in the box
[12:10:11] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131125215016])
[12:12:54] <eddyb> 7 changes, rustdoc compiles, but: note: /usr/lib64/gcc/x86_64-suse-linux/4.8/../../../../x86_64-suse-linux/bin/ld: cannot find -lsundown
[12:13:25] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Ping timeout)
[12:14:18] <dbaupp> eddyb: that's probably required. :P
[12:14:31] <eddyb> it's not in my repos :(
[12:16:56] <dbaupp> I thought it was bundled into the repo
[12:17:00] <dbaupp> s/into/in/
[12:17:23] <dbaupp> yeah, src/rt/sundown
[12:17:25] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[12:37:31] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[12:40:04] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[13:11:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:11:46] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/66_wFg
[13:11:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:35:26] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[13:37:39] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[14:00:29] <dbaupp> https://github.com/mozilla/rust/pull/10737 r?
[14:03:06] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[14:04:33] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[14:06:47] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:06:47] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/28zmRQ
[14:06:47] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:06:50] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[14:06:50] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/DQZ9Pg
[14:06:50] <ghrust> 13rust/06auto 1418ca312 15Erick Tryzelaar: Remove @ from json::Error
[14:06:50] <ghrust> 13rust/06auto 145b41df4 15Erick Tryzelaar: Remove some unnecessary impls from json
[14:06:50] <ghrust> 13rust/06auto 14f7b739c 15Erick Tryzelaar: extra: Rename json constructors into *::init
[14:06:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[14:23:37] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[14:39:34] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[14:40:12] *** Joins: SiegeLord (sl@moz-C606190.bstnma.fios.verizon.net)
[14:40:36] <eddyb> dbaupp: hmm, it's not built for check-stage1-rustdoc
[14:40:51] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[14:45:34] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[14:57:42] <eddyb> dbaupp, cmr, and whomever interested: updated https://github.com/mozilla/rust/pull/10676 - should pass all tests unless I did something stupid again
[15:26:45] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[15:26:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/DQZ9Pg
[15:26:45] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:10:10] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[16:17:28] <eddyb> cmr: those 12h will be gone soon with nobody around to r+, at least from what I can tell :(
[16:21:01] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[16:24:57] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[16:24:57] *** ChanServ sets mode: +o pnkfelix
[16:25:19] <eddyb> pnkfelix: fixed my PR :D
[16:28:00] <jack> does anyone know what libstd compiled with --cfg test is supposed to be linking? I don't understand these errors: https://gist.github.com/metajack/7714151
[16:37:29] <pnkfelix> eddyb: by the way, I've been meaning to ask
[16:38:03] <pnkfelix> eddyb: since in some of your replacements (maybe all?  Not sure) are replacing T with @T
[16:38:13] *** kimundi is now known as zz_kimundi
[16:39:24] <pnkfelix> eddyb: did you consider replacing T with ~T instead ?  I.e., is the main benefit here that you've reduced the individual node size considerably?  Or are you also getting a benefit from the potential for sharing via @T (which you would not have with ~T )
[16:39:51] <eddyb> pnkfelix: I've removed some cloning by sharing
[16:40:00] <pnkfelix> eddyb: okay
[16:40:06] <eddyb> there is a node_block for example
[16:40:51] <eddyb> in a perfect world, P<T> would be ~T and ast_map would just borrow instead of share
[16:41:17] <eddyb> pnkfelix: I guess you weren't around, I said this a few hours ago "I have two ideas for removing @T/P<T> from Visitor, as it's used only by ast_map: make ast_map use a folder instead or have a P::from_ref(&T) -> P<T> which gives you a box from a borrowed pointer to the data in the box"
[16:42:22] * eddyb feels compelled to prove he's not evil for some reason. he knows how much people hate @T
[16:43:54] <pnkfelix> i don't hate @T as a theoretical construct
[16:46:11] <eddyb> random idea: P<T> could be a custom RC with one byte for the ref count - the box would be just as big as the enum (assuming all variants start with word-aligned data) :D
[16:49:58] *** Joins: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net)
[16:56:49] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:56:55] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[16:58:16] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[16:58:24] *** Joins: vadimcn_ (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[16:58:26] *** vadimcn_ is now known as vadimcn
[16:58:56] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:03:05] *** Quits: Sharp (Sharp@moz-39EFDA61.hfc.comcastbusiness.net) (Quit: Sharp)
[17:03:26] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:15:30] <cmr> jack: that's super confusing
[17:17:19] <cmr> oh, is it becausethe test harness injects an extra and std already?
[17:19:13] <eddyb> cmr: I can move the rustdoc changes in the first commit, but I wanted to keep two commits for historical reasons
[17:19:28] <eddyb> (I thought I mentioned this already, my bad)
[17:19:31] <cmr> ok
[17:19:34] <cmr> that's fine then
[17:19:52] <cmr> r+
[17:20:06] <eddyb> cmr: thanks so much :D
[17:20:16] <cmr> I have things to do, so you also get ~3.5 more hours :P
[17:21:46] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[17:21:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/yq1XWQ
[17:21:46] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[17:21:53] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:21:53] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/PgIn7Q
[17:21:53] <ghrust> 13rust/06auto 14a916627 15Eduard Burtescu: Box Block, fn_decl, variant and Ty in the AST, as they were inflating critical enum sizes.
[17:21:53] <ghrust> 13rust/06auto 1459f50d1 15Eduard Burtescu: Remove commented out naive implementation of ast::P<T>.
[17:21:54] <ghrust> 13rust/06auto 14b5a7768 15Eduard Burtescu: Update rustdoc to account for the boxed fn_decl and Ty in the AST.
[17:21:56] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:30:20] *** zz_kimundi is now known as kimundi
[17:54:36] <eddyb> dammit
[17:55:08] <eddyb> tidy failed? but... I ran check, that didn't show up
[17:56:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[17:56:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1405295e4 to 149bf62f7: 02http://git.io/N3iJvQ
[17:56:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[17:56:46] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:56:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/2x_KGg
[17:56:47] <ghrust> 13rust/06auto 14be6ae6e 15Huon Wilson: std::io::mem: add a with_capacity constructor to MemWriter....
[17:56:47] <ghrust> 13rust/06auto 14dfe46f7 15bors: auto merge of #10737 : huonw/rust/with-cap, r=alexcrichton...
[17:56:47] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[18:01:39] <eddyb> cmr: any chance I can get a retry on that?
[18:03:39] <eddyb> strcat: ^ if you're around. only failed tidy https://github.com/mozilla/rust/pull/10676
[18:03:58] * eddyb takes a mental note: check-stage1 doesn't include tidy
[18:04:11] *** Joins: Kxepal (Miranda@moz-D6DF9D5B.pppoe.mtu-net.ru)
[18:18:10] <eddyb> pnkfelix: would you mind giving a r+ on https://github.com/mozilla/rust/pull/10676?
[18:19:58] *** Joins: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP)
[18:30:27] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:30:44] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:30:51] <eddyb> my 3rd PR and I'm still screwing up. it better not keep me out of TWiR :(
[18:30:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:42:27] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:44:10] <strcat> eddyb: can you squash those two commits?
[18:44:17] <strcat> since that's just something introduced by the previous commit afaict
[18:44:33] <eddyb> strcat: hehe, that's the same thing cmr said. "I wanted to keep two commits for historical reasons"
[18:45:00] <strcat> it's not historical though
[18:45:02] <strcat> it's a feature branch
[18:45:09] * strcat shrugs
[18:46:33] <eddyb> strcat: I spent a few hours trying to get that commented out code to work, and didn't want to just throw it away, just stash it between two commits :P. if you think it's necessary, I'll squash
[18:51:47] * eddyb looks at the clock and then at strcat
[18:51:58] <eddyb> do I squash? do I get another r+?
[18:52:37] <strcat> can you squash it? ;p
[18:54:33] <eddyb> strcat: done
[18:55:26] <eddyb> https://gist.github.com/eddyb/79cf719f10d9472f9224 fwiw
[18:59:13] * eddyb hopes strcat's IRC client is the problem
[18:59:50] <eddyb> I have 19 minutes to get a highlight through
[18:59:58] <eddyb> strcat: does this count as harassing devs?
[19:10:15] *** Quits: zokier` (zokier@moz-C4357EA7.kapsi.fi) (Ping timeout)
[19:11:27] *** Joins: zokier` (zokier@moz-C4357EA7.kapsi.fi)
[19:18:09] <eddyb> strcat: pretty please :)?
[19:21:21] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[19:25:59] *** Quits: SiegeLord (sl@moz-C606190.bstnma.fios.verizon.net) (Client exited)
[19:26:40] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:26:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2x_KGg
[19:26:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:30:28] <eddyb> strcat: did I squash for nothing? you're such a tease >_>
[19:31:46] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:31:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/VYrwCw
[19:31:46] <ghrust> 13rust/06auto 1491e1eee 15Alex Crichton: Test fixes and merge conflicts
[19:31:46] <ghrust> 13rust/06auto 1489e8188 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[19:31:46] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:31:49] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:31:49] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/G2zj6A
[19:31:49] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:36:09] *** Quits: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP) (Quit: lkuper)
[19:41:10] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[19:43:46] <eddyb> well, I give up. whomever decides to give https://github.com/mozilla/rust/pull/10676 a retry, you'll be doing a good thing. cmr: I hope you have more exciting news >_<
[19:47:12] <cmr> eddyb: r+
[19:47:29] <cmr> One more hour before I do TWiR, you might get lucky
[19:47:55] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Connection reset by peer)
[19:47:56] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[19:48:03] * eddyb takes notes on manipulating humans - accidentally done it
[19:48:32] <eddyb> ^ been watching too much Dexter. I mean, I've just finished the entire series, it was awesome :D
[19:48:38] <eddyb> cmr: thanks, tight fit :P
[19:50:35] <cmr> Dexter is good, I never finished it though
[19:51:07] <eddyb> just like I never finished Breaking Bad (too much tension and surprises, couldn't handle it)
[19:53:10] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[19:54:35] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:07:44] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[20:08:11] <eddyb> ld: i386 architecture of input file `/home/rustbuild/src/rust-buildbot/slave/auto-linux-32-nopt-t/build/obj/i686-unknown-linux-gnu/test/run-make/c-dynamic-dylib/libcfoo.o' is incompatible with i386:x86-64 output
[20:08:21] <eddyb> haha, I got lucky. I almost feel bad for that
[20:11:40] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[20:11:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1489e8188 to 14dfe46f7: 02http://git.io/N3iJvQ
[20:11:40] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[20:13:12] <larsberg> cmr: glad I saw that TWiR note, not that I had completely forgotten to write up TWiS with the Thanksgiving holiday or anything :-)
[20:16:41] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[20:16:49] <cmr> larsberg: :)
[20:16:54] <cmr> I was going to email you about it
[20:18:14] <cmr> I won't publish TWiR without it, so don't feel pressured.
[20:18:50] <larsberg> cmr: You're being nice enough to include us; the least I can do is be timely! I'll add a calendar reminder to pull it together on Friday nights.
[20:19:05] * eddyb looks at his barometer
[20:19:26] <Seldaek> eddyb: it's worth finishing breaking bad :)
[20:20:02] <eddyb> Seldaek: oh, I believe you :P. now I have enough free time, so I could start again soon
[20:20:29] <eddyb> but I also have to get things done, 3 PRs/week is unacceptable
[20:22:02] <eddyb> strcat: how would you feel about me replacing all @T with P<T> in the AST, preparing for P<T> = Rc<T>?
[20:22:17] <strcat> why not just use Rc?
[20:22:39] <strcat> it's always going to have move semantics
[20:22:47] <strcat> that's probably the biggest change you have to deal with
[20:23:02] <eddyb> strcat: TBH, I doubt splitting ownership is that big of a problem
[20:23:21] <eddyb> as long as I can wrap it in something that's not just "clone", I'll be fine with it
[20:26:04] <eddyb> strcat: but I don't want a million .borrow()s that will be made obsolete by the planned improvements to smart vectors in the foreseeable future
[20:27:12] <eddyb> switching P<T> between &'static T and @T ensures it's generic over a pointer with copy semantics, and ~T can be used to anticipate the move semantics of Rc<T>
[20:28:06] <eddyb> strcat: it's easy to change what P<T>, P(T) and P::split_ownership do, it's harder to specialize the AST for any specific choice
[20:30:13] <eddyb> strcat: once we have a "perfect" candidate, replacing the type, the constructor and the utility function with their specialized versions can be done even with sed
[20:31:12] <eddyb> now, my logic can be faulty, I've proven that a few times this week, feel free to make me feel stupid :)
[20:34:28] *** Quits: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com) (Connection reset by peer)
[20:44:09] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[20:48:53] *** Joins: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com)
[20:52:03] *** Joins: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP)
[20:55:30] <eddyb> noooo
[20:55:58] <eddyb> but... I ran the tests...
[20:58:51] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[21:01:19] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[21:01:19] *** ChanServ sets mode: +o pnkfelix
[21:01:52] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[21:01:52] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14405251e to 14dfe46f7: 02http://git.io/N3iJvQ
[21:01:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[21:01:54] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:01:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/LKJZUw
[21:01:54] <ghrust> 13rust/06auto 142cecc16 15Alex Crichton: Test fixes and merge conflicts
[21:01:54] <ghrust> 13rust/06auto 14ec05214 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[21:01:54] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:02:03] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[21:02:27] *** Joins: pnkfelix1 (pnkfelix@moz-43495417.fbx.proxad.net)
[21:03:18] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[21:05:50] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[21:10:52] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[21:16:18] <eddyb> this is what I get for my impatience
[21:21:40] *** Joins: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net)
[21:32:24] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[21:32:35] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[21:43:33] *** Joins: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP)
[21:46:42] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:46:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ec05214 to 14dfe46f7: 02http://git.io/N3iJvQ
[21:46:42] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:46:49] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:46:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Nr48UQ
[21:46:49] <ghrust> 13rust/06auto 14f6e9617 15Alex Crichton: Test fixes and merge conflicts
[21:46:49] <ghrust> 13rust/06auto 1429cff7a 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[21:46:49] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:50:43] *** Quits: pnkfelix1 (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[21:59:52] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[22:02:11] <eddyb> cmr: here it is, syntax tests fixed, if you want it: https://github.com/mozilla/rust/pull/10676
[22:09:43] <eddyb> on a scale from perfect to bad, I do horrible
[22:12:28] *** Quits: eddyb (eddy@EBE709F3.F7C96DA2.FCAAE698.IP) (Ping timeout)
[22:18:34] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[22:18:50] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[22:19:00] *** vfetwnuncszu is now known as dcrewi
[22:20:51] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[22:20:51] *** ChanServ sets mode: +o pnkfelix
[22:27:04] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[22:41:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:41:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1429cff7a to 14dfe46f7: 02http://git.io/N3iJvQ
[22:41:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:41:49] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:41:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/20IPUA
[22:41:49] <ghrust> 13rust/06auto 1456e4c82 15Alex Crichton: Test fixes and merge conflicts
[22:41:49] <ghrust> 13rust/06auto 144252a24 15bors: auto merge of #10528 : alexcrichton/rust/static-linking-v2, r=pcwalton...
[22:41:50] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:04:18] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:18:52] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[23:21:27] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[23:21:27] *** ChanServ sets mode: +o pnkfelix
[23:23:48] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[23:27:05] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[23:46:36] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[23:46:36] *** ChanServ sets mode: +ao pcwalton pcwalton
[23:47:58] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[23:48:50] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:48:50] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/20IPUA
[23:48:50] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:50:57] *** Quits: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:51:41] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[23:51:41] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/IKswGg
[23:51:41] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[23:51:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:51:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Em0DNQ
[23:51:46] <ghrust> 13rust/06auto 14d3019af 15Chris Morgan: Fix double slashes in make paths....
[23:51:46] <ghrust> 13rust/06auto 14436adc2 15bors: auto merge of #10731 : chris-morgan/rust/fix-double-slashing, r=metajack...
[23:51:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:53:41] <dbaupp> acrichto: \o/
[23:55:10] <acrichto> hurray!
