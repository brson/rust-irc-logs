[00:00:01] <Luqman> acrichto: well the debug stuff is hard to read in stage0 now
[00:00:08] <acrichto> yeah :(
[00:01:01] <cmr> brson: https://bugzilla.mozilla.org/show_bug.cgi?id=922415
[00:01:04] <brson> acrichto: not urgent
[00:04:15] <strcat> acrichto: strangely enough it's deterministic for things that aren't nil
[00:04:46] <acrichto> strcat: you attempted to dereference nil, hilarity ensued
[00:05:10] <strcat> not what I mean
[00:05:15] <strcat> nil as in the unit type
[00:07:19] <acrichto> close enough
[00:08:02] <nmatsakis> acrichto: I have some plans in that direction, yes
[00:16:26] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:16:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/LAdC5g
[00:16:26] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:16:29] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:16:29] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/gPcDXA
[00:16:29] <ghrust> 13rust/06auto 14a076fef 15Felix S. Klock II: Add new lint: non_uppercase_pattern_statics, for #7526....
[00:16:29] <ghrust> 13rust/06auto 149246742 15Felix S. Klock II: Throwing in another interesting test case: There is no need to warn...
[00:16:29] <ghrust> 13rust/06auto 14c0599b1 15Felix S. Klock II: Fix typo in comment.
[00:16:31] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:27:03] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[00:29:10] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[00:29:10] *** ChanServ sets mode: +o pnkfelix
[00:33:12] <tjc> acrichto: r? https://github.com/mozilla/rust/pull/9640
[00:33:45] <acrichto> tjc: could you put a small comment about why it's 2 separate checks instead of 1?
[00:33:58] <acrichto> otherwise r=me p=2
[00:34:31] <tjc> acrichto: good point, I will
[00:43:14] <acrichto> pnkfelix: hmm perhaps the warning should be for identifiers without the first letter as uppercase
[00:43:18] <dbaupp> cmr: https://github.com/mozilla/rust/pull/9636#discussion_r6675923
[00:43:24] <acrichto> your branch just failed on a cfail test that maches on NaN
[00:44:25] <acrichto> aww isrustslimyet hasn't updated since my ownership of ast::Crate change landed
[00:45:18] <Eridius> whew, rebase on top of latest master was relatively straightforward. Now to hope `make check` passes
[00:45:19] <dbaupp> acrichto: I believe cmr's collecting a pile of builds for now, and will bench them in a big batch
[00:45:24] <dbaupp> Eridius: \o/
[00:45:50] <dbaupp> Eridius: you have a clear... path... to victory
[00:45:50] <acrichto> dbaupp: I'm expecing cmr's machine to be producing builds every 5 minutes, I'm disappointed :P
[00:45:55] <acrichto> dbaupp: go home
[00:46:08] <Eridius> whoa, what the heck? Line length violation... in code that has nothing at all to do with Path
[00:46:20] *** Quits: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP) (Quit: tikue_)
[00:46:27] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:46:27] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14efdda6e to 147ddcd2a: 02http://git.io/N3iJvQ
[00:46:27] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:46:28] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:46:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ejvuKg
[00:46:28] <ghrust> 13rust/06auto 142ec2d7d 15Tim Chevalier: rustpkg: Make test_rustpkg_test_output more permissive...
[00:46:28] <ghrust> 13rust/06auto 14bc6dd90 15bors: auto merge of #9640 : catamorphism/rust/rustpkg-test-fix, r=alexcrichton...
[00:46:28] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:46:32] * dbaupp is already at home
[00:46:33] <Eridius> wow, I think I had a wacky vim error. Pasted code where it didn't belong. how strange
[00:47:07] <dbaupp> acrichto: well, I'm planning to add an option to multibuilder that will make it able to produce them more regularly than just cmr's whims :P
[00:48:10] <acrichto> dbaupp: oh man you guys are already doing an insane amount of awesome work, I'm just impatient :P
[00:48:36] * dbaupp is too
[00:49:07] <dbaupp> acrichto: just coopt half of mozillas firefox build infrastructure and we can be running every bench we want \o/
[00:49:46] <acrichto> you didn't see anything...
[00:50:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:50:33] <ghrust> 01[13rust01] 15alexcrichton merged 06auto into 06snap-stage3: 02http://git.io/INncIg
[00:50:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:50:53] <dbaupp> acrichto: 'auto'?
[00:51:02] <acrichto> auto will become master
[00:51:06] <acrichto> if it's successful
[00:51:12] <dbaupp> oh, for the test fix being tested
[00:51:15] <acrichto> like that exact commit will become master
[00:51:17] <acrichto> yeah
[00:51:22] <acrichto> impatience strikes again!
[00:51:32] <dbaupp> (I was just wondering why you were snapping a non-master commit)
[00:51:33] * acrichto checks mac4 isn't doing the snapshot
[00:51:39] <acrichto> aww man
[00:51:46] <Luqman> acrichto: optimistic i see :P
[00:51:57] <acrichto> I have complete confidence in tjc :)
[00:52:07] <tjc> acrichto: uh-oh :-)
[00:52:09] * dbaupp wonders why mac4 is so hated
[00:52:14] <acrichto> mac4 has valgrind
[00:52:16] <acrichto> mac3 doesn't
[00:52:24] <acrichto> mac3 silently ignores the --enable-valgrind option
[00:52:27] <Luqman> review-branch
[00:52:28] *** Joins: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP)
[00:52:28] <dbaupp> weird
[00:52:32] <acrichto> and we have lots of "leaks" on valgrind osx
[00:52:36] <Luqman> woops, this is not a terminal
[00:54:05] <acrichto> this one really wants to build on mac4...
[00:56:02] <dbaupp> is mac3 doing other stuff
[00:56:02] <dbaupp> ?
[00:56:19] <acrichto> oh huh maybe yeah b/c it's doing auto stuff right now
[00:56:30] <acrichto> the other option is to actually fix valgrind
[00:56:37] <cmr> acrichto: yes, dbaupp is right
[00:56:41] <cmr> I bench at my whim ;p
[00:58:10] <pnkfelix> acrichto: are there other cases we expect this to crop up from our std library.  NaN is not a good example since people need to bind that anyway and call is_nan
[00:58:14] <pnkfelix> acrichto: ?
[00:58:42] <acrichto> pnkfelix: not that I can think of, and I think you should rather be using f64::NaN instead of NaN directly
[00:58:46] <Eridius> noooo, compilation failure in new rustpkg code *shakes fist*
[00:58:56] <acrichto> pnkfelix: the error message is a bit vauge b/c NaN looks like an "uppercase identifier" to me
[00:59:09] <acrichto> pnkfelix: it's also not clear (the first time you see the message) why it should be a problem
[00:59:11] <pnkfelix> acrichto: ah, maybe the error message should say "all caps" ?
[00:59:12] <Eridius> damn that `rustpkg test`
[00:59:24] <acrichto> pnkfelix: yeah, and perhaps a NOTE explaining why?
[00:59:56] <pnkfelix> acrichto: k.  too tired now to compose that.  I'll finish tomorrow and repush
[01:00:20] <acrichto> pnkfelix: yeah that's fine, I don't think that NOTE for aribtrary lints is even supported yet, but I would be more ok with "all caps" in the message
[01:01:47] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:05:00] <acrichto> brson: if I were interested in tracking down valgrind errors on osx, would I run valgrind via "valgrind --suppressions=./src/etc/x86.supp" path/to/my/binary
[01:06:44] <dbaupp> pnkfelix: not sure how you're handling languages that don't have upper/lowercase, btw?
[01:07:31] * dbaupp looks at the code
[01:08:19] <brson> acrichto: that'll probably do it. i usually copy the command line from make VERBOSE=1
[01:08:55] <acrichto> hmm, well I need to figure out suppressions I think b/c apparently "int main() {}" leaks 8KB
[01:10:06] <dbaupp> pnkfelix: oh, using .is_lowercase(), looks good. :)
[01:11:39] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:14:08] <pnkfelix> dbaupp: do you know much about non-western alphabets and/or programming settings ?
[01:14:12] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:15:32] <dbaupp> pnkfelix: not personally, but I do know that alphabets with no case-distinction exist (that's something, I guess), so .is_uppercase() will return false always (and hence, using that would be bad)
[01:15:45] <dbaupp> pnkfelix: what's the reason for the question?
[01:16:36] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[01:17:16] <pnkfelix> dbaupp: trying to find a domain expert to weigh in on https://github.com/mozilla/rust/issues/2253#issuecomment-25238998
[01:18:15] <cmr> pnkfelix: I'll review the rustdoc things in ~1.5 hours
[01:19:51] <dbaupp> pnkfelix: heh, I definitely don't satisfy "domain expert". I imagine some of the koreans have some knowledge (klutzy, sanxiyn, Yurume(?))
[01:20:23] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:21:29] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[01:21:47] <pnkfelix> dbaupp: I've paranoid about asking b/c I didn't want to seem like the dumb american who doesn't realize that Korea and Japan are different places.  :)
[01:22:53] <dbaupp> pnkfelix: :)
[01:24:01] <dbaupp> Yurume: do you have any thing to say about https://botbot.me/mozilla/rust-internals/msg/6501957/ (specifically https://github.com/mozilla/rust/issues/2253#issuecomment-25238998)
[01:24:37] <dbaupp> Yurume: (I'm under the impression that you are korean, sorry if I'm incorrect :) )
[01:26:44] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[01:36:20] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[01:38:04] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[01:38:11] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:43:00] <klutzy> ah, we don't normalize names
[01:43:26] <klutzy> >>> file('a.rs', 'w').write(u'#[crate_type = "lib"]; pub fn \u00c5() -> int { 1 }'.encode('utf-8'))
[01:43:29] <klutzy> >>> file('b.rs', 'w').write(u'extern mod a; fn main() { println(fmt!("val: %d", a::\u0041\u030a())); }'.encode('utf-8'))
[01:43:48] <klutzy> so b.rs cannot find function from a
[01:45:52] <acrichto> brson: hmm, we've had valgrind processes running on mac4 since the 28th of august
[01:45:57] <acrichto> I have a feeling something is awry
[01:46:33] <klutzy> this would be problematic in some rare cases
[01:47:07] <engla> I remember something about normalizing twice and that it's not always idempotent
[01:49:16] <brson> acrichto: sounds awry
[01:49:26] <acrichto> killing them now
[01:49:27] <engla> oh that was not unicode normalization by itself // http://labs.spotify.com/2013/06/18/creative-usernames/
[01:49:45] <brson> acrichto: er, one of my macs just made a sound. did you reboot?
[01:49:48] <dbaupp> klutzy: I believe that's what #2253 is trying to solve
[01:50:02] <acrichto> brson: hm, well I kill -9'd 4 valgrind processes, and then on the next one all myconnections froze
[01:50:02] <klutzy> dbaupp: yep
[01:50:03] <dbaupp> (i.e. decide on a default normalisation)
[01:50:13] <acrichto> brson: the fact that it made a sound is disturbring
[01:50:37] <brson> maybe you killed the wrong process?
[01:50:38] <acrichto> brson: umm... I think it may have died (mac4)
[01:50:46] <acrichto> nah it was a valgrind process for sure
[01:50:52] <acrichto> unless two processes can have the same pid
[01:51:37] <acrichto> brson: what sort of sound was it?
[01:51:44] <brson> "baaaah"
[01:51:55] <acrichto> indeed...
[01:51:55] <brson> "bwaaah"
[01:52:22] <acrichto> well it's no longer responding to a ping...
[01:52:32] <acrichto> I have no idea what I just did
[01:52:40] <acrichto> I swear I was just trying to kill valgrind
[01:52:47] <brson> i power cycled it. hopefully it comes back up
[01:52:49] <acrichto> these poor machines :(
[01:52:52] <brson> i can't get into mac3 either
[01:52:55] <dbaupp> acrichto: you kill valgrind
[01:53:03] <dbaupp> just took the rest of the machine with it
[01:53:08] <acrichto> brson: that's interesting, I didn't touch mac3
[01:53:23] <acrichto> I connected and saw that valgrind wasn't running so I disconnected
[01:54:59] <acrichto> brson: apparently buildbot thinks they're both still connected
[01:56:01] <acrichto> dbaupp: I am grammer expart
[01:56:39] <dbaupp> acrichto: I is an gooder one :S
[01:57:53] <acrichto> documenated sounds terrifying
[01:58:50] <brson> oh I finally figured out (after months) what is wrong with rust-mac6 - the ethernet was unplugged
[01:58:58] <acrichto> oh dear
[01:59:04] <brson> neither mac3 or 4 are lighting up the lights on the ethernet switch
[01:59:24] <acrichto> I can confirm that network traffic is not reaching them
[01:59:42] <acrichto> making sounds from killing processes is not a good thing though, perhaps a monitor should get hooked up?
[01:59:47] <brson> i hate computers
[01:59:52] <acrichto> \o/
[02:00:27] <acrichto> and bors is chugging along as if nothing ever happened
[02:01:49] <acrichto> brson: well rampaging valgrind process would explain why the slowest builder is *always* mac4
[02:03:04] <acrichto> anyway, heading home now, will be back in a bit
[02:05:02] <brson> rust-mac4 is back
[02:17:25] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[02:21:25] <strcat> acrichto: well, I have it working for tuples...
[02:21:36] <strcat> had to fix the overflow intrinsics I wrote before
[02:21:45] <strcat> since they assumed there was a retptr
[02:21:49] <strcat> anyway structs are going to be hard :(
[02:22:07] <acrichto> strcat: nice!
[02:23:00] *** Joins: nrc (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[02:25:07] <strcat> fwiw I found the drop_ty_immediate issue...
[02:25:15] <strcat> newtype structs were currently broken
[02:25:19] <brson> omg rust-mac3 finally rebooted. it took like 20 minutes
[02:25:26] <dbaupp> acrichto: can't we just make format generate uppercase statics? (https://github.com/mozilla/rust/pull/9633)
[02:25:36] <brson> i don't understand what these computers are doing
[02:25:37] <dbaupp> strcat: https://github.com/mozilla/rust/issues/9446 ?
[02:25:49] <strcat> yes
[02:26:31] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:26:42] <dbaupp> https://github.com/mozilla/rust/issues/7672 and https://github.com/mozilla/rust/issues/8051 appear to be dups
[02:26:48] <dbaupp> (at least, same error message)
[02:27:03] <acrichto> dbaupp: indeed I think we can/should
[02:27:22] <acrichto> brson: maybe some hard drive thing went wrong? 
[02:27:31] <acrichto> I'd be surprised if so
[02:28:05] <brson> well, we have 4 mac slaves again
[02:28:19] <brson> their crontabs are wrong so they don't restart buildslave correctly after rebooting
[02:28:35] <brson> let's never reboot
[02:29:24] <brson> i'm going to try to configure buildbot to pick mac5 and 6 over 3 and 4
[02:29:26] <brson> they're faster
[02:30:06] <acrichto> maybe it's b/c mac5/6 don't have 20 month-old valgrind process still running
[02:30:11] <strcat> acrichto: just going to remove this micro-optimization
[02:30:17] <acrichto> I agree though that we should never reboot :P
[02:30:23] <acrichto> strcat: which one?
[02:30:27] <strcat> it adds a whole drop/free code path for immediate types to avoid an alloca
[02:30:29] <strcat> but it's broken
[02:30:30] <acrichto> dbaupp: updated the pull request
[02:30:43] <strcat> and it does this anyway
[02:30:48] *** Quits: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP) (Quit: tikue_)
[02:30:48] <strcat>         let vp = alloca(bcx, type_of(bcx.ccx(), t), "");
[02:30:50] <strcat>         Store(bcx, v, vp);
[02:30:52] <strcat>         free_ty(bcx, vp, t)
[02:30:54] <strcat> that's in free_ty_immediate
[02:31:04] <brson> acrichto: do you still want the bots to set RUST_LOG=rustc=1?
[02:31:23] <acrichto> brson: I updated buildbot a few days ago to do that
[02:31:24] *** nrc is now known as nrc|afk
[02:31:32] <acrichto> Eridius had asked for it I think and I thought it was a good idea
[02:31:36] <dbaupp> acrichto: can you update the commit message too
[02:31:46] <brson> acrichto: ok. i'm going to commit it
[02:31:49] <acrichto> dbaupp: I need to stop and think sometimes...
[02:32:05] <acrichto> brson: oh there's a repo? I should commit these things in that case
[02:32:12] *** Quits: kimundi (kimundi@moz-FECF1514.dip0.t-ipconnect.de) (Ping timeout)
[02:32:40] <acrichto> dbaupp: updated
[02:33:39] <brson> 'buildbot restart' is so useless
[02:33:58] <acrichto> but surely it restarts the buildbot!
[02:34:41] <strcat> yeah there's zero point in drop_ty_immediate/free_ty_immediate
[02:34:44] <strcat> they... always do an alloca
[02:34:49] <strcat> I was wrong, it's not an optimization, just cruft
[02:35:42] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:35:44] *** Joins: zz_kimundi (kimundi@moz-F02A6FA4.dip0.t-ipconnect.de)
[02:35:50] *** zz_kimundi is now known as kimundi
[02:36:11] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[02:40:09] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[02:42:07] <acrichto> brson: what are the hostnames for mac5/6?
[02:42:57] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:43:19] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[02:43:29] <strcat> acrichto: well this bug is fun
[02:43:41] <strcat> I'm going to fix a dozen other ones on the way
[02:43:44] <strcat> ;p
[02:43:50] <strcat> I think I'll open a PR with just the tuples for now...
[02:44:09] <acrichto> are these existing codegen bugs or just optimizations?
[02:44:23] <strcat> I am implementing an optimization and fixed an issue codegen bug
[02:44:31] <strcat> but there are some more I have to fix too
[02:44:40] <acrichto> oh fun :)
[02:44:44] <strcat> just because tuples and structs are used more than newtype/unit structs
[02:44:56] <strcat> so I have to fix existing bugs
[02:45:00] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:45:44] <acrichto> is llvm smsart enough to put (i32,i32) in one 64-bit register?
[02:46:20] <strcat> acrichto: clang is
[02:46:32] <strcat> and LLVM is, yeah
[02:46:52] <acrichto> llvm is smart
[02:47:06] <strcat> acrichto: https://github.com/mozilla/rust/pull/9643 r?
[02:47:16] <acrichto> looking
[02:47:43] <strcat> it's sort of an odd assortment ;p, fixing that was needed to make 1-word (or smaller) tuples immediate
[02:49:00] <strcat> anyway the current code is very weird.... I want it to end up entirely based on size
[02:49:06] <strcat> but it hits a dozen bugs so just tuples for now
[02:51:00] <acrichto> what's a dps expr vs a datum expr?
[02:51:40] <strcat> acrichto: I don't quite understand why we need it, but the point is that traits are always non-immediate and they're the only thing you can cast to with 'as' that is
[02:51:47] <strcat> (the dps rvalue code *only* handles traits)
[02:52:07] <strcat> so I just replaced that (mis)use of type_is_immediate with what it *really* wanted to check for
[02:52:44] <strcat> (traits are 2 words so they will eventually be immediate on x86, when I'm done)
[02:53:28] <acrichto> that's b/c the recommended limit for by-value things is 2 words?
[02:53:35] <acrichto> at least on x86/x64
[02:56:11] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[02:57:06] <strcat> acrichto: well we can query LLVM
[02:57:15] <strcat> I'll copy what clang does, until then I'll do 1 word
[02:57:23] <acrichto> oh nice
[02:57:42] <strcat> acrichto: in *theory* you should be able to just treat all types as 'immediate' and LLVM should do the Right Thing
[02:58:00] <strcat> but lowering properly is only implemented for x86/x86_64 and may not be very performance conscious
[02:58:06] <acrichto> ah
[02:58:32] <strcat> acrichto: anyway I hit another assert... have to fix something else :s
[02:59:12] <strcat> maybe I'll just land the first 3 commits for now
[03:00:39] <acrichto> seems unfortunate that we need X and X_immediate
[03:01:23] <strcat> acrichto: we don't, it's a convenience function to make an alloca for you
[03:01:36] <strcat> in theory it doesn't have to make an alloca
[03:02:02] <acrichto> oh ok, I guess it is just convenience
[03:03:35] <acrichto> strcat: in the new type_is_immediate, is the `simple` check needed?
[03:03:56] <acrichto> can you get by with just "return sizeof(ty) <= sizeof(int)"
[03:04:04] <strcat> acrichto: that's what I want to do eventually, doesn't work now
[03:04:14] <strcat> it means fixing code paths for enums, structs and tuples
[03:04:15] <acrichto> oh b/c of lots of other bugs?
[03:04:18] <acrichto> ah ok
[03:04:18] <strcat> yes
[03:04:19] *** Quits: doomlord_ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Quit: Leaving)
[03:04:23] *** Quits: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Quit: Leaving)
[03:04:24] <strcat> our codebase doesn't handle immediates in all paths
[03:05:34] <acrichto> will the pattern of "if immediate() { return } else { store/return void }" become more common?
[03:05:48] <acrichto> as the other code paths are fixed?
[03:12:39] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[03:19:54] <acrichto> strcat: can you put a comment in type_is_immediate saying that it should change shortly
[03:19:55] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:19:58] <acrichto> other than that lgtm
[03:20:03] <strcat> acrichto: I'm removing the last commit for now
[03:20:23] <acrichto> oh ok
[03:20:23] <strcat> gone
[03:20:35] <strcat> acrichto: it broke some tests :s
[03:20:42] <acrichto> what do you think about removing free_ty_immediate
[03:24:13] <strcat> acrichto: yes
[03:24:19] <strcat> acrichto: I'd like to remove free glue completely though
[03:24:27] <strcat> via lang items defining primitives in libstd
[03:24:30] <strcat> and just impl Drop
[03:24:37] <strcat> need to fix xcrate inlining of drop
[03:24:45] <strcat> nothing works xcrate :s
[03:24:47] <acrichto> that'd be nice to have
[03:25:08] <acrichto> xcrate inlining of drop seems necessary to make raii viable
[03:25:14] <strcat> acrichto: r+ for the first 3 though?
[03:25:22] <strcat> going to have to debug tuples more :(
[03:25:45] <acrichto> r+
[03:26:02] <strcat> maybe my with_overflow code is wrong
[03:33:57] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[03:46:26] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:46:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ejvuKg
[03:46:26] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:51:27] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:51:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/6cF62Q
[03:51:27] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:51:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:51:35] <ghrust> 01[13rust01] 15bors pushed 16 new commits to 06auto: 02http://git.io/1vawRw
[03:51:35] <ghrust> 13rust/06auto 14eea32df 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[03:51:35] <ghrust> 13rust/06auto 14cb956cc 15Alex Crichton: std: Remove usage of fmt!
[03:51:36] <ghrust> 13rust/06auto 1480cf7cb 15Alex Crichton: extra: Remove usage of fmt!
[03:51:38] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:52:46] * dbaupp wills this to work
[03:55:45] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[03:58:57] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[04:01:34] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:01:34] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14257875f to 14bc6dd90: 02http://git.io/N3iJvQ
[04:01:34] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:02:33] <acrichto> that was fast :(
[04:05:37] * dbaupp needs to will harder
[04:12:08] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:12:30] <strcat> acrichto: heh, I can't figure out why it dies
[04:13:47] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:22:17] <strcat> acrichto: it refuses ti actually return structs directly
[04:22:19] <strcat> tuples... sure
[04:22:31] <strcat> and by refuses I mean rustc won't output the IR I expect
[04:25:02] <acrichto> I think rustc just doesn't like you
[04:34:14] <brson> acrichto: 5&6 don't have registered host names
[04:34:21] <strcat> acrichto: the order I put the functions changes whether they are immediate
[04:34:25] <strcat> wat.
[04:34:25] <brson> i haven't gotten around to filing a ticket
[04:34:33] <strcat> fn bar() -> Foo { Foo{x: 2} }
[04:34:34] <strcat> fn foo() -> (int,) { (2,) }
[04:34:38] <strcat> acrichto: it refuses ti actually return structs directlydefine %struct.Foo @_ZN3bar18h603aa56b29d96e3ag4v0.0E({ i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone) #0 {
[04:34:40] <strcat> er
[04:34:42] <strcat> define %struct.Foo @_ZN3bar18h603aa56b29d96e3ag4v0.0E({ i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone) #0 {
[04:34:45] <strcat> define { i64 } @_ZN3foo19h5396367929172193am4v0.0E({ i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone) #0 {
[04:34:50] <strcat> and now.... the other way
[04:34:52] <brson> acrichto: currently they are 10.250.5.63 and 10.250.3.151
[04:34:58] <acrichto> brson: eh not too much of a problem, just wanted to poke around
[04:34:58] <strcat> define { i64 } @_ZN3foo19h5396367929172193ag4v0.0E({ i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone) #0 {
[04:35:01] <strcat> define void @_ZN3bar18h603aa56b29d96e3an4v0.0E(%struct.Foo* noalias nocapture sret, { i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone) #1 {
[04:35:12] <strcat> seriously.... why would it do this to me? ;p
[04:35:23] <dbaupp> somethingsomething hashtable
[04:35:37] <acrichto> strcat: weird
[04:35:41] <strcat> I think sizing_of/type_of must be broken non-deterministically
[04:35:42] <strcat> :s
[04:35:47] <strcat> can't think of anything else
[04:36:07] <strcat> sizing_type_of*
[04:37:58] <strcat> that's good, test failed on windows
[04:38:01] <strcat> main not pub
[04:41:26] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:41:28] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:41:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ec18eb0 to 14bc6dd90: 02http://git.io/N3iJvQ
[04:41:28] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:41:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:41:35] <ghrust> 01[13rust01] 15bors pushed 16 new commits to 06auto: 02http://git.io/uO_Bog
[04:41:35] <ghrust> 13rust/06auto 14eea32df 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[04:41:35] <ghrust> 13rust/06auto 14cb956cc 15Alex Crichton: std: Remove usage of fmt!
[04:41:37] <ghrust> 13rust/06auto 1480cf7cb 15Alex Crichton: extra: Remove usage of fmt!
[04:41:38] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:42:35] <acrichto> :(
[04:42:48] <acrichto> oh windows, you always bring us joy
[04:43:21] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:50:58] <strcat> acrichto: heh, I fixed 4 bugs with that immediate thing
[04:50:59] <strcat> the same bug
[04:51:05] <strcat> just different variants.
[04:51:28] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:51:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140a83e20 to 14bc6dd90: 02http://git.io/N3iJvQ
[04:51:28] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:51:29] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[04:51:29] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/zbRNEA
[04:51:29] <ghrust> 13rust/06auto 1411b7109 15Daniel Micay: rm only use of type_is_immediate outside of trans
[04:51:29] <ghrust> 13rust/06auto 144dd3ccb 15David Creswick: Add test for issue #9446.
[04:51:30] <ghrust> 13rust/06auto 14ab0a884 15Daniel Micay: fix dropping non-primitive immediates...
[04:51:32] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[04:51:42] <strcat> acrichto: I re-ordered the function calls to llsize_of and now it works
[04:51:45] <strcat> wtf?
[04:51:46] <strcat> wtf.
[04:51:54] <strcat> I think our bindings are broken
[04:53:13] <acrichto> weird
[04:54:33] <strcat> it segfaults later :s
[04:54:43] <strcat> meh still non-deterministic
[04:54:49] <strcat> just *differently* non-deterministic
[04:56:41] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:56:41] <ghrust> 01[13rust01] 15erickt 04force-pushed 06try from 144bd1749 to 149e1869e: 02http://git.io/k471pw
[04:56:41] <ghrust> 13rust/06try 14d9bf8c7 15Erick Tryzelaar: std: Replace num::IntConvertible with {To,From}Primitive
[04:56:41] <ghrust> 13rust/06try 146f36864 15Erick Tryzelaar: syntax: Add #[deriving(FromPrimitive)] syntax extension...
[04:56:42] <ghrust> 13rust/06try 1474e1fb0 15Erick Tryzelaar: syntax: swap from .span_fatal to .span_err in #[deriving(FromPrimitive)]
[04:56:44] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:58:20] <strcat> acrichto: 5 bugs closed!
[04:58:32] <acrichto> strcat: nice!
[05:03:36] <strcat> wtf.
[05:03:43] <strcat> I can't believe how mysterious it is
[05:03:51] <strcat> the order you declare the functions changes whether they're immediate
[05:06:52] * strcat throws in a bunch of println!
[05:11:18] <cmr> strcat: what sort of devily haveyou stumbled upon!?
[05:11:31] <cmr> *devilry
[05:13:36] <strcat> cmr: so I taught type_is_immediate to treat small tuples as immediate (1-word or smaller)
[05:13:54] <strcat> and...... now it's non-deterministic whether they are immediate
[05:14:04] <strcat> it's definitely not a problem with what I wrote, it's a problem elsewhere :(
[05:14:06] <strcat> fun? ;p
[05:14:16] <strcat>             let llty = sizing_type_of(ccx, ty);
[05:14:18] <strcat>             let size = llsize_of(ccx, llty);
[05:14:20] <strcat>             let int_size = llsize_of(ccx, ccx.int_type);
[05:14:22] <strcat>             println!("{} {} {}", ccx.tn.type_to_str(llty), size, int_size);
[05:14:24] <strcat> mystery awaits, compiling with debug logging atm
[05:14:35] <strcat> aha!
[05:14:38] <strcat> I feel silly now
[05:14:46] <strcat> acrichto: it is my fault :)
[05:14:52] <acrichto> :(
[05:14:55] <strcat> it is comparing the pointers...
[05:15:29] <strcat> whew
[05:16:55] <strcat> acrichto: I bet there are other bugs from this :s
[05:17:06] <strcat> llsize_of(cx: &CrateContext, ty: Type) -> ValueRef
[05:17:12] <strcat> llsize_of_real(cx: &CrateContext, ty: Type) -> uint
[05:17:20] <strcat> ValueRef is a raw ptr
[05:17:24] * strcat sighs
[05:17:30] <acrichto> wait what
[05:17:40] <strcat> I was comparing the ptr addresses by accident
[05:17:54] <strcat> println! revealed it by printing them as addresses
[05:19:17] <dbaupp> strcat: * is the only thing that compares by address, right?
[05:19:20] <strcat> acrichto: soooooo ridiculous that this was the problem
[05:19:22] <strcat> dbaupp: yes
[05:19:54] <strcat> we shouldn't have raw ptrs all over
[05:20:02] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:21:47] <acrichto> rusti: 0 as *int == 0
[05:21:48] -rusti- <anon>:7:22: 7:23 error: mismatched types: expected `*int` but found `<VI1>` (expected *-ptr but found integral variable)
[05:21:49] -rusti- <anon>:7          0 as *int == 0
[05:21:49] -rusti-                                ^
[05:21:49] -rusti- error: aborting due to previous error
[05:21:49] -rusti- application terminated with error code 101
[05:22:02] <acrichto> strcat: were you comparing two pointers?
[05:22:09] <strcat> acrichto: yes.
[05:22:12] <acrichto> ah
[05:22:26] <strcat> acrichto: llsize_of wraps llsize_of_alloc (what I wanted) and returns a raw ptr
[05:22:35] <acrichto> wheeeeeeeeee
[05:22:51] <strcat> it just turns it into an LLVM ValueRef for a const int
[05:22:55] <strcat> yay weak, totally unsafe typing?
[05:23:25] <strcat> acrichto: this is why it worked sometimes, and didn't work other times ;p
[05:23:29] <acrichto> C is awesome :D
[05:23:48] <strcat> the sad part is that LLVM has a strongly typed C++ API but we use the C wrapper
[05:23:54] <strcat> the C wrapper gives you 2 wonderful things
[05:24:12] <strcat> 1) cruft, since it is actually a stable API despite LLVM changing all the time
[05:24:15] <strcat> 2) weak typing!
[05:24:30] <acrichto> lgtm
[05:24:55] <strcat> I don't think you could really map their type hierarchy to rust very well
[05:25:00] <strcat> since it's very OOP
[05:25:35] <strcat> acrichto: http://llvm.org/docs/doxygen/html/classllvm_1_1Function.html inheritance diagram shows you what we're missing ;p
[05:26:05] <strcat> for us, functions, constants, globals, locals, parameters, etc. - all ValueRef ptrs! ;p
[05:28:59] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[05:36:05] <acrichto> although I suppose this is one spot where our own type system could be beneficial
[05:36:13] <acrichto> this is what newtype struct sare for
[05:36:47] <strcat> maybe it could be translated to a trait hierarchy
[05:37:51] <dbaupp> aatch tried/is trying to do that
[05:41:48] <strcat> acrichto: tuple thing compiled
[05:41:53] <strcat> trying structs too now...
[05:49:12] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:49:12] *** ChanServ sets mode: +o tjc
[05:53:55] <strcat> acrichto: terminate called after throwing an instance of 'unsigned long'
[05:53:58] <strcat> :D
[05:54:09] <strcat> while compiling libstd in stage2
[05:54:11] <acrichto> how do you even manaage that
[05:54:13] <strcat> o_O
[05:54:28] * strcat is special
[05:54:53] <strcat> acrichto: maybe something in the remaining C++ bits of the runtime...
[05:56:00] <strcat> #4  0x00007ffff2e45c73 in std::terminate() () from /usr/lib/libstdc++.so.6
[05:56:11] <strcat> #5  0x00007ffff2e45e9e in __cxa_throw () from /usr/lib/libstdc++.so.6
[05:56:13] <strcat> #6  0x00007ffff5b1db9a in rust_begin_unwind (token=839147) at /home/strcat/projects/rust/src/rt/rust_builtin.cpp:509
[05:56:15] <strcat> #7  0x00007ffff77a2c06 in rt::task::Unwinder::begin_unwind::h7c12263797ed078OFa0::v0.9$x2dpre ()
[05:56:17] <strcat> :s
[05:57:50] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Input/output error)
[05:57:52] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[05:58:16] <strcat> um
[05:58:25] <strcat> it doesn't start the runtime anymore
[05:59:44] <strcat> acrichto: afact....... it now acts like no_std is always on
[05:59:46] <strcat> even when it's not
[05:59:49] <strcat> afaict*
[06:01:27] * strcat is good at breaking rustc in exciting new ways
[06:03:41] <dbaupp> acrichto: btw, strcat introduced https://github.com/mozilla/rust/pull/9643/files#diff-52fc7c46659159fd8efd707aed8970b2R19
[06:03:46] <dbaupp> (a %)
[06:04:06] <dbaupp> so assuming that will land, you should rebase on top of auto to get rid of it
[06:04:08] <strcat> oh, sorry
[06:04:22] <strcat> technically that's someone else's patch that I cherry-picked - I only get half the blame! :)
[06:04:26] <dbaupp> haha :)
[06:04:40] <strcat> why write tests when you can steal someone else's patch
[06:08:07] <strcat> rust_begin_unwind(uintptr_t token) {
[06:08:09] <strcat>     throw token;
[06:08:11] <strcat> so throwing is fine
[06:08:14] <strcat> catching isn't
[06:16:32] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:16:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/zbRNEA
[06:16:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:21:35] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:21:35] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/4S3FcA
[06:21:35] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:21:37] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:21:37] <ghrust> 01[13rust01] 15bors pushed 16 new commits to 06auto: 02http://git.io/9a15AQ
[06:21:37] <ghrust> 13rust/06auto 1401cb924 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[06:21:37] <ghrust> 13rust/06auto 144b8c76e 15Alex Crichton: std: Remove usage of fmt!
[06:21:38] <ghrust> 13rust/06auto 147092d03 15Alex Crichton: extra: Remove usage of fmt!
[06:21:40] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:22:20] <acrichto> argh just missed it
[06:23:11] <dbaupp> acrichto: fix it & cancel the builds etc?
[06:23:23] <acrichto> yeah I think I'll just cancel a build
[06:23:40] <acrichto> I'm not entirely sure what just happened
[06:23:47] <acrichto> b/c bors didn't comment on any of the commits
[06:23:58] <acrichto> all I did was push a new one...
[06:26:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:26:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1408bc559 to 141dbc467: 02http://git.io/N3iJvQ
[06:26:30] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:26:38] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:26:38] <ghrust> 01[13rust01] 15bors pushed 17 new commits to 06auto: 02http://git.io/9G04aQ
[06:26:38] <ghrust> 13rust/06auto 14aaf6cc3 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[06:26:38] <ghrust> 13rust/06auto 14a8ba31d 15Alex Crichton: std: Remove usage of fmt!
[06:26:38] <ghrust> 13rust/06auto 147e709bf 15Alex Crichton: extra: Remove usage of fmt!
[06:26:40] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:26:50] <acrichto> I think I like hit a race in bors
[06:26:53] <acrichto> I got the emails about the commits
[06:27:02] <acrichto> but there's no comments on the commits...
[06:27:25] <dbaupp> different commits, because you psuhed over the PR?
[06:27:52] <dbaupp> (since bors doesn't send the emails itself, it's just github doing that, right?)
[06:28:07] <acrichto> nah it was the same commits, I just put one on top
[06:28:14] <acrichto> oh hm yeah github sends those not bors...
[06:28:15] <acrichto> werid
[06:32:13] * acrichto shakes fist at windows
[06:36:30] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:36:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149518361 to 141dbc467: 02http://git.io/N3iJvQ
[06:36:30] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:36:32] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:36:32] <ghrust> 01[13rust01] 15bors pushed 17 new commits to 06auto: 02http://git.io/5BYspg
[06:36:32] <ghrust> 13rust/06auto 14aaf6cc3 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[06:36:32] <ghrust> 13rust/06auto 14a8ba31d 15Alex Crichton: std: Remove usage of fmt!
[06:36:33] <ghrust> 13rust/06auto 147e709bf 15Alex Crichton: extra: Remove usage of fmt!
[06:36:35] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:41:51] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[06:43:25] *** flaper87|afk is now known as flaper87
[06:51:32] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:51:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c7a7f4c to 141dbc467: 02http://git.io/N3iJvQ
[06:51:32] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:51:33] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:51:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/TZA3YA
[06:51:33] <ghrust> 13rust/06auto 14350b543 15Jyun-Yan You: add -Z soft-float option...
[06:51:33] <ghrust> 13rust/06auto 14f6df7ab 15bors: auto merge of #9617 : crabtw/rust/softfp, r=alexcrichton...
[06:51:34] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:58:37] <strcat> acrichto: https://github.com/mozilla/rust/pull/9656 r?
[06:58:45] <strcat> added a FIXME + bug about doing ty_enum/ty_struct too
[06:59:23] <strcat> look at that b-e-a-u-t-i-f-u-l IR
[06:59:34] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[07:01:55] <Luqman> so amazing
[07:04:06] <strcat> Luqman: fwiw I fixed the asserts that were hit people
[07:04:08] <strcat> er
[07:04:10] <strcat> hit before*
[07:04:13] <strcat> weird freudian slip there...
[07:04:22] <Luqman> haha
[07:04:28] <Luqman> just some unhandled code paths?
[07:04:33] <strcat> Luqman: https://github.com/mozilla/rust/pull/9643 not quite
[07:04:37] <strcat> it fixed 5 bugs
[07:04:41] <strcat> tiny little issue
[07:05:07] <strcat> drop_ty_immediate manually handled a few types, and dispatched to normal drop_ty/refcount for each
[07:05:15] <strcat> so I just made it less special-cased, it generates the same IR
[07:05:34] <strcat> I think it was an attempt at an optimization
[07:05:37] <strcat> maybe it *was* at one point
[07:05:44] <strcat> (avoiding an alloca)
[07:05:55] <strcat> but it currently didn't avoid any allocas
[07:06:12] <strcat> Luqman: https://github.com/thestinger/rust/blob/ab0a884a7373145222dfbadc8ec741f767cc45d1/src/librustc/middle/trans/glue.rs#L94 it just calls free_ty
[07:06:18] <strcat> (after making an alloca)
[07:06:24] * strcat shrugs
[07:06:31] <strcat> I think we can avoid it but I'll tackle that later
[07:06:49] <strcat> I care a *lot* more about the optimized IR anyway
[07:07:14] <Luqman> did decr_refcnt_maybe_free do the same thing or was it just wrong?
[07:08:01] <strcat> Luqman: same thing
[07:08:18] <strcat> Luqman: https://github.com/thestinger/rust/blob/ab0a884a7373145222dfbadc8ec741f767cc45d1/src/librustc/middle/trans/glue.rs#L464 normal drop glue
[07:08:24] <strcat> calls that same function
[07:09:05] <strcat> so, it's possible it avoided an alloca there
[07:09:16] <strcat> but @ will use gc
[07:09:33] <strcat> doesn't matter ;p
[07:09:34] <Luqman> cool, r+ on the small tuples. lgtm
[07:09:46] <Luqman> aww, acrichto beat me :P
[07:09:48] <strcat> heh
[07:10:01] <Luqman> reading too slow
[07:10:01] <strcat> Luqman: can't decide if I want to do enums or structs next...
[07:10:11] <strcat> structs hit a horrible codegen/library/runtime bug
[07:10:25] <strcat> it fails to catch failure, but also something *causes* a failure it fails to catch
[07:10:35] <strcat> enums hit some LLVM asserts
[07:10:42] <strcat> I think just because we assume they are never immediate
[07:10:44] <strcat> in expr/datum
[07:10:58] <Luqman> yea, there was a comment to that effect somewhere i think
[07:11:40] <strcat> once I get the immediate stuff solid, I'll fix the indirect passing
[07:11:45] <strcat> it should likely use LLVM's byval
[07:11:55] <strcat> same kind of optimization as adding sret was - gives it a lot more to work with
[07:12:06] <strcat> (byval is an attribute)
[07:12:36] <strcat> LLVM should really lower this crap itself, *sigh*
[07:12:42] <strcat> the backends just aren't reliable
[07:13:31] *** Joins: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[07:13:45] <acrichto> Eridius: +5k loc ?! wow
[07:14:23] <Eridius> acrichto: 5417k of that is the new path module
[07:14:33] <Eridius> 2.7k for WindowsPath, over half of which is tests
[07:14:42] <Eridius> err 5.4k. 5417k indeed hah
[07:15:03] <dbaupp> paths are hard
[07:15:11] <acrichto> apparently...
[07:15:24] <Eridius> acrichto: a lot of debug statements gained 2 extra lines (per path being printed) for the .as_display_str. Some other stuff got extra lines to work around removed allocations (rvalue issue for some)
[07:15:28] <Eridius> dbaupp: WindowsPaths are hard
[07:15:42] <sfackler> has there been any discussion of allowing you to limit the visibility of the interior of newtypes? something like "pub struct Foo(priv Bar)"
[07:15:51] <strcat> sfackler: I believe there's a bug open
[07:16:06] <acrichto> sfackler: I thought the resolution on that was "wontfix", I coudl be mis-remembering though
[07:16:12] <strcat> we're almost up to 1.4k, I should go on a close spree again
[07:16:19] <dbaupp> Eridius: well, 2.7k is also PosixPath if 2.7k is WindowsPath :P
[07:16:25] * strcat has 103 open bugs ;3
[07:16:47] <Eridius> dbaupp: what do you mean? path::posix is 1.6k
[07:17:02] <strcat> https://github.com/mozilla/rust/issues/created_by/thestinger?state=open oh it counts PRs
[07:17:02] <Eridius> another 1k for path itself (all the default methods, etc)
[07:17:03] <dbaupp> Eridius: oh, what's the other 1.3k?
[07:17:30] <Eridius> and the final .1k is rounding error ;)
[07:17:58] <sfackler> strcat: do you have a link to it? I'm not seeing anything searching around
[07:18:34] <strcat> sfackler: https://github.com/mozilla/rust/issues/5489 oh it was closed
[07:18:48] <Eridius> oh wow, PosixPath is 65% tests. WindowsPath is only 55% tests
[07:19:07] * strcat finds newtype structs fairly useless without priv
[07:19:21] <sfackler> == strcat
[07:19:56] <sfackler> there's a ton of stuff in std::rt that's newtype wrappers around private API runtime stuff that really shouldn't be visible
[07:20:10] <strcat> acrichto: you made me clear out all my old binaries ;p
[07:20:17] <acrichto> strcat: muahaha
[07:20:26] <acrichto> at least it works
[07:20:29] * strcat never uses git add except when adding a file anyway ;p
[07:21:00] <flaper87> acrichto: I squashed those commits! thanks for reviewing!
[07:21:20] <Eridius> strcat: what do you normally use?
[07:21:37] <strcat> commit -a, commit -p, amend, rebase, stash
[07:21:46] <Eridius> ewww
[07:21:50] <strcat> ;p
[07:21:53] <Eridius> I always add, then check what I have staged, then commit
[07:21:57] <strcat> pfft
[07:22:08] <Eridius> `git add -u` is your friend. Won't add new files
[07:23:37] <acrichto> flaper87: I'm assuming that the dox weren't actually changed, just reformatted, right?
[07:23:41] <acrichto> from when bblum approved it at least
[07:24:07] <strcat> Eridius: fugitive + git-gutter already lets me browse the files when I commit
[07:24:17] <flaper87> acrichto: correct, no changes! just removed a trailing space and squashed the commits
[07:24:24] <acrichto> flaper87: cool, r+
[07:24:35] <flaper87> acrichto: thank you!
[07:24:38] <acrichto> np
[07:26:18] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[07:27:09] <sfackler> strcat: given that that bug's been resolved wontfix, do you think that types like "pub struct TcpStream(~RtioTcpStreamObject);" should be changed to structs with a single private field? I'm leaning towards yes
[07:27:21] <strcat> yeah, probably
[07:29:12] <acrichto> sfackler: I forget, but they may have been intended to be trait objects
[07:29:26] <acrichto> brson would have a better idea of where they were intended to go
[07:31:30] <sfackler> i'll ping him. it also looks like there's no reason for the ~ there as well
[07:37:41] <acrichto> Eridius: if you want to be super clever you could implement Div for Path to do Path::from_str("test") / "bar" / "foo"
[07:37:52] <acrichto> (please don't actually do that)
[07:38:15] <Luqman> but but it looks so nice xD
[07:39:16] <sfackler> ah, the perils of operator overloads :D
[07:42:25] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:51:35] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:51:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/TZA3YA
[07:51:35] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:56:34] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:56:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/zTD-yw
[07:56:34] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:56:36] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:56:36] <ghrust> 01[13rust01] 15bors pushed 17 new commits to 06auto: 02http://git.io/vf-Evg
[07:56:36] <ghrust> 13rust/06auto 14aaf6cc3 15Alex Crichton: Prevent leakage of fmt! into the compiler...
[07:56:36] <ghrust> 13rust/06auto 14a8ba31d 15Alex Crichton: std: Remove usage of fmt!
[07:56:36] <ghrust> 13rust/06auto 147e709bf 15Alex Crichton: extra: Remove usage of fmt!
[07:56:38] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:02:07] <Eridius> acrichto: that's cute and terrible at the same time
[08:03:08] <dbaupp> when we have a regex library, define statics s and g etc, so we can write s/"foo"/"bar"/g \o/
[08:04:25] <Eridius> oooh that's nasty
[08:04:40] <dbaupp> s/nasty/awesome/
[08:04:47] * Eridius goes back to bed
[08:07:19] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[08:07:23] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[09:01:38] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:01:38] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/vf-Evg
[09:01:38] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:06:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[09:06:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/xnySOA
[09:06:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[09:06:35] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[09:06:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/kzp7Sg
[09:06:35] <ghrust> 13rust/06auto 14d379ff4 15Flavio Percoco: Update std::task::mod docstring
[09:06:35] <ghrust> 13rust/06auto 14d6c3b67 15bors: auto merge of #9576 : FlaPer87/rust/issue/9125, r=alexcrichton...
[09:06:35] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[09:14:50] <dbaupp> acrichto: \o/
[09:21:48] *** Quits: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca) (Ping timeout)
[09:22:11] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Ping timeout)
[09:25:57] <klutzy> acrichto: <std-macros>:11:43: 11:52 error: macro undefined: 'oldformat'
[09:25:58] <klutzy> :o
[09:31:47] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[09:37:12] <dbaupp> klutzy: compile with --cfg nofmt
[09:40:29] <dbaupp> https://github.com/mozilla/rust/pull/9657 r? (I'm just building a compiler to test it now)
[09:40:35] <dbaupp> klutzy: ^ (the fix)
[09:41:29] <klutzy> dbaupp: aha, thanks!
[09:42:39] * dbaupp wonders who has review privileges and is around now
[09:45:31] <dbaupp> flaper87: do you have review privileges, or are you just pretending? :P
[09:46:06] <flaper87> dbaupp: pretending :D (FWIW) <- this is the part where I admit I'm pretending :D
[09:46:30] <dbaupp> haha :)
[09:46:35] <flaper87> I'm trying to help reviewing code as much as possible even if I don't have r+ priviledges
[09:46:46] * flaper87 will hopefully get those priviledges soon
[09:46:58] <flaper87> I still need to learn a lot about rust
[09:49:06] <dbaupp> (I made a mistake, there were more format's to remove)
[09:51:47] * flaper87 will pretend again
[09:52:37] <dbaupp> flaper87: could I ask you not to actually comment? another reviewer may see it and assume that they don't need to.
[09:52:49] <dbaupp> (feel free to read the code, though)
[09:53:47] <flaper87> dbaupp: oh ok, sure. Sorry about that!
[09:57:21] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Quit: dbaupp)
[10:00:10] *** Joins: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net)
[10:02:13] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[10:02:28] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:02:44] <dbaupp> nmatsakis: ping
[10:02:48] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:02:49] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[10:04:38] <dbaupp> meh
[10:04:48] * dbaupp r+ it himself, to get in the next bors cycle
[10:06:43] <nmatsakis> dbaupp: pong
[10:07:02] <flaper87> dbaupp: lol
[10:07:38] <dbaupp> nmatsakis: a review of https://github.com/mozilla/rust/pull/9657 (I r+'d it myself because it's breaking external code accidentally)
[10:08:12] <nmatsakis> ok
[10:08:17] <nmatsakis> looks harmless enough :)
[10:08:17] <dbaupp> anyway, gtg
[10:11:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:11:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/kzp7Sg
[10:11:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:16:33] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[10:16:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/EktgOw
[10:16:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[10:16:35] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[10:16:36] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/QafwCA
[10:16:36] <ghrust> 13rust/06auto 146f16689 15Huon Wilson: Fix typo with format migration: s/oldformat/oldfmt/.
[10:16:36] <ghrust> 13rust/06auto 14ec2b9cc 15bors: auto merge of #9657 : huonw/rust/oldfmt, r=huonw...
[10:16:36] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[10:17:51] *** flaper87 is now known as flaper87|afk
[10:29:34] *** flaper87|afk is now known as flaper87
[10:53:18] *** Joins: jensnockert (jensnocker@9CEA43E3.5B393F0A.A94117DA.IP)
[10:54:23] *** Quits: jensnockert (jensnocker@9CEA43E3.5B393F0A.A94117DA.IP) (Connection reset by peer)
[11:15:28] *** flaper87 is now known as flaper87|afk
[11:21:33] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[11:21:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/QafwCA
[11:21:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[11:21:46] *** flaper87|afk is now known as flaper87
[11:26:31] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[11:26:31] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3U7rFA
[11:26:31] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[11:31:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[11:31:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3U7rFA
[11:31:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[11:31:36] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[11:31:36] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/K1En2Q
[11:31:36] <ghrust> 13rust/06auto 14a3ccbdc 15Alex Crichton: rustdoc: Generate valid code for struct-variants...
[11:31:36] <ghrust> 13rust/06auto 14e523f99 15Alex Crichton: rustdoc: Add the ability to input json...
[11:31:37] <ghrust> 13rust/06auto 14863555f 15Alex Crichton: rustdoc: Update the man page...
[11:31:39] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[11:44:34] *** Joins: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[11:50:54] <dbaupp> klutzy: should be fixed now (fwiw)
[11:54:47] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[12:06:05] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:12:57] *** Joins: doomlord_ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[12:22:00] *** flaper87 is now known as flaper87|afk
[12:33:43] *** flaper87|afk is now known as flaper87
[12:36:34] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:36:34] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/K1En2Q
[12:36:34] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:38:51] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[12:41:29] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:41:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/dmGOXg
[12:41:29] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:41:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:41:33] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/oMPS_g
[12:41:33] <ghrust> 13rust/06auto 14a076fef 15Felix S. Klock II: Add new lint: non_uppercase_pattern_statics, for #7526....
[12:41:33] <ghrust> 13rust/06auto 149246742 15Felix S. Klock II: Throwing in another interesting test case: There is no need to warn...
[12:41:33] <ghrust> 13rust/06auto 14c0599b1 15Felix S. Klock II: Fix typo in comment.
[12:41:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[13:07:08] *** Joins: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[13:07:18] *** Quits: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Connection reset by peer)
[13:14:22] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[13:17:58] <nmatsakis> pnkfelix: regarding the mailing list thread, I've been attempting to fix this bug in a nice way for a while now (I'm on my 5th branch)...
[13:18:05] <nmatsakis> pnkfelix: ...and i've been too frustrated to read it :)
[13:18:42] <nmatsakis> pnkfelix: I think i've finally settled on the correct representation (debruijn indices) and the correct way to handle the name resolution (separate, specialized variation on resolve)
[13:20:06] <pnkfelix> nmatsakis: are you hoping to jump all the way to supporting `'a: let x: &'a T = ; }` ?
[13:22:43] <nmatsakis> pnkfelix: no, not in one jump
[13:24:19] <nmatsakis> pnkfelix: I have to read that ML thread a few more times, but I think this boils down to an evolving best practice -- I feel like the best way to write generic traits is not yet known,
[13:24:37] <nmatsakis> pnkfelix: and that in particular composability with structs that contain borrowed pointers does not happen for free,
[13:24:50] <nmatsakis> pnkfelix: one must prepare for it to some extent when defining the genreic triat
[13:25:31] <nmatsakis> pnkfelix: in particular I also expect our own iterator trait will need to change as well, which is partly why I want lifetime parameters to behave sensibly, so that we can do these refactorings without having to jump through oops
[13:25:35] <nmatsakis> *hoops
[13:26:32] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:26:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b531144 to 140dce112: 02http://git.io/N3iJvQ
[13:26:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:26:34] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:26:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/w-QdxA
[13:26:34] <ghrust> 13rust/06auto 1423cb72b 15Alex Crichton: Clarify format! implicit positional references...
[13:26:34] <ghrust> 13rust/06auto 1412404aa 15bors: auto merge of #9644 : alexcrichton/rust/clarify, r=huonw...
[13:26:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:26:44] *** Joins: nrc (nrc@13F2CEC5.7672369.D8E68FF6.IP)
[13:28:52] <nmatsakis> composability is what keeps me up at night when I worry about Rust :/
[13:32:38] <dbaupp> nmatsakis: out of interest, in what way do you visualise Iterator changing?
[13:32:56] <nmatsakis> dbaupp: basically I think we'll have to make the Iterator trait take a lifetime parameter
[13:33:08] <nmatsakis> dbaupp: which is representative of the maximum time that the iterator is valid for
[13:33:39] <nmatsakis> dbaupp: the reason being that the iterators that iterate over `&mut T` should not type check, they only do so because of a bug
[13:34:05] <nmatsakis> dbaupp: #8624 -- I haven't talked about this much, was doing some quiet investigation first :)
[13:34:22] <nmatsakis> I should discuss with strcat etc
[13:34:33] * dbaupp reads the issue
[13:34:46] <nmatsakis> dbaupp: actually I was thinking that I had to fix the lifetime parameter stuff before we could fix the iterator trait,
[13:35:06] <nmatsakis> dbaupp: but I am ... probably mistaken, I guess I can prototype the work I had planned with 'self
[13:36:15] <dbaupp> nmatsakis: the example in that bug is concerning! lucky someone is working on it :)
[13:36:16] <nmatsakis> dbaupp: the issue doesn't have a lot of details, I'll need to write up a blog post
[13:37:09] <dbaupp> nmatsakis: I imagine an iterator like range that doesn't have any borrowed pointers would be a Iterator<'static, T>? 
[13:38:56] <nmatsakis> dbaupp: actually I'm not sure, I think you'd probably implement it like "impl<'l> Iterator<'l, T> for Range { ... }" -- i.e., for any lifetime
[13:39:14] <dbaupp> oh, I guess that works too
[13:39:22] <nmatsakis> dbaupp: I've been too busy with other stuff to work this fully through, that's partly why I haven't talked about it much :/
[13:39:32] <nmatsakis> I think that implementing for any lifetime is more flexible than implementing for 'static,
[13:40:26] <nmatsakis> the main change is that the next() routine would probably be "trait Iterator<'l, T> { fn next(&'a mut self) -> Option<T>; }"
[13:40:40] <nmatsakis> anyway, let me do some investigation, I will try to write up a blog post
[13:40:43] <nmatsakis> got a bunch of those pending...
[13:41:04] <dbaupp> is that &'a meant to be 'l, or is it an entirely new lifetime?
[13:48:15] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[13:53:42] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[13:59:18] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[14:02:02] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[14:04:17] *** Joins: isenmann (isenmann@moz-B656BA79.science-computing.de)
[14:07:27] *** flaper87 is now known as flaper87|afk
[14:08:58] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[14:18:05] *** flaper87|afk is now known as flaper87
[14:26:38] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[14:26:50] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[14:28:50] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[14:31:43] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:31:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/w-QdxA
[14:31:43] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:36:36] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:36:36] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/yKQFaw
[14:36:36] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:36:37] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:36:37] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/CY0QuQ
[14:36:37] <ghrust> 13rust/06auto 14398e2c4 15Dan Connolly: clarify that rust_pkg is a place-holder...
[14:36:37] <ghrust> 13rust/06auto 14320af9b 15bors: auto merge of #9645 : dckc/rust/patch-2, r=catamorphism...
[14:36:37] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:45:24] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[15:10:47] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[15:10:47] <ghrust> 01[13rust01] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/BoVH6g
[15:10:47] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[15:29:50] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:34:55] *** Quits: StarLight (StarLight@moz-21100A01.dynamic.avangarddsl.ru) (Ping timeout)
[15:39:29] *** Joins: StarLight (StarLight@moz-3A24043E.pppoe.avangarddsl.ru)
[15:41:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:41:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/CY0QuQ
[15:41:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:46:28] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:46:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/SZLDcQ
[15:46:28] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:46:34] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[15:46:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1GO7tg
[15:46:34] <ghrust> 13rust/06auto 14e9889fd 15Alex Crichton: Change the format! statics to be all-caps...
[15:46:34] <ghrust> 13rust/06auto 14397e690 15bors: auto merge of #9633 : alexcrichton/rust/issue-9631, r=huonw...
[15:46:35] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[15:52:02] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[16:08:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:08:30] <ghrust> 01[13rust01] 15erickt 04force-pushed 06try from 149e1869e to 149028adb: 02http://git.io/k471pw
[16:08:30] <ghrust> 13rust/06try 149028adb 15Erick Tryzelaar: wip
[16:08:30] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:12:32] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[16:13:38] *** flaper87 is now known as flaper87|afk
[16:14:40] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[16:22:19] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:22:23] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:31:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[16:31:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14397e690 to 14320af9b: 02http://git.io/N3iJvQ
[16:31:32] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[16:31:35] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[16:31:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/-Tp9Iw
[16:31:35] <ghrust> 13rust/06auto 14eafbcfb 15Alex Crichton: Change the format! statics to be all-caps...
[16:31:35] <ghrust> 13rust/06auto 140b95cbe 15bors: auto merge of #9633 : alexcrichton/rust/issue-9631, r=huonw...
[16:31:36] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[16:41:47] <dbaupp> acrichto: is there a make target that builds the docs without doing a bootstrap (`make docs NO_REBUILD=1` doesn't work for me)?
[16:42:26] <acrichto> dbaupp: I just edit the makefile to remove the dependency on RUSTDOC
[16:42:35] <acrichto> mk/docs.mk
[16:42:50] <acrichto> although $target/stage2/bin/rustdoc should exist
[16:45:05] <dbaupp> acrichto: ok, thanks
[16:49:01] <pnkfelix> remind me, do we go through the I-nominated process for far-future stuff?  Or do we just tag it?  :)
[16:49:29] <pnkfelix> (by "just tag it" I meant "just change the milestone")
[16:49:52] <pnkfelix> but after a moment of reflection, I guess it doesn't hurt if other members of the team get the chance to say "no, that's more important than far-future!"
[16:49:58] <acrichto> if you're changing a milestone it's probably worthwhile to go through the I-nominated process
[16:50:27] <acrichto> nominated bug count is pretty under control now anyway, so one more probably won't hurt us
[16:55:55] <nmatsakis> pnkfelix: does your zimbra show a rust meeting today?
[16:56:22] <pnkfelix> nmatsakis: (loking)
[16:56:54] <pnkfelix> nmatsakis: yes.  7pm CET
[16:57:13] <nmatsakis> hmm, ok
[16:57:27] <nmatsakis> pnkfelix: for some reason mine doesn't
[16:57:32] <nmatsakis> pnkfelix: what room?
[16:58:00] <pnkfelix> nmatsakis: GIGO
[16:58:37] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:01:03] *** Joins: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net)
[17:01:33] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:01:33] *** ChanServ sets mode: +qo brson brson
[17:01:43] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[17:05:14] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[17:05:14] *** ChanServ sets mode: +o tjc
[17:11:33] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:11:33] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140b95cbe to 14320af9b: 02http://git.io/N3iJvQ
[17:11:33] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:11:35] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:11:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/UBAV8w
[17:11:35] <ghrust> 13rust/06auto 1462855e2 15Alex Crichton: Fix usage of the old debug! macros
[17:11:35] <ghrust> 13rust/06auto 1424a2537 15bors: auto merge of #9659 : alexcrichton/rust/fix-fmt, r=huonw...
[17:11:35] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:11:55] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[17:12:32] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[17:28:25] *** Quits: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net) (Ping timeout)
[17:30:29] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[17:30:34] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (NickServ (GHOST command used by stevekla1nik))
[17:30:37] *** stevekla1nik is now known as steveklabnik
[17:30:49] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[17:40:57] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[18:02:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:05:16] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:09:37] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:10:21] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:14:16] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[18:36:38] *** Quits: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Input/output error)
[18:36:43] *** Joins: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[18:37:17] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:37:17] <ghrust> 01[13rust01] 15alexcrichton fast-forwarded 06snap-stage3 from 1412404aa to 14320af9b: 02http://git.io/CY0QuQ
[18:37:17] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:39:50] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:39:50] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PCL9fw
[18:39:50] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:39:54] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[18:39:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0hNLbw
[18:39:54] <ghrust> 13rust/06auto 14eafbcfb 15Alex Crichton: Change the format! statics to be all-caps...
[18:39:54] <ghrust> 13rust/06auto 14c8cdabc 15bors: auto merge of #9633 : alexcrichton/rust/issue-9631, r=huonw...
[18:39:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[18:57:29] *** Joins: tikue_ (tikue_star@ABF748F2.CD72397.689607DE.IP)
[18:58:25] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[19:22:20] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[19:23:45] * acrichto is happy that fmt! => format! wasn't a performance regression
[19:25:46] <Seldaek> it's all done at compile time no?
[19:26:27] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:26:27] *** ChanServ sets mode: +o tjc
[19:32:44] <Seldaek> brson: any clue why the rust-lang.org example uses "noms" as var name instead of "names"? kinda confusing to have nums/noms vars I think
[19:35:50] <tikue_> Seldaek, probably because of the cuteness factor
[19:36:52] <Seldaek> is it really cute? :p
[19:37:37] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[19:37:39] <tikue_> idk...nom nom nom?
[19:38:06] <tikue_> I personally don't find the example particularly compelling
[19:38:28] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:38:28] *** ChanServ sets mode: +o pnkfelix
[19:39:51] <Seldaek> tikue_: ah nom nom.. well nom = name in french, so I didn't see it that way, but it's weird anyway 
[19:40:07] <Seldaek> sure is hard to find a short enough example that is meaningful though
[19:41:43] <tikue_> Seldaek, I know, I speak some french ;)
[19:41:48] <tikue_> Seldaek, agreed
[19:41:54] <tikue_> Seldaek, I like go's appraoch...
[19:43:54] <benh> How do you tell whether a test should go into, say, src/test/run-pass/ rather than a #[test] function within the module of the most immediately tested code?
[19:46:45] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:52:12] <Eridius> benh: test/run-pass is typically for compiler-level stuff
[19:56:26] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:56:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/0hNLbw
[19:56:26] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:01:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[20:01:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/yKPOzQ
[20:01:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[20:01:30] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[20:01:30] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/SeKFaQ
[20:01:30] <ghrust> 13rust/06auto 14c9d4ad0 15Daniel Micay: remove the `float` type...
[20:01:30] <ghrust> 13rust/06auto 1408b510c 15bors: auto merge of #9519 : thestinger/rust/float, r=catamorphism...
[20:01:31] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[20:06:17] <nmatsakis> benh: in general, unit tests for libraries should prefer a #[test] function, files in src/test/* are to test the compiler itself (whereas library tests kind of assume the compiler works :)
[20:06:25] <nmatsakis> benh: (just to expound upon what Eridius said)
[20:06:31] <nmatsakis> *expand
[20:12:22] <Eridius> oh boy, lots of conflicts with acrichto's fmt patch
[20:12:30] <Eridius> 'dis gonn' be fun
[20:13:06] <benh> Eridius: Are you working on raw string literals?
[20:13:33] <Eridius> benh: I will be shortly, after I rebase my path rewrite and push it
[20:13:41] <Eridius> raw string literals are on the docket for today, so to speak
[20:14:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[20:14:20] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[20:14:25] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:32] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:37] <benh> How enthusiastic are you about it? I was interested in taking a shot at it since it seemed like a fairly localized change, but I don't want to steal your pet project :)
[20:14:38] *** Joins: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:38] *** Quits: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[20:15:06] <Eridius> sorry on the phone
[20:16:32] <cmr> benh: do you *want* a project? :)
[20:16:50] <benh> I'm easily intimidated!
[20:17:05] <benh> Lexing is relatively easy, there's not any other compilation state to be aware of ;)
[20:17:54] <cmr> A really nice project would be to remove the extra, unused, environment parameter that all functions have, and rather emit a stub when it's used as a closure.
[20:22:27] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[20:24:33] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[20:24:33] *** ChanServ sets mode: +o tjc
[20:25:20] <acrichto> Eridius: I think I invalidated like half the queue with that patch :(
[20:25:45] <strcat> I'll get the rest by removing floats and redoing Option
[20:25:48] <strcat> ;p
[20:25:50] <Eridius> acrichto: :'(
[20:25:52] <Eridius> ok I'm back
[20:26:22] <Eridius> benh: if you're really itching to take it, I suppose I won't stand in your way, but raw string literals is a bit of a pet project for me now :)
[20:26:43] <strcat> brson: so how exactly do we catch exceptions? is it just rust_try? or are there other bits
[20:27:15] <strcat> need to debug one of my branches breaking whatever catches them (get uncaught C++ exception error)
[20:31:38] <brson> Seldaek: better examples for the front page are always welcome. I tend to just take whatever somebody's willing to write
[20:32:15] <brson> strcat: rust_try
[20:32:24] *** flaper87|afk is now known as flaper87
[20:38:47] <Eridius> acrichto: I feel like Path should have some way of being formatted that prints the display str version (i.e. the version that replaces non-utf8 with U+FFFD). What formatting token would be appropriate for that?
[20:38:52] <Eridius> certainly not {}
[20:40:15] <Eridius> hrm, the "Argument Types" section of std::fmt claims that {} behaves like {:?}. That's not right
[20:40:50] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[20:41:27] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[20:41:41] <Eridius> well, maybe {} is ok. I dunno. I'm just worried about someone using {} to convert to ~str and then treating that as a valid path, e.g. format!("--path-flag={}", path), which would be absolutely wrong
[20:42:31] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:42:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:44:57] <Eridius> I wish I could use {:s} :/
[20:46:30] <acrichto> Eridius: why not fmt::Default?
[20:46:39] <acrichto> do you intend on having others implementing fmt::Default for Path otherwise?
[20:46:43] <vadimcn> Does anybody know, why is it that, at least on Windows, stage3 compiler cannot compile programs using std crate that it itself uses?
[20:46:50] <acrichto> I would consider this an excellent candidate of using fmt::Default
[20:46:53] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:46:55] <Eridius> acrichto: because people will absolutely use format!("--path={}", path) to generate process args or environments
[20:46:59] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[20:47:01] <Eridius> which would be wrong
[20:47:08] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:47:15] <vadimcn> I thought that by that point it's supposed to have converged
[20:47:23] <acrichto> Eridius: how else would they do it?
[20:47:39] <Eridius> acrichto: right now it's path.as_str().unwrap(), with a // FIXME saying this needs to take vectors
[20:48:04] <Eridius> the idea being that they want the string representation of the path, not the display string representation
[20:49:01] <Eridius> hrm, what if I have a method .display() on Path that returns a Display struct that implements fmt::Default? That makes it more obvious
[20:49:15] <acrichto> that seems like a good idea
[20:49:20] <Eridius> then I could also have .display_filename() for the case where you just want to print the filename (which I believe is only used once, but is a legitimate case)
[20:49:32] <acrichto> if we're going through all the trouble of making "correct paths" we should make it very hard to use them incorrectly
[20:49:43] <Eridius> acrichto: that's my thought too, which is precisely why I don't implement ToStr
[20:49:44] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[20:50:10] <Eridius> and why I sprinkled .as_str().unwrap() (and sometimes with .to_owned()) everywhere, because that's obviously ugly and needs to be fixed by the client code
[20:50:11] <acrichto> Eridius: I think I like the idea of .display_str() or something similar
[20:50:27] <acrichto> yeah it's a really common thing to do, so it shouldn't be hard
[20:50:31] <Eridius> well .display_str() sounds like it returns &str, which I can't do, and I don't want to return ~str if I don't have to
[20:50:32] <acrichto> but it should be known that it's "wrong"
[20:50:56] <acrichto> why does display_str have to return &str?
[20:51:04] <Eridius> acrichto: because it has the _str suffix?
[20:51:16] <acrichto> to_str() returns ~str ?
[20:51:20] <Eridius> just reads to me like something that returns a str of some sort
[20:51:36] <acrichto> I read return-pointer-style from the front of the method more-often
[20:51:47] <acrichto> with = closure, as = borrowed, to = owned, etc.
[20:51:49] <vadimcn> um, anyone?
[20:52:09] <Eridius> vadimcn: sorry I don't know windows
[20:52:24] <Eridius> acrichto: sure, but .display_str() sounds like it returns something str-ish. Probably &str because there's no to_
[20:52:46] <Eridius> maybe .display_fmt() because it's a formatter of sorts?
[20:52:49] <acrichto> to_display_str seems kinda long...
[20:52:50] <Eridius> although I dunno
[20:53:02] <Eridius> acrichto: nobody should use .to_display_str(). It's only there in case someone really needs an allocated display str
[20:53:21] <Eridius> .with_display_str() is what I used everywhere, but that bloats all the debugs that need to print paths
[20:53:22] <acrichto> maybe display() returning a newtype wrapper around &'a self
[20:53:33] <acrichto> and it implements fmt::Default
[20:53:37] <Eridius> acrichto: yes that's what I was thinking
[20:55:08] <acrichto> Eridius: also this is a really serious undertaking trying to do "paths correctly" and there's a very large amount of code behind it, it would be a shame for devs to use this the wrong way, so it's probably in order to write a very large doc-block in path/mod.rs explaining the rationales behind the module, why it exists, why it's not &str, how to use it safely, etc.
[20:55:28] <Eridius> acrichto: that sounds like a good idea
[20:57:15] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[20:58:20] <Eridius> rusti: use std::str::Str; struct Foo<S:Str>(S); Foo{"bar"}
[20:58:20] -rusti- <anon>:7:53: 7:54 error: expected one of `; }` but found `{`
[20:58:20] -rusti- <anon>:7          use std::str::Str; struct Foo<S:Str>(S); Foo{"bar"}
[20:58:20] -rusti-                                                               ^
[20:58:20] -rusti- application terminated with error code 101
[20:58:28] <Eridius> rusti: use std::str::Str; struct Foo<S:Str>(S); Foo("bar")
[20:58:29] -rusti- <anon>:7:28: 7:49 error: trait bounds are not allowed in structure definitions
[20:58:29] -rusti- <anon>:7          use std::str::Str; struct Foo<S:Str>(S); Foo("bar")
[20:58:29] -rusti-                                      ^~~~~~~~~~~~~~~~~~~~~
[20:58:29] -rusti- error: aborting due to previous error
[20:58:30] -rusti- application terminated with error code 101
[20:58:51] <Eridius> darn
[20:59:03] <Eridius> right, bounds have to be on the impl. ok
[21:03:44] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[21:05:03] <Eridius> benh: looks like kimundi is going to steal the raw string impl!
[21:06:56] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[21:08:09] <benh> oh no!
[21:08:35] <benh> kimundi: I have, like, half a patch here :)
[21:10:45] <acrichto> it's like christmas, new snapshots are here!
[21:10:53] <tjc> better than Christmas
[21:11:26] <benh> Does the new snapshot have continue? :)
[21:11:44] <tjc> benh: yes
[21:11:59] * acrichto revs the engines for discarding 'loop;'
[21:12:20] <acrichto> oh wow, there is *no* stage0 code to remove
[21:12:30] <tjc> acrichto: are you going to automate that? distinguishing between loop-as-in-continue and loop {  } seems tricky
[21:12:53] <acrichto> tjc: nah, just gonna stop accepting 'loop' in the lexer and then go from there
[21:13:16] <tjc> ah ok
[21:13:24] <cmr> A simple sed would be `s/loop;/continue;/`
[21:13:35] <tjc> yeah, but loop-as-in-continue might be used as an expression too
[21:13:39] <acrichto> you could have just 'loop'
[21:14:04] <cmr> right, not saying it'd get everything
[21:14:24] <tjc> but it would be a start, yeah
[21:14:38] * acrichto deletes 20 lines of parsing code
[21:15:01] <bstrie> acrichto: re: raw string discussion, if the syntax is to have an arbitrary number of hash marks like `r###hello###`, then how do you encode "##hello" in a raw string?
[21:15:24] <acrichto> bstrie: I thought the syntax was r###" foo text "###;
[21:15:32] <acrichto> as in the first quote is required
[21:15:36] <bstrie> ah ok
[21:15:38] <bstrie> that works then
[21:15:41] <bstrie> I like that
[21:15:42] <benh> It's not arbitrary, it's matching, too
[21:15:47] <acrichto> it could also just be r"##hello"
[21:15:49] <benh> oh, i misread
[21:15:54] <bstrie> acrichto: I actually like this proposal
[21:15:59] <acrichto> yeah it's growing on me
[21:16:10] <bstrie> r"sdf" doesn't look bad at all in python
[21:16:21] <acrichto> I feel like we're not too much out of our element because every language pretty much has their own syntax for raw strings
[21:16:22] <bstrie> +1 for the zero-or-more matching-hash-marks proposal
[21:16:41] <acrichto> r"This is a more sane \{format string\}"
[21:16:46] * acrichto is excite
[21:16:56] <bstrie> it really might be the best raw string syntax I've seen in terms of striking a balance between flexibility and standardization
[21:17:15] <acrichto> hopefully time agrees with you
[21:17:46] <Eridius> it's growing on me, though I still think ### is awfully heavy-looking. But we'll see
[21:18:04] <bstrie> acrichto: python doubles up braces to escape them, ie "{{format string}}". maybe consider that as well?
[21:18:19] <acrichto> brson: sadly we can't do that because of nested formats and methods
[21:18:27] <acrichto> {0, select, other{}} is a valid format strings
[21:18:34] <acrichto> what do you do with the ending double brace?
[21:18:34] <bstrie> Eridius: I think it's fine if raw strings are heavy-looking, and *most* of the time you'll probably be able to get away with just r"foo"
[21:18:46] <Eridius> bstrie: yeah I hope so
[21:18:53] <bstrie> Eridius: and then even when you can't, 99.99% of the time you'll be able to get away with r#"foo"#
[21:19:05] <Eridius> yeah
[21:19:08] <bstrie> beyond that you're venturing into academic territory :P
[21:19:21] <acrichto> who has "# in their strings anyway
[21:19:25] <acrichto> if you do go home :P
[21:19:26] <bstrie> yeah, the more I think about it the more I like it
[21:19:50] <benh> I don't like heavy looking raw format strings, alas
[21:19:51] <bstrie> acrichto: people trying to write code examples on how to write raw rust strings :P
[21:20:07] <acrichto> lol
[21:20:23] <benh> I'm thinking I should have implemented vim syntax highlighting for raw strings before trying to write test cases for raw strings :)
[21:20:48] <bstrie> I like how it's easy to match with a regex
[21:20:52] <acrichto> cmr: pub mod check_loop => pub mod check_continue
[21:20:55] <acrichto> I'm good at regex
[21:21:06] <bstrie> "[#]* should always be the closing delimeter, and r[#]*" should always be the opening
[21:21:25] <bstrie> it won't catch syntax errors, but it'll look nice otherwise
[21:22:01] <bstrie> and if an editor gives you trouble trying to put a regex in the delimeter, just define it up to five # and call it a day
[21:22:08] *** Joins: cpeterso_ (cpeterson@moz-BE33DA21.fw1.sfo1.mozilla.net)
[21:23:53] <bstrie> acrichto: ok, so you're saying that our format strings are more powerful than python's? nifty :)
[21:24:14] <bstrie> between the r"raw string syntax" and the new format! macro I am really liking our string story
[21:24:23] <bstrie> will make for some nice quines :)
[21:24:30] <bstrie> +1 to acrichto 
[21:25:22] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:25:27] <acrichto> rusti: format!("{0, plural, =0{zero} =1{singular} other{plural}}", 1);
[21:25:28] -rusti- ()
[21:25:30] <acrichto> rusti: format!("{0, plural, =0{zero} =1{singular} other{plural}}", 1)
[21:25:31] -rusti- ~"singular"
[21:25:35] <acrichto> bstrie: ^
[21:25:51] <bstrie> crazy
[21:26:05] <acrichto> "select" is also a method which switches over strings
[21:26:13] <bstrie> acrichto: I keep hearing that format! generates better code than fmt!, so what does it do differently?
[21:26:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:27:05] <acrichto> bstrie: it's far less callsite bloat
[21:27:20] <acrichto> fmt! == { let s = ~""; s.push_str(...); s.push_str(...); s }
[21:27:41] <acrichto> format! == { fmt::format(statically_compiled_format_string, [arg1, arg2, ...])
[21:28:02] <acrichto> no drop glue, no allocations, no blowup the longer your format string is 
[21:29:32] *** Quits: cpeterso_ (cpeterson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[21:31:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:31:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SeKFaQ
[21:31:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:33:31] *** flaper87 is now known as flaper87|afk
[21:36:29] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[21:36:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GU864Q
[21:36:29] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[21:36:31] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:36:31] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/N0L-yA
[21:36:31] <ghrust> 13rust/06auto 14964da1c 15Steve Klabnik: Document std::ops....
[21:36:31] <ghrust> 13rust/06auto 149f8df78 15Steve Klabnik: Update std::ops docs as per feedback...
[21:36:31] <ghrust> 13rust/06auto 143c2dbc8 15bors: auto merge of #9522 : steveklabnik/rust/doc_std_opts, r=brson...
[21:36:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:52:41] <strcat> no more float!
[21:53:29] <cmr> \o/
[21:56:40] <acrichto> now we all have to sink :(
[21:57:46] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[22:05:00] <tjc> I made that joke in the meeting already, acrichto , get with the times ;-)
[22:06:02] <acrichto> aww man
[22:06:24] <acrichto> I was totally paying attention apparently
[22:06:27] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[22:06:27] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143c2dbc8 to 1408b510c: 02http://git.io/N3iJvQ
[22:06:27] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[22:06:28] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:06:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/WhmM5g
[22:06:28] <ghrust> 13rust/06auto 1476d92c5 15Patrick Walton: librustc: Inline cross-crate tuple struct constructors
[22:06:28] <ghrust> 13rust/06auto 14fe4e747 15bors: auto merge of #9560 : pcwalton/rust/xc-tuple-structs, r=pcwalton...
[22:06:29] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:21:32] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[22:27:55] *** flaper87|afk is now known as flaper87
[22:28:18] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[22:32:06] <tikue_> why is getting rid of float exciting? at best neutral?
[22:32:55] <tjc> tikue_: at least in the way that removing anything from the language is exciting :-)
[22:33:53] <tikue_> :P
[22:34:11] <tikue_> i liked float bc you didn't have to put ugly numbers at the end:\
[22:35:30] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[22:39:15] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[22:39:15] *** ChanServ sets mode: +o tjc
[22:40:53] <engla> tikue_: you still don't have to, it should default to f64
[22:41:12] <acrichto> Eridius: why'd you have to copy all the stat stuff into the new path stuff?
[22:45:43] <Eridius> acrichto: because I didn't want to deal with figuring out who uses it, and what an appropriate replacement is, at this point
[22:45:46] <Eridius> that can be ripped out later
[22:46:26] <tikue_> engla, oh! cool :D
[22:46:46] <engla> range(1., 10.) should be a f64-range still
[22:46:57] <acrichto> Eridius: ok, I commented on how this should be using rt::io::file instead probably
[22:48:03] <Eridius> acrichto: and I just responded. I think path shouldn't have stat at all
[22:48:25] <Eridius> most of the path usage is in std::os already, so that should just have the relevant stat methods, and should delegate to rt::io::file if appropriate
[22:48:37] <Eridius> but again, I think that's better done in a separate PR
[22:48:38] <acrichto> I'm also ok with that, I think that so long as they implement PathLike something in io::file will add the appropriate methods
[22:54:04] <brson> is somebody looking at implementing nested comments?
[22:55:34] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[22:55:45] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[22:58:14] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[23:04:12] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[23:08:47] <acrichto> I may have just found the source of the 500MB regression in memory usage
[23:08:53] <acrichto> damned lint passes
[23:09:52] <sfackler> brson: std::rt uses a lot of public newtypes wrapping private runtime data structures, but the contents of the newtypes can't be hidden from users and it looks like that is intentional (https://github.com/mozilla/rust/issues/5489). would it be appropriate to start moving things like TcpStream to single-element structs?
[23:10:00] <acrichto> cmr: you can generate a memory benchmark quickly, right?
[23:10:03] <dbaupp> acrichto: \o/
[23:10:16] <cmr> acrichto: more or less quickly
[23:10:19] <cmr> ~8-10 minutes
[23:10:26] <cmr> (if I need to build a new commit)
[23:10:42] <acrichto> cmr: can you try commenting out lines 301/302 in rustc/driver/driver.rs?
[23:10:46] <acrichto> the ones that run the lint pass
[23:11:12] <acrichto> I think that linting is generating an @ cycle holding on to the tcx forever
[23:11:16] <cmr> acrichto: Why?
[23:11:18] <cmr> Ah
[23:11:24] <cmr> Sure
[23:11:33] <acrichto> an actual fix is going to be difficult
[23:11:56] <brson> sfackler: yes
[23:12:03] <brson> sfackler: can you open an issue on that?
[23:13:21] <sfackler> will do
[23:15:44] *** kimundi is now known as zz_kimundi
[23:16:29] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:16:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/WhmM5g
[23:16:29] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:18:20] <sfackler> brson: https://github.com/mozilla/rust/issues/9667
[23:21:29] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:21:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/RfNgKg
[23:21:29] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:21:32] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:21:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/56VFvQ
[23:21:32] <ghrust> 13rust/06auto 14e65e10b 15Alex Crichton: Move the rt::io::process tests to run-pass...
[23:21:32] <ghrust> 13rust/06auto 14df246e3 15bors: auto merge of #9578 : alexcrichton/rust/un-ignore-libuv-process-tests, r=brson...
[23:21:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:31:01] <acrichto> engla: what were those flags to just update the date of the commit again?
[23:31:55] *** flaper87 is now known as flaper87|afk
[23:32:10] <aatch> acrichto, there's two dates, commit date and author date.
[23:32:30] <strcat> acrichto: commit date gets updated on amend
[23:32:33] <strcat> easy ;p
[23:32:38] <acrichto> oh hm, I suppose I want the one that github orders by
[23:32:45] <acrichto> which I suppose is author date at that point
[23:32:50] <aatch> Author date uses an enviroment variable.
[23:33:01] <aatch> GIT_COMMITER_DATE
[23:33:37] <brson> strcat: did you look at using lld?
[23:33:53] <acrichto> brson: cmr also mentioned he was gonna try to take a stab soon
[23:34:08] <cmr> brson: I didn't get to it today, had a paper to write
[23:34:33] <strcat> brson: not yet
[23:34:42] <strcat> I don't think it's *quite* ready yet
[23:34:52] <strcat> it has dynamic linking but it doesn't work 100%
[23:35:57] <benh> So, I have a commit that lexes raw string literals, has a handful of tests and vim syntax highlighting, but does not make the pretty printer aware of the difference between regular string literals and raw string literals.
[23:36:12] <benh> Is it okay to make a pull request for just that, and file an issue when it gets merged?
[23:36:39] <acrichto> benh: I don't think we want the pretty printer to regress *too* much...
[23:37:13] <brson> cmr: ok, I think using lld on windows is critical since it lets us do binary installs without a fill mingw installation. want to try to get it done for 0.9
[23:37:38] <vadimcn> brson: re https://github.com/mozilla/rust/pull/9662, what do you want to do about it?
[23:38:15] <benh> I think it's fairly straightforward to make it work, there's not a lot of places in the tree that ast node types get specifically referenced, but I was afraid of subtly breakin eg. the syntax extension facilities, etc
[23:38:20] <brson> vadimcn: typing up a response now. i think i want to do it, but we're going to need to bundle some licenses and stuff
[23:39:30] <benh> And I wasn't sure whether it's better to give raw string literals a new node type or whether to add an enum field with CookedStr, RawStr(this many hashes)
[23:42:27] <brson> vadimcn: so, after we start bundling the mingw dlls in the snapshot, we then upgrade the bots. we also want to bundle the mingw dlls with the installer, but it doesn't make sense to do that until we stop using gcc for linking. does all that sound right?
[23:44:11] <vadimcn> brson: bundling and upgrading mingw are independent.   If bots were upgraded, we wouldn't need to bundle runtime dlls actually - until they get out of sync again, of course (but that would be a long time).
[23:44:30] <brson> vadimcn: oh, it looks like this puts the dlls in the installer as well? it seems like this is not going to work right because of the gcc dep
[23:44:48] <strcat> and we have a dep on binutils for the linker gcc calls
[23:45:09] <vadimcn> brson: it would still need mingw of course for binutils
[23:45:15] <strcat> libclang could replace gcc as the linker driver, but lld would mean no binutils 
[23:45:26] <vadimcn> but at least it would work with any version of mingw
[23:45:33] <strcat> + consistent linker everywhere would be really, really nice
[23:46:02] <vadimcn> (as long as ld still understands object file format)
[23:46:33] <brson> vadimcn: so using our own dlls in the installer doesn't interfere with the user's gcc?
[23:47:14] <strcat> we'd need gcc to not be in PATH
[23:47:21] <strcat> (whatever windows calls PATH ;p)
[23:47:35] <vadimcn> Windows first searches for a dll that's next to the binary: http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx
[23:48:06] <vadimcn> so for rustc it will load dlls sitting next to it, and for gcc it will load dlls sitting next to gcc
[23:55:03] <benh> should we allow extern r##"Rust"## fn()? mod blah = r##"blah"##?
[23:56:32] <acrichto> benh: if it's no extra code, then why not, if it's extra code, then probably not
[23:59:16] <brson> vadimcn: https://github.com/mozilla/rust/pull/9662#issuecomment-25502824
[23:59:43] <brson> vadimcn: do you know what version of MinGW we are using currently?
