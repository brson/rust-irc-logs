[00:03:12] <eddyb> dbaupp: feel free to review that commit
[00:05:26] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[00:05:46] <dbaupp> eddyb: what's the contents of SelfUniq(...)?
[00:06:06] <eddyb> dbaupp: mut ~self
[00:06:09] <eddyb> same for SelfValue
[00:06:23] <dbaupp> ok
[00:07:38] <eddyb> I'm thinking I can add self as a regular parameter, and keep ExplicitSelf around for type-checking purposes (after slicing it as much as possible)
[00:08:22] <dbaupp> then remove the env arg from bare functions and we have UFCS \o/
[00:09:22] <eddyb> dbaupp: did I mention I'm considering allowing let f = Option::is_some; f(None);?
[00:09:27] <dbaupp> (also, eagerly borrowing/dereferencing Self doesn't work, because methods can be implemented on, say, &~~@Foo, via traits.)
[00:09:34] <dbaupp> eddyb: that's UFCS ;)
[00:09:38] <dbaupp> but yay
[00:09:57] <eddyb> I think UFCS involves defining non-impl functions that can be called as methods
[00:10:08] <eddyb> but yes, I'm removing special treatment
[00:10:21] <dbaupp> well, there's two possible meanings of UFCS
[00:10:22] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:10:35] <dbaupp> call nonmethods as methods; and call methods as nonmethods
[00:10:48] <eddyb> the latter is definitely doable
[00:10:50] <dbaupp> (and then both at once: just unify methods and nonmethods.)
[00:10:58] <eddyb> also Rust ABI is dead
[00:11:11] <dbaupp> ?
[00:11:48] <eddyb> (I dread implementing the closure wrappers, a little)
[00:12:11] <eddyb> dbaupp: the env ptr is pretty much the only reason Rust ABI exists
[00:13:07] <eddyb> extern "C" fn will be kind of a noop
[00:13:35] <dbaupp> is the C ABI fastcc?
[00:14:43] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[00:14:43] *** ChanServ sets mode: +qo brson brson
[00:16:27] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[00:16:27] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JJeFLA
[00:16:27] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[00:16:40] <eddyb> dbaupp: oh, no, you think it would make sense to default Rust ABI to fastcc?
[00:16:48] <eddyb> (just because we can)
[00:16:54] <dbaupp> eddyb: well, iirc, that's what it is now
[00:17:26] <eddyb> oh, so I won't kill it, but it will be just a LLVM function attribute
[00:18:24] <eddyb> dbaupp: btw, that was in reflect, how does type_of make sense there?
[00:19:06] <eddyb> I would fix TyVisitor, but do I really want to duplicate a lot of code with #[cfg(stage0)]? meh
[00:19:27] <dbaupp> hm?
[00:19:40] <dbaupp> isn't type_of there just another way to get access to the TypeContents?
[00:20:18] <eddyb> dbaupp: evec/estr are still the names of methods in TyVisitor
[00:20:56] <eddyb> pretty sure self.c_mt creates an argument for a TyVisitor, which means changing the std code as well
[00:21:21] <strcat> dbaupp: it's not fastcc
[00:21:26] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:21:26] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/W7rmNQ
[00:21:26] <ghrust> 13rust/06auto 145ea6d02 15SiegeLord: Tighten up float literal lexing....
[00:21:26] <ghrust> 13rust/06auto 1454a85d4 15bors: auto merge of #11480 : SiegeLord/rust/float_base, r=cmr...
[00:21:26] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:21:40] <dbaupp> strcat: oh, that changed?
[00:21:43] <strcat> we use cc but we don't follow C calling conventions
[00:21:46] <strcat> dbaupp: a long, long time ago
[00:21:49] <strcat> before I used rust
[00:21:56] <eddyb> strcat: that's what I thought, LLVM optimizes some of them to fastcc
[00:22:06] <dbaupp> before my time too then.
[00:22:07] <strcat> LLVM optimizes internal functions to fastcc if it sees where they are called
[00:22:17] <dbaupp> that must've been what I was remembering
[00:22:33] <dbaupp> eddyb: ok, yeah, I see what you mean
[00:22:52] <eddyb> dbaupp: okay, so I can call self.c_tydesc(typ), but it requires changing libstd code which I dread
[00:23:36] <dbaupp> eddyb: yeah, don't worry about it
[00:23:38] <eddyb> and make sure I don't break non-type-safe code
[00:23:56] <dbaupp> eddyb: maybe just leave a comment there
[00:27:28] <eddyb> dbaupp: how about now?
[00:28:05] <dbaupp> seems fine
[00:32:17] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[00:42:01] <eddyb> dbaupp: r?
[00:42:28] <eddyb> (I thought you were still reading through, but then I realized I didn't actually ask you for r+ yet)
[00:48:19] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[00:56:32] <eddyb> dbaupp: nothing? should I ask cmr, too?
[00:57:20] <cmr> I can't do a review right now
[00:57:40] <eddyb> don't worry, I'm just trying to get a reaction :)
[01:00:47] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[01:09:50] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[01:11:14] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:19:36] <eddyb> cmr: I think dbaupp finished reviewing, but he's not around, I guess. and I want to go to sleep...
[01:19:50] <Eridius> any objections to adding rustpkg to the list of automatically-rustdoc'd crates?
[01:20:34] <jdm> can anybody else remember seeing a rust issue about "ReaderRng.fill_bytes could not fill buffer"?
[01:20:48] <jdm> I can't find it, but I swear I read an issue or gist or someone where that failure came into play
[01:21:18] <jdm> comes from calling HashMap::new
[01:23:26] *** Quits: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net) (Quit: tikue)
[01:23:26] <larsberg> example ReaderRng backtrace: https://gist.github.com/larsbergstrom/8379071
[01:25:45] <dbaupp> eddyb: sorry I was afk
[01:26:29] <eddyb> dbaupp: if you're not now, it's good :D
[01:27:13] *** kimundi is now known as zz_kimundi
[01:27:20] <dbaupp> jack, larsberg: that failure is pretty weird. can /dev/urandom sometimes not fill the requested buffer size?
[01:27:50] <eddyb> /dev/urandom is defined to always give you bytes AFAIK
[01:28:42] <dbaupp> well, the ReaderRng failure suggest it's not giving all the bytes.
[01:28:44] <eddyb> though I remember something at 30c3 about there being 0 randomness for some time during boot, and some weird rules going on then
[01:30:28] <Eridius> is ReaderRng using /dev/urandom and not /dev/random?
[01:30:41] <dbaupp> yes, /dev/urandom
[01:30:52] <dbaupp> having HashMap::new() possibly blocking would be bad
[01:30:59] <Eridius> dbaupp: I agree
[01:31:04] <Eridius> and yeah, I checked, definitely urandom
[01:31:16] <Eridius> well, on unix. I don't know how the Windows Rng behaves
[01:31:29] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[01:31:47] <dbaupp> Windows doesn't go via ReaderRng
[01:32:17] <eddyb> dbaupp: I believe that the comment about @mut was erroneous, unless @mut was buggy that way
[01:32:32] <dbaupp> eddyb: you could read from a @mut even when it was borrowed
[01:32:41] <dbaupp> but, I guess that only worked for Pod types
[01:32:44] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[01:32:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/W7rmNQ
[01:32:44] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[01:32:47] <dbaupp> so it probably was wrong.
[01:37:08] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:37:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/rMiYFw
[01:37:08] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:37:11] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[01:37:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JI0__A
[01:37:11] <ghrust> 13rust/06auto 1450cf55f 15Kevin Ballard: Add /doc/rustuv to .gitignore
[01:37:11] <ghrust> 13rust/06auto 14c3c94ad 15bors: auto merge of #11483 : kballard/rust/gitignore-doc-rustuv, r=alexcrichton
[01:37:12] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[01:37:51] <Eridius> sure would be nice if there was a way to tell bors that a commit cannot possibly need testing
[01:39:45] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[01:40:22] <dbaupp> Eridius: to help it empty its completely full approved queue? ;P
[01:40:36] <Eridius> dbaupp: well, I want to submit another PR but it adds a line to .gitignore so I need to wait for my current one to clear
[01:40:45] <dbaupp> Eridius: https://github.com/graydon/bors
[01:40:53] <dbaupp> rebase on top of your current one?
[01:41:05] <dbaupp> (i.e. submit it rebased like that.)
[01:42:04] <Eridius> dbaupp: I've never been sure what happens if I submit one PR that's rebased on top of another
[01:42:21] <Eridius> I assume it will merge cleanly ,but I don't know if things get tracked properly, and I'm not a fan of causing duplicate commits to show up in the git history
[01:42:34] <dbaupp> there won't be duplicate commits
[01:42:51] <dbaupp> at least, I don't think there will be
[01:42:55] <Eridius> why not? It should only avoid duplicating a commit if the PR gets rebased, but I thought it got merged?
[01:43:15] <Eridius> the merge would recognize that the new PR is adding the same lines that were already added in a different commit, and thus skip them, but merge won't rewrite the branch
[01:43:57] <dbaupp> pcwalton does this a lot, and I don't think that results in duplicated commits
[01:44:03] <dbaupp> but I'm not 100% suer.
[01:47:29] <Eridius> dbaupp: I just realized why it won't duplicate commits. Because bors strictly does merges. The rebase of my PR doesn't introduce a duplicate because the end result is my PR is based off of the same SHA that ends up in master
[01:47:48] <dbaupp> ah, right
[01:49:28] <Eridius> ok on that note, PR to build librustpkg docs: https://github.com/mozilla/rust/pull/11488
[01:54:52] *** Quits: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net) (Quit: tikue)
[01:58:43] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[02:00:25] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[02:00:37] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Client exited)
[02:00:47] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[02:00:56] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Client exited)
[02:01:04] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[02:10:45] *** Joins: swgillespie (swgillespi@1E7C44EB.5A3FFF96.EC6A1518.IP)
[02:24:06] <larsberg> what does it mean for the runtime to be hung in a call to SimpleTask::deschedule? https://gist.github.com/larsbergstrom/8379120
[02:24:18] <dbaupp> acrichto: ^
[02:24:49] <acrichto> larsberg: that just means a green task hasn't exited most likely
[02:25:44] <larsberg> acrichto: so it might be in a queue somewhere and wouldn't show up as a pthread? because the other 8 threads seem to be runtime-created and just waiting on handles
[02:25:59] <acrichto> larsberg: yeah it could be blocked on a port or I/O and it wouldn't show up
[02:26:06] <acrichto> (this is where native tasks are easier to debug sometimes)
[02:28:13] <larsberg> acrichto: all that this program does is launch a subprocess and wait on its exit: https://github.com/metajack/servo/blob/rustup-20131219-jsfun/src/test/harness/contenttest/contenttest.rs
[02:28:32] <larsberg> so it's likely that it's servo that's hung and we have no stack because the main thread in this test runner is blocked waiting on the exit?
[02:29:16] <acrichto> larsberg: that would be my guess, but it's a big system so there could be other bugs
[02:29:26] <acrichto> the simple task is just used to wait for teh sched pool
[02:31:44] <larsberg> acrichto: I think you're right. when the process is frozen, there are one or more servo child processes running - nice call!
[02:32:02] <acrichto> glad I could help a little :)
[02:34:45] <larsberg> definitely! now I've got a backtrace for the freeze..
[02:34:53] <larsberg> (in servo, that is)
[02:50:46] <dbaupp> do any of the try bots run on 32-bit linux?
[02:51:18] <dbaupp> hm, seems not
[02:51:28] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[02:51:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JI0__A
[02:51:28] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[02:54:54] <acrichto> dbaupp: they should?
[02:54:57] <acrichto> oh wait try
[02:54:59] <acrichto> no nvmd
[02:55:02] * acrichto -> food
[02:56:27] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:56:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/VNE1uQ
[02:56:27] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:59:27] <dbaupp> r? https://github.com/mozilla/rust/pull/11489 (is that an inappropriate use of bors?)
[02:59:52] <cmr> might as well
[03:01:26] <dbaupp> thanks
[03:12:42] <Eridius> oh great. a30d61b05a completely wrecked the formatting of http://static.rust-lang.org/doc/master/index.html and nobody noticed
[03:12:45] <Eridius> all the line breaks are gone
[03:13:47] <dbaupp> whoops
[03:13:51] * Eridius is fixing it
[03:14:20] <dbaupp> (that 'whoops' wasn't implying it was my fault...)
[03:14:32] <Eridius> heh no, I know
[03:16:08] <Eridius> ok, https://github.com/mozilla/rust/pull/11488 is updated
[03:16:27] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:16:27] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/icSiig
[03:16:27] <ghrust> 13rust/06auto 14b8f69d3 15Huon Wilson: test: un-xfail some tests....
[03:16:27] <ghrust> 13rust/06auto 14d14f004 15bors: auto merge of #11489 : huonw/rust/maybe-7340, r=cmr...
[03:16:27] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:16:28] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[03:16:29] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d9ddc76 to 14c3c94ad: 02http://git.io/N3iJvQ
[03:16:29] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[03:16:53] <dbaupp> Eridius: that's a rather annoying and subtle bug...
[03:18:19] <Eridius> trailing whitespace as syntax is rather unfortunate
[03:18:36] <dbaupp> yup
[03:18:37] <SiegeLord> Couldn't you just add a second newline?
[03:18:46] <Eridius> but it's just one of multiple reasons that I never automatically trim trailing whitespace
[03:18:47] <dbaupp> SiegeLord: make is a new paragraph
[03:18:50] <Eridius> SiegeLord: that produces a <p> instead of a <Br>
[03:18:52] <Eridius> s/Br/br
[03:18:59] *** Quits: zz_kimundi (kimundi@moz-805FAAC7.dip0.t-ipconnect.de) (Ping timeout)
[03:19:17] <dbaupp> Eridius: maybe they should be proper lists with some CSS to format them appropriately?
[03:19:25] <dbaupp> (since, semantically, they are lists.)
[03:19:55] <Eridius> dbaupp: that's certainly possible, although if you want to talk semantics, the library list being broken up into un-titled sub-groups would require a bunch of tiny sublists that have no real semantic meaning
[03:21:38] <dbaupp> they do have some meaning (standard libraries, scheduling libraries, compiler libraries), but yeah, that'd be a little silly
[03:21:54] <dbaupp> hm, maybe rustpkg shouldn't be grouped with rustuv?
[03:22:33] <dbaupp> since rustuv is basically designed for libgreen only, but rustpkg is actually meant to be useable elsewhere.
[03:22:47] *** Joins: zz_kimundi (kimundi@moz-6726BDB1.dip0.t-ipconnect.de)
[03:22:49] *** zz_kimundi is now known as kimundi
[03:23:28] <Eridius> dbaupp: perhaps. I was thinking of it as "standard, scheduling, misc, compiler"
[03:23:38] <dbaupp> bleh, "misc" :(
[03:23:57] <Eridius> I could lump libuv with the scheduling libraries, but that might be odd, especially since as you point out it's primarily just meant for libgreen
[03:24:15] <Eridius> this made more sense when it wasn't broken up into subgroups ;)
[03:24:38] <dbaupp> heh
[03:51:55] *** Quits: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca) (Quit: canhtak)
[03:56:47] *** Joins: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca)
[04:04:51] *** Quits: swgillespie (swgillespi@1E7C44EB.5A3FFF96.EC6A1518.IP) (Quit: Textual IRC Client: www.textualapp.com)
[04:06:22] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:06:23] *** ChanServ sets mode: +ao dherman dherman
[04:08:11] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:19:14] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[04:30:56] <Eridius> uh oh. mixing rlibs and regular libs is causing a problem
[04:31:15] <Eridius> specifically, when I added a regular lib as an extern mod to something that already linked against 2 rlibs, it complained that it couldn't find the dynamic library for the first rlib
[04:32:00] <dbaupp> by design
[04:32:34] <dbaupp> hard to avoid having multiple copies of libraries if you have combined static and dynamic linking. (libstd is especially problematic, aiui.)
[04:33:42] <Eridius> if it's by design then it's a design flaw
[04:33:48] <Eridius> these libraries don't overlap
[04:34:01] <Eridius> two are my own libraries, and then I tried to pull in rust-toml which doesn't specify a crate type
[04:34:13] <dbaupp> no
[04:34:15] <Eridius> actually it does, but it specifies it as "lib"
[04:34:23] <Eridius> but my two libraries are both "rlib"
[04:34:25] <dbaupp> the dynamic library will depend on libstd dynamically
[04:34:38] <dbaupp> the static libraries will have it linked in statically.
[04:34:43] <dbaupp> makes things confused
[04:34:45] <Eridius> really? the rlibs statically pull in libstds?
[04:34:48] <Eridius> *libstd
[04:35:01] <dbaupp> yes, that's what static linking is
[04:35:12] <Eridius> if rust is smart enough to allow two rlibs that both use libstd, but not get two copies of libstd, why can't it remove both copies and dynamically link against it?
[04:35:26] <Eridius> either way, the error message is not helpful
[04:35:45] <dbaupp> rlibs don't have libstd actually inside them they're just require that it is statically linked when building an executable
[04:35:56] <dbaupp> s/they're/, they
[04:35:57] <Eridius> why does it care if it's statically or dynamically linked, as long as it's present?
[04:36:05] <dbaupp> don't know the details
[04:36:06] <dbaupp> ask acrichto
[04:36:26] <dbaupp> (I believe he does wish to solve this problem to allow a combination; it's just not supported yet.)
[04:37:35] <Eridius> on another note, rustc.1 is out of date :/
[04:37:56] <dbaupp> is it ever up-to-date? :P
[04:38:02] <Eridius> it documents --lib instead of --rlib/--staticlib/--dylib. And I don't know if there's anything else wrong
[04:38:05] <Eridius> heh
[04:40:09] *** Quits: blank_na1e (blank_name@7D3AA8DE.3C877FC9.53C6B850.IP) (Quit: leaving)
[04:41:46] *** Joins: blank_name (blank_name@7D3AA8DE.3C877FC9.53C6B850.IP)
[04:54:47] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[05:07:36] <dbaupp> how does one get access to the tydesc field of the vtable of a trait object?
[05:11:22] *** Quits: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net) (Ping timeout)
[05:11:50] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[05:15:57] <Luqman> dbaupp: vtable is the first word afaik
[05:16:12] <dbaupp> Luqman: yeah, I ended up checking trans and just transmuting
[05:16:13] <Luqman> and the first element in the vtable is the type descriptor
[05:16:30] <dbaupp> to (**TyDesc, *c_void)
[05:16:46] <dbaupp> (it's a pointer to the TyDesc, right?)
[05:17:24] <Luqman> i believe so
[05:18:04] <dbaupp> awesome
[05:18:06] <dbaupp> thanks
[05:18:56] <dbaupp> let's see how quickly this will crash...
[05:26:30] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:26:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d14f004 to 14c3c94ad: 02http://git.io/N3iJvQ
[05:26:31] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:27:00] <strcat> dbaupp: it goes [tydesc, method, method, method]
[05:27:20] <strcat> which sucks, since the tydesc isn't necessary ;p
[05:27:33] <dbaupp> strcat: it is for my use case here :P
[05:27:45] <strcat> which is what?
[05:27:47] <strcat> gc?
[05:27:51] <dbaupp> yeah
[05:27:57] <dbaupp> finding the lenght of allocations in TLS
[05:28:07] <dbaupp> so not strictly necessary
[05:28:10] <strcat> well you can interpret that as 'the tydesc is there for gc, and it shouldn't be if you're not using libstd'
[05:28:38] <dbaupp> (TLS could actually store the size itself, but the tydesc is already there, so using that for now is lowest impact)
[05:32:12] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[05:42:09] *** Quits: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net) (Quit: tikue)
[05:59:13] <dbaupp> perf says that we're spending 5% or more of our compilation time in llvm::sys::MemoryFence. (with or without -O)
[05:59:53] <dbaupp> and another 5% in pthread_rwlock_{unlock,rdlock}
[06:01:22] <strcat> what are we using rwlocks for? we don't actually do anything in parallel afaik...
[06:04:14] <dbaupp> no idea
[06:04:27] <dbaupp> we're using LLVM in threadsafe mode, right?
[06:04:44] <strcat> I guess it's that
[06:04:57] <strcat> rwlocks are significantly more expensive to obtain than mutexes
[06:05:19] <dbaupp> do we actually need threadsafe LLVM anymore?
[06:05:26] <strcat> probably not
[06:07:02] <dbaupp> https://github.com/mozilla/rust/blob/master/src/librustc/middle/trans/base.rs#L3362-L3378
[06:34:07] <dbaupp> acrichto: ping
[06:34:14] <acrichto> dbaupp: pong
[06:34:37] <dbaupp> acrichto: ^ last few messages about synchronisation
[06:34:52] <acrichto> we do need threadsafe llvm
[06:35:02] <dbaupp> I thought that was for rusti?
[06:35:03] <acrichto> rustc is built as a library, we do not know how it is being used
[06:35:09] <acrichto> rustdoc is currently using it in parllel
[06:35:13] <dbaupp> ah, of course
[06:35:46] <acrichto> contention was still pretty high up there last time I checked, but that was all in the JIT so object generation might not be that bad (haven't checked)
[06:36:06] <dbaupp> 10% for MemoryFence + pthread_rwlock_...
[06:36:28] <acrichto> in one compile?
[06:36:32] <dbaupp> yeah
[06:36:37] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[06:36:37] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JrH3QA
[06:36:37] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[06:36:46] <acrichto> do you have a backtrace to see what's calling it?
[06:36:48] <dbaupp> perf record rustc ....
[06:36:51] <dbaupp> sec
[06:37:04] <acrichto> if it's that bad then we could put trans in a giant lock
[06:37:18] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[06:37:33] <dbaupp> llvm::PassRegistry::getPassRegistry, llvm::PassRegistry::getPassInfo and llvm::PMTopLevelManager::findAnalysisPass account for ~90% of the MemoryFence calls
[06:38:02] <acrichto> that sounds familiar
[06:38:22] <acrichto> that used to be a mutex, I changed it to an rwlock to get a like 40x improvement
[06:38:26] <dbaupp> similar things call the rwlock ones
[06:38:29] <acrichto> that must be seriously slamme
[06:39:00] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[06:39:48] <dbaupp> acrichto: surely rustdoc doesn't run trans at all?
[06:39:51] <Eridius> holy crap, a file with no trailing newline can cause rustc to hang forever when emitting an error
[06:40:01] <acrichto> dbaupp: rustdoc --test
[06:40:29] <dbaupp> Eridius: oh, is that what causes that... I've seen it intermittantly but never been able to reproduce reliably
[06:40:32] <dbaupp> acrichto: oh, dur.
[06:40:39] <Eridius> dbaupp: yeah I was thoroughly confused, becuase merely opening and re-saving in vim fixed the error
[06:40:43] <Eridius> but then I realized what the heck vim was doing
[06:41:28] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:41:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wVucqg
[06:41:28] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:42:35] <Eridius> dbaupp: filed as https://github.com/mozilla/rust/issues/11493
[06:43:30] *** Quits: Kxepal (Miranda@moz-33D0A42F.pppoe.mtu-net.ru) (Quit: Kxepal)
[06:43:45] *** Joins: Kxepal (Miranda@moz-33D0A42F.pppoe.mtu-net.ru)
[06:45:11] <dbaupp> Eridius: weird
[06:49:01] <strcat> acrichto: why does a rwlock speed it up? are we actually calling it from multiple threads?
[06:49:15] <strcat> a rwlock is a lot more expensive with no contention
[06:50:07] <strcat> usually viewed as bad since a mutex scope should be tiny, and rwlocks are always going to be slower if it's not doing a lot of work
[06:51:51] <acrichto> strcat: you're splitting hairs, when I profiled it in the past the mutex was like 90% of the profile, making it an rwlock made it like 10% of the profiles
[06:52:08] <strcat> which doesn't make any sense if it's single threaded
[06:52:37] <acrichto> different use cases, this was when I was running rusti test
[06:53:14] <strcat> well that makes sense then, is LLVM really reliant on global state?
[06:53:37] <strcat> (i.e. you can't have multiple independent contexts in one process)
[06:54:19] <acrichto> I would recommend reading LLVM to figure that out (I'm unsure myself)
[06:54:36] <acrichto> the LLVMContext isolates most of LLVM, but not some things (which are apparently slammed ofteN?)
[06:54:40] <strcat> ah
[06:54:42] <strcat> that's sad :(
[06:55:00] <acrichto> like this is pretty unreasonable that an uncontested rwlock is 5% of the profile
[06:55:09] <acrichto> we really should upstream a patch if we can figure out what's going on
[06:55:37] <acrichto> it's probably as simple as moving some thing in a loop to not being in a loop
[06:57:05] <strcat> acrichto: http://ix.io/9P2 if you're curious
[06:57:19] <strcat> well I screwed up the first one
[06:57:46] <acrichto> what am I looking at?
[06:58:08] <strcat> acrichto: a loop running a somewhat naive is_prime and obtaining a lock each time
[06:58:22] <strcat> acrichto: cycles is the most relevant measurement
[06:58:26] <strcat> it's just perf output
[06:58:31] * strcat likes it more than `time`
[06:58:40] <acrichto> sounds like tbb is fast
[06:58:47] <strcat> I think it's more than pthreads are slow ;p
[06:58:55] <acrichto> how many platforms does tbb work on?
[06:59:00] <strcat> it's GPL, can't use it
[06:59:07] <acrichto> oh well
[06:59:15] <strcat> I think it's really trivial to make them on linux though
[06:59:18] <strcat> via futex
[06:59:30] <strcat> and futex is how you get fair scheduling afaik
[06:59:38] <strcat> I don't think you have to do anything about that yourself
[06:59:51] <strcat> you just try cmpxchg a few (many?) times, give up and use FUTEX_WAIT
[07:00:18] <strcat> acrichto: drepper has a pdf with sample implementations ;p, afaik intel's is probably trivial + lock elision annotations
[07:00:21] <strcat> cause... lock elision is cool
[07:00:22] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:00:37] <acrichto> patches welcome
[07:01:00] <strcat> (single mutex on a hash table? lock elision makes it only contend if the writes/reads actually conflict - limited by cache size and so on ofc)
[07:01:28] <strcat> pretty bad example since hash tables can be trivially split
[07:02:12] <strcat> acrichto: could have the option of using gmp/tbb instead of $FOO
[07:02:27] <strcat> but... GPL for a lib if pretty bad
[07:02:28] <strcat> they want you to buy it
[07:02:35] <strcat> gmp is LGPL so that's sane ;p
[07:02:38] <acrichto> cross compilation would be kinda hard
[07:02:42] <acrichto> we'd need a whole new target
[07:03:21] <strcat> acrichto: well I'm not really serious about using tbb anyway
[07:03:28] <strcat> it just shows you what you can do if you ignore POSIX ;p
[07:03:46] <strcat> glibc has a switch on like 8 mutex types inside each call
[07:03:52] <acrichto> oh I'm sure you can do lots if you optimize for one cpu on one system
[07:04:11] <strcat> windows critical sections are already well optimized afaik
[07:04:27] <strcat> POSIX just does too much
[07:04:40] <strcat> acrichto: glibc does use lock elision too ;p
[07:04:55] <strcat> acrichto: it's backwards compatible (the lock elision instructions are nops on older processors - that's how they do this kind of thing)
[07:05:27] <strcat> but... glibc can only use lock elision for the mutexes with undefined behaviour on locking it when you own it
[07:05:45] <strcat> so it doesn't work if we want to have RAII wrappers around locks for say, MutexArc
[07:06:09] <strcat> which may not be a good idea anyway
[07:06:35] <strcat> I don't really understand why they don't export saner GNU exts
[07:06:43] <strcat> I guess a requirement for a GNU ext is that it be insane
[07:07:39] <strcat> acrichto: oh and glibc is dumb and uses the wrong API for lock elision \o/
[07:07:46] <strcat> they use hardware transactional memory for some reason
[07:07:49] <strcat> afaik that's slower
[07:08:17] <strcat> excuse to use the GNU IFUNC dynamic function loading based on arch
[07:08:49] <dbaupp> they might as well show off
[07:08:53] * strcat laughs when he sees dwarf information including unwind tables manually added to inline asm
[07:09:07] <strcat> that... must not have been fun to write
[07:09:13] <dbaupp> wait.. really?
[07:09:16] <dbaupp> that's awesome
[07:09:22] <strcat> yeah lemme get a link
[07:09:25] * strcat looks for a glibc mirror
[07:09:41] <strcat> every time I look in glibc I find them
[07:09:53] <strcat> someone smarter than me knows why they are there
[07:09:55] <strcat> I hope
[07:10:17] <dbaupp> showing off
[07:10:25] <dbaupp> "I can write DWARF info by hand"
[07:10:28] <dbaupp> :P
[07:12:06] <strcat> afaik if they used actual lock elision instead of RTM, it would be drop-in to the other ones too... maybe I'm wrong
[07:12:41] <strcat> ah no, nvm, because it *requires* deadlocking
[07:13:07] <strcat> probably some reason you can't use it for the POSIX recursive mutex but it certainly works for the recursive mutexes I looked at elsewhere...
[07:14:27] <strcat> acrichto: anyway, perf stat <3
[07:15:04] <strcat> on my old computer it didn't have as much info so I used callgrind
[07:16:29] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:16:29] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14919f53e to 143e8a4a0: 02http://git.io/N3iJvQ
[07:16:29] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:21:20] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:27:54] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[08:01:28] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[08:12:25] *** Quits: gwty (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP) (Ping timeout)
[08:12:31] *** Quits: gwty_ (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP) (Ping timeout)
[08:20:19] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[08:20:54] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[08:34:04] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[08:36:32] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:36:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/EZyAig
[08:36:32] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:38:20] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[08:40:01] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[09:06:02] *** Quits: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca) (Quit: canhtak)
[09:06:42] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[09:10:23] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[09:11:37] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[09:20:10] *** Joins: rca (rcatolino@moz-E246AD29.adsl.proxad.net)
[09:29:55] <eddyb> acrichto: I thought the documentation changes were simple enough >:(
[09:30:36] <acrichto> eddyb: I agree, but just because it looks simple doesn't mean it is when I have no understanding of any ofit
[09:30:53] <acrichto> concurrent code looks simple, turns out none of it is
[09:31:22] <eddyb> I removed parts of it which explicitly referred to @mut and dynamic freezing
[09:33:25] <eddyb> acrichto: pcwalton did the @mut removing, maybe you can ask him if he shows up before nmatsakis?
[09:33:53] <acrichto> sure
[09:34:08] <eddyb> (sorry for being impatient, but... oh, wait, I forgot how easy git rebase --onto is. derp, I'll stack my branches)
[09:34:39] <bjz> acrichto: btw, the num stuff is going well in my external repo. I'm thinking we could reduce things down to: Num, Integer, SignedInteger and Float. And not export them in the prelude.
[09:35:43] <acrichto> bjz: sounds awesome!
[09:35:52] <bjz> acrichto: https://github.com/bjz/num-rs/blob/master/src/lib.rs
[09:35:55] <acrichto> bjz: what's the reason for {Num, Integer, SignedInteger} 
[09:36:30] <bjz> acrichto: it would be useful for basic stuff
[09:37:03] <acrichto> what's the main signed/unsigned distinction?
[09:37:51] <bjz> Hmm, actually
[09:37:58] <bjz> I guess you might not heed it
[09:38:01] <bjz> *need
[09:38:24] <acrichto> oh I dunno, just curious
[09:38:39] <acrichto> with impls on types we may not need them at all
[09:39:26] <bjz> acrichto: the issue is that I might want to impl my own abs method
[09:39:32] <bjz> I dunno
[09:39:36] <bjz> hmm
[09:39:55] <acrichto> oh I wouldn't try too hard
[09:39:58] <bjz> as in, you want some sort of generality, even in the std
[09:40:02] <acrichto> removal from the prelude is probably the best part
[09:40:19] <bjz> 'I' as in, generic person
[09:40:45] <acrichto> yeah
[09:40:49] <bjz> like, if they were directly impled on the types, you couldn't get rid of them
[09:41:14] <bjz> and they would never be accessable generically
[09:41:27] <acrichto> true
[09:41:30] <bjz> my current work: https://github.com/bjz/num-rs/blob/master/src/lib.rs
[09:43:00] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[09:43:52] <bjz> I guess the idea is if you want a really simple thing, joe blow can just grab the Num trait from std - for more complex stuff you could go to extra::num
[09:44:53] <bjz> ie. keep the std traits pretty naive, then have better defined elsewhere
[09:45:06] <bjz> better traits I mean
[09:45:32] <acrichto> sounds good to me
[09:45:47] <bjz> but trying to compromise will make them both deficient
[09:49:02] *** Joins: gwty (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP)
[09:49:20] *** Joins: gwty_ (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP)
[10:03:48] *** Quits: rca (rcatolino@moz-E246AD29.adsl.proxad.net) (Ping timeout)
[10:04:19] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:15:00] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[10:16:46] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[10:21:51] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[10:28:12] *** flaper87|afk is now known as flaper87
[10:30:11] *** Quits: gwty (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP) (Ping timeout)
[10:30:13] *** Quits: gwty_ (gwtypc@17C8B8C7.AD96D6D0.137C914F.IP) (Ping timeout)
[10:56:29] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:56:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/W6YW1A
[10:56:29] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:56:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:56:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1dYzsA
[10:56:31] <ghrust> 13rust/06auto 14871ffd1 15kud1ing: more backticks
[10:56:31] <ghrust> 13rust/06auto 141fda761 15bors: auto merge of #11495 : kud1ing/rust/backticks, r=huonw
[10:56:31] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[11:19:26] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[11:34:45] *** Quits: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net) (Quit: tikue)
[11:45:41] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[11:53:00] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:57:22] <eddyb> strcat: so trans_method just calls trans_fn now... and I'm pretty sure I'll soon get rid of trans_method_call requiring a method_map entry
[11:58:44] <eddyb> and ExprMethodCall will probably be simpler if the receiver was just the first argument
[11:59:30] * eddyb is going overboard again
[12:06:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:06:31] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/1dYzsA
[12:06:31] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:19:41] <eddyb> hah, what, @ref patterns - this must predate @T -> &T coercion
[12:32:02] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[12:35:27] <dbaupp> r? https://github.com/mozilla/rust/pull/11497 :(
[12:50:15] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[12:54:02] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[12:54:03] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[13:02:07] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[13:13:22] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[13:19:31] <kimundi> eddyb: Seems like you're making great progress in implementing features people talked about for years :D
[13:19:59] <eddyb> kimundi: don't give me a medal for that
[13:21:04] * dbaupp gives eddyb a medal for that
[13:21:50] * kimundi will like to be able to do ".iter().map(Clone::clone)"
[13:22:34] <eddyb> kimundi: that will require only relaxing some rules
[13:22:48] <dbaupp> do it!
[13:23:03] * dbaupp will give eddyb *two* medals for that
[13:23:17] <kimundi> And "use Clone::clone; iter().map(clone)" ?
[13:23:31] <eddyb> I won't change semantics *yet*, I don't want to block this huge thing on a single visible feature :P
[13:23:57] <kimundi> eddyb: Sure, first the backend, then the language change bikeshed :P
[13:24:07] <eddyb> it could be subject for discussion at this week's meeting if you want
[13:25:47] <kimundi> That's your decision - I'll be happy if it works eventually
[13:26:42] *** kimundi is now known as zz_kimundi
[13:29:53] <eddyb> I mean it, the sooner it's discussed, the sooner I can get an implementation through
[13:31:25] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[13:33:39] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[13:33:47] *** zz_kimundi is now known as kimundi
[13:34:02] <eddyb> I don't understand typeck vtables, which makes it harder to decide what can be removed
[13:34:56] <dbaupp> binary search on knowledge: remove things at random until you're not breaking everything
[13:35:55] <eddyb> dbaupp: commenting out structure fields :P
[14:21:10] <eddyb> dbaupp: if this bootstraps, I'd be amazed
[14:21:29] *** Joins: canhtak (canhtak@moz-DB18D73D.wl.t.ulaval.ca)
[14:21:31] * eddyb really doesn't like vtables
[14:23:13] <eddyb> especially since they seem to be used when resolving regular method calls (that have some genericity in them)
[14:27:54] <dbaupp> eddyb: I'm guess it's not gonna bootstrap?
[14:29:15] <eddyb> dbaupp: most things should work, but off the top of my head... I think I need to add self to [ast::Arg] for it to work properly
[14:29:32] <dbaupp> Today on HN: "Bootstrap or Die - ..."
[14:33:08] <eddyb> "error: internal compiler error: No type for local variable 314u32"
[14:33:17] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[14:33:21] <eddyb> (what I mentioned earlier)
[14:33:48] <dbaupp> Oh, no bootstrapping? looks like you're gonna have to die.
[14:34:25] <dbaupp> eddyb: [ast::Arg] is just referring to the vector of other arguments, right?
[14:38:02] <eddyb> dbaupp: yeah
[14:39:37] <eddyb> dbaupp: so Self cannot be used in impls now?
[14:40:02] <eddyb> thing is... why not? makes a lot of logic simpler
[14:42:23] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:42:24] *** ChanServ sets mode: +ao dherman dherman
[14:42:56] <dbaupp> eddyb: s/now//
[14:43:18] <dbaupp> anyway
[14:43:20] * dbaupp -> bed
[14:43:30] <eddyb> don't let the rust bugs bite :P
[15:24:07] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:27:22] <jack> any idea what this build error means? https://gist.github.com/metajack/8386003
[15:27:30] <jack> i'm getting this on the servo build slaves
[15:41:39] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:43:24] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[15:46:03] *** Joins: gwty (gwtypc@2388A349.5D0460CB.D66E6624.IP)
[15:46:09] *** Joins: gwty_ (gwtypc@2388A349.5D0460CB.D66E6624.IP)
[15:47:02] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[15:47:25] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[15:49:03] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[15:52:57] *** Joins: reedlepee (Mibbit@moz-90DF2C84.nwrknj.fios.verizon.net)
[15:53:24] *** Quits: Kxepal (Miranda@moz-33D0A42F.pppoe.mtu-net.ru) (Ping timeout)
[15:55:24] *** Joins: Kxepal (Miranda@moz-D1EB3C25.pppoe.mtu-net.ru)
[16:27:59] *** Quits: reedlepee (Mibbit@moz-90DF2C84.nwrknj.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[16:31:37] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[16:32:19] <jack> acrichto: or this one: ar: fatal error in /usr/bin/ranlib
[16:32:55] <jack> error: ar s x86_64-apple-darwin/stage1/lib/rustc/x86_64-apple-darwin/lib/librustc-8b28e8d8-0.9.rlib failed with: exit code: 1
[16:39:15] *** Quits: Kxepal (Miranda@moz-D1EB3C25.pppoe.mtu-net.ru) (Quit: Kxepal)
[16:39:36] *** Joins: Kxepal (Miranda@moz-D1EB3C25.pppoe.mtu-net.ru)
[17:09:15] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:30:04] <eddyb> bleah, arguments and their pattern have two different IDs
[17:30:14] <eddyb> s/arguments/each argument
[17:41:08] <eddyb> okay, self_id semantically corresponds to the pattern's ID, not the Arg's ID
[17:52:05] <eddyb> what *is* a rib?
[17:59:48] *** Joins: rca (rcatolino@moz-E246AD29.adsl.proxad.net)
[18:05:44] <eddyb> method.self_id => method.decl.inputs[0].pat.id
[18:39:46] *** Joins: rca_ (rcatolino@moz-5C941ACC.adsl.proxad.net)
[18:40:25] *** Quits: rca (rcatolino@moz-E246AD29.adsl.proxad.net) (Ping timeout)
[19:06:49] *** Quits: gwty (gwtypc@2388A349.5D0460CB.D66E6624.IP) (Ping timeout)
[19:06:58] *** Quits: gwty_ (gwtypc@2388A349.5D0460CB.D66E6624.IP) (Ping timeout)
[19:08:45] *** Joins: gwty (gwtypc@2388A349.5D0460CB.D66E6624.IP)
[19:08:52] *** Joins: gwty_ (gwtypc@2388A349.5D0460CB.D66E6624.IP)
[19:16:31] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[19:16:33] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:16:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/W7OfMA
[19:16:33] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:19:27] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[19:19:46] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:25:52] <eddyb> I don't like the unshifts... but I doubt they'll be significant
[19:30:33] <eddyb> do we want to allow "self" as a regular name outside methods?
[19:31:07] <eddyb> because it's easier if I remove ExprSelf than go through the trouble to make resolve work with it
[19:36:30] *** Quits: gwty_ (gwtypc@2388A349.5D0460CB.D66E6624.IP) (Ping timeout)
[19:36:40] *** Quits: gwty (gwtypc@2388A349.5D0460CB.D66E6624.IP) (Ping timeout)
[20:03:26] <eddyb> error: aborting due to 5805 previous errors
[20:03:29] <eddyb> BWAHAHAHAHA
[20:03:43] <eddyb> error: `self` is not allowed in this context
[20:03:51] <eddyb> (all of them, I presume)
[20:07:00] *** Quits: blank_name (blank_name@7D3AA8DE.3C877FC9.53C6B850.IP) (Ping timeout)
[20:18:53] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[20:18:53] *** ChanServ sets mode: +ao dherman dherman
[20:22:23] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:26:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[20:26:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/35frpw
[20:26:35] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[20:31:52] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:31:52] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02https://github.com/mozilla/rust/compare/f42440bd7384...f42440bd7384
[20:31:52] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:31:55] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:31:55] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/UbHnZA
[20:31:55] <ghrust> 13rust/06auto 14e64b49d 15Jan Niklas Hasse: Don't overwrite the options.output value from build_session_options
[20:31:55] <ghrust> 13rust/06auto 140091a15 15bors: auto merge of #11502 : jhasse/rust/crate_type, r=alexcrichton...
[20:31:55] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:49:22] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[20:54:52] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[21:22:28] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[21:46:39] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:46:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/UbHnZA
[21:46:39] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:58:21] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:58:22] *** ChanServ sets mode: +qo brson brson
[22:02:56] *** nrc is now known as nrc|afk
[22:11:58] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[22:20:42] <cmr> mrmonday: destructors are guaranteed.
[22:21:07] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[22:21:15] <cmr> they wouldn't be very useful if they weren't!
[22:21:25] <mrmonday> cmr: oh, k, thanks!
[22:22:23] <mrmonday> dunno what I was thinking of :<
[22:22:37] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:31:29] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[22:32:12] <strcat> mrmonday: finalizers in managed languages?
[22:32:31] <strcat> in python, if you make a cycle including types with finalizers, it leaks
[22:32:48] <strcat> and a gc doesn't guarantee that the values will ever be destroyed
[22:36:40] *** Quits: rca_ (rcatolino@moz-5C941ACC.adsl.proxad.net) (Ping timeout)
[22:37:21] <mrmonday> strcat: perhaps
[22:37:31] <mrmonday> I think I'm thinking of class destructors in D
[22:37:48] <mrmonday> if the object is never collected by the GC then the destructor is never called
[22:38:06] <mrmonday> not true for structs though which are RAII
[22:51:19] <strcat> mrmonday: you're free to destroy a type in a Gc<T> early
[22:51:24] <strcat> swap it out
[22:52:28] *** nrc|afk is now known as nrc
[23:00:12] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[23:00:16] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:00:16] *** ChanServ sets mode: +qo brson brson
[23:01:01] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[23:12:53] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[23:21:28] <brson> today i can't even run make check without ooming
[23:21:32] <brson> a single make check
[23:34:10] <larsberg> time to hop on service-now and order that new laptop :-)
[23:44:45] <brson> i am really considering ordering another computer. i feel really guilty about it since i've already got 9.
[23:46:00] <dbaupp> 10 is a nice round number
[23:51:21] *** Quits: dbaupp (Thunderbir@moz-BB237A70.lns20.syd6.internode.on.net) (Ping timeout)
[23:52:33] *** flaper87 is now known as flaper87|afk
[23:52:41] <jack> brson: at least i know feel much better at having ordered a second :)
[23:52:47] <jack> s/know/now/
[23:54:08] <bjz> r? https://github.com/mozilla/rust/pull/11504
[23:55:29] *** Joins: tikue (tkuehn@moz-879E86A9.hsd1.ca.comcast.net)
[23:56:23] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
