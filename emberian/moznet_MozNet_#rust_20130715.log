[00:04:09] *** Quits: santiago (santiago@moz-F2B734D2.c3-0.sbo-ubr1.sbo.ma.cable.rcn.com) (Ping timeout)
[00:05:12] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:07:33] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[00:07:34] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:09:18] *** Joins: santiago (santiago@moz-F2B734D2.c3-0.sbo-ubr1.sbo.ma.cable.rcn.com)
[00:11:39] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:13:24] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:13:45] *** Quits: reyre (reyre@moz-C6577D11.dsl.bell.ca) (Client exited)
[00:16:55] *** Quits: olleharstedt (Thunderbir@moz-80D8890F.ias.bredband.telia.com) (Ping timeout)
[00:17:05] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:17:38] <dbaupp> jensnockert: yay! "slightly"?
[00:17:53] <jensnockert> dbaupp: I don't have to shuffle manually anymore.
[00:18:04] <jensnockert> Datums autogenerate the right shuffles.
[00:18:15] <dbaupp> that's pretty cool.
[00:18:29] <jensnockert> Which means I don't have like twelve shuffle blocks around the compiler, only one or two.
[00:18:35] * dbaupp thinks Rust will be an amazing numerics language at this rate
[00:19:01] <dbaupp> deleting code is always fun.
[00:20:10] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[00:20:28] *** sam113101_afk is now known as sam113101
[00:22:09] <jensnockert> Then I just need to make a test-file with Vector lvalues and see where I get ICEs.
[00:22:48] *** Quits: krebbit (Mibbit@moz-C207C5B5.range86-145.btcentralplus.com) (Quit: http://www.mibbit.com ajax IRC Client)
[00:23:50] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[00:24:02] *** Joins: tjc (tjc@moz-87C014D8.tmodns.net)
[00:24:03] *** ChanServ sets mode: +o tjc
[00:24:37] <bjz_> jensnockert: yay
[00:25:04] <bjz_> jensnockert: how will I get it working with lmath?
[00:25:28] <mark_edward> is LLVM IR portable?
[00:25:41] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:25:45] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[00:25:45] <jensnockert> You should just be able to replace the Vecn structures with something like simd!(f32x3: f32 * n)
[00:25:48] <jensnockert> mark_edward: Nope
[00:25:53] <steven_is_false> mark_edward: No. Consider the sizeof construct.
[00:26:06] <mark_edward> what is the sizeof construct?
[00:26:16] <jensnockert> mark_edward: Calculates the size of a type.
[00:26:31] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:26:31] <jensnockert> mark_edward: A int on x86-64 is 64 bits, but 32 bits on ARM for example.
[00:26:31] <mark_edward> in terms of what?
[00:27:02] <jensnockert> mark_edward: There are portable subsets of LLVM IR though.
[00:27:05] <steven_is_false> Maybe somebody as a research project could make a compiler for a special language that emits portable LLVM IR but all compilers today don't.
[00:27:33] <jensnockert> Google's pnacl for example, uses 'portable' LLVM bitcode.
[00:27:45] *** Quits: tjc (tjc@moz-87C014D8.tmodns.net) (Quit: zzzzzzzzzz)
[00:27:57] <steven_is_false> jensnockert: Right. I forgot about PNaCl
[00:28:07] *** Joins: tjc (tjc@moz-87C014D8.tmodns.net)
[00:28:07] *** ChanServ sets mode: +o tjc
[00:28:43] <mark_edward> then what's the point of LLVM IR then
[00:29:00] <steven_is_false> mark_edward: It's for performing optimizations on?
[00:29:01] <mark_edward> i thought it was sort of like .NET bytecode or somehting
[00:29:12] <mark_edward> steven_is_false: what does gcc use?
[00:29:36] <steven_is_false> mark_edward: GCC uses an abstract syntax tree as far as I know.
[00:29:48] <strcat> steven_is_false: gcc has a bytecode too, GIMPLE
[00:29:50] <mark_edward> jensnockert: when did that simd! macro land. i recompiled rustc this morning and it's not working
[00:30:00] <jensnockert> mark_edward: Have not.
[00:30:04] <strcat> steven_is_false: http://gcc.gnu.org/onlinedocs/gccint/GIMPLE.html
[00:30:10] <jensnockert> mark_edward: It is just on my branch.
[00:30:15] <strcat> anyway LLVM IR is just the human representation of it
[00:30:17] <mark_edward> oh ok.
[00:30:17] <steven_is_false> strcat: Interesting.
[00:30:21] *** kimundi is now known as zz_kimundi
[00:30:23] <strcat> when you're actually compiling there's no actual IR text.
[00:31:55] <dbaupp> r
[00:32:07] <dbaupp> whoops, wrong window
[00:32:28] <steven_is_false> Also, LLVM IR is useful for debugging.
[00:32:50] <mark_edward> i wish it was portable
[00:33:15] <strcat> it can't be portable
[00:33:20] <strcat> portability is handled at a language level already
[00:33:26] <steven_is_false> mark_edward: Unfortunately, LLVM IR isn't very fast for JIT compiling.
[00:33:26] <bjz_> jensnockert: why aren't you using the T,..n syntax?
[00:33:28] <strcat> there are different function calls, etc.
[00:33:35] <strcat> steven_is_false: it's not an issue with IR
[00:33:40] <jensnockert> bjz_: Because I didn't feel like parsing it.
[00:33:42] <strcat> LLVM's JIT is totally fine for C/C++
[00:33:57] <jensnockert> bjz_: Also because I want someone to discuss it and decide on the best option.
[00:34:28] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[00:34:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/zMccfg
[00:34:28] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[00:34:34] <jensnockert> bjz_: I designed it to reasonably maxbad.
[00:34:35] <bjz_> jensnockert:  T,..n seems to be the syntax for arrays
[00:34:38] <steven_is_false> strcat: Right but it's still not as fast as an IR explicitly designed to be JITTED.
[00:34:58] <strcat> steven_is_false: it's really not the IR/bytecode at issue
[00:35:04] <mark_edward> do they put much effort into their JIT?
[00:35:10] <steven_is_false> strcat: Okay.
[00:35:14] *** Quits: tjc (tjc@moz-87C014D8.tmodns.net) (Ping timeout)
[00:35:15] <mark_edward> also, is there an actuall LLVM VM?
[00:35:16] <jensnockert> bjz_: Once the compiler part is fixed, changing libsyntax is just a few lines for the parser.
[00:35:17] <strcat> the bytecode is a *convenient* intermediate representation, it places no restrictions on the JIT compiler
[00:35:29] <strcat> mark_edward: if you view a JIT compiler as a "VM"
[00:35:30] <bjz_> jensnockert: simd!(f32x3 = [f32,..3])
[00:35:45] <bjz_> jensnockert: simd!(f32x3 = f32,..3)
[00:35:45] <strcat> but it's not sandboxed in any way, it spits out machine code directly
[00:36:03] <steven_is_false> strcat: You're right. It's jitting an ast not a bytecode.
[00:36:07] <jensnockert> bjz_: What I really want is `type f32x4 = simd!(f32, ..4)`
[00:36:15] <mark_edward> i  mean something more like the CLR or JVM
[00:36:17] <jensnockert> bjz_: But I cannot get that to actually work.
[00:36:23] <mark_edward> the LLVMVM
[00:36:30] <dbaupp> rusti: #[simd] struct f32x3(f32,f32,f32); let x = f32x3(1.0, 2.0, 3.0); x + x
[00:36:31] -rusti- {__field__: 2, __field__: 4, __field__: 6}
[00:36:33] <strcat> steven_is_false: well you do create bytecode for it to JIT compile, but that part really doesn't matter
[00:36:34] <bjz_> jensnockert: so can my Vec3<T> { x: T, y: T, z: T } be simded?
[00:36:48] <jensnockert> bjz_: Not yet, haven't looked into generics.
[00:36:49] <dbaupp> bjz_: it except for the generics, it currently can
[00:37:06] <jensnockert> Making T generic should be easy.
[00:37:14] <strcat> steven_is_false: LLVM's JIT can compile languages like C/C++ very well, and it could probably do Java/Scala well too
[00:37:17] <jensnockert> Making n genericâ€¦ wellâ€¦ not so much, for obvious reasons.
[00:37:23] <bjz_> jensnockert: does simd allow you to access it via the x, y, z fields?
[00:37:33] <jensnockert> bjz_: With my patch, yes.
[00:37:34] <bjz_> jensnockert: like, would I need a struct then?
[00:37:34] <strcat> it can't handle a dynamically typed language as well as a specialized JIT compiler because it isn't filled with hacks like they have to be
[00:37:43] <bjz_> jensnockert: maybe I wouldn't
[00:37:51] <jensnockert> bjz_: Preferably not.
[00:37:53] <strcat> it won't make an optimization it has to potentially back out of
[00:38:03] <strcat> based on guessing types, etc.
[00:38:09] <bjz_> jensnockert: maybe it would be easier if we actually have properties
[00:38:16] <jensnockert> bjz_: Properties?
[00:38:35] <jensnockert> `vector.z` should work.
[00:38:40] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[00:38:42] <bjz_> #[property] fn foo(&self, x) -> T
[00:38:43] <jensnockert> Or `vector.bgra`
[00:38:53] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[00:38:57] *** Joins: tjc (tjc@moz-9201A642.tmodns.net)
[00:38:58] *** ChanServ sets mode: +o tjc
[00:39:04] <jensnockert> bjz_: Sure, but that means you need an exponential amount of properties on a simd.
[00:39:09] * bjz_ wishes we had properties
[00:39:13] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[00:39:18] <bjz_> jensnockert: yeah :(
[00:39:30] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[00:39:31] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[00:39:44] <jensnockert> 16 elements, means roughly 17! properties.
[00:39:57] <bjz_> yup
[00:40:01] <jensnockert> Which I don't think we want to generate code for ;)
[00:40:04] <bjz_> icky
[00:40:25] <bjz_> would be easier if we had macros that actually worked in impls
[00:40:46] <bjz_> and expanded into multiple items
[00:40:57] <bjz_> and had concat_idents!
[00:41:07] <bjz_> that actually worked
[00:41:42] <bjz_> jensnockert: I have a YCbCr type, I would have to access it using the default x, y, z, right?
[00:42:02] *** Quits: tjc (tjc@moz-9201A642.tmodns.net) (Quit: Places to go, people to annoy)
[00:42:03] <jensnockert> bjz_: I only added xyzw, rgba and s0-f
[00:42:25] <steven_is_false> This is a hack but coud work: x.set::<(R, G, B, A)>(y.get::<(A, G, B, R>()).
[00:42:29] <bjz_> jensnockert: like, I have struct YCbCr<T> { y: T, cb: T, cr: T }
[00:42:41] <jensnockert> bjz_: Yeah, you would use x, y and z.
[00:42:58] <jensnockert> Or s0, s1 and s2
[00:43:10] <bjz_> jensnockert: I guess s0 - f would be okayish
[00:43:33] <jensnockert> There are so many uses, we cannot add all accessors in the compiler.
[00:43:55] <jensnockert> Hurray, assertion failed! Not a crash in LLVM \o/
[00:43:58] <bjz_> but that would be a case where you would want to add the ability to simd-ise arbritary types
[00:45:25] <jensnockert> bjz_: Yes, but the problem is that the number of accessors grow as a factorial.
[00:45:39] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[00:45:51] <bjz_> jensnockert: no, not in terms of adding arbritary properties
[00:46:31] <bjz_> jensnockert: in terms of just adding the ability to turn it into a simd type, the access them via s0-f
[00:46:47] <jensnockert> Oh, maybe, yes.
[00:47:02] <bjz_> would I be able to simd-ise Quat<T> { s: T, v: Vec3<T> } ?
[00:47:12] <bjz_> seeing as all the fields align?
[00:47:35] <bjz_> I would definitely need that
[00:47:39] <jensnockert> That's just a Tx4, essentially, so yes.
[00:47:58] <jensnockert> As long as T is a un, in or fn type.
[00:48:18] <bjz_> I could envisage some weird person wanting (T,(T,T)(T,))
[00:48:20] <bjz_> :P
[00:48:40] <bjz_> (no, I can't actually)
[00:48:59] <bjz_> (but edge cases, edge cases)
[00:50:40] <XgF> At least syntax for saying "type T is a 4 entry vector of floats, members y, u, v, a" would be cool
[00:50:59] <XgF> If the SIMD types are defined by macro at present (it looks that way), it sounds feasible
[00:52:12] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:52:35] <XgF> Side note: what would be required for inline assembly and naked function support?
[00:53:39] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[00:54:03] <strcat> there's inline assembly support already, don't know how mature it is
[00:54:56] <aatch> The inline assembly support is mostly fine, just difficult to use since it use the LLVM formatting
[00:54:58] <dbaupp> why does drop take &self rather than &mut self? (I know why doesn't take plain self)
[00:54:58] <XgF> Ooh. Hadn't seen it mentioned anywhere
[00:55:21] <strcat> dbaupp: because the plan is to make it take self so no one has bothered to update it
[00:55:30] <dbaupp> strcat: aha
[00:55:31] <sp3d> rusti: [println("hmm"), 2]
[00:55:32] -rusti- <anon>:7:26: 7:27 error: mismatched types: expected `()` but found `<VI0>` (expected () but found integral variable)
[00:55:32] -rusti- <anon>:7          [println("hmm"), 2]
[00:55:32] -rusti-                                    ^
[00:55:32] -rusti- error: aborting due to previous error
[00:55:32] -rusti- application terminated with error code 101
[00:55:40] * dbaupp transmutes some mutability
[00:55:43] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[00:55:59] <dbaupp> rusti: [println("hmm"), .. 2]
[00:55:59] <sp3d> rusti: [println("hmm"), ..2]
[00:55:59] <aatch> And LLVM formatting is intended to be very simple and able to be passed almost directly to the backend code generator
[00:56:00] -rusti- hmm
[00:56:00] -rusti- []
[00:56:00] -rusti- hmm
[00:56:00] -rusti- []
[00:56:09] <sp3d> heh
[00:56:26] <XgF> aatch: I'm familiar with it. It isn't massively worse than GCC's formatting :)
[00:56:39] <sp3d> just reading the ml, trying to decide if it would be reasonable for that to execute twice or not
[00:56:43] <XgF> I mostly ask becasue you say Rust is intended to be usable for OS development... I want to test that assertion :p
[00:57:02] <dbaupp> aatch: is this your latest syscall gist? https://gist.github.com/Aatch/5894562
[00:57:14] <sp3d> I could see it being a kind of awful idiom... it would be very concise ;)
[00:57:17] <aatch> XgF, it's not bad, but you have to be precise with your register constraints.
[00:57:20] <dbaupp> aatch: because the ra/rD constraints seem to be ignored... :(
[00:57:30] <aatch> dbaupp, they are, that's old.
[00:57:47] <aatch> dbaupp, the ra, rD constraints don't do what they look like they do.
[00:57:48] <dbaupp> aatch: could you update it? :)
[00:58:12] <dbaupp> aatch: yeah, I've resorted to manual `movq $0, %rax`
[00:58:22] <dbaupp> etc
[01:00:08] <jensnockert> XgF: It isn't really a macro, it is a syntax extension.
[01:00:20] <jensnockert> XgF: But it would be easy to add.
[01:01:05] <XgF> dbaupp: Unless LLVM id deviating from what I remember, "ra" is saying "Any register, and if that doesn't fit, EAX"...
[01:01:44] <XgF> jensnockert: I still don't quite grasp the difference between a hygenic macro and a syntax extension :)
[01:02:07] <jensnockert> XgF: A syntax extension is implemented in the compiler?
[01:02:17] <dbaupp> XgF: syntax extension = macro written in Rust
[01:02:52] <dbaupp> XgF: that seems... backwards
[01:03:22] <XgF> dbaupp: It steals GCC's constraints. they're all single character. It tries each from left to right
[01:03:35] <dbaupp> XgF: ah
[01:03:44] <dbaupp> XgF: in any case, "a"(..), doesn't work eitehr
[01:03:47] <XgF> So you can do things like "ir" - "Try for a constant integer, else register"
[01:03:47] <dbaupp> *either
[01:03:54] <XgF> dbaupp: Weird
[01:04:18] <jensnockert> XgF: I think we would be better off if we listed the constraints that work.
[01:04:21] <dbaupp> XgF: yeah, aatch has/had a wip improvement
[01:04:33] <dbaupp> XgF: to make it like clang/gcc
[01:10:55] <aatch> dbaupp, I updated the gist
[01:10:56] *** Quits: mark_edward_mobile (AndChat437@moz-A6154E1A.dynamic.utc.edu) (Ping timeout)
[01:11:52] *** Joins: mark_edward_mobile (AndChat437@moz-A6154E1A.dynamic.utc.edu)
[01:11:59] <aatch> LLVM doesn't understand specific register contraints, btw
[01:12:28] <aatch> so "ra" says "register or 'a'" but there is no register named 'a' on x86+64
[01:13:03] <aatch> its, 'ax', 'eax' or 'rax'
[01:14:23] <dbaupp> aatch: aha, cool
[01:14:31] * dbaupp understand why he was having so much trouble before
[01:14:39] <dbaupp> *understands
[01:14:50] <aatch> dbaupp, don't worry, I ended up reading the the LLVM source to figure most of this out.
[01:15:00] *** Quits: mark_edward_mobile (AndChat437@moz-A6154E1A.dynamic.utc.edu) (Ping timeout)
[01:15:21] <jensnockert> I think I managed to get this working \o/
[01:15:30] * jensnockert hopes.
[01:15:52] <aatch> clang uses the machine-level info it has in order to convert generic constraints to specific machine registers.
[01:16:00] <goffrie> rusti: let mut hh = ~std::hashmap::HashMap::new(); hh.insert(~"a", 1); let h = hh; loop { do task::try { println(fmt!("%?", h)); }; }
[01:16:02] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QFMH
[01:16:10] <aatch> (Which also means it can throw a decent error when things go wrong)
[01:16:16] <goffrie> rusti: let mut hh = ~std::hashmap::HashMap::new(); hh.insert(~"a", 1); let h = hh; loop { do std::task::try { println(fmt!("%?", h)); }; }
[01:16:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RSjj
[01:17:01] <goffrie> rusti: let mut hh = ~std::hashmap::HashMap::new(); hh.insert(~"a", 1); let h = hh; do std::task::try { println(fmt!("%?", h)); }; do std::task::try { println(fmt!("%?", h)); };
[01:17:01] *** Joins: mark_edward_mobile (AndChat437@moz-A6154E1A.dynamic.utc.edu)
[01:17:04] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/WMWJ
[01:17:19] <goffrie> ^ segfault, oops.
[01:17:22] <XgF> aatch: So how does it decide if "rax" is "r, then ax" or "rax"?
[01:17:36] <aatch> XgF, it doesn't. 'r' is 'any register'
[01:18:19] <XgF> aatch: So how does Clang handle "a" constraints/register asm("rax") variables?
[01:18:27] <goffrie> rusti: let h = ~[1,2,3]; do std::task::try { println!("%?", h); }; do std::task::try { println!("%?", h); }
[01:18:28] -rusti- ~[1, 2, 3]
[01:18:28] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[01:18:29] <dbaupp> XgF: you need `{rax}` for LLVM's asm parser
[01:18:41] <XgF> Ooh
[01:18:49] <Luqman> XgF: it figures out what `a` should mean for the given target
[01:18:51] <dbaupp> jensnockert: \o/
[01:19:06] <aatch> XgF, clang specifically parses the contraints itselfs and turns them into LLVM-compatible format
[01:19:21] <XgF> So "i{rax}" would be a valid multiple constraint list then :)
[01:19:39] <aatch> XgF, in LLVM (and currently Rust) yes.
[01:19:41] <dbaupp> rusti: unsafe { asm!("" :: "i{rax}"(1)) }
[01:19:42] -rusti- ()
[01:20:03] <aatch> And maybe in clang too, though I haven't tried.
[01:20:09] <aatch> (and can't remember)
[01:20:47] <goffrie> hm, I wonder if it would be useful to make loop{} an expression where you can set the "return value" using `break val`
[01:21:15] <strcat> and what if you don't break?
[01:21:20] <strcat> uninit read
[01:21:23] <goffrie> loop{} is an infinite loop, so it doesn't matter
[01:21:35] <strcat> goffrie: ah, good point :)
[01:21:44] * strcat 's mind is on a new for loop
[01:21:45] <goffrie> :) not sure if it's useful but it's sound somehow
[01:21:53] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[01:22:26] <dbaupp> goffrie: you can simulate it with `fn looper(any_args...) -> type { loop { .. return val .. } } let x = looper;`
[01:22:33] <dbaupp> *looper()
[01:22:48] <goffrie> yeah, but that syntax is so heavyweight :P might as well use a mutable variable
[01:22:57] <goffrie> and it doesn't let you return from inside the loop etc
[01:22:58] <jensnockert> Hmâ€¦ there is a small issue, of well, not updating the actual valueâ€¦
[01:23:33] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[01:24:00] <dbaupp> goffrie: right
[01:25:14] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[01:26:07] <jensnockert> Urghâ€¦ silly code is not emitted :(
[01:27:58] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:28:03] <jensnockert> Ok with optimizers off, something is overwriting my result. /o\
[01:30:59] <jensnockert> Urghâ€¦ there is ty::ByCopy/ByRef as wellâ€¦
[01:33:05] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Ping timeout)
[01:39:15] <jensnockert> Oh no, there isn't, something is rotten in the state of trans.
[01:40:52] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Connection reset by peer)
[01:44:09] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[01:46:10] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:52:10] <jensnockert> Anyone knows where rustc generates the store/load/â€¦ pattern of https://gist.github.com/jensnockert/5996993 ?
[01:54:10] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[01:54:28] <steven_is_false> xk
[01:54:28] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[01:56:17] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[01:58:21] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[01:58:21] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/gFYyXQ
[01:58:21] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[01:59:57] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[02:00:21] <bjz_> (but edge cases, edge cases)
[02:00:27] <bjz_> woops
[02:00:37] <bjz_> (disregard that)
[02:02:46] *** Quits: zz_kimundi (kimundi@moz-DB3C8B03.dip0.t-ipconnect.de) (Ping timeout)
[02:03:56] <dbaupp> yay, a working malloc!
[02:04:07] <jensnockert> \o/
[02:04:33] <jensnockert> I think, if I remove all the Load/Store combo-breakers, this should workâ€¦
[02:05:06] <strcat> dbaupp: hrm?
[02:05:09] * jensnockert ninja-modifies load_if_immediate/spill_if_immediate and sees if that fixes anything.
[02:05:23] <dbaupp> strcat: pure-Rust malloc
[02:05:35] <dbaupp> strcat: (well, with some asm! for the brk syscall.)
[02:05:47] *** Joins: zz_kimundi (kimundi@moz-37568B34.dip0.t-ipconnect.de)
[02:06:02] <jensnockert> \o/
[02:06:09] <jensnockert> dbaupp: That's nice!
[02:06:14] *** zz_kimundi is now known as kimundi
[02:07:18] <strcat> dbaupp: you really don't want to use brk though ;p
[02:07:30] <strcat> dbaupp: it's not thread-safe and you'd need a global lock
[02:07:41] <dbaupp> strcat: correct
[02:07:53] <dbaupp> strcat: it's hilariously unthreadsafe
[02:07:59] <dbaupp> strcat: and hilariously slow
[02:08:03] <strcat> just use mmap/munmap/mremap
[02:08:09] <strcat> directly, at first
[02:09:03] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[02:10:55] <bjz_> is sebcrozet on IRC?
[02:11:03] <bjz_> (github username)
[02:11:15] *** Quits: glinscott (garylinsco@789A6618.53EB7C1.FFFE3AA.IP) (Quit: glinscott)
[02:12:16] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:12:22] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[02:13:19] *** Joins: Voomer (Voomer@moz-9D83462.dyn.centurytel.net)
[02:13:44] *** Joins: glinscott (garylinsco@789A6618.53EB7C1.FFFE3AA.IP)
[02:14:02] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[02:14:08] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[02:14:24] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[02:15:06] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:16:09] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[02:16:26] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[02:18:51] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[02:18:59] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:19:04] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[02:19:58] *** Quits: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net) (Ping timeout)
[02:21:06] <jensnockert> Now the IR looks better, https://gist.github.com/jensnockert/5996993
[02:22:10] <dbaupp> jensnockert: that appears to be the same
[02:22:34] <jensnockert> dbaupp: Essentially, but with two store/load-combos less.
[02:22:49] <jensnockert> The problem is still that it overwrites the result :(
[02:23:03] <dbaupp> jensnockert: as in, exactly the same... the revision history says "no changes" :S
[02:23:08] <jensnockert> Oh, weird.
[02:23:27] <jensnockert> Disregard me then.
[02:23:55] <jensnockert> I suck.
[02:24:13] * dbaupp hugs jensnockert 
[02:24:19] * jensnockert hugs dbaupp.
[02:26:41] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[02:26:47] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[02:29:26] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:29:57] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:30:30] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[02:35:37] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[02:38:52] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[02:40:01] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[02:44:24] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[02:45:35] *** Quits: sp3d (a@moz-49806493.dhcp.stls.mo.charter.com) (Ping timeout)
[02:46:29] *** Joins: sp3d (a@moz-49806493.dhcp.stls.mo.charter.com)
[02:48:21] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[02:48:38] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[02:51:39] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[02:51:42] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[02:53:48] *** Quits: pnathan (Adium@moz-BDC3EE62.tukw.qwest.net) (Quit: Leaving.)
[02:54:43] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[02:55:13] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[02:55:52] <jensnockert> dbaupp: How do you get debug! macros to actually print? RUST_LOG="rustc=1" does nothing?
[02:55:57] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[02:56:02] <aatch> jensnockert, =4
[02:56:11] <aatch> (or omitted)
[02:56:21] <jensnockert> That did it.
[02:56:23] <jensnockert> Thanks.
[02:56:39] <jensnockert> Maybe I should limit it to printing stuff in trans thoughâ€¦
[02:56:42] <Luqman> jensnockert: i usually do RUST_LOG=rustc=1,rustc::middle::trans::adt or similar
[02:56:47] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[02:56:54] <jensnockert> Yeah, that makes sense.
[02:57:06] <jensnockert> That is what I was trying, except it printed nothing.
[02:57:22] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[02:58:00] <strcat> rusti: 2 + 2
[02:58:01] -rusti- 4
[02:58:08] *** Quits: Sorella (queen@78575561.924F2739.95C8B7C6.IP) (Quit: (quit))
[02:58:40] *** Joins: pnathan (Adium@moz-BDC3EE62.tukw.qwest.net)
[02:58:49] *** Quits: pnathan (Adium@moz-BDC3EE62.tukw.qwest.net) (Quit: pnathan)
[02:58:59] <Jeaye> strcat: All is well.
[02:59:43] <jensnockert> Luqman, aatch: Managed to get it to work, thanks <3
[03:00:00] <jensnockert> RUST_LOG="rustc::middle::trans" was the magic
[03:00:17] *** Quits: kimundi (kimundi@moz-37568B34.dip0.t-ipconnect.de) (Ping timeout)
[03:00:17] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[03:00:18] <Jeaye> Quotes should be optional, jensnockert. :)
[03:00:39] <jensnockert> Jeaye: Yeah, but I like them ;)
[03:00:39] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[03:00:52] <jensnockert> Ages of non-shell programming has hurt my brain.
[03:03:30] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[03:03:56] *** Joins: zz_kimundi (kimundi@moz-C27D11C.dip0.t-ipconnect.de)
[03:04:19] *** zz_kimundi is now known as kimundi
[03:06:29] <dbaupp> https://github.com/huonw/rust-malloc
[03:07:03] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[03:10:14] <ChrisMorgan> I'm struggling with the concept of lifetimes and how it needs to be used. I have a TcpStream and I want a RequestBuffer which uses the TcpStream, for reading, and a ResponseWriter which also uses the TcpStream, for writing. (For reference, `pub struct TcpStream(~RtioTcpStreamObject)`.)
[03:10:33] *** Joins: fread2282 (Mibbit@moz-245EE4FA.nat.asu.edu)
[03:13:16] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[03:13:47] *** Quits: bytewise (bytewise@moz-649C630D.unitymediagroup.de) (Quit: Leaving)
[03:14:02] <goffrie> ChrisMorgan: you can't borrow the TcpStream at the same time for both objects
[03:14:34] <goffrie> unless it offers some way of splitting the stream, which it apparently does not
[03:14:39] <ChrisMorgan> That was what I was coming to suspect, but why exactly is that?
[03:15:03] <goffrie> borrowing gives the borrower exclusive access to the borrowed object
[03:15:20] <dbaupp> '&mut' borrowing
[03:15:25] <goffrie> ^ yes, that's what I mean.
[03:16:25] <dbaupp> ChrisMorgan: presumably someone will sling some `unsafe` around to make a safe interface that allows splitting into in-stream and out-stream
[03:16:29] <goffrie> yeah. it would be unsafe in general to allow multiple writers, since it breaks the promise that &mut gives, which is that nobody else can modify your object
[03:16:35] <dbaupp> ChrisMorgan: but it hasn't happened yet
[03:16:45] <ChrisMorgan> And so while an immutable borrow is going on one cannot make a mutable borrow, which is needed for actually writing or reading.
[03:16:53] <dbaupp> correct
[03:16:53] <goffrie> ChrisMorgan: correct.
[03:19:23] <ChrisMorgan> Hmm. So the result is that without unsafe code I can't get a properly segregated interface. Temporary result, I guess, is to read the entire request before starting to handle the response.
[03:19:45] <goffrie> the underlying interface doesn't seem to require &mut access to the RtioTcpStreamObject, though.
[03:20:22] <fread2282> I'm working on python bindings/interface for embedding python and it seems like pythen isn't threadsafe (when I use it from tasks, it sometimes crases and is not very predictable) and I'm wondering how to debug that and what the idiomatic way would be to wrap it for use from tasks
[03:20:24] <goffrie> so maybe you can get away with just doing it the unsafe way, as the object is never actually mutated by read() or write().
[03:20:58] <fread2282> crashes = strange python error or segfault
[03:21:22] <goffrie> hm, wonder who here's familiar with python
[03:21:44] * ChrisMorgan loves Python but is not familiar with the CPython API
[03:22:04] <fread2282> goffrie: I think it would be better to just assume it isn't threadsafe at all
[03:22:59] <goffrie> fread2282: you could make a `static mut` mutex and use that, perhaps. not sure about the details, or if python will let you use it in that way (from different threads)
[03:22:59] <fread2282> so what's the idiomatic way to wrap that so I can use it from tasks?
[03:24:26] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[03:24:56] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[03:25:13] <goffrie> fread2282: I guess you could also make a new task on its own thread, whose only job is to call into python and feed results back; but that's probably not an improvement
[03:25:29] <geomyidae> Was udp ever implemented or just tcp? I thought there had been a net/udp.rs file at one point?
[03:25:53] <fread2282> goffrie: it may be b/c task migration between threads may have bad effects
[03:26:24] <ChrisMorgan> geomyidae: do you mean in extra::net or std::rt::io::net?
[03:26:24] <fread2282> (no clue how threadsafe python is)
[03:26:52] <dbaupp> fread2282: CPython?
[03:27:07] <fread2282> dbaupp: yes
[03:27:36] <dbaupp> fread2282: (almost) everything is supposed to happen inside the GIL
[03:27:50] <dbaupp> so you're possibly not setting that up correctly, but I don't know.
[03:27:58] <aatch> (Global Interpreter Lock?)
[03:28:03] <goffrie> ^yeah
[03:28:04] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[03:28:24] <dbaupp> fread2282: also, https://bitbucket.org/devin.jeanpierre/pyrite
[03:28:30] <kdj> Ah, in newer master is it not possible to add two vectors together?
[03:28:40] <dbaupp> fread2282: (that's calling into Rust from Python)
[03:28:42] <dbaupp> kdj: ?
[03:28:53] <dbaupp> rusti: &[1,2,3] + &[1,2]
[03:28:54] -rusti- ~[1, 2, 3, 1, 2]
[03:29:07] <dbaupp> rusti: &[1] + [1] // this will fail
[03:29:08] -rusti- <anon>:7:9: 7:19 error: failed to find an implementation of trait std::vec::Vector<<VI0>> for [int, .. 1]
[03:29:08] -rusti- <anon>:7          &[1] + [1] // this will fail
[03:29:08] -rusti-                   ^~~~~~~~~~
[03:29:08] -rusti- application terminated with error code 101
[03:29:27] <fread2282> dbaupp: maybe, but the API is *not* thread/tasksafe from my experience (maybe the issue is multiple calls from same thread being interleaved?)
[03:29:28] <goffrie> not a lot of library support for fixed-length vectors :(
[03:29:49] <fread2282> dbaupp: I'm doing python in a rust app
[03:29:52] <aatch> goffrie, because each size is it's own type
[03:29:58] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Ping timeout)
[03:30:09] <goffrie> right, and we also don't have templates over constants
[03:30:15] <aatch> [T,..n] != [T,..m]
[03:30:15] <dbaupp> fread2282: right, that was just a project in a similar area
[03:30:28] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[03:30:43] <aatch> (where n != m)
[03:30:48] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:30:57] <dbaupp> goffrie: yeah, it's really annoying :(
[03:31:08] <aatch> goffrie, we don't have templates
[03:31:08] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[03:31:10] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[03:31:13] <fread2282> dbaupp: right. my project may also help with that (rust interface to the C-API)
[03:31:25] <goffrie> ok, what would you call it then :p
[03:31:34] <aatch> Type Generics
[03:32:33] <dbaupp> "parametric polymorphism" is the Haskell (etc) jargon for it
[03:32:33] <goffrie> why can't that be called templates?
[03:32:48] <aatch> goffrie, because they aren't templates
[03:33:03] <dbaupp> it can be, but it's different to C++ templates, so it could lead to confusion
[03:33:12] <goffrie> well, the underlying mechanism seems to be the same :P but yeah I see the point
[03:33:59] <aatch> goffrie, except the underlying mechanism is actually very different. It's much more complex than "substitute 'a' for 'T' in this block"
[03:34:07] <aatch> since our type parameters are type-checked.
[03:34:29] <goffrie> what I mean is the mechanism of instantiating different copies of the generic-thing
[03:34:45] <aatch> goffrie, but that's just a single facet of implementation.
[03:35:33] <kdj> dbaupp: Interesting. It was actually a mutable vector: 'x = x + y' works, 'x += y' does not
[03:35:36] <kdj> Now
[03:35:55] <goffrie> well, it seems pretty much the same to me, except the extra typecheck.
[03:36:01] <aatch> kdj, assign-ops for anything other than primitives has been temporarily removed.
[03:36:10] <aatch> goffrie, what about type bounds?
[03:36:13] <kdj> That would explain it! thanks
[03:36:20] <goffrie> aatch: hmm, that's a good point
[03:36:24] <aatch> kdj, since they were broken
[03:36:31] <kdj> Sounds reasonable
[03:36:51] <kdj> I just came back after not touching a computer for 3 weeks and am fixing some stuff
[03:36:53] <aatch> goffrie, they aren't templates for the same reason Haskell isn't considered to be all templates.
[03:37:02] <aatch> kdj, yeah, lots of changes...
[03:37:16] <goffrie> aatch: maybe it's just the syntax that makes me think it then :p
[03:37:22] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:37:22] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/xnd8JA
[03:37:22] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:37:23] <aatch> goffrie, likely.
[03:37:29] <goffrie> because I agree that haskell's parametric polymorphism is very non-templatey.
[03:37:31] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:37:31] *** ChanServ sets mode: +o dherman
[03:38:06] <aatch> Templates can certainly be used for type generics (and in fact are the most common usage), but templates can be used for much more and different code.
[03:38:13] <aatch> C++ templates are turing complete.
[03:38:27] <goffrie> yes, in the most infuriatingly useless way :P
[03:38:41] <aatch> goffrie, well, turing complete doesn't mean useful.
[03:39:05] <goffrie> of course, I mean that when I want to use c++ templates for compile time computation, I very quickly stop.
[03:42:26] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:51:59] *** Joins: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de)
[03:55:15] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[03:55:22] *** Quits: roo (jesse@moz-9A53149A.ip.windstream.net) (Ping timeout)
[03:55:39] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[03:57:24] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[04:00:05] <ChrisMorgan> rusti: fn foo(a: int, a: bool) { println(fmt!("%?", a)); } foo(42, false);
[04:00:07] -rusti- <anon>:7:16: 7:17 warning: unused variable: `a` [-W unused-variable (default)]
[04:00:07] -rusti- <anon>:7          fn foo(a: int, a: bool) { println(fmt!("%?", a)); } foo(42, false);
[04:00:07] -rusti-                          ^
[04:00:07] -rusti- false
[04:00:07] -rusti- ()
[04:00:19] <ChrisMorgan> A little worrying, that.
[04:01:23] <goffrie> rusti: struct A { a: int, a: int }; ()
[04:01:25] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/PKJB
[04:01:27] <goffrie> rusti: struct A { a: int, a: int } ()
[04:01:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/OWAR
[04:01:32] <goffrie> at least that was fixed.
[04:02:24] <MaikKlein1> that should be fixed
[04:02:40] <dbaupp> ChrisMorgan: file a bug!
[04:04:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:04:46] <MaikKlein1> bstrie, are you Dave Herman? :)
[04:06:31] <dbaupp> MaikKlein1: bstrie = ben striegel (dherman = dave herman)
[04:07:17] <dbaupp> (well, maybe Benjamin; I don't know which he prefers.)
[04:07:20] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:08:39] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:11:20] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:11:21] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Quit: gavinb)
[04:12:58] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:14:02] <MaikKlein1> oh ok
[04:14:09] <fread2282> where should I put trace_macros! and log_syntax! ?
[04:14:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:15:06] <dbaupp> fread2282: before whatever you want to get diagnostics on
[04:15:27] <jensnockert> Maybe I should rebase all of this stuff on masterâ€¦
[04:15:32] <dbaupp> rusti: trace_macros!(true) fmt!("a")
[04:15:33] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DFAE
[04:16:07] <dbaupp> rusti: trace_macros!(true, fmt!("a"))
[04:16:07] -rusti- true
[04:16:21] * dbaupp is confused
[04:16:35] <dbaupp> rusti: trace_macros!(true); fmt!("a")
[04:16:36] -rusti- ~"a"
[04:17:27] *** Quits: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de) (Ping timeout)
[04:17:29] *** Joins: AndChat|437241 (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[04:18:50] *** Quits: mark_edward_mobile (AndChat437@moz-A6154E1A.dynamic.utc.edu) (Ping timeout)
[04:19:06] <fread2282> https://gist.github.com/fread2281/e5d9de4ea9fba64e94b2 I have no clue whatI'm doing wrong
[04:21:17] <dbaupp> fread2282: you probably want $x:expr rather than $x:block
[04:21:33] <klutzy> anyone using solarized light colorscheme?
[04:21:50] <dbaupp> rusti: macro_rules! foo(($x:block) => {|y| $x}); foo!({ y + 1})
[04:21:50] -rusti- <anon>:7:46: 7:47 error: unexpected token: `an interpolated block`
[04:21:51] -rusti- <anon>:7          macro_rules! foo(($x:block) => {|y| $x}); foo!({ y + 1})
[04:21:51] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:21:51] -rusti-                                                        ^
[04:21:51] -rusti- application terminated with error code 101
[04:21:51] *** ChanServ sets mode: +o dherman
[04:21:54] <aatch> (Most commonly, you want expr or ident, it's rare to need anything else)
[04:21:59] <dbaupp> rusti: macro_rules! foo(($x:block) => {do f |y| $x}); foo!({ y + 1})
[04:22:01] <klutzy> since rustc emits error messages as white, my eye's getting transparent messages
[04:22:02] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HAGD
[04:22:27] <dbaupp> fread2282: a block goes after do and for ^
[04:23:14] <aatch> blocks are only there to handle some wierdness around block expression return types and for/do sugar
[04:23:22] <aatch> oh, and if/else
[04:23:38] <dbaupp> klutzy: that should've been fixed by https://github.com/mozilla/rust/pull/7716 btw
[04:23:49] <aatch> basically, if you are required to put '{' '}', then you can have a block.
[04:24:29] <klutzy> dbaupp: thanks for info! i have to dig it now
[04:25:16] * aatch read "info!" as a macro...
[04:25:31] <strcat> dbaupp: anyway, I think what you should start with is mapping malloc/calloc directly to mmap, realloc to mremap and free to munmap
[04:25:43] <strcat> dbaupp: at the very least you'll then be beating calling into C for large allocs
[04:25:48] <strcat> and it'll be thread-safe
[04:26:09] <dbaupp> strcat: yeah, I was going to essentially delete the whole thing and start over
[04:26:15] <dbaupp> strcat: I was mainly just experimenting
[04:26:18] <strcat> dbaupp: ah
[04:26:27] <dbaupp> because I've never written an allocator before
[04:26:34] <strcat> neither have I! ;p
[04:26:44] * strcat has looked at the code before though
[04:26:46] * dbaupp now knows how the heap grows
[04:26:59] <dbaupp> (well, some implementations of the heap.)
[04:27:03] <strcat> dbaupp: well, it's different if you use mmap
[04:27:07] <dbaupp> strcat: correct
[04:27:16] <strcat> mremap is blazing fast ;p
[04:27:27] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[04:27:28] <strcat> it doesn't have to copy
[04:27:34] <dbaupp> my current implementation of realloc is faster! :P
[04:27:46] <strcat> dbaupp: for really large things? ;p
[04:27:55] *** Joins: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP)
[04:28:02] <strcat> 10k element array -> mremap to 20k
[04:28:09] <dbaupp> fn realloc(x: *mut u8, size: uint) -> *mut u8 { 0 as *mut u8 }
[04:28:16] <strcat> nice ;]
[04:28:18] * dbaupp thinks it's very helpful
[04:28:35] <steven_is_false> Hi. I tried searching but I couldn't find any duplicates. Does anyone know if this issue I filed is a duplicate https://github.com/mozilla/rust/issues/7793 ?
[04:29:00] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[04:29:33] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[04:29:58] <dbaupp> strcat: do you happen to know if windows has a mmap equivalent?
[04:30:04] <strcat> dbaupp: yes, VirtualAlloc iirc
[04:30:13] <sanxiyn> rusti: #[simd] struct f64x2(f64, f64); let x = f64x2(2f64, 3f64); x * x
[04:30:14] -rusti- {__field__: 4, __field__: 9}
[04:30:14] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[04:30:21] <strcat> dbaupp: you should look around the jemalloc source and see what they use
[04:30:23] <strcat> probably that
[04:30:25] <brendanc> have I missed some cool mremap experimentation?
[04:30:34] <strcat> brendanc: unrelated to your thing :)
[04:30:53] <brendanc> sounds like it's benchmarking well though? :)
[04:31:17] <dbaupp> brendanc: you missed some bad malloc implementation https://github.com/huonw/rust-malloc ;)
[04:31:36] <brendanc> ah
[04:31:38] <dbaupp> (or maybe I'm missing some context... heh.)
[04:31:53] <dbaupp> strcat: ok, I'll file that away for later
[04:31:55] <dbaupp> thanks
[04:32:03] <dbaupp> sanxiyn: yay!
[04:32:09] <brendanc> think it's relevant to my stack idea, since we'd need a primitive mmap-based allocator to do it
[04:32:13] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[04:32:18] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:32:25] <sanxiyn> dbaupp: From IRC log, I understand jensnockert is also working on SIMD?
[04:32:50] <dbaupp> sanxiyn: yes, I think he's mainly trying to make "swizziling" work
[04:32:53] <jensnockert> sanxiyn: Yes, I am trying to add OpenCL-style fields to them.
[04:32:54] * brendanc means to put together a couple of small benchmarks to compare stack cost for tasks that use no stack vs lots of stack
[04:33:23] <sanxiyn> jensnockert: Yes I wanted to do that too...
[04:33:25] <brendanc> and maybe try to add an interface to explicitly set initial stack size
[04:33:28] <sanxiyn> jensnockert: Be sure to look at https://github.com/mozilla/rust/pull/5841
[04:33:40] <brendanc> looks like something we could just jam into TaskBuilder
[04:33:41] <sanxiyn> (That was my original patch which was shot down)
[04:34:07] <sanxiyn> jensnockert: i.e. why it is an attribute now
[04:35:55] <jensnockert> The problem with attributes.
[04:36:15] <dbaupp> rusti: #[simd] struct f64x8(f64, f64,f64, f64, f64, f64, f64, f64); let x = f64x8(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0); x * x
[04:36:16] -rusti- {__field__: 1, __field__: 4, __field__: 9, __field__: 16, __field__: 25, __field__: 36, __field__: 49, __field__: 64}
[04:36:27] <jensnockert> If I have a <4 x f32>, and select two elements, I would need a <2 x f32>, but it is hard to create such a type in typecheck/trans?
[04:36:46] <sanxiyn> jensnockert: Indeed, that is problematic
[04:37:03] <jensnockert> I tried that, but I just cannot do that in a way that makes sense.
[04:37:25] <sanxiyn> jensnockert: Start a discussion on rust-dev?
[04:37:42] <jensnockert> Yeah, I just need to rebase the patch first.
[04:38:16] <sanxiyn> jensnockert: I mean, my initial patch was also ty::ty_simd. I changed because <graydon> I'm... generally uncomfortable with adding a new type for this
[04:38:22] <sanxiyn> Maybe that was a bad decision
[04:38:44] <jensnockert> I think so, but that may be because the current trans-implementation is bad.
[04:39:07] <jensnockert> It is really hard to just inject random structs/tuples inside of the compiler.
[04:39:59] <sanxiyn> jensnockert: Well structs are nominal, so you need name... Why are tuples hard?
[04:40:16] <jensnockert> Haven't tried tuples.
[04:40:39] <jensnockert> But I tried for a few hours to inject new structs, didn't manage in a way that would make typechecking happy.
[04:41:08] <sanxiyn> jensnockert: Yes I think that won't work
[04:41:15] <sanxiyn> Now I am convinced that this needs to be a structural type
[04:41:30] <jensnockert> Not a tuple?
[04:41:39] <sanxiyn> Tuple is structural
[04:41:46] <jensnockert> Oh, ok.
[04:42:00] <sanxiyn> That is, all SIMD types are (should be) same
[04:42:10] <sanxiyn> i.e. not having names
[04:42:18] <jensnockert> I agree.
[04:42:29] <sanxiyn> Apart from selection, you'd want comparison of <4 x f32> to result in <4 x i1>
[04:42:30] <jensnockert> <4 x f32> should always be <4 x f32>
[04:42:53] <sanxiyn> So you need to conjure <4 x i1> out of thin air
[04:43:04] <jensnockert> Yes.
[04:44:03] <jensnockert> And it should be able to pretty-print with the types.
[04:45:01] <bstrie> dbaupp: I'm flattered that you managed to correctly spell my last name
[04:45:35] <dbaupp> bstrie: I checked it... but I did manage to get it right first time :)
[04:46:35] <sanxiyn> jensnockert: Thank you for looking at SIMD, and let's see how other people think re: making SIMD a new type (moving away from attribute)
[04:46:57] <jensnockert> sanxiyn: Are you sending something to rust-dev?
[04:47:07] <jensnockert> Or should I do that?
[04:47:11] <sanxiyn> I think you should
[04:47:17] <jensnockert> Ok, I'll do that.
[04:47:20] <sanxiyn> Thanks!
[04:48:22] <jensnockert> No problem.
[04:48:30] <jensnockert> Thanks for the tips.
[04:48:48] <sanxiyn> jensnockert: I mentioned the old pull request because I thought you should be aware of previous discussion
[04:49:30] <aatch> dbaupp, yay, you're using my syscall wrappers!
[04:50:11] <dbaupp> aatch: yup!
[04:50:17] * dbaupp hugs aatch
[04:50:33] * dbaupp hugs jensnockert too
[04:51:01] * jensnockert hugs dbaupp, sanxiyn and aatch.
[04:51:14] <sanxiyn> :)
[04:51:23] <aatch> dbaupp, just be aware that syscall only works on 64-bit
[04:51:34] <dbaupp> aatch: yeah, I was
[04:51:50] <dbaupp> aatch: I'll write a wrapper around int 0x80 or something
[04:51:53] <dbaupp> I guess.
[04:52:38] <aatch> dbaupp, yep, should be pretty similar, since I think the arguments (up to ~4 I think) get put into the same registers
[04:52:47] <dbaupp> oh, neat
[04:53:00] * dbaupp thinks that this may've been by design
[04:53:16] <aatch> the higher-numbered args are treated... oddly, because you run out of GP registers
[04:53:29] <aatch> (which isn't a problem for 64-bit)
[04:53:32] <dbaupp> isn't there some "vdso" or something, that saves on a context switch into the kernel?
[04:53:41] * dbaupp doesn't know what he's talking about
[04:53:47] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[04:53:50] <strcat> heh valgrind seems unaware of mmap
[04:53:52] <aatch> dbaupp, yeah, and it's probably what you should use on 32-bit anyway
[04:53:52] <strcat> completely
[04:54:09] <aatch> strcat, doesn't valgrind look for malloc + friends?
[04:54:17] <strcat> yeah
[04:54:24] <strcat> just thought it might look at anonymous mmap pages
[04:54:25] <strcat> it doesn't
[04:54:36] <dbaupp> strcat: it's completely unaware of my malloc too, heh
[04:54:54] <strcat> well it assumes a correct allocator
[04:54:55] <strcat> ;p
[04:55:00] <aatch> strcat, probably too many false-positives.
[04:55:09] <dbaupp> I was trying to use valgrind to diagnose segfaults... it was useless... :'(
[04:55:30] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[04:55:34] * dbaupp is offended, his allocator is 100% correct :P
[04:55:47] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[04:55:54] <sanxiyn> dbaupp: You are writing an allocator?
[04:56:05] <dbaupp> sanxiyn: https://github.com/huonw/rust-malloc
[04:56:13] <dbaupp> (it sucks :P )
[04:56:29] <steven_is_false> I know there's a configure option to use helgrind but is there a make option? Like make check VAlGRIND_FLAGS=helgrind or something?
[04:57:00] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:57:58] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[04:58:20] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:58:21] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/CxAiag
[04:58:21] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:58:23] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[04:58:23] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/X9AdSQ
[04:58:23] <ghrust> 13rust/06auto 149adad22 15sp3d: add regions, unicode idents, attributes to GtkSourceView language-spec
[04:58:23] <ghrust> 13rust/06auto 14fd80291 15bors: auto merge of #7795 : sp3d/rust/master, r=z0w0...
[04:58:24] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[04:58:24] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[04:58:40] <olsonjeffery> dbaupp: obviously the README needs a line about how it promises to set fire to your laundry and drink your last beer
[04:59:46] <sanxiyn> It seems that bors queue is now empty
[05:00:11] <dbaupp> olsonjeffery: hahaha
[05:01:01] <ChrisMorgan> There, I've finally patched things together enough to read an entire HTTP request and make a valid response, WITHOUT crashing before the completion of the request!
[05:01:31] <olsonjeffery> ChrisMorgan: in rust? using what API? newsched?
[05:02:21] <dbaupp> ChrisMorgan: \o/
[05:03:55] <ChrisMorgan> olsonjeffery: extra::net::tcp, with an adapter so that I'm using it in the style of std::rt::io::net::tcp, which sadly aborts in calling bind(): "You've met with a terrible fate, haven't you?" "fatal runtime error: runtime tls key not initialized"
[05:04:10] <ChrisMorgan> But I can switch between the two with the addition or removal of a single / :-)
[05:04:37] <olsonjeffery> neat!
[05:04:45] <strcat> sanxiyn: many failed things ;]
[05:05:10] <sanxiyn> strcat: My favorite: #7659
[05:05:29] <sanxiyn> Title is "Leak LLVM module and context to save time for rustc"
[05:05:37] <sanxiyn> Failure is... Valgrind failure about that exact leak
[05:05:38] <sanxiyn> ...
[05:05:54] <dbaupp> hahaha
[05:06:23] <sanxiyn> dbaupp: It sort of proves that the code works :)
[05:06:32] <dbaupp> sanxiyn: yup
[05:07:07] <strcat> mmap seems cheap enough
[05:07:08] <strcat> ;p
[05:07:36] *** Joins: pyrac (pyrac@moz-8862B13A.w92-162.abo.wanadoo.fr)
[05:07:47] <dbaupp> strcat: from Rust?
[05:07:50] <strcat> no
[05:08:07] <strcat> just seeing how much slower it is for something like 512 bytes
[05:09:06] <dbaupp> I see
[05:09:32] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[05:10:17] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[05:13:18] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:13:32] <strcat> jemalloc still uses arenas for ones up to 4MiB so raw mmap compares pretty badly ;p
[05:15:02] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:15:06] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[05:15:11] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Client exited)
[05:21:03] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[05:29:12] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Quit: Konversation terminated!)
[05:29:20] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[05:30:57] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[05:31:41] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[05:32:03] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Quit: Konversation terminated!)
[05:32:09] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[05:33:39] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[05:33:39] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:35:02] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Quit: Leaving)
[05:35:26] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[05:35:53] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:36:51] *** Quits: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP) (Quit: Leaving)
[05:38:31] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[05:41:27] <jensnockert> Oh well, need to rebuild LLVMâ€¦ :(
[05:41:34] * jensnockert goes off to play a game of DotA 2.
[05:46:23] <eevee> probably best to return structs rather than pointers, right?  that lets the caller figure out the pointer type, and i assume rust is clever enough to move the return value
[05:46:44] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Quit: victorporof)
[05:47:47] <dbaupp> eevee: as in have fn foo() -> SomeStruct {} rather than fn foo() -> ~SomeStruct {}?
[05:48:36] <eevee> yeah
[05:48:51] <eevee> so caller is free to stick it in @ if appropriate
[05:49:13] <dbaupp> yeah
[05:49:53] <eevee> i love copy-nothing
[05:50:09] <dbaupp> in theory, Rust will use an out-pointer, so there's no needless memcpy's for something like ~foo() (i.e. it will get placed straight where it will end up)
[05:50:18] <dbaupp> but it's not very intelligent about it right now
[05:50:41] <dbaupp> https://github.com/mozilla/rust/issues/7298
[05:50:56] <eevee> whoops, well.
[05:51:11] *** Quits: AndChat|437241 (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[05:51:19] <dbaupp> it does work if the return value is the last expression
[05:51:32] <dbaupp> but doesn't if it's not
[05:51:57] <eevee> ok that's not too bad then
[05:52:10] <eevee> i assume it's still *semantically* a move, i.e. no destructors run or anything
[05:52:14] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[05:52:23] <dbaupp> yes
[05:52:23] <fread2282> how can I have a static mut Mutex?
[05:52:39] * dbaupp would also like to know the answer to fread2282's question
[05:52:40] <fread2282> /can I?
[05:52:49] <eevee> world.rs:151:61: 151:70 error: internal compiler error: Cannot relate bound region as subregion: br_anon(2)
[05:52:54] <eevee> nooo how do i keep tripping over this
[05:53:07] <dbaupp> fread2282: (where are Rust's mutex's btw?)
[05:53:16] <fread2282> dbaupp: extra::sync
[05:53:44] <dbaupp> fread2282: aha
[05:54:03] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[05:54:07] <dbaupp> rusti: static mut x: Option<extra::sync::Mutex> = None;
[05:54:10] -rusti- ()
[05:54:15] <fread2282> the Mutex code needs a Sem which needs a both pipe endpoints as separate fields or something like that
[05:54:18] <dbaupp> fread2282: like that, and then initialise it
[05:54:53] <dbaupp> (i.e. unsafe { x = Some(Mutex()) } in the top of main)
[05:54:53] <fread2282> dbaupp: that will introduce much extra complexity but okay
[05:55:02] <dbaupp> fread2282: yeah, I agree :(
[05:55:14] * dbaupp doesn't know how to do it any other way
[05:56:06] <steven_is_false> dbaupp: That's an interesting use case.
[05:56:13] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[05:56:39] <dbaupp> steven_is_false: yeah, it would be very useful for the synchronisation primitives to be static-initialisable
[05:57:01] <dbaupp> steven_is_false: (it'd be even nice if they didn't require a malloc internally... ;P )
[05:57:19] <steven_is_false> Yeah, I disliked that too :(
[05:58:25] <steven_is_false> dbaupp: After I finish up with my current refactoring work, I'll see if I can come up with something.
[05:58:33] <dbaupp> aatch and bblum have done a lot of work on supporting atomic operations... I guess they could be used for mutexes?
[05:58:36] * dbaupp doesn't know
[05:58:55] <steven_is_false> but right now I'm fighting against not one but TWO ICEs!
[05:59:23] <steven_is_false> Although I've already figured out the first one https://github.com/mozilla/rust/issues/7793
[05:59:35] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[06:00:13] <eevee> i'm fighting an ICE and an awkward behavior where ~Trait is not automatically passable as &Trait
[06:00:51] <dbaupp> steven_is_false: well, yeah; for reference, my current use-case is an allocator and I need to be able to globally lock, i.e. equivalent of `static pthread_mutex_t global_lock = PTHREAD_MUTEX_INITIALISER;`
[06:01:07] <dbaupp> eevee: yeah, it's annoying :(
[06:01:26] <eevee> that and https://github.com/mozilla/rust/issues/5708 are making traits reeeeally hard to use at all  :(
[06:01:31] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[06:02:14] <dbaupp> eevee: :(
[06:02:31] <eevee> ah, lack of autoborrow is https://github.com/mozilla/rust/issues/3794
[06:04:13] *** Quits: pyrac (pyrac@moz-8862B13A.w92-162.abo.wanadoo.fr) (Quit: pyrac)
[06:06:09] <eevee> changing everything to just take ~T seems to have worked
[06:06:28] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[06:06:56] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Client exited)
[06:07:55] * fread2282 is getting really annoyed at python
[06:08:12] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[06:08:13] <fread2282> with GIL and a Mutex it still likes to segfault
[06:08:27] <strcat> got the refcounting wrong? ;p
[06:09:29] <fread2282> strcat: why would that matter?
[06:11:50] <fread2282> strcat: I'm not at that step yet, still struggling with task-safety
[06:12:10] <dbaupp> fread2282: does it work if you run it in one task only?
[06:12:20] <fread2282> dbaupp: yes
[06:12:54] <fread2282> and it takes more time before segfaulting sometimes
[06:13:28] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:13:51] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:15:05] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[06:15:56] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[06:16:37] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[06:17:43] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[06:20:32] *** Quits: kimundi (kimundi@moz-C27D11C.dip0.t-ipconnect.de) (Ping timeout)
[06:20:56] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:22:15] <fread2282> how can I get some code to run when rust is shutting down?
[06:24:39] <dbaupp> fread2282: there's os::on_exit (or sys::on_exit) or something like that
[06:25:32] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[06:28:09] <fread2282> dbaupp: I can't find it
[06:29:19] <dbaupp> fread2282: ah, sorry, std::unstable::at_exit
[06:29:25] * dbaupp misremembered
[06:32:23] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[06:34:40] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Client exited)
[06:35:02] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:35:18] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:36:37] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[06:37:10] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[06:37:23] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:37:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/X9AdSQ
[06:37:23] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:38:18] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[06:38:33] *** Quits: fread2282 (Mibbit@moz-245EE4FA.nat.asu.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[06:38:54] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[06:38:58] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[06:39:09] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[06:40:20] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[06:40:21] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Z0H35Q
[06:40:21] <ghrust> 13rust/06auto 1427435c0 15Tom Lee: Install librustllvm.so to target lib directory
[06:40:21] <ghrust> 13rust/06auto 1460d5bb9 15bors: auto merge of #7796 : thomaslee/rust/issue-6247, r=z0w0...
[06:40:21] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[06:41:28] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[06:45:36] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: Don't tell them I was here...)
[06:49:12] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[06:54:25] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:55:59] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[06:56:43] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[06:59:30] *** Joins: pyrac (pyrac@EDE6BD92.73C89388.AD05C589.IP)
[06:59:39] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[07:00:31] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[07:01:55] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[07:02:11] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[07:03:50] <jensnockert> Wait, I cannot return from the outer function inside of a closure?!
[07:04:16] <jensnockert> My Ruby<3 is not impressed.
[07:06:49] *** Joins: Mowah (Mowah@moz-7A6BF5A3.cust.bredbandsbolaget.se)
[07:10:42] <dbaupp> jensnockert: when the `for` loop changes, you'll (probably) be able to return from the closure itself with `return`... but returning from the outer function wouldn't work at all...
[07:10:57] <dbaupp> e.g. task::spawn(some_closure)
[07:11:02] <jensnockert> dbaupp: Silly!
[07:11:06] <dbaupp> haha
[07:11:27] <jensnockert> Works in Ruby :(
[07:11:33] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[07:11:51] <jensnockert> How am I going to be able to escape from loops now /o\
[07:12:03] <jensnockert> (Serious question)
[07:13:03] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[07:13:28] <dbaupp> loop { ... if I_want_to_escape { set_some_condition; break; } ... break; } if some_condition { do_special_thing } ?
[07:13:38] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[07:13:57] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:14:00] <jensnockert> Urghâ€¦
[07:14:03] <jensnockert> Oh well.
[07:14:17] <dbaupp> combined with labelled break, if you have nested loops: `'outer_loop: loop { ... if .. { ...; break 'outer_loop; } ... break; }`
[07:14:37] * dbaupp doesn't like it either
[07:14:38] <jensnockert> Can we have labelled break now, or is it on the todo-list?
[07:14:42] <dbaupp> now
[07:15:05] <jensnockert> Oh wait, doesn't help me at all, oh wellâ€¦
[07:15:12] <dbaupp> :(
[07:15:24] <dbaupp> wrap it into a proper fn function and `return` from it?
[07:15:40] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[07:17:27] <jensnockert> I have two fns that return Options, and a loop, and if the fn(something) -> None, then I want to return None from the outer function
[07:17:44] <jensnockert> But I'll just set a fail-counter.
[07:18:05] <dbaupp> ah, annoying :(
[07:19:37] <jensnockert> In Ruby I could just do array.map { |something| if val = f(something); val; else return None } or similar.
[07:19:51] <jensnockert> Missing an end there, etc. But you get the idea.
[07:21:54] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[07:21:58] <dbaupp> what about `let mut vec = ~[]; for other_vec.iter().advance |x| { match f(x) { Some(a) => vec.push(a), None => return None } }`?
[07:22:32] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[07:23:13] <jensnockert> Does that work?
[07:23:39] <dbaupp> it should?
[07:23:39] <jensnockert> Oh, wait, for loops have speshul semantics, right?
[07:23:44] <dbaupp> yep
[07:24:05] <jensnockert> I'll never be able to wrap my head around that.
[07:24:47] <dbaupp> jensnockert: don't worry, it'll be changing to be simpler
[07:24:58] <jensnockert> dbaupp: So all blocks behave the same?
[07:25:30] <dbaupp> `for x |y| { z } => let mut iter = x; loop { match iter.next() { Some(a) => z, None => break } }`
[07:25:34] <dbaupp> (the syntax may change)
[07:25:48] <dbaupp> jensnockert: yeah, the for loop won't be a closure any more
[07:26:18] <dbaupp> (err s/Some(a)/Some(y)/)
[07:27:34] <jensnockert> dbaupp: That will be even more confusing /o\
[07:27:46] <dbaupp> jensnockert: nah, it'll be simple :P
[07:27:59] <jensnockert> Why not just make them closures?
[07:28:12] <dbaupp> it's bad
[07:28:25] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[07:28:26] <dbaupp> hard to optimise; awkward to codegen
[07:28:45] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[07:28:55] <dbaupp> jensnockert: (it's essentially the same as Python's for loop, except runs faster. :P )
[07:29:26] <dbaupp> jensnockert: https://mail.mozilla.org/pipermail/rust-dev/2013-June/004364.html
[07:29:31] <jensnockert> `@[<V10>]` does not implement any method in scope named `push` /o\
[07:29:45] <jensnockert> libstd obviously hates me today.
[07:30:07] <dbaupp> jensnockert: https://mail.mozilla.org/pipermail/rust-dev/2013-June/004599.html
[07:30:11] <dbaupp> jensnockert: it can't
[07:30:14] <dbaupp> it'd be unsafe
[07:30:19] <dbaupp> because @[] is immutable
[07:30:27] <jensnockert> Can I convert a ~[] into a @[] ?
[07:30:36] <dbaupp> (but you can be bad and use at_vec::raw::push, I think)
[07:30:43] <dbaupp> jensnockert: .to_managed might work?
[07:31:09] <jensnockert> I doubt there is anything in Rust I dislike as much as @
[07:31:13] <dbaupp> wait, there's at_vec::append(..)
[07:31:15] <doomlord_> i guess we still have the do sugar for future closure optimizations .. i did like the idea of everything being closure based
[07:31:35] <dbaupp> jensnockert: and at_vec::to_managed[_consume]
[07:31:38] <dbaupp> doomlord_: yes
[07:31:56] <dbaupp> doomlord_: it was nice... but it was also pretty awkward
[07:32:11] <doomlord_> one would hope eventually inlined closures are indistinguishable .. but i can put up with a dedicated for loop i guess :)
[07:33:13] <dbaupp> jensnockert: oh, I forgot, the biggest problem with the current for loop is that the outer function (i.e. foo in for foo |x| {y}) is responsible for implementing the for protocol correctly, i.e. it's "allowed" to just ignore `break` & `return`, so the borrow checker is very restrictive about them
[07:33:24] <dbaupp> jensnockert: the external-iterator for loop doesn't have this problem
[07:33:47] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[07:34:14] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[07:34:17] <dbaupp> doomlord_: yeah, they are, assuming the iterating function has enough #[inline] applied to it
[07:34:33] <dbaupp> (#[inline(always)] is required in some instances.)
[07:35:20] <jensnockert> Not enough inline, needs more inline.
[07:35:41] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Quit: gavinb)
[07:35:54] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[07:35:57] *** Joins: mye (mye@moz-E79A8420.dip0.t-ipconnect.de)
[07:36:23] <dbaupp> haha
[07:36:34] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:36:35] <jensnockert> #[inline(me_harder)]
[07:37:25] *** Joins: fabiand (fabiand@moz-A0BEF28F.adsl.alicedsl.de)
[07:37:43] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[07:38:41] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[07:38:49] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[07:39:51] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[07:43:01] <jensnockert> UNSAFE ALL THE THINGS \o/
[07:43:53] <jensnockert> Also, Spotify just hinted that I should listen to a song called "Carnival of Rust", is that a sign?
[07:44:02] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[07:44:02] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[07:44:47] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[07:45:04] <dbaupp> jensnockert: there's a whole album with that name! :O
[07:45:23] <dbaupp> (it is *clearly* a sign. :P )
[07:46:17] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[07:46:30] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[07:47:54] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[07:50:41] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[07:52:26] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Ping timeout)
[07:52:26] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[07:52:43] <jensnockert> I wonder what the probability of this rebase working.
[07:52:47] <jensnockert> *is
[07:53:24] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:57:13] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[07:58:06] *** Joins: vk (vk@moz-389FEE13.hsd1.ca.comcast.net)
[07:58:06] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:59:42] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[08:04:26] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[08:04:35] *** Quits: vk (vk@moz-389FEE13.hsd1.ca.comcast.net) (Quit: vk)
[08:05:12] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[08:06:48] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[08:07:06] *** Joins: vk (vk@moz-389FEE13.hsd1.ca.comcast.net)
[08:10:43] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[08:11:52] <jensnockert> No, `error: no item found for `ty_desc``, but I have a feeling that isn't my fault.
[08:12:02] <jensnockert> Probably my silly way to build rustc that fails that.
[08:13:16] *** Joins: z0w0 (zack@A76ECE44.E8D776F0.D76C0449.IP)
[08:13:51] *** Joins: jaen (jaen@moz-480D78F3.neoplus.adsl.tpnet.pl)
[08:14:17] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:16:00] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:19:20] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[08:19:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Z0H35Q
[08:19:20] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[08:19:45] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[08:22:10] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[08:22:17] *** Joins: sk (sk@A298A44C.54A580E3.78DD174B.IP)
[08:22:52] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:23:24] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[08:24:21] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[08:26:08] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[08:31:58] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:34:46] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[08:35:17] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[08:38:03] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:39:05] *** Joins: Ms2ger (Ms2ger@moz-D6466908.adsl-dyn.isp.belgacom.be)
[08:41:59] *** Quits: vk (vk@moz-389FEE13.hsd1.ca.comcast.net) (Quit: vk)
[08:42:14] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[08:42:52] <cmr> doomlord_: the problem with closures is moving in/out of them is really weird
[08:43:13] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[08:43:21] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[08:43:58] <cmr> optimization, codegen etc will fall into place, but that fundamental semantic difference can't go away I think
[08:44:40] <doener> hm, I wonder if we can avoid to monomorphize things is is_none(), which only deal with a "wrapper" type, and don't care about the contained type
[08:44:59] <doener> s/things is/things like/
[08:45:35] <cmr> doener: do we already have flow analysis strong enough to check which variants are used in a function?
[08:46:21] <doener> no idea
[08:47:02] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[08:48:23] <doener> but is_some()/is_none() don't ever access the contained value. They can get away with None/Some(_) (well, just None would suffice, but my point is that even the Some(_) variant doesn't depend on the contained value, there is no binding)
[08:48:42] <fabiand> hey
[08:48:55] <fabiand> does someone know if there are macros to allow an easier usage of opencl from within rust?
[08:49:43] <doener> hm, generics without trait bounds that only appear as type params might indicate such a function
[08:50:36] <doener> hm, no, might still call a method on the container
[08:53:10] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[08:56:25] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[08:57:02] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:58:17] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[08:59:59] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[09:00:43] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[09:05:35] *** Quits: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com) (Ping timeout)
[09:08:24] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[09:08:46] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:09:33] <cmr> "We feel so strongly about ARC being the right approach to memory management that we have decided to deprecate Garbage Collection in OSX"
[09:09:37] <cmr> (http://sealedabstract.com/rants/why-mobile-web-apps-are-slow/)
[09:09:46] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[09:12:56] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:14:37] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:16:20] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:18:45] *** Joins: wippler (Mibbit@D07773CA.3993C82B.DFAB1F33.IP)
[09:20:46] <wippler> hello, i want to ask about futures in Rust
[09:21:51] <wippler> i think that they are the same thing as Promises
[09:23:16] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[09:23:31] <wippler> so, my idea is to add `then` method to them, this way we will gain more flexibility
[09:24:46] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[09:25:44] <cmr> wippler: our futures are different than defereds ("promises"), afaik
[09:26:19] <wippler> because they may ran simultaneously 
[09:26:48] <wippler> i still think they are the same
[09:27:57] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:28:20] <cmr> they just don't provide the same form of error/success chains right now
[09:28:25] <cmr> maybe they should, I dunno
[09:29:19] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[09:30:58] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[09:31:42] <wippler> consider the function when : [Promise a] -> Promise a , this is a missing feature in the future module
[09:32:43] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[09:34:22] <cmr> wippler: it seems future hasn't seen an update since it was originally written
[09:34:37] <cmr> wippler: if you're up for it, it probably needs a complete rewrite and redesign :)
[09:36:39] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[09:38:14] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[09:38:42] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[09:39:24] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:39:44] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[09:39:44] *** Quits: wippler (Mibbit@D07773CA.3993C82B.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:46:43] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[09:50:29] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[09:51:51] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[09:51:53] *** Joins: BitPuffin (quassel@moz-49828767.cust.tele2.se)
[09:54:12] *** Quits: pyrac (pyrac@EDE6BD92.73C89388.AD05C589.IP) (Ping timeout)
[09:58:53] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[09:59:39] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[10:01:10] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[10:04:11] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[10:04:43] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[10:07:16] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[10:07:48] *** Joins: mib_dqs4ne (Mibbit@D07773CA.3993C82B.DFAB1F33.IP)
[10:08:50] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[10:09:19] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[10:14:57] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:16:49] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[10:17:29] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[10:17:57] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[10:20:14] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[10:20:24] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[10:21:45] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[10:23:18] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[10:28:35] <mib_dqs4ne> Hello, i am new to Rust, new to Git, new to OpenSource, new to Programming...
[10:28:42] <mib_dqs4ne> https://github.com/NawfelBengherbia/rust/commit/0dc2c2844bc83715355b062a2843f4c238e093ff
[10:29:23] <mib_dqs4ne> is this the way people contribute code in Git ? (Edit -> Propose change)
[10:30:17] <cmr> mib_dqs4ne: code, yes, but not ideas.
[10:30:36] <cmr> mib_dqs4ne: you open an issue for ideas, https://github.com/mozilla/rust/issues
[10:30:43] <cmr> Or send something to the mailing list
[10:31:08] <cmr> You should probably send it to the ML and open an issue
[10:31:51] <mib_dqs4ne> mailing list ??? 
[10:32:24] <cmr> https://mail.mozilla.org/pipermail/rust-dev/
[10:32:30] <cmr> erm, https://mail.mozilla.org/listinfo/rust-dev, sorry
[10:32:42] <cmr> (http://en.wikipedia.org/wiki/Mailing_list)
[10:33:28] <mib_dqs4ne> thank you a lot cmr
[10:34:37] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[10:36:08] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[10:36:36] *** Joins: olleharstedt (Thunderbir@moz-80D8890F.ias.bredband.telia.com)
[10:38:04] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[10:40:47] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:41:39] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[10:43:39] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[10:45:29] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[10:47:26] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[10:50:26] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[10:56:26] *** Quits: slaren (slaren@moz-4FB591EB.red-88-24-241.staticip.rima-tde.net) (Ping timeout)
[10:56:34] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[10:59:24] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[11:00:04] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:03:53] *** Joins: slaren (slaren@moz-A50C76EA.red-88-26-56.staticip.rima-tde.net)
[11:06:54] *** Joins: xyproto (alexander@moz-251295DE.members.linode.com)
[11:07:10] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:08:18] <xyproto> Hi, I'm reading this page: http://www.rustforrubyists.com/book/book.html and encountered some examples of for loops, but I get errors when trying them out with rust 0.7. Is it because the way for loops works has changed? Here's what I'm trying to compile? http://ix.io/6Fo. I'm a complete beginner with Rust and am trying to learn the synytax.
[11:08:24] <xyproto> *syntax :)
[11:08:36] <cmr> xyproto: Rust for Rubyists hasn't been updated for 0.7 yet
[11:08:44] <bjz_> rusti: do 10.times { println("hi"); }
[11:08:52] <cmr> Well, it has, Steve just hasn't updated the site yet ;)
[11:09:04] <bjz_> :(
[11:09:09] <bjz_> rusti is not here
[11:09:37] <bjz_> xyproto: I replied to you on freenode #rust
[11:10:09] <bjz_> xyproto: but yeah, you're better off probably looking at the rust tutorial
[11:10:24] <bjz_> http://static.rust-lang.org/doc/tutorial.html
[11:10:35] <xyproto> bjz_: I see, thank you! I'll look at that tutorial instead.
[11:11:04] <bjz_> do 10.times { println("hi"); } /* sugar for: */ 10.times(||{ println("hi"); })
[11:11:07] <sigma> xyproto: http://static.rust-lang.org/doc/tutorial-container.html there to
[11:11:44] <bjz_> xyproto: the iterator sugar is in the process of being revamped
[11:12:02] <bjz_> xyproto: so it looks rather ugly at the moment
[11:12:15] <bjz_> xyproto: but that will be fixed soon
[11:12:18] <bjz_> oh wait
[11:12:25] <bjz_> woops
[11:12:30] <bjz_> for 10.times { println("hi"); }
[11:12:34] <bjz_> not `do`
[11:12:38] <xyproto> with "do 10.times { println("hi"); }" I get two errors, one for "Do-block body must return bool, but returns () here. Perhaps you meant to write a `for`-loop?" and one for "mismatched types: expected `()`but found `bool` (expected () but found bool)"
[11:12:42] <bjz_> *facepalm*
[11:12:49] <xyproto> ah
[11:12:50] <bjz_> sorry
[11:12:55] <bjz_> my bad
[11:13:13] <xyproto> no worries, works now :)
[11:13:15] *** Joins: Sorella (queen@78575561.924F2739.95C8B7C6.IP)
[11:13:32] <bjz_> for basically give you short circuit returns, so it's not just sugar
[11:14:14] <bjz_> but as I say, it's in the process of being revamped - the old internal iterators are being replaced with external iterators
[11:14:27] <bjz_> (I think it's that way around)
[11:14:31] <xyproto> loop {} worked as expected :)
[11:14:39] <xyproto> I see
[11:14:51] <bjz_> yeah, that's the fundamental building block of rust's iteration
[11:14:54] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[11:14:54] <bjz_> loop {}
[11:14:58] <bjz_> and while
[11:15:03] <xyproto> what does ~ in front of a string mean? Like ~"bla bla"
[11:15:11] <bjz_> owned box
[11:15:13] <doomlord> is the do sugar remaining intact
[11:15:17] <cmr> doomlord: yes
[11:15:17] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[11:15:37] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[11:15:37] <bjz_> it basically puts the value on the heap
[11:15:39] <cmr> xyproto: Rust for Rubyists is still a good book, but don't expect the code examples to work right now.
[11:15:45] <bjz_> like malloc/free
[11:15:52] <cmr> xyproto: almost all of it is relevant except some minor details in the code examples
[11:15:55] <xyproto> bjz_: I see, thanks
[11:16:16] <bjz_> xyproto: are you familiar with stack vs heap?
[11:16:26] <xyproto> cmr: yeah, I think it was well written
[11:16:40] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[11:16:43] <xyproto> bjz_: yes, been doing a bit of C, Pascal and assembly, luckily
[11:16:48] <bjz_> xyproto: cool
[11:17:02] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[11:17:06] <bjz_> well ~ basically is like an automatic malloc/free
[11:17:16] <xyproto> great
[11:17:26] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[11:17:30] <xyproto> that will come in handy :)
[11:17:32] <bjz_> it's done statically so there is no overhead
[11:18:13] <xyproto> That is useful. Is @ another type of box?
[11:18:22] <bjz_> gc box
[11:18:31] <bjz_> but that may be library-fied
[11:18:31] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Ping timeout)
[11:18:35] <xyproto> Ah, so @"hi there" is valid as well?
[11:18:40] <cmr> Yes
[11:18:45] <bjz_> the implementation is pretty bad atm
[11:18:47] <bjz_> yep
[11:18:48] <xyproto> nice, it makes sense
[11:18:51] <bjz_> http://pcwalton.github.com/
[11:19:00] <bjz_> there are good posts on there
[11:19:49] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[11:20:21] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[11:20:39] <bjz_> xyproto: it's good you know a bit of manual memory management. Rust has the same semantics, but the repetitve stuff is done automatically, and lifetimes are checked at compile time.
[11:21:59] <bjz_> xyproto: there is always the unsafe {} escape hatch though, and for C interop there are unsafe pointers
[11:22:03] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[11:22:20] <bjz_> but you rarely need it unless your doing more low level stuff
[11:22:25] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:23:25] <bjz_> xyproto: what is your interest in rust?
[11:23:50] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[11:24:24] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[11:25:02] <doomlord> going from C to Rust without C++ in the middle would be great
[11:25:11] <doomlord> interop between them is good
[11:25:20] <doomlord> you dont have to throw anything away
[11:25:26] <bjz_> *very* good
[11:25:45] *** Quits: mye (mye@moz-E79A8420.dip0.t-ipconnect.de) (Quit: mye)
[11:25:50] <bjz_> bar varargs, and unions
[11:25:51] <xyproto> bjz_: I'm thinking that it might be the right choice for writing a "demoscene" demo, or a 3D-game, for fun.
[11:25:58] <bjz_> awesome
[11:25:59] <xyproto> bjz_: or a soft synth
[11:26:10] <bjz_> I'm working on that kinda stuff
[11:26:29] <doomlord> heh again :) rust could become the language of choice for graphics enthusiasts
[11:26:37] <bjz_> xyproto: https://github.com/bjz/glfw-rs
[11:26:48] <xyproto> bjz_: yeah, I saw the glfw-rs repo, even reported an issue the other day :)
[11:26:52] <bjz_> xyproto: I'm also working on some 3d maths stuff
[11:26:55] <xyproto> bjz_: looking good
[11:27:01] <xyproto> bjz_: what are you planning to make?
[11:27:16] <bjz_> xyproto: could arty/world/game thingy
[11:28:06] <bjz_> xyproto: still growing the idea
[11:28:40] <bjz_> xyproto: I have the artstyle along, I just need to do lots of the technical groundwork
[11:28:55] <xyproto> Go + Android + OpenGL ES is also looking like a possible combination for a 3D game or demo (github.com/eliasnaur/goandroid). But I should probably not mention that here if the room is full of Rust enthusiasts ;)
[11:29:01] <bjz_> and also get to grips with the interactivity
[11:29:11] <doomlord> does go work on android? (i know its google..)
[11:29:21] <doomlord> ^work well
[11:29:30] <cmr> xyproto: Go and Rust solve different problems
[11:29:31] <bjz_> xyproto: we have notheing against Go
[11:29:32] <xyproto> doomlord: yes, but it seems like it's this one guy that made it possible, not Google. I tried it and it works well.
[11:29:45] <bjz_> xyproto: nor even D
[11:29:52] *** Quits: Mowah (Mowah@moz-7A6BF5A3.cust.bredbandsbolaget.se) (Ping timeout)
[11:30:23] <xyproto> I tried D before they sorta got their act together with regards to the standard library and had a bad experience, but it's looking good now
[11:30:29] <doomlord> i find rust more readable due to the colon before types
[11:30:50] <doomlord> but the main thing is the memory model
[11:30:51] <cmr> Rust does work on android though
[11:30:51] <bjz_> xyproto: and we recognise the strengths of C++, and draw many ideas from it
[11:31:29] <bjz_> xyproto: well, I mean "we" loosely
[11:31:51] * bjz_ waves hands at community
[11:32:02] <xyproto> Yes, I think Rust fills a role that Go, D, C and C++ doesn't: the combination of: modern syntax, being well suited for "realtime" and good control over memory management without it being overly cumbersome
[11:32:30] <dbaupp> doener: I believe there is an LLVM pass (merge-funcs) that'll merge functions that have the same body
[11:32:30] <doomlord> its a unique blend, but largely a cleaned up c++11 to my mind
[11:32:43] <doomlord> and i mean that in a good way
[11:33:06] <cmr> xyproto: And the manual memory management is *safe*
[11:33:51] <xyproto> doomlord: yeah, a subset of c++11 is "clean", I guess, but there's so much else that comes with the package
[11:34:02] <xyproto> doomlord: which is problematic for teams, IMO
[11:34:33] <xyproto> doomlord: since everybody will code C++ in their own special style and often not be able to easily read the code that other people have written in a different style of C++
[11:34:39] <doomlord> rust is the langauge i want from experience  with C++, it fixes 2 specific problems for me.
[11:35:07] <doomlord> xyproto agree. in particular i dont like the way c++ classes create too much context. lack of extention methods.
[11:35:12] <xyproto> cmr: that's a very good point
[11:35:18] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[11:35:18] <dbaupp> doener: I think it breaks stuff because of trans' borkedness so it's not activated; you'll have to talk to aatch about it for more details.
[11:35:26] <doomlord> wheras in rust you can just bolt on more impl's where and when you need
[11:35:26] <bjz_> xyproto: http://www.reddit.com/r/rust/comments/1i30sw/herb_sutter_describes_rust_c_questions_and/ :P
[11:35:28] <cmr> xyproto: it's not just a good point, it's the whole reason for Rust's existence
[11:35:37] <xyproto> cmr: :D
[11:35:42] <xyproto> cmr: yes
[11:36:05] <bjz_> xyproto: a bit of an underhanded title by your-truly
[11:36:14] <bjz_> *yours-truly
[11:36:30] <bjz_> :)
[11:36:43] <Seldaek> how easy would it be to bind a rust lib from a C program (like to link a rust lib as a python/php/ruby/.. extension for example)?
[11:37:13] <cmr> Seldaek: fairly easy
[11:37:30] <bjz_> does this help? http://brson.github.io/2013/03/10/embedding-rust-in-ruby/
[11:37:33] <cmr> Seldaek: at least the same as it would be in C++
[11:37:43] <cmr> You need extern "C" functions
[11:37:53] <cmr> ssbr was working on writing python extensions
[11:38:03] <Seldaek> ok so C remains the lowest common denominator in a way
[11:38:29] <doener> dbaupp: ok, thanks
[11:38:29] <cmr> yup. probably always will be
[11:38:31] <dbaupp> Seldaek: https://bitbucket.org/devin.jeanpierre/pyrite
[11:39:03] <Seldaek> thanks, I'll take  a quick look, not that I am really attempting this now anyway, mostly curiosity
[11:39:09] <bjz_> Seldaek: I'm not sure Rust has a chance to unseat it, tbh
[11:39:11] <dbaupp> Seldaek: (Rust-in-Python, no idea how modern that library is.)
[11:39:20] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[11:39:27] <Seldaek> bjz_: of course if it ever happens that's a 30 year long project at this point :)
[11:39:28] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[11:39:48] <bjz_> aye
[11:39:51] <Seldaek> bjz_: but if there is not even a way forward then we're screwed, that's why I asked
[11:40:01] <dbaupp> cmr: is ssbr devin.jeanpierre?
[11:40:05] <cmr> The C ABI is simple and effective.
[11:40:07] <cmr> dbaupp: yes
[11:40:14] <dbaupp> heh, cool.
[11:40:18] <cmr> Even if C goes away, I very much doubt the ABI for interop will
[11:40:26] <bjz_> Seldaek: hopfully C binding will become less needed as the Rust libs improve
[11:40:28] <doomlord> C lives on for its simplicity... every other language can argue over how object systems and generics etc work
[11:40:30] *** Quits: z0w0 (zack@A76ECE44.E8D776F0.D76C0449.IP) (Client exited)
[11:40:36] <bjz_> yes
[11:40:56] <doomlord> C is like a fixed gear bike
[11:41:13] <Seldaek> bjz_: yeah my point was more that if you want to write an universal lib right now you kinda have to go for C/C++, the rest (like C# binding & co) is usually just hackery 
[11:41:27] <bjz_> yup
[11:41:43] <Seldaek> so if rust bindings can be achieved without the hackery feeling that's nice
[11:41:45] <sigma> rust will be in the same space as c and c++ (when the runtime is done)
[11:42:07] <dbaupp> (and when the standard libs support running without a runtime better)
[11:42:18] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:42:30] <sigma> that'll be an interesting project
[11:43:14] <dbaupp> yeah, even just breaking out the things that don't need the runtime into a separate crate would be nice
[11:43:25] *** Joins: mye (mye@moz-E79A8420.dip0.t-ipconnect.de)
[11:43:40] <dbaupp> (e.g. the numeric traits, a whole pile of utility methods on strings and vectors, iterators, etc.)
[11:44:20] <SiegeLord> Yeah, Rust's "runtime" is pretty huge
[11:44:32] <dbaupp> there was one proposal to call this hypothetical crate 'core' and return to Rust's glory days
[11:44:37] * dbaupp likes this proposal
[11:44:57] <SiegeLord> I was just thinking about naming it core XD
[11:45:22] <sigma> you could actually get a lot done with that just...
[11:45:25] * sigma wants
[11:46:24] <Seldaek> this chatlog would make for a good comic I'm sure. "hey guys it's been two weeks we didn't shuffle half the code around!" 
[11:46:38] <dbaupp> SiegeLord: yeah, I know I came up with calling it core independently of cmr (who was the first to publish the idea, I think), as did many others, I'm sure.
[11:46:38] <Ms2ger> Pushing more into libs seems like a good idea in general
[11:46:50] <cmr> dbaupp: I published the idea?
[11:46:57] <dbaupp> Ms2ger: the whole runtime is going into libs ;P
[11:47:05] <cmr> This is the first I've heard of it
[11:47:05] <dbaupp> cmr: in a reddit comment?
[11:47:08] <cmr> Maybe
[11:47:10] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[11:47:11] * cmr has a poor memory
[11:47:14] <dbaupp> (maybe it was bjz_?)
[11:47:27] * dbaupp thinks there are too many people with 3 letter names
[11:48:03] * dbaupp is easily confused
[11:48:05] <SiegeLord> Maybe they are boring and those are their initials :P
[11:48:11] <bjz_> yep
[11:48:13] <cmr> that's the case for me
[11:48:17] <bjz_> I am booooring
[11:48:29] <bjz_> boring boring boring
[11:48:32] <SiegeLord> Their passwords are probably their dates of birth ;)
[11:48:42] * jensnockert wants to be boring too.
[11:48:43] <bjz_> dangit!
[11:48:46] <cmr> my passwords are 50 chars of random made by keepass, thank you!
[11:48:55] *** dbaupp is now known as hgw
[11:48:57] <bjz_> I knew I should have chosen my phone number
[11:49:04] * hgw is known boring too
[11:49:06] <hgw> *now
[11:49:11] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:49:12] *** hgw is now known as dbaupp
[11:49:17] *** bjz_ is now known as boring
[11:49:22] <boring> blahugh
[11:49:26] <dbaupp> (that was weird, being a different person.)
[11:49:27] <boring> blaughbfhgy
[11:49:29] <Seldaek> cmr: don't you love it when the form only lets you enter 30 chars though? :p
[11:49:36] *** Joins: jclements (jclements@B05857CA.9404221D.EB48B30D.IP)
[11:49:37] <boring> dbaupp: I know
[11:49:48] <boring> I have a new persona
[11:49:52] <cmr> Seldaek: or 12, which is the worst.
[11:50:03] <dbaupp> boring: hahaha
[11:50:05] <cmr> Seldaek: Or it just outright gives you a 500 when your password is too long
[11:50:15] <boring> dbaupp: how am I holding up? am I boring enough for you?
[11:50:24] <boring> dbaupp: blahhh blah blah blah
[11:50:40] <Seldaek> cmr: true. I had to limit a form to 30 chars recently to comply with a retarded auth API we had to use. One of those sad moments of life.
[11:50:45] * dbaupp dislikes these damn australians
[11:51:03] <boring> dbaupp: yeah I hate Aussies too
[11:51:13] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[11:51:25] <boring> dbaupp: they can't pronounce thungs correcte
[11:51:33] *** boring is now known as bjz
[11:51:36] <bjz> :)
[11:51:37] <dbaupp> bjz: hahaha
[11:51:58] <dbaupp> (for those listening at home, bjz and I are both australian... no hate-speech here :) )
[11:52:11] <bjz> yes!
[11:52:23] <bjz> it's allowed if it's self inflicted!
[11:52:35] <bjz> boring is austalian too
[11:52:40] *** bjz is now known as boring
[11:52:43] <boring> correct
[11:52:49] *** boring is now known as bjz
[11:52:52] <bjz> see?
[11:53:04] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Bye!)
[11:53:08] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:53:15] <Seldaek> I worked with someone from NZ for a while so I picked up this disdain for aussies despite myself :p
[11:53:38] <dbaupp> hahaha
[11:53:57] <Seldaek> they feel so strongly about this
[11:54:11] <Seldaek> it's one of the best ways to piss them off, calling them australian
[11:54:11] <bjz> haha
[11:54:30] <bjz> love that episode of the flyuing concordes
[11:54:41] <doomlord> what sort of things are people (outside of mozilla) doing in rust *other* than gl
[11:54:44] *** Quits: mib_dqs4ne (Mibbit@D07773CA.3993C82B.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:55:05] <cmr> doomlord: I want to write a wayland compositor
[11:55:39] <cmr> And a minecraft map generator
[11:55:41] <Seldaek> doomlord: I'm mostly using it as an excuse to waste time here instead of working I'm afraid 
[11:56:05] <dbaupp> doomlord: there's an interest in it for scientific computing
[11:56:15] <dbaupp> doomlord: not sure if there's much solid in that direction though.
[11:56:32] <doomlord> on the subject of related itches, i dont enjoy any window managment combination on linux as much as mac osx's spaces/expose and mission-control (now its fixed with unbundled) .. plus the trackpad. it would be nice to fix that :)
[11:56:59] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[11:57:52] <cmr> But I, too, am working with rust with the end goal of a game in mind..
[11:58:05] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[11:58:25] *** Joins: samin (Mibbit@6A060A16.FDE72661.C3498625.IP)
[11:58:38] <doomlord> does the rust community have a wishlist of things it needs to help 'gain acceptance' 
[11:58:59] <Seldaek> one thing that I would like to do as a windows user is to rewrite most unix utils in rust to have them work cross-platform instead of relying on this mingw crap
[11:59:05] <cmr> right now it's mostly libraries that are missing I think
[11:59:15] <Seldaek> I doubt I'll ever have the time for it though
[11:59:34] <cmr> Oh, that's a good idea
[11:59:44] <doomlord> i would guess the community can fill the gaps with libraries pretty quickly 
[11:59:44] <cmr> Replace the slow, bloated GNU stack with something rusty
[12:00:12] <Seldaek>  i think it would be awesome at this point to reboot the whole thing
[12:00:35] <Seldaek> the problem space is well understood by now and it'd be a good opportunity for cleaner code and perhaps eliminating a few weird legacy things
[12:00:58] <cmr> Powershell offers an interesting take on it.
[12:00:58] <doomlord> so you mean literally rewriting things like grep and so on ?
[12:01:11] <Seldaek> yes I mean literally a crapton of work :)
[12:01:21] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:01:21] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/jD-tHQ
[12:01:21] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:01:24] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:01:24] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/uXOpOA
[12:01:24] <ghrust> 13rust/06auto 146999b53 15blake2-ppc: cmp: Use default methods in trait Eq, require only Eq::eq
[12:01:24] <ghrust> 13rust/06auto 149c22f65 15bors: auto merge of #7799 : blake2-ppc/rust/eq-default, r=sanxiyn...
[12:01:25] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:01:28] *** Joins: mib_acrunq (Mibbit@D07773CA.3993C82B.DFAB1F33.IP)
[12:01:58] <doomlord> start a github project for it :)
[12:02:03] <Seldaek> cmr: powershell is interesting I suppose, but I want stuff that works across platforms, and the main CLI platform is unix so it'd have to be compatible
[12:02:37] <Seldaek> I develop on windows but I host everything on linux, and even on my machine I use unix tools as much as I can on CLI
[12:02:56] <cmr> Mm
[12:02:59] <Seldaek> I don't really think it's possible to gain acceptance if you break "cognitive" BC 
[12:03:23] <doomlord> an extreme case of what we're up against is that lpapp chap
[12:03:53] <sigma> yeh, that was an odd back and forth
[12:04:07] <cmr> doomlord: what we really need before marketing and such is a working, efficient compiler with a great runtime :p
[12:04:08] <doomlord> he talks to me about c++ a lot , i pestered him into trying to visit this channel :)
[12:04:30] <dbaupp> that didn't go so well :P
[12:04:47] * dbaupp couldn't understand their "logic" at all
[12:04:54] *** Joins: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net)
[12:05:42] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[12:05:59] <doomlord> well i try to take in others viewpoints. my own personal reservation about devoting time to rust is - spending time in what could just be a fringe language. even if it is my *perfect* language r.e. any choice *i* might make.
[12:06:30] <doomlord> but that lpapp chap goes much  further than that, with irrational defense of the "C++" way. 
[12:07:57] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[12:08:09] <monk> doomlord: are you referring to some blog post or something?
[12:08:13] <sigma> I'll be using rust for personal projects if nothing else, I'm pretty sure it'll actually help my c++ programming, justby making me more aware of the implications of what I'm doing
[12:08:20] <cmr> monk: no, conversation in IRC
[12:08:28] <sigma> monk: a guy who was in the channel yesterday
[12:08:41] <doomlord> just conversations i have
[12:08:48] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[12:09:08] <doomlord> "fn is intolerable, but unique_ptr instead of ~ is much better!!" etc
[12:09:23] <sigma> that was confusing
[12:09:28] <cmr> I don't really understand the syntax bikeshedding..
[12:09:33] <doomlord> the guy is bonkers basically.
[12:09:42] <cmr> I care 10x more about semantics than syntax, syntax is minor niggles
[12:10:46] <SiegeLord> Until we get a direct to brain parser, syntax is still very important :P
[12:11:05] <doomlord> sigma, yes i was re-assuring myself the same way, the exact same mindset goes across, except rust is *strict* safe programming
[12:11:50] <dbaupp> cmr: especially when it's suck a ridiculously small complaint about the syntax
[12:11:57] <sigma> I much prefer rust's syntax, but then again I like the python "explicit > implicit" bit
[12:11:59] <dbaupp> *such
[12:12:13] <doomlord> i was always curious if a language could work with s-expressions pretty-printed and compiled by an editor - but this never appeared for lisp as far as i know.
[12:12:46] <monk> cmr: thanks, was just reading it. I got bored though, seemed the main complaint was about "fn" - wtf!?
[12:12:48] <doomlord> (making editing syntax a user preference, and malleable.. change it based on analysis of actual code )
[12:12:51] <SiegeLord> If you think syntax is unimportant, try coding in comic sans ;)
[12:12:59] *** Quits: jclements (jclements@B05857CA.9404221D.EB48B30D.IP) (Quit: jclements)
[12:13:33] <cmr> SiegeLord: I didn't say it was unimportant, just 10x less important than semantics
[12:14:18] <cmr> afaik there hasn't been a syntax change since 0.5
[12:15:18] <samin> any spanish are here?
[12:15:31] <SiegeLord> 10x less important means unimportant :P
[12:15:36] <sigma> cmr: that's what finally persuaded me to try out the language, I've been lurking since around 0.2. Seeing the syntax stabilise was what I was waiting for
[12:15:38] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[12:16:28] <SiegeLord> Syntax is like the door to the bank... it's what inside the bank that counts, but if you can't open the door... you won't get to it
[12:16:37] <dbaupp> cmr: there has been a few, I think
[12:16:47] <cmr> dbaupp: what?
[12:16:51] <dbaupp> cmr: well, there's been at least one that accepts strictly more programs
[12:17:16] <doomlord> let me check the boundaries of terms... is C++ header files a *syntax* issue (ambiguous grammar)
[12:17:21] <dbaupp> cmr: until a few days ago the mut in `trait Foo { fn foo(&self, mut x: int) { println(x.to_str()) } }` din't parse
[12:17:22] <cmr> doomlord: no
[12:17:26] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[12:17:36] <cmr> dbaupp: well that's a bug, no?
[12:17:46] <dbaupp> cmr: yes, but it is a syntax change
[12:17:53] <dbaupp> cmr: also copy patterns
[12:18:00] <dbaupp> (i.e. binding by copy)
[12:18:00] <doomlord> ^ i mean inability to remove headers from the language .. (they're needed to disambiguate)
[12:18:03] <cmr> ah, copy patterns yeah
[12:18:13] <cmr> doomlord: they aren't needed to disambiguate though, afaik
[12:18:30] <cmr> doomlord: you just need a declaration before a definition to use it something before defining it
[12:18:32] <doomlord> provide context then .. whats the term (distinguishing   a<b>c() ... )
[12:18:33] <monk> needed to disambiguate between what and what?
[12:18:53] <doomlord> a<b>c(); could be any number of things depending on definitions
[12:18:53] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[12:19:09] <doomlord> a*b;
[12:19:21] <doomlord> either an operator function call... or a variable declaration
[12:19:35] <doomlord> i'm thinking of that as 'ambiguous syntax' , is that right?
[12:19:54] <cmr> I don't know the answer to that but what does it have to do with header files?
[12:20:01] <bstrie> samin: you might be the first :)
[12:20:27] <doomlord> header files provide the context to disambiguate it. you can't 'parse the syntax' without scanning the headers in the right order to find what 'a' is
[12:20:41] <doomlord> ("parse the syntax" / "lexically analyze" ? )
[12:21:11] <dbaupp> doomlord: any method for loading metadata about other "modules" would presumably work
[12:21:18] <monk> indeed
[12:21:46] <doomlord> but you can't parse a module in the first place, in isolation
[12:21:48] <monk> hmm
[12:21:56] <monk> yes, that is awkward
[12:22:00] <dbaupp> although the order dependence & Turing completeness(?) of CPP might make this wrong.
[12:22:05] <doomlord> the point is the parsing is defined by header file inclusion order
[12:22:13] <monk> the metadata would have to be loaded at parse time, yes
[12:22:17] <dbaupp> doomlord: yeah, I agree with you
[12:22:40] * dbaupp is fairly sure Rust will end up doing metadata-loading at parse time too
[12:22:50] <SiegeLord> doomlord: You can have context-free grammar with header files
[12:22:53] <SiegeLord> E.g. D does
[12:23:16] <SiegeLord> C++ will have the a*b; problem forever
[12:23:21] <SiegeLord> Even if they remove headers
[12:23:43] <doomlord> if they could add optional keywords to disambiguate.. you might be able to clean up code?
[12:23:57] <monk> doomlord: I'd agree with you that it's a syntactic issue that you need a symbol table just to parse the language
[12:24:05] <monk> as you can solve this problem by changing the syntax
[12:24:13] <SiegeLord> C++ doesn't even have headers in the language (I need to double check that)
[12:24:28] <cmr> CPP is part of the spec I thought
[12:24:53] <doomlord> my perception was  : "cleaned up syntax is a big part of Rusts' appeal" ..  for this exact reason. its easier to refactor code
[12:25:19] <doomlord> when i write in C++, because i'm so lazy with prototypes/hedaers, i start withing code 'backwards' to self-declare  in one module
[12:25:25] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[12:25:34] <SiegeLord> There are many benefits to good syntax... context-free is a good start
[12:25:35] <doomlord> then i need to faff around when i actually want to break it up into modules
[12:25:40] <SiegeLord> And Rust wants to go even further beyond
[12:25:56] <doomlord> thats the bit where i find C++ gets in they way, and it worsened the situatin compared to C
[12:25:59] <SiegeLord> To LL(1) syntax (I'm not an expert in what that means)
[12:26:32] <monk> only have to look one token ahead while parsing
[12:26:47] <doomlord> its such a pleasure to be able to just sit down and code without worrying about that, and freely move code around
[12:27:26] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[12:28:38] <bstrie> SiegeLord: D has headers?
[12:28:47] <monk> doomlord: it also makes reading diffs much less painful
[12:29:07] <doomlord> right .. thats something i remembered i should have brought up in the argument with lpapp
[12:29:18] *** Quits: olleharstedt (Thunderbir@moz-80D8890F.ias.bredband.telia.com) (Ping timeout)
[12:29:21] <doomlord> when code is being *merged* its potentially a broken mess
[12:29:45] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[12:29:49] *** Quits: mib_acrunq (Mibbit@D07773CA.3993C82B.DFAB1F33.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:30:06] <SiegeLord> bstrie: In two senses: First, to import a module you must have access to the module's source
[12:30:21] <doomlord> i instinctively think "fn" is a great idea, is that a possible reason. its harder to 'break' or easier to see what the syntax should be if it 'gets broken' (by merge conflicts etc)
[12:30:30] <SiegeLord> Second, there are these .di files which are "reduced" versions of modules
[12:30:36] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:30:43] <SiegeLord> You can automatically generate .di files, but last I checked the process was imperfect
[12:30:44] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Connection reset by peer)
[12:30:47] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:30:57] <doomlord> ouch, i didn't know D had headers
[12:31:06] *** Joins: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de)
[12:31:09] <doomlord> if it does, that'll be why i haven't bothered with it
[12:31:12] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[12:31:24] <SiegeLord> doomlord: They fulfill your desire for automation though :P
[12:31:30] <doomlord> ok
[12:31:39] <SiegeLord> Although, in practice you may want to do them manually
[12:32:21] <SiegeLord> Like the runtime and the standard library are installed as headers
[12:32:51] <SiegeLord> Well, some things are... as I said, it's not a perfect process (nothing is in D, imo :P)
[12:33:15] <cmr> D always felt large and messy to me
[12:33:21] <cmr> All the features you could ever want
[12:33:34] <SiegeLord> In fact there's only one .di file installed... that's surprising
[12:33:46] <SiegeLord> I remember there being more, maybe they were just too broken
[12:34:09] <SiegeLord> .di files act as an optimization and as code hiding for proprietary libraries
[12:34:21] *** Quits: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de) (Ping timeout)
[12:34:26] <SiegeLord> Anyway, Rust's solution is better :P
[12:34:33] <cmr> That's something Rust hasn't really put much thought into
[12:34:40] <cmr> Obfuscation/code hiding
[12:34:46] <cmr> We write AST to object files for inlining
[12:34:52] <SiegeLord> I think you just don't do #[inline] and you're set
[12:35:05] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:35:06] <cmr> yeah..
[12:35:10] <SiegeLord> Just add a lint check for that and you done
[12:35:11] <cmr> maybe we could write IR instead?
[12:35:12] * cmr dunno
[12:35:27] <SiegeLord> It's no worse than in C++
[12:35:37] <SiegeLord> And nobody cares about that there (afaik)
[12:35:38] <doomlord> its a shame , what you bring up there...
[12:35:50] <doomlord> language design r.e. proprietary libraries...
[12:35:51] <SiegeLord> (that you have to put inline functions inside the headers)
[12:35:53] <cmr> SiegeLord: that's a good point, huge header libraries etc
[12:35:55] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: WeeChat 0.4.1)
[12:36:18] <SiegeLord> That said, in C++ you can pre-instantiate some templates... can't do that in Rust afaik
[12:36:35] <monk> I was just wondering about that :P
[12:36:35] <SiegeLord> I don't know if that's used for code hiding though
[12:37:02] <doomlord> in an ideal world a modern langauge would be oriented toward opensource; also i know some commercial libraries *do* ship full source (admitedly with close licencing arrangements)
[12:37:30] <doomlord> in an ideal world, there should not be a need for a language to enable source hiding
[12:37:44] <SiegeLord> doomlord: Meh, it's the world we live in... I think making tools work against proprietary software tends to backfire
[12:37:46] <cmr> unfortunately this is earth
[12:38:41] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[12:39:07] *** Quits: samin (Mibbit@6A060A16.FDE72661.C3498625.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:39:13] <doomlord> i suppose IDE support is the most productive addition the community could make toward furthering language acceptance
[12:39:15] <SiegeLord> Imo it's better to personally not give money to proprietary software and work on making FOSS better
[12:39:31] <SiegeLord> Rather than to be antagonistic... it's just not productive
[12:39:48] <cmr> doomlord: oh, definitely
[12:39:51] <cmr> I forgot about IDE support
[12:39:54] <cmr> that'd be a huge step
[12:39:58] <dbaupp> doomlord: and having a compiler that isn't like treacle :P
[12:40:13] <dbaupp> cmr: how's rustdoc_ng going, btw?
[12:40:17] <sigma> and doesn't have random bugs :)
[12:40:25] <cmr> dbaupp: structs and enums work!
[12:40:28] <dbaupp> cmr: \o/
[12:40:36] <cmr> jedestep has been helping
[12:40:47] <dbaupp> cmr: but trait/impl/fn's don't?
[12:40:54] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[12:40:56] <doomlord> i started to look at libclang myself to see if i could make some sort of partial C++  bindings but there's probably existing code that is further along (swig, bindgen) ...
[12:40:58] <cmr> adding features while I figure out how to get the informatino I want out of rustc :(
[12:41:05] <SiegeLord> For IDE, it'd be great to have an up-to-date Eclipse plugin
[12:41:06] <dbaupp> :(
[12:41:13] <cmr> dbaupp: not yet but they should be easy
[12:41:21] <monk> what I would love from rust is a nice language to compile to various mobile targets :P
[12:41:24] <doomlord> i have a C++ sourcebase, it would be nice to emit a  similar interface for rust ( i can modify my own c++ to make it easier)
[12:41:27] <cmr> he already added type parameterization, which is like 80% of that stuff
[12:41:29] <dbaupp> cmr: listing the attributes on all the items would be cool too (if you're don't already doing it)
[12:41:35] <dbaupp> monk: well, android works
[12:41:37] <cmr> dbaupp: already doing it
[12:41:41] <doomlord> monk i had a bash at getting it on iOS and didn't suceed
[12:41:42] <dbaupp> cmr: \o/
[12:41:51] * dbaupp loves it when people read his mind
[12:41:57] <monk> dbaupp: cool, I should give it a try
[12:42:02] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[12:42:09] <doomlord> monk it required more delving into the compiler / runtime than i thought it would
[12:42:23] <doomlord> iOS is a big interest for me
[12:42:42] <doomlord> i would also like to know if i make an indie game it could end up on ps4..
[12:42:50] <dbaupp> monk: however, integration tests aren't run on android, so it breaks occasionally/sometimes/regularly (I don't know)
[12:42:54] <cmr> monk: if you are going to try, use zero.rs
[12:43:01] <cmr> dbaupp: yichoi cleans it up pretty quickly
[12:43:05] <dbaupp> monk: it's essentially just the samsung people maintaining it
[12:43:14] <dbaupp> cmr: yup, I've helped him a few times :)
[12:43:33] <monk> dbaupp: cmr: thanks for the info
[12:43:36] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:43:44] <dbaupp> doomlord: don't the playstations have a weird architecture?
[12:44:00] <cmr> monk: a big problem doomlord ran into was the whole "huge runtime" thing... zero.rs should allow you to bootstrap with a lot less work
[12:44:02] <monk> doomlord: the fact that rust has runtimeless stuff in mind is what makes me so interested in it
[12:44:08] <monk> yeah
[12:44:30] <dbaupp> (in theory the proper runtime is supported on android.)
[12:44:39] *** Quits: metasyntax (tvenable@moz-63D9B3D.med-web.com) (Quit: Leaving)
[12:44:55] <cmr> it shouldn't be that much work porting the runtime to ios but you'd probably need to touch everything :\
[12:45:21] <monk> cmr: thanks for the advice, though it's more of a "I would love to see it" than I have time to do it :P
[12:45:35] <monk> main problem being I don't have a mac. apple--
[12:45:40] <cmr> ah, yeah :\
[12:46:00] <dbaupp> for runtime porting, it's probably worth waiting until 'newrt' is 'currentrt', as the current C++ is likely to be tossed (isn't it?)
[12:46:18] <cmr> dbaupp: yeah
[12:46:18] <bstrie> the new runtime isn't turned on yet afaik
[12:46:20] <dbaupp> *C++ one
[12:46:25] <dbaupp> bstrie: yeah
[12:46:28] <cmr> bstrie: just needs a RUST_NEWRT=1 though
[12:46:37] <dbaupp> cmr: does it bootstrap?
[12:46:39] <cmr> dbaupp: yup
[12:46:44] <dbaupp> cool!
[12:46:53] <dbaupp> (is it faster?)
[12:46:56] <cmr> dunno
[12:47:03] <cmr> it wasn't for rustc building librustc
[12:47:10] <cmr> but... nothing going on with the runtime there
[12:47:39] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[12:47:45] *** Quits: santiago (santiago@moz-F2B734D2.c3-0.sbo-ubr1.sbo.ma.cable.rcn.com) (Quit: Computer has gone to sleep.)
[12:48:46] <cmr> dbaupp: https://github.com/huonw/rust-malloc woo!
[12:48:57] <dbaupp> :)
[12:49:10] * dbaupp was happy when he got that to work
[12:49:35] <dbaupp> however, I can't work out how to do the mmap syscall properly :'(
[12:50:08] <cmr> strace a jemalloc run :p
[12:50:23] <dbaupp> haha, I've got tabs all open to the source
[12:50:29] <dbaupp> (and of glibc too)
[12:50:37] <monk> :D
[12:50:43] <dbaupp> but I want it to be in asm rather than calling the libc mmap wrapper
[12:50:55] <cmr> right
[12:51:32] <dbaupp> https://github.com/lattera/glibc/blob/a2f34833b1042d5d8eeb263b4cf4caaea138c4ad/sysdeps/unix/sysv/linux/i386/mmap.S probably tells me what I want
[12:51:39] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[12:51:54] <dbaupp> so I should probably just put more effort into using it
[12:51:57] * dbaupp does so
[12:52:02] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:52:40] * sigma is reading a Java program from 1997
[12:52:54] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[12:52:55] * sigma 's head hurts
[12:53:49] * dbaupp has a feeling we have another flamewar developing on the ML
[12:53:51] <dbaupp> :(
[12:54:06] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[12:54:20] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[12:54:32] <sigma> the println thread?
[12:54:43] <dbaupp> yeah
[12:54:49] <sigma> I've been avoiding that one
[12:54:57] <dbaupp> same
[12:55:01] <cmr> me too
[12:55:20] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[12:56:09] <cmr> https://github.com/huonw/rust-malloc/blob/master/zero.rs#L302
[12:56:16] <cmr> ;(
[12:56:46] <dbaupp> cmr: (that's not my code, btw.)
[12:56:50] <cmr> I know
[12:56:59] <cmr> I haven't looked at zero.rs in some time though
[12:57:05] <dbaupp> yeah
[12:57:11] <dbaupp> it's actually way out of date
[12:57:37] <sigma> it's only a proof of concept hack though
[12:57:40] <dbaupp> e.g. strcat's header removal on ~ introduced 2 new lang items
[12:57:43] <dbaupp> sigma: yeah
[12:58:00] <cmr> cleaning up language items would be nice
[12:58:03] *** Quits: KindOne (KindOne@moz-D9D8B25A.dynamic.ip.windstream.net) (Ping timeout)
[12:58:18] <dbaupp> sigma: unfortunately pcwalton hasn't merged either of the two tiny pull requests that bring it slightly up-to-date :(
[12:58:21] <bstrie> could zero.rs be shipped with rust itself as libzero or whatever, and then given its own compiler switch e.g. rustc --zero ?
[12:58:32] <dbaupp> bstrie: that'd be cool
[12:58:33] <bstrie> rather, wondering whether that would be useful
[12:58:53] <dbaupp> presumably it'd have be not-a-hack for it to be shippable
[12:58:55] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Ping timeout)
[12:58:59] <bstrie> Rust Zero sounds like a brand of diet soda
[12:59:06] <bstrie> dbaupp: how is it a hack?
[12:59:07] *** Joins: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu)
[12:59:17] <bstrie> dbaupp: or rather how could it ever possibly be less of a hack :P
[12:59:20] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[12:59:25] <dbaupp> bstrie: it defines a whole pile of things to be abort(), etc, etc.
[12:59:45] *** Quits: mark_edward_mobile (AndChat437@moz-BF7CD60A.dynamic.utc.edu) (Quit: Bye)
[12:59:46] <dbaupp> bstrie: also, the inability to use all the non-runtime dependent things from std
[13:00:15] <dbaupp> and it still depends on libc, so it's not entirely free standing.
[13:00:42] <doomlord_> i like the idea of dividing the std library into a zero compatable subset , and the full thing; if rust is to compete with c you might want to use it on obscure platforms ? dsps.. 
[13:01:01] <doomlord_> microcontrollers
[13:01:35] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[13:02:13] <dbaupp> yeah, although I don't think that low-level stuff is mozilla's goal with the language (yet), so it'll presumably have to be mostly a community driven effort.
[13:02:19] *** Joins: KindOne (KindOne@moz-AAA86A99.dynamic.ip.windstream.net)
[13:03:00] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[13:03:51] <dbaupp> (also, doing a proper split like that would require the ability to leave some langitems undefined, or at least, redefine them in other crates, since some things only make sense with the runtime.)
[13:04:45] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[13:05:41] <cmr> Reintroducing libcore to only have langitems wouldn't be great though, you add a whole extra library to link to for compiletime stuff
[13:05:47] <cmr> once we have static linking not really a problem though
[13:06:01] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[13:07:18] <dbaupp> cmr: well, I'd hope "libcore" doesn't just have langitems: it would have as many of the non-runtime dependent features of libstd as possible
[13:07:34] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[13:08:21] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[13:12:42] *** Quits: StarLight (StarLight@moz-B99C3BFE.dynamic.avangarddsl.ru) (Ping timeout)
[13:15:02] <engla> would that be collections like vec etc?
[13:15:58] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[13:16:29] <dbaupp> engla: &[] and &str yes, all the Iterators and adaptors... maybe ~[]/~str... I don't know.
[13:16:50] <engla> I guess hashmap is dependent on runtime since it uses rand, which uses TLS
[13:17:00] *** Joins: StarLight (StarLight@moz-CD6E4BF2.pppoe.avangarddsl.ru)
[13:17:05] <dbaupp> yeah, and it allocates
[13:17:31] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[13:17:34] <dbaupp> (I guess it depends *how* runtime-less we're aiming for, e.g. if libc counts as a runtime.)
[13:17:47] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[13:17:49] <cmr> the stuff in std::str needs to be genericized so it can work on non-utf-8 stuff
[13:17:58] <dbaupp> it's hard
[13:18:03] <cmr> unicode isn't always desired and not using it is really painful atm
[13:18:20] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[13:18:23] <bstrie> cmr: *unicode* isn't always desired, or utf-8 isn't always desired?
[13:18:23] <dbaupp> why wouldn't use use unicode internally?
[13:18:29] <cmr> bstrie: both
[13:18:50] <cmr> dbaupp: for example on my arduino
[13:18:58] <dbaupp> cmr: i.e. ascii only?
[13:19:01] <cmr> yeah
[13:19:03] <engla> the utf-8 format itself doesn't require any unicode libraries so why not use it?
[13:19:15] <cmr> or the ~40ish characters my LCD display can display :p
[13:19:26] <dbaupp> cmr: there's std::ascii, and it's just a normal old vector [u8] essentially
[13:19:33] <bstrie> cmr: I don't understand why something that needs ascii wouldn't be served by a library that speaks utf-8
[13:19:37] <cmr> dbaupp: but it doesn't have any of the handy string methods afaik
[13:19:49] <cmr> bstrie: and what of alternate encodings?
[13:19:51] <dbaupp> cmr: "handy string methods" such as?
[13:20:02] <dbaupp> cmr: unicode sandwich!
[13:20:18] <cmr> dbaupp: unicode sandwich is hardly the bastion of efficiency
[13:20:25] <bstrie> cmr: right, supporting utf-16 is important. but I'm not convinced that we should bother with anything that's not unicode
[13:20:57] <dbaupp> cmr: (since it's single, plain bytes, most of the string methods can be replaced by vector ones. not all though.)
[13:21:00] <cmr> dbaupp: the iterators, for example
[13:21:20] <dbaupp> cmr: hm? ascii_vec.iter() is exactly what ascii_str.iter() gives you
[13:21:33] <dbaupp> (except one is u8 and one is char)
[13:21:43] <cmr> dbaupp: it has word split iterators and stuff?
[13:21:48] * cmr hasn't looked at ascii in a while
[13:21:50] <dbaupp> cmr: oh, right...
[13:21:57] * dbaupp forgot about them
[13:22:01] <engla> ascii_vec.iter() gives &u8 so it is less convenient
[13:22:20] <dbaupp> cmr: well, ascii.to_str_consume().word_iter() works fine ;P
[13:22:34] <cmr> dbaupp: once again, hardly the bastion of efficiency :p
[13:22:35] <dbaupp> (or ascii.as_str(), if it exists)
[13:22:46] <Seldaek> for performance critical protocol parsing wouldn't ascii be faster than the char stuff though? If you have an ascii protocol that is.
[13:23:10] <dbaupp> cmr: the as_str method should be a noop, so that's not a problem
[13:23:11] <Seldaek> seems to me like the char/str stuff checks whether things are valid utf8 pretty often
[13:23:23] <cmr> dbaupp: should be!
[13:23:46] <dbaupp> Seldaek: yeah, they could/need to be efficient-ised.
[13:23:59] <dbaupp> cmr: I believe it is now, assuming it exists
[13:23:59] *** Quits: mark_edward (quassel@moz-4A9A2F15.dynamic.utc.edu) (Ping timeout)
[13:24:11] <dbaupp> cmr: good old transmute :P
[13:26:27] <bstrie> dbaupp: I demand a benchmark of your allocator versus jemalloc
[13:26:52] <dbaupp> bstrie: can it be of realloc performance?
[13:27:03] <bstrie> dbaupp: I don't know what that means, so sure! :)
[13:27:04] * dbaupp 's allocator is very fast at that
[13:27:33] <engla> it also saves you memory
[13:27:50] <dbaupp> bstrie: it's mean to take a pointer and expand the allocation to a larger size (i.e. re-alloc)
[13:27:54] <dbaupp> bstrie: https://github.com/huonw/rust-malloc/blob/master/malloc.rs#L93
[13:27:58] *** Joins: metasyntax (tvenable@moz-63D9B3D.med-web.com)
[13:28:12] <dbaupp> (Can I get points for (not) trying? :P )
[13:29:06] <dbaupp> bstrie: anyways, I'm currently rewriting it to use mmap rather than brk, because that's what all the cool allocators do.
[13:29:20] *** Joins: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de)
[13:29:54] <bstrie> dbaupp: don't give in to peer pressure
[13:30:37] <cmr> dbaupp: you don't even need to really write an allocator for that you know
[13:30:43] <cmr> just mmap/munmap :p
[13:30:52] <cmr> sure, you waste a page for 4-byte allocations...
[13:31:06] <dbaupp> cmr: right, that was going to be my first strategy
[13:31:21] * dbaupp is going to try to improve on that
[13:32:05] <dbaupp> cmr: but also, doing those syscalls directly from Rust is fun and exciting, I guess.
[13:32:12] <cmr> it is
[13:32:16] *** Joins: Mowah (Mowah@moz-7A6BF5A3.cust.bredbandsbolaget.se)
[13:33:09] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:35:06] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[13:35:10] <ChrisMorgan> With lines like "rust: task failed at 'connection closed', /home/chris/vc/rust/src/libstd/option.rs:313" and RUST_LOG=::rt::backtrace telling me absolutely nothing useful, how can I find out where the task is failing?
[13:35:40] <cmr> ChrisMorgan: gdb
[13:35:40] <dbaupp> ChrisMorgan: gdb
[13:35:45] <cmr> or lldb, as the case may be
[13:35:55] <dbaupp> ChrisMorgan: you put a breakpoint on... something...
[13:35:59] * dbaupp forgets
[13:36:03] <MaikKlein1> does question one make sense to anyone of you? http://www.scribd.com/doc/152928309/Exam
[13:36:52] <dbaupp> ChrisMorgan: begin_unwind might work
[13:38:08] <bstrie> MaikKlein1: I was about to make a joke like "no, but then again I don't speak german". and then I realized that the questions are all in english :|
[13:38:10] <ChrisMorgan> dbaupp: how?
[13:38:34] <sigma> MaikKlein1: yeh, I can see what it's asking
[13:38:44] <ChrisMorgan> "break begin_unwind" doesn't work (not defined)
[13:38:44] <dbaupp> ChrisMorgan: do you know how to use gdb? (genuine question)
[13:38:50] <dbaupp> ChrisMorgan: oh :(
[13:38:59] <Seldaek> MaikKlein1: you want to enforce Expr's to have an accept method, but it's a nasty nitpick of a question IMO
[13:39:11] <dbaupp> ChrisMorgan: yeah, there's some function that does work... can't remember it
[13:39:16] <ChrisMorgan> A little. `run` and `bt` are almost all I've used until a few days ago.
[13:39:17] <MaikKlein1> Seldaek, yeah I realize that, but in this code Expr isn't even used
[13:39:23] <dbaupp> ChrisMorgan: waaait, `upcall_fail` or something
[13:39:24] * dbaupp checks
[13:39:33] <ChrisMorgan> That works.
[13:39:34] <Seldaek> MaikKlein1: sure it is extended yby Add/Literal
[13:39:43] <MaikKlein1> yeah but
[13:39:57] <dbaupp> ChrisMorgan: yup, upcall_fail is in the (C++) runtime, so isn't mangled, but the others are.
[13:39:57] * bstrie doesn't know what the visitor pattern is, and hopes to never know
[13:40:08] <MaikKlein1> Seldaek, but the visitor uses them like void visit(Literal l);
[13:40:17] <Seldaek> MaikKlein1: but technically I guess the Visitor interface should be void visit(Expr e);
[13:40:23] <Seldaek> MaikKlein1: then it would make more sense
[13:40:23] * sigma did a software patterns module in the hopes that it would be easy marks, it was
[13:40:25] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[13:40:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/uXOpOA
[13:40:25] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[13:40:48] <Seldaek> MaikKlein1: anyway that's what you get when you try to make up contrived programming questions I guess, you shoot yourself in the foot
[13:42:13] <ChrisMorgan> Ahhh... that would explain why the little info I could find was from comm rather than net. With "connection closed" I had been assuming it would be the TCP connection rather than the comm stream I set up in my adapter to get extra::net::tcp to act like std::rt::io::net::tcp.
[13:42:21] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[13:44:00] <ChrisMorgan> Hmm... that means I'm stuck, with the knowledge I have. So, I have an object which holds one port and one chan, and another task which holds the respective chan and port, and it's waiting on the port. How can I make it so that it doesn't fail when it gets closed by the chan being destroyed?
[13:44:33] <ChrisMorgan> Oh good, try_recv.
[13:45:03] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:46:04] <ChrisMorgan> Well, that makes it only one subordinate task that fails rather than two :-)
[13:46:32] <sigma> glad we could help :)
[13:47:33] <dbaupp> ChrisMorgan: spawn_unlinked and spawn_supervised might be helpful?
[13:48:42] <ChrisMorgan> dbaupp: I did that for a couple of them, which is why it no longer totally crashes (until you make a second request, anyway). Anyway, this code will be dying when std::rt::io::net::tcp works.
[13:48:56] <dbaupp> ChrisMorgan: oh, cool!
[13:49:01] *** Joins: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP)
[13:49:12] <dbaupp> (I assume you mean that the code will be removed, not that it'll break?)
[13:50:48] <ChrisMorgan> Yeah, it'll be nooked.
[13:51:02] <ChrisMorgan> Hmm... don't like the new failure I'm getting.
[13:52:32] <ChrisMorgan> I had a stream of Option<something>, so with switching from recv to try_recv it ends up Option<Option<something>>: `match self.stream_po.try_recv() { Some(optstream) => optstream, None => None }`
[13:52:34] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[13:52:40] <ChrisMorgan> Now it's failing inside try_recv, "option::unwrap none"
[13:53:25] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[13:53:34] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[13:53:51] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[13:56:54] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[13:57:38] <ChrisMorgan> That, I guess, would be comm.rs, line 681: endp.unwrap(). Any ideas there?
[13:59:09] <ChrisMorgan> (It's a bit hard when you can't compile libstd with -Z debug-info. Please... pretty please... consider that Ultra-High Priority...)
[13:59:11] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[14:00:40] *** Quits: jaen (jaen@moz-480D78F3.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:01:49] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[14:02:25] *** Joins: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com)
[14:04:09] *** Quits: heftig (heftig@moz-52B7107B.dip0.t-ipconnect.de) (Ping timeout)
[14:07:37] *** Joins: heftig (heftig@moz-52B7107B.dip0.t-ipconnect.de)
[14:08:39] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[14:09:11] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[14:13:52] <ChrisMorgan> Hmm... if I have a chan and a closure which uses that chan, then will only the first call actually get it?
[14:16:24] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:17:50] <dbaupp> ChrisMorgan: probably
[14:17:58] <bjz> dbaupp: https://mail.mozilla.org/pipermail/rust-dev/2013-July/004804.html
[14:18:33] <bjz> dbaupp: https://mail.mozilla.org/pipermail/rust-dev/2013-July/004830.html
[14:19:17] <ChrisMorgan> There! I found the bug in Port.try_recv(). Don't call it after it's returned None or it'll fail.
[14:19:18] <dbaupp> bjz: yeah, I saw them. Anything in particular? (that work has sorta stalled btw :( I should really go back and try to clean it up.)
[14:19:31] <ChrisMorgan> Yay, more bug to report!
[14:19:36] <dbaupp> and/or get aatch to do it.
[14:19:54] <jedestep> is it possible to import a local library in rusti
[14:20:31] <dbaupp> acrichto: ^ ?
[14:20:37] <bjz> yeah, I know, I just thought I should bring up that it's been in the discourse before, so that those who were involved aren't left out of the loop
[14:21:00] <MaikKlein1> btw is the reflection in rust?
[14:21:06] <MaikKlein1> there*
[14:21:17] <dbaupp> bjz: yeah, good idea
[14:21:31] <jedestep> MaikKlein1: not much as far as I can tell :(
[14:21:35] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:21:47] <dbaupp> MaikKlein1: there is some
[14:21:57] <bjz> dbaupp: +1 to format specifiers from me
[14:21:57] <dbaupp> e.g. fmt!("%?", ..) uses it
[14:22:38] <jedestep> there doesn't appear to be reflecton on e.g. traits though
[14:22:48] <MaikKlein1> could I do object1.getFields().iter().advance |x| { x.name}?
[14:23:13] <cmr> MaikKlein1: not like that no
[14:23:13] <MaikKlein1> ah hm
[14:23:23] <dbaupp> MaikKlein1: you'd need write a visitor instance
[14:23:23] <MaikKlein1> nvm it doesn't even make sense what I want to do
[14:23:23] <cmr> it's a very convoluted visitor interface
[14:23:37] <dbaupp> MaikKlein1: (it's in std::unstable::intrinsics)
[14:24:55] <MaikKlein1> dbaupp, are intrinsics at runtime or at compile time?
[14:25:13] <dbaupp> MaikKlein1: intrinsics are things built into the compiler, so either
[14:25:22] <MaikKlein1> ok cool
[14:25:34] <dbaupp> MaikKlein1: e.g. move_val is a runtime intrinsic, size_of is a compile time one
[14:25:58] <dbaupp> ("runtime" and "compile time", i.e. they do their work then.)
[14:29:38] <ChrisMorgan> Ooh, I got https://github.com/mozilla/rust/issues/7800
[14:30:15] *** Joins: fabiand_ (fabiand@moz-A0BEF28F.adsl.alicedsl.de)
[14:30:33] *** Quits: fabiand_ (fabiand@moz-A0BEF28F.adsl.alicedsl.de) (Quit: Verlassend)
[14:32:52] *** Quits: igl (igl@moz-D195BFC8.adsl.alicedsl.de) (Ping timeout)
[14:32:55] *** Joins: igl (igl@moz-D9FF6666.adsl.alicedsl.de)
[14:33:44] <engla> graydon said a few things that were important. fmt! should target Writer and it should not allocate, sounds important to me
[14:34:07] <engla> we should get those modern Writer/Reader traits in as soon as possible so rust can being re-molding itself around that
[14:35:02] <cmr> I agree
[14:35:16] <cmr> we should get the newrt asap, even if it isn't as complete
[14:35:48] <dbaupp> (the recent new io stuff has caused a variety of issues I think, unfortunately :( )
[14:35:59] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[14:36:03] <dbaupp> engla: yeah, those goals have been around for a while :)
[14:36:28] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[14:36:34] *** Joins: reyre_ (reyre@moz-2E2F18CB.senecacollege.ca)
[14:36:45] <dbaupp> engla: the plan was for writef!(writer, format, ...), with wrappers fmt!() -> ~str and printf!() (or something) printing to stdout
[14:37:02] <engla> yeah
[14:37:24] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Ping timeout)
[14:37:28] *** Joins: jclements (jclements@FB2EC5AA.2CDE2192.5151CDCF.IP)
[14:37:54] *** reyre_ is now known as reyre
[14:38:00] *** Quits: jclements (jclements@FB2EC5AA.2CDE2192.5151CDCF.IP) (Quit: jclements)
[14:38:22] <dbaupp> gah! why is mmap returning (void*)(-9)?? :'(
[14:38:28] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:40:37] *** Joins: homa_rano (edre@moz-223EA699.csail.mit.edu)
[14:43:46] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[14:44:59] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[14:45:18] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[14:45:39] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:45:42] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[14:47:39] <mark_edward> rusti: use std::hashmap::*; use std::iterator::*; let xs = ~[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6)]; let map: HashMap<int, int> = xs.iter().transform(|&x| x).collect(); map
[14:47:43] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/YMeP
[14:47:51] <ChrisMorgan> dbaupp: EBADF?
[14:48:12] <cmr> dbaupp: do you have MMAP_ANONYMOUS?
[14:48:16] <dbaupp> ChrisMorgan: as far as I can tell, errno is fine
[14:48:19] <dbaupp> cmr: yes
[14:48:48] <ChrisMorgan> (Just wondered whether that was meaning the errno, and EBADF is +9.)
[14:49:15] <mark_edward> think hashmap needs a better TOStr impl
[14:49:28] <cmr> mark_edward: that isn't its ToStr
[14:49:36] <cmr> that's fmt!("%?", foo)
[14:49:39] <dbaupp> rusti: use std::hashmap::*; use std::iterator::*; let xs = ~[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6)]; let map: HashMap<int, int> = xs.iter().transform(|&x| x).collect(); map.to_str()
[14:49:40] -rusti- ~"{5: 5, 2: 2, 3: 3, 6: 6, 1: 1, 4: 4}"
[14:49:52] <mark_edward> cool!
[14:50:02] <mark_edward> isn't that basically JSON?
[14:50:11] <cmr> no, not at all
[14:50:16] <dbaupp> rusti: use std::hashmap::*; use std::iterator::*; let xs = ~[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6)]; let set: HashSet<(int, int)> = xs.iter().transform(|&x| x).collect(); set.to_str()
[14:50:17] -rusti- ~"{(1, 1), (2, 2), (6, 6), (5, 5), (4, 4), (3, 3)}"
[14:50:26] <cmr> json is only string keys
[14:50:31] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[14:50:36] <mark_edward> ah, right
[14:50:41] <dbaupp> mark_edward: it's just calling to_str on each key and each value
[14:50:48] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[14:50:48] <doomlord_> relaxed form of JSON
[14:50:57] <doomlord_> there should be a name for it..
[14:51:05] <mark_edward> RON
[14:51:08] <cmr> njson
[14:51:12] <cmr> :p
[14:51:12] <mark_edward> Rust Object Notation
[14:51:12] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[14:51:14] <doomlord_> and everyone should support it
[14:51:20] <cmr> (for "not json")
[14:51:29] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[14:51:32] <strcat> dbaupp: pass -1 as the fd
[14:51:38] <dbaupp> strcat: I am :)
[14:51:43] <strcat> dbaupp: and 0 as the last param?
[14:51:48] <dbaupp> strcat: yep
[14:51:53] <strcat> MAP_ANONYMOUS|MAP_PRIVATE
[14:51:56] <strcat> for flags
[14:52:14] <dbaupp> http://ix.io/6Fy
[14:53:16] <smvv> hi. I've a few ECs (study points for my university) remaining and it roughly translates to a month of work. I would like to choose an issue of the category "A-an-interesting-project", but i'm not sure what the expected duration of each issue will be. I'm interested in the issue  "add a type-based alias analysis pass" (https://github.com/mozilla/rust/issues/6750), but i've no idea if that's doable in a month.
[14:53:32] <cmr> smvv: they're all different
[14:53:57] <strcat> dbaupp: maybe you should just check for MAP_FAILED?
[14:54:05] <strcat> I don't know if it's guaranteed to set errno to 0 if it succeeds
[14:54:10] <bstrie> smvv: strcat is the one to ask about that
[14:55:03] <dbaupp> strcat: MAP_FAILED = (void*)-1, not (void*)-9
[14:55:22] <dbaupp> strcat: but errno is 0
[14:55:49] <dbaupp> just the return value is nonsense (i.e. writing to it segfaults)
[14:55:52] <cmr> rusti: -9u64 % 4096
[14:55:54] -rusti- 4087
[14:55:59] <cmr> isn't even a page boundary
[14:56:04] <dbaupp> right
[14:56:06] <strcat> dbaupp: -1u wraps
[14:56:08] <strcat> that's the issue
[14:56:15] <dbaupp> strcat: hm?
[14:56:26] <strcat> dbaupp: you should use C types for the parameters
[14:56:33] <strcat> unless there's an exactly equivalent rust one
[14:56:39] <dbaupp> strcat: shouldn't be a problem
[14:56:45] <dbaupp> -1 is the same whatever size
[14:56:52] <strcat> dbaupp: uint is bigger than an int
[14:57:03] <MaikKlein1> ?
[14:57:05] <dbaupp> the representations are all the same
[14:57:13] <MaikKlein1> how can uint be bigger?
[14:57:19] <strcat> MaikKlein1: than a C int
[14:57:25] <strcat> dbaupp: but it's going to truncate it
[14:57:36] <dbaupp> strcat: where?
[14:57:50] <strcat> dbaupp: you're using 'int' when it really takes c_int
[14:58:06] <dbaupp> strcat: yeah, but (-1i64) truncated to i32 is still -1
[14:58:28] <dbaupp> (so my code is wrong, but it should still work... I'm testing the corrected version now.)
[14:58:55] <MaikKlein1> ah if I use int it is real i64?
[14:59:00] <MaikKlein1> on o x64
[14:59:09] <MaikKlein1> a*
[14:59:13] <engla> yeah
[14:59:20] <MaikKlein1> k
[14:59:23] <strcat> it's the same size as uintptr_t/intptr_t
[14:59:50] <dbaupp> nope, still get (void*)(-9) from mmap
[15:00:14] <engla> are you calling it through libc?
[15:00:19] <dbaupp> maybe I'm using the wrong syscall number... but I took it from unistd_64.h
[15:00:20] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[15:00:29] <dbaupp> engla: no, using asm! directly
[15:00:47] <strcat> unistd_64 should be right
[15:00:56] <dbaupp> engla: essentially https://github.com/huonw/rust-malloc/blob/master/syscall.rs, but with a 6 argument one
[15:02:53] <dbaupp> syscall argument order: rdi, rsi, rdx, rcx, r8, r9?
[15:03:28] <strcat> dbaupp: well, can  you double-check that it works with glibc's syscall()?
[15:03:39] <dbaupp> strcat: yeah, I did, and it does
[15:03:43] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[15:03:56] <dbaupp> syscall(9, 0, 1000000, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
[15:03:59] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:04:39] <cmr> And what does strace on your program say is happening?
[15:05:46] <dbaupp> hm
[15:05:47] <dbaupp> mmap(NULL, 1000000, PROT_READ|PROT_WRITE, MAP_FILE, -1, 0) = -1 EBADF (Bad file descriptor)
[15:05:51] <dbaupp> that's my problem
[15:05:55] <dbaupp> cmr: (thanks!)
[15:06:07] * dbaupp hasn't ever used strace for anything useful before
[15:06:17] * strcat uses it to deal with seccomp
[15:06:25] <strcat> to see the failed syscall #
[15:06:38] * engla uses it to track progress on just about any program that seems to be doing something
[15:06:43] <cmr> engla: me too
[15:06:58] <cmr> or when a mediocrely ported steam game crashes
[15:10:18] <dbaupp> hm, somehow 34 is turning into 0 somewhere... presumably the asm is wrong.
[15:10:25] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[15:11:16] <dbaupp> ok, r10 is different rcx... whodathunkit?
[15:12:09] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Ping timeout)
[15:12:57] <strcat> dbaupp: what does errno_location actually do? I guess it's an FFI call returning an addr?
[15:13:17] *** Quits: reyre (reyre@moz-2E2F18CB.senecacollege.ca) (Client exited)
[15:13:21] <dbaupp> strcat: yeah, it seems to be a secret libc function that returns &errno
[15:13:29] * strcat got his rust t-shirt
[15:13:35] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[15:13:44] <dbaupp> strcat: I has mine too! :D
[15:13:57] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[15:14:06] <dbaupp> anyway, mmap now works. thank you everyone for putting up with my stupidity :)
[15:14:40] <strcat> ;]
[15:16:19] <engla> I think the errno macro expands to (*errno_location()) in glibc
[15:16:50] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:16:50] <_Vi> Is there a thing analogous to JNI for Rust? Means you write some Rust traits and data structures, and some tool generate C or C++ headers, so that you can implement things accessible from Rust in C/C++.
[15:16:59] <dbaupp> strcat: https://github.com/lattera/glibc/blob/a2f34833b1042d5d8eeb263b4cf4caaea138c4ad/csu/errno-loc.c
[15:17:09] <cmr> Why is a "mod foo;" private within its own crate? For example in my crate file I have "mod clean; mod jsonify;", but when I go to "use clean;" in jsonify.rs, I get: "unresolved import: found `clean` in `???` but it is private"
[15:17:19] <cmr> I want to be able to access it from mods within my own crate, but not outside my crate.
[15:17:24] <dbaupp> cmr: yes
[15:17:44] <cmr> dbaupp: I don't think that's ever a valid answer to "Why" :p
[15:17:46] <dbaupp> cmr: a crate-private thing would be nice
[15:17:54] <dbaupp> cmr: 'course it is :P
[15:17:58] <cmr> _Vi: No, not really
[15:18:07] <cmr> _Vi: rust structs are already compatible with C
[15:18:14] <cmr> _Vi: traits would be harder, not sure it's possible
[15:18:24] <ChrisMorgan> My favourite answer to "Why?" is "Why not?"
[15:18:44] <dbaupp> cmr: you might be able to do something with the monomorphised trait impls
[15:18:46] <cmr> dbaupp: so I'm not doing it wrong, this is a fact of the module system?
[15:18:55] <dbaupp> cmr: it's currently how it is ys
[15:18:57] <dbaupp> *yes
[15:19:11] <_Vi> cmr, If Rust structure is compatible with C than it should be easy to generate C header that corresponds to Rust structure.
[15:19:21] <dbaupp> cmr: it has unfortunate consequences like things being pub so that the child tests module can test them
[15:19:32] <dbaupp> cmr: it's pretty annoying
[15:19:41] <dbaupp> cmr: there's almost certainly a issue open about it
[15:19:43] <_Vi> cmr, But there also should be a way to "implement" a trait in C/C++.
[15:19:54] <doomlord_> manually rolled vtables...
[15:20:06] <cmr> _Vi: it would be messy and disgusting and highly dependant on rustc's codegen
[15:20:15] <strcat> traits aren't vtables unless you use them as objects though
[15:20:20] <strcat> and that should be rare
[15:20:25] <dbaupp> _Vi: what use case one want to drop down to C/C++ from Rust for? (genuine question)
[15:20:45] <dbaupp> _Vi: (since Rust lets you go all the way down to the metal)
[15:20:46] <_Vi> cmr, Why Java approach (JNI) can't be used in Rust?
[15:20:51] <doomlord_> hedging bets on language adoption
[15:21:03] <doomlord_> writing a program in a mixture of C & Rust ...
[15:21:04] <_Vi> dbaupp, To have a nice way of making Rust bindings to whatever.
[15:21:39] <_Vi> dbaupp, "since Rust lets you go all the way down to the meta" -> I've heard such thing before about "LISP all the way down"...
[15:21:55] <cmr> Uh, lisp is a different story
[15:21:59] *** Joins: sankha93 (Instantbir@A67ECFA2.4F1E6D7D.E7DAB6F9.IP)
[15:22:10] <dbaupp> _Vi: down to the metal properly :P I've been doing syscalls directly in Rust just now, and the work fine.
[15:22:13] <cmr> _Vi: Anyway, we have `extern "C" fn`, we don't need JNI
[15:22:17] <doomlord_> rust really can work 1:1 with C , asside from the stack safety difference
[15:22:20] <cmr> Or a JNI-alike
[15:22:30] <doomlord_> unsafe fn ... 
[15:22:49] <dbaupp> _Vi: anyway, Rust is designed to be very C-compatible so, as cmr says, we don't need a JNI-like thing
[15:22:50] <SiegeLord> Yeah, I'd limit this feature to spitting out a header based on contents of extern "C"
[15:22:56] <dbaupp> _Vi: you can just write your bindings in Rust
[15:23:00] <cmr> The inverse of rust-bindgen
[15:23:16] <dbaupp> or am I thinking about this the wrong way around?
[15:23:16] <cmr> should be easier than what rust-bindgen does now ;p
[15:23:26] *** Quits: MaikKlein1 (maik@moz-8979DBF5.dip0.t-ipconnect.de) (Ping timeout)
[15:23:36] <_Vi> "JNI-alike" means "My move: write Rust interface. Tools' move: generate C headers. My move: provide implementation. Tools' move: compile them together".
[15:24:35] <_Vi> dbaupp, "you can just write your bindings in Rust" -> Can be rather tricky without completely understanding the domain and digging down to the low-level things.
[15:24:37] <dbaupp> _Vi: just to check... do you want to write bindings to call other languages/libraries from a Rust program, or the other way around?
[15:24:48] <doomlord_> might trait objects have a use in c/c++ projects .. since they are a different style of binary layout , and can do things C++ classes cant.  (i think of how COM objects are not specific to any language)
[15:25:59] <_Vi> dbaupp, There should be Rust calling C libraries which call back to Rust code. And C libraries calling Rust code which callbacks to C.   Having only one way is too limiting.
[15:26:34] <bstrie> _Vi: we should be able to do both by now
[15:27:09] <dbaupp> _Vi: well, there is the rust-bindgen tool which converts a C header into the equivalent Rust (with all the functions/structs etc)
[15:27:28] <strcat> doomlord_: http://www.boost.org/doc/libs/1_54_0/doc/html/boost_typeerasure.html
[15:27:55] <_Vi> dbaupp, Maybe there should be also be reverse-rust-bindgen?
[15:28:22] <doomlord_> i just tried to compile rust-bindgen, i get an error on "unresolved import   use il = types;" ... sdhould i just grab rust again, mine is built 2013-07-01
[15:28:37] <cmr> _Vi: You'd still have to write the `extern "C" fn`s yourself, a tool can't do that for you.
[15:28:40] <_Vi> Looks like rust-bindgen is not in main Rust repository, but is a separate project...
[15:28:48] <bstrie> doomlord_: try and use the most recent rust, yeah
[15:29:00] <cmr> _Vi: correct.
[15:29:10] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[15:29:52] <dbaupp> _Vi: yeah, it just takes someone to write it ;P
[15:30:12] <dbaupp> (having libsyntax separate makes writing tools like that pretty easy)
[15:30:15] <_Vi> "Requirements: clang 3.1 and up" -> (Probably it would be a problem to just build it and play with it...)
[15:30:43] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[15:30:48] <dbaupp> what version of clang do you have?
[15:30:52] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Input/output error)
[15:31:04] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[15:31:19] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[15:32:11] <_Vi> Debian clang version 3.0-6.2 (tags/RELEASE_30/final) (based on LLVM 3.0)    Target: i386-pc-linux-gnu
[15:32:29] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:33:16] <dbaupp> _Vi: ah
[15:33:24] <dbaupp> you're on debian stable?
[15:34:07] <Ms2ger> I read "debian stale"
[15:34:08] <_Vi> Yes. BTW how to build Rust projects? I see no Makefile or like that. No info in README... 
[15:34:17] <Ms2ger> That's not all that inaccurate, I guess :)
[15:34:20] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[15:34:35] <dbaupp> cmr: has the bencher exploded in a cloud of rust? ... it seems to be inaccessible from the internet
[15:34:37] <cmr> _Vi: there most certainly is info in the readme
[15:34:48] <cmr> _Vi: ./configure && make && make install
[15:34:57] <dbaupp> _Vi: normally just `rustc main-file.rs` if there's no other info given
[15:34:59] <bstrie> Ms2ger: debian stable is only like ten months out of date right now! a very exciting time
[15:35:21] <dbaupp> cmr: I'd guess they mean things written in Rust, not mozilla/rust
[15:35:24] <bstrie> just upgraded one of my servers to debian stable, very happy that I no longer have to have a custom vim and nginx :)
[15:35:45] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[15:35:46] <_Vi> There is no configure script. In README there are sections: Requirements, Usage (assumes already build executable), Example, TODO.
[15:36:05] <dbaupp> _Vi: link?
[15:36:07] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:36:08] <cmr> Oh rust-bindgen? just rustc main.rs, yeah
[15:36:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[15:36:23] <cmr> Or, bindgen.rs, rather
[15:36:44] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[15:37:00] <_Vi> github.com/crabtw/rust-bindgen , the first that is found on Google on "rust-bindgen" search.
[15:37:18] <dbaupp> _Vi: yup, that's right
[15:38:46] <dbaupp> cmr: http://www.isup.me/hnn.mrsd.org :(
[15:38:49] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[15:39:02] <cmr> dbaupp: yeah it's been down since this morning
[15:39:23] <dbaupp> do you know what's up? (ping seems to imply the dns has broked itself?)
[15:39:35] <cmr> ISP problems
[15:39:52] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[15:39:54] <dbaupp> bstrie: http://www.reddit.com/r/rust/comments/1icewi/rust_ui_not_showing_properly_on_ati_cards/
[15:40:02] <cmr> The internet on the other side of g2-10.agg01.chittenden.vt.ena.net is unroutable
[15:40:23] <dbaupp> cmr: run-on effects of the flooding?
[15:40:32] *** strcat1 is now known as strcat
[15:40:32] <cmr> dbaupp: dunno
[15:40:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:41:11] <SiegeLord> Hmm... rust UI isn't showing up either... it always falls back to command line mode
[15:41:26] <_Vi> A bunch of "clang_*" undefined linker references... Probably obsolete libclang... Trying to install newer libclang.
[15:41:35] <cmr> bstrie: hah, beatcha
[15:42:07] <cmr> _Vi: it really means it when it says >= clang 3.1
[15:42:11] <bstrie> dbaupp: thanks. just our luck that the creator of gmod would name his new game such that it collides with our language :P
[15:42:45] <_Vi> cmr, May the developer only tested with clang v3.1, so put >= 3.1 to be sure.
[15:42:53] * dbaupp hope he rewrites it in Rust
[15:43:05] <dbaupp> (the confusion it causes would be amazing!)
[15:43:24] *** Quits: sk (sk@A298A44C.54A580E3.78DD174B.IP) (Quit: Leaving)
[15:44:28] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[15:44:34] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[15:44:54] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[15:52:31] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:52:35] <bstrie> rusti: let foo = [0, ..0]; foo
[15:52:36] -rusti- []
[15:52:37] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[15:52:38] <bstrie> dammit
[15:52:44] <bstrie> was hoping that was illegal :P
[15:52:55] <strcat> rusti: ()
[15:52:56] -rusti- ()
[15:52:56] <strcat> rusti: (1,)
[15:52:57] -rusti- (1,)
[15:53:02] <Jeaye> o.O
[15:53:02] <bblum> rusti: [println("hello"), ..0]
[15:53:03] -rusti- []
[15:53:26] <Jeaye> What is (1,)?
[15:53:37] <bstrie> Jeaye: special syntax for one-tuples
[15:53:44] <bstrie> Jeaye: it only exists to make macros nicer
[15:53:51] <Jeaye> ahh
[15:53:52] <bstrie> never make a one-tuple :P
[15:54:29] <bstrie> rusti: let foo = [0, ..-0]; foo
[15:54:30] -rusti- []
[15:54:39] <bstrie> rusti: let foo = [0, ..-2i]; foo
[15:54:40] -rusti- <anon>:7:25: 7:28 error: expected positive integer for repeat count but found negative integer
[15:54:40] -rusti- <anon>:7          let foo = [0, ..-2i]; foo
[15:54:40] -rusti-                                   ^~~
[15:54:40] -rusti- error: aborting due to previous error
[15:54:41] -rusti- application terminated with error code 101
[15:54:49] <bstrie> rusti: let foo = [0, ..2i]; foo
[15:54:50] -rusti- [0, 0]
[15:54:54] <bblum> dbaupp, it is impossible in principle to allow the user to statically initialize a sync primitive, because if they could, they could also initializee it to an inconsistent state, and use it to break type safety
[15:55:17] <bblum> if we had something like constexpr, it might be possible
[15:55:35] <dbaupp> bblum: right, but that's sort-of the user's fault, isn't it?
[15:56:07] <dbaupp> bblum: it makes having a 'clean' global lock essentially impossible, doesn't it?
[15:56:24] <dbaupp> (as much as a global lock is every clean)
[15:56:26] <dbaupp> *ever
[15:57:05] <bblum> dbaupp: the library claims to present a safe interface, so it's responsible for not presenting features that are unsafe
[15:57:31] <dbaupp> :( I guess.
[15:57:48] <bblum> the option solution is not that bad imo
[15:57:52] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:57:57] <bblum> you just write .get_ref() all the time
[15:58:11] <dbaupp> bblum: the compulsory allocation in Mutex is though.
[15:58:35] <bblum> why?
[15:59:39] <dbaupp> it's not compulsory (pthread_mutex doesn't allocate does it?)
[16:00:17] <dbaupp> i.e. afaik, it shouldn't be required.
[16:00:23] <bblum> C is a language designed for writing robust programs in out-of-memory conditions
[16:00:54] <bblum> it would be cool if it were not required, but i don't see it as "that bad"
[16:01:20] <strcat> considering that any fn call can already allocate via segmented stacks
[16:01:34] <strcat> you're already screwed from OOM 
[16:02:14] <dbaupp> hm, maybe; but I was more thinking from the perspective of not allocating at all, rather than OOM.
[16:02:29] <dbaupp> (but segmented stacks screws that over anyway.)
[16:03:03] <bblum> blocking on a mutex also allocates
[16:06:12] *** Quits: fabiand (fabiand@moz-A0BEF28F.adsl.alicedsl.de) (Quit: Verlassend)
[16:09:26] *** Joins: mib_nlsdui (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[16:10:12] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[16:13:47] *** Quits: markluffel (markluffel@179F0C2A.5C4C7C24.8354FB35.IP) (Ping timeout)
[16:14:11] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[16:15:04] *** Joins: pczarn (pczarn@moz-69A55FA.izacom.pl)
[16:16:22] <dbaupp> bblum: you mean a pthread mutex?
[16:16:29] *** Joins: markluffel (markluffel@179F0C2A.5C4C7C24.8354FB35.IP)
[16:16:30] <bblum> no
[16:16:35] <bblum> blocking on a rust mutex allocates
[16:16:43] <bblum> if blocking on a pthread mutex allocated, that would be bad
[16:16:57] <dbaupp> yes, that's why I was confused.
[16:17:02] *** Quits: pczarn (pczarn@moz-69A55FA.izacom.pl) (Quit: )
[16:17:56] <dbaupp> and it's good that blocking on a mutex allocates?
[16:18:09] <dbaupp> (or just unavoidable?)
[16:18:20] <bblum> it's not good, but i see no way to avoid it
[16:19:11] <dbaupp> ah, ok
[16:20:52] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:22:02] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[16:22:16] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Input/output error)
[16:22:39] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[16:22:48] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[16:23:40] *** Joins: nano (nano@moz-972880B.superkabel.de)
[16:23:44] *** Joins: pax7 (pczarn@moz-69A55FA.izacom.pl)
[16:26:49] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[16:29:47] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[16:31:46] *** Quits: pax7 (pczarn@moz-69A55FA.izacom.pl) (Quit: )
[16:32:13] <bstrie> woah
[16:32:17] <bstrie> bors isn't doing anything
[16:32:24] <bstrie> quick, someone review something!
[16:33:18] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[16:33:46] <bstrie> actually
[16:34:01] <bstrie> someone should grab pcwalton's decopy patch and fix the merge errors and push it through
[16:34:41] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:34:46] <bstrie> that would be +100 ducats
[16:34:49] <brendanc> enjoy summer schedule bors
[16:35:54] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[16:36:07] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[16:36:13] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:36:14] <dbaupp> bstrie: you can edit files on the github website... so you could do it from the safety of your web browser ;P
[16:36:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:36:31] <bstrie> dbaupp: how do I tell where the merge conflicts are??
[16:37:19] <dbaupp> bstrie: hmm...
[16:37:37] <dbaupp> I guess you can't even do the rebase
[16:38:20] <strcat> huh?
[16:38:29] *** Quits: mye (mye@moz-E79A8420.dip0.t-ipconnect.de) (Quit: mye)
[16:38:32] <dbaupp> (but if you could... there's only 2721 .rs files.... just open a lot of tabs and ctrl-f <<<... :P )
[16:38:32] <engla> git can show you were the conflicts are
[16:38:43] <dbaupp> engla: but can the github web-interface?
[16:38:43] <bstrie> engla: no, we're trying to only use the github web interface
[16:38:54] <engla> oh
[16:38:56] <engla> why?
[16:38:56] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[16:38:59] <bstrie> self-imposed challenges
[16:39:09] <engla> ah
[16:39:15] <bstrie> engla: because I'm on a computer right now that can't compile rust, so I can't run the test suite
[16:39:29] <bstrie> not that the web interface helps with that...
[16:39:34] <dbaupp> bstrie: so you might as well use bors for it
[16:39:46] <bstrie> or I could... go for a walk!
[16:39:47] <dbaupp> it's not like it's doing anything useful
[16:39:48] * bstrie walks
[16:40:06] *** bstrie is now known as bstrie|abdicatingresponsibilit
[16:41:17] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Connection reset by peer)
[16:41:17] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[16:42:36] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[16:42:36] *** ChanServ sets mode: +o pcwalton
[16:44:04] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[16:44:10] <pcwalton> nmatsakis: was wondering how well LLVM will eliminate the borrow flag adjustments if all you do with a Gc<T> is borrow it, read a field, and drop your borrow
[16:44:31] <pcwalton> I think it *probably* will if we declare proper alias info
[16:45:20] <pcwalton> well hmm, no it won't, because the invariants on "borrow-as-immutable" are different from "borrow-for-reading". that's kind of annoying. we'd need &const or something
[16:45:20] <nmatsakis> pcwalton: I imagine it might
[16:45:41] <nmatsakis> pcwalton: but it'd need some advanced analyses,
[16:45:54] <nmatsakis> pcwalton: but we could also do it
[16:45:57] <nmatsakis> pcwalton: in Rustc
[16:46:06] <pcwalton> well, I don't know how unless we have a ReadPtr<> trait or something
[16:46:36] <nmatsakis> pcwalton: well, we'd probably just add an unsafe method for borrowing without touching flags
[16:46:39] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[16:46:40] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: fread2282)
[16:46:45] <nmatsakis> pcwalton: which actually I imagine there will be anyhow
[16:46:55] <pcwalton> the compiler calls it?
[16:46:57] <nmatsakis> right
[16:47:01] <pcwalton> hmm, ok
[16:47:02] <nmatsakis> if it sees that it's safe
[16:47:04] <pcwalton> that's what I was getting at
[16:47:13] <nmatsakis> however,
[16:47:19] <nmatsakis> it'd probably have to be an opt-in thing,
[16:47:27] <nmatsakis> well, depends.
[16:47:27] <pcwalton> this is kind of annoying though because accessor methods like get_foo() won't be able to eliminate the read barrier
[16:47:34] <pcwalton> because there will still be a borrow
[16:47:43] <nmatsakis> we could optimize that too,
[16:47:45] <nmatsakis> if we wanted,
[16:47:47] <nmatsakis> by using purity inference
[16:47:52] <nmatsakis> (but don't expose it to the user)
[16:48:02] <nmatsakis> "purity as pure optimization"
[16:48:21] <pcwalton> ok, sure
[16:48:47] <pcwalton> so I was hoping that we could avoid having any custom smart pointer traits known to the compiler
[16:48:50] <pcwalton> but I guess they're necessary
[16:48:51] <pcwalton> for this reason
[16:49:18] <nmatsakis> I don't know how you could avoid having them exposed to the compiler anyhow,
[16:49:20] <nmatsakis> for GC integration etc
[16:49:30] <nmatsakis> not to mention for usability?
[16:49:40] <nmatsakis> don't we want them to participate in auto-deref etc
[16:49:48] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[16:50:09] <pcwalton> well, not for mutation
[16:50:54] <pcwalton> but for reading, I guess so.
[16:51:15] <nmatsakis> not Cell
[16:51:25] <nmatsakis> I'm still assuming that all smart pointer types assume immutability,
[16:51:31] <nmatsakis> and all mutation goes through Cell,
[16:51:38] <nmatsakis> is this not what you're assuming?
[16:51:42] <pcwalton> oh yes, right
[16:52:00] *** Joins: lmandel (lmandel@8B192B20.1F93A08E.ADB88A9.IP)
[16:52:11] *** Joins: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:52:11] *** ChanServ sets mode: +o dherman
[16:53:10] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Client exited)
[16:53:22] <pcwalton> ok, we should write up what the trait will look like
[16:53:49] <pcwalton> I'm assuming pattern matching on @ is going away
[16:53:57] <pcwalton> just for simplicity's sake
[16:54:31] <nmatsakis> hmm
[16:54:34] <nmatsakis> guess so
[16:54:46] <pcwalton> it also nicely solves the problem of what to rename "@" in patterns to ;)
[16:54:53] <nmatsakis> I was just going to say that
[16:54:57] <nmatsakis> :)
[16:55:10] *** Joins: graydon (graydon@moz-A8112A5D.cable.teksavvy.com)
[16:55:10] *** ChanServ sets mode: +qo graydon graydon
[16:55:46] <pcwalton> btw, I don't know if you were following the servo thread lately
[16:55:55] <pcwalton> but I think custom smart pointers just became that much more important
[16:55:58] *** Joins: zz_kimundi (kimundi@moz-A033AA7.dip0.t-ipconnect.de)
[16:56:09] <graydon> I wasn't, no. link?
[16:56:14] *** zz_kimundi is now known as kimundi
[16:56:23] <kmc> what does type syntax like Â«&'self fn: Copy(v: @T)Â» mean?  reference (with "self" lifetime) to function where every free variable must be Copy?
[16:56:24] <pcwalton> (this was to nmatsakis but graydon, you're probably interested too)
[16:56:36] <pcwalton> kmc: exactly 
[16:56:54] <graydon> oh, ok
[16:57:05] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[16:57:09] <graydon> I mean, I expect we'll be able to support custom smart pointers! hope I didn't give the impression that those hooks were undesirable
[16:57:15] <nmatsakis> pcwalton: I was following,
[16:57:19] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Quit: Leaving.)
[16:57:21] <engla> kmc: the bound applies to the environment of the fn yes
[16:57:30] <nmatsakis> pcwalton: I've been meaning to follow up with you on the topic of read barriers
[16:57:31] <pcwalton> anyway, we can probably store objects that are 18 words or fewer in the JS GC heap
[16:57:42] <pcwalton> with "a month or two" of SpiderMonkey hacking
[16:57:47] <pcwalton> which would be really great
[16:58:02] <pcwalton> because that would eliminate khuey's objection to GC-ing everything and would just be nice all around
[16:58:20] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[16:58:22] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:58:23] <kmc> can you do that with any trait, or only with things the compiler cares about, like Copy?
[16:58:32] <pcwalton> kmc: only the latter
[16:58:38] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[16:58:49] <kmc> ok
[16:58:53] *** Joins: dylukes (dylukes@moz-13611DF9.hsd1.ma.comcast.net)
[16:58:56] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[16:59:02] *** Quits: thiez (thiez@moz-8F8FE2C.student.utwente.nl) (Quit: leaving)
[16:59:20] <nmatsakis> so pcwalton/graydon, I implemented a branch that uses pure H-M unification in the type checker,
[16:59:22] *** Quits: mib_nlsdui (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:59:27] <nmatsakis> it bootstraps,
[16:59:32] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[16:59:34] <nmatsakis> only thing that had to be changed were 3 test cases, I think.
[16:59:44] <nmatsakis> though the change that was required *is* somewhat counterintuitive,
[16:59:54] <nmatsakis> could be fixed if we changed how we handle `==` operator,
[16:59:58] <nmatsakis> anyway I will write up a blog post,
[17:00:03] <nmatsakis> but I think it's a good idea. Makes our type inferencer simpler,
[17:00:05] <nmatsakis> easier to specify,
[17:00:26] <nmatsakis> and it will make it it easier to have more advanced inference, in particular around closures.
[17:00:30] <nmatsakis> plus it fixed a few bugs.
[17:00:32] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[17:00:37] <nmatsakis> Note: this does not change the type system rules in any way
[17:01:12] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:01:21] *** Joins: echristo_ (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[17:01:37] *** Joins: Thiez (thiez@moz-BF669398.student.utwente.nl)
[17:01:50] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[17:01:50] *** echristo_ is now known as echristo
[17:01:52] <nmatsakis> for reference:  28 files changed, 749 insertions(+), 1370 deletions(-) :)
[17:01:58] <nmatsakis> mostly the changes are because I moderned infer a bit
[17:02:05] <nmatsakis> indentation and so on
[17:02:26] <graydon> can you briefly summarize what the differences are between what we do now and "pure H-M"?
[17:02:41] <graydon> I mean, for someone who is a bit of a dope when it comes to typechecking algorithms in the first place
[17:02:48] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[17:02:55] <graydon> we did have an imitation-H-M algorithm in there at some point. even one in rustboot!
[17:03:00] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[17:03:03] <graydon> I don't know how far off "pure" it was :)
[17:03:08] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Input/output error)
[17:03:14] <nmatsakis> graydon: the difference is that right now we try to track subtyping a bit,
[17:03:20] <nmatsakis> so basically for each variable,
[17:03:32] <nmatsakis> in HM each variable gets unified once and that's it,
[17:03:34] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:03:38] <nmatsakis> it forever has that type.
[17:03:52] <nmatsakis> in our system, we track two bounds, an upper (supertype) and lower (subtype) bound
[17:03:59] <strcat> nmatsakis: does it have any implications for lifetimes? or it's really just going to be the same thing
[17:03:59] <_Vi> Looks like rust-bindgen does not like "typedef int (*my_functionptr_t)(...)"...
[17:04:02] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:04:27] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:04:27] *** ChanServ sets mode: +o pcwalton
[17:04:37] <strcat> _Vi: extern fn might not have existed when it was written
[17:04:49] *** Joins: eholk (eholk@moz-39F1DC8F.uconnect.utah.edu)
[17:05:07] <nmatsakis> graydon: but really I can't explain it on IRC, there is src/librustc/middle/typeck/infer/doc.rs
[17:05:33] <nmatsakis> graydon: still, my feeling is that we *try* to account for subtyping, but there are many edge cases where we don't do a good job,
[17:05:46] <nmatsakis> to really get it right, we'd have to build up a constraint graph,
[17:05:50] <_Vi> strcat, I just picked the first simple little header file from my project, and rust-bindgen does not seem to generate useful binding for it... Callback function pointer turned to *u8...
[17:05:56] <graydon> nmatsakis: huh, ok. I don't really know how H-M deals with subtyping. Or .. I forget, if I ever knew.
[17:05:59] <nmatsakis> and that is hard to reconcile with the fact that sometimes we have to know the type *right now*
[17:06:02] <nmatsakis> graydon: it doesn't.
[17:06:07] <graydon> yeah, that's what I thought!
[17:06:09] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[17:06:16] <strcat> _Vi: well, rust didn't used to have a real representation for them
[17:06:19] <graydon> but um, didn't we add subtyping (along mut and a couple other minor axes) to the language?
[17:06:32] <nmatsakis> yes, we have subtyping, but that doesn't mean we have to infer it.
[17:06:51] <nmatsakis> that is, if you write this today:
[17:06:52] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:06:54] <strcat> & seems to count as a subtype of &const
[17:07:10] <nmatsakis> graydon: let mut x = @mut 3; x = @3; // we will infer type of `x` to be `@const`
[17:07:11] <_Vi> strcat, What is unsafe {} representation for them? (for interfacing with things)
[17:07:24] <strcat> _Vi: extern "C" fn
[17:07:27] <nmatsakis> graydon: whereas in the newer branch I have, you'd get a type error, because the type would become "fixed" to `@mut`
[17:07:34] <doomlord_> function pointers as u8* is a temp hack i gather
[17:07:37] <strcat> or maybe just extern fn, I don't know if that means Rust or C
[17:07:40] <nmatsakis> graydon: so in some sense this is a regression, this is why code gets much simpler :)
[17:07:50] <nmatsakis> graydon: anyhow, let me try to write it up,
[17:07:50] <strcat> doomlord_: yeah before there was extern fn at all
[17:08:02] <nmatsakis> graydon: it's got some sublteties
[17:08:14] <doomlord_> i marked mine with a typedef to make them easy to replace later
[17:08:37] <graydon> nmatsakis: ok. it sounds .. relatively good! :)
[17:08:41] <nmatsakis> strcat: lifetimes are the primary source of subtyping in the language today, so all the changes that were required did have to do with lifetimes, but as I said there were only a few, and they were all concerned with assert_eq macro
[17:08:49] <graydon> (I've been meaning to ask what the fate of const was going to be, anyway :)
[17:09:12] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[17:09:51] <nmatsakis> strcat: (really with the `==` operator)
[17:10:03] <_Vi> strcat, For example, how to use this: https://raw.github.com/vi/forsnapshotfs/master/simplecow.h  from Rust? I've chosen this because of it is very simple, yet depends on callbacks.
[17:10:35] <bstrie|abdicatingresponsibilit> graydon: nobody knows! https://github.com/mozilla/rust/issues/7700
[17:10:39] *** bstrie|abdicatingresponsibilit is now known as bstrie
[17:11:08] *** Joins: Kruppe (user@moz-CE536524.net.uwaterloo.ca)
[17:11:35] <strcat> typedef int (*backing_read_t)(void* usr, long long int offset, int size, char* buf);
[17:11:38] <graydon> bstrie: yeah
[17:11:52] <strcat> extern "c" fn(usr: *c_void, ...) -> c_int
[17:11:58] <strcat> err, "C"
[17:12:05] <strcat> should work fine
[17:13:05] *** Joins: bytewise (bytewise@moz-649C630D.unitymediagroup.de)
[17:13:09] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Client exited)
[17:13:19] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[17:13:23] <brendanc> btw can someone explain something to me about stacks? I started skimming the code last night to see about implementing an explicit initial stack size option and am confused about Coroutine::MIN_STACK_SIZE. How does it relate to RUST_MIN_STACK?
[17:13:32] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:13:32] *** ChanServ sets mode: +o tjc
[17:14:07] *** Joins: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com)
[17:14:16] <bstrie> brendanc: brson might be the one to ask about that
[17:15:07] <brendanc> (RUST_MIN_STACK is 768 bytes, Coroutine::MIN_STACK_SIZE is 100000?)
[17:15:13] <brendanc> ok thanks
[17:15:26] *** Quits: Kruppe (user@moz-CE536524.net.uwaterloo.ca) (Ping timeout)
[17:16:01] <kmc> RUST_MIN_STACK is much bigger on 64-bit now
[17:16:11] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[17:16:11] <brendanc> (yes, that was me)
[17:16:23] <kmc> ah :)
[17:16:51] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:17:01] <_Vi> strcat, Can I use Rust function as backing_read_t? I.e. I call "simplecow_read" from Rust, and it in turn calls my function which I passed when initializing?    I think something on this should be in doc/tutorial-ffi.html
[17:17:38] <strcat> yes
[17:18:39] <_Vi> strcat, Shall some additional C code be written to deal with this? Or it can be done from Rust alone?
[17:19:16] <kimundi> bstrie: Oi, could you give me the contributor flair on reddit? :)
[17:19:18] *** Joins: roo (jesse@moz-BFD3E12.dynamic.ip.windstream.net)
[17:19:26] *** Joins: roo_ (jesse@moz-BFD3E12.dynamic.ip.windstream.net)
[17:19:34] <strcat> _Vi: you can do it from rust
[17:19:38] *** Quits: roo (jesse@moz-BFD3E12.dynamic.ip.windstream.net) (Quit: Leaving)
[17:19:47] <strcat> you just need extern fn as the parameter
[17:19:52] <bstrie> kimundi: I need a name!
[17:20:20] <kimundi> bstrie: Err, right xD. "Kimundi"
[17:20:32] <bstrie> see, I never would have guessed that
[17:20:43] <_Vi> (Trying, experimenting... Not understanding actually...)
[17:20:46] <kimundi> ^^
[17:21:02] <bstrie> it is done
[17:21:18] <kimundi> thx :)
[17:21:27] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:21:35] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[17:25:16] *** Quits: StarLight (StarLight@moz-CD6E4BF2.pppoe.avangarddsl.ru) (Ping timeout)
[17:25:45] *** Quits: dylukes (dylukes@moz-13611DF9.hsd1.ma.comcast.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[17:26:37] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[17:29:13] <jasom_> So, I have code written as a loop that complains about borrowing the same reference multiple times; if I rewrite it to be a tail-call then it stops complaining.  How do I fix this?
[17:30:33] *** Joins: webber46 (webber46@moz-98D2F3C5.cust.bredband2.com)
[17:31:06] <jasom_> https://gist.github.com/jasom/6001778  <-- the looping version is commented out
[17:32:44] <fread2282> how can I figure out what's going on from __psynch_cvwait?
[17:33:01] <fread2282> I'm there in the debugger and have no clue what's happening
[17:33:55] <tjc> fread2282: try switching threads: "thread 1", "thread 2", until you get an interesting backtrace
[17:35:29] <brendanc> (thread apply all backtrace)
[17:35:45] <tjc> or that
[17:35:54] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:36:03] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:39:10] <sp3d> good old t a a bt
[17:39:59] <brendanc> :)
[17:42:04] *** Joins: Guest (textual@34641662.FB4DE631.66C78B76.IP)
[17:43:55] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:47:15] <_Vi> Tried to implement that "extern fn" things for simplecow, but can't get around compile failures almost in every line... https://gist.github.com/vi/6001905
[17:50:31] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[17:51:16] *** Joins: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com)
[17:51:37] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:52:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:52:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:53:05] <strcat> pcwalton: is https://github.com/mozilla/rust/issues/3785 still an issue?
[17:54:03] *** Quits: sankha93 (Instantbir@A67ECFA2.4F1E6D7D.E7DAB6F9.IP) (Quit: He will be back!)
[17:54:38] *** Quits: igl (igl@moz-D9FF6666.adsl.alicedsl.de) (Ping timeout)
[17:55:30] *** Joins: igl (igl@moz-BF975917.adsl.alicedsl.de)
[17:56:32] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:59:25] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[17:59:32] *** Quits: graydon (graydon@moz-A8112A5D.cable.teksavvy.com) (Quit: Leaving.)
[18:01:05] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:02:17] *** Joins: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net)
[18:02:24] *** Quits: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net) (Quit: Leaving)
[18:03:58] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[18:04:17] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:05:58] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[18:08:26] *** jdm is now known as jdm|f00ding
[18:11:26] *** Quits: hansjorg_ (hansjorg@moz-41C5CE61.redpill-linpro.com) (Quit: leaving)
[18:11:52] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[18:12:46] <engla> does anyone have any WIP on rewriting fmt!?
[18:13:56] <doener> engla: aatch started working on that, but his branch on github had its last update two months ago
[18:13:59] <doener> https://github.com/Aatch/rust/commits/new-fmt
[18:14:05] * strcat ponders removing ~[] headers
[18:14:12] <engla> ok
[18:14:25] <strcat> we really need a snapshot, regardless of the 300MiB regression ;[
[18:15:02] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[18:15:08] <engla> doener: I'm just experimenting with minimal changes to have writef!
[18:15:30] <strcat> repr really annoys me
[18:15:41] <strcat> I'll have to add yet another TyVisitor method
[18:15:44] <strcat> ;[
[18:16:03] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[18:16:26] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[18:16:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/d99p0Q
[18:16:26] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[18:16:28] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[18:16:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/sbvhOQ
[18:16:28] <ghrust> 13rust/06auto 14600e40f 15Tim Chevalier: testsuite: Add xfailed test case for #6128
[18:16:28] <ghrust> 13rust/06auto 149d7e01b 15bors: auto merge of #7802 : catamorphism/rust/issue-6128, r=catamorphism
[18:16:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[18:17:44] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[18:17:54] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[18:20:54] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:21:57] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:22:01] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[18:22:03] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:22:25] <bblum> sigh, cell
[18:24:16] *** Joins: mye (mye@moz-E79A8420.dip0.t-ipconnect.de)
[18:24:33] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[18:25:12] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:25:24] <strcat> bblum: I haven't made much use of tasks so I haven't had to deal with 100s of cells :)
[18:25:35] <strcat> nested closures are the best
[18:25:38] <strcat> one cell per layer
[18:25:42] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[18:25:44] <bblum> it's horrible
[18:25:52] <bblum> whenever you write let thing = Cell::new(thing.take())
[18:26:20] <bblum> an angel's wings fall off
[18:26:31] <strcat> I thought removing ~[] headers would be easier than this
[18:26:33] <strcat> ;p
[18:26:59] <bblum> just had to do cells twice in the "canonical" use case i cite for it for stack closures - moving out if an optional value is some
[18:28:30] <strcat> on the positive side I get to rm one of these silly lang items I had to add
[18:29:11] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:29:18] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[18:30:07] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[18:32:01] <fread2282> I'm having some trouble with https://github.com/fread2281/rust-python/blob/master/test.rs all but one finishes (most of the time. sometimes it works fine) but one gets stuck here: https://gist.github.com/fread2281/388531463767f6fdfa81
[18:33:16] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[18:33:32] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:33:32] *** ChanServ sets mode: +o pcwalton
[18:33:36] <fread2282> actually sometimes more than one doesn't work, but that is the most common case
[18:33:41] * strcat tries compiling
[18:33:53] <strcat> hopefully a miracle happens and only repr.rs/fmt! break
[18:35:02] <fread2282> actually it seems like every other task works
[18:35:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:35:58] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:36:40] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:36:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:36:58] * strcat still thinks wifi is a cruel joke
[18:37:45] *** Joins: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu)
[18:39:11] *** Quits: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com) (Quit: No Ping reply in 180 seconds.)
[18:39:35] <cubic> Your wifi is more reliable and most likely faster than my ethernet
[18:39:53] *** Joins: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com)
[18:41:12] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[18:43:26] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[18:43:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:43:37] *** Quits: _Vi (vi@527C345F.497AA854.B16B3BE6.IP) (Ping timeout)
[18:45:53] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[18:45:55] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[18:46:32] <bstrie> cubic: he didn't say that ethernet wasn't an ever crueler joke :)
[18:46:47] <bstrie> crÃ¼ller
[18:46:58] <cubic> the most cruel joke being ISPs
[18:46:59] <engla> having no I/O is a cruel joke
[18:47:05] <strcat> *** Error in `x86_64-unknown-linux-gnu/stage1/bin/rustc': realloc(): invalid next size: 0x00007fc3fc200a90 ***
[18:47:08] <strcat> noooooooooooooooooooooooooooooooooooooooooooooooo
[18:47:17] <bblum> nice sizer
[18:47:20] <bblum> *size
[18:47:37] * strcat wonders how that happened ;p
[18:47:50] <strcat> probably memory corruption
[18:48:06] <strcat> hrm
[18:48:17] <strcat> vector take glue
[18:48:25] <strcat> god, the take glue hates me ;p
[18:48:32] <strcat> it breaks every time I touch trans
[18:49:11] <bstrie> strcat: realloc eh? maybe you should try using dbaupp's allocator, I hear it's quite fast at realloc
[18:49:27] <strcat> ;p
[18:50:36] * strcat screwed up lang item indexing too
[18:50:51] <strcat> reducing a bunch of numbers by one can go so wrong
[18:52:08] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[18:52:08] *** ChanServ sets mode: +qo graydon graydon
[18:53:12] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:56:46] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[18:56:53] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:56:53] *** ChanServ sets mode: +o tjc
[18:57:43] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:57:49] *** jdm|f00ding is now known as jdm
[18:57:59] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[18:58:45] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:58:52] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[19:02:07] <sp3d> rusti: let int = ""; int
[19:02:08] -rusti- ""
[19:02:41] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:02:41] *** Quits: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu) (Ping timeout)
[19:03:07] <bstrie> rusti: let int = 1; let int: int = int + int; int
[19:03:08] -rusti- 2
[19:03:48] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:03:50] <tikue> bstrie: why does it let you do that
[19:03:57] <bblum> sigh, cell new cell.take
[19:04:30] <bstrie> tikue: rust has two namespaces, one for types and one for everything else
[19:04:45] <bstrie> tikue: this is an improvement over C, which has something like 44 namespaces
[19:04:45] <tikue> bstrie: oh ok
[19:05:17] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:06:27] <bstrie> maybe I have my terminology wrong
[19:06:28] <engla> bstrie: do you count traits to the types namespace?
[19:06:35] <tikue> rusti: let a = 1; a += 1; a
[19:06:37] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/SNYg
[19:06:51] <tikue> rusti: let mut a = 1; a += 1; a
[19:06:52] -rusti- 2
[19:07:47] <bstrie> rusti: trait int {}
[19:07:49] -rusti- ()
[19:07:49] <engla> it also seems modules are a separate namespace
[19:07:58] <bstrie> engla: I'm not sure of the rules actually
[19:08:08] <bstrie> all I know is that the standard line is "we have only two namespaces"
[19:08:17] <bstrie> it might be a bit knotty as to what belongs in which
[19:08:26] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[19:08:31] <kimundi> I think it's more 'values' vs 'everything else'
[19:08:34] *** Joins: joelteon (joel@moz-317E8D0C.io)
[19:08:41] <bstrie> perhaps
[19:09:05] <sp3d> rusti: type int = str; let int : int = "int"; int
[19:09:06] -rusti- <anon>:7:20: 7:23 error: bare `str` is not a type
[19:09:06] -rusti- <anon>:7          type int = str; let int : int = "int"; int
[19:09:06] -rusti-                              ^~~
[19:09:06] -rusti- error: aborting due to previous error
[19:09:06] -rusti- application terminated with error code 101
[19:09:33] <sp3d> hmmmm, "type int = str;" seems to work on local rusti
[19:09:44] <bstrie> hilarious
[19:09:46] <bstrie> str is not a type
[19:09:49] <sp3d> right
[19:09:51] <kimundi> ,,,yet
[19:10:03] <bstrie> it will never be a type! unsized types are not types
[19:10:13] <sp3d> rusti: type int = &'static str; let int : int = "int"; int
[19:10:14] -rusti- <anon>:7:50: 7:55 error: mismatched types: expected `int` but found `&'static str` (expected int but found &'static str)
[19:10:14] -rusti- <anon>:7          type int = &'static str; let int : int = "int"; int
[19:10:14] -rusti-                                                            ^~~~~
[19:10:14] -rusti- error: aborting due to previous error
[19:10:14] -rusti- application terminated with error code 101
[19:10:35] <kimundi> bstrie: Hu? 
[19:10:51] <kimundi> unsized _types_ are no types?
[19:11:21] <bstrie> kimundi: https://en.wikipedia.org/wiki/No_true_Scotsman
[19:12:19] <kimundi> I'm way to tired for this xD
[19:12:38] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[19:13:06] <kimundi> Could you just tell me why you think that unsized types are not types?, but sized types are?
[19:13:31] <bstrie> kimundi: just being facetious :)
[19:13:44] <kimundi> 'kay xD
[19:14:23] <vladimir-lu> by that you could say dynamic sized types will never be types but nmatsakis would probably disagree :P
[19:15:33] * kimundi dreams of a future where not only [T] is a part of the typesystem as a unsized type, but where you can also declare newtypes containing them
[19:15:38] <jasom_> can you use named lifetimes with pattern matching?  Something like match x { Shape(ref mut 'foo x) => ...
[19:16:10] <bblum> jasom_: there is currently not a way to name lifetimes short of parameterizing entire functions over them
[19:16:33] <vladimir-lu> kimundi: you are talking of higher-kinded types?
[19:16:40] <kimundi> No
[19:16:49] <jasom_> bblum: I know, but given a reference to an enum with a named lifetime, how do I get a reference with the same lifetime inside a pattern match?
[19:17:43] <kimundi> struct str { priv data: [u8]}; struct c_str { priv data: [u8]}; struct utf16str { priv data: [u16]}; etc...
[19:17:49] <bblum> jasom_: it should be automatically inferred
[19:18:21] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[19:19:13] <vladimir-lu> kimundi: still don't quite get it
[19:19:28] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[19:19:30] <kimundi> vladimir-lu: Do you know what unsized types are about?
[19:20:55] <bstrie> does anyone know if there's an issue open yet for moving GC into a library?
[19:21:50] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[19:21:52] <vladimir-lu> kimundi: a type that you have parametrized but you don't have a static size for because you don't know it?
[19:22:08] *** Joins: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com)
[19:22:53] <kimundi> vladimir-lu: Well, in the context here it's just the latter. "a type whose sized is not known statically" 
[19:23:26] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[19:23:41] <jasom_> bblum: not happening for me in 0.7, I'll try trunk
[19:24:23] <bblum> jasom_: that's not likely to help
[19:24:26] <bblum> can you paste your code?
[19:24:47] <kimundi> Today all legal types in rust have a statically known size: uint is 4 or 8 bytes, [u8, ..42] is 42 byte, ~[u8] is 4 or 8 bytes because it is a pointer, etc
[19:25:13] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[19:25:25] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:25:31] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:25:36] <jasom_> bblum: nevermind, I had one path that did &foo.x rather than &'lifetime foo.x
[19:25:36] <kimundi> however, a bare [T] is not a legal type because it has no statically known size
[19:25:46] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:26:04] <vladimir-lu> by [T] you mean vector of a generic type T?
[19:26:50] <kimundi> wich today leads to the cumberson situation where you can't use a [T] as basic block for definitions, impls, etc. Instead you have to work with ~[T], @[T], &[T] etc
[19:26:55] <kimundi> yeah
[19:27:11] <vladimir-lu> i see
[19:27:36] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:28:08] *** Quits: igl (igl@moz-BF975917.adsl.alicedsl.de) (Ping timeout)
[19:28:24] <kimundi> for example today: 'imp ToStr for &[T] { fn(&self) -> ~str { // ...   } }' // &self == &&[T] here
[19:29:38] <kimundi> The idea is to make [T] (and some other unsized types) legal in situations where you don't need to know the size.
[19:29:57] <kimundi> for example in the future: 'imp ToStr for [T] { fn(&self) -> ~str { // ...   } }' // &self == &[T] here
[19:30:12] *** Joins: igl (igl@moz-E04C2E11.adsl.alicedsl.de)
[19:30:25] <strcat> it's going to be harder than it seems
[19:30:29] <strcat> ;p
[19:30:39] <engla> slices are nice as they are though
[19:30:43] <strcat> ~[T] and @[T] have len/capacity, fixed-size vectors and slices don't
[19:31:02] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Quit: Leaving.)
[19:31:17] <strcat> you could change the representation
[19:31:23] <strcat> but then they won't really be ~/@ anymore
[19:31:35] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[19:31:50] <kimundi> strcat: Sure, but that situation isn't different to autoslicing today, no?
[19:31:57] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[19:32:07] <strcat> I... guess?
[19:32:34] <kimundi> impl Pushable on [T] {  fn push(&mut ~[T]) ... }
[19:32:35] *** Quits: seth (seth@moz-42C5FAA8.nc.res.rr.com) (Input/output error)
[19:32:54] <strcat> you can't push to any array though
[19:32:59] <strcat> you can only push to ~[] and @mut []
[19:33:08] <strcat> can't push to a fixed-size array or slice
[19:33:20] <kimundi> hence the &mut ~[T] and not &mut [T] :P
[19:33:31] <strcat> but it's impl'ed on [T]
[19:33:43] <strcat> I guess [T] would mean the dynamically-sized part of ~[] and @[]
[19:33:53] <kimundi> okay fine, example not applicable here
[19:33:57] <strcat> but it wouldn't apply for [T, ..n]
[19:34:13] <strcat> at least if you're able to push.
[19:34:14] <kimundi> Would still have a impl on ~[T] then
[19:34:31] <strcat> ustc just gave me a 160 line traceback
[19:34:35] <strcat> uh
[19:35:51] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:36:23] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:37:04] *** Joins: _Vi (vi@527C345F.497AA854.B16B3BE6.IP)
[19:37:25] *** strcat1 is now known as strcat
[19:37:29] <strcat> oh good
[19:37:34] <strcat> the vector offsets are already from 0, as if it was unboxed
[19:37:35] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[19:37:36] <strcat> ;]
[19:38:33] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[19:39:29] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[19:39:32] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[19:41:48] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[19:43:16] *** Joins: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu)
[19:43:58] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:43:58] *** ChanServ sets mode: +o tjc
[19:44:40] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[19:46:36] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[19:46:43] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Input/output error)
[19:47:43] *** Quits: seth (seth@moz-42C5FAA8.nc.res.rr.com) (Input/output error)
[19:49:43] *** Quits: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com) (Quit: jeff)
[19:52:14] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:52:37] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[19:54:28] *** Joins: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com)
[19:55:00] <strcat> oh good, LLVM assert ;p
[19:55:31] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[19:55:31] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/sbvhOQ
[19:55:31] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[19:56:27] <Luqman> strcat: removing headers from vectors?
[19:56:31] <strcat> yep
[19:56:50] <strcat> I broke tvec::alloc_raw ;)
[19:57:22] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[19:57:35] <strcat> it's fun how half of it is reversing my work from removing ~T headers
[19:57:43] <strcat> since I isolated away unique vecs
[19:57:54] <strcat> so that part is easy ;p
[19:58:04] <strcat> repr will break again ofc
[19:58:17] *** Quits: Ms2ger (Ms2ger@moz-D6466908.adsl-dyn.isp.belgacom.be) (Quit: nn)
[19:58:27] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[19:58:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/-gNwaQ
[19:58:27] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[19:58:28] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:58:28] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/z51uSA
[19:58:28] <ghrust> 13rust/06auto 146ea81b2 15Tim Chevalier: extra: Change XXX to NOTE
[19:58:28] <ghrust> 13rust/06auto 14af5c3eb 15Tim Chevalier: extra: change XXX to NOTE
[19:58:28] <ghrust> 13rust/06auto 14b778e0b 15Tim Chevalier: extra: change alloc to take &mut self, as per XXX comment
[19:58:28] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:58:55] <Luqman> strcat: at least now you've somewhat of an idea what to expect
[19:59:02] <strcat> yeah
[19:59:04] <Luqman> you've an idea*
[19:59:17] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[19:59:29] <strcat> removing the ~T ones was my first real experience with a sweeping change across trans, so I know where to look for everything now
[20:01:40] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[20:02:00] <doomlord_> yikes, bindgen uses @ all over the place 
[20:02:00] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:02:07] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:02:24] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[20:02:25] <doomlord_> and by trying to modify i've managed to crash it :(
[20:02:51] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[20:03:24] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[20:04:12] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[20:05:08] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:05:25] <strcat> body: ~"unboxed_vec<*libc::types::common::c95::c_void>", size: 140358776564224
[20:05:26] <strcat> uh
[20:05:30] <strcat> 140358776564224? ;\
[20:06:08] <strcat> oh I'm silly it's the ValueRef ptr
[20:06:45] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[20:07:47] <jensnockert> doomlord_: And rustc :(
[20:08:08] <strcat> the two or three non-managed strings it uses will be a bit smaller ;p
[20:08:45] <doomlord_> i battled with NIH over the past 24 hours, was looking at clang starting a small c++ project with the intention of doing some sort of limited C++ binding gen..
[20:09:07] <doomlord_> ... today i started looking at bindgen source instead, now i kind of remember the reason for NIH :)
[20:09:16] * jensnockert hugs doomlord_.
[20:09:46] <doomlord_> can people make small programs that compose via data .. 
[20:10:40] <doomlord_> grrr. can't seem to add an extra array to something in bindgen without it crashing ( not even trying to use it..) 
[20:10:52] <doomlord_> i wonder if its buggy @ behaviour
[20:10:54] <bstrie> doomlord_: to be fair, bindgen is really, really, really, really old code
[20:11:01] <bstrie> it's like rust 0.0-era
[20:11:08] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[20:11:15] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[20:11:23] <doomlord_> flipside is ... the match stuff compared to C++ is rather nice for parsing ast ..
[20:11:26] *** Joins: erickt1 (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[20:11:29] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Connection reset by peer)
[20:11:42] *** Joins: livingparadox (Mibbit@moz-1DA7B531.static.lsan.ca.charter.com)
[20:12:41] <doomlord_> &mut of something containing @ 's ... have i seem discussion of problems r.e. that here ?
[20:13:14] <doomlord_> fn visit_struct(cursor: &Cursor,        ctx: @mut BindGenCtx.      fields: &mut ~[@FieldInfo],	methods: &mut ~[@MethodInfo])..
[20:13:20] <bstrie> doomlord_: it can cause runtime failures
[20:13:32] <doomlord_> bindgen: /home/walter/gplsrc/rust/src/rt/rust_upcall.cpp:98: void upcall_call_shim_on_rust_stack(void*, void*): Assertion `false && "Rust task failed after reentering the Rust stack"' failed.
[20:13:54] <engla> strcat: do you have a plan for ringbuf? internal representation and d-e- iterators or so, anywthing I can do?
[20:14:43] <strcat> engla: well it should have d-e iterators
[20:15:41] *** Quits: livingparadox (Mibbit@moz-1DA7B531.static.lsan.ca.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[20:15:41] <doomlord_> i suspect if i start trying to convert @ to ~ .. i'm going to have a hard time figuring out all the copy/clone stuff required
[20:15:54] *** Joins: livingparadox (skids@moz-1DA7B531.static.lsan.ca.charter.com)
[20:16:08] <bblum> eholk: congrats on your paper publication
[20:16:42] <sully> I am super amused by the function name please_check_that_trait_methods_are_implemented
[20:17:14] <tjc> the typechecker runs faster when you're polite to it
[20:17:48] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:17:48] <olsonjeffery> is anyone doing #6168?
[20:18:07] <olsonjeffery> that is "Implement blocking file I/O using new I/O subsystem"
[20:18:24] <olsonjeffery> which would eventually be the backend to replace/supplement core::io (as part of #6169)
[20:18:31] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:18:34] <bblum> eholk: ping
[20:18:46] <olsonjeffery> if not, i intend to claim it
[20:18:54] <strcat> and ofc I broke copying ~[] too
[20:18:59] <strcat> that looks easy to fix
[20:19:08] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:19:09] <bstrie> olsonjeffery: feel free to nab it
[20:19:14] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[20:19:18] <tjc> olsonjeffery: I suspect not, but brson would be the one who could best answer that, and he's on vacation
[20:19:37] <bblum> olsonjeffery: ecr is doing it
[20:19:52] <bstrie> tell ecr to leave a note on the bug, then :)
[20:20:16] <olsonjeffery> yeah. this seems to something an endemic issue, heh
[20:20:19] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[20:20:37] <livingparadox> My aplogies in advance, but as green developer, where should I start to assist?
[20:20:59] *** Quits: webber46 (webber46@moz-98D2F3C5.cust.bredband2.com) (Quit: webber46)
[20:21:02] <bblum> livingparadox: filter the issue tracker for bugs labelled E-Easy and pick one
[20:21:08] <bblum> pick an unassigned one that is
[20:21:08] <doomlord_> any opinions, will it be a futile endevour to fork & turn 'bindgen' into a @ free zone (i'm trying it out now...) .. that would be more likely to work ? 
[20:21:23] <doomlord_> i can't say i know if the @ptrs are essential for shared info...
[20:21:36] <livingparadox> bblum: thanks
[20:22:54] <tjc> livingparadox: and if you have questions about what one of the "easy" issues means, or run into any issues while working on it, feel free to ask about it here
[20:22:56] <tjc> ask early and often :-)
[20:23:21] <cmr> livingparadox: and don't apologize ;)
[20:23:35] *** Joins: wilsonk|2 (kvirc@moz-8E86F35A.cg.shawcable.net)
[20:24:14] <livingparadox> thank you both, I'm a chronic apologizer.  >.>  Thank you both
[20:24:31] <livingparadox> and I suck at IRC
[20:24:33] <bblum> chronic thanker too
[20:24:39] *** Quits: wilsonk-laptop (kvirc@moz-8E86F35A.cg.shawcable.net) (Ping timeout)
[20:24:44] <cmr> heh
[20:26:07] <ecr> bstrie, olsonjeffery: I've been summoned. What's up?
[20:26:31] <tjc> graydon: ping
[20:26:55] <strcat> ugh still this error
[20:27:51] <graydon> tjc: pong
[20:28:14] <tjc> graydon: I'm trying to implement the new "extern mod foo = "a/b/c" syntax
[20:28:19] <graydon> ah yes
[20:28:25] <tjc> I assume this should involve moving the URL-fetching code from rustpkg into rustc
[20:28:30] <tjc> and then having rustpkg import it from rustc
[20:28:35] <tjc> would metadata::loader be the right place to put it?
[20:28:40] <bstrie> ecr: olsonjeffery wanted to know whether #6169 was up for grabs
[20:29:02] <graydon> tjc: url _fetching_ code?
[20:29:17] <tjc> graydon: well, just the code that shells out to git, I should say
[20:29:29] *** Quits: vcl (chatzilla@741D4FEA.76F9E272.DA40C4B3.IP) (Client exited)
[20:29:33] <graydon> tjc: no, I don't think rustc should be doing that
[20:29:49] <olsonjeffery> ecr: are you working on #6168 ? (blocking file io in newsched) .. ?
[20:29:55] <graydon> tjc: the part of rustc you're looking for is the bit that does crate searching, yeah?
[20:30:06] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[20:30:08] *** Joins: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de)
[20:30:15] <tjc> graydon: well, the part of rustc that I thought would need to change if rustc is going to handle these, yeah
[20:30:31] <olsonjeffery> if not, i'm gonna take #6435 (newsched timer)
[20:30:35] <tjc> so are you saying that extern-mod-from-URL just shouldn't work if you involve rustpkg directly?
[20:30:41] <olsonjeffery> if so, i should say
[20:30:41] <tjc> I mean
[20:30:45] <tjc> if you invoke rustc directly
[20:30:48] <tjc> as opposed to invoking rustpkg
[20:30:50] <strcat> Luqman: once again it's the take glue :)
[20:30:51] <olsonjeffery> either way. just trying really hard to find something in newsched to work on.
[20:30:56] <jensnockert> livingparadox: You should try being a chronic hugger! \o/
[20:30:58] <graydon> tjc: if it's not already findable in RUST_PATH, yeah
[20:31:13] <graydon> tjc: I think probably rustc should know how to search RUST_PATH, but not more than that
[20:31:16] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[20:31:18] <tjc> graydon: Ah, ok. In that case, then the RUST_PATH searching code should be moved from rustpkg into rustc?
[20:31:19] *** Joins: jgilbert_ (jgilbert@moz-7B0110AD.mv.mozilla.com)
[20:31:28] <strcat> Luqman: http://ix.io/6FT look at this beautiful backtrace
[20:31:30] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:31:30] <strcat> ;p
[20:31:36] <graydon> tjc: I suspect that'll be adequate, yeah.
[20:31:55] *** Quits: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu) (Quit: Leaving)
[20:31:55] <strcat> I guess I have the wrong pointer type, I probably need a cast or something like that
[20:32:01] <tjc> graydon: Ok. thenâ€¦ is metadata::loader the right place to put the RUST_PATH searching code?
[20:32:01] <graydon> tjc: I mean, the division between compiler and package manager is a little blurry around this, certainly
[20:32:40] <Luqman> strcat: haha oh man, well problem seems to be some GEPi somewhere assuming something about the layout of the data i'd guess
[20:32:43] *** Joins: bat (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:32:50] <olsonjeffery> and is brson out/on-vacation?
[20:32:58] <strcat> Luqman: yeah I think it could just be that I forgot to write the contains_managed path
[20:33:05] <graydon> tjc: hmm. not a bad place? it seems a little out of place but not wildly so. rustpkg searches RUST_PATH for quite a few different reasons, yes?
[20:33:15] <tjc> graydon: sure
[20:33:17] <graydon> olsonjeffery: I believe so. lemme check the PTO-o-meter
[20:33:36] *** Quits: jgilbert_ (jgilbert@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[20:33:37] <strcat> Luqman: s/think/hope/
[20:33:39] <strcat> but I did forget
[20:33:41] <strcat> :)
[20:33:58] <pcwalton> olsonjeffery: yes, he is
[20:34:05] <ecr> olsonjeffery, bstrie: Well, I'm writing the I/O system for the new runtime. If it's referenced under I/O in #4419, then I'm working on it. I guess the intern project related bugs haven't been flagged on github yet.
[20:34:06] <Luqman> strcat: the obvious mistakes are the best
[20:34:07] <olsonjeffery> ok, thanks.
[20:34:21] <strcat> I always forget I can do this
[20:34:43] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:35:01] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[20:35:03] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:35:07] <ecr> olsonjeffery, bstrie: Mostly I'm working on #4248 at the moment.
[20:35:11] <tjc> graydon: actually, I guess metadata::filesearch is a better place to put it (loader calls filesearch)
[20:35:14] <olsonjeffery> ecr: that's great, i'm trying to determine which tasks you aren't currently working on so that i can contribute.
[20:35:20] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:35:31] <olsonjeffery> so that, when my PR comes up, it's not something like "oh, so-and-so already did that"
[20:35:39] <strcat1> rusti: let b; if true { b = 2 } else { b = 5 } b
[20:35:43] -rusti- 2
[20:35:50] <strcat1> rusti: let b = if true { b = 2 } else { b = 5 }; b
[20:35:51] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RLaF
[20:35:52] * vladimir-lu hugs the guy who did the Rust on bare metal ARM POC
[20:36:01] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:36:02] <strcat1> rusti: let b = if true { 2 } else { 5 }; b
[20:36:03] -rusti- 2
[20:36:08] <strcat1> anyway I always forget I can do it the first way... ;p
[20:36:09] <graydon> tjc: yeah. if it can be abstracted into a loop that enumerates the dirs, then another one that probes-for-libs within that enumeration..
[20:36:11] *** strcat1 is now known as strcat
[20:36:24] <ecr> olsonjeffery: ah, ok. I'll bug brson about assigning bugs to interns once he gets back from PTO.
[20:36:35] <graydon> tjc: I think it'd probably surprise more people if rustc runs git, than if rustc says "can't find package github.com/foo/bar"
[20:36:44] <doomlord_> re binggen source... i see lots of code taking immutable @ptrs then computing something ... i assume i can just change these to &ptrs .. no capture going on or anything , functions that just calculate some result from a source..
[20:36:47] <olsonjeffery> ecr: ok.. so can i get either 6168 or 6435? or are you doing them all at once?
[20:36:57] <tjc> graydon: Yeah, the loop is already there (for_each_lib_search_path in filesearch)
[20:37:44] <olsonjeffery> ecr: both of those tickets are under #4248 .. or is it not possible for both of us to do this work side-by-side?
[20:38:37] <kmc> if the last line of a block is debug!("foo"), is it possible that dtors for local vars in that block would run before the debug!() (through some optimization)?
[20:38:53] <strcat> they won't right now
[20:38:57] <strcat> in the future they could
[20:39:50] <strcat> atm they just run in reverse order of declaration at the very end of a block
[20:39:52] *** Quits: erickt1 (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[20:40:07] <strcat> LLVM will only reorder when the external effects are guaranteed to be identical
[20:40:23] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[20:40:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1484b68db to 149d7e01b: 02http://git.io/N3iJvQ
[20:40:23] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[20:40:24] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[20:40:24] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/E_YG2w
[20:40:24] <ghrust> 13rust/06auto 140fa9ad8 15Tim Chevalier: rustpkg: Handle local git repositories...
[20:40:24] <ghrust> 13rust/06auto 1404f9ce0 15bors: auto merge of #7681 : catamorphism/rust/rustpkg-local-repos, r=catamorphism...
[20:40:24] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[20:40:44] <vladimir-lu> is there something in std to convert big endian <-> little endian (i know it's trivial to implement but)
[20:40:54] <strcat> there's a bswap intrinsic
[20:41:15] <strcat> oh and there are wrappers now
[20:41:20] <strcat> std::unstable::intrinsics
[20:41:26] <eholk> bblum: pong
[20:41:43] <bblum> eholk: is it too late to correct typos in your GPU rust paper
[20:42:11] <eholk> bblum: yeah.. the conference was in may
[20:42:18] <bstrie> haha
[20:42:19] *** Joins: cr (anonymous@moz-970B27D8.dip0.t-ipconnect.de)
[20:42:38] *** Joins: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu)
[20:43:03] <bblum> oops :P
[20:43:09] <eholk> what was the typo?
[20:43:13] <vladimir-lu> strcat: is that somewhere in the docs?
[20:43:19] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:43:21] <bblum> in the intro, "languages features" should be "language features"
[20:43:21] <strcat> vladimir-lu: dunno, rustdoc is weird
[20:43:28] <eholk> oh, oops
[20:43:40] <strcat> vladimir-lu: it's in src/libstd/unstable/intrinsics.rs in the source though
[20:43:43] <eholk> i might have fixed that for the camera ready. I think the version on my web site is what we submitted, due to copyright stuff
[20:43:47] <strcat> we could have endian.rs in libstd instead
[20:43:51] <vladimir-lu> strcat: i'll have a look - doc search would be nice
[20:43:53] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[20:44:11] <strcat> Luqman: nope still hitting it
[20:44:13] * strcat sighs
[20:44:15] <strcat> debug print time
[20:44:29] <Luqman> same backtrace?
[20:44:34] <strcat> yep
[20:44:50] <strcat> so I think it's hitting it in the non-managed-unique path
[20:44:59] <strcat> because I restored it to using get_bodyptr with managed
[20:45:09] <strcat> so I think the pointer type is wrong
[20:45:42] <strcat> make_take_glue -> duplicate_uniq -> get_data_ptr -> GEPI -> die
[20:46:11] <strcat> get_dataptr is just an offset to the body field
[20:46:21] <strcat> so... I bet the type is somehow wrong
[20:46:47] <strcat> err, to the data field*
[20:47:05] <strcat> there are more issues anyway
[20:47:24] <ecr> olsonjeffery: hm. Well, I haven't started working on files or timers yet, but I'm trying to design a coherent interface for the whole I/O system at the moment (I want to try to integrate with iterators if possible) so the interface you'd be aiming for might end up changing. I'm not sure how much of the libuv wrappers for files & timers are implemented yet.
[20:47:47] <strcat> ecr: btw I'd like to have an output iterator, for writing to the end of a vector, file, etc.
[20:47:56] <strcat> so that's relevant to whatever you do
[20:48:05] <strcat> "iterator"
[20:48:13] <strcat> could be called an output stream or whatever
[20:48:25] <strcat> Writer would work, but that has weird extra stuff atm
[20:48:43] <olsonjeffery> ecr: timers is done.. there's nothing for file
[20:48:50] <ecr> strcat: that's something I'd like to do. maybe have Reader return an iterator and Writer take one. Haven't worked out all the details yet.
[20:49:10] <strcat> ecr: we have Iterator and DoubleEndedIterator now - missing RandomAccess + output
[20:49:25] <strcat> but in theory we wouldn't need a specific writer/reader thing for I/O beyond flushing
[20:49:44] <strcat> well, I guess you need seeking too
[20:49:53] <olsonjeffery> ecr: although maybe im misspeaking.. when you say wrapper, what do you mean.. ?
[20:50:36] <olsonjeffery> like the rustrt c++ wrapper code? or the c lib mappings from rust?
[20:50:59] <ecr> olsonjeffery: by wrapper I mean the rust layer over libuv, so std::rt::uv::file.rs. The higher level interface would be std::rt::io::file.rs.
[20:51:04] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[20:51:29] <olsonjeffery> gotcha.
[20:51:30] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:51:37] <ecr> strcat: working in the file/socket control operations is something I'm still trying to work out how to do
[20:52:38] *** Joins: reyre (reyre@6ED76315.415986EB.47C41102.IP)
[20:53:55] <jdm> any idea when the next snapshot will be?
[20:54:16] <jdm> mw's got a debuginfo PR that currently requres some stage0/!stage0 definitions
[20:54:41] <strcat> jdm: aatch was making one but the bot wasn't working
[20:54:49] <strcat> it's an old snapshot now though
[20:54:54] *** Joins: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP)
[20:55:08] <strcat> there was a 300MiB regression in mem usage and he wanted to fix it first but.... the revert didn't land and bitrotted
[20:56:08] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[20:58:16] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[20:58:29] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Quit: victorporof)
[20:58:33] <pcwalton> yeah, that's really unfortunate
[20:58:35] <ecr> olsonjeffery: how deep into newsched were you wanting to go?
[20:58:45] <pcwalton> can we not snapshot because of that regression?
[21:01:09] <bstrie> pcwalton: can decopy land before the snapshot?
[21:01:24] <pcwalton> I'm trying to land it but (surprise!) it's busted on windows because of check-fast
[21:01:39] *** Quits: reyre (reyre@6ED76315.415986EB.47C41102.IP) (Client exited)
[21:01:41] <pcwalton> I have been working all weekend on a linux VM.
[21:01:43] <pcwalton> err
[21:01:45] <pcwalton> on a Windows VM.
[21:01:50] <pcwalton> to try to fix this problem.
[21:01:59] <bstrie> ah ok, from looking at bors I just thought it was a merge error
[21:02:07] <olsonjeffery> ecr: all .. the way? it looks like the uv impl for timers is flushed out.. but there's nothing in std::rt::io
[21:02:17] <pcwalton> no
[21:02:33] <olsonjeffery> ecr: and timers probably won't involve any of the stream/iterable stuff you're flushing out
[21:02:38] <ecr> olsonjeffery: that's what I'd just noticed too
[21:03:01] <ecr> olsonjeffery: that would resolve #6435
[21:03:06] <strcat> ~"~[*libc::types::common::c95::c_void]"
[21:03:09] <strcat> hrm
[21:03:18] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:04:29] <strcat> Luqman: exact same kind of problems ;p
[21:04:40] <strcat> I don't like how it loses types so early
[21:05:02] *** Joins: fabiand (fabiand@moz-1C19620C.pool.mediaways.net)
[21:05:10] <strcat> with all the glue stuff
[21:05:31] <strcat> I think it's pretending all vectors are ~[()] in the place where I need to check if it's managed ;[
[21:05:40] <ecr> olsonjeffery: it'd involve designing an RtioTimer interface in std::rt::rtio.rs, implementing Timer in std::rt::io on top of it, and implementing RtioTimer for TimerWatcher in std::rt::uv::uvio.rs
[21:06:07] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[21:06:39] <olsonjeffery> ecr: thanks! i'll get started on that, then.. what can i look at for guidance? other things in rtio.rs ?
[21:07:28] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[21:07:57] <ecr> olsonjeffer: sure! I'd suggest looking at the networking stuff (TCP/UDP) as it's the only thing that's actually implemented fully.
[21:08:13] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:08:33] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[21:08:35] <strcat> yep
[21:08:43] <strcat> it's non-managed... according to the type
[21:08:45] <strcat> but it's boxed
[21:08:50] <strcat> maybe I just need to change a type somewhere
[21:09:32] <ecr> olsonjeffery: and you might want to look at the libuv timer interface as well to see if there's any additional functionality that still needs bindings (which would give you the bottom layer of newsched I/O in std::rt::uv::uvll.rs).
[21:09:33] <strcat> there we go
[21:09:35] <jasom_> is it possible to mark a closure as only being callable once, so that it can move out of closed-over references?
[21:09:36] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:10:18] <ecr> olsonjeffery: and you can shoot me questions too.
[21:10:39] <strcat> jasom_: there's a -Z flag for it
[21:10:46] <strcat> but it's not in the actual language yet
[21:11:06] <strcat> jasom_: the workaround used right now is std::cell
[21:11:11] <strcat> and .take()
[21:11:24] <strcat> so it would just fail!() if you called it again
[21:11:25] <olsonjeffery> ecr: will do
[21:11:56] <jasom_> strcat: thanks
[21:12:54] <strcat>     -Z once-fns             -- Allow 'once fn' closures to deinitialize captured variables
[21:12:56] <strcat> that one
[21:13:09] * strcat doesn't know the actual syntax though...
[21:13:18] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[21:13:29] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Client exited)
[21:14:12] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:14:20] <engla> I think it's just ~once fn()
[21:14:33] *** Quits: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[21:15:08] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:15:32] <sully> hey, who was it that was generating the memory usage graphs?
[21:15:42] <cmr> sully: 'ello
[21:15:54] <sully> if I wanted to generate those for changes I was working on locally
[21:15:58] <sully> how would I do that
[21:16:13] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[21:16:14] <sully> I have started worrying that a refactor I want to do might increase memory usage a lot
[21:16:27] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[21:16:28] <cmr> So https://github.com/cmr/rust-bench is all the scripts
[21:16:38] <sully> actually, it probably won't, hm.
[21:16:41] <cmr> You need Linux, with support for the memory and cpuacct cgroups
[21:16:59] <sully> hm, will those be enabled by default on an ubuntu kernel?
[21:17:03] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Ping timeout)
[21:17:15] <cmr> I think so
[21:17:21] <cmr> You'll also need the libcgroup tools
[21:17:35] <cmr> dunno what the package is on ubuntu, but it has the 'cgcreate' and 'cgexec' binaries
[21:17:54] <sully> cgroup-bin, looks like
[21:18:05] <sully> I really love the shell hook that figures out what package a command you tried to run is from
[21:18:08] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:18:19] <strcat> cmr: those are deprecated
[21:18:26] <strcat> they're going to stop working very soon ;p
[21:18:28] <sully> of course they are
[21:18:35] <cmr> soon as systemd updates aiui
[21:18:38] <strcat> you're better off using mkdir
[21:18:40] <cmr> but they work now, so
[21:18:56] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:18:57] <strcat> cmr: yeah but it's pretty easy to switch to file-access and then port that to the new way ;p
[21:19:03] <ecr> strcat: is there anything I need to read about iterators aside from std::iterator?
[21:19:24] <strcat> ecr: not really, there are implementations of FromIterator and Iterator/DoubleEndedIterator scattered around places like vec.rs though
[21:19:25] <cmr> sully: I use `sudo cgcreate -t $USER -a $USER -g cpuacct,memory:rustbench`, then you just run `mem-bench.py cmd > output.json` from rust-bench
[21:19:29] <strcat> ecr: I wrote an iterator tutorial btw
[21:19:41] <strcat> ecr: http://static.rust-lang.org/doc/tutorial-container.html#iterators for an overview
[21:19:54] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[21:20:15] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:20:15] *** ChanServ sets mode: +o tjc
[21:20:17] <sully> and then how do you run rustc in the cgroup?
[21:20:17] <cmr> sully: then you can run `plot_data.py first.json second.json git-commit-of-first -t title-of-graph`
[21:20:27] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:20:40] <cmr> sully: `mem-bench.py rustc ...` does it all for you
[21:20:42] <ecr> strcat: thanks.
[21:20:47] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[21:20:52] <sully> ok, thanks
[21:21:23] <cmr> strcat: How does one replicate whatever it is cgexec does easily?
[21:21:27] * cmr should just read the source
[21:21:44] <cmr> but I don't want my wrapper program as part of the cgroup for purposes of memory accounting, and I don't want to miss any data
[21:21:51] <cmr> maybe cgexec doesn't solve that second problem
[21:21:59] <strcat> cmr: mkdir to create a cgroup
[21:22:13] <strcat> and then echo the task pid to cgroup.procs (the 'tasks' file is deprecated)
[21:22:20] <strcat> cmr: you can echo 0 for the current pid
[21:22:23] <strcat> cmr: look at playpen ;p
[21:22:26] <strcat> it does it itself
[21:22:55] <cmr> strcat: well I know that part, but doesn't that include the process that you exec's memory usage? it'd skew the start of the graph
[21:23:13] <strcat> cmr: true, you probably want to fork, echo the pid and exec then
[21:23:20] <strcat> playpen does that ^
[21:23:21] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[21:23:23] <cmr> mmm
[21:23:45] *** bat is now known as jgilbert
[21:23:57] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[21:24:34] *** reyre_ is now known as reyre
[21:25:34] <strcat> cmr: I guess it's fine to use cgexec but... it'll break ;p
[21:25:42] <strcat> manually will break too but should be easy to update
[21:26:15] <strcat> they view the cgroup fs as exposing internal APIs like sysctl and have no problem completely changing it like they're about to
[21:26:39] <cmr> I'm fine with the new changes
[21:26:49] <strcat> unlike the normal completely stable kernel<->userland ABI
[21:26:58] *** Quits: livingparadox (skids@moz-1DA7B531.static.lsan.ca.charter.com) (Quit: Leaving)
[21:28:52] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[21:31:22] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:31:24] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[21:32:06] *** Quits: fabiand (fabiand@moz-1C19620C.pool.mediaways.net) (Quit: Verlassend)
[21:32:16] <fread2282> rusti: let foo = unsafe {1}; foo
[21:32:17] -rusti- <anon>:7:19: 7:29 warning: unnecessary `unsafe` block [-W unused-unsafe (default)]
[21:32:17] -rusti- <anon>:7          let foo = unsafe {1}; foo
[21:32:17] -rusti-                             ^~~~~~~~~~
[21:32:17] -rusti- 1
[21:32:58] <doomlord_> copy or clone ?
[21:33:35] *** Quits: igl (igl@moz-E04C2E11.adsl.alicedsl.de) (Ping timeout)
[21:33:58] <cmr> doomlord_: are you asking which to use?
[21:34:05] *** Quits: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de) (Ping timeout)
[21:34:12] *** Joins: igl (igl@moz-F88155D9.adsl.alicedsl.de)
[21:34:20] <doomlord_> yes i seem to remember putting in .clones() a lot , but i'm seeing 'copy' suggestion in error messages
[21:34:22] <cmr> clone, especially since `copy` is being removed asap
[21:34:37] <cmr> see: https://github.com/mozilla/rust/pull/7753
[21:35:26] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[21:35:47] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:36:01] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:36:03] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:36:08] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[21:36:16] <engla> rustc has strange humor, sometimes it suggests move
[21:36:28] <cmr> heh, still?
[21:36:38] *** Quits: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com) (Ping timeout)
[21:37:36] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[21:38:13] <engla> I think I've seen it
[21:38:14] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[21:40:01] <tikue> rusti: fn foo() { let x = || { return; }; x(); }
[21:40:13] <tikue> rusti? where r u
[21:40:14] *** ozten is now known as ozten|lunch
[21:40:20] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:40:23] *** strcat1 is now known as strcat
[21:40:39] <tikue> rusti: 1 + 1
[21:40:40] -rusti- 2
[21:40:44] <tikue> rusti: fn foo() { let x = || { return; }; x(); }
[21:40:45] -rusti- <anon>:7:33: 7:39 error: `return` in block function
[21:40:45] -rusti- <anon>:7          fn foo() { let x = || { return; }; x(); }
[21:40:45] -rusti-                                           ^~~~~~
[21:40:45] -rusti- error: aborting due to previous error
[21:40:45] -rusti- application terminated with error code 101
[21:40:53] <strcat> Luqman: meh, still not figured out
[21:40:55] <strcat> ;p
[21:41:25] <tikue> rusti: let x = || { return; }; let a = [1, 2, 3]; for a.iter().advance 
[21:41:26] -rusti- <anon>:8:4: 8:5 error: expected `{` but found `}`
[21:41:26] -rusti- <anon>:8     };
[21:41:26] -rusti-              ^
[21:41:26] -rusti- application terminated with error code 101
[21:41:37] <tikue> rusti: let x = || { return; }; let a = [1, 2, 3]; for a.iter().advance |i| { x(); }
[21:41:38] -rusti- <anon>:7:22: 7:28 error: `return` in block function
[21:41:38] -rusti- <anon>:7          let x = || { return; }; let a = [1, 2, 3]; for a.iter().advance |i| { x(); }
[21:41:38] -rusti-                                ^~~~~~
[21:41:38] -rusti- error: aborting due to previous error
[21:41:38] -rusti- application terminated with error code 101
[21:41:58] <strcat> ah and strings are going to break too ofc
[21:42:13] <strcat> but all unique strings will have no headers
[21:45:28] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[21:46:23] <strcat> tjc: heh you got there first
[21:46:37] <tjc> strcat: you snooze you lose :-)
[21:48:26] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[21:49:36] *** Quits: heftig (heftig@moz-52B7107B.dip0.t-ipconnect.de) (Ping timeout)
[21:49:44] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Connection reset by peer)
[21:50:22] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:50:43] <bblum> pcwalton: https://github.com/mozilla/rust/issues/7807 how hard do you think this would be?
[21:50:57] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[21:51:57] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90 [Firefox 24.0a2/20130711004005])
[21:53:06] *** Joins: heftig (heftig@moz-F0A5AD7E.dip0.t-ipconnect.de)
[21:53:08] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[21:53:12] *** Joins: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP)
[21:55:46] <strcat> compile_and_link: x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd.so
[21:55:49] <strcat> make: *** [x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd.so] Error 101
[21:55:50] <strcat> huh.
[21:56:48] <doener> rustc still running in a gdb session? IIRC that may cause that
[21:56:58] <doener> err, wait, that libstd, nvm
[21:57:06] <doener> s/that/that's/
[21:57:09] * doener should go to bed
[21:57:12] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Quit: zZ)
[22:00:37] <engla> this syntax works in match? Some(Bucket {key, value, _}) =>   i've been missing out
[22:02:05] <strcat> engla: well, any patterns
[22:02:11] <strcat> works in let too
[22:02:19] <strcat> or a fn param
[22:02:24] <engla> nice
[22:02:29] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:02:59] <engla> now the missing part is to have   "mut key" allowed so that it can by-move into a mutable variable..
[22:04:30] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[22:05:36] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[22:06:28] *** Joins: igl1 (igl@moz-12E580A9.adsl.alicedsl.de)
[22:06:47] *** Quits: igl (igl@moz-F88155D9.adsl.alicedsl.de) (Ping timeout)
[22:07:08] *** Quits: igl1 (igl@moz-12E580A9.adsl.alicedsl.de) (Connection reset by peer)
[22:07:45] *** Joins: igl (igl@moz-9480A14F.adsl.alicedsl.de)
[22:08:58] <vladimir-lu> can you define multiple variables on the same line (of the same type)?
[22:09:12] * sully hacking and slashing through trait system data structures
[22:09:24] <vladimir-lu> rusti: let mut a: u32, b: u32 = 0;
[22:09:25] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/iTRY
[22:09:27] <sully> CoherenceInfo and ProvidedMethodMap are dead
[22:09:44] <vladimir-lu> ah that's a different error than i was getting
[22:09:48] <engla> vladimir-lu: no
[22:09:52] <vladimir-lu> i see it's obsolete
[22:09:53] <sully> provided_method_sources is next against the wall
[22:10:12] <engla> vladimir-lu: only with tuples
[22:10:18] <sully> a new "impls" map has been added
[22:10:45] <vladimir-lu> engla: thanks
[22:11:29] *** Quits: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com) (Quit: jeff)
[22:11:31] <pcwalton> inline(never) works, right?
[22:12:33] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[22:13:44] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:14:04] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Max SendQ exceeded)
[22:15:20] <vladimir-lu> i take it you can't write a fixed-size slice of a ~[u8] and pass it as a borrowed, say &[u8, ..16] ?
[22:15:46] <strcat> pcwalton: yes
[22:15:50] <pcwalton> ok
[22:15:57] <strcat> pcwalton: there are only inline(never), inline(always) and inline
[22:16:08] <strcat> if you pass inline(any_token) it does inline
[22:16:16] <strcat> (other than never/always)
[22:16:19] <strcat> it should just reject it...
[22:16:51] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[22:17:10] <vladimir-lu> and vector destructuring doesn't seem to support destructuring by length
[22:19:28] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[22:19:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/E_YG2w
[22:19:28] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[22:21:46] *** ozten|lunch is now known as ozten
[22:22:20] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[22:22:20] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/91e3dQ
[22:22:20] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[22:22:23] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:22:23] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/u22nCw
[22:22:23] <ghrust> 13rust/06auto 14faa280c 15Andrew Paseltiner: std: add consuming iterators for `HashMap` and `HashSet`
[22:22:23] <ghrust> 13rust/06auto 14e844b52 15bors: auto merge of #7806 : apasel422/rust/hash_consume, r=catamorphism...
[22:22:23] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:22:55] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[22:23:09] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:23:22] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[22:24:01] <vladimir-lu> rusti: let v1: ~[u8] = [0, 1, 2, 3, 4]; let v2: &[u8, ..2] = v1[0:2]
[22:24:02] -rusti- <anon>:7:67: 7:68 error: expected `]` but found `:`
[22:24:02] -rusti- <anon>:7          let v1: ~[u8] = [0, 1, 2, 3, 4]; let v2: &[u8, ..2] = v1[0:2]
[22:24:02] -rusti-                                                                             ^
[22:24:02] -rusti- application terminated with error code 101
[22:29:05] <zslayton> I'm trying to write a method which returns a pointer to self so it can be chained. How can I correct "fn update(&mut self) -> & mut MyType<T>" so that the compiler's lifetime concerns are addressed?
[22:29:39] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[22:29:58] <strcat> Luqman: no luck ;p
[22:30:09] <bblum> zslayton: fn update<'a>(&'a mut self) -> &'a mut MyType<T>
[22:30:10] * strcat looks over the glue code
[22:30:27] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:30:36] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:31:02] <zslayton> bblum: Ahh, I was missing the leading <'a>
[22:31:06] <zslayton> bblum: Much obliged!
[22:31:06] <Luqman> strcat: your vec branch?
[22:31:14] <strcat> Luqman: yeah
[22:31:25] <bblum> zslayton: np
[22:31:30] <strcat> Luqman: https://github.com/thestinger/rust/tree/header
[22:32:13] <strcat> ~"~[repr::VariantState]"
[22:32:15] <strcat> it has one of these
[22:32:23] *** Joins: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de)
[22:32:24] <strcat> repr::VariantState is just a simple owned enum
[22:32:33] <Luqman> strcat: building now
[22:32:33] <strcat> vptr: ~"*{i64, i64, [{i64, i64, [i8 x 0]} x 0]}"
[22:32:37] <Luqman> stage1?
[22:32:44] *** kimundi is now known as zz_kimundi
[22:32:46] <strcat> Luqman: yeah it will die compiling libstd in stage1
[22:32:47] <strcat> from an assert
[22:32:49] <strcat> vptr: ~"*{i64, i64, [{i64, i64, [i8 x 0]} x 0]}"
[22:32:55] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[22:32:58] <strcat> it should be passed an unboxed ptr
[22:33:00] <strcat> like
[22:33:09] <strcat> * [{i64, i64, [i8 x 0]} x 0] or whatever
[22:33:28] <strcat> so take glue is passing duplicate_uniq an invalid ptr type but... who knows where it comes from
[22:33:33] <strcat> it's a 200 line traceback ;p
[22:33:55] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[22:34:12] <strcat> on the other hand
[22:34:16] <strcat> ~"~[*libc::types::common::c95::c_void]"
[22:34:20] <strcat> this one is passed correctly
[22:34:35] <zslayton> If I have a generic class "MyType<T>" and I want to write a constructor for it, what syntax do I use in the fn new() -> MyType<T> method so the caller can specify the type they want T to be?
[22:34:40] <Luqman> hmm weird
[22:35:43] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[22:35:50] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:36:03] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[22:36:03] *** Quits: RMF (RMF@moz-395E4371.dsl.telepac.pt) (Ping timeout)
[22:36:03] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:36:03] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:36:06] <jasom_> since strings are immutable, does cloning a string just return an additional reference to it?
[22:36:17] <strcat1> jasom_: strings aren't immutable
[22:36:17] <steven_is_false> zslayton: Generally one would do something like let foo: MyType<T> = MyType::new(); 
[22:36:19] *** Joins: igl1 (igl@moz-48D03918.adsl.alicedsl.de)
[22:36:23] <strcat1> jasom_: some are, but in general they aren't
[22:36:27] *** Quits: igl (igl@moz-9480A14F.adsl.alicedsl.de) (Ping timeout)
[22:36:47] <strcat1> the some things applying to other types apply to them
[22:36:47] <jasom_> strcat1: "All strings are immutable." from http://static.rust-lang.org/doc/0.7/tutorial.html#data-structures
[22:37:04] <strcat1> it's misleading wording
[22:37:14] <zslayton> steven_is_false: Makes sense. I'll give that a go, thanks
[22:37:19] <MaikKlein1> or Mytype::new::<int>();
[22:37:21] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[22:37:26] <steven_is_false> zslayton: Your welcome.
[22:37:28] <strcat1> jasom_: that section is just wrong
[22:37:50] *** Quits: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de) (Quit: Leaving)
[22:37:50] <strcat1> jasom_: the exchange/local heap thing it mentions is wrong too
[22:37:55] *** Joins: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de)
[22:38:12] <strcat1> it's just because it was written a long time ago
[22:38:46] *** Quits: mye (mye@moz-E79A8420.dip0.t-ipconnect.de) (Quit: mye)
[22:39:44] <strcat1> jasom_: &str/@str are shallowly copied on a clone, like &T and @T
[22:39:51] <zslayton> steven_is_false: I'm seeing this error in response to that syntax: "error: cannot determine a type for this bounded type parameter: unconstrained type"
[22:39:57] <strcat1> "foo" is an &'static str, so the &str semantics apply
[22:40:03] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[22:40:10] <strcat1> and like other & things it's immutable, but you can have &mut str too
[22:40:17] *** Joins: RMF (RMF@moz-F40FCF19.dsl.telepac.pt)
[22:40:21] <strcat1> ~str is mutable if the owner is, and @mut str is mutable
[22:40:25] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:40:31] <steven_is_false> zslayton: I think you did the declaration of the new function wrong.
[22:40:49] <zslayton> steven_is_false: haha, entirely possible. Sec, I'll c/p
[22:40:50] <steven_is_false> It should go like: impl <T> MyType<T> { pub fn new() -> MyType<T> { etc...
[22:40:54] *** zz_kimundi is now known as kimundi
[22:42:06] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:42:34] *** strcat1 is now known as strcat
[22:43:16] <zslayton> steven_is_false: I have a feeling I'm doing something wrong with my generics. Here's a cut-down version: http://pastebin.com/4ppT0wUz
[22:43:51] <steven_is_false> zslayton: I don't think the T parameter can be inferred.
[22:44:33] <steven_is_false> You'll have to put it on the individual methods like: pub fn do_iterate_stuff<T: Iterator<R>>(etc..
[22:45:07] *** Quits: cdidd (cdidd@moz-35D9B688.broadband.corbina.ru) (Ping timeout)
[22:45:34] <zslayton> steven_is_false: Oh, okay! That's straightforward enough. Thanks!
[22:45:46] <steven_is_false> Your welcome.
[22:46:38] *** Joins: cdidd (cdidd@moz-1F4FBDB7.broadband.corbina.ru)
[22:46:55] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[22:47:13] <fread2282> can I get make to recognize when my rust targets are up to date?
[22:49:40] *** Joins: mark_edward (quassel@moz-4A9A2F15.dynamic.utc.edu)
[22:50:16] <vladimir-lu> rusti: struct A { priv state: ~mut [u8, ..32] }
[22:50:50] <vladimir-lu> oh rusti died
[22:50:58] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[22:50:59] *** Quits: MaikKlein1 (maik@moz-5867653C.dip0.t-ipconnect.de) (Ping timeout)
[22:51:01] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:51:04] <strcat> vladimir-lu: it's my internet
[22:51:14] <strcat> vladimir-lu: ~mut doesn't exist anymore
[22:51:25] <strcat> ~ just inherits mutability from the owner, like a regular object
[22:51:48] <strcat> it just acts like a plain old object with a destructor does
[22:52:02] *** Joins: gps (gps@moz-DB4A9C19.scl3.mozilla.com)
[22:52:02] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[22:52:07] <vladimir-lu> but i can't write struct A { priv mut state } can I?
[22:52:23] <strcat> vladimir-lu: no, there aren't mutable fields
[22:52:31] <strcat> if the struct is mutable, the fields are mutable
[22:52:42] <vladimir-lu> ofc, inherited mutability
[22:52:42] <strcat> and then the vector will be mutable
[22:52:48] <fread2282> how can I do `for 1000.times |num|`?
[22:53:04] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[22:53:06] <strcat> fread2282: hm?
[22:53:16] <strcat> like uint::range?
[22:53:36] <sp3d> syntactically it has to be (1000).times if you're looking to implement that
[22:53:36] * strcat still has to replace those...
[22:53:39] <fread2282> strcat: yes, thanks
[22:53:50] <sp3d> (I think)
[22:53:59] <strcat> rusti: for 4.times { println("foo") }
[22:54:00] -rusti- foo
[22:54:00] -rusti- foo
[22:54:00] -rusti- foo
[22:54:00] -rusti- foo
[22:54:00] -rusti- ()
[22:54:01] <fread2282> strcat: I was looking for uint::range
[22:54:03] <vladimir-lu> i guess there's no way to restrict an impl to a mutable only struct?
[22:54:03] <sp3d> oh
[22:54:15] <strcat> vladimir-lu: &mut self
[22:54:20] <strcat> will only work on a mutable one
[22:54:24] <vladimir-lu> yay
[22:54:26] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[22:54:34] <strcat> vladimir-lu: self params are just taken as regular args are
[22:54:55] <vladimir-lu> strcat: thanks
[22:55:09] <vladimir-lu> that's not in the tutorial, though perhaps it should be
[22:55:35] <strcat> the tutorial pretty much needs to be rewritten
[22:57:19] <vladimir-lu> :)
[22:57:57] <vladimir-lu> another question
[22:58:07] <sully> woo, the purge of MethodInfo was easier than I expected
[22:58:41] <vladimir-lu> as the . operator can appear on the lhs of an assignment, should it be treated as an ident during macro expansion?
[22:58:50] <sully> (resolve::MethodInfo was like ty::Method but with less information, and we used it in a ton of places for unclear reasons)
[22:59:04] <sully> (none of those places appear to have actually been in resolve, though)
[23:01:14] <vladimir-lu> or should i just be treating it as an expr?
[23:03:13] *** Quits: ronny (ronnypfa@moz-E7EE6ABE.uberspace.de) (Ping timeout)
[23:03:23] <doomlord_> moving through the source i begin to respect the decision to make struct member initializers named
[23:04:32] *** Quits: fread2282 (Mibbit@F7A156AC.AD1795A.A6C6D82E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:07:24] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[23:10:05] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[23:11:31] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:12:04] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[23:12:09] *** Quits: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu) (Quit: Leaving)
[23:16:41] <engla> strcat: r? https://github.com/mozilla/rust/pull/7808
[23:21:19] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[23:25:02] <zslayton> I'm wrestling with the syntax for a method header with complicated (to me) lifetimes. fn update<'a, T: Iterator<R>>(&'a mut self, mut iter: T) -> &'a mut OnlineStatsIterator<R>
[23:25:22] <zslayton> I'd like the iterator to be Iterator <&'some_lifetime R> instead of Iterator<R>
[23:25:44] <Eridius> zslayton: unless self contains an existing OnlineStatsIterator, you probably don't want to be returning a borrowed pointer to it
[23:26:23] <zslayton> Eridius: What's the normal approach for chaining?
[23:26:48] <Eridius> zslayton: what exactly are you trying to do here? You're taking both self and another iterator?
[23:27:05] <zslayton> Eridius: The hope was that I'd be able to say myIterator.update(...).update(...).update(...)
[23:27:07] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[23:27:26] <Eridius> what does this call do? And what's self?
[23:27:58] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:28:06] <zslayton> Eridius: The update method takes another iterator which returns numbers and iterates over it collecting statistics
[23:28:41] <zslayton> Eridius: I'm hazy on named lifetimes -- I was trying to follow the compiler's suggestion. It was telling me to use 'self
[23:28:58] <zslayton> Eridius: self here is an OnlineStatsIterator
[23:29:41] <Eridius> ah
[23:29:58] <Eridius> so why do you want the consumed iterator to be <&'something R>?
[23:30:27] <zslayton> Eridius: That seems to be how vector iterators work, returning a borrowed reference to each item
[23:30:45] <zslayton> Eridius: I was hoping to take some_vector.iter() as a parameter to my update() method
[23:31:19] <Eridius> ok so what if you just declare another lifetime parameter and use that?
[23:32:00] <zslayton> Eridius: Something like: fn update<'a, 'b, T: Iterator<&'b R>>(&'a mut self, mut iter: T) -> &'a mut OnlineStatsIterator<R>
[23:32:05] <zslayton> Eridius: ?
[23:32:10] <Eridius> something like that, although you aren't defining what R is
[23:32:37] <zslayton> Eridius: R's definition is in the impl line. It's Num + Ord + ToStrRadix + Clone
[23:32:42] <Eridius> ah
[23:32:59] <Luqman> xxnx23
[23:33:12] *** Quits: stack (urb@moz-8D682D87.retail.telecomitalia.it) (Ping timeout)
[23:33:24] <doomlord_> rust bindgen - is there a good reason it seems to make structs names prefixed with Struct_
[23:33:51] <zslayton> Eridius: Trying to use 'b gets me this: error: Illegal lifetime 'b: only 'self is allowed as part of a type declaration
[23:34:02] <zslayton> Eridius: Which is why I went down the rabbit hole of messing with 'self
[23:34:26] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[23:34:49] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:35:02] <zslayton> Eridius: trying to use 'self gets me: "error: Illegal lifetime parameter name: `'self` "
[23:35:30] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:36:31] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[23:36:56] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[23:37:10] <bblum> turnaround time for libstd tests is so slow :(
[23:37:39] <bjz> bblum: do you do: make check-stage1-std NO_REBUILD=1
[23:38:10] <Eridius> zslayton: hmm, I'm not really sure what the solution is.
[23:39:19] <bblum> bjz: yes
[23:39:21] <Eridius> zslayton: maybe you should just take an Iterator<R>. After all, what if the numbers are provided by something other than a vector?
[23:39:33] <Eridius> if you want to use a vector you can always say v.iter().transform(|&x|x)
[23:39:55] *** Joins: tav (tav@moz-5ED3AF3C.range86-152.btcentralplus.com)
[23:40:03] <cmr> moral of the story: we need a copy_iter()
[23:40:14] <cmr> or a clone_iter() or something
[23:40:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:40:19] <Eridius> cmr: that's what I keep thinking. .iter_clone() perhaps
[23:40:20] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:40:26] <heftig> rusti: ()
[23:40:26] -rusti- ()
[23:40:27] <cmr> typing .transform(|&x| x) is starting to make my insides bleed
[23:40:28] <zslayton> Eridius: That's a good idea.
[23:40:40] <zslayton> cmr: Yeah, that'd be really helpful.
[23:40:43] <heftig> [1,2,3].iter().to_owned()
[23:40:48] <heftig> whoops
[23:41:12] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Ping timeout)
[23:41:24] <strcat> rusti: let xs = [1, 2, 3]; xs.iter().transform(|&x| x).collect::<~[int]>()
[23:41:25] -rusti- ~[1, 2, 3]
[23:41:27] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[23:41:52] <strcat> cmr: map(|&x| x) won't be as bad
[23:41:55] <strcat> ;p
[23:42:01] <cmr> strcat: true
[23:42:22] <cmr> but that's just prolonging how long it takes for me to bleed out
[23:42:22] <strcat> whoa major regression in rust size
[23:42:25] *** Quits: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: dherman)
[23:42:29] <strcat> thestinger/rust-git  0.7.483.g0cb1ac0-1  0.7.502.g9d7e01b-1  22.40 MiB       31.65 MiB
[23:42:34] <strcat> 22.40MiB bigger
[23:42:35] <strcat> oh
[23:42:36] <Eridius> it'll still be ugly though, and this transformation is so common that it deserves its own function
[23:42:39] <cmr> dbaupp: ohh, I should start measuring the size of the intermediate binaries
[23:42:41] <strcat> it installs two rustllvm.so libs now
[23:42:44] <strcat> it should use a symlink
[23:42:51] <ecr> Is there documentation on conditions somewhere?
[23:42:54] <dbaupp> cmr: just about to suggest it :)
[23:42:54] * strcat will make the package use a symlink at least
[23:42:55] <cmr> ecr: the source
[23:42:58] <heftig> strcat: convenience function to just gather all iterator values into an owned vector would be nice
[23:43:02] *** Quits: Guest (textual@34641662.FB4DE631.66C78B76.IP) (Quit: Textual IRC Client: www.textualapp.com)
[23:43:05] <ecr> cmr: no comments :(
[23:43:10] <cmr> ecr: tests!
[23:43:15] <strcat> heftig: it won't be much more convenient than .collect() though
[23:43:38] <heftig> strcat: why do you need the transform() right now?
[23:43:38] <cmr> yeah. frequently I don't even need a type hint on .collect(), it usually is going to an already-typed place
[23:43:47] <strcat> heftig: because the vector iterators are by-reference
[23:43:54] <strcat> unless you use consume
[23:44:05] <dbaupp> cmr: but when you do need one, with a complicated inner type... it's horrible
[23:44:18] <strcat> we need partial type hints
[23:44:32] <dbaupp> or just plain old higher kinded types
[23:44:35] * dbaupp would like that
[23:44:48] <pcwalton> is there a way to get stack traces on windows? :(
[23:44:58] <strcat> pcwalton: doesn't gdb work?
[23:45:04] <strcat> from mingw
[23:45:04] <pcwalton> it's incomplete
[23:45:06] <strcat> oh
[23:45:29] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[23:45:34] <strcat> does rust run in wine? ;p
[23:45:40] <cmr> heh
[23:45:59] <cmr> pcwalton: haven't used rust on windows in a while?
[23:46:02] <Jeaye> Log each function entrance. >.<
[23:46:07] <cmr> (or ever...)
[23:47:53] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[23:48:36] *** Joins: stack (urb@moz-27F55522.retail.telecomitalia.it)
[23:51:32] <engla> strcat: iterator question, working on hashset difference iterator. I don't think it's possible to solve this with the normal iterator combinators, so here is a custom FilterIterator with explicit environment pointer. https://gist.github.com/anonymous/439ec7fbea59822af381   what do you say, is it possible with std::iterator combinators?
[23:52:01] <ecr> I can only conclude that condition! is magic
[23:52:04] <strcat> engla: you should be able to capture it
[23:52:09] <Eridius> ecr: and why do you conclude that?
[23:52:09] <strcat> the reference to other
[23:52:15] <strcat> single it's just a stack closure
[23:52:25] <cmr> http://libcello.org/
[23:52:25] <tjc> ecr: rustpkg uses it somewhat, you could look there if you're looking for examples
[23:52:32] <tjc> I thought it was magic too until I used it :-)
[23:52:43] <ecr> Eridius: it's defined by a @str returned from a function
[23:53:00] <Eridius> ecr: what do you mean?
[23:53:37] <engla> strcat: I don't know which lifetimes to use with iterator::FilterIterator.
[23:53:55] <engla> I mean, I don't know how to convince it to do the equivalent thing
[23:54:03] <strcat> engla: just pass it the closure
[23:54:05] <strcat> as you're doing now
[23:54:10] <strcat> and use other in the closure
[23:54:14] <ecr> Eridius: look up the macro_rules! for condition in libsyntax/ext/expand.rs
[23:54:18] <strcat> and add 'r to &self and the other param
[23:54:34] <strcat> it should work the same way
[23:54:42] <strcat> closures already have an environment
[23:54:49] <strcat> &fn is an environment ptr + function ptr
[23:54:57] <dbaupp> ecr: https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/expand.rs#L577
[23:55:06] <dbaupp> oh, you've already seen that
[23:55:09] <dbaupp> Eridius: ^
[23:55:32] <Eridius> yes I've read that macro_rules before. I'm just still not sure what ecr means by "it's defined by a @str returned from a function"
[23:55:58] * strcat is hitting a wall on the vector headers
[23:56:00] <strcat> ;[
[23:56:14] *** Joins: alisdair (textual@moz-EA60A466.dedicated.allstream.net)
[23:56:17] <engla> strcat: code + rustc errors   https://gist.github.com/anonymous/ec526dcf62c6d1d1e30f
[23:56:18] <ecr> Eridius: if you scroll up to line 455, you'll see that all those macro_rules! are actually in a @str
[23:56:24] <dbaupp> ecr: you understand that there are a pile of macros that are inserted into the top of each file (that huge string)
[23:56:30] <dbaupp> ecr: '<core-macros>'
[23:56:41] <Eridius> ecr: ahhh, I see what you mean. Yeah that's funky
[23:56:45] <ChrisMorgan> YAY! I can finally continue taking HTTP requests and sending out HTTP responses without failures :-)
[23:56:54] <Eridius> my assumption is that this will go away once we can actually control the visibility of macros
[23:56:57] <ecr> dbaupp: ah, that makes more sense. once I saw it I figured something like that was going on.
[23:57:07] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[23:57:09] <dbaupp> Eridius: yeah, once macros can be exported
[23:57:09] <cmr> ChrisMorgan: writing your own parser or using a lib?
[23:57:18] * dbaupp things that'll take a lot of effort
[23:57:19] <ChrisMorgan> cmr: pure Rust code
[23:57:22] <cmr> ChrisMorgan: nice :)
[23:57:29] <dbaupp> *thinks
[23:58:04] *** Quits: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP) (Quit: ëžœë¤ì€ ì‡ í‡´í–ˆìŠµë‹ˆë‹¤.)
[23:58:11] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:58:35] <ChrisMorgan> I have my own fancy HTTP request parser (incomplete, can't copy with a body yet) with elegant state machines which end up considerably more elegant in Rust than in Python.
[23:58:38] <tikue> rusti: struct Foo { bar: uint, baz: uint }; match Foo { bar: 0, baz: 1 } { Foo {bar : bar, *} => bar
[23:58:38] -rusti- <anon>:10:0: 10:1 error: file ended with unbalanced delimiters
[23:58:38] -rusti- <anon>:10 }
[23:58:38] -rusti-           ^
[23:58:39] -rusti- application terminated with error code 101
[23:58:43] <tikue> rusti: struct Foo { bar: uint, baz: uint }; match Foo { bar: 0, baz: 1 } { Foo {bar : bar, *} => bar }
[23:58:43] -rusti- <anon>:7:93: 7:94 error: expected ident, found `*`
[23:58:44] -rusti- <anon>:7          struct Foo { bar: uint, baz: uint }; match Foo { bar: 0, baz: 1 } { Foo {bar : bar, *} => bar }
[23:58:44] -rusti-                                                                                                       ^
[23:58:44] -rusti- application terminated with error code 101
[23:58:50] <tikue> rusti: struct Foo { bar: uint, baz: uint }; match Foo { bar: 0, baz: 1 } { Foo {bar : bar, _} => bar }
[23:58:51] -rusti- 0
[23:58:55] <dbaupp> ChrisMorgan: there's a Rust backend for ragel somewhere btw
[23:58:56] <cmr> ChrisMorgan: yeah, Python state machines are iffy business
[23:59:10] <cmr> ChrisMorgan: I wrote one today, and the whole time I was muttering "where are my enums where are my enums"
[23:59:18] <strcat> engla: looks like it should work
[23:59:19] * strcat shrugs
[23:59:20] <tikue> cmr: ha
[23:59:21] <engla> strcat: we've discussed this before, but here we have an actual example of the limits of stack closures. A &'static closure + explicit environment is more useful sometimes.
[23:59:31] <engla> strcat: a shrug is all? what does that mean
[23:59:35] <ChrisMorgan> dbaupp: but pure rust works so elegantly!
