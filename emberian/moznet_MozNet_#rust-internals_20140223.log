[00:03:10] <huon> r? https://github.com/mozilla/rust/pull/12481
[00:12:00] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[00:12:00] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/5FE0Pg
[00:12:00] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[00:14:26] * bjz is finding it more and more weird that the explicit `self` thing mixes the identifier and type
[00:15:00] <bjz> also makes pattern matching on `self` impossible
[00:15:03] <huon> \o/ hash
[00:15:22] <huon> bjz: how often does one really need pattern matching on self, though?
[00:15:44] <bjz> I know, but it's still odd
[00:15:51] <huon> (Also, it's nice to avoid having to write out `self: <whole Self type again>` every time)
[00:16:08] <huon> ... maybe we could just allow `Self` in impls
[00:16:23] <huon> fn my_method(self: &Self, ...)
[00:16:50] <huon> would make smart pointers sane(ish) too: `fn my_method(self: Rc<Self>, ...)
[00:16:56] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:16:56] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/3giKzQ
[00:16:56] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:16:57] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:16:57] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/P_MEsg
[00:16:57] <ghrust> 13rust/06auto 147841968 15Alex Crichton: rustdoc: Add syntax highlighting...
[00:16:57] <ghrust> 13rust/06auto 149c3825c 15bors: auto merge of #12416 : alexcrichton/rust/highlight, r=huonw...
[00:16:57] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:17:41] <bjz> fn op(self: &Self, other: Self) == fn op(x: &Self, y: &Self)
[00:18:34] <bjz> x.op(&y) sugar for Op::op(&x, &y), as opposed to Op::op(&x, &y) being sugar for x.op(&y)
[00:18:49] <bjz> seems less convoluted to me
[00:24:55] <huon> bjz: yeah
[00:36:16] * bjz wonders if we can convince pcwalton xD
[00:37:27] <huon> bjz: well, Op::op is likely to appear
[00:37:33] <bjz> yeah
[00:37:43] <bjz> I am worried the change might conflict though
[00:37:54] <huon> with?
[00:37:57] <bjz> if it was going to be the reverse
[00:38:05] <bjz> x.op(&y) sugar for Op::op(&x, &y), as opposed to Op::op(&x, &y) being sugar for x.op(&y)
[00:38:34] <bjz> fn op(x: &Self, y: Self) instead of fn op(&self, other: Self)
[00:47:38] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[00:50:06] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[00:51:55] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[00:51:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 149c3825c to 1422d3669: 02http://git.io/N3iJvQ
[00:51:55] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[00:51:56] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[00:51:57] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/9WwK2Q
[00:51:57] <ghrust> 13rust/06auto 144687e1d 15Daniel Micay: remove the TyDesc from TypedArena...
[00:51:57] <ghrust> 13rust/06auto 1441a79ba 15bors: auto merge of #12444 : thestinger/rust/arena, r=huonw...
[00:51:57] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[01:02:47] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:02:47] *** ChanServ sets mode: +qo brson brson
[01:13:53] *** Quits: zimbabao (rajaram@7BC0686F.29A8FC38.D2D1FAF0.IP) (Quit: Leaving)
[01:16:42] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:27:06] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[01:27:06] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1441a79ba to 1422d3669: 02http://git.io/N3iJvQ
[01:27:06] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[01:38:35] *** kimundi is now known as zz_kimundi
[01:39:29] *** Quits: gimpf (gimpf@moz-960833E1.adsl.highway.telekom.at) (Quit: Leaving.)
[01:41:43] <erickt> yay! my PR landed!
[01:42:54] <huon> erickt: \o/
[01:46:54] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:46:55] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/FcVAqw
[01:46:55] <ghrust> 13rust/06auto 14991d466 15Alex Crichton: rustc: Compress bytecode files in rlibs...
[01:46:55] <ghrust> 13rust/06auto 143cf0b9b 15Alex Crichton: mk: Don't install host rlibs...
[01:46:55] <ghrust> 13rust/06auto 144995a85 15bors: auto merge of #12448 : alexcrichton/rust/smaller-rust, r=brson...
[01:46:57] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:54:12] *** Quits: flaper87|afk (flaper87@moz-107AD163.redhat.com) (Ping timeout)
[01:58:00] *** Joins: flaper87|afk (flaper87@moz-107AD163.redhat.com)
[02:01:03] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[02:06:19] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[02:21:45] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:26:34] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:30:36] *** Quits: flaper87|afk (flaper87@moz-107AD163.redhat.com) (Ping timeout)
[02:32:12] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[02:34:33] *** Joins: flaper87|afk (flaper87@moz-107AD163.redhat.com)
[02:45:23] *** Quits: flaper87|afk (flaper87@moz-107AD163.redhat.com) (Ping timeout)
[02:49:04] *** Joins: flaper87|afk (flaper87@moz-107AD163.redhat.com)
[02:54:54] *** Quits: flaper87|afk (flaper87@moz-107AD163.redhat.com) (Ping timeout)
[02:56:59] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[02:56:59] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/FcVAqw
[02:56:59] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[02:58:34] *** Joins: flaper87|afk (flaper87@moz-107AD163.redhat.com)
[03:01:59] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[03:02:00] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/6CY8JA
[03:02:00] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[03:06:54] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[03:06:54] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/E9I9yQ
[03:06:54] <ghrust> 13rust/06auto 144687e1d 15Daniel Micay: remove the TyDesc from TypedArena...
[03:06:54] <ghrust> 13rust/06auto 14a0f0699 15bors: auto merge of #12444 : thestinger/rust/arena, r=huonw...
[03:06:55] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[03:06:56] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:06:57] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/6CY8JA
[03:06:57] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:09:59] *** Quits: zz_kimundi (kimundi@moz-AE597961.dip0.t-ipconnect.de) (Ping timeout)
[03:13:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:13:43] *** Joins: zz_kimundi (kimundi@moz-B191E9F0.dip0.t-ipconnect.de)
[03:13:45] *** zz_kimundi is now known as kimundi
[03:15:07] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[03:15:11] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[03:15:12] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[03:15:50] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:16:09] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:16:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:16:39] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[03:19:20] <bjz> brson: https://github.com/mozilla/rust/pull/12485
[03:21:27] <huon> bjz: IterBytes is also being phased out
[03:21:31] <huon> (just pending a snapshot
[03:21:33] <huon> )
[03:21:36] <huon> speaking of which...
[03:21:37] <bjz> oh ok
[03:21:45] <bjz> so it is ok to remove it?
[03:21:48] <huon> yeah, definitely
[03:21:52] <bjz> from the prelude?
[03:21:54] <bjz> coolies
[03:22:25] <bjz> it's awesome that the prelude is getting smaller
[03:23:24] <bjz> hopefully will remove some of those numeric traits in the future too
[03:23:44] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:23:44] <ghrust> [13rust] 15huonw merged 06master into 06snap-stage3: 02http://git.io/boDXKA
[03:23:44] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:23:47] <bjz> huon: could you comment that on the issue too?
[03:23:56] <bjz> the iterbytes thing?
[03:29:49] *** Joins: new_one (new_one@moz-B981A17A.rice.edu)
[03:37:18] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[03:49:56] <bjz> acrichto: I'm wondering if we should be moving away from FromStr, to something based on Readers. like std::parse
[03:50:12] <bjz> acrichto: would mirror std::fmt
[03:51:49] <bjz> then have a Parse::from_str function that has a default impl. or something
[04:10:44] <huon> at least having from_str_partial(s: &str) -> Option<(T, &str)> would be useful
[04:11:01] <huon> (i.e. parsing from the prefix, returning the remaining string)
[04:11:05] <bjz> yep
[04:11:13] <cmr> can someone do something to make https://github.com/mozilla/rust/pull/12487 not hold up the bors queue?
[04:11:18] * cmr very afk atm
[04:11:32] <bjz> how?
[04:11:43] <cmr> rollup, direct push to master between merges, anything :P
[04:11:45] <huon> cmr: https://github.com/mozilla/rust/pull/12484
[04:12:02] <bjz> lulz
[04:12:30] <cmr> feh
[04:12:38] <bjz> and cmr gets the "Too Slow!" medal
[04:12:48] <bjz> s/medal/badge/
[04:12:56] <bjz> thing
[04:12:58] <bjz> o_o
[04:16:58] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[04:16:58] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/E9I9yQ
[04:16:58] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[04:21:59] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[04:21:59] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/_Zx_8w
[04:21:59] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[04:31:03] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[04:40:58] *** Joins: tjc (tjc@moz-87640F27.phlapa.east.verizon.net)
[04:40:58] *** ChanServ sets mode: +o tjc
[04:50:17] <huon> acrichto: ping
[05:07:04] <bjz> is floating point addition and multiplication associative?
[05:07:13] <bjz> (a + b) + c = a + (b + c)
[05:08:15] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Quit: canhtak)
[05:09:13] <strcat> bjz: I don't think so
[05:09:20] <bjz> ok
[05:09:24] <strcat> with respect to IEEE754 semantics at least
[05:09:26] <bjz> didn't think so
[05:09:43] <strcat> if you ignore the strict IEEE754 semantics (you can tell LLVM to ignore it in a scope) then it can be ;p
[05:10:13] <bjz> :P
[05:10:42] <bjz> how would it do that?
[05:10:48] <bjz> extra calculations?
[05:11:38] <strcat> bjz: http://llvm.org/docs/LangRef.html#fast-math-flags
[05:12:07] <bjz> ohh
[05:12:27] <bjz> as in, let llvm "pretend" that they are associative
[05:12:42] <strcat> bjz: and http://llvm.org/docs/LangRef.html#fpmath-metadata
[05:12:49] <strcat> fpmath metadata may be attached to any instruction of floating point type. It can be used to express the maximum acceptable error in the result of that instruction, in ULPs, thus potentially allowing the compiler to use a more efficient but less accurate method of computing it. ULP is defined as follows:
[05:13:34] <bjz> ok
[05:13:36] <strcat> bjz: I think it would be really neat to build a really thin layer over LLVM just making it sane for humans to use the IR semantics directly
[05:13:46] <bjz> yeah
[05:13:49] <strcat> so, a programming language, but evolving as the IR semantics evolve
[05:13:56] <bjz> that would be neat
[05:13:57] <strcat> and not adding anything with inherent overhead over it
[05:15:00] <bjz> wut: range metadata may be attached only to loads of integer types.
[05:15:18] *** Quits: tjc (tjc@moz-87640F27.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:16:07] <strcat> bjz: yeah, we use it for bool, char and enum discriminants.
[05:16:22] <strcat> bjz: it was added to LLVM for a specific clang use case
[05:16:22] <bjz> could it be used for range types?
[05:16:28] <strcat> bjz: range types?
[05:16:51] <huon> bjz: I'd guess that multiplication might be associative...
[05:16:52] * huon thinks
[05:16:55] <strcat> clang represents bool as i1
[05:17:01] <bjz> integers only in a specific range
[05:17:03] <strcat> but stores as i8 in locals/structs
[05:17:18] <strcat> bjz: well, it has to be true or it's undefined behaviour
[05:17:22] <strcat> if you're enforcing the ranges, yes
[05:17:27] <bjz> ahh
[05:17:34] <bjz> so they are not for enforcing
[05:17:36] <huon> oh, no, of course not. MAX * MAX * (1/MAX) is different depending how you bracket.
[05:17:39] <bjz> only for optimising
[05:17:57] <strcat> bjz: yeah
[05:18:10] <strcat> bjz: they were added for an incredibly narrow use case, but they added them as a generic feature useful elsewhere
[05:18:18] <strcat> bjz: the narrow use case is optimizing a load of a bool in clang
[05:18:23] <bjz> heh
[05:18:24] <strcat> since it has to truncate i8 -> i1
[05:18:26] <strcat> it was doing an AND
[05:18:32] <strcat> but it should be a no-op
[05:18:35] <bjz> glad we could use them then
[05:23:37] *** Joins: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP)
[05:24:26] *** Quits: new_one (new_one@moz-B981A17A.rice.edu) (Quit: leaving)
[05:33:43] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[05:56:54] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:56:54] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/lX2V9Q
[05:56:54] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:01:54] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[06:01:54] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/nAj5QQ
[06:01:54] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[06:01:56] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[06:01:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Vo8gzw
[06:01:56] <ghrust> 13rust/06auto 147607332 15Edward Wang: Represent lifetimes as Names instead of Idents...
[06:01:56] <ghrust> 13rust/06auto 14edf351e 15bors: auto merge of #12451 : edwardw/rust/ident-2-name, r=cmr...
[06:01:56] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[06:02:12] <cmr> eugh bors is just hitting that now?
[06:03:09] <huon> cmr: bors has had a *huge* queue :(
[06:05:27] <edwardw> yep
[06:06:07] <edwardw> BTW, hygienic labels patch seems to be ready. https://github.com/mozilla/rust/pull/12338
[06:08:34] <huon> edwardw: awesome! can you squash the commits? (and also give the "Rename LIFETIME" one a better message... :) )
[06:09:03] <edwardw> huon: I just squashed them
[06:12:29] <edwardw> we had a new snapshot?
[06:13:31] <huon> edwardw: awesome... could you give a more detailed description too?
[06:14:43] <huon> something along the lines of "Make labelled loops hygiene. Perform renaming of the labels in e.g. `'x: loop { ... } so that they act hygienically when used with macros.`
[06:14:43] <edwardw> huon: the most cryptic part if rename token::LIFETIME, which I added comments inside fold.rs. Is that ok? 
[06:14:54] <edwardw> Ah, I see
[06:15:13] <huon> (I guess mentioning break and continue would be good too.)
[06:15:23] <edwardw> sure
[06:20:41] <edwardw> done
[06:22:50] <huon> edwardw: did you see my comments? ( https://github.com/edwardw/rust/commit/90cd3eeced75f3a4e99060f1c978cee98c59a438 if you've lost the link)
[06:22:59] <edwardw> I'm reading them
[06:23:33] <huon> cool (just not sure if you'd missed them after the rebase)
[06:26:10] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[06:30:49] <edwardw> huon: done
[06:30:53] <brson> DeepClone doesn't seem to be used. Can we consider removing it?
[06:31:28] <cmr> its primary usecase was @T and I imagine it's going to be useful for Gc again.
[06:31:43] <huon> and Rc
[06:31:48] <huon> and Arc
[06:31:49] <cmr> well, any shared smart pointer is going to want it
[06:31:51] <cmr> right
[06:31:53] <huon> and anything shared :P
[06:32:24] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[06:33:52] <brson> when do you want to do a deep clone?
[06:34:01] <brson> it's really not clear to me
[06:34:16] <cmr> any time you want an independant copy of some shared data.
[06:34:44] <brson> i don't know specifically when you would want an independent copy - I chose Gc for a reason
[06:34:59] <brson> even after the deep clone you've still got a Gc pointer
[06:35:05] <brson> just the wrong one
[06:36:45] <cmr> yeah neither do I
[06:41:09] <strcat> brson: if you take gc'ed stuff by-value and want to mutate it without it being visible to the caller
[06:42:01] <brson> strcat: by-value, deeply
[06:42:49] <brson> are there places where that is useful?
[06:43:14] <strcat> I think so. it's just that shared ownership isn't used much in rust
[06:51:33] <acrichto> huon: pong
[06:55:27] <huon> acrichto: was just wondering how to run a python script as part of a run-make test since $(CFG_PYTHON) didn't seem to be working, but it doesn't matter... I did the correct thing and wrote it in Rust
[06:55:50] <acrichto> hm CFG_PYTHON should have worked...
[06:55:51] <acrichto> brb
[06:59:22] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[07:08:15] <acrichto> bjz: it's an interesting idea focusing parsing on readers
[07:08:39] <acrichto> I think that we'd need a scanf-style implementation to make it feasible
[07:09:06] <bjz> acrichto: just an idea
[07:09:23] <huon> using a reader does make it hard to be guaranteed to be able to continue to use the reader after parsing something
[07:09:43] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[07:09:48] <huon> (i.e. no partial parses, because, in general, things will have to read arbitarily far ahead; consuming the reader.)
[07:10:02] <bjz> ah
[07:10:10] * eddyb likes state machines
[07:10:47] <huon> eddyb: they don't work for everything :P
[07:11:09] <acrichto> brson: are you able to enable travis for the rust repo?
[07:11:15] * eddyb constructs an automaton and sends it after huon
[07:11:28] <brson> acrichto: how would i find out?
[07:11:46] <acrichto> https://travis-ci.org/profile/mozilla
[07:12:01] <acrichto> there should be a flip button next to the rust repo
[07:12:14] <acrichto> for me it's in the category of "Repositories without admin access"
[07:12:34] <huon> eddyb: that's a task that they specifically don't work for :P
[07:12:40] <bjz> acrichto: more thoughts on https://github.com/mozilla/rust/pull/12473 ?
[07:12:59] <eddyb> huon: hehe oops
[07:13:01] <brson> travis sure wants a lot of write permissions
[07:13:41] <strcat> yeah travis freaked me out with how much stuff it wanted ;s
[07:14:29] <brson> acrichto: do you want travis turned on for rust, right now?
[07:14:41] <huon> weren't travis the people who screwed up and force pushed to like 400 GH repos a while ago?
[07:14:49] <eddyb> lol
[07:14:49] <acrichto> brson: yeah, but turn on "only with .travis.yml", turn off for pushes, and turn on for PRs
[07:14:55] <cmr> I feel like I would have heard about that.
[07:15:53] <edwardw> what travis can do and bors can't?
[07:15:55] <acrichto> bjz: let's do it
[07:16:00] <eddyb> http://www.reddit.com/r/rust/comments/1ykop6/so_i_wrote_a_dominion_simulator_in_rust_though/cfmekl6?context=10
[07:16:05] <cmr> edwardw: be faster + parallel
[07:16:16] <eddyb> huon: ^^ you'd think that would be easy to fix
[07:16:17] <edwardw> I see
[07:16:27] <huon> cmr: https://groups.google.com/d/msg/jenkinsci-dev/-myjRIPcVwU/t4nkXONp8qgJ
[07:16:36] <huon> eddyb: no idea
[07:16:47] <huon> (it was jenkins, not travis)
[07:16:52] <eddyb> should I take a stab at it?
[07:17:23] <brson> travis's project listing isn't quite prepared for mozilla's size
[07:17:33] <cmr> ah that reminds me
[07:17:37] <brson> acrichto: rust is turned on in travis
[07:17:38] <eddyb> also, simple inference for statics would be nice
[07:17:41] <huon> edwardw: our use of travis is just designed to give people fast feedback (but not comprehensive)
[07:17:47] <cmr> are we moving mozilla/rust to rust-lang/rust ?
[07:17:49] <huon> eddyb: there's a bug about that
[07:17:57] <huon> iirc
[07:18:08] <acrichto> brson: hurray! btw I contacted the travis team and they said that our load didn't seem unusual at all
[07:18:30] <brson> cmr: i'm not sure yet. there has been internal discussion recently about the size of the mozilla org on github and the vast number of people with admin rights
[07:18:36] <brson> cmr: it may be best for us to get out
[07:18:53] <brson> that's a fairly big move though
[07:18:57] <cmr> it shouldn't be.
[07:19:01] <cmr> github does redirects.
[07:19:07] <eddyb> break all the remotes!
[07:19:09] <cmr> although maybe that's only renames within an org.
[07:19:09] <eddyb> ahh
[07:19:12] <huon> brson, acrichto: should someone send an email to the ML explaining what the extra "noise" on PRs is?
[07:19:25] <huon> cmr: I thought renames worked for any ownership transfer
[07:19:30] <cmr> it might.
[07:19:35] <cmr> I hope it does.
[07:20:12] <acrichto> huon: probably yeah, I'd like to see what it looks like first though
[07:20:29] <brson> acrichto: i'm looking forward to seeing how this works out
[07:20:29] <huon> should I open a PR?
[07:20:35] <brson> we may be able to move more infrastructure to travis
[07:20:36] <acrichto> huon: sure!
[07:20:39] <cmr> I'm worried that bors and travis are going to clash, with test status.
[07:21:17] <acrichto> bors will not clash
[07:21:21] <acrichto> I verified 
[07:21:32] <cmr> do both of the status show up on the PR?
[07:21:51] <acrichto> that's what I'm curious about
[07:21:52] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:21:52] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/Vo8gzw
[07:21:52] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:22:20] <huon> https://github.com/mozilla/rust/pull/12489
[07:22:33] <huon> edwardw: \o/
[07:22:38] <acrichto> https://travis-ci.org/mozilla/rust/builds/19430416
[07:22:55] <huon> awesome
[07:23:00] <acrichto> "The Travis CI build is in progress"
[07:23:20] <huon> do the dates in the snapshot lines have any timezone requirements?
[07:23:26] <acrichto> huon: I'm curious if you get an email as well for a successful test run
[07:23:32] <brson> that's so cool
[07:23:34] <acrichto> I think they're relative to bors
[07:23:39] <acrichto> bors standard time
[07:23:47] <edwardw> huon: ?
[07:24:03] <edwardw> huon: ah travis. awesome
[07:24:31] <edwardw> happens automatically?
[07:24:34] <brson> acrichto: this probabl does warrant a note to the ml
[07:24:39] <Luqman> acrichto: it builds with vanilla llvm?
[07:24:49] <acrichto> brson: I agree, let's see how this first one ends up
[07:24:57] <acrichto> Luqman: it uses LLVM's nightly repos to install a ubuntu package
[07:25:01] <huon> edwardw: no, your patch landed :)
[07:25:10] <acrichto> Luqman: https://github.com/mozilla/rust/blob/master/.travis.yml#L11-L17
[07:25:34] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Quit: Leaving)
[07:25:38] <edwardw> huon: then I should rebase my hygiene patch, don't I?
[07:25:55] <Luqman> acrichto: yea, i saw. that was the bit i was curious. just trying to remember how much really depends on some of our patches
[07:26:03] <huon> edwardw: check to see what github says
[07:26:18] <acrichto> Luqman: it's a few perf things as well as segmented stacks on platforms other than x86/x64
[07:26:27] <edwardw> huon: what about GH?
[07:26:37] <huon> edwardw: ah, yes, looks like it's not automatically recognised that the first commit has landed
[07:26:40] <huon> https://github.com/mozilla/rust/pull/12338
[07:26:56] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:26:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/hDVRfQ
[07:26:56] <ghrust> 13rust/06auto 145b4c01b 15Alex Crichton: Roll std::run into std::io::process...
[07:26:56] <ghrust> 13rust/06auto 1454b9bf9 15bors: auto merge of #12380 : alexcrichton/rust/run-rewrite, r=brson...
[07:26:57] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:26:58] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:26:58] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/GTFSCQ
[07:26:58] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:27:00] <eddyb> ohh, Hash landed :D
[07:27:01] <edwardw> huon: so a rebase is in order
[07:27:17] <eddyb> bench pls
[07:27:21] <huon> sometimes if you have a PR rebased on top of another one, github will realise this and so when the first one lands, the second one will stop displaying those commits
[07:27:27] <huon> eddyb: it's not used by hashmap yet
[07:27:29] <huon> needs a snap
[07:27:33] <eddyb> :((
[07:27:38] <huon> (which I'm in the process of stage0-ing now)
[07:27:58] <edwardw> the bors queue is rather large now. I'd do a rebase later on
[07:29:27] *** Quits: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP) (Quit: Leaving...)
[07:29:52] <acrichto> oh man, I just force pushed my move-hashmap branch
[07:29:54] <acrichto> and travis is building it
[07:30:08] *** Joins: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP)
[07:30:33] *** Joins: gimpf (gimpf@moz-960833E1.adsl.highway.telekom.at)
[07:31:01] <bjz> acrichto: surprised?
[07:31:11] <eddyb> why doesn't bors give a link?
[07:31:23] <eddyb> like travis' Details
[07:31:25] <acrichto> it does
[07:31:28] <acrichto> it's just a link to the commit
[07:31:36] <acrichto> bjz: happy :)
[07:31:47] <bjz> yeah, <3 travis
[07:34:37] * acrichto just claimed the badge for first travis failure
[07:35:13] *** Quits: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP) (Ping timeout)
[07:35:45] *** Joins: edwardw (edwardw@CDC87030.9642909.B3B412E5.IP)
[07:39:48] <brson> acrichto: lol
[07:41:02] <acrichto> huon: you got the snap taken care of?
[07:43:23] <acrichto> huon: interesting, your build failed because of 'make tidy', but travis kept going
[07:49:03] <acrichto> https://travis-ci.org/mozilla/rust/builds/19430787
[07:49:05] *** Joins: Guest (textual@2BB3A2A1.3AD118EF.AF1F6556.IP)
[07:49:11] <acrichto> does anyone have the option to cancel that build?
[07:49:14] <huon> acrichto: I'm working on the snap, yeah
[07:49:16] <acrichto> I'm curious if it's just me
[07:49:20] <acrichto> huon: awesome
[07:50:13] <eddyb> https://travis-ci.org/mozilla/rust/pull_requests lovely
[07:50:29] <eddyb> wait, does it work already :D:D?
[07:50:50] <eddyb> as in, will it try every open PR?
[07:50:51] <huon> acrichto: where did it fail??
[07:50:55] <huon> there's way too much output
[07:50:59] <acrichto> huon: look at the very top
[07:51:00] <huon> eddyb: yes
[07:51:08] <huon> oh!
[07:51:12] <acrichto> search for "exited with 2"
[07:51:17] <acrichto> very sneaky
[07:51:19] <huon> yeah, I see it now. thanks
[07:51:25] <acrichto> and undesirable
[07:51:56] <acrichto> https://github.com/travis-ci/travis-ci/issues/1066
[07:51:58] <acrichto> interesting
[07:52:28] <huon> can we do `make tidy && make ...` (or whatever we're running)?
[07:52:38] <acrichto> yeah
[07:52:41] <acrichto> that's what we should do
[07:54:44] *** Quits: tedh (tedh@moz-6F8EC49.central.biz.rr.com) (Ping timeout)
[07:55:06] *** Joins: tedh (tedh@moz-6F8EC49.central.biz.rr.com)
[07:56:25] <huon> acrichto: why'd you r+ a PR that's known to fail? :P
[07:56:31] <huon> <3 travis
[07:56:45] <acrichto> r=foo is a wonderful wonderful thing :)
[07:58:36] <acrichto> brson: huon: https://mail.mozilla.org/pipermail/rust-dev/2014-February/008763.html
[08:00:32] <huon> awesome
[08:01:19] *** Quits: tedh (tedh@moz-6F8EC49.central.biz.rr.com) (Ping timeout)
[08:01:48] <edwardw> awesom. btw, are we Rustafarians? I saw other spellings too...
[08:02:42] <eddyb> Rustaceeans
[08:02:51] <edwardw> yep, that one
[08:02:52] *** Joins: numerodix (numerodix@moz-A4A47DA2.adsl2.static.versatel.nl)
[08:06:07] *** Quits: edwardw (edwardw@CDC87030.9642909.B3B412E5.IP) (Quit: Leaving...)
[08:11:46] <eddyb> https://github.com/mozilla/rust/pull/12491 #tauntingtravis
[08:16:10] <brson> "keep on being awesome everyone" :)
[08:17:20] <brson> acrichto: we may be able to do parallel builds more strategically on the bots now that there are so many crates
[08:17:28] <brson> i'm not even sure what -j we're using
[08:17:36] <acrichto> buildbot isn't doing -j anything
[08:17:39] <acrichto> travis is doing -j4
[08:17:46] <acrichto> (it's what they recommended)
[08:18:14] <huon> aren't the buildbots already running multiple independent builds in parallel, so -j may not help?
[08:18:23] <brson> i would be worried about running out of memory, and also wouldn't do 'make check' with -j
[08:18:50] <huon> eddyb: you could give a little more description ;)
[08:18:55] <huon> eddyb: but yay for deref \o/
[08:19:06] <eddyb> I'm writing a comment explaining my status
[08:19:07] <huon> eddyb: also, I see a distinct lack of tests
[08:19:10] <huon> ;P
[08:19:35] <eddyb> that's because it's like 30%
[08:20:14] <brson> huon: some of the bots are running builds in parallel, though maybe not enough to use all the cores for the serial parts
[08:20:38] <huon> brson: ok
[08:20:48] <huon> eddyb: does it bootstrap?
[08:20:58] <huon> eddyb: does it do *x sugar?
[08:21:06] <eddyb> yes
[08:21:20] <huon> how do you know they work?
[08:21:53] <eddyb> I can't make *x = y; work >_>
[08:22:21] <huon> yeah, but non-lvalue, works, right?
[08:22:37] <eddyb> non-mut lvalue you mean :P
[08:22:44] <huon> i.e. you could have tests for that? :)
[08:22:48] <huon> yeah, ok.
[08:22:52] <eddyb> ref_eq(&*x, x.borrow())
[08:25:03] <huon> $ git grep IterBytes -- '*.rs' | wc -l
[08:25:03] <huon> 0
[08:28:07] <acrichto> \o/
[08:31:09] <huon> rust/src/librustc/lib.rs:1:1: 1:1 error: unknown macro variable `e`
[08:31:12] <huon> that's a useful span :/
[08:32:06] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:32:07] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/T-q2GQ
[08:32:07] <ghrust> 13rust/06auto 14ad9e26d 15Alex Crichton: rustdoc: Add syntax highlighting...
[08:32:07] <ghrust> 13rust/06auto 140fe7fa7 15bors: auto merge of #12416 : alexcrichton/rust/highlight, r=huonw...
[08:32:07] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:34:01] <eddyb> nmatsakis: not sure how clear I was, but... https://github.com/mozilla/rust/pull/12491#issuecomment-35826701
[08:34:20] <eddyb> I don't know what to do about the resolve interaction
[08:35:11] <huon> eddyb: grep for binop_to_method_name to see how #12402 works
[08:35:19] <huon> (well, doesn't work)
[08:35:22] * huon -> dinner
[08:36:35] <eddyb> huon: same logic applies to everything
[08:37:02] <huon> eddyb: well #12402 is definitely real, so something is going on with it.
[08:37:26] <eddyb> I can either call deref or deref_mut from a *x overload, but not both
[08:37:32] <eddyb> and resolve chooses which
[08:40:48] <eddyb> hang on, it's a vector, I can have two elements XD
[08:42:16] <eddyb> "search_for_traits_containing_method"
[08:44:32] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[08:48:51] *** Joins: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de)
[08:50:06] *** Parts: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de) (WeeChat 0.4.3)
[09:06:59] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[09:06:59] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/ecdbBg
[09:06:59] <ghrust> 13rust/06auto 142a14e08 15Alex Crichton: Move std::{trie, hashmap} to libcollections...
[09:06:59] <ghrust> 13rust/06auto 14c250c16 15bors: auto merge of #12428 : alexcrichton/rust/move-hashmap, r=brson...
[09:06:59] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[09:07:00] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[09:07:00] <ghrust> [13rust] 15bors 04force-pushed 06auto from 140fe7fa7 to 14edf351e: 02http://git.io/N3iJvQ
[09:07:00] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[09:07:42] *** Quits: jsonnull (Thunderbir@26C8A295.45ABBC25.494A0F8B.IP) (Quit: jsonnull)
[09:16:52] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[09:18:47] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[09:18:51] *** Quits: Guest (textual@2BB3A2A1.3AD118EF.AF1F6556.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[09:24:10] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[09:24:20] *** Joins: yati (yati@9E072D87.7F178457.CECE23B2.IP)
[09:25:22] <yati> Hi. In libstd/hash.rs, we implement the Hash trait for all types that implement IterBytes - a comment also notes that this might change. What can be better ways of doing this?
[09:26:31] <eddyb> yati: the new Hash landed btw, we're expecting a snapshot ;)
[09:27:11] <eddyb> so what you see may be completely irrelevant in a few hours
[09:27:41] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[09:28:56] <yati> eddyb, ooh nice :) Github doesn't support searching issues, does it? Is this new Hash a part of our new hashtable impl?
[09:29:33] <eddyb> it's something different from the robin hood PR
[09:29:46] <yati> robin hood PR?
[09:30:10] <eddyb> https://github.com/mozilla/rust/pull/11863 that's what landed
[09:30:41] <eddyb> and this is the PR that changes HashMap internals https://github.com/mozilla/rust/pull/12081
[09:30:55] <yati> Oh thanks a lot :)
[09:31:09] <eddyb> github issue search works just fine :P
[09:32:03] <yati> eddyb, Oh you're right - just checked. Don't know why a while ago it wasn't working for me :P
[09:32:27] <yati> robinhood hashing. Classy
[09:37:38] <yati> Was just thinking, right now, many of my struct impls have a new() with a typical body `fn new() -> MyType { MyType {...} }`. Wouldn't it be nicer to be able to just do `fn new() -> MyType {...}` or something like that?
[09:39:40] <yati> But I guess for such simple new()s I should maybe do away with the new altogether and  let the caller construct the struct explicitly - that would be cleaner, maybe.
[09:40:30] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[09:40:36] <strcat> yati: if there aren't constraints not expressed by the types of the fields, and they're a reasonable part of the API, then making the fields public makes a lot more sense
[09:41:59] *** Quits: gimpf (gimpf@moz-960833E1.adsl.highway.telekom.at) (Quit: Leaving.)
[09:42:18] <eddyb> huon: I figured https://github.com/mozilla/rust/issues/12402 out :D
[09:42:36] <yati> strcat, I agree - this is just about providing a new() method that fills in reasonable defaults for the fields - esp for large structs.
[09:48:53] <eddyb> should I do this? https://github.com/mozilla/rust/issues/12402#issuecomment-35827846
[09:49:03] <eddyb> I'm afraid I may have to, for deref
[09:52:01] *** Joins: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de)
[09:54:21] <arrrrrrrrr> why do you want to parallelize renedring of the html docs?
[09:54:30] <arrrrrrrrr> the time spent there seem to be negligible
[09:56:00] *** flaper87|afk is now known as flaper87
[10:05:33] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[10:06:36] <huon> arrrrrrrrr: how long?
[10:06:55] <arrrrrrrrr> huon: parsing (compiling) of stdlib takes 11.4 seconds
[10:07:04] <arrrrrrrrr> rendering takes about 0.5 seconds
[10:07:16] <huon> rustdoc used to shell out to pandoc for every piece of markdown, but now it's just calling into some C functions, it's much much faster
[10:08:43] <huon> arrrrrrrrr: i.e. that comment/whatever is outdated
[10:09:43] <eddyb> eww, not only are we interning the method names for overloads every time... but the strings themselves are heap allocated
[10:10:33] <eddyb> "did you forget the `do` keyword for the call?"
[10:10:37] <eddyb> I can remove this error, right?
[10:10:56] <huon> eddyb: yes
[10:10:59] <huon> but...
[10:11:06] <huon> I encourage you to keep things separate!
[10:11:13] <eddyb> huon: working on a different PR
[10:11:23] <eddyb> will rebase deref on top of it
[10:11:33] <huon> eddyb: good :) ... but even so, disjoint work in disjoint commits ;P
[10:12:07] <eddyb> if I fix #12402 it should become quite painless to trigger deref calls at will
[10:12:25] <huon> awesome
[10:12:42] <eddyb> problem is, I have to generate new NodeId's for callee_id's :S
[10:13:12] <eddyb> and stick those in adjustments
[10:13:22] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[10:13:45] <eddyb> I'm considering removing the callee_id concept completely and storing the information somehow else
[10:15:01] <arrrrrrrrr> if_ok! fails on error?
[10:15:12] <eddyb> returns the error
[10:15:24] <huon> arrrrrrrrr: check `--pretty expanded` (in a small source file)
[10:15:32] <eddyb> it's match expr {Ok(v) => v, Err(m) => return Err(m)}
[10:15:34] <arrrrrrrrr> that just proves that the name is odd
[10:15:46] <eddyb> we're renaming it to try, aren't we?
[10:15:50] <arrrrrrrrr> return_on_err!?
[10:15:59] <huon> eddyb: yes
[10:16:05] <eddyb> arrrrrrrrr: that's waay too long for a common pattern
[10:16:14] <arrrrrrrrr> ret_on_err?
[10:16:23] <eddyb> ratonerr
[10:16:29] <arrrrrrrrr> ok_or_ret?
[10:16:50] <eddyb> why am I suddenly thinking of racoons?
[10:17:02] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:17:02] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/ecdbBg
[10:17:02] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:18:08] <huon> arrrrrrrrr: https://github.com/mozilla/rust/issues/12037
[10:18:16] <huon> https://github.com/mozilla/rust/pull/12401
[10:19:06] <strcat> acrichto: why does moving the hashmap out of libstd make it more portable?
[10:20:41] * eddyb should use "replace in selection" more
[10:21:06] <eddyb> strcat: maybe if we also move SipHash out
[10:21:23] <strcat> SipHash works without a runtime already, everywhere
[10:21:33] <eddyb> hmpf, idk then
[10:21:54] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[10:21:54] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/ddyrYw
[10:21:54] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[10:21:56] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:21:56] <ghrust> [13rust] 15bors pushed 5 new commits to 06auto: 02http://git.io/YHMWGA
[10:21:56] <ghrust> 13rust/06auto 144d10bdc 15Brian Anderson: std: Move intrinsics to std::intrinsics....
[10:21:56] <ghrust> 13rust/06auto 143e57808 15Brian Anderson: std: Move raw to std::raw...
[10:21:56] <ghrust> 13rust/06auto 1496b299e 15Brian Anderson: std: Remove unstable::lang...
[10:21:58] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[10:24:56] *** Joins: brson (brson@C91C7F36.70518F41.9D18269F.IP)
[10:24:56] *** ChanServ sets mode: +qo brson brson
[10:40:50] *** flaper87 is now known as flaper87|afk
[10:45:43] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[10:45:54] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[10:50:25] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Ping timeout)
[10:50:56] <huon> r? https://github.com/mozilla/rust/pull/12492
[10:50:58] <huon> eddyb: ^
[10:51:06] <huon> I'm gonna make some basic measurements now
[11:09:50] <arrrrrrrrr> module field in a krate object always a module?
[11:10:25] <arrrrrrrrr> s/krate/Crate/
[11:11:13] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: t)
[11:11:53] <huon> yes
[11:12:00] <huon> eddyb: seems to make no difference
[11:12:09] <eddyb> meh
[11:12:19] <huon> most of the time is spend actually Sip-hashing
[11:12:22] <huon> not virtual-calling
[11:12:50] <eddyb> I guess we have to wait for someone to plug in xxHash
[11:17:29] <eddyb> https://github.com/mozilla/rust/pull/12493 great, this will most likely trigger a travis build. I wish I had the authority to stop those, especially considering the failure rate my changes
[11:21:21] <eddyb> https://travis-ci.org/mozilla/rust/pull_requests oh dear what have I done?
[11:22:24] <huon> eddyb: broken everything! >:(
[11:22:27] <huon> ;P
[11:22:58] <eddyb> at least it's parallel :D
[11:24:06] <arrrrrrrrr> (unused_imports) vs (unused_variable)   <-- inconsistent
[11:24:33] <huon> arrrrrrrrr: yeah, that's been bothering me a bit too
[11:29:46] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[11:32:05] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:32:05] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/YHMWGA
[11:32:05] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[11:33:55] *** Quits: sunfish (chatzilla@moz-8DE7F965.dsl.dynamic.sonic.net) (Ping timeout)
[11:35:56] <doener> eddyb: what's the core change in that PR? There's so much refactoring noise...
[11:36:03] <eddyb> doener: which PR?
[11:36:17] <huon> heh
[11:36:18] <doener> 12493
[11:36:38] <eddyb> doener: this new function https://github.com/mozilla/rust/pull/12493/files#diff-0ce293a1b659395e7677cf3b95331343R170
[11:36:49] <eddyb> and its uses in operator overload type-checking
[11:36:59] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[11:36:59] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/ncfTLg
[11:36:59] <ghrust> 13rust/06auto 14ad9e26d 15Alex Crichton: rustdoc: Add syntax highlighting...
[11:36:59] <ghrust> 13rust/06auto 148786405 15bors: auto merge of #12416 : alexcrichton/rust/highlight, r=huonw...
[11:36:59] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[11:37:03] <eddyb> like this https://github.com/mozilla/rust/pull/12493/files#diff-31c6a728eb925b9f6b0124e93948d270R2056
[11:37:29] <eddyb> omg it fails
[11:37:34] <eddyb> so many errors in std
[11:38:19] <eddyb> ahh, because I don't handle type params. pffft
[11:39:24] <doener> r? https://github.com/mozilla/rust/pull/12494
[11:54:21] <arrrrrrrrr> rusti fn f() {}; let m = f(); let _ = m;
[11:54:34] <arrrrrrrrr> rusti: fn f() {}; let m = f(); let _ = m;
[11:54:36] -rusti- pastebinned 7 lines of output: http://ix.io/a6T
[11:54:40] <arrrrrrrrr> ^ compiler error
[11:55:04] <huon> arrrrrrrrr: fixed on master
[11:55:12] <huon> rusti: fn f() {}; let m = f(); let _ = m; 1
[11:55:13] -rusti- 1
[11:55:23] <huon> rusti: 
[11:55:25] -rusti- pastebinned 7 lines of output: http://ix.io/a6T
[11:55:43] <huon> it's basically caused by `let a = { <stuff that has type ()> };`
[11:55:55] <arrrrrrrrr> `let m = f()` why isn't this a compile time error?
[11:56:24] <huon> why would it be one?
[11:56:55] <arrrrrrrrr> because f doesn't return anything
[11:57:07] <huon> (that bug is specifically with the braces)
[11:57:10] <huon> it does: it returns ()
[11:57:14] <huon> i.e. the unit type
[11:57:28] <huon> fn f() {} is the same as fn f() -> () {}
[11:57:44] <arrrrrrrrr> but that's useless. `let m = f()` is useless and most likely a bug
[11:57:46] <huon> rusti: fn f() {} let g: fn() -> () = f; g()
[11:57:48] -rusti- ()
[11:58:02] <huon> arrrrrrrrr: that's something that could be linted
[11:58:23] <arrrrrrrrr> path.join(bla).push(foo) <<--- oops
[11:58:24] <huon> #[deny(assigning_unit)] or something
[11:59:01] <huon> but in most cases, uses of that variable will cause errors, because () doesn't do much
[12:00:04] <arrrrrrrrr> is there a way to speed up compilation? having to wait 5 minutes every time I want to compile rustdoc is bad
[12:01:25] <huon> does it just rebuild rustdoc?
[12:01:45] <arrrrrrrrr> yes
[12:01:49] <arrrrrrrrr> stage1 and 2
[12:01:54] <arrrrrrrrr> (librustdoc)
[12:03:59] <huon> hm, `make rustc-stage1` may just build the first one
[12:04:57] <eddyb> rustc-stage1 doesn't compile librustdoc
[12:05:12] <eddyb> check-stage1-doc and/or check-stage1-rustdoc might work
[12:05:18] <arrrrrrrrr> librustdoc is only 5500 linus. how can that take so long?
[12:05:29] <arrrrrrrrr> s/linus/lines
[12:05:39] <eddyb> hehe, if only that made sense :P
[12:05:41] <huon> it's being completely optimised
[12:05:45] <huon> eddyb: I thought it did
[12:06:03] <arrrrrrrrr> huon: how do I disable optimization?
[12:06:10] <eddyb> arrrrrrrrr: add RUSTFLAGS="-Z time-passes" to your make invocation
[12:06:15] <eddyb> to see what's taking time
[12:06:57] <huon> arrrrrrrrr: RUSTFLAGS="-Z no-opt" might do it
[12:07:03] <eddyb> you can't really disable optimizations just rustdoc, and if you do it for everything, chances are your stage1 rustc will be much slower
[12:07:10] <eddyb> *for just rustdoc
[12:07:23] <huon> eddyb: if it's only rebuilding rustdoc you can
[12:07:40] <eddyb> I guess...
[12:07:59] <arrrrrrrrr> 40s LLVM passes
[12:08:04] <arrrrrrrrr> by far the most expensive one
[12:08:10] <huon> arrrrrrrrr: you can also just build librustdoc directly with a rustc invocation
[12:08:16] <eddyb> that's a breeze
[12:08:43] <eddyb> yes, we can improve it, no, it's not easy
[12:09:46] <eddyb> we could check how much faster it is with disabled asserts in LLVM
[12:10:04] <arrrrrrrrr> huon: no-opt is much faster
[12:10:12] <huon> \o/
[12:10:47] <huon> eddyb: apparently like 20-30% faster
[12:11:58] <eddyb> should profile LLVM :/
[12:12:23] <eddyb> we might find patterns that we easily fix in trans
[12:12:29] <arrrrrrrrr> huon: how do I get the correct parameters for rustc?
[12:12:35] <huon> the largest function in LLVM was MemorFence last time I checked
[12:12:53] <eddyb> huon: wat?
[12:13:03] <huon> arrrrrrrrr: `make -n VERBOSE=1` and copy the invocation
[12:13:09] <huon> eddyb: *MemoryFence
[12:13:20] <huon> i.e. multithreading synchronisation
[12:13:29] <eddyb> but why would that even show up at all?
[12:13:34] <eddyb> LLVM is single-threaded AFAIK
[12:14:06] <eddyb> if that takes most of the time, we might be doing something wrong in our bindings
[12:14:19] <eddyb> or LLVM configuration
[12:14:53] <huon> we have to run it in multithreaded mode, because we do invocate (separate) LLVM instances from within a single process
[12:14:57] <huon> e.g. rustdoc --test
[12:15:35] <huon> anyway, you can see for yourself with `perf record rustc favourite_crate.rs`
[12:15:55] <arrrrrrrrr> there is `--cfg rtopt` in the command. should I remove that?
[12:16:20] <huon> arrrrrrrrr: won't make a difference either way
[12:16:33] <huon> (it only applies to libstd and possibly libgreen and libnative, iirc.)
[12:17:23] <arrrrrrrrr> error: aborting due to 209 previous errors   <--- -.-
[12:17:56] <huon> lol
[12:18:11] <huon> what are the errors?
[12:18:14] <arrrrrrrrr> https://gist.github.com/anonymous/6131dc3711558f41d2ae
[12:18:19] <arrrrrrrrr> if_ok not found
[12:18:28] <huon> ah
[12:18:44] <huon> your local rustc is too new
[12:18:59] <arrrrrrrrr> of course
[12:19:17] <huon> replacing `rustc` with `$BUILDDIR/x86_64-..../stage2/bin/rustc` should work
[12:19:31] <huon> (where BUILDDIR is where you ran configure/are running `make`.)
[12:20:28] <arrrrrrrrr> Ok(task 'rustc' failed at 'assertion failed: is_utf8(v)', /home/julian/rust/rust/src/libstd/str.rs:1227
[12:20:31] <arrrrrrrrr> )
[12:20:57] <huon> erm...
[12:21:01] <huon> weird
[12:21:29] <huon> arrrrrrrrr: (you'll want to remove the -O flag for speed, there.)
[12:21:33] <arrrrrrrrr> https://gist.github.com/anonymous/842156aad95492262e9a
[12:21:58] <huon> arrrrrrrrr: also, another trick, if you just want to check that it compiles, `RUSTFLAGS=--no-trans` will avoid the LLVM stages completely
[12:23:02] <arrrrrrrrr> huon: that's perfect
[12:23:07] <arrrrrrrrr> (well better)
[12:23:32] <arrrrrrrrr> still, I'd like to get this working
[12:23:52] <huon> can you run that under gdb, and break on rust_fail?
[12:29:19] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[12:29:40] <arrrrrrrrr> ok, so the problem is that I executed the command from src/librustdoc
[12:29:54] <arrrrrrrrr> so -L "x86blabla/rt" doesn't work
[12:30:03] <arrrrrrrrr> and --out-dir doesn't exist
[12:31:51] <arrrrrrrrr> how do I debug a shell script with gdb?
[12:32:12] <arrrrrrrrr> (the command is in the script)
[12:32:37] <huon> don't know
[12:33:00] <huon> but copying the command out to `gdb --args .../rustc ...` should work
[12:33:07] <huon> (or just put the gdb invocation in the script)
[12:34:23] <arrrrrrrrr> huon: genius
[12:35:20] <arrrrrrrrr> how do I pipe the backtrace to a file?
[12:35:47] <arrrrrrrrr> (got it)
[12:36:48] <arrrrrrrrr> here you go: https://gist.github.com/anonymous/0ff9e83bacc7413d2766
[12:37:42] <huon> that's pretty weird
[12:38:12] <huon> looks like LLVM hits the linking error (or something) and then passes non-UTF8 data back to rustc
[12:38:12] <doener> is there any kind of rule for rust for keeping commits down to a single change? Or is it ok to just squash in unrelated "cleanup" and refactorings?
[12:38:34] <huon> doener: it's much nicer to keep cleanup separate to the core of a commit
[12:38:42] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[12:38:47] <huon> *of a changeset
[12:39:13] * huon tries to encourage eddyb to do this :)
[12:39:41] <doener> huon: I know. I'm about to add some comments to eddyb's PR, but I don't want to complain if it's actually accepted in rust to squash stuff together
[12:41:33] *** Quits: brson (brson@C91C7F36.70518F41.9D18269F.IP) (Ping timeout)
[12:41:33] <huon> doener: please do, so it's not just me pestering him about it :)
[12:42:06] <doener> don't encourage me, I can be quite a zealot about such stuff :-p
[12:42:09] <huon> squashing together incremental changes after reviews is good; squashing unrelated changes, not so good.
[12:43:00] <doener> huon: depends on their level of "incrementalness", but yeah
[12:43:36] <huon> I was meaning things like changing indentation, renaming variables, adding comments, etc.
[12:43:45] <huon> so we're in agreement
[12:43:56] <arrrrrrrrr> VERBOSE=1 doesn't show how rustdoc itself is compiled (only librustdoc)
[12:44:12] <doener> yeah, basically fixing bugs in earlier changes of the same PR, that should be squashed
[12:44:27] <huon> arrrrrrrrr: driver/driver.rs --cfg rustdoc
[12:49:31] <arrrrrrrrr> https://gist.github.com/anonymous/5af4bf79f2cd6f3ab0c0
[12:50:02] <arrrrrrrrr> error: could not write output: Error opening output file 'src/rustdoc/rustdoc.o': No such file or directory
[12:50:16] <arrrrrrrrr> oh shit
[12:50:19] <arrrrrrrrr> my bad
[12:50:30] <arrrrrrrrr> s/rustdoc/librustdoc
[12:54:26] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[12:54:47] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[12:56:28] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[12:56:54] <arrrrrrrrr> rustc doesn't return 1 when it fails
[12:57:28] <arrrrrrrrr> no I guess I'm wrong again
[13:00:59] <huon> it returns 101 or something huge like that
[13:01:08] <huon> (or maybe that's just task failure?)
[13:02:50] <eddyb> doener, huon: I can split that PR into a few smaller commits, sure
[13:03:11] <eddyb> but now I have to go (ex's 18th birthday. much fun)
[13:03:20] <huon> eddyb: sure thing, have fun
[13:03:37] <doener> see you!
[13:03:54] <eddyb> I hope I can think of a solution for all the derefs I'll have to implement ^_^
[13:03:57] <eddyb> and thanks :)
[13:04:05] <arrrrrrrrr> my so compiled rustdoc crashes with 
[13:04:06] <arrrrrrrrr> lib.rs:1:1: 1:1 error: can't find crate for `std`
[13:04:22] <arrrrrrrrr> do I need more parameters when compiling rustdoc itself?
[13:05:46] <huon> hm
[13:06:01] <huon> I hate that error
[13:06:11] <arrrrrrrrr> hm it workes when the executable is in the stage2 directory
[13:06:21] <huon> yeah, that's the easiest way to fix it
[13:11:48] <arrrrrrrrr> what does path.push do exactly?
[13:13:38] <huon> did you check the docs?
[13:13:40] <yati> Under the "Questions and issues" section here: http://static.rust-lang.org/doc/0.9/std/io/index.html there's mentions of overloads of File ctors to also allow people to pass in `&str`s. Is that in the plans?
[13:13:58] <huon> http://static.rust-lang.org/doc/master/std/path/index.html?search=push
[13:14:08] <arrrrrrrrr> huon: Pushes a path (as a byte vector or string) onto self. If the argument represents an absolute path, it replaces self.
[13:14:34] <arrrrrrrrr> doesn't explain anything
[13:14:39] <huon> yes it does
[13:14:48] <huon> self.push(arg)
[13:14:49] <arrrrrrrrr> if you already know what push means
[13:15:04] <huon> == "self/arg"
[13:15:21] <huon> unless arg is absolute (e.g. `/foo/bar`)
[13:15:31] <huon> but yeah, an example would go a long way
[13:15:45] <arrrrrrrrr> huon: I was expecting self.push(arg) = "selfarg"
[13:16:28] <arrrrrrrrr> so what's the right way to append to the underlying array itself?
[13:16:43] *** Joins: edwardw (edwardw@B5386878.16F55560.50B134B9.IP)
[13:17:58] <huon> what are you trying to do?
[13:18:10] <huon> change the filename of a path?
[13:19:05] <arrrrrrrrr> set_extension
[13:21:22] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[13:25:09] <arrrrrrrrr> is File buffered?
[13:30:06] <huon> no
[13:30:15] <huon> need std::io::BufferedReader, iirc
[13:32:37] <arrrrrrrrr> huh, that's odd
[13:32:51] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[13:33:14] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[13:39:38] <huon> acrichto: btw, about travis' load, we don't just get 20 PRs a day: people update and force-push their PRs a lot too.
[13:41:32] <doener> talking about PRs, r? https://github.com/mozilla/rust/pull/12494
[13:41:55] *** Joins: tjc (tjc@moz-87640F27.phlapa.east.verizon.net)
[13:41:55] *** ChanServ sets mode: +o tjc
[13:42:10] *** Quits: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de) (Ping timeout)
[13:42:26] *** Quits: tjc (tjc@moz-87640F27.phlapa.east.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[13:42:33] <edwardw> how to trigger a travis build?
[13:43:54] <huon> edwardw: push to the PR
[13:44:02] <edwardw> gotcha
[13:47:05] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[13:47:05] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/ncfTLg
[13:47:05] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[13:50:24] *** Joins: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca)
[13:53:00] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[13:55:30] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Ping timeout)
[13:57:00] *** Joins: new_one (new_one@moz-2125F11A.rice.edu)
[13:57:02] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:57:02] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/CeLYdA
[13:57:03] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:02:33] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:02:33] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/CeLYdA
[14:02:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:02:36] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[14:02:36] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/1hU-zQ
[14:02:36] <ghrust> 13rust/06auto 14768b96e 15Huon Wilson: green: remove ancient register-saving code....
[14:02:36] <ghrust> 13rust/06auto 144c99569 15Huon Wilson: flate: return CVec<u8> rather than copying into a new vector....
[14:02:36] <ghrust> 13rust/06auto 140d69d9d 15Huon Wilson: green,native,rustuv: Replace many pointer `transmute`'s with `as` or referencing....
[14:02:38] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[14:07:41] *** Joins: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de)
[14:08:57] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[14:12:05] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[14:12:05] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/J4_hjA
[14:12:05] <ghrust> 13rust/06auto 14b9d7f01 15OGINO Masanori: Exclude build metadata from equality checking....
[14:12:05] <ghrust> 13rust/06auto 14c5f2573 15bors: auto merge of #12454 : omasanori/rust/semver-eq, r=alexcrichton...
[14:12:06] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[14:12:08] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[14:12:08] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1439bf3c5 to 148786405: 02http://git.io/N3iJvQ
[14:12:08] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[14:12:54] <edwardw> r? https://github.com/mozilla/rust/pull/12338
[14:13:06] <edwardw> hurray, I think the hygiene patch is finally ready
[14:37:25] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:39:30] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[14:41:47] *** Joins: JIMMIE57 (JIMMIE57@E44AAA16.6289F2F6.20F09BA6.IP)
[14:43:23] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[14:43:39] <JIMMIE57> have fun with    capital website tactics game   MAGEGO by JUMBASTIC
[14:43:49] *** Quits: JIMMIE57 (JIMMIE57@E44AAA16.6289F2F6.20F09BA6.IP) (Client exited)
[14:47:07] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[15:04:10] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:07:45] *** Quits: edwardw (edwardw@B5386878.16F55560.50B134B9.IP) (Quit: Leaving...)
[15:08:05] *** Joins: edwardw (Mibbit@B5386878.16F55560.50B134B9.IP)
[15:19:09] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:20:17] <arrrrrrrrr> http://i.imgur.com/3myyrVt.png
[15:20:19] <arrrrrrrrr> impressive
[15:25:42] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[15:27:55] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:28:16] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:29:56] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[15:33:58] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:35:38] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[15:37:41] *** Quits: Kxepal (Miranda@moz-A26562EF.pppoe.mtu-net.ru) (Ping timeout)
[15:42:02] *** Joins: Kxepal (Miranda@moz-31D2847C.pppoe.mtu-net.ru)
[15:47:15] <arrrrrrrrr> rust doesn't support 64 bit ARM?
[15:47:52] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:55:08] <erickt> huon: ping
[15:56:06] *** Quits: carter (carter@moz-58F59B3A.members.linode.com) (Quit: ZNC - http://znc.in)
[15:56:36] *** Joins: carter (carter@moz-58F59B3A.members.linode.com)
[16:02:03] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[16:02:03] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14c5f2573 to 148786405: 02http://git.io/N3iJvQ
[16:02:03] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[16:02:06] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[16:02:06] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/iDfHkw
[16:02:06] <ghrust> 13rust/06auto 14768b96e 15Huon Wilson: green: remove ancient register-saving code....
[16:02:06] <ghrust> 13rust/06auto 1406e3e63 15Huon Wilson: flate: return CVec<u8> rather than copying into a new vector....
[16:02:07] <ghrust> 13rust/06auto 148b246fd 15Huon Wilson: green,native,rustuv: Replace many pointer `transmute`'s with `as` or referencing....
[16:02:09] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[16:03:15] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[16:30:09] *** Parts: edwardw (Mibbit@B5386878.16F55560.50B134B9.IP) ()
[16:31:26] *** Joins: edwardw (Mibbit@B5386878.16F55560.50B134B9.IP)
[16:32:10] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:39:21] <cmr> arrrrrrrrr: nobody has tried running it on aarch64 I don't think, but there shouldn't be any major problems with it.
[16:44:41] <cmr> edwardw: did you figure out what a "rib" is?
[16:44:45] <cmr> (reviewing the pr)
[16:45:25] <edwardw> cmr: no, i was wondering a while and let it go
[16:45:31] <cmr> heheh
[16:46:00] * cmr hopes to one day unravel that mystery
[16:47:30] <cmr> arrrrrrrrr: you can pass -Z ast-json to rustc to get a json encoding of the ast, should be useful when trying to figure out which code makes what.
[16:48:02] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[16:48:17] <edwardw> that does help me a lot since I fiddled with AST quite a lot recently
[16:48:51] <edwardw> now next on my wish list is backtrace
[16:49:08] <edwardw> the PR failed tests unfortunately
[16:51:37] <arrrrrrrrr> cmr: size_t is hard coded u32 on arm
[16:51:54] *** Joins: gimpf (gimpf@moz-287ACF80.adsl.highway.telekom.at)
[16:51:59] <cmr> well, that's no good then.
[16:52:40] <cmr> doener: what affect does #12494 have?
[16:53:33] <doener> cmr: allows TCO in a few more cases, not sure if it opens up any other optimization possibilities
[16:53:46] <cmr> ok, cool.
[16:54:15] <doener> cmr: for TCO, llvm must be sure that the stack is unused at the recursion point. Currently it has to assume that the pointer might be captured and thus can't perform TCO.
[16:54:29] <edwardw> we have TCO? (I take that as tail-recursive-opt)
[16:54:36] <doener> s/stack/the function's stack frame/
[16:54:49] <doener> edwardw: just no guaranteed tco
[16:55:00] <edwardw> ok
[16:55:21] <strcat> just a normal LLVM optimization pass
[16:55:41] <edwardw> I see
[16:55:59] <arrrrrrrrr> how does rust determine the size of extern "C" function pointers?
[16:56:07] <arrrrrrrrr> (the size of the pointer)
[16:56:31] <strcat> arrrrrrrrr: asks LLVM
[16:57:18] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Quit: Leaving)
[16:57:20] <arrrrrrrrr> in markdown.rs in the html doc renderer size_t is used to store extern "C" function pointers
[16:57:28] <arrrrrrrrr> this is questionable
[16:57:33] <strcat> why?
[16:57:53] <arrrrrrrrr> it's not guaranteed to hold all pointers
[16:57:55] <strcat> rust's entire stdlib assumes uintptr_t == size_t
[16:58:00] <strcat> arrrrrrrrr: rust guarantees it will
[16:58:21] <strcat> the C guarantees don't matter, rust doesn't (and won't) support platforms where it's not equal (without a massive stdlib rewrite at least)
[16:58:45] <arrrrrrrrr> was this just an accident?
[16:58:47] <strcat> no
[16:59:51] <arrrrrrrrr> anyway, in std::libc, size_t != intptr_t
[17:00:00] <strcat> arrrrrrrrr: on the platforms rust does and will support, it is
[17:00:33] <arrrrrrrrr> strcat: their size but that doesn't change that the types don't agree
[17:00:33] <strcat> rust provides guarantees C doesn't provide
[17:00:48] <cmr> intptr_t is int, size_t is u32
[17:00:54] <strcat> arrrrrrrrr: the C guarantees don't matter
[17:01:05] <strcat> rust isn't C, it's not portable to every platform C is portable to
[17:01:09] <strcat> it provides more guarantees than C
[17:01:24] <arrrrrrrrr> strcat: I'm not talking about C. I'm saying that the typedefs in std::libc aren't the same
[17:01:36] <cmr> rusti: std::mem::size_of::<std::libc::intptr_t>()
[17:01:39] -rusti- 8u
[17:01:42] <cmr> rusti: std::mem::size_of::<std::libc::size_t>()
[17:01:43] -rusti- 8u
[17:02:10] <cmr> ah missed a #[cfg]
[17:02:12] * strcat doesn't see why it really matters
[17:02:19] <arrrrrrrrr> it doesn't
[17:02:21] <strcat> neither typedef is really useful
[17:02:23] <arrrrrrrrr> it's just something I noticed
[17:02:36] <strcat> std::libc has a lot of useless and incorrect definitions
[17:02:59] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[17:03:06] <strcat> shouldn't really exist, rust shouldn't be tied to a specific C stdlib ABI
[17:03:24] <strcat> should work with non-glibc libc, etc. without having to hardcode everything
[17:03:30] <arrrrrrrrr> replacing the size_t in markdown.rs by *c_void would be nicer, I think
[17:03:51] <strcat> if it wants an integer it should be uint
[17:04:04] <strcat> int/uint are guaranteed to be pointer-size
[17:04:09] <arrrrrrrrr> it doesn't want an integer
[17:04:15] <arrrrrrrrr> it's unused
[17:05:07] <arrrrrrrrr> it's in a struct that holds callbacks but rust only needs one of them and padds the struct with an array of size_t
[17:08:46] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[17:16:41] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:16:42] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:17:29] *** Joins: mawuli (mawuli@moz-36C70B7D.com.gh)
[17:17:37] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:17:56] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[17:18:03] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:27:05] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[17:27:06] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14c138563 to 148786405: 02http://git.io/N3iJvQ
[17:27:06] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[17:27:36] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[17:29:38] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[17:42:23] *** Joins: tedh (tedh@moz-6F8EC49.central.biz.rr.com)
[17:49:10] *** Joins: eibwen (kvirc@moz-2C26CBA3.dip0.t-ipconnect.de)
[17:50:23] <doener> ouch. Using [X x i8] for the "padding" in enums and then stuffing data in there leads to memcpys with byte-alignment
[17:53:21] *** Parts: edwardw (Mibbit@B5386878.16F55560.50B134B9.IP) ()
[18:06:27] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[18:13:46] *** Quits: yati (yati@9E072D87.7F178457.CECE23B2.IP) (Quit: Leaving)
[18:21:23] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[18:27:41] <eddyb> those were 6 uneventful hours of my life I'll never get back...
[18:30:15] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[18:30:21] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[18:36:54] *** Joins: arrrrrrr1 (arrrrrrrrr@moz-53AF4C1C.dynamic.qsc.de)
[18:37:19] *** Quits: arrrrrrrrr (arrrrrrrrr@moz-BCED429D.dynamic.qsc.de) (Ping timeout)
[18:37:52] <eddyb> doener: I thought pcwalton found that and fixed it, somehow
[18:40:26] <doener> eddyb: the bad memcpys? I only know of https://github.com/mozilla/rust/issues/11551 about that
[18:43:45] <eddyb> doener: https://github.com/mozilla/rust/issues/10613
[18:43:51] *** Joins: edwardw (Mibbit@AB0DBC86.71427BF8.1D660E71.IP)
[18:44:58] <edwardw> it seems something goes wrong about auto-linux-64-x-android-t @ bors
[18:45:20] <edwardw> test hangs
[18:47:37] *** Parts: edwardw (Mibbit@AB0DBC86.71427BF8.1D660E71.IP) ()
[18:53:35] <doener> eddyb: any idea what patch Patrick is talking about there? The memcpy-from-fresh-alloca one?
[18:53:54] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[18:54:09] <eddyb> no idea
[18:54:33] <eddyb> hence "somehow"
[18:55:17] <doener> eddyb: that doesn't necessarily help here, because the "padding" isn't necessarily just padding. Consider: enum { A(u32), B(u64) }. The u32 from A will be stuffed into the "padding"
[18:55:46] <eddyb> the u32 and u64 start at the same position, don't they?
[18:56:07] <doener> no, we have { i8, [7 x i8], [u64] }
[18:56:25] <doener> and that gets cast to either { i8, i32 } or { i8, i64 }
[18:56:53] <doener> so the i32 ends up in the "padding" (aligned to 4 bytes), while the i64 is located after the padding
[18:57:08] <eddyb> rusti: enum Foo { A(u8, u64), B(u64) } std::mem::size_of::<Foo>()
[18:57:13] -rusti- 16u
[18:57:24] <eddyb> wat
[18:57:28] <eddyb> did we fix this?
[18:57:35] <doener> the u8 is right after the discriminant
[18:57:41] <eddyb> since when?
[18:57:48] <eddyb> this has been bugging me for months
[18:58:07] <eddyb> because it inflates (inflated, I guess) enum sizes a lot
[18:58:16] <eddyb> rusti: enum Foo { A(u32, u64), B(u64) } std::mem::size_of::<Foo>()
[18:58:18] -rusti- 16u
[18:58:25] <eddyb> whaa
[18:58:41] <eddyb> rusti: enum Foo { A(u8), B(u64) } std::mem::size_of::<Foo>()
[18:58:42] -rusti- 16u
[18:58:57] <eddyb> doener: do you happen to know when this changed?
[18:59:16] <eddyb> and how I didn't hear about it?
[18:59:17] <doener> it was already like that when I looked into #11551 a month ago, that's all I can say without digging into the code history
[18:59:28] <eddyb> that's odd
[19:00:59] <eddyb> rusti: enum Foo { A(u16, u16, u16), B(u32, u16) } std::mem::size_of::<Foo>()
[19:01:00] -rusti- 12u
[19:01:47] <eddyb> huh
[19:02:01] <eddyb> ah, I guess it's 10 + padding at the end
[19:02:05] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[19:02:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1471f2901 to 148786405: 02http://git.io/N3iJvQ
[19:02:05] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[19:02:27] <eddyb> rusti: enum Foo { A(u8, u8, u8), B(u16, u8) } std::mem::size_of::<Foo>()
[19:02:28] -rusti- 6u
[19:03:03] <doener> eddyb: are you maybe thinking of the case where you tried to flatten a Option<OtherStruct> to save memory?
[19:03:19] <eddyb> no, not that
[19:03:22] <doener> ok
[19:03:34] <eddyb> it used to be the case that all variants started at the highest alignment
[19:04:26] <eddyb> rusti: enum Foo { A(u8, u64), B(u64) } std::mem::size_of::<Foo>()
[19:04:27] -rusti- 16u
[19:05:44] <eddyb> so in that case, you would have tag, 7 bytes of padding to align for B, then each of A(u8, u64) (that needs 7 bytes of padding) and B(u64), adding up to 24 bytes
[19:05:49] <eddyb> rusti: enum Foo { A((u8, u64)), B(u64) } std::mem::size_of::<Foo>()
[19:05:50] -rusti- 24u
[19:05:56] <eddyb> doener: basically, that ^^
[19:07:38] <eddyb> Option<OtherEnum> could totally use LAST_DISCRIMINATOR + 1 for None
[19:07:52] <eddyb> but it's a different thing
[19:18:48] <Eridius> sigh, someone broke searching the documentation
[19:18:57] <Eridius> [Error] SyntaxError: Expected token '(' (main.js, line 585)
[19:20:09] <Eridius> sigh, #12439
[19:20:53] <Eridius> oh good, #12484 fixes it
[19:21:16] <Eridius> but it's pretty far back in the queue :/
[19:23:08] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[19:32:36] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.3.50.1)
[19:32:55] <cmr> 89 pull requests this week holy crap.
[19:34:29] <Eridius> and I've been busy so I haven't even been contributing! >_<
[19:34:34] <Eridius> damn you people and your productivity
[19:37:24] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[19:37:47] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[19:39:26] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[19:42:05] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[19:42:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1443e5ca4 to 148786405: 02http://git.io/N3iJvQ
[19:42:05] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[19:46:06] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[19:46:06] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[19:47:13] <cmr> uh oh is bors on fire?
[20:05:52] <cmr> https://github.com/mozilla/rust/pull/12245 downgraded libuv
[20:05:55] <cmr> was that ever fixed
[20:07:41] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[20:14:40] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:15:52] *** Quits: numerodix (numerodix@moz-A4A47DA2.adsl2.static.versatel.nl) (Quit: Leaving)
[20:20:43] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Quit: canhtak)
[20:20:53] *** Joins: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca)
[20:43:11] <huon> acrichto: http://buildbot.rust-lang.org/builders/doc/builds/2285 doc builder is failing
[20:43:53] <cmr> is it trying to compile the lifetime documentation?
[20:44:00] <cmr> or, rather, borrowck.
[20:44:49] <huon> trying to tokenise it, yeah
[20:44:55] <huon> (I think)
[20:45:42] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[20:47:25] <acrichto> ah it just needs ```notrust
[20:47:36] <eddyb> no trust?
[20:47:53] <acrichto> not,rust
[20:48:36] <huon> the main builders should probably gate on the same things that the doc builder builds, right?
[20:48:49] <huon> erickt: pong
[20:49:08] <acrichto> perhaps yeah
[20:50:02] <erickt> huon: you already took care of it in your PR. thanks for getting it
[20:50:17] <huon> erickt: awesome... <3 the new hash
[20:50:23] <cmr> erickt: is there a writeup on the Hash changes yet?
[20:50:47] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Client exited)
[20:50:48] <erickt> cmr: not yet, I'll start working on one
[20:50:52] <cmr> thanks!
[20:51:02] <cmr> any ETA? ideally there'd be one for TWiR
[20:51:15] <cmr> (it's ok if there isn't)
[20:51:19] <huon> r? https://github.com/mozilla/rust/pull/12495 https://github.com/mozilla/rust/pull/12497
[20:51:29] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[20:51:46] <erickt> huon: glad you like it :) I got another PR that transitions HashMap over to using `Hasher`s that I'll push up once your PR lands
[20:55:52] <huon> acrichto: that travis failure looks like libgreen and libnative have different error messages for IO failures?
[20:56:16] *** Quits: new_one (new_one@moz-2125F11A.rice.edu) (Client exited)
[20:56:43] <nrc> acrichto++++ for getting Travis going, I thought that would take months, not days
[20:57:14] <eddyb> if anything, it will make me force push less
[20:57:21] <eddyb> because travis is watching!
[21:00:09] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[21:00:15] <erickt> cmr: no ETA yet, when are you putting up your next edition of TWiR? 
[21:00:22] <cmr> erickt: this evening.
[21:00:39] <cmr> that is, in roughly 6 hours.
[21:00:49] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:00:49] *** ChanServ sets mode: +qo brson brson
[21:00:54] <erickt> cmr: yeah I should have something done by then
[21:01:05] <cmr> 40 PRs to write about, out of 89
[21:01:11] <cmr> erickt: cool, thanks!
[21:01:25] <cmr> brson: we broke a record this week, 89 PRs.
[21:02:28] * eddyb gets ready to push 100 PRs the coming week
[21:02:40] <eddyb> oh who am I kidding I'll be happy to get one thing done >_>
[21:05:02] <brson> cmr: i can think of no emoticon that fully expresses my excitement over this news
[21:05:26] *** Quits: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net) (Ping timeout)
[21:05:57] <tedh> brson or acrichto are you able to fix the android bot, keeps timing out
[21:06:19] <cmr> brson: I was more like http://24.media.tumblr.com/35843647fd90523c887decda8284d601/tumblr_n0a69uRrpC1trdlago3_500.png
[21:06:40] <brson> tedh: i'll look into it
[21:07:05] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[21:07:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1498339a6 to 148786405: 02http://git.io/N3iJvQ
[21:07:05] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[21:07:05] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[21:07:05] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/dYD6yg
[21:07:05] <ghrust> 13rust/06auto 145444da5 15Huon Wilson: Register snapshots.
[21:07:05] <ghrust> 13rust/06auto 14efaf4db 15Huon Wilson: Transition to new `Hash`, removing IterBytes and std::to_bytes.
[21:07:06] <ghrust> 13rust/06auto 14ba03747 15bors: auto merge of #12492 : huonw/rust/snapshots, r=alexcrichton...
[21:07:08] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[21:08:21] <acrichto> brson: tedh: I restarted the android bot about a half hour ago
[21:08:35] <acrichto> huon: I would believe that they have different error messages yeah
[21:08:40] <brson> i just restarted the emulator
[21:08:44] <brson> it was not responding
[21:08:49] <acrichto> that's not good...
[21:09:01] <acrichto> we should probably modify the bot to do that anyway
[21:09:34] <tedh> ok, just wanted to make sure someone was on it, thanks
[21:09:41] <acrichto> huon: there are unmapped error codes for both librustuv and libnative, I think this is just missing a mapping for EISDIR on libnative
[21:09:47] *** Quits: teratorn (teratorn@moz-5363C32C.teratorn.org) (Quit: Absum!)
[21:10:09] *** Joins: teratorn (teratorn@moz-5363C32C.teratorn.org)
[21:10:10] <cmr> brson: do you know how many 1.0 issues were closed vs opened this week?
[21:10:10] <brson> acrichto: the first timeout was in benchmarks http://buildbot.rust-lang.org/builders/auto-linux-64-x-android-t/builds/1380/steps/test/logs/stdio
[21:10:22] <cmr> brson: I'd like to start including that information now that we're making progress..
[21:10:27] <acrichto> I think I've seen that before
[21:13:01] <brson> cmr: https://docs.google.com/a/mozilla.com/spreadsheet/ccc?key=0AlWBWplsaTZvdHM1N3FmUm1jNW1CQV9IcnBTcnJLVEE#gid=0
[21:14:33] <eddyb> http://www.philipreames.com/Blog/2014/02/15/tweaking-llvm-to-exploit-assumex/ hmm, this blog is interesting
[21:18:23] *** Quits: gimpf (gimpf@moz-287ACF80.adsl.highway.telekom.at) (Quit: Leaving.)
[21:24:49] <eddyb> http://static.rust-lang.org/doc/master/std/intrinsics/index.html hey, we can finally read these :D
[21:26:27] <eddyb> https://github.com/mozilla/rust/blob/master/src/libstd/unit.rs hmpf, can we move these to std::tuple?
[21:26:59] <brson> acrichto: is it possible to make rustdoc show docs of reexports even when the original is public?
[21:27:10] <acrichto> it is very possible
[21:27:12] <brson> acrichto: I'm thinking of using reexports for common intrinsics
[21:27:17] <eddyb> s/public/priv?
[21:27:45] <acrichto> if we just reexport them though, do we need a std::intrinsics module anyway?
[21:27:49] <brson> that would seem to give me both all my intrinsics in one place, but also remove the wrappers
[21:27:58] <brson> i just like being able to look at them all :(
[21:28:11] <acrichto> I'm down with that
[21:28:25] <acrichto> mod intrinsics; seems nicer than pub mod intrinsics;
[21:28:27] <brson> if i'm being silly about this we can just move the intrinsics
[21:28:50] <brson> strcat would also just like to put the intrinsics right where the wrappers are
[21:29:39] <acrichto> having them all in once place does have utility, we don't have any enforcement of doing so though
[21:30:03] <brson> i wish we could declare extern fns without extern fn blocks
[21:30:37] <acrichto> we could add syntax for it
[21:30:43] <acrichto> pub extern fn foo();
[21:30:50] <acrichto> ^- header syntax
[21:31:00] <brson> it's such an obvious thing to do, but i don't know if it's worth it
[21:32:27] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[21:35:33] *** Quits: arrrrrrr1 (arrrrrrrrr@moz-53AF4C1C.dynamic.qsc.de) (Ping timeout)
[21:37:25] <brson> acrichto: yeah, making intrinsics private to std would be nice
[21:37:51] <acrichto> it would solve the reexport problem
[21:41:15] <huon> will that involve not exposing them at all?
[21:42:30] <acrichto> I would imagine it exposes them at more official locations
[21:42:37] <acrichto> such as mem::init rather than intrinsics::init
[21:45:01] <brson> right, there may be a few places where other crates need to declare their own intrinsics, but most of the useful stuff is already available elsewhere
[21:45:37] <brson> i'm going see what impact using reexports has
[21:45:57] <brson> oh, intrinsics are all unsafe and some of the wrappers are used to provide safety
[21:46:21] <brson> that's frustrating
[21:48:22] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[21:54:28] <cmr> it'd be nice to annotate that an extern function isn't unsafe.
[21:55:07] <Eridius> cmr: isn't task failure technically unsafe in an extern function?
[21:56:43] <cmr> Eridius: what do you mean?
[21:57:00] <Eridius> if you have an extern function, and you fail inside of it, what happens once the failiure passes the extern boundary?
[21:57:09] <Eridius> the calling code, which is presumably C, won't be expecting that
[21:57:18] <huon> Eridius: how do you fail inside an extern function?
[21:57:20] <acrichto> cmr: it's always inherently unsafe because there's no guarantee that you got the signature correct
[21:57:23] <Eridius> fail!()?
[21:57:27] <huon> only by passing in a closure, right?
[21:57:35] <cmr> acrichto: we can typecheck intrinsics.
[21:57:39] <Eridius> ooh, you don't mean a rust function marked extern, you mean an FFI function?
[21:57:47] <acrichto> intrinsics perhaps, but not for externs in general
[21:57:58] <acrichto> (we already do typecheck intrinsics)
[21:58:12] <huon> extern { #[unsafe_actually_safe] fn foo(); }
[21:58:18] <cmr> acrichto: and I don't see how this is any different than writing a safe wrapper around an extern fn.
[21:58:25] <cmr> I get that they're unsafe.
[21:58:40] <cmr> That doesn't change the fact that we could mark them as safe, given that we already treat them as safe?
[21:58:55] <acrichto> for some intrinsics perhaps yeah
[21:59:10] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[21:59:11] <cmr> not even just intrinsics, it'd be really useful in gl-rs too.
[21:59:37] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[21:59:42] <brson> there are only 3 major intrinsics that want to be safe, the size_of/align_of
[22:00:43] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[22:01:47] <brson> acrichto, cmr: rustdoc has gotten very usable
[22:01:52] <brson> i'm using it now regularly
[22:02:16] <brson> can't wait for that syntax highlighting to drop though!
[22:02:17] <acrichto> hurray!
[22:04:34] <brson> the android slave oopsed yesterday
[22:05:14] <Eridius> crap. You can't implement the same method on a parameterized type twice with different parameters?
[22:05:58] <cmr> Eridius: isn't it a pain?
[22:06:10] <Eridius> rusti: struct A; struct B; struct Foo<T> { x: int }; impl Foo<A> { fn foo(&self) { println!("Foo<A>"); } } impl Foo<B> { fn foo(&self) { println!("Foo<B>"); } } let foo: Foo<A> = Foo { x: 3i }; foo.foo()
[22:06:13] -rusti- pastebinned 8 lines of output: http://ix.io/aGJ
[22:06:23] <Eridius> I was going to use precisely this to make rust-lua safer
[22:06:39] <Eridius> I suppose I can duplicate the struct definition instead, but that's ugly
[22:07:16] <aatch> Eridius, try adding a marker field of InvariantType so the type parameter is used?
[22:07:25] <aatch> I'm not sure if it'll work, but it might.
[22:08:12] <Eridius> aatch: nope
[22:09:15] <aatch> Using a trait might work, then
[22:10:40] <Eridius> yes, declaring the method in a trait and implementing that twice works
[22:12:47] <aatch> it is curious that you can't implement the same method on Foo<A> and Foo<B>, since they *should* be complete, seperate types.
[22:13:00] <brson> bors's queue is above 60
[22:14:01] <acrichto> brson: I don't have time today, but I think I'll do a roll up tmw
[22:14:14] <acrichto> it worries me though
[22:17:06] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:17:06] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/dYD6yg
[22:17:06] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:18:48] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[22:19:09] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[22:20:51] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[22:22:02] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[22:22:05] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[22:22:06] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/lAenzQ
[22:22:06] <ghrust> 13rust/06auto 14c08cfa1 15Daniel Fagnan: Fixed invalid JavaScript...
[22:22:06] <ghrust> 13rust/06auto 14cbed332 15bors: auto merge of #12484 : TheHydroImpulse/rust/fix_js, r=huonw
[22:22:06] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[22:22:07] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[22:22:07] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/M6HbAw
[22:22:07] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[22:39:19] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:08:57] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[23:09:00] *** Quits: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Client exited)
[23:21:33] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[23:32:11] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:32:11] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/lAenzQ
[23:32:11] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:37:08] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:37:08] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/K3uevw
[23:37:08] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:37:09] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[23:37:10] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/6vdNRQ
[23:37:10] <ghrust> 13rust/06auto 14386db05 15Edward Wang: Make break and continue hygienic...
[23:37:10] <ghrust> 13rust/06auto 14329fcd4 15bors: auto merge of #12338 : edwardw/rust/hygienic-break-continue, r=cmr...
[23:37:10] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
