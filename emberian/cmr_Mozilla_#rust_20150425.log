[00:00:09] *** dmu is now known as dmu|away
[00:00:45] *** Quits: cfcosta (cfcosta@moz-v22.12u.106.187.IP) (Ping timeout: 121 seconds)
[00:01:02] *** Joins: frewsxcv (frewsxcv@moz-lr4.h2r.241.192.IP)
[00:01:07] <frewsxcv> anyone know what causes this? https://gist.github.com/frewsxcv/7fa1885be2c34405447b
[00:01:07] <mkomitee> if I have a boxxed trait, and that trait requires another trait to be implemented, can I cast it to the other trait? Meaning, if I have a Box<BufRead>, can I cast it to a Box<Read>?
[00:01:45] <bluss> mkomitee: in that case, BufRead inherits Read so it shouldn't be needed I think
[00:02:00] <bluss> but I think casting like that is a bit too restricted at the momen
[00:02:18] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[00:02:21] *** Quits: Caspy7 (chatzilla@moz-q45ho1.6qgi.ef7f.0306.2602.IP) (Ping timeout: 121 seconds)
[00:02:29] <mkomitee> Oh, that brings up another question.
[00:02:43] *** Quits: pcwalton (pcwalton@moz-vst.p2i.254.50.IP) (Ping timeout: 121 seconds)
[00:02:53] <mkomitee> If I have a Box<BufRead> which wrapps a BufReader<File> and the Box<BufRead> goes out of scope, will the File get closed?
[00:02:55] <geofft> frewsxcv: 21 is EISDIR, does ~/test/ exist? 
[00:03:02] <geofft> or ~/Downloads/test/, really 
[00:03:20] <bluss> mkomitee: yes
[00:03:22] <frewsxcv> geofft: yep
[00:03:24] *** Joins: Caspy7 (chatzilla@moz-q45ho1.6qgi.ef7f.0306.2602.IP)
[00:03:24] <frewsxcv> geofft: thanks
[00:03:27] <mkomitee> fantastic. Thanks.
[00:03:29] * frewsxcv facepalms
[00:03:32] <geofft> :) 
[00:03:46] <geofft> I'm sorta shocked that ld doesn't call strerror on the errno 
[00:04:21] *** Joins: kazimuth (james@moz-h7l.35b.189.18.IP)
[00:05:10] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[00:05:30] <insaneinside> hrm. "error: type `MyType` does not implement any method in scope named `assert_receiver_is_total_eq`" but `MyType` *does* implement `Eq` and `PartialEq<MyType>`.  What does this mean?
[00:05:36] *** Quits: slurps-mad-rips (slurps-mad-@moz-o2c.uaj.44.17.IP) (Quit: Connection reset by bear)
[00:05:45] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Ping timeout: 121 seconds)
[00:06:09] <cacaca> Sorry, what is the difference between a & and a ref ?
[00:06:10] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[00:06:10] *** ChanServ sets mode: +o erickt
[00:06:51] *** Joins: chronode (chronode@moz-mvs3qb.ga.comcast.net)
[00:07:22] <bluss> cacaca: do you mean the `ref` keyword?
[00:08:12] *** Quits: Guest67_ (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:09:18] *** Joins: fengshaun (fengshaun@moz-rf0qk5.cable.teksavvy.com)
[00:09:20] *** Quits: brson (brson@moz-n4g.7vl.56.172.IP) (Quit: leaving)
[00:09:21] <cacaca> yes :)
[00:09:57] *** Quits: Layl (Layl@moz-65hqmf.direct-adsl.nl) (Quit: Leaving)
[00:10:02] <bluss> well in patterns a & is used to match a present reference
[00:10:09] <bluss> playbot: let &x = &3; x
[00:10:11] -playbot- 3
[00:10:25] <kimundi> cacaca: you need to keep apart & as a operator and & as a pattern.
[00:10:28] <bluss> playbot: let (x, ) = (4, ); x
[00:10:29] -playbot- 4
[00:10:45] <bluss> just like another structure like a tuple, the & is "matched and removed"
[00:10:54] *** Quits: jn (nope@moz-f7bqt1.hsi08.unitymediagroup.de) (Ping timeout: 121 seconds)
[00:11:29] *** Joins: jn (nope@moz-f7bqt1.hsi08.unitymediagroup.de)
[00:11:30] *** Joins: lov2cod (Adium@moz-et68v1.sdt7.vfco.0306.2602.IP)
[00:11:48] <cacaca> and the ref keyword ?
[00:11:49] <bluss> so ref does something else. It changes the bindings inside the pattern from binding the value at that location, to binding a reference to the value at that location
[00:12:25] <bluss> let (ref x, ) = (1, );    // x is a reference to the i32 with value 1 inside the tuple
[00:12:27] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[00:13:12] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[00:13:15] *** Joins: pcwalton (pcwalton@moz-vst.p2i.254.50.IP)
[00:13:15] *** ChanServ sets mode: +ao pcwalton pcwalton
[00:13:18] <cacaca> why not write 
[00:13:29] <insaneinside> Isn't it possible to have a member function (method, non-static method, whatever you want to call it) that takes ownership of `self`?
[00:13:36] *** Joins: lov2cod1 (Adium@moz-jms2kq.u583.gjp6.0119.2620.IP)
[00:13:36] <cacaca> let (*x, ) = (1, )
[00:13:45] *** Joins: laogao (laogao@moz-k1t.k7v.78.124.IP)
[00:14:01] <bluss> cacaca: sounds logical, don't know why
[00:14:07] *** Quits: jimb (user@moz-09a.i8g.126.207.IP) (Ping timeout: 121 seconds)
[00:14:09] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[00:14:09] <bluss> but we have both ref and ref mut
[00:14:47] <FreeFull> cacaca: I imagine some people would be confused by that
[00:15:06] *** Joins: sinistersnare (Mibbit@moz-vj2.mkr.2.129.IP)
[00:15:21] <bluss> insaneinside: yes
[00:15:29] <sinistersnare> is there an image manipulation that can 'split' an image on a given rgba, much like youd split a string?
[00:15:32] *** Quits: lov2cod (Adium@moz-et68v1.sdt7.vfco.0306.2602.IP) (Ping timeout: 121 seconds)
[00:15:35] *** Quits: choplin (choplin@moz-h2ls1j.t6mc.g9m6.001a.240d.IP) (Connection closed)
[00:15:39] <sinistersnare> image manipulation library that can...*
[00:15:44] <aatch> cacaca, the idea is that patterns mirror expressions.
[00:15:48] *** Joins: JoshTriplett (josh@moz-erjgru.or.frontiernet.net)
[00:15:55] <FreeFull> aatch: Yes, that pattern is mirroring an expression
[00:16:01] <cacaca> thx to you bluss 
[00:16:03] <sinistersnare> or is it even a thing that people do?
[00:16:20] *** Joins: Guest67_ (textual@moz-og7.cn8.251.116.IP)
[00:16:27] <cmr> sinistersnare: what would that even mean?
[00:16:40] <JoshTriplett> Given a function foo::bar(...) that returns a Result, and a type SomeStruct that wants to be initialized with the success value of the Result, what's the most idiomatic way to write that?
[00:16:41] <cmr> split on which dimension/how?
[00:17:01] <sinistersnare> cmr: like in a tilesheet. bunch of squares
[00:17:11] <FreeFull> JoshTriplett: What do you want to happen in the error case?
[00:17:12] <cacaca> aatch: When you said mirror that leans like a mirror ?
[00:17:16] *** Quits: wldcordeiro (wldcordeiro@moz-863roc.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[00:17:33] <sinistersnare> cmr: youre right, a second dimension ruins it though
[00:17:42] *** Quits: vairav (vairav@moz-pkkcjo.modeln.com) (Client exited)
[00:17:55] *** Joins: dzyp (dzyp@moz-97od8c.client.mchsi.com)
[00:18:07] <sinistersnare> probably less efficient then just doing math :=\
[00:18:20] <JoshTriplett> FreeFull: I'm writing the constructor for SomeStruct, which is going to return a Result where the error value has the same type as the error I could return.
[00:18:23] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[00:18:25] *** Quits: Guest67_ (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:18:39] <FreeFull> JoshTriplett: Use the try! macro then
[00:18:39] <JoshTriplett> So right now I have a match where the error case looks like: Err(e) => Err(e)
[00:18:45] <JoshTriplett> Ah!  I forgot about that one.
[00:18:45] *** Quits: niconii (nicole@moz-isj0f9.frgo.qwest.net) (Ping timeout: 121 seconds)
[00:19:02] *** Joins: vairav (vairav@moz-pkkcjo.modeln.com)
[00:19:42] <aatch> cacaca, anyway, the point is that `ref` and `mut` aren't part of the deconstruction aspect of patterns, they're part of binding.
[00:19:59] <JoshTriplett> Can I use try! in the middle of an expression?
[00:20:20] <o11c> of course
[00:20:20] *** Quits: tamird (textual@moz-5v5pe2.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:20:24] <o11c> try! is awesome
[00:20:35] <o11c> I liked it so much I had to write it in C++
[00:20:36] <aatch> The idea being that if I make expression like `Foo(a, b)` I can take it apart with a pattern that looks like `Foo(a, b)`
[00:20:50] <JoshTriplett> AFAICT, I still need to wrap my final result in an Ok myself, though, right?
[00:20:52] <FreeFull> aatch: One could imagine * meaning ref though
[00:20:56] <FreeFull> In patterns
[00:21:16] <JoshTriplett> FreeFull: Would make more sense if & did...
[00:21:17] <cmr> * would be the generic deref pattern that's been discussed
[00:21:24] <scott> o11c: how did you write it in C++?
[00:21:26] <cmr> and would replace `box foo`
[00:21:29] <cmr> (as a pattern
[00:21:29] <aatch> FreeFull, but the deref operator doesn't construct a new type.
[00:21:30] <FreeFull> JoshTriplett: Yeah, you need to wrap the final result in Ok()
[00:21:33] *** Joins: niconii (nicole@moz-isj0f9.frgo.qwest.net)
[00:21:38] <JoshTriplett> FreeFull: No convenient shorthand for that?
[00:21:47] *** Quits: bombless (_@moz-odk.piv.41.59.IP) (Ping timeout: 121 seconds)
[00:21:49] <FreeFull> Nope
[00:22:00] <FreeFull> JoshTriplett: It makes sense for & to deref in patterns, because of the mirroring
[00:22:02] <FreeFull> And that's what it does
[00:22:17] <JoshTriplett> Here's what I have, then:         Ok(TestFS { repo: try!(git2::Repository::open(path)) })
[00:22:17] *** Quits: Racquetball (namestolenw@moz-uolvut.res.rr.com) (Quit: leaving)
[00:22:19] <JoshTriplett> Does that look sensible?
[00:22:25] <scott> cmr: * would be an awfully confusing notation for that pattern, considering box and * are essentially opposite in expressions
[00:22:28] <WindowsBunny> scott: macros + templates + masochism
[00:22:31] *** Joins: niconii_ (nicole@moz-isj0f9.frgo.qwest.net)
[00:22:48] <scott> WindowsBunny: I've tried to do it myself, and couldn't without a GCC extension
[00:22:50] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[00:22:55] <scott> to do a return in an expression
[00:23:01] <o11c> scott: https://github.com/themanaworld/tmwa/blob/master/src/compat/result.hpp#L91
[00:23:02] <scott> other than that, not really any masochism required
[00:23:09] <sinistersnare> i like box for the pattern instead of *, is there a good reason to change?
[00:23:10] *** Quits: niconii_ (nicole@moz-isj0f9.frgo.qwest.net) (Quit: leaving)
[00:23:19] <o11c> yeah, it's a GCC extension
[00:23:20] <scott> and I see o11c is using that same GCC extension
[00:23:43] <o11c> I got lazy and didn't auto-detect moves for Result since it was such a pain for Option
[00:23:45] *** Parts: JoshTriplett (josh@moz-erjgru.or.frontiernet.net) ()
[00:24:25] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[00:24:44] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[00:25:21] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[00:25:33] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:26:29] <cacaca> just another question about cargo, I am currently using a librarary (I try to do a Hello Wordl with hyper) but everytime the whole library is recompiled so do you have any idea to make a dynamic library and then use it ?
[00:26:33] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[00:26:33] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[00:26:35] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[00:26:51] *** Quits: asQuirreL (asQuirreL@moz-ro1qqu.ox.ac.uk) (Connection closed)
[00:27:41] *** Joins: asQuirreL (asQuirreL@moz-ro1qqu.ox.ac.uk)
[00:27:48] *** Quits: jbcurtin (jbcurtin@moz-lskisb.LosAngeles1.Level3.net) (Ping timeout: 121 seconds)
[00:27:51] <mbrubeck> Yeah, I find `*x` as a deref pattern to be inconsistent and I fear it would make patterns harder to explain.  Since `let *x = *y` is not equivalent to `let x = y`.  (Unlike `let Some(x) = Some(y)` or `let &x = &y`.)
[00:28:26] <mbrubeck> cacaca: What does your Cargo.toml look like?
[00:28:29] <cmr> that's a good point
[00:28:49] *** Quits: asQuirreL (asQuirreL@moz-ro1qqu.ox.ac.uk) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:29:09] <cacaca> mbrubeck: Well explained. Yes ref seems necessary.
[00:30:06] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[00:30:14] *** Joins: stjahns (stjahns@moz-163098.wireless.telus.com)
[00:30:18] <cacaca> mbrubeck:  only [package] and [dependencies]
[00:30:57] *** Quits: vairav (vairav@moz-pkkcjo.modeln.com) (Client exited)
[00:31:27] *** Quits: stjahns (stjahns@moz-163098.wireless.telus.com) (Connection closed)
[00:31:32] <mbrubeck> cacaca: What's the dependency line for hyper?
[00:31:43] <cacaca> mbrubeck: Yes using ref means more clearly the object pointed is the same and not only the value of the pointed object are equal
[00:32:03] <cacaca> mbrubeck: hyper = "0.3.14"
[00:32:44] <mbrubeck> cacaca: Hmm... In general Cargo tries to rebuild only the crates that have changed, so it's some sort of Cargo bug if it's rebuilding hyper each time.
[00:33:41] *** Quits: Guest62909 (dylan@moz-k5u.d0d.43.100.IP) (Ping timeout: 121 seconds)
[00:34:05] <cacaca> Ahh it is strange because the Hello world take more than  2 minutes to compile with cargo run ?!
[00:34:35] <mbrubeck> cacaca: Does it say "Compiling hyper" in the build output?
[00:34:47] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Connection closed)
[00:34:56] <cacaca> and the executable size 5 Mb.
[00:35:08] *** Quits: pcwalton (pcwalton@moz-vst.p2i.254.50.IP) (Client exited)
[00:35:37] <cacaca> No it say only helloWorld compiling
[00:35:39] <mbrubeck> cacaca: Linking can take a long time if you are linking large libraries.  And linking is static by default.
[00:35:41] <raph1> is Cow::Borrowed the preferred way to get a &str into a Cow?
[00:35:49] <raph1> or is there some trait
[00:35:55] <mbrubeck> cacaca: Okay, so it's not recompiling hyper at least... probably slow linking is the problem.
[00:36:26] *** Quits: cacaca (Mibbit@moz-aua.g0i.51.193.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:36:47] *** Quits: Ralith (ralith@moz-miv.lne.251.63.IP) (Ping timeout: 121 seconds)
[00:37:27] <mbrubeck> raph1: There's an unstable http://doc.rust-lang.org/std/borrow/trait.IntoCow.html
[00:37:28] *** Joins: vairav (vairav@moz-pkkcjo.modeln.com)
[00:37:48] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[00:37:49] <raph1> mbrubeck: so that's not 1.0-compatible, yes?
[00:37:52] *** Joins: Guest67_ (textual@moz-og7.cn8.251.116.IP)
[00:37:58] *** Parts: sinistersnare (Mibbit@moz-vj2.mkr.2.129.IP) ()
[00:38:02] <mbrubeck> right
[00:38:02] *** Joins: copumpkin (copumpkin@moz-doem5v.wlfrct.sbcglobal.net)
[00:38:07] <raph1> i'm not sure it's more ergonomic
[00:38:22] <raph1> being able to use &cow, on the other side, is nice
[00:38:28] *** Quits: JagaJaga (JagaJaga@moz-ua8.hhl.62.178.IP) (Ping timeout: 121 seconds)
[00:38:34] <raph1> if i had to write out cow.borrow() every time, it'd suck
[00:38:41] *** Joins: cacaca (Mibbit@moz-aua.g0i.51.193.IP)
[00:38:41] *** Joins: xrl (uid1091@moz-f0543s.brockwell.irccloud.com)
[00:39:07] <mbrubeck> Which traits have built-in coersions these days?  Just Deref and AsRef?
[00:39:24] *** Joins: Guest5 (textual@moz-hnb58r.oc.cox.net)
[00:40:42] <brontron4k> Is there a project that makes heavy use of Cursor after the io reform?
[00:41:03] <mbrubeck> or maybe it's just Deref and DerefMut http://doc.rust-lang.org/std/borrow/trait.IntoCow.html
[00:41:38] <mbrubeck> brontron4k: I'm not sure how heavy, but https://github.com/PistonDevelopers/image/ has a few
[00:41:43] *** Joins: Guest (textual@moz-rtn.fg7.77.192.IP)
[00:41:53] <mbrubeck> My previous link was supposed to be https://github.com/PistonDevelopers/image/
[00:41:54] *** Joins: Johannes_ (johannes@moz-ufvp1b.nttpc.ne.jp)
[00:41:55] *** Quits: Guest67_ (textual@moz-og7.cn8.251.116.IP) (Ping timeout: 121 seconds)
[00:41:55] <mbrubeck> argh
[00:42:02] <mbrubeck> https://github.com/rust-lang/rfcs/blob/master/text/0241-deref-conversions.md
[00:42:19] <brontron4k> mbrubeck thanks, I'll take a look.
[00:43:17] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[00:44:47] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[00:44:47] *** ChanServ sets mode: +o erickt
[00:44:50] <cacaca> mbrubeck: Do you know how to force dynamic linking to avoid this slow linking ?
[00:44:59] *** Quits: Lovot (Lovot@moz-1je.00u.73.69.IP) (Quit: Lost terminal)
[00:45:07] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[00:45:09] *** Joins: relicanth (Mibbit@moz-ugr.6na.189.18.IP)
[00:45:50] *** Quits: smarks_ (smarks@moz-5vj.vr4.79.109.IP) (A TLS packet with unexpected length was received.)
[00:46:07] <raph1> There's also From::from(), seems to work too
[00:46:36] <raph1> but apparently you can't get rid of the From:: , so again, not clear it's more ergonomic than just constructing the enum
[00:47:27] *** Joins: Lovot (Lovot@moz-1je.00u.73.69.IP)
[00:47:55] <mbrubeck> cacaca: No, I'm not sure how to do it with Cargo.  If you run `cargo build -v` you can see the rustc command it's using, and you can run the same command manually and add `-C prefer-dynamic`
[00:48:47] *** Joins: maedhroz (maedhroz@moz-4jk5ho.res.rr.com)
[00:48:49] <mbrubeck> raph1: You can also spell it `Cow::from` now - http://is.gd/mBWaPr
[00:48:52] *** Quits: vairav (vairav@moz-pkkcjo.modeln.com) (Client exited)
[00:49:56] <mbrubeck> raph1: O hai, just realized you are Raph Levien!
[00:50:03] * raph1 bows
[00:50:17] <mbrubeck> I am http://www.advogato.org/person/mbrubeck/ :)
[00:50:43] <raph1> very cool, your name seemed familiar
[00:50:59] *** Quits: Johannes_ (johannes@moz-ufvp1b.nttpc.ne.jp) (Quit: )
[00:51:04] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[00:51:51] *** Joins: Thorn (Thorn@moz-gfo.20c.107.217.IP)
[00:51:55] *** Quits: lov2cod1 (Adium@moz-jms2kq.u583.gjp6.0119.2620.IP) (Ping timeout: 121 seconds)
[00:52:24] *** Quits: chmanchester (Chris@moz-ha9kvr.2rkg.9kg1.0101.2620.IP) (Quit: Leaving)
[00:52:26] <mbrubeck> raph1: The last time I ran into you was on the urbit-dukes list, and before that was when you responded to an Advogato post about crossword software, in 2002. :)
[00:52:28] *** Quits: dmac__ (dmac@moz-h4nvlf.ca.comcast.net) (Ping timeout: 121 seconds)
[00:52:39] *** Quits: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es) (A TLS packet with unexpected length was received.)
[00:52:49] *** Quits: maedhroz (maedhroz@moz-4jk5ho.res.rr.com) (Ping timeout: 121 seconds)
[00:53:21] <xrl> I have a value of type "archive_infos: Vec<archive_info::ArchiveInfo>". How can I iterate over those archive infos and get a slice back? Is that even what I want?
[00:53:22] <raph1> urbit, now there's a stranger language environment than Rust :)
[00:53:30] <mbrubeck> ha
[00:53:58] <mbrubeck> xrl: You can take a slice by doing `&archive_infos[start..end]`
[00:54:13] <raph1> One other choice (for going into cow) is just to write a function cow(s) { Borrow(s) }
[00:54:20] <mbrubeck> xrl: And you can iterate by doing `for i in archive_infos { /* do stuff with i */ }`
[00:54:27] *** Quits: shawnadelic (shawn@moz-u5o3kk.res.rr.com) (Quit: Lost terminal)
[00:54:44] <raph1> *Borrowed
[00:55:01] *** Quits: rbranson (rbranson@moz-i7m.9o0.201.199.IP) (Quit: Computer has gone to sleep.)
[00:57:04] *** Joins: khades1 (Thunderbird@moz-u45.3vk.74.212.IP)
[00:58:30] *** Quits: khades (Thunderbird@moz-u45.3vk.74.212.IP) (Ping timeout: 121 seconds)
[01:01:17] *** Joins: Ankhers (Ankhers@moz-knoop4.compute.amazonaws.com)
[01:02:20] *** Quits: Ankhers (Ankhers@moz-knoop4.compute.amazonaws.com) (Quit: ZNC - 1.6.0 - http://znc.in)
[01:02:47] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[01:04:32] *** Joins: Ralith (ralith@moz-tiaj7p.customer.broadstripe.net)
[01:05:58] *** Joins: playjax (chatzilla@moz-kv3nv0.optusnet.com.au)
[01:06:16] *** Joins: towler (Mibbit@moz-a66vj9.members.linode.com)
[01:06:24] *** Joins: jimb (user@moz-6gkikn.or.comcast.net)
[01:07:15] *** Quits: towler (Mibbit@moz-a66vj9.members.linode.com) (Quit: http://www.mibbit.com ajax IRC Client)
[01:07:27] *** Quits: hjr3 (hradtke@moz-dmp.av4.169.69.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:07:53] *** Joins: towler (Mibbit@moz-a66vj9.members.linode.com)
[01:08:30] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:09:09] <towler> the book said "::<> syntax allow us give a type hint", where to find this syntax?
[01:09:29] *** Quits: copumpkin (copumpkin@moz-doem5v.wlfrct.sbcglobal.net) (Quit: Textual IRC Client: www.textualapp.com)
[01:09:33] <blaenk> what do you mean by find that syntax?
[01:09:51] <blaenk> somevec.iter().collect::<Vec<i32>>() is how you'd use it
[01:09:57] <blaenk> somefunc::<Type>()
[01:10:18] <towler> yes.
[01:10:59] <relicanth> Is there a function in the stdlib or a crate for search and replace in a string?
[01:11:05] <towler> I want fo find that syntax in the reference book.
[01:12:10] <insaneinside> towler: there's the language reference, and there's "the" book.  They are two different things.
[01:12:25] <xrl> mbrubeck: I would like to "map" the values of the vector to a slice, so perform a computation on each ArchiveInfo and collect that result
[01:12:27] <insaneinside> towler: the language reference is out-of-date, AFAIK.
[01:12:59] *** Joins: copumpkin (copumpkin@moz-doem5v.wlfrct.sbcglobal.net)
[01:13:38] <towler> ok,now i just accept it.
[01:13:48] <mbrubeck> xrl: A slice can't exist independently; it's just a pointer to memory owned by some other value (often a Vec).
[01:14:23] *** Quits: chronode (chronode@moz-mvs3qb.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:14:25] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (A TLS packet with unexpected length was received.)
[01:14:26] <mbrubeck> xrl: You can do `archive_infos.map(|info| /* do stuff with info */).collect::<Vec<_>>()` to compute on each ArchiveInfo and collect the result to a Vec.
[01:14:36] <blaenk> towler: but basically it's pretty simple, so if you defined the fn as fn func<T, U, V>() {}, you could explicitly specify the type when you call it. func::<i32, u64, i8>()
[01:14:40] <mbrubeck> and you can then take slices of that vec, but the slices can't outlive the vec.
[01:14:48] *** Joins: rovar_ (rovar@moz-96effg.dyn.optonline.net)
[01:14:57] <blaenk> and you can use `_` to specify that that should be inferred. func::<i32, _, _>() would mean that T should be i32, and U and V should be inferred (if possible)
[01:14:58] *** Quits: rovar (rovar@moz-6iq.47m.88.38.IP) (NickServ (RECOVER command used by rovar_))
[01:14:59] *** rovar_ is now known as rovar
[01:15:11] *** Joins: rovar_ (rovar@moz-6iq.47m.88.38.IP)
[01:15:35] *** Joins: santiago (santiago@moz-vf1pib.mycingular.net)
[01:15:51] *** Joins: Ankhers (Ankhers@moz-knoop4.compute.amazonaws.com)
[01:16:13] <mbrubeck> xrl: Sorry, that should be `let vec: Vec<_> = archive_infos.iter().map(...).collect();`
[01:16:19] <mbrubeck> (I forgot the `.iter()`)
[01:16:20] *** Joins: shawnadelic (shawnadelic@moz-u5o3kk.res.rr.com)
[01:17:06] *** Quits: jimb (user@moz-6gkikn.or.comcast.net) (Ping timeout: 121 seconds)
[01:18:44] <mbrubeck> xrl: Here's a simple example of code written in that style: https://github.com/mbrubeck/robinson/blob/master/src/style.rs#L64
[01:19:09] <mbrubeck> and https://github.com/mbrubeck/robinson/blob/master/src/style.rs#L93
[01:19:25] *** Quits: santiago (santiago@moz-vf1pib.mycingular.net) (Quit: Computer has gone to sleep.)
[01:20:41] *** Quits: eric_lagergren (barsonme@moz-add4ru.fomj.2174.0008.2601.IP) (Quit: Leaving)
[01:20:47] <aatch> Huh, well aparently LLVM is better at writing SIMD code than I am <.<
[01:21:05] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[01:21:23] <blaenk> does mpsc channel require T to be Sync?
[01:21:31] <blaenk> I figured just Send, but I'm not sure
[01:21:37] <blaenk> checked the docs and source and it doesn't seem obvious
[01:22:20] *** Quits: mate (Mibbit@moz-tpjl46.co.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:22:34] <Amaranth> aatch: I hate/love when that happens :)
[01:22:35] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Connection closed)
[01:23:38] <aatch> Amaranth, I mean loop vectorisation I can understand, there's all sort of issues surrounding alignment and lead-in/lead-out that makes it hard to do correctly.
[01:23:41] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[01:24:11] <geofft> if I want a safe, cross-thread integer, is putting an AtomicUsize in a mutable static the right approach? 
[01:24:28] <geofft> and just doing unsafe SeqCst accesses when I need to access it? 
[01:24:35] <Amaranth> aatch: Last time I tried I think my version lost because of how many times I was moving things in and out of SIMD registers
[01:24:54] *** Quits: Altazimuth_ (Altazimuth@moz-rb7u6p.skybroadband.com) (Ping timeout: 121 seconds)
[01:24:57] *** Joins: anders (andars@moz-bsldst.sntcca.sbcglobal.net)
[01:25:20] <blaenk> geofft: I think the docs include an example of what you want
[01:25:22] <blaenk> http://doc.rust-lang.org/std/sync/atomic/index.html
[01:25:23] <blaenk> second example
[01:26:02] <cacaca> steveklabnik: Sorry, but I searched and I didn't find. Do you have any idea to dynamic linking dependencies rather to have a slow static linking ?
[01:26:08] <geofft> where's atomic_add from? 
[01:27:17] <aatch> geofft, where are you seeing that?
[01:27:22] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[01:28:17] <geofft> in the link blaenk sent 
[01:28:19] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[01:28:24] <geofft> I think that's a hypothetical, not a real function 
[01:28:37] <blaenk> I don't see any atomic_add there
[01:29:12] <Ankhers> In Haskell, I can do something like http://lpaste.net/131409, and use the {to|from}Enum functions to convert the data. How could I achieve something similar in Rust?
[01:29:13] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[01:29:14] *** Joins: Savago (Savago@moz-k613vv.ca.comcast.net)
[01:29:20] <aatch> Ctrl-F "atomic_add" -> "No Matches Found"
[01:30:05] <geofft> oh, apparently my ctrl-c key is flaky. 
[01:30:16] <geofft> thanks <_< >_> 
[01:30:39] <aatch> geofft, there used to be a free atomic_add function, but I think it was removed.
[01:30:56] *** Quits: copumpkin (copumpkin@moz-doem5v.wlfrct.sbcglobal.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:31:12] <aatch> geofft, and there are a bunch of atomic_add_* intrinsics that actually do the atomic operation itself.
[01:31:25] * aatch implemented the first version of the atomics support in Rust.
[01:32:44] *** Quits: loyd (loyd@moz-uft.32f.108.213.IP) (Ping timeout: 121 seconds)
[01:33:01] <geofft> ohhhhh, the atomic ops take &self, not &mut self. 
[01:33:03] <geofft> gotcha. 
[01:33:04] *** Joins: OmniMancer (OmniMancer@moz-bm6ffm.orcon.net.nz)
[01:33:07] *** Joins: bombless (_@moz-61205b.0v2u.0v40.0da8.2001.IP)
[01:33:27] *** Quits: DerisiveLogic (smuxi@moz-5t5.9md.103.24.IP) (Ping timeout: 121 seconds)
[01:34:15] *** Quits: zzmp (zzmp@moz-5p1.h2b.247.173.IP) (Connection closed)
[01:34:36] *** Quits: ellinokon (ellinokon@moz-gh5.r2h.62.178.IP) (A TLS packet with unexpected length was received.)
[01:34:40] *** Joins: ellinokon (ellinokon@moz-gh5.r2h.62.178.IP)
[01:34:47] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[01:37:31] *** Joins: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es)
[01:37:59] <aatch> Dear god optimisation can be fickle. Apparently now my vectorized versions are *actually* faster than the equivalent scalar implementations.
[01:38:25] *** Quits: sw17ch (sw17ch@moz-h64l8d.wa.comcast.net) (Client exited)
[01:39:37] *** Joins: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net)
[01:42:13] *** Quits: hhhhhhhh1 (mike@moz-969kuj.cable.virginm.net) (Ping timeout: 121 seconds)
[01:42:38] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (A TLS packet with unexpected length was received.)
[01:43:20] *** Quits: adjivas (adjivas@moz-t655t6.abo.wanadoo.fr) (Ping timeout: 121 seconds)
[01:43:21] *** Joins: Twinklebear (Twinklebear@moz-ttrcn3.ut.comcast.net)
[01:43:29] <talchas> modern compilers and cpus, how do they wooooork
[01:43:58] <Ankhers> In Haskell, I can do http://lpaste.net/131409 and use the {to|from}Enum functions to convert the data, but allow me to pass around the other data constructors within the Haskell code. How could I accomplish something like this in Rust?
[01:44:19] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[01:44:59] <aatch> talchas, I'm not sure I made any actual changes to the code. Maybe I just managed to tweak the instruction scheduler such that it orders the instructions a bit better?
[01:45:31] <canndrew> Ankhers: rust enums allow you to give a numeric value to the variants
[01:45:48] *** Joins: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net)
[01:45:49] <canndrew> Ankhers: enum MyEnum { Foo = 1, Blah = 2, etc. }
[01:45:54] *** Joins: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP)
[01:46:11] *** Joins: smarks (smarks@moz-5vj.vr4.79.109.IP)
[01:46:37] <blaenk> and in the other direction maybe you use ToPrimitive, I don't remember
[01:46:41] <blaenk> er
[01:46:48] <blaenk> in the other direction I'm not sure what you'd use
[01:46:52] *** Joins: theorbtwo (theorb@moz-jpvr5g.cable.virginm.net)
[01:46:57] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[01:46:58] <Ankhers> canndrew: But one of the constructors don't have a set value.
[01:47:31] <canndrew> Ankhers: ah, well then you'd to write the conversion functions manually
[01:47:42] *** Quits: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu) (Quit: Leaving)
[01:47:57] *** Quits: jawzi (jawzi@moz-9o5r4v.mn.charter.com) (Connection closed)
[01:48:03] <Ankhers> canndrew: I figured that would be the case. Thanks for the help!
[01:48:05] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[01:48:26] *** Quits: alex (alex@moz-s9a.qrc.242.157.IP) (Ping timeout: 121 seconds)
[01:48:52] <canndrew> anyone here had experience writing syntax extensions? I have a sequence of tokens and i need to turn it into a type. Is there a simple way to do that?
[01:49:55] <blaenk> as a side note, you're aware of the caveat that syn exts won't be usable in stable releases?
[01:50:17] <blaenk> but otherwise, you should take a look at I think sfackler's postgresql syntax extension
[01:50:21] *** Quits: smarks (smarks@moz-5vj.vr4.79.109.IP) (Ping timeout: 121 seconds)
[01:50:30] <blaenk> oh tokens, hmm not sure, maybe reem's stainless
[01:50:42] <blaenk> cause I think sfackler's postgresql syn ext takes a string literal
[01:50:54] <reem> I think stainless might be broken
[01:50:59] <reem> but otherwise it’s pretty nice
[01:51:13] <blaenk> hahahaha I bet, but I meant to look at what getting the tokens with a syn ext would be like
[01:51:52] <canndrew> thanks, i'll have a look at stainless
[01:52:09] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[01:52:19] <blaenk> keep in mind what I mentioned, lest you spend all that time thinking you'll be able to use it from stable releases
[01:53:07] *** Quits: Guest (textual@moz-rtn.fg7.77.192.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:54:09] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[01:55:21] *** Joins: da-kid_ (da@moz-4j6ua0.dip0.t-ipconnect.de)
[01:55:45] *** Joins: vairav (vairav@moz-qtc2tv.ca.comcast.net)
[01:56:04] *** Quits: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP) (Ping timeout: 121 seconds)
[01:57:45] *** Quits: polyfractal (polyfractal@moz-dgo.lt5.43.69.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:57:54] *** Joins: v21 (vee@moz-lcs.bqs.204.223.IP)
[01:58:11] *** Quits: da-kid (da@moz-roadks.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[01:58:25] *** Quits: blaenk (blaenkdenum@moz-rrtddg.n2pv.fsko.e000.2605.IP) (Connection closed)
[01:58:39] *** Joins: blaenk (blaenkdenum@moz-rrtddg.n2pv.fsko.e000.2605.IP)
[01:59:07] *** Joins: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP)
[01:59:16] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Connection closed)
[01:59:21] <ChrisMorgan> reem: have you actually tried *using* your TypeMap<A> with a non-default value for A? You missed something rather important in it: all the methods are only implemented on TypeMap, not TypeMap<A>—nor *can* they be, completely generically.
[01:59:46] <blaenk> reem did say that in #rust-internals just a few minutes ago
[01:59:49] <reem> ChrisMorgan: blaenk just brought that to my attention like 20 minutes ago
[01:59:53] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[01:59:55] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[02:00:03] <towler> blaenk. i find this that can explain the type ascription.https://github.com/rust-lang/rfcs/pull/803
[02:00:04] <callahad> Hi Rustaceans, I'm primarily a JavaScript/Python hacker. Can someone check my understanding of Boxes and the heap vs. stack? If I `let x = vec![1, 2, 3]`, what is stored where? My guess is that x is on the stack and is a pointer to a struct on the heap with 3 fields (cap, len, and ptr), where ptr is a pointer to a another, contiguous region of memory on the heap, which holds 1, 2, and 3.
[02:00:08] <reem> I am thinking about how to fix it, but I doubt I can do it without feature gates.
[02:00:20] <ChrisMorgan> That is amusing, for I was just getting to dealing with it myself.
[02:00:33] <blaenk> towler: type ascription is separate from func::<T, U>() syntax, type ascription is not implemented yet
[02:00:41] <towler> blaenk.i found you .
[02:00:53] <reem> I think with some optin_builtin_traits + raw::TraitObject it could be doable, but unstable ruins the day
[02:00:54] <blaenk> ? that sounds scary!
[02:01:00] <o11c> callahad: no, x has 3 fields on the stack, there is not Box there
[02:01:31] <reem> callahad: all variables/bindings are on the stack in rust
[02:01:43] * callahad 's head explodes
[02:01:47] <callahad> Thanks :)
[02:01:52] <ChrisMorgan> (I actually found this shortcoming the day before yesterday but didn’t fully analyse what it meant then or yesterday.)
[02:02:04] <towler> blaenk, i found you had commented  this.
[02:02:05] *** Quits: niconii (nicole@moz-isj0f9.frgo.qwest.net) (Ping timeout: 121 seconds)
[02:02:10] *** Quits: Nextra (Nextra@moz-4g173n.dip.osnanet.de) (Quit: Leaving)
[02:02:13] <blaenk> towler: oh haha
[02:02:17] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[02:02:30] *** Quits: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:02:35] *** Quits: claudiu (claudiu@moz-gqds22.0ekj.kp93.010d.2620.IP) (Connection closed)
[02:02:43] *** Joins: niconii (nicole@moz-isj0f9.frgo.qwest.net)
[02:02:45] <blaenk> but yeah type ascription is different from func::<T>() syntax
[02:02:51] <callahad> So, `let x = Box::new(vec![1,2,3]);` would put the Vec's 3 fields on the heap, and x would be a pointer to those?
[02:03:27] <blaenk> towler: the syntax is described a bit in the reference
[02:03:40] <blaenk> towler: http://doc.rust-lang.org/reference.html ctrl-f "but the trailing component of a path"
[02:03:48] *** Quits: paulosuzart (suzart@moz-lnl.7md.180.191.IP) (Ping timeout: 121 seconds)
[02:04:01] <geofft> callahad: yes 
[02:05:32] <blaenk> `let x = vec![1, 2, 3]`
[02:05:47] *** Joins: niconii_ (nicole@moz-dt9bve.frgo.qwest.net)
[02:06:13] *** Quits: vairav (vairav@moz-qtc2tv.ca.comcast.net) (Client exited)
[02:06:21] <blaenk> I don't think those 1, 2, and 3 of vec are stored on the stack are they? I thought vec has its backing memory on the heap, and the values are written into that memory
[02:06:23] <blaenk> ?
[02:06:35] *** Joins: jawzi (jawzi@moz-9o5r4v.mn.charter.com)
[02:07:03] <blaenk> the other fields of vec, such as its length and capacity, would be on the stack
[02:07:07] *** Quits: niconii (nicole@moz-isj0f9.frgo.qwest.net) (Ping timeout: 121 seconds)
[02:07:08] <blaenk> no?
[02:07:13] <callahad> And lastly, if `let x = Box::new(vec![1,2,3]); let y = &x`,  is y pointing to the same place on the heap as x, or is y pointing *to* x on the stack? I believe it's the latter, but... just making sure. Because all of this is still Very New to me :)
[02:07:31] <callahad> blaenk: From reading the vec source, I'm pretty sure values go on the heap. Let me grab a line ref...
[02:07:33] <blaenk> to x on the stack
[02:07:45] <blaenk> if you want to point to same thing I think you'd do let y = &*x
[02:07:47] *** Quits: jawzi (jawzi@moz-9o5r4v.mn.charter.com) (Connection closed)
[02:07:48] <niconii_> i'm pretty sure your initial intuitions were correct, callahad
[02:07:55] <blaenk> but I don't think you can do that, idr
[02:07:57] *** niconii_ is now known as niconii
[02:07:57] <blaenk> pretty vague on that
[02:08:13] <niconii> the actual Vec struct is on the stack, the contents are on the heap
[02:08:18] <blaenk> yeah
[02:08:34] <blaenk> just like a C++ vector afaik
[02:08:46] <ChrisMorgan> reem: how could optin_builtin_traits be used to make the scheme work?
[02:08:59] <reem> ChrisMorgan: I basically am trying to write an Implements<A> trait
[02:09:04] *** Joins: jfbk (textual@moz-euppi5.res.rr.com)
[02:09:04] *** Quits: cacaca (Mibbit@moz-aua.g0i.51.193.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:09:07] <niconii> hence why you can convert it to Box<[T]> using .into_boxed_slice()
[02:09:15] <reem> since what’s needed is to say K::Value: Implements<A>
[02:09:19] <ChrisMorgan> quite.
[02:09:43] <callahad> blaenk: Yeah, looks like Vec::with_capacity definitely calls alloc for the data chunk: http://doc.rust-lang.org/nightly/src/collections/vec.rs.html#206-218
[02:09:50] <blaenk> yeah
[02:09:57] <ChrisMorgan> reem: the most obvious solution that occurred to me (regardless of whether it’s implemented or not) was associated *traits*.
[02:10:08] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[02:10:13] <reem> right, if you could do that
[02:10:25] <niconii> callahad: (which also means Box<Vec<T>> would be kinda pointless)
[02:10:27] *** Joins: mahdi (mahdi@moz-8oo.182.244.151.IP)
[02:10:28] <blaenk> actually you can indeed do &*x
[02:10:34] <reem> that’s basically what Implements<A> is faking
[02:10:43] *** Joins: slurps-mad-rips (slurps-mad-@moz-o2c.uaj.44.17.IP)
[02:10:46] *** Quits: slurps-mad-rips (slurps-mad-@moz-o2c.uaj.44.17.IP) (Quit: Connection reset by bear)
[02:11:05] <blaenk> I vaguely remember something about *abox behavior being differetn from *anythingelse
[02:11:07] <blaenk> but idr what
[02:11:17] <blaenk> like maybe being able to move out of the box with *abox? idr
[02:11:42] <niconii> playbot: std::mem::size_of::<Vec<i32>>()
[02:11:43] -playbot- 24
[02:12:12] *** Quits: Savago (Savago@moz-k613vv.ca.comcast.net) (Client exited)
[02:12:19] *** Quits: relicanth (Mibbit@moz-ugr.6na.189.18.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:12:21] <niconii> yeah, so that's the pointer, length, and capacity, each 8 bytes (on a 64-bit system)
[02:12:35] <blaenk> callahad: http://is.gd/TNuNL4
[02:13:17] *** Joins: polyfractal (polyfractal@moz-dgo.lt5.43.69.IP)
[02:13:22] <callahad> Ooh, thanks
[02:13:29] <reem> ChrisMorgan: current solution is to do pub unsafe trait Implements<A: ?Sized + UnsafeAnyExt> { fn into_object(self) -> Box<A>; } then write impls for several A traits
[02:13:45] *** Quits: kimundi (kimundi@moz-hac5t8.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:13:47] <reem> using UnsafeAnyExt as a proxy for a trait for raw trait objects
[02:13:50] *** Quits: }ls{ (uhelp@moz-25pv1t.dip0.t-ipconnect.de) (Quit: User terminated by real life interrupt)
[02:13:51] *** Joins: c74d3 (c74d3a4ebb6@moz-1akq3n.mggc.hibn.4404.2002.IP)
[02:14:40] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[02:14:40] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[02:14:46] *** Joins: kimundi (kimundi@moz-dunnue.dip0.t-ipconnect.de)
[02:15:11] *** c74d3 is now known as c74d
[02:16:29] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[02:18:12] *** Joins: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net)
[02:18:43] *** Joins: ty (ty@moz-i6c4to.wa.comcast.net)
[02:18:49] *** Joins: JoshTriplett (josh@moz-erjgru.or.frontiernet.net)
[02:18:53] <ty> How can I get prinlns to go through `cargo test`?
[02:19:02] <callahad> niconii: Ok, so Box<Vec<T>> doesn't make much sense because it's storing a size_t on the stack instead of 3*size_t, and Vecs have move semantics anyways. All adding the Box does is add another layer of indirection?
[02:19:02] <burntsushi> ty: `cargo test -- --nocapture`
[02:19:11] <ty> burntsushi: thanks!
[02:19:12] <JoshTriplett> What's a safe way to turn a [u8; 8] into a u64?
[02:19:13] *** kimundi is now known as zz_kimundi
[02:19:13] *** Quits: ty (ty@moz-i6c4to.wa.comcast.net) (Quit: leaving)
[02:19:20] * callahad is furiously re-reading TRPL :)
[02:19:35] <JoshTriplett> Preferably a zero-cost way.
[02:19:40] <burntsushi> JoshTriplett: use `byteorder` on crates.io (which will force you to confront endianness)
[02:19:47] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (Ping timeout: 121 seconds)
[02:19:55] <niconii> callahad: right
[02:20:34] *** Joins: dpc__ (dpc@moz-t6gr4b.ca.comcast.net)
[02:20:53] <callahad> Thus, Boxes are mainly useful for moving ownership of large structs?
[02:21:07] <reem> giant structs and trait objects
[02:21:17] <JoshTriplett> How can I view the documentation of a package on crates.io?
[02:21:17] <burntsushi> callahad: or writing recursive types
[02:21:19] <JoshTriplett> I don't see a link for that.
[02:21:32] <reem> JoshTriplett: download it and run cargo doc :/
[02:21:33] <burntsushi> JoshTriplett: lower left corner on https://crates.io/crates/byteorder
[02:21:34] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[02:21:49] <JoshTriplett> burntsushi: No idea how I missed that. :(
[02:21:53] <JoshTriplett> Thanks!
[02:21:53] <callahad> Woo. Y'all are the best :)
[02:22:01] <burntsushi> JoshTriplett: not every crate has it unfortunately :-(
[02:22:19] *** Joins: yuja (yuja@moz-3k3neh.so-net.ne.jp)
[02:22:23] *** Quits: dpc__ (dpc@moz-t6gr4b.ca.comcast.net) (Connection closed)
[02:22:33] <scott> it'd be cool if crates.io automatically hosted docs itself
[02:22:53] <JoshTriplett> burntsushi: That's amazingly horrible syntax. :(
[02:23:29] <burntsushi> JoshTriplett: i think "amazingly horrible" is a bit dramatic, but feel free to weigh in: https://github.com/BurntSushi/byteorder/issues/27
[02:23:34] *** Joins: seancorfield (uid45586@moz-avmrbi.uxbridge.irccloud.com)
[02:24:40] *** Joins: Riastradh (riastradh@moz-ecn46c.mathijs.info)
[02:25:05] <JoshTriplett> burntsushi: Sorry, I don't mean the syntax for the reader and writer bits; that much seems fine.  I'm talking about the syntax for directly transforming between [u8] and integer types, which appears to require things like <LittleEndian as ByteOrder>::write_u32
[02:25:30] *** nsm is now known as nsm|away
[02:25:51] *** zz_kimundi is now known as kimundi
[02:25:56] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[02:25:56] <burntsushi> JoshTriplett: i see. actually, that might not be necessary any more..?
[02:25:59] <reem> LittleEndian::write_u32 might work fine, the rules for when you need the < as > syntax aren’t super clear yet
[02:26:09] <JoshTriplett> burntsushi: Ah, that'd be much nicer then.
[02:26:14] <scott> don't you usually use writer.write_u32?
[02:26:22] <JoshTriplett> scott: If you have a writer. :)
[02:26:32] <JoshTriplett> scott: I have [u8], and need u64.
[02:27:01] <scott> you would be reading, then
[02:27:08] <JoshTriplett> I don't have a reader either.
[02:27:33] <JoshTriplett> burntsushi: Two questions:
[02:27:38] <burntsushi> JoshTriplett: ah! `LittleEndian::write_u32` works now! neat.
[02:27:39] <mbrubeck> JoshTriplett: libstd has `impl<'a> Write for &'a mut [u8]` and `impl<'a> Read for &'a [u8]`
[02:27:42] <scott> JoshTriplett: &[u8] is a reader
[02:27:42] <burntsushi> that did not used to be true.
[02:28:00] <JoshTriplett> burntsushi: Is NativeEndian::read_u64 "free" once compiled?
[02:28:10] <JoshTriplett> burntsushi: As in, is it just "reinterpret the region of memory"?
[02:28:30] <scott> it has to check the length
[02:28:32] <burntsushi> JoshTriplett: it should be, yes. i guess that's up to llvm's intrinsics to do properly.
[02:28:38] <JoshTriplett> burntsushi: Ah, good.
[02:29:55] <JoshTriplett> burntsushi: And nevermind on the second one; I think I figured it out.
[02:30:25] <JoshTriplett> burntsushi: Thanks, that's perfect!
[02:30:28] *** Quits: mahdi (mahdi@moz-8oo.182.244.151.IP) (Quit: Leaving)
[02:30:40] *** Joins: kmcguire (kmcguire@moz-c955nf.res.rr.com)
[02:30:46] <burntsushi> JoshTriplett: basically, the read calls should correspond to, e.g., `to_be`: http://doc.rust-lang.org/std/primitive.u16.html#method.to_be
[02:30:52] *** Quits: shawnadelic (shawnadelic@moz-u5o3kk.res.rr.com) (Ping timeout: 121 seconds)
[02:31:10] *** Quits: zcourts (zcourts@moz-7ms809.cable.virginm.net) (Client exited)
[02:31:21] <JoshTriplett> burntsushi: What are you using to interpret a [u8] as the appropriate type to call to_be on?
[02:31:42] <JoshTriplett> burntsushi: And also, what does read_uint use?
[02:31:47] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[02:31:47] *** ChanServ sets mode: +o erickt
[02:31:51] *** Quits: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP) (Ping timeout: 121 seconds)
[02:32:03] *** Joins: mahdi (mahdi@moz-8oo.182.244.151.IP)
[02:32:11] <burntsushi> JoshTriplett: when you say `read_u16`, the code knows to use `u16::{to_be,to_le}`.
[02:32:27] <JoshTriplett> burntsushi: Right; I meant, how are you getting from [u8] to u16 before calling that?
[02:32:46] *** Joins: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP)
[02:32:55] <burntsushi> JoshTriplett: ah. `std::ptr::copy_nonoverlapping`
[02:33:32] <JoshTriplett> burntsushi: Is rust or llvm smart enough to elide that entirely?
[02:33:38] <JoshTriplett> burntsushi: Or does that always turn into "memcpy"?
[02:33:54] <burntsushi> JoshTriplett: truthfully? i don't know. haven't checked.
[02:33:58] <JoshTriplett> Fair enough.
[02:34:01] *** Quits: Selemur (chatzilla@moz-tpgfbn.kawo1.rwth-aachen.de) (Connection closed)
[02:34:17] <JoshTriplett> I'm just looking for something no more expensive than the equivalent C cast.
[02:34:19] <reem> copy_nonoverlapping is a memcpy
[02:34:24] <JoshTriplett> reem: :(
[02:34:36] <reem> LLVM can eliminate it as normal, but it might not
[02:34:54] *** Quits: mahdi (mahdi@moz-8oo.182.244.151.IP) (Connection closed)
[02:34:55] <JoshTriplett> burntsushi: Might it make sense to use std::mem::transmute instead, as long as you're being unsafe?
[02:35:13] <burntsushi> JoshTriplett: yeah i was just thinking about that. i'm not sure why i didn't use that in the first place.
[02:36:50] <JoshTriplett> burntsushi: FWIW, the proposed API in https://github.com/BurntSushi/byteorder/issues/27 sounds quite appealing; abbreviations like be and le seem preferable.
[02:37:01] <JoshTriplett> And "native" *should* be slightly less common, so making it longer is fine.
[02:38:12] *** Quits: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net) (Quit: Leaving)
[02:39:16] * JoshTriplett wishes for a "cargo clone".
[02:40:46] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[02:42:18] <JoshTriplett> burntsushi: https://github.com/rust-lang/cargo/issues/1545
[02:42:21] *** Joins: mpark (Mibbit@moz-oqepvi.cable.rogers.com)
[02:42:42] <burntsushi> JoshTriplett: yeah, that would be nice.
[02:43:18] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[02:43:29] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[02:43:34] <burntsushi> JoshTriplett: an issue with just transmuting is that the API takes *slices* of bytes, which means it has to copy the bits out into an array. from there, it transmutes (or more precisely, casts).
[02:43:40] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[02:43:54] <JoshTriplett> burntsushi: You can't transmute a (reference to a) slice?
[02:44:19] <ChrisMorgan> reem: I’ve got it all sorted out satisfactorily for AnyMap, *except* that AnyMap::new() doesn’t build unless its type is explicitly annotated, e.g. `let x: AnyMap = AnyMap::new();`. In `let x = AnyMap::new();`, the `AnyMap::new` part gets marked as “error: type annotations required: cannot resolve `_ : raw::any::UncheckedAnyExt` [E0283]” and “note: required by `AnyMap<A>::new`”.
[02:44:23] *** Joins: tetsuharu (tetsuharu@moz-fmjbd6.ucom.ne.jp)
[02:44:29] <reem> ChrisMorgan: I am at the same place
[02:44:38] <burntsushi> JoshTriplett: well, a slice is a pointer+length and an array is just raw bytes (with size known at compile time).
[02:44:51] <reem> I solved that by just moving the generic constructor to another method called “custom” and specializing new to A = UnsafeAny
[02:45:05] <ChrisMorgan> That error isn’t making a great deal of sense to me. It feels more like it should be an ICE.
[02:45:14] <JoshTriplett> burntsushi: You could transmute the target of the slice.
[02:45:23] <reem> ChrisMorgan: It’s bizarre since there is an explicit default.
[02:45:45] <burntsushi> JoshTriplett: hmm, that might work.
[02:45:56] <reem> ChrisMorgan: I’m writing an example of creating a TypeMap variant from outside the crate to make sure there aren’t any weird coherence corner cases
[02:45:57] *** Joins: sinistersnare (Mibbit@moz-vj2.mkr.2.129.IP)
[02:45:58] * JoshTriplett tries a quick test.
[02:46:02] <sinistersnare> uhh... am i missing something? http://is.gd/8S5rJu
[02:46:55] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (A TLS packet with unexpected length was received.)
[02:47:04] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[02:47:12] *** Quits: frecel (quassel@moz-qme.p1t.254.162.IP) (Ping timeout: 121 seconds)
[02:47:38] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (Connection closed)
[02:47:41] *** Joins: frecel (quassel@moz-qme.p1t.254.162.IP)
[02:48:11] *** Quits: jfbk (textual@moz-euppi5.res.rr.com) (Quit: )
[02:48:24] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[02:48:46] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[02:48:53] *** Quits: tetsuharu (tetsuharu@moz-fmjbd6.ucom.ne.jp) (Ping timeout: 121 seconds)
[02:49:00] <JoshTriplett> Hmmm.
[02:49:07] <sinistersnare> oh, its becuase i need to call .iter on it.... but i thought IntoIter was a thing?
[02:49:08] <burntsushi> JoshTriplett: yeah, that seems to be OK actually. quickcheck says it's cool, anyway.
[02:49:08] *** Quits: Thorn (Thorn@moz-gfo.20c.107.217.IP) (Quit: Quit)
[02:49:22] <JoshTriplett> burntsushi: What syntax did you come up with to use transmute on a &[u8]?
[02:49:29] <JoshTriplett> Because the obvious thing I tried didn't work. :)
[02:49:32] <burntsushi> sinistersnare: my understanding is that `into_iter()` is only called on the subject of a for loop.
[02:49:40] *** Joins: maedhroz (maedhroz@moz-4jk5ho.res.rr.com)
[02:49:51] <sinistersnare> so if i have to do anything other than straight iteration, it poops?
[02:49:51] <burntsushi> JoshTriplett: `(slice.as_ptr() as *const u16)`
[02:49:54] <sinistersnare> thats ugly
[02:50:00] <JoshTriplett> burntsushi: Heh, cute.
[02:50:11] <JoshTriplett> burntsushi: That doesn't even need transmute, then, just an unsafe block.
[02:50:31] <burntsushi> JoshTriplett: right, because of the pointer dereference. you can usually avoid a lot of uses of transmute.
[02:50:39] <JoshTriplett> burntsushi: Thanks, you're awesome.
[02:50:43] <burntsushi> JoshTriplett: benchmarks say no diff (which i kind of expected).
[02:50:53] <burntsushi> JoshTriplett: i'll commit push and release.
[02:51:01] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[02:51:22] <JoshTriplett> It's possible that LLVM was optimizing away the copy_nonoverlapping calls, or at least optimizing them into a register move given the known size.
[02:51:34] <burntsushi> yeah that seems plausible.
[02:52:28] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (Connection closed)
[02:52:49] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[02:52:56] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[02:53:01] <Sgeo> Maybe there should be a language with no optimizations
[02:53:10] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[02:53:37] <Sgeo> The idea of going to contortions to prevent optimizations so crypto algorithms don't leak scares me.
[02:53:42] *** Quits: maedhroz (maedhroz@moz-4jk5ho.res.rr.com) (Ping timeout: 121 seconds)
[02:53:47] <Sgeo> Declaring intent seems saner, there should be a language that allows that
[02:54:19] <JoshTriplett> Sgeo: In general, a language might do data-independent optimizations, but rarely if ever does data-dependent optimizations.
[02:54:32] *** Joins: mcypark (mpark@moz-si2fdi.yourbnc.co.uk)
[02:54:44] <JoshTriplett> Sgeo: So if you're concerned about timing attacks, that *shouldn't* be an issue.
[02:54:59] <JoshTriplett> (Though it's always possible for a language to be particularly perverse at "helping".)
[02:56:02] <JoshTriplett> burntsushi: I'm having trouble decoding the macros to understand how read_uint actually works.  Can you give me a hint?
[02:56:05] <JoshTriplett> The rest seem obvious now.
[02:56:08] <kmcguire> whats the correct way to see if two instances of Rc<T> point to the same instance of T ?
[02:56:32] <JoshTriplett> burntsushi: Oh, nevermind, I get it now.
[02:56:40] <JoshTriplett> burntsushi: I was confused by the overloaded macro.
[02:56:45] <JoshTriplett> But "be" and "le" there are literals. :)
[02:56:53] <burntsushi> JoshTriplett: yup, those can be tricky to see.
[02:56:54] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[02:56:54] *** ChanServ sets mode: +ao pcwalton pcwalton
[02:56:56] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (Connection closed)
[02:57:01] <burntsushi> JoshTriplett: yeah, i'm trying to figure out how to get rid of the memcpy in the `be` case.
[02:57:59] <JoshTriplett> burntsushi: as_ptr + (8 - $bytes) ?
[02:58:03] <JoshTriplett> er, as_ptr()
[02:58:34] <JoshTriplett> Oh, I see the problem.  The *be* case.
[02:58:44] *** Quits: mpark (Mibbit@moz-oqepvi.cable.rogers.com) (Quit: http://www.mibbit.com ajax IRC Client)
[02:58:45] *** mcypark is now known as mpark
[02:58:58] *** Joins: mzabaluev (Thunderbird@moz-3bijqs.bb.dnainternet.fi)
[03:00:10] <JoshTriplett> Come to think of it, I'm not sure you can get rid of the copy in the le case, either.
[03:00:37] <burntsushi> JoshTriplett: yeah, quickcheck says it's OK, but i'm concerned.
[03:01:00] <JoshTriplett> What does the le case look like?
[03:01:27] <burntsushi> just remove the copy_nonoverlapping and replace `ptr_out` with `$src.as_ptr()` in the following line.
[03:01:40] <burntsushi> seems like that should be OK.
[03:01:50] <JoshTriplett> No, you can't do that.
[03:02:07] <JoshTriplett> It only works if $src happens to have extra bytes on the end.
[03:02:17] <JoshTriplett> Consider read_uint of 5 bytes from [1, 2, 3, 4, 5].
[03:02:24] <JoshTriplett> You can't cast that to u64 and read it.
[03:02:49] <JoshTriplett> I think for read_uint you're stuck with copy_nonoverlapping.
[03:03:06] <mbrubeck> JoshTriplett: Cast and then bitmask?
[03:03:14] <JoshTriplett> mbrubeck: That still assumes you can read 8 bytes.
[03:03:22] *** Joins: konsolebox (konsolebox@moz-lpd.tgb.198.112.IP)
[03:03:23] <mbrubeck> oh right. might just segfault
[03:03:24] *** Quits: laogao (laogao@moz-k1t.k7v.78.124.IP) (Connection closed)
[03:03:29] <burntsushi> JoshTriplett: yeah i think you're right. this means my tests need work because nothing failed when i tweaked the le case.
[03:03:56] <JoshTriplett> burntsushi: Your tests should include a case like read_uint of 5 bytes from [1, 2, 3, 4, 5, 6, 7, 8] and making sure you don't get the extra bytes.
[03:04:19] <JoshTriplett> (so making sure you get 0x0504030201 or 0x0102030405 as appropriate)
[03:05:20] <JoshTriplett> mbrubeck: Assembly code would commonly optimize this case for aligned operations by "knowing" that you won't segfault if you read un-owned memory that doesn't cross a page boundary.  So assembly would read 8 bytes and ignore 3.
[03:05:32] <JoshTriplett> mbrubeck: But that only works if you actually have alignment.
[03:05:34] *** Joins: theme (theme@moz-t9g.aia.29.202.IP)
[03:05:46] <mbrubeck> yeah
[03:05:56] *** Quits: yuja (yuja@moz-3k3neh.so-net.ne.jp) (Quit: Leaving)
[03:05:59] <JoshTriplett> Without alignment, I don't even see a way to do this in assembly more efficiently than a byte-by-byte read.
[03:06:06] *** Joins: laogao (laogao@moz-k1t.k7v.78.124.IP)
[03:06:08] *** Parts: sinistersnare (Mibbit@moz-vj2.mkr.2.129.IP) ()
[03:06:52] <JoshTriplett> Actually, I take that back.  There's an instruction that can do it, but it would require a fairly recent processor.
[03:07:58] *** Joins: pr0c (proc@moz-tnbie4.dip0.t-ipconnect.de)
[03:08:03] *** Joins: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP)
[03:08:17] *** Quits: Church (hatter@moz-e031bf.dyn.optonline.net) (Quit: WeeChat 0.3.8)
[03:08:42] *** Quits: Riastradh (riastradh@moz-ecn46c.mathijs.info) (Ping timeout: 121 seconds)
[03:09:10] <JoshTriplett> (And you'd still have to know in advance how many bytes, so you'd probably use a jump table for values 1-8.)
[03:10:08] *** Quits: laogao (laogao@moz-k1t.k7v.78.124.IP) (Ping timeout: 121 seconds)
[03:10:25] <burntsushi> JoshTriplett: nice catch! regression test added.
[03:11:36] *** Quits: proc (proc@moz-11t9cg.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:11:38] *** Quits: ahal|afk (ahal@moz-b8e0a0.cpe.pppoe.ca) (Quit: Leaving)
[03:12:09] <JoshTriplett> burntsushi: So, with that test added, the le implementation you had fails?
[03:12:13] <burntsushi> yup
[03:12:41] <JoshTriplett> burntsushi: Thanks for working on this!  Got a link for the new source?
[03:13:08] <burntsushi> JoshTriplett: almost. getting rid of the `<ByteOrder as LittleEndian>` syntax :-)
[03:13:11] <reem> ChrisMorgan: It doesn’t work well with coherence, since you can’t implement Implements<A> for a type parameter outside of the home crate.
[03:13:24] <reem> ChrisMorgan: so only the variants provided by the crate can work :/
[03:13:26] <JoshTriplett> burntsushi: Much oblige.d
[03:13:28] <JoshTriplett> *obliged
[03:13:46] <JoshTriplett> burntsushi: Any plans to adopt the syntax in the issue you linked me to in a future version?
[03:14:21] <ChrisMorgan> reem: which is, in my case: Any or CloneAny plus any of Send and Sync.
[03:14:22] *** Joins: fyolnish (fyolnish@moz-3n24u8.so-net.ne.jp)
[03:14:33] <reem> same here
[03:14:37] <burntsushi> JoshTriplett: i honestly don't know yet. tyoverby has a use case with the existing approach, and the tweaked syntax will still require type annotations when reading (unless inference alleviates you)
[03:14:41] *** Quits: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net) (Ping timeout: 121 seconds)
[03:14:55] <reem> well, CloneAny only, not CloneAny + Send etc.
[03:15:20] <JoshTriplett> burntsushi: Inference is nice.  And it's not so much that I'm attached to *that* particular alternate syntax as that I'd like to see something as short as "le" or "be" rather than LittleEndian and BigEndian.
[03:15:32] <JoshTriplett> (For the moment, I'm probably going to do a renaming import of the types. ;) )
[03:15:45] <burntsushi> JoshTriplett: i think i do that myself in places too :-)
[03:15:57] <JoshTriplett> Doesn't need to be as pithy as "htonl", but something not much longer than that would be nice.
[03:16:46] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[03:17:20] *** Quits: kazimuth (james@moz-h7l.35b.189.18.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:18:04] *** Quits: idegen (greg@moz-9c4nle.or.frontiernet.net) (Quit: Leaving.)
[03:18:18] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[03:18:58] *** Joins: diego (Mibbit@moz-teb.392.140.177.IP)
[03:18:59] <FreeFull> Let's say that I have a header that has a line that says  "struct foobar;", what's the corresponding type declaration in Rust if I'm binding to that library?
[03:19:20] *** Joins: copumpki_ (copumpkin@moz-4g2.8fo.42.70.IP)
[03:19:45] *** Quits: theme (theme@moz-t9g.aia.29.202.IP) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[03:20:00] *** Quits: OtterCoder (quassel@moz-lij.rme.199.67.IP) (Connection closed)
[03:20:13] <FreeFull> Also, what's equivalent to bool from stdbool.h?
[03:20:37] <burntsushi> JoshTriplett: all right, all pushed. on crates.io in `0.3.9`.
[03:20:58] *** Joins: gandalf_ (zbraniecki@moz-cp7c4m.ca.comcast.net)
[03:21:17] *** Quits: ajitk (ajit@moz-6ht.i8n.51.106.IP) (Ping timeout: 121 seconds)
[03:21:19] *** Quits: copumpkin (copumpkin@moz-4g2.8fo.42.70.IP) (Ping timeout: 121 seconds)
[03:21:20] <ChrisMorgan> reem: I’m thinking of renaming AnyMap<A> to Map<A> and adding `type AnyMap = Map<Any>;`. That way AnyMap::new() works.
[03:21:29] <aatch> FreeFull, for `struct foobar`, you probably want something like `enum foobar { }`, since I assume the C struct is opaque.
[03:21:30] <ChrisMorgan> (And yes, I have confirmed that it works.)
[03:21:41] <FreeFull> aatch: Yeah, that's what I was thinking
[03:21:42] <reem> ChrisMorgan: ooh interesting, I didn’t know you could call static methods through type aliases now
[03:21:50] *** Quits: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:21:51] <reem> that sounds like a good idea
[03:22:01] <aatch> You can also do impl's on type aliases.
[03:22:02] <FreeFull> aatch: The functions in the header only ever operate on pointers to the structs
[03:22:28] <ChrisMorgan> reem: yeah, it didn’t work in the past but with the UFCS stuff that’s happened since then I figured I might as well try it again; I was pleased to find it works.
[03:22:47] <aatch> FreeFull, yeah, sounds like you want to use an uninhabited enum then, so users can't construct one themselves.
[03:22:50] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[03:22:59] <reem> I am trying to reuse the Implements<A> infrastructure to generalize CloneAny but it’s nuts
[03:23:02] *** Quits: arty (Mibbit@moz-ineiim.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:23:04] *** Quits: cjwelborn (cjwelborn@moz-np6hed.al.charter.com) (Ping timeout: 121 seconds)
[03:23:32] <JoshTriplett> burntsushi: Looks like http://burntsushi.net/rustdoc/byteorder/trait.ByteOrder.html is not yet updated with the new docs.
[03:23:50] <FreeFull> aatch: What about bool?
[03:24:01] <ChrisMorgan> reem: I’ll show my code in a few minutes when I’ve finished tidying things up.
[03:24:01] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Ping timeout: 121 seconds)
[03:24:06] <burntsushi> JoshTriplett: maybe your cache is biting you? looks OK to me?
[03:24:10] <diego> hello all, I have a question about making something like a map of names to factory methods, the return type is a trait, something like this http://pastebin.com/sguzUQrF
[03:24:19] <reem> ChrisMorgan: do you have a different approach?
[03:24:20] <burntsushi> JoshTriplett: i see `LittleEndian::write_u32` in the examples
[03:24:27] <diego> but having the error cast to unsized type: `command::Job` as `command::Command`
[03:24:33] <ChrisMorgan> reem: I’m using an Implements trait.
[03:24:35] <JoshTriplett> FreeFull: I haven't found a bool equivalent to the libc::* typres.
[03:24:36] <JoshTriplett> *types
[03:24:39] *** Quits: kalail (uid62296@moz-5ck9vu.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[03:24:40] <JoshTriplett> burntsushi: Sure enough, sigh.
[03:24:42] <diego> what am I doing wrong??
[03:24:43] <JoshTriplett> burntsushi: Browser fail.
[03:24:51] <burntsushi> :P
[03:24:53] <JoshTriplett> (or web server fail, not sure which)
[03:25:04] <JoshTriplett> Somebody had the wrong answer for "is this up to date".
[03:25:21] <FreeFull> JoshTriplett: Yeah, the libc crate doesn't have the stdbool.h bool
[03:25:23] <burntsushi> yeah. i think i have nginx serving that. but maybe i config'd it wrong.
[03:25:51] <JoshTriplett> burntsushi: Might just be caching too aggressively.
[03:25:54] *** Quits: orangeshark (erik@moz-vuio7k.44tj.56ot.0306.2602.IP) (Quit: Leaving)
[03:25:58] <ChrisMorgan> reem: well, I called it IntoBox with an into_box method, but it’s the same as what you suggested.
[03:26:26] *** Joins: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net)
[03:28:22] *** Quits: zzmp (zzmp@moz-d4rqdv.12ul.lrlq.5500.2604.IP) (Quit: )
[03:29:12] <reem> ChrisMorgan: generalizing the CloneAny thing doesn’t work, or at least I can’t make it work
[03:29:24] *** Quits: copumpki_ (copumpkin@moz-4g2.8fo.42.70.IP) (Quit: Textual IRC Client: www.textualapp.com)
[03:29:27] <reem> the problem is you end up wanting Box<ObjectClone<ObjectClone<ObjectClone<…>>>>>
[03:29:50] <reem> or wait…
[03:32:11] <reem> ya, rustc isn’t smart enough to figure this out
[03:32:42] <reem> it’s telling me X doesn’t implement Y, then when I add an impl it tells me that it conflicts, and it’s because it thinks X might implement Y :/
[03:32:44] <ChrisMorgan> Lunch time, I’ll get back to it later.
[03:32:46] <diego> is there a better way to have something like a factory hashmap that given a key, return an implementation of a trait? I'm really freezed on this. 
[03:33:51] *** Quits: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net) (Ping timeout: 121 seconds)
[03:34:12] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[03:34:22] *** Joins: yuja (yuja@moz-3k3neh.so-net.ne.jp)
[03:34:33] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[03:34:51] <FreeFull> I am already assuming that C's int == i32
[03:35:16] <FreeFull> So I might as well check how big _Bool is and make more assumptions
[03:36:34] <FreeFull> size 1
[03:36:35] *** Joins: Dr_Doom (Mibbit@moz-7ki.ilb.119.197.IP)
[03:36:48] <FreeFull> I'll just use Rust's bool and hope it works then
[03:36:49] <JoshTriplett> FreeFull: If you're assuming that, you can assume that Rust's "bool" is C "bool".
[03:37:05] <JoshTriplett> FreeFull: I've tried that, it works, I just don't think it's guaranteed.
[03:37:15] <FreeFull> Yeah, I just wanted to check sizes matched
[03:38:38] *** Quits: geomyidae_ (uid214@moz-n22p0h.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[03:39:20] <burntsushi> diego: is `Command` a trait? if so, you need to put it behind a pointer if you want to use it as a trait object. probably `Box<Command>` and `Box::new(Job) as Box<Command>`
[03:40:19] <blaenk> so if str::slice_chars is unstable, how do we do substring stuff? I have a git sha and I want to condense it so it's only like 7-8 characters/digits
[03:40:35] *** Joins: negge (nathan@moz-p79l68.fios.verizon.net)
[03:40:37] <burntsushi> blaenk: `str::chars`?
[03:40:48] <blaenk> chars().take(8).collect::<String>() ?
[03:41:05] <burntsushi> sounds find to me!
[03:41:12] <blaenk> alright
[03:41:20] <diego> ok... I'm going in this direction, but the compiler is throwing "cannot convert to a trait object because trait `command::Command` is not object-safe"
[03:41:58] *** Joins: aholler (aholler@moz-hp9ue2.dip0.t-ipconnect.de)
[03:42:22] *** Quits: Dr_Doom (Mibbit@moz-7ki.ilb.119.197.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:42:31] <burntsushi> blaenk: i think that's not a complete replacement since you're allocating. but if you want to not allocate, you'll need to do more work (get the byte offset boundaries).
[03:42:32] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[03:42:37] <posix4e> I've got a rust function where i pass in one variable as input, and return something else as output. I don't want to destruct the input until the thing I returned is destructed. I figure I can use lifetimes for this. Basically say the thing I am going to return is in the same lifetime of the thing that is passed in but I am not sure how to do this. 
[03:43:04] *** Joins: sysko1 (bst@moz-qau.e3g.230.116.IP)
[03:43:05] <diego> oh, got it
[03:43:09] <blaenk> burntsushi: yeah :/
[03:43:33] *** Quits: negge_ (nathan@moz-p79l68.fios.verizon.net) (Ping timeout: 121 seconds)
[03:43:34] <burntsushi> diego: yeah, object safety is pretty tricky. the RFC might give you some hints: https://github.com/rust-lang/rfcs/blob/master/text/0255-object-safety.md
[03:43:40] <mbrubeck> posix4e: Does the thing you return have a type that you control?  i.e. can you add parameters and fields to it?
[03:43:48] <burntsushi> diego: this dives into it: http://huonw.github.io/blog/2015/01/object-safety/
[03:43:57] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[03:44:13] <posix4e> mbrubeck, yes and no. But that's a good idea. I'll try that
[03:44:16] *** Parts: JoshTriplett (josh@moz-erjgru.or.frontiernet.net) ()
[03:44:23] *** Quits: sysko (bst@moz-qau.e3g.230.116.IP) (Ping timeout: 121 seconds)
[03:44:44] <mbrubeck> posix4e: For example, you could make the output value own or borrow the input value.
[03:44:56] *** Quits: aholler_ (aholler@moz-dqgirv.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:45:37] <aatch> posix4e, btw, destructors are run in a FILO order, if the values aren't moved.
[03:45:37] <diego> the best way to reference an implementation is through a Box...? 
[03:45:51] <burntsushi> diego: can you say more?
[03:45:58] <posix4e> aww thanks guys
[03:46:00] <mbrubeck> posix4e: Or maybe use `PhantomData<&'a InputType>` if you don't want to actually change the layout of the output type: http://doc.rust-lang.org/std/marker/struct.PhantomData.html#indicating-ownership
[03:46:01] <posix4e> your the best
[03:46:39] <posix4e> mbrubeck: ok i'll try it that way first
[03:46:49] <diego> burntsushi: I'm coming from C++/Java and to have a reference for an interface is very easy
[03:47:06] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[03:47:12] <diego> burntsushi: but the lifetime/box thing is drive me crazy 
[03:47:36] <burntsushi> diego: you don't always need to do that in Rust though, often, bounded polymorphism is enough.
[03:48:04] <burntsushi> diego: e.g., `fn do_something_with_command<T: Command>(cmd: T) { ... }`
[03:48:29] <aatch> diego, the problem is that your trying to write your code the way you would in C++ or Java
[03:48:38] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[03:49:19] <diego> aatch: yea, I'm yet getting the rust way
[03:49:32] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[03:49:39] <burntsushi> diego: i very very rarely use trait objects at all. i think i have one place where i really need them (in current Rust) and another place where i got a little lazy.
[03:50:04] <diego> burntsushi: If I want a list of implementations of an trait, how may I do that?
[03:50:05] <blaenk> http://alexcrichton.com/git2-rs/git2/struct.Repository.html
[03:50:08] <blaenk> "When a repository goes out of scope it is freed in memory but not deleted from the filesystem."
[03:50:10] <blaenk> well that's a relief
[03:50:11] <aatch> diego, you'll get there eventually, but I've certainly found that trying to solve a problem the way an OO language does leads to pain.
[03:50:54] <burntsushi> diego: that said, they are good for a lot of things. if you want a container of implementations for a trait, all with potentially different underlying types, then a trait object might be the right choice.
[03:50:56] <aatch> diego, what is the problem you are trying to solve? Because it still seems like you're thinking in OO terms.
[03:51:14] <burntsushi> diego: but yeah, what aatch said ^
[03:51:34] *** Joins: mdinger (Mibbit@moz-mvlcev.gnvlsc.sbcglobal.net)
[03:51:40] <Sgeo> I don't get when APIs are supposed to accept an exact type and when they're supposed to accept a type that implements a trait that converts to the type the function really wants
[03:51:42] *** Joins: noustuff (noustuff@moz-c2trbq.sntcca.sbcglobal.net)
[03:51:50] <Sgeo> Like, how is that design decision made?
[03:52:06] <diego> aatch, burntsushi: Im doing a command line tool for Apache Mesos / Mesosphere(marathon/chronos) cluster solution  
[03:52:07] <burntsushi> Sgeo: for me, i think ergonomics has been driving it.
[03:52:27] <mdinger> how do I call an external function like echo via rust?
[03:52:28] <geofft> Sgeo: for me, I'd do that depending on whether I intend to change the data type without bumping the major version of the library 
[03:52:29] <diego> something like "mesosphere job --list-all"
[03:52:41] <mdinger> I know how to take arguments but not to send commands
[03:52:46] <burntsushi> Sgeo: like, if i want to get an owned string, then i'll use `T: Into<String>`. that way, you can give a `&str` or a `String`.
[03:52:57] *** Quits: Diggsey (diggsey@moz-fbohmi.dsl.pipex.com) (Ping timeout: 121 seconds)
[03:52:57] <geofft> mdinger: echo, like the command? http://doc.rust-lang.org/std/process/index.html 
[03:52:59] <Sgeo> That git one seems to have signatures like open<P: AsRef<Path>>(path: P)
[03:53:13] <Sgeo> Instead of open(path: &Path)
[03:53:15] <diego> the root part "job" is a Command, and there is some implementations, like the Job on
[03:53:17] <aatch> Sgeo, that's so you can pass an existing path, or a string
[03:53:17] <diego> one
[03:53:20] <geofft> mdinger: there's an example in http://doc.rust-lang.org/std/process/struct.Command.html 
[03:53:22] *** Quits: pr0c (proc@moz-tnbie4.dip0.t-ipconnect.de) (Quit: Gotta eat my pizza)
[03:53:29] <burntsushi> Sgeo: yeah, it just means that you can give it a PathBuf or a Path.
[03:53:31] <blaenk> Sgeo: that's just to enable for example open("blah")
[03:53:36] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[03:53:43] <diego> but I'm really think the OO way
[03:53:45] <mdinger> geofft: yeah, that looks right. thanks. I'll look it over
[03:53:46] <aatch> diego, you'll probably be better off with an enum then.
[03:54:16] <geofft> you can also just do Command::new("echo").arg("hello").output(), if you don't need a shell involved 
[03:54:20] *** Quits: redShadow (redShadow@moz-47mtkq.retail.telecomitalia.it) (Ping timeout: 121 seconds)
[03:54:27] <diego> aatch: I see, it's the oo way of thinking
[03:54:55] <aatch> diego, it's not just OO, it's class-based inheritance-driven OO that's the issue.
[03:55:09] <aatch> It just doesn't match up to Rust very well at all.
[03:55:41] <diego> aatch: is there any good reference to get the "Rust Way"
[03:55:46] <diego> ?
[03:55:53] <Sgeo> I think the concept of forwarding is a good one, but I don't like the way Ruby does it.. as a hack, iiuc
[03:56:05] <Sgeo> Full-class forwarding support would be neat
[03:56:08] <Sgeo> *First-class
[03:56:30] <burntsushi> diego: the language is still young, and just a few months ago, was still undergoing big changes in the standard library. i don't think anyone has a complete picture of the Rust Way yet.
[03:56:36] <aatch> diego, no idea, sorry. Never looked. the "Rust Way" has changed more times than I can count in my time here (though it's certainly stablised)
[03:56:56] <burntsushi> diego: but yeah, some sort of "idiomatic rust" guide should probably at least *start* happening soon.
[03:57:16] <blaenk> the cargo cult rust manual
[03:57:21] <steveklabnik> :D
[03:57:24] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[03:57:33] <mbrubeck> diego: I don't think that sort of thing is really documented yet; we're still figuring it out.  But it draws a lot on ML and Haskell (in addition to other influences), so if you know or can learn about how programs are designed in those languages...
[03:57:34] <diego> burntsushi, aatch: any github command line tool that might be a reference..?
[03:57:37] <aatch> First we need to know what idiomatic rust *is*, then we can have a guide.
[03:57:47] <blaenk> lol
[03:57:51] <burntsushi> diego: biased recommendation, but https://github.com/BurntSushi/xsv
[03:58:09] <burntsushi> diego: i'm not entirely happy with it either, but all the dispatching stuff is here: https://github.com/BurntSushi/xsv/blob/master/src/main.rs
[03:58:18] <burntsushi> diego: and it is using what aatch recommended: an enum.
[03:58:22] <blaenk> rust-lang/regex regex_macros. easy pickings for any beginner
[03:58:46] *** Joins: ajitk (ajit@moz-6ht.i8n.51.106.IP)
[03:59:31] *** Quits: rbrandao (uid30340@moz-89qrca.ealing.irccloud.com) (Quit: Connection closed for inactivity)
[03:59:33] <mbrubeck> My toy graphics command language is also an enum, just a very sparse one at the moment. :) https://github.com/mbrubeck/robinson/blob/master/src/painting.rs#L21-L25
[03:59:48] <Wqer> How would one declare a specific 50 digit number as a BigInt? to_bigint() doesn't work on strings, and there's no data type big enough to store it. 
[03:59:51] <Wqer> Sorry if noob question.
[04:00:26] <blaenk> https://github.com/rust-lang/num
[04:00:37] <blaenk> I think that's relevant
[04:00:49] <Wqer> I'm using that lib and going through its docs. 
[04:00:53] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[04:00:55] <Wqer> But I still don't understand.
[04:01:06] <blaenk> you do
[04:01:14] <blaenk> "23423423423423424234234".parse::<BigInt>().unwrap() 
[04:01:18] <diego> thanks all, I'll take a look in the project 
[04:01:23] <Wqer> I'll try that.
[04:01:23] <blaenk> well you'd match on it to check the error but to show lol
[04:01:52] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[04:01:55] *** Quits: meh (meh@moz-p5gc2m.42-151.net24.it) (Ping timeout: 121 seconds)
[04:02:00] <Wqer> Wow it worked.
[04:02:09] <blaenk> course man
[04:02:10] *** Quits: towler (Mibbit@moz-a66vj9.members.linode.com) (Quit: http://www.mibbit.com ajax IRC Client)
[04:02:30] <Wqer> But where does that syntax come from? And what does the .unwrap() function do?
[04:02:35] <blaenk> :SS
[04:02:39] <Wqer> Sorry I'm a scrub.
[04:02:41] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[04:02:44] <ChrisMorgan> reem: https://github.com/chris-morgan/anymap/pull/22 is updated to use the arcane DST magicks.
[04:02:44] <blaenk> unwrap is pretty basic. have you tried checking out the rust book?
[04:02:48] <blaenk> before jumping into bigint
[04:02:57] <Wqer> Somewhat. I haven't read all of it.
[04:03:02] <mbrubeck> Wqer: http://doc.rust-lang.org/core/result/enum.Result.html#method.unwrap
[04:03:06] <Sgeo> unwrap() is going to be common if it keeps getting used in examples
[04:03:09] <ChrisMorgan> reem: and it works for things like CloneAny + Send + Sync too.
[04:03:10] <Sgeo> I'm kind of scared of that
[04:03:24] <Wqer> https://github.com/Wqer555/Project-Euler-in-Rust
[04:03:29] <Wqer> I'm going through Euler to try to learn Rust.
[04:03:30] <blaenk> meh, hardly a rigorous example. I posted this on irc
[04:03:34] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[04:03:36] <blaenk> didn't feel like posting out a whole match statement in irc lol
[04:03:42] <Sgeo> Can we just get rid of it and replace it with except() at least?
[04:03:47] <blaenk> no
[04:03:50] <blaenk> I'm too lazy
[04:03:50] <Sgeo> At least except() gives you an error message
[04:03:53] <burntsushi> Sgeo: unwrap() was weird enough for a beginner to question what it is. that makes me optimistic. it at least says "something funny is going on here"
[04:03:54] <blaenk> you type it out if you want
[04:04:01] <mbrubeck> Wqer: There is also http://doc.rust-lang.org/num/num/bigint/struct.BigInt.html#method.parse_bytes
[04:04:15] <geofft> just rename it to .maybe_crash() 
[04:04:17] <blaenk> haha
[04:04:21] <Wqer> That makes sense.
[04:04:29] <Wqer> But I'm wondering why it's not implicit. 
[04:04:38] <Wqer> Would you ever not want to use it?
[04:04:46] <blaenk> because normally you're supposed to check if there's an error and if so waht it is
[04:04:49] <geofft> unwrap? you can handle the error instead of crashing. 
[04:04:49] <blaenk> so you can possibly recover from it
[04:04:51] <snow> Is there a chance PathExt will be marked as stable in 1.0?
[04:05:04] <mbrubeck> Wqer: The reason "123".parse<BigInt> works is that BigInt implements FromStr, and str::parse works for any type that implements FromStr: http://doc.rust-lang.org/std/primitive.str.html#method.parse
[04:05:07] <burntsushi> snow: if it hasn't happened yet, then no, probably not.
[04:05:11] <geofft> for instance, there's the try!() macro, which is basically an unwrap-or-return instead of an unwrap-or-crash 
[04:05:13] <burntsushi> snow: hopefully 1.1 :-)
[04:05:21] <reem> ChrisMorgan: Ahh, method level where clauses, I was trying to make an ObjectClone wrapper that used Implements
[04:05:26] <geofft> there's also long-form just matching on the result, etc. 
[04:05:32] *** Quits: mzabaluev (Thunderbird@moz-3bijqs.bb.dnainternet.fi) (Ping timeout: 121 seconds)
[04:05:47] <snow> I guess it's the waiting game again. Thanks burntsushi
[04:06:02] <burntsushi> snow: what do you need from it?
[04:06:03] <geofft> it's generally poor form for library code to panic the entire thread on bad input. it's fine for examples, playing with things, etc. 
[04:06:09] <geofft> it's often okay for main functions. 
[04:06:10] <snow> Just is_dir()
[04:06:27] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[04:06:52] <blaenk> Wqer: the book covers error handling that you're asking about, specifically with the parse method http://doc.rust-lang.org/book/error-handling.html
[04:06:55] <blaenk> should read the book
[04:06:58] <burntsushi> snow: can you use `Metadata`? http://doc.rust-lang.org/std/fs/struct.Metadata.html
[04:07:40] <mbrubeck> Wqer: You should know that the num::BigInt type is known to be fairly slow compared to some other languages' BigInt types, or the GNU GMP library.  This might become important when you get to Euler problems where speed is really critical.
[04:07:47] <snow> Oh that's great. Thanks a bunch burntsushi
[04:07:48] <reem> ChrisMorgan: I was thinking back to when AnyMap first came into existence - we were literally in awe when you just wrote it overnight
[04:08:04] *** Quits: nrc (nrc@moz-9v1svd.xtra.co.nz) (Ping timeout: 121 seconds)
[04:08:09] <reem> different times :)
[04:08:27] <ChrisMorgan> reem: ten minutes, actually.
[04:08:45] <reem> haha, sounds about right
[04:09:12] <reem> the major disadvantage with all this fickle DST stuff is that it is no longer remotely obvious what AnyMap/TypeMap do from reading the code
[04:09:21] <Wqer> mbrubeck: So far speed hasn't been anything I can't fix myself. But I have been experimenting with the FFI, so I'll look into it.
[04:09:23] <ChrisMorgan> reem: … and *that* is why rustdoc is doomed.
[04:09:26] <reem> and it used to be pretty straightforward
[04:10:16] <ChrisMorgan> The completely automated approach to generating documentation falls apart badly when generics become too popular.
[04:10:17] *** Quits: new_one (new_one@moz-jqr.s43.42.128.IP) (Ping timeout: 121 seconds)
[04:10:24] *** Quits: kmcguire (kmcguire@moz-c955nf.res.rr.com) (Ping timeout: 121 seconds)
[04:10:32] <Wqer> Is there a reason why num::BigInt is slow?
[04:10:39] <reem> I’m thinking I will just include a simplified version in the docs
[04:10:54] <reem> that just does the simplest, least optimized, least flexible thing which covers >90% of use cases
[04:11:14] <Wqer> Also I really need to spend more time with the book, but I also noticed that some parts have placeholders. 
[04:11:16] <reem> so you can just read that, understand what’s happening conceptually, then not worry about it
[04:11:44] *** Quits: fyolnish (fyolnish@moz-3n24u8.so-net.ne.jp) (Connection closed)
[04:11:59] <ChrisMorgan> I knew this would happen with rustdoc’s approach, which is why I said what I did in the December 2013 meetup, though the magnitude of the problem hadn’t occurred to me then—we use generics more extensively than I expected, which makes for nice end-user code, horrible library code and dastardly documentation.
[04:12:13] *** Quits: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es) (Ping timeout: 121 seconds)
[04:12:23] <mbrubeck> Wqer: I believe what I heard is that it just hasn't had the optimization effort yet that more mature arbitrary-precision math libraries have.
[04:13:26] <mbrubeck> Wqer: For example, GMP has lots of hand-optimized assembly for different processors, while num::BigInt is all portable Rust.
[04:13:31] <Wqer> Rust is new. I'm sure it will get better. So many new and exciting things are coming out. 
[04:13:48] <Wqer> And by it I mean its projects. 
[04:14:10] <mbrubeck> yeah!
[04:14:35] <raph1> BigInt is one area where hand-tuned assembler can usually beat compilers
[04:14:59] <raph1> historically because it gives you access to carries, but also I'd imagine SIMD these days
[04:15:04] *** Parts: insaneinside (user@moz-dgv9mb.customer.broadstripe.net) ("bye")
[04:15:13] <raph1> adding 2 64 bit numbers is essentially a 65 bit result
[04:15:18] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[04:15:43] <reem> ChrisMorgan: Attributes to hint to rustdoc would help a lot
[04:15:50] <reem> similar to rustc_on_unimplemented
[04:15:57] *** Quits: noustuff (noustuff@moz-c2trbq.sntcca.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[04:16:06] <raph1> there's an assembler instruction that gives you access to that last bit (traditionally "adc"), but it's hard to get to from C or Rust
[04:16:11] *** Quits: dzyp (dzyp@moz-97od8c.client.mchsi.com) (Connection closed)
[04:16:26] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[04:16:40] <raph1> the good news is that it's possible to speed up, just needs work
[04:17:56] *** nsm|away is now known as nsm
[04:18:04] *** nsm is now known as nsm|away|away
[04:18:06] <FreeFull> raph1: And the carry bit is the 65th bit
[04:18:08] <huon> raph1: Rust actually essentially offers it, btw
[04:18:11] *** Joins: noustuff (noustuff@moz-c2trbq.sntcca.sbcglobal.net)
[04:18:20] <raph1> huon: through intrinsics?
[04:18:46] <huon> raph1: yeah, e.g. http://doc.rust-lang.org/nightly/core/intrinsics/fn.u8_add_with_overflow.html
[04:18:59] <huon> raph1: std uses that to implement checked and saturating addition
[04:19:20] <raph1> huon: but not (yet) BigInt?
[04:19:35] <huon> I imagine BigInt doesn't use it, yeah
[04:20:01] <huon> (we don't currently expose e.g. getting the full 9-bit result in safe code, only the intrinsic itself)
[04:20:06] <awe> [00:07:48]  <reem>	ChrisMorgan: I was thinking back to when AnyMap first came into existence - we were literally in awe when you just wrote it overnight
[04:20:10] <awe> ChrisMorgan: can confirm, reem was totally inside me
[04:20:18] <reem> hahaha
[04:20:43] <raph1> huon: that's encouraging though
[04:20:44] <awe> It's always interesting the pings I get given awe is an uncommon word.
[04:21:03] <huon> raph1: that said, SIMD and instructions like https://en.wikipedia.org/wiki/Intel_ADX are probably better than adc
[04:21:07] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[04:22:01] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[04:22:22] <raph1> huon: gah, what a hack (adx)
[04:22:29] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[04:22:30] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[04:22:37] <raph1> but efficient of course :)
[04:23:08] <raph1> huon: i see you've done work exposing the simd intrinsics, that looks potentially very exciting
[04:23:46] <raph1> i started trying to do it ~5 months ago, hit a wall dealing with rust compiler internals
[04:24:10] <gsingh93> what does the closure in the map function take when mapping over a hashmap?
[04:24:15] <raph1> huon: the other problem with adx and friends is that you have to switch on the exact cpu you're targeting
[04:24:50] <huon> raph1: yeah, I've had to hack around the in the compiler a bit/a lot to make SIMD useable
[04:25:22] <raph1> huon: do you know if there's any code that uses it?
[04:25:24] <gsingh93> oh, nvmd
[04:25:25] <huon> raph1: and yeah, CPU switching is the eternal problem with high performance code :'(
[04:25:30] <huon> raph1: uses... SIMD?
[04:25:31] *** Joins: chc4 (chc4@moz-pdo0at.ma.comcast.net)
[04:25:41] *** Quits: noustuff (noustuff@moz-c2trbq.sntcca.sbcglobal.net) (Quit: Textual IRC Client: www.textualapp.com)
[04:25:42] <raph1> yes, the rust intrinsics for simd
[04:26:00] <huon> not really, it's very experimental
[04:26:11] <raph1> right, i should play with it though
[04:26:21] <huon> (especially recently, lots of compiler crashes due the overflow changes)
[04:26:37] <raph1> i have some kernels that i wrote in neon asm, that do things in an interesting way
[04:26:58] <huon> I'd be interested in seeing them if you have the code around
[04:27:16] <FreeFull> I've used some more code from libcore and suddenly I need rust_begin_unwind
[04:27:33] <FreeFull> What should I do?
[04:27:35] <raph1> huon: let me see how much of this i actually released…
[04:28:08] *** Joins: sjj (sjj@moz-mgjunu.asianet.co.th)
[04:28:13] *** Joins: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP)
[04:29:49] *** Joins: noustuff (sid82844@moz-n7p65f.uxbridge.irccloud.com)
[04:30:04] <raph1> huon: https://code.google.com/p/music-synthesizer-for-android/source/browse/#git%2Fcpp%2Fsrc , look at neon_*.s
[04:30:07] *** Quits: psy (psy@moz-ous.ntd.6.103.IP) (Connection closed)
[04:30:41] <raph1> of those, neon_iir is perhaps the most interesting
[04:31:14] *** Joins: soma (Mibbit@moz-ef5.7ab.191.107.IP)
[04:32:02] <huon> raph1: thanks!
[04:32:34] *** Joins: kazimuth (james@moz-h7l.35b.189.18.IP)
[04:32:37] <aatch> I should revist my SIMD RFC. I'm not sure what direction it should go.
[04:32:42] *** Joins: JoshTriplett (josh@moz-erjgru.or.frontiernet.net)
[04:32:53] <JoshTriplett> I just ran into an interesting case in the borrow checker with HashMap.
[04:32:56] <soma> Hello! "let a = Box::new(1i32);  let b = a;"  Will compiler just rename b to a in order to prevent a pointer copy?
[04:33:05] *** Joins: rbranson (rbranson@moz-oeg7f0.ca.comcast.net)
[04:33:29] <JoshTriplett> I wrote match some_map.get(...) { Some(thing) => *thing, None => { ... insert into some_map ... } }.
[04:33:53] <JoshTriplett> The insert call complains it can't get a mutable reference to the hashmap because it was already borrowed by .get.
[04:33:57] *** Quits: konsolebox (konsolebox@moz-lpd.tgb.198.112.IP) (Quit: Leaving)
[04:34:05] <JoshTriplett> Is there any way to .get a value *not* as a reference?
[04:34:08] <reem> JoshTriplett: Welcome to the wondrous world of lexical borrows :) - all borrows in rust are based on lexical scopes, with one start and one end.
[04:34:20] <JoshTriplett> I can see why it happens.
[04:34:21] <reem> JoshTriplett: For maps in particular, use entires
[04:34:23] <gsingh93> ^^ that's the most annoying thing about rust for me
[04:34:24] <reem> entries*
[04:34:31] *** Joins: psy (psy@moz-ous.ntd.6.103.IP)
[04:34:43] <reem> soma: probably, it really should not matter
[04:34:53] <JoshTriplett> reem: Are you talking about the .entry method?
[04:34:59] <reem> yup
[04:35:24] <JoshTriplett> How does that manage to not borrow the map?
[04:35:25] *** Joins: maedhroz (maedhroz@moz-4jk5ho.res.rr.com)
[04:35:35] <reem> it’s just a different interface, which avoids the problem
[04:36:14] <reem> basically it provides you with “evidence” of either a full slot or an empty slot, and you can just insert into the empty slot right there, without invoking the borrow checker’s weak spot here
[04:36:38] <JoshTriplett> Cute.
[04:36:40] <Mutabah> :( are Filter closures not clone?
[04:36:43] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[04:36:43] <JoshTriplett> Obnoxious, but cute.
[04:36:47] <Mutabah> s/closures/iterators/
[04:37:02] <gsingh93> JoshTriplett: i think fixing lexical borrows was stated as a possible goal for 1.1
[04:37:12] <JoshTriplett> Yeah, I saw something about that.
[04:37:32] <Mutabah> Oh, right, iter_mut isn't clone
[04:38:03] <reem> JoshTriplett: It’s actually more efficient too, since it will hash the key/lookup the right slot just once\
[04:38:23] <reem> JoshTriplett: imo the entry interface is actually nicer to use than matching on .get and inserting in the None branch, as long as you know of it
[04:38:27] <mdinger> I've got this closure I'm trying to send to a thread. I think I'm missing something really obvious but I don't know what: http://is.gd/qAJm0h
[04:39:13] *** Quits: seancorfield (uid45586@moz-avmrbi.uxbridge.irccloud.com) (Quit: Connection closed for inactivity)
[04:39:23] <JoshTriplett> reem: So, match some_map.entry(key) { Occupied(e) => *e.get(), Vacant(e) => e.insert(...) } ?
[04:39:36] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[04:39:39] <reem> I believe there is a convenience method for this
[04:40:02] <JoshTriplett> or_insert_with seems to return a &mut V; can I just * that to get a V?
[04:40:06] <reem> JoshTriplett: map.entry(key).or_insert_with(|| value)
[04:40:20] <reem> JoshTriplett: You can * that to get a V if V is Copy
[04:40:26] <JoshTriplett> V here is u64. :)
[04:40:31] <reem> so yes
[04:41:16] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[04:41:33] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[04:41:43] <mdinger> anyone know what I need to do to make it work?
[04:42:05] <JoshTriplett> reem: Why does get take a key by reference, but entry take a key by value?
[04:42:14] <ChrisMorgan> JoshTriplett: it needs to be able to insert it
[04:42:26] <ChrisMorgan> just like insert takes it by value.
[04:42:27] <bstrie> mdinger: looking at it
[04:42:29] <JoshTriplett> Ah.
[04:42:43] <mdinger> bstrie: thanks
[04:42:54] *** Quits: sjj (sjj@moz-mgjunu.asianet.co.th) (Connection closed)
[04:42:56] <JoshTriplett> Wow, just got an error novel from the borrow checker.  This looks *fun*...
[04:43:02] *** Joins: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP)
[04:43:18] <bstrie> mdinger: on line 13 there, it looks like what you want to do is pass a closure to spawn, but what you're really doing is evaluating `closure` and passing the return value to spawn
[04:43:22] <reem> JoshTriplett: better than “Segfault” :P
[04:43:41] <JoshTriplett> reem: No argument there. :)
[04:43:50] *** Quits: diego (Mibbit@moz-teb.392.140.177.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:44:02] <mdinger> bstrie: oh
[04:44:37] <bstrie> mdinger: the error message is saying that spawn expects a closure i.e. a FnOnce, but it's getting a () which is the return type of calling `closure`
[04:44:46] <mdinger> so what do i do?
[04:44:48] <JoshTriplett> reem: OK, I'm confused about something.
[04:45:13] <bstrie> mdinger: is the goal to run `closure` on a separate thread?
[04:45:15] <o11c> calling it or something?
[04:45:20] <mdinger> bstrie: yes
[04:45:22] <JoshTriplett> reem: Here's what I'm writing:
[04:45:37] <JoshTriplett>         *self.oid_inode.entry(oid).or_insert_with(|| {
[04:45:37] <JoshTriplett>                 let inode = self.inode_oid.len() as u64 + 1;
[04:45:37] <JoshTriplett>                 self.inode_oid.push(oid);
[04:45:37] <JoshTriplett>                 inode
[04:45:37] *** JoshTriplett was kicked by belew.mozilla.org (Channel flood triggered (limit is 5 lines in 3 secs))
[04:45:45] *** Joins: JoshTriplett (josh@moz-erjgru.or.frontiernet.net)
[04:45:49] <gsingh93> JoshTriplett: play.rust-lang.org
[04:45:55] <JoshTriplett> OK, somehow I wouldn't have expected that few lines to be a problem. :(
[04:45:58] <mdinger> bstrie: actuall, the goal is to run the command on a separate thread. i just used a closure because that's how threads seem to work
[04:45:59] <bstrie> haha
[04:46:05] <mdinger> bstrie: *actually
[04:46:45] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Connection closed)
[04:46:57] <JoshTriplett> reem: http://is.gd/qxpx49
[04:47:06] <mdinger> bstrie: oh, i suppose i could define the closure inside the spawn thing. i'll try it
[04:47:15] <bstrie> mdinger: `spawn` takes a closure, yes. but note something: the closure that `spawn` takes cannot have any arguments. `closure` takes an argument, `s`
[04:47:15] <blaenk> dude brain fart
[04:47:17] <blaenk> how do you do this http://is.gd/2zSMfR
[04:47:24] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[04:47:28] <JoshTriplett> (inode_oid here is a Vec, and oid_inode is a HashMap)
[04:47:33] *** Quits: rfnash (weechat@moz-ulk8um.in.comcast.net) (Ping timeout: 121 seconds)
[04:47:54] <JoshTriplett> reem: In response to which I get an error complaining that I can't reference self.inode_oid inside the closure because self.oid_inode is mutably borrowed.
[04:48:00] *** Joins: kgrandon (Adium@moz-2igukk.hjek.d045.0009.2601.IP)
[04:48:07] <blaenk> er make the v mut. I do have that in my code
[04:48:19] <reem> JoshTriplett: Ya… You have to not use the convenience function.
[04:48:24] <JoshTriplett> reem: But I'm not mutably borrowing self, I'm just mutably borrowing self.oid_inode, so I should be able to mutably use inode_oid...
[04:48:30] <mdinger> bstrie: oh, that's not obvious
[04:48:39] <reem> JoshTriplett: Basically moves and borrows into closures are static and not dynamic, so they’re more restrictive
[04:48:40] *** Joins: hjr3 (hradtke@moz-e235ok.fios.verizon.net)
[04:48:44] <ChrisMorgan> blaenk: the yielded elements are of type &mut (i32, (i32, i32)).
[04:48:52] <JoshTriplett> reem: I'd like to understand the more fundamental issue here; why does rust thing I've borrowed self rather than just self.oid_inode?
[04:48:53] <blaenk> yeah nevermind, that was a bad reduction of my problem
[04:48:56] <JoshTriplett> *think
[04:49:01] <reem> JoshTriplett: actually one thing you can do is get two mutable references to the fields as two different variables
[04:49:03] <ChrisMorgan> blaenk: therefore you must make your pattern satisfactory, e.g. `&mut (ref mut a, (ref mut b, ref mut c))`.
[04:49:10] <blaenk> http://is.gd/RbOqdQ
[04:49:12] <reem> then borrow one in the closure and one to do the insertion, that should get rustc to agree with you
[04:49:29] <blaenk> ok I think I got it by making &mut (b, c)
[04:49:40] <JoshTriplett> reem: Why can't rust figure out that that's what I've done here?
[04:49:40] <reem> JoshTriplett: Basically the closure borrows all of self since you refer to it, if you did this outside of a closure it would work fine.
[04:49:53] <blaenk> yeah, I'm not reproducing my problem, argh
[04:50:03] <JoshTriplett> Huh.  So the borrow checker just looks at the top-level "self" and doesn't take into account what fields I use?
[04:50:06] <reem> JoshTriplett: Closures are very simple and can be stupid re: borrows and such, since they have to borrow the entire label no matter what.
[04:50:08] <ChrisMorgan> blaenk: if you do that, there’s no point in it being a mutable iterator, it might as well be immutable.
[04:50:21] <blaenk> if I do what
[04:50:24] <reem> JoshTriplett: No, the *closure literal* borrows the entire label, the borrow checker can figure it out normally.
[04:50:28] <blaenk> &mut (b, c)?
[04:50:34] <blaenk> oh yeah, will have to ref mut b, ref mut c etc
[04:50:42] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[04:50:42] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:50:45] <blaenk> I meant to get it to compile. but that's not repro'ing my problem, hmmm
[04:50:49] <JoshTriplett> reem: Is that going to be fixed at some point?
[04:51:11] <reem> JoshTriplett: Not likely, it’s a pretty fundamental limitation of the way closures work.
[04:51:29] <reem> JoshTriplett: like I said though, you can get around it by just creating two separate bindings
[04:51:37] *** Quits: bombless (_@moz-61205b.0v2u.0v40.0da8.2001.IP) (Ping timeout: 121 seconds)
[04:51:40] <JoshTriplett> reem: It did suffice to change it to http://is.gd/dNuCcg
[04:51:46] <JoshTriplett> reem: So I only needed one extra binding.
[04:51:54] <blaenk> alright I got it finally
[04:52:03] <blaenk> thanks for helping anyways chris
[04:52:12] <JoshTriplett> But still, that seems rather unnecessarily painful if the borrow checker can normally understand independent borrows of independent fields.
[04:52:41] <JoshTriplett> Is there some obvious reason why the closure couldn't just borrow the field rather than all of self?
[04:52:45] <JoshTriplett> reem: ^
[04:53:41] <reem> JoshTriplett: If you think about how closures are implemented, how their captures work, they have to borrow the entire label.
[04:54:10] <reem> JoshTriplett: It *might* be possible, but it would complicate the implementation significantly
[04:54:47] <reem> JoshTriplett: closure literals desugar into structs with a field for each capture + an implementation of Fn*
[04:54:56] <mdinger> bstrie: it works!
[04:55:08] <mdinger> bstrie: thanks
[04:55:22] <reem> JoshTriplett: So the closure desugaring would need to know about borrowing before we even really have that information
[04:55:23] <blaenk> anyone know if drain() will be stable?
[04:55:33] *** Joins: mib_4rm9m1 (Mibbit@moz-3qret9.ST.HMC.Edu)
[04:55:46] <bstrie> mdinger: great!
[04:55:50] <soma> reem: Ok. so what does rust move operation do underneath
[04:56:06] <reem> soma: moves are shallow copies
[04:56:17] <JoshTriplett> reem: That doesn't seem quite necessary.  If you reference self.method() within the closure, where method takes &mut self, then sure, you have to borrow all of self.  However, if you reference self.field within the closure (which rustc can easily tell since it has the type of self), the closure could just borrow self.field.
[04:56:32] <bstrie> how do I convert a Vec<u8> into a String
[04:56:44] <JoshTriplett> reem: Just requires recognizing field accesses during desugaring.
[04:56:46] <Mutabah> bstrie: String::from?
[04:56:55] <blaenk> http://doc.rust-lang.org/std/string/struct.String.html#method.from_utf8
[04:57:02] <blaenk> bestray
[04:57:08] <JoshTriplett> reem: Would that be excessively hard for some reason?
[04:57:10] <soma> reem: so it does cause some copies
[04:57:13] <reem> JoshTriplett: I guess it’s possible - I really haven’t dug into the implementation in the compiler, so I can’t really say concretely.
[04:57:24] <soma> reem:why
[04:57:36] <reem> soma: They can be optimized out in some cases, but not in all.
[04:57:51] <reem> e.g. in your example the copy will probably be optimized out
[04:57:54] <JoshTriplett> reem: Would it be reasonable to report an issue on rustc about this?  (Or would this need to be an RFC?)
[04:58:00] <blaenk> soma: it's like a C++11 move. shallow copy. depends on the type
[04:58:02] <reem> JoshTriplett: Ya, you can open an issue.
[04:58:14] <reem> blaenk: moves are always copies
[04:58:21] <soma> reem: ok. when will optimization be imposible?
[04:58:24] <blaenk> I didn't say otherwise reem?
[04:58:31] <blaenk> the poitn is shallow vs deep
[04:58:33] <reem> blaenk: "depends on the type"
[04:58:42] <blaenk> yeah, so if the type has pointers, it only copies the pointers right
[04:58:42] <reem> blaenk: sorry I was not super clear
[04:58:46] <reem> yes
[04:58:49] <reem> that’s a shallow copy
[04:58:49] <blaenk> but if it contains the actual data, then the whole thing would be copied
[04:58:57] <reem> it’s all the same operation
[04:59:09] <blaenk> I understand, the point is that the cost of such a copy depends on the type
[04:59:27] <blaenk> like if you have a type that contains a huge array, then the whole array would be copied right?
[04:59:29] <reem> soma: moving into another structure, moving to return, etc.
[04:59:37] <blaenk> vs a type that contains a huge vec, it'd just copy the pointer to that huge data
[04:59:39] <JoshTriplett> reem: Looks like it's already there: https://github.com/rust-lang/rust/issues/19004
[04:59:54] <bstrie> fg
[05:00:30] <SiegeLord> What happened to ToPrimitive?
[05:01:28] <soma> reem: oh. what are you mean by moving into another structure
[05:01:52] <SiegeLord> Oh, I guess I can just use 
[05:01:55] <SiegeLord> 'as'
[05:02:22] <reem> soma: for instance, in `let x = 7; let y = (x, 6);` x must be copied from its original location to its location within y
[05:02:41] <reem> soma: this is because `&y` has to point to a single value of type (i32, i32)
[05:03:45] <SiegeLord> Hmm... I accidentally made my library compilable on stable Rust, heh
[05:03:55] <soma> reem: ok. thank you for your help
[05:04:07] <Sgeo> reem, are these copies/moves usually fast?
[05:04:26] <Sgeo> Or is this going to be the sort of thing I need to be more careful with in Rust than in higher level languages?
[05:04:27] <reem> they’re memcpys, so yes
[05:04:42] <reem> you do not need to worry about this until it shows up in profiles (which is rare)
[05:05:08] *** Joins: santiago (santiago@moz-vsm.f11.175.104.IP)
[05:05:39] <soma> reem: How can I do such a profile?
[05:06:02] <reem> soma: you can profile rust using the same tools you profile C or C++ with mostly, so it depends on your platform
[05:06:41] *** Quits: gandalf_ (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[05:07:05] <aatch> Question: invertible, or invertable?
[05:07:26] <huon> invertible
[05:08:42] <mdinger> so regarding threads and join, I get that I can spawn and join to wait for the thing to finish by calling `.join()`. What if I decide to use a loop and spawn 20 threads and I want to wait for them all to finish. Do I need to build up a vector of the children and then iterate over the children to see when everything is complete?
[05:08:44] <ChrisMorgan> aatch: when one encounters such questions: https://books.google.com/ngrams/graph?content=invertable%2Cinvertible
[05:09:03] <ChrisMorgan> And if you use DuckDuckGo there’s even the convenient “!ngram invertable,invertible”
[05:09:16] <aatch> ChrisMorgan, heh, thanks.
[05:09:58] <mdinger> or is there a better/different way?
[05:10:53] <blaenk> that's how I've always seen it be done dinger
[05:10:58] <bstrie> mdinger: cleaned up your prior thing a bit so it actually prints (but not on the playpen, apparently): http://is.gd/K3JfOj
[05:11:09] *** Joins: TY (TY@moz-i6c4to.wa.comcast.net)
[05:12:04] *** Joins: ty_ (ty@moz-jl1.5e2.61.174.IP)
[05:12:21] <mbrubeck> mdinger: Yup, I've been using a vec of JoinHandles for that.
[05:12:45] <mdinger> okay
[05:13:00] *** Quits: shaw (uid81344@moz-a388mq.ealing.irccloud.com) (Quit: Connection closed for inactivity)
[05:13:16] *** Quits: Gamecubic (cubic@moz-qfrl13.mc.videotron.ca) (Quit: Leaving)
[05:13:17] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[05:13:42] *** Quits: ty_ (ty@moz-jl1.5e2.61.174.IP) (Quit: leaving)
[05:13:45] *** Quits: TY (TY@moz-i6c4to.wa.comcast.net) (Client exited)
[05:14:08] <mbrubeck> mdinger: http://rosettacode.org/wiki/Sorting_algorithms/Sleep_sort#Rust
[05:15:44] <mdinger> mbrubeck: that's so much cleaner than I imagined. I was imagining something with more arbitrary names I guess.
[05:15:56] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[05:16:10] *** Joins: sp0 (seth@moz-m97a3k.internode.on.net)
[05:16:43] <mbrubeck> mdinger: If you use thread::scoped (not available in 1.0, sadly) then you don't even need to call join explicitly -- it'll be called automatically when the vec goes out of scope.
[05:17:14] <mdinger> bstrie: it wouldn't print until i used `dash` instead of `sh`. not sure why...
[05:17:36] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[05:17:51] <mdinger> mbrubeck: oh. didn't know that
[05:18:15] <mbrubeck> Oh cool, I still have a version of that code from Rust 0.5: https://gist.github.com/mbrubeck/4368362/93452f43d7a220ea2bfc0ad817f4c27b384b79f9
[05:18:22] <mdinger> mbrubeck: you still need the vector though I guess
[05:18:28] <mbrubeck> Check out the old-style `for` and `do` notation!
[05:18:45] <mbrubeck> mdinger: Yup, you still need to store the JoinGuards somewhere.
[05:19:58] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[05:21:57] <bstrie> mdinger: try running `sh "echo hello"` in your terminal, you should see why
[05:22:41] <mdinger> eh, i'm on windows
[05:22:46] *** Quits: rbranson (rbranson@moz-oeg7f0.ca.comcast.net) (Quit: Computer has gone to sleep.)
[05:22:59] <mdinger> i was just using shell because it's plapen
[05:23:01] <mdinger> *playpen
[05:24:20] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[05:24:27] *** Quits: sp0 (seth@moz-m97a3k.internode.on.net) (Connection closed)
[05:24:43] *** Quits: arBmind1 (Andreas@moz-l25oke.adsl.alicedsl.de) (Quit: Leaving.)
[05:26:11] *** Quits: dlc (dlc@moz-ijetde.res.rr.com) (Quit: Leaving)
[05:27:20] *** Quits: soma (Mibbit@moz-ef5.7ab.191.107.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:28:01] *** Joins: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net)
[05:28:22] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (Ping timeout: 121 seconds)
[05:28:32] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[05:28:45] *** Quits: mib_4rm9m1 (Mibbit@moz-3qret9.ST.HMC.Edu) (Quit: http://www.mibbit.com ajax IRC Client)
[05:30:51] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[05:31:11] *** Joins: drewm1980 (drewm1980@moz-b5ce5a.hujf.dasj.1812.2a02.IP)
[05:32:55] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[05:33:01] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[05:33:29] *** Quits: lutter1 (lutter@moz-7v7ueu.PUBLIC.monkeybrains.net) (Quit: Leaving.)
[05:34:06] *** Joins: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au)
[05:34:08] *** Quits: c74d (c74d3a4ebb6@moz-1akq3n.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[05:34:15] <tunnuz> Hello
[05:34:21] *** Joins: stjahns (stjahns@moz-5vg.coe.91.209.IP)
[05:34:29] *** c74d3 is now known as c74d
[05:34:35] <swgillespie> hello!
[05:34:49] <tunnuz> I have a question about rust beta 1.0
[05:34:58] <mdinger> bstrie: a reason you used channels or just cause?
[05:35:00] <tunnuz> before the beta release I started working on a small side project of mine
[05:35:25] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[05:35:30] <tunnuz> in the project I use the following features: core, collections
[05:35:30] *** Joins: nott (nott@moz-to4.06o.57.86.IP)
[05:35:35] <tunnuz> however they are marked unstable in the beta
[05:35:41] <tunnuz> so the code doesn't compile anymore
[05:35:49] <tunnuz> is there a way to enable them, other than reverting to an older version of rust?
[05:35:54] <WindowsBunny> tunnuz: If you want to use unstable features, then you have to use nightly
[05:35:54] <swgillespie> tunnuz: you can still use the nightlies, they aren't subject to that restriction
[05:36:10] <tunnuz> WindowsBunny, swgillespie: oh thanks
[05:36:23] <tunnuz> is it known whether these will be stable in 1.0?
[05:36:42] <swgillespie> that's the plan
[05:36:45] <swgillespie> I think
[05:36:48] <WindowsBunny> At this point, if something isn't stable for the latest beta, it's likely not going to be stable in 1.0
[05:37:05] <tunnuz> So, is there anything wrong, in principle, in using the nightly
[05:37:12] <WindowsBunny> Not really
[05:37:25] <tunnuz> I mean, I guess it's less stable, but this is not a production project so I guess it should be fine
[05:37:30] <WindowsBunny> Yep
[05:37:43] <WindowsBunny> If you write libraries, you want your libraries to be usable by stable though
[05:37:44] <tunnuz> is there a rustup for nightly?
[05:37:48] <WindowsBunny> same rustup
[05:37:57] <WindowsBunny> you just need to specify some flag
[05:38:01] <tunnuz> ok
[05:38:06] <WindowsBunny> That I don't know because I'm on windows and I don't use rustup
[05:39:20] <swgillespie> rustup gets the nightly for me by default, fwiw
[05:39:24] <tunnuz> great, thanks for all the info
[05:39:38] <tunnuz> in fact, there's a --channel flag
[05:39:50] <tunnuz> which allows one to switch from one release to another
[05:40:05] <tunnuz> so, collections and core seem like two important modules
[05:40:16] <tunnuz> isnt't it weird that they will not be stable in 1.0?
[05:40:24] *** Joins: edbond (edbond@moz-8st.7gv.108.109.IP)
[05:40:35] <mbrubeck> tunnuz: The entire module isn't unstable, just certain types and functions within it.
[05:40:41] <tunnuz> I see
[05:41:07] <mbrubeck> tunnuz: The unstable ones are grayed out slightly in the docs, and say [unstable]: http://doc.rust-lang.org/collections/index.html
[05:41:43] <tunnuz> ok, but can I select which ones to enable, instead of the whole collections module?
[05:42:00] <mbrubeck> No, it's #![feature(collections)] for all of those.
[05:42:14] <tunnuz> ok, so basically if I need vectors
[05:42:16] <mbrubeck> After 1.0 is released, there will be a new 1.x release every six weeks, and anything that's ready to be stabilized will be become available in the next 1.x release.
[05:42:18] <tunnuz> I cannot compile in stable
[05:42:32] <mbrubeck> tunnuz: All common vector methods are stable.
[05:42:32] <tunnuz> is that correct?
[05:42:52] <tunnuz> but cargo complains about #![feature(collections)]
[05:42:59] <tunnuz> not about a specific function in the module
[05:43:10] <mbrubeck> http://doc.rust-lang.org/nightly/std/vec/struct.Vec.html
[05:43:18] <mbrubeck> tunnuz: What's the exact error message?
[05:43:22] <tunnuz> wait
[05:43:44] <tunnuz> oh, I switched to nightly, so I don't get it anymore
[05:43:57] <tunnuz> (and I'm currently fixing some major problems with my UI in ubuntu, so I can probably tell you later)
[05:44:04] <tunnuz> wait
[05:44:05] <bstrie> tunnuz: try removing #![feature(collections)] and compiling on beta, and it will tell you exactly what things aren't stable
[05:44:19] <tunnuz> ok
[05:44:28] <mbrubeck> In fact, you can try removing #![feature(collections)] and then compile on nightly, and it'll tell you most of the same things.
[05:44:40] <mbrubeck> (modulo anything that's become stable since the last beta release, which isn't much.)
[05:44:51] <tunnuz> ok
[05:45:16] <bstrie> tunnuz: in particular, it may be that you're not using unstable features at all and that rust is just asking you to remove the feature flags :P
[05:45:39] <tunnuz> bstrie, yeah, that's possible, because I'm not using really anything fancy
[05:45:45] <tunnuz> also, since beta
[05:45:52] <tunnuz> my #[derive(Debug)]
[05:45:55] <tunnuz> stopped working
[05:46:05] *** Joins: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr)
[05:46:11] <tunnuz> I guess somehow the syntax for that has changed
[05:46:37] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[05:47:01] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[05:47:01] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:47:03] *** Joins: shawnadelic (shawnadelic@moz-u5o3kk.res.rr.com)
[05:47:07] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[05:47:40] *** Quits: nott (nott@moz-to4.06o.57.86.IP) (Ping timeout: 121 seconds)
[05:47:42] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[05:49:15] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:50:22] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[05:51:08] <mbrubeck> or it might be that one of the types within your struct/enum has stopped implementing Debug
[05:51:27] <mbrubeck> (that syntax has not changed)
[05:52:04] <tunnuz> I actually just managed to fix this by enabling #![feature(custom_derive)]
[05:52:16] *** Joins: nott (nott@moz-to4.06o.57.86.IP)
[05:53:00] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[05:54:53] <tunnuz> ok, last question, for now
[05:54:59] *** Joins: twipeD (wipeD@moz-s6k22a.dip0.t-ipconnect.de)
[05:55:01] <tunnuz> can I rely on Zero and One?
[05:55:07] <tunnuz> or are they going to be removed?
[05:55:42] *** Joins: mindtree (Mitch@moz-qh8f9n.iprimus.net.au)
[05:56:43] <mbrubeck> tunnuz: I don't think they'll be removed, but the interface might change, and they might move to a different submodule of libstd.
[05:56:52] <tunnuz> ok
[05:56:57] <tunnuz> thanks
[05:57:02] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (Ping timeout: 121 seconds)
[05:57:06] <tunnuz> because I read somewhere
[05:57:12] <tunnuz> that they might be replaced by FromPrimitive
[05:57:25] <tunnuz> so I implemented everything with that (I basically implemented Zero and One)
[05:57:31] <tunnuz> and then FromPrimitive was removed
[05:57:38] <mbrubeck> Hmm.  I believe One and Zero were removed at one point but then restored, though I might be mis-remembering that.
[05:57:43] <tunnuz> (if I am reading it correctly)
[05:57:46] <tunnuz> ok
[05:57:54] <tunnuz> that's also what I remember
[05:58:10] <mbrubeck> Yeah, they were restored in https://github.com/rust-lang/rust/pull/23549
[05:58:31] <tunnuz> ok, cool
[05:58:39] <tunnuz> I'll finish fixing this UI stuff, and I'll be back
[05:58:39] <mbrubeck> There's an external `num` crate that has 1.0-compatible versions of a lot of the unstable std::num APIs: https://crates.io/crates/num
[05:58:47] <tunnuz> cheers, and thanks for all the info
[05:58:59] <tunnuz> cool
[05:59:11] <tunnuz> ok, catch you later
[05:59:13] <tunnuz> thanks again
[05:59:16] *** Quits: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au) (Quit: Leaving)
[05:59:25] *** Quits: xrl (uid1091@moz-f0543s.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[05:59:26] *** Quits: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[06:00:15] *** Quits: edbond (edbond@moz-8st.7gv.108.109.IP) (Ping timeout: 121 seconds)
[06:00:28] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[06:00:40] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[06:03:00] *** Joins: streblo (streblo@moz-s8cslq.ca.comcast.net)
[06:03:06] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Connection closed)
[06:06:24] *** Quits: stjahns (stjahns@moz-5vg.coe.91.209.IP) (Connection closed)
[06:06:51] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[06:11:38] *** Quits: fengshaun (fengshaun@moz-rf0qk5.cable.teksavvy.com) (Ping timeout: 121 seconds)
[06:12:37] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:14:27] *** Quits: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[06:15:17] *** Joins: GBGamer (npm@moz-92sbjt.wa.comcast.net)
[06:16:30] *** Joins: jviereck (Adium@moz-lebeg6.uzh.ch)
[06:17:00] *** Joins: jviereck1 (Adium@moz-lebeg6.uzh.ch)
[06:17:00] *** Quits: jviereck (Adium@moz-lebeg6.uzh.ch) (Connection reset by peer)
[06:17:29] *** Quits: jviereck1 (Adium@moz-lebeg6.uzh.ch) (Quit: Leaving.)
[06:17:34] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[06:18:31] *** Joins: SneakySnake (nya@moz-i9is4u.pool.telekom.hu)
[06:18:37] *** Joins: Guest (textual@moz-rtn.fg7.77.192.IP)
[06:19:40] *** Quits: GBGamer (npm@moz-92sbjt.wa.comcast.net) (Quit: leaving)
[06:20:07] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[06:21:25] *** Joins: mib_3w89mt (Mibbit@moz-e9vbo0.telecom.by)
[06:21:29] *** Quits: mib_3w89mt (Mibbit@moz-e9vbo0.telecom.by) (Quit: http://www.mibbit.com ajax IRC Client)
[06:21:36] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[06:22:00] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:22:16] *** Joins: KLP (KLP@moz-qdcjho.res.rr.com)
[06:23:21] *** Quits: Guest (textual@moz-rtn.fg7.77.192.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:24:59] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[06:25:00] <aatch> Stupid floating point numbers ruining my algebraic properties.
[06:25:11] *** Joins: Feyn (Feyn@moz-qqa.rg0.115.42.IP)
[06:26:06] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[06:26:46] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[06:28:45] *** Joins: Douman (Douman@moz-30pipa.dynamic.mts-nn.ru)
[06:29:34] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[06:29:35] *** Quits: Twinklebear (Twinklebear@moz-ttrcn3.ut.comcast.net) (Quit: Leaving)
[06:29:56] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[06:29:56] *** ChanServ sets mode: +o erickt
[06:30:08] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[06:30:44] *** Quits: Porkepix (Porkepix@moz-e1bv2v.rev.sfr.net) (Connection closed)
[06:30:56] *** Joins: raph (Adium@moz-o75.fg7.77.192.IP)
[06:30:59] *** Joins: loyd (loyd@moz-uft.32f.108.213.IP)
[06:31:05] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Connection closed)
[06:32:05] *** Quits: raph1 (Adium@moz-erv.4ra.239.216.IP) (Ping timeout: 121 seconds)
[06:33:58] <JoshTriplett> I'm still having a lot of trouble understanding borrow problems involving objects. See http://is.gd/oyeRSP .  This gives me a borrow error saying that the call self.oid_to_inode cannot borrow *self as mutable because the previous line self.inode_to_object(inode) has it borrowed as immutable.
[06:34:07] <JoshTriplett> Why would that line borrow *self*?
[06:34:17] <JoshTriplett> (or, more to the point, not give it back when done)?
[06:34:19] *** Quits: Kingsquee (kingsley@moz-qq7ns6.bchsia.telus.net) (A TLS packet with unexpected length was received.)
[06:34:26] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:36:27] *** Joins: Porkepix (Porkepix@moz-e1bv2v.rev.sfr.net)
[06:38:00] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[06:38:03] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[06:38:28] *** streblo is now known as streblo|away
[06:41:30] <reem> JoshTriplett: I’m taking a look
[06:41:44] <JoshTriplett> reem: Thanks!
[06:41:55] <reem> Can you paste the error too since this code doesn’t get there on its own?
[06:42:02] <JoshTriplett> Sure.
[06:42:04] *** Quits: ytain_ (ytain@moz-ge9fgi.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[06:42:12] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[06:42:19] *** Quits: slashus2 (slashus2___@moz-evfg9e.res.rr.com) (Quit: Leaving)
[06:42:49] <JoshTriplett> http://is.gd/8cd7Bl
[06:42:54] <reem> JoshTriplett: Just based on the description and reading, it’s likely that the inode_to_object method returns a borrow
[06:43:17] <reem> I’d need to see the signature to say more
[06:43:25] <JoshTriplett> reem: That's in the paste.
[06:43:30] <JoshTriplett> reem: It returns git2::Object.
[06:43:34] <JoshTriplett> *not* & or &mut.
[06:43:41] <reem> does git2::Object have a lifetime?
[06:43:45] *** Quits: adukhno (chatzilla@moz-dl7.865.91.80.IP) (Connection closed)
[06:44:08] <JoshTriplett> It should have a lifetime of <'repo>, as in "lives as long as the git2::Repository it came from".
[06:44:21] <reem> ah, ok so there is an elided lifetime there
[06:44:36] <JoshTriplett> Is Rust perhaps eliding it incorrectly, and I need to specify it explicitly?
[06:44:49] <JoshTriplett> Or is it going to correctly infer <'repo>?
[06:44:59] <reem> JoshTriplett: No, it’s correct, since find_object borrows the repo, your wrapper method borrows self
[06:45:07] <JoshTriplett> That's wrong.
[06:45:14] <JoshTriplett> It should borrow self.repo, *not* self.
[06:45:18] <JoshTriplett> How do I convince it of that?
[06:45:27] <reem> JoshTriplett: borrows are based on function signatures
[06:45:43] <reem> JoshTriplett: rustc’s not going to introspect function bodies, since that’s not supposed to be part of the public interface
[06:45:58] <JoshTriplett> OK.  So how do I explicitly tell Rust what to borrow?
[06:46:21] <JoshTriplett> Because it borrowing self is exactly where my problem comes from.
[06:46:22] <reem> you have a little bit of a complicated case here
[06:46:39] <JoshTriplett> Yeah, git2's borrow semantics are fairly detailed, matching that of the underlying library.
[06:46:58] *** Joins: hoony (Thunderbird@moz-g1v.beb.105.183.IP)
[06:47:08] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[06:47:15] <reem> small pedagogical moment here: the full signature of that method is fn inode_to_object<‘a>(&’a self, inode: u64) -> git2::Object<‘a>
[06:47:31] <JoshTriplett> OK, that makes sense.
[06:47:37] <reem> so that acts as if git2::Object contains an &’a self reference, which extends the borrow
[06:47:40] <JoshTriplett> Though it's not the correct signature. :)
[06:47:48] <reem> It is though
[06:47:56] <JoshTriplett> Where do I get a 'repo from to put in git2::Object?
[06:48:03] <reem> ‘repo is just a name
[06:48:06] <reem> it doesn’t mean anything
[06:48:11] <reem> ‘a == ‘repo or whatever
[06:48:29] <JoshTriplett> That much I understood; I mean, how do I declare a name for the lifetime of self.repo?
[06:48:47] <reem> JoshTriplett: So one thing you can do here is to do a small transformation, if you want to return a borrow with a  different lifetime than the self borrow, your self has to itself contain a borrow
[06:48:53] <reem> this is sort of hard to explain directly
[06:49:05] <reem> but basically instead of embedding a git2::Repository directly, you’d embed a reference to one
[06:49:06] <JoshTriplett> I don't think I even parsed that to begin with. :)
[06:49:21] <reem> and then you would return a git2::Object with *that* lifetime, which then allows you to not borrow the entirety of self
[06:49:30] <reem> let me write a simplified example
[06:49:46] <JoshTriplett> So, you're saying TestFS would have a &mut git2::Repository?
[06:49:55] *** Joins: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com)
[06:50:36] *** Joins: lfairy (lfairy@moz-107acv.ihug.co.nz)
[06:50:46] <reem> yes
[06:50:49] <reem> well
[06:50:54] <reem> you’d have TestFS gain a lifetime param
[06:50:58] <reem> which you could call ‘repo if you like
[06:51:10] <reem> then you’d store an &’repo mut git2::Repository
[06:51:18] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[06:51:20] <blaenk> you working with git2 too?
[06:51:22] <JoshTriplett> Could I instead store a git2::Repository<'repo> ?
[06:51:24] <reem> and then you could give out ‘repo-length git2::Objects
[06:51:48] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Connection closed)
[06:51:55] <reem> JoshTriplett: Nah, you can’t just add lifetime params like that.
[06:52:13] <reem> lifetimes are very closely tied to borrows/&/&mut
[06:52:16] <JoshTriplett> If it helps, inode_to_object is an internal implementation detail of TestFS; it's designed to be called by other TestFS methods, not publically.
[06:52:32] <reem> doesn’t make a difference unless you want to go unsafe
[06:52:36] <reem> (you shouldn’t)
[06:52:38] <JoshTriplett> definitely not.
[06:53:07] <JoshTriplett> Only asking because it's occuring to me that if I inlined inode_to_object the problem would go away, which makes me sad.
[06:53:23] <reem> JoshTriplett: Yes, this is sort of a tricky/unfortunate case.
[06:53:33] *** Joins: Kingsquee (kingsley@moz-qq7ns6.bchsia.telus.net)
[06:54:00] <reem> (by the way I realize I was ambiguous earlier, you would return git2::Object<‘repo>
[06:54:02] <reem> )
[06:54:12] <JoshTriplett> Yeah, I understood that.
[06:54:29] <reem> cool
[06:54:38] <JoshTriplett> That still seems rather awful.  Is there a better way to do this than giving TestFS a lifetime?
[06:55:27] <JoshTriplett> Because I don't want to tie things to the lifetime of TestFS; I want to tie them to the lifetime of the repo.
[06:55:41] <reem> JoshTriplett: Right, but you *own* the repo, it has no lifetime.
[06:55:58] <reem> I agree that this is sort of a suboptimal case, and I’m trying to think of what could be better
[06:56:25] <reem> Basically it all comes down to segregating your borrows and ownership
[06:56:35] <JoshTriplett> I'm hoping there's something better than adding a pile of explicit lifetimes just so that I could write a one-line helper function.
[06:56:57] <JoshTriplett> Given that, as noted, inlining the contents of the helper function would make this problem go away.
[06:57:00] <reem> Well, one thing you can do is have a function which “splits” your type into multiple &s or &muts
[06:57:01] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[06:57:18] <reem> (to different fields)
[06:57:23] <JoshTriplett> Sure, I could make a function like inode_to_object that takes the individual fields I need instead of the object.
[06:57:44] <reem> (by function I mean method)
[06:57:56] <JoshTriplett> But I'm rapidly discovering that Rust seems to always want to borrow self when I touch self.anything, which is going to be a serious sticking point in using structs.
[06:58:23] <reem> basically you have struct A { b: B, c: C } and you want to pass &mut B and &mut C together to some other function, you can have a method on A that is (&mut self) -> (&mut B, &mut C)
[06:58:27] <JoshTriplett> And if I have to keep fixing that by manually giving names to fields and splitting out fields, that's really awkward.
[06:58:54] <reem> JoshTriplett: You effectively have to come at the problem from a little bit of a different design perspective
[06:58:55] <JoshTriplett> reem: Except that I already have really convenient names for B and C, namely "self.b" and "self.c".
[06:59:21] *** Joins: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net)
[06:59:38] <reem> and be really thoughtful ahead of time about what things you put together in one type, noting that if you have b and c owned by one instance of a it’s a slight nuisance to segregate them
[06:59:45] <aatch> Well for direct field access, we allow for borrows that don't overlap on the same field.
[06:59:46] <reem> it comes more naturally when you write more rust
[07:00:00] <JoshTriplett> reem: That's not comforting.
[07:00:20] *** Joins: det- (chris@moz-2oameq.lv.cox.net)
[07:00:44] <JoshTriplett> reem: Unlike other properties of rust, this one doesn't feel like "the borrow checker is helping me write correct code"; it feels like "the borrow checker is failing to notice the blindingly obvious correctness of this code".
[07:01:00] *** Quits: nott (nott@moz-to4.06o.57.86.IP) (Quit: Leaving)
[07:01:08] <JoshTriplett> And learning how to placate the borrow checker is not as good as fixing the borrow checker. :)
[07:01:11] <aatch> JoshTriplett, chances are it's not blindingly obvious. Given that Rust only works on a single function at a time.
[07:01:40] <reem> aatch: Yup, that’s basically the problem they’re hitting, if they inline their method everything is fine, but rustc is overzealous with borrowing when split into another fn
[07:01:52] <JoshTriplett> aatch: That "don't overlap" is exactly the thing I'm running into.
[07:02:14] <reem> JoshTriplett: The simplest thing to do in this case is actually to add the convenience method to self.repo directly
[07:02:18] <JoshTriplett> It came up when using a closure with self, and now it has come up again with a method that takes &self.
[07:02:20] <aatch> Sure, but that's expected. We don't know what `self.foo()` is going to touch, so we have to be conservative about it.
[07:02:59] <JoshTriplett> aatch: You know exactly what foo() is going to touch; you have the implementation. :)
[07:03:01] *** Joins: nott (nott@moz-to4.06o.57.86.IP)
[07:03:11] <aatch> JoshTriplett, not necessarily.
[07:03:13] *** Quits: det (chris@moz-qij3pi.lv.cox.net) (Ping timeout: 121 seconds)
[07:03:16] <reem> JoshTriplett: Ya, but then the body of your function becomes part of your public API.
[07:03:21] <aatch> JoshTriplett, what if it's in another crate?
[07:03:23] <reem> Which is extremely undesirable
[07:03:27] <scott> borrow checking at call-sites of foo() won't look inside of it to figure things out
[07:03:43] <JoshTriplett> reem: Not actually possible, both because repo is a git2::Repository and because the helper needs self.inode_oid too.
[07:03:46] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[07:03:49] <scott> borrow checking, type checking, and type inference are all function-local things
[07:03:54] <JoshTriplett> The difference is that this pointedly isn't a public method.
[07:04:11] <aatch> And as reem said, any potential solution makes your "implementation details" part of the public API.
[07:04:12] <JoshTriplett> (Or shouldn't be, anyway.)
[07:04:20] <reem> JoshTriplett: Make it a free function which takes the repo and inode_oid references directly
[07:04:36] <reem> then everything should be fine
[07:04:36] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[07:04:41] <reem> especially if this is just a private implementation detail
[07:05:03] <JoshTriplett> reem: For a value of "fine" equal to "now every call site has to pass two fields as parameters manually rather than passing the object that has both".
[07:05:44] *** Joins: det-- (chris@moz-9klsea.lv.cox.net)
[07:05:55] <reem> JoshTriplett: It really is not noise though - it’s important information to the borrow checker and (in the public case) consumers of your API to be able to reason completely about borrows by only looking at signatures.
[07:06:14] *** Joins: areski (areski@moz-prr0dt.user.ono.com)
[07:06:26] <JoshTriplett> At the moment, I'm slowly becoming tempted to write this as a macro that takes "self", because *that* would actually work just fine.
[07:06:27] <reem> it is also more refactor proof
[07:06:56] <reem> since changes to the internals of other methods won’t cause errors if you don’t change the signature
[07:07:11] <reem> ^ an important property for not driving other people working on your codebase entirely insane
[07:07:21] *** Joins: zcourts (zcourts@moz-7ms809.cable.virginm.net)
[07:07:22] *** Quits: Porkepix (Porkepix@moz-e1bv2v.rev.sfr.net) (Quit: My laptop has gone to sleep. ZZZzzz…)
[07:07:36] <reem> (or yourself, in six months)
[07:07:41] *** Quits: hjr3 (hradtke@moz-e235ok.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[07:07:43] *** Quits: det- (chris@moz-2oameq.lv.cox.net) (Ping timeout: 121 seconds)
[07:07:47] <aatch> There are a few shortcomings in the region system/borrow checker, local reasoning is not one of them.
[07:07:49] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[07:07:57] *** Quits: det-- (chris@moz-9klsea.lv.cox.net) (Quit: Leaving)
[07:08:00] *** Joins: det (chris@moz-9klsea.lv.cox.net)
[07:08:16] <JoshTriplett> So, given that I want to continue being able to keep all these bits together in one object rather than passing them separately, do you see any better solution than either adding a pile of explicit lifetime parameters or duplicating this line in a pile of functions?
[07:08:27] <reem> JoshTriplett: use a free function
[07:08:28] *** Joins: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi)
[07:08:48] <JoshTriplett> reem: "given that I want to continue being able to keep all these bits together in one object rather than passing them separately".
[07:08:48] *** Joins: QuadTan (Tan@moz-r5oa06.student.uu.se)
[07:09:01] <JoshTriplett> reem: I can write a free function that takes a TestFS, which won't help.
[07:09:04] *** Joins: DerisiveLogic (smuxi@moz-g93io6.res.rr.com)
[07:09:05] <reem> “given that I won’t fix it, how can I fix it” :P
[07:09:16] <JoshTriplett> reem: "given that I won't make my code worse to placate the borrow checker"
[07:09:32] <reem> This is just the tradeoff of local reasoning
[07:09:45] <reem> the alternative is far far worse, even if it lets you write cleaner code in the very short term
[07:10:04] <JoshTriplett> I'm fine with having to add some explicit annotations *at the definition of inode_to_object*.
[07:10:14] <JoshTriplett> To explicitly say "these are the lifetimes you need to care about".
[07:10:25] <JoshTriplett> I'm not fine with having to add those lifetimes to every caller.
[07:10:40] <reem> (it would not be ridiculous to use a macro for this, fwiw)
[07:11:01] <JoshTriplett> reem: Seems fairly ridiculous to me...
[07:11:09] <JoshTriplett> I'm not arguing against local reasoning here; I do understand why that's a useful property.
[07:11:13] <reem> JoshTriplett: There isn’t the solution you are looking for
[07:11:27] *** Quits: mdinger (Mibbit@moz-mvlcev.gnvlsc.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:11:28] <JoshTriplett> Along similar lines, I'm also not arguing that the compiler needs to magically divine what I'm trying to do.
[07:11:40] <JoshTriplett> I'm trying to find a way to *tell* the compiler what I'm trying to do and have it listen.
[07:11:46] <reem> Maybe it would be desirable to have annotations, e.g. &self{x,y} or something
[07:11:48] *** Quits: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu) (Quit: Leaving)
[07:12:13] <reem> but that’s a pretty complex feature
[07:12:28] <scott> what is the essential issue here? calling a function on &foo and having it only borrow pieces of foo, rather than the whole thing?
[07:12:35] <reem> yes
[07:12:49] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[07:12:49] <JoshTriplett> scott: Right.  Specifically because I then need to call another function on &foo that borrows other pieces.
[07:13:10] <scott> well, reem is correct that you can't do that today
[07:13:27] *** Quits: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net) (Connection closed)
[07:13:33] <scott> there is no such annotation
[07:13:47] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[07:13:55] <aatch> One possible option is to use Cell/RefCell
[07:14:08] <JoshTriplett> If the answer is "can't do that yet", that's understandable; I'd like to figure out what the solution *should* look like to be able to write up an RFC. :)
[07:14:09] <reem> JoshTriplett: I can give you a small anecdote; I recently actually hit a very similar case to this in a library I was writing, and I had to refactor the entire architecture to avoid it, but it was actually way better afterwards, and the ownership/borrowing was much clearer. Obviously this may not apply to your case, but such is the nature of anecdotes.
[07:14:39] <scott> I'm wondering if there's even a solution that wouldn't be worse than the workarounds reem has already suggested
[07:14:48] <JoshTriplett> reem: I'm skeptical, but I'd be interested to know if you see any obvious refactoring of TestFS that wouldn't make the code worse.
[07:14:55] <scott> adding more complex annotations would make your function signature even harder to understand
[07:15:05] <scott> but it might be doable
[07:15:10] *** Joins: ashish01 (textual@moz-ugfqao.wa.comcast.net)
[07:15:33] <JoshTriplett> scott: There's another part to the problem statement that seems important:
[07:15:38] *** Joins: arBmind (Andreas@moz-l25oke.adsl.alicedsl.de)
[07:15:45] <ashish01> Is there a xml library in rust for processing very large XML files in a streaming fashion
[07:16:03] <JoshTriplett> scott: Because of local reasoning, there are cases where attempting to take duplicated code from several functions and factor it out into a common helper will cause compilation to fail.
[07:16:09] <reem> JoshTriplett: I’d have to see the rest of your code, but I can see major advantages to having repo borrowed separately (with its own reference/lifetime) from everything else, since it would allow you to transitively deal with Objects using a different lifetime than the whole TestFS. I’ve written enough rust that lifetimes don’t phase me, and they can
[07:16:09] <reem> actually be really useful.
[07:16:24] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[07:16:27] *** Quits: DerisiveLogic (smuxi@moz-g93io6.res.rr.com) (A TLS packet with unexpected length was received.)
[07:16:34] *** Joins: DerisiveLogic (smuxi@moz-g93io6.res.rr.com)
[07:16:46] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[07:16:47] <JoshTriplett> scott: Making it *harder* to factor out helper functions seems rather awful. Hence trying to seek a solution that doesn't break that.
[07:17:18] *** Quits: niconii (nicole@moz-dt9bve.frgo.qwest.net) (Quit: leaving)
[07:17:22] <scott> JoshTriplett: yeah, it's an unfortunate consequence. macros can serve some of those cases
[07:17:25] <JoshTriplett> reem: There really isn't a "rest of" this code; it's a simple test program that's pretty much what you see here.
[07:17:26] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Connection closed)
[07:17:30] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[07:17:36] <JoshTriplett> reem: Apart from calling fuse::mount on TestFS.
[07:17:55] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[07:17:56] <JoshTriplett> (and a pile of extern/use declarations at the top)
[07:18:14] <scott> macro_rules! foo { ($e:expr) => (my_func(&$e.bar, &$e.baz)) }  foo!(self) // my_func(&self.bar, &self.baz)
[07:18:14] <aatch> JoshTriplett, the inability to do function/method extraction is a known shortcoming for Rust. That said, it's surprising how infrequently I actually notice it.
[07:18:21] <JoshTriplett> reem: When you say "borrowed separately", what do you mean?
[07:18:41] <reem> JoshTriplett: embed a &’a git2::Repository or &’a mut git2::Repository, like we discussed earlier
[07:19:04] <JoshTriplett> reem: I'm going to go ahead and try that, and see how ugly it gets.
[07:19:09] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[07:19:19] *** Quits: Guest5 (textual@moz-hnb58r.oc.cox.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:19:28] <reem> JoshTriplett: It helps to stop thinking of lifetime parameters as ugly, and more as just other tools in your arsenal.
[07:20:01] <JoshTriplett> reem: I'm not saying they're ugly in general; they seem like a powerful and useful feature.  I'm saying it seems ugly to have to add lifetime parameters in a dozen places just to add one helper function.
[07:20:44] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Quit: AHHHHH BEES)
[07:20:48] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[07:20:58] <aatch> JoshTriplett, out of curiosity, what's your main programming background?
[07:21:05] <Sgeo> If I need something to live longer than expected (say, a *mut to a closure, and I'm passing it to C which can call it anytime later), how do I do that? Use mem::forget on it?
[07:21:13] <reem> JoshTriplett: Of course, and in this small program it might not be worth it vs. free function or macro, but I think that pulling out the repo actually may have general architectural benefits, such that if this was actually a complex struct with many methods and features it would be easier to use and write if it was borrowed separately.
[07:21:19] <JoshTriplett> aatch: C, Python, Haskell, many others.
[07:21:57] <scott> Sgeo: so you want to pass ownership to the C code, essentially?
[07:22:03] *** Quits: ashish01 (textual@moz-ugfqao.wa.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:22:05] <JoshTriplett> aatch: I'm quite familiar with "fight the type checker until the program compiles, then your code is correct" from Haskell, and over time you learn to write code that doesn't require as much fighting to begin with. :)
[07:22:24] <reem> That’s pretty much the rust story too
[07:22:29] <Sgeo> scott, yes
[07:22:48] <JoshTriplett> aatch: But from that same Haskell background, I'm also inclined to fix the compiler or use some nice compiler extension whenever there's something that the type system can't easily express.
[07:22:49] <scott> Sgeo: one method is to Box whatever you're passing to C, then use .into_raw() to hand off to C, and provide a freeing function that takes the pointer back from C, uses Box::from_raw and then lets the Box drop
[07:23:17] *** Joins: viel (victorlima@moz-2k31nn.retail.telecomitalia.it)
[07:23:17] *** Joins: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au)
[07:23:23] <scott> Sgeo: it's up to the C programming to make sure they call your free function to not leak, but that's just business as usual in C land
[07:23:28] <scott> programmer*
[07:23:43] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[07:24:08] <aatch> JoshTriplett, reem, I've found that most people that have been using Rust for a while essentially do the borrow-checking themselves as they go.
[07:24:17] <scott> oh, from_raw is unstable. clearly I haven't actually done much of this kind of work
[07:24:43] *** Quits: Gertm (Gertm@moz-kqq.57r.66.185.IP) (Quit: ZNC - 1.6.0 - http://znc.in)
[07:24:47] <aatch> For me, this has meant I'm often overly-pessimistic about what I can do in Rust because I got used to a much dumber borrow checker.
[07:25:02] <scott> maybe you can get the same effect with transmute
[07:25:13] *** Joins: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net)
[07:25:21] <scott> you'll probably want to do something equivalent to what I described, anyway
[07:25:21] <JoshTriplett> aatch: That I can readily believe.  But given what I've just seen, I'm also wondering if people that have been using Rust for a while get used to not attempting to factor out helpers because they don't want the pain of fighting the borrow checker to let them write them.
[07:25:31] *** Joins: eerie_ (eerie@moz-joilui.red.bezeqint.net)
[07:25:35] <JoshTriplett> aatch: Resulting in more duplication of short snippets of code.
[07:25:47] *** Joins: zettablade (Mibbit@moz-58u.jiv.125.50.IP)
[07:25:57] <JoshTriplett> aatch: (Also from Haskell, I start itching to factor out a helper when I see even the slightest hint of a repeated pattern.)
[07:26:06] <Sgeo> scott, oh, transmuting and passing to C would prevent local from dropping? I feel derpy
[07:26:41] <aatch> JoshTriplett, eh, not really. You find that repeated stuff like that is handled with abstractions, rather than helpers.
[07:26:41] <scott> Sgeo: I believe if you transmute a Box<T> to *mut T it won't be dropped
[07:27:01] <JoshTriplett> aatch: Define "abstractions" here?
[07:27:04] *** Quits: areski (areski@moz-prr0dt.user.ono.com) (Ping timeout: 121 seconds)
[07:27:08] <Mutabah> scott: Iirc, transmute consumes the argument, so yes
[07:27:23] <reem> JoshTriplett: If I was writing this code, I might very well have started with the repo being a separate borrow, since I would know ahead of time that I want to handle git2::Objects that borrow on a different lifetime then self.
[07:27:43] *** Joins: tetsuharu (tetsuharu@moz-fmjbd6.ucom.ne.jp)
[07:27:51] <JoshTriplett> reem: I'm writing the code that way now, and encountering even more arcane borrow checker errors.  Paste momentarily...
[07:28:05] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Ping timeout: 121 seconds)
[07:28:05] *** Quits: tetsuharu (tetsuharu@moz-fmjbd6.ucom.ne.jp) (Quit: )
[07:28:13] <aatch> I bet they'll be because of lifetime elision.
[07:28:28] <reem> JoshTriplett: That version of the code is definitely more difficult to write, but at a certain point appeasing the borrow checker stops being the roadblock and it doesn’t matter.
[07:28:59] *** Joins: mbudde (mbudde@moz-vmd8oc.customer.tdc.net)
[07:29:15] <reem> aatch: You don’t like lifetime elision, right?
[07:29:36] <aatch> JoshTriplett, I guess I mean that in Rust you tend to see functionality packaged up into a separate type + methods.
[07:29:49] *** Quits: playjax (chatzilla@moz-kv3nv0.optusnet.com.au) (Ping timeout: 121 seconds)
[07:29:50] <aatch> reem, nope, it's caused me nothing but problems.
[07:29:54] *** Quits: reed (reed@tech.monkey) (RecvQ exceeded)
[07:30:10] *** Joins: reed (reed@tech.monkey)
[07:30:11] <JoshTriplett> aatch: Well, yeah.  But that doesn't help when trying to write that type and methods.
[07:30:23] <Mutabah> Can someone make sure that my logic here is correct? https://github.com/thepowersgang/rust_os/blob/master/Kernel/Core/async/mod.rs#L56-L60
[07:30:49] <reem> aatch: I am definitely sympathetic to that, I don’t usually hit problems due to it but that’s just because I do the desugaring in my head as I go. It helps you get less annoying HN comments about how “ugly” <‘a> is, but confuses the hell out of people when they don’t know what the desugaring is and they tackle complex lifetime stuff.
[07:31:38] <Sgeo> Mutabah, invalid
[07:31:43] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[07:31:44] <Sgeo> You're transmuting a & into &mut
[07:31:57] <JoshTriplett> reem: http://pastebin.com/7mgnA8zi (switched to pastebin because play.rust-lang doesn't allow more than 5k characters)
[07:32:06] <scott> I found this an interesting illustration of borrow checking locality: fn f<'a, T>(x: &'a T, y: &'a T) -> &'a T { x }. without using a separate lifetime for y, this means let c = f(&a, &b) will keep b borrowed until c goes out of scope, even though it would be safe to make b unborrowed
[07:32:11] *** Joins: mik (Mibbit@moz-h4jtc7.dsl-dynamic.vsi.ru)
[07:32:11] <snow> Does the author of nom hang in here?
[07:32:36] <JoshTriplett> reem, aatch: Personally, I really like lifetime elision, since it seems to DTRT *almost* all the time for really common cases.
[07:32:37] <scott> I guess there's room for a lint there - "function never actually borrows argument `y`"
[07:32:48] <scott> with a hint to use a different lifetime for y
[07:33:04] <reem> JoshTriplett: One common thing is to have a struct with, let’s say three fields, and two of those fields interact in a method that would then have to borrow the entire self, and then you want to use the third one on the result of that or something. So you factor out those two fields into their own type, define methods on that, then embed that type in the
[07:33:04] <reem> original type. I am fairly sure this is what aatch means, at least in part, by abstraction.
[07:33:06] <JoshTriplett> scott: Well, in that case, the hint should be "you don't use y at all".
[07:33:17] <scott> JoshTriplett: sure, but imagine a more complicated example that does
[07:34:11] <reem> JoshTriplett: Ya, it helps a lot with simple and common cases, but then when people first hit explicit lifetimes they just have no idea what’s going on.
[07:34:15] <JoshTriplett> reem: I can certainly see that, but in this case, inode_to_object needs two fields, while oid_to_inode needs a different two (one of which is the same).
[07:34:21] <aatch> Eh, I'm not a fan of lifetime elision, but it's here and I don't care enough to do more than moan whenever it stings me.
[07:34:34] <reem> JoshTriplett: Yup, that’s why I didn’t suggest that here ;)
[07:34:39] *** Joins: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net)
[07:35:00] <Sgeo> I wonder if this stuff about large structs is going to negatively impact usability of my (not yet existent) HList library
[07:35:44] <JoshTriplett> reem: Any idea what's going on with that borrow checker error in the lifetime-enabled code?
[07:35:47] <reem> Sgeo: Nah, people can just stick parts behind Box if they need to.
[07:36:00] *** Quits: james4k (james@moz-0kqjsm.consolidated.net) (Ping timeout: 121 seconds)
[07:36:04] <reem> JoshTriplett: I need to see the signature of find_object to say more
[07:36:28] <Sgeo> I.. have such little knowledge of the issue that I don't understand how Box helps
[07:36:38] <JoshTriplett> reem: http://alexcrichton.com/git2-rs/git2/struct.Repository.html#method.find_object
[07:36:45] <JoshTriplett> fn find_object(&self, oid: Oid, kind: Option<ObjectType>) -> Result<Object, Error>
[07:36:50] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[07:36:56] <reem> Sgeo: I am assuming you mean that large structs incur expensive moves due to a large memcpy?
[07:37:15] <JoshTriplett> Which I assume means:
[07:37:19] *** Joins: alonlevy (alon@moz-p48.q13.159.94.IP)
[07:37:33] <Sgeo> reem, I meant in terms of non-overlapping parts not being allowed to have overlapping lifetimes
[07:37:34] <JoshTriplett> fn find_object(&'a self, oid: Oid, kind: Option<ObjectType>) -> Result<Object<'a>, Error>
[07:37:52] <reem> yes
[07:37:59] <reem> Sgeo: I don’t think it will be a problem
[07:38:14] <JoshTriplett> reem: So yes, find_object makes the Object have the same lifetime as the Repository.
[07:38:38] <scott> I'm not a fan of lifetime elision when it hides T<'a> parameters as just T
[07:38:56] <huon> Mutabah: it would be possible to implement that trait in a way that makes `get_waiter` return an aliased &PrimitiveWaiter
[07:38:57] <reem> JoshTriplett: so number one, L23 is not going to work
[07:39:14] <JoshTriplett> I wondered about that.
[07:39:21] <reem> JoshTriplett: You’re trying to hold a reference to stack data out of that stack frame
[07:39:25] <Mutabah> huon: Ah, yes, if it has an rc internally
[07:39:33] <huon> Mutabah: e.g. struct Foo<'a> { x: &'a PrimitiveWaiter }
[07:39:36] <huon> Mutabah: oh, yeah, that too
[07:39:44] <JoshTriplett> reem: Which is part of why I was concerned when you suggested that TestFS wouldn't own the repository, but just borrow it.
[07:39:53] <JoshTriplett> Because it really *should* own the repository.
[07:39:55] <reem> right, that’s the disadvantage
[07:39:58] <reem> hmm
[07:40:04] <Mutabah> huon: Bother
[07:40:14] <reem> so best thing, it looks like, would really be the free function solution
[07:40:27] <reem> I appreciate that this means you have to pass the fields manually, but it is really the best thing to do here imo
[07:40:51] <JoshTriplett> reem: Consider the case where inode_to_object, rather than referencing two fields, references twelve.  No, that's clearly not the right solution. :)
[07:41:02] <reem> JoshTriplett: In that case you have other problems.
[07:41:05] *** Quits: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:41:08] <reem> :P
[07:41:15] <Mutabah> huon: Any ideas on removing the requirement for two near-identical implementations?
[07:41:28] <JoshTriplett> The caller should not need to manually pass inode_to_object the fields it needs; that's part of what I'm trying to factor out.
[07:41:31] <reem> JoshTriplett: You can pursue the separate-borrow idea, but it means refactoring the interface rather significantly.
[07:41:41] *** Joins: frankmcsherry (frankmcsher@moz-i1cmk3.airspot.airfy.com)
[07:41:43] <scott> Mutabah: higher-kinded types might help there
[07:41:47] <reem> since you now have to receive a borrow vs. owning the repo
[07:42:04] <JoshTriplett> reem: Let's look at it a slightly different way: suppose I changed how I'm bidirectionally mapping between Oid and u64 here?
[07:42:06] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[07:42:18] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Connection closed)
[07:42:29] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:42:30] <JoshTriplett> reem: Then with the helper as I have it here (modulo the inability to convince the borrow checker), that detail is entirely hidden within inode_to_object.
[07:42:39] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[07:42:41] <JoshTriplett> reem: While if I use a free function, every caller has to change.
[07:43:00] *** Quits: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net) (Connection closed)
[07:43:04] <reem> Well, if you use a method with field annotations, every caller could also have to change due to new borrowck errors
[07:43:25] <reem> the free function is just making explicit what you want with field borrow annotations
[07:43:27] <JoshTriplett> reem: Only the callers that aren't compatible with those field annotatoins :)
[07:43:30] <JoshTriplett> *annotations
[07:43:40] <JoshTriplett> reem: And the compiler can tell me that.
[07:43:49] <reem> JoshTriplett: Right, but imo that’s actually worse since it’s much harder to know beforehand what will break.
[07:43:59] <JoshTriplett> I don't need to know beforehand; that's what the compiler is for. :)
[07:44:10] <reem> JoshTriplett: but public APIs
[07:44:20] <JoshTriplett> but internal function. :P
[07:44:29] <reem> JoshTriplett: I understand this is private, but rust is designed to scale to gigantic codebases and large libraries
[07:44:30] <JoshTriplett> where can I stick a "private:" :)
[07:44:32] <Mutabah> huon: I guess I can just go back to only having the &mut version
[07:44:49] <reem> JoshTriplett: I see your point, and recognize the tradeoff, I’m just happy on this side of it :)
[07:45:26] <JoshTriplett> reem: Side question: is the only way to create private fields and functions in a struct to stuff the struct in a module and not mark those items "pub"?
[07:45:28] <aatch> JoshTriplett, looking at the code, I'm guessing that the problem is in the readdir code?
[07:45:44] <reem> JoshTriplett: anything not marked pub is private
[07:45:44] <aatch> JoshTriplett, fields are private by default.
[07:46:04] <reem> except trait implementations and trait methods in trait declarations
[07:46:11] <reem> those don’t need pub but are public (if the trait is)
[07:46:37] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[07:46:41] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[07:46:42] <JoshTriplett> aatch: Yeah.  With the <'repo> annotations dropped, the problem occurred because self.inode_to_object(inode) borrowed all of self, and then later in the same function I need to call self.oid_to_inode which also wants to borrow self.
[07:46:49] <reem> so I would be happy to keep having this conversation, but it’s almost 4 here, so I’m gonna go to bed
[07:46:59] <JoshTriplett> reem: I do appreciate you taking the time to talk through this.
[07:47:05] <JoshTriplett> reem: I at least understand the problem better now.
[07:47:13] <reem> Good to hear :)
[07:47:23] *** Quits: mik (Mibbit@moz-h4jtc7.dsl-dynamic.vsi.ru) (Quit: http://www.mibbit.com ajax IRC Client)
[07:47:55] <JoshTriplett> aatch: The previous version (and errors) is at http://is.gd/8cd7Bl
[07:47:57] <aatch> JoshTriplett, would you say that `oid_to_inode` is *logically* immutuble?
[07:48:07] *** Quits: arBmind (Andreas@moz-l25oke.adsl.alicedsl.de) (Quit: Leaving.)
[07:48:27] <JoshTriplett> aatch: ...sort of?  It's returning a u64, and only needs to mutate if it doesn't yet have a mapping.
[07:48:34] <aatch> JoshTriplett, as in, the fact that it modifies TestFS isn't really important?
[07:48:49] <JoshTriplett> aatch: Again, I'll go with "sort of". :)
[07:48:58] *** Joins: hoony1 (Thunderbird@moz-g1v.beb.105.183.IP)
[07:49:10] <JoshTriplett> aatch: Does the answer you're about to give involve the phrase "interior mutability"? ;)
[07:49:18] <aatch> JoshTriplett, yes, yes it does.
[07:49:33] <aatch> Seems like the best option here.
[07:49:51] <JoshTriplett> Possibly.
[07:50:17] * Sgeo sort of thinks of interior mutability as IORef and inherited mutability as the State monad. Is that reasonable?
[07:50:40] <JoshTriplett> aatch: I do still feel like there's a more fundamental issue here that's going to repeatedly beat me over the head in my ongoing use of Rust, but I'm willing to experiment with a solution that addresses this case.
[07:50:51] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[07:51:23] <Mutabah> Is there a way to "save" a filtered iter_mut and borrow/clone it without errors?
[07:51:33] *** Quits: hoony (Thunderbird@moz-g1v.beb.105.183.IP) (Ping timeout: 121 seconds)
[07:51:35] <tunnuz> question: is it possible to overload the == operator in rust and give it a different semantic using associated types?
[07:51:40] <aatch> JoshTriplett, well another option would be to collect all the replies first, then do all the replies afterwards.
[07:51:46] <aatch> tunnuz, nope
[07:51:47] *** Joins: CitronellaNinja (Steven@moz-bh58dh.direcpc.com)
[07:51:50] <JoshTriplett> aatch: Are you suggesting that I stuff inode_oid and/or oid_inode in a RefCell?
[07:51:51] <tunnuz> mmm
[07:52:00] <Mutabah> tunnuz: You can overload == with the PartialEq trait
[07:52:05] <JoshTriplett> aatch: Because the word "dynamic" in the documentation of RefCell makes me very sad.
[07:52:16] <Mutabah> tunnuz: but it always returns a boolean
[07:52:17] <aatch> JoshTriplett, it's not actually that bad.
[07:52:20] <tunnuz> Mutabah, but can I return something different from boolean?
[07:52:22] <tunnuz> ah, there you go
[07:52:26] *** Joins: Kxepal832 (Miranda@moz-gg4j29.pppoe.mtu-net.ru)
[07:52:29] <JoshTriplett> aatch: Just not a particular fan of dynamic typing.
[07:52:36] <tunnuz> ok
[07:52:38] <aatch> JoshTriplett, it's not dynamic typing.
[07:52:39] <Mutabah> tunnuz: Rust works from the "principle of least surprise"
[07:52:41] <Sgeo> JoshTriplett, sometimes an escape valve is needed
[07:52:49] <aatch> JoshTriplett, it's dynamic borrowing.
[07:52:54] <JoshTriplett> aatch: What do you mean by "collect all the replies first"?
[07:53:04] <Sgeo> In Haskell too
[07:53:13] <JoshTriplett> aatch: Well, sure, but "dynamic" anything suggests that some amount of error checking is being deferred until runtime.
[07:53:13] <Sgeo> Haskell has unsafeCoerce and Dynamic and Typeable
[07:53:27] <JoshTriplett> Sgeo: And something has gone rather horribly wrong if I have to touch any of those. ;)
[07:53:45] <tunnuz> Mutabah, aatch: thanks
[07:53:57] <aatch> JoshTriplett, oh, in your `readdir` method, the problem is that you need to do `self.oid_to_inode` in the loop.
[07:54:10] <JoshTriplett> aatch: Right.
[07:54:22] *** Joins: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr)
[07:54:40] *** Joins: sagg (sigg@moz-55rvi2.dclient.hispeed.ch)
[07:54:41] *** Quits: Kxepal (Miranda@moz-tqbvro.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[07:54:43] <JoshTriplett> aatch: You're suggesting that I do everything needing "tree" in advance, then drop tree before I make any calls to reply?
[07:54:52] <JoshTriplett> aatch: (or more to the point, to self.oid_to_inode)?
[07:55:03] <aatch> JoshTriplett, well, the `entry.id()` is just a u64, so you could collect the arguments to `reply.add(..)` in a Vec or something, then loop through *that* afterwards.
[07:55:08] *** Quits: eerie_ (eerie@moz-joilui.red.bezeqint.net) (Connection closed)
[07:55:27] <aatch> Calling self.oid_to_inode in the second loop.
[07:55:57] <aatch> Whether it's a good option depends on how many entries you expect to have.
[07:55:58] <JoshTriplett> I was rather hoping that by moving from Haskell to Rust, I'd get *away* from doing piles of excessive memory allocation for mysterious reasons. :)
[07:56:31] *** Quits: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi) (Ping timeout: 121 seconds)
[07:56:35] * Sgeo is hoping to get away from the prospect of wiring up monad transformers
[07:56:36] <JoshTriplett> (And in general, I was rather hoping that by using Rust, I'd be writing code that compiles down to what I'd have written in C to begin with, minus the pain.)
[07:57:01] <JoshTriplett> Sgeo: You and me both.  Personally, I'd like to get away from writing ludicrous type signatures and type-level arithmetic. ;)
[07:57:05] <aatch> JoshTriplett, it often does, even with the abstractions. Not quite perfect yet.
[07:57:21] <aatch> (for compilation)
[07:57:39] <Sgeo> JoshTriplett, well, there's some type-level arithmetic I like
[07:57:41] <Sgeo> >.>
[07:57:57] <JoshTriplett> aatch: I realize that; I meant that one of the criteria I'm using to evaluate possible ways to write this code is "is this doing extra work it doesn't need to just to appease Rust".
[07:58:01] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[07:58:29] <ChrisMorgan> What happened to FromPrimitive?
[07:58:39] <aatch> JoshTriplett, there is almost always a way that avoids the extra work. But sometimes that requires use of unsafe code.
[07:58:48] <Mutabah> ChrisMorgan: I believe it was unstabled along with the rest of core::num
[07:59:06] <ChrisMorgan> Mutabah: I’m talking unstable Rust; it’s just vanished.
[07:59:06] <Sgeo> I should sleep, have Dr. appointment
[07:59:17] <Mutabah> ChrisMorgan: Oh
[07:59:31] <ChrisMorgan> I can’t find any mention of it in commit messages or RFCs or anything else, it’s simply vanished. Sure, I could find out where and why if I looked in more detail, but I haven’t done that yet.
[07:59:53] <ChrisMorgan> And #[derive(FromPrimitive)] is still there, though the code it produces will not work as there is no std::num::FromPrimitive…
[08:00:08] <aatch> JoshTriplett, anyway, RefCell exists somewhat to allow you to do things that *you* know are safe, but the borrow checker can't prove.
[08:00:11] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[08:00:19] <Mutabah> ChrisMorgan: "    std: Remove deprecated/unstable num functionality"
[08:00:32] <JoshTriplett> aatch: Doesn't RefCell add runtime overhead to check that, though?
[08:01:04] <aatch> JoshTriplett, a single usize
[08:01:09] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[08:01:14] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[08:01:19] <JoshTriplett> aatch: And reference counting.
[08:01:26] <JoshTriplett> Right?
[08:01:28] <aatch> JoshTriplett, nope, not for RefCell by itself
[08:01:39] <JoshTriplett> What's the usize then?
[08:01:46] <Sgeo> I wonder if with RefCell + phantom types I could make my own arbitrary rules for borrowing
[08:01:47] <aatch> Well, there's some ref-counting-esque stuff
[08:01:49] *** Quits: zcourts (zcourts@moz-7ms809.cable.virginm.net) (Client exited)
[08:02:12] <Mutabah> ChrisMorgan: That was from bitrust. The entire std::num (core::num) module was removed, deprecated in favor of crates.io's num
[08:03:16] <aatch> JoshTriplett, but it just counts the number of readers
[08:03:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[08:03:48] <JoshTriplett> aatch: Still, one of the big appeals of Rust to me was the lack of reference counting.
[08:03:52] <aatch> JoshTriplett, in your case, all the manipulation of the value would likely be optimised out
[08:04:17] <Mutabah> JoshTriplett: RefCell uses that usize to ensure that the borrow rules are maintained
[08:04:43] *** Joins: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi)
[08:04:54] <Mutabah> JoshTriplett: So, at worst it adds a comparison and inc/dec to the code path (assuming it's not optimised out)
[08:04:57] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[08:05:00] <JoshTriplett> Yeah, I understood that.
[08:05:49] *** Quits: Havvy (Havvy@moz-aas.m8a.237.67.IP) (Ping timeout: 121 seconds)
[08:06:04] *** Joins: dalarmmst (dalarmmst@moz-mb21j4.bredband.comhem.se)
[08:06:18] <Mutabah> :( No easy to way "clone" (and freeze the origina) an arbitary iterator
[08:06:35] <JoshTriplett> aatch: I'm starting to wonder if my problems would be solved by a way to write "fn inline ...", such that an inline function was equivalent to a macro.
[08:06:48] <Mutabah> I.e. take a copy of a [T].iter_mut iterator, freezing the original
[08:06:56] <JoshTriplett> As in it gets treated as part of the caller for the purposes of borrow analysis.
[08:07:09] <aatch> JoshTriplett, if you're Ok reaching for unsafe code, UnsafeCell is the core of interior mutability and doesn't actually do anything except wrap the type.
[08:07:13] *** Quits: KLP (KLP@moz-qdcjho.res.rr.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[08:07:25] <JoshTriplett> aatch: I'm rather pointedly not OK with reaching for unsafe code for this.
[08:07:32] *** Joins: zcourts (zcourts@moz-7ms809.cable.virginm.net)
[08:07:35] <Mutabah> JoshTriplett: Got a code sample?
[08:07:52] <JoshTriplett> The previous version (and errors) is at http://is.gd/8cd7Bl
[08:07:58] <aatch> JoshTriplett, to be honest, you're making this really, really hard.
[08:08:22] <aatch> JoshTriplett, every solution that isn't "make what I have now work" doesn't seem good enough for you.
[08:08:51] <JoshTriplett> aatch: I'm sorry if it's coming across that way; that's not what I'm trying to do at all.
[08:08:59] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[08:09:15] *** Quits: shawnadelic (shawnadelic@moz-u5o3kk.res.rr.com) (Quit: Leaving)
[08:10:02] *** Quits: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi) (Ping timeout: 121 seconds)
[08:10:12] <aatch> The whole point of Rust having unsafe is to allow you to do things that are *actually* ok, but you can't prove to the compiler. We have some other solutions that *are* safe, but may sacrifice some performance in the process
[08:10:29] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:11:09] *** Joins: jviereck (Adium@moz-lebeg6.uzh.ch)
[08:11:12] <Mutabah> JoshTriplett: Has it been suggested to break up the TestFS struct into sub-structs, which can be separately borrowed?
[08:11:19] <JoshTriplett> aatch: This is very early in my learning of Rust. I'm trying to 1) learn idiomatic Rust, and avoid shoehorning in mental models from other languages ("you can write FORTRAN in any language"), 2) get a better mental model for how Rust works, including lifetimes and borrowing which seems like one of the most fundamental features of the language, and 3) take advantage of the main feature that attracted me to Rust, namely the zero-cost GC-free RC-f
[08:11:52] <JoshTriplett> aatch: I do understand why Rust has unsafe, and various things built on top of it.  And I like that those are available for cases where the compiler really *can't* know what's going on, like FFI.
[08:12:58] <JoshTriplett> aatch: But for something that the compiler *could* understand if not for my trying to factor out helper functions from duplicated code, it feels like there's something very wrong with either my mental model or the language if just trying to do that sends me into "go use unsafe or some technique that pushes checking until runtime" territory.
[08:13:12] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[08:13:17] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[08:13:24] <frankmcsherry> JoshTriplett: I can't say that I understand the snippet perfectly, but for Rust to help here you would need to prove to it that your methods oid_to_inode and inode_to_object can't alias anything. It is tricky because the former adds to a HashMap and if the later holds a reference to anything in there it could go invalid when re-alloc'd.
[08:13:40] <Mutabah> What frankmcsherry just said
[08:13:55] <frankmcsherry> JoshTriplett: Rust could have much better mod/use analysis, to understand what members are used by various accessors. I don't know if this is on their radar, or at odds with how they do things.
[08:14:03] <Mutabah> The solution (as I mentioned a few mins ago) is to split your struct up into sub-structs
[08:14:29] <Mutabah> frankmcsherry: it's at odds to the model of having the function prototype be the only thing you need
[08:14:31] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[08:14:35] <JoshTriplett> Mutabah: My struct has three members.  One method uses two members, and another method uses a different two members.  I don't see an obvious split here.
[08:14:36] <aatch> frankmcsherry, quite unlikely. Since that makes the body of the function part of the external API.
[08:14:38] *** Quits: SneakySnake (nya@moz-i9is4u.pool.telekom.hu) (Connection closed)
[08:14:46] <aatch> frankmcsherry, basically obliberating abstraction.
[08:14:58] <frankmcsherry> JoshTriplett: what I keep telling myself is that Rust can only get better, and if you like where it is heading you should help out and point out the pain points. It's not done yet, for sure.
[08:15:03] *** Quits: blaenk (blaenkdenum@moz-rrtddg.n2pv.fsko.e000.2605.IP) (Connection closed)
[08:15:24] *** Joins: Jackneill (Jackneill@moz-p0a82d.pool.digikabel.hu)
[08:15:32] <JoshTriplett> frankmcsherry: That much I'm *definitely* inclined to believe.  I've watched the development since it was announced, and I was certainly happy to see the reduction in built-in pointer types for instance.
[08:15:45] <Mutabah> JoshTriplett: You can split inode_oid and oid_inode into one struct, and lend that to inode_to_object
[08:15:50] <Mutabah> (which is on another struct)
[08:15:58] <frankmcsherry> aatch: I mean, right now the API is "&mut self", and if it became "&mut self.field1", that wouldn't be too much more complicated.
[08:16:03] <JoshTriplett> frankmcsherry: If there was an obvious-but-the-compiler-doesn't-know-how-to-do-it-yet solution, I'd be inclined to report that as a feature request.
[08:16:25] <Mutabah> frankmcsherry: Yeah, that'd be interesting
[08:16:39] <Mutabah> frankmcsherry: Not in that form, but as an annotation to the <'a>
[08:16:52] <frankmcsherry> aatch: if it is on the other side of a trait, and the method in the trait is just "&mut self", then totally agree, no reasoning to be done there.
[08:16:56] <Mutabah> e.g. <'a=Self.field>
[08:17:12] *** Joins: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net)
[08:17:15] <JoshTriplett> Mutabah: Having a bidirectional-mapping struct certainly makes sense, but I don't think that solves the problem. Since the map needs updating if you want something that doesn't yet exist in the mapping, the caller would need to pass the mapping as a &mut.
[08:17:26] <JoshTriplett> Mutabah: So AFAICT I'd still end up with overlapping borrows.
[08:17:28] *** Joins: avikpal (avikpal@moz-5j4.6lo.194.117.IP)
[08:17:46] *** Quits: dalarmmst (dalarmmst@moz-mb21j4.bredband.comhem.se) (Ping timeout: 121 seconds)
[08:17:46] <Mutabah> JoshTriplett: One moment, I'll hack up a destructure
[08:17:50] *** Quits: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[08:17:53] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[08:18:22] *** Joins: Porkepix (Porkepix@moz-71m.3nd.202.89.IP)
[08:18:39] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[08:18:46] <JoshTriplett> aatch: FWIW, I really do appreciate your patience here.  This is one of those cases where the point isn't the specific code I'm trying to write, but wrapping my head around how to think in the language.
[08:18:46] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[08:19:09] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[08:19:12] <JoshTriplett> aatch: And much like when I learned Haskell for the first time, it's definitely a much larger jump from other languages.
[08:19:24] <posix4e> What does/did ~ do in rust. It's very difficult to search for.
[08:19:31] <JoshTriplett> posix4e: refcounting, I think.
[08:19:33] <aatch> JoshTriplett, it's a tradeoff, you have to decide if you want to be using the nice parts, or the fast parts. We can't be Python *and* C at the same time.
[08:19:49] <aatch> posix4e, JoshTriplett, unique pointer, basically Box<T>
[08:19:52] <Mutabah> posix4e: It was Box
[08:19:55] <JoshTriplett> Oh, right.
[08:19:58] <JoshTriplett> Which sigil was Rc?
[08:20:02] <Mutabah> JoshTriplett: @ was Rc (well, Gc)
[08:20:06] <JoshTriplett> Ah, right.
[08:20:08] <scott> also ~str was roughly String and ~[T] was roughly Vec<T>
[08:20:21] <aatch> (actually, *is* Box<T>, the compiler still has some magic for it... sigh)
[08:20:25] <scott> as opposed to Box<str> or Box<[T]>
[08:20:31] *** Joins: dalarmmst (dalarmmst@moz-mb21j4.bredband.comhem.se)
[08:20:49] <aatch> except for those two cases scott mentioned.
[08:21:09] <posix4e> thanks
[08:21:13] <frankmcsherry> JoshTriplett: actually, looking at your code I don't think I can convince myself that it is safe; "inode_to_object" looks like it can hold a reference into self.inode_oid (and if it can't, the lifetime of git2::Oid should indicate that), and if that gets pushed to in oid_to_inode then you are boned.
[08:21:31] <posix4e> What was arc?
[08:21:42] <JoshTriplett> posix4e: Still exists; atomic refcounting.
[08:21:50] <posix4e> no
[08:21:51] <posix4e> i mean
[08:21:52] <aatch> posix4e, never existed.
[08:21:53] <posix4e> what was it called
[08:21:57] <tunnuz> is there a syntax to call a method on a reference without dereferencing it?
[08:21:57] <JoshTriplett> Ah.
[08:22:03] <tunnuz> like C++'s arrow syntax?
[08:22:15] <JoshTriplett> frankmcsherry: Trying to work through what you mean.
[08:22:28] <aatch> tunnuz, the `.` will do whatever it needs to call your method.
[08:22:44] <tunnuz> aatch, cool!
[08:22:48] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[08:22:54] <aatch> tunnuz, if the method takes &self, it won't (necessarily) dereference first.
[08:22:54] <JoshTriplett> frankmcsherry: find_object takes an oid by value, not by reference.
[08:22:58] *** Quits: jviereck (Adium@moz-lebeg6.uzh.ch) (Quit: Leaving.)
[08:23:03] <JoshTriplett> frankmcsherry: It doesn't hold onto the oid.
[08:23:12] <JoshTriplett> frankmcsherry: It's just a lookup by key.
[08:23:21] *** Quits: moa (Cedric@moz-9asvr1.abo.wanadoo.fr) (Ping timeout: 121 seconds)
[08:23:36] <tunnuz> aatch, makes sense
[08:23:44] <JoshTriplett> frankmcsherry: Does that make sense?
[08:23:47] *** Quits: drewm1980 (drewm1980@moz-b5ce5a.hujf.dasj.1812.2a02.IP) (Ping timeout: 121 seconds)
[08:24:07] <aatch> JoshTriplett, anyway, I'd split off the hashmap and vec to a seperate type, InodeMap or something, wrap that in a RefCell and put it in TestFS
[08:24:16] <frankmcsherry> JoshTriplett: ok, gotcha (mis-read as a HashMap lookup, returning a ref). In that case, why does inode_to_object hold a borrow? Is there a lifetime in git2::Object?
[08:24:56] <JoshTriplett> frankmcsherry: git2::Object is effectively owned by git2::Repository.
[08:25:00] *** Joins: drewm1980 (drewm1980@moz-b5ce5a.hujf.dasj.1812.2a02.IP)
[08:25:05] *** Quits: DerisiveLogic (smuxi@moz-g93io6.res.rr.com) (Ping timeout: 121 seconds)
[08:25:08] <JoshTriplett> frankmcsherry: There's a <'repo> lifetime bound on just about everything in git2.
[08:25:21] <JoshTriplett> Including git2::Object.
[08:25:21] <frankmcsherry> JoshTriplett: ah, sorry. The repo probably returns a reference or something. I think I see. So, the repo may be referenced, but the only thing that is read and mutated is that Vec, which you are sure isn't held as part of the return.
[08:25:24] <aatch> Minimizes the overhead (since otherwise you'd have to wrap the map and the vector separately) and maintains the abstraction.
[08:25:45] <JoshTriplett> aatch: That makes me sad, but so far it's looking like the least awful option.
[08:26:08] <aatch> JoshTriplett, there are other options, but without unsafe you're going to have to accept *some* overhead.
[08:26:34] <aatch> be it in `readdir` or in the `TestFS` type.
[08:26:41] <JoshTriplett> That's the thing that makes me sad; I could do this with zero overhead if I was willing to duplicate oid_to_inode and inode_to_object into their callers.
[08:27:34] <Mutabah> JoshTriplett: Here's a hackup, how does this look? http://is.gd/5hIDGf
[08:27:58] <JoshTriplett> Mutabah: Reading...
[08:28:16] <Mutabah> JoshTriplett: I'm not sure if the above compiles though, but it fits with my expirence
[08:28:19] *** Quits: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au) (Ping timeout: 121 seconds)
[08:29:16] *** Joins: playjax (chatzilla@moz-53gbdr.optusnet.com.au)
[08:29:17] <aatch> JoshTriplett, another option would be to combine the the tree iteration with the map updating code with a custom iterator.
[08:29:17] <frankmcsherry> JoshTriplett: and, you probably went over this option, but just destructuring TestFS in readdir isn't an option (it's gross for you, but not people who use readdir)?
[08:29:42] <aatch> frankmcsherry, that's what this discussion has been about.
[08:30:22] <frankmcsherry> aatch: I see. Full circle then. We just need the folks who started it to go afk and we can do it again! :D
[08:30:26] <JoshTriplett> Mutabah: Modulo some typos (self.repo where self.repo_part should be), that looks like it might compile, but having to pass a TestFsBdMapping to TestFsRepo::inode_to_object is effectively just splitting out fields and passing them separately.
[08:30:43] <JoshTriplett> Mutabah: That's not improving abstraction; that's creating multiple tightly-coupled objects instead of one object.
[08:31:11] <JoshTriplett> Mutabah: And still forcing the callers of the helper function to write out a longer invocation that depends more on the implementation details of that helper. 
[08:31:20] <Mutabah> Sadly, yes
[08:31:22] *** Quits: Caspy7 (chatzilla@moz-q45ho1.6qgi.ef7f.0306.2602.IP) (Ping timeout: 121 seconds)
[08:31:30] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[08:31:30] *** ChanServ sets mode: +o erickt
[08:31:33] <aatch> JoshTriplett, anyway, you could implement an iterator that yields a pair of (inode, entry)
[08:31:42] <JoshTriplett> Mutabah: I appreciate you taking the time to write that, though.
[08:31:55] <JoshTriplett> Mutabah: It does help in understanding what you meant.
[08:32:08] <Mutabah> np, it's a nice break from my own evil
[08:32:25] *** Joins: nicoch (nicoch@moz-g02d7k.be)
[08:32:25] *** Joins: mdup (mdup@moz-53eisu.abo.wanadoo.fr)
[08:32:35] <aatch> JoshTriplett, updating the the map (if needed) from the entry just before yielding
[08:32:39] <frankmcsherry> JoshTriplett: If we are voting, I'd say destructure; it is as close as possible to explaining to Rust what you know about what is mutable and immutable. RefCell scares me, because you need to be super careful never to return references in to that vec in future &self methods you might add.
[08:33:24] <JoshTriplett> ...you know, that gives me an idea.
[08:33:25] *** Quits: mdup (mdup@moz-53eisu.abo.wanadoo.fr) (Quit: ")
[08:33:30] *** Quits: khades1 (Thunderbird@moz-u45.3vk.74.212.IP) (Client exited)
[08:33:40] *** Joins: mdup (mdup@moz-53eisu.abo.wanadoo.fr)
[08:33:41] <Mutabah> Yeah, barring a way to annotate different borrow regions from in a method, that's the way you do it
[08:34:27] *** Joins: sillesta (sillesta@moz-501od2.business.telia.com)
[08:35:15] *** Quits: AngelOfSol (AngelOfSol@moz-dj58kc.rh.rit.edu) (Connection closed)
[08:35:22] *** Quits: maedhroz (maedhroz@moz-4jk5ho.res.rr.com) (Connection closed)
[08:35:22] <JoshTriplett> Inspired by frankmcsherry's "what you know about what is mutable and immutable" comment, and the earlier discussion about extended lifetime annotations that would define borrows of specific fields in a method signature, I wonder if it would help to define a trait with appropriate properties that effectively does the destructuring in such a way that it doesn't borrow "self"?
[08:35:44] <JoshTriplett> The trick would be writing the field accessors in the trait to not borrow self...
[08:35:49] <JoshTriplett> Not sure if that's actually possible.
[08:36:08] *** Joins: khades (Thunderbird@moz-u45.3vk.74.212.IP)
[08:36:09] <aatch> JoshTriplett, not actually possible
[08:36:18] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[08:36:21] <frankmcsherry> JoshTriplett: I like that idea, but I think at the moment lifetimes correspond to lexical scopes, rather than space-time pairs. 
[08:36:34] <aatch> JoshTriplett, so have you thought about the idea that the git repository is itself just an implementation detail?
[08:37:23] <JoshTriplett> aatch: What do you mean by that?
[08:37:41] *** Joins: kmicu (kmicu@moz-uga.edn.218.91.IP)
[08:37:46] <frankmcsherry> JoshTriplett: would be nice to be able to write fn my_func<'a, 'b>( MyStruct { &'a field1, &'b mut field2 } ) -> &'a result
[08:37:50] *** Quits: khades (Thunderbird@moz-u45.3vk.74.212.IP) (Client exited)
[08:38:09] <JoshTriplett> frankmcsherry: Something like that, yeah.
[08:38:24] <frankmcsherry> JoshTriplett: or, I guess it would be "ref" instead of "&" for destructuring, but ... yeah.
[08:38:31] <aatch> JoshTriplett, maybe not the best way to phrase it, but basically if you move the operations you want to do on TestFS down a layer, into TestFS itself, you'll have more control.
[08:38:51] <JoshTriplett> aatch: What do you mean by "the operations you want to do on TestFS"?
[08:39:21] <Mutabah> frankmcsherry: I'd be more for an integration of defined lifetimes in the type definition (annotated onto the type) and the prototype
[08:39:45] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[08:39:46] <aatch> JoshTriplett, so rather than getting the git object, then turning it into a tree, then iterating over the entries of the tree, you instead have a method that returns an iterator over the entries in the appropriate tree
[08:39:46] *** Joins: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de)
[08:40:17] <Mutabah> frankmcsherry: e.g. "struct MyStruct { field1 'lft_1: Type, field2 'lft2: Type } fn fcn(&self) -> &'lft_1 Type"
[08:40:18] <frankmcsherry> Actually, I like this idea. my_func(input: &mut MyStruct) -> &Result vs my_func(input: MyStruct { &'a field1, &'b field2 }) -> &'a Result seems very reasonable.
[08:40:53] <frankmcsherry> my_func(MyStruct { &'a field1, &'b field2 }) -> &'a Result, I guess.
[08:40:57] <aatch> JoshTriplett, the method would take &mut self, but you can still so stuff in the iterator.
[08:41:00] <Mutabah> frankmcsherry: In my way, the prototype just sees the defined regions
[08:41:22] <aatch> JoshTriplett, like update the inode_map
[08:41:38] <JoshTriplett> aatch: You're suggesting changing readdir such that it returns an iterator rather than calling reply.add and reply.ok?
[08:41:54] *** Joins: tunnuz (tunnuz@moz-hlnvj3.nicta.com.au)
[08:41:59] <CitronellaNinja> info JoshTriplett 
[08:42:01] <aatch> JoshTriplett, no, I'm suggesting that you make such an iterator and then *use* it in readdir
[08:42:46] <frankmcsherry> Mutabah: I guess what I was doing was letting whatever the "lifetimes" are bind to arbitrary fields, rather than needing a new struct. Wouldn't that be nicer? Or, what is the ergonomic hit I'm missing?
[08:42:46] <aatch> JoshTriplett, so readdir only cares about the entries in the tree.
[08:43:12] <Mutabah> frankmcsherry: No, in this case I meant annotating fields within your struct with lifetimes
[08:43:13] <JoshTriplett> aatch: As far as I can tell, though, I think I'd have the same overlapping borrows issue within the iterator implementation.
[08:43:16] <Mutabah> frankmcsherry: I'll make a gist
[08:43:35] <aatch> JoshTriplett, nope. Gimme a minute, I'll show you.
[08:43:39] <frankmcsherry> Mutabah: I think I understand, but ... I guess I was thinking of some easy sugar without needing new types.
[08:43:58] <JoshTriplett> aatch: FWIW, if it makes it easier to hack on, I can post the Cargo.toml file that goes with this main.rs.
[08:44:00] <Mutabah> frankmcsherry: This won't be new types
[08:44:02] <JoshTriplett> aatch: Would that help?
[08:44:34] <frankmcsherry> Mutabah: ah, what is that "struct ..." statement then? An annotation for the method, or important?
[08:45:26] *** Joins: rvlander (rvlander@moz-f9rs0f.criu.9fof.41d0.2001.IP)
[08:45:37] *** Quits: rvlander (rvlander@moz-f9rs0f.criu.9fof.41d0.2001.IP) (Client exited)
[08:45:58] *** Quits: kazimuth (james@moz-h7l.35b.189.18.IP) (Quit: Textual IRC Client: www.textualapp.com)
[08:46:05] *** Joins: kazimuth (james@moz-h7l.35b.189.18.IP)
[08:47:16] *** Joins: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk)
[08:47:21] <terpstra_> does anyone know what guarantee sort_by makes when a panic happens in comparison? certainly it should be memory safe. certainly the order of the array is irrelevant. is it also irrelevant if some of the values that were in the array get dropped?
[08:47:27] *** Joins: blaztinn_ (blaztinn@moz-hg7bqt.dynamic.amis.net)
[08:48:12] <terpstra_> ie: if i implement a stable in-place sort, can i use an O(1) temporary buffer on the heap to swap intermediates with the slice?
[08:48:42] <Mutabah> frankmcsherry: https://gist.github.com/thepowersgang/fefc774a41bcfabd96c8
[08:49:18] <Mutabah> terpstra_: Usually you won't be able to observe the object after the panic
[08:49:22] <aatch> terpstra_, since when a panic happens, the entire state of that thread is considered invalid, it doesn't really matter since you can't access that array post-panic
[08:49:33] <JoshTriplett> Mutabah: That certainly looks nice.
[08:49:49] <terpstra_> couldn’t the array have been in an Arc or i am using it via a &mut in a scoped::thread or something?
[08:49:52] <aatch> This has been done deliberately to avoid questions about exception safety mostly.
[08:49:52] <Mutabah> JoshTriplett: It looks nice, not 100% sure if it's possible/provable
[08:49:55] <frankmcsherry> Mutabah, JoshTriplett: Wait, wait! My is going to be even nicer! :D
[08:49:57] <frankmcsherry> sec.
[08:50:09] <Mutabah> terpstra_: scoped threads propagate panics
[08:50:15] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[08:50:16] <terpstra_> Mutabah: oh! i did not know this
[08:50:20] <aatch> terpstra_, the appropriate thread-safe types should maintain that property.
[08:50:29] <Mutabah> terpstra_: and through the Arc, it will be via a Mutex which is poisoned when the holder panics
[08:50:44] <terpstra_> ok! great. i’m convinced. thanks.
[08:51:00] *** Joins: khades (Thunderbird@moz-u45.3vk.74.212.IP)
[08:51:04] *** Quits: khades (Thunderbird@moz-u45.3vk.74.212.IP) (Client exited)
[08:51:05] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[08:53:38] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[08:53:48] <frankmcsherry> Mutabah, JoshTriplett: Ok, mine isn't prettier. But it doesn't annotate the struct, which seems like it would be good esp when you don't control the struct.
[08:54:09] <Mutabah> frankmcsherry: usually when you don't control the struct, you're not writing methods for it
[08:54:11] <frankmcsherry> Like, maybe you want to destructure a borrowed pair
[08:54:15] <JoshTriplett> *nod*
[08:54:21] <JoshTriplett> What Mutabah said. :)
[08:54:35] <frankmcsherry> No way; I write traits for all sorts of existing types!
[08:54:47] <Mutabah> and for a tuple, something like "('lft Type) could work
[08:54:47] *** Joins: panicbit (panicbit@moz-r4ks4s.dip0.t-ipconnect.de)
[08:55:14] *** Quits: Shackra (Jorge@moz-7bh.ng6.177.186.IP) (Connection closed)
[08:57:12] *** Joins: Quanttek (quassel@moz-25k96c.6fkd.dvrb.8108.2a02.IP)
[08:57:41] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[08:57:42] *** Quits: csherratt (colin@moz-357qdq.cable.teksavvy.com) (Quit: Konversation terminated!)
[08:59:02] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[09:00:37] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[09:01:29] *** bvssvni_ is now known as bvssvni
[09:01:32] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[09:02:13] <Manishearth> Anyone got Go vs Rust benchmarks
[09:02:14] <Manishearth> ?
[09:02:21] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[09:02:32] <frankmcsherry> Mutabah: https://gist.github.com/thepowersgang/fefc774a41bcfabd96c8 for counter-proposal!
[09:02:47] *** Parts: CitronellaNinja (Steven@moz-bh58dh.direcpc.com) ()
[09:03:04] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (Ping timeout: 121 seconds)
[09:03:46] <Mutabah> frankmcsherry: Problem there is that it exposes the structure as part of the public API
[09:04:20] <Mutabah> Anyway, a bit of a moot argument. I don't know if this could ever be possible
[09:04:21] <frankmcsherry> Mutabah: surely yours does too? There is a field lifetime in the signature
[09:04:41] <frankmcsherry> Mutabah: It totally could (I say knowing nothing). At least, mocking these things up is healthy in understanding ergo pain points.
[09:04:45] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[09:04:48] <Mutabah> frankmcsherry: It's annotated such that it's part of the public API. I.e. the lifetime names are public
[09:05:36] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[09:05:59] *** Joins: nedp (nedp@moz-vg6vvt.bigpond.net.au)
[09:06:07] <frankmcsherry> Mutabah: and, maybe I'm confused, but just because we write "self" doesn't actually mean that the type of that argument is abstracted away, is it?
[09:06:40] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[09:07:04] <frankmcsherry> Mutabah: or is the idea that you could define a trait that worked on types with two lifetimes, and made promises that it only borrowed one of them for a while, without actually knowing which fields the lifetimes were associated with?
[09:07:24] *** Quits: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr) (Connection closed)
[09:07:26] <Mutabah> frankmcsherry: Possibly
[09:07:30] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[09:07:35] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[09:09:12] <frankmcsherry> Mutabah: destructuring as part of formal arguments is already a thing, right? Like, you can write fn my_func((a, b) : (u32, i64)); can you do that with structs too?
[09:09:39] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[09:11:13] *** Quits: hoony1 (Thunderbird@moz-g1v.beb.105.183.IP) (Client exited)
[09:11:23] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[09:11:45] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[09:12:04] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[09:12:29] <Mutabah> frankmcsherry: Not sure how that'd work with privacy
[09:12:37] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[09:12:38] <Mutabah> Anyone else want to poke an opinion in?
[09:14:12] <frankmcsherry> Mutabah: badly, I expect. :) You can totally do this http://is.gd/5Sym2H though; so, I would imagine destructuring references to pub fields should/could work?
[09:14:50] *** Joins: Guest18 (textual@moz-gur296.abo.wanadoo.fr)
[09:15:19] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[09:15:55] <frankmcsherry> Mutabah: it seems like all you need to add is some naming/reasoning about annotating borrows with "space" as well as "time"
[09:16:46] *** Joins: Matthias247 (Miranda@moz-49li60.hsi14.kabel-badenwuerttemberg.de)
[09:20:47] <tunnuz> what's the most efficient way of having a match dependent on the first element of a vector?
[09:20:49] <tunnuz> currently I am doing
[09:20:51] <ChrisMorgan> NOT FAIR! #[derive(Debug)] can do what it likes with unstable features but I can’t, so take --pretty expanded on such a thing and try to compile the result and it wants #![feature(debug_builders)]!
[09:21:00] <tunnuz> let mut first = rhs_desc.remove(0);
[09:21:00] <tunnuz>                         match first {
[09:21:08] <tunnuz> ... 
[09:21:09] <tunnuz> }
[09:21:11] <cmr> ChrisMorgan: yeah, that's true of a lot of std macros :)
[09:21:13] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[09:21:25] <ChrisMorgan> cmr: such blatant cheating?
[09:21:28] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[09:21:38] <tunnuz> and then if needed, I re-add first as the first element of the vector
[09:21:50] <tunnuz> but in many cases I don't really need to move it
[09:21:52] <tunnuz> from there
[09:22:02] *** Joins: asQuirreL (asQuirreL@moz-ro1qqu.ox.ac.uk)
[09:22:03] <cmr> ChrisMorgan: yeah. we gave up on having the output of --pretty expanded be legal in stable rust.
[09:22:06] <Mutabah> tunnuz: ... "match rhs_desc[0]"?
[09:22:25] <ChrisMorgan> reem: looks like Map<A> can’t have fmt::Debug implemented properly for now in unstable rust (can’t use derive because only Box<A> implements debug, not A at present at least).
[09:24:06] <ChrisMorgan> Well, I guess I can add such an implementation.
[09:26:05] *** Joins: Ms2ger (Ms2ger@moz-15i.9ho.190.193.IP)
[09:27:22] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[09:27:34] <Mutabah> *sigh* I really want to have &out or similar.
[09:27:44] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[09:27:55] *** Quits: kazimuth (james@moz-h7l.35b.189.18.IP) (Quit: Textual IRC Client: www.textualapp.com)
[09:30:08] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[09:30:21] *** Quits: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[09:31:19] *** Joins: noam (noam@moz-6kn.6at.57.213.IP)
[09:31:36] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[09:32:29] *** Quits: OmniMancer (OmniMancer@moz-bm6ffm.orcon.net.nz) (Quit: Leaving.)
[09:32:54] *** Quits: tunnuz (tunnuz@moz-hlnvj3.nicta.com.au) (Ping timeout: 121 seconds)
[09:33:37] *** Quits: avikpal (avikpal@moz-5j4.6lo.194.117.IP) (Ping timeout: 121 seconds)
[09:33:57] *** Joins: genbattle (genbattle@moz-4ci180.xtra.co.nz)
[09:34:10] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (Ping timeout: 121 seconds)
[09:34:28] *** darkowlzz|afk is now known as darkowlzz
[09:34:36] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[09:35:40] *** Joins: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net)
[09:37:00] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[09:38:38] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[09:38:51] *** Joins: SneakySnake (nya@moz-i9is4u.pool.telekom.hu)
[09:39:44] *** Quits: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net) (Ping timeout: 121 seconds)
[09:39:48] *** Joins: avikpal (avikpal@moz-hm3.igl.194.117.IP)
[09:41:46] *** Joins: Lilly (Lilly@moz-pfkvo9.bredband.comhem.se)
[09:43:14] *** Joins: nano (nano@moz-00j6et.dynamic.kabel-deutschland.de)
[09:44:43] *** Quits: kgrandon (Adium@moz-2igukk.hjek.d045.0009.2601.IP) (Quit: Leaving.)
[09:45:37] <bluss> bstrie: You mentioned Gankro's solution but the mem::forget thread is so big that you missed that he basically spelled out in the same thread :) https://github.com/rust-lang/rfcs/pull/1066#issuecomment-93988019
[09:45:53] <bluss> bstrie: anyway, and I've implemented basically that in a PR.
[09:46:05] *** Quits: ajitk (ajit@moz-6ht.i8n.51.106.IP) (Ping timeout: 121 seconds)
[09:46:22] <bluss> bstrie: sorry, talking about drain_range
[09:46:33] *** Joins: slomo (slomo@moz-p8m0g2.net)
[09:46:56] *** Joins: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net)
[09:46:58] *** Joins: mib_8mi4ro (Mibbit@moz-70cs6n.bredband.comhem.se)
[09:47:33] *** Joins: fyolnish (fyolnish@moz-3n24u8.so-net.ne.jp)
[09:48:20] *** Quits: jml (jml@moz-mqpurn.178.in-addr.arpa) (Ping timeout: 121 seconds)
[09:48:55] *** Quits: js (js@moz-nnkoaq.org) (Ping timeout: 121 seconds)
[09:49:14] <frankmcsherry> so, I like slice::split_at, but there is no slice::split_mut_at, rather just an iterator. is there something unsafe about &mut [T] -> disjoint &mut [T] sub-slices?
[09:49:22] *** Joins: jml (jml@moz-mqpurn.178.in-addr.arpa)
[09:49:27] <mib_8mi4ro> Hi all. A quick random question. How well does rust support Json? Found this json file with astronomical data I would like to play around with, and part of me is curious how well rust does that so I might try it sometime.
[09:49:43] <frankmcsherry> ok, ignore that. apparently split_at_mut is a thing, and I'm just bad.
[09:50:13] <aatch> frankmcsherry, you need unsafe to *construct* them, but that's all.
[09:50:24] *** Quits: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP) (Ping timeout: 121 seconds)
[09:50:25] <aatch> !mib
[09:50:25] <rustbot> Hello, Mibbit user with a “mib_<random>” nickname. Please change your nickname to something less confusing by saying `/nick NEW_NAME_HERE`.
[09:50:56] *** Joins: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au)
[09:50:57] <mib_8mi4ro> \nixk notconfusing
[09:51:07] <mib_8mi4ro> \nick notconfusing
[09:51:15] *** mib_8mi4ro is now known as notconfusing
[09:51:18] <notconfusing> There xD
[09:51:23] <aatch> sigh...
[09:52:03] <aatch> notconfusing, there's a library called serde that handles json (along with other things)
[09:52:18] <notconfusing> Ok, thanks, just wanted to know :).
[09:52:19] <VShell> notconfusing: http://erickt.github.io/rust-serde/serde/ might be what you want, it has a json parser and serialiser.
[09:52:50] <aatch> Thank you, VShell 
[09:53:00] <notconfusing> Making a note of that for when I have the time :).
[09:53:07] <VShell> aatch: sorry, you got there first. XD
[09:53:24] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[09:53:31] <aatch> VShell, eh, I wasnt planning on finding a link
[09:53:50] <aatch> figured that serde would be on crates.io
[09:54:30] <aatch> In other news. Rage at floating point numbers that keep breaking my quickcheck tests because they aren't real numbers.
[09:55:46] <VShell> there's a few more examples on the github, https://github.com/erickt/rust-serde
[09:55:58] <aatch> Like this one is failing because 1 entry in a 3x3 matrix is 0.00001 bigger than the equivalent entry in an otherwise identical matrix.
[09:56:13] <VShell> :(
[09:56:50] * ChrisMorgan likes the question “if 1 + x = 1, what is 1 - x?”
[09:57:16] <aatch> And my approximate equality impl considers them different enough.
[09:57:40] *** Quits: notconfusing (Mibbit@moz-70cs6n.bredband.comhem.se) (Quit: http://www.mibbit.com ajax IRC Client)
[09:57:44] <aatch> Sigh, looks like I'm going to have to make the fuzzyness tunable.
[09:58:02] *** Quits: sagg (sigg@moz-55rvi2.dclient.hispeed.ch) (A TLS packet with unexpected length was received.)
[09:58:11] *** Joins: arBmind (Andreas@moz-2o6q3q.dip.tu-dresden.de)
[09:58:33] *** Quits: arBmind (Andreas@moz-2o6q3q.dip.tu-dresden.de) (Quit: Leaving.)
[09:59:02] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[09:59:55] *** Joins: js (js@moz-uf0ejo.dclient.hispeed.ch)
[09:59:58] *** Joins: ajitk (ajit@moz-6ht.i8n.51.106.IP)
[10:00:05] *** Quits: zcourts (zcourts@moz-7ms809.cable.virginm.net) (Ping timeout: 121 seconds)
[10:00:30] <aatch> Right now it's if the numbers are less than epsilon apart, or more than 2 units in the last place apart.
[10:01:11] <aatch> Abusing the fact that adjacent floats are also next to each other in the binary representation.
[10:01:23] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[10:01:27] *** Quits: tunnuz (tunnuz@moz-qotoi1.optusnet.com.au) (Ping timeout: 121 seconds)
[10:01:37] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[10:01:46] *** Quits: kerrick (kerrick@moz-fub7j7.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[10:02:03] <frankmcsherry> so, I like slice::split_at, but there is no slice::split_mut_at, rather just an iterator. is there something unsafe about &mut [T] -> disjoint &mut [T] sub-slices?
[10:02:09] <Mutabah> Question: Should I attempt to hack my kernel into using cargo, and then import a crate or two into it?
[10:02:17] <Mutabah> Or just keep all of it (save libcore) as my own code
[10:02:24] <frankmcsherry> sigh; ignore the up-arrow-enter in the wrong window noob.
[10:02:31] <Ms2ger> frankmcsherry, split_at_mut
[10:03:08] <frankmcsherry> Ms2ger: sorry, I asked earlier, but ... had to shut down atom and re-open it and now my muscle memory for where the re-compile window is got broke.
[10:04:58] *** Quits: genbattle (genbattle@moz-4ci180.xtra.co.nz) (Ping timeout: 121 seconds)
[10:05:16] *** Quits: mdup (mdup@moz-53eisu.abo.wanadoo.fr) (Client exited)
[10:05:29] *** Joins: OmniMancer (OmniMancer@moz-6m1jrb.xtra.co.nz)
[10:05:31] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[10:05:55] *** Joins: Nextra (Nextra@moz-9ostti.osnanet.de)
[10:06:00] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[10:06:11] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[10:06:22] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[10:07:07] <tomaka> I wish there was a way to turn some code that looks like `extern { fn f1(); fn f2(); ... }`
[10:07:22] *** Joins: moa (Cedric@moz-eio783.4ge1.ap0a.0e35.2a01.IP)
[10:07:22] <tomaka> into "dlsym(lib, f1); dlsym(lib, f2) ..."
[10:08:00] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[10:08:03] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[10:08:04] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[10:09:05] *** Joins: Guest67 (textual@moz-og7.cn8.251.116.IP)
[10:09:51] *** Joins: tomprogrammer (thomas@moz-h0ilaa.tr5r.qept.4dd0.2001.IP)
[10:10:24] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[10:10:29] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[10:11:05] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[10:11:31] *** Quits: js (js@moz-uf0ejo.dclient.hispeed.ch) (Ping timeout: 121 seconds)
[10:11:38] *** Quits: alonlevy (alon@moz-p48.q13.159.94.IP) (Ping timeout: 121 seconds)
[10:11:40] <tomaka> With like a macro or attribute or something
[10:12:23] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[10:12:25] *** Joins: proc (proc@moz-tnbie4.dip0.t-ipconnect.de)
[10:12:44] *** Quits: avikpal (avikpal@moz-hm3.igl.194.117.IP) (Ping timeout: 121 seconds)
[10:12:59] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Connection closed)
[10:13:00] <simukis> tomaka: you can easily write yourself a macro which would make glue like that
[10:13:21] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[10:13:40] *** Joins: js (js@moz-uf0ejo.dclient.hispeed.ch)
[10:14:16] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[10:16:39] *** Joins: avikpal (avikpal@moz-1ra.36b.194.117.IP)
[10:18:34] *** Quits: zettablade (Mibbit@moz-58u.jiv.125.50.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:18:36] *** Joins: khades (Thunderbird@moz-u45.3vk.74.212.IP)
[10:18:55] <frankmcsherry> what is the rust "queue" collection? is there a deque (seems to have been, but not finding it at the moment)?
[10:19:10] <cmr> frankmcsherry: VecDeque in std::collections
[10:19:18] <frankmcsherry> cmr: <3
[10:19:59] *** Joins: mahdi (mahdi@moz-8oo.182.244.151.IP)
[10:23:41] *** Quits: avikpal (avikpal@moz-1ra.36b.194.117.IP) (Ping timeout: 121 seconds)
[10:24:28] *** Joins: canxiang (Mibbit@moz-mgocoj.members.linode.com)
[10:24:34] <aatch> Ok, so I think my matrix inversion algorithm is to blame here.
[10:24:36] *** Joins: edbond (edbond@moz-8st.7gv.108.109.IP)
[10:25:36] <frankmcsherry> aatch: always. :)
[10:26:20] <aatch> It's on a 3x3 matrix, so "algorithm" may be a bit strong.
[10:26:51] <frankmcsherry> is there an (unsafe) inverse function for split_at_mut? One that would look like fn fuse<T>(&mut [T], &mut[T]) -> Option(&mut [T]) that fuses the two if they are in fact contiguous? (( trying to write a merge-sort with slices rather than offsets/ranges ))
[10:28:06] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[10:28:08] <Mutabah> frankmcsherry: Not in the std (afaik)
[10:28:11] <Mutabah> frankmcsherry: But you could write one
[10:28:25] <frankmcsherry> Mutabah: I could try! I would learn, and become more powerful!
[10:28:41] <aatch> frankmcsherry, why would you need that? Shouldn't you have the original slice still around?
[10:28:54] <bluss> where is our definite documentation about variance, borrows, phantomdata etc?
[10:29:32] <frankmcsherry> aatch: not the way I was writing it (maybe a bad algo). Was splitting slices into maximal increasing subslices, putting in a work queue, and (ideally) fusing pairs until I get the whole back.
[10:29:53] <frankmcsherry> aatch: so the parent slice is gone once I've split_at_mut'd it.
[10:30:10] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Connection closed)
[10:30:17] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[10:30:17] *** Quits: canxiang (Mibbit@moz-mgocoj.members.linode.com) (Quit: http://www.mibbit.com ajax IRC Client)
[10:30:23] *** Joins: avikpal (avikpal@moz-hrc.uhm.194.117.IP)
[10:30:31] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[10:31:06] <frankmcsherry> aatch: I can totally just put (offset, len) pairs in the work queue, but .. was trying to be rust-y
[10:31:37] <aatch> frankmcsherry, I just thought you'd be doing it recursively, thats all.
[10:31:39] *** Joins: kvssoft (Mibbit@moz-bbcqf5.jhv.up.ee)
[10:31:51] *** Quits: nott (nott@moz-to4.06o.57.86.IP) (Ping timeout: 121 seconds)
[10:32:01] <frankmcsherry> aatch: negative! recursion is for .. people who want to write their program simply. hrm. lemme think.
[10:32:57] <frankmcsherry> aatch: for some reason I wrote qsort iteratively with a work queue rather than recursively. perhaps I should re-think this merge sort approach.
[10:33:05] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[10:33:05] *** ChanServ sets mode: +o erickt
[10:33:26] *** Quits: edbond (edbond@moz-8st.7gv.108.109.IP) (Ping timeout: 121 seconds)
[10:34:27] *** Quits: mahdi (mahdi@moz-8oo.182.244.151.IP) (Ping timeout: 121 seconds)
[10:34:33] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Ping timeout: 121 seconds)
[10:34:35] <aatch> Aren't both algorithms *defined* recursively?
[10:36:13] <frankmcsherry> aatch: sure, but you can totally just put the deferred work in a queue and avoid calls, if that is your thing: http://is.gd/WotHUm
[10:36:18] *** Joins: Altazimuth_ (Altazimuth@moz-rb7u6p.skybroadband.com)
[10:36:54] *** Joins: cacaca (Mibbit@moz-aua.g0i.51.193.IP)
[10:37:07] <aatch> frankmcsherry, definitely. There's a number of algorithms that are useful for compilers that are defined recursively but implementing them that way is asking for stack overflow.
[10:37:08] *** Quits: lfairy (lfairy@moz-107acv.ihug.co.nz) (Connection closed)
[10:37:14] <frankmcsherry> aatch: and, what I may be learning is: not as easy with merge sort. :)
[10:37:48] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[10:38:16] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[10:38:22] <cmr> frankmcsherry: rather than storing slices, try storing index pairs (lo, hi) and slicing from the Vec as-needed.
[10:41:23] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[10:43:04] *** Joins: _petr (petr@moz-2pi.7q8.248.178.IP)
[10:44:05] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Connection closed)
[10:44:11] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[10:44:48] *** Quits: ptx (ptx@moz-989.5up.104.87.IP) (Ping timeout: 121 seconds)
[10:47:55] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[10:48:14] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[10:50:33] *** Joins: ptx (ptx@moz-989.5up.104.87.IP)
[10:50:35] *** Joins: mahdi (mahdi@moz-ipf.n3s.129.78.IP)
[10:51:27] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[10:52:22] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[10:54:03] *** darkowlzz is now known as darkowlzz|afk
[10:54:04] <bluss> &'a mut X is invariant in both 'a and X ?
[10:55:00] <kvssoft> Hi! I'm trying to generate a documentation using "cargo doc --open", but it seems like nothing is happening after this command is executed. Maybe my expectations are wrong. Could anybody provide more information about what actually should happen after running the "cargo doc"?
[10:55:07] <kvssoft> I'm on Windows and using the today's Nightly build. I have a function in a "binary" project, which has the "///" comment. I'm using this guide: http://doc.rust-lang.org/nightly/book/documentation.html
[10:55:28] *** Joins: alonlevy (alon@moz-uiqsl4.red.bezeqint.net)
[10:55:36] <Ms2ger> bluss, covariant in T, contravariant in 'a, I'd assume
[10:55:40] <cmr> bluss: iirc lifetimes are always contravariant.
[10:55:48] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[10:55:56] <kimundi> Afaik for &mut they are invariant
[10:56:42] <Ms2ger> Oh?
[10:56:43] *** Quits: Kingsquee (kingsley@moz-qq7ns6.bchsia.telus.net) (Quit: Konversation terminated!)
[10:56:47] *** Joins: xav (xav@moz-5tfec1.mobi)
[10:57:32] *** Quits: frankmcsherry (frankmcsher@moz-i1cmk3.airspot.airfy.com) (Connection closed)
[10:57:44] <kimundi> If you could turn a &'a mut into a &'b mut where 'b is shorter than 'a, then you could store something with lifetime 'b in it, which would become invalid if the reference is seen as a &'a mut again
[10:57:50] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[10:59:16] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[10:59:46] <cmr> That only rules out covariance?
[11:00:22] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[11:00:30] <cmr> kvssoft: well, `cargo doc` will generic docs, and then `--open` tries to open a browser to them.
[11:00:39] <cmr> kvssoft: but you should be able to just open the browser manually.
[11:00:47] <cmr> *generate
[11:00:53] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[11:00:59] <kimundi> cmr: hm... To be honest I haven't still understood the difference between contra- and covariance
[11:01:05] *** darkowlzz|afk is now known as darkowlzz
[11:01:10] *** Joins: TheLemonMan (lemonboy@moz-ak2k9f.26-151.libero.it)
[11:01:26] *** Joins: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr)
[11:02:07] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[11:03:22] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[11:03:31] *** Joins: mdup (mdup@moz-53eisu.abo.wanadoo.fr)
[11:03:33] <cacaca> Sorry, I try to link dynamically with rust a rust library (a rlib or a dylib) How it is possible ? 
[11:05:07] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Ping timeout: 121 seconds)
[11:05:12] <bluss> Ms2ger: I'm making notes, to make this my definite research
[11:05:17] <bluss> Ms2ger: :)
[11:05:31] *** Joins: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr)
[11:06:13] *** Joins: venuc (venuc@moz-79c.93e.39.1.IP)
[11:06:15] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[11:06:41] <kimundi> cacaca: You can tell rustc how to link  but afaik you can not mix and match both modes
[11:06:44] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[11:07:08] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[11:07:17] *** Parts: venuc (venuc@moz-79c.93e.39.1.IP) ()
[11:07:25] <bluss> cmr: elementary question, what is the subtyping relationship for lifetimes? if 'a: 'b  ('a is at least as long lifed as 'b), which is the subtype? 'a is a subtype of 'b?
[11:07:25] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[11:07:46] <kvssoft> cmr: `--open` doesn't work for me. Speaking of documentation, I didn't see any .html in \target\doc, but I've just tried to make my function public (pub fn ...) and now I see .html files with documentation. But is it possible to have a documentation for private functions?
[11:08:08] <cmr> kvssoft: you cannot generate documentation for private functions right now, no.
[11:08:30] <kvssoft> cmr: ok, thanks for info!
[11:08:48] *** Joins: jviereck (Adium@moz-pqri8u.dclient.hispeed.ch)
[11:08:49] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[11:09:01] <cacaca> kimundi: I have the hyper library, and I don't want remake everytime the static linking passes. But I don't know how to ask this to rustc.
[11:09:08] <proc> some way to get this matcher with serialized value to run ? http://is.gd/x1QAUn
[11:09:16] *** Parts: kvssoft (Mibbit@moz-bbcqf5.jhv.up.ee) ()
[11:09:21] <Ms2ger> cmr, do you know if that's planned?
[11:09:30] <cmr> bluss: correct, 'a <: 'b iff 'a is longer than 'b.
[11:10:27] <cmr> Ms2ger: rustdoc can do it, but cargo doc can't.
[11:10:46] *** Joins: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi)
[11:11:11] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[11:11:12] <cmr> (by doing rustdoc --no-defaults --passes strip-hidden,collapse-docs,unindent-comments. this just removes the strip-private pass)
[11:11:22] <bluss> cmr: ok great so rust syntax 'a: 'b  is the same as 'a <: 'b  and 'a is longer (or equal to) 'b
[11:11:57] *** Quits: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net) (Ping timeout: 121 seconds)
[11:12:53] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[11:13:03] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[11:13:36] <scott> hmm, so lifetimes are subtypes of lifetimes they 'include'?
[11:14:24] *** Joins: adjivas (adjivas@moz-t655t6.abo.wanadoo.fr)
[11:14:44] *** Joins: smckay_ (steve@moz-bfutgb.va.comcast.net)
[11:14:58] <proc> scott: any ideas ? http://is.gd/5K9u5R
[11:15:18] <proc> there has to be a way to use serialized stored values :)
[11:15:37] <bluss> wikipedia: “If S is a subtype of T, the subtyping relation is often written S <: T, to mean that any term of type S can be safely used in a context where a term of type T is expected. ”
[11:16:23] <scott> that makes sense with using a longer lifetime in place of a shorter one
[11:16:29] <bluss> yeah
[11:16:30] *** Quits: smckay (steve@moz-bfutgb.va.comcast.net) (Ping timeout: 121 seconds)
[11:16:49] *** Joins: miyagi (blabla@moz-hc41h3.dip0.t-ipconnect.de)
[11:16:51] <bluss> I expect to spend the day researching variance so that I can use PhantomData correctly for the Drain iterator
[11:16:59] <scott> 'static is the "bottom" lifetime since it can satisfy any lifetime
[11:17:04] *** Quits: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr) (Quit: Leaving...)
[11:17:08] <scott> that's kind of reversed from my intuition
[11:17:16] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[11:17:25] <scott> proc: you can't use values like that in patterns
[11:17:26] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[11:17:39] <scott> only constructors and possibly constants
[11:17:41] <bluss> right it is kind of reversed, which explains why "normal lifetime parameters are contravariant" and "normal type parameters" are covariant
[11:18:29] <miyagi> Hello #rust. How do I combine multiple options into one in a good way? For example, if I'd like to parse https://en.wikipedia.org/wiki/Two-line_element_set how would I avoid callling .unwrap() on each item and being able to return an Option<TLE>?
[11:18:41] <scott> bluss: does that contravariant mean that 'a: 'b implies &'a T :> &'b T?
[11:19:20] <proc> scott: eh, I *think* ( still rem. errors ) I've fixed it with :: instead of .
[11:19:22] <kimundi> miyagi: Option has useful combinator methods
[11:19:24] <proc> at least I hope so
[11:19:47] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[11:21:00] <kimundi> playbot: let x: Option<(i32, i32)> = "1".parse().and_then(|a| { "2".parse().map(move |b| (a, b)) }); x
[11:21:01] -playbot- <anon>:9:37: 9:99 error: mismatched types:
[11:21:01] -playbot-  expected `core::option::Option<(i32, i32)>`,
[11:21:01] -playbot- output truncated; full output at: http://bit.ly/1dd8Vcs
[11:21:26] *** Quits: marsel (user@moz-rrv.pek.234.188.IP) (Ping timeout: 121 seconds)
[11:21:28] <kimundi> playbot: let x: Result<(i32, i32), _> = "1".parse().and_then(|a| { "2".parse().map(move |b| (a, b)) }); x
[11:21:29] -playbot- Ok((1, 2))
[11:21:50] *** Quits: untitaker (untitaker@moz-donca6.highway.telekom.at) (Ping timeout: 121 seconds)
[11:21:56] <nathan7> playbot: type Pair2<T, U> = (T, U); Pair2(1, 2)
[11:21:57] -playbot- <anon>:9:36: 9:41 error: unresolved name `Pair2`
[11:21:57] -playbot- <anon>:9         type Pair2<T, U> = (T, U); Pair2(1, 2)
[11:21:57] -playbot- output truncated; full output at: http://bit.ly/1GsxPhP
[11:22:02] <nathan7> playbot: type Pair2<T, U> = (T, U); self::Pair2(1, 2)
[11:22:03] -playbot- <anon>:9:36: 9:47 error: unresolved name `self::Pair2`
[11:22:03] -playbot- <anon>:9         type Pair2<T, U> = (T, U); self::Pair2(1, 2)
[11:22:03] -playbot- output truncated; full output at: http://bit.ly/1dd93IX
[11:22:07] <nathan7> :(
[11:22:35] <proc> scott: you won ;)
[11:22:39] <kimundi> nathan7: You'd still construct with (1, 2)
[11:22:41] <scott> nathan7: type aliases don't introduce new value-level constructors, afaik
[11:23:02] <nathan7> kimundi: I was trying to get a named constructor
[11:23:18] <scott> playbot: struct Pair2<T, U>(T, U); Pair2(1, 2)
[11:23:19] -playbot- output truncated; full output at: http://bit.ly/1GsxYBZ
[11:23:19] <Ms2ger> fn Pair2<T, U>...
[11:23:21] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[11:23:28] <kimundi> nathan7: Define a unit tuple struct wrapper or a function
[11:23:31] <nathan7> kimundi: like, .map(Pair2)
[11:23:33] <scott> playbot: #[derive(Debug)] struct Pair2<T, U>(T, U); Pair2(1, 2)
[11:23:34] -playbot- Pair2(1, 2)
[11:23:50] *** Quits: jviereck (Adium@moz-pqri8u.dclient.hispeed.ch) (Quit: Leaving.)
[11:23:53] <nathan7> obviously tuple structs that aren't anonymous work
[11:23:56] <kimundi> nathan7: ... oh! Yeah, there is no syntax for that except |a, b| (a, b)
[11:24:05] *** Joins: untitaker (untitaker@moz-no7a2d.highway.telekom.at)
[11:24:25] <nathan7> first-class anonymous constructors, now!
[11:24:41] *** Joins: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr)
[11:24:55] <nathan7> kimundi: also, opinion wanted — what if we aliased _ as rvalue to Default::default()?
[11:25:06] <scott>  /*# LANGUAGE TupleSections #*/ foo.map((,))
[11:25:09] *** Quits: Guest67 (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:25:12] <kimundi> no opinion about that
[11:25:15] <nathan7> kimundi: so you can be f(foo, bar, _, baz)
[11:25:19] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[11:25:23] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[11:25:27] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (A TLS packet with unexpected length was received.)
[11:25:29] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[11:25:36] <kimundi> nathan7: other language construct an closure in cases like that
[11:25:44] <kimundi> languages*
[11:25:47] <nathan7> kimundi: yes, Scala, who else?
[11:25:52] <kimundi> no idea
[11:25:59] <nathan7> I think automagical closures are definitely un-Rusty
[11:26:12] <kimundi> but so are single-char implicit function calls
[11:26:15] <nathan7> true
[11:26:26] <miyagi> kimundi: alternative question: can I use try! inside where I'm constructing a struct?
[11:26:27] <nathan7> like, constexpr Default, somehow?
[11:26:44] <kimundi> miyagi: not sure what you mean
[11:27:01] <simias> miyagi: you have to return a Result<YourType> if you want to use try! in your constructor
[11:27:04] <bluss> scott: I'm not sure hehe.. this is why this will take the whole day :)
[11:27:24] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[11:27:29] <simias> like any other function really
[11:27:31] <scott> I need more caffeine to make sense of subtyping right now
[11:27:32] <nathan7> trait ConstDefault { const DEFAULT: Self; } impl<T> Default for T where T: ConstDefault { fn default() -> T { T::DEFAULT } }
[11:28:06] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[11:28:43] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[11:29:01] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (A TLS packet with unexpected length was received.)
[11:29:05] *** Joins: hoony (Thunderbird@moz-2ei.8bq.201.114.IP)
[11:29:09] <nathan7> Haskell's (,) to give first-class tuple constructors is kinda nice
[11:29:35] *** Joins: sagg (sigg@moz-55rvi2.dclient.hispeed.ch)
[11:29:50] *** Joins: tigrou3tac (fabien@moz-gdonfo.fbx.proxad.net)
[11:29:58] <scott> does Rust let you .map any kind of constructor?
[11:30:07] *** Joins: frankmcsherry (frankmcsher@moz-faa086.adsl.alicedsl.de)
[11:30:12] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[11:30:13] <scott> playbot: Some(2).map(Some)
[11:30:14] -playbot- Some(Some(2))
[11:30:16] <scott> so it does
[11:30:20] <bluss> yes if it's like a function
[11:30:34] <miyagi> kimundi: http://is.gd/v0BwLt < I'm simply wondering whether there's any kind of syntactical(?) sugar that I might use instead of first storing each parsed value in a local variable using try! before constructing the TLE struct
[11:30:37] *** Quits: hoony (Thunderbird@moz-2ei.8bq.201.114.IP) (Client exited)
[11:30:48] <bluss> playbot: use std::ops::Add;  (1..10).fold(0, Add::add)
[11:30:49] -playbot- 45
[11:30:50] *** Quits: Jesse (jruderman@moz-pqc1f5.ca.comcast.net) (Client exited)
[11:30:54] <bluss> that's another nice thing^
[11:31:02] <sillesta> does an array need to be boxed if i don't know the length at compile time?
[11:31:10] <nathan7> yep
[11:31:16] <Ms2ger> Well, boxed
[11:31:20] <Mutabah> sillesta: You usually use Vec in that case
[11:31:28] <Ms2ger> It needs to be behind a reference of some sort
[11:31:46] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (Connection closed)
[11:31:59] <bluss> scott: I'm taking notes on variance https://etherpad.mozilla.org/rbuOXzt5do
[11:32:00] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[11:32:14] <scott> bluss: cool, thanks
[11:32:23] <sillesta> struct Bar { quux: Vec<Foo> } works? Foo being a simple struct
[11:32:27] <proc> can I declare a static inside a mod which is initialized based on a parameter ? So setting a static val based on a main.rs value
[11:32:33] <Ms2ger> Sure
[11:32:38] <sillesta> cool :)
[11:32:53] <frankmcsherry> so I have a vec: Vec<&mut[T]>, and I'm trying to do mem::swap(&mut vec[i][0], &mut vec[j][0]); Rust complains, which makes sense. Short of swapping the &mut[T]s out of vec, is there an easy-ish way to do this?
[11:33:07] <Ms2ger> miyagi, you can always do let x = Foo { a: try!(a()), b: try!(b()) };
[11:33:10] <Mutabah> frankmcsherry: Vec has a swap method
[11:33:15] <scott> bluss: you use return value in your argument because function arguments twist everything around one more time, right? (being contravariant as they are)
[11:33:17] <Mutabah> frankmcsherry: (well, [T] does)
[11:33:22] <scott> bluss: err, in your example*
[11:33:28] <Mutabah> frankmcsherry: Oh, wait...
[11:33:33] <frankmcsherry> Mutabah: yeah... :)
[11:33:35] <Ms2ger> frankmcsherry, not really
[11:33:48] <bluss> scott: well.. you can tell me more? :)
[11:33:51] *** Joins: mr_pants (Mibbit@moz-7dm1ti.fbx.proxad.net)
[11:34:05] *** Joins: dgrunwald (Daniel@moz-76qm54.hsi4.kabel-badenwuerttemberg.de)
[11:34:13] <miyagi> Ms2ger: so that works? Awesome. 
[11:34:17] <miyagi> thanks
[11:34:27] <Ms2ger> Np
[11:34:58] <scott> bluss: a function type `a -> b` has `a` contravariant and `b` covariant, so I expect that would make the situation reversed for function arguments
[11:35:35] <kimundi> miyagi: I think the try!() method ends up the nicest of all options
[11:35:43] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (A TLS packet with unexpected length was received.)
[11:35:52] *** Joins: lucian (lucian@moz-2c3pda.cable.virginm.net)
[11:35:53] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (Quit: Leaving...)
[11:36:01] <kimundi> And yeah, as Ms2ger said no need to actually have local variables
[11:36:03] <Ms2ger> So is there a way to define a public generic struct, but restrict it to a whitelist of types?
[11:36:20] <Ms2ger> (and has a Drop impl)
[11:36:30] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[11:36:38] <Mutabah> Ms2ger: Triat?
[11:36:42] *** Quits: mr_pants (Mibbit@moz-7dm1ti.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[11:36:43] <Mutabah> Ms2ger: Trait
[11:36:44] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[11:36:51] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[11:37:10] <bluss> scott: ok well that's the kind of stuff I'm trying to learn right now. I didn't reach those exact rules yet
[11:37:11] <Ms2ger> Mutabah, yeah, but if I make the trait public, then anyone can mess with my whitelist
[11:37:16] <miyagi> kimundi: definitely. 
[11:37:22] <scott> bluss: hmm, so &-ptrs have their lifetime parameter covariant and &mut-ptrs invariant? that's what your note at the bottom is saying?
[11:37:32] <cmr> Ms2ger: no :( only somewhat-reasonable workaround is to make the trait unsafe.
[11:37:34] <Ms2ger> And if it's private, I get "private type in public API" watning
[11:37:35] *** Joins: wei2912 (wei2912@moz-530.h2f.156.175.IP)
[11:37:37] <Mutabah> Ms2ger: Why do you want a whitelist?
[11:37:48] <miyagi> New question: how do I get this to compile? http://is.gd/hiyxiW
[11:37:53] <cmr> Ms2ger: it's my biggest wart, that you can't partition the type space like that.
[11:37:53] <bluss> scott: That's my prior understanding
[11:38:12] *** Quits: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[11:38:20] <cmr> Ms2ger: there used to be a hack where you could make the trait inherit from a private trait, but that doesn't fly anymore
[11:38:59] <Ms2ger> Mutabah, because my generic code isn't exactly pretty :)
[11:39:09] <Mutabah> miyagi: Depends what you're really trying to do
[11:39:35] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[11:39:36] <Mutabah> miyagi: .chars to obtain a specific codepoint, .as_bytes() to obtain a &[u8] (which is bytes)
[11:39:45] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[11:40:07] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[11:40:12] <Ms2ger> cmr, so if you don't need Drop, you can just put a bound on new, and that seems to work
[11:40:16] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[11:40:37] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[11:40:56] <miyagi> Mutabah: I want to match on a single character from a string.
[11:41:08] *** Quits: atomic (atomic@moz-ums8mr.tor-exit.network) (Connection closed)
[11:41:20] *** Joins: atomic (atomic@moz-kvs6fc.torservers.net)
[11:43:09] <miyagi> Mutabah: nvm. found a solution via as_bytes
[11:44:08] *** Joins: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es)
[11:44:30] <Mutabah> miyagi: I mentioned that earlier. BUT, it may not be the "correct" way
[11:44:32] <bluss> scott: it's a confusing subject https://github.com/rust-lang/rfcs/issues/391
[11:44:40] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[11:45:11] <Mutabah> miyagi: (unicode means that a byte != codepoint != "character" (grapheme))
[11:46:06] <miyagi> Mutabah: I know, but how do I match on the graphemes? 
[11:46:29] <scott> bluss: aha! looks like the new relation proposed there matches the one we've been discussing so far
[11:46:35] * Mutabah opened can of worms
[11:46:47] <bluss> cmr: rust devs don't agree about which way to say lifetimes subtype https://github.com/rust-lang/rust/issues/15699
[11:46:50] <bluss> :-)
[11:47:43] *** Joins: Johannes_ (Johannes@moz-ufvp1b.nttpc.ne.jp)
[11:47:45] *** Joins: Johannes__ (Johannes@moz-ufvp1b.nttpc.ne.jp)
[11:47:52] *** Parts: Johannes__ (Johannes@moz-ufvp1b.nttpc.ne.jp) ("Leaving")
[11:47:54] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[11:48:02] <Mutabah> miyagi: In short - Usually you don't want to index into a string (usually you're iterating along the string)
[11:48:15] * scott just finally started grokking why &'a T being covariant in 'a makes sense
[11:48:39] * bluss is still processing
[11:49:01] <OmniMancer> because the lifetime of the reference doesn't matter for anything except how long you keep it?
[11:49:17] <miyagi> Mutabah: how'd you combine that with instantiating a struct though? Or would struct instantiation be one of the cases where it'd be acceptable to index into the string?
[11:49:37] <scott> bluss: if 'a includes 'b ('a <: 'b) then &'a T is safe to use in place of &'b T (&'a T <: &'b T) because &'a T's referent lives throughout 'b (and then some)
[11:49:44] <Mutabah> miyagi: ... sorry?
[11:50:23] <bluss> yeah
[11:50:34] <bluss> scott: see lines 43-50 in the notes
[11:50:38] <miyagi> Mutabah: well, say you want to deconstruct a string into a struct. How would you do that in 'good rust' without indexing into the string?
[11:51:05] <OmniMancer> what do you mean by deconstruct a string into a struct?
[11:51:07] <bluss> scott: I think the argument in line 46 is the correct one to think about variance in return position?
[11:51:48] <scott> bluss: seems right
[11:52:11] <bluss> ok, finally getting somewhere 
[11:52:40] <aatch> Just need somebody to sanity-check for me, the fact that the decrement is prefix doesn't matter here, right: `for (i = 2; i >= 0; --i)`
[11:52:56] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[11:53:04] <cmr> aatch: not at all.
[11:53:12] *** Quits: alonlevy (alon@moz-uiqsl4.red.bezeqint.net) (Ping timeout: 121 seconds)
[11:53:49] <aatch> cmr, thought so, I'm using a C++ implementation as reference, but it's not working and I can't for the life of me figure out why.
[11:54:10] *** Joins: skade_ (skade@moz-6athcr.pools.vodafone-ip.de)
[11:54:18] <aatch> That's the only thing that ends up being significantly different in the Rust code
[11:54:58] <dgrunwald> i is a signed integer?
[11:55:10] *** Quits: nano (nano@moz-00j6et.dynamic.kabel-deutschland.de) (Connection closed)
[11:55:24] <aatch> dgrunwald, in the C++ code, yes
[11:55:27] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[11:55:32] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[11:55:37] <dgrunwald> because i >= 0 is always true for unsigned
[11:55:53] <scott> bluss: I think my note about function covariance/contravariance only applies when you look at subtyping relations on function types themselves
[11:56:07] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[11:56:12] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[11:56:17] <bluss> I see
[11:56:30] <aatch> dgrunwald, I used a second loop variable starting from 3, with the condition of > 0, then just did -1 for the value I wanted.
[11:56:42] <scott> bluss: i.e. T <: U implies A -> T <: A -> U  and  U -> B <: T -> B
[11:56:55] <rkruppe> Unicode identifiers are completely verboten (not even feature gated) and will stay that way for the foreseeable future, right?
[11:56:55] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Quit: bye)
[11:56:56] <aatch> (I hit underflow the first time)
[11:56:59] <scott> which will have an effect in Rust but we haven't looked at that case yet
[11:57:01] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[11:57:39] <bluss> scott: that's kind of what my function taking reference and function returning reference examples touch upon
[11:57:41] <cmr> rkruppe: I don't expect it to stay that way for incredibly long.
[11:58:12] <dgrunwald> the 'goes to' operator `-->` is nice for writing such loops in C++: `for (unsigned i = 2+1; i --> 0;)` ;-)
[11:58:25] <rkruppe> cmr: So when going over the reference, should I remove any mention of unicode identifiers, or write that they'll be added soon(tm) ?
[11:58:27] <scott> bluss: I suppose you're right about that. I misread them slightly
[11:59:20] <cmr> rkruppe: I have no strong opinion on that
[11:59:28] *** Joins: Guest67 (textual@moz-og7.cn8.251.116.IP)
[11:59:32] *** Quits: ajitk (ajit@moz-6ht.i8n.51.106.IP) (Ping timeout: 121 seconds)
[11:59:38] *** Joins: sp0 (seth@moz-m97a3k.internode.on.net)
[11:59:42] <cmr> rkruppe: I think I'd just remove the mentions...
[12:00:24] *** Joins: ai (ai@moz-pqofrl.sunline.net.ua)
[12:01:13] <scott> bluss: latest comments look good to me
[12:01:44] <ville> now that 1.0 is out of the way, how's introspection/static reflection looking?
[12:01:45] <scott> bluss: if 'a <: 'b then we can treat fn(&'b T) as if it were fn(&'a T) just like in the above example
[12:02:04] *** Joins: futile (felix@moz-cmcd12.unity-media.net)
[12:02:23] <bluss> yeah
[12:02:36] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[12:02:37] <dgrunwald> aatch: in rust, I'd write that loop `for i in (0..3).rev()`
[12:02:53] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[12:03:16] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Connection closed)
[12:03:38] *** Joins: laogao (laogao@moz-m3ssu7.members.linode.com)
[12:03:55] <aatch> dgrunwald, that's probably better. It's not the problem though.
[12:04:11] <aatch> (it happens earlier)
[12:04:40] *** Joins: GladiaTeur (Mibbit@moz-9qc.hok.158.105.IP)
[12:06:39] <Rym> rkruppe: curiously enough they are allowed for macro names http://is.gd/rmLrGT
[12:06:45] *** Joins: jxs (joaoxsouls@moz-3rn.a4j.61.108.IP)
[12:07:40] *** Quits: laogao (laogao@moz-m3ssu7.members.linode.com) (Ping timeout: 121 seconds)
[12:08:02] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[12:08:31] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[12:09:15] *** Quits: adjivas (adjivas@moz-t655t6.abo.wanadoo.fr) (Quit: WeeChat 0.4.2)
[12:09:19] <scott> bluss: the next hurdle for me is why &'x mut T isn't covariant in 'x
[12:09:37] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[12:10:02] <bluss> scott: right, I suppose after getting the easy things straight we can go on to that..
[12:10:36] <cmr> scott: do you mean the &mut type constructor?
[12:10:36] <bluss> it's just like in physics, defining the direction, + / - or whatever is half of the problem and it's always arbitrary
[12:10:50] <scott> cmr: yeah
[12:11:26] <scott> &'x mut T is supposedly invariant in 'x
[12:12:05] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[12:14:03] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[12:14:10] <rkruppe> Rym: Turns out there's even a feature gate (non_ascii_idents)
[12:14:28] <rkruppe> So it's probably allowed for macros because it works in general and macros are expanded before feature gate checking
[12:14:56] <rkruppe> I'll just leave all mentions of XID_* and add a footnote mentioning the feature gate
[12:15:17] *** Joins: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP)
[12:15:33] <Rym> 👍
[12:16:33] <scott> fn narrow<'b, 'a: 'b>(x: &'a mut i32) -> &'b mut i32 { x } // this makes &'x mut T look covariant over 'x
[12:17:07] <scott> I take a reference to something alive for 'a and return that reference with a new type that only knows it's alive for 'b, a shorter lifetime within 'a
[12:17:14] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[12:17:19] *** Quits: Cork (Cork@moz-rmmud5.priv.bahnhof.se) (Quit: .)
[12:17:21] *** Quits: vodik (simon@moz-86ind4.dedicated.allstream.net) (Ping timeout: 121 seconds)
[12:17:54] *** Joins: Riastradh (riastradh@moz-tjp84q.gtor.org)
[12:18:58] <bluss> scott: maybe I'm misunderstanding and &mut X is invariant in X
[12:19:12] <bluss> and the lifetime behavior is the same as &X ?
[12:19:12] <scott> hmmm
[12:19:22] <scott> I hadn't considered that
[12:19:35] *** Joins: jwatt (roslea@jwatt.irc.users.mozilla.org)
[12:19:48] *** Quits: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr) (Connection closed)
[12:20:28] *** Joins: flying-sheep (quassel@moz-15h8hd.dynamic.mnet-online.de)
[12:20:37] *** Parts: flying-sheep (quassel@moz-15h8hd.dynamic.mnet-online.de) ()
[12:21:04] <miyagi> Can I somehow transform a Vec<String> to [String; 3]?
[12:21:51] <scott> bluss: that might make a lot of sense. I think immutable lists are covariant and mutable lists are invariant in something like Scala
[12:22:08] <aatch> miyagi, other than by doing [v[i].clone(), v[j].clone(), v[k].clone()], no.
[12:22:17] <aatch> (or something similar)
[12:23:41] <bluss> scott: I think the code indicates it this way
[12:23:59] <bluss> miyagi: you can get a &[String; 3] with some trickery, but it's really not much use
[12:24:27] <scott> miyagi: would &[String] suffice?
[12:26:00] <miyagi> scott: I saw the .as_slice() even though that seems to be pending RFC revision. I don't necessarily need the slice, it would just have been nice to have a 'fixed vector length' contract coming from dynamic data.
[12:26:08] *** Quits: GladiaTeur (Mibbit@moz-9qc.hok.158.105.IP) (Ping timeout: 121 seconds)
[12:26:28] <scott> bluss: I like this quote from the wikipedia article: "This illustrates a general phenomenon. Read-only data types (sources) can be covariant; write-only data types (sinks) can be contravariant. Mutable data types which act as both sources and sinks should be invariant."
[12:27:08] *** Joins: akiss (akiss@moz-l61h32.pool.digikabel.hu)
[12:27:20] <scott> bluss: lots of immutable stuff is covariant, mutable stuff is always invariant, and function arguments (the only 'sink' example I can think of) are contravariant
[12:27:25] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[12:27:34] *** Quits: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP) (Quit: WeeChat 1.1.1)
[12:27:38] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[12:27:43] <bluss> ok great
[12:27:45] <bluss> :)
[12:28:03] <bluss> yeah we have no sink pointers, although it has been proposed
[12:30:50] *** Joins: GladiaTeur (Mibbit@moz-udq.mlj.158.105.IP)
[12:32:18] *** Joins: alonlevy (alon@moz-4jqdpb.telavivmakers.org)
[12:32:19] <scott> bluss: https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science) is the article, btw
[12:32:45] *** Quits: OmniMancer (OmniMancer@moz-6m1jrb.xtra.co.nz) (Quit: Leaving.)
[12:33:33] <bluss> yeah I found it
[12:34:00] *** Quits: nedp (nedp@moz-vg6vvt.bigpond.net.au) (Connection closed)
[12:34:26] *** Quits: akiss (akiss@moz-l61h32.pool.digikabel.hu) (Ping timeout: 121 seconds)
[12:34:33] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[12:34:33] *** ChanServ sets mode: +o erickt
[12:35:47] *** Joins: BitPuffin (bzlandfill@moz-ljq19i.bredband.comhem.se)
[12:36:19] *** Quits: BitPuffin (bzlandfill@moz-ljq19i.bredband.comhem.se) (Quit: CGI:IRC)
[12:36:55] *** Joins: BitPuffin (BitPuffin@moz-ljq19i.bredband.comhem.se)
[12:37:04] <BitPuffin> oi!
[12:37:10] *** Quits: nyx (nyx@moz-ivelpd.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[12:37:21] <BitPuffin> does rust support creating custom syntax frontends? Kind of like the #lang direcive in Racket
[12:37:22] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[12:37:40] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[12:37:52] <BitPuffin> which is basically that the racket environment calls a specific reader which converts say python or whatever to racket and executes it
[12:38:10] *** Quits: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es) (Ping timeout: 121 seconds)
[12:38:12] <scott> no, nothing like that. you can write syntax extensions for a more powerful version of macros, though
[12:38:14] <cmr> BitPuffin: no, rustc does not support that, though you can do so with librustc.
[12:38:24] *** Quits: molokdotc (molokdotc@moz-kjf.mdl.255.187.IP) (Quit: leaving)
[12:38:51] <BitPuffin> cmr: hm I see, where can I read about librustc?
[12:39:01] *** Quits: DemonOne (Avi@moz-0s0gvp.cablep.bezeqint.net) (Connection closed)
[12:39:09] *** Joins: espadrine (tyl@moz-l019mn.fbx.proxad.net)
[12:39:21] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[12:39:35] <aatch> Curse you quick-check!
[12:39:38] *** darkowlzz is now known as darkowlzz|afk
[12:40:22] <aatch> It keeps finding cases that cause numerical instability in my code.
[12:40:25] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Connection closed)
[12:40:46] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[12:40:57] <BitPuffin> cmr: ah, so I basically have to create my own libsyntax?
[12:41:16] <cmr> BitPuffin: just the parsing half of it, you still need to use its AST.
[12:41:21] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[12:42:00] <BitPuffin> ah
[12:42:03] <BitPuffin> I see
[12:42:30] <BitPuffin> hmm yeah I wonder if that would be a neat way to bootstrap my language. Then I could piggyback on rust for a while
[12:43:00] *** Joins: iiixtiii (ixti@moz-i3d.dae.119.188.IP)
[12:43:19] *** darkowlzz|afk is now known as darkowlzz
[12:43:21] *** Quits: avikpal (avikpal@moz-hrc.uhm.194.117.IP) (Ping timeout: 121 seconds)
[12:43:23] *** Joins: espadrine_ (tyl@moz-imvc7h.capitainetrain.com)
[12:43:25] *** Quits: Guest67 (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:43:38] *** Quits: espadrine (tyl@moz-l019mn.fbx.proxad.net) (Ping timeout: 121 seconds)
[12:44:16] *** Quits: __ixti__ (ixti@moz-i3d.dae.119.188.IP) (Ping timeout: 121 seconds)
[12:44:45] *** Joins: bhamilton (bhamilton@moz-2lu.h78.210.105.IP)
[12:44:48] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Ping timeout: 121 seconds)
[12:44:49] *** Quits: bhamilton (bhamilton@moz-2lu.h78.210.105.IP) (Connection closed)
[12:45:24] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[12:46:54] *** Joins: agjacome (agjacome@moz-ma9sfa.dynamic.jazztel.es)
[12:47:51] *** darkowlzz is now known as darkowlzz|afk
[12:49:30] <frankmcsherry> the slice::split operator https://doc.rust-lang.org/std/primitive.slice.html#method.split says the matched items aren't returned in the slices; anyone know why that is?
[12:49:50] *** Joins: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP)
[12:50:29] *** Joins: findow (Mibbit@moz-3vppe5.fios.verizon.net)
[12:50:34] *** Joins: edlothiol (user@moz-chhfor.hsi02.unitymediagroup.de)
[12:50:38] *** Quits: RCIX (RCIX@moz-vnmep7.ph.cox.net) (Ping timeout: 121 seconds)
[12:50:48] <cmr> frankmcsherry: because that's how many other languages do it.
[12:51:10] <findow> bye
[12:51:13] <frankmcsherry> *adds to list of very minor grievances* :)
[12:51:39] <findow> x
[12:55:01] <frankmcsherry> (( trying to do: have a sorted list of (k,v) pairs, want the same-key, different-data slices; being a pain at the moment ))
[12:55:31] *** Parts: dwrensha (chatzilla@moz-46o4hi.pa.comcast.net) ("")
[12:55:49] *** Quits: kjanosz (kjanosz@moz-1ugcf5.eee8.gm72.41d0.2001.IP) (Ping timeout: 121 seconds)
[12:56:03] *** Joins: kjanosz- (kjanosz@moz-1ugcf5.eee8.gm72.41d0.2001.IP)
[12:56:12] *** Joins: orangeshark (erik@moz-pom16t.44tj.56ot.0306.2602.IP)
[12:56:48] *** Quits: findow (Mibbit@moz-3vppe5.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[12:57:10] *** Joins: eibwen (eibwen@moz-dkg8t1.dip0.t-ipconnect.de)
[12:57:24] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[12:57:40] *** darkowlzz|afk is now known as darkowlzz
[12:58:29] *** Joins: edbond (edbond@moz-8st.7gv.108.109.IP)
[12:58:49] *** Quits: yuja (yuja@moz-3k3neh.so-net.ne.jp) (Ping timeout: 121 seconds)
[13:00:01] *** Quits: skade_ (skade@moz-6athcr.pools.vodafone-ip.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[13:00:08] *** Joins: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net)
[13:01:10] *** Quits: v21 (vee@moz-lcs.bqs.204.223.IP) (Ping timeout: 121 seconds)
[13:02:07] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[13:02:15] *** Joins: skade (skade@moz-6athcr.pools.vodafone-ip.de)
[13:03:14] *** Quits: skade (skade@moz-6athcr.pools.vodafone-ip.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[13:03:37] *** darkowlzz is now known as darkowlzz|afk
[13:03:58] *** Joins: paulosuzart (suzart@moz-lnl.7md.180.191.IP)
[13:04:20] *** Quits: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net) (Ping timeout: 121 seconds)
[13:05:24] *** Quits: futile (felix@moz-cmcd12.unity-media.net) (Quit: WeeChat 1.0-dev)
[13:05:28] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[13:07:42] *** Quits: nyx (nyx@moz-ivelpd.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[13:08:40] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[13:09:32] <Mutabah> Can you suppress a warning for a block within a function?
[13:09:35] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[13:09:35] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[13:09:51] <Mutabah> (I use 'unsafe' within a macro, and it's triggering warnings when used by other unsafe code)
[13:10:20] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[13:10:36] *** Quits: jxs (joaoxsouls@moz-3rn.a4j.61.108.IP) (A TLS packet with unexpected length was received.)
[13:11:35] <cmr> Mutabah: unfortunately not.
[13:11:46] <Mutabah> Helper function, here I come
[13:11:56] *** Joins: yuja (yuja@moz-3k3neh.so-net.ne.jp)
[13:12:05] <Mutabah> Related - Is it just because it's an intrinsic that ::core::intrinsics::type_name is unsafe?
[13:12:14] <cmr> yeah.
[13:12:18] *** Joins: avikpal (avikpal@moz-32r.iss.194.117.IP)
[13:12:43] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[13:13:02] <burntsushi> aatch: :P quickcheck has saved my hiney many times.
[13:13:41] <cmr> mine too.
[13:13:48] <cmr> quickcheck is my favorite Rust feature.
[13:13:53] <burntsushi> :D
[13:13:57] <cmr> ;)
[13:14:08] <burntsushi> i should write a blog post about it. more people should use it.
[13:14:16] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[13:14:23] *** Quits: sagg (sigg@moz-55rvi2.dclient.hispeed.ch) (A TLS packet with unexpected length was received.)
[13:14:27] <aatch> burntsushi, it's an awesome tool, just frustrating to use in a less-than-precise environment when it keeps finding cases that produce large amount of error.
[13:14:42] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[13:14:42] <cmr> numerical analysis is, like, hard yo.
[13:15:14] <aatch> I needed an absolute epsilon for my comparison of 1e-5
[13:15:23] *** Joins: jxs (jxs@moz-3rn.a4j.61.108.IP)
[13:15:32] *** Joins: idegen (greg@moz-9c4nle.or.frontiernet.net)
[13:16:12] *** Joins: arty (Mibbit@moz-ineiim.il.comcast.net)
[13:16:16] *** Joins: ajitk (ajit@moz-6ht.i8n.51.106.IP)
[13:16:46] <aatch> I guess it did motivate me to use a more stable algorithm, not that it helped *that* much.
[13:17:18] <aatch> And the new algorithm is slow enough to warrant keeping the old one around for "fast but inaccurate" use.
[13:17:56] *** darkowlzz|afk is now known as darkowlzz
[13:18:41] <aatch> Though I guess that even 260ns isn't actually that slow, overall.
[13:19:05] *** Joins: laogao (laogao@moz-k1t.k7v.78.124.IP)
[13:19:39] *** Joins: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr)
[13:20:21] *** Quits: edbond (edbond@moz-8st.7gv.108.109.IP) (Ping timeout: 121 seconds)
[13:21:32] *** Quits: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP) (Quit: WeeChat 1.1.1)
[13:23:03] <untitaker> Sup, what's the current way to get the cwd?
[13:23:27] *** darkowlzz is now known as darkowlzz|afk
[13:23:28] <cmr> untitaker: std::env::current_dir
[13:23:35] <untitaker> ahh thanks
[13:23:44] *** Joins: Wild_Cat (Max@moz-na0tak.dsl.teksavvy.com)
[13:23:54] *** Quits: Feyn (Feyn@moz-qqa.rg0.115.42.IP) (Quit: Leaving)
[13:24:06] *** Joins: dwrensha (chatzilla@moz-46o4hi.pa.comcast.net)
[13:25:08] *** Joins: new_one (new_one@moz-143.g8k.42.128.IP)
[13:27:50] <mdup> How make a trait T require Add<T>? I've not been able to make it work so far.
[13:28:01] <Mutabah> mdup: "trait T: Add"
[13:28:07] <arty> burntsushi : The doc is saying that the 'regex!' macro is only supported on nightly builds via compiler plugin ( http://doc.rust-lang.org/regex/regex/index.html#the-regex!-macro ); what is the plan for incorporating into 1.0 ? Thx
[13:28:14] <Mutabah> mdup: Actually, you'll want "trait T: Add<Result=T>"
[13:28:23] *** Quits: Riastradh (riastradh@moz-tjp84q.gtor.org) (Ping timeout: 121 seconds)
[13:28:23] <simukis> that’s recursive and will ICE
[13:28:28] <simukis> I think
[13:28:40] <burntsushi> arty: there isn't a plan. it will be a while before syntax extensions are a stable feature.
[13:28:54] <Mutabah> simukis: Nope.
[13:29:04] <mdup> Mutabah: do you mean Add<Output=T>?
[13:29:08] <Mutabah> mdup: Yeah
[13:29:20] *** Joins: larhat (Adium@moz-tb1ulb.cable.virginm.net)
[13:29:28] <mdup> well, I haven't had much success so far: https://github.com/rust-lang/rust/issues/24810
[13:29:46] <simukis> Mutabah: told you.
[13:29:49] <arty> burntsushi: ok - thank you - will use the  'regex_macros'  crate to enable plugin. 
[13:30:01] <Mutabah> simukis: Nope, I recon it's the impl block that causes the ICE
[13:30:02] <terpstra_> quickcheck? link?
[13:30:15] <Mutabah> s/recon// it is the impl block
[13:30:17] <cmr> terpstra_: https://github.com/BurntSushi/quickcheck
[13:30:43] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[13:30:44] *** Joins: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net)
[13:30:45] <burntsushi> arty: note that regex_macros will not work on rust stable.
[13:30:50] <huon> mdup: maybe you want `trait T: Add<Output = Self>`
[13:30:51] *** darkowlzz|afk is now known as darkowlzz
[13:30:52] <Mutabah> mdup: You impl a trait for a type
[13:30:58] <mdup> simukis: actually, I've had the compiler not ICE on recursive trait; sure it doesn't compile, but at least it acknowledges how you write a non-compilable recursive code
[13:31:02] <Mutabah> huon: They have that
[13:31:15] <huon> oh, I should read the issue :)
[13:31:23] <mdup> huon: hah :)
[13:31:36] *** Quits: BitPuffin (BitPuffin@moz-ljq19i.bredband.comhem.se) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[13:31:47] *** Joins: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net)
[13:31:55] <huon> huh, looks like a bug that the compiler wants Output specified
[13:32:02] <arty> burntsushi: right - but the 'macro_rules' cheat still enables a workaround, correct?
[13:32:03] <miyagi> Is there something like a "not implemented" annotation for functions?
[13:32:05] <mdup> Mutabah: sure, but you can also have an "inherent impl" where the trait itself has its own methods, much like an abstract class in your favorite OO language
[13:32:27] <huon> oh, hm... I guess this trait isn't object safe, so it doesn't make sense to `impl T`
[13:32:39] <burntsushi> arty: no. it's just a syntactic convenience. you don't get compile time regexes or a perf boost.
[13:32:39] <Mutabah> mdup: Yes, and as huon said, it's not object safe
[13:32:49] <mdup> what does object safe mean?
[13:32:58] <Mutabah> mdup: And you don't need the "<Output=T>" on that impl block
[13:33:01] <arty> burntsushi: ok - very good to know that, thx man
[13:33:06] <burntsushi> arty: as the docs say: "But this just replaces native regexes with dynamic regexes under the hood. Moreover, this will cause your program to panic at runtime if an invalid regular expression is given."
[13:33:10] <huon> Mutabah: the compiler tells you it's needed if you drop it
[13:33:17] <Mutabah> huon: Wait, what?
[13:33:17] <mdup> Mutabah: the compiler complains if I don't write <Output=T>
[13:33:28] <Mutabah> huon: Why?
[13:33:30] <huon> Mutabah: [23:31:54] <huon> huh, looks like a bug that the compiler wants Output specified :)
[13:34:04] <Mutabah> Ah, missed that
[13:34:25] <huon> mdup: object safety means that the trait can be used in a trait object, essentially that it makes sense to talk about the trait in type position (like in an impl)
[13:34:36] <huon> mdup: http://huonw.github.io/blog/2015/01/object-safety/
[13:34:56] <huon> mdup: alternate approaches include using default methods in the trait, or using an extension trait
[13:35:14] <Ms2ger> huon, should that be in the book? :)
[13:35:16] <Johannes_> I want to store objects as values in a hashmap where the key is a traitobject. The traitobject is boxed. Are there any built in functions to generate a key? The in some loop I want to iterator through all traitobjects and find the corresponding object in the hashmap and operate on it.
[13:35:23] <huon> mdup: e.g. trait T: Add<Output = Self> { fn some_method(&self) { println!("default") } } for the former
[13:35:25] *** Joins: Diggsey (diggsey@moz-o8tmhf.dsl.pipex.com)
[13:35:53] <huon> mdup: trait TExt { fn some_method(&self); } impl<X: T> TExt for X { fn some_method(&self) { ... } } for the latter
[13:36:21] <huon> Ms2ger: I guess there should be something along those lines there (steveklabnik is free to use what he wants from my blog)
[13:36:23] *** Quits: GladiaTeur (Mibbit@moz-udq.mlj.158.105.IP) (Connection closed)
[13:36:37] *** Joins: oberstet (quassel@moz-llc4ae.dynamic.mnet-online.de)
[13:36:41] <terpstra_> cmr: omg. this is the first time i use dependencies with cargo. that is seriously convenient!
[13:37:05] <mdup> huon: well, thanks for the info. I understand your two workarounds (nice examples!) but I'm not up to speed on the contents of your blog post
[13:37:58] *** Joins: avikpal_ (avikpal@moz-nui.igl.194.117.IP)
[13:38:35] *** Joins: veddan (viktor@moz-9mbv2g.cust6.csbnet.se)
[13:39:05] *** Quits: psy (psy@moz-ous.ntd.6.103.IP) (Ping timeout: 121 seconds)
[13:39:12] <proc> how can I add a type for .into() ?
[13:39:16] *** Quits: avikpal (avikpal@moz-32r.iss.194.117.IP) (Ping timeout: 121 seconds)
[13:39:36] <proc> ( not implementing, declare what I want as output )
[13:39:36] <huon> proc: implement the std::convert::Into trait?
[13:39:39] <huon> oh
[13:39:44] <proc> huon: sry I was unclear
[13:40:06] <huon> let x: Type = y.into();
[13:40:11] <frankmcsherry> huon: is the "no methods with generic params" part of object safety a hard constraint, or is it a "we wouldn't know the vtable size soon enough, so it is hard" problem?
[13:40:14] *** Quits: tav_ (tav@moz-fs0s4r.range31-52.btcentralplus.com) (Ping timeout: 121 seconds)
[13:40:30] <huon> frankmcsherry: the vtable size is unbounded in general
[13:40:33] <proc> huon: .add(xcy.into::<String>()) would it be for me..
[13:40:48] <proc> adding Command::new().arg(..
[13:40:48] <simukis> Into::<String>::into(xcy)
[13:40:50] <huon> frankmcsherry: (e.g. a public trait can be implemented by any number of downstream crates)
[13:41:00] <frankmcsherry> huon: sorry, I don't mean to interrupt, but curious to understand if that is an implementation limitation at the moment, or a reasoning impossibility.
[13:41:03] <huon> frankmcsherry: *types in downstream crates
[13:41:26] *** Joins: }ls{ (uhelp@moz-s80a02.dip0.t-ipconnect.de)
[13:41:37] <huon> proc: in this case, the type parameter is on the trait, not the method, so your syntax desn't quite work, but simukis' should!
[13:41:37] *** Joins: enricostn (enricostn@moz-nsqccj.dynamicIP.rima-tde.net)
[13:42:06] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[13:42:11] <huon> frankmcsherry: I think it's the latter, for the general case
[13:42:12] <proc> simukis, huon : thanks!, trying it out atm 
[13:42:48] *** Joins: psy (psy@moz-ous.ntd.6.103.IP)
[13:42:54] <terpstra_> so, quickcheck does not work with beta
[13:42:55] <frankmcsherry> huon: this particular thing is one of the few places where Rust bites me and I don't know how to work around it.
[13:43:09] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[13:43:21] <terpstra_> . /Users/terpstra/.cargo/registry/src/github.com-1ecc6299db9ec823/quickcheck-0.2.14/src/tester.rs:292:23: 292:24 error: parameter `T` is never used
[13:43:22] <proc> huon: close ;) `the trait `core::convert::From<i64>` is not implemented for the type `collections::string::String`
[13:43:28] <huon> frankmcsherry: it's hard to offer advice without knowing specifics
[13:43:49] <huon> frankmcsherry: (and unfortunately I can't dig in right now, maybe another day)
[13:43:55] <frankmcsherry> huon: right, not asking for advice, just trying to understand the problem. no worries.
[13:45:20] *** Quits: jml (jml@moz-mqpurn.178.in-addr.arpa) (Ping timeout: 121 seconds)
[13:45:29] <huon> frankmcsherry: ah ok; happy to help if you do need advice/someone to bounce ideas off
[13:45:45] <proc> other idea: how can I convert i64 to AsRef OsStr ?
[13:45:54] <frankmcsherry> huon: :D
[13:45:55] <proc> would solve my problem more precise..
[13:46:09] <proc> * AsRef<OsStr>
[13:46:09] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[13:46:35] <huon> proc: what does the i64 represent?
[13:46:52] <huon> do you want a string containing the decimal representation? or the raw bytes of the i64?
[13:47:19] <proc> huon: not sure, should be for http://doc.rust-lang.org/nightly/std/process/struct.Command.html#method.arg
[13:47:33] <simukis> huon: if it was raw bytes, I guess he’d at least use u64.
[13:47:33] <proc> ( and I'm not able to read that from the docs )
[13:47:52] <huon> proc: where are you getting the i64 from?
[13:48:10] *** Joins: jml (jml@moz-mqpurn.178.in-addr.arpa)
[13:48:15] <huon> what sort of argument is it representing?
[13:48:24] <proc> own struct,owning the i64
[13:48:25] <huon> a value to a command like `foo --arg 10`?
[13:48:34] <proc> yeah
[13:48:43] <huon> you'll need to render it to a string
[13:48:55] <huon> e.g. `.arg(your_integer.to_string())`
[13:49:40] <proc> huon: thanks! (I should've tried to use a simple to_string() -.- )
[13:50:14] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[13:50:48] <proc> but forgot the existence of it
[13:51:32] <simukis> proc: well, there’s always format!() if you want to convert anything to string. It is also more configurable.
[13:51:50] <proc> simukis: I know that it exists but it seemed a bit overkill
[13:52:06] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[13:52:22] <Ms2ger> to_string() is exactly format!("{}")
[13:52:24] <proc> (and I don't want to throw a format! at every unknown thing ;) )
[13:52:24] <cmr> .to_string() just calls format!("{}", self) internally
[13:53:28] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[13:53:30] <Nuk9> when I use #![feature(collections)] compiler throws error "unstable feature"
[13:53:53] <Ms2ger> Use nightly
[13:53:56] <Mutabah> Nuk9: You can't use feature flags in beta
[13:54:18] * proc is done with to_string() & format
[13:54:30] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[13:54:50] <Nuk9> Mutabah: then how to use String::from_str in beta?
[13:55:09] <filsmick> Is it bad practice to use env_logger or other in a library crate?
[13:55:10] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Ping timeout: 121 seconds)
[13:55:11] <cmr> Nuk9: you don't have to, you can just use String::from(...)
[13:55:14] <cmr> filsmick: yes.
[13:55:42] <cmr> filsmick: the intent is that executables configure their own logger, and libraries use whatever the executable that embeds them puts in place.
[13:55:42] <filsmick> cmr: alright, so have no logger and return information in the form of Results?
[13:56:26] <filsmick> cmr: can you give me an example?
[13:56:46] <cmr> filsmick: https://github.com/rust-lang/log#usage
[13:57:15] *** Quits: MaxV (MaxV@moz-5rjbeb.abo.wanadoo.fr) (Connection closed)
[13:57:18] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Connection closed)
[13:57:28] <filsmick> cmr: really neat, I didn't know about that. Thank you very much
[13:57:31] <cmr> np
[13:57:46] <terpstra_> wow. this cargo stuff is actually pretty useful.
[13:58:03] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[13:58:13] *** Quits: thiblahute (tsaunier@moz-68f5rr.rev.sfr.net) (Ping timeout: 121 seconds)
[13:58:25] *** Joins: mfs (mike@moz-g35m6n.sda.io)
[14:00:36] <frankmcsherry> is it possible to have cargo cache crates locally? If I want to whip up a new project and don't have net connectivity, for example, what's the intent there?
[14:00:57] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[14:01:33] <cmr> frankmcsherry: as long as you build once with connectivity, you'll be fine.
[14:01:56] <cmr> I think that's the only solution right now
[14:03:18] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[14:06:12] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[14:07:04] *** Joins: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP)
[14:07:39] *** Joins: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net)
[14:07:58] *** Joins: akiss (akiss@moz-l61h32.pool.digikabel.hu)
[14:08:48] *** Joins: hjr3 (hradtke@moz-e235ok.fios.verizon.net)
[14:09:05] *** Joins: Cuga (cuga@moz-6oo.d4n.158.69.IP)
[14:09:27] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[14:09:28] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[14:09:57] *** Joins: nical (nical@moz-jp38c1.lmuk.1rfi.0450.2001.IP)
[14:09:58] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[14:10:20] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[14:11:05] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[14:11:06] *** Joins: cjwelborn (cjwelborn@moz-np6hed.al.charter.com)
[14:11:33] *** Joins: JosiahOne (Instantbird@moz-5fu411.l2d1.q8mm.0306.2602.IP)
[14:13:30] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[14:13:42] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[14:14:10] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Connection closed)
[14:14:45] <proc> can I match a result with a own error enum as Err(OwnError::Type) => do something ?
[14:15:20] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[14:15:37] *** Joins: skade (skade@moz-6athcr.pools.vodafone-ip.de)
[14:15:44] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[14:16:30] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[14:16:48] *** Quits: SneakySnake (nya@moz-i9is4u.pool.telekom.hu) (Quit: Leaving)
[14:17:15] *** Quits: cacaca (Mibbit@moz-aua.g0i.51.193.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:17:27] *** Joins: DemonOne (Avi@moz-b8v6ll.cablep.bezeqint.net)
[14:17:42] *** Quits: sysko1 (bst@moz-qau.e3g.230.116.IP) (Quit: Leaving.)
[14:17:45] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[14:17:53] *** Joins: SneakySnake (nya@moz-i9is4u.pool.telekom.hu)
[14:18:11] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[14:18:54] *** Quits: larhat (Adium@moz-tb1ulb.cable.virginm.net) (Quit: Leaving.)
[14:19:28] *** darkowlzz is now known as darkowlzz|afk
[14:19:45] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[14:19:46] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[14:20:18] *** Quits: akiss (akiss@moz-l61h32.pool.digikabel.hu) (Ping timeout: 121 seconds)
[14:20:34] *** darkowlzz|afk is now known as darkowlzz
[14:20:39] <rkruppe> proc: Have you tried it? In principle that should work
[14:20:43] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[14:20:56] *** Joins: redShadow (redShadow@moz-47mtkq.retail.telecomitalia.it)
[14:20:58] <proc> rkruppe: doesn't work, otherwise I wouldn't bother you :)
[14:21:53] <rkruppe> Good :) Then what's the error message?
[14:22:10] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[14:22:31] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[14:22:36] *** Quits: viel (victorlima@moz-2k31nn.retail.telecomitalia.it) (Quit: I'm gone... c' ya!)
[14:22:39] *** Joins: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it)
[14:22:47] *** Joins: tristanseifert (tristanseif@moz-r0t7ns.res.rr.com)
[14:23:43] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[14:23:43] *** ChanServ sets mode: +o jdm
[14:24:58] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[14:24:59] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[14:25:22] <proc> rkruppe: sec, trying to wipe possibility of own mistakes
[14:25:32] *** Quits: espadrine_ (tyl@moz-imvc7h.capitainetrain.com) (Ping timeout: 121 seconds)
[14:25:34] <proc> *out
[14:25:45] *** Joins: espadrine_ (tyl@moz-l019mn.fbx.proxad.net)
[14:26:45] *** Joins: bombless (_@moz-nd7obr.0v2u.0v40.0da8.2001.IP)
[14:27:21] *** Joins: sjj (sjj@moz-mgjunu.asianet.co.th)
[14:27:35] *** Joins: eerie (eerie@moz-joilui.red.bezeqint.net)
[14:27:39] *** Joins: rfnash (weechat@moz-ulk8um.in.comcast.net)
[14:29:36] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[14:29:41] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[14:31:33] <proc> rkruppe: okay, was my own fail, but wasn't that easy to find ;) ( http://is.gd/bio4de too much match ^^ )
[14:32:18] *** Joins: luz (lucy@moz-0o1u6b.uib.no)
[14:32:21] *** Joins: shawnadelic (shawn@moz-u5o3kk.res.rr.com)
[14:33:30] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Connection closed)
[14:33:39] *** Quits: eerie (eerie@moz-joilui.red.bezeqint.net) (Ping timeout: 121 seconds)
[14:33:56] *** Quits: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP) (Ping timeout: 121 seconds)
[14:34:46] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[14:35:40] *** Joins: Guest (textual@moz-rtn.fg7.77.192.IP)
[14:35:55] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Ping timeout: 121 seconds)
[14:36:06] *** Quits: hjr3 (hradtke@moz-e235ok.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:39:30] *** Quits: arty (Mibbit@moz-ineiim.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:40:03] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[14:40:32] *** Joins: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP)
[14:40:47] *** Quits: Wild_Cat (Max@moz-na0tak.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[14:42:46] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[14:43:03] *** Joins: Wild_Cat (Max@moz-na0tak.dsl.teksavvy.com)
[14:43:47] *** Quits: Guest (textual@moz-rtn.fg7.77.192.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[14:44:08] *** Quits: playjax (chatzilla@moz-53gbdr.optusnet.com.au) (Ping timeout: 121 seconds)
[14:44:12] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[14:44:33] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[14:45:36] *** Joins: erikj (erikj@moz-dsm7da.skybroadband.com)
[14:46:48] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[14:47:26] *** Quits: luz (lucy@moz-0o1u6b.uib.no) (Quit: 04←)
[14:48:09] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[14:51:14] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:51:21] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Connection closed)
[14:52:28] *** Quits: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP) (Ping timeout: 121 seconds)
[14:52:38] *** Quits: miyagi (blabla@moz-hc41h3.dip0.t-ipconnect.de) (Quit: leaving)
[14:53:25] *** Joins: kgrandon (Adium@moz-hn1gb6.hjek.d045.0009.2601.IP)
[14:53:32] *** Quits: kgrandon (Adium@moz-hn1gb6.hjek.d045.0009.2601.IP) (Connection closed)
[14:53:53] *** Joins: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP)
[14:54:23] *** Joins: avikpal (avikpal@moz-e9p.mf2.194.117.IP)
[14:54:31] *** Joins: hjr3 (hradtke@moz-e235ok.fios.verizon.net)
[14:55:45] *** Quits: mdup (mdup@moz-53eisu.abo.wanadoo.fr) (Client exited)
[14:55:59] *** Quits: avikpal_ (avikpal@moz-nui.igl.194.117.IP) (Ping timeout: 121 seconds)
[14:57:25] <enricostn> hi there, I'm getting a mismatched types error https://gist.github.com/enricostano/16d3eb5aff947fe455f6#file-main-rs-L21
[14:57:32] <enricostn> error in the comments
[14:58:04] *** Joins: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net)
[14:58:12] <steveklabnik> enricostn: add a & in front of format
[14:58:23] <enricostn> looking at Os str doc #to_str() should return a &str
[14:58:27] <steveklabnik> printw(&format
[14:58:32] <enricostn> mh
[14:58:36] <steveklabnik> format returns a String
[14:58:54] <steveklabnik> so, you're passing a &str into something that gives a String back
[14:59:10] <steveklabnik> now, because of Deref coercions, &String can coerce to &str
[14:59:22] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[14:59:47] <enricostn> OMG ok, thanks! 
[15:00:00] <steveklabnik> :)
[15:00:02] <steveklabnik> any time
[15:00:04] <phaylon> there's no way to have &mut access to a value but prohibit replacing it, right?
[15:00:18] *** Quits: hjr3 (hradtke@moz-e235ok.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[15:00:25] *** Quits: Johannes_ (Johannes@moz-ufvp1b.nttpc.ne.jp) (Connection closed)
[15:00:27] *** Joins: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk)
[15:00:31] <kimundi> phaylon: right
[15:00:44] <kimundi> phaylon: since its conceptually the same thing
[15:00:59] <phaylon> hm. guess I'll have to do some interior mutability trickery then
[15:01:03] *** Quits: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net) (Connection closed)
[15:01:09] *** Joins: essem2 (Thunderbird@moz-l86scb.sd.cox.net)
[15:01:15] *** Joins: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net)
[15:01:41] *** Quits: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:01:43] <phaylon> kimundi: well, the use case would be a tree of ui widgets with weak parent links. if you just replace it, the new child wouldn't have the parent
[15:01:51] <phaylon> just wanted to make sure :)
[15:01:53] <enricostn> steveklabnik, is there any doc where I can find more thoughts about this? Coming from Ruby it seems a bit confusing for me.
[15:02:44] <kimundi> phaylon: yeah, that sounds like exposing free &mut access at all would be wrong then
[15:03:03] <phaylon> yea, that's what I thought
[15:03:03] *** Joins: sagg (sigg@moz-55rvi2.dclient.hispeed.ch)
[15:03:22] *** Quits: avikpal (avikpal@moz-e9p.mf2.194.117.IP) (Ping timeout: 121 seconds)
[15:03:25] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[15:03:27] <phaylon> plus, separating the mutable state from the fixed tree structure sounds like a good idea anyway
[15:04:02] *** kimundi is now known as zz_kimundi
[15:04:11] *** Joins: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net)
[15:04:15] *** Quits: TheLemonMan (lemonboy@moz-ak2k9f.26-151.libero.it) (Quit: "It's now safe to turn off your computer.")
[15:04:32] *** Joins: aon (Mibbit@moz-8c9.siv.143.78.IP)
[15:05:04] *** Quits: JoeHazzers (joe@moz-dmae2r.joehazzers.com) (Quit: HUE)
[15:05:10] <aon> I am trying to use postgres-macros, but I get a compile error: http://paste2.org/4IOCVGwC
[15:05:14] *** Quits: DemonOne (Avi@moz-b8v6ll.cablep.bezeqint.net) (Connection closed)
[15:05:23] <aon> Any pointers on how to solve this?
[15:05:29] *** Quits: JanC (janc@moz-3oruui.dsl.scarlet.be) (Ping timeout: 121 seconds)
[15:05:45] *** Quits: JosiahOne (Instantbird@moz-5fu411.l2d1.q8mm.0306.2602.IP) (Quit: [self dealloc])
[15:05:56] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[15:06:05] <Ms2ger> So has anyone written an IRC client in Rust yet
[15:06:16] <steveklabnik> erwin: what aspect of it specifically?
[15:06:28] <cmr> Ms2ger: I wrote a line-based no-ui one at some point in the past (~0.6)...
[15:06:29] <steveklabnik> enricostn: ^^^
[15:06:48] <steveklabnik> because there's a few interlocking parts
[15:06:56] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[15:07:21] *** Quits: cjwelborn (cjwelborn@moz-np6hed.al.charter.com) (Quit: sys.exit(1))
[15:07:34] *** Joins: wilma (Mibbit@moz-pt2.8lp.244.50.IP)
[15:08:10] *** Quits: wilma (Mibbit@moz-pt2.8lp.244.50.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:09:30] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[15:09:44] *** Joins: JoeHazzers (joe@moz-70t7sr.r30c.51hn.0bc8.2001.IP)
[15:09:45] <enricostn> steveklabnik, well for instance the difference between String and str (if any XD)
[15:09:47] <cmr> aon: looks like it's supposed to be part of postgres?
[15:09:54] *** Joins: havarnov (Mibbit@moz-ae2rue.254.getinternet.no)
[15:10:13] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[15:10:15] <cmr> aon: oh, never mind; https://github.com/sfackler/rust-postgres-macros/blob/master/src/parser.c
[15:10:37] *** Joins: avikpal (avikpal@moz-5uq.pjb.194.117.IP)
[15:10:53] <steveklabnik> enricostn: i thought it might be :) they are very different!
[15:11:04] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[15:11:09] <steveklabnik> enricostn: check out http://doc.rust-lang.org/nightly/book/strings.html, which is a basic intro
[15:11:16] *** Quits: nyx (nyx@moz-ivelpd.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:11:27] <steveklabnik> and then we can talk about it. i think that page is a bit light at the moment, and curious to see what you think
[15:11:49] <steveklabnik> i'm really interested in hearing about Rubyists and JS and Python people trying Rust
[15:11:51] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[15:12:14] *** Quits: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP) (Quit: WeeChat 1.1.1)
[15:12:41] *** Quits: Altazimuth_ (Altazimuth@moz-rb7u6p.skybroadband.com) (Ping timeout: 121 seconds)
[15:12:46] <enricostn> steveklabnik, thanks! I already read the book months ago but now I'm starting to get my hands dirty with a little project... so I need to read it again I guess XD
[15:13:02] *** Quits: frankmcsherry (frankmcsher@moz-faa086.adsl.alicedsl.de) (Ping timeout: 121 seconds)
[15:13:13] *** Joins: frankmcs_ (frankmcsher@moz-tamqcd.dyn.telefonica.de)
[15:13:16] <steveklabnik> yeah, a lot has changed
[15:13:25] <steveklabnik> and i'm still adding stuff
[15:13:27] <enricostn> cool
[15:13:32] <steveklabnik> a bunch of big PRs got merged last night actually
[15:13:39] *** Quits: skade (skade@moz-6athcr.pools.vodafone-ip.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:13:42] <steveklabnik> so almost all the 'coming soon' parts will be filled in
[15:13:53] <steveklabnik> at least, in Syntax and Semantics. now to work on "Learn Rust"
[15:14:02] <steveklabnik> which, is based on little projects
[15:14:07] <steveklabnik> what did you choose for yours?
[15:14:16] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[15:14:23] *** Joins: jviereck (Adium@moz-4kr158.ethz.ch)
[15:14:36] *** darkowlzz is now known as darkowlzz|afk
[15:14:50] <enricostn> steveklabnik, ok, BTW.. I'm using Beta version of Rust.. should I switch to Nightly?
[15:14:53] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[15:15:39] *** Joins: nott (nott@moz-to4.06o.57.86.IP)
[15:16:07] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[15:16:33] <steveklabnik> generally we reccomend using beta at the moment
[15:16:40] <steveklabnik> and, when stable comes out, stable, obviously
[15:16:42] *** Quits: avikpal (avikpal@moz-5uq.pjb.194.117.IP) (Ping timeout: 121 seconds)
[15:17:01] <steveklabnik> nightly is good if you're interested in experimental features, and don't mind your code not compiling tomorrow
[15:18:08] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[15:18:18] <SneakySnake> I make sure my libraries build on beta/stable, otherwise I use nightly
[15:18:33] *** Joins: JanC (janc@moz-u1ho5m.dsl.scarlet.be)
[15:19:09] <enricostn> ok, I'll stay with Beta for now. I guess that if I find something in the nightly book it should apply to Beta too? Is there an alert when otherwise?
[15:19:28] <steveklabnik> so, right now is a weird moment
[15:19:29] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[15:19:41] <steveklabnik> pre 1.0 releases work a litlte differently than post-1.0 ones
[15:19:59] <steveklabnik> so, basically, i'm going to be backporting all the doc stuff to the beta branch right before release
[15:20:14] <steveklabnik> now, the book itself is organized across 'stable' and 'unstable' features
[15:20:33] <steveklabnik> so, in theory, a nightly build of the book should talk about only stable stuff in the vast majority of it
[15:20:44] <enricostn> ok good
[15:20:51] <steveklabnik> _however_, in the future, when a new feature has become stable on master, but a release hasn't happened, yet, that might not be true
[15:20:57] <steveklabnik> but for now, it is true
[15:22:00] <enricostn> cool, thanks
[15:22:03] *** Quits: Wild_Cat (Max@moz-na0tak.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[15:22:11] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[15:22:26] *** Quits: nott (nott@moz-to4.06o.57.86.IP) (Ping timeout: 121 seconds)
[15:22:28] <steveklabnik> any time
[15:23:13] *** darkowlzz|afk is now known as darkowlzz
[15:23:35] *** Joins: avikpal (avikpal@moz-864.cra.194.117.IP)
[15:23:38] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[15:24:05] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[15:24:05] *** ChanServ sets mode: +o erickt
[15:24:20] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[15:24:32] *** Quits: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP) (Ping timeout: 121 seconds)
[15:26:12] *** Joins: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP)
[15:27:44] *** Quits: sp0 (seth@moz-m97a3k.internode.on.net) (Quit: Lost terminal)
[15:27:58] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[15:28:35] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[15:28:50] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[15:28:57] *** Joins: Gamecubic (cubic@moz-qfrl13.mc.videotron.ca)
[15:29:46] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:29:57] *** Joins: skade (skade@moz-9imj12.dip0.t-ipconnect.de)
[15:30:24] *** Joins: mkpankov` (user@moz-ue5.70f.16.195.IP)
[15:32:47] *** Quits: edlothiol (user@moz-chhfor.hsi02.unitymediagroup.de) (Connection closed)
[15:33:36] *** Quits: Izacht13 (Izacht13@moz-gee645.atsnmeam.ccmaine.net) (Quit: Leaving)
[15:33:40] *** Quits: jviereck (Adium@moz-4kr158.ethz.ch) (Quit: Leaving.)
[15:33:42] *** Quits: orangeshark (erik@moz-pom16t.44tj.56ot.0306.2602.IP) (Quit: Leaving)
[15:33:43] *** Joins: bombless_ (_@moz-1j8.piv.41.59.IP)
[15:34:10] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[15:34:13] *** Quits: bombless (_@moz-nd7obr.0v2u.0v40.0da8.2001.IP) (Ping timeout: 121 seconds)
[15:35:32] *** Quits: avikpal (avikpal@moz-864.cra.194.117.IP) (Ping timeout: 121 seconds)
[15:38:17] *** Joins: mohawk (Mibbit@moz-lvjju6.abo.wanadoo.fr)
[15:38:18] *** Joins: starless (starless@moz-gsr5tg.r6vo.di63.6000.2604.IP)
[15:38:44] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[15:38:57] *** Quits: ptx (ptx@moz-989.5up.104.87.IP) (Ping timeout: 121 seconds)
[15:39:27] *** Quits: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de) (Client exited)
[15:39:28] *** Quits: mohawk (Mibbit@moz-lvjju6.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[15:39:34] *** Joins: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de)
[15:40:00] *** Joins: rbranson (rbranson@moz-oeg7f0.ca.comcast.net)
[15:40:33] *** Quits: rbranson (rbranson@moz-oeg7f0.ca.comcast.net) (Connection closed)
[15:40:38] *** Joins: vodik (simon@moz-86ind4.dedicated.allstream.net)
[15:40:51] *** Joins: ptx (ptx@moz-989.5up.104.87.IP)
[15:41:01] *** Joins: rbranson (rbranson@moz-ga0.9o0.201.199.IP)
[15:41:01] *** Joins: edbond (edbond@moz-8st.7gv.108.109.IP)
[15:42:02] *** Joins: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com)
[15:42:20] <tomaka> grmlblb this "time" crate is a cancer
[15:42:36] <tomaka> everything that requires "gcc" to be installed is a pain for windows users
[15:42:42] <tomaka> please don't do it.
[15:42:50] <sillesta> time needs gcc?
[15:43:01] <sillesta> (what for?)
[15:43:05] <tomaka> yeah
[15:43:07] *** Joins: dlc (dlc@moz-ijetde.res.rr.com)
[15:43:08] *** Quits: aon (Mibbit@moz-8c9.siv.143.78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:43:14] <tomaka> it has a C file that has not been rewritten to rust yet
[15:43:15] <klutzy> to wrap some c functions
[15:43:25] <tomaka> so it uses gcc to compile the C code and then links to it
[15:43:29] <sillesta> oo
[15:43:37] *** Quits: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de) (Ping timeout: 121 seconds)
[15:43:40] <simias> I don't understand why time is not in std
[15:43:42] <sillesta> that seems a bit excessive
[15:43:50] <simias> I think the core team went a bit overboard with that
[15:44:09] <tomaka> I really wish this "time" crate didn't exist
[15:44:12] <simias> there's core functionality that should very much be maintained alongside rustc
[15:44:22] <klutzy> tomaka: pain for plain cmd or msys2? (I do hope everything works on cmd; I'm just checking current status)
[15:44:36] *** Quits: yuja (yuja@moz-3k3neh.so-net.ne.jp) (Ping timeout: 121 seconds)
[15:44:39] <tomaka> the pain is having to install msys2
[15:44:51] <klutzy> hehe, yeah
[15:45:19] *** Joins: yesimon_ (simon@moz-htvp8u.ma.comcast.net)
[15:45:42] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Connection closed)
[15:45:43] *** Joins: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr)
[15:45:49] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[15:46:00] *** Joins: maro (maro@moz-mh984t.highway.telekom.at)
[15:46:02] <tomaka> rustc on windows uses a local mingw, which is awesome
[15:46:17] *** Joins: woboats (tatterdemal@moz-a0dnkb.ca.comcast.net)
[15:46:20] *** Quits: filsmick (filsmick@moz-ekfnpo.abo.wanadoo.fr) (Quit: )
[15:46:25] *** Quits: brainproxy (michael@moz-9vjtig.mo.charter.com) (Ping timeout: 121 seconds)
[15:46:28] *** Joins: jshs (jshs@moz-bp57hc.dip0.t-ipconnect.de)
[15:46:30] <tomaka> but this effort is wasted if you want to use a crate that depends on time
[15:46:53] <klutzy> actually, time may have to be rewritten; currently it depends on gmtime/localtime with $TZ variable, which means platform and locale dependent
[15:47:06] <klutzy> but rewriting implies implementing time zone mess..
[15:47:35] *** Quits: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP) (Ping timeout: 121 seconds)
[15:47:56] <elbow_json> time... only the Mayans ever got it right.
[15:48:15] *** streblo|away is now known as streblo
[15:48:30] <sillesta> travel back in time and make the mayans write the implementation
[15:48:47] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[15:48:50] *** Joins: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP)
[15:52:06] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[15:52:36] *** Joins: Riastradh (riastradh@moz-r9rogb.enn.lu)
[15:54:15] <dwrensha> I'm a bit confused about the Send trait. Apparently ::std::cell::RefCell and ::std::cell:Cell implement it. How is that possible?
[15:54:48] <cmr> dwrensha: why wouldn't it be possible?
[15:55:07] <dwrensha> doesn't that let you alias data accross threads?
[15:55:16] <cmr> RefCell/Cell own their contained data.
[15:55:37] <tomaka> dwrensha: You're thinking of Sync
[15:56:03] <tomaka> dwrensha: Send means that you can move the object to another thread, doesn't mean you can alias it
[15:56:05] <dwrensha> I wasn't thinking of Sync, because I don't quite understand Sync either
[15:56:33] <dwrensha> I guess I was thinking Rc<RefCell> 
[15:56:34] *** Joins: Church (hatter@moz-e031bf.dyn.optonline.net)
[15:57:00] <tomaka> if you want to share a reference to an object between several threads, it has to implement Sync
[15:57:15] <tomaka> if you want to be able to give an object to another thread, it has to implement Send
[15:57:41] <bluss> Cell and RefCell are containers and you can Send them just like you can an Option<T>
[15:57:48] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[15:58:26] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Ping timeout: 121 seconds)
[15:58:26] *** Joins: wenderen (uid34286@moz-9vna9c.charlton.irccloud.com)
[15:58:43] *** Joins: hhhhhhhhhh (mike@moz-969kuj.cable.virginm.net)
[15:58:47] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[15:59:56] *** Quits: veddan (viktor@moz-9mbv2g.cust6.csbnet.se) (Connection closed)
[16:00:56] *** Joins: ebel (rory@moz-0lehdb.m4r4.nqcu.0470.2001.IP)
[16:01:46] *** Joins: yesimon (simon@moz-htvp8u.ma.comcast.net)
[16:02:30] *** Quits: psy (psy@moz-ous.ntd.6.103.IP) (Ping timeout: 121 seconds)
[16:02:34] *** Quits: eibwen (eibwen@moz-dkg8t1.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[16:02:56] *** Quits: dlc (dlc@moz-ijetde.res.rr.com) (Quit: Leaving)
[16:03:01] *** Quits: Cuga (cuga@moz-6oo.d4n.158.69.IP) (Ping timeout: 121 seconds)
[16:03:21] *** Quits: yesimon_ (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[16:03:37] *** Joins: ytain (ytain@moz-ge9fgi.dsl.teksavvy.com)
[16:06:06] *** Joins: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net)
[16:06:08] <proc> is there already a function to move & rename a file, or am I missing something ?
[16:06:35] *** Quits: edbond (edbond@moz-8st.7gv.108.109.IP) (Ping timeout: 121 seconds)
[16:06:52] *** Joins: Selemur (chatzilla@moz-tpgfbn.kawo1.rwth-aachen.de)
[16:06:59] <proc> nvm, I'm blind
[16:07:43] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[16:08:18] <bluss> looks like std::fs::soft_link is stable but deprecated and will be relased in Rust 1.0
[16:08:30] <proc> nope, rename function found, but not a move_file function or something equally
[16:08:36] <bluss> that's silly
[16:09:01] <bluss> proc: can rename move a file though?
[16:09:12] <proc> bluss: checking that atm :D
[16:09:21] <proc> would make sense
[16:09:38] *** darkowlzz is now known as darkowlzz|afk
[16:09:47] <cmr> moving is renaming.
[16:10:00] <proc> cmr: would add that to http://doc.rust-lang.org/nightly/std/fs/fn.rename.html
[16:10:03] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:11:03] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[16:11:50] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[16:12:01] <SneakySnake> I make sure my libraries build on beta/stable, otherwise I use nightly
[16:12:03] <SneakySnake> oops
[16:12:35] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[16:12:43] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Quit: )
[16:12:48] *** Quits: sagg (sigg@moz-55rvi2.dclient.hispeed.ch) (A TLS packet with unexpected length was received.)
[16:13:12] *** Joins: Havvy (Havvy@moz-aas.m8a.237.67.IP)
[16:13:33] <proc> cmr: is it planned to implement rename for file also ? passing a string is okay, but simply passing a verified file is nicer sometimes
[16:13:44] *** Joins: nott (nott@moz-to4.06o.57.86.IP)
[16:14:01] <cmr> proc: that's just not how the system APIs work. rename takes a path.
[16:14:20] *** Joins: Twinklebear (Twinklebear@moz-ttrcn3.ut.comcast.net)
[16:14:36] <cmr> (also note that rename only works in a single filesystem/volume; otherwise you need to copy/delete.)
[16:15:06] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[16:15:13] <proc> cmr: I'm sorry, was mislead through the string-passing in the example of rename
[16:15:29] *** Quits: nicoch (nicoch@moz-g02d7k.be) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:15:56] <proc> cmr: okay, but that's fine for me, server hardware handles the raid :)
[16:16:57] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[16:17:52] *** darkowlzz|afk is now known as darkowlzz
[16:18:45] *** Quits: bombless_ (_@moz-1j8.piv.41.59.IP) (Ping timeout: 121 seconds)
[16:18:56] *** Joins: mkpankov (user@moz-ue5.70f.16.195.IP)
[16:19:01] *** Quits: nott (nott@moz-to4.06o.57.86.IP) (Ping timeout: 121 seconds)
[16:19:10] *** Quits: mkpankov (user@moz-ue5.70f.16.195.IP) (A TLS packet with unexpected length was received.)
[16:19:10] *** Joins: Wraithan (wraithan@moz-f8n.3ki.236.104.IP)
[16:19:13] *** Quits: mkpankov` (user@moz-ue5.70f.16.195.IP) (A TLS packet with unexpected length was received.)
[16:19:27] *** Joins: mkpankov (user@moz-ue5.70f.16.195.IP)
[16:19:29] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[16:19:46] *** Joins: sagg (sigg@moz-55rvi2.dclient.hispeed.ch)
[16:20:02] <mkpankov> hi
[16:20:30] <mkpankov> if I want an event to be added to Calendar on Rust's home page, what do I do?
[16:21:04] <klutzy> mkpankov: add a comment here? http://users.rust-lang.org/t/rust-1-0-launch-event-details-action-required-for-event-organizers/1025
[16:21:44] <Wraithan> http://doc.rust-lang.org/std/fs/struct.Metadata.html#method.permissions -- Only appears to have read only, is there a way from rust to determine if a file is executable?
[16:22:12] <mkpankov> klutzy: thanks!
[16:22:26] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[16:22:58] *** Joins: minot2 (kkus@moz-baj4jj.74.srtnet.com)
[16:23:06] <cmr> Wraithan: not portably, but you can use the Windows or Unix-specific extension methods for it.
[16:23:21] <Wraithan> I should specify that I'm sticking to the beta so the os::unix stuff isn't available
[16:23:23] *** Joins: yesimon_ (simon@moz-htvp8u.ma.comcast.net)
[16:23:23] *** Joins: DerisiveLogic (smuxi@moz-g93io6.res.rr.com)
[16:23:41] *** Quits: havarnov (Mibbit@moz-ae2rue.254.getinternet.no) (Quit: http://www.mibbit.com ajax IRC Client)
[16:23:49] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[16:23:50] *** Quits: yesimon (simon@moz-htvp8u.ma.comcast.net) (Ping timeout: 121 seconds)
[16:23:51] <Wraithan> http://doc.rust-lang.org/std/os/unix/fs/trait.PermissionsExt.html 
[16:23:54] <Wraithan> Unstable :/
[16:24:09] *** Joins: KLP (KLP@moz-qdcjho.res.rr.com)
[16:25:55] *** Joins: edlothiol (user@moz-chhfor.hsi02.unitymediagroup.de)
[16:26:20] *** Joins: squiddy (squiddy@moz-5pd6hi.dyn.telefonica.de)
[16:26:48] <rkruppe> Wraithan: as_raw_fd() is stable, so maybe you could use a C API?
[16:27:04] *** Quits: erikj (erikj@moz-dsm7da.skybroadband.com) (Ping timeout: 121 seconds)
[16:27:06] <KLP> How do you access the iterator in a for loop? I'm having trouble using `.peekable()`
[16:27:31] <bluss> KLP: you can't do that. You can however replace the for loop with a  while let Some(elt) = iter.next() {  loop
[16:27:31] <cmr> KLP: use `while Some(foo) = iter.next() {` instead of for.
[16:27:33] <Wraithan> rkruppe: hmm yea, that'd work. Might just find a different path
[16:27:34] *** Joins: Guest74 (textual@moz-dk7dkc.east.verizon.net)
[16:28:20] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[16:28:31] *** Quits: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:28:36] <KLP> bluss, @smr: ok and then make the iterator before the while?
[16:28:48] <bluss> yes
[16:29:29] *** darkowlzz is now known as darkowlzz|afk
[16:29:42] *** tiffany is now known as Tiffany
[16:30:28] <enricostn> has anybody used ncurses menus in Rust? I'm looking at ncurses-rs but it seems menu lib is not included
[16:31:21] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[16:31:41] *** Joins: JagaJaga (JagaJaga@moz-ua8.hhl.62.178.IP)
[16:31:48] *** Joins: Hannibal_Smith (nico@moz-ucg29b.retail.telecomitalia.it)
[16:32:16] *** Quits: KLP (KLP@moz-qdcjho.res.rr.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[16:32:31] *** Quits: shawnadelic (shawn@moz-u5o3kk.res.rr.com) (Quit: leaving)
[16:33:07] *** Joins: KLP (KLP@moz-qdcjho.res.rr.com)
[16:33:37] *** Quits: Riastradh (riastradh@moz-r9rogb.enn.lu) (Ping timeout: 121 seconds)
[16:33:59] <KLP> bluss: @cmr: thanks, that worked
[16:34:02] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[16:35:20] *** Joins: psy (psy@moz-ous.ntd.6.103.IP)
[16:36:20] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[16:36:29] *** Joins: jeffs (Mibbit@moz-dfeivt.res.rr.com)
[16:36:37] *** Joins: fengshaun (fengshaun@moz-rf0qk5.cable.teksavvy.com)
[16:36:41] *** Joins: DemonOne (Avi@moz-o65j06.red.bezeqint.net)
[16:37:18] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[16:37:29] *** Quits: jwatt (roslea@jwatt.irc.users.mozilla.org) (Ping timeout: 121 seconds)
[16:39:29] *** Quits: enricostn (enricostn@moz-nsqccj.dynamicIP.rima-tde.net) (Ping timeout: 121 seconds)
[16:39:45] <Wraithan> Wow, no is_dir or is_file in beta either: https://doc.rust-lang.org/std/fs/trait.PathExt.html#tymethod.is_dir
[16:39:47] *** Joins: erikj (erikj@moz-dsm7da.skybroadband.com)
[16:39:49] <Wraithan> :/
[16:40:02] <Wraithan> Going to just have to do system calls :/
[16:40:17] *** Quits: jeffs (Mibbit@moz-dfeivt.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:40:23] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Ping timeout: 121 seconds)
[16:40:36] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Connection closed)
[16:41:07] *** Quits: juanfra (juanfra@moz-hs9.q8p.76.84.IP) (Client exited)
[16:41:37] *** Joins: juanfra (juanfra@moz-hs9.q8p.76.84.IP)
[16:42:37] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[16:46:58] <catern> am I right in thinking that memory addresses are (ideally?) alpha-equivalent? if I am right, is there a relationship between that fact and the problems with pointer aliasing, and/or things like the ownership rules in Rust?
[16:48:29] *** Quits: brandonw (brandonw@moz-36sv6k.ma.charter.com) (Quit: leaving)
[16:48:39] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[16:49:00] *** Quits: sjj (sjj@moz-mgjunu.asianet.co.th) (Connection closed)
[16:49:04] *** Joins: brandonw (brandonw@moz-36sv6k.ma.charter.com)
[16:50:04] <rkruppe> catern: Yes, for language semantics it shouldn't matter how allocations are labeled/addressed
[16:50:12] <rkruppe> If that's what you mean by alpha-equivalent
[16:50:21] *** Joins: avikpal (avikpal@moz-cpv.qej.98.59.IP)
[16:50:56] *** Quits: Hannibal_Smith (nico@moz-ucg29b.retail.telecomitalia.it) (Quit: Leaving)
[16:51:49] *** Joins: Heejong (uid59097@moz-c67ecd.brockwell.irccloud.com)
[16:52:07] *** Quits: Guest74 (textual@moz-dk7dkc.east.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:52:09] <Heejong> hi guys
[16:52:13] <erikj> If I want to call a C function that accepts an enum, can I get rust to "import" that enum from C? Or is that just completely not how FFI works?
[16:52:43] <talchas> you have to retype it
[16:52:47] <Heejong> I found a little typo in rust book but cannot find where should I report it. Can you help me with it?
[16:52:56] <talchas> (or have things like rust-bindgen.py do it for you)
[16:53:28] <rkruppe> Heejong: Doc bug reports go in the normal issue tracker
[16:53:29] <steveklabnik> Heejong: the main repo!
[16:53:43] <steveklabnik> Heejong: a PR would also be wonderful, if you feel like doing that. source is in src/doc/trpl
[16:53:46] <Zoxc> How do you get a slice of all charaters, but the first of a str?
[16:53:53] <steveklabnik> Zoxc: define 'character'
[16:53:56] <Heejong> aiight thanks guys!
[16:54:06] <steveklabnik> do you want a grapheme, a codepoint, or a byte?
[16:54:31] *** Joins: mzabaluev (Thunderbird@moz-3bijqs.bb.dnainternet.fi)
[16:54:32] <Zoxc> Probably whatever chars().next().unwrap() returns
[16:54:33] <erikj> talchas: Ooh, didn't know about rust-bindgen.py, thanks :)
[16:54:37] *** Quits: brainproxy (michael@moz-9vjtig.mo.charter.com) (Ping timeout: 121 seconds)
[16:54:50] <steveklabnik> that's codepoints
[16:54:53] <cmr> What's rust-bindgen.py? I only know of crabtw's.
[16:55:09] <steveklabnik> i would do something like
[16:55:19] *** Joins: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net)
[16:55:23] *** Quits: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it) (Ping timeout: 121 seconds)
[16:55:29] <catern> rkruppe: then is there a relationship between the alpha-equivalence of memory-addresses and things like the problems with pointer aliasing/the ownership rules in Rust?
[16:56:11] <steveklabnik> ehhhh that's actually really awkward to do right now. no allocations? it's not bad with an intermediate String
[16:56:20] <cmr> catern: what does alpha-equivalence of addresses even mean?
[16:56:41] <talchas> it's not /that/ bad, right?
[16:56:53] <rkruppe> catern: I don't think so. The memory addresses are irrelevant, but aliasing is when two variables store the same address.
[16:56:55] <Zoxc> steveklabnik: No allocations would be nice, but a String works too
[16:57:01] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[16:57:01] *** ChanServ sets mode: +o erickt
[16:57:22] <talchas> it's like str[str.char_indicies().nth(1).unwrap().0..] at worst, and iirc there was a slightly better way
[16:57:28] <catern> cmr: I don't know, that you can change a pointer to point at something else everywhere and everything behaves identically?
[16:57:30] <bluss> Zoxc: just find the byte offset of the second char in the string and slice from there
[16:57:41] <talchas> (which is fairly ugly admittedly)
[16:57:48] <bluss> Zoxc: like talchas solution just write it in some way to be.. nicely readable
[16:57:48] <Zoxc> bluss: Sounds unsafe. I want valid UTF8 =P
[16:57:58] <bluss> Zoxc: well, it's not
[16:57:59] <rkruppe> str.chars().next().unwrap().len_utf8() ?
[16:58:13] <steveklabnik> Zoxc: my first thought is basically http://is.gd/3Yuhjd, and you can just & the String to get a &str
[16:58:29] <catern> rkruppe: yeah, but then if you have two variables with different names pointing at the same memory, that sounds a little like breaking alpha-equivalence
[16:58:41] <talchas> yeah, there's a couple of ways to get the index of the second codepoint, I just don't remember the names and doc.rust is down
[16:58:42] *** darkowlzz|afk is now known as darkowlzz
[16:58:45] <bluss> you don't need to allocate a new String when all you want is a substring
[16:58:48] <steveklabnik> ahh yeah, but talchas is right with char_indicies though
[16:58:50] <Zoxc> steveklabnik: DNS errors on play :(
[16:58:51] <rkruppe> catern: Okay, so you meant something different than I
[16:58:55] <talchas> (or if they're unstable)
[16:59:00] <rkruppe> Local docs ftw
[16:59:36] <rkruppe> catern: But I'm not sure what alpha equivalence for *pointer variables* could mean, other than what it means for all other variables (and that has zero interaction with aliasing)
[17:00:04] *** Quits: DemonOne (Avi@moz-o65j06.red.bezeqint.net) (Quit: Leaving)
[17:00:32] *** Joins: kmcguire (kmcguire@moz-c955nf.res.rr.com)
[17:00:33] <steveklabnik> Zoxc: huh odd. basically, calling next on the interator and then collecting the rest
[17:00:49] <steveklabnik> doc.rust-lang. is up for me
[17:01:45] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[17:01:48] *** Quits: avikpal (avikpal@moz-cpv.qej.98.59.IP) (Connection closed)
[17:02:09] *** Joins: avikpal (avikpal@moz-cpv.qej.98.59.IP)
[17:04:54] *** Joins: Jesse (jruderman@moz-pqc1f5.ca.comcast.net)
[17:05:03] *** Quits: mkpankov (user@moz-ue5.70f.16.195.IP) (Ping timeout: 121 seconds)
[17:05:24] <qrlpx> could it be that `impl<A, B = A> ...` isn't working as of now?
[17:05:24] <qrlpx> http://is.gd/6nIduD I've expected it to default to `Sub = F`, when I specify that `Main = F`, but for some reason it still asks for `Sub`.
[17:05:41] *** Quits: Ms2ger (Ms2ger@moz-15i.9ho.190.193.IP) (Quit: nn)
[17:06:57] <Gliptic> qrlpx, I don't see how it makes sense to have a default template parameter on an impl
[17:07:01] <rkruppe> qrlpx: What would default type parameters even mean in an *impl*?
[17:07:11] <Gliptic> not sure why it doesn't error on that
[17:07:21] <Gliptic> ehm, type parameter
[17:07:52] <tbelaire> When working on the compiler, is there a nice way to cut down on the compile times
[17:08:11] *** Joins: jr (jr@moz-b0t.d7i.1.177.IP)
[17:08:13] <tbelaire> I don't want to wait forever for all the stages to recompile
[17:08:16] *** Parts: jr (jr@moz-b0t.d7i.1.177.IP) ()
[17:08:25] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[17:08:29] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[17:08:31] *** Joins: noblehelm (jr@moz-b0t.d7i.1.177.IP)
[17:08:33] <tbelaire> if I'm just testing something in the frontend
[17:08:42] <tbelaire> I'd be happy to only recomile stage3 or something
[17:09:06] *** Joins: jonh (jhigdon@moz-qiq803.ieqc.6fdm.3c03.2600.IP)
[17:09:21] <tbelaire> I'm just trying to add a new error message, and it's taking forever to test when I make mistakes
[17:09:41] <tbelaire> though it does halt right away if I have a compile error
[17:09:47] <Murarth> tbelaire: I don't think you can recompile only stage3, but you can recompile only stage1. `make rustc-stage1`
[17:10:06] <rkruppe> Though of course that won't run your new front-end code on anything, just compile it
[17:10:18] <rkruppe> You can stop at stage2 though
[17:10:28] <Murarth> True. There's a test target for stage1, too, I believe.
[17:10:46] <Murarth> `make tips` should tell you what it is.
[17:10:46] <rkruppe> Yes, that saved me a lot of time already
[17:10:51] *** Quits: Matthias247 (Miranda@moz-49li60.hsi14.kabel-badenwuerttemberg.de) (Connection closed)
[17:11:16] *** Joins: ekiwi (kevin@moz-a2becv.halifax.rwth-aachen.de)
[17:12:05] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[17:12:07] <tbelaire> Great, thanks
[17:12:08] <rkruppe> Scratch what I wrote above, if you run the stage1 tests, your new frontend code will see all the compile-test tests
[17:12:37] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[17:12:38] *** Quits: noblehelm (jr@moz-b0t.d7i.1.177.IP) (Ping timeout: 121 seconds)
[17:12:50] *** darkowlzz is now known as darkowlzz|afk
[17:13:19] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[17:13:26] *** Joins: cjwelborn (cjwelborn@moz-np6hed.al.charter.com)
[17:13:31] <tbelaire> Does NO_REBUILD=1 do what I want?
[17:15:28] <qrlpx> Gliptic: A and B are marker-types, which limit the functionality of my types. View<Selection1> provides a certain subset of functionalities, Access<Subselction> narrows it further down//allows View's to be used generically.
[17:15:28] <qrlpx> rkruppe: I want `Access<A>` to be implemented for `View<B>`, regardless of A and B. so when I have View<B> and I call an Access-method on it, it should assume that I want Access<B> when A = B.
[17:15:43] <qrlpx> *Access<SubSelection1>.
[17:15:46] *** Joins: Caspy7 (chatzilla@moz-q45ho1.6qgi.ef7f.0306.2602.IP)
[17:15:55] <rkruppe> tbelaire: I'm not sure, maybe ask in #rust-internals
[17:16:13] *** Quits: avikpal (avikpal@moz-cpv.qej.98.59.IP) (Connection closed)
[17:16:27] <rkruppe> qrlpx: So how is that different from impl<A, B>?
[17:17:05] <Gliptic> qrlpx, I don't get it, B will always be A, there is no way to override B
[17:17:28] *** Quits: johnz133 (johnz133@moz-tqd.4t0.72.208.IP) (Ping timeout: 121 seconds)
[17:17:29] *** Quits: khades (Thunderbird@moz-u45.3vk.74.212.IP) (Client exited)
[17:17:37] *** Joins: khades (Thunderbird@moz-u45.3vk.74.212.IP)
[17:18:22] *** Quits: mystal (mystal@moz-tt1.co9.14.76.IP) (A TLS packet with unexpected length was received.)
[17:19:27] *** Joins: eerie (eerie@moz-298.sp6.66.109.IP)
[17:19:40] *** Joins: chc4 (chc4@moz-pdo0at.ma.comcast.net)
[17:20:04] *** Joins: meh (meh@moz-p5gc2m.42-151.net24.it)
[17:20:06] *** Joins: Wild_Cat (Max@moz-na0tak.dsl.teksavvy.com)
[17:20:36] <qrlpx> rkruppe: when `impl<A, B> Access<A> for View<B>`, and you call an Access-method on View<B>, which provides in it's method-signature no information about A, then there is no way for the compiler to deduce A. `impl<A, B = A>` should solve this.
[17:20:42] *** Quits: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP) (Ping timeout: 121 seconds)
[17:21:17] *** Joins: dfinninger (dfinninger@moz-6a9v7n.res.rr.com)
[17:21:24] <rkruppe> qrlpx: So a hint for type inference? I don't think you can have user-defined fallbacks like that (yet)
[17:21:26] <qrlpx> Gliptic: B can be anything (for now), but if B isn't specified, it should use A. that's how I expect default-params to work
[17:21:49] *** Joins: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP)
[17:22:10] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[17:22:16] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[17:23:01] *** Joins: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de)
[17:23:08] <Zoxc> What do Index<ranges> do for str? and why is there no Index<usize>?
[17:23:17] <qrlpx> rkruppe: yea, those are the right terms ;3 thanks for that, then I'll be on the lookout on /rfcs/ for now
[17:23:37] *** Quits: winding-lines (textual@moz-9utvl5.frokca.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:23:55] <bluss> Zoxc: those are for the &foo[a..b], &foo[a..], &foo[..b] and &foo[..] syntax
[17:24:06] <gsingh93> so I have a large project that's causing a compiler ICE, but I don't have time to figure out exactly what code is causing it and create a minimum example
[17:24:08] <gsingh93> is it worth reporting?
[17:24:15] <steveklabnik> try creduce?
[17:24:19] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[17:24:22] <bluss> Zoxc: indexing a str would only meaningfully provide the byte at a byte index which is confusing and wrong unfortunately
[17:24:36] *** Joins: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP)
[17:24:39] <Zoxc> bluss: How is indexing different from using ranges?
[17:24:41] <rkruppe> bluss: Confusing, sure, but how could it be wrong?
[17:24:49] <bluss> Zoxc: slicing operates with byte offsets too, which in turn you normally receive from using interrogator functions
[17:25:20] <bluss> rkruppe: well you might figure you can cast them to char manually, which works for some common values but is wrong
[17:25:22] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[17:25:26] <bluss> rkruppe: so confusing is it, I guess
[17:25:49] <bluss> Zoxc: the return value is different. slicing a &str yields a &str
[17:26:09] <Zoxc> Can't you get an invalid str using slicing?
[17:26:11] <bluss> playbot: &"αβγ"[2..]   // byte offset required
[17:26:13] -playbot- "\u{3b2}\u{3b3}"
[17:26:21] <rkruppe> bluss: What I'm talking about is str[i] giving me the char that starts at byte i. What would be casted to char in your mind?
[17:26:23] <bluss> Zoxc: no, but it panics on invalid offsets
[17:26:26] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[17:26:49] *** Joins: james4k (james@moz-ao8aj6.consolidated.net)
[17:26:52] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[17:26:54] <bluss> rkruppe: That sounds like a good idea to me, I was thinking of returning the byte at that point
[17:26:56] <talchas> rkruppe: that's impossible
[17:27:08] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[17:27:09] <talchas> the char doesn't exist in memory and Index returns a reference
[17:27:10] <bluss> ah right, it's impossible with current Index traits
[17:27:13] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[17:27:21] <rkruppe> talchas: OOOH right, that was the reason
[17:27:39] <Gliptic> it could return a &str of that one character
[17:28:01] <Gliptic> but maybe not very useful
[17:28:02] <Zoxc> Is there a method that gives the char at the byte index then?
[17:28:12] <bluss> Zoxc: .char_at
[17:28:16] <rkruppe> char_at is unstable, unfortunately
[17:28:26] <rkruppe> You can do s[i..].chars().next().unwrap()
[17:28:35] *** Joins: mib_r5ehai (Mibbit@moz-dihs1m.dyn.telefonica.de)
[17:28:48] *** Quits: mib_r5ehai (Mibbit@moz-dihs1m.dyn.telefonica.de) (Quit: http://www.mibbit.com ajax IRC Client)
[17:28:49] <bluss> well with a heavy hand Rust is telling you to use iterators :)
[17:28:51] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[17:29:02] *** Joins: aon (Mibbit@moz-8c9.siv.143.78.IP)
[17:29:03] <bluss> not for one off stuff like that, but using char_indices and so on in general
[17:29:30] *** Joins: hjr3 (hradtke@moz-e235ok.fios.verizon.net)
[17:29:41] *** Quits: sillesta (sillesta@moz-501od2.business.telia.com) (A TLS packet with unexpected length was received.)
[17:29:45] <Zoxc> thread '<main>' panicked at 'arithmetic operation overflowed' :D that's new
[17:29:52] *** Quits: KLP (KLP@moz-qdcjho.res.rr.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[17:30:02] *** Quits: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu) (Quit: Leaving)
[17:30:10] <steveklabnik> yeah, overflow checks are on in debug builds
[17:30:14] <Zoxc> WindowsBunny: Now I just need stack traces. Why don't we have those on Windows?
[17:30:14] <rkruppe> char_indices is good, but if I don't need the chars (e.g. because I take only slices), I'd rather work with byte indices directly
[17:30:16] <steveklabnik> non-debug is two's compliment wrapping
[17:30:18] *** Joins: sillesta (sillesta@moz-501od2.business.telia.com)
[17:30:57] *** Joins: qard (qard@moz-nekdha.vc.shawcable.net)
[17:31:05] *** Quits: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:31:15] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[17:31:51] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[17:32:04] <terpstra_> i see that Vec<T>.truncate does not reduce capacity. this is useful to me, but can i rely on that?
[17:32:10] *** Quits: reed (reed@tech.monkey) (RecvQ exceeded)
[17:32:12] <frankmcs_> is anything known about the likely stability of vec::drain() ?
[17:32:20] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[17:32:26] <steveklabnik> terpstra_: yes, that's its purpose in life
[17:32:33] <steveklabnik> frankmcs_: hopefully stable soonish
[17:32:37] *** Joins: reed (reed@tech.monkey)
[17:32:38] <terpstra_> steveklabnik: great. thanks!
[17:32:40] <frankmcs_> steveklabnik: <3!
[17:32:48] <terpstra_> maybe the documentation should be updated to reflect this guarantee
[17:33:17] <steveklabnik> terpstra_: yeah, i'd support beefing it up with that
[17:34:05] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (A TLS packet with unexpected length was received.)
[17:34:30] <terpstra_> drain also leaves capacity alone?
[17:34:49] <steveklabnik> yup
[17:35:14] *** Joins: mkpankov (user@moz-j8c.fu0.69.83.IP)
[17:35:17] <terpstra_> that’s very nice! :)
[17:35:30] <frankmcs_> terpstra_: because I complained! :D 
[17:37:12] <terpstra_> do i really need to reintall rust in order to get beta to let me use unstable features?
[17:37:20] *** Quits: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:37:23] <terpstra_> there’s not a config file or something i can poke?
[17:37:32] <bluss> you can't get the beta to do it at all
[17:37:38] <proc> terpstra_: eh you need to install nightly to use unstable things, or am I missing something ?!
[17:37:48] <bluss> terpstra_: don't think so. maybe someone has a hack hehe ^^
[17:37:52] <burntsushi> terpstra_: i'd recommend multirust.
[17:37:58] <proc> yep
[17:37:59] <terpstra_> multirust ?
[17:38:05] *** Quits: oberstet (quassel@moz-llc4ae.dynamic.mnet-online.de) (Connection closed)
[17:38:06] <geofft> . o O { compiler plugin that uses `unsafe` to patch the memory of the beta compiler and turn it into a nightly compiler } 
[17:38:13] <proc> terpstra_: https://github.com/brson/multirust
[17:38:16] <terpstra_> lol
[17:38:18] <burntsushi> terpstra_: it's not well advertised, but it's a shell utility for managing multiple local installs of rust.
[17:38:19] <mkpankov> terpstra_: https://github.com/brson/multirust
[17:38:25] <cmr> geofft: no plugins in stable ;)
[17:38:25] * Zoxc doesn't see a Windows installer
[17:38:30] <steveklabnik> Zoxc: not possible on windows
[17:38:35] <geofft> cmr: foiled again! :) 
[17:38:36] <steveklabnik> Zoxc: err, not supported yet, rather
[17:38:50] *** Quits: essem2 (Thunderbird@moz-l86scb.sd.cox.net) (Client exited)
[17:38:59] <Zoxc> nightly ftw then :)
[17:39:34] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[17:39:54] *** Joins: Brochacho (alberto@moz-b2ovno.cable.rcn.com)
[17:40:20] *** Joins: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net)
[17:40:42] <geofft> is there a better way to go from a C string to a Result<&str> than str::from_utf8(unsafe {ffi::CStr::from_ptr(s)}.to_bytes())? 
[17:40:51] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[17:40:51] *** Quits: jpf (jpf@moz-7ui6lj.org) (Ping timeout: 121 seconds)
[17:41:01] *** rkruppe_ is now known as rkruppe
[17:41:29] *** Joins: chc4 (chc4@moz-pdo0at.ma.comcast.net)
[17:42:27] <frankmcs_> grawr! can I pay someone to make || { my_struct.field.func() } not try and capture a reference to my_struct?
[17:42:30] *** Quits: eerie (eerie@moz-298.sp6.66.109.IP) (Connection closed)
[17:42:37] <jonh> as i get older this color error output is like so nice :P
[17:42:54] <bluss> frankmcs_: how much do you want to pay for the move keyword?
[17:43:02] <frankmcs_> erm, by which I mean, the fact that I have an exclusive borrow on my_struct.field2 shouldn't get in the way
[17:43:05] <geofft> hm, does { let f = my_struct.field; || { f.func() } } do what you want? 
[17:43:11] *** Joins: eerie (eerie@moz-298.sp6.66.109.IP)
[17:43:14] <geofft> maybe not. 
[17:43:27] *** Quits: Jesse (jruderman@moz-pqc1f5.ca.comcast.net) (Client exited)
[17:43:46] <frankmcs_> geofft: it does, I think. but, it takes something that was a lot shorter and makes it sort of gross (this is being done to support "nice and ergo user code" )
[17:43:48] <proc> frankmcs_: paying in edibles ? ;)
[17:44:04] <frankmcs_> geofft: let f = &my_struct.field, I think.
[17:44:08] *** Quits: jml (jml@moz-mqpurn.178.in-addr.arpa) (Ping timeout: 121 seconds)
[17:44:11] *** Joins: eerie_ (eerie@moz-298.sp6.66.109.IP)
[17:44:13] <geofft> ah, yes 
[17:44:18] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[17:44:50] <frankmcs_> I am trying to be a good goat and follow "composition over inheritance", but the composed thing I'm handing back has some fields, and you can't use too many at once. T.T
[17:44:55] *** Quits: cjwelborn (cjwelborn@moz-np6hed.al.charter.com) (Quit: sys.exit(1))
[17:45:01] *** Quits: eerie (eerie@moz-298.sp6.66.109.IP) (Connection closed)
[17:45:14] *** Quits: ajitk (ajit@moz-6ht.i8n.51.106.IP) (Ping timeout: 121 seconds)
[17:45:40] <frankmcs_> for datum in handle.input.next() { handle.output.send(datum); }  // <-- failure.
[17:46:50] <frankmcs_> sorry, it's more complicated than that, but ... 
[17:47:17] <Brochacho> There any RFCs for errno?
[17:47:39] *** Joins: Jesse (jruderman@moz-pqc1f5.ca.comcast.net)
[17:47:41] *** Parts: elbow_json (elbow@moz-vtr.tk4.30.50.IP) ("Leaving")
[17:49:06] <steveklabnik>  https://github.com/rust-lang/rfcs/search?q=errno&type=Issues&utf8=%E2%9C%93
[17:49:07] *** Quits: eerie_ (eerie@moz-298.sp6.66.109.IP) (Connection closed)
[17:49:09] <steveklabnik> doesn't look like it
[17:49:19] *** Joins: eerie (eerie@moz-298.sp6.66.109.IP)
[17:49:45] <steveklabnik> not exactly the greatest interface
[17:49:59] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[17:50:06] <geofft> if I'm writing a macro that uses some items from an extern crate, is the best strategy to `pub use` those items and call them `$crate::thing`? 
[17:50:27] <geofft> (since I don't know if that macro caller will have the `extern crate` statement) 
[17:50:44] <mkpankov> Brochacho: what are your thoughts?
[17:50:46] *** Joins: rustyrazorblade (rustyrazorb@moz-ehrfqf.fios.verizon.net)
[17:51:04] <mkpankov> (I'd rather not deal with errno in Rust at all)
[17:51:38] <geofft> mkpankov: well, there's the use case of people (like me) trying to write ABI-compatible replacements for C libraries. 
[17:51:41] *** Joins: areski (areski@moz-prr0dt.user.ono.com)
[17:51:42] <Brochacho> mkpankov: It's somewhat necessary for setting exit status, unless current Errors do that already
[17:51:45] *** Quits: Jesse (jruderman@moz-pqc1f5.ca.comcast.net) (Client exited)
[17:51:51] <geofft> but maybe we get to make our own bed before lying in it. 
[17:52:06] *** Joins: johnz133 (johnz133@moz-tqd.4t0.72.208.IP)
[17:52:12] <geofft> Brochacho: exit status as in return value of the process? that's not related to errno, at least on GNU, is it? 
[17:52:20] <steveklabnik> Brochacho: http://doc.rust-lang.org/nightly/std/process/fn.exit.html <-
[17:52:22] *** Joins: tamird (textual@moz-oii9i6.ca.comcast.net)
[17:52:29] <mkpankov> geofft: sure, I mean just we should try to get away from errno if we can :)
[17:52:30] *** Joins: jml (jml@moz-et2.8uj.238.178.IP)
[17:52:42] <geofft> there _is_ an unstable Rust global with errno-like problems for exit status after normal exit 
[17:52:52] <mkpankov> Brochacho:         process::exit(1);
[17:52:52] <mkpankov>  
[17:52:55] <geofft> but it isn't libc's / POSIX's errno variable, and the error codes are different 
[17:52:58] <Brochacho> stevedomin: Still need to set errno no?
[17:53:04] <Brochacho> mkpankov: Yes, for one type of error
[17:53:14] <geofft> Brochacho: no, those are different error codes 
[17:53:36] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[17:53:36] <geofft> errno 1 is EPERM "Operation not permitted", but that's very rarely what exit status 1 means 
[17:53:46] *** Joins: dmac (dmac@moz-2ig65r.ca.comcast.net)
[17:54:03] *** Quits: brainproxy (michael@moz-9vjtig.mo.charter.com) (Ping timeout: 121 seconds)
[17:54:04] <Brochacho> geofft: So this just forcefully exits the process with a number that correlates to nothing?
[17:54:10] *** Joins: Izacht13 (Izacht13@moz-oqb.nch.45.199.IP)
[17:54:17] <mkpankov> Brochacho: do I get it correctly that you want to pass errno set by system call to the shell by returning it as exit code?
[17:54:25] <geofft> Brochacho: you document what that number means for your own program 
[17:54:30] <Brochacho> mkpankov: Yep
[17:54:39] <Brochacho> geofft: Ahhh, makes sense now
[17:54:45] <geofft> Brochacho: see `man grep` for instance 
[17:55:01] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[17:55:02] <geofft> for GNU grep: "The exit status is 0 if selected lines are found, and 1 if not found.  If an error occurred the exit status is 2.  (Note: POSIX error handling code should check for '2' or greater.)" 
[17:55:17] <geofft> those aren't errnos, those are just conventions that grep, or at best POSIX, has specified 
[17:55:21] <Brochacho> geofft, mkpankov: Been thinking of exit status and exit incorrectly
[17:55:41] <geofft> the closest thing there is to standardization is /usr/include/sysexits.h, but very few people use it outside BSD 
[17:56:09] *** Quits: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:56:17] <Brochacho> So in the case of setting custom exit statuses, process::exit is used?
[17:56:21] <steveklabnik> yup
[17:56:37] *** Quits: SneakySnake (nya@moz-i9is4u.pool.telekom.hu) (Quit: Leaving)
[17:56:39] <Brochacho> Thank you
[17:57:06] <bstrie> bluss: comments getting lost like this is why I kind of hate github's commenting system :P
[17:57:16] *** Quits: ekiwi (kevin@moz-a2becv.halifax.rwth-aachen.de) (Client exited)
[17:58:09] *** Joins: ZenSword (ZenSword@moz-hlrta3.pools.vodafone-ip.de)
[17:58:26] *** Joins: avikpal (avikpal@moz-7fp.hfh.194.117.IP)
[17:58:46] <mkpankov> I like that things like nix-rust use proper Err for system calls' errors
[17:59:03] <mkpankov> no more "forgot to check errno, oh crap"
[17:59:27] <geofft> <3 
[17:59:56] *** Quits: aon (Mibbit@moz-8c9.siv.143.78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:59:56] <geofft> yeah every time I try something out in Python and need to turn it into a proper C program I'm like "ehhh, does checking errno _really_ matter" 
[18:00:51] *** Joins: KLP (KLP@moz-qdcjho.res.rr.com)
[18:01:00] <mkpankov> well, I need to correct myself and say that firstly you have to check the return code, because errno itself is not reset if no error occurs
[18:01:48] *** Quits: starless (starless@moz-gsr5tg.r6vo.di63.6000.2604.IP) (Quit: Leaving)
[18:02:38] *** Quits: logan_e (logan_e@moz-ltn.qg3.218.73.IP) (Client exited)
[18:02:56] *** Joins: avikpal_ (avikpal@moz-i24.pup.249.117.IP)
[18:03:39] *** Joins: Riastradh (riastradh@moz-4cq.4b3.187.106.IP)
[18:04:26] *** Quits: areski (areski@moz-prr0dt.user.ono.com) (Ping timeout: 121 seconds)
[18:05:16] *** Joins: stjahns (stjahns@moz-163098.wireless.telus.com)
[18:05:24] *** Quits: avikpal (avikpal@moz-7fp.hfh.194.117.IP) (Ping timeout: 121 seconds)
[18:05:37] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[18:05:57] *** Joins: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net)
[18:06:59] <ninja> hey, how can I test a binary without getting this warning: function is never used: `main`...? i have a few functions in the source that are tested, but i don't want to test main() as it really just calls another func..
[18:06:59] *** Quits: KLP (KLP@moz-qdcjho.res.rr.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[18:07:34] <burntsushi> ninja: `#[cfg(not(test))] fn main() { ... }`. but then you might wind up with a bunch of unused warnings.
[18:07:52] *** Quits: hjr3 (hradtke@moz-e235ok.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:08:35] *** Quits: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:08:44] <burntsushi> ninja: another way, i guess, is `#![cfg_attr(test, allow(dead_code))]`, which will just suppress those warnings during testing.
[18:09:26] <ninja> burntsushi: thanks, this does get rid of the warning..  guess i have to read up on those... ... what are those markers exactly?
[18:09:46] <steveklabnik> http://doc.rust-lang.org/nightly/book/attributes.html
[18:09:49] <steveklabnik> ninja: ^
[18:09:50] *** Quits: mkpankov (user@moz-j8c.fu0.69.83.IP) (Ping timeout: 121 seconds)
[18:09:58] <steveklabnik> specifically, that one is http://doc.rust-lang.org/nightly/book/conditional-compilation.html
[18:10:17] <ninja> steveklabnik: thanks a bunch!
[18:10:26] <terpstra_> is there a way to avoid the resize check on push? some sort of bulk load from an iterator?
[18:10:34] <steveklabnik> see also https://github.com/rust-lang/rust/issues/12327
[18:10:53] *** darkowlzz|afk is now known as darkowlzz
[18:11:02] *** Quits: minot2 (kkus@moz-baj4jj.74.srtnet.com) (Connection closed)
[18:11:02] *** Quits: Dr-Emann (Dr-Emann@moz-f8hd1t.tvh.ptd.net) (Connection closed)
[18:11:03] <steveklabnik> terpstra_: extend? maybe?
[18:11:17] <terpstra_> steveklabnik: it just calls push … and thus checks for resize each time
[18:11:30] <terpstra_> i know that i will be pushing exactly as many elements as the vector has capacity.
[18:11:34] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[18:11:43] <steveklabnik> gotcha
[18:11:46] <terpstra_> i guess i could use unsafe, but thought maybe there’s a way to do it better
[18:11:55] <steveklabnik> this is an area of the stdlib i don't know very well
[18:11:56] *** Quits: avikpal_ (avikpal@moz-i24.pup.249.117.IP) (Connection closed)
[18:11:59] <terpstra_> for example, if it is an ExactIterator, maybe extend could be smarter
[18:12:11] <terpstra_> check once, resize once, and then bam bam bam load it in
[18:12:13] *** Joins: avikpal (avikpal@moz-i24.pup.249.117.IP)
[18:12:20] *** Quits: logan_e (logan_e@moz-ltn.qg3.218.73.IP) (Client exited)
[18:12:48] <Murarth> terpstra_: set_len will set the size. You can use std::ptr::write to insert elements without dropping the contents of the not-yet-valid elements. Unless the type is Copy, in which case that doesn't matter.
[18:14:04] <frankmcs_> terpstra_: extend
[18:14:22] <terpstra_> frankmcs_: … checks for resize each time
[18:14:43] <frankmcs_> terpstra_: there should be a comment in the source (iirc) that they'll be optimizing it.
[18:15:00] *** Joins: areski (areski@moz-r8506j.user.ono.com)
[18:15:01] <terpstra_> i’m not sure you can optimize this without it being unsafe
[18:15:12] <reem> terpstra_: The problem is that ExactSizeIterator could lie, and if we relied on it in extend we could cause memory unsafety.
[18:15:20] <terpstra_> reem: yeah, exactly my thoughts
[18:15:32] <reem> We have yet to figure out exactly what to tweak in ExactSizeIterator so that lying requires unsafe itself
[18:15:34] *** Joins: Dr-Emann (Dr-Emann@moz-f8hd1t.tvh.ptd.net)
[18:15:50] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[18:16:03] <ninja> another question: is there some official style guide out there yet? i only found some very incomplete wip..
[18:16:04] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[18:16:28] <frankmcs_> reem: no one responded to my suggestion in Gankro's thread way back that he just do batching in the impl. >.<
[18:16:43] <reem> frankmcs_: batching?
[18:16:44] <frankmcs_> reem: everyone was hot to try out unsafe traits, or something like thta.
[18:16:51] <steveklabnik> ninja: http://doc.rust-lang.org/style is the closest thing
[18:17:28] <frankmcs_> reem: allocate room for 16 elements, lay down up to 16 elements, repeat.
[18:17:44] *** Joins: jwatt (roslea@jwatt.irc.users.mozilla.org)
[18:17:54] <reem> frankmcs_: well, “lay down up to 16 elements” requires checking if you’ve laid out 16 elements at each iteration anyway
[18:18:17] <ninja> steveklabnik: so.. not much really done yet. that's the one I've found as well.. :)
[18:18:27] <reem> the idea is that you can *entirely* omit checking if you’ve reached the end of the allocation, since you know *for sure* the size of the iterator
[18:18:28] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[18:18:38] *** Quits: skade (skade@moz-9imj12.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:18:39] <reem> so you just do for x in iter { ptr::write(slot, x); }
[18:18:46] <frankmcs_> reem: right, except folks seem to be having a hard time getting that to work.
[18:19:12] <terpstra_> it’s hard b/c as reem said, iterators can lie
[18:19:12] <reem> I’ve heard several reasonable plans for ExactSizeIterator
[18:19:37] <frankmcs_> batching doesn't trust the iterator anywhere .
[18:19:39] <steveklabnik> ninja: yup. in-progress.
[18:19:45] <reem> frankmcs_: but it’s also not faster than just calling push
[18:19:56] <reem> frankmcs_: push has one check per iteration, batching has one check per iteration
[18:20:14] *** Joins: Shackra (Jorge@moz-7bh.ng6.177.186.IP)
[18:20:30] <reem> and the exponential reallocation behavior of push will mean that you generally make less reallocs than with batching at some small size
[18:20:32] *** zz_kimundi is now known as kimundi
[18:20:32] *** Joins: rkjnsn (Mibbit@moz-ifitcj.wa.charter.com)
[18:20:36] <frankmcs_> reem: i don't see the check. I count one "did the iterator produce data" check per iteration, and one "am I full" check every 16 
[18:20:51] <terpstra_> you have to count to 16
[18:20:59] <terpstra_> how do you know when to stop?
[18:21:12] <frankmcs_> terpstra_: when your unrolled loop hits its 16th instruction.
[18:21:13] <reem> for (var i = 0; i < 16; i++) <— check for i < 16 occurs at every iteration
[18:21:16] <frankmcs_> the pc counts for you
[18:21:21] *** Quits: areski (areski@moz-r8506j.user.ono.com) (Ping timeout: 121 seconds)
[18:21:22] <terpstra_> oh, that’s a good point
[18:21:44] *** Joins: areski (areski@moz-3cg4vb.user.ono.com)
[18:22:07] <terpstra_> the compiler would probably already unroll that loop as well
[18:22:17] <reem> frankmcs_: ok sure, but that’s just loop unrolling, you can apply it to ExactSizeIterator too and get even better perf.
[18:22:25] <terpstra_> no you can't
[18:22:31] <terpstra_> err
[18:22:39] *** Quits: DerisiveLogic (smuxi@moz-g93io6.res.rr.com) (Ping timeout: 121 seconds)
[18:22:47] <terpstra_> well, you can do this kind of loop unrolling where you partially unroll
[18:23:01] <terpstra_> will LLVM do those? i know it does it for loops of constant size
[18:23:02] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Ping timeout: 121 seconds)
[18:23:17] <reem> the more straightforward the code is in terms of operations on iterators and pointers etc. the more likely LLVM is to optimize this to memcpy for slice iterators and such
[18:23:23] <frankmcs_> the only reason I mentioned it way back when was because Gankro was getting stressed about one instr per iteration, and it seemed like if that was the problem, you could get around it. Understanding how to trust ExactSizeIterator is a cool but possibly different question.
[18:23:54] <reem> frankmcs_: Well you can actually optimize out the None check with ExactSizeIterator too
[18:24:08] <reem> actually wait
[18:24:11] <reem> no you cant
[18:24:12] *** Joins: skade (skade@moz-6athcr.pools.vodafone-ip.de)
[18:24:22] *** Quits: hstefan (quassel@moz-hnlou0.yuriks.net) (Ping timeout: 121 seconds)
[18:24:23] *** Quits: Mindless` (mindless@moz-itr0j2.camanis.net) (Ping timeout: 121 seconds)
[18:24:23] <terpstra_> you always have to have at least 1 check =)
[18:24:27] *** Quits: yuriks (quassel@moz-hnlou0.yuriks.net) (Ping timeout: 121 seconds)
[18:24:34] <frankmcs_> reem: ah, but that will just be predicted for you; it should happen concurrently, I would think.
[18:24:44] <reem> with loop unrolling + ExactSizeIterator you need only one check per 16 elements
[18:24:48] <reem> per X elements*
[18:24:49] *** Joins: Guest74 (textual@moz-lmfinb.fios.verizon.net)
[18:25:11] <reem> (have I reached size / X yet?)
[18:25:15] <terpstra_> yes yes
[18:25:26] <frankmcs_> reem: anyhow, super excited that folks are looking close at actual instructions and such!
[18:25:38] *** Quits: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP) (Quit: Konversation terminated!)
[18:25:40] *** Quits: squiddy (squiddy@moz-5pd6hi.dyn.telefonica.de) (Quit: Leaving)
[18:25:48] <reem> really the hope is that vec.extend(slice_iter) optimizes to realloc + memcpy
[18:25:50] *** Joins: squiddy (squiddy@moz-5pd6hi.dyn.telefonica.de)
[18:26:09] <reem> so it’s equivalent to the old push_all, which we would like to avoid needing if possible
[18:26:29] <frankmcs_> I miss push_all.
[18:26:48] <frankmcs_> or, maybe I miss Reader::push_all. That is probably totally different.
[18:27:10] <frankmcs_> Reader::push; that was the one I miss. Sorry. lame story.
[18:27:15] *** Joins: lutter1 (lutter@moz-7v7ueu.PUBLIC.monkeybrains.net)
[18:27:35] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[18:28:37] *** Joins: xrl (uid1091@moz-f0543s.brockwell.irccloud.com)
[18:28:43] *** Joins: cfcosta (cfcosta@moz-v22.12u.106.187.IP)
[18:29:23] *** Quits: Porkepix (Porkepix@moz-71m.3nd.202.89.IP) (Ping timeout: 121 seconds)
[18:29:32] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[18:30:15] *** Quits: areski (areski@moz-3cg4vb.user.ono.com) (Ping timeout: 121 seconds)
[18:30:21] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[18:30:27] *** Joins: areski (areski@moz-d74mrb.user.ono.com)
[18:30:35] <proc> can I use format! also with a variable ? => format!(my_string, var1, var2);
[18:30:49] <proc> where my_string: String
[18:31:33] *** Joins: Porkepix (Porkepix@moz-71m.3nd.202.89.IP)
[18:31:37] <simukis> proc: no
[18:31:43] <proc> simukis: is there another way? :(
[18:32:17] <simukis> I remember there being fmt_string on Write trait
[18:32:37] <simukis> write_fmt
[18:33:08] <simukis> ah, you can’t make Arguments structure at runtime
[18:33:18] <simukis> so yeah, I believe there’s no way to use custom format strings
[18:33:28] *** Joins: arty (Mibbit@moz-ineiim.il.comcast.net)
[18:33:38] <proc> dammit, except "replace"*n
[18:33:49] <Brochacho> Is there any way of getting around having to use panic! in the match for getopts?
[18:34:10] <proc> Brochacho: match the error and handle it ?
[18:34:19] <proc> (as general approach )
[18:34:47] *** Quits: mzabaluev (Thunderbird@moz-3bijqs.bb.dnainternet.fi) (Ping timeout: 121 seconds)
[18:34:59] <frankmcs_> proc: there is a Formatter you could use
[18:35:08] <frankmcs_> proc: in std::fmt I think
[18:35:53] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[18:36:15] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[18:37:36] <tomprogrammer> Is there a particular reason why assert_eq!(1, 2) exists? Ergonomics of assert!(1 == 2) are not that bad.
[18:38:43] <lyxia> tomprogrammer: assert_eq also prints the two values.
[18:39:47] *** Parts: Brochacho (alberto@moz-b2ovno.cable.rcn.com) ("Good Bye")
[18:39:54] *** Quits: jwatt (roslea@jwatt.irc.users.mozilla.org) (Ping timeout: 121 seconds)
[18:40:04] *** Quits: eerie (eerie@moz-298.sp6.66.109.IP) (Connection closed)
[18:40:06] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[18:40:56] <tomprogrammer> lyxia: oh, I totally overlooked that.. Next question, is there a tendency if the expected value should be placed on the left or right?
[18:41:16] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[18:41:33] *** Quits: stjahns (stjahns@moz-163098.wireless.telus.com) (Connection closed)
[18:41:38] <proc> frankmcs_: except that it's the same as format! and doesn't work for at-runtime format strings
[18:41:44] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[18:41:52] <frankmcs_> proc: ah, i'm sorry.
[18:41:58] <proc> frankmcs_: np
[18:42:10] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[18:42:11] <frankmcs_> proc: these "!" marks in macros make people look really angry. :)
[18:42:25] <proc> frankmcs_: ;)
[18:42:46] <steveklabnik> tomprogrammer: not any more
[18:43:47] *** Quits: nyx (nyx@moz-ivelpd.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[18:44:08] <proc> frankmcs_: but I can use a regex, replace a group etc.., when I've too much time ;)
[18:47:19] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[18:47:21] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[18:47:23] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[18:47:23] *** ChanServ sets mode: +o erickt
[18:47:34] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[18:47:47] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[18:48:11] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[18:48:18] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[18:48:25] *** Quits: ptx (ptx@moz-989.5up.104.87.IP) (Ping timeout: 121 seconds)
[18:49:05] *** Joins: woowe (Mibbit@moz-499ogh.wi.charter.com)
[18:49:38] <woowe> Hey guys, is there a way to convert a hexstr to binary data?
[18:50:26] *** Joins: jpf (jpf@moz-7ui6lj.org)
[18:50:40] *** Quits: maro (maro@moz-mh984t.highway.telekom.at) (Connection closed)
[18:50:52] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[18:51:01] *** rkruppe_ is now known as rkruppe
[18:51:43] *** Quits: Church (hatter@moz-e031bf.dyn.optonline.net) (Ping timeout: 121 seconds)
[18:52:08] *** Quits: Guest74 (textual@moz-lmfinb.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:52:22] <burntsushi> woowe: i don't think there's anything in the stdlib that will do it. i'd probably iterate over pairs of characters and use `u8::from_str_radix`: http://doc.rust-lang.org/std/primitive.u8.html#method.from_str_radix
[18:52:31] *** Quits: dfinninger (dfinninger@moz-6a9v7n.res.rr.com) (Connection closed)
[18:53:28] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[18:53:29] *** Joins: ptx (ptx@moz-989.5up.104.87.IP)
[18:53:30] <woowe> Okay, thank you burntsushi!
[18:54:30] *** Quits: alonlevy (alon@moz-4jqdpb.telavivmakers.org) (Quit: Leaving)
[18:54:41] *** Joins: coledubs (uid49137@moz-b736t8.brockwell.irccloud.com)
[18:55:03] *** Joins: maro (maro@moz-mh984t.highway.telekom.at)
[18:55:18] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Connection closed)
[18:56:19] *** Joins: adjivas (adjivas@moz-0ts.lpf.210.62.IP)
[18:57:04] *** Joins: Nuk9 (Nuk9@moz-8ga.fob.151.142.IP)
[18:57:05] *** Joins: minot2 (kkus@moz-sh2.44e.234.165.IP)
[18:57:31] *** Joins: Guest74 (textual@moz-lmfinb.fios.verizon.net)
[18:57:34] *** streblo is now known as streblo|away
[18:57:44] <adjivas> Hi @all! Anybody can help me about this link's example :-) ?: http://is.gd/272uxU
[18:57:55] *** Quits: rouma (zack@moz-t4kf3b.pekn.hg8m.2000.2604.IP) (Ping timeout: 121 seconds)
[18:58:26] <adjivas> Someone*
[18:58:50] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[18:59:03] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[19:00:22] *** Joins: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr)
[19:00:25] *** Quits: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[19:00:36] *** Joins: Guest5 (textual@moz-hnb58r.oc.cox.net)
[19:00:38] *** Joins: edbond (edbond@moz-8st.7gv.108.109.IP)
[19:00:40] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[19:01:33] <simias> I use find() to locate a specific object in a slice but I'd like to return a sub-item rather than the object itself
[19:01:39] <simias> is there a function that will let me do that?
[19:01:42] *** darkowlzz is now known as darkowlzz|afk
[19:01:43] *** Joins: alonlevy (alon@moz-4jqdpb.telavivmakers.org)
[19:02:12] <simias> to be more specific I have a list containing an enum type
[19:04:00] *** Joins: ekiwi (kevin@moz-a2becv.halifax.rwth-aachen.de)
[19:06:39] <simias> http://is.gd/bRfFRb
[19:06:43] <simias> see this for instance
[19:06:54] <simias> I want to avoid having to match twice
[19:07:28] *** Joins: zzing (textual@moz-jucm1n.cpe.distributel.net)
[19:08:37] *** Quits: erz (erz@moz-n2p94l.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:09:40] <simias> complete example: http://is.gd/YOxQvj
[19:10:46] <frankmcs_> simias: could maybe use filter_map iterator adapter?
[19:11:06] *** Quits: Sphax (Sphax@moz-jf37hn.orh7.lncg.41d0.2001.IP) (Quit: ZNC - http://znc.in)
[19:11:39] *** Joins: Sphax (Sphax@moz-jf37hn.orh7.lncg.41d0.2001.IP)
[19:11:45] *** Quits: woowe (Mibbit@moz-499ogh.wi.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[19:12:28] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[19:12:30] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[19:12:52] *** Joins: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net)
[19:12:59] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[19:13:28] *** Quits: Guest74 (textual@moz-lmfinb.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:13:38] <bstrie> adjivas: let me see
[19:14:05] <adjivas> bstrie: http://is.gd/Zj8YvG
[19:14:17] <adjivas> bstrie: Finally, I have found :-) !
[19:14:57] <simias> frankmcs_: ah, sounds like it would work
[19:14:59] <simias> thanks
[19:16:16] <erikj> Hmm, if a C library has structs with bit fields which it expects me to allocate memory for, how screwed am I?
[19:16:29] <frankmcs_> simias: something like http://is.gd/QG7c4m maybe?
[19:16:35] <bstrie> adjivas: http://is.gd/LTbPdl
[19:16:38] *** Joins: slimsag (Mibbit@moz-qrnu8n.ph.cox.net)
[19:17:24] <slimsag> What is the current status of SIMD in Rust ? Can the compiler generate AVX instructions or do I need to write LLVM asm for it?
[19:17:25] *** Quits: makhauser (quassel@moz-7p8.00g.111.213.IP) (Connection closed)
[19:17:35] *** Joins: makhauser (quassel@moz-7p8.00g.111.213.IP)
[19:17:39] <bstrie> adjivas: ah hm, I think yours might be better :)
[19:17:56] *** Joins: vairav (vairav@moz-ms3.on0.126.76.IP)
[19:17:58] <bstrie> slimsag: I think aatch is the simd czar, he might know
[19:18:18] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[19:18:31] <adjivas> bstrie: Probably, but thank you for your try ;-)
[19:18:37] <slimsag> bstrie: appreciate it! :)
[19:18:48] *** Quits: maro (maro@moz-mh984t.highway.telekom.at) (Ping timeout: 121 seconds)
[19:18:55] <slimsag> aatch: if you might know? ^^
[19:19:04] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[19:19:05] <Ilari> slimsag: Well, I think in general, compiler vectorizers are not that good. Dunno if compiler can generate AVX instructions or not, but even if it can, doesn't mean it can generate the instructions well.
[19:19:37] *** Joins: maro (maro@moz-mh984t.highway.telekom.at)
[19:20:07] <slimsag> llari: even for really really trivial cases (adding four f32 in a struct against four f32 in another struct)?
[19:21:02] <Ilari> slimsag: Well, it probably can do that.
[19:21:15] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[19:21:15] <Ilari> slimsag: Someone's comment: "Unfortunately, the current clang can't vectorize its way out of a paper bag, and GCC isn't much better."
[19:21:45] <slimsag> llari: I see. Sounds like I need to check out the generated asm
[19:21:47] *** Joins: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net)
[19:22:09] *** Quits: avikpal (avikpal@moz-i24.pup.249.117.IP) (Ping timeout: 121 seconds)
[19:22:10] <bstrie> Ilari: clang vectorizes our iterators quite well at least, on -O3
[19:22:32] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[19:22:35] <bstrie> er, llvm
[19:23:09] *** Quits: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:23:10] <slimsag> I found https://github.com/rust-lang/rfcs/issues/325 so I guess I can't enforce 256-bit alignment to use aligned AVX instructions ?
[19:23:20] <simias> frankmcs_: yeah that works nicely, thank you
[19:24:16] *** Quits: edbond (edbond@moz-8st.7gv.108.109.IP) (Ping timeout: 121 seconds)
[19:24:19] *** Quits: maro (maro@moz-mh984t.highway.telekom.at) (Connection closed)
[19:24:24] <Ilari> bstrie: Well, he who made that comment wants to do much more complicated vectorization. And really push the performance envelope.
[19:25:26] *** Joins: erz (erz@moz-n2p94l.broadband.corbina.ru)
[19:25:45] <xrl> why is the cargo.lock .gitignored by default? doesn't it make sense to track that for reproducible builds across checkouts?
[19:26:16] <bstrie> xrl: there's an explanation for that somewhere...
[19:26:23] *** Joins: maro (maro@moz-mh984t.highway.telekom.at)
[19:26:44] <slimsag> bstrie: isn't it that cargo.lock does not belong in libraries/crates, but only in binaries ?
[19:26:51] <slimsag> executables*
[19:26:54] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:27:07] *** Joins: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP)
[19:27:17] <bstrie> xrl: http://doc.crates.io/guide.html#cargo.toml-vs-cargo.lock
[19:27:44] <Selemur> Does .skip() jump to the relevant position or does it have to loop through all prior elements?
[19:27:57] <cmr> Selemur: it has to loop.
[19:28:05] <cmr> destructors need to be called.
[19:28:09] *** Joins: woowe (Mibbit@moz-499ogh.wi.charter.com)
[19:28:15] <cmr> sockets need to be read, etc.
[19:28:37] <xrl> bstrie: nice, that makes sense. thanks for the doc link!
[19:28:40] <bstrie> np
[19:28:48] <woowe> is there a rust equivalent to python's binascii.unhexlify()?
[19:29:01] *** Quits: Guest39 (textual@moz-8vrlkj.austtx.sbcglobal.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:29:03] <xrl> I am working on a lib so this makes sense. that cargo init command is so smart!
[19:29:10] *** Quits: wenderen (uid34286@moz-9vna9c.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[19:29:10] <steveklabnik> :)
[19:29:18] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[19:29:19] <woowe> I need something that will turn a UTF-8 hexstr to an ascii binary data
[19:29:25] *** Joins: Mindless` (mindless@moz-itr0j2.camanis.net)
[19:30:23] <Murarth> woowe: The rustc-serialize crate has it: http://doc.rust-lang.org/rustc-serialize/rustc_serialize/hex/index.html
[19:31:18] <woowe> Oh! Nice! So is a vec<u8> equivalent to the ascii binary data?
[19:31:22] *** Joins: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP)
[19:31:27] *** Quits: KindOne (KindOne@moz-49t.rnq.170.107.IP) (Quit: Hiring PHP developers does not contribute to the quota of employees with disabilities.)
[19:31:36] <bstrie> woowe: what is a "UTF-8 hexstr"?
[19:31:57] <bstrie> if your string contains hexadecimal characters, then it's also ASCII by definition
[19:32:06] <bstrie> *contains only
[19:32:13] <woowe> Just that, a utf-8 enocded string with hexadecimal charaters
[19:32:29] <woowe> Oh, cool, didn't know that. Thanks!!!
[19:32:42] *** Joins: Tarmashirin (Tarmashirin@moz-5td.qve.199.117.IP)
[19:32:50] *** Joins: demelev (Mibbit@moz-5qbmjd.dyn.idknet.com)
[19:33:21] <bstrie> woowe: characters in hexadecimal strings can only be [0-9a-fA-F], which are all in ASCII, which is a subset of UTF-8
[19:33:51] *** streblo|away is now known as streblo
[19:33:53] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[19:34:38] <simias> woowe: if you're *certain* you're only going to handle ascii data it's sometimes easier to use &[u8] and Vec<u8> rather than &str and Strings
[19:34:57] <bstrie> woowe: now, depending on where you're getting this string from it's possible that it's encoded strangely, but if you're using string literals in rust source files then it's all guaranteed to work since rust source files must be in utf-8
[19:35:49] <woowe> Yeah, I am using just the standard &str and String
[19:36:02] *** Quits: alonlevy (alon@moz-4jqdpb.telavivmakers.org) (Ping timeout: 121 seconds)
[19:36:17] *** Joins: hstefan (quassel@moz-hnlou0.yuriks.net)
[19:36:26] *** Joins: yuriks (quassel@moz-hnlou0.yuriks.net)
[19:36:33] <woowe> simias: I am not sure, I am porting the mikrotik python3 API to rust and they are using the binascii stuff
[19:36:53] *** Quits: sagg (sigg@moz-55rvi2.dclient.hispeed.ch) (Ping timeout: 121 seconds)
[19:37:28] *** Joins: KindOne (KindOne@moz-49t.rnq.170.107.IP)
[19:37:35] <woowe> if you want to see what I am going after http://wiki.mikrotik.com/wiki/Manual:API_Python3 is the API, I am working on the login function
[19:38:25] <simias> woowe: at a glance if it's web stuff I'd use utf-8 strings "just in case"
[19:38:34] <simias> at least at the interface
[19:38:50] <simias> maybe once you're sure the input has been sanitized you can convert it to something more reasonable
[19:38:53] <woowe> specifically the chal = binascii.unhexlify((attrs['=ret']).encode('UTF-8'))
[19:38:57] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[19:39:27] <simias> yeah it's a serialization routine, maybe check how other crates handle base64 and things like that
[19:39:33] <simias> it's similar
[19:39:43] <woowe> Yeah, I wasn't quite sure why they turned it into the binary ascii data
[19:39:54] *** Quits: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP) (Quit: WeeChat 1.1.1)
[19:40:08] <woowe> I was looking at base64
[19:40:34] <woowe> I didn't really know if it would mess up the whole md5 thing they are doing
[19:40:52] *** Joins: niconii (nicole@moz-dt9bve.frgo.qwest.net)
[19:41:08] <xrl> where do I put #[doc=""] to provide content for the index page loaded when I do `cargo doc --open`? Right now it's just a plain doc page and I want to provide some info about the project in a general sense.
[19:43:52] <niconii> xrl: you can just do //! in the crate root, can't you?
[19:43:52] <cmr> xrl: on the crate root, but it needs to be in inner-attr/comment, ie, //! or #![doc]
[19:43:57] *** Quits: brainproxy (michael@moz-9vjtig.mo.charter.com) (Ping timeout: 121 seconds)
[19:44:05] *** Quits: Tarmashirin (Tarmashirin@moz-5td.qve.199.117.IP) (Connection closed)
[19:44:09] <cmr> (since there is not "outside" of the crate root)
[19:44:30] *** Joins: Temur (Tarmashirin@moz-5td.qve.199.117.IP)
[19:44:33] *** Quits: xav (xav@moz-5tfec1.mobi) (Ping timeout: 121 seconds)
[19:45:26] *** Quits: cespare (caleb@moz-h4nvlf.ca.comcast.net) (Ping timeout: 121 seconds)
[19:45:27] *** Quits: jml (jml@moz-et2.8uj.238.178.IP) (Ping timeout: 121 seconds)
[19:45:51] *** Joins: marsel (user@moz-rrv.pek.234.188.IP)
[19:46:06] <xrl> niconii: what is the crate root? main.rs?
[19:46:17] <xrl> niconii: for reference, here's my repo as it stands https://github.com/tureus/graphite-rust
[19:46:32] <niconii> xrl: main.rs or lib.rs, yes
[19:46:34] <steveklabnik> xrl: main.rs or lib.rs is the crate root
[19:46:39] *** Joins: jml (jml@moz-mqpurn.178.in-addr.arpa)
[19:47:02] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[19:47:02] *** ChanServ sets mode: +o erickt
[19:47:37] *** Joins: mib_rx0xmc (Mibbit@moz-c7u4td.ga.comcast.net)
[19:47:44] <steveklabnik> so, how terrible of an idea is it to expose a Vec to C?
[19:47:53] <steveklabnik> like, writing a wrapper
[19:48:05] <xrl> Ah, so I can document the individual functions of main.rs but I can't provide a README style blob of free-flowing text?
[19:48:17] <steveklabnik> oh, yes, rustdoc doesn't work on main.rs'
[19:48:21] <steveklabnik> rs's
[19:48:25] <steveklabnik> lol, weird phrasing
[19:48:41] <steveklabnik> also
[19:48:51] <steveklabnik> you just put the text behind a series of //!s
[19:48:53] *** Quits: wei2912 (wei2912@moz-530.h2f.156.175.IP) (Quit: Lost terminal)
[19:49:08] <cmr> steveklabnik: not that terrible, why?
[19:49:24] <steveklabnik> cmr: just doing some dumb experimenting
[19:49:33] <steveklabnik> xrl: like https://github.com/rust-lang/rust/blob/master/src/libstd/lib.rs#L11 turns into http://doc.rust-lang.org/nightly/std/
[19:49:58] <steveklabnik> cmr: i'm trying to get my head around the types, thinking through multiple layers is hard
[19:50:12] *** Quits: maro (maro@moz-mh984t.highway.telekom.at) (Quit: Leaving)
[19:50:33] *** Quits: meh (meh@moz-p5gc2m.42-151.net24.it) (Ping timeout: 121 seconds)
[19:50:59] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[19:52:32] *** Quits: anders (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[19:53:30] *** Quits: mbudde (mbudde@moz-vmd8oc.customer.tdc.net) (Connection closed)
[19:54:04] *** Quits: Romster (Romster@moz-4g83e8.rev.eftel.com) (Ping timeout: 121 seconds)
[19:55:31] *** Joins: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it)
[19:58:01] *** Joins: cespare (caleb@moz-4kcd1c.ca.comcast.net)
[19:59:03] *** Joins: Harry (Mibbit@moz-944vti.ga.comcast.net)
[19:59:13] *** Joins: dfinninger (dfinninger@moz-sqqguu.res.rr.com)
[19:59:32] *** Joins: mriss (geno@moz-04as44.dip0.t-ipconnect.de)
[19:59:52] <Harry> Anyone mind to help me with why my Rust Wavefront OBJ parser takes nearly 40x as long as my C Wavefront OBJ parser?
[20:00:25] *** Joins: Romster (Romster@moz-4g83e8.rev.eftel.com)
[20:00:36] <flan3002> Harry - Do you compile with optimizations?
[20:00:42] <flan3002> cargo build --release
[20:00:59] *** Quits: minot2 (kkus@moz-sh2.44e.234.165.IP) (Ping timeout: 121 seconds)
[20:01:01] <demelev> Hi!
[20:01:28] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[20:01:32] <demelev> I'm little confused with indexing of slices
[20:01:46] *** Joins: jwatt (roslea@jwatt.irc.users.mozilla.org)
[20:01:46] <steveklabnik> demelev: sure thing, in what way?
[20:02:16] *** Quits: mib_rx0xmc (Mibbit@moz-c7u4td.ga.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:02:59] <demelev> documentation says that index returns reference fn index(&self, index: usize) -> &T
[20:03:14] <Harry> flan3002: Yes I do build as release
[20:03:32] *** Joins: blaenk (blaenkdenum@moz-kaffj9.n2pv.fsko.e000.2605.IP)
[20:03:42] <flan3002> Harry - Do you have a simple testcase for both versions?
[20:03:45] *** Joins: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP)
[20:03:53] <demelev> but  myslice[0] returns u8,  when myslice.index(0) returns &u8
[20:04:18] *** Joins: jandem (sid16255@moz-s8ebmu.uxbridge.irccloud.com)
[20:04:33] <niconii> Harry: you might wanna profile to see if there's something in particular taking up all your time
[20:04:46] <Harry> flan3002: I can write one up, but do you think it could have to do with the parsing from string to integer or pushing to a vec?
[20:04:53] *** Joins: anders (andars@moz-bsldst.sntcca.sbcglobal.net)
[20:05:13] <steveklabnik> demelev: so, there's a subtlety here
[20:05:15] <Harry> niconii: Will that show me all the functions that are being called?
[20:05:16] <kimundi> demelev: THe fact that index() returns an reference is basically a implementation detail
[20:05:32] <flan3002> Harry - Depends on how you're doing that, but unless you're something particularly weird... I don't think so.
[20:05:35] <bstrie> Harry: could be the lack of buffered io, could be using differently sized integers, could be a lot of things
[20:05:50] <kimundi> demelev: You can see `foo[i]` as `*foo.index(i)` or `*foo.index_mut(i)` depending on context
[20:06:02] <bstrie> Harry: we would need to see both versions of the code :)
[20:06:13] *** Joins: Kingsquee (kingsley@moz-qq7ns6.bchsia.telus.net)
[20:06:30] <rkjnsn> Why is abort unsafe?
[20:06:42] <Harry> bstrie: Should I just do 2 Pastebins?
[20:06:56] <steveklabnik> Harry: github is even better, easier to grab and compile
[20:07:09] *** Quits: Izacht13 (Izacht13@moz-oqb.nch.45.199.IP) (Quit: Leaving)
[20:07:36] <steveklabnik> rkjnsn: http://doc.rust-lang.org/nightly/std/intrinsics/fn.abort.html you mean?
[20:07:41] *** Joins: minot2 (kkus@moz-sh2.44e.234.165.IP)
[20:08:04] <rkjnsn> steveklabnik: yes
[20:08:15] <steveklabnik> rkjnsn: it's an extern fn, so it's unsafe, basically
[20:08:25] <steveklabnik> http://doc.rust-lang.org/nightly/std/process/fn.exit.html will terminate the process, and is stable and safe
[20:08:33] *** Joins: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr)
[20:08:34] <kimundi> rkjnsn: Its an extern function, those are always unsafe even if they should not be
[20:09:07] *** Joins: cacaca (Mibbit@moz-aua.g0i.51.193.IP)
[20:09:15] *** Quits: theorbtwo (theorb@moz-jpvr5g.cable.virginm.net) (Ping timeout: 121 seconds)
[20:09:16] *** Joins: theorbtwo (theorb@moz-jpvr5g.cable.virginm.net)
[20:09:18] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[20:09:58] <rkjnsn> Thanks.
[20:10:03] *** Quits: cespare (caleb@moz-4kcd1c.ca.comcast.net) (Ping timeout: 121 seconds)
[20:10:13] <JoshTriplett> aatch: Around?  Yesterday you suggested something about switching to iterators, and you said you had an example you wanted to show?
[20:10:58] *** Quits: arty (Mibbit@moz-ineiim.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:11:25] *** Quits: dstrbad (dstrbad@moz-3vdjjr.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[20:11:47] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:12:13] <demelev> kimundi: I thought that `foo[i]` uses `foo.index(i)`. So it is not so?
[20:12:13] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:12:33] *** Joins: orangeshark (erik@moz-qvotv7.44tj.56ot.0306.2602.IP)
[20:13:05] <kimundi> demelev: It depends on how you use the indexed value - if you use it for mutation, eg to do `foo[i] = bar`, then it calls index_mut
[20:13:20] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:13:35] *** Joins: Drek (Mibbit@moz-e29q96.dip0.t-ipconnect.de)
[20:13:36] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:13:39] *** Quits: mriss (geno@moz-04as44.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[20:13:40] <kimundi> demelev: indexed value is a lvalue, so that you can assign to it, which is implemented by being equivalent to a derefence
[20:14:07] <kimundi> `foo[i] = bar` == `*foo.index_mut(i) = bar`
[20:14:28] <Harry> http://miburl.com/i3WvnK Here is the URL to the OBJ Loader in Rust. The only real difference between C and Rust versions are that C allocates the necessary memory ahead of time.
[20:14:37] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:14:37] *** Joins: rouma (zack@moz-5fmitj.pekn.hg8m.2000.2604.IP)
[20:15:06] <Drek> Can I use named parameters when I call a function ( foo(x: 10, y: 20) )?
[20:15:06] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:15:13] <kimundi> Drek: no
[20:15:19] <kimundi> Harry: link doesn't work
[20:15:28] *** Joins: stick (Mibbit@moz-tpjl46.co.comcast.net)
[20:15:40] <Harry> kimundi: https://github.com/IcyTesseract/obj-loader-rs Better?
[20:15:49] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:15:50] <kimundi> yeah
[20:15:55] <Harry> and the relevant C code is here: https://github.com/IcyTesseract/OpenGL-Engine/blob/master/src/loader.c
[20:16:11] *** Quits: adjivas (adjivas@moz-0ts.lpf.210.62.IP) (Quit: WeeChat 1.1.1)
[20:16:11] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:16:21] *** Joins: Guest (textual@moz-rtn.fg7.77.192.IP)
[20:16:28] <Drek> kimundi: ok thx.
[20:16:34] <kimundi> Harry: Hm, you could extend your cargo package such that it also includes the C code and comapres them side by side with rusts benchamrking tools
[20:16:50] <demelev> kimundi: thank you very much :)
[20:16:55] *** Quits: Guest5 (textual@moz-hnb58r.oc.cox.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:16:59] <kimundi> Harry: (See https://github.com/Kimundi/long_strings_without_repeats for an example how that would work)
[20:17:08] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:17:10] <niconii> Harry: if the main difference is that you're not allocating memory ahead of time in rust, maybe you should do that
[20:17:13] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[20:17:40] <niconii> Harry: Vec::with_capacity(1000) pre-allocates enough memory for 1000 items, for example
[20:17:50] *** Joins: Guest_ (textual@moz-rtn.fg7.77.192.IP)
[20:17:56] *** Joins: mbrubeck_bak (sid17036@moz-omrqa0.uxbridge.irccloud.com)
[20:18:09] *** Quits: mbrubeck_bak (sid17036@moz-omrqa0.uxbridge.irccloud.com) (Quit: )
[20:18:22] <kimundi> Harry: You are creting a lot of vectors in the Rust code - does the C code do that as well? malloc a buffer for each vertice?
[20:18:33] <Harry> niconii: I'm doing that right now to check
[20:18:37] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (A TLS packet with unexpected length was received.)
[20:18:44] *** Quits: Guest (textual@moz-rtn.fg7.77.192.IP) (Connection closed)
[20:19:11] <tomaka> you're doing a lot of allocations in your rust code compared to C
[20:19:37] *** Joins: Hannibal_Smith (nico@moz-ucg29b.retail.telecomitalia.it)
[20:19:38] *** Quits: raph (Adium@moz-o75.fg7.77.192.IP) (Connection closed)
[20:19:49] <tomaka> That's not free: https://github.com/IcyTesseract/obj-loader-rs/blob/master/src/main.rs#L38
[20:19:59] <tomaka> and is probably unnecessary
[20:20:06] *** Joins: alonlevy (alon@moz-p48.q13.159.94.IP)
[20:20:12] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:20:14] <tomaka> (same here and below: https://github.com/IcyTesseract/obj-loader-rs/blob/master/src/main.rs#L64-L66)
[20:20:39] *** Quits: skeuomorf (skeuomorf@moz-pl7.u9l.32.197.IP) (Ping timeout: 121 seconds)
[20:20:41] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:21:32] <Harry> tomaka: Is there anything like sscanf in Rust?
[20:22:37] <tomaka> it looks like you're only accessing the first four elements
[20:22:55] *** Joins: cespare (caleb@moz-4kcd1c.ca.comcast.net)
[20:23:35] <tomaka> so you can write  let mut iter = line.split(" "); let spl1 = iter.next().unwrap(); let spl2 = iter.next().unwrap(); let spl3 = iter.next().unwrap(); let spl4 = iter.next().unwrap();
[20:23:43] *** Quits: kkus (kkus@moz-fj2.o46.234.165.IP) (Ping timeout: 121 seconds)
[20:23:43] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:24:01] <tomaka> this would also avoid bounds checking when you write spl[2] for example
[20:24:27] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:26:26] *** Joins: sysko (bst@moz-qau.e3g.230.116.IP)
[20:28:02] <terpstra_> why can’t i use Rand? http://is.gd/dmMVLF
[20:28:27] <terpstra_> there’s a pub use core_rand::{Rand, Rng, SeedableRng}; in libstd/rand/mod.rs …
[20:28:42] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:28:53] *** Quits: vairav (vairav@moz-ms3.on0.126.76.IP) (Client exited)
[20:29:13] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:29:18] <steveklabnik> terpstra_: you have to use it from crates.io
[20:29:28] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[20:29:28] *** ChanServ sets mode: +o jdm
[20:29:57] *** Joins: cjwelborn (cjwelborn@moz-np6hed.al.charter.com)
[20:30:06] *** Quits: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP) (Quit: Konversation terminated!)
[20:30:15] <terpstra_> maybe nightly isn’t new enough?
[20:31:02] *** Quits: Guest_ (textual@moz-rtn.fg7.77.192.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:33:04] *** Quits: loyd (loyd@moz-uft.32f.108.213.IP) (Ping timeout: 121 seconds)
[20:34:05] *** Joins: npm (npm@moz-92sbjt.wa.comcast.net)
[20:34:09] *** npm is now known as GBGamer
[20:34:37] <GBGamer> Does anyone know of a way to compile time error?
[20:34:47] <GBGamer> Like the C preprocessor command, #error?
[20:34:51] <frankmcs_> steveklabnik: this bit me recently too; too easy to find the rand crate on doc.rust-lang.org. :)
[20:35:24] *** Quits: mindtree (Mitch@moz-qh8f9n.iprimus.net.au) (Ping timeout: 121 seconds)
[20:35:36] <FreeFull> The documentation on doc.rust-lang.org is for the rand crate from crates.io
[20:35:55] <tomaka> GBGamer: you can write "use error_message_here;"
[20:35:55] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:36:00] *** Joins: genbattle (genbattle@moz-9fu7hj.xtra.co.nz)
[20:36:06] <tomaka> it's obviously not very clean, but it works
[20:36:27] <steveklabnik> someone wrote a compile-time error crate
[20:36:31] <steveklabnik> can't remember what it's callahad 
[20:36:32] <tomaka> playbot: use sorry_this_platform_is_not_supported;
[20:36:32] <steveklabnik> called
[20:36:33] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:36:33] -playbot- <anon>:9:13: 9:49 error: unresolved import `sorry_this_platform_is_not_supported`. There is no `sorry_this_platform_is_not_supported` in `???`
[20:36:33] -playbot- <anon>:9         use sorry_this_platform_is_not_supported;
[20:36:33] -playbot- output truncated; full output at: http://bit.ly/1PBvq8Q
[20:36:36] <steveklabnik> kimundi: was that you?
[20:36:43] <tomaka> huon wrote it, but it's a plugin
[20:36:46] <tomaka> so not stable
[20:37:05] <GBGamer> Yeah, well I'm writing an OS, so it's not like I'll ever get to use stable :P
[20:37:11] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[20:37:38] *** Joins: mib_mm61gz (Mibbit@moz-uocb0k.cpe.webspeed.dk)
[20:37:42] <tomaka> https://github.com/huonw/compile_msg
[20:37:49] <steveklabnik> ah!
[20:37:49] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Connection closed)
[20:37:50] <steveklabnik> thanks tomaka 
[20:37:54] *** Joins: swgillespie (swgillespie@moz-c10.u53.35.4.IP)
[20:38:00] *** Quits: mib_mm61gz (Mibbit@moz-uocb0k.cpe.webspeed.dk) (Quit: http://www.mibbit.com ajax IRC Client)
[20:38:03] <GBGamer> tomaka: do you know the name of the crate?
[20:38:10] *** Quits: cjwelborn (cjwelborn@moz-np6hed.al.charter.com) (Quit: sys.exit(1))
[20:38:13] <tomaka> it's written in the readme!
[20:38:42] *** Quits: mnemnion (mnemnion@moz-e8rfii.ca.comcast.net) (Connection closed)
[20:38:43] *** Quits: qrlpx (smuxi@moz-n7t.3nb.211.95.IP) (Ping timeout: 121 seconds)
[20:38:45] <GBGamer> what?
[20:38:49] <GBGamer> Where?
[20:39:00] <GBGamer> which readme?
[20:39:03] *** Quits: vianney (vianney@moz-9lca1t.99j5.26t5.0e34.2a01.IP) (Quit: WeeChat 1.1.1)
[20:39:11] <tomaka> https://github.com/huonw/compile_msg#usage
[20:39:25] <GBGamer> oh hey, that's where it is!
[20:39:26] <GBGamer> thanks!
[20:39:56] *** Quits: swgillespie (swgillespie@moz-c10.u53.35.4.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:40:11] *** Quits: woowe (Mibbit@moz-499ogh.wi.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[20:40:16] *** Quits: Hannibal_Smith (nico@moz-ucg29b.retail.telecomitalia.it) (Quit: Leaving)
[20:40:27] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[20:40:30] <blaenk> oh that's cool
[20:40:34] *** Joins: larhat (Adium@moz-tb1ulb.cable.virginm.net)
[20:41:35] *** Joins: fyl2xp1 (fyl2xp1@moz-89qsn2.netcologne.de)
[20:42:47] *** Joins: cjwelborn (androirc@moz-np6hed.al.charter.com)
[20:42:52] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[20:43:43] *** Joins: qrlpx (smuxi@moz-5td1up.dip0.t-ipconnect.de)
[20:44:07] *** Joins: smarks (smarks@moz-j45.fic.77.109.IP)
[20:44:31] *** Quits: brainproxy (michael@moz-9vjtig.mo.charter.com) (Ping timeout: 121 seconds)
[20:44:36] <Gankro> frankmcs_: reem: the concern is more being able to optimize to like a memcpy
[20:44:37] <Drek> What should be the return type of a function if it can return an error, the winning reason or nothing?
[20:44:41] *** Joins: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net)
[20:44:46] *** Quits: smarks (smarks@moz-j45.fic.77.109.IP) (Quit: )
[20:44:54] *** Quits: cjwelborn (androirc@moz-np6hed.al.charter.com) (Quit: AndroIRC - Android IRC Client ( http://www.androirc.com ))
[20:45:12] <steveklabnik> Result<Option<Reason>, Error> ? maybe
[20:45:18] *** Quits: khades (Thunderbird@moz-u45.3vk.74.212.IP) (Client exited)
[20:45:38] <JoshTriplett> Drek: What do you mean "winning reason"?
[20:45:52] *** Joins: cjwelborn (androirc@moz-np6hed.al.charter.com)
[20:46:47] <Drek> It's a function of a little game I'm writing and the are multiple reason the player can win
[20:47:18] <JoshTriplett> Drek: And does "nothing" mean the player hasn't won yet?
[20:47:46] <Drek> Yes
[20:48:23] *** Joins: mnemnion (mnemnion@moz-e8rfii.ca.comcast.net)
[20:48:27] <JoshTriplett> Drek: Then yeah, steveklabnik's suggestion sounds exactly right.  An outer Result to indicate if an error happened (so you can call this function with try!), and then an Option<WinReason> to indicate if you've won and why.
[20:48:55] *** Joins: brson (brson@moz-a8s.c9m.56.172.IP)
[20:48:56] *** ChanServ sets mode: +ao brson brson
[20:49:06] <Drek> Ok thanks JoshTriplett and steveklabnik
[20:49:09] *** Quits: cjwelborn (androirc@moz-np6hed.al.charter.com) (Quit: AndroIRC - Android IRC Client ( http://www.androirc.com ))
[20:49:13] <JoshTriplett> Drek: (And if you have a lot of functions that return Result<RealReturnType, Error>, you might consider making a type alias for that)
[20:49:19] *** Quits: jshs (jshs@moz-bp57hc.dip0.t-ipconnect.de) (Client exited)
[20:50:39] *** Quits: c0170_ (c0170@moz-4stj9o.cable.virginm.net) (Ping timeout: 121 seconds)
[20:51:31] *** Quits: logan_e (logan_e@moz-ltn.qg3.218.73.IP) (Ping timeout: 121 seconds)
[20:51:36] *** Joins: kgrandon (Adium@moz-j2hkpm.hjek.d045.0009.2601.IP)
[20:52:18] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[20:52:35] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[20:53:58] <JoshTriplett> How do you spell UINT64_MAX in rust?
[20:54:20] <JoshTriplett> And more generally, is there a trait similar to Bounded in Haskell?
[20:54:28] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Ping timeout: 121 seconds)
[20:54:28] <JoshTriplett> Something defined for any type with a maximum and minimum value?
[20:54:33] *** Quits: cfcosta (cfcosta@moz-v22.12u.106.187.IP) (Ping timeout: 121 seconds)
[20:54:55] <steveklabnik> http://doc.rust-lang.org/nightly/std/f64/constant.MAX.html
[20:55:09] <steveklabnik> and, i don't think so, off the top of my head
[20:55:22] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[20:55:29] <steveklabnik> sorry, that link is for f64 not i64, but you get the idea
[20:55:31] <steveklabnik> :)
[20:55:33] <JoshTriplett> :)
[20:55:47] <JoshTriplett> steveklabnik: Would that be worth writing?  Such that you could then always write MAX or MIN for any bounded type and have type inference do the right thing?
[20:56:00] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[20:56:09] <blaenk> check if maybe `num` already does that
[20:56:15] <JoshTriplett> Checking...
[20:56:18] <steveklabnik> yeah, maybe
[20:56:25] <blaenk> http://doc.rust-lang.org/num/num/traits/trait.Bounded.html
[20:56:33] <steveklabnik> nice
[20:56:39] *** Joins: CuriousCain (Mibbit@moz-jcvu2r.cable.virginm.net)
[20:56:39] *** Joins: cfcosta (cfcosta@moz-v22.12u.106.187.IP)
[20:56:46] *** Joins: colinsurprenant (colin@moz-lu9sne.92.electronicbox.net)
[20:56:49] <JoshTriplett> Perfect.
[20:57:05] <CuriousCain> Hey guys, does anyone know the default installation path for rust on a linux-based OS? 
[20:57:05] <JoshTriplett> Do I need to write an RFC to add more instances of that trait, or could I just submit a patch?
[20:57:14] *** Joins: saml_ (saml@moz-rkfmct.res.rr.com)
[20:57:15] <CuriousCain> I can't seem to find anything other than the rustlib
[20:57:22] <steveklabnik> CuriousCain: `which rustc` says nothing?
[20:57:24] <blaenk> just a patch afaik, but I think they'd only really accept it for std types
[20:57:28] *** Joins: phildini (quassel@moz-qqf.of6.243.162.IP)
[20:57:30] <blaenk> what did you have in mind?
[20:57:38] <CuriousCain> It tells me that the exec is in my universal bin
[20:57:45] <CuriousCain> But not where the rest of it is installed.
[20:58:13] <cmr> that and rustlib should be all of it.
[20:58:27] <CuriousCain> Ah, hmm
[20:58:31] *** Quits: logan_e (logan_e@moz-ltn.qg3.218.73.IP) (Ping timeout: 121 seconds)
[20:59:06] *** Quits: mnemnion (mnemnion@moz-e8rfii.ca.comcast.net) (Connection closed)
[20:59:18] <CuriousCain> I'm trying to set up RustDT and it requires there to be a bin directory with both rustc and cargo inside it. I just assumed it didn't mean my /usr/bin, because it wants the directory to be inside another
[20:59:59] *** Joins: csherratt (colin@moz-357qdq.cable.teksavvy.com)
[21:00:22] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[21:00:26] <JoshTriplett> blaenk: tuples, and in the particular case I was thinking of, Timespec.
[21:00:33] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[21:00:36] <blaenk> yeah worth a shot
[21:00:46] *** Joins: meh (meh@moz-p5gc2m.42-151.net24.it)
[21:01:13] <blaenk> kinda sucks how that trait is in num, and say some other T in another crate. you can't impl the trait for that T afaik
[21:01:20] <blaenk> you'd have to wrap the type T in your own type/newtype
[21:01:27] <blaenk> feels a lot like goergh
[21:01:41] *** Quits: Heejong (uid59097@moz-c67ecd.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[21:02:26] <JoshTriplett> blaenk: Is there a #![feature] that would allow doing so, similar to Haskell's ability to disable the orphan instance warning?
[21:02:33] <blaenk> not afaik
[21:02:47] <reem> JoshTriplett: Nope. Coherence is a rather fickle mistress.
[21:03:07] <JoshTriplett> reem: Welcome back, and thanks for all the help yesterday. :)
[21:03:17] <reem> Sure :)
[21:03:41] *** Joins: akiss (akiss@moz-l61h32.pool.digikabel.hu)
[21:03:43] <blaenk> reem can you comment on chris' latest workarounds? I'm using it right now and it seems to work. idk if he's waiting for feedback before merging
[21:04:31] <reem> blaenk: we worked on them together yesterday; typemap is also updated.
[21:04:36] *** Quits: Jackneill (Jackneill@moz-p0a82d.pool.digikabel.hu) (A TLS packet with unexpected length was received.)
[21:04:41] <blaenk> yeah, I just don't know why it hasn't been merged yet
[21:05:07] <reem> blaenk: It required quite a bit more code than the last change: https://github.com/reem/rust-typemap/commit/3835ed1507444fce27ccc317fd946af33969e8ed
[21:05:42] <reem> and unfortunately this design has the drawback that you cannot add your own custom map types that are not provided by typemap, due to coherence restrictions
[21:05:45] <JoshTriplett> OK, I think I'm missing something obvious, but how can I define a type parameterized by other types?  For instance, struct foo(a, b) where a and b are types specified by the user of foo.
[21:05:51] <bstrie> CuriousCain: let us know if you get it working, I'd love to hear your experience with it
[21:05:55] *** Joins: mkpankov (mkpankov@moz-04h.70f.16.195.IP)
[21:05:55] *** Joins: Guest67 (textual@moz-og7.cn8.251.116.IP)
[21:05:58] *** Joins: dmac__ (dmac@moz-2ig65r.ca.comcast.net)
[21:06:00] <reem> JoshTriplett: struct Foo<A, B>(A, B);
[21:06:06] <reem> just like generics on fns
[21:06:12] *** Quits: anders (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[21:06:20] <CuriousCain> bstrie: I will do. I think I've found a way to work around it
[21:06:24] <JoshTriplett> reem: Ah, got it.  Confused by the overlap between that and lifetime syntax. :)
[21:06:33] *** Joins: RCIX (RCIX@moz-vnmep7.ph.cox.net)
[21:06:37] <blaenk> that sucks having to do clone_to_any_sync etc
[21:06:54] *** Quits: twipeD (wipeD@moz-s6k22a.dip0.t-ipconnect.de) (Connection closed)
[21:06:57] *** Quits: Shackra (Jorge@moz-7bh.ng6.177.186.IP) (Ping timeout: 121 seconds)
[21:07:04] <reem> blaenk: meh it’s not so bad, it’s actually a rather clever use of method-level-where-clauses where the alternative would be 4 different traits!
[21:07:15] <blaenk> yeah better than that
[21:07:54] <reem> Let me know if you think of types of maps which would be nice to have
[21:07:58] <reem> since typemap has to provide them all
[21:08:04] <blaenk> why does it have to?
[21:08:06] <blaenk> I was about to ask about that
[21:08:16] <blaenk> cause chris seems to have opted for no aliases
[21:08:20] <reem> If you look in the internals.rs module, see the Implements trait?
[21:08:24] <blaenk> you have to specify Map<CloneToAny + Sync + Send> etc
[21:08:39] <blaenk> which made me wonder how you pulled it off since you say you don't export CloneToAny
[21:08:41] <reem> You can’t correctly add impls of that trait
[21:09:01] <JoshTriplett> error: can't find crate for `num`
[21:09:04] <reem> blaenk: I just abused a well-known hack that lets you have private types in public signatures
[21:09:06] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[21:09:11] <blaenk> oh haha
[21:09:12] <JoshTriplett> What do I need to do to make "extern crate num" work?
[21:09:12] <reem> blaenk: which is a private inner module
[21:09:24] <JoshTriplett> (Or is that the wrong way to get at num?)
[21:09:35] <reem> blaenk: rustc’s privacy checking just checks if something is declared with `pub`
[21:09:45] <reem> JoshTriplett: add num as a dependency in your Cargo.tol
[21:09:46] <reem> toml*
[21:09:50] <blaenk> but say you have a struct with a CloneMap right, and you want to have a method that takes a value of a type that you forward/insert into the clonemap. what bounds would you use on that T?
[21:09:56] <JoshTriplett> reem: "rustc quicktest.rs"
[21:10:02] <blaenk> cause it seems to me that with anymap, I have to use a T: CloneToAny bound
[21:10:05] <reem> blaenk: T: Clone + Any
[21:10:07] <blaenk> but you don't expose that so
[21:10:09] <blaenk> ooo
[21:10:12] <blaenk> I'm gonna see if that works over here
[21:10:19] <reem> blaenk: Implements is entirely an implementation detail.
[21:10:19] <JoshTriplett> reem: please tell me I don't have to switch to cargo anytime I want to build a quick and dirty one-file test program.
[21:10:21] <blaenk> cause I didn't much like having to import/use CloneToAny
[21:10:46] <reem> JoshTriplett: You need to use Cargo any time you want external dependencies, unless you want to get the source/compile/link yourself.
[21:10:48] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[21:10:58] *** Quits: dmac__ (dmac@moz-2ig65r.ca.comcast.net) (Ping timeout: 121 seconds)
[21:10:58] <steveklabnik> due to lack of custom allocator support, i can't really use Vec with memory allocated outside of Rust, eh?
[21:11:01] <JoshTriplett> Wait, num is external?  I thought it shipped with rust?
[21:11:01] <steveklabnik> or so it seems
[21:11:12] <blaenk> reem that's typemap's Any, right, not std's?
[21:11:12] *** Quits: Diggsey (diggsey@moz-o8tmhf.dsl.pipex.com) (Ping timeout: 121 seconds)
[21:11:14] <reem> steveklabnik: You can’t.
[21:11:18] <blaenk> in Clone + Any
[21:11:19] <reem> blaenk: no, it’s std’s
[21:11:21] <blaenk> ooooo
[21:11:23] <blaenk> that's nice
[21:11:26] <blaenk> hoping it works here
[21:11:29] <reem> typemap does not have a custom Any
[21:11:32] <steveklabnik> reem: yeah, that's what it looks like. bummer. oh well
[21:11:39] *** Joins: srh (User@moz-fmnn73.unps.r1c6.fb90.2607.IP)
[21:11:49] *** cmr is now known as cMr
[21:11:52] *** cMr is now known as cMR
[21:11:55] <reem> steveklabnik: there are various third party crates with allocator support, iobuf comes to mind.
[21:11:58] <blaenk> reem: yeah I keep getting confused between the tabs I'm looking at
[21:12:18] *** Joins: Diggsey (diggsey@moz-o8tmhf.dsl.pipex.com)
[21:12:22] <steveklabnik> reem: maybe i'll check it out. this thing i'm doing is a toy anyway, i might even just write a vec-like class
[21:12:51] <reem> a dead-simple Vec is pretty short to write, so that might be the best thing to do
[21:12:55] <steveklabnik> yeah
[21:13:05] *** Quits: demelev (Mibbit@moz-5qbmjd.dyn.idknet.com) (Quit: http://www.mibbit.com ajax IRC Client)
[21:13:12] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Connection closed)
[21:13:16] <reem> as long as you don’t need iterators, those are a bit more of a pain
[21:13:27] <steveklabnik> i do not
[21:13:29] <reem> though actually you can just go through the slice iterators
[21:13:37] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[21:14:02] *** Quits: frankmcs_ (frankmcsher@moz-tamqcd.dyn.telefonica.de) (Connection closed)
[21:14:03] *** Quits: mkpankov (mkpankov@moz-04h.70f.16.195.IP) (Connection closed)
[21:14:03] *** Joins: mkpankov` (mkpankov@moz-ggj.3mh.23.84.IP)
[21:14:15] <blaenk> sweet it does work. I do have to use CloneAny to create a clonemap though, Map<CloneAny> but w/e
[21:15:16] *** Joins: woowe (Mibbit@moz-499ogh.wi.charter.com)
[21:16:34] *** Joins: playjax (chatzilla@moz-dcai92.optusnet.com.au)
[21:17:09] *** Quits: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:19:06] *** Joins: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net)
[21:21:56] *** Quits: drewm1980 (drewm1980@moz-b5ce5a.hujf.dasj.1812.2a02.IP) (Ping timeout: 121 seconds)
[21:22:04] *** Quits: Harry (Mibbit@moz-944vti.ga.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:22:35] <proc> Ok(()) still seems odd only to return a pos. error ^^
[21:23:05] *** Joins: khades (Thunderbird@moz-u45.3vk.74.212.IP)
[21:23:50] <Drek> I use this -> http://mibpaste.com/LqXeWi <- to get a number from stdin but it seems a bit too complicated for something that simple can I somehow write it better?
[21:24:47] *** Joins: kazimuth (james@moz-h7l.35b.189.18.IP)
[21:25:06] *** Joins: chc4 (chc4@moz-pdo0at.ma.comcast.net)
[21:25:29] <Havvy> The .is_ok() should probably be .ok().unwrap() or possibly just .unwrap().
[21:25:54] *** Quits: gingermusketeer (gingermuske@moz-t9ngvg.compute.amazonaws.com) (Connection closed)
[21:26:03] *** Joins: gingermusketeer (gingermuske@moz-bkgmse.compute.amazonaws.com)
[21:26:47] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[21:27:39] <bstrie> Drek: let me see
[21:27:46] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[21:28:14] <rkruppe> Result::unwrap panics with the error description, so that's definitely preferable
[21:28:33] <rkruppe> Drek: is_ok() only returns a boolean which you then discard, so that's not doing anything
[21:29:02] *** bvssvni is now known as bvssvni_
[21:29:27] *** Quits: ekiwi (kevin@moz-a2becv.halifax.rwth-aachen.de) (Client exited)
[21:29:55] <Drek> Ok that makes sense changed  is_ok() to unwrap()
[21:30:22] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[21:31:54] *** Quits: genbattle (genbattle@moz-9fu7hj.xtra.co.nz) (Ping timeout: 121 seconds)
[21:31:56] *** Joins: errordeveloper (ilya@moz-fmp.00e.200.90.IP)
[21:32:14] <Drek> Is there something like "\f" that forces a flush?
[21:32:22] <blaenk> .flush() I think
[21:32:23] <blaenk> lol
[21:33:18] *** Quits: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[21:33:19] <aatch> slimsag, current status of SIMD: it's ok-ish. You can generally convince the compiler to do what you want, but it's difficult to get it to generate anything outside of the main arithmetic and shuffle instructions.
[21:34:27] *** Quits: Uther (Thunderbird@moz-gssp49.fbx.proxad.net) (Client exited)
[21:35:09] <aatch> slimsag, however, it is an area that we want to improve.
[21:35:16] *** Quits: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net) (Ping timeout: 121 seconds)
[21:35:26] <JoshTriplett> aatch: Are there intrinsics that can be used to manually do what you want?
[21:35:52] <aatch> JoshTriplett, nope
[21:36:05] *** Quits: errordeveloper (ilya@moz-fmp.00e.200.90.IP) (Ping timeout: 121 seconds)
[21:36:18] <aatch> Even shuffling is a bit of a hack
[21:36:23] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[21:36:27] <JoshTriplett> aatch: Might it make sense to offer (a package of) intrinsics similar to those of gcc?
[21:36:32] *** Joins: enricostn (enricostn@moz-nsqccj.dynamicIP.rima-tde.net)
[21:36:42] <JoshTriplett> Then people can at least write manually optimized code.
[21:37:18] *** Joins: DerisiveLogic (smuxi@moz-g93io6.res.rr.com)
[21:37:37] <Murarth> JoshTriplett: Well, there's this: http://doc.rust-lang.org/std/simd/
[21:38:25] <aatch> JoshTriplett, probably. I have a rough idea about having a 3-tier system: Top layer is similar to what we have now (just a bit nicer), with built-in support for arithmetic and maybe some other things.
[21:39:00] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[21:39:12] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[21:39:17] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[21:39:26] <aatch> JoshTriplett, next layer is "common intrinsics", basically stuff that is difficult to have syntax for, but is pretty standard functionality across platforms and different SIMD types.
[21:39:32] *** Quits: colinsurprenant (colin@moz-lu9sne.92.electronicbox.net) (Client exited)
[21:39:38] <JoshTriplett> Given a trait function like Bounded::max_value() and a context that can't infer the return type (e.g. println!), how can I specify which return type I want?
[21:39:44] <JoshTriplett> "as" doesn't seem to be the right answer.
[21:39:55] <JoshTriplett> But max_value::<T> didn't work either.
[21:40:19] <aatch> And the lowest tier is the platform-specific intrinsics, like NEON
[21:40:24] <JoshTriplett> Obviously I can use a separate "let", but I'm wondering how to avoid that.
[21:40:25] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[21:40:38] <aatch> JoshTriplett, <T as Bounded>::max_value()
[21:40:56] <JoshTriplett> Ah.
[21:41:07] <blaenk> you don't need to do that unless T already has a method called max_value I think
[21:41:13] <JoshTriplett> Oh, wait, do I actually need the "as Bounded", or can I just write ...yeah.
[21:41:15] *** Joins: Uther (Thunderbird@moz-gssp49.fbx.proxad.net)
[21:41:29] <blaenk> Bounded::max_value(the_t) should work too though
[21:41:30] <aatch> Oh right, I keep forgetting that works now.
[21:41:54] <JoshTriplett> blaenk: wait, how does *that* one work?  the_t::max_value() would make sense, but...
[21:42:02] <blaenk> it's called UFCS
[21:42:13] <blaenk> there's an rfc (or two or three?) on it that go in detail
[21:42:27] *** Joins: mib_31huwt (Mibbit@moz-or840r.cam.ac.uk)
[21:42:33] <blaenk> but you don't necessarily need UFCS to hint the return type
[21:42:46] <JoshTriplett> OK, now I'm confused about something else.
[21:42:46] <aatch> blaenk, except that max_value is a static method.
[21:42:49] <blaenk> ahh
[21:42:52] <JoshTriplett> I wrote this:     let t = tuple<u32, u16>::max_value();
[21:43:05] <mib_31huwt> If it possible to do a decreasing for loop?
[21:43:05] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[21:43:09] <JoshTriplett> And I got an error about the ',' saying error: expected one of `!`, `.`, `::`, `;`, `{`, or an operator, found `,`
[21:43:28] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[21:43:33] <blaenk> tuple<u32, u16>? is that your own type?
[21:43:36] <JoshTriplett> yes.
[21:43:41] <JoshTriplett> struct tuple<A, B>(A, B);
[21:43:50] <rkruppe> JoshTriplett: The error message is bad, but type parameters in expression contexts must be supplied with tuple::<T, U>::(...)
[21:43:53] <aatch> JoshTriplett, any reason not to use the built-in tuple?
[21:44:14] <JoshTriplett> aatch: Because I can't "impl<A, B> Bounded for (A, B)", since I don't define either () or Bounded.
[21:44:22] <JoshTriplett> Local experiment before submitting a patch. :)
[21:44:29] <JoshTriplett> I wanted a sample structure.
[21:44:40] <JoshTriplett> rkruppe: Why is that, exactly?
[21:44:53] <aatch> JoshTriplett, parsing ambiguity
[21:44:55] <JoshTriplett> (and yeah, the error message could use some work)
[21:45:05] <JoshTriplett> aatch: How so?  What would tuple< ... mean?
[21:45:12] <JoshTriplett> Given that tuple is a type.
[21:45:13] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[21:45:18] <aatch> JoshTriplett, what if it isn't a type?
[21:45:20] *** Quits: sysko (bst@moz-qau.e3g.230.116.IP) (Quit: Leaving.)
[21:45:23] <rkruppe> The parser doesn't know what's a type and what's a variable
[21:45:28] <JoshTriplett> rkruppe: Ah, OK.
[21:45:29] <aatch> JoshTriplett, we don't know that during parsing.
[21:45:30] <JoshTriplett> That would do it.
[21:45:43] <rkruppe> In fact, you can have types and bindings that have the same name (I think?)
[21:45:51] <JoshTriplett> Trying to avoid the standard C/C++ parsing issue where you need feedback from the type system into the parser?
[21:45:58] *** streblo is now known as streblo|away
[21:46:14] <aatch> JoshTriplett, trying to avoid a context-sensitive grammar? Yes.
[21:46:19] *** Quits: skade (skade@moz-6athcr.pools.vodafone-ip.de) (Connection closed)
[21:46:27] *** Joins: skade (skade@moz-6athcr.pools.vodafone-ip.de)
[21:46:35] <rkruppe> (Actually, no, you can not)
[21:46:52] <JoshTriplett> Different silly question: Why is it I can use the type "Self" in a type signature inside an impl, but I can't use that same type in an expression as a constructor?
[21:47:04] <rkruppe> Because Rust needs more polish :P
[21:47:05] <Tiffany> rkruppe: http://is.gd/OvKagQ
[21:47:16] <JoshTriplett> rkruppe: Is that one on the todo list somewherE?
[21:47:17] <JoshTriplett> *e
[21:47:57] *** Quits: mib_31huwt (Mibbit@moz-or840r.cam.ac.uk) (Quit: http://www.mibbit.com ajax IRC Client)
[21:48:00] *** Quits: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it) (Ping timeout: 121 seconds)
[21:48:38] <aatch> JoshTriplett, using Self in impls is quite new. It's designed for use with macros
[21:49:16] <JoshTriplett> aatch: Right, makes sense; that way you don't repeat yourself.
[21:49:25] <JoshTriplett> Would just be nice to repeat myself even less. :)
[21:49:28] <steveklabnik> i have a *mut Foo, how do I get a &mut Foo? Foo is a struct
[21:49:39] <aatch> steveklabnik, transmute
[21:49:44] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[21:49:56] <blaenk> I don't think you need to transmute do you? I thought just like &*thefoo
[21:50:06] <steveklabnik> yeha i thought there was a non-transmute way
[21:50:18] <aatch> blaenk, oh right, that'll probably work.
[21:50:18] *** streblo|away is now known as streblo
[21:50:36] <blaenk> steveklabnik: I recommend this book by steve klabnik http://doc.rust-lang.org/book/raw-pointers.html#references-and-raw-pointers
[21:50:41] <steveklabnik> blaenk: hehehe
[21:50:44] <blaenk> :>
[21:50:46] <steveklabnik> i was looking there!
[21:50:52] <blaenk> seriously though I always forget too and I always jump to that section
[21:50:54] <steveklabnik> yeah
[21:51:04] <blaenk> like I type rust book in chrome and it shows that link first
[21:51:05] <steveklabnik> so, while I _think_ I'm fine. i get a segfault. sooooo hahaha
[21:51:10] <blaenk> :/
[21:51:14] <steveklabnik>     let mut a = unsafe { &mut *a };
[21:51:20] <steveklabnik> maybe that's it
[21:51:22] <JoshTriplett> Can play.rust-lang handle "extern crate num" somehow?
[21:51:34] <aatch> JoshTriplett, no
[21:51:37] <steveklabnik> JoshTriplett: maybe for the ones provided by the team, but not for arbitrary  ones
[21:51:43] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[21:51:50] <blaenk> it's probably the `a` that's messed up. can you access it raw and it works and everything?
[21:51:54] <JoshTriplett> steveklabnik: Right, that's what I meant; given that num is shipped with rust...
[21:51:54] *** rkruppe_ is now known as rkruppe
[21:51:59] <blaenk> or put up rust-gdb to track the segfault
[21:52:00] <JoshTriplett> (or at least, I thought it was...)
[21:52:24] <steveklabnik> blaenk: maybe, gonna start digging in.
[21:52:28] <steveklabnik> i have... several layers here
[21:52:30] <blaenk> good luck man
[21:52:52] *** Joins: jvshahid (jvshahid@moz-8o45ja.res.rr.com)
[21:52:53] <JoshTriplett> Well, in any case, for bounded tuples, here's an example: http://is.gd/lqv9n7
[21:52:58] *** Joins: brainproxy (michael@moz-9vjtig.mo.charter.com)
[21:53:02] <JoshTriplett> I'm going to see if I can prepare a patch for that.
[21:53:24] <blaenk> oh you want to propose a patch to the num crate to impl Bounded for your custom tuple type?
[21:53:32] <jvshahid> hey everyone
[21:53:34] *** Quits: kmicu (kmicu@moz-uga.edn.218.91.IP) (Client exited)
[21:53:37] <blaenk> worth a shot, but I don't imagine it'll be accepted
[21:53:39] <JoshTriplett> blaenk: No, I want to propose a patch to implement it for the built-in tuples. :)
[21:53:45] <blaenk> ooo, yeah
[21:53:51] <blaenk> those are always a pain, but there's macros I think
[21:53:53] <JoshTriplett> Using a custom Tuple type was just so that I could actually write it. :)
[21:53:57] <blaenk> check other std trait impls, they might help you out
[21:54:07] <JoshTriplett> blaenk: I'm also hoping to implement it for things like Timespec.
[21:54:15] <blaenk> the other std trait impls usually employ a macro to impl it for tuples of various sizes
[21:54:17] <JoshTriplett> blaenk: Though I suspect that impl belongs in time.
[21:54:18] <blaenk> cool
[21:54:23] <blaenk> yeah probably
[21:54:25] <JoshTriplett> blaenk: I'll take a look; thanks.
[21:54:27] <blaenk> but see
[21:54:37] <blaenk> I don't know how it'd work in time, cause then time would depend on num
[21:54:45] <blaenk> a dependency anyone would want to introduce
[21:54:52] <blaenk> *I doubt anyone
[21:54:57] <blaenk> er scratch that whole last line, what
[21:55:07] <JoshTriplett> blaenk: Seems more sensible than making num depend on time. :)
[21:55:09] <blaenk> yeah, a dependency I doubt anyone would want to introduce
[21:55:17] <blaenk> hahahaha, idk, worth a shot though
[21:55:25] <blaenk> that's why I was saying that earlier
[21:55:32] <JoshTriplett> I'm also wondering if perhaps someday Bounded might move into the core.
[21:55:33] <blaenk> that it sucks cause if it's in neither, then you'd have to wrap timespec to impl it
[21:55:34] <blaenk> afaik
[21:55:37] *** Quits: blech__ (blech@moz-4lmalb.fios.verizon.net) (Quit: Leaving)
[21:56:16] <JoshTriplett> Can traits have const values?
[21:56:56] <aatch> JoshTriplett, not at the moment
[21:58:01] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[21:59:19] *** Joins: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it)
[22:00:46] *** streblo is now known as streblo|away
[22:01:09] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[22:01:09] <steveklabnik> blaenk: ha! my rust was fine, the c calling it wasn't ;)
[22:01:21] <steveklabnik> i was passing rust the wrong pointer
[22:01:45] <JoshTriplett> Would it be reasonable for the rustdoc section "Implementors" to link to the source of the impl?
[22:02:14] <JoshTriplett> Because I'm trying to find where the implementation of Eq for tuples lives.
[22:02:24] <JoshTriplett> And it'd be nice if http://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html had a link.
[22:02:58] <aatch> JoshTriplett, look at the page for tuple primitive in std
[22:03:06] <JoshTriplett> aatch: Thanks.
[22:03:09] <aatch> JoshTriplett, they're generated with macros though
[22:03:18] <JoshTriplett> That's why I'm looking for them, to find those macros.
[22:04:06] <JoshTriplett> https://github.com/rust-lang/rust/issues/24484
[22:05:04] *** Joins: arty (Mibbit@moz-ineiim.il.comcast.net)
[22:05:41] *** Joins: Porkepix_ (Porkepix@moz-tql.n6g.213.64.IP)
[22:06:07] <woowe> Finalllyyy!!! The binascii.unhexlify() thing is DONE http://is.gd/K0iYQJ
[22:06:13] *** Joins: blank_name (blank_name@moz-sct.ivp.36.50.IP)
[22:06:15] <Drek> How do I compare values of different integer types? 
[22:07:06] <JoshTriplett> Drek: Convert them to a type that can contain both.
[22:07:11] *** Joins: mystal (mystal@moz-tt1.co9.14.76.IP)
[22:07:39] <JoshTriplett> Drek: if some_u32 as u64 < some_u64
[22:07:41] <jvshahid> is there a way to access c header files from rust ?
[22:08:01] *** Joins: mib_0039ho (Mibbit@moz-5039uj.ca.comcast.net)
[22:08:03] <JoshTriplett> Drek: No implicit integer conversions in rust.
[22:08:04] *** Quits: Porkepix (Porkepix@moz-71m.3nd.202.89.IP) (Ping timeout: 121 seconds)
[22:08:05] <steveklabnik> jvshahid: bindgen exists, which will automatically make rust code out of a .h
[22:08:30] *** Joins: Guest74 (textual@moz-lmfinb.fios.verizon.net)
[22:08:41] <jvshahid> steveklabnik: i can't use it because it relies on features that are forbidden in beta
[22:09:13] <Drek> So if I have u32 and usize I should transform both to usize?
[22:09:15] *** Joins: gopar (gopar@moz-5039uj.ca.comcast.net)
[22:09:24] *** Quits: mib_0039ho (Mibbit@moz-5039uj.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:09:42] <JoshTriplett> Drek: Yeah, that sounds reasonable.
[22:09:49] *** Joins: fyl2xp11 (fyl2xp1@moz-efe6g9.netcologne.de)
[22:10:04] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[22:10:14] <aatch> It's what C would insert for you
[22:11:02] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Quit: Leaving)
[22:11:06] *** Quits: fyl2xp1 (fyl2xp1@moz-89qsn2.netcologne.de) (Ping timeout: 121 seconds)
[22:11:06] *** Quits: csherratt (colin@moz-357qdq.cable.teksavvy.com) (Quit: Konversation terminated!)
[22:11:12] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:11:16] <steveklabnik> jvshahid: ah yeah, everything like that is gonna, at the moment
[22:11:33] *** Joins: vairav (vairav@moz-ms3.on0.126.76.IP)
[22:11:37] <aatch> Heh, Gauss-Jordan Elimination may be more accurate than using Cramer's rule (for matrix inversion), but man is it slow.
[22:11:52] <aatch> ~250ns vs 20ns
[22:12:54] <steveklabnik> rust q i don't know the answer to: "Does it have anything like GCC's __attribute__ for specifying sections and interrupt handlers? "
[22:13:14] <jvshahid> steveklabnik: does that mean i have to manually generate the types ? I'm worried by using bindgen i'll always depend on nightly builds, is that correct ?
[22:13:38] <aatch> steveklabnik, as far as I know, no
[22:13:39] <geofft> steveklabnik: sections, yes. is there an attribute for interrupt handlers? 
[22:13:40] <steveklabnik> jvshahid: yeah, you'd have to do it by hand. and, you can just run bindgen with a nightly compiler, the output isn't dependent on a particular rust version
[22:13:53] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Quit: Leaving)
[22:14:00] <steveklabnik> geofft: no clue
[22:14:04] <steveklabnik> geofft: what's our sections thing?
[22:14:07] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:14:10] <geofft> steveklabnik: `#[link_section=".myawesomesection"]` 
[22:14:12] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Connection closed)
[22:14:13] *** Quits: Rym (y@moz-rmaga4.range86-187.btcentralplus.com) (Connection closed)
[22:14:14] <steveklabnik> ahhh
[22:14:15] <aatch> We have a sections thing?!
[22:14:22] <jvshahid> steveklabnik: thanks
[22:14:28] <aatch> When did that happen?
[22:14:34] <geofft> aatch: yeah I implemented __attribute__((constructor)) using it <_< >_> 
[22:14:35] * aatch feels out of the loop
[22:14:45] *** Joins: Izacht13 (Izacht13@moz-788tg0.east.myfairpoint.net)
[22:14:47] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:14:51] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Connection closed)
[22:14:55] <rkruppe> Drat, I'm submitting PRs too fast
[22:14:58] <steveklabnik> looks like gcc has __attribute__((interrupt( irq )))
[22:15:02] <aatch> geofft, `#[link_section=".ctor"]`?
[22:15:12] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:15:14] <rkruppe> My next PR is built on top of a previous one that's not merged yet, how can I submit it anyway?
[22:15:17] <JoshTriplett> geofft: Does that mean you can write an extern for __start_sectionname and __stop_sectionname to get at the contents?
[22:15:26] <geofft> aatch: http://is.gd/5cOYnt 
[22:15:30] *** Joins: Rym (y@moz-rmaga4.range86-187.btcentralplus.com)
[22:15:31] <geofft> make sure you run it at -O0 
[22:15:42] <geofft> also it only works with glibc, but what do you expect with weird things like this :) 
[22:15:44] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Quit: Leaving)
[22:16:01] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:16:06] *** Quits: areski (areski@moz-d74mrb.user.ono.com) (Ping timeout: 121 seconds)
[22:16:07] <geofft> JoshTriplett: hrrm, does that work? what provides those symbols? 
[22:16:17] <JoshTriplett> geofft: The linker, by default.
[22:16:19] <aatch> rkruppe, submit it on top the other PR, but say that it requires that change.
[22:16:38] <JoshTriplett> geofft: If you have a section foo, you'll get symbols __start_foo and __stop_foo that point to the beginning and end of the sections.
[22:16:43] <JoshTriplett> geofft: One moment, I'll post an example.
[22:17:02] *** Quits: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net) (Quit: Leaving)
[22:17:02] <XMPPwocky> geofft: heh i did that too
[22:17:04] <aatch> rkruppe, that means you can get the review, but it won't get approved.
[22:17:08] *** Joins: DemonOne (Avi@moz-o1ngmi.cablep.bezeqint.net)
[22:17:12] <XMPPwocky> geofft: got lazy_static! without a mutez
[22:17:13] <rkruppe> aatch: Both will be rollup (doc changes), and the second doesn't actually require the first
[22:17:18] <XMPPwocky> Mutex, een
[22:17:22] <rkruppe> It's only commited on top of it
[22:17:30] <rkruppe> Hm, maybe I should just make another branch
[22:17:30] <XMPPwocky> this laptop keyboard *screams internaly*
[22:17:48] <steveklabnik> rkruppe: which PRs are you talking about?
[22:17:52] <terpstra_> is it known behaviour that ‘cargo doc’ doesn’t rebuild the documentation until you’ve done a ‘cargo clean’ ?
[22:17:53] <steveklabnik> none of them have been approved
[22:18:08] <steveklabnik> or rather, the approved ones all got merged
[22:18:12] <steveklabnik> the queue is basically empty
[22:18:18] <aatch> rkruppe, ah, probably just make a clean branch then.
[22:18:26] <rkruppe> steveklabnik: The first one is the 24825, the second isn't up yet
[22:19:31] <rkruppe> Gah, I already pushed the commit and now it's on the first PR
[22:19:38] <rkruppe> I'm not fit to use GitHub -.-
[22:19:50] *** Quits: giucam_ (giucam@moz-iv0nnc.bb.dnainternet.fi) (Ping timeout: 121 seconds)
[22:20:16] <steveklabnik> rkruppe: it's fine
[22:20:23] * aatch revokes rkruppe's git license
[22:20:25] <steveklabnik> homu wasn't recognizing that commit as being buildable?
[22:20:48] <rkruppe> I pushed it just now, homu should ignore it and focus on the commit you approved
[22:21:04] <steveklabnik> eh
[22:21:12] <steveklabnik> i just r+d the new one
[22:21:13] <steveklabnik> with both
[22:21:16] *** Joins: KLP (KLP@moz-qdcjho.res.rr.com)
[22:21:45] <steveklabnik> so don't worry about it, it's cool
[22:21:49] <phildini> is it possible to download an html- or pdf-exported version of the rust book? would appreciate being able to learn rust while traveling, etc.
[22:21:54] <aatch> geofft, hmm, I wonder if having an attribute to force a symbol to be "exported" in a binary would be helpful
[22:22:04] <steveklabnik> phildini: you have an HTML version locally
[22:22:08] <steveklabnik> phildini: the installer installs one
[22:22:18] <steveklabnik> phildini: we want to make PDF/EPUB again at some point, haven't yet
[22:22:23] <phildini> oh-ho! how do I access the local copy?
[22:22:26] <aatch> geofft, (since it's why optimisation breaks your code sample)
[22:22:29] <steveklabnik> what OS are you on?
[22:22:38] <phildini> mac.
[22:22:43] <steveklabnik> hmm, don't remember offhand
[22:22:51] <steveklabnik> on linux it's in /usr/local/something
[22:22:51] <aatch> geofft, but it might be useful more generally.
[22:22:51] <phildini> (also hi geofft!)
[22:23:03] *** Quits: qard (qard@moz-nekdha.vc.shawcable.net) (Connection closed)
[22:23:09] <phildini> steveklabnik: I'll try googling.
[22:23:15] * aatch checks to see if such a attribute already exists
[22:23:32] *** Joins: Vivitron (user@moz-u8q.vvq.199.198.IP)
[22:24:35] <JoshTriplett> geofft: Pasting an example now.
[22:24:46] *** Quits: sillesta (sillesta@moz-501od2.business.telia.com) (A TLS packet with unexpected length was received.)
[22:25:05] *** Quits: squiddy (squiddy@moz-5pd6hi.dyn.telefonica.de) (Quit: Leaving)
[22:25:31] *** Joins: sillesta (sillesta@moz-501od2.business.telia.com)
[22:25:43] <JoshTriplett> geofft: http://pastebin.com/UQfPiBxm
[22:26:29] *** Quits: mkpankov` (mkpankov@moz-ggj.3mh.23.84.IP) (Quit: Bye)
[22:26:59] <aatch> geofft, (and JoshTriplett if you're interested) lookee here: http://is.gd/S1KcaC
[22:27:01] <JoshTriplett> geofft: That's exactly the trick glibc uses to implement things like ctors
[22:27:22] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[22:27:46] <aatch> You have to be on nightly, but you can turn optimisations on with that
[22:28:19] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[22:28:30] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[22:29:34] *** Joins: colinsurprenant (colin@moz-lu9sne.92.electronicbox.net)
[22:29:36] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[22:29:38] *** Quits: viel (zeroknowled@moz-2k31nn.retail.telecomitalia.it) (Ping timeout: 121 seconds)
[22:30:21] <JoshTriplett> Where can I find the actual implementation of tuple.rs?
[22:30:47] <XMPPwocky> tuple.rs ?
[22:31:38] <JoshTriplett> XMPPwocky: https://github.com/rust-lang/rust/blob/master/src/libstd/tuple.rs is empty except for documentation and a couple of compiler directives.
[22:31:55] *** Quits: arty (Mibbit@moz-ineiim.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:32:03] *** Joins: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net)
[22:32:22] <XMPPwocky> oh, right
[22:33:31] <geofft> aatch: oh, useful 
[22:33:35] *** Quits: terpstra_ (terpstra@moz-0hmt5t.hrz.tu-darmstadt.de) (Client exited)
[22:33:40] *** Quits: Guest74 (textual@moz-lmfinb.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:33:53] <geofft> yeah, I found that optimizations don't kill it in a library, but do in a binary 
[22:34:11] <aatch> geofft, it's because we mark all symbols as internal by default in a binary.
[22:34:11] *** Joins: mnemnion (mnemnion@moz-e8rfii.ca.comcast.net)
[22:34:35] <aatch> geofft, so if you don't use it, then it'll be removed.
[22:34:45] *** Joins: Guest74 (textual@moz-lmfinb.fios.verizon.net)
[22:34:57] <aatch> geofft, except for the entry point of the binary, of course.
[22:35:06] <XMPPwocky> aatch: but i thought only public symbols were exported in a liblriay
[22:35:08] <XMPPwocky> library, even
[22:35:11] *** Joins: numeric (Mibbit@moz-thg0qm.om.cox.net)
[22:35:14] *** Quits: logan_e (logan_e@moz-ltn.qg3.218.73.IP) (Client exited)
[22:35:17] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Ping timeout: 121 seconds)
[22:35:19] <aatch> XMPPwocky, sure
[22:35:21] *** Quits: Guest67 (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:35:35] <aatch> XMPPwocky, but you don't even have that option in a binary.
[22:35:39] <XMPPwocky> hm, right
[22:36:05] *** Joins: Shackra (Jorge@moz-7bh.ng6.177.186.IP)
[22:36:06] <aatch> We support most of the linkage types LLVM has (actually, all of the ones that actually *do* anything)
[22:36:08] <steveklabnik> what's the libc type for a string? *mut u8?
[22:36:32] <geofft> *mut c_char, which is either i8 or u8 depending on how people feel about the 1980s 
[22:36:33] <andor> does a macro's argument/what it matches on have to be valid rust?
[22:36:35] <steveklabnik> right
[22:36:40] *** Joins: mkpankov (mkpankov@moz-ggj.3mh.23.84.IP)
[22:36:41] <andor> i'm not sure that question makes sense at all
[22:36:52] <geofft> but which can be `as *mut u8` or `as *mut i8` without trouble 
[22:37:02] <steveklabnik> cool
[22:37:22] <aatch> So you can do things like weak linkage, or appending
[22:37:46] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[22:37:57] <kimundi> andor: It can be an arbitrary list of tokens - so not just Rust syntax, but also not a free stream of characters afaik
[22:38:21] <aatch> andor, macros work on "token trees" which are sequences of tokens and/or token trees surrounded by a balanced pair of delimeters.
[22:38:32] <geofft> JoshTriplett: hm, however Rust is invoking the linker, __start_<section> seems to not work 
[22:38:46] *** Quits: CuriousCain (Mibbit@moz-jcvu2r.cable.virginm.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:38:48] <geofft> JoshTriplett: http://is.gd/0iQusq 
[22:38:55] <geofft> also, LLVM has a more-recommended way of doing this 
[22:38:57] *** Joins: Guest67 (textual@moz-og7.cn8.251.116.IP)
[22:39:21] <aatch> andor, so basically anything that tokenizes and has matching parens/brackets/braces
[22:39:25] <numeric> Is there any way to return a &T to a value that doesn't exist in my data structure? I want my Index implementation to return 0 if it can't find any other value.
[22:39:28] <andor> okay, so i'm terrible at macros, and what i want to match on is basically `expr[inner?:inner?]`, inner being `<integer constant><optional exclamation mark>`
[22:39:35] <geofft> #[linkage="appending"] probably? http://llvm.org/docs/LangRef.html#linkage-types 
[22:39:36] *** Quits: dgrunwald (Daniel@moz-76qm54.hsi4.kabel-badenwuerttemberg.de) (Connection closed)
[22:39:38] <andor> so for example `foo[:10!]`
[22:39:57] <XMPPwocky> numeric: yes, you can have a static 0
[22:40:00] <XMPPwocky> and return a reference to that
[22:40:21] <steveklabnik> geofft: so, basically, i have a chunk of memory allocated by c, and i want rust to append to it. should i try to get a mut slice out of that *mut c_char? thoughts?
[22:40:27] <steveklabnik> err
[22:40:31] <steveklabnik> by append to it i mean write to it
[22:40:38] <steveklabnik> i know there's enough space
[22:40:45] *** Quits: mkpankov (mkpankov@moz-ggj.3mh.23.84.IP) (Ping timeout: 121 seconds)
[22:40:56] <XMPPwocky> steveklabnik: yeah, could use a Cursor<&mut [u8]> there
[22:40:59] <JoshTriplett> geofft: They're implemented by the default linker script; if you're not using the default, then they won't exist.
[22:41:00] *** Quits: blaztinn_ (blaztinn@moz-hg7bqt.dynamic.amis.net) (Client exited)
[22:41:09] <steveklabnik> XMPPwocky: hmm, haven't seen Cursor, interesting
[22:41:18] <aatch> JoshTriplett, we use the system linker.
[22:41:23] <XMPPwocky> it's pretty handy
[22:41:31] <numeric> XMPPwocky: Thank you!
[22:41:31] <JoshTriplett> aatch: Right, but do you use the system linker script?
[22:41:36] <steveklabnik> XMPPwocky: how do i do *mut c_char -> &mut [u8]?
[22:41:39] <aatch> JoshTriplett, as far as I know.
[22:41:40] <geofft> well, whatever playbot is doing doesn't seem to let it work 
[22:41:51] *** Quits: colinsurprenant (colin@moz-lu9sne.92.electronicbox.net) (Client exited)
[22:41:57] <geofft> and oh wow playbot gets upset at #[linkage="appending"] http://is.gd/DkgTae 
[22:42:00] <XMPPwocky> steveklabnik: well, you can c_char to u8 pretty easily
[22:42:23] <XMPPwocky> but *mut T to &mut T with a correct lifetime is awfully hacky for some reason
[22:42:33] <geofft> steveklabnik: std::slice::from_raw_parts does this I think 
[22:42:36] <steveklabnik> geofft: ahhh
[22:42:41] <steveklabnik> thanks, i didn't see that
[22:42:46] *** Quits: niconii (nicole@moz-dt9bve.frgo.qwest.net) (Ping timeout: 121 seconds)
[22:42:54] <steveklabnik> i looked, lol
[22:42:57] <XMPPwocky> steveklabnik: most of the useful functions will give you &'static mut [u8] or whatever
[22:43:04] <XMPPwocky> so you have to be a little careful
[22:43:11] <geofft> from_raw_parts gets you a &'a [T] 
[22:43:23] <geofft> where 'a isn't mentioned anywhere else in the function signature 
[22:43:25] <geofft> which is kind of awesome 
[22:43:35] <XMPPwocky> right, so iirc that just ends up equivalent to &'static
[22:43:47] <XMPPwocky> since without an upper bound it'll just infer to whatever you want it to
[22:43:57] *** Quits: numeric (Mibbit@moz-thg0qm.om.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:44:30] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[22:44:39] <geofft> phildini: I just installed on a Mac with --prefix=~/geofft, and it's in ~/geofft/share/doc/rust/html just like it would be on Linux 
[22:44:40] *** Joins: niconii (nicole@moz-5e9nqt.frgo.qwest.net)
[22:44:53] <geofft> idk what happens if you leave off --prefix on Mac, but probably /usr/local 
[22:44:56] <geofft> also hi :) 
[22:45:01] <XMPPwocky> http://is.gd/wwa0Qo
[22:45:02] <Drek> How to use string parse with a genric type? Example -> http://is.gd/Xmn5NU
[22:45:11] *** Quits: dfinninger (dfinninger@moz-sqqguu.res.rr.com) (Connection closed)
[22:45:30] <XMPPwocky> Drek: so that won't work for any arbitrary type
[22:45:35] *** Joins: dfinninger (dfinninger@moz-sqqguu.res.rr.com)
[22:45:38] <XMPPwocky> it only works for types that implement the trait std::str::FromStr
[22:46:25] <XMPPwocky> http://is.gd/cbHaDt soo if you restrict it to just types that implement that trait
[22:46:40] <aatch> geofft, appending only works with arrays, so you have to make a [T;n]
[22:46:54] <XMPPwocky> then change the .unwrap() on line 17 to .ok().unwrap() because unwrap() needs to print the error
[22:46:57] *** Joins: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP)
[22:47:11] <XMPPwocky> but not all types that implement FromStr have an error type that is printable
[22:47:49] <aatch> geofft, how you figure out that you're at the end of the final symbol is a mystery to me though.
[22:47:50] *** Quits: brson (brson@moz-a8s.c9m.56.172.IP) (Quit: leaving)
[22:48:25] <Drek> Ok thanks 
[22:48:36] <XMPPwocky> Drek: it's also possible to restrict T further
[22:48:53] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[22:49:05] <steveklabnik>             slice[0] = b"["[0] as i8;
[22:49:05] <XMPPwocky> to only types that implement FromStr,  and where FromStr's error type is Debug (Debug is a trait used for printing most things)
[22:49:08] <steveklabnik> ahhaha that's terrible
[22:49:13] *** Joins: mkpankov (mkpankov@moz-ggj.3mh.23.84.IP)
[22:49:26] *** Quits: xrl (uid1091@moz-f0543s.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[22:49:26] <XMPPwocky> steveklabnik: '[' as i8 ?
[22:49:38] *** Quits: dfinninger (dfinninger@moz-sqqguu.res.rr.com) (Ping timeout: 121 seconds)
[22:49:38] <steveklabnik> nice
[22:49:39] <steveklabnik> lol
[22:49:40] <aatch> playbot: b'['
[22:49:42] -playbot- 91
[22:49:54] <steveklabnik> but it's not always one character
[22:50:02] <aatch> That's a u8 though
[22:50:02] <XMPPwocky> steveklabnik: oh yeah good luck
[22:50:03] <XMPPwocky> lol
[22:50:04] <steveklabnik> heh
[22:50:06] <steveklabnik> :(
[22:50:52] <Drek> XMPPwocky: What would be the syntax for that?
[22:51:28] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[22:51:33] *** Joins: SpaceManiac (Mibbit@moz-g50q8a.dyn.suddenlink.net)
[22:51:57] *** Quits: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:52:09] <steveklabnik> hahah it works
[22:52:26] <jvshahid> steveklabnik: just tried rust-bindgen, my mind is blown :) but all the generated definitions reference ::libc::*. I'm assuming that won't work with beta either, would it ?
[22:52:42] *** Quits: Douman (Douman@moz-30pipa.dynamic.mts-nn.ru) (Quit: )
[22:52:43] <steveklabnik> jvshahid: :)
[22:52:51] <XMPPwocky> Drek: http://is.gd/OIPJeM
[22:52:52] <steveklabnik> as long as you use the libc crate from crates.io, that works from beta
[22:53:20] <XMPPwocky> that "where" clause is equivalent to where the bounds on T were previously (inside the angle backets)
[22:53:28] <XMPPwocky> but you can also put bounds on associated types with where clauses
[22:53:44] <jvshahid> steveklabnik: cool, thanks again
[22:54:14] *** Quits: Quanttek (quassel@moz-25k96c.6fkd.dvrb.8108.2a02.IP) (Ping timeout: 121 seconds)
[22:54:57] <Drek> XMPPwocky: Thanks that's cool
[22:55:06] *** Joins: Tarmashirin (Tarmashirin@moz-qql.m59.199.117.IP)
[22:55:41] <steveklabnik> XMPPwocky: https://github.com/steveklabnik/bad_idea/blob/master/src/lib.rs#L58-L74
[22:55:43] <steveklabnik> hahaha
[22:55:47] <steveklabnik> so bad
[22:55:58] <XMPPwocky> steveklabnik: [screams internally]
[22:56:22] <XMPPwocky> what is that supposed to be
[22:56:34] <XMPPwocky> there is a Cargo.toml a Gemfile a Makefile and a Rakefile
[22:56:36] <steveklabnik> no see it's fine https://github.com/steveklabnik/bad_idea/blob/master/ext/bad_idea/bad_idea.c#L38-L40
[22:56:41] <XMPPwocky> i'm so confused
[22:56:45] <steveklabnik> it's a ruby gem
[22:56:51] <steveklabnik> that replaces the built-in Array class with some Rust code ;)
[22:57:07] <XMPPwocky> why is C involved :(
[22:57:13] <steveklabnik> ruby has gross c macros
[22:57:21] <XMPPwocky> mmm
[22:57:22] <steveklabnik> so like https://github.com/steveklabnik/bad_idea/blob/master/ext/bad_idea/bad_idea.c#L34-L36
[22:57:29] *** Joins: tno (tomas@moz-jp41om.7pm2.so41.08a0.2001.IP)
[22:57:38] <steveklabnik> Data_Get_Struct is a macro which converts a VALUE to a c type
[22:57:38] <XMPPwocky> oh, i thought that was a real function
[22:57:44] <XMPPwocky> non-capitalized macros :(
[22:58:04] <JoshTriplett> Macro question: can I not match something like     ( $($init:ident)* $tail:ident ) => (
[22:58:05] <XMPPwocky> maybe they could be distinguished with some sort of trailing character, like an exclamation mark... nah, that'd never work
[22:58:13] <JoshTriplett> Does the macro system require something LL1 or similar?
[22:58:13] <steveklabnik> :)
[22:58:24] *** Quits: Temur (Tarmashirin@moz-5td.qve.199.117.IP) (Ping timeout: 121 seconds)
[22:58:26] *** Quits: minot2 (kkus@moz-sh2.44e.234.165.IP) (Connection closed)
[22:59:53] <XMPPwocky> Drek: one extra thing you can do is remove the ::<T>  on line 19
[22:59:56] <XMPPwocky> Drek: rust can infer that
[23:00:45] *** Joins: colin_ (colin@moz-357qdq.cable.teksavvy.com)
[23:00:54] *** Quits: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:01:23] *** colin_ is now known as csherratt
[23:01:24] *** Quits: erz (erz@moz-n2p94l.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:01:56] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[23:02:12] <SpaceManiac> Is there a specific reason that there's both Borrow and AsRef traits?
[23:02:17] <steveklabnik> SpaceManiac: yes!
[23:02:30] <steveklabnik> SpaceManiac: https://github.com/rust-lang/rust/issues/24163
[23:03:05] <JoshTriplett> OK, here's a fun macro error: `$h:ident` is followed by a sequence repetition, which is not allowed for `ident` fragments
[23:03:11] <JoshTriplett> "why" would be nice to know...
[23:03:13] <blaenk> look at the rust book macros section
[23:03:19] <blaenk> it used to delineate which things could follow what
[23:03:24] <blaenk> maybe still does
[23:03:26] <SpaceManiac> Thanks, that clears it up
[23:03:30] <Rym> steveklabnik: Does this not require #[repr(C)] to have guaranteed layout? https://github.com/steveklabnik/bad_idea/blob/master/src/lib.rs#L20
[23:03:36] <steveklabnik> yes, it does
[23:03:38] <steveklabnik> nice catch
[23:03:53] *** Joins: jxv (jxv___@moz-2celrt.res.rr.com)
[23:03:55] *** Quits: ai (ai@moz-pqofrl.sunline.net.ua) (Quit: Leaving.)
[23:04:03] *** Joins: ai (ai@moz-pqofrl.sunline.net.ua)
[23:04:03] *** Joins: rmgk_ (ragnar@moz-vbv4uh.dyn.telefonica.de)
[23:04:09] <blaenk> josh http://doc.rust-lang.org/book/macros.html#syntactic-requirements
[23:04:16] <JoshTriplett> blaenk: "Other variables may be followed by any token."
[23:04:23] <JoshTriplett> blaenk: (and the preceding items don't mention ident)
[23:04:28] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:04:32] <rkruppe> JoshTriplett: Not LL(1), but unambigious. If I'm right, this is RFC 550 https://github.com/rust-lang/rfcs/blob/master/text/0550-macro-future-proofing.md
[23:05:14] <rkruppe> Wait, with all of them being indent, it's not ambiguous
[23:05:15] <JoshTriplett> rkruppe: OK, that much is fine.
[23:05:22] <JoshTriplett> rkruppe: Ah, OK. :)
[23:05:29] <JoshTriplett> rkruppe: then yeah, it'd be nice if that worked. :)
[23:05:29] <rkruppe> I see what you mean, that seems to be an overly restrictive rule
[23:05:31] *** Quits: Porkepix_ (Porkepix@moz-tql.n6g.213.64.IP) (Quit: My laptop has gone to sleep. ZZZzzz…)
[23:05:45] <JoshTriplett> rkruppe: I'll report it as an issue.
[23:06:31] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Ping timeout: 121 seconds)
[23:07:29] *** Quits: rmgk (ragnar@moz-diaoju.dyn.telefonica.de) (Ping timeout: 121 seconds)
[23:08:18] *** Quits: Guest18 (textual@moz-gur296.abo.wanadoo.fr) (Quit: Textual IRC Client: www.textualapp.com)
[23:09:54] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[23:10:14] <JoshTriplett> rkruppe: https://github.com/rust-lang/rust/issues/24827
[23:10:43] <steveklabnik> XMPPwocky: cursor helped a lot, thanks https://github.com/steveklabnik/bad_idea/commit/27c89c0387a98ea8598ecba08ff65906fa0c0039
[23:10:57] <csherratt> Is there a way to have a test timeout?
[23:11:30] <rkruppe> JoshTriplett: Honestly I'm not sure if I want this fixed, a comma separated list is generally easier to read
[23:11:57] *** Quits: edlothiol (user@moz-chhfor.hsi02.unitymediagroup.de) (Ping timeout: 121 seconds)
[23:12:16] *** Joins: aney1 (Emanuel@moz-4pi170.dyn.drei.com)
[23:12:26] <JoshTriplett> rkruppe: I suppose, but if the thing the macro is being expanded into has the tokens written without the comma, then the comma seems obfuscating.
[23:12:50] <rkruppe> JoshTriplett: Now I'm curious, what does it expand to?
[23:13:20] <SpaceManiac> Is it just the coherence rules preventing 'impl<T> AsRef<T> for T', or is its absence intentional?
[23:13:35] <JoshTriplett> rkruppe: In this case, to the invocation of another macro written to accept ( $($name:ident)* )
[23:13:57] <rkruppe> JoshTriplett: AFAIK that won't work because of how macros are expanded
[23:14:06] <JoshTriplett> How so?
[23:14:08] <rkruppe> Try to write it with the comma delimiters and see if it works
[23:14:24] <rkruppe> Macros are expanded... I don't know what's a good term for it, but the wrong way for this kind of thing
[23:14:32] <rkruppe> cf. the book
[23:14:45] <JoshTriplett> rkruppe: Trying that now.
[23:15:08] <JoshTriplett> Well, in any case, comma delimiters don't fix the parsing ambiguity either.
[23:15:26] <JoshTriplett> I still get a "local ambiguity" warning even if I put a ,* instead of a *.
[23:15:42] *** Parts: aney1 (Emanuel@moz-4pi170.dyn.drei.com) ()
[23:15:43] *** Quits: Guest74 (textual@moz-lmfinb.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:15:43] <geofft> aatch: hm, I'd assume it's the usual "your last symbol must contain a sentinel value" thing, but I suppose order isn't guaranteed across .o files..? 
[23:16:29] *** Quits: erikj (erikj@moz-dsm7da.skybroadband.com) (Quit: Leaving)
[23:16:38] *** Quits: larhat (Adium@moz-tb1ulb.cable.virginm.net) (Quit: Leaving.)
[23:16:51] <Drek> When I use 'fmt::Result::Ok(())' I get "type `core::result::Result<(), core::fmt::Error>` does not implement any method in scope named `Ok`"? So how do I return Ok from an fmt::Display impl?
[23:17:07] *** Quits: Vivitron (user@moz-u8q.vvq.199.198.IP) (Connection closed)
[23:17:09] *** Quits: _petr (petr@moz-2pi.7q8.248.178.IP) (Ping timeout: 121 seconds)
[23:17:23] <rkruppe> JoshTriplett: Your macro rule is probably subtly wrong, but I don't know enough about macros to debug it (other than by shuffling symbols around, which you can do too). Maybe someone else can help?
[23:17:30] <cacaca> steveklabnik: I have a question
[23:17:45] <steveklabnik> cacaca: sup
[23:18:03] *** Quits: skade (skade@moz-6athcr.pools.vodafone-ip.de) (Quit: Textual IRC Client: www.textualapp.com)
[23:18:03] <geofft> also, here's what I spent the last couple days on: https://github.com/geofft/redhook 
[23:18:10] <JoshTriplett> rkruppe: I'm rewriting it to flip it to head:tail rather than init++last, which should eliminate "local ambiguity"; let's see if that works as a workaround (since in this particular case it's unintuitive but valid).
[23:18:15] <cacaca> steveklabnik: I try to use hyper crate, but everytime that make a static linking
[23:18:18] <geofft> a macro for writing LD_PRELOAD and dealing with all the weird corners 
[23:18:28] <cacaca> How to dynamic link a crate ?
[23:18:46] <steveklabnik> cacaca: http://doc.crates.io/manifest.html#building-dynamic-or-static-libraries
[23:18:55] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[23:19:17] <cacaca> I will take a look.
[23:20:15] <JoshTriplett> rkruppe, blaenk: Nope, looks like even with a comma added in between, I still get a complaint about following ident with a sequence repetition.
[23:20:23] <JoshTriplett> error: `$h:ident` is followed by a sequence repetition, which is not allowed for `ident` fragments
[23:20:39] <JoshTriplett> Complaining about a match of the form: ( $h:ident $(, $t:ident)* ) => (
[23:20:42] *** Quits: Nuk9 (Nuk9@moz-8ga.fob.151.142.IP) (Connection closed)
[23:21:02] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[23:21:03] <cacaca> steveklabnik: I saw that before but it produce a libhyper.so, but what I must do next to that.
[23:21:16] <cacaca> I put the .so into the /usr/lib
[23:22:26] <cacaca> but even with -C prefer-dynamic, the executable is too heavy, 4Mb, i don't know what is happenning, 
[23:22:39] <steveklabnik> do you have LTO on?
[23:22:49] <steveklabnik> though i guess that' doesn't help as much with dynamic linking
[23:23:44] <cacaca> No, I made cargo verbose and I paste the command and there was not LTO, I am rechecking this for be sure.
[23:24:00] *** Quits: Lilly (Lilly@moz-pfkvo9.bredband.comhem.se) (Quit: bajs)
[23:24:14] <JoshTriplett> rkruppe, blaenk: Looks like I've hit https://github.com/rust-lang/rust/issues/21545 .
[23:24:15] <blaenk> are you building in release mode
[23:24:41] <cacaca> blaenk: only a simple build for debug.
[23:25:07] <blaenk> well that includes all the debug symbols I think, though I'm not sure how much it would affect the size
[23:25:40] <blaenk> woah my binary is 24 MB hehe
[23:25:44] <blaenk> first time I looked
[23:26:24] <aatch> Debug symbols can take up *a lot* of space.
[23:26:31] <blaenk> there you go then
[23:26:43] <cacaca> blaenk: Actually, the only thing that I want it is to have a quick compilation, especially when I am testing hyper, otherwise it would be difficult to make something.
[23:27:00] <blaenk> oh, in that case there's not much to help afaik, not yet
[23:27:11] <aatch> On my old laptop, I had to to shutdown firefox if I wanted to build HHVM with debug symbols, since it'd OOM during linking because of the debug symbols.
[23:27:13] <blaenk> focus has been on the language mostly, compiler speedups will come soon
[23:27:20] <blaenk> lol
[23:27:44] <aatch> I think there's around 1G of debug symbols for HHVM, it's a big project though.
[23:29:02] <polyfractal> when you move a value into a function (e.g. something non-negligible, like a struct), what happens under the covers?  Is the whole struct copied?  Or does it just reuse the same memory and the compiler makes note that it moved?
[23:29:05] <aatch> Apparently you convince the various parts of the toolchain to use a separate file for debug symbols on Linux.
[23:29:14] <cacaca> Yes, but it is not really great for webdev,or debuging.
[23:29:17] <blaenk> yeah in release mode it went from 24M to 4.6M
[23:29:18] <aatch> polyfractal, a move is a shallow copy.
[23:29:27] <seanmonstar> polyfractal: the bytes are copied
[23:29:34] <Drek> How do I return Ok from a Display impl? (http://is.gd/SODdlC) "error: type `core::result::Result<(), core::fmt::Error>` does not implement any method in scope named `Ok`"
[23:29:45] <blaenk> polyfractal: it's like a C++11 move
[23:29:53] *** Joins: Guest74 (textual@moz-lmfinb.fios.verizon.net)
[23:29:56] <aatch> Drek, just Ok(())
[23:30:04] <cacaca> blaenk: It is faster or not to turn off the release mode ?
[23:30:05] <seanmonstar> Drek: probably easiest to just leave off the last semincolon
[23:30:10] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[23:30:10] *** lerxst|pto is now known as lerxst
[23:30:12] <polyfractal> great, thanks everyone :)
[23:30:16] <blaenk> cacaca: I think release mode compiling is even slower, but that's just my experience
[23:30:19] <seanmonstar> cacaca: will be slower
[23:30:21] <blaenk> the binary size is much smaller though
[23:30:25] <seanmonstar> It does optimization passes
[23:30:47] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[23:30:49] <blaenk> cacaca: like I said, the focus hasn't been on the compiler speed. they wanted to stabilize the language and other things first. I'm sure soon they'll start to really optimize the compiler
[23:30:52] *** Joins: lenstr (lenstr@moz-9uh.vju.25.171.IP)
[23:30:59] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[23:31:11] <Amaranth> Knocked 10% of the time it takes to compile the compiler itself with a recent change iirc
[23:31:15] <Drek> aatch: Why just Ok()?
[23:31:25] <Amaranth> So there is definitely some low hanging fruit on the compiler performance
[23:31:35] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[23:31:35] <blaenk> Drek: Ok(()) not Ok()
[23:31:38] <Drek> seanmonstar: What do you mean the last semincolon is inside a for loop
[23:31:40] <bstrie> Drek: `Ok()` is a function that takes a single argument
[23:31:53] <cacaca> I think it is the complete opposed philosophy of Go, language before speed.
[23:31:54] *** Quits: lenstr (lenstr@moz-9uh.vju.25.171.IP) (A TLS packet with unexpected length was received.)
[23:32:07] <blaenk> cacaca: ... the point is that the language wasn't even finished yet
[23:32:21] <bstrie> cacaca: first we had to demonstrate that this language was possible, we'll make the compiler fast next :P
[23:32:27] <blaenk> so they wanted to finish the language before starting to optimize the compiler. if they started optimizing the compiler as the language was developing, then a lot of work would be thrown out the window
[23:32:32] <seanmonstar> Drek: ah, sorry. Many implementations of Display have lines like write!(...) 
[23:32:35] <blaenk> whenever there was a fundamental/huge breaking change
[23:32:39] <aatch> cacaca, well yeah. It's also a language that puts runtime performance and compile-time safety first.
[23:32:53] <rkruppe> I'm sure the Go guys are happy with their language, but yes, the way it's designed, it will probably always compile faster than Rust
[23:32:53] *** Joins: OmniMancer (OmniMancer@moz-6m1jrb.xtra.co.nz)
[23:33:00] *** Quits: forgottenone (forgottenon@moz-7c3.s8g.45.92.IP) (Quit: Konversation terminated!)
[23:33:15] *** Quits: SpaceManiac (Mibbit@moz-g50q8a.dyn.suddenlink.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:33:25] <bstrie> rkruppe: I dunno, the D guys like to tout that their compiler is faster than go's
[23:33:27] <blaenk> cacaca you speak another language?
[23:33:30] <geofft> also, different languages are good at different things 
[23:33:41] <rkruppe> bstrie: Well, Walter White is a wizard. And D is not Rust.
[23:33:42] <geofft> I <3 Rust but I would not use it for rapid-iteration development for a webapp backend 
[23:33:55] <bstrie> rkruppe: I see no reason why rust should necessarily have a slower compiler than D :P
[23:34:08] <swgillespie> if D's compiler is really that fast, that's amazing
[23:34:11] <blaenk> not yet at least, we haven't even really started really focusing on optimizing the compiler, who knows what the future will bring :D
[23:34:16] <rkruppe> Walter Bright, not Walter White. I don't even watch breaking bad o.O
[23:34:21] <aatch> bstrie, well... dmd is fast, but the output isn't great.
[23:34:28] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[23:34:28] <geofft> I also (kinda) <3 Python but I would not use it for writing, like, an SSL implementation 
[23:34:31] *** Quits: playjax (chatzilla@moz-dcai92.optusnet.com.au) (Connection closed)
[23:34:33] <bstrie> aatch: that's the whole point of -O0
[23:34:50] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[23:34:56] <aatch> bstrie, the gcc and llvm backend compilers are a fair bit slower.
[23:35:02] <SiegeLord> The one time I recall when they tried to compare Go and D compile speeds was when they compiled Phobos
[23:35:10] <SiegeLord> Which is 99% uninstantiated templates
[23:35:15] <polyfractal> followup question: if you wanted to write a "push" method for a collection, would it be better to deref some kind of pointer handle, instead of moving the value into the collection?  Then you'd just change a single pointer, instead of a shallow copy of the entire struct?
[23:35:26] <bstrie> aatch: wonder if it would be worth us having a `cargo check` command that compiles a file but stops before codegen, just for people who want to check their work
[23:35:27] <geofft> in like a few years I want my Python webapps to be running on a Rust-based HTTPS / QUIC implementation :) 
[23:35:35] <seanmonstar> geofft: not for a prototype, but for a designed Web app, the speed and fewer crashes would be nice
[23:35:36] <geofft> but that's different from wanting my webapps to be in Rust 
[23:35:45] <cacaca> blaenk: You said before that Rust prefer a stable syntax, and then a  fast compiler, I just notice that D and Go is rather opposite to that : they prefer have a fast compiler and then new syntaw features (but it is only my feelings).
[23:35:57] <aatch> bstrie, maybe, the compiler already supports that, so it'd be relatively easy to do.
[23:36:00] <geofft> Go also hit language stability like two years ago 
[23:36:07] <bstrie> cacaca: go hasn't added a new feature in four years, and conversely D breaks things all the time
[23:36:10] <blaenk> cacaca: do you speak another language? I think something is being lost in translation
[23:36:11] <geofft> ... four 
[23:36:16] <swgillespie> Go's compiler was also not written in Go for a long time
[23:36:18] <geofft> https://blog.golang.org/go-becomes-more-stable 
[23:36:26] <geofft> 16 March 2011 was Go's 15 May 2015 
[23:36:27] *** Quits: Guest67 (textual@moz-og7.cn8.251.116.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:36:50] <niconii> bstrie, aatch: i think it'd be helpful, yeah
[23:37:04] <geofft> time flies when you're having fn() 
[23:37:07] <bstrie> haha
[23:37:12] <blaenk> cacaca: it isn't that rust necessarily prefers a stable syntax over compiler speed. it's that it doesn't make sense to optimize the compiler before we even finish designing the language. what if we make a huge change that removes some feature? then all of that work we spent on optimizing that feature of the language would have been wasted
[23:37:14] <steveklabnik> TWIR rught there
[23:37:18] *** Quits: tigrou3tac (fabien@moz-gdonfo.fbx.proxad.net) (Ping timeout: 121 seconds)
[23:37:30] <bstrie> geofft: I'm sure there are some languages out there that use `fun` instead of `fn` or `func` or `function`
[23:37:41] <aatch> LISP (kinda)?
[23:37:48] <aatch> `defun`
[23:37:54] <cacaca> blaenk: Before I was speaking about Rust, but I made a parralel view with Go language,
[23:37:56] <bstrie> aatch: that's exactly what we don't want
[23:38:05] <burntsushi> bstrie: i think Standard ML does.
[23:38:09] <blaenk> cacaca: I give up lol
[23:38:23] <seanmonstar> cacaca: he's asking if you speak something besides English
[23:38:26] <swgillespie> fun is used for function literals in some ML family languages
[23:38:48] <blaenk> the point is that it doesn't make sense to ascribe that philosophy to rust. just because we haven't started optimizing the compiler doesn't mean we don't care about that
[23:38:52] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[23:39:08] <blaenk> but yes, go's compilation speed is one of it's major goals/focuses
[23:39:14] <bstrie> compiler speed is one of the biggest priorities post-1.0, to whoever is actually asking
[23:39:19] <blaenk> the point is it doesn't really make sense to conclude that it isn't one of rust's yet
[23:39:24] <aatch> Actually, if you talk to several of the core team members, compiler performance is one of the main priorities post-1.0
[23:39:25] <blaenk> s/yet/at all
[23:39:46] <bstrie> aatch: don't need to even ask them, compiler speed is right at the top of niko's "priorities post-1.0" post :)
[23:39:49] <burntsushi> swgillespie: in SML, `fun` is used to define a named function and `fn` is used for anonymous functions.
[23:40:05] *** Joins: druzac (druzac@moz-hn17us.vc.shawcable.net)
[23:40:15] <geofft> you people take all defun out of making a simple pun 
[23:40:28] <aatch> burntsushi, I think OCaml uses `fun` for both.
[23:40:28] <swgillespie> burntsushi: I guess i'm thinking more ocaml and f#
[23:40:47] <burntsushi> swgillespie, aatch: oddly enough, i've never written ocaml. only SML.
[23:40:54] <swgillespie> burntsushi: i'm the opposite :P
[23:41:19] *** Quits: Drek (Mibbit@moz-e29q96.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[23:41:42] <cacaca> blaenk: It is not a complaint. I understand that I must for now not use huge a big library like hyper with a slow computer, 
[23:42:27] *** Joins: cjwelborn (cjwelborn@moz-np6hed.al.charter.com)
[23:42:27] <geofft> cacaca: not sure if this works for you, but I've been reasonably happy with doing Rust work on a cloud server / VPS 
[23:42:54] <geofft> of course, RAM is the most expensive thing, and I'm only paying for a 1GB RAM server, which is not even close to enough to build rustc :( 
[23:43:04] <cacaca> Yes, that seems a great option but that needs $$$
[23:43:20] <geofft> yeah :( 
[23:43:34] <woowe> Hey guys I have an error I have no idea about what it means, it says "rust cannot borrow immutable data in a reference"
[23:44:03] *** Quits: tamird (textual@moz-oii9i6.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:44:04] <woowe> Wait sorry
[23:44:05] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[23:44:11] <woowe> it says cannot borrow data mutably in a `&` reference
[23:44:32] *** Joins: choplin (choplin@moz-bdqat7.t6mc.g9m6.001a.240d.IP)
[23:44:51] <steveklabnik> woowe: so you have an &T, but you're trying to mutate it. doesn't work. you need an &mut T
[23:44:52] <cacaca> I am waiting for that, do you know where we could follow the progression of that ?
[23:44:59] <myname> woowe: you have something you are forbidden to change and want to give something permissions to it
[23:45:04] <myname> woowe: you cannot do that
[23:45:16] <woowe> Oh, okay
[23:45:18] <woowe> thanks!
[23:45:42] *** Quits: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca) (Ping timeout: 121 seconds)
[23:46:24] *** Joins: tamird (textual@moz-50o.0di.141.50.IP)
[23:46:57] *** Joins: arty (Mibbit@moz-ineiim.il.comcast.net)
[23:47:30] <heftig> is the book expected to be complete by the time of the 1.0 release?
[23:48:04] <seanmonstar> cacaca: an app I have depending on hyper compiles in 7s
[23:48:13] <seanmonstar> And it doesn't keep compiling hyper.. M
[23:48:27] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[23:49:07] <cacaca> seanmonstar: I simple hello world take more than one minute to compile with cargo, 
[23:50:00] <seanmonstar> cacaca: does it say "compiling hyper" each time? 
[23:50:20] <cacaca> seanmonstar: Only compiling hello_world
[23:50:53] <rkruppe> So if I have an open PR, can I *replace* a (not yet approved) commit?
[23:51:13] <steveklabnik> yes
[23:51:18] <steveklabnik> though i'll r- it until you're done
[23:51:21] <seanmonstar> rkruppe: commit amend
[23:51:47] *** Quits: qrlpx (smuxi@moz-5td1up.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[23:52:08] <woowe> Okay so I am working on the mikrotik api port (http://is.gd/qvHbvV) and on line it gives me the error "cannot borrow `*self` as mutable more than once at a time". I am at a loss
[23:52:16] <steveklabnik> but yeah, you can do anything to the branch
[23:52:22] <seanmonstar> cacaca: a similar example without dependencies compiles faster? 
[23:52:41] <woowe> it is only a small bit of the api, because of the share size limit
[23:53:38] *** Quits: enricostn (enricostn@moz-nsqccj.dynamicIP.rima-tde.net) (Quit: Leaving)
[23:53:38] <rkruppe> Then I think I need to learn me more git-fu, because last time I tried that I ended up with two diverging commits (thankfully undid that before pushing)
[23:53:48] *** Quits: tomprogrammer (thomas@moz-h0ilaa.tr5r.qept.4dd0.2001.IP) (Quit: WeeChat 1.1.1)
[23:55:15] <heftig> woowe: what line?
[23:55:42] <cacaca> seanmonstar: An printf hello world compile faster than a hyper-server hello world for sure.
[23:55:53] <woowe> 47
[23:56:04] <woowe> Sorry
[23:56:06] *** Joins: arrdem (arrdem@moz-mho.ehc.170.107.IP)
[23:56:18] <heftig> woowe: also, your "new" is weird
[23:56:33] *** Quits: Shackra (Jorge@moz-7bh.ng6.177.186.IP) (Connection closed)
[23:56:36] *** Quits: tamird (textual@moz-50o.0di.141.50.IP) (Ping timeout: 121 seconds)
[23:56:47] *** Joins: qrlpx (smuxi@moz-n7t.3nb.211.95.IP)
[23:57:13] <rkruppe> steveklabnik: Okay, managed to amend the doc-comment fix. While I'm at it, should I roll the those fixes into the second commit? Logically it fits under its commit message
[23:57:17] <kimundi> rkruppe: By doing commit --ammend, you are replacing the top commit with a new one, so you indeed get a diverging history compared to the server repo. In those cases, you need to forcefully overwrite the servers history with git push -f
[23:57:19] <woowe> Is it? I would have no idea. I thought it was probably how everyone implemented there new() functions xD
[23:57:23] *** Quits: Guest74 (textual@moz-lmfinb.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:57:40] <seanmonstar> cacaca: then I don't know. It fast for me, once the dependencies have compiled. And I'm building a machine with 1gb of ram
[23:57:48] *** Joins: Guest21161 (Jorge@moz-7bh.ng6.177.186.IP)
[23:57:51] <rkruppe> kimundi: Yes, I (think I) understand git's internal data model, I just didn't know how to replace the branch head on the server
[23:58:01] <rkruppe> I pulled instead, but of course it merged
[23:58:03] <steveklabnik> rkruppe: no strong opinions
[23:58:32] <rkruppe> steveklabnik: I'll do it to get some more git exercise. I can use it :P
[23:58:38] <heftig> woowe: should probably be a static method like    fn new(&'a mut TcpStream) -> ApiRos<'a> { ApiRos { stream: s, currenttag: 0 } }
[23:58:39] <cacaca> seanmonstar: Just one question, do you have firefox open, or a recent processor ?
[23:58:50] *** Quits: kazimuth (james@moz-h7l.35b.189.18.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:58:55] *** Joins: tamird (textual@moz-ga7.n0o.141.50.IP)
[23:59:09] <heftig> woowe: that way you can do let a = ApiRos::new(stream);
[23:59:16] *** Joins: kazimuth (james@moz-h7l.35b.189.18.IP)
[23:59:27] <woowe> heftig: that would seem a lot more appropriate lol
[23:59:27] <seanmonstar> cacaca: no Firefox. It's a Linode server
[23:59:40] <woowe> heftig: Oh! Nice!!
[23:59:57] <heftig> new(s: &'a mut TcpStream)
