[00:52:16] <cmr> Seldaek: I don't know if I'll actually be able to get the type of the external item...
[00:52:24] <cmr> Oh wait
[00:52:29] <cmr> Hrm nevermind
[00:52:33] <cmr> You want like "struct" and stuff right?
[00:53:06] <cmr> I don't think I can do that
[00:53:19] <cmr> I could, it'd just be super messy.
[00:53:27] <cmr> Well, let me at least try it first.
[00:58:35] <Seldaek> yes I'd like struct or smth
[00:58:55] <Seldaek> just to disambiguate if there are different types with the same name 
[00:58:59] <cmr> right
[00:59:21] <Seldaek> if you can it'd be awesome, otherwise I'll see what I can hack together but it won't be 100% reliable
[01:06:29] <cmr> ALright got it
[01:06:33] <cmr> wasn't as messy as I thought it was
[01:06:39] <cmr> since you wanted something far simpler than I thought you did :)
[01:08:17] <cmr> Seldaek: std.json.gz and extra.json.gz have been updated, and the JSON schema has been bumped again
[01:08:42] <cmr> (I don't know if you actually use it or not, but I *do* use it to indicate breaking changes)
[01:09:08] <Seldaek> bytes!("foo") is equivalent to writing ['f' as u8, 'o' as u8, 'o' as u8] right?
[01:09:38] <Seldaek> yeah I "use" the schema, it fails hard whenever you bump it so I have to bump as well :p
[01:09:57] <Seldaek> it's not of a big use right now but it's good to have anyway
[01:09:57] <cmr> heh
[01:10:12] <cmr> Yes, that is what bytes!("foo") does
[01:10:27] <Seldaek> and that's compile time since it's a macro
[01:10:30] <cmr> yu
[01:10:32] <cmr> p
[01:10:44] <cmr> it doesn't actually do the casting though, it just outputs the numeric value directly
[01:11:13] <Seldaek> is the casting slower then?
[01:11:30] <cmr> takes more time to optimize, but doesn't have any runtime effect (when optimizations are on)
[01:29:47] <cmr> Seldaek: JSON updated with https://github.com/cmr/rustdoc_ng/issues/24 addressed. Added unsafe_pointer and borrowed types, and properly stringify numeric primitves (they're i8 i16 etc instead of just "int")
[01:31:49] <Seldaek> ok thanks, will see tomororw though
[02:13:06] <cmr> OH
[02:13:14] <cmr> I just figured out why typedefs are broken
[02:14:18] <cmr> All I do is stringify the path and ignore literally everything else, but the path has useful things like whether it's global and its types and stuff
[05:54:35] <cmr> Seldaek: Traits and everything finished :D
[05:55:02] <cmr> json on the server updated
[05:55:10] <cmr> I... forgot to bump the schema
[05:55:15] <cmr> but I didn't make any breaking changes
[09:10:45] <Seldaek> cmr: awesome, I'll check later/tonight
[13:43:38] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[14:00:48] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[14:06:03] <jedestep> cmr: for getting the full path (per your email) are you looking to get hte absolute path of the file on the filesystem? or just w.r.t the project root
[14:06:36] <jedestep> if you need the former, std::os::make_absolute will do it
[14:51:39] <cmr> jedestep: Path to the item in the module tree
[14:51:45] <cmr> acrichto helped me with it
[14:54:04] <jedestep> ah ok
[15:00:53] <Seldaek> cmr: lots of breakage to handle, but the json looks awesome, I just need this thing to build :p
[15:01:14] <jedestep> what is broken?
[15:01:30] <cmr> The next thing I'm going to fix is comment stripping btw
[15:01:35] <Seldaek> that'd be great yeah
[15:01:37] <cmr> but I have a bunch of triage to do
[15:02:03] <Seldaek> jedestep: well many small things in the json have changed and new things cause issues etc..
[15:02:17] <Seldaek> jedestep: problem is debugging this recursive async callback mess isn't always easy
[15:02:43] <Seldaek> it just blows up at some point and you don't even know what called it
[15:06:22] <Seldaek> ah I see. a generic refering to a typarams' id. I don't track those as entities
[15:06:43] <Seldaek> well, generic return value refering to the typaram
[15:06:51] <Seldaek> anyway..
[15:09:49] <Seldaek> no I actually do trakc those. crap.
[15:28:29] *** Quits: jga (asdf@B8ED0B.17C88DDC.B5524284.IP) (Connection reset by peer)
[15:36:32] <jedestep> I'm getting an "unwrap on Err result" error on all the tests
[15:37:29] <cmr> Oh you also need a patched rustc
[15:37:45] <jedestep> aw man I just rebuilt from master :(
[15:37:54] <cmr> Sorry :(
[15:37:56] <cmr> https://github.com/mozilla/rust/pull/8278
[15:37:58] <cmr> It apples on top of master though
[15:38:10] <cmr> probably not relevant
[15:38:26] <cmr> but yes
[15:38:30] <cmr> the tests currently ICE rustc
[15:38:42] <cmr> nothing will make them run
[15:38:51] <jedestep> that is not so good
[15:39:01] <Seldaek> cmr: so I just noticed an issue here.. lots of stuff is missing from the search index
[15:39:16] <cmr> jedestep: I've been using libstd to test
[15:45:37] *** Joins: jga (asdf@B61ECB4E.35F814CC.B5524284.IP)
[15:50:03] <Seldaek> cmr: ok one ice cream break later, it builds
[15:50:59] <jedestep> ice cream is an important part of debugging
[15:51:16] <cmr> ice cream, and sleep
[15:52:08] <Seldaek> 35Â°C makes you sleepy and want ice cream
[15:52:14] <Seldaek> so I guess that's a win
[15:52:19] <Seldaek> but it stlil feels too hot
[15:53:28] <Seldaek> cmr: is it normal that trait parents aren't valid ids? :)
[15:53:50] <cmr> Seldaek: nope
[15:54:00] <cmr> I'm probably doin' it wrong
[15:54:03] <Seldaek> ok
[15:54:06] <cmr> it should be the id of a trait
[15:54:14] <Seldaek> yes that's what I'd expect
[15:54:37] <Seldaek> though my code just takes an id and links to that no matter what it is, but if the id is invalid things go wrong
[15:55:19] <Seldaek> anyway, without parent linking, it still looks awesome I think http://seld.be/rustdoc/master/std/container/trait.MutableMap.html
[15:55:42] <cmr> Now list the structs that implement it!
[15:55:55] <Seldaek> yeah NOW :p
[15:56:02] <cmr> "not already exist in the map." that's a wonderful bit of documentation
[15:56:44] <cmr> Seldaek: With the information given, is it possible to list structs and stuff from other crates that implement a trait as well?
[15:56:59] <Seldaek> cmr: seems like a doc parsing bug too: https://github.com/mozilla/rust/blob/master/src/libstd/container.rs#L47-73
[15:57:01] <cmr> (but yes, it looks very awesome)
[15:57:04] <Seldaek> only the last line is returned
[15:57:15] <cmr> Oh
[15:57:20] <cmr> Ok, the docs make a lot more sense now :p
[15:57:39] <Seldaek> I'll check if it's in the json or not
[15:57:55] <Seldaek> ah yes ok
[15:58:07] <Seldaek> you return three {"doc":".."} attrs for those
[15:58:16] <Seldaek> I just loop through and the last found wins :)
[15:58:20] <cmr> Heh
[15:58:27] <Seldaek> easy fix though
[15:58:28] <cmr> Yes, I need to add a pass that merges them
[15:58:52] <Seldaek> but why is it all docs with ///? this is pretty uncommon and weird :/
[15:59:36] <cmr>  /// is the suggested style I think
[15:59:40] * cmr doesn't like it
[15:59:54] <jedestep> I actually like /// >.>
[16:00:05] <cmr> I don't like that it's the suggested style
[16:00:13] <cmr> I don't mind it, but I also like /**
[16:00:17] <jedestep> I always felt the /** *word *word *word */ was a little overkill
[16:00:20] <cmr> Especially for long blocks of documentation
[16:00:30] <cmr> Module docs, with /*!
[16:00:36] <jedestep> I like /** if I have an essay to write about my function
[16:01:15] <jedestep> but for something like "Returns whether or not the cursor is finished", /// is convenient and short
[16:01:53] <cmr> Yes, I agree
[16:02:06] <cmr> Also as long as we have multiple comment forms, it doesn't make sense not to allow them for doc comments
[16:02:41] <Seldaek> jedestep: I agree with /// usage for one liners, but for blocks it looks weird and seems to have poor editor support (at least mine doesn't, while it handles /** style very well)
[16:03:09] <Seldaek> anyway.. should I fix this or you do cmr ?
[16:04:05] <Seldaek> and more importantly, is there any other attr that can have multiple instances? :)
[16:04:41] <cmr> Seldaek: All attrs can validly have multiple instances
[16:04:45] <cmr> I am going to fix it
[16:05:57] <Seldaek> well I realize they can validly, but is there a case where they do? I guess it doesn't matter since doc is the only one I parse
[16:06:01] <Seldaek> and I just fixed that :p
[16:06:37] <Seldaek> uploaded new docs, looks better ;)
[16:07:08] <cmr> src links are broken
[16:07:13] <cmr> has two libstd
[16:07:16] <cmr> ...that's my fault
[16:07:45] * cmr ran it from src/ rather than src/libstd
[16:08:31] <Seldaek> ah ok good
[16:08:35] <Seldaek> I was wondering why
[16:09:55] <Seldaek> ok fixed links
[16:12:21] <Seldaek> ok and I improved the search so it indexes methods and variants
[16:12:31] <Seldaek> so you can search for stuff like "Some" and actually get a result
[16:12:37] <cmr> sweet
[16:12:40] <Seldaek> because that sort of thing is confusing when beginning IMO
[16:12:45] <cmr> yes it is
[16:12:58] <cmr> I remember bumbling into #rust and asking "what is Some? where can I find it?"
[16:13:06] <cmr> And I looked at the source and saw the variant
[16:13:10] <cmr> "but where is it?"
[16:13:35] * cmr thought it was a function
[16:13:39] <Seldaek> yeah it still freaks me out that variants are standalone entities
[16:14:05] <Seldaek> even when my enum is 2 lines above
[16:14:20] <Seldaek> I always want to try Foo.Variant 
[16:14:41] <Seldaek> it is pretty neat though for Option & Result
[16:17:36] <Seldaek> cmr: regarding your question about traits/impls, I'll see what I can do, but the bottom line is that for cross-crate linking since ids don't work I need a fully qualified name of the trait to match against, or it's not gonna happen
[16:17:47] <Seldaek> but if you do type external there as well it should work
[16:21:14] <cmr> it isn't, it is a special TraitRef thing
[16:21:22] <cmr> I'll see what I can do later
[16:24:01] <Seldaek> ok
[16:25:15] <Seldaek> cmr: same-crate linking should already be pretty useful, and probably good enough for most things
[16:25:36] <cmr> yup
[16:25:38] <cmr> but it's not perfect
[16:25:41] <cmr> and perfection is the goal
[16:25:43] <cmr> ;p
[16:25:43] <Seldaek> indeed 
[16:25:57] <Seldaek> if you can do perfect, I am not gonna complain
[16:29:25] <Seldaek> gee
[16:29:27] <Seldaek> "doc": "**************************************************************************\n * Internals\n ***************************************************************************"
[16:29:55] <Seldaek> once this is done, we really have to go over the source and clean up crappy docblocks 
[16:30:44] <Seldaek> http://seld.be/rustdoc/master/extra/sync/typedef.WaitEnd.html
[16:30:58] <Seldaek> the "hidden" bit is also fun, that's a "doc": ["hidden"] 
[16:31:23] <Seldaek> don't know why there's an array there
[16:31:32] <cmr> that's #[doc(hidden)]
[16:31:38] <cmr> supposed to not generate docs for it
[16:31:41] <cmr> my bug, not yours
[16:31:59] <Seldaek> ah ok
[16:32:52] <Seldaek> cmr: typedefs aren't fixed yet right? I'm starting to lose track of all the open issues in my head :)
[16:33:00] <cmr> Seldaek: nope
[16:33:57] <Seldaek> ok, and should I do anything with view_items?
[16:34:03] <Seldaek> I can't figure out what those are
[16:34:23] <cmr> Those are `extern mod foo;` and `use foo;` and `use bar = std::foo::bar` and `pub use consts::*`
[16:34:33] <cmr> they're kind of a mess right now
[16:34:37] <Seldaek> ok 
[16:34:43] <Seldaek> I'll wait for news from you then
[16:34:44] <cmr> don't do anything with them, I'll figure out how to clean them up a bit to make them useful
[16:35:10] <Seldaek> so only thing left on my end at the moment is the structs/impl/trait thing I think
[16:39:18] <Seldaek> oh I guess I should show the deriving attrs on structs
[16:39:28] <cmr> Shouldn't need to
[16:39:39] <cmr> The impls should apprear in the json
[16:39:42] <Seldaek> ah ok
[16:39:47] <Seldaek> that's even better
[16:41:44] <Seldaek> cmr: is a struct of type Newtype just a struct with one field? Should I render those in a special way or as a regular struct with one field?
[16:41:56] <cmr> Seldaek: it's a unit struct with one field
[16:42:00] <cmr> struct Foo(~str)
[16:42:07] <cmr> Erm, tuple struct with one field
[16:42:23] <cmr> Seldaek: they shouldn't be rendered special I think
[16:42:47] <Seldaek> ah right tuple is there already
[16:42:52] <Seldaek> I'll render them like that then
[16:54:48] <Seldaek> ok cya.. maybe I find time later for the impl but guess not today
[18:13:01] <jga> http://seld.be/rustdoc/master/std/option/enum.Option.html
[18:13:06] <jga> Theoptiontype
[18:15:17] <cmr> jga: yeah, known bug
[18:15:45] <jga> cmr: ah, ok, just reporting back
[18:16:17] <cmr> jga: usre, thanks
[19:01:09] <jedestep> cmr: you mentioned you're looking for some extra::serialize functionality. what specifically?
[19:01:31] <jedestep> I used that library a fair amount while doing BSON for mongodb
[19:01:54] <jedestep> (it's ridiculously confusing but I *think* I have it mostly figured out)
[19:02:42] <cmr> jedestep: Ideally the stuff in jsonify.rs wouldn't be needed, it'd just be #[deriving(Encodable)] or whatever it is on the stuff in clean
[19:02:49] <cmr> I don't really understand serialize whatsoever though
[19:04:06] <jedestep> ah ok I know how to take care of this
[19:04:37] <cmr> But clean would need to be cleaned up to use consistent field names, right? To get the desired JSON output?
[19:04:46] <jedestep> umm
[19:05:01] <jedestep> I'm not sure that it would
[19:05:17] <cmr> me either!
[19:05:22] <cmr> I have no idea how any of it works :)
[19:05:25] <jedestep> the idea behind this is you create a struct RustdocEncoder and implement extra::serialize::Encoder
[19:05:59] <jedestep> Encoder is basically a tree visitor with some bizarro callback structure
[19:07:01] <jedestep> so I don't think that clean would need to have consistent field names specifically, but it might require some shuffling
[19:07:22] <jedestep> depending on how the Encodable trait is derived (BSON has a custom implementation so I don't know what the default impl is like)
[19:07:46] <cmr> ok
[19:07:51] <cmr> that's kinda confusing
[19:07:57] <jedestep> it really is
[19:08:42] <jedestep> I spent a significant amount of time dealing with this, but that was also weeks ago
[19:17:41] <jedestep> actually, there is an encoder in extra::json. this might be able to deal with the derived impls automatically.
[19:40:07] <jedestep> is there any way to test rustdoc_ng on something a little smaller than libstd (since tests are broken for some reason now)
[19:41:36] <cmr> jedestep: run it on any crate
[19:41:44] <cmr> alternatively figure out why the tests ICE
[19:41:48] <cmr> (I haven't gotten to it yet)
[19:50:35] <jedestep> ok, deriving Encodable and using extra::json::Encoder seems to produce accurate json
[19:50:58] <jedestep> though clean might require some cleanup (ha) because a few things cause it to do stuff like generate double lists
[19:51:17] <jedestep> so attrs becomes "attrs": [[{"doc": "foo"}]]
[19:53:51] <cmr> jedestep: cool!
[19:53:56] <cmr> I just finished the weeks triage
[19:54:06] <cmr> I'm off to a blood drive, but when I get back, I'll begin work on rustdoc again
[21:39:41] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[22:00:44] <Seldaek> jedestep: do you work for 10gen?
[22:14:01] <Seldaek> cmr: well, impls won't be for tonight :p
[22:14:26] <jedestep> Seldaek: I'm an intern
[22:14:34] <Seldaek> jedestep: at 10gen?
[22:14:36] <jedestep> yeah
[22:14:40] <Seldaek> ok :)
[22:15:09] <Seldaek> they really are pushing for mongo drivers everywhere eh
[22:15:14] <jedestep> so the product of my summer has been the rust mongo driver (github.com/10gen-interns/mongo-rust-driver-prototype)
[22:16:50] <Seldaek> eh well, too tired to check it out now, but I'd be curious to see the overall API
[22:17:17] <jedestep> if you use mongo with other languages it should feel pretty familiar
[22:17:29] <Seldaek> I haven't really
[22:17:32] <jedestep> but we're still in the phase where the API is flexible so if you have feedback definitely let me know
[22:17:45] <Seldaek> still an old school sql guy, + redis here and there
[22:18:26] <Seldaek> yeah we're still in the phase where the language is flexible ;)
[22:19:08] <jedestep> had my fair share of run-ins with that -_-
[22:19:11] <Seldaek> I'm just curious to see a DB API in a statically typed language
[22:19:20] <Seldaek> never really did anything like that
[22:20:32] <Seldaek> jedestep: do you happen to know jeremy mikola? no clue where you are or if he actually works in a 10gen office
[22:20:52] <jedestep> name sounds kinda familiar but I don't think I know him
[22:20:55] <Seldaek> and I guess 10gen has more employees than I think by now
[22:25:11] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[22:26:29] <Seldaek> anyways.. heading to bed at a reasonable hour for once, cya!
