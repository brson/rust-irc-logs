[00:00:38] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[00:03:53] *** Quits: eddyb (eddyb@moz-l1n.kjd.26.188.IP) (Ping timeout: 121 seconds)
[00:03:55] <aturon> acrichto: re: As vs Borrow -- a key point of Borrow today is that it's reflexive
[00:04:10] <acrichto> aturon: oh hm right, very interesting
[00:04:17] <aturon> acrichto: but as we talked about the other day, we cannot currently have a reflexive blanket impl of As and also one that lifts over &
[00:04:21] <acrichto> yeah
[00:04:26] <acrichto> so definition-wise As == Borrow
[00:04:28] <aturon> acrichto: this will (hopefully) be possible with specialization
[00:04:29] <acrichto> but impl wise they are differnet
[00:04:39] <acrichto> and hence the difference in intended use cases
[00:04:49] <aturon> at the moment, yes
[00:04:55] <aturon> Gankro: ^
[00:05:13] <acrichto> Gankro: regarding your comment about As vs Into vs From vs Borrow vs Deref
[00:05:25] <acrichto> I do see Deref as very different than Borrow/As due to an associated type vs type parameter
[00:05:38] <aturon> yes, and of course the fact that it feeds into coercions/dispatch
[00:05:39] <acrichto> Into vs From also feels very different b/c it's a different direction
[00:05:49] <acrichto> Borrow/As I'm not so sure about
[00:05:57] <acrichto> I can see why, but not sure if I buy it :P
[00:05:58] <aturon> well, with where clauses the direction isn't so important (except for ergonomics),
[00:06:06] <aturon> but again you run into coherence issues
[00:06:12] *** Quits: lfairy (lfairy@moz-5un4tp.vf.net.nz) (Connection closed)
[00:06:38] <aturon> (also, the plan is to use `from` for general conversion constructors, but Into is better when you want an implicit into-style coercion)
[00:06:44] <Gankro> Deref:Copy::Borrow:Pod in my books
[00:07:05] <aturon> Gankro: say more?
[00:07:32] <Gankro> aturon: Copy is plain-old-data on crack; Deref is Borrow on crack
[00:07:46] <Gankro> It has language semantics
[00:08:15] <Gankro> Having that distinction is fine, I think
[00:08:16] <acrichto> Gankro: so you're thinking that if Copy/Pod isn't justified, why is Deref/Borrow ?
[00:08:22] <aturon> Gankro: does it help at all that introducing these traits is enabling me to deprecate almost as many others?
[00:08:40] <aturon> (AsPath, IntoBytes, AsOsStr, IntoCow)
[00:08:41] <Gankro> acrichto: I'm a strong proponent of Copy: Pod: Clone
[00:09:20] <Gankro> So I'm fine with Deref and Borrow co-existing
[00:09:20] <aturon> (as well as deprecating a bunch of ad hoc conversion constructors from_foo in favor of everybody using `from`)
[00:09:53] <Gankro> from_foo is more discoverable, though
[00:10:10] <aturon> i'm not sure, rustdoc is pretty good about showing trait impls
[00:10:15] <acrichto> even today though you'll see a bunch of `From<Foo>` at the bottom of a type
[00:10:21] <Gankro> aturon: No one checks traits
[00:10:32] <acrichto> that... seems like you're hamstringing yourself?
[00:10:35] <acrichto> then you don't even know you can clone something
[00:10:57] <aturon> Gankro: i'm not too worried in any case: the point is that `from` will be the widespread way to do a conversion construction
[00:11:27] <Gankro> aturon: Do you do BinaryHeap::from(vec![]) or From::from(vec![]): BinaryHeap?
[00:11:34] <aturon> the former
[00:11:54] <Gankro> How does that work?
[00:11:54] <aturon> (thanks eddyb!)
[00:12:01] <Gankro> Ah, new magic in the language
[00:12:02] <WindowsBunny> Gankro: UFCS :D
[00:12:03] <Gankro> ccool
[00:12:07] <aturon> yes, it's super nice
[00:12:21] <Gankro> Wait, so we can do BinaryHeap::default()???
[00:12:25] <aturon> yes
[00:12:26] <Gankro> nice
[00:12:31] <WindowsBunny> Praise be to UFCS
[00:12:42] <aturon> which is making us consider putting Default back in the prelude
[00:13:01] <Gankro> aturon: Basically I'd be less concerned about From/To/As/etc if we had more time to test it out in practice
[00:13:06] <aturon> yeah :-/
[00:13:13] <aturon> i'm about to post a PR implementing it,
[00:13:18] <aturon> i will cc you on the review
[00:13:24] <Gankro> Especially since this looks like a god-tier coherence land-mine
[00:13:39] <aturon> pretty much
[00:13:55] <aturon> we've been hitting coherence problems with a bunch of things recently,
[00:14:05] <aturon> which has led to a wide-ranging discussion about specialization + negative reasoning, etc
[00:14:14] <aturon> nmatsakis should be making some posts about this in the near future
[00:14:25] <aturon> but i'm hopeful that specialization will make coherence much, much less painful
[00:14:51] <Gankro> aturon: Will it land for 1.0?
[00:14:59] <aturon> specialization? definitely not
[00:15:44] <aturon> Gankro: FWIW, i definitely share your concern about stabilizing generic conversions so quickly. the one thing that makes me feel OK about it is that they are a *clear* improvement over the ad hoc traits we've already grown
[00:15:58] <aturon> (which would all suffer from the same coherence issues anyway)
[00:15:59] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[00:16:40] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[00:17:40] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[00:17:55] <aturon> Gankro: acrichto: preliminary PR posted https://github.com/rust-lang/rust/pull/23538
[00:18:47] *** Joins: eddyb (eddyb@moz-l1n.kjd.26.188.IP)
[00:18:57] <acrichto> aturon: hm, this doesn't reside in libcore?
[00:19:02] <aturon> acrichto: coherence
[00:19:07] <acrichto> that's not good
[00:19:11] <acrichto> like really not good
[00:19:14] <aturon> ?
[00:19:19] <acrichto> what's the blocker?
[00:19:22] <acrichto> for moving to libcore
[00:19:22] <cmr> I've been cc'd!
[00:19:31] <aturon> cmr: indeed!
[00:19:37] <aturon> trying to get eyeballs on this one
[00:20:42] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Ping timeout: 121 seconds)
[00:20:49] <aturon> acrichto: IIRC, `impl<T: Clone> To<Vec<T>> for [T]`
[00:20:56] <aturon> acrichto: this was the same problem we discussed the other day
[00:21:06] <aturon> acrichto: [T] is in core, Vec<T> in collections
[00:21:07] <acrichto> aturon: I thought we were going to just punt on that?
[00:21:23] <Gankro> aturon: sorry laptop crashed
[00:21:25] <acrichto> aturon: if these traits don't belong in core I feel like coherence isn't up to the job of allowing them to exist
[00:21:53] <acrichto> aturon: e.g. we're in a sense cheating to get [T] -> Vec<T>
[00:21:59] <acrichto> but no one else can do [T] -> MyThing<T>
[00:22:08] <acrichto> so we're in a sense really not playing by the rules
[00:22:26] <aturon> this is a problem with any conversion traits
[00:22:34] <acrichto> right
[00:22:41] <aturon> (not restricted to generic ones)
[00:22:49] <acrichto> but to me that doesn't justify moving to lbicollections
[00:23:05] <aturon> what do you mean by "moving"?
[00:23:17] <aturon> like, your preference would be to put this in core,
[00:23:22] <aturon> and remove the To<Vec<u8>> impl?
[00:23:34] <acrichto> aturon: moving from libcore to libcollections
[00:23:37] <acrichto> yeah
[00:23:54] <Gankro> aturon: acrichto: I'd like to see As/To worked into the language for call-site conversions in the future so having it in `core` makes sense
[00:24:19] <aturon> ok, i can try moving
[00:24:49] <aturon> (however, i don't buy the argument that we should instead sprout an unlimited number of ad hoc traits that will have the same problem)
[00:25:46] <reem> I think it's absolutely critical that we can get these traits to play nice with coherence instead of cheating. If it's not possible to write conversions from generic std types to your own types (e.g. impl To<X<T>> for StdType<T> { .. })... that sucks out a lot of the utility.
[00:26:47] <aturon> reem: that is indeed the case
[00:26:49] <Manishearth> It might be nice if we had multiple types of coherence
[00:27:05] <acrichto> aturon: yeah I also don't think we should add lots of one off traits as well
[00:27:06] <Gankro> Manishearth: That's sort of what specialization is
[00:27:13] <Manishearth> traits like To and Modifier don't work well with the coherence rules
[00:27:14] <reem> aturon: Honestly that cuts a lot of the motivation over one-off conversion traits.
[00:27:42] <Manishearth> because they are designed to be  used in a receiver-agnostic way
[00:27:52] <aturon> reem: right, so with one-off traits you can crate one for your target type, and coherence will then allow you to write impls from std types
[00:27:53] <aturon> acrichto: ^
[00:27:57] <Manishearth> uh, sorry, not receiver-agfnostic
[00:27:59] <Manishearth> Gankro: ?
[00:28:18] <reem> aturon: Yes. That's what we do today, e.g. https://github.com/reem/rust-intovec/blob/master/src/lib.rs
[00:28:20] <aturon> Manishearth: nmatsakis and i have talked about such coherence "modes"
[00:28:22] <Gankro> Manishearth: Like being able to make a "weak" blanket impl
[00:28:26] <Manishearth> aturon: nice
[00:28:29] <Manishearth> Gankro: exactly
[00:28:43] <aturon> Manishearth: neither of us are too enthusiastic though, coherence is already rather complicated
[00:29:04] <cmr> I also toyed with the idea of "cascading impl selection"
[00:29:09] <Manishearth> The current system disallowes certain constructs from crates which define the trait -- which is strange
[00:29:16] <cmr> (as in cascading style sheets)
[00:29:22] <cmr> it gets really complex and nasty, really quickly
[00:29:29] <Manishearth> eg impl Trait for Option<T> -- should be treated as a blanket on the inner T, but it instead just breaks coherence
[00:29:36] <Manishearth> lol
[00:30:06] <Manishearth> s/should/could
[00:30:26] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[00:30:42] <aturon> reem: https://github.com/rust-lang/rust/pull/23538#issuecomment-83824369
[00:30:52] <Manishearth> aturon: well, we need some way of encoding patterns like the one needed for To and for Modifier
[00:30:53] <aturon> acrichto: i fear this proposal is imploding
[00:31:27] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[00:31:37] <acrichto> aturon: hm
[00:31:37] <reem> aturon: Nice. Another use case I realized these traits don't cover is converting to "some type which implements a trait"
[00:32:28] <cmr> reem: I don't quite understand what you mean there. Something significantly different than abstract return types?
[00:32:29] <reem> aturon: e.g. I'm thinking about adding `trait IntoHandler { type Handler: Handler; fn into_handler(self) -> Self::Handler; }` to iron, and I don't think you can model that without a one-off trait.
[00:32:37] <reem> cmr: ^
[00:32:40] <cmr> Ok, yeah.
[00:32:41] <aturon> acrichto: i guess one question is whether there's still at least a use for it within std (rather than having AsPath and friends)
[00:32:42] <acrichto> aturon: I'm not sure I agree though, I think it's still 100% better than what we have today
[00:32:47] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:32:55] <acrichto> aturon: e.g. the only impl is To<Vec<T>>, which no one is generic over today
[00:33:14] <reem> cmr: Those traits are useful basically only for creating "overloaded" functions/methods
[00:33:18] <acrichto> aturon: I think that removing all the random AsFoo we have is definitely worth it
[00:33:34] <acrichto> aturon: also things like IntoBytes for CString really want to get removed as well
[00:33:55] <aturon> i suppose another point is that the coherence problems come up only for *generic* std types
[00:34:02] <aturon> or upstream types, in general
[00:34:16] <aturon> ok, i will try moving to core and ping again
[00:34:18] <acrichto> which we're not generic over at all today basically
[00:34:21] *** sunfish is now known as sunfish-away
[00:34:28] <cmr> I feel pretty good about this RFC.
[00:34:56] <aturon> i guess the TL;DR is that you can still get a lot out of these traits, even if they can't replace *all* ad hoc conversion traits
[00:35:07] <acrichto> aturon: also what do you think of changing CString::new to take Into<CString> instead of Into<Vec<u8>> ?
[00:35:23] <acrichto> aturon: and yeah that's how I feel
[00:35:58] <cmr> It doesn't add problems, and even though it isn't a 100% solution to all the woes, it's pretty good.
[00:36:04] <cmr> darn, beat me to the punch :P
[00:36:09] <aturon> :)
[00:36:25] <acrichto> aturon: this feels like the correct solution
[00:36:34] <acrichto> it has some shortcomings ,but this is providing the right motivation to solve those problems
[00:36:42] <aturon> acrichto: hm, so you want an Into<CString> impl for Vec<u8> etc?
[00:36:48] <acrichto> aturon: yeah
[00:37:02] <acrichto> aturon: it was brought up in the RFC that Into<Vec<u8>> is somewhat precluding SSO 
[00:37:03] <aturon> i'm not sure that makes sense
[00:37:12] <aturon> (in terms of what happens on interior null?)
[00:37:12] <acrichto> oh right duh
[00:37:16] <acrichto> yeah
[00:37:18] <acrichto> hm nvmd
[00:37:20] <acrichto> we'll live
[00:37:32] <aturon> ah, you're worried about the exposure
[00:37:35] <acrichto> it may require Into<Vec<u8>> for [u8] though
[00:37:49] <acrichto> I don't think the exposure is the end of the world
[00:37:51] <aturon> yes, which is currently via To<Vec<u8>>, which will go away if i move to core...
[00:38:14] <acrichto> you can add a specific impl to collections, right?
[00:38:18] <aturon> ah!
[00:38:20] <acrichto> impl To<Vec<u8>> for [u8]
[00:38:26] <aturon> that's... 
[00:38:31] <acrichto> (bad)
[00:38:33] <aturon> yes.
[00:38:33] <acrichto> but sufficient!
[00:38:36] <aturon> yes!
[00:38:38] <acrichto> lol
[00:38:55] <acrichto> aturon: btw the CString rfc in question is https://github.com/rust-lang/rfcs/pull/912
[00:39:20] <aturon> acrichto: ok, thanks
[00:40:42] <reem> Why doesn't this yield &'static str (the arguments have to be valid for the whole program... right?)? http://doc.rust-lang.org/nightly/std/env/struct.Args.html
[00:41:05] <Mutabah> reem: The argv value might not be valid utf-8
[00:41:14] <cmr> reem: in Windows they don't, and in Unix they're still mutable.
[00:41:25] <reem> Mutabah: Well it currently yields String, so...
[00:41:32] <reem> cmr: Ok that makes sense then.
[00:41:38] <acrichto> reem: there's a good deal of discussion on the RFC as well: https://github.com/rust-lang/rfcs/pull/578#discussion_r23659153
[00:43:38] <reem> thanks
[00:45:18] <cmr> Ok, how do I reference the methods which are inherent impls on [T] but used to be SliceExt? Ie, I had SliceExt::as_mut_ptr(foo), but [T]::as_mut_ptr(foo) doesn't parse.
[00:45:36] <reem> <[T]>?
[00:45:42] <cmr> Aha!
[00:46:00] <acrichto> I think you can even do <[_]>
[00:46:04] <arrrrrrr1> can Fn capture mutable references?
[00:47:47] <reem> Yes, but it can only access them as &&mut T
[00:47:52] <reem> which is equivalent to &T
[00:48:26] *** Quits: marsel (user@moz-dvn.d4u.180.94.IP) (Ping timeout: 121 seconds)
[00:48:40] <arrrrrrr1> https://gist.github.com/anonymous/517bbace4fdec7c177f6
[00:48:43] <arrrrrrr1> this doesn't work
[00:48:56] <arrrrrrr1> but it works when I remove the <'a> in Fn(&Info<'a>)
[00:49:07] * reem reads
[00:49:16] <reem> can you paste the error just so I can see it?
[00:49:54] <reem> also the signature of iter_buf
[00:50:15] <arrrrrrr1> https://gist.github.com/anonymous/56014c2512a3c8c9880a
[00:50:43] <arrrrrrr1> https://gist.github.com/anonymous/570706241f3a7375e2e0
[00:52:28] *** Quits: blank_name (blank_name@moz-mteiba.mi.frontiernet.net) (Quit: leaving)
[00:52:55] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:53:39] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:53:48] *** Joins: blank_name (blank_name@moz-mteiba.mi.frontiernet.net)
[00:53:59] <Gankro> aturon: Can From<[T]> not be done for Vec?
[00:54:26] <aturon> Gankro: you can do From<&'a [T]> for all 'a
[00:54:44] <aturon> which at least gives you Into 
[00:55:11] <reem> arrrrrrr1: What's the type of user?
[00:55:19] <reem> Info<'a>?
[00:55:44] <arrrrrrr1> https://gist.github.com/anonymous/6431152af9b2b9cc16e9
[00:56:20] <reem> hmm
[00:56:41] <Gankro> aturon: So what's the problem?
[00:56:44] <reem> this error looks unrelated to what you annotated?
[00:56:59] <reem> I assume you're trying to get rid of that transmute?
[00:57:00] <aturon> Gankro: it doesn't give you `To`
[00:57:31] <arrrrrrr1> reem: no, without the transmute you get the same error. this is about the Fn
[00:57:33] <aturon> but, it may turn out that in practice we generally prefer Into to To anyway
[00:57:42] <aturon> acrichto: ^
[00:58:04] <arrrrrrr1> reem: https://gist.github.com/anonymous/6c208a4e35ae166aa36f
[00:58:07] <arrrrrrr1> this works as expected
[00:58:16] <Gankro> aturon: As a library designer, I don't see any reason to accept a To?
[00:59:19] <acrichto> aturon: hm this is interesting
[00:59:20] <reem> arrrrrrr1: Weird... It looks like they should both work
[00:59:27] <acrichto> aturon: I wonder if the blanket Into => From should go the other way?
[00:59:37] <Gankro> aturon: And as a user I would favour From
[00:59:40] <acrichto> unless I got that mixed up again
[00:59:47] <aturon> acrichto: i think you're backwards :P
[01:00:01] <aturon> Gankro: right, so we've been moving to "overloading over ownership" for stuff like this
[01:00:23] <aturon> e.g. `fn open<P: ?Sized + AsPath>(p: &P) -> File` vs `fn open<P: AsPath>(p: P)`
[01:00:32] <acrichto> aturon: impl<T, U> Into<T> for U where T: From<U> ?
[01:00:40] <aturon> the latter is able to take things like &str, &OsStr, String, OsString, &PathBuf, PathBuf
[01:00:54] <acrichto> er wait, oh nvmd
[01:00:55] <aturon> acrichto: right, that's From => Into
[01:01:01] <acrichto> hm
[01:01:03] <aturon> acrichto: which is what Gankro is pointing out,
[01:01:08] <acrichto> but the impls for From are more permissive, right?
[01:01:09] <aturon> this gives us a way to swap the Self
[01:01:13] <acrichto> b/c Self is the type you change
[01:01:14] <aturon> yes
[01:01:22] <acrichto> this seems plausible!
[01:02:00] <aturon> Gankro: acrichto: this does make me wonder a bit if we should even bother with To
[01:02:22] <acrichto> conservatism!
[01:03:42] <Gankro> aturon: Yeah To is a bit odd to use in a generic context; it makes sense in an adhoc context
[01:04:09] <Gankro> aturon: Although maybe it lets you avoid crap like (&foo).into...
[01:04:33] <aturon> Gankro: nah, auto-ref should take care of that
[01:06:00] <Gankro> aturon: Only thing I see is it's a nice thing from a documentation perspective
[01:06:20] <reem> arrrrrrr1: I don't know why this is happening :/
[01:09:43] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:10:49] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:12:51] <aturon> Gankro: acrichto: hm, coherence is either too smart or not smart enough: it gives me an error when I try the suggested From impl
[01:13:28] <aturon> (but the error appears to be buggy)
[01:14:02] <Gankro> aturon: Fire the niko-signal!
[01:14:10] <aturon> sadly, he's asleep :)
[01:14:34] <Gankro> But he'll know, *in his bones*
[01:14:39] <Gankro> There are type systems to be had
[01:14:45] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:14:58] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[01:15:36] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:15:49] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:15:53] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:18:15] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[01:19:20] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[01:23:06] <Gankro> acrichto: http://www.reddit.com/r/rust/comments/2zm8ov/release_notes_on_cratesio/cpkgcpq
[01:23:38] *** Quits: eibwen (eibwen@moz-044opj.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[01:32:14] *** Joins: brson (brson@moz-4s9.mg6.56.172.IP)
[01:32:14] *** ChanServ sets mode: +o brson
[01:33:56] *** Quits: Kroisse (Kroisse@moz-t75tk5.krois.se) (Quit: Good bye :))
[01:34:50] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[01:34:59] *** Quits: swgillespie (swgillespie@moz-upj.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:35:19] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:35:22] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:36:15] <nrc> brson: I have a student looking at refactoring tools for Rust
[01:36:23] <nrc> for a final year project thing
[01:36:35] <brson> nrc: yay!
[01:37:00] <nrc> indeed
[01:37:06] <brson> nrc: what sort of refactoring tools are they going to make?
[01:37:25] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[01:37:26] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[01:37:42] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[01:37:57] <nrc> kind of open ended atm, he'll start with easy stuff - rename variable and work up through harder ones - I think inlining/outlining methods is probably the most interesting from a Rust perspective
[01:38:07] <nrc> brson: anything you particularly want?
[01:38:53] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[01:40:29] <brson> nrc: one of the things i have my eye on for the next few years is rustfix. ideally i want to be able to automatically unbreak any crates we break
[01:40:43] <brson> nrc: so i need refactorings that support the workaround for known breakage patterns
[01:40:49] *** Joins: tcurdt (tcurdt@moz-r3ei93.dip0.t-ipconnect.de)
[01:41:04] <brson> and is compatible with all previous revisions of stable rust
[01:41:13] *** Quits: etw (john@moz-2lpgmu.fios.verizon.net) (Client exited)
[01:41:34] <nrc> I think that should be pretty easy - it is just a refactoring that breaks the 'output must compile' invariant
[01:41:49] <nrc> (assuming we work with the 'old' version of the compiler)
[01:42:21] <nrc> But I guess it is interesting because you'd be changing things at the language level, rather than just changing 'metadata'
[01:42:39] <nrc> I'll add it to his list to look at
[01:43:29] <brson> nrc: The kind of things I've been worried about are api breakages, due to method resolution conflicts, etc.
[01:44:05] <brson> If we add a new method that is known to break existing code, i want a refactoring that targets that specific breakage
[01:44:38] <brson> 'convert method to ufcs'
[01:45:07] <brson> but only when that method is 'new_breaking_method' on trait 'TraitWeBroke' etc
[01:45:26] <theme> The docs for try! look wrong
[01:45:28] <theme> http://doc.rust-lang.org/nightly/std/macro.try!.html
[01:45:35] *** Joins: bombless (bombless@moz-8skm7i.0v2u.0v40.0da8.2001.IP)
[01:45:42] <theme> mentions std::io
[01:45:52] <theme> But I found try! mentioned on old_io
[01:45:53] <theme> http://doc.rust-lang.org/nightly/std/old_io/index.html#try!
[01:49:29] <nrc> brson: right, I guess these are slightly different 'search terms' for the refactoring because you're looking for patterns rather than just names
[01:49:39] <nrc> I emailed him a summary of the idea
[01:51:04] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[01:51:59] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[01:55:33] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Quit: Lost terminal)
[02:00:13] *** Joins: tjakubow (tom@moz-ag87jj.fios.verizon.net)
[02:02:28] <arrrrrrr1> does Display have to write strings?
[02:02:37] <arrrrrrr1> can it write arbitrary bytes?
[02:02:58] <brson> arrrrrrr1: I believe strings are required because it avoids some expensive runtime validation
[02:03:37] <arrrrrrr1> I have /etc/passwd entries but they aren't necessarily utf8
[02:05:55] <nrc> If I add a built-in lint, I add it to the list in builtin.rs and set it to Warn, but then I get errors because it is Deny "by default". Where could that be coming from?
[02:06:03] <nrc> ^ acrichto, kmc ?
[02:07:44] <huon> nrc: what's the diff?
[02:07:48] <huon> nrc: oh, wait
[02:08:02] <huon> nrc: I believe the bootstrap runs with #[deny(warnings)]
[02:09:18] <nrc> huon: can I override that for particular lints? Where?
[02:09:43] <acrichto> nrc: we compile with `-D warnings`
[02:09:46] <acrichto> in stage1+
[02:10:20] <huon> nrc: #[allow(your_lint)]
[02:10:25] <huon> is the only way, AFAIK
[02:10:49] <arrrrrrr1> getopts looks out of date
[02:11:02] <arrrrrrr1> what's the recommended arg parsing library nowadays?
[02:11:03] <nrc> hmm, that is not what I want to - I want to warn but allow it :-s
[02:11:11] <arrrrrrr1> doesn't matter if it can only parse strings
[02:11:11] <nrc> *not allow it
[02:11:22] <reem> iirc there's a good docopt lib
[02:11:54] <arrrrrrr1> yup http://burntsushi.net/rustdoc/docopt/
[02:11:58] *** Quits: eddyb (eddyb@moz-l1n.kjd.26.188.IP) (Ping timeout: 121 seconds)
[02:12:01] <nrc> acrichto: so does -D warnings turn Warn lints into Deny lints?
[02:13:56] <acrichto> nrc: yeah
[02:15:05] <nrc> I guess I could fix the warnings
[02:15:15] <nrc> acrichto, huon: thanks for the info!
[02:15:36] <arrrrrrr1> https://github.com/rust-lang/rfcs/issues/993
[02:15:38] <arrrrrrr1> aturon: ^
[02:16:07] <aturon> arrrrrrr1: indeed, thanks
[02:16:48] <nrc> bah! That is going to be annoying before type ascription lands
[02:17:07] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[02:18:46] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[02:22:50] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[02:23:32] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[02:27:46] *** Joins: schnozzle (Mibbit@moz-juv.9o3.252.72.IP)
[02:29:43] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[02:29:50] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[02:34:11] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[02:35:36] *** Joins: bleibig (bleibig@moz-btk.gm4.170.73.IP)
[02:36:49] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[02:37:42] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[02:39:09] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:39:25] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[02:46:11] *** Joins: erickt (erickt@moz-92uf6i.pltn13.pacbell.net)
[02:47:39] <nrc> If I want to allow a lint for a whole module, I can't seem to do that by placing the allow in mod.rs, is there anywhere I can put it?
[02:48:14] <nrc> huon^
[02:48:45] <huon> #![allow(foo)] at the top of the mod.rs?
[02:48:58] <huon> (are you missing the `!` ?)
[02:49:40] <nrc> huon: nope, I've for the `!` in there
[02:49:46] <nrc> *got
[02:53:50] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[02:54:11] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[02:56:41] *** Quits: tcurdt (tcurdt@moz-r3ei93.dip0.t-ipconnect.de) (Quit: Textual IRC Client: www.textualapp.com)
[02:59:06] <nrc> I wonder if it is something to do with the fact that the warnings come from inside macros?
[02:59:23] <nrc> Although both the definition and expansion are inside the module
[02:59:37] <nrc> I wonder if the macro is somehow logically outside the macro at the crate root
[02:59:47] * nrc curses macros and lints
[03:02:14] <theme> Is this supposed to compile? http://is.gd/5dNAGb
[03:05:17] <erickt> theme: don't tell them, we'll slip HKT in under the radar :)
[03:05:24] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[03:05:25] <theme> *_*
[03:05:47] <theme> Note that this causes an ICE http://is.gd/VJor62
[03:05:55] * theme is filing two bugs
[03:06:09] <theme> one for ICE, and one for incorrect compilation of HKT
[03:11:38] <theme> filed 2 issues
[03:11:40] <theme> https://github.com/rust-lang/rust/issues/23543
[03:11:43] <theme> https://github.com/rust-lang/rust/issues/23544
[03:13:56] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[03:14:20] *** Quits: det (chris@moz-2pbdg1.lv.cox.net) (Connection closed)
[03:17:58] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[03:21:55] *** Joins: reem (reem@moz-taob6g.coob.q2h1.0009.2601.IP)
[03:22:04] <aturon> huon: do you happen to know if the impls of things like Add for u32 are implemented internally in the compiler?
[03:22:49] <Mutabah> aturon: The traits themselves are in core
[03:23:08] <aturon> aturon: ah nvm, just found it
[03:23:08] <Mutabah> But they just do a + b
[03:23:50] <aturon> Mutabah: right, i just failed to search properly for macros providing the impls
[03:28:00] <aturon> acrichto: any idea why i might be seeing https://gist.github.com/aturon/974d66fca0d12b5750c6 on mac os?
[03:28:13] <aturon> (happens for must of run-pass)
[03:28:46] *** Joins: kimundi_ (kimundi@moz-vfagn5.dip0.t-ipconnect.de)
[03:29:49] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[03:30:15] *** Joins: det (chris@moz-2pbdg1.lv.cox.net)
[03:30:49] *** Quits: schnozzle (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:31:05] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[03:31:49] *** Quits: kimundi (kimundi@moz-51c9op.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:31:49] *** kimundi_ is now known as kimundi
[03:33:53] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[03:34:54] *** Quits: erickt (erickt@moz-92uf6i.pltn13.pacbell.net) (Ping timeout: 121 seconds)
[03:36:28] <acrichto> aturon: whoa
[03:36:31] <acrichto> no idea
[03:36:43] <acrichto> maybe some path somewhere got corrupted?
[03:37:07] <aturon> no idea
[03:37:45] *** kimundi is now known as zz_kimundi
[03:37:47] <aturon> (i've encountered this before, but it's never been enough of a blocker to really track down)
[03:39:11] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-4jf9qp.dynamic.qsc.de) (Ping timeout: 121 seconds)
[03:40:05] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[03:40:06] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[03:41:24] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[03:41:37] *** Quits: onix (Mibbit@moz-g6k.oht.161.46.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:42:20] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[03:44:36] *** zz_kimundi is now known as kimundi
[03:46:07] *** Joins: Alto (Mibbit@moz-que.gn8.29.168.IP)
[03:47:14] <Alto> Hello, how could I get parse errors out of 'syntax: parse: parse_item_from_source_str' and related functions? Someone in the #rust channel recommended this one.
[03:52:23] *** Joins: Rusky1 (russell@moz-2a17lj.slkc.qwest.net)
[03:52:23] *** Quits: Rusky (russell@moz-2a17lj.slkc.qwest.net) (Connection closed)
[03:54:01] *** Joins: mystor_ (mystor@moz-ldavpp.home3.cgocable.net)
[03:54:02] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[03:56:54] *** Quits: Rusky1 (russell@moz-2a17lj.slkc.qwest.net) (Quit: Leaving.)
[03:56:58] *** Quits: acharles (acharles@moz-nemm4b.fosshotel.is) (Client exited)
[03:57:17] *** Joins: acharles (acharles@moz-1pof4d.fosshotel.is)
[03:58:31] *** Joins: Rusky (russell@moz-2a17lj.slkc.qwest.net)
[04:03:15] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[04:06:09] *** Quits: reem (reem@moz-taob6g.coob.q2h1.0009.2601.IP) (Connection closed)
[04:07:17] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[04:07:46] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:16:50] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[04:19:59] *** Quits: Alto (Mibbit@moz-que.gn8.29.168.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:20:56] *** Joins: montezuma (Mibbit@moz-juv.9o3.252.72.IP)
[04:21:57] *** Quits: mystor_ (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[04:22:32] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[04:22:47] <aturon> huon: i'm contemplating re-introducing Zero and One, intended to complement Add and Mul
[04:24:41] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[04:25:15] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[04:27:35] *** Joins: semarie (semarie@moz-jgfl05.torservers.net)
[04:29:19] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[04:37:11] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:40:03] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[04:40:56] *** Quits: montezuma (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:41:04] *** Joins: charmander (Mibbit@moz-juv.9o3.252.72.IP)
[04:41:14] *** Quits: charmander (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:42:36] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[04:45:12] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[04:49:43] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:51:37] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[04:54:13] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[04:56:23] *** Quits: brson (brson@moz-4s9.mg6.56.172.IP) (Ping timeout: 121 seconds)
[04:57:08] *** Joins: Johannes_ (Johannes@moz-4et8d7.ocn.ne.jp)
[04:57:58] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Ping timeout: 121 seconds)
[04:58:15] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[05:00:05] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[05:00:47] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[05:00:47] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[05:00:48] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[05:00:59] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:09:12] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[05:14:55] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[05:24:28] <nrc> Jesus, adding the trivial cast lint has been surprisingly painful
[05:24:53] <reem> nrc: the trivial cast lint is an enemy of the way we do ffi right now
[05:24:59] <reem> since c types are type aliases
[05:25:17] <nrc> I guess you should be using ascription for that?
[05:25:26] <nrc> once it lands, I mean
[05:25:28] <reem> you get situations were on some platforms you need `as` and on others it's trivial
[05:25:50] <reem> Yes.
[05:25:51] <nrc> that is exactly why it is a lint and not a proper warning
[05:26:06] <nrc> in fact, there is a trivial_numeric_cast lint for exactly that
[05:26:27] <reem> awesome
[05:26:33] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[05:26:51] <nrc> I actually quite like the way the design has worked out, doing this stuff over the libs makes me think we made the right choices
[05:26:57] <nrc> but it is long work
[05:27:10] <nrc> and the compiler changes were much harder than I thought they would be
[05:27:55] <nrc> I bet this bounces like 15 times too
[05:32:40] *** Quits: O01eg (o01eg@moz-jnir55.0tnt.4n8f.2698.2a02.IP) (Client exited)
[05:34:43] *** Joins: bjz (bjz@moz-b43.1aa.161.202.IP)
[05:35:10] *** Quits: Johannes_ (Johannes@moz-4et8d7.ocn.ne.jp) (Ping timeout: 121 seconds)
[05:37:32] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[05:40:22] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Connection closed)
[05:42:05] *** Quits: bjz (bjz@moz-b43.1aa.161.202.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:42:16] *** Joins: bjz (bjz@moz-b43.1aa.161.202.IP)
[05:43:18] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[05:46:30] *** Quits: bjz (bjz@moz-b43.1aa.161.202.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:52:50] *** Joins: bjz (bjz@moz-b43.1aa.161.202.IP)
[05:53:20] *** Quits: bjz (bjz@moz-b43.1aa.161.202.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:59:57] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[06:00:25] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[06:04:33] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[06:09:30] <aturon> nrc: is triage bot working?
[06:09:36] <aturon> the last couple times i've tried, nothing happens
[06:09:42] *** Joins: Guest_ (textual@moz-o8p.pug.156.104.IP)
[06:09:43] * nrc checks
[06:10:17] *** Guest_ is now known as jmitchell
[06:10:19] <nrc> it should be - the server has not crashed, at least
[06:10:22] <aturon> nrc: e.g. https://github.com/rust-lang/rust/issues/23547#issuecomment-83922892 did not work
[06:10:27] <aturon> (i just added the labels myself)
[06:10:58] <nrc> I'll check the logs...
[06:11:46] *** Joins: bjz (bjz@moz-b43.1aa.161.202.IP)
[06:12:18] <nrc> hmm, nothing unusual
[06:12:24] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Quit: Leaving)
[06:12:39] *** Quits: jmitchell (textual@moz-o8p.pug.156.104.IP) (Quit: Textual IRC Client: www.textualapp.com)
[06:12:45] *** Joins: jmitchell (jmitchell@moz-o8p.pug.156.104.IP)
[06:12:53] <aturon> nrc: ok, but the syntax i used looks correct?
[06:13:06] <nrc> yeah, I think so
[06:13:52] <nrc> I'll add some more logging, let me know if it fails again
[06:14:02] <aturon> nrc: will do, thanks
[06:15:02] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:16:34] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Ping timeout: 121 seconds)
[06:23:01] <nrc> logging added, lets see what turns up....
[06:24:36] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[06:28:09] *** Joins: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at)
[06:28:33] *** Quits: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[06:29:25] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[06:29:43] *** Quits: njn (chatzilla@moz-sqinim.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0a1/20150315153114])
[06:30:46] *** Joins: Nekit1234007 (nekit@moz-2vpc3e.broadband.iskratelecom.ru)
[06:32:11] *** Quits: dinfuehr (dinfuehr@moz-l2hv5p.highway.telekom.at) (Ping timeout: 121 seconds)
[06:32:21] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[06:32:43] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Ping timeout: 121 seconds)
[06:42:54] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[06:44:32] *** Quits: bombless (bombless@moz-8skm7i.0v2u.0v40.0da8.2001.IP) (Quit: Leaving)
[06:45:14] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[06:46:51] *** Joins: larhat (Adium@moz-9vj.vcf.204.37.IP)
[06:50:00] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[06:51:19] *** Quits: larhat (Adium@moz-9vj.vcf.204.37.IP) (Ping timeout: 121 seconds)
[06:54:00] <huon> aturon: hm
[06:54:43] <huon> aturon: do we have 'concrete' motivation for Zero and One?
[06:54:53] *** Joins: larhat (Adium@moz-ulr0vd.mfe0.h1q1.2168.2a02.IP)
[06:54:59] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[06:54:59] *** Quits: larhat (Adium@moz-ulr0vd.mfe0.h1q1.2168.2a02.IP) (Quit: Leaving.)
[06:55:05] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[06:55:41] <aturon> huon: yes 
[06:55:47] <aturon> two places at the moment
[06:56:01] <aturon> AdditiveIterator/MultiplicativeIterator, 
[06:56:07] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[06:56:09] <aturon> and also the Iterator impls for ranges
[06:56:31] <huon> the manual concrete impls we currently have are insufficient?
[06:56:36] <aturon> for the latter, i had tried providing concrete impls for each scalar type, but that ended up causing some bad interactions with fallback
[06:56:44] <huon> oh
[06:56:45] <aturon> these all use Int currently
[06:56:54] <aturon> err, the range ones use Int
[06:56:58] <huon> I thought AdditiveIterator uses..
[06:57:00] <huon> yeah
[06:57:17] <aturon> you were suggesting introducing Monoid, or something along those lines
[06:57:27] <aturon> this is obviously somewhat related
[06:57:42] <huon> I was about to ask if you'd seen https://github.com/rust-lang/rust/pull/23293
[06:57:48] <huon> but I see you had
[06:57:49] <aturon> in a sense, it would be the counterpart to the Add/Mul operations, but without sugar :)
[06:58:18] <aturon> anyway, i'm not at all sure this is a good idea,
[06:58:34] <aturon> and there are various other workarounds, though they generally involve introducing some *other* trait
[06:58:52] <aturon> for Additive/MultiplicativeIterator, we can wait -- those are unstable and can remain so,
[06:58:57] <aturon> since it's easy to just use a fold instead
[06:59:05] <huon> yeah
[06:59:11] <aturon> but i just posted https://github.com/rust-lang/rust/pull/23549
[06:59:18] <aturon> which deprecates Int and Float,
[06:59:26] <aturon> which will force us to do something about Range &co
[06:59:35] <aturon> anyway, it's about midnight, so i should probably head home 
[06:59:45] <huon> in other news (very tangentially related), I noticed a few days ago that foo.iter().zip(bar.iter()) now optimises optimally
[06:59:54] <aturon> (just wanted to plant the seed, would be curious to hear your thoughts)
[06:59:59] * huon will think
[07:00:09] <aturon> hmm, that is nice news :)
[07:00:12] <aturon> ok, tty tomorrow
[07:00:36] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[07:00:47] <huon> (where, foo, bar are slices... at least, it vectorised to a tight loop the same as unsafe code does)
[07:01:31] *** Joins: larhat (Adium@moz-9vj.vcf.204.37.IP)
[07:09:43] *** Quits: bjz (bjz@moz-b43.1aa.161.202.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:12:02] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:13:02] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[07:13:23] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[07:14:14] *** Joins: eddyb (eddyb@moz-sj2.qih.166.109.IP)
[07:17:25] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[07:21:42] *** Quits: eddyb (eddyb@moz-sj2.qih.166.109.IP) (Ping timeout: 121 seconds)
[07:25:32] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Connection closed)
[07:25:44] *** Quits: untitaker (untitaker@moz-lh5b29.highway.telekom.at) (Ping timeout: 121 seconds)
[07:27:01] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[07:29:20] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:30:28] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[07:31:19] *** Joins: untitaker (untitaker@moz-r6cih8.highway.telekom.at)
[07:33:08] *** Joins: Kroisse (Kroisse@moz-t75tk5.krois.se)
[07:34:52] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[07:35:02] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Ping timeout: 121 seconds)
[07:44:46] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[07:46:25] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[07:46:25] *** ChanServ sets mode: +o pnkfelix
[07:54:40] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[07:58:18] *** Joins: evanfarrar (evanfarrar@moz-3vf.glc.17.89.IP)
[08:02:22] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[08:02:27] *** Joins: lfairy (lfairy@moz-5un4tp.vf.net.nz)
[08:13:12] *** Quits: evanfarrar (evanfarrar@moz-3vf.glc.17.89.IP) (Connection closed)
[08:18:31] *** Joins: aepsil0n (eduard@moz-e1hmhk.3ec9.hh0f.8071.2a02.IP)
[08:20:24] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[08:28:52] *** Quits: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[08:33:01] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[08:33:41] *** Quits: aepsil0n (eduard@moz-e1hmhk.3ec9.hh0f.8071.2a02.IP) (Connection closed)
[08:36:29] *** Joins: imperio (Mibbit@moz-psdrik.rev.sfr.net)
[08:37:03] <imperio> I think I found a bug (with a non updated compiler of ~3 days), I re-test here
[08:39:04] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[08:39:25] <imperio> rusti: let lines : Vec<&str> = "hello\npeople\n!".split('\n').collect();for line in lines.iter() {match *line {l => if l.starts_with("people") {println!("ok!");}_=>{println!("not ok!");}}}
[08:39:25] -playbot- output truncated; full output at: http://bit.ly/1I3M0dp
[08:40:24] <imperio> http://is.gd/g2Itxr
[08:40:34] <imperio> why is it unreachable ?*
[08:46:13] <nathan7> imperio: because it always matches
[08:46:17] <nathan7> imperio: `x` always matches
[08:46:20] *** Joins: eibwen (eibwen@moz-m6s9fg.dip0.t-ipconnect.de)
[08:46:26] <nathan7> imperio: you might want `x if l.starts_with("people")`
[08:46:32] <nathan7> imperio: err
[08:46:40] <nathan7> imperio: *`l if l.starts_with("people")`
[08:46:55] <nathan7> imperio: `match *line { l if l.starts_with("people") => …, _ => … }`
[08:47:09] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[08:47:35] <imperio> nathan7: oh right ! Thanks a lot !
[08:49:29] *** Quits: lfairy (lfairy@moz-5un4tp.vf.net.nz) (Ping timeout: 121 seconds)
[08:52:27] *** Joins: lfairy (lfairy@moz-5un4tp.vf.net.nz)
[08:55:47] *** Quits: larhat (Adium@moz-9vj.vcf.204.37.IP) (Quit: Leaving.)
[08:58:01] <Manishearth> WindowsBunny: wanna make this work on windows?
[08:58:01] <Manishearth> https://github.com/rust-lang/rust/pull/23470
[08:58:37] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[08:59:47] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[09:00:42] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[09:02:59] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[09:04:32] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[09:14:54] <klutzy> pnkfelix: do you mean `[0, sizeof(lhs_t)*8)` instead of `]`? https://github.com/rust-lang/rust/issues/22020#issuecomment-83959895
[09:15:28] <pnkfelix> klutzy: oh, yes.  will fix
[09:18:09] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:18:19] <klutzy> hmm, Wrapping<T> also has undefined behavior for overlong shifts
[09:18:41] <pnkfelix> yeah we simply haven't addressed this at all
[09:18:46] <klutzy> (since it is implemented as `Wrapping(self.0 << other)`)
[09:18:47] <pnkfelix> gh10183
[09:18:48] <[o__o]> overlong bit shifts cause undefined behaviour: https://github.com/rust-lang/rust/issues/10183
[09:18:51] <klutzy> yep
[09:19:04] <klutzy> I forgot to address the issue during rfc phase
[09:22:52] *** Quits: jmitchell (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[09:26:11] <klutzy> for Wrapping<T>, we need to "define" shift semantics fist.. I once checked how other languages do, and surpringly many languages just don't consider overlong shift cases
[09:26:50] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[09:26:52] <klutzy> for example, ocaml defines it as implementation-defined, and it even led Coq to crash!
[09:26:56] <klutzy> ( http://blog.regehr.org/archives/903 )
[09:27:33] <pnkfelix> klutzy: my plan (supported by nmatsakis) is to just follow Java's lead here, and mask out the higher order bits of the rhs
[09:28:00] <klutzy> oh, so (1 << 12345) is 0?
[09:28:25] <pnkfelix> playbot: 12345 & 0x1f
[09:28:27] -playbot- 25
[09:28:39] <pnkfelix> klutzy: so no, it would be (1 << 25)
[09:29:17] <pnkfelix> klutzy: what you describe I would call a "saturating shift" -- I *do* think that it seems like a more natural semantics
[09:29:23] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[09:29:35] <klutzy> hmm
[09:29:42] <pnkfelix> klutzy: I think the reason that Java uses a masking semantics is because that's what x86 does
[09:29:46] <klutzy> java's impl seems to follow intel cpu
[09:29:49] <klutzy> yep
[09:30:12] <pnkfelix> klutzy: though in our case it would be a generalization to i8 and i16 as well
[09:30:25] <pnkfelix> klutzy: (masking with 0x7 and 0xf, respectively)
[09:32:23] <klutzy> the java behavior may not be bad if overlong shifts are mostly user mistake, though I wonder if it actually led to real bugs
[09:33:09] <klutzy> pnkfelix: do you know other langauges which has proper shift semantics?
[09:33:29] <pnkfelix> klutzy: Scheme I think has sane semantics here
[09:34:16] <pnkfelix> klutzy: though of course Scheme uses arbitrary precision arithmetic
[09:36:00] <pnkfelix> klutzy: e.g. https://gist.github.com/pnkfelix/b6babb8ad7a9f27c4216
[09:37:14] <klutzy> pnkfelix: hmm, python seems to to too, since it also uses arbitray precision
[09:37:25] <klutzy> I think julia uses saturating semantics, though it's not documented (checking source...)
[09:37:39] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[09:37:52] <pnkfelix> klutzy: I would support having both `masking_lshift` and `saturating_lshift` methods
[09:38:09] <pnkfelix> klutzy: much like how I would support having `wrapping_div` and `saturating_div`
[09:38:52] <klutzy> pnkfelix: sounds good!
[09:39:07] <pnkfelix> (the div issue is here: https://github.com/rust-lang/rfcs/issues/964 )
[09:39:13] *** Quits: lfairy (lfairy@moz-5un4tp.vf.net.nz) (Connection closed)
[09:40:37] <klutzy> pnkfelix: julia: https://github.com/JuliaLang/julia/issues/2241#ref-commit-4709cb9
[09:41:01] *** Joins: killercu_ (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[09:43:54] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[09:50:28] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[09:50:41] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[09:51:45] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[09:52:24] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[09:58:40] *** Joins: larhat (Adium@moz-8v4.af0.232.213.IP)
[09:59:19] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:59:44] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[10:01:06] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[10:02:43] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[10:03:11] *** Joins: ytain (ytain@moz-44k.q8p.140.24.IP)
[10:05:23] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[10:10:08] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[10:12:58] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[10:14:02] *** Quits: sprang (sprang@moz-bll05b.zoominternet.net) (Ping timeout: 121 seconds)
[10:33:32] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Quit: Linkinus - http://linkinus.com)
[10:37:29] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[10:39:16] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[10:43:36] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[10:43:49] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[10:44:45] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[10:45:18] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[10:45:24] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[10:48:54] *** Joins: laumann (thomas@moz-1i4.hq0.225.130.IP)
[10:52:01] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[10:58:45] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[10:59:28] *** Joins: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net)
[10:59:28] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[11:10:23] *** Joins: arrrrrrr1 (arrrrrrrrs@moz-4jf9qp.dynamic.qsc.de)
[11:15:23] *** Joins: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com)
[11:25:21] *** Joins: ManishCloud (uid36524@moz-756cgc.ealing.irccloud.com)
[11:26:15] *** Quits: eerie_ (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[11:27:12] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[11:34:09] *** Quits: ManishCloud (uid36524@moz-756cgc.ealing.irccloud.com) (Quit: )
[11:34:27] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[11:43:09] *** Joins: _zxq9_ (ceverett@moz-qsm369.mesh.ad.jp)
[11:49:39] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[11:52:16] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[11:53:58] *** Joins: marsel (user@moz-a2q.epg.180.94.IP)
[11:54:21] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[11:56:18] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[12:02:34] *** Joins: aepsil0n (eduard@moz-e1hmhk.3ec9.hh0f.8071.2a02.IP)
[12:05:39] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[12:06:37] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[12:07:49] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:08:31] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Quit: Leaving...)
[12:14:03] *** Quits: ytain (ytain@moz-44k.q8p.140.24.IP) (Quit: Textual IRC Client: www.textualapp.com)
[12:17:38] *** Joins: ctennis (ctennis@moz-su6.e72.137.99.IP)
[12:22:32] *** Quits: mw (mw@moz-f1s7jp.vie.surfer.at) (Ping timeout: 121 seconds)
[12:31:41] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[12:36:32] *** Joins: eddyb (eddyb@moz-6k1.q07.26.188.IP)
[12:40:42] <eddyb> nmatsakis: okay, those helper "tail field" functions were trivial after all
[12:48:21] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[12:51:12] <eddyb> wait, what?
[12:51:17] <eddyb> someone forgot to remove a     #[cfg(not(stage0))]
[12:55:11] <eddyb> acrichto: do we need clearer versions of //SNAP? https://github.com/rust-lang/rust/pull/23482#discussion_r26836756
[12:59:22] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[13:00:09] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[13:00:13] *** Quits: martin_ (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP) (Ping timeout: 121 seconds)
[13:03:39] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[13:04:31] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[13:20:36] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[13:21:41] *** Joins: pczarn (piotr@moz-9un7t9.izacom.pl)
[13:24:31] <mw> hm, is there a reason that non-generic DSTs are allowed (as in: https://gist.github.com/michaelwoerister/21f2d66c87eb5d66facd)
[13:24:50] <mw> how would I construct an instance of such a type?
[13:25:07] <eddyb> mw: the bug is that you can't construct it in safe code, not that you can define the type
[13:25:35] <eddyb> I have a pretty good idea of a mechanism for initializing most of these cases
[13:25:49] <eddyb> but it's post-1.0 material, more or less
[13:26:06] <mw> so we do support them?
[13:26:47] <eddyb> mw: you can define str and create it (rather, fat pointers to it) by transmuting pointers to [u8]
[13:27:12] <mw> I can imagine that you can treat them with fat pointers just as other DSTs
[13:27:26] <eddyb> the whole generic structs thing is a red herring
[13:27:46] <eddyb> I hope to localize it to a very small part of the coercion logic
[13:28:14] <eddyb> mw: keep in mind that DST structs with leading fields are not correctly implemented right now (wrt alignment, I think)
[13:28:35] <eddyb> mw: oh, I bet OsStr wraps [u8] without being generic
[13:28:37] <mw> yes, I've seen that
[13:29:14] <mw> I mean, I've seen that the code in adt.rs doesn't take unsized fields into account when computing alignment
[13:30:10] <eddyb> mw: the computation should be done when taking the address of an unsized field
[13:30:31] <eddyb> someone else seemed interested in fixing it but I haven't heard anything since a few weeks ago
[13:32:06] <mw> OsStr is a good example, looking at it right now
[13:32:26] <eddyb> only works because it has no leading fields
[13:35:00] <mw> yeah, looks like quite the hack :)
[13:35:56] <mw> `fn from_u8_slice(s: &[u8]) -> &Slice { unsafe { mem::transmute(s) } }`
[13:36:33] <mw> "don't do this at home, kids"
[13:36:57] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[13:49:50] <SimonSapin> How does `impl char {}` work? https://github.com/rust-lang/rust/pull/23104#issuecomment-84020494
[13:55:30] <huon> SimonSapin: secret compiler magic
[13:55:52] <huon> i.e. arbitrary crates are not allowed to do it
[13:58:56] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[13:59:05] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[13:59:38] *** Quits: aepsil0n (eduard@moz-e1hmhk.3ec9.hh0f.8071.2a02.IP) (Ping timeout: 121 seconds)
[14:03:26] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[14:05:43] *** Joins: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com)
[14:07:55] *** Joins: mystor_ (mystor@moz-ldavpp.home3.cgocable.net)
[14:08:05] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[14:12:39] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.3.92.1)
[14:15:51] *** Joins: aepsil0n (eduard@moz-cos00j.mv2h.pepi.8071.2a02.IP)
[14:16:25] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[14:18:09] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[14:18:49] *** Joins: dinfuehr (dinfuehr@moz-uc88ra.highway.telekom.at)
[14:27:03] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[14:29:38] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[14:32:08] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[14:34:42] <imperio> could it be possible to call a macro like a method (for example: class.macro!() ) ?
[14:35:27] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[14:39:47] *** Quits: aepsil0n (eduard@moz-cos00j.mv2h.pepi.8071.2a02.IP) (Connection closed)
[14:41:10] <SimonSapin> huon: that’s cheating :)
[14:45:14] *** Joins: pnkfelix (pnkfelix@moz-je0.a5j.80.81.IP)
[14:45:14] *** ChanServ sets mode: +o pnkfelix
[14:45:46] *** Quits: pczarn (piotr@moz-9un7t9.izacom.pl) (Ping timeout: 121 seconds)
[14:48:49] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[14:52:01] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[14:54:16] *** Quits: det (chris@moz-2pbdg1.lv.cox.net) (Connection closed)
[14:57:28] <steveklabnik> Manishearth: ping!
[14:58:22] *** Quits: {-}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[15:00:07] *** Joins: poorman (poorman@moz-7p5b2o.res.rr.com)
[15:03:36] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[15:06:50] <simukis> arrrgh, ∀m₁∀t₁∀m₂∀t₂ `*m₁ t₁` and `*m₂ t₂` should be easily comparable without casts.
[15:07:21] <simukis> where m_x is mutability and t_x is type
[15:07:42] <arrrrrrr1> that's some fancy unicode
[15:07:56] <pnkfelix> i can't believe it didn't kill my Emacs instance
[15:08:35] *** Quits: laumann (thomas@moz-1i4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[15:08:49] *** Joins: sternmull (kringel@moz-bt9v6r.dip0.t-ipconnect.de)
[15:08:52] <imperio> pnkfelix: be more confident in emacs. It rocks
[15:10:20] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[15:10:23] *** Joins: det (chris@moz-2pbdg1.lv.cox.net)
[15:11:04] <arrrrrrr1> all modern unix-like operating systems (linux, osx, emacs, etc.) can be expected to have good unicode support
[15:11:18] <arrrrrrr1> not all of them have good text editors, though
[15:17:41] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[15:21:18] <Manishearth> steveklabnik: pong
[15:22:22] <steveklabnik> Manishearth: so, first off, thanks again for doing all your rollup work :)
[15:22:29] <steveklabnik> i do have one tiny thing with it though
[15:22:41] <steveklabnik> if you rebase someone's commit, you should preserve them as author
[15:22:55] <Manishearth> steveklabnik: I do :)
[15:23:00] <steveklabnik> ahh, you didn't with one of mine
[15:23:04] <Manishearth> wait what
[15:23:08] <steveklabnik> which is less of a big deal than with a newbie
[15:23:12] <Manishearth> (author != committer)
[15:23:14] * steveklabnik finds it
[15:23:15] <Manishearth> link please?
[15:23:22] <Manishearth> I *did* cherry pick one of yorus recently
[15:23:39] <steveklabnik> https://github.com/rust-lang/rust/commit/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1 <-
[15:23:46] <steveklabnik> has you as author
[15:23:56] <Manishearth> steveklabnik: that's the rollup merge commit 
[15:24:01] <Manishearth> steveklabnik: click the parents
[15:24:08] <steveklabnik> ahhhhh
[15:24:10] <Manishearth> https://github.com/rust-lang/rust/commit/71321ff33fa3fe71cc1df541b3d0547b4e208923
[15:24:10] <steveklabnik> awesome :)
[15:24:15] <Manishearth> steveklabnik: merge commits show the net diff
[15:24:18] <steveklabnik> it was literally the first thing i saw this morning
[15:24:21] <steveklabnik> so that's my b
[15:24:22] <Manishearth> git diff HEAD1..HEAD2
[15:24:24] <Manishearth> haha
[15:24:54] <Manishearth> steveklabnik: note that HEAD2 is still *committed* by me (bc cherrypick), but that doesn't show up in stats anywhere
[15:24:59] <steveklabnik> right
[15:25:08] * simukis thinks that merge commits should not happen at all most of the time
[15:25:13] <Manishearth> the only visible change of a cherrypick is that the date changes, and the "committed by" moves around
[15:25:26] <steveklabnik> that's not the thing i was worried about anyway, it's more like 'oh man, i got my first commit into rust! oh wait, i didn't even get credit :("
[15:25:27] <Manishearth> simukis: makes it easy to trace which PR a change came from
[15:25:30] <Manishearth> has been helpful
[15:25:38] <Manishearth> steveklabnik: Yeah, I know :)
[15:25:45] <Manishearth> I'm quite concerned about those things too :p
[15:25:48] <steveklabnik> :) <3
[15:25:54] <Manishearth> simukis: wait till I start octopussing rollups
[15:25:59] <simukis> Manishearth: https://github.com/nagisa/s3-directory-listing/commit/1dc88c6b0f6c4df470d35d1c212ee65147926064
[15:26:04] <simukis> see branch
[15:26:06] <Manishearth> git merge sha1 sha2 sha2 sha4 sha5 sha6
[15:26:08] <simukis> master (#1)
[15:26:10] <imperio> steveklabnik: I don't get it. You already do have commit into rust, no ?
[15:26:27] <Manishearth> simukis: right. only on github :p
[15:26:30] <simukis> imperio: almost nobody commits directly
[15:26:31] <steveklabnik> imperio: i was trying to say for newbies, not for me.
[15:26:33] <Manishearth> but yeah, I get your point
[15:26:52] <simukis> Manishearth: there’s 0 usecases of having mergecommits to relate for PRs that are on GH anyway
[15:27:11] <Manishearth> simukis: Belive me, I've used the git history to great effect
[15:27:12] <steveklabnik> imperio: if i miss out on a commit or two, no biggie, but i want to make sure that a new committer will always get credit
[15:27:19] <imperio> simukis: on big projects like rust, it's very rare
[15:27:39] <Manishearth> simukis: I do all my rollup work locally, so git log -- file, etc become easy to use when the merge commit exists
[15:27:45] <imperio> steveklabnik: okay, I get your point ! Seems logical for someone to get credits for his work
[15:27:46] *** Joins: corallok (corallok@moz-k1scau.res.rr.com)
[15:27:51] *** Quits: corallok (corallok@moz-k1scau.res.rr.com) (Connection closed)
[15:28:29] <simukis> steveklabnik: speaking of new commiters, they should be getting swag packs instead
[15:29:10] * Manishearth wants swag
[15:29:12] <simukis> (though nothing you can do about this)
[15:29:24] <simukis> Manishearth: stand in the line
[15:29:27] <Manishearth> lol
[15:29:49] <Manishearth> I have stickers though. Still a couple left which I can give any rustacean in the mumbai area
[15:31:18] <simukis> do I need a PR to get some branch into try?
[15:32:18] *** Quits: eddyb (eddyb@moz-6k1.q07.26.188.IP) (Ping timeout: 121 seconds)
[15:32:35] <Manishearth> simukis: you can push to the try branch and it *might* work
[15:32:36] <Manishearth> maybe
[15:32:38] <Manishearth> possible
[15:32:39] *** Joins: Kxepal832 (Miranda@moz-7ds3ps.pppoe.mtu-net.ru)
[15:32:40] <Manishearth> *possibly
[15:32:42] <Manishearth> perhaps
[15:32:44] <Manishearth> mayhaps
[15:32:51] <Manishearth> or everything might just blow up
[15:32:57] <Manishearth> chewing gum and duct tape, people
[15:33:12] <Manishearth> https://github.com/laumann/compiletest-rs
[15:33:14] <Manishearth> check it out
[15:33:39] <imperio> simukis: what is swag pack ?
[15:33:54] <simukis> Manishearth: that won’t help me with testing a PR on all the platforms that aren’t linux
[15:34:47] <Manishearth> imperio: a pack of swag, obviously
[15:35:01] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[15:35:04] <Manishearth> (probably tshirts, stickers, and stuff)
[15:35:14] *** Quits: Kxepal (Miranda@moz-t124v6.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[15:35:27] <Manishearth> simukis: no, the last bit was just a broadcast "check it out"
[15:35:36] <Manishearth> not directed to yo uspecifically :p
[15:35:48] <simukis> eh…
[15:35:51] <Manishearth> simukis: anyway, try pushing to the try branch, if it doesn't work, do `@bors: try` and pray
[15:35:56] <Manishearth> *you *specifically
[15:36:06] <Manishearth> race condition in fingers whilst typing
[15:36:28] *** Joins: ytain (ytain@moz-44k.q8p.140.24.IP)
[15:37:11] <arrrrrrr1> what's the license of the rust logo?
[15:38:07] <imperio> Manishearth: oh ! That's too cool !
[15:39:09] <Manishearth> arrrrrrr1: Gc<T>, I presume
[15:39:34] *** Joins: dinfuehr_ (dinfuehr@moz-lruu76.highway.telekom.at)
[15:39:47] <arrrrrrr1> Manishearth: that joke, if it is one, is way too clever for me
[15:41:02] <Manishearth> arrrrrrr1: shareable :P
[15:41:17] <arrrrrrr1> is it thread safe?
[15:41:36] <arrrrrrr1> https://github.com/rust-lang/rust-www/blob/gh-pages/COPYRIGHT
[15:41:39] <arrrrrrr1> not really helpful
[15:41:57] *** Quits: dinfuehr (dinfuehr@moz-uc88ra.highway.telekom.at) (Ping timeout: 121 seconds)
[15:50:26] <cyndis> arrrrrrr1: https://github.com/rust-lang/rust/issues/11562#issuecomment-50833809
[15:54:15] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[15:55:15] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[15:55:19] *** Quits: dinfuehr_ (dinfuehr@moz-lruu76.highway.telekom.at) (Connection closed)
[15:56:47] *** Joins: sprang (sprang@moz-91e.ush.56.172.IP)
[16:02:10] *** Joins: squiddy_ (squiddy@moz-md4.pm3.19.178.IP)
[16:02:44] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[16:02:46] *** Quits: squiddy_ (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[16:06:04] *** sunfish-away is now known as sunfish
[16:09:14] <arrrrrrr1> what's a proper image editing program for linux? Not gimp. (I'm editing the rust logo so it's a rust related question.)
[16:09:44] <imperio> Why not gimp ?
[16:09:53] <arrrrrrr1> because it can't even do the most elementary things
[16:11:08] <imperio> if .NET is working on linux (I don't remember if it has been ported yet or not) then .NET paint :D
[16:11:52] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[16:11:59] *** Quits: imperio (Mibbit@moz-psdrik.rev.sfr.net) (Quit: http://www.mibbit.com ajax IRC Client)
[16:15:10] <Manishearth> iit's been ported
[16:15:11] <Manishearth> long ago
[16:15:14] <Manishearth> mono
[16:15:20] <Manishearth> and now it's official
[16:15:31] <simukis> arrrrrrr1: inkscape for rust logo. https://assets.mozilla.org/portal/assets/ has everything you need
[16:15:34] <Manishearth> https://github.com/microsoft/dotnet
[16:15:35] <simukis> including a license.
[16:16:10] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[16:16:51] *** Quits: sprang (sprang@moz-91e.ush.56.172.IP) (Ping timeout: 121 seconds)
[16:17:11] *** Joins: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP)
[16:19:11] *** Quits: ytain (ytain@moz-44k.q8p.140.24.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:20:22] *** Joins: Kxepal (Miranda@moz-ils1sn.pppoe.mtu-net.ru)
[16:20:54] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[16:21:41] *** Quits: Kxepal832 (Miranda@moz-7ds3ps.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[16:23:05] <WindowsBunny> Manishearth: sup
[16:24:26] *** Quits: eternaleye (eternaleye@moz-5fh.ehi.245.50.IP) (Ping timeout: 121 seconds)
[16:24:28] <WindowsBunny> Manishearth: did you need anything?
[16:25:16] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[16:26:22] <barosl> simukis, Woot! That site's useful
[16:26:28] <Manishearth> WindowsBunny: basically, poke gh23470 with a sharp MicroStick until it works
[16:26:29] <[o__o]> std: Remove old_io/old_path from the prelude: https://github.com/rust-lang/rust/pull/23470
[16:26:47] <WindowsBunny> oh, okay
[16:28:07] *** Joins: eternaleye (eternaleye@moz-5fh.ehi.245.50.IP)
[16:28:34] <WindowsBunny> Manishearth: making
[16:28:43] *** Joins: sprang (sprang@moz-91e.ush.56.172.IP)
[16:29:24] <Manishearth> WindowsBunny: thx
[16:29:27] *** Quits: mystor_ (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[16:29:39] <Manishearth> WindowsBunny: src/libstd/sys basically needs some Path-y love
[16:29:53] <WindowsBunny> I see it
[16:29:54] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[16:31:26] <WindowsBunny> Manishearth: I love/hate these paths
[16:31:27] <WindowsBunny> C:/msys64/home/Peter/rust/src/libstd\sys/windows\backtrace.rs:304:16:
[16:31:32] <WindowsBunny> mixtures of both slashes :D
[16:31:42] <Manishearth> heh
[16:31:43] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[16:31:51] <Manishearth> *cough* windows
[16:34:02] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[16:36:29] <simukis> acrichto: ping
[16:36:57] <acrichto> simukis: pong
[16:37:41] <simukis> acrichto: how important for us to keep functionality of executing stack_exhausted lang item when the guard page is hit as opposed to when __morestack tells stack is exhausted?
[16:38:01] <simukis> that’s a lot of pretty ugly code
[16:38:09] <acrichto> simukis: it's "nice" to print that a stack overflow happened vs just a plain segfault
[16:38:15] <acrichto> not critical, however
[16:38:19] <acrichto> I agree it has lived far past its prime
[16:38:33] <simukis> acrichto: we still do that if we exhaust the stack via __morestack
[16:38:52] <simukis> but __morestack doesn’t exist with #[no_stack_check] or -C no-stack-check
[16:38:59] <acrichto> indeed
[16:39:24] <WindowsBunny> and windows uses only guard pages, no __morestack
[16:39:37] <simukis> WindowsBunny: nope, we use stack probes
[16:40:06] <WindowsBunny> stack probes just poke the stack to see if it hits a guard page
[16:40:35] <simukis> WindowsBunny: and we use outcome of *that* poke to print a pretty message
[16:41:07] <WindowsBunny> We use an SEH exception to handle stack overflow
[16:42:15] <simukis> yep. So the question is whether we need __morestack at all then
[16:42:37] <Zoxc> simukis: For platforms not having stack probes (i.e. not Windows)
[16:42:51] <simukis> we could go ahead with handling stack overflow (and printing pretty messages) with only the guard pages and sigsegv handling
[16:43:04] <Zoxc> We already do that
[16:43:12] <WindowsBunny> simukis: If the platform doesn't have a stack probe, then it needs __morestack
[16:43:12] <Zoxc> for C code
[16:43:21] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[16:43:21] <Zoxc> but it's not failsafe
[16:43:28] <simukis> WindowsBunny: ah, right.
[16:43:41] <simukis> the thing is that __morestack also checks for stack bounds which we set
[16:43:54] <simukis> and invokes stack_exhausted langitem
[16:44:01] <WindowsBunny> kinda funny that windows has the most sane stack overflow handling
[16:44:23] <simukis> I’m asking how necessary is to keep that pretty message on those corner cases where people specifically opt out from __morestack
[16:44:47] <Zoxc> It won't be the corner case when stack probes are supported
[16:44:49] *** Joins: bombless (bombless@moz-1j8.piv.41.59.IP)
[16:45:21] <Zoxc> __morestack is the corner case for poorly supported platforms
[16:45:24] <simukis> Zoxc: I believe when stack probes become supported we finally will get stack handling as sane as windows has?
[16:45:58] <WindowsBunny> lol @ non-windows being poorly supported
[16:46:05] <Zoxc> WindowsBunny: :)
[16:46:26] <simukis> WindowsBunny: this is just unix being inane.
[16:47:05] <Zoxc> simukis: You mean LLVM
[16:47:07] <WindowsBunny> Now I see why so many developers use posix platforms, it needs all the help it can get to even run
[16:47:17] <acrichto> WindowsBunny: is it possible to debug a hung rust program in windows?
[16:47:22] <acrichto> WindowsBunny: e.g. can I get a backtrace in gdb?
[16:47:27] <WindowsBunny> acrichto: sure?
[16:47:37] <acrichto> if I ctrl-c to get a prompt it kills the whole program
[16:47:41] <WindowsBunny> I don't know how to attach gdb to a running process or anything
[16:47:55] <WindowsBunny> you can always open a second terminal?
[16:48:00] <simukis> Zoxc: honestly, I believe it is OS’s responsibility to provide the stack introspection tools, like windows does.
[16:48:02] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[16:48:05] <acrichto> gdb apparently can't attach to remote processes in windows :\
[16:48:10] <WindowsBunny> oh fun
[16:48:19] <WindowsBunny> and if you use visual studio's debugger it won't understand the debug info!
[16:48:22] <Zoxc> simukis: Stack probes are a compiler's job though, which is what we lack
[16:48:27] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[16:48:28] <WindowsBunny> because you guys still use dwarf >:(
[16:48:59] <simukis> Zoxc: these are barely useful without introspection.
[16:49:19] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[16:49:25] <Zoxc> simukis: We don't need stack introspection (we just die on stack overflow)
[16:49:41] <simukis> So again, I’m not proposing to abolish __morestack nor guard pages. Just SIGSEGV handler which is very ugly and only prints one line
[16:49:57] <simukis> and we would still keep that line if people don’t use -C no-stack-check
[16:50:05] <simukis> or the corresponding attribute
[16:50:36] <simukis> Zoxc: not quite, we currently also print a line about which thread overflowed.
[16:50:46] <Zoxc> It's nice to know what happened instead of just a SIGSEGV/SIGBUS though
[16:50:48] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[16:50:52] <Zoxc> simukis: I wrote the code btw =P
[16:51:37] <simukis> Zoxc: sorry 😃
[16:51:52] <simukis> you can’t handle sigsegv in any saner way anyway, right?
[16:51:54] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:51:54] *** ChanServ sets mode: +o brson
[16:52:38] <Zoxc> simukis: I don't think so
[16:53:00] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[16:53:12] <acrichto> WindowsBunny: as a side note, have mingw-w64's mirrors changed recently? I can't seem to update any more
[16:53:37] <WindowsBunny> I don't know
[16:53:41] <simukis> Zoxc: re nice to know: sure, but with my proposal we only lose that information when no-stack-check is used
[16:53:43] <WindowsBunny> and I don't know how to update mirrors either
[16:53:49] <simukis> which is pretty rare in my experience
[16:53:56] *** Joins: pczarn (piotr@moz-9un7t9.izacom.pl)
[16:54:24] * WindowsBunny laughs hysterically and then starts sobbing
[16:58:43] <arrrrrrr1> http://a.pomf.se/kqporp.svg
[16:58:49] <arrrrrrr1> 9000 seconds in inkscape
[16:59:33] *** Joins: dpc_ (dpc@moz-a8v.6sn.162.73.IP)
[17:02:16] *** Quits: sprang (sprang@moz-91e.ush.56.172.IP) (Connection closed)
[17:02:54] <WindowsBunny> acrichto: Do you have a fix for gh23470 ready to go, or do you want a commit I just made which fixes it?
[17:02:54] <[o__o]> std: Remove old_io/old_path from the prelude: https://github.com/rust-lang/rust/pull/23470
[17:02:56] *** Joins: sprang (sprang@moz-91e.ush.56.172.IP)
[17:04:05] <acrichto> WindowsBunny: working backwards through my inbox, haven't gotten to it just yet
[17:07:14] *** Quits: _zxq9_ (ceverett@moz-qsm369.mesh.ad.jp) (Quit: Konversation terminated!)
[17:07:18] <Zoxc> simukis: no-stack-check will be the default on x86 if my LLVM patch lands
[17:07:46] <simukis> which is?
[17:09:57] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[17:10:39] *** Quits: dpc_ (dpc@moz-a8v.6sn.162.73.IP) (Ping timeout: 121 seconds)
[17:11:09] <simukis> Zoxc: is that patch public yet?
[17:12:03] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[17:13:44] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[17:13:44] <bstrie> acrichto: care to open the door?
[17:13:53] <acrichto> bstrie: sure
[17:15:06] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[17:15:11] *** Quits: jevin (jevin@moz-sra.ovp.12.72.IP) (Quit: Textual IRC Client: www.textualapp.com)
[17:15:14] <Zoxc> simukis: Yes
[17:15:27] <Zoxc> simukis: https://github.com/llvm-mirror/llvm/compare/master...Zoxc:stprobe-base
[17:15:49] <Zoxc> https://github.com/llvm-mirror/compiler-rt/compare/master...Zoxc:stprobe
[17:16:22] <simukis> Zoxc: have you submitted that to LLVM yet?
[17:16:46] <Zoxc> Not that rebase, but there's been patches since autumn
[17:17:09] *** Quits: huseby (huseby@moz-3oh5i4.linuxprogrammer.org) (Ping timeout: 121 seconds)
[17:18:17] <simukis> oh well, I think I’ll abort anything I did so far then
[17:24:35] *** Quits: Antoine (allioux2012@moz-cegmhn.iiens.net) (Ping timeout: 121 seconds)
[17:25:39] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[17:29:42] *** Joins: {-}grant ({0}grant@moz-rlr.tb2.56.172.IP)
[17:32:56] <brson> acrichto, nmatsakis: i thought of a pretty ok excuse for rewriting tests.mk while fixing the problem of needing to 'touch' to run tests
[17:32:57] <simukis> Zoxc: can’t signal handler stack be allocated once the signal occurs?
[17:33:12] <brson> the first step i have in mind to reduce aws costs involves running the test suite independently of the build
[17:33:31] <nmatsakis> brson: I'm listening :)
[17:33:56] <pnkfelix> brson: so i am
[17:34:13] <pnkfelix> (sigh)
[17:34:27] <Zoxc> simukis: No the signal handler needs a stack to run
[17:34:48] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[17:34:53] <brson> heh. there's not much too it, but we want to move whatever builds we can to taskcluster because it's cheap, but it's also slow. the arrangement we want is *one* build of the compiler, then use that to run the test suite in parallel on many machines in parallel
[17:35:03] <brson> the current test suite doesn't support that
[17:35:14] <Zoxc> simukis: You'll need kernel support if you want to share signal handler stacks
[17:35:42] <brson> of course this can be hacked up using *touch*
[17:36:00] *** Quits: sprang (sprang@moz-91e.ush.56.172.IP) (Ping timeout: 121 seconds)
[17:36:00] <brson> but it's accumulating motivation to do a rewrite
[17:36:19] <brson> right now on integration  fyi we build the compiler for each testing configuration
[17:36:25] <brson> and there are usually two configs per arch
[17:36:39] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[17:36:53] <brson> between halving the compiler builds and running the tests on cheap vms it should cut our costs in half-ish
[17:37:02] <brson> for integration builds at least
[17:37:19] <pnkfelix> wait, why would it halve the compiler builds again?
[17:38:01] <brson> pnkfelix: we build the same compiler on e.g. auto-linux-32-opt and auto-linux-32-nopt-t
[17:38:10] <brson> then run the test suite under two different configs
[17:38:23] <brson> those two builds can be consolidated be splitting the building and testing up
[17:38:28] <pnkfelix> brson: okay I see now, its the same compiler because it is built with optimization either way
[17:38:51] *** Joins: sprang (sprang@moz-skdqur.hfc.comcastbusiness.net)
[17:39:31] <brson> so the two new capabilities the test suite needs are independence from the build and sharding
[17:41:44] <brson> another build system refactoring i want to do is make the stdlib build completely independent from the compiler build. i think there are several reasons to want the stdlib to be independently buildable
[17:42:05] <brson> so my dream is to rewrite tests.mk in python, then the stdlib build in python, then whatever's left
[17:42:15] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[17:42:33] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[17:42:48] <brson> having a separate stdlib build would allow our ci bots to do that same optimization of not-rebuilding the compiler for lesser cross targets
[17:44:04] <brson> so the android integration task sequence would be: build the common compiler, on another machine build the android target libs, maybe on more machines yet, run sharded android tests
[17:47:35] <imperio> is there still someone working on this gh22709 ? It seems that it's been a while no one worked on it
[17:47:35] <[o__o]> Many std iterators do not implement Send/Sync: https://github.com/rust-lang/rust/issues/22709
[17:48:17] *** Quits: pnkfelix (pnkfelix@moz-je0.a5j.80.81.IP) (Connection closed)
[17:48:28] *** Joins: pnkfelix (pnkfelix@moz-je0.a5j.80.81.IP)
[17:48:28] *** ChanServ sets mode: +o pnkfelix
[17:49:10] <pnkfelix> brson: so you want to be able to build a rustc that links to the snapshot's stdlib ?
[17:51:11] <brson> pnkfelix: no. i want to build a rustc, ship it off somewhere else, then use that rustc to build a self-compatible libstd for android
[17:51:28] <brson> not a snapshot though
[17:51:30] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[17:52:50] <brson> this sort of capability i think would be generally useful. at some point we'll be distributing the stdlib source with rust (optionally), and if you need a std for some obscure platform you could just run a script to build it for yourself
[17:53:07] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[17:53:11] <brson> you could use the same script to package std with cargo if you wanted
[17:54:17] <brson> actually, i might prefer a hypothetical cargoified std to reach into your installed source code to build the 'correct' std and not actually package std
[17:59:28] <simukis> brson: /me would strongly recommend Shake for any build needs, but can’t expect people to pull in whole haskell toolchain just to build rust
[17:59:39] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[18:00:46] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[18:01:47] <pnkfelix> this is an interesting page: https://github.com/ndmitchell/build-shootout
[18:02:23] *** Joins: rajat (rajat@moz-fq5.l4p.189.205.IP)
[18:02:45] *** Quits: bombless (bombless@moz-1j8.piv.41.59.IP) (Quit: Leaving)
[18:03:40] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[18:08:34] *** Quits: marsel (user@moz-a2q.epg.180.94.IP) (Ping timeout: 121 seconds)
[18:11:52] *** Joins: avikpal (avikpal@moz-b76.3e4.194.117.IP)
[18:13:58] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[18:18:57] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[18:19:31] <aturon> acrichto: note from #servo, it appears that there is some significant demand for timeouts in io there. are you still planning to put together that RFC amendment or shall i?
[18:19:58] <acrichto> aturon: is it just networking/TCP timeouts?
[18:20:06] <aturon> trying to determine right now
[18:21:01] <aturon> acrichto: they need to hear from jdm to be sure, will get back to me
[18:22:55] *** Quits: {-}grant ({0}grant@moz-rlr.tb2.56.172.IP) (Ping timeout: 121 seconds)
[18:22:56] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Connection closed)
[18:23:18] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[18:25:26] *** Joins: eddyb (eddyb@moz-6k1.q07.26.188.IP)
[18:28:21] *** Joins: marsel (user@moz-a2q.epg.180.94.IP)
[18:29:08] *** Quits: pnkfelix (pnkfelix@moz-je0.a5j.80.81.IP) (Ping timeout: 121 seconds)
[18:29:27] *** Joins: pcwalton (pcwalton@moz-u92.384.6.71.IP)
[18:29:27] *** ChanServ sets mode: +o pcwalton
[18:30:09] <simukis> Zoxc: what’s your response to only failing in debug builds if guard page allocation failed?
[18:30:36] <sfackler> it's just going to be a wrapper around setsockopt with SO_SNDTIMEO and SO_RCVTIMEO, right?
[18:30:51] <Zoxc> simukis: Does things fail in debug build only?
[18:31:17] <simukis> Zoxc: overflowing an integer will only fail in debug
[18:31:25] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[18:31:29] *** Quits: eddyb (eddyb@moz-6k1.q07.26.188.IP) (Ping timeout: 121 seconds)
[18:31:38] <simukis> I mean application might as well run just fine even if we can’t allocate the guard page
[18:33:10] *** Joins: canhtak (canhtak@moz-6t0.c9a.252.94.IP)
[18:35:26] <Zoxc> simukis: brson wanted it to fail, so that was my intention
[18:36:06] <arrrrrrr1> is there a way to see the licenses used on crates.io?
[18:36:27] <simukis> there were a blog post with all licenses used somewhere
[18:36:40] <arrrrrrr1> I need up to date statistics
[18:36:59] * simukis shrugs
[18:37:31] *** Quits: kushal (kdas@moz-k3qqn7.202.sitibroadband.in) (Quit: Leaving)
[18:38:33] *** Quits: dherman (sid7996@moz-pof.lg2.184.192.IP) (Ping timeout: 121 seconds)
[18:38:47] *** Quits: stask (sid61294@moz-pof.lg2.184.192.IP) (Ping timeout: 121 seconds)
[18:39:32] *** Quits: lkuper (sid44041@moz-pof.lg2.184.192.IP) (Ping timeout: 121 seconds)
[18:39:33] *** Quits: freebroccolo (sid51271@moz-pof.lg2.184.192.IP) (Ping timeout: 121 seconds)
[18:39:39] *** Quits: zwarich (sid63988@moz-pof.lg2.184.192.IP) (Ping timeout: 121 seconds)
[18:40:51] <acrichto> arrrrrrr1: https://gist.github.com/alexcrichton/db4d054da31a6a8aac16
[18:41:10] <arrrrrrr1> how does the LGPL interact with the rust linking model?
[18:42:48] *** Joins: mystor_ (mystor@moz-3jc.dhe.151.184.IP)
[18:43:50] <arrrrrrr1> Accompany the work with [..] the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library
[18:43:54] <arrrrrrr1> oh boy
[18:44:24] <arrrrrrr1> looks like all those lgpl crates are practically gpl
[18:44:56] *** Quits: rajat (rajat@moz-fq5.l4p.189.205.IP) (Client exited)
[18:46:37] *** Quits: bleibig (bleibig@moz-btk.gm4.170.73.IP) (Quit: Textual IRC Client: www.textualapp.com)
[18:47:19] <cmr> arrrrrrr1: I would not recommend creating a closed source Rust application that uses any LGPL code, but the easiest way to do it would be to forbid anything that causes monomorphization and use a dylib.
[18:47:26] *** Joins: Rym (y@moz-cfe.mso.205.31.IP)
[18:50:08] <cmr> arrrrrrr1: although, I just found http://eigen.tuxfamily.org/index.php?title=Licensing_FAQ&oldid=1117#But_doesn.27t_the_LGPL_have_issues_with_code_that_is_in_header_files.2C_and_template_libraries.3F
[18:51:40] <arrrrrrr1> lgpl3 is not compatible with gpl2
[18:51:58] <cmr> indeed not
[18:52:13] <arrrrrrr1> gpl2 compatible is essential in my case
[18:52:16] <cmr> ok
[18:53:14] *** Joins: scialex (scialex@moz-j5mi8i.cs.brown.edu)
[18:53:42] <cmr> it'd be nice if cargo had an allow-licenses config, like portage for example.
[18:53:44] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[18:53:57] *** Quits: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com) (Ping timeout: 121 seconds)
[18:55:05] <arrrrrrr1> is there a license that allows linking but not modifications under any license?
[18:55:40] <sfackler> a "look but don't touch" kind of thing?
[18:55:54] <cmr> no generic one I know of.
[18:55:57] <arrrrrrr1> you can also touch but then you have to distribute the changes under the license
[18:56:44] <arrrrrrr1> Maybe it's best to modify the lgpl so that it applies to rust code
[18:57:39] *** Quits: larhat (Adium@moz-8v4.af0.232.213.IP) (Quit: Leaving.)
[18:57:52] <cmr> oh, actually, MPL2?
[18:58:39] <cmr> there's some ambiguity to me as to what exactly "the terms of this license" means, ie, whether the same restrictions but from a different license counts.
[19:02:19] <arrrrrrr1> >The MPL treats the source code file as the boundary between MPL-licensed and proprietary parts, meaning that all or none of the code in a given source file falls under the MPL.
[19:02:23] <arrrrrrr1> not really a fan of this
[19:05:22] <cmr> arrrrrrr1: you aren't actually allowed to modify the LGPL.
[19:05:26] *** Joins: {-}grant ({0}grant@moz-63ubas.in.charter.com)
[19:05:36] <cmr> or any of the GNU licenses
[19:05:47] <arrrrrrr1> cmr: fsf.org contains the conditions under which you can create modified versions of the gpl
[19:06:01] <arrrrrrr1> you can't call it LGPL of course
[19:07:20] <cmr> Ah I see the faq entry
[19:07:28] <cmr> interesting
[19:09:43] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Connection closed)
[19:10:12] *** Quits: pcwalton (pcwalton@moz-u92.384.6.71.IP) (Client exited)
[19:10:32] *** Joins: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com)
[19:14:06] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[19:17:28] <steveklabnik> https://github.com/rust-lang/rust/issues/23422
[19:17:34] <steveklabnik> this basically just calles je_rallocx
[19:17:50] <steveklabnik> and it _seems_ to me like it doesn't do anything bad with the passed in pointer on success, just leaves it alone
[19:17:55] <steveklabnik> but i am unsure
[19:18:20] <steveklabnik> anyone happen to know?
[19:19:59] <arrrrrrr1> https://gist.github.com/anonymous/f2c8f9aee797973cf958
[19:20:01] <cmr> steveklabnik: the old area gets free'd
[19:20:06] <arrrrrrr1> does this section apply to rust code?
[19:20:07] <cmr> if the allocation needed to move
[19:20:10] *** Quits: Rusky (russell@moz-2a17lj.slkc.qwest.net) (Quit: Leaving.)
[19:20:47] <steveklabnik> cmr: ahh
[19:20:51] <arrrrrrr1> this probably refers to stuff such as "extern TYPE name;" in C code
[19:20:53] <arrrrrrr1> not sure
[19:20:57] *** Joins: Rusky (russell@moz-2a17lj.slkc.qwest.net)
[19:21:30] <cmr> steveklabnik: it's probably best to just say "the memory at the passed-in pointer is undefined after the call", but note that the returned pointer might be the same as the passed pointer if the allocator had space and felt like it.
[19:22:24] <cmr> arrrrrrr1: I'm honestly not sure.
[19:24:58] <arrrrrrr1> the equivalent is probably "if the modified crate refers to another crate ..."
[19:33:56] *** Quits: Rusky (russell@moz-2a17lj.slkc.qwest.net) (Quit: Leaving.)
[19:37:45] *** Joins: Rusky (russell@moz-2a17lj.slkc.qwest.net)
[19:37:46] *** Quits: avikpal (avikpal@moz-b76.3e4.194.117.IP) (Connection closed)
[19:38:35] *** {-}grant is now known as {[]}grant
[19:43:42] *** Joins: reem (reem@moz-uaj066.coob.q2h1.0009.2601.IP)
[19:44:24] *** Joins: avikpal (avikpal@moz-b76.3e4.194.117.IP)
[19:44:44] <kmc> cargo bench should integrate with perf
[19:45:01] <cmr> kmc: that'd be nice
[19:45:08] <kmc> so that I can do cargo bench --measure=clock-time,instructions,page-faults
[19:45:16] <cmr> what I do now is cargo bench, ctrl c when it starts running, and then muck with perf.
[19:46:21] *** Quits: avikpal (avikpal@moz-b76.3e4.194.117.IP) (Connection closed)
[19:48:58] <reem> Keep in mind that perf is a linux only tool
[19:49:04] <reem> those of us on OS X have to use instruments
[19:49:30] <kmc> I know
[19:49:37] <kmc> it'd be good to integrate with whatever's available in each platform
[19:49:41] <reem> I would love the ability to integrate though
[19:49:50] <cmr> "cargo perf"
[19:50:01] <reem> right now I usually have to prep an entirely new example and run it with --release to actually profile things
[19:50:02] <cmr> I wonder how that'd work though, you'd really want numbers for each individual benchmark.
[19:50:45] <reem> Honestly the ability to easily run just one benchmark and have it not stop until some trigger I haven't yet determined
[19:51:01] <reem> so you can just run cargo bench --only=x then run whatever profiler on that executable, which is just running x over and over
[19:52:17] <kmc> cargo bench --only=blah --for="2 seconds"
[19:53:57] *** Quits: reem (reem@moz-uaj066.coob.q2h1.0009.2601.IP) (Connection closed)
[19:54:30] <aturon> Gankro: looks like your From => Intro trick is going to work after all (cc acrichto)
[19:54:38] *** Joins: bombless (bombless@moz-q2c9v8.0v2u.0v40.0da8.2001.IP)
[19:54:42] <aturon> Gankro: I'm thinking we might want to just drop `To` in this initial impl
[19:54:51] <Gankro> aturon: Yay!
[19:54:54] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[19:55:16] <aturon> Gankro: i'm also on the fence about the most recently proposed names
[19:55:17] <Gankro> aturon: Could you clarify the distinction between As and Borrow?
[19:55:28] <bombless> What's the easiest way to triger that `debug!` log? I'm trying to debug librustc/middle/check_match.rs
[19:56:19] <aturon> Gankro: to be honest, i'm not sure that there's an interesting *conceptual* difference
[19:56:36] <aturon> Gankro: but there's an important *practical* difference right now
[19:56:41] <aturon> in terms of which blanket impls we can provide
[19:56:43] <bombless> Never mind, I found it in the log of this channel.
[19:56:55] <aturon> Gankro: and the needs of Borrow and As are quite distinct in that respect
[19:57:16] <aturon> Borrow wants a blanket T: Borrow<T>, As wants a blanket &T: As<U> if T: As<U>
[19:57:23] <aturon> both could in principle support both impls, but they conflict
[19:57:50] <aturon> (i can elaborate on why each prefers the blanket it does, if you're curious)
[19:58:20] *** Joins: dherman (sid7996@moz-u0jlif.ealing.irccloud.com)
[19:58:24] <Gankro> aturon: elaborate away
[19:58:25] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[19:58:36] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[19:58:44] <aturon> Gankro: so, the main user of Borrow is maps, of course,
[19:58:59] *** Quits: rovar (rovar@moz-d89.n7f.126.38.IP) (Ping timeout: 121 seconds)
[19:59:00] <aturon> and you want MyMap<OwnedKey, Val> to immediately be usable with &OwnedKey lookup
[19:59:07] <aturon> without requiring OwnedKey to implement anything
[19:59:29] <aturon> (otherwise, if you use a map from one crate, and a key from another, you would end up having to newtype and impl)
[19:59:50] <aturon> the reflexive T: Borrow<T> ensures that you can always look up an owned key using a borrow of it
[20:00:16] <aturon> now, it's *also* very nice for T: As<T>, so that for example when you take As<Path> arguments you can actually, you know, take a Path
[20:00:50] <aturon> however, there's another blanket: `impl<'a, T, U> As<U> for &'a T where T: As<U>`
[20:01:02] *** Joins: bfops (uid58242@moz-e5u6m0.charlton.irccloud.com)
[20:01:16] <aturon> this is useful so that you can write `fn open<P: As<Path>>(p: P) -> File` rather than `fn open<P: ?Sized + As<Path>>(p: &P)`
[20:01:43] <aturon> (and the former signature, besides being simpler, is also more flexible: you can pass in an owned PathBuf without a & on the caller side, if you're done with it
[20:02:17] <aturon> now, the thing is, we don't want to rely on everyone to impl the &-lifting blanket manually for every type -- it's more subtle and easier to forget than the reflexive one
[20:02:33] <aturon> and our use cases for As rely on it
[20:02:44] <nmatsakis> did we ever impl attributes on blocks?
[20:02:49] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[20:02:51] <aturon> but we can easily add reflexive impls of As for each type we want to take via generic conversions
[20:03:01] *** Quits: scialex (scialex@moz-j5mi8i.cs.brown.edu) (Quit: Leaving)
[20:03:18] * nmatsakis interrupts a lengthy dialog
[20:03:21] <aturon> finally, in the long run, specialization will hopefully allow us to add the missing blanket impls
[20:03:21] <nmatsakis> oops
[20:03:29] <aturon> nmatsakis: i don't think so
[20:03:40] <Gankro> aturon: In the future would it make sense to deprecate Borrow in favour of As?
[20:04:03] <aturon> Gankro: possibly so, assuming that specialization would *also* allow a blanket from one to the other (which... may be tricky)
[20:04:13] <aturon> all that said,
[20:04:18] <aturon> Borrow today is quite specialized
[20:04:18] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[20:04:32] <Gankro> Which seems like a bad thing, really (...?)
[20:04:33] <aturon> basically, you only really care when you're implementing a slice type
[20:05:00] <aturon> well, i don't know
[20:05:04] <aturon> (whether it's a bad thing)
[20:05:23] <aturon> relative to As, it means you can't generally look something up by anything it can be converted to
[20:05:34] <aturon> keep in mind, we rely on e.g. the hashing to work out properly in these cases
[20:05:46] <aturon> so it's not necessarily desirable to use As in an unrestricted way there
[20:05:48] <aturon> (come to think of it)
[20:06:05] *** Joins: jdm (jdm@moz-me9tfn.cable.rogers.com)
[20:06:56] <aturon> in other words, it's reasonable to require anything you Borrow to to produce the same hashes, but not everything you can As-convert into
[20:07:09] <aturon> so maybe there is more of a conceptual/semantic distinction than i was thinking at first
[20:07:18] <aturon> ... does that help?
[20:07:40] <Gankro> Aha
[20:07:55] <Gankro> Yeah Requiring Hash/Eq/Ord equivalence is a salient point
[20:08:42] <arrrrrrr1> https://gist.github.com/anonymous/4f035b4d59f5c8b36c98
[20:08:59] <arrrrrrr1> does this mean that you cannot dual-license code that is licensed under the LGPL?
[20:09:10] <Gankro> (although then Equiv seems like a more meaningful name then...)
[20:09:50] *** Quits: mystor_ (mystor@moz-3jc.dhe.151.184.IP) (Ping timeout: 121 seconds)
[20:10:04] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[20:11:21] <Gankro> arrrrrrr1: My (uneducated) understanding is that dual-licensing is sort of a "root" ownership thing. The owner offers the code up under any number of terms they please, and people who use the library have to choose to either modify/use it under LGPL or <other license>.
[20:11:33] <bombless> `RUST_BACKTRACE=1 RUST_LOG=rustc::middle=debug make` So I will need to compile rustc using this to see `debug!` log from check_match.rs, right?
[20:12:38] <Gankro> e.g. I'm aware of dual licensing under GPL for free and MIT for pay
[20:13:17] <cmr> arrrrrrr1: as the copyright owner you are allowed to distribute your IP under whatever terms you wish.
[20:13:45] <XMPPwocky> what license is the lgpl itself under? can you modify it?
[20:13:46] <steveklabnik> nmatsakis: around?
[20:13:47] <XMPPwocky> hm
[20:14:39] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[20:15:06] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Ping timeout: 121 seconds)
[20:15:15] <nmatsakis> steveklabnik: yes
[20:15:29] <steveklabnik> nmatsakis: so, moving and closures. originally we didn't do inference. but you added some?
[20:15:55] <steveklabnik> iirc
[20:16:08] <nmatsakis> steveklabnik: yes -- so the current state is that if you say `move`, then everything is by value (not, despite the keyword, necessarily a *move* -- or rather, if the type impls Copy, then it moves a copy)
[20:16:18] <aturon> acrichto: re: servo's need for timeouts, see http://mxr.mozilla.org/servo/source/components/devtools/lib.rs#228
[20:16:22] <nmatsakis> steveklabnik: but if you dont' say move, we infer what you need, preferring to get away with borrows,
[20:16:29] <nmatsakis> steveklabnik: but I think there is a deeper conceptual difference than that
[20:16:35] <steveklabnik> lay it on me :)
[20:16:45] <nmatsakis> steveklabnik: basically `move` means that the closure gets its own stack frame independent from the creator
[20:16:51] <nmatsakis> steveklabnik: no `move` means that the closure is linked to its creator
[20:17:00] <steveklabnik> hmmmm interesting
[20:17:02] <nmatsakis> steveklabnik: so e.g. if a `move` closure mutates a variable in the environment
[20:17:06] *** Quits: {[]}grant ({0}grant@moz-63ubas.in.charter.com) (Ping timeout: 121 seconds)
[20:17:07] <nmatsakis> steveklabnik: it is mutating a copy in its own space
[20:17:27] <nmatsakis> steveklabnik: whereas if a non-move closure mtuates such a variable, it is mutating the variable directly in the caller's environment
[20:17:30] <nmatsakis> er, creator's
[20:17:40] <acrichto> aturon: oh timeouts for TCP won't solve that case b/c it needs an accept timeout
[20:17:40] *** Joins: huseby (huseby@moz-m7l0au.d2vr.5em6.6400.2605.IP)
[20:17:47] <nmatsakis> stevebklabnik: you can observe this difference
[20:17:47] <acrichto> aturon: which isn't easily implementable as far as I know
[20:17:51] <steveklabnik> interesting, i'll have to give this some thought.
[20:17:54] <nmatsakis> steveklabnik: this is why we don't infer `move`, or one of the reasons
[20:17:59] <aturon> acrichto: yeah, that's what i was afraid of
[20:18:12] <steveklabnik> i'lll be having a good doc PR for you later today, i think :)
[20:18:50] <aturon> acrichto: but i think they're using mio to some degree anyway
[20:19:04] <aturon> acrichto: anyway, we should maybe talk to jdm directly about it after beta
[20:19:08] <acrichto> aturon: hm yeah that may be able to solve the need here
[20:19:10] <acrichto> sure
[20:20:04] <jdm> serov is not using mio yet
[20:20:19] <jdm> at least, not unless one our many dependencies is
[20:20:19] *** Joins: lkuper (sid44041@moz-7edef8.ealing.irccloud.com)
[20:21:02] <aturon> jdm: ok, are you at the "considering" stage? 
[20:21:22] <jdm> aturon: I'm not aware of any plans to move to it right now
[20:21:25] <aturon> (i felt like i'd heard you were already using it, but may have been rumors)
[20:21:34] <jdm> I mean, I wouldn't be surprised if it's on the list of desirable things
[20:21:43] <jdm> but there's not been any compelling reason to do the work that I know of
[20:22:05] <aturon> ok. we can probably address this in some other way, but acceptor timeouts are not likely to happen in std, at least at the cross-platform layer
[20:22:11] <jdm> mmm, fun
[20:22:21] <jdm> I'll see if we can get rid of that code and sidestep the issue
[20:22:31] <aturon> (because we're removing places where we layer a bunch of functionality over some OSes that lack it)
[20:22:44] <aturon> but std's IO now has lots of hooks that allow you to build this kind of thing externally, as well
[20:23:00] <aturon> (which is how mio will integrate with std IO)
[20:23:26] *** Joins: freebroccolo (sid51271@moz-ealde0.ealing.irccloud.com)
[20:27:06] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:27:06] *** ChanServ sets mode: +o pcwalton
[20:30:08] *** Joins: stask (sid61294@moz-0bjq4h.ealing.irccloud.com)
[20:30:21] <aturon> acrichto: i think Wrapping may still want to be in the prelude
[20:30:23] <reem> fwiw seanmonstar and I have been talking a lot about integrating asynchronous IO with hyper
[20:30:30] *** Joins: {-}grant ({0}grant@moz-fctpaa.mo.charter.com)
[20:30:33] <acrichto> aturon: interesting
[20:30:52] <reem> part of the reason being we want support for pervasive timeouts
[20:30:58] <aturon> acrichto: at least, i don't see this PR as affecting that quesiton
[20:31:15] <aturon> acrichto: i presume you're argument is: what % of programs need to do heavy wrapping arithmetic?
[20:31:22] <aturon> reem: yep, makes sense
[20:31:32] <acrichto> aturon: yeah, plus the RFC didn't mention the prelude-ness
[20:31:49] <aturon> nmatsakis: thoughts on Wrapping being the prelude? ^
[20:32:01] <aturon> acrichto: in general i'm a bit more prelude-cavalier than you, i think :)
[20:32:09] <acrichto> hehe, definitely
[20:32:18] <acrichto> mod prelude { pub use std::*; }
[20:32:55] <aturon> hah, not quite *that* cavalier :P
[20:33:03] <aturon> (though i do love me some std)
[20:33:36] *** Joins: zwarich (sid63988@moz-402giv.ealing.irccloud.com)
[20:33:58] <steveklabnik> nmatsakis: thanks for that explanation, i think these docs are gonna be really good
[20:34:15] <steveklabnik> nmatsakis: you're gonna have to double check my expanded stuff, to make sure it's right, but conceptually, i think this doc is good
[20:34:25] <nmatsakis> steveklabnik: cool
[20:38:58] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:39:42] *** Quits: ctennis (ctennis@moz-su6.e72.137.99.IP) (Quit: Leaving...)
[20:39:53] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[20:39:53] *** ChanServ sets mode: +o nrc
[20:42:53] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:42:53] *** ChanServ sets mode: +o pcwalton
[20:45:01] *** Quits: semarie (semarie@moz-jgfl05.torservers.net) (A TLS packet with unexpected length was received.)
[20:45:18] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[20:46:16] <Gankro> aturon: acrichto: as the one who had to labour through migration, perhaps pnkfelix has a good pulse on if it should be in there?
[20:46:48] <aturon> Gankro: good point, i will CC 
[20:49:26] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[20:52:33] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[20:53:22] *** Quits: sprang (sprang@moz-skdqur.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[20:55:18] <Gankro> aturon: Fiddling with ordered collection APIs. get_min/peek_min[_mut?] vs min[_mut?]?
[20:56:46] <reem> I like min and min_mut
[20:57:00] <reem> Mirrors shortness elsewhere
[20:57:08] <Gankro> More of a #rust-libs question I guess; still getting used to that
[20:57:16] <reem> I find we rarely prefix APIs with get
[20:57:17] <aturon> (I agree with reem)
[21:04:43] *** Joins: japaric (japaric@moz-67j.bii.230.201.IP)
[21:05:05] *** Quits: acharles (acharles@moz-1pof4d.fosshotel.is) (Client exited)
[21:09:38] *** Joins: acharles (acharles@moz-1pof4d.fosshotel.is)
[21:10:00] <aturon> acrichto: wow, the cargo stabilization needs look... not bad at all
[21:10:25] <steveklabnik> :D
[21:10:26] <acrichto> aturon: yeah I was actually pretty surprised at how small it was
[21:10:30] <steveklabnik> tha'ts awesome
[21:10:36] <acrichto> I think "serious fs functionality" was the biggest worry I have now
[21:10:45] <aturon> looks like exit status and fs metadata are the biggies
[21:10:46] <acrichto> otherwise it's all pretty chill
[21:10:53] <acrichto> ah right exit status
[21:10:54] <aturon> (which are pretty well-known issues)
[21:11:11] <aturon> acrichto: i wonder if it can be replaced by `exit`?
[21:11:19] <acrichto> I was thinking about that yeah
[21:11:30] <acrichto> and it does seem pretty rare for languages to say "ok, exit now!"
[21:11:39] <acrichto> e.g. python/ruby implement exit by throwing an exception
[21:11:50] <acrichto> but it is in theory possible
[21:12:02] <acrichto> we'd just have to decide that leaking all those destructors on the stack is "ok"
[21:12:06] <aturon> hm, i was just saying that we'd want to stabilize `exit` anyway
[21:12:13] <aturon> but yes
[21:12:21] <acrichto> oh yeah we do want that yeah
[21:12:26] <reem> nmatsakis: Some unfortunate fallout from the upcasting changes: https://github.com/hyperium/hyper/pull/383. Is this the intended behavior and workaround?
[21:12:27] <acrichto> alternatively we could panic a thread 
[21:12:29] <aturon> (which coudl be good enough for now)
[21:12:39] <acrichto> in theory we could panic with ExitStatus(n)
[21:12:45] <acrichto> which suppresses printing
[21:12:47] <acrichto> runs destructors
[21:12:49] <aturon> nmatsakis: nrc: see reem's question ^
[21:12:59] <acrichto> and if the *main thread* actually returns that, then it sets the exit code
[21:13:28] <reem> Might be interesting to provide some custom types that have special behavior when given to panic!
[21:13:28] <aturon> acrichto: that's a bit hokey, but if we have a stable `exit` and `unwind::try` we can build it in-app
[21:13:44] *** Quits: {-}grant ({0}grant@moz-fctpaa.mo.charter.com) (Ping timeout: 121 seconds)
[21:14:01] <aturon> reem: yep -- and more generally, to flesh out our story for panics in child threads
[21:14:11] <acrichto> aturon: ah right we could yeah
[21:15:15] <aturon> acrichto: it is interesting how std::time is ending up blocking other parts of std...
[21:15:17] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[21:15:17] *** Quits: Defaultti (Defaultti@moz-bmdn13.kapsi.fi) (Quit: Quitting.)
[21:15:30] <aturon> (in this case, time::Stamp or whatever rather than time::Duration)
[21:15:54] <cmr> aturon: all the operating system is, after all, is a means of managing space and time :)
[21:16:03] <acrichto> aturon: yeah :(
[21:16:11] <aturon> cmr: touché
[21:16:36] <aturon> the problem is that time stuff is a bit of a minefield
[21:16:40] <cmr> it really is
[21:16:46] <aturon> so we don't want to rush anything
[21:17:33] <cmr> what might be ok for now is an opaque type that only has an Ord/Eq impl, as well as stuff in std::os::$platform for getting system-specific stuff out of them?
[21:17:46] <cmr> I really would hate to predicate a stable std on a mature time library.
[21:17:54] <aturon> cmr: yes, that's one possibility
[21:18:13] <aturon> cmr: and similarly, for duration, the ability to crate one from seconds, millis and nanos is basically all we need for timeouts
[21:18:26] <aturon> (but even there... you have to decide -- signed or unsigned?)
[21:18:37] *** Quits: sternmull (kringel@moz-bt9v6r.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[21:18:45] <reem> duration should be unsigned
[21:18:47] <cmr> (and, absolute or relative!)
[21:18:47] <aturon> wycats: ^^^ i'm looking forward to your RFC :)
[21:18:57] <reem> it's like indexing vs offset, imo
[21:19:05] <steveklabnik> impl<'env> Fn<(i32,)> for ClosureEnvironment<'env>  <- current gives an error about using parens, but using parens gives an associated types error
[21:19:18] <Gankro> aturon: Well we can hold the std libs hostage. Someone implement a robust time library with community concensus or we blow it all up!
[21:19:36] <reem> steveklabnik: You need #![feature(unboxed_closures)] to impl Fn
[21:19:47] <steveklabnik> reem: ahh, yeah, i guess i could do that
[21:19:50] <reem> steveklabnik: So using <(i32,)> is right, you just also need the gate
[21:20:01] <reem> there's no way to do this without the gate today
[21:20:02] <aturon> reem: makes sense, but does that suggest you want both variants?
[21:20:14] <aturon> Gankro: someone is definitely hostage here... just not sure who :)
[21:20:33] <reem> aturon: Honestly I know very little about the actual concerns of time libraries beyond the very basics
[21:20:43] <steveklabnik> reem: thanks
[21:21:04] *** Joins: Defaultti (Defaultti@moz-bmdn13.kapsi.fi)
[21:21:10] *** Quits: bombless (bombless@moz-q2c9v8.0v2u.0v40.0da8.2001.IP) (Quit: Leaving)
[21:21:17] <aturon> reem: same. fortunately, wycats has a bunch of experience and is planning to help write a reform-style RFC (am i still allowed to use that word?)
[21:21:32] <cmr> NO
[21:21:35] <cmr> no you are not
[21:21:35] <aturon> :(
[21:21:44] <cmr> you PROMISED me that io was the last reform!
[21:21:47] <cmr> :P
[21:21:52] <aturon> heh, so i did
[21:21:58] <aturon> RFC: Resetting the clocks
[21:22:07] * aturon goes and does something productive
[21:22:23] <cmr> there, that I can approve of. punny titles. props to huon for "Reseeding std::rng"
[21:22:29] <cmr> (or w/e)
[21:22:32] <aturon> yes that was the best
[21:22:37] <cmr> I'm procrastinating porting some nasty fortran to rust :(
[21:23:01] <brson> aturon: you are not allowed to use that word
[21:23:13] <aturon> oh man
[21:23:24] <acrichto> maybe rust-buildbot should auto-ban anyone who uses that word
[21:23:47] <Gankro> ahaha
[21:24:01] <brson> Yurume should be included in discussions about time libraries since he's put a lot of work into one
[21:24:09] <aturon> brson: yes, definitely, we've already reached out
[21:24:32] <aturon> i haven't seen any response yet (acrichto?)
[21:24:37] <acrichto> not yet :(
[21:24:38] <XMPPwocky> "time for change"?
[21:24:50] <aturon> XMPPwocky: winner!
[21:25:31] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Ping timeout: 121 seconds)
[21:25:49] *** Quits: jdm (jdm@moz-me9tfn.cable.rogers.com) (Quit: )
[21:25:54] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[21:26:26] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:26:43] <aturon> acrichto: re: std::num, i want to punt on dealing with the internal deprecation right now
[21:26:53] <nmatsakis> reem: that fallout was intended, if unfortunate,
[21:26:56] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[21:26:59] <aturon> acrichto: there's a bit of design, and i don't want to gate the deprecation/stabilization on it
[21:27:11] <aturon> acrichto: did you have any other outstanding issues on the PR?
[21:27:12] <nmatsakis> reem: that was what https://github.com/rust-lang/rust/issues/18737#issuecomment-78450798 was talking about
[21:27:36] <reem> nmatsakis: I thought so. It's not a big deal since these APIs are very internal/unstable anyway.
[21:27:45] <reem> (from hyper's perspective, at least)
[21:27:50] <nmatsakis> reem: ok, cool -- hopefully we can make this more flexible in the future 
[21:28:24] <acrichto> aturon: the problem for me is that `Iterator for Range<T: Int>` isn't internal to me
[21:28:32] <acrichto> b/c it affects type iference apparently?
[21:28:48] <aturon> reem: your libraries are quickly becoming the go-to stress test for any changes to the trait system :)
[21:28:52] *** Quits: Jesin (Jesin@moz-i7sbhm.res.Lehigh.EDU) (Quit: Leaving)
[21:28:59] <aturon> acrichto: right, we will need to replace with a different trait
[21:29:08] <aturon> (if we want to keep the current behavior wrt inference)
[21:29:12] <aturon> but that's what i mean about design
[21:29:18] <acrichto> grr
[21:29:23] <acrichto> I don't really want a trait there :P
[21:29:23] <reem> :)
[21:29:29] <brson> i was realizing the other day that our unstable apis still have observable effects on stable rust in the form of resolution errors. unstable api's create a bunch of unspecified phantom error conditions in the stable release
[21:29:36] <brson> probably not a hazard though
[21:29:56] <acrichto> aturon: I think that's my only big outstanding issue though
[21:29:57] <aturon> acrichto: well, there are benefits besides inference
[21:30:18] <aturon> (in terms of downstream code being able to make blanket impls)
[21:30:34] <aturon> we could do something like the Step trait that nrc originally had
[21:30:36] <acrichto> brson: in the sense that you can accidentally import an unstable api?
[21:30:44] <aturon> or perhaps reintroduce Zero/One...
[21:31:00] <acrichto> aturon: hm, it does seem difficult now that we have 0 traits in std::num
[21:31:10] <aturon> brson: yes, similarly with docs. but i *think* this is mainly a presentation/diagnostics issue that we can improve over time
[21:31:14] <brson> acrichto: or get a conflict from an unstable method that happens to be imported
[21:31:19] <brson> by the prelude e.g.
[21:31:23] <aturon> acrichto: difficult in what sense?
[21:31:36] <aturon> acrichto: (the traits in question would likely live elsewhere)
[21:31:37] <acrichto> aturon: difficult to create a trait again for this sort of generics
[21:31:46] <acrichto> aturon: e.g. it really does want Int
[21:31:51] <aturon> i disagree
[21:31:52] <acrichto> or some trait which says "primitive integer types"
[21:31:53] <aturon> Int is overkill
[21:32:05] <acrichto> hm
[21:32:12] <acrichto> maybe One + Add/Sub would suffice
[21:32:26] <aturon> (which also helps AdditiveIterator)
[21:32:41] <acrichto> yeah Zero/One would help that
[21:32:48] <acrichto> although AdditiveIterator could just require T: Default
[21:32:52] <acrichto> T: Default + Add
[21:33:05] *** Joins: Jesin (Jesin@moz-i7sbhm.res.Lehigh.EDU)
[21:33:09] <steveklabnik> reem: if i have a Fn(i32) -> i32, and i want to dynamic dispatch rather than static, how do i declare a fn with that?
[21:33:19] <steveklabnik> &Fn makes me put & at the callsite too
[21:33:22] <steveklabnik> is that inherent?
[21:33:32] <reem> steveklabnik: What do you mean by & at the callsite?
[21:33:34] <aturon> acrichto: that's not a great solution in my book, you really want to know something about the relationship to addition (and in particular, you want a different default for Multiplicative)
[21:33:37] <steveklabnik> fn call_with_one(some_closure: &Fn(i32) -> i32) -> i32 {
[21:33:40] <steveklabnik> let answer = call_with_one(&|x| x + 2);
[21:33:45] <reem> Ye
[21:33:48] <reem> Yes*
[21:33:50] <reem> that's inherent
[21:33:55] <steveklabnik> figured, but wanted to be sure
[21:33:56] <aturon> acrichto: anyway, this is getting a bit in the weeds -- but that's precisely why i don't want to package in a solution to this problem with this PR
[21:34:23] <acrichto> aturon: well, right, I also don't want to have to deal with that, but that also has little to do with Range itself
[21:34:43] <acrichto> like are we willing to add RangeInt as a new trait?
[21:34:50] <acrichto> if we hit 1.0 and don't have any other trait?
[21:34:58] <acrichto> e.g. a trait for Range and only Range
[21:35:07] <aturon> no, at worst we can re-introduce Step
[21:35:23] <Gankro> I would kill Additive/Multiplicative iterator personally. There's a not-awful impl with `fold`, and external crates can support it.
[21:35:33] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[21:35:58] <reem> there is already at least one crate (itertools) providing more iterator stuff
[21:35:59] *** Joins: jdm (jdm@moz-4vu.06r.98.75.IP)
[21:36:01] <aturon> Gankro: yeah, that's an option (although .sum is very nice). if we go that route, there's less impetus for One/Zero
[21:36:19] <acrichto> aturon: I feel the same way as Gankro in that I don't feel the urge to stabilze .sum() at all
[21:36:23] <Gankro> I mean jesus at what point do we accept that sometimes programmers need to write code?
[21:36:23] * XMPPwocky proposes .sum as free function
[21:36:30] <XMPPwocky> if anything
[21:36:32] <acrichto> Gankro: I feel the same :)
[21:36:52] <aturon> ok, so let's take those traits off the table (maybe we should go ahead and deprecate)
[21:37:03] <aturon> that out of the way: what's the ideal solution for Range iteration?
[21:37:41] <acrichto> aturon: we could go back to specific impls for now
[21:37:45] <acrichto> and stomach the weird errors
[21:37:46] *** Quits: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com) (Quit: )
[21:37:50] <acrichto> although I forget where they cropped up
[21:38:12] <aturon> acrichto: i can try to dig it up
[21:38:49] <aturon> https://github.com/rust-lang/rust/pull/21806
[21:38:56] *** Quits: pczarn (piotr@moz-9un7t9.izacom.pl) (Ping timeout: 121 seconds)
[21:39:10] <acrichto> hm yeah that's bad
[21:40:05] <aturon> https://github.com/rust-lang/rust/issues/21672#issuecomment-72268318
[21:40:38] <aturon> (that's the key point of the current setup wrt to inference, but Int is much less general than you might want)
[21:41:14] <acrichto> aturon: we could add `struct One`
[21:41:14] *** Joins: rovar (rovar@moz-6iq.47m.88.38.IP)
[21:41:20] <acrichto> and then impl Add<One> for each primitive
[21:41:27] *** Parts: marsel (user@moz-a2q.epg.180.94.IP) ("ERC Version 5.3 (IRC client for Emacs)")
[21:41:33] <acrichto> probably not much better than `trait One` though
[21:41:53] *** Joins: marsel (user@moz-a2q.epg.180.94.IP)
[21:42:00] <aturon> seems worse to me :-/
[21:43:05] *** Joins: Rusky1 (russell@moz-2a17lj.slkc.qwest.net)
[21:43:10] *** Quits: Rusky (russell@moz-2a17lj.slkc.qwest.net) (Quit: Leaving.)
[21:44:07] <acrichto> aturon: we may jsut not be able to remove Int?
[21:44:13] *** Joins: swgillespie (swgillespie@moz-upj.3un.220.167.IP)
[21:44:15] <arrrrrrr1> cmr: ping
[21:44:20] <aturon> acrichto: we can add One, or Step
[21:44:22] <acrichto> it's existence does seem well justified
[21:44:33] <aturon> i disagree, it's much stronger than you need for this :)
[21:44:44] <acrichto> right, but this is one of many locations
[21:44:51] <acrichto> sure this one spot doesn't need Int, but Int is needed in quite a few places
[21:44:59] <aturon> not in public APIs
[21:45:03] <acrichto> we're not trying to enable more uses of Range
[21:45:08] <acrichto> even internally though, it's well justified
[21:45:10] <aturon> and i suspect that the majority of places don't need the full complement of functionality
[21:45:19] <acrichto> right
[21:45:27] <acrichto> but it's pretty common to want to operate over a generic primitive
[21:45:39] <acrichto> you don't want to expand the set of functionality, you just want to work over iNN
[21:45:44] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[21:47:06] <aturon> i disagree with this analysis :) i think most of these places are overconstrained
[21:47:19] <acrichto> but our goal is not to enable more types to be used with Range
[21:47:21] <aturon> for example, it makes sense to allow looping over character ranges
[21:47:34] <acrichto> hm, so maybe it is
[21:47:57] <aturon> i mean, in the long run we definitely want this kind of generic programming,
[21:48:10] <aturon> but the current traits were not really designed for that -- 
[21:48:20] <aturon> they were mainly designed to provide methods on primitives
[21:49:11] <acrichto> then it sounds like we should add Step back
[21:49:31] <aturon> that seems more palatable than One/Zero at the moment
[21:50:23] <aturon> acrichto: would you like me to include that in this PR, or a follow up?
[21:50:49] <acrichto> aturon: I'd prefer in this one
[21:50:53] <acrichto> (if ok)
[21:51:04] <cmr> arrrrrrr1: pong
[21:51:23] <aturon> acrichto: np
[21:51:26] <arrrrrrr1> cmr: rock solid license https://gist.github.com/anonymous/cba5808070623b968a45
[21:52:41] *** Quits: rovar (rovar@moz-6iq.47m.88.38.IP) (Ping timeout: 121 seconds)
[21:55:46] *** Quits: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com) (Connection closed)
[21:56:22] *** Joins: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com)
[21:56:28] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[21:56:55] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[22:01:12] <bstrie> what the heck is the lrs license and why does it use rust-specific language
[22:02:15] <arrrrrrr1> modification of the LGPL that works with rust code
[22:02:32] <arrrrrrr1> because LGPL is practically GPL when applied to rust code
[22:03:31] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[22:06:46] *** Joins: rovar (rovar@moz-6iq.47m.88.38.IP)
[22:07:01] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:08:15] <bstrie> the Lesser RuSt license
[22:08:34] <arrrrrrr1> almost
[22:09:04] <arrrrrrr1> the L actually stands for Linux because that's part of the name of a crate I'm working on
[22:09:11] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[22:09:26] <arrrrrrr1> and for this crate I want to use something like the LGPL but compatible with the rust compilation model
[22:10:18] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[22:11:54] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Ping timeout: 121 seconds)
[22:12:43] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:13:13] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:15:38] <bstrie> arrrrrrr1: what version of lgpl is it based on
[22:15:43] <arrrrrrr1> 2.1
[22:16:46] <bstrie> arrrrrrr1: is monomorphism the main problem it works around?
[22:17:53] <arrrrrrr1> bstrie: lgpl says that you have to provide object code of your program so that people can modify the library and link both together.
[22:18:23] <arrrrrrr1> ^ in the case of static linking
[22:18:27] <bstrie> did you just s/object code/rlib
[22:18:29] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Connection closed)
[22:18:46] <arrrrrrr1> bstrie: I've removed most of the LGPL2
[22:18:50] *** Joins: eerie (eerie@moz-nu5r7u.red.bezeqint.net)
[22:18:53] <bstrie> leaving only the .1
[22:19:02] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[22:19:10] <arrrrrrr1> bstrie: can you even create an executable from two rlibs alone?
[22:19:18] <bstrie> with hackery, maybe
[22:19:43] <bstrie> I'd be wary of advertising this license until an actual lawyer has reviewed it
[22:19:51] <bstrie> unless you are an actual lawyer
[22:20:45] <bstrie> the reason why I asked if monomorphization was the problem is because GNU already has a modified version of the LGPL that grants that exception for Ada http://en.wikipedia.org/wiki/GNAT_Modified_General_Public_License
[22:21:31] <bstrie> or wait, is that a modified version of the gpl... getting conflicting info
[22:21:42] <arrrrrrr1> LGPL is too strong anyway because it can't be used on ios
[22:22:03] <bstrie> I hate licenses
[22:22:25] <bstrie> also, computers
[22:22:52] *** Quits: eerie (eerie@moz-nu5r7u.red.bezeqint.net) (Ping timeout: 121 seconds)
[22:28:18] *** Quits: killercu_ (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:33:10] *** Joins: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com)
[22:35:52] *** japaric is now known as japaric|afk
[22:41:31] *** Quits: doener (doener@moz-929cn9.unity-media.net) (Connection closed)
[22:42:36] *** jdm is now known as crowbot
[22:42:42] *** crowbot is now known as jdm
[22:42:57] *** Joins: doener (doener@moz-929cn9.unity-media.net)
[22:46:47] *** Joins: jxv (jxv___@moz-pi22qa.ca.charter.com)
[22:48:32] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[22:56:32] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[22:58:57] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[23:00:35] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[23:01:04] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[23:02:45] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[23:02:54] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[23:09:18] *** Joins: mib_ayzchv (Mibbit@moz-juv.9o3.252.72.IP)
[23:09:59] *** Joins: chc4 (chc4@moz-mjph4c.ma.comcast.net)
[23:10:15] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[23:14:42] *** Quits: mib_ayzchv (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:18:20] *** Quits: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com) (Ping timeout: 121 seconds)
[23:29:31] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[23:29:46] *** Joins: dinfuehr (dinfuehr@moz-a95lrr.highway.telekom.at)
[23:30:46] *** Quits: waka (waka@moz-in9240.rev.numericable.fr) (Ping timeout: 121 seconds)
[23:32:51] *** Joins: waka (waka@moz-in9240.rev.numericable.fr)
[23:34:43] *** Quits: tjakubow (tom@moz-ag87jj.fios.verizon.net) (Quit: WeeChat 1.1.1)
[23:35:00] <bstrie> does `rustc --test` run doctests?
[23:35:49] <steveklabnik> don't think so bstrie 
[23:36:05] <steveklabnik> but maybe?
[23:36:11] <steveklabnik> i always use rustdoc --test
[23:36:33] <bstrie> steveklabnik: there's a user in #rust asking why his macros are failing in their doctests, do you know about that?
[23:36:57] <steveklabnik> i do not
[23:37:00] <bstrie> rustdoc --test does seem to fail on it
[23:37:07] <steveklabnik> brb
[23:39:50] *** Quits: canhtak (canhtak@moz-6t0.c9a.252.94.IP) (Ping timeout: 121 seconds)
[23:40:24] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[23:40:24] *** ChanServ sets mode: +o pcwalton
[23:40:44] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[23:43:32] *** Joins: larsberg (sid16141@moz-fnneme.uxbridge.irccloud.com)
[23:43:32] *** Joins: panitaliemom (Mibbit@moz-juv.9o3.252.72.IP)
[23:44:21] <bstrie> kmc: have you ever used doc comments on macros before? you're my go-to macro person
[23:44:23] *** Parts: Nekit1234007 (nekit@moz-2vpc3e.broadband.iskratelecom.ru) ()
[23:45:18] <bstrie> kmc: I ask because https://github.com/rust-lang/rust/blob/master/src/libstd/macros.rs#L40 in the stdlib works, but user-defined https://gist.github.com/insaneinside/0cacc9634cc3bbb936e1 does not
[23:45:31] *** Joins: zmack (zmack@moz-b26i0b.home.aster.pl)
[23:46:39] <sfackler> bstrie: you need to #[macro_use] extern crate foo; https://github.com/sfackler/rust-postgres-range/blob/master/src/lib.rs#L30-L31
[23:46:46] <sfackler> to import the macro
[23:48:31] <bstrie> sfackler: does the stdlib example only work because of the prelude?
[23:49:33] *** Quits: zmack (zmack@moz-b26i0b.home.aster.pl) (Ping timeout: 121 seconds)
[23:50:53] <sfackler> probably
[23:54:02] <bstrie> sfackler: when I try that it gives me "error: an `extern crate` loading macros must be at the crate root"
[23:54:20] <sfackler> bstrie: missing an explicit fn main() P{?
[23:54:40] <bstrie> sfackler: this is a library, does it really need that?
[23:54:48] <sfackler> bstrie: in the doctest
[23:54:54] <sfackler> it's compiled as a executable
[23:55:07] *** Joins: arrrrrrrrr (arrrrrrrrs@moz-uje2sd.dynamic.qsc.de)
[23:55:08] <bstrie> I figured it did the same thing as playbot where it wrapped it up for you
[23:55:09] <sfackler> and rustdoc will add a fn main wrapper around the contents of the block
[23:55:11] <sfackler> yes
[23:55:21] <sfackler> so if you have an extern crate it'll get shoved inside of the main function
[23:55:24] <sfackler> which isn't okay
[23:55:33] <sfackler> but if you have your own fn main rustdoc won't do that
[23:55:33] <bstrie> oh wait, so rustdoc only *doesn't* wrap it up if you omit the fm main
[23:55:44] <bstrie> okay. weird, but okay
[23:55:47] <sfackler> other way
[23:57:37] <bstrie> bah, now it's giving me "unexpected token: `<eof>`"
[23:57:53] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-4jf9qp.dynamic.qsc.de) (Ping timeout: 121 seconds)
[23:59:06] *** Joins: brson (brson@moz-prn.c9m.56.172.IP)
[23:59:06] *** ChanServ sets mode: +o brson
[23:59:09] <bstrie> sfackler: ^ ever seen that before?
