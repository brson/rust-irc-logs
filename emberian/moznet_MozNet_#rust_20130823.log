[00:00:52] <Eridius> why does `make docs` need to compile the libraries?
[00:01:20] <Eridius> nmatsakis: yeah, as I said, there were issues. Primarily stemming from the fact that it had to be compatible with C stuff
[00:01:32] <Eridius> and was conservative and had no knowledge about the layout of types
[00:01:43] <nmatsakis> Eridius: yes definitely (it did have knownledge of obj ctypes)
[00:02:02] <Eridius> ok let me rephrase, no knowledge about C types
[00:02:17] <Eridius> couldn't know if a block of memory was data, or had interior pointers to other things
[00:04:00] <strcat> pcwalton: it also considers integers/pointers to be equal
[00:04:39] <fn_apply0> &mut T and &mut [u8] are giving different sizes
[00:04:42] <pcwalton> yeah, that's exactly what we ant
[00:04:43] <pcwalton> want
[00:04:56] <pcwalton> in theory it is better to do this in the frontend
[00:05:02] <pcwalton> because we won't even generate the code
[00:05:03] <pcwalton> but meh
[00:05:15] <strcat> pcwalton: it's easier to hoist the effort onto someone else though ;p
[00:05:19] <pcwalton> this falls in the category of "let's go crazy with front end optimizations!"
[00:05:24] <pcwalton> which I do not want to really do
[00:05:30] <Eridius> fn_apply0: hmm?
[00:05:34] <strcat> http://llvm.org/docs/doxygen/html/MergeFunctions_8cpp_source.html it's not even as complicated as our stuff
[00:05:38] <pcwalton> right
[00:05:41] <pcwalton> that's the irony
[00:05:44] <strcat> since it's lower level
[00:05:55] <nmatsakis> lower level is definitely the "right" place to do it from a code complexity POV
[00:05:55] <pcwalton> *usually* doing things at the LLVM level is less complicated than doing it in the frontend
[00:06:04] <nmatsakis> since what we're trying to do in type_use is predict what trans will generate
[00:06:06] <pcwalton> the only reason to do things in the frontend is to gain cheap compiler performance
[00:06:20] <nmatsakis> actually
[00:06:22] <pcwalton> which is... ok and probably some part of it is unavoidable but I'd like to avoid it
[00:06:30] <nmatsakis> I wonder if the approach I wanted to do way back when WOULD make sense, tweaked a bit
[00:06:37] <nmatsakis> generate the code for the first instance,
[00:06:46] <nmatsakis> then walk the LLVM IR and record what aspects of the type were imp't
[00:06:54] <nmatsakis> then we can look for those aspects for future instances
[00:06:54] <pcwalton> stuff like LICM will be added to the frontend over my dead body ;)
[00:06:56] <nmatsakis> to avoid creating them
[00:07:04] <nmatsakis> pcwalton strcat: what do you think of that idea?
[00:07:16] <pcwalton> nmatsakis: I guess, I'd rather do mergefunc first though
[00:07:17] <nmatsakis> it's sort of a hybrid
[00:07:18] <pcwalton> just because
[00:07:23] <pcwalton> why do optimizations in the frontend
[00:07:39] <pcwalton> unless we have to
[00:07:42] <nmatsakis> I agree, I like leaning on LLVM
[00:07:49] <pcwalton> and it's not clear that mergefunc is not good enough to fix graydon's problem
[00:07:52] <strcat> I think mergefunc is viewed as the way forward for merging C++ templates with clang
[00:07:58] <nmatsakis> if running mergefunc isn't enough, though, this would let us avoid geneating the IR in the first place
[00:07:59] <strcat> afaik they investigated other ways
[00:08:08] <strcat> I don't know why it's not enabled by default yet
[00:08:09] <pcwalton> that's even more evidence
[00:08:10] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:08:30] <strcat> apparently their test suite (which they use to measure whether optimizations are worth it) doesn't benefit much
[00:08:38] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[00:09:06] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[00:09:08] * strcat wishes we had a way to append passes instead of just overriding
[00:09:09] *** Joins: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au)
[00:09:21] <nmatsakis> has anyone else seen the problem of â€˜llvm::sys::fsâ€™ has not been declared?
[00:09:29] <nmatsakis> when compiling LLVM?
[00:09:34] <nmatsakis> er, when compiling our wrapper around LLVM
[00:09:36] <graydon> nope
[00:09:38] <brson> nmatsakis: yes
[00:09:50] <brson> nmatsakis: I was accidentally using the old version of llvm though
[00:09:54] <acrichto> strcat: oh I mean to tell you that I rewrote our module passes to do what clang does and it didn't help codegen performance noticeably (didn't measure compile-time, though)
[00:09:55] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[00:10:05] <brson> nmatsakis: in my case i accidentally re-commited the old submodule during a rebase
[00:10:19] <strcat> acrichto: but it means we don't have to update it as much ;p
[00:10:37] <acrichto> strcat: true, I plan on still committing it. It also makes --passes append to the module passes instead of overwrite all of them
[00:10:49] <strcat> acrichto: yeah that makes passes actually usable
[00:10:56] <strcat> \o/
[00:11:06] <strcat> --passes mergefunc
[00:11:09] <strcat> is what I want to do right now ;p
[00:11:22] <strcat> but I'd really have to list the 50 existing ones first
[00:11:29] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:11:29] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146a3d129 to 14f858452: 02http://git.io/N3iJvQ
[00:11:29] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:11:30] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[00:11:30] <ghrust> 01[13rust01] 15bors pushed 26 new commits to 06auto: 02http://git.io/SJLZrA
[00:11:30] <ghrust> 13rust/06auto 14a901b16 15Jeff Olson: std: bootstrapping libuv-based fileio in newrt... open & close...
[00:11:30] <ghrust> 13rust/06auto 14dabbac1 15Jeff Olson: std: working tests for low-level libuv open, write and close operations
[00:11:31] <ghrust> 13rust/06auto 14c49c292 15Jeff Olson: std: add read and unlink to low-level FileDescriptor + end-to-end CRUD test
[00:11:33] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[00:11:51] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:12:19] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:12:20] <nmatsakis> brson: hmm, maybe I did the same
[00:12:33] <graydon> acrichto: which branch is that? mind if I grab it and land it? (--passes)
[00:12:52] <strcat> acrichto: also make sure to look at clang in svn
[00:12:54] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Ping timeout)
[00:13:08] <strcat> because I think we're supposed to have vectorize at -O2 and slp vectorize (non-aggressive) at -O3
[00:13:10] <acrichto> graydon: it's not really in a mergeable state, I haven't even pushed it to github yet
[00:13:33] <acrichto> graydon: I was still trying to measure what went wrong with the llvm upgrade, but I can clean up the pass refactoring tonight
[00:13:50] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[00:14:05] <acrichto> strcat: I think that the vectorization is still turned off by default in llvm trunk, but I'm thinking of adding a -Z option to enable it
[00:14:15] <strcat> acrichto: opt is different than clang though
[00:14:18] <acrichto> strcat: the pass manager builder thing doesn't take it as a pass, but rather as a parameter
[00:14:19] <Eridius> huh, our docs require node.js to build? wat
[00:14:29] *** Quits: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP) (Ping timeout)
[00:14:31] <tjc> that should really be in the FAQ
[00:14:40] <tjc> (Eridius's question, that is - it gets asked often enough :-)
[00:14:57] <acrichto> strcat: http://llvm.org/docs/doxygen/html/PassManagerBuilder_8cpp_source.html is what we're using and the constructor sets the default to some command line flags which I think are all false by default
[00:15:17] <strcat> acrichto: clang 3.3 already does vectorize at -O3
[00:15:18] <Eridius> tjc: was trying to figure out why the heck I could build stdlib docs, but not the tutorials, when I finally found the requirement for node.js. This seems weird. Surely there's another way to prepare docs for building
[00:15:33] <strcat> acrichto: and afaik things changed since then
[00:15:55] <acrichto> strcat: I'll look some more into it, yeah
[00:16:09] <acrichto> strcat: you'll also like the new `-Z print-llvm-passes` which will dump all llvm passes before they're run
[00:16:13] <strcat> acrichto: :D
[00:16:18] <tjc> Eridius: there's a JS script that prepares the docs; I think there's been talk about rewriting it but no one has had time
[00:16:20] <nmatsakis> brson: thanks I think that was it
[00:17:02] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[00:17:06] <strcat> acrichto: http://ix.io/6p0 clang 3.3, with -O3
[00:17:39] <strcat> just with -mllvm -debug-pass=Structure
[00:17:51] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[00:17:55] * strcat doesn't have an svn one to try though
[00:18:16] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:18:19] <acrichto> strcat: oh hmm... right now I'm hardcoding it to debug-pass=Arguments which doesn't print out the tree of things, but maybe I could add another option for that
[00:18:26] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[00:18:51] <strcat> structure is nice because I don't need tr ' ' '\n' to read it ;p
[00:19:15] <acrichto> probably wouldn't be too bad to default to that anyway
[00:19:29] <acrichto> you could just grep for "Pass Arguments" anyway
[00:20:37] <olsonjeffery> can anyone make sense of what happened here? http://buildbot.rust-lang.org/console?branch=auto&refresh=15
[00:20:55] <olsonjeffery> is it still running?
[00:20:57] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[00:21:11] <kmc> wonder if anyone can think of solutions to https://github.com/mozilla/servo/issues/762 besides the two i listed
[00:21:27] <kmc> or if anyone knows in particular how to tell if you're in the task cleanup phase
[00:21:27] <olsonjeffery> besides the mac build error..
[00:21:31] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:21:31] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143f8f28d to 14f858452: 02http://git.io/N3iJvQ
[00:21:31] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:21:31] <olsonjeffery> did that shut everything down?
[00:21:32] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[00:21:32] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/2MpmkQ
[00:21:32] <ghrust> 13rust/06auto 1448a6823 15Michael Sullivan: Don't ICE if an argument in a default method doesn't have a name. Closes #8417.
[00:21:32] <ghrust> 13rust/06auto 14451de33 15Michael Sullivan: Add `self` to the ast_map for provided methods. Closes #8010.
[00:21:32] <ghrust> 13rust/06auto 148a9cdda 15Michael Sullivan: Fix type parameter handling for static default methods. Closes #8654.
[00:21:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[00:22:15] <strcat> tjc: well part of it can be removed if pandoc is updated on the doc builder
[00:22:18] <strcat> the syntax highlighting
[00:22:26] <strcat> but it's probably a pain to update
[00:22:35] <strcat> since you'd have to build it with cabal, and it has 100 deps
[00:22:58] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[00:22:59] *** Quits: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP) (Quit: Textual IRC Client: www.textualapp.com)
[00:23:03] <sully> hey, what do we have for timer libraries?
[00:23:08] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[00:23:20] <sully> ah, found it
[00:23:23] <sully> maybe
[00:25:00] <strcat> 100 deps -> 36 haskell libraries + other external libs :s
[00:25:02] <strcat> not far off
[00:25:10] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[00:25:21] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[00:25:39] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[00:26:39] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[00:26:40] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[00:27:36] <olsonjeffery> can i get an r+ on https://github.com/mozilla/rust/pull/8655 ?
[00:27:42] <sully> haha, why do we still have md4 in our libraries
[00:27:46] <sully> do we still use it
[00:28:08] <sully> istr that pcwalton implemented after I suggested that maybe it would be faster to use a really bad hashing algorithm for crate ids?
[00:28:15] <sully> but I thought we didn't stick with that?
[00:29:11] <strcat> sully: go has it too ;p
[00:29:16] <strcat> http://golang.org/pkg/crypto/
[00:29:28] <strcat> oh it's in an external lib
[00:29:34] <strcat> unlike the truly useful ones
[00:30:11] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[00:30:21] <pcwalton> yeah, I don't think we stuck with it
[00:30:34] <sully> I think it didn't help, or something
[00:30:58] <pcwalton> yeah, I don't think it helped
[00:31:31] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:32:30] <pcwalton> whoa, during trans my stack is 835 frames deep
[00:32:34] *** Joins: Yurume_ (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:32:43] <strcat> pcwalton: glues!
[00:32:45] <strcat> ;[
[00:32:45] <pcwalton> yeah
[00:32:47] <pcwalton> it's generating glue
[00:32:54] <pcwalton> the way we generate glue is kind of silly
[00:32:59] <pcwalton> we should not be so eager
[00:33:11] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[00:33:13] *** Joins: jdm (jdm@97DF0582.DEAB171B.971E19F6.IP)
[00:33:57] <pcwalton> q
[00:34:08] * nmatsakis working on that -- well, not precisely that
[00:34:11] <ChrisMorgan> ... oh, Git, why do you not track renames *correctly*? "rename src/{libstd/rt/io/net/http.rs => test/run-pass/static-function-pointer.rs} (63%)"
[00:34:23] <strcat> ChrisMorgan: because it doesn't track files :)
[00:34:34] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[00:34:35] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:34:38] <ChrisMorgan> I know. One of the weird things of its design.
[00:34:58] <strcat> ChrisMorgan: the trick is to never move and edit a file in the same commit ;p
[00:35:04] <olsonjeffery> heh
[00:35:08] <ChrisMorgan> Someone should have tried building a version control system on top of Git.
[00:35:14] <maik> oh wow
[00:35:17] <strcat> with libgit2, it's basically impossible to figure out
[00:35:26] <strcat> unless you wanted to reimplement the fuzzing guessing
[00:35:34] <olsonjeffery> i sense some mercurial partisanship coming
[00:35:41] <maik> rusti: let msg = 5; let msg = ~"foo";
[00:35:43] -rusti- pastebinned 7 lines of output: http://ix.io/7v7
[00:35:48] <ChrisMorgan> olsonjeffery: really? :P
[00:35:59] <strcat> mercurial might have the same issue, I don't know ;p
[00:36:03] <maik> is the first msg = 5 not freed?
[00:36:17] <ChrisMorgan> Mercurial tracks renames, though it doesn't make it especially obvious in the UI mostly.
[00:36:17] <strcat> another side effect of this is that git can't version control empty dirs
[00:36:34] <ChrisMorgan> Nor can Mercurial. A pity, but I'll survive.
[00:36:45] <ChrisMorgan> After pulling I'm getting "modified:   src/llvm (new commits)". What should I do about that?
[00:36:56] <strcat> git submodule update
[00:37:02] <nmatsakis> graydon: ok, I'm partway through the idea of mine, and I think it will help -- it won't collapse all walks tho, since we still need to refactor some of them to store more state into the visitor objcet and not the context argument
[00:37:09] <ChrisMorgan> Or ./configure will fix it, I think?
[00:37:18] <strcat> ChrisMorgan: maybe, but I do it myself or I accidentally commit it
[00:37:20] <strcat> ;p
[00:37:57] <ChrisMorgan> strcat: but aren't you using that wonderful thing called the index? (Or is it the staging area? Or the cache? Or something else?) It would stop you from doing that sort of thing!
[00:38:05] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:38:17] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[00:38:18] <strcat> pre-commit hooks stop me
[00:38:21] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:38:35] <strcat> but it's so annoying
[00:38:44] <strcat> I change the template, and then have to change every single git clone I have
[00:38:59] <strcat> if it happens a few more times I'll script it ;p
[00:39:30] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[00:40:12] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[00:40:45] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[00:40:59] <Eridius> what's the current recommendation for doing HTTP queries from rust?
[00:41:05] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:41:49] *** Quits: fn_apply0 (fn_apply0@moz-78F0587F.ca.astound.net) (Quit: Leaving)
[00:41:54] <ChrisMorgan> Eridius: you could try out https://github.com/chris-morgan/rust-http
[00:41:57] <pcwalton> rust-http
[00:42:02] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[00:42:22] <Eridius> thanks
[00:42:58] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[00:43:18] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[00:44:05] <pcwalton> lazy method reading is whack-a-mole
[00:44:18] <pcwalton> have to find all the places where trans is implicitly relying on the coherence tables being filled out for all methods
[00:44:37] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[00:44:45] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[00:46:18] *** Quits: maik (maik___@moz-BEACDBF.dip0.t-ipconnect.de) (Ping timeout)
[00:47:23] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[00:48:49] <nmatsakis> graydon: ok, how can I measure the amount of reduction? :)
[00:48:53] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:49:20] <graydon> compile before and after, count the symbols
[00:49:21] *** Quits: heftig (heftig@moz-EA55FCAD.dip0.t-ipconnect.de) (Ping timeout)
[00:49:38] <graydon> objdump -t foo.so | wc -l
[00:49:38] <Eridius> ChrisMorgan: rust-http doesn't appear to be rustpkg-compatible :/
[00:49:40] <graydon> is not a bad proxy
[00:50:03] <ChrisMorgan> Eridius: that's probably true; I haven't touched rustpkg. Tell me what needs fixing, or fix it and I'll accept a patch!
[00:50:07] <pcwalton> I have a perl script called the bloat-o-meter
[00:50:11] <graydon> or objdump -h foo.so | grep 'text\|data'
[00:50:14] <pcwalton> which is probably very mac-specific
[00:50:18] <Eridius> ChrisMorgan: I've never used it before either, but your requirement of running `make` is problematic.
[00:50:24] <graydon> there are a bunch of things you can check. even just binary size at this point shows it.
[00:50:49] <ChrisMorgan> Eridius: that was just a convenience. I'm quite open to changing it.
[00:51:00] <ChrisMorgan> How would you like it done?
[00:51:05] <Eridius> ChrisMorgan: looks like rustpkg supports a `pkg.rs` file at the root that can be used to customize the build, since you apparently need to generate something
[00:51:07] <nmatsakis> graydon: well, I hit a segfault compiling :)
[00:51:11] <Eridius> but again, I've never used rustpkg
[00:51:17] <nmatsakis> graydon: I guess this is a bit of  a stress test for &mut objects :)
[00:51:17] <graydon> nmatsakis: hrmph :(
[00:51:25] <graydon> I guess so, yeah!
[00:51:31] <nmatsakis> I guess that's good ;)
[00:51:39] <nmatsakis> though not the result I was hoping for
[00:51:41] <strcat> graydon: https://github.com/mozilla/rust/pull/8695 r?
[00:51:43] <ChrisMorgan> Yeah, I do at present generate some code. Could alternatively include that in the repository so that one could just compile it directly.
[00:52:27] *** Joins: heftig (heftig@moz-5E205539.dip0.t-ipconnect.de)
[00:53:25] <ChrisMorgan> Eridius: any ideas on how it should be improved?
[00:53:28] <graydon> strcat: yeah, we need them to walk the stack during gc :(
[00:53:46] <graydon> strcat: I mean, when we're on our own stacks, not as much (we can just conservatively scan the whole segment)
[00:53:57] <strcat> graydon: can you use libunwind instead?
[00:53:59] <graydon> strcat: but if we're going to pass through C callbacks..
[00:54:00] <Eridius> ChrisMorgan: if you want to preserve generation, I guess you'd need to look into how pkg.rs is supposed to work. Otherwise, if you just checked in the generated code, then it'd probably work as-is
[00:54:05] <graydon> strcat: maybe.
[00:54:12] <strcat> graydon: afaik we need the dwarf info working or debugging won't work
[00:54:21] <strcat> so it must at least partially work already
[00:54:26] <strcat> + regular unwinding
[00:54:29] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[00:55:02] <graydon> strcat: dwarf for debugging is independent from the stuff used for unwinding
[00:55:07] <strcat> ah
[00:55:11] <graydon> it's similar format, different tables
[00:55:18] <graydon> we do emit eh tables for unwinding
[00:55:26] <Eridius> hrm, rustpkg doesn't seem to support sub-paths into a repo, e.g. installing github.com/chris-morgan/rust-http/src/libhttp (Go supports this)
[00:55:33] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[00:55:35] <Eridius> ChrisMorgan: the above issue ^ suggests that rustpkg also needs changes
[00:55:52] <Eridius> asking rustpkg to install the root URL to rust-http actually produces libhttp in the build products folder, but it doesn't finish installation
[00:55:54] <graydon> (which are called, confusingly, dw2 unwinding -- "dwarf 2 style" -- but have extra stuff and are located in not-normal places for debuginfo)
[00:55:56] <tjc> Eridius: there's an open issue for that
[00:56:01] <Eridius> ok
[00:56:04] *** Joins: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com)
[00:56:05] * ChrisMorgan actually modelled his structure on a little bit of rustpkg documentation that he read, without actually trying it...
[00:56:10] <tjc> https://github.com/mozilla/rust/issues/6408
[00:56:20] <Eridius> ChrisMorgan: heh, I think you reproduced the workspace structure inside of your repo
[00:57:05] <ChrisMorgan> At present it's just libhttp, but it could in the future be split into separate libraries for client and server and common. Not sure.
[00:57:49] <ChrisMorgan> I'm just about to have to go for the next few hours, but please do submit a suitable PR and I'll take it.
[00:58:03] <Eridius> ChrisMorgan: due to the rustpkg issue #6408 it looks like rust-http can't use that yet
[00:58:11] <Eridius> at least, not without hoisting libhttp up to the root of the repo
[00:58:19] <Eridius> so I guess I'll just abandon rustpkg for now
[00:58:48] <ChrisMorgan> Any restructuring is fair game.
[00:59:10] <Eridius> ChrisMorgan: would conflict with your suggestion to split it into separate client/server libraries though (not sure if that's a good idea though)
[00:59:29] <ChrisMorgan> Eridius: that's much longer term. No need to worry about that happening any time soon.
[00:59:42] <Eridius> ok then I guess I'll see what's required to make it rustpkg-compatible
[00:59:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:59:56] <ChrisMorgan> Thanks :-)
[01:00:15] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[01:00:28] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[01:00:29] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Connection reset by peer)
[01:00:32] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[01:00:41] * pcwalton predicts that the outcome of this performance work is that methods will be unstable for a month or so
[01:01:16] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[01:01:40] <erickt1> graydon: ping
[01:02:06] <graydon> erickt1: pong
[01:02:41] <erickt1> graydon: just in case you're curious, I think this is the level of transformation we need to support generators: https://gist.github.com/erickt/6314495
[01:03:13] <erickt1> I *think* we could to this in libsyntax as we did with for loops
[01:03:42] <Eridius> I thought `rustpkg build` was supposed to build the current dir when given no arg? It's just spitting out the help message
[01:03:52] <strcat> erickt1: for loops result in really weird errors though
[01:04:11] <tjc> Eridius: if the current dir has a src/ subdirectory, yes
[01:04:36] <Eridius> tjc: it actually does, but I thought the src/ subdir was the workspace, and the individual packages aren't expected to have a src/ subdir?
[01:05:05] <tjc> Eridius: No, the directory that has a src/ subdir is the workspace
[01:05:07] <graydon> erickt1: that _looks_ like it doesn't involve any new control flow, is that correct?
[01:05:20] <Eridius> tjc: right, and I'm sitting in ~/.rust/src/github.com/chris-morgan/rust-http/
[01:05:24] <tjc> see https://github.com/mozilla/rust/blob/master/doc/rustpkg.md
[01:05:45] <tjc> Eridius: Oh, I see. The way it works right now is that you can `rustpkg build` if you're in ~/.rust, in your particular example
[01:05:54] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[01:06:01] <Eridius> if I'm in ~/.rust directly, `rustpkg build` wouldn't know what to build
[01:06:20] <Eridius> rustpkg isn't even given any sort of error. I get the feeling that this was just never implemented
[01:06:22] <tjc> Sorry, yes, you're right
[01:06:25] <tjc> end of the day
[01:06:52] <erickt1> strcat: yeah, errors could be potentially pretty ugly
[01:06:55] <tjc> Eridius: I'll try checking out your code tomorrow and see what happens. It's entirely possible something in rustpkg doesn't work as intended in this particular case
[01:07:08] <Eridius> ok it is implemented, but maybe `in_workspace()` is just broken?
[01:07:13] <strcat> rusti: let mut xs = [1, 2, 3]; xs.iter().reverse_(); xs
[01:07:15] -rusti- pastebinned 26 lines of output: http://ix.io/7vb
[01:07:24] <strcat> rusti: let mut xs = [1, 2, 3]; xs.mut_iter().reverse_(); xs
[01:07:25] -rusti- [3, 2, 1]
[01:07:40] <tjc> Eridius: actually, I think I know exactly what's wrong; it probably assumes the package ID has only one component
[01:07:43] <erickt1> graydon: I *think* it doesn't need to have any new control flow constructs
[01:07:43] <strcat> rusti: let mut xs = [1, 2, 3]; let mut ys = [4, 5, 6]; xs.mut_iter().chain(ys.mut_iter()).reverse_(); xs
[01:07:44] -rusti- [6, 5, 4]
[01:07:46] <tjc> so it woudl work to build foo if you were in src/foo
[01:07:50] <strcat> rusti: let mut xs = [1, 2, 3]; let mut ys = [4, 5, 6]; xs.mut_iter().chain(ys.mut_iter()).reverse_(); (ys, xs)
[01:07:50] -rusti- ([3, 2, 1], [6, 5, 4])
[01:07:51] <tjc> Eridius: I'll look at that/fix it tomorrow
[01:07:56] *** Joins: garthk (garth@moz-B118B14A.static.internode.on.net)
[01:08:00] <Eridius> tjc: heh. I would imagine github.com/foo/bar is going to be a very common thing
[01:08:13] <garthk> G'day, fellas.
[01:08:23] <erickt1> graydon: I haven't yet worked out an example for references and moving local variables though
[01:08:26] <tjc> Eridius: totally, it reflects a lack of testing rather than lack of desire to support it :-)
[01:08:37] <Eridius> tjc: hah yeah, it just pops the last path component off, then checks if the remaining path ends in a "src" dir
[01:08:42] <Eridius> doesn't even look to see if this is inside a workspace
[01:08:59] <Eridius> I would have instead expected it to iterate over all workspace paths, and check if any of them is a prefix to the CWD
[01:09:29] <Eridius> cwd_to_workspace() also makes the same assumption
[01:09:30] <garthk> Quick feasibility check: I'm thinking of using Rust to manage RapidXML so I can wade through ~1TB of XML faster than I'm managing right now in a variety of managed languages. (String marshalling is killing me.) What's coming up re changes to iterators and hooking up to C++?
[01:10:06] <strcat> garthk: a rust iterator is equivalent to a (start, end) iterator pair in C++
[01:10:11] <erickt1> garthk: we only bind to C, not C++
[01:10:17] <strcat> if they expose an iterator API, it's trivial to wrap
[01:10:27] <strcat> erickt1: well you can still go through C as an intermediate glue
[01:10:35] <erickt1> garthk: so you'd have to wrap a c++ api in c in order to expose it to rust
[01:10:41] <erickt1> what strcat said :)
[01:11:03] <strcat> need MutableRandomAccess iterator
[01:11:05] <garthk> Aah, nuts. More complexity. :/
[01:11:07] * strcat wants chained sorts
[01:11:38] *** Joins: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP)
[01:12:13] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[01:12:17] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[01:12:41] <engla> all I want is a reversible version of .enumerate() :-)
[01:12:59] *** Quits: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Quit: Leaving.)
[01:13:38] <erickt1> strcat: do you know if `for x in iter { â€¦ }` get translated into `loop { match iter.next() { None => break; Some(x) => { â€¦ } } }`?
[01:13:55] <strcat> erickt1: not quite, it has to borrow iter to a temporary
[01:13:57] <erickt1> strcat: I think you mentioned a &mut in the translation somewhere
[01:14:01] <strcat> because iter could be an rvalue, not an lvalue
[01:14:15] <strcat> it really should be in librustc so it can distinguish them and not freeze lvalues
[01:14:23] <erickt1> ah, so `let tmp = &mut iter; loop { match tmp { â€¦ }`?
[01:14:33] <strcat> yeah, match tmp.next()
[01:14:40] <strcat> so the iterator is frozen in the loop body
[01:14:52] <strcat> hm
[01:15:09] <strcat> anyway don't think there's a pure syntax workaround
[01:15:18] <strcat> if you take it by-value, it will move out of the lvalue
[01:15:48] <strcat> although you could probably just do &mut explicitly but... it's not as simple as it could be
[01:17:14] <Seldaek> 4K req/s on nginx static files with a 3â‚¬/mo. server, we live in the future
[01:18:38] <erickt1> strcat: another reason why for loops should be moved into librustc. You don't need to implement Iterator to use it
[01:19:07] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[01:19:07] <strcat> erickt1: yeah but it could technically fix that with a hack like adding a call to a lib fn
[01:19:14] <strcat> the lvalue thing can't be worked around
[01:19:16] <engla> any duck typing is a bug, not a feature I think
[01:21:12] <nmatsakis> does anyone remember what the trick is to disable type-use?
[01:21:26] <nmatsakis> I am wondering if the problem I'm seeing is in fact a bug in type-use...
[01:21:31] <nmatsakis> ...which would be sort of ironic.
[01:21:52] <strcat> nmatsakis: no-monomorphic-collapse
[01:21:53] <strcat> -Z
[01:21:57] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:22:06] <nmatsakis> strcat: thanks
[01:22:12] <strcat> it's broken on generic destructors for one thing
[01:22:25] <strcat> merges them all :s
[01:22:43] <nmatsakis> I guess I need to put that in the makefile somehow
[01:24:03] <brson> RUSTFLAGS= should work
[01:25:38] <nmatsakis> brson: yes I found that, thanks
[01:26:20] <Eridius> hrm, the path APIs are a bit.. off. e.g. .push() doesn't modify the receiver, it returns a brand new clone and modifies that
[01:26:42] <strcat> Path is broken anyway ;p
[01:26:46] <Eridius> :w
[01:27:00] <strcat> it uses ~str so it can't deal with all paths
[01:27:04] <Eridius> yeah
[01:27:20] <brson> I also had some problems with Path today. Creating one seems to require GenericPath::from_str(), which is a little awkward
[01:27:26] <aatch> rusti: -413185216u
[01:27:27] -rusti- 18446744073296366400
[01:27:30] <brson> I expected Path::new()
[01:27:36] <strcat> aatch: wat
[01:27:43] <brson> or at least FromStr::from_str()
[01:27:45] <Eridius> brson: it gets worse. The construct for a PosixPath is called PosixPath() ;)
[01:27:55] <Eridius> *constructor
[01:27:57] <brson> Eridius: oh, still?
[01:28:02] <Eridius> yeah
[01:28:12] <brson> can't remember the reason for that. I tried to fix it once
[01:28:24] <aatch> strcat, sorry, needed to know what it was as an unsigned integer and this was the easiest way I could think of.
[01:28:25] <Eridius> if that got changed to PosixPath::new() and WindowsPath::new() then you'd actually just magically get Path::new() ;)
[01:28:50] <strcat> aatch: oh I missed the 'u', I thought it was an awful bug.
[01:28:58] <Eridius> brson: although right now you can actually just use Path()
[01:29:05] <brson> ah right
[01:29:07] <aatch> I found some terrible code (elsewhere) that doesn't check return values and instead just throws them at strdup.
[01:29:08] <benh> would you magically get it?
[01:29:09] <brson> Path(~"foo")
[01:29:15] <Eridius> benh: yes. MAGICALLY.
[01:29:17] <Seldaek> aatch: you can query stuff to rusti as well btw if you aren't trying to make a point here :)
[01:29:17] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[01:29:20] <brson> because path reexports the platform path type as Path?
[01:29:23] <Eridius> yeah
[01:29:36] <Eridius> #[cfg(windows)]pub use Path = WindowsPath; etc
[01:29:47] <benh> Ah
[01:29:54] <strcat> it should be a typedef
[01:29:56] <cmr> ChrisMorgan, ping
[01:29:56] <strcat> that's just weird
[01:30:01] <benh> I vaguely remembered that typedefs don't keep static methods
[01:30:01] <ChrisMorgan> cmr: pong
[01:30:08] <Eridius> strcat: it should? The whole point is to just use the right path type depending on the platform you're compiling for
[01:30:11] <aatch> Seldaek, I know, but I also knew that I'd get the right answer immediately. Unlike people trying to do things that don't work over and over.
[01:30:19] <strcat> Eridius: thus a typedef, per-platform
[01:30:21] <Eridius> strcat: using a typedef would require implementing GenericPath on that typedef to just call through to the "real" impl
[01:30:30] <strcat> why?
[01:30:41] <Seldaek> aatch: true it's not the most spammy rusti usage ever
[01:30:55] <Eridius> strcat: oh sorry, I was thinking of the wrong language construct. I was thinking of a newtype
[01:31:12] <cmr> ChrisMorgan, I have a simple web thing that needs reimplementing. Is your http stuff ready for simple CRUD? Need a guinea pig?
[01:31:31] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:31:31] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2MpmkQ
[01:31:31] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:32:24] <ChrisMorgan> cmr: GET is fine, for requests with a body (e.g. POST) you'll need to decode the request yourself.
[01:33:03] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[01:33:20] <cmr> ChrisMorgan, decoding the entire request or just the body?
[01:33:27] <ChrisMorgan> The body.
[01:33:54] <cmr> ok that's fine
[01:34:01] <ChrisMorgan> That is, read and decode. Start by assuming you can read request.headers.content_length bytes.
[01:34:07] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[01:34:31] <strcat> as long as they aren't multipart forms *shudder*
[01:35:16] <SingingBoyo> I really don't understand where lint allow/deny should go.
[01:35:18] <Eridius> whoa I think PosixPath::get_relative_to() is broken
[01:35:21] <dcrewi> is there some blog post about using HashMaps with str keys?
[01:35:34] <cmr> dcrewi, no, why would there be?
[01:35:50] <dcrewi> because that is an extremely useful operation and I am having trouble fighting the compiler
[01:36:01] <SingingBoyo> i.e. https://gist.github.com/singingboyo/6314669 blows up at line 15, but just warns for everything else...
[01:36:19] <Eridius> and it has tests enforcing the broken behavior. wat
[01:36:24] <cmr> rusti: let mut h = HashMap::new(); h.insert(~"foo", 124); h.find(~"foo").unwrap()
[01:36:27] -rusti- pastebinned 11 lines of output: http://ix.io/7vc
[01:36:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:36:30] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/1MMV3w
[01:36:30] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:36:31] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:36:32] <ghrust> 01[13rust01] 15bors pushed 27 new commits to 06auto: 02http://git.io/_Ts5IA
[01:36:32] <ghrust> 13rust/06auto 14a901b16 15Jeff Olson: std: bootstrapping libuv-based fileio in newrt... open & close...
[01:36:32] <ghrust> 13rust/06auto 14dabbac1 15Jeff Olson: std: working tests for low-level libuv open, write and close operations
[01:36:32] <ghrust> 13rust/06auto 14c49c292 15Jeff Olson: std: add read and unlink to low-level FileDescriptor + end-to-end CRUD test
[01:36:33] <cmr> rusti: let mut h = HashMap::new(); h.insert(~"foo", 124); printfln!(h.find(~"foo").unwrap());
[01:36:34] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:36:35] -rusti- pastebinned 11 lines of output: http://ix.io/7vd
[01:36:45] <cmr> Ugh why isn't HashMap in the prelude yet.
[01:36:53] <cmr> rusti: use std::hashmap::HashMap; let mut h = HashMap::new(); h.insert(~"foo", 124); printfln!(h.find(~"foo").unwrap());
[01:36:55] -rusti- pastebinned 9 lines of output: http://ix.io/7ve
[01:37:02] <cmr> ah yes
[01:37:09] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[01:37:13] <strcat> find takes by-ref
[01:37:50] <erickt1> strcat / graydon: here's a generator calling an iterator that returns references: https://gist.github.com/erickt/6314670. I'm starting to play with doing nasty things with uninit that is probably wrong
[01:37:53] <strcat> rusti: use std::hashmap::HashMap; let mut h = HashMap::new(); h.insert(5, 2); printfln!("%?", h.find(&5))
[01:37:54] -rusti- Some(&2)
[01:37:54] -rusti- ()
[01:37:55] <SingingBoyo> dcrewi: you end up with a lot of key.to_owned() and &key.  It's slightly awkward to use, really.
[01:38:03] <ChrisMorgan> cmr: in case I didn't make it clear, I'd *love* to have you using rust-http.
[01:38:20] <erickt1> also, I'm not sure if I could derive the right types in libsyntax
[01:40:35] <brson> ChrisMorgan: I have spent a bit more time today trying to integrate rust-http into servo. still preoccupied with other things but making progress. currently upgrading servo's rust to one that's compatible
[01:40:39] <dcrewi> SingingBoyo: does key.to_owned() always create a copy, or is that optimized out?
[01:40:54] <SingingBoyo> https://gist.github.com/singingboyo/6314669 blows up at line 15, but just warns for everything else...  is this expected?
[01:41:25] <SingingBoyo> I don't understand setting lint levels via code at all, apparently :/
[01:41:39] <Eridius> you don't necessarily need .to_owned() everywhere
[01:41:53] <SingingBoyo> dcrewi: it always copies.
[01:42:15] <SingingBoyo> dcrewi: you don't need it everywhere, but if you're using the string after you do
[01:42:15] <dcrewi> Eridius: well that is the solution I also came to, independently
[01:42:20] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[01:42:29] <dcrewi> OH
[01:43:01] <SingingBoyo> dcrewi: or if you have an &str instead of a ~str
[01:43:03] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[01:43:27] <dcrewi> I basically want to split the key at an index and use the two parts separately
[01:44:02] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[01:46:06] *** Joins: victorporof (victorporo@F2782203.A485B230.9B1E38F4.IP)
[01:48:48] <samx> how do i make a for loop with descending indexes. that is, looking for something like:  for i in range(10, 0) { ? }
[01:48:53] <bjz_> rusti: struct A { a: int } impl A { fn delete(self) {} } let a = A { a: 1 }; a.delete(); a
[01:48:54] -rusti- {a: 1}
[01:49:05] *** Quits: rovar (rovar@moz-203658CB.nycmny.fios.verizon.net) (Connection reset by peer)
[01:49:07] <engla> samx: range(0, 10).invert()  works
[01:49:14] <bjz_> why does `delete` not move?
[01:49:19] <samx> engla: thx
[01:49:19] <engla> rusti: range(0, 10).invert().to_owned_vec()
[01:49:20] -rusti- ~[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
[01:49:34] <strcat> bjz_: it's not a type that moves
[01:49:40] <strcat> it has no destructor or &mut
[01:49:47] <bjz_> rusti: struct A { a: int } impl A { fn delete(_: A) {} } let a = A { a: 1 }; A::delete(a); a
[01:49:48] -rusti- {a: 1}
[01:50:12] <strcat> bjz_: by-value is a shallow copy, it's only a move of ownership if the type has a destructor
[01:50:19] <strcat> move == shallow copy
[01:50:23] <bjz_> rusti: struct A { a: int } impl A { fn delete(self) {} } impl Drop for A { fn drop(&self) {} } let a = A { a: 1 }; a.delete(); a
[01:50:24] <strcat> except stealing ownership
[01:50:25] -rusti- pastebinned 8 lines of output: http://ix.io/7vi
[01:50:40] <bjz_> ah
[01:52:42] <erickt1> do we have an unsafe intrinsic that moves a value from one variable to another, but leaves behind an uninitialized variable instead of consuming it?
[01:52:45] <bjz_> is there a #[deriving(Drop)]?
[01:53:20] <nmatsakis> bjz_: no.
[01:53:24] <nmatsakis> not sure what it would do...
[01:53:49] <nmatsakis> bjz_: however, we will automatically generate code to free all the components of a data structure...
[01:53:56] <bjz_> nmatsakis: heh, empty Drop
[01:54:56] <bjz_> rusti: struct A { a: int } impl Drop for A { fn drop(&self) {} } let a = A { a: 1 }; a.drop(); a
[01:54:57] -rusti- <anon>:5:87: 5:96 error: explicit call to destructor
[01:54:57] -rusti- <anon>:5          struct A { a: int } impl Drop for A { fn drop(&self) {} } let a = A { a: 1 }; a.drop(); a
[01:54:57] -rusti-                                                                                                 ^~~~~~~~~
[01:54:57] -rusti- error: aborting due to previous error
[01:54:58] -rusti- application terminated with error code 101
[02:00:09] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:01:19] *** Joins: int3_ (int3_@moz-BE33DA21.fw1.sfo1.mozilla.net)
[02:01:27] <SingingBoyo> why does building the docs give me an almost completely empty doc/rust.html?
[02:01:49] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[02:02:01] <bjz_> SingingBoyo: do you have pandoc?
[02:02:05] <engla> bjz_: if you want an empty drop you can include util::NonCopyable in the struct
[02:02:08] <strcat> and node.js
[02:02:41] <SingingBoyo> I think so.  definitely pandoc
[02:02:43] *** Joins: maik (maik___@moz-BEACDBF.dip0.t-ipconnect.de)
[02:02:52] <SingingBoyo> pretty sure I have node.js
[02:03:35] <SingingBoyo> all I get is the rust 0.8-pre icon in the bottom right corner
[02:03:44] <bjz_> rusti: std::sys::size_of::<std::util::NonCopyable>()
[02:03:45] -rusti- 0
[02:03:51] <bjz_> ooh
[02:03:56] *** Quits: int3_ (int3_@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[02:03:57] <bjz_> interesting
[02:04:18] <strcat> bjz_: it uses #[unsafe_no_drop_flag] - which omits the drop flag + zeroes the *whole* struct on drop (but it's 0 size so there's no zeroing)
[02:04:26] <strcat> so it's a perfect little non-copyable tag ;p
[02:04:39] <Eridius> hrm, there seems to be no obvious way to remove N elements from the front of a vector :/
[02:04:39] <bjz_> :)
[02:04:43] <strcat> anyway unsafe_no_drop_flag was really for Rc/RcMut but that turned out to work too
[02:05:00] <SingingBoyo> Eridius: tailn(int)?
[02:05:22] <Eridius> SingingBoyo: oh heh, that does achieve what I want, though with the opposite argument
[02:07:11] <Eridius> actually that doesn't do what I want. That's a slice operation
[02:07:15] <Eridius> I need to modify an owned vector
[02:08:03] <Eridius> the problem is this is a component of a struct. So I have to swap a ~[] in, because otherwise I have a partially-moved value (as you can't say `foo.x = foo.x.something_that_consumes_self`)
[02:08:31] <samx> just tried the range(1, 5).invert(), but getting: failed to find an implementation of trait std::iterator::DoubleEndedIterator<<V1030>> for std::iterator::Range<uint>
[02:08:43] <Eridius> samx: how old is your rust?
[02:08:57] <samx> built from master maybe a week ago
[02:09:13] *** Quits: graydon (graydon@moz-F14EE0DB.cable.teksavvy.com) (Ping timeout)
[02:10:03] <Eridius> samx: DoubleEndedIterator was implemented on Range on august 8th
[02:10:06] *** Joins: themgt (themgt@moz-FEBF730B.cm.vtr.net)
[02:10:15] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[02:10:17] *** Quits: themgt (themgt@moz-FEBF730B.cm.vtr.net) (Quit: Pogoapp - http://www.pogoapp.com)
[02:10:44] *** Joins: diverse (Mibbit@moz-601F0275.static.mtpk.ca.charter.com)
[02:10:45] *** Quits: maik (maik___@moz-BEACDBF.dip0.t-ipconnect.de) (Ping timeout)
[02:10:58] <samx> eridhus: ok, just looked at the timestamp.. mine is from Aug 4, so I'll just build a newer version. thanks :)
[02:13:54] <strcat> rusti: range(0, 10).to_owned_vec()
[02:13:55] -rusti- ~[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[02:14:01] <strcat> rusti: range(0, 10).invert().to_owned_vec()
[02:14:01] -rusti- ~[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
[02:15:35] <diverse> can someone help me with this problem: http://pastebin.com/emTQ6C1L
[02:16:53] <Eridius> diverse: hp doesn't exist in the trait
[02:17:10] <klutzy> anyone built rust on windows recently? specifically after jemalloc arrives on source tree.
[02:17:46] <adridu59> diverse: yup your monster object has no attribute hp
[02:18:08] <adridu59> diverse: I think you mixed up monster and bird
[02:18:28] <adridu59> dunno what's a trait
[02:19:30] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[02:23:32] <diverse> What I want is some way I can use the attack method so it can affect another object's hp associated with the monster trait. Or am I going in the wrong direction with traits?
[02:24:44] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:25:51] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[02:26:09] <adridu59> you should use Birds.hp instead of monster.hp, that's all I have to say
[02:26:19] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[02:28:29] <Eridius> diverse: you need to add methods to the trait to get/set hp
[02:30:32] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:30:36] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[02:30:44] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[02:31:02] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[02:31:09] <erickt1> strcat: ugh, I don't think we can handle moves in a straight desugar pass
[02:31:31] <erickt1> strcat: for generators
[02:32:10] <diverse> Eridius: that sounds like a good idea, I need to get used to doing get/set methods again.
[02:36:48] <Eridius> hrm, rustpkg thinks that rust-http's library should be called librust-http
[02:37:05] <Eridius> which is why, once I've generated the source, I can biuld with rustpkg but still can't install
[02:37:24] <jack> yes. you need ot name it http
[02:37:31] <jack> rustpkg currently ignroes link name attribute
[02:37:51] *** Quits: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:37:59] <Eridius> yeah... rustpkg needs to be able to handle this case. I imagine rust-foo is going to be a common naming scheme for github repos
[02:38:13] <jack> you can't do it that way
[02:38:20] <jack> how will it find the package?
[02:38:32] <jack> if it's extern mod http, then the pkgid is http
[02:38:38] <olsonjeffery> \o/
[02:38:46] <Eridius> wasn't there a proposed `extern mod http = "github.com/chris-morgan/rust-http"` ?
[02:38:50] <jack> so it will look for a package http. if the package is called rust-http, it won't find the right thing.
[02:39:20] <jack> i'm not sure if that survived. it will be in the bug tracker i think.
[02:39:20] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Quit: Leaving)
[02:39:39] <Eridius> jack: it's just not going to be tenable to require github repos to be named e.g. "http"
[02:39:42] <Eridius> that's far too generic
[02:39:55] <jack> but in that case, then you're link name would be rust-http not http, and you'd be fine.
[02:40:07] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[02:40:15] <Eridius> no, because it's really stupid to type `rust-http::foo()` in rust code.
[02:40:22] <Eridius> if that's even legal
[02:40:27] <Eridius> which I don't think it is
[02:40:34] <jack> if you use extern mod http = "github.com/foo/rust-http" then you are using http::foo()
[02:40:38] <Eridius> right
[02:40:50] <Eridius> and the installed library is named libhttp
[02:40:52] <jack> my point is that the pkg name and the pkgid have to match.
[02:40:55] <Eridius> because that's what rust-http's link_name is
[02:41:36] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[02:41:43] <jack> also, generic package names are ok becuase they are globally namespaced.
[02:41:54] <jack> it's not like ti's going to be confused with github.com/bar/http :)
[02:42:31] *** Joins: josh (josh@moz-D3896A24.dhcp.dlth.mn.charter.com)
[02:42:42] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[02:42:48] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[02:42:55] <strcat> jack: but you might wrap a lib called foo and call it rust-foo
[02:43:06] <strcat> if you had to call it foo, you wouldn't be able to have a fork of the actual lib
[02:43:10] <strcat> it'd be annoying
[02:43:21] <jack> yes. i assume in servo we'll call it libfoo and foo
[02:43:41] <Eridius> jack: I have 62 github repos on my account (both created and forked). I'll be damned if I'm about to create a genericly-named "http" which is a rust library
[02:43:50] <jack> right now all the C libs are named haphazardly and the rust bindings are rust-foo
[02:44:16] <jack> Eridius: you can name your libraries whatever you want. it doens't matter. i can rename it in extern mod.
[02:44:22] <jack> but you can't prevent me from creating `http`.
[02:44:33] <jack> and whether i create a generic one or not is not going to mess anything of yours up, even if you use it.
[02:44:51] <Eridius> huh? I don't care what name you give it internally. But the github repo isn't going to be called "http", and I can't very well have the library named rust-http because that's not a valid identifier
[02:44:53] *** Joins: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[02:45:01] <jack> this isn't like the apt repository where there is only one namespace that everyone shares.
[02:45:06] <Eridius> so, simply put, rustpkg needs to learn that the installed library name isn't necessarily the same thing as the name of the repo
[02:45:40] <jack> rust-http will transform to rust_http. i dont' see the problem.
[02:45:43] <Eridius> instead of searching for a library of a given name, why doesn't it just find any libraries, period, that were built from the source? It should only be building one library anyway
[02:45:50] <jack> your won't be using link name with rustpkg.
[02:45:54] <Eridius> the problem is rust_http is a really stupid name for a library
[02:46:24] <jack> s/your/you/
[02:46:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:46:30] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_Ts5IA
[02:46:30] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:47:05] <Eridius> Go solves this problem by letting you specify a sub-path on the repo, and it uses that sub-path as the name (of course Go doesn't even have the concept of link_name, it always uses the dir name)
[02:47:10] *** Joins: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net)
[02:47:13] <Eridius> so I could have github.com/kballard/rust-http/http
[02:47:29] <jack> you will be able to do that eventually in rustpkg. there's an open bug for that.
[02:47:29] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[02:47:39] <Eridius> I know there's an issue open on rustpkg to allow for subdirs, but right now rustpkg also searches recursively for lib.rs instead of just at the root level
[02:48:15] <Eridius> so if that issue is fixed, I would expect rustpkg to stop recursively searching as well and instead require lib.rs to be at the root
[02:50:00] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[02:51:07] *** Joins: ChrisMorgan1 (chris@moz-AAEDD935.its.monash.edu.au)
[02:51:11] *** Quits: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au) (Quit: Leaving.)
[02:51:30] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:51:30] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/80WAyg
[02:51:30] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:51:30] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:51:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/VPhtpw
[02:51:31] <ghrust> 13rust/06auto 1435ec01a 15Brandon Sanderson: Clarify use_decl module resolution docs.
[02:51:31] <ghrust> 13rust/06auto 146f70377 15bors: auto merge of #8639 : singingboyo/rust/use-decl-doc, r=thestinger...
[02:51:31] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:51:45] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[02:53:44] <jack> Eridius: that sounds reasonable.
[02:54:30] *** Quits: josh (josh@moz-D3896A24.dhcp.dlth.mn.charter.com) (Quit: josh)
[02:55:19] <jack> Eridius: you might want to comment to that affect here https://github.com/mozilla/rust/issues/6408
[02:55:53] <Eridius> jack: good point
[02:56:20] <ChrisMorgan1> jack: s/affect/effect/
[02:56:48] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[02:57:00] <jeaye> rusti: type T = &i32; struct S; impl S { pub fn f<'s>(t: 's T) { } }
[02:57:02] -rusti- <anon>:5:59: 5:61 error: expected type, found token LIFETIME({name: 73, ctxt: 0})
[02:57:02] -rusti- <anon>:5          type T = &i32; struct S; impl S { pub fn f<'s>(t: 's T) { } }
[02:57:02] -rusti-                                                                     ^~
[02:57:02] -rusti- application terminated with error code 101
[02:57:06] *** Joins: andrew_ (andrew@moz-F84C8FD7.hm.shawcable.net)
[02:57:12] *** andrew_ is now known as andrew-d
[02:57:13] <jeaye> How can I use a lifetime with a type alias?
[02:57:52] <Eridius> rusti: type T<'a> = &'a i32; struct S; impl S { pub fn f<'s>(t: T<'s>) {} }
[02:57:55] -rusti- pastebinned 8 lines of output: http://ix.io/7vq
[02:58:25] <Eridius> rusti: type T<'self> = &'self i32; struct S; impl S { pub fn f<'s>(t: T<'s>) {} }
[02:58:26] -rusti- <anon>:5:69: 5:70 warning: unused variable: `t` [-W unused-variable (default)]
[02:58:26] -rusti- <anon>:5          type T<'self> = &'self i32; struct S; impl S { pub fn f<'s>(t: T<'s>) {} }
[02:58:26] -rusti-                                                                               ^
[02:58:27] -rusti- ()
[02:58:29] <Eridius> jeaye: ^
[02:58:45] <jeaye> Where is 'self coming from?
[02:58:50] *** Quits: ChrisMorgan1 (chris@moz-AAEDD935.its.monash.edu.au) (Ping timeout)
[02:59:00] <Eridius> it's just a name. But it happens to be the only name allowed in the type declaration
[02:59:03] *** Quits: kimundi (kimundi@moz-7B43CEA1.dip0.t-ipconnect.de) (Ping timeout)
[02:59:16] <jeaye> Why's that?
[02:59:23] <Eridius> ask nmatsakis 
[02:59:34] <jeaye> (so 'self is the only lifetime that can every be used in a type declaration?)
[02:59:50] <jeaye> But arbitrary names can be used for lifetimes elsewhere?
[02:59:56] <Eridius> in function declarations, yeah
[03:00:01] <Eridius> impls need 'self or 'static
[03:00:34] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:00:51] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[03:01:14] <jeaye> One day, after I've bugged you guys enough to figure out all of the nooks and crannies with lifetimes, I'll write some documentation. :P
[03:02:14] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[03:02:37] *** Joins: kimundi (kimundi@moz-1D08C645.dip0.t-ipconnect.de)
[03:05:09] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[03:06:30] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[03:06:53] *** kimundi is now known as zz_kimundi
[03:12:21] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[03:13:47] *** zz_kimundi is now known as kimundi
[03:14:18] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:16:15] *** Joins: int3_ (int3_@moz-471501F5.snfc.ca.megapath.net)
[03:17:02] *** Joins: int3__ (int3_@moz-471501F5.snfc.ca.megapath.net)
[03:17:02] *** Quits: int3_ (int3_@moz-471501F5.snfc.ca.megapath.net) (Connection reset by peer)
[03:17:16] <Eridius> why the hell is this a parsing error? https://gist.github.com/kballard/6315211
[03:17:21] * Eridius is trying to use externfn!()
[03:17:42] *** Quits: int3__ (int3_@moz-471501F5.snfc.ca.megapath.net) (Client exited)
[03:17:49] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[03:18:16] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:18:26] *** Joins: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au)
[03:18:27] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:20:03] <aatch> Eridius, ugh, that bug.
[03:20:13] <acrichto> Eridius: you're missing a )
[03:20:25] <aatch> That too.
[03:20:26] <acrichto> Eridius: wait nvmd
[03:20:32] <Eridius> my parens are balanced
[03:20:33] <Eridius> aatch: what's the bug?
[03:21:15] <aatch> there's a bug with repeats in macros
[03:21:47] <aatch> though it normally only shows up when you want an empty sequence.
[03:22:36] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[03:26:30] <aatch> Hmm, the externfn! macro is supposed to work around that issue
[03:31:13] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:31:21] *** Quits: richard|s (mindginati@moz-C1729134.dsl.clear.net.nz) (Quit: brb)
[03:32:00] <Eridius> I'm surprised there's no externfns!() macro that takes multiple fns. Something you could use to replace extern {}
[03:32:50] <aatch> Eridius, can't expand to multiple items, remember?
[03:32:58] <Eridius> ah right. bleh
[03:33:25] <aatch> Eridius, heh, I do the same thing all the time.
[03:33:52] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:35:54] <Eridius> oh damn, externfn! can't handle pub fns?
[03:37:13] <Eridius> oh, it makes it pub by default. bah
[03:37:57] <Eridius> huh, the ident type in a macro can't handle _
[03:39:18] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[03:41:43] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[03:45:24] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[03:48:28] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[03:50:39] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[03:57:40] <engla> try pattern
[03:57:58] <engla> someone kindly informed _ is a pattern, I had never realized
[03:58:20] <Eridius> and yet it's a legit argument name in a function declaration
[03:58:42] <engla> can't you use patterns there though?
[03:58:58] <Eridius> rusti: fn foo(Some(x): Option<int>) -> int { x } foo(Some(3))
[03:58:59] -rusti- <anon>:5:16: 5:23 error: refutable pattern in function argument
[03:58:59] -rusti- <anon>:5          fn foo(Some(x): Option<int>) -> int { x } foo(Some(3))
[03:58:59] -rusti-                          ^~~~~~~
[03:59:00] -rusti- error: aborting due to previous error
[03:59:00] -rusti- application terminated with error code 101
[03:59:05] <Eridius> huh
[03:59:11] <engla> fn foo(~x: ~int) -> int { x }  foo(~1)
[03:59:16] <engla> rusti: fn foo(~x: ~int) -> int { x }  foo(~1)
[03:59:17] -rusti- 1
[03:59:34] <Eridius> I knew you could do that in a closure arg, I didn't know you could do that in a function arg. interesting.
[04:00:45] <Eridius> really wish macros supported alternation
[04:00:55] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:01:12] <Eridius> for example, you don't actually need to name your args at all, so it would be nice if the externfn!() macro could do something like $[$arg_name : $arg_ty $| $arg_ty]
[04:01:18] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[04:01:29] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[04:01:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/VPhtpw
[04:01:29] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[04:02:16] <Eridius> hrm, updating externfn!() to use pat actually won't work. I just realized it actually needs named args because it has to call through to an inner function. bah
[04:02:25] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[04:02:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:02:57] *** Quits: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au) (Ping timeout)
[04:03:26] *** Joins: eschweic (Adium@moz-CF8BEBEF.dia.static.qwest.net)
[04:04:33] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Client exited)
[04:05:12] <Eridius> hrm, would be nice if I could attach an attribute to a function that says its caller should have fixed_stack_segment, i.e. pass the buck up to its caller
[04:05:24] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[04:05:33] <Eridius> especially since I'm attaching #[inline(always)] here, which means that putting the attribute on this func is pointless
[04:05:37] <Eridius> (it's a replacement for a C macro)
[04:06:04] <jeaye> I'm trying to dereference a ~ from TLS to a &mut, but it's not quite working. Ideas? https://gist.github.com/jeaye/07be773fb00b199ec82d
[04:06:27] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:06:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/8SQ1_w
[04:06:27] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:06:28] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:06:28] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/kHrbSA
[04:06:28] <ghrust> 13rust/06auto 141860efb 15Vadim Chugunov: On Windows, use g++ for linking, instead of gcc....
[04:06:28] <ghrust> 13rust/06auto 149e7f1fc 15Vadim Chugunov: Un-disable stack unwinding on Windows.
[04:06:28] <ghrust> 13rust/06auto 1484e6830 15Vadim Chugunov: Emit unwind info in rustrt assembly files on Windows.
[04:06:30] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:07:11] *** Joins: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au)
[04:07:17] <engla> jeaye: move it into a mut variable?  let mut mopt = opt; ?
[04:07:27] <Eridius> jeaye: try using local_data::modify instead
[04:07:53] <jeaye> Oh, get_mut!
[04:08:17] <Eridius> can you turn a &mut ~T into a &mut T?
[04:08:42] * jeaye changed it to get_mut and things work now.
[04:08:55] <Eridius> rusti: fn foo(x: &mut ~str) { x.push("foo") } let mut test = ~"test"; foo(&mut test); test
[04:08:56] -rusti- <anon>:5:32: 5:47 error: type `&mut ~str` does not implement any method in scope named `push`
[04:08:56] -rusti- <anon>:5          fn foo(x: &mut ~str) { x.push("foo") } let mut test = ~"test"; foo(&mut test); test
[04:08:56] -rusti-                                          ^~~~~~~~~~~~~~~
[04:08:56] -rusti- error: aborting due to previous error
[04:08:57] -rusti- application terminated with error code 101
[04:09:03] <Eridius> rusti: fn foo(x: &mut ~str) { x.push_str("foo") } let mut test = ~"test"; foo(&mut test); test
[04:09:04] *** Quits: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:09:08] -rusti- ~"testfoo"
[04:09:11] <Eridius> huh, so it does work
[04:09:44] <jeaye> I'll look into local_data::modify
[04:09:47] <jeaye> Thanks. :)
[04:09:57] <Eridius> if get_mut works, you may as well use that
[04:10:09] <Eridius> I just wasn't sure if you could go from &mut ~T to &mut T
[04:10:20] <jeaye> aye
[04:11:16] <jeaye> After just making the camera compile with no @mut, this actually looks plausible (and I should be able to do the rest without asking something in here every hour). :D
[04:12:29] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[04:12:52] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:13:34] <sfackler> std::rt::util::abort sure is... interesting
[04:14:28] <Eridius> sfackler: yep :)
[04:16:10] *** Joins: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[04:19:52] *** Joins: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[04:20:10] *** Quits: mibitzi (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[04:25:42] <dbaupp> Eridius: &mut ~str isn't being turned &mut str (that type doesn't even exist)
[04:26:06] <dbaupp> Eridius: push_str is implemented on ~str with &mut self, so it actually requires &mut ~str.
[04:26:26] <Eridius> dbaupp: bah, ok, that was a bad rusti example. Didn't feel like making a struct
[04:26:30] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[04:26:32] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:26:54] <dbaupp> rusti: fn foo(x: &mut int) { *x += 1 } fn bar(y: &mut ~int) { foo(*y) } let mut z = ~1; bar(&mut z); z
[04:26:55] -rusti- ~2
[04:27:45] <Eridius> look at you, showing off your fancy rusti skills ;)
[04:28:08] *** kimundi is now known as zz_kimundi
[04:28:20] * dbaupp knows about the `i`, `n` and `t` keys :P
[04:29:07] <diverse> so rusti just prints out whatever you return?
[04:29:17] <Eridius> diverse: it passes it to fmt!("%?", ...)
[04:29:41] <Eridius> note of course that you can't return a non-static borrowed pointer
[04:29:52] <dbaupp> rusti: let x = 1; &x
[04:30:01] -rusti- pastebinned 16 lines of output: 
[04:30:02] -rusti- <pre>
[04:30:02] -rusti- MOD_PYTHON ERROR
[04:30:02] -rusti- ProcessId:      3454
[04:30:02] -rusti- Interpreter:    'ix.io'
[04:30:02] -rusti- ServerName:     'ix.io'
[04:30:02] -rusti- DocumentRoot:   '/home/rupa/www/ix.io/'
[04:30:02] -rusti- URI:            '/index.py'
[04:30:03] -rusti- Location:       None
[04:30:04] -rusti- Directory:      '/'
[04:30:05] -rusti- Filename:       '/home/rupa/www/ix.io/_/index.py'
[04:30:06] -rusti- PathInfo:       None
[04:30:08] -rusti- Phase:          'PythonHandler'
[04:30:09] -rusti- Handler:        'mod_python.publisher'
[04:30:11] -rusti- Traceback (most recent call last):
[04:30:13] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/importer.py", line 1537, in HandlerDispatch
[04:30:15] -rusti-     default=default_handler, arg=req, silent=hlist.silent)
[04:30:17] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/importer.py", line 1229, in _process_target
[04:30:19] -rusti-     result = _execute_target(config, req, object, arg)
[04:30:21] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/importer.py", line 1128, in _execute_target
[04:30:23] -rusti-     result = object(arg)
[04:30:23] <dbaupp> errr... hahah
[04:30:25] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/publisher.py", line 213, in handler
[04:30:26] <diverse> wow
[04:30:27] -rusti-     published = publish_object(req, object)
[04:30:29] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/publisher.py", line 425, in publish_object
[04:30:30] <dbaupp> strcat: ^
[04:30:30] <Eridius> strcat: python! :O
[04:30:31] -rusti-     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
[04:30:34] -rusti-   File "/usr/lib/python2.6/dist-packages/mod_python/util.py", line 554, in apply_fs_data
[04:30:36] -rusti-     return object(**args)
[04:30:38] -rusti-   File "/home/rupa/www/ix.io/_/index.py", line 150, in index
[04:30:39] -rusti-     ids = db.put(paste.user, paste.files)
[04:30:41] -rusti-   File "/home/rupa/www/ix.io/_/sprunge.py", line 170, in put
[04:30:42] -rusti-     self.con.commit()
[04:30:43] <diverse> Mozilla loves their python
[04:30:44] -rusti- OperationalError: database is locked
[04:30:47] -rusti- MODULE CACHE DETAILS
[04:30:49] -rusti- Accessed:       Fri Aug 23 00:31:07 2013
[04:30:50] -rusti- Generation:     2
[04:30:52] -rusti- _mp_064851523a4fa99325c14eeccd5e02e2 {
[04:30:53] -rusti-   FileName:     '/home/rupa/www/ix.io/_/index.py'
[04:30:53] <Eridius> also, rusti pings a web server? wat
[04:30:54] -rusti-   Instance:     1
[04:30:55] -rusti-   Generation:   2
[04:30:55] <dbaupp> diverse: this isn't what normally happens...
[04:30:56] -rusti-   Modified:     Thu Feb 28 15:41:38 2013
[04:30:57] -rusti-   Imported:     Thu Aug 22 20:46:30 2013
[04:30:58] -rusti-   Children:     '/home/rupa/www/ix.io/_/sprunge.py'
[04:30:59] -rusti- }
[04:31:01] -rusti- _mp_d84c692485e1cfedd896b0205424ba93 {
[04:31:01] <olsonjeffery> so anyone here given light-table 0.5 a spin?
[04:31:02] -rusti-   FileName:     '/home/rupa/www/ix.io/_/sprunge.py'
[04:31:03] -rusti-   Instance:     1
[04:31:04] -rusti-   Generation:   1
[04:31:05] -rusti-   Modified:     Thu Feb 28 15:41:13 2013
[04:31:05] <Aetherspawn_BNC> you didn't pastebin that
[04:31:06] -rusti-   Imported:     Thu Aug 22 20:46:30 2013
[04:31:07] -rusti- }
[04:31:07] <Aetherspawn_BNC> stop lying
[04:31:09] -rusti- </pre>
[04:31:10] <Aetherspawn_BNC> stupid bot
[04:31:10] <dbaupp> Eridius: it looks like ix.io has crashed
[04:31:16] <engla> nice
[04:31:26] <Eridius> ahh, not rusti. ix.io. nice
[04:31:40] <Eridius> interesting that rusti chose to spew that here instead of of just giving a summary
[04:31:45] <Eridius> strcat: lern 2 error handle pls
[04:31:46] <Aetherspawn_BNC> still mad that the bot broadcasts it to every channel
[04:31:54] <Eridius> what do you mean?
[04:31:59] <diverse> wait, really?
[04:32:02] <Aetherspawn_BNC> and I know its a fault in my IRC client, blah blah, but I'm gonna winge about it until it's made /me's
[04:32:02] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[04:32:20] * dbaupp prefers it when the channel gets filled with python tracebacks
[04:32:23] <Eridius> Aetherspawn_BNC: your IRC client lists the email address to contact them in your VERSION info. Go email them
[04:32:30] * dbaupp rusti: 1
[04:32:31] <Aetherspawn_BNC> its irccloud
[04:32:32] <Eridius> team@irccloud.com
[04:32:42] <Aetherspawn_BNC> it pops up as a dialog on my chrome when someone uses rusti
[04:32:44] <Aetherspawn_BNC> drives me nuts
[04:32:48] <Eridius> that's horrible
[04:32:51] *** Quits: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP) (Connection reset by peer)
[04:34:26] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[04:35:18] <diverse> rusti needs to apologize :P
[04:36:12] <sfackler> isn't there some syntax to bind the value of a match pattern?
[04:36:24] <sfackler> something like "Some(*) as foo"?
[04:36:53] <Eridius> foo@Some(*)
[04:37:05] <sfackler> thanks
[04:37:16] <dbaupp> rusti: "sorry, diverse"
[04:37:17] -rusti- "sorry, diverse"
[04:37:22] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Quit: Konversation terminated!)
[04:38:53] <strcat> Eridius: lol ;p
[04:39:06] <strcat> that's not my traceback
[04:39:15] <Eridius> strcat: rusti gave it to me, ergo it's yours :P
[04:39:17] <strcat> that's *their* traceback
[04:39:31] <strcat> Eridius: rusti POSTs a form to a pastebin and prints the body it returns (the url)
[04:39:35] <dbaupp> strcat: you shuld at least check it starts with http ;P
[04:39:44] <strcat> I guess
[04:39:50] <strcat> rusti: 2
[04:39:51] <Eridius> maybe put some cap on the results, where it can't print more than, say, 5 lines
[04:39:52] -rusti- 2
[04:39:53] <strcat> rusti: aa
[04:39:54] -rusti- <anon>:5:9: 5:11 error: unresolved name `aa`.
[04:39:54] -rusti- <anon>:5          aa
[04:39:55] -rusti-                   ^~
[04:39:55] -rusti- error: aborting due to previous error
[04:39:55] -rusti- application terminated with error code 101
[04:39:57] <strcat> rusti: aaafds
[04:39:58] -rusti- <anon>:5:9: 5:15 error: unresolved name `aaafds`.
[04:39:58] -rusti- <anon>:5          aaafds
[04:39:58] -rusti-                   ^~~~~~
[04:39:59] <strcat> rusti: aaafds + e
[04:40:00] -rusti- error: aborting due to previous error
[04:40:02] -rusti- application terminated with error code 101
[04:40:03] -rusti- pastebinned 8 lines of output: http://ix.io/7vt
[04:40:04] <diverse> no not again
[04:40:14] <strcat> I'd just have ctrl-ed it if it did it again
[04:40:16] <strcat> ;p
[04:40:22] <strcat> anyway I'll cap it to 1 line
[04:40:44] <strcat> if it's more than 1 line it can try sprunge instead
[04:41:57] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:42:16] <strcat>         r = requests.post("http://ix.io", {"f:0": b"".join(lines)})
[04:42:18] <strcat>         return "pastebinned {} lines of output: {}".format(len(lines), r.content)
[04:42:20] <strcat> Eridius: I was lazy
[04:42:22] <strcat> ;p
[04:42:28] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[04:42:50] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[04:43:15] <Eridius> strcat: so it _is_ python!
[04:43:27] <strcat> well
[04:43:29] <strcat> part of it
[04:43:44] <strcat> Eridius: https://github.com/thestinger/rust-playpen + https://github.com/thestinger/playpen is the web version
[04:43:45] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:44:06] <strcat> the bot is just the same as the web version but a little shim with an irc lib instead of a web framework ;p
[04:48:10] <garthk> Awesome to hear some of the speed and bloat is being worked on: https://mail.mozilla.org/pipermail/rust-dev/2013-June/004480.html
[04:48:43] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:48:47] <strcat> rusti: 2
[04:48:47] -rusti- 2
[04:48:50] <strcat> rusti: asadsgsg
[04:48:50] -rusti- <anon>:5:9: 5:17 error: unresolved name `asadsgsg`.
[04:48:51] -rusti- <anon>:5          asadsgsg
[04:48:51] -rusti-                   ^~~~~~~~
[04:48:51] -rusti- error: aborting due to previous error
[04:48:51] -rusti- application terminated with error code 101
[04:48:53] <strcat> rusti: asadsgsg + w
[04:48:58] -rusti- pastebinned 8 lines of output: http://ix.io/7vu
[04:49:22] <diverse> Eridius: I tried the get/set method thing and I am still having an issue, could you help me with this: http://pastebin.com/6sLFStFa
[04:50:07] <Eridius> diverse: try something like `let hp = monster.get_hp() - self.strength; monster.set_hp(hp)`
[04:50:15] <Eridius> I think it's a borrowck issue
[04:50:18] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:50:19] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:50:21] <strcat> rusti: asadsgsg + w
[04:50:23] -rusti- pastebinned 8 lines of output: http://ix.io/7vu
[04:50:36] <strcat> rusti: for _ in range(0, 10000) { print(" ") }
[04:50:37] -rusti- line longer than 10000 characters, bailing out
[04:50:41] <dbaupp> diverse: https://github.com/mozilla/rust/issues/6268
[04:50:42] <strcat> rusti: for _ in range(0, 100) { print(" ") }
[04:50:43] -rusti-                                                                                                     ()
[04:50:47] <strcat> rusti: for _ in range(0, 300) { print(" ") }
[04:50:49] -rusti- pastebinned 1 lines of output: http://ix.io/7vv
[04:50:53] <strcat> heh
[04:51:03] <strcat> do I really care enough to make the grammar correct? no
[04:51:22] <Eridius> why did it pastebin 1 line?
[04:51:26] <Eridius> that seems rather pointless
[04:51:34] <strcat> Eridius: because it's long
[04:51:50] <Eridius> less than 510 characters!
[04:52:09] <strcat> so? ;p, I don't know how big the irc header is going to be
[04:52:10] <Eridius> well, 510 - NOTICE #rust: so 496
[04:52:21] <strcat> Eridius: and channel name, etc.
[04:52:40] <ski> (hm, 496 is a perfect number)
[04:52:43] <dbaupp> strcat: I do believe #rust is the channel name
[04:52:54] <Eridius> my irc lib (written in Go) has a function that tells you how long your line can be for a PRIVMSG or a NOTICE to a given channel. Makes it easy to do stuff like this
[04:53:03] <strcat> dbaupp: it's in other channels ;p
[04:53:13] * strcat has to spread rust propaganda
[04:53:20] <strcat> Eridius: http://ix.io/7vw ;p
[04:53:27] <strcat> Eridius: well, this is by far the worst irc lib ever
[04:53:27] <Eridius> the routine that decides whether to emit or pastebin should know what channel it's talking to
[04:53:38] <Eridius> heh. what lib?
[04:53:39] <strcat> I was too lazy to even find a good one and used twisted
[04:53:43] <dbaupp> strcat: is it just sitting there printing "must trust rust"? :P
[04:53:44] <strcat> it's awful
[04:53:45] <Eridius> twisted does irc?
[04:53:46] <diverse> Eridius & dbaupp: thanks
[04:53:48] <garthk> Twisted. Eww.
[04:53:54] <strcat> Eridius: there's something it doesn't do?
[04:53:56] <strcat> ;p
[04:54:05] <Eridius> strcat: re-write the irc bot in Go! That'll show people how good Rust is!
[04:54:17] <Eridius> https://github.com/kballard/goirc ;)
[04:54:34] <strcat> rewrite your irc lib in rust and I'll rewrite rusti in rust
[04:54:42] <strcat> ;;p
[04:54:45] <Eridius> still waiting for I/O to settle down before I do something like that
[04:55:02] <Eridius> I do actually want to re-write my bot in Rust, once I think I won't have to re-write it every week
[04:55:09] <jeaye> haha
[04:55:42] <strcat> rusti: for _ in range(0, 100000) { println("foo") }
[04:55:43] -rusti- more than 10000 lines of output, bailing out
[04:55:45] <dbaupp> Eridius: only update your main rust every 2 weeks and it'll b fine
[04:55:49] <strcat> meh
[04:55:51] <dbaupp> *be
[04:55:54] <Eridius> pfft
[04:55:55] <jeaye> For my owned boxes in TLS, if the type doesn't have a lifetime, I can just have ~Foo, but if it does, the compiler insists it's ~Foo<'static> -- why is this?
[04:55:58] * strcat disables that check to test the new error path
[04:56:02] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:56:08] <Eridius> dbaupp: my irc bot runs on a linode with 1GB of RAM. I don't want to update rust on that thing very often anyway
[04:56:20] <garthk> While I'm waiting for trunk to rebuild: any broad pointers to the best way to wade through time-series data in terabytes of XML with Rust? 
[04:56:21] <garthk> I'm looking at Rust because V8's C++-to-JS traversal is too damn slow and even Python gets silly-busy with what I suspect is string marshalling. 
[04:56:33] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:56:43] <dbaupp> Eridius: is it even possible to build rust with that much ram (swap?)
[04:57:00] <jeaye> dbaupp: You'd need 2GB swapon to be safe.
[04:57:02] <garthk> The XML is so repetitive, I don't need a formal parser; pretty much any way of wading through strings to extract data will work fine.
[04:57:05] <strcat> pfft, who needs to build rust when you have strcat's daily builds
[04:57:09] <strcat> rusti: for _ in range(0, 100000) { println("foo") }
[04:57:12] <Eridius> dbaupp: yep! Although when I tried with --enable-debug, rustc was killed (presumably memory exhaustion)
[04:57:14] -rusti- pastebinned 100001 lines of output: http://ix.io/7vx
[04:57:21] <strcat> dammit ix.io
[04:57:25] <strcat> you were supposed to bail
[04:57:30] <strcat> rusti: for _ in range(0, 1000000) { println("foo") }
[04:57:52] <dbaupp> garthk: there's not much other than what's in str.rs
[04:57:54] <strcat> watch me get blocked from ix.io
[04:57:56] -rusti- failed to pastebin 1000001 lines of output
[04:57:59] <strcat> yay
[04:58:05] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:58:09] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:58:21] <Eridius> garthk: what's wrong with a formal parser? Just don't use a DOM parser
[04:58:28] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[04:58:36] <Eridius> garthk: I'm half-tempted to say you should go use Go, since they have a good event-based XML parser ;)
[04:58:51] *** Joins: robertknight (robertknig@moz-731801B5.range86-144.btcentralplus.com)
[04:58:55] <strcat> expat is fine if you don't need a validating parser
[04:59:08] <strcat> the only flaw in expat is that it uses int instead of size_t
[04:59:13] <strcat> for legacy reasons
[04:59:20] <strcat> so you can't mmap a huge xml file and pass it in one go :(
[04:59:38] <garthk> Eridius: yeah, but several Go/Node comparisons have me suspecting Go will turn out to surface the XML parsing events at about the same 10MB/s as I can get in Node. I guess I should check.
[04:59:53] <diverse> rusti: "strcat: I want to be written in Go, not python. :("
[04:59:54] -rusti- "strcat: I want to be written in Go, not python. :("
[04:59:56] <Eridius> garthk: it's worth trying. You can write an extremely simple parser pretty fast
[04:59:57] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[05:00:04] *** Quits: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP) (Quit: Textual IRC Client: www.textualapp.com)
[05:00:16] <dbaupp> garthk: https://github.com/bjz/sax-rs
[05:00:16] <strcat> I'm not rewriting rusti unless it's in rust ;p
[05:00:22] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:00:22] *** ChanServ sets mode: +o tjc
[05:00:25] <dbaupp> diverse: s/python/rust/
[05:00:29] <dbaupp> err, s/go/rust/
[05:00:34] <garthk> node-expat was even slower than the libxml2 addon. Python's libxml2 addon waded through the XML at a pleasant ~50MB/s but things slowed down dramatically when I tried actually doing anything with the events.
[05:01:03] <strcat> garthk: just use C++? ;p
[05:01:10] <diverse> strcat: are you willing to update syntax every week?
[05:01:14] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:01:17] <strcat> diverse: sure
[05:01:24] <strcat> there aren't going to be many changes
[05:01:34] <strcat> I have a bunch of rust libs and haven't needed to update them since 0.7 yet
[05:01:56] <diverse> so things are starting to settle down now?
[05:02:01] <garthk> strcat, it's so bloody long since I touched pointersâ€¦ I'm not sure I want to go back. Sure, static analysis helps, and Boost has a version of RapidXML packed in thereâ€¦ *sigh*
[05:02:08] <strcat> although rust-gmp is likely broken because the num stuff is always shifting around
[05:02:54] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[05:03:38] <dbaupp> strcat: they use no loops?
[05:03:56] <strcat> dbaupp: no for loops
[05:04:04] <strcat> they're bindings ;p
[05:04:28] <garthk> Huh. I swear, this latest Rust built a lot faster than previous Rusts. I didn't even hear my fans spin up.
[05:04:29] <dbaupp> diverse: yes, there's a few big breaking changes in the pipeline, but hopefully they'll be the last.
[05:04:55] <strcat> garthk: well if you don't have to build LLVM because you already have it around, it's just 3.5-4 mins per stage
[05:04:57] <dbaupp> strcat: heresy! how dare you acknowledge languages other than Rust by binding to their libs?!?
[05:05:37] *** Quits: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[05:06:00] *** Joins: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[05:07:55] <strcat> acrichto: one issue - loop-vectorize shouldn't be enabled at --opt-level=1
[05:07:59] <strcat> by default
[05:08:16] <strcat> just -O2/-O3 like clang 3.4 is going to do
[05:09:11] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[05:09:14] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[05:09:36] <Eridius> garthk: here's a quick Go program that will count the number of start tags in an XML file. Try using it on your large XML data? http://play.golang.org/p/OsTCUQqKP7
[05:10:04] <garthk> Eridius: good idea. 
[05:10:16] <Eridius> note, I haven't actually compiled it myself, but it looks correct ;)
[05:11:09] <Eridius> Go's XML package is actually pretty nice. If you find an element that you want to decode into a struct, you can just call decoder.DecodeElement(), and it will decode the entire element until the balanced close tag, and hand control back to you for per-token parsing
[05:12:01] *** Joins: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP)
[05:15:03] <garthk> Eridius: 12MB/s. About what I'm getting in Node.js before I start doing useful work on top of the raw XML parsing. 
[05:15:16] <diverse> I can't get my 2 birds to attack each other: http://pastebin.com/JmGFvTNm
[05:15:28] <Eridius> garthk: hrm. I'm surprised it isn't more
[05:15:46] <garthk> Eridius: any better way to run this than: time go run count.go filename.xml ?
[05:16:01] *** Quits: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:16:02] <Eridius> garthk: well that's also timing compilation. you could try compiling it first
[05:16:15] <strcat> probably big enough that it doesn't matter
[05:16:28] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:16:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/kHrbSA
[05:16:28] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[05:16:35] <Eridius> garthk: I'm curious, what happens if you wrap the file handle in a bufio.Reader? That introduces explicit buffering
[05:16:51] <Eridius> and lets you tune how large of a buffer it has (and therefore how much it requests from the file handle at once)
[05:17:05] * Eridius wishes he had a large-enough XML file to do this sort of test locally
[05:17:31] <strcat> Eridius: wikipedia
[05:17:56] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[05:18:04] <Eridius> well damn that's a large download
[05:18:34] <strcat> well they have one that's just the latest revision of every article
[05:18:37] <garthk> decoder := xml.NewDecoder(bufio.NewReader(f))
[05:18:40] <strcat> no talk pages, etc.
[05:18:44] <garthk> Still about 12MB/s, Eridus.
[05:18:45] <dbaupp> diverse: .attack(&mut bird2 as &mut Monster)
[05:18:47] <Eridius> darn
[05:18:54] <Eridius> strcat: yeah but it's still 9GB compressed
[05:19:02] <strcat> and 40GiB decompressed
[05:19:17] <strcat> if only they used xz or lrzip it could be 4-5GB compressed
[05:19:25] <strcat> but no, crappy bzip.
[05:19:39] <strcat> bzip is slower too :s
[05:19:44] <Eridius> surprised they don't have a "just featured articles" dump
[05:19:56] <strcat> Eridius: there aren't many
[05:20:21] <diverse> dbaupp: thanks again
[05:20:21] <strcat> 4k
[05:20:40] <dbaupp> rusti: enum Foo { Ã–Ã„Ã… } error!(Ã–Ã„Ã…); error!("%?", Ã–Ã„Ã…); error!("Ã–Ã„Ã…"); error!("%s", "Ã–Ã„Ã…"); 
[05:20:41] -rusti- ~"\xd6\xc4\xc5"
[05:20:41] -rusti- ~"\xd6\xc4\xc5"
[05:20:41] -rusti- ~"\"\\xd6\\xc4\\xc5\""
[05:20:42] -rusti- ~"\xd6\xc4\xc5"
[05:20:42] -rusti- ()
[05:20:47] <strcat> + 18k good articles ;p
[05:20:50] <Eridius> hrm, torrent download is relatively slow
[05:20:59] <dbaupp> is there seriously no way to log unicode??
[05:21:08] <Eridius> dbaupp: try %s
[05:21:09] <strcat> Eridius: shouldn't be, if the client has http seed support
[05:21:14] <dbaupp> Eridius: last one
[05:21:17] <strcat> at least as far as I can remember.
[05:21:20] <Eridius> ah
[05:21:28] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:21:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PibSBQ
[05:21:28] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:21:29] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[05:21:29] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/ePP7CQ
[05:21:29] <ghrust> 13rust/06auto 148ffed39 15Alex Crichton: Upgrade libuv to the current master + our patches...
[05:21:29] <ghrust> 13rust/06auto 141fa01dd 15Alex Crichton: Implement process bindings to libuv...
[05:21:29] <ghrust> 13rust/06auto 14acecab8 15bors: auto merge of #8645 : alexcrichton/rust/issue-6436-run-non-blocking, r=brson...
[05:21:31] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:21:31] <Eridius> dbaupp: :/ the rust logger is kinda crappy
[05:21:37] <Eridius> strcat: using uTorrent
[05:21:39] <dbaupp> Eridius: yup
[05:21:40] <strcat> rusti: __log(1, "foo")
[05:21:41] -rusti- "foo"
[05:21:41] -rusti- ()
[05:21:44] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[05:21:51] <strcat> rusti: __log(1, "fooÃ–Ã„")
[05:21:52] -rusti- "foo\xd6\xc4"
[05:21:52] -rusti- ()
[05:22:00] <strcat> rusti: "fooÃ–Ã„"
[05:22:01] -rusti- "foo\xd6\xc4"
[05:22:11] <dbaupp> rusti: print("fooÃ–Ã„")
[05:22:12] <engla> rusti: print("Ã¤lg")
[05:22:13] -rusti- fooÃ–Ã„()
[05:22:13] -rusti- Ã¤lg()
[05:22:51] <dbaupp> rusti: fooÃ–Ã„(); Ã¤lg()
[05:22:59] -rusti- pastebinned 8 lines of output: http://ix.io/7vB
[05:23:14] <dbaupp> woo, bad spans! :D
[05:23:53] <Eridius> dbaupp: huh, I was expecting it to be off in the other direction
[05:24:16] <Eridius> looks like it just removed the Ã–Ã„ entirely from its idea of the span
[05:25:43] <dbaupp> I guess it's dropping the 2 "extra" bytes (compared to OA), since elk is shifted by exactly 2 too.
[05:25:52] <dbaupp> *Ã¤lg
[05:25:57] <Eridius> right
[05:26:17] <strcat> it's not easy to do proper spans because there are double-width graphemes
[05:26:39] <dbaupp> yeah
[05:27:09] <dbaupp> but this one is particularly bad: it's a single-width, one-codepoint character.
[05:27:47] *** Quits: eschweic (Adium@moz-CF8BEBEF.dia.static.qwest.net) (Quit: Leaving.)
[05:27:52] <strcat> well it's kind of good that it's totally wrong instead of 99% right ;p
[05:28:04] <strcat> at least this way someone will decide to fix it
[05:29:05] <dbaupp> except the full fix need smore unicode tables
[05:30:06] *** Quits: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[05:31:28] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:31:28] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:31:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14acecab8 to 149e1e152: 02http://git.io/N3iJvQ
[05:31:28] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:31:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:31:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Ijaj-A
[05:31:29] <ghrust> 13rust/06auto 1477a3de3 15Kevin Ballard: Implement size_hint() on RangeInclusive
[05:31:29] <ghrust> 13rust/06auto 140688bde 15bors: auto merge of #8671 : kballard/rust/range_inclusive-size-hint, r=thestinger...
[05:31:30] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:31:30] <Eridius> torrent's still only at about 1.5MBps. I'll never understand why bittorrent became so popular when, in my experience, it always takes a really long time to ramp up the speed
[05:31:34] <Eridius> usenet was always much better
[05:31:42] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:32:04] <strcat> Eridius: not centralized
[05:32:37] <Eridius> I would wager that most bittorrent users don't really care about that (at least, not until the RIAA started going lawsuit-happy, and even then decentralized doesn't seem to help much)
[05:32:55] <Eridius> strcat: btw, not sure what the heck went wrong with the build earlier for https://github.com/mozilla/rust/pull/8203. Does it just need a retry, or what?
[05:33:39] <garthk> I hate this phase of learning a language, where nothing seems to make sense. Though, I didn't seem to have much of it when learning Node; there's something about npm that helped a great deal.
[05:33:49] <strcat> Eridius: don't know
[05:34:33] <dbaupp> garthk: rust is particularly bad at it... the documentation & tutorials aren't great, etc etc.
[05:35:03] <strcat> well if you know one of {python, ruby, javascript, ...}, you can pick up another in 5 mins because they are the same thing with a different coat of paint
[05:35:19] <garthk> Take, for example, Eridius' pointer to sax-rs. I can cd src/ and rustc sax.rs to get a libsax-938edf9abdaf3425-0.1.dylib file. Awesome. Then I write test.rs with 'extern mod sax;' at the topâ€¦ and Rust complains that it can't find the crate. It's right there in the same directory. Where *should* it be?
[05:35:32] <dbaupp> that was me :P
[05:35:33] <Eridius> garthk: try adding -L.
[05:35:46] <Eridius> to rustc, that is
[05:35:47] <ChrisMorgan> That is, `-L.`
[05:36:02] <garthk> Woot.
[05:36:03] <Eridius> ChrisMorgan: what, you think I use proper puncation on my IRC lines? :P
[05:36:12] <dbaupp> that is `rustc -L .`, i.e, add '.'  to the crate-search-path
[05:36:16] <dbaupp> Eridius: you did then :P
[05:36:20] <ChrisMorgan> Eridius: I don't know. But you might.
[05:36:25] <Eridius> dbaupp: wooosh
[05:36:26] <Eridius> ;)
[05:36:49] <ChrisMorgan> dbaupp: come, come. His line ended with a letter.
[05:37:38] <Eridius> I only punctuate for dramatic effect.
[05:37:48] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[05:38:03] <garthk> Aah, I'd have found that in section 17.3 of the tutorial. My bad.
[05:38:24] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[05:39:06] *** Joins: Liothen (liothen@moz-80EF0CD7.spkn.qwest.net)
[05:43:54] *** Quits: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP) (Client exited)
[05:44:29] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[05:47:51] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:50:17] <jeaye> What are the implications of 'static here: static tls_key: local_data::Key<Director<'static>> = &local_data::Key;
[05:52:57] <brson> jeaye: it means your Director can't contain borrowed pointers (except 'static pointers)
[05:52:59] *** Joins: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP)
[05:53:15] <jeaye> That explains the slew of compiler errors.
[05:53:28] <jeaye> Can I have a type in TLS with borrowed pointers?
[05:53:45] <jeaye> (as fields)
[05:54:18] <dbaupp> jeaye: unlikely, unless they are 'static borrowed pointers
[05:54:22] <brson> no, though I could imagine a TLS variant that follows stack discipline where that would make sense
[05:54:36] <brson> do local_data::with(borrowy-variable) { ... }
[05:54:47] <jeaye> Ok, then I should be able to make do with ~ here
[05:55:01] <jeaye> But only if I can solve another problem that using ~ causes. :P
[05:56:44] <jeaye> I want to do this: https://gist.github.com/jeaye/f485f53faf23c37a6bf5
[05:57:34] <jeaye> Director is ~ in TLS and has `states: ~[~State]`; I want to add some children/implementors of State to that vec.
[05:58:06] <jeaye> But the compiler doesn't like the cast to ~State: cannot move out of captured outer variable
[05:59:03] <aatch> sfackler, ping
[05:59:32] <dbaupp> jeaye: https://github.com/mozilla/rust/wiki/Doc-under-construction-FAQ#once-functions
[06:00:15] <dbaupp> jeaye: it's because it ccan't tell that the closure is only called once (if it was called multiple times, then game_state would have to be moved out of twice; which doesn't work.)
[06:01:28] <jeaye> Ah, I see how that'd be a problem.
[06:01:34] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[06:02:40] <garthk> use core::io::{Reader, ReaderUtil}; â€¦ has this changed in 0.8-pre? *bangs head on table*
[06:02:40] *** Joins: eschweic (Adium@moz-CF8BEBEF.dia.static.qwest.net)
[06:03:02] <jeaye> dbaupp: Do the once functions work? (stable enough to use?)
[06:03:14] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[06:03:14] <mm> garthk: The library is no longer named "core"
[06:03:17] <diverse> core doesn't exist anymore
[06:03:33] <jeaye> garthk: core is std, old std is extra
[06:03:51] <dbaupp> jeaye: don't think so
[06:04:01] <garthk> use std::io::{Reader, ReaderUtil}; then. Cool.
[06:04:01] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Quit: Leaving)
[06:04:13] <jeaye> dbaupp: That's ok. Looks like I can get away with Cell here. Thanks for the link.
[06:04:26] *** Quits: eschweic (Adium@moz-CF8BEBEF.dia.static.qwest.net) (Quit: Leaving.)
[06:04:35] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: zzzzzzzzzz)
[06:09:14] <acrichto> strcat: are you sure loop-vectorize isn't on at O1?
[06:09:37] <strcat> acrichto: I'm not 100% sure, do you have clang from svn compiled?
[06:09:46] <acrichto> sadly no, checking the source again though
[06:09:49] <strcat> in clang3.3 it's only on at -O3
[06:09:56] <jeaye> dbaupp: If the ~ is borrowed at all, it can't be put into a cell. https://gist.github.com/jeaye/fb6f0b65394f678b861c
[06:09:57] <jeaye> Gar
[06:10:11] <strcat> acrichto: all I know is that they *planned* to enable it at -O2 and also flip on slp vectorize at -O3
[06:10:15] <strcat> I'm not sure what they actually did
[06:10:23] <acrichto> it actually doesn't look like they have it on by default
[06:10:35] <strcat> acrichto: it is on by default at -O3 with 3.3 and they didn't regress
[06:10:44] <strcat> I can verify that
[06:10:48] <strcat> since I have it here ;p
[06:10:56] <strcat> in LLVM's opt, it's not on by default
[06:11:04] <acrichto> strcat: https://github.com/llvm-mirror/clang/blob/master/include/clang/Frontend/CodeGenOptions.def#L113
[06:11:18] <acrichto> they seem to all be off by default
[06:11:37] <dbaupp> jeaye: ah... I have a feeling that this will/can never work :( (assuming game_renderer_state stores the &mut game_state)
[06:11:48] <jeaye> It does. :|
[06:11:55] <strcat> acrichto: I can tell you with 100% certainty that it's on at -O3 in vanilla 3.3 clang
[06:12:33] <jeaye> dbaupp: Would this go away if they were value types instead of owned boxes?
[06:12:41] <acrichto> strcat: huh ok, you think they'll enable it at O2 as well?
[06:12:48] <strcat> acrichto: http://www.phoronix.com/scan.php?page=news_item&px=MTM5MDg http://www.phoronix.com/scan.php?page=news_item&px=MTQyNjc well according to this they have
[06:12:54] <dbaupp> jeaye: nope
[06:12:57] <strcat> but I haven't verified
[06:13:05] <acrichto> eh I trust that
[06:13:09] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[06:13:29] <strcat> it links to commits
[06:13:34] <dbaupp> jeaye: ~Foo has very little extra semantics over Foo except it isn't implicitly copyable (even if Foo is), and it's not on the stack
[06:13:43] <strcat> acrichto: https://github.com/llvm-mirror/clang/commit/f94c0600416c2457aeeda6823f0cf66782af3427 just find that ;p
[06:13:44] *** Quits: jdm (jdm@97DF0582.DEAB171B.971E19F6.IP) (Quit: Lost terminal)
[06:13:48] <dbaupp> jeaye: (aiui, anyway)
[06:13:50] <strcat> acrichto: + https://github.com/llvm-mirror/llvm/commit/a4cbd78af84b76f92202f2f2b1a3c49ff1f85798
[06:14:04] <strcat> for loop-vectorize I mean
[06:14:09] *** Quits: darkf (darkf@moz-F9058B8A.net) (Quit: WeeChat 0.4.1)
[06:14:26] <jeaye> dbaupp: What would you do in this case? (I could go back to @mut for this bit :( )
[06:14:50] <strcat> acrichto: anyway we should do whatever they do there - if phoronix is accurate, that means loop-vectorize at -O2/-O3 and slp-vectorize at -O3
[06:14:59] <strcat> but they spread it out so it's not easy to tell ;p
[06:15:02] <strcat> without a binary
[06:15:21] *** Joins: darkf (darkf@moz-F9058B8A.net)
[06:15:23] <acrichto> strcat: argh http://llvm.org/docs/doxygen/html/PassManagerBuilder_8cpp_source.html is out of date and that's what I've been reading :P
[06:15:24] <garthk> Much prefer this syntax: if maybe_test_reader.is_err() â€¦
[06:15:31] <dbaupp> jeaye: noooooo... is there some more context for the code somewhere?
[06:15:36] <dbaupp> garthk: over?
[06:16:06] <acrichto> strcat: oh wait nvmd, reading the wrong code
[06:16:19] <acrichto> strcat: ok, will update to what clang does
[06:16:19] <strcat> acrichto: ideal way to do it is just to compare clang from svn with rust via printing passes
[06:16:30] *** Quits: robertknight (robertknig@moz-731801B5.range86-144.btcentralplus.com) (Ping timeout)
[06:16:30] <strcat> too hard to figure out their codebase ;p
[06:16:32] <garthk> dbaupp: if is_err::<@Reader, ~str>(&maybe_test_reader)
[06:16:33] *** Joins: fabiand (fabiand@moz-B73D92D4.adsl.alicedsl.de)
[06:16:38] <strcat> since it touches 5+ places
[06:16:41] <garthk> Not sure if it's equivalent, yet, but it seems to compile. :)
[06:16:44] <dbaupp> garthk: o_O
[06:16:47] <strcat> clang's arg handling, clang's pass handling, llvm's pass handling, etc.
[06:17:00] <acrichto> yeah :(
[06:17:03] <garthk> I am just word-processing this code without the faintest clue about the language.
[06:17:05] <dbaupp> garthk: is_err(&maybe_test_reader) almost certainly works if maybe_test_reader.is_err() does
[06:17:09] <garthk> Now I know how my junior developers feel.
[06:17:21] <dbaupp> (i.e. without the ::<> type annotation.)
[06:18:26] <strcat> acrichto: one of their devs wanted to enable slp at -O1/-O2 too but I don't think they did
[06:18:36] <strcat> probably because it's too risky for 3.4
[06:18:41] <strcat> since it's new
[06:18:45] <acrichto> do you know what vectorize-slp-aggressive is enabled at if at all?
[06:18:52] <strcat> acrichto: don't think it is by default
[06:20:32] <jeaye> dbaupp: As much as you need. :P The code in question is here: https://github.com/jeaye/q3/blob/master/src/main.rs#L106
[06:21:17] <jeaye> game_renderer_state needs a mutable reference to game_state, and likewise for the bsp_renderer.
[06:21:30] <strcat> acrichto: slp-aggressive is bbvectorize
[06:21:35] <strcat> and it's really bad ;p
[06:21:42] <dbaupp> jeaye: and director.push() interacts with TLS?
[06:21:45] <acrichto> I don't even know what slp is 
[06:21:54] <strcat> acrichto: superword level parallelism
[06:22:04] <jeaye> dbaupp: `do state::Director::get() |director|` interacts with TLS
[06:22:12] <strcat> superword -> larger than a word (as in SSE, AVX)
[06:22:17] <dbaupp> jeaye: I *guess* that TLS is an anti-pattern. (since it's spooky action at a distance)
[06:22:18] <acrichto> sounds fancy
[06:22:22] <strcat> it just looks at some scalar ops in a row, and combines them
[06:22:26] <strcat> into SSE/AVX
[06:22:29] <strcat> or neon, whatever
[06:22:33] <acrichto> sounds useful
[06:22:34] <dbaupp> jeaye: does it need to be in TLS?
[06:22:47] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[06:22:47] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[06:22:47] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:22:51] <acrichto> strcat: pushed an update to only have loop vectorization on at > O2 and slp vectorization on at O3 by default
[06:23:01] <dbaupp> jeaye: where is Director even used?
[06:23:03] <acrichto> disableable with -Z no-vectorize-loops and -Z no-vectorize-slp
[06:23:14] <jeaye> In this case... no, I don't think so.
[06:23:45] <dbaupp> I'd guess that would help; but it doesn't solve the underlying problem: game_state is unuseable after game_renderer_state
[06:24:02] <jeaye> dbaupp: It's only used right here in main for now, but anything modifying the state stack would want to be able to modify it (user interface, console, etc)
[06:24:15] <jeaye> Yeah
[06:24:27] <dbaupp> rusti: you need multiple users of game_state right?
[06:24:28] -rusti- <anon>:5:52: 5:53 error: unknown start of token: ?
[06:24:28] -rusti- <anon>:5          you need multiple users of game_state right?
[06:24:28] -rusti-                                                              ^
[06:24:28] <sfackler> aatch: pong
[06:24:29] -rusti- application terminated with error code 101
[06:24:49] <dbaupp> *jeaye
[06:25:02] <dbaupp> haha, habit.
[06:25:09] <jeaye> hehe
[06:25:09] <strcat> acrichto: their example is this:
[06:25:11] <jeaye> dbaupp: Multiple objects will be interested in getting at least a borrowed pointer to it.
[06:25:11] <strcat> void foo(int a1, int a2, int b1, int b2, int *A) {
[06:25:13] <strcat>   A[0] = a1*(a1 + b1)/b1 + 50*b1/a1;
[06:25:13] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[06:25:15] <strcat>   A[1] = a2*(a2 + b2)/b2 + 50*b2/a2;
[06:25:17] <strcat> }
[06:25:20] <strcat> acrichto: which slp-vectorize handles
[06:25:27] <jeaye> at least an immutable borrowed pointer, anyway
[06:25:37] <strcat> as in it updates A[0] and A[1] at the same time
[06:25:40] <acrichto> strcat: looks intense
[06:26:01] <dbaupp> jeaye: ah, then I guess @mut or extra::rc::RcMut (or the like) are your only options
[06:26:08] <strcat> it's not really as impressive as loop vectorization but it's an all around win
[06:26:42] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:27:00] <jeaye> dbaupp: Is this due to my shitty design, or Rust's lack of support?
[06:27:19] <jeaye> In fairness, I'm still designing things as if this were C++ (which hurts me too often).
[06:27:34] <dbaupp> jeaye: it'd be unsafe to have & and &mut to the same data at the stame time, so Rust's lack of support
[06:27:46] *** Quits: diverse (Mibbit@moz-601F0275.static.mtpk.ca.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[06:27:47] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[06:27:48] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:27:48] <dbaupp> (well, Rust's explicit banning.)
[06:28:19] <jeaye> Oh, I didn't know that was considered unsafe for a single task.
[06:29:22] <strcat> let a = &mut x; let b = &x.y[0]; a.y.clear(); *b
[06:29:44] <dbaupp> strcat: you need a `// kaboom` :P
[06:30:21] <jeaye> heh
[06:30:56] <sfackler> it'd be nice if rust allowed multiple mutable references to the same exact address
[06:31:02] <sfackler> unless there are safety problems with that as well
[06:31:05] <garthk> Let me guess: 0.8-pre is a bad idea because the implementation is changing faster than the documentation? :)
[06:31:43] <dbaupp> sfackler: &mut is (almost) a subtype of &, so the same thing is possible
[06:31:58] <dbaupp> (i think...)
[06:32:31] <dbaupp> garthk: nope, master is better: bugs are fixed, libraries are written, things are improved.
[06:33:00] <strcat> documentation is improved.
[06:33:08] <strcat> and people here will actually be able to answer your questions ;p
[06:33:17] <sfackler> dbaupp: but if you have something like this, I don't see what you can do to a that would cause safety issues with b:
[06:33:21] <dbaupp> garthk: (you don't have to keep 100% up-to-date though; updating every few weeks is perfectly alright)
[06:33:38] <sfackler> let mut a = &mut x; let mut b = &mut x; // do things with a and b
[06:33:39] <garthk> dbaupp strcat: ok. So, any short tips on how to properly do this? https://github.com/mozilla/rust/wiki/Doc-reading-and-writing-files
[06:34:03] <dbaupp> sfackler: ah, exactly the same thing... I don't know.. it'd break the nice aliasing rules the &mut currently has
[06:34:12] <jeaye> Ah, @mut doesn't allow borrowed pointers
[06:34:16] <dbaupp> (i.e. the don't alias)
[06:34:36] <jeaye> Which means I'm being sucked back into @mut land!
[06:34:41] <sp3d> wouldn't that make it impossible to turn an &mut into an & though?
[06:34:49] <sp3d> (in the general case)
[06:34:49] <dbaupp> jeaye: :(
[06:34:52] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[06:34:52] <dbaupp> sp3d: no?
[06:35:03] <sp3d> you can't have &mut and & to the same place at once
[06:35:10] <strcat> garthk: well, you probably don't want to look at an out-of-date wiki page about it ;p
[06:35:12] <sp3d> so you couldn't have two &muts and downgrade one to an &
[06:35:25] <Eridius> you can't have two &muts at the same thing at once either
[06:35:27] <pepper_chico> is there a vague idea of release date for Rust 1.0?
[06:35:39] <sp3d> Eridius: that was what was suggested
[06:35:41] <dbaupp> sp3d: oh, you're saing if you have to &mut's to the same place?
[06:35:45] <sp3d> yeah
[06:35:56] <Eridius> &mut can't alias with anything
[06:36:00] <strcat> pepper_chico: not really, just guesses
[06:36:00] <dbaupp> yeah, I'd believe that would be a consequence
[06:36:04] <garthk> Strikes me that if you're building a lot of code around result, the more idiomatic way will be something like do file_reader(path) |reader| { Ok(try_to_read_and_parse_xml(reader)) } ?
[06:36:21] <pepper_chico> strcat, what guess, just to have an idea
[06:36:37] <garthk> strcat: well, the community probably doesn't want to leave around out-of-date wiki pages to confuse newcomers :)
[06:36:45] <strcat> well what does 1.0 mean to you? other than being a number
[06:37:21] <pepper_chico> less language changes
[06:37:31] *** Quits: andrew-d (andrew@moz-F84C8FD7.hm.shawcable.net) (Client exited)
[06:37:36] <dbaupp> garthk: `match std::io::file_reader(&Path("path/to/thing")) { Err(e) => printfln!("Couldn't open file: %s", e), Ok(reader) { reader.read_things() } }` 
[06:37:46] <dbaupp> *Ok(reader) => { .. }
[06:37:52] <strcat> pepper_chico: well there are much fewer language changes now than 4-6 months ago
[06:38:09] <dbaupp> strcat: but there's still a pile of big ones to come
[06:38:19] <strcat> not necessarily
[06:38:25] <strcat> closures, ideally
[06:38:30] <dbaupp> pcwalton's path one
[06:38:42] <pepper_chico> well, it generally means an official stable point for the language
[06:39:00] <dbaupp> strcat: moving @ to libraries
[06:39:16] <garthk> dbaupp: cheers.
[06:39:30] <geomyidae> http://dominik.honnef.co/go-tip/2013-08-23/#slicing
[06:39:38] <geomyidae> that makes it sound like a lot of work to avoid gc, no?
[06:40:00] <geomyidae> (I say this as I'm writing Go in the other window) :P
[06:40:25] <pepper_chico> anyone here's already codes it with completion?
[06:40:52] <pepper_chico> I use Vim by the wayâ€¦ can do it with Go already =)
[06:41:29] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[06:41:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Ijaj-A
[06:41:29] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[06:41:30] <strcat> geomyidae: well it *is* a lot of work to avoid performance issues from gc in java or go
[06:41:49] <strcat> you end up doing lower-level stuff than a custom allocator in C++
[06:41:54] <brson> it's possible that the language itself will be done this year. stabilizing the libraries and tools will be a longer-term process. i think that sometime in 2014 people will be able to start using a subset of the system with confidence (backed by validation and testing) that it won't change. i hope that sometime this year we will have a roadmap with some firm plans about how it's going to work. it's not clear what rust 1.0 means yet though
[06:42:14] <Eridius> hrm, I haven't paid attention to Go changes since 1.0
[06:42:41] <geomyidae> brson: I'm easily more excited about Rust at the point it's in now than I was in Go back then
[06:43:22] <Eridius> brson: I would hope that "rust 1.0" means any code that compiles with 1.0 will continue to compile with all 1.x releases
[06:44:22] <dbaupp> Eridius: that's easy, just bump to 2.0 for the next release. (Presumably some measure of support is in there too?)
[06:44:22] <bjz> Eridius: that is the plan I believe
[06:45:23] <myname> dbaupp: you are evil
[06:45:38] <geomyidae> ha
[06:46:07] <strcat> Eridius: well if your code depends on the stdlib, that definitely won't be true
[06:46:26] <dbaupp> myname: :'(
[06:46:28] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:46:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hi_QNQ
[06:46:28] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:46:29] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:46:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Athoiw
[06:46:30] <ghrust> 13rust/06auto 143a56ab2 15Alex Crichton: Correctly encode item visibility in metadata...
[06:46:30] <ghrust> 13rust/06auto 1462e3994 15bors: auto merge of #8365 : alexcrichton/rust/correct-item-visibility, r=pcwalton...
[06:46:30] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:47:27] * bjz listens as dbaupp's evil cackles echo across the Australian countryside
[06:47:55] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[06:47:58] * dbaupp cackles *very* loudly
[06:48:09] <bjz> dbaupp: I can hear you all the way in Melbourne!
[06:48:14] <jeaye> rusti: fn f(s: &str, fun: &fn()) { fun(); } do f("fun") || { }
[06:48:14] -rusti- <anon>:5:14: 5:15 warning: unused variable: `s` [-W unused-variable (default)]
[06:48:14] -rusti- <anon>:5          fn f(s: &str, fun: &fn()) { fun(); } do f("fun") || { }
[06:48:15] -rusti-                        ^
[06:48:15] -rusti- ()
[06:48:21] <bjz> dbaupp: you evil old sod
[06:48:43] <dbaupp> rusti: fn f(_: &str, fun: &fn()) { fun(); } do f("fun") { } // jeaye
[06:48:44] -rusti- ()
[06:48:56] <dbaupp> rusti: fn f(fun: &fn()) { fun(); } do f { } // jeaye
[06:48:57] -rusti- ()
[06:49:06] <dbaupp> all sorts of sugar!
[06:49:11] <pepper_chico> cool, there's a bot here, good sign, I think the guys at #go-nuts don't have one yet
[06:49:38] <jeaye> Right. I just wanted to check the syntax if there's a param before the function. Looks like that's nicely covered. :)
[06:49:43] <bjz> pepper_chico: a pretty hacky one that strcat cooked up. It's pretty damn cool though
[06:50:02] <bjz> pepper_chico: nice for showing stuff and testing thingies
[06:50:07] <pepper_chico> cool =)
[06:50:12] <strcat> bjz: the backend isn't hacky ;p
[06:50:13] <bjz> pepper_chico: also for annoying irssi users
[06:50:19] <bjz> strcat: ;)
[06:50:27] <jeaye> bjz: Why's that?
[06:50:27] * bjz pokes strcat
[06:50:32] <pepper_chico> good job strcat 
[06:50:49] <myname> bjz: i don't find it annoying at all
[06:50:57] <Eridius> bjz: I use irssi no problem
[06:51:04] <dbaupp> strcat: no, it doesn't fill the channel with the backtrace of a crashing webservice ever. :P
[06:51:06] *** Quits: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP) (Ping timeout)
[06:51:09] <jeaye> Give weechat some love <3
[06:51:14] <bjz> jeaye: apparently irssi alerts users when notices pop up, contrary to the irc spec
[06:51:20] <dbaupp> irccloud was the one that handles it bad, apparently.
[06:51:23] <jeaye> ohh
[06:51:23] <bjz> jeaye: by default that is
[06:51:28] <jeaye> haha
[06:51:36] <mm> pfft, who needs a client for irc?  It's easy to talk over netcat.
[06:51:41] <pepper_chico> I'm in the process of building rust for testing itâ€¦ long process
[06:51:48] <jeaye> mm: Type PING a lot, do you?
[06:51:56] <mm> jeaye: once every 500 seconds ;)
[06:51:59] <strcat> pepper_chico: also, http://strcat.zapto.org:8000/
[06:52:01] <bjz> jeaye: notices are used so that we can't get bots in loops :(
[06:52:02] <jeaye> pong, rather
[06:52:08] <myname> bjz: so, i get an action at a channel where the bot write stuff, but i'll get it nontheless because a user must have written code to the bot first
[06:52:13] <dbaupp> mm has mapped caps-lock to PONG :P
[06:52:25] <jeaye> hahaha
[06:52:26] <bjz> myname: ?
[06:52:31] <mm> dbaupp: haha.
[06:52:33] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[06:52:36] <pepper_chico> strcat, cool
[06:52:43] <bjz> myname: don't really understand
[06:52:51] <myname> bjz: i don't get what you mean with "it allerts users"
[06:53:02] <myname> it does not produce a highlight
[06:53:18] <dbaupp> strcat: is there a timeframe for try.rust-lang.org?
[06:53:33] <bjz> cmr: piiingy
[06:53:35] <strcat> dbaupp: not really
[06:53:40] <bjz> jeaye: beep
[06:53:47] <jeaye> bjz: boop
[06:53:54] <bjz> jeaye: barrp
[06:53:57] * myname votes for porting ruby warrior to rust ;p
[06:54:00] <jeaye> bjz: burp?
[06:54:06] <bjz> jeaye: gurgle
[06:54:15] <bjz> jeaye: gl-rs seems to work
[06:54:16] <garthk> Heh. Still foxed. This is as basic an app as can be â€” take someone else's XML library and time how long it takes to parse a file â€” and I'm having to wade around trying to get it to compile an hour later. :)
[06:54:18] <strcat> dbaupp: if I had access to some server to host it on, sure, tommorow ;p
[06:54:21] <jeaye> bjz: nice!
[06:54:22] *** Joins: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it)
[06:54:27] * dbaupp nominates myname to port
[06:54:33] <jeaye> bjz: Is 'unsafe' still needed everywhere?
[06:54:34] <Luqman> bjz: awesome!
[06:54:42] <myname> dbaupp: all that js :(
[06:54:45] *** Joins: Samulus (sam@moz-5F5BB3BB.phnx.qwest.net)
[06:54:47] <bjz> jeaye: compiling gl_ptr takes ages though
[06:55:03] <garthk> It's fun for the time being, but eventually I'm going to get sick of feeling stupid and resort to C++ where there's greater likelihood the various sources of help agree on what the language looks like. 
[06:55:05] <dbaupp> strcat: I heard that mozilla had some webservers... possibly a rumour :P
[06:55:07] <bjz> jeaye: I need a way of restricting what extensions get generated by default
[06:55:17] <dbaupp> strcat: (I thought graydon was keen-ish on such a site?)
[06:55:26] <bjz> jeaye: atm it does *the whole spec*
[06:55:35] <strcat> dbaupp: yes but I don't think even graydon can make them conjure up some server for it ;p
[06:55:36] <bjz> jeaye: 1.5 mb file
[06:55:43] <jeaye> hah
[06:55:48] <dbaupp> strcat: :(
[06:55:53] <strcat> dbaupp: + graydon has lots of stuff to deal with
[06:55:55] <bjz> jeaye: but it seems to work
[06:55:59] *** Quits: ChrisMorgan (chris@moz-AAEDD935.its.monash.edu.au) (Ping timeout)
[06:56:11] <bjz> jeaye: could you help with a nicer example?
[06:56:35] <bjz> jeaye: atm I just set the background to grey :P
[06:56:46] <jeaye> bjz: Sure, I can this weekend.
[06:56:52] <bjz> jeaye: sweet
[06:57:05] <bjz> jeaye: maybe just a rotating triangle or something
[06:57:11] <garthk> Ok(reader) => parseAll(reader)â€¦ so, what's the signature of parseAll? fn parseAll(reader: &Reader) parses, but then when I try let xml = reader.read_c_str(); I get error: failed to find an implementation of trait std::io::Reader for &std::io::Reader<no-bounds>.
[06:57:13] <jeaye> yup
[06:57:39] <dbaupp> strcat: yeah, he does seem to do a lot of cat herding & buildbot fighting.
[06:57:51] <dbaupp> garthk: reader: @Reader
[06:57:54] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[06:58:23] <garthk> Well, bugger me. I was one character away. 
[06:59:27] <garthk> Aah, makes sense: if I'm only creating one and using it once, there's no performance harm likely from GC. Cool. Any other reference types work for that?
[07:00:25] <dbaupp> it's actually a bug that it uses @
[07:00:46] <dbaupp> the new io library uses &mut Reader
[07:01:16] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[07:01:25] <garthk> Ok, I waded through that XML at a majestic 3.7MB/s. 
[07:01:38] <dbaupp> in Rust?
[07:02:22] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[07:02:22] <garthk> dbaupp: yes, but using lib sax. 
[07:02:22] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[07:02:22] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:02:22] <dbaupp> rust's old io is currently very slow, btw.
[07:02:22] <garthk> dbaupp: I *am* timing both the read and the parse, and assuming the parse is the big bit. 
[07:02:34] <dbaupp> you should check :P
[07:03:43] *** Joins: cmr (moznet@moz-EC676DFE.members.linode.com)
[07:04:34] <garthk> dbaupp: any equivalent of V8's process.hrtime() hiding in std:: I can use? 
[07:05:00] <dbaupp> garthk: extra::time might have something
[07:05:02] <garthk> strcat: --opt-level 3 shaved 10% off the job time
[07:05:23] <dbaupp> garthk: but the "standard" procedure is to just comment out the parsing bit :P
[07:05:40] <garthk> Hahhaha oh, that should have occurred to me.
[07:06:09] *** Joins: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au)
[07:07:11] <garthk> Wow. Reading takes ~6s of the ~21s run time. 
[07:08:02] <garthk> You're right: it's slow. Still only wading through the XML itself at 6MB/s, though. Aah, well.
[07:08:53] *** Joins: squiddy (squiddy@moz-1E8AEB3B.adsl.alicedsl.de)
[07:10:09] *** Quits: wilkie (wilkie@moz-A435EAAD.pitbpa.fios.verizon.net) (Ping timeout)
[07:10:12] <bjz> jeaye: well even though it has to load so many pointers at runtime I don't experience any lag at startup, which is interesting
[07:10:59] <dbaupp> garthk: are you using master, or 0.7?
[07:11:07] <garthk> master.
[07:11:14] <dbaupp> how recent?
[07:11:38] <dbaupp> because the new file io lib landed like 8 hours ago, so you could try that.
[07:11:41] <garthk> dbaupp: today.
[07:11:57] <dbaupp> std::rt::io::<stuff I need to look up>
[07:12:02] <garthk> garthk: â€¦ but maybe not *that* today. :)
[07:12:24] <garthk> rebuildingâ€¦
[07:12:30] <garthk> gist here: https://gist.github.com/5533f2f45b78cc2b0061
[07:13:38] *** Joins: wilkie (wilkie@moz-A435EAAD.pitbpa.fios.verizon.net)
[07:16:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:16:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1462e3994 to 140688bde: 02http://git.io/N3iJvQ
[07:16:32] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:17:28] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[07:17:39] <dbaupp> garthk: https://gist.github.com/huonw/6406a26f8a0af9f6397b might work... but I don't have a new enough rust to test.
[07:18:32] <garthk> Okâ€¦ std::rt::io::open(&Path("BIGXML")â€¦ it unpacks the result itself and throws exceptions on failureâ€¦ we get a FileStream back but still have to unwrap itâ€¦ am I misreading that? Strikes me I should either get a result, or an unwrapped result or an exception. Or am I mis-treating unwrap as being related to the Promise-like behavior of Result when it's really about pointer boxing?
[07:19:57] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[07:19:59] <dbaupp> yeah, it returns an Option<FileStream> (the Ok(reader), should be Some(reader))
[07:20:21] <garthk>     match open_result {
[07:20:21] <garthk>         Ok(fd) => Some(FileStream {
[07:20:31] <dbaupp> hm?
[07:20:43] <dbaupp> oh, in the source
[07:20:46] <garthk> in src/libstd/rt/io/file.rs.
[07:21:27] <dbaupp> yeah; I don't think the exact design of the io error handling has been fleshed out yet.
[07:22:40] <garthk> It's the match on Err(ioerr) throwing an exception that I don't get. Why wrap the returned FileStream in a Some if there's no way we can return a None?
[07:23:03] * dbaupp doesn't know
[07:23:05] <garthk> Seems it's straddling two different API design styles, yeah. 
[07:23:54] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[07:24:44] <garthk> Anyhow, better duck out now. Thanks for the help. Rust still strikes me as a lot of fun, but I over-estimated its maturity and under-estimated the challenge getting up to speed in it. It's a loooong way from the "hey, look, another Algol-style language!" exercise I've been used to switching around between Python, C#, and JavaScript. Good luck!
[07:27:04] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[07:28:13] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Ping timeout)
[07:29:18] *** Joins: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[07:29:56] *** Quits: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:30:13] *** Joins: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr)
[07:32:54] *** Quits: KindOne (KindOne@moz-49B9C261.dynamic.ip.windstream.net) (Ping timeout)
[07:33:14] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[07:34:55] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[07:35:59] *** Joins: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de)
[07:36:26] *** Quits: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de) (Max SendQ exceeded)
[07:36:49] *** Joins: KindOne (KindOne@moz-2785EAD1.dynamic.ip.windstream.net)
[07:37:45] *** Joins: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de)
[07:40:01] *** Joins: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se)
[07:40:57] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:42:39] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Connection reset by peer)
[07:42:40] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Write error: Connection reset by peer)
[07:43:21] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[07:46:44] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[07:49:00] *** Quits: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[07:50:54] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[07:52:51] *** Quits: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr) (Ping timeout)
[07:59:30] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[07:59:37] *** Joins: squiddy_ (squiddy@moz-B3299262.adsl.alicedsl.de)
[07:59:54] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[08:00:34] *** Quits: squiddy (squiddy@moz-1E8AEB3B.adsl.alicedsl.de) (Ping timeout)
[08:02:14] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:02:54] *** Quits: Samulus (sam@moz-5F5BB3BB.phnx.qwest.net) (Quit: WeeChat 0.4.1)
[08:03:14] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[08:03:29] *** Joins: sebcrozet (sebcrozet@moz-2517AE39.w80-13.abo.wanadoo.fr)
[08:03:54] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:09:13] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[08:09:23] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[08:09:41] *** Quits: KindOne (KindOne@moz-2785EAD1.dynamic.ip.windstream.net) (Ping timeout)
[08:12:32] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[08:13:29] *** Joins: KindOne (KindOne@moz-2785EAD1.dynamic.ip.windstream.net)
[08:16:51] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:18:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[08:19:47] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:20:46] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[08:21:37] *** Joins: mr_trousers (Mibbit@moz-6AB2F112.jptransit.net)
[08:25:12] *** Quits: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:25:26] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[08:26:29] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:26:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/G_pL7g
[08:26:29] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:27:40] *** Joins: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de)
[08:30:39] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:30:40] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[08:30:57] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:30:57] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Connection reset by peer)
[08:31:28] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:31:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PPzjEQ
[08:31:28] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:31:28] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[08:31:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/HjLcAw
[08:31:28] <ghrust> 13rust/06auto 1477df8b8 15Do Nhat Minh: removed os::set_args, closing #8325...
[08:31:28] <ghrust> 13rust/06auto 14db55cd9 15bors: auto merge of #8681 : mrordinaire/rust/remove-set_args, r=brson
[08:31:29] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[08:31:35] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:32:27] *** Quits: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:33:46] *** Joins: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de)
[08:35:28] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[08:40:29] <Eridius> garthk: finally had the time to experiment with the XML parser myself
[08:40:50] <Eridius> garthk: I get about 27MBps on my machine. But if I throw in a bufio.Reader, and set the size to 128MB, it jumps up to 49MBps
[08:40:59] <Eridius> a 4MB buffer didn't make any difference
[08:41:10] <Eridius> I don't know where the breakpoint is, but buffering does certainly work if you buffer enough
[08:41:18] <Eridius> and with that it's time for bed
[08:42:20] <Eridius> although I also only read part of the file (Exited early after reading enough elements, so I guess I don't know if the speed increase sticks)
[08:42:23] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[08:42:56] <Eridius> doubled the number of elements to read, speed dropped slightly to 47MBps, but that's still pretty good
[08:43:06] *** Joins: lmandel (lmandel@moz-BE33DA21.fw1.sfo1.mozilla.net)
[08:45:20] *** Quits: lmandel (lmandel@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: lmandel)
[08:53:25] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[08:53:43] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[08:54:49] *** Joins: gavinb (gavinb@518E7EF5.8B575785.C98315F2.IP)
[08:55:20] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[08:58:40] *** Quits: Liothen (liothen@moz-80EF0CD7.spkn.qwest.net) (Quit: Textual IRC Client: www.textualapp.com)
[08:58:59] <gavinb> Looking at the example in the std::rand documentation (at the top), why is it necessary to "use std::rand::RngUtil;" in addition to the module itself? I've seen this in a number of places.  And the error message you get without it is not entirely useful.
[09:00:04] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[09:00:48] <Seldaek> gavinb: because traits must be in scope to use their methods
[09:00:58] <Seldaek> for obscure but valid reasons  I forgot :)
[09:01:34] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[09:01:34] <gavinb> But there is already a "use std::rand"â€¦
[09:02:08] <Seldaek> well if you'd use std::rand::* it would probably work with just that, but then you're importing too much stuff and risk running into other issues
[09:02:44] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Ping timeout)
[09:02:58] <gavinb> The error you get without the extra 'use' is:  error: type `std::rand::IsaacRng` does not implement any method in scope named `gen`
[09:03:52] <gavinb> But there's nothing to suggest that the reason is because it needs rand::RngUtil imported into the "top" level.
[09:04:04] <Seldaek> yes, because the impl of a trait only exists once you import the trait. it's weird I agree but IIRC it's to prevent conflicts
[09:04:16] <gavinb> I've noticed this in numerous places, and it's quite confusing. Maybe I just don't understand "use" properly.
[09:04:26] <dbaupp> gavinb: iirc, there's a bug open about making the error message better 
[09:04:30] <gavinb> Wait, what??
[09:05:20] <gavinb> Seldaek: so "use std::rand" doesn't import any impls?
[09:05:41] *** Quits: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au) (Client exited)
[09:05:52] <gavinb> What does it import then - only public structs and fns?
[09:06:02] <dbaupp> gavinb: it's not the impls that are relevant, it's the trait. but yes, the actual trait name has to be in scope
[09:06:07] <dbaupp> unqualified
[09:06:40] <gavinb> that "unqualified" part is important, methinks
[09:06:45] <dbaupp> yes
[09:06:55] <gavinb> It kinda feels like the compiler knows it's there, but doesn't want to let on. What a tease...
[09:07:03] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:07:22] <dbaupp> good error messages are tricky
[09:07:25] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[09:07:29] <Seldaek> gavinb: I didn't know a use of std::rand was enough to get the functions imported
[09:07:34] <gavinb> dbaupp: amen, brother!
[09:08:06] <dbaupp> (especially when they require diving through various resolve/privacy/blahblah to workout if there is a trait with that method that *could* be imported.)
[09:08:07] <gavinb> Crap, train arriving - must away!
[09:08:13] <gavinb> thanks guys, will have to catch you later!
[09:08:15] *** Quits: gavinb (gavinb@518E7EF5.8B575785.C98315F2.IP) (Quit: gavinb)
[09:08:30] <bjz> cmr: hoy hoy hoy
[09:08:47] * bjz wonders if cmr is asleep
[09:10:31] <dbaupp> bjz: yes; I think he'll be up in a few hours
[09:10:41] <bjz> dbaupp: american?
[09:11:34] * bjz gets confused with the method visibility stuff
[09:13:16] <dbaupp> bjz: yeah, but wakes up very early
[09:18:45] *** Quits: victorporof (victorporo@F2782203.A485B230.9B1E38F4.IP) (Ping timeout)
[09:18:59] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Quit: eatkinson)
[09:19:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:19:10] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[09:20:11] *** Quits: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de) (Quit: Leaving.)
[09:20:48] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:21:05] *** Joins: victorporof_ (victorporo@F2782203.A485B230.9B1E38F4.IP)
[09:23:08] *** Joins: mindcat (mindcat@27373DB7.2AF6B358.291A146C.IP)
[09:23:15] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[09:24:24] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[09:24:26] *** Quits: mr_trousers (Mibbit@moz-6AB2F112.jptransit.net) (Quit: http://www.mibbit.com ajax IRC Client)
[09:24:46] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[09:27:53] <mindcat> rusti: let a = || println("I am come back!");
[09:27:55] -rusti- <anon>:5:13: 5:14 warning: unused variable: `a` [-W unused-variable (default)]
[09:27:55] -rusti- <anon>:5          let a = || println("I am come back!");
[09:27:55] -rusti-                       ^
[09:27:55] -rusti- ()
[09:28:01] <mindcat> rusti: let a = || println("I am come back!");a()
[09:28:02] -rusti- I am come back!
[09:28:02] -rusti- ()
[09:28:33] <mindcat> rusti: "I am come back!"
[09:28:34] -rusti- "I am come back!"
[09:28:38] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[09:28:51] <mindcat> :p
[09:29:30] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[09:29:52] <mindcat> rusti: "what I talk about?"
[09:29:53] -rusti- "what I talk about?"
[09:31:34] <mindcat> rusti: "I was talk about you"
[09:31:35] -rusti- "I was talk about you"
[09:32:50] <mindcat> rusti: "follow me, read this:"
[09:32:51] -rusti- "follow me, read this:"
[09:33:16] <mindcat> rusti: "I am foo, bar."
[09:33:17] -rusti- "I am foo, bar."
[09:33:22] <mindcat> :p
[09:33:28] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[09:34:19] <Seldaek> I guess I'm an idiot, but this used to work: fn foo(stream: &mut TcpStream) { stream.read_byte(); }
[09:34:31] <Seldaek> now I get error: type `&mut std::rt::io::net::tcp::TcpStream` does not implement any method in scope named `read_byte`
[09:34:50] <Seldaek> and I do have a use std::rt::io::{Listener, Reader, ReaderUtil, Writer};
[09:35:24] <mindcat> rusti: fn foo(stream:  &mut TcpStream) { stream.read_byte(); 
[09:35:25] -rusti- <anon>:8:0: 8:1 error: file ended with unbalanced delimiters
[09:35:25] -rusti- <anon>:8 }
[09:35:25] -rusti-          ^
[09:35:25] -rusti- application terminated with error code 101
[09:35:32] <bjz> Seldaek: it would seem that that method has either been removed, or you need to bring an apprpriate trait into scope
[09:36:33] <bjz> (that's what the error means)
[09:36:50] <bjz> (don't know anything about std::rt::io::net
[09:36:52] <bjz> )
[09:37:48] <mindcat> rusti: use core::*;
[09:37:54] -rusti- pastebinned 8 lines of output: http://ix.io/7vJ
[09:38:09] <bjz> Seldaek: have you tried importing ReaderUtil?
[09:38:22] <bjz> Seldaek: from std::rt::io?
[09:38:51] <bjz> Seldaek: it seems to have a read_byte method on it
[09:39:23] *** Joins: mib3kj (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP)
[09:39:38] <Seldaek> bjz: it's in use std::rt::io::{Listener, Reader, ReaderUtil, Writer};
[09:39:51] <mib3kj> Hi, I'm facing build errors on windows related to jemalloc
[09:40:27] <mindcat> rusti: use std::_;
[09:40:27] -rusti- <anon>:5:18: 5:19 error: expected `;` but found `_`
[09:40:27] -rusti- <anon>:5          use std::_;
[09:40:27] -rusti-                            ^
[09:40:28] -rusti- application terminated with error code 101
[09:41:03] *** Quits: victorporof_ (victorporo@F2782203.A485B230.9B1E38F4.IP) (Quit: victorporof_)
[09:41:27] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[09:41:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/HjLcAw
[09:41:28] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[09:42:00] <bjz> mindcat: what are you trying to do?
[09:42:07] <mib3kj> I'm getting the error jemalloc.c:1858:6: error: 'ptr' undeclared (first use in this function) when i build on win32 using build
[09:42:28] <mib3kj> Is there a configure option to disable jemalloc?
[09:42:35] <mindcat> well, I was try to learn Scala, but it is too complicated for me.
[09:42:59] *** Joins: maik (maik___@moz-BEACDBF.dip0.t-ipconnect.de)
[09:43:34] <bjz> mindcat: sorry, just wondering if I could help you, rather than having you bash your head against a brick wall :P
[09:43:56] <bjz> maik: I have a super basic example for gl-rs!
[09:44:19] <maik> bjz, nice !
[09:44:47] <maik> bjz, you should remove the first sentence then :)
[09:44:48] <bjz> maik: basically just sets the bacground grey
[09:44:50] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[09:44:57] <bjz> ohhhh
[09:45:03] <bjz> yes
[09:45:48] <mindcat> bjz: in Scala, "import" they wont use "*", it is "_".
[09:46:16] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[09:46:27] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:46:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/daGFIQ
[09:46:27] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:46:30] <mindcat> bjz: so why I am try "use std::_;" :D
[09:47:16] <bjz> mindcat: well in Rust it's *
[09:47:32] <bjz> mindcat: the compiler doesn't know Scala!
[09:47:34] <bjz> :D
[09:47:38] <mindcat> bjz: :D
[09:48:59] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[09:49:05] <maik> bjz, have you uploaded the example somewhere :)?
[09:49:14] <bjz> maik: to gl-rs
[09:49:25] <maik> bjz, ah
[09:49:41] <mib3kj> whats the configure option for enabling debug! output for rustc?
[09:49:48] <bjz> https://github.com/bjz/gl-rs/blob/master/examples/ptr_example.rs
[09:49:48] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Max SendQ exceeded)
[09:49:57] <bjz> maik: ^
[09:50:17] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[09:50:28] *** Quits: KindOne (KindOne@moz-2785EAD1.dynamic.ip.windstream.net) (Ping timeout)
[09:50:57] <bjz> maik: I need to do a more complex one with VAOs, but it'll do for now
[09:52:27] <bjz> maik: basically just shows that it can load fnptrs without failing
[09:54:17] <maik> bjz, hehe yeah it works
[09:54:28] <maik> bjz, I do a more complex example now
[09:54:42] *** Joins: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es)
[09:55:02] *** Joins: KindOne (KindOne@moz-15EAEF3A.dynamic.ip.windstream.net)
[09:55:19] <toqueteos> guys i have trouble using "rust run file.rs"
[09:56:06] <toqueteos> it yells me libstdc++-6.dll is missing, i have tdm-gcc x64 installed
[09:56:25] <nmatsakis> pnkfelix: I may have been wrong about fn walk<V:Visitor> vs fn walk(&Visitor)
[09:56:49] <pnkfelix> nmatsakis: in what sense?  In the sense that the former may not be better?
[09:56:54] *** Quits: KindOne (KindOne@moz-15EAEF3A.dynamic.ip.windstream.net) (Ping timeout)
[09:57:03] <pnkfelix> nmatsakis: (e.g. because it has mucho code duplication?)
[09:57:09] <nmatsakis> basically yes
[09:57:15] <nmatsakis> I tried however a branch with the latter
[09:57:23] <nmatsakis> I have it compiling,
[09:57:25] <nmatsakis> but it crashes
[09:57:39] <nmatsakis> I haven't been able to isolate the bug yet
[09:57:52] <maik> bjz, do you use os x?
[09:57:57] *** Joins: KindOne (KindOne@moz-15EAEF3A.dynamic.ip.windstream.net)
[09:57:59] <bjz> aye
[09:58:20] <nmatsakis> pnkfelix: also, it's SO painful to use objects since we do not yet auto-coerce (though we are supposed to, one of those Not Yet Implemented things)
[09:58:51] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[09:58:57] <nmatsakis> pnkfelix: the other side of the story, of course, is that if our "avoid code dup" logic were working,
[09:59:04] <nmatsakis> pnkfelix: well no never mind
[09:59:11] <nmatsakis> pnkfelix: this is not a case where it would kick in
[09:59:31] <pnkfelix> nmatsakis: there might be a way to refactor things so that it could kick in more often
[09:59:39] <pnkfelix> nmatsakis: but maybe not in a clean/safe way
[10:00:13] <bjz> nmatsakis: it woooorks!
[10:00:16] *** Joins: relistan__ (relistan@A7E4EF66.4C1F25E9.4BA0249.IP)
[10:00:20] <bjz> nmatsakis: yaaaaayayaa
[10:00:31] * bjz hugs nmatsakis
[10:00:35] <pnkfelix> nmatsakis: I guess since we're supposed to be focusing on speeding up bors turnaround times, I should perhaps spend some time thinking about this.
[10:00:40] *** Quits: fabiand (fabiand@moz-B73D92D4.adsl.alicedsl.de) (Quit: Verlassend)
[10:00:42] *** Quits: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP) (Quit: klapaucius)
[10:01:07] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[10:01:13] <bjz> nmatsakis: thankyouthankyouthankyouareamazing
[10:01:28] <pnkfelix> Hmm.  I just read the recent changes to Note-getting-started-developing-Rust
[10:01:54] <pnkfelix> I'm not too thrilled about having official advice being to do "sudo make check"
[10:02:05] * mindcat use hot iron poke bjz.
[10:02:15] <bjz> `ooch
[10:02:19] <mindcat> :p
[10:02:24] <bjz> whhy?
[10:02:38] <pnkfelix> (it does explain *why* its advising running as root, but still...)
[10:02:59] <nmatsakis> bjz: woohoo!
[10:03:02] <nmatsakis> pnkfelix: sudo make check??
[10:03:13] * nmatsakis wouldn't do that, and I KNOW that's in the makefiles
[10:03:38] <bjz> nmatsakis: well, all I have is a grey screen atm, but that means it works
[10:03:45] <nmatsakis> pnkfelix: I don't think there's any thinking to be done per se? in particular, using objcets is whta you're supposed to do to reduce dup
[10:03:57] <nmatsakis> pnkfelix: as I said, I have the work done, in a branch
[10:04:05] <nmatsakis> pnkfelix: it compiles and passes stage0, but it crashes in stage1
[10:04:06] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[10:04:11] <pnkfelix> nmatsakis: 'sudo make check' : https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust#osx
[10:04:14] <nmatsakis> pnkfelix: if you want to look into the CRASH well... :)
[10:04:31] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[10:05:02] <pnkfelix> nmatsakis: well, does your solution involve switching all the Visitors over to yet another interface?
[10:05:05] <nmatsakis> pnkfelix: I see. nonetheless, I'd agree it should say "make check # or sudo make check without reboot, see above"
[10:05:09] <nmatsakis> pnkfelix: no, the interface doens't change at all
[10:05:31] <pnkfelix> nmatsakis: or is it something where it uses <V:Visitor> foo(&V, â€¦), but &Visitor is one of the potential V's for V:Visitor ?
[10:05:32] <nmatsakis> pnkfelix: it would be worth the effort to gradually wean the visitors from using the E parameter 
[10:05:38] <nmatsakis> pnkfelix: no not that either
[10:05:43] <nmatsakis> pnkfelix: I can send you the diff
[10:05:50] <pnkfelix> nmatsakis: or just push your branch to github
[10:05:58] <pnkfelix> nmatsakis: whichever is easiest.
[10:06:38] <nmatsakis> that's actually whta I meant by "send a diff" :)
[10:06:48] <pnkfelix> nmatsakis: Regarding the `sudo make check`, I think I'm going to delete the "In summary: â€¦" part
[10:06:54] <nmatsakis> pnkfelix: https://github.com/nikomatsakis/rust/tree/issue-XXX-use-visitor-objects
[10:07:03] <pnkfelix> nmatsakis: because I don't want us to be even suggesting `sudo make check` anywhere explicitly.
[10:07:14] <nmatsakis> yeah
[10:07:20] <pnkfelix> nmatsakis: let someone who knows enough to do that come up with it themself.
[10:07:33] <nmatsakis> there was once a bug with the windows installer that caused it to delete a bunch of random stuff
[10:07:36] <nmatsakis> iirc
[10:07:46] <maik> bjz, how do I make a void ptr?
[10:07:57] <bjz> maik: where?
[10:07:58] <nmatsakis> pnkfelix: in particular: https://github.com/nikomatsakis/rust/commit/92c2646831aa71760f87bd9f9df492bdebcb52b0
[10:08:34] <nmatsakis> pnkfelix: basically I changed the walk methods to take an &mut Visitor. this won't avoid ALL code dup, because we will still generate the fns per visitor that invoke the walk fns, but I'd like to measure its effect before we do anything else.
[10:08:53] <maik> bjz, ah nvm I can just use 0
[10:09:08] <bjz> maik: what are you trying to do?
[10:09:16] <nmatsakis> pnkfelix: the more we can avoid using the <E> parameter the better; many of the visitors are already ported to use visitor<()> but some are not. in many cases it'd be quite trivial to do so, though -- use the "context" object as the visitor 
[10:09:25] <maik> bjz, I am porting your triangle example
[10:09:27] <pnkfelix> nmatsakis: yes I know
[10:09:28] <bjz> maik: you can do std::ptr::null()?
[10:09:34] <nmatsakis> pnkfelix: I figured you know that yes :)
[10:09:50] <pnkfelix> nmatsakis: I was just trying to make the recipe of the mechanical refactoring totally apparent.
[10:09:54] <maik> bjz, in what namespace is prt::null()?
[10:10:06] <nmatsakis> pnkfelix: if we did the "auto-objectification" we've talked about, all those annoying walk_foo(self as &mut Visitor<()>, ...) edits would not be necessary
[10:10:07] <bjz> std
[10:10:21] <nmatsakis> pnkfelix: in fact doing precisely this kind of change was one of the major motivations...
[10:10:28] <nmatsakis> but anyhow
[10:10:40] <pnkfelix> nmatsakis: and also, there are invocations of env.clone() during the walking at various points, and I was not 100% sure if any of those were actually relevant, and/or would break if you tried to shift the context from E to the visitor
[10:10:58] <maik> bjz, oh yeah it works
[10:11:36] <nmatsakis> pnkfelix: I ... think it'd work fine at least in 99%, there may be one or two that would be more difficult
[10:11:54] <nmatsakis> pnkfelix: some of them may use a context and a bool flag or something, you could push the bool flag into the context
[10:11:55] <pnkfelix> nmatsakis: Sure.  99% of the cases the Env object is trivial.
[10:12:09] <pnkfelix> nmatsakis: (or almost trivial)
[10:12:25] <nmatsakis> we don't have to elim the E parameter entirely
[10:12:30] <nmatsakis> if it's convenient here or there
[10:13:27] <pnkfelix> nmatsakis: well, I guess the thing to do is actually determine if it ever *does* need to be separate (the 1% cases), and if so, document what purpose the E parameter is meant to serve in general.
[10:13:44] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[10:13:44] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Input/output error)
[10:15:17] *** Quits: relistan__ (relistan@A7E4EF66.4C1F25E9.4BA0249.IP) (Quit: relistan__)
[10:16:04] <nmatsakis> pnkfelix: well, it's .. not uncommon for visitors to be parameterized by an "argument" type
[10:16:22] <nmatsakis> pnkfelix: at least my standard Java visitor was Visitor<A,R> where A is argument and R is return
[10:16:27] <nmatsakis> :)
[10:16:38] <pnkfelix> nmatsakis: maybe the clearer way for me to say this
[10:16:40] <nmatsakis> there are cases where it's nicer to pass an argument around than to keep an internal stack
[10:16:47] <pnkfelix> nmatsakis: I don't want people to have to read the source for visit.rs
[10:17:00] <pnkfelix> nmatsakis: to be able to predict when E's clone() method is going to be invoked.
[10:17:31] <nmatsakis> hmm. ok.
[10:17:35] <nmatsakis> I mean I'm not against documentation
[10:17:47] <nmatsakis> (and perhaps renaming E to ARG or something)
[10:17:50] <pnkfelix> nmatsakis: its possible that there's no replacement for reading the source
[10:17:58] <nmatsakis> but I think they will have to read the source if they care precisely how many times or where clone is called
[10:18:08] <nmatsakis> but I think if you care about that,
[10:18:09] <nmatsakis> you're doing it wrong
[10:18:41] <nmatsakis> but anyway, this is all a "for future discussion" sort of thing
[10:18:45] <pnkfelix> nmatsakis: yep
[10:18:49] <nmatsakis> main question is: why does that branch crash?
[10:18:57] <nmatsakis> it does seem to work somewhat
[10:19:03] <nmatsakis> it dies in the freevars visitor
[10:19:21] <nmatsakis> that's about as far as I got...
[10:19:32] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:19:36] <nmatsakis> I tried to reproduce the same pattern with a small test case, 
[10:19:38] <nmatsakis> but of course that worked fine
[10:19:39] <pnkfelix> nmatsakis: well, in your opinion, what is more important:
[10:19:51] <pnkfelix> nmatsakis: Finishing porting from oldvisit to <V:Visit>
[10:20:06] <pnkfelix> nmatsakis: or switching to looking at this branch, investingating this crash?
[10:20:16] <nmatsakis> mm I'd say the crash
[10:20:23] <pnkfelix> nmatsakis: I imagine the latter being more important.  Okay.
[10:20:24] <nmatsakis> the remaining ports aren't going anywhere
[10:20:53] <nmatsakis> I guess the best thing to do is just to make clean and build with SAVE_TEMPS=1
[10:21:02] <nmatsakis> and then examine the emitted bitcode
[10:21:06] <nmatsakis> something may pop out
[10:21:12] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[10:21:30] <pnkfelix> nmatsakis: that reminds me
[10:21:39] <doomlord> did lifetimes usedto be written as &/a  .. did that cause problems
[10:21:43] <nmatsakis> that's usually my strategy in these sorts of cases, it...sometimes pays off :)
[10:21:48] <nmatsakis> lifetimes used to be written &a/Foo
[10:21:54] <nmatsakis> doomlord: ^
[10:21:57] <pnkfelix> nmatsakis: is the output from SAVE_TEMPS=1 the kind of thing that one can pass to some LLVM tool to generate object code ?
[10:22:06] <nmatsakis> pnkfelix: yes. it's a .bc file
[10:22:16] <nmatsakis> pnkfelix: you can generate code from it
[10:22:17] <doomlord> ok so those presumably made the grammar more complex
[10:22:38] <pnkfelix> nmatsakis: which LLVM tool can be used to turn .bc into object files or executables ?
[10:23:12] <nmatsakis> doomlord: somewhat, yes. it was also hard to read. 
[10:23:36] <pnkfelix> nmatsakis: (I'll google for it.  llvm-ld may be what I want)
[10:23:52] <doomlord> i wondered if &/a Foo  could be a 'unary /' much like * has unary and binary use , but does that make the grammar just as complex
[10:23:57] <nmatsakis> pnkfelix: I think llc
[10:24:15] <nmatsakis> doomlord: conceivably, why?
[10:24:43] <nmatsakis> doomlord: I mean, we're not changing the lifetime syntax -- but if it's just idle speculation, yes :)
[10:24:45] <doomlord> i wondered if there were other  options compatable with 'text' 
[10:24:58] <nmatsakis> 'a is not incompatible
[10:25:19] <nmatsakis> just requires a bit of lookahead to differentiate
[10:25:28] <doomlord> ok sure
[10:25:44] * nmatsakis shrugs
[10:25:46] <nmatsakis> I guess we could have done `a
[10:25:52] <nmatsakis> but thta's incompatible with markdown :)
[10:26:03] <doomlord> yeah backticks are hard to read aswell
[10:26:43] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:26:46] <doomlord> 'a is more readable than /a 
[10:28:56] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[10:29:24] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:29:43] <bjz> ^^^^
[10:29:46] <bjz> :)
[10:29:55] <bjz> pointies
[10:30:00] <bjz> ^a
[10:30:11] * bjz is happy with 'a
[10:30:11] *** Quits: mib3kj (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:30:19] <doomlord> unary ^ ?
[10:30:27] <doomlord> &^a Foo
[10:31:04] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[10:31:17] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[10:31:17] <doomlord> the reason i bring it up is text editors which might default to assuming both "..." and '...' are literal text
[10:31:36] <maik> how do I convert a str to *i8?
[10:31:43] <doomlord> although i realise there are other languages that use ' for something other than text (haskell )
[10:31:53] <doomlord> so its not a problem unique to rust
[10:32:11] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[10:32:13] *** Joins: sigma (sigma@moz-95EFA844.range109-151.btcentralplus.com)
[10:32:38] <bjz> maik: .to_c_str().with_ref
[10:32:50] <dbaupp> maik: with_c_str is a shortcut too.
[10:33:02] <bjz> dbaupp: ooh? we have that now?
[10:33:26] <dbaupp> bjz: iirc, yes
[10:33:47] <bjz> dbaupp: seems to be right
[10:33:50] * dbaupp doesn't like the hidden allocation
[10:34:30] <maik> rusti: ~"pos".with_c_str()
[10:34:36] -rusti- pastebinned 9 lines of output: http://ix.io/7vM
[10:34:58] <dbaupp> rusti: do "pos".with_c_str |ptr| { printfln!(ptr) }
[10:35:00] -rusti- 139765957668952
[10:35:00] -rusti- ()
[10:35:01] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[10:35:05] <maik> rusti: ~"pos".to_c_str().with_ref()
[10:35:07] -rusti- pastebinned 9 lines of output: http://ix.io/7vN
[10:35:11] <maik> ah 
[10:35:32] <dbaupp> btw, the with_ prefix generally means a closure
[10:35:46] <maik> do "pos".with_c_str |ptr| { ptr }
[10:35:53] <maik> rusti: do "pos".with_c_str |ptr| { ptr }
[10:35:54] -rusti- 140079049879640
[10:36:07] <maik> dbaupp, didn't know that, thanks.
[10:37:21] <bjz> dbaupp: needs to be `.with_to_c_str` ;)
[10:38:03] <dbaupp> maik: also, returning the ptr from the closure like that is a recipe for segfaults
[10:38:18] <bjz> yep
[10:38:23] <bjz> (
[10:38:39] <dbaupp> rusti: let ptr = "pos".with_c_str(|p|p); unsafe {*ptr}
[10:38:39] * bjz has experience
[10:38:40] -rusti- 112
[10:38:48] <dbaupp> :( it didn't crash
[10:39:06] <bjz> dbaupp: it's a bit of a random bug
[10:39:17] <bjz> sometimnes it happens, sometimes it doesn't
[10:39:19] <dbaupp> rusti: let ptr = {"p".repeat(1000000).with_c_str(|p|p)}; unsafe {*ptr}
[10:39:20] -rusti- 0
[10:39:30] <nmatsakis> pnkfelix: huh. looking at the disassembly of the crash, it looks like gibberish to me...
[10:40:45] <nmatsakis> in particular it includes these lines:
[10:40:45] <nmatsakis>    0xb674c538 <+1736>:  mov    -0x1a0(%ebp),%ecx
[10:40:45] <nmatsakis>    0xb674c53e <+1742>:  call   *%ecx
[10:40:46] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[10:40:58] <nmatsakis> the crash occurs at +1742 -- but I see no other mention of 0x1a0 anywhere
[10:41:39] <nmatsakis> which makes me wonder if we are generating code with undefined semantics or something that's being mangled by the optimizer
[10:42:11] * nmatsakis frowns
[10:42:26] <nmatsakis> https://gist.github.com/nikomatsakis/6317927 if anyone is curious
[10:42:59] <dbaupp> ChrisMorgan: nice rebase :P
[10:43:17] <ChrisMorgan> dbaupp: yep, just about to send about it to rust-dev
[10:43:30] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[10:43:45] <ChrisMorgan> As the rebase wasn't clean (one lang item removed), I pushed it.
[10:43:47] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[10:44:35] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:45:24] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:47:42] <maik> bjz, got the first triangle :D
[10:47:55] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bbl)
[10:48:01] <maik> \o/
[10:50:18] <bjz> \o/
[10:50:32] <maik> bjz, https://gist.github.com/MaikKlein/6317991
[10:50:51] <bjz> maik: working on lmath
[10:50:55] <maik> bjz, nice
[10:51:39] <bjz> heyy, you did no cleanup
[10:52:42] <maik> bjz, I am a little bit confused by line
[10:52:47] <maik> bjz, 83 btw
[10:53:01] <maik> bjz, I had to do FALSE as u8
[10:53:18] <SimonSapin> Ok, I now have my rustc infinite loop in gdb. It seems to be actually infinite recursion: 3000+ stack frames and growing
[10:53:41] <maik> bjz, otherwise I get "error: mismatched types: expected `u8` but found `u32` (expected u8 but found u32)"
[10:53:48] *** Quits: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es) (Quit: http://www.mibbit.com ajax IRC Client)
[10:54:45] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[10:54:50] <maik> bjz, oh you mean in lmath? :( I fixed all for loops but there were those weird trait errors that I couldn't understand
[10:55:02] <bjz> maik: no, in the gist
[10:55:35] <maik> bjz, ah ups
[10:55:46] <maik> compile and forget :D
[10:56:25] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[10:56:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/B0tZdg
[10:56:26] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[10:57:12] <bjz> maik: also, could you use the gl:: prefix on the fns?
[10:57:27] <bjz> that's what I'd encourage as best practice
[10:57:29] *** Quits: KindOne (KindOne@moz-15EAEF3A.dynamic.ip.windstream.net) (Ping timeout)
[10:59:35] <maik> bjz, ofc I just wanted it to compile as quickly as possible
[10:59:37] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:59:39] <dbaupp> SimonSapin: those are always fun :(
[10:59:56] <SimonSapin> dbaupp: what can I do? just file an issue?
[11:00:20] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:00:36] <dbaupp> SimonSapin: that's better than doing nothing, yes.
[11:00:49] <dbaupp> SimonSapin: what's the stack trace look like?
[11:01:25] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[11:01:25] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ze1z8A
[11:01:25] <ghrust> 13rust/06auto 149721732 15Keegan McAllister: doc: Fix transmute example
[11:01:25] <ghrust> 13rust/06auto 14f5018c5 15bors: auto merge of #8686 : kmcallister/rust/doc, r=catamorphism
[11:01:25] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[11:01:26] <bjz> maik: np :)
[11:01:29] *** Joins: KindOne (KindOne@moz-4C41B9B9.dynamic.ip.windstream.net)
[11:01:44] *** Joins: fyolnish (fyolnish@moz-6CC3B8A3.uqwimax.jp)
[11:02:05] <SimonSapin> dbaupp: http://pastebin.mozilla.org/2903107
[11:03:09] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[11:04:24] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[11:04:49] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Ping timeout)
[11:05:35] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[11:06:08] <maik> bjz, should be better https://gist.github.com/MaikKlein/6318088
[11:06:32] <maik> bjz, damnit forgot to make the shader static
[11:07:06] <dbaupp> SimonSapin: hm, nothing obvious; file a bug I guess
[11:07:37] <bjz> maik: I would use gl::types::*
[11:08:15] *** zz_kimundi is now known as kimundi
[11:08:22] <bjz> maik: re: GL_FALSE, C defines are super weird
[11:08:24] <SimonSapin> dbaupp: unfortunately I donâ€™t have a smaller test case than "that branch of servo"
[11:09:08] <bjz> maik: I think GL uses the booleans in some places where it wants a GLenum, others where it wants a GLboolean
[11:09:10] <dbaupp> SimonSapin: yeah, better than nothing
[11:09:51] <dbaupp> SimonSapin: (I think pcwalton is working in that area, fwiw.)
[11:10:18] <SimonSapin> dbaupp: Iâ€™ll try rust master first
[11:10:45] <maik> bjz, that's weird
[11:11:00] <pnkfelix> nmatsakis: ping
[11:11:40] <bjz> maik: because C can coerce the
[11:11:51] <bjz> #define GL_FALSE 0
[11:11:54] <maik> bjz, @ gl::types I used everything explicitly because it is an example program, so that the readers know which are types
[11:11:55] <bjz> to whatever
[11:12:03] <bjz> mm
[11:12:38] <maik> bjz, where does it want an enum?
[11:12:38] <bjz> I'm not sure what to do about GL_FALSE/TRUE
[11:12:59] <bjz> in other functions I think
[11:13:48] *** Quits: Jontte (joonas@moz-8B229CD6.la) (Ping timeout)
[11:13:52] <nmatsakis> pnkfelix: pong
[11:13:56] <bjz> maik: https://github.com/haskell-opengl/OpenGLRaw/issues/15
[11:14:04] <pnkfelix> nmatsakis: I'm looking at https://github.com/mozilla/rust/issues/6399 (for triage)
[11:14:32] <pnkfelix> nmatsakis: Is this the "right" pattern for passing an &mut self linearly:
[11:14:35] <bjz> maik: I knew I'd get a Haskell post at the top of google
[11:14:36] *** Joins: Jontte (joonas@moz-8B229CD6.la)
[11:14:42] <bjz> maik: ie. for: "type of GL_TRUE"
[11:14:46] <pnkfelix> nmatsakis: pub fn sched_mode<'a>(&'a mut self, mode: SchedMode) -> &'a mut TaskBuilder { â€¦ ; self }
[11:15:22] <pnkfelix> nmatsakis: The previous version was: pub fn sched_mode(&mut self, mode: SchedMode) { â€¦ } ; 
[11:15:48] <pnkfelix> nmatsakis: and the version I put up seems wordier than I'd like; the explicit <'a> parameter seems unfortunate.
[11:15:55] <nmatsakis> pnkfelix: seems reasonable
[11:16:16] <pnkfelix> nmatsakis: i.e. would it make sense to be able to write: 
[11:16:31] *** Quits: maik (maik___@moz-BEACDBF.dip0.t-ipconnect.de) (Ping timeout)
[11:16:31] <pnkfelix> nmatsakis: pub fn sched_mode(&mut self, mode: SchedMode) -> &mut Self { â€¦ ; self }
[11:17:08] <pnkfelix> nmatsakis: (noting that this is a struct's impl, not a trait impl)
[11:17:28] <pnkfelix> nmatsakis: (and so currently Self is not available for use in a type expression)
[11:17:32] <nmatsakis> it's been proposed
[11:17:42] <nmatsakis> but you'd still need the <'a>
[11:18:00] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[11:18:06] <pnkfelix> nmatsakis: The fact I'm passing back Self wouldn't suffice to tell rustc that the lifetimes must match ?
[11:18:23] <pnkfelix> nmatsakis: I guess Self doesn't denote the "must be same object" ...
[11:18:32] <pnkfelix> nmatsakis: only "must be same type"
[11:19:06] <pnkfelix> nmatsakis: So okay, I guess I'll just put the <'a>, that was the main thing I was trying to avoid.
[11:19:39] <nmatsakis> there could also be rules for the default region i a return type
[11:19:52] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[11:20:34] <pnkfelix> nmatsakis: eh, I don't mind this so much.
[11:21:18] <pnkfelix> nmatsakis: maybe its a mistake to be optimizing for this pattern anyway
[11:21:33] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[11:21:42] <pnkfelix> (I know its a popular programming pattern in OOP, but that doesn't mean its right for Rust in general...)
[11:21:43] *** Joins: jaen (jaen@FB01674D.56B727FE.4B52F012.IP)
[11:22:29] <dbaupp> does `task::sched_mode(Foo);` cancel the &mut borrow there, or does it remain borrowed to the end of the block?
[11:22:56] <nmatsakis> pnkfelix: it still won't work well
[11:22:59] <nmatsakis> pnkfelix: right now
[11:23:07] <nmatsakis> pnkfelix: because of a limitation in the lifetime of rvalues
[11:23:20] <nmatsakis> pnkfelix: I forget the relevant issue #
[11:23:28] <nmatsakis> gotta go bbl
[11:23:28] <SimonSapin> should RUST_LOG=rustc enable debug!() in everything below src/librustc?
[11:23:30] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[11:23:32] <dbaupp> rusti: struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } let mut x = Foo; x.test().test(); let y = &x;
[11:23:33] -rusti- <anon>:5:122: 5:123 warning: unused variable: `y` [-W unused-variable (default)]
[11:23:34] -rusti- <anon>:5          struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } let mut x = Foo; x.test().test(); let y = &x;
[11:23:34] <pnkfelix> nmatsakis: which, putting in `pub fn sched_mode<'a>(&'a mut self, mode SchedMode) -> &'a mut TaskBuilder { â€¦ ; self } ?
[11:23:34] -rusti-                                                                                                                                    ^
[11:23:34] -rusti- ()
[11:23:57] <pnkfelix> nmatsakis: you already had a note in the original isue poiunting to #5967, but that is now closed
[11:23:57] <dbaupp> SimonSapin: you'll need to build rustc with --cfg debug / configure with --enable debug
[11:25:06] <SimonSapin> I thought I did, but I must have gotten something wrong
[11:25:51] <dbaupp> SimonSapin: oh, you might need RUST_LOG=rustc=4
[11:25:51] <SimonSapin> dbaupp: do I need both?
[11:26:05] <dbaupp> SimonSapin: no, the latter sets the former
[11:26:47] <dbaupp> SimonSapin: I guess that RUST_LOG=rustc::metadata=4 will give more managable output
[11:27:47] <SimonSapin> still not getting any output at the moment
[11:28:10] * dbaupp does know
[11:28:13] <dbaupp> *doesn't
[11:30:11] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[11:30:30] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[11:30:45] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[11:32:40] <nmatsakis> pnkfelix: you'll find you can't chain more than one or two calls...
[11:33:37] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[11:34:44] <dbaupp> rusti: struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } let mut x = Foo; x.test().test().test().test().test();
[11:34:45] -rusti- ()
[11:34:55] <dbaupp> rusti: struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } Foo.test().test().test().test().test();
[11:34:56] -rusti- <anon>:5:84: 5:87 error: cannot borrow immutable static item as mutable
[11:34:56] -rusti- <anon>:5          struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } Foo.test().test().test().test().test();
[11:34:57] -rusti-                                                                                              ^~~
[11:34:57] -rusti- error: aborting due to previous error
[11:34:57] -rusti- application terminated with error code 101
[11:35:10] <dbaupp> rusti: struct Foo; impl Foo { fn test<'a>(&'a mut self) -> &'a mut Foo { self } } ({ Foo }).test().test().test().test().test();
[11:35:13] -rusti- pastebinned 11 lines of output: http://ix.io/7vQ
[11:36:01] *** Joins: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de)
[11:36:31] <pnkfelix> nmatsakis: okay, well, feel free to add more relevant info to the ticket, as you like.  I feel like its not clear whether jack's goal is to be able to again write the exact same code the way it was before, or if he'd be okay with some extra constraints (such as the ones that I presume dbaupp was implicitly illustrating just nowâ€¦)
[11:37:19] *** Joins: maik (maik___@moz-5B638D21.dip0.t-ipconnect.de)
[11:37:35] <pnkfelix> Usually I like to have a go at fixing the "simple" bugs I encounter during triage, but I guess if I don't grok the full picture and/or motivation/goal, then it may be a fool's errand on my part.
[11:38:26] <pnkfelix> (at the time that Servo used its previous pattern, I think the TaskBuilder code was just making a fresh copy of the structure on every call, and I suspect no one wants to go back to that.)
[11:38:58] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[11:39:12] *** Joins: sk (sk@5FD88F96.77870B72.78DD174B.IP)
[11:39:40] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Ping timeout)
[11:40:15] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[11:41:07] *** Joins: mytym (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP)
[11:41:36] <mytym> how do i enable debug! output for rustc ?
[11:42:26] <dbaupp> mytym: you need to configure with --enable-debug
[11:42:47] <dbaupp> and then RUST_LOG=rustc::relevant::module=4
[11:43:01] <mytym> dbaupp: thanks
[11:43:54] <dbaupp> mytym: that is, re-./configure, rebuild and then run with RUST_LOG=... rustc foo.rs
[11:44:05] <SimonSapin> dbaupp: https://github.com/mozilla/rust/issues/8707 , fwiw
[11:46:35] *** Joins: Ms2ger (Ms2ger@moz-590E79FE.adsl-dyn.isp.belgacom.be)
[11:47:38] <dbaupp> SimonSapin: how about importing that code in a separate crate? (rather than just importing in servo)
[11:48:17] *** Joins: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[11:49:49] <SimonSapin> dbaupp: this code will have a dependency cycle with other stuff in the script crate, so it kind of has to be there
[11:50:27] <Ms2ger> Yay, dependency cycles :)
[11:51:26] <mytym> dbaupp: is it possible to disable jemalloc on win32
[11:51:40] <SimonSapin> actually Iâ€™m not sure itâ€™s quite a cycle, if we move stuff out of the script crate
[11:51:55] <dbaupp> SimonSapin: oh... so you can't test importing it (since it appears to be in that part of rustc) entirely independently of servo?
[11:52:06] <dbaupp> mytym: no idea :(
[11:54:56] <mytym> i'm facing build errors related to jemalloc...possibly related https://github.com/mozilla/rust/issues/8662 
[11:55:13] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[11:56:34] <Seldaek> mytym: I built on windows this morning it went fine I think
[11:57:00] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[11:57:48] <Seldaek> I'm having a weird compiler issue now though but I doubt that'd be related to jemalloc
[11:58:43] <mytym> Seladaek: i'm trying to build from master...should i use a different branch?
[12:00:03] <Seldaek> mytym: nope master is good
[12:00:50] <Seldaek> mytym: but anyway most/all core devs are on linux/osx so windows issues can crop up
[12:02:20] <mytym> Seladaek: oh..ok, i guess i'll have to wait a couple of days then
[12:03:38] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[12:05:12] <Seldaek> mytym: I can send you my build if you like
[12:05:20] <Seldaek> in case you're stuck..
[12:05:57] <dbaupp> in theory the buildbots should catch all the big windows bugs; but clearly they don't :(
[12:06:49] <mytym> Seldaek: thank you so much, but i do have a linux enivronment...hopefully that will build fine
[12:07:18] <Seldaek> mytym: ok that works too then, yeah I haven't had any issues building on linux
[12:08:28] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[12:08:36] <mytym> Seldaek: if is it possible, could you tell me which commit you based your build on?
[12:08:56] <Seldaek> 063a005459a3ece4022e1fdb6400548c7ad2358e
[12:09:16] <mytym> Seldaek: thanks, i'll see if i can spot the issue
[12:11:23] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:11:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ze1z8A
[12:11:23] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:11:52] <Seldaek> mytym: I'm using mingw/msys btw, not a full cygwin 
[12:12:18] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[12:12:28] <mytym> Seladaek:yup, i'm using mingw too
[12:16:11] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[12:16:24] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:16:24] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/zOf1WA
[12:16:24] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:16:25] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[12:16:25] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Ryu-Tg
[12:16:25] <ghrust> 13rust/06auto 14a909144 15Eric Reed: Moved .sleep() to Timer.
[12:16:25] <ghrust> 13rust/06auto 144edf375 15bors: auto merge of #8691 : anasazi/rust/fix-timer-interface, r=brson...
[12:16:25] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[12:20:12] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[12:21:38] *** Quits: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Ping timeout)
[12:21:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[12:22:45] *** Joins: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com)
[12:23:40] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[12:27:41] *** Quits: KindOne (KindOne@moz-4C41B9B9.dynamic.ip.windstream.net) (Ping timeout)
[12:27:41] *** Joins: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es)
[12:27:44] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[12:27:53] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[12:31:35] *** Joins: KindOne (KindOne@735F8E04.C538DA2.EC6A1518.IP)
[12:35:51] *** Quits: mytym (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:42:56] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[12:46:39] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[12:47:14] *** Quits: maik (maik___@moz-5B638D21.dip0.t-ipconnect.de) (Ping timeout)
[12:47:34] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[12:48:50] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[12:49:35] *** Joins: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de)
[12:51:18] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[12:52:22] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[12:53:48] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[12:54:26] *** Quits: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es) (Quit: http://www.mibbit.com ajax IRC Client)
[12:59:56] *** Joins: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es)
[13:01:26] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[13:03:13] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[13:06:22] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[13:08:58] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[13:11:33] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[13:12:02] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[13:14:09] *** Joins: jdm (jdm@97DF0582.DEAB171B.971E19F6.IP)
[13:14:11] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[13:15:43] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[13:18:31] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[13:18:42] *** Quits: toqueteos (Mibbit@moz-19D95D0D.dynamic.jazztel.es) (Quit: http://www.mibbit.com ajax IRC Client)
[13:19:09] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[13:19:48] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[13:20:33] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[13:22:13] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[13:26:20] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[13:26:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Ryu-Tg
[13:26:20] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[13:27:05] *** Joins: AndroUser (androirc@moz-AFACA29.dab.02.net)
[13:28:41] *** Quits: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de) (Ping timeout)
[13:30:41] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[13:33:03] *** Quits: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[13:33:09] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[13:37:01] *** Quits: AndroUser (androirc@moz-AFACA29.dab.02.net) (Ping timeout)
[13:38:16] <pnkfelix> very weirdâ€¦ I keep pushing branches to my account on github via git on cmd line, and the push claims to succeed but I don't see any change to the branches via the github web interface...
[13:38:38] <hoelzro> caching issues?
[13:39:14] <pnkfelix> maybe â€¦ ?  I guess I'll try a different brower
[13:39:44] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[13:39:46] <pnkfelix> nope, still no sign...
[13:40:08] <klutzy> github sometimes does such behaviour
[13:40:16] *** Joins: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de)
[13:40:34] <hoelzro> git remote show origin may also help a bit
[13:40:35] *** Joins: jviereck1 (Adium@moz-187603FF.dip0.t-ipconnect.de)
[13:40:39] *** Quits: jviereck (Adium@moz-AF73A9F4.dip0.t-ipconnect.de) (Ping timeout)
[13:40:45] <pnkfelix> well, I can see the new branches when I fetch down from github to other clones
[13:40:55] <pnkfelix> so I can be reasonably certain the data made it up there
[13:41:25] <klutzy> yes, web pages are lying :)
[13:42:05] <klutzy> maybe it occurs if I push too frequently I guess
[13:42:12] <maik> can I tell rustc to always look in /usr/local/lib for libs? it's annoying to always add the path with -L
[13:46:27] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:49:11] <dbaupp> maik: alias rustc='rustc -L/usr/local/lib'
[13:49:47] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:49:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/S2WezA
[13:49:47] <ghrust> 13rust/06auto 14fe1beac 15Kevin Ballard: Update FFI tutorial to reference `c_str::to_c_str`...
[13:49:47] <ghrust> 13rust/06auto 14943f9aa 15bors: auto merge of #8692 : kballard/rust/ffi-tutorial-c_str, r=huonw...
[13:49:48] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:50:06] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[13:50:44] *** Joins: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP)
[13:56:08] <maik> dbaupp, thanks!
[13:56:37] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:57:57] *** Joins: victorporof (victorporo@F2782203.A485B230.9B1E38F4.IP)
[13:58:45] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[14:00:24] <pnkfelix> nmatsakis: FYI it is not obvious what the restrictions are on chainingâ€¦ I had thought dbaupp demonstrated (much like my micro unit tests) that one can chain arbitrarily, at least simple casesâ€¦
[14:01:48] <nmatsakis> pnkfelix: You are correct, it is not obvious. The reason for this is that the borrowck rules are bsaically making a best effort to approximate the behavior of trans, and the trans behavior is quite random and unplanned.
[14:02:00] <nmatsakis> pnkfelix: it introduces new temporary scopes willy nilly
[14:02:08] <pnkfelix> okay
[14:02:12] <nmatsakis> pnkfelix: and temporary values are always freed in the innermost temporary scope
[14:02:29] <nmatsakis> pnkfelix: fixing trans to handle temporaries better is basically #3511
[14:02:38] <nmatsakis> though there are other aspects to it
[14:02:46] <pnkfelix> so the issue is that one might find one's code suddenly stops working inexplicably.  Okay.
[14:03:03] <pnkfelix> (but that's not a reason to block the change in the PR I just posted, I guess.)
[14:03:24] <nmatsakis> certainly we could add the &mut self pattern
[14:03:28] <nmatsakis> "builder" pattern
[14:03:35] <nmatsakis> it just may not yet be as useful as you would hope
[14:03:56] <pnkfelix> that's okay, I continue to be unconvinced that it's that useful in Rust anyway
[14:03:58] <nmatsakis> maybe we should just add a cascade operator like smalltalk
[14:04:02] * nmatsakis joking
[14:04:07] * nmatsakis mostly
[14:04:15] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:04:19] <pnkfelix> e.g. I don't think you can't swap in constructing a fresh object
[14:04:22] <nmatsakis> I kind of dislike the builder pattern, though I can't deny it's attractive in its own time
[14:04:26] <pnkfelix> the way you can in purely GC'ed languages.
[14:04:30] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[14:04:35] <nmatsakis> or rather in its own way
[14:04:50] <nmatsakis> well, you could if you did:
[14:04:56] <nmatsakis> fn foo(self, ...) -> Self
[14:05:11] <nmatsakis> though it might get expensive copying all that data around
[14:05:20] <nmatsakis> or of course fn(@self) -> @Self
[14:05:31] <nmatsakis> (using Self as a shorthand here for the appropriate type)
[14:05:34] <pnkfelix> right, but those aren't taking &mut self ...
[14:05:40] <nmatsakis> no, they are not :)
[14:06:13] <pnkfelix> My goal, if I cared about this, would be to come up with some way to express this operator
[14:06:37] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[14:06:38] <pnkfelix> (bad word, "operator" â€¦ try instead "pattern", "protocol", etc)
[14:07:03] <pnkfelix> well, actually never mind
[14:09:02] *** Joins: mibitzi_ (mibitzi@794A2CC1.60DF3A09.8395810B.IP)
[14:09:05] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:09:16] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[14:09:59] <pnkfelix> (I've decided there's no way to avoid the coupling between the choice of the builder method being imperative or pure-copying, and the choice of whether the passed state is ~allocated or @allocated or borrowed.)
[14:10:13] <pnkfelix> (that was what I was hoping to come up with some way to avoid.)
[14:10:26] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Input/output error)
[14:10:55] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[14:11:08] <nmatsakis> Yeah, this is always the Rust "dilemna" ?
[14:11:10] <nmatsakis> that one must choose
[14:11:20] <nmatsakis> of course you are "choosing" when you use a purely GC'd language too,
[14:11:24] <nmatsakis> it's just that you made your choice when you chose the language
[14:11:46] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:11:50] *** Quits: squiddy_ (squiddy@moz-B3299262.adsl.alicedsl.de) (Input/output error)
[14:12:17] *** Quits: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de) (Connection reset by peer)
[14:12:29] <pnkfelix> yeah, I occasionally forget how deep the decision needs to go
[14:13:29] *** Joins: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de)
[14:14:27] <olsonjeffery> nmatsakis: im curious, has anyone ever suggested the idea of a "POD kind" for types?
[14:14:34] <olsonjeffery> or is there anything like it?
[14:14:41] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[14:15:03] <nmatsakis> olsonjeffery: it has been suggested
[14:15:11] <nmatsakis> olsonjeffery: I've always assumed we'll add it sooner or later
[14:15:28] <nmatsakis> olsonjeffery: it would allow some useful optimizations
[14:15:32] <olsonjeffery> yeah.
[14:15:55] <olsonjeffery> seems like it could back a guarantee for some kind of MISD facilities
[14:16:24] *** Quits: sigma (sigma@moz-95EFA844.range109-151.btcentralplus.com) (Ping timeout)
[14:16:31] <olsonjeffery> anyways. neat.
[14:18:11] *** Quits: jaen (jaen@FB01674D.56B727FE.4B52F012.IP) (Ping timeout)
[14:18:53] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Input/output error)
[14:18:57] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[14:19:23] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:19:53] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[14:20:53] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:22:33] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:23:02] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[14:24:04] *** Quits: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de) (Ping timeout)
[14:24:42] <nsf> http://togototo.wordpress.com/2013/08/23/benchmarks-round-two-parallel-go-rust-d-scala-and-nimrod/
[14:25:00] <nsf> hehe, rust is performing well indeed
[14:26:30] <nsf> the most surprising result to me is the difference between C++ and C
[14:27:29] <nsf> probably a bad benchmark
[14:28:30] * dbaupp wishes Port was an iterator.
[14:29:10] <dbaupp> let biggest_lev = port.iter().max_by(|lev| lev.rooms.len()).unwrap();
[14:29:20] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[14:29:55] <dbaupp> (also, this person did the thing where they wrote manual while loops instead of using range. again. :( )
[14:31:08] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[14:31:32] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:33:28] *** Joins: andrew-d_ (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:34:58] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[14:35:22] *** Joins: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de)
[14:37:00] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:40:44] <SimonSapin> dbaupp: Port as an iterator should be easy to add, right?
[14:41:09] <dbaupp> SimonSapin: should be yes; next() == try_recv()
[14:41:13] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Quit: ZNC - http://znc.in)
[14:41:17] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[14:41:22] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[14:41:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/S2WezA
[14:41:23] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[14:41:40] <engla> rusti: let (p, c) = std::comm::stream::<int>(); c.send(1); c.send(2); std::iterator::Unfoldr::new(p, |pref| pref.try_recv()).next()
[14:41:42] -rusti- Some(1)
[14:42:13] <SimonSapin> If fact, I wish there was a generic way to make iterators from function/methods that return Option
[14:42:14] * dbaupp really thinks someone should go and rename Unfoldr to just Unfold
[14:42:31] <engla> speaking of that SimonSapin.. :-)
[14:42:33] <dbaupp> SimonSapin: ^ Unfoldr
[14:42:40] <SimonSapin> oh
[14:43:55] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:44:02] <SimonSapin> interesting
[14:44:36] <dbaupp> rusti: let (p, c) = std::comm::stream(); c.send(1); c.send(2); for x in std::iterator::Unfoldr::new(p, |pref| pref.try_recv()) { printfln!(x) }
[14:44:37] -rusti- 1
[14:44:37] -rusti- 2
[14:44:46] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[14:44:53] <engla> I think it's blocking
[14:45:19] <dbaupp> it is
[14:45:28] <maik> why does it block?
[14:45:36] <maik> I don't see it
[14:45:38] <dbaupp> oh, i see what you eman
[14:45:48] <engla> rusti: let (p, c) = std::comm::stream::<int>(); c.send(1); c.send(2); std::util::ignore(c); let mut it = std::iterator::Unfoldr::new(p, |pref| pref.try_recv()); (it.next(), it.next(), it.next())
[14:45:48] * dbaupp misinterpreted
[14:45:50] -rusti- (Some(1), Some(2), None)
[14:45:51] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Input/output error)
[14:46:04] <engla> have to close the channel to reach None
[14:46:21] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[14:46:22] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hEvDSg
[14:46:22] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:46:22] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[14:46:22] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/xHckxA
[14:46:22] <ghrust> 13rust/06auto 148c09e2b 15Michael Woerister: debuginfo: Big cleanup refactoring and support for foreign_item_fn.
[14:46:22] <ghrust> 13rust/06auto 140e8a640 15Michael Woerister: debuginfo: Improved handling of function preludes.
[14:46:23] <ghrust> 13rust/06auto 14f8c4f0e 15bors: auto merge of #8684 : michaelwoerister/rust/stepping_and_scope_fixes, r=jdm...
[14:46:23] <dbaupp> maik: there should be a () after the 1 2 (hence it's blocking)
[14:46:25] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[14:47:16] <dbaupp> and... it's using essentially 0 cputime, so at some point the future rusti is just going to pop up with a random "computation timed out" message
[14:47:18] <dbaupp> heh
[14:47:28] <dbaupp> *in the future
[14:48:04] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Client exited)
[14:48:40] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:49:23] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[14:49:41] <engla> next feature-let
[14:49:43] <engla> rusti: let (p, c) = std::comm::stream::<int>(); c.send(1); c.send(2); std::util::ignore(c); let mut it = std::iterator::Unfoldr::new(p, |pref| pref.try_recv()); (it.next(), it.next(), it.next(), it.next())
[14:49:44] -rusti- task <unnamed> failed at 'attempt to take an empty cell', /build/rust-git/src/rust/src/libstd/cell.rs:47
[14:49:44] -rusti- application terminated with error code 101
[14:50:25] <dbaupp> woah?
[14:50:49] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[14:50:51] <engla> it's a known issue
[14:51:00] <dbaupp> rusti: let (p,_) = std::comm::stream::<int>(); p.try_recv(); p.try_recv();
[14:51:01] <engla> can't call try_recv more than once
[14:51:04] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[14:51:18] * dbaupp think he did the blocking thing again :/
[14:51:21] <engla> heh after it ends
[14:51:53] <engla> slowly DoS-ing strcat
[14:52:30] <SimonSapin> is std::util::ignore(c) the same as let _ = c?
[14:52:41] <dbaupp> SimonSapin: in theory yes
[14:52:59] <dbaupp> rusti: let (p,c) = std::comm::stream::<int>(); std::util::ignore(c); p.try_recv(); p.try_recv();
[14:53:02] -rusti- task <unnamed> failed at 'attempt to take an empty cell', /build/rust-git/src/rust/src/libstd/cell.rs:47
[14:53:02] -rusti- application terminated with error code 101
[14:53:10] <dbaupp> rusti: let (p,c) = std::comm::stream::<int>(); let _ = c; p.try_recv(); p.try_recv();
[14:53:39] <dbaupp> ... and no, it blocks again; so they're not exactly equivalent.
[14:55:13] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[14:55:56] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Quit: ZNC - http://znc.in)
[14:58:38] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[15:00:07] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[15:02:41] *** Quits: tgummerer (tgummerer@moz-3CF4EF2C.unibz.it) (Ping timeout)
[15:08:48] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[15:09:15] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[15:09:32] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[15:11:41] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:11:50] <ChrisMorgan> macro_rules! foo(($x:ty)=>(stringify!($x)))foo!(~str)
[15:11:53] <ChrisMorgan> rusti: macro_rules! foo(($x:ty)=>(stringify!($x)))foo!(~str)
[15:11:54] -rusti- "an interpolated type"
[15:12:36] *** Quits: fyolnish (fyolnish@moz-6CC3B8A3.uqwimax.jp) (Client exited)
[15:12:59] *** Joins: fyolnish (fyolnish@moz-6CC3B8A3.uqwimax.jp)
[15:14:40] *** Quits: fyolnish (fyolnish@moz-6CC3B8A3.uqwimax.jp) (Ping timeout)
[15:17:30] *** Quits: jviereck1 (Adium@moz-187603FF.dip0.t-ipconnect.de) (Quit: Leaving.)
[15:17:43] <bstrie> dbaupp: quick, optimize the code in that benchmark post before the server recovers :)
[15:21:14] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:21:58] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[15:22:53] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[15:25:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:25:34] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:27:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[15:27:36] <nmatsakis> pnkfelix: this crash with objects is strange
[15:27:52] <pnkfelix> nmatsakis: darn, I still haven't tried to inspect that
[15:27:58] <nmatsakis> pnkfelix: it's not like it crashes right away -- it seems to work a number of times before it dies
[15:28:08] <nmatsakis> pnkfelix: I'm just kind of poking at it while other things compile
[15:28:43] <nmatsakis> pnkfelix: there are 12601 successful calls to walk_block before the failed one... :)
[15:30:47] *** Quits: sebcrozet (sebcrozet@moz-2517AE39.w80-13.abo.wanadoo.fr) (Ping timeout)
[15:31:38] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:32:28] <pnkfelix> nmatsakis: you try under valgrind yet?
[15:33:35] <nmatsakis> pnkfelix: no, that's a good idea
[15:33:45] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[15:33:46] <nmatsakis> I never use valgrind
[15:33:50] <erickt> good morning folks. Would anyone be opposed to me exposing llvm's unreachable intrinsic? http://llvm.org/docs/LangRef.html#unreachable-instruction. It'd be an unsafe way to indicate a match variant is known to be impossible. This is to avoid generating fail!() code to allow for more possible optimizations
[15:36:41] <erickt> ^ is specifically for my experimentation with desugaring generators in libsyntax
[15:37:28] <erickt> and it could be useful in critical inner loops
[15:38:43] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[15:39:52] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[15:43:54] <maik> does someone here has minor experience with a gc and can answer a simple question?
[15:45:26] <pnkfelix> maik: What is the question?
[15:47:05] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[15:47:51] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[15:48:15] <elly> whenever someone prefaces a question like that you know it's going to be complex :P
[15:48:28] <pnkfelix> even so, this is quite a delay
[15:48:47] <erickt> elly: hey elly! I didn't know you were still around
[15:48:57] <elly> I am always around
[15:48:58] <pnkfelix> (perhaps a â€¦. collection pause !  ah ha ah!)
[15:49:52] <maik> pnkfelix, well some languages have a "precise" gc (I think it's incremental) where you can specify how many objects get collected and how long it should pause etc. When I program a game I never know how many objects there are at a certain time because the level changes dramatically over time
[15:49:57] <maik> (sry for the delay)
[15:50:23] <erickt> dbaupp: regarding http://www.reddit.com/r/programming/comments/1kxt7w/parallel_roguelike_levgen_benchmarks_rust_go_d/, Port.try_recv() doesn't have the same semantics as Iterator.next(). I believe Iterator.next() presumes that if you return a None that's the end of the stream
[15:50:31] <maik> for me that is still not precise because I can tune the gc as much as I want and I never get an optimum
[15:51:03] <pnkfelix> maik: what is "optimum" supposed to mean here?
[15:51:18] <pnkfelix> maik: the gc does not have an oracle available.
[15:51:22] <engla> erickt: port should be the same?
[15:51:39] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[15:52:06] <pnkfelix> maik: anyway, never mind that, I don't want to interrupt before you get to your question.
[15:52:07] <maik> pnkfelix, I don't know let's say I tell the gc to collect 100 objects every time and at some point I have 200 objects. Then the gc will probably have to make additionally pauses at some time or it will leak
[15:52:16] <erickt> elly: cool. Well there's been some traffic recently on rustcrypto, would you want me to send you a pull request?
[15:52:29] <elly> if you want to? I haven't been keeping up with rust stuff at all
[15:52:33] <maik> so in my eyes a gc is always bad for something that is as dynamic as a game right?
[15:52:35] <elly> life's too busy lately :(
[15:53:03] <pnkfelix> maik: well, saying "a gc is always bad" is probably too strong of a statement
[15:53:14] <erickt> engla: it's the same return type, but the semantics of what happens if you keep calling .next() after receiving a None may not be the same
[15:53:25] <sigma> maik: unexpected pauses are always going to be bad
[15:53:36] <pnkfelix> maik: what you probably need to do is architect your program to avoid any allocation during critical sections of the program where responsiveness is crucial
[15:53:56] *** Joins: mitja (Mibbit@moz-242C57AA.dial-up.dsl.siol.net)
[15:54:20] <pnkfelix> maik: So, for example, set things up so that the allocations (and collections) occur during transition points, like where the next level is loading
[15:54:26] <engla> erickt: right, but it seems the final word on what the semantic is for iterators is, hasn't been said yet
[15:54:37] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[15:54:40] <maik> pnkfelix, atm I feel that I would have to make many tweaks so that the gc can perform well that I can just stick to a language like rust
[15:54:47] <engla> erickt: right now the semantics are to fail!() if you call try_recv after it returned None once :)
[15:54:49] <pnkfelix> maik: and during the interactive portions, you'd have to use internal object pools.
[15:54:51] <erickt> elly: :( well I'm happy to keep maintaining it. There are now 3 other people working on various aspects around libcrypto so we got some nice momentum :)
[15:54:56] <elly> excellent!
[15:55:04] <elly> yeah, I transferred onto Chrome, so that's been eating my life lately
[15:55:30] <pnkfelix> maik: the other option is to find a runtime where you can actually provide enough hooks to the GC to be able to build a more reasonable predictive model
[15:55:32] <erickt> elly: cool! if you happen to know eric seidel, please say hi to him for me :)
[15:56:01] <pnkfelix> maik: if you're talking about hacking in Rust, then it sounds like you are not currently wedded to any particular language / development environment.
[15:56:19] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[15:56:19] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/xHckxA
[15:56:19] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[15:56:21] <elly> (amusingly one of my current projects is webcrypto implementation :))
[15:56:36] <pnkfelix> maik: so then it becomes a question of whether another language runtime can provide enough GC hooks for you to accomplish your goals.
[15:57:23] *** Quits: sk (sk@5FD88F96.77870B72.78DD174B.IP) (Quit: Leaving)
[15:57:39] *** Joins: msingle1 (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[15:58:00] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[15:58:32] <erickt> elly: neat. do you feel you're qualified to evaluate whether or not rustcrypto is safe? I'm happy to keep it in sync with rust, but the documentation for openssl is terrible and I'm not sure if I'm violating various constraints. For example, I just learned there are race conditions with threads and the hashing functions :(
[15:58:34] <pnkfelix> maik: (but usually in these situations the simplest thing would be to throw more memory at the problem: Tell the GC that its allowed to allocate a larger amount of heap relative to whatever it thinks the current amount of live data there is.  This ratio is called the "load factor" by at least some members of the GC community.)
[15:58:50] <elly> erickt: no, but I can give it a go anyway
[15:58:53] <pnkfelix> maik: (And such an increase in memory usage may not be an option for you.)
[15:59:04] <maik> okay
[15:59:23] <erickt> elly: ok :) well I'll let the current work settle down and ping you in a couple weeks or so
[15:59:25] <maik> pnkfelix, well I am just doing my research but I think I will stay with rust because it is memory safe and I have more control
[15:59:49] <pnkfelix> maik: which language / GC are you currently using?  I.e. I wanted to look at the tuning parameters you currently have available
[15:59:56] <maik> pnkfelix, but thanks for the explanation
[15:59:57] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[16:00:11] <maik> pnkfelix, I am not really using anything atm
[16:00:22] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[16:00:28] <maik> pnkfelix, but I was looking at many different languages
[16:00:31] <erickt> engla: this is a good case to be considered in the "what are the semantics of iterators after a None?". I wonder if we have a issue to resolve it
[16:00:35] <pnkfelix> maik: Okay, I assumed from your earlier statements that you had a concrete benchmark that you were using as the basis for your statements.
[16:00:51] <engla> there was a lot of discussion on the ML erickt 
[16:01:00] <maik> pnkfelix, no this was what I assumed would happen
[16:01:23] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:01:23] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/EI_7sQ
[16:01:23] <ghrust> 13rust/06auto 14db14469 15Daniel Micay: make: rm LLVM_BUILD_ENV...
[16:01:23] <ghrust> 13rust/06auto 140ac02e7 15Daniel Micay: make: stop disabling frame pointer elimination...
[16:01:23] <ghrust> 13rust/06auto 142c0f9bd 15bors: auto merge of #8695 : thestinger/rust/build, r=pcwalton...
[16:01:25] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:01:41] <erickt> engla: I'll make a ticket and link in that conversation
[16:01:56] <pnkfelix> maik: Okay.  FYI the tuning parameters are usually not expressed in terms of the amount of storage they'll reclaim, because the GC cannot predict that before its put in the the necessary to identify garbage.
[16:02:04] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[16:02:36] <pnkfelix> maik: Instead they're usually expressed in terms of things like "How much memory can I allocate before the GC kicks in" or "what is the pause time that we are going to attempt to achieve", amoung many others.
[16:02:54] <pnkfelix> sed -e s/the the/the work/
[16:04:05] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[16:04:30] *** Joins: elij (elij@E6C4342E.9D386EAF.AF7F4FE0.IP)
[16:05:09] *** Quits: msingle1 (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[16:06:53] <erickt> elly: are you familiar with the differences between openssl and nss? I expect one of the nice things to fall out of servo is a high quality binding to nss. A part of me wonders if it'd be better for us to consolidate our efforts on that up to speed, and letting mozilla security handle making sure it's actually safe
[16:07:09] <maik> pnkfelix, I was just looking at http://nimrod-code.org/gc.html and it has a step mode. sth that I can call every frame in my mainloop. But they state pause times are usually 2ms max. But 2ms are actually very high for a game. that's was troubling me
[16:08:03] <erickt> engla: another idea could be to provide a Port.try_iter() that you use to read all the available messages. Once you hit a None, you can make another .try_iter() to get the next batch
[16:08:07] <pnkfelix> maik: Its max pause.  It doesn't say how often it hits that, or what the average is, or what the clustering is lke.
[16:08:52] <maik> pnkfelix, but it's hard to start a project when you don't know the numbers yet. 
[16:08:53] <engla> erickt: try_recv is still blocking though? so while it sounds useful it's not the same kind of thing
[16:08:54] <pnkfelix> maik: The clustering of pauses is the thing that could really hurt, although at least for that the application developer can respond by cutting down on the amount of allocation they do, or how the allocations themselves are clustered.
[16:09:15] <engla> erickt: by the way there was this PR, which did not land https://github.com/mozilla/rust/pull/8276
[16:09:18] <erickt> engla: this presumes a non-blocking try_recv-like function
[16:09:45] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[16:09:47] <engla> right. but try_recv is always blocking in the docs
[16:09:50] <pnkfelix> maik: Yes, no doubt.  And if you are comfortable building your game in (pre-alpha) Rust, then that's fine
[16:10:10] <pnkfelix> maik: (and I have no idea how Rust compares to Nimrod in terms of alpha-ness)
[16:10:25] <maik> pnkfelix, ofc I am programming in Rust since 3 months now I guess and I enjoy it.
[16:11:03] <pnkfelix> maik: But it would be a mistake to make a decision based on the very limited information presented on that nimrod page.  It shouldn't be that hard to make a few microbenchmarks to emulate the kinds of allocation patterns you anticipate
[16:11:15] <pnkfelix> maik: and then see what the pauses are like on those microbenchmarks.
[16:11:42] <pnkfelix> maik: (well, obviously making *accurate* microbenchmarks could be very hard, since you probably don't know what allocation patterns to expect in reality)
[16:12:19] <pnkfelix> maik: (but I'm just talking about making educated guesses here.  E.g. are all objects same size, or varied?  Are their lifetimes random?  etc.)
[16:13:19] <maik> pnkfelix, I am still super inexperienced. I am just in my 4th semester and I want to work on a game engine. (I am studying computer graphics). My safest bet atm is to stay with rust
[16:13:49] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:14:36] <maik> pnkfelix, but many thanks for sharing your knowledge :)
[16:16:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:17:47] <maik> pnkfelix, The only major pitfall that will happen when I continue using Rust is to make bindings for bullet which is a physic engine written in c++
[16:18:05] <maik> and has a very limited c api
[16:18:16] <pnkfelix> maik: I'd say the thing to do there is to make your own C api wrapper around it.
[16:18:28] <pnkfelix> maik: but I don't know bullet, maybe that is not realistic
[16:19:03] <maik> pnkfelix, me neither yet but it looks like it will be a ton of work
[16:19:13] <pnkfelix> maik: that would be what I would do, nonetheless.  Especially since an appropriately written C api wrapper can then be linked into a large number of other languages.
[16:19:35] <pnkfelix> maik: Then just write what you need on demand.
[16:19:47] <pnkfelix> maik: its not like you will need to port the entire api surface
[16:21:11] *** Quits: RMF (RMF@moz-4C3A3FAA.dsl.telepac.pt) (Ping timeout)
[16:21:16] <maik> pnkfelix, right , btw how efficient is it to call c code in Rust? I know that there is a overhead. 
[16:21:24] <maik> pnkfelix, something that I should worry about?
[16:21:28] <pnkfelix> maik: I don't know offhand.
[16:21:41] <pnkfelix> maik: from what I understand, it shouldn't be terribly high overhead.
[16:21:55] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[16:23:11] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:23:16] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Client exited)
[16:23:59] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[16:24:35] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[16:25:19] *** Joins: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net)
[16:26:19] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[16:26:20] *** ChanServ sets mode: +o tjc
[16:26:23] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bbl)
[16:28:54] *** Quits: jclements (jclements@moz-37891906.dsl.snlo01.pacbell.net) (Quit: jclements)
[16:29:19] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[16:29:19] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[16:30:13] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[16:30:43] *** Joins: josh (josh@moz-6ACE5AE6.reserved.cptelecom.net)
[16:30:44] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[16:33:09] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:34:30] <olsonjeffery> any windows folks around who give me an idea of where headers for stuff like stat.h are at in a windows install?
[16:34:45] <olsonjeffery> i need to look up some constants..
[16:36:17] <darkf> olsonjeffery: your mingw install dir\include\sys
[16:37:46] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[16:37:51] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[16:38:08] *** Joins: squiddy (squiddy@moz-B3299262.adsl.alicedsl.de)
[16:38:30] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Ping timeout)
[16:39:15] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[16:39:24] <olsonjeffery> darkf: libuv uses the win32 versions (_S_IFDIR, for example) when returning the stat data structure
[16:39:33] <olsonjeffery> so i need to know where the win32 stuff is, sadly..
[16:40:37] <darkf> olsonjeffery: is it using _stat()?
[16:41:11] <darkf> MSDN says "<sys/types.h> followed by <sys/stat.h>"
[16:41:28] <olsonjeffery> no, it actually uses GetFileInformationByHandle()
[16:41:35] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:41:36] <olsonjeffery> but it returns a cross-platform "stat-like" struct
[16:42:08] <olsonjeffery> and it looks at stuff from the output of the win32 call and |= translates them onto the stat struct it returns to the caller
[16:42:25] <olsonjeffery> using the win32 _S_* consts
[16:42:30] <klutzy> do you want to look at sys/stat.h?
[16:42:52] <olsonjeffery> yeah.. from win32.. where _fstat, _S_* are at
[16:42:57] <darkf> olsonjeffery: the _S_* stuff _is_ in sys/stat.h
[16:43:14] <olsonjeffery> really.. in mingw32?
[16:43:19] <klutzy> yep
[16:43:22] <darkf> yes, for me it's: #define_S_IFDIR0x4000/* Directory */
[16:43:27] *** Joins: mrordinaire (Mibbit@1A659656.A607747.FD383126.IP)
[16:43:33] <klutzy> $ ack _S_IFDIR
[16:43:34] <klutzy> 46:#define      _S_IFDIR        0x4000  /* Directory */
[16:43:36] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[16:43:40] <olsonjeffery> thanks
[16:44:30] <klutzy> it's good to download w32api package from mingw project
[16:44:42] <klutzy> or from mingw-w64 if you consider w64 ;p
[16:46:25] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[16:48:10] *** Joins: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net)
[16:49:50] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[16:51:27] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:51:58] *** Quits: andrew-d (andrew-d@moz-F84C8FD7.hm.shawcable.net) (Quit: ZNC - http://znc.in)
[16:54:45] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:56:40] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[16:57:03] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[16:58:04] *** Joins: andrew-d (andrew-d@6C6C9B53.23518FA3.CE794808.IP)
[16:59:03] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[16:59:34] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[17:00:58] *** Joins: Kruppe (user@moz-EE1E894A.home3.cgocable.net)
[17:01:14] *** Parts: andrew-d_ (andrew-d@moz-F84C8FD7.hm.shawcable.net) ()
[17:02:05] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[17:02:17] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:03:04] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[17:03:07] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:05:54] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[17:06:37] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[17:07:13] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[17:07:13] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:08:50] *** Joins: valenting (Thunderbir@8758046C.84D5EFD5.FB866788.IP)
[17:09:27] *** Quits: StarLight (StarLight@moz-A3DC7D73.pppoe.avangarddsl.ru) (Ping timeout)
[17:11:07] *** Quits: KindOne (KindOne@735F8E04.C538DA2.EC6A1518.IP) (Ping timeout)
[17:11:20] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[17:11:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/EI_7sQ
[17:11:20] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[17:13:16] *** Joins: StarLight (StarLight@moz-73DEB454.dynamic.avangarddsl.ru)
[17:14:58] *** Joins: KindOne (KindOne@moz-F5FC04AF.dynamic.ip.windstream.net)
[17:16:20] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[17:16:20] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/R1Av2A
[17:16:20] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[17:17:29] <sully> ok.
[17:17:35] <sully> I'm gonna close the default methods bug
[17:18:15] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[17:18:15] *** ChanServ sets mode: +qo graydon graydon
[17:21:19] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:21:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/R1Av2A
[17:21:19] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:21:20] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:21:20] <ghrust> 01[13rust01] 15bors pushed 12 new commits to 06auto: 02http://git.io/FKoZxA
[17:21:20] <ghrust> 13rust/06auto 140a6c92d 15Brian Anderson: rt: Remove last use of C++ exchange alloc
[17:21:20] <ghrust> 13rust/06auto 14049da6d 15Brian Anderson: rt: Remove rust_exchange_alloc
[17:21:20] <ghrust> 13rust/06auto 14391d928 15Brian Anderson: rt: Remove indexed_list
[17:21:21] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:23:00] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:23:41] *** Quits: victorporof (victorporo@F2782203.A485B230.9B1E38F4.IP) (Quit: victorporof)
[17:24:42] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[17:26:05] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[17:27:31] *** Quits: mrordinaire (Mibbit@1A659656.A607747.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:29:08] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[17:30:28] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[17:30:30] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[17:30:39] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[17:30:46] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[17:31:24] <jmgrosen> how to do a system(3)-like call?
[17:32:10] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:32:14] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[17:32:55] *** Joins: fabiand (fabiand@moz-EBC6B128.netcologne.de)
[17:34:55] <graydon> cmr: ping
[17:35:34] *** Quits: josh (josh@moz-6ACE5AE6.reserved.cptelecom.net) (Quit: josh)
[17:37:07] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:39:05] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[17:39:25] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:39:45] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:41:10] *** Quits: KindOne (KindOne@moz-F5FC04AF.dynamic.ip.windstream.net) (Ping timeout)
[17:43:13] <jmgrosen> ah, it's std::run
[17:43:33] <jmgrosen> well, sort of
[17:45:30] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:45:35] *** Joins: KindOne (KindOne@moz-644645C4.dynamic.ip.windstream.net)
[17:45:38] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[17:46:22] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:46:22] *** ChanServ sets mode: +o pcwalton
[17:48:03] <kimundi> Hey everyone, I rewrote the module part of the tutorial, and I need one or more volunteers for spell and fact checking ;)
[17:48:34] * kimundi hasn't even run an automatic spell check yet because it doesn't in his kate install for some reason
[17:49:17] <kimundi> First raw version is here: https://gist.github.com/Kimundi/6322035
[17:50:03] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:50:52] <graydon> huh
[17:50:55] <graydon> bors queue is empty
[17:50:57] *** Quits: KindOne (KindOne@moz-644645C4.dynamic.ip.windstream.net) (Ping timeout)
[17:51:01] <graydon> (or, well, the approved-set)
[17:52:10] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[17:52:35] <SiegeLord> What the heck is "starting backwards" :P
[17:52:54] <kimundi> SiegeLord: xD
[17:53:45] <kimundi> SiegeLord: The ide was "Starting with the compiled binary, and explaining the layout of the source code for it from there."
[17:53:48] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[17:54:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:54:16] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[17:55:15] *** Joins: KindOne (KindOne@moz-644645C4.dynamic.ip.windstream.net)
[17:55:58] *** Joins: Sergio965 (sergiobz@B578783D.28E21636.3A99D594.IP)
[17:56:09] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:56:14] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[17:56:36] <kimundi> (Writing isn't really my speciality, so feel free to point your finger at any bad part of it)
[17:56:49] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:56:49] *** ChanServ sets mode: +o tjc
[18:01:24] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:01:44] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[18:01:47] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[18:02:24] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[18:02:26] * kimundi fixed his spellchecker... Lots of errors ._.'
[18:02:29] <adridu59> is anyone here using gedit syntax highlighting?
[18:03:06] <adridu59> because the instructions seems wrong, I want to update them but I'm wondering if the actual one is still working on particular configurations .?
[18:05:41] <SiegeLord> kimundi, I'd use the phrase "Stepping back" instead
[18:06:02] <SiegeLord> Or just omit it entirely
[18:07:06] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[18:07:57] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[18:08:22] *** Joins: mortisha (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP)
[18:09:09] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:09:25] *** Quits: decoder (quassel@moz-D7023D7D.own-hero.net) (Ping timeout)
[18:10:43] <mortisha> is anyone else facing build errors related to jemalloc on win32?
[18:12:12] <klutzy> mortisha: https://github.com/mozilla/rust/issues/8662
[18:12:51] <Ms2ger> adridu59, I use it
[18:12:58] *** Joins: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP)
[18:13:10] <Ms2ger> adridu59, I don't recall issues with it
[18:13:16] <klutzy> I had to disable jemalloc by tweaking some makefile :(
[18:13:25] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:13:27] <mortisha> klutzy: how do i do that?
[18:13:32] *** Quits: fabiand (fabiand@moz-EBC6B128.netcologne.de) (Quit: Verlassend)
[18:14:07] <klutzy> mortisha: I think jemalloc is broken on win32 but not detected by buildbot for some reason I don't understand
[18:14:18] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[18:14:57] <klutzy> mortisha: I manually editted mk/rt.mk by removing $$(JEMALLOC_LIB_$(1)_$(2)) stuff so build chain does not depend on it
[18:15:16] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[18:15:28] <mortisha> klutzy: thanks! i'll try that
[18:15:39] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[18:15:53] <adridu59> Ms2fer: what is your OS exactly?
[18:15:54] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[18:15:58] <adridu59> Ms2ger: what is your OS exactly?
[18:16:11] *** Joins: decoder (quassel@moz-D7023D7D.own-hero.net)
[18:16:15] <Ms2ger> Ubuntu 12.04
[18:16:59] <adridu59> Ms2ger: did you use official instructions? I'm on Mint but I used these: http://www.gregfreeman.org/2013/how-to-add-a-mime-type-for-actionscript-to-ubuntumint-and-edit-them-with-gedit/
[18:17:10] <adridu59> dated from February, for Ubuntu/Mint
[18:17:16] <adridu59> officials didn't work
[18:17:27] <klutzy> mortisha: do you have error log? I don't have one now since I'm on debian :p
[18:17:28] <Ms2ger> adridu59, I think I followed the instructions on github
[18:18:18] <adridu59> Ms2ger: ok, thank you. I think it's because I use gedit 2.x I have to use gtksourceview-2.0... well just a wild guess
[18:18:39] <Ms2ger> adridu59, ah, that may well be it
[18:19:04] <mortisha> klutzy: i'll share it with you in a few minutes
[18:19:16] <klutzy> thanks! :D
[18:19:50] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:19:50] *** ChanServ sets mode: +o brson
[18:20:37] *** Quits: KindOne (KindOne@moz-644645C4.dynamic.ip.windstream.net) (Ping timeout)
[18:21:04] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:21:09] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[18:21:21] <brson> acrichto strcat: do you have any leads on the llvm perf regression?
[18:21:46] <pcwalton> if not I vote reverting the change
[18:21:51] <pcwalton> downgrade LLVM
[18:21:59] <acrichto> brson: I commented last night on the bug, it appears to be inlining issues but I didn't get to the bottom of it
[18:22:15] <acrichto> I agree that reverting is the best course of action at this point
[18:23:35] <pcwalton> ok
[18:23:54] <brson> acrichto: that profile is *crazy*
[18:24:16] <acrichto> brson: yeah, especially with the mach_time stuff being at the top
[18:24:55] *** Joins: KindOne (KindOne@3AD84C25.DFA916E1.34F73994.IP)
[18:26:56] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Ping timeout)
[18:27:06] <brson> acrichto: is the revert easy to do? can I do it now?
[18:27:43] <acrichto> brson: not sure if git can revert merges, but a8c3fe45c6138cd1f4d143fdb0e843ee2d4759b2 is the merge commit
[18:27:58] <acrichto> yes though, it should be as simple as just reverting
[18:29:07] <acrichto> brson: it appears git revert a8c3fe45 -m 1 does the trick
[18:30:34] <brson> acrichto: what are we going to lose in the revert?
[18:30:45] <acrichto> no_split_stack
[18:30:59] <brson> ok. we can get by without that for a while still
[18:31:02] <acrichto> and "fixed-stack-segment" as atring attribute
[18:31:07] <acrichto> nothing huge 
[18:33:24] <kimundi> graydon: Are 'global path' and 'local path' good names for something like '::std::io::println' and 'io::println' ?
[18:33:57] <graydon> kimundi: we've often used crate-relative and module-relative
[18:34:07] <graydon> not sure if global or local are better. I don't have a strong preference.
[18:34:22] <graydon> maybe check what the manual uses
[18:34:39] <graydon> I'm more concerned with proliferation of terms for the same thing than with the specific choice thereof
[18:36:02] <mortisha> klutzy: ping
[18:36:09] <bstrie> how amusing, I just found a place where C-style switch fallthrough would be useful :)
[18:36:53] <mortisha> klutzy: here's the build log for #8662 https://gist.github.com/anonymous/5af362d5ed1523a474c0
[18:37:20] <Ms2ger> bstrie, well, it *is* used to good effect every now and then in C :)
[18:38:40] <kimundi> graydon: Hm, the problem is 'crate-root-relative path' would be most exact, but that's way to long. Gonna check the manual, but isn't that most out of data from all documentation? (I'm rewriting the module tutorial here)
[18:39:00] <sam113101> guys, what's your thought on D (the programming language)?
[18:39:42] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[18:39:48] <graydon> sam113101: it's a fine language with a variety of strengths and weaknesses. we try not to engage in too much other-language critique here, as with 300 people it will get out of hand quickly.
[18:40:03] <sam113101> alright
[18:40:35] <graydon> kimundi: it is likely the most out-of-date, yes. if you prefer one way of saying it over another, that's fine, I would just prefer you try to keep them consistent. changing the manual is a reasonable option.
[18:41:20] <tjc> Also, not everyone in this channel is a guy
[18:41:30] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[18:41:45] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:41:52] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[18:42:20] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[18:43:00] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Quit: leaving)
[18:43:00] <myname> i would love a language like J but actually readable :)
[18:43:32] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[18:43:43] <doomlord> i wonder why i've never tried D, but jumped on rust
[18:44:10] *** Quits: Kruppe (user@moz-EE1E894A.home3.cgocable.net) (Client exited)
[18:44:32] *** Joins: Kruppe (user@moz-EE1E894A.home3.cgocable.net)
[18:44:35] <mortisha> I'd love to read a book on rust language, explaining the implementation of rustc
[18:44:38] <doomlord> rust looks fresher to me, being subejective
[18:45:17] <Ms2ger> mortisha, well, you don't want one that's old enough that it's been printed ;)
[18:45:59] <adridu59> Personally, I'm still hesitating between Rust, D and Nimrod.
[18:46:36] <doomlord> i think what i like about Rust is its just the right blend of 'still doing C++'s job' and 'being inspired by more modern ideas' like immutable-by-default
[18:46:49] *** Joins: fyolnish (fyolnish@moz-F78970DC.uqwimax.jp)
[18:46:58] <mortisha> Ms2ger: at the rate of the current development, even an online version would be tough to keep up to date
[18:47:05] <adridu59> I've done some chunks of D awhile ago that was before I even heard of Rust, D has the advantage of having very syntax similarities with C so it's easier for newcomers (has less symbols like Rust)
[18:47:06] *** Joins: make_sense (Mibbit@3302C3F5.C4E8BC8.6E60BEB9.IP)
[18:47:20] <adridu59> a lot of*
[18:47:39] <doomlord> rusts' syntax is cleaner. i want a main language that is easier to parse
[18:47:39] <adridu59> D has almost obligated GC
[18:48:13] <kimundi> graydon: A quick search in the manual itself didn't expose any terminology there. The difference is explained as being crateroot relative or not, but the path forms aren't actually _named_ that way.  I'm not completly sure wether global/local would be an good idea, though. they are short, but not as specific. hm...
[18:48:19] <adridu59> probably
[18:48:29] <doomlord> taking longer than expected, i'm submitting rust support to geany, they have it in a WIP branch now
[18:48:39] <pcwalton> ok, I just bootstrapped with coherence improvement
[18:48:43] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:48:51] <doomlord> mr geany maintainer doesn't like declaring variables where they are initialized :( etc
[18:48:54] <graydon> pcwalton: \o/
[18:48:54] <pcwalton> 0.116 s -> 0.003 s
[18:48:57] <pcwalton> graydon: ^
[18:49:00] <maik> adridu59, what are you trying to do?
[18:49:02] <pcwalton> for hello world
[18:49:03] <graydon> great!
[18:49:08] <pcwalton> it isn't all the optimization I could do
[18:49:15] <pcwalton> but it's enough for hello world and small test cases
[18:49:26] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:49:28] <brson> graydon: i have a few optimization branches too, but they aren't going to have the same impact as pcwalton's
[18:49:56] <adridu59> maik: just sharing my bits of experience since someone asked about the differences between D and Rust
[18:50:00] <graydon> brson: cool
[18:50:13] <adridu59> but I'm mostly a newcomer in both language
[18:50:15] <adridu59> s
[18:50:16] <graydon> I also have --test-shard working here so I can (for things like valgrind) split the testsuite across multiple machines
[18:50:23] <pcwalton> biggest difference memory-management-wise is that in D you choose between GC and safety, in Rust you can have memory safety without GC
[18:50:27] *** Quits: make_sense (Mibbit@3302C3F5.C4E8BC8.6E60BEB9.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:50:31] *** Joins: Guest__ (textual@3302C3F5.C4E8BC8.6E60BEB9.IP)
[18:50:42] <graydon> though I wonder if that or running check-fast valgrind would be a better way to bring V back online
[18:50:47] *** Parts: Guest__ (textual@3302C3F5.C4E8BC8.6E60BEB9.IP) (Textual IRC Client: www.textualapp.com)
[18:51:05] <maik> adridu59, I mean you wrote "Personally, I'm still hesitating between Rust, D and Nimrod." so I guess you have some sort of aim?
[18:51:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:51:32] *** Joins: make_sense (make_sense@3302C3F5.C4E8BC8.6E60BEB9.IP)
[18:52:11] <adridu59> pcwalton: that makes no difference between D and Rust then: you said D: either GC or safety, Rust: safety without GC... I'm confused
[18:52:59] <Ms2ger> adridu59, I think he meant that if you don't use the GC in D, everything's unsafe?
[18:53:56] <doomlord> rust's USP,  safety with c++11 style memory management 'built in'
[18:54:01] <maik> adridu59, I think he means that you achieve memory safety in D with a GC and in Rust you achieve memory safety on a language level
[18:54:06] <doomlord> unsafe blocks for raw pointers
[18:54:09] <pcwalton> maik: yes
[18:54:11] <adridu59> Ms2ger: probably, in all cases, GC can be turned off manually by a function call but the language and its library is built around the use of GC so..
[18:54:27] <adridu59> maik: oh ok sorry, I want the do-it-all language which I can use for all my projects from kernel to app writing, has to be elegant but powerful... kinda the "main" language
[18:54:29] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[18:54:30] <nsf> and D has exceptions
[18:54:50] <nsf> try using them without GC and libraries built around them and GC
[18:54:50] <pcwalton> it's not a goal of Rust to be the best language for everything
[18:54:52] <nsf> :)
[18:54:58] <pcwalton> I think no language can fulfill that
[18:55:07] <pcwalton> which is good
[18:55:14] <adridu59> maik: Rust seems to have memory-safety features without wasting time (altrough you could argue that unsafe code will lead to time waste anyway)
[18:55:24] <doomlord> the internet is about mass specialization :)
[18:55:30] <doomlord> dont try and please everyone
[18:55:33] <jeaye> Is it possible to call a stati function on a generic type that's bound to a trait (where the static function is in the trait)? See: http://dpaste.com/1354459/
[18:56:38] <adridu59> pcwalton: yea, of course but I meant something I could use instead of C. I generally use C for my apps and I'd like to switch to something more modern, or at least learn a new language.
[18:57:04] <jeaye> Or would I need a macro for this?
[18:57:12] <maik> adridu59, Rust is definitely "noisier" than high level languages like python. I think it is between sth like haskell and c++
[18:57:38] *** Joins: Guest__ (textual@moz-15DCD320.hfc.comcastbusiness.net)
[18:57:50] <adridu59> maik: what do you mean by noisier?
[18:57:51] <maik> adridu59, now it depends what you would do, you can probably use rust as a general purpose language 
[18:58:34] <adridu59> maik: do you think Rust isn't the best contender for "system programming general-purpose" language?
[18:58:36] <sam113101> would you use rust for embedded programming?
[18:58:40] <maik> adridu59, to write concise code , in Rust you would have to add lifetimes etc. 
[18:58:47] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[18:59:10] <doomlord> i got into rust because i wanted something as close to c++ as possible but minus headers and plus 'extention methods', i like its cleaner syntax choices too, D doesn''t grab me.
[18:59:12] <maik> adridu59, I think rust is perfect for this
[18:59:21] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[18:59:38] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[18:59:52] <adridu59> maik: ah I read it wrong, haha .k
[18:59:59] <doomlord> has anyone done rust/d examples side by side :)
[19:00:05] <olsonjeffery> brson: any requests on how/what i tackel in file io, next? tentatively doing fstat, as that's a blocker for doing seek w/o lseek(2) .. beyond that.. i guess its just the various actions that'll go on FsRequest.. ?
[19:00:11] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:00:21] <maik> doomlord, there was a post somewhere but it was rust 0.4 I think
[19:00:32] <adridu59> doomlord: at least 2 people on Reddit have done benchmarks that include D versions, it's one of Rust main competitors
[19:00:53] <jmgrosen> what's the quickest way to get `n` ports and chans
[19:00:58] <adridu59> doomlord: one of them has just been published http://togototo.wordpress.com/2013/08/23/benchmarks-round-two-parallel-go-rust-d-scala-and-nimrod/
[19:01:15] <maik> adridu59, don't forget that you are mostly bound to a garbage collection in D
[19:01:44] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[19:01:48] <nsf> in my opinion we should compare the libraries of the languages
[19:01:59] <maik> adridu59, I wouldn't do realtime programming in D
[19:02:05] <nsf> because that's what matters, that's what syntax is for
[19:02:22] <maik> I think Rust will be big in the game development scene
[19:02:26] *** Joins: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net)
[19:02:38] <maik> at least as a core language
[19:03:07] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[19:03:28] *** Joins: carleastlund (cce@moz-C8071335.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[19:03:31] <adridu59> maik: yea what I said before :) ... what do you think of Nimrod? I only know the name of it. Semms interesting. I've seen that it gets translated to C++ at compile-time.
[19:03:40] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:03:40] *** ChanServ sets mode: +o tjc
[19:03:42] <nsf> let's talk about libraries :) I saw this new io library in rust
[19:03:54] <nsf> eof(&self) -> bool? seriously? :(
[19:03:54] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Quit: leaving)
[19:04:06] *** Joins: jaen1 (jaen@moz-E0979827.copit.pl)
[19:04:09] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[19:04:22] <nmatsakis> checking for EOF is so 1990s
[19:04:33] *** Quits: jaen1 (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[19:04:37] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[19:04:38] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:04:40] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: jaen)
[19:04:43] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:04:44] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: jaen)
[19:04:48] *** mihneadb is now known as mihneadb|lunch
[19:04:52] <maik> adridu59, I think it can output c objective c and c++ , but I am mainly interested in realtime programming and I don't want to depend on a gc at this level. But it seems like a good language
[19:04:54] <nsf> and I mean, rust kind of follows functional programming style more than all these other languages (D, Go)
[19:04:58] <nsf> and here we go.. eof flag
[19:05:00] <nsf> :\
[19:05:27] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:06:11] <engla> according to the inline docs, it's not set in stone how .read() handles eof (as a condition?)
[19:06:16] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:06:49] <adridu59> maik: do you mean realtime like realtime OSes?
[19:07:19] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:07:19] *** ChanServ sets mode: +o tjc
[19:07:53] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[19:08:05] <maik> adridu59, maybe, but I am writing a game engine. So I need predictable behaviour.
[19:08:20] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[19:08:20] <jeaye> maik: Do you've a link to it?
[19:08:34] * jeaye gets excited when people write games in Rust.
[19:09:07] <nsf> jeaye: have you seen any interesting examples?
[19:09:14] <nsf> games in rust I mean
[19:09:23] * myname would get excited if someone ports ncurses bindings in a good way and keeps it up to date
[19:09:25] <maik> jeaye, haha :D no I have tons of subsystems but nothing that I can show
[19:09:46] <olsonjeffery> myname: that someone could be you!
[19:10:13] <nsf> myname: you can try to use my library instead as well, but there are only C and Go versions: github.com/nsf/termbox
[19:10:14] <myname> olsonjeffery: i tried that at 0.4 or 0.5 and i do think i failed hard
[19:10:17] <jeaye> nsf: Not much yet. I've only seen a couple of small projects pop up other than my own.
[19:10:20] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:10:20] <maik> jeaye, I am currently writing an opengl abstraction layer in Rust because since yesterday we can actually use OpenGL now :)
[19:10:24] <nsf> unless you're making a rogue-like or something
[19:10:25] <bstrie> nsf: welcome back :)
[19:10:34] <olsonjeffery> rustlike
[19:10:34] <nsf> bstrie: :)
[19:10:35] <jeaye> maik: I've been using GL in Rust for several months.
[19:10:47] <adridu59> nsf: no but Rust is fairly new and changing constantly since it hasn't reached 1.0 yet so very few people will want to use it for a project where you'll have to rewrite stuff, deal with bugs etc. yet. Also not many people know of it right now.
[19:10:48] <maik> jeaye, yeah but opengl es2 right?
[19:11:16] <jeaye> maik: Not specifically; I use 3.2 core (but forked from the es2 repo)
[19:11:52] <maik> jeaye, yeah I am well familiar with your project :)
[19:12:03] <nsf> bstrie: I know I promised termbox in rust, but let's be honest, rust's lib is far from complete and I'll end up using C syscalls anyway
[19:12:05] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[19:12:20] <nsf> bstrie: so I see little sense in that at the moment, bindings should work just fine :D
[19:12:21] <jeaye> maik: That almost sounds like a bad thing.
[19:12:39] <maik> jeaye, haha I meant it in a good way :)
[19:12:40] <bstrie> nsf: eh, no rush :P code falls apart. the center cannot hold
[19:12:43] <doomlord> i haven't looked at the official gl bindings lately, i NIH'd them and did some that look 100% like the c calls.
[19:12:46] <jeaye> maik: :P
[19:13:09] <doomlord> i prefered the idea of gl calls looking exactly as they would in a C project instead of rusti-fying them
[19:13:24] <kmc> Servo uses OpenGL ES so one can expect those bindings to stay relatively up to date
[19:13:34] <kmc> https://github.com/mozilla-servo/rust-opengles
[19:13:55] <adridu59> What's the difference b/w OpenGL and OGL ES for a desktop computer?
[19:14:16] <doomlord> some things missing..
[19:14:16] <myname> nsf: what do you mean with "unless you're making a rogue-like or something"?
[19:14:21] <adridu59> I didn't even know it could be ran on desktop
[19:14:35] <graydon> hm. do we have a consume/move iter for vecs currently?
[19:14:44] <doomlord> ah, the same, they've rusti-fied the function names
[19:14:45] <nsf> myname: termbox has only 16 colors
[19:14:48] <jeaye> adridu59: Some bits missing, some named a bit different, param ordering, etc
[19:14:51] <nsf> myname: won't work well for games
[19:14:58] <maik> adridu59, afaik opengl es is only a subset of opengl I think it is based on opengl 2.x and targets embedded systems
[19:15:02] <myname> nsf: depends hard on the game i think
[19:15:06] <Luqman> graydon: yep, move_iter()
[19:15:19] <myname> nsf: i recently read that ncurses in arch linux had limited colors
[19:15:21] <graydon> looked right through it
[19:15:22] <graydon> thanks
[19:15:35] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[19:15:36] <nsf> myname: have no idea, I hate ncurses
[19:15:43] <myname> why that?
[19:15:52] <nsf> ugly API from 80s
[19:16:03] <jeaye> I'd like to see some curses bindings, or something similar.
[19:16:04] <myname> okay
[19:16:22] <nmatsakis> graydon: I have a question re: rust-mode
[19:16:28] <maik> adridu59, btw you should also consider ada2012
[19:16:29] <graydon> nmatsakis: shoot
[19:16:30] <nmatsakis> graydon: in particular, I was trying to extend the indentation algorithm,
[19:16:33] <graydon> ok
[19:16:39] <myname> nsf: i may keep it in mind
[19:16:43] <nmatsakis> graydon: but I'm not sure how to have my changes take immediate effect so I can test...
[19:16:55] <nmatsakis> graydon: is there a trick to this? C-x C-e on the fn def'n didn't seem adequate?
[19:17:13] <adridu59> maik: really?
[19:17:14] <nmatsakis> I guess this is really an elisp / emacs environment question
[19:17:18] <nmatsakis> not rust-mode specific
[19:17:20] <graydon> nmatsakis: heh. I wish I knew!
[19:17:29] <graydon> M-x eval-current-buffer ?
[19:17:30] <graydon> no wait
[19:17:33] <graydon> there's a helper at the bottom
[19:17:34] <graydon> I remember this
[19:17:50] <graydon> rust-mode-reload
[19:17:50] <nsf> myname: but the lib itself is very solid, especially the Go implementation, I'm using a text editor written in it everyday :D
[19:17:52] <nmatsakis> ah, rust-mode-reload
[19:17:54] <nmatsakis> graydon: thanks!
[19:17:56] <maik> adridu59, yeah looks like a good language but I have no experience in it
[19:18:23] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[19:18:28] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[19:18:37] <myname> nsf: so i have to look forward for a rust version around rust 1.0? :p
[19:19:06] <nsf> probably, rust implementation from scratch or bindings at least
[19:19:25] <nsf> I have a plan to refactor C api (to make it close to Go one)
[19:19:42] <nsf> and there are a couple of major problems with error handling
[19:19:52] <nsf> like flushing stuff on the screen doesn't check for write() errors, etc.
[19:20:02] <myname> i don't care what you do, i just want to be able tto use something :D
[19:20:22] <nsf> yeah, but if you need it right now, probably isn't the best advice
[19:20:24] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[19:20:31] <nsf> although I saw rust termbox bindings once
[19:20:40] *** Joins: robertknight (robertknig@moz-731801B5.range86-144.btcentralplus.com)
[19:21:06] <myname> i'm a bit confused about the functions
[19:21:08] *** Quits: KindOne (KindOne@3AD84C25.DFA916E1.34F73994.IP) (Ping timeout)
[19:21:31] <adridu59> maik: found a small comment about it http://www.reddit.com/r/programming/comments/1bzh5r/ada_2012_ada_with_contracts_dr_dobbs/c9c8up6
[19:21:33] <olsonjeffery> graydon: ill ask you the same question i asked brson: any requests/priorities for my ongoing file io work? im doing stat next so that i can finish seek.. other than that, just mapping the uv_fs_* fns as i go..
[19:21:44] <nsf> myname: it's documented isn't it? if something is unclear just ask
[19:22:06] <olsonjeffery> also i think we have enough to start looking at an io::println replacement, but there should be a discussion as the default API surfaced in rt::io::file doesn't expose the right path for us to do that..
[19:22:14] <adridu59> maik: also, a very interesting thread for modern languages http://forum.dlang.org/thread/kcklnceisavmhhsfvbge@forum.dlang.org
[19:22:24] <myname> nsf: i should read a bit before asking dumb questions :)
[19:22:25] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[19:23:12] <graydon> olsonjeffery: personally I'd like to see end-user-usable APIs emerge into std::io so we can start migrating code to them, rather than aiming for perfection in the lower levels. Very basic "open files, read and write, access to stdin/out/err" sort of stuff. I'm not sure what brson prefers though and I think his preferences trump mine on this : )
[19:23:50] <olsonjeffery> ok. yeah.. the file api needs more work, in that case.
[19:24:02] <olsonjeffery> and its undergone no real stress testing.
[19:24:09] <lkuper> graydon: since you're in that thread anyway, do you think that "For the record, I think augmented assignments are a terrible ideas and one of the worst features of python." is worth a code-of-conduct nudge?
[19:25:01] <graydon> lkuper: it's pretty harsh. I feel like a poor judge of these things, this week; been too yelly myself, trying to regain composure
[19:25:05] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[19:25:09] <graydon> I did ask for "more constructive" :(
[19:25:44] *** Joins: KindOne (KindOne@3AD84C25.DFA916E1.34F73994.IP)
[19:26:59] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:27:23] <lkuper> graydon: ok.  I don't know about yelly, but I get annoyed when people use rust-dev as their personal language design soapbox.  not what it's for.
[19:27:44] <graydon> agreed
[19:28:00] <graydon> I was yelly in meetings, you weren't there.
[19:28:27] *** Joins: mythos (mythos@moz-E5AF8019.uni-klu.teleweb.at)
[19:28:51] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[19:30:06] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[19:30:19] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[19:33:09] *** Quits: robertknight (robertknig@moz-731801B5.range86-144.btcentralplus.com) (Ping timeout)
[19:33:46] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Quit: Leaving)
[19:34:41] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:34:41] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Ping timeout)
[19:34:52] *** Quits: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP) (Quit: Textual IRC Client: www.textualapp.com)
[19:34:53] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:35:13] *** bent is now known as bent|brb
[19:35:13] <kmc> probably we should add dependent types to Rust just for this purpose, and require the impl to include a proof that a+=b === a=a+b
[19:35:43] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[19:36:36] <Ms2ger> We should clearly enforce that all rust programs have a correctness proof
[19:36:52] <Yoric> That sounds like a plan.
[19:36:58] *** mihneadb|lunch is now known as mihneadb
[19:36:59] <Yoric> Then we might extract Rust code to Coq, too.
[19:37:20] <kmc> agda 4 lyfe
[19:37:21] <Earnestly> Simple, making it non-turing complete. :P
[19:37:30] <Ms2ger> Who needs that anyway
[19:37:46] <Earnestly> s/making/make
[19:38:19] <jensnockert> Has anyone built rust code for an Arduino Due?
[19:38:22] <Ms2ger> Random tweet: "Nobody At Work Will Talk to Me but I Have Thoughts on Design"
[19:38:38] <jensnockert> I know of https://github.com/neykov/armboot
[19:38:45] <jeaye> Is it possible to call a stati function on a generic type that's bound to a trait (where the static function is in the trait)? See: http://dpaste.com/1354459/
[19:39:23] *** Quits: mortisha (Mibbit@3D0FFDCF.95F86AD9.520CDC98.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:41:52] <SimonSapin> I wish we had associated items. (In the meantime Iâ€™ll use methods that happen to have the same name + generated code.)
[19:42:32] <nmatsakis> jeaye: that is not currently possible.
[19:42:44] <nmatsakis> jeaye: the type of the fn must involve `Self` somewhere (even as a dummy parameter)
[19:42:51] *** Joins: sigma (sigma@moz-E971158A.range109-145.btcentralplus.com)
[19:43:14] <nmatsakis> jeaye: e.g., fn get_str(_: Option<Self>) -> ~str
[19:43:23] <nmatsakis> then invoke as Trait::get_str(None::<T>)
[19:43:35] <jeaye> tricksy
[19:44:03] *** Quits: sigma (sigma@moz-E971158A.range109-145.btcentralplus.com) (Connection reset by peer)
[19:44:05] <kimundi> wouldn't fn gen_str<Self>() -> ~str; Trait::get_str::<T>() work too?
[19:44:06] <lkuper> kmc: y'know, the rust-dev thread earlier today about arithmetic in types is pretty much asking for dependent types.
[19:44:07] <SimonSapin> How is Self supposed to be used? I always get error: use of undeclared type name `Self`
[19:44:41] <lkuper> from what I've seen, someone asks for dependent types at least every six months.
[19:44:44] <kimundi> SimonSapin: you write Self only in an trait definition
[19:44:57] *** Joins: sigma (sigma@moz-E971158A.range109-145.btcentralplus.com)
[19:44:59] <jeaye> Ok, given a `&mut Trait`, can I cast to `&mut Implementor`?
[19:45:10] <kimundi> SimonSapin: In the implementation, you write the type you're implementing instead
[19:45:20] <kimundi> jeaye: nope
[19:45:35] <nmatsakis> jeaye: no.
[19:46:04] <SimonSapin> kimundi: for some reason I thought Self-in-impl would be a shortcut for when the type when itâ€™s long to type, but ok
[19:46:27] <kimundi> SimonSapin: It probably should be, there's an issue for that
[19:46:40] <nmatsakis> graydon: so I've been poking at this crash with my object-based-visitor -- but little progress so far at divining its cause, except to say it's not a simple "it crashes every time" sort of thing
[19:46:57] <SimonSapin> "thereâ€™s an issue for that" seems to be a recurrent theme ;)
[19:46:58] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[19:46:59] <kimundi> Hm, does someone else want to take a look at/find errors in my module tutorial rewrite? https://gist.github.com/Kimundi/6322035
[19:48:44] <jeaye> nmatsakis: So if I've a Director that has a ~[~State], there's no way I can query that director in a generic manner to treat, for example, the state at index 0 as Foo, which implements State?
[19:48:54] <erickt> graydon: ping
[19:49:02] <jeaye> They are effective stuck as State once they go into the Director?
[19:49:20] <SiegeLord> kimundi, "In case you already stumbled over extern mod" <- what does that refer to? There's no 'extern mod' in the code
[19:50:39] *** Joins: sebcrozet (sebcrozet@moz-2517AE39.w80-13.abo.wanadoo.fr)
[19:51:35] <Ralith> lkuper: dependent types *are* pretty great
[19:51:45] *** bent|brb is now known as bent
[19:52:03] <lkuper> Ralith: it's funny how quickly you can get into territory where you need them
[19:52:04] <nmatsakis> jeaye: yes. of course you could add a as_Foo() method to State
[19:52:10] <nmatsakis> jeaye: but right now we don't support downcasts
[19:52:22] <Ralith> lkuper: this is why I contribute to Idris ^^
[19:52:25] <SimonSapin> are dependent types the same as associated types?
[19:52:31] <lkuper> Ralith: right on!
[19:52:32] <Ralith> SimonSapin: no.
[19:52:50] <lkuper> SimonSapin: no, sorry, interleaved conversation.  totally different thing.
[19:53:17] <kimundi> SiegeLord: Not in the example, no. That statement was meant for rust code in general... Maybe it's unneccessary to have it there.
[19:53:18] *** Quits: sigma (sigma@moz-E971158A.range109-145.btcentralplus.com) (Ping timeout)
[19:53:19] <SiegeLord> Hmm, I already learned something new in this module toturial... so 'priv' fields are accessible by anybody inside the module?
[19:53:36] <lkuper> Ralith: I just saw a cool talk on Idris, looking forward to more like it
[19:53:52] <Ralith> lkuper: OPLSS?
[19:54:13] <kimundi> SiegeLord: Yup
[19:54:27] <SimonSapin> so what are dependent types? Thing like this? type Foo<N> = [int, ..N]
[19:54:35] <SimonSapin> s/Thing/Things/
[19:54:35] <lkuper> Ralith: yep!  dchristiansen gave a talk
[19:54:48] *** Joins: sigma (sigma@moz-90571006.range86-140.btcentralplus.com)
[19:54:52] <nsf> may I ask, what 'self means in rust?
[19:55:03] <kimundi> SimonSapin: I don't knwo what depenet types are exactly, but I know that ain't it.
[19:55:04] <lkuper> SimonSapin: in general, they're types that can contain expressions
[19:55:11] <Ralith> lkuper: yeah, good to hear it went well
[19:55:18] <kimundi> nsf: 'foo is a lifetime annotation
[19:55:30] <kimundi> nsf: 'self is just such an lifetime
[19:55:36] <nsf> any docs on that?
[19:56:21] <kimundi> nsf: For legacy reason, in certain contexts it hast to be literally the name self, but exept from that difference they all work the same
[19:56:23] <kimundi> nsf: sure
[19:56:27] *** Quits: KindOne (KindOne@3AD84C25.DFA916E1.34F73994.IP) (Ping timeout)
[19:56:35] <kimundi> nsf: look at the borrowed pointer tutorial
[19:56:59] <lkuper> SimonSapin: various languages have them in some limited form or other.  Haskell keeps inching closer to having arbitrary dependent types.  Some other, more exotic languages really do have full dependent types.  it's an enormous rabbit hole to fall down, if you're interested in such things.
[19:57:02] <Ralith> kimundi: rust has legacy reasons for things already?
[19:57:04] <nsf> kimundi: k, thanks
[19:57:19] <kimundi> nsf: http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html
[19:57:54] <SiegeLord> kimundi, I'd redo the bit at the end of the Files and modules section. There's no point in referring to the old tutorial, but the bit about using the same file multiple times is an important point that can be made directly
[19:58:07] <kimundi> Ralith: Well, yeah. 'self used to be special, but it isn't anymore today. But the code that insists on it being special still exists
[19:58:21] <kimundi> SiegeLord: Hm, yeah
[19:58:37] <SimonSapin> Ralith: afaik "legacy" in rust more often means changes that are not complete yet rather than keeping compat with existing code
[19:58:41] *** Joins: KindOne (KindOne@moz-6BC867C3.dynamic.ip.windstream.net)
[19:59:21] <nsf> kimundi: thanks again, reading it already
[19:59:35] <lkuper> (ok, I wrote back to rust-dev with a code-of-conduct thing.  that gets a little bit less terrifying every time!)
[20:00:04] <Ralith> SimonSapin: dependent types are founded in (various analogs of) intuitionistic type theory or the calculus of constructions, which is an effort to provide a fundemental foundation for mathematics similar to set theory. Informally, they give you first class types and, depending on use of unsafe escape hatches, can even make it possible and sometimes even easy to prove correctness properties of your programs.
[20:00:58] <SiegeLord> rusti: use a = int;
[20:01:01] -rusti- pastebinned 8 lines of output: http://ix.io/7wv
[20:02:16] *** Quits: mindcat (mindcat@27373DB7.2AF6B358.291A146C.IP) (Quit: Lost terminal)
[20:02:22] <Ralith> SimonSapin: note that there's a lot of open problems regarding compiling and optimizing dependently typed programs well, so they're not necessarily a prudent choice for a language that aspires to be high-performance in the immediate future.
[20:02:27] *** Quits: KindOne (KindOne@moz-6BC867C3.dynamic.ip.windstream.net) (Ping timeout)
[20:03:39] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[20:04:03] <lkuper> Ralith: delicately put.
[20:04:29] <Ralith> ^^
[20:05:04] *** Joins: josh (josh@moz-D3896A24.dhcp.dlth.mn.charter.com)
[20:06:25] *** Joins: KindOne (KindOne@moz-6BC867C3.dynamic.ip.windstream.net)
[20:07:48] <lkuper> Ralith: I'm working on a project where I want to enforce properties that it's really hard to convince Haskell's type system to enforce, and we're having to bend way over backwards to get it to work, to the point where I don't really understand the code anymore.  Idris looks awfully appealing from here.
[20:08:19] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[20:09:01] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[20:09:04] <Ralith> lkuper: yeah, as much as haskell loves to reach that way it's really a mess. I really believe that Idris is the future there--but I caution that it's not ready for production use yet.
[20:09:12] <adridu59> what's the do while syntax in Rust?
[20:09:23] <adridu59> I got a `do` must be followed by a block call
[20:09:32] <joelteon> yeah do isn't related to loops
[20:09:43] <Eridius> adridu59: loop {} with a test at the end?
[20:09:55] <Eridius> loop { ... if foo { break } }
[20:09:56] <Ralith> the old Haskell LLVM bindings had the same problem; the hoops you had to jump through even just to construct a function whose arity was not statically known by the Haskell compiler were crazy.
[20:10:09] <adridu59> Eridius: ok, ty!
[20:10:46] <adridu59> besides that do is used for other purposes, is there a reason why the devs did not include the classic do {} while; ?
[20:11:22] <lkuper> adridu59: I wonder if you could implement it as a macro.
[20:11:44] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:12:18] *** Quits: sigma (sigma@moz-90571006.range86-140.btcentralplus.com) (Ping timeout)
[20:12:29] <adridu59> lkuper: I dunno about macro yet since I'm a newbie but thanks for the tip, I'll keep that in mind
[20:13:00] <pauls> It should be totally implementable as a macro.
[20:13:35] <lkuper> pauls: do you have an alert set up for 'macro' in this channel?
[20:13:45] <pauls> lkuper: maaaaaaaybe
[20:13:50] <lkuper> pauls: ...Just wondering.
[20:13:57] <pauls> ( :
[20:14:09] *** Joins: sigma (sigma@moz-9E7557E0.range81-157.btcentralplus.com)
[20:14:24] <nsf> are there any other uses for named lifetimes besides returning a borrowed pointer?
[20:14:41] <Eridius> a lifetime parameter on a struct?
[20:14:54] <strcat> rusti: struct Foo<'self> { a: &'self int }
[20:14:55] -rusti- ()
[20:15:13] <strcat> rusti: struct Foo<'self> { a: &'self int } let x = Foo { a: &5 }; *x.a
[20:15:14] -rusti- 5
[20:15:15] <nsf> oh, ok, I see
[20:15:35] <strcat> (atm you have to call a type parameter 'self, but it has no special meaning and that restriction should go away)
[20:16:29] <nsf> an interesting concept
[20:16:42] <nsf> a bit hard to understand at first, but seems useful
[20:18:47] <nsf> so, I have an idea of a use case, correct me if it's wrong.. imaginary io::BufReader takes &io::Reader on construction, but with restriction that its lifetime should match the lifetime of the BufReader itself
[20:18:50] <nsf> sounds right?
[20:19:10] *** Quits: sigma (sigma@moz-9E7557E0.range81-157.btcentralplus.com) (Ping timeout)
[20:19:35] *** Joins: sigma (sigma@moz-362E406E.range109-149.btcentralplus.com)
[20:19:40] <adridu59> how can I do bitwise arithmetic in Rust?
[20:20:19] <sfackler> same as c
[20:20:21] <sfackler> rusti: 1 | 2
[20:20:24] -rusti- 3
[20:21:15] *** Quits: sigma (sigma@moz-362E406E.range109-149.btcentralplus.com) (Ping timeout)
[20:21:16] <adridu59> hmm... I think I said it wrongly, want I want to do is casting a decimal value into binary code
[20:21:32] <adridu59> or doing arithmetics or the binary value
[20:21:40] <adridu59> on*
[20:21:44] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Ping timeout)
[20:22:02] *** Joins: sigma (sigma@moz-2F9FC384.range86-136.btcentralplus.com)
[20:22:09] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:23:01] <SimonSapin> adridu59: not sure what you mean, integers are binary in memory
[20:23:06] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[20:24:51] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[20:25:20] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:26:09] <adridu59> SimonSapin: I said it wrongly.. nevermind anyway I found another way to do my checks
[20:26:35] <SimonSapin> uh, ok
[20:26:58] <adridu59> I wanted to check if the last bin number was zero
[20:27:01] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[20:27:32] <adridu59> it's another way to find out if a number is even, but modulo might be more efficient then that (and simpler to code of course)
[20:27:50] <carleastlund> Does this program cause a bus error before printing "finish" for anyone else? https://gist.github.com/carl-eastlund/6323637
[20:28:02] *** kimundi is now known as zz_kimundi
[20:28:18] <sfackler> adriu59: foo & 1 == 0
[20:28:19] <pepper_chico> wow, just compiled rust yesterday and trying out the www.rust-lang.org front page sample does not compile =/, really influx right now
[20:28:25] <Eridius> sfackler: 2 not 1
[20:28:36] <Eridius> oops I misread
[20:28:38] <Eridius> thought you used %
[20:28:43] <sfackler> rusti: (15 & 1, 14 & 1)
[20:28:44] -rusti- (1, 0)
[20:28:53] <Eridius> adridu59: `a % 2 == 0` and `a & 1 == 0` should end up as the same thing under optimization anyway
[20:29:12] <mm> pepper_chico: Yeah, the sample on the homepage compiles with 0.7 but not master
[20:29:29] <adridu59> sfackler: nice, Edidius: really? I should stick up to modulo then
[20:30:09] <pepper_chico> mm, oh, ok...
[20:30:12] *** Quits: Guest__ (textual@moz-15DCD320.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:30:19] <adridu59> BTW what are these multiple values wrapped in parenthesis, are these arrays? I've seen that it's a way to do multiple function returns
[20:30:30] <nsf> adridu59: tuples
[20:30:32] <sfackler> they're tuples
[20:30:38] <Eridius> pepper_chico: https://gist.github.com/kballard/6323670
[20:30:58] <Eridius> oops reload, I left a bug in
[20:31:30] <Eridius> well damn, the 0.8 version doesn't actually compile because it doesn't know the type of i. Surprised that doesn't affect the 0.7 version (or maybe it does?)
[20:31:45] * Eridius updates again to fix it
[20:31:49] <Eridius> err the type of x
[20:32:02] *** Quits: sigma (sigma@moz-2F9FC384.range86-136.btcentralplus.com) (Ping timeout)
[20:32:17] <adridu59> what makes tuples differ from classic arrays?
[20:32:33] <Eridius> an array is a homogenously-typed collection
[20:32:39] <Eridius> a tuple is a heterogenously-typed collection
[20:32:40] *** Quits: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de) (Ping timeout)
[20:32:50] <engla>  it's not a collection
[20:33:01] <Eridius> well ok, it's a set of values, but it doesn't behave like traditional collections
[20:33:01] <engla> a tuple is a composite type just like a struct
[20:33:03] <adridu59> Eridius: honestly the new syntax is much better
[20:33:13] <pepper_chico> Eridius, tks
[20:33:18] <Eridius> adridu59: yeah the .advance was a stopgap while we transitioned from internal iterators to external ones
[20:34:39] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[20:34:56] <adridu59> Eridius: are you a Mozilla employee?
[20:35:55] <adridu59> doesn't matter much to me anyway lol
[20:36:00] <Eridius> no
[20:36:00] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[20:36:08] <Eridius> just a contributor
[20:38:21] <adridu59> right it's you who changed the iterator logic, I've seen that on the ml
[20:38:58] <Eridius> no I have a post on the ml concerning external iterators, but strcat's been the driving force
[20:39:31] <Eridius> I've just been doing sort of clean-up work on iterators (mostly dealing with implement size_hint correctly everywhere)
[20:39:33] *** Joins: sigma (sigma@moz-65B988C6.range31-53.btcentralplus.com)
[20:39:38] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[20:40:35] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:41:09] <adridu59> k! :)
[20:41:25] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[20:41:28] <engla> there's a lot to be done with it, and finding good ways to express algorithms with iterators
[20:41:41] *** zz_kimundi is now known as kimundi
[20:42:03] *** Quits: sigma (sigma@moz-65B988C6.range31-53.btcentralplus.com) (Ping timeout)
[20:42:28] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[20:43:16] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:43:21] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[20:43:25] *** Joins: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de)
[20:43:52] *** Joins: sigma (sigma@moz-5232422C.range109-148.btcentralplus.com)
[20:45:13] *** Joins: jb (Mibbit@moz-EE9A6FB0.bredband.comhem.se)
[20:45:26] *** Quits: KindOne (KindOne@moz-6BC867C3.dynamic.ip.windstream.net) (Ping timeout)
[20:46:10] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Client exited)
[20:46:37] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[20:47:10] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:47:19] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[20:47:20] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:47:42] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0a2/20130822004006])
[20:48:21] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Ping timeout)
[20:49:23] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:49:26] *** Joins: KindOne (KindOne@moz-F45FACAC.dynamic.ip.windstream.net)
[20:50:34] <brson> graydon: I'm going to revert the llvm upgrade until the perf regression is figured out. ok with you?
[20:50:45] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[20:51:00] <strcat> brson: it isn't necessarily a regression on anything but a few samples
[20:51:05] <strcat> the build didn't slow down
[20:51:26] <brson> strcat: compiler performance regressed a lot
[20:51:38] <graydon> strcat: there's a regression in that period but it's not clear to me if it's llvm or the new code from the visitor code duplication.
[20:52:00] <graydon> brson: I do not mind either way, nothing I'm working on depends on either version of llvm. I imagine patrick and niko might have input.
[20:52:24] <strcat> there's one issue I know about where we're generating invalid IR so LLVM decided to stop inlining transmute again
[20:52:31] <strcat> the old LLVM still inlined it
[20:52:35] <graydon> oh dear
[20:52:48] <graydon> that alone might well account for it
[20:54:58] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[20:55:16] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:55:16] *** ChanServ sets mode: +o tjc
[20:55:31] <strcat> acrichto's PR with the pass manager stuff might fix some issues
[20:55:32] *** Quits: Sergio965 (sergiobz@B578783D.28E21636.3A99D594.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:55:37] <strcat> I think we might have been doing target info wrong
[20:55:49] <acrichto> I didn't measure any difference in the examples with the revamped pass management
[20:56:12] <tjc> brson: r? https://github.com/mozilla/rust/pull/8712
[20:56:23] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[20:56:32] <acrichto> strcat: although if you think that our transmutes aren't getting inlined b/c of invalid things like bitcasts, that's probably the exact problem
[20:56:51] *** Quits: make_sense (make_sense@3302C3F5.C4E8BC8.6E60BEB9.IP) (Quit: Textual IRC Client: www.textualapp.com)
[20:57:52] <strcat> acrichto: well, it doesn't seem like a function call for transmute would usually be a big deal
[20:58:02] <strcat> only a certain few
[20:58:16] <strcat> let me try testing it a bit
[20:58:18] <acrichto> in the profiles I measured transmute was actually pretty high up
[20:58:18] <maik> why is this function upper camel case? http://seld.be/rustdoc/master/std/path/fn.PosixPath.html
[20:58:35] <strcat> legacy cruft
[20:58:48] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[20:58:48] *** ChanServ sets mode: +o pcwalton
[20:58:49] <strcat> (well that applies to std::path as a whole :P, needs to be redone)
[20:59:07] <maik> okay :D
[20:59:39] <acrichto> graydon: also re your comment on the llvm passes, another major change is that in addition to running "module passes" we're also running per-function passes. The passes run over each function individually are a subset of the passes run over the module, and I think that the reason is to speed up later module optimizations (get easy stuff out of the way first). It's what clang does as strcat found out and it's probably good if we do the same thing
[20:59:57] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[20:59:58] <acrichto> otherwise it's true that we're reverting back "to the old behavior" but with an enhanced C API that I wrote in PassWrapper.cpp
[21:00:04] <strcat> they also plan on doing function passes in parallel in the future
[21:00:17] <acrichto> that would be really cool
[21:00:20] <acrichto> also makes sense
[21:00:32] <pcwalton> can I r+ https://github.com/mozilla/rust/pull/8637 ?
[21:00:50] <acrichto> pcwalton: I'd rather figure out the names first and then move it through
[21:01:02] <pcwalton> yeah, basically I'm asking if anyone objects to printf/fprintf/sprintf
[21:01:21] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:01:22] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f11da1d to 142c0f9bd: 02http://git.io/N3iJvQ
[21:01:22] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:01:23] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:01:23] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/hTPCsA
[21:01:23] <ghrust> 13rust/06auto 1486ca4c5 15Tim Chevalier: rustpkg: Test that different copies of the same package ID can exist in multiple workspaces...
[21:01:23] <ghrust> 13rust/06auto 146a3d231 15bors: auto merge of #8712 : catamorphism/rust/rustpkg-issue-7241, r=pcwalton...
[21:01:23] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:01:30] <strcat> sprintf returns ~T? or takes &mut str
[21:01:38] <acrichto> pcwalton: if we decided printf/fprintf/sprintf I'd have to update the pull request
[21:01:45] <acrichto> strcat: sprintf returns ~str
[21:01:47] <pcwalton> ok
[21:02:03] <brson> acrichto: have your pass manager changes already landed? is an llvm revert going to interfere with that?
[21:02:19] *** Quits: KindOne (KindOne@moz-F45FACAC.dynamic.ip.windstream.net) (Ping timeout)
[21:02:23] <acrichto> brson: they have no landed, and while there may be merge conflicts I don't believe that there's any logical conflicts
[21:02:27] <acrichto> not*
[21:02:50] <strcat> acrichto: can you link to that example where the slowdown happened?
[21:02:58] <strcat> if you remember the bug
[21:03:00] <acrichto> strcat: it's on the bug
[21:03:10] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[21:03:17] <acrichto> strcat: https://github.com/mozilla/rust/issues/8665#issuecomment-23143039
[21:03:20] <strcat> thanks
[21:03:53] *** Quits: sigma (sigma@moz-5232422C.range109-148.btcentralplus.com) (Ping timeout)
[21:03:58] <acrichto> pcwalton: engla brought up a fairly good alternative of print/write/fmt
[21:04:21] *** Joins: sigma (sigma@moz-2579BD0C.range109-148.btcentralplus.com)
[21:04:23] <engla> the char_iterator bench tests I added are 10x slower. They use slice_unchecked which uses transmute to create a new string slice
[21:04:30] <pcwalton> do we have bugs filed on all this "invalid IR" we're generating?
[21:04:31] <acrichto> I'd still be in favor of printf/fprintf/sprintf, but not because print/write/fmt has any particular drawbacks (other than perhaps being a tad less indicative of the formatting that's happening)
[21:04:37] <graydon> pcwalton: no objection except maybe that .. we don't support printf-style strings
[21:04:38] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[21:04:53] <strcat> yeah I think it's just this undef behaviour lint yells about
[21:04:59] <graydon> the names are certainly intuitive, just that the args people will guess don't work
[21:05:00] <adridu59> acrichton: nice, that's how D does it
[21:05:01] <strcat>   %20 = call %"struct.std::unstable::raw::Vec<()>[#1]"** bitcast (i64 ({ i64, %tydesc*, i8*, i8*, i8 }*, %"struct.std::unstable::raw::Closure[#1]"*)* @"_ZN4cast14transmute_490817_46c181e2c941b02f7_0$x2e0E" to %"struct.std::unstable::raw::Vec<()>[#1]"** ({ i64, %tydesc*, i8*, i8*, i8 }*, { i64, i64, [0 x i8] }**)*)({ i64, %tydesc*, i8*, i8*, i8 }* undef, { i64, i64, [0 x i8] }** %19)
[21:05:03] <strcat> Undefined behavior: Call return type mismatches callee return type
[21:05:04] <engla> acrichto: my suggestion would be  print!(), println!(), write!(), format!()
[21:05:13] <strcat> brson: ^ I'm going to try fixing these, it might fix any regression from LLVM updating
[21:05:40] <acrichto> strcat: I suspected those as well, but we were definitely generating the same IR on the old LLVM (so it's not like that regressed)
[21:05:49] <strcat> acrichto: yeah but it's undef behaviour
[21:05:51] <acrichto> adridu59: you mean with print/write/fmt?
[21:05:56] <strcat> they can stop supporting it (as in compiling something sensible) any time
[21:06:08] <acrichto> engla: it seems odd to have println without writeln 
[21:06:10] <strcat> and it definitely doesn't get inlined anymore
[21:06:23] <brson> strcat: ok, great. the llvm revert is at the back of the queue so it's a race
[21:06:27] <acrichto> then I think that's definitely the problem (or at least one)
[21:06:28] <strcat> heh
[21:06:31] *** Joins: KindOne (KindOne@moz-6EA5D2F0.dynamic.ip.windstream.net)
[21:06:36] <brson> pcwalton graydon: i also think using c naming with not-c formatting is wierd
[21:06:45] <brson> not that I'm following this issue closely
[21:06:50] <strcat> some other languages use printf
[21:07:03] <acrichto> oh that's a good point
[21:07:06] <acrichto> I hadn't thought of that...
[21:07:10] <strcat> hm
[21:07:11] <adridu59> acrichto: not fmt but print/println  and write/writeln http://dlang.org/phobos/std_stdio.html#.File.write
[21:07:12] <graydon> yeah. I will be fine with any conclusion here, we'll live.
[21:07:16] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:07:18] <strcat> scala's is pretty C like though
[21:07:30] <engla> acrichto: that's details, but.. I don't know.  it will still support non-string output?  the general case doesn't necessarily need to have a quick way to add newlines
[21:07:41] <strcat>   %43 = call i8* bitcast (i64 ({ i64, %tydesc*, i8*, i8*, i8 }*, %"struct.std::unstable::raw::Closure[#1]"*)* @"_ZN4cast14transmute_490817_46c181e2c941b02f7_0$x2e0E" to i8* ({ i64, %tydesc*, i8*, i8*, i8 }*, %"struct.std::unstable::raw::Closure[#1]"*)*)({ i64, %tydesc*, i8*, i8*, i8 }* undef, %"struct.std::unstable::raw::Closure[#1]"* %dest.i.i.i.i.i.i)
[21:07:45] <strcat> that's.... special
[21:07:48] <brson> my mingw install doesn't build jemalloc correctly
[21:08:00] <strcat> brson: as in it breaks?
[21:08:06] <brson> strcat: the build fails
[21:08:12] <brson> and for some reason the bots are not building jemalloc
[21:08:15] <brson> windows bots
[21:08:16] <strcat> weird
[21:08:52] <strcat> I remember building it ages ago before we turned it off
[21:08:54] <strcat> on windows
[21:09:03] <strcat> I guess the makefile broke in the meantime
[21:10:38] <strcat>  wonder why it is using i64 instead of i8 *
[21:10:46] <adridu59> acrichto: D has writef/writefln which can do both FILE* or stdout (iirc)
[21:11:09] <acrichto> adridu59: oh interesting...
[21:11:24] <adridu59> acrichto: if you input FILE* as first arg it will process as file
[21:11:59] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:12:39] <acrichto> adridu59 pcwalton engla: how would you guys feel about {print,println}/{write,writeln}/fmt as the set of macros ? I think brson's concern for printf-implying-% is worrying enough for me to change my mind
[21:13:30] <strcat> it's mad about local_data too
[21:13:32] <pcwalton> that's fine, I'm not that enamored with fmt though
[21:13:39] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[21:13:47] <pcwalton> people have complained about fmt looking ugly
[21:13:54] <Eridius> people complain about lots of stuff
[21:13:55] <pcwalton> "format"?
[21:14:11] <engla> I'm suggesting format!() for the "sprintf" case since we can afford a longer name when print(fmt!()) is not the thing to use anymore
[21:14:18] <pcwalton> right
[21:14:20] <pcwalton> I like format!
[21:14:31] <Eridius> well you don't have to sound too excited!
[21:14:38] <acrichto> I always love when a stenence ends with a  macro :)
[21:14:41] <andrew-d> (... Eridius beat me to it :P )
[21:14:44] <strcat> transmute is really complicated ;[
[21:14:50] <pcwalton> macros in rust are always exciting!
[21:14:58] <andrew-d> ... we need an exciting!() macro
[21:14:58] <adridu59> yea not sure about fmt through I can see any viable alternative... format! seems unnecessarily long to me
[21:15:03] <andrew-d> That prints something at compile time
[21:15:05] <acrichto> ok, I'm going to update that pull request tonight, and hopefully snapshot/start migrating soon
[21:15:19] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[21:15:27] <strcat> alright so I think for immediate types, transmute isn't doing a cast
[21:15:42] <acrichto> adridu59: format/sprintf are about as equally long and engla has a good point that this discourages print(fmt!(...)) 
[21:15:43] <strcat> it's relying on undef behaviour to transform the ret type
[21:15:44] <pcwalton> whoops
[21:15:47] <strcat> going to hope that fixes it
[21:15:48] <pcwalton> haha
[21:15:50] <pcwalton> that's awful
[21:15:55] <pcwalton> thanks for looking into it strcat
[21:16:03] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[21:16:06] <acrichto> that would be very unfortunate :(
[21:16:09] <adridu59> acrichto: good point
[21:16:14] <strcat> hm
[21:16:32] <strcat> pcwalton: well.... it does attempt to do a pointer cast but I don't see it in the IR ;\
[21:17:01] <sam113101> would you guys use rust for web dev?
[21:17:04] <pcwalton> haha
[21:17:06] * strcat will just try playing with it a bit
[21:17:07] <sam113101> s/guys/people/
[21:17:11] <pcwalton> I would happily use rust for web dev
[21:17:14] <graydon> I'm fine with format! if we're not nesting it in write!() calls. part of the point of this is to get the amount-of-string-building substantially lower.
[21:17:28] <pcwalton> for high performance servers
[21:17:39] <acrichto> graydon: yeah write!() would be write!(&mut io::Writer, &str, format...)
[21:17:42] <mihneadb> pcwalton: I think the word you are looking for is webscale! :P
[21:17:53] <toddaaro> is there a bigger word than webscale now?
[21:17:57] <toddaaro> big data scale?
[21:18:02] <toddaaro> datascale?
[21:18:04] *** Quits: Ms2ger (Ms2ger@moz-590E79FE.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:18:04] <acrichto> pcwalton: would you be ok with engla's suggestion of removing print/println from the prelude as well?
[21:18:10] <mihneadb> toddaaro: could be
[21:18:13] <strcat>                         Some(llretptr) => {
[21:18:13] <mihneadb> we'd have to check twitter
[21:18:15] <strcat>                             Store(bcx, llsrcval, PointerCast(bcx, llretptr, llintype.ptr_to()));
[21:18:17] <pcwalton> acrichto: +1
[21:18:17] <strcat> pcwalton: I think it's just this
[21:18:22] <strcat> it casts to the in type, not the out type
[21:18:22] <acrichto> pcwalton: ifmt fixes the bug that printf!("a") => ~"\"a\""
[21:18:23] <strcat> heh
[21:18:28] <pcwalton> strcat: haha
[21:18:30] *** Joins: lkuper_ (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[21:18:45] <pcwalton> if I were a startup looking to quickly get something out before demo day I'd probably use Rails instead though
[21:18:49] <acrichto> engla: btw thanks for your suggestion :)
[21:18:54] <engla> acrichto: that's very nice (that fix)
[21:18:54] <strcat> lets see if I fixed something
[21:19:05] <mihneadb> "gem install everything"
[21:19:06] <pcwalton> and then migrate to Rust when I find traction ;)
[21:19:09] <graydon> wat
[21:19:13] <graydon> we cast to the _input_ type?
[21:19:20] <SiegeLord> Why is printf being removed from the prelude?
[21:19:22] <strcat> graydon: some transmutes
[21:19:28] <strcat> graydon: it relies on undef behaviour to "cast" it
[21:19:30] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[21:19:32] * graydon wonders if I wrote that
[21:19:36] <strcat> and I think the LLVM upgrade decided to be unhappy
[21:19:45] <graydon> yeah I'm following this saga
[21:19:45] <strcat> I don't think a specific person wrote it, I think it evolved to this ;p
[21:19:58] <graydon> naturally. if we had rustfix we could blame it :)
[21:20:21] <strcat> anyway it'd be nice to fix all these lint warnings and turn it on by default
[21:20:39] <strcat> maybe we can make it abort
[21:20:51] * strcat doesn't know how long lint takes to run though
[21:20:54] <erickt> strcat: lint warnings? I believe I turned them into errors for libsyntax and librustc
[21:20:56] <graydon> I think we'd all like that to be true.
[21:21:01] <strcat> erickt: I mean llvm lint warnings
[21:21:02] <acrichto> SiegeLord: we're adding the `print!` and `println!` macros already, and print/println could be replaced by those
[21:21:04] <erickt> ah
[21:21:04] <graydon> llvm-lints
[21:21:14] <andrew-d> Random aside: I've got a 2-line patch for warnings.  Worth opening a PR for?
[21:21:17] <SiegeLord> acrichto, Ok, I see. Sounds good
[21:21:21] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[21:21:32] <engla> acrichto: I'm happy for avoiding abbreviations when simpler names suffice. 
[21:21:40] <acrichto> SiegeLord: I would like it to be just adding a ! at the end of most print statements
[21:22:06] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:22:11] <brson> i'm pretty far down the rabbit hole now trying to understand why the windows jemalloc build is so trippy
[21:22:16] <acrichto> andrew-d: what kind of warnings, compiler warnings?
[21:22:28] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:22:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:22:29] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:22:30] <andrew-d> acrichto: 1 unused import, 1 unused variable
[21:22:34] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[21:22:53] <acrichto> andrew-d: that's interesting, those shouldn't be in rustc any more (they should be denied by default)
[21:23:06] <maik> bjz, ping
[21:23:18] <andrew-d> ... interesting.  Gimme 2 seconds to push to Github
[21:23:22] <acrichto> andrew-d: have you rebased on master recently?
[21:23:31] <andrew-d> acrichto: Yeah, about 10 mins ago :P
[21:23:36] <acrichto> weird...
[21:23:55] <andrew-d> Maybe because they're in test/benchmark functions?
[21:24:01] *** Quits: squiddy (squiddy@moz-B3299262.adsl.alicedsl.de) (Input/output error)
[21:24:14] * jensnockert randomly hugs a person that knows anything about a Cortex Mx?
[21:24:25] <strcat> graydon: I'll laugh if this is why transmute has been giving lint warnings for *ages* though
[21:24:27] <strcat> since like... 0.4
[21:24:30] <acrichto> andrew-d: oh yeah in the test suite we're not denying warnings
[21:24:36] <strcat> (well that's when I started using rust ;p)
[21:25:08] *** Joins: reyre (reyre@BD51243A.8ACB8079.47C41102.IP)
[21:25:14] <andrew-d> acrichto: Ah, fair enough.  Either way: https://github.com/mozilla/rust/pull/8716
[21:25:29] <acrichto> graydon: one thing I meant to ask is why the LLVM upgrades weren't blocked by bors. I suppose that ratcheting is turned off, but this was a serious regression (10x for some tests), so even the simplest of ratcheting should have caught that?
[21:25:55] <brson> make clean doesn't clean jemalloc
[21:26:03] *** Joins: Quora (quora@moz-4E922014.student.iastate.edu)
[21:26:13] <acrichto> andrew-d: ah that explains it, could you change the `let _ =` to just the expression?
[21:26:22] <andrew-d> Will do
[21:26:33] <Quora> Hi, I was wondering how I would go about getting rust up and running on a non-glibc linux distro
[21:26:37] <strcat> brson: aha, so they built it once successfully, and are now using that?
[21:26:47] <brson> strcat: i believe so
[21:26:56] <brson> that doesn't explain why my machine can't build it though
[21:27:19] <andrew-d> acrichto: Done
[21:27:36] <bblum> https://github.com/mozilla/rust/pull/8718 r anybody
[21:27:40] <acrichto> andrew-d: thanks :)
[21:27:40] <pcwalton> graydon: linking is now the biggest pass
[21:27:47] <andrew-d> acrichto: And thank you :)
[21:27:50] <pcwalton> it's all metadata decompression and linking
[21:28:03] <brson> i'm going to revise my optimization to not destroy the llvm module
[21:28:15] <pcwalton> brson: i'm not sure it's that, it may just be starting up gcc is slow
[21:28:23] <brson> pcwalton: ah
[21:28:27] <pcwalton> maybe using ld instead of gcc is faster
[21:28:30] *** Joins: carllerche (carllerche@1E2EB9E3.186539A3.965084DF.IP)
[21:28:39] <brson> i'm also going to experiment with just calling libc::exit() after writing the output
[21:28:49] <andrew-d> brson: I've got a windows laptop (windows 7) lying around - need a second opinion?
[21:28:56] <andrew-d> (or something?)
[21:29:02] <SimonSapin> kimundi: why are some code lines prefixed with # in your module tutorial?
[21:29:41] *** Quits: reyre (reyre@BD51243A.8ACB8079.47C41102.IP) (Connection reset by peer)
[21:29:59] *** Quits: KindOne (KindOne@moz-6EA5D2F0.dynamic.ip.windstream.net) (Ping timeout)
[21:31:11] *** Quits: Kruppe (user@moz-EE1E894A.home3.cgocable.net) (Ping timeout)
[21:31:13] *** Joins: reyre (reyre@BD51243A.8ACB8079.47C41102.IP)
[21:31:26] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:31:26] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146a3d231 to 142c0f9bd: 02http://git.io/N3iJvQ
[21:31:26] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:31:27] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:31:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/W7kGHA
[21:31:28] <ghrust> 13rust/06auto 14329a829 15Brian Anderson: Revert "auto merge of #8328 : alexcrichton/rust/llvm-head, r=brson"...
[21:31:28] <ghrust> 13rust/06auto 14c957971 15bors: auto merge of #8714 : brson/rust/llvm-revert, r=brson...
[21:31:28] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:31:39] <brson> andrew-d: thanks, but i don't want to impose on you the pain of building on windows
[21:31:45] <andrew-d> brson: Hahaha
[21:31:59] *** Quits: lkuper_ (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[21:31:59] <brson> i am probably going to give up on it. this is kind of beside the point of what i'm trying to do
[21:32:17] <pcwalton> brson: do you have a branch that removes compression that I can experiment with?
[21:32:27] <brson> pcwalton: brson/no-compress-metadata
[21:32:31] <pcwalton> ok
[21:32:32] <brson> pcwalton: it disables compression by default
[21:32:57] <brson> pcwalton: still running tests here to try to understand the perf differences
[21:33:17] <strcat> acrichto: well I improved that benchmark from 60000ns -> 52000ns
[21:33:17] *** Joins: mib_ge0vbe (Mibbit@moz-47FF8735.hfc.comcastbusiness.net)
[21:33:21] <strcat> is that about what the regression was?
[21:33:28] <strcat> test bench_insert_std ... bench: 60196 ns/iter (+/- 1938)
[21:33:30] <strcat> test bench_insert_std ... bench: 51934 ns/iter (+/- 2161)
[21:33:32] <strcat> before and after
[21:33:37] *** Quits: mib_ge0vbe (Mibbit@moz-47FF8735.hfc.comcastbusiness.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:33:46] <sully> anyone want to review my PR for improving (slightly) llvm alias hints? https://github.com/mozilla/rust/pull/8719
[21:34:01] *** Joins: KindOne (KindOne@moz-5126C9B1.dynamic.ip.windstream.net)
[21:34:03] <strcat> there are still lint errors ;[
[21:34:04] <tjc> sully: I'll look at it
[21:34:26] <Quora> Does anyone know how I would go about doing a bootstrap for rust on Alpine Linux?
[21:34:38] *** Quits: sp3d (a@moz-6F12212B.fidnet.com) (Ping timeout)
[21:34:56] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[21:35:23] *** Quits: reyre (reyre@BD51243A.8ACB8079.47C41102.IP) (Quit: )
[21:35:24] *** Joins: sp3d (a@moz-6F12212B.fidnet.com)
[21:35:31] <Quora> I think I would need to do a bootstrap due to Alpine's glibc incompatability (Alpine uses uclibc)
[21:35:41] <brson> Quora: will probably require solving https://github.com/mozilla/rust/issues/7283
[21:35:41] <pcwalton> ok, 1 run-pass test failing with my branch
[21:35:47] <acrichto> strcat: :( is it a small change?
[21:36:00] <brson> Quora: make rust work with alternate libc's, then cross-compile
[21:36:13] <strcat> acrichto: meh it's still broken
[21:36:26] <Quora> brson: LLVM already works on alpine, what other work would have to be done?
[21:36:43] <pcwalton> strcat: well, that fixes a lot of them, no?
[21:37:16] <strcat> pcwalton: no actually, I was misunderstanding the issue
[21:37:21] <brson> Quora: rust bootstraps off of a snapshot binary that links to glibc, so you can't use it. you'll need to create a snapshot binary that works on Quora
[21:37:33] <strcat> it's mad about a bitcast *outside* of transmute
[21:37:53] <strcat> it casts transmute's signature to another
[21:37:56] <Quora> brson: What version of rust is old enough to have a working compiler in non-rust?
[21:38:01] <strcat> don't get why that would occur
[21:38:17] <Quora> written in*
[21:38:30] <mm> Quora: long, long ago.
[21:38:50] <brson> Quora: for various reasons it would be nice for rust to be completely self-contained, with it's own libc, so solving the above issue may be the quickest route here. that or maybe just compiling glibc for Quora, if that's possible
[21:38:56] <brson> Quora: sorry, Alpine
[21:39:02] <brson> confusing you with your distro!
[21:39:13] *** Quits: maik (maik___@moz-28AFE1D.dip0.t-ipconnect.de) (Ping timeout)
[21:39:14] <Quora> brson: I don't know if you can do that...you might be able to
[21:39:24] <SimonSapin> brson: could we static-link just the snapshots?
[21:39:26] <brson> Quora: of course the snapshot *also* requires the C++ standard library
[21:39:27] <Quora> ^
[21:39:37] <brson> SimonSapin: it's possible, yes. just requires work
[21:39:44] <Quora> If you static link it I will have no issues with the compile process
[21:39:49] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[21:41:03] <Quora> I'd like to get rid of my Debian chroot if I can >_>
[21:41:08] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[21:41:16] <strcat> you can't statically link glibc
[21:41:30] <strcat> the statically linked glibc will dynamically load stuff
[21:41:41] <graydon> yeah. the problem here is getting a build going on non-glibc
[21:41:53] <adridu59> why is there both Makefile and Makefile.in?
[21:41:54] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[21:41:59] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[21:42:19] <andrew-d> Might be able to statically-link something like musl or uClibc?
[21:42:20] <graydon> which is plausible. especially now that we're excising more and more C++, so the non-glibc libcs that don't happen to have compatible libstdc++s open up.
[21:42:26] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[21:42:31] *** Quits: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[21:42:32] <graydon> I have tried musl-cross builds before but didn't quite get it working
[21:42:51] <brson> rust will always need llvm though
[21:43:05] <graydon> ah true
[21:43:09] <strcat> and llvm is going to require C++11 eventually
[21:43:15] <strcat> lld does already
[21:43:16] <graydon> musl does have a libstdc++
[21:43:26] <strcat> we could ship libc++, it's 4MiB ;p
[21:43:27] <graydon> ish. or is willing to build one, somehow.
[21:43:51] <graydon> that would be acceptable to me if it supports static linking. the snapshots should really not have dynamic dependencies.
[21:43:54] <Quora> I'd like lclibc support more
[21:43:58] <Quora> uclibc*
[21:44:09] <graydon> sure. any of the above would be nice.
[21:44:17] <Quora> If you make a static binary, I can test it now
[21:44:38] <andrew-d> Technically, there's http://cxx.uclibc.org/
[21:44:59] <andrew-d> Probably not usable, though :(
[21:45:38] <andrew-d> And one more random link that sounds promising: http://wiki.musl-libc.org/wiki/BuildingLLVM
[21:46:32] <Quora> andrew-d: I am using an entire distro based on uclibc :P
[21:46:39] <Quora> http://alpinelinux.org
[21:46:40] <strcat> andrew-d: it's also not a C++ stdlib implementation
[21:46:55] <strcat> it's just a non-conforming subset
[21:48:58] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[21:49:06] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Quit: WeeChat 0.4.1)
[21:50:37] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[21:52:37] <Quora> graydon: How would I make a static rust compiler?
[21:53:12] <graydon> Quora: it'd involve changes to the compiler driver and link driver
[21:53:20] <graydon> Quora: we used to have support for it but I think it's bitrotted
[21:53:29] <strcat> define internal i64 @"_ZN4cast14transmute_493817_982cb773a319f4937_0$x2e0E"({ i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone, i64) #3 {
[21:53:31] <strcat> "function top level":
[21:53:33] <strcat>   ret i64 %1
[21:53:35] <strcat> }
[21:53:39] <andrew-d> Quora: I'd start by seeing if it's possible to build LLVM with uclibc or musl, frankly.  Bit of pointless endeavor unless that's possible
[21:53:44] <strcat> and then...
[21:53:45] <andrew-d> And that looks like the hardest part
[21:53:46] <Quora> andrew-d: You can
[21:53:47] <strcat>   %109 = invoke i8* bitcast (i64 ({ i64, %tydesc*, i8*, i8*, i8 }*, i64)* @"_ZN4cast14transmute_493817_982cb773a319f4937_0$x2e0E" to i8* ({ i64, %tydesc*, i8*, i8*, i8 }*, i8*)*)({ i64, %tydesc*, i8*, i8*, i8 }* undef, i8* %108)
[21:53:48] <strcat> :|
[21:53:51] <graydon> Quora: https://github.com/mozilla/rust/issues/552 is the old bug
[21:53:57] <strcat> why rustc, why
[21:54:01] <graydon> note: there was support, for a while
[21:54:15] <Quora> https://gist.github.com/Heartmender/10250212b28a373813fd
[21:54:16] <acrichto> strcat: that is... disturbing
[21:54:25] <strcat> yeah the actual transmute is a no-op
[21:54:31] <strcat> it does the work by casting it
[21:54:35] <graydon> Quora: I agree with andrew-d though. you'll want llvm and libuv builds on your libc-of-choice first.
[21:54:39] <strcat> I just don't see where this corresponds to the code
[21:54:49] <Quora> graydon: I have them
[21:54:54] <strcat> monomorphize might be doing it
[21:55:02] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[21:55:22] <strcat> not the collapsing, just the normalization
[21:55:36] <pcwalton> could it be type_use?
[21:55:41] <pcwalton> try disabling type use
[21:55:48] <pcwalton> -Z no-monomorphic-collapse
[21:55:50] <graydon> Quora: then the next part is ... probably digging in rust's history to find out what happened to the support we had and whether any of it still applies. we used to have support for outputting things called .rlibs which were static crates (as in that bug)
[21:55:59] <strcat> pcwalton: still happens with that
[21:56:01] <pcwalton> ok
[21:56:02] <graydon> Quora: at least that's where I'd start
[21:56:07] <strcat> pcwalton: I think it's just the regular monomorphize normalization
[21:56:13] <strcat> where it turns all pointers to ints
[21:56:23] *** Quits: jdm (jdm@97DF0582.DEAB171B.971E19F6.IP) (Quit: Lost terminal)
[21:56:24] <pcwalton> I see
[21:56:33] <Quora> I don't have enough experience in either ublibc or rust to be able to help there
[21:56:37] <strcat> no idea if this is causing the regression yet anyway
[21:56:40] <Quora> uclibc*
[21:58:27] *** Quits: heftig (heftig@moz-5E205539.dip0.t-ipconnect.de) (Ping timeout)
[21:58:32] *** Quits: sigma (sigma@moz-2579BD0C.range109-148.btcentralplus.com) (Ping timeout)
[21:58:43] *** Joins: heftig (heftig@moz-5E205539.dip0.t-ipconnect.de)
[21:59:08] <graydon> Quora: sorry! we're always a bit short of hands. might help to solicit others with similar interests..
[21:59:24] <Quora> graydon: I'm in a bit of a paradox here
[21:59:35] <Quora> graydon: I need to install rust to learn it better...
[22:00:24] <tjc> Somebody help me out here
[22:00:39] <tjc> I'm trying to figure out how long it takes to do a build on my machine, with/without optimization
[22:00:51] <graydon> Quora: sorry, we haven't got a static linux platform in our tier-1 group yet, aren't supporting the config you have in mind.
[22:00:57] <tjc> after configuring with --disable-optimize and --enable-debug, `make rustc-stage1` took about 20 minutes
[22:01:13] <tjc> I deleted build/ , reconfigured with --enable-optimize and --disable-debug, saw that it was rebuilding LLVM...
[22:01:18] * acrichto just learned of a new target for make
[22:01:21] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[22:01:22] <tjc> but from building stage0/libstd to the endâ€¦ also took 20 minutes
[22:01:24] <tjc> what am I missing?
[22:01:53] <jeaye> several minutes :P
[22:02:25] <strcat> pcwalton: yeah, disabling monomorphize's normalization removed 21 lint warnings out of 100
[22:02:29] <pcwalton> ok
[22:02:33] <acrichto> tjc: you could try VERBOSE=1 and see if -O is being passed correctly or not
[22:02:35] *** Quits: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net) (Quit: Leaving)
[22:02:54] <strcat> pcwalton: fixes the regression too
[22:03:00] <pcwalton> interesting
[22:03:11] <brson> strcat: you fixed the big llvm regression?
[22:03:13] <tjc> acrichto: Thanks, I'll try
[22:03:45] <strcat> brson: well, I fixed it by making monomorphize not normalize types
[22:03:46] <strcat> like
[22:04:09] <strcat> foo<u64, *i8> and foo<u64, u64>
[22:04:12] <strcat> become the same fn
[22:04:27] *** Joins: sigma (sigma@moz-CF0F7D12.range31-53.btcentralplus.com)
[22:04:28] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:04:36] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:04:37] <strcat> and then we get invalid bitcasts between function types
[22:04:40] <strcat> and LLVM refuses to inline
[22:04:44] <strcat> (it used to inline)
[22:05:02] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[22:05:04] <strcat> so I'm not sure if that's the real fix we'd want.
[22:05:25] <strcat> this would also fix this issue...
[22:05:27] <strcat> rusti: @mut 5
[22:05:29] -rusti- @5
[22:05:34] <strcat> rusti: (@mut 5,)
[22:05:35] -rusti- (@mut 5,)
[22:05:54] <strcat> it doesn't normalize recursively, but at the top level it turns @mut and @ to opaque_box
[22:06:27] <strcat> an 'optimization' that makes rust slower might as well be disabled though ;p
[22:07:01] <strcat> pcwalton: afaict type_use might still merge them anyways
[22:07:05] <strcat> I don't really understand this
[22:07:21] <graydon> I was digging in this code yesterday and .. I think that normalization and type_use should not be separate functions, they kinda fight with each other about responsibility
[22:07:52] <strcat> going to measure IR size with/without normalize
[22:07:53] <graydon> I think it'd be much better to make type_use smart enough to consider-equivalent the equivalences that appear in normalization.
[22:08:10] <strcat> graydon: but I think it does
[22:08:26] <graydon> you think it's entirely redundant at this point?
[22:08:28] <strcat> it bins them by representation
[22:08:32] <strcat> graydon: checking
[22:08:36] <graydon> mhm. it might well.
[22:09:01] <graydon> I mean, I think its notion of representation might be a little imprecise, I started trying to sketch improvements, but yeah, I'd believe it.
[22:09:15] <strcat> graydon: I think we should really just be using mergefunc anyway
[22:09:19] <strcat> it will be better
[22:09:25] <strcat> possibly slower, but it will merge a lot more
[22:09:27] <graydon> would also believe _that_ :)
[22:09:42] <graydon> depends if it runs early enough to save us dumping too much IR on parts that take a lot of time, imo
[22:09:52] <graydon> if it runs early and is itself fast, maybe that's best
[22:09:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:09:57] <graydon> goodness knows it'll be more correct
[22:10:18] *** Quits: sigma (sigma@moz-CF0F7D12.range31-53.btcentralplus.com) (Ping timeout)
[22:10:19] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:10:20] *** Joins: reyre (reyre@moz-89E9865B.com)
[22:10:35] <strcat> graydon: so we go from 410k lines of unoptimized IR for libstd to 420k - so it does do *something*
[22:10:44] <pcwalton> brson: not compressing results in a slight slowdown for me
[22:10:46] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[22:10:54] <strcat> but I think that "something" is wrong in some cases anyway
[22:10:59] <strcat> like the @/@mut one
[22:11:03] <strcat> anything with visit_glue maybe?
[22:11:22] <strcat> it means we can't have separate visit glue for raw pointers (hex) and integers
[22:11:44] * strcat wonders if disabling it will break fmt!
[22:11:45] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[22:11:45] *** Joins: sigma (sigma@moz-CB32731.range86-160.btcentralplus.com)
[22:11:59] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[22:12:40] <strcat> brson: I'm going to cancel the LLVM revert and just land this for now - updated LLVM is more important than a 2% unopt code size removal
[22:12:51] <strcat> the improvements in LLVM will make up for it
[22:13:27] <brson> strcat: ok
[22:13:55] <brson> pcwalton: on what test?
[22:13:59] <pcwalton> brson: hello world
[22:14:08] <brson> that's surprising
[22:14:13] <brson> i'm still building on mac here
[22:14:14] *** Quits: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Quit: leaving)
[22:14:18] *** Joins: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[22:14:28] <strcat> this is going to maybe break fmt! tests though
[22:14:30] <strcat> have to see
[22:15:04] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:15:05] *** Quits: sigma (sigma@moz-CB32731.range86-160.btcentralplus.com) (Ping timeout)
[22:15:28] *** Quits: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Quit: leaving)
[22:15:30] *** Joins: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[22:15:54] *** Quits: josh (josh@moz-D3896A24.dhcp.dlth.mn.charter.com) (Quit: josh)
[22:16:07] *** Joins: sigma (sigma@moz-8102CA76.range86-168.btcentralplus.com)
[22:16:21] <pcwalton> brson: wait, hmm
[22:16:24] <pcwalton> oh, I didn't reconfigure
[22:16:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:16:33] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Connection reset by peer)
[22:16:35] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[22:17:47] *** Quits: sigma (sigma@moz-8102CA76.range86-168.btcentralplus.com) (Ping timeout)
[22:17:59] *** Joins: inf-groupoid (user@580120F5.8ED93E28.1C8C8CE9.IP)
[22:18:03] <pcwalton> brson: graydon: 81.2% of hello world compilation time, with my patches, is in flate::inflate_bytes
[22:18:13] <kmc> odd, when I do Â«print pthread_getspecific(rust_get_rt_tls_key())Â» in GDB, it prints 0
[22:18:25] <graydon> pcwalton: that's a great improvement!
[22:18:27] <kmc> does that mean GDB is breaking in the wrong OS thread, or something?
[22:18:33] <pcwalton> well, we need to fix it
[22:18:33] <pcwalton> btw
[22:18:42] <pcwalton> 53.9% is spent in tinfl_decompress_mem_to_heap
[22:18:50] <pcwalton> 23.4% is spent in ptr::copy_memory
[22:18:50] *** Joins: sigma (sigma@moz-AD03D4C8.range86-136.btcentralplus.com)
[22:18:56] <graydon> pcwalton: in case you get the impression I'm somehow a defender of compression, by all means remove it if it goes faster. I was sure we added it as a speedup!
[22:19:07] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[22:19:36] <graydon> I think it's especially likely to be a win to remove if you get laziness working, so we aren't going to read the whole thing anyways
[22:19:44] * strcat wonders if that should be a copy_nonoverlapping_memory
[22:19:48] <graydon> if we play our cards right we can just mmap, not copy into memory at all
[22:19:52] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[22:19:57] <pcwalton> yeah, that'd be the biggest win.
[22:20:01] <graydon> (which is what it did several years ago :)
[22:20:04] <brson> kmc: no, that's probably correct. the tls key starts as -1
[22:20:08] <graydon> (like when it was .. dwarf)
[22:20:10] <brson> kmc: 0 is probably the first valid key
[22:20:17] <brson> oh wayt
[22:20:22] <brson> sorry, that's not the key but the value
[22:20:31] <kmc> yeah it should be a Task* i think
[22:20:54] <brson> kmc: the value is 0 when a task isn't running or if you're in a non-scheduler thread, yes
[22:21:09] <brson> kmc: the first thread is not used by a scheduler, so will have a value of 0
[22:21:26] <olsonjeffery> so...
[22:21:35] <doomlord> arrghhh
[22:21:54] <olsonjeffery> can i pull extra::time into std for FileInfo (tentative name for user-facing stat API)
[22:22:06] <olsonjeffery> or just returns msecs...?
[22:22:06] <kmc> what is the first thread used for, then?
[22:22:06] <brson> um, i'm lying again, usually scheduler threads will have a valid tls value. non-scheduler threads will not
[22:22:27] <olsonjeffery> well...uv returns  a uv_timespec_t .. which is pretty much an extra::Tm
[22:22:36] *** Joins: sprog (Mibbit@moz-425831C8.tmi.telenormobil.no)
[22:22:37] <olsonjeffery> msecs and nsecs are the fields..
[22:22:38] <brson> kmc: usually nothing. in serve it's used for a scheduler to run the glfw event loop, in which case it should have a tls value
[22:22:42] <brson> *servo
[22:22:42] <doomlord> running into the '...' issue :) scintilla people aren't updating scintilla with a rust highter, and geany people wont take an update that hasn't been through scintilla. so stuck with c highlighitng that shows '...<to end of line> as a string literal :)
[22:22:59] <kmc> mm
[22:23:13] <kmc> this is the initial 'platform thread' that comes from exec?
[22:23:35] <brson> kmc: yes
[22:23:46] <kmc> I ran with RUST_THREADS=1 and "info threads" shows 2 OS threads, and both give me zero
[22:23:54] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:23:56] <kmc> I haven't done much multithreaded debugging in GDB, though, so maybe I'm misinterpreting
[22:23:56] *** Quits: sprog (Mibbit@moz-425831C8.tmi.telenormobil.no) (Quit: http://www.mibbit.com ajax IRC Client)
[22:24:12] * strcat has a feeling he'll need to modify reflection
[22:24:15] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[22:24:26] <kmc> brson: the context here is that I think my @-boxes are getting cleaned up by a *different* task's cleanup::annihilate, which would be very bad
[22:24:27] <strcat> rusti: 0 as *int
[22:24:29] -rusti- 0
[22:24:50] <kmc> the issue is https://github.com/mozilla/servo/issues/762
[22:25:33] <brson> kmc: you may need a dereference here. thinking
[22:26:02] <strcat> ha
[22:26:08] <strcat> we are going to start printing pointers as hex
[22:26:12] <strcat> by removing this normalization
[22:26:19] <strcat> we were *never* hitting our visit_ptr method
[22:26:21] <brson> kmc: try `pthread_getspecific(*rust_get_rt_tls_key())`
[22:26:26] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:26:26] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c957971 to 142c0f9bd: 02http://git.io/N3iJvQ
[22:26:26] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:26:28] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[22:26:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/6mQLWQ
[22:26:28] <ghrust> 13rust/06auto 144c5f625 15Brian Anderson: Fix some vector function failure tests. Closes #8698
[22:26:28] <ghrust> 13rust/06auto 149a30a4a 15bors: auto merge of #8701 : brson/rust/issue-8698, r=thestinger
[22:26:28] <graydon> that's fine by me
[22:26:29] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[22:26:40] <strcat> graydon: I wouldn't be surprised if the 2% increase in code size was just previously dead code.
[22:26:43] <strcat> from missing stuff
[22:26:51] <graydon> wait, visit_ptr .. we were not hitting it, and now we will?
[22:26:55] <strcat> graydon: yeah
[22:26:55] <graydon> that sounds like a strict improvement
[22:27:02] <strcat> graydon: we are normalizing raw pointers to uint
[22:27:05] <strcat> and it hits visit_int
[22:27:11] <strcat> .writer.write_str(fmt!("(0x%x as *())",
[22:27:13] <graydon> right, bleh
[22:27:13] <strcat>                                        *p as uint));
[22:27:16] <strcat> that's the *actual* visit fn
[22:27:23] <strcat> rusti: 33 as *int
[22:27:24] -rusti- 33
[22:27:36] <strcat> but yeah the fmt tests are going to fail hard ;p
[22:27:41] <sully> ok, I think I understand the borrowchecker even less than I realized.
[22:27:50] <sully> it is complaining at me, telling me that None may contain borrowed pointers
[22:28:03] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[22:28:09] <strcat> graydon: will fix https://github.com/mozilla/rust/issues/4210 too
[22:28:11] <strcat> heh
[22:28:25] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[22:28:28] <graydon> so sad
[22:28:37] <sully> also, cannot capture variable of type `A`, which does not fulfill `'static`, in a bounded closure
[22:28:45] <sully> what does it mean by "bounded closure"?
[22:29:33] <brson> kmc: is the JS context is destroyed *after* the task it runs in is destroyed? can you point me to that code?
[22:29:49] <kmc> brson: ah yeah I see the deref in local_ptr.rs now
[22:30:21] *** Joins: jdm (jdm@97DF0582.DEAB171B.971E19F6.IP)
[22:30:35] <kmc> so I do get something from pthread_getspecific(* ((pthread_key_t*) rust_get_rt_tls_key()))
[22:31:07] <kmc> brson: it's destroyed as part of leaving a scope, so it should happen before annihilate runs
[22:31:14] <kmc> and definitely before annihilate gets around to actually freeing some boxes
[22:31:39] <kmc> and my experiments with printing *Task values from various places (incl. inside annihilate) confirm that annihilate didn't run yet on the thread where ScriptTask is dropped
[22:31:49] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[22:31:52] <kmc> so I conclude that it was another task's annihilate
[22:32:06] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[22:32:06] <kmc> which is bad -- maybe we are casting @T to *T and then sending it to another task
[22:32:08] <strcat> graydon: before and after:
[22:32:11] <strcat> 33
[22:32:13] <strcat> @5
[22:32:15] <strcat> (0x21 as *())
[22:32:17] <strcat> @mut 5
[22:32:21] <kmc> but now I'm breaking on annihilate to confirm
[22:32:24] <strcat> for this
[22:32:25] <strcat>     printfln!("%?", 33 as *int);
[22:32:27] <strcat>     printfln!("%?", @mut 5);
[22:32:31] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:32:31] <kmc> beacuse I am tired of adding debug prints to rustc and then waiting 30 min for it to build :)
[22:32:44] <strcat> graydon: anyway I was confounded before about why repr didn't work right
[22:32:46] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[22:32:49] <strcat> *finally*, the cause is known.
[22:32:51] <graydon> strcat: seems like .. a mild improvement!
[22:32:55] <sully> ok, got it all figured out
[22:33:09] <strcat> graydon: well it also reduces lint errors by 30%, and improves perf ;p
[22:33:33] <strcat> and who knows what other bugs were from this...
[22:35:33] <strcat> I think normalization should just be 100% removed because it will always have the wrong visit glue
[22:35:43] <strcat> type_use is smart enough to not do this kind of thing
[22:36:15] <brson> kmc: it would not surprise me if some of the astonishingly unsafe things servo is doing with @ are causing a refcount to drop in the wrong task
[22:36:23] <graydon> I'm not resisting this point; mostly just wonder what patrick thinks (or anyone else who has opinions about type_use and monomorphization). I think there's a lot of potential wins in there but this is similar to what I was going to propose we do anyways.
[22:36:39] <strcat> yeah just thinking out loud
[22:36:53] <strcat> was going to comment it out but it makes more sense to really remove it
[22:36:56] <graydon> (unload as much on type_use as possible, and mergefunc in preference to that too)
[22:37:18] <strcat> atm it does boxes (wrong), pointers (wrong), traits, closures, bare fns
[22:37:25] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:37:30] <strcat> and I'm not sure if those other 3 are right.
[22:37:40] <strcat> it definitely means you can't print trait objects sanely with %?
[22:37:44] <strcat> if you tried
[22:38:06] * strcat wonders if it breaks drop glue!
[22:38:29] <graydon> we do generally remove rather than comment or keep dead code around. run under valgrind to be sure nothing fishy pops out?
[22:38:50] <strcat> graydon: well the bots will - I don't expect anything to break
[22:38:53] <graydon> I'd also wait to hear pcwalton's thoughts.
[22:38:56] <strcat> just unbreak, and cause tests to fail
[22:38:59] <graydon> strcat: valgrind is turned off presently
[22:39:03] <strcat> graydon: oh
[22:39:21] <kmc> brson: yeah. though the box is being freed from annihilate, which implies it ended up on the wrong task's managed data list
[22:39:25] <graydon> strcat: we turned it off after the hair-on-fire-cycle-time meeting. I'm trying to get it turned back on without killing us in cycle time.
[22:39:25] <kmc> and not just a refcounting error
[22:39:46] <graydon> speaking of which, anyone want to r? https://github.com/mozilla/rust/pull/8722 
[22:39:49] <graydon> this is testsuite sharding
[22:39:50] <strcat> graydon: I wonder if that 32-bit mac issue is fixed by now
[22:40:07] <strcat> we improved codegen a *lot* since then
[22:40:16] <strcat> the nopt 32-bit one
[22:40:28] <graydon> wasn't it running out of memory?
[22:40:36] <strcat> some kind of out of range error
[22:40:45] <graydon> oh, right, link time
[22:40:47] *** Quits: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP) (Ping timeout)
[22:40:51] <graydon> the output binary was too bug
[22:40:53] <graydon> big
[22:41:00] <graydon> and the relocs couldn't encode offsets in it
[22:41:09] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[22:41:14] <pcwalton> I vote deleting type use and normalization and leaning on mergefunc as much as possible
[22:41:25] <graydon> pcwalton: \o/
[22:41:27] <pcwalton> afterward if it turns out we still have perf problems there we can look at how to sanely do it in the frontend
[22:41:33] <pcwalton> but since LLVM passes dominate compilation time
[22:41:38] <pcwalton> if we just throw mergefunc *first*
[22:41:46] <pcwalton> then that removes all the LLVM passes for everything that mergefunc merged
[22:42:16] <strcat> we'll still be optimizing them a bit due to function passes soon though
[22:42:27] <pcwalton> can we do mergefunc before function passes?
[22:42:34] <strcat> we could use another module pass
[22:42:37] <strcat> with only mergefunc
[22:42:43] <graydon> how far are we from experimenting with mergefunc? I assume we should keep type_use at least until we have a preliminary version of it working?
[22:42:54] <strcat> graydon: yeah we should keep type_use for the moment
[22:42:59] <strcat> but normalization is hardly doing anything :)
[22:43:02] <graydon> yeah
[22:43:06] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[22:43:48] <strcat> don't understand how gmail can be using 300MiB of memory
[22:44:12] <strcat> slowing down my run-pass tests ;[
[22:44:18] <sully> graydon: looking
[22:44:39] <graydon> strcat: it's got all of google plus running in a hidden div :)
[22:45:06] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[22:45:10] <strcat> their new rich text editor is almost enough to drive me to thunderbird or mutt
[22:45:17] <sully> graydon: I can't tell if that is a joke or not. :( :( :(
[22:46:00] <Earnestly> strcat: mutt has delicious cookies, you just have to build th oven first.
[22:46:14] <strcat> I have mutt around, I use it to send signed mails
[22:46:30] <strcat> but I need to be able to deal with people's html mail easily ;p
[22:46:46] <strcat> graydon: luckily fmt! isn't well-tested, so nothing broke :|
[22:46:55] * strcat will add one for that issue
[22:47:02] <Earnestly> elinks does quite a good job in that regard, but you know this already
[22:47:03] <graydon> aww. it's pretty well tested, no?
[22:47:03] <strcat> oh actually one did
[22:47:10] <strcat> graydon: was wrong
[22:47:12] <strcat> failures:
[22:47:14] <strcat>     repr::test_repr
[22:47:18] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[22:47:20] <graydon> yeah, I expect wrong-tests will break :)
[22:47:23] <Earnestly> (And you can tell elinks to use something other than .elinks for the XDG fanatics)
[22:47:45] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[22:47:49] <strcat> elinks doesn't let me view the images the spam bots send me
[22:48:00] <erickt> graydon / strcat: hey there! so my grand plan to just drop generators right in on libsyntax has proven to be completely impossible :) I cannot figure out any way to deal with unique ptrs and &mut refs
[22:48:10] <Earnestly> I don't think anything will inside mutt, w3m can outside of mutt though.
[22:48:25] <graydon> erickt: bummer.
[22:48:30] <sully> graydon: r+
[22:48:39] <strcat> w3m overlays images onto the terminal and it doesn't work if the window is composited due to an X11 bug :[
[22:48:47] <Earnestly> :<
[22:48:52] * strcat has run into all these weird things
[22:48:58] *** Quits: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Quit: Leaving.)
[22:49:01] <Earnestly> Similar to the xim issue?
[22:49:07] <strcat> dunno
[22:49:36] <erickt> graydon: yeah, I think I need type information to do things properly. I *may* be able to do it all in trans though
[22:49:44] <strcat> choose one: compositing, url hint layer, w3m images
[22:49:48] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[22:49:56] <strcat> yay X
[22:50:25] <strcat> ~"expected \'@10\', got \'@mut 10\'"
[22:50:27] <strcat> :)
[22:50:29] <strcat> already a test!
[22:50:34] <Earnestly> Reckon wayland shells have the ability to solve this dilemma?
[22:50:34] <strcat> it looks for the wrong result, but hey
[22:50:36] <strcat> it tried
[22:50:52] <strcat>     exact_test(&(@mut 10), "@10"); // FIXME: #4210: incorrect
[22:50:58] * Earnestly hasn't tried w3m in wlterm
[22:51:07] <strcat> a test that breaks when you fix it :s
[22:51:45] <erickt> graydon: ignoring the unreachable code lint, I *think* the type/lifetime semantics of functions are the same as generators. So I think I could treat generators as functions up until trans when I build the state machine
[22:51:54] <strcat> and now to set std.rs mtime to 1980 so make doesn't rebuild everything...
[22:52:34] <strcat> meh it did anyways.
[22:52:53] <pcwalton> servo passes acid1 https://twitter.com/metajack/status/371041675633647616/photo/1
[22:52:58] <strcat> nice!
[22:53:02] <graydon> erickt: I'd poll the other devs / mailing list for feelings on timeline/impact/scope. I haven't a strong feeling on whether this is a must-have or a blue-sky thing, but I'd hate to see you do a ton of work on it and then get negative review.
[22:53:16] <erickt> graydon: of course then there's this issue of how do I declare an abstract Generator structure that doesn't get filled in until trans
[22:53:20] <graydon> jack pcwalton everyone-else-on-servo: \o/ \o/ \o/
[22:53:28] <erickt> wooo +1 servo!
[22:53:29] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Connection reset by peer)
[22:53:31] *** Joins: maxli1 (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:54:02] <kmc> pthread_getspecific is returning values like 0xffffffffe8e571e0 which is not a valid userspace address on Linux/x86_64
[22:54:18] <strcat> I think it's undefined if the key wasn't added
[22:54:33] <Earnestly> strcat: wlterm simply doesn't display them.  Nevermind
[22:54:44] <kmc> strcat: ok... so maybe bad key
[22:54:58] <pcwalton> brson: ok, it was an improvement
[22:54:58] <erickt> graydon: of course :) This has just been a fun experiment to think about. It's obviously now going to take a bit more thought to do
[22:55:02] *** Joins: verrri (Mibbit@moz-C3703462.dhcp.inet.fi)
[22:55:06] <strcat> good old POSIX error handling
[22:55:11] * strcat 's favourite is close()
[22:55:17] <pcwalton> now 48.1% of compile time is vec::raw::copy_memory, copying out the metadata section
[22:55:23] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:55:26] *** Quits: maxli1 (maxli@B5559308.9C54E60.2FA4EA88.IP) (Connection reset by peer)
[22:55:35] <graydon> erickt: yeah. it's sweet when it turns out to be something you can just knock out a small syntax extension for :)
[22:55:36] <strcat> pcwalton: does it copy it into another vector?
[22:55:42] <pcwalton> strcat: I guess
[22:55:50] <strcat> pcwalton: should make it use ptr::copy_nonoverlapping_memory instead
[22:55:57] <strcat> I think that one is for doing an internal memmove
[22:56:03] <pcwalton> it falls into __memcpy
[22:56:11] <strcat> pcwalton: ah, it probably branches
[22:56:17] <strcat> on overlap
[22:56:21] <strcat> so nvm
[22:56:25] <graydon> pcwalton: I am not clear if the pointer LLVM gives us to a section is long-lived / stable / just-an-mmap. if so we should just stash it in an @ owned by a reader.
[22:56:43] <kmc> when I break on pthread_getspecific() the calls made by the RT itself have key = 0, but return reasonable values
[22:56:47] <graydon> xcodebuild -license is hilarious
[22:56:53] <strcat> pcwalton: would only matter if it was small enough to inline
[22:57:02] <graydon> welcome to the future where you ssh into multiple machines and type "accept" to 20 pages of boilerplate
[22:57:12] <acrichto> at least yo udon't have to type in an apple id
[22:57:13] <erickt> graydon: one neat thing to come out of this though is we could use the same technique of having a custom Generator struct/next method to create closures that could be moved around
[22:57:16] <acrichto> (I hope)
[22:57:18] <graydon> acrichto: small blessings
[22:58:27] <brson> pcwalton: do you want to work on the optimization to avoid the copy, or should i?
[22:58:40] <brson> pcwalton: I kind of think we shouldn't even leave compression as an option now
[22:58:44] <pcwalton> I'm working on fixing a testcase so yeah, feel free to take it.
[22:58:47] <brson> snapshots already get compressed
[22:59:51] *** Quits: verrri (Mibbit@moz-C3703462.dhcp.inet.fi) (Quit: http://www.mibbit.com ajax IRC Client)
[23:00:14] *** Quits: KindOne (KindOne@moz-5126C9B1.dynamic.ip.windstream.net) (Ping timeout)
[23:00:39] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:00:44] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:00:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:00:56] <graydon> IIRC almost all of the compression size wins come from collapsing 0-bytes. I think it has to do with offset-patching in ebml / general non-use of vints.
[23:01:00] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:01:12] <graydon> but if it's not a speed win, I'd just toss it. did you check windows? I think that was the place it really won.
[23:01:34] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[23:02:10] <graydon> brson: is mac6 just not-in-the-cluster, or is it turned off / not set up at all?
[23:02:41] <brson> graydon: i tried checking on the windows bots yesterday, but the results had a lot of variation. can't build on my own windows machine anymore because jemalloc doesn't build for some reason. i'll try harder over the weekend
[23:02:45] <brson> graydon: checking on mac6
[23:03:21] <graydon> k, no worries.
[23:03:30] <graydon> I'll dig into llvm to see if the pointer is stable
[23:03:57] <brson> mac6 is mysteriously powered off
[23:04:12] <graydon> I don't think we have enough builds for it at the moment anyways
[23:04:15] <graydon> lots of builders disabled
[23:04:26] <graydon> but if we (say) shard mac valgrind heavily enough, it'll be worthwhile
[23:04:37] *** Joins: KindOne (KindOne@C8AB5D45.E184454F.34F73994.IP)
[23:04:55] <graydon> it's not clear to me what the right balance between scheduler threads and sharding is. we'll have to experiment some.
[23:05:01] <bblum> anybody have any easy bugs for me to do with my last hour here
[23:05:06] <bblum> my workqueue is empty
[23:05:08] <graydon> last hour!!
[23:05:10] <ecr> brson: just made a PR to make IO temporarily unkillable.
[23:05:11] <graydon> oh gosh
[23:05:50] <graydon> bblum: I'd aim for "document anything you think you didn't document yet". doc comments usually land :)
[23:05:56] <bblum> graydon: yeah good plan
[23:06:06] <bblum> oh yeah i can definitely think of some of those things
[23:06:08] <ecr> brson: oops, forgot to check make tidy first.
[23:07:07] <bblum> do we have a traits tutorial somewhere?
[23:08:06] <ecr> brson: and it's ready.
[23:08:35] <strcat> bblum: in bblum's mind, about to be serialized to a text file? ;p
[23:08:42] <bblum> strcat: danger.
[23:08:44] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[23:08:56] <andrew-d> pcwalton: w.r.t. compression, something just occurred to me - has it been considered to only compress when it saves some amount?  whether it's %age or more than x KB?  would stop compression affecting hello world and small things, but still might retain benefits for larger projects.  just a thought :)
[23:09:10] <strcat> bblum: I think we only mention them in the tutorial
[23:09:15] <strcat> and it's probably a bit wrong
[23:09:18] <brson> mac6 is back
[23:09:22] <graydon> :)
[23:09:36] *** Joins: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net)
[23:09:59] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[23:10:02] <strcat> graydon: the funny part is that I didn't fix the lint error I set out to fix, I fixed a different one (the one actually causing the regression)
[23:10:04] <strcat> *shrug*
[23:10:09] <graydon> hah
[23:11:04] * strcat diffs the lint output
[23:11:22] <carleastlund> Coding question: if I have a [~str] and I want a [&str], how can I get that? The .iter() for a str needs to borrow the string pointer so it sticks around during iteration, but it's not immediately obvious to me how to convert ~ to & inside a vector.
[23:11:30] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:11:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149a30a4a to 142c0f9bd: 02http://git.io/N3iJvQ
[23:11:30] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:11:31] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:11:31] <ghrust> 01[13rust01] 15bors pushed 12 new commits to 06auto: 02http://git.io/r65H_g
[23:11:31] <ghrust> 13rust/06auto 1474b2d9e 15Brian Anderson: rt: Remove last use of C++ exchange alloc
[23:11:31] <ghrust> 13rust/06auto 14b3fa43f 15Brian Anderson: rt: Remove rust_exchange_alloc
[23:11:31] <ghrust> 13rust/06auto 14a9d28b2 15Brian Anderson: rt: Remove indexed_list
[23:11:32] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:11:47] <strcat> huh
[23:11:56] <strcat> graydon: actually, they're the same lints.
[23:12:02] <strcat> slightly different
[23:13:00] *** Quits: fiirhok (fiirhok@EEC1213C.4468D718.41AEFB3C.IP) (Client exited)
[23:13:14] <SimonSapin> carleastlund: .as_slice()
[23:13:32] <SimonSapin> with a map and collect, probably
[23:14:33] <carleastlund> Aha, thanks SimonSapin.  Is that was as_slice is for, in general?  Its purpose isn't clear in the documentation, it looks like a long name for an identity function as written.
[23:15:01] <engla> .as_slice() is to get &str from any of &str, ~str, @str etc
[23:15:15] <engla> or in your case, from &~str
[23:15:57] <Eridius> rusti: let xs = [~"one", ~"two", ~"three"]; let ys = xs.iter().map(|x| x.as_slice()).to_owned_vec(); printfln!(ys)
[23:16:00] <strcat> graydon: I think type_use must be causing the rest.
[23:16:01] -rusti- ~["one", "two", "three"]
[23:16:01] -rusti- ()
[23:16:06] <strcat> very similar
[23:16:46] <graydon> invalid casts of similar functions?
[23:16:49] <strcat> yeah
[23:16:53] <graydon> :((
[23:16:59] <strcat> like, I fixed 30% of them, but these all look similar too
[23:17:15] <strcat> fixed:
[23:17:16] <strcat> Undefined behavior: Call argument type mismatches callee parameter type
[23:17:18] <strcat>   call void bitcast (void (%"struct.std::unstable::raw::Closure[#1]"*, { i64, %tydesc*, i8*, i8*, i8 }*, %"enum.std::local_data::KeyValue<@?>[#1]"**)* @"_ZN4cast19transmute_copy_490215_64d18697bdbc627_0$x2e0E" to void
[23:17:20] <strcat> (%"struct.std::unstable::raw::Slice<std::option::Option<(*std::libc::types::common::c95::c_void,~std::task::local_data_priv::LocalData<no-bounds>,std::task::local_data_priv::LoanState)>>[#1]"*, { i64, %tydesc*, i8*, i8*, i8 }*, { %"enum.std::option::Option<(*std::libc::types::common::c95::c_void,~std::task::local_data_priv::LocalData<no-bounds>,std::task::local_data_priv::LoanState)>[#1]"*, i64
[23:17:23] <strcat> }*)*)(%"struct.std::unstable::raw::Slice<std::option::Option<(*std::libc::types::common::c95::c_void,~std::task::local_data_priv::LocalData<no-bounds>,std::task::local_data_priv::LoanState)>>[#1]"* %0, { i64, %tydesc*, i8*, i8*, i8 }* undef, {
[23:17:25] <strcat> %"enum.std::option::Option<(*std::libc::types::common::c95::c_void,~std::task::local_data_priv::LocalData<no-bounds>,std::task::local_data_priv::LoanState)>[#1]"*, i64 }* %3)
[23:17:27] <strcat> er
[23:17:29] <strcat> longer than it looked
[23:17:31] <strcat> ;p
[23:17:48] <strcat> there are plenty more similar ones
[23:19:48] <strcat> anyway will look into mergefunc when acrichto's PR lands
[23:20:51] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[23:21:16] *** Joins: sigma1 (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:21:22] *** Quits: sigma (sigma@moz-AD03D4C8.range86-136.btcentralplus.com) (Ping timeout)
[23:21:31] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[23:21:31] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 142494502 to 142c0f9bd: 02http://git.io/N3iJvQ
[23:21:31] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[23:21:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:21:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1YjWmA
[23:21:33] <ghrust> 13rust/06auto 14ba0d95a 15Alex Crichton: Rewrite pass management with LLVM...
[23:21:33] <ghrust> 13rust/06auto 14ff6a3c6 15bors: auto merge of #8700 : alexcrichton/rust/better-llvm, r=thestinger...
[23:21:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:22:14] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[23:22:45] * strcat missed the minor typo on the first look over it
[23:22:57] <brson> pcwalton: do you have a branch with your optimizations? I want to see the profile the way you are
[23:23:05] <brson> memmove is only about 3% here
[23:23:19] <acrichto> graydon: thanks for doing the xcode license stuff :)
[23:23:34] <graydon> acrichto: np, thanks for figuring it out!
[23:23:35] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: moving)
[23:23:40] <graydon> acrichto: really want that change :)
[23:23:48] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[23:23:50] <brson> did we have to upgrade xcode?
[23:23:55] <graydon> no, just register it
[23:24:01] <graydon> or, actually, accept the license terms
[23:24:07] <graydon> (that's the theory)
[23:24:17] <brson> we had done that
[23:24:25] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[23:24:27] <brson> brew doctor tells you very sternly to do so
[23:24:31] <graydon> oh. huh. on xcodebuild?
[23:24:56] <brson> not sure
[23:25:17] <graydon> well, we'll see if it bounces this time
[23:25:26] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[23:25:28] * acrichto crosses fingers
[23:25:28] <brson> what was the symptom?
[23:25:44] <acrichto> brson: http://buildbot.rust-lang.org/builders/auto-mac-64-nopt-t/builds/160/steps/compile/logs/stdio
[23:25:50] <strcat> it failed the whole queue ;p
[23:26:01] <acrichto> oh yeah that was also a problem...
[23:26:06] <graydon> oh?
[23:26:08] <graydon> why?
[23:26:09] <brson> huh, ok
[23:26:23] <brson> graydon: did you get mac5/6 too?
[23:26:30] <graydon> yes, all of them
[23:26:35] <graydon> I'll sudo it as well to be sure :)
[23:26:36] <acrichto> it turned out that this gyp stuff has `.rc` files in them, and `make tidy` attempted to enforce our style on them and barfed a lot
[23:26:42] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[23:26:47] <strcat> did you just remove rc from tidy?
[23:26:53] <strcat> since we don't use it
[23:26:54] <acrichto> no, removed llvm/libuv
[23:26:58] <acrichto> but that's also a good point
[23:27:16] <strcat> well that will at least make tidy faster anyway
[23:27:30] <strcat> it annoys me because it runs every time
[23:28:14] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[23:28:14] *** ChanServ sets mode: +o tjc
[23:28:28] <strcat> graydon: I think all the workspaces need to be cleared after the LLVM revert PR touched them
[23:28:37] <strcat> /home/rustbuild/src/rust-buildbot/slave/auto-linux-64-nopt-c/build/src/rustllvm/PassWrapper.cpp: In member function â€˜virtual void LLVMRustPrintPasses()::MyListener::passEnumerate(const llvm::PassInfo*)â€™:
[23:28:39] <strcat> /home/rustbuild/src/rust-buildbot/slave/auto-linux-64-nopt-c/build/src/rustllvm/PassWrapper.cpp:210:43: error: â€˜printfâ€™ was not declared in this scope
[23:28:39] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:28:44] <strcat> at least the ones it used
[23:28:46] <strcat> hm
[23:29:34] <graydon> touch the llvm stamp file
[23:29:41] <graydon> it'll clean-llvm
[23:29:45] <strcat> yeah but then users will have to rebuild
[23:29:55] <strcat> I guess that will work though
[23:29:58] <graydon> yeah
[23:30:11] <strcat> acrichto: can you touch the llvm stamp in your pull? also there's a typo I noticed + commented on
[23:30:19] <acrichto> oh yeah sure
[23:30:36] <acrichto> I'm terrible with typos
[23:30:44] <strcat> I managed to read it and miss it
[23:30:49] <strcat> saw it after looking there again
[23:30:50] <graydon> otherwise I have to ssh and rdp into 20 machines and clean a half dozen workspaces on each
[23:31:07] <graydon> and if I miss one, it'll bounce. it's a bit of a pain. that's why we automated it :)
[23:31:23] * strcat will just do the usual touch -d 1980-01-01 foo
[23:31:25] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[23:31:30] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[23:31:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ff6a3c6 to 142c0f9bd: 02http://git.io/N3iJvQ
[23:31:30] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[23:31:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:31:30] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/_dv7yg
[23:31:30] <ghrust> 13rust/06auto 148ffed39 15Alex Crichton: Upgrade libuv to the current master + our patches...
[23:31:30] <ghrust> 13rust/06auto 141fa01dd 15Alex Crichton: Implement process bindings to libuv...
[23:31:31] <ghrust> 13rust/06auto 14b3cd6fe 15bors: auto merge of #8645 : alexcrichton/rust/issue-6436-run-non-blocking, r=brson...
[23:31:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:32:07] *** Quits: sigma1 (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[23:32:27] <acrichto> strcat graydon: updated the llvm passes with a time stamp and a typo fix
[23:32:40] <acrichto> although llvm may fail again with this libuv process bindings again
[23:32:44] * strcat added p=10
[23:33:00] *** Joins: sigma (sigma@moz-58C25D64.range86-128.btcentralplus.com)
[23:33:55] <strcat> rusti: 33 as *mut int
[23:33:57] -rusti- 33
[23:35:18] <acrichto> rusti: ifmt!("{}", 33 as *mut int)
[23:35:19] -rusti- ~"0x21"
[23:35:22] <acrichto> yay
[23:35:47] <acrichto> rusti: ifmt!("{:08}", 33 as *mut int)
[23:35:48] -rusti- ~"0x000021"
[23:35:59] <acrichto> rusti: ifmt!("{:#08}", 33 as *mut int)
[23:36:00] -rusti- ~"0x000021"
[23:36:06] <strcat> rusti: ]
[23:36:06] -rusti- <anon>:5:9: 5:10 error: incorrect close delimiter: `]`
[23:36:06] -rusti- <anon>:5          ]
[23:36:06] -rusti-                   ^
[23:36:07] -rusti- application terminated with error code 101
[23:36:14] <strcat> rusti: []
[23:36:19] -rusti- pastebinned 6 lines of output: http://ix.io/7wI
[23:36:38] <dbaupp> rusti: (0 as *mut int, )
[23:36:39] -rusti- ((0x0 as *()),)
[23:37:00] <strcat> evil normalize ;p
[23:37:09] *** Quits: igl1 (igl@moz-3792139.adsl.alicedsl.de) (Ping timeout)
[23:37:22] <dbaupp> it's the best; who wants a fast program anyway? :P
[23:37:36] <acrichto> graydon: success, libuv was configured and built, it was just built incorrectly and that's my fault anyway :)
[23:37:46] *** Joins: igl (igl@moz-628ABD1E.adsl.alicedsl.de)
[23:37:59] <graydon> acrichto: excellent!
[23:38:29] *** Joins: jclements (jclements@moz-DA3E01C8.wireless.calpoly.edu)
[23:38:46] <dbaupp> strcat: does pcwalton's comment on https://github.com/mozilla/rust/pull/8678#issuecomment-23190910 correspond to that change?
[23:38:46] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:38:49] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[23:39:11] <dbaupp> strcat: (I don't quite understand how the drop flag is relevant to nullable pointers.)
[23:39:17] <strcat> dbaupp: no I think he was talking about #[unsafe_no_drop_flag] 
[23:39:34] <dbaupp> strcat: right, that's what I thought
[23:39:52] <strcat> as soon as I figure out where to add the 1 word check I will
[23:39:54] * sully posted a thing to the dynamic type thread
[23:39:57] <strcat> it has to be post-monomorphization
[23:40:11] <sully> turns out youc an do something pretty similar to a dynamic type in completely safe rust cod
[23:40:14] <sully> code
[23:40:40] <dbaupp> ChrisMorgan: it looks like your augmented assignment ML post wasn't very helpful in actually getting help to fix it :(
[23:41:18] <strcat> anything vaguely syntax related is destined for that
[23:41:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:41:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b3cd6fe to 142c0f9bd: 02http://git.io/N3iJvQ
[23:41:30] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:41:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:41:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_ppDhg
[23:41:31] <ghrust> 13rust/06auto 149558984 15Alex Crichton: Rewrite pass management with LLVM...
[23:41:31] <ghrust> 13rust/06auto 14c8a41d5 15bors: auto merge of #8700 : alexcrichton/rust/better-llvm, r=thestinger...
[23:41:31] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:41:53] <dbaupp> strcat: bikeshedding \o/
[23:42:21] *** Quits: Sergio965 (sergiobz@moz-8D9DFEEF.hsd1.ma.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:44:45] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[23:45:05] <kmc> if a debug! statement gets cross-crate-inlined, will I activate it under the original crate's name or the call site's?
[23:45:08] <kmc> seems to be the latter
[23:45:28] <strcat> kmc: yeah, it's a defect
[23:45:32] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[23:45:49] <ChrisMorgan> Yeah. Such is life.
[23:46:05] <graydon> sully: that is cute, the dynamic thing.
[23:46:22] <kmc> ok
[23:46:40] <brson> oof. extra::ebml is really oriented toward copying the metadata section
[23:46:40] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[23:46:45] <graydon> sully: I had to read it several times to figure out what it was doing.
[23:47:00] <brson> pcwalton: do you have a branch with your opts?
[23:47:08] <sully> graydon: yeah. I suspect that if we actually wanted to add that interface to a library, it would be better to do something more straightforward and unsafe, but I really like that trick
[23:47:14] <pcwalton> brson: I do, but not pushed, let me push
[23:47:16] <sully> graydon: yeah, it is subtle. it took me a while the first time I saw it
[23:47:32] <ChrisMorgan> Still, I don't think there's anything I can add to the augmented assignment thread. It's all been said.
[23:47:56] *** Quits: jclements (jclements@moz-DA3E01C8.wireless.calpoly.edu) (Quit: jclements)
[23:48:15] <graydon> sully: the term "tag" threw me. it's more of a ... typed 1-entry buffer.
[23:48:18] <dbaupp> ChrisMorgan: everything, except for the actual things that fix the code. :(
[23:48:38] <ChrisMorgan> At the least, I got some visibility for it :-)
[23:48:49] *** Joins: jclements (jclements@moz-DA3E01C8.wireless.calpoly.edu)
[23:48:51] <sully> graydon: well, from an *interface* perspective, it is a tag
[23:49:00] <sully> graydon: but in the implementation, it's a typed one entry buffer
[23:49:37] <graydon> I guess
[23:49:54] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:50:40] *** Quits: jclements (jclements@moz-DA3E01C8.wireless.calpoly.edu) (Quit: jclements)
[23:50:41] <graydon> the universal values all keep the "tag" alive, but I guess that's not too surprising to users of gc-heavy languages :)
[23:51:16] <graydon> it's very much a trick that relies on you ignoring a tangle of gc in the background. but clever. and not _too_ expensive?
[23:51:16] <sully> yeah
[23:51:28] <graydon> I wonder. it doesn't look that bad.
[23:51:32] <sully> yeah, I don't have too much of an intuition about the performance
[23:52:14] <strcat> acrichto: hm, why did it fail again?
[23:52:17] <dbaupp> strcat: https://github.com/mozilla/rust/pull/8724 s/2% decrease/2% increase/?
[23:52:21] <sully> I'm hacking out a more brute force solution right now where you do tag checks and unsafe casts
[23:52:32] <strcat> dbaupp: no
[23:52:48] <strcat> dbaupp: normalize helps a tiny bit - reduces code size by 2%
[23:52:53] <sully> that is maybe more performant but is like 5% as clever and elegant
[23:52:53] <acrichto> strcat: huh, I think osx includes stdio.h by default in some headers that linux doesn't include
[23:52:55] <strcat> but that could just be from all the things it's breaking
[23:53:07] <dbaupp> strcat: oh, I was reasding it backwards
[23:53:40] <sully> haha, welp, I only replied to you, graydon
[23:53:45] <strcat> also with optimization, the normalized code is bigger
[23:53:56] <strcat> because it breaks optimizations :s
[23:54:10] *** Quits: KindOne (KindOne@C8AB5D45.E184454F.34F73994.IP) (Ping timeout)
[23:54:24] <strcat> I believe type_use is at fault for most of the remaining lint errors
[23:54:36] <strcat> will try replacing it with mergefunc
[23:54:39] <graydon> :)
[23:55:01] <strcat> there are still some lint errors from glue
[23:55:02] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[23:55:32] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[23:55:34] *** Joins: brendan (brendaneic@moz-DA50D20B.public.wayport.net)
[23:55:43] <graydon> r+ thanks
[23:55:46] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[23:55:48] *** Joins: ofeldt (ofeldt@moz-1ED42411.dip0.t-ipconnect.de)
[23:56:15] <bblum> graydon: https://github.com/mozilla/rust/pull/8725
[23:56:25] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[23:56:32] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:56:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c8a41d5 to 142c0f9bd: 02http://git.io/N3iJvQ
[23:56:32] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:56:33] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:56:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MbhOMQ
[23:56:33] <ghrust> 13rust/06auto 1428ee696 15Alex Crichton: Rewrite pass management with LLVM...
[23:56:33] <ghrust> 13rust/06auto 1428fe2b5 15bors: auto merge of #8700 : alexcrichton/rust/better-llvm, r=thestinger...
[23:56:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:56:49] *** Quits: ofeldt- (ofeldt@moz-3FD1E9EA.dip0.t-ipconnect.de) (Ping timeout)
[23:56:55] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[23:57:13] *** Quits: sigma (sigma@moz-58C25D64.range86-128.btcentralplus.com) (Ping timeout)
[23:57:36] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:58:00] <dbaupp> is there a plan/use for a 'task lifetime?
[23:58:32] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[23:58:49] *** Joins: KindOne (KindOne@moz-754ADD03.dynamic.ip.windstream.net)
[23:59:17] <bblum> dbaupp: interesting suggestion; i have wanted such a thing for myself
[23:59:29] <bblum> dbaupp: doesn't seem too complicated; file an rfc mybe
[23:59:30] <bblum> maybe
[23:59:43] * dbaupp does so
[23:59:50] * strcat wants fork-join parallelism
[23:59:57] <dbaupp> strcat++
