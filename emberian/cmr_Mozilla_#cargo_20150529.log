[00:00:23] <Ericson2314> A simple thing that would be nice is "unstable packages" where any flag can be thrown at cargo, but the packages couldn't post put on crates.io.
[00:00:54] *** Quits: panicbit (panicbit@moz-trnuar.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[00:01:33] <Ericson2314> Since some compiler flags are still in flux AFIAK, this would help with experimentation
[00:05:40] *** Quits: swgillespie (swgillespie@moz-1i5.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:16:46] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
[00:31:12] *** Quits: ytain (ytain@moz-ffpck2.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[00:31:43] *** Joins: p1start (p1start@moz-nftjhe.org)
[00:45:15] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:46:31] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[00:47:33] *** Joins: p1start (p1start@moz-nftjhe.org)
[00:48:49] *** Quits: Ericson2314 (user@moz-5muv45.m9e4.oi28.0306.2602.IP) (Ping timeout: 121 seconds)
[00:49:29] *** Joins: Ericson2314 (user@moz-5muv45.m9e4.oi28.0306.2602.IP)
[00:52:19] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[00:53:04] <iu> Hi! When `cargo test` fails, and the compiler suggests using `--explain EXXX`, how to actually pass that option?
[00:53:20] <Dabo> rustc --explain EXXX
[00:53:38] <Dabo> the --explain flag just prints an explanation, it doesn't have anything related to the project
[00:53:46] <Dabo> so literally just use `rustc --explain`
[00:55:01] <iu> Dabo: Hah, I see. Thanks!
[00:55:17] <Dabo> no problem!
[01:01:35] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[01:02:08] *** kimundi is now known as zz_kimundi
[01:06:41] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:06:56] *** Quits: santiago (santiago@moz-8th.j2e.167.12.IP) (Quit: Computer has gone to sleep.)
[01:07:14] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[01:08:34] <huon> iu: you can also go to http://doc.rust-lang.org/error-index.html#EXXXX
[01:08:44] <huon> (e.g. http://doc.rust-lang.org/error-index.html#E0265 )
[01:08:54] <iu> huon: Thank you!
[01:09:00] <mcpherrin> How do I depend on librustc in a Cargo.toml?
[01:09:12] <huon> mcpherrin: you don't need to
[01:09:16] <mcpherrin> huon: oh
[01:09:20] <mcpherrin> well then!
[01:09:22] <huon> (well, can't, afaik)
[01:09:32] <huon> I guess someone could publish it on crates.io if they wanted...
[01:10:20] <mcpherrin> yeah I guess I don't need to depend on libstd or other default crates either
[01:10:28] <mcpherrin> (default doesn't seem like the right word)
[01:14:52] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[01:17:13] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[01:22:53] *** Joins: fkaa (tundmatu@moz-501od2.business.telia.com)
[01:23:17] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[01:38:25] *** Quits: ogham (rally@moz-95g.2nj.199.138.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:40:35] *** Quits: iu (iu@moz-6263qv.cc.cmu.edu) (Quit: )
[01:47:06] *** Joins: zyphrus (David@moz-1a4.urk.98.101.IP)
[01:56:22] *** Joins: santiago (santiago@moz-ro2mm9.res.rr.com)
[01:59:17] * o11c mutters that libstd should have been in Cargo from day one
[01:59:56] <steveklabnik> libstd is older than cargo so 
[01:59:57] <steveklabnik> :p
[01:59:57] <huon> unfortunately doesn't solve the unstable features problem
[02:00:35] *** rovar is now known as Guest60769
[02:08:12] *** Joins: c74d3 (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP)
[02:08:34] *** Quits: dpc (dpc@moz-t6gr4b.ca.comcast.net) (Connection closed)
[02:09:26] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[02:09:45] *** c74d3 is now known as c74d
[02:10:52] *** Joins: dpc (dpc@moz-t6gr4b.ca.comcast.net)
[02:14:49] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[02:17:09] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[02:17:23] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[02:20:03] *** Tuba is now known as Tobba
[02:32:54] *** Quits: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP) (Quit: Leaving...)
[02:52:46] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:53:33] *** Quits: zz_kimundi (kimundi@moz-ch362e.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:56:06] *** Joins: zz_kimundi (kimundi@moz-68riih.dip0.t-ipconnect.de)
[02:56:08] *** zz_kimundi is now known as kimundi
[03:04:21] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[03:06:43] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Connection closed)
[03:07:02] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[03:16:23] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[03:17:58] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:18:29] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[03:32:22] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:53:40] *** Quits: dpc (dpc@moz-t6gr4b.ca.comcast.net) (Ping timeout: 121 seconds)
[03:53:49] *** Quits: dpc_ (dpc@moz-t6gr4b.ca.comcast.net) (Ping timeout: 121 seconds)
[04:13:27] *** Joins: Quxxy (chatzilla@moz-efh10q.internode.on.net)
[04:23:04] *** Joins: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl)
[04:24:38] <jethrogb> I have a package A that depends on A-sys for both build and runtime
[04:25:01] <jethrogb> several of A's features are re-exported to A-sys
[04:25:30] <jethrogb> when I try to build package A like so: cargo build --features "some_feature
[04:25:36] <jethrogb> "
[04:25:56] <jethrogb> A-sys gets built as a build dependency without any features
[04:26:07] <jethrogb> and then the build of A fails because of missing features in A-sys
[04:26:18] <jethrogb> is this a bug or did I misconfigure something?
[04:28:42] *** Joins: p1start (p1start@moz-nftjhe.org)
[04:38:02] *** Quits: Shackra (Jorge@moz-7bh.ng6.177.186.IP) (Connection closed)
[04:45:22] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[04:53:18] <acrichto> jethrogb: hm interesting, that sounds like a bug, could you open an issue? (a reproduction would also be quite useful!)
[04:55:34] <jethrogb> ok, let me try to make something that's less than 10000 LoC and has no external dependencies :)
[05:05:15] <sfackler> acrichto: it's this rust-openssl pr: https://travis-ci.org/sfackler/rust-openssl/jobs/64508660 https://github.com/sfackler/rust-openssl/pull/221
[05:05:35] <sfackler> it is making openssl-sys both a runtime and build dependency
[05:05:48] <sfackler> which seems like the kind of thing to result in a weird bug
[05:07:19] <acrichto> sfackler: jethrogb: hm ok, thanks for the logs, it may be that the features are only being activated in one of the deps, not both
[05:08:09] <acrichto> sfackler: jethrogb: also in terms of cross compiles that strategy may not work out so well
[05:08:18] <acrichto> detecting features in the *host* openssl and assuming the target is the same
[05:08:44] <acrichto> totally unrelated to the cargo bug of course :P
[05:12:17] <acrichto> jethrogb: aha, I have reduced it
[05:13:48] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[05:13:51] <jethrogb> https://github.com/jethrogb/cargo-builddepbug
[05:14:09] <jethrogb> acrichto: ok, should I continue typing this bug report?
[05:14:21] <acrichto> haha, that looks very similar :)
[05:14:24] <acrichto> yes please!
[05:14:46] *** Quits: c74d (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[05:15:22] *** c74d3 is now known as c74d
[05:16:09] *** Quits: O01eg (o01eg@moz-qi2pml.uea1.4n8f.2698.2a02.IP) (Client exited)
[05:18:24] <jethrogb> https://github.com/rust-lang/cargo/issues/1662
[05:19:01] <acrichto> jethrogb: thanks!
[05:50:42] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:52:39] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[05:59:39] *** Joins: daschl (Adium@moz-oirn1i.vie.surfer.at)
[06:04:13] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[06:20:30] *** Quits: fkaa (tundmatu@moz-501od2.business.telia.com) (RecvQ exceeded)
[06:20:52] *** Joins: fkaa (tundmatu@moz-501od2.business.telia.com)
[06:21:06] *** Quits: daschl (Adium@moz-oirn1i.vie.surfer.at) (Quit: Leaving.)
[06:27:45] *** Joins: daschl (Adium@moz-oirn1i.vie.surfer.at)
[06:38:50] *** Quits: daschl (Adium@moz-oirn1i.vie.surfer.at) (Quit: Leaving.)
[06:42:14] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[06:49:48] *** Joins: daschl (Adium@moz-oirn1i.vie.surfer.at)
[06:50:46] *** Joins: panicbit (panicbit@moz-nvujtm.itmc.tu-dortmund.de)
[06:51:04] *** Quits: daschl (Adium@moz-oirn1i.vie.surfer.at) (Quit: Leaving.)
[07:15:18] *** Quits: panicbit (panicbit@moz-nvujtm.itmc.tu-dortmund.de) (Ping timeout: 121 seconds)
[07:25:00] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[07:44:05] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:54:27] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[08:36:11] *** kimundi is now known as zz_kimundi
[08:40:23] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[08:41:28] *** Joins: p1start (p1start@moz-nftjhe.org)
[08:43:44] *** Joins: pobivan (Mibbit@moz-gus.t6c.30.46.IP)
[08:45:54] *** Joins: jedireza (jedireza@moz-ungcc1.dsl.ovh.fr)
[08:46:08] *** Joins: panicbit (panicbit@moz-trnuar.dip0.t-ipconnect.de)
[08:59:01] *** Joins: filsmick (filsmick@moz-0svev4.abo.wanadoo.fr)
[09:08:56] *** Quits: pobivan (Mibbit@moz-gus.t6c.30.46.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:12:31] *** zz_kimundi is now known as kimundi
[09:40:26] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Connection closed)
[09:40:38] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[09:41:19] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:44:02] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[09:46:58] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:48:34] *** kimundi is now known as zz_kimundi
[09:56:57] *** zz_kimundi is now known as kimundi
[09:58:04] *** Quits: jedireza (jedireza@moz-ungcc1.dsl.ovh.fr) (Quit: My Mac has gone to sleep. ZZZzzz…)
[10:07:37] *** Quits: filsmick (filsmick@moz-0svev4.abo.wanadoo.fr) (Quit: )
[10:07:42] *** Joins: filsmick (filsmick@moz-0svev4.abo.wanadoo.fr)
[10:07:48] *** Joins: ogham (rally@moz-f25.edm.199.138.IP)
[10:25:00] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:52:44] *** kimundi is now known as zz_kimundi
[10:58:45] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[11:26:45] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[11:28:27] *** Quits: bjz (bjz@moz-4cc8qn.bigpond.net.au) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:29:39] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
[11:35:30] *** Joins: bjz (bjz@moz-4cc8qn.bigpond.net.au)
[12:05:10] *** Quits: zyphrus (David@moz-1a4.urk.98.101.IP) (Quit: Bye bye)
[12:16:43] *** Joins: duncan (paul@moz-dst.ms6.225.173.IP)
[12:19:05] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:26:29] *** Joins: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca)
[12:49:35] *** Quits: ogham (rally@moz-f25.edm.199.138.IP) (Ping timeout: 121 seconds)
[12:54:04] *** Joins: ogham (rally@moz-02j.06e.6.31.IP)
[12:55:43] *** Quits: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca) (Connection closed)
[12:56:05] *** Joins: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca)
[12:59:26] *** Quits: fkaa (tundmatu@moz-501od2.business.telia.com) (RecvQ exceeded)
[12:59:37] *** Joins: fkaa (tundmatu@moz-501od2.business.telia.com)
[13:00:22] *** Quits: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca) (Ping timeout: 121 seconds)
[13:25:43] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[13:49:37] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[13:53:05] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[14:00:09] *** Joins: daschl (Adium@moz-oirn1i.vie.surfer.at)
[14:15:51] *** Quits: filsmick (filsmick@moz-0svev4.abo.wanadoo.fr) (Quit: )
[14:20:33] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[14:29:25] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[14:30:25] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[14:30:37] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[14:31:43] *** Quits: daschl (Adium@moz-oirn1i.vie.surfer.at) (Quit: Leaving.)
[14:46:44] *** Quits: burntsushi (burntsushi@moz-t92kn9.ma.charter.com) (Connection closed)
[14:47:13] *** Joins: burntsushi (burntsushi@moz-t92kn9.ma.charter.com)
[14:48:37] *** Joins: daschl (Adium@moz-7plvne.public.telering.at)
[14:56:07] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[14:56:38] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[15:00:42] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Ping timeout: 121 seconds)
[15:09:37] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[15:10:08] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[15:10:09] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[15:24:55] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[15:25:20] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[15:36:07] *** Joins: O01eg (o01eg@moz-8p1van.34rt.4n8f.2698.2a02.IP)
[15:43:16] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[15:46:31] *** Quits: daschl (Adium@moz-7plvne.public.telering.at) (Connection closed)
[15:52:07] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[15:56:30] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[15:59:54] *** Quits: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com) (A TLS packet with unexpected length was received.)
[16:02:13] *** Joins: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com)
[16:03:08] *** Joins: daschl (Adium@moz-7plvne.public.telering.at)
[16:06:40] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:10:54] *** Joins: Guest35953 (Jorge@moz-7bh.ng6.177.186.IP)
[16:11:04] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:13:14] *** Quits: daschl (Adium@moz-7plvne.public.telering.at) (Ping timeout: 121 seconds)
[16:14:58] *** Joins: daschl (Adium@moz-1i4q42.public.t-mobile.at)
[16:20:28] <jack> acrichto: I'm trying to test shared target dirs, but it seems to rebuild a bunch of things anyway, although not everything.
[16:20:36] <jack> Do you have a suggestion on how to debug?
[16:21:13] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:23:39] <acrichto> jack: hm, could you gist me some logs
[16:23:40] <acrichto> ?
[16:24:01] <jack> Trying to get some with cargo -v
[16:25:31] <jack> I'm currently trying to figure out why cargo is takign 100% cpu and not doing anything.
[16:25:39] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:26:00] <acrichto> jack: you build with --enable-optimize, right?
[16:26:06] <acrichto> jack: cargo can be super slow if built in debug mode
[16:26:15] <jack> oh, it is in debug mode :)
[16:26:19] * jack fixes that
[16:33:53] <jack> acrichto: Now it takes 5s to do a do-nothing build instead of 2 minutes.
[16:33:56] <jack> So that is an improvement.
[16:34:03] <acrichto> jack: \o/
[16:34:21] <acrichto> jack: that still seems absurdly slow to me, I've been doing some local improvements but I need to investigate servo a bit more
[16:34:41] <jack> This is just ./mach build --release followed by the same immediately after.
[16:34:47] <jack> So should be easy to reproduce.
[16:35:20] * acrichto tries to repro
[16:35:50] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:36:32] <jack> I'm going to guess it's a ton of stat calls or something :)
[16:37:38] <jack> The good news about target sharing is that when i went ot go back and build the cef port, it did nothing.
[16:37:51] <jack> So switching back and forth is a huge improvement now.
[16:37:52] *** Quits: larsberg (sid89@moz-1a60qu.0j4i.jtu0.0101.2620.IP) (Quit: )
[16:39:06] <acrichto> jack: \o/
[16:39:15] <acrichto> jack: I landed a few patches recently to reduce the number of stat calls
[16:39:18] <acrichto> by like 2-3x
[16:39:25] <acrichto> in at least some situations
[16:39:32] <acrichto> but I'd believe there's still more, just want to track them down first
[16:39:43] <acrichto> jack: how do I use a custom cargo with the servo build?
[16:39:45] *** Joins: jedireza (jedireza@moz-ungcc1.dsl.ovh.fr)
[16:39:53] <jack> I'm trying to test the builder part where you build servo first then cef, and it should only rebuild the new parts.
[16:40:14] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:40:14] <jack> cp servobuild.example to .servobuild and then set system-cargo to true
[16:40:22] <jack> and make sure the right cargo is the first on your path
[16:40:38] <jack> or set system-cargo=true and cargo-root=/place/to/find/cargo
[16:40:41] <acrichto> jack: ok cool, thanks
[16:41:10] <jack> ./mach env will print out PATH and LD_LIBRARY_PATH if you want to double check
[16:41:26] <jack> and if you'd rather just work with cargo direclty, you can eval `./mach env` and then cd components/servo && cargo build --release
[16:41:51] <jack> (mostly what mach is doing is sanitizing arguments and setting up the environment)
[16:50:23] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:51:24] <acrichto> jack: hm, does `./mach env` not set CARGO_HOME?
[16:51:43] <jack> no
[16:51:49] <jack> what is CARGO_HOME?
[16:53:06] *** Quits: daschl (Adium@moz-1i4q42.public.t-mobile.at) (Connection closed)
[16:53:49] <acrichto> jack: I CARGO_HOME changes the where git checkouts and stuff are stored
[16:53:54] <acrichto> I think cargo uses it to check everything out in-tree
[16:54:25] <acrichto> jack: https://github.com/servo/servo/blob/master/python/servo/command_base.py#L143-L144
[16:54:34] *** Quits: jedireza (jedireza@moz-ungcc1.dsl.ovh.fr) (Quit: Textual IRC Client: www.textualapp.com)
[16:54:48] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:56:03] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:57:11] <jack> ah
[16:57:21] <jack> that's also in servobuild
[16:57:37] <jack> probably ./mach env should be updated to spit that out too
[17:00:07] *** Joins: daschl (Adium@moz-7plvne.public.telering.at)
[17:00:26] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:07:25] *** Quits: FreeFull (freefull@moz-f65lp3.skybroadband.com) (Quit: )
[17:08:48] *** Joins: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP)
[17:10:36] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:15:01] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:25:12] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:29:34] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:39:45] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:42:22] *** Joins: dpc (dpc@moz-t6gr4b.ca.comcast.net)
[17:42:31] *** Joins: dpc_ (dpc@moz-t6gr4b.ca.comcast.net)
[17:44:08] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:49:25] <acrichto> jack: hm, so servo has a large dependency graph
[17:49:31] <acrichto> an I just realized cargo does a like O(N^N) operation
[17:49:35] <acrichto> which may be why it's slow
[17:49:40] * acrichto fixes
[17:49:57] <sfackler> n^n?!?
[17:50:26] <acrichto> I'm not actually sure what the O is in this case
[17:50:41] <acrichto> given a DAG, take literally every path through the DAG from any node to all leaves
[17:51:15] *** Quits: ogham (rally@moz-02j.06e.6.31.IP) (Ping timeout: 121 seconds)
[17:53:20] *** Joins: ogham (rally@moz-91e3hp.cable.virginm.net)
[17:54:19] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:55:38] <jack> Good find them :)
[17:55:46] <jack> *then
[17:56:14] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[17:58:15] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[17:58:43] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:59:33] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[18:01:48] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[18:13:49] *** Joins: p32blo (p32blo@moz-v36o87.cpe.netcabo.pt)
[18:21:55] *** Quits: p32blo (p32blo@moz-v36o87.cpe.netcabo.pt) (Ping timeout: 121 seconds)
[18:21:55] *** Joins: SneakySnake (nya@moz-i9is4u.pool.telekom.hu)
[18:23:42] *** Quits: daschl (Adium@moz-7plvne.public.telering.at) (Quit: Leaving.)
[18:27:15] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[18:32:33] *** Joins: daschl (Adium@moz-oirn1i.vie.surfer.at)
[18:35:00] *** Joins: fkaa_ (tundmatu@moz-501od2.business.telia.com)
[18:38:00] *** Quits: fkaa (tundmatu@moz-501od2.business.telia.com) (Ping timeout: 121 seconds)
[18:38:38] *** Quits: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP) (Connection closed)
[18:39:15] <jack> acrichto: Here is a build log from running cargo build --release -v in components/servo then the same in ports/cef
[18:40:05] <jack> It's still unclear even with -v why some things are not fresh.
[18:41:06] <jack> Line 272 is the start of the second build command.
[18:42:24] <acrichto> jack: hm, was there supposed to be a link in that message?
[18:43:21] <jack> Sorry: https://gist.github.com/metajack/99ffb6d049285e8d18f2
[18:43:21] *** Joins: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP)
[18:43:37] <jack> The hashes are different.
[18:44:23] <jack> not sure why it would be compiling style as crate-type=bin
[18:44:25] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:44:48] *** Quits: fkaa_ (tundmatu@moz-501od2.business.telia.com) (Quit: )
[18:44:58] <jack> I'm guessing the deps are slightly mismatched.
[18:45:04] <acrichto> jack: wait is this a log of ports/cef?
[18:45:09] <acrichto> after components/servo was done already?
[18:45:27] <jack> acrichto: it's both the initial compoents/servo compile and then started at 272 it's the compile of ports/cef
[18:45:53] <jack> [jack@ocate servo]$ rm -rf ../../target
[18:45:53] <jack> [jack@ocate servo]$ cargo build --release -v >> ~/src/servo/build.log 2>&1
[18:45:53] <jack> [jack@ocate servo]$ cd ../../ports/cef
[18:45:53] <jack> [jack@ocate cef]$ cargo build --release -v >> ~/src/servo/build.log 2>&1
[18:46:02] <jack> acrichto: ^ that hopefully clears it up
[18:46:04] <acrichto> hm, it looks like build scripts are getting invalidated
[18:52:12] <jack> I just checked deps for style and they match across the two Cargo.locks
[18:53:24] <acrichto> jack: can you re-run with RUST_LOG=cargo::ops::cargo_rustc::fingerprint?
[18:53:34] <acrichto> that'll generate a huge amount of logs
[18:53:36] <jack> yep. give me a few minutes
[18:56:26] <jack> Crust-task_info is using a build.rs that calls makefile.cargo
[18:57:09] <jack> I mean, for starters, it's an OS X dependency :)
[18:57:20] * jack starts doing some cleanup
[18:57:39] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[18:59:33] *** Quits: O01eg (o01eg@moz-8p1van.34rt.4n8f.2698.2a02.IP) (Client exited)
[19:00:00] *** Quits: Quxxy (chatzilla@moz-efh10q.internode.on.net) (Ping timeout: 121 seconds)
[19:04:31] *** Joins: fkaa (tundmatu@moz-501od2.business.telia.com)
[19:05:23] *** Quits: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP) (Connection closed)
[19:09:14] *** Quits: ytain (ytain@moz-ffpck2.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[19:16:30] *** Joins: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP)
[19:19:57] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[19:21:32] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[19:29:30] *** Joins: p32blo (p32blo@moz-v36o87.cpe.netcabo.pt)
[19:30:48] <jack> acrichto: http://metajack.im/tmp/build2.log
[19:30:55] <jack> what's 118MB of logs between friends?
[19:34:50] *** Quits: duncan (paul@moz-dst.ms6.225.173.IP) (Connection closed)
[19:43:11] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[19:44:21] <iu> Hi! Has anybody experienced such a problem where `cargo package` tries to pack a git submodule as a file and, hence, fails with “Is a directory (os error 21)”?
[19:58:04] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[20:00:29] *** Joins: eibwen (eibwen@moz-4fjp9d.dip0.t-ipconnect.de)
[20:06:17] <iu> Actually, it seems `cargo package` fails for any repository with a git submodule (nightly).
[20:06:41] *** Quits: p32blo (p32blo@moz-v36o87.cpe.netcabo.pt) (Ping timeout: 121 seconds)
[20:08:53] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[20:09:02] <iu> Installed --spec=stable. Works just fine.
[20:10:47] <iu> Sorry for spamming, but it would be nice if somebody could confirm) Thanks!
[20:12:44] <acrichto> jack: good lord that is a larg elog
[20:13:22] <acrichto> iu: hm that sounds bad, could you open an issue on that?
[20:13:48] <iu> acrichto: But maybe it’s only my problem. Does it happen to you as well?
[20:14:01] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:14:06] <iu> acrichto: Ops, sorry)
[20:14:30] <acrichto> iu: I don't run many nightly builds of Cargo so I wouldn't have run into it yet
[20:14:35] <acrichto> iu: but I would believe that it's a problem
[20:15:33] <iu> acrichto: Well I guess I can try on another machine with another OS first.
[20:21:19] <jethrogb> how do I specify arbitrary cfg in a Cargo manifest?
[20:25:23] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[20:27:17] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:29:49] <acrichto> jethrogb: currently you cannot, but cargo enables activation of cfg through features
[20:30:44] *** Joins: zyphrus (David@moz-1a4.urk.98.101.IP)
[20:30:59] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:31:43] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[20:39:12] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:40:25] *** Joins: O01eg (o01eg@moz-stqs0u.1si9.4n8f.2698.2a02.IP)
[20:41:48] *** Quits: daschl (Adium@moz-oirn1i.vie.surfer.at) (Quit: Leaving.)
[20:46:48] <jethrogb> sure, but they can't hold values
[20:49:28] <acrichto> jethrogb: /win 12
[20:49:30] <acrichto> gah
[20:49:49] <acrichto> jethrogb: there's an open issue on this I thought
[20:49:53] <acrichto> but I can't seem to find it
[20:56:08] *** Joins: larsberg (Adium@moz-kmvlue.cable.rcn.com)
[21:06:54] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[21:14:43] *** Joins: FreeFull (freefull@moz-o5b738.range86-156.btcentralplus.com)
[21:15:09] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[21:21:50] *** Quits: SneakySnake (nya@moz-i9is4u.pool.telekom.hu) (Quit: Leaving)
[21:29:07] <acrichto> jack: have you seen this much https://gist.github.com/alexcrichton/cf9e5fc57e55da3e44d4 ?
[21:38:47] <jack> acrichto: I ahve not seen that.
[21:38:51] <jack> That was with a clena build?
[21:45:44] <larsberg> Usually weird C dependency failures are due to a non-clean build because of our hideous dependency makefiles - https://github.com/servo/servo/issues/6088
[21:47:22] <jethrogb> I don't understand the paths local configuration option
[21:47:51] <jethrogb> I have two packages, one which pulls dependency A from crates.io, and another that pulls dependency A from git
[21:47:56] *** Quits: larsberg (Adium@moz-kmvlue.cable.rcn.com) (Quit: Leaving.)
[21:48:01] <jethrogb> how do I override the first to also pull it from git?
[21:48:16] <steveklabnik> .cargo/config
[21:48:25] <steveklabnik> basically
[21:48:54] <steveklabnik> http://doc.crates.io/guide.html#overriding-dependencies
[21:48:58] <steveklabnik> jethrogb: ^
[21:49:03] <jethrogb> I read that section
[21:49:22] <steveklabnik> [dependencies.A] git = "..." doesn't work?
[21:49:27] <steveklabnik> oh
[21:49:33] <steveklabnik> wait, you have two for A?
[21:49:38] <steveklabnik> that should be, an error or something
[21:49:54] <acrichto> jack: nah if I run `cargo build` and then I tweak cargo so it has to recompile everything, then run `cargo build` again I get errors like that
[21:50:03] <acrichto> jack: the only way I've fixed it is to run a full `cargo clean`
[21:50:24] <acrichto> jethrogb: currently you cannot override just one, you have to override both
[21:50:49] <acrichto> jethrogb: https://github.com/rust-lang/cargo/issues/736
[21:51:36] <jethrogb> that's fine, I still don't understand how to do it
[21:52:04] <acrichto> jethrogb: "it" being?
[21:52:20] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[21:52:39] <jethrogb> I guess what to put in .cargo/config
[21:53:16] <acrichto> jethrogb: in .cargo/config you put an entry that looks like:
[21:53:23] <acrichto> paths = ["/path/to/some/project"]
[21:54:00] <jethrogb> so how do I specify a git repository?
[21:54:21] <acrichto> jethrogb: it has to be a local checked-out package
[21:54:22] <acrichto> on your local fs
[21:54:26] <jethrogb> oh
[21:54:48] <jack> acrichto: We dont' change cargo much in servo development :)
[21:55:01] <iu> acrichto: This one is the problem https://github.com/rust-lang/cargo/commit/8fa3aaf697c0d641736b2c68b8fc5aeebe027ec6
[21:55:13] <acrichto> jack: btw so far I've gotten a noop `cargo build` from 5s down to 2s, hope to shave off at least another second soon
[21:55:21] <jack> Awesome :)
[21:55:24] <iu> acrichto: … regarding archiving git submodules.
[21:56:03] <acrichto> iu: hm, I wonder if libgit2 reports the "file" of a submodule not as a file but rather as a directory
[21:56:04] <iu> acrichto: I was reverting commit by commit and recompiling Cargo until I hit this one.
[21:56:07] <acrichto> er, other way around
[21:57:15] <iu> That is, after reverting this one, Cargo started packing submodules as it used to.
[21:57:21] <jack> acrichto: Is that change just from a better dependency walker?
[21:57:49] <iu> acrichto: Should I file an issue?
[21:57:50] <acrichto> jack: a few optimizations here and there, mostly around just not recursing as much yeah
[21:57:53] <acrichto> iu: yes please!
[21:58:09] <acrichto> jack: commits so far: https://github.com/alexcrichton/cargo/commits/perf
[22:00:08] <jack> I started cleaning up our target specific deps to see if that helps
[22:01:12] *** Quits: eibwen (eibwen@moz-4fjp9d.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:13:10] <jack> (the buidl servo then build cef case)
[22:14:06] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[22:29:12] *** Quits: fkaa (tundmatu@moz-501od2.business.telia.com) (Ping timeout: 121 seconds)
[22:29:46] *** Joins: fkaa (tundmatu@moz-n4as1f.cust.tele2.se)
[22:35:12] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:38:57] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[22:49:15] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:52:43] *** Joins: harrisonclarke (harrisoncla@moz-v2i.4mr.177.142.IP)
[22:53:28] <jack> acrichto: Ok. So I fixed some of it, but it's rebuilding style for no reason I can discern.
[22:53:28] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[22:53:37] <jack> the hashes are different.
[22:53:59] <jack> Maybe anytime build.rs is used the hash gets changed?
[22:54:54] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:55:24] <jack> How does it decide when a build.rs script triggers a recompilation?
[23:02:12] *** Joins: tyoverby (tyoverby@moz-fo2liv.cs.washington.edu)
[23:03:58] <acrichto> jack: hmmm
[23:04:06] <acrichto> build.rs triggers a recompile if anything in the package dir changes
[23:04:22] <jack> so it needs to be very careful not to change an mtime?
[23:04:29] <acrichto> yeah but you probably already do that
[23:04:37] <acrichto> b/c two cargo bulids with the same output dir don't trigger a recompile
[23:04:41] <acrichto> what'd you call the output directory?
[23:04:45] <acrichto> is it still called `target`?
[23:04:48] <jack> In this case it's really dumb. it always spits out the template even if the input is unchanged.
[23:05:00] <jack> There is nothing to abstract over my inputs being updated so it's all manual
[23:05:16] <acrichto> hm, that may be it then
[23:07:29] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Connection closed)
[23:07:40] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[23:09:47] <sfackler> it'd really be nice to add that buildscript dependency whitelist thing
[23:11:10] *** Quits: iu (iu@moz-6263qv.cc.cmu.edu) (Connection closed)
[23:11:59] <acrichto> sfackler: ?
[23:12:09] <acrichto> sfackler: oh right
[23:12:14] <sfackler> a list of files that your build.rs cares about
[23:14:14] *** Quits: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP) (Connection closed)
[23:16:34] *** Joins: p1start (p1start@moz-nftjhe.org)
[23:19:05] <Ilari> Rebuild will also be triggered if the list of files itself changes, right?
[23:21:20] <jack> acrichto: is there some way to tell if the inputs have changed?
[23:21:26] <jack> clearly cargo knows, but can build.rs get that info?
[23:21:41] <jack> I guess I can compare mtime.
[23:21:53] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:22:52] <acrichto> jack: kinda? if the build script is running it's only because cargo thinks something has changed
[23:23:44] <jack> Nothing has changed though.
[23:23:53] <jack> Is there a way to figure out what cargo thinks has change?
[23:23:58] <jack> I mean, build.rs generate a file
[23:24:26] <jack> so if it's detecting the change from pre-build, then yes, it's changed. but it hasn't changed since the last time the crate was compiled.
[23:25:05] <jack> i can add in stuff to build.rs so that it doesn't generate its output unconditionally, but it sounds like the fact build.rs is running at all is already a bug.
[23:26:43] <acrichto> jack: ah no, there's no way of doing that right now
[23:27:45] <jack> So it appears that building style from two different parents causes a rebuild if nothing has changed.
[23:30:47] *** Joins: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP)
[23:34:10] <acrichto> jack: yeah this sounds suspicious
[23:34:15] <acrichto> it'll take me awhile to dig through those logs
[23:36:27] *** Quits: ogham (rally@moz-91e3hp.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:41:15] <jack> acrichto: I can debug this further if you can give me pointers on RUST_LOG incantations
[23:44:30] <acrichto> jack: ok!
[23:46:38] *** Quits: dpc_ (dpc@moz-t6gr4b.ca.comcast.net) (Quit: Leaving)
[23:50:52] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
