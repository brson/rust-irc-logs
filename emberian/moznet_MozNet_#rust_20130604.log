[00:00:11] <pcwalton> one thing I want to measure is how much of trans is in LLVM (and e.g. mallocs called by LLVM) versus Rust
[00:00:11] <aatch> pcwalton, but you can set names for value refs...
[00:00:22] <pcwalton> aatch: but I don't know if gdb will be able to print them
[00:00:33] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90-rdmsoft [XULRunner 18.0.2/20130201065344])
[00:00:35] <aatch> pcwalton, that's pretty much seperate.
[00:00:42] <pcwalton> right
[00:00:47] <pcwalton> what he meant is for -g debug info
[00:00:53] <aatch> declarations are done with llvm.dbg.declare intrinsic
[00:02:05] <pcwalton> brson: r? https://github.com/mozilla/rust/pull/6922
[00:02:23] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[00:03:03] *** Quits: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP) (Quit: lmandel)
[00:03:18] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[00:03:26] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: Textual IRC Client: www.textualapp.com)
[00:03:38] <strcat> pcwalton: https://github.com/mozilla/rust/issues/6923 look at those allocas
[00:03:51] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[00:03:54] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:03:56] <aatch> ok, so you do need allocas for arguments with debugging
[00:04:07] <pcwalton> strcat: yeah, that's what I'm talking about
[00:04:12] <pcwalton> I think we may be able to tidy that up a lot
[00:04:41] <strcat> pcwalton: fyi this compiles to the same code post-optimization now
[00:04:46] <strcat> but it's scary what we generate before that
[00:04:57] *** Joins: mindginative (mindginati@moz-9C555AF3.spmconsultants.co.nz)
[00:05:10] *** Quits: mindginative (mindginati@moz-9C555AF3.spmconsultants.co.nz) (Quit: brb)
[00:05:27] <aatch> I stared into the void... It stared back...
[00:05:31] * aatch is scarred
[00:05:38] <pcwalton> yeah, fixing these kinds of issues may help our compile times a lot
[00:05:46] <pcwalton> it may be something silly
[00:05:59] <pcwalton> I mean, the Datum abstraction *is* designed to allow us to emit good IR
[00:06:08] <strcat> pcwalton: I really don't understand why we make 1000 casts
[00:06:24] <pcwalton> me either
[00:06:59] <strcat> anyway maybe it would be better to start with something simple like taking a reference and passing it
[00:07:17] <strcat> swap should be pretty simple though
[00:07:28] <aatch> pcwalton, btw, technically what strcat posted does go through 2 passes: strip dead prototypes and always_inline
[00:07:47] <aatch> though to be fair, the clang code also goes through always_inline
[00:08:06] *** Joins: unbracketed (textual@moz-7F0EE151.lsanca.fios.verizon.net)
[00:08:15] <strcat> hardly anything uses __attribute__((always_inline)) though
[00:08:26] <strcat> I don't think anything involved in this does
[00:08:42] <aatch> I wasn't saying it made an impact
[00:08:47] <strcat> ah
[00:09:04] <aatch> there is a reason why there is a seperate pass for always inlining
[00:09:27] <aatch> it's the inliner with the threshold cranked down to -2000000.
[00:09:37] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[00:11:08] *** Quits: dbaupp (Thunderbir@moz-C6B1454A.lns20.syd7.internode.on.net) (Ping timeout)
[00:11:41] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Quit: \n)
[00:12:10] <aatch> strcat, I'm pretty sure the reason why clang output doesn't have a block labeled is because the IR writer doesn't output it if there is only one block in the function
[00:13:05] <aatch> or not...
[00:13:08] *** Quits: quaddle (Mibbit@moz-E919BED1.dynamic.amis.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:13:09] <aatch> I don't know...
[00:13:17] <aatch> maybe clang doesn't name it.
[00:13:33] <strcat> oh and what's 
[00:13:35] <strcat> declare {} @_ZN7cleanup10annihilate17_c17425bfbdabf8296_07preE({ i64, %tydesc*, i8*, i8*, i8 } addrspace(1)*)
[00:13:36] <strcat> ?
[00:13:48] <strcat> do we generate destructors for *everything*?
[00:14:35] *** cscottnet is now known as cscottnet_away
[00:14:51] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[00:14:55] *** Quits: mflamer (Mibbit@moz-FE8B7976.dsl.pltn13.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:15:50] <strcat> looks like all functions have an env + we generate cleanup, I guess
[00:16:20] <pcwalton> annihilate() is some stupid legacy stuff
[00:16:20] * strcat doesn't understand why
[00:16:29] <strcat> pcwalton: why do we have that first ptr param to everything?
[00:16:41] <pcwalton> legacy :)
[00:17:01] <pcwalton> there's no reason, it should be removed.
[00:17:04] <strcat> good. I thought it might actually be used
[00:17:06] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Ping timeout)
[00:17:11] *** Quits: eholk (eholk@moz-6D2C9014.uconnect.utah.edu) (Quit: eholk)
[00:17:48] *** Joins: seth (seth@2557E599.66715431.D25A875A.IP)
[00:18:28] *** Quits: lerc (quassel@121-74-233-23.telstraclear.net) (Client exited)
[00:19:35] *** Joins: alisdair (textual@moz-EA60A466.dedicated.allstream.net)
[00:20:48] *** Joins: \n (NDesaulnie@2557E599.66715431.D25A875A.IP)
[00:22:31] *** Joins: mflamer (Mibbit@moz-FE8B7976.dsl.pltn13.sbcglobal.net)
[00:23:16] <mflamer> struct Dart<T> { 	alpha: ~[&Dart<T>], 	embed: ~[&T],    tagged: bool }, the compiler complains about this
[00:23:36] <SingingBoyo> rusti: struct Dart<T> {  alpha: ~[&Dart<T>],  embed: ~[&T],    tagged: bool }
[00:23:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/iIKd
[00:23:51] <aatch> mflamer, & are borrowed pointers, so the compiler needs to reason about them
[00:24:01] <aatch> specifically their lifetimes
[00:24:10] <aatch> so you need to specify it in the struct.
[00:24:19] <bblum> rusti: unsafe { let x: (int, int) = cast::transmute(5); }
[00:24:20] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/WgPM
[00:24:39] <mflamer> ok, I havevt had to do that yet, I'll read up. I assume its in the ref manual
[00:24:49] <bblum> rusti: use cast::transmute; unsafe { let x: (int, int) = transmute(5); }
[00:25:10] <aatch> rusti: struct Dart<'self,T> { alpha: ~[&'self Dart<T>], embed: ~[&'self T], tagged: bool }
[00:25:21] <aatch> see, no error
[00:25:23] <strcat> pcwalton: going to try to make a simple example of that cast issue
[00:25:34] <strcat> seems like it might be from the &mut -> *mut coercion? that's all I can think of
[00:25:41] <aatch> rusti: use cast::transmute; unsafe { let x: (int, int) = transmute(5) }
[00:25:44] <strcat> swap is really simple code.
[00:26:29] *** Parts: twm (twm@moz-13417AD3.dsl.static.sonic.net) ()
[00:26:51] <SingingBoyo> rusti: fn x(y:int) -> int{y*y*y} x(3)
[00:27:12] <SingingBoyo> I think we killed rusti :/
[00:27:19] <strcat> rusti: 5
[00:27:24] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[00:27:32] <aatch> there it goes
[00:27:32] <strcat> huh
[00:27:44] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:27:53] <strcat> rusti:  use cast::transmute; unsafe { let x: (int, int) = transmute(5) }
[00:27:54] -rusti- foo.rs:10:73: 10:74 error: expected `;` but found `}`
[00:27:54] -rusti- foo.rs:10           use cast::transmute; unsafe { let x: (int, int) = transmute(5) }
[00:27:54] -rusti-                                                                                    ^
[00:27:54] -rusti- application terminated with error code 101
[00:28:01] <strcat> it died a while ago then
[00:28:06] <bblum> rusti: unsafe { let x: (int, int) = ::std::cast::transmute(5); }
[00:28:13] -rusti- foo.rs:1:0: 1:0 error: transmute called on types with different sizes: int (64 bits) to (int,int) (128 bits)
[00:28:13] -rusti- foo.rs:1 #[allow(unused_variable)];
[00:28:13] -rusti-          ^
[00:28:13] -rusti- application terminated with error code 101
[00:28:31] <strcat> rusti: heh
[00:28:32] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RGLG
[00:28:39] <jld> rusti: unsafe { let x: (i32, i32) = ::std::cast::transmute(5); x }
[00:28:40] -rusti- (5, 0)
[00:29:21] * jld is *quite* familiar with the transmute size error by now
[00:29:29] <jld> It shows up a bunch if you try to change enum discriminant sizes.
[00:30:31] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[00:30:31] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/5n0cpQ
[00:30:31] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[00:30:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[00:30:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Kgt_8g
[00:30:32] <ghrust> 13rust/06auto 14d85938f 15Michael Sullivan: Make type_is_pod handle structs correctly. Closes #6868.
[00:30:32] <ghrust> 13rust/06auto 14af418f2 15bors: auto merge of #6924 : msullivan/rust/incoming, r=pcwalton
[00:30:33] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[00:32:00] *** Joins: fizzy (Mibbit@moz-5743B4F6.rochester.res.rr.com)
[00:32:08] *** Joins: lerc (quassel@moz-598ED764.telstraclear.net)
[00:33:58] <SiegeLord> I've a question about the removal of @... would that preclude precise GCs from being implemented?
[00:35:03] <strcat> I don't think it places any limitations on the implementation
[00:35:12] *** Joins: koomi (koomi@moz-7FEFD546.pools.arcor-ip.net)
[00:35:15] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[00:35:17] <strcat> we can use lang attributes
[00:35:49] *** Quits: k00mi (koomi@moz-ECD7DE60.pools.arcor-ip.net) (Ping timeout)
[00:35:55] <SiegeLord> I'm just trying to reconcile what you said a few days ago about the benefit of @ and the blog post...
[00:36:14] <pcwalton> it wouldn't preclude precise GC
[00:36:17] *** dcoates is now known as dcoates|afk
[00:36:40] <aatch> Well one issue is that apparently ty::Ty equality sucks
[00:36:45] <strcat> SiegeLord: a third party library can't implement a precise gc (right now) but rust's libraries are special - they have lang attributes to hook into
[00:37:52] <xenocons> good discussion on the mailing list around I/O stuff
[00:37:55] <xenocons> good to see this happening
[00:38:17] <strcat> aatch: so it compares non-equal and makes casts?
[00:38:23] <aatch> yep
[00:38:40] <aatch> mostly because it actually compares the top-level types
[00:38:58] *** Quits: seth (seth@2557E599.66715431.D25A875A.IP) (Input/output error)
[00:39:04] <aatch> and not the llvm types
[00:39:22] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (Quit: WeeChat 0.4.1)
[00:39:22] <aatch> though I think some of the casts are actually ignored by the ir builder
[00:39:41] <aatch> like (*i64) -> (*i64)
[00:41:00] *** Quits: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[00:41:02] <SiegeLord> strcat, So a few days ago you said that @ must be a language feature for precise GC's... So I take it that those attributes are sufficient?
[00:41:15] <SiegeLord> *those lang attributes
[00:42:33] <pcwalton> the compiler has to know about it somehow but lang items should be sufficient
[00:43:19] *** Joins: SimonSapin (simon@A5049320.3E93794D.61EA6C28.IP)
[00:43:27] *** Quits: mflamer (Mibbit@moz-FE8B7976.dsl.pltn13.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:44:01] <strcat> C++11 added some weird gc hooks ;p
[00:44:11] <strcat> http://en.cppreference.com/w/cpp/memory/gc/declare_no_pointers
[00:44:34] * strcat doesn't know how you'd be expected to actually use those correctly though
[00:44:57] <aatch> strcat, ok, so some of the bloat is fallout from inlining util::swap, I think.
[00:45:06] <strcat> aatch: well I just tried without that
[00:45:26] <strcat> aatch: http://ix.io/5XX
[00:45:59] <aatch> yeah, it's a bit smaller, not that it's still any good mind you...
[00:46:27] <jdm> if upcall_call_shim_on_rust_stack is showing up in profiles, am I SOL if I can't change how often the rust callback is being called?
[00:46:59] <pcwalton> jdm: you need to wait for niko's extern fn changes to land I link
[00:47:02] <pcwalton> I think
[00:47:24] <jdm> I'm surprised that hasn't landed yet
[00:47:32] <pcwalton> nmatsakis: has that landed yet?
[00:47:59] <jdm> pcwalton: when fast-ffi landed, was there any kind of opt-in required, or is it just a general speedboost all around?
[00:48:05] <pcwalton> opt-in was required.
[00:48:11] <pcwalton> niko had/has a PR to fix that.
[00:48:15] <aatch> there are an incredible amount of these: %25 = load i64** %7
[00:48:15] <aatch>   store i64* %25, i64** %8
[00:48:15] <aatch>   %26 = load i64** %8
[00:50:03] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[00:52:47] <xenocons> just got caught up on rust-dev, im going to try to not let that happen again, heh
[00:54:14] <pcwalton> the problem here is that we're calling memcpy
[00:54:21] <pcwalton> and that requires bitcasts to i8.
[00:54:40] <pcwalton> we should be using a "smart memcpy" that lowers to load/store for small values and only if that fails call memcpy
[00:55:07] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[00:55:19] <strcat> pcwalton: the bitcast is inside the memcpy though
[00:55:24] <strcat> that's not the cast we're seeing outside
[00:55:36] <pcwalton> oh, well
[00:55:37] <strcat> the memcpy intrinsic takes *T externally now
[00:55:46] <pcwalton> ptr::copy_nonoverlapping_memory should not be casting to *i8
[00:55:50] <strcat> because I made it use T's alignment
[00:55:51] <aatch> Yeah, and the llvm instrinsic is overloaded...
[00:56:30] <strcat> #[inline(always)]
[00:56:32] <strcat> #[cfg(target_word_size = "64", not(stage0))]
[00:56:34] <strcat> pub unsafe fn copy_nonoverlapping_memory<T>(dst: *mut T, src: *const T, count: uint) {
[00:56:36] <strcat>     use unstable::intrinsics::memcpy64;
[00:56:38] <strcat>     memcpy64(dst, src as *T, count as u64);
[00:56:40] <strcat> }
[00:56:42] <strcat> pcwalton: it's that now ^
[00:56:58] <strcat> the intrinsic makes the cast before it calls the actual memcpy function, and that's not inlined
[00:57:06] <strcat> the weird 10000 casts are something else
[00:57:27] <pcwalton> I know there are some casts that trans inserts
[00:57:29] <pcwalton> when calling functions
[00:57:34] <pcwalton> which are probably not always necessary
[00:57:39] <pcwalton> they were to work around region issues or... something
[00:58:29] <strcat> it could actually generate loads now I guess
[00:58:29] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[00:58:33] <strcat> I don't think it's really a big issue
[00:59:03] <pcwalton> we can probably eliminate the casts
[01:00:48] <pcwalton> see middle/trans/callee.rs line 785
[01:00:55] <pcwalton> comment: // this could happen due to e.g. subtypinmg
[01:00:58] <pcwalton> subtyping
[01:01:03] <pcwalton> I don't know if this can actually happen
[01:01:26] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[01:02:19] <pcwalton> we only have subtyping due to regions and regions have no effect at trans time...
[01:02:45] <aatch> well, lets see what happens if I comment out that code.
[01:02:48] <strcat> I think be should rename inline(always) to inline(force) so it's less tempting
[01:03:01] <strcat> we should*
[01:03:03] <aatch> strcat, yes!
[01:03:08] <pcwalton> aatch: at the very least you could make it not run unless the LLVM types are actually different
[01:03:14] <strcat> makes sense on tiny things but we overuse it
[01:03:38] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:04:10] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[01:04:24] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[01:04:31] <aatch> pcwalton, it's more of an experiment here
[01:04:39] <pcwalton> right
[01:04:49] <steven_is_false> brson: Are there currently bindings to SDL_CreateRGBSurfaceFrom in rust-sdl?
[01:04:53] <aatch> I'm half expecting an LLVM assertion
[01:05:02] <strcat> pcwalton: one nice thing about the memcpy instrinsic is that if we start outputting tbaa.struct metadata to mark padding, it knows to not bother copying it
[01:05:12] <strcat> but I guess we could do that ourselves too
[01:05:53] <aatch> and we'd have to turn tbaa back on. (I think)
[01:05:59] <strcat> aatch: I don't think so
[01:06:11] <strcat> the padding data just piggyback's on the same metadata node used to add tbaa info to fields
[01:06:33] *** Quits: snearch (snearch@moz-70E36F27.pool.mediaways.net) (Quit: Verlassend)
[01:06:56] <aatch> strcat, I think !tbaa.struct is actually a different name.
[01:12:54] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[01:14:17] *** Quits: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com) (Quit: jrfeenst)
[01:14:18] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[01:15:14] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[01:15:59] <aatch> hmm, the bitcasts only come up when it does the inline.
[01:16:31] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[01:16:40] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[01:20:46] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[01:21:12] <strcat> aatch: of copy_nonoverlapping_memory?
[01:21:19] <strcat> I don't have swap inlined and it makes them
[01:21:36] <aatch> I disabled inline altogether and I don't get any
[01:21:48] <aatch> I think LLVM itself generates them
[01:22:08] <strcat> strange
[01:22:31] <aatch> it needs to do the cast so it can call llvm.lifetime.{start,end}
[01:23:13] <aatch> memcpy has a pair of bitcasts, but that's fine
[01:23:34] <strcat> aatch: what passes does clang run at -O0? probably worth looking into
[01:23:56] <aatch> like I said, I think the ir builder ignores casts that do nothing.
[01:24:11] <aatch> the same way it does automatic constant folding
[01:24:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:24:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/Kgt_8g
[01:24:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:26:15] <aatch> Yep, it checks to pointer types: http://llvm.org/doxygen/IRBuilder_8h_source.html#l01145
[01:26:20] <aatch> s/to/the
[01:27:00] <brson> steven_is_false: I don't know the state of rust-sdl
[01:27:50] <steven_is_false> brson: In the meantime, I checked, and it's not bound. Would you accept a pull request if I coded a binding to it?
[01:28:39] <brson> steven_is_false: yes
[01:28:39] <aatch> strcat, that said, the block in callee that pcwalton mentioned does diddly-squat
[01:29:00] <steven_is_false> brson: Cool, I'll get working on it then.
[01:29:12] <pcwalton> btw, I don't know if llvm.lifetime.{start,end} is really helping
[01:29:31] <aatch> pcwalton, it's not us
[01:29:43] <aatch> it's llvm, during inlining
[01:29:52] *** Joins: deepdog (deepdog@moz-490E834C.client.mchsi.com)
[01:31:06] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[01:33:27] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke. It's all a joke.)
[01:34:20] <BitPuffin> :(
[01:34:23] <pcwalton> hmm
[01:34:30] <BitPuffin> only Rust 0.4 on FreeBSD
[01:34:40] <pcwalton> what does it look like pre-inlining?
[01:34:50] <cmr> BitPuffin: that is so ancient O_o
[01:34:56] <aatch> pcwalton, I added it to the issue
[01:34:57] <BitPuffin> cmr: yeah :(
[01:35:21] <BitPuffin> oh wait
[01:35:23] <BitPuffin> it does have 0.6
[01:35:42] <BitPuffin> the package name says 0.4 though lol
[01:35:45] *** Quits: lerc (quassel@121-74-233-23.telstraclear.net) (Connection reset by peer)
[01:35:55] <aatch> there are 2 bitcasts, in memcpy, which is where they are supposed to be.
[01:36:00] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[01:36:26] <strcat> aatch: and none in copy_nonoverlapping_memory?
[01:36:49] <aatch> strcat, yep
[01:36:55] <aatch> as in, you are correct
[01:37:33] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[01:37:40] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[01:37:46] *** Joins: lerc (quassel@moz-598ED764.telstraclear.net)
[01:38:38] <strcat> aatch: we certainly have a lot of load/alloca though
[01:38:55] <pcwalton> yeah, that's way much more code than std::swap
[01:39:00] <aatch> Oh yeah, and I think that exacerbates the problem
[01:39:53] <BitPuffin> Hmm
[01:39:56] <aatch> hmm, I turned on jump-threading (and only that) and the code looks much more similar
[01:39:57] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[01:39:58] *** Joins: SiegeLord (siege@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:40:00] *** Quits: koomi (koomi@moz-7FEFD546.pools.arcor-ip.net) (Ping timeout)
[01:40:05] <pcwalton> we should be able to get rid of the wrapper around the intrinsic
[01:40:06] <BitPuffin> would be nice to have some way to use OrientDB with Rust
[01:40:11] <pcwalton> once niko's extern fn thing is done
[01:40:18] <pcwalton> (I don't know how much of it is in)
[01:40:23] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[01:40:29] <aatch> I definately think that the odd prelude is big issue though
[01:40:45] <aatch> before the function call
[01:40:58] <pcwalton> yeah
[01:40:59] <pcwalton> that's bad
[01:41:27] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[01:41:36] <BitPuffin> although I guess that's pointless because MRE is dead
[01:41:57] <aatch> hmm, I wonder if doing a quick optimization on each function as it's finished would help...
[01:42:26] *** Joins: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net)
[01:42:46] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Quit: \n)
[01:42:58] <aatch> just some sanity ones, like jumpthreading, instcombine, dce
[01:42:58] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[01:43:29] <strcat> aatch: well that's why I wonder what clang does
[01:43:39] *** Quits: unbracketed (textual@moz-7F0EE151.lsanca.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[01:43:41] <strcat> maybe their IR only looks like that because they always run certain passes
[01:47:00] <BitPuffin> oh coool
[01:47:01] <BitPuffin> rsp!
[01:47:05] <BitPuffin> rusp
[01:47:51] <aatch> BitPuffin, how'd you find that?
[01:47:59] <BitPuffin> just scouting github
[01:48:11] <BitPuffin> https://github.com/languages/Rust
[01:48:15] *** Quits: thomaslee (thomaslee@moz-6C3931E3.static.twtelecom.net) (Client exited)
[01:48:19] <aatch> lol, that's mine, bjz's and dbaupp's project
[01:48:37] <bjz> :)
[01:48:49] <BitPuffin> Having a scripting language that is like rust would be amazing
[01:48:57] <cmr> it's a lisp.
[01:49:01] <BitPuffin> since I plan to make an engine/framework with Rust
[01:49:02] <cmr> not really anything like rust
[01:49:02] <aatch> it probably won't be much like rust at all
[01:49:02] <BitPuffin> awh:(
[01:49:06] <cmr> Aww?
[01:49:09] <cmr> That's a good thing!
[01:49:22] <aatch> but easy interopt with rust is a goal
[01:49:29] <BitPuffin> well who'd want to write games with lisp?
[01:49:30] <BitPuffin> I mean it's cool
[01:49:33] <BitPuffin> like damn
[01:49:44] <aatch> since one of the use cases is game-logic and data storage
[01:49:44] <BitPuffin> but not many people use Lisp for games haha
[01:51:58] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[01:52:05] <aatch> Also, rusp is more a lisp-like than a true lisp
[01:52:07] *** Quits: SimonSapin (simon@A5049320.3E93794D.61EA6C28.IP) (Quit: Leaving.)
[01:52:47] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[01:52:52] <BitPuffin> hmm
[01:53:02] <BitPuffin> I think it would be better to have something C family
[01:53:07] <BitPuffin> for games
[01:53:09] <BitPuffin> this is really cool
[01:53:19] <BitPuffin> but I guess it's not what I was hoping for haha
[01:53:22] <cmr> well it's not like you can't use lua
[01:53:33] <BitPuffin> hrm
[01:53:34] <cmr> luajit bindings work great :)
[01:53:36] <BitPuffin> I suppose
[01:53:42] <BitPuffin> Lua is fine
[01:54:00] <BitPuffin> Someone should make Terra bindings :)
[01:54:02] <aatch> btw, what's wrong with a lisp-like language?
[01:54:08] <BitPuffin> ah nothing 
[01:54:10] <cmr> aatch: unfamiliarity I'm guessing
[01:54:13] <cmr> which is a valid concern
[01:54:16] <BitPuffin> I was just thinking for games
[01:54:17] <aatch> I guess.
[01:54:25] <BitPuffin> which most people isn't used to writing lisp to get done
[01:54:28] <cmr> brson: I can't really figure out the failure http://buildbot.rust-lang.org/builders/try-linux/builds/512/steps/compile/logs/stdio
[01:54:51] <aatch> We were just going for the advantage that s-exprs give you, especially around macros
[01:55:04] <cmr> brson: there's -lpthread... is it too late in the cc invokage?
[01:55:12] <bjz> BitPuffin: lua is a derivation of scheme
[01:55:16] <aatch> cmr, isn't it -pthread?
[01:55:18] <brson> cmr: can you reproduce the failure?
[01:55:33] <cmr> brson: no
[01:55:36] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[01:55:36] <aatch> or doesn't it matter?
[01:55:39] <cmr> brson: let me try in a clean chroot though
[01:55:41] *** Quits: graydon (graydon@moz-2141437A.bchsia.telus.net) (Quit: Leaving.)
[01:55:44] <BitPuffin> bjz: Yeah? Well I never said it was C family, it's just more familiar than Lisp like
[01:55:49] <cmr> aatch: -pthread does something else, but includes -lpthread
[01:55:58] <cmr> aatch: it's just failing to link properly I think
[01:55:59] <bjz> BitPuffin: but yeah, s-exprs brovide many benefits
[01:56:06] <bjz> *provide
[01:56:27] <aatch> DUDE!! BROVIDE!
[01:56:39] *** Quits: eschweic (Adium@43CB6079.66715431.D25A875A.IP) (Quit: Leaving.)
[01:56:42] <bjz> heh :)
[01:56:45] <cmr> -lpthread -lrt -ldl -lm -lmorestack -lrustrt
[01:56:51] * aatch attempts to crush can on forehead
[01:56:54] <cmr> -lpthread has to come after -lrustrt
[01:57:05] <cmr> I have no idea why it fails on try and not locally, though
[01:57:09] * aatch gets a concussion
[01:57:17] <cmr> wait...
[01:57:19] <cmr> -lrustrt -lrt -lpthread 
[01:57:24] <cmr> What is UP with the build system :s
[01:57:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:57:28] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qsuz0A
[01:57:28] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:57:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:57:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/40-ucQ
[01:57:29] <ghrust> 13rust/06auto 14c5d7a77 15Jed Davis: Fix vec::each* return values
[01:57:29] <ghrust> 13rust/06auto 14133d451 15bors: auto merge of #6886 : jld/rust/vec-each-ret-fix, r=sanxiyn
[01:57:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:57:45] <bjz> if I want to remove some free-standing functions from str and vec, and they are used in the compiler, do I need to do a [cfg(stage0)] thingy?
[01:57:48] <mcpherrin> rust-lang.org is down?
[01:57:59] <aatch> bjz, yes
[01:58:04] <bjz> poo
[01:58:05] <cmr> why?
[01:58:08] <bjz> :P
[01:58:12] <SingingBoyo> mcpherrin: it's up for me
[01:58:22] <cmr> snapshot doesn't use functions defined in the source, it has its own crate its linked to
[01:58:44] <mcpherrin> SingingBoyo: odd.
[01:58:48] <brson> functions can be removed from vec without cfg
[01:59:02] <brson> the rustc built in stage0 will link to std built in stage0
[01:59:04] <aatch> Oh right...
[01:59:11] * aatch is an idiot...
[01:59:11] <brson> it's only when rustc *emits* code that calls std
[01:59:12] <bjz> brson: I'm trying to do some vec str cleanup
[01:59:22] <brson> that you need to worry about bootstrapping
[01:59:36] <SingingBoyo> mcpherrin:  possibly a bit slow (not sure if it's my internet or the site), but definitely up
[01:59:48] <brson> bjz: nice!
[02:00:19] <mcpherrin> SingingBoyo: other people in my area see it down too, so possibly an internet problem
[02:01:23] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[02:03:13] <cmr> brson: rustrt should be linking against pthread separately though, and it isn't, so that's a problem
[02:03:19] <cmr> it shouldn't just be linking in rustc
[02:03:21] <cmr> (I think)
[02:03:23] <bjz> brson: I'm guessing we won't be able to do it in one hit though, as folks will still be using the freestanding functions in pulls
[02:03:47] <cmr> bjz: that's called "annoy everyone with a PR in the queue"
[02:04:10] <cmr> it's fun, you should try it ;)
[02:04:18] <bjz> cmr: that's called, force it through on the weekend, then annoy everyone :)
[02:04:30] <cmr> heh
[02:04:50] *** Quits: alisdair (textual@moz-EA60A466.dedicated.allstream.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[02:04:56] <brson> bjz: don't worry about conflicting with other pulls. that's just the nature of it
[02:05:08] <brson> somebody will win and somebody will have to rebase
[02:05:48] <bjz> brson: I'm mor considering my own sanity :)
[02:07:06] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[02:07:33] <bjz> gah, so much ugly stuff
[02:07:47] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[02:08:16] <bjz> folks using vec::map
[02:08:24] <bjz> must be old code too
[02:08:27] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Ping timeout)
[02:08:31] <cmr> ie... most of it?
[02:08:45] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[02:10:04] <bjz> no, as in, not the method
[02:10:16] <bjz> using the free-standing function
[02:10:30] <cmr> no, I mean most of the code is old
[02:11:41] <bjz> ahh
[02:11:42] <bjz> :P
[02:12:57] <SingingBoyo> say I have trait T, and structs A and B that implement T, and a variable something like let x:@T = @A{foo:bar} as @T, can I pattern match on x something like match x { a:A => {doSomething()} _ => {} }?
[02:15:26] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[02:15:36] <strcat> cmr: we need to make rustrt link against jemalloc's deps
[02:15:50] <strcat> because the way I set it up, jemalloc is statically linked into librustrt
[02:16:15] <strcat> I don't know why it works for me though
[02:18:26] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[02:19:55] *** Quits: Jesse (jruderman@2557E599.66715431.D25A875A.IP) (Quit: Jesse)
[02:21:33] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[02:25:01] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Client exited)
[02:25:09] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[02:25:36] *** Joins: eholk (eholk@moz-E45742D4.public.wayport.net)
[02:26:21] *** Joins: SimonSapin (simon@moz-C286AD9A.bitcat.net)
[02:30:06] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[02:32:25] *** Joins: kimundi_ (kimundi@moz-DC21F2B2.dip0.t-ipconnect.de)
[02:33:49] *** Quits: kimundi (kimundi@moz-E8D1DF71.dip0.t-ipconnect.de) (Ping timeout)
[02:33:49] *** kimundi_ is now known as kimundi
[02:33:59] *** Quits: deepdog (deepdog@moz-490E834C.client.mchsi.com) (Ping timeout)
[02:38:03] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:38:52] *** Joins: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net)
[02:40:22] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[02:40:50] *** Quits: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP) (Quit: pcwalton)
[02:41:37] <mflamer> aatch, thanks for the help earlier. Had to run
[02:41:42] *** Joins: brendan (brendaneic@moz-F2B05088.public.wayport.net)
[02:41:48] <aatch> mflamer, np
[02:41:55] <mflamer> if your still on....
[02:42:31] *** Quits: brendan (brendaneic@moz-F2B05088.public.wayport.net) (Quit: brendan)
[02:42:49] <aatch> If I'm still on what?
[02:45:15] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[02:45:53] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[02:46:57] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[02:47:18] *** Quits: SiegeLord (siege@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:49:40] <SingingBoyo> Is there a way to pattern match on a managed pointer to a trait and get a managed pointer to the struct that implements that trait?
[02:51:25] *** Joins: telotortium (rmi1@moz-90BFA359.dhcp.mdsn.wi.charter.com)
[02:53:38] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[02:54:26] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:54:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/40-ucQ
[02:54:26] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:55:50] *** Quits: eholk (eholk@moz-E45742D4.public.wayport.net) (Quit: eholk)
[02:56:31] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[02:57:26] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:57:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/IbHO8w
[02:57:26] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:57:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:57:29] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/oBUi3Q
[02:57:29] <ghrust> 13rust/06auto 149d25099 15Tim Chevalier: std: Fix search-and-replace typos
[02:57:29] <ghrust> 13rust/06auto 145ff56ca 15Tim Chevalier: rustpkg: Extract version number from git, as per #5684...
[02:57:29] <ghrust> 13rust/06auto 1421210aa 15Tim Chevalier: rustpkg: Accept package IDs like github.com/foo/bar#0.3...
[02:57:31] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:58:06] <mflamer> aatch: I dont see any explanation of 'self in the ref manual. Do you know of a place read up on the lifetime specifiers? 
[02:58:10] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:58:32] <aatch> mflamer, uh, there is a tutorial on borrowed pointers
[02:58:47] <aatch> I'm not sure though. I don't actually read most of the documentation.
[02:59:07] <mflamer> How do you know then?
[02:59:40] <mflamer> You read the compiler source
[02:59:52] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[02:59:58] <aatch> mflamer, yep, also figuring it out from other code
[03:00:01] <aatch> all sorts of things
[03:00:26] <mflamer> fair enough...I'll keep digging
[03:05:23] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[03:07:52] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[03:08:27] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[03:10:01] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:10:20] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[03:11:00] <aatch> strcat, I looked, clang doesn't do any significant passes at -O0
[03:11:48] <SingingBoyo> Is there a page with a list of possible %[...] patterns for fmt?
[03:12:18] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[03:14:38] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:17:35] <mflamer> the "Borrowed Pointer Tutorial" explains named lifetime parameters "<'r>", but I don't see any treatment or mention of 'self. Is that just the same as any other identifier?    
[03:18:51] <strcat> mflamer: yes, but right now it's the only one that parses as a struct param
[03:18:53] <mflamer> 'r being arbitrary in the example
[03:18:53] <aatch> mflamer, sort of, except that currently you are only allowed 'self or 'static in struct and impl definitions
[03:18:58] <strcat> but in the future it will truly not be special
[03:19:29] <mflamer> ok
[03:20:06] *** Joins: deepdog (deepdog@moz-490E834C.client.mchsi.com)
[03:21:34] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[03:24:10] *** Quits: lerc (quassel@121-74-233-23.telstraclear.net) (Client exited)
[03:25:00] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:27:19] *** Quits: jgilbert (jgilbert@2557E599.66715431.D25A875A.IP) (Ping timeout)
[03:27:56] *** Joins: carter (carter@moz-12C317EF.nyc.res.rr.com)
[03:30:23] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[03:31:43] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[03:31:56] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[03:32:50] *** Quits: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP) (Quit: (quit))
[03:33:18] *** Quits: deepdog (deepdog@moz-490E834C.client.mchsi.com) (Quit: Leaving)
[03:34:49] *** Quits: SingingBoyo (brandon@moz-94AE1D3A.bchsia.telus.net) (Ping timeout)
[03:35:10] *** Quits: a_m0d (a_m0d@moz-9F925EFA.hm.shawcable.net) (Quit: Leaving.)
[03:35:26] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[03:36:34] <aatch> Hmm, step 1 in improving IR output: don't alloca a void in no-return fns
[03:36:42] <aatch> or, returns-void fns rather
[03:37:20] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[03:37:28] *** Joins: tjc (tjc@moz-B867959A.redactedconsulting.com)
[03:37:28] *** ChanServ sets mode: +o tjc
[03:38:08] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[03:38:08] *** ChanServ sets mode: +o brson
[03:40:47] <aatch> it's pretty stupid seeing "%3 = alloca {}" all over the place.
[03:41:04] * jld tries to understand why Option<UvError>::unwrap is being miscompiled in check-std and not in a simple testcase
[03:43:24] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:44:24] * jld suspects monomorphize
[03:45:26] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[03:45:26] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MfKf-Q
[03:45:26] <ghrust> 13rust/06auto 145daf964 15Patrick Walton: libsyntax: Remove `pub impl` from the language
[03:45:26] <ghrust> 13rust/06auto 1407705b2 15bors: auto merge of #6922 : pcwalton/rust/pub-impl, r=brson...
[03:45:28] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[03:45:43] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[03:47:26] *** Joins: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP)
[03:50:20] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[03:50:20] *** ChanServ sets mode: +o pcwalton
[03:51:17] *** Joins: pwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[03:51:59] *** Joins: hjr3 (hradtke@54B05067.8A23C5CC.BCAEBB33.IP)
[03:52:02] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Ping timeout)
[03:52:03] *** pwalton is now known as pcwalton
[03:52:07] *** Quits: hjr3 (hradtke@54B05067.8A23C5CC.BCAEBB33.IP) (Client exited)
[03:53:01] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[03:53:05] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Client exited)
[03:53:42] *** Quits: fizzy (Mibbit@moz-5743B4F6.rochester.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[03:54:59] <mflamer> rusti: struct Dart<'self,T> { alpha: ~[&'self Dart<T>], embed: ~[&'self T], tagged: bool }
[03:55:04] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/TYXL
[03:55:31] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[03:55:49] *** Quits: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP) (Ping timeout)
[03:55:58] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[03:56:04] *** Joins: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP)
[03:56:18] * jld suspects correctly.
[03:56:24] <jld> But... *why* is this broken.  Sigh.
[03:56:40] <mflamer> aatch: now rusti is complaining about that struct. 
[03:57:03] *** Quits: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:57:27] <aatch> struct Dart<'self,T> { alpha: ~[&'self Dart<'self, T>], embed: ~[&'self T], tagged: bool }
[03:57:32] <aatch> rusti: struct Dart<'self,T> { alpha: ~[&'self Dart<'self, T>], embed: ~[&'self T], tagged: bool }
[03:57:35] -rusti- ()
[03:57:35] <jld> Seriously, it shouldn't be getting unified with anything that isn't of alignment 4 and size 8, so...
[03:57:45] *** Joins: ssbr (ssbr@moz-F4C1E66D.dsl.bell.ca)
[03:57:55] <jld> ...wait a minute.  llalign_of_pref.  Oh dear.
[03:58:02] *** Joins: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net)
[03:58:09] <aatch> rusti: struct Dart<'self,T> { alpha: ~[&'self Dart<'self, T>], embed: ~[&'self T], tagged: bool }
[03:58:11] -rusti- ()
[03:58:16] <aatch> mflamer, ^^^
[03:58:30] *** Joins: lerc (quassel@moz-598ED764.telstraclear.net)
[03:58:37] *** Joins: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp)
[03:58:46] <jld> (Yay, rubber-duck / talk-to-the-bear debugging over IRC.)
[03:58:55] <mflamer> aatch: make sense
[03:59:06] <mflamer> makes sense, thanks
[03:59:27] <aatch> the lifetime is a parameter, so you still need to supply it.
[04:00:01] <aatch> the same as a a type param
[04:06:10] *** Quits: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP) (Quit: Leaving.)
[04:07:34] <aatch> Sigh, is there a bug related cross-crate region pointers?
[04:09:31] <brson> strcat: is playpen suitable for a browser sandbox?
[04:09:34] <aatch> nvm, it's just rustc being wierd again...
[04:10:27] <jld> rust: ~"Type rt::uv::UvError size 64 align 8 mode ByRef(RevokeClean) class MonoBits"
[04:11:40] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Quit: tikue)
[04:12:50] <strcat> brson: not really, it's more just for a standalone application
[04:13:19] <strcat> brson: chromium uses seccomp in their linux sandbox, but playpen uses more than just a syscall whitelist
[04:13:31] <strcat> it actually needs to start as root or be setuid so it can chroot
[04:14:06] <strcat> brson: if rust had a way to start up a task as a process we could use seccomp though
[04:14:13] <strcat> kind of pointless with shared memory
[04:15:08] <strcat> brson: seccomp is syscall whitelisting, but playpen has cgroups (needs root) for resource limiting + reliable killing and the chroot + namespaces for isolation
[04:16:13] <strcat> although, maybe stopping a DoS after remote code execution is a good secondary goal for a sandbox ;p
[04:16:30] <brson> strcat: all those things sound fantastic
[04:17:15] *** Parts: orshem (orshem@19491716.F0FDCE77.E3D28531.IP) (WeeChat 0.4.0)
[04:17:23] <strcat> brson: I think at a minimum a browser sandbox would want seccomp + namespaces, which you can do without root
[04:17:39] <strcat> namespaces are pretty cool, hide all the mount points, other processes, network, etc. from it
[04:17:45] <strcat> even if it's allowed socket/connect syscalls
[04:18:11] <brson> that is totally cool
[04:18:19] <strcat> if you've used iptables, seccomp is the same thing for syscalls instead of packets
[04:18:26] <strcat> it uses the berkeley packet filter compiler stuff
[04:18:37] <sp3d> wow, that's cool
[04:18:40] <brson> this is seccomp-bpf then?
[04:18:43] <strcat> can do int compares on any params
[04:18:57] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[04:18:59] <strcat> brson: well the kernel part is called seccomp2 (uses bpf) and there's libseccomp as a wrapper
[04:19:05] <strcat> sadly libseccomp uses varargs heavily
[04:19:21] <strcat> I was originally going to do playpen in rust but... it's a lot of pain to deal with that stuff
[04:19:45] <strcat> if you don't use libseccomp you have to use the BPF compiler stuff yourself
[04:20:01] *** Joins: Lal`C (NEAT@moz-C616DA0A.hsd1.ca.comcast.net)
[04:20:04] <strcat> essentially build a ruleset, load into kernel to apply it
[04:20:22] <brson> strcat: how can processes communicate with others inside a playpen?
[04:20:36] <strcat> brson: you can give them pipes
[04:20:48] <strcat> brson: well, I think I currently close stdin
[04:20:55] <strcat> but it could be set up to give them pipes
[04:21:06] <brson> strcat: or unix domain sockets?
[04:21:11] <strcat> brson: yeah
[04:21:19] <strcat> brson: it's best if you hand them the socket/pipe file descriptor
[04:21:25] <strcat> because then they don't need 'open' whitelisted
[04:21:40] <strcat> except you also have to ideally statically link them because the linker wants a dozen syscalls
[04:22:03] <strcat> brson: anyway the reason playpen isn't useful for a browser sandbox is because it uses a chroot, so it needs a whole linux root
[04:22:27] <strcat> so it's fairly specialized to running some application 
[04:22:30] <brson> strcat: can it drop root during startup?
[04:22:38] <strcat> brson: yeah, it setuids
[04:22:40] <strcat> to non-root
[04:22:48] <strcat> before it loads the seccomp ruleset
[04:22:51] <brson> i still want it
[04:22:55] <strcat> after that it can't do anything but execve by default
[04:22:57] <brson> firefox os is root
[04:23:02] <brson> or could be
[04:23:14] * brson has no idea how b2g works
[04:23:39] <strcat> brson: seccomp2 was made by google specifically for chromium's sandbox so it's really good for that use case
[04:23:44] <brson> what's the consequence of not having the chroot?
[04:23:51] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[04:23:56] <strcat> brson: not much, if you don't whitelist syscalls for touching the fs
[04:24:03] <strcat> brson: for playpen is meant for things like rustc that do
[04:24:07] <strcat> but playpen*
[04:24:43] <strcat> brson: namespaces let you isolate it from pids, network, etc. but if it can read the fs it can look in /proc, /dev/ and /sys among other places
[04:25:04] <strcat> namespaces basically exist for lxc/openvz - "virtualization" with a single kernel
[04:25:28] <strcat> they traditionally don't bother with seccomp because they are running a web server or a whole OS
[04:25:41] <strcat> (minus the kernel)
[04:25:55] <strcat> so yeah, namespaces are chroot2
[04:26:08] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke. It's all a joke.)
[04:26:17] <strcat> you might as well use them in a non-chroot sandbox but... it's not that great without it
[04:27:25] <strcat> brson: cgroups are pretty neat too. you put a process in a cgroup and anything it spawns is in the cgroup
[04:27:29] <strcat> without root at least, it can't escape
[04:27:43] <strcat> can limit memory, cpu, io, devices it's allowed to access
[04:28:06] <strcat> that's also what I suggested to graydon for tracking rustc memory usage, and it seems to work well for that
[04:28:20] <strcat> it accounts for *everything* used by the process, can even account for kernel resources
[04:28:42] * strcat likes this stuff ;p
[04:28:53] <brson> strcat: can that accounting be integrated into the runtime?
[04:29:43] <strcat> brson: probably, but it uses processes so we'd probably need that first
[04:29:50] <strcat> brson: unless you wanted to limit a whole rust program
[04:30:11] <brson> i see
[04:30:22] <strcat> it needs root though, at least with the fedora and arch linux defaults
[04:30:31] <strcat> so you can have a shim that then setuids back to a regular user
[04:30:35] *** Quits: aruniiird (arun@moz-3DB73AA5.azulsystems.com) (Ping timeout)
[04:30:43] <strcat> but... usually you want some root process supervising
[04:30:57] <strcat> playpen runs as root and supervises the sandboxed child process (non-root) basically
[04:31:38] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[04:32:10] <strcat> brson: https://github.com/mozilla/rust/issues/6897#issuecomment-18801210 I made a mini howto there ;p
[04:32:11] <strcat> for cgroups
[04:32:14] *** Quits: wizeman (quassel@moz-9C343656.dyn.user.ono.com) (Connection reset by peer)
[04:32:48] *** Joins: wizeman (quassel@moz-9C343656.dyn.user.ono.com)
[04:32:52] <strcat> essentially just like /proc in that it's a bunch of files you read/write to
[04:33:17] <strcat> seccomp piggyback's on the stuff they had for iptables, namespaces are just flags for the clone syscall
[04:33:31] <strcat> I guess they don't like the idea of adding syscalls related to security features :)
[04:34:36] <strcat> brson: anyway it's fairly new stuff. seccomp was made for chromium, cgroups were never really used before systemd, namespaces are just coming together recently for lxc
[04:34:55] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[04:35:31] <strcat> all linux-specific ;p
[04:35:39] *** Quits: SimonSapin (simon@moz-C286AD9A.bitcat.net) (Quit: Leaving.)
[04:35:45] <strcat> I think bsd jails might be namespace-ish
[04:38:27] *** Joins: doomlord (doomlod@moz-3CF8202D.range81-159.btcentralplus.com)
[04:38:56] <jld> rusti: #[deriving(Eq)]struct A(u32, u32);#[deriving(Eq)]struct B(u64);static Ca:Option<A>=Some(A(13,104));static Cb:Option<B>=Some(B(31337));assert_eq!(Ca.unwrap(),A(13,104));assert_eq!(Cb.unwrap(), B(31337));
[04:38:58] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/dhMT
[04:39:01] *** Quits: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[04:39:10] <jld> SYNTAX.
[04:39:25] <jld> rusti: #[deriving(Eq)]struct A(u32, u32);#[deriving(Eq)]struct B(u64);static Ca:Option<A> =Some(A(13,104));static Cb:Option<B> =Some(B(31337));assert_eq!(Ca.unwrap(),A(13,104));assert_eq!(Cb.unwrap(), B(31337));
[04:39:27] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/FaME
[04:40:49] <jld> rusti: struct A(u32, u32);struct B(u64);static Ca:Option<A> =Some(A(13,104));static Cb:Option<B> =Some(B(31337));(Ca.unwrap(),Cb.unwrap())
[04:40:50] -rusti- ({__field__: 13, __field__: 104}, {__field__: 31337})
[04:41:09] <strcat> brson: I guess a chroot could just be a bunch of hard links anyway, if the fs was read-only (like playpen does)
[04:41:34] <jld> That... is supposed to break.
[04:42:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[04:42:15] <strcat> I don't even see docs for MS_REC/MS_SLAVE... I just stole that from systemd
[04:42:17] <aatch> jld, why?
[04:43:25] <aatch> rusti: struct A(u32, u32);struct B(u64);static Ca:Option<A> =Some(A(13,104));static Cb:Option<B> =Some(B(31337));(Ca.unwrap(),Cb.unwrap(),Ca.unwrap())
[04:43:26] -rusti- ({__field__: 13, __field__: 104}, {__field__: 31337}, {__field__: 13, __field__: 104})
[04:43:28] <jld> aatch: Because monomorphize::make_mono_id is using machine::llalign_of_pref to decide what types are equivalent up to observability by polomorphic code.
[04:43:38] <jld> Oh, wait.
[04:43:43] <jld> This isn't my Option.
[04:43:50] <aatch> -.-
[04:44:54] <jld> brb, constructing a more portable testcase. >_>
[04:44:58] *** Joins: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com)
[04:45:22] <jld> (I mean, it's ::std::option::Option, but my rustc uses an i8 discriminant instead of int.)
[04:45:43] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Ping timeout)
[04:47:32] <strcat> brson: btw there are also "capabilities" (man capabilities) which are intended to eventually make it possible to have a root uid/gid process without much superuser access (mostly in a chroot)
[04:47:50] <strcat> and CLONE_NEWUSER (uids in the namespace don't match ones outside)
[04:47:54] <strcat> but... neither is finished enough
[04:48:13] *** Joins: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP)
[04:48:21] <strcat> and you might as well just setuid if it's not an OS
[04:49:23] *** Quits: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com) (Connection reset by peer)
[04:49:36] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[04:50:30] * strcat thinks the only real use case for capabitilities right now is getting rid of all setuid binaries like Xorg and ping
[04:50:40] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Ping timeout)
[04:50:49] <jld> rusti: struct S<T>{i:u8,t:T} impl<T> S<T>{fn unwrap(self)->T{self.t}} struct A((u32, u32)); struct B(u64); static Ca: S<A> = S{i:0,t:A((13, 104))}; static Cb: S<B> = S{i:0,t:B(31337)}; (Ca.unwrap(), Cb.unwrap())
[04:50:50] -rusti- ({__field__: (13, 104)}, {__field__: 134591390154752})
[04:51:03] <jld> rusti: struct S<T>{i:u8,t:T} impl<T> S<T>{fn unwrap(self)->T{self.t}} struct A((u32, u32)); struct B(u64); static Ca: S<A> = S{i:0,t:A((13, 104))}; static Cb: S<B> = S{i:0,t:B(31337)}; Cb.unwrap()
[04:51:04] -rusti- {__field__: 31337}
[04:58:58] <jld> struct S<T>{i:u8,t:T} impl<T> S<T>{fn unwrap(self)->T{self.t}} struct A((u32, u32)); struct B(u64); static Ca: S<A> = S{i:0,t:A((13, 104))}; static Cb: S<B> = S{i:0,t:B(31337)}; (Cb.unwrap(), Ca.unwrap())
[04:59:07] <jld> rusti: struct S<T>{i:u8,t:T} impl<T> S<T>{fn unwrap(self)->T{self.t}} struct A((u32, u32)); struct B(u64); static Ca: S<A> = S{i:0,t:A((13, 104))}; static Cb: S<B> = S{i:0,t:B(31337)}; (Cb.unwrap(), Ca.unwrap())
[04:59:08] -rusti- ({__field__: 31337}, {__field__: (104, 0)})
[05:06:15] *** Quits: tjc (tjc@moz-B867959A.redactedconsulting.com) (Quit: Places to go, people to annoy)
[05:09:26] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:09:36] *** Quits: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp) (Client exited)
[05:10:03] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[05:11:37] *** Joins: aruniiird (arun@92D70115.B332A52C.E3D0A897.IP)
[05:11:44] *** Joins: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP)
[05:13:05] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[05:13:30] <sanxiyn> Rust does not have function overloading, does it?
[05:14:31] <strcat> sanxiyn: not really, at least not beyond what static methods in traits can do
[05:15:48] <sanxiyn> strcat: What is that?
[05:15:57] *** Quits: hansjorg (hansjorg@moz-1D800A00.dsl.no.powertech.net) (Quit: Leaving.)
[05:16:20] *** Joins: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net)
[05:17:41] <strcat> sanxiyn: well for example you could have 'trait Cast<U> { fn cast(self) -> U }' and impl it from any type to any type
[05:18:11] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[05:18:23] <strcat> sanxiyn: could have a bunch of type parameters on the trait or on methods so... it's not far from overloading, as long as they all have a signature you can describe in the same way (same # of args, same self parameter, at least)
[05:18:36] <infynyxx> http://static.rust-lang.org/dist/rust-0.6.tar.gz seems to be down :|
[05:18:53] <strcat> infynyxx: seems to work here
[05:19:10] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[05:19:12] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[05:19:32] <sanxiyn> strcat: Eh... so something like this?
[05:19:32] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[05:19:34] <aatch> I can't get to it either though...
[05:19:58] <sanxiyn> fn f<CA: Cast<A>, CB: Cast<B>>(a: CA, b: CB) { ... }
[05:20:14] <infynyxx> strcat: curl: (6) Could not resolve host: static.rust-lang.org; nodename nor servname provided, or not known (from NYC) and same from NJ Linode datacenter
[05:20:29] <sanxiyn> Can you resolve other hostnames?
[05:21:02] <strcat> infynyxx: 204.246.162.225
[05:21:13] <strcat> well
[05:21:20] <strcat> you'd need to set the Host header
[05:21:25] <strcat> since it's aws
[05:21:34] *** Joins: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr)
[05:21:39] <infynyxx> I am trying to install from brew
[05:21:41] <sanxiyn> strcat: And use a.cast(), b.cast(), etc.
[05:21:42] *** Joins: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com)
[05:21:50] <infynyxx> brew install rust
[05:21:50] <infynyxx> ==> Downloading http://static.rust-lang.org/dist/rust-0.6.tar.gz
[05:21:50] <infynyxx> curl: (6) Could not resolve host: static.rust-lang.org; nodename nor servname provided, or not known
[05:21:51] <infynyxx> Error: Download failed: http://static.rust-lang.org/dist/rust-0.6.tar.gz
[05:22:03] <infynyxx> seems to be happening only that host
[05:22:44] <infynyxx> works with rust-lang.org
[05:22:44] <infynyxx> https://gist.github.com/anonymous/e26e7a969dea0961ed4a
[05:23:52] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[05:24:03] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[05:26:01] <sanxiyn> AWS trouble?
[05:26:21] <sanxiyn> It works for me, but apparently it does not work for at least 2 people (infynyxx, aatch)
[05:26:35] <infynyxx> yeah; may be just east coast :)
[05:26:55] <aatch> Well I'm in NZ...
[05:27:01] <infynyxx> ah
[05:27:31] <sanxiyn> Does this work?
[05:27:35] <sanxiyn> $ curl -H 'Host: static.rust-lang.org' -I http://204.246.162.224/dist/rust-0.6.tar.gz
[05:27:37] <strcat> infynyxx: I'm in toronto, but maybe it's serving me from us-west
[05:27:47] <strcat> that's what it seems to resolve to
[05:27:57] <infynyxx> that seems to be working
[05:28:02] <infynyxx> interestingly
[05:28:59] <sanxiyn> Hm, omitting Host header results in 301 without Location header
[05:29:06] <sanxiyn> (Isn't that illegal in HTTP?)
[05:29:14] <strcat> sanxiyn: in http 1.1 you can't omit it
[05:29:16] <strcat> you can in 1.0
[05:29:24] <strcat> so servers are probably lenient
[05:29:35] <sanxiyn> Eh, what does it mean in 1.0?
[05:29:51] <strcat> sanxiyn: afaik it means the same thing, you are just allowed to omit it
[05:30:00] <mcpherrin> sanxiyn: In 1.0, you usually only had one domain per IP
[05:30:09] <mcpherrin> So the Host header wasn't needed
[05:30:17] <sanxiyn> No, I don't mean request, but 301 response without Location header
[05:30:26] <strcat> sanxiyn: oh, dunno
[05:30:36] <sanxiyn> Moved Permanently, to where? ...
[05:30:47] <strcat> I guess it means they don't say where :)
[05:31:03] <aatch> "The princess is in another castle"
[05:31:25] *** Joins: SimonSapin (simon@moz-C286AD9A.bitcat.net)
[05:31:28] <mcpherrin> sanxiyn: Yeah, that doesn't really make sense, but you *can* return content along with a 301, so I guess you just render it and be crabby about it
[05:31:38] *** kimundi is now known as zz_kimundi
[05:31:49] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Connection reset by peer)
[05:31:52] <rpearl> 301 says "he new permanent URI SHOULD be given by the Location field in the response. "
[05:31:56] <rpearl> *the
[05:32:09] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[05:32:34] <rpearl> which means "there may exist valid reasons to ignore that particular item"
[05:32:51] <rpearl> such as many domains on one IP, and not giving a host header :P
[05:33:08] <sanxiyn> ok
[05:34:03] *** Quits: carter (carter@moz-12C317EF.nyc.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[05:34:12] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: .)
[05:35:34] <doomlord> ^ question above about function overloading... if i've understood correctly, through traits you can effectively overload on one parameter, but also write generically for all the others
[05:36:01] <sanxiyn> doomlord: ?
[05:36:26] <doomlord> oh not in context sorry . above as in scrolling far up
[05:37:59] <sanxiyn> doomlord: No, it's not that far away. What do you mean by "generically for all the others"?
[05:38:12] <doomlord> i sort of found macros can handle some of the  c++ overloading uses, eg variable numbers of parameters with different meaning
[05:38:12] *** Joins: hansjorg (hansjorg@moz-EECB5F79.static.cust.telenor.com)
[05:38:49] <doomlord> ^"generically" .. one can write generic code 'for the other parameters' as opposed to overloaded... but again, generic code handles some of the cases of overloading
[05:38:50] <sanxiyn> Yes that's one reason why fmt! is a macro, I think
[05:38:55] <sanxiyn> (variable number of arguments)
[05:39:25] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Quit: Lost terminal)
[05:39:30] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Client exited)
[05:40:54] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:41:30] <doomlord> one case where 2 params were needed..
[05:42:13] <doomlord> something like this - render(drawable, object) ... render(bitmap, square) render(vectorart, circle)  render(bitmap, circle) etc...
[05:42:13] <illissius> has variadic templates, or rather the problem it solves, ever been discussed? leaves a hole how you can't properly abstract over tuples nor functions
[05:42:15] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[05:42:27] <doomlord> i was trying to figure out how you'd express that best in rust
[05:43:22] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[05:43:25] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[05:43:47] *** Quits: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com) (Quit: brendan)
[05:44:51] *** Quits: aruniiird (arun@92D70115.B332A52C.E3D0A897.IP) (Ping timeout)
[05:45:16] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:45:17] <illissius> doomlord: how many `impl`s were you figuring to have? per drawable? per object? per drawable + object? per drawable * object?
[05:45:57] <doomlord> one impl per pair , but potentially arbitrary extention of drawables and objects
[05:46:39] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Quit: tikue)
[05:47:00] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[05:47:30] <doomlord> eg if you have drawables: BitmapImage   VectorDiagram ; and objects: square,circle,  polygon - thats 6 functions to implement
[05:47:57] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Connection reset by peer)
[05:48:09] <bjz> is there a #[deprecated] attribute yet?
[05:48:10] <illissius> sounds kinda similar to the diagrams package for haskell, but can't remember off the top of my head how they do it. (not sure if they have n*m instances either)
[05:48:19] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[05:48:39] <brson> bjz: no. there's an issue open
[05:49:01] <sanxiyn> #723
[05:49:04] <doomlord> is an arbitrary example - for 'diagrams' - i imagine they'd have a drawable that supports primitives - lines - then the other shapes are built in terms of lines
[05:49:19] <bjz> brson: it would be nice to deprecate most of the free-standing functions in str and vec
[05:49:20] <illissius> yeah, probably something like that
[05:49:29] <bjz> brson: people keep using them
[05:49:50] <bjz> brson: it would also make it easier to clean things up
[05:49:51] <sanxiyn> bjz: Can we just remove them?
[05:50:17] <bjz> sanxiyn: I'm attempting to atm
[05:50:40] <illissius> doomlord: anyway if you want N*M instances in Haskell you'd use a plain multiparameter type class (class DrawsObject drawable object). IINM in Rust right now you can't have multiple implementations of the same trait for the same type with different type parameters on the trait, but they're planning to change that?
[05:50:49] *** Quits: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[05:50:50] <illissius> because that's what would basically be equivalent
[05:50:53] * bjz is 'methodising' thousands of lines of code
[05:51:19] <doomlord> i think what i ended up with when i tried a code-doodle for this looked a little reminiscent of 'double-dispatch', (in the way you declare the traits, which you wouldn't do in C++) , which was certainly tolerable it just took more thought than in C++
[05:51:27] <brson> bjz: fantastic!
[05:51:47] <bjz> brson: I might give up yet :P
[05:51:48] *** Joins: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr)
[05:51:59] <doomlord> illissius, ok i've encountereed multiparameter typeclasses in haskell - i'm no expert , but i've used that. interesting to hear support is planned
[05:52:43] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Ping timeout)
[05:53:14] *** Joins: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp)
[05:53:35] <bjz> brson: strcat was also talking about how we need to get vec and str under control
[05:53:37] <doomlord> i wonder what runtime polymorphic double dispatch looks like in rust aswell 
[05:53:44] <bjz> lots of uneccsary methods
[05:53:55] <bjz> (apparently)
[05:54:21] <illissius> doomlord: don't take that as completely reliable :) I just vaguely remember seeing a comment to that effect in the bug tracker or somewhere.
[05:55:26] <illissius> runtime double dispatch is probably no different from C++ (visitor pattern or some kind of dictionary-based solution)
[05:55:43] <bjz> brson: the reson why I suggest deprecation is that it's such a big job, and I'm sure I'll miss things
[05:56:14] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[05:56:39] <bjz> brson: it might be easier if we can generate lots of deprecation warnings, then whittle them down over time
[05:58:00] *** Quits: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:59:54] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[05:59:58] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[06:00:06] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[06:02:25] *** Joins: victorporof (victorporo@17229E48.8E4D8E22.4A6B528C.IP)
[06:02:43] *** Joins: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net)
[06:03:01] *** Quits: victorporof (victorporo@17229E48.8E4D8E22.4A6B528C.IP) (Connection reset by peer)
[06:04:01] *** Joins: aruniiird (arun@92D70115.B332A52C.E3D0A897.IP)
[06:04:49] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[06:05:35] *** Quits: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net) (Quit: annodomini)
[06:06:09] *** Quits: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net) (Ping timeout)
[06:06:24] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[06:07:21] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[06:08:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[06:08:18] *** Quits: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP) (Quit: Leaving)
[06:09:08] *** zz_kimundi is now known as kimundi
[06:10:43] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Quit: eatkinson)
[06:11:06] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Quit: eholk)
[06:17:02] *** Quits: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[06:18:39] *** Joins: sankha93 (Instantbir@4E59BDF6.F6D95C1.8B6C1D65.IP)
[06:19:43] <brson> bjz: that sounds like a good strategy to me
[06:19:46] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[06:19:46] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[06:20:41] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[06:21:48] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: Don't tell them I was here...)
[06:25:27] *** Quits: Voomer_ (Voomer@moz-E97E8EB7.br.br.cox.net) (Connection reset by peer)
[06:26:38] *** Joins: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net)
[06:27:34] <mflamer> what is the difference between "copy" and "clone()" 
[06:28:12] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[06:30:57] *** Quits: blitter (blitter@moz-BA14D5CF.dyn.centurytel.net) (Ping timeout)
[06:35:55] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (Quit: ZNC - http://znc.in)
[06:41:39] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Quit: leaving)
[06:42:32] <bblum> mflamer: copy is "more built-in"
[06:42:47] <bblum> it's generally for stuff involving pointers and straight-up copying data
[06:43:04] <bblum> clone is more general, sort of analogous to copy constructors in c++
[06:43:13] <bblum> eventually copy will turn into clone
[06:46:30] <mflamer> and to copy I have to implement "Copyable" trait?
[06:47:06] <mflamer> even to copy a &?
[06:47:17] *** Joins: \n (NDesaulnie@moz-C2B49FFE.hsd1.ca.comcast.net)
[06:47:41] <mflamer> let dartRef: &'self mut Dart<'self, T> = dart;   		dartRef.alpha = vec::from_elem(self.dim, copy dartRef);
[06:50:50] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: caitp)
[06:52:45] *** Quits: H4199 (chatzilla@moz-64E556D3.austin.res.rr.com) (Ping timeout)
[06:53:11] *** Quits: balpert (alpert@moz-793B8F0F.khanacademy.org) (Quit: balpert)
[06:53:14] <bblum> copy needs no trait implemented
[06:53:25] <bblum> copy works on anything without a destructor
[06:53:59] *** Joins: nano (nano@moz-972880B.superkabel.de)
[06:54:05] <bblum> you don't need to write copy at all to copy things that don't have ~ in them
[06:58:35] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[07:00:16] *** Quits: mflamer (Mibbit@moz-C6ED16AA.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:01:24] <bjz> bblum: wouldn't a better answer be, 'don't use copy if you can help it, it's deprecated)?
[07:03:28] <engla> is implicit copying also deprecated?
[07:03:37] <engla> just a confused thought
[07:04:18] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[07:04:22] <bblum> bjz: yeah
[07:10:35] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[07:17:16] *** Joins: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net)
[07:18:15] *** Quits: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp) (Client exited)
[07:25:29] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[07:25:48] *** Joins: EXetoC (ex@moz-2DBEB1E4.customer.t3.se)
[07:27:33] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[07:29:06] *** Quits: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net) (Client exited)
[07:29:12] *** Joins: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp)
[07:31:14] *** Quits: \n (NDesaulnie@moz-C2B49FFE.hsd1.ca.comcast.net) (Quit: \n)
[07:32:15] *** Quits: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp) (Client exited)
[07:33:29] *** Joins: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp)
[07:36:55] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[07:39:21] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[07:39:39] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[07:40:09] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Client exited)
[07:42:21] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Ping timeout)
[07:46:33] *** Joins: berak (chatzilla@5ACD13B8.8B38C502.16E13E53.IP)
[07:46:54] <aatch> bjz, some notes: https://github.com/bjz/rusp/issues/16
[07:47:01] *** Parts: berak (chatzilla@5ACD13B8.8B38C502.16E13E53.IP) ()
[07:49:21] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[07:49:31] <Blei> what's rusp?
[07:49:37] <Blei> oh, i see
[07:49:48] <Blei> i thought this was on the rust issue tracker and was confused
[07:50:35] *** Joins: dbaupp (Thunderbir@moz-C6B1454A.lns20.syd7.internode.on.net)
[07:50:59] <aatch> dbaupp, you may also be interested: https://github.com/bjz/rusp/issues/16
[07:51:16] * dbaupp reads
[07:51:37] <aatch> I'm heading off now, so post on the issue
[07:51:45] *** aatch is now known as aatch|gone
[07:52:00] <dbaupp> sure
[07:52:01] *** Quits: ysuzuki (ysuzuki@moz-3830D141.st.keio.ac.jp) (Client exited)
[07:59:50] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:03:13] *** Joins: fabiand (fabiand@moz-B5706E1E.adsl.alicedsl.de)
[08:06:01] *** Quits: fdr (user@B280A391.27376607.189F3E15.IP) (Ping timeout)
[08:10:04] *** Joins: martndemus (martndemus@404EBCE6.B5AF260.54C0C869.IP)
[08:10:09] *** Quits: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP) (Quit: ëžœë¤ì€ ì‡ í‡´í–ˆìŠµë‹ˆë‹¤.)
[08:16:06] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[08:17:43] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[08:26:02] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:26:03] *** Joins: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net)
[08:28:51] *** Quits: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net) (Ping timeout)
[08:29:03] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:29:15] *** Joins: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net)
[08:33:48] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:33:49] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[08:34:08] *** Joins: steveklabnik (steve@C7DA205D.DE4CB097.2E851E30.IP)
[08:35:46] *** Quits: ski (Stefan@moz-4BB5E0FF.studat.chalmers.se) (Ping timeout)
[08:36:02] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[08:36:02] *** Quits: steveklabnik (steve@C7DA205D.DE4CB097.2E851E30.IP) (Ping timeout)
[08:36:38] *** Quits: rsaarelm (rsaarelm@moz-D1CB7158.dhcp.inet.fi) (Ping timeout)
[08:39:25] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[08:40:02] *** Joins: rsaarelm (rsaarelm@moz-D1CB7158.dhcp.inet.fi)
[08:40:05] *** Joins: ski (Stefan@moz-4BB5E0FF.studat.chalmers.se)
[08:40:55] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[08:41:00] *** Joins: steveklabnik (steve@94C57CEF.B9FDC55D.89FACE96.IP)
[08:45:28] *** Quits: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net) (Quit: pragmatic)
[08:52:23] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[08:53:00] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Ping timeout)
[08:54:55] *** Joins: dbaumgarten (quassel@moz-65731869.dip0.t-ipconnect.de)
[09:06:19] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:12:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[09:12:33] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1407705b2 to 14133d451: 02http://git.io/N3iJvQ
[09:12:33] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[09:12:34] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[09:12:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/VATemA
[09:12:35] <ghrust> 13rust/06auto 140c9510a 15Jed Davis: Use ABI alignment, not "preferred" alignment, to unify monomorphizations....
[09:12:35] <ghrust> 13rust/06auto 14b500307 15bors: auto merge of #6927 : jld/rust/monomorphize-abi-alignment, r=sanxiyn
[09:12:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[09:15:12] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[09:20:45] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Quit: balpert)
[09:21:31] *** Quits: steveklabnik (steve@94C57CEF.B9FDC55D.89FACE96.IP) (Ping timeout)
[09:21:53] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[09:27:57] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Client exited)
[09:29:04] *** Joins: Amanieu (amanieu@moz-56A48CBB.its.manchester.ac.uk)
[09:34:26] *** Joins: moonchrome (moonchrome@moz-9C2622FD.dsl.iskon.hr)
[09:35:28] *** Quits: SimonSapin (simon@moz-C286AD9A.bitcat.net) (Quit: Leaving.)
[09:41:46] *** Quits: heftig (heftig@moz-A96955D1.dip0.t-ipconnect.de) (Ping timeout)
[09:46:34] *** Quits: martndemus (martndemus@404EBCE6.B5AF260.54C0C869.IP) (Input/output error)
[09:46:48] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[09:49:28] *** Joins: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP)
[09:50:13] *** Joins: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP)
[09:50:49] <oksobul> Hello. I am trying to find the semantics of "&'" and "<'".
[09:50:49] <oksobul> Concretely, what this means in treemap.rs
[09:51:22] *** Joins: mw (mw@moz-245D47DE.vrvis.at)
[09:51:39] <engla> ' is for lifetime
[09:51:56] <engla> &'r T  is a borrowed pointer to T with lifetime r
[09:54:02] <engla> it's covered in http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html
[09:54:22] <oksobul> Thank you. I tried to find it in reference manual.
[09:55:40] <Blei> yeah, lifetimes are surprisingly not documented anywhere that is reachable from the official documentation...
[09:56:48] *** Joins: sk (sk@EA324BFE.54A580E3.78DD174B.IP)
[10:03:39] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[10:03:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/VATemA
[10:03:39] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[10:05:15] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Ping timeout)
[10:05:50] *** Quits: novabyte (Instantbir@moz-B4C485A7.mullvad.net) (Quit: bye bye)
[10:05:53] *** Joins: heftig (heftig@moz-E33F9AA4.dip0.t-ipconnect.de)
[10:06:09] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[10:09:35] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[10:10:06] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[10:13:01] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[10:17:16] *** Quits: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP) (Quit: ëžœë¤ì€ ì‡ í‡´í–ˆìŠµë‹ˆë‹¤.)
[10:18:01] *** Joins: emartin (emartin@moz-C3D4EEBF.caltech.edu)
[10:21:57] *** Joins: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net)
[10:23:54] <dbaupp> Blei: there are links at the very bottom of the tutorial
[10:24:09] <dbaupp> (although it is the *very* bottom.)
[10:26:08] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[10:35:11] <bjz> nmatsakis: ping
[10:42:15] *** Quits: dbaumgarten (quassel@moz-65731869.dip0.t-ipconnect.de) (Ping timeout)
[10:43:28] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[10:43:42] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[10:44:03] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[10:45:29] *** Joins: dbaumgarten (quassel@moz-3126A5E0.dip0.t-ipconnect.de)
[10:46:59] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[10:50:40] *** kimundi is now known as zz_kimundi
[10:52:06] *** Joins: koomi (koomi@moz-7FEFD546.pools.arcor-ip.net)
[10:52:41] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Client exited)
[10:52:47] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[10:53:08] *** Joins: z0w0 (zack@moz-91043B9D.lns10.woo.bigpond.net.au)
[10:55:55] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[10:56:35] *** Joins: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de)
[10:58:15] <doomlord> oh hadnt seen '
[10:58:29] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[10:59:34] <doomlord> struct Point {x: float, y: float}
[10:59:34] <doomlord> fn get_x<'r>(p: &'r Point) -> &'r float { &p.x }
[11:00:04] <EXetoC> <3
[11:00:30] <nmatsakis> bjz: pong
[11:00:36] <doomlord> ^^ hmm,  so why is the ' needed exactly, it doesn't justpropogate the  fact its a & within a & param and subset of the outer lifetime
[11:01:29] <nmatsakis> doomlord: the 'r is a lifetime name, the leading ' indicates that it's a lifetime name and not some other kind of name
[11:01:35] <doomlord> now i'm seeing 'named lifetimes', intruiging
[11:01:56] <doomlord> ahhhh.
[11:01:57] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[11:01:57] <nmatsakis> & 'r Point means "ref to Point with lifetime 'r"
[11:02:12] <doomlord> right. so  its saying all those pointers are of the same lifetime
[11:02:18] <nmatsakis> yes
[11:02:35] <Blei> so, do static methods work on typedefs nowadays? i remember that this was buggy at some point?
[11:02:54] <bjz> no :(
[11:02:58] <doomlord> - again kind of surprised its not possible to infer those, but i'm probably missing some subtelty, or maybe it just makes the signatures clearer
[11:03:12] <Blei> awww
[11:03:31] <bjz> Blei: https://github.com/mozilla/rust/issues/6894
[11:03:53] <Blei> bjz: thanks
[11:04:00] <bjz> Blei: what do you mean when you say, "do static methods work on typedefs"?
[11:04:15] <Blei> ah, yeah, that might not be what i mean
[11:04:40] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[11:04:49] <Blei> struct Bar { .. } impl Bar { fn foo() -> int { .. } }  type MyBar = Bar; MyBar::foo()
[11:05:11] <bjz> yes, that's what that issue referrs to
[11:05:22] <Blei> ah, ok
[11:05:32] <bjz> if you have any use cases, please bring it up in that issue
[11:05:53] <bjz> It's something I'm trying to push for, but I'm having trouble articulating my point
[11:06:06] *** Joins: jensnockert (jensnocker@CEE952EC.7F474121.A94117DA.IP)
[11:06:07] <Blei> with this, it seems to work though: `pub use Path = self::WindowsPath;`
[11:06:16] <Blei> at least so far
[11:06:39] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[11:07:02] <doomlord> from the documentation.. "This will in turn lead to a compilation error, because select_based_on_unit_circle() is supposed to return a value with the lifetime r.2 " <<<< So, the pointer lifetime annotatiion in the signature provides more compile-time checks for what the function body can do without breaking ... ?
[11:07:23] <doomlord> ^^^ as the example shows trying to retrun a borrowed pointer to a local.. region names prevent that..
[11:07:32] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[11:08:33] *** Joins: pyrac (pyrac@29E99D66.73C89388.AD05C589.IP)
[11:08:39] <bjz> that's not really doing what you think it is, it's just redefining the identifier within the mod
[11:08:50] <bjz> @ Blei
[11:09:28] <Blei> is there a user-visible difference?
[11:09:56] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[11:10:03] *** Joins: H4199 (chatzilla@moz-64E556D3.austin.res.rr.com)
[11:11:35] *** Quits: jensnockert (jensnocker@CEE952EC.7F474121.A94117DA.IP) (Input/output error)
[11:12:39] <doomlord> ok in C++, you get warnings if you try to return references to local variables ...  wheras the named lifetime thing stops you doing that at all... but there are more cases where you could break thigs with referencs in c++ ?  - i think some side by side examples of c++ smartpointers/refs and rust named-lifetimes would be useful.
[11:13:02] <Blei> hmm, still doesn't work cross-crate apparently
[11:13:11] <doomlord> rust  has freezing of the original object when you borrow pointers, doesn't it..
[11:13:36] <bjz> Blei: it would help to have some examples of what you're trying to do
[11:13:52] <Blei> bjz: modernizing the constructors in libstd/path
[11:14:13] <Blei> but becaus Path is a typedef/pub use, calling ::new on it doesn't seem to work
[11:14:22] *** Joins: jensnockert (jensnocker@CEE952EC.7F474121.A94117DA.IP)
[11:14:33] <bjz> Blei: this is exactly what I'm craving, examples from other people
[11:14:39] *** Joins: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[11:14:54] <bjz> not just me going on like a broken record about lmath or std::num
[11:15:24] <Blei> haha, i see
[11:15:30] <Blei> so should i add that to the issue?
[11:16:20] <bjz> so if you could gist some examples of what kind of API you *would* like to be able to create, but can't, that would be helpful
[11:17:54] <bjz> Blei: I mean, we might still be talking about different things, but I can't tell that without examples
[11:18:31] <Blei> i see. gist incoming
[11:21:30] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[11:22:14] <Blei> https://gist.github.com/Blei/5705227
[11:23:22] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[11:27:46] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[11:31:08] *** Joins: pyrac_ (pyrac@29E99D66.73C89388.AD05C589.IP)
[11:31:09] *** Quits: pyrac (pyrac@29E99D66.73C89388.AD05C589.IP) (Connection reset by peer)
[11:31:09] *** pyrac_ is now known as pyrac
[11:38:09] <Blei> what's up with unibuffer() and packet<T>() ? this looks... interesting... for no reason i can see
[11:42:58] <emartin> i'm trying to call a function from a separate file (in the same directory) right now. What do I need to do besides declare the module in main besides 'pub mod mod_name; use mod_name;'?
[11:43:59] <emartin> getting  error: `use` and `extern mod` declarations must precede items
[11:44:19] <Blei> emartin: put them at the beginning of the file or module
[11:46:28] <emartin> Blei: I effectively have this right now: https://gist.github.com/anonymous/5705329
[11:46:33] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[11:47:03] <dbaupp> emartin: https://gist.github.com/huonw/5705332
[11:47:21] <dbaupp> it's really really confusing that `use` has to go before `mod`, but it's how it is
[11:47:38] <dbaupp> (although, in this case, you probably don't need the use)
[11:47:41] <emartin> hm, thanks a ton! that changed from version 0.5, right?
[11:47:50] <emartin> I was trying to get this working based off of some old code I wrote
[11:47:59] <dbaupp> emartin, yeah, I think so
[11:49:31] <emartin> also, does rust have any sort of assertions now? there used to be fail_unless!, looks like that got removed
[11:49:46] <dbaupp> it's now back to `assert!`
[11:50:04] <dbaupp> (the fail_unless was temporary until the 'assert' keyword was removed in favour of the macro)
[11:50:18] <emartin> thanks
[11:51:02] <dbaupp> rusti: let a = 2; assert!(a == 1, "`a` did not equal %d", 1)
[11:51:04] -rusti- rust: task failed at '`a` did not equal 1', foo.rs:9
[11:51:04] -rusti- rust: domain main @0x6c81b0 root task failed
[11:51:04] -rusti- application terminated with error code 101
[11:51:24] <dbaupp> emartin, you can even give error messages like that ^
[11:55:01] <Blei> rusti: let a = 2; assert_eq!(1, a)
[11:55:03] -rusti- rust: task failed at 'left: 1 does not equal right: 2', foo.rs:9
[11:55:03] -rusti- rust: domain main @0x21561b0 root task failed
[11:55:03] -rusti- application terminated with error code 101
[12:01:41] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[12:02:37] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[12:02:57] <emartin> dbaupp: now I'm getting reed_solomon.rc:1:4: 1:17 error: unresolved import (maybe you meant `field_elemen::*`?)
[12:02:59] <emartin> reed_solomon.rc:1 use field_element;
[12:03:12] <emartin> where reed_solomon.rc is main, field_element is other
[12:03:44] <dbaupp> you don't need the use, if you've imported it via mod
[12:04:06] <dbaupp> (the 'field_element' name is already in scope)
[12:04:28] <emartin> ah, got it. 'use' is only used to access things within a module, not the module itself
[12:04:49] <dbaupp> emartin, yes and to access other crates
[12:05:34] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[12:07:03] <emartin> is this https://github.com/mozilla/rust/wiki/Note-operator-overloading actually in trunk? Looking at the online trunk docs, I don't see any std::ops module
[12:07:31] <dbaupp> emartin: yes, in incoming, core has been renamed to std, and std to extra
[12:07:39] <dbaupp> the docs aren't up to date
[12:07:50] *** Quits: Blub\w (wry@moz-A3283263.wireless.dyn.drei.com) (Ping timeout)
[12:08:33] <dbaupp> (btw, development happens on 'incoming' not 'master', which only gets updated very occasionally)
[12:11:14] *** zz_kimundi is now known as kimundi
[12:13:17] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[12:13:37] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[12:15:43] <emartin> does rust have a method that is the equivalent of ruby's "n.times"?
[12:15:59] <emartin> currently just using range, but then I get an unused variable warning
[12:16:19] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[12:17:20] <dbaupp> rusti: for 3.times { println("emartin: yes") }
[12:17:21] -rusti- emartin: yes
[12:17:21] -rusti- emartin: yes
[12:17:22] -rusti- emartin: yes
[12:17:22] -rusti- ()
[12:18:17] <dbaupp> you can also silence those warnings with an underscore: a variable with a leading _ is "allowed" to be unused, and calling a variable `_` means that it is entirely ignored
[12:18:31] <dbaupp> (it's the same as _ in Haskell)
[12:19:17] <emartin> is this just another case of the docs not being complete? I looked on int for a times method, docs didn't mention it
[12:19:49] *** Quits: jensnockert (jensnocker@CEE952EC.7F474121.A94117DA.IP) (Input/output error)
[12:19:56] <dbaupp> it's on uint, I think
[12:19:56] <bstrie> emartin: it exists on uints only, not ints
[12:20:06] <bstrie> -5.times will not work, sadly :)
[12:20:22] <bstrie> well actually it might work, our overflow rules are dumb right now
[12:20:26] *** Quits: mleise (marco@moz-3468AB5B.pools.arcor-ip.net) (Quit: Leaving.)
[12:20:30] <emartin> not on uint either
[12:20:38] <bstrie> rusti: -254u8
[12:20:39] -rusti- 2
[12:20:54] <bstrie> rusti: for -254u8.times { println("hello") }
[12:20:55] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[12:20:55] -rusti- foo.rs:10:20: 10:25 error: `for` must be followed by a block call
[12:20:55] -rusti- foo.rs:10          for -254u8.times { println("hello") }
[12:20:55] -rusti-                               ^~~~~
[12:20:55] -rusti- application terminated with error code 101
[12:21:06] <bstrie> rusti: for (-254u8).times { println("hello") }
[12:21:07] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/AaIQ
[12:21:24] <dbaupp> emartin: you're right to be confused
[12:21:30] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[12:21:34] <dbaupp> it's in the 'inst' submodule of uint
[12:21:35] <dbaupp> http://static.rust-lang.org/doc/core/uint_inst.html#implementation-of-itertimes-for-uint
[12:21:39] <bstrie> what
[12:21:41] <dbaupp> (and it's a method of a trait)
[12:21:41] <bstrie> why
[12:21:53] <dbaupp> http://static.rust-lang.org/doc/core/iter.html#trait-times
[12:22:03] <dbaupp> bstrie: it's an implementation detail leaking out
[12:22:22] <bstrie> rusti: 8u.bytes()
[12:22:23] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QHiX
[12:22:36] <bstrie> is "inst" where all the methods are supposed to live?
[12:22:43] <dbaupp> bstrie: nope
[12:22:58] <dbaupp> bstrie: the uint/u8/u16, modules are all done by a single macro
[12:23:11] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[12:23:17] <dbaupp> and so the non-shared behaviour is implemented in a submodule
[12:24:05] <dbaupp> includes things like the number of bits, the name of the type and the corresponding signed type.
[12:24:16] <dbaupp> (and the Times impl)
[12:24:43] *** Joins: Blub\w (wry@moz-A3283263.wireless.dyn.drei.com)
[12:24:55] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[12:25:17] <bstrie> rusti: for 2u8.times { println("hello") }
[12:25:18] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/bgeH
[12:25:23] <bstrie> so wait wait wait
[12:25:33] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[12:25:33] <bstrie> times is *only* on uint? not u8 and friends?
[12:25:42] *** Parts: mw (mw@moz-245D47DE.vrvis.at) ()
[12:27:24] <dbaupp> yeah
[12:27:34] <dbaupp> otherwise the type inference explodes
[12:28:12] <bstrie> I thought it was only exploding when it was on signed types
[12:28:44] <bstrie> I knew we were restricting it to unsigned, but not only to "machine-sized unsigned"
[12:29:10] <dbaupp> I think it's because a literal can be any of the integer types, and so if more than one implements the method it complains about "multiple applicable methods in scope"
[12:29:34] <bstrie> I think it was a different error
[12:29:44] <dbaupp> rusti: trait Foo { fn foo(&self); } impl Foo for uint { fn foo(&self) {} } impl Foo for u8 { fn foo(&self) {} } 1.foo()
[12:29:45] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/BfMM
[12:29:46] <bstrie> unless things have changed since then
[12:30:02] <bstrie> ugh, perhaps not
[12:30:36] <dbaupp> it'll still work if you impl it for other types
[12:30:58] <dbaupp> just, not on unsuffixed literals if you impl it on the builtins
[12:31:05] <dbaupp> (on more than one of them)
[12:33:09] *** Joins: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net)
[12:35:13] <bstrie> so what you're saying is that we can't define *any* built-in trait for more than one numeric type
[12:35:25] <bstrie> ever
[12:35:29] <dbaupp> not if we want type inference to not explode
[12:35:42] *** Joins: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se)
[12:35:49] <bstrie> we just need type inference to be smarter :)
[12:35:55] <dbaupp> I would like these to default to [u]int if it impls the trait
[12:36:00] <bjz> rusti: 0.3.sin()
[12:36:02] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/LFeS
[12:36:05] <dbaupp> (even if other ints do too)
[12:36:06] <bjz> -_-
[12:36:10] <dbaupp> and the same with floats
[12:36:20] <dbaupp> bjz: it's so much fun, right? :(
[12:36:26] <bjz> 0.3.pow(2.0)
[12:36:37] <bjz> rusti: 0.3.pow(2.0)
[12:36:38] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dYZQ
[12:36:58] <bstrie> perhaps we could make an attribute that tells the type inference engine "don't infer the type from this method"
[12:37:13] <dbaupp> bstrie: what do you mean?
[12:38:03] <bstrie> dbaupp: well from what I can see it's falling down because it's trying to dispatch to a certain method but unsure of what the type actually is
[12:38:19] <bstrie> and usually it infers the type from usage
[12:38:35] <dbaupp> rusti: 0.3.pow(2.0) + 1.0f
[12:38:37] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/eOVD
[12:38:46] <bjz> bstrie: you know the insane thing?
[12:38:46] <bstrie> if there was a way to defer the dispatch until *after* the type had been inferred from usage elsewhere, then maybe it would work
[12:38:49] <bjz> rusti: fn sqrt<T:Float>(x: T) -> T { x.sqrt() } sqrt(2.0)
[12:38:50] -rusti- 1.41421356
[12:38:51] <dbaupp> rusti: 1.0f + 0.3.pow(2.0)
[12:38:53] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/SJTI
[12:39:01] <bjz> 2.0.sqrt()
[12:39:11] <bjz> rusti: fn sqrt<T:Float>(x: T) -> T { x.sqrt() } sqrt(2.0);
[12:39:13] -rusti- ()
[12:39:13] <dbaupp> rusti: 1.0f64 + 0.3.pow(2.0)
[12:39:14] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/CRHd
[12:39:24] <dbaupp> bstrie: yes
[12:39:36] <dbaupp> bstrie: that seems reasonable
[12:39:54] <bstrie> but really I have no idea if the compiler works in a way that makes this possible
[12:40:03] <dbaupp> bstrie: but I have a feeling that the dispatch does happen after the inference
[12:40:12] <dbaupp> although I don't actually know
[12:40:30] <bjz> rusti: num::Zero::zero() + 1.0
[12:40:32] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dAHT
[12:40:39] <bjz> rusti: 1.0 + num::Zero::zero()
[12:40:40] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/cdjX
[12:40:49] <bjz> rusti: num::Zero::zero() + 1f
[12:40:49] <dbaupp> rusti: 1.0 + std::num::Zero::zero()
[12:40:51] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/fJOa
[12:40:51] -rusti- 1
[12:40:57] <kimundi> Hm, I'm trying to add 'pub use iterator::{Iterator, IteratorUtil};
[12:40:57] <kimundi> ' to the prelude but get compile errors that way. Does anyone know why?
[12:41:01] <dbaupp> rusti: std::num::Zero::zero() +  1.0
[12:41:03] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/GGKX
[12:41:07] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[12:41:19] <dbaupp> kimundi: I'd guess it's because there's `use prelude::*` in the top of iterator.rs
[12:41:21] <bjz> rusti: std::num::Zero::zero() + 1f
[12:41:23] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/FVVg
[12:41:31] <dbaupp> (I don't actually know if it's there...)
[12:41:38] <bjz> rusti: 0.0 == std::num::Zero::zero()
[12:41:39] -rusti- true
[12:41:50] <bjz> rusti: std::num::Zero::zero() == 0.0
[12:41:51] <dbaupp> kimundi: but mutual imports like that seem to make rust explode in a non-obvious way
[12:41:51] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HTGf
[12:41:52] <kimundi> oh, hm...
[12:42:02] <kimundi> That might be it... testing
[12:42:17] *** Quits: sankha93 (Instantbir@4E59BDF6.F6D95C1.8B6C1D65.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[12:42:26] <dbaupp> bjz: I really hate that asymmetry too
[12:42:39] <bjz> dbaupp: we need an issue
[12:42:40] <dbaupp> (assuming that's what you're demonstrating)
[12:42:47] <bjz> aye
[12:42:48] <bstrie> this is so bad that I'm wondering if numeric literal inference is worth it :P
[12:42:53] <dbaupp> it really is
[12:43:07] <dbaupp> having to write 1u *all* the type is horrible
[12:43:18] <bjz> let x: c_int = 1f32?
[12:43:39] <dbaupp> *time
[12:43:39] <dbaupp> heh
[12:46:15] *** Quits: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net) (Quit: annodomini)
[12:46:56] <bstrie> rusti: 1.0f64.pow(2.0)
[12:46:58] -rusti- 1
[12:48:26] <bstrie> rusti: 1.0f.pow(2.0)
[12:48:28] -rusti- 1
[12:48:31] <bstrie> rusti: 1.0.pow(2.0)
[12:48:33] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/LPaF
[12:48:53] <bstrie> I guess this is tolerable
[12:49:54] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[12:52:09] <emartin> is there a way for me to declare a type that will explicitly be a vector of exactly n elements?
[12:52:37] <emartin> of type T?
[12:52:54] <bstrie> emartin: [T, ..n] is a fixed-length vector
[12:53:21] <dbaupp> a compile-time fixed vector
[12:53:31] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[12:54:03] <emartin> thank you! I'm trying to implement reed-solomon error correcting coding for a class. used Rust a few months ago to write an othello AI, trying to stay fresh with the language
[12:54:35] <bstrie> cool
[12:55:22] *** Quits: Amanieu (amanieu@moz-56A48CBB.its.manchester.ac.uk) (Ping timeout)
[12:55:27] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:55:31] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Connection reset by peer)
[12:55:32] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:59:31] *** Joins: js (jeremie@moz-DCCE2247.rsr.lip6.fr)
[12:59:40] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[13:03:29] <kimundi> dbaupp: Reomving the prelude import fixed it btw
[13:04:02] <dbaupp> kimundi: yay! (I've met this problem before, and it took me hours to work out why it failed :( )
[13:04:08] <kimundi> But now I have the problem that I can't put Iterator in it because Iterator::take and Cell::take conflict...
[13:04:55] <bstrie> remove cell :P
[13:05:06] *** Quits: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se) (Input/output error)
[13:06:38] *** Joins: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net)
[13:07:26] *** Quits: moonchrome (moonchrome@moz-9C2622FD.dsl.iskon.hr) (Ping timeout)
[13:11:02] *** Quits: z0w0 (zack@moz-91043B9D.lns10.woo.bigpond.net.au) (Client exited)
[13:12:05] *** Quits: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Ping timeout)
[13:13:10] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[13:13:35] <emartin> is it possible to define a tuple struct that is a list? ie pub struct Polynomial<T> [T, ..DEGREE]; (where DEGREE is statically defined above)
[13:14:05] <emartin> this is not working right now (refuses to define struct), wondering if there is another way to do this
[13:15:44] <dbaupp> pub struct Polynomial<T>([T, ..DEGREE]);
[13:16:15] <emartin> is that just the same thing without the syntactic sugar for 1 element tuple structs?
[13:16:31] <dbaupp> what do you mean?
[13:17:05] <dbaupp> rusti: pub struct Polynomial<T>([T, ..2]); Polynomial([1i, 2])
[13:17:06] -rusti- {__field__: [1, 2]}
[13:18:11] *** Joins: SirSkidmore (taylor@A8CF1C90.14855463.8C3A19BB.IP)
[13:18:12] <kimundi> rusti: pub struct Polynomial<T>([T, ..2]); *Polynomial([1i, 2])
[13:18:14] -rusti- [1, 2]
[13:18:50] <dbaupp> rusti: pub struct Polynomial int; Polynomial(1)
[13:18:50] -rusti- foo.rs:10:31: 10:34 error: expected `{`, `(`, or `;` after struct name but found `int`
[13:18:50] -rusti- foo.rs:10          pub struct Polynomial int; Polynomial(1)
[13:18:50] -rusti-                                          ^~~
[13:18:50] -rusti- application terminated with error code 101
[13:19:02] <bstrie> rusti: pub struct Polynomial<T>([T, ..2]); let foo = Polynomial([1i, 2]); foo.__field__
[13:19:03] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/XIFa
[13:19:11] <dbaupp> heh
[13:19:18] <dbaupp> inconsistencies!
[13:19:27] <emartin> hmm
[13:19:33] <kimundi> (of fmt!())
[13:20:01] <dbaupp> (tuple structs really should be printed like enums... I think visitors actually support this but clearly sys::log_str isn't using it.)
[13:20:27] <kimundi> emartin: In short, you can't use something more simple than 'struct Foo(...)'
[13:20:31] *** Joins: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[13:20:37] <SirSkidmore> So I'm trying to learn memory management, because I just have no clue what's happening. I'm trying to trim the whitespace from a function parameter, as here: https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[13:21:12] <SirSkidmore> but I have no clue what I'm doing, and it errors out with "error: cannot infer an appropriate lifetime due to conflicting requirements."
[13:21:17] <dbaupp> ok, maybe it doesn't support it. :(
[13:21:21] <emartin> so if T implements add, how would I write add on the Polynomial<T>? What I want to do is initialize a resulting Polynomial<T> and then iterate over it by index and add, but I don't know how to create an "empty" polynomial vector for arbitrary T
[13:21:28] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[13:22:04] <emartin> essentially just wondering how to write a vector add, where the vector is over some abstract field
[13:22:06] <dbaupp> SirSkidmore: https://gist.github.com/huonw/2e61204488007e299d40
[13:22:10] *** Quits: pyrac (pyrac@29E99D66.73C89388.AD05C589.IP) (Quit: pyrac)
[13:22:45] <SirSkidmore> dbaupp: what do those changes represent? the ' I mean
[13:23:08] <dbaupp> emartin, your field should be a trait, which either has a zero() static method or uses num::Zero in the standard library
[13:23:13] <bstrie> emartin: you want to overload addition on your custom type?
[13:23:21] *** Joins: pyrac (pyrac@moz-E5F8F718.math.u-bordeaux1.fr)
[13:23:22] *** Joins: moonchrome (moonchrome@moz-9C2622FD.dsl.iskon.hr)
[13:23:28] <dbaupp> emartin: then [num::Zero::zero(), .. DEGREE] should work
[13:23:35] <dbaupp> SirSkidmore, it's a named lifetime
[13:23:46] <SirSkidmore> wow, emacs does not like those apostrophes haha
[13:23:56] <dbaupp> which means that rust then know that the return value is valid for the same period of time as the input value
[13:24:02] <SirSkidmore> is there anyway to do it without a named lifetime?
[13:24:05] <dbaupp> SirSkidmore, yeah, they make things go strange :(
[13:24:07] <dbaupp> nope
[13:24:30] <dbaupp> named lifetimes are the only way to return borrowed pointers from a function
[13:24:56] <dbaupp> (you could do `s.trim().to_owned()`, which copies the trimmed string into a new ~str)
[13:25:14] <dbaupp> http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html, btw
[13:25:48] <SirSkidmore> hmm
[13:26:11] *** Quits: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP) (Quit: Leaving.)
[13:26:35] <SirSkidmore> I'm not so sure I like that very much
[13:26:59] *** Joins: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se)
[13:27:02] <dbaupp> SirSkidmore, well, it's either allocate or use named lifetimes
[13:27:20] <SirSkidmore> how would that go with allocation?
[13:27:27] <dbaupp> named lifetimes are a very powerful tool for expressing relationships between variables in Rust
[13:27:41] <dbaupp> the allocation one is the .to_owned() method
[13:27:51] <bstrie> yes, returning borrowed pointers is a pretty advanced thing
[13:28:09] <bstrie> not that it's hard to pull off, just that it's sort of amazing that it can be done safely at all
[13:28:44] * SirSkidmore has no knowledge of memory management
[13:29:23] <bstrie> SirSkidmore: neither did I, before I came to rust
[13:29:37] <SirSkidmore> I was reading through Rust for Rubyists
[13:29:44] <SirSkidmore> and that did a decent job, I guess
[13:30:00] <bstrie> SirSkidmore: what languages are you familiar with?
[13:30:15] <SirSkidmore> Ruby
[13:30:22] <SirSkidmore> and Clojure
[13:30:29] <SirSkidmore> I really really want to learn Rust though
[13:30:30] <bstrie> SirSkidmore: well steve is in here sometimes, you can give him feedback on his book :)
[13:30:35] <bjz> SirSkidmore: I've learned much about memory management from Rust
[13:30:55] <SirSkidmore> bstrie: I paired with Steve the other night, I told him how I felt haha
[13:31:05] <SirSkidmore> wait, so what's the @ sign?
[13:31:20] <bstrie> SirSkidmore: that's what you use if you want an item to be garbage-collected
[13:31:58] <bstrie> you can declare variables in a few different ways, with different meanings:
[13:32:01] <SirSkidmore> and &'s are borrowed pointer
[13:32:06] <bstrie> let foo = 1;  // foo is allocated on the local stack
[13:32:18] <bstrie> let foo = @1;  // foo is allocated on the local heap
[13:32:47] <bstrie> the task-local heap, rather
[13:33:09] <dbaupp> SirSkidmore: that is correct
[13:33:10] <bstrie> @ pointers might be a little easier to use in theory. in practice they still have some rough edges
[13:33:34] <SirSkidmore> https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[13:33:38] <SirSkidmore> is what I updated it to
[13:33:44] <bstrie> in any case, if you want to learn about memory management, try to do without @
[13:34:02] <bstrie> ~ is much more interesting, because it lets you allocate on the heap *without* activating the garbage collector
[13:34:03] *** Joins: sankha93 (Instantbir@4E59BDF6.F6D95C1.8B6C1D65.IP)
[13:34:03] <SirSkidmore> Times like this make me wish I had started with C, not scheme
[13:34:19] <SirSkidmore> so was my solution bad practice?
[13:34:54] <bstrie> not necessarily
[13:35:08] <dbaupp> SirSkidmore, sort of. it has an (possibly) unnecessary memory allocation and copy
[13:35:20] <dbaupp> SirSkidmore, but often one wants a ~str anyway
[13:35:33] <bjz> rusti: fn lex(s: &str) -> ~str { s.trim().to_owned() } lex("    >    ")
[13:35:34] -rusti- ~">"
[13:35:45] <bjz> or:
[13:36:04] <dbaupp> (and it probably doesn't matter unless you are calling lex a lot in a performance critical bit of code)
[13:36:05] <bjz> fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex("    >    ")
[13:36:18] <bjz> rusti: fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex("    >    ")
[13:36:19] -rusti- ">"
[13:36:22] <SirSkidmore> hmm
[13:36:24] <bstrie> SirSkidmore: the borrowed pointer solution will (iirc) always be the cheapest if you can wrangle it
[13:36:29] <bjz> that doesn't copy
[13:36:29] <bstrie> also the most general
[13:36:43] <SirSkidmore> copies are no good in perfomance critcal code...
[13:36:59] <bstrie> SirSkidmore: but beware of premature optimization :) ~pointers are still quite cheap
[13:37:05] <bjz> SirSkidmore: the nice thing about borrowed pointers is they don't enforce a certain kind of management on your code
[13:37:14] <bjz> rusti: fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex(~"    >    ")
[13:37:16] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dBhf
[13:37:22] <bjz> oh wait
[13:37:25] <bjz> :P
[13:37:46] <bjz> rusti: fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex(~"    >    ").to_owned()?
[13:37:46] <dbaupp> SirSkidmore: languages like Ruby and clojure will probably be copying when you do operations like trim
[13:37:47] -rusti- foo.rs:10:83: 10:84 error: unknown start of token: 63
[13:37:47] -rusti- foo.rs:10          fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex(~"    >    ").to_owned()?
[13:37:47] -rusti-                                                                                              ^
[13:37:47] -rusti- application terminated with error code 101
[13:37:51] <bjz> rusti: fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex(~"    >    ").to_owned()
[13:37:52] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/CTZd
[13:37:58] <bjz> hmm
[13:38:11] <bjz> rusti: fn lex<'a>(s: &'a str) -> &'a str { s.trim() } lex(@"    >    ")
[13:38:13] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VYVV
[13:38:22] * bjz is playing
[13:39:01] <dbaupp> SirSkidmore: and so also doing the copies in Rust will be no slower (and probably actually much faster)
[13:39:27] <SirSkidmore> so really, since this isn't a big huge project (eventually a brainfuck interpreter)
[13:39:30] <SirSkidmore> copies are okay?
[13:39:36] <dbaupp> yeah :)
[13:39:40] <bjz> yeah
[13:39:44] <SirSkidmore> also, since I like tdd, what's wrong with this now? https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[13:39:50] <bjz> you can always fix them later
[13:39:58] <dbaupp> and as you get more practiced, you can come back and remove them if you want
[13:40:21] <dbaupp> SirSkidmore, what's the complaint?
[13:40:40] <SirSkidmore> expected &~str but found ~str
[13:40:48] <dbaupp> assert_eq!(lex(~"   >    "), ~">")
[13:40:48] <dbaupp> should work
[13:41:00] <dbaupp> (there are operators for equality, btw: `==`)
[13:41:13] <bjz> SirSkidmore: str and vec need to be cleaned up
[13:41:18] <dbaupp> the type of str::eq is fn(&~str, &~str) -> bool
[13:41:36] <dbaupp> so it takes pointers to ~str's
[13:41:49] <bjz> SirSkidmore: you should try to use the methods as opposed to the free-standing functions
[13:42:06] <SirSkidmore> assert! only takes one parameter
[13:42:13] <dbaupp> i.e. assert!(str::eq(&lex(~"  >  "), &~">"))
[13:42:24] <dbaupp> SirSkidmore: assert_eq! ?
[13:42:28] <bjz> rusti: assert_eq!(1, 1)
[13:42:29] -rusti- ()
[13:42:29] <dbaupp> (what version of Rust?)
[13:42:33] <bjz> rusti: assert_eq!(1, 2)
[13:42:35] -rusti- rust: task failed at 'left: 1 does not equal right: 2', foo.rs:9
[13:42:35] -rusti- rust: domain main @0x21f21b0 root task failed
[13:42:35] -rusti- application terminated with error code 101
[13:42:56] <SirSkidmore> .6
[13:43:05] <bjz> dbaupp: how hard would it be to get a #[deprecated("message")] attribute working?
[13:43:13] <dbaupp> bjz: not sure
[13:43:17] <SirSkidmore> cool, the `==` operator works :)
[13:43:18] <dbaupp> bjz: I was thinking about it
[13:43:21] <SirSkidmore> thanks guys
[13:43:39] <SirSkidmore> this is like an alien language for me haha
[13:43:49] <dbaupp> bjz: and one could probably just scan through the attributes at each function use
[13:43:53] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[13:43:58] <bjz> https://github.com/mozilla/rust/issues/723
[13:44:06] <dbaupp> bjz: but that will most likely end badly for compiler performance :/
[13:44:10] <bstrie> SirSkidmore: it's a lot of fun to be able to do things so close to the metal without worrying about segfaults
[13:44:17] <bjz> SirSkidmore: I recommend using assert_eq
[13:44:22] <SirSkidmore> what are the benefits of using methods opposed to functions?
[13:44:31] <bjz> SirSkidmore: more 'rustic'
[13:44:43] <dbaupp> SirSkidmore: and the methods are newer, on average
[13:44:44] <bjz> besides, the free standing functions will be removed
[13:44:48] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[13:44:56] <bjz> they are old leftovers, most of them
[13:45:03] <dbaupp> bjz: assert_eq! doesn't exist in 0.6, I think
[13:45:03] <SirSkidmore> free standing functions will be removed?
[13:45:04] <bjz> from before we had traits
[13:45:14] <bjz> oh, some of them
[13:45:18] <bjz> from std
[13:45:32] <bjz> as in, don't use str::map
[13:45:49] <bjz> use the method 'map'
[13:45:58] <SirSkidmore> okay
[13:46:07] <bjz> wait, I mean vec::map
[13:46:12] <bjz> :P
[13:46:14] * SirSkidmore did not realize that
[13:46:24] <bjz> no, it's a pain point
[13:46:30] <bjz> it's not your fault
[13:46:46] <bjz> hence why a deprecated attribute would be awesome
[13:46:46] <moonchrome> bjz, is there a way to do something like void foo(T...) (T args) from D in rust ?
[13:47:01] <dbaupp> bjz: we could just add #[doc="hidden"] to all the deprecated functions
[13:47:06] <bjz> moonchrome: no :(
[13:47:09] <dbaupp> bjz: so they don't turn up in the docs
[13:47:20] <dbaupp> bjz: that's possibly a bad idea
[13:47:22] <bjz> dbaupp: good idea
[13:47:26] <bjz> oh
[13:47:28] <bjz> heh
[13:47:32] <dbaupp> I dunno
[13:47:51] <dbaupp> bjz, moonchrome: is that var-args?
[13:47:58] *** Quits: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com) (Ping timeout)
[13:48:02] <moonchrome> dbaupp, yea but typed
[13:48:06] <bjz> aye
[13:48:15] <bjz> D's magical awesomeness
[13:48:17] <dbaupp> well you can pass &[T]
[13:48:19] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:48:24] <dbaupp> right?
[13:48:35] <moonchrome> dbaupp, except T in this case isn't a type but a type tuple
[13:48:46] <dbaupp> "type tuple"?
[13:48:50] <moonchrome> so you can do foo("string", 1, 3.0f)
[13:48:56] <dbaupp> oh, pairs a value with it's type?
[13:48:58] <SirSkidmore> thanks again guys :)
[13:49:06] <dbaupp> cool. that is pretty awesome
[13:49:13] *** Joins: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com)
[13:49:26] <moonchrome> maybe I can do something similar with macros
[13:49:38] <dbaupp> one could probably achieve a similar thing with a trait that encapsulates the functionality
[13:49:49] <dbaupp> and then cast the args to a trait-object
[13:49:54] <dbaupp> moonchrome, that would work too
[13:50:24] <bjz> moonchrome: welcome btw!
[13:50:50] <dbaupp> i.e. trait FooArg { fn do_foo(&self); } fn foo(&[&Foo]) { .. }  foo(&[&("string") as &Foo, &1 as &Foo])
[13:51:06] <bjz> herh
[13:51:10] <dbaupp> (could be abbreviated by a macro)
[13:51:41] <bjz> dbaupp: (I don't think that would impress somebody coming from D)
[13:51:44] <bjz> :P
[13:51:48] *** Joins: SimonSapin (simon@A5049320.3E93794D.61EA6C28.IP)
[13:51:54] <dbaupp> bjz: true :P
[13:52:05] <dbaupp> but it gets the functionality, sort-of
[13:52:50] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[13:52:59] <dbaupp> another way would be to steal Haskell's printf implementation, so one could do foo("string")(1)(3.0f) and type inference would handle everything
[13:53:36] <moonchrome> nah it's fine - I'm fine with using a macro just need to look in to them, I'm thinking about writing a lib to wrap luajit - and adding a macro for generic function call that casts arguments to lua types seems ok
[13:54:08] <dbaupp> moonchrome: that's no fun :P
[13:54:28] <heftig> fmt! is special right now, right?
[13:54:31] <nmatsakis> dbaupp: we plan to make "casting to a trait" occur atomatically at function calls
[13:54:32] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[13:54:32] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[13:54:34] <nmatsakis> so you'd just have to write
[13:54:41] <nmatsakis> foo("string", 1, 3.0f)
[13:54:44] <nmatsakis> well, probably
[13:54:44] <dbaupp> heftig: not really
[13:54:47] <bstrie> moonchrome: I already have luajit2 bound, I just haven't wrapped it nicely yet (nor written any functions that are defined in C as macros)
[13:54:49] <nmatsakis> foo(&"string", &1, &3.0f)
[13:55:02] <dbaupp> nmatsakis: ooh, cool! looking forward to it
[13:55:15] <nmatsakis> we'll see how well we can get it to work,
[13:55:22] <moonchrome> bstrie, link ?
[13:55:38] <dbaupp> heftig: it's "special" in the sense that it's a syntax extension written in Rust (i.e. not a plain macro)
[13:55:45] *** Joins: victorporof_ (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[13:55:57] <heftig> could you do it with a macro?
[13:56:02] <dbaupp> heftig: but other than that, it doesn't use any information that a normal syntax extension doesn't have. (since it is one)
[13:56:10] <dbaupp> fmt! ?
[13:56:11] <bstrie> moonchrome: it's on a different computer, it really isn't anything special. I basically just used bindgen on luajit2 and commented out the few bits that we can't bind atm
[13:56:24] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[13:56:28] <heftig> i.e. get it out of the compiler and into libstd
[13:56:31] <dbaupp> no, you can't parse the string at compile-time with a macro_rules! macro
[13:56:55] <bstrie> moonchrome: I'll upload the code once I get home, but in the meantime you could probably replicate it without too much trouble
[13:57:00] <dbaupp> aatch and I have got a partial rewrite that moves almost all the logic into std
[13:57:08] <bjz> nmatsakis: btw, I got a question about extern function pointers on #d. still blocked?
[13:57:08] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[13:57:29] <dbaupp> and just leaves a wrapper to call the appropriate functions and emit the appropriate AST
[13:57:35] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[13:57:38] <dbaupp> but it's very partial :p
[13:57:41] <moonchrome> bstrie, you're seriously overestimating my abilities when you say without too much trouble, but I'm doing it to learn anyway so off I go :P
[13:58:23] <dbaupp> heftig: the other option is to have dynamically loadable syntax extensions
[13:58:27] <nmatsakis> bjz: currently yes. I was just looking at them, it's very confusing. bootstrap dies a horrible death, but every smaller test program I've concocted works.
[13:58:29] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[13:58:34] *** Joins: igl1 (igl@moz-4599A0C3.adsl.alicedsl.de)
[13:58:37] <nmatsakis> bjz: only on windows, of course, works everywhere else just fine
[13:58:48] <bjz> nmatsakis: bloody windows. gah
[13:58:51] <dbaupp> heftig: which is sort-of almost possible (I have a POC that works on my computer, not sure about elsewhere)
[13:59:08] <bjz> moonchrome: it was you who asked about fnpointers right?
[13:59:14] <moonchrome> bjz, yea
[13:59:21] <moonchrome> how do you link against GL then ?
[13:59:23] <bjz> moonchrome: if so, there's the answer ^
[13:59:25] <nmatsakis> bjz: I think I just have to break on main and step instruction-by-instruction.... or something... I think it's maybe dying while linking DLLs or something awful like that.
[13:59:25] *** Quits: igl (igl@moz-FE397357.adsl.alicedsl.de) (Ping timeout)
[13:59:25] <moonchrome> if you can't use fnpointers
[13:59:28] *** Joins: reyre_ (reyre@86C3727C.33EE9F8A.1139E686.IP)
[13:59:38] <bjz> moonchrome: compile bindings
[14:00:09] <bjz> moonchrome: I have glcore bindings, which are very brittle, but folks have had success with opengl-es
[14:00:13] <moonchrome> you mean static linking ? but that's only going to give you like gl 1.x or something
[14:00:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:01:07] *** Quits: pyrac (pyrac@moz-E5F8F718.math.u-bordeaux1.fr) (Quit: pyrac)
[14:01:14] <moonchrome> or am I off on that ?
[14:01:24] <bjz> no, but it's not portable
[14:01:56] <bjz> are you relying on extensions?
[14:02:02] <bjz> if not there's https://github.com/mozilla-servo/rust-opengles
[14:02:09] *** Quits: igl1 (igl@moz-4599A0C3.adsl.alicedsl.de) (Ping timeout)
[14:02:11] <moonchrome> gldebug ext is nice
[14:02:17] <bjz> yeah
[14:02:29] <bjz> then you'll have to use my loader when it works
[14:02:34] *** Joins: igl (igl@moz-B6ECDE93.adsl.alicedsl.de)
[14:02:49] <bjz> moonchrome: I have this: https://github.com/bjz/glcore-rs
[14:03:01] <bjz> moonchrome: but I think I need to update it
[14:03:23] <bjz> moonchrome: I can do it quickly if you like
[14:03:39] <bjz> there is also: https://github.com/bjz/glfw-rs
[14:04:51] <bjz> or if you like SDL: https://github.com/brson/rust-sdl/
[14:04:51] <moonchrome> yea I found GLFW already and it's trunk so neat I'll use that
[14:04:54] <bjz> moonchrome: let me know if you have any issues
[14:05:33] *** cscottnet_away is now known as cscottnet
[14:05:38] <bjz> moonchrome: I try to keep it up to date with the GLFW3 repo, but sometimes I lag behind
[14:06:48] <bjz> moonchrome: I've attempted to wrap it ideomatically - I really need to do a table of the alterations I've made
[14:07:38] *** Joins: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de)
[14:07:48] <moonchrome> bjz, I know what you mean I had my wrapper for D, then the repo changed their constant values (WTF :| ) in header and I didn't check when I recompiled ... fun times ensued
[14:08:02] <bjz> heh
[14:08:19] <bjz> it pays to follow the repo
[14:08:31] <bjz> and #glfw
[14:08:46] <bjz> but the changes in glfw3 are seriously awesome
[14:09:08] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:09:21] <bjz> much more to the spirit of glfw than glfw2 :)
[14:10:55] <moonchrome> event driven input is sort of meh for me - it's dispatched on platform update anyway, just buffering it and letting me implement my own dispatch if I really want to would be nicer IMO
[14:11:07] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:11:15] <bjz> I would like to do that eventually
[14:11:51] <bjz> ie. abstract from callbacks, and just initialise port/chans
[14:12:15] <nmatsakis> bjz: actually, I'm ... making a little progress on windows now. I tried single stepping and I see that it does indeed ENTER the main fn, I haven't quite figured out how far it gets before it goes off the rails...
[14:12:23] <moonchrome> I did it in D but then you end up with a silly situation where you register a callback to get notified of every element in GLFW internal buffer, then you copy it to your own buffer and then implement your callbacks eventually 
[14:13:01] <bjz> moonchrome: if you have any ideas, be sure to let me know
[14:13:03] <SirSkidmore> so I can't use char::is_whitespace as a method?
[14:13:14] <MaikKlein> bjz: do you need some help with your math lib?
[14:13:14] <SirSkidmore> how do I know from the docs what is and what isn't a method?
[14:13:17] <bjz> SirSkidmore: are you on incoming?
[14:13:17] *** Joins: dylukes (dylukes@moz-B5418F79.hsd1.pa.comcast.net)
[14:13:25] <SirSkidmore> no .6
[14:13:34] <bjz> SirSkidmore: get on incoming
[14:13:59] <bjz> is my not so subtle suggestion
[14:13:59] <SirSkidmore> Oh. haha.
[14:14:21] <bjz> SirSkidmore: the docs are poorly formatted atm
[14:14:27] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[14:14:45] <bjz> Look for the std::char::Char trait
[14:14:50] <dbaupp> SirSkidmore: the things labelled "Functions" are not methods
[14:14:56] <bjz> it's exported in prelude
[14:15:05] <dbaupp> and the "Methods" (which don't appear in the table of contents) are methods
[14:15:13] <SirSkidmore> okay...
[14:15:17] <bjz> rusti: '\n'.is_whitespace()
[14:15:18] <dbaupp> they are always under "Implementation of ..."
[14:15:19] -rusti- true
[14:15:27] <bjz> rusti: ' '.is_whitespace()
[14:15:28] -rusti- true
[14:15:35] <bjz> rusti: 'X'.is_whitespace()
[14:15:36] -rusti- false
[14:15:40] <SirSkidmore> is rusti on incoming?
[14:15:44] <bjz> MaikKlein: of course!
[14:15:58] <dbaupp> (Or under the "Trait" headings, is where the generic methods are declared)
[14:15:59] <bjz> MaikKlein: at the moment I am having difficulties :(
[14:17:00] <heftig> char is represented how? a u32?
[14:17:14] <bjz> MaikKlein: I can't get my type aliases to work :(
[14:17:31] <cmr> heftig: yes, UCS-4
[14:18:00] <bjz> MaikKlein: it works in the tests, but not externally
[14:18:12] <cmr> SirSkidmore: Yes, more orless
[14:18:16] <cmr> SirSkidmore: it updates daily
[14:18:17] <bjz> MaikKlein: what were you interested in helping with?
[14:18:22] <moonchrome> bjz, IMO GLFW API design choice is wrong, their joystick API is actually what they should expose keyboard/mouse as and drop the callback stuff, using glfw callbacks is only going to work for small test apps, any serious app is going to have it's own event handling mechanism and updating that from a buffer is a lot more efficient than using proxies
[14:18:34] <SirSkidmore> this look okay? https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[14:19:02] <MaikKlein> bjz: Noz sure yet, I started reading though your code yesterday and I am not finished yet. 
[14:19:17] <bjz> SirSkidmore: try lex(s: &str)
[14:19:23] <bjz> MaikKlein: oh cool
[14:19:26] *** Joins: judder (maradukewa@385DDD8F.206937E4.78E362FE.IP)
[14:19:39] <bstrie> SirSkidmore: can you use methods instead of functions for str::each_char and char::is_whitespace ?
[14:19:41] <dbaupp> SirSkidmore: looks fine, although `if !char::is_whitespace(c) { .. }` should work
[14:19:41] <bjz> MaikKlein: there might be lots of icky stuff there :(
[14:19:43] <MaikKlein> bjz, what would you need?
[14:19:46] <heftig> hmm, i assume servo would want to handle all kinds of encodings. would it transcode everything incoming and internally work with utf8 strings only?
[14:20:00] <dbaupp> bstrie: we've just discussed that ;)
[14:20:01] <MaikKlein> bjz: I also run into some issues that I couldn't explain right away
[14:20:12] <bstrie> ah, I wasn't following
[14:20:16] <bjz> MaikKlein: mainly, I want to work out why rray won't build with it
[14:20:30] <dbaupp> heftig: I think that's the plan
[14:20:35] <bjz> MaikKlein: https://github.com/luqmana/rray
[14:20:41] <dbaupp> heftig: (although I have no idea)
[14:20:53] <bjz> MaikKlein: I haven't got around to whittling down the problem
[14:21:03] <dbaupp> heftig: especially since javascript uses utf16, so maybe not
[14:21:04] <bjz> MaikKlein: lots of other stuff on my plate
[14:21:05] <heftig> well, i guess it's what rust suggests, since it assumes utf8
[14:21:07] <MaikKlein> u mean https://github.com/brson/rustray?
[14:21:15] <bstrie> SirSkidmore: also you don't need the "io::" part on println
[14:21:32] <bjz> MaikKlein: no, https://github.com/luqmana/rray
[14:22:53] <MaikKlein> bjz: yeah I will start reading though the code first and then I'll see what I can do. 
[14:23:00] <bjz> MaikKlein: I think it's some corss-crate resolve thing
[14:23:04] <bjz> *cross
[14:23:05] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[14:23:47] <SirSkidmore> bstrie: not on .6 no
[14:24:20] <SirSkidmore> It's a type char does not implement any method in scope named is_whitespace
[14:24:25] <cmr> heftig:there'sa#servo
[14:24:40] <dbaupp> cmr: there's a spacebar? :P
[14:24:41] <cmr> silly netbook and high latency ssh connection:(
[14:24:52] <dbaupp> heh
[14:24:53] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[14:24:58] <bstrie> SirSkidmore: you should definitely be able to omit the io:: bit on 0.6
[14:25:02] <dbaupp> cmr: hows the lz4 going?
[14:25:29] <SirSkidmore> okay
[14:25:30] <SirSkidmore> thanks
[14:25:42] <SirSkidmore> I was refering ti bjz actually sorry
[14:26:03] <cmr> dbaupp: working on it now, slowly. I had a git derp. I have it so it doesn't have to copythe entire metadata just todecompress it though
[14:26:24] <dbaupp> cmr: oh, cool!
[14:26:28] <bjz> SirSkidmore: as I say, upgrade to incoming
[14:26:42] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke. It's all a joke.)
[14:26:53] <bjz> SirSkidmore: it's not implemented as a trait in 0.6
[14:26:56] <SirSkidmore> bjz: why does (s: &str) -> ~str have an advantage to (s: ~str) -> ~str?
[14:26:59] <dbaupp> cmr: any performance numbers yet? ;)
[14:27:21] <bjz> SirSkidmore: it borrows instead of allocating
[14:27:38] <SirSkidmore> then the ~ allocates only on the return?
[14:27:44] <bjz> aye
[14:27:57] <cmr> dbaupp: nope, haven't actually got the new code to build yet (I dev'diton a different machine, didn'thaverustoranything,and myrebase was bad.
[14:28:04] <bjz> well, it doesn't *force* you to allocate
[14:28:12] <SirSkidmore> cool thanks :)
[14:28:13] <bjz> I think is more correct
[14:28:30] <SirSkidmore> I won't upgrade to incoming on this machine, it would take days
[14:28:41] <cmr> SirSkidmore: ifyou're using arch, there's a repo
[14:28:42] <bjz> dang :(
[14:28:53] <SirSkidmore> I have an old laptop at work (intern, w00t)
[14:29:07] <dbaupp> cmr: oh, I see
[14:29:12] <SirSkidmore> at home it takes about 25 minutes, annoying for rebuilding everyday but doable I guess
[14:29:29] <cmr> SirSkidmore: Yeah, try developingit :)
[14:29:35] <dbaupp> cmr: well, anyway, hurry up! I need my faster rustc. :P
[14:29:53] <dbaupp> SirSkidmore: being a few days behind incoming isn't normally a problem
[14:29:56] <cmr> dbaupp: It'sonly very marginallyfaster and should only be noticable on small programs
[14:30:07] <cmr> We'll see, though
[14:30:14] <SirSkidmore> why does it take so long to build? I mean I build go in a matter of minutes
[14:30:20] <SirSkidmore> I have a decently quick machine
[14:30:41] <cmr> SirSkidmore: compiler is inefficient and needs tobootstrap 3 stages of itself
[14:30:41] <dbaupp> cmr: damn, I was looking forward to building rustc in 30 seconds, heh :P
[14:31:00] <SirSkidmore> cmr: oh
[14:31:01] <dbaupp> SirSkidmore: also, go was designed from the start for fast compiles
[14:31:13] <dbaupp> Rust was designed for safe and fast code
[14:31:13] <cmr> Alsoif you don't have  at least 2.5GB of memory dedicated to the rsut build, you'll swap and itwilltakeforever
[14:31:27] * SirSkidmore doesn't know anything about compilations
[14:31:28] <pnkfelix> SirSkidmore: see e.g. https://mail.mozilla.org/pipermail/rust-dev/2013-May/004328.html
[14:31:44] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[14:31:46] <bstrie> SirSkidmore: when you have a compiler that's written in itself, it has to build itself three times
[14:31:53] *** Quits: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net) (Quit: jclements)
[14:31:54] <SirSkidmore> I have 8gb ram with a 3.8GHz AMD bulldozer at home
[14:32:28] <cmr> mm, 25 minutes is reasonable
[14:32:38] <cmr> it takes 18 on my machine for incoming\
[14:32:39] <dbaupp> 25 minutes is on the faster end
[14:32:47] <SirSkidmore> cmr: what are your specs?
[14:32:53] <cmr> SirSkidmore: sec
[14:33:32] *** Joins: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com)
[14:33:57] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[14:34:10] <cmr> http://pcpartpicker.com/user/cmr/saved/Cs6
[14:34:14] <cmr> Accounts for it all, I think
[14:34:22] <cmr> (Mostof it was frankensteined)
[14:34:48] <cmr> SirSkidmore: The rust build isn't veryparallel, so it takes a while
[14:34:58] <cmr> ALsotakes a while if oyu don't have LLVM already built or in ccache
[14:35:55] *** Quits: annodomini (lambda@moz-9AC5B452.hsd1.ma.comcast.net) (Quit: annodomini)
[14:36:05] <SirSkidmore> that must be what it was
[14:36:18] <SirSkidmore> all of the llvm stuff was taking ages
[14:36:20] <cmr> mmm. after llvm is builtit's way faster
[14:36:59] <pnkfelix> SirSkidmore: yeah I added â€”enable-ccache b/c llvm builds were annoying me, but I didn't want to deal with redirecting gcc et al to ccache.
[14:37:26] <SirSkidmore> so when I do make, I add that switch or?
[14:37:48] <pnkfelix> SirSkidmore: add â€”enable-ccache to the configure invocation.  (You need to have ccache installed.)
[14:38:13] <pnkfelix> SirSkidmore: then the first build will still be slow, but subsequent ones with the same set of compile flags should be faster.
[14:38:18] <dbaupp> https://github.com/mozilla/rust/wiki/Note-ccache
[14:38:35] <pnkfelix> ah I should update that note
[14:39:32] <SirSkidmore> oh great!
[14:39:34] <SirSkidmore> thansk
[14:39:46] *** Joins: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de)
[14:42:25] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:42:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[14:42:35] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Rud1rA
[14:42:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[14:42:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[14:42:35] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/cSHCVQ
[14:42:36] <ghrust> 13rust/06auto 1434ee63e 15Philipp BrÃ¼schweiler: std::cell: Modernize constructors...
[14:42:36] <ghrust> 13rust/06auto 14e1c1c05 15Philipp BrÃ¼schweiler: std::io: Modernize some constructors...
[14:42:36] <ghrust> 13rust/06auto 143ce75e7 15Philipp BrÃ¼schweiler: std::util: Modernize NonCopyable constructor...
[14:42:38] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[14:44:39] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[14:45:11] <MaikKlein> bjz, out of curiosity but this should work right? use lmath::vec::*; let a = vec2::new(1.0, 2.0);
[14:45:41] <bjz> MaikKlein: that's the bug I was talking about :(
[14:46:04] <bjz> MaikKlein: I haven't had a chance to reduce it down to a small test case
[14:46:13] <bjz> ie. that I can submit as an issue
[14:46:20] *** Joins: jeff (jeff@4231C034.745B261B.F12515B4.IP)
[14:46:34] <MaikKlein> bjz: I'lll look into it too
[14:46:58] <bjz> if you could that would be amazingly helpful! :)
[14:47:55] <bjz> ultimately I would prefer not to have to hack it with those macro-generated mods
[14:48:16] <bjz> MaikKlein: https://github.com/mozilla/rust/issues/6894
[14:48:27] *** Quits: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se) (Input/output error)
[14:48:32] <bjz> but it's still a bug in resolve that needs to be fixed
[14:50:04] *** kimundi is now known as zz_kimundi
[14:50:38] <SirSkidmore> I'm really enjoying this so far :)
[14:52:42] *** Joins: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net)
[14:54:41] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (Ping timeout)
[14:57:47] *** Joins: themgt (themgt@moz-248BBB96.dhcp.gnvl.sc.charter.com)
[14:57:52] *** Quits: themgt (themgt@moz-248BBB96.dhcp.gnvl.sc.charter.com) (Client exited)
[15:00:16] *** Joins: ceatc (Mibbit@moz-D5AEE09B.torservers.net)
[15:01:03] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[15:01:22] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:01:25] *** Joins: eholk (eholk@moz-2835AC2B.uconnect.utah.edu)
[15:05:58] <MaikKlein> bjz, do you think it is a bug in the language?
[15:06:19] <bjz> MaikKlein: yeah
[15:06:20] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[15:06:44] <MaikKlein> bjz, I make a small test case now , so that I can experiment better
[15:07:06] *** zz_kimundi is now known as kimundi
[15:07:08] <bjz> MaikKlein: oh nice
[15:07:34] <bjz> the thing is, it works for the tests, but not cross-crate
[15:07:46] <bjz> that's what makes me think it's a bug
[15:09:07] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[15:09:42] <MaikKlein> bjz, yes that totally confused me, but in your tests your are also writing it lowercase vec3::identity() while it should be Vec3::identity()
[15:09:46] <SirSkidmore> is there a way to declare an array of a fixed size?
[15:09:48] <MaikKlein> or doesn't this matter in rust?
[15:10:47] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[15:11:08] <bjz> SirSkidmore: let v: [int,..3] = ...
[15:11:12] *** victorporof_ is now known as victorporof
[15:11:18] <bjz> let x = [1, 2, 3];
[15:11:23] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[15:11:36] <bjz> let x = [1,..3];
[15:12:00] <bjz> MaikKlein: look at the macros below the trait implementations of the vectors
[15:12:30] <bjz> I shoukd document it better
[15:12:34] <bjz> *should
[15:12:49] <SirSkidmore> thanks :)
[15:13:03] *** Joins: EXetoC (ex@moz-2DBEB1E4.customer.t3.se)
[15:13:47] <SirSkidmore> oh wait bjz what if I just want an empty array with say, 64 entries?
[15:13:58] <SirSkidmore> rather than 1, 2, 3, 4 etc
[15:14:06] <MaikKlein> I think I have a hunch where the problem comes from
[15:14:07] <bjz> rusti: [0, ..5]
[15:14:08] -rusti- [0, 0, 0, 0, 0]
[15:14:14] <SirSkidmore> great
[15:14:16] <SirSkidmore> :)
[15:14:17] <bjz> MaikKlein: basically it makes a new submodule for each type alias
[15:14:23] <SirSkidmore> sorry for all my stupid questions
[15:14:28] <bjz> SirSkidmore: np!
[15:14:33] <MaikKlein> they are not stupid :)
[15:14:53] <bjz> SirSkidmore: I'm sure there are lurkers out there that might learn from it too
[15:15:44] <bjz> MaikKlein: so yeah, the idea is you can do Vec3f32::new(1.0, 1.0, 1.0)
[15:16:01] <bjz> or Vec3i::identity()
[15:16:52] <bjz> Does that make sense?
[15:17:27] *** Joins: thou (thou@4816F848.98C448FD.130A8F7A.IP)
[15:17:53] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:17:56] <MaikKlein> yeah I just realized that now by looking at your type aliases
[15:18:14] *** Quits: dbaupp (Thunderbir@moz-C6B1454A.lns20.syd7.internode.on.net) (Ping timeout)
[15:19:02] <MaikKlein> whaat
[15:19:11] <bjz> MaikKlein: as I say, it's not the most ideal situation, Ideally it would be handled by the language.
[15:19:18] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[15:19:42] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[15:19:44] <bjz> whaat?
[15:20:26] <bjz> MaikKlein: once everything gets working again I want to revamp the README with some example code
[15:21:27] <MaikKlein> bjz, no I just was confused about your vec2 macro where you are using bool instead of T, but then I realized that it was just its own case
[15:22:09] <bjz> MaikKlein: is it too astronautical? :(
[15:22:28] <bjz> MaikKlein: I'm thinking those zip_assign macros might be
[15:22:40] <bjz> might be better just to write it out by hand
[15:22:45] <strcat> http://www.reddit.com/r/programming/comments/1fkhwa/removing_garbage_collection_from_the_rust_language/cabu6mt?context=3 lol
[15:22:46] <strcat> reddit
[15:22:47] *** Joins: mr_pants (Mibbit@3E9D68F2.B1163E0C.2A6693DD.IP)
[15:23:35] <SirSkidmore> I think I'm getting closer to finishing the brainfuck, but why am I getting a non-exhastive patterns here? https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[15:23:51] <SirSkidmore> do I need to include an else clasue or something?
[15:24:00] <MaikKlein> bjz, no it's totally fine :)
[15:24:08] *** Quits: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp) (Client exited)
[15:24:44] *** Quits: SimonSapin (simon@A5049320.3E93794D.61EA6C28.IP) (Quit: Leaving.)
[15:24:49] <doener> SirSkidmore: something like: _ => fail!("Go away")
[15:24:56] <SirSkidmore> okay
[15:24:58] <doener> SirSkidmore: the _ acts as a wildcard
[15:25:06] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[15:25:40] <bjz> SirSkidmore: for p.each_char |c| {
[15:25:43] <MaikKlein> bjz, but do you think it is a good idea to write sth like this Vec3i::identity() instead of Vec3<int>::identity()?
[15:26:04] <bjz> MaikKlein: you can't do that currently
[15:26:31] <bjz> I had a discussion with nmatsakis about this a day or so ago
[15:26:50] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Ping timeout)
[15:26:59] <bjz> https://github.com/mozilla/rust/issues/6894
[15:27:00] <SirSkidmore> bjz: if I do p.each_char |c| { I get a "fauled to find an implementation of trait core::io::reader
[15:27:08] *** Quits: brendan (brendaneic@moz-825E629B.sub-70-211-69.myvzw.com) (Quit: brendan)
[15:27:09] <bjz> SirSkidmore: dang
[15:27:24] <bjz> SirSkidmore: I think I've run into that too actually
[15:27:41] <MaikKlein> oh didn't even know that
[15:27:58] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:27:59] <SirSkidmore> so then, as opposed to outputing the number, what would be the best way to turn a value into a char?
[15:28:08] <SirSkidmore> for instance 65 into 'A'
[15:28:49] <bjz> rusti: 65 as char
[15:28:51] -rusti- 'A'
[15:28:58] <bjz> :)
[15:29:10] <bjz> SirSkidmore: it means another trait has another method implemented on str
[15:29:18] <bjz> SirSkidmore: that previous error
[15:29:26] <bjz> I think
[15:29:28] <bjz> wait
[15:29:28] <bstrie> rusti: 255 as char
[15:29:29] *** Quits: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net) (Quit: jclements)
[15:29:29] -rusti- '\xff'
[15:29:35] <bstrie> rusti: 257 as char
[15:29:36] -rusti- '\u0101'
[15:29:39] <bjz> bstrie: :P
[15:30:05] <bstrie> rusti: 2 as char
[15:30:06] -rusti- '\x02'
[15:30:16] <bjz> rusti: 4 as char
[15:30:17] -rusti- '\x04'
[15:30:20] *** Quits: mr_pants (Mibbit@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:30:27] <SirSkidmore> what do you mean bjz?
[15:30:28] <bjz> rusti: 72 as char
[15:30:31] -rusti- 'H'
[15:31:09] <bjz> SirSkidmore: my mistake, the p.each_char error - actually I don't know if that's the problem
[15:31:18] *** Joins: orshem (orshem@19491716.F0FDCE77.E3D28531.IP)
[15:31:42] <bjz> each_char is defined on StrSlice
[15:31:45] *** Joins: themgt (themgt@moz-248BBB96.dhcp.gnvl.sc.charter.com)
[15:31:46] *** Quits: themgt (themgt@moz-248BBB96.dhcp.gnvl.sc.charter.com) (Client exited)
[15:31:56] <bjz> and implemented for &'self str
[15:33:11] <bstrie> rusti: '\u0101' as uint
[15:33:12] -rusti- 257
[15:33:14] <bjz> rusti: for "hiya".each_char |c| { print("%c", c); }
[15:33:16] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/SdJR
[15:33:18] *** Quits: sp3d (a@moz-49806493.dhcp.stls.mo.charter.com) (Ping timeout)
[15:33:48] <bstrie> rusti: 'ç·‘' as uint
[15:33:49] -rusti- 32209
[15:33:58] <bstrie> nifty
[15:33:58] <bjz> somebody put a duplicate method on str
[15:34:06] <bstrie> here I thought that char was always u8
[15:34:58] <bjz> rusti: 'Â©' as uint
[15:35:00] -rusti- 169
[15:35:07] <bjz> rusti: 'Â©' as u8
[15:35:08] -rusti- 169
[15:35:17] <doener> rusti: 'â…ž' as uint
[15:35:19] -rusti- 8542
[15:35:23] <bjz> rusti: 'ç·‘' as u8
[15:35:25] -rusti- 209
[15:35:30] <bjz> :P
[15:35:39] <bjz> rusti: ('ç·‘' as u8) as char
[15:35:40] -rusti- '\xd1'
[15:35:43] <bjz> hehe
[15:35:49] <MaikKlein> xd
[15:35:58] <bjz> rusti: ('ç·‘' as uint) as char
[15:36:00] -rusti- '\u7dd1'
[15:36:15] <bjz> rusti: (('ç·‘' as uint) as char).to_str()
[15:36:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/AVOg
[15:36:46] <bjz> rusti: fmt!("%c", ('ç·‘' as uint) as char)
[15:36:47] -rusti- ~"\u7dd1"
[15:36:57] <bjz> rusti: fmt!("%c", ('h' as uint) as char)
[15:36:58] -rusti- ~"h"
[15:37:01] *** Joins: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se)
[15:37:34] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[15:37:44] <SirSkidmore> ladies and gentelmen! a somewhat working brainfuck parser!!!
[15:37:46] <SirSkidmore> https://gist.github.com/SirSkidmore/f38b02edde6a6f8b2d58
[15:38:20] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[15:38:22] <SirSkidmore> that was a lot of fun
[15:38:29] <SirSkidmore> I learned a lot in that little time
[15:38:31] <SirSkidmore> haha
[15:38:52] *** Quits: jensnockert (jensnocker@moz-952CD207.ab.sol.lu.se) (Input/output error)
[15:38:54] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[15:39:35] <MaikKlein> haha
[15:39:41] *** Joins: mib_8gtp13 (Mibbit@moz-A0E225F0.avcosystems.co.uk)
[15:40:00] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[15:40:17] <SirSkidmore> totally just outputs an 'A' and only implements part of the language
[15:40:21] <MaikKlein> but you don't have to use the ~ hre
[15:40:22] *** Joins: jdm (jdm@DB05BBF2.BB1F48F2.971E19F6.IP)
[15:40:26] <Blei> rusti: fmt!("%c", 'ç·‘')
[15:40:28] -rusti- ~"\u7dd1"
[15:40:28] <SirSkidmore> not to mention it doesn't read the file
[15:40:29] <bstrie> I like how the lexer for brainfuck is apparently identical to "remove whitespace" :P
[15:40:47] <SirSkidmore> bstrie: there's a little more for comments
[15:40:51] <SirSkidmore> which this doesn't support yet
[15:41:00] <SirSkidmore> MaikKlein: where?
[15:41:19] <doener> line 34
[15:41:51] <SirSkidmore> I don't?
[15:42:05] <SirSkidmore> why not?
[15:42:15] * SirSkidmore still is barely groping memory management
[15:42:20] <doener> parse takes a &str, and a static string works as &'static str
[15:42:30] <SirSkidmore> ohh
[15:44:14] <SirSkidmore> well I'm pretty darn happy with it
[15:44:33] <bjz> nice!
[15:44:34] <SirSkidmore> not half bad for about an hour, I'd say
[15:44:43] <bjz> how about a fold for the lexer?
[15:44:53] <MaikKlein> SirSkidmore, you can just write "> +"
[15:45:28] <SirSkidmore> bjz: a fold?
[15:45:38] <SirSkidmore> this is the lowest level code I've ever written
[15:45:40] <SirSkidmore> haha
[15:46:53] <bjz> ahh, doen't seem like there's a fold for str
[15:46:55] <kimundi> Brrr. There REALLY needs to be a way to de_import things from the prelude
[15:47:09] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[15:47:11] <bjz> SirSkidmore: fold is a higher order function
[15:47:15] <SirSkidmore> oh
[15:47:21] <bjz> like reduce
[15:47:22] <SirSkidmore> well, I'm going to go grab some lunch
[15:47:27] <bstrie> kimundi: such as?
[15:47:29] <bjz> so not very low level :)
[15:47:31] <SirSkidmore> I'll be back in a bit to work some more on it :)
[15:47:31] <bjz> bye!
[15:47:41] <SirSkidmore> thanks again for the help everyone
[15:47:47] <bjz> no worries!
[15:47:53] <SirSkidmore> this is the most helpful IRC room I've been in :)
[15:48:16] <kimundi> bstrie: Well something like '!use std::iterator::Iterator;'
[15:48:36] <rsaarelm> https://github.com/Jeaye/q3/blob/master/src/math/vec3.rs Is there a reason the different element types here are done with a macro instead of a type parameter?
[15:48:47] *** Quits: eholk (eholk@moz-2835AC2B.uconnect.utah.edu) (Quit: eholk)
[15:48:54] <bstrie> kimundi: can you redefine it? `use foo = std::iterator::Iterator;`
[15:49:06] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:49:20] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[15:49:52] *** Joins: keret (Mibbit@3E9D68F2.B1163E0C.2A6693DD.IP)
[15:50:15] <kimundi> bstrie: That doesn't solve the problem that the prelude effectivly reserves a global set of names
[15:50:26] <kimundi> bstrie: ANd in this case it wouldn't work
[15:50:28] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:50:31] <bstrie> kimundi: right, but I'm curious to see what happens
[15:50:48] <bstrie> does it fail? does it let you have two names for the same thing?
[15:51:08] <kimundi> bstrie: I wanted to add Iterator to the prelude. But the Cell::take and Iterator::take methods conflict
[15:51:36] <bstrie> kimundi: could either of those become a method?
[15:51:54] <bstrie> oh wait, what? methods conflicting
[15:51:56] <bstrie> hmm
[15:52:25] <bstrie> I'm not sure how that's even possible
[15:52:38] <bstrie> the whole point of methods is that you can use them on different types and they don't conflict
[15:52:46] <kimundi> somewhere in task.rs there is 'foo.take()' on a cell value. But with the Iterator trait in scope the compiler instead thinks it's the take method of Iterator and complains that it doesn't fit the type.
[15:53:01] <bstrie> kimundi: I feel like this is a broader problem, because it means you couldn't ever import the iterator methods in a module that uses cells
[15:53:36] <kimundi> MIghtd well be a bug, but still I think there should be a way to un-import prelude items :P
[15:53:42] <bstrie> kimundi: I don't understand why it would think that a cell is an iterator and not pick the proper method
[15:53:45] <bstrie> I'd say file a bug
[15:53:56] *** Joins: pyrac (pyrac@moz-E5F8F718.math.u-bordeaux1.fr)
[15:54:13] <bstrie> and then file another for de-importing prelude items
[15:54:15] <bstrie> or really any item
[15:54:47] <bstrie> I feel like it wouldn't be too hard to be able to say that `use foo = some_name_thats_already_imported` removes the latter name and makes it available again
[15:55:31] <moonchrome> is there a ubuntu PPA for nightly/master builds ?
[15:56:00] <moonchrome> my PC isn't very good I'd like to avoid building from source :|
[15:56:02] <bstrie> moonchrome: the only nightly build that I've heard of is for arch
[15:56:09] <bstrie> a PPA would be great
[15:56:15] <bstrie> but I have no idea how to set one up
[15:56:56] <moonchrome> me neither :)
[15:57:02] <moonchrome> https://launchpad.net/~kevincantu/+archive/rust this is the only thing I found
[15:58:21] *** Joins: untothebreach (paul@15A17709.47300931.30F15291.IP)
[15:58:28] *** Quits: pyrac (pyrac@moz-E5F8F718.math.u-bordeaux1.fr) (Ping timeout)
[15:58:29] *** Joins: jclements (jclements@2557E599.66715431.D25A875A.IP)
[15:59:12] *** Joins: eholk (eholk@moz-4CCE9748.uconnect.utah.edu)
[16:00:35] <MaikKlein> how do I call the new function? https://gist.github.com/MaikKlein/5707125
[16:01:01] *** Joins: \n (NDesaulnie@2557E599.66715431.D25A875A.IP)
[16:01:21] <bstrie> MaikKlein: when you define your new function in the trait, I think you have to call it with the trait name
[16:01:27] <bstrie> so try BaseVec2::new
[16:01:36] <bstrie> alternatively you could just define it for the type, without a trait at all
[16:01:44] <bstrie> then you'd call it Vec2::new
[16:02:11] <bjz> SirSkidmore: https://gist.github.com/bjz/647f7a8ed5b886f556c2
[16:03:03] *** Quits: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP) (Quit: Instantbird 1.2 -- http://www.instantbird.com)
[16:03:24] *** Joins: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP)
[16:03:28] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Input/output error)
[16:03:29] <bjz> SirSkidmore: Result types are nice because you can chain/map them together
[16:03:45] <doener> MaikKlein: let b = BaseVec2::new::<int,Vec2<int>>(1,2);
[16:03:46] <emartin> exit
[16:03:48] *** Quits: emartin (emartin@moz-C3D4EEBF.caltech.edu) (Quit: leaving)
[16:04:01] *** Joins: tjc (tjc@moz-B867959A.redactedconsulting.com)
[16:04:01] *** ChanServ sets mode: +o tjc
[16:04:06] <bjz> SirSkidmore: we make heavy use of them in https://github.com/bjz/rusp
[16:04:21] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[16:04:34] <molnarg> I'm preparing a presentation about Rust security features, and wanted to ask if I miss anything important if I talk about the memory model, format strings and nullable pointers? Are there other important security features in Rust I should cover?
[16:04:34] <bjz> MaikKlein: the mods I defined with the macros are important
[16:04:59] *** Joins: pnkfelix1 (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[16:05:02] <bstrie> molnarg: rust does automatic bounds checking
[16:05:15] *** Quits: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Connection reset by peer)
[16:05:27] <bjz> MaikKlein: they are what enable me to 'fudge' the behaviour in that issue I sent you
[16:05:42] <molnarg> bstrie: you mean on arrays, right?
[16:05:47] <bstrie> molnarg: yes
[16:05:55] <molnarg> bstrie: thanks
[16:06:05] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[16:06:09] <bjz> rusti: ~[1, 2, 3][8]
[16:06:10] -rusti- rust: task failed at 'index out of bounds: the len is 3 but the index is 8', foo.rs:10
[16:06:10] -rusti- rust: domain main @0x12c21b0 root task failed
[16:06:10] -rusti- application terminated with error code 101
[16:06:21] <bjz> :)
[16:06:27] <bjz> molnarg: ^
[16:06:39] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[16:06:50] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Connection reset by peer)
[16:07:11] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[16:07:23] <bstrie> molnarg: also, I'm pretty sure that rust isn't vulnerable to stack overflows (I think it uses a stack canary for this), but even still it's much harder to overflow rust stacks because all stacks will grow as necessary
[16:07:25] <molnarg> the way it is implemented is "augmented" pointers, right?
[16:08:06] <molnarg> bstrie: Isnt it impossible to overflow arrays?
[16:08:26] <MaikKlein> bjz, yes I saw that your are creating your mods with vec2_type!. I was just curious :)
[16:08:27] <bblum> jld: who do you work for these days?
[16:08:28] <bstrie> molnarg: no, but can you be more specific?
[16:08:46] *** Quits: dbaumgarten (quassel@moz-3126A5E0.dip0.t-ipconnect.de) (Client exited)
[16:08:46] <MaikKlein> because let b = BaseVec2::new::<int,Vec2<int>>(1,2); looks super weird
[16:09:17] <bjz> MaikKlein: yeah pnkfelix1 has an article on it too: http://blog.pnkfx.org/blog/2013/04/22/designing-syntax-for-associated-items-in-rust/
[16:09:34] *** Quits: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP) (Quit: Instantbird 1.2 -- http://www.instantbird.com)
[16:09:48] <molnarg> bstrie: I'm not very familiar with arrays, but as I understand, there's a length specification besides every "slice" and array pointer which makes overflow impossible. Or is completely false?
[16:09:52] *** Joins: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP)
[16:11:07] <bjz> molnarg: also note the 'unsafe' blocks. they are a usful escape hatch, and contain the 'bad stuff' to more manageable sized bits
[16:11:08] <doener> MaikKlein: if you can, I'd currently always write "let b: Vec2<int> = BaseVec2::new(1,2)" and let the compiler figure it out
[16:11:18] <bstrie> molnarg: any time you index into an array, rust checks to make sure that your index is valid. so you cannot access memory beyond the array itself
[16:11:18] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[16:11:32] *** Quits: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP) (Quit: Instantbird 1.3 -- http://www.instantbird.com)
[16:11:46] <bjz> molnarg: so they are easier to review :)
[16:11:47] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[16:11:47] *** ChanServ sets mode: +o brson
[16:12:12] <benh> rusti: unsafe { std::cast::transmute::<&[int], (*(), uint)>([1, 2, 3, 4, 5]) }
[16:12:13] -rusti- ((0xc2dde0 as *()), 40)
[16:12:36] <molnarg> bjz: ok, but I assume an average Rust programmer shouldn't need to use unsafe blocks
[16:12:41] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[16:12:55] <bstrie> molnarg: true, unsafe blocks are for doing crazy things
[16:12:57] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[16:12:57] *** ChanServ sets mode: +o pcwalton
[16:13:01] <molnarg> bstrie: isn't this check enough to prevent an overflow?
[16:13:05] <bjz> molnarg: yeah, the idea is to keep it contained as much as possible
[16:13:09] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[16:13:54] <bblum> sully: nice.
[16:14:34] <bjz> doener: the trouble is that defining a method in respect to the Trait is awkward. 2f.sqrt() or "hiya".len() is accessed with respect to the implementing type, where Real::pi() is not.
[16:14:51] <bstrie> molnarg: index checking is enough to ensure that you don't access memory outside of the array, do you mean something different by "overflow"?
[16:14:53] <bjz> (well at least to my eyes)
[16:14:54] <Luqman> bblum: he works at mozilla afaik
[16:14:54] <brson> https://etherpad.mozilla.org/Meeting-weekly-2013-06-04
[16:15:31] <bblum> graydon where are youuuuuu
[16:15:52] *** Joins: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP)
[16:16:01] *** pnkfelix1 is now known as pnkfelix
[16:16:11] <bjz> bblum: I don't think he can hear you :)
[16:16:17] <bblum> indeed not
[16:16:21] <bjz> :(
[16:16:23] <doener> bjz: agreed, just saying that given the current restrictions, giving the variable a type is easier than providing it to the function call
[16:16:42] *** Quits: aruniiird (arun@92D70115.B332A52C.E3D0A897.IP) (Ping timeout)
[16:17:37] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[16:17:50] *** Quits: keret (Mibbit@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:17:50] *** Quits: oksobul (Instantbir@5420C305.88F2F905.4A037BC4.IP) (Quit: Instantbird 1.3 -- http://www.instantbird.com)
[16:18:12] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[16:18:17] *** Parts: judder (maradukewa@385DDD8F.206937E4.78E362FE.IP) ()
[16:19:58] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[16:20:34] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[16:21:07] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:21:28] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:21:54] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[16:22:03] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[16:23:16] <moonchrome> bjz, can I build glfw-rs with rust 0.6 ?
[16:23:52] <bjz> moonchrome: no
[16:23:59] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[16:24:04] <bjz> moonchrome: but there is a tagged version of 0.6
[16:24:17] *** Joins: dherman (dherman@2557E599.66715431.D25A875A.IP)
[16:24:17] <bjz> but it doesn't work with the latest version of glfw3
[16:24:17] *** ChanServ sets mode: +o dherman
[16:24:28] <moonchrome> bjz, so I need to build rust from source ?
[16:24:38] <bjz> I would *strongly* reccomend using incoming
[16:24:48] <bjz> it has all the latest shiny
[16:24:53] <moonchrome> bjz, ?
[16:25:07] <bjz> shiney = niceness = yum yum
[16:25:07] <moonchrome> you mean branch ?
[16:25:14] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[16:25:16] <bjz> yeah, of rust
[16:25:23] <bjz> :)
[16:26:03] <moonchrome> oh ok, just that last time I ran make on rust I remember being a hour in before giving up
[16:26:11] <moonchrome> my PC is crap :(
[16:27:49] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[16:28:27] *** Joins: weirdo (Mibbit@CD0E240F.F837BE66.D8A3AC42.IP)
[16:29:37] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[16:31:27] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[16:32:39] <steven_is_false> Hi! I have some particularly nasty global state I have to encapsulate, and make safe (OpenGL,) and I was wondering how practical it'd be to launch another process to handle my windowing, and rendering activity?
[16:32:41] <bblum> rusti: let mut y = 5; let mut ref mut x = y;
[16:32:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dcXN
[16:33:01] <untothebreach> how often is --enable-local-rust successful? I am on incoming right now, but have to build from the snapshot
[16:33:37] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Quit: victorporof)
[16:35:03] <bstrie> untothebreach: I've never even heard of that option
[16:35:44] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:36:27] *** Quits: weirdo (Mibbit@CD0E240F.F837BE66.D8A3AC42.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:36:42] <bjz> moonchrome: it first has to build llvm
[16:37:02] <bjz> moonchrome: but once you build it, it goes quicker the next time
[16:37:04] <moonchrome> bjz, yea I know - that's where I got stuck when I terminated the build
[16:37:13] <Luqman> untothebreach: i'd imagine just the time around when a snapshot is made
[16:37:25] <moonchrome> bjz, any difference between incoming and main branch ?
[16:37:32] *** cscottnet is now known as cscottnet_away
[16:37:49] *** Joins: evmar (user@F4C60568.27376607.189F3E15.IP)
[16:38:02] <moonchrome> * I mean what's the difference
[16:38:02] <bjz> moonchrome: well there is talk of moving incoming to master
[16:38:19] <bjz> moonchrome: it was more useful before we had a buildbot
[16:38:32] <strcat> pcwalton: the reddit thread about your removing gc post makes me sad
[16:38:49] <pcwalton> strcat: a lot of C++ programmers (including herb sutter) think that C++11 is safe
[16:38:52] *** Joins: mattin (user@1CF07A06.DC7A989C.7F8AB798.IP)
[16:38:53] <strcat> there are dozens of C++ fans in there claiming that modern C++ has no dangling references
[16:39:23] <doomlord> lol
[16:39:24] *** Joins: Jesse (jruderman@2557E599.66715431.D25A875A.IP)
[16:39:27] <bjz> :)
[16:39:29] <strcat> apparently in modern C++ you never: pass non-const references, return references/iterators, use iterators, use Boost.Range, use tagged unions, etc.
[16:39:30] <moonchrome> pcwalton, that post was great btw. it made me realize rust was the better alternative to C++ than D
[16:39:42] <doomlord> you could make a subset/superset that was safe and call it...
[16:39:43] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[16:39:43] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/K90qVQ
[16:39:43] <ghrust> 13rust/06auto 1434ee63e 15Philipp BrÃ¼schweiler: std::cell: Modernize constructors...
[16:39:43] <ghrust> 13rust/06auto 14e1c1c05 15Philipp BrÃ¼schweiler: std::io: Modernize some constructors...
[16:39:43] <ghrust> 13rust/06auto 143ce75e7 15Philipp BrÃ¼schweiler: std::util: Modernize NonCopyable constructor...
[16:39:44] <pcwalton> I mean, you can always just define away anything that isn't safe as "Not Real C++11"
[16:39:44] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[16:39:49] <strcat> axilmar makes a good strawman for me to argue with
[16:39:55] <pcwalton> which is fine, but how would you make that machine checkable?
[16:40:05] <pcwalton> you will need a borrow check
[16:40:12] <steven_is_false> There doesn't seem to be a spawn_processs function which would be along the lines of fn spawn_process (fn : Copy Owned Const ()) I think. Am I mistaken?
[16:40:23] <strcat> pcwalton: well you could probably teach clang to enforce a borrow check in the same way, but it'd make 99% of existing C++ not work ;p
[16:40:26] <doomlord> what seems so weird is there are C++ people who think raw pointers should be removed from C++
[16:40:38] <strcat> the thing about references in C++ is that you can't store them in containers
[16:40:53] <strcat> so you do need raw pointers, if you don't want to a) copy or b) use reference counting everywhere
[16:40:59] <doomlord> and they're ashamed of c compatability i.e. "the worst part of C++ is C".. well why do these peopel stick with it, instead of getting behind an alternative?
[16:41:12] <strcat> stockholm syndrome
[16:41:25] <bjz> doomlord: they are 'pragmatists' :)
[16:41:26] <doomlord> thats exactly how i feel toward c++ :)
[16:41:34] <doomlord> stockholm syndrome
[16:41:37] <strcat> anyway I think they're just super-sensitive because they're used to people claiming GC is required for memory safety and they'd never accept GC
[16:41:51] <strcat> nor do they want to even read a tiny bit about a new language
[16:42:02] <strcat> rust threatens their job security ;p
[16:42:03] <illissius> strcat: it's really easy to make a non-nullable, storable, assignable 'reference' type though, if you want to
[16:42:23] <strcat> illissius: if it's mutable you can still get dangling refs from containers or tagged unions
[16:42:24] <illissius> no need to use pointers
[16:42:25] *** dcoates|afk is now known as dcoates
[16:42:34] <bjz> pcwalton: I liked your post btw. very neat
[16:42:35] <illissius> strcat: I'm not disagreeing with that!
[16:42:36] <moonchrome> meh - C++ is a relic - it relies on a preprocessor - there's no point in even trying to improve such a language, just leave it for legacy and maintenance and build new languages to replace it
[16:42:37] <strcat> illissius: ah, that's what you mean - yeah, like boost::optional
[16:42:40] <doomlord> i did wonder if there would be a machine translateable , compatable subset of c++ and rust
[16:42:41] *** Joins: carter (carter@moz-BDFE46F6.nyc.biz.rr.com)
[16:42:55] <strcat> illissius: but then you've just remade pointers :)
[16:42:58] <doomlord> the best use of C++ is as a better C
[16:43:09] <doomlord> not  as a new language
[16:43:13] <strcat> boost::optional<&T> is just like *T
[16:43:25] <strcat> maybe it makes someone feel safer
[16:43:34] <evmar> hello, is this the right channel for newbie questions?
[16:43:35] <doomlord> "rust threatens their job security ;p" <<<<<
[16:43:39] <strcat> evmar: sure :)
[16:43:42] <doomlord> ^^^ Rust threatens to make work enjoyable
[16:43:48] <doomlord> if it ever catches on
[16:43:50] <evmar> suppose i have a  struct File { path: ~str }
[16:43:52] *** Quits: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp) (Client exited)
[16:43:54] <illissius> strcat: template<typename T> struct Ref { Ref(T&); T& operator*() const; T* operator->() const; private: T* m_ptr; }; and that's more or less it
[16:44:00] <illissius> no need to use plain pointers
[16:44:09] <evmar> and wanted to join an array of those with spaces
[16:44:12] <illissius> which doesn't make C++ safe, just less unsafe.
[16:44:13] <evmar> what's idiomatic?
[16:44:31] <evmar> str::connect(files.map(|f| f.path.clone(), " ")) seems unsatisfactory due to the .clone()
[16:44:32] <strcat> illissius: well, nullable pointers aren't really unsafe in userspace anyway - I don't really like them as an example of rust's safety
[16:44:47] <strcat> in most OSes at least.
[16:44:58] <bjz> evmar: the .connect method doesn't copy
[16:45:26] <evmar> doesn't .clone() on a ~str make a copy?
[16:45:34] <bjz> rusti: ["hiya", "hoho", "ha"].connect(" ")
[16:45:35] -rusti- ~"hiya hoho ha"
[16:45:38] <evmar> <- literally just wrote his first program
[16:45:49] <strcat> evmar: yes, clone copies
[16:46:09] <illissius> splitting hairs over the definition of the word 'unsafe' again.. :) ruling out null deref crashes/exceptions is really valuable no matter what you call it.
[16:46:13] <bjz> evmar: well, .connect makes a new ~str
[16:46:18] <strcat> evmar: there's connect_slices or something
[16:46:33] <strcat> illissius: you still have crashes though
[16:46:35] *** Quits: thou (thou@4816F848.98C448FD.130A8F7A.IP) (Input/output error)
[16:46:39] <strcat> illissius: it's just from a failure/exception instead
[16:46:43] <bjz> strcat: I impled connect on &[&str]
[16:46:47] <evmar> strcat: aha!  that is what i was looking for!
[16:46:57] <doener> strcat: there's a trait for that now, implemented for [~str] and [&str]
[16:47:00] <bjz> strcat: we need to deprecate those free standing functions
[16:47:09] <bjz> rusti: ["hiya", "hoho", "ha"].connect(" ")
[16:47:10] -rusti- ~"hiya hoho ha"
[16:47:15] <bjz> ^^^
[16:47:25] <strcat> illissius: even haskell still has them, it has functions throwing on empty lists in Prelude
[16:47:31] *** Joins: webber46 (webber46@moz-D5AF41D7.cust.bredband2.com)
[16:47:31] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[16:47:39] <strcat> and they're a type of exception you can't catch afaik (error)
[16:47:40] <evmar> strcat: re null pointers, just to contribute something back, NULL[very-large-offset] is memory unsafe.  maybe nullable pointers and bounds checks is safe (in the sense of crashing before doing something bad)
[16:47:41] <bjz> hence the need for #[deprecated]
[16:48:12] <kimundi> strcat: Btw a problem cropped up with including Iterator in the prelude. Iterator::take and Cell::take conflict
[16:48:12] <evmar> bjz: python has that method on string, ruby has that method on arrays.  ;)
[16:48:33] <strcat> well Cell is stupid so we can rename that until method resolving works
[16:48:33] <illissius> strcat: sure. but you won't get them from being passed a pointer/ref parameter and forgetting to check for null, which is prob by far the most common case. it's a big improvement.
[16:49:02] <strcat> illissius: right, that's true - C++ references are essentially non-nullable though (you have to memset them or something)
[16:49:06] <bjz> rusti: [[1, 2],[3, 4, 5],[2, 3]].connect(0)
[16:49:08] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/BeFj
[16:49:18] <strcat> illissius: but I know what you mean (avoiding the null case in containers)
[16:49:20] <strcat> so yeah, it's valuable
[16:49:26] <bjz> rusti: [~[1, 2],~[3, 4, 5],~[2, 3]].connect(0)
[16:49:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/gKCU
[16:49:39] <strcat> definitely valuable as a documentation thing
[16:49:40] <bjz> rusti: [~[1, 2],~[3, 4, 5],~[2, 3]].connect(&0)
[16:49:42] -rusti- ~[1, 2, 0, 3, 4, 5, 0, 2, 3]
[16:49:50] <bjz> evmar: ^ got it
[16:50:10] <Yurume> yeah, I've got rust-opengles-angle working in Windows now
[16:50:22] *** Joins: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr)
[16:50:24] <Yurume> (finally!)
[16:50:31] <evmar> bjz: oh i didn't understand what you were doing with rusti.  i scrolled back now and i think i followed
[16:50:58] <bjz> evmar: rust is a bit of a puzzle sometimes
[16:51:17] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[16:51:17] <strcat> until we cut down all of those duplicate fns/methods at least ;p
[16:51:33] <kimundi> strcat: Gonna rename cell::take to cell::take_out then (to be symmetric with cell::put_back). Sounds good?
[16:51:42] <strcat> kimundi: yeah
[16:51:56] <strcat> kimundi: don't worry about making Cell uglier, it's already an anti-pattern as a workaround
[16:52:07] <kimundi> And now to resolve a bunch of compile errors...
[16:52:10] <bjz> strcat: I think we really need #[deprecated], and the put that on a swathe of thpse free standing functions
[16:52:13] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[16:52:19] *** Quits: mib_8gtp13 (Mibbit@moz-A0E225F0.avcosystems.co.uk) (Quit: http://www.mibbit.com ajax IRC Client)
[16:52:21] <strcat> bjz: and methods ;p
[16:52:31] <bjz> strcat: we'll get a whole load of warnings, but then we can whittle them down
[16:52:48] <strcat> bjz: yep and it stops new code from being written
[16:53:10] <bjz> strcat: there is a conflict with each_char btw
[16:53:20] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[16:53:22] <bjz> strcat: between io and str
[16:53:38] <evmar> bjz: can you make that "connect" work with an intermediate map?
[16:53:54] <evmar> [~"foo", ~"bar"].map(|f| f).connect("a")
[16:54:03] *** Joins: dolphinling (andrew@moz-80A1E448.uvm.edu)
[16:54:21] <bjz> rusti: [~"foo", ~"bar"].map(|&f| f).connect("a")
[16:54:22] -rusti- ~"fooabar"
[16:54:22] *** Joins: sp3d (a@moz-49806493.dhcp.stls.mo.charter.com)
[16:54:32] <evmar> wow, it really is a puzzle, heh
[16:54:44] <bjz> evmar: you gain an intuition
[16:54:49] <evmar> is there a way to make rusti print the type of an expression?
[16:55:25] <bjz> evmar: map gives you a borrowed pointer to the element of the vector
[16:56:01] <bjz> evmar: the |&f| pattern matches on that pointer, giving you a dereferenced value
[16:56:10] <evmar> i think my problem was i don't know what |&f| means... ah, a pattern match, sure
[16:56:11] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[16:56:19] <bjz> you could do map(|f| *f)
[16:56:27] <doomlord> just understanding the need/use of these lifetimes..
[16:56:38] <doomlord> fn select<'r, 'tmp, T>(shape: &'tmp Shape, threshold: float,
[16:56:38] <doomlord>                        a: &'r T, b: &'r T) -> &'r T {
[16:56:38] <doomlord>     if compute_area(shape) > threshold {a} else {b}
[16:56:38] <doomlord> }
[16:56:59] <bjz> evmar: pattern matching args is quite useful sometimes
[16:57:46] <bjz> rusti: [(1, 2), (3, 4), (5, 6)].map(|&(a, b)| a + b)
[16:57:47] -rusti- ~[3, 7, 11]
[16:57:51] <doomlord> ^^^^ so shape could be something evaluated as a temporaryr for that call .. wheras a,b have to be from the surrounding scope  
[16:57:52] <bjz> evmar: ^
[16:58:17] <evmar> i think i follow.  i have ~"foo", then map borrows and passes &~"foo" to the closure.  returning that value directly causes a (disallowed) move
[16:58:26] <bjz> evmar: I should probably say, 'destructuring'
[16:59:08] <bjz> evmar: yeah, you're trying to return  &~"foo" from the closure
[16:59:13] <evmar> bjz: the final problem i was having is that your example doesn't work in rust 0.6 i think :)
[16:59:21] <bjz> :)
[16:59:28] <evmar> error: type `~[~str]` does not implement any method in scope named `connect`
[16:59:28] <evmar>  
[16:59:41] <untothebreach> bstrie: i noticed it when browsing `./configure --help`, trying to find ways to speed up the build time. I have yet to build successfully while using that option, though :-/
[16:59:43] <bjz> evmar: I added that last weekend
[16:59:45] <bjz> :)
[17:00:01] <bjz> doomlord: sorry for swamping you
[17:00:12] <bjz> doomlord: might be easier if you gisted it
[17:00:13] *** Joins: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net)
[17:00:14] <doomlord> heh and sorry for pasting 5 lines
[17:00:19] <bjz> :)
[17:01:12] <bjz> doomlord: so is the problem that you need 'tmp?
[17:01:34] <doomlord> even if those lifetimes could be infered, II suppose if you need to declare it in a trait first.. you can declare how the function shuold work better
[17:01:41] <doomlord> i read on that the tmp can be ommitted
[17:01:46] <bjz> doomlord: because I would have thought you wou;dn't need 'tmp
[17:02:00] <doomlord> yes i pasted an earlier bit from the tutorial.
[17:02:10] <cmr> untothebreach: --enable-local-rust is mostly useless, afaik. At the very least you need an old enough rust using it that stage0 will build with it.
[17:02:11] <evmar> anyway, thanks strcat and bjz!
[17:02:13] *** Quits: evmar (user@F4C60568.27376607.189F3E15.IP) (Quit: ERC Version 5.3 (IRC client for Emacs))
[17:02:42] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[17:02:53] <cmr> untothebreach: and at this point, the snapshot is out of date with the language within a few days :)
[17:02:55] <doomlord> i think some useful examples to 'sell' rust would be C++ cases where you can write memory bugs which this system avoids.. (or annotations of the c++ equiv)
[17:03:06] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Ping timeout)
[17:03:17] <cmr> doomlord: write some up :)
[17:03:39] <doomlord> write some crashable c++, sure :)
[17:03:40] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[17:03:53] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[17:04:10] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[17:04:16] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[17:05:21] <strcat> doomlord: yeah but they just claim that you should write bug-free code
[17:05:34] <strcat> and you shouldn't write code using references or iterators in C++, apparently
[17:06:13] <strcat> so rust is a much faster alternative to their subset of C++ ;p
[17:08:06] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[17:08:12] <cmr> Among my favorite parts of rust are getting rid of the godawful header system
[17:08:30] <doomlord> +1
[17:08:41] <doomlord> goodbye headers, good riddance.
[17:09:19] <kimundi> And hello dear sweep precios uninvalidatable iterators :3
[17:09:30] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[17:10:03] <strcat> kimundi: at least if you avoid @mut/RcMut
[17:10:12] <strcat> otherwise you just get an equivalent failure
[17:10:19] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[17:10:25] *** Joins: jviereck (Adium@moz-A6E974E1.ethz.ch)
[17:10:38] *** Joins: aruniiird (arun@84E199D6.DCDBCF8E.83D0DF30.IP)
[17:10:40] <kimundi> which is still safe, just not useful :D
[17:13:55] <strcat> yeah but you can make safe iterators in other languages (including C++) that fail like that
[17:14:05] *** Joins: berak (chatzilla@18E6D8FB.BCE163C1.1A5CC7E5.IP)
[17:14:08] <doomlord> i much prefer the HOF style to iterators
[17:14:12] <strcat> what you can't do is make iterators that statically freeze the container
[17:14:16] <strcat> doomlord: they aren't exclusive
[17:14:28] <cmr> HOF?
[17:14:38] <doomlord> the HOF style says less about sequential evaluation usually
[17:14:45] <strcat> doomlord: there aren't two style
[17:14:48] <strcat> styles*
[17:15:05] <strcat> if your language doesn't have laziness you need ranges/iterators to represent composable lazy algorithms
[17:15:21] <strcat> or you can make thunks yourself
[17:15:23] <strcat> which will be slow
[17:15:41] <strcat> in haskell you can just write
[17:15:46] <strcat> zip xs ys
[17:15:51] <strcat> and it's lazily evaluated
[17:15:55] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[17:16:08] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[17:16:18] <strcat> in rust, you need to represent Zip as an object (range/iterator or whatever you want to call it)
[17:16:28] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[17:16:41] <strcat> at least until we have some way of compiling a generator to a range/iterator :)
[17:16:54] <cmr> Oh, HOF == higher order function?
[17:16:59] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:17:01] <strcat> yes, which ranges use
[17:17:14] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[17:17:19] <doomlord> i'm thinking in terms of purity
[17:17:37] <strcat> doomlord: ranges can be "pure", they can use &
[17:17:47] <strcat> they're no different than passing a possibly-pure closure to a hardcoded algorithm
[17:17:50] *** Quits: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Ping timeout)
[17:18:05] <strcat> rust can't enforce purity
[17:18:09] <strcat> only memory safety
[17:18:14] <doomlord> i'm thinking of cases where the HOF style is explicitely parallelizable - thats my interest in it
[17:19:03] <strcat> but they aren't
[17:19:14] <strcat> xs.map(do_something_with_side_effect)
[17:19:45] <strcat> the compiler can auto-vectorize (or parallelize, if compilers ever get that smart) either way just as easily
[17:20:00] <strcat> it doesn't know the difference after it inlines the higher-order function or the range algorithm
[17:20:07] <strcat> from LLVM's POV they are the same
[17:20:20] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[17:20:34] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Quit: Lost terminal)
[17:20:35] <strcat> one of them runs a loop body inside a function
[17:20:44] <strcat> in the other, the function is the loop body and the loop is outside of it
[17:20:44] <brson> https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-06-04
[17:20:48] <strcat> but there's no difference after an inline
[17:20:50] <cmr> oh it's tuesday, yay
[17:21:05] <doomlord> i'm talking about cases wehre you explicitely write something that is auto-vectorizable via semantics
[17:21:19] <doomlord> without the compiler having to figure it out
[17:21:23] *** Quits: dylukes (dylukes@moz-B5418F79.hsd1.pa.comcast.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[17:21:44] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[17:21:46] <strcat> doomlord: either way works for that too
[17:22:05] <cmr> Who are the interns? They in IRC? :)
[17:22:11] <doomlord> to me it just seems more natural with hofs - the iterator style seems more 'sequential', (and the compiler has to figure out when it isn't)
[17:22:34] <doomlord> if the low level had intrinsic map etc.. that would be nice (i know it probably doesnt, but thats' where i'd like to see things..)
[17:22:46] <strcat> doomlord: the low-level doesn't need map
[17:22:51] <strcat> it knows what a loop without side effects is
[17:23:04] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:23:06] <strcat> it doesn't care about higher-order functions vs iterators/ranges
[17:23:29] <strcat> ranges use higher-order functions anyway
[17:23:32] <bjz> brson: long meeting huh?
[17:23:33] <doomlord> well the machine has vector hardware
[17:23:43] <strcat> doomlord: yes, and either way is the same from LLVM's POV
[17:23:52] <strcat> either it has a loop or it has a loop
[17:24:00] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[17:24:06] <doomlord> but when its vector hardware.. it isn't a loop - its simultaneous
[17:24:13] <strcat> doomlord: it's still a loop
[17:24:23] <strcat> it vectorizes the loop, it has no idea what map/filter are
[17:24:43] <strcat> it sees a loop without side effects, it checks some heuristics to see if vectorizing it would be effective, and then does it
[17:24:49] <doomlord> yeah but a system could be devised that did know and directly expressed parallel concepts
[17:24:58] <doomlord> and with parallel hardware it makes sense to me :)
[17:25:02] <strcat> doomlord: the system is immutability and/or purity
[17:25:22] <strcat> rust has the former and not the latter, but that's often enough
[17:25:31] <strcat> if all the functions are inlined
[17:25:47] <strcat> or if they're internal to the crate, so LLVM can mark them as pure
[17:25:51] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[17:26:06] <lkuper> cmr: the interns include bblum, sully, toddaaro, and probably some others I don't know 
[17:26:10] <strcat> haskell is inherently parallelization (in theory, at least) because it's pure, and everything is immutable
[17:26:14] <strcat> parallelizable*
[17:26:20] <strcat> it doesn't matter that it uses map/filter
[17:26:42] <strcat> or explicit recursion/iteration
[17:27:14] <strcat> you can make parallel versions of map/filter and you can also use ranges in parallel
[17:27:35] <strcat> haskell's lazy lists are "ranges"
[17:27:45] <strcat> in D/C++ terms
[17:28:14] <strcat> ranges that memoize exactly what you can still reference thanks to gc, but other than that just ranges
[17:28:31] *** Joins: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net)
[17:28:32] <doomlord> i suppose rust can make better assumptions r.e. pointer aliasing?
[17:28:49] <strcat> yes
[17:28:51] <doomlord> is this where i'm getting the idea of a need for explicit map
[17:29:03] <doomlord> compared to if you did it in C++ - you can make no such assumptions.
[17:29:05] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[17:29:08] <doomlord> iterators could overlap
[17:29:19] <strcat> we don't need to do anything but good type-based alias analysis for auto-vectorization
[17:29:19] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[17:29:19] *** ChanServ sets mode: +o brson
[17:29:20] <doomlord> thats one reason it seems the iterator is the wrong level of information
[17:29:44] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[17:29:50] <strcat> doomlord: it's not much different in C++
[17:30:09] <strcat> it doesn't matter what seems to a human to be more parallel
[17:30:28] <doomlord> but at the level of the loop, how can it know about pointer aliasing
[17:30:29] <strcat> to the compiler C++ doesn't know much about pointer aliasing and knows almost nothing (without extensions) about effects
[17:30:44] <doomlord> the emision to the output iterator could overlap the memory of the source... with varying stride
[17:30:44] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[17:30:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/K90qVQ
[17:30:45] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[17:30:47] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[17:30:56] <strcat> doomlord: not in rust
[17:30:59] <doomlord> ok
[17:31:27] <strcat> rust knows &T where T is Const (everything but @mut, RcMut, Cell and similar types) points to immutable memory
[17:31:29] *** Joins: blitter (blitter@moz-BA14D5CF.dyn.centurytel.net)
[17:31:29] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:31:50] <strcat> immutable == non-aliasing for a compiler, even if two pointers literally alias
[17:31:59] <strcat> &mut doesn't alias anything but @mut and &const
[17:32:13] <strcat> it knows everything it needs to know about aliasing, if we told LLVM about it
[17:32:27] <strcat> just have to write that pass
[17:32:34] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[17:32:46] <strcat> doomlord: a higher-order function isn't explicitly parallelizable in C++
[17:32:50] <strcat> it can have side effexts
[17:32:52] <strcat> effects*
[17:32:58] <doomlord> of course it isnt thats my complaint 
[17:33:00] <strcat> and those side effects can even include mutating memory
[17:33:12] <mattin> hi, how can i clean an old version of rust from my system?  i have tried 'make clean' but for some reason it's not cleaning some of the installed binaries.  
[17:33:14] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:33:20] <untothebreach> cmr: thanks!
[17:33:21] <doomlord> thats why i started with the idea 'intrinsic parallelizable HOFs would be nice' :)
[17:33:27] <strcat> doomlord: well it's not in rust either. because we don't have purity
[17:33:39] <strcat> and you can't actually auto-parallelize haskell because there's not a compiler smart enough to do it
[17:33:41] <cmr> mattin: make isn't a package manager, it doesn't touch anything installed, it just cleans the build directory.
[17:33:43] <strcat> you have to add annotations
[17:33:47] <cmr> mattin: You have to do it manually.
[17:33:55] <doomlord> ok.
[17:33:57] <doomlord> soooo.
[17:34:12] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[17:34:23] <doomlord> the path to writing parallelizable code is.. a version of map which has semantics friendly to parallelizing...
[17:34:28] <strcat> doomlord: no
[17:34:32] <doomlord> perhaps - in my picture of the world
[17:34:47] <doomlord> you have to 
[17:34:49] <strcat> there's no compiler that can auto-parallelize effectively
[17:34:51] <doomlord> oops.
[17:34:58] <mattin> cmr: oh thank you, did not realize.  that seems rather inconvenient though :( 
[17:34:59] <strcat> you have to explicitly annotate parallelism
[17:35:14] <mattin> cmr: what's the best way to find all the things that were installed?
[17:35:19] <strcat> because 99% of the program can be run in parallel to some extent but 99% of the time it's slower than serial code
[17:35:20] <doomlord> "there's no compiler that can auto-parallelize effectively" - this is why I suggest a lanugage/compiler-toolchain with primitives - like intrinsic map - that would make it easier :)
[17:35:27] <strcat> doomlord: it doesn't though.
[17:35:33] <strcat> doomlord: haskell is purely functional
[17:35:48] <cmr> mattin: let me get a list from my package manager..
[17:35:52] <strcat> the compiler can parallelize *anything*, essentially - except where there's explicitly an evaluation order
[17:36:00] *** Quits: tjc (tjc@moz-B867959A.redactedconsulting.com) (Quit: zzzzzzzzzz)
[17:36:05] <strcat> but you don't gain anything from that
[17:36:13] <cmr> mattin: https://gist.github.com/cmr/025568ef423553711d4d
[17:36:17] <strcat> there's no way for the compiler to know what it should and shouldn't parallelize
[17:36:21] <cmr> mattin: not all of that is installed with make install
[17:36:22] <strcat> you can try writing millions of heuristics
[17:36:31] <kimundi> mattin: 'make uninstall'
[17:36:43] <strcat> you'll get nowhere, much like thousands of researchers have gotten nowhere doing that with haskell ;p
[17:36:44] <doomlord> what i'm suggesting is a version of map that explicetely requires a pure function , so you know it can be swapped for the parallel version without changing program behaviour - you know this by design, so you are thinking about how to write parallel code...
[17:37:01] <strcat> yes, you can easily add par annotations to any haskell code
[17:37:03] <doomlord> ... which will then run well as things like Haswell with its gather instructions become more commonplace...
[17:37:07] <cmr> kimundi: that exists?
[17:37:08] <doomlord> .. or when you get a GPU compiler..
[17:37:10] <kimundi> yes
[17:37:18] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[17:37:22] <cmr> Oh hey look at that
[17:37:29] <kimundi> I use it semi regulary
[17:37:36] <strcat> doomlord: either way it has to be an explicit opt-in
[17:37:39] <doomlord> ok , par annotations. but the purity gave it semantics that were parallel-friendly in the firstplace, right?
[17:37:42] <cmr> mattin: I was wrong, my bad :(
[17:37:42] <mattin> kimundi: cmr: wow yeah it worked :)
[17:37:42] <strcat> 20 years from now with a super smart JIT, maybe not
[17:37:45] <strcat> doomlord: yes
[17:37:49] <doomlord> so you could add the par annotation and know it wont change behaviour
[17:37:54] <strcat> doomlord: yeah, exactly
[17:37:54] <mattin> kimundi: thank you
[17:37:56] <doomlord> ... so i'm suggesting, "my dream language" has this option
[17:38:03] <strcat> doomlord: well haskell is your dream language then ;p
[17:38:05] <doomlord> pure_map    perhaps
[17:38:08] <strcat> rust isn't, yet
[17:38:13] *** Quits: jviereck (Adium@moz-A6E974E1.ethz.ch) (Quit: Leaving.)
[17:38:17] <doomlord> rust is closer to my dream language overall
[17:38:35] <doomlord> ^pure_map is my suggestion then , it seems. (pure_map replaceable with par_map)
[17:38:35] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[17:38:43] <mattin> kimundi: is there an easy command to find all the targets for a particular make file?  i did a google search but all seeemed rather complicated. 
[17:38:52] <strcat> rust would need to know about effects beyond 'unsafe'
[17:38:58] <strcat> perhaps we can just extend unsafe
[17:39:14] <strcat> unsafe "memory-leak" { /* do stuff that's allowed to potentially leak */ }
[17:39:17] <kimundi> mattin: I'm the wrong one to ask about how a makefile actually WORKS ;)
[17:39:23] <doomlord> i gather there was a pure specifier that was removed
[17:39:25] <cmr> mattin: no, unfortunately not, nor is it feasible.
[17:39:34] <strcat> doomlord: it didn't mean purity though
[17:39:45] <cmr> mattin: because makefiles allow you to generate targets at runtime via expansions
[17:39:46] <strcat> it meant this weird form of purity that was only useful for making @mut memory safe
[17:40:00] <doomlord> ok some evolutionary thing in the languages gestation
[17:40:07] <strcat> doomlord: it just meant "doesn't mutate external memory"
[17:40:13] <mattin> kimundi: cmr:  ah ok, darn.  i come form the java realm, so usually they have their build targets listed out... was hoping there would be a similar thing for make.
[17:40:15] <cmr> bblum: is there any docs on your effect system proposal anywhere?
[17:40:19] <strcat> doomlord: via TLS or via &mut
[17:40:27] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:40:37] <cmr> mattin: there's a list of the most useful ones on the wiki somewhere
[17:40:40] <doomlord> is there a bikeshed on this subject for me to read up on .. the path taken
[17:40:46] <kimundi> mattin: Many targets are listed somewhere on the rust github wiki
[17:40:52] <doomlord> does my notion of a "pure_map" make sense
[17:41:06] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[17:41:07] <strcat> doomlord: it makes sense to be able to mark functions as pure
[17:41:20] <strcat> map can be pure, if you pass it an impure function the compiler knows about it
[17:41:20] <doomlord> a lot of my interest comes from the experience of writing parallel code on the xbox360 and ps3
[17:41:24] <mattin> kimundi: cmr:  i will have to take a look.  thanks!
[17:41:29] <doomlord> (my interest in FP)
[17:41:45] <strcat> doomlord: we could have #[readonly] and #[readnone] assertions that the compiler enforces.
[17:41:46] <doomlord> the conventional serial style of coding was horrendous to adapt
[17:41:50] <strcat> that's all LLVM cares about
[17:42:24] <doomlord> is there any ambition ,say , to enable rust for GPGPU programming in the future
[17:42:45] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[17:42:55] <strcat> I think that exists to some extent, don't have a link handy
[17:43:06] <doomlord> #[readonly] #[readnone] r.e. how it acesses 'global memory' ?
[17:43:17] <strcat> doomlord: or memory through parameters, or TLS
[17:43:21] <doomlord> i think that sounds similar to the specifiers i wish could be added to C++ 
[17:43:21] <cmr> doomlord: https://mail.mozilla.org/pipermail/rust-dev/2012-October/002495.html
[17:43:27] <strcat> #[readnone] means pure
[17:43:34] <strcat> doomlord: they exist in C++ in clang/gcc but they aren't safe
[17:43:37] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[17:43:45] <strcat> __attribute__((const)) and __attribute__((pure))
[17:43:49] <doomlord> wow ok
[17:43:52] <strcat> I forget which corresponds to readonly/readnone
[17:43:55] <doomlord> i hadn't seen those
[17:44:00] <doomlord> pure==readnone i guess,
[17:44:04] <doomlord> i gues const = readonly
[17:44:13] <doomlord> globals are const. nice
[17:44:13] <strcat> doomlord: I think it might be the other way ;p
[17:44:17] <doomlord> lol ok
[17:44:21] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[17:44:26] <doomlord> badly named?
[17:44:26] <strcat> doomlord: http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html
[17:44:28] <strcat> doomlord: yeah
[17:44:32] <doomlord> LOL
[17:44:39] <strcat> const
[17:44:41] <strcat>     Many functions do not examine any values except their arguments, and have no effects except the return value. Basically this is just slightly more strict class than the pure attribute below, since function is not allowed to read global memory. 
[17:44:43] <strcat> const is stronger, it's readnone
[17:45:20] <strcat> doomlord: ofc if you get it wrong you get undef behaviour so...
[17:45:39] <doomlord> i wonder if those help with aliasing assumptions
[17:45:53] <strcat> doomlord: well you can use 'restrict' for that
[17:45:59] <strcat> also totally relies on the programmer to be right though
[17:46:14] *** Joins: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP)
[17:46:14] *** ChanServ sets mode: +o pcwalton
[17:46:15] <doomlord> sure, but its a mess, anyhting better than restrict is welcome
[17:46:21] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:46:39] <strcat> anyway gcc attributes are weird
[17:46:40] <doomlord> right. #define pure __attribute__((const))  
[17:46:43] <strcat> scope guards and destructors in C
[17:46:44] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[17:47:06] <cmr> fini/init are pretty useful
[17:47:24] <cmr> horribly unsafe, but useful
[17:47:34] <strcat> cleanup (cleanup_function)
[17:47:36] <strcat>     The cleanup attribute runs a function when the variable goes out of scope. This attribute can only be applied to auto function scope variables; it may not be applied to parameters or variables with static storage duration. The function must take one parameter, a pointer to a type compatible with the variable. The return value of the function (if any) is ignored.
[17:47:38] <strcat>     If -fexceptions is enabled, then cleanup_function is run during the stack unwinding that happens during the processing of the exception. Note that the cleanup attribute does not allow the exception to be caught, only to perform an action. It is undefined what happens if cleanup_function does not return normally. 
[17:47:40] <strcat> so yeah. scope guards. ;p
[17:48:00] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[17:48:02] <strcat> systemd uses that heavily
[17:48:18] <strcat> it's a good thing. but they could just be using C++ if there wasn't a stigma ;p
[17:48:43] <bblum> ok, pcwalton and nmatsakis: i'm going to try to write a condensed version of my closure reform proposal that just talks about what i think it should be
[17:49:11] <bblum> because i felt like my recommended set of choices solved basically all of the problems that were mentioned in the meeting, but it wasn't clear why
[17:49:15] <doomlord> let me check what HOFs rust actually has at the minute, and ask is there 'list-comprehensiion' equivalent..
[17:49:34] <strcat> doomlord: ranges
[17:49:53] <strcat> which we call Iterator atm but... when they get extended perhaps range would be a better term
[17:50:27] <doomlord> perhaps i'll write my own pure_map etc  for future expansion :)
[17:50:51] <cmr> Can vectorization hints be given to LLVM? That'd be a place to use them
[17:51:03] <strcat> cmr: not really "hints"
[17:51:06] <strcat> it has vector intrinsics
[17:51:28] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[17:51:37] <strcat> cmr: alias analysis lets it vectorize whenever it decides it will be a speed win
[17:52:03] <doomlord> it will be intersting to see how much haswell's Gather instructions can be use
[17:52:06] <strcat> vector intrinsics will always be vector instructions if the platform has them for what you use, afaik
[17:52:20] <ruediger_> (maybe rust could add operators to double arrays for improved vectorization and numerical performance)
[17:52:22] <doomlord> gather instructions should increase the amount that SIMD can be emploted 
[17:52:24] *** ruediger_ is now known as ruediger
[17:52:30] <doomlord> damn my keyboard
[17:52:44] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[17:52:47] *** Joins: dimension (dimension@moz-4CCD79C5.dsl.dynamic.simnet.is)
[17:52:51] <cmr> sanxiyn was working on SIMD last I knew
[17:53:00] <bblum> nmatsakis: by the way, i read the thunk post, and am confused; how is the thunk idea any different from the proc idea except for being spelled differently?
[17:53:01] <cmr> a patch adding #[simd] landed, I don't know what else
[17:53:15] <doomlord> i think that was close to the level of explicit SIMD, which is fair enough, definitely good to have
[17:53:27] <cmr> bblum: makes a different sound when it hits the ground
[17:53:43] <doomlord> not far beyond the level of SIMD intrinsics.. marking things that will definitely be SIMD'd , vectorized types...
[17:54:10] <doomlord> .. rather than trying to generate the sort of code that permutes regular data into SIMD registers like they write on sony CELL... and that Haswell will hopefully allow more of
[17:54:45] *** Joins: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP)
[17:54:46] *** Quits: mattin (user@1CF07A06.DC7A989C.7F8AB798.IP) (Ping timeout)
[17:54:57] *** Quits: carter (carter@moz-BDFE46F6.nyc.biz.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:55:34] <cmr> https://gist.github.com/cmr/da8bf24ee837ba4e16b9
[17:55:44] <cmr> How do I pick which one I want? (I want the lz4 one)
[17:56:18] <strcat> cmr: you don't
[17:56:27] <strcat> shouldn't implement conflicting methods
[17:56:39] <cmr> ah
[17:57:01] <cmr> Well can I prevent the to_bytes impl on LZ4Container somehow?
[17:57:12] <strcat> cmr: not if you implement IterBytes
[17:57:20] <cmr> strcat: I don't, though
[17:57:32] <strcat> how is LZ4Container defined?
[17:57:34] <cmr> bjz: Is this the same bug lmath hits?
[17:57:37] <cmr> sec
[17:57:47] <strcat> cmr: is it a struct?
[17:57:55] <strcat> if it's a struct and you didn't implement the other trait, it's a bug
[17:58:05] <strcat> method resolve isn't perfect ;p
[17:58:27] <cmr> https://github.com/cmr/rust/blob/metadata-lz4/src/libextra/lz4.rs
[17:59:22] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[17:59:23] <strcat> cmr: yeah it's the method resolve bug
[17:59:35] <strcat> cmr: you have to implement IterBytes and get the IterBytes default impl for ToBytes
[17:59:40] <cmr> Blech
[17:59:49] <strcat> IterBytes essentially exists for hashing so we should rename it
[18:00:10] <strcat> it doesn't make sense to mix conversion to bytes with conversion to bytes for hashing
[18:00:20] *** Joins: vcl (chatzilla@741D4FEA.76F9E272.DA40C4B3.IP)
[18:00:36] <strcat> unless we... fix the iterbytes impls on things like tuples
[18:01:37] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[18:01:55] <cmr> strcat: bjz: is there an issue open for this?
[18:02:00] <strcat> cmr: yep
[18:02:04] <strcat> I opened one
[18:02:07] <pcwalton> hmm, I lost my colors in rustc
[18:02:24] <strcat> pcwalton: what does 'tput colors' say?
[18:02:29] <pcwalton> 8
[18:02:35] <strcat> pcwalton: what's TERM? and which terminal is it?
[18:02:38] <cmr> extra::term requires 16 colors
[18:02:41] <strcat> $TERM
[18:02:43] <pcwalton> xterm-color
[18:02:50] <pcwalton> it's Terminal.app on Snow Leopard
[18:02:51] <pcwalton> ah
[18:02:56] <Blei> gah, ast is underdocumented
[18:03:00] <strcat> pcwalton: try forcing it to xterm-256color
[18:03:02] <cmr> because it needs to be an ANSI compatible terminal
[18:03:07] <strcat> I don't know if Terminal.app has 256 colors
[18:03:16] <cmr> because that's what extra::term exposes
[18:03:20] <Eridius> Terminal.app on Lion/Mountain Lion does. I don't remember about Snow Leopard
[18:03:24] <Eridius> because I know it got rewritten at some point
[18:03:28] <friggle> the no-gc proposal wasn't discussed in the meeting today it seems
[18:04:04] <moonchrome> how are vtables implemented ? does every type have a vtable pointer or is a proxy created when you cast to trait ?
[18:04:10] <Eridius> if extra::term needs 16 colors, can't it just use bold with an 8-color terminal? Or does it need bold independently?
[18:04:16] <strcat> moonchrome: they're only made if you use traits as objects
[18:04:18] <Blei> what's the expr type that contains literal function names?
[18:04:25] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Ping timeout)
[18:04:29] <strcat> moonchrome: if you just use them as type bounds on generic types, there are no vtables
[18:04:36] <cmr> Eridius: It currently doesn't use bold, but I'm not implementing anything an ANSI terminal doesn't have
[18:04:39] <Blei> (like `fn my_func() { .. } let foo = my_func;`
[18:05:27] <strcat> moonchrome: 'int' is a word-sized int, &int is a pointer to that word-sized int, &Trait is 2 ptrs - one to the int and one to the vtable
[18:06:05] <moonchrome> strcat, oh that's nice
[18:06:10] <strcat> but with foo<T: Trait>(x: &T) and foo(&5), &T is just &int
[18:06:11] *** Joins: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP)
[18:06:20] <cmr> Eridius: although I don't really need to be checking for #colors I suppose, as long as setaf/setab are exposed
[18:06:32] <strcat> it's with foo(x: &Trait) where you have the double-pointer with one being a vtable
[18:06:34] <moonchrome> ofcourse I was just wondering where the vtable was stored once you cast to trait
[18:06:53] <moonchrome> so it gets passed arround with pointer
[18:07:19] <moonchrome> that's a cool solution actually, only pay for it if you use it
[18:07:48] *** Joins: \n_ (NDesaulnie@2557E599.66715431.D25A875A.IP)
[18:07:58] *** Quits: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP) (Ping timeout)
[18:07:59] *** \n_ is now known as \n
[18:08:10] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:08:20] <strcat> moonchrome: yep, and without having to make a whole different hierarchy just for dynamic dispatch (like C++)
[18:08:24] * strcat likes traits a lot
[18:08:36] <nmatsakis> bblum: thunk is not a type, is the key thing.
[18:08:43] <Eridius> cmr: setaf works for me in Mountain Lion with TERM set to xterm-256color.
[18:08:55] <bblum> i see
[18:09:00] <cmr> Eridius: but what about when it's just "xterm-color"?
[18:09:07] <cmr> xterm-256color was never in doubt :)
[18:09:31] *** Joins: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP)
[18:09:32] <Eridius> cmr: setaf still works
[18:09:51] <cmr> Eridius: for all 16 colors?
[18:09:53] <Eridius> although numbers > 8 don't do anything
[18:10:05] <cmr> ok, so I'm conflicted about that
[18:10:25] <Eridius> the terminal will still understand the color codes regardless of what TERM is set to, `tput setaf` just refuses to try to set anything >8 with xterm-color
[18:10:29] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[18:10:31] <cmr> oh
[18:10:45] <moonchrome> strcat, unfortunately that solution also screws me a bit :) if I want array of [Trait, .. 32] it's now 64 ptr large - which is a huge overhead :|
[18:10:58] <Eridius> cmr: well that's actually not accurate. it does try, it just does it wrong
[18:11:14] <cmr> Eridius: Mind pastebinning output of "infocmp"?
[18:11:15] <Eridius> `tput setaf 14` emits \e[314m
[18:11:19] <Eridius> which is wrong
[18:11:26] <strcat> moonchrome: well, ideally you know all the types that can be contained in advance and you can use an enum instead of a trait object
[18:11:27] <moonchrome> that is [@Trait, .. 32]
[18:11:33] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[18:11:49] <moonchrome> strcat, tried it but it also gives a size of 2 ptrs
[18:12:00] <strcat> moonchrome: if you have a ptr to the enum it won't
[18:12:05] <Eridius> cmr: https://gist.github.com/kballard/f28595a47aac57eae4a1
[18:12:05] <strcat> the enum needs a word for the tag
[18:12:18] <strcat> moonchrome: values are stored in-place in enum itself
[18:12:33] <moonchrome> yea, adding an extra indirection is a no go in this case
[18:12:41] <strcat> moonchrome: well enum isn't indirection
[18:12:47] <strcat> it's a word for a tag - no pointer
[18:12:48] <moonchrome> but pointer to enum is
[18:12:52] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[18:12:56] <strcat> moonchrome: but you seem to need a pointer to the type
[18:13:05] <moonchrome> I use i32 as bit field for flags
[18:13:09] <moonchrome> for entire array
[18:13:17] <cmr> Eridius: that's ugly :(
[18:13:31] <strcat> moonchrome: well just store the enums in-place in the array then
[18:13:37] <strcat> I don't know specifically what you need
[18:13:50] <strcat> what are the types it could be?
[18:13:53] <cmr> Eridius: Does OS X use ncurses or their own implementation?
[18:13:55] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[18:14:01] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[18:14:03] <moonchrome> strcat, pointer or int value
[18:14:14] *** Joins: jviereck (Adium@moz-B524AF31.ethz.ch)
[18:14:20] <Eridius> cmr: I have a libncurses.5.4.dylib, but I don't know whether or not that's "real" ncurses. why?
[18:14:20] <cmr> It's expanding parameterized strings incorrectly.
[18:14:25] *** Joins: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de)
[18:14:50] <Eridius> my `man ncurses` looks like a stock ncurses manpage tho
[18:15:04] <moonchrome> strcat, nvm figured it out
[18:15:18] *** Quits: aruniiird (arun@84E199D6.DCDBCF8E.83D0DF30.IP) (Ping timeout)
[18:15:48] <cmr> Eridius: what's `which tput` and what does it link to?
[18:15:54] <moonchrome> I can just enum array so enum {Values([int, ..32]), Children([Node, ..32]) }
[18:16:07] <Eridius> cmr: /usr/bin/tput, links to /usr/lib/libncurses.5.4.dylib
[18:16:07] <cmr> it looks like they use "real" ncurses though
[18:16:34] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[18:17:04] *** Parts: berak (chatzilla@18E6D8FB.BCE163C1.1A5CC7E5.IP) ()
[18:18:41] <cmr> I'm not sure which is more correct; just using setaf/setab, or actually checking what #colors is
[18:19:06] <cmr> extra::term could be reduced to 8 colors
[18:19:09] <Eridius> cmr: well setaf doesn't work properly on xterm-color for colors > 8, because it's not producing the same color sequences as xterm256-color
[18:19:09] <cmr> but meh :(
[18:20:01] <Eridius> cmr: maybe check for `TERM_PROGRAM`, which is set to "Apple_Terminal" for Terminal.app, and treat xterm-color as xterm256-color?
[18:20:07] <Eridius> err $TERM_PROGRAM
[18:20:31] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[18:20:33] <Eridius> there's also $TERM_PROGRAM_VERSION, but I don't know how far back you'd have to go to find a Terminal.app that doesn't support xterm256-color
[18:20:40] <Eridius> I certainly don't have access to an old-enough OS X installation to test
[18:20:51] <cmr> Eridius: the problem with that is there is absolutely no standard that complies too.
[18:21:05] *** Parts: stephank (stephank@FE6D378F.A6EC7F74.1E99A072.IP) (*Poof!*)
[18:21:06] <cmr> If I special case one terminal, why not special case all the broken ones?
[18:21:10] <strcat> Eridius: can you open vim and check ':set t_Co'
[18:21:24] <Eridius> cmr: Terminal isn't "broken" so much as it is just vending a limited TERM by default
[18:21:26] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[18:21:37] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[18:21:38] <strcat> Eridius: it's likely broken. I doubt it actually emulates xterm-color
[18:21:42] <strcat> vte does that crap too
[18:21:43] <Eridius> strcat: I set t_Co in my .vimrc
[18:21:45] <strcat> gnome-terminal, etc.
[18:21:49] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Quit: victorporof)
[18:21:54] <Eridius> strcat: doubt it emulates in what sense?
[18:22:10] <strcat> Eridius: it probably doesn't have an application and cursor mode, it probably doesn't output a different backspace escape on ctrl-backspace, etc.
[18:22:30] <strcat> gnome-terminal calls itself xterm but it's really not compatible
[18:22:34] <strcat> really annoys me
[18:22:38] <Eridius> I didn't know ctrl-backspace was special at all
[18:22:49] <Eridius> strcat: these terminals use xterm-color because so many apps require that to show even basic color info :/
[18:22:51] <strcat> Eridius: in xterm it is, and it deletes a word instead of a letter
[18:23:03] <strcat> Eridius: well I don't know any apps that hardcode that
[18:23:06] <Eridius> strcat: for me opt-backspace does that
[18:23:11] <strcat> they either use terminfo or match against xterm*
[18:23:16] <Eridius> strcat: I've seen many things that check if TERM is xterm*
[18:23:25] <strcat> Eridius: yeah but that's why you should do what kmscon does
[18:23:32] <Eridius> what's kmscon?
[18:23:32] <strcat> call your terminal xterm-realtermname
[18:23:37] <cmr> Heh
[18:23:38] <strcat> Eridius: just a terminal ;p
[18:23:41] <Eridius> strcat: I've also seen things use *-color (no really)
[18:23:50] <cmr> So nasty.
[18:23:51] <strcat> Eridius: xterm-osx-terminal-color
[18:23:52] <cmr> :(
[18:23:57] <strcat> at least it can have correct terminfo that way ;p
[18:24:06] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[18:24:32] <Eridius> strcat: I'm gonna file a radar suggesting exactly that
[18:24:51] *** Quits: untothebreach (paul@15A17709.47300931.30F15291.IP) (Quit: leaving)
[18:24:56] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[18:24:57] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Connection reset by peer)
[18:24:59] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Client exited)
[18:25:04] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[18:25:42] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[18:25:54] <strcat> Eridius: anyway I have strong opinions on this after dealing with so many problems from vte lying ;p
[18:26:06] <strcat> I settled on using 'xterm-termite' for my vte-based terminal
[18:26:13] <Eridius> heh
[18:27:11] <strcat> and zsh (which I use) doesn't handle application/cursor mode switching by default (which both xterm and vte do) so if you don't add a hook to do it properly, you can't use the $terminfo dict or tput to make bindings
[18:27:13] <strcat> such a pain.
[18:27:32] <strcat> bash doesn't either
[18:27:37] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:27:44] <strcat> vim/emacs do it properly :(
[18:27:48] <Eridius> what is application/cursor mode switching?
[18:28:05] <strcat> Eridius: well in the olden days you had to switch to cursor mode and use hjkl to move the cursor
[18:28:06] *** Quits: balpert (alpert@moz-B247840C.hsd1.ca.comcast.net) (Quit: balpert)
[18:28:13] <strcat> Eridius: so for compatibility, xterm has that
[18:28:17] <strcat> and vte does, for xterm compat
[18:28:24] <strcat> maybe OS X's Terminal.app does too
[18:28:24] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[18:28:40] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:28:40] <strcat> anyway, it's why people hardcode multiple escapes for bash/zsh bindings instead of using tput/$terminfo
[18:28:54] <strcat> because sometimes it goes into the other mode and the shell is *supposed* to put it back
[18:29:20] <strcat> Eridius: it's just weird. sometimes all the escapes change ;p
[18:29:53] <Eridius> ok I've filed a radar, but it's unlikely that anything will change for, oh, at least a year (assuming the owner of Terminal.app even wants to make this change)
[18:30:38] <strcat> cmr: I think you should make it work with 8 colors
[18:30:50] <Eridius> are there any other 8-color terminals you're worried about working well with?
[18:30:56] <strcat> and if there are 16 or 256, it could gracefully move to using more (if there are really that many to use)
[18:30:57] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[18:31:04] <Eridius> would it really be that terrible to detect Terminal.app and force it to assume xterm256-color?
[18:31:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:31:28] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[18:31:34] <strcat> Eridius: well vte calls itself 'xterm' so it should really work with 8 anyway
[18:31:41] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[18:31:45] <strcat> (by default it does)
[18:31:48] <Eridius> ah
[18:31:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:32:03] <strcat> rusti: 5
[18:32:03] -rusti- 5
[18:32:43] <strcat> Eridius: it's pretty sad. and terminfo is missing entries for common things like ctrl-arrows
[18:32:46] <strcat> it has shift-arrows!
[18:32:47] <Eridius> heh
[18:33:21] <strcat> Eridius: anyway it's all scary stuff. for example on linux, vim with X support will read $WINDOWID and ask X what the title of the terminal is
[18:33:30] <Eridius> hah
[18:33:35] <strcat> and if it can get a title, it will then set the title to something else
[18:33:41] <strcat> because when it exits, it can restore it
[18:34:01] <strcat> Eridius: it probably does something as bad on OS X ;p
[18:34:11] <Eridius> did you know Terminal.app has a custom escape code to set the title to a URL? This is why you see a proxy icon in the titlebar and can cmd-click it to get a menu with the current path
[18:34:24] <strcat> Eridius: yeah, vte does too (same escape)
[18:34:27] <Eridius> (it's similar to the existing xterm escapes for setting tab/window titles, but it's using an otherwise-unused number)
[18:34:49] <strcat> gnome-terminal uses it for opening a tab in the same current working directory
[18:34:59] <strcat> requires the shell or an application to tell it a url though for a dir/file
[18:35:29] <strcat> Eridius: the one for setting the window title is actually a "status bar" one
[18:35:39] <strcat> there's tsl (to status line) and fsl (from status line) to move the cursor to/from it
[18:35:42] <Eridius> strcat: it is? I found documentation on xterm escape codes and it didn't list that one
[18:35:44] <strcat> it can actually get stuck inside the title
[18:35:54] *** Quits: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com) (Ping timeout)
[18:36:04] <strcat> Eridius: only a few terminals correctly set tsl/fsl - the ncurses terminfo database sucks and doesn't seem to
[18:36:15] <strcat> vim checks tsl/fsl and falls back to hardcoded TERM checks
[18:36:19] *** Quits: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp) (Client exited)
[18:36:27] <Eridius> heh
[18:36:28] *** Joins: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com)
[18:36:54] <strcat> Eridius: it also hardcodes a check on TERM for mouse support and then queries with an escape for the xterm version :)
[18:37:10] <strcat> to decide xterm vs xterm2 vs sgr (most recent)
[18:37:22] <strcat> such a mess.
[18:37:22] <Eridius> hah
[18:37:24] <strcat> yay computers
[18:37:26] <Eridius> terminals are messy
[18:37:48] *** Quits: webber46 (webber46@moz-D5AF41D7.cust.bredband2.com) (Ping timeout)
[18:38:12] <strcat> Eridius: anyway all these terminal things I know are from dealing with various bugs/problems... ;p
[18:38:36] *** Joins: moonchrome_ (moonchrome@moz-9C2622FD.dsl.iskon.hr)
[18:38:55] *** Joins: webber46 (webber46@moz-D5AF41D7.cust.bredband2.com)
[18:38:56] <strcat> like trying to figure out why vim wasn't setting the title...
[18:39:12] <Eridius> strcat: random factoid: Terminal.app will adjust the contrast of the foreground color if you try and set foreground and background to the same thing (I filed a radar on that a while ago though)
[18:39:25] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[18:39:39] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: bye!)
[18:39:44] <strcat> vte actually lets you configure all 256 colors, in theory
[18:39:47] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[18:39:51] *** Quits: eholk (eholk@moz-4CCE9748.uconnect.utah.edu) (Quit: eholk)
[18:39:51] <strcat> but they have an off-by-one error and you can't configure the last one...
[18:39:55] <Eridius> hah
[18:39:57] <strcat> they never responded to my bug report
[18:40:23] <strcat> I don't care anyway
[18:40:39] <strcat> Eridius: and there are xterm escapes for runtime configuration of colors ;p
[18:40:45] *** Quits: vcl (chatzilla@741D4FEA.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130511120803])
[18:40:45] <strcat> all 256
[18:40:49] <mark_edward> i like Rust
[18:41:01] <mark_edward> does the standard library have JSON stuff somewhere?
[18:41:03] <Eridius> strcat: yeah, Terminal.app doesn't support them :(
[18:41:05] <Eridius> (I also filed that a while ago)
[18:41:11] <Eridius> mark_edward: yes
[18:41:18] <mark_edward> sweet!
[18:41:23] <strcat> Eridius: is iterm2 better? I haven't really used OS X much.
[18:41:40] <Eridius> mark_edward: it's on extra nÃ©e std
[18:41:47] <bblum> pcwalton: nmatsakis: https://github.com/mozilla/rust/wiki/Proposal-for-closure-reform-%28specific%29
[18:41:53] <bblum> dherman: you might also be interested ^
[18:42:05] <Eridius> strcat: I have a personal dislike for iTerm2, but it's based on many years-old reasons that have little bearing to do with functionality, so I can't actually answer that
[18:42:12] <Luqman> strcat: i prefer it just for the way it handles home/end/pg up/pg down
[18:42:17] *** Joins: SeanTAllen_ (uid4855@moz-D8B63698.irccloud.com)
[18:42:22] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: bye!)
[18:42:42] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[18:42:43] *** Joins: carter (carter@moz-BDFE46F6.nyc.biz.rr.com)
[18:42:46] *** Quits: moonchrome_ (moonchrome@moz-9C2622FD.dsl.iskon.hr) (Quit: Leaving)
[18:42:50] <strcat> well, I hate basically every terminal so I just took vte and wrapped it with some keybindings I like + url hints and I can live with it now ;p
[18:43:04] <Eridius> hah
[18:43:06] <bblum> i guess sully too ^
[18:43:06] <strcat> I used to use urxvt with a bunch of patches + perl scripts. not fun. and the perl scripts included with it like to freeze it
[18:43:49] <mark_edward> is there any documentation on how to use extra/std::serialize? I've been trying for a while now and i can't figure it out
[18:44:06] *** Quits: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[18:44:43] *** Quits: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP) (Ping timeout)
[18:44:44] <moonchrome> how do I define global constants ?
[18:45:01] <moonchrome> *module level 
[18:45:02] <mark_edward> static x: int = 5;
[18:45:09] <moonchrome> oh static, ty
[18:45:39] <strcat> Eridius: http://mosh.mit.edu/ go the section here named "Careful terminal emulation", has some more horrible things ;p
[18:45:51] <strcat> DoS vulnerabilities, broken unicode, all kinds of horrible things are widespread
[18:46:07] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Quit: leaving)
[18:46:10] *** Joins: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[18:47:01] <benh> mosh is the best
[18:47:03] <Eridius> strcat: yeah I saw that a while ago
[18:47:04] <Eridius> <3 mosh
[18:47:15] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[18:48:26] *** Joins: steveklabnik (steve@3CF97087.FBF53A67.EE512822.IP)
[18:48:34] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[18:52:45] *** Quits: Blub\w (wry@moz-A3283263.wireless.dyn.drei.com) (Ping timeout)
[18:53:07] *** Joins: Jesse_ (jruderman@2557E599.66715431.D25A875A.IP)
[18:53:14] *** Quits: Jesse (jruderman@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[18:54:18] *** Quits: carter (carter@moz-BDFE46F6.nyc.biz.rr.com) (Client exited)
[18:54:27] *** Joins: carter (carter@moz-BDFE46F6.nyc.biz.rr.com)
[18:58:28] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[18:59:33] *** Joins: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP)
[19:00:11] <Earnestly> strcat: What about your rewrite in rust and libva? :P
[19:00:11] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[19:00:29] <Earnestly> (well, not libva)
[19:00:51] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[19:00:59] <strcat> Earnestly: better things to do than dealing with terminals ;p
[19:01:25] <Earnestly> Pfft!
[19:01:58] <mcpherrin> Terminal.app has some sweet escape codes.  You should run 'curl http://csclub.uwaterloo.ca/~mmmulani/lol.cgi' in Terminal.app or iterm
[19:02:11] <mark_edward> hey, how would i go about implementing the ToJson trait for a simple struct
[19:02:21] <mark_edward> like Point { x: int, y: int}
[19:02:47] <Earnestly> strcat: But still, which library am I thinking of?
[19:02:58] <strcat> Earnestly: dunno.
[19:03:37] <sully> hm, how is it determined what tests actually run
[19:03:55] <sully> because I seem to be looking at a run-pass test that doesn't compile but isn't marked xfail?
[19:04:20] <sully> oh, nevermind
[19:04:32] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[19:04:43] <sully> where the build dumps binaries seems to have changed, so I was running a binary from last summer
[19:04:54] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[19:05:28] <Earnestly> strcat: Ah, uv. That was it
[19:05:35] * sully nukes build, does a fresh build
[19:06:54] *** Joins: balpert (alpert@moz-793B8F0F.khanacademy.org)
[19:07:13] *** Joins: Blub\w (wry@moz-A3283263.wireless.dyn.drei.com)
[19:07:27] *** Joins: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP)
[19:07:38] *** Joins: eholk (eholk@moz-4CCE9748.uconnect.utah.edu)
[19:08:18] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Ping timeout)
[19:08:19] *** Joins: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP)
[19:08:32] *** Quits: steveklabnik (steve@3CF97087.FBF53A67.EE512822.IP) (Quit: Lost terminal)
[19:08:44] *** Quits: sankha93 (Instantbir@4E59BDF6.F6D95C1.8B6C1D65.IP) (Ping timeout)
[19:09:17] *** Joins: sankha93 (Instantbir@2C26A729.BC703A9E.8B6C1D65.IP)
[19:09:24] *** Quits: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP) (Ping timeout)
[19:09:28] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[19:09:36] *** Joins: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP)
[19:09:48] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[19:09:51] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[19:11:00] *** Joins: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr)
[19:11:22] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[19:11:22] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[19:14:00] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[19:15:00] *** Quits: Blub\w (wry@moz-A3283263.wireless.dyn.drei.com) (Ping timeout)
[19:17:18] <sully> hm, so, the build currently has a ton of warnings
[19:18:21] <sully> a lot are "unnessecary unsafe blocks"
[19:18:42] <Thiez> reading the garbage-collection reddit thread, it surprises me how many people are intimidated by ~
[19:18:55] <sully> which bblum told me are because methods can't be unsafe?
[19:18:58] *** Quits: js (jeremie@moz-DCCE2247.rsr.lip6.fr) (Ping timeout)
[19:19:01] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[19:19:10] <bblum> they can be notated as unsafe
[19:19:13] <bblum> it just doesn't do anything
[19:19:15] <bblum> at the call site
[19:19:23] *** Quits: dimension (dimension@moz-4CCD79C5.dsl.dynamic.simnet.is) (Quit: Leaving)
[19:19:23] *** Quits: victorporof (victorporo@72E855D5.9A7C5F59.4A6B528C.IP) (Ping timeout)
[19:19:30] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[19:19:39] <Thiez> it's a little compiler bug
[19:19:39] <sully> is there a bug open for this?
[19:19:45] <Thiez> nothing serious, but it's kind of annoying
[19:19:52] *** Quits: KindOne (KindOne@moz-65B0B365.dynamic.ip.windstream.net) (Ping timeout)
[19:20:42] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: computer sleeping)
[19:21:07] <Thiez> sully: https://github.com/mozilla/rust/issues/6641
[19:21:31] <Thiez> oh sorry, that's the wrong one, but it links to the correct (open) bug
[19:22:15] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Client exited)
[19:22:26] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[19:22:26] *** Joins: KindOne (KindOne@moz-65B0B365.dynamic.ip.windstream.net)
[19:23:27] <sully> is there any reason this is hard?
[19:23:34] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[19:23:48] * sully hates warnings, so I want to fix this
[19:23:49] <Thiez> what is?
[19:23:58] <Thiez> it's tagged 'E-easy'? :p
[19:25:14] *** Joins: snearch (snearch@moz-491B4978.pool.mediaways.net)
[19:25:51] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[19:27:22] <moonchrome> where do I find log (math not logging) function :| I only found trait in core::num::Exponential is that implemented and how do I access it for int ?
[19:27:34] <orshem> hello rusties! :) what is &trait and ~trait? borrowed and unique traits? why would they be needed? 
[19:27:40] <orshem> If it is already summarized somewhere feel free to point me. I googled but found nothing.
[19:28:17] <Thiez> moonchrome: you could cast int to float?
[19:28:41] <sully> c.c we apparently run freevar finding twice
[19:28:44] <Thiez> and ofc 2log is fairly easy...
[19:28:55] *** Joins: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de)
[19:29:10] <moonchrome> Thiez, how do I access float log ?
[19:29:12] *** Joins: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP)
[19:29:25] <Thiez> let's find out
[19:29:30] <moonchrome> I can't find any implementation in core::num
[19:29:42] <Thiez> rusti: (10.0).log
[19:29:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/Cdbi
[19:30:01] <sully> how do you disable optimizing during builds again?
[19:30:05] <moonchrome> it's implemented in core::float
[19:30:33] <Thiez> rusti: (10.0f32).log(10.0)
[19:30:34] -rusti- 1
[19:30:39] <Thiez> well that was easy :D
[19:31:11] <Thiez> rusti: (32f64).log(2.0)
[19:31:12] *** Joins: Blub\w (wry@moz-331A9081.wireless.dyn.drei.com)
[19:31:12] -rusti- 5
[19:31:23] <moonchrome> nice ty
[19:31:37] *** Quits: jviereck (Adium@moz-B524AF31.ethz.ch) (Quit: Leaving.)
[19:31:43] <Thiez> you'll have to pick either f32, f64, or float, or it won't know which log to take :)
[19:31:54] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[19:32:11] <moonchrome> I have to explicitly cast it from int anyway :)
[19:32:20] <Thiez> fair enough
[19:32:33] <Thiez> rusti: (10 as float).log(2)
[19:32:35] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[19:32:35] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/JLMc
[19:32:38] <Thiez> rusti: (10 as float).log(2.0)
[19:32:40] -rusti- 3.32192809
[19:33:04] <Thiez> it's sad how numbers not ending in .something don't autoconvert to floats
[19:33:49] <askalski> pcwalton, hi
[19:34:58] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[19:34:59] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[19:36:30] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[19:36:33] *** Quits: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP) (Quit: \n)
[19:38:15] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[19:38:54] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[19:39:35] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[19:39:47] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[19:40:00] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[19:41:07] *** Quits: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP) (Quit: Wychodzi)
[19:42:14] *** Quits: fabiand (fabiand@moz-B5706E1E.adsl.alicedsl.de) (Quit: Verlassend)
[19:42:56] *** Joins: js (jeremie@moz-DCCE2247.rsr.lip6.fr)
[19:42:59] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[19:46:10] <Eridius> cmr, strcat: if it makes a difference, as of OS X 10.7 Terminal.app now defaults to xterm256-color, and you can't even set it to xterm-color unless you've customized the profile
[19:47:04] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[19:49:39] <moonchrome> "(node_size as float).pow((src.length as float).log(node_size as float).trunc()) as uint" yuck
[19:49:52] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[19:50:00] *** Joins: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP)
[19:50:08] <Eridius> node_size.to_float().pow(src.length.to_float).log(node_size.to_float).trunc()
[19:50:43] *** Joins: maik_ (maik@moz-C2C01F77.dip0.t-ipconnect.de)
[19:50:52] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[19:50:57] <moonchrome> do I need () after to_float on length ?
[19:51:02] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[19:51:11] <Eridius> err yeah
[19:51:27] *** Quits: sankha93 (Instantbir@2C26A729.BC703A9E.8B6C1D65.IP) (Ping timeout)
[19:51:45] *** Quits: MaikKlein (maik@moz-13F840A5.dip0.t-ipconnect.de) (Ping timeout)
[19:52:01] <moonchrome> it looks like jquery now xD
[19:52:20] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[19:52:26] *** Quits: echristo (echristo@D423593A.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[19:52:41] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[19:52:41] <moonchrome> but better than cast hell
[19:52:45] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[19:53:23] *** Joins: aruniiird (arun@84E199D6.DCDBCF8E.83D0DF30.IP)
[19:54:34] <Thiez> rusti: trait MyLog { fn log(self, Self) -> Self; } impl MyLog for int { fn log(self, n: int) -> int { (self as float).log(n as float) as int} } 5
[19:54:36] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/SeNK
[19:54:42] <Thiez> that was disappointing.
[19:54:48] <Blei> isn't this just src.length.to_float().trunc() ?
[19:54:59] <Blei> or am i mixing up my maths already?
[19:55:05] <bblum> hey sully, what are the 3 advantages to CPS conversion?
[19:55:32] *** Quits: dherman (dherman@2557E599.66715431.D25A875A.IP) (Quit: dherman)
[19:55:37] *** Joins: sankha93 (Instantbir@2C26A729.BC703A9E.8B6C1D65.IP)
[19:56:04] <moonchrome> Blei, no it's getting nearest power of N to length
[19:56:39] <moonchrome> it's for chunking a vector in to pow of N for creating hash trie
[19:57:02] <Blei> oh, i parsed the parens incorrectly
[19:57:08] <Blei> yeah, that makes more sense
[19:57:33] <moonchrome> except length should be len() :)
[19:57:47] <strcat> moonchrome: there's a next_power_of_two function in the stdlib if that's what you want (or do you want the closest, and not the next?)
[19:58:38] <moonchrome> strcat, I don't want power of two, I want power of N, because hash tries are built out of N sized buckets
[19:58:58] <moonchrome> anyway it works :)
[20:00:13] <maik_> a helpful introduction to functional programming in java from my university, maybe it will help someone http://101companies.org/wiki/Script:Functional_OO_programming
[20:01:14] <moonchrome> functional programming in Java sounds very masochistic 
[20:01:32] <maik_> :D
[20:01:35] <maik_> it is
[20:01:43] *** Joins: eschweic (Adium@43CB6079.66715431.D25A875A.IP)
[20:03:23] *** Joins: echristo (echristo@24D1937F.D6CCE4AE.77834EAA.IP)
[20:06:33] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[20:07:26] *** Quits: eschweic (Adium@43CB6079.66715431.D25A875A.IP) (Quit: Leaving.)
[20:09:46] <kimundi> orshem: ~Trait etc are for dynamic dispatch
[20:10:31] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[20:11:23] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:11:34] <kimundi> orshem: If you cast a ptr to some type to a ptr to a trait it implements you get a fat ptr consisting of (ptr to data, vtable)
[20:12:10] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[20:12:30] <kimundi> rusti: .5
[20:12:31] -rusti- foo.rs:10:9: 10:10 error: unexpected token: `.`
[20:12:31] -rusti- foo.rs:10          .5
[20:12:31] -rusti-                    ^
[20:12:32] -rusti- application terminated with error code 101
[20:12:38] <kimundi> rusti: 5.
[20:12:40] -rusti- 5
[20:12:40] *** Quits: js (jeremie@moz-DCCE2247.rsr.lip6.fr) (Ping timeout)
[20:14:23] *** Quits: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net) (Ping timeout)
[20:15:54] <engla> rusti: ~3 as ~Integer
[20:15:55] -rusti- error: internal compiler error: unexpected failure
[20:15:55] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[20:15:55] -rusti- note: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues
[20:15:55] -rusti- application terminated with error code 101
[20:16:20] *** Joins: \n (NDesaulnie@2557E599.66715431.D25A875A.IP)
[20:17:21] *** Joins: \n_ (NDesaulnie@43CB6079.66715431.D25A875A.IP)
[20:17:39] *** Quits: sankha93 (Instantbir@2C26A729.BC703A9E.8B6C1D65.IP) (Ping timeout)
[20:18:14] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:18:15] *** \n_ is now known as \n
[20:19:43] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[20:19:59] *** Quits: eholk (eholk@moz-4CCE9748.uconnect.utah.edu) (Quit: eholk)
[20:19:59] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[20:21:47] *** Quits: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP) (Ping timeout)
[20:21:57] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:21:59] *** Joins: arcterus (arcterus@moz-8B0B939D.mycingular.net)
[20:22:11] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:22:11] *** ChanServ sets mode: +o brson
[20:22:14] *** Joins: eholk (eholk@moz-4CCE9748.uconnect.utah.edu)
[20:22:22] *** Quits: arcterus (arcterus@moz-8B0B939D.mycingular.net) (Client exited)
[20:22:40] *** Joins: \n (NDesaulnie@2557E599.66715431.D25A875A.IP)
[20:24:12] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[20:24:49] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (Ping timeout)
[20:24:55] <joelteon> o boi
[20:25:08] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[20:25:10] <joelteon> rusti: ~3 as Integer
[20:25:12] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[20:25:12] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/aJPd
[20:25:44] <engla> you must cast to a trait using either & or ~
[20:25:45] <engla> or @
[20:25:50] <engla> (I think @ works)
[20:25:51] *** Quits: aruniiird (arun@84E199D6.DCDBCF8E.83D0DF30.IP) (Ping timeout)
[20:26:48] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[20:27:39] *** Joins: vcl (chatzilla@741D4FEA.76F9E272.DA40C4B3.IP)
[20:28:02] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[20:28:40] <joelteon> but that causes a compiler error
[20:28:57] <Eridius> rusti: ~3 as ~Integer
[20:28:59] -rusti- error: internal compiler error: unexpected failure
[20:28:59] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[20:28:59] -rusti- note: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues
[20:28:59] -rusti- application terminated with error code 101
[20:29:01] <Eridius> wheeee
[20:29:25] *** Joins: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net)
[20:31:43] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[20:31:43] <sully> hm, there is a import that gets reported as a unused import
[20:31:43] <sully> but removing it causes infinite errors
[20:31:49] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Quit: Computer has gone to sleep.)
[20:32:42] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[20:34:19] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[20:35:12] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[20:35:13] *** Joins: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP)
[20:36:55] <nmatsakis> sully: were you asking about unsafe methods? pcwalton had a PR on that, I tihnk it's waiting to be rebased
[20:37:15] <sully> oh, yeah
[20:37:28] <sully> I hate warnings and was trying to make a bunch of them go away
[20:37:33] <sully> but if he's already fixed that one, great
[20:37:44] *** Quits: maik_ (maik@moz-C2C01F77.dip0.t-ipconnect.de) (Ping timeout)
[20:37:54] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[20:39:07] <orshem> kimundi: Thanks
[20:39:35] *** Quits: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[20:39:54] *** Quits: \n (NDesaulnie@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:40:39] <sully> ok, how long is a full build expected to take?
[20:40:45] *** Joins: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP)
[20:40:58] <strcat> a wild guess -> 15 mins for LLVM, 20 mins for rust
[20:40:59] *** Joins: kermie (Mibbit@moz-E89B7C5B.range109-154.btcentralplus.com)
[20:41:17] <sully> ok; what are the partial build targets?
[20:41:25] <strcat> I haven't timed the full build, I know the stages take ~5-6 mins each for me and there are 3
[20:42:02] <strcat> sully: well if you have to build LLVM I don't think you'll save much time cutting out a stage
[20:42:05] <strcat> relatively
[20:42:11] <jdm> sully: make rustc-stage1
[20:42:15] <moonchrome> what was the syntax to initialize a vector of ints with n elements sequence,  [1..128] won't work
[20:42:23] <strcat> [1, ..128]
[20:42:31] <sully> no, llvm is already built
[20:42:35] <moonchrome> ty
[20:42:36] <kermie> how could i go from a &mut [] to ~[] without any copying of the elements?
[20:42:39] <sully> also, arg, something is super bogus with imports
[20:42:42] <Luqman> if you're changing something and can test with a stage1 rustc, configuring with disable-optimize speeds it up a bit
[20:42:56] <strcat> kermie: you can't
[20:42:57] <sully> there are imports that generate "unused import" warnings that are not unused
[20:43:08] <strcat> kermie: unless you have alternate elements you can swap in to replace the old ones
[20:43:17] <strcat> &mut [T] doesn't own the elements/vector
[20:43:26] <strcat> so it can't move out, can only copy or swap out
[20:43:49] <kermie> i see, T would always be Option, so i could swap the values for None
[20:44:06] <kermie> but i can only use the swap function with &mut variables
[20:44:11] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[20:44:23] <strcat> kermie: you can do &mut xs[i]
[20:44:32] *** Joins: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr)
[20:44:41] <strcat> replace(&mut xs[i], None)
[20:45:49] *** Quits: pyrac (pyrac@moz-96C2FD1F.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[20:45:51] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[20:46:02] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[20:46:23] <sully> pcwalton: is resolve complaining about bogus "unused imports" a known problem?
[20:46:32] <kermie> thank you that worked strcat :)
[20:46:39] *** Joins: \n_ (NDesaulnie@2557E599.66715431.D25A875A.IP)
[20:46:40] <strcat> kermie: np
[20:47:04] *** Quits: \n (NDesaulnie@43CB6079.66715431.D25A875A.IP) (Ping timeout)
[20:47:04] *** \n_ is now known as \n
[20:47:25] <mark_edward> how are enums and matching on enums done in rust?
[20:47:42] <mark_edward> are there type tags or vtables or something?
[20:48:05] <strcat> you mean how is it implemented?
[20:48:31] <strcat> it has a union with the max align/size and a type tag
[20:49:03] <strcat> except for a certain case where you have a non-raw pointer and a unit variant, which is optimized to a nullable pointer
[20:49:05] <moonchrome> error: use of undeclared module `vec` when I use vec::const_slice, vec isn't automatically imported ?
[20:49:28] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Ping timeout)
[20:49:44] *** Joins: jviereck (Adium@moz-8397F963.ethz.ch)
[20:49:49] <mark_edward> strcat: thanks for the info
[20:50:03] <mark_edward> can you think of sites with a good JSON api?
[20:50:22] <EXetoC> moonchrome: not anymore I think. check prelude.rs
[20:50:25] <mark_edward> i was looking at reddit, but the whole "Thing" thing plus the API docs are trash
[20:51:06] <EXetoC> they shrank it quite a lot a couple of days ago
[20:52:08] <moonchrome> can someone help me out - what do I need to import to make this compile : https://gist.github.com/moonchrome/5709465
[20:52:46] *** Quits: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:53:12] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:53:13] <EXetoC> use std::uint; use std::vec;
[20:53:23] <moonchrome> note core ?
[20:53:26] <EXetoC> or the actual symbols, and get rid of vec:: for example
[20:53:34] <EXetoC> not if you got incoming
[20:53:47] <EXetoC> core was renamed to std, and std to extra
[20:54:05] <moonchrome> oh that's why it didn't work :)
[20:54:38] *** Joins: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP)
[20:54:39] *** ChanServ sets mode: +o pcwalton
[20:54:58] *** Quits: Jesse_ (jruderman@2557E599.66715431.D25A875A.IP) (Quit: Jesse_)
[20:55:45] *** eevee_ is now known as eevee
[20:57:28] <mark_edward> how come trait bounds aren't allowed in struct definitions
[20:57:35] <mark_edward> that'd be pretty useful
[20:57:55] <mark_edward> like a struct Point<T: Num> { x: T, y: T}
[20:59:41] <kimundi> mark_edward: Well the reason is that they don't mean anything in a struct definition
[21:00:15] <mark_edward> What do you mean? I'd figure that they would limit template instantion
[21:00:27] <mark_edward> to only types that meet those bounds
[21:00:36] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[21:00:57] <kimundi> mark_edward: You can already limit the bounds in impl blocks
[21:00:58] *** Joins: Jesse (jruderman@2557E599.66715431.D25A875A.IP)
[21:01:29] <kimundi> struct Foo<T>(int) impl<T: Num> Foo<T> { ... }
[21:02:31] <mark_edward> but wouldn't people still be able to instantiate say, a Foo<~str>
[21:02:32] <mark_edward> ?
[21:02:44] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Ping timeout)
[21:03:27] <kimundi> mark_edward: Yeah, but they wouldn't be able to invoke it's methods. They could only use it as a plain data storage.
[21:03:50] <strcat> mark_edward: they can't if it has a private field
[21:04:09] <mark_edward> Alright, I guess that makes sense. i still feel it be nice to be able to
[21:04:09] <strcat> private field -> you can't construct it without calling a public constructor fn
[21:04:13] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[21:04:18] *** Joins: Jesse_ (jruderman@2557E599.66715431.D25A875A.IP)
[21:04:20] <mark_edward> in the declaration of a template struct
[21:04:30] *** Quits: Jesse (jruderman@2557E599.66715431.D25A875A.IP) (Ping timeout)
[21:04:34] <mark_edward> limit what types it can take on
[21:04:57] <kimundi> mark_edward: IT can be nice, but it can also be annoying
[21:05:17] <kimundi> mark_edward: Because it means checking two different blocks for trait bounds
[21:05:18] *** Joins: deepdog (deepdog@moz-490E834C.client.mchsi.com)
[21:05:35] <mark_edward> I see what you mean
[21:05:42] *** Quits: jviereck (Adium@moz-8397F963.ethz.ch) (Quit: Leaving.)
[21:05:47] <kimundi> mark_edward: And if you'r consistent with them you always write the same bounds twice
[21:05:51] <mark_edward> but wouldn't the compiler tell you anyway if you messed up
[21:06:50] *** Joins: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca)
[21:07:35] <kimundi> mark_edward: If you mess up, sure. But you don't need to mess up to be confused by type declarations :P
[21:08:14] <mark_edward> yeah. you language people think of everything.
[21:09:08] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[21:09:17] <kimundi> It's also about readability, docs etc... If trait bounds can only appear on impl blocks and functions that's easier to understand than also having them on types. People only need to check one place etc
[21:11:06] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[21:12:10] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:12:51] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[21:16:15] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[21:16:29] *** Quits: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca) (Ping timeout)
[21:18:36] <sully> pcwalton: ping
[21:19:37] *** Joins: eschweic (Adium@43CB6079.66715431.D25A875A.IP)
[21:21:35] *** Quits: deepdog (deepdog@moz-490E834C.client.mchsi.com) (Ping timeout)
[21:21:41] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Input/output error)
[21:21:58] *** Joins: mleise (marco@moz-3468AB5B.pools.arcor-ip.net)
[21:22:04] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[21:22:06] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[21:24:24] *** Quits: reyre_ (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[21:24:41] *** Joins: Ralith (ralith@moz-46459329.wireless.sfu.ca)
[21:24:45] *** Joins: eschweic1 (Adium@2557E599.66715431.D25A875A.IP)
[21:25:49] *** Quits: eschweic (Adium@43CB6079.66715431.D25A875A.IP) (Ping timeout)
[21:27:10] <bstrie> nmatsakis: if it's onerous writing Sized everywhere, could it possibly be inferred? I'm still hoping that DST's not too good to be true :)
[21:27:17] *** Quits: sk (sk@EA324BFE.54A580E3.78DD174B.IP) (Quit: Leaving)
[21:27:47] <nmatsakis> bstrie: there are options, I'm writing up a blog post about the idea I had, but I'm still not sure that it's that big a deal outside of container code
[21:27:58] *** Quits: mattin (user@E8F297A5.DC7A989C.7F8AB798.IP) (Ping timeout)
[21:28:16] <bblum> yeah, i was thinking last night i it might be interesting to try sizedifying librustc
[21:28:44] <bblum> get an idea for how bad it is on code that's clientside, that doesn't need as many polymorphic functions
[21:29:10] <bstrie> bblum nmatsakis: I think it's also constructive to think of this from the other direction... "today we have to write Sized on all of our generic containers, but we can remove that restriction by making ~[T] and ~str special-cased in the compiler with their own semantics"
[21:29:49] <bblum> i don't understand what that achieves?
[21:30:20] *** Joins: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca)
[21:30:30] <bstrie> bblum: to see if you'd make the same decision. basically to see if the merit to the current situation is based on inertia or if it's because it's a truly good idea
[21:30:51] <bstrie> i.e. if we already had DST, would we want to remove it?
[21:30:58] <bstrie> I dunno, just a thought experiment :)
[21:31:06] <bblum> i would want to remove it ;)
[21:32:14] *** Joins: maik_ (maik@moz-C2C01F77.dip0.t-ipconnect.de)
[21:32:23] *** Quits: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca) (Ping timeout)
[21:32:53] <maik_> offtopic: do you know any programming related shows / youtube channels?
[21:32:54] *** Joins: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca)
[21:33:40] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[21:33:49] <bblum> bstrie: i think there are some obvious use cases, such as nested DSTs inside of structs, but all of them have the scary potential of emitting complicated code in trans to determine the size of a type
[21:34:12] <bblum> the rule "a DST can only occur as the last element of a struct or enum, and never as a vector element" might simplify matters
[21:34:22] <bblum> i just don't think it's a thing our language needs.
[21:34:30] <kermie> what's the syntax for a closure with no parameters?
[21:34:37] <maik_> ||
[21:34:43] <kermie> thanks
[21:34:44] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[21:35:09] <bblum> nmatsakis: btw, based on this morning's meeting, i drafted a concise version of what i think closures should become; did you see?
[21:36:04] *** Joins: dherman (dherman@2557E599.66715431.D25A875A.IP)
[21:36:04] *** ChanServ sets mode: +o dherman
[21:36:13] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[21:36:39] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[21:37:13] *** Quits: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com) (Ping timeout)
[21:37:24] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[21:37:34] <nmatsakis> bblum: yes, I read it. I prefer fn& and fn~, still weighing my overall opinion
[21:37:41] *** Quits: raze (raze@moz-4E6675AF.bredband.comhem.se) (Quit: rebooting)
[21:37:50] <bblum> nod
[21:37:56] *** Joins: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com)
[21:38:11] <bblum> i like fn~ too as it turns out :P
[21:38:31] *** Quits: Ralith (ralith@moz-46459329.wireless.sfu.ca) (Ping timeout)
[21:38:34] <bblum> i guess i thought ~fn would be more appealing to everyone, but perhaps not
[21:38:37] *** Joins: Ralith (ralith@moz-46459329.wireless.sfu.ca)
[21:39:36] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[21:40:17] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[21:40:28] <bblum> i also quite like the idea of needing pointer sigils on heap closure values
[21:40:35] <bblum> spawn ~{ ... }
[21:40:58] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Ping timeout)
[21:41:04] *** Joins: jgilbert (jgilbert@2557E599.66715431.D25A875A.IP)
[21:41:12] <bblum> it will both solve the horrible inference situation we have today, and follow the "no allocation unless you see a sigil" rule
[21:42:15] <bblum> i guess there's a possible ambiguity if you wanted to create a ~&fn, but you could write ~(|| ...) for that
[21:42:43] *** Joins: mattin (user@F4FAB1DA.DC7A989C.7F8AB798.IP)
[21:44:50] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Ping timeout)
[21:45:27] *** Quits: SingingBoyo (brandon@moz-547E4132.wifi.ubc.ca) (Ping timeout)
[21:45:35] <kimundi> bblum: How about do spawn ~env { ... } ?
[21:45:37] *** Joins: Jesin (Jessin_@D04ED9AA.1AFF763C.DAC4D86A.IP)
[21:45:53] <bblum> what does that mean?
[21:46:27] *** Joins: raze (raze@moz-4E6675AF.bredband.comhem.se)
[21:46:36] *** Quits: Ralith (ralith@moz-46459329.wireless.sfu.ca) (Ping timeout)
[21:46:43] <kimundi> Nevermind
[21:47:28] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: computer sleeping)
[21:48:30] <bjz> Luqman: got it down to a small test case: https://github.com/mozilla/rust/issues/6936
[21:50:19] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[21:51:01] <bjz> pcwalton: any idea what might be up with this? https://github.com/mozilla/rust/issues/6936
[21:51:24] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[21:52:34] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[21:52:58] <pcwalton> hmm, maybe we should just forbid having a mod with the same name as a type
[21:53:08] <pcwalton> they're in the same namespace
[21:53:14] *** Joins: barosl (barosl@1E71221E.C81E10FB.7544CABF.IP)
[21:54:44] <bjz> :(
[21:54:54] <pcwalton> use "impl" instead
[21:55:02] <pcwalton> but that won't work with a typedef
[21:55:16] <bjz> was looking for a workaround
[21:55:20] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[21:55:42] <pcwalton> well, it's incompatible with what we want to do for typedefs
[21:55:43] <bjz> it's weird it works in-crate though
[21:55:51] <bjz> mmk
[21:55:56] <pcwalton> have them inherit methods from their impls
[21:56:05] <bjz> yup
[21:56:20] <bjz> I'll add a comment that says they should be forbidden
[21:56:26] <pcwalton> ok
[21:56:27] <moonchrome> how do I move a owned box to a managed one ?
[21:56:30] <bjz> what title should I make it?
[21:56:31] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[21:57:01] <bjz> "should forbid type aliases and mods of the same name in the same mod?
[21:58:18] *** Joins: tjc (tjc@36B3FF50.4D3A0C06.43B20542.IP)
[21:58:18] *** ChanServ sets mode: +o tjc
[21:58:51] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[21:59:29] <bjz> pcwalton: done https://github.com/mozilla/rust/issues/6936
[21:59:31] <moonchrome> or a better question would be how do I get vec::with_capacity to return a @ instead of ~
[21:59:31] <sully> pcwalton: niko said you might have a patch pending to fix unsafe methods? is that correct?
[21:59:41] <pcwalton> sully: they should be fixed
[21:59:43] <pcwalton> I thought I landed that.
[21:59:55] <sully> it might just be wrong in stage0, hm
[22:00:01] <pcwalton> yeah, it's wrong in stage0.
[22:00:06] <sully> there are still tons of unused unsafe warnings during compile
[22:00:17] <pcwalton> yeah, during stage0 there will be a ton
[22:00:38] * sully trying to clean up most warnings
[22:00:43] <sully> there are some that are confusing me
[22:00:52] <pcwalton> https://github.com/mozilla/rust/commit/aeda178011775f4a8e16446341fe4774e02d8f5f
[22:01:02] <sully> there is an import in std.rc that seems necessary in stage0 but unused in other stages
[22:01:50] *** Joins: Voomer (Voomer@moz-E97E8EB7.br.br.cox.net)
[22:02:37] <Thiez> uh, I just built a new version of rust and suddenly all the impls in std::unstable::atomics are private?
[22:03:44] <Thiez> did something change about pub/priv?
[22:03:48] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[22:04:13] *** Quits: echristo (echristo@24D1937F.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[22:05:07] <bjz> Thiez: not sure about those impls, but it's best practice not to have impls as pub
[22:05:26] <bjz> Thiez: and mark visibility on the individual methods
[22:05:52] <bjz> Thiez: I think pcwalton was going to forbid it, not sure if it's been done yet though
[22:06:04] <bjz> (pretty sure that it landed though)
[22:06:08] <pcwalton> bjz: it hasn't been done yet due to backwards compat issues
[22:06:11] <pcwalton> err
[22:06:14] <bjz> ahh ok
[22:06:17] <pcwalton> sorry, pub extern hasn't been done yet
[22:06:22] <pcwalton> pub impl has but has not landed due to a test failure.
[22:06:40] <Thiez> ok, so by default the fns in an impl are priv?
[22:06:47] <bjz> aye
[22:06:59] <bjz> makes more sense too
[22:07:00] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:07:09] <bjz> seeing as trait impls are private too
[22:07:15] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:07:17] <Thiez> is there an issue about that?
[22:07:19] <bjz> *must be* private
[22:07:31] <bjz> there is a pull, as mentioned above
[22:07:33] <Thiez> since there will be parts of std that will break with this change
[22:07:36] <Thiez> until they get fixed :D
[22:07:43] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[22:07:51] <bjz> yeah, well the pull fixes all those things
[22:08:03] <bjz> otherwise it wouldn't pass the tests :)
[22:08:03] <Thiez> ok, nice
[22:08:12] <Thiez> yes, but it's already broken it for me :p
[22:08:22] <Thiez> I think the test pass because they're in the file ;)
[22:08:25] <Thiez> tests*
[22:08:25] <bjz> oh, might be a different issue
[22:08:33] <bjz> not sure
[22:08:40] <mark_edward> there is no function overloading by argument type
[22:08:41] <mark_edward> ?
[22:08:47] <bjz> no
[22:08:51] <mark_edward> :-(
[22:08:54] <bjz> you can fake it though
[22:08:58] <Thiez> no, if the atomic types have no tests apart from #[test] fns in the same file, then this issue may escape notice :)
[22:09:01] <mark_edward> how so
[22:09:16] <bjz> mark_edward: if you're willing to jump though hoops
[22:09:24] <mark_edward> now really
[22:09:27] <mark_edward> not
[22:09:43] <mark_edward> I just want 2 different new functions for a Point struct
[22:09:51] <bjz> mark_edward: https://gist.github.com/bjz/6c5e7e72fbb43d9c8361
[22:09:54] <mark_edward> one with no args that zeroes both fields
[22:09:55] <bjz> I know
[22:10:01] <mark_edward> and one with
[22:10:02] <mark_edward> oh ok
[22:10:10] <bjz> yeah, that's tricky
[22:10:22] <bjz> Point::zero()
[22:10:24] <Thiez> I'm jumping through hoops right now :(
[22:10:29] <bjz> Point::new()
[22:10:37] <bjz> Point::from_value()
[22:10:43] <maik_> "there is no function overloading by argument type" What? I have done it several times, but not tested though :x
[22:10:49] <Thiez> "I don't usually use malloc/free in Rust, but when I do, it's even more of a pain in the behind than in C" :D
[22:10:50] <bjz> is analogous to what I have
[22:11:04] <bjz> sorry: Point::new(x,y,z)
[22:11:12] <bjz> Point::from_value(v)
[22:11:50] <bjz> the same technique demonstrated in the gist above allows you to do multiple operator overloads
[22:11:55] *** Joins: a_m0d (a_m0d@moz-9F925EFA.hm.shawcable.net)
[22:12:02] <mark_edward> i see
[22:12:10] <bjz> but of course it limits what numeric types can be used
[22:12:20] <bjz> to what the lib author specifies
[22:13:06] <bjz> tbh I find it easier to use separate methods
[22:13:21] <bjz> and it seems to be more rustic
[22:14:15] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[22:14:29] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[22:14:29] <bjz> I have big doubts as to whether mothod overloading will ever be added. forbidding it increases code clarity, but also decreases espressiveness
[22:14:36] <bjz> rust leans to the former
[22:14:37] <maik_> rusti: struct Test; impl Test {fn print(&self){println("Hello");}	fn print(&self, i: int){println(fmt!("%?"i));} Test.print();
[22:14:38] <bstrie> I still miss default arguments sometimes, but I agree that it's often no more painful to just use separate methods
[22:14:39] -rusti- foo.rs:11:5: 11:6 error: incorrect close delimiter: `)`
[22:14:39] -rusti- foo.rs:11     }));
[22:14:39] -rusti-                ^
[22:14:39] -rusti- application terminated with error code 101
[22:15:30] <maik_> what
[22:15:31] <tikue> rusti: let foo = ~"a"; println(foo);
[22:15:33] -rusti- a
[22:15:33] -rusti- ()
[22:15:51] <tikue> rusti: let foo = ~"a"; "a" == foo
[22:15:54] -rusti- true
[22:16:04] <bjz> bstrie: It would be nice if that could be added. I won't speak for the devs, but I'm guessing it would have to be post 1.0 (already so much to do!)
[22:16:58] <tikue> rusti: let foo: ~str = "a"; foo == "a"
[22:17:00] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/hCQg
[22:17:07] <Thiez> rusti: use std::unstable::atomics::AtomicInt; let x = AtomicInt::new(0); "Succes"
[22:17:09] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HEei
[22:17:30] <tikue> rusti: let foo: ~str = "a"; ~"a" == "a"
[22:17:31] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DGJh
[22:17:43] <bjz> maik_, mark_edward: you can do it via macros, but you can't have method syntax then
[22:17:45] <bstrie> bjz: yeah, I'm a little worried about missing out on nice APIs for the stdlib but there are sooo many more important things to do
[22:17:46] <SiegeLord> I find method overloading more clear than default arguments
[22:17:54] <mark_edward> yeah, i understand
[22:18:04] <tikue> rusti: let foo: ~str = ~"a";
[22:18:05] <maik_> yeah 
[22:18:05] -rusti- ()
[22:18:10] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:18:22] <maik_> didn't know that, I thought it would work because it compiled fine :(
[22:18:23] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[22:18:31] <maik_> thanks
[22:18:45] <bjz> maik_, mark_edward: you also can't export macros, but hopefully that will be fixed
[22:19:07] <bjz> as always, much to do :)
[22:19:15] <bjz> but rust keeps getting better!
[22:19:24] <SiegeLord> It seems like they are in the middle of redesigning a big part of it
[22:19:26] <bjz> every day!
[22:19:27] <strcat> bjz: there's #[macro_escape] though, isn't there
[22:19:36] <bjz> strcat: that's in-crate
[22:19:40] <strcat> ah
[22:19:42] <maik_> SiegeLord, u mean the @ thingy?
[22:19:48] <SiegeLord> I love that they are eager to cut features though
[22:19:57] <bjz> would be nice to have pub macro_rules! ( ... )
[22:20:07] <SiegeLord> maik_, @, sized types, fn/proc
[22:20:16] <SiegeLord> All of those seem like gigantic changes
[22:20:17] *** Quits: doomlord (doomlod@moz-3CF8202D.range81-159.btcentralplus.com) (Ping timeout)
[22:20:27] <bjz> SiegeLord: they cut features, but manage to have something even better in their place :)
[22:20:32] <maik_> don't know about sized types, fn/proc yet
[22:21:02] * sully submits a pull request cleaning up a bunch of build warnings
[22:21:07] <bjz> SiegeLord: it's kinda crazy how they do it, hehe
[22:21:13] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[22:21:23] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[22:21:23] *** ChanServ sets mode: +o brson
[22:21:31] <bblum> sully: not the unsafe block ones right
[22:21:38] <sully> not those, no
[22:21:39] <SiegeLord> bjz, Crazy in what sense?
[22:22:12] *** Quits: carter (carter@moz-BDFE46F6.nyc.biz.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[22:22:13] <bjz> SiegeLord: they cut things, but there's almost always a better thing in its place
[22:22:20] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[22:22:26] <SiegeLord> Ah... yes
[22:22:44] <bjz> Or something that is simplified, but becomes more expressive in the process
[22:22:45] <SiegeLord> Very smart people those folks are
[22:23:31] <SiegeLord> Had to look up what "affine types" were today ._.
[22:23:34] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[22:23:49] <bjz> affine types?
[22:23:55] <maik_> I only know what affine transformations are :p
[22:24:15] <strcat> bjz: the type theory name for a type that moves ownership
[22:24:23] <bjz> ahh
[22:24:23] <SiegeLord> I know! I was like... "types you can rotate, scale, skew and translate? :3"
[22:24:28] <bjz> :)
[22:24:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:24:35] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/teJGSg
[22:24:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:24:35] <maik_> :D
[22:24:37] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:24:37] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/NQw3EA
[22:24:37] <ghrust> 13rust/06auto 14240e898 15Michael Sullivan: Clean up a bunch of build warnings.
[22:24:37] <ghrust> 13rust/06auto 14c0cbbc2 15bors: auto merge of #6937 : msullivan/rust/no-warnings, r=catamorphism
[22:24:37] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:24:42] <bjz> silly CS/Mathematics overloading terms
[22:25:03] <bjz> no wonder we don't have method overloading :)
[22:25:11] <strcat> bjz: and symbols.
[22:25:17] <bjz> it should all be one giant namespace
[22:25:33] <maik_> welcome to the world of c
[22:25:33] <bjz> :)
[22:25:37] <maik_> not
[22:25:37] <strcat> bjz: c11 has overloading and no namespaces
[22:25:38] <bjz> indeed!
[22:25:39] <strcat> :D
[22:25:41] <strcat> _Generic
[22:25:45] *** Joins: doomlord (doomlod@moz-3CF8202D.range81-159.btcentralplus.com)
[22:25:54] <bjz> no, link all da repos together!
[22:26:03] <bjz> first come first served!
[22:26:21] <maik_> c11 has no namespaces?
[22:26:23] <strcat> they added it so tgmath (a bad idea) could be written in standard C
[22:26:24] <maik_> what
[22:26:27] <strcat> maik_: C, not C++
[22:26:31] <maik_> ah
[22:26:50] <sully> was just about to comment on my pull request saying "oops, doesn't fix as many warnings as I thought, wait on this", but it looks like it already got handled
[22:26:54] <strcat> _Generic is like a really crippled typeof operator
[22:26:58] <strcat> *really* crippled
[22:28:55] *** Quits: jack (jack@8ABE2BFB.9F8380A1.A535BD55.IP) (Quit: Leaving.)
[22:29:01] <sully> oh, wait, nevermind, I was running make check on the wrong branch
[22:31:08] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[22:32:08] <maik_> what was a map doing again? transforming a list to another list?
[22:32:31] <moonchrome> I can't figure out how to move the ~[] in to @[], in this code : https://gist.github.com/moonchrome/5710188#file-gistfile1-rs-L26
[22:33:04] <strcat> moonchrome: requires a copy of the full thing
[22:33:15] <strcat> there's something like to_managed
[22:33:55] <moonchrome> strcat, but I can't mark Node enum as copyable because one value is a owned pointer ?
[22:34:23] <Luqman> maik_: basically, takes a list of type T and gives back one of type U by applying a function which transforms each individual T to a U
[22:35:19] <sully> hm, there are unnecessary unsafe blocks warnings showing up after stage1
[22:35:23] <moonchrome> when I add #[deriving(Clone)] on it it gives me an error
[22:35:44] <strcat> moonchrome: are the types is it Clone'able?
[22:36:23] <moonchrome> strcat, you mean T ? do I need to constrain it on enum declaration ?
[22:36:51] <bblum> moonchrome: use vec::consume and at_vec::build
[22:36:54] <strcat> well I don't know what error you're getting, or where
[22:37:21] <bblum> do at_vec::build |push| { do owned_vector.consume |element| { push(element) } }
[22:37:29] *** aatch|gone is now known as aatch
[22:37:51] <bblum> you might need to put the owned_vector inside a Cell to get it into the at_vec::build body, since we don't have once fns
[22:38:02] <bblum> (nmatsakis, there's another instance of once ;) )
[22:38:23] *** Quits: jdm (jdm@DB05BBF2.BB1F48F2.971E19F6.IP) (Quit: Lost terminal)
[22:39:02] *** Quits: webber46 (webber46@moz-D5AF41D7.cust.bredband2.com) (Quit: webber46)
[22:39:05] <mark_edward> if you are using One::one() in a context where the type isn't clear
[22:39:11] <mark_edward> how do you clarify the type?
[22:39:18] <strcat> One::one::<T>()
[22:39:21] <mleise> so.. when will @ be replaced by a library solution? ;)
[22:39:21] <strcat> or
[22:39:22] <mark_edward> One<int>one()?
[22:39:22] <moonchrome> strcat, here's the error : https://gist.github.com/moonchrome/5710188
[22:39:24] <mark_edward> oh ok
[22:39:29] <strcat> let x: T = One::one()
[22:39:48] <sully> there is something super bogus with the unsafeness checker right now
[22:39:57] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[22:40:07] <bblum> ur super bogus
[22:40:46] *** Quits: tjc (tjc@36B3FF50.4D3A0C06.43B20542.IP) (Quit: zzzzzzzzzz)
[22:41:32] <maik_> :D
[22:41:47] <aatch> mleise, there is no guarentee that it will...
[22:43:50] <mleise> aatch: I hoped to start a flame war about it. but this answer is too diplomatic
[22:43:58] *** Joins: tjc (tjc@36B3FF50.4D3A0C06.43B20542.IP)
[22:43:58] *** ChanServ sets mode: +o tjc
[22:43:59] *** Quits: maik_ (maik@moz-C2C01F77.dip0.t-ipconnect.de) (Ping timeout)
[22:45:35] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[22:45:42] <Thiez> mleise: when they pry it from my cold dead hands! :p
[22:45:52] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[22:46:30] <bjz> mark_edward: hopefully that will be fixed in the future
[22:46:49] <mark_edward> the function template notation thing?
[22:46:58] <bjz> https://github.com/mozilla/rust/issues/6894
[22:47:00] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[22:47:22] <bjz> ie. T::zero()
[22:47:31] <bjz> or float::zero()
[22:47:38] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[22:47:38] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[22:47:54] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[22:48:13] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:48:15] *** Joins: martndemus (martndemus@moz-FAE8D24A.sshunet.nl)
[22:48:48] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[22:49:24] <bjz> mark_edward: where would that notation be useful?
[22:49:44] <mark_edward> do you know C++
[22:49:50] <bjz> mark_edward: ie. do you have use cases?
[22:49:53] <mark_edward> yes
[22:49:59] <bjz> mark_edward: having those would be handing
[22:50:02] <bjz> *handy
[22:50:04] <mark_edward> the best one is one i can show you
[22:50:06] <mark_edward> on github
[22:50:11] <mark_edward> but it's in C++
[22:50:12] <bblum> pcwalton: what if a library solution for @ pointers came with the ability to write #[lang="@"] so code that used them could look the same?
[22:50:19] <bblum> is that feasible?
[22:51:01] <strcat> I thought the point was mostly to make you consider whether you wanted reference counting or gc
[22:51:04] <jclements> bblum: how about having @ be another form of macro?
[22:51:12] <bjz> mark_edward: sure
[22:51:22] <mark_edward> https://github.com/MarkJr94/argparser
[22:51:23] <bblum> jclements: one written without "!"?
[22:51:26] <mark_edward> check the readme
[22:51:37] <jclements> bblum: sure. 
[22:51:42] <mark_edward> but the template argument decides how the stored string is interpreted
[22:51:52] <jclements> bblum: of course, my secret evil plan is to get rid of the ! entirely.
[22:51:59] <strcat> bblum: it would be nice to be able to write a generic persistent data structure letting the caller supply the smart pointer type, etc.
[22:52:08] *** Quits: mattin (user@F4FAB1DA.DC7A989C.7F8AB798.IP) (Ping timeout)
[22:52:09] <bblum> jclements: why don't you like !?
[22:52:11] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[22:52:11] <mark_edward> bjz: check the asserts in the readme
[22:52:23] <bjz> mark_edward: I see
[22:52:24] <strcat> jclements: you can have ? ;p
[22:52:31] <bjz> mark_edward: are they static methods?
[22:52:36] <strcat> is_this_a_bad_idea?(probably)
[22:52:37] <pcwalton> bblum: yes, it is possible.
[22:52:53] <mark_edward> nno, the options are all stored internally as a map<string,string>
[22:53:04] <mark_edward> and it uses the c++ stringstream stuff
[22:53:04] <bjz> mark_edward: ahhs
[22:53:19] <jclements> bblum: how about this: it makes Matthew Flatt nervous.
[22:53:34] <bjz> mark_edward: not sure how that would work in rust
[22:53:43] <bjz> mark_edward: is it done at compile time?
[22:53:51] <mark_edward> yes
[22:53:58] <bblum> strcat: that sounds like it would need kind polymorphism; impl <P1: Pointer, P2: Pointer, K, V> HashMap<P1<K>,P2<V>>
[22:54:03] <bblum> jclements: i don't know who that is...
[22:54:24] <bblum> (mind you, "assert!(foo)" makes me nervous, but)
[22:54:24] *** Quits: martndemus (martndemus@moz-FAE8D24A.sshunet.nl) (Broken pipe)
[22:54:25] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[22:54:32] <jclements> bblum: honestly, it's probably a longer story than makes sense on IRC. I'll tell you about it some other time.
[22:54:48] <bblum> i see
[22:55:00] <Luqman> jclements: does it remind him of mutation in racket?
[22:55:09] <bjz> nmatsakis: I added a post to that issue, would be good to hear your thoughts, if you have time
[22:55:11] <jclements> Luqman: no, not at all.
[22:56:03] <mark_edward> bjz: so if i wrote parser.get_as<double>("joe") it would try and read the string value at the "joe" key as a double
[22:56:12] <jclements> Luqman: well, okay, I'll summarize.  About three months ago, I described the current setup to him, and his immediate comment was that he thought that the distinguished macro syntax might cause problems with macros-expanding-into-macros-mumble. That's *very* hand-wavy, I know.
[22:56:43] <kimundi> Hmm, how about this: Turn @ into generic allocation shortcut. let foo = @Gc Foo // == Gc<Foo>; let mufoo = @GcMut Foo // == GcMut<Foo>
[22:56:50] <Thiez> r? https://github.com/mozilla/rust/pull/6941 anyone? it's a trivial change :)
[22:57:07] <Thiez> but rather useful
[22:57:20] <bjz> mark_edward: I'm sort of talking *specifically* about the One::one() thing
[22:57:46] <bjz> mark_edward: I guess the cros-language thing is tricky
[22:57:51] <mark_edward> oh ok. but i think being able to specify template arguments to function calls would be nice
[22:57:52] <kimundi> You'd keep the nice ptr-prefix look, but you'd still need to write the concroto type it's talking about
[22:58:00] <mark_edward> maybe my use case is obscure
[22:58:04] <kimundi> concrete*
[22:58:16] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: caitp)
[22:58:18] <bjz> mark_edward: I think mine is slightly different
[22:58:53] *** Joins: alisdair (textual@moz-ED11BF4B.bc.hsia.telus.net)
[22:59:07] <kimundi> Would also read nice: @Gc Foo => "Foo allocated at GarbageCollector"
[22:59:10] <mark_edward> i agree it is
[22:59:25] <bjz> mark_edward: I'm more talking where an associated function is defined in a trait, then accessed for another type
[22:59:35] <bjz> mark_edward: like with One::one
[22:59:43] <mark_edward> bjz: i know, and that is a separate issue
[22:59:50] <bjz> mark_edward: yeah
[22:59:53] <bjz> sorry!
[23:00:32] *** Quits: wuwei (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Ping timeout)
[23:00:39] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:00:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c0cbbc2 to 1469511c2: 02http://git.io/N3iJvQ
[23:00:40] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:00:43] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:00:43] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JNgAng
[23:00:43] <ghrust> 13rust/06auto 1461ac5fd 15Daniel Micay: clone: fix docstring...
[23:00:43] <ghrust> 13rust/06auto 14c75c11a 15bors: auto merge of #6939 : thestinger/rust/clone, r=catamorphism...
[23:00:43] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:02:44] <mark_edward> bjz:  but it could enable things like this is what i mean:
[23:02:45] <mark_edward> https://gist.github.com/MarkJr94/5710367
[23:03:09] <mark_edward> the example is obviously contrived
[23:03:09] <bjz> mark_edward: ooh, we can do that
[23:03:22] <bjz> empty_vec::<int>();
[23:03:42] <mark_edward> oh really! i didn't know
[23:03:44] <illissius> kimundi: imo (1) there should be a "one true garbage collector" in the standard library in any case to avoid fragmentation (2) if we're removing GC from the language itself it should be used an opportunity to simplify the syntax (3) if we're *not* simplifying the syntax, @ should belong to the one true garbage collector.
[23:03:49] <illissius> counterarguments? :)
[23:04:10] *** Quits: tjc (tjc@36B3FF50.4D3A0C06.43B20542.IP) (Quit: zzzzzzzzzz)
[23:04:19] *** Quits: pragmatic (pragmatic@moz-1A421840.hsd1.ca.comcast.net) (Ping timeout)
[23:05:02] <illissius> *as an
[23:05:16] <Thiez> strictly speaking they wouldn't be 'counterarguments' as you only provided statements, not arguments ;)
[23:05:38] <bjz> mark_edward: but things like that would probably be better off as static methods
[23:05:45] <strcat> illissius: counter-argument is that shared-ownership is usually an anti-pattern and shouldn't have syntax reserved for it ;p, and also gc is only good for when you copy them around a lot or actually have cycles
[23:05:46] *** Quits: Jesin (Jessin_@D04ED9AA.1AFF763C.DAC4D86A.IP) (Ping timeout)
[23:06:09] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: Computer has gone to sleep.)
[23:06:26] <mark_edward> that example is contrived but the use case in my option parser isn't so simple
[23:06:30] <bjz> mark_edward: the point of contention is how to access those methods
[23:06:38] <strcat> refcounting will perform better if you only make a few long-lived copies and you don't give up deterministic cleanup (but you do give up static mutability, with RcMut)
[23:06:39] <mark_edward> right
[23:07:24] <strcat> anyway I don't really care. as long as the 90% of the stdlib works without the rust runtime
[23:07:53] <Thiez> I like the idea of having built-in GC and wouldn't like the @-syntax to change
[23:08:42] <strcat> syntax that stops working when you aren't using the runtime
[23:08:54] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[23:09:06] <Thiez> I also think the point 1, 2, and 3 of the familiarity argument are pretty lame :p
[23:09:11] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[23:09:32] <Thiez> lots of our syntax will look unfamiliar to people coming from languages such as java
[23:09:55] <Thiez> strcat: but you're going to be using the runtime most of the time anyway
[23:10:09] <Thiez> and I think we even have a lint-check to forbid GC
[23:10:12] <strcat> Thiez: only if I want rust's scheduler for tasks and async I/O
[23:10:36] *** Quits: jclements (jclements@2557E599.66715431.D25A875A.IP) (Quit: jclements)
[23:10:52] <strcat> otherwise I'm better off without the runtime (at least the scheduler), it's extra baggage and makes rust unusable outside of late-userspace
[23:11:00] *** Joins: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP)
[23:11:24] <strcat> early userspace doesn't have /dev/urandom and /proc so rust doesn't work
[23:11:33] <Thiez> I agree writing stuff like device drivers and operating systems in rust would be pretty damn awesome
[23:11:41] <strcat> or kernel modules...
[23:11:44] <strcat> or early boot stuff
[23:11:52] <kimundi> illissius: I guess what I'm saying here is that one thing I wouldn't like about removing @T and replacing it with Gc<T> is that actually using and reading it would become more cumbersome, but if you keey @ as syntactic sugar in combination with whatever else is planned to make Gc<T> as good as todays @ it wouldn't look much different from now. @Gc T and @GcMut T would be the build-in std lib Garbagecollector, but you'd be able to write @Rc
[23:11:52] <kimundi>  T, @ARC T etc... it would no longer be special. 
[23:11:57] <pcwalton> we probably don't want to use the rust GC in the script task in servo.
[23:11:58] <strcat> or baremetal applications or stuff for embedded OSes without RNG
[23:12:04] <pcwalton> otherwise there will be two GCs
[23:12:12] <pcwalton> I would rather just use the SpiderMonkey GC
[23:12:23] *** Joins: echristo (echristo@D423593A.D6CCE4AE.77834EAA.IP)
[23:14:18] <strcat> you also really don't want to the scheduler/runtime around in a sandbox
[23:14:28] <strcat> they make a lot of system calls
[23:14:33] <strcat> and touch the fs
[23:14:46] <strcat> want the*
[23:14:47] *** Quits: sam1 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.0)
[23:14:56] <kimundi> pcwalton: What do you think of the idea to transform @ into syntactic sugar in case Gc gets moved in the std lib? '@Gc T' == 'Gc<T>'
[23:15:00] <pcwalton> mmm, whatever sandbox we use for servo wants the runtime
[23:15:26] <pcwalton> kimundi: I'm not personally crazy about the syntax but I would be OK with it if everyone really wants it
[23:15:45] <pcwalton> probably it would just be that @ is a special syntax for the Gc lang item
[23:16:06] <aatch> pcwalton, similar case for the project me, bjz and dbaupp have been working on, rusp. I'm fairly sure we will need to implement our own GC for it since I'm not sure how we would leverage Rust's
[23:16:26] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[23:16:57] <pcwalton> in Servo @ is only really wanted for the flow tree (what servo calls the RenderObject tree in WebKit)
[23:17:04] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:17:13] <pcwalton> and the RenderBoxes
[23:17:17] *** Joins: sam1 (sam@moz-ADDDDFB1.mc.videotron.ca)
[23:17:17] <pcwalton> almost everything else is ~
[23:17:22] <pcwalton> or SpiderMonkey GC
[23:17:23] <strcat> pcwalton: well, depends on the kind of sandbox
[23:17:28] <bblum> in rustc basically everything is a @ though
[23:17:35] <strcat> but if you just want to have read/write/close/exit_group
[23:17:52] <aatch> bblum, to be fair, some of that is legacy
[23:17:56] <strcat> for running untrusted code and not needing a whole linux root for it
[23:18:03] <pcwalton> the overuse of @ in rustc is mostly legacy, the AST and types still want to be @
[23:18:08] <pcwalton> but there's way too much overuse of @ in resolve
[23:18:13] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[23:18:13] <illissius> kimundi: right, I understand that. I guess I would rather remove the sigil than repurpose it in that way. making library solutions less second-class is great in principle, but OTOH within a single application, presumably people won't be mixing many different garbage collection solutions on even footing, rather they'd have one which they use the vast majority of the time and the rest sporadically. so it probably makes more sense to have @ 
[23:18:15] <illissius> rebindable as a lang-item
[23:18:15] <pcwalton> and that's because the other pointer types were buggy at the time
[23:19:39] <illissius> i.e. it's probably a bigger win to have @T for the 80% case and Foo<T> for the 20% than @Foo T and @Bar T for both..
[23:19:41] *** Joins: wuwei (wuwei@AEB9B9C2.818D7924.FAA9ED67.IP)
[23:20:02] * illissius shuts up
[23:20:21] <strcat> I doubt you want @ for 80% of the cases of shared ownership though
[23:20:28] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[23:20:52] <strcat> unless you have to pass it around by-value a lot it's not the right choice
[23:21:02] <aatch> I'm not too bothered as to the exact syntax, I would just like auto-deref and auto-borrow
[23:21:12] <Thiez> strcat: r+? https://github.com/mozilla/rust/pull/6941
[23:21:18] <kimundi> pcwalton, My thinking was that '@T U' becomes 'T<U>' (maybe only allowed for specially marked 'memory allocation' types). Todays @ and @mut would become @Gc and @GcMut, but you'd just as well have @Rc and @RcMut, @Arc, etc... Basically a generic way to keep the less-heavy 'ptr-prefix' syntax of today.
[23:22:34] <aatch> kimundi, I like that idea
[23:23:04] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[23:23:10] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Connection reset by peer)
[23:23:21] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[23:23:32] <Thiez> strcat: thanks! :)
[23:24:06] <Thiez> I need that to land to get a lock-free messagequeue-thingy working
[23:24:17] *** Joins: lahwran (lahwran@lahwran.net)
[23:24:37] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:24:40] <bblum> kimundi: i believe that would make parsing dependent on whether the token following the @ is a Type or is a Type->Type.
[23:25:20] <bblum> oh, i take that back, @Type simply wouldn't be valid
[23:25:37] *** Joins: tjc (tjc@moz-1C95A3D9.tmodns.net)
[23:25:37] *** ChanServ sets mode: +o tjc
[23:25:44] <kimundi> bblum: Yeah, It would be either @T U or nothing
[23:26:12] <bblum> i think it would be confusing to anybody who wasn't familiar with the rusts of the past.
[23:27:22] <pcwalton> hmm, it's an interesting idea, I'm not sure what I think at first :)
[23:28:28] <kimundi> Well it wouldn't just be to look like today. Tha syntax in combination with langitems would also allow such types to be treated more like a regular ptr without it looking too strange
[23:29:01] <kimundi> Like, &*(@Gc Foo) to borrow a &Foo
[23:29:41] <aatch> Thiez, I implemented a lock-free work-stealing deque for the scheduler
[23:29:51] <aatch> though it hasn't been merged yet
[23:29:52] <Thiez> aatch: I will cry myself to sleep tonight.
[23:30:09] <Thiez> gratz btw :p
[23:30:18] <aatch> Thiez, is that what you were doing it for?
[23:30:42] <Thiez> oh, no, I was doing the MessageQueue
[23:30:53] <Thiez> but I think they can pretty much share the implementation, right?
[23:31:00] <sully> hm, apparently my warning fixes caused a test failure
[23:31:01] <sully> grum
[23:31:09] <aatch> I don't think so, the WSQueue is pretty one-directional
[23:31:33] <cmr> sully: the tests test that compiler warnings work
[23:31:40] <aatch> the owner pushes and pops, other threads only deque
[23:31:48] <cmr> sully: see src/tests/compile-fail
[23:31:58] <toddaaro> aatch: is your deque code up up somewhere?
[23:32:18] <bblum> hey, are destructors still totally broken if code inside of them fails?
[23:32:31] <aatch> I apparently didn't push it, I'll push it now, though it's a little out-of-date
[23:32:34] <bblum> (that is, failure when running a destructor during unwinding due to a first failure)
[23:32:40] <aatch> (as in pre-renaming)
[23:33:07] <aatch> https://github.com/Aatch/rust/blob/par-deque/src/libcore/rt/work_queue.rs
[23:33:12] *** Quits: raze (raze@moz-4E6675AF.bredband.comhem.se) (Quit: Nighty night.)
[23:33:45] *** Quits: Jesse_ (jruderman@2557E599.66715431.D25A875A.IP) (Quit: Jesse_)
[23:35:23] <bblum> wait, why fn finalize(&self) and not fn finalize(self)?
[23:35:28] <bblum> the latter seems strictly better
[23:35:36] <Thiez> aatch: nice, it is indeed completely different
[23:35:36] <strcat> bblum: because it would recurse forever without hacks
[23:35:41] <strcat> bblum: it should be by-value
[23:35:50] <Thiez> I can still do the messagequeue it seems :)
[23:35:53] <strcat> there's an open bug
[23:35:59] <aatch> Thiez, I assume MessageQueue is a regular queue?
[23:36:00] <bblum> strcat: seems worth hacking
[23:36:04] <bblum> i see, it's just not implemented
[23:36:07] <strcat> bblum: also &self is really bad since 95% of destructors are mutating it
[23:36:19] <strcat> with transmute, or by annotating the FFI fns wrong
[23:36:22] <Thiez> aatch: yes, but the current version uses locks
[23:36:27] <bblum> strcat: grossssss
[23:36:32] <bblum> that's so bad
[23:36:45] <bblum> there's no reason it couldn't even be &mut self
[23:37:14] <aatch> so you don't need to worry about one end emptying the queue while the other is trying get an element
[23:37:18] <aatch> which is nice.
[23:37:20] <kimundi> strcat: Renaming all cell.take() calls to cell.take_out() takes forever :/
[23:37:53] <bblum> oh good, we can build empty structs nowadays
[23:38:27] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[23:38:28] *** ChanServ sets mode: +o brson
[23:38:30] <strcat> bblum: EmptyStruct{}?
[23:38:42] <kimundi> rusti: struct Foo;
[23:38:43] -rusti- ()
[23:38:49] <kimundi> rusti: struct Foo; Foo
[23:38:51] -rusti- {}
[23:38:53] <strcat> oh
[23:38:58] <bblum> yeah, with a nice error message too
[23:38:59] <bblum> error: Unit-like struct should be written as `struct Foo;`
[23:39:14] <bblum> nicely resolves the parse ambiguity with do foo { }
[23:39:23] <strcat> rusti: use std::sys::size_of; struct Foo; (size_of::<()>(), size_of::<Foo>())
[23:39:23] -rusti- (0, 0)
[23:39:31] <aatch> bblum, been able to do that for a while.
[23:39:37] <bblum> good!
[23:39:38] <bblum> c.c
[23:39:49] <bblum> ok, so yeah, failing in destructors is still totally broken
[23:40:05] <bblum> what do y'all think of using effects to forbid failure in destructors? :O
[23:41:36] *** Quits: eschweic1 (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[23:42:16] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[23:42:26] *** Joins: maik_ (maik@moz-C2C01F77.dip0.t-ipconnect.de)
[23:42:27] *** Quits: alisdair (textual@moz-ED11BF4B.bc.hsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:45:25] <Thiez> good luck with that
[23:45:38] <Thiez> especially with unsafe destructors
[23:45:52] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[23:46:19] *** Quits: dherman (dherman@2557E599.66715431.D25A875A.IP) (Quit: dherman)
[23:46:29] <strcat> bblum: sounds good to me, but won't pretty much everything have to be marked as potentially failing? ;p
[23:46:55] <strcat> or I guess you can use #[nofail] as an assertion and only add it on stuff that's needed
[23:46:58] <bblum> strcat: effects will be inferred in general
[23:47:08] <strcat> bblum: ah
[23:47:14] <strcat> bblum: so it'll just bubble it up
[23:47:15] <bblum> yes, trait Drop { #[wont(Fail)] fn finalize(...); }
[23:47:33] <strcat> bblum: what about at the API boundary of a crate? seems like it should be explicit
[23:47:52] <bblum> it's a funny question... rntz brought it up a while ago
[23:47:57] <bblum> it would not be required to make the syntax work
[23:48:02] <bblum> er, to make the system work
[23:48:11] <strcat> yeah, but required if you don't want the API to change without touching the signature
[23:48:36] * strcat shrugs
[23:48:50] <bblum> i have an idea for how to write effect annotations to be explicit about what functions do and don't do
[23:49:12] <bblum> but my goal is not to force people to worry about effect annotations if they don't want to reason about effects
[23:49:18] <bblum> make the system unobtrusive and all
[23:49:28] <maik_> can someone give me an example with fold like this [1,2,3,4].fold()
[23:50:06] <bblum> strcat: it would be needed for stuff like: #[trustme(wont(Fail))] fn divide_unless_zero(x: int, y: int) -> Option<int>
[23:50:59] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().fold(0, |a, b| a + *b)
[23:50:59] -rusti- 10
[23:51:36] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[23:51:36] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:51:36] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/JNgAng
[23:51:36] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:51:47] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().take_while(|x| *x < 4).fold(0, |a, b| a + *b)
[23:51:48] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/EMLe
[23:51:56] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().take_while(|&x| *x < 4).fold(0, |a, b| a + *b)
[23:51:56] -rusti- 6
[23:52:05] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[23:52:14] * strcat still has to remove old_iter :|
[23:52:20] <strcat> not going to be fun
[23:52:31] <eholk> wow, there's a rusti bot in IRC now. That's awesome!
[23:52:41] <eholk> rusti: 1 + 2
[23:52:42] -rusti- 3
[23:52:50] <strcat> eholk: yep, I made https://github.com/thestinger/playpen for it
[23:52:55] <heftig> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().take(3).fold(0, |a, b| a + *b)
[23:52:56] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DjbL
[23:53:08] <eholk> strcat: nice!
[23:53:09] <strcat> heftig: take/drop hit a type inference bug
[23:53:16] <maik_> strcat, thanks
[23:53:21] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().take(3).fold(0, |a, b: &int| a + *b)
[23:53:22] -rusti- 6
[23:53:36] <strcat> heftig: no idea why {take,skip}_while doesn't :|
[23:54:07] <heftig> strcat: how'd you build an iterator providing the fibonacci sequence?
[23:54:34] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:54:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/zab9xg
[23:54:34] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:54:53] <strcat> heftig: you basically have to put the state in a struct, and then implement Iterator, which is next(&mut self) -> Option<T>
[23:54:57] <maik_> rusti: use std::iterator::*; let xs = [1, 2, 3, 4]; xs.iter().take(3).fold(0, |a, b: &int| a + 10)
[23:54:58] -rusti- 30
[23:55:06] <strcat> we can eventually have magic like C# to compile a function to a state machine
[23:55:08] <strcat> one day!
[23:55:45] <EXetoC> 1.0!
[23:56:08] <heftig> hm.
[23:56:36] <maik_> strcat, is "a" the type of the vector?
[23:56:50] <strcat> maik_: it's the type of the accumulator
[23:56:56] <strcat> &int is the type yielded by VecIterator
[23:57:04] <strcat> (for [int])
[23:57:47] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[23:58:00] *** Joins: SimonSapin (simon@5924A8D9.7F79A810.4065847B.IP)
[23:58:00] <maik_> ah ok found the signature fn foldr<'a, T, U>(v: &'a [T], mut z: U, p: &fn(t: &'a T, u: U) -> U) -> U
[23:58:08] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[23:58:11] <strcat> maik_: well that's the old one
[23:58:14] <strcat> that will probably go away
