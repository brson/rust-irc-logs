[00:59:33] *** Quits: eddyb (eddyb@moz-ure.pug.25.188.IP) (Ping timeout: 121 seconds)
[01:10:50] *** Joins: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP)
[01:23:38] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[01:32:59] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Connection closed)
[01:34:49] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[01:36:39] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Connection closed)
[01:38:05] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[01:39:56] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Connection closed)
[01:41:21] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[01:45:06] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[02:08:59] *** Quits: zz_kimundi (kimundi@moz-sorbkk.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:09:58] *** Joins: zz_kimundi (kimundi@moz-9cad15.dip0.t-ipconnect.de)
[02:09:59] *** zz_kimundi is now known as kimundi
[02:26:00] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[02:30:23] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[02:37:05] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[02:41:21] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[02:51:41] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[02:56:05] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[03:09:47] *** Joins: p1start (p1start@moz-nftjhe.org)
[03:27:22] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[03:32:11] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[03:36:22] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[03:46:44] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[03:50:57] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[03:58:52] <aatch> Ooo, I just noticed the `T-*` labels on github, I assume they're "Team" labels? I assume that ICE's are fair game to tag with `T-compiler?
[03:59:08] <cmr> aatch: sounds fair.
[03:59:31] <aatch> Not sure what other team would be responsible for compiler errors.
[03:59:40] <cmr> right.
[04:00:19] <aatch> I wasn't paying that much attention, I'm guessing the language team is more about language features and the like?
[04:00:31] <cmr> Yeah, that's my thought.
[04:01:20] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[04:02:11] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[04:05:33] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[04:15:55] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[04:20:10] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[04:24:36] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[04:28:52] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[04:39:12] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[04:43:26] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[04:53:44] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[04:58:00] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[05:02:28] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[05:08:21] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[05:12:34] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[05:22:54] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[05:27:08] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[05:36:01] *** Quits: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP) (Connection closed)
[05:41:59] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[05:48:05] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[05:51:42] *** Joins: eddyb (eddyb@moz-ure.pug.25.188.IP)
[05:52:37] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[05:56:26] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:56:51] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[06:06:24] *** Quits: eddyb (eddyb@moz-ure.pug.25.188.IP) (Quit: Konversation terminated!)
[06:06:30] *** Joins: eddyb (eddyb@moz-ure.pug.25.188.IP)
[06:07:10] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[06:11:26] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[06:16:26] *** kimundi is now known as zz_kimundi
[06:25:21] *** Joins: p1start (p1start@moz-nftjhe.org)
[06:29:18] *** Quits: eddyb (eddyb@moz-ure.pug.25.188.IP) (Ping timeout: 121 seconds)
[06:30:25] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[06:34:40] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[06:36:37] *** zz_kimundi is now known as kimundi
[06:45:01] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[06:49:16] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[06:59:35] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[07:02:49] *** Joins: doener (bs@moz-c061a3.saltation.de)
[07:03:49] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[07:14:10] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[07:18:22] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[07:21:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:25:07] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[07:28:44] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[07:32:53] *** Joins: Ms2ger (Ms2ger@moz-0smvhf.isp.belgacom.be)
[07:32:57] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[07:43:18] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[07:47:23] *** Quits: achanda_ (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:47:34] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[07:57:53] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[08:02:07] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[08:12:28] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[08:16:42] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[08:18:00] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[08:19:02] *** Joins: p1start (p1start@moz-nftjhe.org)
[08:27:02] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[08:31:16] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[08:41:38] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[08:45:52] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[08:56:09] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[09:00:25] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[09:10:44] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[09:15:00] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[09:25:20] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[09:29:32] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[09:33:32] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[09:39:52] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[09:44:08] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[09:54:29] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[09:58:43] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[10:09:02] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[10:13:18] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[10:23:38] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[10:27:51] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[10:34:20] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[10:38:11] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[10:39:03] *** Joins: sigma (sigma@moz-llrbra.range86-135.btcentralplus.com)
[10:42:25] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[10:52:47] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[10:57:00] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[11:07:20] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[11:11:34] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[11:21:57] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[11:26:10] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[11:34:34] *** kimundi is now known as zz_kimundi
[11:36:29] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[11:40:44] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[11:51:05] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[11:55:18] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[12:03:06] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[12:05:38] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[12:07:55] *** zz_kimundi is now known as kimundi
[12:09:53] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[12:20:14] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[12:22:53] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[12:24:27] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[12:26:15] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[12:26:15] *** ChanServ sets mode: +o pnkfelix
[12:34:49] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[12:39:01] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[12:43:32] *** Quits: Ms2ger (Ms2ger@moz-0smvhf.isp.belgacom.be) (Ping timeout: 121 seconds)
[12:49:23] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[12:52:25] *** kimundi is now known as zz_kimundi
[12:52:34] *** zz_kimundi is now known as kimundi
[12:54:56] *** kimundi is now known as zz_kimundi
[12:55:01] *** zz_kimundi is now known as kimundi
[12:57:59] *** Joins: eddyb (eddyb@moz-ure.pug.25.188.IP)
[13:27:24] *** kimundi is now known as zz_kimundi
[13:32:29] *** zz_kimundi is now known as kimundi
[13:54:44] *** kimundi is now known as zz_kimundi
[14:07:16] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:25:08] <doener> pnkfelix: hm, the multi-drop thing is tricky. 
[14:25:29] <pnkfelix> doener: I haven't gotten very deep into it yet
[14:25:48] <doener> pnkfelix: oh, then let me share my findings
[14:27:00] <doener> pnkfelix: the thing is triggered by "let x = &y.0;". y.0 is the "Drop" contained in the container, and the whole &y.0 expression goes through trans_addr_of, which translates y.0 into an lvalue, which means that cleanup is scheduled for it
[14:27:24] <doener> I didn't get any further than that either though
[14:35:50] <eddyb> does this happen with named fields?
[14:37:45] <pnkfelix> eddyb: you can replicate it with named fields, yes
[14:38:11] <pnkfelix> eddyb: but I think an unsized type is a necessity
[14:39:07] <eddyb> taking the address of an unsized field is broken? I remember it's special-cased, at least
[14:40:39] <eddyb> welp https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/expr.rs#L728
[14:41:13] <eddyb> that's creating a Trait rvalue when accessing a field with type Trait
[14:41:14] <pnkfelix> yeah that's no good
[14:41:48] <eddyb> unsized lvalues are rvalues containing a pointer to an lvalue
[14:42:13] <eddyb> so a potential fix would be to turn the rvalue into an lvalue datum here https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/expr.rs#L733
[14:42:35] <eddyb> doener: does this help?
[14:43:37] <doener> eddyb: I don't think so...
[14:44:09] <eddyb> ("turn" by creating a new LvalueExpr datum with scratch.{val, ty})
[14:44:12] <pnkfelix> eddyb: the rvalue_scratch_datum that's created there, what kind of cleanup is it going to have associated with it?
[14:44:28] <pnkfelix> eddyb: or wait, do I have this backwards...
[14:44:40] <eddyb> DST rvalues are weird
[14:44:53] <eddyb> (I am honestly not sure)
[14:44:55] <doener> eddyb: the thing is that y.0 is a &Drop, so "*y.0" is a Drop. And for "&y.0" we get into trans_addr_of which translates "y.0" as an lvalue, scheduling cleanup for it, which is wrong.
[14:45:09] <eddyb> doener: but y.0 *is* an lvalue
[14:45:18] <doener> eddyb: sorry, it translates *y.0 as an lvalue
[14:45:42] <eddyb> wait, right
[14:45:59] <eddyb> doener: so I found a different issue?
[14:46:05] <doener> no wait, just &y.0
[14:46:26] <eddyb> I forget if the tuple struct holds a DST or a fat pointer to one
[14:46:50] <eddyb> converting an rvalue to lvalue will cause issues if that rvalue is actually owned by something else
[14:47:20] <doener> which is the case here. 
[14:48:06] <eddyb> so does my suggestion of creating a new LvalueExpr datum out of the rvalue scratch one, actually change anything?
[14:49:59] <doener> eddyb: oh, you mean manually creating a datum with that kind, not using create_lvalue_scratch_datum? That might work, yeah
[14:50:09] <doener> not sure about the implications that has though
[14:50:33] <eddyb> doener: yeah, because AFAIK both rvalue and lvalue unsized datums are rvalues holding the fat pointer
[14:51:38] <doener> eddyb: would basically make it act the same as https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/expr.rs#L2301 right?
[14:52:06] * eddyb is wondering whether ThinLTO aka http://article.gmane.org/gmane.comp.compilers.llvm.devel/85628 improves link times when using LTO
[14:52:47] <eddyb> doener: huh, that comment is confusing
[14:53:13] <eddyb> *x has to always return an lvalue
[14:54:12] <eddyb> doener: sheesh, *box x returns an rvalue
[14:57:26] <eddyb> (
[14:57:32] <doener> eddyb: trying your suggestion now. Check the other side of the if, and that also always goes for an lvalue datum, so ...
[14:57:48] <doener> eddyb: yeah, that micro opt is linked to another bug
[14:57:59] <eddyb> I may have reported that other bug :P
[14:58:42] <eddyb> doener: IMO field access and derefs should return Datum<Lvalue>
[14:59:16] <doener> eddyb: yup, that fixes it
[14:59:28] *** zz_kimundi is now known as kimundi
[15:08:30] <doener> eddyb: shall I prepare a PR later?
[15:08:47] <doener> eddyb: or do you want to do it yourself?
[15:08:50] <eddyb> go ahead, I'm not here for long
[15:09:22] <doener> ok
[15:11:33] <eddyb> I'm not sure whether a DST rvalue actually makes sense, maybe there should be an assert denying that case so we get ICEs instead of exploitable bugs
[15:13:38] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Quit: leaving)
[15:32:29] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[16:02:49] *** Quits: doener (bs@moz-c061a3.saltation.de) (Quit: leaving)
[16:11:43] *** Quits: sigma (sigma@moz-llrbra.range86-135.btcentralplus.com) (Ping timeout: 121 seconds)
[16:25:42] *** Joins: eddyb_ (eddyb@moz-ure.pug.25.188.IP)
[16:28:50] *** Quits: eddyb (eddyb@moz-ure.pug.25.188.IP) (Ping timeout: 121 seconds)
[16:39:02] *** Joins: doener (doener@moz-929cn9.unity-media.net)
[16:45:15] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Ping timeout: 121 seconds)
[16:53:26] *** Quits: eddyb_ (eddyb@moz-ure.pug.25.188.IP) (Connection closed)
[17:04:07] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[17:17:13] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[17:32:30] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:32:30] *** ChanServ sets mode: +qo brson brson
[17:48:21] *** Joins: Ms2ger (Ms2ger@moz-15i.9ho.190.193.IP)
[17:52:50] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[18:25:09] *** Joins: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de)
[18:51:11] *** Quits: Manishearth (manishearth@moz-8puj7k.net) (Ping timeout: 121 seconds)
[19:00:04] <nmatsakis> hmm
[19:00:17] <nmatsakis> so I rebased eddyb's const fn branch
[19:00:22] <nmatsakis> but it seems there are no tests..nor ever were?
[19:00:42] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[19:01:04] <nmatsakis> ah well, guess I'll make some
[19:10:10] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[19:10:11] *** ChanServ sets mode: +o pnkfelix
[19:31:55] *** Joins: manishearth (manishearth@moz-8puj7k.net)
[19:32:16] *** Quits: manishearth (manishearth@moz-8puj7k.net) (Quit: Ruh roh)
[19:34:08] *** Joins: manishearth (manishearth@moz-8puj7k.net)
[20:05:41] *** ChanServ sets mode: +ao manishearth manishearth
[20:09:33] *** Quits: Ms2ger (Ms2ger@moz-15i.9ho.190.193.IP) (Ping timeout: 121 seconds)
[20:13:52] *** ChanServ sets mode: +a pnkfelix
[20:28:20] *** Joins: Rym (y@moz-2p7.rc2.38.217.IP)
[20:45:26] *** Quits: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de) (Quit: Bye)
[20:56:23] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[20:56:25] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[21:57:50] *** Quits: nmatsakis (nmatsakis@moz-no0.93r.245.63.IP) (Ping timeout: 121 seconds)
[22:22:33] *** Joins: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP)
[22:30:46] *** Joins: nrc (nrc@moz-9luh02.xtra.co.nz)
[22:30:46] *** ChanServ sets mode: +qo nrc nrc
[22:55:58] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:04:33] *** kimundi is now known as zz_kimundi
[23:08:33] *** Quits: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP) (Ping timeout: 121 seconds)
[23:08:42] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[23:09:42] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[23:17:06] *** Joins: aatch (james@moz-8r6eer.orns.ubhm.e000.2406.IP)
[23:25:18] *** Joins: nmatsakis (nmatsakis@moz-no0.93r.245.63.IP)
[23:25:19] *** ChanServ sets mode: +o nmatsakis
[23:31:29] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.5.1)
