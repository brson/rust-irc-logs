[03:42:40] <acrichto> retrying ABI now
[05:57:39] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:57:42] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:13:16] *** Parts: [o__o] (~o__o@moz-24EBFAC7.me) ()
[10:17:40] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[10:23:38] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Ping timeout)
[10:26:21] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[10:56:56] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:56:57] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:59:14] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:59:15] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[11:22:50] <Seldaek> cmr: what'up with the json changes?
[11:23:07] <cmr> Seldaek: rustdoc_ng segfaults for mysterious reasons
[11:24:02] <cmr> I'll try on newest master
[11:24:16] <Seldaek> ok not cool 
[11:28:00] <dbaupp> cmr: the ABI thing landed btw (you probably noticed already)
[11:29:01] <cmr> I did not notice!
[11:29:22] <cmr> yay things happening while I sleep <3
[11:56:46] <cmr> Ok, it works now!
[11:56:49] <cmr> Yay!
[11:58:00] <dbaupp> no segfaults?
[11:58:07] <cmr> nope
[11:58:15] <dbaupp> \o/
[12:01:09] <cmr> Oh hrm :\
[12:01:21] <cmr> Wel
[12:01:24] <cmr> l
[12:04:33] <cmr> I'll try and revive #8437
[12:27:07] <cmr> Oh jeez
[12:27:23] <cmr> I was either really tired or really stupid, but the error was very obvious.
[12:27:31] <cmr> Forgot to update one of the strings in the tests :\
[12:27:45] <cmr> Wait no
[12:27:50] <cmr> this is indicative of a bug in my code
[12:27:52] <cmr> hm
[12:28:03] <cmr> yeah and that didn't fix it.
[15:08:39] <Seldaek> cmr: so it's all broken it was all for nothing? :p
[16:24:06] <cmr> Seldaek: not *quite* that bad :P
[16:27:19] <Seldaek> JUMP SHIP!111
[16:28:02] <cmr> I think I'm close to fixing it
[16:28:07] <cmr> But I've thought that before :\
[16:28:25] <cmr> Seldaek: The major change to the json is that paths are now different
[16:28:42] <cmr> Rather than Path { name, lifetime, generics }
[16:28:53] <cmr> It's Path { segments }
[16:28:56] <cmr> Where segments is a list of.
[16:28:58] <cmr> sec
[16:29:22] <cmr> https://github.com/mozilla/rust/blob/master/src/rustdoc_ng/clean.rs#L677
[16:29:25] <cmr> Look for yourself :P
[16:31:22] <Seldaek> cmr: paths.. where do we have paths?
[16:31:38] <Seldaek> ah for external items
[16:31:52] <Seldaek> guess that shouldn't be too invasive
[16:31:54] <cmr> yup
[16:32:05] <cmr> It'll just change how it's stringified I think
[16:32:35] <cmr> Internal paths we just look up the real type and use its name, given its id.
[16:32:42] <cmr> HAHA!
[16:32:43] <cmr> Fixed it!
[16:32:51] * cmr dances
[16:33:03] * Seldaek deja vu feeling
[16:33:09] <cmr> Well, tests pass :P
[16:33:25] <Seldaek> even déjà vu
[16:33:39] <Seldaek> or déjà vouuus as keanu would say
[16:33:49] <Seldaek> or was it the other dude
[16:34:08] <Seldaek> anyway, cool 
[17:43:11] <cmr> Seldaek: Fresh batch of json for you!
[17:43:20] <cmr> I'm going to include a bunch of libraries too
[17:43:24] <cmr> Like noise-rs, gl-rs, etc
[17:43:30] <cmr> Basically everything I can get to build :P
[17:43:51] <Seldaek> yay
[17:43:53] <cmr> I think the tgz webapi is a great idea
[17:44:05] <cmr> But only as an interim solution
[17:44:10] <Seldaek> yes of course
[17:44:22] <Seldaek> although, as a long term solution, I'd be happy to have a readthedocs-like system
[17:44:34] <Seldaek> where you can just add your github url and it'd build/host docs for you
[17:44:44] <Seldaek> because anythign else is a waste of everyone's time 
[17:44:49] <cmr> Yes
[17:44:53] <cmr> There's an issue open for that.
[17:45:15] <cmr> https://github.com/mozilla/rust/issues/1642
[20:37:23] <acrichto> Seldaek: ping
[20:39:05] <Seldaek> hoy
[20:44:06] <Seldaek> acrichto: ?
[20:44:20] <acrichto> Seldaek: oh, so we were talking about rustdoc_ng today
[20:44:37] <acrichto> and the conclusion was basically that if we can't lift the npm dependency soon, then there's no need to refator in the short-term
[20:44:51] <acrichto> as in don't bend over backwards to remove one or two things
[20:46:30] <Seldaek> ok
[20:46:42] <Seldaek> I think this makes sense
[20:47:18] <Seldaek> is the doc building part of a standard "make" on rust?
[20:48:34] <cmr> If all of the dependencies are available, yes.
[20:54:36] <acrichto> yeah so we'd just disable it if node/npm weren't available
[20:54:55] <acrichto> cmr Seldaek: do you guys have a game plan for integrating rustdoc_web?
[20:55:07] <acrichto> b/c cmr mentioned that #9231 was blocking that integration
[20:55:59] <cmr> So right now rustdoc_ng doesn't emit json that rustdoc_web has a hope of understanding
[20:57:08] <Seldaek> oh noes, build failed
[21:02:39] <acrichto> wait so how did rustdoc_web generate what exists today?
[21:02:48] <acrichto> also yeah cmr looks like some json output in a test needs to be updated
[21:03:17] <cmr> acrichto: I used a forked rustc ;(
[21:27:46] <cmr> FffffFFffffffffffffffffffffffff python's json.tool reordered the fields
[21:27:49] <cmr> Why would they do that
[21:29:45] <Seldaek> cmr: which fields?
[21:29:59] <Seldaek> object properties/fields are non-deterministic in js
[21:30:12] <Seldaek> reordering is "normal"
[21:30:28] <cmr> All of them
[21:30:38] <cmr> Right, but it's for a hardcoded string in a test in libsyntax :(
[21:30:42] <Seldaek> I doubt it's a problem though, because I always json.tool the json you sent me
[21:30:50] <Seldaek> ah tests
[21:31:01] <cmr> And json.tool does alphabetic ordering, which is quite nice usually.
[21:33:11] <Seldaek> the best is to test the decoded values are the same really
[21:33:27] <cmr> Good idea
[21:33:28] <Seldaek> or to reorder both with the same deterministic method
[21:33:47] <Seldaek> like json.tool on both should normalize them, if it really orders by name
[22:18:47] <acrichto> cmr: what's SCHEMA_VERSION?
[22:19:05] <cmr> acrichto: A semver of the JSON output.
[22:19:13] <cmr> It gets bumped whenever there's a breaking change to the JSON output
[22:19:19] <cmr> ...I should have bumped it to 0.9.0
[22:19:54] <acrichto> so it shouldn't track rustc's version?
[22:20:03] <cmr> No
[22:20:05] <acrichto> as in 0.8.0 vs 0.8-pre is just a coincidence right now
[22:20:06] <acrichto> cool
[22:20:07] <cmr> Yes
[22:20:16] <acrichto> I'm restructuring things to get a rustdoc_ng binary
[22:20:24] <acrichto> during make install
[22:20:27] <cmr> Cool
[22:20:34] <cmr> I try not to stare directly at the makefiles
[22:20:42] <cmr> My ears start bleeding and reality warps
[22:21:33] <acrichto> yeah I don't blame yo
[22:21:39] <acrichto> I just copy what's already there
[22:21:43] <acrichto> proliferate the madness!
[22:22:09] <cmr> I cannot wait until rustpkg is suitable for rustc compilation
[22:26:48] <Seldaek> yes, death to all makefiles please
[22:27:19] <Seldaek> even simple ones make me cringe, but the rust one or any comparably large project usually I just close it as soon as possible
[22:36:08] <acrichto> yeah seeing this logic in rust would make me go "oh, I know what that does"
[22:36:23] <acrichto> otherwise I look at it and go "oh, that's terrible, I'm going to go wash my eyes now"
[23:55:04] <acrichto> cmr: there's some failing rustdoc_ng tests
[23:55:09] <acrichto> (they're not running on the bots)
[23:55:12] <cmr> rustdoc_ng has tests?
[23:55:23] <acrichto> assuming you wrote them
[23:55:24] <acrichto> unit tets
[23:55:30] <acrichto> bottom of clean.rs
[23:55:42] <cmr> I did not write those
[23:55:45] <cmr> That's dead code, should be removed.
[23:55:50] <acrichto> the tests?
[23:55:53] <cmr> Yes
[23:56:26] <acrichto> cmr: these tests? https://github.com/mozilla/rust/blob/master/src/rustdoc_ng/clean.rs#L1048
[23:56:38] <cmr> Yup
[23:56:47] <acrichto> huh, ok
[23:57:04] <cmr> You'll notice super::collapse_docs doesn't exist.
[23:57:06] <cmr> Was moved into passes
[23:57:27] <acrichto> "running 0 tests" :(
[23:57:48] <cmr> well, "moved" in that it was entirely rewritten with no heed to the old version..
[23:57:50] <cmr> acrichto: yeah :(
[23:57:51] <acrichto> probably shouldn't be entirely untested in the future, but at least they're building now
[23:58:01] <cmr> rustdoc_web is my testsuite :p
[23:58:10] <acrichto> hehe
[23:58:20] <acrichto> wtf github is requesting an SSH key audit
[23:58:35] <acrichto> and they won't realize that I want that key to be my key
