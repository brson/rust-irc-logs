[00:00:47] <tikue> is there a vec.pop() that returns an option 
[00:00:59] <tikue> doesn't seem like it judging by the docs
[00:01:32] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[00:02:03] *** Joins: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[00:02:03] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Connection reset by peer)
[00:03:22] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[00:03:48] *** Quits: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[00:05:15] *** Joins: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[00:06:04] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[00:07:05] *** Quits: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: eatkinson)
[00:10:33] <tikue> scripts need control over pages, but so do the navigation contexts, but the scripts and navigation contexts aren't in the same task. :\
[00:10:41] <tikue> :/
[00:10:53] <tikue> :( *
[00:11:47] *** Joins: ghservo (ghservo@79968228.6A2AE50.F3114085.IP)
[00:11:47] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/OIBSZA
[00:11:47] *** Parts: ghservo (ghservo@79968228.6A2AE50.F3114085.IP) ()
[00:29:58] *** Joins: dzbarsky1 (Adium@2557E599.66715431.D25A875A.IP)
[00:29:58] *** Quits: dzbarsky (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[00:36:58] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[00:43:01] *** Quits: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au) (Quit: Leaving...)
[00:46:46] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[00:48:19] *** Quits: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[00:50:52] *** Joins: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:53:07] *** Quits: jclements (jclements@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: jclements)
[00:54:49] <seth> ok, so https://github.com/mozilla/servo/pull/539 is rebased and ready to go
[00:54:53] <seth> can someone re-r+ it?
[00:55:22] <sully> ok, servo actually seems to work if I have the nvidia driver
[00:56:21] <tikue> pcwalton: what does the constellation represent now? previously I considered it the ultimate decision-maker regarding who sends paint messages to the compositor. However, that would necessitate there only ever being one constellation, which seems wrong
[00:56:43] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[00:57:44] <pcwalton> tikue: sec
[00:57:53] <tikue> no rush
[00:59:46] *** Joins: ghservo (ghservo@24260B07.6A2AE50.F3114085.IP)
[00:59:46] <ghservo> 01[13servo01] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/oOTflA
[00:59:46] <ghservo> 13servo/06auto 144b172a3 15Seth Fowler: Create text runs during box building
[00:59:46] <ghservo> 13servo/06auto 14a066ce6 15bors-servo: auto merge of #539 : sfowler/servo/create-textruns-in-box-builder, r=pcwalton...
[00:59:46] *** Parts: ghservo (ghservo@24260B07.6A2AE50.F3114085.IP) ()
[01:03:33] *** Quits: dzbarsky1 (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[01:04:59] *** Quits: mccr8 (mccr8@2557E599.66715431.D25A875A.IP) (Quit: mccr8)
[01:13:20] *** Quits: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[01:16:12] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[01:16:45] <tikue> jack: ping
[01:23:42] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[01:28:10] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[01:31:17] *** Joins: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net)
[01:41:14] *** Quits: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: dherman)
[01:41:43] *** Joins: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP)
[01:41:43] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/oOTflA
[01:41:43] *** Parts: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP) ()
[01:43:11] *** Quits: brson (brson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[01:58:45] *** Joins: sankha93 (Instantbir@30B304BF.8E165DD6.8B6C1D65.IP)
[02:07:34] *** Joins: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP)
[02:07:34] <ghservo> [13servo] 15sfowler opened pull request #548: Cache shaped text at word granularity (06master...06glyph-store-cache)  02http://git.io/hRE_gA
[02:07:34] *** Parts: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:09:29] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[02:09:41] <seth> pcwalton/jack: r? ^
[02:10:30] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[02:22:59] *** Quits: azakai_ (alon@2557E599.66715431.D25A875A.IP) (Ping timeout)
[02:23:50] <jack> tikue: pong
[02:25:40] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[02:25:46] <jack> sully: you mean you switched from nouveau to the proprietary nvidia driver?
[02:26:22] <sully> yes
[02:38:32] *** Quits: harth (heather@moz-BE33DA21.fw1.sfo1.mozilla.net) (Client exited)
[03:01:47] *** Joins: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP)
[03:13:05] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[03:29:55] *** Joins: oneman (oneman@moz-82824AFA.hsd1.ca.comcast.net)
[03:43:23] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:48:53] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[03:50:43] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[04:05:45] *** Joins: brson (brson@3162D9B8.5D984074.48914E5F.IP)
[04:05:50] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[04:10:41] *** Quits: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net) (Quit: Leaving.)
[04:12:19] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[04:25:21] *** Quits: sankha93 (Instantbir@30B304BF.8E165DD6.8B6C1D65.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[04:31:03] *** Quits: brson (brson@3162D9B8.5D984074.48914E5F.IP) (Ping timeout)
[04:55:43] <oneman> hey folks
[04:55:56] <oneman> I am getting a bad problem when running make check, not sure if its just me
[04:56:21] <oneman> https://gist.github.com/oneman/5874036
[04:57:29] <oneman> I'm not otherwise having a problem linking to this
[04:59:26] <oneman> make finishes but I didn't get any example html files
[05:07:50] <jack> this was fixed by jdm but rust-azure is ahead of servo right now so it's not in the branch servo uses.
[05:07:58] <jack> why some people see this and not other is beyond me
[05:08:10] <jack> but you can fix it by adding -lX11 to rust-azure/azure.rc
[05:08:19] <jack> look for the other link flags to see where to add it
[05:08:42] <oneman> yay
[05:08:55] <jack> oh i get it
[05:08:59] <jack> i bet it's only make check that fails
[05:09:03] <oneman> right
[05:09:12] <jack> still doesn't explain why the bors builder doesn't see the problem
[05:09:18] <oneman> safe bet since I said that happens
[05:09:32] <oneman> ;)
[05:09:57] <jack> you don't need correct link flags until you make a binary. and amke check creates an executable test runner
[05:10:06] <jack> still, i'm baffled why the build bot doesn't hit it
[05:10:20] <jack> in any case, easy to fix and wil be fixed in tree within a few days
[05:11:03] <jack> tikue: ping. you were looking for me earlier?
[05:11:23] <tikue> jack: yes, but I can't remember why now :)
[05:16:32] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[05:18:37] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[05:20:37] <oneman> allright great
[05:20:51] <oneman> my next problem is a python related failure running make check
[05:20:58] <jack> \
[05:21:02] <jack> on tidy?
[05:21:15] <jack> or on the codegen?
[05:22:15] <oneman> tidy
[05:22:31] <oneman> https://gist.github.com/oneman/5874126
[05:22:32] *** Joins: sankha93 (Instantbir@FB9AED5F.C0113EA2.D2D1FAF0.IP)
[05:22:44] <oneman> maybe a python3 surprise
[05:23:40] <jack> hmm. i think we have python2 vs. python3 detection for codegen. we probably just need to apply it to this. or fix tidy.py
[05:23:43] <jack> patches welcome :)
[05:23:54] <jack> or file it as a bug
[05:26:02] <oneman> config.mk knows of python2
[05:27:56] <oneman> python is a bug
[05:28:11] <oneman> so I switched my system default to python2 and make check finishes
[05:28:44] <oneman> but seems make check finishes right where that was errin
[05:29:09] <oneman> I didn't get any example html files stil
[05:29:56] <oneman> servo will run but only fails in one of a few ways
[05:33:33] <oneman> assertion failed: fonts.len() > 0', /home/oneman/kode/servo/src/components/gfx/font_context.rs:187
[05:33:42] <oneman> thats the most common way it fails
[05:42:45] <oneman> I'm blaming servo not working for me entirely on sfowler
[05:49:35] *** Quits: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[06:01:34] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:05:40] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[06:09:09] *** Quits: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP) (Quit: lmandel)
[06:19:01] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[06:20:31] <tikue> jack: what exactly needs to be done to upgrade to 0.7? i rebased onto origin/master
[06:23:16] <tikue> jack: getting an error saying can't find crate for extra
[06:26:43] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[06:26:58] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[06:27:24] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[06:40:22] *** Joins: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net)
[06:43:35] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[06:51:21] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: caitp)
[06:56:40] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[07:09:23] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[07:22:51] *** Joins: Debloper (debloper@moz-88FF8AE8.redhat.com)
[08:11:27] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[08:11:38] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[08:24:00] *** Joins: Adityab (Adityab@moz-E3C463B1.dip0.t-ipconnect.de)
[08:30:02] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[08:40:51] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[08:41:21] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[08:43:18] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[08:57:37] *** Quits: Jesse_ (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse_)
[09:02:57] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[09:05:31] *** Quits: n0vember (n0vember@moz-690FFF9D.org) (Ping timeout)
[09:05:39] *** Quits: michaelgreene (michael@DA820AA2.17CD9887.F12515B4.IP) (Ping timeout)
[09:08:22] *** Joins: n0vember (n0vember@moz-690FFF9D.org)
[09:11:00] *** Quits: n0vember (n0vember@moz-690FFF9D.org) (Ping timeout)
[09:11:47] *** Joins: michaelgreene (michael@DA820AA2.17CD9887.F12515B4.IP)
[09:12:22] *** Joins: n0vember (n0vember@moz-690FFF9D.org)
[09:20:36] *** Joins: vivekg (uid10501@moz-D8B63698.irccloud.com)
[09:27:00] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[09:29:52] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[09:55:04] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[10:02:57] *** Quits: fzzzy (Donovan@moz-40919DA0.us-west-2.compute.amazonaws.com) (Ping timeout)
[10:03:27] *** Joins: fzzzy (Donovan@moz-40919DA0.us-west-2.compute.amazonaws.com)
[10:39:56] *** Joins: jdm (jdm@514D186.F3BBB17D.144F44FA.IP)
[11:02:42] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[11:28:10] *** Quits: Adityab (Adityab@moz-E3C463B1.dip0.t-ipconnect.de) (Quit: Adityab)
[11:30:55] *** Quits: Debloper (debloper@moz-88FF8AE8.redhat.com) (Quit: Leaving.)
[11:37:47] *** jdm is now known as jdm|f00d
[11:38:58] *** Joins: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net)
[12:17:01] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[12:30:55] *** jdm|f00d is now known as jdm
[12:35:12] *** Joins: Adityab (Adityab@moz-E3C463B1.dip0.t-ipconnect.de)
[12:41:31] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[12:43:23] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[12:45:38] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[12:46:18] *** Joins: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP)
[12:49:09] *** Quits: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP) (Quit: lmandel)
[12:51:39] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[12:54:00] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[12:58:28] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[13:01:18] *** bhearsum|afk is now known as bhearsum
[13:13:34] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Client exited)
[13:20:35] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[13:28:50] *** Quits: sankha93 (Instantbir@FB9AED5F.C0113EA2.D2D1FAF0.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[13:28:52] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[13:30:38] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[13:34:21] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Ping timeout)
[14:03:12] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[14:05:11] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Ping timeout)
[14:12:48] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Client exited)
[14:13:21] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[14:19:02] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Input/output error)
[14:19:07] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[14:20:37] *** Joins: jyeo (user@F2D29657.F60B0462.67AC9B1.IP)
[14:22:28] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[14:46:05] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[14:53:54] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:03:58] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[15:05:52] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Ping timeout)
[15:15:38] <jack> jdm: glad upgrading gives you teh same results i get
[15:15:54] <jdm> jack: wait, you see the intel_do_flush quit as well?
[15:15:58] <jdm> I thought you couldn't reproduce
[15:16:15] <jack> i can reproduce with the small test programs
[15:16:54] <jdm> jack: I thought we were under the impression that the various driver packages on fedora 18 should sweep the problem under the rug completely
[15:17:04] <jack> and if i reshape i get intel_do_flush_locked
[15:17:22] <oneman> i get intel_fail
[15:17:26] <oneman> fail*
[15:17:29] <oneman> lol
[15:17:50] <jack> in any case, i think if i fix the display garbage it will fix everything. whatever i'm doing wrong just expresses different ways on different drivers
[15:18:05] *** Joins: jclements (jclements@43CB6079.66715431.D25A875A.IP)
[15:18:05] <jack> apparently on the proprietary nvida drivers it all works fine, just like on the VM drivers
[15:18:11] <jdm> ok
[15:18:22] <jdm> as long as there's a plan of attack, I won't complain
[15:19:01] <jdm> then we'll just need to make our graphic driver requirements very clear, I suppose
[15:19:20] <jack> i still think it can be fixed. i just have to track down what i'm doing wrong.
[15:19:35] <jack> the texlayer example is quite a bit smaller. it's just a shared_gl_context 
[15:20:11] <jack> also, nouveau drivers crash and hte backtrace points to creating the context, not flushing or drawing
[15:20:24] <caitp-> could I see the test code?
[15:20:26] <jack> i'm going to start with putting asserts in the constructor
[15:20:49] <jack> caitp-: https://gist.github.com/metajack/5872317
[15:21:10] <caitp-> ah I see, rust
[15:21:58] <jack> i can post azurefbo which is closer to C if you want something in C
[15:22:02] <jack> it's C calls that fail
[15:22:14] <jack> so it should be possible to make a few lines long C example that exhibits the same behavior
[15:22:58] <caitp-> I was getting a friend who works on ogl driver implementation to take a look at it, not sure if he speaks rust
[15:23:04] <caitp-> but hopefully it makes sense
[15:24:54] <jack> caitp-: this is where the bug is afaik: https://github.com/mozilla-servo/skia/blob/master/src/gpu/gl/unix/SkNativeSharedGLContext_unix.cpp#L88
[15:25:29] <jack> well, either here or in the constructor or some combination
[15:26:23] <caitp-> guy might have some ideas, or maybe not, have to wait and see
[15:26:59] <jack> https://gist.github.com/msullivan/5872576
[15:27:02] <jack> tha'ts the backtrace
[15:36:18] *** Quits: caitp- (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: Leaving)
[15:36:35] *** Joins: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[15:37:35] <oneman> how could I render to a png file
[15:37:57] <jdm> oneman: that's a work in progress :)
[15:38:27] <oneman> I've yet to have it work once, but it did compile last night which was thrilling
[15:38:40] <oneman> I have big plans and hopes for it personally
[15:39:59] <oneman> once I can render to an argb buffer, I can render to wayland or webm stream etc pretty much right away
[15:40:23] <jack> oneman: i'm working on having it output pngs. you should be able to trivially adapt that code
[15:40:43] <jack> it won't run headless yet, but pcwalton is working on that part.
[15:41:01] <jdm> headless rendering will be so \m/
[15:41:02] <oneman> im thrilled
[15:41:23] <jack> jdm: headless on osx is easy. it's just linux that is causing such problems.
[15:41:31] <oneman> nonsense
[15:41:41] <jack> i have no idea why GL contexts require so much extra crap on linux.
[15:41:52] <oneman> does it depend on GL even headless?
[15:41:59] <jack> you need a display server connection, several pixmaps, etc
[15:41:59] <oneman> because thats not headless
[15:42:01] *** Joins: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP)
[15:42:05] <jack> oneman: we only have GPU compositing
[15:42:14] <oneman> well thats a nonstarter for me
[15:42:21] <jack> i don't see why
[15:42:24] <oneman> I want to render on say, an ec2 instance
[15:42:37] <jack> ec2 machines have gpus or can run mesa, so?
[15:42:47] <oneman> only the top dollar ones
[15:43:24] <jack> anything can run mesa. we're just doing simple texture blitting, so shouldn't be a performance issue
[15:43:45] <oneman> perhaps
[15:44:01] <oneman> anything can be done but it becomes more kludgey
[15:44:09] *** bhearsum is now known as bhearsum|food
[15:44:14] <oneman> for example pixman headless wayland
[15:44:48] <jack> skia asserts don't trigger. so it's some must be some kind of thread safety issue.
[15:44:54] <oneman> im not going get my panties in a bunch about it, im sure everyone will get what they want
[15:45:11] <jack> oneman: eventually i'm sure we'll have a cpu compositor too
[15:45:14] <oneman> just let me know when I might be able to render anything at all to anything at all haha
[15:46:31] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[15:46:44] <caitp> the best I've heard from him is that MT/parallelism and opengl are not really friends, I think that's the only thing I'm getting out of it
[15:47:10] <jack> Q: Why does it not work if I make my context current in another thread?
[15:47:10] <jack> * A: One OpenGL context can only be current in one thread. You have to release the context in the the other thread first, by making another or no context current.
[15:47:13] <jack> that might be it
[15:47:55] <caitp> I thought we were using lightweight tasks though? :D
[15:47:55] <jack> how in the world do i do that :)
[15:48:08] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[15:48:35] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[15:48:51] <jack> hm. i can probably make it drop the context after init
[15:49:12] <caitp> you could ask for a lock on the context and do gross synchronization stuff
[15:49:15] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[15:49:22] <caitp> and defeat the purpose of parallelism
[15:49:44] <caitp> ttvdtg: caitp i think much better way is to use glFenceSync / glWaitSync
[15:49:45] <caitp> [11:46am] ttvdtg: if they are available
[15:49:54] <caitp> maybe that's an option, dunno
[15:50:27] <jack> caitp: there's no use of hte ocntext from multiple threads at once
[15:50:39] <jack> the issue is that the context might get passed around a bit before it gets drawn to
[15:50:46] <caitp> ah I see
[15:50:55] <jack> so it's possible it's initialized (and made current) on thread 1, then later when it's used it's on thread 10
[15:50:56] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[15:51:08] <jack> thread 1 will never touch it again
[15:51:33] <caitp> doesn't rust have an interface for things that have to happen before ownership changes?
[15:51:36] <caitp> iirc it did
[15:51:36] <jack> actually, that might not be it. i think we init and render to the context in one swoop currently
[15:52:48] <jack> yep, it's created and drawn to on the same thread.
[15:55:48] *** Quits: jyeo (user@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[15:59:54] <caitp> so is it actually made current?
[16:00:11] <jack> that's what crashes it.
[16:00:21] <jack> the call to glXMakeCurrent crashes
[16:00:36] <jack> i'm nto sure if that's also what causes the intel_do_flush_locked, but i assume so
[16:01:31] *** Joins: joone (joone@moz-C50DC051.jf.intel.com)
[16:03:48] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Quit: Leaving.)
[16:04:10] <caitp> it doesn't really make sense, if it's essentially synchronous
[16:04:34] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[16:05:38] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[16:05:47] *** Joins: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com)
[16:06:00] <jack> i wonder if the visinfo stuff is bad or something
[16:06:22] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Ping timeout)
[16:07:01] <caitp> if it isn't figured out by like monday or tuesday, guy can probably get some info on opengl parallelism issues from cow-orkers
[16:07:09] <caitp> but it sounds like not really a parallelism issue to me
[16:07:18] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[16:07:21] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[16:07:38] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[16:09:24] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[16:10:53] *** Quits: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com) (Ping timeout)
[16:11:27] <jack> hmm. that looks like a bug. i was asking for a RGBA thing with depth of 24
[16:11:39] *** Joins: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP)
[16:12:14] <caitp> mm
[16:12:22] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[16:13:20] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[16:16:54] *** Joins: mccr8 (mccr8@2557E599.66715431.D25A875A.IP)
[16:17:03] <jack> actually that's the depth buffer size control, whcih we don't need
[16:19:29] *** Quits: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP) (Ping timeout)
[16:21:09] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[16:25:31] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[16:26:40] *** Joins: CaseyBecking (CaseyBecki@moz-7EBF4B5D.lsanca.fios.verizon.net)
[16:27:41] <jack> geez. the MBA takes 11 minutes to build servo for a small skia change
[16:28:03] <jack> i can't believe how different the times are for the MBA and the MBP.
[16:28:18] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[16:29:35] *** Joins: jyeo (user@F2D29657.F60B0462.67AC9B1.IP)
[16:29:50] *** Quits: jclements (jclements@43CB6079.66715431.D25A875A.IP) (Quit: jclements)
[16:30:34] <jack> ok. now it doesn't give me garbage and intel_do_flush_locked crashes right away
[16:30:44] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[16:31:01] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[16:32:14] *** Joins: azakai_ (alon@2557E599.66715431.D25A875A.IP)
[16:32:51] <jdm> heh
[16:33:10] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[16:33:49] *** Joins: jclements (jclements@43CB6079.66715431.D25A875A.IP)
[16:33:57] <jack> i have no idea if this is an improvement :)
[16:35:41] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:35:41] *** ChanServ sets mode: +qo dherman dherman
[16:35:59] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[16:37:08] *** Quits: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net) (Ping timeout)
[16:39:26] <jdm> release early, fail fast
[16:39:31] <jdm> same principle
[16:39:43] *** bhearsum|food is now known as bhearsum
[16:43:54] *** Joins: tjc (tjc@moz-D530ECE9.lightspeed.irvnca.sbcglobal.net)
[16:43:58] <jclements> jack: are you coming to the rust bug triage meeting? we miss you.
[16:44:16] <jack> jclements: omw
[16:45:08] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[16:52:36] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Client exited)
[17:01:41] *** Quits: jyeo (user@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[17:04:19] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[17:05:48] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[17:06:26] *** Quits: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[17:15:05] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Quit: Leaving.)
[17:15:17] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[17:16:18] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[17:16:56] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[17:17:01] *** Joins: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com)
[17:20:45] *** Joins: ghservo (ghservo@C621748.6A2AE50.F3114085.IP)
[17:20:45] <ghservo> [13rust-mozjs] 15jdm opened pull request #19: Add JSVAL_IS_OBJECT (06master...06new_branch_name)  02http://git.io/qkL9UA
[17:20:45] *** Parts: ghservo (ghservo@C621748.6A2AE50.F3114085.IP) ()
[17:21:09] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[17:23:12] *** Joins: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com)
[17:28:26] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[17:35:09] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[17:40:43] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[17:42:52] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[17:43:16] *** Joins: burg (burg@moz-A644EFFF.dyn.cs.washington.edu)
[17:44:52] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[17:45:10] <pcwalton> jack: working on getting CPU rendering landed today, I made the changes necessary to make linux work but they required changing sharegl interfaces so I need to go back and get it working on Mac again
[17:46:48] *** Joins: ghservo (ghservo@1E8607E8.6A2AE50.F3114085.IP)
[17:46:48] <ghservo> [13servo] 15jdm opened pull request #549: Implement WebIDL method overloads. Fixes #540. (06master...06overload)  02http://git.io/X_pt4Q
[17:46:48] *** Parts: ghservo (ghservo@1E8607E8.6A2AE50.F3114085.IP) ()
[17:51:30] *** Quits: tjc (tjc@moz-D530ECE9.lightspeed.irvnca.sbcglobal.net) (Quit: Places to go, people to annoy)
[17:53:48] *** Quits: jclements (jclements@43CB6079.66715431.D25A875A.IP) (Quit: jclements)
[17:58:40] *** Quits: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net) (Quit: Leaving.)
[17:59:48] *** Quits: CaseyBecking (CaseyBecki@moz-7EBF4B5D.lsanca.fios.verizon.net) (Quit: Linkinus - http://linkinus.com)
[18:01:11] *** Joins: jclements (jclements@43CB6079.66715431.D25A875A.IP)
[18:01:50] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[18:01:53] *** Quits: jdm (jdm@514D186.F3BBB17D.144F44FA.IP) (Ping timeout)
[18:02:58] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[18:04:36] *** Quits: Adityab (Adityab@moz-E3C463B1.dip0.t-ipconnect.de) (Quit: Adityab)
[18:04:58] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[18:06:40] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[18:08:23] *** Joins: Jesse (jruderman@2557E599.66715431.D25A875A.IP)
[18:12:22] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[18:12:59] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[18:13:47] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[18:14:03] *** Joins: dzbarsky (Adium@2557E599.66715431.D25A875A.IP)
[18:14:59] *** Joins: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP)
[18:17:21] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[18:17:39] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[18:18:14] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[18:19:28] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[18:21:53] *** Joins: jyeo (user@F2D29657.F60B0462.67AC9B1.IP)
[18:25:19] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[18:25:55] <jack> pcwalton: i'm trying to fix gpu rendering on linux. i think you're having more fun that me.
[18:26:13] <pcwalton> don't kill yourself if it is driver bugs
[18:26:26] <pcwalton> we have driver blocklists in firefox for a reason
[18:26:33] <pcwalton> I mean if it is something we're doing wrong by all means
[18:27:42] <jack> i don't think firefox would ever block all i915 and i965 cards :)
[18:28:03] <pcwalton> well, it also doesn't do off screen rendering I don't think
[18:28:04] <jack> right now everything but nvidia proprietary and the vmware drivers fails as far as i can tell
[18:28:24] <jack> the odd thing is that it's on context creation
[18:28:39] *** Joins: tjc (tjc@moz-1F8E59C9.west.biz.rr.com)
[18:28:46] <mccr8> FYI here's the Firefox blocklist I think https://wiki.mozilla.org/Blocklisting/Blocked_Graphics_Drivers
[18:28:50] <pcwalton> make sure that you aren't sharing the context accidentally between multiple threads
[18:28:57] <pcwalton> I did that yesterday and was pulling my hair out on the train
[18:29:01] <pcwalton> figuring out what was wrong
[18:29:20] <jack> pcwalton: it's not possible for us to really do that anymore. we create the fbo on the rendering thread right before we render to it
[18:29:29] <jack> after that we never use it again except to call get_texture
[18:29:32] <pcwalton> ah
[18:29:33] <pcwalton> yeah
[18:29:57] <jack> also, that wouldn't affect context creation, only context use
[18:30:07] *** Quits: jyeo (user@F2D29657.F60B0462.67AC9B1.IP) (Input/output error)
[18:30:22] <jack> i've been playing with visinfo parameters (roughly equivalent to the GDL PictureAttrib stuff or whatever) and that doesn't seem to do much
[18:30:28] *** Joins: jyeo (user@F2D29657.F60B0462.67AC9B1.IP)
[18:30:35] <jack> it's made the problem more immediate and easier to reproduce i guess
[18:31:00] *** Quits: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com) (Quit: brendan)
[18:33:06] <pcwalton> i sympathize. Xlib/GLX is completely miserable
[18:34:04] <jack> ok. so intel_do_flush_locked actually happens on glFlush() and glutSwapBuffers()
[18:34:10] <jack> so maybe it is a multithreading issue.
[18:36:22] <jack> any idea why glutSwapBuffers would fail?
[18:36:34] <pcwalton> maybe valgrind will help?
[18:36:57] <pcwalton> keep in mind that because GL is an async API, problems from earlier may end up in late functions like flush and swap buffers
[18:37:07] <pcwalton> many drivers have debug modes that immediately flush all commands
[18:37:09] <jack> how do i kill the segmented stacks?
[18:37:48] <pcwalton> RUST_MIN_STACK=8000000 ./servo ...
[18:39:11] <jack> lot of invalid writes and reads
[18:39:27] <jack> specifically from AzCreateSkiaSharedGLContext
[18:39:44] <pcwalton> suspicious
[18:40:00] <jack> _mesa_meta_glsl_Clear
[18:41:22] <jack> i need to compile skia and azure with debug and try this.
[18:41:34] <jack> thanks for hte valgrind pointer. i had decided to do that yesterday but forgot
[18:41:56] <jack> it amazes me that anything ever works with what valgrind finds.
[18:42:50] <jack> oh on another topic, do you have any ideas about what could be causing like a 5x rustc speed difference on my MBA compared to my MBP? they are both core i7s (though obviously probably have different cache sizes) mbp is 16gb RAM and mba is 8gb
[18:43:11] <pcwalton> SSD?
[18:43:39] <jack> you mean that the MBA might have much slower SSD?
[18:43:46] <pcwalton> do they both have SSDs?
[18:43:53] <jack> yes
[18:43:56] <pcwalton> hmm
[18:43:57] <pcwalton> no idea then
[18:44:04] <pcwalton> unless you're swapping for some reason
[18:44:17] <jack> i checked that with vmstat during a compile, but doesn't seem to be the case.
[18:45:08] <jack> it seems odd that rustc would be that sensitive to cache size. so i suspect something is wrong with my config of linux or something
[18:51:00] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[18:59:18] <jack> looks like glCear(GL_STENCIL_BUFFER_BIT) is what fails
[18:59:24] <pcwalton> interesting
[19:01:24] <jack> does the fbo you create have anything to do with the glxPixmap you make?
[19:01:40] <jack> fbos are completely independent of the pixmaps right, assuming you're not drawing to FBO 0
[19:02:23] <pcwalton> I think so
[19:02:32] <pcwalton> not sure if they're shared between contexts
[19:02:39] <pcwalton> you have to have a current context to make an FBO of course
[19:04:10] <jack> yeah, it does. it calls this set up code after glXCreateContext
[19:07:46] *** Joins: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com)
[19:13:46] *** Joins: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[19:13:59] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[19:15:50] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[19:16:12] <jack> the first thing that shows up from Azure in valgrind is "Conditional jump or move depends on unitialized value" deep inside the driver after a call to glTexImage2D
[19:16:20] <jack> (that has NULL for data
[19:16:58] <jack> the first invalid write is from the glClear(GL_STENCIL_BUFFER_BIT)
[19:23:04] <jack> i think the visinfo and what you can create for framebuffers must be linked.
[19:27:59] *** Quits: brendan (brendaneic@moz-ACC6832C.sub-70-197-7.myvzw.com) (Quit: brendan)
[19:28:17] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[19:28:51] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[19:31:47] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[19:34:49] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[19:38:56] <jack> ok
[19:39:11] <jack> so back to what jdm found yesterday or so, we can potentially limit XOpenDisplay calls to 1
[19:39:30] <jack> but how do we get the original display that glut creates? :(
[19:43:32] <jack> pcwalton: if we ditch glut, what are the candidates to replac eit?
[19:44:17] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[19:53:50] <tikue> not sure why this keeps happening:
[19:54:05] <tikue> servo/src/components/util/util.rc:11:0: 11:17 error: can't find crate for `extra`
[19:54:05] <tikue> servo/src/components/util/util.rc:11 extern mod extra;
[19:56:42] <jack> tikue: make clean-rust all
[19:57:24] <tikue> jack: thanks
[19:58:32] <jack> sigh. to work around this bug it seems like we need to not call XOpenDisplay mor than once. all the frameworks do this, but don't give you access to the Display pointer.
[19:58:42] <jack> nor do they have an API for creating an offscreen context.
[19:58:47] *** Quits: tjc (tjc@moz-1F8E59C9.west.biz.rr.com) (Ping timeout)
[19:58:47] *** Quits: mccr8 (mccr8@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[19:58:55] *** Joins: mccr8 (mccr8@2557E599.66715431.D25A875A.IP)
[19:58:57] <jack> so i fear that the only solution is going to be to handle window setup ourselves :(
[19:59:15] <jack> or fork freeglut or SFML or something
[19:59:40] <jack> not to mention this is going to make embedding GPU rendering very hard.
[20:00:10] <jack> can i get a fake display in X11?
[20:04:00] *** Joins: tjc (tjc@moz-1F8E59C9.west.biz.rr.com)
[20:05:28] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[20:05:41] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[20:05:41] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[20:05:57] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[20:07:02] <jack> ok. i think we can switch to using EGL directly
[20:07:09] <jack> that has eglGetCurrentDisplay()
[20:17:24] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[20:19:14] <tikue> jack: make clean-rust all didn't fix it -- I'm still getting this same error
[20:19:32] <jack> did it build rust?
[20:19:39] <jack> is it using the rust it built?
[20:21:18] <tikue> jack: I think it built rust successfully. If it's not using the rust it built what else would it be using?
[20:24:27] <jack> maybe you have a system rust? :)
[20:24:44] <tikue> jack: I never installed a standalone rust :)
[20:24:57] <jack> what's the commandline it's executing when it hits that error?
[20:25:57] <tikue> jack: https://gist.github.com/tkuehn/ed5b211a852b8729f9db
[20:27:04] <jack> oh, you didn't update your rust submodule i bet
[20:27:12] <tikue> reconfiguring doesn't do that?
[20:27:29] <jack> do git status and see if your rust pointer is old
[20:29:41] <jack> damn. eglGetCurrentContext() doesn't return anything when using glut.
[20:29:53] <jack> we could add freeglut to our deps and compile it with egl support
[20:31:14] *** bhearsum is now known as bhearsum|afk
[20:33:16] <jack> ok. glfw has all these native accessors.
[20:36:15] <tikue> jack: I think perhaps reconfiguring didn't update my rust submodule. I don't know why I have so much trouble with my submodules. :) so I did it manuallyâ€¦hopefully it'll work now
[20:37:03] *** Quits: tjc (tjc@moz-1F8E59C9.west.biz.rr.com) (Quit: zzzzzzzzzz)
[20:41:32] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: vivekg (uid10501@moz-D8B63698.irccloud.com) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (sand.mozilla.org dust.mozilla.org)
[20:41:32] *** Quits: ysuzuki (ysuzuki@moz-36FBA934.net124047241.t-com.ne.jp) (sand.mozilla.org dust.mozilla.org)
[20:41:35] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:41:37] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[20:42:54] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[20:43:02] *** Joins: vivekg (uid10501@moz-D8B63698.irccloud.com)
[20:43:04] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[20:43:11] *** Joins: ysuzuki (ysuzuki@moz-36FBA934.net124047241.t-com.ne.jp)
[20:43:25] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[20:43:31] *** Joins: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP)
[20:43:35] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[20:43:37] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[20:43:46] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (sand.mozilla.org dust.mozilla.org)
[20:43:46] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (sand.mozilla.org dust.mozilla.org)
[20:43:46] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (sand.mozilla.org dust.mozilla.org)
[20:43:46] *** Quits: ysuzuki (ysuzuki@moz-36FBA934.net124047241.t-com.ne.jp) (sand.mozilla.org dust.mozilla.org)
[20:43:46] *** Quits: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP) (sand.mozilla.org dust.mozilla.org)
[20:43:47] *** Quits: vivekg (uid10501@moz-D8B63698.irccloud.com) (sand.mozilla.org dust.mozilla.org)
[20:43:47] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (sand.mozilla.org dust.mozilla.org)
[20:44:35] *** Joins: ysuzuki (ysuzuki@moz-36FBA934.net124047241.t-com.ne.jp)
[20:45:46] *** Joins: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP)
[20:46:49] *** Joins: vivekg (uid10501@moz-D8B63698.irccloud.com)
[20:48:55] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[20:49:52] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[20:51:38] <jack> glfw-rs doesn't have bindings to the native ones yet though
[20:54:20] <tikue> argh! updating rust submodule didn't fix it
[20:54:28] <tikue> what the heck
[20:54:43] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[20:54:57] *** Joins: jrfeenst (jrfeenst@EB9B6F4E.B49A9E89.A9D37AD9.IP)
[20:55:00] <jack> what's the rev of the rust submodule?
[20:56:05] <tikue> jack: I think configure keeps setting rust back to the wrong commit
[20:56:12] <tikue> why would that be happening?
[20:56:38] *** Quits: ehsanul_ (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[20:57:34] <tikue> jack: I think that when I rebase onto origin/master, the submodule pointers aren't updated. Why would that happen?
[21:01:06] <jack> as i said before, rebasing _always_ prefers your pointers
[21:01:29] <jack> if there is a conflict between what upstream had and what you had, it will choose yours.
[21:02:57] <tikue> jack: Yes, but I don't understand why it thinks there is a conflict, though. Because I haven't _touched_ any of those submodules.
[21:03:03] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[21:03:57] <jack> i dunno
[21:04:37] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Client exited)
[21:06:59] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[21:08:49] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[21:15:44] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Killed (concrete2.mozilla.org (Nick Collision)))
[21:15:44] *** Joins: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[21:15:47] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Killed (dust.mozilla.org (Nick Collision)))
[21:15:47] *** Joins: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[21:16:47] *** Joins: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP)
[21:17:55] *** Joins: tjc (tjc@moz-508C89CD.lightspeed.irvnca.sbcglobal.net)
[21:18:01] *** Quits: reyre_ (reyre@F2D29657.F60B0462.67AC9B1.IP) (Client exited)
[21:18:39] <pcwalton> jack: my preferred replacement is the WebKit 2 API
[21:18:42] <pcwalton> and MiniBrowser
[21:18:51] <pcwalton> I looked more yesterday into how to do it
[21:20:23] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[21:22:53] *** Parts: jrfeenst (jrfeenst@EB9B6F4E.B49A9E89.A9D37AD9.IP) ()
[21:26:21] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[21:28:46] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[21:33:56] *** Quits: jyeo (user@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[21:35:09] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[21:37:36] <jack> we'll still need some way to pass in the display and glxpixmap
[21:37:46] <jack> i'll look ata minibrowser and see what's available there.
[21:39:46] <tikue> jack: I think doing git submodule foreach git checkout origin/master did the trick. we'll seeâ€¦ sheesh
[21:40:03] *** Quits: sankha93 (Instantbir@A9EF28FD.56EC8A95.8B6C1D65.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[21:43:22] <jack> tikue: that is guaranteed to fail :)
[21:43:35] <jack> because rust-layers and rust-azure are both ahead of servo and don't work with master servo
[21:43:51] <tikue> jack: crapâ€¦ :(
[21:43:53] <jack> i need to spend some time on the makefiles.
[21:44:27] <jack> actually now that we have rust 0.7 i cna try rustpkg
[21:45:06] <jack> pcwalton: so if minibrowser doesn't seem liek a short project, i think the best bet is to move to glfw/glfw-rs as a stopgap
[21:45:17] <pcwalton> jack: glfw doesn't work on 10.6
[21:45:24] <jack> at all?
[21:45:26] <pcwalton> at all :(
[21:45:33] <jack> do you know what the issue is/
[21:45:45] <pcwalton> yeah, it uses a bunch of GL setup functions that are unsupported on 10.6 IIRC
[21:46:21] <jack> https://github.com/glfw/glfw/pull/47
[21:46:32] <jack> looks like that was just possibly fixed
[21:46:37] <pcwalton> oh nice
[21:46:50] <jack> if you can confirm that, that would be quite useful
[21:46:53] <pcwalton> well, in that case, I'm all for it.
[21:46:56] <jack> i have no 10.6 to test with
[21:47:26] <jack> sadly, 10.9 is nigh and so the spread is going to get even worse
[21:47:36] <pcwalton> rust is busted on 10.9 apparently
[21:47:49] *** Joins: seth (seth@2557E599.66715431.D25A875A.IP)
[21:47:49] <jack> valgrind still hasn't even gotten fixed on 10.8. it's not going to be super fun :)
[21:48:05] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[21:52:32] *** Quits: burg (burg@moz-A644EFFF.dyn.cs.washington.edu) (Quit: burg)
[21:53:31] * pcwalton wonders if there's a way to kick GLFW awake from another thread
[21:53:35] <pcwalton> that would be very nice
[21:53:41] <pcwalton> to eliminate the clownshoesness
[21:55:16] *** Quits: brendan (brendaneic@2557E599.66715431.D25A875A.IP) (Quit: brendan)
[21:58:47] <pcwalton> jack: it's still broken for me
[21:58:49] <pcwalton> but I think I can fix
[22:04:32] <pcwalton> jack: can you test this PR I'm about to submit upstream to GLFW?
[22:04:41] <pcwalton> to make sure it doesn't break later Mac versions
[22:04:57] <pcwalton> also, I've finally got CPU rendering working on both linux and mac
[22:05:08] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[22:05:10] <pcwalton> and GPU rendering
[22:05:13] <jack> pcwalton: sure. send me the link
[22:05:14] <pcwalton> choose with a switch
[22:07:19] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[22:07:19] *** ChanServ sets mode: +qo dherman dherman
[22:09:02] *** Joins: jyeo (user@F2D29657.F60B0462.67AC9B1.IP)
[22:09:18] <pcwalton> jack: https://github.com/pcwalton/glfw/tree/snow-leopard-compile
[22:11:25] *** Joins: jdm (jdm@moz-E4B91594.zone16.bethere.co.uk)
[22:14:20] <jack> pcwalton: builds just fine
[22:14:25] <pcwalton> yay! sending a PR
[22:14:29] <pcwalton> the examples work for me now.
[22:14:31] <jack> first time i've ever used cmake
[22:14:36] <jack> was surprisingly pleasant
[22:14:36] *** Joins: ghservo (ghservo@E7A4CCE2.6A2AE50.F3114085.IP)
[22:14:36] <ghservo> [13sharegl] 15pcwalton opened pull request #7: Update the Linux functionality to use ARCs and make the Mac match. (06master...06linux-arc)  02http://git.io/OGM45A
[22:14:37] *** Parts: ghservo (ghservo@E7A4CCE2.6A2AE50.F3114085.IP) ()
[22:14:45] <pcwalton> yeah, it's nice, *especially* on windows
[22:14:48] <pcwalton> it's just not fun to write makefiles for
[22:14:49] <pcwalton> t
[22:14:54] <pcwalton> the syntax is basically as bad as Make
[22:15:01] <pcwalton> and far more limited than make :(
[22:15:22] <pcwalton> jack: r? https://github.com/mozilla-servo/sharegl/pull/7
[22:17:41] *** Quits: jdm (jdm@moz-E4B91594.zone16.bethere.co.uk) (Ping timeout)
[22:17:58] <jack> why ARCs?
[22:18:04] <jack> now it's double reference counted
[22:18:12] <jack> is that to control all the linux pointers as a group?
[22:18:42] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[22:19:03] <pcwalton> it's because Linux isn't reference counted
[22:19:05] <pcwalton> as far as I know
[22:19:14] <pcwalton> so we would either need two interfaces or to double reference count Mac
[22:19:20] <pcwalton> and I figured that the former wasn't worth it
[22:19:23] <pcwalton> in terms of complexity
[22:19:41] <jack> yeah, ARCs sound good for that. 
[22:21:13] *** Joins: jdm (jdm@moz-E4B91594.zone16.bethere.co.uk)
[22:22:05] <jack> why do youcall glXChooseFBConfig?
[22:22:43] <jack> it doesn't appear to ever get used
[22:24:03] *** Joins: burg (burg@moz-A644EFFF.dyn.cs.washington.edu)
[22:24:48] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[22:25:11] *** Quits: jyeo (user@F2D29657.F60B0462.67AC9B1.IP) (Input/output error)
[22:30:36] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[22:32:12] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
[22:32:27] *** Joins: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP)
[22:34:39] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[22:38:35] <pcwalton> jack: uh, let me look
[22:39:01] <pcwalton> jack: heh, you're right
[22:39:12] <pcwalton> there was some measure of bang-head-against-the-wall shotgun debugging :)
[22:39:15] <pcwalton> fixing
[22:39:40] <pcwalton> oh, I should get rid of the error!(), sorry
[22:42:02] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[22:48:05] *** Joins: ghservo (ghservo@E7A4CCE2.6A2AE50.F3114085.IP)
[22:48:06] <ghservo> 01[13servo01] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/F0J9Bg
[22:48:06] *** Parts: ghservo (ghservo@E7A4CCE2.6A2AE50.F3114085.IP) ()
[22:48:08] *** Joins: ghservo (ghservo@C8693FCB.6A2AE50.F3114085.IP)
[22:48:08] <ghservo> 01[13servo01] 15bors-servo pushed 4 new commits to 06auto: 02http://git.io/BJYrdQ
[22:48:08] <ghservo> 13servo/06auto 1439c3a6f 15Seth Fowler: Add HashCache and switch all caches from Copy to Clone
[22:48:08] <ghservo> 13servo/06auto 140ac5206 15Seth Fowler: Add utility methods to Range
[22:48:09] <ghservo> 13servo/06auto 14677fce2 15Seth Fowler: Cache shaped text at word granularity
[22:48:10] *** Parts: ghservo (ghservo@C8693FCB.6A2AE50.F3114085.IP) ()
[22:52:48] *** Joins: dholbert (dholbert@moz-EAA4454E.hsd1.ca.comcast.net)
[22:54:41] <dholbert> seth / eatkinson: see https://wiki.mozilla.org/Gecko:Continuation_Model for an overview of how fragmented layout (for pagination, multicol, etc) works in gecko
[22:54:53] * dholbert skims that briefly, & then heads over to chat
[22:57:25] *** Quits: burg (burg@moz-A644EFFF.dyn.cs.washington.edu) (Quit: burg)
[22:58:15] *** Joins: burg (burg@moz-A644EFFF.dyn.cs.washington.edu)
[22:58:54] *** Quits: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP) (Quit: pcwalton)
[22:59:50] *** Joins: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP)
[23:03:50] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[23:10:00] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[23:10:33] *** Quits: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au) (Quit: Leaving...)
[23:11:32] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[23:11:54] *** Joins: ghservo (ghservo@C8693FCB.6A2AE50.F3114085.IP)
[23:11:54] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/BJYrdQ
[23:11:54] *** Parts: ghservo (ghservo@C8693FCB.6A2AE50.F3114085.IP) ()
[23:14:43] <jack> pcwalton: how is this new sharegl going to be used? is it basically to create shared gl contexts to upload textures to?
[23:15:03] <jack> then pass them to the compositor?
[23:16:26] *** Quits: tjc (tjc@moz-508C89CD.lightspeed.irvnca.sbcglobal.net) (Quit: zzzzzzzzzz)
[23:17:31] *** Joins: tjc (tjc@moz-508C89CD.lightspeed.irvnca.sbcglobal.net)
[23:22:02] *** Joins: ghservo (ghservo@9C8B94D4.6A2AE50.F3114085.IP)
[23:22:02] <ghservo> 01[13sharegl01] 15metajack pushed 3 new commits to 06master: 02http://git.io/mGNXFQ
[23:22:02] <ghservo> 13sharegl/06master 143ca143d 15Patrick Walton: Add Linux offscreen GL context support, untested
[23:22:02] <ghservo> 13sharegl/06master 145ac0e3f 15Patrick Walton: Update the Linux functionality to use ARCs and make the Mac match....
[23:22:03] <ghservo> 13sharegl/06master 148034918 15Jack Moffitt: Merge pull request #7 from pcwalton/linux-arc...
[23:22:05] *** Parts: ghservo (ghservo@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:22:58] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[23:23:09] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[23:29:56] <pcwalton> jack: right
[23:30:04] <pcwalton> let me submit the PR for that now :)
[23:31:35] <jack> pcwalton: i think my plan is 1) modify my test cases to use glfw-rs and see if that fixes the bug. if so 2) port servo to glfw
[23:32:03] <jack> basically AzSkiaCreateSharedGLContext will take dpy and pixmap in addition to the glxcontext, which servo will get from glfw's native api
[23:32:14] <jack> you're code will need to do the same thing
[23:32:17] <jack> or you will have the same bug
[23:32:19] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[23:32:27] <jack> s/you're/your/
[23:33:36] <jack> the issue seems to be that there's a bug in the driver where it initializes the window multiple times becuase it iteraties over all pointers its seen, even if they point to the same window
[23:34:01] <jack> so you have to have the same exact Display* for each context
[23:35:46] <pcwalton> jack: ah, I see
[23:35:49] <pcwalton> great detective work
[23:36:38] *** Quits: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP) (Quit: pcwalton)
[23:37:11] <jack> that's why it's maddening to work around. all of these libraries purposefully hide those internal structures
[23:37:29] <jack> glfw is the only thing i've found so far that will actually return them aside from using EGL directly
[23:37:29] *** Joins: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP)
[23:38:02] <jack> and of course, because none of these things use EGL, you can't even lean on that
[23:38:34] <jack> iw rote a test program that fired up glut and tried to snoop the contenxt from EGL, but of course, eglInit() was never called, so nothing
[23:39:50] <jack> we could use EGL directly (seems to exist on linux and osx) but not sure how you do keyboard/mouse stuff then
[23:41:15] *** Joins: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP)
[23:43:05] *** Quits: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP) (Quit: lmandel)
[23:48:02] *** Quits: burg (burg@moz-A644EFFF.dyn.cs.washington.edu) (Quit: burg)
[23:59:37] *** Quits: eholk (eholk@B80996B4.83FFA18A.ABD5273E.IP) (Quit: eholk)
