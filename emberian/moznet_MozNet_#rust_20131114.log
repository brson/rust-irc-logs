[00:00:59] <tjc> ChrisMorgan: rustpkg should treat -O like --opt-level=2, like rustc does -- are you seeing different behavior?
[00:01:10] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[00:01:12] <ChrisMorgan> tjc: yes, optimisations not happening.
[00:01:17] <dbaupp> mark_edward: fwiw, I'd just drop the expect operations entirely, they're often pessimisations rather than optimisations anyway.
[00:01:29] <tjc> ChrisMorgan: what's the full command line you're typing and the output of rustpkg --version? (thanks)
[00:01:31] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[00:01:34] <dbaupp> mark_edward: you can add them back in later if you really neat them
[00:01:44] <mark_edward> dbaupp: yeah, you're right
[00:02:26] <ChrisMorgan> tjc: the inverse of https://github.com/chris-morgan/rust-http/commit/83fd0f928f8410d6d15d0150e829c96319c1d139, i.e. `rustpkg install -O -Z debug-info http`
[00:02:49] *** Quits: sam113101_afk (sam113101@moz-83612DFD.us-west-2.compute.amazonaws.com) (Quit: ZNC - http://znc.in)
[00:03:05] <ChrisMorgan> Now rustpkg --version shows 0.9-pre (825b127 2013-11-12 18:56:13 -0800), but it would have been from two days ago when I last confirmed the failure to optimise.
[00:03:30] <tjc> hmm
[00:04:27] <ChrisMorgan> Not sure whether debug-info was working or not, but performance (about half what was expected) indicates optimisation wasn't.
[00:05:19] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[00:06:01] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Client exited)
[00:07:22] <tjc> ChrisMorgan: did you do a "make clean" before rebuilding with rustpkg for the first time? It's entirely possible rustpkg doesn't hash flags as well as code when determining whether to rebuild
[00:07:32] <tjc> (if so, that's a bug, but a more minor one)
[00:07:55] <ChrisMorgan> tjc: I was continually running `make clean` as it wasn't rebuilding when the code was modified either, I believe.
[00:08:29] <ChrisMorgan> (That is, with a src/http/*/*.rs modified, not src/http/lib.rs.)
[00:08:39] <dbaupp> tjc, ChrisMorgan: https://github.com/mozilla/rust/issues/10309 ?
[00:09:15] <ChrisMorgan> dbaupp: that's part of the reason I made sure to be working on clean
[00:09:17] <tjc> dbaupp: Yeah, that was my guess, but it sounds like something bigger is happening here, given that ChrisMorgan said "I was continually running `make clean`"
[00:09:17] <tjc> yeah
[00:09:30] <dbaupp> ok
[00:09:33] <mimcpher> Luqman: see rust-dev re: your rustc running on arm
[00:09:38] * ChrisMorgan hasn't investigated it much and doesn't have time just now
[00:09:58] * dbaupp just knows how to link to bugs, not read the continuing discussion... ;)
[00:10:31] <mimcpher> Luqman: I'll give you credentials for my gumstix if you are interested in trying to debug it
[00:11:20] <tjc> ChrisMorgan: Ok, thanks for trying. I'll make an issue to investigate it more
[00:11:36] *** jorendorff_away is now known as jorendorff
[00:12:14] <ChrisMorgan> dbaupp: are you a bot with just a bit of a sense of humour?
[00:12:52] * dbaupp cannot find any bugs matching that description.
[00:13:36] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:13:40] <ChrisMorgan> I may (0.2 ≤ p ≤ 0.5) be able to investigate more tomorrow; it depends on a factor out of my control.
[00:13:53] <tjc> Reply hazy, try again
[00:14:02] *** Joins: prooftechnique (prooftechn@moz-65B7D4EE.hsd1.vt.comcast.net)
[00:14:17] <dbaupp> ChrisMorgan: you have a probability distribution on the probability you'll be able to investigate tomorrow?
[00:14:42] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[00:15:38] <ChrisMorgan> dbaupp: yes. Pretty cool, huh?
[00:16:00] <bjz> tjc: have to head off really soon, but I still get: failed at 'assertion failed: pkg_src.start_dir.join(p).exists()', /Users/brendan/dev/rust/rust/src/librustpkg/lib.rs:520
[00:16:32] <tjc> bjz: okay -- if your code is pushed in a branch, I can take a look
[00:16:36] *** Joins: alan (alan@32702EE8.939109B2.FB082A98.IP)
[00:17:35] <bjz> tjc: it's pushed
[00:17:54] <bjz> tjc: both sax and gl
[00:18:13] <bjz> tjc: the issue is with gl-rs/src/gen
[00:18:26] <tjc> bjz: ok -- which branch or branches?
[00:18:32] <bjz> tjc: master
[00:18:57] <tjc> bjz: ok, thanks, I'll take a look. if I can reproduce it, I'll make an issue and @-mention you
[00:19:25] <bjz> tjc: you have to change `use std::rt::io::{File, Reader, Writer};` to `use std::io::{File, Reader, Writer};` though - haven't yet pushed that seeing as I'm having issues with both methods
[00:19:42] <tjc> bjz: ok
[00:19:45] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[00:23:18] *** Joins: jeffdb (jeffbelg@moz-ABCAA64B.efi.com)
[00:23:53] <wycats_> woohoo
[00:23:58] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[00:24:16] <dbaupp> wycats_: it lives?
[00:24:45] <wycats_> it's aliv
[00:24:46] <wycats_> alive
[00:24:54] <wycats_> rust w/ stdlib w/o libstdc++
[00:25:01] <wycats_> acrichto is the best
[00:25:09] <acrichto> \o/
[00:25:36] <mimcpher> nice!
[00:25:49] <wycats_> :D
[00:26:16] <sfackler> cool! does task failure kill the whole program then?
[00:27:33] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[00:27:33] *** ChanServ sets mode: +ao brson brson
[00:27:49] <acrichto> sfackler: yeah it's just assert(false)
[00:28:17] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[00:28:28] <mimcpher> How invasive was the change?  Is it something that could reasonably be integrated?
[00:28:29] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[00:28:29] *** ChanServ sets mode: +ao pcwalton pcwalton
[00:29:03] <acrichto> mimcpher: writing up a plan of attack right now :)
[00:29:05] <acrichto> https://github.com/alexcrichton/rust/commit/4b2bb6fc741663bd8b68ae5ec91103289532d963
[00:29:10] <acrichto> that's the commit to drop c++
[00:31:11] *** Joins: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP)
[00:31:11] *** ChanServ sets mode: +o jdm
[00:31:19] <mimcpher> hmm, that doesn't look that horrible
[00:31:34] <acrichto> it's pretty bad safety-wise
[00:31:38] <acrichto> also pretty ad-hoc
[00:31:39] <sfackler> replacing new with malloc + placement new is kind of funny
[00:31:43] <mimcpher> oh, for sure
[00:31:57] <mimcpher> but as far as lobotomies go, there's been worse
[00:32:28] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[00:32:38] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[00:33:24] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[00:34:04] <acrichto> so placment new didn't work unless you had #include <new>
[00:34:07] <acrichto> I have no idea what that is
[00:34:09] <acrichto> or why it works
[00:34:11] <acrichto> but it compiled!
[00:35:14] *** Joins: dherman (dherman@5AB4884B.FCC4549.14D5B978.IP)
[00:35:14] *** ChanServ sets mode: +ao dherman dherman
[00:35:35] <mimcpher> it defines std::get_new_handler and whatever you need to make placement new work
[00:35:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:36:48] <ChrisMorgan> So, what's good about avoiding libstdc++, and is replacing the C++ exceptions-based task failure (as I understand it to be) with Something Else feasible or advisable?
[00:36:48] <acrichto> interesting
[00:37:03] <acrichto> ChrisMorgan: it would be nice! also hard
[00:37:26] <ChrisMorgan> What would be nice about it?
[00:37:39] * strcat thinks the most important thing is moving to mingw-w64 ASAP
[00:37:54] <strcat> need 64-bit windows support and non-broken tests
[00:38:29] <strcat> I'm not going to do it though :p
[00:38:54] <strcat> it would be nice to not need libgcc, gcc/ld and so on too but it doesn't really matter
[00:38:58] <strcat> as long as it works
[00:39:43] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[00:40:05] <acrichto> sfackler mimcpher: https://github.com/mozilla/rust/issues/10469
[00:40:57] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[00:40:57] *** ChanServ sets mode: +ao brson brson
[00:42:34] *** Joins: yuriks (yuriks@7AA6475F.89F39BB3.5419EADB.IP)
[00:43:22] <ChrisMorgan> I presume that since C++ implements exceptions it must be possible to implement them in C or Rust or assembler or something. But I take it that it would be a non-trivial effort? (I don't know precisely how stack unwinding is implemented.) I wonder whether any improvements could be made in switching to something else...
[00:44:22] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[00:44:25] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[00:45:18] <acrichto> ChrisMorgan: the biggest thing about them is that all destructors need to get run
[00:45:31] <acrichto> right now we use llvm's landing pad infrastructure for the codegen half of doing all that
[00:45:32] <ChrisMorgan> Oh yes, of course.
[00:45:37] <acrichto> and then some fancy glue to tie into C++ exceptions
[00:45:47] <acrichto> if you unwound the stack manually you'd have to know what destructors to run
[00:46:14] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[00:46:18] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[00:51:08] *** Quits: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net) (Quit: leaving)
[00:55:45] <wycats_> ChrisMorgan: tl;dr embedding libstdc++ is horrifying
[00:55:58] <wycats_> much more horrifying than embedding the rest of the runtime
[00:57:04] <wycats_> ChrisMorgan: I'm willing to accept fail -> abort as a starting point
[00:57:36] <strcat> I don't get why it's any worse than embedded libstd + libgcc_s + libuv
[00:57:41] <strcat> embedding*
[00:57:43] <ChrisMorgan> Horrifying seems a pretty extreme word to use.
[00:58:48] <wycats_> strcat: maybe I should explain my use-case
[00:58:53] <wycats_> ChrisMorgan: I don't think so
[00:59:07] <strcat> I would love for rust to move towards reporting errors with the return value so you can actually handle them, but atm so much of the stdlib uses failure for errors you can't predict before the call
[00:59:30] <strcat> I'm fine with abort on resource exhaustion, for the moment, but it's a pretty big code smell elsewhere
[00:59:42] <wycats_> ChrisMorgan: if I'm building a .so for people to link it, it's totally plausible for their application to also need libstdc++
[00:59:47] <wycats_> and libstdc++ changes often
[00:59:51] <strcat> wycats_: nope
[00:59:56] <strcat> stable ABI since 2006ish
[01:00:07] <strcat> rust will likely never be like that
[01:00:18] <wycats_> strcat: this is a canonical discussion, fwiw
[01:00:21] <ChrisMorgan> No, Rust won't have a stable ABI since 2006ish :P
[01:00:27] <wycats_> "libstdc++ is hard to embed"
[01:00:30] <strcat> wycats_: what do you mean canonical?
[01:00:31] <wycats_> "it has a stable ABI since 2006"
[01:00:56] <wycats_> let me go dig up the reasons why that isn't enough
[01:00:57] <strcat> and rust has and will have a stable ABI for less than a few days for years
[01:01:20] <wycats_> strcat: yep
[01:01:23] <strcat> in fact, the stdlib doesn't support stable ABIs
[01:01:30] <strcat> it has unrestricted type walking reflection
[01:01:41] <ChrisMorgan> Does name mangling help with instability of ABI?
[01:01:43] <strcat> so it's a non-argument with libstd
[01:01:54] <wycats_> ChrisMorgan: you have to do careful work to hide stuff
[01:02:00] <wycats_> which I have to rely on rust to do upstream
[01:02:04] <strcat> ChrisMorgan: not really
[01:02:12] <wycats_> strcat: you're missing something important
[01:02:13] <strcat> wycats_: rust isn't going to use stuff like PIMPL in the stdlib
[01:02:22] <strcat> and even if it did, reflection can walk priv fields
[01:02:30] <wycats_> I might be able to control whether there is other rust code running alongside me
[01:02:34] <strcat> so it would walk right through ~implementation
[01:02:36] <wycats_> but probably not C++
[01:02:52] <wycats_> strcat: you expect that the full C++11 spec to be implementable without changing the ABI?
[01:03:28] <strcat> so your argument is that we shouldn't use C++ because you want to use different versions of the C++ compiler/library in the same process
[01:03:45] <strcat> so we should just abort on any errors we currently unwind on
[01:03:51] <wycats_> no
[01:03:56] <wycats_> my argument is that when you're building an .so you want to make sure that your dependencies are stable
[01:04:14] <wycats_> because you *will* be linked into executables with versions of those same dependencies
[01:04:18] <strcat> we don't have to export the libstdc++ symbols
[01:04:36] <wycats_> and that there should be an *option* to abort if that's what's necessary to eliminate the instability
[01:04:37] <strcat> it (I guess just libsupc++/libc++abi) can be statically linked with the symbols not re-exported
[01:05:07] <wycats_> strcat: if someone did the work to be careful about statically linking libstdc++ and avoiding exporting the symbols, that would work too
[01:05:37] *** Joins: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net)
[01:06:04] *** Quits: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[01:06:46] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[01:08:00] <acrichto> ChrisMorgan: oh I should mention re unwinding that there was something a little while back about LLVM adding precise stack maps for one reason or another, and we may be able to use those with a libunwind implementation to perform our unwinding
[01:08:27] <acrichto> although I'm not sure what the status of that currently is inside llvm, and it would certainly require a large amount of work on our part to change codegen (at least I think)
[01:08:28] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[01:08:35] <strcat> afaik the LLVM project is planned to include a libunwind reimplementation
[01:09:58] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[01:10:58] <wycats_> strcat: are you saying that http://www.trilithium.com/johan/2005/06/static-libstdc/ is no longer the case?
[01:11:26] <wycats_> (btw: it's not difficult to images that people are running servers on distros that are older than whenever the latest libstdc++ made it into their stable branch)
[01:11:34] <wycats_> s/images/imagine/
[01:12:07] <strcat> wycats_: okay first of all I don't really understand why libstdc++ is the topic
[01:12:20] <strcat> the support we use comes from libsupc++ (or libc++abi) and libgcc_s
[01:12:20] <wycats_> strcat: it's an especially problematic dependency
[01:12:24] <strcat> exceptions come from libgcc_s
[01:12:39] <strcat> C++ unwinding personality comes from libsupc++ or libc++abi
[01:12:53] <strcat> on OS X, I guess something else supplies it - but elsewhere, libgcc_s does
[01:13:30] <strcat> linux distributions like to not split out libsupc++ because there's not much of a reason to do it
[01:14:07] <strcat> libc++abi is 300KiB
[01:14:16] <strcat> libcxxrt is smaller
[01:14:41] <strcat> I think the ABI in libsupc++ has probably been stable for ages...
[01:14:45] *** Joins: josh (josh@moz-CB62667A.tmodns.net)
[01:14:49] <strcat> unlike the stdlib they don't have many reasons to change it
[01:15:20] <wycats_> strcat: you should re-read my general request here as "try to avoid depending the runtime on things with even mildly unstable ABIs"
[01:15:29] <strcat> libuv?
[01:15:31] <wycats_> so if you're saying some dependency has a very stable ABI, I'm not talking abiut it
[01:15:36] <wycats_> about*
[01:15:38] <strcat> libuv breaks the ABI every week ;p
[01:15:53] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[01:16:02] <wycats_> libuv seems to be statically linked?
[01:16:04] <strcat> LLVM doesn't break the C ABI but they will have to now and then if it's not going to end up even more crufty/broken
[01:16:27] <strcat> wycats_: libc++abi can be statically linked, as can libsupc++, and even libc++/libstdc++
[01:16:43] <strcat> glibc can't be fully statically linked, to contrast with that
[01:16:49] <wycats_> but it's very stable
[01:16:56] <wycats_> strcat: like I said, if someone can figure out how to statically link that stuff *and* hide the symbols, that would be awesome
[01:16:59] <strcat> wycats_: it's not stable
[01:17:03] <strcat> glibc is forwards compatible
[01:17:09] <strcat> er
[01:17:11] <strcat> sorry
[01:17:19] <strcat> glibc isn't* forwards compatible
[01:17:26] <strcat> they do often change the ABI in ways that break that
[01:17:32] <wycats_> strcat: let's forget glibc for a second
[01:17:36] <wycats_> see ^^
[01:17:52] <wycats_> there are different ways to approach the problem
[01:18:07] <strcat> they provide backwards compatibility but you can't compile against a new glibc and run in a process with an old glibc
[01:18:10] <wycats_> but having my .so link in system libstdc++ et al isn't ok
[01:18:10] *** Quits: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net) (Ping timeout)
[01:18:13] <strcat> if it has symbols exposed
[01:18:32] <strcat> wycats_: alright, so there's no problem if libstdc++ is statically linked, right?
[01:18:33] <wycats_> strcat: I didn't know that
[01:18:42] <wycats_> strcat: statically linked with symbols hidden
[01:18:49] <wycats_> correct
[01:19:01] <strcat> they even broke the linux OS ABI
[01:19:11] <strcat> to add their dynamic dispatch based on CPU features
[01:19:31] <strcat> in a backwards compatible but not forwards compatible way
[01:20:36] <wycats_> so who wants to do that
[01:20:43] <wycats_> I'd love to see it
[01:20:58] <strcat> if you want to see something you have to do it yourself ;p
[01:21:29] <wycats_> I see
[01:21:41] <wycats_> unfortunately, it is WAY outside of my abilities at the moment
[01:21:51] <wycats_> I will revisit it when I get further along in my Rust studies
[01:22:10] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[01:22:56] *** Joins: muggle (Mibbit@moz-4FA0484A.lightspeed.cicril.sbcglobal.net)
[01:24:08] <muggle> hey everyone, what's the best way to exit a rust program?
[01:24:27] <tikue> muggle: with one task or multiple?
[01:24:37] <strcat> muggle: the idiomatic way would be exiting by having all of your tasks come to a clean end
[01:24:45] <muggle> one task
[01:24:47] <strcat> as in falling off the end of the functions (like main)
[01:25:07] <strcat> if there's an error condition, you can use fail!() and unwind (which will exit if no parent task handles it)
[01:25:11] <muggle> @strcat hmm, so there's no equivalent to exit()?
[01:25:19] *** Joins: carllerche (carllerche@moz-2B516F15.hsd1.or.comcast.net)
[01:25:19] <strcat> you can call libc exit but it won't be a clean exit
[01:25:27] <strcat> it will be memory safe obviously, but not idiomatic
[01:25:51] <strcat> well actually it won't be memory safe
[01:25:55] <strcat> the runtime breaks atexit
[01:26:01] <strcat> you can call _Exit
[01:26:19] <ChrisMorgan> libc exit is http://static.rust-lang.org/doc/master/std/libc/funcs/c95/stdlib/ffi.exit.html, I presume?
[01:26:27] <strcat> rust doesn't use stdio anymore so libc exit won't flush buffers and stuff anyway
[01:26:42] <strcat> might as well go all in with _Exit or quick_exit
[01:27:46] <ChrisMorgan> (Searching for "exit" in std suggested that, I don't see any _Exit or quick_exit.)
[01:27:49] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[01:28:20] <muggle> I also couldn't find the text in the rust compiler
[01:28:25] *** Quits: echristo (echristo@24D1937F.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[01:28:39] <muggle> @strcat is there any documentation for how to use _Exit?
[01:28:54] <Ralith> it's not part of rust
[01:29:26] <Ralith> that's rather the point
[01:29:26] <strcat> muggle: it's a libc function
[01:29:42] <strcat> ideally you could call exit but I remembered that it's broken
[01:29:45] <muggle> oh ok
[01:30:00] <ChrisMorgan> muggle: anyway, getting to the end of main() is the most desirable way to exit. That lends itself to later librification without the possibility of accidentally exiting.
[01:30:05] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[01:30:05] <strcat> I think libuv must install atexit handlers and we don't always have it in a sane state
[01:30:16] <strcat> ChrisMorgan: well, the end of main doesn't *really* exit, just with 1 task
[01:30:25] <strcat> tasks are essentially the detached thread model
[01:30:27] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[01:31:03] <muggle> ok, well thank you guys for your help
[01:31:23] *** Quits: pnathan (Adium@moz-E3C3FAF2.hfc.comcastbusiness.net) (Ping timeout)
[01:31:39] <strcat> (in C you can get the same by using pthreads with detached threads, and calling pthread_exit at the bottom of main to make it not implicitly call exit)
[01:32:09] * ChrisMorgan has run across problems with undesirable exits in Python before where importing a library triggers exit if a certain thing hasn't been initialised—on his machine, `help('modules')` never completes, saying "Use bootstrap.py and buildout to create executable" and exiting instead.
[01:32:46] <strcat> well, python modules are singletons ;p
[01:33:01] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[01:33:18] <strcat> they have a ctor (the contents) that builds them, and it prevents running it twice on a re-import ;]
[01:33:22] * strcat finds it very weird, as a default
[01:33:55] * ChrisMorgan only finds fault with it where people don't take care designing it for idempotence
[01:34:08] <strcat> it's funny when you import parts of nltk and it takes 10s to load data from the disk and deal with it
[01:34:20] <ChrisMorgan> It's a very powerful feature that, when used with care, improves various things.
[01:35:01] <strcat> ChrisMorgan: well, I agree - C++ has ctor/dtor calls as part of statics (including thread-local variables) and it's awesome when you need it but not when other people used it for no reason ;p
[01:35:31] <strcat> they actually had to add funny thread_local dtor handling as part of C++11, I guess to the linker...
[01:35:41] <ChrisMorgan> Ah yes, it was rst2pdf with a `raise SystemExit(...)` in the tests/autotest.py.
[01:38:00] *** jorendorff is now known as jorendorff_away
[01:40:55] <ChrisMorgan> Wow, when I fix up the rst2pdf failure I discover it gets even worse—kivy starts trying to run a test of some sort and then pygame crashes the entire thing with a segfault.
[01:41:26] <ChrisMorgan> That all suggests that there are indeed various things that have *not* been designed as import-safe, which is a *very* bad thing.
[01:41:26] *** Quits: tikue (tkuehn@561622AD.21C37D63.689607DE.IP) (Quit: tikue)
[01:41:28] <strcat> the python libgit bindings are fun
[01:41:32] <strcat> lots of segfaults!
[01:41:53] <strcat> I hit more segfaults with it than I ever have with libgit in C ;s
[01:42:27] <strcat> it relies on cpython having deterministic refcounting (when there are no cycles) and stuff being freed by __del__ in the right order :)
[01:42:35] <ChrisMorgan> Eek.
[01:43:09] <strcat> /usr/include/pthread.h:#define PTHREAD_CREATE_DETACHEDPTHREAD_CREATE_DETACHED
[01:43:11] <strcat> haha
[01:43:28] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:43:40] <strcat> ah it's an enum
[01:43:51] <strcat> #[repr(C)] enum to the rescue!
[01:44:01] * ChrisMorgan wonders why that is necessary
[01:44:05] *** Quits: nejucomo (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[01:44:37] <ChrisMorgan> I'm confident there must be a reason (please!) but haven't got a clue what it could be.
[01:44:39] <strcat> ChrisMorgan: it's supposed to be a macro
[01:44:41] <strcat> but it's an enum
[01:44:54] <strcat> so... they make it a macro replacing itself with itself ;p
[01:44:54] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[01:45:01] <strcat> they do this a *lot*
[01:45:05] <strcat> I don't know why
[01:45:09] <ChrisMorgan> So that any #ifdef works.
[01:45:13] <strcat> ah right
[01:45:41] <aatch> I assume that the standard says "There will be a PTHREAD_CREATE_DETACHED macro" or something.
[01:45:45] <strcat> yes
[01:45:49] <aatch> So they have to make it a macro
[01:46:01] <strcat> enum
[01:46:02] <strcat> {
[01:46:03] * ChrisMorgan finally understands why it exists and why it must be defined in that way
[01:46:04] <strcat>   PTHREAD_CREATE_JOINABLE,
[01:46:06] <strcat> #define PTHREAD_CREATE_JOINABLE PTHREAD_CREATE_JOINABLE
[01:46:08] <strcat>   PTHREAD_CREATE_DETACHED
[01:46:10] <strcat> #define PTHREAD_CREATE_DETACHED PTHREAD_CREATE_DETACHED
[01:46:12] <strcat> };
[01:46:14] <strcat> pretty weird imo
[01:46:15] *** Quits: nkoep (nik@moz-B92E790B.pool.mediaways.net) (Client exited)
[01:46:28] <strcat> I wonder if any OS adds another detached mode that's not "detached" or "not detached (joinable)"
[01:46:31] <aatch> I know that the reason for the enum is so the symbols are in the debug info
[01:46:38] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[01:47:13] <strcat> rusti: enum _ {}
[01:47:13] -rusti- <anon>:9:14: 9:15 error: expected ident, found `_`
[01:47:13] -rusti- <anon>:9          enum _ {}
[01:47:13] -rusti-                        ^
[01:47:13] -rusti- application terminated with error code 101
[01:47:20] <strcat> :(
[01:48:11] <aatch> Yeah, you can't have an ignored type name.
[01:48:48] <strcat> hm, is there a guarantee that a C enum without definitions starts at 0 and increments by 1? I assumed no but...
[01:49:04] <strcat> I know it *will* do it on linux so maybe I shouldn't bother with this
[01:49:09] <strcat> linux-specific anyway
[01:49:47] <sfackler> it is guaranteed iirc
[01:50:18] *** Quits: TeXitoi (texitoi@moz-EA958D66.texitoi.eu) (Ping timeout)
[01:50:22] *** Joins: TeXitoi (texitoi@moz-EA958D66.texitoi.eu)
[01:50:23] *** jorendorff_away is now known as jorendorff
[01:56:06] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[01:56:58] <aatch> strcat, it is in the standard
[01:57:29] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[01:57:29] *** ChanServ sets mode: +ao pcwalton pcwalton
[01:57:45] <aatch> Part 6.7.2.2 paragraph 3
[01:57:53] <aatch> of the ISO C11 standard
[01:57:59] <aatch> http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf
[01:58:14] *** Quits: josh (josh@moz-CB62667A.tmodns.net) (Ping timeout)
[01:58:31] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[01:59:27] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[02:00:20] *** Quits: muggle (Mibbit@moz-4FA0484A.lightspeed.cicril.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:00:39] <wycats_> erickt: yo
[02:00:45] <erickt> yo
[02:00:49] <wycats_> erickt: I'll be in the Bay Area for the Rust meetup
[02:00:50] *** Quits: notmatt (notmatt@moz-6071FD3.lightspeed.sntcca.sbcglobal.net) (Client exited)
[02:00:53] <wycats_> can I give a lightning talk?
[02:00:56] <erickt> sure!
[02:01:02] <wycats_> on the stuff acrichto is helping me with
[02:01:27] <wycats_> sweet
[02:02:06] <erickt> brson: ping
[02:03:03] <dbaupp> erickt: https://github.com/erickt/rust-mustache/pull/6 r?
[02:03:19] *** Joins: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[02:03:42] <erickt> dbaupp: merged, thanks!
[02:03:59] *** Quits: bholley (anonymous@moz-24EDB000.hsd1.ca.comcast.net) (Quit: bholley)
[02:04:04] <dbaupp> \o/
[02:05:14] <wycats_> rust-mustache, yuno rust-handlebars ;)
[02:05:32] <wycats_> rust would need a parser generator story first
[02:06:19] <erickt> wycats_: well there is https://github.com/erickt/ragel, but that's not a full state machine
[02:06:38] <wycats_> it would need to be yacc-like I think
[02:06:52] <wycats_> see https://github.com/wycats/handlebars.js/blob/master/src/handlebars.l
[02:06:58] <wycats_> and https://github.com/wycats/handlebars.js/blob/master/src/handlebars.yy
[02:07:10] <ChrisMorgan> erickt: remember rust-ci also.
[02:07:12] <wycats_> the grammar is somewhat more complex than mustache
[02:07:17] *** jorendorff is now known as jorendorff_away
[02:07:21] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[02:07:25] <mimcpher> erickt: <3 ragel!
[02:07:45] <wycats_> me too!
[02:08:04] <mimcpher> Bias: I worked with the ragel author for a while, and he introduced me to state machines / grammars :P
[02:09:11] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[02:10:00] <ChrisMorgan> Would it be possible (I care not whether it is deemed wise or not—I just care about the feasibility) for libsyntax to use a ragel-based parser? If it did, could it have the same facility of debugging?
[02:11:16] <mimcpher> Ragel's not quite powerful enough to parse a programming language
[02:11:25] *** jorendorff_away is now known as jorendorff
[02:11:27] <tjc> ChrisMorgan: I don't know much about ragel, but as long as the performance isn't worse than the existing parser, I imagine a replacement for the current hand-coded parser would be welcome
[02:11:50] <mimcpher> It's nice for parsing stuff like HTTP, simple template languages
[02:11:54] <tjc> AIUI, no one has finished a parser generator for Rust yet because the hand-written one is just good enough, rather than for any principled reason
[02:12:17] <erickt> the trouble with parser generators IMHO is it's difficult to get good syntax error messages
[02:12:41] <ChrisMorgan> I'm certainly not proposing *doing* it, I'm just wondering based a little also on a project of my own which is a tolerably complex text-based language. I've been writing my own parser for it with good error messages, spans on all the nodes and whatnot.
[02:12:46] <erickt> my ragel fork does not generate rust HEAD compatible code, I need to update it
[02:13:32] <erickt> ChrisMorgan: I'm a big fan of rust-ci :)
[02:14:21] *** Joins: Sgeo (quassel@moz-D0F30617.dyn.optonline.net)
[02:16:12] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[02:16:27] <erickt> I must run now though, back in an hour or so if anyone wants to talk more about ragel :)
[02:16:52] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:16:58] *** Quits: carllerche (carllerche@moz-2B516F15.hsd1.or.comcast.net) (Quit: carllerche)
[02:17:25] *** Joins: Jesin (Jesin@moz-14E09ADA.cc.lehigh.edu)
[02:18:06] * ChrisMorgan wonders why rustpkg produces a library that is not bitwise-identical with the rustc-produced library
[02:18:16] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[02:18:29] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:18:29] <tjc> ChrisMorgan: off the top of my head, it could be because of metadata
[02:18:35] <tjc> rustpkg adds a package_id attribute
[02:18:41] <tjc> Though, I think a patch landed that made rustc do the same thing...
[02:18:55] <ChrisMorgan> http defines package_id.
[02:18:57] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Quit: Leaving...)
[02:19:23] <ChrisMorgan> Changes in the metadata would change the filename hash anyway, wouldn't they? (They're the same.)
[02:19:27] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[02:20:24] <ChrisMorgan> Weird. Size looks to be nondeterministic.
[02:21:29] *** Quits: Siyo (Siyo@A89938F4.87DAA49F.F113998C.IP) (Ping timeout)
[02:22:18] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[02:22:39] <tjc> hmm
[02:22:48] <tjc> I thought the filename hash was just based on the contents
[02:22:55] <tjc> Well, the contents of the metadata
[02:22:55] <tjc> so yes
[02:23:06] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[02:23:14] <tjc> Does rustc always produce a bitwise-identical library when compiling the same code?
[02:23:21] <ChrisMorgan> Not sure, haven't compared it.
[02:23:36] <ChrisMorgan> I would certainly *expect* compilation to be deterministic!
[02:23:45] <tjc> well
[02:24:01] <tjc> I'm just thinking of how unique names get introduced by the compiler
[02:24:08] <dbaupp> it probably doesn't; hashmaps are seeded randomly
[02:24:17] <tjc> ah, ok, dbaupp 's reason is better :-)
[02:24:30] <ChrisMorgan> And so the name mangling is non-deterministic?
[02:24:48] <Amaranth> Folks are going through lots of pain in the C/C++ world to setup reproducible builds, I hope rustc doesn't have some of the same problems
[02:24:52] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[02:24:52] <dbaupp> not sure
[02:25:00] <ChrisMorgan> That sounds to me like a problem. You distributed a binary—and we can't produce a bitwise-equivalent build.
[02:25:15] * ChrisMorgan will officially declare himself Baffled (B) and Out Of Time For Now (OOTFN).
[02:25:30] <dbaupp> acrichto: do you happen to know if we have deterministic builds, or if the random-seeding of hashmaps leak into the binaries?
[02:26:03] <acrichto> dbaupp: that's a good question, I can't think of anything off the top of my head that would make builds nondeterministic
[02:26:10] *** Joins: Siyo (Siyo@A89938F4.87DAA49F.F113998C.IP)
[02:26:12] <acrichto> time-wise is always different, but the output should be the same 
[02:26:26] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[02:26:50] <tjc> acrichto: I was thinking that generating unique names for temporaries that the compiler introduces might have something nondeterministic about it
[02:27:51] <acrichto> it might, I certainly don't know the entire compilation proces
[02:28:12] <tjc> yeah, I certainly don't either
[02:28:37] <tjc> I think the question is more like: are there *any* compilers (for any language you want) that guarantee deterministic builds? =)
[02:28:39] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[02:29:22] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[02:29:51] *** Joins: twocoat (twocoat@moz-F9806A3F.stny.res.rr.com)
[02:31:03] <cmr> tjc: clang does.
[02:31:17] <tjc> cmr: interesting, do they mention that in their documentation?
[02:31:17] <cmr> the depend on it for their build+test system.
[02:31:29] *** jorendorff is now known as jorendorff_away
[02:31:31] <acrichto> it'd be kinda nice if we did, especially if we're really close to it
[02:32:05] <cmr> tjc: I don't think so, unfortunately
[02:32:48] <cmr> acrichto: I'm pretty sure LLVM is deterministic, though we might have to give it a seed
[02:33:35] <cmr> sfackler: re: rust-postgres: yes, that's a good idea
[02:34:00] *** Joins: p_adams (p_adams@moz-6E953D23.dhcp.stls.mo.charter.com)
[02:34:32] *** Quits: meTaAU_ (admin@moz-C1AB960F.lns20.per2.internode.on.net) (Ping timeout)
[02:34:48] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[02:35:01] <dbaupp> I just compiled `fn main() { println("hello world"); }` 4 times (with -O) and the sizes are 9091, 9092, 9091, 9092 and the ones with the same size differ.
[02:35:07] *** Joins: meTaAU (admin@moz-B95CBDD6.lns20.per1.internode.on.net)
[02:35:10] *** p_adams is now known as yrdz
[02:35:11] <dbaupp> (and similarly without -O)
[02:35:40] <twocoat> interference pattern
[02:35:54] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[02:36:41] <tjc> dbaupp: This is all with rustc (rather than rustpkg)?
[02:36:52] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[02:37:09] <Edwards> dbaupp: diff them?
[02:37:25] <dbaupp> tjc: yes
[02:37:28] <tjc> interesting
[02:37:46] <dbaupp> Edwards: you mean to see the actual bytes that differ?
[02:38:07] <Edwards> Yeah
[02:38:19] <Edwards> Mine seems to produce 9232 every time
[02:38:35] <tjc> what OS and architecture are you using, dbaupp and Edwards 
[02:38:36] <tjc> ?
[02:38:43] <dbaupp> x86-64 linux
[02:38:58] <Edwards> x86_64 Darwin
[02:39:02] <Edwards> (OSX Mavericks)
[02:39:03] <tjc> Interesting
[02:39:05] *** Quits: yrdz (p_adams@moz-6E953D23.dhcp.stls.mo.charter.com) (Quit: WeeChat 0.4.2)
[02:39:06] <tjc> maybe Linux is different somehow
[02:39:13] <dbaupp> http://ix.io/91s output of `cmp -l x y`
[02:39:44] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[02:40:55] <dbaupp> Edwards: are they identical binaries?
[02:41:23] <Edwards> Yep
[02:41:52] <Edwards> dbaupp: What's the exact command you're running?
[02:41:58] <Edwards> (Just to rule that out too)
[02:42:16] <dbaupp> `for i in {1..4}; do rustc hello-world.rs -o hw$i -O; done`
[02:42:20] <strcat> tjc: LLVM optimization passes do a good job normalizing it ;p
[02:43:03] <tjc> strcat: You mean normalizing differences between platforms? or between different builds on the same platform?
[02:43:11] <Edwards> dbaupp: Yeah, they're all 9232 for me.
[02:43:13] <Edwards> Weird.
[02:43:38] <strcat> tjc: I mean rustc sometimes does stuff differently but LLVM normalizes it between builds
[02:43:49] <tjc> ah, ok
[02:43:57] <strcat> afaict the symbol names stay the same
[02:44:03] <tjc> well, Mac vs. Linux *might* affect what LLVM does
[02:44:04] <strcat> we must sort that
[02:44:05] <tjc> not sure
[02:44:22] <strcat> or I guess the ids correspond to deterministic node ids
[02:44:45] <cmr> vadimcn: I read the greenthread discussion and it sounds interesting but I don't know enough about it to be able to intelligently respond :)
[02:44:49] <strcat> I've been successfully using the stage2 libs for the compiler built against the stage1 libs with my nightly build for weeks (months?)
[02:44:58] <strcat> just symlinking them
[02:45:14] <strcat> could build stage3 but... it sure takes a long time already ;p
[02:45:15] <cmr> vadimcn: I think we'd probably end up with something kinda simillar for forkjoin
[02:45:50] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[02:46:10] <strcat> cmr: well, the 1:1 user-mode scheduling or just the current M:N scheduling would work for fork-join
[02:46:24] <Edwards> dbaupp: What if you add '--emit-llvm -S' in there?
[02:46:43] <strcat> or you could just spawn a bunch of pthreads with SCHED_BATCH on linux and it will probably be good enough ;p
[02:47:04] <strcat> (would be good if it had more tunables)
[02:47:11] <Edwards> If those are different, it might be a more readable way to figure out what the difference is.
[02:48:07] <dbaupp> http://ix.io/91t hm, maybe it's the -o
[02:48:21] <strcat> do you just mean bytecode?
[02:48:24] <strcat> bytecode is platform specific
[02:48:25] *** Joins: Jessin (Jesin@moz-14E09ADA.cc.lehigh.edu)
[02:48:32] <strcat> (including the textual LLVM IR)
[02:48:41] <strcat> even if you aren't doing anything different in the code
[02:48:58] *** Quits: Jesin (Jesin@moz-14E09ADA.cc.lehigh.edu) (Ping timeout)
[02:48:58] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:49:27] <dbaupp> ah, ok, running, `for i in {1..4}; do rustc hello-world.rs -o hw -O; mv hw hw$i; done` gives me the same thing each time
[02:49:38] <dbaupp> (i.e. constant -o for the runs)
[02:49:39] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:51:22] <Edwards> dbaupp: So if you change the -o parameter, it changes the compiler output? o_0
[02:52:25] <tjc> That would make sense if it's using the -o name to make the package ID
[02:52:29] <tjc> I don't know if it is or not
[02:53:07] <dcrewi> is there a path that points to the crate's root module?
[02:53:14] <dbaupp> so if I give it something explicitly with #[link(name="...")] it should be ok?
[02:53:17] <Edwards> Anyway, I don't know enough about Rust name mangling to interpret what the difference is there, but it looks like that extra byte is just coming from the size of the main symbol.
[02:53:43] <dbaupp> dcrewi: in what context? you can write `::absolute::path()` as an expression, and `use` starts at the crate root by default
[02:54:10] <brson> erickt: pong
[02:54:47] <mark_edward> Ceylon has hit 1.0 with an IDE http://ceylon-lang.org/blog/2013/11/12/ceylon-1/ i feel like other new languages are going to hit 1.0 with way more batteries included...
[02:55:10] <dbaupp> ah, yep, putting `#[link(name="hello_world")];` gives the same output each time, independent of the -o.
[02:55:46] *** Quits: twocoat (twocoat@moz-F9806A3F.stny.res.rr.com) (Client exited)
[02:56:06] <dcrewi> dbaupp: I'm trying to remove those weird extra::extra and std::std modules by doing something like `pub use extra = some_path_that_means_crate_root;`
[02:56:59] <dbaupp> dcrewi: maybe `use extra = self;`
[02:57:11] <cmr> mark_edward: my best guess at a 1.0 release is 6-9 months
[02:57:12] <dbaupp> dcrewi: or... `use extra = some_module::super;`
[02:57:36] <dcrewi> dbaupp: super can't be used in ident position, but self sounds promising
[02:57:51] <dbaupp> dcrewi: (they shouldn't need `pub use` btw.)
[02:58:09] <dcrewi> well the mod that's there now is pub
[02:58:25] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[02:58:26] <dbaupp> yeah, it just hasn't had the pub removed after the privacy changes
[02:58:54] <mark_edward> cmr: will we have sick IDE's and HTML and buildscript libraries though. i mean Go hit 1.0 with a http server included
[02:58:56] <dbaupp> (iirc the std inner module isn't pub.)
[02:59:20] <tjc> mark_edward: I don't think any of those are part of the 1.0 milestone, but if somebody contributes them, they will be included :-)
[02:59:22] <dbaupp> mark_edward: how many people will adopt a language specific IDE?
[02:59:34] <dbaupp> (rather than using VS or Eclipse plugins, I mean.)
[02:59:34] <SiegeLord> Isn't that thing just an eclipse plugin?
[02:59:52] <cmr> SiegeLord: yes
[03:00:09] <dbaupp> "eclipse based"
[03:00:25] <cmr> mark_edward: we have an http server now
[03:00:29] <SiegeLord> Someone could just spend some time on the existing Rust plugin (iirc it exists)
[03:00:42] <SiegeLord> (not me, I don't like Eclipse :P)
[03:01:30] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[03:01:57] *** Quits: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP) (Ping timeout)
[03:02:58] <mark_edward> can rust do continuous compilation thingies like Java/Eclipse?
[03:03:11] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Quit: nwmcsween)
[03:03:35] <cmr> Incremental compilation? Not yet, no.
[03:03:54] <dcrewi> dbaupp: self doesn't work either
[03:04:45] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[03:04:45] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:05:09] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[03:05:32] <dbaupp> dcrewi: oh :(
[03:06:01] <dbaupp> dcrewi: you could possibly replace it with `mod std { pub use super::*; }`
[03:06:36] <dcrewi> or I could go back and try to figure out why I'm trying to do this in a first place and whether I really need to
[03:06:43] <dbaupp> haha
[03:08:22] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:08:24] <strcat> 'glibc doesn't free thread stacks when threads exit; it caches them for reuse, and only prunes the cache when it gets huge' great
[03:08:28] <strcat> I thought I did it wrong
[03:08:32] * strcat sighs
[03:08:39] <strcat> I guess I need to loop a bunch of times
[03:08:52] * strcat doesn't think that's it though...
[03:08:59] <dbaupp> what's "huge"?
[03:09:19] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[03:09:25] <strcat> I don't know I think it's wrong
[03:09:27] <strcat> it looks like a race to me
[03:09:40] <strcat> setdetachstate to PTHREAD_CREATE_DETACHED doesn't seem to do anything
[03:09:41] <strcat> in C either
[03:09:56] * strcat only really uses joinable threads...
[03:10:53] <strcat> meh
[03:10:57] <strcat> it doesn't leak more in a loop
[03:11:01] <strcat> still.
[03:11:03] <strcat> seems wrong
[03:13:00] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[03:13:00] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:14:51] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[03:20:01] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[03:22:09] *** Joins: alisdair (textual@BD70E91E.603F78BB.4F048BDC.IP)
[03:22:42] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[03:23:51] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[03:24:07] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[03:24:24] *** Quits: dherman (dherman@5AB4884B.FCC4549.14D5B978.IP) (Quit: dherman)
[03:25:32] *** Quits: jordyd (jordyd@moz-383C39FB.seg58.ucf.edu) (Quit: Leaving)
[03:25:41] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[03:26:02] *** Quits: JanC (janc@moz-1862E1D9.dsl.scarlet.be) (Ping timeout)
[03:26:44] <strcat> yeah I guess it's just cache.
[03:27:56] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[03:28:00] *** Joins: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP)
[03:28:13] *** jorendorff_away is now known as jorendorff
[03:28:50] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[03:28:56] *** Joins: jordyd (jordyd@moz-383C39FB.seg58.ucf.edu)
[03:30:12] <strcat> ah detached threads are just totally broken in valgrind ;p
[03:30:35] <strcat> linux has a way to zero the integer out of the cache but... vg doesn't seem to understand it's okay
[03:30:59] *** Joins: jeff_ (jeff@moz-E6A9E8C9.hsd1.or.comcast.net)
[03:31:41] *** Quits: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[03:31:51] <cmr> Well the ML was a fun read today
[03:32:09] *** Joins: ercxx (ercan@moz-8383857F.dyn.optonline.net)
[03:32:39] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[03:32:46] *** Joins: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[03:32:57] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Input/output error)
[03:34:26] <ercxx> rusti: use std::ptr; let p = ptr::mut_null::<int>(); unsafe{ *p = 20; }
[03:34:27] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[03:34:39] <ercxx> What am I doing wrong here?
[03:35:18] <SiegeLord> You are dereferencing a null pointer
[03:35:41] <ercxx> That's exactly what rust is against right?
[03:35:48] <strcat> in safe code
[03:35:49] <cmr> ercxx: you're using unsafe code
[03:36:03] <ercxx> One of the reasons rust exist is so people like me don't do these things?
[03:36:14] <cmr> the type system won't let you get or seta NULL pointer
[03:36:16] <dbaupp> yes
[03:36:21] <dbaupp> but you're using unsafe.
[03:36:31] <cmr> but unsafe code, it's up to you to verify memory safety.
[03:36:53] <dbaupp> I think there's a lint that disallows unsafe {} blocks, so you can set the compiler to check that none are happening.
[03:36:59] <ercxx> So first create a non-null ptr?
[03:37:26] <strcat> ercxx: just don't use a raw pointer
[03:37:51] <ercxx> I am having hard time with ownerships and stuff.
[03:37:59] <strcat> a raw pointer won't make that easier
[03:38:11] <strcat> it just makes it your responsibility to stay correct instead of the compiler's
[03:38:31] <strcat> you might use one for performance reasons but it's not going to make semantics easier
[03:38:50] *** Joins: z0w0 (zack@moz-EC26A2C.qwl9.woo.bigpond.net.au)
[03:39:30] *** Quits: zz_kimundi (kimundi@moz-A21FC351.dip0.t-ipconnect.de) (Ping timeout)
[03:39:38] <ercxx> I'm trying to make a graph-ish thing and a node might have multiple exits and I also want loops.
[03:39:38] *** Quits: jeff_ (jeff@moz-E6A9E8C9.hsd1.or.comcast.net) (Quit: jeff_)
[03:40:16] <ercxx> I just can't figure it out.
[03:40:22] <dbaupp> have a vector of nodes, and use indices into that vector as the "pointers" between notes
[03:40:25] <dbaupp> *nodes
[03:40:27] <strcat> ercxx: use managed pointers then
[03:40:31] <strcat> you really don't want raw pointers
[03:40:35] <strcat> it's going to make that far harder
[03:40:46] <strcat> you'll be responsible for *somehow* cleaning up the cycles
[03:41:01] <strcat> and you'll have to allocate the memory and manage the lifetime yourself
[03:41:03] <strcat> just like C
[03:41:08] <ercxx> dbaupp: I didn't want to do it for some reason.
[03:41:10] <strcat> generally you don't make cyclic data structures in C
[03:41:32] <strcat> avoiding cyclic ownership, cycles that aren't expressing ownership are fine
[03:41:42] *** Joins: JanC (janc@moz-99E5AB10.dsl.scarlet.be)
[03:41:45] <strcat> (parent pointers)
[03:42:08] <ercxx> I don't care about the ownership really. I mean I just want to be able to find the linked nodes.
[03:42:26] <strcat> you care about the ownership if you're using raw pointers
[03:42:33] <strcat> you have to
[03:42:37] <ercxx> I know
[03:42:47] <dbaupp> ercxx: "for some reason"?
[03:43:00] <ercxx> dbaupp: None particular :)
[03:43:19] <strcat> ercxx: just use managed pointers for this, unless you want to figure out another representation
[03:43:34] <dbaupp> it'll have to be @mut
[03:43:41] *** Joins: zz_kimundi (kimundi@moz-3CF1A7E.dip0.t-ipconnect.de)
[03:43:41] <ercxx> strcat: I wanted to avoid those since they were going away.
[03:43:58] <strcat> ercxx: they are going away in the sense that they are becoming a library type
[03:44:01] <strcat> you can migrate to that
[03:44:02] *** zz_kimundi is now known as kimundi
[03:44:03] <ercxx> I also tried RCMut but rust doesn't like them in structs.
[03:44:12] <strcat> it allows RcMut in a struct
[03:44:18] <strcat> but it's not going to let you make cycles
[03:44:44] <cmr> strcat: was the caching thing you mentioned why we're slower than glibc in the silly task spawning thing with mmap?
[03:44:46] <ercxx> they can't be freezed or sent when I do.
[03:45:07] <strcat> cmr: maybe
[03:45:08] <strcat> it's unclear
[03:45:18] <strcat> I decided not to put detached thread support in rust-core
[03:45:26] <strcat> they are broken with valgrind/helgrind ;p
[03:45:39] <strcat> 'Round up all finished threads using pthread_join. Avoid detaching threads: don't create threads in the detached state, and don't call pthread_detach on existing threads.'
[03:45:55] <strcat> 'Using pthread_join to round up finished threads provides a clear synchronisation point that both Helgrind and programmers can see. If you don't call pthread_join on a thread, Helgrind has no way to know when it finishes, relative to any significant synchronisation points for other threads in the program. So it assumes that the thread lingers indefinitely and can potentially interfere indefinitely
[03:45:56] <strcat> with the memory state of the program. It has every right to assume that -- after all, it might really be the case that, for scheduling reasons, the exiting thread did run very slowly in the last stages of its life.'
[03:45:58] <strcat> so yeah
[03:47:53] *** jorendorff is now known as jorendorff_away
[03:48:22] *** jorendorff_away is now known as jorendorff
[03:53:31] *** Quits: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Quit: )
[03:54:49] *** Joins: carllerche (carllerche@moz-48FA6EE9.hsd1.or.comcast.net)
[03:58:18] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[03:58:48] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[04:03:04] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[04:09:12] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Ping timeout)
[04:10:02] *** Quits: Jessin (Jesin@moz-14E09ADA.cc.lehigh.edu) (Ping timeout)
[04:11:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[04:11:41] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:14:27] *** Quits: alisdair (textual@BD70E91E.603F78BB.4F048BDC.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:15:56] *** Quits: prooftechnique (prooftechn@moz-65B7D4EE.hsd1.vt.comcast.net) (Quit: )
[04:16:01] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[04:16:30] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[04:17:17] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[04:18:22] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[04:23:14] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[04:24:42] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[04:26:06] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Connection reset by peer)
[04:26:16] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[04:27:59] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[04:34:38] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[04:34:54] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[04:38:06] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[04:38:07] *** ChanServ sets mode: +ao brson brson
[04:39:50] *** Joins: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP)
[04:39:50] *** ChanServ sets mode: +o jdm
[04:41:59] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[04:41:59] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:46:18] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Quit: )
[04:48:59] <bjz> tjc: ping
[04:49:07] <tjc> bjz: pong
[04:49:15] <bjz> tjc: any luck?
[04:49:33] <tjc> bjz: I filed a bug where I @-mentioned you… let me see which one it was
[04:49:39] <bjz> oh ok
[04:49:45] <bjz> will check
[04:49:49] <bjz> thanks!
[04:50:09] <tjc> bjz: https://github.com/mozilla/rust/issues/10470
[04:50:24] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[04:50:36] <mark_edward> how come rust-nightly isn't updated nightly anymore :(
[04:58:00] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[04:58:51] *** Joins: josh (josh@moz-6FB23C25.hvc.res.rr.com)
[04:58:58] <bjz> tjc: https://github.com/mozilla/rust/issues/10470#issuecomment-28459614
[04:59:38] <tjc> bjz: I fixed a bug (recently) that meant rustpkg always assumed the top-level dir had a crate file...
[04:59:54] <tjc> but I think it still exhibits the same bug when it comes to automatically-downloaded dependencies
[05:01:36] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[05:02:27] <bjz> tjc: ok cool
[05:02:43] <bjz> tjc: yeah, sorry - just keeping you on your toes ^_^
[05:12:19] *** Quits: KindOne (KindOne@moz-3B9F6C7F.dynamic.ip.windstream.net) (Ping timeout)
[05:12:19] *** Quits: yuriks (yuriks@7AA6475F.89F39BB3.5419EADB.IP) (Ping timeout)
[05:15:59] *** Joins: KindOne (KindOne@moz-63070F9.dynamic.ip.windstream.net)
[05:16:17] *** Quits: carllerche (carllerche@moz-48FA6EE9.hsd1.or.comcast.net) (Quit: carllerche)
[05:16:59] *** Joins: yuriks (yuriks@ECB1DF0D.88B480FC.748B6D8D.IP)
[05:19:26] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:19:54] *** Quits: RageOfThou (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[05:21:53] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[05:23:27] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[05:24:52] *** Quits: josh (josh@moz-6FB23C25.hvc.res.rr.com) (Quit: josh)
[05:27:06] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[05:28:48] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[05:29:18] *** Joins: mib_s37o4d (Mibbit@ECD463D1.B1C7B5B3.C12D21D4.IP)
[05:29:30] <mib_s37o4d> hello everyone!
[05:31:50] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[05:33:16] *** Quits: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP) (Quit: Gone to save the world!)
[05:33:36] *** Quits: mib_s37o4d (Mibbit@ECD463D1.B1C7B5B3.C12D21D4.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:35:23] <mark_edward> does rust have checked arith by default?
[05:35:41] <cmr> mark_edward: no
[05:35:46] <mark_edward> ok cool
[05:36:35] *** Quits: alan (alan@32702EE8.939109B2.FB082A98.IP) (Quit: alan)
[05:42:35] *** Joins: Nairidm (Mibbit@moz-F958911.hsd1.ca.comcast.net)
[05:43:39] *** Joins: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP)
[05:44:22] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[05:56:46] *** Quits: o11c (ben@moz-742FF125.sd.sd.cox.net) (Ping timeout)
[05:58:11] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[05:58:13] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:58:40] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Quit: Computer has gone to sleep.)
[05:59:56] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[06:00:22] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[06:03:17] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:04:37] *** Joins: o11c (ben@moz-742FF125.sd.sd.cox.net)
[06:06:25] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[06:08:24] *** Quits: meTaAU (admin@moz-B95CBDD6.lns20.per1.internode.on.net) (Ping timeout)
[06:08:56] *** Joins: meTaAU (admin@moz-B03C7707.lns20.per1.internode.on.net)
[06:13:33] <tjc> The perfect holiday gift for anyone interested in Rust: http://www.staples.com/Avalanche-Rust-2014-Wall-Calendar-12-inch-x-12-inch/product_259026
[06:13:34] <tjc> ;-)
[06:13:41] <cmr> hah
[06:16:49] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[06:16:54] <sam113101> Please enter the Zip Code where products will be delivered.
[06:17:01] <sam113101> they won't let me see it >(
[06:17:12] <tjc> sam113101: That's strange, I didn't have to put in a zip code
[06:17:26] <sam113101> I entered a fake one
[06:17:29] <sam113101> it worked
[06:17:31] <tjc> but fortunately, if you google for rust 2014 calendar, it'll come up on sites that are more willing to take your money :-)
[06:18:04] <tjc> your irc nick even contains at least one zip code :-)
[06:18:06] <strcat> tjc: if you're canadian, no one wants your money
[06:18:11] <tjc> strcat: haha, truth
[06:18:15] <sam113101> ;(
[06:18:24] <tjc> when I moved to Vancouver, I had to call my bank to tell them my new address...
[06:18:30] <tjc> I read them the postcode
[06:19:01] <tjc> and the person said, "V5L 3C1? I've never heard a zip code like that before"
[06:19:08] <sam113101> rofl
[06:21:05] * strcat finds it funny that amazon.com has way better selection than amazon.ca but amazon.ca often ships from the US
[06:22:08] <tjc> the ways of Amazon are mysterious
[06:22:18] <sam113101> amazon is not Canada-friendy, costs too much to ship anything
[06:23:11] <sam113101> this monitor stand I'm using cost me $120 I think, or even more than that, the listing price was $38…
[06:23:43] <tjc> powells.com charged a reasonable price to ship to Canada, but that was just for one book
[06:23:54] <sam113101> wait no, it was ~$105
[06:23:59] <sam113101> still too much
[06:24:46] <sam113101> ncix is good for computer stuff
[06:27:51] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[06:28:19] *** Joins: amidvidy (Mibbit@moz-65F81938.hsd1.ca.comcast.net)
[06:29:32] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[06:31:49] <Yurume> I can't really get how to use rustpkg, any idea?
[06:32:05] <Yurume> i.e. how to convert the existing repo to rustpkg format
[06:33:01] <Yurume> what makes me particularly confusing is a distinction between the package and workspace, which I couldn't easily grasp from the current tutorial
[06:33:19] *** Quits: amidvidy (Mibbit@moz-65F81938.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:35:18] *** Joins: alonlevy (alon@moz-74377C14.bb.netvision.net.il)
[06:35:27] <cmr> Yurume: the manual is more informative than the tutorial, https://github.com/mozilla/rust/blob/master/doc/rustpkg.md
[06:36:57] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Ping timeout)
[06:37:20] <Yurume> I have also read it (twice), and still the distinction between package and workspace remains confusing.
[06:37:39] *** Joins: amidvidy` (user@moz-65F81938.hsd1.ca.comcast.net)
[06:37:56] <Yurume> okay, to be sure, I can understand that workspace is something like ~/.rust (i.e. where the compiled crates go) and package is something contains lib.rs or main.rs etc (i.e. where the source code exists),
[06:38:09] *** Quits: z0w0 (zack@moz-EC26A2C.qwl9.woo.bigpond.net.au) (Connection reset by peer)
[06:38:10] <amidvidy`> hello everyone. is there a straightforward way of using TSX-NI instructions in Rust?
[06:38:20] <cmr> amidvidy`: inline asm.
[06:38:24] *** Joins: z0w0 (zack@moz-EC26A2C.qwl9.woo.bigpond.net.au)
[06:38:35] <Yurume> but then workspace can contain pkg.rs (???)
[06:38:54] <cmr> Yurume: workspaces cannot contain a pkg.rs, afaik
[06:38:59] <cmr> that's a per-package thing
[06:39:01] <tjc> Yurume: A workspace can contain many packages
[06:39:04] <tjc> Or just one
[06:39:14] <Yurume> quoted from the manual: A file called pkg.rs at the root level in a workspace is called a package script. If a package script exists, rustpkg executes it to build the package rather than inferring crates as described previously.
[06:39:36] <tjc> Yurume: that's an error, I'll fix it, but...
[06:39:44] <Yurume> awww ;)
[06:39:48] <tjc> in general, you don't need a package script; it's only when you want to do custom build steps (like building a C library)
[06:39:52] *** Quits: alonlevy (alon@moz-74377C14.bb.netvision.net.il) (Ping timeout)
[06:40:52] <Yurume> tjc, if one repo, e.g. "github.com/lifthrasiir/rust-foo", resolves to a workspace which contains one package, then does it eventually resolve to that package?
[06:41:12] <amidvidy`> nice. I am currently working with intel's TSX intrinsics in C++ and I would much wrather be writing Rust.
[06:41:16] <tjc> Yurume: repos contain packages; they shouldn't contain workspaces
[06:41:26] <tjc> a workspace is meant to be a local directory on your computer (that you do work in :-)
[06:41:50] <Yurume> uh, well, I have seen several "packages" which does not contain main.rs/lib.rs in its root (but rather in src/<package-name>/), is it fine?
[06:41:56] <cmr> amidvidy`: we don't have intrinsics for it (and we probably won't, unless LLVM exposes them and they become necessary)
[06:42:46] <tjc> Yurume: That should still work, but it's not the preferred way to organize a package (early on in rustpkg's history, I made an example package that had that error, and unfortunately it caught on)
[06:43:31] <Yurume> ah, so it's what rustpkg does not expect but does accept for now?
[06:43:32] <Yurume> is it*
[06:43:52] <tjc> Yurume: Yes, with the caveat that there's an open bug involving external dependencies that have that structure not being handled properly
[06:45:22] <dbaupp> amidvidy`: https://github.com/mozilla/rust/wiki/Doc-detailed-release-notes#inline-assembly
[06:45:47] <amidvidy`> thanks. nice to see that the documentation is recent as well.
[06:46:12] <dbaupp> it's not that recent, but the asm!() stuff is still up to date.
[06:46:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[06:46:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:46:29] <dbaupp> although you do need to have `#[feature(asm)];` on the crate.
[06:47:34] <Yurume> tjc, is it recommended *not* to have a separate src/ directory in the rustpkg-compatible repo, then?
[06:48:05] <tjc> Yurume: I think it's confusing to have one. src/ is meant to signify "the directory in my local workspace that contains all the sources for packages that I want to depend on each other"
[06:48:18] <Yurume> okay
[06:48:48] <Yurume> well, I wanted to convert rust-encoding to be compatible with rustpkg, and I stuck with the tutorial (and manual)
[06:49:45] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Ping timeout)
[06:50:08] <Yurume> I really hope that I don't have to keep configure/Makefile to the repo once I converted it to be compatible with rustpkg, but I wasn't sure, so I looked for other rustpkg-compatible repos
[06:50:15] <Yurume> and confused...
[06:50:37] <Yurume> anyway, good to know that, I'll try again
[06:51:10] *** jorendorff is now known as jorendorff_away
[06:51:10] <amidvidy`> ls
[06:51:31] *** jorendorff_away is now known as jorendorff
[06:51:34] <amidvidy`> err.. whoops.
[06:52:39] <sam113101> rm -rf .
[06:54:13] <tjc> Yurume: You shouldn't have to continue to have a configure script and Makefile, so if you find that you do, I'd be interested to know about it :-)
[06:54:41] <Yurume> tjc, I have at least two packages that require custom build instructions. :)
[06:54:46] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[06:55:07] <Yurume> one more question: is it possible that a package id can look like this: github.com/lifthrasiir/rust-foo#some-branch/extras/foo-helper?
[06:55:26] <Yurume> (i.e. is it an URL-like path and not a proper URL?)
[06:55:44] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[06:56:26] *** Joins: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz)
[06:57:18] *** Joins: lbergstrom (lbergstrom@moz-DB4A9C19.scl3.mozilla.com)
[06:57:19] <tjc> Yurume: It's a URL-like path, yes...
[06:57:29] <tjc> but the part after # should be a tag or a revision, rather than a branch
[06:57:36] <tjc> since branches can change and it's not a good idea to rely on them :-)
[06:57:44] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[06:58:41] <Yurume> tjc, IIRC one package can contain subpackages if the parent package is valid, does it only apply to local package ids then?
[06:59:40] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:59:54] <Yurume> the main problem here is to have a separate branch, right, but as always I follow a particular commit which is not master :S
[07:00:00] <tjc> Yurume: I'm not sure I follow...
[07:00:09] <Yurume> well,
[07:00:21] <Yurume> if github.com/lifthrasiir/rust-foo#some-branch is a valid package id,
[07:00:44] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[07:00:59] <Yurume> then can github.com/lifthrasiir/rust-foo#some-branch/extras/foo-helper be a valid package id when the repo contains both lib.rs and extras/foo-helper/lib.rs?
[07:01:13] <tjc> it would have to be github.com/lifthrasiir/rust-foo/extras/foo-helper#some-tag
[07:01:17] <Yurume> !
[07:01:28] <dbaupp> tjc: is /extras/foo-helper a subdir?
[07:01:40] <Yurume> subdir, yes.
[07:01:47] <Yurume> subdir in the repo*
[07:01:51] <tjc> dbaupp: I was assuming that what Yurume meant was that in the rust-foo repo, there was a subdir called extras/foo-helper
[07:02:00] <Yurume> you are correct
[07:02:09] <dbaupp> does that mean that `my-website.com/somerepo` isn't a valid package id?
[07:02:46] <tjc> dbaupp: if somerepo contains a .git directory, then it's valid
[07:02:46] <dbaupp> or `somewebsite.com/somedirectory/someuser/somerepo`?
[07:04:21] <mark_edward> hey im porting something from C#, and it has a struct with like 20 members... is there any way i can create the struct without initializing? 
[07:04:43] <mark_edward> i don't want to have to find good defaults, only to override them immediately in some init functons?
[07:04:55] <Yurume> what's your use case?
[07:04:57] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[07:05:13] <cmr> mark_edward: std::unstable::intrinsics::uninit
[07:05:14] <Yurume> i.e. why do you need to initialize the struct partially?
[07:05:53] <mark_edward> it's got like 20 members, some of which need to be initialized with complex funtions, and depend on other members ahving already been initialized
[07:06:25] <Yurume> uh, you can initialize each fields (in the proper topological order) outside and put into the struct later.
[07:06:48] <Yurume> e.g. fn new() -> SomeStruct { let a = ...; let b = f(a); let c = g(b); SomeStruct { c: c, b: b, a: a } }
[07:07:53] *** Quits: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Ping timeout)
[07:07:59] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Client exited)
[07:08:20] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[07:08:52] <mark_edward> Yurume: yeah that makes sense...
[07:08:59] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[07:10:03] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[07:10:15] <Yurume> mark_edward, something like this: https://github.com/snrs/sonorous/blob/master/src/engine/player.rs#L260-L300
[07:10:35] <Yurume> you can even do further pre-/post-processing if you want.
[07:10:56] <Yurume> (normally not recommended, but you can do if you really want)
[07:11:02] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[07:12:28] <mark_edward> Yurume: the problem is that the C# code im translating uses lots of function calls to initialize it that use the member variables that are initialized by default in C# and other ones that have been initialized by other functions
[07:12:43] <mark_edward> the constructor itself has a difficult control flow to follow
[07:13:04] <mark_edward> and all of the functions are instane methods
[07:13:07] <mark_edward> *instance
[07:13:13] <Yurume> yeah, Rust does not have an implicit initialization so you have to adjust your code accordingly.
[07:13:30] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[07:22:25] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[07:22:36] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:23:55] *** Joins: shadower (tsedovic@moz-107AD163.redhat.com)
[07:24:32] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[07:25:03] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[07:28:36] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[07:30:21] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[07:31:59] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Quit: Leaving.)
[07:32:16] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[07:33:47] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[07:36:25] *** Quits: mark_edward_ (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[07:36:56] *** Joins: nlminhtl (ignotus@moz-BA3DE7EF.volia.net)
[07:41:36] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Input/output error)
[07:42:14] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[07:44:13] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[07:45:37] *** Joins: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP)
[07:46:47] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[07:46:58] *** pmoore|away is now known as pmoore
[07:49:14] *** Joins: alonlevy (alon@30A56D71.66334A3F.AB64B967.IP)
[07:49:14] *** Quits: alonlevy (alon@30A56D71.66334A3F.AB64B967.IP) (Client exited)
[07:49:56] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Ping timeout)
[07:50:03] <nlminhtl> What's it? https://gist.github.com/Ignotus/f47be20d49f1704a02cf
[07:51:07] <cmr> nlminhtl: exactly what it looks like?
[07:51:43] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:51:55] <nlminhtl> cmr: like use std::num::*; :)
[07:51:56] *** Joins: amro (quassel@CC16DC52.8AAAF769.FAAB0799.IP)
[07:51:57] *** flaper87|afk is now known as flaper87
[07:52:06] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[07:52:14] <nlminhtl> cmr: it's in the master rust
[07:52:30] <cmr> nlminhtl: the error message tells you how to enable them: #[feature(globs)]
[07:52:41] *** Joins: trailer (Mibbit@moz-2B18508A.kla-tencor.com)
[07:53:36] <nlminhtl> cmr: yes, I see, but why is it turned off by default?
[07:53:38] *** jorendorff is now known as jorendorff_away
[07:53:59] <cmr> nlminhtl: because they are buggy and we don't want to support backwards compat for them for 1.0
[07:55:13] <nlminhtl> cmr: so I should include module members one by one, shouldn't I?
[07:55:27] <cmr> nlminhtl: you can use globs, they mostly work, you just need the attribute.
[07:55:27] <trailer> Hi, I have a &[u8] of len N and I want to interpret it as &[[u32,..8]] and i know that N is a multiple of 32. If i do a transmute, i get a segmentation fault. how do i go about doing this?
[07:56:14] <cmr> trailer: transmuting the &[u8] to a &[[u32, ..8]] should work. Do you have a minimal testcase?
[07:57:13] <trailer> not at the moment...also i obtain the &[u8] through ~[u8].as_slice() is that valid?
[07:57:14] <Luqman> cmr: huh, wouldn't the length be off?
[07:57:28] <dbaupp> nlminhtl: (note that #[feature(globs)]; needs the ; to have it attached to the crate)
[07:57:55] <dbaupp> cmr, trailer: yes the length will be off; slice lengths are stored as number-of-elements, not number-of-bytes
[07:58:36] <cmr> Ohhh right, the length would be off
[07:58:50] <dbaupp> one way is to go &[u8] -> *u8 -> &[u32]
[07:58:56] <cmr> I forgot about that change
[07:59:04] <dbaupp> where the last step is with vec::raw::buf_as_slice
[07:59:16] <dbaupp> http://static.rust-lang.org/doc/master/std/vec/raw/fn.buf_as_slice.html
[08:00:11] <trailer> dbaupp: will it work for &[[u32,..M]]?
[08:00:21] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[08:00:42] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[08:01:07] <dbaupp> trailer: sure
[08:01:19] <dbaupp> (oh, I wrote the wrong thing.)
[08:01:48] <nlminhtl> does 32-bit version of rust have f64 type?
[08:02:04] <nlminhtl> how does it deal with them?
[08:02:05] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[08:02:07] <cmr> nlminhtl: yes. every platform supports every built-in datatype.
[08:02:23] <trailer> dbaupp: thanks
[08:02:25] <nlminhtl> cmr: ok
[08:03:02] <dbaupp> rusti: let x = &[0u8, 1, 2, 3, 4, 5, 6, 7, 8]; let ptr = (&x[0]) as *u8 as *[u16, .. 2]; unsafe { std::vec::raw::buf_as_slice(ptr, x.len() / std::mem::size_of::<[u16, .. 2]>(), |buf| println!("{:?}", buf)) }
[08:03:02] -rusti- pastebinned 11 lines of output: http://sprunge.us/eSDT
[08:03:13] <dbaupp> rusti: let x = &[0u8, 1, 2, 3, 4, 5, 6, 7, 8]; let ptr = (&x[0]) as *u8 as *[u16, .. 2]; unsafe { std::vec::raw::buf_as_slice(ptr, x.len() / std::sys::size_of::<[u16, .. 2]>(), |buf| println!("{:?}", buf)) }
[08:03:13] -rusti- &[[513u16, 1027u16], [1541u16, 2055u16]]
[08:03:13] -rusti- ()
[08:04:10] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[08:04:10] *** ChanServ sets mode: +o pnkfelix
[08:05:00] *** Joins: GeorgeH_ (George@moz-FB5F2302.hsd1.nj.comcast.net)
[08:06:31] *** Quits: GeorgeH (George@moz-FB5F2302.hsd1.nj.comcast.net) (Ping timeout)
[08:06:33] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[08:07:41] *** Quits: amro (quassel@CC16DC52.8AAAF769.FAAB0799.IP) (Ping timeout)
[08:07:52] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:08:19] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[08:11:07] *** Quits: Nairidm (Mibbit@moz-F958911.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[08:17:54] <nlminhtl> how can I cast Option<f64> to f64? .__.
[08:18:11] *** Quits: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[08:18:12] <Yurume> if you are sure that it is not None, unwrap() method.
[08:18:33] *** Quits: tikue_ (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Connection reset by peer)
[08:18:53] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[08:19:34] <nlminhtl> There are too much actions to convert a generic type to the appropriate :( 
[08:19:37] <cmr> nlminhtl: you can't cast it per se, you need to pattern-match out the f64.
[08:19:47] <cmr> (which the unwrap method does for you, failing on None)
[08:25:18] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[08:25:18] *** ChanServ sets mode: +ao pcwalton pcwalton
[08:28:47] *** Joins: dherman (dherman@5AB4884B.FCC4549.14D5B978.IP)
[08:28:48] *** ChanServ sets mode: +ao dherman dherman
[08:28:58] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[08:29:23] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[08:29:54] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[08:31:00] <TeXitoi> https://github.com/mozilla/rust/pull/10478 : Add shootout meteor contest benchmark.
[08:31:04] <mimcpher> I miss option and pattern matching in c++ :(
[08:31:06] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[08:31:45] <TeXitoi> mimcpher: fot option, you have boost::optional
[08:31:54] <FreeFull> Pattern matching is really nice to have
[08:32:41] <mimcpher> TeXitoi: yeah but it's not as nice without pattern matching
[08:33:00] <mimcpher> also it's in c++11 or 14
[08:33:03] <mimcpher> no need for boost
[08:33:40] <TeXitoi> mimcpher: not in 11, but maybe in 14, and I agree with the beauty of patern matching
[08:34:36] <mimcpher>  After reviewing national body comments to n3690, this library component was voted out from C++14 working paper into a separate Technical Specification. It is not a part of the draft C++14 as of n3797. 
[08:34:39] <mimcpher> never mind :)
[08:35:25] *** Joins: Ferreus (ferreus@moz-8F7D0367.dip0.t-ipconnect.de)
[08:35:50] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[08:36:19] <nlminhtl> cmr: is it the only way to cast a generic type to the appropriate and vice versa? https://github.com/Ignotus/rustcg/blob/master/src/vertex2d.rs#L28 https://github.com/Ignotus/rustcg/blob/master/src/vertex2d.rs#L74
[08:36:35] *** Quits: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu) (Ping timeout)
[08:36:37] <nlminhtl> cmr: it looks not so pretty :)
[08:36:44] *** Quits: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[08:36:48] *** Quits: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[08:36:53] *** Quits: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[08:37:06] <cmr> nlminhtl: for casting to f64, yes.
[08:37:20] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[08:37:24] <cmr> nlminhtl: it performs well and handles error, what more do you want? :P
[08:37:56] <nlminhtl> cmr: performance like C++? :)
[08:38:05] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[08:38:45] <tjc> nlminhtl: How do you know that to_f64() will return Some(x) (for some value of x) in this case?
[08:38:46] <dbaupp> nlminhtl: with optimisations on, and if the C++ does something equivalent (i.e. checks for errors and throws an exception if it's invalid) most likely
[08:40:36] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[08:41:01] *** Quits: jordyd (jordyd@moz-383C39FB.seg58.ucf.edu) (Quit: Leaving)
[08:43:19] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[08:43:37] <nlminhtl> tjc: hm, I don't. But I know that I will use only int/float types for the generic type. so they can be casted to f64. So I can decide to prefer performance than safety.
[08:44:08] <tjc> nlminhtl: You don't have to choose in this case; if you know that you will only use int/float types, you can use your types to express that
[08:44:35] <tjc> by using a more descriptive trait bound than ToPrimitive, I mean
[08:44:54] <tjc> I don't know offhand whether one already exists or whether you'll need to write it, but basically the idea is to use a trait that only ints and floats implement
[08:45:18] *** Quits: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[08:45:25] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[08:45:38] *** Quits: dherman (dherman@5AB4884B.FCC4549.14D5B978.IP) (Quit: dherman)
[08:45:54] *** Joins: Palmik (palmik@moz-DEC2AB.pks.muni.cz)
[08:45:58] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[08:45:59] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[08:46:49] <tjc> hopefully that's enough detail to get you started, since I'm about to fall over asleep ;-)
[08:46:50] <tjc> goodnight!
[08:46:53] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[08:47:26] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[08:47:30] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[08:47:33] <Kingsley> cmon rust
[08:47:35] *** Joins: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu)
[08:47:37] <Kingsley> hurry up and be production ready
[08:47:41] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[08:47:54] <cmr> Kingsley: it'll go faster if you help! :)
[08:47:59] *** Joins: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu)
[08:47:59] *** ChanServ sets mode: +o acrichto
[08:48:06] <Kingsley> cmr: I don't know how to compiler D:
[08:48:11] <Yurume> nlminhtl, hmm, what do you want for the result of Vertex2d(Point2d(3, 4), Point2d(4, 3)).intersect(&Vertex2d(Point2d(3, 3), Point2d(4, 4)))?
[08:48:13] <Kingsley> I am just lowly gamedev
[08:48:24] <Yurume> Point2d(3, 3)? Point2d(4, 4)? fail!("inexact computation")?
[08:48:50] <Kingsley> here to use your marvellous creation and waggle my arms at you in a motivational manner
[08:49:19] <Yurume> Kingsley, you can contribute to Rust just by using it and giving feedbacks ;)
[08:49:44] <Kingsley> hmmm 8|
[08:50:02] <Kingsley> interesting concept thati
[08:50:15] <Kingsley> *that!
[08:50:19] <nlminhtl> Yurume: in that case will be Point2d(3, 3) or Point2d(4, 4), yes
[08:50:19] <Kingsley> upside down exclamation marks
[08:50:24] <Kingsley> you know you're tired when
[08:50:50] <nlminhtl> Yurume: it will be not correctly for small vertexes, but for big - will be :)
[08:52:40] <nlminhtl> Yurume: but, anyway, my code is not pretend to be usable, I have not covered by any tests and only played with Rust :)
[08:52:51] * Kingsley merrily begins compiling 
[08:53:23] *** Quits: nlminhtl (ignotus@moz-BA3DE7EF.volia.net) (Quit: Konversation terminated!)
[08:53:55] <cmr> Kingsley: feedback, libraries in the ecosystem, work on the stdlib, documentation, and good press are all as valuable as compiler work :)
[08:54:12] <Kingsley> good to know :D
[08:54:33] <Kingsley> are there any socially coagulating game engine / framework projects?
[08:54:35] <Yurume> nlminhtl[wrk], a good news: as far as I have tested, std::num::cast does the necessary floor/saturation. you can just use std::num::cast(v).unwrap() instead.
[08:54:41] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[08:54:47] <Kingsley> I've googled around a bit but it's mostly small one-man experiments 
[08:54:48] <cmr> Kingsley: see the topic in #rust-gamede
[08:54:56] <Yurume> I don't know it is intentional however
[08:54:58] <Kingsley> roger
[08:55:01] <cmr> #rust-gamedev, sorry
[08:55:26] <cmr> but yeah, mostly small projects
[08:57:03] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[08:58:55] *** Quits: ercxx (ercan@moz-8383857F.dyn.optonline.net) (Quit: WeeChat 0.4.2)
[09:01:46] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[09:05:11] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[09:05:42] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[09:06:21] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[09:10:42] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Connection reset by peer)
[09:10:51] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[09:17:59] *** Quits: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP) (Ping timeout)
[09:19:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:20:10] *** Joins: sankha93 (Instantbir@71F19D4F.49C43973.1C37C358.IP)
[09:20:23] *** Joins: jensnockert (jensnocker@moz-5D53B643.cust.bredband2.com)
[09:21:29] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:23:28] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[09:24:32] *** Quits: Kxepal (Miranda@moz-876F9B77.pppoe.mtu-net.ru) (Ping timeout)
[09:24:49] *** Joins: nkoep (nik@moz-A08F77D3.pool.mediaways.net)
[09:25:02] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[09:28:11] *** Joins: Kxepal (Miranda@moz-3A55D1EB.pppoe.mtu-net.ru)
[09:30:05] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[09:31:50] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[09:32:51] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[09:33:07] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[09:34:23] *** Joins: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP)
[09:42:43] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[09:43:06] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[09:45:08] *** Quits: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP) (Ping timeout)
[09:46:23] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:46:41] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[09:52:18] *** Quits: jensnockert (jensnocker@moz-5D53B643.cust.bredband2.com) (Input/output error)
[09:53:16] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Connection reset by peer)
[09:53:34] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[09:53:39] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[09:57:41] *** Quits: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz) (Ping timeout)
[09:58:22] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[10:06:56] *** Joins: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP)
[10:09:35] *** Quits: trailer (Mibbit@moz-2B18508A.kla-tencor.com) (Ping timeout)
[10:10:11] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Ping timeout)
[10:11:17] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[10:17:26] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[10:20:35] *** Joins: fabiand (fabiand@moz-7AF03B69.adsl.alicedsl.de)
[10:20:41] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Client exited)
[10:24:00] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[10:26:11] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[10:30:15] *** kimundi is now known as zz_kimundi
[10:30:55] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[10:31:50] *** Quits: sankha93 (Instantbir@71F19D4F.49C43973.1C37C358.IP) (Quit: Gone to save the world!)
[10:32:36] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[10:33:27] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:34:43] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Quit: ZNC - http://znc.in)
[10:34:43] *** Quits: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com) (Quit: ZNC - http://znc.in)
[10:34:43] *** Quits: pmoore (pmoore@moz-DB4A9C19.scl3.mozilla.com) (Quit: ZNC - http://znc.in)
[10:35:30] <KokaKiwi> Hi there, I'm wondering how to concat two idents in macro rules? (I want to define function named "prefix_" + $name)
[10:35:35] *** Joins: mark_edward_ (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[10:36:56] <dbaupp> KokaKiwi: concat_idents!(prefix_, $name) sometimes works
[10:37:08] <dbaupp> but almost certainly won't if you're trying to create a function name
[10:37:59] <KokaKiwi> fn concat_idents!(prefix_, $name)() { ... } don't works :(
[10:38:07] <dbaupp> yup :(
[10:39:04] <KokaKiwi> Meh :/
[10:40:00] <dbaupp> (papercuts like these are part of the reason macro_rules is behind a #[feature].)
[10:41:31] *** Joins: pmoore|away (pmoore@moz-DB4A9C19.scl3.mozilla.com)
[10:41:33] <KokaKiwi> Yep, but...now I can't do funny things I wanted to do :(
[10:42:14] <dbaupp> you can pass in the other names
[10:42:15] *** Quits: cdidd (cdidd@moz-D6C165C4.broadband.corbina.ru) (Ping timeout)
[10:42:28] <dbaupp> i.e. have $name and $prefix_name
[10:42:35] *** pmoore|away is now known as pmoore
[10:42:46] <dbaupp> (it's ugly, but it's marginally better than not being able to do it.)
[10:42:51] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:43:05] <KokaKiwi> Yep, I thinks I'll do that
[10:43:10] <KokaKiwi> think*
[10:46:17] *** Quits: engla_ (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[10:46:59] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[10:48:18] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:48:43] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[10:48:43] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[10:50:02] *** Quits: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[10:52:20] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[10:54:32] *** Joins: kermi (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[10:55:00] *** Parts: kermi (Mibbit@284C36E7.3062CEC3.670EEFD.IP) ()
[10:55:21] <nlminhtl[wrk]> Yurume, thanks :)
[10:55:33] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[11:00:20] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Quit: Bye)
[11:01:43] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Ping timeout)
[11:05:23] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[11:08:17] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[11:09:10] *** Joins: Tommi (Mibbit@moz-933A7AA1.elisa-laajakaista.fi)
[11:10:48] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[11:11:36] *** Quits: Tommi (Mibbit@moz-933A7AA1.elisa-laajakaista.fi) (Quit: http://www.mibbit.com ajax IRC Client)
[11:14:16] *** Quits: StarLight (StarLight@moz-622CB397.pppoe.avangarddsl.ru) (Ping timeout)
[11:15:27] *** Quits: jesse98 (jjones@6251EDC2.15651213.B46B86FA.IP) (Ping timeout)
[11:17:27] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[11:17:35] *** Joins: jesse98 (jjones@6251EDC2.15651213.B46B86FA.IP)
[11:17:35] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[11:17:42] *** zz_kimundi is now known as kimundi
[11:17:53] *** Joins: jyyou_ (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[11:18:28] *** Quits: jyyou (jyyou@moz-1A35BF79.cs.nctu.edu.tw) (Quit: leaving)
[11:18:32] *** Joins: StarLight (StarLight@moz-D8C9A250.dynamic.avangarddsl.ru)
[11:18:46] *** jyyou_ is now known as jyyou
[11:19:19] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:21:33] *** Joins: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[11:21:50] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[11:22:14] <Leo`> 23:5 error: constant contains unimplemented expression type
[11:22:17] <Leo`> mhhhhhhhh :|
[11:25:08] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:28:36] *** Quits: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP) (Quit: bbl)
[11:28:43] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[11:31:41] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[11:33:23] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[11:36:57] <Yurume> nlminhtl[wrk], hmm, please also track this: https://github.com/mozilla/rust/issues/10481 it seems an unintentional (and potentially problematic) behavior.
[11:42:13] *** Joins: tess (chatzilla@20A3414E.ADFC3D95.73686190.IP)
[11:42:51] <tess> Hi.I would like to contribute?how to get started
[11:45:32] <ChrisMorgan> tess: have you familiarised yourself with Rust by using the language yet?
[11:45:52] <tess> Have not chris
[11:46:00] *** Joins: eddyb9 (eddy@A4A0028E.2484615.4A6B528C.IP)
[11:46:19] <ChrisMorgan> I would recommend as a first step using Rust on a non-trivial project of your own; you'll fare much better working on Rust itself if you're already familiar with the language.
[11:46:42] <tess> :).I had tried before.long before.Then I couldnt complete it.ok
[11:46:58] <eddyb9> is it possible that we could ever have "primitive" type bounds for generics?
[11:48:08] <eddyb9> I'm thinking of "as" casts (but those can be implemented by traits, not a big problem)
[11:48:21] <eddyb9> and structural field access
[11:50:58] <eddyb9> in the mixin discussion on the mailing list, most of the problems were with taking an "&B" from "struct D : A, B, C" (multiple inheritance)
[11:51:12] <ChrisMorgan> eddyb9: structural field access through generics is something that has been being discussed in recent weeks
[11:52:09] <eddyb9> but most of the time, all you need is static field access via static instantiations of generic trait implementations
[11:53:06] <eddyb9> mixins that just allowed to write methods once for multiple structs with a common set of fields, that would be awesome
[11:53:44] <eddyb9> and it's mostly a syntax extension, no trans changes required
[11:54:25] <eddyb9> ChrisMorgan: well, we're on the right track, then :D
[11:55:58] <eddyb9> hmm, or a way to automatically implement trait Foobar for a struct T, by proxying to a field of T, which itself implements Foobar
[11:56:28] <eddyb9> DRY and no virtual shenanigans
[11:57:03] <ChrisMorgan> I think the main way that's been suggested for structural field access is making it so that a struct can be in a trait's constraints, tying it in with inheritance.
[11:57:46] *** Joins: sk (sk@9E6B574B.EB2AA036.2CAF0D3B.IP)
[11:59:46] <dbaupp> Edwards: re proxying https://github.com/mozilla/rust/issues/7773
[12:00:24] <eddyb9> ChrisMorgan: sure, but don't let virtual field access be a problem, it's not required
[12:02:20] <eddyb9> dbaupp: mis-tab, I presume. thanks, I'll take a look
[12:02:44] <dbaupp> eddyb: oh, yes (sorry Edwards )
[12:03:36] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[12:04:22] <eddyb9> if you were to encode individual fields as required, and you would then add anonymous struct types (statically typed records), that could make for interesting patterns
[12:04:29] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Quit: Leaving)
[12:04:49] *** Quits: tess (chatzilla@20A3414E.ADFC3D95.73686190.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0/20130910160258])
[12:06:12] <eddyb9> you could pass arguments by name without any specific special support
[12:06:50] <dbaupp> you mean a type like `fn foo() -> {a: int, b: f64}`?
[12:07:29] <eddyb9> GetFoo for T without a foo field would return None, while GetFoo for T with a foo field would return Some(self.foo)
[12:07:55] <eddyb9> dbaupp: I mean an unique anonymous type, usable only with generics
[12:09:17] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Quit: Linkinus - http://linkinus.com)
[12:09:41] *** Joins: Amaranth (travis@moz-B00289DC.sxct.qwest.net)
[12:10:40] *** Joins: eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP)
[12:10:55] *** Quits: eddyb9 (eddy@A4A0028E.2484615.4A6B528C.IP) (Ping timeout)
[12:10:57] <eddyb_> oooh, if fields could be part of the type system (Field<"foo"> would be the least intrusive way, I guess), you could pass them to generic traits, so you wouldn't need a custom trait for each field you need
[12:11:10] <eddyb_> I might be onto something here :P
[12:12:43] <eddyb_> I would put this behind a high language level, but it has no runtime cost
[12:13:25] <eddyb_> metaprogramming in Rust could be like writing ES6 code :P
[12:16:12] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[12:17:48] <dbaupp> so basically, duck-typing on fields via generics?
[12:20:04] <eddyb> that's one metaphor I don't know :/
[12:21:25] <dbaupp> http://en.wikipedia.org/wiki/Duck_typing "duck typing is a style of typing in which an object's methods and properties determine the valid semantics, rather than its inheritance from a particular class or implementation of a specific interface"
[12:21:50] <eddyb> hmm, generic (over a constant string) intrinsics for getting a reference to a field in a struct might be enough to make that last usecase work
[12:22:27] <eddyb> dbaupp: strict duck typing :D
[12:22:44] <eddyb> I know you want it :P
[12:23:31] <eddyb> or did I mean static? I'm not sure
[12:23:55] <ChrisMorgan> eddyb: you know C++ templates?
[12:24:39] <dbaupp> magical Field traits
[12:24:42] *** Joins: ofeldt (ofeldt@moz-14009101.dip0.t-ipconnect.de)
[12:25:13] * dbaupp isn't sure that has much benefit over a trait + generics, other than reducing boilerplate
[12:25:25] *** Quits: ofeldt- (ofeldt@moz-355FDAC1.dip0.t-ipconnect.de) (Ping timeout)
[12:25:55] <dbaupp> (at least, I don't think it would solve servo's requirement... or would it?)
[12:26:08] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Quit: Leaving.)
[12:26:24] <eddyb> ChrisMorgan: yes, but Rust's type bounds don't allow you to define a generic which could fail during instantiation
[12:27:19] <dbaupp> hm, thinking a little more... it wouldn't, it would still require trait objects and so virtual "calls" for polymorphism.
[12:31:57] *** Quits: eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP) (Quit: Leaving)
[12:32:15] <eddyb> dbaupp: the last mechanism I mentioned, fn get_field<Name: static str, T, F>(&'self T) -> Option(&'self F) - without such an intrinsic, getting a field from a "record" with a maximum of n fields would require somethin like n! (I know it's smaller, but I can't remember the formula) different structures and trait impls
[12:32:26] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[12:32:52] <eddyb> (and would thus be unusable for n > 3)
[12:33:00] *** Quits: Sgeo (quassel@moz-D0F30617.dyn.optonline.net) (Connection reset by peer)
[12:34:07] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[12:34:14] <dbaupp> 2^n different structs
[12:34:39] *** pmoore is now known as pmoore|running-errands
[12:35:12] <eddyb> dbaupp: oh, I'm dumb
[12:35:28] <dbaupp> n traits, and n*2^n impls
[12:35:29] <eddyb> screw combinatorials, they're messing with my head
[12:36:01] <dbaupp> yeah, so none of this factorial business, it's only exponential! :P
[12:36:38] <eddyb> who'd want to work with 16 structures expressing the same thing?
[12:36:50] <eddyb> I mean, at this point, you make everything an Option
[12:41:21] *** Quits: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP) (No route to host)
[12:46:23] *** Quits: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) (Ping timeout)
[12:46:32] *** jorendorff_away is now known as jorendorff
[12:47:13] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[12:47:38] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[12:47:46] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[12:48:56] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[12:49:26] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[12:49:46] *** Joins: Jackneill (Jackneill@moz-A57EE2EE.pool.digikabel.hu)
[12:49:46] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[12:51:01] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[12:54:44] *** Quits: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP) (Quit: Leaving.)
[12:55:23] *** kimundi is now known as zz_kimundi
[12:57:42] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[12:58:43] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[12:58:56] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[12:59:10] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[13:00:32] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:00:41] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Quit: Konversation terminated!)
[13:02:26] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[13:05:30] *** Parts: kkris (kkris@moz-CB70009.yourvserver.net) (QUIT :Leaving.)
[13:10:40] * ChrisMorgan is going to go to bed (yes, genuinely departing immediately after posting this message) an hour or two early, before mletterle pipes up and triggers the obligatory extra hour of awakeness. Can you believe it?
[13:12:14] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:13:19] *** Joins: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP)
[13:13:19] *** ChanServ sets mode: +ao pcwalton pcwalton
[13:13:28] *** Quits: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP) (Quit: pcwalton)
[13:14:45] *** Joins: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP)
[13:16:41] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[13:16:41] *** ChanServ sets mode: +ao dherman dherman
[13:16:49] *** Joins: cdidd (cdidd@moz-42FC709F.broadband.corbina.ru)
[13:17:09] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:19:09] *** Joins: brson (brson@9C2E78E6.8C982E60.292610BC.IP)
[13:19:09] *** ChanServ sets mode: +ao brson brson
[13:20:03] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:20:24] <mark_edward> are chars useable as ints?
[13:21:38] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[13:22:04] <eddyb> rusti: 'a' as u32
[13:22:05] -rusti- 97u32
[13:22:10] <eddyb> rusti: 'a' as uint
[13:22:11] -rusti- 97u
[13:22:25] <eddyb> mark_edward: I guess you can cast to any integer
[13:22:29] <eddyb> rusti: 'a' as i8
[13:22:30] -rusti- 97i8
[13:22:53] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:23:09] <eddyb> rusti: ('\UAABB' as u8, '\UAABB' as u64)
[13:23:09] -rusti- <anon>:9:17: 9:18 error: illegal character in numeric character escape: \'
[13:23:09] -rusti- <anon>:9          ('\UAABB' as u8, '\UAABB' as u64)
[13:23:09] -rusti-                           ^
[13:23:09] -rusti- application terminated with error code 101
[13:23:22] <eddyb> rusti: ('\U+AABB' as u8, '\U+AABB' as u64)
[13:23:22] -rusti- <anon>:9:13: 9:14 error: illegal character in numeric character escape: +
[13:23:23] -rusti- <anon>:9          ('\U+AABB' as u8, '\U+AABB' as u64)
[13:23:23] -rusti-                       ^
[13:23:23] -rusti- application terminated with error code 101
[13:23:26] <eddyb> baah
[13:23:43] <dbaupp> rusti: ('\uAABB' as u8, '\U0003AABB' as u64)
[13:23:44] -rusti- (187u8, 240315u64)
[13:23:52] <eddyb> my bad :(
[13:24:10] <eddyb> rusti: (size_of::<char>(), size_of::<uint>())
[13:24:11] -rusti- pastebinned 8 lines of output: http://sprunge.us/GMDZ
[13:24:33] <dbaupp> (4, 8)
[13:24:36] <eddyb> rusti: (::std::sys::size_of::<char>(), ::std::sys::size_of::<uint>())
[13:24:37] -rusti- (4u, 8u)
[13:24:51] * dbaupp was close
[13:24:58] <eddyb> I just wanted to make sure, I knew that char was defined as u32
[13:25:36] <dbaupp> kinda
[13:25:43] *** Joins: RageOfThou (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:25:50] <dbaupp> it's more like u21 with some more restrictions
[13:30:23] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:30:49] <eddyb> rusti: fmt!("%x", '\UAABBCCDD' as u32)
[13:30:50] -rusti- <anon>:9:23: 9:31 error: illegal numeric character escape
[13:30:50] -rusti- <anon>:9          fmt!("%x", '\UAABBCCDD' as u32)
[13:30:50] -rusti-                                 ^~~~~~~~
[13:30:50] -rusti- application terminated with error code 101
[13:31:10] <dbaupp> can't be more than 0x10ffff
[13:31:10] <eddyb> rusti: fmt!("%x", '\UAABBCCDD' as uint)
[13:31:10] -rusti- <anon>:9:23: 9:31 error: illegal numeric character escape
[13:31:11] -rusti- <anon>:9          fmt!("%x", '\UAABBCCDD' as uint)
[13:31:11] -rusti-                                 ^~~~~~~~
[13:31:11] -rusti- application terminated with error code 101
[13:31:18] <eddyb> dbaupp: mkay
[13:31:46] <eddyb> rusti: 0xAABBCCDD as char
[13:31:47] -rusti- <anon>:9:9: 9:27 error: only `u8` can be cast as `char`, not `<VI0>`
[13:31:47] -rusti- <anon>:9          0xAABBCCDD as char
[13:31:47] -rusti-                   ^~~~~~~~~~~~~~~~~~
[13:31:47] -rusti- error: aborting due to previous error
[13:31:47] -rusti- application terminated with error code 101
[13:32:03] <eddyb> hmm, why is that?
[13:33:02] <dbaupp> because char is defined to hold valid code point
[13:33:09] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[13:33:51] <eddyb> dbaupp: which u16 values aren't valid code points?
[13:33:53] <dbaupp> which is 0-0xd7ff & 0xe000-0x10ffff
[13:33:57] <eddyb> ah dammit
[13:34:10] <dbaupp> 0xd800 through 0xdfff
[13:34:23] <zokier`> rusti: 0x2603 as char
[13:34:23] -rusti- <anon>:9:9: 9:23 error: only `u8` can be cast as `char`, not `<VI0>`
[13:34:23] -rusti- <anon>:9          0x2603 as char
[13:34:23] -rusti-                   ^~~~~~~~~~~~~~
[13:34:23] -rusti- error: aborting due to previous error
[13:34:24] -rusti- application terminated with error code 101
[13:34:45] <zokier`> rusti: '\U2603'
[13:34:45] -rusti- <anon>:9:16: 9:17 error: illegal character in numeric character escape: \'
[13:34:45] -rusti- <anon>:9          '\U2603'
[13:34:45] -rusti-                          ^
[13:34:45] -rusti- application terminated with error code 101
[13:34:52] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Ping timeout)
[13:35:38] <eddyb> dbaupp: if it weren't for the surogates, you could allow u16 and u32 (with &0xfffff), right?
[13:35:57] <eddyb> I'm guessing there's a checked cast somewhere in std
[13:36:17] <dbaupp> char::from_u32
[13:37:21] <mark_edward> are there still conditions in std::io? i never really liked them... they just seem like unfamiliar try/catch blocks
[13:37:41] *** Joins: pcx (pcx@C81B818B.E5A6DB9C.AE26B834.IP)
[13:38:25] *** Joins: Ms2ger (Ms2ger@moz-91FBDBDF.ugent.be)
[13:39:05] *** zz_kimundi is now known as kimundi
[13:40:20] <FreeFull> rusti: '\u2603'
[13:40:21] -rusti- '\u2603'
[13:40:36] <FreeFull> rusti: println("\u2603");
[13:40:36] -rusti- ☃
[13:40:37] -rusti- ()
[13:40:53] *** Joins: azita (Azita@9C2E78E6.8C982E60.292610BC.IP)
[13:42:33] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:47:25] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:49:01] <mark_edward> what's the fastest way to initialize a ~[] with all zeroes?
[13:49:24] *** Quits: sigma (sigma@moz-39E40618.range86-143.btcentralplus.com) (Client exited)
[13:49:57] <bstrie> mark_edward: we've measured this before, I think we tried to make sure that all methods are as fast as the fastest method
[13:50:23] <bstrie> but not sure if there's still one proper way to do it
[13:50:27] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:51:23] *** Joins: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP)
[13:51:23] *** ChanServ sets mode: +o jdm
[13:51:37] *** Joins: sigma (sigma@moz-39E40618.range86-143.btcentralplus.com)
[13:51:44] *** jorendorff is now known as jorendorff_away
[13:54:23] <eddyb> rusti: ~[0u, ..13]
[13:54:24] -rusti- ~[0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u]
[13:55:33] *** Quits: pcx (pcx@C81B818B.E5A6DB9C.AE26B834.IP) (Quit: Ex-Chat)
[13:56:06] <eddyb> rusti: let x: u8; ~[0u, ..(unsafe {*(&x as *u8)})]
[13:56:06] -rusti- <anon>:9:28: 9:52 error: expected constant integer for repeat count but found variable
[13:56:06] -rusti- <anon>:9          let x: u8; ~[0u, ..(unsafe {*(&x as *u8)})]
[13:56:06] -rusti-                                      ^~~~~~~~~~~~~~~~~~~~~~~~
[13:56:06] -rusti- error: aborting due to previous error
[13:56:07] -rusti- application terminated with error code 101
[14:02:28] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[14:05:31] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:06:17] <FreeFull> eddyb: How fast is that?
[14:07:38] <mark_edward> bstrie: okay, thansk
[14:08:26] *** Joins: mw1 (mw@moz-B436A392.adsl.highway.telekom.at)
[14:09:57] <eddyb> FreeFull: my intuition, and what bstrie is saying, makes me think it's just a memset
[14:10:46] <mark_edward> rusti: let n = 100; ~[0u8, ..n]
[14:10:47] -rusti- <anon>:9:31: 9:32 error: expected constant integer for repeat count but found variable
[14:10:47] -rusti- <anon>:9          let n = 100; ~[0u8, ..n]
[14:10:47] -rusti-                                         ^
[14:10:47] -rusti- error: aborting due to previous error
[14:10:47] -rusti- application terminated with error code 101
[14:10:54] <mark_edward> i thought you could do that?
[14:10:55] *** pmoore|running-errands is now known as pmoore
[14:14:22] *** Quits: azita (Azita@9C2E78E6.8C982E60.292610BC.IP) (Quit: azita)
[14:15:14] <pnkfelix> mark_edward: `n` needs to be a constant expression.  I think it works if you change `n` to be a global non-mutable static int.
[14:16:08] *** Parts: mw1 (mw@moz-B436A392.adsl.highway.telekom.at) ()
[14:16:09] <mark_edward> ah i see, what about the general case of making a zero initialized array? i think a lot of languages provide for this without a function call (ie C# new int[100] is 0 initialized)
[14:16:32] <FreeFull> C has calloc
[14:17:02] <FreeFull> Static arrays will be zero-initialised
[14:18:02] <mark_edward> rusti: '\x67'
[14:18:03] -rusti- 'g'
[14:18:11] <mark_edward> 'a' as int
[14:18:19] <mark_edward> rusti: 'g' as int
[14:18:20] -rusti- 103
[14:18:31] <mark_edward> 0x67
[14:18:39] <mark_edward> rusti: 0x67
[14:18:40] -rusti- 103
[14:18:41] *** Joins: exobit_ (textual@moz-E06F46F0.corp.bitshelter.com)
[14:19:01] <mark_edward> what is the difference between '\x<blah>' and '\U<blah>'?
[14:19:29] <eddyb> \x is 8bit, \u is 16bit and \U is 32bit
[14:19:43] <FreeFull> rusti: '\xFF'
[14:19:43] -rusti- '\xff'
[14:19:47] <Ms2ger> Why have 16-bit?
[14:19:54] <FreeFull> rusti: println("\xFF")
[14:19:55] -rusti- ÿ
[14:19:55] -rusti- ()
[14:20:12] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[14:20:21] <FreeFull> Ms2ger: A lot of characters fit in 16-bit
[14:20:29] <mark_edward> rusti: '\U00000067'
[14:20:29] -rusti- 'g'
[14:20:36] <bstrie> eddyb: I don't thinkt hat's right... iirc they're all the same, they just accept a different number of digits after them
[14:20:41] <bstrie> all chars are gonna be 32-bit
[14:20:41] <FreeFull> Writing out full 4 bytes every time is a pain
[14:20:46] *** Joins: stomper (Mibbit@19B4F7A4.716DD980.59D37A3.IP)
[14:20:54] <Ms2ger> Oh, you have to fill in all bits?
[14:21:06] <Ms2ger> rusti: println("\UFF")
[14:21:06] -rusti- <anon>:9:22: 9:23 error: illegal character in numeric character escape: \"
[14:21:06] -rusti- <anon>:9          println("\UFF")
[14:21:07] -rusti-                                ^
[14:21:07] -rusti- application terminated with error code 101
[14:21:09] <Ms2ger> I see
[14:21:17] <bstrie> just different notation for the same thing
[14:21:22] <eddyb> bstrie: I mean the size of the hex string following them
[14:21:23] <bstrie> no underlying implementation differences
[14:21:28] <bstrie> ok :P
[14:21:30] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[14:21:42] <eddyb> bstrie: "2/4/8 nibbles" might have been better
[14:22:13] <FreeFull> Well, unicode ends at U+10FFFF
[14:22:22] <Ms2ger> ... for nooooooooooow
[14:22:30] *** Quits: brson (brson@9C2E78E6.8C982E60.292610BC.IP) (Quit: leaving)
[14:22:33] <FreeFull> Nope, forever
[14:22:42] <bstrie> FreeFull: I presume we got this notations from other languages
[14:23:00] <FreeFull> UTF-16 is unable to encode anything above that, so they stopped there
[14:24:59] <pnkfelix> bstrie: Isn't there an issue somewhere to make \x actually correspond to a code-unit (1 byte) rather than a code-point (4 bytes) ?
[14:25:37] <bstrie> pnkfelix: not that I've heard of, anyway \x can either appear in string literals or in char literals, it doesn't have its own conception of bit depth
[14:25:57] *** Joins: alonlevy (alon@moz-74377C14.bb.netvision.net.il)
[14:26:16] <FreeFull> If you want bytes, don't use chars and strings
[14:26:50] <pnkfelix> bstrie: this: https://github.com/mozilla/rust/issues/2800
[14:28:37] <stomper> Hey all, what's the best way to use a `before_each` function in a test module?  I've been defining `setup()` functions that return tuples of created objects, but I feel like there's probably a better way...
[14:28:48] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[14:29:31] <bstrie> pnkfelix: I don't grasp the distinction. "\x65" is just sugar for typing "A", and likewise \u and \U are sugar for copying and pasting unicode characters into your code. afaict the underlying representation would always be handled by the type of the literal you'd be embedding it in
[14:29:43] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:30:04] <bstrie> i.e. [u8] for strings and u32 for chars
[14:30:44] <bstrie> stomper: good question
[14:31:26] *** Quits: Amaranth (travis@moz-B00289DC.sxct.qwest.net) (Quit: Linkinus - http://linkinus.com)
[14:31:37] <pnkfelix> bstrie: I believe the distinction comes when when write a multibyte character in a string
[14:31:37] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[14:32:09] <bstrie> I don't know enough of the unicode jargon to know the difference between a code unit and a codepoint
[14:32:14] <bstrie> so I abstain from commenting :P
[14:32:27] <pnkfelix> bstrie: In the context of utf8, a code-unit is a byte
[14:32:51] <pnkfelix> bstrie: (At least, that is my memory.  I did have to dive into the unicode manual to rediscover that.)
[14:33:27] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[14:34:31] <pnkfelix> bstrie: So I believe what #2800 is suggesting is that you would choose to *either* continue using \Unnnn to write a character, *or* you could use a sequence of \xNN's that would correspond to the actual byte sequence in the utf8 encoding.
[14:34:47] *** Joins: axitkhurana (Adium@1F8D0AFB.29C63407.A26A30FD.IP)
[14:34:52] <kimundi> rusti: 'ä' as uint
[14:34:53] -rusti- 228u
[14:34:56] *** Quits: axitkhurana (Adium@1F8D0AFB.29C63407.A26A30FD.IP) (Quit: Leaving.)
[14:35:15] <kimundi> rusti: "ä".as_bytes().to_owned()
[14:35:16] -rusti- ~[195u8, 164u8]
[14:35:23] <pnkfelix> bstrie: But I think we will need to wait until we've resolved our string encoding story before we resolve this question.
[14:35:23] <Ms2ger> People want to be able to write "\x80\xe2\x0a\xa6" instead of "\u2026"?
[14:35:24] <FreeFull> Everything up to U+7F will be a single byte in UTF-8
[14:35:41] <Ms2ger> That doesn't seem like a terribly good idea
[14:35:44] <kimundi> "\x228" vs "\x195\x164"
[14:36:15] *** Joins: xexio (xexio@E0B6D10F.3DF1D9C2.E62F6450.IP)
[14:36:23] <FreeFull> rusti: "\xE4"
[14:36:23] -rusti- "\xe4"
[14:36:28] <FreeFull> rusti: print("\xE4")
[14:36:29] -rusti- ä()
[14:36:36] <pnkfelix> Ms2ger: I'm not the proponent, so I cannot judge the value.
[14:36:56] <pnkfelix> Ms2ger: but I can see some arguments that magically expanding a \xNN out to four bytes might be unintuitive to some ...
[14:36:58] <Ms2ger> I'm not the proponent either, but I sure will judge ;)
[14:37:01] <pnkfelix> Ms2ger: sorry, that was wrong
[14:37:11] <pnkfelix> Ms2ger: its not expanded out to four bytes, of course
[14:37:13] <kimundi> In any case, any byte sequence that is not valid utf would have to be rejected
[14:37:36] <bstrie> but you'd still be able to reject it at compile time
[14:38:09] <Ms2ger> Otoh, I'm not sure that having a \x notation that encodes two bytes is a good idea either
[14:38:35] <Ms2ger> Maybe we should just have \u that takes any number of digits
[14:39:20] <kimundi> just use an different char then :P
[14:39:36] <kimundi> \Uxxxxxxxx \uxxxx \µxx
[14:39:41] <Ms2ger> Heh
[14:39:48] <Ms2ger> \xx
[14:40:04] <kimundi> rusti: "µ".as_bytes().to_owned()
[14:40:05] -rusti- ~[194u8, 181u8]
[14:40:18] <kimundi> rusti: "\b"
[14:40:19] -rusti- <anon>:9:11: 9:12 error: unknown string escape: b
[14:40:19] -rusti- <anon>:9          "\b"
[14:40:19] -rusti-                     ^
[14:40:19] -rusti- application terminated with error code 101
[14:40:29] <kimundi> oh, that is unused
[14:41:01] <kimundi> how about \b as replacement for \x ?
[14:41:03] <bstrie> the question is, does '\\x0x7865' successfully resolve to 'A'
[14:41:08] <bstrie> it's completely unambiguous!
[14:41:17] <Ms2ger> \uxx, \u̇xxxx, \üxxxxxxxx
[14:41:50] <Ms2ger> With 2**(number of dots + 1) digits
[14:42:05] <bstrie> how bout we just pick the sanest thing that another popular language does and stop worryiiinnnnngggg about it
[14:42:21] <kimundi> bstrie: Never!
[14:42:34] * bstrie defenestrates self
[14:43:58] <Ms2ger> bstrie, is there any other popular language with enforced-utf-8 strings?
[14:44:18] <bstrie> python3
[14:44:32] <bstrie> I think
[14:44:34] <bstrie> it's so confusing
[14:44:47] <bstrie> go does too, I think
[14:45:06] <Ms2ger> Is go popular? :)
[14:45:21] <bstrie> well, it is on HN :P
[14:45:26] * Ms2ger has no idea what py3k does
[14:48:26] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[14:48:47] *** jorendorff_away is now known as jorendorff
[14:48:48] <bstrie> In Python 3, all strings are sequences of Unicode characters. There is no such thing as a Python string encoded in UTF-8, or a Python string encoded as CP-1252. “Is this string UTF-8?” is an invalid question.
[14:50:08] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[14:50:28] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[14:51:55] <cmr> We can't reject invalid string literals always
[14:52:06] <cmr> bytes!("\x80") // what about me :(
[14:53:30] <kimundi> cmr: what about that?
[14:53:32] <Ms2ger> b""
[14:53:54] <cmr> kimundi: it'd be rejected as invalid utf8 if we do checking during parsing.
[14:53:57] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[14:54:04] <cmr> but that's not a string, it just uses the syntax
[14:54:06] <kimundi> cmr: rightly so
[14:54:12] <cmr> not rightly so!
[14:54:14] <kimundi> cmr well... no
[14:54:28] <FreeFull> rusti: b"\x80\x7F\x00"
[14:54:29] -rusti- <anon>:9:10: 9:24 error: expected one of `; }` but found `"\x80\x7f\x00"`
[14:54:29] -rusti- <anon>:9          b"\x80\x7F\x00"
[14:54:29] -rusti-                    ^~~~~~~~~~~~~~
[14:54:29] -rusti- application terminated with error code 101
[14:54:52] <cmr> Any chacking we do *has* to happen after macro expansion.
[14:55:32] <pnkfelix> cmr: that, or the bytes! macro (and things built on top of it) would need to be generalized to also accept `&'static [u8]` ?
[14:55:38] <kimundi> cmr: The way I see it, string literals can only contain valid utf8
[14:55:43] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[14:55:56] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[14:56:01] <cmr> pnkfelix: what do you mean?
[14:56:08] <bstrie> I agree with kimundi. if you want an array of arbitrary bytes, then... make an array of arbitrary bytes
[14:56:33] <pnkfelix> cmr: `bytes!([\x80])` instead of attempting `bytes!("\x80")` ?
[14:56:35] <kimundi> cmr: If you want byte values that don't appear in a utf8 string, why do you need to use a string literal for that?
[14:56:40] <cmr> kimundi: the way I see it, *strings* can only contain valid utf8, but string literals is how our syntax accomplishes arbitrary contents in syntax extensions.
[14:57:05] <bstrie> cmr: then perhaps we need to stop conflating these two concepts
[14:57:05] <cmr> rusti: stringify!([\x80])
[14:57:05] -rusti- <anon>:9:21: 9:22 error: unknown start of token: \\
[14:57:06] -rusti- <anon>:9          stringify!([\x80])
[14:57:06] -rusti-                               ^
[14:57:06] -rusti- application terminated with error code 101
[14:57:14] <kimundi> rusti: bytes("valid", 0xff)
[14:57:14] -rusti- <anon>:9:9: 9:14 error: unresolved name `bytes`.
[14:57:14] -rusti- <anon>:9          bytes("valid", 0xff)
[14:57:14] -rusti-                   ^~~~~
[14:57:15] -rusti- error: aborting due to previous error
[14:57:15] -rusti- application terminated with error code 101
[14:57:20] <kimundi> rusti: bytes!("valid", 0xff)
[14:57:21] -rusti- &[118u8, 97u8, 108u8, 105u8, 100u8, 255u8]
[14:58:06] <pnkfelix> (i did say "would need to be generalized …")
[14:58:14] <cmr> mmm
[14:59:25] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[14:59:44] <kimundi> cmr: I get what you mean though. I'm just not sure if it's worth the trouble...
[15:01:32] <mark_edward> do we have a max function?
[15:01:35] <kimundi> We have the content of a string literal as written in the source file between a "" pair, we have the string they encode after escape sequence expansion, and we have the final content of a string type
[15:01:54] <cmr> mark_edward: std::num::max
[15:02:03] <mark_edward> ah, thanks!
[15:02:07] <kimundi> As rust source files are always utf8, the first of those three things has to be utf8 too
[15:02:29] <pnkfelix> mark_edward: there is also std::cmp::max
[15:02:35] <bstrie> why are there two
[15:02:43] <cmr> Why are there two..
[15:02:55] <kimundi> Because of that, we also need to ensure that the second of those things, escape sequence expansion, also results in valid utf8/unicode, or we are inconsistent
[15:02:56] <pnkfelix> bstrie: I dunno; looks to me like std::num::max is a method
[15:03:10] <cmr> Ah, because of floats.
[15:03:18] <cmr> Their ordering is not the same as min/max
[15:03:50] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[15:03:50] *** ChanServ sets mode: +ao dherman dherman
[15:03:54] <kimundi> The third of those things, actual content of a string type, can be anything, as long as it is possible to convert to it from unicode
[15:03:57] *** Quits: stomper (Mibbit@19B4F7A4.716DD980.59D37A3.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:04:53] <kimundi> If we allow string literals to contain non-unicode then we have a problem
[15:04:55] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[15:05:01] *** Quits: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr) (Ping timeout)
[15:05:24] <cmr> kimundi: we can reject invalid string literals, it just has to happen after macro expansion
[15:05:40] <cmr> that'd have to happen anyway. otherwise a macro could expand to invalid utf8 strings
[15:06:15] <bstrie> cmr: can you demonstrate a macro expanding to an invalid string?
[15:06:38] <kimundi> cmr: If all string literals are utf8, and all string manipulation functions are correct, then macros can not expand to anything else than a utf8 string literal
[15:06:57] <cmr> macro_rules!( (valid) => "asdf", (invalid) => "asd\xff" )
[15:07:09] <kimundi> that would be invalid
[15:07:33] <kimundi> at a parsing level
[15:07:42] <cmr> But then we reject any syntax extension that wants to use \ in string literals for non-escaping things.
[15:07:58] * cmr doesn't like the \ meta-language in strings
[15:08:03] *** jorendorff is now known as jorendorff_away
[15:08:08] <kimundi> Hu? How that?
[15:08:35] <bstrie> cmr: if you want to use raw \, then isn't that what raw strings are for?
[15:08:41] <cmr> bstrie: oh, right!
[15:08:45] <cmr> I forgot we have raw strings
[15:08:49] <cmr> Nevermind, carry on
[15:08:55] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[15:08:57] <bstrie> I'm still pretty happy with our raw strings
[15:09:08] <bstrie> "this isn't as bad as it could have been"
[15:09:18] <bstrie> high praise for language design
[15:11:26] *** jorendorff_away is now known as jorendorff
[15:11:46] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[15:11:59] <kimundi> cmr: Darn it, I though to long about it and now I'm starting to warm up to your pov after all. :P
[15:12:45] <bstrie> we really need a diagram of the phases of rust compilation
[15:12:55] <cmr> kimundi: with raw strings, my pov becomes irrelevant
[15:13:10] <pnkfelix> cmr: does it?  raw-strings are still utf-8, no?
[15:13:22] <bstrie> it would be easier to discuss stuff like this if I could tell exactly how late macro expansion happens
[15:13:24] <cmr> pnkfelix: butthey don't expand \-sequences
[15:13:46] <pnkfelix> cmr: Ah, and then the bytes! macro would do the expansion itself then?
[15:13:55] <cmr> bstrie: it happens exactly after parsing and cfg-stripping-round-one
[15:13:57] <pnkfelix> cmr: (by inspecting the raw-string's contents?)
[15:14:05] <kimundi> In other words, what "\xFF" means is unimportant as long as you can have expand_raw!(r"\xFF")
[15:14:16] <cmr> pnkfelix: yep!
[15:14:33] <cmr> Well
[15:14:35] <cmr> Hm
[15:14:45] <cmr> No
[15:15:05] <cmr> bytes!(r"...") would do no expansion if bytes! didn't do any, but bytes!("...") would
[15:15:16] <bstrie> cmr: the existence of a phase named "cfg-stripping-round-one" makes me even more worried
[15:15:55] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[15:16:00] <pnkfelix> cmr: I'm just trying to understand how you're solving the problem of: bytes!("\x80")
[15:16:03] <cmr> bstrie: We strip things with #[cfg] before macros, so you can have conditionally-defined macros, and then we strip after macros so macros can expand into conditionally-defined things, iirc..
[15:16:33] <pnkfelix> cmr: bytes!(r"\x80")  would only solve things for you if bytes! were changed in some way, no?
[15:16:43] <kimundi> pnkfelix: Make bytes!(r"\x80") handle the "\x" specially
[15:16:44] <cmr> pnkfelix: yeah, but I'm ok with that
[15:17:22] <pnkfelix> cmr: ah, I didn't follow what you meant by "bytes!(r"...") would do no expansion if bytes! didn't do any, but bytes!("...") would"
[15:17:24] <kimundi> Incidentally, that would mean bytes!("\\x80") would also work :P
[15:17:33] <pnkfelix> cmr: but now I think I do, it was Alice-in-Wonderland style speech.  :)
[15:18:06] <kimundi> Unless the difference between a string literal and a raw string literal reaches macro expansion
[15:18:16] <cmr> kimundi: it shouldn't
[15:18:22] <cmr> I don't think..
[15:18:31] <kimundi> shouldn't work or reach?
[15:18:50] <cmr> bstrie: everything rustc does in order: https://github.com/mozilla/rust/blob/master/src/librustc/driver/driver.rs#L135
[15:19:03] <cmr> kimundi: reach
[15:19:09] <kimundi> okay
[15:19:21] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[15:19:59] <cmr> I think "raw strings are always equivalent to strings" is a useful invariant, having it reach syntaxexts would be weird
[15:20:10] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[15:20:35] <bstrie> cmr: I'm sad that privacy resolution, name resolution, typechecking, and borrow checking are all part of the same pass
[15:20:51] <bstrie> you'd at least hope that those first two could be split out
[15:21:18] <cmr> bstrie: same phase you mean?
[15:22:16] <cmr> before-typeck and after-typeck probably need to be split. having to do all of the analysis slows down rustdoc
[15:24:43] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[15:25:10] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[15:25:30] *** jorendorff is now known as jorendorff_away
[15:29:03] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:30:02] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[15:30:09] *** Joins: alan (alan@32702EE8.939109B2.FB082A98.IP)
[15:30:43] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Ping timeout)
[15:30:44] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[15:31:35] <benh> why are you doing bytes!("\x80") tho
[15:31:41] <benh> instead of 0x80
[15:31:52] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[15:32:22] <pnkfelix> benh: I'm assume in the hypothetical use case it occurs within a larger byte sequence
[15:32:35] <pnkfelix> benh: that cmr would prefer to encode via a string literal syntax
[15:32:42] <cmr> bytes!("this is a long string\xe9\x23with inter\xa7spersed randomness")
[15:32:46] <benh> bytes!("blah", 0x80u8, "blah") seems reasonable enough :9
[15:33:06] *** Joins: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP)
[15:33:21] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[15:36:09] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[15:37:22] <eddyb> rusti bytes!("blah", 0x80u8, "blah")
[15:37:27] <eddyb> rusti: bytes!("blah", 0x80u8, "blah")
[15:37:36] <eddyb> pfffft :(
[15:37:40] *** pmoore is now known as pmoore|afk-back-shortly
[15:37:49] <kimundi> rusti is offline
[15:38:09] <kimundi> dunno why though...
[15:38:43] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[15:38:49] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Client exited)
[15:38:50] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[15:39:09] *** Joins: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net)
[15:39:17] <cmr> strcat's internet probably died
[15:40:52] *** Quits: infynyxx (infynyxx@moz-7759A364.dsl.static.sonic.net) (Ping timeout)
[15:41:23] *** Quits: xexio (xexio@E0B6D10F.3DF1D9C2.E62F6450.IP) (Quit: Konversation terminated!)
[15:41:46] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[15:43:27] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[15:43:56] *** Joins: ak31 (ak31@moz-5C189D89.red.bezeqint.net)
[15:44:26] <ak31> how can i run libstdc/rand/mod.rs benchmark tests?
[15:44:30] <mark_edward> i actually am starting to dislike type inference... it destroys a lot of the self documenting nature of statically typed code..
[15:44:51] <Ms2ger> Heretic!
[15:45:01] <cmr> ak31: 'make check' runs them. but you can do `rustc --test lib.rs` and `./std --bench rand` too
[15:45:19] <cmr> mark_edward: you can still add type hints if you like
[15:45:23] <Edwards> mark_edward I think good IDE support with code completion would help with that a lot.
[15:45:27] <ak31> cmr: ok. i will try
[15:45:44] <cmr> I don't think "self documenting" is a thing static typing does or tries to achieve
[15:46:02] <Ms2ger> It does often help to achieve it
[15:46:07] <Ms2ger> Even if it doesn't try
[15:46:16] <mark_edward> cmr: i know, but it doesn't help when looking at other peoples code. it's almost as bad as trying to understand a huge python codebase. you have to know the sig of every method/function call to figure out what variables are
[15:46:35] <cmr> mark_edward: then the variables are poorly named ;)
[15:46:48] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:46:55] <cmr> Edwards is right though. Tooling helps a lot here
[15:46:56] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Client exited)
[15:47:14] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[15:47:16] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:48:01] <Edwards> I've been mulling over a way to automatically generate JNI code for a Rust/Java bridge, to the eventual end of an IntelliJ plugin for Rust.
[15:48:11] <cmr> And with static typing it's *possible* to have tooling, unlike python
[15:48:52] <Edwards> Unfortunately I don't really know Rust well enough yet to know the best way to do that.
[15:49:02] <ak31> running rustc --test mod.rs from rust/src/libstd/rand gives me the following errors:
[15:49:09] <ak31> mod.rs:77:4: 77:15 error: glob import statements are experimental and possibly buggy
[15:49:10] <ak31> mod.rs:77 use prelude::*;
[15:49:10] <ak31>               ^~~~~~~~~~~
[15:49:10] <ak31> mod.rs:77:4: 77:15 note: add #[feature(globs)] to the crate attributes to enable
[15:49:10] <ak31> mod.rs:77 use prelude::*;
[15:49:10] <ak31>               ^~~~~~~~~~~
[15:49:12] <ak31> distributions/range.rs:90:0: 90:11 error: macro definitions are not stable enough for use and are subject to change
[15:49:17] <ak31> distributions/range.rs:90 macro_rules! integer_impl {
[15:49:19] <ak31>                           ^~~~~~~~~~~
[15:49:21] <ak31> distributions/range.rs:90:0: 90:11 note: add #[feature(macro_rules)] to the crate attributes to enable
[15:49:23] <ak31> distributions/range.rs:90 macro_rules! integer_impl {
[15:49:25] <ak31> ...
[15:49:26] <Ms2ger> So do that
[15:49:27] <ak31> distributions/mod.rs:560:8: 560:17 error: glob import statements are experimental and possibly buggy
[15:49:28] <cmr> ak31: you need to run it on libstd/lib.rs, not the mod.rs
[15:49:29] <ak31> distributions/mod.rs:560     use super::*;
[15:49:30] <Edwards> Oof. Pastebin is our friend.
[15:49:31] <ak31>                                  ^~~~~~~~~
[15:49:33] <ak31> distributions/mod.rs:560:8: 560:17 note: add #[feature(globs)] to the crate attributes to enable
[15:49:35] <ak31> distributions/mod.rs:560     use super::*;
[15:49:37] <ak31>                                  ^~~~~~~~~
[15:49:38] <Ms2ger> Don't forget the trailing ;
[15:49:45] <cmr> Ms2ger: he compiled the wrong file
[15:49:56] <ak31> cmr: got it
[15:50:12] <cmr> ak31: and please don't paste that many times again. more than 3 is considered impolite
[15:50:24] <Ms2ger> cmr, ah, didn't realize it was in response to something
[15:50:28] <ak31> cmr: sorry. won't do.
[15:50:44] <pnkfelix> ak31: You can use services like https://gist.github.com/  or http://pastebin.mozilla.org/ to make links
[15:50:47] <cmr> Edwards: I think the sanes thing to do would be to dump JSON and have the plugin use that
[15:50:58] <ak31> pnkfelix: alright. good idea.
[15:51:17] *** Joins: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net)
[15:51:19] <Edwards> cmr: Is there a way to have rustc dump a JSON of the AST? That's totally a viable option if so.
[15:51:26] <cmr> Edwards: No, but we can add one.
[15:51:45] <Edwards> I think that would be an awesome feature.
[15:51:53] <cmr> We already have serialization of the entire ast
[15:51:53] *** pmoore|afk-back-shortly is now known as pmoore
[15:51:54] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[15:51:58] <Edwards> Nice
[15:52:13] <Sharp> We do?
[15:52:21] <Edwards> Yeah, actually, that would be perfect. The lexer too, if at all possible?
[15:52:26] <cmr> Edwards: I was more thinking "write program in rust that dumps the json you need", but if it's easier for you to have the entire AST, I'm willing to enable that :)
[15:52:34] <cmr> What do you mean by lexer, exactly?
[15:52:41] <cmr> Dump token streams?
[15:52:45] <Edwards> Yeah
[15:52:47] <cmr> Sharp: we do! it's how metadata works
[15:53:06] <Sharp> Oh, neat!
[15:53:07] <cmr> I haven't really worked with that part of libsyntax, so I'm not sure.
[15:53:12] <pnkfelix> cmr: Does the entire ast go in there, or just a subset ?
[15:53:17] <Edwards> http://confluence.jetbrains.com/display/IDEADEV/Developing+Custom+Language+Plugins+for+IntelliJ+IDEA This is what I'm working from at this point.
[15:53:30] <pnkfelix> cmr: I'm sure we *can* serialize the whole AST, I just wasn't sure if that's what ends up in the metadata
[15:53:31] *** Joins: maxiepoo_ (Max@moz-13F4F196.nuwlan.northwestern.edu)
[15:53:37] <cmr> pnkfelix: the entire ast *can* go in it, but we only put what we need (generic functions etc)
[15:53:41] <bstrie> mark_edward: the pretty-printer has an option that will rewrite all code to insert the correct types
[15:53:52] <bstrie> mark_edward: but the pretty-printer otherwise kinda sucks right now
[15:54:00] <Edwards> Though to do real code completion, I'm gonna need the type information too.
[15:54:01] <Edwards> Hrm
[15:54:02] <mark_edward> bstrie: oh, that's pretty cool
[15:54:07] <ak31> rustc --test lib.rs didn't output tests/benchmarks results.
[15:54:23] <ak31> only a warning message, which is insignificant in my opinion.
[15:54:24] <pnkfelix> ak31: I think you need to do --bench somewhere, either during running or building or both
[15:54:28] <cmr> ak31: it should have created a 'std' binary in the current directory.
[15:54:40] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[15:54:41] <ak31> hooowoo i see.
[15:54:41] <Edwards> cmr: I mean, if it's not a lot of work, I think --emit-ast or something would be a good idea anyway. It lets others use rustc as a parser without writing bridge code, which could open up a lot of avenues for other tooling.
[15:54:46] <cmr> Edwards: you're not going to be able to get on-the-fily parsing or completion.
[15:54:47] <kimundi> ak31: rustc --test only build the testrunner, you need to actually run it
[15:54:56] *** Joins: ianj (ianjneu@moz-7140CF01.ccs.neu.edu)
[15:55:04] <ak31> kimundi: thanks i got it :)
[15:55:10] <cmr> Edwards: the compiler simply isn't designed for it, it can't partially parse/typecheck files etc
[15:55:12] <ak31> cmr: yep! i found it
[15:55:27] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: brb)
[15:56:13] <Edwards> cmr: Full file recompilation should be fine.
[15:56:31] <ak31> i see there are some ignored tests, is that for a reason?
[15:56:41] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[15:56:51] <kimundi> Edwards: The problem is we only have full crate :)
[15:58:39] <ak31> btw: why is rusti not built?
[15:58:45] <kimundi> got removed
[15:58:48] <cmr> ak31: it doesn't exist
[15:59:06] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[15:59:29] <ak31> so we are not going to use any interpreter ?
[15:59:56] <cmr> someone needs to write and maintain one
[16:00:04] <ak31> sorry for asking too much obvious questions.
[16:00:37] <ak31> hoo... ok. but if i would like to see its code, where would i find it?
[16:00:37] <kimundi> rusti never was a interpreter ;). It was a tool that desperately tried to be better than rustc -o foo && ./foo, and constantly failed at that 
[16:00:50] <Edwards> kimundi: Sorry, my vocab is still a little shaky. A crate is multiple files, like a Java package or something?
[16:00:54] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[16:01:03] <cmr> ak31: it's in the git history somewhere.
[16:01:05] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[16:01:06] <ak31> kimundi: hmmm... sorry for assuming that. good to know
[16:01:09] <kimundi> Edwards: Yeah, all the files the go in the binary
[16:01:12] <ak31> cmr: okay.
[16:01:17] <Edwards> Gotcha
[16:01:39] <cmr> Edwards: A crate is Rust's unit of compilation. You  can't compile individual files separately, only a single crate. Logically it forms a sort-of package
[16:01:56] <Edwards> Yeah, that makes sense.
[16:02:45] <kimundi> well, logical a crate is a tree of modules, which doesn't care how many source files where involved in its creation :)
[16:05:57] <cmr> Edwards: https://github.com/mozilla/rust/issues/10485
[16:05:59] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[16:06:11] *** Joins: kellogh (timkellogg@moz-602CE33D.midco.net)
[16:06:27] <Edwards> Nice, thanks
[16:07:08] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[16:09:12] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[16:12:13] *** Joins: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP)
[16:13:11] *** Quits: Ms2ger (Ms2ger@moz-91FBDBDF.ugent.be) (Quit: bbl)
[16:14:18] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[16:14:26] *** Quits: alan (alan@32702EE8.939109B2.FB082A98.IP) (Quit: alan)
[16:15:30] <pytess> Hi.I failed to install rust.error 101
[16:16:05] <cmr> pytess: the error code isn't useful. can you pastebin the full build log?
[16:17:12] *** Quits: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP) (Ping timeout)
[16:17:23] *** Quits: Ferreus (ferreus@moz-8F7D0367.dip0.t-ipconnect.de) (Ping timeout)
[16:17:23] *** Quits: z0w0 (zack@moz-EC26A2C.qwl9.woo.bigpond.net.au) (Client exited)
[16:18:26] *** Quits: silotis (quassel@moz-4B8C4631.oc.oc.cox.net) (Ping timeout)
[16:20:12] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[16:22:41] *** Joins: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP)
[16:23:17] *** Quits: maxiepoo_ (Max@moz-13F4F196.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[16:24:29] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[16:24:32] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Quit: WeeChat 0.4.3-dev)
[16:24:41] *** pmoore is now known as pmoore|dinner
[16:25:00] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[16:26:05] <ak31> what kind of benchmark tests do you suggest one should do?
[16:26:12] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[16:26:20] *** Quits: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP) (Ping timeout)
[16:27:12] <Leo`> I got this error:
[16:27:14] <Leo`> 23:5 error: constant contains unimplemented expression type
[16:27:14] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[16:27:27] <Leo`> is this something unimplemented in the compiler ?
[16:27:39] <cmr> Leo`: Yes, but what is the static that gave that error?
[16:28:54] <cmr> ak31: ideally we'd have full benchmark cover. Are you talking specifically about rand?
[16:28:55] <Leo`> wait
[16:29:00] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[16:29:13] <Leo`> cmr: it's a static allocation of a struct containing a ~[T] I think
[16:29:25] <cmr> Leo`: yeah, you can't do that.
[16:29:38] <ak31> no, i am talking about vec starts_with and ends_with benchmark tests that you posted
[16:29:41] <cmr> Leo`: statics need to actually be static: no runtime initializatoin, which ~[T] requires
[16:29:42] <Leo`> static foo: &'static Foo = &Foo { val: ~[...] };
[16:29:47] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[16:29:57] <Leo`> cmr: merf :|
[16:30:07] <Leo`> cmr: is this going to be implemented at some point or... ?
[16:30:16] <cmr> Leo`: No, never
[16:30:25] <Leo`> ok
[16:30:30] <cmr> Leo`: The language will not require before-main initialization
[16:30:32] <Leo`> the message in the compiler should be changed
[16:30:33] *** kimundi is now known as zz_kimundi
[16:30:43] <cmr> it should be
[16:30:51] <cmr> I'll do that today
[16:31:10] <Leo`> hm
[16:31:36] <Leo`> i'd like to have this struct statically initialized... but I don't see how I can do without a ~[T] unfortunately
[16:32:34] <cmr> the usual workaround is to make it an `static mut x: Option<Foo> = None` and swap it out at main or another convenient time
[16:32:40] <mark_edward> cmr: `echo "fn main() {let x = ~5u; let _ = x; println!(\"{}\", *x); }" | rustc - && ./rust_out && rm rust_out` works in my terminal. i thougt the `let _ = x` pattern destroyed things or ended their scope?
[16:33:39] <cmr> mark_edward: that's quite strange, it should move x. Can you open a bug?
[16:33:58] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[16:34:04] <mark_edward> ok. i'll try it in a real file as well just to make sure
[16:34:41] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[16:34:52] *** Joins: edorian (Mibbit@moz-8DA69D93.dynamic.qsc.de)
[16:35:00] *** Quits: sk (sk@9E6B574B.EB2AA036.2CAF0D3B.IP) (Quit: Leaving)
[16:35:03] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Ping timeout)
[16:35:39] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[16:35:43] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[16:36:02] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[16:36:38] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Quit: Leaving...)
[16:37:19] <cmr> ak31: sorry about that. basically, benchmark the various cases with starts_with and ends_with. When the needle is at the opposite end of the vector, in the middle, and not present at all would be a great start.
[16:37:37] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[16:38:07] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[16:39:02] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Quit: WeeChat 0.3.8)
[16:39:38] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[16:39:55] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[16:41:21] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: leaving)
[16:41:33] <Leo`> cmr: the problem is dat the ~[T] is unlinkely to change but I can't use a fixed-size vector
[16:41:43] <Leo`> since other instances of the struct may have a vector of another size
[16:42:13] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[16:42:47] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Ping timeout)
[16:42:52] <cmr> Leo`: That is a problem :(
[16:43:07] <cmr> And you can't use &'static [T] if hte others need a ~[T]
[16:43:16] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[16:43:21] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[16:43:35] <Leo`> cmr: the others will have their array dynamically allocated
[16:43:40] <cmr> right
[16:43:42] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[16:43:47] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[16:43:51] <cmr> We need something like SendStr for vec
[16:44:04] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[16:44:07] <Leo`> there is just 1 instance of the struct that has to be kept in memory 
[16:44:29] <Leo`> that's why it would have been great if I was able to allocate its array statically
[16:44:44] <Leo`> so this instance could be statically allocated too
[16:44:56] <Leo`> I guess I can play with unsafe pointers
[16:45:06] <Leo`> replace the ~[T] by a *T and the size
[16:45:09] <Yurume> cmr, actually I have an opt_owned module for that: https://github.com/snrs/sonorous/blob/master/src/util/opt_owned.rs
[16:45:12] <Leo`> but I dunno if it's q good thing
[16:45:16] <Leo`> s/q/a/
[16:45:35] <Yurume> the problem is, should we keep SendStr or replace it with OptOwnedStr<'static>?
[16:46:17] <cmr> When would you ever want OptOwnedStr<'a>?
[16:46:35] <cmr> (That you couldn't just take `&'a str` in the first place)
[16:47:37] <Yurume> I have a callback, which can return either an owned string or a borrowed string slice from the current line while parsing some file.
[16:47:58] <cmr> Mmm, that makes sense
[16:48:00] <cmr> returning, not taking
[16:48:02] <Yurume> in many cases the callback is expected to examine and *discard* the argument, but sometimes not.
[16:48:41] *** Joins: TisButMe (Mibbit@moz-B89F817B.w80-9.abo.wanadoo.fr)
[16:48:54] <Yurume> hmm, I guess OptOwnedStr<'static> is not Send-able, right? (despite it's techincally same as SendStr)
[16:49:12] <cmr> It should be?
[16:49:57] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[16:50:06] *** Quits: TisButMe (Mibbit@moz-B89F817B.w80-9.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[16:50:56] <Yurume> rusti: enum A<'self> { P(&'self str), Q(~str) } let v = P::<'static>("que?"); do spawn { println(match v{P(s)=>s.as_slice(), Q(ref s)=>s.as_slice()}); }
[16:51:24] *** Joins: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP)
[16:51:37] <Leo`> cmr: if I have a struct Foo { arr: [uint, .. SIZE] }
[16:51:46] <Leo`> cmr: will the size of Foo be the size of the array ?
[16:51:54] <Leo`> or does it just contains a pointer ?
[16:52:00] <Yurume> the size of the array.
[16:52:15] <Leo`> mh :/
[16:52:16] <cmr> +/- padding
[16:52:21] <Yurume> minus padding?!
[16:52:24] <Leo`> yeah of course
[16:52:28] <cmr> ... good point
[16:53:13] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Quit: Leaving...)
[16:53:15] <Yurume> cmr: uh... so Send kind is per the fully instanced type? I always assumed that it's per the declared type, but your were right that OptOwnedStr<'static> is actually Sendable.
[16:53:54] *** Quits: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net) (Quit: Leaving.)
[16:54:04] <cmr> Yurume: Of course. If you have struct Foo<T> { x: T }, Foo will be Send when T is
[16:54:57] <Yurume> it's obvious for type params, it seemed not obvious for lifetime params (only possible difference would be the distinction between &'static T and &'r T where 'r != 'static).
[16:55:30] *** Joins: obi_wan (Mibbit@19B4F7A4.716DD980.59D37A3.IP)
[16:58:03] *** Quits: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP) (Ping timeout)
[16:59:07] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[16:59:15] <obi_wan> Hi, is there a good way to run all the tests in a Rust project?  I've tried making a separate `all_tests.rs` file that imports all the modules, but it's causing some of the tests to be run multiple times because they get imported by some of the other modules.  If I remove them, I get `unresolved import`s
[17:00:13] <cmr> obi_wan: `rustc --test lib.rs` ?
[17:00:35] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[17:03:04] *** Joins: haberman (Mibbit@moz-D730FB90.hsd1.wa.comcast.net)
[17:03:20] *** Joins: beifeng (Mibbit@B96FAEE2.FE191449.64FAF8EC.IP)
[17:03:40] *** Joins: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP)
[17:03:55] <haberman> do "crust" C -> Rust functions still exist? https://mail.mozilla.org/pipermail/rust-dev/2012-February/001404.html
[17:04:21] <haberman> I couldn't find a mention of them in the current FFI tutorial: http://static.rust-lang.org/doc/master/tutorial-ffi.html
[17:04:53] <obi_wan> @cmr when I run the executable produced, it still runs tests multiple times
[17:05:54] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[17:06:02] <erickt> haberman: crust doesn't exist anymore
[17:06:33] <pnkfelix> haberman:  I think you can just add a `extern "C"` in front of a function definition
[17:06:34] <erickt> haberman: I believe you can do `extern "C" fn foo() -> ... { ... }`
[17:06:40] <pnkfelix> haberman: to make it callable from C
[17:06:52] <pnkfelix> haberman:  e.g. : extern "C" fn foo(x: ::std::libc::c_int) -> ::std::libc::c_int { 2 * x }
[17:07:40] <pnkfelix> this really could be spelled out better in the FFI tutorial.  I'll go see if there's an issue filed for this yet
[17:07:50] *** q66_ is now known as q66
[17:07:51] <haberman> pnkfelix: thanks!
[17:08:05] <haberman> know of any sample code that does this?
[17:08:35] <cmr> obi_wan: then you have duplicate `mod`s in your crate.
[17:08:37] *** Joins: notmatt (notmatt@118CCA77.D1B89392.602E4FC1.IP)
[17:08:43] <cmr> obi_wan: see http://static.rust-lang.org/doc/master/tutorial.html#crates-and-the-module-system
[17:10:00] *** Quits: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP) (Ping timeout)
[17:10:10] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[17:11:30] <pnkfelix> haberman: I see some uses in the library source, like in libstd/rt/thread.rs  (look for thread_start )
[17:11:54] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[17:12:07] <pnkfelix> haberman: and there is also test/auxiliary/extern-crosscrate-source.rs
[17:13:05] <obi_wan> @cmr yeah, I've been looking at that, but any `mod` I try to remove ends up with an `unresolved import` error.  I'm starting to think I should lean toward passing around primitives rather than my own data structures, so my modules have fewer dependencies on each other.
[17:13:17] <obi_wan> @cmr thanks for your help
[17:13:28] <cmr> obi_wan: if you put your source up somewhere, we can help you better
[17:14:04] <cmr> obi_wan: the "sanctioned" crate structure is to have all, or most, of your `mod` in the crate file, and `use` the things you need in each crate.
[17:14:49] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[17:15:15] <ak31> hey, what does range(...).collect do at `from_fn(100, |i| range(0,i).collect)`
[17:15:29] <ak31> *collect()
[17:15:44] <bstrie> ak31: does that actually work?
[17:15:45] *** Joins: doomlord__ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[17:15:56] *** Quits: doomlord__ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Client exited)
[17:15:56] <bstrie> without a type annotation following collect, I mean
[17:16:04] *** Joins: alan (alan@32702EE8.939109B2.FB082A98.IP)
[17:16:05] <bstrie> because if so, then that's totally great
[17:16:09] <cmr> bstrie: yes, from_fn's signature is -> ~[T]
[17:16:13] <cmr> the closure it takes, that is
[17:16:18] <bstrie> I'm just happy that it can be inferred
[17:16:21] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[17:16:41] <bstrie> ak31: collect takes an iterator and puts all its values into a container
[17:17:07] <cmr> Aww, that doesn't actually work though because you can't take the value of a method
[17:17:08] <ak31> it works yeah: let xss: &[~[uint]] = vec::from_fn(100, |i| range(1,i).collect())
[17:17:13] <cmr> you need the call
[17:17:21] <bstrie> well, right
[17:17:24] <bstrie> you need the call
[17:17:35] <bstrie> but can you omit the type annotation
[17:17:40] <ak31> bstrie: thanks. but what is the usage of the |i|?
[17:17:47] <ak31> is that the value it puts in the vector?
[17:17:49] <bstrie> ak31: from_fn takes a closure
[17:18:04] <bstrie> ak31: closures in rust looks like `|params| expression`
[17:18:04] <cmr> ak31: it's a closure. it calls the closure 100 times to construct a new vector of the closure's return values
[17:18:15] <haberman> pnkfelix: perfect
[17:19:00] <ak31> if i want to return the i value as char. how do i do that? do i put it in the closure?
[17:19:16] <cmr> std::char::from_u32(i)
[17:19:19] <cmr> yes
[17:19:34] <bstrie> ak31: vec::from_fn(100, |i| std::char::from_u32(i))
[17:19:41] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[17:20:00] <ak31> thanks cmr & bstrie
[17:20:00] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:20:55] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[17:22:07] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[17:22:36] <Yurume> aargh, my quest for conversion from std::io to std::rt::io (which is just std::io in 0.9) is stuck, ReaderUtil does not work for &mut Reader. :S
[17:22:57] *** Joins: Ms2ger (Ms2ger@AB9469A5.3CF91143.187A1082.IP)
[17:25:21] <Yurume> ...and I realized 0.9 does not have such thing like ReaderUtil.
[17:25:34] *** zz_kimundi is now known as kimundi
[17:25:39] * Yurume gives up preparing for 0.9 updates while using 0.8
[17:25:46] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[17:25:46] *** ChanServ sets mode: +ao dherman dherman
[17:26:25] <cmr> yeah, they got changed to default methods on Reader
[17:27:17] *** Joins: mikezaby (mikezaby@moz-AA896205.home.otenet.gr)
[17:27:25] *** Joins: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP)
[17:32:06] *** Quits: beifeng (Mibbit@B96FAEE2.FE191449.64FAF8EC.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:32:35] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[17:33:26] *** Quits: pytess (chatzilla@41E8DB68.9B7417CD.A2DC32D.IP) (Ping timeout)
[17:34:46] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[17:35:45] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[17:36:29] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[17:36:39] *** Quits: ak31 (ak31@moz-5C189D89.red.bezeqint.net) (Ping timeout)
[17:38:40] *** Joins: beifeng (Mibbit@4461887B.67084680.C7DB8B78.IP)
[17:41:13] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[17:43:13] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[17:43:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:45:22] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[17:45:38] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[17:46:05] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[17:47:58] *** Quits: haberman (Mibbit@moz-D730FB90.hsd1.wa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:50:34] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[17:51:39] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[17:52:23] *** Joins: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP)
[17:53:27] *** Joins: alan_ (alan@moz-FE02DD30.sat6.rackspace.com)
[17:53:43] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[17:54:43] *** Quits: alan (alan@32702EE8.939109B2.FB082A98.IP) (Ping timeout)
[17:54:43] *** alan_ is now known as alan
[17:56:30] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[17:57:28] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[17:58:00] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Quit: )
[18:02:43] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[18:04:30] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[18:04:59] *** Joins: raisin (Mibbit@moz-B234C23B.rev.numericable.fr)
[18:05:23] *** Joins: Kruppe (user@moz-C9026991.net.uwaterloo.ca)
[18:06:05] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[18:07:36] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[18:07:37] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[18:08:26] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[18:09:24] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[18:10:24] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[18:10:27] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[18:12:11] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Quit: nwmcsween)
[18:12:26] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[18:12:58] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[18:15:15] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[18:16:27] *** pmoore|dinner is now known as pmoore
[18:19:20] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[18:19:36] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[18:22:04] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[18:24:06] *** Quits: mikezaby (mikezaby@moz-AA896205.home.otenet.gr) (Input/output error)
[18:24:10] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Client exited)
[18:24:31] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[18:24:33] <mark_edward> is there anyway to debug rust?
[18:24:46] <bstrie> mark_edward: rust code does not contain bugs.
[18:24:57] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[18:25:01] <bstrie> hence, no. such a question is ludicrous.
[18:25:15] <cmr> mark_edward: debug!() and gdb'
[18:25:25] <bstrie> I hear lldb now too?
[18:25:30] <mark_edward> cmr: but gdb `info locals` comes up empty
[18:25:38] <cmr> sure, any debugger that uses dwarf
[18:25:46] <cmr> mark_edward: did you build with -Z extra-debug-info ?
[18:25:46] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[18:25:47] <bstrie> you have to compile with the debug info flags, right?
[18:26:01] <sp3d> -Z debug-info and/or extra-debug-info
[18:26:03] <mark_edward> cmr:  i just used -Z debug-info
[18:26:13] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Ping timeout)
[18:26:39] <cmr> mark_edward: try with extra. If it doesn't work, file a bug, cc @jdm
[18:26:50] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[18:27:00] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[18:27:11] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[18:27:14] <Yurume> bstrie, rust code does not contain memory bugs, but it can contain logic bugs, since the Human Brain is a primary source of bugs.
[18:27:48] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[18:27:50] <Yurume> (in fact, it is long known that the Human Brain itself *is* buggy, but... ha.)
[18:27:59] <bstrie> Yurume: you're close to being correct. any bugs that you *perceive* in rust code are not bugs at all, but merely the pitiful limitation of the human brain to fully comprehend the sublimity of rust
[18:28:21] <mark_edward> cmr: ah, extra is working, thanks why doesn't `--cfg debug` do that?
[18:28:23] <Yurume> well played ;)
[18:28:30] <cmr> mark_edward: --cfg debug doesn't do anything
[18:29:03] <cmr> mark_edward: it enabled debug logging for a time, but that was replaced by its inverse, --cfg ndebug to disable debug loggin
[18:29:20] <mark_edward> ah, i see.
[18:29:39] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[18:29:49] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:31:57] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[18:32:26] *** Quits: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP) (Quit: brb need to try something...)
[18:32:41] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[18:32:54] *** Joins: Blub\w (wry@620605B3.71150E1A.237AE2BA.IP)
[18:33:48] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[18:34:41] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[18:34:45] *** kimundi is now known as zz_kimundi
[18:35:21] *** Quits: beifeng (Mibbit@4461887B.67084680.C7DB8B78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:35:30] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[18:37:14] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[18:39:47] <Diamond> Has anybody done any work into targeting PNaCl?
[18:40:16] *** Joins: Savago (Savago@A9945099.68394D8.18DDB669.IP)
[18:40:33] <cmr> Diamond: no
[18:42:04] *** Quits: raisin (Mibbit@moz-B234C23B.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[18:42:13] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[18:42:52] *** Quits: Savago (Savago@A9945099.68394D8.18DDB669.IP) (Ping timeout)
[18:43:54] *** Joins: jgilbert (jgilbert@moz-B37E0934.npg.sta.suddenlink.net)
[18:45:39] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[18:47:39] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[18:47:58] <eddyb> Diamond: how much more is there to it than LLVM ll? I mean, you can run rustc with --emit-llvm -S, could one create a PNaCl executable from it?
[18:48:28] *** Joins: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP)
[18:48:55] <eddyb> you might need static linking against libstd and a custom runtime
[18:49:08] <Diamond> That was my thinking as well; however I'm not too familiar with PNaCl's build process and I didn't see any docs on the wiki so I thought I'd ask.
[18:49:26] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:49:33] <Diamond> eddyb: hm
[18:50:03] <eddyb> rust-core could get you started, if you don't enable threads, I think
[18:50:08] *** Quits: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP) (Ping timeout)
[18:50:08] <Amaranth> eddyb: You'd need to port the rust runtime to the NaCl C stdlib too, no?
[18:50:14] <Amaranth> I don't think they use something standard there
[18:50:26] <Diamond> Amaranth: yikes.
[18:51:12] <eddyb> I mean, for experimentation purposes. it's not like you're going to get more than a Hello World working without some effort
[18:51:47] <Amaranth> Well even Hello World would require doing some of that porting for IO :)
[18:51:48] <eddyb> Amaranth: I would think they have some compatibility with libc, but I have to check
[18:52:08] <Amaranth> Or ffi
[18:52:48] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[18:53:04] *** Joins: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP)
[18:53:22] <eddyb> http://www.chromium.org/nativeclient/pnacl/introduction-to-portable-native-client it might be possible to use .bc files from rustc, the toolchain is similar to what I imagined
[18:54:23] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[18:54:47] *** Quits: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP) (Ping timeout)
[18:54:59] <eddyb> https://developers.google.com/native-client/dev/nacl-and-pnacl it's using newlib, so all of libc should work (minus glibc-specific implementation details)
[18:57:15] *** Joins: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP)
[18:57:37] <eddyb> Diamond: https://developers.google.com/native-client/dev/pepperc/
[18:58:17] <eddyb> now if we can run rust-bindgen or w/e on some headers... it could work
[18:59:00] <eddyb> (some of the IO in std won't make sense in that context, not sure what to do about that)
[18:59:32] *** Joins: closures999 (closures99@18CC473F.AFC0A1D6.8F599DB6.IP)
[18:59:59] *** Quits: Savago (Savago@97AA0981.43CA1A5A.18DDB669.IP) (Ping timeout)
[19:00:40] *** Quits: heftig (heftig@moz-A41AF02E.dip0.t-ipconnect.de) (Ping timeout)
[19:01:17] *** zz_kimundi is now known as kimundi
[19:02:20] <cmr> eddyb: Many, many things in pnacl are not allowed.
[19:02:29] <cmr> It's a very restricted environment
[19:03:10] *** Quits: closures999 (closures99@18CC473F.AFC0A1D6.8F599DB6.IP) (Quit: Leaving...)
[19:03:43] *** Quits: Kruppe (user@moz-C9026991.net.uwaterloo.ca) (Ping timeout)
[19:05:55] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[19:08:40] *** Joins: heftig (heftig@moz-B229A8FE.dip0.t-ipconnect.de)
[19:08:50] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[19:13:48] *** Quits: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: leaving)
[19:14:38] <Diamond> A simple "hello, world" will be awkward and likely impossible achievement, owing to the lack of a console.
[19:17:14] *** Joins: Tommi (Mibbit@moz-933A7AA1.elisa-laajakaista.fi)
[19:18:59] <Tommi> I tried to start a couple of new threads on the rust-dev mailing list, but nothing happened. Should I try to send the emails again or what?
[19:20:19] <o11c> Tommi: most mailing lists are moderated ...
[19:20:50] *** Quits: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net) (Quit: bholley)
[19:21:32] <Tommi> I started a couple threads earlier and those emails went through right away
[19:23:43] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[19:24:08] *** Quits: kellogh (timkellogg@moz-602CE33D.midco.net) (Quit: kellogh)
[19:28:44] *** Quits: notmatt (notmatt@118CCA77.D1B89392.602E4FC1.IP) (Client exited)
[19:34:13] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[19:37:46] *** pmoore is now known as pmoore|away
[19:39:40] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Client exited)
[19:39:45] *** Joins: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net)
[19:41:40] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[19:42:13] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[19:43:37] *** Joins: notmatt (notmatt@118CCA77.D1B89392.602E4FC1.IP)
[19:43:54] *** Joins: jordyd (jordyd@moz-E10C5047.seg54.ucf.edu)
[19:44:06] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[19:45:52] *** Joins: mib_ufbqgp (Mibbit@moz-B234C23B.rev.numericable.fr)
[19:46:06] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[19:46:54] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[19:47:16] *** Joins: Janko (chatzilla@D9AEFC3E.9E37BD61.9C3D12F2.IP)
[19:49:37] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[19:51:45] *** Joins: \n (uid15310@moz-31ABA2C0.irccloud.com)
[19:53:03] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Quit: Leaving.)
[19:53:26] *** Quits: jgilbert (jgilbert@moz-B37E0934.npg.sta.suddenlink.net) (Ping timeout)
[19:54:02] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[19:55:20] *** Joins: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[19:55:52] <ktt3ja> what's the difference between #[start] and #[main]?
[19:56:10] <bstrie> ktt3ja: main is where the program starts. start is where the program *really* starts
[19:56:17] <eddyb> hehe
[19:56:21] <ktt3ja> ...
[19:56:31] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[19:56:46] <ktt3ja> what if a program has both #[start] and #[main]?
[19:57:33] <myname> what is the definition of REALLY starting?
[19:57:41] <bstrie> ktt3ja: iirc the distinction between "main" and "start" is also present in C and C++. the idea is that "main" is where user code generally starts, whereas "start" is reserved for the runtime to start setting up its environment that allows the user code to run
[19:57:54] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[19:58:04] <bstrie> but I could be glossing over important details
[19:58:08] <bstrie> <-- not a systems programmer
[19:58:43] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[19:58:58] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[19:59:50] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:59:50] *** ChanServ sets mode: +o tjc
[20:00:28] <ktt3ja> hmm, I guess start is where the program *really* starts after all
[20:00:42] <ktt3ja> when there's both, only the #[start] runs
[20:01:03] <bstrie> ktt3ja: generally start will call main
[20:01:17] <bstrie> like, manually
[20:01:21] <o11c> in C++, _start is before global constructors
[20:01:33] <o11c> it calls the ctor array and then calls main
[20:01:36] *** Quits: Janko (chatzilla@D9AEFC3E.9E37BD61.9C3D12F2.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 28.0a1/20131113144022])
[20:01:39] <o11c> plus a bunch of dlopen magic
[20:02:01] <o11c> actually, IIRC there's more than one _start
[20:02:08] <o11c> or something
[20:02:09] <cmr> main is passed to the start language item
[20:02:15] <cmr> I don't remember what #[start] does
[20:02:23] <cmr> Even though I knew the other day!
[20:02:33] *** Quits: obi_wan (Mibbit@19B4F7A4.716DD980.59D37A3.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:02:37] <cmr> ktt3ja: check your logs from the past few days for #rust-internals, we did talk about it
[20:03:02] <Luqman> cmr: #[start] lets you replace the entry point
[20:03:03] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Quit: alan)
[20:03:04] *** Joins: Janko (chatzilla@D9AEFC3E.9E37BD61.9C3D12F2.IP)
[20:03:31] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:03:42] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[20:03:43] <cmr> Luqman: which entry point? of the entire thing? ie, #[lang="start"] never comes into play?
[20:03:54] <bstrie> ktt3ja: in rust, the only use for #[start] that I've ever heard of is people who want to start the runtime manually
[20:04:53] <Luqman> if you use #[start] it doesn't use the start lang item
[20:05:01] <cmr> Ok
[20:05:04] <bstrie> o11c: I think _start is implementation-specific, though?
[20:05:19] <cmr> bstrie: _start is a detail of the crt
[20:05:34] <ktt3ja> cmr: I guess "the main function is passed as a ~fn() to EntryStart ...iirc" is what you meant?
[20:05:35] <o11c> bstrie: I'm only really talking about linux
[20:05:51] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[20:05:57] <bstrie> right, I mean that _start isn't part of the C++ language spec
[20:05:58] *** Joins: carter (carter@moz-BDFE46F6.nyc.biz.rr.com)
[20:05:59] <bstrie> afaik
[20:06:26] <jeaye> The rust-dev "daily" digest seems a lot more than daily.
[20:06:47] <cmr> jeaye: it depends on activity iirc.
[20:06:55] <bstrie> jeaye: click _here_ to subscribe the #rust minutely digest
[20:06:57] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Connection reset by peer)
[20:06:57] <cmr> jeaye: did you see my ncurses-rs PR?
[20:07:09] <jeaye> cmr: Nope!
[20:07:10] <bstrie> jeaye: thank you for subscribing to the #rust minutely digest
[20:07:17] <jeaye> bstrie: Exactly.
[20:07:34] <bstrie> jeaye: < cmr> jeaye: did you see my ncurses-rs PR? < jeaye> cmr: Nope!
[20:07:40] <cmr> bstrie: please don't ;_;
[20:07:49] <bstrie> jeaye: this has been the rust minutely digest. click _here_ to unsubscribe
[20:08:06] * jeaye spams clicks _here_
[20:08:08] <bstrie> jeaye: please log in to unsubscribe from the rust minutely digest
[20:08:16] <jeaye> fuck
[20:08:23] <bstrie> jeaye: < cmr> bstrie: please don't ;_; < jeaye> fuck
[20:08:30] <cmr> jeaye: I suggest shooting bstrie
[20:08:49] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[20:08:53] <jeaye> cmr: Merged.
[20:08:56] <jeaye> Thanks :D
[20:09:04] * cmr can't stand "Build: Failing" buttons
[20:09:10] <jeaye> haha
[20:09:23] <Luqman> when you have fn main()/#[main] it goes: actual entry point -> start lang item -> rust's main
[20:09:29] <jeaye> I've been side tracked with another project.
[20:09:29] <bstrie> we need a "Build: None Of Your Business, Thank You Very Much" button
[20:09:39] * jeaye has too many projects. >.<
[20:09:46] <Luqman> when you have #[start] it gors: actual entry point -> your fn marked #[start]
[20:09:46] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Client exited)
[20:10:03] <cmr> Luqman: Ah, so it's not the *actual* ELF entry point?
[20:10:06] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[20:10:09] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[20:10:48] <Luqman> cmr: no, the actual "main" is empty and just calls whatever
[20:10:56] <Luqman> well not empty, just a single call
[20:11:21] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:11:25] <eddyb> https://mail.mozilla.org/pipermail/rust-dev/2013-November/006654.html what's with this? I thought rust used custom paths...
[20:11:33] *** Parts: \n (uid15310@moz-31ABA2C0.irccloud.com) ()
[20:11:34] <cmr> eddyb: hm? no
[20:11:51] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Ping timeout)
[20:11:58] *** Quits: penguin_dan (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[20:11:58] *** Quits: Tommi (Mibbit@moz-933A7AA1.elisa-laajakaista.fi) (Quit: http://www.mibbit.com ajax IRC Client)
[20:13:06] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[20:13:27] *** Quits: jordyd (jordyd@moz-E10C5047.seg54.ucf.edu) (Ping timeout)
[20:14:32] *** Joins: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com)
[20:15:01] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[20:15:14] <eddyb> it's /usr/lib/rustc/x86_64-unknown-linux-gnu/lib/ for me - maybe it's just the distro rust package - which I've packaged, so I should know (and I should update the damn thing) >_>
[20:15:33] <cmr> that exists too
[20:16:23] <eddyb> ooh, symbol links, I see
[20:16:40] <eddyb> *symbolic
[20:18:39] <mark_edward> I'm having trouble with my Bzip2 port here: https://github.com/MarkJr94/bzip2rs decompression almost works, but I get a lot of zeroes tacked on the end, and i can't figure out why
[20:21:09] *** Joins: kellogh (timkellogg@moz-602CE33D.midco.net)
[20:21:10] *** Joins: mikezaby (mikezaby@moz-AA896205.home.otenet.gr)
[20:24:35] *** Joins: themgt (themgt@moz-83F07CDA.cm.vtr.net)
[20:24:35] *** Quits: themgt (themgt@moz-83F07CDA.cm.vtr.net) (Client exited)
[20:24:48] *** Quits: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP) (Ping timeout)
[20:25:03] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[20:25:52] *** Joins: [squiddy] (squiddy@moz-67D2F7C0.dynamic.cablesurf.de)
[20:27:07] *** Joins: jviereck (Adium@moz-CF8216D6.dip0.t-ipconnect.de)
[20:28:23] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[20:29:02] *** Quits: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net) (Quit: Leaving.)
[20:30:40] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[20:31:34] *** Joins: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP)
[20:31:40] *** Quits: josedonizetti (josedonize@DF22210B.35D9DDB.8EF76F75.IP) (Quit: josedonizetti)
[20:32:20] *** Quits: Palmik (palmik@moz-DEC2AB.pks.muni.cz) (Ping timeout)
[20:33:56] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[20:34:03] *** Joins: Palmik (palmik@moz-DEC2AB.pks.muni.cz)
[20:34:30] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[20:38:44] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Ping timeout)
[20:38:47] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Connection reset by peer)
[20:38:51] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[20:38:58] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[20:39:20] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[20:40:13] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:41:04] *** Quits: Jackneill (Jackneill@moz-A57EE2EE.pool.digikabel.hu) (Input/output error)
[20:44:11] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[20:45:33] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[20:45:33] *** ChanServ sets mode: +ao dherman dherman
[20:46:06] *** Joins: jordyd (jordyd@moz-BABE1376.seg135.ucf.edu)
[20:55:32] <ktt3ja> what would the ast::item with the ident "__extensions__" be?
[20:55:35] <ktt3ja> an impl?
[20:58:24] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Quit: Leaving...)
[21:01:48] *** Quits: exobit_ (textual@moz-E06F46F0.corp.bitshelter.com) (Quit: )
[21:04:19] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Ping timeout)
[21:06:50] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[21:08:37] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[21:13:14] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[21:15:32] *** Quits: Palmik (palmik@moz-DEC2AB.pks.muni.cz) (Quit: Lost terminal)
[21:18:02] <acrichto> ktt3ja: yes, or an extern block
[21:18:12] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[21:18:14] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[21:18:28] *** Quits: jordyd (jordyd@moz-BABE1376.seg135.ucf.edu) (Ping timeout)
[21:21:06] <ktt3ja> acrichto: does ty::ctxt.impls map the DefId of a struct to its impl? If not, is there anything that does that?
[21:21:27] <acrichto> structs don't necessarily have an impl
[21:21:34] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Ping timeout)
[21:21:39] <acrichto> but there should be a table from a DefId of a type to all known impls
[21:21:52] *** Quits: jviereck (Adium@moz-CF8216D6.dip0.t-ipconnect.de) (Quit: Leaving.)
[21:22:40] <ktt3ja> inherent_impls?
[21:22:47] <ktt3ja> "    // Maps a def_id of a type to a list of its inherent impls.     // Contains implementations of methods that are inherent to a type.     // Methods in these implementations don't need to be exported."
[21:22:59] *** Joins: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[21:23:12] <acrichto> hm, maybe, I'm not too up to date on the lingo
[21:23:31] <acrichto> it sounds like that's right though
[21:23:33] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[21:23:47] <acrichto> nmatsakis would probably know for sure
[21:24:53] <nmatsakis> I'm not actually sure, those data structures are kind of ad hoc. I'll have to look around.
[21:24:59] <nmatsakis> ktt3ja: what are you trying to do ?
[21:27:58] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:27:58] *** ChanServ sets mode: +o tjc
[21:28:34] *** Quits: mib_ufbqgp (Mibbit@moz-B234C23B.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[21:31:06] <ktt3ja> nmatsakis: I'm adding a dead-code warning pass. What I want to do is that when I see a struct being used in an expression, I would mark its definition and impl as "live". I can do the former with a def_map, but I don't know how to do the latter.
[21:31:43] <nmatsakis> ktt3ja: it seems like too much anyway, 
[21:31:52] <nmatsakis> ktt3ja: I feel like the "deadness" should be on a per method basis
[21:34:50] *** Quits: fabiand (fabiand@moz-7AF03B69.adsl.alicedsl.de) (Quit: Verlassend)
[21:35:15] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[21:36:30] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[21:36:49] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[21:42:00] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[21:42:19] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[21:43:05] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[21:47:02] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[21:48:51] *** Joins: xexio (xexio@moz-4196542D.dyn.user.ono.com)
[21:49:07] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[21:53:27] *** Quits: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net) (Ping timeout)
[21:54:20] *** Joins: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net)
[21:54:38] <tiffany> howcome wildcard imports are feature gated?
[21:56:49] <canhtak> Hi rust devs, I have a little question.
[21:56:58] <canhtak> I bind a c library and call c function in default traits method. I link my c library on my rust library with #[link_args="-lmy_c_lib »] extern{}.
[21:57:10] <canhtak> Everything compile fine, but when i use the rust lib from a rust code, the symbols called in the traits default methods are not found and i must re-link with #[link_args="-lmy_c_lib »] extern{} in the code which use the lib.
[21:57:14] <canhtak> Is it a normal behavior?
[21:57:15] *** Joins: obi_wan (Mibbit@moz-942BA8A.ga.at.cox.net)
[21:58:11] <aatch> canhtak, I have a feeling that there was a change recently that caused that not to work.
[21:58:38] <obi_wan> Can I fill in a type parameter of a function with a trait instead of a value type to gain dynamic dispatch?
[21:58:53] <tiffany> yeah, obi_wan
[21:58:55] *** Joins: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net)
[21:59:04] <tiffany> traits are unsized types though, so they have to be ~, @, or &
[21:59:07] <bstrie> tiffany: news to me
[21:59:24] <bstrie> tiffany: pcwalton would probably know why, at least
[21:59:26] <canhtak> aatch: hum ok, so it's a temporary issue?
[21:59:27] <aatch> You have to use trait objects to get dynamic dispatch.
[21:59:46] <tikue> obi_wan: you can use trait objects but not unboxed traits because the size needs to be known
[21:59:52] <canhtak> aatch: no needs to report it?
[21:59:56] <aatch> canhtak, not sure. There was a change to the way link arguments are handled.
[22:00:02] *** Joins: eddyb9 (eddy@336E3A7F.D51DAF03.FB866788.IP)
[22:00:09] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[22:00:21] <aatch> canhtak, there's an issue open about the linking model already, so probably not worth it.
[22:00:35] <obi_wan> tikue: Just curious... why does the size need to be known?
[22:00:48] *** Quits: Ms2ger (Ms2ger@AB9469A5.3CF91143.187A1082.IP) (Quit: nn)
[22:00:56] <canhtak> aatch: ok thanks!
[22:01:16] <aatch> I imagine the issue is because the methods are inlined into the exe
[22:01:22] *** Quits: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net) (Ping timeout)
[22:01:49] <aatch> obi_wan, what exactly are you trying to do?
[22:02:03] <o11c> canhtak: might be related to --as-needed? Are you actually *using* the C library from the rust library?
[22:02:11] <aatch> I have a feeling you and tikue may be talking past each other.
[22:02:23] *** Joins: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net)
[22:02:24] <tikue> obi_wan: so that the compiler can allocate the right amount of space for the function calls. I'm afraid I can't speak very intelligently on the issue. But if you have some trait Foo, you can have an argument type ~Foo for instance
[22:02:59] <aatch> obi_wan, one thing though, traits aren't types.
[22:03:20] <aatch> The closest analogy I can think of is typeclasses
[22:03:28] <tikue> so if you have some function foo<F: Foo>(f: F) you could instead go with dynamic dispatch like this: `fn foo(f: ~Foo)`
[22:03:28] <canhtak> o11c: Yes i use the C library from a rust library
[22:03:39] <Jesse> they will be types with DST, right?
[22:03:51] <canhtak> o11c: what do you mean about --as-needed? don't see this option in rustc?
[22:03:56] <eddyb9> Jesse: DST is confusingly named
[22:04:22] <obi_wan> tikue: But why can't the compiler adjust the amount of space a function call needs at run time?
[22:04:22] <obi_wan> Sorry I mean generate code that does it...
[22:04:22] <obi_wan> Is it too much overhead?
[22:04:39] <obi_wan> So then it's almost always better to write a function like `fn draw_all<T: Drawable>(shapes: ~[T])` instead of `fn draw_all(shapes: ~[&Drawable])`?
[22:04:41] <o11c> canhtak: I'm not familiar with rust, but in C land, --as-needed is a linker flag that sometimes leads to libraries not being linked
[22:04:55] <eddyb9> Jesse: we already have DSTs, they're just not properly defined as such, AFAIK
[22:04:57] <obi_wan> (my last statement is unrelated to fixed size function call)
[22:05:03] <aatch> obi_wan, kinda.
[22:05:09] <aatch> Depends on your situation.
[22:05:31] <obi_wan> aatch: But with the first signature the user gets to choose whether they want vtable or not
[22:05:37] <obi_wan> aatch: The second one forces vtable
[22:05:40] <tikue> obi_wan: well consider that in other languages like java you don't even have the choice because everything is boxed and it's always dynamic dispatch
[22:05:45] <aatch> in the first version, every element in the array is `T`, bounded by Drawable.
[22:05:48] <tikue> like if you have an interface as an argument
[22:06:02] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[22:06:31] <obi_wan> aatch: But tiffany said I could just pass the trait at T when I call the function...
[22:06:31] <eddyb9> everything is a primitive or an Object in Java
[22:06:33] <aatch> in the second, the vector contains trait objects.
[22:06:48] <aatch> obi_wan, you can't.
[22:07:01] <obi_wan> aatch: Oh... so the first one is static dispatch only
[22:07:02] <aatch> she likely misunderstood you
[22:07:07] <canhtak> o11c: hum ok don't know this flag. But here it doesn't seem to be the problem, it seem's to be an issue with traits default method maybe.
[22:07:14] *** kimundi is now known as zz_kimundi
[22:07:25] <aatch> obi_wan, they're both statically dispatched as function calls.
[22:07:40] <aatch> The only time we have dynamic dispatch is method calls on trait objects.
[22:07:54] <o11c> canhtak: if I understand, you have rustmain links to rustlib links to clib ... if you run 'ldd' on the rustlib is it actually linked?
[22:08:02] *** Quits: lkuper (lkuper@moz-2820171B.hfc.comcastbusiness.net) (Ping timeout)
[22:08:07] *** Quits: edorian (Mibbit@moz-8DA69D93.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[22:08:09] <o11c> oh!
[22:08:10] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:08:20] <o11c> this might be the *other* linker issue ... but still run ldd first please
[22:08:35] <obi_wan> aatch: But you have to pass trait objects to the second one
[22:09:05] <obi_wan> So any call to that parameter will be dynamically dispatched
[22:09:13] <aatch> obi_wan, correct, and any operations on the contents via methods will result in dynamic dispatch.
[22:09:29] <tikue> obi_wan: i think nmatsakis wants to make it so that ~Object would coerce to ~Foo in dynamic dispatch situations (someone correct me if I'm incorrect)
[22:09:52] <aatch> However, I could pass a trait object that satisifies `T:Drawable` to the first one and still get dynamic dispatch.
[22:10:26] <obi_wan> aatch: Wait what? I thought you said you couldn't do that
[22:10:43] <aatch> obi_wan, ok, there's several things going on here.
[22:11:28] <canhtak> o11c: I already have do this, and its ilinked
[22:11:42] <obi_wan> tikue: What do you mean coerce?
[22:11:50] <canhtak> o11c: that's why i think it's an issue
[22:11:57] <tikue> obi_wan: you wouldn't have to cast it explicitly
[22:12:11] <obi_wan> tikue: But I thought the whole point of Rust was explicitness
[22:12:25] <aatch> There's the type parameter `T`, and the function parameter `shapes`. When you say "fill in a type parameter of a function", which parameter do you mean?
[22:12:28] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[22:12:58] <aatch> Because I interpreted it as doing draw_all::<MyTrait>(...), which isn't possible.
[22:13:21] <tikue> obi_wan: if Object implements trait Foo, I think the cost to explicitness is quite low to allow passing ~Object as an argument to `fn foo(f: ~Foo)`
[22:13:39] <aatch> (At the moment, DSTs are intended to allow it. With some limitations)
[22:15:07] <obi_wan> aatch: Yes, that's what I meant. Oh so I think I see what you meant before. You can however fill T with &MyTrait to gain dynamic dispatch on T?
[22:15:32] <aatch> obi_wan, correct.
[22:15:46] <obi_wan> aatch: So I just wasn't filling in my types correctly, basically?
[22:16:05] <aatch> probably.
[22:16:20] <aatch> Normally you want to use generic functions over trait objects though.
[22:16:51] <obi_wan> aatch: So then it's almost always better to write a function like `fn draw_all<T: Drawable>(shapes: ~[T])` instead of `fn draw_all(shapes: ~[&Drawable])`? Because the former can be used like the later, but the later cannot be used like the former...?
[22:17:11] <aatch> obi_wan, almost always, yes.
[22:18:01] <obi_wan> aatch: And finally I have the answer to the question I came in with :D thanks
[22:18:22] <tikue> I actually don't know when you'd want to use the latter...
[22:18:29] <aatch> obi_wan, no problem. We got there in the end.
[22:18:56] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[22:19:04] <obi_wan> tikue: Ah, so we don't lose and explicitness by dropping explicit casting because we always know that function expects a trait object?
[22:19:07] <aatch> tikue, in cases where it's not possible to write `impl Drawable for &Drawable`
[22:19:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[22:19:48] <aatch> I admit that it's not a likely case though.
[22:20:12] <tikue> aatch: ah yes, that'd make sense :) though I haven't seen any examples of that personally
[22:20:53] <aatch> tikue, any trait that uses the Self type tends to fit.
[22:21:36] <tikue> obi_wan: I think that's the argument one would make in allowing the coercion in that specific circumstance. presumably that'd also allow you to pass ~Object to fn foo<F: Foo>(f: F) as long as ~Object implements Foo
[22:21:59] <tikue> aatch: oh yeah, good point
[22:22:34] <obi_wan> aatch: What the heck is impl Drawable for &Drawable? 
[22:23:03] <aatch> This is also why trait objects don't automatically satisfy the trait they represent.
[22:23:15] <tikue> obi_wan: i think it'd actually be like this: `impl<D: Drawable> Drawable for &D`
[22:23:28] <aatch> tikue, nope, I meant the first one
[22:23:31] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[22:23:49] <aatch> `&Drawable` is a type. It's a trait object.
[22:24:04] <obi_wan> aatch: but... but... that's dumb!
[22:24:26] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[22:24:32] <aatch> obi_wan, not really. As I said, trait objects don't satisfy themselves by default, so if you want that, you have to do it yourself.
[22:24:46] <heftig> fn draw_all<T: Drawable>(shapes: ~[T]) can only be used if T are all the same type
[22:25:07] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[22:25:19] <heftig> fn draw_all(shapes: ~[&Drawable]) can be used with a mixed array consisting of objects implementing Drawable
[22:25:24] <tikue> heftig: but it works in the same situations because you can just pass in ~[&Drawable] (unless the situation aatch mention is applicable)
[22:25:32] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[22:25:46] <heftig> does it?
[22:26:00] <heftig> wouldn't you need to define it with ~[&T], then?
[22:26:19] <aatch> heftig, if &Drawable implements Drawable, then it satisfies the bound on T
[22:26:22] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:26:39] <heftig> okay.
[22:27:01] <aatch> If you substitute it, then draw_all<T:Drawable>(shapes: ~[T]), becomes draw_all<>(shapes: ~[&Drawable])
[22:27:02] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:27:07] <tiffany> I see that rust doesn't like when multiple versions are installed
[22:27:19] <tiffany> I accidentally had both the arch repo package and my own git buid installed
[22:28:40] <obi_wan> aatch: So if I want to define my function like `fn draw_all<T: Drawable>(shapes: ~[T])` instead of `fn draw_all(shapes: ~[&Drawable])` my users will have to define an impl Drawable for &Drawable?
[22:28:57] <obi_wan> ...if they want to use a trait object?
[22:28:58] *** Joins: jviereck (Adium@moz-CF8216D6.dip0.t-ipconnect.de)
[22:29:19] <aatch> obi_wan, well you can provide the implementation of Drawable yourself.
[22:29:28] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[22:29:30] <sp3d> I think for coherence impl Drawable for &Drawable has to be in the original lib, if it's possible to write that impl at all
[22:30:19] <aatch> It's slightly confusing, but while `Drawable` is not a type, `~Drawable`, `&Drawable` and `&mut Drawable` are all types.
[22:31:13] <aatch> In the same way `~str`, `&str` and `&mut str` are all types, but just `str` is not.
[22:31:45] *** Quits: [squiddy] (squiddy@moz-67D2F7C0.dynamic.cablesurf.de) (Quit: Leaving)
[22:31:46] <obi_wan> aatch: Yea that is confusing
[22:32:07] *** Joins: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP)
[22:32:07] *** ChanServ sets mode: +o tjc
[22:32:08] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:32:41] <obi_wan> aatch: But in that case, `~str`, `&str` and `&mut str` satisfy `str` trait, correct? Unlike &Drawable not satisfying Drawable?
[22:32:44] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:33:07] <aatch> obi_wan, Dynamically Sized Types are intended to help. The idea being that it makes `Trait` a type, but you can only *pass* it as a pointer
[22:33:19] <aatch> obi_wan, not really, because `str` isn't a trait either.
[22:33:49] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[22:34:21] <obi_wan> aatch: Oh, so DST mean dynamically sized type?
[22:34:23] <obi_wan> I didn't know that
[22:34:31] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[22:34:47] <aatch> It also unifies vectors, strings and trait objects in a way that makes them behave more like normal types.
[22:34:54] <obi_wan> aatch: So str is not part of the type system?
[22:35:00] <aatch> obi_wan, correct.
[22:35:25] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[22:36:01] <aatch> The reason being that we don't know the actual size of the data at compile time, so it can only be use via indirection.
[22:36:28] <obi_wan> aatch: Will these DSTs ever become part of the type system?
[22:36:29] <aatch> used*
[22:37:04] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[22:37:11] *** Quits: mikezaby (mikezaby@moz-AA896205.home.otenet.gr) (Input/output error)
[22:37:23] <aatch> obi_wan, that's the plan. The major snag is the "proper" way to implement it would require almost every generic function to add a `Sized` bound to its types.
[22:37:26] *** flaper87 is now known as flaper87|afk
[22:37:39] <mimcpher> c/cb
[22:37:45] <mimcpher> Ooops.
[22:37:55] *** Joins: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[22:38:23] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[22:38:26] <aatch> Since bounds allow you to do more, and there are operations on sized types that you can't do on unsized types.
[22:38:32] <aatch> Dereferencing for example.
[22:40:30] *** Joins: lkuper (lkuper@3A916FC1.14CD977C.51B6877.IP)
[22:40:51] <obi_wan> aatch: unsized is DST right?
[22:40:56] <aatch> obi_wan, correct.
[22:41:20] <aatch> So we'll get DSTs at some point, they just may be a little "hacky"
[22:41:59] *** Quits: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP) (Ping timeout)
[22:42:10] <obi_wan> aatch: Why can't you dereference unsized types?
[22:42:53] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[22:42:53] <obi_wan> aatch: As long as its an rvalue what's the problem?
[22:42:57] *** Joins: Cork (Cork@moz-352B7E7B.a370.priv.bahnhof.se)
[22:43:25] <aatch> obi_wan, because you need to know how big it is. If I have something like: `let a : MyType = *p`, then I need to know the size of MyType in order to reserve enough stack for it.
[22:43:43] <aatch> I guess I meant dereference-and-copy.
[22:44:01] <aatch> Since you can obviously still follow the pointer to get at the other side.
[22:44:12] <obi_wan> aatch: okay yea because the Rust tutorial says that method calls on boxed values automatically dereference the value
[22:44:41] <obi_wan> aatch: But then assignment would be a part of the type system too?
[22:45:08] <aatch> obi_wan, it already is.
[22:45:28] *** Joins: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP)
[22:45:28] *** ChanServ sets mode: +o tjc
[22:45:35] <aatch> Rust has linear types, so assignment interacts with the type system already.
[22:45:51] <aatch> specifically related to whether or not a type is implicitly copyable.
[22:46:12] <aatch> `let a = b` doesn't work in all cases.
[22:46:16] *** Quits: jviereck (Adium@moz-CF8216D6.dip0.t-ipconnect.de) (Quit: Leaving.)
[22:46:55] <aatch> (well it does, but it can cause `b` to be unusable)
[22:46:58] <obi_wan> aatch: linear types vs ...?
[22:47:04] <obi_wan> aatch: Right, move
[22:47:59] <obi_wan> aatch: Will moving DSTs to the type system cause it to be bloated like C++?
[22:48:32] <aatch> I don't understand your meaning.
[22:48:54] <obi_wan> aatch: nvm I'm a noob
[22:50:10] <obi_wan> I just hate learning about a language only to find out every other concept is implicit... it leads to so many gotchyas and frustration... like this whole trait object thing. The tutorial refers to trait objects as "objects", but then it also refers to structs as objects, too. It's just confusing
[22:50:29] *** Quits: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP) (Ping timeout)
[22:51:30] <obi_wan> aatch: what sort of "hack" is in mind for the whole "sized" trait thing?
[22:52:02] <aatch> obi_wan, I have no idea. I'd imagine that it'd be something along the lines of inferring the bound.
[22:52:14] *** Joins: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP)
[22:52:14] *** ChanServ sets mode: +o tjc
[22:52:20] *** Joins: lastdev (lastdev@moz-5A47DD8E.dyn.user.ono.com)
[22:52:23] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[22:52:33] <aatch> Which has the problem that it suddenly becomes unobvious that the bound exists
[22:52:38] <aatch> until you compile the code.
[22:58:07] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:58:43] *** Joins: Liothen (liothen@moz-2D076547.spkn.qwest.net)
[22:59:16] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[22:59:21] <obi_wan> In rust, does the term object always refer to trait object?
[22:59:55] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[23:00:39] <aatch> obi_wan, probably not.
[23:00:52] *** Quits: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo_)
[23:00:58] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[23:01:37] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[23:02:01] <aatch> We don't (as far as I am aware) have a 100% consistent terminology yet, but I "object" used mostly with the C definition.
[23:02:21] <aatch> So it's just "a block of memory"
[23:03:08] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Quit: ...)
[23:04:18] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[23:04:34] <obi_wan> I just hope rust stays simple and explicit... as a student I get so confused by the pages and pages of the C++ spec and all the return-by-ref return-by-val and rvo and nrvo and when it works and when it doesn't and reference wrappers and blah blah blah it hurts
[23:05:52] <mimcpher> Well, c++ is a huge langauge so it's hard for them to document all the cases
[23:06:28] <tjc> which is a great language to make a language less huge :-) ease of specifying its formal semantics
[23:06:32] <tjc> er, a great reason to, I mean
[23:07:20] <obi_wan> mimcpher: Yea but it's especially hard for a student to know what's going on underneath.
[23:07:37] <obi_wan> since many many things are implicit
[23:07:44] <mimcpher> Of course, though there are subsets of c++ that are easier to understand
[23:07:54] <obi_wan> mimcpher: There are subsets of C++?
[23:08:04] <tjc> obi_wan: I suspect that's going to be true for any widely used production language :-)
[23:08:12] <mimcpher> obi_wan: not strictly defined, but in practise
[23:08:20] <tjc> obi_wan: generally, it's said that no one programs in C++; they program in a subset of C++ that they know. the problem is the subsets are all different.
[23:08:42] <aatch> The core idea in Rust, semantically, is that code assumes as little as possible. We move-by-default because everything is movable, unless it's obvious that we can do an implict copy.
[23:08:47] *** Joins: nejucomo (Adium@moz-F2940C39.hsd1.ca.comcast.net)
[23:09:00] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[23:09:15] <tikue> aatch: i thought shallow copies are the default, and moves only happen for objects with destructors?
[23:09:36] <tikue> which is the same thing but invalidates the previous copy
[23:09:48] <aatch> tikue, yes.
[23:10:06] <aatch> But in cases where we don't know if a type has a destructor, we move
[23:10:11] <obi_wan> But the compiler generates destructors right?
[23:10:17] <obi_wan> Unless you define your own
[23:10:48] <tikue> obi_wan: no i don't think the compiler does generate destructors
[23:10:48] <obi_wan> oh nvm
[23:11:19] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[23:12:03] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[23:12:09] <tikue> aatch: i think it'd be nice to have a kind for that because right now you have to explicitly clone() parameterized types
[23:12:25] <aatch> tikue, we used to, it was dropped.
[23:13:04] <aatch> There used to be a Copy bound, however it turned out that good practice was to use Clone anyway
[23:13:21] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[23:13:29] <tikue> yeah i remember that
[23:13:35] <tikue> still not sure i agree :O)
[23:14:07] <tikue> it creates an unintuitive dichotomy between generic code and the rest
[23:14:55] <tjc> tikue: arguable that dichotomy, while uncomfortable, is a necessary part of Rust's explicitness...
[23:15:07] <tjc> Rust implements generic functions in a fundamentally different way, and doesn't attempt to hide it (all that much)
[23:15:24] <tjc> the alternative would be to use a uniform representation for polymorphic values like Haskell and ML do, but we thought from early on that the cost of that would be too high
[23:16:01] <aatch> The only rustic way to remove the dichotomy would be to make non-generic code use clone.
[23:16:04] *** nrc is now known as nrc|holiday
[23:17:03] <tikue> aatch: that's the no true scottsman fallacy imo :)
[23:17:14] <tikue> i don't feel strongly about it though
[23:17:47] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Input/output error)
[23:18:36] <aatch> How is it the no true scotsman here? I mean, I guess I am assuming what 'rustic' is, but I don't think I'm over-reaching by saying that 'rustic' code is explicit rather than implicit.
[23:19:04] <tikue> aatch: back when copy was around that was the rustic way, though, and rust certainly does implicit copies already
[23:19:40] *** Joins: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:20:20] <aatch> tikue, I meant that removing the dichotomy would be towards removing the implicit behaviour, rather than adding more.
[23:20:21] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[23:20:21] <tikue> the only way to know if something is going to move or implicitly copy is by checking if there is a destructor on the struct or any of the fields
[23:20:36] <tikue> so one could argue that it's already to implicit i suppose
[23:20:39] <tikue> too*
[23:21:14] <tikue> the thing is that clone and shallow copy are different, so i'm not sure how that'd work
[23:22:09] <aatch> tikue, hence why implicit copies only happen when a clone and a shallow copy are identical anyway.
[23:22:22] <tikue> ah good point heh
[23:22:30] *** Quits: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net) (Ping timeout)
[23:22:46] <obi_wan> What's the point of the const trait
[23:22:50] *** Quits: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[23:22:56] <obi_wan> Aren't values immutable by default?
[23:23:09] <aatch> I thought we got rid of the Const trait?
[23:23:10] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:23:22] <aatch> Or more accurately, renamed it to Freeze
[23:23:32] <obi_wan> aatch: Oh I see
[23:23:38] <obi_wan> Google still links to 0.7
[23:23:50] <aatch> Ah, well 0.8 is most recent version.
[23:23:52] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[23:24:21] *** Joins: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:24:41] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[23:24:44] *** Quits: ianj (ianjneu@moz-7140CF01.ccs.neu.edu) (Quit: leaving)
[23:24:56] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[23:25:05] <obi_wan> Oh I see @mut doesn't inherit the mutability of its parent
[23:26:02] *** jorendorff_away is now known as jorendorff
[23:26:27] <aatch> obi_wan, yeah, @mut should be avoided though.
[23:26:50] <aatch> it and `@` are both feature-gated at the moment.
[23:26:54] <obi_wan> Are parameters mutable?
[23:27:08] <aatch> New code should be using Rc<T> and RcMut<T>
[23:27:17] <obi_wan> ok
[23:27:25] *** Quits: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[23:27:27] <obi_wan> implemented in type system, eh?
[23:27:29] <aatch> obi_wan, as in function params? If you put 'mut' in the pattern.
[23:27:52] <aatch> Rc<T> and RcMut<T> are actually library types.
[23:27:56] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:27:59] *** Quits: Kxepal (Miranda@moz-3A55D1EB.pppoe.mtu-net.ru) (Quit: Kxepal)
[23:28:09] *** Joins: Kxepal (Miranda@moz-3A55D1EB.pppoe.mtu-net.ru)
[23:28:20] *** Quits: lastdev (lastdev@moz-5A47DD8E.dyn.user.ono.com) (Quit: )
[23:29:36] *** Quits: xexio (xexio@moz-4196542D.dyn.user.ono.com) (Quit: Konversation terminated!)
[23:30:13] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[23:30:45] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Connection reset by peer)
[23:30:57] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[23:31:26] *** Joins: jordyd (jordyd@moz-DE919F94.seg52.ucf.edu)
[23:31:30] <obi_wan> why does static have a backtick?
[23:31:48] <aatch> because it's a lifetime, and it's a single-quote.
[23:31:56] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Connection reset by peer)
[23:32:06] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[23:32:10] *** Joins: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP)
[23:33:59] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Ping timeout)
[23:35:09] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[23:35:38] *** Quits: infynyxx (infynyxx@91368DCE.F62BA7BC.26446627.IP) (Quit: Leaving...)
[23:35:58] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[23:37:13] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[23:38:06] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[23:38:55] *** Quits: tjc (tjc@8977BF93.FD5C31A1.284344F5.IP) (Quit: zzzzzzzzzz)
[23:41:18] *** Quits: carter (carter@moz-BDFE46F6.nyc.biz.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:41:19] <obi_wan> If rust copies implicitly isn't that bad? What if the user is unaware that the copy generated is only a shallow clone?
[23:42:36] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[23:42:41] <obi_wan> I guess that's why intrinsically copyable things don't have shared boxes?
[23:42:58] <cmr> obi_wan: We have implicit copies to the extent that C has them
[23:43:17] <cmr> You will never be able to observe the difference between a copy and a move
[23:43:33] *** Quits: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[23:44:23] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[23:44:27] *** Joins: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net)
[23:46:11] *** Quits: Janko (chatzilla@D9AEFC3E.9E37BD61.9C3D12F2.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 28.0a1/20131114072705])
[23:47:41] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[23:48:59] *** Quits: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net) (Ping timeout)
[23:50:48] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[23:51:53] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:52:01] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[23:52:28] *** Joins: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net)
[23:54:15] *** Quits: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net) (Ping timeout)
[23:55:08] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[23:55:14] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[23:56:51] *** Quits: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:56:57] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Ping timeout)
