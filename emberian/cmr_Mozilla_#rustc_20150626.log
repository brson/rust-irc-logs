[00:02:13] *** kimundi is now known as zz_kimundi
[00:09:08] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[00:26:07] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[00:31:04] <jroesch> acrichto can we try this again: https://github.com/rust-lang/rust/pull/26415
[00:31:09] <jroesch> apparently it hasn't moved
[00:31:13] <jroesch> rebased right now
[00:31:46] <acrichto> jroesch: done
[00:36:03] <jroesch> acrichto: cool thanks, I love that the easiest change I've ever made has been the hardest to merge
[00:36:04] <jroesch> ;)
[00:53:42] <eddyb> aaaaand nmatsakis has the ball
[00:54:19] <eddyb> will he pass it to someone else? will he review it himself? stay tuned to find out!
[00:55:33] <jroesch> eddyb: he just said in person he will read it
[00:55:37] <jroesch> err review it
[00:55:46] <eddyb> yeah I was just being silly
[00:55:49] <jroesch> they are all headed to dinner 
[01:17:45] *** Quits: brson (brson@moz-ilu.bfn.243.173.IP) (Connection closed)
[01:21:19] <eddyb> jroesch: now I noticed https://github.com/rust-lang/rust/pull/26582
[01:22:41] <eddyb> jroesch: do you have a good diff3 tool at your disposal? (I use kdiff3)
[01:23:13] <eddyb> one of us will have to rebase and I want it to go as smoothly as possible
[02:06:54] <eddyb> nmatsakis, jroesch: actually, I think I'd like to rebase on top of https://github.com/rust-lang/rust/pull/26582
[02:07:07] <eddyb> though I'm not sure
[02:07:12] <eddyb> it would simplify some things
[02:38:00] *** Quits: zz_kimundi (kimundi@moz-3idv6e.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:40:18] *** Joins: zz_kimundi (kimundi@moz-8qef24.dip0.t-ipconnect.de)
[02:40:19] *** zz_kimundi is now known as kimundi
[02:59:33] <aatch> jroesch, it merged!
[03:39:12] <eddyb> oh, that thing :P
[03:48:31] <eddyb> jroesch: whoa 3-way merge succeeded everywhere but in the first commit of my PR (and the last commit which I never pushed)
[03:50:03] <eddyb> and it only failed on imports, not any uses
[03:50:17] <eddyb> (or is that the only thing you changed? I forget)
[04:06:36] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[04:10:47] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[04:17:19] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[04:52:54] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[05:01:20] <eddyb>     fn deref(&self) -> &&'a GlobalContext<'tcx> { &self._global_context }
[05:41:51] <eddyb> so if I have pub struct TyCx<'a, 'tcx: 'a> { _global_context: &'a GlobalContext<'tcx> }
[05:42:20] <eddyb> that should be contravariant on 'a, right? somehow it ends up requiring that 'a outlives 'tcx
[05:42:27] <eddyb> which would make it... invariant
[05:44:46] <eddyb> I'm getting such an error inside phase_3_run_analysis_passes and at a callsite of phase_3_run_analysis_passes
[05:45:10] <eddyb> you'd think the signature would be wrong or something, but it looks fine from here :/
[05:48:41] <eddyb> jroesch: didn't you run into some trouble with HRTB+closures, where the closure wanted to infer a precise lifetime instead of being generic over it?
[05:49:58] <jroesch> eddyb: I tried to submit an issue the next day but the failing play program seemed to work
[05:50:08] <jroesch> Headed back to my hotel
[05:50:15] <jroesch> Will be afk for a few
[05:50:37] <eddyb> huh
[05:51:36] <eddyb> jroesch: I ripped out ty::ctxt but it's not compiling that one driver function (and a call to it in --pretty=typed handling)
[05:52:29] <eddyb> regionck is the worst >:(
[07:10:09] <jroesch> eddyb: sorry got caught up talking to someone and looking at something completely unrelated for alex
[07:10:53] <eddyb> jroesch: -Z verbose reveals something troubling
[07:11:00] <eddyb> src/librustc_driver/driver.rs:609:25: 609:32 note: ...so that types are compatible (expected `&'_#4r rustc::ast_map::Map<'_#3r>`, found `&'_#2r rustc::ast_map::Map<ReFree(DestructionScopeData { node_id: 6883 }, BrNamed(DefId { krate: 0, node: 6873 }, 'tcx))>`)
[07:11:05] <eddyb> src/librustc_driver/pretty.rs:149:39: 149:79 note: ...so that types are compatible (expected `core::option::Option<rustc::ast_map::Map<'_#55r>>`, found `core::option::Option<rustc::ast_map::Map<ReFree(DestructionScopeData { node_id: 9324 }, BrNamed(DefId { krate: 0, node: 9289 }, 'tcx))>>`)
[07:11:05] <jroesch> in order; I do have a good three way merge tool; I like the rebase and I have some style violations 
[07:11:25] <eddyb> good, good
[07:11:32] <eddyb> jroesch: do you happen to know what ReFree is?
[07:12:08] <eddyb> 'tcx is a lifetime parameter of both functions I have regionck issues in
[07:12:21] <eddyb> I guess I could check for myself
[07:13:04] <jroesch> as in a the constructor in ty or what a free region is?
[07:19:09] *** Joins: laumann (thomas@moz-poa.3kq.109.2.IP)
[07:20:09] <eddyb> jroesch: the latter (I shouldn't keep my IRC client so small that the tabs don't have titles anymore)
[07:20:38] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:24:12] <jroesch> assuming it respects the common PL terminology it should be an unbound region, there is a comment suggesting that at some point the regions are liberated/unbound
[07:31:04] <eddyb> jroesch: I checked and it seems to be the correct thing to use for arguments
[07:34:05] <eddyb> src/librustc_driver/driver.rs:719:9: 719:13 note: ...so that the reference type `rustc::middle::ty::TyCx<ReFree(DestructionScopeData { node_id: 7085 }, BrNamed(DefId { krate: 17, node: 225122 }, 'b)),'_#189r>` does not outlive the data it points at
[07:34:26] <eddyb> jroesch: that '_#189r right there should actually be ReFree('tcx)
[07:35:19] <eddyb> but I don't understand where all that craziness com- oh
[07:35:46] <eddyb> when you call a lifetime-generic function, its lifetime parameters get replaced with region variables
[07:36:21] <eddyb> for<'a> Fn(TyCx<'a, 'tcx>) is, well
[07:36:34] <eddyb> actually, there's no projection there
[07:36:45] <eddyb> so it should "just" work
[07:39:02] <jroesch> hrmm
[07:41:22] <eddyb> jroesch: thing is, this worked fine with `Fn(&ctxt<'tcx>)`
[07:41:33] <eddyb> jroesch: could you try something for me, if you have a branch that compiles?
[07:41:51] <eddyb> if not I could probably resurrect my other working dir
[07:42:43] <jroesch> what would you want on said branch? I haven't had a chance to make anymore changed tonight due to work week stuff
[07:43:04] <eddyb> jroesch: in middle::ty::with_ctxt, could you make it use F: for<'a> FnOnce(&'a ctxt<'tcx>)?
[07:43:23] <eddyb> same for librustc_driver::driver::phase_3_run_analysis_passes
[07:43:46] <eddyb> jroesch: I'm wondering whether explicit HRTB is screwing me over
[07:47:43] <jroesch> waiting on the build had to reset because I stupidly did a pull earlier
[07:54:14] *** Joins: laumann_ (thomas@moz-3m6.3kq.109.2.IP)
[07:55:42] <jroesch> stage1 built 
[07:56:01] <jroesch> eddyb: ^ gonna sleep will be up in 6-7 hours
[07:56:03] *** Quits: laumann_ (thomas@moz-3m6.3kq.109.2.IP) (Quit: leaving)
[07:56:12] <eddyb> jroesch: seeya
[07:56:17] <eddyb> and thanks a lot!
[07:57:13] *** Quits: laumann (thomas@moz-poa.3kq.109.2.IP) (Ping timeout: 121 seconds)
[08:26:51] <eddyb> jroesch: I think I'll just use a simple reference to ty::GlobalContext and be done with it
[08:42:35] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[09:11:08] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[10:47:48] *** Joins: arielb1 (Ariel@moz-kvv.ri7.19.46.IP)
[11:20:06] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[11:54:23] *** Quits: arielb1 (Ariel@moz-kvv.ri7.19.46.IP) (Ping timeout: 121 seconds)
[12:09:47] *** Joins: arielb1 (Ariel@moz-kvv.ri7.19.46.IP)
[12:15:54] *** Quits: arielb1 (Ariel@moz-kvv.ri7.19.46.IP) (Ping timeout: 121 seconds)
[12:17:52] *** Joins: arielb1 (Ariel@moz-kvv.ri7.19.46.IP)
[12:19:10] *** Joins: arielb1_ (Ariel@moz-a95rf7.red.bezeqint.net)
[12:19:54] *** arielb1 is now known as Guest3654
[12:19:54] *** arielb1_ is now known as arielb1
[12:22:26] *** Quits: Guest3654 (Ariel@moz-kvv.ri7.19.46.IP) (Ping timeout: 121 seconds)
[12:53:12] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[13:31:44] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[14:43:31] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[15:33:40] <eddyb> nmatsakis: didn't think you were going to see the reply that fast. I edited the comment to add the bit about '_
[15:38:53] <nmatsakis> eddyb: I happened to be sitting at my computer when you posted it :)
[15:39:23] <nmatsakis> eddyb: see my response ;) (I'm about to step away from computer)
[15:40:07] <nmatsakis> eddyb: ps I've got a branch started with an experimental MIR ;) -- got a few more discuss posts to write, about that + plans for incr. comp.
[15:40:17] <nmatsakis> I'll try to do that asap, make sure we're all synchronized...
[15:42:54] <eddyb> lovely :D
[17:02:39] <jroesch> eddyb: I really hope the MIR happens soon, would be awesome 
[17:02:52] <eddyb> nmatsakis: building a branch for '_ atm
[17:03:02] <eddyb> well, testing, the implementation should work
[17:03:04] <jroesch> I love the idea of being able to re-write borrow-check and trans
[17:03:11] *** Joins: sigma (sigma@moz-l8bauc.range217-44.btcentralplus.com)
[17:04:13] <eddyb> nmatsakis: small caveat, need to preserve existing semantics for fn foo<'_>(x: &'_ T) -> &'_ T {x} ('_ was not treated specially)
[17:05:14] <eddyb> nmatsakis: which means it's only treated as a placeholder if there is no '_ defined in scope (doesn't complicate resolve_lifetime)
[17:05:33] <eddyb> nmatsakis: and also if the feature gate is turned on (so the new behavior cannot be observed in stable code)
[17:05:44] <eddyb> (not even in error messages :P)
[17:11:19] <eddyb> uh oh
[17:12:03] <eddyb> nmatsakis, jroesch: I can't get typeck::check::FnCtxt's path handling to accept lifetimes
[17:12:19] <eddyb> if I have a free function foo I can't do foo::<'a, 'b>
[17:13:16] *** Quits: sigma (sigma@moz-l8bauc.range217-44.btcentralplus.com) (Ping timeout: 121 seconds)
[17:13:27] <eddyb> oh, well, it works :P
[17:14:26] <eddyb> ('_, not that path stuff)
[17:59:21] *** Joins: eddyb_ (eddyb@moz-bbmbdo.residential.rdsnet.ro)
[18:00:12] *** Quits: eddyb (eddyb@moz-bbmbdo.residential.rdsnet.ro) (Connection closed)
[18:00:20] *** Joins: eddyb (eddyb@moz-bbmbdo.residential.rdsnet.ro)
[18:11:48] <jroesch> eddyb: thanks for tagging the compiler team I realize I can't actually do that
[18:11:54] <jroesch> realized*
[18:12:19] <eddyb_> the teams are recent
[18:12:41] <huon> that's not the reason jroesch can't tag :P
[18:12:54] <eddyb_> jroesch: it was either acrichto or huon that did it a few times and ...
[18:13:04] <eddyb_> huon: oh I misread what he said
[18:13:11] <jroesch> I don't have the permissions :(
[18:13:17] <jroesch> the stupid GH permissions model kind of sucks
[18:13:23] <eddyb_> so if you mention the team it does nothing?
[18:13:48] <huon> https://github.com/blog/2020-improved-organization-permissions will apparently fix all posisble problems
[18:14:52] <jroesch> eddyb_: it won't hyper link I tried @rust-lang/compiler and it becomes plain text in the preview 
[18:15:01] <eddyb_> jroesch: we might have a path forward via '_. if it's merged today I can get a snapshot ready by tomorrow and redo all the TyCx stuff, cleanly
[18:15:29] <eddyb_> but maybe that's asking for too much
[18:15:59] <jroesch> '_ is just so you don't have to write an explicit lifetime? or are there more semantics?
[18:16:06] <jroesch> err an explicit fresh lifetime 
[18:16:10] <eddyb_> just that
[18:16:18] <jroesch> cool
[18:16:26] <jroesch> I've wanted it before
[18:16:29] <jroesch> so I would be on board
[18:16:50] <jroesch> huon: I'm glad about that, can we opt-in to early access?
[18:16:53] <eddyb_> jroesch: see the RFC and implementation
[18:17:13] <jroesch> I wasn't aware there was an RFC (probably missed it)
[18:17:20] <huon> jroesch: apparently acrichto sent them an email requesting it already
[18:17:23] <huon> unsure of status
[18:17:31] <jroesch> oh sweet
[18:18:07] <acrichto> yeah and they never got back to me :(
[18:20:13] <eddyb_> jroesch: that's because I wrote it and opened it less than an hour ago
[18:20:22] <eddyb_> it's very... selfish
[18:20:46] <jroesch> oh that would make sense 
[18:21:04] <jroesch> I'm barely awake after no sleep, lots of talking, and drinking 
[18:21:26] <eddyb_> I was considering something crazier last year (with defaults and whatnot) but that has its own issues and '_ could "just work"
[18:26:07] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[18:34:43] *** Quits: eddyb_ (eddyb@moz-bbmbdo.residential.rdsnet.ro) (Connection closed)
[18:35:21] *** Joins: eddyb_ (eddyb@moz-bbmbdo.residential.rdsnet.ro)
[19:30:06] *** kimundi is now known as zz_kimundi
[19:35:21] *** zz_kimundi is now known as kimundi
[20:11:20] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[20:12:00] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[20:12:15] *** Quits: eddyb_ (eddyb@moz-bbmbdo.residential.rdsnet.ro) (Ping timeout: 121 seconds)
[20:12:23] *** Tuba is now known as Tobba
[20:25:55] *** Joins: eddyb_ (eddyb@moz-bbmbdo.residential.rdsnet.ro)
[21:17:49] *** Quits: JustAPerson (JustAPerson@moz-un628q.moe) (*.net *.split)
[21:17:50] *** Quits: kmehall (quassel@moz-i98f9d.kevinmehall.com) (*.net *.split)
[21:17:50] *** Quits: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com) (*.net *.split)
[21:17:50] *** Quits: Sergio (Sergio@moz-g1j.0qd.199.198.IP) (*.net *.split)
[21:17:50] *** Quits: whipsch (whipsch@moz-bl4i0b.from.irc.camp) (*.net *.split)
[21:17:50] *** Quits: lahwran (lahwran@lahwran.net) (*.net *.split)
[21:17:50] *** Quits: WindowsBunny (Peter@moz-vlal7g.east.verizon.net) (*.net *.split)
[21:17:50] *** Quits: jroesch (sid26078@moz-o13a59.charlton.irccloud.com) (*.net *.split)
[21:17:50] *** Quits: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP) (*.net *.split)
[21:17:50] *** Quits: reem (sid78397@moz-octfcu.brockwell.irccloud.com) (*.net *.split)
[21:17:50] *** Quits: frewsxcv (sid86219@moz-dneii9.brockwell.irccloud.com) (*.net *.split)
[21:17:50] *** Quits: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[21:17:50] *** Quits: nrc (sid365@moz-3taf2s.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[21:17:50] *** Quits: nmatsakis (sid381@moz-32a8b5.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[21:17:50] *** Quits: richo (richo@moz-slrmp8.fs1g.619c.a880.2604.IP) (*.net *.split)
[21:17:50] *** Quits: mystor (sid79584@moz-761b3h.charlton.irccloud.com) (*.net *.split)
[21:17:50] *** Quits: pnkfelix (sid344@moz-nnnecs.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[21:17:50] *** Quits: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com) (*.net *.split)
[21:17:50] *** Quits: sfackler (sfackler@moz-ko8uu1.com) (*.net *.split)
[21:17:50] *** Quits: Dabo (dabo@znc.dabo.guru) (*.net *.split)
[21:17:50] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (*.net *.split)
[21:17:51] *** Quits: blank_name (blank_name@moz-p4egrb.mi.frontiernet.net) (*.net *.split)
[21:17:51] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (*.net *.split)
[21:17:51] *** Quits: Luqman (laden@moz-qhp202.csclub.uwaterloo.ca) (*.net *.split)
[21:17:51] *** Quits: stl (stl@moz-511.ict.15.176.IP) (Connection closed)
[21:17:53] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[21:17:53] *** Joins: Dabo (dabo@znc.dabo.guru)
[21:17:53] *** Joins: sfackler (sfackler@moz-ko8uu1.com)
[21:17:53] *** Joins: whipsch (whipsch@moz-bl4i0b.from.irc.camp)
[21:17:53] *** Joins: JustAPerson (JustAPerson@moz-un628q.moe)
[21:17:53] *** Joins: Sergio (Sergio@moz-g1j.0qd.199.198.IP)
[21:17:53] *** Joins: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP)
[21:17:53] *** Joins: richo (richo@moz-slrmp8.fs1g.619c.a880.2604.IP)
[21:17:53] *** Joins: pnkfelix (sid344@moz-nnnecs.0j4i.jtu0.0101.2620.IP)
[21:17:53] *** Joins: frewsxcv (sid86219@moz-dneii9.brockwell.irccloud.com)
[21:17:53] *** Joins: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com)
[21:17:53] *** Joins: reem (sid78397@moz-octfcu.brockwell.irccloud.com)
[21:17:53] *** Joins: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com)
[21:17:53] *** Joins: jroesch (sid26078@moz-o13a59.charlton.irccloud.com)
[21:17:53] *** Joins: mystor (sid79584@moz-761b3h.charlton.irccloud.com)
[21:17:53] *** Joins: Luqman (laden@moz-qhp202.csclub.uwaterloo.ca)
[21:17:53] *** Joins: nmatsakis (sid381@moz-32a8b5.0j4i.jtu0.0101.2620.IP)
[21:17:53] *** Joins: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP)
[21:17:53] *** Joins: nrc (sid365@moz-3taf2s.0j4i.jtu0.0101.2620.IP)
[21:17:53] *** Joins: blank_name (blank_name@moz-p4egrb.mi.frontiernet.net)
[21:17:53] *** Joins: lahwran (lahwran@lahwran.net)
[21:17:53] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[21:17:53] *** Joins: kmehall (quassel@moz-i98f9d.kevinmehall.com)
[21:17:53] *** Joins: WindowsBunny (Peter@moz-vlal7g.east.verizon.net)
[21:17:53] *** belew.mozilla.org sets mode: +qoqoaoooqo acrichto acrichto huon huon pnkfelix pnkfelix nmatsakis aturon nrc nrc
[21:24:58] *** Joins: stl (stl@moz-511.ict.15.176.IP)
[21:29:17] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[22:29:57] *** kimundi is now known as zz_kimundi
[23:04:17] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[23:30:25] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[23:38:20] *** Quits: arielb1 (Ariel@moz-a95rf7.red.bezeqint.net) (Ping timeout: 121 seconds)
