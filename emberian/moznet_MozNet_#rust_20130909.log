[00:00:05] <dbaupp> bjz: (it's a recurring issue; retry'd :) )
[00:00:22] *** Quits: nkoep (nik@moz-B5FFBB08.vpn.rwth-aachen.de) (Client exited)
[00:00:37] <bjz> dbaupp: kick it a few times?
[00:00:41] <SiegeLord> Wait, does make check do make tidy too?
[00:00:46] <kimundi> yes
[00:00:52] <SiegeLord> Oh, that's good
[00:00:53] *** Parts: miza (miza@moz-4DD51325.home.otenet.gr) ()
[00:00:57] <kimundi> make tidy is the style check at the beginning of make check
[00:01:05] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:01:05] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14dd39290 to 14dd5c737: 02http://git.io/N3iJvQ
[00:01:05] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:01:05] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[00:01:05] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/vNthSQ
[00:01:05] <ghrust> 13rust/06auto 140fcb859 15Brendan Zabarauskas: Moved checked trait impls out of std::num...
[00:01:05] <ghrust> 13rust/06auto 148445009 15Brendan Zabarauskas: Add Clone and DeepClone constraints to Primitive trait
[00:01:06] <ghrust> 13rust/06auto 142c31053 15Brendan Zabarauskas: Fix unused import warnings on 32bit systems
[00:01:08] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[00:01:11] <kimundi> that looks for NOTEs and over logn lines and such
[00:01:41] <cmr> jmgrosen: potentially, but the profiles would need to be shipped with rustc.
[00:03:03] <jakub> hi all, I have been working on a RSpec-inspired test framework for Rust (examples of assertions here: https://github.com/jakub-/a8282cf2/blob/master/src/matchers.rs#L187), does anyone have some thoughts on what would make it a better fit for Rust?
[00:03:08] <jmgrosen> cmr: ah, that's true -- what format do you think they should be in then?
[00:04:49] <dbaupp> ebml; everyone loves ebml! :P
[00:05:11] <cmr> jmgrosen: no idea yet
[00:05:14] <SiegeLord> I don't like ebml :'(
[00:05:37] <cmr> SiegeLord: nobody likes ebml, that's the joke
[00:05:49] <SiegeLord> :'(
[00:06:29] <jmgrosen> dbaupp: that sounds like a wonderful idea, if rust was sponsored by IBM
[00:06:37] <bjz> cmr: hey! I *do* actually love ebml
[00:07:47] * bjz grumbles
[00:08:02] <cmr> jakub: looks ok to me
[00:08:05] * dbaupp hugs bjz
[00:08:22] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[00:08:34] <bjz> x)
[00:08:41] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[00:10:17] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[00:12:54] <magg> error: type `~str` does not implement any method in scope named `into_bytes`
[00:14:15] <kimundi> magg: Didn't exist in 0.7 I think
[00:14:17] <kimundi> SimonSapin: ping
[00:14:23] <magg> :(
[00:14:41] <magg> any work around?
[00:14:56] <kimundi> If you don't mind a copy: to_bytes
[00:16:46] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[00:18:03] <sfackler> or as_bytes to get a slice
[00:18:13] <sfackler> I think
[00:18:59] <engla> cmr: if you want to, look at https://github.com/mozilla/rust/pull/9062
[00:20:57] <jakub> cmr: thanks for taking a look!
[00:22:22] *** Joins: a_m0d|home (a_m0d@moz-A7A3F4CE.acanac.net)
[00:23:12] <engla> cmr: pushed one fix on top of that.
[00:24:20] <cmr> engla: I don't feel comfortable r+ing because of the permutation order thing, but you have my moral support
[00:24:45] <engla> hehe ok
[00:25:33] <engla> I think this algorithm will wine
[00:25:35] <engla> win
[00:25:42] <engla> once you go Steinhausâ€“Johnsonâ€“Trotter, you never go back
[00:26:05] <kimundi> haha
[00:28:58] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[00:33:27] *** Joins: mib_noxuds (Mibbit@moz-4D630D1D.cpe.net.cable.rogers.com)
[00:34:21] *** Quits: mib_noxuds (Mibbit@moz-4D630D1D.cpe.net.cable.rogers.com) (Quit: http://www.mibbit.com ajax IRC Client)
[00:35:00] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[00:36:14] *** Quits: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com) (Input/output error)
[00:37:19] *** Quits: mark_edward (AndChat414@moz-F0F62135.hsd1.il.comcast.net) (Ping timeout)
[00:38:16] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[00:40:43] *** Joins: mordof (mordof@moz-548217BC.cpe.net.cable.rogers.com)
[00:42:54] *** Quits: Infiltrator (Infiltrato@4669028E.25A9890C.4B4F1E7A.IP) (Ping timeout)
[00:43:32] *** Joins: Infiltrator (Infiltrato@4669028E.25A9890C.4B4F1E7A.IP)
[00:47:45] *** Joins: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com)
[00:49:08] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[00:49:38] *** Quits: jdsanders (Adium@moz-8527430D.hlrn.qwest.net) (Quit: Leaving.)
[00:50:48] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[00:50:59] *** Quits: heftig (heftig@moz-BA97686.dip0.t-ipconnect.de) (Ping timeout)
[00:51:51] <engla> str has a sad imbalance in that the CharIterator says it has a size_hint with lower limit  len/4 chars. And .collect() for ~str will always use the lower limit as capacity, so even  ".. ".iter().collect::<~str>() allocates several times
[00:52:29] *** kimundi is now known as zz_kimundi
[00:53:43] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[00:59:46] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:00:54] *** Joins: heftig (heftig@moz-5B26914A.dip0.t-ipconnect.de)
[01:01:10] *** Quits: fyolnish_ (fyolnish@moz-EE642520.uqwimax.jp) (Client exited)
[01:03:46] <SiegeLord> Hmm... I've got a fork of rust, I fetched and merged the upstream but the libuv and llvm folders are modified... how would I update them?
[01:04:16] <cmr> SiegeLord: run configure
[01:04:24] *** Quits: maxli (maxli@moz-48300E8.net.uwaterloo.ca) (Quit: Leaving.)
[01:04:26] <SiegeLord> Aha, that works
[01:04:29] <SiegeLord> Kind of odd, but alright
[01:05:47] *** Quits: Kauhsa (kauhsa@moz-A78B2D1A.fi) (Ping timeout)
[01:06:20] *** Joins: Kauhsa (kauhsa@moz-A78B2D1A.fi)
[01:06:48] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[01:08:01] <klutzy> usually `git submodule sync` then `git submodule update`, but configure runs them
[01:08:35] <magg> can you tell me if this line is deprecated in 0.7?
[01:08:38] <magg> let temp1 = u8::parse_bytes(xs1.slice(i, i+2), 16);
[01:09:32] <SiegeLord> I just did the update, I guess I was missing the syn
[01:09:33] <SiegeLord> *sync
[01:09:42] *** Joins: jdsanders (Adium@moz-8527430D.hlrn.qwest.net)
[01:11:19] <klutzy> sync command sets remote uri correctly
[01:12:00] <klutzy> since libuv and llvm's remote path sometimes changes
[01:13:18] <SiegeLord> I see
[01:13:26] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[01:14:47] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[01:14:54] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[01:17:16] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0.1/20130814063812])
[01:21:27] <cmr> ChrisMorgan: Hiya!
[01:22:14] *** Quits: six600110 (six600110@moz-2FA48202.neo.res.rr.com) (Connection timed out)
[01:23:25] *** Joins: six600110 (six600110@moz-2FA48202.neo.res.rr.com)
[01:25:09] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:27:33] <cmr> rusti: 5
[01:27:35] -rusti- Bad system call
[01:27:35] -rusti- application terminated with error code 159
[01:27:39] <cmr> strcat: mind fixing that?
[01:27:51] *** Joins: brendan (brendaneic@moz-99385846.sub-70-197-1.myvzw.com)
[01:27:53] <strcat> oh
[01:28:48] <mordof> ok - time to attempt to install rust
[01:29:07] <strcat> rusti: 2
[01:29:09] -rusti- 2
[01:29:16] <cmr> strcat: thanks!
[01:29:19] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[01:29:49] <strcat> cmr: https://github.com/thestinger/rust-playpen/commit/5d98a91c624197642af77f8ed092c1f664b757a0
[01:30:22] <strcat> anyway, strace -f |& grep -vf whitelist
[01:30:24] <strcat> ;p
[01:30:33] <strcat> strace -f rustc foo.rs *
[01:31:28] *** Quits: mordof (mordof@moz-548217BC.cpe.net.cable.rogers.com) (Ping timeout)
[01:31:49] <SiegeLord> I see how well that went... ._.
[01:33:14] <engla> thanks strcat 
[01:33:33] <engla> rusti is important
[01:33:57] <benh> mostly because the other rusti doesn't work :)
[01:34:37] *** Joins: maxli (maxli@moz-F6C28616.net.uwaterloo.ca)
[01:36:39] <dcrewi> is the rusti bot written in rust?
[01:36:43] <cmr> no
[01:36:52] <cmr> python and c++ for the sandbox
[01:36:52] <dcrewi> aw
[01:37:48] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[01:38:11] <ChrisMorgan> cmr: Heya!
[01:38:42] <cmr> ChrisMorgan: rust-http is quite nice, although it still has some rough corners in the server side (which is what I've been using)
[01:38:55] <ChrisMorgan> It certainly does have rough corners.
[01:40:10] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[01:40:30] *** Quits: maxli (maxli@moz-F6C28616.net.uwaterloo.ca) (Ping timeout)
[01:40:33] *** Joins: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com)
[01:41:08] <ChrisMorgan> cmr: what particular things did you have trouble with or need work?
[01:41:11] <ChrisMorgan> (Documentation?)
[01:41:15] <cmr> ChrisMorgan: mostly documentation yeah
[01:41:31] <cmr> Especially
[01:41:33] <cmr>     /// You will almost never need to use this; you should prefer the `url` field instead.
[01:41:37] <cmr> Said field does not exist!
[01:41:39] *** Quits: RMF (RMF@moz-1A0DBA5B.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[01:42:35] <cmr> But overall I'm pleased with it
[01:42:39] <cmr> The API is fairly pleasant
[01:42:55] <cmr> I may or may not write a web framework
[01:43:15] <cmr> I'm still a bit burned out on that stuff from when I wrote my lua one (for the first iteration of this same project, in fact!)
[01:45:11] <SiegeLord> Anybody with understanding of metadata/resolve want to try reviewing this: https://github.com/mozilla/rust/pull/9064 ?
[01:45:56] *** jorendorff_away is now known as jorendorff
[01:49:07] *** Joins: maxli (maxli@moz-F6C28616.net.uwaterloo.ca)
[01:49:55] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[01:51:35] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[01:53:57] <cmr> ChrisMorgan: How do I even get a non-AbsolutePath RequestUri?
[01:54:03] <cmr> I can't seem to construct one with curl
[01:54:22] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Connection reset by peer)
[01:54:49] *** jorendorff is now known as jorendorff_away
[01:54:56] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[01:56:05] <cmr> Oh it has to do with the request line.
[01:56:26] <cmr> ChrisMorgan: What is your thinking about further parsing of the AbsolutePath? I could really use it.
[01:56:37] <ChrisMorgan> cmr: refer to RFC 2616, section 5.1.2
[01:57:04] <ChrisMorgan> Certainly further parsing is necessary; I just haven't done it.
[01:57:08] <cmr> Right
[01:57:19] <cmr> But would it create an extra::url::Url?
[01:57:37] *** Quits: maxli (maxli@moz-F6C28616.net.uwaterloo.ca) (Quit: Leaving.)
[01:57:57] <cmr> (I'd take the hostname and port etc from the Host field; it's required by http 1.1 right?)
[01:58:17] <ChrisMorgan> ... but not for HTTP/1.0 clients.
[01:58:57] <ChrisMorgan> Combining these things into a URL is the purpose of the url field referred to in the comment.
[01:59:05] <cmr> ok
[01:59:09] <ChrisMorgan> (Which, as observed, does not exist yet.)
[01:59:29] <cmr> What would it do for HTTP/1.0 clients? Exploding isn't really an option.
[01:59:54] <cmr> Empty strings? Add options to extra::url::Url? Use our own struct?
[02:03:13] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[02:04:39] <ChrisMorgan> At the HTTP implementation level, rejecting HTTP/1.0 clients because they don't specify Host is certainly not an option. That's only an option at a higher level.
[02:10:32] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:10:33] <ghrust> 01[13rust01] 15thestinger merged 06master into 06snap-stage3: 02http://git.io/SjnKiA
[02:10:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:12:22] *** Quits: jdsanders (Adium@moz-8527430D.hlrn.qwest.net) (Quit: Leaving.)
[02:12:42] *** Joins: jdsanders (Adium@moz-8527430D.hlrn.qwest.net)
[02:13:45] *** Quits: jdsanders (Adium@moz-8527430D.hlrn.qwest.net) (Quit: Leaving.)
[02:14:34] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:16:27] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[02:16:39] <cmr> ChrisMorgan: so duplicating extra::url::Url or making it better?
[02:16:56] <cmr> I'm just a monkey coder right now, point and I'll go :)
[02:17:07] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:18:09] <ChrisMorgan> Not sure. There's also the scheme to add to it; there are a couple of common ways of indicating HTTPS through gateways in extension headers, which we should detectâ€”and default to "http". In the end, I guess it's just the hostname which might not be known.
[02:19:26] <cmr> Does servo use extra::url?
[02:19:27] <ChrisMorgan> I think the end result is probably either Option<Url> or a Url with blank string as the hostname (which isn't "valid")
[02:19:31] <ChrisMorgan> No idea.
[02:19:43] <ChrisMorgan> I presume they would.
[02:20:22] <ChrisMorgan> Note there's also the authority form for the Request-URI; the code which could handle parsing that correctly is in extra::url but is private.
[02:20:28] *** Quits: zz_kimundi (kimundi@moz-11F08F3C.dip0.t-ipconnect.de) (Ping timeout)
[02:23:29] *** Quits: bct (bct@moz-D3BEA05.ed.shawcable.net) (Quit: WeeChat 0.4.1)
[02:24:36] *** Joins: zz_kimundi (kimundi@moz-12AAE460.dip0.t-ipconnect.de)
[02:24:53] *** zz_kimundi is now known as kimundi
[02:30:43] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[02:32:33] *** Joins: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net)
[02:33:12] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[02:34:01] <tiffany> uh..
[02:34:02] <tiffany> types.rs:26:8: 26:123 error: cannot determine a type for this local variable: unconstrained type
[02:34:02] <tiffany> types.rs:26     let build_expr = |atom: ~str, args: ~[AST], T: @FRType| Ok(AST {node: Expr(atom, args), line: token.line, typeinfo: T});
[02:34:07] <tiffany> how is that unconstrained?
[02:34:31] <cmr> where's the span pointing to on that?
[02:34:34] <cmr> the whole closure?
[02:34:43] <tiffany> yeah
[02:34:51] <cmr> Probably because it doesn't know what the Error type would be
[02:34:54] <cmr> it's Result<T, U>
[02:35:05] <cmr> U is unconstrained unless you use it somewhere
[02:35:12] <tiffany> I am using it somewhere
[02:35:18] <tiffany> the U should be TypeError
[02:35:54] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[02:38:25] <tiffany> is there a way to explicitly define return types for closures?
[02:38:45] <cmr> |args| -> RetType ...
[02:39:36] <tiffany> setting the return type seems to fix the error
[02:43:20] *** Joins: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net)
[02:45:52] *** Quits: a_m0d|home (a_m0d@moz-A7A3F4CE.acanac.net) (Quit: Leaving.)
[02:50:41] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:52:22] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:53:21] *** Joins: RMF (RMF@moz-1A0DBA5B.dsl.telepac.pt)
[02:53:28] *** Quits: brendan (brendaneic@moz-99385846.sub-70-197-1.myvzw.com) (Quit: brendan)
[02:56:50] <mcpherrin> does .clone() on a &[T] give me a ~[T]? I thought it would but rustc is whining
[02:57:05] *** Quits: Diamond (dick@moz-D7E07B36.ks.ks.cox.net) (Client exited)
[02:59:40] <engla> no mcpherrin 
[02:59:48] <engla> .to_owned() is what you should use
[02:59:53] *** Quits: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:00:23] *** Joins: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net)
[03:00:29] *** Quits: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net) (Quit: hjr3)
[03:00:42] <engla> .clone should always be  T -> T  i.e. the identity function with a copy. then add some autoderef and it gets a bit more confusing
[03:01:01] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[03:01:56] <mcpherrin> k.
[03:02:42] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[03:03:33] <engla> rusti: let v = &[1,2,3]; v.clone()
[03:03:33] -rusti- &[1, 2, 3]
[03:04:20] <benh> rusti: let v = &mut [1, 2, 3]; v.clone()
[03:04:20] -rusti- &[1, 2, 3]
[03:04:59] <strcat> it doesn't print the mutability qualifier
[03:05:03] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[03:05:25] <benh> I assumed I wasn't actually getting a second mut reference
[03:06:04] *** Joins: jdsanders (Adium@moz-8527430D.hlrn.qwest.net)
[03:06:25] <strcat> that's not really how it works
[03:06:41] <strcat> you can take &mut references into an existing &mut reference, it just prevents the use of it until the new ref is gone
[03:06:52] <engla> you don't get a &mut[T] from clone
[03:06:54] <strcat> rusti: let mut x = 5; let y = &mut x; let z = &mut *y; *z
[03:06:55] -rusti- 5
[03:06:58] <engla> rusti: let v = &mut [1,2,3]; v.clone().asdjfkl
[03:06:58] -rusti- <anon>:5:31: 5:48 error: attempted access of field `asdjfkl` on type `&[<VI2>]`, but no field with that name was found
[03:06:58] -rusti- <anon>:5          let v = &mut [1,2,3]; v.clone().asdjfkl
[03:06:58] -rusti-                                         ^~~~~~~~~~~~~~~~~
[03:06:58] -rusti- error: aborting due to previous error
[03:06:59] -rusti- application terminated with error code 101
[03:07:09] <engla> on type &[<VI2>]
[03:07:12] <strcat> yeah that's just the weird vector auto-borrow
[03:07:26] * strcat didn't realize it was happening there
[03:08:08] <strcat> rusti: &mut [1]
[03:08:09] -rusti- &[1]
[03:08:14] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[03:08:34] <benh> it converts/reborrows &mut to &, then clones the (ptr,len) slice tuple shallowly, doesn't it
[03:08:49] <engla> yeah
[03:09:53] <tiffany> I don't suppose there's any way to use chain() without the error types being identical
[03:10:02] <tiffany> in a Result, that is
[03:10:35] <cmr> tiffany: nope, type mismatch
[03:12:29] <ChrisMorgan> cmr: patches for rust-http very welcome.
[03:13:19] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[03:13:20] *** Joins: sk_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[03:13:53] <tiffany> I figured out I could use map_err to convert the result type to a string
[03:14:08] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Ping timeout)
[03:18:54] <strcat> cmr: https://github.com/mozilla/rust/pull/9066 r?
[03:19:21] *** Joins: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net)
[03:19:38] <Jesse> "make check" runs bench tests? that seems odd, i expect to be able to run "make check" on a computer that i'm also using for other tasks
[03:20:15] <strcat> it just makes sure they work
[03:22:25] <Jesse> i guess that's reasonable, if it doesn't take too long
[03:26:43] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[03:26:56] <tikue> there's no kind of regex matching on strings with "match" is there? or some kind of extended functionality?
[03:27:29] <Jesse> you could use match guards ;)
[03:27:49] *** Quits: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com) (Input/output error)
[03:27:56] <strcat> tikue: there's no regexp support at all in the stdlib
[03:28:04] <tikue> strcat: ah ok, thank you
[03:28:56] <lkuper> Jesse: yeah, I figure that `make check` should check that all the code compiles and runs.  I don't think we have any telemetry thing that reports the results of your benchmarks back to Rust World HQ, so who cares?
[03:28:57] *** Quits: hjr3 (hradtke@moz-4D761D44.lsanca.dsl-w.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:29:05] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[03:29:42] <Jesse> i was worried that it was wasting time producing useless bench numbers, and maybe even planning to FAIL if it didn't like the results
[03:29:52] *** Quits: ChemicalHarm (Mibbit@moz-A9F37238.hsd1.md.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:30:07] <lkuper> yeah, it probably doesn't really need to run them 5 times or however many
[03:30:24] *** Joins: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com)
[03:30:29] *** Quits: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: G'night everynyan~!)
[03:30:58] *** Joins: jgilbert (jgilbert@moz-6D815BB6.dllstx.fios.verizon.net)
[03:31:05] <lkuper> it's probably just the easier thing to have `make check` be the same as the bots as it is on your machine.
[03:32:01] <bjz> jack: ping
[03:33:21] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[03:33:43] <engla> is there a variable for not running benchmarks?
[03:34:11] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[03:34:14] *** Joins: ChrisMorgan1 (chris@moz-80C478D2.its.monash.edu.au)
[03:34:32] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Ping timeout)
[03:34:54] *** ChrisMorgan1 is now known as ChrisMorgan
[03:36:33] *** Quits: magg (magg@DBD57193.ED4197D1.3D0AE249.IP) (Client exited)
[03:38:14] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Ping timeout)
[03:41:31] *** Joins: ChrisMorgan (chris@moz-A7B92540.its.monash.edu.au)
[03:42:42] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[03:44:02] <dwrensha> Is there a way to compile rustc without doing the full bootstrap?
[03:44:09] *** Quits: ChrisMorgan (chris@moz-A7B92540.its.monash.edu.au) (Ping timeout)
[03:44:29] <dwrensha> Like, if I make a tiny change, and want to see its effect, but I don't want to wait half an hour for the full compile cycle.
[03:44:35] <tiffany> oh wow
[03:44:40] <tiffany> I caused rust to segfault without using unsafe code
[03:45:54] <tiffany> ah, it was a stack overflow
[03:47:05] <strcat> stack safety isn't implemented with the new runtime yet
[03:47:14] <benh> :(
[03:47:22] <benh> Is the design hashed out yet?
[03:47:32] <strcat> no
[03:48:28] *** Joins: mib_6w0qe0 (Mibbit@moz-7C0D93A9.hsd1.il.comcast.net)
[03:50:06] *** Quits: mib_6w0qe0 (Mibbit@moz-7C0D93A9.hsd1.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:51:25] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:53:05] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:53:40] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[03:55:47] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[03:56:09] <bjz> dbaupp: -_- https://github.com/mozilla/rust/pull/9051
[03:56:44] <bjz> dwrensha: you could compile from the ocaml source
[03:57:17] <bjz> dwrensha: and then rebuild every snapshot made for the last several years
[03:57:23] <bjz> but that might take a while
[03:57:45] <dwrensha> I'll take that as a "no".
[03:57:46] <benh> isn't there a make target for that, vaguely
[03:58:00] <bjz> dwrensha: it's possible!
[03:58:02] <bjz> :D
[03:58:24] *** Quits: jgilbert (jgilbert@moz-6D815BB6.dllstx.fios.verizon.net) (Ping timeout)
[03:59:44] *** Joins: frau (frau@moz-C616DA0A.hsd1.ca.comcast.net)
[04:00:48] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Ping timeout)
[04:01:05] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Client exited)
[04:01:55] <engla> bjz: that sounds like a truly full bootstrap to me
[04:02:15] <bjz> engla: true :P
[04:05:30] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[04:05:48] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[04:06:06] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:06:40] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:07:23] *** Joins: brendan (brendaneic@moz-99385846.sub-70-197-1.myvzw.com)
[04:10:13] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:13:33] *** Quits: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net) (Ping timeout)
[04:16:00] *** Quits: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com) (Input/output error)
[04:16:53] <jeaye> Hmm, drop takes an immutable self? Seems odd, since a dtor could have cleanup work to do.
[04:18:29] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[04:19:32] <jeaye> It'd seem I _am_ looking to mutate in drop. :|
[04:20:34] *** Joins: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com)
[04:20:42] <engla> yes it is odd
[04:20:52] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:22:37] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[04:24:09] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[04:27:40] <jeaye> rusti: 4
[04:27:40] -rusti- 4
[04:28:55] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[04:29:04] <jeaye> rusti: unsafe { let i = 4; let ir: &int = &i; let imr: &mut = std::cast::transmute(ir); *ir = 5; i }
[04:29:04] -rusti- <anon>:5:62: 5:63 error: expected type, found token EQ
[04:29:05] -rusti- <anon>:5          unsafe { let i = 4; let ir: &int = &i; let imr: &mut = std::cast::transmute(ir); *ir = 5; i }
[04:29:05] -rusti-                                                                        ^
[04:29:05] -rusti- application terminated with error code 101
[04:29:12] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:29:15] <jeaye> rusti: unsafe { let i = 4; let ir: &int = &i; let imr: &mut int = std::cast::transmute(ir); *ir = 5; i }
[04:29:16] -rusti- <anon>:5:94: 5:97 error: cannot assign to immutable dereference of & pointer
[04:29:16] -rusti- <anon>:5          unsafe { let i = 4; let ir: &int = &i; let imr: &mut int = std::cast::transmute(ir); *ir = 5; i }
[04:29:16] -rusti-                                                                                                        ^~~
[04:29:16] -rusti- error: aborting due to previous error
[04:29:18] -rusti- application terminated with error code 101
[04:29:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:31:20] <jeaye> rusti: unsafe { let i = 4; let ir: &int = &i; let imr: &mut int = std::cast::transmute(ir); *imr = 5; i }
[04:31:21] -rusti- 5
[04:32:00] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[04:32:01] <jeaye> rusti: unsafe { let i = 4; let imr: &mut int = std::cast::transmute(&i); *imr = 5; i }
[04:32:02] -rusti- 5
[04:32:10] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[04:33:35] <bjz> jeaye: there is transmute_mut which is more controlled
[04:33:58] <jeaye> rusti: unsafe { let i = 4; let imr: &mut int = std::cast::transmute_mut(&i); *imr = 5; i }
[04:33:59] -rusti- 5
[04:34:03] <bjz> rusti: unsafe { let i = 4; let imr = std::cast::transmute_mut(&i); *imr = 5; i }
[04:34:04] -rusti- 5
[04:34:04] <jeaye> bjz: Thanks
[04:34:05] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:34:59] <bjz> jeaye: always gotta watch out for your transmutes - I always try to keep mine as tightly wrapped as possible
[04:35:12] <jeaye> Segfault: https://gist.github.com/jeaye/9ca780371f9544b01580
[04:35:54] <jeaye> bjz: Fair point.
[04:36:15] <jeaye> (trying to do anything with 'this' segfaults) :|
[04:36:59] <bjz> what is the destructor on "state"?
[04:37:16] <jeaye> Not supplied.
[04:37:34] <bjz> could you make that call .unload?
[04:38:03] <jeaye> I'd have to do the same transmute_mut trickery, but I'll try it.
[04:38:13] <bjz> ahh, dang
[04:38:29] <jeaye> unload() expects &mut self
[04:39:15] <jeaye> Also, it's convenient only to do it from the Director because, while other states can exist, they're only loaded if they're in the Director (thus preventing double unloading, or the need for a bool to say whether or not a state is loaded).
[04:39:40] <jeaye> Very silly that drop takes &self. I wonder if there's good reasoning.
[04:40:19] <bjz> jeaye: might have to talk to brson about that
[04:40:44] <engla> it's planned to hange but smth must be blocking it
[04:40:51] *** Joins: aeqwa (aeqwa@moz-87C875B8.dsl.tropolys.de)
[04:40:53] <engla> *change
[04:41:32] <mcpherrin> This may be a little offtopic, but does anyone here own a DEC VT340 or similar hardware terminal?
[04:42:05] <jeaye> 'may be a little offtopic'? As in, there's a chance it's ontopic? :P
[04:42:22] <mcpherrin> well the reason I ask the question has to do with Rust code :P
[04:42:54] <mcpherrin> I'm interested in writing a terminal emulator that includes Sixel and ReGIS support, but I don't have hardware to test my implementation against
[04:43:42] <strcat> jeaye: your mistake is thinking that things are the way they are due to design choices :P
[04:43:52] <strcat> there's an ancient issue report about Drop
[04:44:34] <strcat> it hasn't been changed to &mut self because the long-term plan has been to figure out a way to get by-value self to work there, so there hasn't been motivation for someone to half fix them all
[04:45:00] <jeaye> heh
[04:45:06] <strcat> although it blocks implementing alias analysis
[04:45:15] <strcat> as do other abuses of & pointers
[04:45:28] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:45:56] <jeaye> Blocks a couple of my issues too, but they can wait. Thanks for the heads up.
[04:46:06] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[04:51:20] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[04:56:07] *** Quits: roboguy (roboguy@moz-266CFD9E.cm.sunflower.com) (Input/output error)
[04:57:02] <frau> how is alias analysis going to work... turned off in any unsafe or unsafe-containing function?
[04:57:29] <frau> or do you have to understand all its rules when writing unsafe code
[04:59:47] <strcat> you have to understand the rules while writing unsafe code, like C
[05:00:08] <strcat> you already have to understand LLVM's pointer aliasing rules in unsafe code
[05:00:12] <strcat> just not type based rules
[05:00:53] <frau> ah, right, like in C, makes sense
[05:01:02] <strcat> it will basically be as simple as not abusing borrowed/unique pointers, but using raw pointers
[05:01:14] <frau> ... I don't think about aliasing much in C heh. Just use unions instead of voids
[05:01:52] <strcat> the big wins would be from enforcing pointer type rules
[05:01:57] <strcat> rather than C-like type punning rules
[05:02:06] <frau> strcat: ah I think I get it! Just don't violate the uniqueness/borrow invariants and you should be good
[05:02:13] <strcat> yeah
[05:02:49] <frau> alias analysis for uniques will be a nice win :)
[05:03:24] <strcat> LLVM's alias analysis is based on memory dependencies so there can be big wins from &/&mut
[05:03:43] <strcat> 2 pointers alias if a write through one is visible through another
[05:03:55] <strcat> if they're both immutable references, they don't alias (even if they point at the same location)
[05:04:01] <sfackler> it would be nice to have an aliasable borrowed pointer, but I don't know if it can be done safely
[05:04:02] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[05:04:15] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[05:04:31] <strcat> you can have any number of & pointers to something
[05:04:45] <frau> hmm I see
[05:05:01] <sfackler> rust-postgres is stuck shoving all mutable state in Cells :(
[05:05:18] <strcat> why doesn't it expose the mutability in the API?
[05:05:39] <sfackler> Connection.prepare returns an object with a borrowed pointer to the Connection
[05:05:52] <sfackler> if the borrowed pointer was mutable, you could only have one prepared statement at a time
[05:06:22] <sfackler> even worse, you can't define any methods on &mut self, since they're not callable if you have a prepared statement
[05:06:42] *** Quits: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net) (Ping timeout)
[05:07:02] <sfackler> so everything including the TcpStream goes in a cell
[05:07:21] *** Quits: cdidd (cdidd@moz-2A682381.broadband.corbina.ru) (Ping timeout)
[05:07:24] <strcat> definitely never going to have aliasable, mutable references
[05:07:38] <strcat> requires dynamic checking, which is what @mut and Cell do
[05:08:42] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[05:08:47] *** Joins: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net)
[05:09:25] <sfackler> even with an extra identifier to opt-in? like &mut aliasable Foo or whatever
[05:09:37] <strcat> definitely not, it's not memory safe
[05:10:38] <strcat> rust's borrow system could be more powerful if it was much more complex, as in based on whole program analysis or dependent typing
[05:10:47] <strcat> but it's supposed to be simple
[05:10:53] <sfackler> yeah
[05:11:02] <frau> how is the <hash> in libfoo-<hash>-0.1.so generated?
[05:12:27] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[05:12:40] <sfackler> i'm not sure if it actually works, but you may be able to do it safely by freezing a struct after doing a mutable borrow of something inside of it and only allowing further mutable borrows on the exact same memory address you already borrowed. though I can think of cases where it'd be arbitrarily hard to figure out what the address is, so...
[05:13:00] <sfackler> *figure out at compile time
[05:13:17] <sp3d> frau: https://github.com/mozilla/rust/wiki/Doc-crate-hashes
[05:13:31] <frau> sp3d: thanks!
[05:13:55] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[05:14:17] <strcat> sfackler: requires whole program analysis
[05:14:22] <strcat> can't be done with local rules
[05:14:25] <acrichto> strcat: is there a bug to go along with 9065 ?
[05:14:34] <strcat> acrichto: the repr thing? no
[05:14:37] <strcat> just noticed it and fixed it
[05:14:39] <strcat> took a second
[05:14:40] <acrichto> iter => iterator
[05:14:44] <acrichto> er, <=
[05:14:55] <acrichto> repr is fine
[05:14:57] <strcat> oh, no - brson just mentioned it a while ago and it seemed sensible
[05:15:09] <strcat> since there's FromIterator, Extendable and soon Iterable in there
[05:15:11] *** Joins: ChrisMorgan (chris@moz-A782B51D.its.monash.edu.au)
[05:15:23] <strcat> it's a module for iteration, not iterators
[05:15:33] <strcat> and iter is more rustic
[05:15:48] <acrichto> sounds good to me
[05:16:09] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[05:16:09] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144908de2 to 14dd5c737: 02http://git.io/N3iJvQ
[05:16:09] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[05:16:10] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:16:10] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/2J10Vg
[05:16:10] <ghrust> 13rust/06auto 14ec7cd77 15Daniel Micay: repr: write the mutability qualifier for slices
[05:16:10] <ghrust> 13rust/06auto 14db4720b 15Daniel Micay: repr: update for removal of const
[05:16:10] <ghrust> 13rust/06auto 14eae3270 15bors: auto merge of #9066 : thestinger/rust/repr, r=alexcrichton
[05:16:12] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[05:16:20] <strcat> I had to call it iterator because iter was taken at the time ;p
[05:16:25] *** Joins: mib_jzo6ec (Mibbit@A437D59F.31674FAD.14803CBF.IP)
[05:16:29] <strcat> I don't know what I would have called it if I had actually had a choice
[05:16:57] <acrichto> the for loop axe has since been used liberally
[05:17:32] <acrichto> engla: ping
[05:17:44] *** Quits: mib_jzo6ec (Mibbit@A437D59F.31674FAD.14803CBF.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:17:46] *** Joins: cdidd (cdidd@moz-22C6C304.broadband.corbina.ru)
[05:18:12] <lkuper> Anyone know if we're supposed to update the year in the copyright block for files that we touch?  Do people actually consistently do this?
[05:18:21] <engla> hi
[05:18:23] <strcat> lkuper: people don't consistently do it
[05:18:36] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[05:18:39] <strcat> lkuper: imo we should do what some projects do and globally update them to the latest year when the year changes
[05:18:47] <strcat> you don't *have* to leave them at an old year if you haven't touched them
[05:18:51] <acrichto> engla: your commit to fix the tests, is that because they failed or didn't compile?
[05:19:05] <lkuper> strcat: yeah, agreed
[05:19:07] <engla> I edited the comment to briefly explain why
[05:19:11] <strcat> you can just consider the copyright as on the project as a whole and keep it simple
[05:19:25] * strcat shrugs
[05:19:35] <strcat> mozilla's lawyers would probably need to sign off on it ;P
[05:19:36] <engla> basically the test falls right into the trap that this iterator's elements are all the same slice..
[05:19:58] <acrichto> engla: weird, I would expect that it should generate a compiler failure
[05:20:09] <acrichto> if you give me something, it shouldn't be able to change from under my feet, right?
[05:20:53] <engla> hm no idea why this works in the first place
[05:21:08] <lkuper> strcat: alternately, we could have tidy check that the first line of the file matches the last-modified year of the file!
[05:21:38] <strcat> lkuper: true, but it would be so much simpler to just call them all 2013
[05:21:45] *** Joins: aeqwa_ (aeqwa@moz-942AF6B3.dsl.tropolys.de)
[05:21:49] <strcat> and sed them all to 2014 in january
[05:22:04] <lkuper> strcat: yeah.  unless there were some sort of legal issue with that.
[05:22:18] *** Quits: aeqwa (aeqwa@moz-87C875B8.dsl.tropolys.de) (Ping timeout)
[05:22:30] <strcat> lkuper: I don't think there's a legal issue, but there's might be a mozilla policy issue
[05:23:37] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[05:23:47] <strcat> copyright does expire, so there's a semantic difference in considering it per-file or on the project
[05:24:02] <strcat> but you don't have to make the copyright granular
[05:24:11] <strcat> or per-page in a book ;p
[05:25:17] *** Quits: Larry (larryfox@moz-8D6C9B2A.nycmny.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:26:12] <engla> acrichto: I think it violates the borrowing rules horribly, but it's uncaught
[05:26:30] <acrichto> engla: yeah opening an issue on it now, I think the iterator should return ~[T]
[05:27:21] <engla> strcat: do you want to look at this iterator? basically yielding  slices from a held &mut[T]   
[05:27:29] <engla> https://github.com/blake2-ppc/rust/commit/f4d90572d5b7966a55b1d4b6b0fb257477075ac0#L0R511
[05:27:41] <acrichto> engla: #9069
[05:28:09] <engla> acrichto: ok, avoiding copies was half the charm. The ElementSwaps iterator can be useful for that though
[05:28:17] <engla> strcat: just the Permutations part.
[05:28:31] <acrichto> engla: arguably this should be possible
[05:28:38] <acrichto> just perhaps a compiler error?
[05:28:49] <strcat> engla: yeah looks like a compiler flaw
[05:30:17] <engla> ok great. It's always something with 'self to give you grief
[05:32:39] *** Quits: jdsanders (Adium@moz-8527430D.hlrn.qwest.net) (Quit: Leaving.)
[05:33:00] <strcat> hm
[05:33:26] <strcat> you know I really can't figure out an easy way of forbidding index-assign on str :s
[05:33:33] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[05:33:40] <strcat> index and assignment are totally separate
[05:34:03] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:34:20] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[05:34:24] <strcat> and it figures out the mutability for the assignment from the mutability of the object you're indexing
[05:35:43] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:36:22] <strcat> lkuper: we should also probably update AUTHORS.txt automatically, and use an exceptions list
[05:36:28] <strcat> I think that's already an issue
[05:36:42] <lkuper> yeah, I've been thinking that as well
[05:36:57] <lkuper> there are surely more contributors than are listed in AUTHORS.txt
[05:37:01] <lkuper> a sign of success
[05:37:17] <strcat> yeah, AUTHORS.txt says 228 and github says 267
[05:37:44] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:37:45] <strcat> well actually it doesn't say 228, I'm counting the header :)
[05:37:58] <strcat> 221*
[05:38:05] <engla> acrichto: great that you are asking the right questions. I didn't connect and realize this should be invalid
[05:38:10] <strcat> 222, rather
[05:38:25] * strcat will learn to count one day
[05:38:30] <engla> not even when having my 300,000 element hashset with every element being the same &[T]
[05:41:04] *** Joins: mib_1mqmmj (Mibbit@1D51AEA2.A9DA0237.DDE5D3F6.IP)
[05:42:08] *** Quits: mib_1mqmmj (Mibbit@1D51AEA2.A9DA0237.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:43:49] *** Quits: huseby (huseby@96211BDE.83CC6402.D9CD682B.IP) (Quit: Leaving)
[05:44:00] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[05:48:15] *** Quits: KindOne (KindOne@90FCC87.7E8839F4.34F73994.IP) (Ping timeout)
[05:50:57] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:51:54] <acrichto> engla: I feel like this should be possible, but perhaps just having the compiler realize that you can't have two values live at once
[05:52:07] *** Joins: KindOne (KindOne@5C5D06A7.A68CD9B.34F73994.IP)
[05:52:33] *** Joins: aeqwa (aeqwa@moz-48D0AAAD.dsl.tropolys.de)
[05:53:07] *** Quits: aeqwa_ (aeqwa@moz-942AF6B3.dsl.tropolys.de) (Ping timeout)
[05:55:46] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[05:55:46] *** ChanServ sets mode: +o pnkfelix
[05:57:28] <engla> I think it is impossible, because the iterator wants to hold its &mut [T] and return slices from it. As long as a derived slice lives, the &mut [T] should be frozen
[05:58:25] <engla> so it should be impossible to return a derived slice because then you can't enforce the freezing rule
[06:02:00] <acrichto> maybe you can't freeze '&mut' when your struct is '&mut'
[06:09:09] *** Quits: Earnestly (earnest@moz-BE290A2B.dyn.plus.net) (Ping timeout)
[06:09:57] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[06:11:30] <sfackler> acrichto: should I open a new issue for this? https://github.com/mozilla/rust/issues/5862
[06:12:01] *** Quits: sk_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[06:12:25] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[06:12:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:13:08] *** Quits: brendan (brendaneic@moz-99385846.sub-70-197-1.myvzw.com) (Quit: brendan)
[06:13:13] *** Joins: fabiand (fabiand@moz-18B5E9CD.adsl.alicedsl.de)
[06:14:27] <engla> acrichto: can you elaborate?
[06:15:10] <acrichto> sfackler: sure, although they may not be totally related, obviously a minimization would be nic ethough :)
[06:15:32] <acrichto> engla: if a struct has `&mut T`, perhaps a method on `&mut Struct` can't freeze `&mut T` to return it
[06:15:46] <engla> acrichto: this is the kind of cheap permutations iteration that the ElementSwaps iterator allows, maybe it's just not possible to fit this into the Iterator trait..   https://gist.github.com/anonymous/213634319e9acfe41806    
[06:17:05] <acrichto> engla: I think that it's really nice
[06:17:21] *** Joins: pyrac (pyrac@3907364F.73C89388.AD05C589.IP)
[06:21:07] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:21:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2J10Vg
[06:21:08] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:21:41] *** Quits: KindOne (KindOne@5C5D06A7.A68CD9B.34F73994.IP) (Ping timeout)
[06:22:49] <engla> in that form it should really return the last reset swap too
[06:25:21] *** Joins: nkoep (nik@moz-B585261.pool.mediaways.net)
[06:26:02] *** Joins: KindOne (KindOne@moz-85B1BDE0.dynamic.ip.windstream.net)
[06:26:08] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:26:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/7N1HAQ
[06:26:08] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:26:10] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:26:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/kTQ9Gw
[06:26:10] <ghrust> 13rust/06auto 1429e353c 15Daniel Micay: rename `std::iterator` to `std::iter`...
[06:26:10] <ghrust> 13rust/06auto 144d91447 15bors: auto merge of #9065 : thestinger/rust/iter, r=alexcrichton...
[06:26:11] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:26:57] *** Quits: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net) (Ping timeout)
[06:27:04] *** Joins: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr)
[06:27:16] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Ping timeout)
[06:27:42] *** Joins: squiddy (squiddy@moz-DFB9D31F.adsl.alicedsl.de)
[06:28:30] <mindcat> how check a owned vector has somethings?
[06:28:54] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[06:28:57] <strcat> 'somethings'?
[06:28:58] *** Joins: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net)
[06:29:39] <mindcat> I mean, how check this vector is not empty?
[06:29:45] *** Quits: KindOne (KindOne@moz-85B1BDE0.dynamic.ip.windstream.net) (Ping timeout)
[06:29:45] <strcat> is_empty/len
[06:29:53] <mindcat> strcat: oh!
[06:30:00] <mindcat> strcat: I forget this
[06:30:01] *** Quits: frau (frau@moz-C616DA0A.hsd1.ca.comcast.net) (Ping timeout)
[06:32:45] *** Joins: jdm (jdm@moz-2C5514D1.lightspeed.sntcca.sbcglobal.net)
[06:32:45] *** ChanServ sets mode: +o jdm
[06:33:44] *** Quits: aeqwa (aeqwa@moz-48D0AAAD.dsl.tropolys.de) (Quit: Lost terminal)
[06:34:18] *** Joins: KindOne (KindOne@630B67F7.B7D17EEE.EC6A1518.IP)
[06:35:01] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[06:36:39] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[06:41:25] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[06:47:28] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[06:49:01] <gavinb> Still confused by lifetimes. Have some code which defines a struct taking a string reference (&str). Get errors about lifetimes and so on, so I add <'self> to the struct decl and 'self to the str ref, as I want to say that I need the reference for as long as this struct is around. But I still get "error: cannot infer an appropriate lifetime due to conflicting requirements" and all sorts. http://pastebin.com/XmFjzW4t
[06:49:09] <strcat> rusti: std::sys::size_of::<~fn()>()
[06:49:12] -rusti- 16u
[06:49:12] <glyc> hmm... I'm leaking memory because I unwrapped a c_str during ffi call. How do I tell me c_str to resume responsibility for its buf after the unsafe block is over?  I don't see a re-wrap method or way to manually set owns_buf to true... ?
[06:51:31] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[06:51:48] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:51:51] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:52:01] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[06:52:32] <glyc> gavinb: rustc is pointing you at the lifetime of ss, is it not?
[06:53:00] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[06:53:42] <strcat> glyc: by definition, unwrap gives up ownership
[06:53:46] <strcat> you want with_ref if you don't want to do that
[06:54:51] <glyc> strcat: well, I do want it to temporarily give up ownership (and not free during the ffi call), and then resume ownership afterwards. 
[06:55:14] <strcat> it will never free it during the ffi call, it can't
[06:55:29] <glyc> gavinb: if you write:      &'self str)   it will compile, but is that what you mean to say, that the lifetime of the borrowed string str matches the lifetime of StrRange? 
[06:56:10] <strcat> if you use with_ref and pass it to the function, it's not going to be freed until the function returns and it goes out of scope
[06:56:28] <glyc> strcat: ok, got it. Thanks!
[06:56:49] <strcat> unwrap is destroying the c_str, and unwrapping it
[06:56:57] <strcat> it takes self by-value
[06:57:04] <strcat> you would have to make a new one
[06:57:12] <glyc> strcat: ah, ok
[06:57:35] <gavinb> glyc: hm, yes the lifetime of the borrowed str ref is the same as the struct. So it's just the parameter of new that needs fixing? The error messages are not quite illuminating.
[06:57:49] <strcat> it's if you actually want to get rid of the c_str but keep the ptr to the allocated memory
[06:58:17] <glyc> strcat: yes, perfect for when the foreign lib will deallocate, but it doesn't in my situation
[06:58:24] <gavinb> glyc: right, that was it! thanks!
[06:59:08] <gavinb> I seem to recall reading somewhere that the "self" in 'self is arbitrary; IOW it might as well be 'r ?
[06:59:52] <gavinb> Er, no: error: Illegal lifetime 'a: only 'self is allowed as part of a type declaration
[07:00:36] <strcat> that's the arbitrary part
[07:00:50] <gavinb> In that case: fn new(st: uint, ln: uint, ss: &'self str) -> StrRange<'self> works, but how can `self` mean anything in a non-member function?
[07:00:55] <strcat> the only name you can give a type parameter lifetime is 'self
[07:01:07] <strcat> gavinb: it doesn't 'mean' anything
[07:01:15] <strcat> it's just the only name you can give a type parameter
[07:01:28] <gavinb> so in the case of a function parameter, the "self" is the scope of the function itself?
[07:01:34] <strcat> no
[07:01:46] <strcat> I think it's incorrect to do that
[07:02:05] <strcat> the implementation of 'self is very buggy
[07:02:21] <strcat> and it's not a restriction that should exist
[07:03:35] <pnkfelix> gavinb: how about this: https://gist.github.com/pnkfelix/6492300
[07:03:50] <gavinb> All these 'self decls are confusing but seem to be required: impl<'self> StrRange<'self> { fn new(st: uint, ln: uint, ss: &'self str) -> StrRange<'self> { â€¦
[07:04:06] <strcat> gavinb: it's known to be an issue
[07:04:08] <pnkfelix> gavinb: (though I should add a test of that change to the interface)
[07:04:13] <strcat> you should not be required to call it 'self
[07:04:29] <strcat> but the implementation of 'self is very buggy, so you have to be careful to validate it yourself when you use it
[07:04:45] <gavinb> ah ok, wasn't sure if the problem was comprehension, documentation or implementation!
[07:05:07] <glyc> strcat: buggy in that it lets through errors it should not?
[07:05:22] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[07:05:27] *** Quits: squiddy (squiddy@moz-DFB9D31F.adsl.alicedsl.de) (Input/output error)
[07:05:42] <strcat> it allows unsoundness and also hits a lot of ICEs
[07:05:50] <glyc> ICE ?
[07:05:56] <gavinb> pnkfelix: ah, I didn't think it worked until I noticed the "<'a>" you added after "new". Ok, I think I see now.
[07:06:00] <gavinb> ICE == Internal Compiler Error
[07:06:03] <glyc> ah
[07:06:45] <glyc> gavinb: I think that the 'self lifetime in your example is referring only to the lifetime of StrRange
[07:06:49] *** Joins: sk (sk@FBFEDC88.77870B72.78DD174B.IP)
[07:07:10] <glyc> gavinb: does that make sense?
[07:07:41] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:07:50] <gavinb> glyc: yes, I think so - just need to play around with it some more, I think.
[07:08:10] <gavinb> thanks - must dash! BBL
[07:09:50] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[07:13:23] *** flaper87|afk is now known as flaper87
[07:15:57] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Connection reset by peer)
[07:16:35] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[07:17:50] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[07:18:04] *** Joins: z0w0 (zack@moz-E00BA7BC.lnse2.cha.bigpond.net.au)
[07:20:31] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[07:21:21] *** Quits: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Connection reset by peer)
[07:21:42] *** Quits: jdm (jdm@moz-2C5514D1.lightspeed.sntcca.sbcglobal.net) (Quit: Lost terminal)
[07:22:13] *** Joins: tikue (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net)
[07:22:21] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[07:22:49] <strcat> dbaupp: https://github.com/mozilla/rust/pull/9071 r?
[07:22:49] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:23:02] <strcat> I am not entirely sure the existing code to mark ~fn parameters as noalias makes sense though
[07:23:13] <strcat> but it's not harmful...
[07:23:19] <strcat> it's just that they aren't pointers
[07:24:29] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[07:26:09] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:26:09] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144d91447 to 14eae3270: 02http://git.io/N3iJvQ
[07:26:09] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:26:10] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:26:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/KipjIg
[07:26:10] <ghrust> 13rust/06auto 146919cf5 15Daniel Micay: rename `std::iterator` to `std::iter`...
[07:26:10] <ghrust> 13rust/06auto 14d09f569 15bors: auto merge of #9065 : thestinger/rust/iter, r=alexcrichton...
[07:26:11] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:26:53] *** Joins: tikue_ (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[07:26:55] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[07:29:03] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[07:31:40] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:32:49] *** Quits: tikue (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net) (Quit: tikue)
[07:35:50] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[07:39:00] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[07:39:28] *** Joins: Ms2ger (Ms2ger@9C9504FF.4EC82F13.3773EA9F.IP)
[07:39:47] *** Joins: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP)
[07:43:15] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[07:43:39] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[07:44:47] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[07:50:34] *** Joins: bent_ (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP)
[07:51:10] *** Quits: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP) (Ping timeout)
[07:51:22] *** bent_ is now known as bent
[07:54:03] *** Quits: ChrisMorgan (chris@moz-A782B51D.its.monash.edu.au) (Ping timeout)
[07:55:40] *** Joins: bent_ (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP)
[07:56:12] *** Quits: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP) (Ping timeout)
[07:56:32] *** bent_ is now known as bent
[07:57:18] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[07:57:27] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[07:57:35] *** bent is now known as IRCMonkey40422
[07:57:35] *** Joins: JesseH (JesseH@moz-2E766C3E.mc.at.cox.net)
[07:58:40] *** Quits: JesseH (JesseH@moz-2E766C3E.mc.at.cox.net) (Quit: github.com/jessehorne)
[07:58:43] *** Joins: JesseH (JesseH@moz-2E766C3E.mc.at.cox.net)
[07:58:44] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[07:59:08] *** Joins: JesseH2 (JesseH@moz-2E766C3E.mc.at.cox.net)
[07:59:10] *** Quits: JesseH (JesseH@moz-2E766C3E.mc.at.cox.net) (Quit: github.com/jessehorne)
[07:59:16] *** JesseH2 is now known as JesseH
[07:59:47] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[07:59:47] <ghrust> 01[13rust01] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/2J10Vg
[07:59:47] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[08:00:41] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[08:00:45] *** Joins: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP)
[08:00:58] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[08:01:10] *** Quits: IRCMonkey40422 (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP) (Ping timeout)
[08:05:52] *** Joins: bent_ (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP)
[08:06:10] *** Quits: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP) (Ping timeout)
[08:06:11] *** bent_ is now known as bent
[08:07:15] *** bent is now known as IRCMonkey34419
[08:07:39] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[08:08:49] <SingingBoyo> is there a method for sorting vectors?  can't seem to find one in the docs
[08:09:28] <sebcrozet> SingingBoyo: look at the extra::sort module.
[08:15:05] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[08:15:13] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[08:17:51] *** Quits: KindOne (KindOne@630B67F7.B7D17EEE.EC6A1518.IP) (Ping timeout)
[08:21:37] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[08:22:02] *** Joins: KindOne (KindOne@moz-2791A27D.dynamic.ip.windstream.net)
[08:22:59] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[08:24:39] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[08:25:07] *** Quits: KindOne (KindOne@moz-2791A27D.dynamic.ip.windstream.net) (Ping timeout)
[08:27:24] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[08:29:13] <mindcat> rusti: ""
[08:29:14] -rusti- ""
[08:29:42] <mindcat> rusti: ~[1u8,2i16,3f32]
[08:29:45] -rusti- pastebinned 8 lines of output: http://ix.io/7Vx
[08:30:19] <flaper87> rusti: println("Back");
[08:30:20] -rusti- Back
[08:30:20] -rusti- ()
[08:30:28] <flaper87> w0000t, rusti is back
[08:30:29] <flaper87> :D
[08:30:37] *** Joins: KindOne (KindOne@moz-8522362F.dynamic.ip.windstream.net)
[08:31:09] <mindcat> rusti: enum packer {pack1(u8),pack2(i16),pack3(f32)}; ~[pack1(1),pack2(2),pack3(3)]
[08:31:09] -rusti- <anon>:5:82: 5:83 error: mismatched types: expected `f32` but found `<VI2>` (expected f32 but found integral variable)
[08:31:10] -rusti- <anon>:5          enum packer {pack1(u8),pack2(i16),pack3(f32)}; ~[pack1(1),pack2(2),pack3(3)]
[08:31:10] -rusti-                                                                                            ^
[08:31:10] -rusti- error: aborting due to previous error
[08:31:11] -rusti- application terminated with error code 101
[08:31:27] <mindcat> rusti: enum packer {pack1(u8),pack2(i16),pack3(f32)}; ~[pack1(1),pack2(2),pack3(3 as f32)]
[08:31:28] -rusti- ~[pack1(1u8), pack2(2i16), pack3(3f32)]
[08:33:02] <dbaupp> acrichto: has valgrind been fixed?
[08:33:34] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[08:35:14] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[08:36:10] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:36:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/KipjIg
[08:36:10] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:37:28] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[08:38:37] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[08:39:56] <orshem> hi everyone
[08:40:01] <orshem>  is https://github.com/mozilla/rust/pull/9054 done? 
[08:40:40] <dbaupp> orshem: ye
[08:40:41] <dbaupp> s
[08:40:41] <orshem> i'm getting rustc: /home/dr/Dev/rust/src/llvm/lib/IR/Instructions.cpp:1084: void llvm::StoreInst::AssertOK(): Assertion `getOperand(0)->getType() == cast<PointerType>(getOperand(1)->getType())->getElementType() && "Ptr must be a pointer to Val type!"' failed.
[08:40:42] <orshem> Aborted (core dumped)
[08:40:55] <orshem> trying to use it in some code
[08:40:58] <dbaupp> code?
[08:41:15] <orshem> dbaupp: thanks! i see it's yout pr
[08:41:23] <dbaupp> yup :)
[08:41:41] <orshem> i need to narrow it down a bit 
[08:42:01] <dbaupp> rusti: 'foo: for _ in range(0, 10) { break 'foo; }
[08:42:01] -rusti- ()
[08:42:04] <orshem> though it complied fine before i changed a return value to a break from an inner loop
[08:42:17] <orshem> as in nested
[08:42:36] <Amaranth> Would you recommend getting 0.7 if I'm just starting or is master different enough that I'll be relearning a bunch of things later?
[08:43:16] <Ms2ger> No, use master
[08:43:40] <Amaranth> Alright then
[08:43:42] <dbaupp> rusti: 'foo: for _ in range(0, 10) { for _ in range(0, 10) { for _ in range(0, 10) { for _ in range(0, 10) { break 'foo; } } } }
[08:43:42] -rusti- ()
[08:43:57] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[08:44:00] <Ms2ger> Ah, rusti is back?
[08:44:09] <mindcat> rusti: enum packer {pack1(u8),pack2(i16),pack3(f32)}; ~[pack1(1),pack2(2),pack3(3 as f32)]
[08:44:10] -rusti- ~[pack1(1u8), pack2(2i16), pack3(3f32)]
[08:49:16] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[08:49:41] <orshem> sorry was disconnected
[08:50:06] <orshem> rusti: 'foo: for _ in range(0, 10) { for _ in range(0, 10) { break 'foo; } }
[08:50:07] -rusti- ()
[08:50:42] <dbaupp> orshem: are you using `ref` in the pattern?
[08:50:59] <dbaupp> rusti: 'foo: for ref _x in range(0, 10) { for ref _y in range(0, 10) { break 'foo; } }
[08:51:00] -rusti- ()
[08:51:15] <orshem> dbaupp, nope
[08:51:24] <dbaupp> orshem: how long is the code?
[08:51:27] <orshem> one sec
[08:51:33] <orshem> i'm praring a gist
[08:51:44] <orshem> preparing
[08:52:20] *** Joins: Florob (Florob@moz-39532932.de)
[08:56:40] <SimonSapin> kimundi: pong
[08:56:43] <orshem> dbaupp, https://gist.github.com/dovreshef/6493164
[08:56:56] <orshem> sorry that's the smallest i can make in in a minute
[08:57:02] <orshem> *it
[08:57:18] <orshem> you can ignore maze.rs
[08:57:33] <orshem> i think
[08:57:41] <orshem> look at the hunt fn
[09:01:33] <dbaupp> orshem: investigating
[09:01:55] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[09:01:59] <orshem> dbaupp: thanks a lot
[09:03:23] <dbaupp> orshem: ok; it does appear to be something about it; changing the `break 'l` to `return result` makes it compile
[09:03:33] <dbaupp> (but you already knew this :) )
[09:04:25] <SimonSapin> although I understand this is not a productive thing to say, Iâ€™m a bit sad with the state of the documentation :(
[09:05:11] <dbaupp> orshem: and, manually expanding the `for` sugar to the `loop { ... }` syntax gives the same error!
[09:05:18] <Amaranth> SimonSapin: Write some :D
[09:05:28] <dbaupp> SimonSapin: yes :(
[09:07:09] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[09:08:02] <orshem> SimonSapin: i find this channel a veritable source of info available 24/7 :)
[09:08:56] <SimonSapin> yeah, but I canâ€™t ask the channel "tell me everything you know about iterators" and find out there was a better solution to what I was doing
[09:11:55] <orshem> SimonSapin, there is a very nice though bare bones iterator tutorial
[09:12:26] <orshem> and if you can't sleep you can also look at the implementation... though that might make swear off generics
[09:12:29] <SimonSapin> orshem: https://github.com/mozilla/rust/pull/9059/files#r6232910
[09:12:31] <orshem> *you
[09:14:00] <SimonSapin> from_bytes_owned turns out to not even be listed in http://static.rust-lang.org/doc/std/str.html , even though it does have inline documentation
[09:14:18] * Ms2ger sure is forgetting a lot of semicolons
[09:15:49] <dbaupp> SimonSapin: oops, I forgot it got renamed to from_utf8_owned
[09:15:58] <SimonSapin> oh
[09:16:21] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[09:16:23] <SimonSapin> and I checked the sources on my "old" local clone
[09:19:21] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:21:38] *** Joins: squiddy (squiddy@moz-5ECE7F49.adsl.alicedsl.de)
[09:21:53] <Amaranth> Alright so apparently mono installs its own incompatible libtool in a place that ended up in my $PATH, fun times
[09:23:25] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[09:25:05] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[09:25:37] <SingingBoyo> is there a way to get the file descriptor for a writer?  Or more specifically stdout?
[09:25:59] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[09:30:52] *** Joins: nathan7 (nathan@86F860FE.3CD03790.F113998C.IP)
[09:33:13] *** IRCMonkey34419 is now known as bent
[09:34:54] *** Joins: Earnestly (earnest@moz-BE290A2B.dyn.plus.net)
[09:36:09] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:36:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/JSEtXA
[09:36:09] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:36:11] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[09:36:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/I_eb4g
[09:36:11] <ghrust> 13rust/06auto 14500077f 15Alex Crichton: Remove hacks around issues in local_data...
[09:36:11] <ghrust> 13rust/06auto 14fd49f6d 15bors: auto merge of #9073 : alexcrichton/rust/remove-local-data-hax, r=huonw...
[09:36:11] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[09:36:34] <SimonSapin> SingingBoyo: 1
[09:37:01] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[09:43:57] *** Quits: pyrac (pyrac@3907364F.73C89388.AD05C589.IP) (Quit: pyrac)
[09:44:56] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[09:50:55] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Quit: ZNC - http://znc.in)
[09:51:27] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[09:52:12] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Client exited)
[10:00:59] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Quit: Konversation terminated!)
[10:12:45] <mindcat> rusti: "1" * 2
[10:12:46] -rusti- <anon>:5:9: 5:16 error: binary operation * cannot be applied to type `&'static str`
[10:12:46] -rusti- <anon>:5          "1" * 2
[10:12:46] -rusti-                   ^~~~~~~
[10:12:47] -rusti- error: aborting due to previous error
[10:12:47] -rusti- application terminated with error code 101
[10:13:10] <mindcat> why is not "11"
[10:13:26] <Ms2ger> rusti: "1".repeat(2)
[10:13:27] -rusti- ~"11"
[10:13:27] <nmatsakis> cmr: no meeting last week
[10:13:51] <mindcat> Ms2ger: ok, I see
[10:14:19] <mindcat> rusti: "asdfgz".repeat(5)
[10:14:20] -rusti- ~"asdfgzasdfgzasdfgzasdfgzasdfgz"
[10:16:09] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[10:17:34] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[10:22:22] *** Quits: StarLight (StarLight@moz-72FE98FE.dynamic.avangarddsl.ru) (Ping timeout)
[10:23:57] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[10:25:37] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[10:26:07] *** Quits: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP) (Input/output error)
[10:26:48] *** Joins: StarLight (StarLight@moz-2CF73E94.dynamic.avangarddsl.ru)
[10:29:32] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[10:29:53] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[10:31:33] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:32:29] <dbaupp> nmatsakis: ping
[10:33:08] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[10:36:08] *** Quits: valenting (Thunderbir@BC8F8C4C.4ABED146.FB866788.IP) (Ping timeout)
[10:36:15] *** Joins: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca)
[10:37:27] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:41:00] *** Quits: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca) (Connection reset by peer)
[10:41:02] *** Joins: maxli1 (maxli@moz-88B00BB3.net.uwaterloo.ca)
[10:45:30] <nmatsakis> dbaupp: pong
[10:45:51] <mindcat> dbaupp: ping
[10:45:52] *** Quits: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr) (Quit: Gone)
[10:46:08] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[10:46:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/I_eb4g
[10:46:08] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[10:47:44] <dbaupp> nmatsakis: doesn't matter; I had a question about https://github.com/mozilla/rust/issues/6785#issuecomment-24060661, but I've worked out why your comment and my expectation didn't match (as expected, you were right)
[10:47:47] <dbaupp> mindcat: pong
[10:49:33] <mindcat> dbaupp:  :D
[10:50:43] * dbaupp hugs mindcat
[10:52:02] * mindcat hugs dbaupp 
[10:53:03] *** Quits: maxli1 (maxli@moz-88B00BB3.net.uwaterloo.ca) (Quit: Leaving.)
[10:53:32] *** Joins: fyolnish (fyolnish@moz-E4E45F5C.uqwimax.jp)
[10:57:50] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:58:02] <flaper87> nmatsakis: ping
[10:58:21] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[10:59:09] <flaper87> nmatsakis: I thought the same about https://github.com/mozilla/rust/issues/9056 
[10:59:20] <flaper87> nmatsakis: is there something else I can do to help verifying it?
[10:59:33] <flaper87> nmatsakis: Where should I look if I'd like to help fixing it?
[11:05:32] <kimundi> SimonSapin: pong, but the question already got answered in #9059 :)
[11:06:06] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[11:07:54] *** Joins: a_m0d|home (a_m0d@D48394B8.4F7357CA.6D7C4B99.IP)
[11:08:07] <SimonSapin> kimundi: ok, cool
[11:16:30] *** Quits: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru) (Ping timeout)
[11:16:55] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[11:17:12] *** Joins: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru)
[11:19:30] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[11:22:02] *** Parts: z0w0 (zack@moz-E00BA7BC.lnse2.cha.bigpond.net.au) ()
[11:24:31] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[11:25:03] *** Joins: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca)
[11:26:11] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[11:26:13] <kimundi> r+ anyone? https://github.com/mozilla/rust/pull/9059
[11:30:28] <dbaupp> kimundi: does (yet another) comment count? :)
[11:30:54] <SimonSapin> kimundi: looks good to me, but I donâ€™t have the relevant privilege
[11:30:56] *** Quits: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca) (Ping timeout)
[11:31:05] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[11:31:07] <kimundi> dbaupp: comment away :P
[11:31:48] *** Joins: pyrac (pyrac@3907364F.73C89388.AD05C589.IP)
[11:32:07] * dbaupp comments off into the distance
[11:33:23] <mindcat> rusti: "aaaabbbb".to_ascii_upper()
[11:33:23] -rusti- <anon>:5:9: 6:5 error: type `&'static str` does not implement any method in scope named `to_ascii_upper`
[11:33:24] -rusti- <anon>:5          "aaaabbbb".to_ascii_upper()
[11:33:24] -rusti- <anon>:6     };
[11:33:24] -rusti- error: aborting due to previous error
[11:33:24] -rusti- application terminated with error code 101
[11:33:55] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[11:34:23] <SimonSapin> rusti: use std::ascii::StrAsciiExt; "aaaabbbb".to_ascii_upper()
[11:34:24] -rusti- ~"AAAABBBB"
[11:34:35] *** Quits: Jontte (joonas@moz-8B229CD6.la) (Ping timeout)
[11:34:38] <SimonSapin> rusti: use std::ascii::StrAsciiExt; "aÃ Ã¤abbbb".to_ascii_upper()
[11:34:39] -rusti- ~"A\xe0\xe4ABBBB"
[11:34:43] <dbaupp> rusti: use std::ascii::StrAsciiExt; "Ã¶Ã¤Ã¥Å‹Ä‘Å‹ÂªÃŸÃ°Ä‘jÄ§jÄ§".to_ascii_upper()
[11:34:44] -rusti- ~"\xf6\xe4\xe5\u014b\u0111\u014b\xaa\xdf\xf0\u0111J\u0127J\u0127"
[11:34:55] <dbaupp> rusti: use std::ascii::StrAsciiExt; print("Ã¶Ã¤Ã¥Å‹Ä‘Å‹ÂªÃŸÃ°Ä‘jÄ§jÄ§".to_ascii_upper())
[11:34:56] -rusti- Ã¶Ã¤Ã¥Å‹Ä‘Å‹ÂªÃŸÃ°Ä‘JÄ§JÄ§()
[11:34:58] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:35:13] <mindcat> rusti: use std::ascii::StrAsciiExt; "aaaaè¿™æœ‰é—®é¢˜bbbb".to_ascii_upper()
[11:35:14] -rusti- ~"AAAA\u8fd9\u6709\u95ee\u9898BBBB"
[11:35:55] <mindcat> rusti: use std::ascii::StrAsciiExt; println("aaaaè¿™æœ‰é—®é¢˜bbbb".to_ascii_upper())
[11:35:57] -rusti- AAAAè¿™æœ‰é—®é¢˜BBBB
[11:35:57] -rusti- ()
[11:36:36] <mindcat> alright, no problem :D
[11:38:30] *** Quits: a_m0d|home (a_m0d@D48394B8.4F7357CA.6D7C4B99.IP) (Quit: Leaving.)
[11:39:09] <dbaupp> rusti:  use std::ascii::StrAsciiExt; let s = "a\u0308"; println(s); println(s.to_ascii_upper());
[11:39:10] -rusti- aÌˆ
[11:39:10] -rusti- AÌˆ
[11:39:10] -rusti- ()
[11:40:21] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[11:43:04] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[11:44:28] <kimundi> dbaupp: Commented on the issue
[11:44:32] <kimundi> err, PR
[11:45:44] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:45:45] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[11:47:46] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:48:11] <dbaupp> kimundi: sounds good, r+
[11:48:27] <kimundi> 'kay
[11:50:50] *** jorendorff_away is now known as jorendorff
[11:51:08] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:51:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/opdjRg
[11:51:09] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:51:16] *** Quits: sk (sk@FBFEDC88.77870B72.78DD174B.IP) (Ping timeout)
[11:53:45] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[11:57:58] <bjz_> dbaupp: any idea how that bsd bot is going?
[11:58:25] <bjz_> my PR still isn't happy. maybe it's something about my stuff?
[11:58:35] <bjz_> https://github.com/mozilla/rust/pull/9051
[12:00:33] <dbaupp> bjz_: it seems unlikely that'd effect those failures; and anyway the bsd one is known, and I've seen the fileinput failures before too
[12:00:50] <bjz_> mmk
[12:01:53] * dbaupp files a bug about fileinput
[12:06:55] *** Joins: sebcrozet (sebcrozet@moz-3CE49532.lrde.epita.fr)
[12:07:23] *** Joins: Jontte (joonas@moz-8B229CD6.la)
[12:07:52] *** Quits: Jontte (joonas@moz-8B229CD6.la) (Client exited)
[12:07:58] <dbaupp> bjz_: https://github.com/mozilla/rust/issues/9074
[12:08:02] <dbaupp> (fwiw)
[12:11:51] *** Joins: sk (sk@273FD846.E993C7C3.78DD174B.IP)
[12:14:34] *** jorendorff is now known as jorendorff_away
[12:19:32] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:21:00] *** Joins: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca)
[12:21:23] *** Quits: maxli (maxli@moz-88B00BB3.net.uwaterloo.ca) (Input/output error)
[12:21:28] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:22:31] *** jorendorff_away is now known as jorendorff
[12:24:26] *** Joins: squiddy_ (squiddy@moz-72F4AAF0.adsl.alicedsl.de)
[12:24:32] *** Quits: squiddy (squiddy@moz-5ECE7F49.adsl.alicedsl.de) (Ping timeout)
[12:25:10] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[12:26:06] *** Quits: squiddy_ (squiddy@moz-72F4AAF0.adsl.alicedsl.de) (Ping timeout)
[12:26:50] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[12:26:54] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[12:34:35] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[12:34:46] *** Joins: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com)
[12:35:21] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[12:35:37] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:36:24] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[12:36:39] *** Joins: maxli (maxli@moz-31E16B62.net.uwaterloo.ca)
[12:38:24] <HollyRain> does Rust has or is going to have a "system" to load libraries at run time?
[12:38:57] *** Quits: reyre (reyre@moz-89E9865B.com) (Quit: ZNC - http://znc.in)
[12:38:57] *** Joins: maxli1 (maxli@moz-31E16B62.net.uwaterloo.ca)
[12:39:03] *** Quits: maxli (maxli@moz-31E16B62.net.uwaterloo.ca) (Connection reset by peer)
[12:39:26] <kimundi> It currently kinda has, and it likely will have a fully operational one in the future.
[12:39:41] <kimundi> std::Dylib or extra::dylib I think
[12:39:57] *** Joins: reyre (reyre@moz-89E9865B.com)
[12:40:28] *** Quits: maxli1 (maxli@moz-31E16B62.net.uwaterloo.ca) (Quit: Leaving.)
[12:40:38] <HollyRain> kimundi, cool, so it can be used to link Rust code as plugins, right?
[12:40:49] <engla> I don't think is code to dynamically load rust crates
[12:42:25] <dbaupp> kimundi: std::unstable::dynamic_lib
[12:42:44] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[12:42:59] <dbaupp> HollyRain: it allows one to load and call a function from a shared library (including e.g. C ones)
[12:43:27] <dbaupp> but it's ridiculously unsafe, there needs to be a higher level wrapper for Rust crates
[12:43:58] <engla> also since it's inside std::unstable it's experimental
[12:45:07] <HollyRain> dbaupp, whether the Rust guys want safe execution, there is vx32 (https://code.google.com/p/vx32/) which could be used like inspiration
[12:46:13] <HollyRain> although I don't know if it also could be done in ARM processors
[12:47:13] <dbaupp> HollyRain: I was just meaning unsafe in the sense there's literally no guarantees that the symbol you're loading as a function is actually a function, and that it actually has a certain type
[12:47:35] <dbaupp> in theory, one could load a rust crate and parse the metadata to get this information at a rust-type-level
[12:48:16] <dbaupp> (this is a separate issue to sandboxed execution, which could apply to both loading arbitrary libraries and loading rust crates)
[12:50:17] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[12:50:30] <engla> pnkfelix: regarding IterBytes not sure if it's meant to be a limitation. But right now it's impossible to combine this Hash impl with any other:  impl<A:IterBytes> Hash for A 
[12:50:35] <engla> it would be in the future IIUC
[12:52:05] <HollyRain> dbaupp, I cann't find the code: http://static.rust-lang.org/doc/std/index.html
[12:52:25] <dbaupp> HollyRain: std::unstable is hidden from the documentation, so you'll have to read the source
[12:52:33] <dbaupp> https://github.com/mozilla/rust/blob/master/src/libstd/unstable/dynamic_lib.rs
[12:53:39] <dbaupp> or use the documentation generator that ignores doc(hidden): http://seld.be/rustdoc/master/std/unstable/dynamic_lib/struct.DynamicLibrary.html
[12:56:34] <dbaupp> rusti: unsafe { let lib = std::unstable::DynamicLibrary::open(None).unwrap(); let func = lib.symbol::<extern "Rust" fn()>("_rust_main").unwrap(); func() }
[12:56:45] -rusti- pastebinned 11 lines of output: http://ix.io/7VC
[12:57:32] <dbaupp> rusti: unsafe { let lib = std::unstable::dynamic_library::DynamicLibrary::open(None).unwrap(); let func = lib.symbol::<extern "Rust" fn()>("_rust_main").unwrap(); func() }
[12:57:35] -rusti- pastebinned 11 lines of output: http://ix.io/7VD
[12:57:48] <dbaupp> rusti: unsafe { let lib = std::unstable::dynamic_lib::DynamicLibrary::open(None).unwrap(); let func = lib.symbol::<extern "Rust" fn()>("_rust_main").unwrap(); func() }
[12:57:49] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[12:59:42] *** Joins: squiddy (squiddy@moz-517A67FD.adsl.alicedsl.de)
[13:01:09] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:01:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/aXwXvQ
[13:01:09] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:03:18] *** Joins: nik_ (nik@moz-7CEF7C9D.pool.mediaways.net)
[13:03:29] *** Quits: nkoep (nik@moz-B585261.pool.mediaways.net) (Ping timeout)
[13:04:29] <kimundi> dbaupp: Hm, if you would dynamically load a crate you'd be only able to call standalone functions and use trait objects that use types in their signatures that are known to your crate at compile time, right?
[13:06:06] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:06:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/d_fEyg
[13:06:06] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[13:06:07] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:06:07] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/a41sKA
[13:06:07] <ghrust> 13rust/06auto 140fcb859 15Brendan Zabarauskas: Moved checked trait impls out of std::num...
[13:06:07] <ghrust> 13rust/06auto 148445009 15Brendan Zabarauskas: Add Clone and DeepClone constraints to Primitive trait
[13:06:08] <ghrust> 13rust/06auto 142c31053 15Brendan Zabarauskas: Fix unused import warnings on 32bit systems
[13:06:10] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:06:17] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Ping timeout)
[13:06:25] <dbaupp> kimundi: you might be able to load types from external crates too (or something)... it's unclear to me how interaction you could do with a value of a type known only at runtime-only would be (i.e. the actual structure of the type, not *just* dynamically typed).
[13:06:38] <dbaupp> kimundi: basically, yes.
[13:07:22] <HollyRain> which would be the best way to embed a language like Go in Rust?
[13:07:26] <HollyRain> (a) Since the Go compilers are written in C, it could be wrapped the functions for compiling and linking, (b) to call directly to the binaries to compile, link, and a last call to run the final binary, (c) create a VM but it takes a lot of memory and effort to be developed
[13:07:59] *** Quits: nik_ (nik@moz-7CEF7C9D.pool.mediaways.net) (Ping timeout)
[13:08:05] <kimundi> I'm imagining something like: fn load_fn<T>(file, module_path) -> T; let f = load_fn::<extern fn(uint, uint) -> ~str>("foo.so", "somemod::foo::barfn");
[13:08:25] <cmr> HollyRain: You want to embed Go by *source*?
[13:08:37] *** Joins: novabyte (Instantbir@91FFDEC6.3F2319E2.EFEA2F8E.IP)
[13:08:52] <doomlord> compile go to rust ? :)
[13:09:18] <cmr> The sane thing to do would be compile to a library and expose a C ABI, and call it from Rust like a normal extern.
[13:09:28] <HollyRain> cmr, yes, like would be into a script language like Lua
[13:09:37] <kimundi> And then a combination of intrinsics and runtime checks would result in a specialized load_fn instance that dynamically checks if the symbol you're trying to access matches the type it has been specialized with
[13:09:47] <dbaupp> kimundi: loading from a rust crate, you mean?
[13:09:54] <kimundi> yeah
[13:09:57] <cmr> HollyRain: Go isn't a scripting language at all. It wasn't designed for it and it's not very suitable for it.
[13:10:00] <Amaranth> cmr: Go forces you to go the other way
[13:10:11] <dbaupp> kimundi: but yeah, I'd agree with that; it checks the metadata to match the type you specify
[13:10:18] <Amaranth> You'd have to write something in Rust with a C ABI that you can wire up to go via cgo
[13:10:19] *** Quits: novabyte (Instantbir@91FFDEC6.3F2319E2.EFEA2F8E.IP) (Ping timeout)
[13:11:01] <HollyRain> cmr, Go would be a great language for the user interface code  of a game, that's my idea
[13:11:02] <dbaupp> Amaranth: are you saying you can't get a go lib to expose a C abi?
[13:11:12] <Amaranth> dbaupp: As far as I know you cannot
[13:12:07] <dbaupp> Amaranth: :(
[13:12:21] <Amaranth> Go doesn't even actually have libraries, at least right now. You have to feed it the source code for everything you're using and out the other end comes a statically compiled application
[13:12:39] *** Joins: novabyte (Instantbir@91FFDEC6.3F2319E2.EFEA2F8E.IP)
[13:12:47] <cmr> HollyRain: I don't follow the logic behind that, but good luck
[13:13:49] <dbaupp> Amaranth: ah, right; that would make it very hard to create a C-abi lib (not having libs at all)
[13:13:55] <Seldaek> HollyRain: I'd think embedding Lua would be an easier way to do higher level UI programming
[13:14:29] <Amaranth> Lua is the go to embedded language
[13:15:10] * kimundi would like to have a lua-rust mix: still the same table-based universal/dynamic data structures, but less garbage collected and more linear types
[13:15:15] <Seldaek> also I don't think Go is so much higher level than rust that it'd make much sense to "embed" it for UI
[13:15:30] <doomlord> i was thinking that myself - could a relaxed subset of rust be interpreted
[13:16:05] *** Joins: feduser (feduser@1FEEBA37.894E1D07.8D466B92.IP)
[13:16:27] <dbaupp> Seldaek: it's a weird mix of higher and lower (e.g. still having null pointers and all that)
[13:16:39] <dbaupp> (at least, what I've seen of Go)
[13:16:40] <doomlord> 'relaxed' -> leave off the types in signatures = full duck typing for interpreted scripts
[13:16:53] <HollyRain> Amanieu, I just question about whether a Go package to expose a C abi? the answer:
[13:16:55] <HollyRain> yes, but ABI is not guaranteed to stable between minor releases
[13:18:35] <Amanieu> Amaranth: ^ That's probably for you
[13:18:42] <Amaranth> I _think_ gccgo will let you do such things but gccgo is the slower buggy forgotten cousin
[13:19:16] <Amaranth> And iirc one of the main reasons it works there is because gccgo doesn't implement segmented stacks
[13:20:25] <Amaranth> Segmented stacks and an M:N threading model make interfacing with other languages complicated as I'm sure some folks here can tell you all about
[13:22:09] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[13:24:04] *** Joins: nik_ (nik@moz-E9A65FB8.vpn.rwth-aachen.de)
[13:25:45] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[13:27:25] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[13:32:40] <pnkfelix> engla: Yeah I should have realized that; thanks.  I also do not know whether the limitation is intended to stay, so I'm thinking I'll leave the ticket...
[13:34:30] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[13:35:41] *** Joins: jdsanders (Adium@moz-8527430D.hlrn.qwest.net)
[13:36:07] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[13:37:11] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[13:37:41] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[13:38:47] *** Quits: eagen (eagen@8737942B.7A99C13A.B7961A98.IP) (Quit: Leaving)
[13:40:43] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[13:41:06] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:45:58] *** Joins: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net)
[13:47:02] *** Quits: nik_ (nik@moz-E9A65FB8.vpn.rwth-aachen.de) (Ping timeout)
[13:49:55] *** Joins: aeqwa (aeqwa@moz-BE4E81CD.dsl.tropolys.de)
[13:50:24] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:54:51] <flaper87> nmatsakis: ping
[13:57:27] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[13:59:04] *** Quits: sk (sk@273FD846.E993C7C3.78DD174B.IP) (Quit: Leaving)
[14:00:40] *** Joins: squiddy_ (squiddy@moz-CD26F336.adsl.alicedsl.de)
[14:00:55] *** Quits: squiddy (squiddy@moz-517A67FD.adsl.alicedsl.de) (Ping timeout)
[14:01:08] *** Joins: nik_ (nik@moz-7CEF7C9D.pool.mediaways.net)
[14:02:16] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[14:02:52] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[14:03:49] *** Joins: huseby (huseby@moz-633A76FB.static.cust.telenor.com)
[14:04:36] <engla> dbaupp: r? https://github.com/mozilla/rust/pull/9076 you asked for this testcase
[14:04:37] *** Quits: novabyte (Instantbir@91FFDEC6.3F2319E2.EFEA2F8E.IP) (Quit: bye bye)
[14:06:18] <dbaupp> engla: awesome
[14:06:30] *** Quits: HollyRain (HollyRain@moz-50A83091.dyn.user.ono.com) (Quit: bye, bye)
[14:07:11] <dbaupp> engla: btw, if you have `Fixes #....` in the commit message/pr then github will automatically close that issue (i edited it in to the pr text)
[14:08:01] *** Quits: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru) (Quit: Leaving.)
[14:08:14] <engla> ok nice
[14:08:33] *** Joins: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru)
[14:11:07] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[14:11:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/a41sKA
[14:11:07] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[14:11:09] *** Joins: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP)
[14:11:22] *** Quits: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[14:11:28] <SimonSapin> Are algebraic data types the same as tagged unions? (And the same as Rust enums?)
[14:12:32] <dbaupp> bjz_: it landed, finally!
[14:12:49] <bjz_> huzzah!
[14:13:07] <bjz_> dbaupp: not that it was that groundbreaking or anything :)
[14:13:07] <kimundi> SimonSapin: They are not "the same" in the same sense that "twos complement addition" is not the same as "algebra over natural number"
[14:13:16] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[14:13:29] <dbaupp> bjz_: yeah, but it took 5 retries! :(
[14:13:43] <dbaupp> kimundi: in what way?
[14:13:45] <SimonSapin> kimundi: so, a concept and an implementation of that concept?
[14:14:08] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:14:22] <kimundi> SimonSapin: the implementation of a subset of an cincept :)
[14:14:47] <kimundi> an rust enum is implemented as an tagged union (usually, optimisations can change the tag)
[14:14:58] <kimundi> and an rust enum represents an sum type
[14:15:09] <SimonSapin> oh wait, ok. "Algebraic" is product types and sum types. Tagged unions are sum types
[14:15:11] <kimundi> an sum type is part of the set of algebraic data types
[14:15:25] <kimundi> right
[14:15:30] <SimonSapin> cool
[14:15:46] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[14:15:57] <dbaupp> tuples/structs are product types
[14:16:07] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[14:16:07] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/V2VKsA
[14:16:07] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[14:16:09] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:16:09] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/tAGtGw
[14:16:09] <ghrust> 13rust/06auto 145ecd3b4 15blake2-ppc: Add test for issue #8587, about calling nested functions of the same name
[14:16:09] <ghrust> 13rust/06auto 14233aae6 15bors: auto merge of #9076 : blake2-ppc/rust/test-for-8585, r=huonw...
[14:16:10] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:16:17] <SimonSapin> Iâ€™m preparing a Rust talk, and trying to figure out which terms to use
[14:16:24] <SimonSapin> (twist: in French.)
[14:16:48] <kimundi> good luck! :)
[14:16:49] <dbaupp> using algebraic data type to describe rust enums would be fine
[14:17:21] <SimonSapin> dbaupp: technically correct, but maybe not the right term for the audience
[14:17:23] <kimundi> but rusts whole type system is based n algebraic data types
[14:18:02] <dbaupp> SimonSapin: ok :) (good luck)
[14:18:10] <olsonjeffery> SimonSapin: i don't know your audience, but the c-equiv to rust enums would be tagged unions
[14:18:20] <SimonSapin> thanks
[14:18:27] <SimonSapin> olsonjeffery: Iâ€™ll probably use that
[14:18:46] <olsonjeffery> SimonSapin: also, thought a bit about our last conversation
[14:18:57] <olsonjeffery> and i agree on your point about keeping the encoding trait(s) separate from io
[14:19:14] <olsonjeffery> maybe Encoder<T>, where T would be something like u8 or u16 based on the codec
[14:19:31] <SimonSapin> what would T do?
[14:19:57] <olsonjeffery> represent the size of a code point
[14:20:34] <SimonSapin> I... am not sure that makes sense
[14:20:35] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bb2m)
[14:20:44] <olsonjeffery> SimonSapin: ok. then what would recommend?
[14:20:47] <SimonSapin> you need 21 bits for code points
[14:20:50] <olsonjeffery> im kind of reaching out to you for feedback
[14:20:58] <olsonjeffery> and you're not really giving me anything besides "no, that's wrong.
[14:21:09] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[14:21:13] <olsonjeffery> so, something constructive, with the foregone conclusion that we have to pull *something* into std, would be very helpful
[14:21:16] <SimonSapin> unless you use utf-8 or utf-16 or something else, but these are not code points
[14:21:20] <SimonSapin> (let me finish!)
[14:21:47] * olsonjeffery listens
[14:23:22] <olsonjeffery> and yes, i misspoke, i meant the size of raw byte/multi-byte input. like the existing utf16 fns in std use u16, vs u8 for utf8 (when taking raw input).
[14:23:36] <SimonSapin> encoding convert between bytes and "text". Bytes are obviously [u8] (as in IO), and you could have various internal representations of text
[14:24:29] <SimonSapin> the idiomatic representation of text in Rust (for current values of "Rust") is str, which uses UTF-8 internally
[14:24:55] <engla> and char for a codepoint
[14:25:06] *** Quits: nik_ (nik@moz-7CEF7C9D.pool.mediaways.net) (Ping timeout)
[14:25:11] <SimonSapin> Because of JavaScript Servo may need to UTF-16 internally for text
[14:25:14] <SimonSapin> engla: yes.
[14:25:56] <bstrie> how considerate of these spammers to literally put the string "***SPAM***" in the title of their emails
[14:26:09] <SimonSapin> well, "native-endian UTF-16", even. ie [u16]
[14:26:16] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[14:26:51] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[14:26:59] *** Joins: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP)
[14:27:02] <SimonSapin> Using u16 is a very specific case, and itâ€™s used for "text"
[14:27:04] <bstrie> how about Utf8 and Utf16 as library types, and str is just a synonym for Utf8 :P
[14:27:11] *** Quits: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[14:27:25] <SimonSapin> weâ€™d still need to support both UTF-16-LE and UTF-16-BE, which are bytes
[14:27:43] <bstrie> ugh, endianness
[14:27:47] <SimonSapin> yeah :/
[14:27:56] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[14:27:58] <bstrie> let's just pretend that doesn't exist :)
[14:28:02] <Ms2ger> bstrie, we just talked about str being utf-8 in #servo, fwiw :)
[14:29:00] <bstrie> while we're at it, let's get rid of the term "string"
[14:29:04] <SimonSapin> olsonjeffery: so, to go back to the original point. There are different ways to represent "text", but this should not vary based on the encoding
[14:29:26] * olsonjeffery nods
[14:29:57] <SimonSapin> I like Rustâ€™s str as it currently as, eg. "text" uses UTF-8 internally
[14:29:58] <olsonjeffery> so would the decoding always be Iterable<u8> -> <T: Text> ?
[14:30:29] <SimonSapin> olsonjeffery: yes, thatâ€™s the theoretical model
[14:30:40] <olsonjeffery> (note that im using Iterable<u8> here instead of [u8] because we can represent an endless stream at Iterable<u8>, eg reading from tcp sockets)
[14:30:48] <olsonjeffery> or do yielding, etc
[14:31:04] <olsonjeffery> in the theoretical future of CPS-support in rust..
[14:31:16] <SimonSapin> olsonjeffery: but in practice it might be better to use Iterable<[u8]> for efficiency
[14:31:26] * olsonjeffery nods
[14:31:30] <olsonjeffery> true.
[14:31:31] <SimonSapin> olsonjeffery: and Iâ€™m not sure Text should be generic in actual code
[14:31:56] <olsonjeffery> well if Text, a notional super trait of utf8 and utf16, existed.. it would probably be compiler optimized
[14:32:02] *** Joins: jstevans (Instantbir@4EB64216.D41652FF.DDE5D3F6.IP)
[14:32:03] <olsonjeffery> im just spitballing
[14:32:15] <olsonjeffery> brainstorming, even
[14:32:53] <SimonSapin> hum, maybe a generic Text is more realistic that I first though
[14:33:02] <SimonSapin> at least for encodings
[14:33:31] *** Parts: jdsanders (Adium@moz-8527430D.hlrn.qwest.net) ()
[14:33:40] *** Parts: lex (lex@moz-12347B81.bootp.virginia.edu) ()
[14:34:00] <SimonSapin> I donâ€™t know about other code that manipulate strings, eg. URL parsing
[14:34:37] <olsonjeffery> ok. so this is largely how rust-encoding is working, atm..
[14:35:02] <SimonSapin> AFAIU rust-encoding just uses str for text
[14:35:14] <olsonjeffery> so maybe we just pull in the Encoding, etc traits and looking at how they're laid out to see if changes are needed (hoping not)
[14:35:41] <olsonjeffery> SimonSapin: indeed it does.. we have to live int he realm of the possible. making a Text trait is a core lang feature, of which we have vanishingly little time for.
[14:36:00] <olsonjeffery> so im working off of the assumption that an initial landing in the std tree would just use str unless its absolutely unworkable
[14:36:32] <olsonjeffery> and feed() just returns an Option<CodeError>
[14:36:38] <olsonjeffery> w/ None for total success
[14:36:46] <olsonjeffery> and Some where for an error and the remaining, unprocess bytes
[14:36:54] <olsonjeffery> (i guess to be pepended into the next feed call?)
[14:36:59] <olsonjeffery> prepended, even
[14:37:16] <olsonjeffery> assuming the issue was because of an inopportune stream boundary?
[14:37:25] <SimonSapin> a Text trait that does just enough for rust-encoding (probably not much more than .push_char() and .iter_chars()) seems easy enough
[14:37:38] <SimonSapin> making it useful for general text-processing code is another story
[14:37:43] <engla> decoding into ~str is basically a [u8] -> [u8] operation
[14:38:00] <kimundi> This is again an situation where custom DST would be very nice... Could just define a str_utf16 and such...
[14:38:47] <SimonSapin> olsonjeffery: then there is also error handling, which Iâ€™m not super happy with in current rust-encoding
[14:39:32] <olsonjeffery> the CodecError approach, you mean?
[14:39:36] *** Quits: pyrac (pyrac@3907364F.73C89388.AD05C589.IP) (Quit: pyrac)
[14:39:38] <SimonSapin> yes
[14:40:16] <SimonSapin> two things
[14:41:06] <SimonSapin> Iâ€™d like a feed/flush API (as opposed to "decode a whole string") which what rust-encoding calls "traps"
[14:41:35] <SimonSapin> ie. specify the type of error handling at initialization
[14:41:55] <SimonSapin> and second, whatâ€™s in CodecError itself
[14:42:50] <SimonSapin> for example, do decode errors really need the whole problematic byte sequence, or can we get away with just "there is an error"?
[14:44:00] <Amaranth> Some pointer to what and/or where the error is would be nice I think
[14:44:31] <olsonjeffery> does CodecError give you everything that successfully decoded up until the error/
[14:44:41] <engla> SimonSapin: some users will want to replace each invalid byte with something?
[14:45:24] <SimonSapin> engla: python has this "surrogate escape" thing that allow invalid bytes sequences to round-trip though Unicode
[14:45:42] <engla> something like that
[14:46:00] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[14:46:31] *** Joins: pyrac (pyrac@moz-C411EA77.math.u-bordeaux1.fr)
[14:46:36] <SimonSapin> I feel like itâ€™s a bad idea, but I donâ€™t have a better solution to what it solves
[14:47:09] <SimonSapin> that is, writing cross-platform code that deals with filesystem APIs, which on some systems are based on bytes and on others on Unicode
[14:47:20] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:47:30] <engla> that is a headache
[14:48:30] <engla> Also for UTF-8 there are recommendations on how to insert the replacement char on invalid input, hopefully the error handling api makes that possible to follow
[14:49:30] <SimonSapin> yes, for replacement characters the error handling only needs to know "there was an error"
[14:50:08] <engla> once for each position where a replacement char should be inserted
[14:50:39] <SimonSapin> every time the error handling function is called, which is up to the decoder implementation
[14:51:15] <SimonSapin> which is specified in http://encoding.spec.whatwg.org/ (putting aside whatwg.org being down at the moment)
[14:53:29] *** Quits: huseby (huseby@moz-633A76FB.static.cust.telenor.com) (Quit: Leaving)
[14:54:03] <SimonSapin> the WHATWG Encoding spec only specifies the fixed set of types of error handling thatâ€™s needed for the way. Iâ€™m not decided on how open-ended rust-encoding should be
[14:54:09] <SimonSapin> (or its libstd equivalent)
[14:54:21] <Florob> ï¿½
[14:57:19] <SimonSapin> Going back to text representation: we just discussed this in #servo, and it seems that either Servo will need to duplicate tons of libraries to use a different string type, or Rust should change str to be UTF-16 internally
[14:57:26] <SimonSapin> both of which seem bad
[14:57:44] <ruediger> please no UTF-16 inside rust
[14:58:02] <Ms2ger> Tough.
[14:58:24] <SimonSapin> I donâ€™t know how realistic it is to use a generic Text trait
[14:58:25] <Ms2ger> Please no blanket statements without understanding the tradeoffs
[14:58:35] <SimonSapin> eg. for URL parsing
[14:58:39] <kimundi> we need a str_utf16 that is implemented just as str, and a std lib that is implemented with traits for both of them, maybe?
[14:58:51] <ruediger> maybe there could be a generic way to handle it.  But default utf-16 internally in rust would be a bad thing.
[15:00:46] <bstrie> ruediger: we're committed to utf8
[15:00:54] <ruediger> good
[15:01:13] *** Joins: echristo (echristo@4241698A.2E4FD3DD.225F4543.IP)
[15:02:26] <SimonSapin> bstrie: how do you feel about having Str16 in addition, and traits for code that wants to be generic?
[15:02:30] <engla> just some months ago, ~str was very loose in utf8 interpretation. now it's strict and close to correct (I hope)
[15:02:49] <SimonSapin> (I realize this would be a lot of work)
[15:03:25] <bstrie> SimonSapin: you'll have to ask the devs, I expect they'll be pretty sympathetic. I was just addressing the fear that we wouldn't be utf8 internally, which is unfounded
[15:03:26] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[15:04:30] <kimundi> implement unsized types -> implement ability to newtype [T] -> implement str and str_utf16 as library types -> rewrite string library to share as much functionality between both types as possible with the use of traits and generic code
[15:06:05] <engla> kimundi: how do slices fit in? That's the critical language support you want to retain I think
[15:06:31] <SimonSapin> engla: youâ€™d need associated types I suppose
[15:06:33] <kimundi> engla: If you can newtype [T], slices would work the same for a &str and &str_utf16
[15:06:55] <kimundi> a newtyped [T] would still be an unsized type
[15:07:22] <sp3d> it would be cool if ropes could implemente the string trait
[15:07:25] <zwol> Getting all of those "tons of libraries" off of UTF-16 would be such a good thing in and of itself that it would be worth the development effort.
[15:07:25] <sp3d> -e
[15:07:26] <kimundi> I think it would be easier mid-term to only allow newtypes of [T], and not of other kinds of unsized types
[15:07:50] <zwol> And in the long run I expect we want to redo e.g. the JS engine in Rust anyway
[15:08:33] <kimundi> We could also have str_ascii then, or str_c, all implemented the same way as str today: slices and owned allocations are different kinds of pointers directly into the data.
[15:08:39] <SimonSapin> zwol: the problem is not existing code, itâ€™s that JS language semantics requires JS strings to be [u16]
[15:09:04] *** Quits: pyrac (pyrac@moz-C411EA77.math.u-bordeaux1.fr) (Quit: pyrac)
[15:09:05] <zwol> I'm aware
[15:09:19] <zwol> In the long run we have to find a way to change that
[15:09:32] <SimonSapin> I donâ€™t think we can ever change that
[15:09:38] *** Quits: Ralith (ralith@114DA04D.CD83ED0A.BCDF04A6.IP) (Ping timeout)
[15:09:49] <SimonSapin> without breaking the web
[15:09:51] <zwol> I don't think we have a choice; in the long run U+10FFFF won't be the maximum codepoint value.
[15:10:10] <engla> why do you think so zwol
[15:10:19] <kimundi> veeery long run maybe
[15:10:21] <engla> I think unicode is unlikely to change
[15:10:31] <zwol> In the short run, having the JS engine fake UTF-16 semantics while actually using UTF-8 internally is the way to go IMNSHO
[15:10:45] *** Joins: pyrac (pyrac@moz-C411EA77.math.u-bordeaux1.fr)
[15:10:46] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: ëžœë¤ì€ ì‡ í‡´í–ˆìŠµë‹ˆë‹¤.)
[15:11:03] <engla> You could say, why does the JS representation have to correspond to a type in Rust?
[15:11:06] <zwol> It can be made to work efficiently for all cases other than lone surrogate pairs
[15:11:18] <kimundi> zwol: I think the problem is that the 'short run' still is longer than the lifespan of the implementation youR'e thinking of
[15:11:30] *** Joins: jdm (jdm@moz-2C5514D1.lightspeed.sntcca.sbcglobal.net)
[15:11:30] *** ChanServ sets mode: +o jdm
[15:11:40] <zwol> engla: because 2^20 characters is not going to be enough for all the languages
[15:11:53] <engla> zwol: I'm pretty sure it will
[15:12:23] <zwol> I should actually do the linear extrapolation rather than pulling numbers out of my ass, but I give the codespace we have 20 years max
[15:12:25] *** Quits: pyrac (pyrac@moz-C411EA77.math.u-bordeaux1.fr) (Ping timeout)
[15:12:35] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[15:12:40] <engla> I definitely think you should do some research on this
[15:13:14] <engla> the last 10 years, approximately 15,000 codepoints were added to Unicode
[15:13:16] <SimonSapin> zwol: how do you do JS sting indexing with UTF-8 internally?
[15:13:40] <zwol> SimonSapin: fat iterators
[15:13:51] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[15:13:59] <SimonSapin> itâ€™s not just iteration, even though thatâ€™s a common case
[15:14:35] <zwol> yeah, so if someone asks for str[8] you do in fact have to do a linear scan, but then you cache the offsets because they're probably going to ask for str[9] next
[15:14:56] <SimonSapin> I donâ€™t know if "probably" is good enough
[15:15:06] <SimonSapin> but itâ€™s still an open question for servo
[15:15:09] <zwol> ... I'm actually less sure that this can be made to work efficiently than I am sure that 10FFFF is not enough
[15:15:17] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Ping timeout)
[15:15:20] <Seldaek> zwol: the current codepoints use something like 10-15% of the available space AFAIK, and they're already busy adding emoticons in there so I doubt we'll fill the rest any time soon
[15:15:52] <Seldaek> then again, it wouldn't be the first time we're surprised about how much X we need in the future
[15:16:07] <zwol> SimonSapin: the trouble is that I don't see any way to find out for sure without doing all the work first.
[15:16:21] <bstrie> Seldaek: nah, it's not that we're ever surprised, just that we're incorrigibly lazy :P
[15:16:54] <bstrie> attribute not to incompetence that which can be adequately explained by apathy
[15:17:08] <kimundi> We just have to switch to ipv6 after unicode codepoints run out. ;)
[15:17:15] <bstrie> bstrie's corollary to hanlon's razor
[15:17:30] <Seldaek> bstrie: hehe perhaps yes. I'll still feign surprise :p
[15:17:37] * zwol should go back to work
[15:19:26] <kimundi> according to wikipedia, currently there are 110,182 codepoints defined in the unicode standart. SO, 10% is about right
[15:20:58] <nmatsakis> flaper87: pong
[15:20:58] *** Quits: sebcrozet (sebcrozet@moz-3CE49532.lrde.epita.fr) (Ping timeout)
[15:21:58] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[15:22:00] <flaper87> nmatsakis: I thought the same about https://github.com/mozilla/rust/issues/9056 
[15:22:02] <flaper87> nmatsakis: is there something else I can do to help verifying it?
[15:22:06] <flaper87> nmatsakis: Where should I look if I'd like to help fixing it?
[15:22:54] <Seldaek> kimundi: probably a bit less if you count reserved stuff and other things you don't want to touch to avoid breaking the internets.
[15:22:57] <nmatsakis> flaper87: first thing that would be helpful is just to generate the LLVM bitcode
[15:23:10] <Seldaek> kimundi: well, less space, so more %, but whatever:)
[15:23:10] <nmatsakis> flaper87: (--emit-llvm -S) and post it in the bug
[15:23:18] <nmatsakis> flaper87: or gist it
[15:27:01] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[15:28:41] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[15:29:00] *** Joins: huseby (huseby@96211BDE.83CC6402.D9CD682B.IP)
[15:29:33] *** Joins: ozten (ozten@moz-CFC6BCB5.dsl.dynamic.sonic.net)
[15:29:53] <flaper87> nmatsakis: https://gist.github.com/FlaPer87/6497196
[15:30:10] <flaper87> nmatsakis: I added that to the bug as well
[15:30:13] <flaper87> the link I mean
[15:32:30] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[15:35:58] <kmc> <ruediger> please no UTF-16 inside rust
[15:35:59] <kmc> yes
[15:36:04] <kmc> UTF-16 is the worst
[15:36:51] <kmc> it's a compatibility hack for old systems; no new language / system should use it
[15:36:58] <kmc> if that makes our lives harder when implementing Servo, so be it
[15:37:22] <nmatsakis> flaper87: yes, reading the bitcode, I think the hypothesis was slightly wrong. The problem seems to lie in the code that references the constant
[15:37:50] <nmatsakis> flaper87: in particular it appears to be trying to zero out the memory holding the constant -- it's not supposed to do that, not sure if someone landed some changes in that area recently
[15:39:56] <SimonSapin> kmc: including duplicating many libraries that are also useful outside of servo?
[15:40:27] <SimonSapin> (I tend to agree, but still)
[15:42:16] *** Quits: MrByte (MrByte@moz-147070D0.chy-wy.client.bresnan.net) (Ping timeout)
[15:42:42] <flaper87> nmatsakis: mmh, not sure where to look at, TBH :P If you point me there, I'll take a look 
[15:44:38] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:44:40] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Connection reset by peer)
[15:44:41] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[15:45:38] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:46:25] <kmc> SimonSapin: well I hope not, but I think that's the lesser evil
[15:46:48] <Ms2ger> kmc, I'm afraid hoping's not going to help :)
[15:46:56] <kmc> ;P
[15:47:27] <kmc> "semantically UTF-16" is a weird idea anyway.  if it's observable that your Unicode string type is encoded as UTF-16, then it's /not a Unicode string type/
[15:47:37] <kmc> but rather some other kind of thing
[15:49:03] <SimonSapin> kmc: Exactly. JS strings are [u16], not Unicode
[15:49:07] <kmc> right
[15:49:21] <kmc> and that's an unfortunate fact we have to deal with, but it's no excuse to make the str type in Rust something other that Unicode strings
[15:50:50] <kmc> phrasing it as "rust should use UTF-16 for strings internally" massively downplays how bad this would be
[15:51:04] <kimundi> engla, SimonSapin: https://github.com/mozilla/rust/issues/9077
[15:51:25] <Florob> So... just treat js strings as [u16]. Convert them to str when the demand arises. Observe how bad or awesome performance is. *hides*
[15:51:36] <Ms2ger> Florob, well, yes
[15:51:37] <nmatsakis> flaper87: yeah, sorry, that's kind of a complex interaction of different bits of the code
[15:51:49] <kmc> 'cause we are not talking about representation, but about semantics
[15:51:53] <Ms2ger> Florob, which means that no code written for Servo can be reused by anyone else
[15:52:03] <kmc> Ms2ger: that's not true
[15:52:13] <kmc> if other people are doing Web things then they need the same broken quasi-string type, no?
[15:52:32] <Ms2ger> Probably
[15:53:06] <kmc> also do you think the UTF-16 is going to pollute, e.g., our OpenGL bindings?
[15:53:06] <kimundi> The question should not be "should we change str to utf16 (which we won't)" but "how can we make using an custom str_utf16 type as painless as the regular str"
[15:53:35] <SimonSapin> Florob: the problem is that itâ€™s toxic
[15:53:40] <kmc> "no code written for Servo can be reused" seems like unhelpful hyperbole
[15:53:46] <SimonSapin> [u16] tends to spread everywhere in the browser
[15:54:06] <SimonSapin> for example, we probably want URL parsing based on [u16] "strings"
[15:54:15] <Ms2ger> Right
[15:54:25] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[15:54:29] <Ms2ger> We've got some code that uses 8-bit strings in Gecko
[15:54:30] *** Quits: eevee (eevee@moz-2CC451BF.evrt.wa.frontiernet.net) (Connection reset by peer)
[15:54:38] *** Joins: eevee (eevee@moz-2CC451BF.evrt.wa.frontiernet.net)
[15:54:39] <Ms2ger> Less than there used to be
[15:54:52] <Ms2ger> Because every conversion is a perf bottleneck
[15:55:19] <flaper87> nmatsakis: kk, I'll keep an eye on the bug then :D thanks!
[15:57:30] <kmc> it's not even "should we change str to utf16" its "should we change str to not a Unicode string at all but this weird thing that nobody likes"
[15:57:43] <kmc> anyway kimundi I'm glad you're confident this won't happen
[15:57:51] <kmc> I am a little scared now
[15:58:24] <kimundi> I'm pretty sure str will never become anything else that utf8
[16:00:07] <kimundi> (however, both an str implemented with utf8 and a str implemented with utf16 would still be an "Unicode string")
[16:00:28] *** Joins: sebcrozet (sebcrozet@50706F3.940A4703.BA2F4534.IP)
[16:01:16] <kimundi> (Unless utf16 is officially deprecated, and should not be used because surrogate pair codepoints and such)
[16:01:19] <kmc> not if it has the broken Web string semantics we are talking about
[16:01:34] <kimundi> that's different
[16:01:42] <kmc> where half of a surrogate pair is treated as one "character"
[16:01:53] *** Quits: jdm (jdm@moz-2C5514D1.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[16:02:24] <kmc> utf16 str with Unicode semantics wouldn't be a disaster, but a parser over Unicode and a parser over UTF-16 code units are still different things
[16:02:52] <kimundi> whether a unicode str is implemented with utf16 or not has nothing to do with whether you are allowed to break the codepoints or not.
[16:02:58] <kmc> I know
[16:03:16] <kimundi> Just wanted to make that distinction :)
[16:03:59] <SimonSapin> kmc: UTF-16 is Unicode as much as UTF-8. Nobody is proposing to make [u16] the string type
[16:04:25] <kmc> that's good
[16:04:40] <SimonSapin> Str16, or whatever it would be called, would be based on [u16] just like str is based on [u8]
[16:06:07] <kmc> but then you still have this code duplication issue, right?
[16:06:15] <SimonSapin> yes
[16:06:27] <nmatsakis> flaper87: actually, thinking more on it, I can...kind of imagine how it comes about, have to ponder the best fix tho
[16:06:37] <SimonSapin> hence the idea of a trait for generic code, but Iâ€™m not sure how realistic that is
[16:06:37] *** Quits: echristo (echristo@4241698A.2E4FD3DD.225F4543.IP) (Quit: echristo)
[16:06:38] *** Quits: bent (chatzilla@FC9FC902.ED95B50E.EDDC15BA.IP) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[16:08:00] <kmc> it seems like utf8 vs utf16 representation is a performance question, and Unicode vs. UCS-2 (for lack of a better term) semantics is the code duplication question
[16:08:26] *** Joins: aeqwa_ (aeqwa@moz-B7E0D809.dsl.tropolys.de)
[16:08:30] <kimundi> What code would get duplicated here?
[16:09:10] <SimonSapin> kimundi: potentially anything that Servo uses but could also be useful outside of servo
[16:09:35] <SimonSapin> eg. URL parsing, character encodings, â€¦
[16:09:48] *** Quits: aeqwa (aeqwa@moz-BE4E81CD.dsl.tropolys.de) (Ping timeout)
[16:10:23] <kimundi> You need to code for validating an [u8] as a string, and code for validating a [u16] as a StrUtf16 or whatever. Then duplicated/per type specialized functions for everything that works  with the underlying representation, and the rest would work with char Iterators.
[16:11:01] <kmc> I worry that we would convince Rust to add Str16 and then end up duplicating code to use [u16] anyway because we need those UCS-2 semantics
[16:11:20] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[16:11:50] <engla> Right, what if you can't use either ~str or ~str16 if those are subject to strict interpretations of the standards
[16:12:07] <engla> like the recent ousting of the surrogates from char and ~str
[16:12:14] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:12:19] <kimundi> kmc: Hence we should add Str16 in way that is useful in general, that is make defining such types possible without rustc hackery
[16:12:29] <kmc> that'd be good yeah
[16:12:41] <kimundi> kmc: https://github.com/mozilla/rust/issues/9077
[16:13:13] <SimonSapin> I wouldnâ€™t push too much for Str16 in Rust just yet
[16:14:01] *** Quits: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[16:14:01] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[16:14:13] <kimundi> SimonSapin: I push for the ability to define Str16, StrAscii, StrC as library types :P - Just having utf8 str is annoying in a lot of places
[16:14:17] <engla> SimonSapin: there is already minimal (probably buggy) support by having three functions in std::str.  pub fn from_utf16(v: &[u16]) -> ~str  and so on.
[16:14:18] *** Quits: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com) (Input/output error)
[16:14:25] *** Quits: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com) (Input/output error)
[16:14:34] <SimonSapin> kimundi: yes, that much is good
[16:14:38] <engla> SimonSapin: pub fn utf16_chars(v: &[u16], f: &fn(char))  is a char iterator
[16:14:55] *** Joins: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com)
[16:14:56] *** ChanServ sets mode: +ao nmatsakis nmatsakis
[16:15:09] *** Joins: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com)
[16:15:25] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:15:29] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[16:15:37] <kmc> engla: yeah, there would be no way at all to represent surrogates as individual 'characters' in Str16, even if you wanted to
[16:15:47] <kimundi> SimonSapin: I guess questions like "URL parser" should be based on what encoding URLs allow
[16:15:57] <Florob> I sort of want StrAscii to just be str, with a is_ascii bit set. For faster indexing etc.
[16:16:13] <SimonSapin> kimundi: encodings in URLs are a big mess
[16:16:15] <kmc> (also, -> afk)
[16:16:54] <kimundi> SimonSapin: I read the punycode wiki article yesterday - isn't it basically just ascii?
[16:17:11] <SimonSapin> you can end up with different parts of the same URL percent-encoded with different encodings
[16:17:17] <nmatsakis> dbaupp: btw still struggling through various annoying test failures, but my AST renumber PR basically works. hopefully I'll submit it today
[16:17:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:17:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:17:32] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:17:32] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:17:37] <kimundi> Florob: Why solve something dynamically if you can solve it statically :P
[16:17:59] <Florob> kimundi, Because I don't statically know if the user input is ascii
[16:18:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:18:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:18:02] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:18:02] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:18:14] <kimundi> Florob: Then you shouldn't statically assume that :P
[16:18:29] <Florob> kimundi, so can we solve it dynamically :P
[16:18:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:18:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:18:32] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:18:32] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:18:56] <kimundi> Florob: If you knwo the input is ascii, accept ascii. If you know it's utf8, accept utf8. If you don't know what exactly it is, accept [u8] and analyse it
[16:19:00] <engla> Florob: see CharSplitIterator for an example of this optimization
[16:19:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:19:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:19:02] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:19:02] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:19:03] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:19:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:19:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:19:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:19:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:19:52] <engla> you can do that, just split the implementation early enough if you find it's ascii
[16:20:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:20:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:20:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:20:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:20:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:20:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:20:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:20:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:21:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:21:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:21:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:21:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:21:20] <kimundi> I mean all those string types just represent invariants that the underlying vector holds, guarded by all construction and mutator functions.
[16:21:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:21:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:21:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:21:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:21:33] <SimonSapin> olsonjeffery: how much of rust-encoding do you want in Rust, and how soon?
[16:21:47] *** Joins: jdm (jdm@moz-7B0110AD.mv.mozilla.com)
[16:21:47] *** ChanServ sets mode: +o jdm
[16:22:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:22:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:22:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:22:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:22:24] <kimundi> str: "contains a sequence of unicode codepoints", str_ascii: "contains a sequence of ascii characters", str_c: "contains no interior 0" ... etc
[16:22:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:22:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:22:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:22:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:23:02] <SimonSapin> (s/codepoints/Unicode scalar values/ but oh well)
[16:23:02] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:23:02] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:23:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:23:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:23:14] <SimonSapin> (that is, excluding surrogate code points)
[16:23:32] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:23:32] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:23:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:23:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:23:49] <kimundi> sure
[16:24:03] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:24:03] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:24:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:24:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:24:33] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:24:33] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:24:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:24:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:24:40] *** Quits: jdm (jdm@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[16:24:45] <flaper87> nmatsakis: cool, I'll check your patches and learn something from them :D
[16:25:03] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:25:03] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:25:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:25:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:25:05] <kimundi> Hm, AutomatedTester and Yorik seem to have network trouble :P
[16:25:22] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[16:25:22] *** ChanServ sets mode: +ao pcwalton pcwalton
[16:25:33] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:25:33] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:25:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:25:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:26:03] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:26:03] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:26:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:26:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:26:09] *** Joins: jdm (jdm@moz-BBE3ABD.mv.mozilla.com)
[16:26:09] *** ChanServ sets mode: +o jdm
[16:26:33] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:26:33] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:26:33] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:26:33] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:26:34] *** Quits: unfoldl (quassel@A7FA33CE.2EBBCC1F.9510F13D.IP) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[16:27:03] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:27:03] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:27:03] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:27:03] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:27:33] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[16:27:33] *** Quits: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:27:34] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:27:34] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:28:04] *** Joins: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com)
[16:28:04] *** Quits: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:28:04] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:28:04] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:28:12] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[16:28:34] *** Joins: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com)
[16:28:34] *** Quits: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:28:34] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:28:34] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:29:04] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:29:04] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:29:34] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:29:34] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:30:05] *** Joins: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com)
[16:30:05] *** Quits: Yoric (Yoric@moz-DB4A9C19.scl3.mozilla.com) (Max SendQ exceeded)
[16:30:14] *** jdm sets mode: +smtTb Yoric!*@*
[16:30:29] *** jdm sets mode: +b AutomatedTester!*@*
[16:30:57] *** pcwalton sets mode: -m 
[16:30:58] *** pcwalton sets mode: -s 
[16:31:00] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[16:31:06] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[16:31:09] *** Joins: miza (miza@moz-4DD51325.home.otenet.gr)
[16:33:02] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:35:57] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[16:36:51] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[16:37:05] <olsonjeffery> SimonSapin: think it would be important to build concensus around what encoding/decoding traits should be defined.. and then, from there, at least ascii and utf8 impls pulled into truee, to start
[16:37:23] <olsonjeffery> also, std::str has from_utf8/utf16 instead of from_bytes now
[16:37:33] <olsonjeffery> so those backing impls need to be extracted and replaced, as needed
[16:37:44] <olsonjeffery> i get the impression that they're both real fly-by-the-seat-of-their-pants in nature
[16:38:03] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[16:38:07] *** Joins: io2 (io2@moz-A6202C16.home.otenet.gr)
[16:38:19] <olsonjeffery> SimonSapin: so perhaps spinning up a utf16 impl, in addition to what's already present in rust-encoding and should be pulled in..
[16:38:31] <olsonjeffery> that is what i would consider a "good start" for an initial PR
[16:39:15] <olsonjeffery> 1) encoding traits 2) utf8/ascii impls from rust-encoding, ports to work against new traits and 3) extract whats in std::str to use those new impls, as needed, why adding utf16
[16:39:32] <olsonjeffery> while adding utf16
[16:39:38] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[16:39:38] *** ChanServ sets mode: +o tjc
[16:40:02] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:40:02] <SimonSapin> olsonjeffery: converting between [u16] seems very specific, different from everything else
[16:40:25] <SimonSapin> s/between [u16]/between [u16] and str/
[16:40:28] * olsonjeffery nods
[16:40:38] <engla> from_utf8 could still stay in some fashion, since sometimes you just need to inject valid utf8, without having a decoder look at it.
[16:40:41] <olsonjeffery> that was why i mentioned a polymorphic encoding trait that could take u8 or u16
[16:40:55] <engla> what does fly-by-the-seat-of-their-pants mean? is_utf8 is good now
[16:41:05] <olsonjeffery> decoding trait, i should say
[16:41:19] *** Joins: steveh (Mibbit@moz-7A900440.fda.gov)
[16:41:20] <olsonjeffery> engla: i meant it only insofar as it doesn't use a decoder, as you mention
[16:41:35] <SimonSapin> engla: str::from_utf8 would be sugar for calling the decoder, and str::raw::from_utf8 is basically transmute()
[16:41:45] <engla> but they only accept valid utf8, correctly, nowadays
[16:41:58] <engla> SimonSapin: nothing inbetween?
[16:42:13] <olsonjeffery> this is a good question for brson
[16:42:20] <SimonSapin> engla: there is also the full Encoder and Decoder API
[16:42:37] <olsonjeffery> as is it, im going to collect what ive gathered from these conversations and make a gist or something for brson to look at, then possibly a rust-dev post
[16:42:43] <engla> SimonSapin: just verifying the buffer is valid is much quicker than going through a decoder
[16:43:44] *** Quits: jstevans (Instantbir@4EB64216.D41652FF.DDE5D3F6.IP) (Connection reset by peer)
[16:43:45] *** Joins: jstevans (Instantbir@4EB64216.D41652FF.DDE5D3F6.IP)
[16:44:07] <SimonSapin> engla: because str is UTF-8, this is basically what the UTF-8 decoder is doing
[16:44:18] <SimonSapin> assuming a "fatal" error handling
[16:44:33] <engla> right, if it can assume that
[16:44:40] <SimonSapin> oh, but I see your point
[16:44:56] <SimonSapin> you also want a version that consumes a owned vector and does not copy
[16:45:10] <engla> yes or slice.
[16:45:15] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[16:45:19] <engla> just saying the current versions have some value
[16:45:30] <engla> also they are correct, not flying by their pants olsonjeffery 
[16:45:31] <engla> :)
[16:45:33] <olsonjeffery> well that can be a property of a decoder trait...
[16:45:43] <olsonjeffery> verify then transmate
[16:45:52] <olsonjeffery> implied by the api..
[16:45:55] <steveh> Anybody - Need help - how currently to call a static fn through a trait, when "Self" type isn't in fn's signature at all, so "let" type inference trick doesn't work?  I saw blog posts about "associated funs" but not what the resolution ended up being?
[16:46:04] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:46:13] <kimundi> steveh: Currently not possible
[16:46:20] <steveh> OK Thx
[16:47:10] <SimonSapin> steveh: you can work around this by adding a dummy Option<Self> parameter, and passing None
[16:47:11] <kimundi> steveh: For now, you need to do an ugly workaround: Add an additional Option<Self> parameter, and call like foo(a, b, c, None::<TYPE>)
[16:47:16] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:47:17] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[16:47:23] *** Joins: jstevans1 (Instantbir@moz-FA8D0F3E.bootp.virginia.edu)
[16:47:34] <steveh> Ah OK, that's not too bad.
[16:47:42] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[16:47:46] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[16:48:15] *** Quits: jstevans (Instantbir@4EB64216.D41652FF.DDE5D3F6.IP) (Ping timeout)
[16:48:55] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:50:08] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[16:50:38] *** Joins: jstevans (Instantbir@56442709.C6383AE7.DDE5D3F6.IP)
[16:51:03] *** Quits: jstevans1 (Instantbir@moz-FA8D0F3E.bootp.virginia.edu) (Ping timeout)
[16:51:43] *** Joins: five (five@FC8B9D7D.C4AAC3ED.10BB00EE.IP)
[16:51:43] <olsonjeffery> based on my read of str:: .. both from_utf8 and from_utf16 do copies..
[16:52:26] *** Joins: aeqwa (aeqwa@moz-6E882F4F.dsl.tropolys.de)
[16:52:26] *** Quits: five (five@FC8B9D7D.C4AAC3ED.10BB00EE.IP) (Connection reset by peer)
[16:52:58] *** Quits: RMF (RMF@moz-1A0DBA5B.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[16:53:00] *** Quits: aeqwa_ (aeqwa@moz-B7E0D809.dsl.tropolys.de) (Ping timeout)
[16:53:08] *** Joins: jstevans1 (Instantbir@56442709.C6383AE7.DDE5D3F6.IP)
[16:53:09] *** Quits: jstevans (Instantbir@56442709.C6383AE7.DDE5D3F6.IP) (Connection reset by peer)
[16:54:03] <olsonjeffery> from_utf8 verifies is_utf8() and then copies the whole memory, while from_utf16 iterates over it char by char and verifies then pushes
[16:54:13] <engla> there are many variants of from_utf8
[16:54:25] <engla> from_utf8_slice, from_utf8_owned etc I think
[16:54:37] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:54:39] *** Quits: steveh (Mibbit@moz-7A900440.fda.gov) (Quit: http://www.mibbit.com ajax IRC Client)
[16:54:40] <engla> it's a real forest and needs some cleanup
[16:54:55] <olsonjeffery> SimonSapin engla : so i guess im trying get a grasp on what the optimal complexity would be for a generalized decoder trait
[16:55:02] <olsonjeffery> and if that's "good enough" for universal use
[16:55:14] <olsonjeffery> or if, as you're suggesting engla, we need a "Fast path" for some subset of codec(s)
[16:55:14] *** Joins: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP)
[16:55:39] *** Quits: jstevans1 (Instantbir@56442709.C6383AE7.DDE5D3F6.IP) (Ping timeout)
[16:55:45] <engla> the only-verify route from utf8 to str can be outside the scope of encodings
[16:56:17] <strcat> dbaupp: around?
[16:56:20] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:56:23] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[16:57:12] <strcat> rusti: let x = @mut 5; let y = *x; println!("{}", *x); *y = 10; println!("{}", *x)
[16:57:12] *** Quits: sebcrozet (sebcrozet@50706F3.940A4703.BA2F4534.IP) (Ping timeout)
[16:57:23] <strcat> rusti: let x = @mut 5; let y = &mut *x; println!("{}", *x); *y = 10; println!("{}", *x)
[16:57:48] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[16:57:48] <strcat> does ix.io not work anymore... ?
[16:57:59] <kimundi> olsonjeffery: I have no idea about performance, but for starters it seems to me that basing encoding around 'char' makes sense
[16:58:03] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[16:58:16] <kimundi> olsonjeffery: In form of Iterators ideally
[16:58:28] <SimonSapin> kimundi: [char] is a way to represent text
[16:58:39] <SimonSapin> itâ€™s basically native endian UTF-32
[16:58:41] <engla> kimundi: it doesn't for the utf-8 decoder because that's a [u8] -> [u8] transformation
[16:58:50] <olsonjeffery> yeah, i think all uses of ~[u8] will be replaced in ~Iterator<u8> in practice
[16:58:56] <kimundi> hmm
[16:58:58] <strcat> you wouldn't use a trait object
[16:59:00] <strcat> with an iterator
[16:59:06] <strcat> but I see what you mean
[16:59:20] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:59:39] <olsonjeffery> strcat: well how can we represent an infinite stream/generator w/o a trait object?
[16:59:46] *** Joins: ww (Mibbit@moz-DFAED48A.lightspeed.sntcca.sbcglobal.net)
[16:59:47] <strcat> the actual type?
[16:59:52] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[16:59:54] <kimundi> Do we have the ability to do something like double dispatch, where the default is T -> char -> U, but an ovberride exists that reduces it to T -> U ?
[17:00:07] <strcat> iterators and trait objects don't mix, 90% of the methods are by-value and it's incredibly slow for each iteration to use virtual dispatch
[17:00:07] <kimundi> well, double dispatch is the wrong term
[17:00:21] <strcat> you won't have map, filter, and so on
[17:00:22] <olsonjeffery> strcat: yes. you're right.
[17:00:35] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[17:00:49] <klutzy> rusti: fn f(a: int, a: int) -> int { a } f(1,2)
[17:00:57] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:01:14] <klutzy> rusti: 1
[17:01:22] <kimundi> Idea: Three Traits: Encoder, Decoder, Transcoder. Encoder and Decoder are for T -> char and char -> U, Transcoder for goung T -> U directly
[17:01:31] <engla> rusti talks in /query mode
[17:02:02] <olsonjeffery> strcat: does your rusti actuall track master? im curious how you get it to work.. since my build is always segfaulting :(
[17:02:09] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Client exited)
[17:02:14] <strcat> olsonjeffery: it's not actually rusti
[17:02:21] <strcat> anyway I think it broke due to ix.io breaking
[17:02:21] * olsonjeffery nods
[17:02:22] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[17:02:27] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[17:02:28] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:02:30] <strcat> rusti: 2
[17:02:36] <olsonjeffery> strcat: i might just use a rust playground local install or something
[17:02:52] <olsonjeffery> i want an eval loop for a talk im doing at the end of the month..
[17:02:57] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:03:21] <strcat> olsonjeffery: well there's the web version of rusti 
[17:03:30] <olsonjeffery> im not sure what the connectivity situation will be like
[17:03:48] <olsonjeffery> the talk is at a university that i seem to recall having a very visitor-hostile wifi policy
[17:03:51] <strcat> heh
[17:03:56] <strcat> rusti: why aren't you working
[17:04:15] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:04:15] *** ChanServ sets mode: +ao brson brson
[17:04:38] <tjc> rusti needs a day off once in a while, just like all of us :-)
[17:04:52] <ww> what's the right way to do default/option function parameter in rust?  e.g.  fn func1(s: ~str, size = 99 : int)?
[17:05:06] <engla> rusti does work fine if you privmsg it
[17:05:13] <kimundi> tjc: Might be true, rusti was grumpy all weekend. Did say nothing but "Bad System call" ;)
[17:05:15] <tjc> ww: We don't have it; you can write wrappers
[17:05:17] <olsonjeffery> ww: there's a rust-dev thread on the topic recently..
[17:05:21] <olsonjeffery> but, yeah. what tjc said.
[17:05:33] <tjc> like: fn func1(s: ~str, size: int) and then fn func1_with_default_size(s: str) { â€¦ func1(s, 99) â€¦ }
[17:05:47] <tjc> my preference is to keep it that way, but there is an issue open about adding default arguments
[17:05:52] <ww> i see, with different named func
[17:05:54] <olsonjeffery> or using enums to represent defaults/overloads..
[17:05:59] <tjc> Yeah
[17:06:08] <ww> o thx
[17:06:10] <engla> default positional elements only seems confusing
[17:06:12] <acrichto> strcat: 6914 was closed in favor of itself?
[17:06:19] *** Joins: mordof (mordof@moz-548217BC.cpe.net.cable.rogers.com)
[17:06:27] <strcat> acrichto: ugh
[17:06:29] <strcat> I always do that
[17:06:37] <strcat> anyway it was closed in favour of https://github.com/mozilla/rust/issues/9081
[17:06:40] * strcat fixes link
[17:06:41] <mordof> is there a decent GUI crate (i believe is the right word) in existence for Rust yet?
[17:08:06] <olsonjeffery> mordof: there are some bindings here and there.. don't know how active/stable they are.. probably the most actively used is opengl-related, which isn't really what you're after i imagine.
[17:08:38] <mordof> no not really, unfortunately. i have a basic understanding of how I could make use of that for a 2d interface, but have little desire to get that far into it right now
[17:09:44] <olsonjeffery> mordof: rust isn't optimal for gui work, right now, because we're in the process of building out a system whereby you can swap out the event loop at the runtime/scheduler level, which is neccesary to properly integrate with any gui toolkit
[17:09:47] <strcat> acrichto: can you review https://github.com/mozilla/rust/pull/9071 ? I responded to dbaupp comment there
[17:09:49] <olsonjeffery> whether it be gtk, win32, etc
[17:09:58] <olsonjeffery> but its something that is coming.
[17:10:44] <strcat> rusti: 2
[17:11:03] <acrichto> strcat: why are the C++ functions 'XXXReturnAttribute', it's not specific to returns is it?
[17:11:25] <strcat> acrichto: the C API only exposes a way to set attributes on functions and parameters
[17:11:47] <acrichto> but isn't that adding a function attribute?
[17:11:49] <strcat> LLVM itself treats a 0 parameter index as being the return value, and ~0 as being the function itself
[17:11:53] <strcat> acrichto: no
[17:11:58] <acrichto> oh I see
[17:12:12] <strcat> acrichto: the C API just sucks
[17:12:13] <acrichto> could you throw a comment in with relation to that?
[17:12:18] <acrichto> just that 0 == return value
[17:12:29] <strcat> acrichto: sure, I should really use ReturnIndex if I'm not already
[17:12:31] <strcat> lemme check
[17:12:36] <strcat> it's just a constant defined as 0
[17:12:54] <acrichto> I'd be ok with either
[17:12:58] <strcat> yeah lemme update it to that
[17:14:05] <strcat> so, rusti actually still works
[17:14:13] <strcat> just not on this channel/server...
[17:14:23] <strcat> rusti: 2
[17:14:29] <strcat> just not on this channel*
[17:14:36] <engla> somebody already mentioned that :)
[17:14:40] <strcat> :s
[17:14:42] <mordof> olsonjeffery: is there a rough timeline in place for that? just wondering if i should put it on pause and come back to it
[17:14:43] <strcat> is it quieted?
[17:14:53] <pnkfelix> ww: FYI this is the ticket tracking default/keyword args: https://github.com/mozilla/rust/issues/6973
[17:15:11] <pnkfelix> ww: IMO struct's suffice, especially if we were to add some sugar like I suggested in that ticket.
[17:16:05] <strcat> rusti: :[
[17:16:23] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[17:16:36] <kmc> sugar for default field values?
[17:16:51] <kimundi> strcat: I'm not getting any messages with query either
[17:16:52] <kmc> another way to see it (the Haskell way) is not as sugar for defaults but sugar for functional struct update
[17:17:08] <strcat> kimundi: well I am
[17:17:12] <pnkfelix> kmc: Yes, at least for structs that implement the Default trait.
[17:17:19] <kmc> so like Foo::default() { y: 5 }
[17:17:22] <kimundi> strcat: Context: I think I'm not registered on this channel
[17:17:35] <kimundi> slash server
[17:17:38] <kmc> which means you don't need a privileged Default trait or any notion of default values specifically
[17:18:00] <kmc> but you do need syntax for this struct update (the one I just used is probably not suitable)
[17:18:21] <pnkfelix> kmc: (Though now that I say this I realize that a problem with it is that it assumes that all args can be defaulted, not merely a subset of them, which is in part what you'd want with real default args.)
[17:18:32] <kmc> true
[17:18:34] <pnkfelix> kmc: We already have syntax for struct update
[17:18:45] <pnkfelix> kmc: that's why I'm trying to leverage it.
[17:19:01] <kmc> which syntax is that?
[17:19:59] <kimundi> struct Foo { a: uint, b: uint }; static FOO = Foo { a: 1, b: 2}; let x = Foo { b: 78, .. FOO}
[17:20:07] <kimundi> kmc ^
[17:20:11] <pnkfelix> kmc: http://static.rust-lang.org/doc/rust.html#structure-expression
[17:20:29] <kmc> cool!
[17:20:31] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[17:20:35] *** Joins: jclements (jclements@moz-9C0ABCFC.wireless.calpoly.edu)
[17:21:33] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:21:53] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[17:22:22] <strcat> acrichto: https://github.com/mozilla/rust/pull/9071 there
[17:22:58] <acrichto> strcat: r+, thanks
[17:23:27] <strcat> acrichto: I find their C API so annoying...
[17:23:37] <strcat> it has lots of no-op parameters and deprecated ways of dealing with things
[17:23:42] <strcat> since it's stable
[17:23:56] <strcat> + basic things like this are not exposed
[17:24:15] <strcat> and yay, much weaker typing than the regular API :P
[17:24:26] <bstrie> ugh, what's the name of the character iterator on strings
[17:24:29] <acrichto> our solution isn't really that bad
[17:24:30] *** Joins: ofeldt- (ofeldt@moz-74B39EEE.dip0.t-ipconnect.de)
[17:24:30] <bstrie> neither iter_char nor char_iter works
[17:24:32] <strcat> bstrie: iter
[17:24:44] <bstrie> strcat: what was the point of the old iter/char_iter distinction, then?
[17:24:59] <strcat> there was a distinction? ;p
[17:25:17] <bstrie> well unless I'm going crazy there definitely used to be something called iter_char
[17:25:20] <bstrie> *crazier
[17:25:30] <bstrie> was it just a synonym?
[17:25:33] *** Quits: ofeldt (ofeldt@moz-E0565574.dip0.t-ipconnect.de) (Ping timeout)
[17:25:36] * strcat shrugs
[17:25:40] <bstrie> ah well
[17:25:42] <bstrie> not complaining
[17:26:08] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:26:08] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14233aae6 to 14fd2488b: 02http://git.io/N3iJvQ
[17:26:08] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:26:10] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[17:26:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/I21w5g
[17:26:10] <ghrust> 13rust/06auto 1427c07fa 15Daniel Micay: add `noalias` attribute to ~ return values
[17:26:10] <ghrust> 13rust/06auto 1493fac09 15bors: auto merge of #9071 : thestinger/rust/noalias, r=alexcrichton...
[17:26:11] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[17:26:51] <bstrie> hm, weird. I didn't expect `for c in "asdf".iter() {` to work. did something change wrt rvalue lifetimes?
[17:27:27] <strcat> bstrie: nothing changed, but that's 'static
[17:27:41] <bstrie> aha
[17:28:18] <Ms2ger> Hmm
[17:28:31] * Ms2ger wonders if unsafe code can alias there
[17:28:50] <pnkfelix> bstrie: I think under the old iterator protocol the method was named `iter_chars`
[17:28:51] <bstrie> strcat: is there a bug filed for being able to omit the `.iter()` in for loops? even if it's not going to happen anytime soon, would be nice to track it
[17:28:56] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:28:59] <bstrie> pnkfelix: I see
[17:29:07] <strcat> bstrie: somewhere, I think so
[17:29:14] *** Quits: squiddy_ (squiddy@moz-CD26F336.adsl.alicedsl.de) (Ping timeout)
[17:29:32] <strcat> olsonjeffery: you can set up http://strcat.zapto.org:8000/ locally
[17:29:49] *** Joins: devin909 (Mibbit@B2D84027.EEDD3B02.DDE5D3F6.IP)
[17:29:53] <strcat> I have it all on github but it's set up specifically for arch linux, as in it uses pacstrap to make the chroots and depends on modern kernel features
[17:30:02] <strcat> https://github.com/thestinger/rust-playpen
[17:30:24] *** Joins: Exia (Mibbit@B2D84027.EEDD3B02.DDE5D3F6.IP)
[17:30:36] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[17:31:06] <Exia> I found that find_str() in str module returns Options(uint), could anyone please briefly explain what that is?
[17:31:27] <SimonSapin> Exia: itâ€™s either Some(uint) or None
[17:31:34] <kimundi> Exia: An wrapper type that expresses "A index position, or no value"
[17:31:43] <Exia> ah, i see. thanks!
[17:31:50] <SimonSapin> itâ€™s an enum http://static.rust-lang.org/doc/tutorial.html#enums
[17:32:05] *** Joins: sanxiyn (tinuviel@AE8B10D7.A92E374.57C4C441.IP)
[17:32:06] <bstrie> Exia: you can either pattern match to get the value out, or just use the .unwrap() method on the return value in which case your program will fail if it's ever 
[17:32:09] <bstrie> None
[17:34:59] <olsonjeffery> strcat: yeah, i saw the repo. im on ubuntu. but ill manage, somehow.
[17:35:30] <strcat> olsonjeffery: if it's a new release of ubuntu the kernel will be new enough
[17:35:48] <strcat> just likely need to enable the memory cgroup (since they patch it off by default with a toggle for some reason)
[17:35:53] <strcat> and need libseccomp v2
[17:35:59] <strcat> dunno if they've finally packaged it
[17:36:27] * olsonjeffery nods
[17:36:35] *** Joins: sebcrozet (sebcrozet@8176B003.940A4703.BA2F4534.IP)
[17:36:43] <strcat> + make the chroots yourself ;P, I guess debootstrap
[17:37:10] <olsonjeffery> i might just plan on having www access :)
[17:37:15] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[17:37:17] *** Joins: lkuper (lkuper@moz-92200C74.lightspeed.iplsin.sbcglobal.net)
[17:37:22] <olsonjeffery> if anything, i have 4g tethering on my phone that i use frequently
[17:41:06] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:41:06] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1493fac09 to 14fd2488b: 02http://git.io/N3iJvQ
[17:41:06] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:41:11] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:41:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/PHns4g
[17:41:11] <ghrust> 13rust/06auto 148a96618 15Alex Crichton: Remove the __log function for __log_level...
[17:41:11] <ghrust> 13rust/06auto 14059cbaa 15bors: auto merge of #9005 : alexcrichton/rust/rusty-log, r=brson...
[17:41:12] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:42:19] <kimundi> olsonjeffery: You know... for private use you COULD just skip all that chroot cgroup stuff and write yoursel a little script that invokes rustc cdirectly :P
[17:43:14] <kimundi> readline -> wrap main fn around it -> call rustc
[17:43:16] <strcat> true but there are those 5 minutes I put into making that web interface you'd have to replicate :P
[17:43:52] <strcat> I could just host a working chroot tarball somewhere
[17:43:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:46:50] *** Parts: mordof (mordof@moz-548217BC.cpe.net.cable.rogers.com) ()
[17:49:06] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[17:49:19] *** Quits: devin909 (Mibbit@B2D84027.EEDD3B02.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:49:26] *** Quits: Exia (Mibbit@B2D84027.EEDD3B02.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:50:04] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[17:52:32] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[17:55:18] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[17:55:26] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:55:26] *** ChanServ sets mode: +o tjc
[17:57:00] *** Quits: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP) (Ping timeout)
[17:57:18] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[17:57:37] *** Joins: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch)
[17:59:24] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[18:00:12] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[18:01:25] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[18:02:23] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[18:02:59] *** Joins: FrozenCow_ (FrozenCow@moz-B2DF4929.chello.nl)
[18:03:09] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (No route to host)
[18:04:28] *** Joins: annevk (annevk@DF1341F2.4F390C2A.420B7681.IP)
[18:04:48] *** Joins: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP)
[18:04:50] *** Joins: aeqwa_ (aeqwa@moz-F2235B53.dsl.tropolys.de)
[18:05:38] <olsonjeffery> brson: ping
[18:06:17] *** Quits: aeqwa (aeqwa@moz-6E882F4F.dsl.tropolys.de) (Ping timeout)
[18:06:42] *** Quits: aeqwa_ (aeqwa@moz-F2235B53.dsl.tropolys.de) (Ping timeout)
[18:07:05] <ww> .
[18:08:11] *** Joins: jviereck (Adium@moz-58A87BA7.dip0.t-ipconnect.de)
[18:09:13] <ecr> cmr: ping
[18:09:54] *** Joins: aeqwa (aeqwa@moz-F6958EFC.dsl.tropolys.de)
[18:10:18] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[18:10:57] <brson> olsonjeffery: ping
[18:11:01] <brson> -ong
[18:11:40] <olsonjeffery> brson: so ive talking with people who are interested in the plight of the encoding story in rust
[18:11:58] <olsonjeffery> SimonSapin has interacted with rust-encodings and the maintainer a bit, so he has lots of good input
[18:12:01] <olsonjeffery> and engla is interested, as well
[18:12:17] <olsonjeffery> we had a bit of discussion this morning, here: https://botbot.me/mozilla/rust/msg/5864459/
[18:12:35] <olsonjeffery> it goes on a bit.. anyways. there are a few issues to sort out.
[18:13:16] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[18:13:40] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:14:10] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:14:26] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[18:14:26] *** ChanServ sets mode: +ao dherman dherman
[18:14:57] <olsonjeffery> brson: i guess 1) settling on traits for "the encoding API" .. these may or may not look like what rust-encodings has.
[18:15:11] <olsonjeffery> 2) bring over, at least, the utf8 and ascii decoding/encoding impls into the rust tree
[18:15:46] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[18:15:57] <olsonjeffery> 3) work on whats in std::str .. there's a perf/correctness tradeoff that seems to suggest that we don't want to replace everything in there with something backed by std::encodings (if you will)
[18:16:20] <olsonjeffery> at least from from_utf8(), where there are some "correct" fast paths that don't require a decoder
[18:16:32] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:16:45] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:16:46] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:17:08] <olsonjeffery> 4) probably a bigger, mid-term issue :the question of what the internal representations of rust strings should be, vis-a-vis an encoding standard
[18:17:13] <cmr> ecr: pong
[18:17:21] <annevk> zwol: "In the short run, having the JS engine fake UTF-16 semantics while actually using UTF-8 internally is the way to go IMNSHO" how would that even work
[18:17:48] <annevk> zwol: and Unicode growing beyond 21-bit seems highly unrealistic, citation needed
[18:18:21] <ecr> cmr: I have a slight correction for TWIR on the TCP change. Bind has always been separate from starting the listener. Previously, the listener was started the first time you tried to accept a connection (first call to accept()).
[18:19:32] <ecr> (bind happens in the TcpListener constructor)
[18:19:40] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Ping timeout)
[18:19:43] <cmr> ecr: ok, so I misunderstood; so instead listen and accept are separated?
[18:20:27] *** Quits: sebcrozet (sebcrozet@8176B003.940A4703.BA2F4534.IP) (Ping timeout)
[18:20:32] <ecr> cmr: correct. This is useful for testing because we can ensure the server is started before letting a client connect (accept is blocking, so we had no way to tell previously).
[18:22:00] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[18:23:04] <ecr> :E
[18:23:11] <ecr> >.< wrong window
[18:23:30] <ww> is .rc file extension still the convention for rust library file?
[18:23:35] <brson> olsonjeffery: ok, trying to digest this. I understand that the rust-encoding api is not wrong, doesn't allow for non-str results.
[18:23:50] <cmr> ww: no, and using .rc is deprecated.
[18:23:53] <brson> olsonjeffery: can the utf8 decoder be based on the existing utf8 code?
[18:23:55] <cmr> ww: use a normal .rs
[18:24:02] <ww> ok, thx
[18:24:05] <brson> *not right
[18:25:04] *** Quits: lkuper (lkuper@moz-92200C74.lightspeed.iplsin.sbcglobal.net) (Quit: lkuper)
[18:25:44] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:26:26] <olsonjeffery> brson: "the existing utf8 code", ie what's in std::std?
[18:26:31] <olsonjeffery> std::str, even
[18:26:33] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:27:25] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[18:28:38] <engla> brson: there is no error handing decoder in std::str. I've written a simple (but correct) version, but I trust rust-encodings is faster and has better API (according to SimonSapin)
[18:28:39] <kimundi> I think the existing utf8 code is mainly is_utf8 and the CharIterators
[18:28:47] *** ozten is now known as ozten|afk
[18:28:51] <strcat> push_char is the utf-8 encoder
[18:29:00] <ww> can future support timeout?
[18:29:08] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:29:31] *** Joins: kermi (Mibbit@moz-5AF9AA47.hsd1.va.comcast.net)
[18:29:32] <strcat> afaik the utf-8 stuff in libstd is finally correct
[18:29:47] <strcat> only remaining issues are in the str API
[18:29:59] <strcat> it has soundness holes
[18:30:12] <kimundi> examples?
[18:30:15] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[18:30:22] <strcat> index-assign
[18:30:27] <strcat> &mut borrows
[18:30:34] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:30:38] <strcat> shouldn't have either
[18:30:51] <olsonjeffery> from everything ive gathered, it's "correct", but it doesn't really have any flexibility in its error handling.. it always fails on bad input (if the is_utf8() check fails)
[18:30:52] <kimundi> right
[18:30:56] <kimundi> wait
[18:31:07] <ww> or in general can task be called with timed out?  timeout is needed in network connection in general
[18:31:15] <olsonjeffery> http://encoding.spec.whatwg.org/#error
[18:32:09] <kimundi> wait's wrong with mut borrows? Apart from the fact that you are restricted in what you can change: Can only replace a codepoint by one that is encoded in the same nuber of bytes. Maybe thats enough to make &mut borrows a useless feature...
[18:32:22] <strcat> &mut x[2]
[18:32:27] <strcat> unsound
[18:32:43] <kimundi> that's true
[18:32:47] <engla> mutable indexing is a hole in the str abstraction
[18:32:52] <kimundi> I thought you mean &mut str
[18:33:12] <kermi> Hey everyone. I'm trying to read a file line by line, but I'm getting a mismatched types error where it's looking for '()' and is instead getting ~[~str]. I am using a match statement, match fileReader { Ok(reader) => reader.read_lines}, Err(msg)...etc. Any thoughts on why this is happening?
[18:33:41] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[18:33:43] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:33:43] *** ChanServ sets mode: +ao brson brson
[18:34:07] <engla> kermi: all branches of match must return the same type of value
[18:34:16] <kimundi> kermi: match is an expression, if one of the arms evaluates to the return value of read_lines(), which is ~[~str], and the other doesn't , that's an type error
[18:34:17] <ecr> ww: For network stuff, I think libuv does some timeout stuff under the hood. In general, you could have the task create a timer and then select on the timer and whatever you want to have a timeout. if the timer finishes first, then you'll unblock (and see it was the timer that finished => ergo timeout). I don't think anyone has written up a general form of this abstraction yet.
[18:34:49] <strcat> olsonjeffery: I don't understand the use case for those in general purpose programming
[18:34:53] <kimundi> kermi: you might want to force each arm to evaluate to () by terminating the statements in it with a ';'
[18:35:11] <strcat> we have ones returning Option now, so it works without the runtime and can be handled
[18:35:16] <kimundi> mathc filereader {Ok(reader) => { reader.read_lines(); } ...}
[18:35:25] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[18:35:38] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:35:48] <ww> i see. thanks.  yeah, libuv does low level timeout.  i just want to let the user to control what the timeout value is, and that requires handling timeout myself.  your approach works.  thanks
[18:35:55] <strcat> I'm not sure what sensible thing you're going to do with the condition one
[18:35:59] <engla> strcat: replacement char insertion is pretty common
[18:36:11] <strcat> 'If decoder's error handling mode is replacement, emit code point U+FFFD. '
[18:36:14] <strcat> it doesn't let you pick, though
[18:36:36] <engla> sounds good
[18:36:37] <strcat> just uses the replacement character
[18:36:38] <kermi> #kimundi: cool, thanks that got rid of the error
[18:36:43] * strcat shrugs
[18:36:51] <ecr> ww: it's probably a useful spawn variant to have (like try and future). If you write up a general version, try to get it merged in :)
[18:36:52] <engla> the condition response can be `replacement`
[18:37:15] <olsonjeffery> strcat: what engla said
[18:37:25] <strcat> so what's a use case for handling input like that?
[18:37:53] <engla> Maybe rendering a filename
[18:38:15] <olsonjeffery> irc clients :P
[18:38:20] <strcat> engla: that's ambiguous, then
[18:38:34] <ww> ecr: haha.  i'm still learning.  let's see how it goes
[18:38:37] <annevk> strcat: the whole web platform uses FFFD for that
[18:38:42] <engla> strcat: yes of course. You can't bring arbitrary filenames into unicode text.
[18:38:43] <annevk> strcat: e.g. HTML / CSS / etc.
[18:38:47] <strcat> ok, but the web platform isn't libstd
[18:38:48] <engla> you can however do a best effort
[18:38:55] <engla> that's what my file browser does..
[18:39:04] <strcat> engla: so you can have 10 files displaying as "foo"
[18:39:06] <strcat> ?
[18:39:13] <strcat> and if you copy the name, does it copy as "foo?
[18:39:13] <engla> strcat: yes. this is for *rendering*
[18:39:15] <annevk> strcat: it's getting there :)
[18:39:36] <engla> strcat: do you want to have 100 files display as <invalid encoding> instead?
[18:39:52] <engla> surely Foo<> is better. (with replacement char)
[18:40:28] <engla> my terminal also renders invalid UTF-8 with replacement char
[18:40:38] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[18:41:06] <engla> (it uses a different replacement algorithm than python, btw, it uses the recommended one, Python does not)
[18:41:56] <kmc> whether filenames are considered to be bytes or unicode is OS-dependent, I believe
[18:42:03] <strcat> filesystem dependent
[18:42:09] *** Joins: alex__ (alex@moz-7421D6C9.mc.videotron.ca)
[18:42:44] <engla> yeah some filesystems actually specify an encoding
[18:42:50] *** Quits: alex_abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[18:43:06] <engla> but the linux ones do not, in general
[18:43:18] <kmc> I think on UNIX you can use any bytes other than 00 and 2F and the core OS doesn't care what (if any) character encoding(s) you use
[18:43:30] <strcat> kmc: well not on linux
[18:43:33] <strcat> it depends on the filesystem
[18:43:40] <kmc> sorry I meant for "native" UNIX filesystems
[18:43:59] <strcat> UDF is fairly native
[18:44:05] <strcat> everything supports it
[18:44:34] <kmc> when you mount FAT32 you're supposed to pick a codepage for case folding (I guess on Turkish Windows you can have a file named Hi and another named HI ???)
[18:44:47] *** Joins: luisbg (luisbg@moz-E7587DBE.collabora.co.uk)
[18:46:05] <strcat> ntfs itself is case-sensitive and has posix file permissions
[18:46:08] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[18:46:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/PHns4g
[18:46:08] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[18:46:10] <strcat> windows just has really bad ntfs support ;p
[18:46:31] <kmc> haha
[18:46:53] <strcat> oh that's gross it's UCS2
[18:46:58] <strcat> it's not even true UTF-16
[18:47:08] *** Quits: Palmik (palmik@moz-CC484FDD.tmcz.cz) (Quit: Lost terminal)
[18:47:39] <engla> so we only have to deal with the error handling modes replace and fatal? That's great if that's the case
[18:48:06] <engla> some others have been suggested (arbitrary replacement, similar to the surrogate escapes)
[18:48:24] <strcat> it seems weird to use a condition for it
[18:48:28] *** Quits: fabiand (fabiand@moz-18B5E9CD.adsl.alicedsl.de) (Quit: Verlassend)
[18:48:34] <strcat> wouldn't you just pass Replace(char) or Fatal?
[18:48:51] <engla> you can do that
[18:49:00] <strcat> or maybe Ignore
[18:49:02] * strcat shrugs
[18:49:17] <engla> I think ignore is one of the worst recovery modes security wise
[18:49:30] <strcat> that's how I feel about replace
[18:49:32] <strcat> ;p
[18:49:35] <strcat> (and ignore)
[18:49:39] *** Quits: FrozenCow_ (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[18:49:46] <strcat> you will end up with ambiguities with repalce
[18:49:48] <strcat> replace*
[18:49:52] <strcat> just like you will with ignore
[18:49:56] <cmr> I hate having to deal with next, humans are so messy.
[18:49:58] <engla> replace is recommended everywhere as the least bad alternative
[18:50:06] * cmr 's previous job was as a web scraper
[18:50:11] <strcat> engla: just as insecure as ignore, though
[18:50:18] <engla> why?
[18:50:23] <strcat> because it's just as ambiguous
[18:50:34] <engla> I don't think so
[18:50:35] <strcat> there's not a character you can insert as a replacement that couldn't already exist in the string
[18:50:58] <engla> ah by replace I mean replace default = \uFFFD
[18:51:06] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[18:51:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hOgpmw
[18:51:06] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[18:51:07] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[18:51:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/l-vxrg
[18:51:07] <ghrust> 13rust/06auto 14594531a 15Alex Crichton: Give the libuv makefile generation a dependency...
[18:51:07] <ghrust> 13rust/06auto 1460a0dbc 15bors: auto merge of #9033 : alexcrichton/rust/libuv-makefile-dep, r=brson...
[18:51:07] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[18:51:10] <strcat> \uFFFD can already exist in the string though
[18:51:25] <engla> that doesn't make it insecure though
[18:51:34] <kermi> I'm trying to print out a vector of type ~[~str], how do I do so as individual strings, because when I print it out it prints it out as such: ~[~"Test line 1", ~"test line 2"]?
[18:51:36] <strcat> it's insecure because you now have different strings comparing as equal
[18:51:54] <annevk> strcat: false
[18:51:59] <engla> that depends on context
[18:52:01] <annevk> strcat: it's not a string until you convert the bytes
[18:52:11] <cmr> kermi: each on a different line?
[18:52:19] <strcat> annevk: that's not the point I was making
[18:52:30] <strcat> it's semantically a string regardless of how it's currently stored, if you plan on decoding it
[18:52:38] <kermi> yep, they're each on a different line in the file and I just want them to print on different lines
[18:52:39] <annevk> strcat: if your point is that different byte sequences can compare equal after decoding that seems valid
[18:52:46] <engla> it's kind of relevant strcat because you can choose to reject it instead
[18:52:46] <annevk> strcat: but that's not insecure
[18:52:47] <cmr> kermi: iterate over the vector and print each string
[18:53:02] <annevk> strcat: ignoring errors is insecure
[18:53:08] <strcat> annevk: no more insecure
[18:53:15] <cmr> rusti: let v = ~[~"abc", ~"def"]; for s in v.iter() { println(s) }
[18:53:16] <strcat> annevk: the replacement character can already exist in the string
[18:53:19] *** Joins: lkuper (lkuper@6B909B2F.B27ED99A.284344F5.IP)
[18:53:21] <annevk> strcat: as e.g. you might miss bogus EOF 
[18:53:34] <cmr> rusti: 5
[18:53:39] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:53:49] <annevk> strcat: again, that doesn't make it insecure
[18:54:00] <strcat> annevk: so please explain where ignore is insecure where replace isn't
[18:54:05] <annevk> strcat: EOF
[18:54:11] <strcat> annevk: how is that insecure?
[18:54:17] <strcat> replace is going to just replace it with \uFFFD?
[18:54:25] <strcat> ignore would not insert a character there
[18:54:35] <annevk> yeah, so you miss that a part of the stream got cut off
[18:54:39] <annevk> that's terrible
[18:54:43] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:54:49] <strcat> you miss that part with replace too
[18:54:49] <annevk> anyway, I recommend you read up on the Unicode standard
[18:55:10] <olsonjeffery> annevk: let's keep this constructive, please.
[18:55:25] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[18:56:58] *** Quits: lkuper (lkuper@6B909B2F.B27ED99A.284344F5.IP) (Ping timeout)
[18:57:24] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[18:57:26] <strcat> 0x04 is a valid code point anyway
[18:58:02] *** Quits: kermi (Mibbit@moz-5AF9AA47.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[18:58:06] <strcat> and utf-8 encodes it as 0x04
[18:58:12] <engla> dbaupp: about decoders, you talked about inserting arbitrary strings on decoder error, is there a use case in mind?
[19:00:53] <engla> the decoder can emit information with the condition, to signal if it's EOF or invalid byte
[19:01:34] <annevk> I was talking about the case where you hit EOF and there's a missing trail byte
[19:01:41] <engla> exactly that
[19:02:19] <annevk> In any event, U+FFFD has the semantic of indicating an error, just omitting the errors will also make unequal byte sequences equal, but hiding that fact.
[19:02:55] <annevk> That's why it's either U+FFFD (graceful) or terminate with failure (draconian)
[19:03:14] * flaper87 wonders were chris-morgan is :D
[19:04:43] <strcat> dbaupp: can we already mark stuff as deprecated?
[19:04:51] <cmr> flaper87: australia! or thereabouts.
[19:05:51] <flaper87> cmr: good to know, thanks :)
[19:07:02] <SimonSapin> olsonjeffery: I donâ€™t think there is any correctness problem with UTF-8 stuff thatâ€™s in std::str. Itâ€™s only that we may not want to have two implementations of the same thing.
[19:07:13] *** ozten|afk is now known as ozten
[19:07:28] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[19:07:35] <olsonjeffery> SimonSapin: i think brson wanted to know if we could just pull that one in and put it behind a trait impl
[19:07:37] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:07:45] <olsonjeffery> which makes sense, except for the above-mentioned error-handling
[19:07:51] <SimonSapin> agreed
[19:08:15] <olsonjeffery> SimonSapin: would you be willing to flush out what you imagine as an ideal encoder/decoder api?
[19:08:20] <olsonjeffery> i gather it looks a lot like what's in rust-encoding
[19:08:32] <olsonjeffery> but takes an enum ErrorStrategy { ... } in feed() ?
[19:08:36] <SimonSapin> std::str::from_str could call the decoder with a fixed error handling mode
[19:09:13] <olsonjeffery> i really want to reach the point where there's something *actionable* that we could conceivable move forward with
[19:09:17] <olsonjeffery> and bring that to the community to discuss
[19:09:20] <olsonjeffery> ASAP
[19:09:23] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Connection reset by peer)
[19:09:30] <SimonSapin> olsonjeffery: let me draft up something quickly
[19:09:32] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:09:38] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[19:10:41] <annevk> olsonjeffery: well, you need to settle on strings, and rust strings are incompatible value-space wise with the web
[19:11:17] <kimundi> What exactly does 'value space' mean in this context?
[19:12:03] <kimundi> 'set of all valid values for that type' ?
[19:12:15] <annevk> utf-8 doesn't do U+D800 - U+DFFF (iirc that's the range)
[19:12:25] <strcat> rust strings are just the full valid (not surrogates) set of ucs4 code points
[19:12:42] <strcat> annevk: yeah those are the surrogates
[19:12:53] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:13:27] *** Joins: Florob (Florob@moz-39532932.de)
[19:13:31] <strcat> they're reserved for utf-16 to use internally
[19:13:38] <annevk> (plus of course with utf-8 you don't have sharing with the current ECMAScript engine, making things slower, no fast indexing for strings accessed by it, etc.)
[19:13:46] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[19:13:46] *** ChanServ sets mode: +qo graydon graydon
[19:13:50] <kimundi> That... doesn't directly answer my question :P
[19:13:59] <annevk> kimundi: the web is 16-bit code units
[19:14:00] <strcat> graydon: \o
[19:14:01] *** Parts: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP) ()
[19:14:16] <annevk> kimundi: which is kinda fundamentally incompatible with utf-8 strings
[19:14:33] <strcat> annevk: so it's actually ucs2? not utf-16?
[19:14:38] <strcat> javascript at least
[19:15:25] <annevk> strcat: yeah I don't see why everyone keeps confusing it with utf-16, there's some utf-16 aspects in JS, but it's fundamentally 16-bit code units, you can call it ucs2 I suppose, though that's not referenced anywhere and obsolete(?)
[19:15:44] <strcat> annevk: yeah it's obsolete, but I guess it's what it was designed to be
[19:15:51] <annevk> And everything JavaScript interacts with, such as HTML, DOM, CSS, URLs, encodings, ...
[19:15:57] <strcat> before they decided unicode would be 21-bit, not 16-bit
[19:16:09] <kimundi> annevk: I get that, my question is what the term 'value space' is :P I'm infering here that I'm interpreting it correctly as "set of all valid values", which in the case of utf8n means "all unicode codepoints except surrogate pairs" and in the case of web strings means u16.
[19:16:24] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[19:16:30] <strcat> annevk: ah
[19:16:56] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:16:59] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[19:17:05] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[19:17:14] <annevk> kimundi: utf-8 can do Unicode scalar values, JavaScript can do 16-bit code units, one goes higher than U+FFFF, but can't do D800-DFF, the other doesn't go higher than U+FFFF, but can do D800-DFFF and might have magic meaning in higher layers
[19:17:29] <annevk> for surrogate pairs
[19:18:04] <kimundi> ...
[19:18:14] <kimundi> "Yes, that's what value space means"
[19:18:40] <strcat> ugh, LLVM is really dumb sometimes
[19:19:04] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[19:19:05] <SimonSapin> olsonjeffery: like this maybe? http://pastebin.mozilla.org/3010178
[19:19:12] <annevk> kimundi: ...
[19:19:50] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[19:20:00] <kimundi> annevk: I really get the difference between the two, I'm just unfamiliar with the term "value space".
[19:20:18] <strcat> it doesn't know how to transform 'b = alloca(64); memcpy(b, a); memcpy(c, b)' to 'memcpy(c, a)'
[19:20:33] <strcat> makes our returns really slow
[19:20:45] <ecr> SimonSapin, olsonjeffery: why not do error handling through conditions?
[19:20:59] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[19:21:03] <SimonSapin> ecr: maybe?
[19:21:05] <annevk> SimonSapin: XMLEntities?
[19:21:13] <strcat> most of the string API should probably work without the runtime
[19:21:19] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Quit: victorporof)
[19:21:29] <SimonSapin> annevk: thatâ€™s the name of &foo;
[19:21:32] <strcat> at least, if we use conditions we will have to write the same thing without conditions too
[19:21:37] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[19:21:46] <annevk> SimonSapin: per who?
[19:21:59] <ecr> SimonSapin: I guess it really depends on how common and how fatal errors are. I really don't know what the proper balance is. Using conditions really cleans up the I/O interface though.
[19:21:59] <engla> You can have both static error handling or conditions as alternatives. It's just a bit confusing
[19:22:00] <annevk> SimonSapin: it's a character reference
[19:22:04] <SimonSapin> annevk: per XML and HTML?
[19:22:21] <SimonSapin> maybe Iâ€™m confusing stuff
[19:22:24] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[19:22:39] <strcat> ecr: it seems that the only thing they're discussing is adding an option to use replacement chars as an alternative to returning Option
[19:22:44] <kimundi> conditions that work without the runtime would be nice... Maybe something using an mutable static ?
[19:22:50] <strcat> kimundi: nope
[19:22:55] <strcat> no runtime doesn't mean no threads
[19:22:55] <annevk> SimonSapin: decimal character reference even, I suppose
[19:22:58] <engla> strcat: I've got an implementation of that choice for benchmarking. of course static replacedefault is much quicker than doing it via a condition
[19:23:07] <kimundi> strcat: fair enough
[19:23:18] <engla> strcat: as well as knowing what the invalid bytes are and at what offset(?)
[19:23:36] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:23:36] *** ChanServ sets mode: +o pnkfelix
[19:23:49] <strcat> engla: well, I'm not really concerned about performance
[19:23:54] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[19:24:03] <SimonSapin> annevk: ok, I was still using HTML4 terms
[19:24:04] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:24:08] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[19:24:11] <strcat> I'm concerned about libstd moving further away from working without the runtime/scheduler
[19:24:14] <annevk> SimonSapin: pointer?
[19:24:52] <SimonSapin> http://www.w3.org/TR/REC-html40/charset.html#didx-character_entity_references
[19:25:04] <engla> yeah it's a good point strcat but I don't see std::str being merged with an encodings module
[19:25:06] <kimundi> strcat: Hm, idea: A way to inject a TLS like storage in the call stack. Instead of accessing TLS, you would walk up the stack till you find it. Probably a bad idea though...
[19:25:15] <strcat> SimonSapin: html5 has a ridiculous number of those :P
[19:25:26] <strcat> since you can leave off the semicolon on some, etc.
[19:25:27] <kimundi> Would enable you to set it up without a runtime though
[19:25:47] <SimonSapin> strcat: yeah, but this encoding error handling only uses decimal ones
[19:25:51] <annevk> SimonSapin: doesn't say XML entity though :p; Anyway, I'd put some kind of warning in those decode stuff
[19:25:54] <strcat> SimonSapin: ah
[19:25:58] <annevk> SimonSapin: or prefix thigns with legacy
[19:26:28] <SimonSapin> annevk: ok, itâ€™s actually "entity reference" http://www.w3.org/TR/REC-xml/#sec-references
[19:26:35] <annevk> SimonSapin: when decoding, emitting &#..; or ? is bad as it doesn't have the same meaning as FFFD
[19:26:40] <SimonSapin> annevk: and I agree using modern spec terms is better
[19:27:01] <annevk> SimonSapin: euhm that says "character reference" just as I said
[19:27:05] <strcat> anyway sret + noalias on the ret slot helps but not enough
[19:27:05] *** Joins: pfox__ (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[19:27:13] <annevk> SimonSapin: HTML does too
[19:27:15] <strcat> oh and nocapture too, but it detects that itself
[19:27:22] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[19:27:30] *** Parts: pfox__ (pf@B8927AE1.CFEFA148.239A1A9E.IP) ()
[19:29:03] <SimonSapin> olsonjeffery, annevk: http://pastebin.mozilla.org/3010199
[19:29:14] <SimonSapin> anyway, Iâ€™m not super attached to naming
[19:29:22] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:29:39] <annevk> I wouldn't prefix it with XML, it's used primarily in HTML
[19:29:41] <olsonjeffery> SimonSapin: Replacement be Replacement(char) ?
[19:29:42] <annevk> and it's bad
[19:29:45] <olsonjeffery> or Replacement(str) ?
[19:30:01] <olsonjeffery> iow should that error handling mode provide the substitution char by default..
[19:30:18] <kimundi> just Replacement; maybe? FFFD only?
[19:30:20] <SimonSapin> olsonjeffery: no. Itâ€™s always U+FFFD for decoding and 0x3F (ASCII '?') for encoding
[19:30:27] * olsonjeffery nods
[19:30:43] <ecr> hm. I compiled with rtdebug set, but it doesn't seem to be printing. Am I missing a runtime flag?
[19:30:58] <engla> SimonSapin: if you are decoding to ascii, you would use '?' as replacement though
[19:31:03] <olsonjeffery> SimonSapin: what about possible conditions? do you think they should be omitted?
[19:31:04] <kimundi> --cfg debug?
[19:31:05] <engla> as in  [u8] -> Ascii
[19:31:35] <annevk> engla: you'd only decode to Unicode...
[19:31:36] <SimonSapin> annevk: I donâ€™t care about the name, other than slightly preferring describing what it does rather than where itâ€™s used
[19:31:52] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:31:52] *** ChanServ sets mode: +o tjc
[19:31:53] <ecr> kimundi: unrecognized option. I think that's the option to rustc to compile in the debug statements.
[19:32:04] <engla> annevk: .. not always
[19:32:18] <SimonSapin> engla: do you mean decoding *from* ASCII or *encoding* to ASCII?
[19:32:24] <kimundi> ecr: actuly fro debug! statements it pretty much is
[19:32:43] <engla> you can only decode from bytes SimonSapin. [u8] --Decoder -> Ascii
[19:32:44] <kimundi> You have to set the debug cfg, which happens with --cfg debug
[19:32:54] <SimonSapin> olsonjeffery: what do you mean, possible conditions? Using http://static.rust-lang.org/doc/tutorial-conditions.html for error handling?
[19:33:09] <olsonjeffery> yeah.
[19:33:16] <ecr> kimundi: right, but that's a compile option. I already did that.
[19:33:53] *** Quits: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch) (Client exited)
[19:33:59] <SimonSapin> engla: I was thinking of [u8] that contains ASCII -> str
[19:34:06] <kimundi> ecr: Where exactly do you want to enable the debug! statments?
[19:34:29] <SimonSapin> engla: I donâ€™t think that [u8] -> ASCII should be a Decoder at all
[19:34:42] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[19:34:42] <engla> ok. I'm thinking of when you have a &[u8] of bytes and you have charset=ASCII or whatever, for each byte you do   if b < 128 then b as ascii else Error.
[19:34:52] <engla> ok, maybe it's out of scope
[19:35:00] <ecr> kimundi: they're in some tests. I ran 'make check-stage1-std CFG_ENABLE_DEBUG=1' (which calls the compiler with --cfg debug).
[19:35:12] <kimundi> ecr: In general, any binary has to be compiled with --cfg debug, and then run with the RUST_LOG environment variable set to the values of the module you want to log
[19:35:31] <engla> SimonSapin: normally the decoder uses a replacement char that's inside the codec
[19:35:40] <ecr> oh, maybe that's it. I don't have RUST_LOG anything
[19:35:52] <SimonSapin> olsonjeffery: my proposal above does not use conditions at all. An alternative with conditions would not have "errors" parameters or related types
[19:36:10] <ecr> kimundi: so what would I set RUST_LOG to here?
[19:36:14] <ecr> debug?
[19:36:36] <SimonSapin> engla: why? by which norm? Thatâ€™s not what the WHATWG spec says, and there no reason to use anything but U+FFFD when decoding to str
[19:36:47] <SimonSapin> (the last part is IMO)
[19:36:52] <kimundi> ecr: No, it's some weird format where you specify both the modules you want to log from, and the log levels
[19:37:00] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[19:37:07] <ecr> *sigh*
[19:37:19] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[19:37:28] <ecr> is this documented somewhere?
[19:37:38] <strcat> ecr: RUST_LOG=module=1
[19:37:40] <strcat> like
[19:37:42] <strcat> RUST_LOG=rustc=1
[19:37:46] <strcat> ecr: it might be documented somewhere
[19:37:48] <strcat> ;p
[19:37:57] <kimundi> somewhere mayhaps: https://github.com/mozilla/rust/wiki/Docs
[19:38:20] <ecr> I assume it uses fully qualified modules? so mine would be std::rt::io::net::tcp::test?
[19:38:56] <kimundi> I'd assume fully qualified from inside the crate. So if it'S libstd itself, drop the std:: prefix
[19:38:59] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[19:39:32] <SimonSapin> engla: I donâ€™t know when std::ascii::Ascii is useful at all, but itâ€™s special enough that Encoder and Decoder do not need to deal with it IMO
[19:40:01] <annevk> SimonSapin: fwiw, the reason I use URL / <form> is that I don't want other contexts to use those
[19:40:18] <annevk> SimonSapin: they're bad forms of error handling
[19:40:18] <engla> SimonSapin: I don't have a norm to reference to. This is what Python does and it seems natural to me, that if I ask for ascii input and invalid sequences be replaced, those sequences are replaced with valid ascii
[19:40:26] <annevk> SimonSapin: URL arguably less...
[19:40:28] <engla> SimonSapin: same for any encoding
[19:40:54] <annevk> SimonSapin: that's encoding, not decoding
[19:41:12] *** Joins: maxli (maxli@moz-3643BFA.net.uwaterloo.ca)
[19:41:32] <ecr> and RUST_LOG doesn't work. are you sure that's necessary for rtdebug? the implementation seems completely separate from the other logging code
[19:41:45] <SimonSapin> annevk: I donâ€™t have a strong opinion on that
[19:42:04] *** Quits: maxli (maxli@moz-3643BFA.net.uwaterloo.ca) (Quit: Leaving.)
[19:43:03] <SimonSapin> engla: python on my machine uses U+FFFD
[19:43:24] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[19:43:51] <SimonSapin> annevk: again, naming.
[19:44:32] <annevk> Yes, and it's important
[19:45:24] <SimonSapin> Iâ€™d rather have naming discussion after we agree on an API
[19:45:28] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[19:45:46] <SimonSapin> eg. using Rust conditions for error handling or not
[19:46:12] <engla> SimonSapin: ok, I must have the wrong idea
[19:46:16] <engla> about Python
[19:48:24] <engla> I think it must have changed in some version
[19:49:12] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[19:49:12] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[19:49:20] <olsonjeffery> ugh.
[19:49:44] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[19:50:08] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[19:50:42] <kimundi> SimonSapin: Imo a hypothetical Encoding/Decoding api should be able to transform any source encoding into any target encoding. Like, [u8] -> str needs to validate, [Ascii] -> str can just pass the values through, same with str -> str_utf16 etc
[19:51:28] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[19:52:25] <SimonSapin> kimundi: I disagree
[19:52:48] <SimonSapin> encodings fundamentally convert between bytes and "text"
[19:53:21] <SimonSapin> bytes are just bytes: [u8]. This API could be generic over the type representing text, but Iâ€™m not sure it should
[19:53:40] *** Joins: squiddy (squiddy@moz-CD26F336.adsl.alicedsl.de)
[19:53:48] <kimundi> <There are more sources than just bytes, and more than one type for text
[19:54:54] <SimonSapin> kimundi: what does "source" mean?
[19:55:27] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:55:41] *** Parts: annevk (annevk@DF1341F2.4F390C2A.420B7681.IP) ()
[19:55:43] <kimundi> A [Ascii] can not contain all unicode codepoints, but it _does_ contain only valid codepoints.
[19:56:05] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:56:05] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/l-vxrg
[19:56:05] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:56:25] <kimundi> You can't use a [Ascii] for storing unicode text, but you can convert from it without having to go through bytes and checks
[19:56:49] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[19:57:09] <kimundi> (Of course, wether this is relevant in the grant scheme of things is an other question)
[19:57:34] <engla> kimundi: ascii, str and str16 could just be different representations of unicode strings. so it's tangential
[19:57:51] <SimonSapin> transforming &[Ascii] to and from &str is basically transmute (modulo checks.) It has nothing to do with encodings IMO
[19:59:24] *** Quits: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP) (Ping timeout)
[20:00:00] <SimonSapin> fn(&[u16]) -> str is more than transmute and may share code with the UTF-16 encoding, but itâ€™s not a Decoder in the sense of rust-encoding
[20:00:22] <kimundi> Well, ascii is a bit of a simple example here. Imagine all the windows code pages, that need custom mappings from/to unicode code points. Maybe they are irrelevant, but imo it wopuld be nice if there could be an uniform scheme for handling such things.
[20:00:53] <SimonSapin> kimundi: yes, they would be represented as [u8]
[20:01:06] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:01:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/uPKSRw
[20:01:07] <ghrust> 13rust/06auto 14889e1b9 15Daniel Micay: add `noalias` attribute to ~ return values
[20:01:07] <ghrust> 13rust/06auto 1454ae280 15bors: auto merge of #9071 : thestinger/rust/noalias, r=alexcrichton...
[20:01:07] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:01:07] <kimundi> SimonSapin: They would loose informations though
[20:01:15] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[20:01:15] *** ChanServ sets mode: +ao brson brson
[20:01:15] <SimonSapin> how so?
[20:01:32] <kimundi> In the same sense that storing a str as [u8] looses informations
[20:01:57] <SimonSapin> you can newtype ~[u8] for a specific code page if you like, I donâ€™t think the Encoding API has to know about it
[20:01:57] <kimundi> We give those types a newtype wrapper to encapsulate invariants about their content
[20:02:39] *** Joins: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP)
[20:03:22] <kimundi> A Ascii is a u8 where ther first bit is allways 0. A str is a [u8] where the bytes form an valid utf8 encoding without surrogate pairs. An hypothetical latin1 contains byte values that map to specific unicode codepoints etc.
[20:03:24] <SimonSapin> Sane text encoding uses Unicode internally and only decodes/encode when needed, typically for I/O. And I/O uses [u8]
[20:03:47] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Ping timeout)
[20:04:01] <SimonSapin> yeah, thatâ€™s all fine, but I donâ€™t think these types need to be in the Encoding API
[20:04:37] <kimundi> Maybe I should just stop talking here, I don't oversee the design space enough to really know what I'm arguing about. :P
[20:06:11] <kimundi> Can always refactor later. :P
[20:06:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:08:28] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Ping timeout)
[20:08:32] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[20:09:12] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[20:09:19] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[20:09:31] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[20:10:26] *** Joins: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP)
[20:11:13] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[20:14:32] *** Joins: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP)
[20:15:02] <engla> SimonSapin: not sure if this is too cute, but the decoder error handling may be a Type variable instantiated by struct Fatal; struct ReplaceDefault; that way the decoder can compile to different code statically
[20:15:42] <SimonSapin> could be
[20:15:52] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:16:00] <SimonSapin> but I would measure how much it really helps before doing it
[20:16:25] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:16:41] *** Quits: ww (Mibbit@moz-DFAED48A.lightspeed.sntcca.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:17:28] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:17:28] *** ChanServ sets mode: +o pnkfelix
[20:18:29] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:18:30] *** Quits: ziad (ziad@moz-5003F925.members.linode.com) (Ping timeout)
[20:18:50] *** Eridius|vacation is now known as Eridius
[20:19:21] *** Quits: rfw (rfw@moz-7D453A5B.rfw.name) (Ping timeout)
[20:19:27] *** Quits: balpert (balpert@moz-7E5ED302.members.linode.com) (Ping timeout)
[20:20:09] *** Quits: shachaf (shachaf@moz-F37E0395.members.linode.com) (Ping timeout)
[20:20:32] *** Quits: BigEndian (hurp@moz-1B6DD81E.members.linode.com) (Ping timeout)
[20:20:33] *** Joins: BigEndian (hurp@moz-1B6DD81E.members.linode.com)
[20:21:34] *** Quits: squiddy (squiddy@moz-CD26F336.adsl.alicedsl.de) (Quit: Leaving)
[20:21:37] <SimonSapin> olsonjeffery: If using condition, the question is what signature the conditions should have
[20:21:55] *** Joins: rfw (rfw@moz-7D453A5B.rfw.name)
[20:22:08] <engla> SimonSapin: I tested the overhead of conditions
[20:22:19] <SimonSapin> engla: and?
[20:22:33] <engla> so there are benchmarks for that at least. https://gist.github.com/anonymous/904d9e4c90a1a199f452  it's mostly a non-overhead
[20:22:49] *** Joins: balpert (balpert@moz-7E5ED302.members.linode.com)
[20:23:32] *** Joins: shachaf (shachaf@moz-F37E0395.members.linode.com)
[20:24:52] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[20:25:20] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:25:44] <SimonSapin> (engla: side comment, PutBack seems a lot like str::iterator::Peekable)
[20:25:54] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:26:14] <engla> yes
[20:26:54] <engla> absolutely, but in this case put_back is used seldomly so in my mind this would be simpler and better
[20:27:27] <SimonSapin> isnâ€™t it the same?
[20:28:13] <engla> with Peekable I would have to use .peek() everywhere and in all the non-error cases then use .next() to acknowledge the peek
[20:28:31] <engla> I don't know, it would be the same but I think the expression is more convoluted
[20:28:53] *** Quits: shachaf (shachaf@moz-F37E0395.members.linode.com) (Ping timeout)
[20:28:54] <SimonSapin> ah, I see
[20:29:25] *** Quits: rfw (rfw@moz-7D453A5B.rfw.name) (Ping timeout)
[20:29:32] <flaper87> is it possible to kill a child task? 
[20:29:37] <SimonSapin> Peekable could also have a put_back method
[20:29:56] *** Quits: Eridius (kevin@moz-533B0DB4.us) (Ping timeout)
[20:30:27] *** Quits: BigEndian (hurp@moz-1B6DD81E.members.linode.com) (Ping timeout)
[20:30:54] *** Joins: BigEndian (hurp@moz-1B6DD81E.members.linode.com)
[20:31:37] <kimundi> flaper87: Send it an message that causes it to end or fail
[20:31:38] <SimonSapin> engla: anyway, Iâ€™m more interested in whether or not decoding/encoding error handling should be open-ended than in the overhead
[20:31:38] <engla> yes. Maybe the put back way to use it is actually easier. I don't know if you already said this though
[20:31:54] <kimundi> flaper87: Or use linked failure
[20:32:02] *** Joins: valenting (Thunderbir@BC8F8C4C.4ABED146.FB866788.IP)
[20:32:15] *** Joins: shachaf (shachaf@moz-F37E0395.members.linode.com)
[20:32:16] <engla> ok. using whatwg's few modes sounds wonderful for implementors
[20:32:21] *** Joins: Eridius (kevin@moz-533B0DB4.us)
[20:32:27] <engla> does servo need anything like encoding invalid bytes into escapes?
[20:32:51] *** Joins: rfw (rfw@moz-7D453A5B.rfw.name)
[20:33:30] <flaper87> kimundi: mmhh, linked failure would work just from inside the task, right?
[20:33:32] <SimonSapin> engla: put_back is indeed sometimes easier. I just hadnâ€™t thought of it :) I often have code that uses peek() and then next() without using the result of next()
[20:33:37] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:34:01] <SimonSapin> engla: Servo needs exactly whatâ€™s in the WHATWG spec, so no
[20:34:32] *** Quits: miza (miza@moz-4DD51325.home.otenet.gr) (Input/output error)
[20:34:39] <kimundi> flaper87: I don't understand the question. :)
[20:34:52] *** Joins: miza (miza@moz-4DD51325.home.otenet.gr)
[20:35:27] <SimonSapin> engla: which is why, even with conditions, the signature is important. Does the condition for decoding error get the invalid byte sequence, or no parameter at all? Does it return any string, any single code point, or just replacement/fail?
[20:36:14] <flaper87> kimundi: sorry, you said, send a message that would make it end or use linked failure
[20:36:39] <flaper87> both options have to happen from within the task, meaning, I'll have tos end a msg to it
[20:37:05] <kimundi> linked failure doesn't have to happen from inside the task you want to fail
[20:37:39] <kimundi> you linke the task to some other task. and bring the other task to fail. then the first task will also failing
[20:38:15] <engla> SimonSapin: so that Rust users can be friendly to their users, shouldn't it have the invalid byte sequence (basically 1-3 bytes) and its offset?
[20:38:35] <SimonSapin> engla: I donâ€™t know. It is really useful?
[20:38:54] <flaper87> kimundi: ah, ok, gotcha.
[20:39:22] <engla> SimonSapin: I'm thinking of things like the compiler saying, invalid byte 0xFG on line 10, col 3
[20:39:26] <SimonSapin> engla: eg. will we eventually need what Python calls surrogate escapes, or can we get away with not having it?
[20:39:59] <SimonSapin> maybe
[20:40:01] <engla> I don't know this
[20:40:15] <SimonSapin> although counting lines is yet another story
[20:40:25] <engla> yep
[20:40:36] <SimonSapin> engla: neither do I. This is why API design is hard :)
[20:40:42] *** Joins: tikue (tkuehn@61D12352.CD72397.689607DE.IP)
[20:41:02] <engla> dbaupp: ping
[20:41:29] <kimundi> My gut feeling would be: better provide more information about the error than less
[20:41:29] <SimonSapin> I suppose this discussion would be better on the mailing list
[20:41:41] <cmr> definitely
[20:41:58] <engla> yes kimundi. And for Rust programmers in general they will want to know, aha, so at byte offset 102 there is an invalid byte
[20:42:04] <engla> instead of just <invalid encoding>
[20:42:29] <SimonSapin> kimundi: if a single invalid byte sequence is split accross multiple .feed() calls, is it worth the hassle of keeping it all for error handling that might not need it?
[20:42:39] <kimundi> maybe a byte offset and length, and if you need to know line, collume, content of that you can puzzle it together yourself?
[20:42:51] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:42:57] <engla> SimonSapin: it need to be kept to be decoded anyway? ok.. maybe not, but it's not much work
[20:43:15] <SimonSapin> I donâ€™t know
[20:43:25] <engla> for the utf-8 decoder it's ok
[20:43:43] *** Quits: valenting (Thunderbir@BC8F8C4C.4ABED146.FB866788.IP) (Ping timeout)
[20:46:06] <kimundi> SimonSapin: What does feed() do? In general I wouldn't find it strange to say "the condition gives you an slice into the invalid byte sequence. No guarantees are made about whether the slice covers the whole invalid sequence, and about whether you get consecutive raised conditions for fragments of the same invalid byte sequence"
[20:46:57] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:46:59] <kimundi> Basically, if you can provide an byte offset for cheap, give it the user. He can puzzle the rest together if he needs to
[20:47:07] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Quit: victorporof)
[20:47:14] <SimonSapin> in http://pastebin.mozilla.org/3010178 feed() takes a chuck of input
[20:47:38] <SimonSapin> This is a "push" API. It could be "pull" with an iterator instead.
[20:48:52] *** Quits: jviereck (Adium@moz-58A87BA7.dip0.t-ipconnect.de) (Quit: Leaving.)
[20:48:59] <SimonSapin> I donâ€™t know if counting offsets is cheap enough to be worth it
[20:49:21] <SimonSapin> and I donâ€™t know if somebody will come up with a case where that lack of guarantee is not good enough
[20:49:32] <kimundi> Do you call feed multible times with chunks of the input until you're done? 
[20:49:44] *** Quits: jclements (jclements@moz-9C0ABCFC.wireless.calpoly.edu) (Quit: jclements)
[20:49:44] <SimonSapin> yes
[20:49:53] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:50:05] <kimundi> So you need to keep state between two feed calls, right?
[20:50:06] <SimonSapin> should have explained that in comments, sorry
[20:50:09] <SimonSapin> yes
[20:50:17] <SimonSapin> but state is encoding-specific
[20:50:34] <SimonSapin> eg. single-byte encoding donâ€™t have any
[20:51:00] <SimonSapin> https://github.com/lifthrasiir/rust-encoding is very close to this, if you want to look at code
[20:51:05] <kimundi> Is feed meant for the user, or for being tucked away in the API somewhere?
[20:51:36] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[20:52:43] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:53:35] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[20:53:57] <kimundi> Or asked an other way: Do you have an one Decoder per logical input (eg. a file), or is the same Decoder meant to just be used for all inputs you want to handle?
[20:54:49] *** Joins: jstevans1 (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP)
[20:55:38] <Ms2ger> Surely you'll need a different decoder depending on how the input is encoded
[20:55:47] *** Quits: jstevans (Instantbir@A44743FB.11F57C02.B7830B68.IP) (Ping timeout)
[20:56:45] <kimundi> Ms2ger: Right, what I meant is, if you have two identical encoded files that you want to concatenate in a string, would you shovel both into the same Decoder, or would each get their own Decoder with a concat step once they are strings.
[20:56:59] <Ms2ger> Each their own decoder
[20:57:05] <Ms2ger> Well
[20:57:11] <Ms2ger> Unless you can reset it
[20:57:36] <Ms2ger> But that's more of an optimization
[20:58:07] <Ms2ger> But you can't just stream them one after the other into one decoder, without telling the decoder you're doing that
[20:58:12] <Ms2ger> (in general)
[20:58:28] <SimonSapin> one Decoder instance per input
[20:59:05] *** Joins: jstevans (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP)
[20:59:13] *** Quits: jstevans1 (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP) (Connection reset by peer)
[20:59:14] <SimonSapin> and the feed/flush API is for incremental decoding, when you donâ€™t want to have the whole input in memory before you can start decoding
[20:59:56] *** Joins: boredomist (user@8186917.CC8FA3EE.E3401B6E.IP)
[21:00:00] <SimonSapin> there would be a convenience API on top of it that takes a single string/vector and return an encoded/decoded vector/string
[21:00:24] <SimonSapin> this is the TODO in http://pastebin.mozilla.org/3010178
[21:00:34] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[21:01:42] *** Quits: eagen (eagen@8737942B.7A99C13A.B7961A98.IP) (Quit: Leaving)
[21:01:52] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[21:02:40] <kimundi> I think I'd find a pull API with an iterator more elegant. A Pull api would work based on steps of valid output, while a push api works based on steps of un-analysed input.... Just my personal preference though.
[21:04:08] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:04:57] <SimonSapin> the thing is, a pull API is easy to build on top of a push API, but the reverse require tasks
[21:05:33] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[21:05:37] <SimonSapin> maybe the API could also have pull "sugar" on top of a push implementation
[21:05:47] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[21:05:53] *** Quits: Ms2ger (Ms2ger@9C9504FF.4EC82F13.3773EA9F.IP) (Quit: nn)
[21:06:06] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:06:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/uPKSRw
[21:06:06] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:06:20] <kimundi> Ah, if that's the case, then yeah, do it as push, but maybe use it as building block. :P
[21:07:08] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[21:07:11] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[21:07:22] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[21:07:54] <ecr> fish
[21:07:56] <ecr> gah
[21:08:14] <SimonSapin> also, if you want to read/decode incrementally but have the result in a single string, an iterator requires copying
[21:08:21] <kimundi> haha, wrong terminal window ;)
[21:08:26] * ecr needs to stop trying to use IRC as his shell
[21:08:39] <cmr> How is fish?
[21:09:04] <ecr> cmr: I like it. Only thing I really miss is vim bindings for command line editing
[21:09:09] <cmr> mm
[21:09:25] <kimundi> SimonSapin: Could you ellaborate?
[21:09:32] <cmr> I'll have to give it a spin; it looked nice when I checked it out.
[21:10:14] <ecr> cmr: the syntax changes take a little while to get used to, but it's soooo much better than bash syntax
[21:10:22] <kimundi> I'm also using fish, but I'm kinda missing bash autocomplete
[21:10:26] <SimonSapin> kimundi: with the linked proposed API, I can have one 'output' string and give it to every .feed() call so that they all append to the same string
[21:10:35] <cmr> I use zsh
[21:10:36] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[21:11:00] <SimonSapin> if each .feed() call (or iterator.next()) returned a new ~str, I would have to copy them to concatenate them
[21:11:01] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:11:01] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/NPiUTQ
[21:11:01] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:11:03] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:11:03] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/KKyzGQ
[21:11:03] <ghrust> 13rust/06auto 14c3d0fc2 15David Creswick: Implement bitwise operations on BigUint
[21:11:03] <ghrust> 13rust/06auto 14ed695d4 15bors: auto merge of #9083 : dcrewi/rust/biguint-bit-ops, r=brson
[21:11:03] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:11:10] <ecr> I've always found fish autocomplete superior to bash's, but maybe I'm just missing something
[21:12:02] <kimundi> SimonSapin: Ah, I think that would be possible with Iterators too. Just .extend() the string with the Iterator?
[21:12:53] <SimonSapin> kimundi: thatâ€™s assuming iterators of big chuncks for performance, not iterators of single bytes/code points
[21:12:54] *** Joins: sinma (sinma@moz-6A11C47C.fbx.proxad.net)
[21:13:07] <sinma> hey, how to add an element to a vector?
[21:13:12] <kimundi> I guess it also depends on wether the iterators would produce single char's chunks of utf8
[21:13:25] <SimonSapin> sinma: v.push(e)
[21:13:32] <ecr> rusti: ~[1, 2, 3].push(4)
[21:14:04] <jeaye> There was talk of curses for Rust. Did anyone adopt it?
[21:14:06] <sinma> I didnâ€™t found it because I search it on Traits and Structâ€¦ :p
[21:14:08] <sinma> Thanks
[21:14:10] <kimundi> let mut v = ~[1, 3]; v.push(3); println(v.to_str());
[21:14:29] <jeaye> cmr: fish is pretty sexy. I generally use bash, but what I've used of fish has been pretty enjoyable.
[21:14:36] <SimonSapin> sinma: yeah, the docs need a lot of work :/
[21:15:06] <sinma> like everything else, right? :p
[21:15:15] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:15:15] <ghrust> 01[13rust01] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/DOMTww
[21:15:15] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:15:25] <SiegeLord> The parser's pretty good!
[21:16:24] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[21:17:52] <sinma> I donâ€™t find how to get the size of a vector
[21:17:58] <cmr> v.len()
[21:18:11] <sinma> So obviousâ€¦ thanks
[21:18:24] <kimundi> SimonSapin: Hm, one possible design for an Iterator decoder that doesn't operate on singular code points:
[21:18:25] <kimundi> [chunk1, chunk2, chunk3].decode_into(&mut v).run();
[21:18:28] <sinma> Itâ€™s in a specific trait?
[21:18:38] *** Joins: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr)
[21:18:44] <cmr> Yes, but I don't remember which one
[21:19:09] <SimonSapin> kimundi: so the output iterator has an additional method? Could work
[21:19:26] <kimundi> SimonSapin: DecodeInto woul basically give you an Iterator over (), where each call of next would process the next input chunk
[21:19:28] <ecr> sinma, cmr: I think it's in Container
[21:19:38] *** Joins: carllerche (carllerche@moz-CDE5367B.dsl.static.sonic.net)
[21:19:47] <ecr> ah, yes. Container provides len() and is_empty()
[21:20:02] <kimundi> SimonSapin: Could also be used as break point between chunks.
[21:20:26] <kimundi> for _ in [chunk1, chunk2, chunk3].iter().decode_into(&mut v) { task::yield(); }
[21:20:33] <sinma> ecr: ok
[21:20:45] <sinma> ecr: youâ€™re right
[21:20:51] <pcwalton> brson: r? https://github.com/mozilla/rust/pull/9086
[21:21:22] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[21:23:22] *** Quits: sinma (sinma@moz-6A11C47C.fbx.proxad.net) (Ping timeout)
[21:25:59] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:27:35] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[21:27:58] *** Joins: sinma (sinma@moz-6A11C47C.fbx.proxad.net)
[21:28:39] <sinma> If I want an iterator but in the reverse order, how must I do it? (and where to search in the doc for this kind of things?)
[21:28:47] *** Quits: jdm (jdm@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:29:09] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:29:15] <sinma> for i in my_vector.iter() { â€¦ } â† I want an iterator in the reverse order
[21:29:28] <cmr> sinma: well, for vector you can do my_vector.rev_iter()
[21:29:39] *** Joins: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:29:41] <kimundi> my_vector.iter().invert() also works
[21:29:56] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:29:59] <kimundi> Anything that has an DoubleEndedIterator implementation can be iterated in reverse order
[21:30:15] *** Joins: lbergstrom1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:30:15] *** Quits: lbergstrom (Adium@moz-BBE3ABD.mv.mozilla.com) (Input/output error)
[21:30:17] <tikue> rusti: let v = [1, 2, 3]; for &i in v.rev_iter() { print!("{} ", i); }
[21:30:21] <sinma> Ok, works
[21:30:39] <sinma> Why do you put & before i in your example?
[21:30:47] *** Joins: jdm (jdm@moz-BBE3ABD.mv.mozilla.com)
[21:30:47] *** ChanServ sets mode: +o jdm
[21:30:50] <sinma> (and why rusti doesnâ€™t apear?)
[21:30:52] <tikue> because iter() iterates over borrowed pointers
[21:30:56] <tikue> idk where rusti is :\
[21:31:10] <kimundi> sinma: That is an destructure pattern
[21:31:33] <tikue> rusti: let v = [1, 2, 3]; for &i in v.rev_iter() { print!("{} ", i); }
[21:31:44] *** Quits: ozten (ozten@moz-CFC6BCB5.dsl.dynamic.sonic.net) (Quit: ozten)
[21:31:56] <flaper87> kimundi: ah, ok, gotcha.
[21:31:58] <flaper87> ops
[21:32:04] <sinma> So you can use i like that
[21:32:25] <sinma> What I was doing is: for i in â€¦ { print!("{}", *i); }
[21:32:38] <tikue> sinma: that works too
[21:32:50] <tikue> yours doesn't copy
[21:32:51] <sinma> But the first is nicer I think
[21:32:59] <tikue> pattern matching with &i usually copies
[21:33:04] <sinma> Ok
[21:33:04] <tikue> i think
[21:33:17] <kimundi> sinma: [T].iter() gives you references to the elements: &T. The &i in the for syntax is a pattern that binds i to the implict copy of the dereference of the &T
[21:33:40] <sinma> Ok so itâ€™s better to keep i if I donâ€™t modify the value
[21:34:04] <kimundi> sinma: Doesn't matter in this case
[21:34:14] <tikue> implicit copies of ints is really cheap
[21:34:17] <kimundi> sinma: Can't copy through an & anyway
[21:34:21] <kimundi> err, modify
[21:35:24] <sinma> Ok. But it matters for struct, so itâ€™s better to get used to, or Iâ€™m wrong?
[21:36:25] <kimundi> It only matters if the struct is really big, and if the type you're iterating over has an destructor you can't make an implicit copy that way.
[21:36:45] <tikue> sinma: you can also destructure while still referencing fields
[21:37:08] <tikue> e.g., match Foo { bar: 1 } { Foo { ref bar } => â€¦
[21:37:11] *** Quits: tikue (tkuehn@61D12352.CD72397.689607DE.IP) (Quit: tikue)
[21:37:23] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:37:28] <kimundi> Rule of thumb: Only _don't_ use the &i pattern if the compiler yells at you.
[21:37:58] *** Joins: jclements (jclements@moz-9C0ABCFC.wireless.calpoly.edu)
[21:38:00] <kimundi> (Stuff gets optimzed away anyway)
[21:38:08] <sinma> ok captain!
[21:38:19] <jclements> anyone know if llvm-dis lives on my OS X machine somewhere?
[21:39:23] <tjc> jclements: I have it in /usr/local/bin/llvm-dis
[21:39:31] <tjc> if you installed the xcode command-line tools, then I think you must have it somewhere
[21:39:52] <sinma> Last question (I hope): it is possible to pass the first item of the iter()? (and then pass it to the loop)
[21:40:00] *** Joins: eatkinson (eatkinson@moz-C2126207.airbears2.berkeley.edu)
[21:40:03] <pnkfelix> jclements, tjc: I don't have llvm-dis
[21:40:15] <pnkfelix> (at least not on my path, let me try looking more thoroughly)
[21:40:39] <jclements> tjc: no, I'm not finding it. Grr. I suppose I could just schlep my bc over to a linux machine....
[21:41:03] <tjc> jclements: hmm, well, given how hard it is to install xcode, that might be the fastest way :-(
[21:41:16] <ecr> sinma: if you mean, can you call next() once and then do a for loop on the iterator (that's been advanced once step), then yes
[21:41:22] *** Joins: ceninan (ceninan@moz-6BD43586.a370.priv.bahnhof.se)
[21:41:30] <jclements> tjc: indeed: nothing makes me happier than downloading another 3 gigabyte bundle...
[21:41:31] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[21:41:44] <tjc> jclements: it's right up there with kittens and rainbows
[21:42:01] *** Joins: valenting (Thunderbir@BC8F8C4C.4ABED146.FB866788.IP)
[21:42:06] <jclements> tjc: no idea you felt that way about kittens. Do your kittens know about this?
[21:42:19] <tjc> jclements: fortunately they've already grown up to be cats, so they can't complain
[21:42:22] <flaper87> what would be the recomended way to do something like this? http://pastebin.mozilla.org/3010989 (not doing it? :P) I basically need to use s in the nested task
[21:42:38] <tjc> flaper87: you have to move it into the outer closure first
[21:42:46] <tjc> so, like, let s = s.clone() inside the outer closure
[21:42:50] <tjc> then you should be able to refer to s
[21:42:57] <tjc> (I find this to be kind of puzzling, but maybe I Don't Get It)
[21:43:32] <flaper87> tjc: mmh, well, I used ~"test" there but, what if it's not clonable ?
[21:44:04] <tjc> flaper87: then I don't think you can do it, because rustc doesn't know that the closure that you pass to spawn is only going to be called once
[21:44:18] <kimundi> sinma: you mean skip the first?
[21:44:35] <flaper87> tjc: mmh, good point. Thanks
[21:44:57] <tjc> flaper87: this was, I think, the motivation behind "once functions" -- though I think we decided not to implement them
[21:45:16] <tjc> if that were implemented, you'd be able to write a function and declare to the compiler "this will only be called once"
[21:45:23] <tjc> (and the compiler checks that for you, so it's safe)
[21:46:08] <flaper87> I guess another way to do that would be sending it to the nested task
[21:46:17] <ecr> flaper87: if you need to circumvent the lack of once functions, you can wrap something in a Cell and then unwrap the Cell inside the closure. this only gets you one layer down though, so you'll need to do it for each level.
[21:46:22] <sinma> kimundi: yes
[21:46:31] <jclements> tjc, pnkfelix: ah! the llvm build that's a part of rust includes llvm-dis, yay.
[21:46:35] <sinma> In fact thatâ€™s not the right solution for my problem
[21:46:43] <ecr> flaper87: channels would work too (but then you need to move the channel into the closure, which requires Cell again)
[21:46:46] <tjc> jclements: ah, great. then you can just put that subdirectory of the rust build into your PATH...
[21:46:53] <tjc> turtles all the way down
[21:47:11] <flaper87> ecr: ok, I've never used rust's Cell, I'll take a look
[21:47:15] <flaper87> ecr: thanks 
[21:47:16] <jclements> tjc: no, I like typing long pathnames. makes me feel more productive.
[21:47:16] *** Joins: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP)
[21:47:16] <sinma> I canâ€™t iterate over an element and push some uint into itâ€¦
[21:47:16] <kimundi> sinma: iter.skip(1)
[21:47:22] <jakub> @tjc: I thought once functions were implemented? are they going to be removed?
[21:47:25] <tjc> jclements: that works out well if you get paid by the hour ;-)
[21:47:39] <jclements> tjc: sadly, mozilla isn't paying me at all any more...
[21:47:39] <kimundi> sinma: while you iterate over a vector, you can't muatte it
[21:47:48] <ecr> flaper87: they're a terrible hack that kills my soul a little bit every time it's used, but for some reason people think they're simpler than once functions :(
[21:48:02] <tjc> jakub: I'm not completely sure, it's possible some of the work was done, but they're behind a flag if so
[21:48:15] <tjc> and there hasn't been an agreement as to whether we're going to move forward with them, as far as I know
[21:48:22] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:48:23] *** ChanServ sets mode: +ao brson brson
[21:48:26] <ecr> jakub: once functions are currently implemented, but hidden behind a -Z flag.
[21:48:28] <kimundi> sinma: If you need to generate new values, push them to some other vector, and then push them all to the original one once you're finished iterating
[21:48:43] <flaper87> ecr: hahah, I totally got you don't like them. I'm lackinf of history here but, I'll take a look at its implementaiton and see how they work
[21:48:47] <sinma> kimundi: great idea
[21:48:56] <flaper87> ecr: unless you've a TL;DR about Cell
[21:48:58] <flaper87> :D
[21:49:03] <ecr> as part of the make-~fn-and-@fn-into-macros thing, it wouldn't be needed because you'd just have a _once macro variant that does the trickery needed
[21:49:04] * flaper87 playing the lazy card
[21:49:12] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Ping timeout)
[21:49:25] <kimundi> flaper87: Cell is an Option that allows you to mutate it even if it's stored in an immutable location
[21:49:32] <pnkfelix> jclements: all the more reason to start getting paid by the hour as a Rust contractor.  (Hey, its the business model that worked for Rich Hickey, right?)
[21:49:52] <flaper87> o.0
[21:50:04] <jclements> pnkfelix: say, good idea. is dherman around here anywhere?
[21:50:06] <pnkfelix> jclements: (well, except for the "Rust" part)
[21:50:10] <ecr> flaper87: and now you know why I don't like it
[21:50:32] *** Joins: tikue (tkuehn@61D12352.CD72397.689607DE.IP)
[21:50:32] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[21:50:35] <flaper87> holy molly! (plop)
[21:50:38] <kimundi> flaper87: And hence can be used to dynamically move things around that the borrow checker wouldn't allow you to statically.
[21:51:03] <tikue> what'd i miss? dynamically move things around?
[21:51:09] <kimundi> Cell
[21:51:11] <tikue> ah
[21:51:16] <kimundi> Just explaining Cell
[21:51:25] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[21:51:28] <tikue> idk why cell exists -- isn't option the same thing?
[21:51:34] <kimundi> It isn't
[21:51:53] <ecr> tikue: Cell exists because people want to circumvent the borrow checker when it's not smart enough
[21:51:54] <kimundi> A Cell is an Option that can be mutated even if put in an immutable position
[21:52:03] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Client exited)
[21:52:06] <jakub> tjc, ecr: I see, thanks.
[21:52:18] <tikue> ecr: right, but can't a mutable option do that ?
[21:52:28] <kimundi> Can't unify Cell with option because of that.
[21:52:50] <ecr> tikue: yes. Cell just hides the pattern and pretends to be immutable (which I don't like)
[21:52:56] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[21:52:57] <sinma> kimundi: how to merge two vectors?
[21:53:04] <kimundi> sinma: define merge
[21:53:27] <kimundi> vec1.push_all(vec2) concatenates them for example
[21:53:42] <cmr> (destructively concatenates)
[21:53:48] <ecr> jakub: we'll still have a problem with lacking once &fns, which the -Z flag's implementation would fix, but people are hesitant to make it part of the language due to fears of it being too complicated
[21:53:53] <kimundi> or vec1.push_all_move(vec2) ?
[21:54:04] <kimundi> sonmething along thise lines at least
[21:54:58] <pcwalton> never rebase a 3,000 line patch over a week's work of rustc work
[21:54:59] <sinma> += isnâ€™t defined for ~[uint], is it normal? (Iâ€™ve heard of a bug in unary operators)
[21:55:18] <cmr> sinma: compound operators are disabled for non-primitives, yes
[21:55:29] <sinma> kimundi: Iâ€™ve found push_all but I donâ€™t understand what is append and why I donâ€™t do what I expect
[21:56:03] <sinma> cmr: will it be enabled again soon?
[21:56:08] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[21:56:09] <cmr> sinma: eventually
[21:56:13] <cmr> nobody is working on it
[21:56:13] <sinma> cmr: donâ€™t care, just for information
[21:56:26] <cmr> afaik, at leas
[21:56:29] <cmr> t
[21:57:16] <tikue> oh, apparently the fact that cell is immutable is what allows you to do cell.take() in a heap closure
[21:57:31] <tikue> you can't do option.take_unwrap because it complains that you are using an immutable captured outer variable as mutable 
[21:58:51] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[21:59:09] <dbaupp> engla: pong (very briefly)
[21:59:09] *** Quits: aeqwa (aeqwa@moz-F6958EFC.dsl.tropolys.de) (Quit: Lost terminal)
[22:00:22] <kimundi> sinma: ignore append  and append_one :P
[22:00:28] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[22:01:03] *** Joins: jstevans1 (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP)
[22:01:03] *** Quits: jstevans (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP) (Connection reset by peer)
[22:01:35] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[22:01:46] <tikue> kimundi: someone told me the other day to ignore them, as well. i can't remember the reasoning though? "concat and return" is useful
[22:02:14] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:02:43] *** Quits: jstevans1 (Instantbir@B2A068A2.28BE7003.DDE5D3F6.IP) (Ping timeout)
[22:04:10] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:04:30] <engla> dbaupp: hi, I was wondering earlier about the use case for inserting arbitrary strings as a decode error resolution
[22:04:40] <engla> just if there is anything in mind
[22:06:57] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[22:08:10] *** Quits: valenting (Thunderbir@BC8F8C4C.4ABED146.FB866788.IP) (Ping timeout)
[22:08:20] <kimundi> tikue: Well, I guess it is useful, but for newcomers it's confusing, and we don't duplicate the API elsewhere like this
[22:08:38] *** Quits: sinma (sinma@moz-6A11C47C.fbx.proxad.net) (Quit: Konversation terminated!)
[22:09:22] <kimundi> And If you really need append: |v1, v2| { let v = v1; v1.push_all(v2); v }
[22:09:36] <tikue> yeah, that's true, kimundi. whenever operator overloading comes back, i would assume append will be renamed anyway?
[22:09:37] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:09:53] <tikue> perhaps functions that correspond to overloaded operators can be prefaced with _
[22:10:01] <kimundi> Don't think it will be renamed
[22:10:05] <tikue> and it should be a method anyway, imo
[22:10:48] <kimundi> Operator Overloads would just allow for += being push()
[22:11:01] <tikue> what about + ?
[22:11:13] <tikue> + ---> append ?
[22:11:43] <kimundi> Yeah, pretty muh. Doesn't + on vectos still work?
[22:11:50] <tikue> yeah but it copies
[22:11:53] <tikue> :(
[22:12:06] *** Joins: Jesin (Jessin_@moz-35628F6F.cc.lehigh.edu)
[22:12:07] <cmr> well it has to, + is a non-destructive operation
[22:12:53] <tikue> i know. but i feel like with lists usually what you want is append, not a copy push
[22:13:04] <engla> + is a bad fit for ~[]
[22:13:04] *** Joins: krdln (Mibbit@moz-6F8A8560.dynamic.chello.pl)
[22:13:04] <tikue> but i guess that wouldn't fly
[22:13:15] <cmr> tikue: += is append
[22:13:15] <tikue> maybe it could get &
[22:13:22] <tikue> cmr: += is push
[22:13:30] <cmr> not if you give it a vector?
[22:13:37] <tikue> ?
[22:13:37] <cmr> I suppose rustcan't express that, can it
[22:13:45] <ecr> vector += scalar = push
[22:13:50] <ecr> vector += vector = append
[22:13:56] <engla> tikue: the answer to confusing operator overloads isn't to make even worse ones with &
[22:14:00] <tikue> sorry, i meant push_all
[22:14:10] <tikue> += is push_all, not append
[22:14:19] <cmr> wait, what's the difference?
[22:14:20] <tikue> engla: i'm not trying to find a solution to confusing operator overloads
[22:14:30] <ecr> cmr: it should be able to since RHS and return type are both params of the operator traits
[22:14:31] <tikue> cmr: append takes arguments by value
[22:14:34] <engla> ok
[22:15:08] <tikue> cmr: fn append(~[T], ~[T]) -> ~[T]
[22:15:18] <cmr> ok
[22:15:29] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[22:15:38] <tikue> list + list is an antipattern in rust
[22:15:45] <tikue> as it is defined now
[22:15:52] <tikue> if it were redefined to be append it'd actually be useful
[22:16:09] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:16:25] *** Joins: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[22:17:38] *** Joins: AlisonW (AlisonW@moz-7CEB14F7.hari.cable.virginmedia.com)
[22:17:40] *** Joins: ziad (ziad@moz-5003F925.members.linode.com)
[22:18:49] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:20:26] *** Quits: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr) (Ping timeout)
[22:21:33] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:22:32] <eevee> maybe having things called both "push" and "append" is a bad idea
[22:23:36] <tikue> eevee: push and append are different though. `push` pushes a single element and `append(xs, ys)` is functionally equivalent to `xs.push_all(ys); return xs`
[22:24:09] <ecr> if append modifies in place, why does it return the vector as wel?
[22:24:26] <pnkfelix> tikue: But its only defined for xs : ~[T], no?
[22:24:38] <ecr> oh, that would make sense then
[22:24:40] <tikue> ecr: because it takes both arguments by value
[22:24:48] <tikue> pnkfelix: yeah
[22:24:51] <eevee> i know, but most languages use one or the other to mean "add one element" (or "add some elements")
[22:25:00] <eevee> offhand i can't think of a stdlib with both names
[22:25:20] <tikue> eevee: true. concat would be less confusing maybe, idk
[22:25:27] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[22:25:38] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[22:26:48] <tikue> would it be so terrible to have + take vectors by value and slices by reference? as it stands now, you really don't ever want to use + with vectors
[22:27:04] <eevee> for adding another list, python has + or .extend(), js has .concat(), ruby has + or .concat
[22:27:19] <eevee> though .extend mutates and +/.concat returns a new one
[22:27:36] <ecr> this would be much easier if we could define new operators
[22:27:49] *** Quits: carllerche (carllerche@moz-CDE5367B.dsl.static.sonic.net) (Quit: carllerche)
[22:28:00] <tikue> ecr: yeah that's true. isn't there an issue for infix syntax extensions?
[22:28:45] <ecr> tikue: I think there's one open for doing things like x `append` y, but there's not a plan for user-made operators like haskell has
[22:29:04] <tikue> ah
[22:29:09] <ecr> tikue: in macro land, you can do whatever you want I think
[22:29:41] <ecr> x `f` y would work for any binary function f
[22:30:00] <eevee> ruby overloads << for append
[22:30:07] <cmr> I'd rather function overloading than arbitrary infix operators.
[22:30:25] <eevee> not sure how much of an atrocity that is
[22:30:56] <engla> infix function call syntax is much nicer than stretched meanings of a limited set of operators
[22:31:03] <ecr> I'd rather arbitrary infix operators than function overloading. Then I at least have an idea of what + does.
[22:31:05] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:31:05] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/KKyzGQ
[22:31:05] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:31:17] <engla> also the operators all call by reference, which is often not what you want to do
[22:32:17] <engla> tikue: https://github.com/mozilla/rust/issues/8824
[22:32:37] <engla> (I reported that issue. The text could have presented it better, I'm sure)
[22:32:58] *** Quits: eatkinson (eatkinson@moz-C2126207.airbears2.berkeley.edu) (Quit: eatkinson)
[22:33:15] <engla> well, that issue is not about syntax extensions
[22:33:22] <ecr> maybe it would make sense to have operator variants that take args by value? it'd blow our operator count out of the water though
[22:33:48] <ecr> e.g.
[22:33:56] <tikue> engla: yeah the call by reference is what is frustrating, at least with `vec1 + vec2` because it's almost never what you want
[22:34:02] <tikue> ecr^ agreed
[22:34:06] <ecr> ref + ref,    val '+ ref,   ref +' val,   val '+' val  ?
[22:34:25] <engla> it doesn't solve the fundamental problem with a predefined set of operators. Using functions with infix syntax gives you all the normal tools of rust, and you can namespace the function, and give it a short but clear name
[22:34:38] <ecr> engla: totally agreed
[22:34:40] <tikue> engla: i think infix operators is a very good idea
[22:35:11] <ecr> (personally, I'd go further and allow user defined operator symbols like haskell, but I know that's not popular)
[22:35:52] <tikue> ecr: i don't think that's a good idea personally. it hurts readability when someone else has to read your code
[22:36:04] <eevee> assume a single glyph from a specified unicode block is an infix operator  :)
[22:36:05] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:36:05] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/5LdCKQ
[22:36:05] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:36:06] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:36:06] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Hklnqw
[22:36:06] <ghrust> 13rust/06auto 142a0dd97 15Patrick Walton: librustc: Port writeback to the new API.
[22:36:06] <ghrust> 13rust/06auto 145f07b9c 15bors: auto merge of #9086 : pcwalton/rust/writeback-port, r=brson...
[22:36:06] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:36:08] <tikue> "what does this &^ operator do?"
[22:36:20] <ecr> tikue: "read the docs"
[22:36:32] <tikue> ecr: encouraging good naming conventions isn't a bad thing imo
[22:37:04] <ecr> eevee: you should see the shenanigans Agda and Coq get up to
[22:37:26] <eevee> i'm still sad that perl 6 dropped Â¥ as the zip operator
[22:37:35] <ecr> tikue: true, but sometimes symbols work better than names. mostly it's math people that think that though.
[22:37:47] <mcpherrin> I want to use the unicode cat faces as operators!
[22:38:01] <ecr> LOLCODE 2.0
[22:38:03] <tikue> eevee: haha that's actually really funny
[22:38:03] <eevee> let c = a Â¥ b;  ...  fn Â¥(&self, &b: ...)...
[22:38:05] <eevee> beautiful
[22:38:13] <eevee> tikue: they replaced it with Z
[22:38:18] <tikue> :(
[22:38:21] <eevee> yeah  :(
[22:38:22] <mcpherrin> The "Transport and Map symbols" block has some great operators too
[22:38:31] <eevee> also added a ZZ in the process which is some kind of magical multi-dimensional zip
[22:38:44] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:38:48] <eevee> there are plenty of mathematical operators in the...  "mathematical operators" block
[22:39:40] <mcpherrin> ARTICULATED LORRY (U+1F69B) would make a great operator to carry Sendable data over a pipe
[22:40:17] *** Quits: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Ping timeout)
[22:40:27] <ChrisMorgan> ðŸš›
[22:40:29] <mcpherrin> Implement security checks with the PASSPORT CONTROL (U+1F6C2) operator
[22:40:37] <ecr> there's always bblum's proposal to replace 'unsafe' with the bio-hazard symbol
[22:40:38] <ChrisMorgan> ðŸ›‚
[22:40:46] <bblum> ecr: not mine
[22:40:58] <ecr> bblum: eholk's then? don't remember
[22:41:00] <bblum> https://github.com/mozilla/rust/issues/666
[22:41:03] <mcpherrin> Clean data in the BATHTUB (U+1F6C1)
[22:41:14] <ecr> ah, lkuper
[22:41:15] <joelteon> articulated lorry????
[22:41:18] <ChrisMorgan> ðŸ›
[22:41:18] <joelteon> is that what they call it in europe?
[22:41:43] <tikue> i like that it's issue #666
[22:41:51] <ecr> joelteon: apparently
[22:42:04] <joelteon> it's a god damned semi truck
[22:42:07] <flaper87> tikue: indeed :D
[22:42:08] <ChrisMorgan> I don't know how others' fonts are coping, but here on Ubuntu, none of those characters are rendering correctly.
[22:42:21] <eevee> are these all astral plane
[22:42:25] <eevee> you may need symbola
[22:42:25] <cmr> hahah
[22:42:27] <mcpherrin> ChrisMorgan: OS X Terminal.app ain't rendering nothing
[22:42:35] <eevee> http://archive.org/details/Symbola
[22:42:37] <lkuper> ecr: hm?  oh, yes
[22:42:42] *** Joins: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com)
[22:42:43] <mcpherrin> uh, remove the correct number of logical nots from what I just said
[22:43:14] <cmr> ChrisMorgan: here on arch with my bitmap font, I also see nothing.
[22:43:16] <kmc> has anyone seen Rust code running on Raspberry Pi or similar ARMv6 GNU/Linux?
[22:43:22] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[22:43:30] * flaper87 sees nothing
[22:43:32] <joelteon> OSX renders them in other applications, but not in iterm
[22:43:34] <joelteon> :(
[22:43:41] <tikue> colloquy renders them all nicely
[22:43:42] <tikue> heh
[22:43:47] <cmr> Speaking of ARM, there's a  sparc box here, I might give a shot porting rust to it
[22:43:55] <cmr> it's otherwise accumulating dust
[22:44:09] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:44:29] <mcpherrin> cmr: I have a sparc machine big enough for me to sit in!
[22:44:34] *** Joins: jstevans (Instantbir@D9666FB4.87CA334A.DDE5D3F6.IP)
[22:44:35] <mcpherrin> And I'm not a small person.
[22:44:42] <cmr> heh
[22:44:44] * ChrisMorgan tried to get rustc compiled for ARM a few days ago but has failed thus far
[22:44:48] <Luqman> kmc: yes, i've run rust on various arm things
[22:45:48] <AlisonW> the real problem with using 'special' unicode chars is that most keyboards (all?) have no simple way to enter them.
[22:46:04] <AlisonW> let alone not having the right charset/font installed to see them
[22:46:31] <ecr> AlisonW: true, but I would consider this a feature in the case of swapping unsafe for bio-hazard :)
[22:46:41] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[22:46:46] <kimundi> AlisonW: That's not a problem, that's a challenge :P
[22:46:53] <AlisonW> possilby ;-0
[22:46:59] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:47:01] <kmc> Luqman: did you cross compile or build the toolchain on the device?
[22:47:14] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:47:15] <kimundi> Anyway, night everyone
[22:47:17] <ChrisMorgan> AlisonW: I enter things like an EM-DASH (U+2014, â€”) as Ctrl+Shift+U 2014 [whitespace character of some form] *very* frequently.
[22:47:24] <Luqman> kmc: cross compile
[22:47:26] <kmc> ok
[22:47:40] <AlisonW> ChrisMorgan: but that sort of thing is machine/OS dependent
[22:47:47] *** Joins: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP)
[22:47:48] <kmc> is there some document describing how to build the cross compiler?
[22:47:50] <ChrisMorgan> I know. Tragic.
[22:47:53] <engla> You can change your keymap so thatâ€”it's just altgr+- or something
[22:47:55] * AlisonW looks at choice of machines / OSes in front of her
[22:48:11] <mcpherrin> AlisonW: I really need some sort of modal thing I can insert unicode characters by name
[22:48:59] <AlisonW> I think it is a pity that computer manufacturers never made keyboards like the old-fashioned hot metal type machines - stacked keys
[22:49:04] <Luqman> kmc: just `./configure --target-triples=arm-unknown-linux-gnueabihf && make` then `rustc --target arm-unknown-linux-gnueabihf --linker arm-unknown-linux-gnueabihf-gcc`
[22:49:28] <kmc> cool
[22:49:31] <kmc> thanks
[22:49:48] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Ping timeout)
[22:49:54] <ChrisMorgan> For myself, as soon as I know that RADIOACTIVE SIGN and BIOHAZARD SIGN are U+2622 and U+2623, I can type â˜¢ and â˜£ fairly conveniently.
[22:50:15] <kmc> mcpherrin: there's a GTK input mode or something that accepts LaTeX names, but I don't remember the name offhand :/
[22:50:30] <ChrisMorgan> mcpherrin: if you know the codepoint name, in Python you can have things like u'\N{RADIOACTIVE SIGN}'
[22:50:42] <kmc> ChrisMorgan: nice!
[22:50:46] <kmc> also Agda makes pervasive use of non-ASCII operators and so the Emacs mode accepts LaTeX escapes
[22:51:23] <flaper87> night guys 
[22:51:54] *** flaper87 is now known as flaper87|afk
[22:52:07] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[22:55:49] <mcpherrin> kmc: ChrisMorgan: yeah, but I generally want something more search-ey/interactivish
[22:56:14] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[22:56:36] <ChrisMorgan> I get disappointed by the way LaTeX makes a mess of Unicode characters. Why should I use `` ` ' '' instead of the straightforward â€œ â€˜ â€™ â€?
[22:56:45] *** kimundi is now known as zz_kimundi
[22:57:06] <mcpherrin> LaTeX predates unicode by a decade? :p
[22:57:08] <cmr> unicode didn't exist when latex was created.
[22:57:10] <ecr> well unicode wasn't really around at the time
[22:57:58] <ChrisMorgan> mcpherrin: with DuckDuckGo, a query like "!utf8 biohazard" will take you to http://www.fileformat.info/info/unicode/char/search.htm?q=biohazard&preview=entity
[22:58:35] <mcpherrin> ChrisMorgan: Yeah, and that's generally what I do (well, I cut DDG out of the loop but that's beside the point) but it's hard to do "live" when you're coding :P
[22:58:50] <mcpherrin> I'm going to add this as a feature of my terminal emulator for fun.
[22:58:54] <ChrisMorgan> Memorise the important ones :P
[22:59:37] <mcpherrin> And type in the hexadecimal value? yeah, no :P
[23:02:48] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[23:06:02] *** Quits: krdln (Mibbit@moz-6F8A8560.dynamic.chello.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[23:08:42] *** Joins: cubic_ (cubic@moz-FE5AD6C7.mc.videotron.ca)
[23:09:16] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Ping timeout)
[23:09:22] *** Joins: clements (clements@moz-BEE8D50A.dsl.snlo01.pacbell.net)
[23:09:27] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[23:10:09] <jclements> if I want to get a backtrace on an ICE, current best practice is to run the compiler in gdb?
[23:10:29] <cmr> jclements: yes
[23:10:47] <jclements> cmr: is there a natural place to set the breakpoint so that it captures all ICEs?
[23:11:25] *** Quits: miza (miza@moz-4DD51325.home.otenet.gr) (Input/output error)
[23:11:26] <cmr> jclements: I do not know, besides rust_begin_unwind which is all taskfailure
[23:11:34] <jclements> cmr: good enough. Thanks!
[23:14:02] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[23:14:26] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:16:46] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:18:25] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:18:26] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:21:09] <ecr> someone r? https://github.com/mozilla/rust/pull/9089
[23:22:23] <cmr> ecr: not undefined, unspecified
[23:22:32] <AlisonW> (takes a while to compile on a clean install, doesn't it :-(
[23:22:39] <cmr> AlisonW: yup, about an hour
[23:22:44] *** Quits: sp3d (a@moz-6F12212B.fidnet.com) (Ping timeout)
[23:22:44] <cmr> most of it being llvm
[23:22:47] <AlisonW> and counting
[23:23:06] <AlisonW> yup llvm is moving' along
[23:23:10] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:23:25] <AlisonW> but at least the screen moves up pretty regularly so no danger of wondering whether it has died
[23:24:04] * bstrie hugs his gaming computer that can do a clean build in 20 minutes
[23:24:21] <bstrie> it's all that it's good for nowadays, after I gave up video games
[23:24:28] <AlisonW> lol ... I should have done it on one of my servers, but went for main laptop instead
[23:24:55] <AlisonW> at least I found where Kate syntax highlighting has moved to
[23:25:11] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[23:26:05] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:26:05] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145f07b9c to 14ed695d4: 02http://git.io/N3iJvQ
[23:26:05] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:26:06] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:26:06] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/aB993Q
[23:26:06] <ghrust> 13rust/06auto 148f0721b 15Eric Reed: Fix Acceptor iterator ending early if a connection attempt fails
[23:26:06] <ghrust> 13rust/06auto 14d41b558 15bors: auto merge of #9089 : anasazi/rust/fix-acceptor-iterator, r=cmr...
[23:26:07] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:26:28] <ecr> cmr: thanks
[23:27:34] <AlisonW> ooh . compile throwing warnings in "wrtmessage" unused variables and such
[23:29:05] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[23:29:35] <AlisonW> in rust/src/rt/jemalloc/src/util.c
[23:30:01] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[23:30:02] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[23:30:18] <ecr> yep, there's a bunch of stuff throwing warnings that no one has got around to removing yet
[23:30:57] <AlisonW> seems to have stopped moving too ... /me crosses fingers and toes that last hour isn't about to be wasted
[23:31:16] <AlisonW> (it's moving again...)
[23:31:31] <tjc> AlisonW: when actually compiling Rust code (after LLVM finishes), linking and LLVM optimizations take the longestr
[23:31:50] <AlisonW> *now* you tell me ;-p
[23:32:28] <AlisonW> oh well, I has hacking code until 05:30 last night so only being half-midnight shouldn't really worry me yet
[23:32:41] <tjc> heh
[23:32:42] <ecr> if I have to do a clean build, I usually start it then leave for lunch
[23:32:46] <tjc> yeah
[23:32:48] <tjc> that's the way to go
[23:32:59] <tjc> Or, if at home, cook the fanciest meal you can think of :-D
[23:33:22] <nmatsakis> acrichto dbaupp : btw https://github.com/mozilla/rust/pull/9088
[23:33:34] <AlisonW> suggestion: add a guideline / warning for the compile time to the build insts
[23:34:13] <acrichto> nmatsakis: yay! if dbaupp doesn't get to it first I'll take a look at it tonight
[23:34:21] <AlisonW> odd thing is, it isn't showing as CPU-bound (usage at 1.08 on dual)
[23:35:27] <ecr> Alison: rustc is single threaded :(
[23:35:34] <AlisonW> :-(
[23:35:38] <ecr> indeed
[23:36:40] <AlisonW> so, iow, I should have started this _before_ watching Sunday night's The Newsroom ...
[23:37:06] *** Quits: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net) (Ping timeout)
[23:37:06] * tjc starts a "Best TV shows to watch while rebuilding Rust" wiki page ;-)
[23:37:38] <mcpherrin> Somebody should write a firefox extension that detects when you're watching netflix and kicks off a git pull + rebuild...
[23:37:49] <AlisonW> well I do have the whole of last season's Grays Anatomy to watch before the new season starts in two weeks ;-0
[23:38:03] *** jorendorff is now known as jorendorff_away
[23:39:34] *** Joins: mark_edward (quassel@moz-97E995A.hsd1.in.comcast.net)
[23:40:19] *** Quits: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net) (Ping timeout)
[23:40:24] <ecr> how is The Newsroom. I heard it kind of dropped off after the start.
[23:40:46] *** Quits: jstevans (Instantbir@D9666FB4.87CA334A.DDE5D3F6.IP) (Ping timeout)
[23:41:11] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:41:35] <AlisonW> other way around, personally. Wasn't overstruck by series 1 ep 1, but it grew on me, and this season (2) has been prime Sorkin - really good
[23:41:38] <kmc> it's terrible in many ways but Sorkin's dialogue is always fun to listen to
[23:41:48] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:41:48] *** ChanServ sets mode: +ao brson brson
[23:42:11] <AlisonW> I've also been comparing it to Sports Night (which we didn't get in UK ever) as I've been torrenting that too
[23:42:39] <ecr> I never really watched any Sorkin stuff, but it looks like I might enjoy it.
[23:43:25] <tikue> ecr: i enjoy it a lot
[23:43:32] <AlisonW> depends whether you like his writing. West Wing was superlative, and as with Studio 60 and the rest, it isn't about the subject area it is about the interaction between people
[23:43:52] <tikue> it's an engaging show for sure
[23:44:20] <ecr> hm, maybe I'll start with the West Wing
[23:44:21] <AlisonW> oops .. rustc now at 99.9% cpu ;-p
[23:44:53] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[23:45:07] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[23:45:13] *** Joins: miza (miza@moz-4DD51325.home.otenet.gr)
[23:45:47] *** Joins: ozten (ozten@CB167D3E.3778D849.1D6E592A.IP)
[23:47:17] <cmr> "oops"? that's whatit's supposed to do!
[23:48:04] *** Quits: jclements (jclements@moz-9C0ABCFC.wireless.calpoly.edu) (Quit: jclements)
[23:48:15] *** Joins: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP)
[23:48:24] <AlisonW> well ... yes, but it just emphasises how I need MOAR MACHINES!
[23:49:27] <AlisonW> hmmn. and mem usage just jumped from 10.8% to 24.2% so I guess it must be doing 'something'
[23:49:38] <tjc> well, it'll use 1.6-2 GB at peak
[23:49:54] *** Joins: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net)
[23:49:55] <AlisonW> already is, on that basis
[23:50:18] *** Quits: victorporof (victorporo@338A6DC2.9CD5E4C4.D111398B.IP) (Ping timeout)
[23:52:06] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[23:53:45] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:53:47] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Ping timeout)
[23:54:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:54:59] *** Joins: echristo (echristo@4241698A.2E4FD3DD.225F4543.IP)
[23:55:06] <ecr> These rare deadlock errors are messing with my head. I have no idea how it's happening at all.
[23:55:55] *** Quits: clements (clements@moz-BEE8D50A.dsl.snlo01.pacbell.net) (Ping timeout)
[23:55:55] <etw> is it possible to modify part of an enum after it's been instantiated, e.g: Cons(left, right) <- replace right ?
[23:56:17] <tiffany> how often should I update rust?
[23:56:19] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[23:56:32] <cmr> etw: nope, no way to access anonymous fields without pattern matching.
[23:56:41] *** Quits: echristo (echristo@4241698A.2E4FD3DD.225F4543.IP) (Ping timeout)
[23:56:44] <cmr> tiffany: a good rule of thumb is weekly, unless there'sa changeyou care about
[23:56:51] <tikue> etw: you could use a struct enum
[23:56:53] <cmr> also TWiR willgiveyou a headsup on braking changes
[23:57:00] <etw> tikue: a struct enum?
[23:57:02] <cmr> damn this netbook's space bar
[23:57:03] *** Quits: Jesin (Jessin_@moz-35628F6F.cc.lehigh.edu) (Broken pipe)
[23:57:15] <cmr> enum Foo { Bar {a: int, b: uint} }
[23:57:17] <cmr> etw: ^
[23:57:20] <tikue> rusti: enum Foo { Bar { left: uint, right: ~[uint] } }
[23:57:22] <tiffany> I guess I'll do it every time I see one of those in my rss reader
[23:57:37] <cmr> Tuples aren't the only product type, and enums are sums of products.
[23:57:39] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:57:41] <mcpherrin> cmr: braking changes?  brake pads got rusty?
[23:57:44] <ecr> cmr: couldn't you match against it with 'ref mut' and then change that anonymous field?
[23:57:52] <cmr> ecr: oh, hm, maybe
[23:57:58] <etw> ecr: that's what I've been trying
[23:57:59] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[23:58:21] <ecr> match x with { Cons(left, ref mut right) => right += 1; }
[23:58:22] <cmr> that's still pattern matching though
[23:58:33] <ecr> right
[23:58:35] <cmr> ecr: &mut Cons( ref left, refmute right) I think
[23:58:50] <cmr> otherwiseyou're still deconstructing the original
[23:58:51] <tikue> but there's a difference between a mutable box and a mutable variable
[23:59:08] <tikue> you can mutate the anonymous fields but you can't replace them
[23:59:10] <ecr> etw: so you'll need to be matching against something you can mutate first off (~ or &mut)
[23:59:27] *** Joins: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[23:59:28] <cmr> tikue: *right = foo?
[23:59:58] <tikue> cmr: oh. i guess i'm wrong :)
[23:59:59] <echristo> ecr: the first five seasons or so of the west wing are great.
