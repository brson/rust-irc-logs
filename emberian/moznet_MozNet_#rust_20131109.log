[00:02:18] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[00:02:50] <yuriks_> cmr: I just get "error: can't find crate for `glfw`"
[00:02:56] <yuriks_> do I need to build the project in a special way?
[00:03:14] <bjz> :(
[00:04:00] <bjz> yuriks_: I havn't had much luck with rustpkg so far
[00:04:23] <tjc> yuriks_: what Rust version are you using?
[00:04:30] *** Quits: jaredhanson (jaredhanso@moz-8323839A.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[00:04:37] <yuriks_> tjc: 0.8
[00:04:48] <bjz> yuriks_: oh, you need 0.9-pre
[00:05:04] <tjc> yuriks_: it's better to be up-to-date, but I think the bug you're seeing is one that's not fixed yet...
[00:05:08] <bjz> yuriks_: either from the git repo or from a nightly build
[00:05:29] <bjz> yuriks_: yeah, extern pkgs hasn't been fixed
[00:05:32] <tjc> yuriks_: I think the bug you're seeing is https://github.com/mozilla/rust/issues/10253
[00:05:37] <tjc> I have a pull request for that, but it hasn't landed
[00:05:44] <tjc> you'll want to be on git HEAD so you can see the change when it lands :-)
[00:05:53] <yuriks_> eh, coulda sworn I saw the extern mod syntax in the 0.8 tutorial. Documentation from the future~~~
[00:06:04] <yuriks_> right, I'll get to work on compiling rust then
[00:06:08] *** jorendorff is now known as jorendorff-away
[00:06:14] <bjz> yuriks_: yeah make sure you're on master
[00:06:20] <tjc> yuriks_: It's nothing to do with the syntax, it's that a bug got introduced into rustpkg where a remote workspace that itself has a src/ directory in it doesn't work
[00:06:21] <bjz> 0.8 is oooold
[00:06:30] <tjc> if bjz's workspace had a lib.rs at the top level, it would work
[00:06:39] <bjz> ahh really?
[00:06:43] <tjc> however, like I said, the bug will be fixed once my PR lands, so no need for anyone else to change anything :-)
[00:06:53] <tjc> bjz: doesn't mean you should change it, it's my bug :-)
[00:07:03] <bjz> tjc: yeah, that would be great, tests tests!
[00:07:10] *** Quits: sweet_kid (Upasana@38DC0908.ADD6300A.388CF16F.IP) (Quit: Leaving)
[00:07:15] <yuriks_> so, isn't it a bit pointless to do point releases if everyone wants people to use head?
[00:07:31] <bjz> yuriks_: it keeps us focused
[00:07:34] <cmr> yuriks_: they're snapshots.
[00:07:36] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:07:50] <cmr> it's good to drum up interest, too
[00:08:11] <bjz> yuriks_: so that critical bugs are fixed by certain deadlines
[00:08:23] <yuriks_> I see
[00:08:32] <bjz> yuriks_: and as cmr syays, it's good for marketing :)
[00:08:48] *** Joins: jyasskin_w (jyasskin@DAF66858.C60FE7DC.4065847B.IP)
[00:08:57] <bjz> it's nice to keep folks up to date with changes
[00:09:19] <bjz> (ie. on hacker news/proggit)
[00:09:55] <yuriks_> that's a good point. rust came back on my mind after seeing the 0.7 release announce
[00:10:03] <bjz> tjc: any thoughts on local testing?
[00:10:13] <tjc> bjz: not yet
[00:10:31] <bjz> yuriks_: yeah, community cultivation is an extremely important part of growing support for a language
[00:11:24] <bjz> yuriks_: in the time I've been here since 0.4+, the irc channel has gone from ~115 users to ~360
[00:11:44] <bjz> yuriks_: still small, but very active
[00:12:30] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[00:12:34] <bjz> tjc: I was also thinking about updates... would be cool if you could force-update the deps
[00:13:08] <tjc> bjz: I think I opened a bug on how to deal with upstream changes...
[00:13:10] <tjc> I wasn't sure
[00:13:25] <bjz> tjc: rather than having to fetch from the linked repos every time you build
[00:13:58] <tjc> bjz: https://github.com/mozilla/rust/issues/9787
[00:14:02] <tjc> any comments there would be great :-)
[00:14:51] *** Quits: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net) (Ping timeout)
[00:15:37] *** Joins: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net)
[00:15:51] *** Quits: steveklabnik (steveklabn@moz-F84F761F.homerun.telia.com) (Ping timeout)
[00:16:27] *** Quits: kellogh (timkellogg@moz-68DF7EF7.teliax.com) (Quit: kellogh)
[00:16:32] <bjz> tjc: it's super tricky trying to balance local testing/development and what the clients use
[00:16:46] <bjz> if that makes sense
[00:17:37] *** jorendorff-away is now known as jorendorff_away
[00:17:41] <tjc> bjz: yes
[00:17:49] <bjz> when you work on projects with a tree of dependencies that are being developed in paralell
[00:18:11] * bjz has this issue
[00:18:35] <tjc> it's an issue for Servo
[00:18:40] <bjz> I have no solutions though :(
[00:18:46] <bjz> yeah
[00:18:56] <tjc> well, in general, there has to be human intervention
[00:18:59] <tjc> because there can be conflicts
[00:19:08] <bjz> tjc: who is taking over rustpkg?
[00:19:18] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[00:19:30] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[00:19:33] <tjc> bjz: I don't know yet
[00:19:35] <tjc> possibly brson
[00:19:51] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[00:20:00] *** Quits: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net) (Ping timeout)
[00:21:01] *** Joins: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net)
[00:21:13] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[00:21:32] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[00:23:57] *** Joins: rumpler (Mibbit@moz-44B5C40B.f0.protectedgroup.com)
[00:24:05] *** Quits: rumpler (Mibbit@moz-44B5C40B.f0.protectedgroup.com) (User has been banned from Mozilla (no spamming here))
[00:35:43] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[00:38:06] *** Quits: icebattle (wayne@8A14A542.EBE2EE2B.C7CEC4ED.IP) (Quit: leaving)
[00:39:43] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[00:39:47] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[00:39:50] *** Joins: bjz_ (bjz@B398BE78.F804C29E.D35A31DF.IP)
[00:41:08] *** Quits: KindOne (KindOne@moz-B7437C7B.dynamic.ip.windstream.net) (Ping timeout)
[00:41:25] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[00:42:33] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[00:42:45] *** Joins: KindOne (KindOne@moz-B7437C7B.dynamic.ip.windstream.net)
[00:43:05] *** Quits: obk (Mibbit@moz-651DE3B6.red.bezeqint.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:43:09] <yuriks_> OSTYPE got detected as unknown-linux-gnu. Is that normal?
[00:43:53] *** Joins: osa1 (omer@moz-63168A82.hsd1.in.comcast.net)
[00:44:03] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[00:44:50] <osa1> hi. any admins online that are able to administrate rust-dev mailing list?
[00:45:25] <brson> osa1: yes
[00:45:38] *** Joins: Addle (quassel@moz-89E971E4.cable.teksavvy.com)
[00:45:46] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[00:46:05] <osa1> brson: I'm having trouble with mailing list, whatever I do I can't subscribe to the list. just today I talked with another mail list admin and he manually added me to the mailing list but I still didn't get any emails(including confirmation email). and yes I'm checking spam folder
[00:46:43] <brson> what's your email?
[00:46:45] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[00:47:26] *** Quits: Addle (quassel@moz-89E971E4.cable.teksavvy.com) (Ping timeout)
[00:47:29] <tjc> osa1: your email address is subscribed...
[00:47:36] *** Joins: Addle (quassel@moz-89E971E4.cable.teksavvy.com)
[00:47:42] <osa1> ...
[00:47:45] <tjc> osa1: so assuming the address you gave me is right, the problem must be on your end
[00:47:52] <osa1> interesting
[00:47:59] <brson> i have to go. sorry
[00:48:00] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[00:48:01] <tjc> sometimes gmail files mailing list updates into "Forums", so you might want to check there if your forums tab isn't part of your inbox by default
[00:49:51] <osa1> oh wow. I didn't realize there's a "forums" tab. I have a huge list of tags listed in that bar so "forums" is just minmized
[00:50:13] <tjc> heh
[00:50:15] <tjc> Oh, gmail.
[00:50:22] <osa1> thanks and sorry for the trouble.
[00:50:26] <tjc> no worries
[00:51:52] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[00:52:41] <mletterle> I never got those tabs.. I think because I use multiple inboxes
[00:56:09] *** Quits: andrew-__ (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Quit: Leaving...)
[00:56:16] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[00:56:29] *** Quits: Ferreus (ferreus@moz-72964D2.pools.arcor-ip.net) (Quit: WeeChat 0.4.2)
[01:02:08] *** Quits: netoarmando (netoarmand@F7F0F7A.30F3D1B9.20F09BA6.IP) (Quit: ZNC - http://znc.in)
[01:02:46] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[01:03:18] *** Joins: haxney (dan@moz-424CB7EB.cs.brown.edu)
[01:04:23] <haxney> is there a profiler for rust?
[01:04:42] *** Quits: osa1 (omer@moz-63168A82.hsd1.in.comcast.net) (Ping timeout)
[01:04:54] <strcat> haxney: existing profilers like perf work
[01:05:34] <haxney> strcat: cool, thanks. I'll have to figure out how to use perf, then (only rarely used profilers at all)
[01:06:22] <dbaupp> `perf record ./yourexecutable; perf report`
[01:06:31] <dbaupp> (at it's most basic.)
[01:07:06] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[01:08:03] <haxney> dbaupp: thanks!
[01:08:58] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[01:09:37] <dbaupp> haxney: you'll need to be on linux for that, but I beleive mac-osx's "instruments" program also works... no idea about windows.
[01:11:39] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[01:12:10] <haxney> I'm on Linux. I'm trying to figure out why my program doesn't seem to be using more than two cores (even though I have many tasks)
[01:12:37] <haxney> from an initial look, there isn't a noticable cause, but I haven't looked at perf reports much before
[01:13:22] <haxney> On a second look, all cores are in use, just at around 40% utilization
[01:13:33] <dbaupp> doing much IO?
[01:14:49] <haxney> nope, only a small amount of IO at the beginning and I start the benchmark timer after the IO is done. Could be synchronization overhead, perhaps
[01:15:02] <haxney> I'm using channels quite a bit
[01:15:33] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[01:15:47] <yuriks_> "/home/yuriks/rust/src/librustc/middle/lint.rs:636: NOTE this message could be more helpful"
[01:15:53] <yuriks_> *snicker* yes, yes it could :)
[01:16:49] <dbaupp> haxney: possibly, I think that area is a "TODO: optimise this" section still.
[01:17:17] <dbaupp> haxney: e.g. they allocate a box on each message, so if you're sending something small there's a lot of overhead there.
[01:17:57] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:18:18] <yuriks_> can I run rust from the build directory or do I need to install it with make install?
[01:18:20] *** Quits: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[01:18:24] *** Joins: jeffcutsinger (Mibbit@moz-7E34AC5D.dhcp.roch.mn.charter.com)
[01:18:32] <dbaupp> yuriks_: yes, you can run it from the build directory
[01:18:44] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:18:55] <yuriks_> ah, *phew*. Wouldn't want to rebuild everything since I didn't set a prefix :)
[01:19:06] <yuriks_> it's the stuff in stage3/, correct?
[01:19:42] <yuriks_> hmm, I guess not
[01:20:09] <haxney> dbaupp: that's probably it. I'm sending a ton of messages. I'll try collecting them before sending
[01:21:13] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[01:21:33] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Quit: z0w0)
[01:21:34] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[01:21:38] *** Joins: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com)
[01:21:38] *** ChanServ sets mode: +ao pcwalton pcwalton
[01:22:00] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[01:22:17] <dbaupp> yuriks_: <arch>/stage2/bin/rustc with a normal `make`
[01:22:35] *** Quits: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net) (Quit: jeffdb)
[01:22:43] <yuriks_> hunh, what is stage3?
[01:23:38] <dbaupp> for extra verification that it made a working compiler/for snapshots (I think)
[01:24:11] <yuriks_> and where is the 'rust' driver? or is that gone now?
[01:24:18] <strcat> gone
[01:24:21] <dbaupp> gone
[01:25:10] <yuriks_> bye bye 'rust run' :)
[01:25:22] <dbaupp> yuriks_: https://github.com/mozilla/rust/wiki/Note-compiler-snapshots for more info the stages, btw.
[01:26:49] <yuriks_> ah, I had stumbled onto that page earlier, I was trying to find it again. Thanks
[01:26:55] *** Joins: netoarmando (netoarmand@F7F0F7A.30F3D1B9.20F09BA6.IP)
[01:28:23] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[01:29:14] *** Joins: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net)
[01:29:46] *** Quits: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net) (Quit: This computer has gone to sleep)
[01:31:22] <haxney> How do I use `vec.flat_map()` to flatten a 2d array without having to call clone()?
[01:31:39] <haxney> right now, I have `results.flat_map(|v| v.clone())` which works, but isn't terribly efficient
[01:32:03] <haxney> I'd like to be able to do just `results.flat_map(|v| v)`, but Rust yells at me
[01:32:13] <dbaupp> results.move_iter().flat_map(|v| v).collect()
[01:32:26] <dbaupp> (or .to_owned_vec() instead of collect.)
[01:33:17] <haxney> dbaupp: what would the difference between to_owned_vec() and collect() be?
[01:33:42] <dbaupp> nothing, just .collect() might need a type hint to work out that it needs to be returning a ~[]
[01:34:17] <dbaupp> .to_owned_vec() is literally just a specialised version of .collect() to avoid having to write .collect:<~[full_internal_type]>()
[01:34:46] <dbaupp> we're possibly geting "partial type hints", so it'll become .collect::<~[_]>(), and then hopefully .to_owned_vec() can then be removed.
[01:34:50] <haxney> dbaupp: cool, will try!
[01:35:32] <dbaupp> btw, the flat_map for vectors should be removed, in favour of the iterator one (since they're essentially exactly equivalent)
[01:35:52] <dbaupp> that'd be a helpful contribution if someone wants to do it... :)
[01:36:06] <haxney> dbaupp: hmm, I get "failed to find an implementation of trait std::iter::Iterator<<V417>> for ~[T]"
[01:36:18] <haxney> with `results.move_iter().flat_map(|v| v).to_owned_vec()`
[01:36:30] <dbaupp> oh, v.move_iter() internally too.
[01:37:00] <haxney> dbaupp: that did it, thanks!
[01:37:07] <strcat> the CSS for the docs is so much better now
[01:37:47] <haxney> well, using the move_iter didn't give much of a speedup over copying, but avoiding sending a message over the channel was huge!
[01:38:23] <strcat> haxney: does the 2D vector have fixed dimensions? at runtime at least
[01:39:06] <strcat> it's much, much faster to represent one as a wrapper around ~[T] where you have an indexing method using row * n_cols + col
[01:39:11] <haxney> strcat: no, its the result of lexing CSS
[01:39:32] <strcat> haxney: ah nvm then :)
[01:41:03] <dbaupp> haxney: does order matter (or can you do it in reverse order)? because v.rev_move_iter() is faster than .move_iter()
[01:41:18] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[01:41:54] <strcat> the price of unwinding ;p
[01:41:56] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[01:42:09] <strcat> well
[01:42:10] <strcat> I guess not
[01:42:12] <haxney> dbaupp: That's weird. Yes, order does matter, so that wouldn't be appropriate.
[01:42:30] <strcat> haxney: removing elements from the end of a vector is simple
[01:42:40] <strcat> removing them from the start isn't, it has to use swaps
[01:42:58] <strcat> if it just moved them out and left invalid memory, it would cause corruption in the dtor
[01:43:11] <strcat> unless we depend on rust using a drop flag
[01:43:19] <dbaupp> n/2 swap_removes + n/2 pops for move_iter, vs just n pops for rev_move_iter
[01:43:47] *** Quits: Jesin (Jessin_@moz-5C1F7BD2.res.lehigh.edu) (Quit: Leaving)
[01:44:02] <dbaupp> https://github.com/mozilla/rust/issues/8568 is one issue that'll hopefully speed up using channels more naturally, btw.
[01:44:03] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[01:44:36] <haxney> I don't think I need moves, since I am just copying enums. And the old vectors get dropped after use
[01:45:20] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[01:45:56] <strcat> haxney: if they are small, and don't need a heap allocation to copy them, you just want iter
[01:45:58] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[01:46:08] <strcat> iter().map(|&x| x) will be faster than move_iter
[01:46:28] <strcat> if they aren't implicitly copyable, calling clone could be a lot slower since they probably need to allocate
[01:47:09] <strcat> although rev_move_iter should be the same speed as iter + deref like that
[01:48:01] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[01:48:26] <haxney> Some of them contain ~strs, how would that impact things?
[01:48:39] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[01:48:40] <strcat> haxney: use rev_move_iter then
[01:48:46] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[01:48:48] <strcat> otherwise you'll end up doing heap allocations for those variants
[01:48:57] <strcat> (at least, assuming this is the last use of the vector)
[01:49:20] <haxney> but didn't rev_move_iter change the order?
[01:49:32] <strcat> haxney: it consumes it in reverse order, yes
[01:49:44] <strcat> is this the last use of the vector?
[01:50:07] <haxney> this is the last use of the vector, but the output needs to be in the correct order
[01:50:30] <strcat> well, then move_iter vs. iter + clones will depend on the frequency of the ~str
[01:50:38] <strcat> swaps are fairly cheap (move_iter), heap allocations are not very cheap
[01:50:41] <haxney> so if I had [[1, 2, 3], [4, 5, 6, 7]], the output would need to be [1, 2, 3, 4, 5, 6, 7]
[01:50:45] *** Quits: TeXitoi (texitoi@moz-EA958D66.texitoi.eu) (Ping timeout)
[01:50:47] *** Joins: TeXitoi (texitoi@moz-EA958D66.texitoi.eu)
[01:51:00] <haxney> but the precursor vecs are never used again
[01:51:01] *** Quits: dbaupp (Thunderbir@moz-DDA7CEB8.lns20.syd6.internode.on.net) (Ping timeout)
[01:51:15] <strcat> haxney: you probably want move_iter
[01:51:22] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:51:23] <strcat> but if only 1% needed to do heap allocations, maybe you wouldn't
[01:51:36] <haxney> for which part? inside the lambda?
[01:51:51] <mark_edward_> what license does rust prefere?
[01:52:09] <strcat> mark_edward_: it's dual-licensed, MIT/Apache2
[01:52:28] <mark_edward_> ah, i see
[01:54:29] *** Joins: dbaupp (Thunderbir@moz-B5EA82D4.lns20.syd6.internode.on.net)
[01:54:34] <haxney> strcat: which one should be move_iter? I have `results.move_iter().flat_map(|v| v.move_iter()).to_owned_vec()`
[01:55:03] <yuriks_> ok, rust compiled and works!
[01:55:12] <strcat> haxney: both, if both contain things that need allocations to copy
[01:55:14] <strcat> and it seems they do
[01:55:27] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[01:55:30] <haxney> got it.
[01:55:33] <yuriks_> Now, since the `extern mod` syntax isn't working, what should I do instead to import packages?
[01:55:45] <yuriks_> I guess I'm not clear on exactly what a workspace is supposed to be
[01:55:46] <cmr> yuriks_: extern mod works, just not with rustpkg.
[01:56:06] <cmr> yuriks_: you can build glfw-rs and drop libglfw... into somewhere
[01:56:13] <cmr> and pass -L path/to/somewhere to rustc
[01:56:48] <yuriks_> so I checkout glfw-rs on an unrelated directory?
[01:57:22] <cmr> yeah
[01:57:29] <yuriks_> can I copy the built files to inside .rust on my projects directory to not need to pass -L?
[01:57:46] <cmr> not really sure how exactly that works.
[01:57:49] <cmr> tjc: ^ ?
[01:58:47] <tjc> yuriks_: if the files are in a workspace that's in your RUST_PATH, rustpkg will find them
[01:58:50] *** Quits: hurderella (Heo@13864F63.2DD6919B.56C9C5CA.IP) (Connection reset by peer)
[01:59:39] <tjc> yuriks_: See "Package searching" and "Package structure" at http://static.rust-lang.org/doc/master/rustpkg.html
[02:00:53] <mark_edward_> is there a #[cfg()] directive for endianness, 32/64 bitness,  and some way to check for intrinsics?
[02:01:28] <strcat> #[cfg(target = "little")] #[cfg(target = "big")]
[02:01:39] <dbaupp> mark_edward_: target_word_size="64"
[02:01:41] <cmr> and target_word_size
[02:01:54] <dbaupp> mark_edward_: "check for intrinsics"?
[02:01:59] <bjz_> tjc: how do you install a pkg into ~/.rust?
[02:02:55] <mark_edward_> thanks guys!
[02:03:19] <cmr> Oh wait@
[02:03:38] <cmr> yuriks_: you should be able to set your RUST_PATH, `rustpkg install` in glfw-rs, and it will do all the work for you.
[02:05:00] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[02:05:19] <tjc> bjz_: that's the default place where it installs a package to if you don't have a RUST_PATH set
[02:05:24] <tjc> er, no, sorry
[02:05:27] <tjc> the default is ./.rust
[02:05:33] <tjc> but if . happens to be ~, then it's right :-)
[02:05:33] <bjz_> yep
[02:05:40] <bjz_> eh
[02:05:55] <bjz_> -_-#
[02:06:30] <bjz_> tjc: so would it be better to set my RUST_PATH in my .zshrc?
[02:06:43] <cmr> bjz_: that's what I do
[02:07:02] <bjz_> ah ok
[02:07:36] *** Quits: carllerche (carllerche@moz-2B516F15.hsd1.or.comcast.net) (Quit: carllerche)
[02:07:45] *** Joins: GeneralMaximus (ankur@728B23F2.E8A26698.BE90E62C.IP)
[02:07:49] <tjc> bjz_: if you want to share dependencies between packages, then yeah
[02:08:38] <bjz_> tjc: yeah it's been pretty painful so far managing all my deps
[02:08:43] *** Parts: haxney (dan@moz-424CB7EB.cs.brown.edu) (ERC Version 5.3 (IRC client for Emacs))
[02:09:58] <bjz_> I had to rustpkg build each lib, then rustc -L ../../foo-rs/build/(blah) main.rs
[02:10:12] <bjz_> and if multiple deps, then more -Ls
[02:10:35] <tjc> bjz_: the -Ls shouldn't be needed if you put all the directories in your RUST_PATH
[02:11:12] <bjz_> tjc: yeah, now I know
[02:12:12] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[02:12:22] <ricepuddin> rustpkg (latest git) is claiming that the command `rustpkg install github.com/bjz/gl-rs` won't work because "supplied path for package dir does not exist, and couldn't interpret it as a URL fragment"
[02:12:28] <ricepuddin> the command worked on my 0.8 rust install
[02:12:48] <cmr> ricepuddin: known bug
[02:12:51] <yuriks_> cmr: I tried `RUST_PATH=~ rustpkg install glfw` and it installed on the current directory anyway
[02:12:58] *** Quits: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP) (Ping timeout)
[02:13:00] <yuriks_> same for RUST_PATH=~/ or RUST_PATH=~/.rust
[02:13:00] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[02:13:06] <yuriks_> oh wait, I guess I need to create it first
[02:14:13] *** Quits: bholley (anonymous@moz-A2189431.hsd1.ca.comcast.net) (Quit: bholley)
[02:14:33] *** Quits: GeneralMaximus (ankur@728B23F2.E8A26698.BE90E62C.IP) (Quit: Computer has gone to sleep.)
[02:14:46] <ricepuddin> cmr: workaround?
[02:16:18] <yuriks_> oh, ok, so I guess it did install correctly, it's just the message that confusing
[02:16:34] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Quit: Leaving)
[02:17:31] <yuriks_> hm, I'm still getting "can't find crate for `glfw`"
[02:17:41] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[02:17:58] *** Quits: heftig (heftig@moz-76BC6A3B.dip0.t-ipconnect.de) (Ping timeout)
[02:18:05] <bjz_> tjc: I set my RUST_PATH to ~
[02:18:20] <bjz_> but it's still installing to the pkg root
[02:18:32] <bjz_> note: Installed package gl-0.1 to /Users/brendan/dev/rust/gl-rs
[02:18:45] <bjz_> (that was after rustpkg install gl)
[02:18:53] <tjc> bjz_: what's the entire command line you're typing?
[02:19:02] <bjz_> echo $RUST_PATH => /Users/brendan
[02:19:04] <bjz_> ok
[02:19:06] <bjz_> to
[02:19:08] <bjz_> *so
[02:19:18] *** Quits: nkoep (nik@moz-3DF0F12F.pool.mediaways.net) (Client exited)
[02:19:25] *** Quits: pnathan (Adium@moz-5EF6A514.tukw.qwest.net) (Quit: Leaving.)
[02:19:32] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Quit: )
[02:19:33] <yuriks_> I cloned glfw to ~/projects/dev/glfw-rs. CDed into it, did 'rustpkg build glfw', it build correctly. Then executed 'RUST_PATH=~/.rust rustpkg install glfw'. It gave me 'note: Installed package glfw-0.1 to /home/yuriks/projects/dev/glfw-rs' and the ~/.rust/rustpkg_db.json file got created
[02:19:35] <bjz_> cd ~/dev/rust/gl-rs; rustpkg install gl; rustpkg install gl
[02:19:52] <bjz_> last one gave: note: Installed package gl-0.1 to /Users/brendan/dev/rust/gl-rs
[02:19:52] <mark_edward_> is there a rust rquivalent
[02:19:59] <mark_edward_> of #ifdef?
[02:20:10] <yuriks_> but building my program with 'rustc main.rs' still gives me the can't find crate error
[02:20:15] <tjc> bjz_: what are the contents of ~/dev/rust/gl-rs?
[02:20:19] <bjz_> mark_edward_: #[cfg(...)]
[02:20:37] <bjz_> tjc: https://github.com/bjz/gl-rs
[02:20:38] <mark_edward_> thanks!
[02:20:59] <tjc> bjz_: That's probably the issue… since it's a workspace, rustpkg installs to it
[02:21:03] <bjz_> -
[02:21:06] <bjz_> -_-#
[02:21:08] <tjc> if $CWD is a workspace, that's the behavior (I think)
[02:21:15] <bjz_> why?
[02:21:22] <bjz_> bug?
[02:21:33] <tjc> It's intentional, but...
[02:21:42] <tautologico> it's weird that this PR is failing tests on the scheduler
[02:21:43] <dbaupp> mark_edward_: #[cfg(...)] only applies to things like items and methods; you can also write if cfg!(...) { ... } as an expression, but that will still get compiled & typechecked, so you may need to introduce new functions to emulate #ifdef precisely.
[02:21:46] <yuriks_> tjc: mine gives the message it installed to cwd but if I pass the RUST_PATH it does create a file in ~/.rust/
[02:21:56] <yuriks_> so I'm confused as to what's going on
[02:21:59] <mark_edward_> dbaupp: thank you all!
[02:22:09] <tjc> bjz_: My original thought was that in the simple case where you CD into your workspace to do your work, you'll want to install stuff there
[02:22:12] <tjc> idk, though
[02:22:35] *** Joins: lfox (lfox@993C33BE.AE625458.ECED8BE3.IP)
[02:22:40] <tjc> the way you could do it instead is to make your RUST_PATH have your destination dir first, then ~/dev/rust/gl-rs second...
[02:22:44] <bjz_> tjc: if you note, my workspace has a tool, and also a lib
[02:22:47] <tjc> if you type `rustpkg install gl-rs` in your home dir...
[02:22:59] <tjc> it'll find the sources in the right place, and install to the first entry in the RUST_PATH
[02:23:08] <bjz_> tjc: that's why I use workspaces
[02:23:15] *** Joins: heftig (heftig@moz-15F137E9.dip0.t-ipconnect.de)
[02:23:23] <bjz_> it's very confusing that the behaviour is different
[02:23:42] <tjc> bjz_: I think it might be simpler to eliminate the feature that uses the CWD as the destination workspace...
[02:23:50] <tjc> feel free to file an issue suggesting it, I won't oppose it
[02:23:52] <bjz_> tjc: also in other libs I have a separate dirctory structure for examples
[02:23:55] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Ping timeout)
[02:25:30] <yuriks_> in the end I still have no idea how to work this... :P
[02:25:34] <mark_edward_> dbaupp: is there any srt of static if?
[02:25:40] *** Joins: jakedust (Jake@4C59E059.E34AAA84.F546FA5F.IP)
[02:26:14] <jakedust> does the end of the segmented stack mean the end of #[fixed_stack_segment]?
[02:27:28] <dbaupp> mark_edward_: not really.
[02:29:37] <bjz_> tjc: https://github.com/mozilla/rust/issues/10373
[02:29:52] <bjz_> yuriks_: you might have to use rustc manuially for now :(
[02:30:27] <yuriks_> bjz_: the odd thing is that it does *something* to RUST_PATH
[02:30:43] <tjc> bjz_: Thanks, and thanks for being patient while we figure out the behavior people actually want
[02:31:00] <yuriks_> after running install with it set I got a file in my ~/.rust that seems to reference the library
[02:31:00] <bjz_> tjc: np
[02:31:13] <bjz_> tjc: user interface design is always tricky
[02:31:29] <tjc> bjz_: indeed, and none of us on the team are UX experts :-)
[02:31:29] <bjz_> tjc: people never do what you expect
[02:31:53] <bjz_> tjc: even the best user interface designers get it wrong :)
[02:32:02] <tjc> definitely
[02:32:11] <bjz_> that's why they test :)
[02:32:26] <bjz_> yuriks_: we are guinea pigs
[02:32:27] <yuriks_> bjz_: alternatively, can I rustpkg install from a source that isn't CWD?
[02:32:28] <bjz_> :)
[02:32:38] <yuriks_> bjz_: hehe :)
[02:32:44] <tjc> yuriks_: Yes -- rustpkg will search the directories in your RUST_PATH for sources to install
[02:33:03] <yuriks_> well, with you people being this responsive, I guess that's ok :)
[02:33:18] <yuriks_> tjc: oooh, so it works reversed from what I had understood
[02:33:42] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[02:34:02] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[02:34:07] <bjz_> yuriks_: if you do cd src/glfw; rustpkg install
[02:34:12] <bjz_> it works I think
[02:34:35] <yuriks_> er, not really... ???
[02:34:41] <yuriks_> [yuriks@reinforce dungeons-of-rust]$ RUST_PATH=~/projects/dev/glfw-rs rustpkg install glfw
[02:34:47] <yuriks_> note: Installed package glfw-0.1 to /home/yuriks/projects/dev/glfw-rs
[02:34:49] <yuriks_> ? :(
[02:35:33] <yuriks_> seems like it always installs into the directory where the source package is? which doesn't sound very useful at all
[02:35:40] <tjc> yuriks_: The directory wher eyou want to install it *to* has to be first in the RUST_PATH
[02:35:40] <bjz_> yuriks_: I have RUST_PATH set to ~
[02:35:44] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[02:35:47] <tjc> so if you wanted all packages installed to /quux
[02:35:49] <tjc> you would set it to
[02:35:55] <tjc> RUST_PATH=/quux:$HOME/projects/dev/glfw-rs
[02:36:06] <yuriks_> tjc: that's what I was doing before. RUST_PATH=~ rustpkg install glfw
[02:36:11] <yuriks_> it still installed to the same place
[02:36:27] <tjc> yuriks_: Yes, the other time it installed there because your current working directory was a workspace
[02:36:40] <tjc> but if you do what I just suggested while in a directory that's not a workspace, it should work
[02:37:08] <yuriks_> so I should be in neither the target nor the source directory, and set RUST_PATH=target:source?
[02:37:14] <bjz_> yuriks_: export RUST_PATH=~; cd path/to/glfw-rs/src/glfw; rustpkg install
[02:37:55] <bjz_> yuriks_: if you do: export RUST_PATH=~; cd path/to/glfw-rs/; rustpkg install glfw
[02:38:06] <bjz_> it will install to $CWD
[02:38:09] <yuriks_> hmmm
[02:38:12] <yuriks_> I see
[02:38:17] <yuriks_> that's a confusing priority
[02:38:18] <bjz_> hence my issue: https://github.com/mozilla/rust/issues/10373
[02:38:27] <yuriks_> I'd expect RUST_PATH to take priority over everything
[02:38:38] <bjz_> yes
[02:38:47] <bjz_> that's what I've been saying
[02:38:50] <yuriks_> ah, I understand your issue now
[02:38:55] <bjz_> :)
[02:39:31] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:40:02] <tautologico> is bors having trouble today?
[02:40:14] *** Quits: miloshadzic (miloshadzi@59612C1E.AEAC8983.ADC9B595.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:40:34] <tjc> tautologico: Yes, some of the Mac bots have the wrong cached IP address for github and thus can't fetch new revisions...
[02:40:38] <tjc> brson said he would fix it tonight
[02:41:04] <tautologico> tjc: I see
[02:41:25] <yuriks_> bjz_: you'd also probably want RUST_PATH=/Users/brendan/.rust instead, too
[02:41:39] <yuriks_> else it dumps stuff straight into your home
[02:41:50] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:43:21] *** Quits: lfox (lfox@993C33BE.AE625458.ECED8BE3.IP) (Quit: ZZZzzz…)
[02:43:23] <bjz_> eh, that's weird
[02:44:02] <ercxx> no more rusti?
[02:44:23] *** Joins: lfox (lfox@993C33BE.AE625458.ECED8BE3.IP)
[02:45:10] <bjz_> ercxx: which rusti?
[02:45:16] <ercxx> the bot
[02:45:34] <bjz_> ercxx: strcat's laptop has probably gone to sleep :P
[02:45:38] <bjz_> or something
[02:45:44] <ercxx> I see.
[02:46:00] <bjz_> ercxx: very robust technology here on #rust
[02:46:20] <ercxx> Sleeping bots is high-tech.
[02:46:38] <bjz_> tjc: does rustpkg install work for main.rs things?
[02:46:47] <tjc> bjz_: Yes, it should
[02:46:52] <bjz_> tjc: or should it be a bin.rs?
[02:47:02] <tjc> bjz_: no, bin.rs isn't a crate name we use
[02:47:10] <bjz_> rustpkg install
[02:47:10] <bjz_> WARNING: The Rust package manager is experimental and may be unstable
[02:47:10] <bjz_> task '<unnamed>' failed at 'assertion failed: pkg_src.start_dir.join(p).exists()', /Users/brendan/dev/rust/rust/src/librustpkg/lib.rs:518
[02:47:10] <bjz_> task '<unnamed>' failed at 'receiving on closed channel', /Users/brendan/dev/rust/rust/src/libstd/rt/comm.rs:198
[02:47:28] <tjc> bjz_: Yeah, I have a pull request for that but it won't land until the network problem on the bots gets fixed
[02:47:36] <bjz_> that's from gl-rs/src/generator
[02:47:39] <bjz_> oh ok
[02:49:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:51:10] <bjz_> tjc: when do you think that will be fixed?
[02:51:21] <tjc> bjz_: brson said he would fix it "tonight"
[02:51:29] <bjz_> heh, ok
[02:51:32] <bjz_> :)
[02:51:41] <tjc> before he gets on a plane to South Korea, I hope :-)
[02:51:45] <bjz_> heh
[02:51:52] <bjz_> craziness
[02:51:58] <ercxx> rusti: struct X{n: Option<X>}; let x = X{n:None};
[02:51:59] -rusti- <anon>:9:37: 9:38 warning: unused variable: `x` [-W unused-variable (default)]
[02:51:59] -rusti- <anon>:9          struct X{n: Option<X>}; let x = X{n:None};
[02:51:59] -rusti-                                               ^
[02:51:59] -rusti- Segmentation fault
[02:51:59] -rusti- application terminated with error code 139
[02:52:05] <tjc> Heh, neat
[02:52:11] <strcat> it's 0.8
[02:52:16] <strcat> it didn't have stack overflow protection
[02:52:25] <strcat> that struct is infinite size
[02:52:31] <bjz_> haha
[02:52:45] <bjz_> \o/
[02:52:57] <ercxx> How would I make something like a linked list without unsafe code ?
[02:53:10] <dbaupp> rusti: struct X{n: Option<~X>}; let x = X{n:None};
[02:53:11] -rusti- <anon>:9:38: 9:39 warning: unused variable: `x` [-W unused-variable (default)]
[02:53:11] -rusti- <anon>:9          struct X{n: Option<~X>}; let x = X{n:None};
[02:53:11] -rusti-                                                ^
[02:53:11] -rusti- ()
[02:53:16] <strcat> ercxx: http://static.rust-lang.org/doc/master/tutorial.html#boxes
[02:53:17] <tjc> ercxx: singly linked or doubly linked?
[02:53:34] <ercxx> singly linked
[02:53:47] <tjc> Yeah, what strcat said, in that case :-)
[02:53:55] * strcat rewrote that since 0.8
[02:54:02] <strcat> much better now
[02:54:39] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[02:55:46] <ercxx> thanks
[02:57:00] <strcat> there's even a comprehensible, accurate vector section since this morning ;p
[02:57:04] <strcat> should be expanded a lot though
[02:58:11] <bjz_> hansjorg: any idea why this might be failing? https://travis-ci.org/bjz/cgmath-rs#L30
[03:00:17] *** Joins: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[03:00:58] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[03:01:10] *** Quits: lfox (lfox@993C33BE.AE625458.ECED8BE3.IP) (Quit: ZZZzzz…)
[03:06:02] *** Quits: jakedust (Jake@4C59E059.E34AAA84.F546FA5F.IP) (Ping timeout)
[03:06:49] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[03:06:56] <bjz_> so #[repr(c_int)] does not work for enums?
[03:07:10] *** Joins: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net)
[03:07:19] *** Joins: mib_ugabm9 (Mibbit@moz-499B701B.hsd1.mn.comcast.net)
[03:08:46] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[03:09:02] <mib_ugabm9> Question: If I have two owned vectors u and v of the same size, what's the preferred way to copy u into v?
[03:09:36] <mib_ugabm9> What I mean is, does "v = u.clone()" free and allocate memory if u and v are already allocated and of the same size?
[03:09:45] *** Joins: alinab (alina@moz-C82147C8.members.linode.com)
[03:11:12] <dbaupp> bjz_: #[repr(C)]
[03:12:14] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[03:12:30] <mib_ugabm9> I could always do a loop over the vectors, copying element by element, but I was wondering if there was a shortcut that didn't involve new allocations
[03:13:32] *** Joins: jakedust (Jake@4C59E059.E34AAA84.F546FA5F.IP)
[03:14:09] <dbaupp> mib_ugabm9: `for (a,b) in v.mut_iter().zip(u.iter()) { *a = *b; /* or b.clone() */ }` is the only way I know to do it without extra allocations
[03:14:57] <mib_ugabm9> oh, what about the copy_from method?
[03:15:06] <dbaupp> oh, maybe.
[03:15:17] * dbaupp doesn't know what it does, but it sounds useful
[03:15:32] <mib_ugabm9> just found that searching around the documentation
[03:15:41] *** Quits: idog98 (idog98@moz-E3F1D7ED.guilhem.org) (Quit: Leaving.)
[03:15:45] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[03:16:47] *** Quits: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com) (Quit: pcwalton)
[03:17:21] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:17:36] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:17:53] <strcat> mib_ugabm9: you still need both vectors afterwards, right?
[03:18:53] <mib_ugabm9> right
[03:19:16] <mib_ugabm9> turns out the copy_from method is only implemented for vectors over a type which is cloneable
[03:20:49] <strcat> mib_ugabm9: yes, Clone is simply &self -> Self in the laziest way possible
[03:20:56] <strcat> so it's the minimum of what you need
[03:21:16] <strcat> since you're assigning to existing elements of the same type, it could potentially reuse resources from those, but it's still in the scope of Clone
[03:21:18] <strcat> https://github.com/mozilla/rust/issues/10240
[03:21:27] <dbaupp> bjz_: an example of what?
[03:21:32] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[03:22:05] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[03:22:17] <bjz_> dbaupp: why it's not guaranteed
[03:23:21] <strcat> mib_ugabm9: for example, a[x] = b[x].clone() will have to allocate for ~T, but with this assign default method, owned pointers can override it and reuse the allocation in the destination
[03:23:30] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:23:35] <dbaupp> bjz_: because that's the standard; it makes no guarantees
[03:23:39] * strcat could land that tonight ;p
[03:23:44] <dbaupp> bjz_: e.g. http://stackoverflow.com/questions/366017/what-is-the-size-of-an-enum-in-c
[03:23:57] <mib_ugabm9> strcat: Yeah, a clone_into method would be great for this circumstance
[03:24:06] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:24:29] <dbaupp> bjz_: ... don't you think it's better to just let the compiler decide with #[repr(C)] rather than making the decision yourself with #[repr(c_int)]?
[03:24:30] <bjz_> dbaupp: wouldn't it make more sense to have an extern "C" enum { ... } then?
[03:24:41] <yuriks_> next round of confusion!
[03:24:44] *** Quits: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net) (Quit: This computer has gone to sleep)
[03:24:45] <dbaupp> bjz_: #[repr(u16)] enum { ... }, etc.
[03:24:48] <bjz_> dbaupp: because I know what size I want
[03:25:01] <dbaupp> bjz_: do you? then u16, u32 or whatever.
[03:25:12] <bjz_> dbaupp: but it's a C type
[03:25:24] <dbaupp> bjz_: a C enum?
[03:25:30] <bjz_> dbaupp: as in, for glfw, all the functions that c_ints
[03:25:33] <yuriks_> . is my workspace. I have ./src/dungeons-of-rust/main.rs (which has `extern mod glfw;`)
[03:25:44] <yuriks_> rustc ./src/dungeons-of-rust/main.rs works fine
[03:25:49] <bjz_> dbaupp: glfw doesn't use enums
[03:25:53] <yuriks_> rustpkg build dungeons-of-rust says it can't find glfw
[03:26:00] <dbaupp> bjz_: so they're constants with `int` type?
[03:26:00] <bjz_> dbaupp: I'm wrapping the constants
[03:26:09] <yuriks_> glfw is installed in ~/.rust
[03:26:23] <bjz_> dbaupp: I have the constants in glfw/ffi.rs
[03:26:44] <bjz_> and I have them wrapped in the high level wrapper
[03:27:21] <bjz_> https://github.com/bjz/glfw-rs/blob/master/src/glfw/lib.rs#L39
[03:27:23] <dbaupp> ah, they're #defines
[03:27:41] <bjz_> https://github.com/bjz/glfw-rs/blob/master/src/glfw/ffi.rs#L20
[03:27:44] <bjz_> yeah
[03:27:55] <bjz_> but glfw takes them all as ints
[03:28:05] <dbaupp> yup
[03:28:22] <bjz_> I know #defines anren't err... defined though
[03:28:45] *** Quits: mib_ugabm9 (Mibbit@moz-499B701B.hsd1.mn.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:28:59] <bjz_> the same would go with, say, opengl
[03:29:07] <dbaupp> does it use `int`s?
[03:29:12] <yuriks_> http://hastebin.com/gujefemogi.txt
[03:29:14] <bjz_> #defines
[03:29:31] <dbaupp> bjz_: but what type are they when passed to and from functions?
[03:29:37] <bjz_> and it does lots of implicit conversions -_-#
[03:29:46] <yuriks_> seems like rustpkg tries to resolve deps but can't find the source of glfw, right?
[03:29:54] <bjz_> in gl-rs I just made them GLenums
[03:30:17] <bjz_> and you have to cast if there is a function that relies on the implicit conversions
[03:31:25] <bjz_> dbaupp: for example GL_TRUE and GL_FALSE are sometimes used as GLbooleans or GLenums
[03:31:25] <yuriks_> ye olde C APIs
[03:31:28] <bjz_> -_-#
[03:31:39] <yuriks_> it's specially annoying since GL reuses constants in multiple contexts
[03:31:48] <bjz_> aye
[03:31:50] <bjz_> fml
[03:32:00] <yuriks_> source of so many bugs
[03:32:01] <dbaupp> bjz_: yeah... I guess there's not much to be done here other than complain upstream about bad FFI. :(
[03:32:18] <bjz_> heh, complain to kronos
[03:32:28] <dbaupp> bjz_: I *guess* using #[repr(C)] might work, or just using #[repr(i32)]
[03:32:30] <yuriks_> *chuckle* ask for long peaks while at it :D
[03:34:38] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:35:14] <dbaupp> bjz_: does a user ever pass the enum directly to the FFI functions?
[03:35:37] <dbaupp> bjz_: if so, is it too much to ask for them to write `foo as c_int` when they do?
[03:36:24] <bjz_> dbaupp: the spec defines the types that the functions take
[03:36:50] <dbaupp> bjz_: I mean, does the user ever call the C glfw directly
[03:36:56] <bjz_> ohh, no
[03:37:10] <dbaupp> so defining an enum with a different size is fine, yeah?
[03:37:21] <dbaupp> just cast it to c_int internally when you need a c_int.
[03:37:27] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[03:37:41] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[03:37:53] <bjz_> just trying to make it elegant is all, reduce the amount of casts I do
[03:38:04] <dbaupp> in any case, you'd have to do that anyway, because an enum is a different type to c_int
[03:38:19] <dbaupp> so you need to cast enum -> c_int to use it in that context.
[03:38:32] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Quit: Leaving...)
[03:39:02] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:39:18] *** Joins: darkowlzz (sunny@5D32D8BD.470EC439.27560D6E.IP)
[03:39:34] <bjz_> but it doesn't use enums. another thing, why can't we do: #[repr(&'static str)] enum { ... } for example. it seems like we have a feature that is hardwired for C
[03:39:54] <bjz_> wait, can we?
[03:39:58] <strcat> bjz_: no
[03:40:06] <strcat> bjz_: repr(C) means represent it as the C compiler would for that same set of variants
[03:40:28] <strcat> for example, on x86, gcc will start by default with int and then raise the size if the range exceeds it
[03:40:36] <strcat> but on some other architectures, short enums are the default
[03:40:41] <strcat> so it starts with 1 byte, and raises it as it goes
[03:41:15] <strcat> there's no other way in rust to write a portable C enum translation
[03:41:27] <strcat> we still lack a way to deal with unions portably
[03:41:43] <strcat> less important if we picked up libclang-based FFI support (no pre-declared definitions)
[03:42:31] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[03:42:32] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[03:42:45] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[03:43:01] <bjz_> strcat: I guess what I'm asking is that why is enum so inflexible to Rust style types/type aliases? It seems beholden to C
[03:43:49] <strcat> bjz_: an enum that only consists of integer constants is represented as an integer, now you can choose which one
[03:44:04] <strcat> repr(C) exists to make it make the C format, you can also use a rust primitive int type
[03:44:14] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[03:44:16] * strcat doesn't really get what's wrong with it
[03:44:27] <bjz_> strcat: but why not other types, and type aliases?
[03:44:41] <sp3d> repr(&'static str) seems like a bad idea, because in any case other than FFI compat you'd want the compiler to be able to choose the most efficient representation
[03:45:21] <dbaupp> bjz_: type aliases maybe, but other types would complicated the compiler needlessly
[03:45:34] <bjz_> dbaupp: ok, granted
[03:45:41] *** Quits: zz_kimundi (kimundi@moz-E1B6D3ED.dip0.t-ipconnect.de) (Ping timeout)
[03:46:02] <dbaupp> bjz_: maybe if you implemented checking type aliases...
[03:46:14] *** Joins: GeneralMaximus (ankur@4F017726.AE4FA233.D1005D78.IP)
[03:47:09] <dbaupp> (but it would be hard to get to work exactly right, since it'd have to run as part of resolve...)
[03:47:15] <bjz_> mm
[03:48:53] *** Quits: GeneralMaximus (ankur@4F017726.AE4FA233.D1005D78.IP) (Ping timeout)
[03:49:13] *** Joins: Kingsley (kingsley@BBD66DE2.61F456DA.3655BBF5.IP)
[03:49:17] <yuriks_> this whole "mod goes after use" thing is bizarre
[03:49:44] *** Joins: zz_kimundi (kimundi@moz-1D0368F3.dip0.t-ipconnect.de)
[03:50:07] *** zz_kimundi is now known as kimundi
[03:50:14] <strcat> you can call functions before they're declared too ;p
[03:50:23] <strcat> the 'use' restriction is to force them to be in one place
[03:50:39] <strcat> we found that code would trend towards importing all over otherwise, and it was very hard to tell what was in scope
[03:50:43] <dbaupp> strcat: and simplify the resolve algorithm, aiui.
[03:50:44] <strcat> it could be a lint instead of an error
[03:50:47] <yuriks_> but with functions I sort of abstract the contents of the function as a black box
[03:50:52] <strcat> dbaupp: I don't think so
[03:51:00] <strcat> it happened at the same time, yes
[03:51:06] <yuriks_> yeah, I read the rationale on the docs
[03:51:25] <yuriks_> it still feels weird to use module contents before actually declaring them
[03:51:36] <dbaupp> strcat: I though it was to make something like `use std::foo; mod bar; use std::bar;` behave sanely, but I dont really know.
[03:51:40] <strcat> yuriks_: statics/functions are used before declaration too though
[03:52:16] <yuriks_> strcat: alright alright, you win :)
[03:52:22] <strcat> yuriks_: I agree it should not be an error
[03:52:28] <strcat> it's subjective and should be a lint
[03:52:38] <strcat> but I think it should be denied by default
[03:53:04] <dbaupp> strcat: open a bug and cc pcwalton
[03:53:07] <strcat> dbaupp: well, it can just treat it *as if* they are all decl'ed at the top
[03:53:16] <strcat> it doesn't really seem relevant where they are 
[03:53:18] <yuriks_> tbh I don't really like allowing declarations of modules inline in a file
[03:53:18] <dbaupp> strcat: that gets reaaalllly weird.
[03:53:40] <dbaupp> strcat: because then you're using stuff from `mod bar;` even though, in theory, you've overwritten it with `use std::bar;`
[03:53:43] <yuriks_> I'd just force them to separate files like in python
[03:53:56] <ChrisMorgan> bors is being lazy :-(
[03:54:03] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Client exited)
[03:54:12] <strcat> yuriks_: small private modules are often used though
[03:54:25] <dbaupp> yuriks_: what if your module has 4 tiny platform dependent constants in it (for example), throwing away the flexibility seems silly.
[03:54:31] <yuriks_> and with that allow mod declarations to be moved above use, and then all will be well with the world ;)
[03:54:35] <dbaupp> ChrisMorgan: some problem on the buildbot end apparently.
[03:54:48] <ChrisMorgan> :-(
[03:54:56] <yuriks_> dbaupp: do you really need a separate module then, though?
[03:55:01] *** Joins: GeneralMaximus (ankur@9CA7B0E4.83585413.E28C2422.IP)
[03:55:26] <dbaupp> yuriks_: windows::FOO, linux::FOO rather than WINDOWS_FOO, LINUX_FOO seems midly nicer?
[03:55:42] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[03:55:53] <dbaupp> yuriks_: and also, it lets you write one #[cfg] per block, rather than a #[cfg] for each one, if you want it conditionally compiled.
[03:55:57] <yuriks_> dbaupp: I don't think the latter is any worse than the former, but in the end that's just my personal opinion
[03:56:17] <yuriks_> dbaupp: that's a better point
[03:57:16] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[03:57:17] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[03:57:21] <yuriks_> speaking of which, can you conditionally compile an entire file then?
[03:57:28] <dbaupp> yuriks_: having them as one module also lets you write `#[cfg(windows)] pub use self::windows::*; #[cfg(linux)] pub use self::linux::*;` so downstream users import `FOO`, rather than having do their own backflips with cfg!() and WINDOWS_FOO
[03:57:40] *** Quits: GeneralMaximus (ankur@9CA7B0E4.83585413.E28C2422.IP) (Ping timeout)
[03:57:43] <strcat> yuriks_: yes, but it will still parse/macro-expand the file
[03:57:50] <dbaupp> strcat: not macro-expand
[03:57:52] <dbaupp> just parse
[03:57:56] <strcat> hrm
[03:58:09] <yuriks_> dbaupp: could've sent that message a few seconds earlier and saved some bandwidth with my question ;D
[03:58:21] <dbaupp> phases are: lex, parse, strip cfg, expand macros, strip cfg, ...
[03:58:41] *** Quits: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net) (Ping timeout)
[03:59:34] *** Quits: glinscott (garylinsco@789A6618.53EB7C1.FFFE3AA.IP) (Quit: glinscott)
[04:00:00] <dbaupp> (well, lex isn't really a separate phase)
[04:00:01] *** Joins: glinscott (garylinsco@789A6618.53EB7C1.FFFE3AA.IP)
[04:00:17] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[04:00:34] <dbaupp> (oh there's feature gating and injecting std macros between parse and the first strip cfg, too)
[04:03:15] *** Joins: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net)
[04:04:23] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[04:05:40] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[04:05:45] *** Joins: GeneralMaximus (ankur@C525118.EC87792D.8DE24349.IP)
[04:07:43] *** Quits: kirneh (kirneh@moz-ACBB9422.k955.webspeed.dk) (Quit: leaving)
[04:09:38] <ChrisMorgan> I think we need to be careful about recommending #[cfg(windows)] et al. for anything beyond use statements; most notably, in my mind, you get the problem of functionality not covered in the auto-generated docs. (Case in point, cmr splitting MapError into completely disjoint enums for Windows and Unix, only one of which will be compiled and so you won't get docs for the other at all.)
[04:10:17] <ChrisMorgan> (MapError splitting is in https://github.com/mozilla/rust/pull/10358/files)
[04:11:10] *** Quits: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP) (Ping timeout)
[04:11:18] *** Quits: bynaryshef (bynaryshef@moz-97E96350.mem.bellsouth.net) (Quit: Leaving)
[04:12:20] *** Quits: darkowlzz (sunny@5D32D8BD.470EC439.27560D6E.IP) (Ping timeout)
[04:13:37] *** Quits: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca) (Ping timeout)
[04:13:50] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[04:14:08] *** Joins: nomadic (nomadic@moz-E01D5C49.hsd1.ga.comcast.net)
[04:15:32] *** Joins: tudor (tudor@moz-233C4930.hsd1.ca.comcast.net)
[04:16:21] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0/20131007213254])
[04:17:10] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:17:10] *** ChanServ sets mode: +ao brson brson
[04:17:33] <strcat> dbaupp: https://github.com/mozilla/rust/pull/10376 r?
[04:17:47] *** Joins: darkowlzz (sunny@8629939B.10CA95B7.F44414AF.IP)
[04:18:37] <strcat> hm
[04:18:40] *** Joins: sankha94 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[04:18:46] <strcat> ideally it would use capacity
[04:18:53] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[04:19:09] <strcat> won't worry about it atm
[04:19:12] <dbaupp> ChrisMorgan: yeah, I agree, I think it's probably worth having rustdoc compile with --cfg linux, --cfg windows and --cfg macosx or something like that...
[04:19:58] <ChrisMorgan> dbaupp: but how are you going to expose that to the user?
[04:20:42] <dbaupp> ChrisMorgan: yeah... no idea. :(
[04:20:48] * strcat fiddles with the docstrings a bit
[04:21:24] *** Joins: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca)
[04:22:15] <dbaupp> ChrisMorgan: well, at the very least, just having 3 copies of the docs with a drop-down to select between them
[04:22:26] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[04:22:33] <ChrisMorgan> How does the user know that there's a difference?
[04:22:52] <dbaupp> No idea, but that's a strict improvement on showing *only* linux.
[04:23:12] <ChrisMorgan> I wonder whether rustdoc could cover both editions of MapError, indicating that one is #[cfg(windows)] and the other #[cfg(unix)]?
[04:23:30] <yuriks_> I'd say that's very much preferable
[04:23:43] <yuriks_> rustdoc should probably read all variants
[04:24:28] <dbaupp> the only problem is implementing it sensibly...
[04:25:02] <ChrisMorgan> Naturally.
[04:25:07] <strcat> dbaupp: other than those periods, it's good to go right?
[04:25:17] <dbaupp> strcat: looks like it
[04:25:58] *** Quits: GeneralMaximus (ankur@C525118.EC87792D.8DE24349.IP) (Ping timeout)
[04:26:20] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:26:30] *** Quits: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca) (Ping timeout)
[04:26:35] <strcat> dbaupp: er, one more thing - going to add a commit making DeepClone inherit from Clone (if you can implement DeepClone, you can implement Clone)
[04:27:20] * strcat thinks that's fairly obvious
[04:27:38] <dbaupp> strcat: fine by me
[04:27:56] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[04:28:07] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[04:28:11] <tautologico> is bors back?
[04:29:54] *** Joins: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP)
[04:34:19] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:34:25] *** Joins: GeneralMaximus (ankur@30D03DE1.57976B1E.4654B817.IP)
[04:37:45] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[04:38:07] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:38:09] *** sankha94 is now known as sankha93
[04:39:54] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:41:34] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0/20130910160258])
[04:41:56] <yuriks_> bjz_: what's the deal with the start thing in the glfw example? Is there something that explain how that is different from the default setup?
[04:42:10] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[04:42:21] *** Quits: GeneralMaximus (ankur@30D03DE1.57976B1E.4654B817.IP) (Ping timeout)
[04:42:58] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[04:43:14] *** Joins: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca)
[04:43:19] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[04:44:07] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[04:46:09] *** Joins: pnathan (Adium@moz-5EF6A514.tukw.qwest.net)
[04:47:30] <cmr> tautologico: bors never left?
[04:49:32] *** Quits: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com) (Quit: Leaving)
[04:49:38] *** Quits: JanC (janc@moz-A2D0AF14.dsl.scarlet.be) (Ping timeout)
[04:51:44] *** Joins: GeneralMaximus (ankur@B96CED80.7F99DD6D.D1005D78.IP)
[04:54:24] <dbaupp> cmr: there were some problems with buildbot having the wrong IP for github
[04:56:05] <cmr> oh
[04:58:33] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[04:58:37] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[05:04:39] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Ping timeout)
[05:05:16] *** Joins: JanC (janc@moz-33B03629.dsl.scarlet.be)
[05:06:20] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[05:07:36] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:16:06] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[05:16:17] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[05:16:22] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[05:16:51] <yuriks_> bjz_: any particular reason glfw::init returns a Result, but glfw::Window::create returns an Option?
[05:23:03] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:25:26] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:28:20] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[05:28:34] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[05:34:26] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[05:34:27] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[05:37:22] *** Quits: darkowlzz (sunny@8629939B.10CA95B7.F44414AF.IP) (Quit: This computer has gone to sleep)
[05:37:50] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[05:39:02] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[05:39:25] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:41:09] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:42:02] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[05:42:57] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Connection reset by peer)
[05:43:42] *** Quits: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP) (Ping timeout)
[05:47:37] *** Joins: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net)
[05:47:37] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:49:54] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[05:52:44] *** Quits: GeneralMaximus (ankur@B96CED80.7F99DD6D.D1005D78.IP) (Ping timeout)
[05:53:53] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[05:56:11] *** Joins: mib_mx8pse (Mibbit@DEA2C4B9.91312870.E9477584.IP)
[05:56:56] *** Quits: mib_mx8pse (Mibbit@DEA2C4B9.91312870.E9477584.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:56:59] *** Quits: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca) (Quit: canhtak)
[06:00:13] *** Quits: jakedust (Jake@4C59E059.E34AAA84.F546FA5F.IP) (Quit: jakedust)
[06:01:09] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[06:02:16] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[06:02:24] *** Joins: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP)
[06:04:50] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[06:05:15] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Ping timeout)
[06:07:00] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Ping timeout)
[06:07:12] <bjz_> yuriks_: it should probably return a boolean
[06:08:00] * bjz_ is wary of booleans though
[06:08:03] <mark_edward_> can #[cfg] directives contain != ?
[06:08:03] *** Joins: GeneralMaximus (ankur@3B37F9D.A0D236DB.D1005D78.IP)
[06:08:16] <cmr> mark_edward_: #[cfg(not(...))]
[06:08:19] <bjz_> mark_edward_: #[cfg(not(...))]
[06:08:22] <bjz_> hah
[06:08:30] <mark_edward_> trhanks again! is this documented anywhere?
[06:08:42] <bjz_> not sure
[06:09:13] <cmr> Doesn't look like it's in the manual or tutorial.
[06:09:34] <bjz_> cmr: maybe we need a cfg tutorial
[06:09:50] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[06:09:58] <cmr> bjz_: I would think it'd be most appropriate for the manual.
[06:10:09] <bjz_> yeah
[06:10:12] <cmr> "Conditional Compilation"
[06:10:15] <bjz_> mm
[06:10:24] <yuriks_> bjz_: I like Result. I can use .expect on it ;)
[06:10:31] <yuriks_> (yay lazy error handling!)
[06:11:40] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:11:46] <bjz_> yuriks_: can't you do: assert!(glfw::init().is_ok(), "oops");
[06:12:16] <yuriks_> but expect looks nicer
[06:12:31] <cmr> yuriks_: add a trait with `expect`, implement it for bool :)
[06:12:45] <cmr> extension methods are very cool
[06:12:58] <yuriks_> ooo. I don't know I can do that yet :)
[06:13:17] <bjz_> cmr: I dunno
[06:13:49] <bjz_> cmr: seems like a wasteful trait.
[06:13:53] <yuriks_> one thing that's a pain about extension methods is that you can get methods you have no idea where they come from
[06:14:15] <cmr> bjz_: I don't think it should be in the stdlib. It *needs* to be a trait for an extension method.
[06:14:22] <cmr> yuriks_: well, rustfind is supposed to alleviate that pain.
[06:14:35] <cmr> (provides jump-to-definition)
[06:14:38] <bjz_> cmr: have to ask 'what concept is this a part of'
[06:15:05] <cmr> bjz_: hm?
[06:15:15] <cmr> yuriks_: https://github.com/dobkeratops/rustfind
[06:15:17] <bjz_> dw
[06:15:59] <cmr> yuriks_: (https://gist.github.com/cmr/7382358 for reference)
[06:16:26] <mark_edward_> do you guys know of any bitcounting intrinsics in rust?
[06:16:45] <cmr> mark_edward_: population_count
[06:16:50] <cmr> mark_edward_: http://static.rust-lang.org/doc/master/std/num/trait.BitCount.html#tymethod.population_count
[06:17:56] * bjz_ wonders about that trait name
[06:18:03] <yuriks_> cmr: I probably wouldn't do something like that, I wasn't being really serious on implementing it for bool. But imo, success/failure should be a distinct return type from bool
[06:18:06] <cmr> mark_edward_: but the intrinsic name is ctpop32/ctpop64
[06:18:14] <mark_edward_> thank you!  i hate trying to port C filled with horrendous macros and stuff. how is C the standard for portability! it's only portable because it's not even the same on each system!
[06:18:48] <cmr> mark_edward_: C is probably one of the worst language for portability. Too many subtle traps.
[06:19:53] <bjz_> cmr: should the bitcount fns be part of bitwise?
[06:19:53] *** Quits: lerc (quassel@moz-2A8CFEEE.telstraclear.net) (Ping timeout)
[06:20:19] *** Quits: GeneralMaximus (ankur@3B37F9D.A0D236DB.D1005D78.IP) (Ping timeout)
[06:20:33] <cmr> bjz_: didn't there used to be a Fixed trait?
[06:20:40] <cmr> I feel like it would belong on that
[06:21:29] <cmr> but yeah, Bitwise seems like an ok home for them.
[06:22:08] * bjz_ still feels uneasy about std::num
[06:23:42] <strcat> bjz_: yeah, I'm not sure the trait hierarchy makes any sense
[06:23:53] <strcat> it doesn't seem to provide either good code reuse or a traditional numeric hierarchy
[06:23:59] * strcat shrugs
[06:24:02] <bjz_> strcat: yes
[06:24:24] <bjz_> strcat: and I was one of the people who did most of it
[06:24:28] <bjz_> -_-#
[06:24:44] <strcat> bjz_: well, it's nearly impossible to design a trait hierarchy ;P
[06:24:54] <strcat> there aren't any examples of good trait hierarchies in the rust stdlib
[06:25:04] <cmr> What's considered state-of-the-art for numerics in haskell?
[06:25:09] <cmr> Whatever it is, we should copy it :p
[06:25:13] <strcat> I started poking at it for iterators but failed to make something sensible beyond Iterator + DoubleEndedIterator
[06:25:21] <bjz_> cmr: Numeric Prelude maybe
[06:25:27] <strcat> cmr: haskell's built-in numeric support is regarded as utter garbage ;p
[06:25:50] <strcat> but of course, it's not like any language does better
[06:25:58] <cmr> strcat: sure, but I imagine there's some nice lib for it?
[06:26:02] <strcat> cmr: yes
[06:26:04] <bjz_> cmr: I have a feeling the stuff in Numeric Prelude might be beyond Rust atm
[06:26:17] <bjz_> http://www.haskell.org/haskellwiki/Numeric_Prelude
[06:26:26] <strcat> bjz_: imo we shouldn't even have traits for floats
[06:26:38] <strcat> maybe just a Float trait shared across f32/f64
[06:26:47] <bjz_> strcat: yeah?
[06:26:48] <strcat> but no attempt at trying to make them fit into a real numerics system, at least in the stdlib
[06:26:59] <bjz_> strcat: yeah, that's what I've been thinking
[06:27:27] <strcat> bjz_: I have an issue open proposing dropping Ord/Eq for them too... and just having the built-in operators for them
[06:27:32] <strcat> then we could say Ord/Eq are total orderings
[06:27:48] <strcat> someone could make a partial ordering library but I really doubt it has any common use case
[06:28:05] * strcat shrugs
[06:28:21] <cmr> Partial ordering is very common, but it's not intuitive so most people don't use/understand it :\
[06:28:47] <bjz_> strcat: whatever we do, I'm very concerned about moving to 1.0 with the current std::num
[06:28:50] <strcat> simple and adequate for 95% of use cases > complex and adequate for 100% of them, for a standard library
[06:28:54] <cmr> agree
[06:28:59] <cmr> stdlib should be small and solid.
[06:29:23] <bjz_> perhaps we should focus on keeping things as basica as possible
[06:29:51] <cmr> If we don't want to be stuck with awful backwards compat issues, I think that's the only sane thing to do
[06:30:33] <bjz_> I think std::num was confused by attempting to work with extra::{Rational, Complex}
[06:31:29] <strcat> bjz_: well, my view is that we shouldn't define traits, in general
[06:31:39] <strcat> we should have impls on types, and generic free functions
[06:32:00] <strcat> the need for traits should appear naturally
[06:32:08] <mark_edward_> do we have futures/asycn?
[06:32:10] *** Quits: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Quit: )
[06:32:13] *** Joins: Benvie (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[06:32:24] <sfackler> there's extra::future
[06:32:27] <strcat> there's a need for all of the operator traits, and stuff like Clone/DeepClone/Iterator is 'obvious'
[06:33:08] <strcat> it's too hard to make something like a sensible hierarchy of traits for containers imo, at least with backwards compatibility
[06:33:19] <strcat> and it might not really result in any code reuse...
[06:33:34] <bjz_> strcat: but how does one do generic stuff - we don't have duck-typed templates like C++
[06:33:46] <bjz_> or overloading
[06:33:51] <strcat> bjz_: you define traits when you have a use case for them
[06:34:10] <strcat> when there are obvious, common use cases, the standard library can define them
[06:34:37] <strcat> C and Go don't have generics and it's not the end of the world - it *is* true that you can comfortably write a lot of code without them
[06:34:53] <strcat> there are obvious places you want them, like containers, iterators and simple generic building blocks (Eq, Ord)
[06:35:01] <strcat> other traits are not obvious in advance imo
[06:35:48] <strcat> and if we end up with nice closures, that removes a lot of the desire for generics anywhere (but we lack that atm)
[06:35:52] *** Joins: GeneralMaximus (ankur@8D663574.51CFCFFB.EBA8E3F.IP)
[06:36:04] <bjz_> why's that?
[06:36:44] <bjz_> an C added awkward support for generic code
[06:36:50] <strcat> in haskell, type classes aren't nearly as common as you might expect - it's more higher-order functions, and composing a few very common type classes
[06:37:03] <bjz_> to improve generic math
[06:37:08] <strcat> bjz_: not really
[06:37:14] <strcat> they added tgmath.h for fortran compatibility
[06:37:21] <strcat> they added _Generic to make tgmath.h possible to write in C
[06:37:28] <strcat> I think they regard it as a mistake, overall
[06:37:32] <bjz_> heh
[06:37:40] <tikue_> ercxx: i did not
[06:37:43] <strcat> (but they'd rather have tgmath.h possible in C than a smaller language)
[06:37:52] <strcat> since it exists already... have to cope
[06:38:14] <strcat> (should have made it optional like they did other poorly received C99 features)
[06:39:00] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[06:39:02] <bjz_> strcat: so do you think we should have things like absf64, absf32, absi8...?
[06:39:09] <strcat> no
[06:39:27] <strcat> bjz_: methods on impls for those types (or for now, free functions, because we can't do that)
[06:39:40] * strcat shrugs
[06:39:46] *** Quits: tudor (tudor@moz-233C4930.hsd1.ca.comcast.net) (Quit: Leaving)
[06:39:55] <strcat> so, lets say we fix the built-in type issue and you can define methods on built-ins in libstd
[06:40:06] <strcat> all of the C99 math functions can just be methods on floats
[06:40:11] <strcat> later, we can figure out a trait hierarchy
[06:40:16] <strcat> it will be backwards compatible
[06:40:17] *** Quits: GeneralMaximus (ankur@8D663574.51CFCFFB.EBA8E3F.IP) (Ping timeout)
[06:40:24] <bjz_> why should the stdlib be special?
[06:40:42] <strcat> bjz_: because you can't impl methods on types outside of where they are defined for coherence
[06:40:45] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:40:48] <strcat> so atm no one can impl on built-ins
[06:40:54] <strcat> I'm talking about non-trait methods
[06:41:00] <bjz_> I know
[06:41:12] <strcat> bjz_: for coherence it has to be restricted to the stdlib
[06:41:18] <cmr> #[own_builtins];
[06:41:28] <cmr> only one crate can be linked to yours with that attr
[06:41:58] <dbaupp> why only one?
[06:42:09] <cmr> dbaupp: otherwise you break coherency?
[06:42:17] <cmr> Two crates could define .push on ~[T]
[06:42:21] <cmr> What do you do?
[06:42:22] <dbaupp> cmr: could that one crate be linked to several others?
[06:42:27] <cmr> Of course
[06:42:34] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[06:42:35] <dbaupp> then you complain about two crates owning built-ins
[06:42:45] <cmr> But in the entire dep tree of your crate, only *one* can have #[own_buildins];
[06:42:48] <cmr> that's what I'm saying :p
[06:43:00] <dbaupp> oh, I see.
[06:43:05] <dbaupp> I read that backwards.
[06:43:20] <strcat> cmr: well
[06:43:20] <cmr> yeah, what I wrote was ambiguous
[06:43:22] <strcat> they could be lang items
[06:43:26] <strcat> each built-in can be a lang item
[06:43:45] <cmr> Yeah, that's true too.
[06:43:45] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[06:44:02] <strcat> #[lang = "i64]; struct I64(i64); /* just a private type, used to attach methods to, appearing on i64 */
[06:44:19] <strcat> missing a quote
[06:44:44] <dbaupp> "
[06:44:47] <dbaupp> fixed it
[06:45:02] <strcat> missing a closing ]; now
[06:45:14] <dbaupp> you fixed that
[06:45:22] <strcat> but it's a syntax error
[06:45:24] <strcat> ;[
[06:45:27] <dbaupp> ];
[06:45:50] <dbaupp> in any case, using lang-items seems like the obvious solution...
[06:46:06] <dbaupp> not they they actually need to be lang-items.
[06:46:27] <dbaupp> struct I64(i64); impl I64 { ... } is perfectly workable right now
[06:47:21] <strcat> dbaupp: except we don't support overloading literals
[06:47:29] <bjz_> strcat: I wonder if lots of the math functions should be static functions
[06:47:46] <strcat> bjz_: well, I would say they should all be methods
[06:47:57] <dbaupp> strcat: oh, of course.
[06:47:58] <bjz_> what about min?
[06:48:03] <strcat> bjz_: a method
[06:48:09] <dbaupp> bjz_: default method on Ord
[06:48:10] <bjz_> that does not have an obvious 'self'
[06:48:11] <strcat> method reform would remove the difference if you didn't care
[06:48:18] <strcat> dbaupp: fmix != min, though
[06:48:37] <strcat> fmin*
[06:48:48] *** Joins: GeneralMaximus (ankur@BAA3871B.C0426EC8.D8537A8F.IP)
[06:48:54] <strcat> if we did as I'd like and dropped Ord for floats, they'd need their own min/max (and they already have it)
[06:49:23] <dbaupp> yeah, that's what I awas assuming. (also, it'd be a default method, so f64/f32 could override it.)
[06:49:50] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:50:28] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Connection reset by peer)
[06:51:19] *** Joins: carrus85 (carrus85@CD83A7DD.7127D6FC.637467AC.IP)
[06:51:37] *** Joins: valenting (Thunderbir@64481B2A.F69E933D.FCAAE698.IP)
[06:52:02] <strcat> dbaupp: but Ord would mean total ordering so they wouldn't be able to impl it
[06:52:41] <dbaupp> strcat: yes, correct. There's two options: either Ord is total so don't need to worry about floats; or floats impl Ord and override the min/max method to act as fmin/fmax
[06:52:54] <strcat> and you also need TotalOrd in that case
[06:52:58] <dbaupp> when I first said it, I was thinking of the first option.
[06:53:01] <strcat> and TotalEq
[06:53:05] <dbaupp> i.e. Ord is total.
[06:53:24] <strcat> and then there's a crisis where you can't decide if something should use TotalEq/TotalOrd
[06:53:46] <strcat> if a container uses TotalOrd to maintain the internal structure/order, can it use that ordering to impl Ord?
[06:54:02] <strcat> that means we can't go ahead with implementing 2 forms of ordering for floats (at least with traits)
[06:56:06] <dbaupp> erm, ok. But I don't see how this has relevant to min being a default method on the Ord trait (when Ord is total).
[06:56:44] *** Quits: GeneralMaximus (ankur@BAA3871B.C0426EC8.D8537A8F.IP) (Connection reset by peer)
[06:56:59] <strcat> dbaupp: right it can be default method, but essentially nothing would override it imo
[06:57:15] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[06:57:39] <strcat> C++ min takes an initializer list ;p
[06:57:50] <strcat> min({1, 2, 3, -4, 0, -8, 3})
[06:58:31] <strcat> just because they don't use variadic templates when the types are the same
[06:58:41] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[06:59:01] *** Joins: dpc (Mibbit@3CA2DD5F.FAD414BA.D74CC41D.IP)
[06:59:17] <dpc> Any examples on how to use Rc and RcMut?
[06:59:44] <dpc> Real code for 0.9-git ?
[07:00:19] <cmr> dpc: plenty of examples in the tests.
[07:00:34] <cmr> I'll add some examples to the docs.
[07:01:12] <dpc> My code was stricken by @ removal.
[07:01:42] <strcat> @ isn't removed
[07:01:55] <strcat> just marked as something that's going to go away
[07:02:10] <strcat> i.e. it will become Gc<T>
[07:02:11] <dpc> Yeah. So sooner or later, I'll have to use RcMut.
[07:02:21] *** Quits: valenting (Thunderbir@64481B2A.F69E933D.FCAAE698.IP) (Ping timeout)
[07:02:32] *** Quits: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net) (Quit: pcwalton)
[07:03:52] <dbaupp> dpc: you can add the #[feature] for @, and wait until we get pointer traits to make using Rc/RcMut nicer.
[07:04:14] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[07:04:39] <dpc> Nah. I'll take a blow on my chest.
[07:04:53] <dbaupp> it'll be a big one, if you're using @ a lot
[07:05:16] <dpc> I find it really hard not to use @ in my project. :/
[07:06:09] <dpc> let c = RcMut<Creature>::new(self, pos, dir, controller, player);
[07:06:12] <dpc> Does this seem sane?
[07:06:22] <dbaupp> the biggest problem with @ and @mut is it's infectious: as soon as you start using it, it's almost impossible to *not* use it everywhere.
[07:06:33] <dpc> dbaupp: That's correct.
[07:06:39] <strcat> RcMut isn't meant to be widely used though
[07:06:54] <strcat> it's not going to have sugar as nice as Rc/Gc
[07:07:00] <dpc> I don't know. Maybe I'm doing something architecturally stupid.
[07:07:02] *** Quits: KindOne (KindOne@moz-B7437C7B.dynamic.ip.windstream.net) (Ping timeout)
[07:07:04] <dbaupp> (and conversely, if you avoid using @/@mut, you can still get a long way.)
[07:07:08] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Ping timeout)
[07:07:48] *** Quits: Aetherspawn_BNC (uid6924@moz-31ABA2C0.irccloud.com) (Quit: )
[07:08:54] <dpc> I get `error: unresolved name `RcMut`` all the time. :/
[07:09:07] <dbaupp> `use std::rc::RcMut;`?
[07:09:17] <dpc> Yes, I have it.
[07:09:38] <strcat> dpc: RcMut<T>::new isn't valid
[07:09:51] <strcat> just use RcMut::new(x), the type will be inferred
[07:10:08] <strcat> RcMut::<T>::new() would be the current syntax, I think
[07:10:18] <cmr> nope, RcMut::<for T>::new()
[07:10:22] <strcat> that works?
[07:10:24] <cmr> which doesn't exist yet.
[07:10:24] *** Joins: Jesin (Jessin_@moz-5C1F7BD2.res.lehigh.edu)
[07:10:30] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:10:31] <cmr> no, but neither does RcMut::<T>::new
[07:10:32] <dbaupp> cmr: no, RcMut isn't a trait
[07:10:35] <cmr> ohhhh
[07:10:38] <cmr> sorry, my bad
[07:10:41] *** Joins: GeneralMaximus (ankur@E4D7E75.ACC6091A.D1005D78.IP)
[07:10:42] * cmr goes back to doing homework
[07:10:52] <dpc> :D
[07:10:59] *** Joins: KindOne (KindOne@moz-45BBEAB4.dynamic.ip.windstream.net)
[07:11:02] <dbaupp> in theory RcMut::<T>::new works now, but I can't remember for sure.
[07:11:17] <dpc> Guys, Rust is really intimidating. At least at current stage. :)
[07:11:48] <dpc> I feel like a dumb C guy, every time I'm using it.
[07:12:09] <cmr> It's not an easy language.
[07:12:28] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:12:30] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Quit: tiffany)
[07:12:32] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[07:12:47] <strcat> you're not going to have a fun time using std::rc at this point, the language doesn't have strong enough support for custom smart pointers
[07:12:56] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[07:13:14] *** Joins: tiffnya (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[07:13:30] <dpc> Well, I guess I love puzzles.
[07:16:07] *** Quits: pnathan (Adium@moz-5EF6A514.tukw.qwest.net) (Quit: Leaving.)
[07:17:12] *** Quits: ercxx (ercan@moz-8383857F.dyn.optonline.net) (Quit: WeeChat 0.4.2)
[07:20:38] *** Quits: GeneralMaximus (ankur@E4D7E75.ACC6091A.D1005D78.IP) (Ping timeout)
[07:21:08] <dpc> Anyone rustpkg knowledgable around?
[07:24:10] <cmr> dpc: all of us together probably amount to 350 milli-tjc's :p
[07:24:28] <dpc> Maybe that will be enough. :D
[07:24:31] <dpc> So the problem is ...
[07:24:42] <dpc> I still have no bloody idea how to use rustpkg in the real life.
[07:24:43] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:25:13] <dpc> I don't know which parts are shortcomings, which bugs, and which intended usage.
[07:25:26] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:25:35] *** Joins: pnathan (Adium@moz-5EF6A514.tukw.qwest.net)
[07:25:40] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[07:26:28] *** Joins: valenting (Thunderbir@moz-E75529B3.euroweb.ro)
[07:26:35] <dpc> I'm playing with symlinks, PATH_RUST and I can't get it to work sanely, even tough I just want to use rust-sdl which is rustpkg-enabled.
[07:26:59] <cmr> (RUST_PATH)
[07:27:11] <dpc> Yeah.
[07:27:13] <cmr> That might well be your problem right there, if you're using the wrong env var :p
[07:27:42] *** Quits: h0rrorvacui (h0rrorvacu@moz-5B34B08.sip.bhm.bellsouth.net) (Quit: Leaving)
[07:27:43] <dpc> No, no. I triple-triple check everything, read all the tutorials, man pages and everything.
[07:28:34] <dpc> gopkg (or whatever it was called) just naturally worked for me without any trying.
[07:29:14] *** Joins: Jackneill (Jackneill@moz-4AAEEC30.pool.digikabel.hu)
[07:29:16] <dpc> And rustpkg... I just don't get it. :D
[07:29:18] <cmr> Ah, rust-sdl has a bug.
[07:29:20] <cmr> Well
[07:29:24] <cmr> rustpkg has a bug that rust-sdl exposes.
[07:30:01] <dpc> What kind of a bug? :)
[07:30:10] <dpc> I've already filled two bugs for rustpkg myself.
[07:30:18] <cmr> it doesn't have a lib.rs in the root, it's in `src`
[07:30:23] <cmr> tjc already fixed it, PR in the queue
[07:30:31] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:30:53] <dpc> But I can `rustpkg build -c mixer,image sdl` ...
[07:31:19] <dpc> But anyway. What should I set RUST_PATH to?
[07:31:32] <dpc> Shouldn't it default to ... donno ... "$HOME/.rust" ?
[07:31:37] <cmr> right, because it will use the cwd as the workspace, but `rustpkg install github.com/brson/rust-sdl` won't do anything.
[07:31:40] <dpc> Instead of $CWD ?
[07:31:55] <cmr> dpc: the default is ./.rust, to keep project deps separate (this was a requirement for servo)
[07:32:18] <cmr> reduces weirdness when you're working on multiple interdependant libs at the same time.
[07:32:22] <cmr> I set it to ~/.rustpkg
[07:32:51] <dpc> But in typical case, typical just wants to do "rustpkg build whatever" and be done with that library forever, isn't it?
[07:33:22] *** Quits: tiffnya (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[07:33:33] <cmr> Not if you're devving that lib and the things it depends upon
[07:34:04] <dpc> Hmmm ...
[07:34:05] <cmr> But to get that you just need to set RUST_PATH
[07:34:13] <cmr> Which go requires to do that, too!
[07:34:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:34:40] <dpc> Let me explain my current issue.
[07:34:55] <bjz_> dpc: https://github.com/mozilla/rust/issues?labels=A-pkg&page=1&state=open
[07:35:37] <dpc> bjz_: O_o Thanks ...
[07:35:42] <bjz_> :P
[07:35:58] <cmr> I can't get `rustpkg install` to do anything with rust-sdl at all :(
[07:36:02] <cmr> It's not even building it.
[07:36:03] *** Joins: darkowlzz (sunny@E5EF3D32.382C3725.27560D6E.IP)
[07:36:23] <cmr> there we go
[07:36:26] <cmr> that as weird
[07:36:27] <cmr> *was
[07:36:29] <dpc> cmr: I'm using latest official master of rust and rust-sdl ...
[07:36:31] * cmr notes to file a bug
[07:36:36] <cmr> dpc: as am i
[07:36:39] <bjz_> dpc: is this it: https://github.com/mozilla/rust/issues/10373
[07:37:09] <bjz_> bjz_: I filed it today ^_^
[07:37:13] <bjz_> *dpc
[07:37:16] <dpc> I don't get this RUST_PATH. I don't understand how it can have multiple values.
[07:37:25] <bjz_> it can't
[07:37:35] <cmr> dpc: it will install things into the first entry, but will look in all of them for deps.
[07:37:38] <cmr> bjz_: it can
[07:37:42] *** Joins: GeneralMaximus (ankur@5BA9B4F9.1E783F8C.D8537A8F.IP)
[07:37:49] <bjz_> cmr: oh, if you haven't set it?
[07:38:05] <cmr> Eh? It can't have multiple values if you don't set it; then it has *no* value.
[07:38:29] <bjz_> but you said it can?
[07:38:35] <dpc> So, I have rust-sdl installed under $RUST_PATH (one entry only) and when I do "rustpkb build rustyhex" it builds rust-sdl again ...
[07:38:36] <cmr> dpc: what I did to get rust-sdl working was clone rust-sdl somewhere, mv $that_dir/src/sdl ~/.rustpkg/src/sdl; rustpkg install sdl;
[07:38:40] * bjz_ is so confuzed
[07:39:33] *** Quits: GeneralMaximus (ankur@5BA9B4F9.1E783F8C.D8537A8F.IP) (Connection reset by peer)
[07:41:04] <dpc> cmr: And you had to do this because of what bug / problem ?
[07:41:49] <cmr> https://github.com/mozilla/rust/issues/10253
[07:41:58] <cmr> dpc: but I can't get things to work past installing
[07:42:02] * cmr gives up :(
[07:43:02] <dpc> cmr: I manually downloaded rust-sdl, did "rustpkg build sdl" inside it and that worked for me.
[07:43:30] <dpc> And now I'm importing using "use sdl" without any "= url" part.
[07:44:11] <cmr> oh hey that works now.
[07:44:25] <cmr> `extern mod sdl` with no = does the trick.
[07:44:51] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[07:45:06] <dpc> From what I understand "= sdl" completely changes the "name" of the package that it is looking for.
[07:45:18] <dpc> * "= url" i mean
[07:45:43] <cmr> = pkgid, :p
[07:45:46] <cmr> but yeah
[07:46:06] <dpc> Is it pkgid ?
[07:46:30] <cmr> That's the term for that string, yes.
[07:46:42] <dpc> How would I "fake" pkgid? Let's say I want to test my "github.com/dpc/superlib" without pushing to it publicly ?
[07:47:16] <cmr> You could put your code into $RUST_PATH/src/github.com/dpc/superlib
[07:47:29] <dpc> The local clone will have "src/superlib/" structure.
[07:47:34] *** Joins: GeneralMaximus (ankur@D67F016C.797420F9.C8956BBE.IP)
[07:47:57] <bjz_> dpc: that's a problem I've asked tjc about
[07:47:58] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[07:48:00] <dpc> Not "src/github.com/dpc/superlib/", so I can only do "rustpkg build superbuild"
[07:48:10] <cmr> dpc: that's #10253 isn't it?
[07:48:11] <bjz_> dpc: he hasn't figured out a solution yet
[07:48:26] <dpc> I competly don't like the structure of rust projects.
[07:48:41] <cmr> dpc: you don't need src/superlib
[07:49:33] <dpc> If you develop your program/library under "rustypkg" you end up with ~/lab/rustyhex/src/rustypkg/main.rs" . Not hard to spot redundancy. And redundancy always means bad.
[07:50:07] <dbaupp> dpc: note that rustpkg is still extremely immature and behaviour can (and, hopefully, will) change
[07:50:07] <dpc> The structure is fine for a workspace, sure.
[07:50:23] <cmr> dpc: your repo doesn't have to be a workspace, and IMO, shouldn't.
[07:50:53] <dpc> cmr: Does it not? Even the example project "hello world" from tutorial have this structure. Now rust-sdl implemented the same one.
[07:51:19] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[07:51:51] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:51:52] <dpc> I would be very happy if "~/lab/rust/" was my workspace, and I would just clone "~/lab/rust/src/rustyhex" as my repository where I keep my source and everything as I want.
[07:51:58] <cmr> dpc: it doesn't, now that the bug in rustpkg that used to *require* your repo to be a workspace in order for rustpkg to be useful.
[07:52:04] *** Joins: ofeldt (ofeldt@moz-EF7F201B.dip0.t-ipconnect.de)
[07:52:44] *** Quits: ofeldt- (ofeldt@moz-4E9CE318.dip0.t-ipconnect.de) (Ping timeout)
[07:53:02] <dpc> So this bug was solved?
[07:53:33] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[07:54:09] <cmr> `rustpkg build/install/test` will build whatever is in the cwd now, yes.
[07:54:22] <cmr> before it would only do so if you were in a srcdir of a workspace
[07:54:39] <dpc> Yay! OK. So seems like things are going into direction I desired. Perfect.
[07:55:17] <mark_edward_> I'm getting this error in a macro definition: `error: found `let` in ident position` can you not use let in macros?
[07:55:48] <dbaupp> mark_edward_: you can, but clearly not where you are using it.
[07:55:53] <dbaupp> code?
[07:56:45] <mark_edward_> dbaupp: https://gist.github.com/MarkJr94/7382930#file-letprobs-rs-L4-L9
[07:57:26] *** Quits: GeneralMaximus (ankur@D67F016C.797420F9.C8956BBE.IP) (Ping timeout)
[07:58:14] <dbaupp> mark_edward_: `=> ( { let thing: *u8 = ...; *thing } )`
[07:58:32] <mark_edward_> ah i see
[07:58:52] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Quit: z0w0)
[07:59:25] <dbaupp> mark_edward_: two problems with that: essentially macros substitute their token tree where they are called, so if you write `let a = A32!(10);` that's basically the same as writing `let a = let x: *u32 ...`, which is wrong
[07:59:59] <mark_edward_> oh ok. i thought let statements were expressions with type `()` though?
[08:00:01] <dbaupp> mark_edward_: and secondly, macros can only expand to a single expression/statement/item, so `let thing: *u8 = ...` would be parsed and then trailing *thing ignored
[08:00:20] <cmr> rusti: let y = 5
[08:00:22] -rusti- <anon>:10:4: 10:5 error: expected `;` but found `}`
[08:00:22] -rusti- <anon>:10     };
[08:00:22] -rusti-               ^
[08:00:22] -rusti- application terminated with error code 101
[08:00:24] <dbaupp> no, they're statements, and so need to be wrapped in a block to be come expressions
[08:00:26] <cmr> mark_edward_: nope
[08:00:31] <dbaupp> *become
[08:00:45] <mark_edward_> ah i see
[08:01:12] <dbaupp> mark_edward_: (well, *thing wouldn't actually be ignored, the compiler would complain about trailing tokens being ignored.)
[08:04:00] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[08:04:01] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Client exited)
[08:05:19] *** Quits: pnathan (Adium@moz-5EF6A514.tukw.qwest.net) (Quit: Leaving.)
[08:09:14] <mark_edward_> why do the ptr addition /offset functions require an unsafe block? they're not inherently unsfe
[08:09:54] <benh> yeah, they are. it's undefined behavior to offset a pointer past the object it's supposed to point up, or past one past the end of an array, or something like that.
[08:10:07] <benh> as defined by llvm, afaik, probably in deference to C
[08:10:43] <benh> if we wanted to allow pointer arithmetic without that restriction, we'd want to use a different llvm instruction that's slower, apparently
[08:10:46] <mark_edward_> wouldn't be undefined behavvior to push mroe elements to into a vec than memory can contain? seems that should be unsafe too by the same logic...
[08:10:50] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[08:11:11] <cmr> mark_edward_: http://static.rust-lang.org/doc/master/rust.html#behavior-considered-unsafe
[08:11:38] <cmr> breaks aliasing rules.
[08:11:43] *** Joins: GeneralMaximus (ankur@5314AC9C.C9562613.EBA8E3F.IP)
[08:11:57] <dbaupp> mark_edward_: that's just OOM, not undefined behaviour
[08:11:57] <mark_edward_> :-(
[08:12:33] <cmr> It's unsafe because it's UB.
[08:12:50] <cmr> It doesn't have to be UB, but then it's super slow (LLVM can't do any optimizations with that pointer anymore)
[08:14:40] <dbaupp> (e.g. the vector iterator doesn't vectorise)
[08:15:06] <benh> I suppose if you want you can cast the pointer to an uint, do arbitrary arithmetic, and cast it back
[08:15:09] <benh> in safe code
[08:15:14] <benh> i'm not sure how that works out...
[08:16:39] <dbaupp> it's (mostly) fine, but makes LLVM not optimise.
[08:20:09] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:21:31] <cmr> benh: it's only bad once you dereferecne the pointer, which is unsafe anyway
[08:21:57] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[08:24:04] <benh> cmr: weird to me that deriving the same pointer value in different ways is sometimes safe, sometimes forbidden
[08:24:49] <cmr> benh: one uses inttoptr, one uses GEPI
[08:25:08] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[08:26:10] *** Quits: alinab (alina@moz-C82147C8.members.linode.com) (Quit: leaving)
[08:27:00] <cmr> benh: it's definitely a leaky abstraction.
[08:28:29] *** Quits: dpc (Mibbit@3CA2DD5F.FAD414BA.D74CC41D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:28:30] <mark_edward_> how would you emulate a do while loop in rust?
[08:28:55] <dbaupp> loop { ... if condition { break } }
[08:28:55] <benh> loop { ... ; if !cond { break; } } ?
[08:29:12] <benh> pft, that's a do-until loop!
[08:29:39] <Sharp> You could probably write a macro to do it, no?
[08:29:58] * Sharp hasn't actually tried out Rust's macro system.
[08:30:14] <benh> it'd look weird tho
[08:30:34] <Sharp> do! while! ?
[08:30:45] <Sharp> Or just the parentheses?
[08:30:46] <cmr> do_while!(body, cond)
[08:31:05] <benh> Sharp: mostly that you have to wrap everything inside one parens pair
[08:31:26] *** Quits: darkowlzz (sunny@E5EF3D32.382C3725.27560D6E.IP) (Quit: This computer has gone to sleep)
[08:31:53] <Sharp> Yeah, I can see that.
[08:33:34] *** Joins: squiddy (squiddy@moz-2EA26255.adsl.alicedsl.de)
[08:33:47] <dbaupp> rusti: macro_rules! do_while( ($run:expr, $cond:expr) => { loop { $run; if !$cond { break } } } ) let mut i = 0; do_while!({ println!("{}", i); i += 1; }, i < 3)
[08:33:48] -rusti- 0
[08:33:48] -rusti- 1
[08:33:48] -rusti- 2
[08:33:48] -rusti- ()
[08:42:29] <strcat> benh: LLVM has two forms of pointer arithmetic - GEP and inbounds GEP
[08:42:39] <strcat> inbounds GEP is undef behaviour if you index out of bounds of an object
[08:42:59] <strcat> there's pretty much close to no use case for non-inbounds GEP, because it's *always* undefined to dereference outside of the bounds
[08:43:40] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[08:43:44] <strcat> C/C++ ptr arithmetic is only inbounds GEP
[08:47:02] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[08:53:34] <mark_edward_> can #cfg be used on single statements?
[08:54:13] <dbaupp> mark_edward_: no
[08:54:35] <mark_edward_> :( that'd be useful for emulating C macros. god i hate C
[08:54:41] <dbaupp> only via `if cfg!(...) { ... }` but that doesn't remove the statement entirely.
[08:58:27] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[09:00:53] *** Joins: DarkSin`18422 (TuttoIRC@moz-BCE850AE.retail.telecomitalia.it)
[09:01:07] <DarkSin`18422> ciao
[09:01:11] <DarkSin`18422> !list
[09:01:15] <cmr> dbaupp: hrm. could cfg!() have a second form, cfg!(..., $x:block) that expands to the block if the cfg matches, nothing elsewise?
[09:01:20] *** Parts: DarkSin`18422 (TuttoIRC@moz-BCE850AE.retail.telecomitalia.it) ()
[09:02:54] *** Joins: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net)
[09:03:58] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[09:04:36] <mark_edward_> strcat: #[cfg(target = "little")] and #[cfg(target = "big")] don't seem to work. i have a static var defined with a different val in each case and it never gets defined
[09:05:04] *** Quits: futurehorizons (Mibbit@moz-61717F7A.bitstream.orcon.net.nz) (Quit: http://www.mibbit.com ajax IRC Client)
[09:05:14] <strcat> mark_edward_: sorry, target_endian
[09:05:22] <mark_edward_> ah, thanks!
[09:09:19] <mark_edward_> is tere a static asssert?
[09:09:56] <strcat> #[static_assert] on a static bool
[09:09:59] <strcat> it's not incredibly useful
[09:10:24] <cmr> it'd be better if we had better constexprs, but alas
[09:10:30] <cmr> it's basically useless
[09:10:42] <cmr> not even suitable for what I wrote it for ;(
[09:11:23] <strcat> rusti: static xs: [int, ..1] = [0];
[09:11:24] -rusti- ()
[09:12:13] <strcat> rusti: static xs: [int, ..1] = [0]; static assert: int = xs[!((5 == 5) as bool)];
[09:12:15] -rusti- pastebinned 8 lines of output: http://sprunge.us/PDLL
[09:12:24] <strcat> rusti: static xs: [int, ..1] = [0]; static assert: int = xs[!((5 == 5) == 0)];
[09:12:25] -rusti- pastebinned 8 lines of output: http://sprunge.us/YEZO
[09:12:35] <strcat> rusti: static xs: [int, ..1] = [0]; static assert: int = xs[!((5i == 5) == 0i)];
[09:12:36] -rusti- pastebinned 8 lines of output: http://sprunge.us/NFCC
[09:12:47] * strcat cries
[09:13:20] <strcat> rusti: static xs: [int, ..1] = [0]; static assert: int = xs[!(5 == 5) as uint];
[09:13:21] -rusti- pastebinned 6 lines of output: http://sprunge.us/WYYR
[09:13:26] <mark_edward_> what happened to std::sys::size_of?
[09:13:26] <dbaupp> cmr: yes... I guess it could be `cfg_if_else!(..., $expr, $expr)` and then cfg!(...) is implemented as cfg!(..., true, false)
[09:13:32] <dbaupp> cmr: (ors omething like that)
[09:13:33] <strcat> haha, an LLVM assert
[09:13:41] <mark_edward_> oh std::me
[09:13:41] <dbaupp> mark_edward_: std::mem::size_of
[09:13:49] *** Quits: carrus85 (carrus85@CD83A7DD.7127D6FC.637467AC.IP) (Quit: Leaving)
[09:14:50] <strcat> cmr: well, you should see what a failure anything I tried to do with rust-core has been
[09:14:54] <strcat> just run into rustc bugs ;[
[09:15:49] <strcat> so much for prototyping allocators and so on for libstd - they can't be expressed due to ICEs! :(
[09:16:06] *** Joins: jakedust (Jake@moz-81D946E.dsl.telesp.net.br)
[09:16:11] * strcat will probably fix most of the bugs eventually ;p
[09:16:31] <strcat> rusti: static xs: [int, ..1] = [0]; xs[4]
[09:16:32] -rusti- task <unnamed> failed at 'index out of bounds: the len is 1 but the index is 4', <anon>:9
[09:16:32] -rusti- application terminated with error code 101
[09:19:58] <cmr> strcat: I believe in you!
[09:20:29] * strcat is most annoyed by https://github.com/thestinger/rust-core/blob/master/core/thread.rs#L29
[09:22:27] <strcat> could probably think of a clever extra layer of indirection to avoid that issue
[09:23:33] <strcat> yeah I guess it can be boxed in a rust ABI fn
[09:23:44] <strcat> and then the rust ABI fn is boxed and passed to the C ABI fn
[09:23:51] <strcat> maybe
[09:28:57] *** Joins: nkoep (nik@moz-E87F9F2C.pool.mediaways.net)
[09:29:53] *** Joins: darkowlzz (sunny@CA2E2FA6.C1ACE797.25B273F5.IP)
[09:32:45] *** Quits: GeneralMaximus (ankur@5314AC9C.C9562613.EBA8E3F.IP) (Ping timeout)
[09:36:17] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Quit: Uudelleensaapas)
[09:41:49] *** Joins: GeneralMaximus (ankur@23A84DCB.F2BF40FA.D1005D78.IP)
[09:41:50] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[09:46:59] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[09:49:13] *** Quits: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net) (Ping timeout)
[09:50:01] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[09:50:36] *** Quits: GeneralMaximus (ankur@23A84DCB.F2BF40FA.D1005D78.IP) (Ping timeout)
[09:59:05] <strcat> cmr: https://github.com/thestinger/rust-core/commit/7055ed98ee71642be9d5f2514ff1039b9bb1abf5 terrible :(
[09:59:20] * strcat forgot to commit that file
[09:59:36] *** Joins: GeneralMaximus (ankur@3A37990C.4316D0B4.C924875F.IP)
[10:00:03] <strcat> cmr: https://github.com/thestinger/rust-core/commit/77e4abe04560531fe5253b4620a20effd527d03c *sigh*
[10:00:28] *** Joins: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net)
[10:04:54] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Quit: Lost terminal)
[10:10:58] *** Quits: GeneralMaximus (ankur@3A37990C.4316D0B4.C924875F.IP) (Connection reset by peer)
[10:12:09] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[10:13:40] <kimundi> strcat: Hm, `target.clone_from(source)` reads strange imo. Why did you choose that name/order?
[10:14:02] <strcat> seems fine to me ;p
[10:15:14] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[10:15:26] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Ping timeout)
[10:15:58] <kimundi> Seems backwards compared to source.clone() -> target imo
[10:16:31] <strcat> kimundi: what do you want it to be?
[10:16:38] <strcat> source.clone() returns something
[10:16:46] <strcat> clone describes the action of cloning and returning
[10:17:12] <strcat> destination.clone_from(&source) describes cloning, *from* the passed parameter
[10:19:43] <kimundi> Well, I see it as this: source.clone() clones the thing the clone method is called on. It seems logical to be consistent in that regard.
[10:20:04] <cmr> source.clone_to(&mut target) ?
[10:20:09] <kimundi> I mean, I don'T want to bikesheddy, but I honestly thing clone_into would be less confusing :(
[10:20:55] <strcat> if it was just called Copy/copy I would have called it copy_assign
[10:21:12] <strcat> and deep_copy_assign
[10:21:15] *** Joins: GeneralMaximus (ankur@C9C34109.8D76FC.90B98F9.IP)
[10:21:23] <strcat> clone_assign sounds really dumb.
[10:21:28] <strcat> (to me at least)
[10:22:53] *** Joins: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP)
[10:23:12] <kimundi> Maybe just not think about it as `replace self with the clone of a value` but as `clone self into another value` ?
[10:23:29] <kimundi> That's my mental model about that method anyway
[10:24:31] *** Quits: valenting (Thunderbir@moz-E75529B3.euroweb.ro) (Ping timeout)
[10:25:04] *** Joins: valenting (Thunderbir@moz-E75529B3.euroweb.ro)
[10:26:43] *** Quits: valenting (Thunderbir@moz-E75529B3.euroweb.ro) (Ping timeout)
[10:27:05] <cmr> Firefox really hates me for opening 108 tabs at once
[10:27:10] *** Quits: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net) (Ping timeout)
[10:28:39] <TeXitoi> is there a way to transform a [[T]] into an Iterator<Iterator<T>> ?
[10:29:43] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[10:29:46] <cmr> TeXitoi: For ~[~[T]],  xs.move_iter().map(|x| x.move_iter())
[10:30:13] <TeXitoi> cmr: thanks
[10:30:41] <cmr> TeXitoi: You probably just want .iter(), though, and have the inner be Iterator<&T>
[10:31:43] <cmr> Should I consider adding variants to an enum to be a breaking change? It could break exhaustiveness of a match.
[10:32:25] <cmr> otoh, it's very trivial
[10:32:48] <strcat> dunno
[10:32:54] <kimundi> cmr: What enum?
[10:32:54] <strcat> cmr: I fixed it ;p
[10:32:56] <strcat> kind of
[10:32:59] <strcat> I fixed the codegen problem
[10:33:01] <cmr> kimundi: https://github.com/mozilla/rust/pull/10093
[10:33:06] <strcat> there's another problem!
[10:33:11] <strcat> type substs don't work right ;]
[10:34:28] <strcat> yay
[10:36:38] *** Joins: Palmik (palmik@moz-DEC2AB.pks.muni.cz)
[10:37:08] *** Quits: flaper87|afk (flaper87@moz-107AD163.redhat.com) (Ping timeout)
[10:39:56] *** Joins: pseudoku (quassel@EB16CC4B.9192D293.520CDC98.IP)
[10:40:15] *** Quits: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP) (Quit: Leaving)
[10:41:04] *** Joins: flaper87|afk (flaper87@moz-107AD163.redhat.com)
[10:41:12] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[10:42:28] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[10:44:06] <Luqman> sweet, my rust minecraft client seems to work :D
[10:44:23] <cmr> Luqman: whoa, cool!
[10:44:31] <cmr> just the protocol or do you have a frontend too?
[10:44:37] <kimundi> wait, what? xD
[10:44:47] <Luqman> well, all it does is let you send/see chat messages right now :P
[10:46:28] <Luqman> https://github.com/luqmana/mcchat
[10:48:19] <pseudoku> Hi, I want to write a constructor function fn new<'r, R: Seek + Reader>(val: &'r mut R)  that accepts only references to types that implement both Reader and Seek traits. However the function stores the reference as &'self mut Reader in a structure since trait bounds are not allowed in struct definitions. However when i cast the passed in reference to &'r mut Reader i get ' error: value may contain borrowed pointers; add `'static` bound' . How
[10:48:19] <pseudoku>  do i acheive this?  
[10:48:58] <cmr> pseudoku: you want to store &'self mut T, not a trait object.
[10:49:00] <kimundi> R: Seek + Reader + 'static
[10:49:03] <kimundi> I think
[10:49:32] *** Quits: darkowlzz (sunny@CA2E2FA6.C1ACE797.25B273F5.IP) (Quit: This computer has gone to sleep)
[10:49:32] <TeXitoi> failed to find an implementation of trait std::fmt::Default for ~[(int,int)] -> what is the easy way to print vectors/tuple ?
[10:50:04] <pseudoku> cmr: i tried that but the struct definition cannot specify the trait bounds...is it enough that the new function specifies it?
[10:50:16] <kimundi> Sounds like we need someone to implement fmt::Default for a few tuple sizes
[10:50:18] <dbaupp> pseudoku: yes, and every impl of the type then repeats the bounds
[10:50:33] <kimundi> TeXitoi: You can use {:?} in the meantime
[10:50:45] <TeXitoi> kimundi: I'll try, thanks
[10:51:27] <dbaupp> pseudoku: i.e. any functions that need the bounds have them on the impl, and so a user can only call the functions when the bounds are satisifed. (If they some how construct that struct with a type that doesn't satisfy those bounds, then the won't be able to call any of the methods anyway.)
[10:51:40] <pseudoku> dbaupp: ooh, why isn't trait bounds allowed on structs anyway
[10:51:56] <dbaupp> pseudoku: because they'd have to be repeated anyway.
[10:52:15] <dbaupp> kimundi: ~[] doesn't have a fmt::Default impl either.
[10:52:26] <kimundi> It doesn'T?
[10:52:34] <cmr> (In other words, they don't affect representation or use of the struct in any way, ever)
[10:52:52] <dbaupp> kimundi: yes, it doesn't.
[10:53:17] <pseudoku> dbaupp & cmr: that makes sense, thanks
[10:55:42] *** Joins: valenting (Thunderbir@EAC19D63.F5D5DDE0.7A932F41.IP)
[10:59:27] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[11:00:03] *** Joins: miloshadzic (miloshadzi@59612C1E.AEAC8983.ADC9B595.IP)
[11:00:11] <nuts> ChrisMorgan: I build binfgen successfully after rebuilding clang
[11:00:22] <cmr> Hm, judging by https://github.com/mozilla/rust/pull/10348, Samsung is running the testsuite on Android!
[11:00:24] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[11:00:34] <cmr> Which means tests get run on ARM, at least sometimes! \o/
[11:01:12] <ChrisMorgan> nuts: ?
[11:01:59] <ChrisMorgan> cmr: of course, android is not quite linux-unknown-gnueabi(hf)?
[11:02:28] <cmr> ChrisMorgan: sure, but it's a good sign that we're not subtly broken on the arch
[11:02:37] <ChrisMorgan> Indeed.
[11:04:40] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[11:06:20] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[11:08:59] *** Quits: valenting (Thunderbir@EAC19D63.F5D5DDE0.7A932F41.IP) (Ping timeout)
[11:13:20] *** Joins: nlminhtl (ignotus@moz-BA3DE7EF.volia.net)
[11:13:25] *** Quits: StarLight (StarLight@moz-A9906031.dynamic.avangarddsl.ru) (Ping timeout)
[11:15:37] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[11:17:04] <nlminhtl> Where can I download rust-stage0-*.tar.bz2? Looks like there is some problem with static.rust-lang.org https://gist.github.com/Ignotus/88fdce09c39d2743a284/raw/1e3410469b0fc2d8ae5bebe81b978173170428e2/gistfile1.txt
[11:17:12] <nlminhtl> Hello.
[11:17:33] *** Joins: StarLight (StarLight@moz-6A319F09.dynamic.avangarddsl.ru)
[11:17:38] <cmr> nlminhtl: try again? it works for me.
[11:18:10] *** Quits: Kingsley (kingsley@BBD66DE2.61F456DA.3655BBF5.IP) (Quit: Leaving.)
[11:18:23] <cmr> nlminhtl: if you really need to, you could look through the buildbot history for the build artifacts.
[11:18:58] *** Quits: KindOne (KindOne@moz-45BBEAB4.dynamic.ip.windstream.net) (Input/output error)
[11:18:59] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[11:19:40] *** Joins: KindOne (KindOne@moz-45BBEAB4.dynamic.ip.windstream.net)
[11:19:50] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[11:20:40] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:22:22] <dbaupp> cmr: that's probably impossible, buildbot deletes history
[11:22:34] <cmr> dbaupp: oh it does? that's a shame.
[11:22:44] <cmr> well I mean, it makes sense.
[11:23:51] <dbaupp> but all the snapshots are referenced in src/snapshots.txt, just gotta work out the url.
[11:25:12] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Connection reset by peer)
[11:25:21] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[11:27:03] *** Quits: GeneralMaximus (ankur@C9C34109.8D76FC.90B98F9.IP) (Ping timeout)
[11:32:10] *** Joins: canhtak (canhtak@moz-44AEB22E.wl.t.ulaval.ca)
[11:34:48] *** Joins: GeneralMaximus (ankur@1B3CE16D.CA574402.EBA8E3F.IP)
[11:37:21] <mark_edward_> i'm trying to write a port of LZ4 in pure Rust, and im having trouble with getting the xxhash function correct: my tests fail here: https://github.com/MarkJr94/lz4-rs/blob/master/xxhash/mod.rs#L43-L84
[11:38:11] <mark_edward_> and I'm wrking off of the xxhash google code repo: i got the sample tests here: http://code.google.com/p/xxhash/source/browse/trunk/bench.c#355
[11:38:31] <mark_edward_> just wondering if anyone has any advice
[11:38:56] <cmr> mark_edward_: cool!
[11:40:21] <cmr> mark_edward_: lots of unsafe code, which means lots of room for failure.
[11:40:44] <cmr> mark_edward_: run under valgrind, first, and then check for off-by-one everywhere, is what I'd do.
[11:40:59] <cmr> I'd try and implement it with safe code first, profile it, and then tune.
[11:41:10] <dbaupp> mark_edward_: is it segfaulting? or just giving the wrong anser?
[11:41:25] <mark_edward_> jsut giving the wrong answer. consistently wrong though.
[11:42:18] <dbaupp> get a minimal example, put a whole pile of intermediate printlns in the c code and the rust code and find the first step where they mismatch
[11:42:36] <dbaupp> and then you know where the bug is... fixing it is another matter :P
[11:43:16] <mark_edward_> oh god :(
[11:43:33] <cmr> Isn't programming fun! \o/
[11:43:39] <mark_edward_> thanks though, seems like the best option
[11:44:09] <cmr> mark_edward_: line!() comes in handy when doing brute-force printf debugging.
[11:44:45] <dbaupp> (also, gdb works reasonably well with `-Z debug-info`, so you could step through with that.)
[11:45:12] <dbaupp> it even prints enums nicely, which I thought was pretty cool.
[11:45:23] <mark_edward_> oh, that's pretty cool
[11:45:24] * dbaupp hugs mw
[11:53:43] *** Joins: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net)
[12:03:22] <cmr> Any announcements for TWiR?
[12:04:23] <mark_edward_> using __LINE__ in C printf is giving me segfaults... 
[12:04:58] <klutzy> great announcement.
[12:05:20] <cmr> :p
[12:05:40] <mark_edward_> lol. sorry
[12:07:34] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[12:08:06] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[12:08:49] <ChrisMorgan> cmr: have you got the resolution at the end of the minutes from last week or the week before, that Rust is awsome (or whatever the wording was)?
[12:09:12] <cmr> ChrisMorgan: It didn't really seem above the S:N
[12:09:19] <cmr> I mean, it's a given
[12:09:22] <ChrisMorgan> Aww. :-(
[12:09:45] <ChrisMorgan> cmr: but you need to remind people of it!
[12:11:56] * dbaupp will make a point of not reading TWiR if cmr doesn't mention that Rust is awesome.
[12:14:22] <nuts> It's possible to make a str from c_schar ?
[12:14:50] <cmr> nuts: http://static.rust-lang.org/doc/master/std/str/raw/fn.from_c_str.html
[12:14:53] *** jorendorff_away is now known as jorendorff
[12:15:22] <nuts> right, I forget all the time from_c_str :(
[12:16:26] *** Joins: askalski (akuda@309E5B07.C38989A9.A61CD463.IP)
[12:17:04] <cmr> http://cmr.github.io/blog/2013/11/09/these-weeks-in-rust/
[12:18:00] <cmr> ChrisMorgan: :)
[12:18:13] <ChrisMorgan> cmr: the reminder wasn't from me, it was just a reminder that that was a resolution reached in the meeting.
[12:18:22] <cmr> Irrelevant.
[12:18:24] <ChrisMorgan> That's not to say that I disagree with it. Far from it!
[12:18:46] <ChrisMorgan> In fact, I will gladly remind people that Rust is awesome.
[12:18:53] <klutzy> cmr: [quite a bit]
[12:19:00] <cmr> klutzy: thanks
[12:19:26] <ChrisMorgan> cmr: I thought the deal with segmented stacks wasn't that they're going away, but rather than they're not coming back (not having been implemented in newrt). Is that not correct?
[12:19:30] *** Joins: q66__ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[12:19:39] <cmr> ChrisMorgan: It is correct
[12:19:49] <cmr> Will fix that.
[12:20:30] *** Quits: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[12:23:09] *** Joins: kirneh (kirneh@moz-ACBB9422.k955.webspeed.dk)
[12:24:55] <dbaupp> cmr: there's something about &fn(A) -> B being able to be written as |A| -> B (in types)
[12:25:37] <cmr> Oh right, I overlooked that one because it was hidden in the "remove mocks" PR
[12:25:41] * cmr shakes fist at pcwalton
[12:26:12] <dbaupp> cmr: also, sh8281.kim and niftynif are "Patrick Kim" and "Jennifer Ward" according to their github accounts.
[12:28:28] *** Joins: cadence (Mibbit@moz-6DDBAC35.sub-70-209-7.myvzw.com)
[12:28:59] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[12:29:44] *** Joins: ksf__ (ksf@moz-373D6835.adsl.hansenet.de)
[12:30:18] *** Quits: ksf_ (ksf@moz-E85E6526.adsl.hansenet.de) (Ping timeout)
[12:31:05] <cmr> dbaupp: both fixed, thanks <3
[12:31:24] <cadence> Can someone help me with a Mac question? I have built rust @35c3aaf and installed it to ~/.local/stow/rust. I then stow'ed rust so that I have nice symbolic links set up. In my PATH, I added` ~/.local/bin:~/.local/sbin:`.
[12:31:50] <cadence> rustc --version says: rustc 0.9-pre (35c3aaf 2013-11-08 03:26:07 -0800)
[12:31:56] <cadence> but which rust fails.
[12:32:08] <cadence> Also: https://github.com/cadencemarseille/rust-pcre/pull/3#issuecomment-28125665
[12:32:16] <Luqman> cadence: the rust tool is gone
[12:32:25] *** Quits: GeneralMaximus (ankur@1B3CE16D.CA574402.EBA8E3F.IP) (Ping timeout)
[12:32:32] *** Joins: eddyb9 (eddy@336E3A7F.D51DAF03.FB866788.IP)
[12:32:43] <cadence> Luqman: Yes, sorry. That was a typo. `which rustc` fails.
[12:32:45] *** Quits: jakedust (Jake@moz-81D946E.dsl.telesp.net.br) (Quit: jakedust)
[12:32:59] <eddyb9> hmm, what is this? ~(.___________.)
[12:33:14] <cmr> cadence: funky. Does `where rustc` work?
[12:33:27] <eddyb9> I mean, what does it look like?
[12:33:33] <cadence> cmr: I don't have `where`?
[12:33:53] <cmr> cadence: oh, maybe that's a zsh-ism.
[12:34:01] <cadence> cmr: (I am running OS 10.9 'Mavericks', BTW)
[12:34:40] <dbaupp> cadence: does `which rustc` work
[12:34:49] <dbaupp> eddyb9: a whale?
[12:35:11] <dbaupp> cadence: oh, I see that you said that already.
[12:35:23] <eddyb9> dbaupp: an owned whale :P
[12:35:26] * dbaupp should read more than just the last 4 lines
[12:35:41] <dbaupp> eddyb9: whales are not property!
[12:36:14] <cmr> dbaupp: says you!
[12:36:23] * cmr is very protective of his whales
[12:37:03] <dbaupp> cmr: btw, by "both fixed"  do you mean "only one fixed"? (I still see sh8281.kim)
[12:37:03] <eddyb9> how do you deny borrowing?
[12:37:18] <dbaupp> eddyb9: in what sense?
[12:37:58] <cmr> dbaupp: weird, fixed again
[12:38:24] <eddyb9> dbaupp: I was still talking about whales :))
[12:38:46] <dbaupp> eddyb9: oh, well. whales are very big, and so are hard to fit out the library doors.
[12:38:56] <cadence> Aha! I can't use `~` in my PATH.
[12:39:04] <cadence> Ironic.
[12:39:09] <dbaupp> eddyb9: so borrowing is disallowed automatically.
[12:39:12] <cmr> cadence: Ohh right
[12:39:22] <cmr> (also a bash limitation, fwiw)
[12:39:45] <eddyb9> cadence: it usually expands in the command where you set PATH, AFAIK
[12:40:19] <dbaupp> cmr: isn't that more of a POSIX shell limitation?
[12:40:46] <cmr> dbaupp: I dunno, does it forbid ~ expansion?
[12:40:48] <eddyb9> cadence: unless you're escaping it somehow
[12:40:51] <cadence> eddyb9: Makes sense. It's probably not working because of my quotes.
[12:41:17] <cadence> Yep.
[12:42:02] <cadence> Sorry for the distraction. Back to more important things... like owned whales :)
[12:42:04] <dbaupp> cmr: well, it's actually even lower than that... execve inteprets PATH: http://pubs.opengroup.org/onlinepubs/000095399/functions/execve.html "Otherwise, the path prefix for this file is obtained by a search of the directories passed as the environment variable PATH"
[12:43:12] <cmr> dbaupp: sure, but zsh just always expands ~ in PATH, afaik.
[12:44:09] <eddyb9> ~(o___o) is actually valid syntax AFAIK :D
[12:44:12] <cmr> nope, nv,.
[12:44:20] <cmr> *nvm
[12:44:32] <cmr> I need to get better at sleeping at night :(
[12:45:26] <eddyb9> my new gf is helping with that :P
[12:45:38] <eddyb9> going out with her after her school hours, I realize how fucking tired I actually am
[12:46:01] <dbaupp> ~(0___0) is too, and doesn't require defining variables
[12:46:15] <cmr> ~(0___0), the Bors Constant.
[12:46:32] <eddyb9> wait, what? how would that work?
[12:46:38] <cmr> rusti: 1_000_000
[12:46:39] -rusti- 1000000
[12:46:45] <dbaupp> eddyb9: magic
[12:46:53] <cmr> rusti: 0b1110_0010
[12:46:54] -rusti- 226
[12:46:59] <eddyb9> ahahaha, I've forgotten that's a thing
[12:47:03] <dbaupp> rusti: ~(0___0)
[12:47:04] -rusti- ~0
[12:47:24] <cmr> rusti: format!("{:p}", ~0 as *int)
[12:47:26] -rusti- pastebinned 9 lines of output: http://sprunge.us/iNFU
[12:48:07] <eddyb9> rusti: version
[12:48:08] -rusti- "rustc 0.8"
[12:48:35] <dbaupp> cmr: ~ -> * doesn't work
[12:48:43] <eddyb9> dbaupp: I've used a similar pattern, but in a more meaningful way
[12:48:47] <cmr> dbaupp: neither does my X server, apparently.
[12:48:50] <cmr> I can't create new windows.
[12:49:07] <dbaupp> eddyb9: what do you mean?
[12:49:18] <dbaupp> cmr: do you have a terminal open?
[12:49:23] <cmr> dbaupp: I sure do!
[12:49:29] <cmr> "can't open display :1"
[12:49:38] <dbaupp> cmr: then it's fine, don't need any more windows.
[12:49:40] <cmr> and yet I'm staring at it
[12:49:42] <cmr> heh
[12:49:49] <dbaupp> is it display :0 ?
[12:49:59] <cmr> no, display :0 is the neglected gdm
[12:50:09] * cmr kills X
[12:50:39] *** Quits: cadence (Mibbit@moz-6DDBAC35.sub-70-209-7.myvzw.com) (Quit: http://www.mibbit.com ajax IRC Client)
[12:51:06] <eddyb9> dbaupp: 'A__B__C_' would be a byte, 3 bits for A, 3 for B and two for C. that's used in wiREd, and even if it's not completely related, you reminded me of it
[12:51:28] <dbaupp> eddyb9: oh, I see
[12:51:51] <dbaupp> eddyb9: that's pretty neat :)
[12:52:43] <eddyb9> you could use lowercase to continue the name, but the field could be much larger
[12:53:05] <nlminhtl> cmr: where is the buildbot?
[12:53:14] <cmr> NFS, which my home dir happens to be on, apparently decided to die.
[12:54:01] <eddyb9> 'Imm_____________' looks much nicer than 'Immediatesixteen' :P
[12:54:14] <cmr> nlminhtl: buildbot.rust-lang.org
[12:54:26] <dbaupp> eddyb9: and you can immediately tell how long it is too /s :P
[12:54:59] <nlminhtl> cmr: thanks!
[12:56:23] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[12:57:44] *** Joins: Ms2ger (Ms2ger@moz-EA6EE9F3.adsl-dyn.isp.belgacom.be)
[12:59:29] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[13:01:12] <eddyb9> dbaupp: I would've allowed numbers, but 0/1 are used for constant bits, so I couldn't really do much about that
[13:02:18] <eddyb9> I guess one digit above 1 and/or one or more _ would be enough to distinguish from constant bits in the "parser", but I don't feel like coming up with a regexp for that
[13:03:15] *** Joins: ksf_ (ksf@moz-7D076599.adsl.hansenet.de)
[13:03:16] *** Quits: ksf__ (ksf@moz-373D6835.adsl.hansenet.de) (Ping timeout)
[13:04:40] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:05:54] <eddyb9> dbaupp: I'm curious, is there any logic for restricting Eq and Ord to bool Results?
[13:06:47] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[13:06:54] *** Joins: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com)
[13:07:52] *** jorendorff is now known as jorendorff_away
[13:08:50] *** Quits: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com) (Ping timeout)
[13:13:17] *** jorendorff_away is now known as jorendorff
[13:18:52] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[13:23:09] <mark_edward_> dbaupp: for my earlier problem... if my answer is evidently random, even though it shouldn't be, that must mean there is some memory error somehwere, right?
[13:25:33] *** jorendorff is now known as jorendorff_away
[13:27:40] *** Quits: squiddy (squiddy@moz-2EA26255.adsl.alicedsl.de) (Ping timeout)
[13:28:06] <mark_edward_> cmr: what do you think?
[13:28:59] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:29:04] *** Joins: Darkstar (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se)
[13:29:17] *** Parts: Darkstar (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se) ()
[13:30:39] *** Joins: Purrr (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se)
[13:36:33] *** Quits: eddyb9 (eddy@336E3A7F.D51DAF03.FB866788.IP) (Quit: Leaving)
[13:36:41] *** Joins: darkowlzz (sunny@CA2E2FA6.C1ACE797.25B273F5.IP)
[13:41:09] *** Quits: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[13:41:24] *** Parts: kirneh (kirneh@moz-ACBB9422.k955.webspeed.dk) ()
[13:41:26] <cmr> mark_edward_: probably!
[13:41:40] <cmr> mark_edward_: either that or unitialized things.
[13:41:58] <cmr> mark_edward_: I repeat my valgrind recomendation :)
[13:43:59] <cmr> eddyb: Like, Result<(), ()> ?
[13:44:54] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[13:50:40] *** Joins: jakedust (Jake@moz-81D946E.dsl.telesp.net.br)
[13:53:32] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Ping timeout)
[13:54:25] <eddyb> cmr: I meant Eq<RHS, Result> (unrelated to the Result enum)
[13:56:53] <cmr> oh
[14:03:46] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[14:04:22] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[14:07:16] *** Quits: askalski (akuda@309E5B07.C38989A9.A61CD463.IP) (Ping timeout)
[14:07:33] *** Joins: askalski (akuda@309E5B07.C38989A9.A61CD463.IP)
[14:10:29] *** Quits: askalski (akuda@309E5B07.C38989A9.A61CD463.IP) (Ping timeout)
[14:10:58] *** Joins: askalski (akuda@309E5B07.C38989A9.A61CD463.IP)
[14:13:04] <yuriks_> Hey!
[14:14:24] *** Quits: askalski (akuda@309E5B07.C38989A9.A61CD463.IP) (Ping timeout)
[14:14:33] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[14:20:16] *** Quits: ksf_ (ksf@moz-7D076599.adsl.hansenet.de) (Quit: Leaving)
[14:26:44] *** Joins: tudor (tudor@moz-233C4930.hsd1.ca.comcast.net)
[14:29:20] *** Joins: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP)
[14:29:20] *** ChanServ sets mode: +o jdm
[14:30:36] <ChrisMorgan> I want to check the last character of a string, to see if it is ']'. Anything better than `s.char_at_reverse(s.len()) == ']'` or `s[s.len() - 1] == ']' as u8` (the latter requiring knowledge of how UTF-8 works!)?
[14:31:36] <cmr> ChrisMorgan: don't think so
[14:31:46] <ChrisMorgan> Hmm. Not nice.
[14:32:11] <cmr> s.iter().last() ? :P
[14:32:15] <ChrisMorgan> (It's also not very nice that s.len() means the number of UTF-8 bytes, not the number of characters. I'm confident that will trip some people up.)
[14:32:31] <ChrisMorgan> cmr: O(N), as you well know.
[14:32:34] <cmr> Yeah
[14:32:44] <ChrisMorgan> s.rev_iter().first() :P
[14:32:54] <cmr> .next() you mean
[14:33:39] <ChrisMorgan> Yeah. I think I was thinking of vec there.
[14:33:48] <ChrisMorgan> No, not sure.
[14:34:07] <kimundi> ChrisMorgan: I personally think str should not expose len(), but rather len_char(), len_bytes() and len_glyphes() exactly for those reasons
[14:35:12] <ChrisMorgan> By glyphes (glyphs?) do you mean graphemes?
[14:35:24] <kimundi> grapheme cluster, yeah
[14:35:36] <ChrisMorgan> Sorry, yeah, I meant grapheme clusters.
[14:35:48] * ChrisMorgan isn't being very clear; he should go to bed
[14:35:58] <kimundi> It's really hard to find a short name for those things
[14:36:00] <ChrisMorgan> Now comes the obligatory extra hour before I actually go to bed :P
[14:36:17] <ChrisMorgan> abbreviate it to gc :P
[14:36:34] <kimundi> I had GrCl :P
[14:38:39] <Purrr> Allo! I got a question about pattern matching: Do the arms need to be of the same type?
[14:39:15] <ChrisMorgan> Purrr: yes
[14:39:37] * kimundi wonders if that representation trinity could be improved by adding adapters: "foo".as_glyphs().len() and "foo".as_bytes().len() vs "foo".len() and "foo".glyph_len()
[14:39:42] *** Joins: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP)
[14:39:56] <ChrisMorgan> Purrr: they're matching on the same object which can have but a single type, so their patterns must clearly be matching the same type.
[14:40:16] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[14:40:40] <ChrisMorgan> Purrr: as for the value of the arm expressions, that must also clearly be of the same type as it must end up as the result of the entire match expression and an expression can have but one type.
[14:41:13] <Purrr> ChrisMorgan: Ah, thanks!
[14:41:44] <ChrisMorgan> kimundi: GrCl would do better if Gr was an element. I had to check it, but the closest, Germanium, is Ge.
[14:46:06] *** Joins: askalski (akuda@309E5B07.C38989A9.A61CD463.IP)
[14:52:41] <kimundi> ChrisMorgan: haha :)
[14:54:44] *** Joins: sanxiyn (tinuviel@5DAC0FAD.5592B676.8A051A1C.IP)
[14:54:47] *** jorendorff_away is now known as jorendorff
[14:55:15] *** Quits: jeffcutsinger (Mibbit@moz-7E34AC5D.dhcp.roch.mn.charter.com) (Quit: http://www.mibbit.com ajax IRC Client)
[14:55:31] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[14:55:46] <ChrisMorgan> What? str.slice appears to be closed rather than half-open :-/
[14:57:05] <ChrisMorgan> rusti: let s = "[uh oh]"; s.slice(1, s.len() - 1)
[14:57:06] -rusti- "uh oh"
[14:57:14] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[14:57:58] <ChrisMorgan> Hang on... my bad expectations.
[14:58:04] <ChrisMorgan> Certainly bed time, then.
[14:58:17] <sanxiyn> Yeah looks correct to me
[14:59:06] <kimundi> Note that rusti is on 0.8
[14:59:26] *** Joins: jeffcutsinger (jeff@moz-7E34AC5D.dhcp.roch.mn.charter.com)
[14:59:38] <kimundi> I don't know of a change to slice, but you can't take rustis word for it working right now ;)
[15:00:31] <bjz_> kimundi: awesome stuff on the task failure stuff :)
[15:00:49] * bjz_ claps
[15:01:18] <kimundi> I still can't believe that I actually understood enough of the runtime to make it work
[15:02:11] <sanxiyn> bjz_: link?
[15:03:34] <bjz_> sanxiyn: https://github.com/mozilla/rust/pull/9967
[15:03:42] <bjz_> :)
[15:04:44] <sanxiyn> Ah
[15:04:48] <kimundi> ANd https://github.com/mozilla/rust/pull/10182, which is a follow up of acrichto 
[15:05:42] <kimundi> (type_id was a missing implementation detail that made the original fail and Any PR more complicated than necessary)
[15:06:45] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[15:08:18] <cmr> Is type_id unique per structural and nominal type per crate? (ie, does it take crate name/link-meta into account?)
[15:09:14] <kimundi> No idea
[15:09:27] <kimundi> It's a has, so I guess in theory there could be collisions
[15:09:31] <kimundi> hash*
[15:09:54] <ChrisMorgan> Oh good, my code is working. Now I can go to bed with a clear conscience... except that I know I should have gone to bed earlier :P
[15:10:07] <kimundi> The important thing about it is that is produces the same hash for the same type even if used cross crate
[15:10:36] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[15:14:12] *** Quits: darkowlzz (sunny@CA2E2FA6.C1ACE797.25B273F5.IP) (Quit: This computer has gone to sleep)
[15:15:56] <cmr> yeah
[15:17:18] *** Joins: tikue (tikue_star@79A63A31.D038900B.689607DE.IP)
[15:18:07] <ChrisMorgan> Luqman: are you intending to make regular ARM builds until upstream does them, or should I see about setting up a wheezy VM in which I can make them?
[15:18:47] *** jorendorff is now known as jorendorff_away
[15:19:30] *** Quits: moostik (Icedove@moz-3131F39.w81-249.abo.wanadoo.fr) (Ping timeout)
[15:21:28] <yuriks_> hmmm. Why would using `gl::types::GLuint` work, but `use gl::types::*;` "fails to resolve import"?
[15:21:57] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[15:22:21] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[15:22:38] <cmr> yuriks_: good question!
[15:23:39] <yuriks_> well, `use gl::types::GLuint;` doesn't work either
[15:23:49] <yuriks_> seems like I can't import anything from a nested module
[15:23:56] <yuriks_> er, can't use*
[15:24:09] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[15:24:16] <cmr> Hmm, I wonder if you can't import typedefs?
[15:25:11] <cmr> rusti: mod foo { type Foo = int; } use self::foo::Foo;
[15:25:12] -rusti- <anon>:9:37: 9:56 error: `use` and `extern mod` declarations must precede items
[15:25:12] <yuriks_> bjz_'s examples use that syntax seemingly without issue
[15:25:12] -rusti- <anon>:9          mod foo { type Foo = int; } use self::foo::Foo;
[15:25:12] -rusti-                                               ^~~~~~~~~~~~~~~~~~~
[15:25:12] -rusti- error: aborting due to previous error
[15:25:12] -rusti- application terminated with error code 101
[15:25:17] <cmr> ...oh right
[15:25:49] <yuriks_> rusti: use self::foo::Foo; mod foo { type Foo = int; }
[15:25:51] -rusti- pastebinned 8 lines of output: http://sprunge.us/eHcK
[15:25:53] <tikue> whoa rusti works?!
[15:25:57] <tikue> rusti: 1
[15:25:58] -rusti- 1
[15:26:00] <cmr> rusti: version
[15:26:01] -rusti- "rustc 0.8"
[15:26:06] <zokier`> yuriks_, do you have globs enabled?
[15:26:06] <tikue> ah
[15:26:18] <yuriks_> zokier`: I do, but it doesn't work even if I don't use a glob
[15:27:34] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[15:27:44] <zokier`> thats curious, use gl::types::*; works for me
[15:29:29] <yuriks_> *shrug* maybe I should try updating
[15:29:45] <cmr> yuriks_: what's your exact code and the error?
[15:32:22] <yuriks_> huh, I made a testcase and it works
[15:32:26] <yuriks_> lemme investigate
[15:33:58] <yuriks_> ah, it only works if it's in the crate root
[15:34:08] <yuriks_> (or whatever the source file you pass to rustc is called)
[15:34:15] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[15:35:10] *** Quits: tudor (tudor@moz-233C4930.hsd1.ca.comcast.net) (Quit: Leaving)
[15:35:44] <yuriks_> cmr: http://hastebin.com/kubibirime.sm
[15:36:11] <yuriks_> er, ignore the first part of the output, I started copying at the wrong place
[15:36:57] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[15:37:08] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Client exited)
[15:37:22] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[15:38:16] <kimundi> yuriks_: Ah, I know the problem
[15:38:31] <kimundi> yuriks_: the paths in a use statement are always relative to the crate root
[15:38:52] <kimundi> yuriks_: And your "extern mod gl" is not in the crate root
[15:39:15] <kimundi> yuriks_: use test2::gl::types::GLuint; would work
[15:39:31] <kimundi> yuriks_: as would use self::gl::types::GLuint;
[15:39:33] <yuriks_> indeed, use self::gl::type::GLuint; works
[15:39:35] <yuriks_> thanks
[15:39:42] <yuriks_> that's pretty non intuitive though
[15:40:08] <kimundi> Maybe, but the rules are quite consistent about that
[15:40:26] *** Quits: Kxepal (Miranda@moz-AE08CD94.pppoe.mtu-net.ru) (Ping timeout)
[15:42:06] <yuriks_> hm, yeah, if I move the extern mod to the crate root it works like that
[15:42:12] <yuriks_> that's quite, eh...
[15:42:48] <kimundi> The confusing part is thinking that stuff should work differently just because you've split up the code across idfferent files. :)
[15:43:20] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[15:43:42] *** Joins: Kxepal (Miranda@moz-D344CF66.pppoe.mtu-net.ru)
[15:43:46] <yuriks_> this weird file/module duality just smells bad as an outsider
[15:43:59] <yuriks_> everything about modules so far hasn't been intuitive at all
[15:44:11] <kimundi> The rules as currently implemented don't care about files at all, you can rewrite every crate in one big main.rs file with only changing mod foo; to mod foo { /* content of foo */ }
[15:45:14] <kimundi> You're just simply allowed to move the body of a module into its own file for convenience of working with it
[15:45:15] <Leo`> mhhh... i've got a problem with lifetimes and iterators
[15:45:49] <Leo`> I had a method<'a>(&'a self) -> HashMapIterator<'a, K, V>
[15:46:05] <Leo`> to allow to iter on an hashmap contained in the array
[15:46:09] <Leo`> huh
[15:46:11] <Leo`> in the object*
[15:46:31] <Leo`> this method is in a trait and I want to implement it for objects that use another container than a HashMap
[15:46:39] <kimundi> yuriks_: What du you think is weird in general?
[15:46:53] <Leo`> so I want to replace it with a simple iterator
[15:46:54] <kimundi> do*
[15:47:08] <yuriks_> kimundi: that use is absolute while everything else you view as relative
[15:47:21] <Leo`> I tried to return an Iterator<(&'a K, &'a V)> but I didn't managed to get it work
[15:47:45] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[15:47:56] <yuriks_> kimundi: that makes more sense if you're viewing a file as a whole, but seeing them individually as self contained modules...
[15:48:03] <yuriks_> viewing the files as a whole*
[15:48:13] *** Joins: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com)
[15:49:38] <yuriks_> one could get into the habit of using self:: always, but I'd change it so the self is implied and you use ::foo if you want an absolute path
[15:49:49] <yuriks_> from my current viewpoint as a newbie, that is :)
[15:50:14] <yuriks_> because that's how resolving all other names works
[15:52:04] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[15:52:08] *** Parts: sanxiyn (tinuviel@5DAC0FAD.5592B676.8A051A1C.IP) (Leaving)
[15:52:59] <kimundi> yuriks_: I agree that its confusing that use paths are absolute, while paths in other contexts are relative, but it makes sense in a way: use statements are absolute because they need to directly specify the item to bring in scope, and all other paths are relative because they are relative to what 'use' has brought in scope
[15:53:43] <kimundi> yuriks_: But enough people keep complaining about it that changing use to require :: for absolute paths might maybe happen
[15:54:22] <kimundi> yuriks_: The problem is, that usually you _want_ absolute paths in use statements, so most use statements would start with an ::
[15:55:53] <yuriks_> kimundi: still seems like that would be the most obvious and consistent way with the rest of the rules, even if you'd always start out typing :: in the majority of cases
[15:56:03] <yuriks_> but I'll revisit this when I'm more experienced
[15:56:21] <yuriks_> I'm kind of dumping my first impressions on the language here :)
[15:57:54] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[16:01:54] <jeffcutsinger> It seems like most languages behave similarly to rust in this regard.
[16:02:53] <jeffcutsinger> Except they tend to have a weird hybrid resolution where paths can be relative or absolute outside of imports.
[16:04:41] *** jorendorff_away is now known as jorendorff
[16:06:26] <eddyb> hmm, for some reason I thought Rust didn't have heap closures
[16:06:49] <eddyb> rusti: ~|| {0}
[16:06:50] -rusti- ~fn() -> int
[16:07:11] <eddyb> rusti: fn foo() -> ~fn() -> int {~|| {0}}
[16:07:11] -rusti- <anon>:9:35: 9:42 error: mismatched types: expected `~fn:Send() -> int` but found `~&fn<no-bounds>() -> <VI0>` (expected fn but found ~-ptr)
[16:07:11] -rusti- <anon>:9          fn foo() -> ~fn() -> int {~|| {0}}
[16:07:11] -rusti-                                             ^~~~~~~
[16:07:12] -rusti- error: aborting due to previous error
[16:07:12] -rusti- application terminated with error code 101
[16:07:32] <eddyb> hmmpf
[16:08:05] <kimundi> eddyb: It has them, but a) What you wrote there is actually a &fn boxed in a ~ and b) It's going to get an own name 'proc'
[16:08:23] <eddyb> proc is already in
[16:08:33] <kimundi> rusti: let f: ~fn() = || println("foo"); f();
[16:08:33] -rusti- foo
[16:08:34] -rusti- ()
[16:08:49] <kimundi> eddyb: Right, it is
[16:08:51] <eddyb> rusti: let f: ~fn() = || println("foo"); f(); f();
[16:08:52] -rusti- foo
[16:08:52] -rusti- foo
[16:08:52] -rusti- ()
[16:09:09] <eddyb> but AFAIK, proc's are "once fn"s now
[16:09:32] <kimundi> Yeah, proc is an alias for ~once fn
[16:09:40] *** Quits: tikue (tikue_star@79A63A31.D038900B.689607DE.IP) (Ping timeout)
[16:09:44] <eddyb> the once means that they can only be called once?
[16:09:48] <kimundi> yes
[16:10:11] <eddyb> because sharing mutable state is complicated?
[16:10:32] <SiegeLord> Will ~fn's remain?
[16:10:41] <kimundi> It's not really about shraing, more about moving in and out
[16:10:46] <kimundi> SiegeLord: No
[16:11:19] <SiegeLord> So it's C++03 functors for now then?
[16:11:41] <eddyb> kimundi: and there would have to be some sort of analysis proving that the closure is reentrant?
[16:11:54] <eddyb> i.e. it doesn't invalidate its own state
[16:12:03] <kimundi> I'd still rant about stack closures and proc becoming to restrictive right now If I didn't know that the long term plan is to have C++ - like closures, with stack closures and proc just being special sugar for common use cases
[16:12:34] <kimundi> eddyb: What do you mean?
[16:12:39] <SiegeLord> Do you have that in writing somewhere? :P
[16:13:23] <eddyb> kimundi: I mean, from what you're saying, the problems seem to be missing analysis support
[16:13:26] <kimundi> SiegeLord: Don'T know sources, but it's somewhere in the mailing list and/or the irc logs
[16:13:50] <kimundi> eddyb: It's not really a problem, more bad useability
[16:14:34] <kimundi> eddyb: once fn work today, they just never got properly activated because it was feared that they make closures even more complex to use
[16:15:37] <kimundi> once closures can be kinda seen as a `trait OnceFn { fn call(~self, args...) -> ... }`
[16:16:05] <kimundi> That is, you call it, it's gone
[16:16:29] <tautologico> how do I get the integer part of a floating-point number?
[16:16:40] <eddyb> AFAIK, C++11 allows shared mutable state on heap, as its most esoteric mode, the other ones being unique state (capture-by-val) and reusing state (capture-by-ref, it should restrict to stack closures, can't escape the function they're created in)
[16:16:47] <eddyb> although I may be using some words wrong :P
[16:18:10] <eddyb> kimundi: you mean ..args: Args
[16:18:45] <kimundi> eddyb: Yeah, it's bogus syntax either way :P
[16:18:56] <eddyb> the latter is proposed syntax
[16:19:39] <kimundi> I don't know about the details about that proposals, sorry :)
[16:20:08] <kimundi> tautologico: Look somewhere into std::num, the trunc method might be what you want
[16:21:09] <eddyb> I think the first-class functions I'm so used to in JS move their parent function onto the heap
[16:21:46] <eddyb> so you have multiple heap closures with *overlapping* shared mutable state
[16:22:15] <eddyb> (imagine capture-by-ref and escaping the stack scope)
[16:22:32] <kimundi> yeah
[16:22:37] *** Joins: mib_lhhfq7 (Mibbit@7FD95B38.A4106CB1.A90E5E10.IP)
[16:22:49] <eddyb> I would be impressed to see this done efficiently and cleanly in Rust
[16:23:02] <mib_lhhfq7> https://mega.co.nz/#!b1J2mJyb!GwiIgnfzbwyCbpaCGVPGOmJi5Wk5keebxJVzfwjuJWs
[16:23:20] <eddyb> that link and nick smells of spam. didn't click it, though
[16:23:24] <kimundi> Well, it smeels like garbage collection, which is neither efficient nor done in rust right now ;)
[16:23:37] *** jorendorff is now known as jorendorff_away
[16:23:37] <bjz_> tautologico: http://static.rust-lang.org/doc/master/std/num/trait.Round.html#tymethod.trunc
[16:23:40] *** Quits: mib_lhhfq7 (Mibbit@7FD95B38.A4106CB1.A90E5E10.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:24:02] <eddyb> kimundi: thankfully, you can do a lot of things in Rust without requiring such language features
[16:24:32] <eddyb> kimundi: ooooh, damn, the cyclic ownership?
[16:25:45] *** Quits: MX80 (MX80@moz-5BB6C0C8.dsl.g3telecom.net) (Ping timeout)
[16:26:15] <eddyb> I was afraid of the part where you end up having a regular function use the heap for its state, but keeping track of the states is nastier - pretty sure not even StrongRc/WeakRc would work here
[16:28:26] <kimundi> eddyb: To be honest I'm not entirely sure about what you're talking and whether gc would really be necessary. Languages like js just simply use gc, so patterns might not be directly transferable to rust.
[16:30:15] <eddyb> function foo() {var a = 1, b = function bar() {return ++a;}; b(); a += 10; return b;} console.log(foo()() + foo()());
[16:31:19] <eddyb> kimundi: each time you call the function foo, it creates a new state on the heap, to hold (at least) `a` in this case
[16:32:44] *** Joins: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net)
[16:33:24] *** Quits: nomadic (nomadic@moz-E01D5C49.hsd1.ga.comcast.net) (Ping timeout)
[16:34:43] <eddyb> hmm, well, if you determine the overlapping regions of the state, and those are placed in separate Rc boxes, owned by all the functions which have access to them, that might work
[16:34:49] <kimundi> yeah. That can be done today with ~fn() by capturing a in a @mut
[16:35:13] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[16:35:14] <kimundi> capturing it in a RcMut would also work
[16:35:25] <tautologico> bjz_: thanks, I had found the trait
[16:35:39] <eddyb> kimundi: now imagine that being done automatically, where necessary
[16:36:02] <tautologico> is the Num trait working now? last time I looked (around 0.6 I guess) it wasn't :)
[16:36:57] *** Quits: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com) (Quit: Leaving)
[16:36:57] <eddyb> brb, I suspect my IRC client has too much visible backlog
[16:37:05] <kimundi>  /* This ought to work: */ let a = RcMut::new(1); let f: ~fn() -> int = || *a.mut_borrow() += 1; f(); *a.mut_borrow() += 10; return f
[16:37:25] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[16:37:33] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Quit: Konversation terminated!)
[16:37:40] *** Quits: askalski (akuda@309E5B07.C38989A9.A61CD463.IP) (Input/output error)
[16:37:43] <bjz_> tautologico: it is
[16:38:33] *** Quits: Purrr (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se) (Ping timeout)
[16:38:46] <tautologico> great
[16:39:11] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[16:40:05] <kimundi> eddyb: Part of the reason we're splitting &fn(..A) -> R and ~fn(..A) -> R into the seperate types |..A| -> R and proc(..A) -> R is that they already did to much different magic behind the scenes
[16:40:20] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[16:41:08] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[16:42:22] *** Joins: lenstr_ (lenstr@AF8EB999.6049B16A.85938D85.IP)
[16:42:51] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[16:43:51] *** Joins: beifeng (Mibbit@9F13621D.7852592E.601BAF88.IP)
[16:45:24] * canhtak Hi rust devs, rustic exit with this error msg : task 'rustc' has overflowed its stack
[16:45:24] * canhtak Illegal instruction: 4
[16:45:44] <canhtak> this need a github issue no?
[16:47:44] *** Quits: jesse99 (jesse99@moz-8B1E0C5D.hsd1.wa.comcast.net) (Ping timeout)
[16:48:20] <kimundi> canhtak: Probably yeah
[16:48:32] <kimundi> canhtak: Using 0.8 or git master?
[16:48:39] <canhtak> last master 
[16:49:08] <kimundi> Okay, then anything with illigal instruction in it should be reported :P
[16:49:22] *** Joins: mojibake (Mibbit@moz-44CDC418.slkc.qwest.net)
[16:49:23] *** Joins: tikue (tikue_star@79A63A31.D038900B.689607DE.IP)
[16:49:27] *** Joins: Purrr (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se)
[16:49:47] <canhtak> okay thanks
[16:53:31] *** Joins: lkuper (lkuper@moz-26EF2B6B.hsd1.in.comcast.net)
[16:56:44] *** Joins: fabiand (fabiand@moz-B47B573E.adsl.alicedsl.de)
[17:04:04] *** Joins: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net)
[17:05:40] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[17:06:05] *** Joins: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP)
[17:06:12] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[17:07:07] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[17:07:13] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[17:07:22] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Quit: leaving)
[17:07:30] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[17:09:13] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[17:09:14] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[17:11:04] *** Quits: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net) (Quit: Leaving.)
[17:13:45] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[17:17:38] *** Quits: lenstr_ (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[17:18:00] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:18:09] *** Quits: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP) (Ping timeout)
[17:18:19] *** Joins: vodik (simon@moz-B36FF73D.dsl.bell.ca)
[17:19:46] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[17:22:05] *** Quits: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP) (Quit: Lost terminal)
[17:23:30] *** Joins: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com)
[17:26:38] *** Quits: bjz_ (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[17:27:31] *** Joins: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP)
[17:28:25] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:33:49] *** Quits: jeffcutsinger (jeff@moz-7E34AC5D.dhcp.roch.mn.charter.com) (Quit: Bye)
[17:34:04] *** Quits: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP) (Quit: Leaving)
[17:34:13] *** Joins: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP)
[17:34:55] *** Quits: Purrr (Darkstar@moz-3FB542EB.a176.priv.bahnhof.se) (Quit: leaving)
[17:36:19] *** Joins: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net)
[17:36:39] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[17:47:50] *** Quits: beifeng (Mibbit@9F13621D.7852592E.601BAF88.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:50:26] *** Joins: MISH (Mibbit@9F343AE3.F836AB6E.ECA3D134.IP)
[17:51:30] *** Joins: bynaryshef (bynaryshef@moz-C77BDF9B.mem.bellsouth.net)
[17:53:42] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[17:54:56] *** Quits: MISH (Mibbit@9F343AE3.F836AB6E.ECA3D134.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:55:38] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:55:41] *** Quits: vodik (simon@moz-B36FF73D.dsl.bell.ca) (Quit: work)
[17:58:35] *** Joins: h0rrorvacui (h0rrorvacu@moz-5B34B08.sip.bhm.bellsouth.net)
[17:59:21] *** Quits: mojibake (Mibbit@moz-44CDC418.slkc.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[18:02:27] *** Joins: mib_yui2ud (Mibbit@9F13621D.7852592E.601BAF88.IP)
[18:02:47] *** Quits: mib_yui2ud (Mibbit@9F13621D.7852592E.601BAF88.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:05:11] *** Joins: jeffcutsinger (jeff@moz-7E34AC5D.dhcp.roch.mn.charter.com)
[18:08:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[18:10:16] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[18:17:47] *** Joins: tav (tav@moz-40D7C5F6.range109-154.btcentralplus.com)
[18:21:08] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[18:25:56] *** Quits: lkuper (lkuper@moz-26EF2B6B.hsd1.in.comcast.net) (Quit: lkuper)
[18:26:23] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Connection reset by peer)
[18:26:34] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[18:30:30] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:31:46] *** Joins: mikezaby (mikezaby@moz-145CF3DD.home.otenet.gr)
[18:31:59] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[18:37:34] *** Joins: lkuper (lkuper@moz-54129201.dhcp-bl.indiana.edu)
[18:39:50] *** Quits: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com) (Quit: ozten)
[18:42:38] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:42:57] *** Quits: lkuper (lkuper@moz-54129201.dhcp-bl.indiana.edu) (Ping timeout)
[18:43:57] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[18:45:03] *** Joins: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[18:47:19] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[18:47:40] *** Joins: lkuper (lkuper@moz-54129201.dhcp-bl.indiana.edu)
[18:47:45] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Quit: victorporof)
[18:51:40] *** Quits: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP) (Ping timeout)
[18:53:18] *** Quits: pseudoku (quassel@EB16CC4B.9192D293.520CDC98.IP) (Client exited)
[18:58:49] *** Joins: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP)
[19:01:10] *** Quits: lkuper (lkuper@moz-54129201.dhcp-bl.indiana.edu) (Ping timeout)
[19:04:05] *** Joins: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net)
[19:06:46] *** Quits: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP) (Ping timeout)
[19:09:47] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[19:11:32] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[19:11:40] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[19:12:07] *** Joins: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP)
[19:13:59] *** Quits: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP) (Ping timeout)
[19:14:40] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[19:15:16] *** Quits: bynaryshef (bynaryshef@moz-C77BDF9B.mem.bellsouth.net) (Quit: Leaving)
[19:16:11] *** Quits: mikezaby (mikezaby@moz-145CF3DD.home.otenet.gr) (Input/output error)
[19:16:57] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[19:17:14] *** Joins: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP)
[19:19:05] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[19:21:50] *** Quits: jakedust (Jake@moz-81D946E.dsl.telesp.net.br) (Quit: jakedust)
[19:22:07] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[19:22:11] *** Joins: lkuper_ (lkuper@83D98432.14CD977C.51B6877.IP)
[19:23:43] <mark_edward_> cmr: dbaupp: hey guys just wanted to let you know that I fixed that problem i was having earlier! Thansk for all your debugging solutions and stuff!
[19:24:55] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: 랜덤은 쇠퇴했습니다.)
[19:25:27] *** Quits: jvshahid (jvshahid@DFBC979C.A3446CDA.EB438161.IP) (Ping timeout)
[19:25:46] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[19:25:49] *** Joins: jakedust (Jake@moz-81D946E.dsl.telesp.net.br)
[19:28:14] *** Quits: jakedust (Jake@moz-81D946E.dsl.telesp.net.br) (Quit: jakedust)
[19:29:27] *** Joins: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP)
[19:30:51] *** Joins: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net)
[19:30:57] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[19:30:59] <Havvy> I haven't seen any Rust posts on Planet Mozilla recently.
[19:31:02] *** Quits: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net) (Quit: kellogh)
[19:31:05] <Havvy> Where'd they go?
[19:33:32] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Ping timeout)
[19:34:18] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[19:34:40] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[19:36:26] *** Joins: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr)
[19:37:16] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[19:38:07] <cmr> mark_edward_: what ended up being the problem?
[19:38:32] <cmr> Havvy: there's some stuff on there? Most recent beign intermingled param lists.
[19:38:40] <mark_edward_> error reading from a rawptr that somehow wasn't picked up by valgrind
[19:38:50] <cmr> Havvy: in any case I write TWiR on http://cmr.github.io, weekly updates.
[19:39:31] <Havvy> cmr, Ah, nice.
[19:40:00] <cmr> Havvy: do you know how that could be added to planet?
[19:40:44] <Havvy> Umm, you'd have to talk to Planet Mozilla'a management.
[19:41:09] <Havvy> I'm just a reader.
[19:41:18] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[19:42:27] <cmr> ok, thanks
[19:43:51] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (No route to host)
[19:44:12] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[19:48:32] <mark_edward_> cmr: do you have any idea how i'd get access to a rotl intrinsic? do i have to use the inline asm thing? if so, how do i use said thing?
[19:49:33] *** Parts: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net) (Leaving)
[19:52:40] *** Joins: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com)
[19:53:31] <cmr> mark_edward_: no idea.
[19:53:44] <cmr> mark_edward_: you need #[feature(asm)] on the crate, and asm!()
[19:53:53] <cmr> How asm!() is supposed to work, I do not know.
[19:54:11] <mark_edward_> ok. rummaging trough rust/src/test/ seems to give me some hints! i look forward to my segfaults
[19:54:17] <cmr> heh :)
[19:54:19] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[19:57:53] *** Joins: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net)
[19:59:57] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[20:01:26] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[20:05:44] *** Quits: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net) (Quit: kellogh)
[20:08:56] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Quit: leaving)
[20:09:12] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[20:09:35] <Leo`> is there some LinkedList or something like this in the stdlib ?
[20:09:48] <Leo`> or at least anything with removal in O(1)
[20:10:04] <kimundi> ~[T] is removal O(1)
[20:10:24] <kimundi> Ah, unless you mean random index removal
[20:10:27] <kimundi> sorry
[20:10:41] <Luqman> mark_edward_: this works i think https://gist.github.com/luqmana/7389412
[20:10:54] *** Quits: jdavis (jdavis@moz-1BE8A6A1.hsd1.ca.comcast.net) (Quit: Leaving)
[20:11:05] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[20:11:57] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[20:12:10] <mark_edward_> Luqman: thank you very much!
[20:12:24] <Leo`> kimundi: yup, random index removal
[20:12:51] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[20:14:37] *** Quits: lkuper_ (lkuper@83D98432.14CD977C.51B6877.IP) (Quit: lkuper_)
[20:15:18] *** Quits: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com) (Quit: ozten)
[20:15:29] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[20:17:56] *** Joins: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com)
[20:18:26] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[20:18:59] <cmr> Leo`: HashSet? :P
[20:21:08] *** Quits: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP) (Ping timeout)
[20:22:21] *** Quits: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com) (Quit: ozten)
[20:23:06] <jeffcutsinger> Can the rust compiler be built out-of-tree?
[20:24:23] <Luqman> yes
[20:24:34] *** Quits: yuriks_ (yuriks@CE6EF1E.88B480FC.748B6D8D.IP) (Connection reset by peer)
[20:24:46] *** Joins: yuriks (yuriks@8D43DD53.27DE6E3D.10054EA3.IP)
[20:24:52] <jeffcutsinger> Nice. I should probably be doing that.
[20:27:31] <mark_edward_> I'm having a weird problem with the benchmarking harness. it's giving me two very different numbers seemingly randomly
[20:28:43] <Leo`> cmr: I don't know if it exactly suits for what I need
[20:28:59] <Leo`> but I'm implementing my own minked list. it should do the job :p
[20:29:02] <Leo`> linked*
[20:29:31] <jeffcutsinger> It'd be more exciting if it were a minked list.
[20:30:14] <eddyb> mark_edward_: sorry I wasn't around... what do you need rotl for? the two shifts and a bitwise OR should be picked up by LLVM
[20:30:54] <mark_edward_> eddyb: they're not even with --opt-level=3 i get a big performance boost with asm!() (use a lot of rol)
[20:32:31] <eddyb> o_O
[20:32:45] <eddyb> mark_edward_: that's a serious LLVM bug. can you post a small test-case?
[20:32:53] <Leo`> a minked list yeah. 
[20:33:02] <Leo`> what's the problem with minked list actually ? :|
[20:33:07] <Leo`> +s
[20:33:21] <eddyb> (serious in the limits of optimizing bit rotations)
[20:34:35] <mark_edward_> eddyb: it's much more likely I have a bug rather than LLVM. let me check my logic first
[20:34:44] <eddyb> mark_edward_: or maybe your code wasn't using idiomatic rotations-using-shifts. I need to see it to give a better guess, though
[20:34:57] <eddyb> yeah, sure, but I'm a sucker for drama :P
[20:35:46] *** Quits: fabiand (fabiand@moz-B47B573E.adsl.alicedsl.de) (Quit: Verlassend)
[20:37:16] <bjz> dbaupp: https://github.com/mozilla/rust/issues/10387
[20:37:29] <mark_edward_> eddyb: yup, there was something else going on, i had two different rotl macros, one was use std::mem::size_of. 
[20:38:41] <mark_edward_> but i always use 32bit rotate, so the version with a fixed 32 in it was getting that optimization, but that one wasnt
[20:39:01] <mark_edward_> is anyone here familiar with the benchmark suite?
[20:40:13] <mark_edward_> because it gives me two different numbers seemingly at random. and xxhash's speed shouldn't vary based on input
[20:41:26] *** Joins: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com)
[20:41:34] <eddyb> mark_edward_: hmm, sounds like size_of isn't getting inlined properly. maybe it needs the full CTFE miracle we've been waiting for :P
[20:44:16] *** Joins: jstevans (Instantbir@4126081.FA95BF59.B7830B68.IP)
[20:46:08] <jstevans> Would it be possible to build a kernel with Rust, a la http://www.jamesmolloy.co.uk/tutorial_html/index.html ?
[20:46:28] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[20:46:44] <mark_edward_> running the benchmarking with RUST_LOG=extra::test=4 is showing me tthat it does one of two different numbers of iterations, and for on if them my performanc eis twice as good. 
[20:47:02] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[20:47:08] <mark_edward_> anyone have any ideas?
[20:48:47] * bjz feels slightly crazy in suggesting we scrap most of the numeric heirachy that he worked so hard on
[20:49:30] <cmr> bjz: eh
[20:49:35] <eddyb> jstevans: heh, the great JamesM
[20:49:36] <bjz> :P
[20:49:36] <cmr> bjz: moving on is good :)
[20:49:59] * bjz - killer of babies
[20:50:07] <cmr> mark_edward_: weird
[20:50:10] <bjz> :P
[20:50:18] <bjz> cmr: https://github.com/mozilla/rust/issues/10387
[20:50:19] <cmr> mark_edward_: the benchmarking harness tries very hard to get a stable signal.
[20:50:21] <eddyb> jstevans: he worked on his own language, which was interesting - I'm now curious if his micro-parallelization could be applied to Rust in any way
[20:50:33] <eddyb> jstevans: for your own question, see #rust-osdev
[20:50:35] *** Quits: glinscott (garylinsco@789A6618.53EB7C1.FFFE3AA.IP) (Quit: glinscott)
[20:50:36] <jstevans> eddyb: Microparallellization?
[20:50:49] <Sharp> Is microparallelization like, SIMD?
[20:51:07] *** Joins: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP)
[20:51:20] <eddyb> I'm not sure how close Rust tasks are to that, they might as well be the same thing
[20:51:39] <mark_edward_> cmr: i make a single ~[u8] in the #[bench] function, and then hash it repeatedly. do you think that may be the problem?
[20:52:01] <cmr> mark_edward_: yes, don't do that.
[20:52:15] <mark_edward_> cmr: what should i do?
[20:52:19] <cmr> mark_edward_: hash it once. the harnesss will take care of the rest.
[20:52:31] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[20:52:41] <cmr> (ie in the do bh.iter { ... }
[20:53:01] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[20:53:12] <eddyb> why did I not do this before? http://quokforge.org/projects/horizon/wiki -> http://www.jamesmolloy.co.uk/rubbish-bin/project.pdf
[20:53:37] <eddyb> now you can all enjoy some nice paper reading :P
[20:53:58] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[20:54:04] <mark_edward_> cmr: oh i think i've confused you. the code is a bit clearer than I am: https://github.com/MarkJr94/lz4-rs/blob/master/xxhash/mod.rs#L93-L106 is that bench function okay?
[20:55:16] <cmr> mark_edward_: oh, yes.
[20:56:26] <mark_edward_> cmr: oh that's good then. do you have any idea as to why I get 2 very different numbers? The xxhash page does say that it is fast enough to be limited by memory speed
[20:56:28] <eddyb> he came up with a high-level assembly on top of LLVM, and a weird C-like language on top of that
[20:56:48] <mark_edward_> cmr: do you think that might be why im getting 2 distinct results
[20:56:52] <cmr> mark_edward_: no idea, seems weird.
[20:58:40] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[20:59:40] <cmr> and yes, I haven't slept much in the past 48 hours, so confusion is extremely likely.
[20:59:42] *** Quits: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr) (Ping timeout)
[21:00:32] *** Quits: Ms2ger (Ms2ger@moz-EA6EE9F3.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:01:05] *** Joins: dherman (dherman@49869947.3778D849.1D6E592A.IP)
[21:01:05] *** ChanServ sets mode: +ao dherman dherman
[21:04:26] *** Joins: leon (leon@moz-B0ACAD17.superkabel.de)
[21:04:54] *** Joins: berleon (leon@moz-B0ACAD17.superkabel.de)
[21:06:29] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[21:06:43] <redbrain> i have a #[link_args = "-lreadline"]
[21:06:44] <redbrain> extern { fn readline (p: std::c_str::CString) -> std::c_str::CString;
[21:06:55] <redbrain> and calling it i get CString returned
[21:07:03] <redbrain> how do i bring this back to a rust string like ~str
[21:07:04] *** Joins: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr)
[21:07:34] *** Joins: Kingsley (kingsley@BBD66DE2.61F456DA.3655BBF5.IP)
[21:07:41] <Luqman> redbrain: you don't want to put a CString there
[21:07:49] <Luqman> you can *std::libc::c_char
[21:07:53] <Luqman> you want*
[21:07:58] <redbrain> ah ok
[21:08:13] <redbrain> do i need the *
[21:08:17] <Luqman> and then you can use CString with that buffer
[21:08:20] <Luqman> yes
[21:09:49] <redbrain> how do i convert a rust ~str to the libc::c_char and then backagain for the return
[21:10:59] <Luqman> you can try something like: do "a rust string".with_c_str |c| { // use c which is *c_char here }
[21:12:26] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[21:14:12] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[21:16:18] *** Quits: dherman (dherman@49869947.3778D849.1D6E592A.IP) (Quit: dherman)
[21:16:43] *** Quits: yuriks (yuriks@8D43DD53.27DE6E3D.10054EA3.IP) (Ping timeout)
[21:16:58] <mark_edward_> does rust have any locks/mutexes?
[21:17:56] <mark_edward_> and condition variables
[21:18:20] *** Joins: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net)
[21:19:07] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[21:20:02] *** Quits: redbrain (redbrain@moz-A78C4B0A.vm.bytemark.co.uk) (Ping timeout)
[21:22:08] *** Quits: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net) (Quit: kellogh)
[21:23:01] <cmr> mark_edward_: std::unstable::sync
[21:24:21] <mark_edward_> ah thanks
[21:24:26] *** Joins: yuriks (yuriks@7B62483E.B0933AA2.748B6D8D.IP)
[21:27:56] *** Joins: kellogh (timkellogg@moz-D1AA8436.hfc.comcastbusiness.net)
[21:29:36] *** Quits: jstevans (Instantbir@4126081.FA95BF59.B7830B68.IP) (Ping timeout)
[21:31:08] *** Quits: icarot (yaaic@moz-F791C96D.hsd1.ca.comcast.net) (No route to host)
[21:31:11] <Sharp> rusti: version
[21:31:12] -rusti- "rustc 0.8"
[21:31:21] <Sharp> I don't know why I keep hoping that will change :(
[21:31:47] <Leo`> merf I don't have much success for my Linked Lists implementation :|
[21:33:50] *** Quits: nlminhtl (ignotus@moz-BA3DE7EF.volia.net) (Connection reset by peer)
[21:33:57] *** Joins: nlminhtl (ignotus@moz-BA3DE7EF.volia.net)
[21:35:00] <kimundi> Leo`: What's the problem?
[21:35:05] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[21:35:36] <Leo`> kimundi: it's easy to construct a new list and returnign it, but i'd like something "in place"
[21:35:47] <cmr> Leo`: Oh! extra::DList
[21:35:50] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[21:36:22] <kimundi> Leo`: A mutable single list shouldn't be hard to do
[21:36:39] <Leo`> maybe but too much for me apparently :D
[21:36:56] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[21:36:57] <dcrewi> cmr: but it can be a good learning experience to implement it yourself
[21:37:08] <cmr> enum LinkedList<T> { None, Next(~LinkedList<T>) }
[21:37:18] <cmr> dcrewi: sure, but his original question was if there was one in the stdlib
[21:37:25] <Leo`> yeah I did that already cmr 
[21:37:27] <cmr> s/Next/Node
[21:37:45] <cmr> Leo`: I suppose you're having trouble traversing it without consuming it?
[21:37:47] *** Joins: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP)
[21:37:52] *** Quits: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net) (Quit: Leaving.)
[21:38:05] <Leo`> no, i'm having trouble inserting and keeping a pointer to its head
[21:38:22] <Leo`> assuming i've got a head: ~LinkedList<T> 
[21:38:29] <Leo`> i can't do head = cons(head, T)
[21:38:50] *** Quits: tikue (tikue_star@79A63A31.D038900B.689607DE.IP) (Ping timeout)
[21:39:04] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[21:39:18] <kimundi> why not?
[21:39:43] <kimundi> Might need to seperate it out into two or more lines, but in principle it should work
[21:42:40] <Leo`> cause the list is stored in a struct, and the methods that operate on that struct take a &self
[21:42:53] <Leo`> and I can't move the list out of the &-ptr to the struct
[21:42:54] <kimundi> Well, that'S an unrelated issue
[21:43:07] <Leo`> .__.
[21:43:12] <kimundi> You can't mutate anything through an &self pointer in general
[21:43:22] <Leo`> &mut self, if you prefer
[21:43:57] <kimundi> that on the other hand would work
[21:44:39] <Leo`> but it doesn't :|
[21:45:04] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[21:45:25] <kimundi> What is the error exactly?
[21:45:36] <Leo`> cannot move out of dereference of & pointer
[21:45:43] <Leo`> which seems legit ...
[21:45:56] <mark_edward_> i can't read C code with gotos....
[21:47:18] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[21:47:41] <kimundi> Leo`: The trick is not to move out of the &mut, but to swap the value behind the &mut with something different
[21:48:17] <Leo`> yeah
[21:48:51] <kimundi> Leo`: Like, for insert, swap the old head cons with a Nil, create a new cons with the new value, append the old cons to it, swap the nil with the new head cons
[21:49:17] <Leo`> mhhh
[21:49:21] <Leo`> well this makes sense
[21:49:38] <Leo`> can I use swap for this ?
[21:49:42] <Leo`> swap() *
[21:49:48] <kimundi> util::swap, yeah
[21:50:15] <kimundi> thinking about it, I don't think it's possible without it actually
[21:51:26] <Leo`> oh...
[21:51:38] <Leo`> and how does swap works ? does it uses intrinsics or unsafe code at some point ?
[21:53:03] <berleon> I have a big and highly concurrent datastruture. Concrete a B-Tree with multiple writes at once. I let it act like it were immutable. Whenever I need mutability, I acquire a look one a node and then `cast::transmute_mut`. Now I want to share my "immutable" B-Tree with multiple threads. But Arc<T> requires T: Freeze and neither MutexArc nor Mutex fullfill Freeze. So how I am supposed to handle the locking within an Arc? Perfect would be a Mutex that
[21:53:04] <berleon>  fullfile Freeze. RWArc is not an option as I want multiple writes at once.
[21:53:20] <yuriks> really considering writing a high level GL wrapper
[21:53:20] *** Joins: redbrain (redbrain@moz-A78C4B0A.vm.bytemark.co.uk)
[21:53:25] <yuriks> this crappy C api is driving me nuts :P
[21:53:29] <redbrain> Luqman: thanks i got my code working now http://codepad.org/1hJvBog7
[21:53:30] <kimundi> Leo`: swap uses unsafe code internally, yeah
[21:53:58] *** Joins: mib_4agx4q (Mibbit@moz-11F915E.ga.at.cox.net)
[21:54:10] <mib_4agx4q> Will Rust support specialization eventually?
[21:54:22] <Leo`> kimundi: thx. it works now :)
[21:54:38] <Leo`> I should have thought of swap
[21:55:42] *** Quits: adu (ajr@61210CE3.1C3331CA.DA1C73DD.IP) (Quit: adu)
[21:57:30] *** Quits: tgummerer (tgummerer@moz-582025B2.members.linode.com) (Ping timeout)
[21:59:14] <cmr> mib_4agx4q: In what way do you mean specialization?
[21:59:38] <kellogh> Hi everyone! I'd like to introduce myself. My name is Tim, I normally work in higher level languages like C# and Scala but I've been playing around with Rust and I fell in love with the concept. Incidentally, I volunteered to speak at GlueCon in the spring on a topic titled "Programming an Arduino in Rust". I'll probably have questions from time to time, so I just wanted to introduce myself and say hi.
[22:00:37] <yuriks> kellogh: I'd like to point out a possible issue in that Rust doesn't target ATmel uCs yet O:)
[22:00:54] <kellogh> Arduino Due
[22:00:59] *** Quits: cdidd (cdidd@moz-E44E96DC.broadband.corbina.ru) (Ping timeout)
[22:01:07] <yuriks> oh, ok
[22:01:13] <kellogh> https://github.com/jensnockert/dueboot
[22:01:18] <kellogh> someone's already done it :)
[22:01:30] <yuriks> ah, wasn't aware of it
[22:01:39] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[22:01:52] <kellogh> yep, the Due runs a 32-bit ARM
[22:01:59] <bjz> yuriks: btw, we have #rust-gamedev
[22:02:10] <bjz> yuriks: better for discussing opengl and such
[22:02:13] <Leo`> I can't have a unsafe *ptr to a trait ?
[22:02:25] <kellogh> anyway, it's a really interesting project, quite a ways out of my normal work, so should be a lot of fun :)
[22:02:30] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[22:03:17] <kellogh> @Leo` Can't you just use Option[T] since it's basically just a ptr?
[22:03:26] *** Joins: cdidd (cdidd@moz-E8BEAB.broadband.corbina.ru)
[22:03:56] <kimundi> Leo`: No raw pointer trait objects
[22:04:11] <Leo`> well no I'm doing rather low level things and I need *ptrs
[22:04:12] <kimundi> also, no raw pointer slices for that matter
[22:04:23] <Leo`> mhhh
[22:05:55] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[22:06:22] <Leo`> kimundi: I can't still keep it as a *libc::c_void but will I be able to call a trait method on it by some way ?
[22:08:03] <yuriks> bjz: I'm in there xD
[22:08:05] <mark_edward_> is anyone here a really good with goto and macro filled  C-code? i'm trying to port lz4 to rust, and i just can't read the original code
[22:08:35] <kimundi> Leo`: Well, you can keep an unsafe pointer in addition to the actual safe rust object
[22:08:48] <Leo`> kimundi: mhhhhh
[22:09:13] <Leo`> I guess I can do that
[22:09:27] <Sharp> mark_edward: Re: macros, you could always expand them :P
[22:09:55] <Sharp> Not sure the result will be *more* readable, though.
[22:10:07] *** Quits: ozten (ozten@moz-BC0C74E2.range86-174.btcentralplus.com) (Quit: ozten)
[22:10:57] *** Joins: tgummerer (tgummerer@moz-582025B2.members.linode.com)
[22:11:03] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:11:24] <Leo`> kimundi: well in fact no I can't
[22:11:39] <kimundi> Leo`: Why not?
[22:11:43] <mark_edward_> Sharp: already tried
[22:11:52] <Leo`> well yes I can indeed
[22:12:05] *** Joins: glinscott (garylinsco@moz-403C5AA.hsd1.wa.comcast.net)
[22:12:08] <Sharp> mark_edward_: Heh.  The code is that bad?
[22:12:26] <Leo`> I thought I was going to need to call methods from a context where I only have the raw pointer
[22:12:31] <Leo`> but no, this is not the case
[22:12:40] <Sharp> Your best bet might be to find one of the original developers and ask them to explain :)
[22:12:44] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Quit: Leaving)
[22:12:46] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[22:12:50] <Sharp> Understanding what they were thinking can go a long way.
[22:12:56] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[22:13:05] <mark_edward_> Sharp: i don't think it's that bad.  i'm okay with C, it's just what once so many macros and gotos get involved, i just can't follow it
[22:13:16] <mark_edward_> Sharp: https://code.google.com/p/lz4/source/browse/trunk/lz4.c there it is if you want to browse
[22:13:53] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[22:14:46] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[22:14:54] <Sharp> The macros don't look too bad, the gotos though… :P
[22:15:26] <Sharp> Actually I guess they're just using them for a state machine (more or less).
[22:15:42] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:15:52] <erickt> good afternoon everyone. I'm running into some trouble with 'self lifetimes and `&mut self`. Does anyone know how to write this code without needing a mini state machine (that's the commented out impl)? https://gist.github.com/erickt/7390691
[22:16:08] <mark_edward_> maybe i just don't have enough EXP in my C skill tree
[22:16:55] <Sharp> Heh.
[22:17:13] <Leo`> kimundi: how do I take a raw ptr to the object in an owned bow ?
[22:17:15] <Leo`> box*
[22:17:19] <Sharp> It seems relatively easy to follow to me, at least compared to some of the Java I had to deal with yesterday.
[22:17:29] <Sharp> But then again, I'm not actually trying to *implement* it
[22:17:40] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[22:17:46] <erickt> mark_edward: that's pretty nasty. You could convert all those gotos into a state machine where you have an outer `'outer: loop { }` and replace the gotos with `continue 'outer`
[22:18:01] *** Joins: CarpNet (Alasdair@moz-25C796BC.cable.virginm.net)
[22:18:30] <mark_edward_> erickt: thanks, i'll see if i can do that
[22:18:37] <mark_edward_> i  forgot about the labeled loops
[22:18:50] *** Quits: Jackneill (Jackneill@moz-4AAEEC30.pool.digikabel.hu) (Input/output error)
[22:18:54] <Sharp> erickt: Did labeled loops end up not being equivalent to gotos?
[22:19:29] <erickt> you can't do a proper state machine, but you can at least use a `state` enum, and a match inside that loop
[22:19:37] <erickt> it's a bit obnoxious, but it works
[22:19:47] <mark_edward_> yeah
[22:19:58] <Sharp> For a really fast compression algorithm it might matter (though I don't know how the optimizer would deal with it).
[22:20:16] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[22:20:35] <erickt> Sharp: they aren't quite gotos, the control flow only flows in one direction, as opposed to gotos which can jump all over the place
[22:20:36] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:20:50] <Sharp> erickt: Ah, good point.
[22:21:15] <Leo`> wtf
[22:21:35] <Leo`> why the fuck can't I create a struct woth the ~Struct { f: val } syntax anymore ? oO
[22:21:56] <kimundi> Leo`: You should still be able to do that ...
[22:22:14] *** Joins: Chef_ (Chef@moz-4CCEC2AC.dsl.teksavvy.com)
[22:22:24] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[22:22:25] <Leo`> kimundi: yeah I know
[22:22:31] <Leo`> kimundi: let foo = ~Struct { ...
[22:22:35] <Leo`> this seems legit right ?
[22:22:43] <Leo`> error: expected `;` but found `{`
[22:23:02] <kimundi> Weird
[22:23:11] <erickt> Sharp: if I ever had free time (and the technical ability) I want to add "constrained gotos", where I extend match variants to also support a label, and allow you to `continue` between branches. As in `match state { 'a: State1 => continue 'b; 'b: State2 => { } }`
[22:23:22] <Sharp> That would be awesome.
[22:23:28] <kimundi> rusti: struct Foo { data_ bool}; let x = ~Foo{ data: true}; x
[22:23:28] -rusti- <anon>:9:28: 9:32 error: expected `:` but found `bool`
[22:23:28] -rusti- <anon>:9          struct Foo { data_ bool}; let x = ~Foo{ data: true}; x
[22:23:28] -rusti-                                      ^~~~
[22:23:28] -rusti- application terminated with error code 101
[22:23:36] <kimundi> rusti: struct Foo { data: bool}; let x = ~Foo{ data: true}; x
[22:23:37] -rusti- ~main::Foo{data: true}
[22:23:42] <Leo`> kimundi: I must have a syntax error somewhere
[22:23:46] <kimundi> well, it works on 0.8
[22:23:57] <kimundi> maybe forgot the ; after the let?
[22:24:13] <Leo`> no it is there
[22:24:32] <Leo`> oh wait
[22:24:34] <Leo`> stupid me
[22:24:38] <Leo`> ><
[22:25:34] <Leo`> I used = instead of : to give field values
[22:26:39] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[22:26:52] <Leo`> kimundi: and to get a raw ptr out of a ~ptr ?
[22:27:02] <Leo`> must I use transmute or something like that ?
[22:27:20] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:28:26] <kimundi> a &T can be cast to an *T
[22:28:49] <kimundi> rusti: let x = &5; x as *int
[22:28:50] -rusti- (0x7ffbc76260f8 as *())
[22:29:04] <Leo`> well but if I cast the ~foo to a &foo it will consume it, no ?
[22:29:33] *** Joins: jordyd (jordyd@moz-BD34DB3.seg39.ucf.edu)
[22:29:48] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[22:29:52] <kimundi> don't cast
[22:30:01] <kimundi> borrow from it regulary
[22:31:09] <kimundi> rusti: let x = ~5u; let y: &uint = x; let z = y as *uint; println!("{:?}", x); println!("{:?}", y); println!("{:?}", z);;
[22:31:10] -rusti- ~5u
[22:31:10] -rusti- &5u
[22:31:10] -rusti- (0x7f0cbe426058 as *())
[22:31:10] -rusti- ()
[22:31:20] <cmr> kellogh: Awesome!
[22:31:45] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[22:32:38] *** Quits: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP) (Ping timeout)
[22:33:41] <kellogh> so, I have a question: In the embedded world it's considered bad practice to use malloc & free. Can rust allocate large blocks of immortal memory at startup & just reuse it throughout runtime?
[22:34:03] <strcat> kellogh: rust currently has weak support for the necessary tools to do that
[22:34:17] <kellogh> awesome! reading material??
[22:34:32] <kellogh> or code...?
[22:34:38] <strcat> kellogh: maybe https://github.com/thestinger/rust-core ? it's not currently possible to define containers with allocators, for example
[22:34:44] <strcat> due to a bug though
[22:34:57] <strcat> generic dtors with type bounds don't work
[22:35:05] <kellogh> @strcat thanks :)
[22:35:06] <strcat> so you can't have a dtor generic on an allocator type
[22:35:20] <strcat> they are supposed to work, so in theory rust has support for stuff like this
[22:35:25] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[22:36:03] <kellogh> theory is good. reality is even better :)
[22:36:09] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Connection reset by peer)
[22:36:14] <strcat> kellogh: not that embedded software would be using a vector, but you can see that it's close to supporting it here https://github.com/thestinger/rust-core/blob/master/core/vec.rs
[22:36:19] <strcat> just that stupid dtor bug :(
[22:36:49] <kellogh> so it's on a per-datastructure basis?
[22:37:00] <strcat> kellogh: well that's my plan, at least
[22:37:05] <strcat> you could share a pool between several containers
[22:37:08] <kellogh> I was thinking that the entire runtime would allocate a large block
[22:37:11] <kellogh> yeah
[22:37:23] <kellogh> right, allocators...
[22:37:34] <cmr> kellogh: you should be able to do that by defining exchange_malloc?
[22:38:02] <strcat> cmr: but not everything uses it
[22:38:16] <cmr> strcat: ignoring @, what doesn't?
[22:38:21] <kellogh> where is exchange_malloc
[22:38:26] <cmr> kellogh: it's a language item.
[22:38:33] <cmr> it's defined in rust-core in heap.rs
[22:38:35] <kellogh> v0.8?
[22:38:45] <cmr> http://static.rust-lang.org/doc/master/rust.html#language-items
[22:39:39] <cmr> strcat: I like how the lang items assume that the normal malloc/free is for managed boxes :p
[22:39:49] <kellogh> whoa, top google hit for "exchange heap" is a rust blog. nice job guys… 
[22:40:04] <cmr> kellogh: it's an old term with no relevance to modern rust
[22:40:09] <strcat> cmr: so, here is why
[22:40:40] <strcat> none of the containers or smart pointers types defined by rust-core can allocate with ~
[22:41:14] <strcat> ~ doesn't support allocators, so it's only useful within areas where you don't care about allocator support
[22:43:07] <strcat> kellogh: I don't really understand what the use case would be for replacing exchange_{malloc,free} with a large block of memory
[22:43:22] *** Joins: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP)
[22:43:32] <strcat> as long as the program is doing dynamic allocation, that's the issue
[22:44:14] <kellogh> dynamic allocation is nondeterministic. There aren't guarantees of when the operation will finish
[22:44:36] <kellogh> Also, in embedded, you frequently are the only process running, so malloc/free are needless abstractions
[22:45:01] <cmr> kellogh: only for certain allocation algorithms.
[22:45:05] <strcat> kellogh: so, if you don't want to use malloc/free, why would you be providing an alternate implementation of them?
[22:45:05] <cmr> there are realtime allocators.
[22:45:19] *** Quits: jvshahid (jvshahid@67F52200.5E25BC0.E08C671C.IP) (Ping timeout)
[22:45:31] <kellogh> @cmr please expound on that :)
[22:45:31] <strcat> is free() not going to release memory?
[22:45:41] <kellogh> free does release memory, eventually
[22:45:48] <strcat> kellogh: talking about what you want to do
[22:45:52] <strcat> not existing allocators
[22:46:19] *** Joins: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com)
[22:46:50] <strcat> I mean... isn't the problem that you're doing dynamic allocation with malloc/free? you don't have a clear upper bound on memory usage
[22:46:56] <strcat> it doesn't seem like the problem is the allocator
[22:47:31] <kellogh> you have a fixed size of memory available to the program lets say 4k
[22:47:42] <kellogh> stack space is easy, we've already figured that out
[22:47:44] <cmr> kellogh: http://wks.gii.upv.es/tlsf/files/ecrts04_tlsf_0.pdf amongh other things
[22:47:54] <kellogh> everything but stack space is heap space (for this conversation)
[22:48:23] <strcat> kellogh: so you can't have unrestrained use of malloc/free anyway - you need to keep track of how much you're allocating
[22:48:29] <kellogh> In C I can declare a global variable, which allocates immortal memory (it lives for the whole program)
[22:48:37] *** Joins: jstevans (Instantbir@moz-EC9D03D6.bootp.virginia.edu)
[22:48:50] <strcat> you can declare global variables in rust, and soon thread-local ones
[22:48:54] <kellogh> but I still have memory left (total_available - stack - globals)
[22:49:24] <strcat> kellogh: but you can't just have unrestrained malloc/free calls, you need to keep track of the upper bound
[22:49:28] <kellogh> how do I use the remaining memory?
[22:49:46] <strcat> I don't understand what the point would be of having a malloc/free you can't really use
[22:50:24] <kellogh> exactly
[22:50:32] <strcat> kellogh: so why would you want to define them?
[22:50:37] <kellogh> in embedded you don't use malloc/free
[22:50:42] *** Quits: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr) (Ping timeout)
[22:50:44] <strcat> ok, so it's a non-issue
[22:50:57] <kellogh> I want to make use of the memory that's not stack and not globals
[22:51:03] *** Joins: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr)
[22:51:06] <strcat> define more globals?
[22:51:15] <kellogh> or, make a global with a chunk of memory that's managed by the rust runtime
[22:51:24] <cmr> kellogh: ... an arena allocator IS providing malloc/free
[22:51:32] <cmr> That "chunk of memory" is just what it manages.
[22:51:39] <kellogh> so, like the CLR or Java - they have a chunk of memory that they don't give back to the OS
[22:51:51] <strcat> kellogh: but you can't use it
[22:51:56] <cmr> malloc and free don't have to do mapping and so forth.
[22:52:15] <strcat> if you have unrestrained dynamic use of some limited space like that, the software isn't reliable
[22:52:18] *** Quits: jstevans (Instantbir@moz-EC9D03D6.bootp.virginia.edu) (Ping timeout)
[22:52:33] <kellogh> @cmr just saw the link you posted. I think that might have the answer I'm looking for
[22:52:36] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Quit: victorporof)
[22:52:38] <strcat> you aren't gaining anything over a traditional allocator, because that's essentially what you're defining
[22:52:39] <nlminhtl> bggg. can rust be installed in lib64 directories (not lib)?
[22:52:44] <kellogh> I should probably read it before continuing this conversation
[22:52:47] <cmr> kellogh: well I mean it wasn't the first research in that space and it certainly won't be the last.
[22:52:53] <cmr> kellogh: there's a lot of research into allocators.
[22:52:53] <kellogh> …so I can talk intelligently about this stuff :)
[22:53:16] <kellogh> okay, I'll try to educate myself before asking more questions
[22:53:18] <kellogh> :P
[22:53:25] <cmr> no offens,e but it sounds like you don't really understand what an allocator provides or how.
[22:53:30] <kellogh> thanks, I'll back later
[22:53:33] <kellogh> I don't
[22:53:40] <kellogh> really, I need to educate myself
[22:53:56] <strcat> kellogh: for example you could define
[22:53:56] <kellogh> thanks for the link
[22:54:12] <nlminhtl> I had some problem when I had tried to change CFG_LIBDIR from lib to lib64...
[22:54:16] *** Quits: sweet_kid (Upasana@CC12C4EE.621831E2.388CF16F.IP) (Quit: Leaving)
[22:54:18] <strcat> #[thread_local] static mut arena: [u8, ..65536] = [0, ..65536];
[22:54:26] <strcat> and then implement Allocator
[22:54:33] <kellogh> yeah, that's what I was thinking
[22:54:36] <strcat> and pass the allocator to any containers you define
[22:54:39] <cmr> kellogh: you might also be interested in http://cmr.github.io/blog/2013/10/21/on-stack-safety/ and the papers it links to.
[22:54:54] <strcat> Vec::with_alloc(arena_alloc)
[22:54:58] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:55:15] <strcat> let mut tree = TreeMap::with_alloc(arena_alloc); tree.insert(5, 2);
[22:55:19] * strcat shrugs
[22:55:52] *** Quits: kellogh (timkellogg@moz-D1AA8436.hfc.comcastbusiness.net) (Quit: kellogh)
[22:56:49] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[22:58:53] *** Quits: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net) (Input/output error)
[23:02:28] *** Quits: mib_4agx4q (Mibbit@moz-11F915E.ga.at.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:03:59] *** Joins: kellogh (timkellogg@moz-704A74D.hsd1.co.comcast.net)
[23:09:16] *** Quits: Palmik (palmik@moz-DEC2AB.pks.muni.cz) (Quit: Lost terminal)
[23:11:01] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[23:12:36] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[23:14:02] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[23:14:58] *** Quits: moostik (Icedove@moz-1E4F29E2.w82-121.abo.wanadoo.fr) (Ping timeout)
[23:14:59] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[23:15:48] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[23:17:04] *** Joins: jakedust (Jake@moz-81D946E.dsl.telesp.net.br)
[23:20:24] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[23:21:24] *** Joins: gmw (Mibbit@moz-9AC9B9EE.res.bhn.net)
[23:23:45] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[23:24:30] *** Joins: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[23:25:30] *** Quits: q66__ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[23:26:36] *** Quits: jeffcutsinger (jeff@moz-7E34AC5D.dhcp.roch.mn.charter.com) (Quit: Bye)
[23:36:17] *** Joins: ercxx (ercan@moz-8383857F.dyn.optonline.net)
[23:47:02] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: nightynight)
[23:49:51] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[23:53:29] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[23:57:19] *** Quits: h0rrorvacui (h0rrorvacu@moz-5B34B08.sip.bhm.bellsouth.net) (Quit: Leaving)
[23:57:25] *** Joins: h0rrorvacui (h0rrorvacu@moz-5B34B08.sip.bhm.bellsouth.net)
[23:59:04] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
