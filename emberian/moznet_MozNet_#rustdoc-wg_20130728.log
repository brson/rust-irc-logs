[05:21:15] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Ping timeout)
[05:21:37] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[09:17:29] <Seldaek> dbaupp: regarding what you said about macros in #rust just now, any clue if it's fixed by rustdoc_ng? or is that a lexer limitation of some sort
[09:18:04] <dbaupp> Seldaek: it should be, I believe rustdoc_ng runs the expansion pass, doesn't it?
[09:18:16] <Seldaek> I have no idea what it does :)
[09:18:43] <Seldaek> I never looked at the rust part, only the json output
[09:18:47] <dbaupp> waaaait. current rustdoc runs the expansion pass too. so it probably is a deeper bug. :/
[09:22:04] <Seldaek> well anyway, gf left for the airport, so now I shall proceed to not leave my computer for 5 weeks, let's get this rustdoc frontend done :)
[09:30:01] <dbaupp> haha :)
[11:12:12] <Seldaek> sneak preview very much work in progress http://d.pr/i/edpi
[11:12:26] <Seldaek> but slowly getting there :)
[11:19:10] <dbaupp> Seldaek: ooh, that's the real deal? not just a mockup?
[11:19:16] <Seldaek> yeah that's in browser
[11:19:24] <dbaupp> looks awesome
[11:19:33] <Seldaek> from the json cmr generated out of rustdoc_ng
[11:22:19] <Seldaek> it's kinda lacking doc content to make things interesting though 
[12:34:34] <Seldaek> ok much closer now http://d.pr/i/UdJF
[12:36:17] <dbaupp> ooh, even nicer!
[12:36:50] <Seldaek> ;)
[12:37:33] <Seldaek> main thing missing now is docs in rustdoc_rt, actually implementing the search, and handling impls on structs
[12:40:50] <dbaupp> I imagine that once we get impls on structs, then it can be put in the tree and the others get developed there?
[12:42:18] <Seldaek> yeah although I don't know if this belongs in the tree really or should remain a separate thing
[12:42:36] <Seldaek> but it'd be cool to start running it on rust itself once that works (not sure what the state is on that, cmr?)
[12:45:05] <dbaupp> the current rustdoc definitely doesn't belong in the tree, and if there's going to be a doc generator included by default then rustdoc_ng fits there perfectly.
[12:46:16] <Seldaek> dbaupp: well, rustdoc_ng and my frontend are different things, in theory this is just one of the n frontends for it
[12:46:29] <Seldaek> but it could be merged in I guess if we want a default one
[12:46:40] <Seldaek> if it's deemed acceptable that it's written in node 
[12:46:43] <dbaupp> ah, right.
[12:46:50] <Seldaek> anyway not a huge deal where the code sits
[12:47:06] <Seldaek> it'd just be cool to have it online some time before 0.8
[12:47:08] <dbaupp> Yeah, I guess a non-Rust frontend would have to be *extremely* amazing to get into the tree.
[12:47:52] <Seldaek> there isn't so much to it really https://github.com/Seldaek/rustdoc_web/blob/master/rustdoc.js
[12:48:08] <Seldaek> problem is that it depends on twig for the templates, and that won't run in rust
[12:48:38] <Seldaek> (also the code is a complete mess right now because I've just been moving forward as fast as I can without much cleanup:)
[12:49:25] <dbaupp> http://twig.sensiolabs.org/ ?
[12:49:51] <dbaupp> well, https://github.com/justjohn/twig.js I guess.
[12:49:56] <Seldaek> yes that one
[12:50:01] <Seldaek> the latter 
[12:50:58] <Seldaek> I don't really see the point of doing the doc frontend in rust though
[12:51:20] <Seldaek> it's just gonna be more work, and the speed is a non-issue since it's a build-time thing
[12:52:03] <Seldaek> it builds rustdoc_ng in 2secs, so even if rust itself takes 5mins to build it's still cheap I guess 
[12:52:04] <dbaupp> Yeah, I agree; just being non-Rust means there is an external dependency, so it'd be nice to be plain Rust.
[12:52:34] <Seldaek> sure it'd be nicer
[12:52:43] <dbaupp> although, apparently the current situation with pandoc is mostly acceptable (for now, at least).
[12:53:36] <Seldaek> anyway once I'm done it'll be easy enough for anyone with spare time to port I guess.. even if the templates need rewriting or whatever it's not an immense amount of code
[12:53:44] <Seldaek> it was just work to figure things out
[12:54:03] <Seldaek> (not that this part is over)
[12:54:24] <dbaupp> yeah, the hard bit is implementing it in any language; porting is normally (relatively) straight-forward.
[12:55:37] <Seldaek> js debugging is so much fun :/
[14:39:26] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[14:43:17] <Seldaek> cmr: let me know when you're around 
[16:07:31] <cmr> Seldaek: ping
[16:07:38] <Seldaek> eh
[16:07:48] <Seldaek> http://seld.be/rustdoc/rustdoc_ng/index.html
[16:07:59] <cmr> Hohoho
[16:08:02] <cmr> And it works!
[16:08:07] <cmr> This is fantastic
[16:08:08] <Seldaek> search not yet
[16:08:17] <cmr> Good enough for me! :D
[16:08:18] <Seldaek> but the rest has gotten pretty far 
[16:08:22] <cmr> Let me run it on libstd right now
[16:08:28] <cmr> I think it works enough for it
[16:08:41] <Seldaek> you should check the issues I reported on your repo as well
[16:08:48] <Seldaek> got a few things that tripped me up
[16:09:10] <cmr> ok
[16:09:16] <Seldaek> if we can get those sorted and the messed up ids, then that'd be great
[16:09:28] <Seldaek> though we are still missing impls unless I missed something?
[16:09:34] <cmr> we are still missing impls
[16:09:37] <cmr> and a lot of things
[16:09:41] <Seldaek> ok ;)
[16:09:49] <Seldaek> impls are pretty important though
[16:10:07] <Seldaek> but anyway it's pretty cool already to have something to click through
[16:10:07] <cmr> well none of it is /unimportant/
[16:11:59] <cmr> Ah I remember what was preventing me from running it on libstd
[16:12:10] <cmr> I can't pass through like --cfg stage2
[16:12:21] <cmr> I can fake it though
[16:13:25] <Seldaek> ok
[16:50:09] *** Quits: jga (asdf@4FEC09A8.FF67FEC4.B5524284.IP) (Ping timeout)
[17:06:23] *** Joins: jga (asdf@7B777882.763657B.B5524284.IP)
[17:30:34] *** Quits: jga (asdf@7B777882.763657B.B5524284.IP) (Ping timeout)
[17:47:43] *** Joins: jga (asdf@82FBC94D.C51798DE.B5524284.IP)
[18:04:25] *** Joins: dbp (user@moz-72A193C2.ri.ri.cox.net)
[21:03:21] *** Quits: dbp (user@moz-72A193C2.ri.ri.cox.net) (Ping timeout)
[21:20:30] <Seldaek> cmr: any luck with libstd? 
[21:20:46] <cmr> Seldaek: yes!
[21:20:58] <cmr> It will at least parse and typecheck and stuff
[21:21:06] <cmr> I am implementing closures now
[21:22:08] <Seldaek> closures? like closures as args?
[21:22:12] <cmr> Yes
[21:22:19] <Seldaek> ok I see
[21:22:34] <Seldaek> more ways to blow up my type renderer :)
[21:22:44] <cmr> ;)
[21:23:29] <cmr> it's going to be broken and incomplete atm...
[21:23:38] <cmr> so you can ignore "type": "closure" if you want
[21:27:41] <Seldaek> cmr: did you check https://github.com/cmr/rustdoc_ng/issues/17 ?
[21:27:53] <cmr> Seldaek: not yet
[21:27:56] <Seldaek> because that kinda breaks the current stuff, so would be cool to address it
[21:28:56] <Seldaek> and I don't know if you checked out the source button, but it works perfectly fine :)
[21:29:04] <Seldaek> that's very nice
[21:29:35] <cmr> This is already 30x better than the existing rustdoc
[21:29:38] <cmr> just sayin'
[21:29:59] <Seldaek> yeah it's getting there it's nice
[21:30:39] <Seldaek> if you can ship me the rest of the info and then we run it on libstd to iron out the edge cases it shouldn't be so much work left to be ready for prime time
[21:30:56] <Seldaek> well, no idea how much work that means for you :)
[21:31:41] <cmr> I'm doing other things atm, only working on this a few minutes here/there
[21:37:06] <Seldaek> cmr: alright no rush, but I guess when you can give me a libstd json I'll try to build with that and then I can post on reddit/ml
[22:04:14] <cmr> Seldaek: sorry this is taking so long
[22:04:22] <cmr> running it on std is exposing lots of bugs :p
[22:06:37] <Seldaek> oh no worries
[22:06:46] <Seldaek> midnight here, I probably won't make it tonight anyway
[22:13:32] <cmr> Seldaek: hahah!
[22:13:44] <cmr> got json
[22:14:47] <Seldaek> yay
[22:15:02] <Seldaek> I have a feeling this is gonna ruin my night :p
[22:15:12] <Seldaek> but please do share
[22:16:02] <cmr> it seems gist doesn't like it...
[22:16:11] <cmr> Oh there we go
[22:16:16] <cmr> https://gist.github.com/cmr/b24b9e0f48539786fe3e/raw/20d0905605f90ca041131a70c373d85eafc0404b/std.json
[22:16:26] <cmr> Oh my, 3.3MB
[22:16:39] <Seldaek> yeah I4m gonna save my browser some trouble and just wget this
[22:16:52] <cmr> yup
[22:17:04] <Seldaek> and build failure:p
[22:17:17] <cmr> I make no promises of unbuggy json ;p
[22:17:32] <cmr> I introduced two new types
[22:17:43] <cmr> "bottom", which represents the return value of functions which never return
[22:17:53] <cmr> (like fail!())
[22:18:05] <cmr> and "closure", which you should probably ignore since the JSON is wrong
[22:18:07] <cmr> :P
[22:18:21] <Seldaek> and how do I show that a function never returns? 
[22:18:39] <cmr> fn foo() -> !
[22:18:43] <cmr> is what it is in the source
[22:18:52] <cmr> I have no idea what a good way to display it is..
[22:19:00] <Seldaek> btw type 'string' sounds like it maybe should be a primitive str or is this wrong?
[22:19:16] <Seldaek> well, -> ! sounds fine
[22:19:53] <cmr> What do you mean?
[22:19:58] <cmr> the "string" type?
[22:20:08] <cmr> it's not considered a primitive by the AST
[22:20:12] <Seldaek> ok
[22:20:15] <cmr> primitive really means "machine type"
[22:20:20] <Seldaek> but I represent it as "str" right?
[22:20:20] <cmr> ie, something the hardware directly represents
[22:20:22] <cmr> yes
[22:20:34] <Seldaek> 'bottom' is a really confusing name btw :p
[22:21:21] <Seldaek> perhaps it makes sense according to some thing I ignore
[22:21:24] <cmr> http://en.wikipedia.org/wiki/Bottom_type
[22:21:27] <cmr> it's a type theory thingy
[22:21:35] <cmr> I didn't name it, just relaying the language concept
[22:21:50] <cmr> http://static.rust-lang.org/doc/rust.html#diverging-functions btw
[22:22:31] <Seldaek> alright, no wonder I ignore this 
[22:22:42] <Seldaek> whenever it's called something theory, I suck at it :)
[22:23:30] <Seldaek> makes sense that it exists though
[22:23:48] <cmr> yeah
[22:23:57] <cmr> when the theory people get going in #rust I just zone out :p
[22:24:10] <Seldaek> ah, a type generic too.. I am not handling that yet
[22:24:19] <Seldaek> what do I do with this
[22:24:29] <Seldaek> value 193087, I guess that's an id
[22:24:51] <cmr> Yes
[22:24:57] <cmr> It's an id in the...
[22:24:59] <Seldaek> ah that refers to the typarams I see
[22:25:02] <cmr> Yes
[22:25:08] <Seldaek> crap
[22:25:17] <Seldaek> I don't have that data in context :)
[22:25:26] <cmr> bbl
[22:25:32] <Seldaek> alright
[23:11:18] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[23:13:03] <cmr> Alright I'm back
[23:31:48] <Seldaek> k, well I was doing maintenance crap on other OSS projects..
[23:37:18] <cmr> Seldaek: so the problem with function argument names is that the thing on the left side of the colon is a pattern...
[23:38:12] <Seldaek> pattern? (sorry I know I don't know anything)
[23:38:39] <cmr> like how you can do let (a, b) = (2, 3)
[23:38:48] <cmr> You can have that in function arguments too... I think
[23:40:28] <Seldaek> ah destructuring in args? really?
[23:40:51] <Seldaek> in any case.. is this good or bad news? :)
[23:40:57] <Seldaek> we can't really do without arg names
[23:42:37] <Seldaek> cmr: quick question about typarams, what are the bounds for/do I care?
[23:42:46] <cmr> Seldaek: it's like
[23:42:55] <cmr> fn foo<T: Option<U>, U>
[23:42:58] <cmr> T has bounds
[23:43:00] <cmr> U does not
[23:43:23] <Seldaek> I see
[23:43:40] <Seldaek> but all the samples of bounds I find in the json are just empty shells of trait_bound with nothing
[23:44:07] <cmr> I make no promise of unbuggyness of the json :p
[23:44:32] <cmr> I don't think I had any generics with bounds in rustdoc_ng when I gave you that json
[23:44:42] <cmr> libstd should have them, look in iterator
[23:48:41] <Seldaek> eh well, can't find any right now in the json but whatever
[23:49:08] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:49:40] <Seldaek> cmr: so typarams if present have to be rendered as <T, U> after the fn name, and then those present in args/output are resolved of course
[23:49:51] <cmr> Seldaek: yup
[23:50:21] <SiegeLord> Another thing I found surprising is that the source link goes to the git... it seems like that that might have nothing to do with the documentation
[23:51:28] <cmr> SiegeLord: it's like what python does in their docs
[23:51:28] <Seldaek> what would you expect?
[23:51:33] <cmr> link to the source being documented
[23:51:52] <SiegeLord> Nothing prevents me from deleting that file in the git repository
[23:52:17] <cmr> ...so?
[23:52:20] <Seldaek> well, ideally every version of the doc will point to the exact commit in the git repo it was tagged from
[23:52:25] <cmr> Nothing prevents you from removing a function from the source
[23:52:26] <SiegeLord> That'd be a start
[23:52:28] <Seldaek> so even if master doesn't have it anymore, it's fine
[23:52:43] <SiegeLord> I'd really expect the documentation to just have a copy of the source
[23:53:03] <Seldaek> meh that's another way but it'd make it much lengthier to build
[23:53:19] <Seldaek> not excluding it, but right now it's not worth the work IMO
[23:53:21] <cmr> SiegeLord: The JSON is designed so useful documentation can be generated without any local source
[23:53:32] <cmr> eg you can generate it from a compiled crate that hasn't had metadata stripped
[23:53:53] <SiegeLord> How does that link get generated then?
[23:53:58] <Seldaek> and also I don't feel like rebuilding a source viewer while github does that very well 
[23:54:14] <cmr> The json has a span in it, filename:startline:startcolumn endline:endcolumn
[23:54:54] <Seldaek> cmr: there's a : after startcolumn too btw (not sure if it's always there, but it tripped up my regex earlier)
[23:55:06] <cmr> oh, didn't notice it
[23:55:17] <SiegeLord> Well anyway, it should point to the right commit
[23:55:28] <Seldaek> yes if the commit is available, we can do that for sure
[23:55:45] <SiegeLord> I still don't quite get how the link is generated still
[23:55:56] <SiegeLord> Is the filename a github link?
[23:55:59] <Seldaek> base url + path from top of the crate
[23:56:13] <Seldaek> the base url is on my end at the moment, containing the github bit
[23:56:33] <Seldaek> and cmr's json contains the path from crate root, like foo/bar.rs then line numbers
[23:56:37] <cmr> SiegeLord: the url prefix would be an attribute of the crate
[23:57:11] <SiegeLord> Err... so if I clone someone's repo, I need to fixup all the prefixes?
[23:57:52] <Seldaek> all like.. one, or probably this is overridable at build time in my thing anyway
[23:58:34] <SiegeLord> It really doesn't belong there in the first place... I'd say just copy (flawed imo) idea from rustpkg
[23:58:47] <Seldaek> cmr: eh I'm running into race conditions now that the data set is larger
[23:58:56] <cmr> SiegeLord: copy what idea from rustpkg?
[23:59:18] <SiegeLord> rustpkg doesn't have a package id attribute
[23:59:25] <SiegeLord> It infers it from the directory structure
