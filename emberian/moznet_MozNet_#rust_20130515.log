[00:00:03] <strcat> sec
[00:00:04] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[00:00:09] <strcat> yep
[00:01:16] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:01:18] <strcat> rusti: aa
[00:01:20] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/YNdG
[00:01:29] <strcat> steven_is_false: it prints a message now though
[00:01:58] <steven_is_false> strcat: okay
[00:02:14] <strcat> rusti: println("foo"); println("bar"); core::run::run_program("sleep", [~"5"]); println("baz");
[00:02:20] <rusti> foo
[00:02:20] <rusti> bar
[00:02:20] <rusti> timed out after 5 seconds
[00:02:26] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[00:02:38] <cmr> it'd be nice, for changes that don't modify the ABI, if the build system wouldn't rebuild everything because of a change in libcore, for example.
[00:02:51] <cmr> that's hard to do though
[00:02:59] <tjc> cmr: yup, https://github.com/mozilla/rust/issues/2369
[00:03:18] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[00:03:42] <steven_is_false> I think there's a lot of low hanging fruit for speeding up build times though.
[00:05:04] <steven_is_false> Incremental recompilation would be cool but I don't know if it's the easiest way to get a speed up.
[00:06:18] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[00:06:32] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[00:08:35] <steven_is_false> rusti: [3] + [4]
[00:08:38] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/RKhh
[00:08:44] <steven_is_false> rusti: [3] + [4]
[00:08:45] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/Ldhh
[00:08:57] <steven_is_false> rusti: @[4] + @[5]
[00:08:58] <rusti> @[4, 5]
[00:09:53] <graydon> hm hm hm
[00:09:57] <steven_is_false> rusti: @@@@1
[00:09:58] <rusti> @@@@1
[00:10:07] <steven_is_false> rusti: @&~@&3
[00:10:09] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/TJUW
[00:10:20] <graydon> anyone have any guess about why a change to the way the interner organizes itself internally should break client code of libsyntax?
[00:10:32] <steven_is_false> rusti: &&@@@~@4
[00:10:33] <rusti> foo.rs:5:9: 5:11 error: unexpected token: `&&`
[00:10:33] <rusti> foo.rs:5          &&@@@~@4
[00:10:33] <rusti>                   ^~
[00:10:48] <steven_is_false> rusti: &@@@~@4
[00:10:50] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/hAbe
[00:10:53] <jclements> graydon: I'm messing around with the interner right now.  What's going on?
[00:10:57] <graydon> specifically, aside from the preallocated special names, any other parts care which numbers get assigned to which interned strings?
[00:11:17] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[00:11:27] <graydon> jclements: not sure, I just get an ICE in stage2 when I switch it to a more compact representation. it's working well enough to get through stage1 entirely.
[00:12:00] <jclements> I had terrible ICEs when I was in vancouver, trying to add a GC'ed value to the representation of identifiers.  I finally just gave up and turned the extra field into a uint.
[00:12:03] <graydon> an ICE that looks suspiciously like general corruption, pointing to the wrong constant or something
[00:12:14] <jclements> are your ICEs causing collector meltdown?
[00:12:39] <graydon> no
[00:12:44] <graydon> there's no collector in place yet
[00:12:45] <jclements> I'm (literally right now) in the process of stripping down the interner so that its ambit is more limited, and it just maps strings to uints, rather than to idents.
[00:12:56] <graydon> I'm trying to reduce memory use of the interner
[00:13:19] <jclements> graydon: I was getting errors from the refcounter, claiming that memory wasn't freed 
[00:13:25] <graydon> because it makes a very large amount of the @-memory budget, and the memory budget in general (due to the very wasteful representation of @-boxes)
[00:14:10] <jclements> is the idea just to use the interner for fewer strings, or to alter its internal representation?
[00:14:31] <graydon> alter internal representation
[00:15:00] <jclements> I noticed a few hours ago that the interner is being used for things like docstrings, which gives me pause....
[00:15:06] <graydon> concatenates all strings with \0 between them, hands out offsets into that buffer
[00:15:22] <graydon> it's being used for all sorts of weird stuff. I'm noticing the same while debugging this.
[00:15:30] <jclements> have you computed the average length of the strings living in the interner?
[00:15:39] <graydon> like er:
[00:15:42] <graydon> rust: ~"intern miss for _6cac8ab8c945c0, adding #10495 at 382818"
[00:15:42] <graydon> rust: ~"intern miss for _c1c3aaea7a9a66af, adding #10496 at 382899"
[00:15:42] <graydon> rust: ~"intern miss for _ccdc19687e41847, adding #10497 at 382934"
[00:15:59] <graydon> that is: someone's storing stringified hash values in the interner
[00:16:03] <graydon> jclements: no
[00:16:14] <graydon> but keep in mind, our strings are enormous
[00:16:33] <jclements> you mean the encoding of the characters, or the GC overhead?
[00:16:52] <graydon> 48 bytes of overhead for a gc boxed str
[00:17:22] <strcat> graydon: I think it's more
[00:17:22] <jclements> but the chars themselves are UTF-8, right?
[00:17:23] <graydon> this is .. this is not the time to gasp and sigh and give up and try using normal strings
[00:17:32] <strcat> isn't it 64-byte overhead?
[00:17:34] <graydon> I just want to fix the interner's representation to not spend 300mb on overhead
[00:17:35] <strcat> the header is 4 words
[00:17:45] *** Quits: thatfreakingguy (Mibbit@moz-9B57E929.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:17:51] <graydon> jclements: yes
[00:17:59] <jclements> 300mb of *overhead* ?
[00:18:12] <strcat> jclements: @ and ~ boxes have a 4-word header
[00:18:24] <strcat> ~(int, int) should be a 16-byte allocation, but it's 64-byte
[00:18:25] <graydon> 4 words is 32 bytes, plus 2 more for vec fields (alloc, limit)
[00:18:26] <jclements> that's 32 bytes?
[00:18:33] <strcat> graydon: I think the header is aligned though
[00:19:01] <strcat> it puts struct { header, body }
[00:19:16] <strcat> at least for ~ and @
[00:19:20] <graydon> well, anyway, my point is it's enormous and measuring string length won't give you much insight into the overhead
[00:19:31] <graydon> or the saddlepoint for when it's worth interning
[00:19:34] <graydon> and we're not removing it today
[00:19:38] <graydon> removing it would be very invasive
[00:19:40] <jclements> urrâ€¦ 300MB / 32 bytes = about 9M values? There *can't* be that many strings in the interner
[00:19:41] <graydon> I am trying to get a gc landed
[00:19:51] <graydon> it can't bootstrap because we're using too much memory
[00:19:55] <graydon> that's literally what's going on
[00:20:06] * strcat is looking forward to the gc ;p
[00:20:07] <graydon> I want to make the smallest possible change to make that blockage go away
[00:20:34] <graydon> jclements: it looks like about 3m boxes
[00:20:45] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[00:20:47] <jclements> just for the interner?
[00:20:58] <strcat> jclements: librustc does a lot of stupid stuff :)
[00:21:33] <graydon> not clear, possibly something else. I'm adding instrumentation to try to get more insight.
[00:21:42] *** Joins: ysuzuki (ysuzuki@moz-60FA9D06.net119083145.t-com.ne.jp)
[00:23:09] <jclements> FWIW, I've spent the last 2 or 3 hours dealing with a bug related to the interner that looks a lot like memory corruption....
[00:23:34] <graydon> unforunate. how does it manifest?
[00:24:35] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[00:24:54] <jclements> I have a state of the source code where trying to compile syntax.rc says things like: can't resolve new_ident, maybe you meant `new_iden::*` â€¦ and other things where it appears that characters are getting sliced off of the ends of strings. V strange.
[00:25:17] <jclements> the strangest thing is that this *isn't* a bootstrapâ€¦ just trying to compile some code.
[00:25:30] <graydon> length of strings
[00:25:46] <jclements> I'm rebasing now, and it may be that the bug evaporates when I'm done.
[00:25:55] <graydon> some of the string APIs assume +/-1 when considering length
[00:26:13] <jclements> urgâ€¦ well, that could explain things.
[00:26:17] <graydon> due to the fact that ~[] has a trailing null and &[] holds a len field that's 1 longer than the data
[00:26:26] *** Quits: eholk (eholk@moz-4B82F403.uconnect.utah.edu) (Quit: eholk)
[00:26:54] *** Quits: dherman (dherman@2557E599.66715431.D25A875A.IP) (Quit: dherman)
[00:26:57] <graydon> brson is profoundly annoyed by this family of bugs. I am too but I don't know how to avoid it aside from what we're doing now. I think he has a plan to make it less randomly weird.
[00:28:47] *** Joins: wuwei`lab (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[00:30:06] <seth> can someone tell me what i'm doing wrong here? this is a snippet of a larger function, but i think the rest isn't needed:
[00:30:15] <seth> https://gist.github.com/sfowler/4ed4447447bc42f6769b
[00:30:51] <tjc> seth: that's a bug that I fixed in today's or yesterday's incoming
[00:30:52] <seth> i've tried many variations, including using "do items.map"; everything makes the compiler angry
[00:30:56] <tjc> if you update incoming it'll work
[00:30:56] <tjc> but
[00:31:04] <tjc> it's actually reporting a type error badly
[00:31:09] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[00:31:15] <tjc> you have a pattern (bounds, color) -- I'm guessing the actual argument type isn't a pair
[00:31:22] <tjc> ah yes
[00:31:27] <tjc> it's a *reference* to a pair
[00:31:38] <tjc> if you write &(bounds, color) that should fix it even without pulling changes
[00:31:42] <seth> tjc: it's a reference to a pair?
[00:31:59] <tjc> yeah, all the higher-order functions like each take closures that take an &T instead of a T
[00:32:31] <seth> tjc: ahh, ok. that explains why no matter what i did it wasn't happy =)
[00:33:01] <tjc> yeah, although the ICE was just bad. hopefully people will stop seeing that now as soon as they pull changes :-)
[00:33:25] <strcat> nmatsakis: yay, the rvalue thing :)
[00:34:36] <strcat> ugh, it's like the people who develop these haskell libs want to make my life hard
[00:34:46] <strcat> data-default got split into 6 packages :|
[00:34:52] <strcat> they're each 5 lines of code...
[00:35:05] <tjc> haha
[00:35:52] <strcat> https://github.com/mauke/data-default ;p
[00:36:41] <strcat> so pandoc has ghc + 34 standalone deps now
[00:37:30] <cmr> r? https://github.com/mozilla/rust/pull/6485
[00:37:46] <cmr> this one should actually work :)
[00:38:43] <tjc> cmr: r+'ed
[00:38:51] <cmr> tjc: thanks
[00:38:54] <tjc> yw
[00:39:32] *** Quits: ssbr (ssbr@moz-6A5A684C.wireless.utoronto.ca) (Ping timeout)
[00:39:34] <bjz> could somebody do the honours on this one? https://github.com/mozilla/rust/pull/6333
[00:39:53] *** Quits: igl (igl@moz-FB7F39.adsl.alicedsl.de) (Ping timeout)
[00:40:40] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[00:40:47] <graydon> strcat: documentation formats are the most complicated thing in the entire universe of software
[00:40:51] *** Joins: igl (igl@moz-D0A4BB4D.adsl.alicedsl.de)
[00:40:58] <tjc> what about line endings?
[00:41:02] <graydon> could be worse: it could be a dependency on the docbook toolchain!
[00:41:04] <tjc> surely line endings are more complicated than that
[00:41:13] <strcat> graydon: it doesn't need to depend on all these legacy libs though :)
[00:41:13] <nmatsakis> pcwalton: how do I know if the "fastffi" attr is being set on a function? can I tell from the .ll output?
[00:41:42] <nmatsakis> pcwalton: I mean the attr that requests a big stack chunk
[00:42:30] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[00:44:01] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:44:22] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:45:04] *** Quits: jorendorff (jorendorff@moz-4BE034AB.ptr.us.xo.net) (Quit: jorendorff)
[00:45:04] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[00:45:05] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:46:25] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[00:47:24] *** Quits: inolen (Adium@moz-9F4F17DF.tourcaster.com) (Quit: Leaving.)
[00:47:34] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:47:47] *** Quits: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[00:47:54] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:49:39] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:52:21] *** Joins: dherman (dherman@2557E599.66715431.D25A875A.IP)
[00:52:21] *** ChanServ sets mode: +o dherman
[00:52:46] *** Joins: jorendorff (jorendorff@moz-4BE034AB.ptr.us.xo.net)
[00:53:39] *** Quits: ysuzuki (ysuzuki@moz-60FA9D06.net119083145.t-com.ne.jp) (Client exited)
[00:54:54] *** Joins: drb (drb@DA62CBD9.58AFE261.5EBD1F4C.IP)
[00:54:56] <drb> hello?
[00:55:04] <bjz> hello
[00:55:20] <vermeille> Hello !
[00:55:44] <benh> hi!
[00:55:56] <drb> hi :)
[00:56:05] <bjz> hi!
[00:56:23] <drb> so I understand the reasoning behind many of the pointer semantics, but I'm a little lost about str/vec.
[00:57:04] <drb> specifically, if you can't dereference it, how do you create a borrowed pointer to a managed/owned string?
[00:57:40] <drb> The lifetime of the borrowed pointer is guaranteed to be less than the lifetime of the boxed string, but I'm unsure of how to actuallly make the type conversion.
[00:57:47] <benh> &str/&[] are called slices, there's a slice method for strs and vecs I suppose
[00:57:54] <benh> and I think there's an implicit conversion too
[00:57:56] <drb> ahhhh
[00:57:56] *** Joins: z0w0 (zack@moz-B13FD5D7.lns2.cha.bigpond.net.au)
[00:58:16] <strcat> rusti: let xs = ~[1, 2, 3, 4]; let y: &[int] = xs; y
[00:58:20] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/KEbW
[00:58:29] <strcat> rusti: let xs = ~[1, 2, 3, 4]; let y: &[int] = xs; fmt!("%?", y)
[00:58:31] <rusti> ~"&[1, 2, 3, 4]"
[00:58:35] <pcwalton> nmatsakis: it's called "fixedstacksegment"
[00:59:48] <drb> so, it's an implicit conversion for a local variable?
[00:59:50] *** Joins: ssbr (ssbr@moz-673B6A0E.wireless.utoronto.ca)
[00:59:59] <drb> that makes sense from a compiler point of view.
[00:59:59] <drb> ok
[01:00:02] <strcat> drb: it's an implicit conversion
[01:00:07] <strcat> not just for 'let'
[01:00:20] <drb> hmm, then I have another issue.
[01:00:25] <drb> let me try to construct a small test case.
[01:00:28] <strcat> return value coercion doesn't work
[01:00:33] <strcat> if that's what it is
[01:01:24] <drb> the issue is that I have a bunch of managed strings, and I want to concat them like so (types): (&str = str::concat([&str, str_lit, @str]))
[01:01:32] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[01:01:53] <drb> do I need to construct the slice separately in this case because of the vector literal?
[01:04:39] <strcat> str::concat takes &[~str]
[01:04:55] <drb> that would make more sense.
[01:04:57] <drb> ok
[01:05:29] <strcat> there's str::connect_slices but no concat_slices
[01:05:31] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[01:05:50] *** Joins: bytbox (s@moz-2E27684C.student.umd.edu)
[01:05:55] <drb> ok, thanks
[01:06:01] <drb> I was looking for connect as 'join'
[01:07:06] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:07:23] <drb> Is there any immediate plans to extend str/vec libraries to include managed pointers?
[01:07:27] <drb> are there*
[01:07:53] <Thad> brson: wondering how in the hell we can make step 6 easier.... https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust#windows
[01:08:30] <vermeille> removing MinGW dependency !
[01:08:31] <pcwalton> nmatsakis: but I think there may have been a bug whereby it wasn't being printed in llvm-dis.
[01:08:44] <Thad> brson: currently you have to do something like: http://pastebin.mozilla.org/2404980
[01:09:12] *** Quits: fairfieldt (fairfieldt@moz-D8998E1C.xen.prgmr.com) (Ping timeout)
[01:09:12] *** Quits: fireglow (fireglow@moz-DC22A4B9.firc.de) (Ping timeout)
[01:09:18] <Thad> vermeille: haha... suggestions on doing THAT ?
[01:09:28] *** Joins: fireglow (fireglow@moz-DC22A4B9.firc.de)
[01:09:54] <strcat> submit patches to LLVM making lld stable/complete
[01:11:52] <graydon> is anyone aware of anything we're putting into TLS that's _not_ just the interner?
[01:11:58] * graydon checks rustc for use of conditions
[01:12:02] <graydon> taskgroups I guess, also. hmm...
[01:12:39] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:12:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1435e2e34 to 14c30414f: 02http://git.io/N3iJvQ
[01:12:39] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:12:41] <strcat> graydon: I thought nmatsakis was going to add something for @
[01:12:43] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:12:43] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/l3bV9A
[01:12:43] <ghrust> 13rust/06auto 14b9824e1 15Brendan Zabarauskas: Add Scheme-style `cond!` macro to syntax::ext::expand...
[01:12:43] <ghrust> 13rust/06auto 147e4a176 15Brendan Zabarauskas: Use parentheses for cond! macro instead of preceding pipes...
[01:12:44] <ghrust> 13rust/06auto 14cf0f760 15bors: auto merge of #6333 : bjz/rust/cond-macro, r=thestinger...
[01:12:46] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:12:46] <strcat> to track freezing in debug builds
[01:12:52] <strcat> maybe that wasn't done
[01:12:57] <Thad> Perhaps we need to try to create an open source installer for Rust using the well known Nulsoft Scriptable Installer ? http://nsis.sourceforge.net/Main_Page  That might also help solve the Curl installation as well.
[01:13:03] *** Joins: fairfieldt (fairfieldt@moz-D8998E1C.xen.prgmr.com)
[01:13:07] <graydon> Thad: we used nsis before
[01:13:13] <Thad> and ?
[01:13:19] <graydon> we switched to inno
[01:13:27] <Thad> k, so inno then ?
[01:13:27] <graydon> nsis was too hard to work with
[01:13:30] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Ping timeout)
[01:13:32] <graydon> we have an inno installer
[01:13:53] <graydon> src/etc/pkg/rust.iss
[01:13:57] <Thad> that does the interactive build itself ?
[01:13:58] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[01:14:02] <graydon> it's what the rust-installer.exe is built from
[01:14:15] <graydon> no, that installs a binary
[01:14:23] <Thad> graydon: ah.
[01:14:39] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[01:14:39] <graydon> we're not going to redo the build logic in nsis or inno. neither are build systems.
[01:14:54] <Thad> MinGW just needs to package Curl...then.
[01:15:30] <strcat> there are curl builds for windows
[01:16:12] <Thad> strcat: point me to one that I can just download, untar / extract, and it works
[01:17:23] <strcat> http://curl.haxx.se/download.html there's one there
[01:17:54] <Thad> that 74 of them.
[01:17:54] <graydon> one of the mingw / msys packages has it, I think
[01:18:02] <Thad> graydon: nope.
[01:18:08] <graydon> I mean, _somehow_ it works on windows. I never remember the exact setup steps we take.
[01:18:25] <graydon> Thad: the buildbots all have curl installed, as does my workstation.
[01:18:47] <Thad> that's great.  Would you like more Windows developers contributing to Rust development ?
[01:18:49] <strcat> the curl site has a binary build for win32, win64 and cygwin
[01:19:26] <Thad> MSVC , if I recall still stands for Microsoft Visual C++ ?
[01:19:50] <graydon> Thad: yes. I'm sorry, it's just .. you're telling me there's no way to get it and somehow I have, I guess I can go reconstruct how we got it but I'm pretty sure there was a package that we just did mingw-get on.
[01:20:02] <graydon> maybe not. I'll go check on those machines again, sec.
[01:20:09] <Thad> Please check !!!!  Thanks !
[01:20:41] *** Joins: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp)
[01:20:47] <graydon> it came with git
[01:20:55] <graydon> which is also required to do any meaningful development on winows
[01:20:57] *** Quits: drb (drb@DA62CBD9.58AFE261.5EBD1F4C.IP) (Quit: Textual IRC Client: www.textualapp.com)
[01:20:58] <graydon> *windows
[01:21:04] <graydon> download msysgit, add it to the end of your path
[01:21:09] <graydon> (end, not beginning)
[01:21:09] <Thad> checking on mine....sec
[01:21:34] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[01:21:39] <graydon> c:/Program Files (x86)/Git/bin/curl.exe
[01:22:05] <vermeille> Haha, I'm spreading Rust around me, everyone says that this language is almost perfect =D
[01:22:19] <Jeaye> Not everyone. :P
[01:22:36] <vermeille> everybody* ?
[01:22:40] <vermeille> english mistake ?
[01:22:44] <Jeaye> Not everybody. :P
[01:23:00] <SiegeLord> Only nobodies think it's not
[01:23:01] <vermeille> everybody... around me!
[01:23:08] <Jeaye> Not an English mistake. Just saying there are people that don't like it.
[01:23:14] <Jeaye> They may be wrong!
[01:23:18] <Jeaye> >.<
[01:23:34] <graydon> perfection is not on the milestone list :)
[01:23:36] <tjc> I think there's an implicit "everyone I've talked to about it" going on :-)
[01:23:52] *** Quits: dherman (dherman@2557E599.66715431.D25A875A.IP) (Quit: dherman)
[01:23:56] <Jeaye> tjc: Bah, maybe. ^_^
[01:24:14] <vermeille> Absolutely, it's a consistent mix of best features of most interesting paradigms
[01:24:15] <bjz> vermeille: plenty still to do sir
[01:24:42] <Jeaye> No doubt. Not bashing Rust at all; I <3 it.
[01:24:53] <SiegeLord> It's perfect in potentia
[01:24:59] <Thad> graydon: hmm, interesting... (x86) folder...for Git..... where did you get Git ?  MinGW comes with it.
[01:25:04] <vermeille> Of course! But we're talking about what Rust intends to be, not what it is today
[01:25:11] <graydon> Thad: msysgit
[01:25:22] <graydon> https://code.google.com/p/msysgit/
[01:25:31] <graydon> er
[01:25:33] <graydon> http://msysgit.github.io/
[01:25:34] <Thad> graydon: OH, that's totally different.
[01:25:35] <graydon> things keep moving
[01:25:37] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[01:25:52] <graydon> mingw didn't have git when we set this stuff up. it does now?
[01:25:56] <graydon> (which mingw?)
[01:26:03] <Thad> that's the msysgit with includes..... ah, gotcha... yes, it does now.
[01:26:33] <Thad> follow the "new" way... I've documented it thus far... https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust#windows
[01:27:25] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[01:27:30] <tjc> Thad: great! Maybe those instructions will help me actually get a Windows VM going on my machine one of these days...
[01:27:35] <tjc> one with Rust on it, at any rate
[01:27:42] <vermeille> Why doest it depends on *perl* ._. ?
[01:27:50] <Thad> Step 6 is the problem child I need help with...
[01:27:56] <tjc> well, what doesn't depend on perl? :P
[01:28:07] <pcwalton> it's because LLVM depends on perl
[01:28:10] <vermeille> clang ?
[01:28:14] <vermeille> Ah.
[01:28:15] <tjc> I would assume mingw-get can install curl, but I don't remember if I had to do that or not...
[01:28:20] <vermeille> Bad random choice?
[01:28:30] <vermeille> :s/?/./
[01:28:33] <Thad> graydon: hmm, so msysgit .... looking into it now...
[01:30:06] <strcat> rust certainly fluctuates in size a lot
[01:30:06] <vermeille> So, these new steps are for 0.7 ?
[01:31:21] <Thad> vermeille: It's for building Rust, against Incoming...err, or Master I guess as well.
[01:31:28] <vermeille> tjc: I'm almost sure LUA does not depends on Perl!
[01:31:40] <tjc> vermeille: well, good for Lua :-)
[01:32:05] <strcat> http://ix.io/5DH ;p
[01:32:11] * strcat is going to end up with a thousand of these soon enough
[01:32:15] <vermeille> Lua depends on almost nothing. That's great :D
[01:32:58] <tjc>  strcat: are you making nightly builds?
[01:33:02] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[01:33:02] <strcat> yes
[01:33:06] <tjc> cool
[01:33:14] <tjc> a lot of people will be happy about that :-)
[01:33:19] *** Joins: eholk (eholk@moz-C345A84D.hsd1.ut.comcast.net)
[01:33:35] <strcat> tjc: they're arch linux packages, no idea if they work elsewhere
[01:33:39] <strcat> they probably work on fedora.... ;p
[01:33:43] <tjc> well, it's a start
[01:34:08] <strcat> I just set up a cronjob to build them every day on Arch's build server
[01:34:14] <strcat> + a repo
[01:34:33] <strcat> anyway now I get to watch the daily .1 or .2MiB changes in size ;p
[01:34:45] *** Quits: jclements (jclements@2557E599.66715431.D25A875A.IP) (Quit: jclements)
[01:34:47] *** Joins: sammykim (sammy.kim@5AB4884B.FCC4549.14D5B978.IP)
[01:35:32] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Connection reset by peer)
[01:35:33] *** Joins: maxli1 (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[01:35:35] <heftig> strcat: oh hey, there are actually some deltas lying around
[01:35:46] <heftig> 18M though. man, that sucks
[01:35:53] <strcat> yeah it usually fails to make them
[01:36:13] <strcat> heftig: I think it's because of rust's randomized hash table
[01:36:21] <graydon> ugh
[01:36:24] <graydon> this is ...
[01:36:27] <strcat> it results in changes across the code
[01:36:30] <graydon> it's not just TLS
[01:37:11] <graydon> I need to start building a gc profiler to figure this out
[01:37:19] <graydon> we're allocating way too many @-boxes
[01:37:39] <pcwalton> tcmalloc profiling doesn't help?
[01:37:39] <strcat> graydon: does the gc still use malloc/free?
[01:37:47] <graydon> strcat: yes
[01:37:57] <graydon> pcwalton: I don't know what that is / how to use it
[01:38:03] <tjc> 'night all
[01:38:06] *** Quits: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP) (Quit: Places to go, people to annoy)
[01:38:08] <pcwalton> strcat does :)
[01:38:12] <graydon> ok
[01:38:20] <strcat> graydon: it's part of gperftools (google perf stuff)
[01:38:23] <graydon> not tonight. I gotta go, I'm at the end of my rope.
[01:38:40] <strcat> can make a graph of memory usage from doing call traces
[01:38:46] <graydon> we're not going to be able to bootstrap 32bit until we can get actual-memory-use under control
[01:39:07] <graydon> can we build rust with tcmalloc?
[01:39:21] <pcwalton> I think it LD_PRELOADs in
[01:39:26] <graydon> ok
[01:39:32] <Thad> graydon: newest installer for MinGW actually downloads pthreads and installs when you choose C and C++ compiler checkboxes during setup... way cool.
[01:39:43] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[01:39:48] <graydon> yay
[01:39:51] <Thad> :)
[01:39:51] <strcat> graydon: we could also link against it
[01:39:53] *** Quits: maxli1 (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Connection reset by peer)
[01:39:56] <strcat> it's a better allocator than glibc's
[01:40:18] <strcat> I think it uses a bit more memory though.... so that would be counterproductive ;p
[01:40:32] <strcat> they tune it for chromium where they don't have to worry much about VM
[01:40:38] <heftig> strcat: i think valgrind has a profiler as well?
[01:40:43] <strcat> heftig: yeah, massif
[01:40:58] <graydon> I've run it under massic
[01:41:03] <graydon> massif
[01:41:06] <strcat> I like tcmalloc, it makes nice graphs
[01:41:12] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[01:41:13] <strcat> dunno if massif can
[01:41:28] <Thad> strcat: cut do you UNDERSTAND the graphs ? :)
[01:41:36] <graydon> it was hard to understand. I will re-run. tomorrow.
[01:41:38] <graydon> too sad now
[01:41:40] <graydon> gotta go
[01:41:43] <strcat> graydon: \o
[01:41:46] <graydon> o/
[01:41:48] <Thad> nite
[01:41:48] <strcat> Thad: yes
[01:41:51] *** Quits: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP) (Quit: Leaving.)
[01:41:53] <strcat> Thad: the raw output, not so much :)
[01:41:54] <Thad> cool
[01:42:41] *** Quits: lkuper (lkuper@moz-D6AAFF3.cs.indiana.edu) (Ping timeout)
[01:42:54] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[01:43:23] <heftig> strcat: or DHAT, i guess?
[01:46:41] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[01:49:47] <strcat> it doesn't seem to resolve all the symbols properly :(
[01:50:08] <strcat> http://ix.io/5DI
[01:50:13] <strcat> the graph makes more sense than text output ;p
[01:54:35] <Thad> strcat: Use OpenRefine on that text output... :) (I'm a contributor / tester)
[01:55:31] <strcat> it has a bunch of output types
[01:55:46] <strcat> didn't realize it had callgrind output for kcachegrind
[01:55:55] <strcat> but that's probably not for heap profiling...
[01:58:42] *** Quits: ssbr (ssbr@moz-673B6A0E.wireless.utoronto.ca) (Ping timeout)
[02:00:26] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Client exited)
[02:00:30] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[02:00:30] <cmr> strcat: how does tcmalloc compare to jemalloc perf-wise?
[02:00:47] *** Quits: zq (p@moz-4A6945B7.de) (Quit: leaving)
[02:00:48] <strcat> cmr: generally faster
[02:00:56] <strcat> jemalloc specializes for thread pools
[02:01:13] <strcat> tcmalloc is better for small objects and dealing with newly spawned threads
[02:01:44] <cmr> awesome, thanks!
[02:02:14] <strcat> glibc's one has lower, more stable VM usage afaik
[02:02:26] <strcat> more conservative/slower
[02:05:05] <strcat> cmr: http://goog-perftools.sourceforge.net/doc/tcmalloc.html those docs are out-of-date but it's pretty cool regardless
[02:05:28] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[02:07:06] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:07:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/l3bV9A
[02:07:06] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:07:25] <bjz> yay!
[02:07:36] <bjz> say hello to cond!
[02:07:42] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.0)
[02:07:46] <pcwalton> nice
[02:07:54] <strcat> maybe tcmalloc could actually reduce rust's memory usage since it doesn't round as much, dunno
[02:08:19] <strcat> I don't think it *releases* VM though, it just marks it as unused with madvise
[02:08:46] <strcat> which makes it not consume actual memory
[02:08:59] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:09:59] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:09:59] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/p1MWRA
[02:09:59] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:10:00] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[02:10:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/yNBlXQ
[02:10:00] <ghrust> 13rust/06auto 140c08204 15Youngsoo Son: Replace shared/unique by managed/owned in the tutorial
[02:10:00] <ghrust> 13rust/06auto 142fc6b09 15bors: auto merge of #6475 : sonwow/rust/tutorials, r=brson
[02:10:02] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[02:10:07] <cmr> gtkperf runs 8.74 vs 6.83 vs 7.10, glibc vs tcmalloc vs jemalloc
[02:10:56] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:11:20] *** Quits: catpig (catpig@moz-D807334F.dip0.t-ipconnect.de) (Quit: Verlassend)
[02:11:52] <brson> acrichto: I'm going to #[ignore] the rusti tests. They are failing on i686: http://buildbot.rust-lang.org/builders/incoming-full-linux/builds/1218/steps/test/logs/stdio
[02:12:14] <cmr> and uses less virt/res than glibc, so it's probably a win overall
[02:12:23] <cmr> (obviously a simplistic benchmark)
[02:12:27] <strcat> cmr: afaik glibc rounds to powers of two now
[02:12:28] <acrichto> brson: oh dear that's not good, feel free though
[02:12:33] <strcat> I don't think tcmalloc has to round
[02:12:42] <brson> acrichto: re: testing in parallel, --test will run serially when RUST_THREADS=1. we could modify the makefiles to set this when running rusti tests, or maybe add a crate attribute to force it
[02:13:22] <acrichto> brson: the bad part about only setting that in the Makefile is that if they're ever run manually they'll fail
[02:13:31] <acrichto> brson: a crate attribute would be nice though
[02:13:50] <strcat> cmr: use tcmalloc_minimal.so btw
[02:13:56] <strcat> the other ones have the heap profiling stuff
[02:14:02] <strcat> probably doesn't make a difference ;p
[02:14:45] <cmr> yeah, no significant difference
[02:14:52] <brson> acrichto: better still would be to make rustc use llvm threadsafely
[02:14:52] <strcat> it makes a nice impact on std::treemap
[02:15:08] <acrichto> brson: that would be nice :)
[02:15:14] <brson> acrichto: maybe as a temporary measure we could put a global lock around trans
[02:15:42] <acrichto> brson: I'll look into it and open an issue if one doesn't exist
[02:15:51] <acrichto> I've also got a linux vm lying around that I think I can try to debug this ine
[02:15:59] <strcat> cmr: http://ix.io/5DL (glibc), http://ix.io/5DK (tcmalloc)
[02:16:02] <strcat> that's pretty... awesome.
[02:16:22] *** Quits: jgilbert (jgilbert@2557E599.66715431.D25A875A.IP) (Input/output error)
[02:17:32] <strcat> nice impact on core::hashmap and core::vec too.
[02:17:42] <strcat> just ~5% though
[02:18:01] * strcat tries jemalloc
[02:18:31] <strcat> I guess I can just test thread scaling by running the core map benchmark in tasks...
[02:21:00] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[02:21:38] <strcat> both tcmalloc/jemalloc consume a lot less memory than glibc's allocator...
[02:21:47] <strcat> they seem to make the actual treenode allocation 2x smaller, at least
[02:22:10] <cmr> not bad!
[02:22:50] *** Quits: themgt (themgt@moz-F5F3FFDF.dhcp.gnvl.sc.charter.com) (Quit: themgt)
[02:23:55] <doy> what sorts of things is the glibc allocator good at?
[02:24:15] <cmr> doing poorly in benchmarks, it seems ;)
[02:24:43] <doy> (:
[02:24:48] <strcat> doy: it's just not really as good, they prefer keeping it simple/predictable over raw perf afaik
[02:24:55] <strcat> and... it releases VM ;p
[02:25:38] <cmr> strcat: glibc had the most VM usage in my gtkperf test
[02:25:55] <strcat> cmr: yeah it consumes more VIRT/RES for a certain # of allocations
[02:26:05] <strcat> but when you free them, glibc will release some VIRT
[02:26:18] <strcat> tcmalloc will never give up VIRT, it will just MADV_DONTNEED on it to drop the RES usage
[02:26:20] <cmr> I'd asume that at the end, gtkperf has freed everything
[02:26:30] <cmr> but that assumption could very well be wrong
[02:26:36] <strcat> cmr: it's wrong :)
[02:26:41] <strcat> gtk leaks memory, intentionally
[02:26:51] <strcat> they leak anything that's a one-time allocation on purpose
[02:27:00] <strcat> really, really annoying to use valgrind with a gtk/glib program
[02:27:01] <seth> so i have a method that does "match *self" that calls another method from within the match that also does "match *self". this causes a dynamic failure
[02:27:08] <seth> how can i make that work?
[02:27:37] <strcat> seth: it's @mut?
[02:28:09] <seth> strcat: it's "&self". i don't understand why this fails
[02:28:17] <strcat> seth: but are there @mut in the object?
[02:28:22] <strcat> what's the dynamic failure?
[02:28:44] <seth> strcat: oh yeah, there totally are
[02:29:03] <strcat> well @mut enforces freezing dynamically
[02:29:12] <seth> strcat: rust: task failed at 'borrowed', /Users/mfowler/Code/servo/src/servo/layout/box.rs:172
[02:29:19] <strcat> yep that's from @mut
[02:29:27] <strcat> if you borrow it as & and modify it, that will fail
[02:29:42] <pcwalton> it should be giving you a better error than that
[02:29:49] <pcwalton> I know that sometimes it doesn't work
[02:29:55] <pcwalton> and I don't understand why the better error message doesn't work
[02:30:01] <seth> i'm not modifying it though.. just matching on it
[02:30:05] <pcwalton> it should tell you where the bad borrow happened
[02:30:11] <seth> oh crud, unless style() does..
[02:30:12] <pcwalton> so what it means is
[02:30:20] <strcat> seth: borrowing as &mut also has to be unique
[02:30:22] <pcwalton> you've got an &mut reference inside
[02:30:28] <pcwalton> and you are taking another & reference
[02:30:30] <strcat> if you do &mut and then & or & and then &mut it will fail
[02:30:36] <pcwalton> that's a mutable reference and an immutable reference
[02:30:38] <pcwalton> contradiction
[02:30:41] <pcwalton> therefore task failure :)
[02:30:42] <jack> you need to compile without optimization to get both borrow locations. otherwise you only get the second one.
[02:30:47] <pcwalton> oh, I see
[02:30:49] <pcwalton> yes
[02:30:51] <Jesse> ideally it would show you where both borrows happened
[02:30:53] <pcwalton> use CFG_DISABLE_OPTIMIZE=1 make
[02:30:57] <pcwalton> Jesse: it does
[02:31:01] <pcwalton> only if you have optimization off
[02:31:24] <jack> i ran into this on friday, so it's still fresh in my mind :)
[02:31:26] <seth> jack: ideally i'd get the call stacks... the actual failure is in with_imm_base.. not very helpful
[02:31:32] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130506154904])
[02:31:35] <pcwalton> seth: use gdb to get the call stack
[02:31:40] <jack> seth: with both locations it's not too hard to track down.
[02:31:54] <seth> pcwalton/jack: thanks, i'll give it a shot
[02:31:57] <jack> but yes, a call stack would be even faster.
[02:32:01] <pcwalton> break on upcall_fail
[02:32:05] <pcwalton> there is a call stack on linux i think
[02:32:09] <pcwalton> but on mac it's not implemented
[02:32:24] <jack> pcwalton: it gets hard to understand the call stack in gdb with lots of closures.
[02:32:24] <seth> lucky me =)
[02:32:27] <strcat> pcwalton: in gdb?
[02:32:34] <pcwalton> in rust
[02:32:40] <pcwalton> it should automatically print out call stacks when it fails.
[02:32:41] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[02:32:44] <pcwalton> the rust runtime should
[02:32:56] * strcat hasn't seen it do that
[02:33:06] <pcwalton> maybe it was 2 years ago that it did that
[02:33:09] <pcwalton> at some point it did
[02:33:18] <cmr> RUST_LOG=::rt::backtrace
[02:33:25] <pcwalton> that was it
[02:33:31] <strcat> oh
[02:33:33] <pcwalton> I don't think it works on mac though
[02:33:39] <pcwalton> at least, for me
[02:33:40] <jack> i'm curious, why is the :: prefix needed there?
[02:33:58] <pcwalton> because it's in C++ code I think
[02:34:00] <pcwalton> just legacy junk
[02:34:02] <cmr> is it actually needed? I don't know
[02:34:03] <pcwalton> it should all be in rust
[02:34:34] <jack> cmr: i don't know if it's needed, but the compiler shows it in the error message it generates.
[02:35:33] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90-rdmsoft [XULRunner 18.0.2/20130201065344])
[02:35:34] <cmr> strcat: Is not releasing VM bad, though? I assume it reuses the address space it as when mallocing after a free
[02:35:43] <strcat> cmr: yeah it doesn't really matter
[02:35:54] <strcat> that's why they don't release it ;p
[02:35:59] <cmr> mmm
[02:36:08] <strcat> it's an easy way to cheat
[02:36:30] <strcat> they avoid munmap/mmap calls and just get page faults
[02:38:13] <cmr> seems like using tcmalloc would be an easy win
[02:38:22] <strcat> jemalloc seems to have invented the madvise trick
[02:38:29] <strcat> so both of them aren't returning VM to the system
[02:40:33] <pcwalton> nmatsakis: ping
[02:41:40] <pcwalton> nmatsakis: so you'll see it when you come back: the borrow check debugging stuff seems to make compiling 4x-5x slower for me when optimization is off even when RUST_DEBUG_BORROWS is off
[02:41:44] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[02:41:47] <pcwalton> nmatsakis: I think we should move it behind -g
[02:43:34] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[02:46:34] <strcat> cmr: yeah I think it's better to go with tcmalloc for now because jemalloc still has issues with newly spawned threads
[02:46:42] <strcat> well, with ephemeral threads
[02:46:56] <strcat> it spins up a new thread cache and frees it each time
[02:50:50] *** Joins: T (snova@moz-30CA56A4.static.aldl.mi.charter.com)
[02:53:48] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[02:54:29] <pcwalton> brson: r? https://github.com/mozilla/rust/pull/6491
[02:54:40] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[02:55:05] *** Quits: zz_kimundi (kimundi@moz-EAE9DA5A.dip0.t-ipconnect.de) (Ping timeout)
[02:57:08] <bjz> ooh, and so we get closer to extern fn pointers
[02:57:11] <bjz> :)
[02:58:08] *** Joins: zz_kimundi (kimundi@moz-6E61DCDA.dip0.t-ipconnect.de)
[02:58:33] *** zz_kimundi is now known as kimundi
[03:00:43] <brson> how do i copy something to the X clipboard from the command line?
[03:00:57] <aatch> brson, middle-click might work
[03:01:11] <brson> aatch: i should have been more clear. I want to cat a file to the clipboard
[03:01:18] <brson> my thing doesn't fit on the screen
[03:01:22] <sp3d> xclip?
[03:01:33] <cmr> xsel -ib < file, is what I use
[03:02:21] * aatch uses vim to copy the clipboard
[03:04:55] <brson> thanks. xclip worked
[03:06:56] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[03:06:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/yNBlXQ
[03:06:56] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[03:09:51] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[03:09:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/faVVKg
[03:09:51] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[03:09:53] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[03:09:53] <ghrust> 01[13rust01] 15bors pushed 31 new commits to 06auto: 02http://git.io/cpcn2Q
[03:09:53] <ghrust> 13rust/06auto 1434be071 15Brian Anderson: core::rt: Remove Close trait...
[03:09:53] <ghrust> 13rust/06auto 140b4d4ed 15Brian Anderson: core::rt: Fix a warning about unnecessary mutable variable
[03:09:53] <ghrust> 13rust/06auto 14b2fbd34 15Brian Anderson: core::rt: Begin implementing TcpStream...
[03:09:55] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[03:11:09] *** Joins: themgt (themgt@moz-692B8AEF.dhcp.gnvl.sc.charter.com)
[03:11:36] *** Quits: themgt (themgt@moz-692B8AEF.dhcp.gnvl.sc.charter.com) (Quit: Pogoapp - http://www.pogoapp.com)
[03:13:40] <cantsin> are there any code examples or blog posts demonstrating std::arc?
[03:15:19] <cmr> is rustdoc broken? it's taking a /really/ long time to make documentation..
[03:15:38] <strcat> cmr: don't think so
[03:16:14] <aatch> cantsin, this should help: http://winningraceconditions.blogspot.co.nz/2012/09/rust-4-typesafe-shared-mutable-state.html
[03:16:27] <aatch> it's from bblum's blog
[03:16:27] *** Joins: jdm (jdm@DB05BBF2.BB1F48F2.971E19F6.IP)
[03:16:45] <cantsin> aatch: thanks!
[03:18:12] <cmr> futex(0x7f24ee995880, FUTEX_WAIT_PRIVATE, 2, {0, 168955296}) = -1 ETIMEDOUT (Connection timed out)
[03:18:20] <cmr> in all of the rustdoc processes...
[03:19:00] <strcat> cmr: you have a working pandoc, right?
[03:19:12] <bblum> cantsin: the previous post demonstrates just plain ARC
[03:19:16] <cmr> strcat: it should be working; it was working last time I did a full build
[03:19:19] <bblum> http://winningraceconditions.blogspot.com/2012/09/rust-3-typesafe-shared-state.html
[03:19:29] <cmr> you're the maintainer on arch, right? did you break it recently? :p
[03:19:42] <aatch> rusti: 1
[03:19:47] <rusti> 1
[03:19:49] <cantsin> bblum: thanks, i was reading that just now :P
[03:19:53] <aatch> nope
[03:20:19] <cmr> well, let's try again with haskell-pandoc-1.11.1-6
[03:21:11] <T> Why is it that I can "use" something at top-level, but then it's not visible from sub-modules within that file? This seems different from every other language I can think of
[03:22:41] <cmr> strcat: same with the new pandoc
[03:23:12] <strcat> cmr: it still works for me ;p
[03:23:21] <strcat> pandoc -6 was just to add replaces/conflicts/provides
[03:24:00] <cmr> I've already torched my build directory, so it's not a dirty build
[03:24:15] <cmr> bleh, I'll tackle it tomorrow
[03:25:53] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[03:26:03] <jld> T: Visibility used to be inherited like that, and then it was changed.  I've forgotten exactly why, but someone else might know (or have a link to where it was discussed).
[03:26:14] <jld> Er.  Visibility.  Importedness?  Something like that.
[03:27:42] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[03:28:08] *** Joins: inolen (Adium@moz-FA2406D8.socal.res.rr.com)
[03:29:31] <T> Rust seems to be full of these little "wtf?!" moments. Also compiler crashes, though those may have been fixed already.
[03:29:46] <Diablo-D3> okay so
[03:29:49] <Diablo-D3> erlang has otp
[03:30:00] <Diablo-D3> will rust ever get anything like that?
[03:30:07] <strcat> jld: it was changed to make it coherent afaik
[03:30:20] <strcat> the way it is right now is just to make it sane to implement correctly
[03:30:41] <strcat> so it will probably become less restrictive
[03:30:56] <strcat> T: well it's an alpha after all ;p
[03:31:10] <aatch> T, as for crashes, it's an alpha programming language
[03:31:30] <doomlord> to  be expected
[03:32:04] <T> Oh, of course; I just wasn't expecting it to this degree
[03:32:59] <strcat> rusti: 1
[03:33:01] <rusti> 1
[03:33:19] <strcat> rusti: core::run::run_program("rustc", [~"--version"]);
[03:33:20] <rusti> rustc 0.6 (043d022 2013-05-14 14:05:07 -0700)
[03:33:21] <rusti> host: x86_64-unknown-linux-gnu
[03:34:22] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[03:35:34] <cantsin> for std::arc, am i correct in surmising that the "move" parameter is no longer needed/supported? e.g., "do task::spawn |move arc2| {  // gives child ownership of 2nd handle"
[03:36:00] <doomlord> could anyone comment how hard it would be to contribute a fix for the macro system , for someone who doesn't yet know the compiler... (currently the macros only instantiate 1 statement, with the  'wrap it in a mod' workaround)
[03:36:35] <strcat> doomlord: I think that would be hard to fix
[03:36:44] <strcat> afaik it involves changing how the parser works
[03:38:42] <brson> cantsin: yes
[03:39:21] <cantsin> brson: ok. i'm still getting "capture of moved value" errors, i guess i'll play around with it a bit more. thanks.
[03:42:14] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[03:42:51] <brson> cantsin: try cloning the arc then capturing the clone
[03:43:50] *** Quits: jdm (jdm@DB05BBF2.BB1F48F2.971E19F6.IP) (Quit: Lost terminal)
[03:43:59] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[03:44:52] <cantsin> brson: yea, trying to do so :P does it matter if it is in a loop?
[03:45:27] <brson> cantsin: yes, if you are capturing in the loop then each capture will need a clone
[03:46:29] *** Joins: chadz1 (chadz@moz-6EE80298.tukw.qwest.net)
[03:46:30] <cantsin> brson: i see.
[03:47:34] *** Joins: rf (rollyfordh@moz-F5A7A7AB.dyn.iinet.net.au)
[03:48:12] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[03:48:31] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:49:32] <cantsin> brson: got it working, thanks! you were very helpful.
[03:50:33] <strcat> rusti: fn foo() { loop { do spawn { core::run::run_program("cat", []) } } } foo()
[03:50:36] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/CBBU
[03:50:46] <strcat> rusti: fn foo() { loop { do spawn { core::run::run_program("cat", []); } } } foo()
[03:50:55] <brson> cantsin: np!
[03:51:04] <strcat> rusti: 5
[03:51:05] <rusti> 5
[03:51:13] <bjz> how does one use a type in a HashMap? does it have to implement something?
[03:51:27] <strcat> bjz: Hash and Eq
[03:51:32] <strcat> on the key
[03:51:39] <strcat> neither the key/value has to be copyable/cloneable
[03:51:41] <bjz> strcat: is there a deriving for that?
[03:52:07] <strcat> I think there's deriving for IterBytes (which gives you Hash) but it's incorrect-ish
[03:52:15] <bjz> hm
[03:52:24] <strcat> only in a performance/security sense
[03:52:41] <strcat> bjz: what's your key type?
[03:52:44] <bjz> I want to use `pub struct Window { ptr: *::ml::GLFWwindow }` as a key
[03:53:08] <strcat> bjz: is the address guaranteed to be unique?
[03:53:16] <bjz> yah
[03:53:22] <bjz> it's a window handle
[03:53:36] <strcat> bjz: just impl IterBytes by casting the ptr to a uint and reusing that impl
[03:53:43] <strcat> dunno if deriving will work
[03:55:38] <brson> strcat: you are an r+ ninja. so fast!
[03:55:47] <brson> bbl #rust
[03:55:48] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Quit: leaving)
[03:57:09] *** Quits: jorendorff (jorendorff@moz-4BE034AB.ptr.us.xo.net) (Quit: jorendorff)
[04:00:50] *** Joins: ysuzuki_ (ysuzuki@moz-5146769F.st.itc.keio.ac.jp)
[04:00:51] *** Quits: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp) (Connection reset by peer)
[04:04:23] <strcat> rusti: let be = 5; be
[04:04:24] <rusti> foo.rs:5:13: 5:15 error: `be` is a reserved keyword
[04:04:24] <rusti> foo.rs:5          let be = 5; be
[04:04:24] <rusti>                       ^~
[04:04:42] <strcat> rusti: let m32 = 5; m32
[04:04:43] <rusti> 5
[04:04:55] <strcat> rusti: let f16 = 5; f16
[04:04:56] <rusti> 5
[04:05:02] <strcat> rusti: let drop = 5; drop
[04:05:04] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/WTWg
[04:05:52] <bjz> Jesse: ping
[04:07:59] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Client exited)
[04:11:08] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[04:11:56] <bjz> Jeaye: oh wait, fixed it
[04:12:07] <Jeaye> HMM?
[04:12:12] <Jeaye> Caps, sorry
[04:12:12] *** Quits: eholk (eholk@moz-C345A84D.hsd1.ut.comcast.net) (Quit: eholk)
[04:12:15] <bjz> Jeaye: updated the linking in GLFW
[04:12:26] <bjz> Jeaye: was broken on the latest rust
[04:12:35] <Jeaye> mmk
[04:12:39] <Jeaye> Pulling
[04:12:52] *** Joins: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP)
[04:15:16] *** Quits: rf (rollyfordh@moz-F5A7A7AB.dyn.iinet.net.au) (Quit: rf)
[04:15:37] <bjz> Jeaye: holy cow: https://github.com/bjz/glfw-rs/commit/347eacae19d3eac1898f7d2c30c1c567c7f0d18f
[04:16:05] <bjz> argument destructuring ftw
[04:16:13] <bjz> dbaupp: hoya
[04:16:17] <Jeaye> Nice.
[04:18:41] <bjz> strcat: why doesn't HashMap impl Index?
[04:18:51] <Luqman> strcat: any reason drop is still a reserved keyword?
[04:19:11] <strcat> Luqman: I think it requires a snapshot
[04:19:23] <strcat> 'be' is the only one that's really reserved afaict
[04:19:29] <dbaupp> bjz: hey
[04:19:37] <dbaupp> fireglow: 
[04:20:49] <Luqman> strcat: a snapshot is needed to just remove it from the list? it doesn't seem like there are any drop blocks left
[04:21:09] <strcat> Luqman: oh then it could probably be removed now
[04:21:20] <bjz> dbaupp: what do you mean by 'polynomial' in the context of your comments?
[04:22:16] *** Quits: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP) (Input/output error)
[04:22:24] <strcat> bjz: Index just kind of sucks ;p
[04:22:30] *** Joins: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP)
[04:22:33] <strcat> foo[5] = 2; // can't do that
[04:22:45] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:22:48] <strcat> all you can have is
[04:22:52] <strcat> let x = foo[5];
[04:23:01] <strcat> where it essentially does .find(&5).unwrap()
[04:23:45] <bjz> strcat: hopefully that can be fixed
[04:23:53] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[04:24:00] <strcat> I could implement it in core::container for all maps
[04:24:31] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Ping timeout)
[04:24:52] <Luqman> there should probably be another lang item, index-assign or something
[04:25:18] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[04:26:05] *** Quits: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP) (Ping timeout)
[04:26:06] <strcat> it's just annoying that vectors are different.
[04:26:16] *** Joins: heftig_ (heftig@moz-25EC2EF9.dip0.t-ipconnect.de)
[04:26:22] *** Joins: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP)
[04:26:24] <strcat> a[0] for a value, &a[0] for a ref, &mut a[0] for a mut ref
[04:26:30] *** Quits: heftig (heftig@moz-E2CF292F.dip0.t-ipconnect.de) (Ping timeout)
[04:26:41] <strcat> meanwhile for Index you pretty much have to just implement a[0] for a ref
[04:27:21] <bjz> Luqman: https://github.com/mozilla/rust/issues/5992
[04:27:49] <bjz> strcat: it would be nice if vectors just impled Index
[04:28:09] <strcat> bjz: how will Index distinguish & and &mut?
[04:28:15] <strcat> Index just seems flawed atm
[04:28:20] <strcat> needs to be thrown out and done over
[04:28:33] <strcat> it should work *exactly* like vectors
[04:28:33] <bjz> strcat: I'm not saying in its current incarnation
[04:28:38] <Luqman> bjz: not sure what graydon means by "users will have nothing left to stand on"
[04:28:45] <strcat> bjz: I know ;p
[04:28:48] <bjz> Luqman: neither
[04:29:05] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[04:29:07] <strcat> Luqman: because = doesn't do the same thing as C++
[04:29:10] <strcat> it does a move, always
[04:29:29] <strcat> a = b; in C++ is a = b.clone(); in rust
[04:30:04] <Jeaye> With the new extern syntax, to types need to be differently scoped?
[04:30:13] <strcat> so there's really no way to overload it imo
[04:30:17] <Jeaye> I'm getting error: use of undeclared type name `c_int`
[04:30:24] <Jeaye> Along with a ton of others.
[04:30:30] <strcat> could just replace 'a = b.clone()' with 'a.assign(&b)'
[04:30:32] <strcat> for efficiency
[04:30:48] <bjz> Jeaye: where?
[04:31:08] <Jeaye> bjz: rust-stb-image for Servo
[04:31:36] <Jeaye> I tried adding super:: but it didn't cut it.
[04:31:38] <strcat> anyway needs a default method
[04:31:44] <Jeaye> So I'm not sure what needs to be changed.
[04:31:51] <strcat> by default a.assign(&b) could do *a = b.clone()
[04:31:55] <dbaupp> bjz: polynomial like `1 + 2x**2 + 3x**3`
[04:32:00] <strcat> and then you could override it to reuse a's resources
[04:33:16] <dbaupp> bjz: they have a well defined modulo operation
[04:33:53] <bjz> dbaupp: so you mean a new type in std::num?
[04:34:05] <bjz> dbaupp: or just as a trait in core::num?
[04:34:20] <dbaupp> bjz: I was thinking a user-defined/external library
[04:34:27] <bjz> ok
[04:34:37] <dbaupp> but it's nice when you can integrate that stuff into the standard library functions
[04:34:39] <chadz1> is there a doc that explains the difference between clone/to_owned/copy ?
[04:34:42] <bjz> dbaupp: so how does that affect our traits?
[04:34:52] <bjz> dbaupp: any suggestions?
[04:35:14] <dbaupp> bjz: not really sure... I'll have to think
[04:35:14] <strcat> chadz1: the 'copy' keyword is going to go away
[04:35:17] <strcat> you can consider it deprecated
[04:35:31] <strcat> use clone and #[deriving(Clone)] instead
[04:36:11] <strcat> anything else (like to_owned) is just a library function specific to a type
[04:38:18] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[04:38:34] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[04:38:48] <chadz1> so, i noticed this:  type `&str` does not implement any method in scope named `clone`
[04:39:16] <strcat> borrowed pointers and slices don't implement Clone right now
[04:39:35] *** Quits: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP) (Ping timeout)
[04:40:05] *** Joins: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP)
[04:41:24] <chadz1> ah, makes sense. thx
[04:41:35] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[04:42:41] *** Quits: joone (joone@2BD403F.16ABCAEA.68255BF8.IP) (Ping timeout)
[04:42:44] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[04:43:37] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[04:44:30] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[04:44:31] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[04:46:12] *** Joins: joone (joone@E10A1781.2160464A.A34EC3BB.IP)
[04:46:14] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Input/output error)
[04:46:28] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[04:47:19] *** Quits: dbaupp (Thunderbir@A9958C79.D5A1DCF.37681C44.IP) (Ping timeout)
[04:53:21] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:54:04] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Connection reset by peer)
[04:54:31] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Ping timeout)
[04:54:40] *** Joins: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp)
[04:54:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[04:54:56] *** Quits: katis (katis@40C8AF65.EFDC2270.EE6E63A5.IP) (Ping timeout)
[04:55:14] *** Quits: ysuzuki_ (ysuzuki@moz-5146769F.st.itc.keio.ac.jp) (Connection reset by peer)
[04:55:14] *** Joins: katis (katis@40C8AF65.EFDC2270.EE6E63A5.IP)
[04:55:38] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[04:56:20] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[05:01:44] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:01:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141109633 to 142fc6b09: 02http://git.io/N3iJvQ
[05:01:44] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:01:48] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:01:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/WQO2bQ
[05:01:48] <ghrust> 13rust/06auto 147ba685c 15BjÃ¶rn Steinbrink: Add inlining for iter_bytes for types used as hashmap keys...
[05:01:48] <ghrust> 13rust/06auto 1431cedf6 15bors: auto merge of #6478 : dotdash/rust/inlining, r=catamorphism...
[05:01:49] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:06:48] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[05:08:16] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[05:13:54] *** Joins: brson (brson@E9CDE21E.991753BB.CA4D1600.IP)
[05:13:54] *** ChanServ sets mode: +o brson
[05:15:28] *** Quits: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp) (Client exited)
[05:16:00] *** Joins: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp)
[05:16:55] *** Quits: ysuzuki (ysuzuki@moz-5146769F.st.itc.keio.ac.jp) (Client exited)
[05:20:04] *** Quits: katis (katis@40C8AF65.EFDC2270.EE6E63A5.IP) (Ping timeout)
[05:20:04] *** Quits: n0vember (n0vember@moz-690FFF9D.org) (Ping timeout)
[05:20:33] *** Quits: brson (brson@E9CDE21E.991753BB.CA4D1600.IP) (Ping timeout)
[05:20:39] *** Quits: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net) (Ping timeout)
[05:21:15] *** Quits: benh (ben@moz-4A0366D2.org) (Ping timeout)
[05:21:15] *** Quits: Flibo (Flibo@moz-40397852.org.aalto.fi) (Ping timeout)
[05:21:48] *** Joins: katis (katis@40C8AF65.EFDC2270.EE6E63A5.IP)
[05:21:58] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[05:22:05] *** Joins: brson (brson@E9CDE21E.991753BB.CA4D1600.IP)
[05:22:05] *** ChanServ sets mode: +o brson
[05:22:30] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[05:22:52] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[05:23:29] *** Joins: n0vember (n0vember@moz-690FFF9D.org)
[05:24:26] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:24:31] *** Joins: benh (ben@moz-4A0366D2.org)
[05:24:32] *** Joins: Flibo (Flibo@moz-40397852.org.aalto.fi)
[05:26:10] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[05:27:54] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[05:30:13] <bjz> nmatsakis: ping
[05:31:31] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[05:31:37] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:32:12] <steven_is_false> Wow! I just figured out the strangest edge detection algorithm. Randomly scatter black dots over a 3d surface. When mapped to a 2d surface the edges will have the black dots clustered together, and the non-edges won't!
[05:32:15] <bjz> is it possible to store a mutable HashMap in tls?
[05:32:29] <strcat> bjz: it should be
[05:32:30] <strcat> afaik
[05:32:49] <strcat> it's an owned type
[05:33:42] <bjz> the tls key has to be in the form: fn tls_key(_: @MyType) {}
[05:34:25] <strcat> well then no unless it doesn't require Const
[05:34:33] <strcat> using @mut or Cell would be messy though
[05:34:37] <strcat> I don't know if TLS is sound
[05:34:45] <bjz> hum
[05:35:22] <bjz> I'm trying to store a hash map of window data in TLS
[05:38:52] <ssbr_> steven_is_false: that only works when the "edge" is actually a face at a steep angle, surely?
[05:39:03] <steven_is_false> ssbr_: Correct!
[05:39:41] <steven_is_false> ssbr_: At least I think I'm correct. I may be wrong.
[05:39:50] <ssbr_> it should be correct
[05:40:04] <ssbr_> that the algorithm is incorrect
[05:40:09] <ssbr_> this is getting confusing
[05:41:23] <steven_is_false> ssbr_: This reminds me of Monte-Carlo integration.
[05:42:43] <aatch> Making a package using ABS: easy. Making PHP play nice with it: HARD
[05:43:01] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[05:43:12] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Client exited)
[05:43:15] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[05:44:58] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[05:45:04] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[05:45:21] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:46:28] <bjz> strcat: https://gist.github.com/bjz/25c2d09a8946e9439ea5
[05:47:30] <strcat> I don't really understand why TLS uses @
[05:47:53] <brson> strcat: it needs to not use @. there's an issue open
[05:48:08] <strcat> ah so it's a known issue
[05:48:29] <strcat> brson: was there a reason for implementing it with @ though?
[05:49:08] <brson> https://github.com/mozilla/rust/issues/6004
[05:49:29] <brson> strcat: I don't know one
[05:49:37] <bjz> brson: https://gist.github.com/bjz/25c2d09a8946e9439ea5
[05:49:51] <bjz> I got it to compile, but I'm not sure it's right
[05:50:35] <bjz> brson: I want to be able to get a WindowData struct from the map, and add a callback to it
[05:50:54] <bjz> or should I say, mutate a callback within it
[05:51:01] <Jesse> https://twitter.com/technomancy/status/334526950792105984
[05:52:41] *** Joins: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net)
[05:52:44] <steven_is_false> Jesse: I guffawed
[05:52:49] <ssbr_> rusti: let x = str::as_c_str("a", |x| x as *libc::c_schar); unsafe {*x}
[05:52:51] <rusti> 97
[05:53:00] <ssbr_> somehow I didn't expect that to work. Welp.
[05:53:11] <strcat> ssbr_: "foo" has a 'static lifetime
[05:53:17] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:53:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/WQO2bQ
[05:53:17] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:53:20] <strcat> so it's actually safe/correct to do that
[05:53:24] <ssbr_> strcat: I didn't expect "x as *libc::c_schar" to work
[05:53:28] <strcat> oh ;]
[05:53:30] <ssbr_> I did expect the rest to work
[05:53:43] <ssbr_> it's just that I thought you couldn't cast pointers this way. Maybe it only works for raw pointers?
[05:54:18] <ssbr_> rusti: let x : uint = 0; let y = &x; let z = y as &int; *z
[05:54:21] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/DFUJ
[05:54:36] <ssbr_> Yeah, see, I expected that to happen
[05:54:41] <ssbr_> I guess raw pointers are special though
[05:57:14] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[05:58:56] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[05:59:16] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:59:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Pfgpfw
[05:59:16] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[05:59:18] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[05:59:18] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/mc0qxQ
[05:59:18] <ghrust> 13rust/06auto 14191fdda 15Erick Tryzelaar: rustc: minor cleanup
[05:59:18] <ghrust> 13rust/06auto 149c80cf5 15Erick Tryzelaar: rustc: Remove ty::arg
[05:59:18] <ghrust> 13rust/06auto 144bfe0f7 15Erick Tryzelaar: rustc: rename some ty_self variables to self_arg
[05:59:20] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:11:29] <brson> bjz: your tls gist looks ok to me
[06:12:03] <bjz> brson: should `struct WindowDataMap(HashMap<Window, WindowData>);` be `struct WindowDataMap(HashMap<Window, @mut WindowData>);` ?
[06:13:58] <steven_is_false> So, does anyone here have experience with OpenGL? I think my idea for edge detection only works if I sample at a high resolution, and I'm only doing it per vertex. I need an extra stage between the fragment shader, and the vertex shader.
[06:14:58] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Connection reset by peer)
[06:15:09] <brson> bjz: I think you can mutate your WindowData by using the find_mut method on the map
[06:15:19] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:15:38] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (Ping timeout)
[06:15:56] *** Quits: dju (dju@moz-83BD5EC.dmz.me) (Ping timeout)
[06:16:14] *** Joins: dju (dju@moz-83BD5EC.dmz.me)
[06:17:13] <steven_is_false> Anyways, I'm going to check in at a different chat room to look for help.
[06:17:17] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[06:19:00] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[06:20:48] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[06:26:07] <bjz> brson: hmm: https://gist.github.com/bjz/25c2d09a8946e9439ea5
[06:28:12] <bjz> brson: this is pretty ugly, but it won't be user-facing
[06:29:16] <brson> bjz: oh yes if you are trying to get an @mut WindowData then that's got to go in the map
[06:29:31] <brson> i didn't read closely enough
[06:33:06] <bjz> brson: now I get some weird warnings: https://gist.github.com/bjz/25c2d09a8946e9439ea5
[06:34:09] <Jeaye> Variables beginning with _ get invalid unused_mut warnings.
[06:35:12] <bjz> ?
[06:36:14] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[06:38:09] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:38:46] <Jeaye> Shown here: https://gist.github.com/Jeaye/cb196a4f88c86ce743e9
[06:38:52] <Jeaye> bjz: ^
[06:38:56] <Jeaye> Unless I'm missing something.
[06:39:13] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:40:20] <Jeaye> Ahh, it's being clever.
[06:41:44] <Jeaye> My mistake. >.<
[06:43:46] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[06:45:36] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[06:49:45] *** Parts: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) ()
[06:49:56] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:54:20] <bjz> brson: I think I have it working now. Thank you!
[06:58:06] *** Joins: jviereck (Adium@moz-A2DCE0DD.dclient.hispeed.ch)
[06:58:10] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:58:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/mc0qxQ
[06:58:10] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:00:59] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:00:59] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PH-7_A
[07:00:59] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:01:32] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Connection reset by peer)
[07:01:39] *** Quits: oyiptong (oyiptong@CD2A94.29EC3FEB.F9E1BAE1.IP) (Ping timeout)
[07:01:55] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[07:03:30] *** Quits: T (snova@moz-30CA56A4.static.aldl.mi.charter.com) (Quit: "")
[07:04:54] *** Joins: oyiptong (oyiptong@CD2A94.29EC3FEB.F9E1BAE1.IP)
[07:06:11] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[07:08:36] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzzZZZzzz)
[07:11:59] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:12:34] *** Joins: bs (bs@moz-AA189A5A.unitymedia.biz)
[07:12:43] *** bs is now known as doener
[07:19:28] *** Joins: cdidd (cdidd@moz-181A5896.broadband.corbina.ru)
[07:25:04] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Quit: home going)
[07:26:01] *** Quits: brson (brson@E9CDE21E.991753BB.CA4D1600.IP) (Quit: leaving)
[07:26:33] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[07:28:27] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[07:29:41] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Ping timeout)
[07:30:46] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[07:32:19] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[07:32:27] *** Quits: jclements (jclements@moz-20AD2EFB.dsl.static.sonic.net) (Quit: jclements)
[07:32:40] *** Joins: berak (chatzilla@63576BF3.3A27401E.16E13E53.IP)
[07:32:43] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke. It's all a joke.)
[07:38:32] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[07:44:17] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[07:45:11] *** Parts: berak (chatzilla@63576BF3.3A27401E.16E13E53.IP) ()
[07:46:10] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[07:52:22] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[07:53:29] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[07:54:09] *** Joins: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com)
[07:56:06] *** Joins: victorporof (victorporo@10AA7997.880C8D58.79933D60.IP)
[07:59:48] *** Joins: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP)
[08:00:11] *** Quits: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com) (Ping timeout)
[08:01:02] *** Joins: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com)
[08:04:24] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[08:04:36] *** Quits: disjukr (disjukr@D4D5F731.A5F7C7E2.84F431B6.IP) (Connection reset by peer)
[08:04:49] *** Joins: disjukr (disjukr@D4D5F731.A5F7C7E2.84F431B6.IP)
[08:05:39] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[08:05:47] *** Quits: chadz1 (chadz@moz-6EE80298.tukw.qwest.net) (Quit: WeeChat 0.4.0)
[08:06:52] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[08:07:47] *** Joins: beard-need-weed (c0@moz-4948B777.static.corbina.ru)
[08:08:36] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Connection reset by peer)
[08:08:54] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[08:09:49] *** Quits: blitter (blitter@moz-7C98731E.dyn.centurytel.net) (Ping timeout)
[08:11:38] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:11:57] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[08:13:31] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[08:13:52] *** Joins: fabiand (fabiand@moz-4A5FABA0.adsl.alicedsl.de)
[08:17:40] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Ping timeout)
[08:18:06] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[08:18:11] *** Quits: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com) (Quit: bbl)
[08:19:05] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[08:22:32] *** Quits: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org) (Ping timeout)
[08:22:48] *** Joins: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org)
[08:22:54] *** Quits: jessicah (jessicah@moz-B8A3AE25.massey.ac.nz) (Ping timeout)
[08:23:17] <dbaupp> bjz: ping
[08:23:28] <bjz> hurro
[08:23:56] <dbaupp> I was thinking about the Integer thing
[08:24:03] <bjz> yar
[08:24:34] <dbaupp> and I sorta like gifnksm suggestion of a "Factor" trait that has div_mod and gcd/lcm
[08:24:52] <dbaupp> that name seems okay, but not really sure
[08:25:12] <bjz> Mmk
[08:25:21] <dbaupp> er, div_rem
[08:25:23] <bjz> I'm not sure too
[08:25:27] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:25:33] <bjz> will think
[08:25:44] <dbaupp> I'm actually no *that* fussed about polynomials being "Integers"
[08:26:00] <bjz> if you could sketch up some traits, that'd be useful
[08:26:03] <dbaupp> (since they fit all the methods, basically)
[08:26:31] *** Joins: jessicah (jessicah@moz-B8A3AE25.massey.ac.nz)
[08:26:38] <dbaupp> (but the name might need to change, for that... maybe?)
[08:26:47] <bjz> Possibly
[08:27:02] <bjz> it'd be nice to have an Integer trait
[08:27:04] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[08:27:18] <bjz> but yeah
[08:28:18] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[08:29:11] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[08:32:13] <dbaupp> bjz: Hm
[08:32:24] <dbaupp> just looking at it, it seems a bit pointless to split Integer
[08:32:44] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:32:44] <dbaupp> except for maybe the _floor traits
[08:33:42] *** Joins: pyrac (pyrac@E50C2084.81445FE4.1B3E68DA.IP)
[08:33:49] <dbaupp> bjz: https://gist.github.com/huonw/ce9dc0eecfce5a172f08
[08:38:09] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:39:50] *** Joins: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP)
[08:40:03] *** Quits: pyrac (pyrac@E50C2084.81445FE4.1B3E68DA.IP) (Quit: pyrac)
[08:41:56] <bjz> dbaupp: could you add a doc comment to Factor and Integer?
[08:42:45] <bjz> been trying to add doc comments as I go now. still lots to do though
[08:43:30] <sonwow> is there any special reason for using at_vec::from_owned?
[08:44:09] <dbaupp> sonwow: rather than ... ?
[08:44:25] <sonwow> at_vec::from_slice do similar thing.
[08:44:48] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[08:45:15] <dbaupp> sonwow: oh. in theory from_owned could avoid allocating another vector
[08:45:37] <dbaupp> sonwow: (it doesn't at the moment, but it's possibly possible)
[08:45:45] <dbaupp> bjz: yup
[08:46:28] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[08:46:52] <bjz> dbaupp: also, what are the pros for putting is_even and is_odd in Integer?
[08:47:38] <dbaupp> bjz: saying (e.g.) a polynomial is a multiple of 2 isn't useful (as far as I can tell)
[08:47:56] <bjz> ok, well put it in Integer then :)
[08:48:13] <bjz> what about is_multiple_of?
[08:48:18] <dbaupp> bjz: but it's still reasonable
[08:48:26] <dbaupp> bjz: yeah is_multiple_of is useful
[08:48:45] <bjz> ok, put odd/even in integer, but leave multiple of
[08:48:48] <dbaupp> (`1-x^2`).is_multiple_of(`1-x`) == true
[08:49:08] <dbaupp> (that'd be nice to be supported, so yep)
[08:49:15] <bjz> cool
[08:49:46] <dbaupp> on the otherhand, there isn't an obvious reason why we should treat is_{even,odd} differently to is_multiple_of
[08:51:58] <kimundi> wait, how is 1-x^2 a multible of 1-x ? I'd understand if x-x^2 where, but...
[08:52:15] <dbaupp> kimundi: (1-x)(1+x)
[08:52:24] <sonwow> dbaupp: str/vec::from_slice was changed to str/vec::to_owned. however, at_vec::from_slice is remained. so i want to rename at_vec::from_slice and at_vec::from_owned. what do you think about this?
[08:52:49] <kimundi> oh right, duh :|
[08:52:52] <dbaupp> sonwow: not sure
[08:53:50] <kimundi> sonwow: Makes sense
[08:54:20] <kimundi> AT least the from_slice->to_owned part
[08:54:45] <kimundi> the other could be to_owned_consumed?
[08:54:58] <dbaupp> kimundi: presumably it wouldn't be `to_owned` though
[08:55:04] <kimundi> err, or rathe to_managed and to_managed_consume
[08:55:05] <dbaupp> "to_managed"?
[08:55:10] *** Joins: pyrac (pyrac@9DDF615E.81445FE4.1B3E68DA.IP)
[08:56:27] <sonwow> yes, at_vec is for managed vector.
[08:56:36] <dbaupp> bjz: I really want to call Factor "Euclidean"
[08:56:44] <dbaupp> bjz: but that's probably too abstract/jargon-y
[08:56:49] <bjz> dbaupp: that sounds nice
[08:56:59] <dbaupp> bjz: really?
[08:57:09] <bjz> dbaupp: yah
[08:57:36] <bjz> dbaupp: as long as you document the reasoning
[08:57:45] <bjz> dbaupp: but yeah, sounds nicer
[08:59:13] *** Joins: xazax (xazax@moz-C6A38077.wifi.elte.hu)
[08:59:20] <xazax> hi
[08:59:27] <bjz> hii
[08:59:40] <dbaupp> bjz: I'm really looking forward to default methods, if they ever arrive
[08:59:50] <bjz> dbaupp: omg yes
[08:59:54] <sonwow> kimundi: i agree with you. `to_managed` and `to_managed_consume`. is it makes sense?
[09:00:09] <dbaupp> bjz: everything will be so much shorter
[09:00:10] <kimundi> sonwow: Makes sense to me
[09:00:13] <bjz> dbaupp: so much awesomeness oh so tantalisingly close
[09:00:20] <xazax> I want to build rust incoming, but the github is way too slow and I'm way too impatient :D
[09:00:31] <xazax> and downloading llvm takes forever
[09:00:36] * dbaupp considers attempting to fix up
[09:00:41] <dbaupp> ... the default methods
[09:00:42] <xazax> rust is only compatible with it's own llvm fork?
[09:00:44] <sonwow> kimundi: ok, thanks a lot
[09:00:45] <kimundi> sonwow: I use/have seen the _consume prefix at other places for this
[09:00:52] <mcpherri1> xazax: yes, there are some patches to llvm
[09:00:59] <kimundi> this kind of methos*
[09:01:05] <dbaupp> kimundi: suffix ;P
[09:01:05] <xazax> oh, I see
[09:01:14] <kimundi> ah, whatever
[09:01:26] <kimundi> :P
[09:01:36] <mcpherri1> in some future world, it would be nice to be able to use a system llvm but that's not for now
[09:01:49] <dbaupp> bjz: hm, actually, I suck at maths/terminology
[09:02:06] <dbaupp> bjz: and Euclidean is far stronger than having a GCD
[09:02:15] <bjz> ?
[09:02:32] <bjz> as in too specific?
[09:02:58] <dbaupp> bjz: as in, there exist mathematic structures that have a GCD defined on their elements, but aren't "Euclidean"
[09:03:07] <bjz> aah
[09:03:13] <xazax> mcpherri1, I see.. and those patches are likely to go upstream, or rust likely to change to not depend on those patches?
[09:03:13] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:03:25] <dbaupp> bjz: however, Euclidean == having div_rem, so it's probably not too bad
[09:03:59] <kimundi> xazax: If you just want to keep up to date with incoming, don't worry, if you reuse the git checkout dir for updating it usually won't build llvm more than once, unless there where actual changes to it.
[09:06:05] <kimundi> xazax: Either the patches will be upstream or rust keeps its own lcopy. but there was also talk about having make reuse the llvm snapshot, so ideally you wouldn't even need to buil it once with that.
[09:06:28] <xazax> I see, thanks :)
[09:07:10] *** Joins: Blub\w (wry@moz-DC7C9A22.vps.tuwien.ac.at)
[09:08:11] *** mcpherri1 is now known as mcpherrin
[09:08:19] *** Quits: Blub\w (wry@moz-DC7C9A22.vps.tuwien.ac.at) (Quit: WeeChat 0.4.0)
[09:08:41] *** Joins: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com)
[09:12:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.0)
[09:12:30] *** Quits: pyrac (pyrac@9DDF615E.81445FE4.1B3E68DA.IP) (Ping timeout)
[09:12:49] *** Joins: trapni (trapni@moz-6A0EA166.dawanda.com)
[09:15:11] <dbaupp> bjz: updated (https://gist.github.com/huonw/ce9dc0eecfce5a172f08)
[09:15:27] <nmatsakis> bjz: pong
[09:16:09] <dbaupp> bjz: (and again... forgot to move is_even,odd)
[09:16:49] <nmatsakis> bjz: (to store a mutable hashmap, you can use a key of @@mut Foo)
[09:20:59] *** Joins: pyrac (pyrac@moz-92705A3C.compute-1.amazonaws.com)
[09:22:33] <nmatsakis> bjz: btw I have an experimental branch where extern "C" function pointers seem to be working
[09:26:15] <heftig_> C functions need fixups because of the split stacks, right?
[09:26:45] <bjz> nmatsakis: yay!
[09:27:03] <bjz> nmatsakis: yeah I got the tls working, I think
[09:27:05] <bjz> :)
[09:27:39] <bjz> dbaupp: that looks good, for now at least.
[09:27:47] <bjz> dbaupp: so do the doc comments
[09:28:36] <bjz> dbaupp: could you make some of the other doc comments in core::num nicer too? I was having trouble figuring out how to describe the traits
[09:29:54] <bjz> nmatsakis: yeah, I'm reworking the callbacks in glfw
[09:31:07] *** Quits: darkf (darkf@moz-F9058B8A.net) (Ping timeout)
[09:32:55] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Client exited)
[09:34:34] <nmatsakis> bjz: how are you reworking them?
[09:36:11] <nmatsakis> bjz: I'm still a few LLVM errors away from having this work in general though...but it did work on some simple tests
[09:36:49] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[09:37:17] <bjz> nmatsakis: oh, well some of the callbacks are actually associated with windows, so I have to store a hash map of window data structs in TLS
[09:37:37] <bjz> each struct has the associated callbacks stored in there
[09:39:21] <nmatsakis> bjz: ok, I was wondering if it would make sense to use a single callback object instead. I am envisioning something like:
[09:39:42] <nmatsakis> bjz: trait GlCallbacks { fn window_moved(&self, ...); fn whatever(&self, ...); ... }
[09:39:52] <nmatsakis> bjz: with default implementations that do nothing, I guess
[09:40:03] <nmatsakis> bjz: and maybe a refined one that uses a hashtable
[09:40:17] <nmatsakis> bjz: of course that all assumes default methods etc worked well
[09:40:33] <nmatsakis> bjz: but in that case the user would pass in an @GlCallbacks objcet
[09:40:43] <bjz> This is what I had: https://gist.github.com/bjz/25c2d09a8946e9439ea5
[09:41:22] <nmatsakis> bjz: yeah, it's more or less the same thing, just that you've built the vtable yourself
[09:41:32] <bjz> heh, I have?
[09:41:46] <nmatsakis> the WindowData struct :)
[09:41:55] <bjz> is that a vtable?
[09:42:05] <nmatsakis> a simple one, sure. all a vtable is is a struct of fn pointers.
[09:42:19] <nmatsakis> that the compiler builds for you
[09:42:21] <nmatsakis> one per method
[09:42:35] <bjz> So you think there's a simpler way?
[09:42:47] <bjz> the one you were saying?
[09:43:41] <nmatsakis> bjz: well, I am not sure if it's the right time to update it, since I fear bugs
[09:43:55] <nmatsakis> bjz: however, I do think long term this is what the trait/object system is intended to make easier and nicer
[09:44:20] <bjz> ahh ok
[09:44:23] <nmatsakis> bjz: I know we have several parts of the compiler based on the "struct-of-fn-ptr" paradigm that I really want to convert, though my reasons don't precisely apply here
[09:45:09] <bjz> ultimately I'd like to move to using ports/chans
[09:45:19] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[09:45:25] <nmatsakis> yeah, that may be the best answer
[09:45:35] <nmatsakis> in which case it's a moot point
[09:45:56] <bjz> it'd be a struct of ports though :P
[09:47:03] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[09:47:11] <bjz> And some stored in TLS
[09:49:34] <xazax> what does TLS stand for?
[09:49:52] <kimundi> task lzowcal storage
[09:49:56] <kimundi> local*
[09:50:02] <bjz> hah
[09:50:09] <xazax> oh I see thanks
[09:50:32] <kimundi> basically the thread safe version of a global variiable
[09:50:59] <xazax> I guess it's like thread_local in C++11
[09:54:56] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[09:54:56] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[09:55:31] <doomlord> how much of the rust task system works at the minute
[09:56:18] <kimundi> doomlord: That heavily depends on the definition of 'works' :P
[09:57:12] <kimundi> You can spawn tasks, control to which thread they go, send messages between them, share memory safely using libaries etc
[09:57:42] <kimundi> But of courso it's still up for the sheduler rewrite
[09:58:32] <doomlord> is it supposed to work like go where you can have  huge numbers of tasks going, or would it be more like threads in C++ (and worker-thread per core..)
[09:58:49] <kimundi> hughe number
[09:59:13] <kimundi> tasks are sheduled onto a small number of hardware threads per default
[09:59:44] <doomlord> i've never used anything like this, ive only done manual 'job-queues' & that sort of thing with C++ .. i've done parallelism on the ps3 spus aswell which was like that too
[10:00:04] <doomlord> haven't used erlang or go or whatever
[10:00:04] <kimundi> one thread per core, and all tasks get sheduled on them. 
[10:00:34] *** Quits: jviereck (Adium@moz-A2DCE0DD.dclient.hispeed.ch) (Quit: Leaving.)
[10:02:46] <dbaupp> bjz: Yeah, I'll do some work on the doc comments
[10:04:30] *** Quits: pyrac (pyrac@moz-92705A3C.compute-1.amazonaws.com) (Ping timeout)
[10:09:33] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Input/output error)
[10:10:22] *** Quits: xazax (xazax@moz-C6A38077.wifi.elte.hu) (Quit: Ex-Chat)
[10:14:34] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[10:15:04] *** Joins: pyrac (pyrac@moz-92705A3C.compute-1.amazonaws.com)
[10:17:22] *** heftig_ is now known as heftig
[10:20:10] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[10:27:08] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[10:29:22] *** Joins: ysuzuki (ysuzuki@moz-50A58707.bbtec.net)
[10:29:36] *** kimundi is now known as zz_kimundi
[10:32:05] *** Quits: pyrac (pyrac@moz-92705A3C.compute-1.amazonaws.com) (Quit: pyrac)
[10:33:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[10:33:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/vHODWA
[10:33:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[10:35:55] <fabiand> rusti, good morning
[10:41:17] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[10:48:33] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[10:53:08] *** Joins: nicanaca0 (bzlandfill@moz-17B85CC1.bethere.co.uk)
[10:55:31] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Quit: Leaving)
[10:55:56] *** Joins: judder (maradukewa@CF01B517.FDE2B133.950D3BB5.IP)
[10:59:44] *** Quits: doomlord (doomlod@moz-B4683AA6.range31-52.btcentralplus.com) (Ping timeout)
[11:00:08] <indutny> morning
[11:00:26] *** zz_kimundi is now known as kimundi
[11:03:40] <nicanaca0> Morning  guys, i'm new to Rust. I've tried my hand at Project Euler problem and came across a weird issue. My code prints the results as expect, but in reverse order. What options do I have for finding out what's happening under the hood?
[11:04:12] <dbaupp> nicanaca0: you mean debugging support?
[11:05:50] <nicanaca0> Hey dbaupp, yea. I'm from a python background and not used to having to debug in general and usually just use prints to figure out the flow but I'm genuinely unsure of what my options are with Rust
[11:06:56] *** Joins: jviereck (Adium@moz-A2DCE0DD.dclient.hispeed.ch)
[11:07:04] <dbaupp> nicanaca0: well, there's always the print-debugging option
[11:07:14] <dbaupp> nicanaca0: and, unfortunately, not much more :(
[11:07:41] <dbaupp> are you using Rust 0.6? (And what platform are you on?)
[11:08:13] *** Quits: beard-need-weed (c0@moz-4948B777.static.corbina.ru) (Quit: Leaving.)
[11:09:43] *** Joins: vmx (vmx@moz-BF18EC34.dip0.t-ipconnect.de)
[11:09:46] <nicanaca0> Yea, rust 0.6. Ubuntu linux. Code: http://pastebin.com/h1qf3vv1 Out: http://pastebin.com/CctqAyqc. I know debuggers exists and I know programs can be stepped through but would the standard debugged work on a rust binary?
[11:10:32] <dbaupp> nicanaca0: quite possibly
[11:11:04] <dbaupp> I think that if you compile with `rustc -Z debug-info`
[11:11:13] <dbaupp> then you can use gdb on the rust binary
[11:11:22] <nicanaca0> I'm not familiar with binary files and debugging so I guess I have more to learn. Just compiling code is new to me :). And awesome dbaupp I'll try that when I get a chance.
[11:12:41] <doener> nicanaca0: well, you recurse first (on line 37) and then print stuff. So the first one to print will be the last recursion step
[11:12:47] <dbaupp> nicanaca0: you should consider the order that you are calling fib :)
[11:13:08] <dbaupp> (in relation to the prints)
[11:13:16] <dbaupp> doener: did your big patch land?
[11:13:22] <nicanaca0> I tried moving fib down below the if else but It doesn't get called as increment value is not available :S 
[11:14:02] <dbaupp> nicanaca0: what was the error message?
[11:15:51] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[11:15:56] *** Joins: thatfreakingguy (Mibbit@moz-9B57E929.pool.mediaways.net)
[11:16:27] <rsaarelm> It doesn't look like there should be any problem from moving the recursive fib call below the if (isEven... else...
[11:16:36] *** Quits: erick (erick@E1304535.2A7189BF.BE19388.IP) (Ping timeout)
[11:17:31] <nicanaca0> dbaupp, the error message: ./prob_2.rs:44:3: 44:17 warning: unreachable statement ./prob_2.rs:44                  increment += 1;
[11:17:37] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[11:18:17] <dbaupp> nicanaca0: hm, you may need to reorganise your code
[11:19:03] <dbaupp> nicanaca0: since one of the returns on lines 40 or 44 will always happen once the program enters the if on line 36
[11:19:03] <heftig> I'm hoping gcc gains a rust frontend post-1.0
[11:19:35] <dbaupp> nicanaca0: it might be easier if you use a loop, rather than recursion
[11:20:03] <nicanaca0> I completely agree, i'm even a little embarassed. It's mainly due to me moving lines around trying to get a working solution. I think re-writting it will help clear it up for me too. 
[11:20:23] *** Joins: fuogo (Mibbit@moz-FF859E2E.pools.arcor-ip.net)
[11:20:55] *** Parts: fuogo (Mibbit@moz-FF859E2E.pools.arcor-ip.net) ()
[11:21:35] <dbaupp> nicanaca0: don't be... learning a new language always results in strange code for a while (at least, it does for me too!)
[11:22:52] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[11:23:12] <rsaarelm> I wonder if you could do The Evolution of a Haskell Programmer style thing for Rust.
[11:23:19] <rsaarelm> http://www.willamette.edu/~fruehr/haskell/evolution.html
[11:24:34] <dbaupp> rusti: fail!(); 1
[11:24:39] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/dINe
[11:24:55] <nicanaca0> dpuapp, one issue I have is trying to do everything like I do in python and the main issue here is learning where rust differs. 
[11:25:57] <nicanaca0> Thanks for the help, I'll read-up a little more and re-write the code to loop instead of recurse! ;S Cheers! :D
[11:26:09] *** Quits: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com) (Ping timeout)
[11:26:38] *** Joins: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com)
[11:28:41] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[11:29:05] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[11:30:26] <dbaupp> nicanaca0: yup... that's always the problem, using idioms from a different language, and finding they don't work quite right :)
[11:30:48] <dbaupp> rusti: use core::iterator::*; let mut it = Counter::new(1u,1).scan(1, |st, new| { *st *= new; Some(*st) }).skip(5 - 1); it.next().get()
[11:30:49] <rusti> 120
[11:30:55] <dbaupp> rusti: use core::iterator::*; let mut it = Counter::new(1u,1).scan(1, |st, new| { *st *= new; Some(*st) }).skip(6 - 1); it.next().get()
[11:30:56] <rusti> 720
[11:31:00] <dbaupp> rsaarelm: ^
[11:31:25] <dbaupp> (the `it` temporary will soon be unnecessary)
[11:33:32] <nicanaca0> @ work atm, I'll see you all around again at some point but thanks for today dbaupp! Cya #rust!
[11:33:54] *** Quits: nicanaca0 (bzlandfill@moz-17B85CC1.bethere.co.uk) (Quit: CGI:IRC (EOF))
[11:36:27] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[11:41:50] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[11:42:41] *** Joins: doomlord (doomlod@moz-B4683AA6.range31-52.btcentralplus.com)
[11:44:29] <doener> dbaupp: yep, finally got through yesterday.
[11:47:04] <dbaupp> doener: :D
[11:47:07] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[11:47:57] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[11:48:36] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[11:52:10] <engla> dbaupp: what's the change missing?
[11:52:30] <dbaupp> engla: sorry, which change?
[11:53:00] <engla> making the it temporary unnecessary
[11:53:22] <dbaupp> engla: https://github.com/mozilla/rust/pull/6473
[11:54:14] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Quit: ZNC - http://znc.in)
[11:54:31] <engla> cool. thanks!
[11:58:58] *** Quits: wuwei`lab (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Ping timeout)
[12:01:58] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[12:12:37] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:12:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/XwxGaA
[12:12:37] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:12:37] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:12:37] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/IagXGA
[12:12:37] <ghrust> 13rust/06auto 148327900 15Tim Chevalier: testsuite: Add passing test for #4107
[12:12:37] <ghrust> 13rust/06auto 14a4f139e 15bors: auto merge of #6483 : catamorphism/rust/issue-4107, r=catamorphism
[12:12:37] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:13:39] *** Quits: Blub\w (wry@moz-17B6A73F.wireless.dyn.drei.com) (Quit: bbl)
[12:14:27] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[12:14:33] *** Quits: thatfreakingguy (Mibbit@moz-9B57E929.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[12:16:22] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[12:18:07] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[12:19:08] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Quit: leaving)
[12:24:50] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[12:26:24] *** Quits: trapni (trapni@moz-6A0EA166.dawanda.com) (Ping timeout)
[12:28:24] *** Joins: wuwei`lab (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[12:28:54] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[12:36:01] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[12:37:46] <dbaupp> is anyone else having compile-fail/bad-expr-path.rs fail on incoming?
[12:40:01] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[12:41:28] *** Joins: trapni (trapni@moz-6A0EA166.dawanda.com)
[12:44:03] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[12:45:40] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:45:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a4f139e to 144e4f90d: 02http://git.io/N3iJvQ
[12:45:40] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:45:44] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:45:44] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/WuGjxA
[12:45:44] <ghrust> 13rust/06auto 1403f75b6 15Corey Richardson: Better error reporting with renaming imports
[12:45:44] <ghrust> 13rust/06auto 1452f8b22 15Corey Richardson: Add test for resolution errors
[12:45:45] <ghrust> 13rust/06auto 1462cbea1 15Corey Richardson: Add span to some import resolution errors
[12:45:46] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:48:15] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[12:50:19] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[12:52:26] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:53:20] *** Quits: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[12:54:03] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[12:58:26] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:02:57] *** Joins: jlembeck_ (jlembeck@moz-E5A16406.hsd1.wa.comcast.net)
[13:03:35] *** Quits: jlembeck (jlembeck@moz-E5A16406.hsd1.wa.comcast.net) (Ping timeout)
[13:04:16] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[13:06:00] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[13:10:04] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:10:12] <kimundi> dbaupp: My 2 hours old build had no problems. linux mint 64bit
[13:10:42] <kimundi> dbaupp: Ah, it's a test. Don't know about that
[13:10:52] <dbaupp> kimundi: yup, thanks... it seems to only be a problem with stage1 (works fine with stage2)
[13:11:04] <kimundi> yeah, that happens sometimes
[13:11:57] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:15:34] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:16:53] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[13:18:38] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[13:20:03] *** Joins: berak (chatzilla@4E3989C6.5E545589.16E13E53.IP)
[13:24:38] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:24:41] *** Joins: Blub\w (wry@moz-EA7495B1.wireless.dyn.drei.com)
[13:25:52] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:28:06] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:30:45] <bstrie> hmm
[13:30:50] <bstrie> the bors queue is starting to get out of hand
[13:32:40] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:32:41] <bstrie> I just looked at the ruby on rails project on github today
[13:32:43] *** Joins: webber46 (webber46@moz-AC14FDEA.se)
[13:32:47] <bstrie> they have 236 open pull requests
[13:32:52] *** Parts: berak (chatzilla@4E3989C6.5E545589.16E13E53.IP) ()
[13:33:00] <bstrie> let's try not to let it get to that stage
[13:34:32] <dbaupp> bstrie: they don't appear to have any integration testing either ?
[13:36:06] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:36:48] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[13:36:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/WuGjxA
[13:36:49] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[13:38:15] <bstrie> dbaupp: that can't be right, surely they have some automatic testing somewhere
[13:39:45] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[13:39:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qRlAPg
[13:39:45] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[13:39:47] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[13:39:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/-7TvYA
[13:39:48] <ghrust> 13rust/06auto 14084b134 15Youngmin Yoo: Update .gitignore
[13:39:48] <ghrust> 13rust/06auto 14803c12d 15bors: auto merge of #6486 : recrack/rust/gitignore, r=catamorphism...
[13:39:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[13:40:35] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:40:43] <dbaupp> bstrie: I guess so, but it doesn't seem to hook into github as nicely as bors, so we've got at least one advantage
[13:43:10] <bstrie> that's very strange to me
[13:43:25] <bstrie> I'm not even sure where their test suite is
[13:43:51] <bstrie> oh, this "ci" directory is probably something
[13:44:07] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:44:25] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:44:41] <dbaupp> bstrie: they appear to have test subfolders in quite a few of the top-level folders
[13:45:08] <bstrie> in any case, it's strange to me that rails has less github integration than rust, when rails is supposed to be the poster boy of large-scale github development
[13:46:15] <dbaupp> bstrie: they appear to have a travis thingo, https://travis-ci.org/rails/rails
[13:46:35] <bstrie> aha
[13:46:36] <dbaupp> but I agree that's it's peculiar
[13:46:56] <dbaupp> also, https://github.com/rails/rails/#code-status
[13:47:12] <dbaupp> "build: failing" ... that's always nice to have
[13:48:08] *** Joins: sk (sk@E9551FDB.1D222DF7.24EDD759.IP)
[13:49:07] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Ping timeout)
[13:54:43] *** Quits: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[13:55:56] *** Quits: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net) (Ping timeout)
[13:56:16] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[13:58:02] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[13:58:08] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[13:58:10] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Ping timeout)
[13:58:19] *** Joins: doener (bs@moz-ABF3CB03.fixip.bitel.net)
[14:01:51] *** Joins: thatfreakingguy (Mibbit@moz-9B57E929.pool.mediaways.net)
[14:02:17] *** Quits: doener (bs@moz-ABF3CB03.fixip.bitel.net) (Ping timeout)
[14:03:16] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[14:04:40] *** Joins: novabyte (Instantbir@35B99A54.83984DD1.B8C0F609.IP)
[14:06:42] *** Quits: passcod (passcod@moz-5BCF5019.passcod.name) (Quit: ZNC - http://znc.in)
[14:06:54] *** Quits: thatfreakingguy (Mibbit@moz-9B57E929.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:07:38] *** Quits: novabyte (Instantbir@35B99A54.83984DD1.B8C0F609.IP) (Quit: bye bye)
[14:13:30] *** Joins: ssbr__ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[14:17:22] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[14:18:47] *** Joins: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com)
[14:18:47] *** ChanServ sets mode: +o nmatsakis
[14:18:54] *** Quits: ysuzuki (ysuzuki@moz-50A58707.bbtec.net) (Client exited)
[14:19:08] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[14:20:20] *** Joins: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP)
[14:20:46] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[14:26:20] *** Joins: xazax (xazax@moz-C6A38077.wifi.elte.hu)
[14:26:43] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[14:27:18] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[14:27:41] *** Quits: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net) (Quit: dbaupp)
[14:27:53] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[14:29:22] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[14:33:36] *** Quits: jviereck (Adium@moz-A2DCE0DD.dclient.hispeed.ch) (Quit: Leaving.)
[14:34:36] <kimundi> Did casts in match arms change?
[14:34:44] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[14:35:05] <kimundi> like in match buf[0] { '+' as u8 => ... } ?
[14:35:30] <dbaupp> kimundi: yup, removed
[14:35:48] <dbaupp> match buf[0] as char { '+' => ... }
[14:36:03] *** Quits: bytbox (s@moz-2E27684C.student.umd.edu) (Ping timeout)
[14:36:47] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[14:36:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/-7TvYA
[14:36:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[14:37:40] *** Quits: Blub\w (wry@moz-EA7495B1.wireless.dyn.drei.com) (Quit: WeeChat 0.4.0)
[14:39:50] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[14:39:50] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GyC8KQ
[14:39:50] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[14:40:24] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[14:40:53] <kimundi> I see, okay
[14:41:26] <jack> nmatsakis: does once actually work on closures right now? when i was fixing some things in servo i noticed some odd patterns that were there because the compiler didn't know it was a once function. but pcwalton didn't mention that there was a once keyword.
[14:41:45] <jack> now that i'm reading your blog posts, it sounds like these have worked for some time
[14:42:23] <nmatsakis> jack: no.
[14:42:32] <nmatsakis> jack: it's just been planned for some time :)
[14:42:50] <nmatsakis> jack: there are a few refactors standing in the way of implementing it, but it's getting pretty close now
[14:43:08] <jack> ok. darn. i was all excited i'd be able to clean up more code :)
[14:43:21] <nmatsakis> jack: sorry :( good news is that it should be impl'd in a month or three
[14:45:26] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:46:42] *** Quits: jlembeck_ (jlembeck@moz-E5A16406.hsd1.wa.comcast.net) (Client exited)
[14:47:03] *** Joins: jlembeck (jlembeck@moz-E5A16406.hsd1.wa.comcast.net)
[14:47:16] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[14:47:58] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:49:29] <pyrac> hi all. I want to share an immutable vec between tasks. Is std::arc the right tool for it? 
[14:51:56] *** Quits: z0w0 (zack@moz-B13FD5D7.lns2.cha.bigpond.net.au) (Quit: Leaving.)
[14:54:35] *** Quits: ssbr__ (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Quit: Leaving)
[14:59:57] <kimundi> pyrac: yup
[15:00:22] <pyrac> kimundi: ok thanks !
[15:02:20] *** Quits: webber46 (webber46@moz-AC14FDEA.se) (Quit: webber46)
[15:04:15] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[15:11:20] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[15:13:18] *** Joins: ysuzuki (ysuzuki@moz-60FA9D06.net119083145.t-com.ne.jp)
[15:15:39] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[15:17:06] *** Joins: btipling (btipling@moz-D51E0AEB.xen.prgmr.com)
[15:17:53] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[15:18:47] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:19:35] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[15:22:22] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[15:24:06] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[15:30:16] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:30:58] *** Quits: xazax (xazax@moz-C6A38077.wifi.elte.hu) (Quit: Ex-Chat)
[15:31:09] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[15:35:05] *** Quits: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net) (Ping timeout)
[15:38:35] *** Quits: trapni (trapni@moz-6A0EA166.dawanda.com) (Quit: Leaving)
[15:40:10] <ssbr> A problem I keep running into: I want a static that contains a null raw pointer. Is there any way at all to do this?
[15:40:28] <ssbr> I can't do something like static foo : MyStruct = MyStruct(ptr::null()); since that involves a function call
[15:40:44] <bstrie> hmm
[15:41:54] <ssbr> oh, actually, maybe casting to pointer would work
[15:41:55] <bstrie> using unsafe code, possibly
[15:42:11] <ssbr> rusti: 0 as *uint
[15:42:12] <rusti> 0
[15:42:35] <bstrie> rusti: 123456 as *uint
[15:42:36] <rusti> 123456
[15:42:49] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[15:42:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/zYFDvA
[15:42:49] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[15:43:05] <bstrie> I guess you don't need unsafe code to make a null pointer, just to use one
[15:43:15] <ssbr> woohoo :)
[15:43:21] <bstrie> ssbr: what are you using the null pointer for?
[15:43:41] <ssbr> bstrie: I'm writing a wrapping around libtcod, a roguelike curses replacement thing.
[15:44:00] <bstrie> ah
[15:44:02] <ssbr> bstrie: it has a notion of surfaces/"consoles" you can write to and blit. NULL is special-cased as the actual screen.
[15:44:09] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[15:44:09] <bstrie> does bindgen not help there?
[15:44:23] <ssbr> bstrie: it does! I'm wrapping the output of bindgen
[15:45:20] <ssbr> anyway, so I want something like static root : Console = _Console(0 as *TCOD_console_t);
[15:45:53] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[15:45:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/igl0RA
[15:45:53] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[15:45:54] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[15:45:55] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/FxiPuw
[15:45:55] <ghrust> 13rust/06auto 1450a5eff 15sammykim: Change unsafe functions to safe functions
[15:45:55] <ghrust> 13rust/06auto 14cdfdb2b 15bors: auto merge of #6488 : sammykim/rust/issue-6430, r=catamorphism...
[15:45:55] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[15:46:06] <ssbr> at least for now. this isn't really a safe API, I guess.
[15:46:31] <bstrie> jc-denton: UNATCO?
[15:47:02] <ssbr> is everyone a deus ex fan now
[15:47:44] <bstrie> it's resting somewhere in my queue, I've only ever finished the first level :P
[15:48:04] <bstrie> just bought system shock 2 yesterday via steam sale
[15:48:13] <bstrie> so I expect to have completed it by 2025
[15:48:23] *** Joins: mib_ontopx (Mibbit@9466171.E7112B39.A5F94D77.IP)
[15:48:36] *** Quits: mib_ontopx (Mibbit@9466171.E7112B39.A5F94D77.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:48:45] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:49:30] <ssbr> bstrie: don't go any further. in the third level, you'll go into some shanty and get trapped by a poorly programmed friendly AI and get stuck forever, forced to reload a save file from the first five minutes of the game, and then break your keyboard in rage.
[15:49:41] * ssbr doesn't understand what people see in that game
[15:50:02] <bstrie> haha
[15:53:01] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[15:53:23] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[15:53:50] <ssbr_> Is there a reason that in things like vec, for example, many functions are also duplicated as methods?
[15:54:08] <bstrie> ssbr_: no good reason. just legacy stuff
[15:54:17] <bstrie> the intent is to deduplicate
[15:54:21] <ssbr_> bstrie: for writing my own code, I was thinking that everything should be a method
[15:54:24] <ssbr_> would that be idiomatic?
[15:54:34] <bstrie> methods are intended to be the canonical forms, yes
[15:54:53] <ssbr_> (I mean, in C++ or Python, they would all be methods -- I don't mean in the Java sense of "make everything a method even if it shouldn't be")
[15:55:04] <ssbr_> bstrie: OK, excellent :)
[15:55:17] <bstrie> ssbr_: https://github.com/mozilla/rust/issues/6045
[15:55:29] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[15:55:38] *** kimundi is now known as zz_kimundi
[15:57:18] *** Quits: victorporof (victorporo@10AA7997.880C8D58.79933D60.IP) (Quit: victorporof)
[15:58:32] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[15:59:21] *** Joins: victorporof (victorporo@10AA7997.880C8D58.79933D60.IP)
[16:01:02] *** Quits: mcomella (mcomella@moz-B10FF54F.ri.ri.cox.net) (Connection reset by peer)
[16:01:29] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:01:30] *** Joins: mcomella (mcomella@moz-B10FF54F.ri.ri.cox.net)
[16:05:23] <heftig> ssbr_: that's the Java sense?
[16:05:57] <ssbr_> heftig: well, it's _a_ java sense.
[16:06:13] <bstrie> java senses... tingling!
[16:06:18] <lucian> heftig: it's make-static-methods-because-we-don't-have-functions
[16:06:29] <ssbr_> I don't mean to dismiss Java, I just meant to say that I mean "where appropriate", and not literally everywhere
[16:07:29] *** Joins: jviereck1 (Adium@moz-57512FAD.dynamic.hispeed.ch)
[16:07:58] <heftig> well, i guess static methods and attributes are really just namespaced functions and variables
[16:08:16] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Ping timeout)
[16:08:22] <heftig> i think the same applies in rust, at least for the static methods?
[16:08:58] <lucian> yes, but there are many cases where one would really much rather write a function (in java), but it's not an option
[16:08:58] <ssbr_> heftig: static methods on traits are something distinctly different than that
[16:09:41] <ssbr_> heftig: in that you can do "foo(MyTrait::my_static_method(X))" and it might do something very different depending on what foo is
[16:09:46] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[16:09:49] <ssbr_> (including fail to compile :<)
[16:10:07] <heftig> you mean, what X is?
[16:10:08] *** Quits: yosemite (sam@moz-8CEAB1B0.dasbistro.com) (Quit: leaving)
[16:10:15] <ssbr_> heftig: or that.
[16:10:17] <ssbr_> (both)
[16:11:25] <heftig> ssbr_: because it's "overloaded"?
[16:11:42] *** Joins: blitter (blitter@moz-7C98731E.dyn.centurytel.net)
[16:11:51] <heftig> i.e. there can be a lot of different implementations of my_static_method depending on the argument type of foo and the type of X
[16:12:33] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:12:56] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[16:13:51] <lucian> i guess "statically polymorphic" is maybe a more accurate term
[16:15:46] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[16:15:47] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14cdfdb2b to 144e82610: 02http://git.io/N3iJvQ
[16:15:47] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[16:15:48] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[16:15:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Al3Y5g
[16:15:48] <ghrust> 13rust/06auto 142d35c01 15Brian Anderson: rusti: Ignore tests. Failing on i686. #6489
[16:15:48] <ghrust> 13rust/06auto 14d806c96 15bors: auto merge of #6490 : brson/rust/rusti, r=brson
[16:15:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[16:16:08] <ssbr_> heftig: I'm not sure I'd say overloaded
[16:16:28] <ssbr_> heftig: but different implementations can be chosen based on those two things, and what you have imported at the time, and so on
[16:16:50] <ssbr_> heftig: the things it can do is extensible and open; in Java it's determined solely by the class itself
[16:16:55] <ssbr_> and fixed and closed
[16:17:04] <ssbr_> (and on non-trait static methods, also)
[16:18:25] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[16:18:40] <lucian> ssbr_: to me they still make sense as constructors
[16:20:00] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:20:15] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Ping timeout)
[16:20:28] <strcat> nmatsakis: ping
[16:21:24] *** Joins: jclements (jclements@2557E599.66715431.D25A875A.IP)
[16:25:17] <nmatsakis> strcat: pong.
[16:27:19] *** Joins: echristo (echristo@D423593A.D6CCE4AE.77834EAA.IP)
[16:27:53] <strcat> nmatsakis: would it make sense to allow an impl of a trait function to be region parameterized when the trait isn't?
[16:27:55] *** Joins: eholk (eholk@moz-3E83C9EA.uconnect.utah.edu)
[16:28:41] <strcat> like 'fn foo(&self, f: fn(&T))' on the trait and 'fn foo<'a>(&'a self, f: fn(&'a T))' in an impl
[16:31:39] <nmatsakis> strcat: yes, that works out fine (for regions, not types).
[16:31:48] <nmatsakis> strcat: however
[16:31:56] <nmatsakis> strcat: that particularl example may not work, let me think a sec
[16:33:20] <nmatsakis> strcat: I think that example is fine. Do you get errors today?
[16:34:24] <nmatsakis> strcat: actually wait. :) sorry, I need to get a pencil-and-paper to work it out, it's a bit tricky with the nested fns...
[16:35:24] <nmatsakis> strcat: ok :) yes, I think that example should work.
[16:35:30] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[16:38:32] *** Joins: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se)
[16:41:05] *** Quits: james4k (james@moz-726FE3EE.com) (Ping timeout)
[16:41:05] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[16:41:09] <strcat> nmatsakis: yeah there are errors today
[16:43:07] <strcat> hmm actually no
[16:43:10] <strcat> not for this simple example...
[16:43:26] <strcat> I'll have to figure out where I went wrong before ;p
[16:48:47] <ssbr_> ugh, anyone used bindgen? I'm running it with `bindgen include/libtcod.h -builtins`, but it isn't generating any definitions for __builtin_va_list
[16:50:07] <strcat> ssbr_: I don't think there's a way for it to handle va_list and vararg things
[16:50:51] <ssbr_> strcat: it claims to handle it here: https://github.com/crabtw/rust-bindgen/issues/29
[16:51:01] *** Joins: Blub\w (wry@moz-B653EF83.wireless.dyn.drei.com)
[16:51:17] <ssbr_> I am just commenting out the functions/types for now
[16:52:16] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[16:53:39] <ssbr_> Hm, it also seems to not import things it uses, like core::cast
[16:53:43] <ssbr_> I guess it's just out of date
[16:54:42] <ssbr_> http://static.rust-lang.org/doc/core/cast.html <-- this mentions reinterpret_cast, and bindgen uses reinterpret_cast, but there is no reinterpret_cast
[16:54:48] <ssbr_> what should it use instead?
[16:55:12] <ssbr_> transmute?
[16:55:21] <strcat> transmute or transmute_copy, depending on the use case
[16:55:23] *** Joins: james4k (james@moz-726FE3EE.com)
[16:56:12] <ssbr_> it's implementing unions using reinterpret_cast, so I guess transmute
[16:56:18] *** Quits: inolen (Adium@moz-FA2406D8.socal.res.rr.com) (Quit: Leaving.)
[16:58:20] *** Joins: Ralith (ralith@moz-729DC03E.wireless.sfu.ca)
[16:59:36] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[16:59:36] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[17:04:38] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[17:05:33] *** Joins: Jesse (jruderman@moz-4BE034AB.ptr.us.xo.net)
[17:07:44] *** zz_kimundi is now known as kimundi
[17:09:45] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[17:09:46] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/Al3Y5g
[17:09:46] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[17:10:59] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[17:11:14] *** Joins: catpig (catpig@moz-EB0ADE36.dip0.t-ipconnect.de)
[17:11:20] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:12:03] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[17:12:44] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[17:12:44] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/lx5hbw
[17:12:44] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[17:13:02] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:15:00] <ssbr_> rusti: priv struct _Foo; pub type Foo = _Foo; impl Foo {}; 1
[17:15:02] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/QUKQ
[17:15:23] <ssbr_> irritating
[17:15:30] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:15:46] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[17:15:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/lx5hbw
[17:15:46] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[17:15:48] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[17:15:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/9vNbzA
[17:15:48] <ghrust> 13rust/06auto 145af8646 15Brian Anderson: core: Fix leak in TLS. #6231
[17:15:48] <ghrust> 13rust/06auto 14bcec83a 15bors: auto merge of #6493 : brson/rust/tls, r=thestinger
[17:15:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[17:18:55] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:19:35] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[17:19:38] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:19:40] *** Quits: jviereck1 (Adium@moz-57512FAD.dynamic.hispeed.ch) (Quit: Leaving.)
[17:19:52] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:20:34] <ssbr_> rusti: pub type bool = u8; let x: bool = 3; x
[17:20:38] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/cgiP
[17:21:02] <ssbr_> Infuriating.
[17:21:26] <ssbr_> (yet more hand-edits to the "automatically generated" bindgen stuff)
[17:23:04] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[17:23:05] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[17:23:05] *** ChanServ sets mode: +qo graydon graydon
[17:23:33] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[17:23:43] <ssbr_> I am not sure how to search for that in the issue tracker. The only keyword I can think of is "type", but that doesn't narrow down the issue list a whole lot...
[17:24:36] <Blei> ssbr_: i thought bindgen handled the case of c types/functions that have the names of rust keywords... must be a bug
[17:24:38] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:24:42] <strcat> rusti: let x = 5; let y = &x; *y == 5
[17:24:46] <rusti> true
[17:25:33] *** Quits: Ralith (ralith@moz-729DC03E.wireless.sfu.ca) (Ping timeout)
[17:27:13] *** Joins: Ralith (ralith@moz-729DC03E.wireless.sfu.ca)
[17:27:37] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[17:27:41] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[17:27:41] *** ChanServ sets mode: +o pcwalton
[17:28:18] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[17:28:38] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[17:33:18] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[17:33:20] <Blei> ssbr_: you can add "-match libtcod" to force bindgen to only create bindings for header files whose paths include the string "tcod"
[17:33:26] <Blei> err "libtcod"
[17:33:36] <Blei> that takes care of the __builtin_whatever
[17:34:01] <ssbr_> Blei: oh, is that what that's for?
[17:34:50] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[17:34:56] <Blei> yeah, so you don't generate bindings for all the dependency headers (including builtin stuff)
[17:35:15] <Blei> ssbr_: this branch includes a fix for the reinterpret_cast: https://github.com/Blei/rust-bindgen
[17:36:04] <ssbr_> Blei: most excellent, thanks! I'll regenerate using -match and your branch, and see what happens :)
[17:37:07] <Blei> (`bool` is still a problem though)
[17:39:39] *** Joins: inolen (Adium@moz-9F4F17DF.tourcaster.com)
[17:41:37] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[17:42:51] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[17:42:51] *** ChanServ sets mode: +o brson
[17:42:53] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Connection reset by peer)
[17:43:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:43:17] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[17:44:29] <Blei> hmm, apparently you can have variable names that are types, but you can't typedef your own bool
[17:44:40] <Blei> (or f32, or whatever)
[17:45:39] <kimundi> that's because they have different namespaces
[17:51:46] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[17:53:47] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:56:03] <Blei> ssbr_: pushed a fix for the `bool` thing to the same branch
[17:56:10] <Blei> let me know if there are other problems
[17:56:49] <ssbr_> Blei: same branch == master?
[17:56:59] <ssbr_> or. uh.
[17:57:00] <ssbr_> yes.
[17:57:47] <Blei> indeed
[17:58:22] *** Joins: jviereck (Adium@moz-57512FAD.dynamic.hispeed.ch)
[17:58:40] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:03:35] <kimundi> rusti: fn foo(a: uint, b: uint,) -> uint { a + b }
[18:03:37] <rusti> foo.rs:5:33: 5:34 error: unexpected token: `)`
[18:03:37] <rusti> foo.rs:5          fn foo(a: uint, b: uint,) -> uint { a + b }
[18:03:37] <rusti>                                           ^
[18:03:52] *** Joins: dherman (dherman@moz-95C48841.sub-70-197-11.myvzw.com)
[18:03:52] *** ChanServ sets mode: +o dherman
[18:04:10] *** Joins: azita (Azita@moz-4BE034AB.ptr.us.xo.net)
[18:04:10] <doomlord> rust lacks globals... ? - does that help with pointer-aliasing asumptions (i suppose using tuples & map to get rid of a lot of the situations where you pass pointers for return values would also help)
[18:04:19] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:04:25] <kimundi> doomlord: Also threadsafety
[18:04:28] *** Quits: jviereck (Adium@moz-57512FAD.dynamic.hispeed.ch) (Ping timeout)
[18:04:38] <kimundi> doomlord: global variable == race conditions
[18:04:51] <doomlord> oh sure
[18:04:52] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[18:04:57] <thiez> global variables are fine, as long as they don't variable :p
[18:05:04] <doomlord> globals + threads = fail
[18:05:05] <ssbr_> Blei: gen.rs:465:12: 465:76 error: structure has no field named `explicit_self`
[18:05:15] <kimundi> there is task local storage atm, and globals are planned but will require a unsafe block for use
[18:05:54] <Blei> ssbr_: hmm, how old is your rust? i had to fix that because the old version of bindgen didn't compile here :/
[18:06:04] <cmr> I'm rebasing an old patch. What does the syntax `values : &v/[T], fun : &fn(perm : &[&v/T])`, specifically the foo/bar, do?
[18:06:06] <doomlord> i wondered if you could retrofit something to c++ to  specify constness for the globls (or inability to acess them)
[18:06:11] <Blei> ssbr_: it should be save to just revert that commit
[18:06:12] <cmr> (Or, did it do, as it is)
[18:06:22] <ssbr_> Blei: a few days old
[18:06:30] <Blei> ah, i built 2-3h ago
[18:06:30] <thiez> cmr: I think that was the old lifetime syntax?
[18:06:37] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Ping timeout)
[18:06:51] <engla> cmr: lifetime, now it's &'v
[18:06:52] <thiez> &v/[T] = &'v [T] I believe
[18:07:06] <ssbr_> Blei: revert which commit? 59274255954b084edca8958ffccb6794d4f73c81 ?
[18:07:29] <Blei> ssbr_: yeah
[18:08:00] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[18:08:05] *** Joins: jviereck (Adium@moz-57512FAD.dynamic.hispeed.ch)
[18:08:07] <ssbr_> welp, it compiles
[18:08:17] <cmr> engla: thiez: thanks
[18:08:21] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:09:01] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:09:02] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Connection reset by peer)
[18:11:12] <ssbr_> Blei: that resulted in a nearly empty file. :(
[18:11:23] <Blei> :O
[18:12:07] *** Quits: Blub\w (wry@moz-B653EF83.wireless.dyn.drei.com) (Ping timeout)
[18:12:36] <Blei> how do you call it?
[18:12:44] <bstrie> strcat: https://github.com/mozilla/rust/pull/6487 appears to have included a random binary file
[18:12:51] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[18:12:52] <ssbr_> Blei: ~/local_programming/rust-bindgen/bindgen include/libtcod.h -match libtcod_debug -o ../../src/raw_tcod.rs
[18:12:56] <ssbr_> egh
[18:13:08] <ssbr_> libtcod, not libtcod_debug (I was trying different .so-files to see if they did any better)
[18:13:17] <ssbr_> (they do worse.)
[18:13:20] <Blei> ah, yeah
[18:13:57] <Blei> bindgen doesn't really look at .so files, only headers
[18:14:10] <ssbr_> Blei: well I don't know what header it's looking at, then
[18:14:17] <ssbr_> but it's the wrong one!
[18:14:42] <ssbr_> Blei: it outputs https://gist.github.com/ssbr/3298d674d4f47863e5f4
[18:14:51] <ssbr_> there are a lot more functions than that :(
[18:15:01] <bstrie> brson: 4e8261009948ed1cfbbdaf4ecc3fadef795b27b7 appears to have included an arbitrary binary file
[18:15:15] <Blei> hmm, yeah
[18:16:27] <bstrie> brson: letting you know in case you want to do a git reset, considering that yours is the only other commit to incoming since then
[18:16:36] <Blei> those are the only ones that are defined in the actual libtcod.h, it looks like it doesn't include the other files
[18:16:42] <Blei> ah! because of the match
[18:17:05] <Blei> they are all in /usr/include/libtcod in my system, so the match applies to all of them
[18:17:10] <Blei> apparently not in yours
[18:17:27] *** Quits: azita (Azita@moz-4BE034AB.ptr.us.xo.net) (Quit: azita)
[18:17:31] <cmr> r? https://github.com/mozilla/rust/pull/6505
[18:17:48] <ssbr_> Blei: I didn't install libtcod systemwide, it's just in this directory here
[18:17:55] <brson> bstrie: i had a commit land?!
[18:17:57] * brson so happy
[18:18:02] <ssbr_> Blei: all the include files are in ./include
[18:18:33] <Blei> ssbr_: you could rename the folder? or add a -match for each relevant header
[18:18:44] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[18:18:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/9vNbzA
[18:18:44] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[18:18:44] <Blei> or move them to a subfolder that you can match against
[18:18:48] <brson> bstrie: is this a binary file that we shouldn't have in the history?
[18:19:13] <bstrie> brson: it's a file called ".swo" in the very top of the repo
[18:19:23] <ssbr_> Blei: I don't know anything about how -match works, sorry
[18:19:26] <thiez> it's a vi swap file it seems
[18:19:38] <brson> i should not have catted that file to my terminal
[18:19:45] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[18:19:49] <Blei> ssbr_: bindgen --help  ;)
[18:19:50] <thiez> shouldn't have made it in, '*.swo' is in gitignore
[18:19:53] <ssbr_> Blei: what exactly does it do with its argument? interpret it as a directory in the CWD? As a directory anywhere accessible by c?
[18:19:58] <ssbr_> Blei: bindgen --help says nearly nothing
[18:20:27] <bstrie> brson: no, it wasn't your commit that did it, it was the commit before yours... but I wanted to tell someone with the authority to touch incoming directly
[18:20:29] <thiez> someone with push access should just push it out or something
[18:20:29] <ssbr_> oh wait, no, the online docs say nearly nothing. bindgen --help merely lies
[18:20:43] <ssbr_> (I tried -match tcod and bindgen did not generate a file, but complained about unused linker options)
[18:20:46] <Blei> it matches its argument against the path of each file that is included, if that matches any match argument, it is processed, else its contents are ignored
[18:20:48] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[18:20:49] <bstrie> brson: also it looks like two of your commits have landed now :)
[18:21:01] <cmr> miraculous!
[18:21:10] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:21:16] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[18:21:17] *** Joins: Blub\w (wry@moz-C00B5153.wireless.dyn.drei.com)
[18:21:23] <Blei> oh, that shouldn't happen
[18:21:38] <ssbr_> ... it no longer happens, so nevermind
[18:21:44] <bstrie> anyway, I just get a little paranoid at these things
[18:21:45] <ssbr_> that was the reason I was trying .so-files in the first place
[18:21:48] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[18:21:48] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/SSJMFQ
[18:21:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[18:21:49] <bstrie> spooky binary files sitting in source control
[18:21:50] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[18:21:50] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/FUfBLA
[18:21:50] <ghrust> 13rust/06auto 1417a68d1 15Daniel Micay: vim: swap operator is gone
[18:21:50] <ghrust> 13rust/06auto 14d65a136 15Daniel Micay: vim: no more drop blocks
[18:21:50] <ghrust> 13rust/06auto 14298a726 15Daniel Micay: vim: `be` is still a reserved keyword
[18:21:50] <ssbr_> (I assumed it was doing something weird)
[18:21:50] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[18:22:14] <ssbr_> Blei: anyway, what does this have to do with the name of the directory?
[18:22:24] <ssbr_> it looks at the directory name too?
[18:22:31] <Blei> at the complete path, yes
[18:22:38] <brson> I think we can remove the .swo file in a followup commit. It's only 73 kb
[18:22:51] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[18:22:58] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[18:23:01] <Blei> which is convenient when all the relevant files are in one directory
[18:23:13] *** Joins: jviereck1 (Adium@moz-340574DC.dclient.hispeed.ch)
[18:23:27] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Quit: Leaving)
[18:23:42] <ssbr_> Blei: OK then!
[18:23:45] <brson> I'll make the commit to remove .swo
[18:24:03] *** Quits: jviereck (Adium@moz-57512FAD.dynamic.hispeed.ch) (Ping timeout)
[18:24:03] <ssbr_> renaming the include directory seems to have worked
[18:24:13] <Blei> great!
[18:24:16] <ssbr_> wooo
[18:25:40] *** Quits: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com) (Client exited)
[18:25:48] <cmr> This PR is only 3 months old, but the language has changed a ton in the meantime it seems.
[18:26:04] <brson> I've been thinking about how to start locking down the core lib for backward compatibility. Want to get started on this soon if we're going to make any promises by the end of the year
[18:26:07] <cmr> For the better, it looks like
[18:26:44] <cmr> brson: it'd be nice if 6045 would land before that
[18:26:44] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[18:27:28] <brson> cmr: I just want to get the processes in place, not stop people from changing core
[18:27:38] <cmr> oh, ok
[18:27:46] <cmr> Node has "stability levels", which I think are a great idea.
[18:27:58] <brson> cmr: I'll google that
[18:28:19] *** Quits: Ralith (ralith@moz-729DC03E.wireless.sfu.ca) (Ping timeout)
[18:28:33] <cmr> brson: http://nodejs.org/api/crypto.html#crypto_crypto
[18:28:45] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[18:29:15] <brson> cmr: do you know if they have automation to guarantee their stability levels?
[18:29:31] <cmr> vs http://nodejs.org/api/http.html#http_http and http://nodejs.org/api/modules.html#modules_modules and others
[18:29:34] <cmr> brson: I do not.
[18:29:51] <brson> I'd like to have a tool that prevents people from changing API's that we've decided are stable
[18:30:24] <brson> so we can progressively trawl through core and start figuring out what is and isn't
[18:30:36] <cmr> that would be nice
[18:30:39] <brson> i suspect that there's a quite a lot that will change still
[18:30:50] <brson> really want to be able to quantify
[18:30:51] <thiez> brson: wouldn't simple unit-tests be enough to cover that?
[18:30:59] *** Quits: ysuzuki (ysuzuki@moz-60FA9D06.net119083145.t-com.ne.jp) (Client exited)
[18:31:05] <ssbr_> Blei: woo, successful compilation!
[18:31:14] <brson> thiez: only if you can prevent people from changing the unit tests
[18:31:22] <ssbr_> For some reason the include files referenced things that the shared libraries didn't have, but otherwise, success was had. :)
[18:31:31] <brson> thiez: and if you *have* unit tests for everything
[18:31:34] *** Joins: Ralith (ralith@moz-729DC03E.wireless.sfu.ca)
[18:31:49] <thiez> brson: that should be a goal anyway :p
[18:32:58] <thiez> anyway, we have devs that review the pull requests, surely they would notice when the api changes
[18:33:00] <brson> thiez: i was thinking there are two levels of stability. the simplest is just guaranteeing that the API signature is stable. more comprehensive would be to extract the set of tests that capture behavior that we are sure we want in Rust 1 and say they can't be changed
[18:33:04] <brson> thiez: haha
[18:33:09] <thiez> :p
[18:33:38] <brson> i think that would require super-human attention to detail to catch all changes to stable apis
[18:33:55] <cmr> ABI compatability too
[18:34:31] <cmr> (which isn't a concern in node)
[18:34:39] *** Joins: fenster (Mibbit@moz-D3FA6CB.net.salesforce.com)
[18:34:41] *** Quits: fenster (Mibbit@moz-D3FA6CB.net.salesforce.com) (Quit: fenster)
[18:34:56] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:34:59] *** Joins: thpickert (thpickert@moz-99F22CD3.dynamic.dsl.tng.de)
[18:35:15] <brson> we'll have to eventually make some ABI guarantees, yeah
[18:35:51] <brson> thiez: uh, the stability levels i mentioned are unrelated to nodes. I just accidentally coopted their term to describe something different
[18:36:01] <brson> I do like their stability level concept
[18:36:26] <brson> we have the very beginnings of something like that in core::unstable, which is more-or-less a staging area for modules
[18:36:47] <brson> i guess corresponds to their 'experimental' level
[18:37:38] <thiez> I thought 'unstable' was mostly low-level stuff?
[18:38:38] <thpickert> Can anyone help me figure out how to use str::split_char()? I must be making some silly mistake trying to find out how to apply it. Gist: https://gist.github.com/anonymous/5586207
[18:38:38] <brson> thiez: it's a grab bag of things that I haven't thought through or don't want to commit to
[18:39:25] <kimundi> rusti: -1 as uint
[18:39:28] <rusti> 18446744073709551615
[18:39:43] *** Quits: vmx (vmx@moz-BF18EC34.dip0.t-ipconnect.de) (Quit: Leaving)
[18:45:44] <engla> thpickert: I think it is  obj.each_split_char  now.. it's been renamed anyway
[18:45:46] <kimundi> thpickert: Okay, your first problem is that the docs you found are ancient :D
[18:46:07] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:46:27] <thpickert> kimundi: Yeah, I figured as much. :/ The docs culture around Rust is awful. :)
[18:46:53] <kimundi> 'broken' would be more accurate, but yeah
[18:47:00] <engla> static.rust-lang.org/doc/core/str.html
[18:47:05] <engla> aren't those updated often
[18:47:05] <kimundi> http://static.rust-lang.org/doc/core/str.html
[18:47:22] <thiez> As I recall the docs come from master
[18:47:23] <engla> kimundi: I got you beat
[18:47:29] <kimundi> :P
[18:47:35] <thiez> but we rarely update master, everything goes to incoming :D
[18:48:08] <brson> speaking of, incoming is *still* red
[18:48:11] <engla> that's the core of the problem
[18:48:47] <thpickert> engla: kimundi: Thanks. I've seen those, too, but got only more confused on how to apply those to my problem.
[18:48:49] <brson> if somebody wants to rewrite rustdoc they have my blessing, as long as it is better than the current incarnation
[18:49:39] <brson> i don't think i will be able to seriously revisit rustdoc for at least 6 months
[18:50:25] <kimundi> rusti: for str::each_split_char("fooÎ»barÎ»baz", 'Î»') |s| { print(s); }
[18:50:25] <brson> hm, the failure on incoming is one that i have a pull for, so we're still waiting to see what happens there
[18:50:26] <rusti> foobarbaz
[18:50:33] <brson> and freebsd is broken
[18:50:51] <kimundi> rusti: for str::each_split_char("fooÎ»barÎ»baz", 'Î»') |s| { println(s); } // thpickert \/
[18:50:53] <rusti> foo
[18:50:53] <rusti> bar
[18:50:53] <rusti> baz
[18:51:46] <thpickert> kimundi: Thanks, one step further. :)
[18:51:57] <brson> strcat: is there an attribute to make something non-copyable?
[18:52:17] <brson> oh, actually I don't need it. my struct will have a dtor
[18:52:31] <kimundi> rusti: do iter::to_vec |pushf| {str::each_split_char("fooÎ»barÎ»baz", 'Î»', pushf)} // <- thpickert
[18:52:33] <rusti> ~["foo", "bar", "baz"]
[18:53:03] <thpickert> That's exactly the result I wanted!
[18:53:24] <thpickert> It seems convoluted, but I'll take it!
[18:53:30] <thpickert> kimundi: Thanks a lot!
[18:53:35] <kimundi> np
[18:53:39] <thpickert> Also rusti is great.
[18:53:43] <kimundi> jup
[18:53:52] * kimundi pats strcat on the back
[18:57:52] *** Quits: Ralith (ralith@moz-729DC03E.wireless.sfu.ca) (Ping timeout)
[18:59:23] <thiez> I think rusti the irc-bot has claimed the spot in our hearts where rusti the rust interpreter should have lived :D
[18:59:46] <kimundi> thpickert: Honestly it is convoluted, ideally there would be a split_char() method that returns an iterator, and you could do "fooÎ»barÎ»baz".split_char('Î»).to_vec()
[19:00:32] <thpickert> That's what I figured was there at one point, and seemingly got tossed out?
[19:01:10] <cmr> brson: I'm interested in rustdoc, but I have a few other things I want to do first
[19:01:26] <kimundi> What was there was a function that returned an ~[~str] , that is one vector allocation and n string allocations
[19:02:17] <kimundi> The current system with the iterator function instead wortks with slices, so no allocation at all.
[19:02:30] <engla> it would be nice if the Buildable trait could be used to extract it as any kind of collection, for example a Set of strings
[19:02:42] <engla> from an iterator
[19:03:10] <kimundi> Well, afaik there is Set::from_iterable() already
[19:03:22] <cmr> strcat has a bunch of iter changesin store,afaik
[19:04:18] <engla> kimundi: I can't see it 
[19:04:43] <kimundi> engla: Maybe it only exists in theory atm :)
[19:04:56] <kimundi> Just heard strcat mentioning it
[19:05:17] <engla> ok I get it
[19:05:21] <thiez> do we have a repeating iterator yet?
[19:06:06] <thiez> one that just endlessly repeats the same value
[19:08:04] <thiez> and a function-iterator, that endlessly generates values from some internal state and a provided function
[19:08:34] <engla> the latter exists, scan
[19:08:47] <engla> in incoming
[19:09:29] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:09:30] <thiez> ooh, nice
[19:09:34] <brson> cmr: great! i'll give you whatever assistance i can
[19:10:18] <erickt> graydon: ping
[19:11:22] <engla> wait, the scan is a method on an iterator
[19:11:37] <thiez> ooh, disappoint :p
[19:18:41] <strcat> bstrie: ugh, whoops
[19:20:35] <strcat> engla: scan is an iterator adaptor
[19:20:41] <cmr> brson: much appreciated! :)
[19:20:42] <strcat> you can call it as a method on any Iterator impl
[19:21:37] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:21:37] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/FUfBLA
[19:21:37] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:22:24] <strcat> nmatsakis: btw I tried implementing Clone for borrowed ptrs and it doesn't seem to have worked. not sure why
[19:22:46] <nmatsakis> strcat: what...is it supposed to do?
[19:22:48] <strcat> nmatsakis: http://ix.io/5Ep this compiles
[19:22:51] <engla> strcat: I saw that later.  Will the advance method on Iterator be renamed to each later? It would be logical I think
[19:22:53] <strcat> but..
[19:23:01] <strcat>     let x = 5i;
[19:23:03] <strcat>     let y: &int = &x;
[19:23:05] <strcat>     let z: &int = y.clone();
[19:23:10] <strcat> /home/strcat/projects/rust/src/libcore/clone.rs:116:18: 116:28 error: mismatched types: expected `&int` but found `int` (expected &-ptr but found int)
[19:23:12] <strcat> /home/strcat/projects/rust/src/libcore/clone.rs:116     let z: &int = y.clone();
[19:23:14] <strcat> it's doing auto-deref ;\
[19:23:30] *** Joins: pooster (Mibbit@8C90D23B.8464AE6F.162D18E4.IP)
[19:23:51] <strcat> nmatsakis: it's a missing thing for replacing Copy completely
[19:24:07] *** Quits: joone (joone@E10A1781.2160464A.A34EC3BB.IP) (Ping timeout)
[19:24:14] <nmatsakis> strcat: yes, I see. I ... imagine this is somewhat the expected behavior.
[19:24:26] <nmatsakis> strcat: you'd have to write (&y).clone()
[19:24:39] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:24:40] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/IqxwLg
[19:24:40] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:24:40] <nmatsakis> strcat: pcwalton's proposal to make clone a static function would address this
[19:24:42] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:24:42] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/68NYlQ
[19:24:42] <ghrust> 13rust/06auto 14fa45958 15Daniel Micay: clone: clarify docstring
[19:24:42] <ghrust> 13rust/06auto 1475822f2 15Daniel Micay: add a DeepClone trait...
[19:24:42] <ghrust> 13rust/06auto 14cda3ac9 15Daniel Micay: rc: fix tests
[19:24:42] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:24:48] <strcat> nmatsakis: even though y is a borrowed ptr?
[19:24:58] <pooster> hi guys, is this right library i want to use if want a simple http client http://static.rust-lang.org/doc/std/net_url.html ?
[19:25:05] <nmatsakis> strcat: sure, because clone takes &self, so what it really wants is a &&int
[19:25:20] <strcat> nmatsakis: isn't &self & &'self int in that example?
[19:25:27] <strcat> T is &'self int
[19:25:33] <nmatsakis> strcat: yes
[19:25:38] <nmatsakis> strcat: I didn't go into that level of detail :)
[19:26:09] *** Joins: zq (p@moz-4A6945B7.de)
[19:26:20] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.0)
[19:26:52] <nmatsakis> strcat: this is a side-effect of the current method resolution rules, which basically auto-deref until they can't autoderef any more, and then auto-ref
[19:26:58] <strcat> ah
[19:27:00] <nmatsakis> strcat: well, thta's not quite right
[19:27:10] <nmatsakis> they do try auto-refing at each step I think, I have to go review
[19:27:42] *** Quits: dherman (dherman@moz-95C48841.sub-70-197-11.myvzw.com) (Quit: dherman)
[19:27:54] <strcat> this is probably the only time you actually want to make a different impl for &T and T, so maybe treating it as a special case is fine
[19:29:50] <nmatsakis> strcat: actually i'm a bit surprised it doesn't work, now that I look at the code.
[19:30:24] <nmatsakis> strcat: can you run with RUST_LOG=rustc::middle::typeck::check::method and gist the output?
[19:30:25] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:30:46] <strcat> nmatsakis: yeah, sec
[19:30:58] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[19:33:02] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[19:33:20] <kimundi> engla: 'each' might not be the best name on iterators
[19:33:25] <strcat> nmatsakis: it's really slow with all the output ;p
[19:33:51] <strcat> I could probably cut down a test case before it finishes...
[19:35:46] <cmr> So what replaced the swap operator?
[19:35:56] <strcat> swap(&mut x, &mut y)
[19:36:02] <strcat> replace(&mut x, foo)
[19:36:09] <strcat> vec.swap(idx, idx)
[19:36:46] <cmr> where are the first two defined/documented?
[19:36:52] <strcat> core::util
[19:36:59] <cmr> thanks
[19:37:06] *** Quits: pooster (Mibbit@8C90D23B.8464AE6F.162D18E4.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:38:12] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Ping timeout)
[19:38:43] <engla> kimundi: why not, it would be consistent with  for vector.each {}   for iterator.each {}
[19:38:44] <strcat> nmatsakis: http://ix.io/5Es output, http://ix.io/5Et code
[19:38:49] <strcat> nmatsakis: cut it down to a simpler test case
[19:39:12] <kimundi> engla: because it has different semantic than vector.each
[19:39:50] <nmatsakis> strcat: ah, I see what's happening. duh. I guess this...is the expected outcome.
[19:39:57] *** Joins: btipling (btipling@moz-5A640456.new.xen.prgmr.com)
[19:40:11] <kimundi> engla: vec.each() : for all elements of the vector. iterator.each: for each next element in the iterator
[19:40:43] <nmatsakis> strcat: it's plausible that the method rules should be tweaked to favor autoref over not, there is probably no "right" answer here for all cases.
[19:40:58] <engla> I don't think that's a conflict. the real conflict is that the signature is different. so it's a no-go
[19:41:02] <nmatsakis> strcat: what happens is that we try to "plain type" of y first (`&int`). That matches the impl for `int`.
[19:41:17] <nmatsakis> strcat: if we tried the autoref'd type first (`&&int`) it'd work, I'm not sure what else would break, maybe nothing.
[19:41:33] <strcat> nmatsakis: it seems like it could try ref, then start auto-derefing but still trying to ref after each iteration of auto-deref
[19:41:42] <kimundi> engla iterators can be stopped in 'advance' and resumed afterwards without going back to the first one
[19:41:48] <engla> I know
[19:41:58] <nmatsakis> strcat: yes, given that `&self` is the default these days, that might be best. it'd be easy to experiment, it's just switching two lines of code...
[19:42:54] <nmatsakis> strcat: if you want to try, edit method.rs (in the module I gaev you above) at line 199---remove the match and just leave the "DoDerefArgs" case
[19:42:58] <strcat> nmatsakis: if you had a 'self' (by-value) method with an impl for T and &T, would it actually call the &T method with auto-ref?
[19:43:07] <strcat> or does it only auto-ref for &self and &mut self
[19:43:14] <nmatsakis> strcat: it would call with auto-ref.
[19:43:26] <nmatsakis> strcat: it doesn't know yet whether it's &self or not, it's not sure which method you're calling after all
[19:43:37] <nmatsakis> strcat: and there might be multiple methods with the same name but different self types.
[19:43:42] <strcat> it seems like it should only auto-ref for &self/&mut self but maybe that's not possible.
[19:44:04] <nmatsakis> strcat: it's not possible in general.
[19:44:05] <pcwalton> can we just autoderef once?
[19:44:23] <nmatsakis> pcwalton: we could, it'd be inconsistent with what we do elsewhere, and it wouldn't address this problem
[19:44:33] <strcat> btw a place where I find auto-deref really annoying is when you have an impl on T
[19:44:33] <nmatsakis> pcwalton: but it might be a better thing in general, though I tihnk it'd be annoying
[19:44:34] <pcwalton> right
[19:44:36] <strcat> and then you add an ~T impl
[19:44:38] <strcat> and it breaks everything
[19:44:39] <pcwalton> it'd be annoying?
[19:45:02] <nmatsakis> well, maybe not. it happens not infrequently that I have &@T or something
[19:45:12] <nmatsakis> but usually in each, and you can just add the &x pattern
[19:45:26] <strcat> and &&x should parse now that modes are gone
[19:45:34] <strcat> & &x is annoying ;p
[19:45:43] <otters> you're annoying
[19:45:53] <strcat> ;)
[19:47:18] <kimundi> engla: It's just.. if you have a iterator for all elements of an vector, then iter.each() doesn't mean 'each element' but 'starting from current state, all next elements'. I think that could be confusing...
[19:48:04] <kimundi> Maybe 'for iter.all_next |...| { ... }' would be a clearer choice?
[19:48:15] * strcat is happy with advance
[19:48:31] <strcat> or .fwd() and .rev()
[19:48:38] <strcat> I'm going to extend it to bidirectional iters
[19:48:56] <strcat> for foo.fwd |x| { bla bla bla break }
[19:49:02] <strcat> for foo.rev |x| { ... }
[19:49:11] <rgrinberg> a/join #ocaml
[19:49:12] <kimundi> strcat: But the phrase 'for advance' doesn't make much sense ;) I like it if those lines read like a proper sentence
[19:49:23] <thiez> let's name it 'science' then
[19:49:32] <thiez> for science!
[19:49:44] <strcat> kimundi: it has to be a verb though
[19:49:46] <strcat> it uses &mut
[19:49:57] <strcat> 'each' only makes sense if you're observing stuff
[19:50:02] *** Quits: fabiand (fabiand@moz-4A5FABA0.adsl.alicedsl.de) (Quit: Verlassend)
[19:50:12] <strcat> at least that's how I like naming stuff ;p
[19:50:20] <strcat> &mut self or side effects -> verb
[19:51:04] <kimundi> hmmm, tricky! Two overlapping style decissions are at odd with each other :)
[19:51:20] <engla> kimundi: ok, I recognize the conflict from Python (where you can easily end up with either a once-iterable or a list in a variable)
[19:51:42] <strcat> python doesn't have internal iterators at all
[19:51:45] <strcat> neither does C++
[19:51:54] <strcat> or D
[19:52:14] <companion_cube> internal iterators?
[19:52:32] <strcat> iterators that take a closure and don't have a state object you can save/pause
[19:52:46] <companion_cube> oh, I see
[19:52:51] <kimundi> companion_cube: http://journal.stuffwithstuff.com/2013/01/13/iteration-inside-and-out/
[19:53:01] <strcat> python's iteration protocol is a __next__ method returning a value until it reaches the end
[19:53:03] <companion_cube> I didn't know this name
[19:53:06] <strcat> and then it throws StopIteration
[19:53:08] <strcat> so
[19:53:12] <companion_cube> I actually wrote both in OCaml :)
[19:53:16] <engla> but iterating consumingly has the same syntax in Python as in regular iteration.   it = ... something ;  for x in it: pass
[19:53:33] <strcat> engla: python has no consume vs regular iteration
[19:53:38] <strcat> for always uses an external iterator object
[19:53:40] <companion_cube> the next() approach is a bit more powerful though
[19:53:40] <kimundi> Wait strcat, iter.next() isn't a verb either ;)
[19:53:41] *** Joins: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP)
[19:53:41] *** ChanServ sets mode: +o tjc
[19:54:08] <strcat> kimundi: true, but it at least sounds more mutating than 'each' ;p
[19:54:23] <engla> strcat: compare  it = iter([1,2,3])   and it = [1,2,3]
[19:54:30] <kimundi> strcat: 'all_next' ftw! :P
[19:54:36] <strcat> engla: for x in [1, 2, 3]: print(x)
[19:54:37] <engla> the following code is the same. that's what I wanted to point out.
[19:54:42] <strcat> engla: that's using an external iterator
[19:54:49] <strcat> it calls .__iter__() to get an iterator
[19:54:54] <engla> I'm not talking about external/internal. yes I know.
[19:54:56] <strcat> and then calls .__next__() on the iterator until the end
[19:55:03] <strcat> it consumes the iterator
[19:55:13] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[19:55:17] <strcat> it just knows what an iterable is and how to get an iterator from it
[19:55:41] <strcat> I don't know how to even write an Iterable trait in rust without vtables
[19:55:51] <strcat> I guess it needs a lot of dummy type params
[19:56:01] <engla> ok again...  depending on what `it` is, this code has different output. it = iter([1,2,3]); for x in it: print x  ; for x in it: print x
[19:56:09] <engla> in one case you repeat and another not.
[19:56:23] <strcat> engla: because when you call it on a list it calls .__iter__() itself
[19:56:30] <strcat> it's still the same thing
[19:56:45] <companion_cube> is rust going to favor internal iterators?
[19:57:00] <engla> that's not the point I'm making. I'm sayign that Python has the conflict kimundi is talking about: iterating consumingly has the same syntax as not.
[19:57:01] <strcat> companion_cube: no
[19:57:14] <strcat> engla: oh
[19:58:08] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:58:14] <companion_cube> hmm
[19:58:29] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:58:34] <kimundi> companion_cube: rust is prefering external iterators, as they are better composable, but offers syntactic sugar for internal iteratiors because they are easier to write and because an external is easily convertable to an internal.
[19:58:53] <companion_cube> ok
[19:58:56] <strcat> can't write much of an iterator lib for internal iterators
[19:59:05] <strcat> no zip, merge, union, intersect, etc.
[19:59:20] <strcat> and they have to be annoying chains of closures instead of simple methods
[20:00:10] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[20:00:20] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[20:04:15] *** Joins: yosemite (sam@moz-8CEAB1B0.dasbistro.com)
[20:04:54] <companion_cube> you can write much, but things working on a single iterator
[20:05:06] <companion_cube> or things like flatten, append, ...
[20:05:29] <strcat> the function signatures get incredibly confusing
[20:05:42] <companion_cube> well, you need a type alias
[20:05:49] *** Quits: Jesse (jruderman@moz-4BE034AB.ptr.us.xo.net) (Quit: Jesse)
[20:05:51] <strcat> type aliases don't really help
[20:06:02] <kimundi> rusti: do iter::to_vec |pushf| {str::each_split_char("fooÎ»barÎ»baz", 'Î»', pushf)} // <- companion_cube 
[20:06:04] <rusti> ~["foo", "bar", "baz"]
[20:06:08] *** Joins: Jesse (jruderman@moz-4BE034AB.ptr.us.xo.net)
[20:06:18] <kimundi> that's just one chain link
[20:06:26] <erickt> nmatsakis: ping
[20:06:36] <thiez> hmmn, would it make sense to be able to send '&'static' items over channels?
[20:06:45] <kimundi> jup
[20:06:52] <strcat> fn filter<T>(predicate: &fn(&T) -> bool, input: &fn(&fn(T) -> bool) -> bool, iter: &fn(T) -> bool) -> bool
[20:07:00] <thiez> sadly they are not Owned
[20:07:02] <strcat> so yeah, I could add that to core::iter
[20:07:08] <strcat> how many people are going to figure out how to use it? ;p
[20:07:09] <companion_cube> https://github.com/c-cube/ocaml-containers/blob/master/sequence.mli  â† I wrote this in OCaml with internal iterators, many things work
[20:07:16] <companion_cube> (zip is the big issue)
[20:07:36] <strcat> companion_cube: well look at that filter signature
[20:07:40] <strcat> afaik there's no way to make it shorter
[20:08:21] <companion_cube> couldn't input be  &iterator<T>?
[20:08:22] <strcat> and it only works for iterators taking 1 arg (the closure), so the caller needs to wrap anything taking multiple args
[20:08:25] <strcat> companion_cube: no
[20:08:29] <strcat> companion_cube: not for internal iterators
[20:08:51] <strcat> the iteration protocol is a function taking fn(anything) -> bool as the last argument and returning bool
[20:08:52] <companion_cube> aww
[20:08:57] <strcat> there's no common set of arguments
[20:09:10] <strcat> companion_cube: there's Iterator<T> for external iterators
[20:09:16] <strcat> it can't be done for rust's internal iter protocol
[20:09:38] <strcat> iter::some_adaptor needs to work with any iterator
[20:09:49] <strcat> whether it's each, each_reverse, each_mut, union, whatever
[20:10:21] <strcat> iterator objects provide you with a common object interface you can abstract everything with
[20:10:45] <strcat> haskell's lazy lists are essentially external iterators
[20:10:46] <companion_cube> I'm just surprised you can't do an alias for the function signature of internal iterators
[20:11:09] <strcat> you could probably figure out a macro but it's only going to make people more confused
[20:11:13] <strcat> companion_cube: there are ones like
[20:11:14] *** Joins: lkuper (lkuper@moz-D6AAFF3.cs.indiana.edu)
[20:11:16] <kimundi> With aliases: fn filter<T>(predicate: IntIt<&T>, input: IntIt<IntIt<T>>, iter: IntIt<T>) -> bool ddd Not sure if that's more or less confusing...
[20:11:27] <strcat> fn foo(x, y, iter: &fn(a, b, c) -> bool) -> bool
[20:11:36] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[20:11:48] <strcat> well, filter is one...
[20:12:51] <nmatsakis> erickt: pong.
[20:14:46] *** Joins: cscottnet (cscott@moz-2577C94A.net)
[20:15:02] <erickt> nmatsakis: hey there. Just saw in the meeting notes the discussion about the universal function call syntax. It's pretty related to what I'm doing with the self argument, so assuming I can actually figure out how to promote the self arg into a real argument, that UFCS is the next logical step for me
[20:15:44] <cscottnet> "Assertion `!result && "chdir failed"' failed." trying to build rust for the first time from scratch (debian/linux; git clone; ./configure; make)
[20:15:50] <cscottnet> does that sound familiar to anyone?
[20:17:06] <erickt> cscottnet: any chance there's a space in the path you checked out rust?
[20:17:33] <cscottnet> erickt: nope: $ pwd
[20:17:33] <cscottnet> /home/cananian/Projects/Rust/rust
[20:17:38] <erickt> cscottnet: also, is it the configure that's giving that error, or make?
[20:17:44] <cscottnet> make
[20:17:55] <erickt> can you do a make VERBOSE=1?
[20:18:05] <erickt> and gist the output?
[20:18:11] <cscottnet> http://paste.debian.net/4412/
[20:18:18] <strcat> cscottnet: what did you checkout, incoming?
[20:18:22] <strcat> or just master?
[20:18:46] <cscottnet> git clone git://github.com/mozilla/rust.git
[20:18:52] <cscottnet> according to https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[20:18:57] <nmatsakis> erickt: yes, I think what you're doing is a necessary first step in that direction
[20:19:11] <strcat> cscottnet: try checking out the incoming branch
[20:19:22] <strcat> I think there was an issue on 32-bit linux that's been fixed
[20:19:56] <strcat> my daily build has been successful for the past week or so
[20:20:03] <strcat> but before then it was failing on 32-bit
[20:21:09] <cscottnet> strcat: ok, will try that.
[20:21:50] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:22:23] <erickt> nmatsakis: I'm just mentioning it because graydon was talking about reaching out to the larger community about it
[20:22:41] <erickt> I wanted to make sure my name was out there
[20:22:44] <nmatsakis> erickt: oh, I don't recall those comments, not sure what he meant by that
[20:23:03] <graydon> \o/
[20:23:13] <nmatsakis> erickt: but I agree with you that you'd be a logical person to take that work on, if you're amenable :)
[20:23:36] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[20:23:36] <nmatsakis> erickt: how
[20:23:41] <nmatsakis> erickt: er, how's that going btw?
[20:23:50] <strcat> nmatsakis: hm, I guess it's not possible to give a trait an "OR" bound ;p
[20:23:58] <graydon> I was suggesting that patrick might be able to coax a sufficiently passionate volunteer to take that one off his plate, since it is such a pleasing result and requires, I think, mostly just a lot of leg-work
[20:23:59] <strcat> a trait impl*
[20:24:07] <cscottnet> strcat: fwiw it looks like the only difference between master and incoming is in the src/libuv and src/llvm submodules.
[20:24:21] <nmatsakis> strcat: no.
[20:24:32] <strcat> cscottnet: master is 15 days old though
[20:24:40] <strcat> cscottnet: there have been a lot of changes since then
[20:25:31] <strcat> nmatsakis: is it actually possible to do something like 'impl<T: TraitA> Foo for T' and 'impl<T: TraitB> Foo for T' where TraitA and TraitB are never impl'ed on the same type?
[20:25:36] <cscottnet> strcat: ok, nevermind, git was misleading me
[20:26:10] <strcat> I remember trying and running into issues
[20:26:11] <erickt> nmatsakis: all my notes are on my other machine, but the crux of my current problem is trying to instantiate regions on self.
[20:26:23] <steven_is_false> nmatsakis: I remember asking on Stack Overflow whether it was possible to give Haskell type classes an Or bound.
[20:26:41] <strcat> nmatsakis: I guess what I really want is "NOT" ;p
[20:26:48] <strcat> hmm
[20:26:50] <strcat> actually no
[20:26:52] <strcat> not in this case
[20:26:54] * strcat sighs
[20:26:59] <steven_is_false> nmatsakis: I just assumed that it also wasn't possible for Rust traits but aren't Rust traits a lot more restricted?
[20:27:14] *** Quits: thpickert (thpickert@moz-99F22CD3.dynamic.dsl.tng.de) (Quit: thpickert)
[20:27:21] <strcat> if there were NonOwned and NonConst I could make 3 impls
[20:27:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[20:27:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/68NYlQ
[20:27:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[20:27:39] <strcat> T: Owned + Const, T: Owned + NonConst and T: Const + NonOwned
[20:28:19] * strcat would like to have !Owned ;p
[20:28:36] <steven_is_false> I think in general it is not possible to create a Not operator but maybe it is possible for a certain subset of traits.
[20:28:52] <steven_is_false> Eg) What we'd want is a meta-trait that classifies over traits.
[20:28:55] <strcat> well it would just fail to resolve if the type impl'ed that trait
[20:29:00] <strcat> seems possible to me ;p
[20:29:15] <steven_is_false> strcat: But what if some other crate implements the trait.
[20:29:22] <strcat> steven_is_false: it can't
[20:29:39] <strcat> if you can see the type and you can see the trait, you know whether or not the type will ever impl the trait
[20:29:41] <steven_is_false> strcat: Oh right, the situation is different with Haskell type classes.
[20:29:58] <steven_is_false> strcat: So you can make a Not operator!
[20:30:07] <erickt> nmatsakis: IIRC, I haven't figured out how to instantiate the region in the method.sig.self_ty. I tried overwriting it, but that didn't seem to do the trick
[20:30:31] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[20:30:31] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HisyDA
[20:30:31] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[20:30:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[20:30:32] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/YxRpXA
[20:30:32] <ghrust> 13rust/06auto 14c3875e8 15Tim Chevalier: rustpkg: Implement URL-like package IDs...
[20:30:32] <ghrust> 13rust/06auto 1480a7e26 15Tim Chevalier: rustpkg: Tests for well-formed and ill-formed package IDs......
[20:30:32] <ghrust> 13rust/06auto 146a9c3bd 15bors: auto merge of #6418 : catamorphism/rust/rustpkg, r=catamorphism...
[20:30:34] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[20:30:51] *** Joins: snadon (chatzilla@moz-F86CA4D4.mc.videotron.ca)
[20:31:54] <nmatsakis> steven_is_false: no, they're not, and no it's not possible.
[20:32:21] <nmatsakis> erickt: ok, well, that IS tricky, maybe when you hvae your notes we can discuss? it can be subtle
[20:32:22] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[20:32:43] <steven_is_false> nmatsakis: GHC only gives a warning when you create an orphan instance. Rust explicitly disallows it.
[20:32:44] <erickt> nmatsakis: sure! I'll try to put them online tonight
[20:33:23] <nmatsakis> steven_is_false: that is true, I wouldn't necessarily call it a "lot more restricted"---but I guess it is relevant in this case
[20:33:58] <erickt> nmatsakis: part of me is tempted to just jump right into UFCS, and keep all the method info in a side table
[20:34:12] <steven_is_false> nmatsakis: okay
[20:35:12] <nmatsakis> erickt: I think that ideally there wouldn't really be any "method info"---
[20:35:30] <nmatsakis> erickt: the self type and so on would just be syntactic sugar
[20:35:44] <steven_is_false> What's the smallest floating point number?
[20:35:57] <erickt> nmatsakis: doesn't typeck need some level of method info?
[20:35:57] <nmatsakis> erickt: actually that is a design point that is unclear to me. 
[20:36:14] *** Joins: themgt (themgt@moz-F5F3FFDF.dhcp.gnvl.sc.charter.com)
[20:36:14] <erickt> nmatsakis: in order to choose which of these methods correspond to which type?
[20:36:21] <nmatsakis> erickt: in particular, should "fn foo(&self)" be distinguishable in any way from "fn foo(self: &Self)"
[20:36:41] <erickt> trans shouldn't need method info though
[20:36:43] <nmatsakis> erickt: well, that's kind of the question. I'm tempted to say it should just look at the first argument of the fns
[20:36:53] <kimundi> steven_is_false: depends on type size and what you mean with smallest :P
[20:36:58] <nmatsakis> erickt: &self would just be equivalent to a first ragument of "&Self"
[20:37:24] <nmatsakis> erickt: but if we wanted to say that you had to use one of the self shorthands to use method syntax, then yes it would need tha tinfo
[20:37:32] <kimundi> steven_is_false: your choices: -inf, ~ -10e38, ~ -10e308
[20:37:49] <steven_is_false> kimundi: Right.I'm not actually sure, don't some GPUs use 16 bit floats for low precision, some use 32, etc..?
[20:38:12] <kimundi> gpus I have no idea, but mostly it's 32bit I think
[20:38:16] *** Quits: snadon (chatzilla@moz-F86CA4D4.mc.videotron.ca) (Ping timeout)
[20:39:01] <steven_is_false> kimundi: Right, and I meant smallest positive number.
[20:39:14] <erickt> nmatsakis: do you think the conversion from `x.f(y)` to `f(x, y)` should be done at parse time, or would it be better to do that at typeck time?
[20:39:22] <kimundi> aaah, that's more interesting
[20:39:35] <nmatsakis> erickt: those two are not equivalent
[20:39:46] <nmatsakis> erickt: x.f(y) decides on `f` based on the type of `x`
[20:39:51] <strcat> nmatsakis: I guess I don't really need anything special, I just need another kind
[20:39:56] <nmatsakis> erickt: `f(x, y)` decides on `f` by lexical scoping
[20:39:59] <nmatsakis> erickt: hence it must be typeck time
[20:40:08] <nmatsakis> strcat: "negative" traits and kinds are definitely special
[20:40:16] <strcat> would be annoying to manually add all the combinations
[20:40:21] <erickt> nmatsakis: gotcha
[20:40:24] *** Joins: snadon (chatzilla@moz-F86CA4D4.mc.videotron.ca)
[20:40:41] <kimundi> steven_is_false: first of, generally same as above: ca 10e-38 for 32bit floats and ca 10e-308 for 64bit floats. but then there are also subnormal floats...
[20:40:48] <nmatsakis> strcat: what are you doing?
[20:41:02] <strcat> I essentially need 'Const | Owned' both for Rc/Rcmut (to prevent cycles), but also for the Eq/Ord impls on @
[20:41:12] <strcat> but Rc/RcMut can just have 2 sets of constructors
[20:41:12] <steven_is_false> kimundi: Oh shoot. I forgot about subnormals.
[20:41:27] <strcat> so it's really only an issue for trait impls
[20:41:54] <nmatsakis> strcat: so, the coherence check is stricter than it needs to be here, I think.
[20:41:59] <nmatsakis> strcat: well, not in that case.
[20:42:08] <steven_is_false> kimundi: What I'm trying to do is create a square wave function that changes from 1 to 0 every other number
[20:42:18] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[20:42:20] <nmatsakis> strcat: I mean it's clearly the case that there are types that could be Const or Owned
[20:42:32] <nmatsakis> strcat: I guess what you're saying is that you want some super trait of Const and Owned
[20:42:40] <strcat> nmatsakis: well I want either Const or Owned
[20:42:45] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:42:52] <strcat> if it's Owned, it can't have @/@mut/Rc/RcMut in it anyway so you know it's non-cyclic
[20:43:06] <strcat> if it's Const, it can't have @mut/RcMut in it and you can't create a cycle with @/Rc if it's Const
[20:43:16] <nmatsakis> strcat: sorry I mean there are types that could be both Const and Owned, so you could can't have on impl with Const and one impl with Owned
[20:43:21] <strcat> ah yeah
[20:43:41] <strcat> for the constructors I'm just going to make from_owned and from_const
[20:43:46] <strcat> no idea what to do about Eq/Ord though.
[20:44:03] <strcat> I'll just use Const
[20:44:23] <strcat> it's not very restrictive to say that Cell turns off the default Eq/Ord impl on @/@mut
[20:44:40] <nmatsakis> strcat: why not just not define Eq for @mut, Cell, etc
[20:44:58] <nmatsakis> strcat: there is no obvious default implementation, after all.
[20:45:00] <strcat> nmatsakis: it can be defined for @mut though with T: Const
[20:45:09] <strcat> that way you know it's not cyclic
[20:45:12] <nmatsakis> strcat: why? it's not obvious that's whta you want
[20:45:16] <nmatsakis> strcat: you may want identity semantics there
[20:45:35] <strcat> true
[20:45:40] <kimundi> steven_is_false, 
[20:45:44] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Client exited)
[20:45:48] <steven_is_false> kimundi: Yes?
[20:45:48] <strcat> nmatsakis: Eq will already auto-deref though
[20:45:54] <strcat> I think it would be bad to have different impls
[20:46:09] <erickt> nmatsakis: I was wrong, trans does need some notion of methods. Translating expr_method_call needs some mechanism to discover which function is getting called. Right now it's using the call.id to look up the method in a side table
[20:46:26] <nmatsakis> strcat: Eq does not autoderef on the LHS
[20:46:29] <kimundi> steven_is_false, hm I'm not sure how the size of float values and that function correlate?
[20:46:35] <strcat> nmatsakis: ah, didn't realize that
[20:46:37] <nmatsakis> erickt: I don't think it does
[20:46:40] <nmatsakis> erickt: need much notion at all
[20:46:42] <strcat> nmatsakis: foo.eq(&x) will though
[20:46:48] <strcat> not that it matters much
[20:46:53] <nmatsakis> erickt: I think all calls should have a "call_info" side table, basically
[20:47:10] <steven_is_false> kimundi: Well, for higher precision float values my fuzz function changes more rapidly
[20:47:12] <nmatsakis> erickt: and the only real difference between expr_call and expr_method_call is how the list arguments is assembled
[20:47:22] <nmatsakis> erickt: but...it'll have to know something I guess, for vtables etc
[20:47:27] <strcat> nmatsakis: anyway just going to make the Rc/RcMut constructors more lenient for now. the current Owned bound is overly restrictive
[20:47:48] <erickt> nmatsakis: putting all the info for calls in a side table isn't so bad
[20:47:48] <nmatsakis> erickt: I guess it's just that there will be very little difference, not none at all --- not sure precisely what you were thinking though, that may or may not mean you were wrong :)
[20:47:51] <kimundi> steven_is_false: I guess I don't understand what that function is supossed to do?
[20:48:19] <steven_is_false> kimundi: Suppose one has a ball, and regularly dots the surface with a 1, or a 0.
[20:48:52] <steven_is_false> kimundi: Once mapped to 2D the ones will tend to cluster near the slopes, and valleys.
[20:49:22] <strcat> nmatsakis: https://github.com/mozilla/rust/pull/6509 r?
[20:49:33] <steven_is_false> kimundi: If one blurs out the ones, and zeros (in 2d, not 3d) then one will have a measure of the edgeness of the points.
[20:49:52] <kimundi> steven_is_false: Ah is it about that edge detection algorithm?
[20:50:14] <steven_is_false> kimundi: Yes. And I think it should work better if I use more points.
[20:50:44] <kimundi> And the question is at which point more points becomes to many, gotcha
[20:50:48] <nmatsakis> strcat: r+
[20:51:46] <kimundi> hmm... I'm afraid I don't know enough about the  matrix calculation and floating point behaviors...
[20:52:26] <steven_is_false> kimundi: Yeah, it's kind of a complicated question.
[20:52:46] <steven_is_false> kimundi: The algorith is almost working anyways.
[20:53:07] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[20:53:26] <erickt> nmatsakis: so one side table of node_id->call_info to help translate fn/closure/method items, and another to map node_id->node_id to map call exprs to the fn/closure/method items?
[20:54:14] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Quit: Leaving)
[20:54:15] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[20:54:33] *** Joins: dherman (dherman@moz-95C48841.sub-70-197-11.myvzw.com)
[20:54:33] *** ChanServ sets mode: +o dherman
[20:55:01] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[20:56:42] <nmatsakis> erickt: that doesn't...quite match up to what I was thinking?
[20:56:56] <nmatsakis> erickt: I was thinking that the CallInfo table would be keyed by the expr if of the call
[20:57:16] <nmatsakis> erickt: basically an expanded version of today's method_map
[20:57:23] <nmatsakis> erickt: I'm not sure what the second table you proposed would be
[20:59:22] <bstrie> I think the bors queue is reaching critical velocity
[20:59:30] <bstrie> it's running as fast as it can just to stay in the same place
[20:59:58] <bstrie> what are the obstacles to running the test suite in parallel?
[20:59:59] <erickt> nmatsakis: maybe it's unnecessary. the second table would be to map an item to a call info. This really is to eliminate the redundant information that's stored in both this new call_info_map and ty::method
[21:00:03] <bstrie> even -j2 would be HUGE
[21:00:13] *** Quits: webber46 (webber46@moz-F6310FF0.lha.sgsnet.se) (Quit: webber46)
[21:00:42] <strcat> bstrie: the tests run in parallel but they don't compile in parallel
[21:00:46] <strcat> memory usage is a big problem
[21:00:52] <strcat> it takes >2GiB to compile those
[21:01:20] <bstrie> that seems excessive
[21:01:50] *** Joins: azita (Azita@moz-4BE034AB.ptr.us.xo.net)
[21:03:36] <nmatsakis> erickt: I see, not sure if that's necessary, but maybe it works out
[21:06:26] <erickt> nmatsakis: Another question. How does monomorphization work with all this? Does that happen lazily during trans?
[21:06:48] <nmatsakis> erickt: yes, the way it works is that trans tracks the current types bound to each in-scope type parameter
[21:06:55] <nmatsakis> erickt: and trans proceesses the same AST multiple times
[21:06:58] <nmatsakis> erickt: with different bindings
[21:07:26] <nmatsakis> erickt: that's why you see things like `expr_ty(bcx, expr)` rather than `ty::expr_ty(tcx, expr)`
[21:07:33] <nmatsakis> erickt: because the bcx in trans carries the bindings for the type parameters
[21:10:24] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[21:12:09] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[21:12:29] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[21:14:31] *** Quits: KindOne (KindOne@moz-2D30BEE8.dynamic.ip.windstream.net) (Ping timeout)
[21:16:35] *** Joins: samnardoni (samnardoni@moz-ECB14881.cable.virginmedia.com)
[21:16:36] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[21:16:38] <nmatsakis> erickt: I'm getting excited about this :)
[21:19:00] <strcat> bstrie: graydon is working on it
[21:19:08] <strcat> better string interner
[21:19:29] <strcat> + the headers on boxes can go away when the gc lands, so @ will probably use more memory but non-managed ~ will use less
[21:19:30] *** Joins: KindOne (KindOne@moz-2D30BEE8.dynamic.ip.windstream.net)
[21:19:36] <graydon> I have a patch. it causes weird behavior.
[21:19:43] <strcat> and we can probably convert a lot of stuff to ~ and & in librustc
[21:19:53] <strcat> also, tcmalloc/jemalloc would help
[21:20:05] <strcat> they use as much as 1/2 as much memory for many alloc sizes
[21:20:09] <strcat> (small alloc sizes)
[21:20:14] <graydon> that part I am working on today
[21:20:22] <graydon> turns out the trie itself is too expensive to use here
[21:20:32] <strcat> graydon: yeah it needs buckets
[21:20:37] <strcat> uses a lot of memory
[21:20:51] <strcat> graydon: I have a branch with a really terrible burst trie impl
[21:20:52] <graydon> I have a fix in progress
[21:20:59] <strcat> it uses a lot less memory
[21:21:03] <graydon> it has to be really, really dense.
[21:21:14] <graydon> I'm trying storing bitmaps instead
[21:21:27] <strcat> graydon: well it makes buckets of 8-64 suffixes in ~[] vectors
[21:21:35] <strcat> haven't picked a number
[21:21:45] <pcwalton> yay bitmaps
[21:21:49] <strcat> External(~[(K, V)]) basically
[21:22:13] <strcat> it's generally much faster than the old impl but...
[21:22:20] <strcat> remove gets 3x slower :(
[21:22:25] <strcat> because of how expensive moves are
[21:22:27] *** Quits: KindOne (KindOne@moz-2D30BEE8.dynamic.ip.windstream.net) (Ping timeout)
[21:22:28] <graydon> give me a while to try to get the bitmaps working. back-of-envelope says I can encode an allocation in 32bits-or-less most of the time, and lookups for all <= page allocs becomes O(1)
[21:22:58] <graydon> size, size. who knew we'd be running out of memory? bleh
[21:23:03] <graydon> this is all so disappointing. oh well.
[21:23:16] <pcwalton> it's good for us to be hitting these limits
[21:23:18] <strcat> graydon: well drop in tcmalloc/jemalloc and the small allocs will often be much smaller.
[21:23:23] <graydon> considering one of the major design premises for rust is "systems programming is usually about memory density", I'm not really that shocked
[21:23:30] <strcat> tcmalloc doesn't round 8 bytes to 16 bytes, it stores 8 bytes
[21:23:33] <strcat> as does jemalloc
[21:23:37] <graydon> strcat: that'll be helpful!
[21:23:50] <strcat> and jemalloc/tcmalloc only have 1-2% metadata overhead
[21:23:52] <pcwalton> I would much rather *us* hit them than for us to release 1.0 and people to write angry articles like "Rust is unusable on 32 bit" that make it to the top of HN
[21:23:55] <strcat> glibc has 4 bytes per alloc or something :(
[21:24:09] <strcat> graydon: I actually hit a segfault with LD_PRELOAD make check atm ;\
[21:24:16] <graydon> the trie is currently consuming 500mb though. so .. gimme an afternoon to see if I get this working
[21:24:18] <strcat> maybe it would work fine compiled in
[21:24:26] *** Joins: KindOne (KindOne@moz-2D30BEE8.dynamic.ip.windstream.net)
[21:25:01] *** Quits: azita (Azita@moz-4BE034AB.ptr.us.xo.net) (Quit: azita)
[21:26:21] <thiez> cool, I got a program to compile and segfault without any unsafe code :D
[21:28:04] <strcat> graydon: atm the tree nodes are at least 4x as big as they should be for one thing
[21:28:07] <strcat> trie*
[21:28:08] *** Joins: gareth0 (gareth0@moz-AAA7F888.dynamic.dsl.as9105.com)
[21:28:19] <graydon> strcat: I know. I'm not trying to be critical. it's just .. how it is :(
[21:28:23] <strcat> glibc is being evil and rounding up :(
[21:28:31] <erickt> nmatsakis: glad to hear it :)
[21:28:42] <strcat> TreeMap's find fn gets 2x faster with jemalloc/tcmalloc
[21:29:00] <strcat> graydon: yeah it's a plain trie which consumes a lot already
[21:29:10] <strcat> + the various other problems ;p
[21:29:35] <pcwalton> strcat: whoa
[21:29:55] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[21:30:11] <strcat> pcwalton: http://ix.io/5DL glibc vs http://ix.io/5DM tcmalloc (jemalloc and tcmalloc are pretty similar for this)
[21:30:33] <strcat> oh sorry I think the first paste is jemalloc, not tcmalloc
[21:30:41] *** Quits: jviereck1 (Adium@moz-340574DC.dclient.hispeed.ch) (Quit: Leaving.)
[21:30:43] <strcat> tcmalloc made inserts faster
[21:31:09] *** Quits: Blub\w (wry@moz-C00B5153.wireless.dyn.drei.com) (Quit: bb2m)
[21:31:20] <strcat> but jcmalloc did a bit better for array/hashmap reallocs
[21:31:36] <strcat> they both are essentially lock-free so I can't measure much of a difference with threads....
[21:32:29] <strcat> pcwalton: anyway jemalloc/tcmalloc make per-size arenas like a generational gc
[21:32:32] <strcat> so treemap likes it ;p
[21:32:47] <pcwalton> we should switch to it
[21:32:51] <pcwalton> does it make rustc faster?
[21:33:01] <strcat> pcwalton: yes, ~5-8%
[21:33:10] <pcwalton> why are we not doing this yesterday ;)
[21:33:17] <strcat> it makes it consume less memory too
[21:33:18] <gareth0> rustc is slower than a dead snail
[21:33:20] <pcwalton> 5-8% is huge
[21:33:30] <strcat> tcmalloc never gives up VIRT memory but it gives up RES just fine
[21:33:32] <pcwalton> yes, we know
[21:33:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:33:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/YxRpXA
[21:33:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:33:39] <strcat> uses madvice MADV_DONTNEED
[21:33:46] <strcat> which drops the RES usage
[21:33:53] <strcat> works on windows too afaik since it's mmap
[21:34:05] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[21:34:07] <strcat> glibc actually gives up the VIRT memory which is slow
[21:34:19] <strcat> pcwalton: it's probably a lot bigger on windows
[21:34:40] <strcat> I wouldn't be surprised if it sped it up by 30%+ on windows
[21:35:41] <strcat> pcwalton: it will also be a much bigger improvement when malloc/free are inlined
[21:35:54] <strcat> with C++/std::map it's a bigger improvement because there's less constant overhead
[21:36:11] <strcat> anyway, easy win ;p
[21:36:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:36:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Wymf_g
[21:36:32] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:36:33] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:36:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/IaVmXA
[21:36:33] <ghrust> 13rust/06auto 148327900 15Tim Chevalier: testsuite: Add passing test for #4107
[21:36:33] <ghrust> 13rust/06auto 143dd6be6 15bors: auto merge of #6483 : catamorphism/rust/issue-4107, r=catamorphism
[21:36:33] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:37:14] <strcat> http://llvm.org/docs/doxygen/html/Allocator_8h_source.html looks like LLVM uses internal allocators
[21:38:19] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[21:40:48] *** Joins: passcod (passcod@moz-5BCF5019.passcod.name)
[21:43:05] <pcwalton> nmatsakis: do you know if the self type is the first type in make_impl_vtable's "substs" parameter?
[21:43:17] <pcwalton> I'm confused as to why substs is a ~[ty::t] and not a ty::substs with a self_ty in it
[21:43:52] <thiez> rusti: do (~["a","b"]).consume |_,x| { println(x) };
[21:43:54] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[21:44:03] <thiez> rusti: 5
[21:44:04] <rusti> 5
[21:44:18] <thiez> strcat: any idea why it is ignoring the first line?
[21:44:27] <pcwalton> rusti: println("hi")
[21:44:29] <rusti> hi
[21:44:32] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[21:44:39] <kimundi> hrrmmmm... Should this really work?
[21:44:42] <strcat> rusti: println("foo"); println("bar")
[21:44:43] <rusti> foo
[21:44:43] <rusti> bar
[21:44:44] <kimundi> rusti: (-1f/0f).to_uint()
[21:44:45] <rusti> 9223372036854775808
[21:44:47] <strcat> thiez: nope :(
[21:44:55] <strcat> rusti: println("foo"); println("bar"); core::run::run_program("cat", []);
[21:45:00] <rusti> foo
[21:45:00] <rusti> bar
[21:45:00] <rusti> timed out after 5 seconds
[21:45:04] <thiez> strcat: what happens when you run a program that segfaults?
[21:45:16] <strcat> rusti: unsafe { libc::abort() }
[21:45:18] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/WTBD
[21:45:19] <thiez> I think consume still segfaults when it's a method...
[21:45:28] <strcat> rusti: fn foo() { unsafe { libc::abort() } } foo()
[21:45:37] <strcat> thiez: oh it's silent now
[21:45:39] <strcat> I can fix that
[21:45:45] <strcat> it needs to redirect stderr to stdout
[21:45:47] <strcat> sec
[21:45:49] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:46:23] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:46:27] <strcat> rusti: fn foo() { unsafe { libc::abort() } } foo()
[21:46:35] <strcat> hm.
[21:46:40] <strcat> rusti: aa
[21:46:41] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/PXba
[21:46:51] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:47:09] <thiez> rusti: fn foo() { unsafe { libc::abort() } } println("hai"); foo() ; 3
[21:47:20] <thiez> oh, too late :D
[21:47:46] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[21:47:49] <graydon> huh
[21:47:55] <pcwalton> nmatsakis: never mind, it doesn't. I guess this is a relic of the impls from a year ago. I'll thread a self_ty parameter through
[21:48:00] *** Quits: gareth0 (gareth0@moz-AAA7F888.dynamic.dsl.as9105.com) (Quit: Leaving)
[21:48:33] <graydon> anyone seen the "index out of bounds: len is 2, index is 2" ICE during typecheck?
[21:48:39] <pcwalton> nope
[21:48:49] <strcat> thiez: ok I figured it out
[21:48:59] <strcat> I was doing 'exec ./foo'
[21:49:08] <strcat> and nothing was reporting the segfault
[21:49:23] <strcat> I really want to use exec though, 4MiB of memory!
[21:49:30] <strcat> sec
[21:50:42] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Ping timeout)
[21:50:44] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[21:50:59] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:51:38] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[21:52:02] *** Quits: Jesse (jruderman@moz-4BE034AB.ptr.us.xo.net) (Quit: Jesse)
[21:52:47] *** Joins: Jesse (jruderman@moz-4BE034AB.ptr.us.xo.net)
[21:53:05] <strcat> pcwalton: hm, can I not add multiple impls with different type bounds?
[21:53:07] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[21:53:24] <strcat> /home/strcat/projects/rust/src/libstd/rc.rs:44:0: 48:1 error: duplicate definition of type Rc
[21:53:26] <strcat> I get these
[21:54:08] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[21:57:33] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[21:59:24] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Quit: Leaving)
[21:59:45] <brson> It looks like I'm going to need to do a full libuv upgrade in order to fix a mac deadlock.
[21:59:52] <brson> I have a distressing amount of code out of tree
[22:00:03] <otters> mebibytes
[22:01:19] <strcat> pcwalton: I can just use free fns instead of static methods but that's somewhat annoying ;p
[22:02:26] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke. It's all a joke.)
[22:05:13] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Connection reset by peer)
[22:05:16] *** Parts: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Leaving)
[22:05:20] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[22:06:37] <pcwalton> strcat: yeah, that sounds like a bug
[22:07:06] <strcat> pcwalton: okay I'll report that in a sec
[22:08:33] <graydon> strcat: is there an idiom that works best for hashtable.find_or_insert(k, v, || make_an_entry()) ?
[22:08:56] <graydon> if I do find, I'm mutably borrowing the table, so I can't insert in the None => ... arm
[22:09:11] <graydon> or immutably borrowing I guess
[22:09:33] <strcat> find_or_insert_with?
[22:09:45] <pcwalton> graydon: find_or_i... aww, strcat beat me to it
[22:09:58] <pcwalton> most of the borrow check errors I get these days are that pattern :)
[22:10:08] <graydon> aww yeah
[22:10:23] <strcat> need to add that to the other maps too
[22:10:26] <graydon> I knew it was around :)
[22:10:32] <pcwalton> it's fairly tolerable though
[22:10:36] <pcwalton> I think the borrow check is way better
[22:10:47] * strcat is happy that find_mut is possible without unsafe now :)
[22:11:04] <pcwalton> the borrow check rarely stops me from doing what I want to do, it's just an occasional annoyance
[22:11:06] <pcwalton> but that's fine
[22:11:11] <pcwalton> type systems are always occasional annoyances.
[22:11:20] <pcwalton> segfaults are also occasional annoyances.
[22:11:33] <strcat> my only big annoyance with it now are the perf problems with moves/swaps
[22:11:41] <pcwalton> due to zeroing out?
[22:11:46] <strcat> yeah
[22:11:52] <strcat> zeroing out + running drop glue when it's not needed
[22:11:55] <pcwalton> nmatsakis and I need to have a vidyo discussion about that
[22:12:10] <tjc> windows bot seems to be confused :-(  http://buildbot.rust-lang.org/builders/auto-win/builds/1264/steps/test/logs/stdio
[22:12:16] <graydon> gosh, sometimes I forget how pleasant this language is to hack in
[22:12:16] <pcwalton> I'm very interested in statically proving that zeroing out is never necessary
[22:12:19] <pcwalton> that's, like
[22:12:22] <tjc> I can't remember whether that just means it needs the workspace wiped or something else
[22:12:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:12:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143dd6be6 to 146a9c3bd: 02http://git.io/N3iJvQ
[22:12:28] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:12:30] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:12:30] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1ZZNcA
[22:12:30] <ghrust> 13rust/06auto 14109bb7c 15BjÃ¶rn Steinbrink: Allow static strings to be used with keyword checks
[22:12:30] <ghrust> 13rust/06auto 1408b4cdd 15bors: auto merge of #6499 : dotdash/rust/static_keywords, r=thestinger
[22:12:31] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:12:31] <strcat> graydon: iterators work well now too :)
[22:12:34] <pcwalton> doing C++11 move semantics better than C++ will ever be able to do :)
[22:12:45] <graydon> strcat: *applause*
[22:12:58] <strcat> once niko's change to allow borrowing rvalues as &mut lands they will be really pleasant to use
[22:13:06] <pcwalton> yeah, I want that too.
[22:13:16] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:13:18] <nmatsakis> strcat: I should...probably add a test or two to that PR I guess.
[22:13:21] <pcwalton> I also think that the borrow check could do better at statically detecting @mut borrowing problems
[22:13:32] <strcat> nmatsakis: or just edit the core::iterator ones
[22:13:46] <strcat> nmatsakis: lots make temp vars like 'let mut it = ...; for it.advance'
[22:13:47] <pcwalton> maybe someone could eventually write a higher order static analysis to try to detect more dynamic borrow errors
[22:14:54] <strcat> rusti: use core::iterator::*; let xs = [1, 2, 3, 4, 5]; let mut it = xs.iter().take_while(|&i| i < 3); for it.advance |&x| { println(x) }
[22:14:58] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/ZQUf
[22:15:08] <nmatsakis> strcat: did you see that regarding having find_or_insert return &mut?
[22:15:10] <strcat> rusti: use core::iterator::*; let xs = [1, 2, 3, 4, 5]; let mut it = xs.iter().take_while(|& &i| i < 3); for it.advance |&x| { println(x) }
[22:15:11] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/bLiJ
[22:15:16] <strcat> nmatsakis: yeah
[22:15:22] <pcwalton> we need to make && work in patterns :)
[22:15:24] <strcat> nmatsakis: I think it would be fine since it already uses &mut self
[22:15:31] <nmatsakis> strcat: yes, I imagine it would just work.
[22:15:40] <strcat> rusti: use core::iterator::*; let xs = [1, 2, 3, 4, 5]; let mut it = xs.iter().take_while(|& &i| i < 3); for it.advance |&x| { println(x.to_str()) }
[22:15:42] <rusti> 1
[22:15:42] <rusti> 2
[22:15:57] <strcat> rusti: use core::iterator::*; let xs = [1, 2, 3, 4, 5]; let mut it = xs.iter().take_while(|& &i| i < 3).transform(|x| x * 2); for it.advance |&x| { println(x.to_str()) }
[22:15:58] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/WAae
[22:16:16] <strcat> rusti: use core::iterator::*; let xs = [1, 2, 3, 4, 5]; let mut it = xs.iter().take_while(|& &i| i < 3).transform(|x| x * 2); for it.advance |x| { println(x.to_str()) }
[22:16:18] <rusti> 2
[22:16:18] <rusti> 4
[22:16:21] <strcat> silly borrowed ptrs
[22:16:48] <strcat> I could probably make a VecConsumeIterator once by-value self works
[22:16:51] <strcat> yeah
[22:17:58] <graydon> heh. no find_or_insert_with_mut :)
[22:18:14] <thiez> rusti: do (~["a","b"]).consume |_,x| { println(x) };
[22:18:15] <rusti> /usr/local/bin/rust.sh: line 19:    15 Segmentation fault      (core dumped) ./foo
[22:18:21] <thiez> nice, it works now :)
[22:18:41] <strcat> it succeeds in failing ;p
[22:18:50] <strcat> graydon: yeah see above ^
[22:19:02] <strcat> graydon: can probably be changed to use &mut and not have one with &
[22:19:08] <strcat> since you can turn &mut into & via move
[22:19:10] <graydon> above?
[22:19:19] <strcat> graydon: niko mentioned it
[22:19:19] <thiez> that bug is pretty ancient, I was surprised it hasn't been fixed yet
[22:19:36] <graydon> strcat: oh, I see
[22:19:39] <strcat> thiez: treating self as a normal param will fix it afaik
[22:20:56] <thiez> strcat: is that going to happen any time soon?
[22:21:31] <thiez> not that I'm in any hurry, vec::consume works fine
[22:21:50] <strcat> pcwalton: imo we should split Index into 3 traits and make it work like vectors
[22:22:14] <pcwalton> 3 traits...?
[22:22:19] <strcat> &a["foo"] can call .index, &mut a["bar"] can call .index_mut, and I guess index assign needs to be one
[22:22:37] <strcat> Index alone is really annoying
[22:22:50] <pcwalton> oh, yes, something like that
[22:22:50] <strcat> you have to use &
[22:22:58] <pcwalton> although does index_assign have to be one? I suppose so.
[22:23:21] <strcat> pcwalton: because it needs to insert, for a map
[22:23:26] <pcwalton> yea
[22:23:54] <strcat> the regular ones will just be find().unwrap and find_mut().unwrap()
[22:24:19] *** Quits: dherman (dherman@moz-95C48841.sub-70-197-11.myvzw.com) (Quit: dherman)
[22:25:11] <pcwalton> find().get and find_mut().get
[22:25:15] <pcwalton> once we change those names
[22:25:27] *** Joins: jorendorff (jorendorff@moz-95C48841.sub-70-197-11.myvzw.com)
[22:27:36] *** Quits: jorendorff (jorendorff@moz-95C48841.sub-70-197-11.myvzw.com) (Ping timeout)
[22:27:37] <strcat> thiez: dunno
[22:27:43] <strcat> thiez: I think erickt and nmatsakis were just talking about it
[22:28:08] <thiez> the UFCS?
[22:28:25] <strcat> thiez: yeah
[22:28:36] <strcat> I think that will mean the code path will be the same
[22:28:43] <strcat> so they'll have the same bugs instead of different ones :)
[22:28:48] <thiez> seems like UFCS is not really worth the trouble if that bug would be fixed :p
[22:29:23] <strcat> thiez: well I mean UFCS would fix it simply by unifying the code paths to the non-buggy ones
[22:29:39] <strcat> it's sort of the same situation as let vs match
[22:29:41] <strcat> let is totally broken
[22:30:20] *** Quits: zq (p@moz-4A6945B7.de) (Ping timeout)
[22:30:54] <thiez> it is a little silly that match succeeds where let fails, when they should in many cases be doing the same thing :D
[22:31:48] * strcat really hates the completion on github's unified search :(
[22:37:22] *** Joins: brendan (brendaneic@2557E599.66715431.D25A875A.IP)
[22:39:29] *** Quits: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP) (Quit: zzzzzzzzzz)
[22:40:59] *** Joins: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP)
[22:40:59] *** ChanServ sets mode: +o tjc
[22:42:49] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:45:48] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[22:46:17] <cmr> r? https://github.com/mozilla/rust/pull/6505
[22:46:36] <cmr> in particular the windows code... I think it's correct, from what I read on MSDN, but I have no experience with it
[22:46:41] <cmr> nor can I test
[22:47:03] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:47:30] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:47:30] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Ping timeout)
[22:47:52] <tjc> cmr: r+'ed, I don't know about the Windows code either, but bors will find out :-)
[22:48:09] <cmr> tjc: thanks
[22:48:27] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:48:29] <tjc> you're welcome
[22:50:24] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:51:49] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[22:55:33] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[22:59:01] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[23:00:36] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Connection reset by peer)
[23:00:44] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[23:00:55] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[23:01:36] <seth> i notice each takes a &T -> bool. what does the boolean return value indicate?
[23:01:53] <aatch> seth, it's part of the for-each protocol
[23:01:57] <cmr> seth: http://smallcultfollowing.com/babysteps/blog/2013/01/16/revised-for-loop-protocol/
[23:02:15] <seth> thanks
[23:02:16] <aatch> it basically says whether to break or not
[23:06:24] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:06:24] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/1ZZNcA
[23:06:24] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:06:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:07:04] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:08:06] <strcat> pcwalton: https://github.com/mozilla/rust/issues/6516 any idea if that's a bug?
[23:08:13] <strcat> I think it is...
[23:08:18] <strcat> don't really understand why it happens
[23:08:34] <strcat> maybe the compiler things all kinds are the same bound?
[23:08:43] <brson> tjc: rustpkg tests are failing on i686 http://buildbot.rust-lang.org/builders/incoming-full-linux/builds/1230/steps/test/logs/stdio
[23:08:49] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[23:09:05] *** Joins: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP)
[23:09:24] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:09:24] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/O7qlPg
[23:09:24] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:09:25] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:09:25] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Pciagw
[23:09:25] <ghrust> 13rust/06auto 14017df98 15Lenny222: remove deriving_eq, deriving_iter_bytes, deriving_clone (deprecated in 0.6)
[23:09:25] <ghrust> 13rust/06auto 147012c42 15bors: auto merge of #6500 : kud1ing/rust/cleanup, r=bstrie...
[23:09:26] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:09:49] <dbaupp> graydon: rebased! https://github.com/mozilla/rust/pull/6502
[23:10:06] <tjc> brson: OK. um...
[23:10:21] <tjc> that looks scary
[23:10:55] *** Quits: rgrinberg (rgrinberg@AE999E95.52DE4C60.258AD6F5.IP) (Ping timeout)
[23:12:01] <dbaupp> strcat: I get the same thing with <Num + Copy> and <Num + Copy + Real> when trying to do some work on the complex numbers
[23:12:06] <brson> tjc: I had to disable rusti tests yesterday for similar reasons
[23:12:21] <pcwalton> strcat: this is a known bug
[23:12:26] <pcwalton> coherence doesn't know about kinds
[23:12:42] <tjc> brson: is there a way to ignore the tests just on i686?
[23:12:43] <strcat> pcwalton: and you can't inherit from kinds, right?
[23:12:48] <strcat> pcwalton: I'll just make free functions for now
[23:13:09] <brson> tjc: #[ignore(cfg(target_arch = "x86"))] or something like that
[23:13:18] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[23:13:31] <tjc> brson: ok, I should probably just be not-lazy and copy/paste from the rusti tests :-)
[23:13:47] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Ping timeout)
[23:13:55] <tjc> brson: is there already a bug open on the disabled-rusti-tests? I'll just add a comment if so
[23:14:18] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Input/output error)
[23:14:28] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[23:15:16] *** Quits: eholk (eholk@moz-3E83C9EA.uconnect.utah.edu) (Quit: eholk)
[23:15:41] <pcwalton> strcat: right, kind inheritance is unimplemented.
[23:17:16] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[23:17:17] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[23:17:48] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[23:18:42] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[23:20:50] <strcat> pcwalton: btw it seems ~[1, 2, 3] still generates the code bloat you fixed for ~"foo"
[23:21:02] <pcwalton> yeah, I know
[23:21:57] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[23:23:01] <thiez> strcat: are you referring to the slow-compile issue?
[23:23:06] <strcat> thiez: yes
[23:23:21] <strcat> pcwalton: https://github.com/mozilla/rust/pull/6520 r?
[23:23:40] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[23:23:46] <thiez> I looked at the x64 assembly, it wasn't very pretty
[23:23:59] <thiez> what was the fix for strings?
[23:24:01] <strcat> thiez: with or without -O?
[23:24:06] <strcat> it should be fine post-optimization
[23:24:06] <pcwalton> just special-case that in the compiler
[23:24:07] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[23:24:12] <thiez> either.
[23:24:23] <pcwalton> no, it's not fine post-optimization, LLVM doesn't optimize it the way you would like.
[23:24:28] <strcat> ah
[23:24:38] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[23:24:47] <thiez> but it was better with -O
[23:25:14] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[23:25:33] <thiez> still almost 7000 times 'movl' and almost 1300 'movq' :)
[23:25:47] <seth> i'm having trouble figuring out the syntax to assign from a tuple function return value to two mutable variables using destructuring assignment
[23:25:55] <pcwalton> yeah, it's really bad. those allocations need to be optimized
[23:26:06] <pcwalton> seth: let mut (a, b) = f(); ?
[23:26:35] <seth> pcwalton: ahh, you need to use let
[23:27:00] <seth> i expected "(_used_top, _used_bot) = box.get_used_height();" to work
[23:27:13] <pcwalton> it doesn't work because the parser won't know when to enter the pattern grammar
[23:27:14] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Ping timeout)
[23:27:22] <seth> (since _used_top and _used_bot are declared 'let mut' elsewhere)
[23:27:23] <thiez> let mut (a,_) = (1,2); a = a + 1; a
[23:27:24] <thiez> :)
[23:27:30] <thiez> rusti: let mut (a,_) = (1,2); a = a + 1; a
[23:27:31] <rusti> 2
[23:28:25] <seth> pcwalton: hmm, so you need to always use 'let' with destructuring assignment?
[23:28:30] <pcwalton> yeah
[23:28:31] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[23:28:32] <pcwalton> syntactic issue.
[23:28:38] <seth> gotcha
[23:28:41] <pcwalton> otherwise we'd have to do a cover grammar like js
[23:28:48] <pcwalton> and that's a tough kettle of fish
[23:28:51] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[23:29:07] <seth> i know you like to keep it LL(k) =)
[23:30:20] <thiez> I'll accept LL(k!) for very smal k
[23:30:23] <thiez> small*
[23:30:59] <strcat> pcwalton: I wonder if using memcpy instead of memmove in swap would actually help... since the &mut params can't alias
[23:31:07] <pcwalton> maybe
[23:31:14] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Ping timeout)
[23:31:37] <aatch> Isn't the Rust grammar pretty much LL(2)?
[23:31:43] <pcwalton> pretty much yeah.
[23:33:32] <aatch> Do you know what C++ is?
[23:33:58] *** Quits: jlembeck (jlembeck@moz-E5A16406.hsd1.wa.comcast.net) (Client exited)
[23:34:16] <dbaupp> aatch: it's not even context free, apparently
[23:34:20] <benh> a dog, with extra legs stapled on to make it an octopus? scnr
[23:34:31] <aatch> dbaupp, oh wow
[23:35:56] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[23:36:10] <aatch> That's impressive, since most of the time you think something might be contextual, you can just have a different production tree for whatever introduces the context
[23:38:08] <dbaupp> aatch: it might even be turing complete... http://stackoverflow.com/a/14589567/1256624
[23:39:30] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:39:40] <strcat> aatch: C++ has to mix the parser and type checker
[23:40:01] <strcat> dbaupp: it is, I think
[23:40:04] <strcat> because templates are
[23:40:05] <strcat> :D
[23:40:09] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[23:40:39] <Sodel_the_V> nmatsakis: ping
[23:41:41] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[23:42:28] <aatch> It's.... beautiful...
[23:42:45] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Ping timeout)
[23:42:49] <nmatsakis> Sodel_the_V: pong
[23:42:53] <nmatsakis> Sodel_the_V: I was just poking at your branch....
[23:42:54] <aatch> "This parses if, and only if, a given integer is prime"
[23:43:28] <Sodel_the_V> nmatsakis: I might have an idea of what's causing the LLVM crash
[23:44:03] <cmr> vec::from_slice isn't in libcore/vec.rs, where is it?
[23:44:20] <seth> i confess i'm unsure that this code actually does what i think it does:
[23:44:22] <nmatsakis> Sodel_the_V: ok, I didn't get very far yet
[23:44:25] <dbaupp> cmr: it's now to_owned
[23:44:26] <seth> https://gist.github.com/sfowler/3a0762687b90bbef742f
[23:44:27] <cmr> is it anywhere? It's in http://static.rust-lang.org/doc/core/vec.html#function-from_slice
[23:44:39] <cmr> ah
[23:44:51] <strcat> cmr: the docs are generated from master
[23:44:55] <dbaupp> cmr: those docs are behind
[23:44:57] <seth> does the assignment inside the for affect _used_top and _used_bottom outside the loop?
[23:45:04] <pcwalton> seth: it'll shadow
[23:45:05] <cmr> that's annoying
[23:45:09] <pcwalton> use this:
[23:45:29] <dbaupp> cmr: the best documentation atm is the source + grep
[23:45:41] <strcat> git grep
[23:45:44] <strcat> ;p
[23:45:53] <strcat> saves you from getting LLVM crap :)
[23:45:59] <dbaupp> strcat: git grep is amazingly fast... it's awesome
[23:46:06] <cmr> I usually use ag in src/
[23:46:44] <nmatsakis> Sodel_the_V: just finishing up some dishwashing, I was going to try and dig in after that...talk in 15 mins?
[23:46:47] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[23:46:50] <pcwalton> seth: let (used_top, used_bot) = match self.box { None => (Au(0), Au(0)), Some(box) => { ... box.get_used_height() } };
[23:47:14] <Sodel_the_V> nmatsakis: Sounds good. I still need to figure out how to word this concisely anyways. :P
[23:47:23] <strcat> rusti: fn foo() { libc::abort() } foo()
[23:47:27] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/dFie
[23:47:38] <strcat> rusti: fn foo() { unsafe { libc::abort() } } foo()
[23:47:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:47:41] <seth> pcwalton: heh, ok. i originally had "let mut" everywhere and the compiler warned me that the variables did not need to be mutable, which made me highly suspicious
[23:47:41] <rusti> /usr/local/bin/rust.sh: line 19:    15 Aborted                 (core dumped) ./foo
[23:47:47] <pcwalton> yup
[23:47:51] <pcwalton> the warnings are there for safety :)
[23:48:00] <seth> pcwalton: still not sure how to assign to the outer variables, though
[23:48:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:48:13] <pcwalton> seth: if you use the pattern I suggested you don't need to
[23:48:29] <seth> pcwalton: i know, but i'd still like to understand what's possible in rust
[23:48:36] <pcwalton> if you wanted to keep using the pattern you would use
[23:48:59] <pcwalton> let (this_used_top, this_used_bot) = box.get_used_height(); used_top = this_used_top; used_bot = this_used_bot;
[23:49:05] <pcwalton> and above you would say
[23:49:16] <pcwalton> let mut (used_top, used_bot) = (Au(0), Au(0));
[23:49:37] <pcwalton> i.e. unpack locally into temporaries, assign the temporaries to the variables above
[23:49:47] <seth> so does this mean that destructuring assignment can't be used to assign to mutable variables?
[23:49:49] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[23:49:58] <strcat> oh cool cgroups actually have hierarchy for memory management now without manually doing stuff
[23:50:03] <seth> i suppose that's the implication of requiring let...
[23:50:08] <strcat> rusti: core::run::run_program("./foo", []);
[23:50:14] <rusti> timed out after 5 seconds
[23:51:00] <pcwalton> seth: right
[23:51:10] <pcwalton> this is something we've discussed but syntactically it's hard
[23:52:04] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[23:52:42] <graydon> dammit
[23:52:52] <graydon> bitmap works but isn't dense enough either
[23:52:55] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[23:53:00] <graydon> our heap is so ridiculously fragmented
[23:53:06] <pcwalton> still an improvement though?
[23:53:11] <graydon> no, worse
[23:53:20] <pcwalton> wat :(
[23:53:42] <strcat> graydon: which OS are you testing on btw?
[23:53:47] <graydon> linux
[23:54:38] *** Quits: snadon (chatzilla@moz-F86CA4D4.mc.videotron.ca) (Ping timeout)
[23:56:52] *** Quits: jclements (jclements@2557E599.66715431.D25A875A.IP) (Quit: jclements)
[23:57:11] <graydon> oh wait, maybe it's slightly better. hm.
[23:57:34] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
