[00:00:37] <ChrisMorgan> So just dereferencing it is valid?
[00:00:41] <pcwalton> yes
[00:01:00] *** sam113101_afk is now known as sam113101
[00:01:21] <ChrisMorgan> But it needs to be 'static before it's going to be *safe*?
[00:01:34] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[00:02:39] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[00:03:22] <ChrisMorgan> 'static |&Request, &mut ResponseWriter| doesn't seem to fulfil Send.
[00:03:54] <pcwalton> it should
[00:03:57] <strcat> ChrisMorgan: 'static closures are pretty pointless anyway, afaik
[00:03:59] *** Quits: dherman_ (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman_)
[00:03:59] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[00:04:01] <strcat> they are just an extern fn
[00:04:54] <ChrisMorgan> Yes, I just wanted to see if I could get anywhere with it all.
[00:05:00] <ChrisMorgan> Settling for handler: &'static (fn(&Request, &mut ResponseWriter)) for now.
[00:06:08] <strcat> ChrisMorgan: why not just say 'extern fn'
[00:06:10] <strcat> ?
[00:06:14] <strcat> if it can't have an env anyway
[00:07:21] * ChrisMorgan doesn't know
[00:07:23] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[00:07:52] *** Quits: peterdn (chatzilla@moz-D11BA78C.as13285.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:07:52] *** Joins: mortisha (Mibbit@moz-D52C0647.ip.opendns.com)
[00:08:09] <mortisha> Hello
[00:08:15] <r-A> Hello
[00:08:23] <mortisha> Does anybody know how to fix the "last argument in `do` call has non-procedure type" message in rust -master?
[00:08:43] <ChrisMorgan> mortisha: do is reserved for single-shot procedures now
[00:09:02] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[00:09:26] <mortisha> Thanks Chris. What do you mean by single-shot?
[00:09:27] <ChrisMorgan> So, if it's something where the argument is run once, you should switch from using &fn(...) to using proc(...) and then you can continue to use do. If not, you'll need to drop the use of the `do` construct.
[00:09:31] <obi_wan> How do I invoke a constructor for TrieMap?
[00:09:40] <mortisha> Got it
[00:09:58] <strcat> obi_wan: ::new ?
[00:10:09] <obi_wan> TrieMap<uint>::new() ?
[00:10:19] <strcat> rusti: let mut xs = std::trie::TrieMap::new(); xs.insert(0, 1); xs.len()
[00:10:20] -rusti- 1u
[00:10:26] <strcat> obi_wan: rust will infer the type
[00:10:37] <ChrisMorgan> proc is good for things like task spawning where you know the body is only executed once—it simplifies the semantics of moving enormously (the convention had become to use std::cell::Cell which shifted the check to runtime).
[00:10:39] <strcat> if you really wanted to specify a type in the expr, TrieMap::<K, V>::new()
[00:11:13] <obi_wan> Thanks
[00:11:35] <obi_wan> How can Rust infer the type lazily?
[00:11:54] <strcat> obi_wan: well it looks at the uses of the type until it finds constraints helping it infer the type
[00:11:56] <aatch> obi_wan, its not "lazily" it's just inferred.
[00:11:59] <mortisha> So    do x.map |x| { ... } is not an option any more, and x.map(|x| { ... }) is the only way to go now?
[00:12:18] *** Quits: SingingBoyo (brandon@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[00:12:25] <strcat> obi_wan: uses of the value*
[00:12:32] <ChrisMorgan> strcat: switching to `extern fn(...)` gets "mismatched types: expected `fn(&server::request::Request, &mut server::response::ResponseWriter<>)` but found `fn(&server::request::Request, &mut server::response::ResponseWriter<>)` (expected concrete lifetime, but found bound lifetime parameter &)"
[00:12:47] <ChrisMorgan> mortisha: correct
[00:12:51] <strcat> ChrisMorgan: sorry I guess just 'fn' now
[00:13:06] <strcat> all my bindings are probably broken again
[00:13:38] <ChrisMorgan> (Remember also with closures that if you only have one expression in the block it's not necessary to use braces, so you can have `nums.map(|x| x + 1)` instead of `nums.map(|x| { x + 1 })`.)
[00:14:07] <mortisha> Right. Thanks, Chris.
[00:14:59] <ChrisMorgan> strcat: `&'static extern fn(...)` compiles too; what would the difference, if any, be between that and `&'static (fn(...))`?
[00:15:26] <strcat> ChrisMorgan: a bare function is a function pointer
[00:15:27] * bjz is hoping that HOFs will get easier in the future :/
[00:15:38] <strcat> &fn (now ||) is a closure with an env
[00:16:00] <strcat> it has a lifetime, and 'static happens to be more flexible because it knows it has no env, but you should just say bare function if you mean bare function
[00:16:09] <obi_wan> What the heck is a VI2? As in "mismatched types: expected `&uint` but found `<VI2>` (expected &-ptr but found integral variable)"
[00:16:13] <aatch> obi_wan, for a quick explanation of type inference, the algorithm is approximately: For each variable, assign a type variable, for each usage of that variable add to the set of constraints on that type.
[00:16:20] <strcat> obi_wan: a generic integer
[00:16:36] <strcat> obi_wan: let x = 5; is a generic integer, without a specific type yet
[00:16:40] <ChrisMorgan> strcat: I'm dealing with a bare function (or rather, a static reference to such) in both cases, aren't I?
[00:16:52] <strcat> obi_wan: it wants &uint and you're giving it 'generic integer' so it doesn't infer the integer as being a uint
[00:16:53] <bascule> what the heck is a <VI2> indeed ;)
[00:16:56] <aatch> If you have no types, thats a contradiction, more than 1 is ambiguity and a single type is, well, the answer.
[00:17:05] <obi_wan> aatch: That's pretty neat. I'll have to think more about it later
[00:17:26] <aatch> bascule, obi_wan, VI2 is actually one of those type variables I mentioned.
[00:17:42] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[00:17:45] <aatch> obi_wan, rust's algorithm is based on Hindley-Milner, also known as Algorithm W
[00:17:51] <strcat> aatch: well VIx is specifically a generic integer, a detail leaking out of the compiler
[00:17:53] <bascule> haha nice
[00:17:54] <strcat> VFx is a generic float
[00:17:56] <bascule> I wasn't aware of that
[00:17:58] * ChrisMorgan explained <VI0> et al. at some length yesterday or the day before; it's a poorly understood concept which needs good documentation
[00:18:16] <aatch> strcat, ah, I wasn't aware of that.
[00:18:17] <strcat> ChrisMorgan: it's a bug in the error messages
[00:18:19] <bjz> ChrisMorgan: better user-facing error messages?
[00:18:21] <strcat> it should say 'generic integer'
[00:18:40] <strcat> 'unknown integer-like type' or whatever
[00:18:49] <strcat> they all come from literals anyway
[00:18:54] <ChrisMorgan> strcat: note that it's `&'static (fn(...))`, not `&'static fn(...)`, that I'm talking about. It just ends up, what's the difference between `extern fn(...)` and `fn(...)`?
[00:19:12] <strcat> ChrisMorgan: 'fn(...)' wasn't valid until recently.
[00:19:23] <strcat> there are duplicate ways of doing stuff atm
[00:19:36] <strcat> ChrisMorgan: I assume &'static (fn()) is just a borrowed ptr to a bare function pointer
[00:19:41] * bjz is so confused
[00:19:47] <strcat> while &'static fn() is the deprecated way of saying a borrowed closure
[00:20:00] <ChrisMorgan> Obsoleted, not deprecated. (It's an error.)
[00:20:21] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[00:20:37] <bjz> so many different names / fn types - is the current state of affairs  written down atm?
[00:20:38] <obi_wan> This is the code I'm getting that weird VI2 error for... https://gist.github.com/anonymous/7668709
[00:20:44] <ChrisMorgan> So then, what's the *actual* difference (semantics, performance, syntax, I dunno) between extern fn(...) and fn(...)?
[00:21:09] <bjz> I know of nmatsakis's posts, but I want to know what's happening at the moment.
[00:21:42] <strcat> ChrisMorgan: obsolete syntax
[00:21:46] <strcat> fn(...) wasn't allowed before
[00:22:04] <ChrisMorgan> So I should prefer fn to extern fn?
[00:22:12] <strcat> yes, unless you need 'extern "C" fn'
[00:22:30] <strcat> it will get cleaned up when the deprecated syntax is gone
[00:22:41] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[00:22:45] <ChrisMorgan> obi_wan: it can't infer what type the number 2 should be
[00:22:46] <strcat> until recently fn(...) would throw an error
[00:23:02] <obi_wan> ChrisMorgan: You mean 3?
[00:23:12] <ChrisMorgan> No, 2.
[00:23:23] <ChrisMorgan> obi_wan: you have TrieMap<T>, but there's no way from that code to decide what T is beyond that it is integral.
[00:23:49] <strcat> ChrisMorgan: that's not the issue
[00:23:51] <strcat> it will fall back to int
[00:23:59] <ChrisMorgan> Oh yes, that's true. I forgot that.
[00:24:02] <aatch> ChrisMorgan, you're right, but that specific error is actually from the load
[00:24:05] <strcat> obi_wan: the function takes &uint, not uint
[00:24:13] <strcat> obi_wan: you're passing SOME_GENERIC_INTEGER by-value
[00:24:16] <strcat> it wants a reference
[00:24:25] <strcat> thus it reports 'expected &uint but found SOME_GENERIC_INTEGER'
[00:24:31] <obi_wan> I thought Rust automatically created a reference
[00:24:32] <aatch> it need to be $x.find(&$va)
[00:24:35] <strcat> obi_wan: no
[00:24:42] <strcat> if you passed &SOME_GENERIC_INTEGER, it would infer it to be &uint
[00:25:11] <strcat> obi_wan: it only does auto-ref on methods and auto-coerce from vectors to slices, and owned boxes to borrowed pointers (which is quite weird for &mut)
[00:25:16] <strcat> should be removed for &mut for sure.
[00:25:31] <strcat> for vectors too...
[00:25:34] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[00:25:38] * strcat hates it
[00:26:36] <obi_wan> Why do some methods in MutableMap take by value keys and other by borrowed poitner?
[00:26:57] <aatch> obi_wan, ownership
[00:27:27] <strcat> obi_wan: rust's containers work for types that can only be moved and not cloned
[00:27:37] <strcat> so they need to express what they want in the signatures
[00:28:13] <obi_wan> But why would the key ever need to be owned by the container?
[00:28:15] <strcat> (and that's important for performance)
[00:28:29] <strcat> obi_wan: it owns the key and values inside it
[00:28:40] <strcat> keys and values*
[00:28:56] <strcat> data needs to be stored somewhere
[00:28:58] <obi_wan> strcat: Oh I see. Trie never stores the key but it still has to be compatible with MutableMap
[00:29:20] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[00:29:22] <strcat> obi_wan: yeah, the container traits make tries uglier than they need to be
[00:29:40] <obi_wan> There will never be a solution for that will there :(
[00:29:55] *** sam113101 is now known as sam113101_afk
[00:30:02] <strcat> well a special-cased map with only uint keys is pretty odd
[00:30:31] * strcat shrugs
[00:33:56] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[00:34:13] <doomlord_> did multi item macros just get added
[00:34:13] <ChrisMorgan> Yay! https://github.com/mozilla/rust/pull/10649 has landed and we can have macros that expand to multiple items!
[00:34:36] <doomlord_> nice!
[00:34:59] <bjz> :O
[00:35:04] <bjz> :O :O :O :O
[00:35:26] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:35:58] * bjz gives sfackler a massive bear hug
[00:36:36] <bjz> now all we need is exportable macros ^_^
[00:36:53] <bjz> pub macro_rules! ... ()
[00:37:19] <sfackler> woo!
[00:37:26] <ChrisMorgan> bjz: no, we need more than that; we need full-blown custom syntax extensions.
[00:37:39] <bjz> ChrisMorgan: yes, that to!
[00:37:43] <bjz> *too
[00:37:59] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:38:03] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[00:38:33] <ChrisMorgan> So much exciting stuff today! I had to rebuild in the middle of my work (normally I do them overnight) to get dedo, now I need to do that again to get multi-macros!
[00:39:51] <mortisha> This simple snipped is causing an internal compiler error: http://pastebin.com/i2zPdSgM
[00:40:10] <mortisha> error: internal compiler error: node_id_to_type: no type for node `unknown node (id=272)`
[00:40:42] <mortisha> If I used ips.insert(line.trim().to_owned()) instead, the compiler doesn't crash
[00:40:45] *** sam113101_afk is now known as sam113101
[00:40:53] <mortisha> But with last week's -master it was the opposite
[00:41:11] <mortisha> ips.insert(line.trim().to_owned()) caused this error, and using a temporary variable worked around it
[00:42:12] <ChrisMorgan> How does one dump type sizes for a crate, like https://gist.github.com/eddyb/5a75f8973d3d8018afd3 shows?
[00:42:17] *** Joins: Sgeo (quassel@moz-D0F30617.dyn.optonline.net)
[00:42:28] * kimundi now finally knows in what situations while_some gets used. Thanks mortisha!
[00:42:44] <aatch> ChrisMorgan, I think it's in the -Z options
[00:43:15] <strcat> ChrisMorgan: pretty printer stuff
[00:43:17] <ChrisMorgan> -Z count-type-sizes, I guess.
[00:43:24] <kimundi> mortisha: Anyway, try to reproduce the bug with a current master, if it still ICEs file a issue on github
[00:43:24] <strcat> oh type sizes
[00:43:26] <strcat> I misread
[00:44:23] <aatch> it's possible the recent closure changes borked some of type inference.
[00:44:43] *** Joins: ofeldt- (ofeldt@moz-17C0DA22.dip0.t-ipconnect.de)
[00:45:24] *** Quits: ofeldt (ofeldt@moz-7C1330C9.dip0.t-ipconnect.de) (Ping timeout)
[00:47:07] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[00:47:40] *** Joins: brianswingdancer (johnbuck66@moz-27A313CA.dyn.optonline.net)
[00:48:00] <brianswingdancer> hi everone///my first time here on mIRC
[00:48:13] <mortisha> Welcome Brian
[00:49:06] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[00:50:41] *** Joins: jvshahid (jvshahid@moz-86D5F266.nyc.res.rr.com)
[00:51:06] <brianswingdancer> thank you Mortisha
[00:51:24] <o11c> IRC is far greater than mIRC will make you imagine
[00:51:30] <brianswingdancer> is there a topic to this room? is this a chat room?
[00:51:41] <o11c> this channel is about the Rust language
[00:51:54] <brianswingdancer> oh ok
[00:52:14] <brianswingdancer> and IRC is better than mIRC you say?
[00:52:35] <o11c> I can't enumerate *every* piece of etiquette, but you should: 1. Never use colors, 2. Never use triggers, and 3. Never use public away messages
[00:52:42] <strcat> brianswingdancer: mIRC is just one of many clients
[00:52:46] <o11c> mIRC is a single program. IRC is vast.
[00:53:07] <brianswingdancer> ok
[00:54:00] <mortisha> I can step in and try to contribute code for it, but something I really miss in Rust is the ability to use underscores in numbers like in Ruby, such as 150_000_000
[00:54:16] <mortisha> Do you guys think it would be a good idea to support that?
[00:54:20] * Eridius doesn't think he's ever typed a number with underscores in it
[00:54:20] <aatch> mortisha, you can in Rust...
[00:54:26] <Eridius> how often do you type numbers long enough for that anyway?
[00:54:26] <mortisha> Seriously?
[00:54:26] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[00:54:31] <aatch> rusti: 1_000_000
[00:54:32] -rusti- 1000000
[00:54:33] <mortisha> Quite frequently
[00:54:49] <mortisha> Holly molly, I didn't know that Rust supported that already.
[00:54:52] <aatch> rusti: 1__________1
[00:54:53] -rusti- 11
[00:54:53] <mortisha> Super cool.
[00:55:01] <bascule> mortisha: have you read Rust for Rubyists? Pretty sure it shows you can do that in one of the examples
[00:55:23] <mortisha> I did, but I must have overlooked that
[00:55:37] <ChrisMorgan> Hmm. rust-http's two largest types: 656 headers::request::HeaderCollection, 488 headers::response::HeaderCollection. They are unavoidably large structs, c.f. http://docs.octayn.net/http/headers/request/struct.HeaderCollection.html, and will continue to grow as more headers are supported as first-class citizens (e.g. cookies are lacking).
[00:55:40] <bascule> or maybe I'm misremembering and making things up
[00:55:42] *** Quits: brianswingdancer (johnbuck66@moz-27A313CA.dyn.optonline.net) (Quit: )
[00:55:43] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[00:55:43] *** ChanServ sets mode: +o pnkfelix
[00:56:02] <aatch> brianswingdancer, mIRC is to IRC what Firefox is to the Web.
[00:56:19] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:56:30] * bascule reads about monomorphization :O
[00:56:37] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[00:56:39] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[00:56:46] <bascule> it's like C++ templates but less shitty?
[00:56:54] <Eridius> ChrisMorgan: and you can't use some sort of key-value map?
[00:56:57] <aatch> bascule, define "less shitty"
[00:57:01] <bascule> lololol
[00:57:24] <ChrisMorgan> Eridius: not with strong, useful typing.
[00:57:28] <strcat> ChrisMorgan: large types are fine
[00:57:28] <aatch> I mean, it's still monomorphisation as opposed to dynamic dispatch or partial specialisation.
[00:57:29] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[00:57:40] <benh> C++ templates are typically implemented as monomorphization, I thought
[00:57:41] <strcat> ChrisMorgan: just don't make recursive trees with enormous nodes like rustc :)
[00:58:14] <bascule> benh: yes, but done by the type system instead of a Turing-complete templating metalanguage embedded in the parent language?
[00:58:28] <Eridius> ChrisMorgan: sure you can. Define a dummy type for each key. Then use generics to provide a way to map that dummy type to the value type, and to map it to a key name. You can use that to vend a typed key-value collection that internally uses some sort of trait (e.g. Any) for the values, but the interface ensures that each key has a valid type
[00:58:30] <sfackler> ChrisMorgan: you could probably do something creative with a hashset if you wanted
[00:58:31] *** kimundi is now known as zz_kimundi
[00:58:51] <strcat> a struct is better than a set of constant keys if you always know the key you want statically
[00:58:54] <Eridius> although the lack of member types means I think you'll need the access to be done via the dummy type instead of done via the value (because you need some way to set the return value)
[00:58:58] <ChrisMorgan> strcat: I certainly agree with you; there's only one of these per request typically and the alternative of using a map will tend to result in larger heap allocations.
[00:59:15] <benh> bascule: that describes our generics but monomorphization is just the code generation strategy behind both rust generics and C++ templates, i thought
[00:59:15] <strcat> there is *nothing* wrong with a huge type, you can always put it behind ~ and get something that's still going to perform better than a map
[00:59:23] <ChrisMorgan> Eridius: I don't see that it gets any benefit for that convolution.
[00:59:34] <bascule> benh: okay, perhaps my original phrasing was inelegant, but...
[00:59:41] <bascule> benh: the end is the same, the means are different
[00:59:47] <bascule> and the way C++ does it is fucking terrible
[00:59:49] *** jorendorff is now known as jorendorff_away
[01:00:51] <strcat> C++ templates aren't that bad, you just get duck typing instead of clear requirements stated up-front leading to sane error messages
[01:00:54] <strcat> it's a tradeoff
[01:00:54] <ChrisMorgan> I'm not familiar with precisely how stack allocations work with new stack frames; in `fn x(t: T) { y(t) }`, t is spoken of as being moved in the call to y, but does it actually involve moving the contents of the memory?
[01:00:55] <aatch> bascule, monomorphisation is just a code-generation technique. I'm pretty sure that we do the *exact* same thing as C++ when it comes to generating code for generics.
[01:01:01] <strcat> templates are far more flexible, and far more powerful
[01:01:13] <strcat> ChrisMorgan: 'moving' is a misleading term
[01:01:14] <bascule> yes, but, Rust is one language and C++ templates are a separate language on top of C++?
[01:01:18] <strcat> ChrisMorgan: it refers to moving ownership, not memory
[01:01:28] <bascule> I'm confused who's confused here, lol
[01:01:29] <strcat> ChrisMorgan: all types in rust are really implicitly copyable, it's just that for some types it moves ownership
[01:01:36] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[01:01:37] <Eridius> ChrisMorgan: the benefit is only if you have a huge struct that you expect to be very sparsely populated
[01:01:41] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:01:55] <Eridius> ChrisMorgan: e.g. if the hashmap (or maybe a tree map instead of a hash map?) is sufficiently smaller than the struct
[01:02:00] <strcat> ChrisMorgan: all copies at a language level are a shallow copy (stops at pointers), moves have to do with ownership moving as part of the copy
[01:02:01] <aatch> bascule, the Turing completeness of C++ templates is somewhat oversold
[01:02:04] <bascule> I suppose if Rust is Hindley-Milner one could actually implement a Turing machine on top of the type system
[01:02:10] <bascule> no?
[01:02:22] <aatch> bascule, it is still turing complete, but that's not really the problem.
[01:02:38] <aatch> The problem with C++ in general is that it is a context-sensitive language.
[01:02:39] <bascule> the problem with C++ is it's a metalanguage
[01:02:57] <strcat> you can say the same thing about traits, they're a non-turing complete metalanguage
[01:02:59] <strcat> or macros
[01:03:04] <obi_wan> Where can I find/get a typical virtual memory profile of a typical program? I want a set of virtual addresses it uses
[01:03:05] <bascule> sure
[01:03:06] <bjz> aatch: "The problem with C++ in general is that it is a context-sensitive language." <- nail on the head
[01:03:11] <ChrisMorgan> strcat: in such a case as my example there, does it involve allocating space for t on the new stack frame and copying the contents? I mean, does it end up making function calls expensive if T is large?
[01:03:14] <aatch> So something can fail to parse based on whether or not a given identifier is a type.
[01:03:29] <bascule> is C++ really context sensitive or undecidable/turing complete?
[01:03:40] <bascule> can you guarantee a C++ compiler will halt?
[01:03:51] <aatch> bascule, turing completeness is separate from the grammar
[01:03:54] <strcat> bascule: no, in fact parsing C++ is turing complete
[01:03:58] <bascule> I'm talking about comprehending the grammar
[01:04:02] <bascule> strcat: thanks
[01:04:02] <strcat> bascule: it's turing complete
[01:04:04] <aatch> I mean, the game of life is turing complete
[01:04:08] <bascule> well sure
[01:04:11] <strcat> bascule: there are ambiguities you need to resolve with type checking
[01:04:17] <strcat> and fully type checking to resolve them is turing complete
[01:04:25] <strcat> bascule: in fact, the C++ standard doesn't describe a full grammar
[01:04:32] <strcat> it describes approximations of a grammar, as it's expected to be
[01:04:32] <bascule> strcat: that's unsurprising ;)
[01:04:34] <Florob> ChrisMorgan, I can't resist noting that using ~Tm instead of Tm would save ~200 Byte in that struct. But it also gives you the indirection and heap allocations of course.
[01:04:38] <strcat> but no one really knows what the C++ grammar is
[01:04:56] <strcat> it's expected that you can implement it
[01:04:59] <r-A> A grammar of grammars!
[01:04:59] <bjz> bascule: http://en.wikipedia.org/wiki/The_lexer_hack <- one issue among many
[01:05:00] <strcat> otherwise that's a defect in the standard
[01:05:06] <bascule> aatch: http://stackoverflow.com/questions/6079603/infinite-compilation-with-templates
[01:05:17] <bascule> ^^^ that doesn't seem context-sensitive to me ;)
[01:05:22] <strcat> bascule: gcc/clang actually memoize template recursion too ;p
[01:05:33] <bascule> bjz: nice
[01:05:37] <aatch> bascule, it is context sensitive.
[01:05:38] <strcat> and C++11 added a first-class list type to templates
[01:05:40] <aatch> as a language.
[01:05:49] <benh> clang still chokes on template<class T> struct Loop { Loop<T*> operator->(); }; Loop<int> i, j = i->hooray; I think
[01:06:09] <bascule> aatch: then why can something which is trying to comprehend C++ go into an infinite loop?
[01:06:13] <bjz> bascule: but C++ is so much more complex than C that there are all kinds of wierd interactions
[01:06:18] <bascule> aatch: shouldn't that... not be possible if it's context-sensitive?
[01:06:28] <aatch> bascule, they're orthagonal.
[01:06:32] <bascule> o_O
[01:06:36] <strcat> ChrisMorgan: let me just talk to you in /query
[01:06:37] <bascule> why?
[01:07:08] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[01:07:20] <aatch> Ok, in Rust it is possible to parse a program without knowing the semantics.
[01:07:26] <bascule> if it's context-free a pushdown automaton can understand it. If it's context-sensitive then nested pushdown automata can understand it
[01:07:29] <bascule> right?
[01:07:38] <bascule> how can a (nested) pushdown automaton go into an infinite loop?
[01:08:32] <aatch> bascule, hang on, give me a moment to check something.
[01:10:03] <strcat> aatch: bascule: http://stackoverflow.com/a/14589567/1009916
[01:10:08] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[01:10:12] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[01:10:14] <aatch> Ok, so I had a gap in my knowledge of grammars
[01:10:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:10:38] <aatch> you are correct in that it is an unrestricted grammar.
[01:10:43] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[01:10:51] <aatch> strcat, I've seen that.
[01:12:01] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[01:12:18] <aatch> However, I still stand by my point that the context-sensitivity aspect causes more issues. (In that being unrestricted doesn't eliminate the context-sensitivity).
[01:12:46] *** Joins: jstevans1 (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[01:12:53] *** Joins: vk (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[01:12:56] *** vk is now known as vky
[01:13:38] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[01:14:38] * ChrisMorgan is made a little uncomfortable by the fact that in Rust the pattern `x` has completely different meanings depending on whether there is a constant named `x` in scope or not
[01:15:03] <jack> ChrisMorgan: fwiw it's the same in erlang.
[01:15:24] <jack> I find it very useful there.
[01:16:40] <pcwalton> ChrisMorgan: also Standard ML
[01:16:47] <pcwalton> I wouldn't have done it if Standard ML hadn't done it
[01:16:54] <obi_wan> How can I run a Rust program and find out all the memory addresses it used?
[01:17:02] <pcwalton> obi_wan: use the force
[01:17:09] <aatch> obi_wan, why do you want to know?
[01:17:19] * pcwalton apologizes
[01:17:27] <sfackler> obi_wan: valgrind can track memory reads and writes iirc
[01:17:35] <pcwalton> proc/pid/maps may help
[01:17:43] <ssbr_> bascule: I'm not familiar with nested pushdown automata
[01:17:58] <ssbr_> bascule: the usual automata model for context-sensitive languages is linear bounded automata
[01:18:11] *** Quits: jstevans1 (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[01:18:15] <bascule> ssbr_: ok
[01:18:15] <ssbr_> which can go into an infinite loop pretty easily. It's just a turing machine, after all, albeit with restrictions on space usage.
[01:18:23] <bascule> I see
[01:18:34] <ChrisMorgan> jack/pcwalton: I agree that the simplicity of the two behaviours is very convenient, but it can lead to mistakes (bugs) and is a conceptual burden (not that using two different syntaxes wouldn't be a different and potentially greater conceptual burden). (We had someone in here yesterday wondering why his _ pattern that followed a CH pattern where CH was a local rather than a static was being rejected as unreachable.)
[01:18:35] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[01:18:35] <ssbr_> I'm not sure how you'd write a grammar to do that, though. I haven't thought about it.
[01:18:47] <pcwalton> we tried using ? to mark vars
[01:18:51] <pcwalton> and then tried using . to mark enums
[01:18:54] <ssbr_> The halting problem is decidable for linear bounded automata, so it doesn't matter
[01:18:56] <pcwalton> both were REALLY annoying
[01:19:07] <pcwalton> the only thing that works is case I think
[01:19:09] <pcwalton> like ocaml and haskell
[01:19:13] <ssbr_> (if it executes for more than a certain number of iterations, it will never terminate)
[01:19:15] <pcwalton> but we didn't want to go down the case sensitivity road
[01:19:54] <jack> ChrisMorgan: the alternative is extra syntax to bind or not-bind or removing the ability to pattern match against bound things.
[01:20:40] <ChrisMorgan> I quite agree; I can't suggest anything better than the current behaviour. These things always tend to be trade-offs where you can't get everything.
[01:20:45] <pcwalton> yeah :(
[01:20:47] <bascule> haha nice, a case where the compiler can't disambiguate whether or not something is a template?
[01:20:55] <jack> In erlang it's not so bad because you can't reuse identifiers
[01:21:09] <jack> rust practice is to shadow whenver you want
[01:21:29] <pcwalton> blame SML, they were first ;)
[01:21:31] <jack> so it causes more cognitive dissonance there, but i haven't noticed it muc.
[01:21:33] * ChrisMorgan wonders whether there would be resistance to changing that behaviour
[01:21:41] <pcwalton> I'd object
[01:21:53] * pcwalton <3 shadowing
[01:21:59] <pcwalton> ML-ism infecting my brain I guess
[01:22:05] <ChrisMorgan> Grounds? I'm curious if there are cases where it's genuinely useful.
[01:22:07] <jack> I can't think of a good example where I'd want bound idents over constants, but I bet I coudl find some going through my Erlang code.
[01:22:07] <pcwalton> but it's so nice to be able to say "let mut x = x;"
[01:22:15] <pcwalton> to convert from immutable to mutable
[01:22:19] <ssbr_> I thought freezing/unfreezing variables was a good use case
[01:22:26] <pcwalton> furthermore it can reduce bugs
[01:22:32] <jack> No having let makes some erlang code really ugly
[01:22:34] <pcwalton> when you shadow you ensure you can't refer to the old thing
[01:22:34] <strcat> ssbr_: we don't really need to do that anymore though
[01:22:37] <bascule> jack: :(
[01:22:37] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[01:22:43] <bascule> jack: Erlang has let. It just doesn't do anything
[01:22:47] <jack> Var2 = Var1#{name=bar}
[01:22:48] <ChrisMorgan> pcwalton: surely that should be handled at the time when you defined it initially? (I know that's not quite always possible yet.)
[01:22:48] <pcwalton> strcat: you do sometimes b/c you can't close over mutable variables
[01:22:52] <ssbr_> strcat: Oh. Well.
[01:22:57] <pcwalton> although that should just be fixed
[01:23:00] <strcat> pcwalton: oh right, but isn't that considered a bug?
[01:23:12] <bascule> jack: the pain
[01:23:20] <pcwalton> ChrisMorgan: not always, consider mutating a hash map then freezing it and moving it into an arc
[01:23:42] <pcwalton> furthermore, I always considered disallowing shadowing to be kind of anti-modular
[01:23:52] <pcwalton> it forbids you from copying and pasting code around
[01:23:59] <pcwalton> because there was some outer variable
[01:24:17] <ChrisMorgan> That sounds like a GREAT argument for *disallowing* shadowing!
[01:24:40] <pcwalton> it's part of refactoring though
[01:24:52] <pcwalton> you should be able to eliminate a function by inlining its body
[01:25:04] <bascule> ChrisMorgan: are you arguing for single assignment in Rust?
[01:25:06] <pcwalton> (now that isn't always true due to "return" but… oh well)
[01:25:13] <pcwalton> no, just C# style disallowing of shadowing
[01:25:24] <strcat> -D shadow, can be an option
[01:25:32] <pcwalton> I'd be fine with that
[01:25:32] <obi_wan> How do I pause a Rust program
[01:25:36] <strcat> #[deny(shadow)] in a crate
[01:25:40] <benh> maybe we need labeled return, like labeled break :D
[01:25:48] <ChrisMorgan> Hey, we could remove the `let` construct altogether! Use combinations of function arguments and pattern bindings as the only way to do it :P
[01:25:51] <strcat> obi_wan: you mean in a debugger? or as part of control flow
[01:25:57] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[01:26:01] <bascule> ChrisMorgan: o_O O_o
[01:26:03] <pcwalton> we could also remove names and use de Bruijn indices :)
[01:26:03] <bascule> please no
[01:26:04] <pcwalton> :D
[01:26:24] <strcat> remove variables and use a stack
[01:26:31] <pcwalton> Unlambda rules
[01:26:34] <ssbr_> ChrisMorgan: If I understand correctly, Rust has already moved in that direction
[01:26:38] <obi_wan> strcat: Control flow
[01:26:43] <obi_wan> I guess io::sleep?
[01:26:58] <strcat> obi_wan: well how long do you want it to pause? forever?
[01:27:00] <ssbr_> I think you can't do destructuring bind in as many cases anymore, or else I am confused
[01:27:12] <ssbr_> (so you have to do a single-arm match instead)
[01:27:25] <obi_wan> strcat: yup
[01:28:11] <strcat> obi_wan: well... rust probably doesn't have a way to efficiently pause forever, because that only makes sense with 1:1 threading + signals
[01:28:23] <strcat> otherwise how is it going to unpause?
[01:28:54] <bascule> strcat: SIGCONT
[01:28:55] <bascule> lol
[01:29:09] <strcat> well I mean the POSIX pause() function
[01:29:14] <strcat> it just waits, until a signal comes
[01:29:25] <bascule> o
[01:29:32] <strcat>        pause - suspend the thread until a signal is received
[01:29:37] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[01:29:54] <sfackler> sigsuspend is way less dangerous than pause though
[01:30:03] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[01:30:11] <strcat> why is pause dangerous? at least any more dangerous than any other syscall
[01:30:34] <strcat> if you don't mask signals you can be interrupted, it's the way of life
[01:30:43] <sfackler> if you call pause after the signal is delivered you may have a bad time
[01:30:56] <sfackler> sigsuspend allows you to atmoically unblock signals and pause
[01:31:20] <sfackler> *atomically
[01:31:20] <strcat> using process to process signals at all is bad ;p
[01:31:44] <strcat> by the time you send the signal, the pid may be gone and another process may have that pid (although it's pretty unlikely)
[01:31:51] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[01:32:56] *** Quits: mortisha (Mibbit@moz-D52C0647.ip.opendns.com) (Quit: http://www.mibbit.com ajax IRC Client)
[01:33:15] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[01:33:22] <aatch> I always enjoy sending SIGSEGV to processes.
[01:33:22] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[01:33:52] <o11c> aatch: me too ... I just wish they didn't send it to themselves so often
[01:34:02] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[01:34:07] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[01:34:12] <aatch> o11c, technically it's the kernal that sends it.
[01:34:39] <benh> technically it's the kernel that does pretty much anything!
[01:36:20] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[01:36:32] <kmc> in OS class we did a project implementing an "OS" in userspace, catching SIGSEGV to do paging and SIGALRM as a scheduler interrupt
[01:36:35] <kmc> it was kinda hilarious
[01:36:45] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[01:36:50] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Ping timeout)
[01:37:45] <aatch> kmc, heh, clever though.
[01:38:04] <o11c> I've always wanted to do something cool with catching SIGSEGV
[01:38:14] <pcwalton> you can't on mac :(
[01:38:18] <pcwalton> you have to use mach exceptions
[01:38:20] <pcwalton> it's sad
[01:38:22] <kmc> bummer
[01:38:31] <o11c> but there are some really nasty cases with SIGSEGVs from other sources
[01:38:35] <pcwalton> it's totally undocumented except for some old pages on CMU
[01:38:38] <o11c> I tried to write a pretty printer for siginfo_t once
[01:38:56] <kmc> yeah it's neat that you can get the faulting address from SIGSEGV (inside the siginfo_t)
[01:39:11] <o11c> kmc: right, but only some types of SIGSEGV
[01:39:11] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[01:39:26] <o11c> and the documentation about which set of fields are used is contradictory
[01:39:41] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[01:40:48] <strcat> o11c: doesn't strace do that?
[01:41:52] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:42:41] <lfox> If I wanted to take some time over the next few days to pick up rust, what resources should I be looking at?
[01:43:15] <obi_wan> How does the OS make sure that contiguous data structures are contiguous in real memory?
[01:43:46] <o11c> obi_wan: er, what?
[01:44:00] <isaacd> lfox: what sorts of languages are you already familiar with?
[01:44:09] <strcat> o11c: it doesn't
[01:44:10] <o11c> the OS doesn't have any responsibilities about layout, unless you're talking about paging
[01:44:11] <strcat> er
[01:44:13] <strcat> obi_wan: *
[01:44:56] <aatch> obi_wan, also "real memory" is a little ambiguous when you start thinking about cache lines etc.
[01:45:12] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[01:45:27] <bjz> what would be the best way to work out whether a vec has dups?
[01:45:32] <lfox> isaacd: ruby, js, a little obj c, and python
[01:45:44] <isaacd> lfox: I did fine with the tutorial, manual, std lib docs + source code, and playing with writing some Rust -- but I know C++11 and Haskell pretty well so I was familiar with most of the concepts
[01:45:51] <isaacd> let's see
[01:45:56] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[01:46:10] <strcat> bjz: do you still need to use it unaltered later?
[01:46:19] <bjz> strcat: no
[01:46:26] <o11c> bjz: the obvious solution is O(n²) ... but if you sort it, it's O(n lg n)
[01:46:35] <strcat> yeah, sorting
[01:46:51] <strcat> vectors also make wonderful maps if you don't need to do inserts/removes after building it
[01:46:51] <bjz> wait, dw
[01:47:04] <o11c> but you might be able to do some partial sort tricks
[01:47:05] <isaacd> lfox: hopefully someone else who knows whether there are other resources will respond :)
[01:47:07] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[01:47:15] <ChrisMorgan> lfox: I've heard good things about http://www.rustforrubyists.com/
[01:47:23] <obi_wan> strcat: So one can only guarantee that his or her data structure is continuous up to the page size?
[01:47:45] <aatch> obi_wan, physically? yes. Maybe.
[01:47:58] <strcat> obi_wan: contiguous in physical memory? you don't really know anything about that, even physical addresses are an abstraction
[01:48:01] <strcat> ;p
[01:48:03] <o11c> but the whole point of virtual memory is that you don't care about how the physical pages are laid out
[01:48:12] <kmc> and cache lines are smaller than a page anyway
[01:48:23] <lfox> isaacd: thanks! I'll take a look at the tut and docs, wasn't sure how up to date they would be
[01:48:32] <strcat> kmc: yeah and that's why intel is screwed!
[01:48:34] <aatch> cache lines are 32-64 bytes (have been for decades)
[01:48:45] <strcat> how will they advertise their new CPUs if they can't bump AVX past AVX-512 ;p
[01:48:48] <lfox> ChrisMorgan: that looks great! thanks
[01:48:56] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[01:48:57] <kmc> haha
[01:49:08] <strcat> but seriously AVX vectors are 64 bytes now.
[01:49:29] <strcat> 32 512-bit registers o_O
[01:49:33] <obi_wan> So the OS makes no attempt to allocate contiguous page frames?
[01:49:53] <isaacd> ChrisMorgan: that looks nice! I like how it starts with testing.
[01:50:04] <kmc> strcat: nice, let's stop allocating strings in memory and just pass them in AVX registers
[01:50:04] * ChrisMorgan hasn't read it at all
[01:50:32] <kmc> obi_wan: for certain of its own purposes, not generally for userspace mappings, I think
[01:50:35] * isaacd knows some Ruby
[01:50:46] <kmc> if (say) a network card is going to DMA into a big buffer, that needs to be contiguous in physical memory
[01:51:09] *** Joins: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP)
[01:51:11] <isaacd> lfox: the tut and docs are not *entirely* complete but they're probably more likely to be up-to-date than other documentation
[01:51:14] <kmc> also the page tables themselves, and interrupt descriptor tables, and things like that live in contiguous physical memory
[01:51:24] <kmc> (though, I think a single node in the page table tree fits in a single page, on x86 anyway)
[01:51:32] <strcat> kmc: for some meaning of contiguous :)
[01:51:55] <kmc> yeah
[01:52:48] <aatch> obi_wan, at any rate, you shouldn't need to worry about the contents of physical memory.
[01:53:09] <pcwalton> acrichto: does T in your impl of the chase-lev deque have to be word sized?
[01:53:33] <acrichto> pcwalton: I do not want to require it to be, and I believe that it shouldn't be necessary, but I haven't tested yest
[01:53:40] <acrichto> pcwalton: if it doesn't support it then it's a bug
[01:53:40] <pcwalton> ok
[01:53:41] <kmc> obi_wan: if you are curious, you can find the physical addresses of pages using Linux /proc/<pid>/pagemap : https://www.kernel.org/doc/Documentation/vm/pagemap.txt
[01:53:41] <pcwalton> I will hope that it is not!
[01:54:54] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[01:55:10] <kmc> this information would be useful for writing unconventional kernel exploits :)
[01:56:30] <obi_wan> kmc: When I call tail pagemap it just says Killed
[01:56:43] <o11c> pagemap is a binary file
[01:56:53] <o11c> with some very odd requirements
[01:57:03] <kmc> yeah read that txt file, you have to seek to a particular offset to learn about a particular page
[01:57:13] <obi_wan> Okay well i just tried to open it in gedit and my computer is slowly crashing
[01:57:27] <aatch> obi_wan, if you're worried about performance, don't. Even crazy runtime-developers don't think about what is in the *actual* memory.
[01:58:14] <aatch> Cache misses? Sure. There are people that will write a worse version of memcpy so it only takes up 2 cache lines.
[01:58:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[01:58:21] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[01:58:29] <kmc> i'm not sure what part of the system is faster on contiguous *physical* memory, anyway...
[01:58:33] <pcwalton> acrichto: larsberg reviewed your chase-lev deque in #servo and tested it some
[01:58:34] <pcwalton> looks good
[01:58:47] <kmc> \o/
[01:59:43] *** Quits: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP) (Ping timeout)
[01:59:56] <obi_wan> Oh crap Linux uses segments :(
[02:00:01] <obi_wan> This is going to be harder to figure out than pages
[02:00:06] <obi_wan> okay whoah it uses both
[02:00:26] <strcat> segment registers you mean? linux doesn't use those for actual memory purposes afaik
[02:01:07] <ChrisMorgan> obi_wan: it's got both page faults and segmentation faults, too.
[02:01:14] <strcat> linux uses FS for thread-local data and GS for CPU-local data iirc
[02:01:31] <strcat> and the others are not usable on x86_64? afaik it has no memory segmentation anymore
[02:01:34] <aatch> The advantage of continuous *virtual* memory is that the hardware can do stuff like pre-fetch for sequential access.
[02:01:43] <kmc> you can't disable segmentation on x86, but you can use it in a kind of trivial mode, and on x86-64 you mostly have to
[02:02:08] <strcat> kmc: does it actually exist for x86_64?
[02:02:11] <kmc> on x86-64 all of cs,ss,ds,es are fixed to have a base of 0 and a limit of 2^64
[02:02:30] <strcat> and fs/gs are abused for thread-local/cpu-local ;p
[02:02:41] <strcat> dunno what other OSes do
[02:02:57] <kmc> I think the architecture keeps fs/gs explicitly for those kinds of uses so I wouldn't say "abused" exactly
[02:03:26] <strcat> kmc: well when an access through a register can result in the linker doing stuff, it's abuse :P
[02:03:29] <kmc> in fact amd64 adds this SWAPGS instruction to assist the kernel in using %gs for very fast access to its own structures
[02:04:28] *** Quits: mye (mye@moz-12742E2C.dip0.t-ipconnect.de) (Quit: mye)
[02:04:51] *** Joins: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[02:05:23] *** Quits: DAddYE_ (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[02:05:35] <kmc> the PaX kernel patches for Linux use segmentation to enhance kernel security, but can't do it on amd64 :/
[02:05:38] <kmc> (they have to do something slower)
[02:05:38] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[02:05:54] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[02:06:01] *** Quits: alan (alan@moz-F8EE186F.lightspeed.snantx.sbcglobal.net) (Quit: alan)
[02:06:31] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[02:06:33] <kmc> Intel added a feature (SMEP) in Ivy Bridge which lets you have the same kind of safety that you could have with segments 25+ years ago
[02:06:47] <acrichto> pcwalton: awesome!
[02:07:04] <kmc> but any kernel designed to be portable (which includes Linux and even Windows NT) doesn't use segments nontrivially because they're so x86-specific
[02:07:36] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[02:08:53] <strcat> kmc: how exactly does it enhance security? hiding data?
[02:09:58] <kmc> so, kernel code typically uses the same page tables as the user process it's running on behalf of
[02:10:04] <kmc> because switching page tables on every syscall would be too slow
[02:10:27] <kmc> there's a bit for each page that says "is user code allowed to access this page", which is how the kernel hides its stuff from userspace
[02:10:35] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:10:49] <kmc> but there's nothing converse to that; kernel mode can always deref a user page whether it meant to or not
[02:12:18] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[02:12:48] <kmc> so when you're exploiting a kernel vuln, you can put your shellcode in normal userspace memory and just get the kernel to jump there while the CPU is still in kernel mode
[02:14:46] <aatch> I found this: http://vulnfactory.org/blog/2011/06/05/smep-what-is-it-and-how-to-beat-it-on-linux/
[02:14:51] <kmc> yep
[02:15:05] <kmc> another bad consequence of sharing address space is that whenever the kernel dereferences a pointer provided by userspace, it's required to do an explicit check to make sure it's not being fooled into clobbering one of its own datastructures
[02:15:21] <kmc> like it would be bad if I could call read(fd, some_kernel_address, sizeof(whatever)) and overwrite a kernel data structure
[02:15:46] <kmc> so Linux has thousands and thousands of calls to these functions like copy_from_user / copy_to_user / access_ok, and if you forget one it's usually exploitable to get root
[02:16:06] <kmc> and any random-ass obscure driver nobody cares about can make this mistake
[02:16:42] <kmc> anyway, segmentation would allow each memory access instruction in the kernel to specify whether it expects to be reading user or kernel memory
[02:16:48] <kmc> without the overhead of switching page tables
[02:17:01] <kmc> and that's what PaX does
[02:17:07] <kmc> (among many other clever tricks)
[02:17:15] <kmc> I could go on all day about it but it's pretty off topic
[02:17:33] <kmc> so I'll just link my slides on intro kernel exploitation and stop rambling: http://ugcs.net/~keegan/talks/kernel-exploit/talk.pdf
[02:18:11] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[02:19:17] <aatch> kmc, yeah, the article mentioned that. Though he didn't mention that segmentation isn't applicable to all CPUs, which makes it seem like the kernel devs are just lazy.
[02:19:21] <Eridius> sounds to me like a good opportunity to use a strong type system to denote user memory vs kernel memory
[02:19:48] <Eridius> where you need explicit calls to translate between the two, and the kernel can only dereference kernel memory, and can only pass user memory back to userland
[02:19:49] <kmc> strong type systems in systems programming??? what, C isn't good enough for you? just don't ever make any mistakes, what's the problem?
[02:19:50] *** Quits: nkoep (nik@moz-30370018.vpn.rwth-aachen.de) (Client exited)
[02:20:32] <kmc> that said linux does have a static analyzer thingy that is supposed to catch this: https://sparse.wiki.kernel.org/index.php/Main_Page
[02:20:33] <Eridius> I got it! Reintroduce hungarian notation! prefix each address variable with u or k to denote what it is! ;)
[02:20:59] <sp3d> if only we could make sure the one person who happens to care enough to write a driver for a unique pc-card wireless mouse from 1998 is also the one person who never makes mistakes when writing C code...
[02:21:23] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:21:30] <sp3d> and then repeat ad nauseum for all the other devices
[02:21:33] <kmc> so you'll see copy_from_user(const void __user *src, void *dst, int len)
[02:21:38] <bascule> kmc: got a type system problem in C? you're just a typedef void * away from fixing it
[02:21:46] <kmc> and that __user gets #define'd out in actual compilation but this Sparse thingy is supposed to do checks w/ it
[02:21:56] <kmc> but I have no idea how sound & complete it is
[02:21:57] <pcwalton> got a type system problem in rust? you're just a cast::transmute() away from fixing it
[02:21:59] * pcwalton trollface
[02:22:00] <bascule> lol
[02:22:06] <kmc> now you have two problems
[02:22:33] <Eridius> pcwalton: maybe we need a transmute lint, so you can #[deny(transmute)] ;)
[02:22:34] * bjz loves the good old cast::transmute
[02:22:39] <pcwalton> Eridius: you can deny unsafe now
[02:22:42] <kmc> Eridius: that was added recently yep
[02:22:48] <Eridius> yeah but unsafe might be too broad
[02:22:51] * bjz has learned from the best
[02:22:56] <pcwalton> you can create cast::transmute if you have unsafe
[02:23:10] <Eridius> also, this sounds like a good candidate for that attribute tainting thing we talked briefly about at the meetup
[02:23:29] <Eridius> yeah you can, but the point here isn't to prevent a determined user from doing something stupid, just prevent a normal user from doing it ;)
[02:25:41] <strcat> pcwalton: transmute_copy*, transmute is too picky about sizes
[02:26:36] <strcat> rusti: let x = ~5; unsafe { std::cast::transmute_copy(&x) }
[02:26:37] -rusti- pastebinned 10 lines of output: http://sprunge.us/OQWi
[02:27:17] <strcat> rusti: let x = ~5; unsafe { let x: f32 = std::cast::transmute_copy(&x); }
[02:27:18] -rusti- <anon>:9:34: 9:35 warning: unused variable: `x` [-W unused-variable (default)]
[02:27:18] -rusti- <anon>:9          let x = ~5; unsafe { let x: f32 = std::cast::transmute_copy(&x); }
[02:27:18] -rusti-                                            ^
[02:27:18] -rusti- ()
[02:27:56] <bascule> is rusti like... sandboxed somehow? heh
[02:28:14] <strcat> yes
[02:28:26] <strcat> bascule: https://github.com/thestinger/rust-playpen
[02:28:27] <bascule> one would hope so ;)
[02:28:31] <bascule> cool
[02:29:24] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[02:29:41] <strcat> rusti: std::io::stdout().write(std::run::process_output("ps", [~"ax"]).output)
[02:29:41] -rusti-   PID TTY      STAT   TIME COMMAND
[02:29:41] -rusti-     1 ?        Ssl    0:00 ./out
[02:29:41] -rusti-    24 ?        R      0:00 ps ax
[02:29:42] -rusti- ()
[02:29:49] <bascule> heh
[02:29:50] *** Quits: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman_)
[02:30:18] <bascule> rusti: std::io::stdout().write(std::run::process_output("cat", [~"/etc/passwd"]).output)
[02:30:20] -rusti- pastebinned 11 lines of output: http://sprunge.us/CAac
[02:30:26] <aatch> You'd have to do something mad to break out of the sandbox.
[02:30:26] <bascule> #trololol
[02:30:34] <strcat> pid1 is a shell script
[02:30:50] <strcat> then it spawns rustc to check the version, another rustc to compile, and execs the binary
[02:30:54] <strcat> so the binary is actually pid1
[02:30:59] <bascule> aatch: let me pull out a kernel 0day
[02:31:14] <strcat> bascule: in one of the exposed syscalls
[02:31:29] <strcat> and the only device it has is urandom
[02:31:51] <strcat> if rust didn't need so many syscalls... it could be more secure
[02:31:59] <o11c> not even /dev/null ?
[02:32:04] <strcat> o11c: don't need it ;p
[02:32:35] <bascule> strcat: okay, let me look in my bag of kernel 0days
[02:32:36] <bascule> hmm
[02:32:38] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:32:39] <bascule> it seems to be empty
[02:32:40] <bascule> :(
[02:33:23] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: ZZZzzz…)
[02:33:42] <strcat> dynamic linking and threading alone is already a lot of syscalls
[02:33:43] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[02:34:09] <strcat> little musl binaries just need execve and exit/exit_group
[02:34:33] <strcat> add read from stdin and write to stdout and you have a nice C sandbox ;p
[02:35:24] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[02:39:00] <pcwalton> hmm
[02:39:31] <pcwalton> is the right way to decrement an atomic int and check if it's zero to fetch_sub(1, SeqCtst) == 1 ?
[02:39:34] <pcwalton> or should I CAS
[02:39:45] <strcat> pcwalton: that's right
[02:39:47] <pcwalton> ok
[02:39:56] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[02:39:58] <strcat> just don't ask about efficient ordering because it blows my mind
[02:43:08] <aatch> kmc, nice presentation. Though everytime I read about security stuff like that I get really paranoid...
[02:43:14] <kmc> thanks
[02:43:18] <kmc> and, yes, occupational hazard
[02:43:33] <kmc> did you see the paper about dopant level backdoors in crypto hardware which can't be detected even with an electron microscope
[02:43:37] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[02:44:03] <aatch> kmc, no. A little outside my purview as a web developer
[02:44:21] <kmc> a little outside my purview as a web browser developer as well :)
[02:44:26] *** Joins: jstevans1 (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[02:44:37] <aatch> kmc, good point.
[02:45:10] <kmc> strcat: the best writeup I know of about memory ordering is https://www.kernel.org/doc/Documentation/memory-barriers.txt
[02:45:27] <aatch> I'm more of a performance nerd anyway, which kinda stops me from being too hardcore about security.
[02:45:29] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[02:45:34] <kmc> but it's still far beyond anything I could claim a solid knowledge of
[02:45:43] <strcat> kmc: yeah but I mean the C11/C++11 atomic ordering specifically
[02:45:50] <strcat> it's very abstract
[02:45:52] <aatch> (Though I certainly think about more than many web devs I know of)
[02:46:02] <kmc> ah
[02:46:14] <strcat> kmc: I think most older atomic stuff is probably usually sequential consistenchy
[02:46:17] <strcat> consistency*
[02:46:36] <strcat> but c11 atomics let you be super ridiculously specific about what you want for performance
[02:46:40] <strcat> when before, you would have used asm
[02:46:41] <aatch> strcat, it's not helped by the fact that x86 is practically a strong memory model itself, so it makes it hard to test properly.
[02:47:04] <strcat> kmc: http://www.boost.org/doc/libs/1_55_0/doc/html/atomic/usage_examples.html look at some of these
[02:47:07] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[02:49:03] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[02:49:16] <strcat> aatch: yeah, I wonder if valgrind could have tools for dealing with that
[02:49:24] <strcat> faking a weak memory model?
[02:49:30] <acrichto> pcwalton: not sure if it means anything, but a mixture of chase-lev deque operations mixed in with bookeeping for the test itself averages out to  ~50ns per operation
[02:49:59] <pcwalton> I'm about to try the first attempt at parallelizing flow tree stuff
[02:50:01] <acrichto> actually no, 40ns (20% of the total time is testing operations)
[02:50:04] <pcwalton> just printf for now
[02:50:09] <strcat> acrichto: I think that's good, I remember java queues being something like 200ns latency
[02:50:09] <pcwalton> and see how expensive it is
[02:50:17] <pcwalton> function calls are 2 ns
[02:50:21] <pcwalton> so that's like 20 function calls
[02:50:22] <acrichto> strcat: I also have no idea how to measure this lol
[02:50:40] <acrichto> pcwalton: the generated code looked amazing, stealers have one cmpxchg and that's the only atomic instruction
[02:50:45] <pcwalton> \o/
[02:50:57] * pcwalton can't wait to get parallel layout up and running
[02:51:02] <acrichto> oh ouch pushers have a div instruction
[02:51:03] <strcat> acrichto: with weaker ordering it won't have atomic ops on x86
[02:51:05] <pcwalton> this is like the moment of truth
[02:51:22] <acrichto> "cqto; idivq"
[02:51:28] <acrichto> what in the world is cqto
[02:51:30] <pcwalton> eh, div isn't as bad as it used to be
[02:51:36] <strcat> acrichto: that's x86 for you
[02:52:04] <acrichto> pcwalton: 20% of a pusher's time is spent on that div instruction, and 50% on the xchg after it
[02:52:05] <aatch> strcat, possibly. I remember watching a presentation by one of the HHVM devs, they wrote a tool based on some intel framework for testing performance.
[02:52:08] <pcwalton> aww
[02:52:14] * acrichto is confused, there is no div
[02:52:34] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[02:52:39] <strcat> acrichto: look at the LLVM IR?
[02:52:57] <strcat> is there a ~[T] somewhere?
[02:53:10] <aatch> Since it was a JIT and most tools just explode on JITs
[02:53:30] *** Joins: efnysien (efnysien@moz-50AD4325.res.cmu.edu)
[02:53:50] *** Quits: jstevans1 (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[02:54:13] <aatch> Anyway, seems like the framework was pretty generic, did what valgrind-like tools do and emulated a processor.
[02:54:28] <aatch> binary instrumentation ftw
[02:54:38] *** Joins: etw (john@moz-D871A25B.nyc.res.rr.com)
[02:54:56] <acrichto> pcwalton: ah strcat's right, looks like it's the bounds check, I really shouldn't be using arrays anyway
[02:55:18] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[02:55:19] <acrichto> good thing we have ptr::offset!
[02:55:23] <strcat> acrichto: a proper array impl wouldn't need the div, it's just silly ~[T] being silly ;[
[02:55:57] <strcat> acrichto: the division is coerce of ~[T] -> slice
[02:56:16] *** Quits: sigma (sigma@moz-D4F04D48.range86-174.btcentralplus.com) (Ping timeout)
[02:56:24] <strcat> it used to multiply the passed index and compare, but the multiply could overflow so it was wrong
[02:56:32] <strcat> it should just store in element length
[02:56:37] * strcat fixed slices but not ~[T]
[02:56:48] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[02:56:53] *** Quits: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com) (Ping timeout)
[02:56:53] <acrichto> just waiting on someone to reimplement it
[02:57:10] <etw> just trying to do some simple line by line file reading on master, but getting this type `std::io::fs::File` does not implement any method in scope named `read_line`
[02:57:24] *** Joins: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com)
[02:57:26] <strcat> acrichto: well I reimplemented it as a library type ;p
[02:57:56] <strcat> it's going to take hours of debugging and valgrind to change ~[T] ;\
[02:58:08] <aatch> acrichto, a quick search shows that cqto is "convert quad to oct" and does sign extension
[02:58:16] *** Joins: sigma (sigma@moz-D4F04D48.range86-174.btcentralplus.com)
[02:58:33] <strcat> aatch: uhh, as in 64-bit to 128-bit?
[02:58:34] <etw> what's the current way to read a file?
[02:58:49] <acrichto> aatch: to oct?! weird.
[02:59:07] <aatch> strcat, yep, idivq actually divides a 128bit integer by the operand
[02:59:14] <strcat> oh right
[02:59:29] <aatch> the operand is in rax:rdx
[03:01:09] * strcat is used to seeing division become magical shifts, thanks to it being a constant
[03:01:27] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[03:01:35] <strcat> seems weird that LLVM would be generating an idiv for a division by an element size
[03:01:50] <strcat> shouldn't it be spitting out some series of bit magic ops? ;p
[03:02:22] <aatch> well if it doesn't know the element size ahead-of-time.
[03:02:24] <acrichto> pcwalton: 15% faster not using ~[T] with bounds checks
[03:02:38] <strcat> acrichto: make sure the idiv is gone
[03:02:41] <pcwalton> acrichto: cool
[03:03:02] <strcat> I guess it will be
[03:04:22] <pcwalton> hey, it worked first try
[03:06:22] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:07:53] <acrichto> pcwalton: \o/
[03:07:58] <pcwalton> oh wait hmm
[03:08:03] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:08:28] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[03:08:40] *** Joins: int3_ (int3_@moz-3266A6C7.subnet-224.amherst.edu)
[03:08:43] *** Quits: int3_ (int3_@moz-3266A6C7.subnet-224.amherst.edu) (Client exited)
[03:09:31] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[03:10:43] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:11:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:11:52] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[03:12:31] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[03:12:33] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[03:12:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[03:13:09] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:14:05] <acrichto> hm, llvm cannot optimize fn foo(a: int, b: int) -> int { a % (1 << b) }
[03:17:06] <wycats_> Some preliminary benchmarks (not apples to apples; rust is doing more work) shows rust at 6x the speed of the ruby baseline
[03:17:28] *** Joins: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP)
[03:17:50] *** Joins: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net)
[03:18:03] <strcat> wycats_: are you enabling optimizations? that sounds pretty wrong
[03:18:17] <strcat> rust isn't slower than C if you're writing the same code in each
[03:18:49] <wycats_> Yes -O
[03:18:59] <wycats_> I'll take the 6x
[03:19:00] <strcat> what is it you're comparing?
[03:19:22] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[03:19:24] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[03:19:27] <wycats_> The ruby version is building a protobuf by hand and serializing
[03:20:59] *** Quits: jvshahid (jvshahid@moz-86D5F266.nyc.res.rr.com) (Ping timeout)
[03:21:54] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[03:22:32] <wycats_> strcat: the Rust version is building the protobuf structs based on calculations
[03:23:06] <wycats_> so the rust version is building a nested structure from start(timeA1) start(timeB1) end(timeB2) end(timeB1)
[03:23:24] <wycats_> they are similar kinds of work but Rust is doing more
[03:23:43] *** Quits: zz_kimundi (kimundi@moz-28813223.dip0.t-ipconnect.de) (Ping timeout)
[03:24:23] *** Quits: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman_)
[03:24:51] <wycats_> strcat: also... the Rust version is communicating to a separate task to do the serialization
[03:25:10] <strcat> well I expect that's all the time, then
[03:25:38] *** nrc is now known as nrc|afk
[03:27:04] *** Joins: zz_kimundi (kimundi@moz-BF21A096.dip0.t-ipconnect.de)
[03:27:11] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[03:27:11] *** ChanServ sets mode: +o tjc
[03:27:31] *** zz_kimundi is now known as kimundi
[03:27:58] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[03:28:58] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Quit: ZNC - http://znc.in)
[03:30:01] <wycats_> strcat: there's one serialization per iteration of the benchmark
[03:30:07] <wycats_> but there is no contention on the thread
[03:30:13] <wycats_> since there's only one ruby thread running at a time
[03:31:20] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[03:32:05] <strcat> wycats_: if it does any communication per iteration, that's going to outweigh building some little data structure
[03:32:14] <wycats_> strcat: yeeeep
[03:32:24] <wycats_> although I don't see that much time spent in there
[03:32:25] <wycats_> https://gist.github.com/wycats/356e2b28227841431e32/raw/66065bf0738741c36359603f7ae12d88c88884f8/-
[03:32:27] *** Quits: BossKonaSegway (Michael@moz-2986F42D.col.wideopenwest.com) (Ping timeout)
[03:32:29] <wycats_> take a look if you wish
[03:32:40] <wycats_> that's the result of a perf -g fractal
[03:32:57] <strcat> it's hard to account for a cache miss
[03:33:40] * strcat doesn't have much luck with sampling profilers
[03:33:51] <wycats_> strcat: is there a way to tell perf to trace instead of sample?
[03:33:54] <wycats_> I couldn't find it in the man page
[03:34:00] <strcat> use callgrind + kcachegrind
[03:34:11] <wycats_> scumbag chromebook :P
[03:34:25] <strcat> although yeah I think perf has better ways of doing stuff now, but I don't think it will be as good as callgrind
[03:34:41] <wycats_> strcat: is there a text output of callgrind?
[03:34:46] <strcat> wycats_: it's unusable
[03:34:47] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:34:58] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[03:35:22] <strcat> there are text formatters for it
[03:35:37] <strcat> but... kcachegrind :(
[03:36:16] <strcat> wycats_: http://valgrind.org/docs/manual/cl-manual.html#cl-manual.basics
[03:36:18] <strcat> but...
[03:36:18] *** Quits: efnysien (efnysien@moz-50AD4325.res.cmu.edu) (Client exited)
[03:36:24] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[03:36:24] *** ChanServ sets mode: +o tjc
[03:38:28] <strcat> (and cachegrind, ofc)
[03:38:50] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Textual IRC Client: www.textualapp.com)
[03:39:29] <strcat> anyway it's just not very usable without another tool :)
[03:39:30] <strcat> imo
[03:39:38] <strcat> perf doesn't need help
[03:40:18] <strcat> and it hates rust because of userspace context switches
[03:40:49] <wycats_> strcat: hm
[03:41:06] <wycats_> what's callgrind's package in ubuntu?
[03:41:59] <strcat> valgrind
[03:42:08] <strcat> valgrind has a bunch of stuff
[03:42:23] <wycats_> strcat: so perf misses userspace context switches?
[03:42:30] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:42:44] <strcat> wycats_: no I mean callgrind can't deal with them
[03:42:47] <strcat> it ruins the call graph
[03:42:52] <wycats_> ah
[03:43:05] <strcat> I'm not sure if it screws up perf, I haven't really noticed
[03:43:14] *** Joins: BossKonaSegway (Michael@moz-2986F42D.col.wideopenwest.com)
[03:43:32] <strcat> wycats_: callgrind will get confused and build a weird cyclical graph
[03:43:46] <strcat> I couldn't figure out how to get it to break the cycles from context switches
[03:43:51] <strcat> gave up ;p
[03:44:10] <wycats_> ;p
[03:44:25] <strcat> perf just peeks at the call stack during samples so it might not matter
[03:44:47] <strcat> callgrind/cachegrind are a sort of VM
[03:45:02] <strcat> and they follow it along
[03:45:25] <strcat> and you just have to hope cachegrind is representative of a modern CPU cache ;]
[03:47:06] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[03:47:14] <wycats_> :P
[03:48:16] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[03:48:54] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[03:51:09] *** Quits: BossKonaSegway (Michael@moz-2986F42D.col.wideopenwest.com) (Connection reset by peer)
[03:52:46] <aatch> Grrr, people wanting to mess with raw pointers...
[03:52:58] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[03:53:06] *** Joins: BossKonaSegway (Michael@moz-2986F42D.col.wideopenwest.com)
[03:54:13] <ofeldt-> aatch, what could possible go wro..SIGSEGV ;)
[03:54:41] <aatch> I'm talking specifically about this: https://github.com/mozilla/rust/issues/10571
[03:54:51] <aatch> Which, in my mind, just makes it easier to lie.
[03:55:20] <aatch> I like *T the way it is, thankyouverymuch,
[03:57:14] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[03:57:14] *** ChanServ sets mode: +o pnkfelix
[03:58:10] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:58:26] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:59:01] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[03:59:16] <ChrisMorgan> I was disappointed to find, when I went to search, that rust-http actually doesn't have any macros where being able to expand to multiple items will add anything :-(
[03:59:41] <apoelstra> aatch: what you posted there was well-written
[03:59:49] *** Joins: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net)
[04:00:16] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[04:00:17] <apoelstra> i doubt this rfc could get in, as you say, nullity is only one of many raw pointer dangers
[04:00:31] <ChrisMorgan> The macros are either multiple expressions where doing it as a block is fine (and that's not items, anyway), or expanding to a mod where that *is* actually what I want (it's not the `mod generated {} use generated::*;` pattern).
[04:00:33] <aatch> apoelstra, thanks. I tend to get worked up when I see (what I consider) people ignoring the "systems" part of the language.
[04:00:43] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[04:00:43] *** ChanServ sets mode: +o jdm
[04:01:26] <aatch> apoelstra, I also only realised that it's impossible to prevent a null `*T` while writing it, and that's where I feel the danger really lies.
[04:02:07] <ChrisMorgan> I agree too, though I haven't had cause to actually use *T at all. Depending on a Rust library type for such a thing feels very ugly, possibly also incompatible with the concept of passing things around through FFI as opaque values.
[04:02:50] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[04:02:54] <wycats_> ofeldt-: raw pointers are fun ;)
[04:03:07] <wycats_> ofeldt-: I mostly try to pretend that I'm not using raw pointers :P
[04:03:38] <aatch> ChrisMorgan, that's the other part for me. *T is mostly used for FFI and you should be implementing a safe wrapper on top of it anyway.
[04:03:39] <ofeldt-> wycats_, ignorance is half the battle ;)
[04:03:52] <wycats_> ofeldt-: I just write all my code as if it was safe :P 
[04:04:01] <wycats_> and then make sure C code doesn't lie :P
[04:04:12] <ChrisMorgan> and then... what?
[04:04:56] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[04:05:04] <sfackler> when did blocks start with #{?
[04:05:14] <wycats_> aatch: you can mostly use regular rust types for FFI :P
[04:05:23] <wycats_> at least that has been my experience
[04:05:27] <ofeldt-> wycats_, done my fair share with wrapping libacl in ruby via ffi, no fun.. no fun at all ;)
[04:05:44] *** Joins: notmatt (notmatt@moz-152F21B7.vc.shawcable.net)
[04:06:06] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[04:07:16] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:09:17] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:09:53] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:09:54] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:10:23] *** Joins: lenary (sid5084@moz-31ABA2C0.irccloud.com)
[04:10:26] <apoelstra> how do i write *T in a code block on github?
[04:10:54] *** Quits: notmatt (notmatt@moz-152F21B7.vc.shawcable.net) (Ping timeout)
[04:11:00] *** Quits: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net) (Quit: Jesse)
[04:11:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:11:39] <ofeldt-> apoelstra, <code>*T</code> is guess
[04:11:53] *** Joins: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net)
[04:12:03] <apoelstra> ofeldt-: thx, that is right
[04:12:05] <apoelstra> http://daringfireball.net/projects/markdown/syntax#code
[04:12:56] <sfackler> YOu can also do `*T`
[04:13:02] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:13:42] <apoelstra> nice, thx sfackler
[04:13:58] *** Parts: lenary (sid5084@moz-31ABA2C0.irccloud.com) ()
[04:16:05] <ofeldt-> wycats_, btw. thanks for sharing your ruby-c-rust-slide on twitter via gdocs, used them to introduce some friends to rust.
[04:16:13] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[04:17:54] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[04:17:54] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:18:58] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[04:19:29] *** Quits: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net) (Ping timeout)
[04:20:04] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0/20131025151332])
[04:26:41] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[04:28:18] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[04:28:26] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[04:29:04] *** Joins: ab (alex@BC9D99CC.37C1012D.FE617B51.IP)
[04:30:16] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:30:56] <wycats_> ofeldt-: awesome :)
[04:31:10] <wycats_> ofeldt-: I guess they weren't too embarrassing then
[04:33:31] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: 랜덤은 쇠퇴했습니다.)
[04:33:45] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[04:34:17] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[04:34:59] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[04:36:23] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:36:46] *** Joins: brson (brson@moz-C7C20043.sd.sd.cox.net)
[04:36:46] *** ChanServ sets mode: +ao brson brson
[04:42:10] <bjz> apoelstra: https://help.github.com/articles/github-flavored-markdown
[04:43:23] <bjz> brson: was playing with a RecvIterator: https://gist.github.com/bjz/875e03ef14657c90567d
[04:43:29] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:44:31] <bjz> brson: it compiles and passes the tests fine, but when I try moving it into std::comm I get weird errors: https://gist.github.com/bjz/1ff8e10dd5e740ff8df2#file-gistfile1-txt-L12
[04:45:40] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[04:46:11] <bascule> a wild wycats_ appears
[04:46:16] <wycats_> c
[04:46:19] <wycats_> I never disappeared
[04:46:20] <wycats_> :P
[04:46:21] <bascule> lol
[04:46:29] <wycats_> I am here all day every day wheeeee
[04:46:32] <wycats_> such speed
[04:46:33] <wycats_> such power
[04:46:34] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[04:46:34] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[04:46:34] *** Quits: oal (oal@26029749.1D466084.2CFD4520.IP) (Ping timeout)
[04:46:35] <wycats_> such concurrency
[04:46:37] <wycats_> such safety
[04:46:38] <wycats_> wow
[04:46:50] <bascule> /nick wydoge
[04:46:55] *** Joins: oal (oal@26029749.1D466084.2CFD4520.IP)
[04:47:06] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[04:47:42] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[04:48:08] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[04:48:31] *** Joins: notmatt (notmatt@moz-152F21B7.vc.shawcable.net)
[04:48:36] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[04:48:54] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[04:49:11] *** Joins: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP)
[04:49:43] *** Quits: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP) (Quit: Leaving.)
[04:49:54] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (Ping timeout)
[04:50:02] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[04:51:10] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[04:51:54] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[04:53:13] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[04:53:17] <wycats_> lolol
[04:53:23] <wycats_> bascule: you using rust for anything?
[04:53:33] <bascule> wycats_: I'm still going through Rust for Rubyists
[04:53:38] <wycats_> bascule: ah
[04:53:43] <wycats_> feel free to ping me if you have any doubts
[04:53:48] <wycats_> I will try to clear them, as José says
[04:53:52] <bascule> after that I'll probably write an IRC bot
[04:53:53] <bascule> lol
[04:53:53] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[04:53:55] <bascule> k
[04:54:00] <bascule> so far I do not have doubts
[04:54:05] <wycats_> bascule: unsure about the quality of the IO libraries in Rust :P
[04:54:07] <bascule> at least technical ones ;)
[04:54:10] <bascule> hahaha
[04:54:12] <bascule> I'll manage bro
[04:54:17] <bascule> I whipped Ruby into shape
[04:54:20] <wycats_> bascule: my understanding is that they are "not much past the demo stage"
[04:54:25] <wycats_> bascule: celluloid for Rust?
[04:54:27] <ChrisMorgan> The network libraries are fine and solid.
[04:54:32] <strcat> wycats_: can always use any existing C library, too
[04:54:33] <bascule> Rust doesn't need Celluloid
[04:54:35] <wycats_> ChrisMorgan: that's not what I heard ;)
[04:54:37] <bascule> Rust has everything I want built in
[04:54:38] <wycats_> bascule: indeeeed
[04:54:40] <bascule> :O
[04:54:40] <wycats_> I was trolling
[04:54:45] <bascule> oh my god! it's crazy!
[04:54:49] <wycats_> such Task
[04:54:51] <ChrisMorgan> wycats_: my own rust-http is, while far from full-featured, very stable.
[04:54:52] <bascule> lol
[04:55:01] <wycats_> acrichto: do you confirm or deny?
[04:55:41] <wycats_> ChrisMorgan: it doesn't use @-boxes, does it? :P
[04:55:46] <strcat> if you want more than http, rust makes curl easy to use now that it has vararg support
[04:55:46] <ChrisMorgan> No.
[04:55:49] * wycats_ has gotten burned by scumbag protobuf library
[04:55:54] <bascule> lolol
[04:56:33] <wycats_> I wish Rust didn't allocate for ~[]
[04:56:34] <ChrisMorgan> std::rt::io used to be fairly crashy, but by 0.8 it was just about crash-free and I haven't managed to break it for some time now.
[04:56:39] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:56:40] <wycats_> ChrisMorgan: :)
[04:56:50] <ChrisMorgan> wycats_: but that's exactly what the ~ in ~[] *is*
[04:56:57] <wycats_> ChrisMorgan: it allocates many slots
[04:56:58] <wycats_> ;)
[04:57:00] <wycats_> 4 slots
[04:57:04] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: )
[04:57:07] <acrichto> wycats_: I can confirm that we're not much past the demo stage
[04:57:12] <wycats_> ChrisMorgan: I am planning on using rust-http once I get further along
[04:57:18] <wycats_> ChrisMorgan: so we will find out :p
[04:57:21] <acrichto> we're getting there though!
[04:57:21] <brson> bjz: i would guess it has to do with missing imports of some kind
[04:57:30] <wycats_> acrichto: ChrisMorgan: FIGHT
[04:57:31] <bascule> acrichto: oh no! are you saying my mission critical IRC bot will potentially fail?
[04:57:32] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[04:57:33] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[04:57:36] <brson> bjz: since std doesn't import the prelude
[04:57:38] <ChrisMorgan> wycats_: yay!
[04:57:45] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[04:57:45] *** ChanServ sets mode: +o pnkfelix
[04:57:47] <bjz> brson: ah ok
[04:57:51] <wycats_> ChrisMorgan: right now I'm still using Ruby to send the payload to the server
[04:57:58] <acrichto> bascule: it should all be there! The apis may be a little rough around the edges though, but you should certainly be able to do that
[04:58:01] <wycats_> ChrisMorgan: but once everything is integrated I plan to change that
[04:58:03] <bjz> brson: what do you think of the iterator anyway?
[04:58:20] <bascule> acrichto: if my IRC bot fails, it will cost me a whopping $0/sec. I can't have that happen
[04:58:31] <bjz> brson: I find myself doing loop { match port.try_recv() { ... None => break, } } an awful lot
[04:58:39] <ChrisMorgan> bascule: in the case of something like rust-http, I would certainly not guarantee it to be solid against a determined attacker (there may be issues in the scheduler, the libuv TCP stuff or in rust-http), but it can certainly sustain heavy loads with no problems.
[04:58:42] <acrichto> bascule: if you file a form A-19 the rust core team can compensate you for your time
[04:58:45] <brson> bjz: it's a common pattern to recv until end so it probably makes sense
[04:58:56] <bascule> acrichto: sweet
[04:58:59] <bjz> brson: it would make it: for x in port.recv_iter() { ... }
[04:59:03] <bascule> ChrisMorgan: I demand 0 9s of uptime
[04:59:26] <bjz> brson: the nice thing is you can still access the port inside the for block
[04:59:33] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[04:59:40] <bascule> I have a vicarious question from a functional language weenie
[04:59:42] <brson> bjz: that is nice, yes
[04:59:46] <bascule> does Rust support higher order polymorphism?
[04:59:51] <shachaf> hi bascule
[05:00:04] <bascule> shachaf: sup, lol
[05:00:40] <shachaf> If you mean higher-kinded type variables, I'm pretty sure the answer is no.
[05:00:51] <ofeldt-> wycats_, nope, got the message around, which in my case was: the prospect of an alternative language to write proper extensions for MRI.
[05:00:57] <bascule> shachaf: I'm asking on behalf of mm_freak
[05:01:00] <bascule> heh
[05:01:22] <shachaf> Or "no, because no one's gone to the trouble of implementing it, but there's no fundamental reason it couldn't be implemented, but it's not planned for 1.0".
[05:01:54] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (Client exited)
[05:02:05] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[05:02:56] <bjz> brson: is it ok just to do `use prelude::*` in a tests mod?
[05:06:35] *** Joins: cubic_ (cubic@moz-80241A3A.mc.videotron.ca)
[05:07:09] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Ping timeout)
[05:07:54] <bjz> brson: ooh, it works!
[05:07:57] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:07:57] <bjz> thanks!
[05:08:38] <brson> bjz: it's ok, yeah
[05:08:42] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[05:09:11] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:10:58] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:11:14] *** Quits: obi_wan (Mibbit@moz-E9218C9D.ga.at.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:11:15] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[05:12:29] <wycats_> ofeldt-: :)
[05:12:30] <brson> i wonder why last week's event still hasn't shown up on air mozilla
[05:12:33] <wycats_> ofeldt-: we need to do more work
[05:13:07] <wycats_> ofeldt-: we really need rust.h
[05:14:25] <wycats_> also the ability to statically link and call into the runtime using something like acrichto's recv-loop haclk
[05:14:27] <wycats_> hack*
[05:14:39] <wycats_> once I'm actually shipped I'll think seriously about what is needed
[05:14:43] <wycats_> and possibly put something together
[05:15:00] <wycats_> I'm excited about acrichto's recent work on static linking
[05:15:19] *** Joins: carrus85 (carrus85@CD83A7DD.7127D6FC.637467AC.IP)
[05:15:45] <brson> i pinged somebody about air mozilla
[05:16:01] <wycats_> brson: :)
[05:19:44] <bjz> r? https://github.com/mozilla/rust/pull/10688
[05:21:42] <bjz> brson: I r?ed you, but it's ok if you're on holidays
[05:24:55] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[05:25:16] <eddyb> bjz: ooh, that is nice :D
[05:25:23] <bjz> :)
[05:25:39] <eddyb> which reminds me I shouldn't sit on my ass while bors deals with my PR
[05:25:47] *** Joins: kmapped2 (kmapped2@A35331CF.60E9685E.20F09BA6.IP)
[05:26:09] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[05:26:09] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[05:26:11] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (Client exited)
[05:26:15] <bjz> thanks brson!
[05:26:18] <bjz> :)
[05:26:20] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[05:26:20] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[05:26:25] *** Quits: kmapped (kmapped@moz-2489C24B.compute-1.amazonaws.com) (Quit: leaving)
[05:26:39] *** Quits: busylizzy (lisa@270089DC.4EF5D73F.4E00FFE9.IP) (Ping timeout)
[05:26:43] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[05:26:48] *** Quits: terje (terje@F5FDF11B.1D1EB2D6.85889BB1.IP) (Ping timeout)
[05:27:14] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[05:27:34] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:28:06] *** Joins: busylizzy (lisa@270089DC.4EF5D73F.4E00FFE9.IP)
[05:28:17] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[05:28:57] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[05:29:12] *** Quits: kmapped2 (kmapped2@A35331CF.60E9685E.20F09BA6.IP) (Quit: leaving)
[05:29:45] *** Joins: kmapped2 (kmapped2@A35331CF.60E9685E.20F09BA6.IP)
[05:29:59] *** Joins: terje (terje@F5FDF11B.1D1EB2D6.85889BB1.IP)
[05:32:10] *** Quits: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman_)
[05:34:55] *** Quits: nomadic (nomadic@moz-E01D5C49.hsd1.ga.comcast.net) (Quit: Leaving)
[05:34:57] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[05:35:55] *** Joins: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP)
[05:36:08] <ofeldt-> wycats_, yeah, definitely. i'm the first to clone your repo ;)
[05:36:17] *** Parts: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP) ()
[05:36:44] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[05:36:53] *** Joins: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP)
[05:36:58] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[05:39:14] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[05:39:51] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[05:40:09] *** Parts: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP) ()
[05:40:58] *** Joins: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP)
[05:41:02] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[05:41:26] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[05:43:26] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[05:43:52] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[05:43:58] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[05:44:01] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[05:44:36] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[05:45:34] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:45:34] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[05:47:03] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:48:15] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[05:48:46] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[05:49:04] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[05:49:59] <wycats_> ofeldt-: :D
[05:50:15] *** Joins: alonlevy (alon@moz-B09A5806.bb.netvision.net.il)
[05:50:27] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[05:50:35] *** Quits: dbaupp (Thunderbir@A56F6AEF.D5A1DCF.37681C44.IP) (Ping timeout)
[05:50:35] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[05:51:24] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[05:51:29] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[05:52:01] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[05:52:15] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:52:24] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[05:53:39] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[05:54:55] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[05:55:01] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[05:55:15] *** Quits: cubic_ (cubic@moz-80241A3A.mc.videotron.ca) (Quit: Leaving)
[05:56:28] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[05:57:30] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[05:57:45] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:58:17] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[05:58:17] *** ChanServ sets mode: +o pnkfelix
[05:58:41] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[06:00:11] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[06:01:36] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (NickServ (GHOST command used by Amanieu_))
[06:01:47] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[06:01:57] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[06:02:41] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[06:02:45] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[06:03:00] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[06:03:50] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[06:06:01] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[06:07:40] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (NickServ (GHOST command used by Amanieu_))
[06:07:50] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[06:09:41] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:09:51] *** Joins: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net)
[06:12:19] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[06:12:19] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[06:13:24] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:13:40] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[06:13:41] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:14:27] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[06:14:30] *** Quits: notmatt (notmatt@moz-152F21B7.vc.shawcable.net) (Client exited)
[06:15:08] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Ping timeout)
[06:16:10] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[06:16:15] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[06:18:18] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[06:20:07] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[06:20:37] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:21:36] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[06:22:19] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[06:23:39] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[06:25:00] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[06:25:10] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[06:25:32] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[06:25:35] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[06:25:40] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:25:49] *** Quits: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP) (Client exited)
[06:25:59] *** Joins: Amanieu (amanieu@10FEE2FD.ECEF57A4.2CFD4520.IP)
[06:26:10] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[06:26:37] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[06:27:25] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Ping timeout)
[06:30:28] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:31:42] *** Quits: paulproteus (quassel@199.199.210.158) (Ping timeout)
[06:32:46] *** Joins: paulproteus (quassel@458FE134.3EC36C88.CBDCF1DC.IP)
[06:34:36] <sam113101> when's 0.9 coming out, yo?
[06:36:06] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[06:38:11] <jdm> sam113101: when you least expect it
[06:39:18] * ChrisMorgan least expects it in the past
[06:39:33] <sam113101> yeah, I didn't expect it at all yesterday
[06:39:37] <sam113101> yet it's not there today
[06:40:22] <ChrisMorgan> sam113101: you just weren't looking yesterday—it's been and gone again :P
[06:41:28] *** Joins: derek_c (derek@moz-E72F174.cit.cornell.edu)
[06:41:39] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[06:43:23] <jdm> 0.9 is shy
[06:43:42] <derek_c> Is it possible to implement extra::serialize::Decodable<extra::json::Decoder> for &[u8] using #deriving?
[06:44:49] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Client exited)
[06:46:45] <brson> i think 0.9 will be beginning of january
[06:47:22] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[06:47:26] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[06:47:46] <sam113101> I want to start working with rust but I don't know what to do
[06:48:00] <jdm> sam113101: make a game!
[06:48:11] <sam113101> I don't like games =/
[06:48:13] <ChrisMorgan> sam113101: well, what fields interest you?
[06:49:36] *** Joins: notmatt (notmatt@moz-152F21B7.vc.shawcable.net)
[06:50:03] <derek_c> sometimes I see weird type names in compile error messages, like V1211.  What do those mean?
[06:50:38] <ChrisMorgan> <VI0> is the unresolved type of an generic integral (the "I" part).
[06:51:34] <ChrisMorgan> The literal `5` might be int, i8, i16, i32, i64, uint, u8, u16, u32 or u64; its type, until it is successfully inferred, is one of these <VI0>, <VI1>, etc. values.
[06:52:41] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[06:52:51] <derek_c> ChrisMorgan: but in my case there is no I. Just V1211 V1212, etc.
[06:53:31] <ChrisMorgan> You sure they're ones, not I's? And are there angle brackets about it?
[06:53:51] <derek_c> yeah there are. they are 1s for sure
[06:54:00] <derek_c> error: mismatched types: expected `|&[(<V1211>,<V1212>)]| -> ~[(<V1211>,~[<V1212>])]` but found `|~[(KeyT2,ValT2)]| -> ~[(KeyT2,~[ValT2])]` ([] storage differs: expected & but found ~)
[06:54:27] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[06:54:43] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[06:55:04] <ChrisMorgan> Hmm, OK. Generic bounds, I presume. I haven't run across them for a while, I'd forgotten about them.
[06:55:24] <ChrisMorgan> Unresolved generic types, I mean.
[06:55:58] <derek_c> yeah all those generic errors are giving me headache
[06:56:51] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[06:57:07] <ChrisMorgan> Do you understand what the problem is in that particular case?
[06:58:36] *** Joins: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net)
[06:58:47] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[06:58:47] *** ChanServ sets mode: +o pnkfelix
[06:59:31] *** Quits: notmatt (notmatt@moz-152F21B7.vc.shawcable.net) (Client exited)
[06:59:35] *** Joins: valenting (Thunderbir@95C905BA.4985FA88.FCAAE698.IP)
[07:00:25] <jdm> they're actually inferred values, not generic ones
[07:00:39] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[07:00:44] <jdm> oh, you covered that
[07:01:36] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[07:02:11] *** Joins: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net)
[07:03:49] *** Joins: fabiand (fabiand@moz-B27F8438.adsl.alicedsl.de)
[07:04:41] *** Quits: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net) (Input/output error)
[07:05:03] *** Joins: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net)
[07:08:37] *** Joins: prtksxna (prtksxna_m@moz-92C76F24.webfaction.com)
[07:09:51] *** Parts: prtksxna (prtksxna_m@moz-92C76F24.webfaction.com) (Textual IRC Client: www.textualapp.com)
[07:12:52] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[07:12:56] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[07:13:20] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[07:13:57] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[07:14:05] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[07:14:43] *** Quits: valenting (Thunderbir@95C905BA.4985FA88.FCAAE698.IP) (Ping timeout)
[07:16:47] *** Joins: lfox (lfox@moz-B8648F0F.nycmny.fios.verizon.net)
[07:18:05] *** Quits: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman_)
[07:23:23] *** Quits: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net) (Quit: Leaving)
[07:23:44] *** Joins: Ms2ger (Ms2ger@moz-B7007F1C.ugent.be)
[07:25:24] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:26:02] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[07:26:03] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:28:48] *** Quits: carrus85 (carrus85@CD83A7DD.7127D6FC.637467AC.IP) (Quit: Leaving)
[07:29:04] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[07:29:15] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[07:29:18] <sam113101> strcat: are you there?
[07:29:25] <strcat> yes, why?
[07:30:11] <sam113101> strcat: you talked about gtk emacs keybindings the other day, do you get alt+b (as well as other alt+ shortcuts) to work inside apps using gtk?
[07:30:26] *** Quits: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo_)
[07:30:40] <strcat> sam113101: https://github.com/thestinger/dotfiles/blob/master/.config/gtk-3.0/settings.ini
[07:31:20] <strcat> https://github.com/thestinger/dotfiles/blob/master/.config/gtk-2.0/gtkrc (but usually gtkrc for gtk2 is at ~/.gtkrc-2.0 if you don't override the env var)
[07:31:47] <strcat> the Emacs key theme is the only non-default one shipping with gtk, but you can make your own
[07:32:41] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[07:32:41] *** Quits: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP) (Ping timeout)
[07:32:58] *** Quits: brson (brson@moz-C7C20043.sd.sd.cox.net) (Quit: leaving)
[07:33:01] <sam113101> well, alt+b opens up the bookmarks menu in firefox, for example, instead of jumping to the previous word
[07:34:10] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:34:53] <strcat> sam113101: firefox overrides most of this stuff
[07:35:00] <strcat> it only fixes a few like C-w in ffx
[07:35:05] <boredomist> dumb question: how can i terminate a TcpStream?
[07:35:08] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[07:35:17] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[07:35:18] <boredomist> the most relevant thing i see is RtioTcpStream::letdie
[07:35:22] <strcat> (firefox isn't actually gtk, it just uses gtk on linux for *some* stuff)
[07:35:58] *** Joins: PGGB (PGGB@BD9E64E0.2702580D.85889BB1.IP)
[07:36:00] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[07:36:06] <sam113101> strcat: what kind of stuff? I know the widgets on the web pages are gtk widgets
[07:36:09] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[07:36:11] <boredomist> but i can't call letdie directly because it's TcpStream { priv obj: Rtio... }
[07:36:22] <strcat> sam113101: widgets on web pages aren't usually gtk afaik
[07:36:37] <strcat> firefox uses gtk to obtain an idea about the colorscheme to mimic
[07:36:39] *** Quits: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP) (Ping timeout)
[07:36:40] <sam113101> why are they affected by my gtk theme, then?
[07:36:43] <sam113101> oh
[07:36:54] *** Joins: mrshankly (mrshankly@3EE34383.CE0EEBAE.806C54C8.IP)
[07:37:01] <strcat> it might *render* some stuff with gtk, but it's not using gtk widgets in general
[07:37:12] <sam113101> I see
[07:37:21] <strcat> the old menu bar might have been a gtk widget, and I guess scroll bars are
[07:37:29] *** Quits: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP) (Quit: Computer has gone to sleep.)
[07:37:43] <sp3d> strcat: it's all XUL, just GTK rendering with replaced input logic
[07:38:10] <strcat> sp3d: it does follow some of the input logic though
[07:38:14] <sp3d> e.g. the scrollbar responds to mouse clicks differently than GTK ones, and the menubar had a different text color with some GTK themes
[07:38:15] <sp3d> some, yes
[07:39:10] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[07:39:17] <sp3d> but I wouldn't bet on key theme support since that works by remapping signals on GtkEditable mostly
[07:39:54] <sp3d> (IIRC, it was one of those interfaces)
[07:39:54] <strcat> sp3d: it fixes C-w at least ;p
[07:39:58] <sp3d> :D
[07:40:14] <strcat> that's not even really an emacs binding
[07:40:23] * strcat expects it to work
[07:40:29] <strcat> and not close the window/tab
[07:40:46] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Quit: Leaving...)
[07:41:24] *** Quits: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net) (Quit: Leaving)
[07:41:38] <Luqman> boredomist: you don't need to terminate it youself, that'll happen in the destructor
[07:41:52] <boredomist> Luqman: i want to terminate it early
[07:42:15] <strcat> boredomist: pass it by-value to a function discarding it
[07:42:25] <strcat> fn ignore<T>(x: T) {} ignore(stream)
[07:42:30] <strcat> there's std::util::ignore defined like that
[07:42:38] <boredomist> aha, thanks
[07:43:26] <boredomist> err, hmm
[07:43:35] <boredomist> not sure that would work
[07:43:41] <strcat> why?
[07:43:45] <boredomist> here, let me post the code segment
[07:44:10] <boredomist> https://github.com/boredomist/rust-statsd/blob/master/src/server/main.rs#L34
[07:44:44] <boredomist> i changed a little bit locally so that the function call returns (response: str, should_continue: bool) 
[07:44:50] <boredomist> (which is probably the wrong way)
[07:45:04] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[07:45:06] <boredomist> but basically i want to be able to bail out early if should_continue == false
[07:45:14] <Heather> new syntax change \o/
[07:45:17] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[07:45:32] <Ms2ger> Mm, syntax changes?
[07:46:04] <boredomist> i can't just break out of the loop because i'm in a closure
[07:46:12] <Heather> yes
[07:46:13] <boredomist> i'm definitely missing an obvious answer
[07:46:16] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[07:46:23] <Heather> closure syntax change
[07:47:01] <boredomist> should i be using proc here?
[07:48:37] <Heather> dbaupp ping, how to define &fn-> thing now?
[07:48:37] <boredomist> Heather: oh, were you talking to Ms2ger?
[07:48:58] <Heather> boredomist sorry I just came here to learn new syntax )
[07:49:07] *** Joins: notmatt (notmatt@moz-152F21B7.vc.shawcable.net)
[07:49:09] <boredomist> my mistake, misread :)
[07:49:09] <Ms2ger> Ah
[07:49:12] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[07:49:12] *** Quits: notmatt (notmatt@moz-152F21B7.vc.shawcable.net) (Client exited)
[07:49:18] <Heather> things that was added today or yesterday
[07:49:51] *** flaper87|afk is now known as flaper87
[07:49:55] <Heather> wow I wonder if that will work as |A| -> B
[07:50:32] *** Quits: alonlevy (alon@moz-B09A5806.bb.netvision.net.il) (Ping timeout)
[07:51:23] <boredomist> meh, guess i'll just restructure the loop so that i can break out of the loop more easily
[07:52:34] <Heather> let a = |b: ||, c: |d : ||||
[07:52:39] <Heather> ||||||| \o/ |||||
[07:53:06] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:54:50] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[07:54:50] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[07:54:50] *** ChanServ sets mode: +o pnkfelix
[08:00:13] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[08:01:02] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[08:01:39] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[08:02:37] *** Joins: xeno (~0@moz-A0CF1F9B.lns20.mel4.internode.on.net)
[08:03:29] <xeno> has range changed since 0.6?
[08:04:08] <xeno> for uint::range(0, lastpbyte) |i| { ... // no longer valid
[08:05:12] <strcat> yes
[08:05:26] <strcat> xeno: http://static.rust-lang.org/doc/master/tutorial-container.html#iterators
[08:05:41] <xeno> ty!
[08:08:32] <xeno> so this replaces things like ~[1,2,3].each() etc too?
[08:08:47] <xeno> (updating some old code i have from 0.6 days)
[08:09:13] <strcat> xeno: yes
[08:10:29] <strcat> xeno: http://static.rust-lang.org/doc/master/std/iter/trait.Iterator.html iterators are objects implementing this trait now
[08:10:36] <strcat> rather than functions taking closures
[08:10:46] <xeno> ~[1,2,3].each |x| { ...x  is now for x in ~[1,2,3].iter() { ...x ?
[08:11:02] <xeno> interesting
[08:11:04] <xeno> nice progress i think
[08:11:14] <strcat> rusti: let xs = [1, 2, 3]; for x in xs.iter() { println!("{}", x) }
[08:11:15] -rusti- pastebinned 10 lines of output: http://sprunge.us/jQDb
[08:11:18] <xeno> docs are starting to look great too
[08:11:24] <strcat> rusti: let xs = [1, 2, 3]; for x in xs.iter() { println!("{}", *x) }
[08:11:25] -rusti- 1
[08:11:25] -rusti- 2
[08:11:25] -rusti- 3
[08:11:26] -rusti- ()
[08:11:33] *** Joins: z0w0 (zack@moz-D62DA803.lns6.woo.bigpond.net.au)
[08:11:35] <xeno> perfect, that syntax is neat
[08:11:43] <strcat> rusti: for x in range(0, 3) { println!("{}", x) }
[08:11:44] -rusti- 0
[08:11:44] -rusti- 1
[08:11:44] -rusti- 2
[08:11:44] -rusti- ()
[08:11:47] <xeno> will the .iter eventually be abstracted away i wonder?
[08:11:53] <strcat> xeno: maybe
[08:12:02] <strcat> rusti: range(0, 10).fold(0, |a, b| a + b)
[08:12:03] -rusti- 45
[08:12:07] <strcat> rusti: range(0, 10).skip(2).fold(0, |a, b| a + b)
[08:12:07] -rusti- 44
[08:12:10] <xeno> ah i like that!
[08:12:19] <xeno> someones been working on a nicer looking lambda by the looks of it
[08:12:25] *** Joins: peterdn (chatzilla@moz-D11BA78C.as13285.net)
[08:13:08] <strcat> xeno: the issue is that vectors have many iterators, rather than just *being* an iterator like range
[08:13:09] <xeno> hehe lot has changed
[08:13:13] <strcat> and atm there's no Iterable concept
[08:13:16] <xeno> right
[08:13:20] <strcat> requires implementing for loops deeper in the compiler first
[08:13:52] <xeno> lots of work
[08:14:05] <xeno> 'The managed box syntax is being replaced by the `std::gc::Gc` and `std::rc::Rc` types. Equivalent functionality to managed trait objects will be implemented but is currently missing.' nice error
[08:14:25] <xeno> seems there is a way to use an attribute to get around that
[08:14:35] <strcat> atm 'for pattern in iter { block }' basically expands to 'let mut it = &mut iter; loop { match { Some(pattern) => { block }, None => break } }'
[08:14:40] <strcat> entirely in the parser...
[08:14:42] <strcat> so
[08:14:51] <strcat> it has weird quirks. and can't be very flexible
[08:15:08] <xeno> oh right
[08:15:10] <strcat> er
[08:15:13] <strcat> match it.next() *
[08:16:19] <xeno> https://github.com/mozilla/rust/wiki/Doc-reading-and-writing-files mentions to use IRC to find most recent way to read files
[08:16:32] <xeno> previously i had my own hacked one that returns @Reader
[08:16:53] *** Joins: nkoep (nik@moz-67D3CA1.pool.mediaways.net)
[08:17:04] <xeno> wonder if there is now a better way
[08:17:25] <dbaupp> rusti: struct Foo;impl Foo { fn next(&mut self) -> Option<~str> { if std::rand::random() { Some(~"duck typing!") } else { None } } } let mut f = Foo; for x in f { println(x) }
[08:17:26] -rusti- ()
[08:17:28] <dbaupp> rusti: struct Foo;impl Foo { fn next(&mut self) -> Option<~str> { if std::rand::random() { Some(~"duck typing!") } else { None } } } let mut f = Foo; for x in f { println(x) }
[08:17:29] -rusti- ()
[08:17:35] <dbaupp> rusti: struct Foo;impl Foo { fn next(&mut self) -> Option<~str> { if std::rand::random() { Some(~"duck typing!") } else { None } } } let mut f = Foo; for x in f { println(x) }
[08:17:36] -rusti- duck typing!
[08:17:36] -rusti- ()
[08:17:44] <strcat> xeno: there
[08:17:50] <strcat> there's a new std::io in master*
[08:18:01] <strcat> dbaupp: ;[
[08:18:14] <xeno> dux r evil
[08:18:19] <xeno> strcat: ill check it out
[08:18:21] <strcat> xeno: not very mature yet. has a quirky error handling mechanism that's probably going to go away
[08:18:36] <dbaupp> strcat: I thought conditions were partially removed?
[08:18:39] <strcat> partially.
[08:18:43] <strcat> http://static.rust-lang.org/doc/master/std/io/index.html 
[08:18:44] <strcat> dbaupp: maybe?
[08:18:48] <strcat> I'm not sure that it happened
[08:19:16] <strcat> dbaupp: https://github.com/mozilla/rust/pull/10690 needs proof reading ;p
[08:19:21] <dbaupp> oh, it's still open https://github.com/mozilla/rust/pull/10449
[08:19:30] <dbaupp> strcat: I'll get to it in a bit.
[08:19:43] * strcat chains dbaupp to the proof reading booth
[08:19:55] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[08:20:23] <Luqman> dbaupp: quick, run!
[08:20:53] <xeno> rusti: let reader = FileStream::new()
[08:20:54] -rusti- <anon>:10:4: 10:5 error: expected `;` but found `}`
[08:20:54] -rusti- <anon>:10     };
[08:20:54] -rusti-               ^
[08:20:54] -rusti- application terminated with error code 101
[08:20:58] <xeno> rusti: let reader = FileStream::new();
[08:20:59] -rusti- pastebinned 11 lines of output: http://sprunge.us/JdHB
[08:21:02] <sam113101> that guy sleeps?
[08:21:07] <dbaupp> Luqman: I just did :P (I hope the booth has a shower because I need one)
[08:21:21] <dbaupp> sam113101: nah, that's just strcat's laptop going to sleep to let it cool down
[08:21:33] <dbaupp> he's just writing code to a buffer in his head.
[08:21:48] <dbaupp> and then .write-ing it to his computer in one go later.
[08:21:55] <sam113101> oh
[08:21:56] <xeno> rusti: let reader = std::rt::io::file::FileStream::new();
[08:21:56] -rusti- <anon>:9:22: 9:56 error: unresolved name `std::rt::io::file::FileStream::new`.
[08:21:56] -rusti- <anon>:9          let reader = std::rt::io::file::FileStream::new();
[08:21:56] -rusti-                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[08:21:56] -rusti- error: aborting due to previous error
[08:21:57] -rusti- application terminated with error code 101
[08:22:06] <dbaupp> sam113101: (I'm joking :P )
[08:22:14] <sam113101> ah
[08:22:17] <xeno> oh right
[08:22:24] <xeno> you get it from file::open
[08:22:41] <dbaupp> xeno: fwiw, rusti is using 0.8, not master (assuming you're using master locally?)
[08:23:07] <xeno> ah, i just git cloned the .git
[08:23:20] <xeno> should be master right?
[08:23:23] <dbaupp> yep :)
[08:23:29] <xeno> ok sweet
[08:24:15] <xeno> hmm
[08:24:24] <dbaupp> I think it should be `std::io::File::open(name)` to open for reading, and ...::create(name) to open for writing
[08:24:32] <dbaupp> open_mode for anything more advanced
[08:24:42] <xeno> is name still `Path' or just string?
[08:25:02] <dbaupp> http://static.rust-lang.org/doc/master/std/io/fs/struct.File.html (the File struct is reexported by the std::io module, so one doesn't have to write `std::io::fs::File`.)
[08:25:06] <dbaupp> yes, path
[08:25:42] <Luqman> xeno: https://gist.github.com/7b688f0a2c2a95409da5 here's an example that just prints itself
[08:26:03] *** Quits: lfox (lfox@moz-B8648F0F.nycmny.fios.verizon.net) (Quit: ZZZzzz…)
[08:26:13] <dbaupp> Luqman: fwiw, from_utf8_owned is better
[08:26:24] <Luqman> dbaupp: ah, right!
[08:26:44] *** Quits: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) (Ping timeout)
[08:27:06] <Luqman> updated
[08:27:58] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[08:28:51] <dbaupp> (or from_utf8_slice, anything other than from_utf8 :/ )
[08:29:41] * dbaupp should probably just do the `rm from_utf8` PR he's been planning for ages.
[08:30:03] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[08:30:21] <Ms2ger> dbaupp, why's that?
[08:31:33] *** Joins: Ferreus (ferreus@moz-95543D4F.dip0.t-ipconnect.de)
[08:35:32] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[08:36:05] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[08:36:10] *** Parts: z0w0 (zack@moz-D62DA803.lns6.woo.bigpond.net.au) ()
[08:37:37] <TeXitoi> is there a clonable closure with context?
[08:38:25] <xeno> Luqman: nice, ty!
[08:39:10] <xeno> question (problem i ran into last time), is the underlying call opening the file as "rb" or just "r" (which defaults on certain platforms iirc)
[08:39:54] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[08:40:43] *** Quits: Ms2ger (Ms2ger@moz-B7007F1C.ugent.be) (Ping timeout)
[08:40:53] <dbaupp> Ms2ger: from_utf8 is &[u8] -> ~str (i.e. allocation) even though from_utf8_slice (&[u8] -> &str) and from_utf8_owned (~[u8] -> ~str) serve all purposes.
[08:40:56] <dbaupp> oh
[08:40:59] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Ping timeout)
[08:41:16] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[08:41:58] <Heather> ehm... I failed in ||
[08:42:15] <Heather> dbaupp how to write &fn in newer syntax?
[08:42:50] <dbaupp> &fn(A) -> B is |A| -> B, I think.
[08:44:07] <xeno> docs dont say if file::open is binary, to the sawce!
[08:44:20] <TeXitoi> i'd like to generalize the parallelisation in mult_Av with something as par_range_do(0, len, nb_tasks, fn): http://texitoi.eu/~texitoi/k-nucleotide/shootout-spectralnorm.rs 
[08:44:40] <TeXitoi> any idea?
[08:45:22] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[08:47:03] <Heather> dbaupp and &fn() is ?
[08:47:06] <Heather> dbaupp || ?
[08:47:12] <Heather> it was my guess
[08:47:39] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[08:47:47] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:48:01] <dbaupp> Heather: I though so
[08:48:13] <dbaupp> Heather: what's the error?
[08:48:16] <Heather> dbaupp but then when I do "do x {" I get last argument in `do` call has non-procedure type: || ->
[08:48:52] <dbaupp> Heather: that error is with `do`, not closure types
[08:49:09] <Heather> dbaupp hm... do syntax changed also?
[08:49:15] <dbaupp> do only works with the `proc` type (which is an approximate replacement for `~fn`), you have to write `x(|| ...)` now
[08:50:02] <Heather> I see....\
[08:50:07] <Heather> lots of code to change
[08:50:59] <dbaupp> TeXitoi: not particularly helping you, but http://smallcultfollowing.com/babysteps/blog/2013/06/11/data-parallelism-in-rust/ covers something like that
[08:51:06] <xeno> http://static.rust-lang.org/doc/master/std/io/enum.FileMode.html isnt Mode meant to be a bit more than that? e.g. libc stuff like O_BINARY ?
[08:51:45] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[08:52:31] <Luqman> xeno: as far as i can tell we're passing just O_RDONLY
[08:53:16] <xeno> so i need to wrap my own file reader to get binary?
[08:53:22] <xeno> (i did this last tiem)
[08:53:26] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:53:44] *** Joins: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net)
[08:53:57] <g3xzh> i have a question.
[08:54:22] <g3xzh> when using join function in Path. does it not change the Path object?
[08:54:33] <eddyb> g3xzh: it returns a new path
[08:55:09] <TeXitoi> dbaupp: thanks
[08:55:11] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:55:21] <g3xzh> I see. so for instance, let p = Path::new("/home/"); p.join("user"); p stays "/home/"
[08:55:24] <g3xzh> right?
[08:55:30] <eddyb> yupp
[08:55:37] <g3xzh> eddyb: thanks a lot!
[08:56:13] <eddyb> but right there you're not using p.join("user") (which will be the same as Path::new("/home/user"))
[08:56:34] <xeno> rusti: format!("test %s","t1");
[08:56:35] -rusti- <anon>:9:27: 9:31 error: argument never used
[08:56:35] -rusti- <anon>:9          format!("test %s","t1");
[08:56:35] -rusti-                                     ^~~~
[08:56:35] -rusti- error: aborting due to previous error
[08:56:35] -rusti- application terminated with error code 101
[08:56:42] <eddyb> xeno: {:s}
[08:56:49] <xeno> format strings changed?
[08:57:02] <eddyb> yupp, look at the master docs for std::fmt
[08:57:25] <xeno> k
[08:57:53] <Heather> dbaupp `&str` does not implement any method in scope named `split_iter :(
[08:58:04] <xeno> `grep "rationale"' heh
[08:58:21] <eddyb> xeno: http://static.rust-lang.org/doc/master/std/fmt/index.html
[08:58:32] <xeno> yah, found it
[08:58:36] <eddyb> sorry for delays, I'm compiling rust :">
[08:58:56] <eddyb> Heather: are you on master? kimundi changed that to "split"
[08:58:58] <xeno> make -j8 saved me
[08:59:12] <Heather> eddyb I'm on master ) build it everyday
[08:59:14] <eddyb> that would do nothing in this case (only LLVM)
[08:59:19] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[08:59:37] <eddyb> Heather: I'm not even sure it got in yet, that's why I'm asking
[08:59:46] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[08:59:52] <eddyb> http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html
[09:00:20] <eddyb> 0 _iter on that page :D
[09:00:29] <xeno> where did os::as_c_charp go?
[09:00:32] <dbaupp> Heather: https://github.com/mozilla/rust/pull/10622
[09:00:37] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[09:00:54] <eddyb> xeno: that looks ugly. what did it do?
[09:01:05] <dbaupp> eddyb: give you a *char from a &str
[09:01:22] <xeno> eddyb: let f = os::as_c_charp(path.to_str(), |pathbuf| {
[09:01:22] <xeno>       os::as_c_charp("rb", |modebuf|
[09:01:22] <xeno>         libc::fopen(pathbuf, modebuf)
[09:01:22] <xeno>       )
[09:01:25] <eddyb> xeno: if you're dealing with FFI, I suggest you look at recent code (maybe the FFI tutorial is updated)
[09:01:29] <xeno> ok
[09:01:31] *** Joins: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP)
[09:01:35] <dbaupp> xeno: it's now .with_c_str()
[09:01:38] *** Quits: tedh (tedh@moz-A5D1CAB7.public.wayport.net) (Ping timeout)
[09:01:39] <xeno> ah
[09:01:48] <dbaupp> rusti: "rb".with_c_str(|ptr| ptr)
[09:01:49] -rusti- (0x7f8484826058 as *())
[09:02:04] <xeno> cool
[09:02:05] <Heather> eddyb just split works
[09:02:08] <dbaupp> (but don't do that, put the logic in the closure; letting it escape will make segfaults appear.)
[09:02:14] <Heather> eddyb seems like
[09:02:48] <dbaupp> xeno: also, for path, you'll want to go straight to &[u8], since not all paths are valid strings and vice versa
[09:02:51] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[09:02:54] <eddyb> let x = (&*~"abcd").with_c_str(|ptr| ptr) as *uint; unsafe {*x}
[09:03:01] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[09:03:02] <eddyb> rusti: let x = (&*~"abcd").with_c_str(|ptr| ptr) as *uint; unsafe {*x}
[09:03:03] -rusti- <anon>:9:19: 9:27 error: type ~str cannot be dereferenced
[09:03:03] -rusti- <anon>:9          let x = (&*~"abcd").with_c_str(|ptr| ptr) as *uint; unsafe {*x}
[09:03:04] -rusti-                             ^~~~~~~~
[09:03:04] -rusti- error: aborting due to previous error
[09:03:04] -rusti- application terminated with error code 101
[09:03:17] <eddyb> meh, I wanted to make it segfault, but I don't have time for games
[09:03:27] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[09:03:37] <dbaupp> xeno: http://static.rust-lang.org/doc/master/std/path/trait.GenericPath.html#tymethod.as_vec and std::vec::raw::to_ptr() too.
[09:03:49] <dbaupp> eddyb: it's too short, so it's getting allocated on the stack
[09:04:02] <eddyb> ~str
[09:04:04] <dbaupp> eddyb: also, you're doing *~str
[09:04:04] <eddyb> ?
[09:04:11] <dbaupp> no, the with_c_str
[09:04:18] <eddyb> oh, cool :P
[09:04:19] <dbaupp> (but that's not the fundamental problem)
[09:04:32] <eddyb> I wanted to slice it, but I was silly :P
[09:04:59] <xeno> dbaupp: cool
[09:05:02] <xeno> lots to learn again
[09:05:15] <xeno> oh right
[09:05:23] <xeno> i heard something about everything being methods now
[09:05:30] <xeno> or can we still use functions?
[09:05:51] <eddyb> rusti: let x = (~"abcdfgaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa").with_c_str(|ptr| ptr) as *uint; unsafe {print!("{:?} ", *x)} let y = ~"ZZZZZZaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"; unsafe {print!("{:?} ", *x)}
[09:05:53] -rusti- pastebinned 4 lines of output: http://sprunge.us/ObWE
[09:05:53] <dbaupp> a lot of things have been converted to methods
[09:06:01] <dbaupp> eddyb: "a".repeat(n) :P
[09:06:18] <eddyb> dbaupp: doesn't work. eh, I was being silly
[09:06:54] <xeno> rusti: std::with_c_str("test", |p| { *p; }
[09:06:54] -rusti- <anon>:10:4: 10:5 error: incorrect close delimiter: `}`
[09:06:55] -rusti- <anon>:10     };
[09:06:55] -rusti-               ^
[09:06:55] -rusti- application terminated with error code 101
[09:07:03] <xeno> oops
[09:07:09] <xeno> rusti: std::with_c_str("test", |p| { *p; });
[09:07:09] -rusti- <anon>:9:9: 9:24 error: unresolved name `std::with_c_str`.
[09:07:09] -rusti- <anon>:9          std::with_c_str("test", |p| { *p; });
[09:07:10] -rusti-                   ^~~~~~~~~~~~~~~
[09:07:10] -rusti- error: aborting due to previous error
[09:07:10] -rusti- application terminated with error code 101
[09:07:18] <xeno> hmm
[09:08:16] <dbaupp> rusti: "test".with_c_str(|p| unsafe {*p})
[09:08:17] -rusti- 116i8
[09:08:32] <g3xzh> eddyb: what is the differences between join_many and join in Path?
[09:08:55] <dbaupp> g3xzh: http://static.rust-lang.org/doc/master/std/path/trait.GenericPath.html#method.join
[09:08:59] <dbaupp> and join_many below it
[09:09:10] <dbaupp> _many takes &[T] while join takes just T
[09:09:27] *** Quits: FreeFull (freefull@moz-33375531.skybroadband.com) (Quit: )
[09:09:59] <g3xzh> dbaupp: hooo.. i could not figured it out from the name. 10x mate
[09:10:49] *** Joins: Ms2ger (Ms2ger@moz-664B2345.ugent.be)
[09:11:03] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[09:11:03] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[09:12:42] <xeno> rusti: Path::new("a/b/")
[09:12:43] -rusti- <anon>:9:9: 9:18 error: unresolved name `Path::new`.
[09:12:43] -rusti- <anon>:9          Path::new("a/b/")
[09:12:43] -rusti-                   ^~~~~~~~~
[09:12:43] -rusti- error: aborting due to previous error
[09:12:43] -rusti- application terminated with error code 101
[09:12:58] <xeno> i guess you need to fully qualify the name
[09:14:02] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[09:14:07] <dbaupp> xeno: and rusti is too old for the new path library
[09:14:09] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[09:14:35] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[09:16:30] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[09:19:18] <xeno> ah
[09:20:28] <Heather> rusti: |b: |c: |d: ||||| { b( c( d() ) ) }( |||| -> ()| | -> ()| -> ()| )
[09:20:28] -rusti- <anon>:9:13: 9:14 error: expected type, found token BINOP(OR)
[09:20:28] -rusti- <anon>:9          |b: |c: |d: ||||| { b( c( d() ) ) }( |||| -> ()| | -> ()| -> ()| )
[09:20:28] -rusti-                       ^
[09:20:28] -rusti- application terminated with error code 101
[09:20:39] <Heather> ...
[09:21:21] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[09:21:42] <eddyb> Heather: uhm, what?
[09:22:18] * xeno has a feeling heather is trying to create some crazy unicode language again
[09:22:34] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[09:22:43] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[09:22:46] <Heather> eddyb I failed there somewhere...
[09:22:50] <eddyb> Heather: how is that supposed to make sense?
[09:23:03] <eddyb> you have types *to the right* of the body
[09:23:16] <eddyb> rusti: |b: |c: |d: ||||| ( |||| -> ()| | -> ()| -> ()| ){ b( c( d() ) ) }
[09:23:16] -rusti- <anon>:9:13: 9:14 error: expected type, found token BINOP(OR)
[09:23:16] -rusti- <anon>:9          |b: |c: |d: ||||| ( |||| -> ()| | -> ()| -> ()| ){ b( c( d() ) ) }
[09:23:16] -rusti-                       ^
[09:23:16] -rusti- application terminated with error code 101
[09:23:32] <eddyb> that's closer to what you want, I think, but it's still crazy
[09:23:42] <eddyb> oh, that's a call? LOL
[09:24:02] <eddyb> rusti: |b: |c: |d: ||||| { b( c( d() ) ) }
[09:24:03] -rusti- <anon>:9:13: 9:14 error: expected type, found token BINOP(OR)
[09:24:03] -rusti- <anon>:9          |b: |c: |d: ||||| { b( c( d() ) ) }
[09:24:03] -rusti-                       ^
[09:24:03] -rusti- application terminated with error code 101
[09:24:23] <eddyb> first fix that, then make a call. but I don't think your -> () are needed
[09:24:31] <Heather> I need {}
[09:24:41] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[09:25:04] <xeno> it'd be great if rust docs had links to src
[09:25:10] <eddyb> rusti: |b: |c: |d: (||)||| {}
[09:25:10] -rusti- <anon>:9:13: 9:14 error: expected type, found token BINOP(OR)
[09:25:11] -rusti- <anon>:9          |b: |c: |d: (||)||| {}
[09:25:11] -rusti-                       ^
[09:25:11] -rusti- application terminated with error code 101
[09:25:12] <xeno> impl source
[09:25:16] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[09:25:32] <eddyb> Heather: try master, maybe this craziness was fixed
[09:26:01] <eddyb> oh, right, the types weren't in 0.8, just the closure *literal* syntax
[09:26:04] <Heather> wait I can't declare |c: ||| awhile I don't know what is c
[09:26:36] <Heather> strange....
[09:26:39] <Heather> I say what type is c
[09:27:41] <xeno> where is ReaderUtil now
[09:27:47] <Heather> ah not... it's I declare them...
[09:27:57] *** Joins: SingingBoyo (brandon@DA28FB90.A5D0D593.4F048BDC.IP)
[09:28:51] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[09:28:58] *** Quits: nkoep (nik@moz-67D3CA1.pool.mediaways.net) (Ping timeout)
[09:31:37] <xeno> rusti: FILEres::new()
[09:31:39] -rusti- pastebinned 11 lines of output: http://sprunge.us/bBCZ
[09:31:39] *** Quits: Kxepal (Miranda@moz-788FED86.pppoe.mtu-net.ru) (Ping timeout)
[09:32:09] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[09:32:18] <xeno> hmm
[09:32:26] <Ms2ger> xeno, they do, no?
[09:32:43] *** jorendorff_away is now known as jorendorff
[09:32:54] <xeno> Ms2ger: not in my browser unless im missing something
[09:33:05] *** pmoore|away is now known as pmoore
[09:33:09] <Ms2ger> Next to "Enum std::io::net::ip::IpAddr" in http://static.rust-lang.org/doc/master/std/io/net/ip/enum.IpAddr.html
[09:33:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[09:33:27] <xeno> oh it must be for some sutff
[09:33:29] <xeno> stuff*
[09:34:08] <xeno> how do you access FILEres now?
[09:34:21] <xeno> libc::FILEres \ std::FILEres
[09:34:36] <xeno> http://static.rust-lang.org/doc/0.8/std/io/struct.FILERes.html
[09:34:42] <xeno> maybe std::io::FILERes
[09:34:42] *** Quits: SingingBoyo (brandon@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[09:34:51] *** Joins: Kxepal (Miranda@moz-636B9006.pppoe.mtu-net.ru)
[09:35:05] <xeno> nope
[09:35:38] *** Quits: nrc|afk (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:36:51] *** Quits: peterdn (chatzilla@moz-D11BA78C.as13285.net) (Ping timeout)
[09:39:22] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:39:33] *** Quits: derek_c (derek@moz-E72F174.cit.cornell.edu) (Quit: Leaving)
[09:39:48] *** Quits: xeno (~0@moz-A0CF1F9B.lns20.mel4.internode.on.net) (Quit: Lost terminal)
[09:40:14] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[09:43:32] *** Joins: nkoep (nik@moz-2DF7B772.vpn.rwth-aachen.de)
[09:44:49] *** Joins: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au)
[09:46:19] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[09:48:14] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[09:50:52] <Heather> dbaupp eddyb : why is it fails: ((|x:|xx:||||{x(||{()})})(|xx:|||{()}))(||{()})
[09:51:04] <Heather> it says expected function but found ()
[09:52:25] <eddyb> Heather: all the parameters to your closures are closures that return (). I guess you're calling the result of x(...) or xx(...) somewhere
[09:53:13] <Ms2ger> That's very readable
[09:53:20] <Heather> eddyb this works : ((|x:|xx:||||{x(||{()})})(|xx:|||{(xx())}))
[09:53:31] <Heather> but how can I use this xx here?
[09:53:33] <eddyb> I have no idea what you have there
[09:53:42] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:53:45] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:53:54] <eddyb> make a gist and use indentation
[09:54:35] *** Quits: Tari (tari@moz-1713FB27.mtu.edu) (Ping timeout)
[09:55:06] <Heather> ah
[09:55:08] <Heather> I get it
[09:55:19] <Heather> I already used to call xx in first ()
[09:55:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:57:56] *** Joins: Tari (tari@moz-1713FB27.mtu.edu)
[09:58:10] <Heather> eddyb : https://gist.github.com/Heather/7673288
[09:59:09] <Heather> eddyb now it should be readable
[10:00:01] <Ms2ger> Somewhat :)
[10:01:43] <eddyb> working on that
[10:02:07] <Heather> ... but inline syntax of that looks more fancy
[10:02:31] <eddyb> rusti: ||()
[10:02:32] -rusti- fn()
[10:02:35] <eddyb> rusti: ||{}
[10:02:36] -rusti- fn()
[10:05:15] <eddyb> I tried: https://gist.github.com/eddyb/7673295
[10:05:46] <Heather> more nested
[10:05:48] <Heather> eddyb ((|x:|xx:|xxx:|||||{x(|xxx:|||{(xxx())})})(|xx:|xxx: ||||{(xx(||{()}))}));
[10:06:14] <eddyb> fuck that, I work to do :P
[10:06:35] <Heather> updated gist https://gist.github.com/Heather/7673288
[10:07:20] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[10:07:42] <Heather> eddyb with that I just added one nested level
[10:07:44] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[10:08:07] <eddyb> *I've got
[10:09:11] *** Quits: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:10:06] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[10:15:46] *** Joins: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP)
[10:18:40] *** Quits: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[10:22:54] *** Joins: tulloch_ (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[10:25:27] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[10:27:06] <dbaupp> Ms2ger: btw, you left just as I answered your from_utf8 question: https://botbot.me/mozilla/rust/msg/8215644/
[10:27:32] *** Quits: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net) (Ping timeout)
[10:28:49] *** Joins: moostik (Icedove@6181009C.10715965.BCDF592F.IP)
[10:28:59] *** Joins: tedh (tedh@moz-A5D1CAB7.public.wayport.net)
[10:29:12] <Ms2ger> dbaupp, I see
[10:35:39] *** kimundi is now known as zz_kimundi
[10:40:57] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[10:43:50] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[10:43:50] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Connection reset by peer)
[10:44:12] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[10:45:32] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[10:45:56] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:46:09] *** Joins: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net)
[10:47:11] *** Joins: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au)
[10:49:09] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[10:54:06] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:54:49] *** Quits: moostik (Icedove@6181009C.10715965.BCDF592F.IP) (Ping timeout)
[10:55:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[10:58:16] *** Quits: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net) (Ping timeout)
[10:59:26] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[11:02:27] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[11:03:32] *** Quits: tulloch_ (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[11:03:46] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[11:04:33] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[11:04:40] *** Joins: tulloch_ (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[11:06:19] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[11:07:54] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Quit: Lost terminal)
[11:08:03] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:15:01] *** Quits: Ms2ger (Ms2ger@moz-664B2345.ugent.be) (Ping timeout)
[11:16:11] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[11:16:54] *** zz_kimundi is now known as kimundi
[11:19:14] *** Joins: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au)
[11:21:35] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[11:24:36] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[11:26:49] *** Joins: q66__ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[11:27:45] *** Joins: moostik (Icedove@moz-C2FFB694.w82-121.abo.wanadoo.fr)
[11:27:50] *** Quits: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[11:30:43] *** kimundi is now known as zz_kimundi
[11:31:43] *** zz_kimundi is now known as kimundi
[11:37:39] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[11:37:52] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[11:38:54] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[11:42:37] <tiffany> it's annoying that when I go to work on my language, I can't because of rust compiler bugs
[11:43:01] <dbaupp> tiffany: are they filed? :)
[11:43:06] <tiffany> I'm not sure
[11:43:29] <tiffany> I think the one about not being able to put functions taking & parameters inside of a Clone-deriving type
[11:43:34] <tiffany> is
[11:43:56] <tiffany> I don't know if the one where rustc stack overflows because of some sort of infinite recursion when I tried to work around that
[11:44:10] <Heather> )
[11:44:21] <Heather> tiffany your language?
[11:44:49] <tiffany> I'm developing a concatenative scripting language with a proper type system: https://github.com/tiffany352/frscript
[11:45:14] *** Joins: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de)
[11:45:38] <tiffany> I suppose I should update the readme
[11:45:39] <dbaupp> tiffany: is that code showing the infinite recursion?
[11:45:57] <tiffany> no, there's some changes to parse.rs that I'll put on gist
[11:46:16] <tiffany> https://gist.github.com/tiffany352/7674410
[11:46:31] <tiffany> to build, run rustpkg build frsi
[11:46:41] <tiffany> or rustc src/frscript/lib.rs
[11:46:51] <tiffany> rustpkg apparently abort()s when rustc segfaults
[11:47:02] <Heather> tiffany is there examples ) at least non-compiling and theoretical?
[11:47:27] <tiffany> there are working examples of the language, but it is not complete
[11:47:49] <tiffany> = 4 4 + 4 + 4 "hi" true false typeof "a" "b" typeeq
[11:47:49] <tiffany> [12, 4, "hi", true, "bool", true]
[11:48:00] <tiffany> there's no control flow, functions, macros, etc.
[11:48:37] <tiffany> functions (more specifically, adding custom matching rules so I could write rules for doing whitespace-based indentation) are what I was working on before I got into compiler woes
[11:48:52] <tiffany> er, whitespace-based blocks like python
[11:49:27] <Heather> tiffany I need more complete examples :S
[11:49:42] <tiffany> of the language?
[11:49:48] <Heather> tiffany yes
[11:50:02] <tiffany> that expression demonstrates the entire language as it currently exists, I could paste my syntax scratch pad though
[11:50:18] <Heather> okay.
[11:50:44] <tiffany> https://gist.github.com/tiffany352/7674449
[11:51:38] <Heather> if true:  4  5
[11:51:39] <Heather> )))
[11:52:42] <Heather> looks a bit strange
[11:52:42] <tiffany> I haven't really worked out if statements yet
[11:52:56] <dbaupp> tiffany: I don't have time to check properly, but the abort maybe be because there is a recursive generic function where the generic is getting instanciated with a type containing itself, i.e. maybe Nonterminal<T>.parse accidentally gets called with Nonterminal<Parse<T>>.parse (and so that would call Nonterminal<Parse<Parse<T>>>.parse) which would require an infinite number of monomorphised instances, which the compiler doesn't
[11:52:56] <dbaupp> check very well, and just recurs
[11:53:13] <tiffany> dbaupp: that's why, I think
[11:53:29] <tiffany> I don't really know what to do though
[11:53:41] <dbaupp> check all your .parse calls?
[11:53:51] <dbaupp> wait, do you know which one?
[11:54:01] <dbaupp> (and if so, does it need to be doing that?)
[11:54:03] <tiffany> the problem is in the first 20 lines
[11:54:21] <tiffany> I'm trying to make a clonable trait object which has a .parse() method
[11:54:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[11:54:32] <tiffany> the problem is making it clonable, which is what all that other stuff is for
[11:54:59] <tiffany> I've had help from people here before and we never really worked out anything, this is like the 8th incarnation or something
[11:55:07] <dbaupp> oh L(
[11:55:12] <dbaupp> * :(
[11:56:11] <tiffany> I'm not really sure how else I can work around it, I'm not sure even @mut would work
[11:56:15] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[11:56:36] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131122094025])
[11:57:40] <dbaupp> if I just copy the first 20 lines and the required structs it works
[11:57:50] <dbaupp> although I need to add 'static + Send to https://gist.github.com/tiffany352/7674410#file-parse-rs-L8
[11:57:51] <tiffany> huh
[11:58:36] <dbaupp> what version/hash are you using?
[11:58:51] <tiffany> 3a7337f 2013-10-18 19:36:22 -0700
[11:58:56] <tiffany> should I update?
[11:59:15] <tiffany> er, I suppose I should
[11:59:37] <dbaupp> does https://gist.github.com/huonw/130cb531fb4567e35d81 crash with that compiler?
[11:59:45] <dbaupp> (and yeah, that's pretty old)
[12:00:43] <dbaupp> tiffany: I'd guess niko's lifetime (etc) work may've helped.
[12:00:46] * dbaupp shrugs
[12:01:12] <tiffany> it says main function not found
[12:01:18] <dbaupp> oh rustc --lib
[12:01:31] <tiffany> it compiled
[12:01:34] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[12:01:42] <dbaupp> ah, updating may not help then.
[12:02:00] <tiffany> worth trying anyway at least
[12:02:10] <dbaupp> certainly
[12:03:33] <dbaupp> welp
[12:03:43] <dbaupp> I see the stack overflow just copying the whole file.
[12:04:06] <tiffany> ah
[12:04:12] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[12:05:07] <dbaupp> infinite recursion in middle::ty::each_bound_trait_and_supertraits::h974e774ca09b65d3az::v0.9$x2dpre
[12:05:47] <tiffany> so the problem has something to do with the impl at the bottom of the file?
[12:05:51] <dbaupp> commenting out the Nonterminal impl stops the crash, yeah
[12:07:44] <dbaupp> and replacing the body of .parse with just fail!() makes it crash too
[12:07:59] <dbaupp> tiffany: so it looks like the generic bounds are making it sad :(
[12:08:02] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:08:17] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[12:08:44] <tiffany> I think I see the problem
[12:09:48] <tiffany> acually nevermind
[12:09:48] <tiffany> I thought I forgot to wrap T in Token<T> in some place
[12:12:03] *** Joins: Ms2ger (Ms2ger@moz-893FDDF0.ugent.be)
[12:13:10] <dbaupp> I have a feeling it's this problem
[12:13:43] <dbaupp> rusti: trait A: A {}
[12:13:44] -rusti- Segmentation fault
[12:13:44] -rusti- application terminated with error code 139
[12:14:13] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[12:15:07] <dbaupp> tiffany: minimal example, https://gist.github.com/huonw/3b5e73c6f7f5042f79e3
[12:15:33] *** jorendorff is now known as jorendorff_away
[12:15:58] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[12:16:40] <dbaupp> tiffany: https://github.com/mozilla/rust/issues/9095
[12:19:44] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[12:19:54] <tiffany> hm
[12:20:10] *** Joins: Jackneill (Jackneill@moz-EDEDAFD9.pool.digikabel.hu)
[12:20:13] <tiffany> I hope the issue of fn(&x) not being clonable gets fixed
[12:20:40] *** Joins: peterdn (chatzilla@moz-6C268C7F.as13285.net)
[12:20:40] <dbaupp> ah!
[12:20:49] <dbaupp> I think I may've got something that works
[12:21:42] <dbaupp> remove the CloneParser trait entirely, and have clone_as_parser as a default method: https://gist.github.com/huonw/4f5c1f262fc5a53d1422
[12:21:55] <tiffany> I think that's been tried but I'll do that
[12:22:18] <dbaupp> well, it certainly stops the stack overflow :)
[12:22:47] <tiffany> /home/tiffany/Projects/frscript/src/frscript/parse.rs:11:11: 11:16 error: cannot call a method whose type contains a self-type through an object
[12:22:47] <tiffany> /home/tiffany/Projects/frscript/src/frscript/parse.rs:11 #[deriving(Clone)]
[12:23:54] <eddyb> you want to call .clone on ~Clone or &Clone?
[12:23:55] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[12:24:14] <dbaupp> that seems like a bug
[12:24:23] <dbaupp> since Self isn't mentioned :/
[12:24:30] <eddyb> I fixed this problem a week ago, I think, for someone else, by creating another trait
[12:25:00] <tiffany> you were the one that made the CloneParser stuff?
[12:25:09] <dbaupp> waait wait wait what?
[12:25:20] <dbaupp> where is that calling a method with Self?
[12:25:24] <eddyb> tiffany: maybe it was you. I have a bad memory
[12:25:31] <tiffany> it never was fixed
[12:25:46] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Input/output error)
[12:26:27] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:26:36] <eddyb> one problem I found was that calling clone on ~Trait will first try to call Clone<for T>::clone and then Clone<for ~Trait>::clone
[12:26:55] <eddyb> the solution for that was to remove Clone from Trait
[12:27:19] <dbaupp> except that then breaks other things
[12:27:54] <eddyb> I had another trait, CloneAsParser or something, and impl<T: Clone> CloneAsParser for T with dbaupp's clone_as_parser method
[12:28:29] <eddyb> and then Parser<T>: CloneAsParser + Send instead of Clone + Send
[12:28:44] <eddyb> dbaupp: did it complain about a recursive definition?
[12:29:10] <eddyb> I think that might have been the last I heard from tiffany
[12:29:16] * eddyb is remembering slowly
[12:29:24] <dbaupp> eddyb: no, it crashed
[12:29:47] <dbaupp> eddyb: we were looking at exactly your code, which makes rustc infinitely recur
[12:29:47] <tiffany> there was a stack overflow in rustc
[12:29:56] <dbaupp> eddyb: due to https://github.com/mozilla/rust/issues/9095
[12:30:12] <dbaupp> eddyb: code in question: https://gist.github.com/tiffany352/7674410
[12:31:41] <eddyb> oooh, because you need the bound
[12:31:51] <eddyb> well, shit
[12:31:55] <dbaupp> https://github.com/mozilla/rust/issues/10692
[12:32:17] <eddyb> wait, it's easy :D
[12:32:53] <eddyb> wait, it's not. ffs
[12:32:58] <dbaupp> hah
[12:33:07] * dbaupp takes the easy route and goes to bed
[12:33:15] <eddyb> I started writing this and it didn't make sense: impl<T: CloneParser<T>> Clone for ~Parser<T> {
[12:33:25] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[12:34:05] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[12:34:49] <dbaupp> tiffany: if #10692 I guess the default methods should work, and if #9095 is fixed then your original code should work... (yay bugs! :/ )
[12:35:20] <eddyb> and by original you mean my fifth attempt at it? :)))
[12:35:29] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:36:14] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[12:37:00] <tiffany> that wasn't my original
[12:37:03] <dbaupp> original to this discussion :P
[12:37:04] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[12:37:11] <tiffany> my original didn't fuss with trait objects at all
[12:37:25] <tiffany> it was an ~extern fn(&mut ParseContext<'self, T>, &str, uint)
[12:37:46] <tiffany> I think I will stick with trait objects though
[12:38:04] <tiffany> unless that gets fixed first
[12:39:11] <dbaupp> and the problem with that was it wasn't clonable?
[12:40:11] *** Quits: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP) (Quit: Computer has gone to sleep.)
[12:40:14] <tiffany> ah
[12:40:16] <tiffany> yeah*
[12:40:50] <dbaupp> I thought extern fn was clonable?
[12:40:57] <tiffany> not when it has an & parameter
[12:40:59] <dbaupp> rusti: fn foo() {} foo.clone()
[12:41:00] -rusti- fn()
[12:41:07] <dbaupp> oh, really?
[12:41:16] <tiffany> rusti: fn foo(x: &int) {} foo.clone()
[12:41:17] -rusti- <anon>:9:16: 9:17 warning: unused variable: `x` [-W unused-variable (default)]
[12:41:17] -rusti- <anon>:9          fn foo(x: &int) {} foo.clone()
[12:41:17] -rusti-                          ^
[12:41:17] -rusti- fn(&int)
[12:41:23] <tiffany> uh
[12:41:34] <dbaupp> maybe lifetimes?
[12:42:33] <tiffany> rusti: #[deriving(Clone)] struct X {foo: extern fn(x: &int);}; fn foo(_: &int) {}; let x = X {foo: foo}; x.clone()
[12:42:35] -rusti- pastebinned 6 lines of output: http://sprunge.us/KCCc
[12:42:45] <tiffany> rusti: #[deriving(Clone)] struct X {foo: extern fn(x: &int)}; fn foo(_: &int) {}; let x = X {foo: foo}; x.clone()
[12:42:46] -rusti- <anon>:9:106: 10:5 error: type `main::X` does not implement any method in scope named `clone`
[12:42:46] -rusti- <anon>:9          #[deriving(Clone)] struct X {foo: extern fn(x: &int)}; fn foo(_: &int) {}; let x = X {foo: foo}; x.clone()
[12:42:46] -rusti- <anon>:10     };
[12:42:46] -rusti- error: aborting due to previous error
[12:42:46] -rusti- application terminated with error code 101
[12:42:56] <dbaupp> that's a different issue
[12:43:05] <tiffany> I don't know how to reproduce it
[12:43:08] <tiffany> but it wouldn't work
[12:43:22] <dbaupp> rusti: mod bar { #[deriving(Clone)] struct X {foo: extern fn(x: &int)} }  fn foo(_: &int) {}; let x = bar::X {foo: foo}; x.clone()
[12:43:23] -rusti- <anon>:9:104: 9:110 error: `bar::X` does not name a structure
[12:43:23] -rusti- <anon>:9          mod bar { #[deriving(Clone)] struct X {foo: extern fn(x: &int)} }  fn foo(_: &int) {}; let x = bar::X {foo: foo}; x.clone()
[12:43:23] -rusti-                                                                                                                  ^~~~~~
[12:43:23] -rusti- error: aborting due to previous error
[12:43:23] -rusti- application terminated with error code 101
[12:43:32] <dbaupp> rusti: mod bar { #[deriving(Clone)] pub struct X {foo: extern fn(x: &int)} }  fn foo(_: &int) {}; let x = bar::X {foo: foo}; x.clone()
[12:43:33] -rusti- pastebinned 6 lines of output: http://sprunge.us/VWKQ
[12:43:44] <dbaupp> there^ ?
[12:43:54] <tiffany> yeah
[12:44:54] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[12:46:12] <tiffany> is there an issue for that?
[12:46:28] <tiffany> I vaguely remember there being one
[12:49:35] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[12:49:53] *** Quits: Sgeo (quassel@moz-D0F30617.dyn.optonline.net) (Connection reset by peer)
[12:50:38] *** Joins: abinader (abinader@D8B9C081.E820043D.D4C04133.IP)
[12:52:24] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Quit: Savago)
[12:53:07] *** Quits: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de) (Quit: mye)
[12:54:47] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[12:55:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[12:55:20] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: lenstr)
[12:55:40] *** Joins: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de)
[12:56:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[12:56:36] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[12:57:07] *** Quits: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) (Quit: ~ Trillian - www.trillian.im ~)
[12:57:52] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[12:58:55] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Input/output error)
[12:59:28] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[13:03:30] *** jorendorff_away is now known as jorendorff
[13:04:23] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[13:04:52] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[13:05:28] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[13:05:51] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[13:06:28] *** Joins: Florob (Florob@moz-39532932.de)
[13:06:58] *** jorendorff is now known as jorendorff_away
[13:07:23] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[13:07:47] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[13:08:23] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[13:12:35] *** Quits: tulloch_ (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:13:13] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Input/output error)
[13:13:28] *** Quits: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com) (Input/output error)
[13:13:28] *** Quits: gazoombo (sid6629@moz-E77DEB21.irccloud.com) (Input/output error)
[13:13:45] *** Quits: robert (uid15951@moz-A42E5B7B.irccloud.com) (Input/output error)
[13:13:45] *** Quits: balpert_ (uid15886@moz-A42E5B7B.irccloud.com) (Input/output error)
[13:14:03] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Client exited)
[13:14:03] *** Quits: etrepum (sid763@moz-5F4AA75A.irccloud.com) (Input/output error)
[13:14:03] *** Quits: posco (sid14832@moz-5F4AA75A.irccloud.com) (Input/output error)
[13:14:03] *** Quits: wilfred (sid159@moz-5F4AA75A.irccloud.com) (Broken pipe)
[13:14:03] *** Quits: wycats_ (sid79@moz-5F4AA75A.irccloud.com) (Client exited)
[13:14:03] *** Quits: hongminhee (sid295@moz-5F4AA75A.irccloud.com) (Input/output error)
[13:14:10] *** Quits: abinader (abinader@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[13:14:31] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:15:17] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[13:17:03] *** Joins: wycats_ (sid79@moz-5F4AA75A.irccloud.com)
[13:17:08] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Quit: Leaving)
[13:17:28] *** Joins: wilfred (sid159@moz-5F4AA75A.irccloud.com)
[13:18:00] *** Joins: abinader (abinader@496D17B0.2513D022.AD91B79.IP)
[13:18:09] *** Joins: hongminhee (sid295@moz-5F4AA75A.irccloud.com)
[13:19:33] *** Joins: balpert_ (sid15886@moz-A42E5B7B.irccloud.com)
[13:20:12] *** Joins: robert (uid15951@moz-A42E5B7B.irccloud.com)
[13:20:31] *** Joins: etrepum (sid763@moz-5F4AA75A.irccloud.com)
[13:26:50] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[13:26:59] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[13:33:45] *** Joins: gazoombo (sid6629@moz-E77DEB21.irccloud.com)
[13:36:05] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[13:36:47] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[13:37:41] *** Joins: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com)
[13:38:51] *** Parts: octokitten (dieselpowe@C6DD4BDC.F7C4012D.1A3E6EBE.IP) ()
[13:41:31] *** Quits: Ms2ger (Ms2ger@moz-893FDDF0.ugent.be) (Quit: bbl)
[13:46:09] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[13:46:26] *** Joins: posco (sid14832@moz-5F4AA75A.irccloud.com)
[13:47:42] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[13:54:23] *** Quits: apoelstra (username@moz-C92A9641.sw.biz.rr.com) (Ping timeout)
[13:55:31] *** Joins: morton (Mibbit@moz-3213C615.wavecable.com)
[13:56:14] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[13:57:40] *** Quits: ssbr_ (~ssbr@46FE74EC.C60FE7DC.4065847B.IP) (Ping timeout)
[13:58:05] <morton> There's no simple way to evaluate a string, is there?
[13:59:10] <eddyb> as in the eval("...") found in script languages?
[14:00:05] <morton> Yeah. Seems like with compiled languages you'd basically have to rewrite the lexer to do such a thing.
[14:00:40] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[14:00:51] *** Joins: ssbr_ (~ssbr@46FE74EC.C60FE7DC.4065847B.IP)
[14:02:46] <eddyb> morton: nope. you want some kind of JIT
[14:02:57] <eddyb> (if the code is truly dynamic)
[14:03:22] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[14:03:23] *** Joins: lfox (lfox@moz-B8648F0F.nycmny.fios.verizon.net)
[14:08:41] *** Quits: bjz (bjz@moz-6AF19015.lnse4.cha.bigpond.net.au) (Ping timeout)
[14:08:43] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[14:12:52] *** Joins: bjz (bjz@moz-DD4A2A91.lnse2.cha.bigpond.net.au)
[14:17:58] <bstrie> rusti: "ë".len()
[14:17:58] -rusti- 3u
[14:18:09] <bstrie> ^ I could understand either 2 or 1, but 3??
[14:18:28] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[14:18:41] <bstrie> wondering if anyone can explain this
[14:18:44] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[14:18:47] <eddyb> rusti: ("ë".len(), "ë".char_len())
[14:18:48] -rusti- (3u, 2u)
[14:18:53] <eddyb> there
[14:18:56] <bstrie> what's the difference?
[14:19:04] <ChrisMorgan> len() is UTF-8 bytes
[14:19:06] <eddyb> you have two code pointers :P
[14:19:06] <bstrie> I still don't get where 3 comes from, in any capacity
[14:19:11] <bstrie> right, it should be two code points
[14:19:11] <eddyb> *code points
[14:19:18] <bstrie> e and the diaresis
[14:19:22] <eddyb> one of the code points requires two bytes
[14:19:36] <bstrie> aha
[14:19:43] <ChrisMorgan> It's "e\u0308". UTF-8 encoded, that's "e\xcc\x88".
[14:19:58] <bstrie> please rename len() to byte_len() :)
[14:20:11] <eddyb> rusti: "ë".len()
[14:20:11] -rusti- 2u
[14:20:24] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[14:20:27] <eddyb> rusti: ("ë".len(), "ë".char_len())
[14:20:28] -rusti- (2u, 1u)
[14:20:38] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[14:20:39] <eddyb> bstrie: char_len is O(N), while len is O(1)
[14:20:41] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[14:20:59] <bstrie> eddyb: it's still a poor name
[14:21:30] <eddyb> a lot of things still work when using a byte length
[14:21:32] <bstrie> is there a grapheme_len or rune_len?
[14:21:46] <eddyb> those would be interesting to see, but they're not there yet
[14:21:59] <bstrie> do we need to link against libicu for that?
[14:22:00] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:22:02] <eddyb> (unless there's a PR for them that landed recently, but I doubt that)
[14:22:06] <bstrie> or could we do it ourselves
[14:22:11] <bstrie> something something normalization
[14:22:15] <eddyb> hehe
[14:22:18] <ChrisMorgan> That's what char_len *is*, isn't it?
[14:22:33] <Florob> no. char_len() is strictly number of codepoints
[14:22:38] <bstrie> 09:18 < bstrie> ^ I could understand either 2 or 1, but 3??
[14:22:43] <bstrie> ugh
[14:22:45] <bstrie> this copypaste
[14:23:19] <bstrie> ChrisMorgan: "ë" and "ë" would have the same grapheme len of 1
[14:23:27] <bstrie> post-normalization
[14:23:48] * ChrisMorgan is getting himself tangled in which way round the terminology is again.
[14:23:48] <tiffany> is it just me or does "ë have this weird thing going on with the second "?
[14:23:54] * ChrisMorgan needs to go to bed
[14:23:56] <tiffany> man hexchat is handling that wonky
[14:24:00] <Florob> bstrie, why post-normalization? It's always one grapheme, no matter if it's NFD or NFC
[14:24:14] <ChrisMorgan> tiffany: probably a bad client/text renderer
[14:24:14] <bstrie> Florob: ugh, don't presume that I'm an expert here :)
[14:24:23] <ChrisMorgan> bstrie: the problem with changing len() is that it's in the impl Container for ~str. I feel that it might be better with these things *not* implemented on ~str, but with the user forced to decide whether they care about characters or bytes.
[14:24:33] <eddyb> bstrie: the "something something" gives you away :P
[14:25:00] * ChrisMorgan gives up and goes to bed
[14:25:15] <tiffany> it'd be nice if you could have multiple impls of a trait for different interpretations
[14:25:15] <eddyb> ChrisMorgan: well, it's probably easier to use .is_empty, ==, iterators, anyway
[14:25:30] <bstrie> ChrisMorgan: I'm not sure what Container is, but my argument is that there's no such thing as "length" on unicode strings (let alone UTF-8 strings), so we shouldn't presume as such
[14:25:38] <benh> 15:20 < bstrie> please rename len() to byte_len() :) <- https://github.com/mozilla/rust/issues/10044
[14:25:52] <eddyb> impl Container<char> for ~str and impl Container<u8> for ~str, tiffany?
[14:26:13] <tiffany> uhh
[14:26:14] <ChrisMorgan> tiffany: .as_bytes(), .as_chars() (not that it can be converted to ~[char] efficiently, this might cheat), etc.
[14:26:25] <eddyb> tiffany: just one impl idea for what you said
[14:26:32] <tiffany> I never thought about it that way
[14:26:37] <benh> In any case we don't seem to do well re: that baffling christmas/cat themed blog post 
[14:26:56] <ChrisMorgan> benh: far better than most
[14:27:12] * ChrisMorgan waits for str.len::<char>() and str.len::<u8>() :P
[14:27:16] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:27:26] <bstrie> ChrisMorgan: btw, as my go-to web person, how soon until you have a BeautifulSoup clone written in rust :)
[14:27:29] * eddyb waits for ::<> => <>
[14:28:01] <benh> rusti: "😸😾".char_len()
[14:28:02] -rusti- 2u
[14:28:20] <ChrisMorgan> bstrie: no plans. BeautifulSoup won't port directly to Rust (it uses __getattr__ things and so forth), it'll be a somewhat different model which is needed.
[14:28:33] <benh> rusti: let s: ~str = "😸😾".rev_iter.collect(); s
[14:28:33] -rusti- <anon>:9:23: 9:34 error: attempted to take value of method `rev_iter` on type `&'static str` (try writing an anonymous function)
[14:28:33] -rusti- <anon>:9          let s: ~str = "😸😾".rev_iter.collect(); s
[14:28:34] -rusti-                                 ^~~~~~~~~~~
[14:28:34] -rusti- error: aborting due to previous error
[14:28:34] -rusti- application terminated with error code 101
[14:28:37] <benh> rusti: let s: ~str = "😸😾".rev_iter().collect(); s
[14:28:38] -rusti- ~"\U0001f63e\U0001f638"
[14:28:55] <benh> close enough
[14:29:04] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:29:13] <benh> ChrisMorgan: we fail all the noel bits though :(
[14:29:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:29:29] <eddyb> which blog post?
[14:29:34] <benh> http://mortoray.com/2013/11/27/the-string-type-is-broken/
[14:29:41] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[14:29:46] <benh> and we plain don't support upcasing strings, right?
[14:29:58] <Florob> rusti: "ëa".rev_iter().collect::<~str>()
[14:29:59] -rusti- ~"a\u0308e"
[14:30:22] <benh> :(
[14:30:38] <ChrisMorgan> benh: yes, we're completely honest about that.
[14:30:56] * ChrisMorgan is *really* going to bed
[14:30:56] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[14:31:13] <sbalmos> :/
[14:31:18] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[14:31:37] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:31:58] <bstrie> benh: we fail those bits because by default we iterate over code points
[14:32:54] <Florob> Rust is (IMHO) doing great on this front though. Not because the implementation is correct, but because people care about this and there are issues for most of this things in the tracker
[14:34:00] <bstrie> benh: because right now we completely lack the ability to iterate over graphemes :)
[14:37:56] <Florob> BTW, I reject that blog post purely on the basis that he confused UCS-2 with UTF-16
[14:40:16] <sp3d> I hate it when people do that
[14:41:06] *** Joins: FreeFull (freefull@moz-33375531.skybroadband.com)
[14:42:30] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[14:43:50] *** Quits: Zor (zor@moz-180BED6.rfw.name) (Ping timeout)
[14:43:54] *** Joins: Zor (zor@moz-180BED6.rfw.name)
[14:44:13] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[14:46:29] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[14:47:18] *** Quits: lerc (quassel@moz-2A8CFEEE.telstraclear.net) (Ping timeout)
[14:48:22] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[14:48:39] <eddyb> I hate all these rebuilds >_<
[14:48:47] <eddyb> all I did was sync with parent/master
[14:48:52] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[14:49:09] <bstrie> eddyb: rebuilds of what?
[14:49:29] <eddyb> bstrie: libstd which results in libextra and librustuv to be rebuilt as well
[14:56:52] *** Joins: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com)
[15:00:58] *** Quits: heftig (heftig@moz-211D849C.dip0.t-ipconnect.de) (Quit: Quitting)
[15:01:37] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[15:04:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[15:05:40] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[15:11:16] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Client exited)
[15:15:57] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Ping timeout)
[15:16:45] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[15:17:20] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[15:19:33] *** Joins: ahal (ahal@moz-7DE89BF0.cable.teksavvy.com)
[15:20:20] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:21:50] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[15:23:53] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:24:02] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[15:24:42] *** Quits: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com) (Connection reset by peer)
[15:25:27] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: Lost terminal)
[15:26:05] *** Joins: Blei (philipp@moz-E5A7DC90.cust.bluewin.ch)
[15:26:41] *** Quits: morton (Mibbit@moz-3213C615.wavecable.com) (Quit: http://www.mibbit.com ajax IRC Client)
[15:26:42] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[15:28:16] *** Joins: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org)
[15:28:21] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[15:28:53] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[15:31:52] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[15:31:57] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:34:15] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[15:38:15] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[15:39:02] <kimundi> bstrie: Fwiw, I had the idea to make str not provide things like len() etc, but provide different 'view's on a strings. One for viewing a string as a sequence of bytes, one for viewing it as a sequence of codepoints, and one for viewing it as a sequence of grapheme clusters
[15:39:27] <kimundi> I'm explicitly _not tlaking about returning a [u8], [char] or [glyph] here
[15:39:32] <bstrie> kimundi: isn't that just a different take on normalization?
[15:39:47] <bstrie> where one of your normalization forms is "utf-8 bytes"? :)
[15:39:52] <kimundi> bstrie: No, that has nothig to do with it
[15:40:21] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[15:40:45] <kimundi> I'm talking about, insetead of "foo".len() and "foo".char_len(), have "foo".byte_view().len() and "foo".char_view().len() 
[15:40:50] <bstrie> kimundi: so basically you would have `let s = "asdf"; s.as_chars().len(); s.as_glyphs().len()"?
[15:41:10] <kimundi> That is, return newtype wrappers around the string that implement the methods that
[15:41:20] <kimundi> yeah
[15:41:34] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[15:42:01] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[15:42:32] <bstrie> kimundi: so you're saying that the *only* methods that str would implement would be byte_view, char_view, and rune_view? and then all the rest of the API would be defined for each of these, e.g. .len(), .iter(), .find()?
[15:43:11] <bstrie> I could probably get behind that
[15:43:11] <kimundi> Depends on the APIs, but everything that would behave differently for those, yeah
[15:43:33] <kimundi> I mean, a lot can be solved without a hard shift
[15:43:45] <bstrie> either you just keep your string as a string everywhere and "view" it as necessary at each invocation site, or you just get rid of the idea of the string and carry the view around with you everywhere
[15:44:05] <kimundi> In currrent master, there is no more iter(), only chars() that returns a charIterator, and bytes() That returns a Byteterator for example
[15:44:05] <bstrie> so it really doesn't add anything more onerous, and makes it explicit *somewhere*, at least
[15:44:17] <bstrie> yeah, I like this
[15:44:20] <bstrie> what issue number is it
[15:44:29] <kimundi> bstrie: Right, and you can switch between everview costless
[15:44:48] <kimundi> The idea with the views has no issue number till now :P
[15:44:51] <benh> </t></t></t>
[15:44:59] <benh> Disqus is not fond of discussing generics
[15:45:04] <kimundi> haha
[15:45:07] <bstrie> disqus is fuckin terrible at code
[15:45:21] <bstrie> wish it was just markdown
[15:45:22] <kimundi> which discussion?
[15:45:51] <Blei> all of them (assuming niko's blog?)
[15:46:10] <kimundi> Was ther a new blog post in the last ~24h ?
[15:46:10] <benh> I posted a comment to thoughts-on-dst-2 because as usual I don't quite get it ;)
[15:46:17] <benh> yes
[15:46:27] <kimundi> Then I want a link to that pls :)
[15:46:33] <benh> http://smallcultfollowing.com/babysteps/blog/2013/11/26/thoughts-on-dst-1/
[15:46:53] <benh> also http://smallcultfollowing.com/babysteps/blog/2013/11/27/thoughts-on-dst-2/
[15:46:55] <bstrie> isn't octopress supposed to be a blogging engine *for coders*? it's GOT to have a better commenting system as a plugin
[15:47:22] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Ping timeout)
[15:48:53] <benh> bstrie: But see it's helpfully closing <t> tags for me! What more could a coder want :D
[15:49:11] <benh> wow disqus is givin realtime notifications that someone is writing a comment
[15:49:13] * bstrie vomits in his mouth a little
[15:49:45] <Florob> Also #include <stdio.h> … </stdio.h>
[15:50:37] <bstrie> I am amused by the new php.net docs
[15:51:00] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:51:37] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[15:51:45] <bstrie> like, for example, how clicking on subheadings will smoothly scroll that subheading to the top of your screen... but not actually change your page URL to include an anchor to the clicked element
[15:51:50] <bstrie> and also, they're even real anchors
[15:51:57] <bstrie> so you can't right-click and get the address manually
[15:52:06] <FreeFull> Fun
[15:52:28] <FreeFull> Linking people to documentation? Who needs to do that?
[15:52:40] <bstrie> haha, those subheadings don't even have distinct id attributes
[15:52:50] <bstrie> so I can't even put a reference to it in the URL myself
[15:52:51] <FreeFull> Heh
[15:53:01] <strcat> anyone have thoughts on https://github.com/mozilla/rust/pull/10690 before I go ahead and write a lot more? ;p
[15:53:14] *** pmoore is now known as pmoore|away
[15:53:25] <FreeFull> bstrie: So they have id attributes but ones that aren't unique?
[15:53:29] <FreeFull> That's not even valid HTML
[15:53:44] *** Quits: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Connection reset by peer)
[15:53:52] * strcat will drop rusti into a tub of freezing cold water if someone doesn't like it after it's all done
[15:53:58] <strcat> do you want rusti to suffer?
[15:54:06] <strcat> poor bot
[15:54:50] <bstrie> FreeFull: look at http://us1.php.net/print_r , then go to the "Parameters" heading. note how mousing over the parameter names changes your cursor to a finger. but it's not a link. click on it. try right-clicking on it. note that this clickable element has no id attribute.
[15:55:07] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[15:56:22] <FreeFull> bstrie: Doesn't make my mouse cursor a finger
[15:56:29] <bstrie> FreeFull: weird :)
[15:56:36] <FreeFull> Actually, expression does
[15:56:42] <FreeFull> But not Parameters
[15:56:44] <bstrie> yes, that's what I mean
[15:56:50] <bstrie> click on expression
[15:56:53] <FreeFull> Yeah, you're right
[15:57:05] <bstrie> they have reinvented intra-page anchors, but poorly
[15:57:32] <FreeFull> And if you disable javascript, it doesn't work
[15:57:32] *** Joins: bynaryshef (bynaryshef@moz-647E89A6.mem.bellsouth.net)
[15:58:22] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[15:58:48] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Quit: Leaving...)
[15:59:32] <bstrie> also, never read the comments
[15:59:36] <bstrie> that way lies madness
[15:59:40] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:00:03] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[16:00:39] <KokaKiwi> "error: type `&str` does not implement any method in scope named `iter`" wtf?
[16:01:17] <bstrie> KokaKiwi: I think you have to tell it whether you want a byte iterator or a character iterator? try `foo.bytes().iter()`
[16:01:30] <bstrie> this is what kimundi tells me, at least
[16:01:44] <KokaKiwi> I want a char iterator :o
[16:02:11] <KokaKiwi> (And the doc isn't up to date so, because it tells me that StrSlice has split method)
[16:02:18] <bstrie> KokaKiwi: then try `foo.chars().iter()` :)
[16:02:41] <eddyb> but... chars() is an iterator :/
[16:02:52] <bstrie> oh, then maybe it's just `foo.chars()` :)
[16:02:57] <KokaKiwi> Oh :o
[16:02:57] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[16:03:08] *** Joins: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net)
[16:03:16] <bstrie> though now I wonder if foo.iter().iter().iter().iter() still works
[16:03:45] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[16:04:08] <KokaKiwi> It works \o/
[16:04:11] <KokaKiwi> thx
[16:04:32] <KokaKiwi> (But I liked the s.iter() method :( )
[16:05:02] *** Joins: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net)
[16:05:20] <bstrie> KokaKiwi: there's no such thing as a generic iterable on a unicode string! you have to specify what you really want :)
[16:05:42] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Client exited)
[16:05:56] <bstrie> erase from your mind the notion that strings are iterable
[16:05:59] <bstrie> every other language is wrong
[16:06:03] <KokaKiwi> :D
[16:06:04] <bstrie> even this languge is wrong
[16:06:16] <bstrie> we had a long discussion about this just this morning :P
[16:06:23] <KokaKiwi> x)
[16:06:28] <bstrie> but we're workin on it
[16:06:34] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[16:06:37] <bstrie> eventually we hope to be less wrong
[16:06:40] <bstrie> this is all that we can aspire to
[16:07:26] <KokaKiwi> I'll write 100 times "String are not iterable" at the whiteboard :D
[16:07:34] <KokaKiwi> Strings*
[16:07:59] <bstrie> KokaKiwi: when you're done with that, clean the boards and write "Strings do not have a length" 100 times
[16:07:59] *** Quits: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de) (Quit: mye)
[16:08:19] <KokaKiwi> bstrie: Ah? ._.
[16:08:33] <KokaKiwi> No more str.len()? D:
[16:08:41] <bstrie> KokaKiwi: not if I have anything to say about it :)
[16:08:54] <bstrie> foo.bytes().len() is the future!!
[16:08:59] <KokaKiwi> Oh
[16:09:35] <bstrie> dispense from your mind the antiquated ASCII notion that strings have a length
[16:09:42] <KokaKiwi> But, is str.len() not easier to understand? Why not keeping str.len() as an "alias" of foo.bytes().len()?
[16:09:44] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[16:09:51] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[16:09:58] <strcat> because that length is only useful for low-level code allocating a buffer
[16:10:03] <bstrie> KokaKiwi: no, because when *I* say .len() I want the number of code points
[16:10:11] <bstrie> and when a graphics person says .len() they want the number of graphemes
[16:10:15] <strcat> bstrie: no you don't
[16:10:29] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[16:10:31] <strcat> they probably want the string length :), which is not the number of graphemes
[16:10:35] <strcat> some graphemes are double-width!
[16:10:41] <bstrie> fuck!
[16:10:42] <kimundi> strcat: That doc PR reads fine, imo
[16:10:46] <bstrie> we'll need foo.width() too :)
[16:10:48] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[16:10:48] <strcat> and with a proportional font, you probably want nothing at all
[16:10:55] <strcat> it only really makes sense with monospaced
[16:11:00] <strcat> where you don't have weird ligature stuff going on
[16:11:05] <strcat> and proportional glyphs
[16:11:08] <KokaKiwi> In most of my softs, when I check string length, I just want numbers of characters that are in this string :o
[16:11:16] <strcat> KokaKiwi: what is a 'character'?
[16:11:20] <strcat> certainly, not a byte
[16:11:28] <KokaKiwi> "Hello" -> 'H' is a character
[16:11:34] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[16:11:45] <strcat> KokaKiwi: ok, so with an anglo-centric view of the word ASCII byte == character
[16:11:50] <KokaKiwi> "Héllo" -> 'é' is a character (I don't care about if it's unicode or not)
[16:11:51] <eddyb> char_len() is O(N)
[16:12:04] <sbalmos> Bring on Kanji
[16:12:08] <kimundi> strcat: Is it possible for a strings ByteIterator to somehow short circuit the len() Iterator adaptor?
[16:12:11] <strcat> KokaKiwi: so, by character you mean user-perceived character
[16:12:17] <KokaKiwi> strcat: Yep
[16:12:18] <strcat> KokaKiwi: which is a grapheme, not a byte or a code point
[16:12:26] <strcat> graphemes can be composed of N code points
[16:13:20] <KokaKiwi> I think that when you want string length, it's rare that you want other than 'user-perceived' length ^^
[16:13:46] <kimundi> KokaKiwi: Depends
[16:13:55] <strcat> KokaKiwi: http://pastie.org/8512607 here, a sentence in the language of my people
[16:14:03] <KokaKiwi> (If you really want to have 'byte'-length, you can do str.bytes().len(), but, in common cases, str.len() should return user perceived length, I think)
[16:14:10] <strcat> 421 code points
[16:14:12] <Earnestly> strcat: All hail zalgo
[16:14:22] <strcat> 827 bytes
[16:14:28] *** Quits: huseby (huseby@moz-B2F53871.torservers.net) (Ping timeout)
[16:14:32] <strcat> but the user-perceived number of characters is pretty low.
[16:14:42] <strcat> anyway we need the unicode tables for graphemes
[16:14:46] <Earnestly> How would you even count that
[16:14:50] <kimundi> KokaKiwi: The problem is that "user percieven len and glyphs" are the most expensive operations, and depending  on language still not clearly defineable
[16:14:57] <bstrie> Earnestly: the way that the unicode spec tells us to
[16:15:03] <strcat> Earnestly: len("pasted") in python, if you mean code points ;p
[16:15:06] <Earnestly> Firefox says 14 characters
[16:15:11] <strcat> Earnestly: yeah
[16:15:16] <strcat> but 421 code points
[16:15:19] <strcat> Earnestly: http://www.unicode.org/reports/tr29/ here
[16:15:21] <Earnestly> That's quite impressive
[16:15:26] <strcat> you basically iterate over the code points
[16:15:32] <strcat> and you check if they represent a grapheme
[16:15:38] <strcat> via a hash table lookup, or whatever
[16:15:39] <Earnestly> 14 characters at almost 1Kb
[16:15:44] <strcat> Earnestly: it's unbounded
[16:15:50] <strcat> you can have a 2MiB character
[16:16:07] <strcat> I think firefox would throw a fit and lock up though, knowing firefox
[16:16:29] <strcat> it'd sit there rendering thousands of little twirly things
[16:16:31] <strcat> someone try ;p
[16:16:48] <eddyb> where does it say 14 characters?
[16:17:13] <Earnestly> eddyb: How many it selects when highlighted
[16:17:24] <bstrie> strcat: I think there might be a twitter account that tries to crash browsers by tweeting unicode...
[16:17:36] <eddyb> Earnestly: oh, I haven't seen that before
[16:18:01] <Earnestly> eddyb: I literally counted in caret mode (vimperator/pentadactyl) ._.
[16:18:06] *** Joins: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de)
[16:18:25] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[16:18:35] <strcat> http://bugs.python.org/issue18406 ;p
[16:18:37] <strcat> sad
[16:19:20] <kimundi> I really want a glyph type in rust
[16:19:35] <kimundi> struct glyph { s: str }
[16:19:44] <strcat> meh
[16:19:47] <Earnestly> "rune" ;p
[16:19:51] <strcat> Earnestly: not what rune means
[16:19:57] <strcat> rune means code point, in plan9/go
[16:20:00] <Earnestly> I know, I'm just poking heh
[16:20:02] <strcat> oh
[16:20:14] <kimundi> But with the newest plan to not do DSt it would be GlyphSlice and Glyph :(
[16:20:14] <Earnestly> Does Go actually also use the term?
[16:20:17] <eddyb> Earnestly: oooooh, I see. but I count 15
[16:20:33] <Earnestly> eddyb: I am always liable to fail at counting
[16:20:43] <bstrie> strcat: really? I thought rune was grapheme...
[16:20:52] <strcat> nope
[16:20:54] <bstrie> dammit
[16:21:18] <kimundi> Is glyph == grapheme cluster correct?
[16:21:29] <strcat> well
[16:21:31] <strcat> not really
[16:21:42] <strcat> the font can render stuff differently
[16:21:51] <strcat> it can combine two graphemes into a ligature or whatever
[16:21:53] <bstrie> kimundi: I think we discussed this the other day, and came up with "gracl" as the best name :)
[16:22:04] <strcat> really, text is just a hopeless prospect.
[16:22:29] *** Joins: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP)
[16:22:36] <kimundi> struct GrCl<'a> { priv s: &'a str }
[16:23:31] *** Quits: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman_)
[16:24:18] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:24:47] <kimundi> strcat: Okay, asked differently: would be calling "grapheme cluster" a "glyph" be more wrong then calling "code point" a "char" ? :P
[16:24:47] <sp3d> Pango deals in "glyphs" as the very last step before rasterization (where a PangoGlyph is tied to a given font and size), but I don't know how canonical its usage of terminology is
[16:25:02] <strcat> kimundi: it's more wrong, yes
[16:25:09] <kimundi> okay, then better not do it
[16:25:14] <strcat> because character has no meaning anymore
[16:25:19] <kimundi> ...
[16:25:21] <strcat> after so much abuse
[16:25:29] <strcat> *meaningless* ;p
[16:25:29] <eddyb> it's defaced
[16:25:39] <kimundi> Damn you universal quantification!
[16:25:59] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[16:26:06] <kimundi> No wait, this would be implication
[16:26:23] <kimundi> "Complicated math metaphor #42"
[16:27:28] *** Quits: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP) (Connection reset by peer)
[16:27:41] <sbalmos> I have to note as a naive outsider, regardless, not having a string length function will be perceived as a WTF
[16:27:59] <sp3d> what do people *use* string length functions for?
[16:28:02] <Earnestly> strcat: I'm trying to find out how knowing the amount of code points helps here.  Wouldn't the bytes be more important?  What about limiting the length of some text output or replacing overly long sentences with ellipses, has all of that changed?
[16:28:24] <sp3d> as long as we can do those things well, we can say we're a high-level enough language that "string length" isn't the first thing you should reach for
[16:28:29] <strcat> Earnestly: bytes are only useful for memory allocation
[16:28:30] <sbalmos> sp3d: Input length validation (max length fields)
[16:28:34] <Earnestly> E.g. your example, 15 characters long but over 420 codepoints
[16:28:38] <strcat> code points are not useful alone, they're useful as a manipulation unit
[16:28:43] *** kimundi is now known as zz_kimundi
[16:28:52] <strcat> Earnestly: you can look up a code point and see if it's a grapheme or not
[16:29:05] <Earnestly> That sounds more expensive
[16:29:12] <strcat> Earnestly: it's a map lookup
[16:29:21] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[16:29:22] <strcat> just hashing an integer and a cache miss
[16:29:29] <Earnestly> Hmm, you still have to do that for every codepoint though
[16:29:33] <strcat> yep
[16:29:43] <strcat> tis unicode
[16:30:01] <bstrie> we must accept it for what it is
[16:30:11] <bstrie> which is terrible, but the best solution we have
[16:30:31] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Ping timeout)
[16:30:39] <sp3d> sbalmos: the Rust approach should make it very clear whether you're worried about making a user feel like they enter a 12-character string or about fixed column width in your database
[16:30:42] <strcat> http://mortoray.com/2013/11/27/the-string-type-is-broken/
[16:30:57] <sbalmos> sp3d: Not arguing against, just pointing it out. From that point, I would agree.
[16:30:59] <strcat> the current rust approach is pretty bad
[16:31:02] <sp3d> yeah
[16:31:11] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[16:31:12] <sp3d> it's true that other languages might not force that distinction on the programmer, but by doing so they have to live with more bugs
[16:31:24] <bstrie> strcat: eh, I don't agree with the sentiment of those articles. "languages get strings wrong, therefore ubiquitous character arrays are better" is a silly argument
[16:31:55] <strcat> well, rust's string type has 1 purpose
[16:32:01] <strcat> enforcing that some set of bytes is UTF-8
[16:32:04] <strcat> it does that job well
[16:32:09] <sp3d> bstrie: in comments I think the author hedged a little, to the effect that "for now we shouldn't lie to ourselves about what guarantees we make, but ultimately 'fixed' strings would be best"
[16:32:14] <strcat> it does not provide any useful ways to manipulate or query the string
[16:32:15] <sp3d> or clarified, maybe
[16:32:20] <bstrie> sp3d: ah, I didn't read the comments
[16:32:23] <strcat> and the methods it does provide serve only to confuse people and help them get it wrong.
[16:32:53] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[16:32:56] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[16:33:28] *** Joins: squiggy (Mibbit@moz-72766D58.dsl.teksavvy.com)
[16:33:43] <bstrie> strcat: I think there are enough people in here concerned about manipulating unicode strings that this will get better. but yeah I agree it sucks right now
[16:34:36] <benh> 17:25 < strcat> because character has no meaning anymore <- I'd be on board with removing the char type from the language / renaming it to ucodepoint or something, and renaming all the operations yielding them...
[16:34:39] <bstrie> if your conceit is that the internet is a global phenomenon to bring cultures together, then you're gonna have to deal with text somewhere along the line. which means you'll either need a library to do it, or to do it in the language itself
[16:34:52] <bstrie> for a language designed to implement a web browser, I think the choice should be obvious
[16:34:57] <strcat> benh: s/char/ucs4/
[16:34:57] *** Joins: jvshahid (jvshahid@moz-86D5F266.nyc.res.rr.com)
[16:35:25] <sp3d> it's impressive how much less one wants to reach for the 'ucs4' type compared to 'char'
[16:35:32] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:35:57] <Earnestly> Make an abbriv for your favourite text editor
[16:36:44] <Earnestly> strcat: So the solution is to effectively detach any notion of a "character" from the language and essentially force people to think anew
[16:36:52] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:37:00] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:37:07] <benh> Can we do that or would I get my head bitten off for suggesting we change a fundamental/built-in type :v
[16:37:18] <strcat> I already changed char pretty recently
[16:37:22] <strcat> it used to have arithmetic ops
[16:37:27] <strcat> and you could cast any integer to it unchecked
[16:37:43] <strcat> now, you have to use char::from_u32, and it checks that it's not a surrogate or out-of-range
[16:37:57] <strcat> 'char' is basically perfect at a language level, except the name is wrong
[16:37:58] <Earnestly> It is interesting to figure out how you can run toupper on something like Bafﬄe to BAFFLE
[16:37:59] <strcat> ;p
[16:38:04] <benh> but I mean renaming it to codepoint
[16:38:28] *** Joins: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP)
[16:38:39] <benh> Just... not having any operation with char in the name on strings
[16:40:04] <benh> So it's only 'byte', which is up-front about being insufficient for real text manip, 'codepoint' which sounds weird and doesn't give people any ideas of representing graphemes or otherwise 'units of how far the caret gets moved when i press right-arrow', and i dunno grapheme or w/e for the grim-dark far future of ICU in the language
[16:40:08] *** zz_kimundi is now known as kimundi
[16:40:40] <strcat> benh: graphemes only represent glyphs with monospaced fonts, though
[16:40:44] <KokaKiwi> Oh, there is no 'author' crate attribute anymore? :o
[16:40:46] <strcat> and they can be double-width, even then
[16:40:50] <strcat> KokaKiwi: never was
[16:40:58] <KokaKiwi> (I've a warning on #[author = "toto"])
[16:41:00] <benh> strcat: then i meant glyphs :)
[16:41:00] <strcat> people just started using it
[16:41:04] <strcat> it didn't do anything
[16:41:28] <strcat> (anyway it's a bit weird to say there's an author if you want other people to contribute :P)
[16:42:20] <KokaKiwi> But the license (like MIT) has an "author" field for copyright
[16:42:32] <KokaKiwi> So it's what I put in "author" attribute
[16:42:33] <Earnestly> That belongs on the LICENSE, no?
[16:42:41] <Earnestly> s/on/in
[16:43:31] *** Joins: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net)
[16:43:39] <KokaKiwi> Yeah, maybe I should remove "author" attr to keeping it in LICENSE file :o
[16:45:02] <Earnestly> Seems reasonable to me
[16:45:05] <strcat> KokaKiwi: The ProjectName Authors is what Rust does
[16:45:15] <strcat> s/Authors/Developers/
[16:45:26] <strcat> and tell people to look at the git history for a list of authors
[16:45:52] <strcat> (or auto-generate one from there)
[16:46:16] <eddyb> there's no AUTHORS?
[16:46:25] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[16:46:25] *** Joins: dherman_ (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[16:46:28] <strcat> eddyb: rust has one
[16:46:29] <eddyb> I think ^^ is what google does for all their opensource stuff
[16:46:50] <strcat> not auto-generated in rust though so it's probably pretty incomplete
[16:46:57] <eddyb> strcat: and updating it is not part of the first PR?
[16:47:12] <strcat> what do you mean the 'first PR'?
[16:47:31] <strcat> how do you know if someone is contributing for the first time based on the AUTHORS.txt file?
[16:47:52] <strcat> the email in there might not match their commit email
[16:47:58] <strcat> anyway it should be auto-generated, if anything
[16:48:02] <sbalmos> strcat: Skipping back for a moment, what about str.to_ascii().len, toupper, tolower, etc?
[16:48:04] <strcat> with a mapping to correct names/emails
[16:48:06] <eddyb> yeah, that would be better
[16:48:14] <strcat> on a case-by-case basis
[16:48:23] <strcat> sbalmos: hm?
[16:48:24] <friggle> strcat: yeah, this is what git (the project) does
[16:48:35] <strcat> sbalmos: those exist, whether they should be in the stdlib is questionable
[16:48:40] <mmalecki> I think node solves this somehow with automatic mapping of emails
[16:48:50] <strcat> how often do you really need to handle ASCII *only*?
[16:48:50] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:48:58] <strcat> just encourages people to do stuff wrong
[16:48:59] <mmalecki> yeah, .mailmap: https://github.com/joyent/node/blob/master/.mailmap
[16:49:04] <strcat> we only have it because our unicode support sucks
[16:49:13] <kimundi> rusti: 'a'.to_ascii().to_upper().to_char()
[16:49:14] -rusti- 'A'
[16:49:20] <Blei> https://github.com/mozilla/rust/issues/5037
[16:49:34] <ion> rusti: 'ß'.to_upper()
[16:49:34] -rusti- <anon>:9:9: 10:5 error: type `char` does not implement any method in scope named `to_upper`
[16:49:34] -rusti- <anon>:9          'ß'.to_upper()
[16:49:34] -rusti- <anon>:10     };
[16:49:34] -rusti- error: aborting due to previous error
[16:49:34] -rusti- application terminated with error code 101
[16:49:38] <sbalmos> strcat: The whole thing is a tradeoff argument about practicality.
[16:49:39] <strcat> we don't have unicode support for stuff like that so instead we have an ASCII type to let people continue to do it wrong
[16:49:52] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:49:59] <strcat> sbalmos: why is it more practical to convert to an ASCII type than call the methods on your string directly?
[16:50:06] <strcat> the real issue is rust's crappy stdlib
[16:50:38] <strcat> if we had good unicode support we'd never have added ascii support
[16:50:38] <Earnestly> ion: Would you have expected "ES" from that?
[16:50:52] <Earnestly> FS/
[16:50:55] <strcat> better it be in a separate type than on str though
[16:51:06] <ion> λ> Text.toUpper "ß"
[16:51:08] <ion> "SS"
[16:51:11] <mmalecki> rusti: 'ł'.to_upper()
[16:51:12] <ion> That’s what some Unicode table says.
[16:51:12] -rusti- <anon>:9:9: 10:5 error: type `char` does not implement any method in scope named `to_upper`
[16:51:12] -rusti- <anon>:9          'ł'.to_upper()
[16:51:12] -rusti- <anon>:10     };
[16:51:12] -rusti- error: aborting due to previous error
[16:51:12] -rusti- application terminated with error code 101
[16:51:27] <Earnestly> ion: Oh, sorry.  Of course it's SS
[16:51:48] <Earnestly> (My font renders it slighly strangely (CMU))
[16:52:06] <mmalecki> rusti: "małe".to_upper()
[16:52:06] -rusti- <anon>:9:9: 10:5 error: type `&'static str` does not implement any method in scope named `to_upper`
[16:52:06] -rusti- <anon>:9          "małe".to_upper()
[16:52:06] -rusti- <anon>:10     };
[16:52:07] -rusti- error: aborting due to previous error
[16:52:07] -rusti- application terminated with error code 101
[16:52:33] <strcat> anyway the whole str type needs to be thrown out along with ~[T]
[16:52:42] <strcat> so no point really in fixing it
[16:52:43] *** Quits: sp3d (s@moz-41A29595.dhcp.stls.mo.charter.com) (Ping timeout)
[16:52:53] <ion> Maybe the bot should join those lines and truncate at the IRC message maximum length. :-P
[16:53:02] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[16:53:26] <strcat> it will be unreadable if it joins the lines
[16:53:38] *** Quits: squiggy (Mibbit@moz-72766D58.dsl.teksavvy.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:54:04] <bstrie> to be fair, it's already pretty unreadable
[16:54:18] <strcat> what makes that unreadable?
[16:55:25] <bstrie> in my client, the messages from rusti don't even start until column 29 of an 80-column display
[16:55:36] <bstrie> so it wraps all the time and looks terrible
[16:55:46] <bstrie> 11:52 [notice(rusti:#rust)] <anon>:9          "małe".to_upper()
[16:56:02] *** Joins: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP)
[16:56:33] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[16:56:36] <bstrie> really I think it's a problem with our error messages
[16:56:38] <bstrie> too noisy
[16:56:52] <eddyb> strcat: by thrown out you mean "butchered"?
[16:56:53] <bstrie> I don't need the filename on every line
[16:57:12] <eddyb> strcat: into frozen length?
[16:57:26] <eddyb> that's actually interesting, ~str would become immutable
[16:58:31] *** Quits: bynaryshef (bynaryshef@moz-647E89A6.mem.bellsouth.net) (Quit: This computer has gone to sleep)
[16:59:44] *** Joins: sp3d (s@moz-41A29595.dhcp.stls.mo.charter.com)
[16:59:52] <bstrie> "Bitcoin is already a whole lot more practical than almost any aspect of the modern money infrastructure" #shitHNsays
[16:59:58] *** Joins: Savago (Savago@1111ED0B.40BDE760.18DDB669.IP)
[17:00:19] *** Quits: mixi (mixi@moz-DBD8904A.org) (Ping timeout)
[17:00:33] *** Quits: Savago (Savago@1111ED0B.40BDE760.18DDB669.IP) (Quit: Savago)
[17:00:55] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[17:02:02] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[17:02:15] *** Joins: mixi (mixi@moz-DBD8904A.org)
[17:07:11] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[17:10:49] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[17:12:42] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Ping timeout)
[17:12:45] <ion> :-D
[17:12:52] <bstrie> ion: hello
[17:12:56] <ion> o hai
[17:13:31] <bstrie> ion: sorry, I'm not fluent in lolcat :(
[17:14:36] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[17:15:03] *** Joins: osa1 (omer@moz-8FDAB45C.hsd1.il.comcast.net)
[17:15:59] <osa1> I'm using default make target to build rust, but stage3 directory is left empty after successfull build, is this normal?
[17:16:00] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[17:16:22] *** Quits: amro (quassel@F1E3FD84.8AAAF769.FAAB0799.IP) (Client exited)
[17:16:35] <bstrie> osa1: I believe so, yes
[17:16:36] <Blei> osa1: yes, stage2 is where the fun happens
[17:16:45] <bstrie> there's not really a stage3
[17:16:59] <bstrie> there used to be? I might even be the one who got rid of stage3
[17:17:02] <bstrie> it was a long time ago
[17:17:15] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[17:17:15] *** ChanServ sets mode: +o tjc
[17:17:44] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:18:15] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[17:20:00] <benh> bstrie: I think stage3 was/is rebuilding with stage2 rustc just to make sure the artifacts of stage2 and stage3 are identical
[17:20:08] *** Quits: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net) (Ping timeout)
[17:20:09] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:20:18] <bstrie> benh: but I think we do that with stage1/stage2
[17:20:18] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[17:20:26] <benh> mhm
[17:20:28] <kimundi> Which they never are, because of hashing randomness afaik :P
[17:20:39] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:21:22] *** Quits: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de) (Quit: mye)
[17:21:36] <bstrie> we use the snapshot to compile stage0, which is the new compiler but compiled with the features of the old compiler
[17:21:50] <bstrie> then stage1 is compiled by stage0, which is the new compiler compiled with the features of the new compiler
[17:22:05] <bstrie> then stage2 is compiled by stage1 and (theoretically) used to verify that the artifacts have converged
[17:22:31] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:22:59] <osa1> another question: I just compiled HEAD but rust executable fails wtih "ror while loading shared libraries: librustc-d3cb8c2ccd84a7a7-0.8-pre.so: cannot open shared object file: No such file or directory". I just searched in rust folder and this file is not generated.
[17:23:21] <bstrie> osa1: did you do "make install"?
[17:23:29] <osa1> no, just make
[17:23:33] <benh> the 'rust' executable was removed
[17:23:47] <benh> if you still have that, it's an old version
[17:23:49] <osa1> hmm maybe I should clean first
[17:23:57] *** Joins: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de)
[17:23:59] <benh> we just have rustc now
[17:24:03] <benh> does rustc work?
[17:24:05] <bstrie> osa1: "make install" puts all the necessary bits in all the right places
[17:24:10] <osa1> okay, I'll run make clean and try again
[17:24:17] <osa1> bstrie: I'm deliberately avoiding doing that
[17:24:23] <bstrie> you don't *need* to do it, but you'll need to invoke rustc with the necessary linker args if you don't
[17:24:27] <benh> osa1: If rustc works I don't think you need to make clean
[17:24:34] <osa1> benh: yeah it works fine
[17:24:35] <benh> bstrie: I don't think that's true
[17:24:38] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:24:54] <bstrie> benh: what, you can just cd into the stage2 directory and run rustc?
[17:25:00] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[17:25:02] <bstrie> because that would be great, but that didn't use to be the case
[17:25:10] <benh> bstrie: yeah I think it has all the right paths baked into the binary
[17:25:40] <osa1> I still added lib directory to LD_LIBRARY_PATH
[17:25:50] <benh> bstrie: I have a symlink ~/local/bin/rustc -> ~/blahblahblah/rust/build/x86_64-blah/stage2/bin/rustc and calling that works
[17:25:59] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[17:26:00] <benh> and I didn't move the generated .so files anywhere
[17:26:01] <bstrie> awesome
[17:26:06] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[17:26:14] <benh> shouldn't need LD_LIBRARY_PATH
[17:26:44] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[17:26:47] <benh> osa1: your issue is probably just that you still have the 'rust' executable from a long time ago, and all the libraries it was built against were removed
[17:26:52] <osa1> so all libraries are statically linked to rust binaries?
[17:26:58] <osa1> benh: yeah
[17:27:14] <bstrie> I'm sure they're not statically linked, we only just grew that feature like last week
[17:27:44] <benh> I don't understand dynamic linking but I believe the relevant magic is called rpath ;)
[17:29:52] <osa1> okay, last question before I leave (gotta go for a metting) is this feature request still relevant? https://github.com/mozilla/rust/issues/10485 because I think I can easily do that
[17:29:52] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[17:29:53] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[17:30:15] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[17:30:21] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[17:30:51] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[17:32:26] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[17:32:53] <osa1> no ideas?
[17:33:34] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:33:48] *** Joins: vmx (vmx@moz-A5BF13C.dip0.t-ipconnect.de)
[17:34:25] *** Joins: vodik (simon@63AED96A.F44F49AA.D02BABA9.IP)
[17:35:17] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[17:39:04] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[17:39:04] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[17:39:25] *** Quits: Ferreus (ferreus@moz-95543D4F.dip0.t-ipconnect.de) (Ping timeout)
[17:39:44] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[17:40:53] <bstrie> osa1: you'd have to ask cmr, he's the one who requested it
[17:41:15] *** Joins: feng (Mibbit@6CB7891B.67084680.C7DB8B78.IP)
[17:41:20] <osa1> okay thank you all
[17:41:24] *** Quits: osa1 (omer@moz-8FDAB45C.hsd1.il.comcast.net) (Quit: Konversation terminated!)
[17:41:31] <bstrie> np
[17:41:52] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[17:42:13] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:43:32] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[17:44:09] *** Joins: heftig (heftig@6766A975.BD9EB3D7.172227A7.IP)
[17:44:14] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:45:12] <kimundi> nmatsakis: I just read your two recent blog posts. Interesting stuff!
[17:46:12] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[17:46:31] *** Joins: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com)
[17:48:09] <kimundi> nmatsakis: That second approach, with size/vtable being applied at the top level of a type is how I thought it would work anyway
[17:48:42] *** Quits: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com) (Quit: Leaving)
[17:48:45] *** Joins: doomlord_ (servitor@moz-9738D381.range86-160.btcentralplus.com)
[17:49:04] <kimundi> nmatsakis: I' now wondering whether the DST usecases I see for custom vector/string types can be expressed with this new scheme
[17:49:41] <kimundi> struct str<N> { priv bytes: [u8, ..N] } // maybe?
[17:50:11] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[17:50:20] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[17:50:49] <kimundi> Of course, you'd probably never want a str<N>, only ever a existential type like ~str or &str
[17:50:53] <eddyb> kimundi: not str {priv bytes: [u8]}?
[17:51:04] <kimundi> eddyb: That's the DST variant
[17:51:17] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:51:21] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[17:51:21] <kimundi> eddyb: Which I seem to be fighting a loosing battle with ;)
[17:51:25] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:51:38] *** Quits: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org) (Ping timeout)
[17:51:41] <kimundi> eddyb: If you haven'T seen, the newes alternative would be this: http://smallcultfollowing.com/babysteps/blog/2013/11/27/thoughts-on-dst-2/
[17:51:57] <kimundi> (With http://smallcultfollowing.com/babysteps/blog/2013/11/26/thoughts-on-dst-1/ being the DSt one)
[17:52:13] <eddyb> wouldn't the new scheme have the same "user" syntax?
[17:52:38] <kimundi> eddyb: What do you mean?
[17:53:06] <eddyb> i.e. you would write the same thing as in the "DST variant", but it would work differently
[17:53:21] *** Quits: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net) (Quit: Leaving)
[17:53:30] <kimundi> eddyb: That'S not what'S written in that second blog post at least
[17:53:46] <eddyb> 'Self
[17:54:39] *** Joins: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org)
[17:54:55] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[17:57:21] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:57:51] *** Quits: JanC (janc@moz-F97D63D7.dsl.scarlet.be) (Ping timeout)
[17:59:03] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:59:17] <Florob> Uff... that C Tree implementation is really worse then it needs to be :/
[17:59:43] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[18:00:56] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[18:01:44] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[18:02:36] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[18:03:03] <nmatsakis> kimundi: perhaps, though I just realized a...semi-fatal flaw with the second scheme that needs to be worked out :)
[18:03:13] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[18:04:01] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Max SendQ exceeded)
[18:04:05] <kimundi> nmatsakis: He, I hope it doesn't invalidate what I like about it. ;)
[18:04:05] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[18:04:15] <kimundi> nmatsakis: What is the flaw?
[18:05:45] <nmatsakis> kimundi: I'm going to try and write up a post -- basically forgetting the concrete types doesn't interact smoothly with monomorphization, we won't know what code to run, have to work out the precise conditions where we can make it work
[18:06:46] <kimundi> nmatsakis: Hm... How is that different than with trait objects?
[18:07:17] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[18:07:25] <nmatsakis> kimundi: with trait objects we have a vtable
[18:07:31] <nmatsakis> kimundi: and we make all interactions use dynamic dispatch
[18:07:40] <nmatsakis> kimundi: we prob don't want to be calling dynamic dispatch just to do x[i] 
[18:07:59] <kimundi> hm, yeah
[18:08:07] <nmatsakis> kimundi: most of the time we don't have to, but without any restrictions it would be necessary
[18:08:14] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[18:09:08] <benh> that vaguely sounds like my confusion leading to my disqus comment :)
[18:09:34] <benh> (maybe i should have posted to reddit)
[18:10:49] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:12:05] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[18:12:53] *** Joins: JanC (janc@moz-B3774AFF.dsl.scarlet.be)
[18:13:52] <kimundi> nmatsakis: Hm, another thing I'm wondering right now: How would something like a growable vector work with that scheme? If you can only allocate compile-time fixed-sized buffers, then that sounds impossible. Unless such types just work with the representation of a existential type directly, but that seems incompatible with custom smart pointers
[18:13:58] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[18:14:27] <jix> kimundi: don't you need to own the vector to grow it, which makes sure you have the only reference to it?
[18:15:11] <kimundi> jix: That'S not the problem I see
[18:18:32] <jix> could you even define a function that is generic in the smart pointer to a vector of a given fixed type?
[18:18:40] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[18:19:28] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:19:56] *** Joins: apoelstra (username@moz-C92A9641.sw.biz.rr.com)
[18:20:50] <jix> or would a &mut to the contained vector be enough to grow it?
[18:21:07] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:21:10] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[18:21:42] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Max SendQ exceeded)
[18:21:43] <jix> in that case it would be possible to pass a implicit &mut to the size inside the fat pointer (besides and thus independent of the smart pointer data)
[18:22:21] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:22:29] <kimundi> jix: Did you read nmatsakis's blog posts?
[18:22:29] <jix> to pass a &mut referring to the size... it would get passed to the function taking the &mut [T]
[18:22:33] <jix> kimundi: I did
[18:22:37] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[18:22:40] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Max SendQ exceeded)
[18:23:04] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[18:24:01] *** Quits: vmx (vmx@moz-A5BF13C.dip0.t-ipconnect.de) (Quit: Leaving)
[18:24:04] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[18:24:34] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:25:22] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:25:41] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Max SendQ exceeded)
[18:25:41] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[18:26:51] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[18:30:30] <Blei> so, how do you do NULL function pointers nowadays? `as` doesn't work anymore
[18:30:40] <Blei> transmute? feels really heavy
[18:30:47] <kimundi> Blei: Option<fn>
[18:31:00] <Blei> oh, wow
[18:31:01] <TeXitoi> any idea: error: last argument in `do` call has non-procedure type: |&~[f64]| -> <V1902>
[18:31:03] <Blei> ok
[18:31:14] <jix> actually the only solution I can think of would involve a new kind of reference, let's call it &grow that is stronger than &mut.. if a function takes a &grow T it would be translated to a function taking (&mut T, size: &mut uint, grow: ???) where grow would be a reference to a function coming of a trait the smart pointer would have to implement to allow growing the pointed to value
[18:31:28] <Blei> has that change landed already? i thought they were still discussing about that
[18:31:48] <strcat> jix: why not just use &mut Growable ?
[18:32:10] <jix> strcat: because you might need help from the smart pointer, don't you?
[18:32:40] <jix> if you reallocate it has to be updated... but right now the smart pointers type isn't even part of the function if I understand this correctly
[18:32:45] <bstrie> TeXitoi: if you're using do notation, you have to use a proc rather than a closure
[18:32:50] <strcat> jix: dunno what you mean
[18:33:11] <strcat> there's no room for more complexity at the language level though
[18:33:58] <TeXitoi> bstrie: that's the syntax for a procedure?
[18:34:06] <Blei> strcat: assume your smart pointer is a arena/pool allocated pointer. now you want to grow the array. how?
[18:34:18] <jix> I'm not saying that I like my idea. But if I understand that proposal correctly it wouldn't use ~[T] anymore but &mut [T] (otherwise it would not work with smart pointers)
[18:34:20] <strcat> Blei: that's not how you do arenas
[18:34:29] <jix> but that blurs the distinction between owned and mutable
[18:34:29] <strcat> dunno why we'd mess with something C++11 does well
[18:34:37] <strcat> it's really hard to do a proper design for allocators
[18:34:38] <jix> Maybe I'm completly mistaken about this though... 
[18:34:46] <strcat> returning smart pointers directly from an arena is not right
[18:35:07] <strcat> neither is hard-coding container types that can be returned from it
[18:35:21] <Blei> hmm, ok. what's the best way to do arena allocation then?
[18:35:23] <strcat> jix: I don't know what you mean
[18:35:26] <strcat> the existing type system works well
[18:35:38] <strcat> there are certain types like trait objects that are rough
[18:35:46] <strcat> Blei: like C++11.
[18:35:55] <strcat> allocators allocate memory, not a specific kind of smart pointer
[18:36:08] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[18:36:11] <strcat> smart pointers and vectors take an type allocator parameter and store an allocator instance
[18:36:25] <strcat> other containers build on those do the same
[18:36:43] <jix> strcat: I'm talking about nmatsakis' blog post, that would change the existing way, wouldn't it?
[18:36:44] <eddyb> Vec<T, Alloc=Heap> pls
[18:36:56] <strcat> anyway it's not really clear what the best way to do it is
[18:36:58] <Blei> ah, so the `grow` parameter in jix's method would be the allocator instance then, i guess
[18:37:23] <strcat> but it's clear to me that returning smart pointers as the unit from the arena is wrong ;p
[18:37:37] <strcat> there are many use cases for allocators
[18:37:43] <strcat> you might want a cache aligned allocator
[18:37:55] <strcat> you might want specific kinds of object pools or arenas
[18:38:01] <strcat> you might just want a thread-local allocation pool
[18:38:25] <strcat> by storing an instance of the allocator, it can bubble up properties like lack of Send (#[no_send] struct Alloc;)
[18:38:30] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Ping timeout)
[18:38:34] <Blei> sure, but c++11 stores this allocator instance. how would rust do that? what would be the api?
[18:38:34] <nmatsakis> kimundi: sorry was afk -- regarding growable buffers, they always just allocate fixed-size buffers anyhow
[18:38:58] <nmatsakis> kimundi: so I'm not quite sure I understand the problem
[18:39:07] <strcat> Blei: https://github.com/thestinger/rust-core/blob/master/core/vec.rs is an early sketch, but rust can't currently do generic dtors with type bounds
[18:39:09] <jix> I think my main point is that you don't want to allow reallocation for any &mut reference but if you do want to be more generic than writing separate implementations for every kind of owned reference
[18:39:21] <nmatsakis> kimundi: anyway as I wrote in the intro the growable case would be isolated to `Vec<T>`
[18:39:27] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[18:39:40] <nmatsakis> kimundi: which'll basically be a hand-written library type that manages things behind the scenes
[18:41:00] <strcat> anyway I don't really think that containers in the stdlib are going to get allocator support
[18:41:05] <kimundi> nmatsakis: So, a Vec<T> would just be hardcoded to the existential type ~[T], know about the (ptr, size) repr, and just mange it itself?
[18:41:30] <strcat> adding a type parameter to every smart pointer and container... is that really going to be something you can sell?
[18:41:36] * strcat shrugs
[18:41:53] <strcat> C++ does it, but it has better support for very generic code
[18:42:09] <Blei> ah, and overwriting a &mut[T] with a newly allocated vector doesn't work anyways. ok, that makes more sense
[18:42:12] <strcat> default type parameters you can override
[18:42:29] <strcat> and it uses that for stuff like hashing and ordering of trees
[18:42:38] <TeXitoi> I can't use do notation for method that want a closure :(
[18:42:38] <nmatsakis> kimundi: no Vec<T> and ~[T] would be completely disjoint types
[18:42:57] <nmatsakis> kimundi: Vec<T> would be something like struct Vec<T> { priv pointer: *T, length: uint, capacity: uint }
[18:43:07] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:43:20] <Blei> yeah, templates are very, very handy. except when they explode into hundreds of lines of unreadable errors
[18:43:50] *** Quits: apoelstra (username@moz-C92A9641.sw.biz.rr.com) (Quit: WeeChat 0.4.1)
[18:43:55] <strcat> if rust actually supported resolving static methods through type aliases that would be a solution
[18:43:58] <strcat> or default type parameters
[18:44:07] *** Quits: sprang (sprang@moz-920A95C4.hsd1.ca.comcast.net) (Quit: sprang)
[18:44:08] <kimundi> nmatsakis: I meant a Vec would be (ptr, size, capacity), which can be viewed as (~[T], capacity)
[18:44:13] <strcat> then you could have Vec<T, A> but write Vec<T> most of the time
[18:44:17] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[18:44:32] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[18:44:43] <bstrie> TeXitoi: not unless that method can take a proc
[18:45:14] <nmatsakis> kimundi: Not sure what you mean by "viewed" -- transmuted?
[18:45:21] <nmatsakis> kimundi: but basically yes
[18:46:11] *** Quits: feng (Mibbit@6CB7891B.67084680.C7DB8B78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:46:14] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[18:46:23] *** Joins: eholk (eholk@moz-EA69C7A5.wavecable.com)
[18:48:14] <kimundi> nmatsakis: I think my question is only relevant for the hypotetical future with HKT and custom allocators - In a growable Vec that just owns a specific type of buffer it wouldn't be a problem
[18:48:24] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[18:48:45] <tiffany> are you discussing the babysteps blog post?
[18:49:09] <tiffany> I'm reading over this and at every corner which it has an issue expressing something dependant types are the first thing that come to mind
[18:49:33] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[18:49:33] *** ChanServ sets mode: +o jdm
[18:49:45] *** Joins: osa1 (uid13910@moz-5F4AA75A.irccloud.com)
[18:49:50] <jix> Blei: I think having a OwnedDeref trait would be a solution it would return a &mut ~T or something like that
[18:50:04] <osa1> I just made one line change in rust/src/librustc/lib.rs and it took several minutes to compile, am I doing something wrong?
[18:50:31] *** Quits: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca) (Quit: canhtak)
[18:50:39] <jix> Blei: I'm not sure if limiting the smart pointer to have a representation containing a part identical to ~T is a problem though
[18:50:42] <Blei> jix: i don't think you can do it generically, except with an additional parameter
[18:50:49] <bstrie> osa1: when you make a change, it has to recompile the whole crate and everything that depends on it
[18:51:06] <Blei> jix: well, it would mean that you could do: `*ptr = ~1`
[18:51:16] <Blei> which would break your smart pointers assumptions
[18:51:37] <Blei> pointer's
[18:52:03] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:52:03] <jix> Blei: even for allowing mutation you need to have a unique reference so what assumptions would be broken in this case?
[18:52:53] <Blei> well, i guess it depends on the smart pointer, but i don't think we can assume that all smart pointers allocate using the standard exchange heap
[18:53:04] <osa1> bstrie: this is too bad ... I mean it's not possible for me to work on the compiler like this, because one line of change in front-end parts took several minutes and at least for starting I need to compile again and again with short intervals
[18:53:17] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[18:53:19] <Blei> or maybe i'm wrong, dunno
[18:53:29] <jix> Blei: oh, yeah, I agree... but I think I'm getting closer
[18:53:43] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[18:54:15] <strcat> meh
[18:54:29] <eddyb> strcat: you and me both
[18:54:39] <strcat> built-in ~ ends up being a step backwards from C++ in many ways
[18:54:54] <strcat> and I expect GC to make stuff like custom allocators not really work out
[18:55:22] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[18:55:38] * strcat doesn't think rust is really doing a good job hitting the 'clear step up from C++11/C++14' mark yet
[18:55:55] <friggle> strcat: the plans pnkfelix+niko are discussing for GC seem to encompass custom allocators.
[18:56:11] <strcat> what about allocators for the built-in types?
[18:56:14] <strcat> allocators for trait objects
[18:56:36] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[18:56:47] <strcat> or do we really just need a library Unique<T> ?
[18:56:54] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[18:57:40] <jix> Blei: would fn grow<P: OwnedPtr>(self: &mut P, ...) where the OwnedPtr Trait allows accessing a &mut T and replacing the T using placement new?
[18:57:43] <Blei> strcat: what would make trait type allocation different? maybe just extend trait coercion to `foo as(my_allocator) Trait`?
[18:57:44] <kimundi> osa1: Generally depending on the change you could just do stuff offline in a seperate *.rs file, and then copy the code back once it'S done. And for what it's worth, everyone including the core devs have to work like this on rust at the moment.
[18:57:54] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[18:58:03] <strcat> Blei: the allocator is part of the type
[18:58:07] <jix> I mean OwnedPtr<T> 
[18:58:41] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[18:58:50] <eddyb> jix: I don't understand all this grow stuff - why would you need it?
[18:59:10] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Max SendQ exceeded)
[18:59:56] <Blei> strcat: hmm, i see. make the allocation function part of the smart pointer interface? like `grow` but call it `alloc` instead?
[19:00:00] *** Quits: nkoep (nik@moz-2DF7B772.vpn.rwth-aachen.de) (Ping timeout)
[19:00:10] <strcat> Blei: it's not part of smart pointers
[19:00:15] <strcat> other things like vectors require allocators
[19:00:25] *** Joins: meTaAU_ (admin@moz-5A66BDE7.lns20.per2.internode.on.net)
[19:00:49] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:00:50] *** Quits: meTaAU (admin@moz-3405E52F.lns20.per1.internode.on.net) (Ping timeout)
[19:00:51] <jix> eddyb: because with the approach of the "Thoughts on DST pt. 2" blog post there needs to be some way to update the size which is stored outside of the smart pointer
[19:01:00] <strcat> anyway without working dtors none of this stuff is possible yet
[19:01:00] <Blei> strcat: couldn't this be solved in the library?
[19:01:06] *** Quits: eholk (eholk@moz-EA69C7A5.wavecable.com) (Ping timeout)
[19:01:14] <strcat> Blei: not if rust hardcodes so much in the language
[19:01:32] <strcat> it certainly isn't possible to write containers on par with C++ ones yet
[19:01:57] <strcat> there are a lot of issues with the way it is now
[19:01:57] <bstrie> what is this problem with dtors that I keep hearing about?
[19:02:08] <strcat> bstrie: dtors with type bounds don't work
[19:02:09] <eddyb> jix: but Vec<T> would contain the fat pointer + capacity
[19:02:09] <friggle> I am willing to give up some of C++'s flexibility for Rust's memory safety, but it would be even better if I didn't have to
[19:02:09] <Blei> what is hardcoded that shouldn't be? i know that rust lacks dependent types, but i don't see the hardcoded issues
[19:02:36] <strcat> friggle: the flexibility is a requirement for being a serious replacement for C++ as a systems language
[19:02:46] <jix> eddyb: so [T] shouldn't be used at all for dynamically sized stuff?
[19:02:56] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:02:56] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:03:01] *** Joins: eholk (eholk@moz-EA69C7A5.wavecable.com)
[19:03:09] <eddyb> jix: it's dynamical but only for creation (like a Trait), not growable
[19:03:10] *** Joins: andor (andor@moz-708868D.neferty.me)
[19:03:22] <strcat> consider some tree that you build up and send to another task
[19:03:31] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[19:03:33] <strcat> you decide you want to use a cache aligned allocator to eliminate false sharing
[19:03:40] <strcat> does this mean you have to reimplement a new tree container?
[19:03:49] <eddyb> jix: we discussed this, and it's actually easy to switch from ~[T] to Vec<T> and then back to ~[T], it's free :P
[19:04:22] <jix> eddyb: Oh I think that sidesteps the issue completely then :)
[19:04:46] <Blei> strcat: is the reimplement only because of hardcoded allocators? how does sendability play into this?
[19:04:51] <eddyb> the first conversion just copies the current size into the capacity
[19:04:57] <Blei> *reimplementation needed
[19:04:58] <eddyb> the second conversion drops the capacity
[19:05:09] <strcat> Blei: because the default allocator will cause false sharing
[19:05:18] <strcat> you'll get nodes in cache lines with thread local stuff
[19:05:29] <strcat> and then when you send it...
[19:05:30] <eddyb> jix: but Rc<[T]> and Vec<T> aren't compatible then. they aren't compatible semantically anyway
[19:06:17] <TeXitoi> bstrie: RWArc::read for example :(
[19:06:19] <jix> eddyb: yeah I was thinking about a hypothetical smart pointer with semantics compatible to ~
[19:06:27] <Blei> but assuming we have dependent types (they are planned, aren't they) what else would need to be changed?
[19:06:34] <eddyb> jix: since you can't share a growable vector that can change its place in memory, without the extra indirection, i.e. Rc<~[T]> and Rc<Vec<T>>
[19:06:36] <pcwalton> wait, dependent types are planned? o_O
[19:06:44] <Blei> haha, maybe not :)
[19:07:07] <eholk> dependent types for Rust 2.0!
[19:07:08] <Blei> i guess i equate "niko blogged about them" with "planned", sorry
[19:07:17] <pcwalton> do you mean HKT?
[19:07:20] <pcwalton> HKT are planned
[19:07:32] <benh> HKT are template template parameters, right?
[19:07:36] <pcwalton> yes
[19:07:41] <bstrie> strcat: so are you saying that if rust had working dtors and default type parameters then it would be a clear step up from C++?
[19:07:42] <pcwalton> higher kinded types != dependent types :)
[19:07:42] <Blei> oh, i might be mixing stuff up then. what's the difference?
[19:07:43] <tjc> dependent types are to HKT what a tank is to a pair of roller skates :-)
[19:07:45] <pcwalton> huuuuge difference
[19:07:49] <Blei> haha, sorry
[19:07:50] <strcat> bstrie: no
[19:07:52] <pcwalton> tjc++
[19:08:08] <bstrie> strcat: I wanna see your checklist :)
[19:08:20] <tiffany> dependant types would be great
[19:08:32] <strcat> bstrie: if you look at C++11/C++14 and compare to rust, it's a pretty big toss-up which language offers you better tools at this point
[19:08:34] * eholk imagines armies conquering nations wearing roller skates...
[19:08:51] <Blei> so, would HKT allow c++11 style allocators?
[19:08:52] <strcat> rust is obviously a lot smaller/cleaner
[19:08:56] <pcwalton> if all you care about is performance sure
[19:09:00] <strcat> pcwalton: semantics
[19:09:02] <eholk> strcat: rust has stronger type safety
[19:09:02] <pcwalton> rust offers safety which C++ can never have
[19:09:24] <benh> eholk: I wouldn't be surprised if some of the haskell type system wizards came up with some really frightening contraptions if left alone in a garage with some stacks of roller blades and duct tape
[19:09:24] <strcat> eholk: rust has safe references
[19:09:43] <tiffany> dependant types are beyond haskell
[19:09:57] <tiffany> you need to use a language like idris if you want them proper
[19:10:02] <pcwalton> there is no sane subset of C++ which is memory safe
[19:10:03] <benh> well yeah. building frightening contraptions out of tanks is trivial.
[19:10:05] <pcwalton> and they cannot retrofit it in
[19:10:14] <pcwalton> things like the "this" pointer being T *
[19:10:43] <tiffany> well, going by that analogy, wouldn't every single paper on monadic approaches to things be frightening contraptions made of duct tape and roller blades?
[19:10:49] *** Joins: Ferreus (ferreus@moz-8DAB397A.pools.arcor-ip.net)
[19:10:59] <strcat> pcwalton: yeah, and a pure separation of safety/unsafety is compelling
[19:11:13] <strcat> but it's not the only thing that matters
[19:11:17] <pcwalton> to you maybe
[19:11:37] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[19:12:02] <pcwalton> for some applications it's essential that we be able to build safe trusted computing bases
[19:12:12] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[19:12:26] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[19:12:33] <tjc> tiffany: I don't think so, necessarily... except for the IO monad, monads aren't magical
[19:12:37] <tjc> they can be defined in a lazy language
[19:12:45] <tjc> Unless I'm missing something?
[19:12:51] <Blei> are there `extern "C" fn()`s that are safe?
[19:12:53] <pcwalton> I am not saying that rust is perfect but I think the C++ foundation is just impossible to get to where it needs to be for the secure, parallel future
[19:12:59] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[19:13:05] <tiffany> tjc: they aren't magical, it's just that they're often well suited for tasks, which is why there's so many papers about doing things monadically
[19:13:05] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:13:12] <tiffany> not well suited*
[19:13:14] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:13:15] <strcat> pcwalton: I agree that C++ is a dead end, but it doesn't mean that rust is a strict step up yet
[19:13:21] <pcwalton> ok, I agree there
[19:13:26] <pcwalton> totally in agreement
[19:13:35] <strcat> you gain a lot and you lose a lot, atm
[19:13:40] <strcat> I think you gain more
[19:13:41] <tjc> tiffany: I tend to think that those kinds of papers are less magical than, say, papers by Oleg about how to do Turing-complete things in the type class system :-)
[19:13:42] <pcwalton> I think we should look to what C++ does better and improve
[19:13:45] <tjc> But... it's kind of subjective
[19:13:46] <strcat> but the parts you lose are really frustrating
[19:13:48] <tiffany> what do you lose compared to C?
[19:13:48] <pcwalton> for example I am in agreement about allocators
[19:14:04] <benh> tiffany: '+' overloaded on pointers >:)
[19:14:06] <pcwalton> probably we do want default template type parameters
[19:14:09] <strcat> tiffany: compared to C? C doesn't have very many features :P
[19:14:16] <strcat> VLAs? ;p
[19:14:20] <tiffany> tjc: it is terrifying how people can figure out how to do computations in such odd environments
[19:14:22] <Ms2ger> C has features? :)
[19:14:29] <pcwalton> "volatile" ;)
[19:14:31] <benh> the party trick of explaining nested function pointer types without refering to cdecl ;)
[19:14:42] <tjc> tiffany: well, none of it looks odd compared to the first electronic computers :-)
[19:14:50] <tjc> when you had to write self-modifying code just to execute a for loop
[19:14:50] <benh> (don't invite me to your parties)
[19:14:51] <bstrie> pcwalton: did that patch ever land??
[19:14:59] * tjc invites benh to all future parties
[19:15:00] <pcwalton> bstrie: which patch? the one I tried to land 14 times?
[19:15:01] <pcwalton> it did :)
[19:15:04] <bstrie> huzzah
[19:15:07] <strcat> volatile, variable-length arrays, unions (enums without tags), alignas/alignof, thread_local
[19:15:38] <strcat> it depends whether you want to count GNU exts ;p
[19:15:40] <tiffany> I want to make sure that every game I make has some sort of embedded turing completeness
[19:15:52] <bstrie> tiffany: have you seen the pokemon yellow thing
[19:16:02] <tiffany> perhaps some sort of monster interaction that works as a functioning NAND gate
[19:16:07] <Blei> tiffany: just build in a buffer overflow and you're set
[19:16:11] <friggle> computed goto
[19:16:18] <friggle> (GNU extension)
[19:16:19] <strcat> now that segmented stacks are gone we could have an equivalent to VLAs via some intrinsic afaik
[19:16:19] <benh> bstrie: that's less embedded and more breaking out :)
[19:16:20] *** Quits: andre_ (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: leaving)
[19:16:33] <pcwalton> today's world is "well-funded state actors look for use-after-frees in the code I write to attack people they don't like" :(
[19:16:35] <bstrie> benh: I reject the distinction :P
[19:16:53] <pcwalton> safe languages are more important in a post-Snowden world than ever IMO
[19:17:17] <sbalmos> clearly we also need to run encryption on the motherboard
[19:17:18] <tiffany> I'd say the problem manifested quite a while before snowden
[19:17:21] <benh> bstrie: you're the guy who saw the end of the second matrix movie and figured they must be inside yet another matrix, right?
[19:17:26] *** Joins: Kruppe (user@moz-28AD3D92.net.uwaterloo.ca)
[19:17:41] <tiffany> lol
[19:17:56] <Ms2ger> benh, it all becomes obvious now...
[19:18:08] <bstrie> benh: I think all possible worlds are just a VM running in a world one level up the stack, so yes :)
[19:18:14] <tiffany> it all makes sense now
[19:18:14] <tjc> Yeah, Snowden was just the messenger
[19:18:15] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:18:39] *** Joins: nkoep (nik@moz-67D3CA1.pool.mediaways.net)
[19:18:49] <jix> btw, does rustc or llvm try to turn allocations and drops of ~ pointers that don't leave a functions scope into stack allocations?
[19:18:51] <sbalmos> bstrie: Meh, we don't like Earth. Abort the VM, restart from previously known-good snapshot
[19:18:51] <tiffany> the matrix inside the matrix was just a ploy so that the humans would live out their escape fantasies and become content with the matrix
[19:18:54] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:18:58] *** Quits: ahal (ahal@moz-7DE89BF0.cable.teksavvy.com) (Quit: Leaving)
[19:18:59] <pcwalton> jix: no
[19:19:04] <pcwalton> it might be interesting to implement in llvm
[19:19:08] <strcat> pcwalton: someone actually did
[19:19:11] <strcat> it's just not upstream yet
[19:19:13] <bstrie> sbalmos: ...oh damn, we haven't backed up since 65,000,000 BC
[19:19:14] <erickt> Blei / pcwalton: i may have missed this already being mentioned, but I thought I saw nmatsakis mention somewhere that allowing types to be parameterized by an integer, a la `foo<T, 4>` wouldn't be that hard to support and he was considering adding it. That's dependent-ish typing, isn't it?
[19:19:19] <Ms2ger> sbalmos, just make sure you survive, so I can pull that snapshot out of your brain
[19:19:19] <strcat> I don't think they were happy with how it was implemented
[19:19:31] <pcwalton> erickt: only if you squint a lot :)
[19:19:35] <jix> pcwalton: doesn't rust have additional knowledge about dataflow that could be useful ofr that?
[19:19:36] <pcwalton> it's dependent---ish.
[19:19:42] <jix> *for
[19:19:48] <pcwalton> jix: LLVM can compute the same information… if we give it to LLVM that is.
[19:19:48] <bstrie> sbalmos: remember that time that the meteor hit and we lost all our data? that was the last time anyone remembered to run the backup script
[19:19:51] <friggle> if Azul start investing in LLVM we may see lots of interesting passes upstreamed (unless they keep it all to themselves).
[19:19:54] <sbalmos> Too much talk about template templates. Head hurts.
[19:19:55] <strcat> erickt: associated constants is the same power
[19:20:02] <pcwalton> friggle: they'll upstream it if they value their sanity
[19:20:05] <strcat> erickt: because you can associate a constant, and access T::constant
[19:20:09] <pcwalton> private forks of LLVM do not end well
[19:20:13] <pcwalton> too much churn
[19:20:20] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[19:20:29] <sbalmos> bstrie: Prehistoric "last staff was fired and I inherited this network without any documentation"
[19:20:29] <friggle> pcwalton: my research project is stuck on an old LLVM version, so I'm all too familiar with this :)
[19:20:33] <jix> pcwalton: ah, that makes sense for other llvm passes too I guess
[19:20:45] <erickt> strcat: I can't wait for those too. We need more nmatsaki to implement all of his blog posts
[19:21:07] <pcwalton> btw, I have more ideas about the M:N/1:1 controversy
[19:21:11] <pcwalton> we are talking about this a lot
[19:21:31] <pnkfelix> erickt: nmataski is the plural of niko?  brillant
[19:21:39] *** Quits: fabiand (fabiand@moz-B27F8438.adsl.alicedsl.de) (Quit: Verlassend)
[19:21:40] *** Joins: sprang (sprang@moz-920A95C4.hsd1.ca.comcast.net)
[19:21:44] <erickt> pnkfelix: yep!
[19:21:53] <bstrie> pcwalton: we need a regular point/counterpoint column in TWiR where you and strcat argue about M:N
[19:22:02] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[19:22:04] <pcwalton> I'd rather not argue
[19:22:05] <strcat> scheduler.submit(task)
[19:22:07] <pcwalton> I'd rather come to common ground
[19:22:20] <tiffany> it seems like a pretty small subset of dependant typing to be able to parameterize types with constant integers
[19:22:32] <pcwalton> strcat: something like that is kind of along the lines of what I'm thinking.
[19:22:38] <strcat> scheduler.set_sched(ROUND_ROBIN); scheduler.submit(task)
[19:22:39] <pcwalton> and niko too
[19:22:40] <friggle> bstrie: going by the meeting minutes looked like pcwalton is very much trying to make sure 1:1 remains viable nd performant
[19:22:41] * strcat shrugs
[19:22:42] <Ms2ger> Why constant? :)
[19:22:52] <pcwalton> make 1:1 the default and layer M:N on top under user control
[19:22:59] <pcwalton> make M:N a kind of threading library
[19:23:00] <strcat> pcwalton: I notice you implemented something like TBB-style tasks for servo ;]
[19:23:06] <pcwalton> M:N is kinda like GC
[19:23:10] <pcwalton> you use it if you want, you don't have to
[19:23:13] <pcwalton> strcat: yeah
[19:23:30] <pcwalton> I'm guardedly optimistic about the performance numbers
[19:23:35] <tiffany> will segmented stacks make their way in as an optional thing someday too?
[19:23:59] <pcwalton> same as sequential now because of the sequential warmup.
[19:24:12] <pcwalton> but that should be fixable
[19:24:15] <pcwalton> and I hope to today if I'm lucky!
[19:24:32] <tiffany> I wonder how well an async IO API would work with rust's lifetimes and other safety features
[19:24:36] <strcat> pcwalton: it's really hard for me to see how M:N and 1:1 can coexist in a running process though
[19:24:40] <bstrie> tiffany: nginx managed to do without segmented stacks somehow, even if I do hear it's horrific...
[19:24:50] <strcat> like, does it really branch whenever you do something like lock a mutex?
[19:24:52] <benh> pcwalton: btw, did you update sprocketnes for your talk recently to compile on rust master?
[19:24:56] <pcwalton> benh: yes
[19:25:06] <pcwalton> probably you just have two kinds of mutexes
[19:25:11] <pcwalton> native mutexes and M:N mutexes
[19:25:20] <pcwalton> M:N code may be more restricted as result
[19:25:21] <pcwalton> as a result
[19:25:49] <bstrie> still haven't seen the presentations on AMO :(
[19:25:59] <strcat> 1:1 threads (joined or detached), task pools (where tasks don't have threads), task trees (or even tbb-like graphs) without stacks and something like C# async/await is my ideal library ;p
[19:26:41] <strcat> anyway async/await are only interesting on windows
[19:26:48] <benh> huh
[19:26:53] <friggle> strcat: why?
[19:26:54] <pcwalton> if you take a native mutex in your M:N code you may deadlock, so don't do that...
[19:26:57] <tiffany> I'd like 1:1 threads and a high-level libuv event loop interface
[19:26:58] <strcat> linux doesn't really use AIO
[19:27:10] <strcat> it has non-blocking sockets
[19:27:15] <pcwalton> we've never really protected against deadlock anyway
[19:27:17] <strcat> but that's ready-based, not completion-based
[19:27:30] <strcat> and for basically everything else, blocking I/O is used
[19:27:40] <tiffany> file IO is synchronous yeah
[19:29:03] <jix> nmatsakis: btw, I think monomorphization of fn foo<T>(a: &Foo<T>) to fn foo(a: &Foo<[Baz]>) taking a fat, sized reference has no inherent problems. It would require calculating field offsets using the size parameter inside the llvm IR generation, I have no idea how difficult that would be
[19:30:31] <strcat> M:N threads will perform reasonably for I/O and reasonably for CPU-bound work
[19:30:42] <strcat> but you have the low-level unfair/non-preemptive scheduling to deal with
[19:30:58] <strcat> and there will probably *still* be async I/O and stackless CPU-bound tasks
[19:31:13] <pcwalton> yes, that's why I like the "layer cake" approach
[19:31:13] <strcat> in addition to quasi-blocking I/O and blocking I/O
[19:31:24] <pcwalton> 1:1 as the default with M:N as an optional opt-in thing
[19:31:34] <pcwalton> where you make a scheduler and start it
[19:31:47] <strcat> pcwalton: but if it calls the same library code it's problematic
[19:32:02] <pcwalton> not necessarily. you can have multiple types of mutexes and TLS
[19:32:13] <pcwalton> for I/O I suspect the branch to determine whether we're in task context will not be significant
[19:32:20] <pcwalton> compared to the cost of the context switch to kernel mode
[19:32:25] *** Quits: Jackneill (Jackneill@moz-EDEDAFD9.pool.digikabel.hu) (Ping timeout)
[19:32:31] <strcat> yeah for I/O it doesn't really matter
[19:32:32] <pcwalton> it'll predict properly anyway
[19:32:34] <strcat> but for a concurrent map it will
[19:32:51] <pcwalton> the concurrent map will have to be specialized to the scheduling mode
[19:33:41] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[19:33:59] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Quit: Connection closed for inactivity)
[19:34:17] <pcwalton> I mean, that isn't that different from the situation we're in today
[19:34:21] <friggle> just need Google to cough up that usermode scheduling patchset...
[19:34:26] <pcwalton> most native libraries want 1:1
[19:34:30] <Blei> i'm doing something wrong: https://gist.github.com/Blei/7681768
[19:34:49] <pcwalton> anyway, for a concurrent map it won't be exploitable if you use it in M:N when you aren't supposed to
[19:34:53] <Blei> first invocation of rustc fails, invoking cc with exactly the printed parameters works
[19:34:55] <pcwalton> you'll just deadlock
[19:35:13] <pcwalton> and if you use an M:N concurrent map in 1:1 mode it'll fail safely
[19:35:30] * strcat finds it amusing that linux has a separate kind of mutex with undefined recursive locking and one with deadlocking on recursive locking
[19:36:05] <bstrie> Blei: weird, what if you manually put the printed parameters up in the original rustc invocation?
[19:36:21] <strcat> oh that's actually standard POSIX
[19:36:22] * pcwalton is deadlocking servo font code like crazy by sprinkling MutexArcs everywhere
[19:36:25] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Client exited)
[19:36:34] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:36:38] <pcwalton> but best to do it now for posterity
[19:36:49] <o11c> strcat: EDEADLK is *avoiding* a deadlock, not a deadlock
[19:36:51] <pcwalton> at least I'm not racing, just deadlocking :)
[19:37:10] <Blei> bstrie: same error...
[19:37:39] <strcat> o11c: This type of mutex does not detect deadlock. A thread attempting to relock this  mutex  without  first  unlocking  it shall  deadlock.
[19:37:47] <strcat> ok so maybe this man page is just written by someone trying to confuse me
[19:37:52] <strcat> what is that trying to say?
[19:37:55] <strcat> :(
[19:38:00] <pcwalton> RMS was right, GNU info superiority
[19:38:04] * pcwalton trollface
[19:38:15] <strcat> "this mutex does not deadlock, be careful though it will deadlock"
[19:38:34] <friggle> strcat: does not *detect* deadlock
[19:38:41] <strcat> friggle: ah sorry
[19:38:46] <strcat> reading comprehension failure
[19:38:52] <strcat> ;]
[19:39:13] <strcat> friggle: anyway my original point was that NORMAL deadlocks and DEFAULT is undefined
[19:39:18] <strcat> which for whatever reason amuses me
[19:39:31] <strcat> I guess it saves an atomic read?
[19:39:34] * strcat doesn't know
[19:40:00] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:40:06] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: leaving)
[19:43:24] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[19:43:35] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[19:43:45] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Quit: Leaving)
[19:44:26] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Client exited)
[19:44:33] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[19:45:31] *** Joins: Jackneill (Jackneill@moz-FEEF628B.pool.digikabel.hu)
[19:45:55] *** Quits: Ms2ger (Ms2ger@B7B2FF50.C60A97A6.F9FB0584.IP) (Quit: nn)
[19:46:54] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Quit: WeeChat 0.4.2)
[19:48:53] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[19:52:00] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[19:52:37] *** Joins: Skif (emschwar@moz-4C5BB5A8.beyondbb.com)
[19:53:00] *** Quits: vodik (simon@63AED96A.F44F49AA.D02BABA9.IP) (Quit: reboot)
[19:54:11] *** Joins: valenting (Thunderbir@95C905BA.4985FA88.FCAAE698.IP)
[19:54:15] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[19:54:18] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[19:56:26] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[19:56:42] *** Quits: eholk (eholk@moz-EA69C7A5.wavecable.com) (Ping timeout)
[19:56:58] *** Joins: g3xzh (g3xzh@moz-85224D43.red.bezeqint.net)
[19:57:06] *** Joins: eholk (eholk@moz-EA69C7A5.wavecable.com)
[19:57:49] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[20:00:11] *** Quits: robert (uid15951@moz-A42E5B7B.irccloud.com) (Quit: Connection closed for inactivity)
[20:03:59] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[20:04:01] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Ping timeout)
[20:04:35] <erickt> bstrie: the presentation would be here but the video doesn't play anything for me :( https://air.mozilla.org/sprocketnes-practical-systems-programming-in-rust/
[20:04:53] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[20:05:38] *** Joins: vodik (simon@6936F89F.9963B395.D02BABA9.IP)
[20:05:50] <erickt> hey bay area folks, would anyone be interested in giving a short or long presentation at our next meetup?
[20:06:56] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[20:07:04] <bstrie> erickt: ugh, I didn't bother searching for it, I just expected it to show up on the home page, which it never did
[20:07:33] <bstrie> but yeah, video doesn't play for me either
[20:07:35] <erickt> bstrie: I'm guessing it hasn't shown up on the front page because the video hasn't been put together yet
[20:08:36] <Luqman> erickt: any idea when?
[20:08:42] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:09:23] <erickt> Luqman: I was considering the week of 12/16, or punting to january
[20:09:46] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[20:09:59] *** Joins: nrc|afk (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:10:29] <Luqman> erickt: i'd vote for the former given i won't be around in jan :P
[20:11:31] <erickt> :) want to present something?
[20:12:21] *** Quits: vodik (simon@6936F89F.9963B395.D02BABA9.IP) (Ping timeout)
[20:16:12] *** Joins: pnkfelix1 (pnkfelix@moz-43495417.fbx.proxad.net)
[20:16:19] <erickt> Luqman: ^
[20:16:47] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[20:16:53] *** Quits: heftig (heftig@6766A975.BD9EB3D7.172227A7.IP) (Quit: Quitting)
[20:16:59] *** pnkfelix1 is now known as pnkfelix
[20:17:05] <Luqman> erickt: maybe
[20:17:42] <erickt> woo! would you be thinking long or short?
[20:17:47] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Max SendQ exceeded)
[20:17:55] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[20:18:36] *** Quits: lfox (lfox@moz-B8648F0F.nycmny.fios.verizon.net) (Quit: ZZZzzz…)
[20:18:43] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[20:19:18] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[20:20:42] *** Joins: vodik (simon@moz-FAC3965A.net.uwaterloo.ca)
[20:20:58] <sbalmos> WTF. Building master in my VM, clang++ exists, yet autoconfigure can't find it
[20:21:27] *** Joins: vmx (vmx@moz-EA3C43CD.pools.arcor-ip.net)
[20:21:48] <erickt> Luqman: ^ again :)
[20:22:31] <Luqman> erickt: sorry, a bit busy :P but probably not something too long
[20:23:26] *** Joins: sebcrozet (sebcrozet@moz-D8879CC3.w80-13.abo.wanadoo.fr)
[20:23:50] <erickt> sbalmos: you might need to run `./configure --enable-clang`
[20:24:32] *** Joins: mib_i7qhqq (Mibbit@8058E0FE.B6554CE3.28ECFBC6.IP)
[20:24:35] <erickt> Luqman: no problem, me too :) I'll put you down as a tentative
[20:25:04] <erickt> Luqman: do you have a subject area picked out you might talk about?
[20:25:25] <mib_i7qhqq> Hi guys. I'm a Haskell programmer, will it be a pain to program in functional style in Rust?
[20:25:29] *** Joins: jviereck (Adium@moz-FC52FD58.dip0.t-ipconnect.de)
[20:25:47] <cmr> mib_i7qhqq: depends on what flavor of functional you want
[20:25:55] <cmr> we're not lazy, and we don't believe in magic.
[20:26:04] <bstrie> mib_i7qhqq: we don't have monads, at least not yet
[20:26:20] <cmr> (waiting on HKT iirc)
[20:26:21] <benh> we keep removing parts of the closure mechanics too!
[20:26:32] <bstrie> benh: not removing, *enhancing* :)
[20:26:58] <eddyb> right. I should be working on the variadic stuff instead of trying to reduce the memory bloat on the compiler
[20:27:15] <eddyb> except I can barely compile rustc with that memory usage
[20:27:31] <bstrie> eddyb: you do god's work
[20:27:31] *** Joins: cscottnet (cscott@moz-2577C94A.net)
[20:27:32] <sbalmos> erickt: Thanks. Never seen that switch before
[20:27:36] <mib_i7qhqq> Well, I hope Rust's type system is powerful enough to properly implement monads, and macros can be used instead of Haskell do-notation?
[20:27:55] <bstrie> mib_i7qhqq: not powerful enough yet for monads, we're waiting on higher-kinded types
[20:28:03] <bstrie> which could be a while coming
[20:28:04] <erickt> mib_i7qhqq: our unique pointers and pointer borrowing semantics also get you many of the same safety benefits that you get with functional programming, but without having to program in a purely functional way
[20:28:06] <Yoric> bstrie: What's missing?
[20:28:15] <cmr> A do macro would be quite welcome.
[20:28:25] <Yoric> Note that I don't really see how monads would be useful in Rust.
[20:28:26] *** Parts: cscottnet (cscott@moz-2577C94A.net) ()
[20:28:32] <eddyb> bstrie: spent most of today on https://github.com/eddyb/rust/commit/04870b375ba641c6277ab7a6c9beeff20b0ee93f which I'm not sure will ever see the light of day
[20:28:36] <Yoric> (except perhaps to do some types-and-effects encoding?)
[20:28:52] <erickt> Yoric: we need higher order kinds to implement monads
[20:29:05] <Yoric> erickt: I don't quite see why.
[20:29:10] <eddyb> bstrie: it was a desperate attempt at removing some clones from the parser that resulted in refactoring a ton of code
[20:29:28] <Yoric> I'm almost sure that OCaml doesn't have them, and there are still plenty of monadic libraries in OCaml.
[20:29:32] <bstrie> eddyb: I've got a fun project for you: rewrite the parser! yaaaaay *confetti*
[20:29:43] <Yoric> Or is that necessary to get a Monad type?
[20:29:49] <friggle> erickt: and someone was volunteering to implement dependent types earlier too ;)
[20:30:01] <sbalmos> bstrie: He'll finish just in time for some other syntax-y thing to either be removed or completely redone. :D
[20:30:18] <bstrie> sbalmos: nah, that will happen long before he finishes it :)
[20:30:27] <sbalmos> true
[20:30:30] <mib_i7qhqq> It's a stylistic preference to program with monads, having them would be nice. At least higher-order kinds are planned, so there's something to hope for
[20:30:50] *** Joins: ktt3ja (Mibbit@moz-54586A12.washdc.fios.verizon.net)
[20:31:14] <erickt> Yoric: this is a bit out of my depth, but I thought ocaml monads use the ocaml module system, which is we also can't fully implement
[20:31:26] <bstrie> mib_i7qhqq: iirc they're only planned in the vaguest sense. not quite on the timeline yet
[20:31:39] <eddyb> bstrie: nah, I'll sleep for now
[20:31:59] <bstrie> eddyb: still, compiler cleanup is important if thankless work. so thanks!
[20:32:13] <erickt> eddyb: next can you clean up trans?
[20:32:15] <erickt> :D
[20:32:43] <eddyb> bstrie: strcat wouldn't like that patch, I use @ a lot
[20:33:13] <sbalmos> Wasn't it earlier today that there were dreams of removing ~ also?
[20:33:34] <benh> not removing, *enhancing* :)
[20:34:03] <sbalmos> argh
[20:35:04] <eddyb> bstrie: remind me to ping nmatsakis tomorrow, I want to know if there's anything immediate I can do about @ in the ast. now that it's immutable, we can use anything there
[20:35:09] <pnkfelix> (we should switch to a proper parser generator, not rewrite the parser)
[20:35:26] *** Joins: heftig (heftig@moz-3E56D999.dip0.t-ipconnect.de)
[20:35:29] <bstrie> eddyb: ...I can't guarantee I won't be in a food coma tomorrow
[20:35:40] <bstrie> I have two of my five thanksgivings to attend
[20:35:47] <eddyb> arena pointers are cheaper than Rc<T> but can leak
[20:35:49] *** Joins: canhtak (canhtak@moz-6F820ACE.wl.t.ulaval.ca)
[20:36:04] <cmr> eddyb: wait did you remove all @mut ?
[20:36:14] <eddyb> cmr: you missed it? the AST is now frozen
[20:36:18] <cmr> woo!
[20:36:23] * cmr has been travelling
[20:36:27] <eddyb> the changeset is really small, it wasn't required anymore
[20:36:35] <bstrie> well it's not frozen if it contains @, eh?
[20:36:43] <eddyb> @T is frozen
[20:36:47] <eddyb> @mut T isn't
[20:37:01] <cmr> frozen, not sendable though
[20:37:08] <eddyb> Rc<T> can't be dropped in easily because we're missing custom deref and borrow
[20:37:22] <bstrie> eddyb: that'll be your next priority, then :P
[20:37:24] <eddyb> arena pointers could be sendable, but you'd need to send the entire arena at once :P
[20:37:34] <cmr> eddyb: that'd be fine
[20:37:39] <eddyb> bstrie: impl nmatsakis for eddyb
[20:37:45] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[20:38:07] <eddyb> do with_sleep
[20:38:27] <bstrie> eddyb: sorry, sleep isn't a proc so that doesn't work :(
[20:38:54] <bstrie> at least, I *hope* sleep isn't a once fn
[20:39:05] <bstrie> I'm quite fond of my nightly ritual
[20:39:13] <Yoric> erickt: Well, if you want a Monad type in OCaml, you need to use modules (perhaps objects are sufficient), but if you just want a monad, you don't really need anything.
[20:39:40] <benh> i'll sleep when i'm dead. via raii.
[20:39:41] *** Joins: CarpNet (Alasdair@moz-25C796BC.cable.virginm.net)
[20:39:51] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[20:40:02] <bstrie> haha
[20:40:26] <sbalmos> eddyb: spawn eddieb { send_to_bstrie(Option<~str>) => () }
[20:40:27] <erickt> Yoric: ah, in that case, you could say our Option and Result types are monads
[20:40:49] <Yoric> erickt: I guess, yes.
[20:41:46] *** Quits: vodik (simon@moz-FAC3965A.net.uwaterloo.ca) (Connection reset by peer)
[20:41:52] <mib_i7qhqq> Sure they are monads, but there's no generic way to operate on an arbitary monad. So there can be no monad transformers.
[20:41:54] <erickt> Yoric: maybe it's the generic Monad type that we can't implement yet
[20:41:59] <friggle> erickt: just need Haskell-style do notation
[20:42:39] <bstrie> friggle: we'll make a macro to do it. but we can't use `do` to name the macro, cause that's a keyword. I propose appending an h, for Haskell
[20:42:46] *** Quits: Blei (philipp@moz-E5A7DC90.cust.bluewin.ch) (Quit: WeeChat 0.4.2)
[20:42:47] *** Quits: victorporof (victorporo@47B918E3.BCF05198.9B1E38F4.IP) (Quit: victorporof)
[20:42:48] <bstrie> so it would look like this: doh!(...)
[20:42:52] <sbalmos> LOL
[20:42:53] <friggle> bstrie: perfect
[20:43:49] <pauls> bstrie: annoyed_grunt!(...)
[20:43:56] *** Joins: pudgetta (Mibbit@moz-D9C12442.hsd1.mn.comcast.net)
[20:44:07] *** Joins: vodik (simon@moz-CFB26EB5.net.uwaterloo.ca)
[20:44:08] <mib_i7qhqq> Why not something like "chain"? Because we are chaining monadic binds.
[20:44:25] <mib_i7qhqq> or mchain, dunno, m for monad
[20:44:55] <erickt> mib_i7qhqq: we have a .and_then method that you can use for this
[20:45:07] <bstrie> whoever implements it gets to name it
[20:45:09] <bstrie> that's the rule
[20:45:28] <bstrie> so go implement something! :)
[20:45:40] <sbalmos> sounds like a sugar-high adolescent. and_then().and_then().and_then().and_then()...
[20:46:24] <mib_i7qhqq> bstrie: I was going to implement something indeed, but I am afraid I need to get more familiar with the language first
[20:46:58] <mib_i7qhqq> It's also awesome that Rust compiler is in Rust :)
[20:47:00] <erickt> bstrie: as an alternative, we could add a operator '<-' that converts the code into a .and_then call
[20:47:10] <bstrie> mib_i7qhqq: you think it's awesome now, wait until it has to compile itself three times :P
[20:47:19] <erickt> jaja
[20:47:22] <erickt> ack, haha
[20:47:33] <bstrie> oh I thought you were agreeing with me in german...
[20:47:39] <erickt> lol
[20:47:42] <erickt> that too
[20:48:18] <bstrie> mib_i7qhqq: yes, you should get more familiar with the language before blindly submitting features
[20:48:25] <mib_i7qhqq> Do you mean it takes a lot of time? That's ok, I use Gentoo, I'm used to see compile logs scroll like crazy
[20:48:45] <mib_i7qhqq> So it's still awesome.
[20:48:50] <bstrie> mib_i7qhqq: in particular we're not quite as concerned about library changes right now, we're sort of in the midst of some very invasive semantic and syntactic changes that will break all the libs anyway
[20:48:50] *** Parts: willingc (willingc@moz-B4760708.san.res.rr.com) ()
[20:49:10] <sbalmos> bstrie: heh, was about to say. I'm trying to get familiar with the language, and every other hour it's changing on me. :D
[20:50:39] <mib_i7qhqq> bstrie: can you elaborate? What direction the language is going?
[20:51:52] <mib_i7qhqq> or 'heading towards', sorry, not my native language
[20:52:09] <mib_i7qhqq> I mean English is not my nati~ ok you get it.
[20:52:24] <bstrie> mib_i7qhqq: what's your native language?
[20:52:29] <mib_i7qhqq> Russian
[20:52:39] *** Quits: tedh (tedh@moz-A5D1CAB7.public.wayport.net) (Ping timeout)
[20:52:48] <bstrie> oh cool, I don't think we have many russian contributors :)
[20:52:52] *** Joins: derek_c (derek@moz-E72F174.cit.cornell.edu)
[20:52:55] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[20:53:05] *** Joins: tedh (tedh@moz-A5D1CAB7.public.wayport.net)
[20:53:19] *** Joins: Trollinator (Trollinato@moz-7BF4BEF0.rz.uni-leipzig.de)
[20:53:31] <bstrie> mib_i7qhqq: right now we're working on enhancements to the language to make it more suitable for support user-provided smart pointers
[20:53:56] <mib_i7qhqq> Well, I hope I will become a contributor eventually.
[20:54:19] <bstrie> mib_i7qhqq: we're also making various changes to function types to try to encapsulate lots of use cases under a small number of primitives
[20:54:51] <bstrie> mib_i7qhqq: have you read the tutorial?
[20:55:59] <mib_i7qhqq> Well.... no. I read the code snippets, they are pretty easy to understand.
[20:56:19] <bstrie> mib_i7qhqq: are you familiar with C++ as well?
[20:56:22] <mib_i7qhqq> Yes.
[20:56:26] <bstrie> good
[20:57:03] <sbalmos> I'm slowly indoctrinating myself through Scala on the Java side
[20:57:11] <bstrie> I would still recommend that you go over the tutorial, just to make sure you haven't overlooked any features http://static.rust-lang.org/doc/master/tutorial.html
[20:57:41] *** Quits: pudgetta (Mibbit@moz-D9C12442.hsd1.mn.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:58:34] *** nrc|afk is now known as nrc
[20:59:40] <mib_i7qhqq> Sure, reading a tutorial is always a good idea. It's just that language spec is in flux, so I was not sure if I should wait for 1.0 version before getting to know the language
[20:59:56] <bstrie> depends on how adventurous you are :)
[21:00:48] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:01:03] <pcwalton> is Relaxed OK for atomics if we know that no other threads are accessing it?
[21:01:12] <pcwalton> it's single threaded at this time
[21:03:13] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[21:04:04] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Quit: Leaving)
[21:04:35] *** Joins: pnkfelix1 (pnkfelix@moz-43495417.fbx.proxad.net)
[21:05:04] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:05:54] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[21:07:43] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:07:43] *** ChanServ sets mode: +o tjc
[21:08:16] *** Quits: sebcrozet (sebcrozet@moz-D8879CC3.w80-13.abo.wanadoo.fr) (Ping timeout)
[21:10:04] <bstrie> nmatsakis: "the newly created Cell" I could've sworn cell's been around for a while :)
[21:12:05] <friggle> strcat: so are you currently unable to run #[test] and #[bench] on rust-core? Why?
[21:12:19] *** Joins: sebcrozet (sebcrozet@moz-F96421F3.w80-13.abo.wanadoo.fr)
[21:12:52] <cmr> friggle: test and bench use the test runner, which is in libextra, which links in libstd, and the language items conflict.
[21:15:20] <friggle> cmr: I see, thanks
[21:17:00] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[21:18:58] <sbalmos> time to just blow it up and start over. :D
[21:19:05] *** Parts: mib_i7qhqq (Mibbit@8058E0FE.B6554CE3.28ECFBC6.IP) ()
[21:20:32] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:21:50] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[21:22:26] *** Quits: mrmonday (mrmonday@moz-C7DC1A73.lin.openzula.org) (Input/output error)
[21:23:44] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[21:24:30] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:24:30] *** ChanServ sets mode: +o tjc
[21:24:33] *** Quits: eholk (eholk@moz-EA69C7A5.wavecable.com) (Quit: eholk)
[21:25:20] *** Quits: qmx (qmx@moz-B6DBCD05.qmx.me) (Ping timeout)
[21:25:27] *** Joins: mrmonday (mrmonday@moz-C7DC1A73.lin.openzula.org)
[21:26:30] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Connection reset by peer)
[21:29:03] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[21:29:19] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[21:29:50] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[21:30:39] *** Quits: Jackneill (Jackneill@moz-FEEF628B.pool.digikabel.hu) (Input/output error)
[21:31:08] *** Joins: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[21:31:09] *** Quits: rfw (rfw@moz-7D453A5B.rfw.name) (Ping timeout)
[21:31:13] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[21:31:17] *** Quits: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[21:31:23] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[21:31:23] *** Joins: boredomist (ruqs@817E9B7E.C3D4F2AA.56F40276.IP)
[21:32:20] *** Joins: bynaryshef (bynaryshef@moz-647E89A6.mem.bellsouth.net)
[21:32:45] *** Quits: pnkfelix1 (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[21:33:31] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[21:33:38] <bstrie> hahaha, people are still leaving reviews on the download page for netscape navigator
[21:33:40] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[21:33:47] <bstrie> "Netscape needs to bring a new version on line for Windows 7 and 8."
[21:33:54] <bstrie> I've got some bad news for you...
[21:33:55] *** Joins: rfw (rfw@moz-7D453A5B.rfw.name)
[21:34:41] *** Quits: mye (mye@moz-3DD128C3.dip0.t-ipconnect.de) (Ping timeout)
[21:35:42] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[21:36:05] <ChrisMorgan> The by-value self bug that was causing stack overflow for uncertain cause in rust-http and was the cause of using ~RequestWriter rather than RequestWriter appears to be fixed. Ah, good; I can scrap the sigil.
[21:36:33] <cmr> ChrisMorgan: erm... do you know when there was a fix, and if there's a testcase for it?
[21:36:55] <ChrisMorgan> cmr: no, I don't.
[21:37:30] <ChrisMorgan> It was a tricky one because some of my attempts to reduce it made it stop crashing.
[21:38:08] <cmr> mm
[21:38:46] *** Joins: bdmst (erik@moz-E73505F3.us-west-2.compute.amazonaws.com)
[21:38:52] *** Parts: boredomist (ruqs@817E9B7E.C3D4F2AA.56F40276.IP) (Leaving)
[21:39:43] <strcat> ChrisMorgan: bugpoint.
[21:39:50] *** bdmst is now known as boredomist
[21:39:56] <strcat> although I guess it wasn't an LLVM bug ;p
[21:40:00] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Ping timeout)
[21:40:09] <ChrisMorgan> strcat: even if it was, it's too late now as it's not broken any more.
[21:40:35] <cmr> ChrisMorgan: Do you have a testcase? I have a lot of rustc's, I'd like to bisect it.
[21:40:43] *** Joins: qmx (qmx@moz-B6DBCD05.qmx.me)
[21:40:52] <cmr> (ideally the testcase would be less than all of libhttp, but it's ok if it isn't)
[21:41:28] <ChrisMorgan> cmr: no, I don't—and so then you get the fun of upstream language changes causing many unrelated changes...
[21:41:45] <cmr> yeah :(
[21:41:51] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[21:42:27] *** Joins: bkircher (bkircher@moz-6D8F5B2F.adsl.alicedsl.de)
[21:43:05] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Quit: WeeChat 0.4.2)
[21:43:35] *** Quits: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net) (Ping timeout)
[21:43:48] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[21:44:02] <pcwalton> can I use the CLZ operation in rust?
[21:44:04] <pcwalton> I actually want to use it
[21:44:04] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[21:44:30] <pcwalton> oh yay, leading_zeros()
[21:44:33] <pcwalton> <3 whoever added that
[21:44:43] <bstrie> pcwalton: idea: a secret rust feature where, anytime a variable named `password` contains the string "password" at runtime, the program immediately crashes
[21:44:49] <pcwalton> cool
[21:44:51] <bstrie> just think of how many security vulns this will prohibit
[21:45:07] <pcwalton> also prohibit swordfish
[21:45:10] *** Joins: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[21:45:11] <bstrie> the movie?
[21:45:19] <FreeFull> The password
[21:45:26] <pcwalton> http://en.wikipedia.org/wiki/Swordfish_%28password%29
[21:45:46] *** Quits: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[21:45:50] <ChrisMorgan> cmr: https://github.com/chris-morgan/rust-http/commit/bb4299644d5cb88aaffb11f504b9516bbf3537ff should apply fairly cleanly to older revisions. The test case is then something like `build/examples/client http://rust-lang.org/` (sufficiently older versions of the example client won't take an argument, using http://127.0.0.1:8001; you can run one of the example servers if you'd like)
[21:45:53] *** Quits: dherman_ (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman_)
[21:46:53] <strcat> pcwalton: yeah it's an LLVM intrinsic, we also have bswap
[21:47:01] <pcwalton> yeah, I used that
[21:47:24] * strcat wonders if they fixed the sqrt intrinsic yet
[21:47:31] <pcwalton> writing the iterator for my pointer-hash-set data structure :)
[21:47:40] <pcwalton> packed, similar to Boehm GC's
[21:48:04] <friggle> strcat: what was wrong with the sqrt intrinsic?
[21:48:13] <strcat> undefined behaviour on < -0.0
[21:48:16] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:48:17] *** ChanServ sets mode: +o tjc
[21:48:20] <pcwalton> wheeee
[21:49:13] <strcat> there was some decision making stuff that can either lead to all the float intrinsics having undef behaviour or none of them having it
[21:49:20] <strcat> dunno where it went
[21:49:46] <strcat> has to do with errno ;[
[21:49:51] <pcwalton> wonder what they're going to do with JS :)
[21:49:51] <erickt> pcwalton: pointer-hash-set? Is that along the lines of judy arrays? http://judy.sourceforge.net/
[21:50:04] <pcwalton> nah, it's just a very specialized data structure for storing 16-byte-aligned pointers
[21:50:06] <pcwalton> a set of them
[21:50:17] <pcwalton> uses a hash table for the high bits and then a bit set for the low bits
[21:50:33] <friggle> pcwalton: is there any more public info on the llvm js plans? I saw the stackmap for js deoptimisation proposal
[21:50:37] <strcat> pcwalton: they could just call C ;p
[21:50:39] <pcwalton> friggle: dunno
[21:50:47] <strcat> the intrinsics are mostly for loop vectorize afaik
[21:50:59] <pcwalton> strcat: yeah, they could just not emit the intrinsics
[21:51:20] <strcat> I think someone wanted to be able to convert the C functions to the intrinsics
[21:51:23] <strcat> automatically
[21:51:25] <strcat> and that started this
[21:51:36] <bstrie> what's all this about llvm and js?
[21:51:40] <pcwalton> but will bitwise AND with zero be fast?
[21:51:50] <strcat> anyway it's a really weird problem
[21:51:54] <pcwalton> (thanks to sunspider, you can count on bitwise AND with "undefined" being fast in all browsers!)
[21:52:19] <strcat> some C libraries set errno on math errors, some use floating point exceptions
[21:52:21] <strcat> some do both
[21:52:26] <strcat> some use an unholy inconsistent mix
[21:52:39] <strcat> LLVM doesn't support floating point exceptions, so that never works
[21:52:56] <strcat> anyway, the issue with sqrt is that it *might* set errno
[21:53:07] <strcat> so if they pretend it doesn't, it could be reordered and clobber it
[21:53:10] <strcat> so they just made it undefined.
[21:53:17] <strcat> yay computing
[21:53:31] <pcwalton> yay C :P
[21:53:35] <strcat> the sane thing to do is floating point exceptions
[21:53:36] <pcwalton> and its error handling
[21:53:39] <strcat> except for the part where it doesn't work
[21:53:58] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Quit: Ex-Chat)
[21:54:04] <strcat> floats are really messed up
[21:54:11] <strcat> they have global state for exceptions and rounding mode
[21:54:20] <strcat> and it doesn't work in clang/LLVM.
[21:54:32] *** Quits: moostik (Icedove@moz-C2FFB694.w82-121.abo.wanadoo.fr) (Ping timeout)
[21:54:42] <strcat> I'm not sure if C99 actually requires it to work
[21:54:49] <pcwalton> I love how Java gets flak from William Kahan for not supporting that stuff (also for having FLT_EVAL_METHOD == 0)
[21:54:58] <pcwalton> when that's the default in C99 and most C++ on x64 too
[21:55:21] <strcat> C++ doesn't have the C99 math library in the standard afaik
[21:55:21] <pcwalton> actually in Java FLT_EVAL_METHOD = 2 I think now
[21:55:31] <pcwalton> because of Kahan's rant :P
[21:55:52] <strcat> ughhh floats
[21:55:53] *** Quits: Kruppe (user@moz-28AD3D92.net.uwaterloo.ca) (Ping timeout)
[21:56:08] <pcwalton> graydon was on the IEEE 754 committee :)
[21:56:24] <pcwalton> one of the revisions
[21:56:27] *** Quits: Ferreus (ferreus@moz-8DAB397A.pools.arcor-ip.net) (Quit: WeeChat 0.4.2)
[21:56:38] *** Quits: bynaryshef (bynaryshef@moz-647E89A6.mem.bellsouth.net) (Quit: Leaving)
[21:56:44] <strcat> sqlite4 is dropping IEEE754 float support ;p
[21:57:04] <strcat> at least it does atm but who knows what it will do on release
[21:57:16] <Luqman> ChrisMorgan: cmr: could've possibly been a result of the changes to trans::adt ?
[21:58:03] <friggle> strcat: you mean their new internal number format?
[21:58:19] <strcat> friggle: yeah, it's user-visible though
[21:58:39] <strcat> the calculations will have higher accuracy (different results) than doing it with IEEE754 math
[21:58:40] *** Quits: sebcrozet (sebcrozet@moz-F96421F3.w80-13.abo.wanadoo.fr) (Ping timeout)
[21:59:26] <strcat> which is fine, but it's a big contentious issue for compilers ;p
[22:00:41] <strcat> http://llvm.org/docs/LangRef.html#fpmath-metadata http://llvm.org/docs/LangRef.html#fastmath yay complexity
[22:01:06] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[22:01:34] <friggle> well they need to support -ffast-math for the Gentoo crowd ;)
[22:02:27] *** Quits: vodik (simon@moz-CFB26EB5.net.uwaterloo.ca) (Ping timeout)
[22:03:21] <strcat> you need fast-math even to vectorize sum on x86
[22:03:50] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[22:05:38] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[22:06:26] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[22:06:42] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[22:06:42] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[22:08:30] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[22:09:10] * ChrisMorgan just thought of something that would be good for docs: a switch to show type annotations where it's inferred
[22:10:17] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:10:23] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[22:10:29] <strcat> ChrisMorgan: rustc knows how to do that
[22:10:40] <ChrisMorgan> Yes, --pretty typed.
[22:10:57] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[22:11:12] <ChrisMorgan> My revelation is that it's something which could be convenient in docs.
[22:11:36] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:11:36] *** ChanServ sets mode: +o tjc
[22:11:36] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[22:11:39] *** Joins: dherman_ (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[22:11:45] *** Quits: nkoep (nik@moz-67D3CA1.pool.mediaways.net) (Ping timeout)
[22:13:00] <ChrisMorgan> Bah, --pretty typed is broken: with rust-http, "internal compiler error: node_id_to_type: no type for node `expr 5u (id=213)`"
[22:13:18] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[22:13:24] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[22:14:03] *** Joins: sk (sk@D45837E.856A2C6.53D8F2EA.IP)
[22:14:20] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[22:15:21] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:15:35] <ChrisMorgan> It looks to have fallen apart with the first assert_eq! it encountered.
[22:16:24] <ChrisMorgan> It writes unto "... [::std::fmt::rt::Piece<'static>, ..(5u as"
[22:17:31] <ChrisMorgan> And the minimal test case demonstrates the problem :-)
[22:17:54] *** Joins: eholk (eholk@moz-EA69C7A5.wavecable.com)
[22:18:00] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[22:20:08] <ChrisMorgan> Looks like it can't cope with [T, ..N] types.
[22:20:25] *** Quits: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net) (Quit: Jesse)
[22:20:36] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[22:20:41] *** Parts: r-A (r-a@BC4D85C9.B543C4DE.3933CC16.IP) ()
[22:21:00] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[22:21:34] <ChrisMorgan> Yes, known issue for at least five months. Sounds to me like --pretty typed should be nuked as it'll be broken for most code in use in the real world.
[22:21:40] <ChrisMorgan> (https://github.com/mozilla/rust/issues/7754)
[22:22:24] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[22:26:04] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:27:07] <cmr> I mean... that's true of the pretty printer in general :(
[22:27:14] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[22:28:08] *** Joins: nkoep (nik@moz-9CB59076.vpn.rwth-aachen.de)
[22:29:16] <ChrisMorgan> cmr: it's better than it was a month or two ago: running it on rust-http isn't leading to whoops-I-forgot-to-dedent problems and 150 characters of leading whitespace by the end of the crate.
[22:29:21] <Florob> Hmm... In wonder whether there is a nice way to stop people from changing generated files (except regenerating them on every compile)
[22:29:41] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[22:29:41] *** ChanServ sets mode: +o jdm
[22:29:44] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[22:30:21] <ChrisMorgan> Florob: what do you mean more specifically? Checking in changes to generated files without changing the generator? Or something else?
[22:30:29] <tjc> Florob: make them read-only?
[22:30:47] <Florob> ChrisMorgan, yes, without changing the generator
[22:32:30] *** Joins: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net)
[22:32:31] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:33:14] <ChrisMorgan> I can think of three immediate solutions: (1) read-only; (2) tell your version control system to ignore changes to it (hg: add to .hgignore and only explicitly commit changes, git: tell it to stop tracking changes, not sure if this works through pushes); (3) put "// THIS FILE IS AUTOMATICALLY GENERATED" after every statement and hope people notice.
[22:34:12] *** Quits: jstevans (Instantbir@moz-8DBF3BC4.washdc.fios.verizon.net) (Ping timeout)
[22:34:33] <Florob> FWIW, I am actually talking about Rust and unicode.rs here.
[22:34:52] *** Quits: CarpNet (Alasdair@moz-25C796BC.cable.virginm.net) (Quit: Leaving)
[22:35:27] <ChrisMorgan> I feel the code review happening for Rust is not strict enough at present. Quite a lot of bad (or even simply non-optimal) stuff is getting in.
[22:36:02] <Luqman> ChrisMorgan: huh, --pretty typed works for me with a simple fixed size vector
[22:36:06] *** Quits: bkircher (bkircher@moz-6D8F5B2F.adsl.alicedsl.de) (Client exited)
[22:36:17] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[22:36:27] <ChrisMorgan> e.g. making changes to the grammar? You shall not pass until you've updated the reference manual and the syntax files for at least Vim and Emacs, probably others.
[22:36:48] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:36:48] *** ChanServ sets mode: +o tjc
[22:37:12] <ChrisMorgan> Luqman: `echo 'fn main() { assert!(true); }' | rustc - --pretty typed` fails for me.
[22:37:32] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[22:38:19] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[22:38:45] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[22:39:11] <ChrisMorgan> Luqman: also things like `[()]`, despite being [(), ..1], do not fail; but write the type explicitly, like `fn main() { let _v: [(), ..1] = [()]; }`, and it will fail.
[22:39:27] *** Joins: Jesse (jruderman@moz-5973C6FA.oc.oc.cox.net)
[22:39:46] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[22:40:23] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[22:40:23] *** ChanServ sets mode: +ao pcwalton pcwalton
[22:40:46] <Luqman> ChrisMorgan: ah, it fails when you write it as a type, not value
[22:40:54] <ChrisMorgan> Correct.
[22:41:14] *** Joins: SingingBoyo (brandon@moz-4D18776E.ubcsecure.wireless.ubc.ca)
[22:41:23] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[22:43:37] <pcwalton> where did sort() go
[22:43:41] <ChrisMorgan> Luqman: I've added a comment clarifying that in #7754.
[22:43:59] <ChrisMorgan> pcwalton: extra::sort?
[22:44:02] <pcwalton> oh, extra
[22:44:32] * ChrisMorgan spun up Vim and ran `:ts sort` to find that out. Tags are great to have.
[22:45:08] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Quit: ZNC - http://znc.sourceforge.net)
[22:45:11] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Input/output error)
[22:45:18] *** Quits: StarLight (StarLight@moz-DC170A3A.pppoe.avangarddsl.ru) (Ping timeout)
[22:46:23] <Luqman> ChrisMorgan: oh, what do you use to generate the tags?
[22:46:30] <ChrisMorgan> Luqman: `make TAGS.vi`
[22:47:02] <ChrisMorgan> (There's also TAGS.emacs.)
[22:47:43] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[22:49:07] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[22:49:10] *** Joins: Sgeo (quassel@moz-D0F30617.dyn.optonline.net)
[22:49:41] *** Joins: StarLight (StarLight@moz-32C34D9F.dynamic.avangarddsl.ru)
[22:49:44] * ChrisMorgan will post about tags to r/rust; most don't seem to know about them
[22:50:02] * pcwalton is sad that the easiest way to sort a vector is still extra::sort::quick_sort3 :(
[22:50:36] *** flaper87 is now known as flaper87|afk
[22:50:38] *** Quits: derek_c (derek@moz-E72F174.cit.cornell.edu) (Ping timeout)
[22:50:55] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[22:51:55] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[22:52:01] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[22:52:16] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:54:15] *** Quits: SingingBoyo (brandon@moz-4D18776E.ubcsecure.wireless.ubc.ca) (Ping timeout)
[22:56:10] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:56:27] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0a2/20131127004001])
[22:57:38] *** Joins: SingingBoyo (brandon@moz-4D18776E.ubcsecure.wireless.ubc.ca)
[22:59:21] *** Joins: bkircher (bkircher@moz-6D8F5B2F.adsl.alicedsl.de)
[23:02:47] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:03:21] *** Joins: mib_ddkz71 (Mibbit@95879FC5.102D9800.D35A31DF.IP)
[23:03:57] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:04:02] *** Joins: dbaupp (Thunderbir@898216D2.D5A1DCF.37681C44.IP)
[23:05:20] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[23:05:42] <mib_ddkz71> hello
[23:05:42] <mib_ddkz71> are there any plans to add timeouts to Reader::read(buf) ?
[23:05:42] <mib_ddkz71> or some facility for doing that?
[23:05:42] <mib_ddkz71> or at least, for tcp streams?
[23:05:53] <sam113101> 08H03E09L10L11O 02T12O 06E13V05E04R07Y08O03N09E
[23:06:18] *** Quits: nkoep (nik@moz-9CB59076.vpn.rwth-aachen.de) (Ping timeout)
[23:07:51] *** Quits: eholk (eholk@moz-EA69C7A5.wavecable.com) (Ping timeout)
[23:07:56] <mib_ddkz71> or, failing that, I wouldn't even need that if I could select() or readers as well as ports
[23:08:28] <mib_ddkz71> (but I'd imagine that a timeout of read(buf) would be useful in general)
[23:08:28] <mib_ddkz71> e.g. read(buf, millis) or something
[23:08:48] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[23:08:57] <sam113101> test
[23:10:09] *** Joins: btipling (btipling@moz-D51E0AEB.xen.prgmr.com)
[23:10:23] <ChrisMorgan> mib_ddkz71: the tools aren't there for doing a good job of such things, but the task model makes it much more bearable; the idiomatic way to do such things tends to be to spawn a task for each connection.
[23:10:36] *** Joins: eholk (eholk@moz-EA69C7A5.wavecable.com)
[23:10:41] <eholk> i'm getting errors saying my arguments to do have non-procedure type. How do I make a procedure?
[23:11:51] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[23:11:59] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[23:12:03] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Quit: ZNC - http://znc.sourceforge.net)
[23:12:07] <cmr> eholk: proc(args) { ... }
[23:12:13] *** Quits: dbaupp (Thunderbir@898216D2.D5A1DCF.37681C44.IP) (Ping timeout)
[23:13:04] <cmr> although, with do, it should just-work
[23:13:06] <cmr> Oh!
[23:13:23] <ChrisMorgan> eholk: or in the case of do, it's just `do x { ... }`, same as always
[23:13:26] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[23:13:38] <cmr> Your function signature is like `fn foo(x: ||)` (or `fn foo(x: &fn)`), it needs to be `fn foo(x: proc())`
[23:13:42] <eholk> oh, do used to be `do |x| { ... }`
[23:13:44] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[23:13:52] <cmr> do still is that
[23:13:53] *** Joins: btipling (btipling@moz-D51E0AEB.xen.prgmr.com)
[23:13:53] <mib_ddkz71> chrismorgan: hmm, it's not a multi-connection issue, I have a task which needs to select between reading instructions from a port, and reading data from a TcpStream
[23:13:59] <ChrisMorgan> `do x { ... }`, `do x |y| { ... }`, etc.
[23:14:17] <eholk> oh, right..
[23:14:20] <cmr> `do` now only works on procs, not all closures.
[23:14:51] <mib_ddkz71> chrismorgan: because select() only works on ports, I've split out another task to read from the tcpstream and send the values over a pipe to the select-ing task
[23:14:59] *** Joins: mcarberry (mcarberry@moz-BE1C9F3F.lightspeed.frokca.sbcglobal.net)
[23:15:06] <ChrisMorgan> Yes, that's the workaround that I've intended to use should I need such a thing.
[23:15:11] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:15:32] *** Quits: bkircher (bkircher@moz-6D8F5B2F.adsl.alicedsl.de) (Quit: Leaving...)
[23:16:08] <ChrisMorgan> I think we should have such a thing in the standard library, or else get on and implement Select for TcpStream.
[23:16:11] <Luqman> mib_ddkz71: afaik, i think the plan is to allow selecting on Readers. acrichto could better speak to that though
[23:16:33] <eholk> so it seems like I wrote `do x |y| { ... }` and it's turning into a closure instead of a proc...
[23:16:35] <ChrisMorgan> acrichto: which do you reckon is the wiser path? I hope it is feasible to implement Select for TcpStream?
[23:16:39] *** Quits: mcarberry (mcarberry@moz-BE1C9F3F.lightspeed.frokca.sbcglobal.net) (Quit: Leaving)
[23:16:45] *** Joins: mcarberry (mcarberry@moz-BE1C9F3F.lightspeed.frokca.sbcglobal.net)
[23:16:57] <mib_ddkz71> but that task needs to write to the socket as well, so I have to share this TcpStream between two tasks
[23:17:29] <ChrisMorgan> You're running into the same conceptual problems I've been having with rust-http. They're known, just not fixed yet.
[23:19:20] <mib_ddkz71> so I'm doing that with a MutexArc
[23:19:20] <mib_ddkz71> problem is, that the task reading from the TcpStream will just sit there blocking on read(buf) while holding the mutex
[23:19:20] <mib_ddkz71> so I can't access it from the other string
[23:19:20] <mib_ddkz71> s/string/stream/
[23:19:20] <mib_ddkz71> ideal soln for me would be to have select() work on readers too, but failing that, a read timeout for tcp streams would work
[23:20:57] <mib_ddkz71> ooh, okay, how do you work around them?
[23:20:58] <ChrisMorgan> acrichto and I were discussing splitting the TcpStream into a reader and a writer some time back. (That is, me suggesting it, he considering it. I doubt I'd get to implementing it myself any time soon.)
[23:21:38] *** Quits: peterdn (chatzilla@moz-6C268C7F.as13285.net) (Ping timeout)
[23:21:59] <mib_ddkz71> that would work too, as long as closing the writer would cause an pending read to fail
[23:22:57] <ChrisMorgan> I presume it would make it return None.
[23:23:54] *** Quits: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net) (Ping timeout)
[23:24:22] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Ping timeout)
[23:24:31] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[23:24:31] *** ChanServ sets mode: +o jdm
[23:24:55] <mib_ddkz71> hmm, actually that mightn't be necessary... not sure
[23:24:55] <mib_ddkz71> in the meantime, do you know of another way of doing this?
[23:25:04] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Quit: Savago)
[23:25:07] *** Joins: nkoep (nik@moz-67D3CA1.pool.mediaways.net)
[23:26:18] *** Joins: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net)
[23:27:02] <mib_ddkz71> sigalarm, perhaps?
[23:28:18] <mib_ddkz71> okay, I'll have to mull over this, not sure if I can do what I need in rust as it stands
[23:31:26] *** Quits: gazoombo (sid6629@moz-E77DEB21.irccloud.com) (Ping timeout)
[23:32:37] *** Joins: gazoombo (sid6629@moz-E77DEB21.irccloud.com)
[23:33:10] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[23:33:27] *** Quits: mib_ddkz71 (Mibbit@95879FC5.102D9800.D35A31DF.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:33:59] *** dherman_ is now known as dherman
[23:35:37] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:38:30] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[23:41:59] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[23:43:10] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[23:43:30] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:45:06] *** Quits: paulproteus (quassel@199.199.210.158) (Ping timeout)
[23:45:09] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[23:46:12] *** Quits: jviereck (Adium@moz-FC52FD58.dip0.t-ipconnect.de) (Quit: Leaving.)
[23:46:22] *** Quits: SingingBoyo (brandon@moz-4D18776E.ubcsecure.wireless.ubc.ca) (Ping timeout)
[23:46:23] *** Joins: dbaupp (Thunderbir@898216D2.D5A1DCF.37681C44.IP)
[23:46:24] *** Joins: paulproteus (quassel@458FE134.3EC36C88.CBDCF1DC.IP)
[23:49:47] *** Quits: Skif (emschwar@moz-4C5BB5A8.beyondbb.com) (Client exited)
[23:55:20] *** Joins: lerc (quassel@1025964E.9BA67FF7.788638A4.IP)
[23:56:17] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[23:56:46] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[23:59:32] *** Quits: myname (myname@F6BC1CBC.2C5F047.A0197E77.IP) (Ping timeout)
