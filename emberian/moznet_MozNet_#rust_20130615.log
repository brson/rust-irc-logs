[00:00:56] <Eridius> there's no syntax in match for specifying a range, e.g. 'a'..'z', is there?
[00:01:06] <strcat> there is
[00:01:24] <Eridius> what is it?
[00:01:36] <strcat> pretty sure you did it right there
[00:01:39] <Eridius> hah
[00:01:50] <Eridius> rusti: match 'c' { 'a'..'z' => true, _ => false }
[00:01:51] -rusti- true
[00:01:54] <Eridius> nice
[00:02:22] <sp3d> that's slick
[00:03:10] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[00:03:12] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[00:03:35] <SiegeLord> I wonder if one can get pandoc to generate little anchor thingies next to each heading
[00:03:52] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[00:06:00] <erickt> cmr / brson: I updated https://github.com/mozilla/rust/issues/7136, and added a simple pull request add a fixme in https://github.com/mozilla/rust/pull/7137
[00:06:22] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (No route to host)
[00:06:26] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[00:06:29] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[00:08:42] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[00:09:23] <strcat> pretty close to giving up and just reimplementing ~ ;\
[00:09:52] <strcat> can add an attribute to omit the drop flag and zero the struct instead (need it for extra::rc anyway)
[00:10:36] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[00:10:36] *** ChanServ sets mode: +o pcwalton
[00:10:51] * strcat has absolutely no idea where trans is generating reads of this stuff
[00:11:02] <Eridius> rusti: 'c'.to_str()
[00:11:05] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VXUS
[00:11:10] <Eridius> rusti: '3'.to_int()
[00:11:11] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/JQaL
[00:11:44] <pcwalton> yeah, I'm confused as to why LLVM cannot SROA our closure types away
[00:11:52] <pcwalton> that seems like fixable
[00:11:57] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[00:12:04] <Eridius> rusti: 0 + 2u8
[00:12:04] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[00:12:06] -rusti- 2
[00:12:07] <Eridius> rusti: 0u + 2u8
[00:12:08] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VPGV
[00:12:35] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[00:12:38] <strcat> pcwalton: I think we need to start marking the function ptr as llvm.invariant so we trigger devirtualization
[00:12:50] <pcwalton> oh ho
[00:12:53] <pcwalton> yes, let's :)
[00:13:01] <pcwalton> that is the kind of thing that could have large perf implications.
[00:17:07] <strcat> pcwalton: there's definitely a lot of stuff relying on the exchange alloc headers :(
[00:17:28] <pcwalton> strcat: it would be nice to make a list of what is relying on it
[00:18:10] <Eridius> rusti: match (1,'c') { (x, 'a'..'z') => true, _ => false }
[00:18:11] -rusti- true
[00:18:13] <Eridius> whoa
[00:18:42] <Eridius> rusti: match (1,'c') { (x, 'a'|'c'|'e') => true, _ => false }
[00:18:42] <aatch> Eridius, why wouldn't that work?
[00:18:43] -rusti- <anon>:10:32: 10:33 error: expected `)` but found `|`
[00:18:43] -rusti- <anon>:10          match (1,'c') { (x, 'a'|'c'|'e') => true, _ => false }
[00:18:43] -rusti-                                           ^
[00:18:43] -rusti- application terminated with error code 101
[00:18:51] <Eridius> aatch: a range inside a tuple?
[00:19:10] <aatch> Eridius, yeah. it's a pattern.
[00:19:10] <Eridius> because I don't know how ranges are represented in the syntax here
[00:19:17] *** Joins: joelteon (joel@moz-317E8D0C.io)
[00:19:25] <aatch> ranges are a refutable pattern.
[00:19:44] *** Quits: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: eatkinson)
[00:22:10] <strcat> pcwalton: well the annihilator seems to read exchange alloc (*not* managed ~) headers
[00:22:20] <strcat> the tydesc
[00:22:31] <strcat> and trans is reading them in drop glue
[00:22:33] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[00:22:39] <strcat> also when it duplicates them, but that was easy to remove
[00:22:46] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[00:22:50] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[00:22:53] <strcat> trans reads ref_count
[00:23:02] <strcat> (as in generated glue code)
[00:23:21] <strcat> the drop glue is really hard to wrap my head around
[00:23:24] <Eridius> is there any way to bind a variable to a pattern? e.g. if I have (int,char) I want a variable bound to the char if it matches 'a'..'z'
[00:23:39] <Eridius> in Haskell I'd use x@pattern
[00:23:51] <Eridius> (if I'm recalling Haskell correctly)
[00:23:55] <pcwalton> Eridius: x@pattern :)
[00:24:01] <Eridius> hahahah
[00:24:21] <Eridius> rusti: match (1,2) { (1, c@0..9) => c, _ => -1 }
[00:24:22] -rusti- 2
[00:24:24] <Eridius> whoaaaa
[00:24:26] <Eridius> <3 rust
[00:25:03] <sp3d> wow
[00:25:04] <strcat> pcwalton: it's nearly impossible to test because I can't just make test cases..... the compiler isn't going to work
[00:25:17] <strcat> strcat@thinktank i ~ master % ~/projects/rust/x86_64-unknown-linux-gnu/stage1/bin/rustc foo.rs
[00:25:18] <strcat> foo.rs:2:8: 2:9 warning: unused variable: `x` [-W unused-variable (default)]
[00:25:20] <strcat> foo.rs:2     let x = @5;
[00:25:22] <strcat>                  ^
[00:25:24] <strcat> zsh: segmentation fault  ~/projects/rust/x86_64-unknown-linux-gnu/stage1/bin/rustc foo.rs
[00:25:26] <strcat> so yeah, I don't know where to start
[00:25:45] <pcwalton> strcat: you can make check-stage1
[00:26:04] <pcwalton> oh hmm, that's stage1?
[00:26:06] <strcat> pcwalton: the stage1 compiler uses the altered libs though
[00:26:08] <strcat> pcwalton: yeah
[00:26:22] <pcwalton> if it's just a library alteration you could put it behind an env var or something
[00:26:40] <strcat> true, I could just build libstd separately and swap it out
[00:26:47] <strcat> for the binary itself
[00:26:56] <pcwalton> that too
[00:27:11] <strcat> I want to just identify the language features depending on it at a high level so I can figure out where it goes wrong in glue
[00:27:18] <pcwalton> right
[00:27:35] * strcat tries that
[00:29:47] *** Joins: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:29:50] *** Quits: dimension (dimension@moz-4CCD79C5.dsl.dynamic.simnet.is) (Quit: Leaving)
[00:32:20] <steven_is_false> Does rust support cross compiling from Linux to Windows?
[00:37:13] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[00:38:24] *** Joins: josh (josh@52A1524D.4E7EDEC9.632B8C24.IP)
[00:38:37] <steven_is_false> So changing the target to for example i586-pc-mingw32msvc, and compiling on a different computer complains because there is no standard library built for that target.
[00:38:53] <steven_is_false> How can I rebuild a version of the standard library for a different target?
[00:40:07] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[00:41:10] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[00:42:19] <pcwalton> steven_is_false: there is some cross compiling stuff in the makefiles but I don't really know how to use it, brson wrote it
[00:42:31] <steven_is_false> pcwalton: Okay.
[00:43:22] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:44:04] <doener> strcat: hm, what did you change about the ref_count field? Just changing the -1 assignment to 0 seems not to make any difference
[00:44:27] <strcat> doener: I stopped initializing it so valgrind would show undef reads
[00:44:28] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[00:44:38] <strcat> (although it caused a segfault)
[00:45:02] *** Quits: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: eatkinson)
[00:45:08] <strcat> and removing the tydesc causes a different segfault
[00:45:41] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[00:45:41] <brson> steven_is_false: use the --target-triple flag to ./configure
[00:46:05] <brson> steven_is_false: i don't recognize that triple though, not sure what you are doing
[00:46:07] <steven_is_false> brson: So I have to build a whole new compiler to do so?
[00:46:17] <strcat> middle/trans/uniq.rs reads the tydesc to copy it but I don't know where else it gets used
[00:46:17] <brson> steven_is_false: no, you need to build a whole new library
[00:46:37] <brson> well, building cross libraries is part of the build process, so yes
[00:46:45] <brson> you need to rebuild the compiler if you need to support multiple targets
[00:47:53] <brson> but, again I have no idea what you are doing
[00:48:15] <steven_is_false> brson: Okay, so I'll just do in build/rust-i686-mingw32msvc/  ../../src/configure --prefix=~/.local --target=i686-mingw32msvc ?
[00:49:06] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[00:50:13] <steven_is_false> The option target isn't recognized by the configure script
[00:50:19] <brson> oh, you are cross-compiling from linux to windows. it's not going to work, but if it did you would, on linux configure like `../configure --host-triple=x86_64-unknown-linux-gnu --target-triples=x86_64-unknown-linux-gnu,i686-mingw32msvc`, which is longhand for `../configure --target-triples=i686-mingw32msvc`
[00:50:43] <brson> *--host-triples
[00:50:46] <steven_is_false> brson: Okay.
[00:51:11] <steven_is_false> brson: All though It's not going to work I'm curious, why wouldn't it?
[00:51:43] *** Joins: moonchrome (moonchrome@moz-CF32A561.dsl.iskon.hr)
[00:51:48] *** Parts: moonchrome (moonchrome@moz-CF32A561.dsl.iskon.hr) (Leaving)
[00:52:17] <brson> steven_is_false: the makefiles are not set up to understand a wine-based toolchain yet
[00:52:25] <steven_is_false> brson: Fair enough.
[00:52:37] <steven_is_false> brson: I was actually hoping to make some progress in that area.
[00:52:39] <brson> every cross-compile scenario basically needs its own explicit makefile support
[00:52:54] <steven_is_false> brson: Will rust pkg help with any of this?
[00:53:16] <doener> strcat: IIRC malloc needs it
[00:53:39] <strcat> doener: hrm?
[00:54:36] <doener> strcat: local_malloc gets a pointer to the typedesc
[00:54:40] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[00:55:41] <strcat> I'm talking about removing it from the exchange alloc header though
[00:56:02] <strcat> nothing should need that at runtime
[00:56:07] <brson> steven_is_false: yes, in that writing Rust is way more fun than writing Makefiles
[00:56:18] <steven_is_false> brson: okay
[00:57:33] <doener> strcat: it's read from the box in make_opaque_cbox_take_glue
[00:59:17] <doener> OTOH, that's just for ~fn, not ~int... hrm
[00:59:36] <strcat> does ~fn call exchange_alloc though?
[00:59:46] <strcat> that could be one of several issues
[01:00:17] <strcat> is ~fn... actually supposed to be copyable?
[01:00:20] <strcat> why does it have take glue?
[01:00:32] <doener> it's reading the typedesc there to pass it to exchange_malloc
[01:01:08] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[01:01:27] <strcat> it's fine that stuff is passing it to exchange_alloc, just not that it's reading from the box
[01:02:27] <doener> I meant to say: Yes, it calls exchange_malloc
[01:03:48] *** Joins: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net)
[01:04:30] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[01:04:52] <strcat> bblum: is ~fn really supposed to be copyable?
[01:04:55] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[01:05:00] <bblum> strcat: ~fn:Copy is
[01:05:07] <bblum> i have a local branch in which it is
[01:05:19] *** Quits: eatkinson (eatkinson@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: eatkinson)
[01:05:32] <bblum> i also have a patch in my git stash which makes &fn noncopyable... and breaks everything
[01:05:52] <strcat> I guess ~fn needs to be rewritten a bit...
[01:06:26] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[01:06:42] <strcat> needs to store the size in the allocation and stop using the header, but I don't think this is what causes the issues
[01:08:46] <strcat> well that's great, closures are totally dependent on the headers existing >.<
[01:09:12] <strcat> it also makes them get aligned properly and it's assumed to be the layout everywhere
[01:09:33] <pcwalton> ~fn is getting rewritten
[01:09:53] <bblum> ~fn is getting killed, more like
[01:09:58] <bblum> ( :( )
[01:10:04] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.1)
[01:10:11] *** Joins: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de)
[01:10:46] <strcat> really seems like the path of least resistance is adding an attribute to omit the drop flag and reimplementing a unique ptr as a library type
[01:11:21] <strcat> already trivial to do but it's 16-bytes instead of 8
[01:11:26] *** Quits: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de) (Client exited)
[01:11:31] <strcat> + no way to call local_alloc only for managed things
[01:11:57] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[01:12:45] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[01:12:57] *** Joins: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de)
[01:14:18] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[01:14:34] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[01:15:09] *** Joins: rubber-duck (rubber-duc@moz-CF32A561.dsl.iskon.hr)
[01:15:18] *** Joins: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net)
[01:18:14] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Input/output error)
[01:18:16] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Ping timeout)
[01:22:06] *** Parts: ecr (ereed@2557E599.66715431.D25A875A.IP) ()
[01:23:36] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[01:24:59] <graydon> brson: you around?
[01:26:20] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[01:27:48] <brson> graydon: yes
[01:27:56] <graydon> getting closer :)
[01:28:17] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[01:28:21] <brson> what have you discovered?
[01:29:50] *** Joins: mixi (mixi@moz-DBD8904A.org)
[01:30:36] <graydon> brson: https://gist.github.com/graydon/1014ead4b566f8822d02
[01:31:19] <graydon> I think it's generating bad 64bit ops on 32bit. or else our implementation of 'as' is damaging the value, or something.
[01:31:35] <steven_is_false> brson: I got annoyed that rust-sdl/src/start.rs was giving me unused import errors so I refactored it. I don't have a mac though so I don't know if it works there. Does this look good http://pastebin.mozilla.org/2525699?
[01:32:11] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[01:33:08] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[01:34:09] <brson> steven_is_false: yes, that looks great
[01:34:19] <graydon> also note: on 32bit opt it generates a 32bit compare against 0xfffffffe and does jne
[01:34:23] <graydon> which is surprising!
[01:34:23] <steven_is_false> brson: Okay, I'll send a pull request in a bit.
[01:34:47] <graydon> (a) why is it doing a 32bit compare? how does LLVM even do 64bit-on-32bit? I don't know
[01:36:40] *** Quits: xenocons (otk@moz-C675529E.members.linode.com) (Ping timeout)
[01:37:05] <graydon> (b) why jne against 0xfffffffe? how is that the same as v > max? it has somehow decided that unless v has that value, it's > 0xffffffff?
[01:37:33] *** Joins: xenocons (otk@moz-C675529E.members.linode.com)
[01:37:36] <graydon> on 64bit the branch is eliminated entirely as impossible
[01:37:53] <graydon> and it succeeds if I _don't_ happen to cast v to 32bit for the sake of logging it (!)
[01:38:00] <graydon> (on 32bit)
[01:38:54] <aatch> graydon, this madness makes me feel better about not being able to figure it out myself.
[01:38:54] <graydon> this makes me think that somehow our 'as' cast-expression is translating in a way that damages the lvalue
[01:39:01] <graydon> it's very localized!
[01:39:51] <graydon> on the other hand, the fact that it only shows up when optimized makes me think it's _not_ us, but an LLVM optimizer that's getting liberal with its assumptions about arithmetic identities or maybe making a mistake
[01:40:35] <strcat> graydon: we're generating invalid IR all over the place so there's not much we can blame on LLVM
[01:40:41] <Eridius> rusti: 3.min(2)
[01:40:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/MCHA
[01:40:46] <Eridius> rusti: std::cmp::min(3,2)
[01:40:47] -rusti- 2
[01:41:01] <Eridius> rusti: 3i.min(2i)
[01:41:02] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HYOC
[01:41:03] <strcat> graydon: the optimizers are free to throw out all of our drop glue ;p
[01:41:11] <Eridius> rusti: 3i.min(&2i)
[01:41:12] -rusti- 2
[01:41:13] <Eridius> hah
[01:41:22] <aatch> graydon, actually, thats an idea. do you have a reduced test case that you can run -Z lint-llvm on?
[01:41:48] <aatch> (Otherwise you'll get spammed with unrelated things)
[01:41:50] <graydon> is that all I have to do?
[01:41:56] <graydon> that's what I'm trying for presently
[01:42:06] <aatch> graydon, run the linter?
[01:42:09] <Eridius> hmm I'm surprised there's no (~str).truncate()
[01:42:11] <graydon> yeah
[01:42:16] <graydon> I have never run the linter
[01:42:22] <strcat> graydon: yeah aatch added support for it
[01:42:23] <aatch> Yeah, it's under -Z
[01:42:26] <dbaupp> Eridius: that modifies it in-place?
[01:42:29] <Eridius> dbaupp: yeah
[01:42:40] <strcat> graydon: it's really scary :(
[01:42:41] <Eridius> I take it str::unsafe::set_len() is safe as long as the new len is <= the old len?
[01:42:51] <dbaupp> Eridius: should be
[01:43:01] <strcat> since it's essentially just warning about obvious undef behaviour
[01:43:15] <Eridius> err I mean str::raw
[01:43:22] <dbaupp> Eridius: (and as long as you don't break within a utf8 character)
[01:44:03] <Eridius> dbaupp: oh good point
[01:44:06] <Eridius> damnit
[01:44:21] <dbaupp> Eridius: s.is_char_boundary(n)
[01:44:27] <Eridius> well I should be workign with a ~[u8] anyway, so w/e
[01:47:39] <Eridius> rusti: 3.to_str()
[01:47:40] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/hOhZ
[01:47:47] <Eridius> rusti 3i.to_str()
[01:47:56] <Eridius> rusti: 3i.to_str()
[01:47:58] -rusti- ~"3"
[01:48:08] <dbaupp> Eridius: you can private message with rusti (/query rusti)
[01:48:14] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[01:48:21] <Eridius> dbaupp: :P
[01:48:27] <aatch> Also, actual rusti is actually good enough for simple stuff like that now
[01:48:33] <Eridius> really?
[01:48:49] <Eridius> actual rusti blows up on `3i.to_str()`
[01:48:56] <Eridius> same error as this rusti's 3.to_str()
[01:50:12] <dbaupp> Eridius: doesn't for me... what hash is your rust?
[01:50:15] <aatch> actual rusti seems very, very slow though. there is probably a good reason for this though.
[01:50:27] <rubber-duck> how do I set up custom lib paths so rust can find them on linux ?
[01:50:27] <graydon> heh
[01:50:29] <Eridius> dbaupp: on this machine? bec1e2f
[01:50:31] <dbaupp> aatch: good reason = running a whole compile?
[01:50:34] <Eridius> haven't rebuilt today
[01:50:36] <aatch> dbaupp, I get it too. I built today.
[01:50:42] <graydon> brson: when I print v.to_str() with %? I get 17745263472028942339, not 3
[01:50:48] <graydon> there's stuff in the high-32bits
[01:50:55] <graydon> coming back from the decode call
[01:51:11] <graydon> and somehow the polymorphic printer isn't writing it (when applied as %? to v, I get 3)
[01:51:12] <aatch> rubber-duck, you can pass -L /path/to/libs
[01:51:29] <strcat> aatch: because it spins up a JIT and compiles the entire input so far each time
[01:51:40] <dbaupp> Eridius, aatch: maybe I'm too old (da510bf)
[01:52:35] <aatch> dbaupp, eadd83d
[01:52:41] <rubber-duck> aatch, any global var I can set so I don't have to do it every time ?
[01:52:52] <dbaupp> Eridius: ok, I get it using a stage2 build from yesterday too :)
[01:53:05] <aatch> rubber-duck, what libraries are you trying to link against?
[01:53:26] <rubber-duck> aatch, glfw-rs, gl, etc.
[01:53:29] <dbaupp> rubber-duck: a make file that has the appropriate invocation of rustc?
[01:54:01] <aatch> rubber-duck, hmm, not that I am aware of. But I haven't dealt much with external libs.
[01:54:01] <rubber-duck> dbaupp, but sometimes I use rustc sometimes rust run :|
[01:54:16] <rubber-duck> ah well nvm
[01:54:23] <rubber-duck> will do
[01:54:39] <dbaupp> ah, right... rust run is a bit of a second class citizen right now
[01:55:05] <dbaupp> I guess you could have a `make run` command that builds and runs the executable
[01:55:18] <acrichto> aatch: rusti is also super slow because it parses 1 input, typecks another, and then fully compiles one more
[01:55:41] <rubber-duck> dbaupp, being a IDE guy I'm terrified of make files xD
[01:56:29] <brson> graydon: that's a surprising discovery! are you sure there's something in the high bits and %? isn't just going crazy?
[01:56:36] *** Joins: Pengoo (Jackson@moz-30109EF1.vf.shawcable.net)
[01:57:04] <graydon> not certain, but suspect
[01:57:16] <graydon> v.to_str() is calling the normal u64 converter, no?
[01:58:02] <brson> yes, but then you are printing with %?
[01:58:41] <graydon> no, also passing to %s
[01:58:50] <graydon> when I pass v.to_str() to %s I get a large number
[01:58:52] <graydon> when I pass v to %? I get 3
[01:59:04] <graydon> when I pass v and v >> 32 to %? and %?, I get 3 and a large number
[01:59:42] <graydon> and when I log the bytes coming into the io read call I get 80 88 0 0 0 0 0 0 (big-endian)
[01:59:46] <graydon> which is remarkable, since none of them are 3
[02:01:05] <graydon> oh, sorry, not offset by start, lemme retry
[02:01:39] <graydon> rust: ~"big-endian data: 0 0 0 0  0 0 0 3"
[02:01:42] <graydon> that's a better story!
[02:02:42] *** Quits: tav (tav@moz-5ED3AF3C.range86-152.btcentralplus.com) (Quit: tav)
[02:03:38] <aatch> graydon, big-endian in least-significant first, right?
[02:03:52] <graydon> most-significant first
[02:03:54] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:04:07] <graydon> big-end first :)
[02:04:08] <aatch> I always get confused.
[02:05:46] *** Quits: KindOne (KindOne@moz-28B36F1A.dynamic.ip.windstream.net) (Ping timeout)
[02:06:51] *** Quits: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net) (Client exited)
[02:07:10] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:07:45] <pcwalton> ok, I have to split apart rustc into rustmiddle and rustcodegen to get any work done
[02:08:01] <pcwalton> my usual trans time *per stage* is 2 minutes and my LLVM pass time *at -O0* is 6 minutes
[02:08:05] <pcwalton> per stage
[02:08:14] <pcwalton> I think I'm swapping
[02:08:36] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[02:09:40] <Eridius> given how vec::from_elem is considered slow right now, what's the fastest way to zero-initialize an owned vector?
[02:09:45] *** Joins: KindOne (KindOne@moz-41E05A03.dynamic.ip.windstream.net)
[02:10:17] <Eridius> or rather, initialize to a known value
[02:10:42] <strcat> making your own vector implementation, because the built-in one is slow :\
[02:10:47] <dbaupp> Eridius: https://github.com/mozilla/rust/issues/7136#issuecomment-19487811
[02:10:47] <Eridius> hah
[02:10:51] <strcat> from_elem isn't the only slow part
[02:11:01] <Eridius> ooh ptr::set_memory, neat
[02:11:04] <dbaupp> erickt: ping
[02:11:17] *** Joins: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP)
[02:11:45] <pcwalton> also heads up, I'm going to be adding a clone() method to the stdlib soon which is the same as copy() today
[02:11:53] <pcwalton> and then renaming "copy" to "__copy"
[02:11:58] <pcwalton> cheap backwards compatibility hack
[02:12:04] <pcwalton> it means that .clone() and clone() will be different for a while
[02:12:06] <pcwalton> until they merge
[02:12:31] *** Quits: zz_kimundi (kimundi@moz-CF22727E.dip0.t-ipconnect.de) (Ping timeout)
[02:12:45] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: WeeChat 0.4.1)
[02:14:21] <dbaupp> pcwalton: a clone method, or clone function?
[02:14:25] <pcwalton> function
[02:14:27] <pcwalton> well,
[02:14:29] <pcwalton> static method eventually
[02:14:38] <pcwalton> actually, it'll always be a function
[02:14:44] <pcwalton> it'll just reroute to .clone() eventually
[02:14:51] <dbaupp> different to the one on the clone trait?
[02:14:54] <pcwalton> yes
[02:15:07] <pcwalton> it'll be the same as "copy" today; i.e. only work on copyable things known to the compiler
[02:16:02] *** Joins: SiegeLord (siege@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:16:03] *** Joins: zz_kimundi (kimundi@moz-5463FFDF.dip0.t-ipconnect.de)
[02:16:20] *** zz_kimundi is now known as kimundi
[02:16:30] <strcat> pcwalton: why?
[02:16:40] <pcwalton> because I don't want to go through and remove "copy" from everything
[02:16:46] <pcwalton> all the instances of the keyword "copy"
[02:16:57] <pcwalton> maybe I should just do that...
[02:17:09] *** Quits: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de) (Ping timeout)
[02:17:11] <pcwalton> anyway when we last tried to do that bstrie rebelled and wanted to keep "copy" in the language
[02:17:38] <strcat> well I think we need to get rid of it
[02:17:42] <pcwalton> me too :)
[02:17:46] <strcat> lots of the stdlib is useless with third party types
[02:17:47] <pcwalton> it's not very useful
[02:17:50] <pcwalton> right
[02:18:04] <pcwalton> yeah, maybe it's best to just push hard on removing it
[02:18:16] <strcat> Copy, that evil drop flag, lack of a way to overload pointers, etc. :(
[02:19:13] <pcwalton> I'm beginning to think @T should just become @Gc T for both allocation and type forms
[02:19:36] <strcat> why not just Gc?
[02:19:42] <pcwalton> Gc<T>?
[02:19:44] <strcat> seems odd to make it more special than third party types
[02:19:46] <strcat> pcwalton: yes
[02:19:53] <strcat> Rc<T>, Gc<T>
[02:20:07] <pcwalton> the community overwhelmingly dispreferred that
[02:20:09] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[02:20:11] <pcwalton> everyone likes @
[02:20:14] *** Joins: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net)
[02:20:26] <pcwalton> I mean @Foo T would just be sugar for Foo<T>
[02:20:29] <pcwalton> for all Foo
[02:20:34] <strcat> pcwalton: even if @ is less widely used than Rc?
[02:20:41] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[02:20:45] <strcat> because I think to land the gc we're going to have to mass convert rustc to Rc
[02:20:45] <pcwalton> @Rc T would exist too
[02:20:55] <pcwalton> huh, really?
[02:21:05] <strcat> well it already uses 2-3GiB of memory at peak...
[02:21:14] <strcat> gc is only going to increase mem usage
[02:21:34] <strcat> even if graydon magically puts together a gc as good as the jvm's ;p
[02:21:36] <pcwalton> oh, I'm going to just split rustc into rustcodegen and rustmiddle
[02:21:37] <aatch> If it helps, I'm trying to lower the amount of @ usage in trans atm.
[02:21:44] <pcwalton> aatch: that would help a lot
[02:21:51] <graydon> incidentally, I have a change that reduces the peak a fair ways.
[02:22:06] <graydon> niko was doing something silly in the borrowck that he helped me fix
[02:22:44] <strcat> pcwalton: I think refcounting is fine, the problem is implicit copies of @
[02:22:55] <dbaupp> is bors coming back online soon?
[02:22:57] <pcwalton> yeah, I want to get rid of those :)
[02:23:00] <aatch> I have a PR open here: https://github.com/mozilla/rust/pull/7124
[02:23:01] <strcat> if Rc and Gc are going to act exactly the same, they're going to have to move
[02:23:14] <pcwalton> yeah, I think you should have to .clone() them
[02:23:17] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[02:23:26] <graydon> bors is currently disabled because brian was concerned about this auto_encode error, I think?
[02:23:35] <graydon> someone asked me to turn it off, because "tree closed" etc.
[02:23:36] <pcwalton> graydon: he xfail'd the test
[02:23:41] <graydon> oh?
[02:23:54] <graydon> shall I turn bors back on?
[02:23:56] <pcwalton> yeah
[02:24:04] <pcwalton> brson was waiting for the bots to cycle green
[02:24:25] <pcwalton> aatch: that PR is amazing, thank you
[02:24:29] <doener> graydon: what was/is that sillyness in the borrowck?
[02:24:41] <graydon> doener: pulling up the change, sec
[02:24:47] <graydon> (someone should cherry-pick it asap)
[02:25:03] <pcwalton> does that also improve time of the borrow check?
[02:25:12] <aatch> pcwalton, no idea.
[02:25:21] <pcwalton> graydon: I mean to graydon
[02:25:25] <graydon> bors re-enabled
[02:25:25] <aatch> oh, sorry.
[02:25:31] <graydon> pcwalton: not sure, haven't checked
[02:25:54] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[02:26:08] <graydon> https://github.com/graydon/rust/commit/15e80b874de88c843697b07fa5dc94f88767ec28  <-- that one chance should land on trunk, probably
[02:26:11] <graydon> it's a pure memory win
[02:26:33] <dbaupp> how much?
[02:26:46] <graydon> lots and lots of temporary huge allocations; they hurt us far too much when we keep many of them alive by gc-conservativeness. under rc, maybe they don't build up too much.
[02:27:02] <graydon> I haven't measured under rc. as you can see, it's one I fixed on the gc branch because I was trying to get bootstrap < 4gb
[02:27:03] <doener> ah, I've been looking into the same thing
[02:27:15] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[02:27:15] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d7770aa to 1438e0574: 02http://git.io/N3iJvQ
[02:27:16] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[02:27:18] <strcat> rusti: 5
[02:27:19] -rusti- 5
[02:27:22] <strcat> yay bors
[02:27:31] <graydon> feel free to cherry pick that, anyways. someone :)
[02:27:31] <doener> could also reduce the borrowck time by quite a bit. Those from_elem calls were pretty expensive
[02:27:48] <pcwalton> strcat: https://bugzilla.mozilla.org/show_bug.cgi?id=171808
[02:27:48] <graydon> yeah. it's not because from_elem was slow. it's because it was initializing _gigantic_ arrays
[02:27:54] <pcwalton> there's been a lot of work to remove AddRef() calls from mozilla
[02:27:59] <graydon> I mean, maybe from_elem was also slow, i dunno
[02:28:02] <pcwalton> dating back to 2002 if not earlier
[02:28:35] <pcwalton> we have an ugly class called already_AddRefed<T> for that
[02:28:41] <graydon> this is a common pattern in performance pain I've seen in rustc. people using vectors as maps assuming node ID ranges are dense
[02:29:01] <graydon> PSA: that is never true, or when it is, it's a coincidence best not to rely on
[02:29:01] <doener> graydon: I know, I've currently been trying to figure out why the node range is so spars
[02:29:01] <strcat> pcwalton: moving by default plays really well with refcounting though, you rarely actually have to copy
[02:29:04] <doener> e
[02:29:12] <pcwalton> strcat: yup! it's a huge win all around.
[02:29:13] <graydon> doener: macro expansion, folding
[02:29:34] <strcat> pcwalton: would be really nice if Rc and Gc could act the same way and we could just drop in the better performing type.
[02:29:39] <doener> graydon: ah, right, that happens after the initial parsing
[02:29:41] <pcwalton> strcat: I agree
[02:29:48] <pcwalton> I'd like to make Gc actually require .clone()
[02:29:51] <pcwalton> maybe too painful
[02:29:53] <pcwalton> but we should try it first
[02:30:12] <pcwalton> (and if not, we can make custom smart pointers implicitly-copyable in a generic way)
[02:31:11] <strcat> pcwalton: could hide the implicit copies behind an attribute and move over slowly ofc
[02:31:38] <strcat> implicit copies also make @mut failures easier
[02:31:41] <xenocons> rust is insane fast on linux!
[02:31:42] <pcwalton> yup
[02:32:18] <strcat> rusti: let x = (@mut 5, 2); let y = x.clone();
[02:32:19] -rusti- ()
[02:32:27] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:32:36] <Eridius> hmm, I see char::is_uppercase(), but is there anything in the standard libraries to convert between lower and uppercase?
[02:33:26] <strcat> no, not with unicode
[02:33:31] <Eridius> :/
[02:33:45] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:34:03] <Eridius> the ascii package can do it, but you need to have ~[Ascii] instead of ~[u8]
[02:34:06] <Eridius> I suppose I could transmute it
[02:34:12] <strcat> pcwalton: https://github.com/mozilla/rust/issues/7140 opened an issue about making @mut borrows require a method call already
[02:34:34] <pcwalton> strcat: I'm beginning to wonder if this is the time for Slot<T>
[02:34:40] <pcwalton> which is the old Mut<T>
[02:34:45] <pcwalton> so you can make dynamic borrows around anything
[02:34:59] <pcwalton> and then @mut vanishes
[02:35:03] <pcwalton> @Slot<Whatever>
[02:35:32] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[02:35:42] <pcwalton> that eliminates the "gotcha" factor because presumably you read the docs about the dangers of Slot before you used it ;)
[02:35:47] <strcat> imo that would be much nicer
[02:35:57] <strcat> borrowing from @mut is too easy to stumble into
[02:36:05] <pcwalton> whereas @mut is kind of like "oh hey, a mutable pointer, this looks handy"
[02:36:09] <pcwalton> and then you shoot yourself in the foot
[02:36:29] <aatch> I found a lot dynamic borrow errors when I refactored CrateContext
[02:36:40] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[02:36:46] <pcwalton> yeah, it's common
[02:36:49] <pcwalton> they pop up a lot in servo too
[02:36:49] <Jesse> is the char type supposed to be limited to things that are valid to append to strings? (e.g. excluding surrogates and/or excluding >0x10FFFF)
[02:36:59] <strcat> Jesse: it's supposed to be
[02:37:01] *** Joins: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net)
[02:37:01] <pcwalton> I don't really know how to fix it and keep Rust's low level memory model and safety
[02:37:01] <strcat> it isn't though
[02:37:01] <dbaupp> Jesse: yes, but it's not
[02:37:03] <pcwalton> however
[02:37:07] <pcwalton> we can make it more obvious
[02:37:11] <aatch> But almost always they turned out to be the same errors as statically doing borrowing.
[02:37:16] <strcat> pcwalton: I think it should just be in the library
[02:37:24] <pcwalton> yeah
[02:37:52] <pcwalton> if you have Slot<T> then you can just wrap your array or whatever inside Slot<T>
[02:38:02] <pcwalton> and then you only get dynamic borrow errors if you tried to mutate the array while it's borrowed
[02:38:08] <pcwalton> which is basically the same as Microsoft SafeSTL
[02:38:18] <strcat> imo we should just move it to a library and eventually add back a *subset* that we can prove to be safe without failing (post 1.0)
[02:38:22] <pcwalton> (but with less overhead)
[02:38:24] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:38:30] <strcat> maybe we'll come up with a better solution that works in most cases
[02:38:41] <pcwalton> +1
[02:39:01] <aatch> One of my next steps is to re-write the inst_ctxt thing so it's not implemented on @mut CrateContext, which should allow for most of the current @muts to change to &mut (or even &)
[02:39:06] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Quit: Computer has gone to sleep.)
[02:39:11] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:39:27] <pcwalton> btw, refcount bumps in trans are a huge % of trans time
[02:39:29] <pcwalton> at least 7%
[02:39:37] <pcwalton> glue overall is like 40% of trans time(!!)
[02:39:50] <strcat> pcwalton: well LLVM might like us more if it was valid IR :p
[02:40:01] <pcwalton> yes
[02:40:17] <strcat> it sometimes refuses to inline glues that are alwaysinline ;\
[02:40:27] <strcat> I think it's because the signatures + calls are invalid
[02:40:32] <aatch> pcwalton, wow, I knew it'd be a bit, but I didn't expect it to be /that/ much.
[02:40:40] <aatch> strcat, because they are...
[02:40:42] <pcwalton> yeah, my profiling dataminer
[02:40:48] <pcwalton> pulled up that surprising stat
[02:41:48] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[02:41:59] <Eridius> rusti: (~"foo").to_ascii_consume()
[02:42:01] -rusti- ~[{chr: 102}, {chr: 111}, {chr: 0}]
[02:42:04] <Eridius> yeah... that's not right
[02:42:29] <Eridius> bytes!("foo").to_owned().to_ascii_consume()
[02:42:33] <Eridius> rusti: bytes!("foo").to_owned().to_ascii_consume()
[02:42:33] -rusti- <anon>:10:22: 10:23 error: unexpected token: `.`
[02:42:34] -rusti- <anon>:10          bytes!("foo").to_owned().to_ascii_consume()
[02:42:34] -rusti-                                 ^
[02:42:34] -rusti- application terminated with error code 101
[02:42:55] <Eridius> rusti: (bytes!("foo")).to_owned().to_ascii_consume()
[02:42:56] -rusti- ~[{chr: 102}, {chr: 111}, {chr: 111}]
[02:42:59] <Eridius> well that worked
[02:43:21] <Eridius> oh ugh, it calls str::raw::pop_byte() on ~str. that's, um, weird
[02:43:45] <dbaupp> an incorrect
[02:43:46] *** Joins: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP)
[02:43:48] <dbaupp> *and
[02:43:48] * strcat thinks \0-terminated strings is the wrong optimization
[02:43:51] <steven_is_false> Is there an implementation of a concurrent stack in the standard libraries? I need it to implement stm (for the log of transactions)
[02:44:35] * pcwalton submits a 3,869-line PR
[02:45:02] <Jesse> strcat: i feel the same way about null-termination
[02:45:02] <strcat> reducing every string by 1 byte sounds more useful than making calls to bad C APIs faster ;p
[02:45:23] <strcat> a good API takes (unsigned char *, size_t)
[02:45:25] <Eridius> bad?
[02:45:55] <Eridius> strcat: in the C world that just means calling strlen(s) on your string every time, which is kinda crap
[02:46:03] <Jesse> strcat: don't forget the time spent maintaining the null byte as you append to the string. and the bustage when you have null characters IN your string.
[02:46:13] <strcat> Eridius: it doesn't
[02:46:20] <strcat> it means storing the length with the string
[02:46:25] <Eridius> which C doesn't do in general
[02:46:33] * dbaupp thinks this is RFC worthy, if it hasn't been discussed previously
[02:46:55] <strcat> Eridius: C doesn't do either "in general"
[02:47:16] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Ping timeout)
[02:47:21] <aatch> heh, C doesn't do anything "in general"
[02:47:34] <dbaupp> aatch: it does shoot feet in general
[02:47:42] <Jesse> dbaupp++
[02:48:01] <aatch> Jesse, is that the complicated version of dbaupp?
[02:48:14] * dbaupp dbaupp+1
[02:48:20] <Jesse> c--
[02:48:29] * dbaupp can't IRC correctly
[02:48:43] <dbaupp> (and one can't have a + in one's nick, apparently :( )
[02:49:12] <Jesse> + used to be a channel prefix
[02:49:46] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[02:52:21] <strcat> for one thing you want utf-8 in unsigned char.... or looking at the high bit + comparisons don't work as intended
[02:53:08] <strcat> strdup/strcpy-like things are slow
[02:53:28] <strcat> using a byte for \0 instead of a word for the size is silly
[02:53:52] <strcat> any API that's for non-text has to take unsigned char * + size_t already
[02:53:54] <heftig> strcat: heh, modified utf-8.
[02:54:05] *** Quits: KindOne (KindOne@moz-41E05A03.dynamic.ip.windstream.net) (Ping timeout)
[02:54:08] <heftig> i agree, though
[02:55:45] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[02:56:18] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[02:57:46] *** Quits: graydon (graydon@moz-9918B407.vc.shawcable.net) (Quit: Leaving.)
[02:58:00] *** Joins: KindOne (KindOne@moz-131AA3DC.dynamic.ip.windstream.net)
[02:59:18] *** Joins: jorendorff (jorendorff@moz-AF5FD687.hsd1.tn.comcast.net)
[02:59:34] *** Quits: jorendorff (jorendorff@moz-AF5FD687.hsd1.tn.comcast.net) (Quit: jorendorff)
[03:00:05] *** Quits: jga (asdf@875267B6.F8192EC3.B5524284.IP) (Ping timeout)
[03:01:23] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:01:48] *** Joins: graydon (graydon@moz-9918B407.vc.shawcable.net)
[03:01:48] *** ChanServ sets mode: +qo graydon graydon
[03:01:55] <graydon> r? someone https://github.com/mozilla/rust/pull/7146 
[03:02:02] <graydon> perf fix, nmatsakis approved :)
[03:02:08] <graydon> gotta go
[03:02:14] *** Quits: graydon (graydon@moz-9918B407.vc.shawcable.net) (Quit: Leaving.)
[03:03:30] <doener> yeah, looks like the casts on the glue calls stop llvm from inlining them
[03:04:02] <doener> adjusting the signature in the .ll and removing the cast allows "opt" to perform the inlining
[03:04:42] <strcat> doener: we should really fix all the -Z llvm-lint issues
[03:05:04] <strcat> and glue in general :(
[03:05:27] <Luqman> the glue stuff in rustc is pretty confusing
[03:07:02] <strcat> Luqman: yep I was just bashing my head against it.
[03:08:05] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:08:22] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[03:08:23] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[03:09:22] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[03:09:38] *** cscott is now known as cscottnet_away
[03:09:39] *** Joins: mindginative (mindginati@moz-D5A0DD8.dsl.dyn.ihug.co.nz)
[03:14:33] *** Joins: jga (asdf@114D2B3A.FB5B5D5.B5524284.IP)
[03:16:07] <steven_is_false> What's a good name for the log that's used to record actions in an stm implementation other than Log?
[03:16:36] <aatch> steven_is_false, ActionLog?
[03:16:46] <steven_is_false> aatch: That's good enough
[03:17:24] <aatch> Assuming there are no other logs-of-actions.
[03:20:25] *** Quits: tjc (tjc@moz-B867959A.redactedconsulting.com) (Quit: zzzzzzzzzz)
[03:22:17] *** Quits: KindOne (KindOne@moz-131AA3DC.dynamic.ip.windstream.net) (Ping timeout)
[03:24:19] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:24:20] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[03:24:21] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/OW2qcg
[03:24:21] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[03:24:25] *** Quits: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP) (Quit: (quit))
[03:25:58] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[03:26:07] <aatch> Anybody here know much about count_insn? Like why it exists?
[03:26:24] *** Joins: KindOne (KindOne@moz-16C122CC.dynamic.ip.windstream.net)
[03:26:46] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:26:59] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[03:27:06] *** Quits: sam1 (sam@moz-ADDDDFB1.mc.videotron.ca) (Ping timeout)
[03:27:32] <Luqman> aatch: for stats i assume
[03:29:01] <aatch> Yeah, but does anybody use them? I mean, if I ripped it all out because it's seriously hampering my refactoring efforts, do you think there would be much resistance?
[03:29:01] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[03:30:10] <Luqman> hmm dunno. personally i haven't used them much
[03:30:18] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:30:18] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hbtzWQ
[03:30:18] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:30:21] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:30:21] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/qJRMjQ
[03:30:21] <ghrust> 13rust/06auto 14a710e61 15Bj√∂rn Steinbrink: Add caches for method and impl metadata...
[03:30:21] <ghrust> 13rust/06auto 141104e65 15bors: auto merge of #7144 : dotdash/rust/caches, r=graydon...
[03:30:21] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:31:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:34:44] *** Quits: KindOne (KindOne@moz-16C122CC.dynamic.ip.windstream.net) (Ping timeout)
[03:34:56] *** Quits: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net) (Ping timeout)
[03:37:06] *** Joins: KindOne (KindOne@moz-4F0821DE.dynamic.ip.windstream.net)
[03:37:40] *** Quits: noct (quassel@moz-BAA6B280.com) (Ping timeout)
[03:37:57] *** Quits: redline6561 (redline656@moz-714529BD.members.linode.com) (Ping timeout)
[03:39:47] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:40:26] *** Quits: KindOne (KindOne@moz-4F0821DE.dynamic.ip.windstream.net) (Connection reset by peer)
[03:40:32] *** Joins: KindTwo (KindOne@moz-4F0821DE.dynamic.ip.windstream.net)
[03:41:03] <steven_is_false> How does one convert form a *ptr to a &ptr?
[03:41:24] *** Joins: sam1 (sam@moz-ADDDDFB1.mc.videotron.ca)
[03:42:00] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[03:42:01] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Quit: robarnold)
[03:42:16] *** KindTwo is now known as KindOne
[03:42:37] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[03:43:28] *** Joins: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net)
[03:43:38] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[03:44:59] *** Quits: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com) (Quit: jrfeenst)
[03:45:24] *** Quits: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net) (Ping timeout)
[03:45:33] <Eridius> what kind of a location is <core-macros>:77:35 ?
[03:48:03] *** Quits: RMF (RMF@moz-F8ED88D1.dsl.telepac.pt) (Ping timeout)
[03:48:11] <dbaupp> Eridius: the core macros are inserted by (basically) putting a string at the start of each module
[03:48:15] <aatch> Eridius, it's the injected macros
[03:48:18] <dbaupp> and calling this string "<core-macros>"
[03:48:35] <dbaupp> (i.e. it pretends to be a mod, sort of)
[03:48:38] <aatch> Eridius, hey, look on the bright side, before it just said 1:0 on the file.
[03:48:47] <Eridius> the error itself occurred within an assert_eq!() in a test
[03:50:23] <strcat> rusti: aa
[03:50:24] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/aPdG
[03:50:57] <strcat> rusti: aa
[03:50:59] -rusti- <anon>:10:4: 10:11 error: expected `;` but found `println`
[03:50:59] -rusti- <anon>:10     println(fmt!("%?", r))
[03:50:59] -rusti-               ^~~~~~~
[03:50:59] -rusti- application terminated with error code 101
[03:51:04] <strcat> rusti: aa
[03:51:04] -rusti- <anon>:9:15: 9:17 error: unresolved name `aa`.
[03:51:04] -rusti- <anon>:9     let r = {  aa };
[03:51:04] -rusti-                         ^~
[03:51:04] -rusti- error: aborting due to previous error
[03:51:05] -rusti- application terminated with error code 101
[03:51:05] *** concrete.mozilla.org sets mode: +M 
[03:51:18] * strcat hates that flood thing
[03:51:39] *** Joins: RMF (RMF@moz-52102471.dsl.telepac.pt)
[03:53:42] *** Quits: KindOne (KindOne@moz-4F0821DE.dynamic.ip.windstream.net) (Ping timeout)
[03:54:07] *** Joins: KindTwo (KindOne@moz-61468C50.dynamic.ip.windstream.net)
[03:54:32] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[03:55:39] <Eridius> sweet, my unsafe code caused malloc errors
[03:55:48] *** KindTwo is now known as KindOne
[03:55:49] <Eridius> I wish I could narrow down which one though
[03:56:01] *** concrete.mozilla.org sets mode: -M 
[03:56:22] <Eridius> wheeeee malloc errors
[03:56:50] *** Joins: redline6561 (redline656@moz-714529BD.members.linode.com)
[03:57:05] *** Joins: noct (quassel@moz-BAA6B280.com)
[03:57:06] <Eridius> whoa, Assertion failed: (isa<X>(Val) && "cast<Ty>() argument of incompatible type!"), function cast, file /Users/kevin/Dev/rust/rust/src/llvm/include/llvm/Support/Casting.h, line 231.
[03:57:15] <Eridius> only change I made was slapping an early return at the top of a function
[03:58:16] <Eridius> and commenting out the rest of the function fixes it. Weird that it did anything with that code since it knew it was unreachable
[03:58:21] *** Joins: KindTwo (KindOne@moz-860FE5FE.dynamic.ip.windstream.net)
[03:58:45] *** Quits: KindOne (KindOne@moz-61468C50.dynamic.ip.windstream.net) (Ping timeout)
[03:59:34] *** KindTwo is now known as KindOne
[03:59:35] *** Joins: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net)
[04:03:19] <Eridius> rusti: use std::vec; let mut v = ~[0, ..3]; println(fmt!("%u/%u", v.len(), vec::capacity(v))); vec::reserve(&v, 10); println(fmt!("%u/%u", v.len(), vec::capacity(v)));
[04:03:20] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/PcRC
[04:03:25] *** Quits: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP) (Quit: Textual IRC Client: www.textualapp.com)
[04:03:35] <Eridius> rusti: use std::vec; let mut v = ~[0, ..3]; println(fmt!("%u/%u", v.len(), vec::capacity(&v))); vec::reserve(&mut v, 10); println(fmt!("%u/%u", v.len(), vec::capacity(&v)));
[04:03:36] -rusti- 3/4
[04:03:36] -rusti- 3/10
[04:03:36] -rusti- ()
[04:03:42] <Eridius> huh. I was getting 4 in rusti
[04:04:09] *** Quits: KindOne (KindOne@moz-860FE5FE.dynamic.ip.windstream.net) (Ping timeout)
[04:04:26] <Eridius> ok rusti bug
[04:05:03] <aatch> Eridius, yeah, there are a few FP bugs.
[04:05:24] <aatch> depending on the optimizations involves, you can get the same code to produce 1, -1 or NaN
[04:05:29] <aatch> none of which are correct.
[04:05:29] <Eridius> heh
[04:05:42] <acrichto> Eridius: an LLVM upgrade fixes those problems
[04:05:54] <acrichto> although it also breaks windows...
[04:06:19] <Eridius> heh
[04:07:28] *** Joins: steven_is_false1 (steven@moz-144077DE.bchsia.telus.net)
[04:07:28] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Connection reset by peer)
[04:08:04] *** Quits: SiegeLord (siege@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[04:08:52] <tikue> anyone ever had rustc try to convince them that their file ended in unbalanced delimiters, when it's patently false?
[04:09:11] <aatch> tikue, no. And I doubt it's lying.
[04:09:46] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[04:10:49] <tikue> aatch: host-7-125:build tkuehn$ grep { ~/servo/src/components/main/compositing/resize_rate_limiter.rs | wc -l
[04:10:50] <tikue>       18
[04:10:50] <tikue> host-7-125:build tkuehn$ grep } ~/servo/src/components/main/compositing/resize_rate_limiter.rs | wc -l
[04:10:51] <tikue>       18
[04:11:05] <aatch> tikue so?
[04:11:17] <aatch> ({)} is unbalanced
[04:11:22] *** Joins: tjc (tjc@moz-B867959A.redactedconsulting.com)
[04:11:22] *** ChanServ sets mode: +o tjc
[04:12:20] <aatch> Also, that would still think that " { " ... } is balanced.
[04:12:45] <Eridius> tikue: your grep also doesn't account for multiple { or } on a single line
[04:13:19] <tikue> I realize it isn't a perfect test, but it should increase your doubt in the validity of its claim
[04:13:31] <aatch> tikue, nope.
[04:13:51] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[04:13:56] <Eridius> tikue: not in the slightest
[04:13:56] <aatch> I trust a syntax-aware compiler much more than crappy human eyes.
[04:14:09] <tikue> the thing is, I haven't modified this file.
[04:14:18] <Eridius> you sure?
[04:14:28] <tikue> I pulled it directly from the master repo
[04:15:01] <Eridius> does the test runner block RUST_LOG output?
[04:15:15] <tikue> oh wait, I did modify it, I just forgot :P
[04:17:01] <Jeaye> ^_^
[04:17:17] <Jeaye> rustc: 1, tikue: 0
[04:17:37] <tikue> no way
[04:17:46] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:17:47] <tikue> rustc: 1, tikue: ~40
[04:18:07] <Eridius> rustc: -1u, tikue: 3
[04:18:10] *** Quits: mindginative (mindginati@moz-D5A0DD8.dsl.dyn.ihug.co.nz) (Quit: zzZZZ)
[04:18:25] <tikue> rusti: -1u
[04:18:26] -rusti- 18446744073709551615
[04:18:27] <dbaupp> rusti: 1, tikue: ~40
[04:18:27] -rusti- <anon>:9:16: 9:17 error: expected `;` or `}` after expression but found `,`
[04:18:28] -rusti- <anon>:9     let r = {  1, tikue: ~40 };
[04:18:28] -rusti-                          ^
[04:18:28] -rusti- application terminated with error code 101
[04:18:45] <tikue> lol
[04:19:50] *** Quits: steven_is_false1 (steven@moz-144077DE.bchsia.telus.net) (Ping timeout)
[04:20:03] <Eridius> oh no, now you've wrapped it over to rustc: 0
[04:20:48] <dbaupp> aatch: your r key works, right? https://github.com/mozilla/rust/pull/7147
[04:21:07] <Jeaye> dbaupp: heh
[04:21:10] <dbaupp> Eridius: ^ (temporary) fix for the problem with .connect/.concat
[04:21:33] <Eridius> dbaupp: yay
[04:21:37] *** Quits: sam1 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.0)
[04:22:49] *** Joins: sam (sam@moz-ADDDDFB1.mc.videotron.ca)
[04:23:10] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[04:23:26] *** Quits: noct (quassel@moz-BAA6B280.com) (Ping timeout)
[04:23:26] *** Quits: redline6561 (redline656@moz-714529BD.members.linode.com) (Ping timeout)
[04:23:47] <aatch> dbaupp, cool, done
[04:23:59] *** Quits: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net) (Ping timeout)
[04:24:08] *** Joins: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net)
[04:25:10] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[04:25:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qJRMjQ
[04:25:10] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[04:25:50] <Eridius> woo, found my unsafe bug
[04:25:54] <Eridius> but my code still doesn't work :(
[04:26:19] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:26:46] *** Joins: noct (quassel@moz-BAA6B280.com)
[04:26:52] <dbaupp> erickt: ping
[04:27:00] <erickt> dbaupp: pong
[04:27:16] <dbaupp> for https://github.com/mozilla/rust/issues/7136#issuecomment-19487811 were you compiling with optimisations?
[04:27:28] <dbaupp> (I get 450ns vs 150ns with -O)
[04:27:45] <erickt> I was, that's not so bad
[04:27:50] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[04:27:50] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/n9UqXA
[04:27:50] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[04:27:51] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:27:51] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/8V2HuQ
[04:27:51] <ghrust> 13rust/06auto 1485a8eb8 15Graydon Hoare: rustc: map node ids through a table that ensures bitset indexes in dataflow are dense
[04:27:51] <ghrust> 13rust/06auto 14807121e 15bors: auto merge of #7146 : graydon/rust/fix-giant-borrowck-temp-buffers, r=nikomatsakis...
[04:27:52] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:27:54] <erickt> I didn't try with -O
[04:28:24] <dbaupp> ah, ok, cool. just curious about the mismatch :)
[04:28:58] <Eridius> ah hah hah, I wanted to add the number 2, but instead I added '2' as u8. silly me
[04:29:01] <aatch> erickt, there are very few optimizations run without passing -O
[04:29:12] <aatch> always_inline and instcombine I think.
[04:30:40] *** Joins: brson (brson@DA348D07.AD1E507F.3688B332.IP)
[04:30:40] *** ChanServ sets mode: +o brson
[04:30:48] <dbaupp> aatch: what's --opt-level={1,2,3} correspond to? (is 2 -O?)
[04:30:58] <strcat> dbaupp: yes
[04:31:36] <aatch> dbaupp, --opt-level=1 is pretty much the same as 2, just without a couple optmizations, and 3 turns on a few 
[04:31:45] <aatch> like loop vectorization.
[04:31:46] <strcat> dbaupp: I hate that method resolve bug ;[
[04:31:58] <erickt> dbaupp: I added a comment to that issue
[04:32:12] <erickt> I got to run now though. Thanks for the heads up
[04:32:20] *** Joins: redline6561 (redline656@moz-714529BD.members.linode.com)
[04:32:23] <strcat> aatch: I think we should rename it to --opt-time to make it clearer
[04:32:27] <dbaupp> strcat: it follows me around :(
[04:32:30] <strcat> and add --opt-size
[04:32:36] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:32:37] <Eridius> cmr: hah, my formatted string implementation for terminfo works!
[04:33:01] <dbaupp> (and make -O<n> work, like other GCC etc.)
[04:33:09] <dbaupp> Eridius: with conditionals?
[04:33:11] <aatch> strcat, yeah. First thing would be to get rustc output sane IR though.
[04:33:18] <strcat> dbaupp: they're moving away from that though
[04:33:20] <strcat> because it's unclear
[04:33:23] <Eridius> dbaupp: I implemented conditionals yesterday. waiting on review: https://github.com/mozilla/rust/pull/7133
[04:33:24] <strcat> gcc treats them differently than clang
[04:33:51] <dbaupp> strcat: oh, didn't know that. makes sense.
[04:33:52] <strcat> clang has -Os and -Oz now (corresponding to -O2 and -O3 + optsize)
[04:33:54] <Ralith> aatch: what's wrong with rustc's IR output?
[04:33:57] <strcat> gcc has -Og
[04:33:59] <strcat> so it's a mess
[04:34:00] <strcat> ;p
[04:34:15] <aatch> Ralith, it's bloated and in many cases, wrong.
[04:34:22] <Ralith> wrong how?
[04:34:23] <dbaupp> Ralith: what *isn't* wrong is probably a better question ;P
[04:34:37] <aatch> like pretty much all of glue generation is actually undefined
[04:34:37] <Ralith> geez
[04:34:49] <Ralith> what trap got hit?
[04:35:07] <Eridius> cmr, dbaupp: the format support is up at https://github.com/kballard/rust/tree/terminfo-parm-format
[04:35:10] <kemurphy> would anyone be opposed to a modification to libsyntax that annotates an item_mod with a file name if it were pulled from a different file?
[04:35:19] <Eridius> it's built on top of my terminfo-parm branch, so I guess I can't submit a PR until that one is reviewed
[04:35:30] <aatch> kemurphy, that would be nice.
[04:35:49] <aatch> Ralith, basically theres a bitcast that doesn't work.
[04:35:58] <dbaupp> kemurphy: isn't that part of codemap?
[04:36:21] <dbaupp> (i'm not particularly familiar with that part of libsyntax though.)
[04:36:28] <Ralith> aatch: nonequal bitsize? structs of unspecified alignment?
[04:36:49] <aatch> Ralith, nope, the call signature and the callee signature don't match up.
[04:36:59] <aatch> it works, but it's undefined behaviour
[04:37:01] <kemurphy> dbaupp: i'm not familiar with codemap; i've been reading the parser and ast mainly.  i'll take a look real quick
[04:37:14] <Ralith> weird, whenever I make mistakes like that LLVM just replaces it with trap
[04:37:22] <dbaupp> kemurphy: reading the parser? brave! :P
[04:37:40] <Ralith> unless it's not visible to llvm
[04:37:57] <aatch> Ralith, it's not quite the same as general undefined behaviour. It only gets picked up by the linter
[04:38:25] *** Quits: brson (brson@DA348D07.AD1E507F.3688B332.IP) (Ping timeout)
[04:39:14] <kemurphy> dbaupp: yeah, okay, span_to_filename is exactly what i want. thanks!
[04:39:32] <Ralith> I should add an automatic llvm lint pass to my compiler
[04:39:35] <dbaupp> kemurphy: np :)
[04:39:36] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[04:39:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14807121e to 141104e65: 02http://git.io/N3iJvQ
[04:39:36] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[04:39:38] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:39:39] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/Po8_7A
[04:39:39] <ghrust> 13rust/06auto 14585f5f7 15Daniel Micay: add IteratorUtil to the prelude
[04:39:39] <ghrust> 13rust/06auto 148111701 15Daniel Micay: rm ExtendedMutableIter...
[04:39:39] <ghrust> 13rust/06auto 14d68be89 15Daniel Micay: rm MutableIter...
[04:39:39] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:39:41] <Ralith> would've saved hours of pain in the past
[04:41:44] *** Joins: brson (brson@moz-6A295265.hsd1.ca.comcast.net)
[04:41:44] *** ChanServ sets mode: +o brson
[04:43:45] *** Quits: brson (brson@moz-6A295265.hsd1.ca.comcast.net) (Ping timeout)
[04:45:39] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[04:47:13] <steven_is_false>  So there are many case in the compiler where @ is used when & could be right?
[04:47:46] <aatch> steven_is_false, correct.
[04:47:58] *** Joins: brson (brson@DA348D07.AD1E507F.3688B332.IP)
[04:47:58] *** ChanServ sets mode: +o brson
[04:48:11] <steven_is_false> aatch: So for example I could just go into trans and randomly start replacing @'s with &'s?
[04:48:26] <aatch> steven_is_false, not randomly, no
[04:49:01] <steven_is_false> aatch: But I could still rip out a lot of them.
[04:49:13] <aatch> steven_is_false, yes, but I've already done that.
[04:49:41] <steven_is_false> aatch: Okay so you've got all the easy ones then, and it'd be a difficult job to get the others.
[04:50:01] <aatch> steven_is_false, yes, mostly because of borrowing.
[04:50:10] <steven_is_false> aatch: okay
[04:50:30] *** Quits: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net) (Ping timeout)
[04:52:16] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Client exited)
[04:52:26] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[04:52:44] <steven_is_false> How about the standard libraries?
[04:53:02] <aatch> steven_is_false, hmm, not sure.
[04:53:21] <aatch> If you're looking for a project, extra::rope needs re-writing.
[04:53:21] <strcat> I already rewrote most of the containers
[04:53:28] <strcat> rope needs to be thrown out
[04:53:45] <strcat> need a linked hash map (with unsafe code)
[04:53:59] <steven_is_false> strcat: Oh
[04:54:06] <dbaupp> steven_is_false: ExtCtxt in libsyntax/ext could be converted to be stack allocated and use &
[04:54:16] <dbaupp> that probably doesn't have huge gains though.
[04:54:37] <aatch> Fixing the visitor to not use boxes would be good
[04:54:43] <steven_is_false> dbaupp: I need an easy start to get to know the compiler
[04:55:07] <dbaupp> aatch: I think someone was working on visitors
[04:55:17] <aatch> dbaupp, I think that was the ast visitor
[04:55:23] <aatch> I'm talking about the tydesc one.
[04:55:33] <dbaupp> aatch: oh, ok. :)
[04:55:48] <aatch> I /think/ kimundi is working on the ast visitor.
[04:56:05] <dbaupp> steven_is_false: well, none of the @ -> & translations are going to be easy/fun
[04:56:26] <steven_is_false> dbaupp: Okay maybe I should go for something easier
[04:56:51] <aatch> Especially since a lot of code relies on various properties of @, or more commonly @mut
[04:56:56] <steven_is_false>  trace_mac: @mut bool ?
[04:57:15] <dbaupp> steven_is_false: yeah, it's as stupid as it looks :(
[04:57:17] <aatch> steven_is_false, exactly
[04:57:23] <aatch> I've also been fixing that.
[04:57:31] <steven_is_false> Is the comment by nmatsakis still true?
[04:57:46] <aatch> CrateContext no longer has a ton of @mut fields
[04:57:50] <dbaupp> steven_is_false: no
[04:57:50] <aatch> steven_is_false, which comment?
[04:57:55] <steven_is_false> That bugs make those difficult to convert for Exctxt
[04:58:37] <dbaupp> steven_is_false: but converting it to bool (as it should be) would require passing ExtCtxt as &mut (or @mut)
[04:58:54] *** Joins: rajul (quassel@A2DDF553.812B5995.2051BA92.IP)
[04:59:31] <steven_is_false> dbaupp: Why not just convert the struct to ExtCtxt_, and expose a public type Extctx = @mut Extctx_
[04:59:38] <dbaupp> steven_is_false: ExtCtxt used to be a trait object 'ext_ctxt', which is what the 'object types' refers to
[04:59:47] <steven_is_false> dbaupp: Oh
[05:00:08] <dbaupp> steven_is_false: because even that requires a big change, and if one is doing it, one might as well do it properly.
[05:00:26] <dbaupp> (i.e. not use @)
[05:00:36] <steven_is_false> dbaupp: Fair enough
[05:03:22] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[05:03:55] *** Quits: RMF (RMF@moz-52102471.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[05:04:02] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[05:06:54] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: WeeChat 0.4.1)
[05:15:32] *** Quits: madmoose (Hat@moz-E1973371.nerp.net) (Ping timeout)
[05:15:41] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[05:15:51] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[05:15:56] *** Joins: madmoose (Hat@73F3A637.B23483B.7BA20D97.IP)
[05:18:13] <rubber-duck> wait why is this closed https://github.com/mozilla/rust/pull/6661 did it land ?
[05:18:13] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[05:18:37] <steven_is_false> rubber-duck: incoming was deleted recently?
[05:18:40] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[05:19:09] <rubber-duck> oh right...
[05:19:22] <rubber-duck> got my hopes up :(
[05:23:23] <Jeaye> There's a fuzzy comparison for floats lying around in std somewhere. Anyone recall?
[05:23:28] <steven_is_false> Wow there's so many @ boxes in the compiler :p
[05:23:40] <steven_is_false> That's not what I meant
[05:23:48] <steven_is_false> :-( I meant that.
[05:25:52] *** Quits: tjc (tjc@moz-B867959A.redactedconsulting.com) (Quit: Places to go, people to annoy)
[05:25:58] <dbaupp> Jeaye: std::cmp::ApproxEq
[05:26:21] <Jeaye> Not at all what I remembered it being.
[05:26:34] <dbaupp> it used to be FuzzyEq, I think
[05:26:53] <Jeaye> Ahh, yes.
[05:27:09] <Jeaye> Thanks. :)
[05:29:04] <steven_is_false> The visitor pattern is used instead of enums in the compiler because of speed right?
[05:29:36] <steven_is_false> I had an idea to make enums faster but I never got any feedback on whether it made sense.
[05:30:41] <strcat> llvm optimizes large switches (which matches generate) really well
[05:30:43] <rubber-duck> steven_is_false, why are enums slow in contrast to visitor ?
[05:31:01] <steven_is_false> strcat: Oh, I didn't know that.
[05:31:49] <steven_is_false> rubber-duck: I don't know why. I heard that following a function pointer can be faster than jumping on a switch case
[05:32:19] <steven_is_false> strcat: So why does the compiler use the visitor pattern so heavily then?
[05:32:31] <rubber-duck> steven_is_false, that looks like a micro optimization if I've ever seen one
[05:32:33] <strcat> steven_is_false: the compiler is a great example of how not to write rust
[05:32:41] <strcat> it's very slow and poorly written
[05:32:54] <strcat> not a good place to look for modern, idiomatic or fast rust
[05:33:09] <steven_is_false> strcat: Cool, so people would be open to me rewriting some of the visitor pattern uses into enumerations?
[05:33:18] <strcat> probably
[05:33:26] <steven_is_false> strcat: Great!
[05:33:29] <strcat> it was mostly written in an ancient dialect of the language
[05:33:42] <dbaupp> steven_is_false: yeah, except I think others are working on that area at the moment
[05:33:43] <kemurphy> dbaupp: know any similar mechanism to codemap for figuring out which library an extern mod resolves to?
[05:33:55] <steven_is_false> dbaupp: Fair enough
[05:34:00] <strcat> so it was just updated to deal with actual breakage and not to make it sane/fast/modern
[05:34:18] <dbaupp> strcat: that most recent one was a work-in-progress patch
[05:34:28] <dbaupp> kemurphy: I think that happens in rustc
[05:34:40] <dbaupp> (metadata::<something> IIRC)
[05:34:48] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:35:03] <dbaupp> Although, I'd like to move that to std or something.
[05:35:36] <dbaupp> kemurphy: rustc::metadata::filesearch
[05:36:05] <kemurphy> dbaupp: ah, gotcha. thanks
[05:36:08] <dbaupp> steven_is_false: (i'm not trying to discourage you, though :( )
[05:36:15] <steven_is_false> dbaupp: okay
[05:36:26] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[05:36:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Po8_7A
[05:36:26] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[05:36:53] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[05:37:00] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[05:37:12] <dbaupp> strcat: woohoo! more external iterator goodnes/less internal badness
[05:37:37] <strcat> yep
[05:37:51] <strcat> the start of fixing vec
[05:38:15] <dbaupp> eurgh. fixing vec isn't going to be very fun at all.
[05:38:37] <dbaupp> it's like str, but 100x worse. :(
[05:39:24] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[05:39:24] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PAiVOQ
[05:39:24] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[05:39:25] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[05:39:25] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/QY8orQ
[05:39:25] <ghrust> 13rust/06auto 14f93a974 15Huon Wilson: syntax: correct the Rand::rand call to select enum variants in #[deriving(Rand)]....
[05:39:25] <ghrust> 13rust/06auto 14e6c3e4a 15Huon Wilson: syntax: revert the uint -> u32 "fix"; make the names/comment match.
[05:39:25] <ghrust> 13rust/06auto 148431e60 15Huon Wilson: xfail test on windows, because extern mod doesn't work there
[05:39:27] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[05:40:35] <strcat> huh, extern mod extra doesn't work on windows?
[05:40:37] <strcat> wat
[05:40:59] *** Joins: berak (chatzilla@7AB66452.5291F4C0.16E13E53.IP)
[05:41:42] <strcat> dbaupp: vec is... a disaster ;\
[05:42:05] <strcat> stupid ExtendedIter, I hate it
[05:42:09] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[05:43:17] <strcat> dbaupp: libsyntax/opt_vec.rs
[05:43:19] <strcat> ;\
[05:43:43] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[05:44:00] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[05:44:13] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[05:47:27] <steven_is_false> So @mut ~[T] is bad in general right?
[05:47:39] <strcat> yes
[05:47:43] <dbaupp> strcat: it does, just not in the win test runner
[05:47:50] <dbaupp> (exter mod)
[05:47:53] <dbaupp> s/ /n /
[05:48:00] <strcat> steven_is_false: @mut is bad in general
[05:48:13] <strcat> adding a useless layer of indirection is worse
[05:48:35] <dbaupp> strcat: opt_vec isn't that bad, for the purpose it serves. the general purpose std::vec, on the other hand :'(
[05:48:49] <strcat> dbaupp: yeah but it's more work
[05:48:53] <strcat> it needs iterators ;\
[05:48:59] <dbaupp> heh
[05:49:08] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[05:49:17] *** Joins: joelteon (joel@moz-317E8D0C.io)
[05:49:33] <dbaupp> the whole of src/* needs iterators
[05:49:45] <kemurphy> where's the definition of Le<T>?
[05:49:58] <dbaupp> there are multiple instances of x = foo.map(f)  x.each :(
[05:50:19] <dbaupp> kemurphy: i think it's in extra::sort (grep for `type Le<T>`)
[05:50:35] *** Quits: blitter (blitter@moz-FB45689C.dyn.centurytel.net) (Ping timeout)
[05:51:24] <kemurphy> dbaupp: ah, it's missing from the online docs
[05:51:42] <dbaupp> oh... rustdoc sorta sucks
[05:51:52] <dbaupp> (well, really sucks)
[05:52:13] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: yichoi)
[05:52:13] <kemurphy> patches accepted, etc :P
[05:52:18] <dbaupp> I guess :)
[05:52:41] <dbaupp> (i think the most effective patch for rustdoc would be a rewrite.)
[05:53:20] <strcat> thanks for not working auto-deref
[05:53:20] <kemurphy> we should get something like hoogle (roogle?)
[05:53:35] <strcat> I hate auto-deref so much that it decided to not work anymore
[05:53:37] <strcat> :D
[05:53:42] <strcat> /home/strcat/projects/rust/src/libstd/repr.rs:505:27: 505:47 error: type `@mut ~[repr::VariantState]` does not implement any method in scope named `len`
[05:53:44] <strcat> /home/strcat/projects/rust/src/libstd/repr.rs:505         match self.var_stk[self.var_stk.len() - 1] {
[05:53:46] <strcat>                                                                              ^~~~~~~~~~~~~~~~~~~~
[05:53:47] <aatch> roogle sounds like Scooby Doo
[05:53:47] <strcat> oh well
[05:53:59] <Ralith> kemurphy: rustle!
[05:53:59] <strcat> apparently auto-deref and auto-ref don't mix
[05:54:14] <Ralith> kemurphy: you heard it here first.
[05:54:41] *** Quits: rubber-duck (rubber-duc@moz-CF32A561.dsl.iskon.hr) (Quit: Leaving)
[05:58:59] *** Parts: steven_is_false (steven@moz-144077DE.bchsia.telus.net) ()
[06:00:01] *** Parts: berak (chatzilla@7AB66452.5291F4C0.16E13E53.IP) ()
[06:03:10] <strcat> dbaupp: I'm going to start chipping away at vec though...
[06:03:18] <strcat> ExtendedIter has to go next
[06:03:24] <strcat> before we can get rid of each
[06:05:38] <strcat> dbaupp: great. replacing vec::uniq_len with .len() -> segfault
[06:05:40] <strcat> :D
[06:07:16] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[06:09:05] <dbaupp> kemurphy: totally!
[06:09:44] *** Joins: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net)
[06:09:55] <dbaupp> strcat: yay! <3 segfault
[06:10:15] <strcat> I think it's from infinite recursion that's defeating the stack overflow check
[06:10:29] <kemurphy> so here's a tool to list all dependencies of a rust source file, if anyone would find that useful: https://gist.github.com/kemurphy/5787110
[06:11:08] <dbaupp> kemurphy: but (understandably) not extern mods?
[06:11:20] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Input/output error)
[06:11:23] <dbaupp> strcat: right. that's not so good.
[06:12:22] <kemurphy> dbaupp: yeah, the use case i see for this is using rust in make or scons, and as far as libraries go, rustc will just bark if the library isn't in the right place
[06:12:50] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[06:13:14] <strcat> /home/strcat/projects/rust/src/libextra/priority_queue.rs:38:34: 38:43 error: unsafe borrow of aliasable, const value
[06:13:16] <strcat> /home/strcat/projects/rust/src/libextra/priority_queue.rs:38     fn len(&const self) -> uint { self.data.len() }
[06:13:18] <strcat>                                                                                                ^~~~~~~~~
[06:13:20] <strcat> &const is a pain
[06:13:24] <kemurphy> dbaupp: i didn't want to have to deal with spitting out local libraries and not system-wide libraries :P
[06:15:07] <strcat> uh oh
[06:15:10] <strcat> found a buf
[06:15:12] <strcat> bug*
[06:15:17] <strcat> I think...
[06:15:51] <dbaupp> rusti: (@mut 1).cmp(&2)
[06:15:53] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/GVEO
[06:16:09] <dbaupp> strcat: ?
[06:16:53] <Jesse> rusti: (@mut 1u).cmp(&2u)
[06:16:55] -rusti- Less
[06:17:03] <strcat> dbaupp: just the stack overflow
[06:17:30] <dbaupp> strcat: oh right
[06:17:39] <dbaupp> rusti: (@mut ~[1i]).len()
[06:17:41] -rusti- 1
[06:17:49] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[06:18:18] <Jesse> rusti: unsafe { 1 }
[06:18:19] -rusti- <anon>:9:15: 9:27 warning: unnecessary `unsafe` block [-W unused-unsafe (default)]
[06:18:20] -rusti- <anon>:9     let r = {  unsafe { 1 } };
[06:18:20] -rusti-                         ^~~~~~~~~~~~
[06:18:20] -rusti- 1
[06:18:26] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[06:18:55] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[06:19:45] *** Quits: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com) (Ping timeout)
[06:20:53] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Quit: Leaving)
[06:21:17] <Jeaye> rusti: unsafe { *1 }
[06:21:17] -rusti- <anon>:9:24: 9:26 error: type <VI0> cannot be dereferenced
[06:21:17] -rusti- <anon>:9     let r = {  unsafe { *1 } };
[06:21:17] -rusti-                                  ^~
[06:21:17] -rusti- error: aborting due to previous error
[06:21:18] -rusti- application terminated with error code 101
[06:21:56] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[06:22:07] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[06:23:42] <Jeaye> What's the idomatic way of removing duplicates from a vec?
[06:23:54] <strcat> use a set ;p
[06:24:04] <strcat> Jeaye: sort + dedup
[06:24:23] * dbaupp hates that sort is in extra
[06:24:31] * dbaupp also hates that sort is so slow
[06:24:51] <strcat> dbaupp: how fast is sorting with a priority queue in comparison? ;p
[06:25:03] <strcat> PriorityQueue::from_vec(xs).to_sorted_vec()
[06:25:10] <strcat> not designed for that but...
[06:25:35] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[06:25:50] *** Joins: joelteon (joel@moz-317E8D0C.io)
[06:26:16] *** Joins: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net)
[06:26:40] <Jeaye> strcat: Does Rust have a set?
[06:26:40] <Havvy> Is this anybody here:  https://github.com/rkbodenner ?
[06:26:45] <strcat> Jeaye: several
[06:26:46] <Jeaye> I haven't seen it anywhere.
[06:26:58] <Jeaye> strcat: Recommend one?
[06:26:58] <strcat> Jeaye: HashSet (arbitrary order), TreeSet
[06:27:04] <strcat> TreeSet is sorted
[06:27:05] <Jeaye> ahh
[06:27:26] <aatch> strcat, the sets are just partial specialisations of Maps
[06:27:28] <Jeaye> How're they implemented?
[06:27:39] <Jeaye> Err, I need them to be contiguous.
[06:27:42] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[06:27:43] <strcat> aatch: yeah, I know, I wrote them - but they have the set methods
[06:27:47] <Jeaye> Which is why I went with vec.
[06:27:54] <aatch> strcat, sorry, I mean Jeaye 
[06:27:54] <dbaupp> strcat: not sure, haven't tested... but taking a closure means nothing gets inlined. and the only ones that use Ord require Copy :/
[06:27:57] *** Joins: eatkinson (eatkinson@moz-A7CDB794.dia.static.qwest.net)
[06:28:06] <strcat> dbaupp: well, PriorityQueue then :D
[06:28:07] <Jeaye> aatch: I know what sets are conceptually.
[06:28:12] <strcat> dbaupp: in-place heap sort
[06:28:22] *** Quits: josh (josh@52A1524D.4E7EDEC9.632B8C24.IP) (Quit: josh)
[06:28:27] <aatch> Jeaye, no, I meant that is how they are implemented.
[06:28:29] <dbaupp> strcat: yup. this does mean more cleanup required though.
[06:28:33] * dbaupp sighs
[06:28:47] <Jeaye> aatch: Ahh, gotcha. Makes sense; that's how C++ doe sit.
[06:28:56] <Jeaye> I need to stick with vec then.
[06:28:59] <aatch> it just uses () as the value type.
[06:29:02] <Jeaye> I'll sort & dedup
[06:29:32] *** Joins: KindOne (KindOne@99309C42.B11A32F.EC6A1518.IP)
[06:31:27] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[06:34:13] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[06:35:11] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:35:21] *** Joins: joelteon (joel@moz-317E8D0C.io)
[06:35:28] *** Joins: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net)
[06:35:29] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[06:36:06] *** Joins: ysuzuki (ysuzuki@moz-CCA5E396.tokyo.ocn.ne.jp)
[06:36:18] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:36:18] <Jeaye> rusti: let mut v = ~[3, 2, 1]; quick_sort3(v); v
[06:36:18] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/QY8orQ
[06:36:18] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:36:20] -rusti- <anon>:9:39: 9:50 error: unresolved name `quick_sort3`.
[06:36:20] -rusti- <anon>:9     let r = {  let mut v = ~[3, 2, 1]; quick_sort3(v); v };
[06:36:20] -rusti-                                                 ^~~~~~~~~~~
[06:36:20] -rusti- error: aborting due to previous error
[06:36:20] -rusti- application terminated with error code 101
[06:36:27] <Jeaye> rusti: let mut v = ~[3, 2, 1]; sort::quick_sort3(v); v
[06:36:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dTFV
[06:36:44] <Jeaye> rusti: let mut v = ~[3, 2, 1]; extra::sort::quick_sort3(v); v
[06:36:46] -rusti- ~[1, 2, 3]
[06:36:49] <Havvy> So, somebody sent a pull request updating some documentation files I wrote a year ago...15 minutes ago.
[06:36:55] <Havvy> And (s)he's not in here.
[06:37:13] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[06:38:43] <strcat> rusti: extra::priority_queue::PriorityQueue::from_vec(~[3, 2, 1])
[06:38:44] -rusti- {data: ~[3, 2, 1]}
[06:38:48] <strcat> rusti: extra::priority_queue::PriorityQueue::from_vec(~[3, 2, 1]).to_sorted_vec()
[06:38:49] -rusti- ~[1, 2, 3]
[06:38:51] <strcat> ;p
[06:39:09] *** Parts: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net) ()
[06:39:17] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:39:17] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/2YBxNQ
[06:39:17] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:39:19] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[06:39:19] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/j48cBg
[06:39:19] <ghrust> 13rust/06auto 142b13606 15Daniel Micay: update the libstd docstring for the rename
[06:39:19] <ghrust> 13rust/06auto 147d1065e 15bors: auto merge of #7122 : thestinger/rust/std, r=luqmana
[06:39:19] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[06:39:31] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[06:39:48] <Jeaye> rusti: let mut v = ~[3, 3, 2, 1, 2, 1]; extra::sort::quick_sort3(v); v.dedup(); v
[06:39:49] -rusti- <anon>:9:77: 9:87 error: type `~[int]` does not implement any method in scope named `dedup`
[06:39:49] -rusti- <anon>:9     let r = {  let mut v = ~[3, 3, 2, 1, 2, 1]; extra::sort::quick_sort3(v); v.dedup(); v };
[06:39:49] -rusti-                                                                                       ^~~~~~~~~~
[06:39:49] -rusti- error: aborting due to previous error
[06:39:51] -rusti- application terminated with error code 101
[06:40:41] <dbaupp> rusti: let mut v = ~[3, 3, 2, 1, 2, 1]; extra::sort::quick_sort3(v); std::vec::dedup(v); v
[06:40:42] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[06:40:42] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DcGU
[06:40:52] *** Quits: eatkinson (eatkinson@moz-A7CDB794.dia.static.qwest.net) (Quit: eatkinson)
[06:40:55] <Jeaye> rusti: let mut v = ~[3, 3, 2, 1, 2, 1]; extra::sort::quick_sort3(v); vec::dedup(v); v
[06:40:56] <dbaupp> rusti: let mut v = ~[3, 3, 2, 1, 2, 1]; extra::sort::quick_sort3(v); std::vec::dedup(&mut v); v
[06:40:57] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/NXeX
[06:40:57] -rusti- ~[1, 2, 3]
[06:41:14] <Jeaye> I think you won that.
[06:41:15] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[06:42:20] <Jeaye> let mut v = ~[3, 3, 2, 2]; extra::sort::merge_sort(v, |x, y| -> bool { x < y }); std::vec::dedup(&mut v); v
[06:42:42] <Jeaye> rusti: let mut v = ~[3, 3, 2, 2]; extra::sort::merge_sort(v, |x, y| -> bool { x < y }); std::vec::dedup(&mut v); v
[06:42:43] -rusti- ~[3, 2]
[06:42:56] <Jeaye> I like it.
[06:42:58] <Jeaye> Thanks. :)
[06:43:44] <dbaupp> Jeaye: the fastest method is likely to be either quick_sort3 or the PriorityQueue method
[06:44:03] <dbaupp> The closure for merge_sort absolutely kills performance. :(
[06:44:33] * strcat roots for PriorityQueue
[06:44:44] <Jeaye> Grr, I just don't want to implemtent cmp::Ord for my type, since it's lame and requires lt, le, ge, and gt.
[06:44:53] <strcat> that was my first real rust contribution :)
[06:45:31] <Jeaye> Oh well, I'll do it. >.<
[06:45:42] <strcat> Jeaye: derive it
[06:45:54] <strcat> anyway once sully is done fixing default methods, 3 of those can be default methods
[06:46:01] <dbaupp> strcat: 4
[06:46:07] <Jeaye> ^_^
[06:46:07] <strcat> dbaupp: no, one can't be
[06:46:12] <strcat> or you'd get infinite recursion by defaul;t
[06:46:21] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:46:24] <dbaupp> not a problem
[06:46:27] <dbaupp> (well, not that much of one)
[06:46:30] <strcat> it is!
[06:46:32] <dbaupp> Haskell supports it
[06:46:39] <strcat> oh
[06:46:41] <strcat> does it just yell at you?
[06:47:00] <dbaupp> nope
[06:47:06] <strcat> recurses forever? ;\
[06:47:16] <dbaupp> yup
[06:47:23] <dbaupp> Prelude> data A = A
[06:47:23] <dbaupp> Prelude> instance Eq A
[06:47:23] <dbaupp> Prelude> A == A
[06:47:23] <dbaupp> ^CInterrupted.
[06:47:27] <strcat> well.... just because haskell does it doesn't make it a good idea ;p
[06:47:35] <dbaupp> heh
[06:49:33] <strcat> haskell also lets you implement operators with a user-defined precedence and associativity
[06:49:42] <strcat> and record fields are all in module scope
[06:49:55] <strcat> :D
[06:50:03] * strcat can't think of many others
[06:50:08] <dbaupp> the first is awesome, the second is not
[06:50:19] <strcat> the first isn't awesome unless you're writing a library
[06:50:25] <strcat> like, lens
[06:50:27] <strcat> it has like 300 operators
[06:50:30] <strcat> sounds cool
[06:50:30] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:50:34] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[06:50:38] <strcat> but good luck figuring out what they do 
[06:50:38] *** Quits: brson (brson@DA348D07.AD1E507F.3688B332.IP) (Ping timeout)
[06:51:20] <dbaupp> ah, but it makes it nice for mathematical libraries
[06:51:30] * dbaupp is only concerned about that
[06:51:36] <strcat> dbaupp: http://hackage.haskell.org/packages/archive/lens/3.9.0.2/doc/html/Control-Lens-Operators.html
[06:51:40] <strcat> it's a widely used lib
[06:51:46] <strcat> and.... it makes my brain explode
[06:52:00] <dbaupp> `<<%@=`
[06:52:11] <strcat> When you do not need the result of the operation, (%=) is more flexible. 
[06:52:23] <strcat> yeah, my brain can remember that. I'm sure.
[06:52:50] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:53:08] <dbaupp> they all follow a pattern though, so it's not *entirely* horrible
[06:53:33] <dbaupp> e.g. @ = Indexed
[06:53:51] *** Joins: m_kato (chatzilla@moz-C286AD9A.bitcat.net)
[06:54:04] <strcat> dbaupp: yeah *that* library uses those conventions :p
[06:54:18] <strcat> and haskell doesn't do qualified imports by default
[06:54:39] <dbaupp> strcat: yeah (I don't disagree that it leads to inscrutable code.)
[06:54:58] <strcat> dbaupp: I like their infix call syntax a lot
[06:55:01] <strcat> I hate user defined operators
[06:55:09] <strcat> foo `bar` baz <- heaven
[06:55:29] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[06:55:48] <strcat> words are so much nicer than symbols
[06:55:59] <strcat> there are already enough built-in operators to worry about ;p
[06:56:18] <dbaupp> the one problem with words is they get so long :(
[06:56:21] <strcat> math also pretty much uses single letter variable names exclusively
[06:56:23] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[06:56:23] *** ChanServ sets mode: +o brson
[06:56:28] <dbaupp> strcat: that's the best part
[06:56:40] <strcat> at best you get x1, x1', X1, X1'
[06:57:12] <dbaupp> heh, you mean greek letters, right?
[06:57:24] <strcat> dbaupp: well no one actually knows how to write those with a pencil ;p
[06:57:29] <strcat> so, scribbles
[06:57:30] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:57:55] <dbaupp> the first three are pretty easy
[06:58:01] <strcat> anyway math syntax is terrible imo :D
[06:58:03] <dbaupp> but after that...
[06:58:37] <dbaupp> strcat: nah, it's great. it just takes effort to get used to.
[06:59:00] <strcat> dbaupp: meh, it prevents you from using multi-letter variables even if you wanted to :(
[06:59:09] <Luqman> dbaupp: are you sure that's not the stockholm syndrome talking :P
[06:59:15] * strcat feels bad for physics people
[06:59:25] <dbaupp> Luqman: quite possibly
[06:59:53] <strcat> dbaupp: and they reuse symbols so much
[07:00:04] <strcat> like Œº
[07:00:10] <dbaupp> Luqman: (that said, it's not clear that there is a similarly information dense syntax, which is fairly important.)
[07:00:41] <strcat> lets just hope you never have to deal with friction and electrons at the same time
[07:01:06] <Luqman> the more annoying part is when different notations are used for the same thing
[07:01:10] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[07:01:31] <dbaupp> Luqman: yeah
[07:01:57] <dbaupp> strcat: \mu_f \mu_e, easy
[07:01:59] <dbaupp> :P
[07:02:35] <Luqman> dbaupp: you've just introduced another problem now, latex
[07:03:25] <dbaupp> "problem"? did you misspell something? :P
[07:04:22] <dbaupp> who doesn't love 40 year old esoteric Turing-complete markup languages?
[07:06:09] <dbaupp> (well, 30 years, for LaTeX)
[07:06:29] *** Quits: rajul (quassel@A2DDF553.812B5995.2051BA92.IP) (Client exited)
[07:06:45] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:08:16] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[07:10:12] *** Quits: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP) (Client exited)
[07:10:45] <Jeaye> Is there any way to dedup without sorting?
[07:11:12] <Jeaye> Only manually?
[07:11:21] <dbaupp> Jeaye: not built-in
[07:11:26] <dbaupp> so yes
[07:11:27] <Jeaye> (and then what about iterator invalidation?)
[07:12:32] <dbaupp> you'll have to do it carefully and with [] indexing, I guess.
[07:13:02] <Jeaye> aye
[07:14:12] <strcat> dedup without sorting would be really slow
[07:14:26] <strcat> at least the naive way
[07:14:47] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[07:15:09] <strcat> dbaupp: heh
[07:15:20] <strcat> .max() becomes .iter().max().unwrap().clone() :(
[07:15:43] <strcat> default methods could get rid of the iter()
[07:16:01] <dbaupp> strcat: eurgh
[07:16:12] <dbaupp> temporary pain for permanent gain
[07:16:25] <strcat> well
[07:16:32] <strcat> *x.iter().max().unwrap()
[07:16:34] <strcat> since they're Copy
[07:18:16] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[07:18:41] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[07:18:44] <strcat> dbaupp: anyway the replacement is more generic
[07:18:59] <strcat> since you get Option<A> instead of only working on BaseIter -> copy out
[07:19:14] <strcat> evil Copy ;[
[07:19:16] <ssbr> If there's a function foo<T>(Option<T>) -> (); would it someday be possible to call foo(None) without specifying what T is, or is that unreasonable?
[07:19:34] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[07:19:35] <dbaupp> ssbr: likely to be unreasonable
[07:20:11] <dbaupp> strcat: yes. it has to be done, despite meaning that we get (slightly) flamed for it occasionally.
[07:20:55] * strcat hasn't been yelled at yet ;p
[07:21:37] <ssbr> dbaupp: Any chance you could explain some? I figured Rust could maybe assume that types that don't matter are ()
[07:21:41] <strcat> oh great this rvalue issue
[07:21:50] <dbaupp> strcat: well, you weren't doing the majority of the str stuff
[07:22:25] <dbaupp> ssbr: T does matter there. e.g. there might be a sys::size_of::<T>() call
[07:22:44] <ssbr> Oh, I did forget about that.
[07:22:50] <ssbr> That's totally fair. Thanks. :)
[07:23:04] <strcat> even if there's not a size_of call, anything unboxed involves size
[07:23:39] <dbaupp> oh, right, yeah. the size of the None changes with T (i.e. the ABI of the function depends on T)
[07:24:01] <ssbr> Sure, but that's something Rust can generate.
[07:24:21] <ssbr> What I was getting at was that I didn't think T made a difference for what the call itself did
[07:24:36] <ssbr> but that's not true, it can still dispatch on T even if it doesn't actually have a value of type T
[07:26:10] <strcat> -            let max_sz = cases.map(|s| s.size).max();
[07:26:12] <strcat> +            let max_sz = cases.iter().transform(|x| x.size).max().unwrap();
[07:26:14] <strcat> meh
[07:26:16] <strcat> not that bad
[07:26:18] <pnkfelix|rcirc> ssbr: and the code generated for invoking foo needs to pass an Option<T>; the size of T will dictate the code generatted for the call, I believe.
[07:26:24] <strcat> considering that it removes a bunch of copies
[07:26:34] <dbaupp> strcat: well it kills an allocation
[07:26:36] <strcat> map makes a new vec
[07:26:38] <strcat> dbaupp: yeah
[07:26:48] * dbaupp hates vec.map
[07:27:07] <ssbr> pnkfelix|rcirc: yes, but AFAIK Rust can just choose a T.
[07:27:10] <strcat> but it's for every enum constant initialization ;p
[07:27:13] *** Quits: marc (marc@E31B39DA.F9D61A8.416A0103.IP) (Ping timeout)
[07:27:21] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[07:27:47] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[07:27:52] <strcat> ssbr: you can still do stuff without type bounds
[07:28:06] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[07:28:09] <strcat> map/filter don't need bounds
[07:28:10] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[07:28:23] <strcat> assuming they're on a specific container
[07:28:37] <ssbr> strcat: I don't know what you mean
[07:29:16] <strcat> fn foo<T>(a: ~[T], fn(T) -> U) -> ~[U] { ... }
[07:29:23] <strcat> plenty you can do without type bounds
[07:30:39] <strcat> dbaupp: heh, just needed minmax ;p
[07:30:48] <strcat>                  let discrs = cases.map(|c| c.discr);
[07:30:50] <strcat> -                return CEnum(discrs.min(), discrs.max());
[07:30:52] <strcat> +                return CEnum(*discrs.iter().min().unwrap(), *discrs.iter().max().unwrap());
[07:30:58] <dbaupp> :(
[07:31:33] <ssbr> strcat: I wasn't saying you can't do anything without type bounds.
[07:31:35] <strcat> minmax could avoid choosing alloc vs two passes
[07:31:54] <strcat> ofc in this case two passes is better but I'm lazy
[07:32:13] *** Joins: marc (marc@E31B39DA.F9D61A8.416A0103.IP)
[07:33:18] <ssbr> I was just saying that T could hypothetically be chosen arbitrarily in a number of special cases
[07:33:39] <ssbr> like if you do map(|x| x, ~[])
[07:34:01] <ssbr> even if the Rust compiler doesn't choose, the human can choose whatever they want
[07:34:23] <ssbr> (hm, I got the arguments backwards because I was thinking lisp. Sorry.)
[07:35:00] <dbaupp> strcat: two passes is better?
[07:35:13] <strcat> dbaupp: well there are usually not very many variants in an enum
[07:35:16] <strcat> anyway not going to change it
[07:35:47] <dbaupp> strcat: ok, sounds correct
[07:36:16] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:36:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/j48cBg
[07:36:16] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:36:25] <strcat> master <3
[07:36:56] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[07:37:27] *** Joins: pyrac (pyrac@moz-B2CB8564.w92-156.abo.wanadoo.fr)
[07:39:01] <Jeaye> <3
[07:39:04] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: Don't tell them I was here...)
[07:39:16] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[07:39:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/h1J9ag
[07:39:16] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[07:39:17] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[07:39:17] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/q8rQjw
[07:39:17] <ghrust> 13rust/06auto 14cfa8f63 15Graydon Hoare: rustc: map node ids through a table that ensures bitset indexes in dataflow are dense
[07:39:17] <ghrust> 13rust/06auto 14f7f2b57 15bors: auto merge of #7146 : graydon/rust/fix-giant-borrowck-temp-buffers, r=nikomatsakis...
[07:39:18] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[07:44:59] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:53:58] *** Quits: jesse99 (jesse99@moz-F226420.hsd1.wa.comcast.net) (Ping timeout)
[07:54:38] *** Quits: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net) (Ping timeout)
[07:58:39] *** Joins: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net)
[07:58:52] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[08:01:53] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[08:02:16] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[08:05:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[08:06:14] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[08:06:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f7f2b57 to 147d1065e: 02http://git.io/N3iJvQ
[08:06:14] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[08:06:16] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[08:06:16] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/c0b93A
[08:06:16] <ghrust> 13rust/06auto 141a3edec 15Alex Crichton: Revert "Revert "Remove all usage of the global LLVMContextRef""...
[08:06:16] <ghrust> 13rust/06auto 14a90fffe 15Alex Crichton: Revert "Revert "Have JIT execution take ownership of the LLVMContextRef""...
[08:06:16] <ghrust> 13rust/06auto 14079ffa3 15Alex Crichton: Correctly parse commands for rusti...
[08:06:18] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[08:08:16] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[08:08:40] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[08:14:28] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[08:14:29] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:15:42] *** Quits: KindOne (KindOne@99309C42.B11A32F.EC6A1518.IP) (Ping timeout)
[08:16:00] <dbaupp> pnkfelix|rcirc: ping
[08:18:14] *** Joins: josh (josh@52A1524D.4E7EDEC9.632B8C24.IP)
[08:18:36] <pnkfelix|rcirc> dbaupp: pong
[08:18:41] <josh> I'm having trouble making use of word_iter to loop over words in a string - what would a loop for that look like?
[08:19:07] <dbaupp> pnkfelix|rcirc: I think github may've pinged you accidentally, because https://github.com/mozilla/rust/commit/c83bceddbb497464f8e4e1990f7518b009cd61ca is merged into master
[08:19:12] <pnkfelix|rcirc> dbaupp: did I double r+ something?  I just noticed
[08:19:28] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[08:19:33] <pnkfelix|rcirc> dbaupp: I was sitting here going "wait, did the one I already r+'ed get dropped, or ..."
[08:19:37] <dbaupp> josh: `for my_string.word_iter().advance |word| { ... }`
[08:19:37] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[08:19:45] <dbaupp> pnkfelix|rcirc: heh :)
[08:20:37] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[08:20:42] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[08:22:02] <josh> dbaupp: thanks, but "does not implement any method in scope named `advance`"
[08:22:23] <dbaupp> josh: oh, right, you need 'use std::iterator::IteratorUtil;'
[08:23:35] <dbaupp> josh: or, compiling from a (very) recent master, since IteratorUtil got added to the prelude a few hours ago
[08:24:12] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Ping timeout)
[08:24:45] *** Joins: KindOne (KindOne@moz-2415F25.dynamic.ip.windstream.net)
[08:25:04] <josh> dbaupp: that seems to get me a little further but the next error is baffling: error: mismatched types: expected `float` but found `()` (expected float but found ())
[08:25:32] <dbaupp> josh: code?
[08:25:40] <josh>     for s.word_iter().advance |w| {
[08:25:40] <josh>         println(w);
[08:25:41] <josh>     }
[08:25:56] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[08:26:00] <dbaupp> are you sure it's not somewhere else?
[08:26:08] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[08:26:28] <dbaupp> rusti: use std::iterator::IteratorUtil; for "foo bar baz".word_iter().advance |w| { println(w); }
[08:26:33] -rusti- foo
[08:26:33] -rusti- bar
[08:26:33] -rusti- baz
[08:26:33] -rusti- ()
[08:26:43] <josh> it's pointing at the final "}" for the for loop
[08:26:57] <dbaupp> ah. is it in a function that is meant to return float?
[08:27:06] <josh> oh yeah, i feel dumb
[08:27:21] <dbaupp> don't. it's easy to get tripped up :)
[08:27:28] *** Quits: m_kato (chatzilla@moz-C286AD9A.bitcat.net) (Quit: ChatZilla 0.9.90 [Firefox 24.0a1/20130614031100])
[08:34:16] *** Joins: Palmik (palmik@moz-5CA3F354.pks.muni.cz)
[08:35:28] *** Quits: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net) (Quit: Textual IRC Client: www.textualapp.com)
[08:43:41] *** Joins: jclements (jclements@moz-E2C10A72.inwind.it)
[08:46:25] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[08:48:54] <kimundi> Eridius: Not sure if you've seen in (reading scrollback at the moment) but you can go ~[u8] -> ~[Ascii] with 'vec.to_ascii()' (does a copy) or 'vec.to_ascii_consume()' (does not copy, but crashes because moving self last time I knew)
[08:49:51] <Luqman> pnkfelix|rcirc: i commented on #5792 and the fix to reject the swapped version is simple enough but i'm not sure whether we want to allow shadowing or not
[08:49:53] <aatch> Hmm, there really should be an `as_ascii`
[08:50:25] <Eridius> kimundi: yeah I used v.to_ascii_consume(), which seems to work
[08:50:42] <dbaupp> kimundi: I think to_ascii_consume is actually incorrect for ~str
[08:50:43] <kimundi> nice :)
[08:50:50] <kimundi> how?
[08:51:11] <dbaupp> the pop_byte call removes that last character, not the the trailing null
[08:51:15] <Eridius> kimundi: (~str).to_ascii_consume replaces the final byte with a null
[08:51:25] <dbaupp> rusti: (~"foo").to_ascii_consume()
[08:51:29] -rusti- ~[{chr: 102}, {chr: 111}, {chr: 0}]
[08:51:33] <pnkfelix> Luqman: yeah I don't know either
[08:51:43] <kimundi> he, whoops
[08:52:12] <kimundi> I thought I wrote tests for all combinations that where supposed to catch that
[08:52:17] <Eridius> heh
[08:52:30] <pnkfelix|rcirc> Luqman: I'll try to review the situation later and see if I can infer what the right answer is.  If I cannot, then I'll bring it up at Tuesday's mtg.
[08:52:35] *** Quits: josh (josh@52A1524D.4E7EDEC9.632B8C24.IP) (Quit: josh)
[08:52:42] <Eridius> kimundi: why is there no way to go from ~[Ascii] -> ~[u8]?
[08:52:50] <Eridius> you can go to ~str, but that's not helpful for me
[08:52:58] <pnkfelix|rcirc> Luqman: thanks for elaborating why the bug occurs
[08:53:06] <kimundi> uh, good question. might have forgotten it :P
[08:53:13] * Eridius had to use unsafe { cast::transmute() } instead
[08:53:31] <Eridius> kimundi: would also be nice to have an unsafe version that skips the is_ascii check
[08:54:05] <kimundi> Well, the point of Ascii is that those checks exist
[08:54:24] <Eridius> kimundi: I only wanted it for .to_upper(), and my source ~[u8] was guaranteed to be ascii
[08:54:47] <Eridius> anyway, bed time
[08:54:54] <kimundi> but yeah, if you already know you have ascii... If you file an issue about those things I might take a stab at it later :)
[08:58:41] *** Joins: dherman (dherman@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[08:58:41] *** ChanServ sets mode: +o dherman
[08:58:57] <ziad> let mut v = ~[3, 3, 2, 2]; extra::sort::merge_sort(v, |x, y| -> bool { x < y }); std::vec::dedup(&mut v); v             ???asIch
[08:58:59] <ziad> 23:40:36               -- | Notice(rusti): ~[3, 2]                                                                                                         ???baupp
[08:59:01] <ziad> 23:40:48            Jeaye | I like it.                                                                                                                     ???ecoder
[08:59:15] <ziad> rusti: let mut v = ~[3, 3, 2, 2]; std::vec::dedup(v); v
[08:59:16] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/eWKW
[08:59:23] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[09:01:48] *** Quits: jclements (jclements@moz-E2C10A72.inwind.it) (Quit: jclements)
[09:02:02] *** Quits: dherman (dherman@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Ping timeout)
[09:02:09] *** Joins: nano (nano@moz-972880B.superkabel.de)
[09:02:27] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[09:03:17] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[09:03:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/c0b93A
[09:03:18] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[09:04:31] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Connection reset by peer)
[09:06:17] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:06:17] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/9NDm_g
[09:06:17] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:06:28] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[09:07:46] *** Quits: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net) (Ping timeout)
[09:08:24] *** Quits: ysuzuki (ysuzuki@moz-CCA5E396.tokyo.ocn.ne.jp) (Client exited)
[09:08:46] *** Quits: KindOne (KindOne@moz-2415F25.dynamic.ip.windstream.net) (Ping timeout)
[09:09:15] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:09:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/9NDm_g
[09:09:16] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:09:16] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[09:09:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Va_0NA
[09:09:16] <ghrust> 13rust/06auto 14d361802 15Huon Wilson: rustdoc: add syntax highlighting to item signatures....
[09:09:16] <ghrust> 13rust/06auto 1461cf44c 15bors: auto merge of #7130 : huonw/rust/rustdoc-highlight, r=thestinger...
[09:09:16] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[09:09:16] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[09:10:56] <cmr> Eridius: Nice work with terminfo
[09:13:05] *** Joins: KindOne (KindOne@moz-C36D88CE.dynamic.ip.windstream.net)
[09:15:53] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[09:17:21] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[09:17:28] *** Joins: fenster (Mibbit@moz-E1AE6B5.ip.telfort.nl)
[09:18:07] *** Joins: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net)
[09:18:28] *** Quits: fenster (Mibbit@moz-E1AE6B5.ip.telfort.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[09:18:36] *** Quits: KindOne (KindOne@moz-C36D88CE.dynamic.ip.windstream.net) (Ping timeout)
[09:22:35] *** Joins: KindOne (KindOne@2D26D8E2.FEF4604.EC6A1518.IP)
[09:28:24] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[09:30:11] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[09:32:03] *** Quits: KindOne (KindOne@2D26D8E2.FEF4604.EC6A1518.IP) (Ping timeout)
[09:35:41] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:36:27] *** Joins: igl1 (igl@moz-A9F2CE1E.adsl.alicedsl.de)
[09:36:53] *** Quits: igl (igl@moz-7DA75B92.adsl.alicedsl.de) (Ping timeout)
[09:37:57] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[09:48:09] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[09:48:16] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[09:48:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ZGU_tw
[09:48:16] <ghrust> 13rust/06auto 143960cc7 15Daniel Micay: stop using an absolute rpath...
[09:48:16] <ghrust> 13rust/06auto 14e71a040 15bors: auto merge of #7132 : thestinger/rust/rpath, r=brson...
[09:48:16] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[09:49:38] <cmr> aatch: some code generated at --opt-level=2 is slower than --opt-level=1, sometimes by a factor of two. (specifically the testcase at https://github.com/mozilla/rust/issues/7136, and some of the shootout benchmarks)
[09:49:48] <aatch> cmr, really?
[09:49:50] <cmr> yup
[09:51:21] <cmr> not all code, and it seems like not most code. doing timing on rustc builds now
[09:52:36] <aatch> cmr, weird.
[09:52:47] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[09:52:53] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Connection reset by peer)
[09:52:58] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[09:53:01] <aatch> Well you can play around with the pipeline using the --passes flag.
[09:54:01] <aatch> I found that having a file with them in and using `cat file` to put the on the pipeline was pretty easy to work with.
[09:54:19] <dbaupp> i'm killing stack canaries in run-fail & compile-fail... known issue?
[09:54:30] <cmr> dbaupp: uh oh, I thought brson fixed that :\
[09:54:41] <Luqman> dbaupp: i think strcat was running into that
[09:54:53] <dbaupp> ok, possibly due to my changes
[09:54:58] * dbaupp examines them more closely
[09:55:09] <cmr> hey may not have fixed that one
[09:56:24] <dbaupp> also, can anyone explain the failure in https://github.com/mozilla/rust/pull/7130 ?
[09:57:02] <dbaupp> (changes in rustdoc apparently caused a test in std::run to fail.)
[09:58:47] <aatch> dbaupp, apparently something isn't inheriting.
[09:59:14] <aatch> I might remove that test, since environment inheritance isn't that simple.
[09:59:35] <aatch> (For example, that test broke when run under valgrind on linux)
[10:00:10] <dbaupp> can you @retry it? (it's presumably disconnected from changing the code template in rustdoc)
[10:00:25] <aatch> dbaupp, sure.
[10:00:26] <dbaupp> err, '@bors: retry' it
[10:01:03] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[10:03:29] *** Joins: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de)
[10:06:33] <aatch> We don't /actually/ use address spaces any more, right?
[10:06:44] *** Quits: heftig (heftig@moz-F165E327.dip0.t-ipconnect.de) (Ping timeout)
[10:08:09] <doener> right, there's an issue to remove it
[10:08:29] <doener> https://github.com/mozilla/rust/issues/7063
[10:08:47] <aatch> doener, cool. I'm refactoring the LLVM type stuff in trans, so I can just skip over that.
[10:09:06] *** Joins: koomi (koomi@moz-33208B35.pools.arcor-ip.net)
[10:09:14] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[10:09:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e71a040 to 1483d44f8: 02http://git.io/N3iJvQ
[10:09:14] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[10:09:15] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[10:09:15] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/jbVQdA
[10:09:15] <ghrust> 13rust/06auto 14821a962 15Corey Richardson: Various terminfo parameterization changes
[10:09:15] <ghrust> 13rust/06auto 149f9e505 15Kevin Ballard: Tweak new terminfo logical operator support
[10:09:15] <ghrust> 13rust/06auto 14c9e234a 15Kevin Ballard: Tweak terminfo::parm::expand function signature...
[10:09:17] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[10:09:20] *** Joins: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de)
[10:09:34] <doener> aatch: if it makes things easier, you could probably cherry-pick graydon's commit, looked pretty isolated to me
[10:10:27] <aatch> doener, eh, this is pretty invasive anyway, so I doubt it'd change much.
[10:13:00] <doener> aatch: btw, my PR from last night changed CrateContext, so I probably broke part 1 of your refactoring. Sorry for that, only realized that when you mentioned your refactoring efforts
[10:13:24] <aatch> doener, has it merged?
[10:13:47] <doener> yep, https://github.com/mozilla/rust/issues/7063
[10:14:07] <aatch> uh...
[10:14:12] <doener> adds a new hashmap to CrateContext
[10:14:12] <aatch> wrong link...
[10:14:17] <doener> https://github.com/mozilla/rust/pull/7144
[10:14:18] <doener> oops
[10:15:55] <aatch> doener, it appears it did. I haven't actually been able to build for most of today, so thanks for the heads-up.
[10:17:37] <aatch> And re-added the field. Hopefully nothing else changed...
[10:17:49] <aatch> Downside of moving something to a new file...
[10:17:55] * aatch needs to rebase
[10:18:16] <aatch> I mean, I've rebase my current branch, I need to rebase my PR
[10:18:26] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[10:20:35] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Input/output error)
[10:22:58] *** Quits: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de) (Quit: Quitting)
[10:23:10] *** Joins: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de)
[10:24:02] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[10:27:33] <aatch> I apparently have the worst timing ever for this refactoring.
[10:28:17] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:28:18] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:30:38] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[10:31:06] <cmr> aatch: --opt-level=1/2 doesn't hurt rustc it seems, so probably not a big deal for now
[10:31:26] <cmr> once trans is less terrible looking at the optimization pipeline in more depth would be good
[10:32:44] <aatch> cmr, I agree.
[10:33:18] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[10:33:23] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[10:33:30] <aatch> I realized that doing much more work on it would be fruitless, since I would be fighting against bad code-gen
[10:34:08] <aatch> Hopefully getting trans into a state where it aleast is a little less crufty will help.
[10:39:41] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Ping timeout)
[10:40:54] *** Quits: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP) (Connection reset by peer)
[10:41:21] *** Joins: wuwei|offline (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[10:44:23] <doener> WOAH! Compile time for librustc drop from 2:30 to 1:40 
[10:44:34] <doener> now lets hope that the testsuite survived
[10:44:53] <xenocons> pew PEW
[10:45:11] <xenocons> impressive speedup
[10:45:14] *** Quits: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de) (Quit: Quitting)
[10:45:38] *** Joins: heftig (heftig@6DE70BD1.E59801E4.172227A7.IP)
[10:45:47] <doener> and all I did was to drop the "optimization" for statically known glue function calls, which confuses the hell out of LLVM and ruins glue inlining
[10:46:32] <aatch> doener, most annoying part of your change, when combined with mine, it hits the artifically extended freeze issue.
[10:47:47] <aatch> wait, one of these places is unrelated to my changes...
[10:48:01] <doener> aatch: actually it hits that already, must have missed the warning. I was just too happy not to get a dynamic borrow failure anymore. Tried to put the cache in cstore first, and after three dozen approaches that all ended in dynamic borrow failures, I gave up and moved them to their current homes
[10:48:07] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[10:48:21] <aatch> doener, tell me about it.
[10:48:29] <aatch> I fixed one, I'll leave the other alone
[10:49:23] <doener> if only it wouldn't take 3 minutes to get the damn thing to tell you that you messed up the borrowing :-/ But I guess "mutable, aliasable" wasn't much better either *g*
[10:51:41] <aatch> doener, yeah, I had a ton from cases like foo(cx, bar(cx)) where one would borrow and the other wouldn't, so I'd get dynamic errors there
[10:52:28] <aatch> I did have one were the was a path that error'd about 4 or 5 levels down the stack from where it froze.
[10:53:41] <doener> ouch
[10:54:27] <aatch> doener, yeah, in the constant translation path, const_expr gets called recursively indirectly.
[10:54:53] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[10:54:59] <aatch> and also, only libsyntax triggered the path.
[10:55:44] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[11:06:17] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:06:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/jbVQdA
[11:06:17] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:07:01] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[11:09:13] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[11:09:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/MST4gA
[11:09:13] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[11:09:13] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[11:09:14] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/I4LVIw
[11:09:14] <ghrust> 13rust/06auto 146b22c09 15Ben Blum: make util::NonCopyable a unit struct instead of a struct with a unit
[11:09:14] <ghrust> 13rust/06auto 14d809f54 15Ben Blum: remove bitrotted cant_nest field from RWARC (the #[mutable] tag suffices)
[11:09:14] <ghrust> 13rust/06auto 140ca2056 15Ben Blum: Document unstable::atomics fetch_* return values
[11:09:15] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[11:16:01] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[11:16:08] <doener> and we have a dead canary :-/
[11:19:49] <aatch> rusti: stringify!(concat_idents!(foo, bar))
[11:19:51] -rusti- "concat_idents ! ( foo , bar )"
[11:20:00] <doener> hm, I get that with master as well, though. And only intermittent
[11:20:08] <aatch> damn it.
[11:20:21] <aatch> rusti: "abc" "def"
[11:20:21] -rusti- <anon>:9:21: 9:26 error: expected `;` or `}` after expression but found `"def"`
[11:20:21] -rusti- <anon>:9     let r = {  "abc" "def" };
[11:20:22] -rusti-                               ^~~~~
[11:20:22] -rusti- application terminated with error code 101
[11:20:58] <aatch> doener, strcat was talking about dead canaries earlier.
[11:24:41] <EXetoC> poor birds
[11:24:55] *** Quits: heftig (heftig@6DE70BD1.E59801E4.172227A7.IP) (Quit: Quitting)
[11:27:21] <dbaupp> aatch: bors didn't seem to pick up your retry on https://github.com/mozilla/rust/pull/7130... you might need the colon after @bors? (at least, that's how it's been every time I've seen it.)
[11:29:03] <aatch> dbaupp, lets see if that works.
[11:29:22] <aatch> Otherwise I'll r=thestinger
[11:30:24] <dbaupp> seemed to :)
[11:30:45] <aatch> dbaupp, there we go.
[11:32:23] <aatch> rusti: ~"test" + "abc"
[11:32:23] -rusti- ~"testabc"
[11:36:03] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Ping timeout)
[11:36:45] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[11:39:08] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[11:47:24] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[11:49:28] *** Joins: spider-mario (spidermari@moz-AC2C1EAE.rev.sfr.net)
[11:54:17] <dbaupp> aatch: https://github.com/mozilla/rust/pull/7123 r? (had to rebase it because it didn't merge the first time)
[11:57:19] <aatch> dbaupp, looks good, r+
[11:57:42] *** Joins: luser0 (chatzilla@805207D9.A4A94796.19654643.IP)
[11:59:12] *** Joins: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de)
[11:59:20] *** Joins: nano (nano@moz-972880B.superkabel.de)
[12:02:36] *** Quits: luser0 (chatzilla@805207D9.A4A94796.19654643.IP) (Quit: ChatZilla 0.9.90 [Iceweasel 17.0.6/20130515074240])
[12:04:06] <cmr> aatch: doener: is there anything you'd like included in twir (draft: https://gist.github.com/cmr/a4dd556565a87cdbea85 )?
[12:05:11] <cyndis> the issue 7029 link is broken
[12:05:31] <cmr> cyndis: whoops, tanks
[12:05:36] <cyndis> :)
[12:06:11] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[12:06:11] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/I4LVIw
[12:06:11] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[12:06:25] <Thiez> the article about rust with seperation logic is pretty awesome
[12:06:31] <aatch> cmr, what day does this go out on?
[12:06:52] <cmr> aatch: Today (Saturday), 2200 UTC
[12:07:02] <dbaupp> cmr: you've swapped a c for an s: "Some disccusion about list comprehensions..." </pedantry>
[12:08:09] <cmr> dbaupp: thanks :)
[12:08:29] <cmr> Thiez: what article is that?
[12:09:10] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[12:09:10] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/E9BSpw
[12:09:10] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[12:09:12] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[12:09:12] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/wjIy5A
[12:09:12] <ghrust> 13rust/06auto 14570bbac 15Huon Wilson: std: convert str::{map,levdistance,subslice_offset} to methods....
[12:09:12] <ghrust> 13rust/06auto 14e3bc3f8 15Huon Wilson: std: convert str::to_utf16 to a method.
[12:09:13] <ghrust> 13rust/06auto 1417c44a0 15Huon Wilson: std: simplify the string comparison implementations, using iterators.
[12:09:14] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[12:09:19] <Thiez> cmr: http://johnbender.us/2013/04/30/reasoning-about-the-heap-in-rust/
[12:10:20] <Thiez> I don't think it ever got posted to the newsgroup, which is a shame because it's a nice read.
[12:11:15] <Thiez> not very in depth, but I think much of rust's pointer semantics map nicely to separation logic
[12:19:52] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Connection reset by peer)
[12:19:57] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[12:26:24] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[12:27:39] <xenocons> i think we have our own hoare on the rust team hehe
[12:27:56] <Thiez> :D
[12:28:28] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:28:38] *** Quits: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:30:36] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Ping timeout)
[12:31:35] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[12:33:21] *** Quits: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de) (Quit: Quitting)
[12:33:43] <kemurphy> does there exist a tool to take a c header full of #defines/structs and output equivalent rust?
[12:33:59] <cmr> kemurphy: rust-bindgen though I don't know how well it works
[12:35:19] *** Joins: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de)
[12:36:17] *** Quits: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de) (Quit: Quitting)
[12:38:13] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Connection reset by peer)
[12:38:41] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[12:38:41] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[12:39:30] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[12:40:13] *** Joins: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de)
[12:40:38] *** Joins: jfbk (user@moz-EEA9CFB3.nyc.res.rr.com)
[12:41:16] <kemurphy> cmr: it gets the structs but not the #defines, but that shouldn't be too hard to add
[12:41:53] <dbaupp> kemurphy: does the generated code compile with a recent master?
[12:42:04] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[12:43:56] <cmr> Part of the problem with defines is that they're typeless and can be arbitrary macros.
[12:44:19] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[12:46:10] <dbaupp> what does the error at the end of http://buildbot.rust-lang.org/builders/auto-mac/builds/1722/steps/test/logs/stdio mean?
[12:46:22] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:46:44] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[12:47:07] <aatch> dbaupp, geyah
[12:47:40] <aatch> It's an error in libuv somewhere.
[12:48:03] <aatch> the assertion is that it none of the received events are errors.
[12:49:19] <kimundi> cmr: Updated my @ proposal, if you want to take a look.
[12:49:34] <Thiez> cmr: where is your proposal?
[12:49:37] <Thiez> eh
[12:49:39] <cmr> https://gist.github.com/Kimundi/5744578
[12:49:46] <Thiez> wrong name :D
[12:49:57] <Thiez> thanks
[12:50:10] <dbaupp> aatch: is it something that I would've caused?
[12:50:21] * dbaupp is good at breaking mac, apparently
[12:50:30] <aatch> dbaupp, unlikely.
[12:50:54] <cmr> kimundi: I've got to go (graduation ceremony), I'll look later, thanks
[12:51:09] * dbaupp sighs
[12:51:10] <kimundi> sure, don't mind me :)
[12:51:13] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[12:51:13] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_mkS6Q
[12:51:13] <ghrust> 13rust/06auto 14d361802 15Huon Wilson: rustdoc: add syntax highlighting to item signatures....
[12:51:13] <ghrust> 13rust/06auto 14ac6f154 15bors: auto merge of #7130 : huonw/rust/rustdoc-highlight, r=thestinger...
[12:51:13] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[12:52:15] *** Joins: lmandel (lmandel@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[12:52:16] <dbaupp> let's see if mac survives this one
[12:53:06] <aatch> heh, function called "fabs"
[12:54:49] *** Joins: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP)
[12:54:49] <jfbk> hi all, rust noob here. i'm segfaulting w/ a basic server that tries to pass out a channel for each connection: https://gist.github.com/jfager/5788001 is this obviously stupid on my part or should i file a bug?
[12:55:55] <dbaupp> jfbk: well, it probably shouldn't segfault on libc::sleep(1), and since there is no other `unsafe`, then the segfault is a bug
[12:56:23] <dbaupp> jfbk: can you get a backtrace?
[12:57:08] <Thiez> libc::sleep(1) is fine
[12:57:11] <Thiez> rusti: unsafe{ std::libc::sleep(1); } true
[12:57:13] -rusti- true
[12:58:18] *** Quits: lmandel (lmandel@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Ping timeout)
[12:58:38] <jfbk> i included the output debug log output in the gist, including the task fail messages.  is there another way to get a more detailed backtrace?
[12:58:59] <kimundi> libc::sleep() stalls the whole procee though. Or at least the current thread.
[12:59:43] <jfbk> the sleep is just in the client, it's the server that's crashing
[12:59:44] <Thiez> kimundi: yeah sure, but we don't have a scheduler-friendly replacement at this time, do we?
[13:00:05] <kimundi> afaik no, just wanted to mention it :P
[13:00:07] <Thiez> I wonder how the new scheduler is progressing :)
[13:00:13] <kemurphy> dbaupp: i had to add -L/usr/lib/llvm to the link_flags in clangll.rs, but otherwise yes
[13:00:39] <dbaupp> jfbk: with gdb: 'gdb server' 'run' <wait for it to crash> 'bt'
[13:00:53] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[13:00:57] <Thiez> you can of course just create a new scheduler for each task and avoid the mess ;)
[13:01:02] <dbaupp> jfbk: (that's assuming you're on linux, not sure about the other platforms.)
[13:01:05] <kemurphy> this is weird, it doesn't seem to detect CSCursor_MacroDefinition; does libclang require some flag somewhere for that?
[13:01:14] <kemurphy> CXCursor even
[13:01:29] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[13:03:46] <jfbk> updated the gist w/ the backtrace
[13:04:15] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[13:04:29] <dbaupp> jfbk: you're using master/incoming, right?
[13:05:55] *** Joins: BitPuffin (quassel@moz-72F092D.cust.tele2.se)
[13:06:04] <BitPuffin> Can rust be lazy?
[13:06:33] <aatch> BitPuffin, what do you mean?
[13:06:53] <jfbk> dbaupp: yes, pulled just a couple days ago
[13:06:55] <dbaupp> BitPuffin: yup, extra::future
[13:07:26] <BitPuffin> dbaupp: it's an stdlib thing?
[13:07:32] <jfbk> replaced inner spawn w/ task::spawn_sched(task::ManualThreads(1)), still crashes
[13:07:39] *** Quits: spider-mario (spidermari@moz-AC2C1EAE.rev.sfr.net) (Input/output error)
[13:07:50] <dbaupp> jfbk: ok, I guess you should file it
[13:07:53] <dbaupp> BitPuffin: yup
[13:08:09] <jfbk> will do, thanks
[13:08:15] <BitPuffin> dbaupp: ah, well I guess that's fine
[13:08:25] <dbaupp> BitPuffin: it's not lazy like Haskell though, because you have to write out everything manually
[13:08:42] <dbaupp> BitPuffin: (I guess it's in std::future in 0.6.)
[13:08:57] <BitPuffin> dbaupp: write everything out? 
[13:09:16] <BitPuffin> D has lazy in the language
[13:09:48] <aatch> BitPuffin, no, it has lazy argument evaluation.
[13:09:57] <dbaupp> BitPuffin: let x = do future::spawn { 1 }; let z = x.chain(|y| y + 1); ...
[13:10:08] <dbaupp> (z is a future there.)
[13:10:27] <BitPuffin> aatch: ah so it's not like haskell?
[13:10:38] *** Joins: dualhbridge (dad@5033F981.CB6B16F2.1EF4A660.IP)
[13:10:50] <aatch> BitPuffin, no, (for both D and Rust)
[13:11:09] <BitPuffin> hmm
[13:11:19] * BitPuffin wonders if that's good or bad
[13:11:22] <dbaupp> rusti: let x = do extra::future::spawn { 1 }; let z = x.chain(|y| y + 1); println(fmt!("%?", (x, z))); (x.get(), z.get())
[13:11:23] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DRiI
[13:11:54] <aatch> BitPuffin, you can get a lot what people normally want from lazy-ness with iterators though.
[13:12:10] <dbaupp> eurgh, futures don't even implement chain yet
[13:12:16] <BitPuffin> aatch: rust iterators?
[13:12:33] <aatch> BitPuffin, correct
[13:12:33] <dbaupp> (so what I wrote before doesn't actually work, and is, in reality, much worse.)
[13:12:42] <BitPuffin> I don't know Rust enough
[13:12:44] <BitPuffin> currently learning Haskell
[13:12:48] <BitPuffin> so it's why I'm asking
[13:12:58] *** Joins: spider-mario (spidermari@moz-AC2C1EAE.rev.sfr.net)
[13:13:11] <aatch> BitPuffin, fair enough. But in Haskell you can do stuff like define an infinite-sized list.
[13:13:32] <BitPuffin> aatch: yes I know, it's pretty cool
[13:13:58] <aatch> Which is only useful because of lazy evaluation. And normally it just means that it makes it easier to generate some other list
[13:14:03] <BitPuffin> take 20 [ x | x <- [1..] ]
[13:14:14] <aatch> and ultimately you only normally want a finite list anyway.
[13:14:16] <dbaupp> fib = 0:1:zipWith (+) fib (tail fib)
[13:14:23] <kimundi> Well, you can defina in infinete counting iterator
[13:14:32] <kimundi> define an*
[13:14:46] <dbaupp> kimundi: and UnfoldrIterator gives you an arbitrary infinite iterator
[13:15:22] <aatch> So you can implement the same functionality in Rust, you just have to think about it slightly differently.
[13:15:34] <BitPuffin> well I guess that's fine
[13:15:38] <aatch> and they don't look like normal vectors.
[13:15:53] <aatch> Which is good because Rust is a systems language, so hidden cost is bad.
[13:16:11] <kimundi> dbaupp: What does unfold do? Start with an single value, and generate an infinite sequence of new values by appling a function to it?
[13:16:18] <dbaupp> kimundi: yup
[13:16:25] <kimundi> hice
[13:16:29] <kimundi> nice*
[13:16:33] <aatch> (See: every alternate Haskell function that forces early evaluation)
[13:16:55] <dbaupp> kimundi: it takes an initial T value, and a function &fn(&mut T) -> Option<A> and repeatedly calls the function until it returns None
[13:17:08] <dbaupp> (and returns the A values.)
[13:19:53] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[13:22:28] *** Joins: RMF (RMF@moz-52102471.dsl.telepac.pt)
[13:22:42] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[13:22:47] <dbaupp> aatch: assuming you think that the mac failure was not related to the PR: https://github.com/mozilla/rust/pull/7123 r?
[13:23:42] <kyle2000> friends, i am so confused by such a simple operation. all i want to do is take a u32 constant and convert it to a vec of bytes. i know of std::to_bytes but i just can't figure out how to use it properly.
[13:23:43] <aatch> dbaupp, sure.
[13:24:30] <dbaupp> rusti: use std::to_bytes::*; 0x01020304u32.to_bytes()
[13:24:31] -rusti- <anon>:9:37: 9:63 error: this function takes 1 parameter but 0 parameters were supplied
[13:24:31] -rusti- <anon>:9     let r = {  use std::to_bytes::*; 0x01020304u32.to_bytes() };
[13:24:31] -rusti-                                               ^~~~~~~~~~~~~~~~~~~~~~~~~~
[13:24:31] -rusti- error: aborting due to previous error
[13:24:31] -rusti- application terminated with error code 101
[13:24:40] <dbaupp> rusti: use std::to_bytes::*; 0x01020304u32.to_bytes(true)
[13:24:41] -rusti- ~[4, 3, 2, 1]
[13:24:48] <dbaupp> kyle2000: ^
[13:24:48] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[13:25:14] <dbaupp> aatch: I added an extra commit to that PR, btw
[13:25:43] <aatch> dbaupp, gerd demmit
[13:25:43] <dbaupp> (+ doesn't need ~str on the left.)
[13:26:03] <dbaupp> aatch: :'(
[13:26:35] *** Quits: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[13:26:43] <aatch> dbaupp, hopefully that works.
[13:26:56] <dbaupp> rusti: use std::to_bytes::ToBytes; 0x01020304u32.to_bytes(false)
[13:26:58] -rusti- ~[1, 2, 3, 4]
[13:27:27] <dbaupp> aatch: seems unlikely... I'm spectacularly good at bouncing merges. :(
[13:27:35] * dbaupp sighs
[13:29:46] <kyle2000> dbaupp: a million thanks. i forgot the ::* on my use std::to_bytes. i must admit that as an occasional and dumb rust user i find the "use" most difficult to figure out sometimes. it is intuitive in java and python and even ocaml but not in rust for me.
[13:32:08] <MaikKlein> hm? I don't see where use is syntactically different from java. the . is just a :: or am I wrong?
[13:32:25] <aatch> MaikKlein, that's pretty much right.
[13:32:42] <aatch> There are a few different rules, but mostly either bugs or bad behaviour
[13:32:44] <Thiez> kimundi: nice proposal, I think I'm finally overcoming my initial misgivings w.r.t. the @-plan
[13:32:59] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[13:33:01] <Thiez> now that I've seen it in more detail :)
[13:33:08] <kimundi> thx :)
[13:33:24] <dbaupp> kyle2000: use foo::bar::baz; => 'from foo.bar import baz', (including if baz is '*')
[13:33:42] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[13:36:59] <kyle2000> that python example and its relation to rust makes sense to me. maybe my confusion is because in like java, for example, i know that the lower case words are packages and the ones in camel case are classes. but in rust everything is lower case and i don't always know if it's a file module or a inline module or a trait or a function or what have you. i'm just an average programmer so i get confused easily.
[13:37:52] <aatch> kyle2000, Actually, convention now is to have types be PascalCase and everything else lower_case
[13:38:12] <dbaupp> and, there's literally no difference between file and inline modules (except for the obvious being-in-a-separate-file bit)
[13:40:30] <kyle2000> okay thanx i think i understand this better now. so i see the "use std::to_bytes::ToBytes;" in dbaupp's second example from a few minutes ago. that is clearer to me for sure because the ToBytes is a trait and it is pascal cased.
[13:40:38] <kyle2000> i am such a rust dumbo!
[13:41:02] <kyle2000> MaikKlein: how's your qt creator rust ide coming? i think it would probably really help a fool like me with my rusting.
[13:41:03] <dbaupp> kyle2000: no you're not, you just haven't used it as much as most of us here :)
[13:42:09] <xenocons> good stuff on /r/rust lately
[13:42:11] * aatch is modernizing what is considered the worst part of the compiler
[13:42:28] <MaikKlein> kyle2000, I am working on a autocompletion in rust itself, but I am writing 2 exams next week and they have a higher priority atm :/
[13:42:39] <kyle2000> dbaupp: that is a good point. i am only a weekend ruster. but i have never had so much trouble with other languages like java and python. but then maybe they are not as powerful as rust. when i use rust i feel like i am the incredible hulk, with the strength of a billion men. i can crush rocks and break trees.
[13:43:03] <dbaupp> kyle2000: heh :)
[13:43:26] <dbaupp> aatch: you use iterators. iterators are modern. :P
[13:43:30] <MaikKlein> its probably because you have an IDE for java etc that gives you all kind of information
[13:43:42] <kyle2000> MaikKlein: that is fantastic news! may your examinations be examined thoroughly and with complete success. academic success is indeed a higher priority.
[13:43:46] <xenocons> kyle2000: theyre also very different purpose languages (i think)
[13:44:19] <aatch> dbaupp, woah, woah. For trans, /methods/ are pretty modern
[13:44:39] <dbaupp> aatch: oh. :S
[13:44:42] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[13:44:48] <kyle2000> MaikKlein: that is true, i do like ides with autocompletion. they mean i have to think much less about the infrastructure and more about my code.
[13:45:06] <aatch> I'm not joking btw, the sheer number of free functions is astounding.
[13:45:10] <xenocons> is anyone else rubbing their hands for nikos FFI? heh
[13:45:25] <dbaupp> xenocons: bjz has been for months now
[13:45:31] <xenocons> heh
[13:45:41] <aatch> xenocons, not really. For one, there is the #[fast_ffi] attribute...
[13:45:42] <dbaupp> (i think he's got no hands left)
[13:45:51] <doener> hm, slowly the glue stuff is starting to make sense
[13:45:59] <MaikKlein> xenocons, are there any news about FFI?
[13:46:01] <dbaupp> doener: enough sense to remove?
[13:46:08] <aatch> doener, kill it! kill it with fire!
[13:46:32] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Quit: Leaving)
[13:46:38] <dbaupp> aatch: trans'll be awesome and super fast and super modern and bug-free when you're finished with it, right?
[13:46:39] <xenocons> MaikKlein: not particularily, but from forums i guess it lands in 0.7?
[13:46:53] <dbaupp> xenocons: it's getting blocked by windows
[13:46:59] <xenocons> ahh
[13:47:11] <dbaupp> you should go back to windows and fix it for him
[13:47:15] <dbaupp> ;P
[13:47:16] <aatch> dbaupp, don't hold your breath.
[13:47:21] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[13:47:33] <xenocons> dbaupp: but im really loving linux
[13:47:41] <xenocons> configuring stuff... all day
[13:47:58] <MaikKlein> is there a release date for 0.7?
[13:48:03] <dbaupp> aatch: very disappointing. :P
[13:48:09] <xenocons> go on a mission to make everything look like its from a 1990s movie about hacking
[13:48:13] <MaikKlein> I should probably read the forums :X
[13:48:21] <dbaupp> MaikKlein: yup, the end of the month
[13:48:25] <aatch> dbaupp, lol. It's damn tedious in parts
[13:48:41] <MaikKlein> dbaupp, thanks
[13:48:56] <MaikKlein> xenocons, with forum you mean the dev mailing list?
[13:49:13] <aatch> Example: I'm refactoring the way we deal with LLVM types, this means changing every place that takes a TypeRef and uses the T_* fns
[13:49:41] <xenocons> MaikKlein: ah, mostly just reddit.com/r/rust
[13:49:47] <aatch> I've been doing this for about 6 hours now, I'm down to build
[13:49:49] <xenocons> but i keep an eye on the mailing list too (or try to)
[13:50:03] <dbaupp> MaikKlein: and the github wiki (specifically the meetings)
[13:50:12] <dbaupp> aatch: sounds horrible
[13:50:24] <dbaupp> aatch: isn't llvm-rs good enough?
[13:50:34] <xenocons> btw whats the idea behind allowing 'use' within functions?
[13:50:51] <aatch> dbaupp, llvm-rs is much more integrated.
[13:51:11] <aatch> So I would have to mass-convert rustc to use it.
[13:51:12] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[13:51:12] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_mkS6Q
[13:51:12] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[13:51:37] <dbaupp> xenocons: it's nice for scoping, e.g. when you need a method from a trait only once and don't want to pollute the "method namespace"
[13:51:50] <dbaupp> aatch: i.e. waaaay more work?
[13:52:00] <aatch> dbaupp, yep.
[13:52:15] <aatch> Like ~600 errors to ~6000 errors kind of "waaaay"
[13:52:22] <dbaupp> heh
[13:52:31] <dbaupp> :D
[13:52:33] <xenocons> dbaupp: ah right
[13:52:41] <kimundi> xenocons: Generally, everything that works outside of a function (eg, fn declaration, use) works also inside of it. Tke function acts as a private moudle in this case
[13:53:07] <xenocons> interesting, wonder if erlang esque modularity could work with that ;)
[13:53:44] <xenocons> (reloading a module after its changed on disk without restarting program)
[13:54:05] <doener> dbaupp: for now, I'm only improving it to get LLVm to generate better code. Is there a plan to remove it? I'd assumed that it is in some way required...
[13:54:13] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:54:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oH995Q
[13:54:13] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:55:15] <kimundi> xenocons: In general that kind of dynamic code swaping is very incompatible with rusts system
[13:55:17] <aatch> doener, I don't think there is a plan, no
[13:55:35] <aatch> hot code swapping is very, very hard in a native language
[13:55:40] <dbaupp> doener: IIRC, brson said that 40% of the time of trans when compiling librustc(?) was spent on glue, so there is certainly a plan to improve it
[13:55:48] <aatch> doener, it's just that the glue code is terrible.
[13:56:03] <aatch> dbaupp, pcwalton found that out, but you are correct.
[13:56:18] <dbaupp> eh, people are all the same
[13:56:27] <aatch> Though I'm not sure if it's in /doing/ glue or /emitting/ glue.
[13:56:28] <xenocons> kimundi: yeah i would say so too hehe
[13:56:33] <doener> so far my changes made --no-trans for librustc go from 9.6s to 8.4s
[13:56:44] <xenocons> although it could have its benefits
[13:56:47] <dbaupp> gagahgghagdfhsf, another merge failed :/
[13:56:59] <aatch> I'm inclined towards to the former
[13:57:00] <doener> let's see what numbers I get with --emit-llvm
[13:57:03] <Thiez> doener: that's excellent!
[13:57:09] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[13:57:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oH995Q
[13:57:09] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[13:57:10] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:57:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/dp8N8w
[13:57:10] <ghrust> 13rust/06auto 141854256 15Huon Wilson: std: rename .connect/.concat in VectorVector to avoid conflicting with StrVector....
[13:57:10] <ghrust> 13rust/06auto 1482f2e4d 15bors: auto merge of #7147 : huonw/rust/vec-connect, r=Aatch...
[13:57:11] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:57:50] <dbaupp> heh, at this rate, I'll have run about 10 PRs in a row through bors.
[13:58:09] <Thiez> I'm sure it won't mind.
[13:58:45] <bstrie> oh, is bors back up?
[13:58:52] <bstrie> need to change the topic back
[13:58:57] <aatch> bstrie, has been all day.
[13:59:05] <Thiez> why was it dead?
[13:59:15] <Thiez> incoming->master switch?
[13:59:19] <dbaupp> yeah
[13:59:19] <bstrie> that, and chaos
[13:59:24] <Thiez> and chaos, naturally.
[13:59:28] <dbaupp> there's still some chaos
[13:59:36] <Thiez> the closed pull requests?
[13:59:56] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[13:59:57] <aatch> I'm up to 'C'
[14:00:16] <dbaupp> Thiez: that, and general instability, I think
[14:00:17] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[14:00:30] <doener> hm, about the same difference in total. trans gets faster (6.8s to 6.1s) but llvm-passes get slower (7.4s to 8.1s)
[14:00:40] <doener> probably because I'm currently emitting too many casts
[14:00:48] <aatch> doener, ahh
[14:00:50] <dbaupp> Thiez: there were/are tests that segfault/fail randomly
[14:00:56] <doener> and llvm gets a better chance at inlinig, which probably also adds some time
[14:00:57] <dbaupp> aatch: C?
[14:01:21] <aatch> doener, you can use -Z time-llvm-passes to see the timing for the LLVM passes btw
[14:01:23] <dbaupp> aatch: https://github.com/mozilla/rust/pull/7123 r? (again...)
[14:01:35] <aatch> dbaupp, I'm going in alphabetical order.
[14:01:45] <dbaupp> order of?
[14:01:57] <Blei> heh, starting to read trans and find dead code immediately
[14:02:08] <doener> oh, nice, librustc-....so went from 16162576 to 15295504
[14:02:23] <Blei> doener: good job!
[14:03:03] <dbaupp> Blei: don't touch it (much) though! aatch will be very unhappy if you get a pr in before him, 'cause he's in the middle of a huge refactoring
[14:03:27] *** Quits: jaen (jaen@moz-56060390.play-internet.pl) (Ping timeout)
[14:03:42] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[14:03:49] <Blei> aatch: remove trans_foreign_code and get_simple_extern_fn please :) as you are already messing with that code
[14:04:08] <aatch> Blei, they are never called?
[14:04:13] <Blei> *trans_foreign_call
[14:04:21] <Blei> git grep doesn't find anything
[14:04:41] <Blei> and get_simple_extern_fn looks really silly
[14:04:46] <aatch> I was wondering about that one.
[14:04:55] <Blei> but that might just be my limited understanding of trans
[14:05:05] <aatch> Blei, no, it's pretty silly.
[14:08:17] <Thiez> surely finding dead fns should be easy? grep for 'fn ([^\(]+)', then for each match, grep for the matching part and if it only occurs once in the sourcecode you've found a dead function
[14:08:57] <aatch> Thiez, for simple cases like that, yes.
[14:08:59] <Thiez> a lint-pass would be even nicer
[14:09:15] <Blei> Thiez: lint doesn't work for public functions though
[14:09:18] <aatch> Thiez, wouldn't work. pub fns in a library
[14:09:32] <Thiez> fair point.
[14:09:54] <Thiez> ignore the pub fns, and any fn that can be reached through either pub fns or main
[14:10:13] <Thiez> lint should be able to do this :)
[14:10:22] <Blei> btw. so many functions and methods that don't have to be are public in rustc, or is it just me?
[14:10:50] * dbaupp would like an 'in-crate' pub
[14:10:51] <aatch> Blei, a reasonable number, but not that many actually.
[14:10:51] <Thiez> try removing 'pub' and see if anything explodes ;)
[14:11:00] <aatch> dbaupp, same.
[14:11:37] <Thiez> perhaps no priv/pub shouldn't default to priv, but 'in-crate' pub instead?
[14:11:50] <aatch> Like Java!
[14:12:04] <Thiez> Like Java.
[14:12:18] <Thiez> (and yes I'm serious :p)
[14:22:03] <kemurphy> are there docs somewhere for the --cfg option in rustc?
[14:23:50] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[14:25:03] <dbaupp> kemurphy: the command line functionality is free-form and the syntax is the same as the #[cfg(...)] syntax
[14:25:47] <dbaupp> e.g. rustc --cfg 'foo="bar"'
[14:26:27] <kemurphy> dbaupp: ah, i guess i'm looking for docs on that then :)
[14:26:52] <dbaupp> kemurphy: oh, the best docs are the meta_item_ enum in syntax/ast.rs
[14:27:36] * kemurphy reads
[14:27:40] <kemurphy> thanks
[14:27:40] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[14:28:03] <dbaupp> the options are either an identifier #[cfg(foo)], an identifier with a list of meta-items #[cfg(foo(bar, baz))] or an identifer set to a literal, e.g. foo="bar" or foo=1
[14:28:22] <dbaupp> (I can't seem to get the meta-list one to work with --cfg though.)
[14:31:59] <kemurphy> dbaupp: can this be used for arbitrary conditional compilation?
[14:32:16] <aatch> kemurphy, not completely arbitrary
[14:32:27] <kemurphy> like, only include mod debug if cfg(debug="yes")
[14:32:33] <aatch> only works at the level of items
[14:32:40] <aatch> but yes, that would work.
[14:32:47] <kimundi> But you can do boolean algebra on them.
[14:33:10] <dbaupp> kemurphy: also, the cfg'd off section still has to parse and any macros still have to expand correctly
[14:33:16] <kimundi> #[cfg(and(not(Foo), Bar))]
[14:33:42] <dbaupp> and listing multiple #[cfg]'s is or
[14:34:16] <aatch> dbaupp, so I'm like 1/3rd of the way through this bit. git tells me: 13 files changed, 500 insertions, 605 deletions.
[14:34:44] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[14:34:47] <aatch> and a rewrite of a file.
[14:35:38] *** Joins: jesse99 (jesse99@moz-F226420.hsd1.wa.comcast.net)
[14:36:10] <kemurphy> will they apply to attributes below them? like, #[cfg(SuperFoo)] #[path="super_foo.rs"] mod foo;
[14:36:45] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[14:36:45] <dbaupp> kemurphy: sort of. the entire item and all it's attributes get removed
[14:36:59] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[14:37:09] * dbaupp wonders how #[cfg] and #[deriving] interact
[14:37:23] <aatch> dbaupp, probably poorly.
[14:37:32] <dbaupp> aatch: yeah
[14:37:48] *** cscottnet_away is now known as cscottnet
[14:37:49] <dbaupp> #[deriving]'d impls should probably inherit the cfgs of their parent...
[14:38:13] <aatch> Anyway, Ima sleep now since the thought of continuing this is putting me to sleep.
[14:42:45] *** Quits: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de) (Client exited)
[14:43:30] <xenocons> rusti: struct X {a:int,b:int}; [1u8,2u8] as X
[14:43:31] -rusti- <anon>:9:39: 9:53 error: non-scalar cast: `[u8, .. 2]` as `main::X`
[14:43:31] -rusti- <anon>:9     let r = {  struct X {a:int,b:int}; [1u8,2u8] as X };
[14:43:31] -rusti-                                                 ^~~~~~~~~~~~~~
[14:43:31] -rusti- error: aborting due to previous error
[14:43:32] -rusti- application terminated with error code 101
[14:43:58] <xenocons> rusti: struct X {a:int,b:int}; &[1u8,2u8] as X
[14:43:59] -rusti- <anon>:9:39: 9:54 error: non-scalar cast: `&[u8]` as `main::X`
[14:43:59] -rusti- <anon>:9     let r = {  struct X {a:int,b:int}; &[1u8,2u8] as X };
[14:43:59] -rusti-                                                 ^~~~~~~~~~~~~~~
[14:43:59] -rusti- error: aborting due to previous error
[14:44:00] -rusti- application terminated with error code 101
[14:44:04] <xenocons> suspected as much
[14:44:09] <Thiez> it's correct though.
[14:44:32] <xenocons> i dont know cast semantics for structs in rust hehe
[14:45:30] <xenocons> rusti: struct X {a:int,b:int}; [1u8,2u8,3u8,4u8,2u8,3u8,4u8,5u8] as X
[14:45:31] -rusti- <anon>:9:39: 9:77 error: non-scalar cast: `[u8, .. 8]` as `main::X`
[14:45:31] -rusti- <anon>:9     let r = {  struct X {a:int,b:int}; [1u8,2u8,3u8,4u8,2u8,3u8,4u8,5u8] as X };
[14:45:31] -rusti-                                                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[14:45:31] -rusti- error: aborting due to previous error
[14:45:31] -rusti- application terminated with error code 101
[14:45:49] <xenocons> what exactly is 'non-scalar'
[14:46:01] <aatch> Hmm, I wonder if all those @mut Hashmap::new() calls in ty::mk_ctxt is what makes it huge
[14:46:25] <engla> xenocons: I guess a composite type
[14:46:30] <kimundi> xenocons: The cast semantics in rust are simple: You can cast one build-in number type to another, you can cast a char to/from in buildin number type, and you can cast a typepointer to a traitpointer if the type implements the trait
[14:46:32] <engla> made up of multiple parts
[14:46:32] <Thiez> rusti: use std::unstable::intrinsics::size_of; struct X {a:int,b:int}; unsafe { (size_of::<X>(),size_of::<[u8,..8]>())  }
[14:46:34] -rusti- (16, 8)
[14:46:54] <xenocons> kimundi: hm
[14:47:03] <xenocons> Thiez: oh i, nice
[14:47:08] <aatch> you can also cast to a *-ptr
[14:47:08] <xenocons> thatl be useful for network stuff
[14:47:17] <kimundi> for everything else: helper functions that use transmute internally
[14:47:36] <xenocons> transmute, feeling like an alchemist
[14:47:39] <Thiez> in general you don't want to be casting 'int' and 'uint' to other types because they might be 4 or 8 bytes long
[14:47:50] <xenocons> Thiez: right, should be explicit
[14:47:57] <Thiez> except to pointers :)
[14:47:58] <xenocons> (u32 etc)
[14:48:07] <aatch> rusti: (0x7f as *char)
[14:48:08] -rusti- 127
[14:48:28] <aatch> rusti: (0x7f354251 as *u8)
[14:48:29] -rusti- 2134196817
[14:48:33] <aatch> rusti: *(0x7f354251 as *u8)
[14:48:34] -rusti- <anon>:9:15: 9:37 error: dereference of unsafe pointer requires unsafe function or block
[14:48:34] -rusti- <anon>:9     let r = {  *(0x7f354251 as *u8) };
[14:48:34] -rusti-                         ^~~~~~~~~~~~~~~~~~~~~~
[14:48:34] -rusti- error: aborting due to previous error
[14:48:34] -rusti- application terminated with error code 101
[14:48:43] <aatch> rusti: unsafe { *(0x7f354251 as *u8) }
[14:48:44] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[14:48:48] <xenocons> heh
[14:49:05] <kimundi> AND you can cast an integer to/from a unsafe pointer
[14:49:07] <kimundi> :P
[14:49:08] <Thiez> rusti: unsafe{ *(&0x7f as *char) }
[14:49:09] -rusti- <anon>:9:25: 9:30 error: mismatched types: expected `*char` but found `&<VI0>` (expected an integral type but found char)
[14:49:09] -rusti- <anon>:9     let r = {  unsafe{ *(&0x7f as *char) } };
[14:49:10] -rusti-                                   ^~~~~
[14:49:10] -rusti- error: aborting due to previous error
[14:49:10] -rusti- application terminated with error code 101
[14:49:21] <Thiez> hmmn, oops :)
[14:49:43] *** aatch is now known as aatch|TYPES
[14:50:52] <xenocons> rusti: unsafe{ (*((*)()) 0x414141)() }
[14:50:52] -rusti- <anon>:9:28: 9:29 error: unexpected token: `)`
[14:50:53] -rusti- <anon>:9     let r = {  unsafe{ (*((*)()) 0x414141)() } };
[14:50:53] -rusti-                                      ^
[14:50:53] -rusti- application terminated with error code 101
[14:51:10] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[14:51:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/dp8N8w
[14:51:10] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[14:51:38] <Thiez> xenocons: what are you doing? :p
[14:52:15] <xenocons> char x[] = "AAAA"; (*(void(*)()) x)();
[14:52:17] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[14:52:39] <Thiez> oO
[14:53:05] <dbaupp> rusti: unsafe { cast::transmute::<u64, &fn()>(1)() }
[14:53:07] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/XWIe
[14:53:18] <dbaupp> rusti: unsafe { std::cast::transmute::<u64, &fn()>(1)() }
[14:53:19] -rusti- <anon>:1:0: 1:0 error: transmute called on types with different sizes: u64 (64 bits) to &'static fn() (128 bits)
[14:53:19] -rusti- <anon>:1 #[allow(unused_variable)];
[14:53:19] -rusti-          ^
[14:53:19] -rusti- application terminated with error code 101
[14:53:48] <dbaupp> rusti: unsafe { (*std::cast::transmute::<u64, &extern "Rust" fn()>(1))() }
[14:53:49] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[14:53:57] *** Joins: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net)
[14:54:04] *** Joins: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de)
[14:54:06] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[14:54:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Z1f8HQ
[14:54:06] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[14:54:08] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:54:08] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/bX-pCw
[14:54:08] <ghrust> 13rust/06auto 147b69df0 15Huon Wilson: std: convert str::{map,levdistance,subslice_offset} to methods....
[14:54:08] <ghrust> 13rust/06auto 140e04ec1 15Huon Wilson: std: convert str::to_utf16 to a method.
[14:54:08] <dbaupp> rusti: unsafe { (std::cast::transmute::<u64, extern "Rust" fn()>(1))() }
[14:54:09] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[14:54:09] <ghrust> 13rust/06auto 147822dbe 15Huon Wilson: std: simplify the string comparison implementations, using iterators.
[14:54:11] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:54:18] <xenocons> Thiez: its actually quite nasty
[14:55:07] <Thiez> xenocons: I figured as much
[14:55:32] <xenocons> but probably also demonstrates the insane flexibility of C
[14:56:48] <xenocons> hm long time no gdb
[14:57:13] <Thiez> xenocons: sure, but what does it do?
[14:57:18] <xenocons> Program received signal SIGSEGV, Segmentation fault.
[14:57:18] <xenocons> 0x00000000006009b0 in shellcode ()
[14:57:24] <xenocons> (gdb) x/s $rip
[14:57:24] <xenocons> 0x6009b0 <shellcode>:	 "AAAA"
[14:57:43] <xenocons> Thiez: http://stackoverflow.com/questions/5051974/casting-function-pointer for an answer better than i could give
[14:57:58] <dbaupp> xenocons: it's possible in Rust too
[14:58:10] <xenocons> dbaupp: aslong as you use unsafe{} one would hope hehe
[14:58:28] <dbaupp> rusti: unsafe { (std::cast::transmute::<u64, extern "Rust" fn()>(0x41414141))() }
[14:58:29] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[14:58:36] <dbaupp> xenocons: yes
[14:58:51] <xenocons> if we can do it without uunsafe {} can i get a medal
[14:59:13] <xenocons> (i have no expectation to find this heh)
[14:59:18] <dbaupp> only if you can do it without a segfault
[14:59:36] <xenocons> silently, address of system()
[15:01:24] <kemurphy> hm, so i want to import everything from one module into the scope of another module
[15:01:32] <kemurphy> e.g. cola::open() instead of cola::pepsi::open()
[15:01:52] <dbaupp> pub use pepsi::*; in cola
[15:01:55] <kemurphy> (a different compilation might want to use cola::coke::open() instead)
[15:02:14] <dbaupp> (possibly 'pub use self::pepsi::*;')
[15:03:23] <kemurphy> but i have to have #[path="pepsi/mod.rs"] mod pepsi; in cola as well, though
[15:03:51] <dbaupp> yes
[15:04:11] <dbaupp> and the use has to go above the mod.
[15:07:34] *** Joins: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:07:45] *** Quits: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net) (Ping timeout)
[15:08:15] *** Joins: kemurphy_ (Mibbit@moz-690C3719.ap.yournet.ne.jp)
[15:08:35] <kemurphy_> ugh ssh from japan is entirely unacceptable
[15:08:50] <kemurphy_> anyway, the use gives me an unresolved import error
[15:10:09] *** kimundi is now known as zz_kimundi
[15:12:40] <kemurphy> ah, never mind, self:: made it work
[15:13:15] *** Quits: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[15:13:15] *** Quits: BitPuffin (quassel@moz-72F092D.cust.tele2.se) (Connection reset by peer)
[15:13:38] *** Joins: BitPuffin (quassel@moz-22CD6C9E.cust.tele2.se)
[15:15:07] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[15:15:07] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1462ffe95 to 1482f2e4d: 02http://git.io/N3iJvQ
[15:15:07] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[15:15:08] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[15:15:08] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/hXpwmw
[15:15:08] <ghrust> 13rust/06auto 141adbb45 15Tim Chevalier: rustc: Don't continue to resolve if there's an error in lang_items...
[15:15:08] <ghrust> 13rust/06auto 14e3c4104 15Tim Chevalier: rustpkg: Write more automated tests...
[15:15:08] <ghrust> 13rust/06auto 14eac0200 15bors: auto merge of #7148 : catamorphism/rust/rustpkg_tests, r=graydon...
[15:15:10] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[15:16:57] <Blei> wtf, @ drop glue
[15:17:13] <Blei> they load the value than store it into a new allocation than free the new allocation
[15:19:08] *** Joins: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net)
[15:19:08] *** zz_kimundi is now known as kimundi
[15:19:13] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[15:19:13] <kemurphy> is there a way to add a catchall for a cfg variable? e.g. #[cfg(cola="pepsi")] ... #[cfg(cola="coke")] ... #[cfg(cola=_)]
[15:20:28] <doener> r? https://github.com/mozilla/rust/pull/7154
[15:21:35] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[15:22:13] <Blei> 13% improvement with a diff of ~50 lines? you are a wizard
[15:22:25] <Blei> wizzard, even
[15:22:49] *** Quits: MaikKlein (maik@moz-94281F77.dip0.t-ipconnect.de) (Ping timeout)
[15:23:46] <doener> Blei: regarding the drop glue, are you looking at the generated llvm code?
[15:24:04] <Blei> no, only the rust code at the moment
[15:24:11] <Blei> first trying to make sense of it all :)
[15:25:10] *** Joins: cstrahan (cstrahan@moz-4C7E5789.hsd1.dc.comcast.net)
[15:25:13] <doener> Blei: hm, where is that part you wondered about?
[15:26:13] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:26:17] <Blei> basically free_ty_immediate, and that it's called from decr_refcnt_maybe_free/make_drop_glue
[15:26:43] <Blei> as there is already a pointer available to use in this case, instead of creating a new alloca that has to be optimized out again
[15:26:52] <Blei> unless i'm missing something and this alloca is important
[15:27:37] <doener> Blei: the alloca is for the type t, so the type of the alloca is "pointer to t"
[15:27:53] <doener> Blei: i.e. you get a ref that way, because glue functions always expect refs
[15:28:03] *** Quits: cstrahan (cstrahan@moz-4C7E5789.hsd1.dc.comcast.net) (Quit: leaving)
[15:28:34] <Blei> i know, but in the case mentioned above we actually have access to a pointer already, but instead of using it, we create a new alloca
[15:28:38] <doener> i.e. that's roughly like: let vp: &T = v; free_ty(vp)
[15:30:00] <Blei> but yeah, it probably doesn't really make a difference
[15:31:13] <doener> Blei: oh, now I see. You mean that you have the pointer in make_drop_glue, but it's not passed along to decr_refcnt_... and thus we need the alloca in drop_ty_immediate. 
[15:31:24] <Blei> exactly
[15:31:47] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[15:32:29] <doener> err, free_ty_immediate
[15:33:12] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[15:35:29] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[15:36:06] <Blei> doener: also, why do we have to check for null in decr_refcnt_maybe_free? isn't the point about rust that there are not null-pointers?
[15:36:37] <doener> Blei: to the user, yes. Internally, no.
[15:36:49] <doener> Blei: when a unique pointer is moved, the original pointer is zeroed
[15:37:19] <doener> Blei: that's required if you might or might not move the pointer, you need some way to decide whether or not to call free
[15:37:52] <Blei> ah, i see
[15:38:09] <Blei> can't this decision be communicated to the codegen?
[15:38:10] <doener> Blei: not sure why it's needed in _that_ place though, as it looks like it's for gc pointers
[15:38:25] <Blei> i guess gc pointers can be moved too
[15:39:05] <doener> Blei: consider "let x = ~"Str"; if (external_parameter) { func_that_causes_a_move(x) };
[15:39:36] <doener> Blei: it's only known at runtime whether it needs to free at the end of a function containing that code
[15:39:49] <Thiez> doener: sure, but that could be translated to "let x = ~"Str"; if (externa_parameter) { func_that_causes_a_move() } else { drop_glue(x) }
[15:39:54] <Blei> that makes sense
[15:40:03] <Blei> yeah, that would be an obvious optimization
[15:40:09] <Blei> maybe that just isn't done yet
[15:40:58] <doener> would require one call to drop_glue() for each conditional move though, instead of one per scope
[15:41:25] <Blei> you can't have more than one conditional move per scope, can you?
[15:42:03] <Blei> else the code after the conditional move might access invalid memory
[15:42:18] <Thiez> let x = ~"str"; let y = ~"other_str"; if (condition) { move(x) ; move(y) } :p
[15:42:28] <Thiez> but I think there is another reason the code is as it is now
[15:42:31] <Thiez> unwinding
[15:42:59] <Thiez> if 'func_that_causes_a_move' fails, should we drop x?
[15:43:01] <Thiez> answer is 'maybe'
[15:43:13] <Blei> well, no
[15:43:26] <Blei> as we know that the value was moved into that function, if that function failed
[15:43:38] <Blei> so the drop should happen there
[15:43:51] <Thiez> what if we fail *before* calling the function that moves
[15:44:01] <Blei> then we know that the value wasn't moved
[15:44:08] <Blei> ah, good point
[15:44:28] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:44:32] <Thiez> but the stack unwinder may have trouble knowing where it was in the function? I don't know exactly how it works
[15:44:52] <Thiez> but by writing NULL to x after moving, it becomes easy: if it's NULL, don't drop, otherwise drop
[15:44:55] <Blei> yeah, that might be
[15:45:33] <Thiez> I wonder who invented the drop magic, perhaps they could explain in detail
[15:47:28] <doener> Blei: https://gist.github.com/dotdash/5788517 -- ignoring that "match 5" is fixed, this would either require three drop calls (for 4, 5 and 7) or some flag that is set by the branches, which ends up being the same as the current zeroing
[15:51:38] <Blei> hmm, very good argument
[15:54:51] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[16:03:08] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[16:03:15] *** Quits: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp) (Client exited)
[16:03:19] *** Joins: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP)
[16:03:21] *** Quits: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP) (Client exited)
[16:03:36] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[16:08:37] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[16:09:13] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[16:15:13] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[16:15:13] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/hXpwmw
[16:15:13] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[16:18:16] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[16:18:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/rhYZtw
[16:18:16] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[16:18:53] *** Quits: pyrac (pyrac@moz-B2CB8564.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[16:21:18] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[16:23:18] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Connection reset by peer)
[16:24:58] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[16:27:12] <Blei> doener: about the null-checking for the drop glue: interestingly, this doesn't happen for ~ptrs
[16:28:00] <Blei> oh, wait, it does
[16:28:05] <Blei> just not where i expected it
[16:28:26] <doener> yeah, it's in free
[16:28:58] *** Quits: BitPuffin (quassel@moz-22CD6C9E.cust.tele2.se) (Ping timeout)
[16:32:45] *** Joins: dr_bibble (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP)
[16:32:53] <Thiez> perhaps it would be easier to rewrite (and document!) the drop stuff compared to understanding what currently happens ;)
[16:36:40] <dr_bibble> can you assign the result of a for loop to a variable in rust? what i have in mind is, say, ocaml's let sum = ref 0 in for i = 0 to 10 do sum := sum + k done;
[16:37:23] <dr_bibble> my attempts caused "A for-loop body must return (), but it returns uint here." error, so i'm obviously doing something wrong.
[16:37:54] <Thiez> dr_bibble: perhaps you should use 'do' instead of 'for'? :)
[16:39:24] <Blei> rusti: let res = { let mut i = 0; for std::int::range(1, 10) |k| {i += k} i}; i
[16:39:25] -rusti- <anon>:9:86: 9:87 error: unresolved name `i`.
[16:39:25] -rusti- <anon>:9     let r = {  let res = { let mut i = 0; for std::int::range(1, 10) |k| {i += k} i}; i };
[16:39:25] -rusti-                                                                                                ^
[16:39:25] -rusti- error: aborting due to previous error
[16:39:26] -rusti- application terminated with error code 101
[16:39:40] <Blei> rusti: let res = { let mut i = 0; for std::int::range(1, 10) |k| {i += k} i}; res
[16:39:41] -rusti- 45
[16:40:15] <dr_bibble> oh, ok, delimiter blocks. my bad. :)
[16:40:15] <Blei> i think that's the closest you can get
[16:41:43] <doener> rusti: do fold(0, std::int::range(1, 10)) |a,x| *a += x
[16:41:43] -rusti- <anon>:9:56: 9:57 error: expected `{` but found `*`
[16:41:44] -rusti- <anon>:9     let r = {  do fold(0, std::int::range(1, 10)) |a,x| *a += x };
[16:41:44] -rusti-                                                                  ^
[16:41:44] -rusti- application terminated with error code 101
[16:41:51] <doener> rusti: do fold(0, std::int::range(1, 10)) |a,x| { *a += x }
[16:41:52] -rusti- <anon>:9:18: 9:22 error: unresolved name `fold`.
[16:41:52] -rusti- <anon>:9     let r = {  do fold(0, std::int::range(1, 10)) |a,x| { *a += x } };
[16:41:52] -rusti-                            ^~~~
[16:41:53] -rusti- error: aborting due to previous error
[16:41:53] -rusti- application terminated with error code 101
[16:42:03] <doener> rusti: do std::iter::fold(0, std::int::range(1, 10)) |a,x| { *a += x }
[16:42:04] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/BMdT
[16:43:06] <Thiez> rusti: use std::iterator::*; use std::uint::*; let arr = std::uint::range(1,10); arr.iter().fold(0, |a, &b| a+b)
[16:43:08] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/bgOO
[16:44:34] <Thiez> std::uint::range(1u,10)
[16:44:45] <Thiez> rusti: std::uint::range(1u,10)
[16:44:46] -rusti- <anon>:9:15: 9:40 error: this function takes 3 parameters but 2 parameters were supplied
[16:44:47] -rusti- <anon>:9     let r = {  std::uint::range(1u,10) };
[16:44:47] -rusti-                         ^~~~~~~~~~~~~~~~~~~~~~~~~
[16:44:47] -rusti- error: aborting due to previous error
[16:44:47] -rusti- application terminated with error code 101
[16:44:51] <Thiez> rusti: std::uint::range(1u,10,1)
[16:44:52] -rusti- <anon>:9:38: 9:39 error: mismatched types: expected `&fn(uint) -> bool` but found `<VI1>` (expected fn but found integral variable)
[16:44:53] -rusti- <anon>:9     let r = {  std::uint::range(1u,10,1) };
[16:44:53] -rusti-                                                ^
[16:44:55] -rusti- error: aborting due to previous error
[16:44:55] *** concrete.mozilla.org sets mode: +M 
[16:44:56] -rusti- application terminated with error code 101
[16:46:16] *** Joins: blitter (blitter@moz-FB45689C.dyn.centurytel.net)
[16:48:58] <Blei> huh, why the registration requirement all of a sudden?
[16:49:24] <Blei> rusti: 1
[16:49:25] -rusti- 1
[16:49:39] <Blei> rusti is registered? i'm impressed
[16:49:52] *** concrete.mozilla.org sets mode: -M 
[16:51:01] *** Quits: jfbk (user@moz-EEA9CFB3.nyc.res.rr.com) (Ping timeout)
[16:51:04] <Thiez> eh, sorry about the spam, I thought I was using my rusti query window :p
[16:51:06] *** cscottnet is now known as cscottnet_away
[16:51:18] <Thiez> still, +M seems excessive :p
[16:54:06] *** Joins: snearch (snearch@moz-4A49F529.pool.mediaways.net)
[16:54:43] <Thiez> dr_bibble: btw, this works:
[16:54:49] <Thiez> rusti: use std::iterator::*; let arr = [1u,2,3,4,5]; do arr.iter().fold(0) |a,b| {a+*b}
[16:54:50] -rusti- 15
[16:57:33] <kimundi> Thiez: There where a few mass ddos spam attacks on this channel in the past, the strict rules are because of that
[16:57:52] *** Joins: pyrac (pyrac@moz-B2CB8564.w92-156.abo.wanadoo.fr)
[16:58:26] <engla> Thiez: as long as spam response is quick and is reset quick, it can be excessive
[16:58:32] <Thiez> fair enough
[16:59:04] <dr_bibble> thx, that seems nice and concise. what's the iter() function, though? it's not in vec module, as far as I can find in the manual
[16:59:29] <dr_bibble> oh, got it.
[16:59:35] <engla> in git master
[16:59:58] <Thiez> the manual is full of lies and misinformation ;)
[17:00:16] <Thiez> 'Luke, use the source.'
[17:00:36] <dr_bibble> :D also, I hear that internal iterators are going away, will that affect this kind of code?
[17:00:42] <Blei> hmm, in which cases is the free glue called, in which cases the drop glue?
[17:01:00] <engla> dr_bibble: .iter() is the external iterators, so that's the new style
[17:01:02] <kimundi> dr_bibble: NO, in fact this kind of code is the reason they go away :)
[17:01:10] <dr_bibble> oh, i see.
[17:01:59] <Blei> as the struct constructor is called in both cases
[17:02:29] <Blei> *destructor
[17:03:41] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[17:03:50] *** Quits: kemurphy_ (Mibbit@moz-690C3719.ap.yournet.ne.jp) (Quit: http://www.mibbit.com ajax IRC Client)
[17:05:06] <Thiez> from the names I would guess that drop glue is called only when the type it is dropping implements Drop, and free just frees, but it's all black magic and voodoo in there
[17:07:21] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[17:10:02] <Blei> let's see what happens if i remove the one in free
[17:10:43] <Thiez> death and destruction.
[17:10:53] <Blei> :3
[17:10:56] *** cscottnet_away is now known as cscottnet
[17:10:58] <Blei> it wasn't me
[17:12:28] <doener> Blei: drop is when a reference is dropped, free is when the allocation is actually freed (usually from drop)
[17:13:01] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[17:13:16] <Blei> so free shouldn't be called for structs, right?
[17:13:27] <Blei> (bbiab, dinner)
[17:15:13] *** Joins: jed (chatzilla@moz-9E392403.natpool.nyu.edu)
[17:15:26] *** Quits: pyrac (pyrac@moz-B2CB8564.w92-156.abo.wanadoo.fr) (Ping timeout)
[17:15:34] *** Parts: jed (chatzilla@moz-9E392403.natpool.nyu.edu) ()
[17:19:08] *** Quits: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:19:37] *** Joins: goldfeld (Mibbit@moz-4C4BC521.dynamic.adsl.gvt.net.br)
[17:21:40] *** Quits: dr_bibble (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:24:57] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Ping timeout)
[17:25:32] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[17:25:52] *** Joins: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr)
[17:29:16] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[17:31:04] *** Joins: raisin (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP)
[17:37:29] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[17:37:53] *** Joins: jaen (jaen@moz-56060390.play-internet.pl)
[17:38:40] *** Joins: FreezerburnV (freezerbur@moz-5718C330.bltmmd.fios.verizon.net)
[17:40:38] *** Quits: RMF (RMF@moz-52102471.dsl.telepac.pt) (Ping timeout)
[17:42:49] <cmr> kimundi: Visually I think I like @(Ar, ar) best
[17:43:48] *** Quits: sam (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.0)
[17:43:57] *** Joins: RMF (RMF@7CB4432F.59969257.8D19547B.IP)
[17:44:02] *** Quits: raisin (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:44:17] *** Joins: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:44:21] <nmatsakis> erickt: pong
[17:44:30] *** Quits: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[17:44:50] <erickt> oh, hey nmatsakis. I was just seeing yesterday if the tree was still closed
[17:45:13] <nmatsakis> erickt: ok. sorry, took yesterday off.
[17:45:18] <erickt> s'alright :)
[17:45:43] *** Joins: sam (sam@moz-ADDDDFB1.mc.videotron.ca)
[17:46:25] <Blei> oh noez, the stack canary is dead
[17:49:08] <Blei> hmm, is the free glue ever called without a preceding drop?
[17:49:27] *** Joins: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP)
[17:49:51] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:50:17] *** Quits: FreezerburnV (freezerbur@moz-5718C330.bltmmd.fios.verizon.net) (Quit: FreezerburnV)
[17:52:22] *** Joins: matcc (matcc@E2E0592D.45914675.C6B320EF.IP)
[17:54:13] *** Joins: carter (carter@moz-12C317EF.nyc.res.rr.com)
[17:54:21] *** Quits: matcc (matcc@E2E0592D.45914675.C6B320EF.IP) (Quit: matcc)
[17:55:04] *** Joins: matcc (matcc@E2E0592D.45914675.C6B320EF.IP)
[17:55:04] *** Quits: matcc (matcc@E2E0592D.45914675.C6B320EF.IP) (Max SendQ exceeded)
[17:55:08] *** Joins: matcc (matcc@E2E0592D.45914675.C6B320EF.IP)
[17:55:08] *** Quits: matcc (matcc@E2E0592D.45914675.C6B320EF.IP) (Max SendQ exceeded)
[17:55:15] *** Joins: matcc (matcc@E2E0592D.45914675.C6B320EF.IP)
[17:55:15] *** Quits: matcc (matcc@E2E0592D.45914675.C6B320EF.IP) (Max SendQ exceeded)
[17:57:50] <kimundi> cmr: Interesting
[17:58:09] <cmr> kimundi: What about stashing a borrowed reference into a data structure somewhere?
[17:58:24] <kimundi> cmr: Hm?
[17:58:52] <kimundi> I don't understand what you mean :)
[17:58:57] <cmr> Sec]
[17:59:47] <engla> is there a way to force access to private struct members?
[17:59:57] <kimundi> transmute :P
[18:02:21] <nmatsakis> egads but I cannot read macro definitions.
[18:02:25] <engla> nice, it works kimundi 
[18:02:28] <nmatsakis>         $($message:path$(($($x: ident),+))||* -> $next:ident $e:expr)+
[18:03:07] <engla> with three $(..) wrapped it gets confusing
[18:03:12] <engla> *nested
[18:05:33] <nmatsakis> engla: yes, it does :) I figured it out though. a comment would have helper.
[18:05:35] <nmatsakis> *helped.
[18:05:41] <cmr> rusti: struct Foo<'self> {x: &'self int} impl<'self> Foo<'self> { fn foo(&'self mut self, x: &'self int) { self.x = x; } }
[18:05:43] -rusti- ()
[18:05:50] <cmr> kimundi: how would something like that work?
[18:05:57] *** Joins: KindOne (KindOne@moz-85B4BE9F.dynamic.ip.windstream.net)
[18:06:01] <cmr> kimundi: given that you borrow by using a closure
[18:07:11] <nmatsakis> Blei: I think we should only directly invoke drop.
[18:07:16] <Blei> let _: () = { foo(); } is the same as foo();, right?
[18:07:24] <Blei> nmatsakis: ah, thanks
[18:07:41] <Blei> why the distinction between drop and free then? couldn't they be rolled into one?
[18:10:23] <nmatsakis> Blei: dropping @T does not necessarily free it.
[18:10:38] *** Quits: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP) (Quit: Leaving)
[18:10:52] <nmatsakis> Blei: but ... yes I imagine they could be.
[18:11:21] *** Quits: KindOne (KindOne@moz-85B4BE9F.dynamic.ip.windstream.net) (Ping timeout)
[18:12:21] <nmatsakis> Blei: anyhow I think that's the conceptual distinction: drop removes your reference, which sometimes (but not always) triggers a free, which in turn sometimes triggers drops, and the cycle continues.
[18:12:38] <nmatsakis> though I agree it doesn't have to be done that way
[18:12:38] *** Joins: sw17ch (sw17ch@moz-675AFBCF.hsd1.mi.comcast.net)
[18:14:06] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:14:22] <Blei> i see the distinction, but i don't really see the upside of doing it this way. much more symbols to link :3
[18:14:46] <cmr> Freeing could just be hidden in a branch of drop, no?
[18:14:50] <nmatsakis> Blei: I didn't say there was an upside :)
[18:14:56] <Blei> cmr: yeah
[18:14:58] <Blei> XD
[18:15:01] <nmatsakis> Blei: main reason I can see is so that you can inline drop but not free
[18:15:15] <nmatsakis> Blei: but there are other ways to achieve that
[18:15:29] <nmatsakis> Blei: and of course once we get tracing GC, it's largely a non-issue
[18:15:55] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[18:16:22] <Blei> nmatsakis: what do you mean? ~ptrs would still have a free glue, right?
[18:16:38] <nmatsakis> Blei: I mean we will not have drop glue
[18:16:53] <nmatsakis> Blei: that is, there would be no real distinction, since we would never dec ref counts
[18:17:08] <Blei> ah, i see
[18:17:16] <nmatsakis> Blei: or I should say we would not *need* drop glue :)
[18:17:26] <nmatsakis> Blei: I'm sure it's still kicking around even on graydon's GC branch :)
[18:17:46] <Blei> drop glue will never be dropped
[18:18:08] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:18:10] <SiegeLord> rusti: "abc".slice(3,3)
[18:18:12] -rusti- ""
[18:18:20] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[18:18:20] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/rhYZtw
[18:18:20] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[18:18:20] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:18:20] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4lYwRw
[18:18:20] <ghrust> 13rust/06auto 14a08d768 15Bj√∂rn Steinbrink: Fix inlining of glue code...
[18:18:20] <ghrust> 13rust/06auto 14f5758f6 15bors: auto merge of #7154 : dotdash/rust/glue, r=graydon...
[18:18:21] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:19:24] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[18:21:24] *** Quits: sam (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.0)
[18:22:40] *** Joins: sam (sam@moz-ADDDDFB1.mc.videotron.ca)
[18:23:33] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[18:24:05] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[18:30:30] *** Quits: carter (carter@moz-12C317EF.nyc.res.rr.com) (Ping timeout)
[18:30:52] <kimundi> cmr: To be honest I still don't know what you're asking with your example :) That is, I don't see where exactly it applies to my proposal. Is it about supporting lifetime parameters on allocations?
[18:32:14] <cmr> kimundi: do foo.borrow ... etc, there's no way to "keep" that reference.
[18:33:06] <cmr> At least I don't think so.. not sure
[18:33:10] <kimundi> Ah. Well my idea was that the do foo.borrow {...} block gets extended as far as possible
[18:33:52] <cmr> Sometimes "as far possible" extends outside the current block, and I'm not sure there's an easy way to handle that (could be wrong)
[18:34:49] <kimundi> that is, logical you might end up with fn blub(@Gc foo, @Gc bar, @Gc baz) { do foo.borrow {do bar.borrow {do baz.borrow {...}}} }
[18:35:16] <kimundi> cmr: Yeah it would kinda break the scoping rules anyway
[18:35:17] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[18:36:38] *** Quits: sam (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.0)
[18:36:48] <kimundi> cmr: Could also have two seperate 'fn borrow()' and `fn unborrow()`  calls, and the compiler ensures they are called at the right places
[18:37:07] <cmr> kimundi: yeah, that'd do it.
[18:37:12] <steven_is_false> In various places in the compiler I see the pattern let mut x = ~[]; x.push("foo"); x.push("bar"); Is it a good I idea to clean those places up?
[18:37:34] <kimundi> using an inlined closure seems like the best way to make that one operation though
[18:37:52] *** Joins: sam (sam@moz-ADDDDFB1.mc.videotron.ca)
[18:38:18] <kimundi> steven_is_false: In general yes. As long as you don't replace it with slover versions :)
[18:38:33] <steven_is_false> kimundi: okay.
[18:38:39] <cmr> Maybe there could be a simple_borrow for those cases and when the smartpointer would benefit frmo it?
[18:38:54] <kimundi> right, also possible
[18:39:25] <kimundi> I mean you could implement arbitrary traits to augment your semantic there
[18:42:05] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[18:42:32] <Blei> heh, some code that compiles shifts might accidentally convert undefined behaviour into behaviour that is defined...
[18:42:43] <Blei> is this a bug? i'm not sure XD
[18:43:10] *** Quits: snearch (snearch@moz-4A49F529.pool.mediaways.net) (Quit: Verlassend)
[18:44:07] <engla> HashMap doesn't have an iterator but it's "simple" to implement.. however if you iterate in bucket order, due to keyed hashing the order is not only arbitrary but truly random. Is that why no iterator is implemented yet?
[18:44:48] <cmr> engla: it already has each, each_key, and each_value
[18:45:14] <cmr> It could definitely implement Iterator
[18:45:43] <engla> right
[18:47:12] <steven_is_false> One can use | in match patterns to have both match right?
[18:47:17] <cmr> steven_is_false: yup
[18:47:21] <steven_is_false> Cool
[18:48:28] <steven_is_false> How is the newish syntax for conditionals in matches?
[18:48:50] <cmr> match { foo if ... => }
[18:48:59] <steven_is_false> cmr: Thanks!
[18:49:03] *** Joins: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de)
[18:49:25] <kimundi> steven_is_false: Note that the | itself is not part of an pattern
[18:49:38] <steven_is_false> kimundi: Okay
[18:50:16] <kimundi> You can have match x { (_, 1) | (_, 2) => ... } but not match x { (_, 1 | 2) => ... }
[18:50:39] *** Quits: koomi (koomi@moz-33208B35.pools.arcor-ip.net) (Quit: WeeChat 0.4.1)
[18:52:12] <doener> cmr: this might be interesting for twir: https://github.com/mozilla/rust/pull/7154
[18:52:24] <cmr> doener: Definitely, thanks :)
[18:58:35] *** Quits: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de) (Ping timeout)
[19:00:23] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[19:05:42] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[19:09:51] *** Quits: sw17ch (sw17ch@moz-675AFBCF.hsd1.mi.comcast.net) (Quit: sw17ch)
[19:11:17] *** Joins: koomi (koomi@moz-B2B8B6D1.superkabel.de)
[19:22:03] <Blei> aatch|TYPES: more functions to remove: do_spill_noroot, spill_if_immediate
[19:22:26] *** Quits: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp) (Client exited)
[19:29:12] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[19:30:11] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[19:34:51] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[19:35:41] *** Joins: int3_ (int3_@moz-DDCA0B0D.dsl.pltn13.pacbell.net)
[19:36:21] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[19:37:20] *** cscottnet is now known as cscottnet_away
[19:40:23] *** Quits: zxcdw (r-a@moz-C7C5467B.cust.bredband2.com) (Ping timeout)
[19:43:45] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[19:46:19] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:50:25] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Ping timeout)
[19:56:05] *** Quits: cdidd (cdidd@moz-B516639D.broadband.corbina.ru) (Ping timeout)
[19:56:25] *** Joins: fabiand (fabiand@moz-5EABA9D4.adsl.alicedsl.de)
[19:58:08] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Ping timeout)
[19:58:36] *** Joins: cdidd (cdidd@F902C8A9.F0A566B.62D8163C.IP)
[19:59:45] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[20:00:18] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[20:00:18] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/njdOOw
[20:00:18] <ghrust> 13rust/06auto 14a08d768 15Bj√∂rn Steinbrink: Fix inlining of glue code...
[20:00:18] <ghrust> 13rust/06auto 14998e41a 15bors: auto merge of #7154 : dotdash/rust/glue, r=graydon...
[20:00:18] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[20:00:26] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[20:01:38] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[20:02:03] *** Quits: int3_ (int3_@moz-DDCA0B0D.dsl.pltn13.pacbell.net) (Client exited)
[20:02:09] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: computer sleeping)
[20:04:14] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[20:12:58] *** Joins: zxcdw (r-a@moz-C7C5467B.cust.bredband2.com)
[20:13:30] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[20:13:42] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[20:16:09] *** Joins: victorporof_ (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[20:17:10] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Ping timeout)
[20:21:02] *** Joins: jfbk (user@moz-EEA9CFB3.nyc.res.rr.com)
[20:28:45] *** Quits: jaen (jaen@moz-56060390.play-internet.pl) (Quit: WeeChat 0.4.1)
[20:31:04] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[20:34:15] *** Quits: terje (terje@moz-C0F75C5F.san.res.rr.com) (Ping timeout)
[20:34:25] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:34:25] *** ChanServ sets mode: +o brson
[20:38:09] *** Joins: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de)
[20:43:00] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (Ping timeout)
[20:43:13] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[20:44:07] <cmr> Last call for TWiR content
[20:46:19] *** Joins: snearch (snearch@moz-4A49F529.pool.mediaways.net)
[20:49:24] *** Quits: fabiand (fabiand@moz-5EABA9D4.adsl.alicedsl.de) (Quit: Verlassend)
[20:51:15] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[20:51:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/njdOOw
[20:51:16] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[20:52:13] <Eridius> TWiR?
[20:52:18] <doener> this week in rust
[20:52:43] *** Quits: Palmik (palmik@moz-5CA3F354.pks.muni.cz) (Quit: Lost terminal)
[20:54:07] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Ping timeout)
[20:54:15] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[20:54:25] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:54:25] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HoXLTQ
[20:54:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:54:26] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[20:54:26] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/TvNmzQ
[20:54:26] <ghrust> 13rust/06auto 149dcf45d 15Alex Crichton: Rename all files with the 'rc' extension
[20:54:26] <ghrust> 13rust/06auto 1420b40df 15Alex Crichton: Deny common lints by default for lib{std,extra}
[20:54:26] <ghrust> 13rust/06auto 148bdc424 15Alex Crichton: Allow common warnings in stage0 because there may be bugs
[20:54:28] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[20:58:43] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[21:01:43] *** Joins: robertknight2 (robertknig@moz-1945478.range86-144.btcentralplus.com)
[21:02:17] *** Joins: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[21:02:17] *** Quits: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[21:03:09] *** Quits: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[21:03:10] *** Joins: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[21:05:45] *** Joins: carter (carter@moz-12C317EF.nyc.res.rr.com)
[21:06:19] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[21:07:53] <brson> master is still broken
[21:09:16] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[21:09:16] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140fecc32 to 14998e41a: 02http://git.io/N3iJvQ
[21:09:16] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[21:11:57] *** Joins: adu (ajr@moz-68CC2A5E.washdc.fios.verizon.net)
[21:14:11] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[21:16:25] *** aatch|TYPES is now known as aatch
[21:16:56] <aatch> Argh.
[21:17:20] <doener> ?
[21:17:27] *** Joins: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP)
[21:18:13] <aatch> brson, can you look at https://github.com/mozilla/rust/pull/7124
[21:19:03] <aatch> I know it needs a rebase, but it bit rots so fast, so at least getting a "yup, looks fine, just rebase"
[21:19:05] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[21:19:28] <aatch> Sicne apparently everybody has decided to work on trans atm.
[21:19:32] <cmr> :p
[21:22:07] <steven_is_false> aatch: Thanks for cleaning up CrateContext a bit!
[21:22:26] <aatch> steven_is_false, no problem, I'd just like it to get merged!
[21:23:03] * doener switched to something that doesn't involve CrateContext
[21:23:47] *** Quits: adu (ajr@moz-68CC2A5E.washdc.fios.verizon.net) (Quit: adu)
[21:26:07] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[21:26:35] *** Quits: victorporof_ (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof_)
[21:27:42] <Eridius> cmr: just submitted the PR for format strings, since my other work got merged in: https://github.com/mozilla/rust/pull/7161
[21:28:04] <cmr> Eridius: awesome, I saw that the other one landed. great work, thank you :)
[21:28:18] <Eridius> sadly the other one had a bug :O but huonw caught it and I have a PR to fix it
[21:28:20] <Eridius> (I broke %i)
[21:28:37] <Eridius> silly me, using Number(ref mut x) on a copied value
[21:29:20] <Eridius> I wish I didn't have to implement my own subset of printf from scratch :/ but w/e
[21:30:38] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[21:34:55] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[21:35:36] <brson> aatch: lgtm
[21:35:59] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[21:36:06] <aatch> brson, lgtm?
[21:36:14] <aatch> Oh, "looks good to me"
[21:37:18] <aatch> uh, brson, it needs a rebase. which I'm just doing now.
[21:38:04] <brson> i didn't realize bors was even on
[21:38:10] <brson> is the topic lying?
[21:38:25] <aatch> brson, it is. bstrie said he'd change it.
[21:39:46] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[21:42:17] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:42:17] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1482d1d49 to 14998e41a: 02http://git.io/N3iJvQ
[21:42:17] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:42:18] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:42:18] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/wdEH2A
[21:42:18] <ghrust> 13rust/06auto 143960cc7 15Daniel Micay: stop using an absolute rpath...
[21:42:18] <ghrust> 13rust/06auto 148f0fee3 15bors: auto merge of #7132 : thestinger/rust/rpath, r=brson...
[21:42:19] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:42:46] *** Quits: robertknight2 (robertknig@moz-1945478.range86-144.btcentralplus.com) (Ping timeout)
[21:43:05] *** Joins: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP)
[21:43:09] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[21:43:42] *** brson changes topic to 'http://www.rust-lang.org¬†| logs at https://botbot.me/mozilla/rust/ and http://irclog.gr/#browse/irc.mozilla.org/rust'
[21:44:11] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[21:45:00] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[21:45:22] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[21:46:16] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[21:48:05] *** Joins: DuncanMacWeb (duncanmacw@moz-C7860FA6.as13285.net)
[21:48:33] *** Quits: DuncanMacWeb (duncanmacw@moz-C7860FA6.as13285.net) (Client exited)
[21:54:20] *** Quits: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de) (Ping timeout)
[21:57:10] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[21:59:07] *** Joins: adu (ajr@moz-68CC2A5E.washdc.fios.verizon.net)
[21:59:52] *** Quits: adu (ajr@moz-68CC2A5E.washdc.fios.verizon.net) (Quit: adu)
[22:01:51] <strcat> brson: https://github.com/mozilla/rust/pull/7162 r?
[22:05:19] <cmr> http://cmr.github.io/blog/2013/06/15/this-week-in-rust/
[22:06:26] <brson> cmr: awesome!
[22:06:58] <cmr> 3 minutes, 10 seconds late. I should automate the deploy next time ;)
[22:07:59] <orshem> cmr: nice! bookmarked
[22:09:31] <orshem> did pcwalton expand on his cliff hanger?
[22:09:45] <cmr> Nope
[22:09:57] <cmr> Not publically yet, at least.
[22:10:29] <orshem> i must say i'm finding the interaction of unique and borrowed pointers the hardest to grok
[22:10:35] <orshem> not the concepts
[22:11:06] <orshem> but when i sit and write code i keep running into situation that should work but doesn't
[22:11:14] <aatch> orshem, really?
[22:11:44] <aatch> Can you post an example that you think should work, but doesn't?
[22:11:49] <orshem> also i keep having multiple levels of redirection in the code like &~ and even &&~
[22:12:03] <orshem> i hope llvm optimise them away
[22:12:13] <aatch> orshem, you shouldn't need that.
[22:12:42] <brson> cmr: the effect proposal link is broke
[22:13:00] <orshem> aatch: i'll post a small example. but this is the other way around. it now works, but i'm not sure it should... 
[22:13:20] <orshem> i've wrote over the older examples
[22:13:25] <cmr> brson: dammit, thanks
[22:13:36] <nmatsakis> brson: on 32 bit, I seem to encounter frequent deadlocks...admittedly, this may be due to the changes i've made locally. have you observed this at all?
[22:13:40] <strcat> you should need &~
[22:13:50] <strcat> you can just pass &T instead of &~T
[22:14:00] <orshem> aatch: https://gist.github.com/anonymous/5789767
[22:14:04] <strcat> only time it ends up happening is generic code where T is ~U
[22:14:07] <aatch> orshem, I'll admit that borrowing semantics can get a little hairy.
[22:14:12] <orshem> look at the contain method
[22:14:19] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: nn)
[22:14:28] <brson> nmatsakis: no, I haven't
[22:14:36] <brson> nmatsakis: do you have a test case that deadlocks?
[22:14:39] <strcat> orshem: so match out of ~T
[22:14:47] <strcat> match out &T
[22:14:55] <nmatsakis> brson: "make check" :)
[22:15:16] <nmatsakis> brson: as I said, maybe something I did locally...
[22:15:16] <orshem> strcat: how? i'm very new to rust.. also ref in match is a borrowed pointer, right?
[22:15:20] <cmr> There were deadlocks on mac
[22:15:23] <cmr> On one of the builds
[22:15:33] <strcat> orshem: ref and ref mut get you a borrowed pointer
[22:15:36] <cmr> possibly many, but I only saw one
[22:16:09] <nmatsakis> brson: in particular I seem to be having some difficulty with the bench runs. I had to convert some kind of weird code in the various pipes examples, maybe my change was not valid.
[22:16:32] <nmatsakis> brson: in particular there was stuff like "to_child.send(msg); move_it!(msg);"
[22:16:40] <strcat> rusti: let x = Some(~5); fmt!("%?", match x { Some(~ ref x) => x, None => fail!() })
[22:16:41] -rusti- ~"&5"
[22:16:43] <strcat> orshem: ^
[22:16:56] <nmatsakis> brson: after my changes, the move_it macros (which relied on moving from unsafe ptrs) no longer compile
[22:17:09] <nmatsakis> brson: er, actually it was "to_child.send(msg); move_it!(to_child);"
[22:17:23] <aatch> orshem, you also don't need the type annotation on `let mut node`
[22:17:25] <nmatsakis> anyway, I don't get what the move is even doing here...
[22:17:38] <orshem> strcat: wow didn't know i could do that
[22:17:42] <orshem> thanks
[22:17:50] <strcat> orshem: you can match any structural pattern
[22:17:59] <strcat> the ref and ref mut go on the variables you're extracting
[22:18:06] <strcat> to get them out by-ref
[22:18:14] <orshem> aatch: yep, that's from when i had errors before and wasn't sure about the types
[22:18:27] <brson> nmatsakis: that is sosme old legacy code that's suffered through a lot of library changes. maybe it isn't worth holding on to
[22:18:27] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[22:18:27] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148f0fee3 to 14998e41a: 02http://git.io/N3iJvQ
[22:18:27] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[22:18:29] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[22:18:29] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/cCaFyw
[22:18:29] <ghrust> 13rust/06auto 1498b1c9e 15James Miller: Move trans mod items into trans/mod.rs
[22:18:29] <ghrust> 13rust/06auto 14b1f39ce 15James Miller: Move CrateContext into it's own file
[22:18:31] <ghrust> 13rust/06auto 1401e098a 15James Miller: Make CrateContext::new() fn....
[22:18:32] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[22:18:40] <cmr> aatch: I really hope that lands
[22:18:43] <aatch> orshem, feel free to ask about this stuff any time though.
[22:18:50] <aatch> cmr, you and me both!
[22:19:34] <nmatsakis> brson: yes. I was wondering about that... 
[22:19:34] <aatch> cmr, also, my new goal is to try and get into every twir :D
[22:19:43] <orshem> aatch: thanks. i really enjoy learning rust. the community is very welcoming
[22:20:11] <aatch> orshem, thank you.
[22:20:22] <cmr> aatch: I'm sure you'll have mno problem doing that :)
[22:21:23] <doener> aatch: sounds like a worthy goal
[22:21:38] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Quit: Leaving.)
[22:23:34] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[22:23:43] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[22:27:01] <doener> hm, why does take_while end up with doubly ref'd values?
[22:27:40] <aatch> doener, what do you mean?
[22:27:48] <Eridius> doener: take_while takes &A, and A is probably already a ref
[22:28:06] <Eridius> e.g. (&[T]).iter() emits &T's
[22:28:26] <strcat> can add consume_iter for vec later
[22:28:32] <Eridius> and I would guess the reason is because take_while cannot move the element, because it doesn't replace it
[22:28:47] <doener> aatch: for [1,2,3].iter().take_while(|&x| *x != 2).advance |x| { println(x.to_str()); }
[22:29:01] <doener> aatch: x is a &(&int) there
[22:29:01] <Eridius> strcat: consume_iter would be nice, but I would still like a copy_iter so I don't have to keep saying .iter().transform(|&x| x) all the time
[22:29:10] <strcat> doener: it has to pass it by-ref unless it makes you return (bool, A) or something
[22:29:33] <strcat> Eridius: Copy is deprecated
[22:29:44] <strcat> it will become .map(Clone::clone)
[22:30:19] <strcat> we're going to have iter(), rev_iter(), mut_iter(), rev_mut_iter(), consume_iter(), consume_mut_iter() just for the basics
[22:30:27] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[22:31:10] <brson> were mutable fields removed in 0.7?
[22:31:23] <strcat> + some things can iterate over ranges
[22:31:36] <aatch> brson, they went a while ago
[22:31:45] <strcat> find_iter(), equal_range(), lower_bound(), upper_bound()
[22:31:47] <strcat> are all things we could have
[22:31:54] <strcat> I really don't want to have _clone versions of them all.
[22:32:10] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[22:32:28] *** Quits: _1126 (1126@moz-83D60E55.lileth.net) (Ping timeout)
[22:33:57] * strcat really, really wants that method resolve bug to get fixed :(
[22:34:23] <aatch> strcat, I don't mind having to be explicit about my copying. The only thing is the artificially expanded freeze from #6248 which most of the time can be solved with a copying version.
[22:34:38] *** Joins: _1126 (1126@moz-83D60E55.lileth.net)
[22:34:45] <Luqman> yay colours now. much thanks to Eridius 
[22:34:49] <strcat> aatch: the iterator would still borrow from it
[22:35:36] <aatch> strcat, I know. I'm just saying that that bug is pretty much the only reason you'd really want a copying version.
[22:36:39] <brson> what great new features does rust 0.7 have?
[22:37:03] <strcat> brson: iterators and arbitrary lifetimes on self, but those are already in RELEASES.txt ;p
[22:37:06] <aatch> compared to 0.6? A decent borrow checker?
[22:37:08] <cmr> Less features!
[22:38:32] <strcat> brson: massively cleaned up vec/str modules
[22:38:53] <strcat> (we should really start documenting these things as we do them)
[22:38:55] <aatch> Atomic types?
[22:39:05] <strcat> are atomics useful yet though?
[22:39:10] <strcat> without globals
[22:39:12] <aatch> strcat, define "useful"
[22:39:21] <strcat> have a use case ;p
[22:39:25] <strcat> in user code
[22:39:38] <Jeaye> used
[22:39:45] <aatch> Well bblum is using them for rwlocks
[22:40:01] <aatch> Depends on whether you count that as user code though.
[22:40:18] <Jeaye> brson: rustc outputs in color now. :D
[22:40:19] <brson> yes atomics are very useful
[22:40:23] <brson> you don't need globals for them
[22:40:35] <brson> i put them in UnsafeAtomicRcBoxes
[22:40:44] <brson> or in other shared pointers
[22:40:44] <strcat> brson: linear::Linear{Map,Set] renamed to Hash{Map,Set}
[22:41:08] <brson> aatch: i've been devouring your atomics. big thumbs up
[22:41:20] * aatch should get around to implementing the rest of the barriers
[22:41:29] <strcat> brson: I think we got deriving for a bunch of things too. would have to check the log
[22:41:34] <strcat> Clone, TotalOrd, TotalEq
[22:41:46] <strcat> might have been before 0.6 was tagged though
[22:42:57] <aatch> Also, should probably fail if you try to use an ordering type that isn't supported on the operation.
[22:43:25] <engla> the num traits are new in 0.7, Trigonometric etc
[22:43:35] <strcat> nmatsakis: do you think the ffi changes will land for 0.7?
[22:43:36] <cmr> Oh, Interpolation
[22:43:40] <cmr> Reworked numerics
[22:43:45] <cmr> Hopefully a GC :)
[22:43:47] <strcat> the fast_ffi by default stuff
[22:43:51] <strcat> cmr: that won't happen ;p
[22:43:59] <strcat> we need a trait for overloading ptrs
[22:44:09] <cmr> When is 0.7 slated for release?
[22:44:15] <strcat> 15 days or something?
[22:44:18] <strcat> there's no way we can just regress mem usage more though
[22:44:19] <aatch> cmr, end of the month.
[22:44:39] <Jeaye> bjz: ping
[22:44:52] <aatch> According to Github, 0.7 is due in 14 days.
[22:45:08] <strcat> the easiest way to land the gc is adding the things we need for extra::rc to be a drop-in replacement for @ whenever it suits the use case better
[22:45:10] <bjz> Jeaye: hoya. sorry for missing you the other day.
[22:45:18] <aatch> but I'm in +1200, so other people might see 15.
[22:45:27] <brson> #[deriving(Clone)] was 0.6
[22:45:32] <Jeaye> bjz: No worries. You mentioned you were onto the cause of that crash?
[22:45:39] <Jeaye> bjz: Also, have you seen build/glfw_static/libglfw.a(x11_clipboard.c.o): undefined reference to symbol 'XSendEvent
[22:45:41] <strcat> brson: DeepClone + deriving(DeepClone) weren't though, so there's that
[22:46:31] <strcat> brson: @mut isn't unsound anymore ;p
[22:46:32] <brson> bjz: what are the changes to numeric traits for 0.7?
[22:46:35] <Jeaye> bjz: That's not while compiling glfw or glfw-rs, but when linking q3. 
[22:46:52] <bjz> Jeaye: nao :/
[22:47:06] <brson> strcat: was there a semantic change to @mut or did we just fix the bugs to make the documented (lol) semantics work?
[22:47:47] <strcat> brson: bug fixes, but they change the semantics because it fails more + static checks to catch some of the failures
[22:47:48] <brson> 0.7 will probably slip. Can't release while master is broken
[22:48:10] <strcat> brson: it wasn't failing in a lot of cases where it should have been
[22:48:12] <strcat> they are very common now
[22:48:31] <bjz> Jeaye: is it the same on your mac?
[22:48:31] <strcat> probably a lot of incorrect code that was using @mut will break
[22:48:57] <aatch> like a lot of rustc did when I switched to @mut
[22:48:58] <bjz> Jeaye: do the examples build ok?
[22:49:50] <Jeaye> bjz: Can't test, since the Mac is my work laptop and it's at work. The glfw-rs examples are not building right now.
[22:50:08] <bjz> Jeaye: eh. same error?
[22:50:10] <Jeaye> I'm still looking into it to make sure it's not something I did wrong (probably is), but I figured I'd check with you.
[22:50:14] <brson> the fast_ffi change still hasn't landed
[22:50:50] <Luqman> strcat: would the llvm's loop to memset/memcpy optimizations kick in without -O ?
[22:50:58] <strcat> Luqman: no
[22:51:01] <strcat> aatch: https://github.com/mozilla/rust/issues/7140
[22:51:06] <bjz> Jeaye: have you tried clearing the CMake cache and re-configuring with shared libs again?
[22:51:18] <strcat> aatch: talked to pcwalton about it, he agreed it would be good
[22:51:20] <cmr> Luqman: I'm pretty sure it's the explicit copy killing it
[22:51:22] <strcat> curious what other people think
[22:51:24] <Jeaye> Sounds like a fine idea.
[22:51:59] <Luqman> cmr: i added a bench for the vec repeat syntax to the issue
[22:52:03] <aatch> strcat, seems ok to me.
[22:52:07] <strcat> bblum: https://github.com/mozilla/rust/issues/7140 <- you might also be interested in that
[22:52:16] <aatch> I generally don't like using @mut unless I really need to.
[22:52:29] <strcat> if we put the dynamic failure in a lib, we could add back static borrows one day
[22:52:36] <bjz> Jeaye: re. callbacks, I'm still having difficulties. Would you be able to have a bit more of an in-depth look at what I've been doing?
[22:53:31] <Jeaye> Storing the closures in task local storage?
[22:53:35] <bjz> Jeaye: Aye
[22:54:00] <bjz> Jeaye: it's almost as if it's trying to remove the data twice
[22:54:03] <Jeaye> Yeah, I've peeked around. I'll probably have time this weekend to check a bit deeper.
[22:54:24] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:54:38] <bjz> Jeaye: what I've done seems to be rather brittle, I'd appreaciate help from somebody a tad more experienced
[22:54:58] *** Joins: tjc (tjc@moz-4ED25D08.tukw.qwest.net)
[22:54:58] *** ChanServ sets mode: +o tjc
[22:55:01] <Jeaye> Eridius: ping
[22:55:07] <aatch> I would actually really like to have library smart pointers. Especially now it's been talked about so much.
[22:55:38] <strcat> aatch: I opened a few issues about the things we're missing
[22:55:43] <Jeaye> bjz: Well, that's hardly me; I'm the noobiest of Rust noobs. I'll see what I can do though.
[22:56:16] <bjz> Jeaye: as are we all :) I mean from a systems programming point of view
[22:56:19] <strcat> aatch: https://github.com/mozilla/rust/issues/7138 https://github.com/mozilla/rust/issues/7139 https://github.com/mozilla/rust/issues/7141
[22:56:22] <strcat> doesn't seem that far off.
[22:56:27] <bjz> brson: we should difinitely try to get some of those changes together
[22:56:41] *** Quits: spider-mario (spidermari@moz-AC2C1EAE.rev.sfr.net) (Input/output error)
[22:57:14] <strcat> aatch: I think what will end up happening is that we replace ~ with a library reimplementation and then add a lang item to make it use the ~ syntax - the compiler impl of ~ is too messed up
[22:57:32] <bjz> jensnockert: you thoght much about numeric conversions? ie. we have NumCast, but that's onlyfor primitives
[22:57:56] <bjz> jensnockert: we need something better for 0.7
[22:57:57] <jensnockert> bjz: I still think some sort of As<S, T> trait would be the nicest.
[22:58:06] <aatch> strcat, yeah. I'm scared at how much is integrated into the compiler.
[22:58:20] <jensnockert> bjz: Are there any other good options?
[22:58:21] <strcat> aatch: well I'm going to need to make Unique to make the TreeMap 3x faster
[22:58:33] <Eridius> Jeaye: pong
[22:58:43] <strcat> so ~ is going to die, because I'm not able to fix it - would need to rewrite the entire closure implementation (especially ~fn)
[22:58:45] <bjz> jensnockert:  no idea
[22:59:03] <strcat> there are really too many places relying on the headers
[22:59:06] <aatch> strcat, did you know that there are functions for constructing pipe and chan TypeRefs? I'm pretty sure they're dead though, to be fair.
[22:59:15] <strcat> aatch: heh
[22:59:37] <jensnockert> bjz: Do we have a meta-bug for it?
[22:59:39] <bjz> jensnockert: I mean, there should be something included in the numeric traits to allow for conversions
[22:59:46] <strcat> aatch: anyway omitting the drop flag is req. to make it 1 word instead of 2
[22:59:51] <Jeaye> Eridius: Color shows up in my terminal now. :) 'warning', 'note', and 'error' are colorized; it would be awesome to also color the underlining of the affected code where it says ^~~~~~ (like how clang does it)
[22:59:56] <strcat> + a way to dispatch to the local allocator
[23:00:05] <strcat> and then we can just make Unique
[23:00:09] <jensnockert> bjz: Yes, we really need something.
[23:00:12] <bjz> jensnockert: like T:Real should allow you to make a new T from 0.5
[23:00:12] <Eridius> Jeaye: excellent :) but my work has no bearing on where the color shows up, just whether it shows up at all :/
[23:00:19] <Jeaye> Ahh
[23:00:23] <Eridius> Jeaye: good suggestion though, file an issue?
[23:00:30] <Jeaye> Will do.
[23:00:31] <strcat> aatch: something like add Unique -> replace ~ -> add back ~ as sugar
[23:00:38] <jensnockert> bjz: That too.
[23:00:48] <aatch> strcat, sounds good.
[23:00:50] <strcat> aatch: will be 1000x easier. ;p
[23:01:24] <strcat> and.... we won't have such an embarrassing unique ptr implementation
[23:01:43] <bjz> jensnockert: atm I've been doing One::one::<T>() / (One::one::<T>() + One::one::<T>())
[23:01:48] <bjz> jensnockert: x)
[23:01:51] <aatch> Though I have a feeling that it'll need to be done all at once to be feasible. Just way too many instances of ~ to do it one at a time.
[23:02:07] <jensnockert> bjz: I know exactly how that feels.
[23:02:15] <strcat> aatch: true
[23:02:25] <nmatsakis> strcat: not sure, I've not really had any time to work on rust lately
[23:02:59] <nmatsakis> strcat: obviously I would really like them to! :/
[23:05:16] * brson can't reproduce the std::run failures on the bots
[23:05:35] <aatch> brson, the inherited environment?
[23:05:38] <jensnockert> bjz: I could take a look at adding that for Real / Integer.
[23:05:45] * brson really sick of fixing master
[23:05:54] <jensnockert> bjz: That is an important first step.
[23:05:56] <brson> aatch: i don't understand the question
[23:06:20] <jensnockert> bjz: Especially since default implementations may finally be available for 0.7
[23:06:23] <aatch> brson, the std::run test that is failing is the one testing the inherited environment, right?
[23:06:53] <brson> aatch: not sure. it's these     run::tests::test_finish_with_output_once
[23:06:53] <brson>     run::tests::test_finish_with_output_twice
[23:06:53] <brson>     run::tests::test_process_output_output
[23:06:56] * strcat will try removing vec::each and BaseIter today ;p
[23:07:13] <aatch> brson, oh, ok then. Not what I though.
[23:08:12] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[23:08:18] <bjz> jensnockert: if you could figure something out that'd be amazing. I don't think we have a bug for that (but I could be wrong)
[23:08:45] <jensnockert> bjz: I'll think about this a bit and post something tomorrow?
[23:08:50] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[23:09:00] <kyle2000> friends, why does the std::io::Reader trait's read_byte() method return an int instead of a u8?
[23:09:01] <bjz> jensnockert: sounds great!
[23:09:20] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:09:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/cCaFyw
[23:09:20] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:09:52] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[23:10:17] <strcat> kyle2000: the io stuff is being completely replaced
[23:10:19] <strcat> it's really bad
[23:11:01] <kyle2000> strcat: i am pleased to hear that. i've been working with it a little bit as a casual rust user and it is very frustrating. the improvements are getting me very aroused!
[23:11:15] <kyle2000> i don't even know the details but i am sure it will be an improvement worthy of my biggest joy.
[23:12:19] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:12:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pMuoxA
[23:12:19] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:13:47] * strcat wants a sane way of hardcoding N arg calls to vararg FII functions
[23:13:49] <strcat> FFI*
[23:14:24] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Connection reset by peer)
[23:14:40] <engla> strcat: you should add iterators for hashmap, https://gist.github.com/anonymous/b042e0875f4cc1077a65
[23:15:18] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:15:18] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pMuoxA
[23:15:18] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:15:19] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[23:15:19] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/vUX1eg
[23:15:19] <ghrust> 13rust/06auto 14708395d 15Daniel Micay: stop using an absolute rpath...
[23:15:19] <ghrust> 13rust/06auto 14c989b79 15bors: auto merge of #7132 : thestinger/rust/rpath, r=brson...
[23:15:20] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[23:17:52] <aatch> strcat, I may have found a bug in the iterators.
[23:17:56] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (No route to host)
[23:17:59] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[23:18:07] <aatch> rusti: use std::iterator::IteratorUtil; let name = ~"atomic_xadd_acq"; let a : ~[&str] = name.split_iter('_').collect(); a
[23:18:08] -rusti- ~["\x00tomic", "xadd", "acq"]
[23:18:41] <aatch> rusti: use std::iterator::IteratorUtil; let name = ~"atomic_xadd_acq"; let a : ~[&str] = name.split_iter('_').collect(); fmt!("%?", a)
[23:18:42] -rusti- ~"~[\"atomic\", \"xadd\", \"acq\"]"
[23:18:54] <aatch> Ok, maybe not.
[23:19:00] <aatch> Weird bug though.
[23:19:04] <kyle2000> strcat: is there a tentative timeline for when the io changes might be ready? between this news and MaikKlein's Qt Creator work i am throbbing with excitement about rust!
[23:19:18] <cmr> kyle2000: what has MaikKlein been working on?
[23:20:02] <brson> we should have better standards for commit messages someday
[23:20:43] <doener> +1
[23:20:55] <kyle2000> cmr: last weekend he was talking about making a plugin or something for Qt Creator to help make a fine rust IDE. he was saying earlier today that he is working on autocompletion support in rust itself be he is busy with his academic examinations currently.
[23:21:05] <cmr> ah
[23:25:39] <aatch> Wahoo, my PR merged!
[23:25:54] *** Joins: jaen (jaen@moz-4F5EDCFB.play-internet.pl)
[23:27:01] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[23:28:17] <doener> aatch: sweet
[23:34:44] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[23:35:28] <strcat> aatch: huh
[23:36:05] <strcat>  rusti: use std::iterator::IteratorUtil; let name = ~"atomic_xadd_acq"; let a : ~[&str] = name.split_iter('_').collect(); fmt!("%?", a)
[23:36:13] <strcat> rusti: use std::iterator::IteratorUtil; let name = ~"atomic_xadd_acq"; let a : ~[&str] = name.split_iter('_').collect(); fmt!("%?", a)
[23:36:16] -rusti- ~"~[\"atomic\", \"xadd\", \"acq\"]"
[23:36:44] <strcat> rusti: use std::iterator::IteratorUtil; let name = ~"atomic_xadd_acq"; let a : ~[&str] = name.split_iter('_').collect(); fmt!("%?", { a })
[23:36:45] -rusti- ~"~[\"atomic\", \"xadd\", \"acq\"]"
[23:36:51] <brson> I'm having a hard time reading tuple.rs. How do you use the macroized accessors on a tuple?
[23:37:08] <strcat> rusti: let xs = (1, 2); xs.n1()
[23:37:10] -rusti- 2
[23:37:18] <strcat> hrm... it copies? :\
[23:37:20] <brson> oh nvm i can read the tests
[23:37:42] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[23:38:50] <Eridius> strcat: if rusti is new enough, IteratorUtil should be in the prelude now
[23:39:04] <strcat> it's not
[23:39:08] <Eridius> bah
[23:39:08] *** Joins: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de)
[23:40:13] <Eridius> huh, hadn't seen tuple.rs before. Kind of surprised there's no swap_consume
[23:40:21] <Eridius> or first_consume, etc.
[23:43:01] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[23:46:33] <strcat> Eridius: that's probably what the n0 functions should do
[23:46:44] <strcat> self by-value
[23:47:17] <brson> 0.7 is dominated by library changes, not syntax or semantic changes. a good sign
[23:47:40] <MaikKlein> bjz, I am reading here http://cmr.github.io/blog/2013/06/15/this-week-in-rust/ that lmath is fixed and usable? I tried it with the newest master and it didn't fully compile so I made some changes and got it to compile. But I can't really use it properly I am unable to find the types like lmath::vec::vec3;
[23:49:42] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[23:49:43] <Jeaye> brson: Ayew
[23:49:45] <Jeaye> Aye
[23:49:47] *** Joins: eholk (eholk@moz-E45742D4.public.wayport.net)
[23:50:55] <bjz> MaikKlein: you can't do vec3::new(...) any for now
[23:51:23] <bjz> MaikKlein: you need to do let v: vec3 = Vec3::new(...);
[23:52:08] <doener> MaikKlein: btw, where in Germany are you located?
[23:52:11] <bjz> MaikKlein: look at rray, it'll give you an idea how to do it
[23:52:27] <bjz> MaikKlein: could you PR those fixes?
[23:53:26] *** Quits: snearch (snearch@moz-4A49F529.pool.mediaways.net) (Quit: Verlassend)
[23:53:28] <MaikKlein> bjz, ofc I just haven't done a PR yet but I figure it out, just wanted to make sure that everything is working fine
[23:53:39] <MaikKlein> doener, do you know koblenz?
[23:53:43] <bjz> MaikKlein: sure thing
[23:54:04] <MaikKlein> doener, or cologne?
[23:54:15] <MaikKlein> or kˆln w/e
[23:54:20] <doener> MaikKlein: sure. I'm living in Bielefeld ;-) 
[23:54:29] <bjz> MaikKlein: I'm deep in restructuring lmath (without breaking the api), so I haven't had a chance to update it.
[23:54:44] <doener> 300km is a bit much for a random beer though ;-)
[23:54:48] <MaikKlein> doener, haha nice 
[23:55:12] <kyle2000> all of these library updates are getting me really excited and aroused! thanks for all your hard work guys. i am truly throbbing with excitement for these changes.
[23:55:57] <brson> what does bytes! do?
[23:56:16] <strcat> brson: bytestring "literals"
[23:56:20] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[23:56:32] <strcat> rusti: static a: &'static [u8] = bytes!("foo");
[23:56:33] -rusti- ()
[23:56:35] <strcat> rusti: static a: &'static [u8] = bytes!("foo"); a
[23:56:37] -rusti- &[102, 111, 111]
[23:57:02] <strcat> we could have b"foo" like python but for now we have that ;p
[23:59:56] <kimundi> strcat, Eridius: How about a .deref() iterator adapter in place of .transform(|&x| x) ?
