[00:00:02] <strcat> nothing really
[00:00:13] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:00:21] <strcat> it's a persistent list
[00:00:27] <strcat> but it's task-local
[00:00:39] <brson> rustc uses it quite a bit
[00:00:58] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:00:59] <ghrust> 01[13rust01] 15nikomatsakis pushed 1 new commit to 06try: 02http://git.io/kN3wHg
[00:00:59] <ghrust> 13rust/06try 14bbb8c79 15Niko Matsakis: More missing fixed_stack_segment, for windows/x86_64
[00:00:59] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:01:35] <tikue> brson: what kind of use cases?
[00:02:47] <toddaaro> with options, is it allowed to do opt.unwrap_or_default(return);?
[00:02:55] <toddaaro> it seems to have massively confused lint
[00:03:11] <toddaaro> it is now throwing an incorrect unused variable error
[00:03:55] <tjc> toddaaro: it's allowed, but almost certainly not what you want
[00:04:05] <toddaaro> tjc: what does it do?
[00:04:14] <toddaaro> I want to either return the enclosed value, and if it is None, return
[00:04:17] <tjc> toddaaro: it's equivalent to return;
[00:04:19] <tjc> you could write
[00:04:34] <tjc> well, you can't write it with unwrap_or_default, have to pattern match
[00:04:39] <tjc> there should probably be a version that takes a closure
[00:04:44] <Eridius> graydon: why does Trap.inside() bother using Guard, with a Drop to pop the handler off the TLS handler stack? If the task fails, the entire TLS is going away anyway
[00:04:53] <toddaaro> tjc: oh, so it is eagerly evaluating return
[00:04:56] <toddaaro> that makes sense
[00:05:04] <tjc> toddaaro: yes, just like any other function argument :-)
[00:05:07] <toddaaro> tjc: can I just add a variant that takes a default closure?
[00:05:15] <graydon> Eridius: TLS goes away at the end. it has to unwind in proper order.
[00:05:19] <tjc> toddaaro: Yeah, I think that would be a good addition to the library
[00:05:21] <graydon> Eridius: what if a condition is raised during unwinding?
[00:05:27] <toddaaro> tjc: k, what should it be called?
[00:05:39] <tjc> toddaaro: hmm, I'm bad at names...
[00:05:45] <Eridius> graydon: oh hmm, I didn't realize you could raise conditions while unwinding, but it seems obvious now. Makes sense
[00:05:55] <tjc> anyone have a good name for a version of unwrap_or_default that takes a thunk to evaluate, instead of a value?
[00:06:03] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Client exited)
[00:06:04] <toddaaro> after async_async_send no one asks me for name suggestions anymore
[00:06:10] <tjc> haha
[00:06:13] <graydon> Eridius: a condition is _really_ just a call to a global dynamic-scoped function.
[00:06:21] <graydon> er, raising one is
[00:06:24] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Ping timeout)
[00:06:53] <Eridius> yeah, I just was wondering why Guard was needed instead of popping the handler inline, but raising a condition during unwinding answers that
[00:07:15] <Eridius> tjc: .unwrap_or()
[00:07:29] <toddaaro> unwrap_or sounds nice
[00:07:33] <kimundi> toddaaro: or_else semms to ba a suufix that's used in at elast one othe rlanguage
[00:07:37] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[00:07:41] <tjc> that would be ok, though it doesn't particularly connote that it's taking a closure
[00:07:59] <Eridius> true
[00:08:07] <ecr> I *think* I have all the existing IO thread-safe now. TCP, UDP, & timers.
[00:08:11] <toddaaro> unwrap_or_do
[00:08:19] <toddaaro> do unwrap_or_do is awkward though
[00:08:36] <ecr> Probably need to write more test cases though...
[00:08:53] <kimundi> let x = do opt.or_else { ... }
[00:08:58] <graydon> anyone want to review a tutorial on conditions?
[00:08:58] <kimundi> let x = do opt.unwrap_or_else { ... }
[00:09:00] <graydon> http://static.rust-lang.org/doc/tutorial-conditions.html
[00:09:11] <graydon> email feedback, I gotta head out shortly but comments appreciated
[00:09:17] <aatch> We have a tutorial on conditions!
[00:09:41] <kimundi> aatch said all I could ever say on the matter
[00:09:43] <Eridius> nice TOC
[00:09:51] <toddaaro> I'll name it unwrap_or_else for now, seems solid enough
[00:09:56] <toddaaro> thanks for the input
[00:10:28] <olsonjeffery> what's the quickest way to go from a str -> ~[u8] ?
[00:11:02] <tjc> graydon: it's not checked in yet?
[00:11:14] <graydon> tjc: no, I'll open a PR for it in a bit
[00:11:20] <Eridius> olsonjeffery: .as_bytes().to_owned() probably
[00:11:38] <tjc> graydon: ok, I'll wait for the PR so I can just leave line comments :-)
[00:12:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:12:24] <aatch> olsonjeffery, otherwise, technically the fastest way is transmute, but that's probably not the best idea.
[00:12:26] <kimundi> toddaaro: add a or_else that doesn't unwrap to whiel your add it :)
[00:12:28] <graydon> gtg, back later tonight
[00:12:34] *** Quits: graydon (graydon@moz-F14EE0DB.cable.teksavvy.com) (Quit: Leaving.)
[00:12:48] <toddaaro> oh huh
[00:12:55] <toddaaro> how do I pass in a closure that says return?
[00:13:03] <Eridius> toddaaro: you can't use `return` in a closure
[00:13:09] <toddaaro> hm
[00:13:14] <tjc> Oh
[00:13:18] <tjc> that should have occurred to me
[00:13:26] <tjc> Yeah, I think you have to pattern-match in this case, sorry :-)
[00:13:38] <toddaaro> oh well
[00:13:57] <toddaaro> I was hoping to use a method on option to turn my ~8 line match+boilerplate blocks into a single block
[00:14:03] <tjc> heh
[00:14:06] <toddaaro> but return is special enough that this seems hard
[00:14:11] <toddaaro> I can't even make a helper can I
[00:14:21] <aatch> toddaaro, maybe a macro?
[00:14:29] <toddaaro> aatch: perhaps, that might do the trick
[00:14:42] <toddaaro> but I feel like the codebloat would be worse that way
[00:14:48] <toddaaro> this happens twice in the whole runtime
[00:15:06] <aatch> toddaaro, ah. In that case, live with the minor boilerplate :D
[00:15:25] <toddaaro> return return;
[00:15:29] <toddaaro> that would be awesome syntax
[00:15:57] <aatch> toddaaro, you can have block expressions, btw
[00:16:03] <kimundi> rusti: return return;
[00:16:05] -rusti- pastebinned 9 lines of output: http://ix.io/7kb
[00:16:24] <toddaaro> aatch: block expressions?
[00:16:39] <kimundi> rusti: if true {return return;}
[00:16:44] <strcat> fn foo() -> int { loop { return break } }
[00:16:49] <aatch> so unwrap_or_default({ let a = 1; a})
[00:16:51] <strcat> rusti: fn foo() -> int { loop { return break } }
[00:16:52] -rusti- <anon>:5:27: 5:48 error: mismatched types: expected `int` but found `()` (expected int but found ())
[00:16:52] -rusti- <anon>:5          fn foo() -> int { loop { return break } }
[00:16:52] -rusti-                                     ^~~~~~~~~~~~~~~~~~~~~
[00:16:52] -rusti- error: aborting due to previous error
[00:16:52] -rusti- application terminated with error code 101
[00:16:55] <strcat> rusti: fn foo() -> int { loop { return break } 0 }
[00:16:55] -rusti- ()
[00:16:58] <strcat> ;D
[00:17:02] <strcat> rusti: fn foo() -> int { loop { return break } 0 } foo()
[00:17:03] -rusti- 0
[00:17:10] <bblum> how do i get a ty::ty from a ast::ty
[00:17:14] <bblum> oh wait, it's ast_ty_to_ty
[00:17:15] <strcat> rusti: fn foo() -> int { loop { return break } 0 } for _ in range(0, 3) { foo() }
[00:17:16] -rusti- <anon>:5:53: 6:5 error: mismatched types: expected `()` but found `int` (expected () but found int)
[00:17:16] -rusti- <anon>:5          fn foo() -> int { loop { return break } 0 } for _ in range(0, 3) { foo() }
[00:17:16] -rusti- <anon>:6     };
[00:17:16] -rusti- error: aborting due to previous error
[00:17:17] -rusti- application terminated with error code 101
[00:17:18] <bblum> never mind, i know this
[00:17:19] <strcat> rusti: fn foo() -> int { loop { return break } 0 } for _ in range(0, 3) { foo(); }
[00:17:20] -rusti- ()
[00:17:27] <kimundi> rusti: if true {println("valid"); ;return return;}
[00:17:28] -rusti- valid
[00:17:34] <strcat> rusti: fn foo() -> int { loop { return break } 0 } for _ in range(0, 3) { printfln!("%d", foo()); }
[00:17:34] -rusti- 0
[00:17:35] -rusti- 0
[00:17:35] -rusti- 0
[00:17:35] -rusti- ()
[00:17:37] <kimundi> he, it's valid syntax xD
[00:17:41] <toddaaro> aatch: ahhh that is a sneaky idea
[00:17:59] <strcat> rusti: fn foo() -> ~str { loop { return break } ~"foo" } for _ in range(0, 3) { printfln!("%s", foo()); }
[00:17:59] -rusti- foo
[00:18:00] -rusti- foo
[00:18:00] -rusti- foo
[00:18:00] -rusti- ()
[00:18:03] <kimundi> rusti: if true {println("valid"); return return return return;}
[00:18:04] -rusti- valid
[00:18:06] <kimundi> lol
[00:18:16] <aatch> toddaaro, though it will always evaluate the block
[00:18:22] <toddaaro> aatch: yea
[00:18:37] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Ping timeout)
[00:18:42] <toddaaro> I wonder what return return return return; compiles to
[00:18:47] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:18:49] * aatch was trying to find the catch
[00:19:00] <toddaaro> is it just DCEd away in that case?
[00:19:07] <strcat> rusti: fn foo() -> ~str { loop { return break } ~"foo" } let x = foo(); let y = foo(); println("%?", x)
[00:19:07] -rusti- <anon>:5:89: 6:5 error: this function takes 1 parameter but 2 parameters were supplied
[00:19:07] -rusti- <anon>:5          fn foo() -> ~str { loop { return break } ~"foo" } let x = foo(); let y = foo(); println("%?", x)
[00:19:07] -rusti- <anon>:6     };
[00:19:08] -rusti- error: aborting due to previous error
[00:19:08] -rusti- application terminated with error code 101
[00:19:11] <strcat> rusti: fn foo() -> ~str { loop { return break } ~"foo" } let x = foo(); let y = foo(); printfln!("%?", x)
[00:19:12] -rusti- <anon>:5:78: 5:79 warning: unused variable: `y` [-W unused-variable (default)]
[00:19:12] -rusti- <anon>:5          fn foo() -> ~str { loop { return break } ~"foo" } let x = foo(); let y = foo(); printfln!("%?", x)
[00:19:15] -rusti-                                                                                        ^
[00:19:18] -rusti- ~"foo"
[00:19:20] -rusti- ()
[00:19:34] <strcat> rusti: loop { return break break }
[00:19:34] -rusti- <anon>:5:29: 5:34 error: expected one of `; }` but found `break`
[00:19:34] -rusti- <anon>:5          loop { return break break }
[00:19:34] -rusti-                                       ^~~~~
[00:19:34] -rusti- application terminated with error code 101
[00:19:38] <strcat> rusti: loop { return break  }
[00:19:38] -rusti- ()
[00:19:41] <strcat> rusti: loop { return break return }
[00:19:41] -rusti- <anon>:5:29: 5:35 error: expected one of `; }` but found `return`
[00:19:41] <benh> rusti: loop { return return return break; }
[00:19:41] -rusti- <anon>:5          loop { return break return }
[00:19:42] -rusti-                                       ^~~~~~
[00:19:42] -rusti- application terminated with error code 101
[00:19:42] -rusti- ()
[00:22:00] <Luqman> what does `return break` mean?
[00:22:17] *** Joins: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de)
[00:22:30] <aatch> Luqman, I don't think it means anything. I think it's because 'break' is a valid expression.
[00:22:38] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[00:22:42] <tjc> Luqman: it's equivalent to "break"
[00:23:31] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:23:50] <strcat> tjc: sometimes
[00:24:07] <tjc> strcat: is it ever not?
[00:24:13] <strcat> with the old for loop it wasn't
[00:24:35] <strcat> don't know if it's ever different now though
[00:25:06] <tjc> hmm
[00:25:18] <tjc> if you wrote "return break" inside an old for loop...
[00:25:28] <tjc> that would have an effect that would be different from writing "break"?
[00:25:46] <strcat> yeah it would sometimes read the undef retptr slot
[00:25:52] <tjc> oh, heh
[00:26:00] <myname> 02:19:40 <benh> rusti: loop { return return return break; }
[00:26:00] <myname> 02:19:40 -rusti:#rust- <anon>:5          loop { return break return }
[00:26:00] <tjc> but that was a bug? Presumably?
[00:26:07] <myname> what?
[00:26:07] <tjc> I'm talking about the imaginary formal semantics of Rust here :-)
[00:26:09] <strcat> there's an open issue about the old problem ;]
[00:26:35] <strcat> tjc: yeah I guess a bug
[00:26:50] <strcat> rusti: loop { return return }
[00:26:52] -rusti- pastebinned 9 lines of output: http://ix.io/7kd
[00:26:58] <myname> how does it come from return return return break to return break return?
[00:27:17] <tjc> rusti: let r: int = { loop { return return } };
[00:27:19] -rusti- pastebinned 9 lines of output: http://ix.io/7ke
[00:27:34] <strcat> it'd mad about the unused wrapper code
[00:27:48] <strcat> I should hoist it out into a fn
[00:27:49] <tjc> this is where the fuzzer would be great to have
[00:28:12] *** Quits: mihneadb (Mihnea@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving)
[00:29:39] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr)
[00:29:55] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:30:03] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[00:32:19] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Ping timeout)
[00:33:37] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[00:34:07] <bblum> ok, uh, i was fooling myself when i said i knew how to do this, so
[00:34:16] <bblum> how do i convert an ast ty to a ty, post typeck?
[00:34:39] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[00:35:47] <Luqman> bblum: ast_ty_to_ty :P
[00:35:52] <bblum> Luqman: with what arguments
[00:36:26] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[00:36:46] *** Quits: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de) (Ping timeout)
[00:36:52] <Luqman> bblum: not entirely sure
[00:38:40] <Luqman> bblum: so the first is either the crate context or FnCtxt according to the comment in typeck/astconv.rs
[00:40:05] <Luqman> if this is post typeck i would guess you'd want to use the FnCtxt since it'll look up the item types in the typecache (tcx.tcache)
[00:40:22] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[00:41:08] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Input/output error)
[00:41:11] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[00:41:11] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GBllMA
[00:41:11] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[00:42:27] <toddaaro> where am I allowed to define type aliases in rust code?
[00:42:59] <toddaaro> rusti: type Foo = ~fn() -> uint; let x: Foo = || { 120 }
[00:42:59] -rusti- <anon>:6:4: 6:5 error: expected `;` but found `}`
[00:42:59] -rusti- <anon>:6     };
[00:42:59] -rusti-              ^
[00:43:00] -rusti- application terminated with error code 101
[00:43:19] <toddaaro> rusti: type Foo = ~fn() -> uint;
[00:43:20] -rusti- ()
[00:43:41] <toddaaro> rusti: type Foo = ~fn(uint) -> uint;
[00:43:41] <sfackler> rusti: type Foo = ~fn() -> uint; let x: Foo = || { 120 };
[00:43:42] -rusti- ()
[00:43:42] -rusti- <anon>:5:39: 5:40 warning: unused variable: `x` [-W unused-variable (default)]
[00:43:42] -rusti- <anon>:5          type Foo = ~fn() -> uint; let x: Foo = || { 120 };
[00:43:42] -rusti-                                                 ^
[00:43:43] -rusti- ()
[00:44:08] <sfackler> you just needed the semicolon
[00:44:08] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:44:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wra2Wg
[00:44:08] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:44:09] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:44:10] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/9Vi3lA
[00:44:10] <ghrust> 13rust/06auto 14acdf71e 15Daniel Micay: ptr: inline the Clone implementation
[00:44:10] <ghrust> 13rust/06auto 148b8b5a4 15Daniel Micay: kinds: update documentation
[00:44:10] <ghrust> 13rust/06auto 14fb5fb7e 15Daniel Micay: update the iterator tutorial
[00:44:12] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:45:12] <toddaaro> rusti: struct Foo { x: uint } impl Foo { type Bar = uint; fn baz() -> Bar { 120 } }
[00:45:12] -rusti- <anon>:5:43: 5:47 error: unexpected token: `type`
[00:45:12] -rusti- <anon>:5          struct Foo { x: uint } impl Foo { type Bar = uint; fn baz() -> Bar { 120 } }
[00:45:13] -rusti-                                                     ^~~~
[00:45:13] -rusti- application terminated with error code 101
[00:45:27] <toddaaro> so are type aliases not allowed inside struct impls
[00:45:35] <bblum> Luqman: i have a kind::Context which lets me access a ty::ctxt
[00:45:37] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[00:45:43] <bblum> Luqman: i seem to have no fcx or ccx
[00:45:55] *** kimundi is now known as zz_kimundi
[00:48:46] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[00:49:59] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:54:07] *** Joins: dew1 (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com)
[00:54:51] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[01:02:08] <bblum> urgh
[01:02:12] <bblum> still don't know how to do this :(
[01:02:27] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[01:03:07] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:03:07] <ghrust> 01[13rust01] 15nikomatsakis pushed 1 new commit to 06try: 02http://git.io/Fd6KtA
[01:03:07] <ghrust> 13rust/06try 14a8057c3 15Niko Matsakis: add fixed_stack_segment to one remaining win test
[01:03:07] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:03:44] *** Quits: eschweic1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:05:07] <toddaaro> it has been mentioned that we will someday be able to pass methods as closures, is that a soonish thing or far in the future?
[01:05:21] <bblum> |args| { self.foo(args) }
[01:05:37] <toddaaro> that is disgusting
[01:05:50] <toddaaro> 'foo' is a lot shorter
[01:06:26] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[01:06:33] <bblum> i wouldn't say that not having pretty syntax sugar for something you can do pretty easily today is 'disgusting'
[01:06:40] <bblum> maybe, 'mildly inconvenient'
[01:07:18] <toddaaro> it is disgusting, we have two sets of syntax for the same thing and you can't easily interop the two, so if you want to there are awkward and pointless looking conversion functions all over the place
[01:08:04] <jack> toddaaro: i was pretty sure that was considered a bug and slated to be fixed.
[01:08:30] <toddaaro> jack: yea, that will be great, I'm just curious when it will happen
[01:08:41] <kmc> well in this case it would be 'self.foo' which really is a closure, over 'self'
[01:08:52] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[01:08:57] <kmc> but yes the sugar would be good
[01:10:19] *** Quits: klutzy (th@BA61F396.8E859986.ECA1BB11.IP) (Client exited)
[01:13:25] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[01:13:43] <brson> toddaaro: here's a patch to your idle tree: https://github.com/brson/rust/tree/idle-opt it seems to work reliably for me
[01:13:56] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:14:04] <brson> toddaaro: there are a couple things that aren't ideal
[01:14:30] <brson> 1) when no_sleep becomes true (i.e. Shutdown is received) the idle handling goes into a less efficient mode where it reallocates handles more often
[01:14:39] <brson> most of the rt tests are run in this mode
[01:15:17] <brson> oh, it did just drop a message and rtabort during a stress test, so there's still something wrong here
[01:15:54] <brson> rt tests are run in the less efficient mode because new_test_uv_sched explicitly sets no_sleep = true
[01:16:11] <brson> 2) Scheduler shouldn't be using IdleWatcher directly but instead using the rtio abstractions
[01:16:33] <toddaaro> yea, we should have an Idleable trait of some sort in there
[01:16:41] <brson> have to look into the dropped message more tomorrow
[01:16:47] <toddaaro> it is perplexing
[01:16:49] <brson> i have to leave early tonight
[01:17:09] <toddaaro> ok, I'd offer you new and improved rtdebug for the effort but \rainbow{ICE}
[01:17:42] <toddaaro> though I'll have a PR up for sched.rs cleanup this evening
[01:17:56] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:18:26] *** Quits: richard|s (mindginati@moz-C1729134.dsl.clear.net.nz) (Quit: zzZZZ)
[01:19:54] <brson> oh, and there is indeed some weird problem that's making development with NO_REBUILD=1 impossible. i have an idea of what it is - the code for getting into a clean runtime context (run_in_bare_thread) may be mixing the implementations from the host scheduler and the scheduler being tested, when they are two diferent things
[01:20:03] *** Joins: klutzy (th@BA61F396.8E859986.ECA1BB11.IP)
[01:20:04] <brson> anyway gtg
[01:20:05] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[01:20:36] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:20:37] *** ChanServ sets mode: +o brson
[01:20:47] <brson> oh, actually I think i know why the messages are being dropped
[01:21:00] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[01:21:17] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[01:21:17] <toddaaro> the suspsense on that is going to kill me
[01:21:18] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:21:18] *** ChanServ sets mode: +o brson
[01:21:50] <brson> i guess that's not right to be so mysterious. i'll point out what i think the prob is
[01:22:05] <toddaaro> ha, yes
[01:22:10] <toddaaro> you certainly have my attention
[01:23:08] *** Quits: ipc (ipc@moz-76ED5036.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[01:23:16] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:23:16] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146304220 to 14c4656cf: 02http://git.io/N3iJvQ
[01:23:16] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:23:16] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:23:16] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/8FLogg
[01:23:16] <ghrust> 13rust/06auto 14062747b 15Daniel Micay: ptr: inline the Clone implementation
[01:23:16] <ghrust> 13rust/06auto 14af9ddd7 15Daniel Micay: kinds: update documentation
[01:23:17] <ghrust> 13rust/06auto 146a21f22 15Daniel Micay: update the iterator tutorial
[01:23:19] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:24:42] <Eridius> now this is a mouthful: make check-stage2-T-x86_64-apple-darwin-H-x86_64-apple-darwin-pretty-rfail-exec
[01:25:02] <brson> oh, nvm. i don't see it :-/
[01:25:03] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[01:26:20] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[01:31:59] <erickt> dbaupp: ping
[01:33:12] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:33:12] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14a8057c3 to 14fe5f08f: 02http://git.io/k471pw
[01:33:12] <ghrust> 13rust/06try 14bfadc8c 15Tim Chevalier: rustpkg: Un-ignore tests
[01:33:12] <ghrust> 13rust/06try 14fe5f08f 15Tim Chevalier: wip
[01:33:12] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:33:56] <toddaaro> rusti: struct Foo { a: uint, b: uint }; let foo = Foo { a: 5, b: 120 }; let c,d = Foo { c: a, d: b }; c
[01:34:00] -rusti- pastebinned 6 lines of output: http://ix.io/7kl
[01:34:31] <toddaaro> rusti: struct Foo { a: uint, b: uint }; let foo = Foo { a: 5, b: 120 }; let (c,d) = Foo { c: a, d: b }; c
[01:34:34] -rusti- pastebinned 8 lines of output: http://ix.io/7km
[01:35:07] *** Joins: ipc (ipc@moz-76ED5036.lightspeed.cicril.sbcglobal.net)
[01:35:23] <toddaaro> rusti: struct Foo { a: uint, b: uint }; let foo = Foo { a: 5, b: 120 }; let Foo { a: c, b: d }; c
[01:35:24] -rusti- <anon>:5:78: 5:96 error: the type of this value must be known in this context
[01:35:24] -rusti- <anon>:5          struct Foo { a: uint, b: uint }; let foo = Foo { a: 5, b: 120 }; let Foo { a: c, b: d }; c
[01:35:24] -rusti-                                                                                        ^~~~~~~~~~~~~~~~~~
[01:35:25] -rusti- error: aborting due to previous error
[01:35:26] -rusti- application terminated with error code 101
[01:37:15] <toddaaro> how do you destruct a struct into a let?
[01:37:18] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[01:37:32] <tjc> toddaaro: let F { a: a, b: b } = foo;
[01:37:35] <tjc> for example
[01:37:57] *** Joins: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz)
[01:38:02] <Eridius> rusti struct Foo { a: int, b: int } let Foo { a, _ } = Foo { a: 3, b: 4 }; a
[01:38:07] <Eridius> rusti: struct Foo { a: int, b: int } let Foo { a, _ } = Foo { a: 3, b: 4 }; a
[01:38:09] -rusti- 3
[01:38:16] <toddaaro> ah, thanks
[01:38:21] <Eridius> if you don't name the field it assumes the variable name is the field name, and _ lets you ignore fields
[01:38:41] <tjc> that too
[01:39:08] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[01:39:26] <Luqman> bblum: there's tcx.ast_ty_to_ty_cache which is probably what you want
[01:39:44] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[01:42:12] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:47:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:47:54] <tikue> rusti: range(1u, 3).map(|_| 5)
[01:47:55] -rusti- {iter: {state: 1, stop: 3, one: 1}, f: }
[01:48:58] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[01:50:04] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[01:50:14] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[01:53:25] <engla> the longest NFKD expansion is 1 to 18 codepoints
[01:53:30] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[01:53:41] <engla> fun fact.
[01:54:41] <kmc> is that U+FDFD 'ARABIC LIGATURE BISMILLAH AR-RAHMAN AR-RAHEEM'?
[01:55:11] <engla> it's U+FDFA
[01:55:32] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Ping timeout)
[01:55:33] <kmc> ah 'ARABIC LIGATURE SALLALLAHOU ALAYHE WASALLAM'
[01:56:41] <engla> while NFD expands 1 -> 4 codepoints maximum
[01:57:00] <engla> but it might change with unicode versions. What if the declaration of human rights gets its own codepoint
[01:57:11] <kmc> complete works of shakespeare
[01:57:15] <kmc> hmmm error: failed to find an implementation of trait std::to_bytes::__extensions__::iter_bytes for int
[01:57:19] <kmc> that's quite an odd error
[01:57:36] <engla> on a nonstd platform?
[01:57:46] <engla> that impl is special cased to match the size of int
[01:58:23] <engla> no that's uint
[01:59:01] <kmc> no just x86_64 linux
[01:59:21] <kmc> I think my build directory is just f'd
[01:59:57] *** Joins: joshua_ (joshua@moz-45967CBE.emarhavil.com)
[01:59:57] *** Quits: joshua_ (joshua@moz-45967CBE.emarhavil.com) (Quit: joshua_)
[01:59:59] *** Joins: joshua_ (joshua@moz-45967CBE.emarhavil.com)
[02:00:08] <engla> maybe somehow the cfg vars are not set. #[cfg(target_word_size = "64")]
[02:00:19] <Eridius> engla: I recall reading somewhere that the unicode consortium did not want to introduce any more composed characters
[02:00:30] <kmc> what does __extensions__ mean in names generally?
[02:00:39] <engla> aha
[02:00:48] <kmc> Eridius: makes sense; they exist for round trip compatibility with legacy encodings, and there should be no more new legacy encodings (wishful thinking)
[02:00:54] <kmc> maybe they exist for other reasons though
[02:01:09] <strcat> it means from a trait impl
[02:01:12] <Eridius> kmc: well I think they originally thought composed characters would be useful, but then changed their mind
[02:01:16] <Eridius> but that's just a guess
[02:01:18] <strcat> it doesn't mangle in the name
[02:01:20] <strcat> it's annoying
[02:01:20] * kmc wonders if 'SALLALLAHOU ALAYHE WASALLAM' is from a legacy encoding
[02:01:25] <kmc> Eridius: yeah they do that a lot :/
[02:01:53] <Eridius> this factoid is pretty old though, so it could be wrong (but it makes sense)
[02:02:15] <Eridius> if I recall correctly, I read this back when I was having an epic flame war with Linus Torvalds on the Git mailing list about HFS+ unicode support ;)
[02:02:39] <Eridius> which was.. January 2008 I believe
[02:02:46] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Ping timeout)
[02:03:17] <kmc> wow
[02:03:42] <engla> I remember when an early OS X update rendered some files unusable, unremovable
[02:04:00] <engla> because of some kind of change in normalization rules
[02:04:20] <kmc> ouch
[02:04:24] <Eridius> engla: that surprises me. HFS+ hard-codes the normalization rules (it's pegged to some older Unicode standard, I forget which version) precisely to avoid such incompatibilities
[02:04:54] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[02:08:22] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[02:09:39] *** Quits: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu) (Ping timeout)
[02:10:10] *** Joins: true_droid (true_droid@moz-123FD9B8.beck.volia.net)
[02:11:12] *** Quits: cdidd (cdidd@moz-1137464F.broadband.corbina.ru) (Input/output error)
[02:11:50] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Ping timeout)
[02:13:18] *** Joins: cdidd (cdidd@moz-44D99375.broadband.corbina.ru)
[02:13:42] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[02:14:59] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[02:15:32] *** Quits: cdidd (cdidd@moz-44D99375.broadband.corbina.ru) (Input/output error)
[02:16:30] *** Quits: sebcrozet (sebcrozet@moz-6DA639AF.w80-13.abo.wanadoo.fr) (Ping timeout)
[02:16:49] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[02:17:15] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[02:18:25] *** Joins: cdidd (cdidd@moz-F392B1B8.broadband.corbina.ru)
[02:18:30] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[02:19:32] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:20:34] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:21:22] *** Quits: eevee (eevee@moz-9A8E1439.evrt.wa.frontiernet.net) (Connection reset by peer)
[02:21:35] *** Joins: eevee (eevee@moz-9A8E1439.evrt.wa.frontiernet.net)
[02:27:04] *** Quits: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[02:28:28] <kmc> re std::to_bytes::__extensions__::iter_bytes: yeah, a clean rebuild fixed it
[02:28:46] <kmc> I am pretty glad I got the beefiest laptop Mozilla provides :)
[02:28:55] *** Quits: zz_kimundi (kimundi@moz-5D6B45D9.dip0.t-ipconnect.de) (Ping timeout)
[02:29:07] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:29:20] <toddaaro> kmc: who are you?
[02:29:24] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:29:37] <strcat> a three letter string
[02:29:42] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[02:29:51] * aatch whoises
[02:29:52] <tikue> toddaaro: kmc is Keegan the Servo fulltimer
[02:30:08] <toddaaro> hm, guess I never managed to meet that person
[02:30:15] <tikue> he works in SF
[02:32:05] <Eridius> San Francisco is best Francisco
[02:32:14] <tikue> no
[02:32:15] *** Joins: zz_kimundi (kimundi@moz-7C028A28.dip0.t-ipconnect.de)
[02:32:39] <tikue> that'd be Francisco d'Anconia :P
[02:32:42] *** zz_kimundi is now known as kimundi
[02:33:51] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:36:35] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:36:36] *** ChanServ sets mode: +o dherman
[02:36:47] <tikue> sully: haha i absolutely love that quote in your presentation: "It's like C++ grew up, went to grad school, started dating Haskell, and shares an office with Erlang"
[02:37:34] <rpearl> sully: wait did Rust break up with SML and start dating Haskell?
[02:37:47] <rpearl> such drama
[02:37:54] <tikue> lolol
[02:37:55] <jack> I think Rust is polyamorous.
[02:38:05] <tjc> didn't Lindsey come up with the quote?
[02:38:16] <tikue> tjc: sully didn't attribute it but put it in quotes
[02:38:19] <toddaaro> as long as Rust doesn't get involved with Scala we should be ok
[02:38:54] <jack> toddaaro: but then we could have contravariant pointers.
[02:39:14] <tikue> jack: what are those?
[02:39:40] <jack> tikue: something i made up. but contravariant types are a thing in scala. it's a subtyping relationship thing.
[02:39:52] <tikue> oh haha *woosh*
[02:40:06] <toddaaro> that could be useful, but I think that is pretty standard anywhere there is subtyping right?
[02:40:11] <jack> covariant and contravariant. i think scala uses - and + to distiguish them
[02:40:19] <tjc> Rust doesn't really have subtyping, though
[02:40:21] <tjc> just for lifetimes
[02:40:40] <toddaaro> yea, it gets nightmarish when you are doing typeclass style code and using implicit arguments and need variance at the same time
[02:43:19] <jack> tikue: can't find a great explanation, but this seems okish: http://coding-time.blogspot.com/2011/05/covariance-and-contravariance-simple.html
[02:43:37] <sfackler> I have an @ast::expr and want to use it multiple times in the same ast. i'm hitting an assert in check_loans saying that the scopes of two loans don't intersect. am I right in thinking that that's caused by using the expr multiple times?
[02:43:49] <tikue> jack: thanks, will peruse
[02:56:39] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[02:58:15] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Quit: Leaving)
[02:59:27] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[03:03:53] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[03:04:53] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[03:08:38] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:09:19] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[03:10:18] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[03:13:12] *** Joins: mihneadb (Mihnea@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[03:23:56] *** Joins: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu)
[03:26:15] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:26:15] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/8FLogg
[03:26:15] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:29:13] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:29:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/OfZ4ow
[03:29:13] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:29:16] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:29:16] <ghrust> 01[13rust01] 15bors pushed 13 new commits to 06auto: 02http://git.io/pUXn4g
[03:29:16] <ghrust> 13rust/06auto 1429876dc 15Niko Matsakis: Issue #3678: Remove wrappers and call foreign functions directly
[03:29:16] <ghrust> 13rust/06auto 14ab5898a 15Niko Matsakis: Remove implicit stack attributes and add a lint
[03:29:16] <ghrust> 13rust/06auto 148ce6546 15Niko Matsakis: Add externfn macro and correctly label fixed_stack_segments
[03:29:18] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[03:31:18] *** Joins: mrordinaire (Mibbit@C4C5857B.391F484.FD383126.IP)
[03:36:39] *** Quits: mrordinaire (Mibbit@C4C5857B.391F484.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:40:00] *** Joins: Voomer (Voomer@moz-CC05FF5E.hsd1.wa.comcast.net)
[03:41:46] *** Joins: mrordinaire (Mibbit@C4C5857B.391F484.FD383126.IP)
[03:43:33] <mihneadb> guys, there's a typo in this rust position description, maybe you can fix it
[03:43:33] <mihneadb> http://careers.mozilla.org/en-US/position/oKiEXfwn
[03:43:49] <mihneadb> " progressing towards being production **readiness**"
[03:52:03] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Quit: WeeChat 0.4.1)
[03:52:14] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:52:14] *** ChanServ sets mode: +o dherman
[03:54:07] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:55:12] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[03:55:50] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[03:55:50] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[03:56:14] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:56:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141422b7b to 141ad0cf5: 02http://git.io/N3iJvQ
[03:56:14] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:56:15] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:56:15] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/zBbhFw
[03:56:15] <ghrust> 13rust/06auto 140266172 15Tim Chevalier: testsuite: xfailed test cases
[03:56:15] <ghrust> 13rust/06auto 14253337d 15bors: auto merge of #7917 : catamorphism/rust/resolve-and-testcases, r=catamorphism
[03:56:16] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:56:23] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[03:57:25] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[03:58:28] <mrordinaire> rusti: [1,2,3].map(|&x| { x * 2 })
[03:58:29] -rusti- ~[2, 4, 6]
[03:58:41] <mrordinaire> rusti: [1,2,3].map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[03:58:47] -rusti- pastebinned 8 lines of output: http://ix.io/7fr
[04:02:29] <mrordinaire> rusti: [1,2,3].map(|&x| { x * 2 }).reduce(0, |x, acc| { x + acc })
[04:02:31] -rusti- pastebinned 8 lines of output: http://ix.io/7ks
[04:03:45] *** Joins: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[04:04:08] <engla> fold is for .iter().map()
[04:04:24] <engla> also the acc is the first argument (but it doesn't matter for this case)
[04:05:14] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[04:05:19] <engla> rusti: let v = [1,2,3]; v.iter().map(|&x| x*2).fold(0, |a,b| a + b)
[04:05:20] -rusti- 12
[04:05:31] <engla> rusti: let v = [1,2,3]; v.iter().sum()
[04:05:32] -rusti- <anon>:5:26: 6:5 error: type `std::vec::VecIterator<,<VI2>>` does not implement any method in scope named `sum`
[04:05:32] -rusti- <anon>:5          let v = [1,2,3]; v.iter().sum()
[04:05:32] -rusti- <anon>:6     };
[04:05:32] -rusti- error: aborting due to previous error
[04:05:32] -rusti- application terminated with error code 101
[04:05:36] <engla> rusti: let v = [1,2,3]; v.iter().sum_()
[04:05:36] -rusti- <anon>:5:26: 6:5 error: type `std::vec::VecIterator<,<VI2>>` does not implement any method in scope named `sum_`
[04:05:36] -rusti- <anon>:5          let v = [1,2,3]; v.iter().sum_()
[04:05:38] -rusti- <anon>:6     };
[04:05:40] -rusti- error: aborting due to previous error
[04:05:42] -rusti- application terminated with error code 101
[04:05:47] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:06:07] <engla> rusti: use std::iterator::*; let v = [1,2,3]; v.iter().sum()
[04:06:07] -rusti- <anon>:5:48: 6:5 error: failed to find an implementation of trait std::ops::Add<&int,&int> for &int
[04:06:08] -rusti- <anon>:5          use std::iterator::*; let v = [1,2,3]; v.iter().sum()
[04:06:08] -rusti- <anon>:6     };
[04:06:08] -rusti- application terminated with error code 101
[04:06:11] <engla> :-(
[04:06:32] <engla> rusti: use std::iterator::*; range(0,10).sum()
[04:06:33] -rusti- 45
[04:06:49] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:07:00] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:07:00] <strcat> sum/product/min/max aren't very useful
[04:08:26] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Quit: lmandel)
[04:08:42] <mrordinaire> engla: thanks :)
[04:08:55] <engla> there is max_by/min_by at least
[04:09:01] <mihneadb> engla: wait, both .map and .iter.map work?
[04:09:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:09:13] <engla> mrordinaire: it will make more sense when rust is more finished
[04:09:32] <engla> mihneadb: on a vector, .map is the old ~[] -> ~[] mapper
[04:09:50] <mihneadb> engla: 
[04:09:51] <mihneadb> ok
[04:09:56] <engla> the implementation is just  v.iter().map(f).collect()
[04:10:01] <mihneadb> aha
[04:10:25] <mihneadb> engla: the plan is to make the .iter() step implicit, right?
[04:10:36] <mihneadb> so v.map() would become v.iter().map() ?
[04:10:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:11:42] <engla> I think so
[04:12:00] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[04:13:43] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Ping timeout)
[04:14:00] <mrordinaire> rusti: range(1, 10).map(|&x| { x * 2 }).fold(0, |acc, x| { x + acc })
[04:14:00] -rusti- <anon>:5:27: 5:29 error: mismatched types: expected `int` but found an &-pointer pattern
[04:14:00] -rusti- <anon>:5          range(1, 10).map(|&x| { x * 2 }).fold(0, |acc, x| { x + acc })
[04:14:00] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[04:14:00] -rusti-                                     ^~
[04:14:01] -rusti- error: aborting due to previous error
[04:14:01] -rusti- application terminated with error code 101
[04:14:10] <mrordinaire> rusti: range(1, 10).map(|x| { x * 2 }).fold(0, |acc, x| { x + acc })
[04:14:11] -rusti- 90
[04:14:25] <mrordinaire> rusti: range(1, 10).map(|x| { x * 5 }).fold(0, |acc, x| { x + acc })
[04:14:26] -rusti- 225
[04:15:58] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:20:45] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[04:21:07] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[04:21:07] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[04:21:12] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[04:22:27] *** Quits: mrordinaire (Mibbit@C4C5857B.391F484.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:26:40] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[04:26:49] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[04:27:56] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[04:29:03] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[04:32:54] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:33:26] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:35:08] *** Joins: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr)
[04:35:56] *** Quits: io2 (io2@moz-A6202C16.home.otenet.gr) (Quit: )
[04:43:32] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Quit: Leaving)
[04:45:00] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:46:11] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[04:46:19] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[04:47:49] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[04:50:10] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:50:16] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:58:45] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[04:59:37] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:59:37] *** ChanServ sets mode: +o dherman
[05:00:30] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[05:09:23] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:11:03] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[05:12:21] <acrichto> dbaupp: ping
[05:13:35] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[05:14:24] <dbaupp> acrichto: pong
[05:14:37] *** Quits: mihneadb (Mihnea@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Quit: Leaving)
[05:14:49] <acrichto> dbaupp: how would you feel about moving the semicolon out of the macro
[05:14:57] <acrichto> tog et something like "local_data_key!(...);" 
[05:14:59] <dbaupp> acrichto: which semicolon?
[05:15:05] <acrichto> the last one
[05:15:08] <dbaupp> isn't that how it is already?
[05:15:23] <acrichto> nah you don't have to have the semicolon on your macro
[05:15:32] <acrichto> the macro inserts it for you
[05:16:23] <dbaupp> oh, you mean the semicolon at the end of `static $name: ... &Key;` ?
[05:16:30] <acrichto> yeah
[05:16:41] <acrichto> just to be more consistent with declaring a static normally
[05:16:47] <dbaupp> does that even work?
[05:16:49] <acrichto> or to further indicate you're generating a static perhaps
[05:16:52] <acrichto> I think?
[05:17:01] <dbaupp> hm, rusti's gone
[05:17:04] * dbaupp tries locally
[05:17:08] <acrichto> if it doesn't then r+
[05:17:51] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[05:17:55] <dbaupp> static-semi.rs:7:6: 7:7 error: expected item but found `;`
[05:17:55] <dbaupp> static-semi.rs:7 foo!();
[05:17:55] <dbaupp>                        ^
[05:18:21] <dbaupp> macro_rules! foo { () => { static foo: int = 1 } } foo!(); fn main() {}
[05:18:34] <acrichto> awww oh well
[05:18:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[05:18:54] <acrichto> r+
[05:19:09] <dbaupp> :)
[05:19:41] <acrichto> man local_data::key!(...) would be awesome
[05:19:57] <acrichto> or rather just importable macros
[05:20:00] <dbaupp> yeah
[05:20:05] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:20:20] <dbaupp> but it'll require ripping metadata out of rustc and into syntax
[05:20:23] *** Quits: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz) (Quit: zzZZZ)
[05:20:36] <dbaupp> (that's probably a good way to modernise it though.)
[05:20:37] <sfackler> acrichto: any idea why this would trip an assert in check_loans? https://github.com/sfackler/rust/commit/6c63bc65554bdd4ad1de5ee041e1b4cff6551f4e
[05:20:38] <acrichto> yeah... it'll get interesting...
[05:20:51] <sfackler> i assume it's because i'm reusing the expr, but it's hard to tell
[05:21:07] <acrichto> sfackler: that's a lot of code :(
[05:21:07] <dbaupp> sfackler: have you got a macro somewhere?
[05:21:15] <sfackler> relavant changes are in quote.rs
[05:21:23] <acrichto> sfackler: have you gotten a backtrace?
[05:21:28] <sfackler> https://github.com/sfackler/rust/commit/6c63bc65554bdd4ad1de5ee041e1b4cff6551f4e#L4L312
[05:21:35] <sfackler> task <unnamed> failed at 'assertion failed: region_maps.scopes_intersect(old_loan.kill_scope, new_loan.kill_scope)', /home/sfackler/rust/src/librustc/middle/borrowck/check_loans.rs:183
[05:21:46] <acrichto> oooh...
[05:21:51] <sfackler> most of the commit is just supporting stage0
[05:21:54] <acrichto> I saw that a long time ago
[05:22:20] <dbaupp> sfackler: https://github.com/mozilla/rust/issues/6304
[05:22:43] <dbaupp> sfackler: it's almost certainly reusing a single expr twice in one expansion
[05:22:52] * dbaupp has met that error in that context
[05:23:08] <sfackler> is there a work around?
[05:23:17] <acrichto> sfackler: yeah macros do weird things sometimes b/c the same node_id or something like that is used in more than one place
[05:23:19] <dbaupp> yeah, `let e = $e;`
[05:23:20] <sfackler> i guess retokenizing and parsing could work if that's possible
[05:23:27] <dbaupp> and then using e
[05:23:33] <sfackler> ah
[05:23:33] <acrichto> ^
[05:23:36] <dbaupp> (assuming that's possible in this context)
[05:23:42] <sfackler> it should be
[05:23:54] <sfackler> thanks!
[05:24:42] <dbaupp> heh; it appears that someone copied the docstring of {at_vec,str,vec}::raw::set_len across all 3: they all have the same typo.
[05:24:42] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[05:25:09] <acrichto> oh dear...
[05:25:19] * dbaupp is fixing a pile of spelling errors
[05:25:50] <dbaupp> including "It returns the fatest `Rng` algorithm ..."
[05:26:45] <acrichto> you should correct that to 'fattest'
[05:27:11] <dbaupp> It's actually the thinest, only 32 bytes of state, rather than several kb :P
[05:27:29] <acrichto> man that's huge
[05:28:03] <dbaupp> is "frobbing" a word?
[05:28:04] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: Textual IRC Client: www.textualapp.com)
[05:28:15] <acrichto> definitely
[05:28:29] <sfackler> yo' rng's so fat its period is 2^19937-1
[05:28:29] <dbaupp>  /// Initializes global state, including frobbing
[05:28:29] <dbaupp>  /// the crate's logging flags, registering GC
[05:28:29] <dbaupp>  /// metadata, and storing the process arguments.
[05:28:38] *** Quits: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se) (Ping timeout)
[05:29:10] <acrichto> frobbing seems quite appropriate there :)
[05:29:21] <acrichto> when bits need to be frobbed, they get frobbed
[05:29:30] <dbaupp> haha
[05:29:42] * dbaupp leaves that as is
[05:30:02] <dbaupp> hm, it appears that the span on inner doc comments is wrong :(
[05:31:24] *** Joins: brson (brson@E9CDE21E.991753BB.CA4D1600.IP)
[05:31:24] *** ChanServ sets mode: +o brson
[05:31:40] * dbaupp wonders if this is ever observable without a third party program calling libsyntax itself
[05:32:38] <brson> toddaaro: I think I found the problem that's causing messages to be missed. There's a race in UvRemoteCallback's callback wrapper that closes the handle that causes the handle to close early
[05:32:43] <brson> not sure how to fix it yet
[05:34:20] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[05:34:36] <brson> oh it might be easy to fix
[05:36:39] <toddaaro> brson: wait really
[05:36:43] <toddaaro> brson: where is this code
[05:36:57] <toddaaro> I thought I looked it over and satisfied myself it was race-free
[05:37:13] <toddaaro> due to some trickyness with an exclusive in the destructor
[05:39:36] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[05:41:04] <brson> toddaaro: the async callback works vaguely like `f(); if should_exit { close() }`. This is - at the least - the wrong ordering of these operations. What happens is that, in the other thread, `fire` is called twice; in the event loop thread, during the response to the first fire it sees the should_exit flag and closes, never to respond to the second `fire`
[05:41:05] <tikue> "i've only proven it correct"
[05:42:20] <tikue> brson: couldn't that happen with servo too? e.g. clicking "quit" twice really fast
[05:42:57] <toddaaro> but that should be safe still, as if you have messages in the queue the idle callback should be active, guarenteeing you get them
[05:44:06] <toddaaro> hm, there might be a hole if the message is queued between the return of interpret_message_queue failing to find a message and the return of the callback function
[05:44:29] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[05:45:18] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Quit: dim-an)
[05:45:19] <toddaaro> something like idle_callback processes the message the async callback was for, async callback is handled, fails to see the message, message is then queued, idle callback deactivated, async callback closes handle
[05:45:45] <dbaupp> https://github.com/mozilla/rust/pull/8551 r?
[05:47:39] <toddaaro> brson: oh, and https://github.com/mozilla/rust/pull/8549
[05:47:56] <toddaaro> brson: nothing exciting, but I think the file is more clearly laid out
[05:48:14] <toddaaro> brson: the one detail I'm unsure about is the placement of the supporting structs/impls
[05:48:34] <toddaaro> and it was intriguing to find out that unused enum is not something lint checks for
[05:48:39] <toddaaro> wonder how hard that is to add
[05:50:39] <dbaupp> acrichto: I do too; that staticant was the last reminder of the glorious libcore days! :'(
[05:51:04] <acrichto> dbaupp: I think there was actually a renaming at some point which specifically left in that staticant
[05:51:25] <dbaupp> (well, maybe not, I'm pretty sure there are still `use core::...`'s around the place.)
[05:51:42] <dbaupp> acrichto: oh; maybe I shouldn't "correct" it then :P
[05:51:49] <acrichto> dbaupp: oh nah it's fine :)
[05:51:55] <acrichto> also yeah there are 7 cases of 'use core'
[05:52:18] <dbaupp> I'll fix them too then
[05:53:17] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:53:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/zBbhFw
[05:53:17] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:54:04] <acrichto> dbaupp: also I hope your branch was purposefully 'speling'
[05:56:16] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[05:56:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/0FK0oA
[05:56:16] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:56:34] <dbaupp> acrichto: ;)
[05:56:46] <dbaupp> acrichto: added an extra commit
[05:57:10] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[05:57:42] *** Quits: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr) (Ping timeout)
[05:57:42] <acrichto> r+
[05:58:35] * dbaupp lied; he actually added a core -> std commit, extra wasn't involved at all.
[05:59:16] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:59:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/0FK0oA
[05:59:16] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:59:17] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:59:17] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/F35SwQ
[05:59:17] <ghrust> 13rust/06auto 14f174e7f 15Gavin Baker: Add UUID support to libextra...
[05:59:17] <ghrust> 13rust/06auto 149c6620f 15bors: auto merge of #8053 : gavinb/rust/uuid_std, r=alexcrichton...
[05:59:17] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:08:59] <brson> toddaaro: looks good. the unused enum variant lint mode would probably be easy to add. they mostly are
[06:09:02] <brson> tikue: possibly, though I'm not that familiar with how servo exits. race conditions abound!
[06:09:43] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[06:09:44] <ChrisMorgan> Given an enum { Foo(Tm) } and `opt_tm: Option<Tm> = Some(tm)`, how can I get from that `Foo(tm)`?
[06:09:50] <tikue> brson: "you get to exit! YOU get to exit! YOU GET TO EXIT!!! EVERYBODY GETS TO EXIT!"
[06:10:15] <dbaupp> ChrisMorgan: you mean convert the Some to a Foo?
[06:10:19] <brson> toddaaro: my work is here. stil stress testing though. https://github.com/brson/rust/tree/idle-opt
[06:10:30] <dbaupp> ChrisMorgan: "convert"
[06:10:32] <ChrisMorgan> dbaupp: yep (can't consume it though, must be a copy)
[06:11:05] <dbaupp> ChrisMorgan: match opt_tm { Some(ref x) => Foo(x), ... } is one way
[06:11:14] <dbaupp> what happens when it's None?
[06:11:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[06:11:24] <tikue> brson: maybe it's as simple as having an exit routine that try_recv()'s on the constellation chan until it closes, just ignoring all messages that arrive
[06:11:35] <ChrisMorgan> dbaupp: no it isn't: that's a &Tm rather than a Tm.
[06:11:44] <dbaupp> ChrisMorgan: I mean, Some(ref x) => Foo(x.clone())
[06:11:52] <ChrisMorgan> That's &Tm too.
[06:12:20] <dbaupp> well that means that Tm isn't Cloneable
[06:12:29] <dbaupp> you need to either derive or impl Clone.
[06:13:47] <ChrisMorgan> Meaning that I should modify extra::time::Tm upstream to add #[deriving(Clone)]?
[06:13:52] <dbaupp> oh!
[06:14:00] <dbaupp> ... yuck
[06:14:10] <dbaupp> but yes, it should have Clone if at all possible
[06:14:13] <ChrisMorgan> At present it has `#[deriving(Eq, Encodable, Decodable)]`
[06:14:25] <ChrisMorgan> All it is is a bunch of i32s and a ~str.
[06:14:26] <tikue> rusti: let (port, chan) = ::std::comm::stream(); chan.send(0);
[06:14:28] -rusti- <anon>:5:14: 5:18 warning: unused variable: `port` [-W unused-variable (default)]
[06:14:28] -rusti- <anon>:5          let (port, chan) = ::std::comm::stream(); chan.send(0);
[06:14:28] -rusti-                        ^~~~
[06:14:28] -rusti- ()
[06:14:41] <tikue> rusti: let (port, chan) = ::std::comm::stream(); chan.send(0); let _ = port;
[06:14:42] -rusti- ()
[06:14:51] <ChrisMorgan> This explicitly-derive-clone business is very sad.
[06:14:52] <dbaupp> ChrisMorgan: yup, I'd r+ a commit adding Clone and DeepClone
[06:15:49] <ChrisMorgan> I can add it for Timespec while I'm at it.
[06:16:00] *** Joins: true_droid (true_droid@moz-123FD9B8.beck.volia.net)
[06:16:29] <ChrisMorgan> dbaupp: any tests needed for that?
[06:16:48] <dbaupp> ChrisMorgan: probably not
[06:16:59] *** Joins: fabiand (fabiand@moz-F4592424.adsl.alicedsl.de)
[06:17:36] <dbaupp> but it looks like Timespec could actually derive Ord, TotalOrd and TotalEq
[06:18:03] <dbaupp> (hm, maybe not; since there doesn't seem to be anything maintaining that nsec < 1e9.)
[06:18:59] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[06:22:36] <joelteon> is there a Select for Port yet
[06:23:31] *** Quits: brson (brson@E9CDE21E.991753BB.CA4D1600.IP) (Quit: leaving)
[06:23:36] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:23:56] *** Joins: keret (Mibbit@FBE8D0AC.DA97A9A4.520CDC98.IP)
[06:25:20] <keret> Hey, I just finished reading the tutorial on conditions (http://static.rust-lang.org/doc/tutorial-conditions.html) and was wondering how to handle functions that raise multiple types of conditions. Any idea?
[06:26:14] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:26:15] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149c6620f to 14253337d: 02http://git.io/N3iJvQ
[06:26:15] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:26:18] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:26:18] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/NGkbHQ
[06:26:18] <ghrust> 13rust/06auto 1409911ab 15Tim Chevalier: rustc: More helpful error message when using a struct type like a function...
[06:26:18] <ghrust> 13rust/06auto 14e9c8402 15bors: auto merge of #8502 : catamorphism/rust/issue-6702, r=catamorphism...
[06:26:19] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:26:20] <dbaupp> rusti: use std::rt::comm; use std::select; let (p1,c1) = comm::stream::<int>(); let (p2,c2) = comm::stream::<int>(); do spawn { c1.send(1) } select::select([p1,p2])
[06:26:22] -rusti- line longer than 150 columns, pastebinned 4 lines of output: http://ix.io/7ky
[06:26:55] <dbaupp> rusti: use std::rt::comm; use std::select; let (p1,_c1) = comm::stream::<int>(); let (p2,_c2) = comm::stream::<int>(); do spawn { _c2.send(100) } select::select([p1,p2])
[06:26:56] -rusti- 1
[06:26:59] <dbaupp> joelteon: ^
[06:27:18] <joelteon> i thought we weren't supposed to use rt::* anymore
[06:27:21] <dbaupp> keret: you can just use multiple different conditions
[06:27:31] <dbaupp> joelteon: std::rt is the new one (?)
[06:27:35] <joelteon> oh
[06:27:37] <joelteon> ok
[06:27:55] <bjz> dbaupp: so we shouldn't use std::comm?
[06:28:05] <dbaupp> bjz: dunno
[06:28:20] <dbaupp> bjz: just std::rt::comm is the only one that has Select-able Ports
[06:28:23] <dbaupp> (according to grep)
[06:29:26] <bjz> dbaupp: what do you mean by 'selectable'?
[06:30:46] <dbaupp> bjz: can have a vector of several ports, and effectively call .recv on all of them at the same time, so it returns as soon as the first port is ready to recv
[06:30:51] <dbaupp> rather than blocking on each
[06:31:26] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[06:31:45] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[06:31:52] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Quit: WeeChat 0.4.1)
[06:32:01] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[06:32:38] <Eridius> keret: the very last example on the tutorial demonstrates handling multiple conditions
[06:33:12] <joelteon> yeah, I'm still waiting on the tcpstream -> chan/port though :p
[06:33:22] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[06:33:57] <keret> dbaupp, Eridius: sorry, just read that part. Is there any other way to do it without nesting do blocks?
[06:34:01] <dbaupp> nope
[06:34:28] <dbaupp> (conditions are a relatively new feature, so their exact syntax may change/improve.)
[06:34:51] <dbaupp> at least, they were fixed to work cross-crate recently (i.e. fixed to be actually useable)
[06:34:57] <bjz> dbaupp: neat :)
[06:35:17] <keret> oh, can support from the type system/ compiler fix it so that we can do something like match on the condition type?
[06:35:28] <Eridius> keret: you need to provide a unique handler closure for each condition anyway
[06:35:30] <dbaupp> that seems unlikely
[06:35:40] <Eridius> IMO the example in the tutorial should only use 1 condition anyway
[06:35:50] <Eridius> although as it's intended to be an example of multiple conditions, I'm not complaining
[06:36:03] <dbaupp> there's examples of both
[06:36:29] <Eridius> well the one that has 1 condition also has explicit failure
[06:36:56] <dbaupp> there's several that have 1 condition?
[06:37:05] <dbaupp> e.g. http://static.rust-lang.org/doc/tutorial-conditions.html#further-refining-a-condition ?
[06:37:33] <dbaupp> (and the section before it too)
[06:38:52] <Eridius> dbaupp: yes
[06:39:01] <Eridius> malformed ints still trigger failure there
[06:40:00] <dbaupp> oh, I see
[06:40:17] <keret> how is c++ able to distinguish different exception types at runtime? rtti?
[06:43:18] *** Quits: tautologico (lymph@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico)
[06:44:01] <jeaye> What's a u32::from_str for a single char?
[06:44:35] <jeaye> rusti: u32::from_str("42")
[06:44:36] -rusti- pastebinned 11 lines of output: http://ix.io/7kA
[06:44:52] <jeaye> rusti: std::u32::from_str("42")
[06:44:52] -rusti- Some(42)
[06:45:01] <jeaye> rusti: std::u32::from_str('4')
[06:45:02] -rusti- <anon>:5:28: 5:31 error: mismatched types: expected `&str` but found `char` (expected &str but found char)
[06:45:02] -rusti- <anon>:5          std::u32::from_str('4')
[06:45:02] -rusti-                                      ^~~
[06:45:02] -rusti- error: aborting due to previous error
[06:45:02] -rusti- application terminated with error code 101
[06:45:24] *** Quits: tikue (tkuehn@moz-F4812C6E.hsd1.fl.comcast.net) (Quit: tikue)
[06:45:25] <dbaupp> rusti: ('4' as uint - '0' as uint)
[06:45:25] -rusti- 4
[06:46:02] <jeaye> That'll do, ASCII. Thanks. :)
[06:46:14] * jeaye was just wondering if there was a function for it.
[06:46:19] <dbaupp> rusti: ('4' - '0') as uint
[06:46:20] -rusti- 4
[06:46:34] <dbaupp> if you're feeling like abusing some bugs :P
[06:46:43] <dbaupp> jeaye: yeah, I don't think so.
[06:47:01] <jeaye> mmk
[06:47:50] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[06:50:04] <bjz> jeaye: what should the type alias of HGLRC be?
[06:50:23] <bjz> jeaye: can't find the corresponding typedef via google
[06:50:39] <jeaye> That looks like a Windows thing. Right?
[06:50:42] <bjz> yah
[06:51:05] <jeaye> I only use Linux. :|
[06:51:25] * jeaye checks msdn
[06:51:40] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[06:51:50] <bjz> jeaye: you're meant to be a graphics dude!
[06:52:05] <bjz> jeaye: guess it's not really graphis all that much
[06:52:11] <jeaye> Sure, OpenGL. Not Windows. ^_^
[06:52:16] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Ping timeout)
[06:52:21] <bjz> just translating the wgl types
[06:53:10] <keret> any good references for implementation of exception handling in c++ compilers??
[06:53:46] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[06:54:14] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[06:54:16] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[06:55:33] *** Joins: Ms2ger (Ms2ger@59A8FC80.80FA5708.187A1082.IP)
[06:56:01] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[06:56:02] <jeaye> bjz: Looks to me like a pointer type; you should be able to get away with *c_void
[06:56:08] <olsonjeffery> \o/
[06:56:16] <bjz> ook, thanks!
[06:56:16] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:56:16] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e9c8402 to 14253337d: 02http://git.io/N3iJvQ
[06:56:16] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:56:17] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[06:56:17] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/-f6eXg
[06:56:17] <ghrust> 13rust/06auto 14cf4694e 15Tim Chevalier: std: Change ProcessOptions struct to have an option of a ~ vector...
[06:56:17] <ghrust> 13rust/06auto 145be4408 15Tim Chevalier: testsuite: Add xfailed test for #8498
[06:56:17] <ghrust> 13rust/06auto 1492af0db 15bors: auto merge of #8518 : catamorphism/rust/issue-8498-workaround, r=brson...
[06:56:19] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[06:57:02] <dbaupp> keret: http://stackoverflow.com/questions/490773/how-is-the-c-exception-handling-runtime-implemented (just found through google, no idea of the veracity)
[06:57:15] <bjz> olsonjeffery?
[06:59:52] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Quit: dim-an)
[07:03:21] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[07:04:49] <keret> dbaupp: thanks! i found this http://llvm.org/docs/ExceptionHandling.html. Thought it would be  useful as rust uses llvm as the backend, but the documentation does not thoroughly explain the implementation
[07:07:14] <Ralith> keret: note that those docs are primarily concerned with the semantics of LLVM's interface; the fine details are likely left up to the target code generator.
[07:07:40] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[07:08:12] <keret> Raith: is there any reference implementation that documents it?
[07:08:18] <klutzy> keret: rust uses g++'s exception system. you can find "__gxx_personality_v0" method at https://github.com/mozilla/rust/blob/master/src/rt/rust_upcall.cpp#L58
[07:08:32] <klutzy> (the function is also declared in llvm doc you've linked)
[07:09:01] <keret> klutzy: thanks! will look into it
[07:09:27] <klutzy> keret: you may want to find g++'s implementations. it's called dwarf2 exception handler http://gcc.gnu.org/wiki/Dwarf2EHNewbiesHowto
[07:10:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:10:35] <klutzy> keret: actually mingw family may use other exception system rather than dwarf2, but they share same _gxx_personality_### function signature (same args and return value)
[07:10:48] <keret> klutzy: looks pretty detailed, thanks!
[07:11:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[07:18:35] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[07:22:48] *** flaper87|afk is now known as flaper87
[07:23:53] *** Joins: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr)
[07:37:43] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[07:38:43] *** Quits: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[07:39:03] *** Joins: mibitzi_ (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[07:39:47] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:42:12] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[07:45:44] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[07:51:56] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[07:55:44] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[07:59:26] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:00:17] *** Joins: dim-an (ermolovd@moz-74FA7782.yandex.net)
[08:01:04] *** Parts: dim-an (ermolovd@moz-74FA7782.yandex.net) ()
[08:03:47] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:05:03] <myname> did i understand this right: [] in enums HAVE to be ~[] because rust needs to know how big the entry will be?
[08:05:16] <myname> (or @[])
[08:05:28] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[08:06:35] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[08:06:35] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[08:06:38] <joelteon> Can you define a top-level function using a type synonym?
[08:06:40] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:06:49] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[08:07:00] <dbaupp> joelteon: e.g. type Foo = int; fn bar(x: Foo) { ... }?
[08:07:02] <dbaupp> yes
[08:07:15] <dbaupp> myname: no
[08:07:24] <myname> oh?
[08:07:27] <joelteon> type Foo = extern fn(int) -> bool; Foo bar { ... } ???
[08:07:50] <dbaupp> myname: enum Foo<'self> { Bar(&'self [int]), Baz([int, .. 10]) } works
[08:08:15] <dbaupp> (note that neither of these are dynamically sized, the first is 2 words, the second is 10.)
[08:08:29] <dbaupp> joelteon: oh, I see. I guess not
[08:08:43] <myname> okay, but if there is only a maximum size of the array, it won't work?
[08:09:07] <myname> i could still fill it with (), but i don't think i want that
[08:09:11] <dbaupp> you can't the actual data in an enum/struct if it's dynamically sized yes.
[08:09:34] <myname> okay
[08:09:37] <dbaupp> (i.e. it has to be stored byhind a pointer, i.e. &, ~ or @)
[08:10:05] <klutzy> rusti: type Foo = &fn(int) -> int; let func: Foo = |x| {x + 1}; func(1)
[08:10:06] -rusti- <anon>:5:20: 5:35 error: Illegal anonymous lifetime: anonymous lifetimes are not permitted here
[08:10:06] -rusti- <anon>:5          type Foo = &fn(int) -> int; let func: Foo = |x| {x + 1}; func(1)
[08:10:06] -rusti-                              ^~~~~~~~~~~~~~~
[08:10:06] -rusti- error: aborting due to previous error
[08:10:07] -rusti- application terminated with error code 101
[08:10:16] <klutzy> rusti: type Foo = ~fn(int) -> int; let func: Foo = |x| {x + 1}; func(1)
[08:10:16] -rusti- 2
[08:10:20] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:10:23] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:12:03] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:13:12] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:14:20] <myname> btw, i find ", ..x" very confusing syntax to note the exact size of an array
[08:15:36] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[08:16:56] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:20:19] <Luqman> rusti: type Func<'self> = &'self fn(int) -> int; let addone: Func = |x| x + 1; addone(32)
[08:20:19] -rusti- 33
[08:20:39] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:23:34] <myname> does rust have optional parameters or do you have to send an Option?
[08:24:48] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:25:50] <dbaupp> myname: not yet, so yes, an option or a struct with a FRU (functional record update)
[08:25:50] <Ms2ger> I think that's planned
[08:25:52] <dbaupp> https://github.com/mozilla/rust/issues/6973
[08:26:42] <dbaupp> the FRU would be like struct FooOpts { x: int, y: int, z: int } static DEFAULT_FOO_OPTS = FooOpts { ... } do_foo(FooOpts { x: 1, .. DEFAULT_FOO_OPTS})
[08:26:58] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Ping timeout)
[08:27:10] <dbaupp> (which is very very ugly, but probably nicer than a million arguments.)
[08:28:32] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:28:51] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:30:43] *** Joins: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au)
[08:32:19] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:36:03] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Ping timeout)
[08:39:50] *** Joins: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net)
[08:43:30] *** Quits: KindOne (KindOne@moz-E919F46.dynamic.ip.windstream.net) (Connection reset by peer)
[08:44:48] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[08:45:07] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[08:47:12] *** Joins: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de)
[08:49:08] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[08:50:25] *** Quits: Ms2ger (Ms2ger@59A8FC80.80FA5708.187A1082.IP) (Ping timeout)
[08:51:17] *** Joins: Ms2ger (Ms2ger@moz-9988104E.ugent.be)
[08:51:31] *** Joins: KindOne (KindOne@moz-D0134E12.dynamic.ip.windstream.net)
[08:52:32] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[08:53:33] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[08:53:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/-f6eXg
[08:53:33] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[08:56:18] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[08:56:18] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Kk0waA
[08:56:18] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[08:56:19] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[08:56:19] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/O85Nkw
[08:56:19] <ghrust> 13rust/06auto 14a5f9494 15blake2-ppc: std: Change either::{lefts, rights} to return an iterator
[08:56:19] <ghrust> 13rust/06auto 146fe4c87 15blake2-ppc: Update either::partition...
[08:56:19] <ghrust> 13rust/06auto 1488c1491 15blake2-ppc: std: Replace map_vec, map_vec2, iter_vec2 in std::result...
[08:56:21] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[09:03:01] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:04:05] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:06:41] <myname> rusti: 1==1?2:3
[09:06:41] -rusti- <anon>:5:13: 5:14 error: unknown start of token: 63
[09:06:41] -rusti- <anon>:5          1==1?2:3
[09:06:41] -rusti-                       ^
[09:06:41] -rusti- application terminated with error code 101
[09:06:50] <myname> okay, so no ternary operator
[09:08:23] <dbaupp> rusti: if 1 == 1 {2} else {3}
[09:08:24] -rusti- 2
[09:09:01] <myname> i know that
[09:09:34] *** Quits: Klaufir_ (admin@94E7A28F.E28D9BD4.349F3CD5.IP) (Quit: leaving)
[09:10:43] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:12:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:17:41] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[09:17:46] <Ms2ger> dbaupp, rather more verbose :)
[09:18:33] *** Quits: KindOne (KindOne@moz-D0134E12.dynamic.ip.windstream.net) (Ping timeout)
[09:18:50] <myname> i made it the dirty way :D i.e. les res = [2,3]; res[1-1]
[09:19:31] <myname> (checked var is always either 1 or 2)
[09:19:58] <klutzy> i used the array way in python until it has a = 2 if 1 else 3 syntax
[09:20:33] <myname> i don't like that either
[09:20:39] <myname> but i don't like python
[09:22:25] *** Joins: KindOne (KindOne@moz-A5D765F3.dynamic.ip.windstream.net)
[09:22:34] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Input/output error)
[09:36:47] <nmatsakis> toddaaro: pong
[09:38:02] <bjz> nmatsakis: cool stuff with the extern fn thingy
[09:39:32] <nmatsakis> bjz: so close. damn ARM.
[09:39:44] <bjz> ha!
[09:40:03] <nmatsakis> I thought I was good to go with a clean try run
[09:40:56] <bjz> so do I need to change anything with: static mut glFn: extern "C" fn(blah: GLint) = glFn_fail;?
[09:41:43] <bjz> or: struct GL { Fn: extern "C" fn(blah: GLint) }
[09:42:01] <nmatsakis> those look fine
[09:42:05] <bjz> cool
[09:42:09] <nmatsakis> I have no idea what this ARM problem is or how to reproduce it
[09:42:17] * nmatsakis sighs
[09:42:32] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[09:43:00] <bjz> nmatsakis: could the samsung fellow help?
[09:43:20] <bjz> (can't remember how to spell his name -_-)
[09:43:31] <klutzy> sanxiyn?
[09:43:35] <bjz> yes!
[09:45:03] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[09:46:14] <nmatsakis> I imagine he might be able to
[09:46:20] <nmatsakis> he's just not online now
[09:46:28] <nmatsakis> there are no doubt other Samsung people too :)
[09:46:38] <nmatsakis> but I'm not working closely enough on servo right now to know their nicks
[09:46:49] <nmatsakis> open message to anybody who can reproduce arm failures: help!
[09:46:56] <klutzy> yichoi is also at samsung
[09:48:46] <Ms2ger> mjrosenb|ARM? :)
[09:49:46] <doomlord> https://github.com/mozilla/rust/issues/7929 << mentions arenas, how would that go in rust. i'd wondered if further down the line HKTs would give you ways of adding more semantics to pointers
[09:49:47] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:52:53] <Luqman> nmatsakis: i can try building it
[09:54:19] <orshem> isn't extern fn "c" going to be the default?
[09:55:34] <nmatsakis> Luqman: that'd be helpful, thanks.
[09:55:45] <maik> btw why is samsung even working on servo? 
[09:58:09] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[09:58:30] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[09:58:31] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[10:01:08] <nmatsakis> doomlord: I expect HKTs would be helpful, yes. as far as arenas, There is a type in the standard library one can use. 
[10:05:44] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Ping timeout)
[10:07:23] *** Quits: RMF (RMF@C1DE1C64.ACFAD170.823A4631.IP) (Quit: Textual IRC Client: www.textualapp.com)
[10:09:41] *** Quits: keret (Mibbit@FBE8D0AC.DA97A9A4.520CDC98.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:11:02] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:12:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[10:14:58] <myname> we do have key-value-stores, don't we?
[10:21:31] <Luqman> nmatsakis: so i can reproduce the failure
[10:21:39] <Luqman> here's what gdb says https://gist.github.com/luqmana/6248769
[10:21:41] <nmatsakis> Luqman: can you at least tell me what test case it is? :)
[10:22:01] <Luqman> it's on trying to build libstd
[10:22:49] <nmatsakis> Luqman: oh. huh. can you run with RUST_LOG=rustc::middle::trans::foreign and gist the output?
[10:23:11] <Luqman> sure
[10:24:43] <Luqman> nmatsakis: https://gist.github.com/luqmana/6248789
[10:25:11] *** Joins: huddler (Mibbit@FBE8D0AC.DA97A9A4.520CDC98.IP)
[10:25:18] <Luqman> nmatsakis: er, sorry. wrong one
[10:25:44] <nmatsakis> ok
[10:25:46] <Luqman> https://gist.github.com/luqmana/6248800
[10:25:47] <nmatsakis> I was just going to say
[10:26:45] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[10:27:21] <nmatsakis> that's really weird
[10:27:35] <nmatsakis> I wonder if on ARM for some reason *{} is not accepted?
[10:28:01] <nmatsakis> equally curious, I wonder what we do now? and how my branch changed it?
[10:28:33] *** Joins: RMF (RMF@C1DE1C64.ACFAD170.823A4631.IP)
[10:28:54] <nmatsakis> Luqman: do you have a clean, functioning build around? can you build with --emit-llvm -S and then grep for `rust_uv_last_error`? (let me know if you don't have time to do this right now :)
[10:29:36] <Luqman> an android build?
[10:30:24] <maik> I get the error"cannot move out of captured outer variable in a heap closure" https://gist.github.com/anonymous/6248827 How could I fix this again? I know there was a wiki entry but I can't find it anymore :(
[10:30:50] <nmatsakis> Luqman: yes, the same environment that's creating the error
[10:31:48] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[10:31:50] <Luqman> nmatsakis: as in not your branch?
[10:33:59] <nmatsakis> Luqman: right
[10:34:12] <nmatsakis> maik: one workaround is to use a Cell
[10:34:36] <nmatsakis> maik: move the value into the cell, move the cell into the closure, and you use cell.take() or whatever that method is called
[10:35:08] <maik> nmatsakis, okay thanks!
[10:36:47] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[10:37:22] <maik> nmatsakis, nice it works :)
[10:37:59] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[10:38:17] <ChrisMorgan> dbaupp: r? https://github.com/mozilla/rust/pull/8555
[10:41:36] *** Joins: robertknight (robertknig@moz-9B7A9377.range86-161.btcentralplus.com)
[10:47:17] <myname> TIL: i suck at reading rust documentation
[10:55:18] *** Joins: farnoy (farnoy@moz-73F1740D.neoplus.adsl.tpnet.pl)
[10:55:35] *** kimundi is now known as zz_kimundi
[10:56:02] <Luqman> nmatsakis: uh, the build also failed for me on master as well :|
[10:56:16] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:56:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/O85Nkw
[10:56:16] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[10:56:20] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[10:56:44] <nmatsakis> Luqman: !
[10:57:28] <Luqman> i think i'll try wiping the build dir and trying again
[10:59:16] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:59:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/6hGbeg
[10:59:16] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:59:17] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[10:59:17] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/sHRygg
[10:59:17] <ghrust> 13rust/06auto 14494da5a 15Brian Anderson: rustc: Change ICE message to reflect that ::rt::backtrace doesn't exist
[10:59:17] <ghrust> 13rust/06auto 148caf517 15bors: auto merge of #8530 : brson/rust/rt-backtrace, r=alexcrichton...
[10:59:18] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:03:25] <farnoy> Hi, can raw pointers obtained from C libs be somehow moved+registered in a managed box?
[11:03:36] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[11:07:31] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[11:11:23] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[11:13:03] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[11:14:49] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[11:15:15] *** Quits: robertknight (robertknig@moz-9B7A9377.range86-161.btcentralplus.com) (Ping timeout)
[11:17:36] *** Quits: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de) (Ping timeout)
[11:18:09] <doomlord> i doubt they could because rust would expect to be able to free them
[11:18:28] <myname> rusti: 9.sqrt()
[11:18:29] -rusti- <anon>:5:9: 6:5 error: type `<VI0>` does not implement any method in scope named `sqrt`
[11:18:29] -rusti- <anon>:5          9.sqrt()
[11:18:29] -rusti- <anon>:6     };
[11:18:29] -rusti- error: aborting due to previous error
[11:18:29] -rusti- application terminated with error code 101
[11:18:37] <doomlord> unless thee was a way to bind that aswell..
[11:18:39] <myname> what
[11:26:48] *** Joins: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de)
[11:28:06] <doomlord> to make a trait default impl use struct members.. you have to make a trait of accessor functions, and make the trait decl inherit that?
[11:28:44] <myname> i kinda feel dumb for not being able to calculate a square root
[11:30:28] <k4nar> myname: well, I think the answer is 3 ;)
[11:30:47] <myname> k4nar: i know what the specific answer is
[11:30:55] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[11:31:32] <k4nar> I hope so, that was a jokeâ€¦
[11:32:45] <Ms2ger> rusti, std::num::sqrt(9.)
[11:33:00] <Ms2ger> Bah
[11:33:02] <Ms2ger> rusti: std::num::sqrt(9.)
[11:33:02] -rusti- 3
[11:33:33] <Ms2ger> rusti: 9f.sqrt()
[11:33:34] -rusti- 3
[11:34:50] *** Quits: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au) (Client exited)
[11:35:12] <klutzy> rusti: -9f.sqrt()
[11:35:12] -rusti- -3
[11:35:17] <klutzy> rusti: (-9f).sqrt()
[11:35:18] -rusti- NaN
[11:36:05] <Luqman> nmatsakis: https://gist.github.com/luqmana/66baedd6760b0063419d
[11:36:18] <Ms2ger> They don't automatically return complex numbers? :(
[11:36:54] <myname> rusti: 9.to_float().sqrt()
[11:36:58] -rusti- pastebinned 35 lines of output: http://ix.io/7kK
[11:37:05] <myname> the hell?
[11:37:22] <Ms2ger> Ha
[11:37:26] <myname> "it could be either of this 10 identical calls"
[11:37:38] <Ms2ger> rusti: 9u32.to_float().sqrt()
[11:37:39] -rusti- 3
[11:38:16] <klutzy> since 9 can be 9i, 9u, 9u16 or anything depending on context
[11:38:44] <klutzy> anyway err message is quite funny :)
[11:40:36] *** Joins: farn (farnoy@moz-77B16330.neoplus.adsl.tpnet.pl)
[11:41:17] *** Quits: farnoy (farnoy@moz-73F1740D.neoplus.adsl.tpnet.pl) (Ping timeout)
[11:41:22] <myname> s/funny/irritating/
[11:41:29] <Luqman> nmatsakis: https://dl.dropboxusercontent.com/u/2743265/std.ll since doesn't seem to want to display the whole file
[11:41:34] *** Quits: farn (farnoy@moz-77B16330.neoplus.adsl.tpnet.pl) (Quit: Leaving)
[11:43:51] <klutzy> myname: looks like known bug https://github.com/mozilla/rust/issues/1946
[11:49:46] <myname> the tutorial could use some text about for loops
[11:52:55] <Seldaek> myname: thankfully it's opensource so anyone can fix it ;) what are you wondering though?
[11:53:17] *** Quits: Ms2ger (Ms2ger@moz-9988104E.ugent.be) (Connection reset by peer)
[11:53:19] *** Joins: Ms2ger` (Ms2ger@59A8FC80.80FA5708.187A1082.IP)
[11:54:02] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Ping timeout)
[11:54:34] <myname> 0.7 here with: <anon>:2:7: 2:9 error: expected `{` but found `in`
[11:54:40] <myname> for i in range(0,3)
[11:55:02] <Seldaek> myname: oh that is 0.8-dev syntax
[11:55:27] <Seldaek> myname: in 0.7 IIRC you have to do: for range(0,3).advance |i| { ... }
[11:55:45] <myname> <anon>:30:4: 30:9 error: unresolved name `range`. Did you mean `a`?
[11:56:08] <Seldaek> hehe, yeah that's another issue, no clue where it used to be, but you should find that in the 0.7 docs
[11:56:15] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:56:32] <Seldaek> myname: the other option is to compile 0.8-dev from github
[11:56:51] <myname> well, i'm using 0.7 because i don't have to compile it
[11:57:16] <Seldaek> I can understand that, but it's easier to get help because most people here track master fairly closely
[11:57:48] <Seldaek> I guess someone else can answer you, but my brain is quick at forgetting 0.7 stuff it seems.
[11:58:05] <myname> yeah, last time i wanted to build 0.5 and it failed like 5 to 6 times in a row
[11:58:08] <myname> on an atom
[11:58:10] <myname> no fun
[11:58:28] <Luqman> myname: what os are you running?
[11:58:36] <myname> arch linux
[11:58:53] <Luqman> in that case, strcat maintains nightly builds
[12:00:00] <myname> okay, that's new to me, i did now that it is in the community repository which is quite comfortable
[12:00:26] <dbaupp> myname: `for std::uint::range(0, 10) |i| { ... }`
[12:00:45] <dbaupp> (all the integer types have a range method in their associated module.)
[12:00:55] <myname> ew
[12:00:57] <dbaupp> ChrisMorgan: looks good
[12:01:13] <dbaupp> myname: that's why you upgrade to the shiny new nightly ;P
[12:09:59] *** Joins: Florob (Florob@moz-39532932.de)
[12:10:55] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[12:11:15] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[12:11:42] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[12:13:23] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[12:13:49] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[12:21:29] <joelteon> i'm using the nightly and i am very happy
[12:22:55] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:25:15] <maik> does someone know why future.get need Clone? http://seld.be/rustdoc/master/extra/future/struct.Future.html
[12:26:19] <maik> shouldn't it move?
[12:27:05] <dbaupp> that's what unwrap does
[12:27:34] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[12:27:37] <dbaupp> (get should be removed, now that option etc don't have a similar function)
[12:32:46] <bjz> maik: hoya
[12:32:55] <bjz> maik: you pinged me.... last night?
[12:36:26] <maik> bjz, oh it just was for https://github.com/mozilla/rust/pull/8535 but I think you already know that :)
[12:43:06] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[12:43:17] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[12:45:25] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[12:45:50] *** Quits: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de) (Ping timeout)
[12:46:24] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[12:52:09] <dbaupp> does anyone know how visibility is stored on a struct field?
[12:52:38] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:53:24] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[12:53:40] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[12:54:19] <dbaupp> (doesn't matter found it.)
[12:54:34] <huddler> dbaupp: could you please share it?
[12:55:05] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[12:56:37] <dbaupp> huddler: the named_field variant of struct_field_kind in syntax::ast
[12:56:57] <huddler> thanks!
[12:56:58] * dbaupp was looking at it but didn't see the `visibility` field.
[12:57:46] *** Quits: cade (cade@66A6305B.C2D6DAC0.9510F13D.IP) (Quit: Bye!)
[12:58:33] *** Joins: cade (cade@66A6305B.C2D6DAC0.9510F13D.IP)
[12:59:14] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[12:59:14] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/sHRygg
[12:59:14] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:02:15] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:02:15] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ZHtYqw
[13:02:15] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:02:17] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:02:17] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/eqorfw
[13:02:17] <ghrust> 13rust/06auto 141e4f13f 15Kevin Ballard: Clarify docs on CString.unwrap()...
[13:02:17] <ghrust> 13rust/06auto 1448265b7 15Kevin Ballard: Check for interior nulls in .to_c_str()...
[13:02:18] <ghrust> 13rust/06auto 1403ef71e 15Kevin Ballard: Add ToCStr method .with_c_str()...
[13:02:18] *** Quits: huddler (Mibbit@FBE8D0AC.DA97A9A4.520CDC98.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:02:20] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:03:04] *** Joins: mib_ybhseh (Mibbit@moz-FEE5F6F8.home.otenet.gr)
[13:04:25] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[13:04:34] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Connection reset by peer)
[13:04:35] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[13:04:37] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[13:09:39] <nmatsakis> Luqman: does this mean it works on master?
[13:12:02] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[13:13:42] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[13:19:41] *** Quits: ipc (ipc@moz-76ED5036.lightspeed.cicril.sbcglobal.net) (Quit: ipc)
[13:20:27] *** Joins: ipc (ipc@moz-76ED5036.lightspeed.cicril.sbcglobal.net)
[13:20:49] *** Quits: ipc (ipc@moz-76ED5036.lightspeed.cicril.sbcglobal.net) (Quit: ipc)
[13:22:49] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[13:23:35] *** Quits: mib_ybhseh (Mibbit@moz-FEE5F6F8.home.otenet.gr) (Quit: http://www.mibbit.com ajax IRC Client)
[13:30:15] *** Quits: RMF (RMF@C1DE1C64.ACFAD170.823A4631.IP) (Ping timeout)
[13:31:22] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[13:42:45] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[13:43:09] <SimonSapin> Does ~str automatically get trait implementations "for &str"?
[13:44:29] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[13:45:18] <dbaupp> SimonSapin: sort of; if you have a trait impl'd for `&str` then you can call those methods on ~ and @str (they get auto-sliced), but ~/@str don't satisfy that trait unless they have their own impl
[13:45:48] <SimonSapin> dbaupp: ok, thatâ€™s what I meant
[13:46:08] <dbaupp> rusti: trait Foo { fn foo(&self); } impl<'self> Foo for &'self str {fn foo(&self){println("&str");}} (~"foo").foo()
[13:46:08] -rusti- &str
[13:46:08] -rusti- ()
[13:46:31] <dbaupp> rusti: trait Foo { fn foo(&self); } impl<'self> Foo for &'self str {fn foo(&self){println("&str");}} fn takes_foo<F: Foo>(_:F) {} takes_foo(~"foo")
[13:46:37] -rusti- line longer than 150 columns, pastebinned 4 lines of output: http://ix.io/7kM
[13:52:06] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:53:22] *** Joins: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de)
[13:54:32] <maik> someone here with experience in FRP?
[13:56:21] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[13:57:03] <sigma> maik: /r/haskell or #haskell will have a lot more people I think
[13:57:58] <nmatsakis> Luqman: ping
[13:58:10] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Ping timeout)
[13:58:25] *** Joins: tedh (tedh@moz-D8911C58.public.wayport.net)
[13:59:29] <dbaupp> maik: or the frp tag on stackoverflow
[14:09:22] *** Joins: tautologico (lymph@8ABDEDA.34CAB63A.7B974E06.IP)
[14:12:16] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[14:12:22] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:14:02] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:16:44] *** Joins: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl)
[14:18:47] *** Joins: jensnockert (jensnocker@moz-74833314.wireless.lu.se)
[14:20:26] *** Joins: jensnock_ (jensnocker@moz-EF95FD94.astro.lu.se)
[14:21:17] *** Quits: jensnockert (jensnocker@moz-74833314.wireless.lu.se) (Ping timeout)
[14:22:51] <maik> I was just wondering if it makes sense to use tasks for FRP
[14:23:38] <maik> x -> [TASK1] ->[TASK2] -> y
[14:24:14] *** Quits: jaen (jaen@moz-A47B09E3.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:34:41] <bjz> maik: I could ask at our next FP meetup, there are a few folks there who do FRP, but yeah - no idea
[14:35:00] <bjz> (turn around time being a couple of weeks :P)
[14:36:31] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:37:22] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[14:37:42] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[14:39:57] <maik> bjz, I started today writing something and I think I already got a working prototype, not sure if it makes sense :D
[14:40:14] *** zz_kimundi is now known as kimundi
[14:40:18] <maik> i'll post it later 
[14:40:23] <maik> to get some feedback
[14:44:40] <maik> bjz, do you want to have a look :D? it's only around 40 lines 
[14:44:49] <bjz> sure
[14:45:07] <bjz> can't promise any intelligent feedback though :[
[14:45:12] *** Joins: ofeldt- (ofeldt@moz-7358A996.dip0.t-ipconnect.de)
[14:45:59] <maik> https://gist.github.com/anonymous/6250545
[14:46:03] *** Quits: ofeldt (ofeldt@moz-881FBB49.dip0.t-ipconnect.de) (Ping timeout)
[14:46:06] <maik> just look at the main function
[14:46:23] <maik> you can make some connections for example
[14:46:46] <dbaupp> maik: `do Pipe::new |p| { ... }` would look nicer
[14:47:11] <maik> you send an 10int then you multiply it by 2 then you multiply it by 3 as float then you turn it to a str and then you get the result
[14:47:28] <maik> dbaupp, ah right completely forgot about the do
[14:47:56] <dbaupp> other that, looks pretty cool.
[14:49:25] *** Quits: jensnock_ (jensnocker@moz-EF95FD94.astro.lu.se) (Input/output error)
[14:52:38] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:52:47] *** Quits: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr) (Ping timeout)
[14:53:11] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:53:27] <maik> is there a way to safely close all tasks?
[14:54:30] <maik> because my recv  always tries to listen on a closed channel and then fails like "task <unnamed> failed at 'receiving on closed channel', /home/maik/source/rust/src/libstd/rt/comm.rs:496" it is a bit annoying
[14:54:52] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[14:56:26] *** Joins: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr)
[14:56:39] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Connection reset by peer)
[14:56:42] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:58:22] <nielsle> Is there a fancy way to flatten an iterator on the form Iterator<Option<iterator<T>>>  I want to transform it to an iterator  (well actually to a vector)  
[14:59:16] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:59:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/eqorfw
[14:59:16] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:59:18] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[14:59:27] <Ms2ger`> filter_map?
[14:59:33] <Ms2ger`> I guess that's not all that fancy
[14:59:51] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:00:04] <nielsle> Thanks
[15:02:16] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:02:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oUp3vw
[15:02:16] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:02:23] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[15:02:30] <SimonSapin> rusti: "\t\n\x0c\r ".trim()
[15:02:31] -rusti- ""
[15:03:12] <SimonSapin> rusti: "\t\n\x0c\r utf-8\t\nx0C\r ".trim()
[15:03:13] -rusti- "utf-8\t\nx0C"
[15:03:34] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[15:03:37] <kimundi>  rusti: "\t\n\x0c\r utf-8\t\n\x0C\r ".trim()
[15:03:40] <kimundi> rusti: "\t\n\x0c\r utf-8\t\n\x0C\r ".trim()
[15:03:41] -rusti- "utf-8"
[15:05:13] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[15:05:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oUp3vw
[15:05:13] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[15:07:48] <nielsle> is there also a way to transform  Iterator<Iterator<T>> into Iterator<T> ? 
[15:11:31] <kimundi> It's possible, but I'm not sure if there exist an iterator adapter for that yet
[15:11:40] <Diamond> Use of a possibly uninitialized var not allowed in an unsafe block? :O
[15:11:53] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[15:12:28] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[15:12:45] <nielsle> Thanks.
[15:15:04] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[15:16:15] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[15:21:02] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Ping timeout)
[15:21:58] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[15:23:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:24:17] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[15:26:42] <kimundi> Diamond: Unsafe blocks allow a few things that would not be safe in general, but It won't allow you to do things that are doable in a safe way
[15:26:48] <erickt> sigh. someday https://github.com/mozilla/rust/pull/8441 will land. If only people would stop working!
[15:28:28] <Diamond> kimundi: Okay, thanks!
[15:28:29] <kimundi> Diamond: Or rather, there exists a unsafe function you can use to tell rustc you've initialize a variable, but that is actualy a nop
[15:28:47] <Diamond> kimundi: Oh?
[15:28:57] <kimundi> something like  let x = unsafe { init() } or let x = unsafe { uninit() }, dunno
[15:29:09] <kimundi> it's somewhere in the std lib
[15:29:16] <Diamond> I'll search for it
[15:29:19] <Diamond> thanks!
[15:29:42] <nmatsakis> (you have to be very careful with that particular fn)
[15:29:58] <nmatsakis> (it seems to be misused more often than not)
[15:30:17] <Diamond> the particular structure in question is used in a ffi
[15:30:29] <nmatsakis> in particular, it generates, well, uninitialized memory, and various parts of the compiler assume that values like @T etc are initialized when passed around and so forth
[15:30:29] <kimundi> Right. best if you don't need to use it. In what context do you need an unitiialzed variable?
[15:30:36] <nmatsakis> but a POD struct or something should be fine
[15:30:39] <Diamond> the ff initializes the struct
[15:30:49] <kimundi> okay
[15:30:57] <nmatsakis> Diamond: yes it's prob ok in this scenario
[15:31:08] <Diamond> kimundi: None really, it's mostly a non-issue.
[15:31:19] <nmatsakis> I just remember I had a lot of crashes to sift through from overuse of various unsafe primitives in the vec library
[15:37:18] *** Joins: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr)
[15:38:41] *** Quits: maik (maik___@moz-CB2146E0.dip0.t-ipconnect.de) (Ping timeout)
[15:39:35] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:39:35] *** ChanServ sets mode: +o dherman
[15:40:04] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[15:40:26] *** kimundi is now known as zz_kimundi
[15:42:13] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Quit: Leaving.)
[15:42:18] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[15:43:27] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[15:44:53] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[15:46:07] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:47:55] *** Quits: miloshadzic (miloshadzi@5E9C7FE4.FA4D0618.449B8A48.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[15:49:18] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[15:50:01] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:51:12] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[15:54:33] <jack> I am having a ton of trouble getting RUST_LOG to work. how does it resolve paths for extern crates?
[15:54:50] <olsonjeffery> is vec.slice_to inclusive or exclusive?
[15:55:01] <olsonjeffery> the end param, that is
[15:55:23] <jack> i'm trying to log something at gfx::platform::font_list, which is part of servo (gfx is one of the main crates)
[15:55:30] <jack> nothing i've tried works :(
[15:57:13] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:58:26] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[16:00:31] <engla> olsonjeffery: does not include the last index
[16:00:41] <engla> olsonjeffery: slice is  [a, b) just like range
[16:01:29] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:01:32] <olsonjeffery> engla: ty
[16:01:37] <engla> (slice_to(b) is just slice(0, b))
[16:03:30] <nmatsakis> jack: I think it should be crate::a::b
[16:03:36] <nmatsakis> jack: but are you bulding with --enable-debug?
[16:03:41] <nmatsakis> jack: also, try RUST_LOG=::help
[16:03:52] <nmatsakis> jack: I think that lists all the paths it is aware of
[16:04:06] <jack> nmatsakis: ah. didn't know about ::help!
[16:04:46] <jack> nmatsakis: i'm not building with enable-debug, but i had tried switching debug! to info! 
[16:04:54] <nmatsakis> ok
[16:04:59] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[16:05:01] <nmatsakis> I think --enable-debug should be the default unless you have -O
[16:05:04] <nmatsakis> personally
[16:05:22] <nmatsakis> but that's neither here nor there :)
[16:06:01] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[16:06:17] <jack> i think i agree with you.
[16:09:20] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[16:10:11] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[16:10:51] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[16:11:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:14:07] *** Joins: timm (timm@moz-65960C55.superkabel.de)
[16:14:20] *** Joins: miloshadzic (miloshadzi@5E9C7FE4.FA4D0618.449B8A48.IP)
[16:16:12] *** Joins: wilmoore_ (wilmoore@moz-A937BA8A.pools.spcsdns.net)
[16:16:16] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[16:19:53] *** Joins: wilmoore (wilmoore@moz-3D5361E8.pools.spcsdns.net)
[16:20:22] *** Quits: wilmoore_ (wilmoore@moz-A937BA8A.pools.spcsdns.net) (Ping timeout)
[16:21:56] *** Quits: wilmoore (wilmoore@moz-3D5361E8.pools.spcsdns.net) (Client exited)
[16:22:17] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:23:26] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[16:24:15] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[16:25:58] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[16:26:00] *** Quits: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr) (Ping timeout)
[16:26:58] *** Ms2ger` is now known as Ms2ger
[16:28:19] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[16:28:19] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Connection reset by peer)
[16:29:28] <doomlord_> anyone know off hand how to get a str from an ident and ctxt_
[16:30:37] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[16:32:00] <nmatsakis> jack: do you have access to ARM builds?
[16:32:21] <nmatsakis> jack: I'm trying to debug this failure that I get which seems to be limited to our arm builds
[16:32:29] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[16:32:51] <nmatsakis> well, android more specifically
[16:32:52] <nmatsakis> http://buildbot.rust-lang.org/builders/auto-linux-64-x-android/builds/128
[16:34:33] <jack> nmatsakis: unfortunately not :(
[16:34:45] <jack> brson: should be around soon i would think.
[16:34:52] <nmatsakis> yes
[16:35:12] <nmatsakis> that's ok, it's not officially a Rust day anyhow -- but that patch is SO close
[16:35:14] <nmatsakis> :)
[16:35:22] <nmatsakis> and it's only been ... months
[16:35:27] <jack> does str as_imm_buf return a null terminator or not now?
[16:36:25] *** Joins: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr)
[16:37:19] <nmatsakis> I think not
[16:37:27] <nmatsakis> I think you have to say as_c_str or something like that
[16:37:46] <jack> so strs in rust are no longer null terminated right?
[16:38:31] <Ms2ger> Yep
[16:39:00] <Ms2ger> And to_c_string(), fails if there's embedded nulls
[16:39:01] <jack> ok. some of the platform code deep in the heart of servo was very wrong then :)
[16:39:18] <Ms2ger> They used to be, I think
[16:40:07] <nmatsakis> it changed
[16:40:32] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[16:40:32] * Ms2ger should stick his nose into servo some time
[16:43:05] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[16:43:42] <jack> Ms2ger: you should :)
[16:44:02] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[16:44:07] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[16:44:14] <Ms2ger> Does it build with rust master?
[16:44:53] <jack> almost. i'm finishing that up right now.
[16:45:22] <Ms2ger> I'll see if the ubuntu ppa works, then :)
[16:45:39] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:46:14] <jack> thre's a PPA for servo?
[16:46:18] <jack> or for rust master?
[16:46:21] <Ms2ger> Rust
[16:46:26] <Ms2ger> https://launchpad.net/~hansjorg/+archive/rust
[16:46:48] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[16:46:48] *** ChanServ sets mode: +qo graydon graydon
[16:49:39] <olsonjeffery> the benefit of being in the middle of rolling file io is that i get to write to debug-by-printf to stdout, outside of task context!
[16:50:37] <Ms2ger> And looks like it can calculate square roots, at least
[16:50:47] <Ms2ger> Is there a hg server for servo?
[16:51:10] <SimonSapin> Ms2ger: git
[16:51:21] <SimonSapin> https://github.com/mozilla/servo/
[16:51:26] <Ms2ger> I know
[16:51:33] <Ms2ger> I asked if there was a hg one :)
[16:51:51] <SimonSapin> Iâ€™m not aware of a mirror
[16:52:16] <SimonSapin> the build system also depends on git submodules
[16:52:28] <Ms2ger> (If people can continually ask for a git mirror of Gecko... :))
[16:52:34] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[16:53:27] <SimonSapin> patches welcome? :)
[16:53:30] <Ms2ger> SimonSapin, I hear the build system is horrible
[16:54:00] <Ms2ger> Hrm
[16:54:09] <SimonSapin> it is at least hackish
[16:54:25] <Ms2ger> At least you're not rewriting it in JS
[16:54:27] *** Quits: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[16:54:34] *** Joins: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp)
[16:54:41] <SimonSapin> is gecko doing that?
[16:54:52] <Ms2ger> B2G
[16:55:03] <Ms2ger> Gecko prefers python :)
[16:55:14] <SimonSapin> I donâ€™t even
[16:56:03] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[16:56:23] <Ms2ger> The servo readme claims it builds its own rust... Is that required?
[16:56:56] *** Quits: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[16:57:09] *** Joins: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp)
[16:57:20] <SimonSapin> yes, unless you hack the build system
[16:57:28] * Ms2ger doesn't really want to do either
[16:57:59] <SimonSapin> just let it build its own rust. Machine time vs. your time
[16:59:29] <SimonSapin> but given that we use random non-released rust versions and that the language/stdlib always changes in imcompatible ways, itâ€™s probably better that way for now
[17:00:36] *** Joins: Vert (quassel@moz-15870EF5.skybroadband.com)
[17:01:36] *** Quits: StarLight (StarLight@moz-1887BE79.pppoe.avangarddsl.ru) (Ping timeout)
[17:02:06] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Connection reset by peer)
[17:02:19] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[17:02:21] *** Quits: rntz_ (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Input/output error)
[17:02:42] *** Quits: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[17:03:00] *** Joins: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp)
[17:06:01] *** Joins: StarLight (StarLight@moz-4314FDD5.dynamic.avangarddsl.ru)
[17:06:29] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[17:07:31] *** Quits: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[17:07:35] *** Joins: ysuzuki (ysuzuki@moz-FEE44B6.net220148245.t-com.ne.jp)
[17:09:32] <jack> can rustc not place library in a specific directory?
[17:09:43] <jack> it yells that it ignores -o, but it seems to not ignore -o.
[17:10:05] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[17:11:48] *** Joins: rntz_ (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[17:12:26] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:12:39] *** rntz_ is now known as rntz
[17:14:35] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Client exited)
[17:18:05] *** Parts: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr) ()
[17:20:10] <graydon> it ignores the exact name you ask for, puts lib<shortname>-<hash>-<vers>.so in the dirname of -o
[17:20:22] <graydon> jack: arguably the least intuitive behavior possible
[17:21:06] <jack> graydon: it does not anymore.
[17:21:13] <jack> that's precisely the problem.
[17:21:25] <graydon> does not .. do what?
[17:21:30] <graydon> use the dirname?
[17:21:32] <jack> it completely ignors -o now
[17:21:40] <graydon> did someone change it on account of it being a completely unintuitive behavior?
[17:21:43] <jack> you have to use --out-dir apparently
[17:21:51] <sfackler> sully changed it iirc
[17:21:53] <graydon> oh. that sounds like an improvement.
[17:22:08] <jack> sure. it just menas i have to edit 50 makefiles now :)
[17:22:12] <graydon> sorry :(
[17:22:50] <jack> perhaps better behavior would be to completely fail on -o instead of warning and putting binaries in the wrong place?
[17:22:52] <graydon> I had hoped part of the way we solved it would be to _actually_ respect -o 
[17:23:11] <graydon> if someone wants their output to be named libfrobble.so, so be it
[17:23:30] <graydon> but --out-dir fixes "the main use of -o"
[17:23:40] <graydon> yeah, it should probably fail
[17:24:31] <jack> is thre a $< type make shortcut for the first file of $<?
[17:25:08] <jack> it's perhaps time to switch to rustpkg.
[17:25:37] <SimonSapin> jack: I remember someone mentioning $D< or something similar
[17:26:08] <SimonSapin> but switch to rustpkg could be good, though I donâ€™t know at all its status
[17:26:46] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:26:46] *** ChanServ sets mode: +o pcwalton
[17:27:04] <graydon> we should think some about how to incrementally transition things to rustpkg. which order does it make most sense to do things in, etc.
[17:27:07] <Ms2ger> $@?
[17:27:36] <Ms2ger> Nope
[17:27:48] <jack> apparently $< is the first prereq. error was something else.
[17:27:52] <Ms2ger> Yeah
[17:28:31] <graydon> is rustpkg snapshotted presently? I think that'd have to be a first step.
[17:28:50] <jack> graydon: does it need to be snapshotted for servo to convert?
[17:29:04] <graydon> I also feel like maybe all future fun and games in terms of adjusting bootstrap sequences might be a lot easier if we get static linking working again first
[17:29:13] <jack> we have a lot of very simple crates. we should be able to switch at least those i would think
[17:29:17] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[17:29:32] <SimonSapin> how do we build rust with rustpkg? :)
[17:29:33] <graydon> jack: perhaps. I was thinking in terms of converting rustc / libstd / libextra and such
[17:29:59] <graydon> SimonSapin: carefully, but we should be able to eventually. just requires careful thought about bootstrap sequence, as the existing system has had to do
[17:31:08] <Ms2ger> A language with a sane packaging story
[17:31:17] <Ms2ger> Now that'd be interesting
[17:32:26] <pcwalton> nmatsakis: ping
[17:34:11] <nmatsakis> pcwalton: pong
[17:34:24] <pcwalton> nmatsakis: re your review comments
[17:34:31] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:34:39] <pcwalton> yes, the patch does not make most parts of the compiler distinguish between A::<T>::B and A::B::<T>
[17:34:56] <pcwalton> I plan to go through and insert checks to demand that the pieces be in the right place
[17:35:08] <pcwalton> I added most of them (for path exprs), probably types are the only ones that remain...
[17:35:28] <nmatsakis> pcwalton: ok, makes sense.
[17:35:30] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[17:36:02] <nmatsakis> I didn't see the checks for path expressions, but I was thinking that these kind of go through the same path; I guess however that that's not really true
[17:36:16] <pcwalton> also, a couple of things
[17:36:20] *** Joins: bytbox (s@moz-BA9A08F8.wireless.umd.edu)
[17:36:25] <pcwalton> (1) does your patch make extern fns no longer *u8?
[17:36:27] <pcwalton> your branch rather
[17:37:21] <bblum> ok, now that it's during everybody's business hours, can someone tell me how to turn a ast::Ty into a ty::t with a kind::Context? I don't seem to have the fcx or ccx needed to use ast_ty_to_ty.
[17:37:36] <pcwalton> you should never be doing that outside of astconv
[17:37:45] <pcwalton> well, that's not true
[17:37:52] <pcwalton> you should never be doing that outside of typeck
[17:38:03] <bblum> that is what i was afraid of, but
[17:38:23] <bblum> i am in visit_item, visiting an impl declaration, and i have a self_type that's an ast::Ty
[17:38:34] <bblum> the normal approach of calling, e.g., expr_ty on it of course does not work
[17:38:46] <pcwalton> impl_self_ty
[17:38:50] <pcwalton> or whatever it's called now
[17:38:59] <nmatsakis> pcwalton: it does not make that change
[17:39:02] <pcwalton> there's a function in ty that does that
[17:39:29] <pcwalton> nmatsakis: ok, that should be fairly easy afterward though?
[17:39:38] <pcwalton> after your branch lands
[17:39:40] <nmatsakis> pcwalton: yes
[17:39:47] <pcwalton> ok, I can do that next if you like
[17:39:52] *** Joins: tikue (tkuehn@moz-F4812C6E.hsd1.fl.comcast.net)
[17:40:08] <pcwalton> (2) killing @fn (and the others) was on my list too
[17:40:13] <pcwalton> so we'll see who gets to it first
[17:40:20] <pcwalton> @fn is first but it requires porting over all visitors
[17:41:10] <bblum> pcwalton: hmm, that appears to give me fresh type variables, and also takes a vcx
[17:41:30] <pcwalton> ah, I guess that's not what you want
[17:41:35] <pcwalton> there *is* a function in ty that does what you want
[17:41:37] <pcwalton> maybe trans uses it
[17:42:09] *** Joins: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com)
[17:42:13] *** Quits: bytbox (s@moz-BA9A08F8.wireless.umd.edu) (Ping timeout)
[17:43:49] <bblum> node_id_to_type?
[17:43:55] <pcwalton> that may work
[17:44:01] <bblum> looking in trans_method, that appears to be what is used there
[17:44:12] <bblum> let self_ty = ty::node_id_to_type(ccx.tcx, method.self_id);
[17:44:51] <bblum> (it then proceeds to do some substs
[17:44:52] <bblum> )
[17:45:36] *** Joins: bytbox (s@moz-BA9A08F8.wireless.umd.edu)
[17:47:04] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[17:48:02] <bblum> pcwalton: thank you
[17:48:12] <pcwalton> no problem
[17:50:16] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Ping timeout)
[17:50:26] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:54:07] *** Quits: Vert (quassel@moz-15870EF5.skybroadband.com) (Ping timeout)
[17:54:28] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[17:54:32] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:55:05] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:55:06] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[17:55:16] *** Joins: pwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com)
[17:55:24] *** pwalton is now known as pcwalton
[17:58:04] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[17:58:50] *** Quits: tikue (tkuehn@moz-F4812C6E.hsd1.fl.comcast.net) (Quit: tikue)
[17:59:36] *** Quits: bytbox (s@moz-BA9A08F8.wireless.umd.edu) (Ping timeout)
[18:00:38] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[18:02:34] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[18:02:47] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:03:24] <Eridius> I had to rebase #8203 again, if anyone wants to r+ it (again)
[18:06:51] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:08:23] <Ms2ger> Mm, lots of unused variables
[18:11:42] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:12:04] *** Quits: timm (timm@moz-65960C55.superkabel.de) (Input/output error)
[18:14:56] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[18:14:58] *** Quits: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[18:14:59] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[18:14:59] *** Quits: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca) (Ping timeout)
[18:17:01] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[18:17:06] *** Joins: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca)
[18:17:14] *** Joins: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[18:17:26] *** Joins: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca)
[18:19:10] *** Quits: fabiand (fabiand@moz-F4592424.adsl.alicedsl.de) (Quit: Verlassend)
[18:19:28] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:19:28] *** ChanServ sets mode: +o brson
[18:20:40] <nmatsakis> brson: 
[18:20:44] <nmatsakis> brson: ping :)
[18:21:04] <kmc> anyone know how to get rid of this dynamic freeze warning? http://pastebin.mozilla.org/2869457
[18:21:11] <kmc> it looks like the expression in question is the entirety of the block
[18:22:42] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:23:22] <pcwalton> btw, I'm not sure I agree with making things like unused imports into errors
[18:23:26] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:23:32] <pcwalton> it just makes bors bounce patches more often for no reason
[18:23:50] <Eridius> pcwalton: maybe do that after 1.0 when there's less churn?
[18:23:51] <pcwalton> I like the "every so often make a PR to remove unused imports"
[18:24:12] <pcwalton> bors bounces my patches upwards of 5 times usually before they stick
[18:24:31] <pcwalton> making style stuff into errors isn't helping code quality, it's just wasting time
[18:25:04] <brson> i'm sympathetic to this notion, but would like to know whether the style issues are a significant cause of bounces
[18:25:17] <brson> nmatsakis: pong
[18:26:03] *** Joins: Florob (Florob@moz-39532932.de)
[18:26:17] <nmatsakis> brson: so my PR passed try, but bors bounced it because of errors in the android build --
[18:26:23] <nmatsakis> any advice on tracking those down?
[18:26:33] <nmatsakis> Luqman was helping me for a while but he seems to have found better things to do :)
[18:26:39] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[18:27:24] <brson> nmatsakis: do you have an android build set up yet, and can you link it to me?
[18:28:00] <nmatsakis> I don't have any means to build android 
[18:28:11] <nmatsakis> I guess I'm not sure whta you're asking 
[18:28:16] <nmatsakis> link what to you?
[18:28:35] <nmatsakis> I guess what I'm asking is, can I ssh into the bot or something?
[18:28:42] <nmatsakis> or do you have a local setup?
[18:28:54] <nmatsakis> brson: ^
[18:29:22] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[18:30:15] <brson> nmatsakis: i meant a link to the failure log. android is pretty easy to set up with these instrs https://github.com/mozilla/rust/wiki/Doc-building-for-android
[18:30:30] <brson> nmatsakis: logging into the bots requires access to the ec2 cluster, which is possible but requires some effort
[18:30:47] <brson> i don't have an ndk installed here but can do it fairly quickly
[18:31:01] <nmatsakis> brson: ok, I can try to setup locally, though I probably won't get to that till later
[18:31:06] <nmatsakis> those directions are helpful
[18:31:23] <toddaaro> brson: did you work on the message dropping fork more? I'll start up on that now
[18:32:25] <brson> nmatsakis: actually logging into the ec2 android bot just requires going through one of the lab machines that you probably already have access to and then using another private key to get to the cluster. it's no that hard if you want me to send you instructions
[18:32:58] <brson> i'll look at the logs and see if there's anything obvious
[18:33:12] <brson> toddaaro: i think i'm done with that branch, idle-opt
[18:33:23] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:33:28] <brson> it lgtm when i stopped last night
[18:33:51] <toddaaro> brson: great!
[18:34:45] <nmatsakis> brson: seems easier to just setup locally I guess
[18:34:54] <nmatsakis> brson: the error seemed readily reproducible by Luqman 
[18:35:00] <Eridius> how often do the docs on the website get updated?
[18:35:51] <toddaaro> brson: I'll check it out now and add polish
[18:37:40] <brson> are there any rust/servo interns leaving this week?
[18:38:02] * bblum has one more week
[18:38:09] <toddaaro> here another week
[18:38:28] *** Quits: sully (sully@moz-45967CBE.emarhavil.com) (Ping timeout)
[18:38:32] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[18:38:33] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[18:39:05] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[18:39:19] <kmc> if I want to add methods to an existing type defined in another crate, I have to create a trait and a single impl of that trait, right?
[18:39:24] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[18:39:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:41:50] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:43:41] *** Joins: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[18:46:14] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[18:46:32] <Eridius> kmc: yes
[18:46:48] <Luqman> nmatsakis: sorry, I fell asleep
[18:47:55] <nmatsakis> Luqman: ;) I was grateful for the assistance you already gave
[18:48:02] <brson> here's my classification of the current bounces https://gist.github.com/brson/6252469
[18:48:06] <brson> none of them are lint failures
[18:48:32] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:48:34] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[18:48:49] <nmatsakis> Luqman: however, I have pushed a new patch to my branch with more debugging output, so if you feel up to it, you could try re-running my branch with RUST_LOG=rustc::middle::trans::foreign --
[18:49:01] <nmatsakis> Luqman: also, I was confused, didn't you say that master failed too? but then you produced a .ll file...
[18:49:29] <kmc> Eridius: that's unfortunate; it seems like the ideas of interface-polymorphism and extension methods should be orthogonal
[18:49:30] <Luqman> yea, wiping the build dir and trying again worked
[18:49:36] <kmc> not a huge deal though
[18:49:39] * kmc -> lunch
[18:49:56] <Ms2ger> SimonSapin, why newcss?
[18:52:04] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[18:52:08] *** mihneadb is now known as mihneadb|lunch
[18:52:19] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[18:52:21] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Quit: victorporof)
[18:52:44] <Ms2ger> SimonSapin, and is it normal that ./servo ../src/test/html/about-mozilla.html renders a black screen and segfaults on shutdown?
[18:53:59] <Ms2ger> Ah, now I get the book of Mozilla
[18:54:21] <Ms2ger> But it's gone if I unfocus
[18:54:58] <brson> Ms2ger: servo also renders black for me until i resize, and it also segfaults on shutdown
[18:55:42] <Ms2ger> *** glibc detected *** ./servo: double free or corruption (!prev): 0x0000000001f06420 ***
[18:55:50] <Ms2ger> I thought rust was written to avoid that? :)
[18:56:59] <cmr> Ms2ger: compiler bugs, faulty libraries, and incorrect unsafe code all conspire against you
[18:58:05] <cmr> Although I think most of the compiler bugs have been ironed out by nmatsakis and bblum
[18:58:39] <toddaaro> nmatsakis: are you around and able to look at an ICE in a bit?
[18:58:43] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[18:58:58] <toddaaro> nmatsakis: I modified the rtdebug! macro to be actually almost useful but it then ICEs
[18:59:08] *** Joins: bytbox (s@moz-BA9A08F8.wireless.umd.edu)
[19:00:09] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:00:33] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[19:02:29] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[19:02:39] <nmatsakis> toddaaro: ok
[19:02:45] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[19:02:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:03:14] <nmatsakis> cmr: s/most/some/
[19:03:23] <toddaaro> nmatsakis: great, I'll page that back in and give you a branch+error paste soonish
[19:03:37] <nmatsakis> Luqman: ok.
[19:04:09] <brson> cmr: here's a diff that makes your bench change work https://github.com/mozilla/rust/pull/8458
[19:04:09] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:04:32] <cmr> brson: you are awesome, thank you!
[19:04:44] <cmr> So when are the double $ needed, exactly?
[19:05:10] <Eridius> I think $$ delays interpretation until a later pass
[19:05:15] <Eridius> s/interpretation/evaluation/
[19:07:52] *** Joins: true_droid (true_droid@moz-123FD9B8.beck.volia.net)
[19:10:06] *** Quits: bytbox (s@moz-BA9A08F8.wireless.umd.edu) (Ping timeout)
[19:10:07] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[19:10:08] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[19:10:18] <SimonSapin> Ms2ger: newcss replaced something else at some point, but Iâ€™m working on replacing it :)
[19:10:28] <Ms2ger> Ha
[19:10:30] <SimonSapin> and segfault on shutdown is a known bug
[19:10:42] <Ms2ger> I'd hope someone noticed that already ;)
[19:11:39] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:14:47] <Eridius> segfault on shutdown is a feature! It wants to be really sure it terminated.
[19:15:53] <toddaaro> nmatsakis: ok, http://pastebin.mozilla.org/2864360 is the ICE and the new rtdebug macro
[19:16:06] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:16:15] <toddaaro> nmatsakis: my 'rtlog' branch at github.com/toddaaro/rust has the the code
[19:16:22] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:16:49] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[19:16:57] <toddaaro> nmatsakis: it fails pretty quickly on make check-stage0-std
[19:18:45] <Eridius> is there any reason why we still have "pure" reserved as a keyword?
[19:18:56] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[19:19:13] *** Joins: fabiand (fabiand@moz-F4592424.adsl.alicedsl.de)
[19:19:33] <strcat> Eridius: in case it ends up being wanted
[19:19:50] <strcat> rusti: let be = 5;
[19:19:50] -rusti- <anon>:5:13: 5:15 error: `be` is a reserved keyword
[19:19:50] -rusti- <anon>:5          let be = 5;
[19:19:50] -rusti-                       ^~
[19:19:50] -rusti- application terminated with error code 101
[19:19:53] <strcat> rusti: let pure = 5;
[19:19:53] -rusti- <anon>:5:13: 5:17 error: `pure` is a reserved keyword
[19:19:53] -rusti- <anon>:5          let pure = 5;
[19:19:53] -rusti-                       ^~~~
[19:19:54] -rusti- application terminated with error code 101
[19:20:30] <nmatsakis> toddaaro: I am ... pretty skeptical of the macro code's treatment of AST expression trees, particularly if they are repeated more than once
[19:20:34] <Eridius> yeah I'm looking at reserving "yield", to knock off #8494, and was mildly surprised to see Be is reserved. Also surprised to see magic constants in the code here (regarding the ranges of interned idents that correspond to keywords)
[19:20:40] <nmatsakis> toddaaro: it may be related to this
[19:20:59] <toddaaro> nmatsakis: what do you mean by "more than once"?
[19:21:11] <nmatsakis> if they are referenced more than one time in the text of the macro
[19:21:15] <nmatsakis> I don't think we rewrite the ids, in particular
[19:21:16] <cmr> Eridius: the keyword magic is really gross, yeah. `be` is reserved for tail calls mostly.
[19:21:38] <toddaaro> hm, so just using the input AST in multiple branches of a conditional is dangerous?
[19:21:53] <nmatsakis> it is but that said I don't know if that's what's causing this :)
[19:22:00] <nmatsakis> or it might be, I could be missing something
[19:22:30] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[19:22:43] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:22:55] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Input/output error)
[19:23:02] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[19:23:07] <toddaaro> wow, that might be it
[19:23:14] <toddaaro> I commented out the if and no check
[19:23:17] <toddaaro> *no ice
[19:23:49] <toddaaro> yea, looks like it should compile fine now
[19:23:54] <toddaaro> thanks for the tip!
[19:24:08] <toddaaro> I should be able to rewrite it to only use the ast once without much trouble
[19:27:03] <graydon> huh
[19:27:25] <graydon> straw poll: when making an enum to hand back from a condition handler to the raise site
[19:27:52] <graydon> is FooProblemResolution or FooProblemFix preferable, as a naming convention?
[19:27:56] <graydon> (or some other convention)
[19:27:57] <Eridius> you know my vote already
[19:28:00] <graydon> I do indeed
[19:28:06] <graydon> and you know mine!
[19:28:53] <cmr> As the type name or the variant name(s)?
[19:28:56] <Eridius> type name
[19:28:59] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[19:30:00] <Eridius> there's an example of the Resolution style in c_str right now, from my just-landed c_str patch, but unfortunately the docs haven't updated
[19:30:14] <Eridius> graydon: when do the docs update? I thought that was automatic, but the c_str docs are now stale
[19:30:20] <graydon> formal/informal doesn't bother me nearly as much as short/long. we try to stick to short stuff.
[19:30:29] <graydon> the doc build is broken, nobody's fixed it recently
[19:30:32] <Eridius> bah
[19:30:59] <Eridius> only the condition implementer will ever have to type the name, and they only have to type it twice. Users don't have to care. I find that reading "NullByteResolution" is clearer than reading "NullByteFix"
[19:31:12] <Eridius> (as the resolution for c_str::null_byte)
[19:31:56] <cmr> I prefer HandleFoo
[19:32:00] <cmr> ie, HanndleNullByte
[19:32:05] <cmr> I have no strog opinion
[19:32:07] <Eridius> well the handler is the closure
[19:32:37] <graydon> there is also that name question, which I mentioned in channel yesterday (renaming trap to handle)
[19:32:41] <cmr> the enum specifies how it will be handled, as I see it
[19:32:50] <cmr> the closure just picks one
[19:32:57] <cmr> *shrug*
[19:32:58] <Eridius> my arguemnts for "Resolution" are a) "fix", used as a noun, is informal usage, and b) "fix" makes it sound like something is broken
[19:32:59] <cmr> naming is hard
[19:33:02] <graydon> the closure could do lots of things.
[19:33:05] <graydon> cmr: indeed
[19:33:22] <graydon> I think something is indeed broken. it's for an error.
[19:33:24] <Eridius> there are only 2 difficult things in computer science: cache invalidation, and naming
[19:33:37] <cmr> (and off-by-one errors)
[19:34:01] <Eridius> input is input. It can be in the wrong format, but that's not broken, that's just wrong. So MalformedInputFix is weird
[19:34:10] <Eridius> could be MalformedInputCorrection ;)
[19:34:49] <nmatsakis> toddaaro: np
[19:35:49] <graydon> is is a code that tells you how to fix the error. I don't think the usage is particularly informal, I realize OED says that but "send the fix for this error" is completely normal speech among developers.
[19:36:19] <strcat> rusti: ~[0u8]
[19:36:19] -rusti- ~[0]
[19:36:53] <graydon> anyway I am not inclined to resolve such things by principled argument so much as who-likes-the-sound-of-what. "crate" is "crate" because it's pithy and sounds nice to those who were around at the time.
[19:36:55] <Eridius> graydon: informal speech is often considered normal speech.
[19:37:14] <graydon> hence "straw poll"
[19:37:15] <Eridius> heh, I'm just using principled argument to try and bolster my "I like the sound of this" ;)
[19:37:20] <graydon> haha
[19:37:42] <Eridius> I didn't consult the dictionary before suggesting Resolution, I consulted it because you suggested Fix. I chose Resolution because that just sounds better to me
[19:37:42] <elly> "fix" is shorter and I am already too close to having RSI
[19:37:49] <graydon> I suppose I am too. I will stop.
[19:39:48] <sebcrozet> Hi. Is there something like the C `sleep` function?
[19:41:04] <cmr> sebcrozet: there's libc::sleep, and there are timers in std::rt::io::timer
[19:41:14] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[19:41:28] <Eridius> libc::sleep will sleep the whole thread
[19:42:29] <sebcrozet> A timer would be great. Is it documented?
[19:42:36] <olsonjeffery> %s is the formatter for a string, right?
[19:42:41] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[19:42:55] <Eridius> yes
[19:43:03] *** Joins: valenting (Thunderbir@moz-7BACEE12.residential.rdsnet.ro)
[19:43:35] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[19:45:19] <bblum> cmr: while i would love to take credit for ironing out compiler bugs
[19:45:27] <bblum> i think you mean type system soundness bugs
[19:46:07] <cmr> sure, if that's the term
[19:47:30] <sebcrozet> cmr: Looks like the timer does what I want. Thanks :)
[19:51:40] <toddaaro> brson: do I have r+ powers I should use on your runtime PRs? 8531 for example
[19:54:09] <Eridius> hah, github has started listing "Rust" in its 3-language summary on my profile page
[19:54:32] <Eridius> odd that it still lists Ruby though. I haven't touched Ruby in.. 6 years? And it doesn't list Obj-C, which was my primary language for the past decade
[19:55:18] <myname> sounds like you are an ios developer
[19:55:43] <Eridius> mac/ios programming has been my primary focus for the past decade, yes
[19:56:17] <myname> nobody else does obj-c :D
[19:56:38] <Ms2ger> ios has existed for a decade? :)
[19:56:42] <Eridius> yeah. It used to be a small club, before iOS came along
[19:56:51] <Florob> I do Objective-C and I have never owned any Apple devices
[19:56:58] <Eridius> Florob: what do you use Obj-C for?
[19:57:31] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[19:57:32] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[19:58:16] <Florob> Eridius, Writing code :P. An XMPP library and client mainly. Using <https://webkeks.org/objfw> a portable non-foundation rewrite framework
[19:58:30] <bblum> calling all metadata wizards
[19:58:46] <Eridius> neat. I've heard of ObjFW (and GnuSTEP for that matter), but never met anyone that actually used it
[19:58:57] <bblum> where can i find the inverse operation of the sequence performed in the item_trait case of encode_info_for_item ?
[19:59:00] <Luqman> nmatsakis: https://gist.github.com/luqmana/639955fed0687e5244ad
[19:59:14] <Eridius> s/GnuSTEP/GNUstep/
[19:59:37] <nmatsakis> Luqman: wacky. thanks.
[20:00:28] <nmatsakis> Luqman: found the problem, merge failure resulting in cut/pasted code :)
[20:00:38] <Luqman> haha nice
[20:00:42] <Luqman> but why android only?
[20:00:44] <toddaaro> nmatsakis: is there a filed issue for my macro problem or should I go make one?
[20:01:05] <nmatsakis> Luqman: the failure was in cabi_arm
[20:01:13] *** dherman is now known as dherman-lunch
[20:01:16] <Luqman> ah
[20:01:30] <nmatsakis> toddaaro: not sure
[20:01:40] <pauls> toddaaro: what problem?
[20:01:42] <nmatsakis> Luqman: just pushed a fix, if it's easy for you to retest
[20:01:52] <toddaaro> pauls: using the AST twice (once in each branch of an if) ICEd
[20:01:54] *** zz_kimundi is now known as kimundi
[20:02:16] <nmatsakis> pauls: node_ids not being rewritten
[20:02:27] <pauls> toddaaro: I doubt it
[20:02:35] <nmatsakis> unfortunately, I use similar tricks in my macros, but so far they seem to...still work
[20:02:37] <toddaaro> pausl: http://pastebin.mozilla.org/2864360 the short summary, full code at my rtlog branch on github
[20:02:50] <toddaaro> pauls
[20:02:53] <Luqman> nmatsakis: ok, i'll try building again
[20:04:07] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[20:09:02] *** Quits: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca) (Ping timeout)
[20:10:38] *** Ms2ger is now known as Msptoger
[20:11:15] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[20:14:46] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[20:16:57] *** Quits: dherman-lunch (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman-lunch)
[20:17:38] *** Msptoger is now known as Ms2ger
[20:17:42] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[20:17:51] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[20:17:59] *** Joins: Florob (Florob@moz-39532932.de)
[20:18:04] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[20:18:27] *** Quits: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[20:18:41] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:18:42] *** ChanServ sets mode: +o tjc
[20:20:05] *** Quits: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[20:20:16] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[20:20:16] *** ChanServ sets mode: +o dherman
[20:20:44] *** Quits: fabiand (fabiand@moz-F4592424.adsl.alicedsl.de) (Quit: Verlassend)
[20:20:53] *** Joins: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[20:23:29] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:23:46] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Client exited)
[20:23:48] *** Quits: Ms2ger (Ms2ger@59A8FC80.80FA5708.187A1082.IP) (Quit: nn)
[20:26:34] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:27:33] <Eridius> r? https://github.com/mozilla/rust/pull/8560
[20:27:34] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[20:27:36] <erickt> pcwalton: ping
[20:27:42] <pcwalton> erickt: pong
[20:28:25] <erickt> pcwalton: hey there! I saw you had some issues with bors rejecting things due to style: https://botbot.me/mozilla/rust/msg/5246336/
[20:28:43] <pcwalton> I don't feel terribly strongly about it
[20:28:47] <erickt> pcwalton: are you familiar with my PR to turn warnings-into-errors in https://github.com/mozilla/rust/pull/8441?
[20:28:53] <pcwalton> yeah, I think that's what prompted it
[20:29:25] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[20:29:28] <pcwalton> I'll comment
[20:30:02] <erickt> pcwalton: gotcha. would you want me to hold back from landing it until it's discussed?
[20:30:04] *** Joins: maik (maik___@moz-C3E4E31D.dip0.t-ipconnect.de)
[20:30:06] <toddaaro> what is the best approach to putting up multiple distinct PRs on the same file?
[20:30:10] <pcwalton> erickt: you can continue to land it
[20:30:15] <pcwalton> it sounds like everyone else is on board
[20:30:15] <toddaaro> should I optimistically rebase one onto the other?
[20:30:26] <cmr> toddaaro: babysitting the PR queue, yeah
[20:30:41] <Eridius> the problem with rebasing one onto the other is your second PR now includes commits from your first
[20:30:46] <toddaaro> cmr: babysitting?
[20:31:00] <toddaaro> Eridius: yea that is what I'm wondering about
[20:31:03] <Eridius> toddaaro: I typically just submit the first, try to get it pushed through bors fast, and submit the second once the first is done
[20:31:08] <Luqman> nmatsakis: success
[20:31:08] <toddaaro> hm
[20:31:09] <erickt> pcwalton: okay
[20:31:27] <cmr> toddaaro: open the different PRs, and when one is pulled, make sure the next in line doesn't have a conflict or anything
[20:31:27] <toddaaro> I think I'm 10th in the queue and have another PR almost ready to go
[20:31:40] <Eridius> I wish there was some way to mark that one PR is based on top of the second, so it doesn't show the second PR's commits in the first, but github doesn't have any way to do that
[20:31:54] <toddaaro> cmr: I know it will be a mega-big conflict unfortunately
[20:32:17] <pcwalton> the nice thing about de-oldvisiting is that it makes a lot of @s in the compiler go away
[20:32:32] <Eridius> toddaaro: you could try convincing someone to bump the priority of #8549
[20:32:35] <toddaaro> Eridius: so only the PR itself will show the wrong set of commits, the tree will still be ideal right
[20:32:38] <Eridius> (which I assume is what you're referring to)
[20:33:00] <Eridius> toddaaro: yeah. But if you rebase the original PR you have to remember to rebase the new one, or things might get confused
[20:33:16] <toddaaro> Eridius: yea, it would make things easy, but there are already piles of high priority PRs
[20:33:59] <cmr> toddaaro: you could just bundle all the commits into a single PR
[20:34:06] <toddaaro> maybe I'll just close that PR and do a new one with all three sets of commits
[20:34:07] <erickt> by the way, is bors disabled at the moment?
[20:34:16] <toddaaro> cmr: ok, if that is reasonable I'll do that
[20:35:08] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:35:43] *** mihneadb|lunch is now known as mihneadb
[20:36:03] <bblum> ast refs, ty refs, ty defs, and ast def-ids
[20:36:05] <bblum> this is all too much
[20:36:54] <maik> is there a way to safely shutdown all tasks?
[20:37:20] <ecr> maik: as in kill the whole program?
[20:38:11] <maik> ecr, yeah something like that
[20:38:34] <maik> or is it just possible with a linked fail?
[20:39:04] <Eridius> libc::exit()?
[20:40:29] <pcwalton> <pcwalton> Ha! Ha! I'm programming with linearity!
[20:40:36] <pcwalton> <dherman> @pcwalton You can say that again! Oh wait, no, you can't!
[20:40:38] <ecr> maik: if all of your tasks are linked then using fail!() will do it.
[20:40:41] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving)
[20:40:52] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:40:54] <ecr> maik: if you have unlinked tasks, then there isn't a way to do that
[20:40:56] <pcwalton> apologies, I had to paste that :)
[20:40:57] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[20:41:15] <Eridius> pcwalton: cute
[20:41:26] <ecr> maik: you can kill the runtime with rtabort!(), but it won't run destructors or anything. just kill the process.
[20:42:46] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[20:42:58] <brson> though rtabort! isn't available outside standard. *maybe* it would be appropriate to add an abort! macro, but sad
[20:43:17] <jack> tjc: where is rustpkg supposed to get the version by default?
[20:43:33] <ecr> maik: if you've only been using spawn! to make tasks, then they're all linked so you can fail! in any one of them and kill the rest.
[20:43:40] <tjc> jack: if the package is in a git repository it gets it from `git tags`...
[20:43:59] <tjc> jack: Otherwise, I *think* if the parent dir is named something like foo-0.5 it will infer 0.5 as the version
[20:44:11] <tjc> there's also the #[link(vers = â€¦)] attribute but graydon thinks we should get rid of that
[20:44:30] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:44:30] <jack> tjc: ok. i'm attempting to convert some simple crates in servo to rustpkg.
[20:44:31] <ecr> maik: does that answer your question?
[20:44:36] <tjc> jack: great!
[20:44:46] <jack> tjc: i may have a lot of silly questions for you :)
[20:45:02] <tjc> jack: please! every "silly" question means a chance for me to improve the docs :-)
[20:45:20] <maik> ecr, sort of, I think I build my own task killing function
[20:46:00] <jack> tjc: for starters, how do i trigger a build when i'm not building in the source directory?
[20:46:08] <Eridius> tjc: does it just grab the highest tag from `git tags`, or does it actually use `git describe` to find the tag for HEAD?
[20:46:23] <tjc> jack: currently if you're not in the package directory, the package you're building has to be in a workspace that's in the RUST_PATH
[20:46:42] <tjc> Eridius: it just grabs the most recent tag, because I didn't know about git-describe :-)
[20:46:46] <Eridius> heh
[20:49:13] <maik> if I have a function that looks like this fn(T)->U , is this what haskell calls a functor?
[20:49:37] *** Joins: bytbox (s@moz-558A9016.wireless.umd.edu)
[20:49:47] <tjc> maik: No, Functor in Haskell is a type class, so if you wrote it in Rust, it would be a trait
[20:49:48] <mm> uh, I ran "make -j8; make install" and it's actually building during the "make install".  Whut?
[20:49:57] <tjc> you also can't write it in Rust right now, at least not the polymorphic version that Haskell has
[20:50:43] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving)
[20:50:48] <maik> tjc, but isn't the purpose of a functor to transform some type T to another type U?
[20:50:52] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:51:28] <cmr> mm: yeah, I've witnessed that too. I don't really understand it :\
[20:51:37] <Eridius> mm: any chance the `make -j8` failed? Sometimes when doing a parallel make I get a failure where it can't find -lmorestack. I think there's a race condition in the makefiles
[20:51:53] *** Quits: heftig (heftig@moz-740E747A.dip0.t-ipconnect.de) (Ping timeout)
[20:52:44] <mm> Eridius: It didn't look like failure (though I only read the last line or two before running the next command)
[20:52:53] <Eridius> in that case, I don't know
[20:53:16] <mm> mm, well, I don't care that it's builing single core
[20:53:31] <mm> I have a few hours before I leave work anyways, so rust will be ready before then either way ;)
[20:53:32] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:53:41] <doomlord_> http://dobkeratops.github.io/rftest/librustc/rustc.rs.html#176 << should have fewer broken links now
[20:54:13] <tjc> Eridius: make -j is known to be dodgy
[20:54:15] <tjc> for Rust, I mean
[20:55:29] <tjc> maik: not exactlyâ€¦ Functor is a predicate that types have if you can map a function over them
[20:55:33] *** Joins: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca)
[20:55:36] <tjc> http://en.wikibooks.org/wiki/Haskell/The_Functor_class gives an ok explanation of it
[20:55:47] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:55:57] <cmr> doomlord_: only thing I notice missing is types in enum variants
[20:56:25] <maik> tjc, okay thanks
[20:56:54] <cmr> and some method arguments..
[20:57:02] <doomlord_> hehe and..and.. :)
[20:57:09] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:57:20] <maik> I wrote a small program today https://gist.github.com/anonymous/6253456 what do you think?
[20:58:37] <Eridius> nice nesting
[20:59:03] <doomlord_> cmr, types in enum variants- do you mean clicking on an instance of an enum variant, or in the enum declaration, you can't click to variants' types
[20:59:27] <cmr> doomlord_: enum declaration
[20:59:36] <Eridius> maik: your Wire trait is pointless. You didn't implement the trait on SingleWire, you just implemented SingleWire directly (which is correct)
[21:00:24] <maik> Eridius, ups, I didn't even notice :x
[21:00:49] *** Joins: heftig (heftig@moz-53276FB3.dip0.t-ipconnect.de)
[21:01:02] <Eridius> your SingleWire is conceptually a Map operation on the Port. Maybe just call it PortMap or something?
[21:01:17] <doomlord_> (i have other problems when i just run it locally aswell, for some reason - its linking between rust libraires better than it does for a local html view)
[21:01:36] *** Quits: bytbox (s@moz-558A9016.wireless.umd.edu) (Ping timeout)
[21:01:45] <bblum> pcwalton: :( "node_id_to_type: no type for node `unknown node (id=198028)`" it didn't work
[21:01:59] <pcwalton> bblum: look in typeck/collect and look where it writes stuff
[21:02:26] <bblum> alright
[21:03:15] <bblum> oh sheeesh
[21:03:22] <bblum>  847         let selfty = ccx.to_ty(&type_rscope(region_parameterization), selfty);
[21:03:25] <bblum>  848         write_ty_to_tcx(tcx, it.id, selfty);
[21:04:44] <maik> Eridius, yeah but it is supposed to respresent sth like this x -> [task1]-> [task2]-> [task3]-> y so it should be a single connection from one task to another. I want to add different types of connections
[21:04:53] <pcwalton> bah, tried to use default methods and it ICE'd in trans
[21:04:58] <pcwalton> in stage0
[21:05:00] <pcwalton> sully: ^
[21:05:03] <pcwalton> is that expected?
[21:07:11] <sully> don't think so...
[21:07:12] <pcwalton> haha, it's in lint
[21:07:12] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[21:07:21] <pcwalton> it failed in lint with an index out of bounds in unused arg checking
[21:07:50] <pcwalton> oh, I see that's funn
[21:07:52] <pcwalton> y
[21:08:00] <pcwalton> trait Foo { fn foo(&self, int) {} } // ICE
[21:08:07] <pcwalton> you have to give SOME pattern there for the type name
[21:09:33] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[21:11:17] <maik> Eridius, do you think it makes sense what I have tried to model? I essentially tried to implement FRP in Rust.
[21:11:33] <toddaaro> ok, the idle callback optimization is almost ready
[21:11:38] <Eridius> maik: while I'm familiar with the basic idea of FRP, I've never actually used it so I can't really comment as to whether you've achieved your goal
[21:11:43] <toddaaro> ~40% speedup on the message passing benchmark
[21:11:52] <cmr> toddaaro: sweet!
[21:11:55] <maik> Eridius, me neither :p
[21:12:07] <cmr> toddaaro: got it in a branch anywhere? :)
[21:12:08] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[21:12:25] <Eridius> maik: hah. Maybe you should try using it first in another language? ;)
[21:12:26] <toddaaro> cmr: idle-opt
[21:12:29] *** flaper87 is now known as flaper87|afk
[21:12:32] *** Joins: josh_ (josh@moz-348C4790.hsd1.mn.comcast.net)
[21:12:34] <Eridius> I hear Haskell has a bunch of FRP libraries. And even Cocoa has one now, in ReactiveCocoa
[21:12:35] <cmr> thanks
[21:12:37] <Eridius> err Obj-C has one now
[21:12:45] <toddaaro> we are still 25% slower than oldrt which is worse than I was hoping with this fix
[21:12:57] <toddaaro> I think datastructures are starting to hurt, contention on message queue
[21:13:40] <maik> Eridius, well I was just too lazy. :D I probably should do some research 
[21:15:36] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[21:18:52] <sfackler> sully: is this kind of thing intended to work wrt trait inheritance and default methods? https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/quote.rs#L54
[21:19:02] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[21:19:12] <mm> So have people given up hope for rusti?
[21:19:26] <sully> not sure
[21:19:27] <mm> seems ... unloved.  Also not working.
[21:19:35] <sully> out of office today
[21:19:38] <sully> eol
[21:19:42] <sully> gah
[21:19:49] <sully> will look later
[21:19:55] <sfackler> thanks
[21:19:55] <tjc> mm: rusti needs a champion
[21:20:28] <mm> tjc: I figured as much
[21:20:31] <engla> rusti worked fine just some weeks ago
[21:21:06] <acrichto> mm: rusti is a bit limited in the respect of local variables, but it should be working just fine
[21:21:41] <maik> "rusti> 5+5 Segmentation fault (core dumped)" :(
[21:22:07] <acrichto> maik: what platform/version of rust?
[21:22:32] <maik> acrichto, master from yesterday+ archlinux
[21:22:46] <acrichto> hmm, maybe something has gone awry on linux
[21:22:48] <mm> I'm seeing rusti> 5+5
[21:22:49] <mm> <anon>:15:0: 15:5 error: unresolved name `rusti`.
[21:22:49] <mm> <anon>:15 rusti;
[21:22:55] <strcat> acrichto: I think it just stack overflows now
[21:22:55] <mm> after "git pull"ing just now
[21:23:09] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[21:23:26] <acrichto> strcat: hm that would make sense
[21:23:42] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0a2/20130815004005])
[21:24:00] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[21:25:09] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Ping timeout)
[21:26:04] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[21:26:49] <brson> cmr: I'd love to see a flame graph of message passing
[21:27:02] <cmr> brson: I'm going to make one :)
[21:27:02] <maik> hm I am tempted to write a tutorial about tasks. Do you think it makes sense to build https://gist.github.com/MaikKlein/6253632 in the tutorial as an example program?
[21:27:10] <cmr> with the new code, that is
[21:27:28] <SimonSapin> Can I use static methods in traits? 
[21:27:32] <brson> i'm surprised that newrt is *still* slower than oldrt on message passing :(
[21:27:38] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[21:27:39] <brson> newrt is supposed to be much more efficient
[21:27:48] <cmr> SimonSapin: yes, but you need to access it like TraitName::method(...)
[21:27:55] <brson> could be contention on the three locked queues that need to be checked, yeah
[21:28:03] <pcwalton> 3 locked queues?!
[21:28:23] <brson> there are three queues involved in the scheduler loop that are implemented with locks
[21:28:29] <pcwalton> linked failure stuff?
[21:28:31] <brson> no
[21:28:34] <pcwalton> ok
[21:28:37] <SimonSapin> cmr: can I dot that in a function that does not have a type parameter with that trait?
[21:28:46] <brson> there's the work queue, the message queue and the sleeper list
[21:28:58] <pcwalton> I thought the work queue wasn't locked
[21:29:08] <pcwalton> oh wait, we aren't on lock free yet are we
[21:29:14] <pcwalton> surprised the message queue is still locked?
[21:29:15] <brson> they are all currently implemented with locks, but have known lock-free datastructures
[21:29:25] <cmr> SimonSapin: I think so? I don't really understand the question.
[21:29:36] <brson> the message queue and sleeper list should be easiest, and we should be able to do optimistic non-synchronizing checks in a few places
[21:29:41] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[21:29:54] <SimonSapin> cmr: how does Trait::method know which impl to use?
[21:30:05] <maik> hm
[21:30:07] <pcwalton> SimonSapin: inference
[21:30:08] <brson> how do we measure lock contention. i know linux has some tools for this, but they may need a kernel recompile
[21:30:12] <Eridius> SimonSapin: type inference
[21:30:26] <SimonSapin> what if there is nothing to infer from?
[21:30:27] <Eridius> SimonSapin: you can also say Trait::method::<foo>() to call a particular one, although I think pcwalton wants to discourage that use at the moment
[21:30:30] *** Quits: josh_ (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh_)
[21:30:36] <pcwalton> I have a PR to remove that
[21:30:38] <pcwalton> SimonSapin: error
[21:30:45] <strcat> brson: there's a valgrind tool for it
[21:30:45] <cmr> brson: do you know what tools those are?
[21:30:49] <pcwalton> I have adding Trait::method::<for foo>()
[21:30:54] <pcwalton> as something on my baord
[21:30:55] <pcwalton> board
[21:30:56] <pcwalton> to bring up
[21:31:06] <SimonSapin> pcwalton: what kind if things can I add to infer from?
[21:31:07] <maik> btw is it intended that trait functions have to be called like traitname::function?
[21:31:15] <pcwalton> SimonSapin: return value or parameter type
[21:31:21] <brson> cmr: 'perf lock' maybe?
[21:31:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:31:28] <pcwalton> maik: yes
[21:31:49] <maik> pcdummy, but what if i implement this trait on two different types?
[21:31:58] <pcwalton> but I would like to add the ability to import traits
[21:31:59] <maik> pcwalton, ^
[21:32:02] <Eridius> pcwalton: I thought it was Trait::<for foo>::method()?
[21:32:05] <pcwalton> maik: use inference
[21:32:08] <pcwalton> Eridius: yeah you're right
[21:32:28] <maik> ah ok
[21:32:28] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:32:28] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14fe5f08f to 14400d151: 02http://git.io/k471pw
[21:32:28] <ghrust> 13rust/06try 14400d151 15Tim Chevalier: rustpkg: Un-ignore most of the remaining tests...
[21:32:28] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:32:30] <brson> somebody implemented a lock-free queue, right? who was that, and is it done?
[21:33:07] <toddaaro> brson: the most recent thing floating around is what I typed up based on that PPOPP paper
[21:33:07] <maik> I think the name is sth like chase-dev queue
[21:33:24] <toddaaro> it isn't really done or tested, eatkinson made a few changes
[21:33:31] <brson> toddaaro: i wasn't thinking of the deque, just the basic queues
[21:33:32] <cmr> aatch was also working on one some months ago
[21:33:36] *** Joins: igl (igl@moz-BFCC83D8.adsl.alicedsl.de)
[21:33:39] <brson> assuming the queues are much easier
[21:33:54] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:34:16] <brson> Eridius: did you write a lock-free queue?
[21:34:26] <toddaaro> brson: actually they are probably quite a bit harder
[21:34:46] <toddaaro> brson: chase-lev has so many use restrictions it ends up simple
[21:34:51] <Eridius> brson: no. Why, should I have?
[21:35:11] <brson> Eridius: no
[21:36:19] <SimonSapin> pcwalton: I added an intermediate function with a dummy type parameter
[21:36:27] <brson> toddaaro: please continue investigating message passing perf
[21:36:32] <pcwalton> SimonSapin: yeah, you have to for now, it's not great
[21:36:37] <pcwalton> that's why I have that on my board
[21:36:40] <brson> i'll do some profiling here too
[21:36:48] <SimonSapin> pcwalton: cool
[21:37:33] <toddaaro> brson: ok, I'm rolling up my cleanup PR, the idle-opt branch, and upgraded rtdebug into a single PR
[21:37:47] <toddaaro> brson: then I'll dive into profiling
[21:38:35] <toddaaro> brson: the message passing thought is mostly still a thought, but it seems like one of our biggest possible bottlenecks
[21:39:04] <brson> toddaaro: how complex are lock-free stacks? the sleeper list might make more sense as a stack
[21:39:37] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[21:39:37] *** ChanServ sets mode: +o dherman
[21:39:54] <toddaaro> brson: not sure, seems like they could be harder as you have all the contention on one end
[21:40:26] *** Joins: dim-an (ermolovd@moz-6D62698D.yandex.net)
[21:40:29] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Client exited)
[21:40:35] <toddaaro> brson: I think michael-scott is one of the standard "does it all" deque implementations, safe in every permutation
[21:41:29] <brson> Thiez was working on a queue
[21:42:04] <brson> toddaaro: I also was considering that we might end up avoiding the libuv event loop entirely in cases where we know there's no pending I/O
[21:42:21] <cmr> Hm, the student rate for intel's software suite is quite reasonable
[21:42:26] <cmr> $129
[21:42:28] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[21:42:46] <brson> toddaaro ecr: I think that, for other reasons, we're going to need to keep our own I/O refcount in order to 'de-optimize' the direct context switches between task when there's pending I/O
[21:43:05] <brson> in order to serve I/O events more timely
[21:43:24] <brson> if hitting the epoll syscall ends up being too expensive then we can piggy-back on that to just not do it
[21:43:25] <toddaaro> makes sense
[21:44:11] <toddaaro> we can avoid going through libuv super easily - just return Scheduler::run_sched_once; inside run_sched_once
[21:44:13] <brson> the previous flame graphs we saw spent like half the execution time just servicing idle callbacks
[21:44:39] <toddaaro> well, that should be gone
[21:44:45] <toddaaro> hopefully
[21:44:48] <brson> yeah, so maybe it's not a big deal now
[21:46:30] <brson> cmr: what's the tldr on generating flamegraphs?
[21:47:04] <graydon> cmr: I have a modified version of a perl script from the repo
[21:47:08] <cmr> http://dtrace.org/blogs/brendan/2012/03/17/linux-kernel-performance-flame-graphs/, perf record `foo`; perf script | ./stackcollapse-perf.pl | ./flamegraph.pl > perf-kernel.svg
[21:47:10] <graydon> you run it on the output of perf
[21:47:15] <brson> ooh. the good news is that rt-messaging-ping-pong fully utilizes all my cores
[21:47:19] <graydon> yeah, that one. the perl script isn't quite right there.
[21:47:47] <graydon> a flame graph is just a different way of looking at a normal hierarchical profile though
[21:47:48] <toddaaro> brson: it does a pretty good job, htop shows a fair bit of red at the top though
[21:47:52] <toddaaro> while oldrt is all green
[21:47:53] <graydon> (horizontally, more or less)
[21:47:57] <toddaaro> (user versus kernel space)
[21:48:29] <tjc> graydon: is bors down right now?
[21:49:29] <cmr> I'm looking into setting up dtrace, systemtap, and lttng.
[21:51:46] <graydon> cmr: if I can point you to something simpler and more low-hanging-fruit-ish?
[21:51:55] <cmr> graydon: sure?
[21:52:02] <graydon> https://github.com/mozilla/rust/issues/6810
[21:52:37] <ecr> brson, toddaaro: sounds good. the way homing is currently implemented actually ends up making the handles actively doing IO do a round robin-like thing.
[21:52:51] <graydon> a nice standard means for adding counters and histograms, collecting and reporting them (from any program) would go a long way to getting us casual collection of important stats
[21:52:53] <bblum> hmmmm, how do i get a ast::def_id from a ast::trait_ref?
[21:52:57] <ecr> since every call involves at least 2 deschedules
[21:53:27] <graydon> cmr: if you're interested I'm happy to do some hand-holding or cooperation. that's nearly my next task.
[21:53:32] <cmr> bblum: use the def_map
[21:53:36] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[21:53:47] <cmr> https://github.com/cmr/rustdoc_ng/blob/master/clean.rs#L976 as a (fairly complex) example
[21:53:54] <bblum> cmr: oh actually i got code to do this already, thanks
[21:53:55] <jld> perf... script?  Is this something I should have known about instead of writing sketchy regexps and Python code to scrape `perf report -D`?
[21:54:03] <graydon> jld: _yes_
[21:54:12] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[21:54:39] <SimonSapin> pcwalton: Same :( fn test_correct_table<I: SingleByteEncodingIndex>(_: I)
[21:54:49] <pcwalton> it needs to be Self
[21:54:56] <pcwalton> use the implicit "Self" type parameter
[21:55:04] <pcwalton> x: Option<Self>
[21:55:19] <pcwalton> in the trait, use
[21:55:24] <SimonSapin> whatâ€™s Self? Does it work on bare functions?
[21:55:27] <pcwalton> fn forward(_: Option<Self>) {}
[21:55:30] <pcwalton> then do
[21:55:39] <pcwalton> let x: Option<Whatever> = None;
[21:55:42] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[21:55:44] <pcwalton> Trait::forward(x)
[21:55:44] <SimonSapin> oh
[21:55:50] <brson> cmr have you seen "ERROR: no stack counts found" running flamegraph?
[21:56:05] <bblum> cmr: will the def map work while inside typeck::collect?
[21:56:07] <cmr> brson: I don't think so?
[21:56:18] <cmr> bblum: good question. I think it's created in resolve.
[21:56:24] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[21:56:24] <bblum> oh yeah, right
[21:56:26] <bblum> ok, it will
[21:56:45] <jld> graydon: Well, the main problems with aforementioned regexps/python were (1) having build the perf tool for the target and (2) having to build the perf tool for the host.  So perf script might not have helped much.
[21:56:53] <brson> cmr: oh I'm probably using the wrong stackcollapse script
[21:58:18] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:59:17] <cmr> graydon: I was going to start working on https://github.com/mozilla/rust/issues/7532 more, but 6810 looks like it'd be more immediately useful.
[21:59:36] <brson> where's an easy place to upload an svg file?
[22:00:33] <graydon> cmr: I think so, yeah. we're not measuring enough, period. and not reporting it terribly well.
[22:00:51] <pcwalton> bblum: yes the def map will
[22:03:43] <brson> pcwalton: i'm going to profile that benchmark that I used at the beginning of summer again and see where that one stands
[22:03:55] <pcwalton> cool
[22:04:48] *** Quits: dim-an (ermolovd@moz-6D62698D.yandex.net) (Quit: dim-an)
[22:06:41] <graydon> woah
[22:06:49] <graydon> new versions of perf have memory-access profiling
[22:09:59] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Ping timeout)
[22:10:18] <jld> ...how does that work?
[22:10:35] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:10:53] <graydon> jld: https://lwn.net/Articles/531766/
[22:11:16] <graydon> PEBS, looks like
[22:11:26] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:12:31] <graydon> cmr: are you interested in that or shall I leave it on my plate?
[22:12:35] <cmr> graydon: I am
[22:13:17] <graydon> ok. let me know if/when you want to discuss impl strategy.
[22:13:24] *** Joins: mkrjn (Mibbit@moz-57D07658.lightspeed.moblal.sbcglobal.net)
[22:14:46] <jld> Ah, a hardware feature.  This is what PERF_SAMPLE_ADDR is for, I guess?
[22:15:51] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:16:28] *** Quits: mkrjn (Mibbit@moz-57D07658.lightspeed.moblal.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:17:37] <graydon> I guess. I'm on an old kernel here.
[22:17:57] <brson> pcwalton: here are some new numbers using that same old coroutine benchmark, using toddaaro's idle cb opts https://gist.github.com/brson/6253947. both multithreaded and not. in the multithreaded case it's currently twice as fast as oldrt, but in the single threaded case it's slower than oldrt. in either case it's quite a bit slower than we're aiming for
[22:18:04] <cmr> brson: with your patch for 8458 I get `--src-base /home/cmr/hacking/rust/src/test//`, which suggests to me that $$(base) is getting expanded into nothing?
[22:18:05] <jld> graydon: Speaking of perf, did I mention my scripting for viewing perf_event data in the Gecko profiler frontend at some point?  It's somewhat b2g-specific (and, um, uncommented and unlanded) at the moment, but it's been useful.
[22:18:27] <graydon> I wonder if there's any way to provide an input file or arguments to a test running from a tutorial-snippet
[22:18:42] <graydon> jld: I did not know that! how does it work / what does it do?
[22:19:06] <brson> cmr: and no benchmarks run? odd
[22:19:07] *** Quits: maik (maik___@moz-C3E4E31D.dip0.t-ipconnect.de) (Ping timeout)
[22:19:40] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[22:20:00] <cmr> yeah
[22:20:34] <jld> graydon: Reads the perf data, resolves addresses in call chains (kernel and user) to files and symbols, writes out JSON for cleopatra.
[22:20:35] <toddaaro> brson: what counts as a coroutine call?
[22:21:13] <jld> graydon: Also, I've been working with whole-system profiles, and presenting them to the UI with one "thread" per CPU, and pseudo-frames for the process and thread.
[22:21:21] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[22:21:21] <graydon> jld: does it do this while it's running? like profiling itself?
[22:21:51] <jld> graydon: No, this is capturing a profile on the device and then post-processing it and loading it in a browser on the build host.
[22:22:43] <toddaaro> brson: definitely concerns me that there is a 2x slowdown multithreaded
[22:22:57] <graydon> jld: oic
[22:23:05] <SimonSapin> pcwalton: I ended up making normal methods that just ignore self, and passing around an empty struct
[22:23:29] <cmr> brson: either that or I'm iterating over the wrong thing, I think $$(CTEST_SRC_BASE_$(4)) is right, but maybe there is weirdness moving it into the foreach call? does it need an additional layer of $?
[22:25:08] <brson> toddaaro: here's the thing i'm running https://github.com/brson/rust-sched-bench/blob/master/coroutine-call.rs
[22:25:16] <brson> toddaaro: it's supposed to simulate calls between script and layout
[22:25:53] *** Joins: doener (doener@moz-A47ED54E.unitymediagroup.de)
[22:27:40] <jld> graydon: There's probably interesting stuff that could be done live, UI-wise, and maybe someday I'll have time to think about it.
[22:27:56] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[22:28:08] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[22:28:45] <brson> woah, this coroutine-call spends a lot of time in the scheduler and in epoll
[22:28:50] <jld> graydon: But it is nice being able to capture a bunch of threads/processes sending messages back and forth and having any idea at all what's going on -- the timeline in the Gecko profiler (which I gather was inspired by the Xcode UI?) is nice for that.
[22:29:39] <graydon> jld: no doubt! I'm just presently curious about self-profiling tools. or other self-contained monitoring.
[22:29:44] <graydon> jld: but that's super cool
[22:29:46] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[22:30:11] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[22:31:21] *** Joins: eschweic1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:31:26] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:31:29] <strcat> ",".join(iterator) or iterator.join(",")
[22:31:48] <strcat> although I am leaning towards the 1st because the 2nd requires yet another trait
[22:32:44] <strcat> 1 trait per type you want to be joinable, pretty gross
[22:33:07] <cmr> it couldn't be implemented over all Iterator<T: ToStr> ?
[22:33:38] <strcat> ToStr isn't useful, it goes &self -> ~str
[22:33:40] *** kimundi is now known as zz_kimundi
[22:33:47] *** zz_kimundi is now known as kimundi
[22:34:14] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[22:34:30] <strcat> you'd do a copy for every element
[22:34:34] <strcat> and then another set of copies to join
[22:35:28] <strcat> I need it for Iterator<&str>
[22:35:45] <strcat> or maybe Str
[22:35:53] <brson> toddaaro: when i modify this 'coroutine' benchmark to do many of these in parallel, putting all threads under load, the performance goes up a lot, presumably because there's no overhead of waking up other threads 
[22:36:11] <strcat> but that'd need a trait
[22:36:32] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:37:01] <brson> which seems like a good thing to me
[22:37:30] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[22:37:30] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14400d151 to 14ca7c7ba: 02http://git.io/k471pw
[22:37:30] <ghrust> 13rust/06try 14ca7c7ba 15Tim Chevalier: rustpkg: Un-ignore most of the remaining tests...
[22:37:30] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[22:38:06] *** Joins: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net)
[22:38:29] *** Quits: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr) (Ping timeout)
[22:38:42] *** Quits: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net) (Quit: msingle)
[22:39:18] <graydon> brson: is it possible to have a test in a tutorial that we want to ensure fails?
[22:39:32] <graydon> brson: not {.xfail-test}, but actually "this should fail"
[22:39:35] <strcat> .should_fail or something
[22:39:39] <strcat> iirc
[22:39:46] <jld> graydon: Rust bindings for perf_event_open could be interesting.
[22:39:46] <graydon> not seeing it
[22:39:53] <brson> graydon: i don't think so
[22:39:58] * strcat thought it existed
[22:39:59] <brson> they are all turned into run-pass tests
[22:40:11] <brson> would be good!
[22:40:12] <graydon> hmph
[22:40:24] <strcat> maybe it only existed in my imagination as something I wanted once
[22:40:39] <tjc> brson: r? https://github.com/mozilla/rust/pull/8548
[22:40:59] <jld> Though a fully Rustic translation of PERF_RECORD_SAMPLE would have a lot of Option<u64> and Option<(u32, u32)>. /-:
[22:43:31] <brson> well, i'm pretty convinced that message passing perf is not hopeless
[22:43:39] <tjc> pcwalton: r? https://github.com/mozilla/rust/pull/8502
[22:43:41] *** Joins: Ralith (ralith@moz-AB653EB1.wireless.sfu.ca)
[22:45:04] <pcwalton> tjc: LGTM
[22:45:15] <tjc> thx
[22:46:36] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:46:42] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[22:46:45] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:47:34] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[22:49:19] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Quit: WeeChat 0.4.1)
[22:52:06] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Client exited)
[22:52:09] <bblum> do we have an issue open for not being able to write multicrate test cases
[22:52:19] *** kimundi is now known as zz_kimundi
[22:52:31] <cmr> bblum: multicrate test cases is implemented, isn't it?
[22:52:34] <cmr> using aux?
[22:52:52] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[22:53:00] *** zz_kimundi is now known as kimundi
[22:53:10] *** Quits: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[22:53:12] *** Joins: mm (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[22:53:39] <bblum> cmr: tell me about this
[22:54:36] <cmr> bblum: you put one crate that is supposed to build in src/text/auxiliary/foo.rs, and the actual test wherever else
[22:54:45] <cmr> for example see run-pass/packed-struct-size-xc.rs
[22:54:53] <cmr> (and auxiliary/packed.rs)
[22:55:43] <bblum> oh this is nice
[22:55:43] <bblum> thanks
[22:57:55] <dbaupp> graydon: https://github.com/mozilla/rust/issues/3509
[22:58:14] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[22:58:14] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[22:59:00] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[22:59:34] <graydon> dbaupp: shall I dig into it?
[22:59:35] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Ping timeout)
[23:00:55] *** Quits: goffrie (goffrie@moz-AA92FD24.dsl.ncf.ca) (Ping timeout)
[23:01:42] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[23:02:46] <acrichto> brson: r? https://github.com/mozilla/rust/pull/8447
[23:05:22] *** Joins: goffrie (goffrie@moz-FBDA8B99.dsl.ncf.ca)
[23:05:53] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:07:30] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[23:09:07] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[23:09:17] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:09:18] *** ChanServ sets mode: +o brson
[23:09:35] <graydon> nmatsakis: can you close the wrappers PR and reopen?
[23:09:41] <graydon> (maybe rebase inbetween)
[23:09:57] <graydon> bors has been wedged since 6am this morning because github refuses to report status on that PR
[23:10:28] <graydon> apparently github is confused by one of the comments
[23:11:13] * graydon pokes at the change, maybe if I add another comment...
[23:11:44] <graydon> oh hum
[23:11:45] <graydon> sec
[23:11:49] <graydon> don't close that
[23:11:50] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[23:12:09] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Ping timeout)
[23:14:06] *** abacus is now known as [a]bacus
[23:15:05] <olsonjeffery> 9 minute cycle time for make check-stage1-std ;_;
[23:16:13] <sfackler> try NO_REBUILD=1
[23:16:39] <olsonjeffery> i want to believe
[23:16:59] <sfackler> not sure if that rebuilds libstd or just libstd tests though
[23:17:00] <graydon> "API rate limit exceeded for bors. See http://developer.github.com/v3/#rate-limiting for details."
[23:17:18] <graydon> so this is what happens when the queue gets too big
[23:17:24] <tjc> Heh, wow
[23:17:38] <cmr> you might be able to ask github support for a bigger quota?
[23:18:13] <sfackler> bors is making more than 5000 requests an hour?!
[23:18:26] <tjc> seems legit
[23:18:59] <toddaaro> what is the best way to debug double-free or corruption bugs?
[23:19:16] <toddaaro> making rtdebug less awful is ... a suprisingly difficult path
[23:19:31] <toddaaro> oh, actually I think I have it
[23:19:39] <toddaaro> checking tls before tls pointer initialized
[23:19:39] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:20:25] <cmr> toddaaro: valgrind is usually the best btw
[23:20:28] *** Joins: jaen (jaen@moz-69DF1685.play-internet.pl)
[23:20:48] <graydon> it scans the queue every 3 minutes, so 20x per hour
[23:21:09] <graydon> 60 entries in the queue, 5 API requests per PR more or less
[23:21:14] <graydon> 6000 req/hr
[23:21:15] <graydon> yup
[23:21:36] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:21:44] <graydon> easiest fix is to bump it to every 5 minutes or every 10
[23:22:03] <graydon> or we could try to clean out stuff from the queue, as most of the entries are stale or bad and apparently abandoned
[23:22:43] <toddaaro> could it do less querying for bad entries?
[23:22:51] <graydon> I shouldn't say most. about 30%?
[23:22:55] <graydon> 40%?
[23:23:17] <graydon> possibly a little, not a lot less
[23:24:06] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[23:24:26] *** Quits: jaen (jaen@moz-69DF1685.play-internet.pl) (Quit: WeeChat 0.4.1)
[23:24:35] <olsonjeffery> \o/
[23:25:04] <Seldaek> graydon: if you have a specific API token for bors that's private you might get them to whitelist it. 
[23:25:10] <Seldaek> worth emailing support
[23:25:24] <olsonjeffery> brson: hey, i never got to do this when doing the timer work.. just wanted to thank you for newrt. great abstractions.
[23:25:27] <olsonjeffery> thank you.
[23:26:02] <brson> acrichto: i just added one comment to that pr
[23:26:14] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[23:27:19] <acrichto> brson: yeah I was typing a response, the summary is that I think this should be fixed now instead of punting it again. Isn't this just a problem of destructors for types accessing TLS again?
[23:27:21] <brson> olsonjeffery: i'm glad you're enjoying it. i am worried about how mind-bending the uvio stuff is - the combination of higher-order-functions, context-switching, asynchrony and multithreading is pretty brutal
[23:27:41] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[23:28:15] <toddaaro> blarg
[23:28:19] <toddaaro> to valgrind I go
[23:28:32] <olsonjeffery> brson: yeah. my one concern is that the API isn't ready for the idea of a drop-in replacement for the IoFactory, etc atop a different main loop.
[23:28:36] <toddaaro> I did not expect a trivial change to rtdebug! to take this much of my time
[23:28:39] *** Joins: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP)
[23:28:42] <olsonjeffery> but that's in the future.
[23:28:52] <brson> acrichto: yes, that is what's happening. i don't know what the solution is. either TLS or the GC has to be destroyed first and both can access each other
[23:28:57] <nmatsakis> graydon: so I should take no action I guess? :)
[23:29:03] <graydon> nmatsakis: yeah, not your fault
[23:29:04] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Client exited)
[23:29:05] <olsonjeffery> and what's there now is great and world's better than what i did.
[23:29:10] <graydon> nmatsakis: nor even that PR's fault
[23:29:17] <nmatsakis> graydon: I saw, exceed our quota
[23:29:19] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:29:19] <olsonjeffery> so im glad to work with it.
[23:29:21] <acrichto> brson: I have a feeling `while self.storage.is_some() { self.storage.take() }` would be a bad solution
[23:29:25] <nmatsakis> brson: ping
[23:29:36] <graydon> brson: scale of 1 to 10, how'd you feel about disabling the -all builders for a little while?
[23:29:39] <brson> olsonjeffery: yeah, multiple implementations of IoFactory are a far-future pipe-dream at this point. EventLoop itself we have some intermediate term need for alt-impleentaions though
[23:29:43] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:29:56] <graydon> it'd risk some breakage but drain the queue some, and I think we have good 64 and 32 coverage (ish)
[23:30:01] <olsonjeffery> yeah, that's right. EventLoop is the crux.
[23:30:12] <olsonjeffery> s/IoFactory/Eventloop/
[23:30:20] <olsonjeffery> athough the former is dependant on impl details of the latter
[23:30:41] *** Quits: victorporof (victorporo@69BF4ADB.B434C58E.9B1E38F4.IP) (Ping timeout)
[23:30:41] <brson> graydon: i don't have a strong opionion - the only downside is that we depend on -all working to make snapshots
[23:30:59] <graydon> mhm. ok. I have to even be thinking of it.
[23:31:01] <graydon> hate
[23:31:27] <graydon> will poke more at straight-line perf fixes again
[23:31:27] <brson> what is all's cycle time, and what's the next worse?
[23:31:49] <graydon> all takes 1h50
[23:31:59] <graydon> next worse is vg, 1h20
[23:32:04] <brson> are we still testing -all?
[23:32:08] <graydon> yup
[23:32:15] <graydon> are we not supposed to be?
[23:33:03] <brson> i don't know. i'm not completely abreast of the tweaks you've been making, thought you might have turned the tests off
[23:33:20] <graydon> no, I split the nopt tests
[23:33:27] <graydon> so they run on optimized compilers
[23:33:33] <brson> ah right
[23:33:41] <brson> did that help much?
[23:33:44] <bblum> brson: https://github.com/mozilla/rust/pull/8565
[23:33:49] <graydon> didn't disable -all tests. if you think they're redundant with the normal 32 and 64 tests, I'd be happy to disable them
[23:33:54] <bblum> brson: the diff looks big but it's just reindenting to get it inside the finally
[23:33:58] <graydon> yes splitting the nopts cut cycle time hugely
[23:34:42] <brson> graydon: i guess keeping the cross-tests working is important, so i don't think they should be disabled
[23:34:49] <graydon> er, well, sorry not "hugely", cumulatively I guess only a little
[23:34:59] <graydon> they were very slow tests, but fast-ish compiles
[23:35:06] <graydon> brson: ok
[23:35:28] <brson> but feel free to turn them off completely for a while
[23:36:13] <brson> they could be 'best-effort' bots, not gating landing
[23:36:59] <olsonjeffery> brson: i guess, stepping back a bit, what i teased out with the whole global_event_loop (ugh!) was the matter of extracting dependencies..
[23:37:05] <brson> or, well, maybe we could just turn them off. it's not like the build system is changing a lot - we don't see *much* cross-compile breakage
[23:37:08] <brson> i think
[23:37:09] <olsonjeffery> newrt pretty much sidesteps this with Local::unsafe_borrow and friends
[23:37:10] <brson> maybe with rusti
[23:37:39] <olsonjeffery> brson: so.. i guess.. when do we get to the point where we can substitute non-libuv impls of IoFactory, EventLoop, etc in Local
[23:37:59] *** Quits: valenting (Thunderbir@moz-7BACEE12.residential.rdsnet.ro) (Ping timeout)
[23:39:05] <olsonjeffery> heh. i set a pomodoro timer to my expected cycle time. so at least i can know when to check on my terminal where the build is.
[23:39:25] <cmr> olsonjeffery: ohh that's genius, I'll use mine like that too
[23:39:57] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[23:39:58] <toddaaro> I ended up with a borked git fork, for some reason rebasing onto master leaves piles and piles of other commits in "my" PR
[23:40:02] <toddaaro> how do I fix this
[23:40:16] <brson> olsonjeffery: I expect that there doesn't need to be additional local impls for different I/O implementations, just Local::<IoFactory> that returns a generic IoFactory. I'm not exactly sure how that will work though since the ~T that Local expects is different than ~Trait
[23:40:16] <toddaaro> the most recent 5 commits are exactly what I want them to be merged and everything
[23:40:19] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:40:41] <nmatsakis> brson: graydon: conceivably, we could have someone do a snapshot every N days where N i snot large, and thus catch regressions relatively quickly?
[23:40:54] <toddaaro> oh ha! it was just fubaring the git interface
[23:40:57] <brson> nmatsakis: yeah, people have often asked for weekly snapshots
[23:41:00] <nmatsakis> probably wouldn't happen, we'venot proven good at that sort of thing
[23:41:10] <olsonjeffery> /w/w 2
[23:41:30] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:41:42] <brson> olsonjeffery: after the *Objects are real objects we'll want to implement EventLoop for e.g. the windows and cocoa event loops, glfw, etc
[23:41:47] *** Joins: vk_ (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[23:41:52] <brson> that will be a lot of work
[23:42:00] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:42:13] *** Joins: valenting (Thunderbir@moz-7BACEE12.residential.rdsnet.ro)
[23:42:15] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[23:42:16] *** Quits: heftig (heftig@moz-53276FB3.dip0.t-ipconnect.de) (Quit: Quitting)
[23:42:28] *** vk_ is now known as vk
[23:43:05] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[23:44:16] <toddaaro> brson: https://github.com/mozilla/rust/pull/8566 r+?
[23:44:53] <olsonjeffery> brson: it seems like we can get rid of the IoFactoryObject newtype, etc stuff, as is.. i was able to do it in my aio branch
[23:44:55] <toddaaro> brson: left out rtdebug, finding the memory corruption seems to be a big enough project that I'll postpone it for a bit
[23:44:58] *** Joins: heftig (heftig@moz-53276FB3.dip0.t-ipconnect.de)
[23:45:05] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Client exited)
[23:45:11] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:45:24] <olsonjeffery> is there more work to be done there? or is *Object referring to something else..?
[23:45:27] *** Quits: Ralith (ralith@moz-AB653EB1.wireless.sfu.ca) (Ping timeout)
[23:48:50] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[23:49:29] <brson> olsonjeffery: are you saying that your branch converts uses of ~EventLoopObject to ~EventLoop, etc. (real objects)?
[23:49:51] <olsonjeffery> brson: i didn't do it w/ EventLoop or IoFactory
[23:50:03] <olsonjeffery> but, for example, I had UvTcpStreamAsync etc
[23:50:17] <olsonjeffery> and i was able to do it w/o having an a UvTcpStreamAsyncObject newtype
[23:50:25] <olsonjeffery> as they exist at the top of rtio.rs
[23:50:33] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[23:50:58] <olsonjeffery> excuse me
[23:51:06] <olsonjeffery> RtaioUvTcpStreamAsyncObject
[23:51:21] <brson> neat
[23:51:24] <brson> yeah, that's the whole issue
[23:51:26] <olsonjeffery> as a newtype of UvTcpStreamAsync, which impl'd RtaioUvTcpStreamAsync
[23:51:35] * olsonjeffery nods
[23:52:34] <brson> outside of rt::uvio, no code should know anything about uv - it should all be using rt::rtio ~objects
[23:53:16] <bbouvier> hi! I am trying to compile pcwalton's zero.rs example with the last rustc, but it fails with a reference error: "undefined reference to `dlsym'" + same one with 'dladdr'. Any idea, someone?
[23:53:18] <olsonjeffery> brson: this was the key.. i just checked out my discarded aio branch..
[23:53:20] <olsonjeffery> `let r = Ok(~UvTcpStreamAsync(watcher) as ~RtaioTcpStreamAsync);`
[23:53:22] <olsonjeffery> in uvio
[23:53:42] <olsonjeffery> in tcp_connect_async in IoFactory impl for UvIoFactory
[23:53:44] <olsonjeffery> yadda yadda
[23:53:51] <pcwalton> hmm, never seen that before.
[23:54:15] <olsonjeffery> normally you just return ~UvTcpStreamAsync(watcher)
[23:54:31] <olsonjeffery> and it's inferred as a ~RtaioTcpStreamAsyncObject, in the old setup
[23:56:55] <olsonjeffery> anyways. it seems like a lot of that work to remove the newtypes in rtio could be done, now. i might look at it after landing my current file io stuff.
