[00:00:05] <cmr> agmcleod: There is no "make it into a module eventually"
[00:00:16] <fkaa_> mbrubeck: technically it should work with naming the rust functions the same as C right?
[00:00:17] <agmcleod> cmr code refactor?
[00:00:18] <cmr> It needs to wind up in a module to be built.
[00:00:21] *** Joins: aguilbau (an7@moz-8v48ic.rev.poneytelecom.eu)
[00:00:25] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:00:58] <mbrubeck> agmcleod: Just write `mod foo;` and it'll be basically equivalent to `mod foo { #include "foo.rs" }`
[00:01:02] <mbrubeck> Don't fear the module!
[00:01:07] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:01:14] <fkaa_> does rust do any mangling?
[00:01:28] <cmr> fkaa_: yes, but you can disable it with #[no_mangle] or #[link_name="malloc"]
[00:01:52] <mbrubeck> fkaa_: You can use `#[no_mangle] pub extern "C" fn f()` to make your Rust functions callable like C functions, yeah.
[00:02:11] <fkaa_> neato
[00:02:22] *** Joins: Guest_ (textual@moz-hc6.9a2.177.72.IP)
[00:02:39] *** Joins: Wilduck (erik@moz-0l3fjb.fios.verizon.net)
[00:02:52] *** Quits: kkus (kkus@moz-48u.h1l.234.165.IP) (Ping timeout: 121 seconds)
[00:04:01] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[00:04:21] *** Joins: hjr3 (hradtke@moz-lei.av4.169.69.IP)
[00:04:25] <reem> where did —no-trans go?
[00:04:32] <reem> and/or what replaced it?
[00:05:24] *** Joins: datanoise (kent@moz-nd2iqs.fl.atlanticbb.net)
[00:05:31] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[00:06:19] <cmr> -Z no-trans
[00:06:21] *** Joins: cakecatz (cakecatz@moz-rakufn.sannet.ne.jp)
[00:06:24] <cmr> still a thing, alwayas was a thing.
[00:06:36] <reem> ahh, I was looking under -C and couldn’t find it
[00:06:45] <cmr> :)
[00:07:36] *** Quits: housl (housl@moz-238.d49.27.76.IP) (Quit: WeeChat 1.2)
[00:08:02] <RCIX> http://prntscr.com/7cgtxk
[00:08:06] <RCIX> uhm
[00:08:12] <RCIX> im looking at the directory
[00:08:20] <RCIX> that is an executable >.>
[00:08:35] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:08:46] *** Quits: panicbit (panicbit@moz-vqobnf.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[00:09:19] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:09:33] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[00:09:46] <RCIX> anyone have any ideas?
[00:09:48] *** Quits: ajtulloch (ajtulloch@moz-ao5.9o0.201.199.IP) (Ping timeout: 121 seconds)
[00:10:06] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[00:10:36] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:10:47] *** Joins: lenstr (lenstr@moz-qp8.vju.25.171.IP)
[00:11:31] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:12:15] <genbattle> 64-bit rust executable with 32-bit gcc or vice versa?
[00:12:21] <genbattle> *gdb, not gcc
[00:12:23] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[00:12:33] <RCIX> thats
[00:12:34] <RCIX> quite possible
[00:12:36] *** Quits: arBmind1 (Andreas@moz-90su4v.adsl.alicedsl.de) (Quit: Leaving.)
[00:12:40] <RCIX> i got 64 bgit mingw
[00:12:47] <RCIX> i /thought/ i had 64 bit rust
[00:13:16] <RCIX> conveniently, neither rustc nor gdb tells me bitwise >.>
[00:13:28] <genbattle> x_86_64 seems to be the default download
[00:13:28] <RCIX> or did i get 32bit mingw
[00:13:32] <WindowsBunny> RCIX: Rust will tell you
[00:13:41] <WindowsBunny> rustc -vV definitely tells you its bits
[00:13:43] <mbrubeck> does mingw include the `file` utility?
[00:13:43] <RCIX> rustc --version just says version
[00:13:53] <RCIX> if not i can probably go grab it
[00:13:55] <mbrubeck> try rustc -Vv
[00:14:10] *** Quits: yed_ (yed@moz-vhuvg2.as13285.net) (Client exited)
[00:14:18] <WindowsBunny> RCIX: `rustc -vV` and tell us the host
[00:14:20] <RCIX> k
[00:14:40] <RCIX> ok yeah x86-64
[00:14:49] *** Quits: lenstr (lenstr@moz-qp8.vju.25.171.IP) (Ping timeout: 121 seconds)
[00:14:51] <RCIX> which leads me to believe i probably accidentally grabbed 32 bit mingw
[00:14:55] <RCIX> brb reinstalling mingw
[00:15:07] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[00:15:43] *** Quits: hhhhhhhhhh (mike@moz-969kuj.cable.virginm.net) (Quit: WeeChat 1.2)
[00:15:44] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:16:43] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:17:23] *** Quits: dfockler (dfockler@moz-etoj16.hfc.comcastbusiness.net) (Connection closed)
[00:17:29] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[00:17:49] *** Joins: Clay (Mibbit@moz-o7k96m.dc.cox.net)
[00:18:53] <Clay> Can anyone help me with https://play.rust-lang.org/?gist=706a14136944fd6cbf80&version=stable ? I'm not understanding what I'm doing wrong
[00:19:10] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[00:19:40] *** Quits: CactusCommander (fiveside@moz-t2eatg.vsp.com) (Ping timeout: 121 seconds)
[00:19:42] *** Quits: Guest_ (textual@moz-hc6.9a2.177.72.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:19:58] *** Quits: Wilduck (erik@moz-0l3fjb.fios.verizon.net) (Client exited)
[00:19:59] <WindowsBunny> Clay: Do you want to return Some(TokenType::OpenParen) when '(' is hit?
[00:20:08] <Clay> WindowsBunny: Yes
[00:20:14] *** Joins: vikaton (uid59278@moz-0a9h81.ealing.irccloud.com)
[00:20:16] <WindowsBunny> Clay: If so, you should try actually specifying return there
[00:20:24] <Clay> WindowsBunny: I did :/
[00:20:27] <WindowsBunny> Clay: Because you're in a loop, so you can't implicitly return
[00:20:31] *** Joins: think3t (Mibbit@moz-2t7.vi9.94.218.IP)
[00:20:36] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[00:20:37] <vikaton> WindowsBunny: You better have reserved your free copy of windows10
[00:20:41] <WindowsBunny> You have to explicitly write the keyword return
[00:20:56] <vikaton> or i'll be pretty disappointed in you
[00:20:58] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:20:59] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[00:21:03] <Clay> WindowsBunny: I have. I get the same error
[00:21:25] <RCIX> WindowsBunny, ok im completely lost, can you point me to anything regarding windows 64bit gdb
[00:21:39] *** Quits: think3t (Mibbit@moz-2t7.vi9.94.218.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:21:52] <mbrubeck> Clay: Also return `None` if you drop out of the loop
[00:21:55] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:22:00] *** Joins: wycats (sid79@moz-b4lrm3.brockwell.irccloud.com)
[00:22:00] *** ChanServ sets mode: +o wycats
[00:22:42] <vikaton> does Rust have a windows binary?
[00:22:49] <vikaton> library*
[00:22:52] <Dabo> Clay, You also need to add some thing to return if you don't have any more elements
[00:22:57] <Dabo> so "None" at the bottom of the function
[00:23:14] <Clay> mbrubeck, Dabo: Hah! you're right! Man, I've been pulling at my hair for a half hour
[00:23:22] <Clay> Thank you!
[00:23:44] <WindowsBunny> Clay: Also you have to do
[00:23:45] <Dabo> no problem!
[00:23:46] <WindowsBunny> for c in self.char_iter.by_ref() {
[00:23:47] <WindowsBunny> I think
[00:23:52] <WindowsBunny> that fixed the build for me
[00:23:54] <Dabo> WindowsBunny, for c in &mut self.char_iter
[00:23:57] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[00:23:58] <WindowsBunny> or that
[00:24:20] <WindowsBunny> vikaton: Windows library?
[00:24:35] <vikaton> ye like C has <windows.h>
[00:24:38] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[00:24:43] <WindowsBunny> vikaton: Ah, you mean winapi, yes
[00:24:51] <WindowsBunny> That's my crate ;)
[00:24:57] <WindowsBunny> erm, crates rather
[00:24:57] <vikaton> o
[00:25:02] <WindowsBunny> all 421 of them
[00:25:03] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[00:25:10] <Clay> WindowsBunny, Dabo, Wouldn't self already be &mut?
[00:25:14] <vikaton> WHAT
[00:25:21] <Dabo> Clay, yes, but self.char_iter wouldn't
[00:25:21] <vikaton> 421 crates!?!
[00:25:23] <WindowsBunny> Clay: It's not self, it is self.char_iter
[00:25:34] <WindowsBunny> vikaton: I uh, made a crate for every single .lib in the windows SDK
[00:25:51] *** Quits: pyon (pyon@moz-q54.3e2.7.179.IP) (Ping timeout: 121 seconds)
[00:25:53] <Dabo> &mut self.char_iter is essentially equal to `&mut ((*self).char_iter)`
[00:26:12] <vikaton> WindowsBunny: did you reserve Window10 ?
[00:26:24] *** Joins: Guest_ (textual@moz-rutc16.res.rr.com)
[00:26:34] <WindowsBunny> vikaton: For some reason the windows 10 nag hasn't popped up on my system yet
[00:26:35] <Clay> Dabo: that makes sense
[00:26:51] <cholcombe> is it advisable to use &str in my vectors instead of String?  It seems like when I use String I'm doing a lot of cloning
[00:26:59] *** Joins: pyon (pyon@moz-q54.3e2.7.179.IP)
[00:27:03] <vikaton> WindowsBunny: Windows doesnt seem to like you :/
[00:27:31] <WindowsBunny> vikaton: I'm not concerned, reserving doesn't really get you anything special after all
[00:27:35] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[00:27:39] <mbrubeck> cholcombe: Yes, generally if you can use &str then you should.
[00:27:41] <RCIX> yeahhhh
[00:27:42] <RCIX> found one
[00:27:43] <vikaton> WindowsBunny: its freeeeeeeeeeeeee
[00:27:44] <WindowsBunny> vikaton: And I want to make sure there are stable gpu drivers first before I update
[00:27:44] <RCIX> awesome
[00:27:53] <cholcombe> mbrubeck: awesome.  
[00:28:20] <RCIX> i feel like i should write a mini guide somewhere
[00:28:21] <RCIX> or something
[00:28:22] <WindowsBunny> vikaton: But yeah, if you need any of winapi, https://github.com/retep998/winapi-rs
[00:28:24] <RCIX> not that its guide worthy
[00:28:26] *** Quits: Diggsey (diggsey@moz-8jb74a.dsl.pipex.com) (Ping timeout: 121 seconds)
[00:28:30] <WindowsBunny> vikaton: If something is missing, just tell me
[00:28:37] <vikaton> Ok
[00:28:38] <WindowsBunny> vikaton: As in, something you need
[00:28:38] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:28:47] <WindowsBunny> Don't tell me about things that are missing that you don't need :P
[00:28:49] *** Joins: Diggsey (diggsey@moz-sfmu28.dsl.pipex.com)
[00:29:07] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:29:40] <vikaton> WindowsBunny: I'm writing a keylogger >:D
[00:29:52] <WindowsBunny> vikaton: Sounds exciting!
[00:29:54] *** Quits: rovar (rovar@moz-6iq.47m.88.38.IP) (NickServ (RECOVER command used by rovar_))
[00:29:54] *** rovar_ is now known as rovar
[00:30:07] *** Joins: rovar_ (rovar@moz-6iq.47m.88.38.IP)
[00:30:14] *** Quits: kgrandon (Adium@moz-m07.96d.170.166.IP) (Quit: Leaving.)
[00:30:18] <vikaton> WindowsBunny: I have a C++ and Nim version, wanted to see what it's like in Rust
[00:30:31] <pancake> i have an [u8;1024] where i use it in a read(), how can i get the 'subarray' containing only the filled ones?
[00:31:18] <WindowsBunny> vikaton: Well, you still have the same winapi, with the same names and stuff
[00:31:35] *** Quits: meh (meh@moz-r52fil.42-151.net24.it) (Ping timeout: 121 seconds)
[00:31:39] *** Quits: eric_lagergren (barsonme@moz-hshokg.q6t2.2174.0008.2601.IP) (Quit: Leaving)
[00:31:50] *** Quits: sfalcon (textual@moz-jqf.n3j.210.209.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:31:56] <vikaton> we shall see
[00:32:19] <cholcombe> mbrubeck: how do you convert a usize to a str?
[00:32:20] <bluss> pancake: slicing. let subarray = &mut buf[..read];   // wheree `read` is the number of bytes reead
[00:32:24] <WindowsBunny> vikaton: This is what winapi heavy code looks like in Rust https://github.com/retep998/dojob-rs/blob/master/src/main.rs
[00:32:46] <mbrubeck> cholcombe: Like 123 -> "123"?
[00:32:51] <cholcombe> yeah
[00:32:57] <mbrubeck> playbot: format!("{}", 123usize)
[00:32:58] <bluss> pancake: slicing syntax is &mut buf[a..b] or &buf[a..b] where indices a and b and be omitteed if you want to
[00:32:58] -playbot- "123"
[00:33:07] <cholcombe> oh
[00:33:12] <cholcombe> easy :)
[00:33:21] <vikaton> WindowsBunny: are these dynamically called be default?
[00:33:31] <WindowsBunny> vikaton: ?
[00:33:33] <mbrubeck> playbot: 123.to_string() // cholcombe: this also works
[00:33:35] -playbot- "123"
[00:33:44] <cholcombe> :)
[00:34:02] <lu324> i wanted to ask, how is event-driven programming normally done with rust?
[00:34:04] <pancake> src/lib.rs:145:27: 145:38 error: ..
[00:34:06] <lu324> it seems like if you want objects with events that call methods of other objects, rust's lifetime and ownership hierarchy become extremely limiting
[00:34:09] <vikaton> like GetProcAddress(LoadLibrary("User32.dll"), "MessageBox")
[00:34:21] <vikaton> then you call LoadWindowsA and such
[00:34:22] <lu324> for example: https://play.rust-lang.org/?code=%2F%2F%20This%20code%20is%20editable%20and%20runnable!%0Afn%20main()%20%7B%0A%20%20%20%20%2F%2F%20A%20simple%20integer%20calculator%3A%0A%20%20%20%20%2F%2F%20%60%2B%60%20or%20%60-%60%20means%20add%20or%20subtract%20by%201%0A%20%20%20%20%2F%2F%20%60*%60%20or%20%60%2F%60%20means%20multiply%20or%20divide%20by%202%0A%0A%20%20%20%20let%20program%20%3D%20%22%2B%20%2B%20*%20-%20%2F%22%3B%0A%20%20%20%20let
[00:34:22] <lu324> %20mut%20accumulator%20%3D%200%3B%0A%0A%20%20%20%20for%20token%20in%20program.chars()%20%7B%0A%20%20%20%20%20%20%20%20match%20token%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%2B%27%20%3D%3E%20accumulator%20%2B%3D%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27-%27%20%3D%3E%20accumulator%20-%3D%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27*%27%20%3D%3E%20accumulator%20*%3D%202%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%2F%27%20%3D%3E
[00:34:22] <lu324> %20accumulator%20%2F%3D%202%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_%20%3D%3E%20%7B%20%2F*%20ignore%20everything%20else%20*%2F%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20println!(%22The%20program%20%5C%22%7B%7D%5C%22%20calculates%20the%20value%20%7B%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20program%2C%20accumulator)%3B%0A%7D%0A&run=1
[00:34:32] <WindowsBunny> lu324: NO, BAD, USE THE SHORTEN BUTTON
[00:34:32] <vikaton> lu24, shorten pls ty
[00:34:40] <RCIX> suddenly, wall of link
[00:34:54] <posix4e> lu324: I assume you mean event triven gui programming
[00:35:00] <WindowsBunny> vikaton: the functions are all linked at link-time
[00:35:05] <WindowsBunny> vikaton: They're not dynamically loaded
[00:35:07] <lu324> http://is.gd/ZYEHj8
[00:35:09] <vikaton> o
[00:35:10] <vikaton> k
[00:35:13] <posix4e> lu324: Or is something like futures/mio/eventual what you are looking for?
[00:35:16] <lu324> there, i didn't notice that the link is so long
[00:35:32] <lu324> posix4e, yes, i mean like gui programming
[00:35:38] <WindowsBunny> vikaton: Of course the linker only links the functions that are actually referenced in your code somewhere
[00:35:49] <posix4e> lu324: Sorry I am gui-capped
[00:36:07] *** Parts: wolfviking0 (wolfviking0@moz-8hd.3b6.246.162.IP) ()
[00:36:11] *** Quits: michas (michas@moz-ts7pe6.web.vodafone.de) (Connection closed)
[00:36:11] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:36:54] <huon> WindowsBunny: shouting was unnecessary
[00:37:08] <WindowsBunny> huon: Sorry
[00:37:10] <fkaa_> how do you build dll with cargo?
[00:37:14] <fkaa_> gettin rlib
[00:37:21] <pancake>  the type `[u8]` cannot be indexed by `core::ops::Range<i64>`
[00:37:24] <WindowsBunny> fkaa_: Do you _really_ want a dll?
[00:37:29] <lu324> specifically, since rust objects can't contain references to themselves, then how can i (for example) have a gui toolkit where pressing a button changes its label?
[00:37:32] <fkaa_> need to load it from java, so yes
[00:37:45] <WindowsBunny> fkaa_: There's a crate_type attribute that you set to dylib
[00:38:03] <lu324> the button would need to have a reference to the callback, which would need to have a reference to the button, but as i understand this is not allowed?
[00:38:28] <wrl> i want to know about this circular reference thing too, the lack of them is biting me pretty hard on a project
[00:38:28] <WindowsBunny> huon: Next time I'll be sure to hold in the shout and then sneak into your house and shout there
[00:39:15] <vikaton> welp, here goes nothing
[00:39:21] <mbrubeck> lu324: One solution when you start needing circular references is to use Rc...
[00:39:43] *** Joins: dpc (dpc@moz-t6gr4b.ca.comcast.net)
[00:39:45] <mbrubeck> though then you also start needing interior mutability (RefCell), and start losing some of Rust's static guarantees. :/
[00:39:47] <fkaa_> WindowsBunny: still rlib
[00:39:49] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:39:53] <fkaa_> #![crate_type="dylib"]
[00:40:02] <huon> fkaa_: you need to set it in your Cargo.toml
[00:40:07] <fkaa_> oh
[00:40:14] <huon> [lib] name = "..." crate_type = ["dylib"]
[00:40:19] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:40:19] <agmcleod> well, i'm feeling quite newby :). I have a module file here; https://github.com/agmcleod/timetrack-rust/blob/master/src/command.rs. And pull it in here: https://github.com/agmcleod/timetrack-rust/blob/master/src/main.rs#L3, however the Command struct won't resolve
[00:40:23] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[00:40:27] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[00:40:58] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:41:20] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[00:41:21] *** Joins: choplin (choplin@moz-qkm9un.ap.nuro.jp)
[00:41:24] <huon> agmcleod: what's the error message?
[00:41:25] *** Quits: eckhardt (eckhardt@moz-s9e.ov1.227.199.IP) (Quit: Leaving...)
[00:41:31] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:41:38] <wrl> mbrubeck: yeah i've seen some mention of Weak
[00:41:39] <agmcleod> huon error: unresolved import `command::Command`. There is no `Command` in `command`
[00:41:52] <huon> agmcleod: oh, that module structure means it's nested like `command::command::Command`
[00:42:06] <huon> agmcleod: i.e. you don't need the mod command { ... } inside the command.rs file
[00:42:13] <agmcleod> oh is it automatic?
[00:42:21] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:42:43] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:42:49] <huon> the `mod command;` in main.rs makes a module called `command` containing the contents of `command.rs`
[00:43:22] <huon> (it's essentially the same as writing `mod command { /* contents of command.rs */ }` inline in main.rs)
[00:43:40] *** Joins: kgrandon (Adium@moz-q8jv71.hjek.d045.0009.2601.IP)
[00:43:55] <vikaton> WindowsBunny: this may be the only obstacle https://github.com/Vikaton/nim-keylogger/blob/master/src/main.nim#L11
[00:44:25] <agmcleod> ah okay. thanks :)
[00:44:29] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[00:44:30] <cholcombe> mbrubeck: now i have a slew of lifetimes that are too short from the &str conversion :)
[00:44:51] <WindowsBunny> vikaton: ShowWindow is in user32
[00:45:14] *** Quits: maurer (maurer@moz-7i6vs5.ECE.CMU.EDU) (Ping timeout: 121 seconds)
[00:46:43] *** Joins: maurer (maurer@moz-7i6vs5.ECE.CMU.EDU)
[00:47:10] *** Quits: Guest_ (textual@moz-rutc16.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:47:13] *** Joins: m_kato (m_kato@moz-86b4bs.bitcat.net)
[00:47:19] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[00:47:36] *** chmanchester is now known as chmanchester|afk
[00:48:01] *** Quits: demilux (demilux@moz-fk1.kt4.14.64.IP) (A TLS packet with unexpected length was received.)
[00:48:01] <RCIX> ok im confused
[00:48:16] <RCIX> in my main class i have pub struct Ball {...}
[00:48:26] <RCIX> in app.rs in the same directory i use the Ball struct
[00:48:37] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:48:41] <RCIX> but im getting a "error: use of undeclared type name Ball"
[00:48:42] <vikaton> WindowsBunny: oh so I need user32 instead of winapi?
[00:48:52] <WindowsBunny> vikaton: winapi provides types and constants
[00:49:04] <WindowsBunny> vikaton: and then each -sys crate provides the functions for a specific library
[00:49:04] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[00:50:12] <vikaton> WindowsBunny: may I see an example of using user32?
[00:50:12] *** Joins: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net)
[00:51:11] <WindowsBunny> vikaton: in Cargo.toml in your dependencies, `user32-sys = "*"`, and in your code `extern crate user32;` and `user32::ShowWindow(...)`
[00:51:12] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:51:14] <lu324> mbrubeck, it does seem like like the only solution other than unsafe code is Rc, but that still needs weak pointers to avoid memory leaks, and extra code to unwrap the weak pointers each time they're used
[00:51:22] <vikaton> ooo
[00:51:28] <RCIX> oh well
[00:51:32] <RCIX> source files for everythingg
[00:51:45] *** Joins: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP)
[00:51:55] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:52:25] <WindowsBunny> RCIX: app.rs is a separate module
[00:52:38] <WindowsBunny> RCIX: And each module has its own namespace basically
[00:52:38] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[00:52:39] <RCIX> i gathered :P
[00:52:50] <RCIX> thus, pub, and using main::*; wasnt working
[00:52:59] <cholcombe> gah, i can't think of a way to use a for loop to push a vec<&str> to another vec and have it live long enough
[00:53:07] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[00:53:17] <cholcombe> my variables go out of scope and get destroyed after the loop
[00:53:18] <WindowsBunny> RCIX: recursive glob imports don't work
[00:53:23] <RCIX> ah
[00:54:01] <RCIX> well breaking stuff out
[00:54:06] <RCIX> seems to be happy
[00:54:51] <WindowsBunny> vikaton: Oh, I remember, you're the one asking about what powerful means :P
[00:55:28] <vikaton> WindowsBunny: yeah I remember u
[00:55:38] <vikaton> WindowsBunny: http://prntscr.com/7ch8ja :))))))))
[00:55:47] *** Quits: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP) (Ping timeout: 121 seconds)
[00:56:02] <vikaton> why is it that explicit...
[00:56:20] *** Quits: Layl (Layl@moz-65hqmf.direct-adsl.nl) (Quit: Leaving)
[00:57:00] <WindowsBunny> vikaton: First of all, 0 does not function as a pointer, you have to use ptr::null() or ptr::null_mut()
[00:57:46] <WindowsBunny> vikaton: Secondly, strings are fancy fat pointer types, and they are not null-terminated either
[00:57:57] <WindowsBunny> so you definitely can't pass a string directly in
[00:58:27] *** gaye is now known as gaye|sleep
[00:58:29] *** Joins: Guest22 (textual@moz-jt9juk.fibertel.com.ar)
[00:58:39] <vikaton> ( ._.)
[00:58:50] *** Quits: Wild_Cat (Max@moz-1idsr5.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[00:58:55] <WindowsBunny> vikaton: Hey, these are very raw bindings, they haven't been wrapped for ease of use :P
[00:59:03] <vikaton> (._. )
[00:59:04] *** Joins: grant (grant@moz-jfh.0nq.187.64.IP)
[00:59:13] *** Quits: cakecatz (cakecatz@moz-rakufn.sannet.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:59:52] <WindowsBunny> vikaton: Don't worry, you can uh, add a manual \0 to the end of your string literal, and call .as_ptr() on the string to get a raw pointer
[01:00:36] *** Joins: indefini (indefini@moz-4p4v25.ucom.ne.jp)
[01:00:38] <WindowsBunny> vikaton: Although it expects *const i8, while as_ptr on str returns *const u8, so you'll have to pointer cast
[01:00:57] <Dabo> CString works well with C strings afaik
[01:01:13] <WindowsBunny> Although really, if you're working with winapi, you probably want to use the W versions
[01:01:13] *** Quits: thor1 (thor@moz-n7n1a4.res.rr.com) (Ping timeout: 121 seconds)
[01:01:17] <Dabo> to_bytes_with_nul() in particular gives you a byte reference with null
[01:01:19] *** Joins: niconii (nicole@moz-r8dlmh.frgo.qwest.net)
[01:01:19] *** ChanServ sets mode: +o niconii
[01:01:19] <vikaton> Dabo, that's how I would usually do it in Nim, just cast ot a cstring
[01:01:21] <WindowsBunny> and then use OsString combined with encode_wide and friends
[01:01:38] <vikaton> to*
[01:02:38] *** Joins: lukes386 (uid17144@moz-31nhqa.highgate.irccloud.com)
[01:03:56] <WindowsBunny> vikaton: CString::new("blah").as_ptr()
[01:04:44] <vikaton> I think Rust is just too explicit for me
[01:04:54] <Dabo> it is very explicit at this point
[01:05:01] *** Joins: zhuli (zhuli@moz-d2d.7sg.64.112.IP)
[01:05:02] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:05:09] *** Joins: zcourts (zcourts@moz-dcf.615.105.122.IP)
[01:05:10] <vikaton> eh, I've tried Rust in other areas
[01:05:16] <vikaton> maybe it's just my luck :)
[01:05:28] <Dabo> I think one of the reasons for that is that it's backwards compatible to add more implying to the compiler, but not to remove it
[01:05:36] <WindowsBunny> vikaton: It's not hard to write wrappers for winapi methods to make it convenient to take strings directly
[01:05:46] <WindowsBunny> vikaton: It's just that nobody took the effort to do that yet
[01:07:03] <WindowsBunny> Its mostly tedious, reading the docs, checking the SAL annotations
[01:07:29] <vikaton> mhm
[01:07:30] *** Joins: Guest_ (textual@moz-rutc16.res.rr.com)
[01:07:42] <RCIX> sort of a public question, or rather 2
[01:08:00] *** Quits: SerialVelocity (SerialVeloc@moz-attia0.cable.virginm.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:08:05] <RCIX> 1. would it be of value to put up information on how i got gdb debug working for x64 windows
[01:08:08] *** Quits: slurps-mad-rips (slurps-mad-@moz-o2c.uaj.44.17.IP) (Quit: Connection reset by bear)
[01:08:08] *** Joins: Wild_Cat (Max@moz-1idsr5.dsl.teksavvy.com)
[01:08:11] <RCIX> 2. where would i do it if so
[01:08:14] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:08:31] <WindowsBunny> RCIX: It's called install mingw correctly :P
[01:08:32] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[01:08:32] *** Joins: esclear_ (esclear@moz-6nc02i.dip0.t-ipconnect.de)
[01:08:50] <RCIX> theres no binarys version of mingw 64bit though as far as i can tell :(
[01:08:59] <WindowsBunny> uh, yes there is?
[01:09:03] <RCIX> i couldnt find em
[01:09:04] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[01:09:05] <WindowsBunny> :|
[01:09:20] <RCIX> im using another toolchain
[01:09:27] <RCIX> that appears to duplicate the functionality
[01:09:34] <WindowsBunny> RCIX: Most people use msys2
[01:09:37] <RCIX> idk maybe its a wrapper around mingw ¯\_(ツ)_/¯
[01:09:46] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:09:51] <WindowsBunny> and msys2 has packages for 64-bit mingw-w64 including gdb
[01:09:58] <RCIX> oh
[01:10:03] <RCIX> i was just trying to use plain mingw
[01:10:09] <WindowsBunny> don't use plain mingw
[01:10:11] <WindowsBunny> use mingw-w64
[01:10:32] <RCIX> ...which i couldnt find non souce packages for
[01:10:33] <WindowsBunny> regular old mingw is ancient and nobody uses it anymore (except weirdos)
[01:10:36] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:10:41] <RCIX> thats what i meant
[01:10:49] <RCIX> i could only find the sources for -w64
[01:10:55] <WindowsBunny> RCIX: http://sourceforge.net/projects/mingw-w64/
[01:11:05] <RCIX> yes thats what im talking about...
[01:11:11] <WindowsBunny> I see a download button
[01:11:13] <WindowsBunny> offering a .exe
[01:11:13] <RCIX> oh
[01:11:15] *** Quits: esclear (esclear@moz-7a6tjp.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[01:11:15] <RCIX> i need
[01:11:16] <RCIX> to 
[01:11:19] <RCIX> read the page
[01:11:21] <RCIX> main one
[01:11:21] <WindowsBunny> yes
[01:11:23] <WindowsBunny> yes you do
[01:11:23] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:11:32] <RCIX> whats a main page tho >.>
[01:11:36] <RCIX> regardless its working for me now
[01:11:38] <RCIX> so off i go
[01:11:58] <rovar> is there a trait for something that can present a &[T] ?
[01:12:10] <huon> rovar: Deref<Target = [T]>
[01:12:16] <huon> rovar: or... Borrow<[T]>
[01:12:18] <geofft> Into? 
[01:12:19] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:12:20] * huon double checks the latter
[01:12:26] <WindowsBunny> RCIX: If you do install mingw-w64, make sure you install threads = win32 and exception = dwarf
[01:12:37] *** Quits: cholcombe (chris@moz-mtfab9.or.comcast.net) (Ping timeout: 121 seconds)
[01:12:40] <WindowsBunny> or uh, exception = seh on 64-bit
[01:12:46] <RCIX> noted
[01:12:57] <huon> rovar: ah, yeah: http://doc.rust-lang.org/nightly/std/borrow/trait.Borrow.html#examples
[01:13:01] <vikaton> I'll give it another shot
[01:13:03] <RCIX> im suing http://tdm-gcc.tdragon.net/
[01:13:05] <RCIX> using
[01:13:06] <reem> rovar: AsRef<[T]> as well
[01:13:07] <RCIX> not suing
[01:13:11] <RCIX> unless it bricks my comp :D
[01:13:15] <WindowsBunny> AsRef is typically the nicest
[01:13:23] * reem agrees
[01:13:24] *** Joins: kermi (Mibbit@moz-cer760.baf.movistar.cl)
[01:13:30] <vikaton> playbot: "97".char()
[01:13:31] -playbot- <anon>:9:14: 9:20 error: type `&'static str` does not implement any method in scope named `char`
[01:13:31] -playbot- <anon>:9         "97".char()
[01:13:31] -playbot- output truncated; full output at: http://bit.ly/1FSuZTd
[01:13:36] <WindowsBunny> AsRef<reem>
[01:13:46] *** Quits: Guest_ (textual@moz-rutc16.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:14:03] <WindowsBunny> vikaton: .chars() is a method that returns an iterator over the unicode codepoints of a string
[01:14:19] <durka42> can you go from a &str to a CString?
[01:14:20] <vikaton> oh right
[01:14:34] <WindowsBunny> durka42: CString::new(mystr)
[01:14:39] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[01:14:42] <durka42> aha
[01:14:44] <durka42> I tried ::from
[01:14:45] <WindowsBunny> durka42: It has to take ownership so it can add a null to the end
[01:14:51] <vikaton> playbot: 97 as char
[01:14:53] -playbot- 'a'
[01:14:58] <vikaton> ayee
[01:15:04] *** Quits: kermi (Mibbit@moz-cer760.baf.movistar.cl) (Quit: http://www.mibbit.com ajax IRC Client)
[01:15:09] <vikaton> playbot: 65 as char
[01:15:10] -playbot- 'A'
[01:15:12] <durka42> that's fine, I am sending it right out to an unsafe laundry eating FFI function :)
[01:15:28] <reem> playbot: 134344 as char
[01:15:29] *** Joins: vmeson (rmacleod@moz-hs5cri.cable.teksavvy.com)
[01:15:30] -playbot- <anon>:9:9: 9:15 warning: literal out of range for u8, #[warn(overflowing_literals)] on by default
[01:15:30] -playbot- <anon>:9         134344 as char
[01:15:30] -playbot- output truncated; full output at: http://bit.ly/1G3B7t9
[01:15:42] <reem> clever
[01:15:44] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:15:51] <WindowsBunny> reem: You can only safely convert u8 values to char, because not all codepoints are valid
[01:15:54] *** Joins: rodrigomc (Mibbit@moz-cer760.baf.movistar.cl)
[01:16:00] <reem> ya, that’s what I was testing
[01:16:02] <rodrigomc> hello
[01:16:10] <reem> hi :)
[01:16:11] <vikaton> are the ints in for loops i32?
[01:16:22] *** Quits: vmeson (rmacleod@moz-hs5cri.cable.teksavvy.com) (Quit: Konversation terminated!)
[01:16:23] <WindowsBunny> durka42: I'll eat your laundry if its reasonably clean
[01:16:24] *** Quits: zcourts (zcourts@moz-dcf.615.105.122.IP) (Client exited)
[01:16:27] *** Joins: fabianvf (fabianvf@moz-fjqmui.va.comcast.net)
[01:16:31] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:16:32] <WindowsBunny> vikaton: Wat?
[01:16:40] <vikaton> for i in 0..10
[01:16:42] <reem> vikaton: if you are iterating over an Iterator of i32s, yes, otherwise no :)
[01:16:49] <WindowsBunny> vikaton: The type is inferred
[01:16:50] <vikaton> Ok
[01:16:57] <durka42> boo
[01:17:02] <reem> vikaton: i32 is the default number type if nothing else specifies it
[01:17:04] <durka42> expected *const u8 found *const i8
[01:17:08] *** Quits: Brochacho (alberto@moz-b2ovno.cable.rcn.com) (Ping timeout: 121 seconds)
[01:17:10] <durka42> is this an unsafe transmute waiting to happen?
[01:17:12] <vikaton> Thanks
[01:17:13] <reem> durka42: as *const i8
[01:17:18] <durka42> ah
[01:17:19] <rodrigomc> Here are all programmers
[01:17:20] <WindowsBunny> vikaton: It'll try to figure out where you use i, and if you use it somewhere that expects a certain type, it'll infer it as that
[01:17:25] <WindowsBunny> vikaton: Otherwise it'll default to i32
[01:17:27] *** Quits: oal (oal@moz-0lm.qc2.255.130.IP) (Ping timeout: 121 seconds)
[01:17:36] <vikaton> File I/O :((
[01:17:39] <durka42> this is getting a little ridiculous
[01:17:40] <durka42> CString::new(uri).unwrap().as_bytes_with_nul().as_ptr() as *const i8
[01:17:58] <WindowsBunny> durka42: Just do CString::new(uri).as_ptr()
[01:18:11] <durka42> oh the as_bytes_with_nul is superfluous?
[01:18:16] <durka42> I thought without that it won't be null terminated
[01:18:29] <WindowsBunny> durka42: CString is always null terminated
[01:18:34] <durka42> I see as_ptr _is_ null terminated but as_bytes isn't
[01:18:55] <WindowsBunny> durka42: as_bytes returns a slice not including the null
[01:18:56] *** Joins: jadbaires (jadrian@moz-dhpu9p.dfcu.o1j7.08a0.2001.IP)
[01:19:00] <durka42> yes
[01:19:03] <WindowsBunny> the null is there in memory after the end of the slice
[01:19:10] <durka42> it's still CString::new(uri).unwrap().as_ptr()
[01:19:26] <durka42> ah and no cast now
[01:19:28] <WindowsBunny> durka42: Well, that's still better :P
[01:19:29] <durka42> well that's less horrible
[01:19:30] <vikaton> if test.json doesnt exist, will let mut file = File::open("text.json").unwrap(); create it?
[01:19:31] <reem> vikaton: just want to emphasize that for loops are not specific to ranges and ranges aren’t specific to for loops - for loops work on anything that implements Iterator and range literals just create an instance of the Range type, which happens to implement Iterator.
[01:19:33] <durka42> I still might write a little macro :)
[01:19:42] *** Parts: rodrigomc (Mibbit@moz-cer760.baf.movistar.cl) ()
[01:19:46] <WindowsBunny> vikaton: no
[01:19:51] <vikaton> reem, thanks
[01:19:53] <WindowsBunny> vikaton: File::create will create it
[01:20:04] <durka42> oh wait that's a function not a macro
[01:20:12] *** Quits: andars (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[01:20:29] *** Quits: fabianvf (fabianvf@moz-fjqmui.va.comcast.net) (Ping timeout: 121 seconds)
[01:20:56] <WindowsBunny> durka42: Note, if you're using winapi, you want OsString instead of CString
[01:21:09] <reem> vikaton: for instance when you do &buf[1..7] you aren’t doing magic, you’re just indexing with an instance of Range, and [T] implements Index<Range>
[01:21:28] <WindowsBunny> reem: Aw, so I'm not a magician? :(
[01:21:34] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:21:39] <XMPPwocky> ... Woah, I just realized how "slicing" works
[01:21:42] <XMPPwocky> that's super neat
[01:21:48] <reem> It really is
[01:22:02] <XMPPwocky> so &[T] is Index<Range> with output = [T]?
[01:22:09] <reem> slicing is magic in almost every other language that has it
[01:22:13] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:22:30] <reem> yup
[01:22:33] <durka42> WindowsBunny: not windows
[01:22:43] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:22:44] <durka42> I'm not that crazy :)
[01:22:55] <WindowsBunny> durka42: Not yet anyway
[01:22:59] <WindowsBunny> >:)
[01:23:04] *** Quits: chao-tic (chao@moz-258.4aj.101.218.IP) (Ping timeout: 121 seconds)
[01:23:09] *** Quits: jadbaires (jadrian@moz-dhpu9p.dfcu.o1j7.08a0.2001.IP) (Ping timeout: 121 seconds)
[01:23:34] <reem> first set of impls here http://doc.rust-lang.org/stable/std/ops/trait.Index.html#implementors
[01:23:48] <reem> WindowsBunny: not until you finish winapi :P
[01:24:19] <WindowsBunny> reem: As if that'll ever be finished :|
[01:24:48] <reem> you can come collect your wand then :)
[01:24:58] <XMPPwocky> just finish it before we get proper C++ interop :P
[01:25:12] <vikaton> how can I append to a file?
[01:25:48] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:25:56] <durka42> yeah I was writing a Rust wrapper around a C wrapper around a C++ library
[01:26:06] <durka42> then digging in the C++ header I found out there is already a C api which the C++ wraps!
[01:26:08] *** Joins: jadbaires (jadrian@moz-dhpu9p.dfcu.o1j7.08a0.2001.IP)
[01:26:16] <durka42> so, ditch two layers :)
[01:26:17] <XMPPwocky> vikaton: http://doc.rust-lang.org/std/fs/struct.OpenOptions.html#append
[01:26:21] <vikaton> I'm never gonna understand rusteceans
[01:26:23] <durka42> it isn't documented but neither is the C++ :/
[01:26:32] *** Joins: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net)
[01:29:05] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:29:50] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[01:30:01] *** Joins: Brochacho (alberto@moz-b2ovno.cable.rcn.com)
[01:30:12] <vikaton> thanks XMPPwocky 
[01:30:19] *** Joins: zyphrus (David@moz-09b.s0u.195.130.IP)
[01:30:22] *** Joins: vmeson (rmacleod@moz-hs5cri.cable.teksavvy.com)
[01:30:26] <durka42> can I ask another FFI question?
[01:30:26] <vikaton> now I need to know how to file.write a char
[01:30:30] <durka42> WindowsBunny seems to be the guy to ask :)
[01:30:33] *** Joins: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP)
[01:30:37] <vikaton> durka42: Of course
[01:30:44] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:30:48] <WindowsBunny> hey, I only do FFI way too much :|
[01:30:55] <durka42> so a function open() takes a T** (T is a type in C)
[01:30:56] <vikaton> I won;t know the answer probably
[01:31:07] <WindowsBunny> durka42: *mut *mut T in Rust
[01:31:08] <durka42> because it "returns" a T*
[01:31:11] <durka42> aha
[01:31:22] <durka42> and then how do I get one from a variable:
[01:31:26] <durka42> s/:/?
[01:31:34] <WindowsBunny> durka42: &mut will implicitly coerce to *mut
[01:31:46] <durka42> struct WrappedT { thing: *libc::c_void }
[01:31:55] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:31:55] <durka42> so, unsafe ( open(&thing) } ?
[01:31:58] <vikaton> is it even possible to file.write() a char?
[01:32:02] <vikaton> thats a variable
[01:32:14] <huon> vikaton: yes, but what encoding?
[01:32:18] <WindowsBunny> durka42: So you do let ptr = std::ptr::null_mut(), and then you pass &mut to the function
[01:32:19] *** Quits: santiago (santiago@moz-8th.j2e.167.12.IP) (Quit: Computer has gone to sleep.)
[01:32:24] <huon> vikaton: e.g. UTF-8?
[01:32:27] *** Quits: vmeson (rmacleod@moz-hs5cri.cable.teksavvy.com) (Quit: Konversation terminated!)
[01:32:28] <vikaton> yes
[01:32:36] <durka42> oh I forgot about null_mut
[01:32:38] *** Joins: zcourts (zcourts@moz-dcf.615.105.122.IP)
[01:32:44] <durka42> bad durka42, get rid of that unsafe mem::uninitialized
[01:32:57] <vikaton> huon I have an i32 e.g 65, and I want to write to file it's char value
[01:33:10] <vikaton> so 65 as u8 as char -> File
[01:33:19] <vikaton> file.txt*
[01:33:23] <huon> vikaton: will you have non-ASCII characters?
[01:33:32] <vikaton> Probably
[01:33:36] <vikaton> I'm not quite sure
[01:34:06] <vikaton> GetAsyncKeyState does bring up some weird chars sometimes
[01:34:27] <huon> if you only get ASCII just casting to a u8 and writing that is fine
[01:34:39] *** Quits: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP) (Ping timeout: 121 seconds)
[01:34:40] <huon> if you get more than ASCII... I guess `write!(x, "{}", c)`
[01:34:41] <WindowsBunny> vikaton: mychar.to_string().as_bytes()
[01:34:48] <WindowsBunny> or that
[01:34:49] <huon> WindowsBunny: that'll allocate
[01:34:52] <WindowsBunny> yeah
[01:34:54] <WindowsBunny> write! is better
[01:35:12] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:35:13] <WindowsBunny> write!(&mut file, "{}", mychar);
[01:36:12] <vikaton> oh swag
[01:36:25] <WindowsBunny> swagalicious
[01:37:34] *** Quits: hjr3 (hradtke@moz-lei.av4.169.69.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:38:33] *** Joins: markstory (textual@moz-tb3ghu.cable.rogers.com)
[01:39:02] *** Joins: hjr3 (hradtke@moz-lei.av4.169.69.IP)
[01:39:12] *** Quits: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net) (Ping timeout: 121 seconds)
[01:39:12] <vikaton> what's a better way of wrting i32 as u8 as char?
[01:39:15] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[01:39:47] <huon> std::char::from_u32(x as u32)
[01:40:00] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:40:04] <huon> you'll need to handle the case if/when x is negative though
[01:40:20] <WindowsBunny> huon: which never happens
[01:40:30] <vikaton> x being i32?
[01:40:33] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:40:37] <WindowsBunny> because the range of valid codepoints does not extend into the negatives :D
[01:40:40] <huon> vikaton: yes
[01:40:42] <WindowsBunny> thanks to utf-16
[01:40:49] <huon> WindowsBunny: I know that 
[01:40:57] <huon> but it's an i32, so it can possibly be negative
[01:41:00] *** Quits: agmcleod (textual@moz-ujm8pm.cpe.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[01:41:06] <huon> (i have no idea of where it is coming from)
[01:41:16] <WindowsBunny> huon: So, from_u32 will return None in that case
[01:41:21] <huon> (there may of course be context that guarantees it'll be positive)
[01:41:27] <huon> WindowsBunny: no, as u32 will panic
[01:41:32] <WindowsBunny> oh right
[01:41:36] *** Quits: maraoz (maraoz@moz-kdk.130.95.181.IP) (Quit: Leaving)
[01:41:37] <WindowsBunny> damn those overflow checks
[01:41:45] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:41:51] <durka42> uh oh
[01:41:58] <vikaton> Really liking Rust's keylogging abilities! http://prntscr.com/7chlzm
[01:41:58] <durka42> why is there no method named "unwrap" on a Result?
[01:42:03] *** Joins: fkaa (tundmatu@moz-501od2.business.telia.com)
[01:42:07] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:42:08] <Mutabah> durka42: There is
[01:42:11] <WindowsBunny> vikaton: You got it working? :D
[01:42:16] <Mutabah> durka42: But the error type must implement Debug
[01:42:17] <vikaton> durka42: becuase its not your birthday yet :[
[01:42:19] <durka42> Mutabah: I know :)
[01:42:22] *** Quits: fkaa_ (tundmatu@moz-vor6or.cust.tele2.se) (Connection closed)
[01:42:42] <vikaton> WindowsBunny: the logging part, now I need to add cases for certain numbers and make it go in stealth mode
[01:42:58] <vikaton> stealth mode is higher priority
[01:43:06] <WindowsBunny> Mutabah: I want a version of unwrap that uses Display
[01:43:11] <vikaton> and I need to unwrap those 'Some(K)'
[01:43:25] <aji> question,
[01:43:26] <WindowsBunny> Mutabah: If only so that IO errors can fucking print out the actual message instead of a simple error code >:(
[01:43:30] <durka42> how can this be? https://gist.github.com/durka/34ce53f0636fcfab20f0
[01:43:41] <aji> sometimes the compiler tells me it expects a type parameter, but got a concrete type instead
[01:44:14] <krdln> durka42: unwrap requires Debug trait on error
[01:44:20] <aji> actually, having just written it out in english, i see what the problem is
[01:44:21] <WindowsBunny> durka42: Does structure::wrapper::OniError impl Debug
[01:44:26] <vikaton> WindowsBunny: is HWND a declared type name in winapi ?
[01:44:32] <WindowsBunny> vikaton: yes
[01:44:35] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Ping timeout: 121 seconds)
[01:44:41] *** Joins: ThatOtherPerson_ (ThatOtherPe@moz-cnq.h78.167.82.IP)
[01:44:50] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[01:44:53] <vikaton> winapi::HWND ?
[01:45:04] <durka42> krdln: aha
[01:45:07] <durka42> no but it's an enum
[01:45:13] <WindowsBunny> vikaton: yes
[01:45:13] <durka42> WindowsBunny: no but it's an enum
[01:45:16] *** Joins: kvsari (kvsari@moz-fgsnv9.bbtec.net)
[01:45:16] <durka42> so I should be able to do that
[01:45:20] *** Joins: vmeson (rmacleod@moz-hs5cri.cable.teksavvy.com)
[01:45:21] <vikaton> wow I'm smart :D
[01:45:29] *** Quits: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net) (Client exited)
[01:45:29] <WindowsBunny> durka42: So go impl Debug
[01:45:34] <durka42> yep that did it
[01:45:35] *** Quits: ThatOtherPerson (ThatOtherPe@moz-vcs.9vv.167.82.IP) (Ping timeout: 121 seconds)
[01:45:37] <krdln> durka42: Just slap #[derive(Debug)] before, it should work
[01:45:44] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:46:11] *** Joins: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net)
[01:46:15] <durka42> yes I did
[01:46:19] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:46:26] <durka42> now I'm looking at the Result documentation to see how I should have known that before asking :)
[01:47:00] <WindowsBunny> durka42: unwrap falls under impl<T, E> Result<T, E> where E: Debug
[01:47:24] <vikaton> what do I need to 'use' to use ptr::null() ?
[01:47:30] *** Joins: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net)
[01:47:31] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[01:47:33] <WindowsBunny> vikaton: use std::ptr;
[01:47:50] <vikaton> tyty
[01:47:59] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:49:05] *** Joins: doomrobo (doomrobo@moz-tj2e6v.261j.6edk.2000.2604.IP)
[01:49:15] *** Joins: phore (phore@moz-p8hanb.cable.rogers.com)
[01:50:43] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[01:51:19] *** Quits: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net) (Client exited)
[01:51:42] *** Quits: Guest22 (textual@moz-jt9juk.fibertel.com.ar) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:51:53] <vikaton> WindowsBunny: where is AllocConsole? :3
[01:51:56] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[01:52:08] *** Quits: zyphrus (David@moz-09b.s0u.195.130.IP) (A TLS packet with unexpected length was received.)
[01:52:24] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Connection closed)
[01:52:27] <WindowsBunny> vikaton: likely in kernel32
[01:52:31] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[01:52:45] <vikaton> do I have to cargo-toml that?
[01:52:56] *** Quits: agile (mike@moz-m71dqt.rcsntx.sbcglobal.net) (Quit: Leaving)
[01:53:32] <WindowsBunny> vikaton: yes
[01:53:38] <WindowsBunny> just like you did with user32
[01:53:53] <vikaton> mhm
[01:54:01] <vikaton> things are going along p well :D
[01:54:15] *** Joins: santiago (santiago@moz-ro2mm9.res.rr.com)
[01:54:21] <WindowsBunny> vikaton: Exciting
[01:54:49] <RCIX> and today we witnessed the birth of a baby malware dev
[01:54:49] <RCIX> :D
[01:55:30] <vikaton> :P
[01:56:02] *** Joins: tmtwd (tmtwd@moz-0kkm5n.cable.rogers.com)
[01:56:08] <WindowsBunny> RCIX: Eh, that's normal for a dev on Windows
[01:56:20] <vikaton> WindowsBunny: it was std::ffi::CString::new("ConsoleWindowClass").unwrap().as_ptr() btw :P
[01:56:35] <WindowsBunny> vikaton: yeah yeah
[01:56:55] <vikaton> looool
[01:57:07] <vikaton> my whole stealth function needs to be unsafe :/
[01:57:26] <WindowsBunny> Well you're doing FFI
[01:57:32] <WindowsBunny> FFI is an unsafe thing
[01:57:37] *** Quits: Rachael (textual@moz-o6m.uvt.22.46.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:57:45] *** Joins: keret (Mibbit@moz-ha6rhm.sd.cox.net)
[01:57:46] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[01:57:47] <durka42> vikaton: shorter :) http://is.gd/fzq0WI
[01:57:59] <vikaton> okay
[01:58:04] <vikaton> here is the moment of truth :D
[01:58:04] *** Quits: hjr3 (hradtke@moz-lei.av4.169.69.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:58:08] <durka42> c_str("ConsoleWindowClass")
[01:58:19] <WindowsBunny> durka42: That won't work
[01:58:27] <durka42> wait, it won't?
[01:58:29] <WindowsBunny> durka42: Because the CString will be dropped before the end of the function
[01:58:29] <durka42> it compiles :(
[01:58:44] <WindowsBunny> So the *const i8 will be pointing to invalid free'd memory
[01:58:48] <vikaton> well it compiles
[01:58:50] <durka42> oh
[01:58:51] <vikaton> and it works!
[01:58:55] <WindowsBunny> durka42: Of course it compiles, its a raw pointer
[01:58:57] <durka42> macro it is then!
[01:59:00] <WindowsBunny> raw pointers have no lifetime checks
[01:59:07] <vikaton> but the output is....
[01:59:08] <durka42> yeah
[01:59:16] <vikaton> ...weird....
[01:59:19] <WindowsBunny> It _might_ run correctly
[01:59:33] <WindowsBunny> but you're basically reading memory after it was freed
[01:59:36] <WindowsBunny> which is a bad idea
[01:59:55] <WindowsBunny> baaaaaaaaaad idea
[02:00:10] <durka42> yes I know, I do know C++ :)
[02:00:11] <durka42> new plan http://is.gd/xGO4GU
[02:00:18] <vikaton> when task manager doesnt respond so you open another task manager to close the other one :)
[02:00:20] <huon> WindowsBunny: you'll be feeling sheepish if you do that
[02:00:34] *** WindowsBunny is now known as WindowsSheep
[02:00:41] <WindowsSheep> huon: baaaaaaaaaaaaaaaaaaaaa
[02:00:45] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[02:00:48] <durka42> but if I pass the CString::new incantation to an FFI function as an expression, it lives until the end of the scope?
[02:01:01] <WindowsSheep> durka42: It lives to the end of the statement
[02:01:10] *** Quits: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net) (Ping timeout: 121 seconds)
[02:01:12] <durka42> ok
[02:01:16] <durka42> which in this case would be the function call
[02:01:30] *** Quits: alex (alex@moz-e3so4t.me) (Quit: WeeChat 1.1.1)
[02:01:32] <WindowsSheep> mhm
[02:01:35] <durka42> ok
[02:01:40] <durka42> well I'm glad I tried to show off my function :)
[02:01:43] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[02:01:51] *** Joins: zyphrus (David@moz-09b.s0u.195.130.IP)
[02:02:04] *** Joins: Guest22 (textual@moz-jt9juk.fibertel.com.ar)
[02:02:07] <vikaton> not preferable: http://prntscr.com/7chrkt
[02:02:07] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[02:02:10] <WindowsSheep> durka42: You could have a function return CString, and then call .as_ptr() on the spot
[02:02:43] <durka42> I see
[02:02:44] <durka42> that makes sense
[02:02:49] <durka42> never throw around raw pointers between functions :)
[02:02:55] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[02:03:02] <WindowsSheep> raw pointers are rather unsafe after all
[02:03:35] <WindowsSheep> vikaton: What's your code look like?
[02:03:40] *** Quits: zyphrus (David@moz-09b.s0u.195.130.IP) (A TLS packet with unexpected length was received.)
[02:04:10] <WindowsSheep> vikaton: And what's not preferable about it?
[02:04:26] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (A TLS packet with unexpected length was received.)
[02:04:26] <vikaton> WindowsSheep: I had debug mode on :)
[02:04:34] *** Joins: tristanseifert (tristanseif@moz-r0t7ns.res.rr.com)
[02:04:50] <WindowsSheep> Oh, you were doing {:?} instead of {}?
[02:05:07] *** Joins: ubeatlen1 (david@moz-30lmkk.nh.comcast.net)
[02:05:11] *** Quits: Wild_Cat (Max@moz-1idsr5.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[02:05:13] *** Quits: zz_kimundi (kimundi@moz-6vnj1q.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:05:31] *** Joins: zyphrus (David@moz-09b.s0u.195.130.IP)
[02:05:58] <vikaton> Yeah
[02:06:02] <vikaton> WindowsSheep: https://gist.github.com/467710895531632cdd15
[02:06:18] *** Joins: Guest (textual@moz-rutc16.res.rr.com)
[02:06:48] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[02:07:10] *** Joins: zz_kimundi (kimundi@moz-iru09r.dip0.t-ipconnect.de)
[02:07:25] <vikaton> time to add cases
[02:07:30] <durka42> dang
[02:07:33] *** zz_kimundi is now known as kimundi
[02:07:33] <WindowsSheep> vikaton: ew, you're capitalizing functions and variable names D:
[02:07:34] <durka42> that's all you need to write a keylogger?
[02:07:35] <durka42> lol
[02:07:50] <vikaton> durka42: Yup, noobjob
[02:08:00] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[02:08:02] <WindowsSheep> durka42: That's because winapi is actually reasonably sane
[02:08:17] <vikaton> WindowsSheep: It was like that in C++
[02:08:19] <vikaton> D:
[02:08:40] *** Joins: aotic (martini_bik@moz-kfjsbq.tulsok.sbcglobal.net)
[02:08:54] <WindowsSheep> vikaton: Follow the rust convention, PascalCase your types and snake_case your functions and variables
[02:09:04] <durka42> I thought some SetWindowsHookEx shenanigans were involved in keylogging
[02:09:11] *** Quits: Guest (textual@moz-rutc16.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:09:22] <vikaton> durka42: if ur rly 1337 then yeah
[02:09:22] <XMPPwocky> i guest to be less detectible
[02:09:27] <XMPPwocky> ack, laptop touchpad
[02:09:34] <XMPPwocky> that's only if you want to be less visible
[02:09:35] <WindowsSheep> anyway
[02:09:40] <WindowsSheep> gnight peeps
[02:09:43] <vikaton> WindowsSheep: done :)
[02:09:46] <keret> snake_case is the only thing I hate about Rust
[02:09:49] <vikaton> Thanks WindowsSheep 
[02:09:55] <durka42> thanks for your help with my FFI noobery
[02:10:06] <durka42> snake_case is the best! :D
[02:10:12] <vikaton> thanks for helping with me noob noobery
[02:10:12] <WindowsSheep> sausage-case
[02:10:21] <durka42> what is this, lisp
[02:10:46] *** Joins: ctennis (ctennis@moz-e8h.r55.39.71.IP)
[02:11:04] <vikaton> when are we getting Nim and Rust interop >:(
[02:11:15] *** Joins: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net)
[02:11:31] <XMPPwocky> vikaton: Nim has zero-cost C ffi, yeah?
[02:11:41] <vikaton> XMPPwocky: yeah
[02:11:45] <XMPPwocky> you'd have to deal with GC rooting, but other than that
[02:11:49] *** Quits: Guest22 (textual@moz-jt9juk.fibertel.com.ar) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:11:49] <XMPPwocky> wait, nim is GCed, right?
[02:11:56] <vikaton> Yes
[02:12:03] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[02:12:08] <vikaton> but I do believe you can delay it forever
[02:12:11] <XMPPwocky> yeah. and then mark all the pointers to GCd things !Send, so boom
[02:12:28] *** Joins: Guest (textual@moz-rutc16.res.rr.com)
[02:12:35] <durka42> I heard the GC can be disabled
[02:12:38] <durka42> but that probably breaks some stuff
[02:13:04] <niconii> vikaton: just a heads-up, you might not want to open and close LOG.txt for each and every character ;)
[02:13:09] *** Quits: ubeatlen1 (david@moz-30lmkk.nh.comcast.net) (Ping timeout: 121 seconds)
[02:13:38] <keret> Snake Case: copy type, paste as variable name, insert underscores, then you get to go back and correct one or more capitalizations
[02:13:40] <keret> Camel: copy type, paste as variable name, change one character to lower case
[02:14:10] <keret> snake_case is great!
[02:14:19] *** Quits: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca) (Ping timeout: 121 seconds)
[02:14:22] *** Joins: forgottenone (forgottenon@moz-hll.04i.45.92.IP)
[02:14:23] *** Joins: logan_e (logan_e@moz-ltn.qg3.218.73.IP)
[02:14:38] *** Joins: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca)
[02:14:38] <XMPPwocky> maybe it's just me, but my variable names are short enough that typing them is faster than going to look for a type of the same name, even with vim motions
[02:14:54] <durka42> http://www.vim.org/scripts/script.php?script_id=3046 :p
[02:15:03] <vikaton> niconii: why?
[02:15:13] <vikaton> niconii: does that crash the program?
[02:15:38] <niconii> vikaton: no, it's just slow to constantly open and close it all the time
[02:15:59] <vikaton> oh you mean that kind of open
[02:16:03] <vikaton> i thought you meant me as the user
[02:16:22] <niconii> vikaton: ah, no, i mean your program
[02:16:39] <vikaton> niconii: better method of saving/
[02:16:41] <vikaton> ?*
[02:17:01] *** Quits: lucian (lucian@moz-2c3pda.cable.virginm.net) (A TLS packet with unexpected length was received.)
[02:17:42] <niconii> vikaton: anyway, some other approaches might be to just keep the file open the whole duration of the program and write to it, or to store up several characters in a buffer before writing them all at once
[02:18:03] <vikaton> I see
[02:18:18] *** Joins: irobevjodu (ident@moz-5bq.k90.254.5.IP)
[02:18:44] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Quit: AHHHHH BEES)
[02:19:21] <vikaton> niconii: like http://is.gd/24FMzJ ?
[02:19:47] <Gankro> ;_; there's no more checked_add?
[02:19:51] <niconii> vikaton: right
[02:19:53] <Gankro> err
[02:19:56] <Gankro> CheckedAdd
[02:19:57] <Gankro> That is
[02:20:57] <tschottdorf> can  I guard a `use xyz;` statement so that it's only included when building the tests?
[02:20:59] <niconii> Gankro: nope, looks like it's in the num crate though
[02:21:42] <Gankro> Hrm... pulling in num is probably easier for this quick work
[02:21:46] <niconii> tschottdorf: i think so, but why?
[02:21:51] *** Joins: Racquetball (namestolenw@moz-1ltgc0.res.rr.com)
[02:21:55] <RCIX> tschottdorf, have you looke at the #[cfg(test)]
[02:22:11] <tschottdorf> niconii, just want to avoid an unused dependency when not building the tests.
[02:22:48] *** Quits: tmtwd (tmtwd@moz-0kkm5n.cable.rogers.com) (Connection closed)
[02:22:55] <niconii> tschottdorf: `#[cfg(test)] use xyz;` should work as RCIX said
[02:23:59] *** Quits: meunierd (dmeunier@moz-glf54u.cpe.sourcecable.net) (Ping timeout: 121 seconds)
[02:24:02] <tschottdorf> RCIX, niconii: Thanks, that does the trick. The docs suggest a `test` child module though, I'll try that - could just put the use there, I think.
[02:24:22] <niconii> tschottdorf: yeah, that's the usual way to go about it
[02:25:32] *** Joins: playjax (chatzilla@moz-jkuk99.optusnet.com.au)
[02:26:28] *** Quits: }ls{ (uhelp@moz-poe133.dip0.t-ipconnect.de) (Quit: User terminated by real life interrupt)
[02:27:23] *** Quits: qwerty_nor (Thunderbird@moz-5ql.sn8.241.50.IP) (Ping timeout: 121 seconds)
[02:28:32] *** Quits: sw17ch (sw17ch@moz-h64l8d.wa.comcast.net) (Client exited)
[02:28:56] *** Quits: kgrandon (Adium@moz-q8jv71.hjek.d045.0009.2601.IP) (Quit: Leaving.)
[02:29:18] *** Quits: Gyro (gyro@moz-38c.96l.252.66.IP) (Ping timeout: 121 seconds)
[02:30:45] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[02:31:19] <Mutabah> Are there any types that can generate 3 or more word fat pointers?
[02:32:31] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:33:09] *** Quits: Clay (Mibbit@moz-o7k96m.dc.cox.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:34:59] *** Joins: rmgk_ (ragnar@moz-jj1v0e.dyn.telefonica.de)
[02:35:28] *** Joins: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP)
[02:35:42] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[02:38:27] *** Quits: rmgk (ragnar@moz-oo85mg.dyn.telefonica.de) (Ping timeout: 121 seconds)
[02:39:02] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[02:39:12] *** Joins: Guest_ (textual@moz-lmfinb.fios.verizon.net)
[02:39:33] *** Quits: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP) (Ping timeout: 121 seconds)
[02:40:25] *** Joins: demilux (demilux@moz-73qa6c.wa.comcast.net)
[02:40:46] *** Joins: chao-tic (chao@moz-258.4aj.101.218.IP)
[02:40:54] *** Joins: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP)
[02:43:29] *** Joins: eddyb (eddyb@moz-c0q.mv7.25.188.IP)
[02:43:49] *** Quits: alaska (alaska@moz-8bdjem.fios.verizon.net) (Connection closed)
[02:44:56] *** Quits: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP) (Ping timeout: 121 seconds)
[02:45:15] *** Joins: alaska (alaska@moz-8bdjem.fios.verizon.net)
[02:46:19] *** Quits: nollidj (stu@moz-19n55r.sdf.org) (Ping timeout: 121 seconds)
[02:46:31] <ChrisMorgan> Mutabah: at present it’s just trait objects (data, vtable) and slices (data, len), but I expect Rust reserves the right to make arbitrarily large fat pointers.
[02:47:22] *** Joins: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net)
[02:48:55] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[02:49:11] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:49:29] <Mutabah> ChrisMorgan: So, I guess I'm safe for now just asserting that sizeof(fat_ptr) == 2 words
[02:49:41] <eddyb> Mutabah: please don't be lazy about it :P
[02:50:13] <ChrisMorgan> Mutabah: if you *must* depend on it (which I would be very leery of), then definitely keep an assertion in there.
[02:50:17] <eddyb> this kind of thinking makes it non-trivial for us to implement TraitA+TraitB
[02:50:28] <Mutabah> eddyb: Ah, yes
[02:50:40] <Mutabah> I could probably just start eating into my data reservation I guess
[02:51:04] <eddyb> it's not *harder* to support arbitrarily sized data. some code in trans became simpler (by using copies instead of manual loads and stores)
[02:51:29] <Mutabah> ChrisMorgan: Yeah, I have an assert at the moment that basically says "Bug me if this hits you"
[02:52:30] <Gankro> reem: Hmm... I probably should have pinged you before this, but I just published like 3 new versions of rust-traverse
[02:52:31] <ChrisMorgan> Mutabah: for trait objects on nightly, you could also add assert_eq!(mem::size_of::<T>(), size_of::<std::raw::TraitObject>()); if trait objects cease to have a fixed size I guess that’ll disappear causing a compilation error.
[02:52:36] <Gankro> I kept finding bugs :P
[02:52:46] <eddyb> ChrisMorgan: heh that's smart
[02:52:54] <eddyb> it will probably get deprecated for a bit though
[02:52:58] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[02:53:04] <reem> Gankro: enjoy :)
[02:53:20] <ChrisMorgan> … but if you care about the actual size, make sure you keep in a static size_of comparison, just in case TraitObject’s size changes ☺
[02:53:28] <Mutabah> ChrisMorgan: That's almost what I have
[02:53:46] *** Quits: orangeshark (erik@moz-h88kd4.44tj.56ot.0306.2602.IP) (Quit: Leaving)
[02:53:47] <Gankro> reem: Internal iterators are still faster, in case you were worried
[02:53:47] *** Quits: swgillespie (swgillespie@moz-o29.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:53:54] <Mutabah> Related = Is there a way of getting the data pointer from a fat pointer?
[02:54:01] <Mutabah> (without transmuting to TraitObject)
[02:54:24] <Gankro> Mutabah: I thought you could cast them... I might be misremembering
[02:54:31] *** Joins: hroi (hroi@moz-d273ub.static.netgroup.dk)
[02:54:38] <Mutabah> Gankro: Afaik, you can have fat raw pointers too
[02:54:42] <reem> Mutabah: check out the giant hack in the traitobject crate
[02:54:58] <Gankro> Mutabah: Yeah I meant like cast the raw to a *u8 or something
[02:55:44] *** Quits: silven (quassel@moz-0roor3.priv.bahnhof.se) (Ping timeout: 121 seconds)
[02:55:56] <ChrisMorgan> Mutabah: why don’t you want to transmute to TraitObject? That’s clearly the most correct way of doing it. Are you wanting non-nightly support?
[02:55:56] <eddyb> Gankro: does that even work?
[02:56:02] <Mutabah> reem: So, that just assumes the first word in the pointer is the data pointer?
[02:56:08] *** Joins: silven (quassel@moz-0roor3.priv.bahnhof.se)
[02:56:13] <Mutabah> ChrisMorgan: Nope, generic, can't assume that the pointer is actually fat
[02:56:14] <eddyb> playbot: 0 as *mut Copy
[02:56:15] -playbot- <anon>:8:5: 8:9 error: the trait `core::marker::Sized` is not implemented for the type `core::marker::Copy` [E0277]
[02:56:15] -playbot- <anon>:8     show({
[02:56:15] -playbot- output truncated; full output at: http://bit.ly/1Qo5Hz2
[02:56:29] <eddyb> playbot: 0 as *mut i32 as *mut Send
[02:56:30] -playbot- <anon>:8:5: 8:9 error: the trait `core::marker::Sized` is not implemented for the type `core::marker::Send` [E0277]
[02:56:30] -playbot- <anon>:8     show({
[02:56:30] -playbot- output truncated; full output at: http://bit.ly/1Jjr2em
[02:56:38] <eddyb> playbot: 0 as *mut i32 as *mut Send as *mut i32
[02:56:39] -playbot- <anon>:9:9: 9:47 error: illegal cast; cast from fat pointer: `*mut core::marker::Send` as `*mut i32`
[02:56:39] -playbot- <anon>:9         0 as *mut i32 as *mut Send as *mut i32
[02:56:39] -playbot- output truncated; full output at: http://bit.ly/1Qo5HPB
[02:56:39] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[02:56:42] <ChrisMorgan> Mutabah: transmute_copy
[02:57:06] <eddyb> ChrisMorgan: you can do this with just pointer casts
[02:57:33] <eddyb> playbot: unsafe { *(&(0 as *mut i32 as *mut Send) as *const _ as *const *mut i32) }
[02:57:34] -playbot- <anon>:9:22: 9:48 error: internal compiler error: impossible case reached: bad combination of types for cast
[02:57:34] -playbot- <anon>:9         unsafe { *(&(0 as *mut i32 as *mut Send) as *const _ as *const *mut i32) }
[02:57:34] -playbot- output truncated; full output at: http://bit.ly/1Jjrb1c
[02:57:39] <eddyb> wat
[02:57:47] <eddyb> playbot: unsafe { *(&(0 as *mut i32 as *mut Send) as *const *mut Send as *const *mut i32) }
[02:57:47] <Mutabah> Basically, I want to assert that the first word of the fat pointer is the data pointer
[02:57:48] -playbot- <anon>:9:22: 9:48 error: internal compiler error: impossible case reached: bad combination of types for cast
[02:57:48] -playbot- <anon>:9         unsafe { *(&(0 as *mut i32 as *mut Send) as *const *mut Send as *const *mut i32) }
[02:57:48] -playbot- output truncated; full output at: http://bit.ly/1Qo5Kep
[02:57:49] <ChrisMorgan> Mutabah: transmute_copy::<&Trait, &TraitObject>(&x)
[02:58:10] <Mutabah> wait, I'm an idiot. I have the original type in this function.
[02:58:24] *** Quits: zyphrus (David@moz-09b.s0u.195.130.IP) (Ping timeout: 121 seconds)
[02:58:27] *** Joins: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net)
[02:58:34] *** Quits: hroi (hroi@moz-d273ub.static.netgroup.dk) (Ping timeout: 121 seconds)
[02:58:34] <eddyb> Mutabah: in DSTs, the first word is always the pointer
[02:58:46] *** Quits: ygrek (user@moz-8j9aeu.org.ua) (Ping timeout: 121 seconds)
[02:58:50] <eddyb> and the rest is extra information that you can store somewhere else
[02:58:59] <Mutabah> eddyb: That's strongly defined?
[02:59:31] *** Quits: brianloveswords (brianlovesw@moz-tq78gs.fios.verizon.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:59:34] <eddyb> it's stronger than anything else you've been using. not 100% stable though
[02:59:54] <eddyb> it's going to outlive TraitObject and 2-word DST fat pointers
[03:00:11] <eddyb> Mutabah: you can assert it by casting a raw pointer or something
[03:00:23] <eddyb> but the compiler won't cooperate :P
[03:00:33] <eddyb> playbot: 0 as *mut i32 as *mut Send;
[03:00:35] -playbot- ()
[03:01:02] *** Joins: p1start (p1start@moz-nftjhe.org)
[03:02:30] *** Quits: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net) (Ping timeout: 121 seconds)
[03:03:37] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[03:05:37] <Mutabah> eddyb: Well, I took most of your suggestions and integrated them
[03:05:44] <Mutabah> so it's getting nice and generic ;)
[03:05:45] * XMPPwocky differentiates Mutabah 
[03:05:51] *** Quits: Racquetball (namestolenw@moz-1ltgc0.res.rr.com) (Quit: leaving)
[03:06:49] * Mutabah is exponential, it had no effect
[03:07:05] <eddyb> lies, there's no e in Mutabah
[03:08:18] <vikaton> I;m getting mismatch error on line 14 and 15 https://play.rust-lang.org/?gist=e1617d2a1346e295ac3f&version=stable
[03:08:20] <vikaton> expected () but got Result
[03:08:34] <_habnabit> am i misremembering, or does rust have a bignum in the stdlib? i can't find it searching the docs for 'big'
[03:08:43] <XMPPwocky> _habnabit: not for $LONGTIME
[03:08:49] <_habnabit> oh, okay
[03:09:02] <XMPPwocky> aatch was working on something iirc
[03:09:03] * Havvy applies the vorpal blade to XMPPwocky.
[03:09:16] <XMPPwocky> that was terrifyingly flast
[03:09:17] <_habnabit> yeah, that was going to be my plan B
[03:09:18] *** Quits: frem (uid16862@moz-60b2uv.highgate.irccloud.com) (Quit: Connection closed for inactivity)
[03:09:29] <_habnabit> it was called 'lamp' or something
[03:09:31] <XMPPwocky> i think the old bignum made its way into cargo, but maybe not
[03:09:35] <XMPPwocky> because it was terribly slow
[03:09:41] <_habnabit> ah
[03:09:47] <_habnabit> i don't really care about speed; i just need bignums
[03:10:00] <_habnabit> oh, 'ramp'
[03:10:14] <aatch> _habnabit, there's a basic bignum implementation in the num crate.
[03:10:23] <Havvy> !crate bignum
[03:10:24] <rustbot> Crate 'bignum' does not exist.
[03:10:38] <Havvy> !crate num
[03:10:39] <rustbot> num (0.1.25) - Simple numerics. This crate contains basic arbitrary-sized integer,rational, and complex types. -> https://crates.io/crates/num
[03:10:39] <aatch> _habnabit, if you're fine with using nightly, I'd go with ramp though (and not just because I built it)
[03:10:51] <_habnabit> aatch, i'm already stuck on nightly because of io::set_panic
[03:10:53] <Mutabah> vikaton: Could you pastebin the full output?
[03:11:10] <XMPPwocky> vikaton: are you maybe using try! in main() ?
[03:11:44] <_habnabit> but i'll just go with ramp instead of num
[03:12:08] <aatch> _habnabit, assuming that you only need integers then, ramp is probably the better option.
[03:12:16] *** Joins: joneshf-laptop (joneshf@moz-05a1nm.ucdavis.edu)
[03:12:16] <_habnabit> aatch, any releases, or do i need to point at github?
[03:12:20] <_habnabit> aatch, yep; just integers
[03:12:25] <aatch> !crate ramp
[03:12:26] <rustbot> ramp (0.1.5) - A high-performance multiple-precision arithmetic library -> https://crates.io/crates/ramp
[03:12:31] <_habnabit> a'ight cool
[03:12:48] <SpaceManiac> vikaton: you want the type of the body of the for loop to be ()
[03:12:53] <SpaceManiac> try adding a semicolon after the match
[03:13:41] *** Quits: lukes386 (uid17144@moz-31nhqa.highgate.irccloud.com) (Quit: Connection closed for inactivity)
[03:13:47] <_habnabit> with cargo, is there an operator like python pip's ~= for versions? ~=0.1.5 means '>=0.1.5,==0.1.*'
[03:13:53] <_habnabit> i didn't see anything in the docs
[03:13:57] <niconii> vikaton: the issue is that write! returns a result
[03:14:27] <eddyb> _habnabit: I have seen ~
[03:14:59] <Havvy> The "~" also exists in `npm`.
[03:15:24] <aatch> _habnabit, as you can see it's still pretty early. Feel free to throw issues at the tracker
[03:15:32] <_habnabit> aatch, will do
[03:15:34] *** Quits: idegen (greg@moz-9c4nle.or.frontiernet.net) (Ping timeout: 121 seconds)
[03:15:44] <_habnabit> aatch, i hardly need anything more than multiplication and division though
[03:16:35] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[03:16:45] <vikaton> hmmm
[03:17:50] *** Quits: dardevelin (dardevelin@moz-iogl12.rev.vodafone.pt) (Quit: Leaving)
[03:18:16] *** Quits: krdln (krdln@moz-ohe9vg.dynamic.chello.pl) (Ping timeout: 121 seconds)
[03:18:24] <aatch> _habnabit, multiplication is fine, division has been a thorn in my side though. It should be fine, I have a test that generates 1000 pairs of numbers and checks that the quotient and remainder for "N/D" follow "QD + R == N"
[03:18:27] *** Joins: Wild_Cat (Max@moz-1idsr5.dsl.teksavvy.com)
[03:18:36] <_habnabit> aatch, oh, by nightly, do you mean 'post-1.0.0 nightly'? i just have 1.0.0 and it's failing to compile on `pub const BITS : usize = 32;`
[03:18:41] *** Quits: alaska (alaska@moz-8bdjem.fios.verizon.net) (Quit: Leaving...)
[03:18:50] *** Quits: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net) (Client exited)
[03:19:11] <aatch> _habnabit, ah, yeah, I use associated consts, so... whatever version introduced them.
[03:20:57] *** Quits: choplin (choplin@moz-qkm9un.ap.nuro.jp) (Connection closed)
[03:21:23] *** Joins: Racquetball (namestolenw@moz-1ltgc0.res.rr.com)
[03:21:53] <raph> It would be cool to implement HJ Boehm's exact real arithmetic on top of it.
[03:22:10] *** Joins: kyeah (Mibbit@moz-qbtcmc.NATPOOL.NYU.EDU)
[03:22:15] <aatch> raph!
[03:22:20] <Gankro> bstrie: Who's running rustcamp?
[03:22:22] <raph> It has a very functional style, it would probably work well
[03:22:34] <raph> aatch!
[03:22:49] <aatch> raph, I keep trying to bug you about the markdown stuff, but you haven't been here!
[03:23:03] <raph> i've been insanely busy
[03:23:20] <raph> and the md code is stuck in the approval pipeline, maybe i should bug them
[03:24:36] *** Joins: ajhager (aajhager@moz-mcdsgi.iplsin.sbcglobal.net)
[03:24:45] *** Quits: durka42 (Adium@moz-qsuual.pa.comcast.net) (Quit: Leaving.)
[03:24:56] <raph> email sent
[03:25:16] <towler1> [6~[5~[6~
[03:25:17] *** Quits: jiojiajiu (Guro@moz-trc2j7.asianet.co.th) (Connection closed)
[03:25:21] *** Quits: croyd (croyd@moz-s4v3f7.dyn.grandenetworks.net) (Quit: Leaving...)
[03:25:28] *** Joins: jiojiajiu (Guro@moz-trc2j7.asianet.co.th)
[03:25:56] <Kingsquee> sorry for how ugly this looks, but does anyone have an idea of what's going on? https://gist.githubusercontent.com/Kingsquee/636d47453ae80368467d/raw/7269f31730a846554e04ea42e6dcc4ccb258eadb/ugh
[03:26:10] <Kingsquee> tldr kernel links to scheduler, scheduler uses the time crate
[03:26:27] <Kingsquee> I give it the paths to everything it should need to link to, it throws a cc error
[03:26:48] <raph> the stuck approver is a vice president, but it wouldn't be the first time i've had to bug one :)
[03:26:48] <Kingsquee> cc error only shows linking to the dylibs I passed
[03:26:58] <Kingsquee> which doesn't include time :<
[03:28:13] *** Joins: Nuk9 (Nuk9@moz-8n0hk4.gradstudents.utoronto.ca)
[03:28:27] <Nuk9> how to write a u64 into a file using BufWriter?
[03:28:46] <Nuk9> i tried write_all but it only accepts [u8]
[03:29:05] *** Quits: Racquetball (namestolenw@moz-1ltgc0.res.rr.com) (Quit: leaving)
[03:29:38] *** Quits: xrl (uid1091@moz-f0543s.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[03:30:04] <Havvy> Apostrophes in variables names:  http://is.gd/QRApQW   [Whee]
[03:30:07] *** Quits: Guest_ (textual@moz-lmfinb.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:30:11] <raph> Nuk9: maybe https://github.com/BurntSushi/byteorder ?
[03:32:44] <gsingh93> i have some generated rust code in a folder called gen-rs. if i have some module `foo` in there, can I configure cargo to treat gen-rs as a root directory for modules so I can refer to foo as `foo` not, `gen_cpp::foo`?
[03:32:49] <raph> Also see IntSliceExt as in https://doc.rust-lang.org/std/primitive.slice.html
[03:33:03] <gsingh93> i mean `gen_rs::foo` in that last part
[03:33:39] *** Joins: ajtulloch (ajtulloch@moz-5389o1.kvuk.09sg.010d.2620.IP)
[03:34:08] <raph> oh wait, IntSliceExt seems only to do sign conversions, not between different sizes. I think byteorder is what you want for that.
[03:34:10] *** Joins: krdln (krdln@moz-ohe9vg.dynamic.chello.pl)
[03:36:07] *** Quits: spider-mario (spidermario@moz-ta0.ci0.165.37.IP) (Ping timeout: 121 seconds)
[03:36:30] <_habnabit> aatch, oh i just remembered i also need logarithms, but they don't need to be precise, so a lossy conversion to float would be fine
[03:36:48] *** Joins: spider-mario (spidermario@moz-2l1.r7n.165.37.IP)
[03:36:56] <eddyb> _habnabit: what base?
[03:37:00] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Ping timeout: 121 seconds)
[03:37:05] <_habnabit> eddyb, any, but preferably 256
[03:37:17] <huon> _habnabit: how precise? i.e. will getting the highest set bit be enough?
[03:37:29] <eddyb> log2 is efficiently implementable with bit operations AFAIK
[03:37:37] *** Quits: Guest (textual@moz-rutc16.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:37:43] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[03:37:57] <_habnabit> i think log_2 would be sufficient; the extent of my operation is ceil(log_256(i))
[03:38:11] <_habnabit> huon, does that answer the question?
[03:38:20] <eddyb> next-power-of-256?
[03:38:23] <_habnabit> yeah
[03:38:46] <eddyb> I believe the answer to huon's question is yes :D
[03:38:50] <huon> _habnabit: then, yeah, highest set bit is enough
[03:38:52] <eddyb> it's also pretty damn fast
[03:38:55] <_habnabit> oh okay cool
[03:39:03] <eddyb> probably much faster than converting to a float in the first place
[03:39:10] <_habnabit> heh okay
[03:39:32] *** Joins: Guest (textual@moz-rutc16.res.rr.com)
[03:41:03] *** Quits: tschottdorf (tobias@moz-d021av.aipg.hajb.2000.2604.IP) (Ping timeout: 121 seconds)
[03:41:34] <_habnabit> i guess until this has an actual implementation i could just repeatedly divmod by 256 and count the number of divmods
[03:41:45] <_habnabit> 'good enough'
[03:41:50] <ChrisMorgan> Havvy: I use curly apostrophes in my comments as a matter of habit, but I certainly don’t use them in identifiers.
[03:42:06] *** Joins: kkus (kkus@moz-baj4jj.74.srtnet.com)
[03:42:09] *** Joins: mattico (matt@moz-crdph3.mpls.qwest.net)
[03:42:09] *** Quits: Guest (textual@moz-rutc16.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:42:15] <aatch> _habnabit, dammit, I don't have Shr implemented yet!
[03:42:21] <Havvy> I don't use curly apostrophes anywhere.
[03:42:28] *** Quits: SpaceManiac (Tad@moz-bd3s4o.dyn.suddenlink.net) (Ping timeout: 121 seconds)
[03:42:28] <_habnabit> aatch, oh haha
[03:42:37] <Havvy> I actually had to have play.rust-lang generate that curly apostrophe for me.
[03:42:38] <_habnabit> aatch, i see an impl Shr
[03:42:56] *** Joins: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP)
[03:42:58] <aatch> Oh wait, I do, sorry, was thinking about the remaining bitwise operations I have to do.
[03:43:19] <eddyb> aatch: count leading zeroes :D
[03:43:35] <_habnabit> aatch, is Int::from(2) >> 3 going to be 0?
[03:43:46] *** Joins: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net)
[03:43:51] <aatch> _habnabit, yep.
[03:43:57] <_habnabit> aatch, cool thanks
[03:44:25] <eddyb> IIRC memchr has very fast specialized implementations. I wish LLVM had intrinsics for them
[03:45:00] *** Joins: lenstr (lenstr@moz-qp8.vju.25.171.IP)
[03:45:03] <_habnabit> aw, does Vec not have a reverse iterator?
[03:45:18] <aatch> _habnabit, it does. `vec.iter().rev()`
[03:45:28] *** Joins: mindtree (Mitch@moz-cm4huq.iprimus.net.au)
[03:45:31] <_habnabit> oh, i didn't think reversing iterators would be a general operation
[03:45:45] *** Joins: bkearns (Adium@moz-2l9j31.ca.comcast.net)
[03:45:51] <doomrobo> _habnabit, also vec.reverse() if you wanna mutate it
[03:46:00] <_habnabit> doomrobo, i deliberately don't want to mutate it!
[03:46:06] * doomrobo backs off
[03:46:12] <_habnabit> haha
[03:46:12] <aatch> _habnabit, you can reverse any double-ended iterator.
[03:46:19] <_habnabit> ah, yeah, i just found that trait
[03:46:32] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Connection closed)
[03:46:35] *** Joins: colinsurprenant (colin@moz-q9ee1n.74.electronicbox.net)
[03:47:06] *** Joins: nedp (nedp@moz-vg6vvt.bigpond.net.au)
[03:47:09] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Connection closed)
[03:47:49] *** Quits: chao-tic (chao@moz-258.4aj.101.218.IP) (Ping timeout: 121 seconds)
[03:49:05] *** Quits: lenstr (lenstr@moz-qp8.vju.25.171.IP) (Ping timeout: 121 seconds)
[03:49:56] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[03:50:05] *** nsm|away is now known as nsm
[03:50:09] *** Joins: agmcleod (textual@moz-ujm8pm.cpe.teksavvy.com)
[03:50:24] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[03:50:26] <agmcleod> In 1.0, how can i check if a file exists? given the Path.exists() function is unstable
[03:51:08] <eddyb> agmcleod: look at the implementation
[03:51:09] <Kingsquee> agmcleod: match on File::open?
[03:51:18] <eddyb> fs::metadata(path).is_ok()
[03:51:22] <eddyb> or, what Kingsquee said
[03:51:26] <eddyb> (if you want to open the file)
[03:51:44] <agmcleod> Kingsquee thought about that, but couldn't it error for another reason?
[03:51:49] <agmcleod> permissions for example
[03:52:09] <Kingsquee> the result error should tell you
[03:52:31] <doomrobo> eddyb, isn't metadata in PathExt which is unstable?
[03:52:34] <eddyb> yeah, "file not found" is a specific error
[03:52:37] <eddyb> doomrobo: no it's not
[03:52:41] <eddyb> doomrobo: I said fs::metadata
[03:52:58] <doomrobo> interesting
[03:53:03] <eddyb> PathExt is just wrappers for fs functions
[03:53:18] <doomrobo> oh, that's good news. Now I can get my utility to compile in stable
[03:53:33] <eddyb> (again, docs have a [src] button. very useful if you wonder how something works)
[03:54:08] *** Joins: eric_lagergren (barsonme@moz-lr1hrn.wa.comcast.net)
[03:54:32] <agmcleod> eddyb :)
[03:54:33] <raph> i use that all the time, but imho it's a bit of an open source anti-pattern. shouldn't _have_ to do that
[03:54:48] <agmcleod> raph agreed, but it's nice to have as a backup
[03:55:05] <eddyb> raph: reading the source is an open-source anti-pattern? /:)
[03:55:24] <raph> eddyb: having to read the impl to understand the interface
[03:55:37] <eddyb> you don't have to do that
[03:55:47] <eddyb> you may want to read the impl to understand how it's... implemented
[03:55:55] <eddyb> in case the interface isn't available to you, for example
[03:56:12] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[03:56:18] *** Quits: mattico (matt@moz-crdph3.mpls.qwest.net) (Quit: Leaving)
[03:56:31] *** Joins: wdouglas (user@moz-onm9nb.or.comcast.net)
[03:56:40] <logan_e> is it possible to make arrays that have a variable size?
[03:56:51] <logan_e> like you don’t know what the size of the array is yet
[03:56:53] *** Quits: jakevn (jakevn@moz-0agbgk.miamfl.sbcglobal.net) (Ping timeout: 121 seconds)
[03:56:56] <logan_e> but you know its gonna be fixed
[03:57:10] *** Quits: zcourts (zcourts@moz-dcf.615.105.122.IP) (Client exited)
[03:57:16] <raph> eddyb: well, i'm not gonna argue too vociferously. having the [src] button has been nice
[03:57:44] <huon> using "look at the source" as a substitute for documentation is definitely not great
[03:57:57] <raph> logan_e: i think the answer is basically no, that's what you use Vec for
[03:58:09] <huon> having it in addition to great docs is even greater
[03:58:15] <raph> huon++
[03:58:15] <logan_e> Ok, thanks!
[03:58:21] <aatch> On the other hand, for some people, the only documentation that gives enough detail *is* the source. Like me.
[03:58:30] <niconii> logan_e: what's the context exactly? if you want to use it in a `let` statement or something, no
[03:59:00] <doomrobo> eddyb, why is PathExt unstable? Would it be bad form to make an identical trait and implement it for Path so that I can compile with the stable release?
[03:59:01] <raph> i was thinking about this in the context of manish's blog on wrapper types
[03:59:05] <eddyb> huon: I guess the unstable explanation could give suggestions on what to use
[03:59:09] <raph> i certainly didn't understand them until i read the source
[03:59:27] <eddyb> doomrobo: it's likely to be thrown out in favor of std::fs
[03:59:30] <raph> not to say i _couldn't_ have understood them from reading the docs, that just wasn't my path
[03:59:57] <raph> for my way of understanding, what would have been ideal is little pictures showing the layout of each wrapper in memory
[04:00:05] <huon> eddyb: that's part of what the explanations are designed for
[04:00:07] <eddyb> doomrobo: the latter is stable, so you might as well do that. it's like PathExpr provides any kind of ergonomic wins, does it?
[04:00:11] <huon> eddyb: (i.e. yes)
[04:00:23] <eddyb> huon: right, I meant PathExt in particular
[04:00:27] *** Joins: ygrek (user@moz-8j9aeu.org.ua)
[04:00:29] *** Quits: psy (psy@moz-p6c.hr7.224.43.IP) (Quit: Leaving)
[04:00:33] *** Joins: oberstet_ (quassel@moz-kq82kc.dynamic.mnet-online.de)
[04:00:43] <eddyb> the problem is that improvements won't show up in the 1.0 docs unless they're specially backported
[04:00:54] <eddyb> (and 1.0.1 is released?)
[04:01:04] *** Quits: kyeah (Mibbit@moz-qbtcmc.NATPOOL.NYU.EDU) (Quit: http://www.mibbit.com ajax IRC Client)
[04:01:11] <doomrobo> eddyb, it really is ergonomic and self-documenting. I'd rather write path.is_file() than metadata(path).map(|s| s.is_file()).unwrap_or(false)
[04:01:35] <eddyb> oh, I didn't realize that's what it was doing
[04:01:36] *** Joins: ajtulloc_ (ajtulloch@moz-mj4.ktt.28.204.IP)
[04:01:58] <eddyb> doesn't seem like an entirely good idea to ignore the Err case
[04:03:02] *** Quits: agmcleod (textual@moz-ujm8pm.cpe.teksavvy.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:03:39] <doomrobo> eddyb, my code, which I think is very readable is: if !path.exists() {...} if !path.is_file() {...}. I like how readable it is. So I'll get around it for now but I hope that PathExt doesn't go away
[04:04:04] *** Quits: oberstet (quassel@moz-3a1ft0.dynamic.mnet-online.de) (Ping timeout: 121 seconds)
[04:04:08] *** Joins: chao-tic (chao@moz-258.4aj.101.218.IP)
[04:04:11] <huon> FWIW, checking for file existence before doing something with it (rather than just doing something and checking for errors) is often bad: it exposes a TOCTTOU vector https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use
[04:04:31] <doomrobo> interesting
[04:04:41] *** Quits: ajtulloch (ajtulloch@moz-5389o1.kvuk.09sg.010d.2620.IP) (Ping timeout: 121 seconds)
[04:04:41] *** Quits: jadbaires (jadrian@moz-dhpu9p.dfcu.o1j7.08a0.2001.IP) (Ping timeout: 121 seconds)
[04:05:03] <huon> using the metadata version can also be more efficient, as one can save the result and use it for multiple checks
[04:05:13] <huon> rather than having to hit the kernel for each check
[04:05:22] <wdouglas> Has anybody here tried using the --enable-local-rust configure option?
[04:05:39] <doomrobo> huon, it's so minute though (in my case at least)
[04:06:24] *** Joins: nyx (nyx@moz-ivelpd.res.rr.com)
[04:06:34] <eddyb> doomrobo: I thought you might be doing something like that :P
[04:06:51] <eddyb> the immediate ergonomic win led to inefficient and problematic code
[04:06:58] <eddyb> which isn't entirely obvious
[04:07:35] *** Joins: ajtulloch (ajtulloch@moz-5389o1.kvuk.09sg.010d.2620.IP)
[04:07:47] <eddyb> match fs::metadata(path) { Err(...) => ..., Ok(m) if !m.is_file() => ..., Ok(m) => ... }
[04:07:53] <doomrobo> the problem for me actually goes deeper. I have an error enum for every possible error. So the only time that the NoSuchFile variant is returned is when path.exists() is false
[04:08:25] <doomrobo> If the file is deleted right after I check it, the error will still get caught, but under a different variant. Probably WriteErr
[04:08:41] <eddyb> PathExt::exists is fs::metadata(path).is_ok()
[04:10:34] *** Quits: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net) (Client exited)
[04:10:38] *** Quits: ajtulloc_ (ajtulloch@moz-mj4.ktt.28.204.IP) (Ping timeout: 121 seconds)
[04:10:46] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[04:12:19] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Ping timeout: 121 seconds)
[04:12:25] *** Joins: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net)
[04:12:55] <_habnabit> aatch, to get a usize out of an Int, do i have to go through Int::to_str_radix?
[04:13:03] *** Quits: Wild_Cat (Max@moz-1idsr5.dsl.teksavvy.com) (Ping timeout: 121 seconds)
[04:14:06] <Manishearth> raph: ?
[04:14:21] <cmr> _habnabit: num::Int?
[04:14:28] <_habnabit> cmr, ramp::Int
[04:14:28] <Manishearth> raph: yeah, one thing I want to happen (may do it myself) is to make the docs more self sufficient
[04:14:31] <cmr> Oh
[04:14:50] <raph> Manishearth: more docs is always a good thing :)
[04:14:59] *** Joins: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp)
[04:15:03] <raph> well, more good docs anyway :)
[04:15:36] <Manishearth> raph: I *hated* doing this in Go, and while I was with Rust before we were properly documented (so I learned from [src] exclusively) I don't want us to stay that way
[04:15:39] <Manishearth> raph: PRs welcome :)
[04:15:54] <Manishearth> I'll be upstreaming the wrapper types post into the book sometime this week
[04:16:09] <raph> Manishearth: good for you
[04:16:10] <Manishearth> file issues about unclear stuff and cc me, I might try and fix it
[04:16:11] <cmr> _habnabit: seems like to_single_limb is the winning move to me.
[04:16:26] <raph> I have been tempted to do doc stuff, but right now my day job is taking all my time
[04:16:39] <_habnabit> cmr, oh, indeed
[04:16:40] *** Quits: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP) (Connection closed)
[04:16:50] <raph> i have a post on string types from way back when, even got open source approval for it
[04:17:34] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[04:17:51] <raph> http://levien.com/rust/strings201.html
[04:18:17] <raph> have no idea whether it's still useful; it would need some polishing for 1.0
[04:19:03] *** Quits: tristanseifert (tristanseif@moz-r0t7ns.res.rr.com) (Ping timeout: 121 seconds)
[04:19:14] *** Joins: eckhardt (eckhardt@moz-0b0.bm2.248.98.IP)
[04:19:31] <aatch> _habnabit, you can do `usize::from(&myint)`
[04:19:40] *** Joins: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP)
[04:19:45] *** Quits: turtil (turtil@moz-gfc.es4.23.103.IP) (Quit: WeeChat 1.1.1)
[04:20:03] <_habnabit> aatch, you can..? i didn't see an impl for that; which one is it?
[04:20:09] <cmr> (I also didn't see the impl)
[04:20:19] <aatch> _habnabit, well the impl is on `usize`...
[04:20:26] <cmr> Oh.
[04:20:38] <_habnabit> aatch, oh haha
[04:20:44] <aatch> _habnabit, I though I mentioned it in the docs for Int
[04:21:00] <_habnabit> aatch, oh, yes, you did. i missed it somehow
[04:21:21] <Mutabah> raph: I assume that's yours?
[04:21:40] <raph> Mutabah: the link I posted? yes
[04:21:41] <aatch> _habnabit, yeah, I knew that it wouldn't be very discoverable.
[04:21:44] *** Joins: zyphrus (David@moz-so1.e4q.224.119.IP)
[04:21:45] <Mutabah> raph: The better way nowdays would be to use 'write!(&mut out_str, "{}", value)'
[04:22:00] *** Joins: jinguoli (jinguoli@moz-ut3.hd4.30.218.IP)
[04:22:09] <raph> Mutabah: is that currently efficient?
[04:22:11] <Mutabah> raph: I.e. use the fact that strings can be written to by the formatted output functions to avoid any intermediate allocations
[04:22:17] <raph> I thought it created an intermediate formatter obj
[04:22:28] <Mutabah> Hmm... don't know
[04:22:37] *** Quits: joh (uid13099@moz-2c7ap3.ealing.irccloud.com) (Quit: Connection closed for inactivity)
[04:22:38] <raph> but yes, this was written a while ago, I know it needs updating
[04:23:14] *** Quits: colinsurprenant (colin@moz-q9ee1n.74.electronicbox.net) (Client exited)
[04:23:17] <Mutabah> String impls fmt::Write, so very little intermediate
[04:23:26] *** Quits: red75prime (Mibbit@moz-j30.8r4.78.95.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:23:30] <_habnabit> ah, String::char_at is unstable..
[04:23:43] *** Quits: kimwonyong (kimwonyong@moz-gfp.vhi.163.221.IP) (Ping timeout: 121 seconds)
[04:24:15] <_habnabit> but there is String::chars and Chars::nth
[04:24:17] <raph> Mutabah: cool
[04:24:52] <_habnabit> aatch, error: the trait `core::convert::From<ramp::int::Int>` is not implemented for the type `usize`
[04:25:05] <_habnabit> aatch, the docs mention only i32
[04:25:16] <wdouglas> redshift: Any chance you were able to figure out your problem rebootstrapping rustc?
[04:26:52] <_habnabit> aatch, oh, it needed &Int
[04:27:10] <aatch> _habnabit, heh, blame the bad error message.
[04:27:35] <_habnabit> hmm... if i need random access, perhaps i should use a Vec<char> instead of a String
[04:29:23] *** Joins: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP)
[04:31:04] *** Joins: trecer (textual@moz-pudn0g.dyn.centurytel.net)
[04:31:16] <_habnabit> also i'm slightly disappointed i have to do `for &(ref a, ref b) in ..` instead of just `for (a, b) in ..` when i'm iterating over a &(A, B)
[04:31:45] <raph> Mutabah: the asm for http://is.gd/qJpu4R is still a little scary, but I think it's reasonably efficient
[04:32:35] *** Quits: nyx (nyx@moz-ivelpd.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:33:03] *** Joins: bren2010 (bren2010@moz-356.o3d.198.71.IP)
[04:33:25] *** Quits: sdogruyol (sdogruyol@moz-mdm.mqr.142.195.IP) (Ping timeout: 121 seconds)
[04:33:48] <pzol> Is there anything like AnyMap or TypeMap that would work on enum variants???
[04:34:01] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[04:34:01] <trecer> In the latest nightly, Rust is complaining about casts from *mut T to usize and back. Has there been a change to how this should be done?
[04:34:21] <raph> ie, there are some vtable indirections, but i think nothing like an extra allocation
[04:34:23] *** Joins: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp)
[04:34:53] <mindtree> pzol: a normal hashmap?
[04:35:19] *** Joins: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP)
[04:35:49] <Mutabah> trecer: Depends, is T ?Sized?
[04:36:11] <pzol> mindtree thing is variants are not types and thus have not distinct typeid, hence I'd need some other way to represent the keys
[04:36:11] *** Quits: jinguoli (jinguoli@moz-ut3.hd4.30.218.IP) (Connection closed)
[04:36:30] *** Joins: trecer_ (textual@moz-pudn0g.dyn.centurytel.net)
[04:36:37] <mindtree> pzol: can the variants be the keys?
[04:36:46] *** Joins: jinguoli (jinguoli@moz-6l4.hd4.30.218.IP)
[04:37:01] *** Joins: blue_deref (blue_deref@moz-u9gmm1.res.rr.com)
[04:37:05] *** Joins: KarolisK (karolis@moz-1vd.8s1.28.194.IP)
[04:37:13] <pzol> mindtree the variants themselves... from the domain perspective thats the idea... 
[04:37:14] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[04:37:35] <trecer_> Mutabah: ah yes, I changed that at the same time as I changed to the latest nightly so that might be the issue, not the compiler 
[04:38:12] <Mutabah> trecer_: Possibly a bit of both
[04:38:22] <Mutabah> I'm not too sure how long fat raw pointers have been around
[04:38:46] *** Quits: trecer (textual@moz-pudn0g.dyn.centurytel.net) (Ping timeout: 121 seconds)
[04:39:23] *** Quits: jensnockert (jensnockert@moz-pvj.o2f.219.84.IP) (Ping timeout: 121 seconds)
[04:40:31] <XMPPwocky> Mutabah: since the beginnings of dst, afaik
[04:41:11] *** Quits: cakecatz (cakecatz@moz-u6p4rc.so-net.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[04:43:57] *** Joins: EspressoDan (EspressoDan@moz-gnsthu.dynamic.ashlandfiber.net)
[04:45:40] *** Joins: mr_pants (Mibbit@moz-07p.i4d.129.183.IP)
[04:46:33] *** Quits: mindtree (Mitch@moz-cm4huq.iprimus.net.au) (Ping timeout: 121 seconds)
[04:47:04] *** Joins: mindtree (Mitch@moz-k8kffa.iprimus.net.au)
[04:47:24] *** Joins: Quxxy (chatzilla@moz-efh10q.internode.on.net)
[04:47:26] *** Quits: fyolnish (fyolnish@moz-dvgkni.so-net.ne.jp) (Connection closed)
[04:47:40] <_habnabit> i understand the rationale, but it's still a little sad i can't make my own `impl From<&[u8]> for Int`, haha
[04:48:56] <Mutabah> _habnabit: yeah, I would quite like it if you could have crate-local impls of traits that break coherence
[04:49:04] <Mutabah> but I don't think the compiler has the infrastructure for that
[04:49:15] <_habnabit> Mutabah, and also be able to import such impls from traits?
[04:49:16] *** Joins: zzing (textual@moz-jucm1n.cpe.distributel.net)
[04:49:28] *** Joins: zeittunnel (2342342342@moz-sf7tgj.dip0.t-ipconnect.de)
[04:50:05] <eddyb> Mutabah: it actually is quite capable
[04:50:16] <eddyb> Mutabah: just need to prevent downstream imports of the impl
[04:50:29] *** Quits: zzing (textual@moz-jucm1n.cpe.distributel.net) (Quit: Textual IRC Client: www.textualapp.com)
[04:50:32] <Mutabah> eddyb: Oh? Hmm... sounds like it might be RFC time then
[04:50:34] <eddyb> (by not encoding it in metadata, for example)
[04:51:05] <eddyb> Mutabah: however... what if your code is instantiated in a different crate? #[inline] and generics do that
[04:51:32] <trecer_> Mutabah: so IS there any way to convert a ?Sized pointer to a usize?
[04:51:45] <eddyb> if a method reference statically resolves to your coherence-breaking impl, it will work
[04:51:47] <Mutabah> trecer_: For what purpose?
[04:52:06] <Mutabah> trecer_: Why do you want to remove the extra information from the fat pointer?
[04:52:07] <eddyb> if it's a generic, it's going to bubble up to the point of use
[04:52:11] <eddyb> oh, wait
[04:52:24] *** Joins: KLP (KLP@moz-nclupk.res.rr.com)
[04:52:36] *** Parts: KLP (KLP@moz-nclupk.res.rr.com) ()
[04:52:48] *** Joins: ai (ai@moz-pqofrl.sunline.net.ua)
[04:52:59] <trecer_> Actually I just wanted to print out the pointer value and it doesn't want to print a pointer pointer to an unsized value so it's pretty non-essential, mostly just curious
[04:53:03] <eddyb> Mutabah: #[inline] functions and generics in general will fail to compile or find a different impl, unless it's special-cased
[04:53:20] <Mutabah> eddyb: Yeah, that can be solved, but yes
[04:53:33] <eddyb> I guess that's what you were worried about
[04:53:41] *** Joins: keenan (keenan@moz-nclupk.res.rr.com)
[04:53:45] <eddyb> Mutabah: we used to have a model which would totally allow what you wanted
[04:53:51] <Mutabah> eddyb: (Export the non-coherent impls, but hide them somehow, only using them if a generic uses them)
[04:53:56] <eddyb> but then we switched to on-demand impl selection
[04:54:01] *** Quits: doomrobo (doomrobo@moz-tj2e6v.261j.6edk.2000.2604.IP) (Quit: g'night)
[04:54:08] <eddyb> and the demand happens at the instantiation site
[04:54:13] <Mutabah> ah
[04:54:33] <eddyb> not sure if it's more efficient, but at least is less shitty
[04:54:42] <Mutabah> I guess tagging the generic item with the source crate could allow this to work
[04:54:46] *** Quits: phore (phore@moz-p8hanb.cable.rogers.com) (Ping timeout: 121 seconds)
[04:54:50] *** Quits: Brochacho (alberto@moz-b2ovno.cable.rcn.com) (Client exited)
[04:54:52] <eddyb> it's already "tagged"
[04:54:55] <Mutabah> (so it searches its source crate's impl list)
[04:55:07] <eddyb> Mutabah: oh, actually, that's very much possible
[04:55:20] <eddyb> there's one place in the entire compiler where that matters, AFAIK
[04:55:29] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[04:55:41] *** Joins: jakevn (jakevn@moz-0agbgk.miamfl.sbcglobal.net)
[04:55:57] <eddyb> in the selection code, and that works off a context and the context could have a "source crate ID" param
[04:56:30] <trecer_> looks like casting it to a pointer to a sized type and then casting it to a usize works
[04:56:54] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[04:56:55] *** Joins: cjstevenson (Mibbit@moz-fjb.hgc.51.74.IP)
[04:57:01] <Mutabah> trecer_: You can use the {:p} format code to print a pointer
[04:57:11] *** Joins: zyphrus_ (David@moz-so1.e4q.224.119.IP)
[04:57:42] *** Quits: keenan (keenan@moz-nclupk.res.rr.com) (Quit: http://www.kiwiirc.com/ - A hand crafted IRC client)
[04:58:59] *** Joins: threeve (textual@moz-4cggbb.cicril.sbcglobal.net)
[04:59:11] <XMPPwocky> rusti: let x: *const [u8] = std::ptr::null(); println!("{:p}", x);
[04:59:12] -playbot- <anon>:9:30: 9:44 error: the trait `core::marker::Sized` is not implemented for the type `[u8]` [E0277]
[04:59:13] -playbot- <anon>:9         let x: *const [u8] = std::ptr::null(); println!("{:p}", x);
[04:59:13] -playbot- output truncated; full output at: http://bit.ly/1IbkSKe
[04:59:14] *** Quits: zyphrus (David@moz-so1.e4q.224.119.IP) (Ping timeout: 121 seconds)
[04:59:15] <XMPPwocky> nope
[04:59:17] *** Quits: markstory (textual@moz-tb3ghu.cable.rogers.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[04:59:19] <dpc> There's a function taking MutFn, and in that mutable closure I'd like to pass some variables as mutable borrows, and some as moved variables...
[04:59:23] *** Joins: acamda (adam@moz-nfosdp.iinet.net.au)
[04:59:33] *** Quits: gopar (gopar@moz-jd6o28.m2vj.kpnp.0009.2601.IP) (Quit: Leaving)
[04:59:39] <dpc> Is that possible?
[05:00:00] <XMPPwocky> dpc: you can't move into that closure, no
[05:00:13] <XMPPwocky> unless you only need to use certain things once- then you could use Option stuff
[05:00:17] <dpc> So what do I do? :(
[05:00:18] <trecer_> XMPPwocky: the ptr::null() functions won't generate pointers to unsized types, I don't think
[05:00:27] *** Quits: coryforsyth (coryforsyth@moz-hpsim2.fios.verizon.net) (Client exited)
[05:00:53] <XMPPwocky> rusti: let x: *const [u8] = unsafe { std::mem::transmute<(usize, usize), *const [u8]>((0, 0)) }; println!("{:p}", x);
[05:00:53] -playbot- <anon>:9:73: 9:74 error: expected one of `.`, `;`, `}`, or an operator, found `,`
[05:00:53] -playbot- <anon>:9         let x: *const [u8] = unsafe { std::mem::transmute<(usize, usize), *const [u8]>((0, 0)) }; println!("{:p}", x);
[05:00:53] -playbot- output truncated; full output at: http://bit.ly/1eOuOzq
[05:00:59] <XMPPwocky> hm
[05:01:36] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[05:01:54] *** Joins: ajtulloc_ (ajtulloch@moz-mj4.ktt.28.204.IP)
[05:01:58] *** Quits: qard (qard@moz-nekdha.vc.shawcable.net) (Quit: leaving)
[05:02:06] <dpc> So, I guess my problem is caused by this signature: http://is.gd/sJctfW
[05:02:15] *** Quits: bkearns (Adium@moz-2l9j31.ca.comcast.net) (Quit: Leaving.)
[05:02:42] <dpc> I want a function that will take a function that will construct object with a given argument (token).
[05:02:54] <Mutabah> dpc: FnMut can't own non-copy values
[05:03:05] <dpc> But I don't want to impose any limitations on the function constructing the object.
[05:03:39] <Manishearth> Mutabah: it can
[05:03:46] <Mutabah> Manishearth: Wait, it can?
[05:03:56] <Mutabah> Manishearth: How does that work...
[05:04:37] *** Quits: ajtulloch (ajtulloch@moz-5389o1.kvuk.09sg.010d.2620.IP) (Ping timeout: 121 seconds)
[05:04:37] <Manishearth> let x = Box::new(1);let t: Box<FnMut()> = Box::new(move|| {x;});
[05:04:42] <Manishearth> playbot: let x = Box::new(1);let t: Box<FnMut()> = Box::new(move|| {x;});
[05:04:43] *** Parts: cmr (cmr@moz-35s2fm.members.linode.com) ("WeeChat 0.3.8")
