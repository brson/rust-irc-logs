[00:02:02] <mark_edward> dbaupp: what's the new time
[00:02:23] <MaikKlein1> offtopic, which linux environments do you use?
[00:02:45] <mark_edward> MaikKlein1: arch linux as of 3 days ago. before that, Ubuntu for yearrs
[00:02:56] <cmr> also arch
[00:02:58] <MaikKlein1> oh
[00:03:00] <MaikKlein1> sry
[00:03:02] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:03:03] <MaikKlein1> I ment
[00:03:09] <dbaupp> mark_edward: .3 down from ..34-.37 previously.
[00:03:21] <MaikKlein1> linux desktop environments*
[00:03:30] <mark_edward> dbaupp: that blog post has Rust at .6
[00:03:44] <MaikKlein1> or however you call it
[00:03:45] <aatch> I don't use one. Though I have a window manager: awesome
[00:03:48] <mark_edward> is he running on a much slower computer?
[00:04:08] <cmr> I don't use one either, the wm I use is http://herbstluftwm.org/
[00:04:32] <mark_edward> aatch and cmr are hardcore. i like arch. up to date dev packages easily available
[00:04:49] <mark_edward> i use arch with the KDE desktop environ
[00:05:09] <MaikKlein1> cmr, how do you start programs?
[00:05:13] <dbaupp> mark_edward: right, the .34-.37 is with the code the article is running.
[00:05:14] <MaikKlein1> like firefox
[00:05:22] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[00:05:40] <cmr> well I have a keybinding to start firefox
[00:05:51] <cmr> but I use dmenu for most things
[00:05:52] <MaikKlein1> okay then to other programs :p
[00:05:54] <mark_edward> dbaupp: ah i see. wonder why we're still that mmuch slower than C then. must be a pure codegen thing?
[00:07:09] <dbaupp> mark_edward: probably, and that's still with ~[] vectors rather than [,..] vectors.
[00:07:55] <mark_edward> if he's trying to compare codegen though, i dont think he picked the right benchmark
[00:08:11] <dbaupp> yes
[00:08:16] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[00:08:25] <mark_edward> something more numerical with less allocations and stuff would be appropriate. this seems to be a test of standard libs
[00:08:27] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[00:08:38] <MaikKlein1> btw is this the correct cmd? sudo make check-stage2 NO_REBUILD=1
[00:08:38] *** Joins: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[00:08:44] <MaikKlein1> because it still rebuilds everytime :(
[00:08:45] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[00:08:46] <cmr> MaikKlein1: don't use sudo
[00:08:48] <dbaupp> but what he's actually trying to compare is "language that does his task fastest"
[00:09:04] <strcat> there are programs that aren't firefox or a terminal?
[00:09:12] <cmr> strcat: apparently!
[00:09:14] <mark_edward> dbaupp: the thingamajigger said codegen tho
[00:09:29] <mark_edward> strcat: do you use a graphical DE
[00:09:30] <cmr> the only other one I use is steam, but I start that froma  terminal to get the log
[00:09:32] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[00:09:35] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[00:09:39] <strcat> mark_edward: dunno what you mean by graphical
[00:09:50] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[00:09:52] <mark_edward> like allGUI and stuff
[00:09:58] <mark_edward> do you have an Xserver?
[00:10:08] <aatch> strcat, yes, xchat and gvim
[00:10:42] <strcat> mark_edward: well if I'm running firefox I must
[00:10:59] <mark_edward> strcat: quassel IRC, Kate, 
[00:11:03] <cmr> I recall running firefox on directfb at some time
[00:11:12] <cmr> that memory might be corrupt
[00:11:19] <mark_edward> but all i really use is chromium, a text editor, and terminal
[00:11:33] <aatch> mark_edward, a desktop environment is something like Gnome, KDE or XFCE.
[00:11:39] <mark_edward> aatch: right
[00:11:44] <graydon1> tjc or any other emacs users: https://github.com/mozilla/rust/pull/8031 r?
[00:11:48] <mark_edward> i was asking if you had one
[00:11:57] <mark_edward> i need eclipse and stuff too for android dev for my internship
[00:12:06] <MaikKlein1> i am casual -> i am using gnome because I like the search
[00:12:27] <cmr> MaikKlein1: as long as you're happy, that's all that matters :)
[00:12:38] * strcat only cares about being able to tab/split arbitrary windows
[00:13:04] <MaikKlein1> cmr, I am using sudo because if I don't 4 tests always fail, no idea why
[00:13:22] <strcat> MaikKlein1: probably because you ran it with sudo once
[00:13:25] <strcat> and now you have files owned by root
[00:13:27] <tjc> graydon1: so the new emacs mode doesn't require the byte-compiling step?
[00:13:34] <graydon1> tjc: no
[00:13:39] <MaikKlein1> strcat, probably
[00:13:42] <tjc> awesome
[00:13:58] <graydon1> tjc: it's a very minimal mode, mostly leans on emacs
[00:14:04] <tjc> graydon1: great!
[00:14:19] *** Quits: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Quit: Leaving)
[00:14:43] <mark_edward> strcat: how's xmonad?
[00:15:02] <cmr> I used to jump around DEs and WMs and text editors, but I stopped caring and just settled on what I was using at the time: herbstluft and vim
[00:15:03] * strcat likes i3
[00:15:48] *** Quits: yonran (yonran@moz-962F33EB.acuitus.com) (Ping timeout)
[00:15:49] <cmr> I liked i3 too
[00:16:19] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[00:18:33] <mark_edward> what does it mean to split a window though? if i have one instance of firefox open, and split it, what happens?
[00:18:42] * mark_edward is reading i3 user docs
[00:18:47] <cmr> mark_edward: you don't actually split the window, you split the frame that contains the window
[00:18:50] *** Quits: joone (joone@moz-C50DC051.jf.intel.com) (Quit: Ex-Chat)
[00:18:53] <cmr> thus creating 
[00:19:00] <cmr> *thus making firefox half size and introducing a new frame
[00:19:02] <cmr> more or less.
[00:19:13] <mark_edward> ah i see
[00:19:31] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[00:19:41] <mark_edward> they need a glossary. every professional document should have a glossary! it would make my life so much easier
[00:19:56] *** Quits: brendan (brendaneic@995B2EEE.5E7911EA.DA40C4B3.IP) (Quit: brendan)
[00:19:59] <mark_edward> people use the same word 5 different ways for similar and disparate concepts
[00:20:02] <strcat> mark_edward: well they have pictures ;p
[00:20:10] <bjz_> nmatsakis: yayy
[00:20:19] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[00:21:07] <doomlord> tabbed window managers are great but so much gui software expects to use a certain aspect ratio and doesnt adapt to the wrong size well
[00:21:34] <doomlord> tiled^
[00:21:41] <strcat> not really
[00:21:51] <strcat> and it respects size hints
[00:22:07] <strcat> although the only thing really using them is mplayer and I always have that fullscreen in a workspace
[00:22:17] <cmr> I find dialog boxes are horrid
[00:22:28] <cmr> file pickers, passphrase entry in keepassx
[00:22:38] <doomlord> it seems to be what stops me sticking with one for any length of time... yes dialog boxes in particular dont play well with tiled window managers
[00:22:40] <strcat> well they just open centered over the window
[00:22:45] <cmr> not in my wm
[00:22:51] <strcat> they do for me ;p
[00:22:54] <cmr> (it's a pain point, and definitely the wm's fault)
[00:23:07] <bjz_> aatch: is the static mut/extern fn thing fixed?
[00:23:18] <aatch> bjz_, I don't think so.
[00:23:32] <mark_edward> strcat: where does the rabbit hole end? first teenage me installs ubuntu, then i install arch, and now im seriously considering switching to a tiling window manager...
[00:23:58] <doomlord> i see it as the apps' "fault" mostly, if they were smarter at layout tiled windowing would work better
[00:23:59] <nmatsakis> graydon1: you made a new emacs mode?
[00:24:04] <aatch> mark_edward, probably ends at Gentoo. In my case I got that far and dialed it back.
[00:24:19] <strcat> aatch: exherbo nowadays ;p
[00:24:22] <MaikKlein1> arch broke my system every month, probably just because I was to lazy to read though the docs :X
[00:24:23] <strcat> gentoo went downhill
[00:24:36] <cmr> I ran linux from scratch for 2 months before going insane and going back to debian
[00:24:49] <aatch> strcat, gentoo seems to be for ricers
[00:24:51] <cmr> (this was after exherbo for quite a few months)
[00:24:54] * MaikKlein1 maybe pacman -Syu was wrong....
[00:25:09] *** Joins: brendan (brendaneic@995B2EEE.5E7911EA.DA40C4B3.IP)
[00:25:10] <strcat> MaikKlein1: I've been running it for ~5 years now and it hasn't broken ;p
[00:25:21] <strcat> except that time I built my own pam for something
[00:25:35] <aatch> I occasionally have things break, but there's normally a reason or I screwed something up.
[00:25:38] <MaikKlein1> strcat, do you update with pacman -Syu?
[00:25:41] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[00:25:48] <strcat> yes
[00:25:49] <cmr> MaikKlein1: everyone updates with that, that's how it's done
[00:25:52] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[00:25:54] <MaikKlein1> hm
[00:25:58] <MaikKlein1> then I have no idea :D
[00:26:11] <aatch> The worst time was when my computer froze when that filesystem update thing came around.
[00:26:23] <strcat> some projects ship broken software in their stable releases, and it doesn't shield you from that
[00:26:24] <cmr> it was probably either an upgrade requiring manual intervention or you seriously broke something
[00:26:28] <strcat> I don't use any of that software though
[00:26:43] <aatch> Had to boot off of a flash drive and finish the installation.
[00:27:05] <kmc> how would people feel about making unrecognized/invalid entries in RUST_LOG be a fatal error?
[00:27:08] <cmr> I used and enjoyed fedora before I started missing rolling release again
[00:27:11] <MaikKlein1> what I don't understand is why distros like ubuntu always spam you with software and games
[00:27:14] <strcat> kmc: sounds good to me
[00:27:18] <cmr> kmc: Or at the very least a warning!
[00:27:21] <kmc> more than once I've wasted some time due to a missing colon or a misspellt module name
[00:27:25] <cmr> Yeah
[00:27:34] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[00:27:36] <cmr> I'd r+ it
[00:28:03] <kmc> there is a commented out warning: https://github.com/mozilla/rust/blob/master/src/rt/rust_log.cpp#L321-L325
[00:28:04] <cmr> Is logging a language item yet?
[00:28:21] <kmc> guess I should figure out what's wrong with that code on Android... is there an easy way to do test builds of Rust from my own branches
[00:28:25] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Client exited)
[00:28:47] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[00:29:07] <cmr> dbaupp: ah nice catch with #5642, I git-grepped for "0.8", so of course 0.8-pre didn't come up
[00:30:22] <dbaupp> cmr: :)
[00:30:38] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Quit: Leaving)
[00:31:11] *** Joins: jdm (jdm@moz-9EAFE56A.dsl.teksavvy.com)
[00:31:24] <cmr> kmc: what do you mean test builds?
[00:31:27] <MaikKlein1> ok I am finished https://github.com/mozilla/rust/pull/7969/files
[00:31:27] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:32:04] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[00:32:28] <graydon1> nmatsakis: yeah, the old one was getting annoying
[00:32:50] <kmc> cmr: like if I have a branch, can I send it off to bors or somewhere to see if it will build on Android, without setting up the whole Android SDK/NDK on my laptop
[00:33:03] <cmr> kmc: we don't have android buildbots
[00:33:06] <kmc> oh :/
[00:34:18] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[00:35:42] * MaikKlein1 still feels embarrassed for that git mess 
[00:36:13] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[00:36:25] <cmr> MaikKlein1: smaller than some of the messes I've made :)
[00:36:37] <slaren> rusti: let x = 1u32; match x % 2 { 0 => "yay", 1 => "nay" }
[00:36:37] -rusti- <anon>:7:23: 7:61 error: non-exhaustive patterns
[00:36:37] -rusti- <anon>:7          let x = 1u32; match x % 2 { 0 => "yay", 1 => "nay" }
[00:36:38] -rusti-                                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[00:36:38] -rusti- error: aborting due to previous error
[00:36:38] -rusti- application terminated with error code 101
[00:36:42] *** Quits: brendan (brendaneic@995B2EEE.5E7911EA.DA40C4B3.IP) (Quit: brendan)
[00:36:46] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:36:48] <slaren> would be nice if that worked
[00:37:26] <engla> I'm so disappointed that github lists commits in the wrong order if they were rebase-reordered
[00:37:37] <strcat> slaren: x % 2 == 0 will with a bool ;p
[00:37:49] <cmr> slaren: wouldn't that require dependant typing?
[00:38:00] <strcat> engla: they do it intentionally, it's silly
[00:38:16] <engla> yeah, it's wrong.
[00:38:18] <kmc> cmr: not in full generality
[00:38:22] <engla> it misrepresents the repository
[00:38:26] <engla> or the PR
[00:38:29] <strcat> engla: https://help.github.com/articles/why-are-my-commits-in-the-wrong-order
[00:38:35] <strcat> yeah doesn't make sense....
[00:38:36] <kmc> some languages have integer range types, and it would be useful even if it only works when the RHS of % is a constant
[00:38:38] <slaren> strcat: my actual use case is % 3 actually, but yeah
[00:38:45] <strcat> you can have one commit removing a line added by one they'll show *after*
[00:38:46] <kmc> this case isn't really relevant when it's not a constant
[00:38:48] <engla> strcat: bors must see the r+ on the last commit right?
[00:38:55] <engla> not on the last displayed one
[00:38:59] <strcat> engla: yeah, the child
[00:39:04] *** Quits: strcat (strcat@moz-61B073BC.cpe.net.cable.rogers.com) (Quit: brb)
[00:39:29] <cmr> kmc: I would only really want the feature if I could do match some_function() { ... } and have the arms cover all possible return values of some_function() be considered exhaustive, rather than all possible values of its return type.
[00:39:41] <cmr> Having special cases is unnecessary
[00:40:16] <nmatsakis> graydon1: exciting.
[00:40:21] *** Quits: rusti (rusti@moz-61B073BC.cpe.net.cable.rogers.com) (Ping timeout)
[00:41:35] <engla> the best part is that you can backdate your commits and they won't be visible in the github commit log (sure, the push log yes)
[00:41:47] *** Quits: dherman (dherman@96DF99F7.5E7911EA.DA40C4B3.IP) (Quit: dherman)
[00:44:41] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:45:48] *** mjrosenb is now known as mjrosenb|ARM
[00:46:03] <kmc> so what's the "best practice" for making Rust changes that might break for Android? can I read somewhere about setting up an Android build env for Rust? or just wing it and someone else will fix ;)
[00:46:11] <kmc> I have set up SDK/NDK before but it's kind of a pain...
[00:46:25] <cmr> kmc: https://github.com/mozilla/rust/wiki/Doc-building-for-android
[00:46:55] <kmc> thanks
[00:48:06] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:48:41] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[00:48:42] *** Joins: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[00:50:01] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[00:50:14] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Connection reset by peer)
[00:50:49] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[00:52:35] *** Quits: MaikKlein1 (maik@moz-2B0E2234.dip0.t-ipconnect.de) (Ping timeout)
[00:54:28] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:54:36] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:54:39] <graydon1> nmatsakis: let me know if you find any bugs in it. it seemed easier to me to work with but still of course mostly just regexp-bashing to figure out what to do.
[00:56:47] *** Quits: graydon1 (graydon@moz-1C52C8D0.cable.teksavvy.com) (Quit: Leaving.)
[00:56:49] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[01:00:19] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[01:05:22] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[01:05:25] *** Quits: lerc (quassel@moz-598ED764.telstraclear.net) (Ping timeout)
[01:07:23] *** Quits: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Client exited)
[01:07:58] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[01:09:07] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[01:09:39] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[01:10:45] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[01:10:48] *** Quits: jdm (jdm@moz-9EAFE56A.dsl.teksavvy.com) (Ping timeout)
[01:11:04] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Quit: dbaupp)
[01:12:18] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[01:14:23] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:14:59] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:15:53] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[01:17:12] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[01:17:30] *** Quits: stampy (Mibbit@moz-D08E0368.hsd1.pa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:17:51] *** Joins: mye (mye@moz-6C96FE1E.dip0.t-ipconnect.de)
[01:18:14] *** Quits: mye (mye@moz-6C96FE1E.dip0.t-ipconnect.de) (Quit: mye)
[01:18:31] *** bnicholson|afk is now known as bnicholson
[01:18:52] *** bnicholson is now known as IRCMonkey11162
[01:18:54] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:19:27] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:20:00] *** IRCMonkey11162 is now known as bnicholson
[01:20:03] *** Joins: MaikKlein1 (maik@moz-2B0E2234.dip0.t-ipconnect.de)
[01:21:13] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:22:04] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:27:11] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[01:29:42] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:31:08] *** Quits: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net) (Ping timeout)
[01:32:01] *** Joins: joone (joone@E10A1781.2160464A.A34EC3BB.IP)
[01:33:44] <gavinb> I just took a module that was building and running standalone just fine and added it to libstd and rebuilt. Now I'm getting some errors like: "error: type `~[u8]` does not implement any method in scope named `len`". I presume this is due to not having the prelude loaded? Do I just need to find the right trait to "use"?
[01:34:13] <cmr> gavinb: you need to add a `use prelude::*;` at the top
[01:34:17] <cmr> or, that's one way to do it
[01:34:32] <dbaupp> gavinb: `use container::Container` also works
[01:34:50] *** Parts: judder (maradukewa@3226AE5F.7C541960.78E362FE.IP) ()
[01:35:00] <nmatsakis> graydon: will do, gonna upgrade now.
[01:35:04] <gavinb> cmr: oh, I thought that would pull in too much unnecessary stuff.
[01:35:24] <cmr> gavinb: well, it does pull in unnecessary stuff, but it doesn't really matter
[01:36:03] <gavinb> cmr: Coming from years of C/C++, I always try to minimise my #includes :)
[01:36:08] <cmr> (that statement is going to come back to bite me when we find out that `use std::prelude::*` everywhere is a huge resolve perf hit)
[01:36:28] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[01:36:34] <cmr> gavinb: unlike C/C++, we don't need to reparse or anything the things we use
[01:36:49] <cmr> it's just name lookup
[01:37:16] <gavinb> cmr: that's very cool - and takes a bit of getting used to
[01:37:23] <cmr> gavinb: yup!
[01:37:40] *** Joins: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net)
[01:37:42] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[01:38:51] <gavinb> So I've written a UUID module for libstd. Just getting a few things tidied up. It has tests, docs, and seems to generally do the right thing. Is the next step to put in a PR on github for feedback? Or should I gather feedback and polish it before putting up a PR?
[01:40:01] <cmr> gavinb: open a PR
[01:40:07] <dbaupp> gavinb: PR is a good way to get feedback
[01:40:09] <cmr> feedback and polish happens in code reviews in PRs
[01:40:23] <gavinb> cool, that would be great.
[01:40:34] <gavinb> Not sure everything is idiomatic yet...
[01:41:12] *** Quits: MaikKlein1 (maik@moz-2B0E2234.dip0.t-ipconnect.de) (Ping timeout)
[01:42:02] <dbaupp> gavinb: don't worry, we can review super-harsh if you want :P
[01:42:27] <gavinb> dbaupp: er - goody!
[01:42:40] *** Quits: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net) (Ping timeout)
[01:42:44] <dbaupp> haha :) I'm sure it'll be fine.
[01:42:51] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[01:43:45] *** Quits: jyasskin_w (jyasskin@DAF66858.C60FE7DC.4065847B.IP) (Quit: Ex-Chat)
[01:44:27] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[01:45:10] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[01:45:56] *** Quits: heftig (heftig@327C8F30.EBDCAFC6.FEC4A986.IP) (Quit: Quitting)
[01:47:38] *** Quits: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Ping timeout)
[01:48:50] <tjc> graydon: r? https://github.com/mozilla/rust/pull/8032
[01:49:50] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:52:40] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[01:54:03] <nmatsakis> graydon: did you see erickt's pull request to add lifetimes to *T?
[01:55:04] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[01:56:59] *** Joins: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net)
[01:58:55] *** Joins: tavoe (Mibbit@moz-3E6EF1F3.rh.rit.edu)
[02:00:09] <tavoe> I'm following a tutorial using file IO, and keep getting a pattern matching error. I want to return an empty string in the "read error" branch, but I'm told: (expected () but found vector).
[02:01:32] <cmr> tavoe: gist your code
[02:02:02] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:02:19] *** Joins: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net)
[02:03:26] *** Joins: alex_abreu (alex@moz-7421D6C9.mc.videotron.ca)
[02:03:37] *** Joins: Voomer (Voomer@moz-CC05FF5E.hsd1.wa.comcast.net)
[02:04:10] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[02:04:20] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[02:04:45] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[02:04:50] <engla> it sounds like different branches of your ifs or matches don't return the same type of vaule, tavoe 
[02:06:50] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[02:07:31] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[02:07:39] *** Quits: RageOfThou (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:08:16] *** Quits: homa_rano (edre@moz-223EA699.csail.mit.edu) (Ping timeout)
[02:08:22] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[02:09:58] *** Quits: tavoe (Mibbit@moz-3E6EF1F3.rh.rit.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[02:10:02] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Ping timeout)
[02:12:58] <sully> nmatsakis: sorry, I didn't see the code review request until just now, due to the intern bbq
[02:13:43] *** Quits: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net) (Quit: eatkinson)
[02:14:03] *** Joins: homa_rano (edre@moz-223EA699.csail.mit.edu)
[02:14:18] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:16:38] <nmatsakis> sully: not to worry
[02:16:52] *** Quits: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr) (Ping timeout)
[02:18:07] <kemurphy> damn, looks like https://github.com/mozilla/rust/pull/8000 failed a test :(
[02:18:12] <kemurphy> how do i figure out what happened?
[02:18:44] <cmr> kemurphy: the build that failed is http://buildbot.rust-lang.org/builders/auto-linux-64-opt-vg/builds/585
[02:19:04] <sully> oh, damn, my thing failed
[02:19:06] <cmr> `make tidy` failed
[02:19:25] <cmr> It'd be really super sweet if that was the *first thing* run, before anything else..
[02:19:58] <kemurphy> wait, the error is that i have a line longer than 100 chars?
[02:20:01] <cmr> yup
[02:20:04] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[02:20:32] <kemurphy> wow. well, okay then. /me goes and fixes it
[02:20:56] <sully> argh! a test I added failed the pretty test
[02:21:33] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Quit: Leaving)
[02:22:49] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:22:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/NdsGzQ
[02:22:49] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:23:31] <engla> oh
[02:24:33] <sully> oh my god. my PR failed to land because one of the tests, when pretty printed, had a comment placed wrong
[02:24:53] <engla> it one space or something like that
[02:25:06] <sully> yes
[02:25:13] <engla> yay
[02:25:27] <engla> haha that's really a bit dumb
[02:25:40] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[02:25:40] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/2JDuoA
[02:25:40] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[02:25:40] <engla> and spinning up all those buildbots for more than an hour just to end on that
[02:25:42] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[02:25:42] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/YuGrDQ
[02:25:42] <ghrust> 13rust/06auto 145991c60 15blake2-ppc: option: Title-case `Some` and `None` in docs and fail messages...
[02:25:42] <ghrust> 13rust/06auto 14625ca7a 15blake2-ppc: option: Add .chain_mut_ref()...
[02:25:42] <ghrust> 13rust/06auto 14467d381 15bors: auto merge of #7931 : blake2-ppc/rust/chain-mut-ref, r=pcwalton...
[02:25:44] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[02:25:55] <cmr> the ast doesn't preserve newlines, how does the pretty printer even work for doc comments?
[02:26:08] <cmr> (Although it's nice to note that it *reorders* them sometimes, and they ARE ordered in the ast)
[02:26:29] <cmr> // Foo
[02:26:33] <cmr> <empty line>
[02:26:35] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Ping timeout)
[02:26:38] <cmr> / Bar
[02:26:43] <cmr> / Bar*
[02:26:49] <cmr> oh right, irc
[02:26:54] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[02:27:30] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:27:38] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:28:13] <cmr> dbaupp: so, I've been running benchmarks on my desktop, and if the script is working correctly (which I'm not sure it is), builds are taking 7 minutes
[02:28:17] <cmr> benches, rather
[02:28:53] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Leaving)
[02:30:03] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[02:31:15] <cmr> my scattershot of python scripts is too fragile, and I never pushed the local modifications on the old bench server :(
[02:31:48] <dbaupp> cmr: is it getting uploaded?
[02:31:59] <dbaupp> (also, aatch was writing a pure-rust version, right?)
[02:32:11] <cmr> dbaupp: yes it is uploading now :), and yes
[02:32:32] <dbaupp> octayn.net/benches?
[02:32:39] <cmr> yes
[02:32:42] <cmr> it's not done yet
[02:32:46] <cmr> also I'm gzipping the mem.json's
[02:32:46] <aatch> I'm working on it, but it's definately a weekend thing.
[02:32:55] <dbaupp> aatch: np
[02:33:08] <aatch> Stupid day job.
[02:33:11] <dbaupp> cmr: there doesn't appear to be a history.txt?
[02:33:17] <cmr> dbaupp: it's not done yet :p
[02:33:33] <dbaupp> aatch: resign! clearly writing benchmarking tools for a pre-alpha language is more important.
[02:34:21] <aatch> dbaupp, clearly, but I think my girlfriend might not see it that way :P
[02:34:48] <cmr> dbaupp: it's not mem.json.gz
[02:35:05] <dbaupp> aatch: well... there's another obvious solution to that one. :P
[02:35:21] <cmr> yes! teach her rust and get her working on it too
[02:35:40] <dbaupp> cmr: what do you mean?
[02:35:50] <aatch> Well, she did do intro to CompSci
[02:35:53] <cmr> dbaupp: *it's now
[02:35:59] <dbaupp> cmr: oh
[02:36:11] <dbaupp> cmr: um, they are all like 29 bytes?
[02:36:20] <cmr> No?
[02:36:33] <dbaupp> well, some are http://octayn.net/benches/51028532d790db476b102ebdda40bb9b1a7f8106/
[02:36:36] <cmr> maybe they're not flushed to disk
[02:36:48] <cmr> (the first one in the list wasn't :p http://octayn.net/benches/359755a39a1d216a03a4e4d0b14e64e6610bbf91/)
[02:36:48] *** Joins: tavoe (Mibbit@moz-3E6EF1F3.rh.rit.edu)
[02:37:00] <dbaupp> haha, awesome
[02:37:15] <dbaupp> I'll try to get that hooked up soon.
[02:37:33] <cmr> hm, it seems some of them are 29 bytes, legitimately
[02:37:47] *** Quits: sprocket (Mibbit@moz-F85B6108.student.rit.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[02:37:56] <cmr> they're empty...
[02:38:13] <cmr> well that's unpleasing.
[02:38:32] <cmr> and the time.txt shows 0.00s
[02:38:42] <cmr> I didn't think the script was working correctly :p
[02:39:14] <dbaupp> nah, rust just got very fast.
[02:39:26] *** Joins: evmar (user@F4C60568.27376607.189F3E15.IP)
[02:39:59] <evmar> noob question: why doesn't this work:  let r = io::file_reader(~path::Path("foo")).get()
[02:40:24] <cmr> rusti: let r = std::io::file_reader(~Path("foo")).get()
[02:40:25] -rusti- <anon>:8:4: 8:5 error: expected `;` but found `}`
[02:40:25] -rusti- <anon>:8     };
[02:40:25] -rusti-              ^
[02:40:25] -rusti- application terminated with error code 101
[02:40:29] <cmr> rusti: let r = std::io::file_reader(~Path("foo")).get(); r
[02:40:31] -rusti- <anon>:7:17: 7:58 error: failed to find an implementation of trait std::clone::Clone for @std::io::Reader:'static
[02:40:31] -rusti- <anon>:7          let r = std::io::file_reader(~Path("foo")).get(); r
[02:40:31] -rusti-                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[02:40:31] -rusti- application terminated with error code 101
[02:40:54] <cmr> rusti: let r = std::io::file_reader(~Path("foo")); r
[02:41:00] -rusti- Err(~"error opening foo")
[02:41:01] <dbaupp> rusti: let r = std::io::file_reader(~Path("foo")).unwrap(); r
[02:41:02] -rusti- rust: task failed at 'unwrap called on an err result', /build/rust-git/src/rust/src/libstd/result.rs:385
[02:41:02] -rusti- rust: domain main @0x7a3110 root task failed
[02:41:02] -rusti- application terminated with error code 101
[02:41:03] <evmar> it seems the @Reader in the Result<@Reader, ~str> ought to be clonable
[02:42:01] <evmar> but i don't know that the tyep "@std::io::Reader:'static" means
[02:42:08] <evmar> s/that/what/
[02:42:15] <cmr> neither do I
[02:42:20] <cmr> @'static was a recent thing I think
[02:42:30] <cmr> and I'm not sure that's getting pretty printed correctly?
[02:42:34] * cmr has no idea
[02:43:09] <evmar> http://static.rust-lang.org/doc/rust.html#type-kinds <- discusses 'static, now that i look
[02:44:27] <evmar> it appears there's a DeepClone for @T where <T: Freeze+DeepClone+'static>
[02:44:35] <evmar> but no plain Clone, just DeepClone
[02:45:37] <cmr> dbaupp: herp, I had all the make and checkout lines commented out :\
[02:45:44] <cmr> why would I commit it like that!
[02:46:16] <dbaupp> cmr: because anything else would be silly?
[02:48:28] <kemurphy> r? https://github.com/mozilla/rust/pull/8000
[02:49:06] <kemurphy> er, just kidding
[02:49:19] * kemurphy should actually push local changes first
[02:50:00] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:50:45] <cmr> dbaupp: I'm just going to start it and hope it works, and go to bed... I cleared everything out from octayn.net/benches
[02:51:49] <cmr> rusti: fn foo(f: extern fn(int) -> int) -> int { f(42) } foo(|x| x)
[02:52:00] <evmar> anyway, here's my first non-hello-world rust program, an apache log parser
[02:52:02] <evmar> https://github.com/martine/rust-toys/blob/master/log.rs
[02:52:07] <evmar> feedback welcome, though i see you're busy :)
[02:52:08] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/aYfJ
[02:52:26] <cmr> Huh, I thought extern defaulted to extern "C"
[02:52:59] <engla> extern fn is the regular function type
[02:53:07] <cmr> evmar: sorry that you had to implement your own buffered reader, the new io code will be better :)
[02:53:14] <engla> it's not extern at all
[02:54:19] <tavoe> I'm really floundering with file io as well.
[02:54:51] <evmar> cmr: it's cool, i can see that it's taken a while to get all the supporting piece in place
[02:55:11] *** Quits: zz_kimundi (kimundi@moz-1DB2C6D0.dip0.t-ipconnect.de) (Ping timeout)
[02:56:14] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[02:58:29] *** Joins: zz_kimundi (kimundi@moz-E839B363.dip0.t-ipconnect.de)
[02:58:46] *** zz_kimundi is now known as kimundi
[03:01:50] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Client exited)
[03:01:58] *** Quits: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net) (Ping timeout)
[03:03:19] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:06:22] <tavoe> For the record. File io at its simplist: https://gist.github.com/tavoe/6076352
[03:07:55] <evmar> tavoe: this is sorta related to my question, actually!  it seems you could write file_reader(...).get().read_lines().get()
[03:08:03] <cmr> tavoe: rather than PosixPath you should always use Path
[03:08:06] <evmar> which would fail the task on any error
[03:08:17] <cmr> (and it's in the prelude, so you don't need to worry about using it)
[03:08:33] <cmr> `use`-ing it, not using it
[03:08:37] <evmar> cmr: is it worth filing a bug about my 'static clone issue?  or will it just be bug tracker noise?
[03:08:46] <evmar> s/worth/worth me/
[03:08:51] <cmr> evmar: do file it
[03:09:04] <cmr> and mention @pcwalton
[03:09:18] <cmr> he implemented the feature I think
[03:10:42] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[03:13:02] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:13:43] <evmar> https://github.com/mozilla/rust/issues/8033
[03:15:24] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[03:15:26] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[03:16:50] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[03:18:56] <sully> I am trying to rebase and push a patch, but am getting an error...
[03:18:57] <sully> Corrupted MAC on input.
[03:19:06] <sully> which I think is because my connection is bad
[03:19:15] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[03:20:03] *** Joins: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP)
[03:20:03] *** ChanServ sets mode: +o dherman
[03:20:58] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[03:21:00] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[03:21:28] <dbaupp> tavoe: (the `let r = rdr;` line is pointless :) )
[03:22:15] <dbaupp> tavoe: also, `file_reader(&Path("testing.rs"));` saves an allocation.
[03:23:11] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[03:23:34] <sully> is anybody else having github troubles?
[03:24:15] *** Quits: Nefzaoui (chatzilla@D61C2EA.93D3D8DB.360EF119.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[03:24:22] <dbaupp> sully: what sort? (https://status.github.com/ says they're fine.)
[03:24:43] <shachaf> sully: With what? Pulling rust works for me.
[03:24:53] <sully> I am getting problems with incorrect MAC on ssl stuff?
[03:25:12] <shachaf> Can you connect with your browser?
[03:25:17] <sully> sometimes!
[03:25:25] <sully> but sometimes I get MAC problems there
[03:25:40] <shachaf> Sounds suspicious.
[03:25:43] <sully> I think it might something with the GoogleWiFi in mountain view
[03:25:45] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[03:25:49] <shachaf> Oh. Yes.
[03:25:59] <shachaf> GoogleWiFi is pretty broken, in at least some places.
[03:26:02] <shachaf> Randomly corrupts packets.
[03:26:16] <sully> oh, but I just managed to get onto Red Rock wifi
[03:26:23] <shachaf> I didn't manage to pull anything nontrivial from git.
[03:26:23] <sully> which I had trouble with before
[03:26:39] <shachaf> That works.
[03:26:51] * sully wfrr
[03:27:32] <shachaf> I didn't know you were in MV.
[03:31:04] <sully> I am living in SF this summer, and mostly working in the SF office
[03:31:15] <sully> I come down to MV once or twice a week, though
[03:31:58] <Jeaye> Speaking of SF, we should have another meetup.
[03:32:09] *** Joins: timm (timm@moz-37B954AF.superkabel.de)
[03:32:47] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:32:48] <evmar> is your sf office the one near harrison and spear?
[03:33:30] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[03:33:31] *** Quits: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net) (Ping timeout)
[03:33:49] *** Quits: evmar (user@F4C60568.27376607.189F3E15.IP) (Client exited)
[03:33:51] *** Quits: timm (timm@moz-37B954AF.superkabel.de) (Ping timeout)
[03:38:00] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[03:40:38] <kemurphy> hm, 8000 is gonna trip two tests that used to compile-fail
[03:41:16] *** Joins: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net)
[03:41:37] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:42:27] <dbaupp> kemurphy: which tests?
[03:43:19] <kemurphy> dbaupp: issue-2467 and tag-variant-disr-type-mismatch
[03:44:04] <dbaupp> well, 8000 makes 2467 valid code, so it can be deleted. (or moved to run-pass.)
[03:44:30] <dbaupp> and the same for tag-variant-disr-type-mismatch
[03:45:44] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[03:46:11] *** Joins: jasom (aidenn@moz-5F6FC7B3.sb.sd.cox.net)
[03:47:28] <kemurphy> so, i'm guessing i should add a commit to the pr that moves them; will bors do the right thing?
[03:47:44] <dbaupp> yeah; if it's re-reviewed
[03:48:18] <dbaupp> (bors will only look at r+'s on the last commit in each pull request, and updates if commits are added/force pushed.)
[03:48:49] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:49:49] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:50:07] <kemurphy> okay, added a commit
[03:52:16] * dbaupp rereviews
[03:53:20] <kemurphy> cool, thanks
[03:54:11] *** Joins: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net)
[03:55:16] <dbaupp> kemurphy: erm, wait... can you delete the `error-pattern` line and amend that commit?
[03:57:16] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:57:47] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[04:01:16] *** Joins: MaikKlein1 (maik@moz-2B0E2234.dip0.t-ipconnect.de)
[04:01:51] <kemurphy> dbaupp: how's that
[04:02:21] <dbaupp> perfect!
[04:03:58] <kemurphy> sweet, now back to working on adjustable width
[04:04:54] <dbaupp> are you planning on the `enum Foo: u8 { ... }` syntax?
[04:05:37] <kemurphy> yes, unless someone suggests something better?
[04:05:51] <dbaupp> (while you're at it, you should try to make the discriminants default to bool/u8/u16/the smallest that fits. ;) )
[04:05:59] <dbaupp> I don't have anything better.
[04:06:23] <kemurphy> i think "smallest that fits" probably isn't the right thing to do, but probably u32 is
[04:06:42] <kemurphy> (unless it does the right thing with alignment, that is)
[04:07:41] <dbaupp> why?? ... enums have no defined representation to allow optimsations like this. e.g. Option<u8> should be 2 bytes.
[04:07:57] <kemurphy> right, that makes sense
[04:08:25] <kemurphy> i meant for something like Option<u32>
[04:08:26] <dbaupp> the alignment should be computed from the variants, so that that^ works, but Option<u32> is 8 bytes, to get the alignment right.
[04:08:28] <dbaupp> yeah
[04:08:30] <dbaupp> I agree.
[04:08:32] <kemurphy> feel like that should take 8 bytes, not 5
[04:08:44] <kemurphy> okay, cool so we agree
[04:08:59] <dbaupp> yeah, but the discriminant should be as small as possible, and then padding makes up for the alignment. :)
[04:09:03] * kemurphy phrased poorly before
[04:09:26] <dbaupp> (this allows LLVM to optimise loads/stores by not bothering setting the the padding if it doesn't have to.)
[04:09:35] <dbaupp> s/the the/the/
[04:09:58] <kemurphy> (i guess that means we should also support #[packed] on enums?)
[04:10:34] <dbaupp> maybe?
[04:10:49] * dbaupp doesn't know if that LLVM supports such a thing
[04:10:49] *** Joins: jdm (jdm@moz-9EAFE56A.dsl.teksavvy.com)
[04:11:17] <dbaupp> (gaah. I cannot type.)
[04:11:22] <kemurphy> i mean, an enum variant is essentially a struct at the machine level, and we already do packed structs
[04:11:36] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[04:11:55] <dbaupp> yeah
[04:12:00] * dbaupp implemented #[packed]
[04:12:17] <tavoe> where do I need to import TcpStream from these days? How can I figure out on my own?
[04:13:07] <dbaupp> kemurphy: but I think LLVM may represent tagged enums differently to structs (#[packed] just indicates to LLVM that the struct is packed, no fancy logic in rustc itself.)
[04:13:18] <dbaupp> tavoe: probably std::rt::io::net
[04:13:39] <kemurphy> dbaupp: ah i see
[04:14:08] <dbaupp> tavoe: yeah, std::rt::io::net::tcp, you'll need to set RUST_NEWRT=1 when running the program
[04:15:12] <dbaupp> tavoe: (you can find this stuff by having a copy of the rust repo, and then using `git grep 'TcpStream'` etc, and it should point you to the right file. if it doesn't... #rust is here to help :) )
[04:15:29] <engla> one of the builders is much slower than the others.. :|
[04:15:54] <dbaupp> kemurphy: well, actually, I lie. the cabi_*.rs files in trans have to know about #[packed].
[04:16:32] <dbaupp> kemurphy: but it's just for size_of and align_of computations, not actual data layout ones.
[04:16:42] <kemurphy> dbaupp: that makes sense
[04:16:45] <tavoe> Does the file structure always map to the use directive? 
[04:16:53] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[04:16:58] <dbaupp> tavoe: almost always
[04:17:08] <kemurphy> does the buildbot benchmark every build?
[04:17:15] <dbaupp> kemurphy: it does now, yes.
[04:17:16] <kemurphy> builds look like they take a loooong time
[04:17:24] <tavoe> where/how do I set RUST_NEWRT? What is it?
[04:17:26] <kemurphy> ah, that would explain it then
[04:18:06] <dbaupp> tavoe: it's an environment variable (what OS?)
[04:18:18] <dbaupp> tavoe: e.g. `RUST_NEWRT=1 ./my_program`
[04:18:56] <dbaupp> tavoe: (also, using the new rt means that std::io doesn't work, and there's currently no file io replacement.)
[04:19:57] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[04:20:31] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[04:20:41] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[04:21:01] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[04:21:26] <tavoe> is there a list of environment variables floating around somewhere?
[04:21:42] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:21:51] *** Quits: MaikKlein1 (maik@moz-2B0E2234.dip0.t-ipconnect.de) (Client exited)
[04:24:32] <dbaupp> tavoe: not really, but `git grep '"RUST_[A-Z]*"'` turns up RUST_THREADS, RUST_LOG, RUST_SEED, RUST_PATH, and RUST_BENCH. The latter two are used by rustpkg and src/test/bench respectively.
[04:24:43] <dbaupp> (also RUST_NEWRT)
[04:27:06] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[04:30:06] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[04:31:37] <tavoe> Man. This thing really is under maintenance. 
[04:37:08] <tavoe> Is it possable to make a tcp connection based on a web address right now? Or has that part of the code been gutted in preparation for something new?
[04:37:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:37:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/YuGrDQ
[04:37:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:38:27] *** Quits: etw (john@moz-B2936CAB.nyc.res.rr.com) (Quit: etw)
[04:40:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:40:39] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hdNDeg
[04:40:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:40:40] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:40:40] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/0KQr7Q
[04:40:40] <ghrust> 13rust/06auto 144b7f148 15maikklein: cleanup get_ref
[04:40:40] <ghrust> 13rust/06auto 1458f934f 15maikklein: cleanup .is_err and .is_ok. updated tcp.rs and ip.rs
[04:40:40] <ghrust> 13rust/06auto 142edf6d2 15maikklein: cleanup .iter and .iter_err
[04:40:41] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:44:47] <dbaupp> aatch: ping
[04:44:55] <aatch> dbaupp, pong
[04:45:22] <dbaupp> engla was wondering about the fmt! rewrite yesterday... have you revived it/actively working on it?
[04:46:29] <aatch> dbaupp, I tried to revive it. I'm just not sure what to do with it.
[04:47:13] <dbaupp> hahaha... maybe we try to get it into the tree as a separate/new fmt!, and then it can be worked on there?
[04:47:22] * dbaupp doesn't really know
[04:48:12] <aatch> dbaupp, I don't mind changing the formatting syntax etc. but we need to actually decide on something.
[04:48:31] <tavoe> I feel like I'm going stupid. Is this the best way to connect to an ip address: let adr = ip::IpAddr::Ipv4(127, 0, 0 ,1, 8080);     let socket = tcp::TcpStream::connect(adr);
[04:48:54] <engla> I was thinking mostly about adapting fmt and ToStr to io traits
[04:49:24] <dbaupp> aatch: yeah, personally I'm thinking just {} (or something along those lines), since we're going to have so few %s/%f/%d-style flags, let everything be handled by newtype structs.
[04:49:44] <dbaupp> engla: ToStr would be a forward-compatible change.
[04:49:52] <engla> it can be
[04:51:08] <dbaupp> aatch: that said, I'm not sure if people will be keen on `fmt!("{} {}", fmt::ScientificNotation(some_float), fmt::Base(some_int, 16))`
[04:51:39] * dbaupp doesn't like making choices.
[04:51:58] <engla> yeah it's no fun
[04:52:13] <aatch> dbaupp, exactly. A lot of the discussion at the moment is focussed on the really simple "I want this as a string" case.
[04:52:31] <aatch> but ignores stuff like field widths, alignment and different bases.
[04:52:51] <dbaupp> yeah.
[04:53:39] <engla> aatch: this is a place where a simple writer trait is useful, but maybe it should be a restriction that only accepts str/char
[04:54:00] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[04:54:14] <aatch> I don't mind having say, "{}" being just to_str, then having "{d}" being 'number', and "{d:16}" be 'number in base 16'
[04:54:50] <aatch> engla, what? I've lost you.
[04:55:12] <dbaupp> I'm feeling like `{d}` is actually redundant, since number-y things are almost always printed as numbers. i.e. no difference between {} and {d}
[04:55:30] <engla> yeah it was not about formats, just using trait Writer for fmt
[04:55:39] <dbaupp> maybe we could bash out a few proposals on https://github.com/mozilla/rust/wiki/Lib-fmt and see which ones work alright.
[04:55:48] <dbaupp> (where "we" = the rust community.)
[04:55:57] <aatch> engla, yeah, that's been the plan for the entire time.
[04:56:05] <engla> yes I know
[04:56:46] <aatch> In fact, the work me and dbaupp did implemented it exactly like that. all based on a writef! extension. fmt! and print! just supplied specific writers.
[04:57:01] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[04:57:29] <engla> I was saying maybe it should pass down a restricted trait instead, that only accepts strings
[04:58:00] <aatch> engla, why? The formatter turns everything into strings anyway.
[04:58:27] <engla> because you don't want something to insert random bytes into your format string, which could happen if you pass down a writer
[05:00:31] <aatch> engla, I'm really not sure what you're getting at here. If I have fmt!("Blah %d", 15), then an implemention of Writer for str get's told to write "Blah " and "15", I'm not sure how you could insert random bytes.
[05:01:08] <aatch> The format string itself doesn't reach runtime.
[05:01:10] <engla> if you would pass a writer to any object implementing ToStr or another trait to customize numeric formats for example
[05:01:25] <dbaupp> engla: does it particularly matter? i.e. it's a library bug if the thing is junking up an output stream.
[05:01:32] *** Quits: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net) (Quit: brendan)
[05:01:39] <engla> well we have types for a reason..
[05:01:43] <dbaupp> also, restricting format strings to utf8 strings might be annoying?
[05:01:45] <engla> to preserve invariants etc
[05:01:48] * dbaupp doesn't know.
[05:01:56] <engla> if it's text it's text
[05:02:10] <engla> str can represent it, internal encoding doesn't matter
[05:02:19] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[05:02:23] <dbaupp> but not everything writes to str.
[05:02:30] <aatch> engla, why do we need an invariant that the output from a formatting thing is text?
[05:03:01] <engla> what else would fmt produce
[05:04:00] <dbaupp> writef! might not produce text
[05:04:10] <engla> if you have a format string that's a string there is not much more you can insert into its placeholders than more text.. type being string
[05:04:13] <engla> ok
[05:04:19] <engla> fine
[05:04:35] <engla> what else does it produce?
[05:04:38] <dbaupp> it might be neat to somehow restrict fmt! to only string-outputing-writers
[05:04:40] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[05:04:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ef40d84 to 14467d381: 02http://git.io/N3iJvQ
[05:04:40] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[05:04:42] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[05:04:42] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/9lzjFQ
[05:04:42] <ghrust> 13rust/06auto 141c3dc29 15Kevin Murphy: Allow uint discriminants and store them as such...
[05:04:42] <ghrust> 13rust/06auto 14e9233d5 15Kevin Murphy: Add test for uint and negative literals as discriminants
[05:04:42] <ghrust> 13rust/06auto 146f25341 15Kevin Murphy: Move/delete old tests that change behavior
[05:04:44] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[05:04:59] <dbaupp> engla: whatever you want, it can write arbitrary data.
[05:05:09] <engla> dbaupp: it's not hard, you still pass down the same writer value, just have a different trait bound on the functions, a restriction
[05:05:12] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:05:14] <dbaupp> (well, it could be used to write arbitrary data.)
[05:05:31] <dbaupp> engla: right. we'd only want that for fmt! though.
[05:06:05] <dbaupp> so we'd need a StrWriter trait that doesn't inherit from Writer.
[05:06:46] <engla> in the places where we want strings it sounds reasonable
[05:06:49] <engla> it's just an idea
[05:07:03] * dbaupp thinks engla should add this to the lib-fmt wiki page
[05:08:25] <engla> it's quite bare bones
[05:08:29] <dbaupp> yes
[05:08:48] <engla> ok I'll write it in tomorrow
[05:08:56] <dbaupp> awesome!
[05:09:08] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:09:57] <sfackler> What are the issues with destructors for non-sendable types?
[05:11:22] *** Quits: RMF (RMF@5C293616.B791E6A9.8D19547B.IP) (Ping timeout)
[05:11:46] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Quit: gavinb)
[05:12:43] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[05:12:45] *** Joins: RMF (RMF@5C293616.B791E6A9.8D19547B.IP)
[05:13:35] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[05:16:24] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[05:16:44] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[05:19:25] *** Quits: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu) (Quit: Leaving)
[05:23:18] <acrichto_> sfackler: I think it's because you don't know what order to run the destructors in
[05:23:31] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:23:36] <acrichto_> if there's a cycle, the destructors can't run in any order if the destructors use the fields of the cycle for everything
[05:23:56] *** Joins: mvalzelli (mvalzelli@moz-36091CB9.ip217.fastwebnet.it)
[05:24:35] <acrichto_> sfackler: with owned types, there's a DAG whose topological ordering is the order to run destructors in (or something like that), @ introduces cycles
[05:25:09] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[05:27:52] *** Quits: tavoe (Mibbit@moz-3E6EF1F3.rh.rit.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[05:33:34] <sfackler> gotcha
[05:34:43] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[05:35:32] *** Quits: mvalzelli (mvalzelli@moz-36091CB9.ip217.fastwebnet.it) (Quit: Quitting)
[05:39:26] *** Joins: pyrac (pyrac@moz-873BFA0.w90-5.abo.wanadoo.fr)
[05:42:05] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[05:47:18] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:47:21] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:48:35] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[05:49:19] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[05:49:43] <james4k> opinions: think going through project euler or rosalind is a good way to learn some rust?
[05:49:57] *** Quits: victorporof (victorporo@7EA800E4.67625325.D111398B.IP) (Connection reset by peer)
[05:50:42] *** Quits: KindOne (KindOne@moz-CAC1AF11.dynamic.ip.windstream.net) (Ping timeout)
[05:53:09] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:59:08] *** Joins: lerc (quassel@moz-598ED764.telstraclear.net)
[06:00:04] <mcpherrin> Well, writing code is better than not writing code.
[06:00:16] <mcpherrin> Having goals can make it easier to figure out what code to write
[06:00:46] <mcpherrin> Dunno if project euler is exactly the right thing though; I find I spend very little time actually coding in the solutions and more time in Wolfram Alpha or with pen & paper
[06:01:00] *** Quits: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP) (Quit: dherman)
[06:01:19] <dbaupp> Wolfram Alpha! get outta here! ;P
[06:01:33] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[06:01:48] <mcpherrin> Or maple; anything symbolic really :P
[06:03:16] <dbaupp> james4k: I think it'd be alright (assuming your reasonably comfortable with maths, for project euler especially); some of them have interesting algorithmic solutions (e.g. graph traversals), others would just be a decent way to practice writing Rust/working out what is fast.
[06:03:21] <dbaupp> *you're
[06:03:36] *** Joins: gavinb (gavinb@54F1A9B6.2D55314.C3991EA9.IP)
[06:04:11] <james4k> yeah 
[06:05:11] <dbaupp> james4k: even better would be fixing up all the problems in the compiler... baptism by fire! :P
[06:05:28] <james4k> im just trying to figure something out that i will easily learn from and throw away
[06:06:40] <dbaupp> yeah, those solve-a-short-problem sites are pretty good for that.
[06:06:46] * dbaupp began Haskell that way.
[06:10:46] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[06:15:59] <sfackler> any objections to adding a default impl of Container::is_empty? assuming that rustc is in a place such that the obvious implementation will work
[06:17:16] <engla> strcat said he found some hurdle there sfackler 
[06:18:38] <dbaupp> sfackler: i.e. foo.len() == 0?
[06:18:41] <sfackler> eyah
[06:19:10] <acrichto_> sfackler: previous default method bugs have prevented that, but there's no reason not to have it
[06:19:25] <acrichto_> if it makes it all the way to stage2 you're probably fine
[06:19:42] <acrichto_> sfackler: if that does work, you could also add default implementations for Map::{insert, remove}
[06:20:20] <sfackler> what would those be?
[06:20:30] <acrichto_> Map::{pop, swap}
[06:20:40] <sfackler> ah
[06:20:46] <acrichto_> remove = pop.is_some(), insert = swap.is_none()
[06:22:08] <dbaupp> acrichto_: I thought strcat was saying https://github.com/mozilla/rust/pull/8035 this wouldn't work?
[06:22:14] <dbaupp> acrichto_: but it bootstraps right?
[06:22:20] <acrichto_> dbaupp: yup, passes all the tests
[06:22:27] <acrichto_> I'm convinced it works just fine
[06:22:28] <dbaupp> awesome!
[06:22:33] <acrichto_> and if bors agrees then yay!
[06:22:38] <acrichto_> if bors disagrees, then I'm wron g:(
[06:22:53] * dbaupp will let strcat review it
[06:23:03] <acrichto_> I couldn't actually think of a concrete case in which the headers were needed
[06:23:21] <dbaupp> and neither could the testsuite
[06:23:45] <dbaupp> it's pretty cool to delete all the is_managed branches.
[06:23:47] <acrichto_> although for some reason valgrind on my ubuntu vm says that a trivial rust program leaks memory "fn main(){}"
[06:24:02] <acrichto_> I'm excited to add *Vec<T> as the RawRepr version of ~[T]
[06:24:05] <dbaupp> with that change?
[06:24:09] <acrichto_> before
[06:24:23] <acrichto_> I didn't get any more leaks with this change
[06:24:31] <acrichto_> but I couldn't exhaustively test it over the rpass suite
[06:24:57] <dbaupp> I get `==30327==    still reachable: 8 bytes in 1 blocks`, but nothing else.
[06:25:03] <dbaupp> (debian)
[06:25:17] <acrichto_> I was getting Invalid free() / delete / delete[]
[06:25:27] <dbaupp> ... apparently it allocates 14MB though. :/
[06:25:28] <acrichto_> 4 stack frames below "by 0x5FEC2C4: exit (exit.c:93)"
[06:25:40] <acrichto_> I just decided to ignore it
[06:25:46] <acrichto_> dbaupp: hello world allocates 14mb?
[06:25:47] <dbaupp> yeah, nothing like that, just the "client switching stacks" warning
[06:26:15] <dbaupp> acrichto_: valgrinding `fn main(){}`: `total heap usage: 29 allocs, 28 frees, 14,691,024 bytes allocated`
[06:26:23] <acrichto_> :(
[06:26:40] <dbaupp> and optimisations make no difference
[06:27:13] <dbaupp> newrt only allocates 116951 though
[06:27:16] <dbaupp> <3 newrt
[06:27:31] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[06:27:40] *** Joins: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[06:27:56] <aatch> dbaupp, probably because newrt doesn't spin up *3* threads.
[06:28:00] <dbaupp> it does do 171 allocations though. :(
[06:28:16] <dbaupp> aatch: probably.
[06:28:19] <Luqman> what to break on in gdb with the new runtime? upcall_fail doesn't seem to be doing the trick
[06:29:08] *** Joins: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP)
[06:31:42] *** Quits: pyrac (pyrac@moz-873BFA0.w90-5.abo.wanadoo.fr) (Quit: pyrac)
[06:31:48] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[06:35:00] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:36:31] *** Quits: gavinb (gavinb@54F1A9B6.2D55314.C3991EA9.IP) (Quit: gavinb)
[06:38:13] <dbaupp> Luqman: if you dump the symbols out of libstd, you should be able to break on `_ZN2rt4task14__extensions__10meth_...12begin_unwind16_...` (you'll have to fill in the dots with the appropriate thing for your build.
[06:38:42] <dbaupp> )
[06:39:05] * dbaupp thinks one of the fail functions should be #[no_mangle]
[06:40:04] <Luqman> dbaupp: thanks.
[06:40:09] <Luqman> and yep, that would be useful
[06:48:13] <aatch> probably something like __rust_fail
[06:52:13] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:53:27] <sfackler> acrichto_: everything compiled fine but make check failed at run-pass/conditional-debug-macro-off.rs which seems wrong
[06:53:39] <sfackler> for adding default impls
[06:54:15] <Luqman> sfackler: that's probably because you didn't run configure with --enable-debug
[06:54:51] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[06:55:35] <sfackler> oh, i'm actually configured _with_ enable-debug. that'd do it
[06:57:22] <Luqman> oh right, vice-versa is what i'm thinking :P
[06:59:17] *** Joins: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr)
[07:00:07] <sfackler> looks like #8020 should fix that
[07:02:04] <acrichto_> sfackler: really? awesome!
[07:02:19] <acrichto_> default methods have progressed farther than I thought
[07:02:29] <acrichto_> sfackler: or wait did you delete the is_empty() implementations that already exist?
[07:04:36] <sfackler> not yet
[07:04:58] <sfackler> but I think it should work since the Iterator::size_hint default seems to work
[07:05:12] *** Joins: timm (timm@moz-37B954AF.superkabel.de)
[07:05:22] <acrichto_> I'd be curious because I think that's where I ran into problems awhile back, but sully has put in tons of fixes since then
[07:05:33] <engla> there is a lot to do with default methods everywhere, std::num for example
[07:05:36] <engla> should be fun
[07:06:53] *** Quits: timm (timm@moz-37B954AF.superkabel.de) (Ping timeout)
[07:07:06] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:09:33] <jdm> Luqman: does rust_task_fail work instead?
[07:09:35] *** Joins: Ms2ger (Ms2ger@E699BE68.4A4AF98A.F15B0BB3.IP)
[07:13:03] <Luqman> jdm: nope
[07:14:54] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Quit: Leaving)
[07:16:40] <engla> sfackler: this pr should land soon https://github.com/mozilla/rust/pull/8015
[07:17:27] <jensnockert> \o/
[07:17:34] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[07:18:22] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[07:21:08] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[07:22:02] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[07:22:09] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[07:22:40] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:22:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/9lzjFQ
[07:22:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:22:55] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[07:23:34] *** Joins: pyrac (pyrac@D38C35DB.73C89388.AD05C589.IP)
[07:25:39] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:25:39] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/iE16Nw
[07:25:39] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:25:41] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:25:41] <ghrust> 01[13rust01] 15bors pushed 12 new commits to 06auto: 02http://git.io/rm5Xcg
[07:25:41] <ghrust> 13rust/06auto 146cebc66 15Michael Sullivan: Fix a default method polymorphism bug.
[07:25:41] <ghrust> 13rust/06auto 14311564f 15Michael Sullivan: Add a to_owned_vec method to IteratorUtil.
[07:25:41] <ghrust> 13rust/06auto 1487073f1 15Michael Sullivan: Refactor a bunch of lookup_vtable to reduce rightward drift and clean things up.
[07:25:43] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:26:21] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[07:26:38] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[07:26:53] <bjz> sully: woo!
[07:27:31] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[07:30:11] *** Quits: dreamer__ (dreamer_@90E8C08F.8480A87C.DDAA0084.IP) (Ping timeout)
[07:30:39] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[07:31:59] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[07:32:42] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Quit: Leaving)
[07:32:49] *** Quits: doomlord__ (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Quit: Leaving)
[07:32:49] *** Joins: victorporof (victorporo@99523647.271BFD43.9B1E38F4.IP)
[07:33:51] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[07:34:23] <sully> yeah, so, I basically don't know of any more bugs in default methods
[07:34:34] <sully> assuming this PR passes
[07:34:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:34:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1488757a9 to 14ba9c3eb: 02http://git.io/N3iJvQ
[07:34:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:34:42] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:34:42] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/d73FlQ
[07:34:42] <ghrust> 13rust/06auto 1484eac6b 15James Deng: ast::Lifetime contains ast::Name instead of ast::ident.
[07:34:42] <ghrust> 13rust/06auto 1425ea625 15James Deng: Rewrite an expansion of quote_item to manual ast construnction.
[07:34:42] <ghrust> 13rust/06auto 14f576d07 15James Deng: Added a note about the deletion of a quote_item.
[07:34:43] <sully> if anybody finds any, I am very intersted!
[07:34:44] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:34:53] <dbaupp> sully: maybe you should make some so you have some more things to fix
[07:34:55] <sully> argh, it *just* failed
[07:35:05] <dbaupp> (because clearly there aren't enough bugs left.)
[07:35:44] <Jesse> " LLVM is implemented in C++, which isn't well known for its pattern matching capabilities"
[07:35:46] <Jesse> "but it does offer a very general template system that allows us to implement something similar"
[07:35:46] <Jesse> !!!
[07:35:47] <Jesse> http://www.aosabook.org/en/llvm.html
[07:36:02] <sully> oh, grum, I appear to be bad
[07:38:34] *** Joins: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net)
[07:38:56] <dbaupp> Jesse: Rust's look nicer!
[07:39:23] <dbaupp> (but it's a little crazy that you can actually do that in C++.)
[07:39:32] <Jesse> yeah. i wonder how efficient it is.
[07:39:57] <Jesse> can we make pattern matching be the next ad-hoc benchmark that tops HN?
[07:40:39] <bjz> dbaupp: should we divide Num into Ring and DivRing?
[07:40:42] <bjz> https://github.com/mozilla/rust/issues/4819#issuecomment-21537983
[07:41:02] <dbaupp> bjz: I'd vote yes
[07:41:17] <bjz> dbaupp: Does a Field have recip?
[07:41:35] <dbaupp> bjz: yes, that's essentially the extra operation a field has over a ring
[07:41:50] <bjz> jensnockert: ^
[07:42:00] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[07:42:24] <bjz> dbaupp: I might just do it
[07:42:26] <bjz> :)
[07:42:28] <sebcrozet> bjz: yes. This could be useful for Vectors
[07:42:32] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[07:42:39] * dbaupp hugs bjz
[07:43:10] <bjz> what should the type params for the Operator traits be?
[07:43:19] <bjz> what I specified in the comment?
[07:43:24] <jensnockert> bjz: T, T.
[07:43:37] <bjz> Self, Self you mean?
[07:43:39] <jensnockert> Yeah.
[07:43:44] <jensnockert> Sorry, haven't slept for days.
[07:43:46] <bjz> coolies
[07:43:53] * dbaupp hugs jensnockert
[07:43:54] <bjz> jensnockert: go to sleep
[07:43:58] <bjz> >:[
[07:44:11] <bjz> }:(
[07:44:30] <bjz> >L<
[07:45:04] <jensnockert> 'dem drills though :(
[07:45:08] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[07:45:33] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[07:46:39] <Jesse> bjz: i liked the idea of making integer divison (where there's a remainder) a different trait from rat and real division
[07:46:41] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:46:41] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1464f6b4f to 14ba9c3eb: 02http://git.io/N3iJvQ
[07:46:41] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:47:04] <bjz> Jesse: mm
[07:47:31] <bjz> Jesse: folks would freak out if we got rid of the operator for integer division though
[07:47:46] <jensnockert> Yes.
[07:47:51] <bjz> :(
[07:48:06] <jensnockert> Even though it is a silly thingâ€¦
[07:48:09] <jensnockert> Silly integersâ€¦
[07:48:12] <bjz> Jesse: we had a MASSIVE bikeshed about it
[07:48:23] <bjz> jensnockert: are you cursing MATHS
[07:48:31] <Jesse> it should be a different operator and it should return a tuple
[07:48:56] <jensnockert> bjz: No, just saying integers are a substandard species of numbers.
[07:49:03] * dbaupp likes integers
[07:49:18] <bjz> discrete math ftw
[07:49:38] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[07:49:45] <Jesse> having a trait called Ring would make me happy
[07:50:01] <jensnockert> bjz: But that's mostly polynomials, that doesn't count.
[07:50:05] <bjz> Jesse: I will add it in my next PR then
[07:50:08] <dbaupp> bjz: pssh, discrete maths! more like (abstract) algebra.
[07:50:15] <dbaupp> <3 algebra
[07:50:16] <bjz> dbaupp: aye
[07:50:20] <jensnockert> Linear algebra, fuck yeah.
[07:50:32] <bjz> what about geometric algebra?
[07:50:37] * dbaupp hugs algebra
[07:50:44] <Jesse> i32 are fake integers just like f32 are fake reals
[07:50:49] <Luqman> analysis is not bad
[07:50:50] <bjz> generalised linear algebra
[07:51:03] <bjz> (that is what geometric algebra is)
[07:51:05] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[07:51:06] * dbaupp hugs (parts of) analysis
[07:51:51] <dbaupp> Jesse: they're just integers mod 2^32 using a non-standard representation.
[07:51:58] <dbaupp> (i32, that is.)
[07:52:11] <jensnockert> Jesse: f32 are not fake reals.
[07:52:17] <dbaupp> (for some implementations of i32s)
[07:52:35] <jensnockert> Jesse: Hyperreals maybe, but not reals.
[07:52:35] *** Joins: timm (timm@moz-37B954AF.superkabel.de)
[07:52:36] <dbaupp> jensnockert: they're certainly not real reals
[07:52:51] <jensnockert> dbaupp: Inf gives it away, mostly.
[07:52:56] <dbaupp> *really not real reals
[07:53:07] * dbaupp just wants to say 'real' a lot
[07:53:16] <Jesse> f32 aren't even associative!
[07:53:37] <Ms2ger> ^ fun fact
[07:53:40] <dbaupp> yeah, it breaks everything :(
[07:53:56] <Ms2ger> "Quacks like a real", maybe
[07:53:57] <dbaupp> </3 non-associative "reals"
[07:54:08] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[07:54:20] <Ms2ger> (If you're slightly hard of hearing)
[07:54:59] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[07:55:27] <dbaupp> haha
[07:55:40] <jensnockert> Not being associative isn't badâ€¦
[07:55:59] <jensnockert> Doesn't break much in practice.
[07:56:47] <mihneadb> hi, I m trying out this code http://pastebin.mozilla.org/2705980 and it takes a while (about 1.5s)
[07:56:56] <mihneadb> why is that? do channels take long to set up?
[07:58:26] <dbaupp> mihneadb: it takes 0.007s for me. what platform?
[07:59:00] <mihneadb> dbaupp: linux, 64
[07:59:05] <dbaupp> oh, same.
[07:59:05] <mihneadb> I am using rust run
[07:59:06] <mihneadb> so
[07:59:10] <mihneadb> might be longer compilation'
[07:59:22] <dbaupp> oh, right, yeah, rust run runs rustc and then the executable.
[07:59:29] <mihneadb> yes
[07:59:38] <mihneadb> but it takes quite a while (1.5s) to compile this
[07:59:41] <mihneadb> seems a bit much
[08:00:01] <dbaupp> yup. it's a problem :(
[08:00:06] <mihneadb> known?
[08:00:11] <dbaupp> yes
[08:00:13] <Ms2ger> 1.5s is a while?
[08:00:19] <dbaupp> rustc is *very* slow at compiling
[08:00:21] <mihneadb> Ms2ger: for that file?
[08:00:28] <dbaupp> Ms2ger: for a 12 lines program, yes.
[08:00:29] <Ms2ger> I dunno :)
[08:00:45] <mihneadb> dbaupp: ah, ok. :)
[08:00:47] <Ms2ger> I only compile several million-line programs :)
[08:01:05] <dbaupp> rusti: let (port, chan) = stream(); do spawn { chan.send(10); } println(int::to_str(port.recv()));
[08:01:12] <dbaupp> ... not here.
[08:01:14] <jensnockert> I only compile 12-line C++ programs that never finish compilingâ€¦
[08:01:25] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Connection reset by peer)
[08:01:31] <mihneadb> jensnockert: stop using templates? :P
[08:01:31] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[08:01:38] <jensnockert> mihneadb: Never!
[08:01:46] <mihneadb> =(
[08:01:54] <dbaupp> jensnockert: hold the computer upside down, it makes the templates flow to the other end of the memory and it works better.
[08:02:04] <jensnockert> They are literally the only thing I like about C++.
[08:02:04] * dbaupp is a C++ guru
[08:02:06] <bjz> jensnockert: yay for templates :)
[08:02:28] <jensnockert> Oh, and constexpr.
[08:02:30] <mihneadb> dbaupp: ++
[08:02:32] <jensnockert> I like constexpr.
[08:02:40] <bjz> jensnockert: those are the things I like about D
[08:02:51] <bjz> jensnockert: they do it better in D
[08:03:02] <jensnockert> bjz: Yeah, but I can run it everywhere in C++.
[08:03:09] <mihneadb> C++ evals to D, right?
[08:03:11] <bjz> jensnockert: ?
[08:03:28] * kemurphy walked in to ask about plans for compile-time fn evaluation, and it looks like we're already discussing it?
[08:03:37] <jensnockert> bjz: Like on fancy iPhones and stuff.
[08:03:59] <bjz> jensnockert: oh ok. I'm looking from a design perspective.
[08:04:08] <bjz> kemurphy: hopefully
[08:04:29] <bjz> kemurphy: I believe pcwalton has mentioned it in passing on Reddit
[08:04:36] <jensnockert> bjz: Yes, and I can agree, but if I must make a pact with the devil, I can just as well pick C++.
[08:04:44] <bjz> jensnockert: yup
[08:04:48] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[08:04:59] <kemurphy> oh, one other point of sadness i just noticed
[08:05:20] <jensnockert> bjz: Someone should implement constexpr in Rust.
[08:05:21] <bjz> jensnockert: if C++ had concepts, templates would be even better. but the compile times would shoot through the roof
[08:05:42] <kemurphy> https://gist.github.com/kemurphy/6077737
[08:05:47] <bjz> jensnockert: we have concepts, but not templates
[08:05:50] <jensnockert> bjz: Compiletimes shot through the roof 20 years ago in C++.
[08:05:54] <kemurphy> foo and bar generate *wildly* different code
[08:05:55] <bjz> :)
[08:06:03] <kemurphy> and they absolutely should not, i think
[08:06:29] <dbaupp> kemurphy: known bug :P
[08:06:50] <kemurphy> dbaupp: bug number?
[08:07:00] <dbaupp> kemurphy: finding it
[08:07:00] <kemurphy> dbaupp: would be easier to fix this before pushing further on the width thing
[08:07:21] * kemurphy feels it is just a matter of the parser not working hard enough
[08:08:21] <dbaupp> kemurphy: https://github.com/mozilla/rust/issues/7435
[08:08:29] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[08:08:34] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[08:08:53] <kemurphy> dbaupp: delicious, thanks
[08:09:26] <dbaupp> kemurphy: fix it! :D
[08:09:51] <bjz> kemurphy: I would love some more compile time goodness
[08:10:32] * dbaupp was going to see how much he needed to change to make #[cfg] turing-complete
[08:10:38] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Input/output error)
[08:10:39] <bjz> kemurphy: it would really strike at the heart of C++'s hallowed grounds
[08:10:43] <dbaupp> bjz: that^'d be fine, right?
[08:11:03] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[08:11:23] <bjz> dbaupp: are you saying limiting it to cfg?
[08:11:37] <bjz> don't really understand
[08:12:01] *** Quits: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP) (Quit: Quitting)
[08:12:11] <bjz> dbaupp: I find it strange that cfg uses a different syntax to boolean expressions in rust
[08:12:20] <dbaupp> bjz: no, using #[cfg]'s to "perform" computations. e.g. #[setcfg(foo, and(bar, baz))] mod bar { #[cfg(foo)] static bar: uint = 1; } ...
[08:12:25] <dbaupp> it's a stupid idea :P
[08:12:44] <jensnockert> dbaupp: Yeah, needs moar constexpr.
[08:12:54] *** Joins: heftig (heftig@8D5076D2.6FC4DE2F.FEC4A986.IP)
[08:13:10] <dbaupp> in theory one could write a macro that loads rustc and actually executes functions.
[08:13:16] <dbaupp> ... in theory.
[08:13:25] <jensnockert> dbaupp: In practice, constexpr.
[08:13:33] * jensnockert does jedi mind-trick.
[08:14:06] <bjz> dbaupp: it just sucks to have to jump out of the context of rust. The great thing about D is that its pretty much seemless. but that might be too much to ask
[08:14:06] <dbaupp> I think we should use some sort of constexpr? ... has anyone suggested this?
[08:14:23] <jensnockert> dbaupp: No idea.
[08:14:23] <dbaupp> bjz: yeah, I've seen D's in passing, and it looks *very* nice.
[08:14:36] <bjz> we already have constexpr, but it's limited to numeric operators
[08:14:38] <dbaupp> jensnockert: oh, looks like I'm the first. :P
[08:14:39] <jensnockert> dbaupp: But it kind of replaces #[cfg], which is nice.
[08:14:43] *** Quits: jdm (jdm@moz-9EAFE56A.dsl.teksavvy.com) (Quit: Lost terminal)
[08:14:46] <jensnockert> bjz: No we don't.
[08:14:59] <dbaupp> bjz: it's limited to built in types in a really adhoc way.
[08:15:06] <bjz> yeah
[08:15:16] <jensnockert> bjz: We have some random optimisations we can do at compile-time, not the same.
[08:15:25] <bjz> jensnockert: I know, but in an 'ish; kind of way
[08:15:29] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[08:15:45] <bjz> rusti: static X: int = 1 * 2; X
[08:15:53] <jensnockert> No ish, implement!
[08:16:03] <bjz> (rusti is out for lunch)
[08:17:09] <bjz> rusti: static X: int = 2; static Y: int = X * 2; Y // should work
[08:17:20] <dbaupp> it does.
[08:17:23] <dbaupp> (I think.)
[08:17:30] <bjz> same with as
[08:17:55] <jensnockert> bjz: I know bitwise operators do not work at least.
[08:17:55] *** Quits: timm (timm@moz-37B954AF.superkabel.de) (Connection reset by peer)
[08:17:58] <dbaupp> bjz: https://github.com/mozilla/rust/issues/7080 you mean?
[08:18:00] <jensnockert> bjz: I tried yesterday.
[08:18:32] *** Joins: timm (timm@moz-37B954AF.superkabel.de)
[08:18:53] <bjz> static IDENTITY: Vec2<f32> = Vec2::from_value(1.0);
[08:20:12] <dbaupp> gah! this article keeps changing... now rust is fast again, http://togototo.wordpress.com/2013/07/23/benchmarking-level-generation-go-rust-haskell-and-d/
[08:20:22] * dbaupp should stop bringing it up
[08:21:00] <jensnockert> dbaupp: Well, as long as we're faster than GCC, we're fine.
[08:23:17] <Jesse> togototo needs to learn how to make HTML tables
[08:24:20] <bjz> dbaupp: are Rings/Fields Orderable?
[08:24:26] <dbaupp> bjz: nope
[08:24:28] <bjz> oh I guess not
[08:24:30] <bjz> oh yep
[08:24:34] <bjz> like vectors
[08:24:36] <dbaupp> yeah
[08:24:43] <bjz> or Quaternions
[08:24:59] <Thiez> there is this quote in the article from a 'kibwen' that says that the unsafe pointers exist only for C interop and have no bearing on normal code, surely that isn't true?
[08:25:09] <dbaupp> Thiez: (that's bstrie, btw.)
[08:25:28] <Thiez> okay
[08:25:47] *** Quits: lerc (quassel@moz-598ED764.telstraclear.net) (Ping timeout)
[08:25:48] *** sam113101 is now known as sam113101_afk
[08:25:59] <dbaupp> and for most definitions of normal, you'll never use a *. (but the C interop bit is less true, since many smart pointers will use *.)
[08:26:06] <bjz> Thiez: they're used behind the scenes for implementing Rc and Gc I think
[08:26:11] <bjz> right?
[08:26:11] *** sam113101_afk is now known as sam113101
[08:26:22] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[08:26:56] <Thiez> probably.
[08:28:59] <Thiez> the lockless messagequeue I wrote used * as well
[08:30:23] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[08:31:55] <jensnockert> Yeah, Rc uses *.
[08:32:18] <jensnockert> But still, I don't think most code requires *.
[08:33:30] <Luqman> jensnockert: actually i think Rc uses ~ now
[08:33:45] <bjz> should Ring require Neg<Self>?
[08:33:50] * jensnockert tries to wrap head around how that works.
[08:33:55] <bjz> or should that just be on Signed?
[08:34:03] <jensnockert> Ring would require Neg.
[08:34:06] <bjz> should we have Signed?
[08:34:09] <dbaupp> Luqman: it uses ~ to allocate, but converts it to a * for storage.
[08:34:10] <jensnockert> A ring has a Zero-element.
[08:34:23] <jensnockert> bjz: Realize that 'Ring' implies something more than the operators though.
[08:34:26] <Thiez> Luqman: where is Rc in the code?
[08:34:31] <bjz> jensnockert: sure
[08:34:32] <dbaupp> Thiez: extra::rc
[08:34:42] <Luqman> dbaupp: yep, induces amnesia in the compiler (forget)
[08:34:49] <dbaupp> Luqman: https://github.com/mozilla/rust/pull/8022/files was the change.
[08:34:55] * dbaupp checked it a few minutes ago
[08:35:09] <bjz> jensnockert: yeah, I have Ring with Zero, also the multiplicative identity, One
[08:35:47] <Luqman> argh, new rt doesn't like ipv4-mapped ipv6 addresses
[08:35:51] <bjz> jensnockert: wonder if we should just have mul_ident and add_ident
[08:35:54] <Thiez> so it still uses *mut, it just uses ~ for allocation because the headers are gone
[08:35:56] <jensnockert> Luqman: Code like â€¦ unsafe fn owned_to_raw<T>(mut box: ~T) -> *mut T
[08:36:21] <Thiez> I wonder why it has a 'owned_to_raw' function when transmute would have done the same thing :)
[08:36:22] <jensnockert> bjz: We usually call those one and zero though.
[08:36:53] <bjz> jensnockert: mmk. not too important, was just musing
[08:37:08] <bjz> jensnockert: should Rings have abs?
[08:37:18] <jensnockert> bjz: No.
[08:37:42] <dbaupp> Thiez: for forgetting, I think.
[08:37:54] <bjz> https://en.wikipedia.org/wiki/Absolute_value
[08:38:05] <dbaupp> Thiez: (so that the ~ doesn't get freed.)
[08:38:17] <dbaupp> bjz: Rings don't have a concept of sign, so no abs.
[08:38:23] <bjz> ok
[08:38:30] <dbaupp> (in general, that is.)
[08:38:31] <jensnockert> dbaupp: More like Sqrt.
[08:38:44] <dbaupp> jensnockert: ?
[08:38:50] <jensnockert> dbaupp: sqrt(x^2)
[08:38:57] <jensnockert> dbaupp: sqrt(x * x)
[08:39:07] * dbaupp doesn't like that definition of abs.
[08:39:13] <bjz> dbaupp: https://en.wikipedia.org/wiki/Ordered_ring <- interesting
[08:39:15] <Thiez> dbaupp: ah, I see you're correct, in my memory transmute implied a forget, but that's no longer true
[08:39:36] <dbaupp> bjz: heh :)
[08:39:45] <Thiez> I think I'm confused with the old cast function that has since been removed
[08:39:50] <dbaupp> bjz: (even so, a general ring isn't ordered.)
[08:40:01] <bjz> dbaupp: should Orderable be OrdRing?
[08:40:01] <dbaupp> Thiez: ah, right. reinterpret_cast?
[08:40:15] <dbaupp> bjz: Orderable can be merged into Ord with default methods, right?
[08:40:18] *** Joins: jaen (jaen@moz-3AD6EFBC.play-internet.pl)
[08:40:27] <Thiez> reinterpret_cast<T,U>(t:T)->U{ let x = transmute(t); forget(t); x } <- it was something like this, as I recall
[08:40:33] <bjz> dbaupp: Ord doesn't require clone :[
[08:40:41] <bjz> dbaupp: I tried before
[08:40:53] <dbaupp> bjz: it should return &'a T
[08:40:54] *** Joins: KindOne (KindOne@C8A688FC.EF25844A.D6529392.IP)
[08:41:00] <bjz> dbaupp: ohhhh
[08:41:08] <bjz> dbaupp: I will do that then!
[08:41:12] <bjz> dbaupp: nice!
[08:41:23] * dbaupp hugs lifetimes
[08:44:34] <dbaupp> Thiez: I see! makes sense.
[08:50:28] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:55:10] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[08:56:51] *** Joins: Blub\w (wry@moz-C3D14D56.vps.tuwien.ac.at)
[08:56:58] <kemurphy> hm, there's no way to figure out mid-parse if an ident is referring to a struct or enum variant is there?
[08:57:28] <kemurphy> also, same question but mid-fold instead of mid-parse
[08:57:40] <jensnockert> I somehow doubt it.
[08:57:48] <kemurphy> i wouldn't expect so mid-parse
[08:57:54] <jensnockert> No idea how to differ a tuple-like struct from an enum variant.
[08:58:08] <kemurphy> i don't care about differentiating them
[08:58:23] <kemurphy> i want to differentiate those from an actual fn call
[08:58:31] <jensnockert> Ohâ€¦
[08:58:38] <kemurphy> parser is making things expr_call that should be expr_struct
[08:58:48] <kemurphy> the alternative is to handle it better in trans, i guess
[08:59:02] <jensnockert> I think StructName(something, something) is supposed to be expr_call.
[08:59:13] <kemurphy> well, it certainly is currently
[08:59:18] <kemurphy> but i really don't think it should be
[08:59:38] <jensnockert> Syntax-wise they are indistinguishable.
[08:59:43] <jensnockert> But I see your point.
[08:59:55] <kemurphy> exactly
[09:00:07] <kemurphy> i want to distinguish them before it makes it to trans
[09:01:42] *** Quits: dew (Instantbir@moz-2C6F2E2.dhcp.stls.mo.charter.com) (Ping timeout)
[09:02:23] <dbaupp> kemurphy: you could add a `struct-distinguisher` pass.
[09:02:24] <Luqman> kemurphy: at resolve perhaps
[09:02:30] <dbaupp> ... or that.
[09:02:54] <kemurphy> which is easier, and which would be more preferable?
[09:03:28] <Luqman> if you do end up doing that it would mean unifying all the places where newtype structs are handled separately from regular structs
[09:03:42] <dbaupp> (tuple structs, fwiw.)
[09:03:58] <kemurphy> Luqman: this is the goal, in fact
[09:04:05] <dbaupp> kemurphy: I guess the pass would be easier, but reusing a current fold would be preferable.
[09:04:06] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:04:49] <kemurphy> dbaupp: of course, figures. i'll go for the fold and resort to a new pass if i get too stumped
[09:04:55] <kemurphy> where does resolve happen?
[09:05:04] <dbaupp> middle::resolve
[09:05:22] <dbaupp> it's 5419 lines, btw.
[09:05:26] <kemurphy> oof
[09:05:36] * kemurphy $ grep expr_call
[09:05:39] <dbaupp> yeah... :(
[09:05:57] <dbaupp> in any case, I guess this has to run after resolve has finished entirely.
[09:06:15] * dbaupp doesn't know how resolve works, so is probably wrong.
[09:06:31] * kemurphy would strongly prefer to be able to solve this at the ast level
[09:06:56] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[09:07:24] <kemurphy> hm, expr_call doesn't appear anywhere in resolve
[09:08:37] <dbaupp> yeah... I guess just add a new pass that uses syntax::fold. and then get someone who knows what they're talking about to tell you where to actually put it.
[09:08:54] <dbaupp> (since presumably it'll be merged with some other fold.)
[09:11:05] <kemurphy> what's middle/astencode.rs for?
[09:13:39] <dbaupp> writing the ast to crate metadata
[09:14:17] *** Joins: xraycat (Adium@moz-64B9DD7.pool.mediaways.net)
[09:15:10] <kemurphy> ah, not what i want then
[09:16:14] *** Joins: lerc (quassel@moz-598ED764.telstraclear.net)
[09:17:10] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Ping timeout)
[09:17:16] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[09:21:24] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[09:21:46] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[09:27:32] *** Quits: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net) (Ping timeout)
[09:27:38] <bjz> dbaupp: should we have Semiring which only impls Add, Mul, Zero and One?
[09:28:13] *** Quits: jaen (jaen@moz-3AD6EFBC.play-internet.pl) (Ping timeout)
[09:28:20] <dbaupp> bjz: if you're asking if we should make Rust's numerical traits the same as the mathematical names, I'll always say yes. :P
[09:28:27] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[09:29:09] *** Joins: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net)
[09:31:52] <madmoose> Doesn't INT_MIN stomp all over your nice algebraic structures?
[09:32:48] <dbaupp> madmoose: not mine, i32/u32 etc are still rings.
[09:33:11] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[09:34:51] *** Joins: doomrobo (doomrobo@EC9C662A.161AAEB2.58B1C2DD.IP)
[09:35:04] <doomrobo> hey, I can anyone point me in the direction of the rust binaries for OSX?
[09:35:37] *** Quits: Blub\w (wry@moz-C3D14D56.vps.tuwien.ac.at) (Ping timeout)
[09:36:09] <doomrobo> *can anyone
[09:38:30] <bjz> dbaupp: is it `trait DivRing: Field` or `trait Field: DivRing`
[09:38:42] <dbaupp> bjz: the latter
[09:38:43] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[09:38:50] <bjz> thought so
[09:40:05] <dbaupp> bjz: ... actually I'm not sure what DivRing gives us over Field
[09:40:22] <bjz> dbaupp: should we just call it Field then?
[09:40:25] <dbaupp> "Division rings differ from fields only in that their multiplication is not required to be commutative"
[09:40:27] <dbaupp> bjz: yeah
[09:40:53] <bjz> Oh, integers
[09:41:01] <dbaupp> hm?
[09:41:09] <bjz> are integers fields?
[09:41:18] <dbaupp> nope
[09:41:29] <bjz> are they divrings?
[09:41:31] <dbaupp> they're not a division ring either
[09:41:38] <bjz> ok
[09:41:39] <bjz> cool
[09:41:55] <dbaupp> "minimum" div ring is quaternions
[09:42:28] <jensnockert> Like I said, integers suck.
[09:42:51] <dbaupp> jensnockert: that's just 'cos you're using them wrong :P
[09:43:00] <bjz> they're just different
[09:43:20] <jensnockert> dbaupp: Yes, I use them as fixed-point numbers.
[09:43:34] <jensnockert> CAN'T STOP ME NOW! I'M HAVING A BALL!
[09:43:59] * bjz thinks jensnockert is going insane from sleep deprivation
[09:44:02] <bjz> :)
[09:44:15] * jensnockert thinks I cannot remember Queen lyrics well in this state.
[09:44:22] * jensnockert was insane before as well.
[09:44:37] <bjz> dbaupp: but integers are Rings aren't they
[09:44:43] <dbaupp> bjz: correct
[09:45:19] <doomrobo> do there even exist OSX binaries for rustc?
[09:45:33] <bjz> dbaupp: I wish we could enforce associativity
[09:45:43] <bjz> dbaupp: like in fortress
[09:45:44] <dbaupp> doomrobo: I think you can get some by homebrew/whatever-the-other-one-is
[09:46:00] <doomrobo> dbaupp nope, brew install rustc doesn't work
[09:46:07] <doomrobo> nor does port
[09:46:21] <dbaupp> bjz: we just need to monitor all usage of Add/Mul and hunt people down who misuse them
[09:46:23] <doomrobo> whoops, spoke too soon. brew install rust works
[09:46:33] <dbaupp> bjz: (also, floats don't work then :P )
[09:46:42] <bjz> heh
[09:46:50] <bjz> floats are stupid
[09:47:04] * bjz pokes jensnockert
[09:47:21] <nmatsakis> bjz: so yeah fn ptrs are *almost* working, rebasing now---
[09:47:27] * dbaupp hugs jensnockert: "ignore bjz, he's just a big meanie."
[09:47:33] <bjz> nmatsakis: YESSSS
[09:47:36] * jensnockert hugs dbaupp.
[09:47:58] <bjz> nmatsakis: can we set static muts as extern fns?
[09:47:59] * jensnockert also hugs my now possibly illegal copy of IEEE 754-2008.
[09:48:06] <nmatsakis> bjz: should be possible
[09:48:30] <bjz> nmatsakis: aatch said there was some strange restriction
[09:48:31] <Ms2ger> So, broken_multiplication(f32, f32) rather than f32 * f32?
[09:48:43] <bjz> nmatsakis: dunno if it was fixed
[09:48:49] <nmatsakis> bjz: I don't know what he was referring to
[09:49:02] <nmatsakis> bjz: I haven't thought about it hard, but I can give it a try in a bit
[09:49:10] <bjz> nmatsakis: cool
[09:49:23] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[09:49:26] <nmatsakis> bjz: bjz mostly I'm just trying to rebase over the constant trans refactoring that's been going on
[09:49:30] <nmatsakis> :)
[09:49:49] <nmatsakis> well, I think my plan is as follows:
[09:49:58] <bjz> nmatsakis: like: extern "C" fn foo() {} static mut F: extern "C" fn() = foo;
[09:49:59] <nmatsakis> - calling an extern "C" fn will not do a stack switch in and of itself
[09:50:10] <nmatsakis> but there will be an attribute that requests a large size stack
[09:50:18] <nmatsakis> and a lint that warns you if you call an extern "C" fn without this attribute
[09:50:50] <bjz> ok?
[09:51:00] <kemurphy> what's the typechecker's entrypoint?
[09:51:02] <bjz> so what should I do with GL?
[09:51:22] <nmatsakis> bjz: so, in that example you are taking a fn defined in Rust,
[09:51:22] *** Joins: libertas (libertas@moz-8B59994C.cpe.netcabo.pt)
[09:51:28] <jensnockert> nmatsakis: How would that match up with LLVM intrinsics? Some of them require stack?
[09:51:29] <kemurphy> never mind, found it
[09:51:32] <nmatsakis> bjz: vs a C fn that you obtained from OpenGL,
[09:51:40] <nmatsakis> bjz: both should work,
[09:51:45] <bjz> nmatsakis: that one is a default
[09:52:00] <nmatsakis> bjz: but we'll have to update the type of Rust fns to be `extern "C" fn` and not `*u8`
[09:52:09] <nmatsakis> bjz: we can do that, but only after my patch lands
[09:52:12] <bjz> nmatsakis: because you can't do closures in static muts or for extern "C" fn
[09:52:26] <bjz> nmatsakis: it would be updated later
[09:52:45] <bjz> nmatsakis: I'll have a huge bank of failing extern "C" fns
[09:52:47] <nmatsakis> jensnockert: I am not sure what scenario you are referring to precisely
[09:52:57] <jensnockert> nmatsakis: sin(x) for example.
[09:53:09] <bjz> nmatsakis: then reassign to the function pointer if it exists
[09:53:32] <bjz> nmatsakis: otherwise the function fails with a decent error - and not a seg fault
[09:54:40] <bjz> nmatsakis: would be nicer if I could do lambda literals in static mut declarations, but I understand the restictions
[09:54:51] <jensnockert> nmatsakis: But when I am thinking about it, none of them that require stack really make sense, we should just re-implement them in Rust.
[09:54:59] <bjz> nmatsakis: does that make sense?
[09:55:01] * jensnockert hugs nmatsakis and goes back into cave.
[09:55:11] *** Joins: Blub\w (wry@moz-5A07BBD5.vps.tuwien.ac.at)
[09:56:18] <nmatsakis> bjz: so...the idea is that the default values will just be something that fails?
[09:56:30] <slaren> is there any trait that would let me convert an enum to some integer type ?
[09:56:43] <bjz> nmatsakis: well, that's what I'm going to implement for GL
[09:56:52] <nmatsakis> bjz: sounds reasonable, iiuc
[09:57:03] <bjz> nmatsakis: I wouldn't say that should be there in Rust though
[09:57:10] <nmatsakis> slaren: I'm not sure...maybe? C-like enums can be cast to int, but I know we were talking about dading such a trait
[09:57:52] <slaren> nmatsakis: I know they can be cast, but I need to do it in a generic container
[09:58:23] <slaren> if that sounds bad, I am trying to make a trait to use bitflags in a more intuitive way
[09:58:53] <slaren> so that i could have a type BitFlags<EnumType, IntegerType> and have it handle all the details
[09:59:16] <bjz> nmatsakis: I'm saying it'd be nice to do: static mut glFoo: extern "C" fn(x: GLint) -> GLint = extern "C" |x| fail!("glFoo not loaded (called with x: %?)", x);
[09:59:18] *** Quits: Blub\w (wry@moz-5A07BBD5.vps.tuwien.ac.at) (Quit: bbl)
[09:59:58] <nmatsakis> bjz: I would like that to eventually work, or something much like it
[10:00:05] <bjz> nmatsakis: ok cool
[10:00:14] <bjz> nmatsakis: I can do the workaround for now
[10:00:18] <nmatsakis> bjz: I envisioned "static mut glFoo: extern "C" fn(x: GLint) -> GLint = |x| fail!"
[10:00:26] <bjz> nice
[10:00:57] <bjz> nmatsakis: the awesome advantage of using static muts is it will be seamless
[10:01:08] *** Joins: sk (sk@4D49710A.1FD35C61.78DD174B.IP)
[10:01:51] <bjz> nmatsakis: no need for a struct
[10:02:27] <nmatsakis> slaren: the compiler uses something similar, see src/librustc/util/enum_set.rs,
[10:02:38] *** Joins: jaen (jaen@moz-3142E42F.neoplus.adsl.tpnet.pl)
[10:02:45] <nmatsakis> slaren: but right now the trait I'm using is kind of a "one off", I think we had talked about having it in the std library with deriving support
[10:03:29] <slaren> nmatsakis: alright, thanks
[10:03:31] <nmatsakis> but I don't see any code for that in deriving/mod.rs
[10:03:37] <nmatsakis> so I guess it hasn't happened
[10:04:35] <nmatsakis> does anyone know where graydon's new emacs rust mode is?
[10:04:48] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[10:04:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/RNFe6g
[10:04:48] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[10:05:11] <nmatsakis> ah, #8031
[10:07:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:07:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Rl4GcA
[10:07:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:07:47] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[10:07:47] <ghrust> 01[13rust01] 15bors pushed 13 new commits to 06auto: 02http://git.io/GcnVPA
[10:07:47] <ghrust> 13rust/06auto 14172ea83 15Michael Sullivan: Get rid of an unused variable warning.
[10:07:47] <ghrust> 13rust/06auto 1489c4af0 15Michael Sullivan: Fix a default method polymorphism bug.
[10:07:48] <ghrust> 13rust/06auto 144b9759e 15Michael Sullivan: Add a to_owned_vec method to IteratorUtil.
[10:07:50] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[10:12:09] <doomrobo> is there any way to do regex in rust at the moment?
[10:12:23] *** Quits: pyrac (pyrac@D38C35DB.73C89388.AD05C589.IP) (Quit: pyrac)
[10:12:39] <doomlord> heh doomy nicks
[10:13:22] <doomlord> someones going to reply and hit autocomplete on the name :)
[10:13:25] <doomrobo> oh you again
[10:13:33] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[10:13:50] <doomlord> yes i find peace here, no more classes and header files
[10:13:57] <doomrobo> heh
[10:15:13] <doomrobo> wait, no more classes? what?
[10:15:31] <doomlord> yup. struct / trait / impl. no annoying classes
[10:15:43] <doomlord> it actually works the way i want it to work.
[10:16:11] <doomlord> code and data are seperate, not conflated
[10:16:27] *** Joins: pnkfelix|rcirc (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:16:50] <doomrobo> so you write "<struct> has the properties of <trait>" and separately write "the implementation of <trait> for <struct> is <impl>?"
[10:17:22] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[10:17:26] <doomlord> nearly. struct is just data. trait = interface. then impl traits for data .. the data knows nothing
[10:17:30] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:18:17] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Ping timeout)
[10:19:00] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[10:19:27] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[10:19:37] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[10:20:09] <rntz> doomlord: no, you just write "the implementation of <trait> for <type> is <impl>".
[10:20:46] <doomrobo> gotcha
[10:20:46] <rntz> argleblarg
[10:20:55] <rntz> yeah, that should have been to doomrobo
[10:21:06] <doomrobo> rntz do you happen to know if regex is a possibility  in rust yet?
[10:21:13] <doomlord> struct banana { ... }   trait Foo {  do_somthing(self) }    impl Foo for Banana {   do_something(&self)}
[10:21:24] <rntz> uh, I have no idea whether regular expressions are in the standard library or not
[10:21:32] <rntz> it should certainly be possible to implement them in rust
[10:21:47] <doomlord> they are open to contributions to the standard library :)
[10:22:01] * doomrobo is trying to do a toy project to get a hang of rust
[10:22:13] <doomrobo> contributing to the library would have to come *after* this :P
[10:22:27] <doomlord> heh ok :)
[10:23:28] <Ms2ger> rntz, which regexps? perl? python? java? ;)
[10:23:54] <rntz> Ms2ger: "I have no idea whether regular expressions are in the standard library or not" covers that, I think?
[10:24:39] <doomrobo> Ms2ger I don't care which kind, just any will do
[10:24:49] <doomlord> is it better to have regex or more specific string manipulation functions ... i'm not sure if regex is easier than writing functions in a programming language
[10:25:21] <rntz> regular expressions are useful. so are other string manipulation functions. python has a nice mix of both IMO.
[10:26:23] <doomrobo> I'm gonna go out on a limb and say regex should not *replace* certain functions that are useful, but regex is so robust and expressive (pun intended) that it becomes an invaluble tool
[10:26:30] <doomrobo> ?that's often used inappropriately
[10:26:35] <nmatsakis> doomrobo: there was talk of someone writing a reg ex engine in Rust, not sure what became of it
[10:26:48] <nmatsakis> otherwise, I think there are PCRE bindings floating about
[10:26:57] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[10:27:07] <doomrobo> I wish something was standard
[10:27:17] <doomlord> "used inappropriately" .. i have just tried to use grep/sed in makefiles to generate prototypes for c++ :) (#define fn auto ...)
[10:27:18] <doomrobo> I just want to make a nice and pretty parser
[10:28:52] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[10:30:52] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[10:34:09] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:37:07] <kemurphy> dbaupp: score, found a spot to fix it in trans without having to add a pass :D
[10:37:52] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: work)
[10:39:20] *** Quits: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net) (Quit: brendan)
[10:39:27] <Luqman> kemurphy: where?
[10:41:23] <kemurphy> Luqman: the basis is https://gist.github.com/kemurphy/6078607
[10:45:08] <kimundi> graydon: still awake?
[10:46:12] *** Quits: victorporof (victorporo@99523647.271BFD43.9B1E38F4.IP) (Quit: victorporof)
[10:46:12] *** Joins: mye (mye@moz-5743385C.dip0.t-ipconnect.de)
[10:46:14] <kimundi> rntz: ssbr plans to write a proper regex implemntation for rust
[10:47:42] <ssbr> Ms2ger: JS's are pretty standard these days
[10:47:57] <ssbr> in that there is a standard, which has like... what, four, five, six implementations?
[10:48:34] <ssbr> Across a handful of different languages (JS, C#, anything related to those two)
[10:52:32] <bjz> dbaupp: floats do not impl TotalOrd?
[10:52:39] *** Quits: naq (naq@D5C2D2DF.E4265FCD.E481B5B.IP) (Quit: leaving)
[10:53:52] <bjz> dbaupp: is that because you can't be sure that they're equal?
[10:54:06] <bjz> dbaupp: was just looking at https://en.wikipedia.org/wiki/Ordered_ring
[10:54:11] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:02:29] *** Joins: pyrac (pyrac@D38C35DB.73C89388.AD05C589.IP)
[11:04:18] <kemurphy> how do i get rustc to show me the output of debug!()?
[11:05:21] <xraycat> Does anybody know of a graph library for rust besides https://github.com/Tristramg/rust-graph ?
[11:05:50] <kemurphy> crap, tripped an llvm assert
[11:07:02] <slaren> kemurphy: setting RUST_LOG=rustc should do it
[11:07:51] *** Quits: igl (igl@moz-8F1B8F16.adsl.alicedsl.de) (Ping timeout)
[11:08:25] *** Joins: igl (igl@moz-DFFD0851.adsl.alicedsl.de)
[11:08:47] <nmatsakis> kemurphy: I think you have to configure with --enable-debug now, as well
[11:09:10] <kemurphy> ah, i see. thanks
[11:12:55] <slaren> using cast::transmute to convert an enum to an i64 seems to crash the compiler, should I open an issue about it ?
[11:13:32] <slaren> enum test { a }; let t: i64 = unsafe { std::cast::transmute(a) };
[11:14:55] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[11:15:59] <bjz> slaren: does it crash with an internal compiler error, or does it just say something about mismatched widths?
[11:16:38] <bjz> enums don't have garenteed alignments
[11:16:39] <slaren> rust: task failed at 'option::get none', /home/slaren/rust/src/libstd/option.rs:362
[11:16:44] <slaren> that's the failure I get
[11:16:53] <bjz> hmm, well it shouldn't do that
[11:17:06] <bjz> try searching for an issue
[11:17:09] <slaren> bjz: I know the code is bad, but still, probably shouldn't crash the compiler
[11:17:25] <bjz> yeah, crashes shouldn't occur at all
[11:17:28] <bjz> :)
[11:17:50] <slaren> I have been looking at the I-crash issues, haven't found it there
[11:18:25] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[11:20:10] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[11:20:52] <doener> r? https://github.com/mozilla/rust/pull/8041
[11:23:46] <doener> bjz: what kind of test do you have in mind?
[11:23:56] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[11:24:53] <bjz> well you say "Make omission of impossible if-else branches work with constants"
[11:25:40] <bjz> could you have an example of a case where that would occur?
[11:25:53] <bjz> or is it some obscure compiler thingy
[11:26:27] *** Joins: victorporof (victorporo@AF497F7E.60E0D239.9B1E38F4.IP)
[11:30:26] <doomrobo> are there literal strings in rust? if I wanted to use regex do I need to have "\\" for every backslash?
[11:31:49] <doener> bjz: currently "if true { println("foo") } else { println("bar") }" is compiled as just println("foo")
[11:32:00] <doener> bjz: but that only works with true/false literals
[11:32:01] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:32:23] <bjz> doener: ahh, I see!
[11:32:26] <bjz> nice!
[11:32:30] <doener> bjz: the PR makes it work for e.g. "if 5 == 5 { ... } else { ... }" and everything else where LLVM does constant folding for us
[11:32:42] <bjz> yep
[11:32:46] <bjz> awesome
[11:32:56] *** Joins: mib_xj34ge (Mibbit@58C4A58C.6BCA6A47.21C70092.IP)
[11:33:12] <bjz> so how do you help it do that?
[11:33:16] <doener> llvm does the hard work, I really just had to use the result
[11:33:33] <bjz> cool
[11:34:13] <doener> the old code checks for a literal in the ast, I ask LLVM whether the translated value is a constant and if so, I use that to decide which branch to take
[11:34:57] <doener> "use that" == ask LLVM for the constant value
[11:35:06] *** Joins: BitPuffin (quassel@moz-712D2723.bredband.tre.se)
[11:36:40] *** Quits: mib_xj34ge (Mibbit@58C4A58C.6BCA6A47.21C70092.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:38:18] *** Quits: jaen (jaen@moz-3142E42F.neoplus.adsl.tpnet.pl) (Ping timeout)
[11:40:04] <dbaupp> doener: yay! I was hoping someone would do that!
[11:40:30] *** Joins: jaen (jaen@moz-3142E42F.neoplus.adsl.tpnet.pl)
[11:40:40] <dbaupp> bjz: and yeah, floats don't have total ord/eq because NaN.cmp(NaN) = ?? and NaN.equals(NaN) = ??
[11:40:55] <bjz> ahhhh
[11:41:01] <bjz> makes sense
[11:41:01] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:41:10] <bjz> dbaupp: you can r+ it then :)
[11:41:12] <dbaupp> kemurphy: nice! got it to work?
[11:42:14] <dbaupp> doomrobo: not yet, I think there's "plans" for them
[11:42:23] *** Joins: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com)
[11:42:25] <dbaupp> (i.e. like every other neat feature.)
[11:43:44] <doomrobo> how do I abort the program?
[11:43:51] <dbaupp> in what sense?
[11:44:19] <doomrobo> Some shit goes down (if you know how I do) and I need to just quit
[11:44:42] <dbaupp> std::libc::abort() does a hard abort
[11:44:56] <doomrobo> now what does "hard" mean?
[11:45:31] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:45:58] <dbaupp> not dissimilar to dereferencing null.
[11:46:19] <dbaupp> but fail!() will kill the current task (and any tasks linked to it, which are the parents, by default.)
[11:46:31] <dbaupp> so fn main() { fail!() } will quit.
[11:47:54] *** Quits: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) (Client exited)
[11:48:44] <doomrobo> gotcha
[11:48:46] <doomrobo> thanks
[12:00:07] <doomrobo> can I add methods to existing types?
[12:00:12] <dbaupp> doener: is this https://github.com/mozilla/rust/issues/8043 caused by the transmute with arguments of different immediateness?
[12:00:41] <dbaupp> doomrobo: yes; could you give me an example of what you'd like to add to?
[12:01:31] *** Joins: true_droid1 (Adium@moz-123FD9B8.beck.volia.net)
[12:01:46] <doomrobo> dbaupp I'd like to add a pcre_replace_all method to the str type
[12:02:03] <dbaupp> doomrobo: aha, so you'd use a helper trait, e.g.:
[12:02:18] <doener> dbaupp: most likely
[12:02:41] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Ping timeout)
[12:02:45] <doener> dbaupp: enums are never immediate, so that fits
[12:03:04] <dbaupp> doomrobo: trait PCRE { fn pcre_replace_all(&self, args: ...) -> ReturnType; } impl<'self> PCRE for &'self str { fn pcre_replace_all(&self, ...) -> ReturnType { ... } }
[12:03:28] <dbaupp> doener: really, never immediate? even enum foo { bar, baz }?
[12:03:32] <dbaupp> :(
[12:03:58] <doomrobo> dbaupp what is this with <'self> and &'self?
[12:03:58] <doener> dbaupp: I tried to fix that, but there are assumptions about that in some places I couldn't figure out that night
[12:04:10] <dbaupp> doomrobo: as a (huge) example https://github.com/mozilla/rust/blob/master/src/libstd/str.rs#L1132 and https://github.com/mozilla/rust/blob/master/src/libstd/str.rs#L1198
[12:04:14] <doener> dbaupp: crash doesn't happen with a current master build, just tried
[12:04:25] <doener> dbaupp: so it almost definitely was that is
[12:04:27] <dbaupp> doomrobo: (that's how strings get most of their methods)
[12:04:37] <doomrobo> but what the hell is 'self?
[12:04:45] <dbaupp> doener: could you comment saying as much (with a link to the commit, preferably)?
[12:04:51] <dbaupp> doomrobo: give me a sec.
[12:04:57] <doomrobo> no rush :P
[12:05:22] <dbaupp> doomrobo: obligatory link http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html#named-lifetimes :P
[12:06:27] <dbaupp> doomrobo: whenever you write a type with & that isn't a function argument (e.g. in generics, or on traits, or in a struct declaration), then it needs to be given a lifetime (to stop the compiler complaining :P )
[12:06:38] <dbaupp> and 'self is that lifetime
[12:07:21] <doomrobo> oh, so it applies to @, ~, and & generically?
[12:07:25] <bstrie> dbaupp: did you ever make an attempt at heap-to-stacking that benchmark from yesterday?
[12:07:30] <dbaupp> doomrobo: (it's a bug that *only* self is allowed; there's no fundamental reason that the compiler only accepts the string "self", it's just the way it is, because it used to be different.)
[12:07:39] <dbaupp> bstrie: nope, cbf :P
[12:07:59] <dbaupp> bstrie: but it's been updated (again!), rust is only slightly behind clang and ldc, in front of gcc
[12:08:24] <dbaupp> doomrobo: what's "it" in that context?
[12:09:05] <doomrobo> dbaupp the function itself works for all strings whether they're shared, unique, or referenced
[12:09:32] <doomrobo> and can I specialize the generic implementation so that, for example, I could do some extra stuff if the str is a &?
[12:09:32] <doener> dbaupp: done
[12:09:34] <dbaupp> doomrobo: right, the @/~ str's get autoborrowed to &str, so the function Just Works
[12:09:38] *** Joins: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net)
[12:09:58] <doomrobo> dbaupp wait, if those get autoborrowed, what's the <'self> for?
[12:10:10] <kemurphy> dbaupp: not quite, there's a lot of stuff in typeck/collect.rs that's spoofing types where i don't want them to
[12:10:11] <dbaupp> doomrobo: lifetimes, see ^
[12:10:20] <dbaupp> doener: thanks
[12:10:31] <doomrobo> why can't I just right "impl PCRE for &str" if it's autoborrowed?
[12:10:46] <dbaupp> doomrobo: because & pointers in types have to have a lifetime.
[12:11:04] <dbaupp> i.e. you're not allowed to write a plain &str in an impl like that
[12:11:14] <doomrobo> ok, I'mma read that page you linked and come back in a sec
[12:11:43] <dbaupp> doomrobo: (for this purpose, the 'self is essentially just annoying boilerplate.)
[12:11:51] <dbaupp> kemurphy: :(
[12:12:50] <kemurphy> on the bright side, it looks like i'll be able to get rid of "insert_synthetic_type_entries" when all is said and done
[12:15:11] <doomrobo> dbaupp so is &'self or &'whatever syntax only viable in the parameter list of a function?
[12:16:18] <dbaupp> doomrobo: I'm not sure I understand; but no, it works (in fact, is required in) as `impl<'self> Foo for &'self str` and `struct Bar<'self> { foo: &'self int }`
[12:16:49] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[12:17:51] <doomrobo> dbaupp what does it mean in the second case?
[12:18:31] *** Joins: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP)
[12:18:31] *** ChanServ sets mode: +o dherman
[12:18:43] <dbaupp> doomrobo: it says that any Bar instance only lasts as long as it's `foo` field does.
[12:19:08] <bjz> doomrobo: and the compiler will tell you if it doesn't
[12:19:08] <bjz> :)
[12:19:30] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[12:19:34] <bjz> (so you're not pointing to something invalid)
[12:19:47] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[12:19:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GcnVPA
[12:19:47] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[12:22:32] <cmr> dbaupp: it doesn't seem to have exploded!
[12:22:37] <cmr> and it's going *fast* too
[12:22:46] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[12:22:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ks1IIA
[12:22:46] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[12:22:49] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[12:22:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/oQyKRQ
[12:22:49] <ghrust> 13rust/06auto 14f73bb2b 15Birunthan Mohanathas: Implement std::num::Zero for bool...
[12:22:49] <ghrust> 13rust/06auto 144cf3072 15bors: auto merge of #8026 : poiru/rust/issue-8024, r=alexcrichton...
[12:22:49] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[12:22:51] <cmr> 16 minutes.
[12:23:38] *** Quits: true_droid1 (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[12:23:54] <dbaupp> cmr: I saw! (I haven't got around too hooking up the plots yet, I'll probably just shift the current ones to an archived link and use these only these ones until I can get around to showing them all.)
[12:25:18] <doomrobo> I get @~str as a return value from a function and I want to take that and return the ~str but it's giving me "error: moving out of dereference of immutable @ pointer" when I try to return *str_ptr
[12:25:44] <cmr> doomrobo: you need to return (*str_ptr).clone()
[12:25:54] <cmr> ie, do a copy
[12:26:12] <doomrobo> why is that? shared pointers are passed along from one thing to another
[12:26:37] *** Joins: Blub\w (wry@moz-8A5E1FE9.vps.tuwien.ac.at)
[12:26:59] <cmr> You don't own the value the managed box wraps, you can't move out of it because it would invalidate every other reference to it.
[12:27:31] <doomrobo> what does "move out" mean?
[12:28:05] *** Quits: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP) (Quit: dherman)
[12:28:22] <cmr> I don't know the exact meaning, but aiui it has to do with changing ownership
[12:30:06] <doomrobo> oh, I see. I have to keep the @ wrapper intact with the ~ pointer otherwise I could just pass along the inner one and essentially pluck it out of the managed pointer
[12:30:21] <doomrobo> ?which is bad
[12:30:34] <dbaupp> yes
[12:31:20] <dbaupp> (because you're removing the data from a @ and there might (as far as the compiler knows) be some other thing that is using the @... and then suddenly it's contents disappears: not memory safe.)
[12:31:27] <dbaupp> cmr: "MC"? https://github.com/mozilla/rust/issues/6912#issuecomment-21549924
[12:31:44] <cmr> dbaupp: http://blog.llvm.org/2010/04/intro-to-llvm-mc-project.html
[12:32:09] <dbaupp> thanks
[12:34:31] <dbaupp> cmr: that's really old... do you know if it's in LLVM yet?
[12:34:36] <cmr> dbaupp: it is
[12:34:41] <dbaupp> oh, we're using it?
[12:34:46] <cmr> inline asm
[12:35:02] <dbaupp> ah, I thought that was just a text-copy into the output?
[12:35:13] * dbaupp has no idea.
[12:35:29] <cmr> well it is, in the ir, but it uses the integrated assembler rather than calling out to gas during codegen afaik
[12:35:48] <cmr> It's also what drives the JIT
[12:36:08] <dbaupp> right, but the rest of the asm is compiled with gas?
[12:36:19] <dbaupp> (so surely the inline asm is compiled at the same time...)
[12:36:33] <cmr> I don't think it is, not on targets MC supports
[12:36:36] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[12:36:46] *** Quits: Blub\w (wry@moz-8A5E1FE9.vps.tuwien.ac.at) (Ping timeout)
[12:37:44] *** Joins: Blub\w (wry@moz-8A5E1FE9.vps.tuwien.ac.at)
[12:37:46] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:40:10] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[12:42:12] <dbaupp> cmr: I'm clearly not understanding something, because, `asm!("jmp foo"); println("skipped"); asm!("foo:");` skips the println, and I don't see how they could be emitted separately (because the label computation needs to happen)
[12:42:37] <cmr> dbaupp: what do you mean emitted separately?
[12:42:50] <dbaupp> cmr: converted to machine code
[12:43:02] <dbaupp> (that what you were saying that MC does for inline asm, right?)
[12:43:43] <dbaupp> i.e. both the inline asm and the plain Rust has to be assembled by the one program for the labels to work
[12:44:30] <cmr> yes, and that program is llvm
[12:44:49] <cmr> before it outputted assembly from the IR and ran the entire thing through gas, aiui
[12:44:53] <cmr> not positive
[12:45:34] <dbaupp> before, but not now?
[12:45:51] <cmr> llvm does it all now
[12:45:57] <cmr> I don't know exactly how it does it
[12:45:57] <dbaupp> except for linking?
[12:45:59] <cmr> but it does :p
[12:46:06] <cmr> well, with lld it links too
[12:46:08] <cmr> but yes
[12:46:25] <dbaupp> yeah, the linking isn't builtin, I mean.
[12:46:33] <cmr> (yet :p)
[12:46:43] * dbaupp wants lld to hurry up and work
[12:46:58] *** Quits: Blub\w (wry@moz-8A5E1FE9.vps.tuwien.ac.at) (Ping timeout)
[12:47:22] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:48:48] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[12:49:52] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:50:06] <bstrie> lldb as well :)
[12:50:19] <cmr> lldb works okish
[12:50:31] <dbaupp> debugging is for people who can't write code right the first time (wimps!)
[12:51:02] <nmatsakis> is anyone familiar with link errors from src/test/run-pass/smallest-hello-world.rs?
[12:51:09] <dbaupp> acrichto_: ^
[12:51:11] <nmatsakis> e.g. undefined reference to dladdr etc
[12:51:14] *** Joins: Blub\w (wry@moz-21DE68FA.vps.tuwien.ac.at)
[12:51:29] <bstrie> linkers are for people who don't know how to link manually (wimps!)
[12:51:49] * dbaupp normally hand-links his programs
[12:52:17] <dbaupp> nmatsakis: acrichto_ has been wrestling with that area of the code for a few days.
[12:52:21] <cmr> nmatsakis: seems weird, why would it be looking for dladdr?
[12:52:33] <nmatsakis> cmr: presumably to link and find puts?
[12:52:41] <cmr> Adding -ldl to linkhack should do it I guess
[12:52:45] <cmr> nmatsakis: at runtime?
[12:52:51] <dbaupp> nmatsakis: https://github.com/mozilla/rust/pull/7924 (is related)
[12:53:04] <nmatsakis> this failure is at compile time, all I can say is that there *exists* a link hack -ldl but it's not working
[12:53:14] <cmr> how strange
[12:53:14] <nmatsakis> this is on my branch, so it's possible I broke something
[12:53:18] <nmatsakis> but I don't know what
[12:55:29] <doomrobo> I'm writing this but it's failing: "use std::str::replace"
[12:55:49] <dbaupp> doomrobo: it should work without the use
[12:55:59] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[12:56:28] <dbaupp> doomrobo: it's a method, so they get imported by traits (for `impl ... for ... { }`) or by type (for `impl ... { }`)
[12:56:57] <cmr> https://github.com/mozilla/rust/blob/master/src/libstd/str.rs#L507
[12:57:01] <cmr> looks like a free function to me
[12:57:30] <doomrobo> oh, didn't realize it was a method
[12:57:38] <dbaupp> cmr: oh!
[12:57:45] * dbaupp must've missed that
[12:57:57] <dbaupp> well, it's also method.
[12:58:16] <doomrobo> wait, it says "~str does not implement any method in scope named 'replace'"
[12:58:29] <dbaupp> doomrobo: are you calling it on @~str?
[12:58:37] <doomrobo> no, I'm not *that* dumb
[12:58:46] <doomrobo> I've given up on that. I'm just using regular old replace
[12:58:54] <nmatsakis> also, conditional-debug-macro-off is a very unfortunate test, in that it cannot pass when rustc is configured with --enable-debug...
[12:59:06] <nmatsakis> ...though I think is probbaly more of a makefile bug than anything else.
[12:59:16] <dbaupp> nmatsakis: it was fixed a few hours ago
[12:59:24] <nmatsakis> cool
[12:59:33] <dbaupp> (i.e. the fix landed) and yeah, it was makefile thing
[12:59:57] * nmatsakis rebases
[13:01:20] *** Joins: kemurphy_ (kemurphy@3863AC20.C4E71399.9510F13D.IP)
[13:06:51] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[13:07:16] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[13:07:32] <cmr> mark_edward: sully fixed a bunch of trait inheritance bugs, but not for trait objects I think (not positive)
[13:07:52] <doomrobo> importing from std::str doesn't seem to work at all
[13:07:57] <doomrobo> core::str worked
[13:08:05] <cmr> doomrobo: uhh, `rustc --version` says?
[13:08:22] <doomrobo> 0.6
[13:08:33] <cmr> don't use 0.6
[13:08:40] <cmr> Use 0.7 at the very least
[13:08:50] <doomrobo> ok, but would that fix the problem?
[13:09:02] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[13:09:03] <cmr> yes
[13:09:11] <cmr> core was renamed to std since 0.6
[13:09:35] <doomrobo> but it's still odd that core::str::split doesn't exist?unless that was also added in 0.7
[13:10:02] <cmr> split doesn't exist anymore, it's now split_iter() method which returns an iterator
[13:10:17] <doomrobo> but?but?why?!
[13:10:38] <cmr> Because returning an iterator is better in every way than returning a new vector.
[13:12:03] *** Quits: Blub\w (wry@moz-21DE68FA.vps.tuwien.ac.at) (Ping timeout)
[13:12:56] <doomrobo> if only I knew how to use iterators...
[13:13:08] <cmr> http://static.rust-lang.org/doc/tutorial-container.html
[13:14:11] <doomrobo> why is it so tough to find this kind of stuff on Rust? I just spent 2 minutes looking for that
[13:14:20] <doomrobo> (thanks, btw)
[13:14:22] <cmr> our documentation is poorly organized
[13:14:35] <cmr> (and often the documentation itself isn't that great)
[13:14:41] *** Quits: markluffel (markluffel@179F0C2A.5C4C7C24.8354FB35.IP) (Ping timeout)
[13:14:58] <doomrobo> fair enough
[13:15:31] <dbaupp> smvv: ping
[13:16:40] <dbaupp> doomrobo: (that containers/iterators tutorial is currently the most up-to-date and modern piece of documentation about any part of Rust, I believe.)
[13:16:53] *** Joins: Blub\w (wry@moz-30EC4F8.vps.tuwien.ac.at)
[13:16:59] <cmr> I think that's true
[13:17:03] * doomrobo is cloning from github now because brew is apparently outdated
[13:17:11] <smvv> dbaupp: pong
[13:17:20] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[13:18:05] <dbaupp> smvv: for https://github.com/mozilla/rust/issues/8044, you appear to have BTrree::<int> rather than BTree::<int>... just a typo?
[13:18:27] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Ping timeout)
[13:18:29] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[13:19:44] <dbaupp> smvv: (also it is `node: leaf(1)` in test_minimal, but `node: Some(leaf(1))` in minimal.)
[13:20:11] <smvv> hmm ill check again. it did all the type checking
[13:20:18] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[13:20:19] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0/20130722172257])
[13:21:04] *** Joins: markluffel (markluffel@179F0C2A.5C4C7C24.8354FB35.IP)
[13:21:29] <bjz> doomrobo: use master, you'll get all the latest awesomeness
[13:21:30] <smvv> dbaupp: i removed the Option to reduce the test case but i did not update all code samples
[13:21:40] <bjz> doomrobo: :)
[13:21:51] <smvv> i've updated the issue
[13:21:57] <dbaupp> fwiw, https://github.com/mxcl/homebrew/blob/master/Library/Formula/rust.rb appears to use 0.7.
[13:22:35] *** Quits: Blub\w (wry@moz-30EC4F8.vps.tuwien.ac.at) (Ping timeout)
[13:22:36] *** Quits: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net) (Quit: ZNC - http://znc.in)
[13:23:54] <dbaupp> smvv: awesome :)
[13:23:55] *** kemurphy_ is now known as kemurphy
[13:24:06] <doomrobo> Alright guys. I gotta go get some sleep. Expect to see more of me. I'll be writing LISP in Rust so I can learn both languages a bit better :)
[13:24:15] <doomrobo> good night (or good morning)
[13:24:22] *** Quits: doomrobo (doomrobo@EC9C662A.161AAEB2.58B1C2DD.IP) (Quit: bye bye)
[13:27:13] <smvv> dbaupp: it's important to note that the type parameter V cannot be removed from the test case. If I substitute V with int and remove the type parameter from the declaration, the library can be use'd in the other file
[13:27:38] <dbaupp> smvv: how strange.
[13:27:59] <smvv> dbaupp: should i mention that in the bug report as well? (and what is the convention about stack traces in bug reports? because it's really verbose)
[13:28:25] <doomlord> heh a volunteer to write rusp :)
[13:28:27] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[13:29:17] <dbaupp> smvv: dumping it in the bug report is fine... it's pretty obvious what it is, so it doesn't really distract (and makes search for things contained in the backtrace easier later)
[13:29:34] <dbaupp> smvv: and yeah, mentioning that it's related to generics would be good.
[13:30:24] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[13:32:32] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:32:49] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:33:12] <nmatsakis> acrichto_: ping
[13:35:42] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[13:39:35] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[13:42:43] *** jyeo_afk is now known as jyeo
[13:48:11] <mitsuhiko> bjz: is glcore-rs broken on os x currently?
[13:48:24] <cmr> mitsuhiko: I think it's broken everywhere
[13:48:24] <mitsuhiko> it would appear glcore:: exports very few symbols
[13:48:28] <bjz> yep
[13:48:38] <mitsuhiko> aww :(
[13:48:44] <bjz> I should close the repo, sorry for the confusion
[13:48:56] <mitsuhiko> what do the cool kids use for gl wrapping these days?
[13:49:05] <bjz> nmatsakis says he's really close to fixing the extrn fn problem though
[13:49:12] <bjz> so gl-rs soon!!!
[13:49:29] <slaren> you can workaround the problem with glcore with uses to the different versions and extensions modules
[13:50:18] <slaren> ie. there is some problem with the pub uses that the library tries to do to bring the symbols in the different modules to the glcore module
[13:50:25] <slaren> but you can still use them directly
[13:50:32] <bjz> ok
[13:50:43] <mitsuhiko> i can wait a little longer :)
[13:50:53] <bjz> slaren: could you send me a PR if you have a fix?
[13:51:04] <bjz> mitsuhiko: you can use opengles
[13:51:14] <slaren> bjz: i don't have a fix, it must be a problem with rustc
[13:51:18] <dbaupp> cmr: out of interest, are you turning off the bencher while you're using that computer or something?
[13:51:20] <bjz> mitsuhiko: but that won't have all the new stuff :(
[13:52:04] <cmr> dbaupp: no, but I don't think it will skew it too much, especially with cpuacct measurements.
[13:52:34] <dbaupp> cmr: how many cores, etc?
[13:52:42] <sebcrozet> bjz: What is the problem with glcore-rs? It works for me.
[13:52:55] <cmr> 4 cores, 2 threads each, 16GiB of memory
[13:52:58] <bjz> sebcrozet: what version of rust?
[13:53:18] <sebcrozet> rust 0.8-pre (906264b 2013-07-25 03:07:44 -0700)
[13:53:24] <bjz> heh
[13:53:37] <bjz> sebcrozet: I literally haven't touched it in months :(
[13:53:38] <mitsuhiko> definitely does not work for me with rust from today
[13:53:47] <dbaupp> cmr: oh, ok. probably fine.
[13:53:49] <sebcrozet> bjz: Iâ€™m using arch. Last week I also used it on OS-X.
[13:54:13] <bjz> sebcrozet: been waiting for the mythical extern fn patch :(
[13:54:19] <dbaupp> cmr: also time machine = 1?
[13:54:28] <cmr> dbaupp: yup
[13:54:31] <mitsuhiko> bjz: hao much longar!?!?
[13:54:31] <dbaupp> awesome
[13:54:44] <bjz> mitsuhiko: I don't know! D:
[13:55:00] <sebcrozet> mitsuhiko: which error do you have?
[13:55:02] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[13:55:10] <mitsuhiko> sebcrozet: just missing symbols left and right
[13:55:15] <mitsuhiko> it does not even export glClearColor for me right now
[13:55:18] <mitsuhiko> (os x)
[13:55:36] <sebcrozet> mitsuhiko: you did a "make osx" ?
[13:55:40] <mitsuhiko> yeah
[13:55:54] <mitsuhiko> to be honest, i just rage rm -rf'ed so it's a bit pointless debugging it now
[13:55:55] <slaren> mitsuhiko: try using the submodules directly ie. use "glcore::functions::GL_VERSION_1_0::*;"
[13:56:12] <mitsuhiko> slaren: that would probably have worked
[13:56:29] <sebcrozet> mitsuhiko: oh, yes I dit that to make it work :p
[13:57:07] <slaren> it's a weird problem because in some builds (randomly) some symbols are correctly pulled to the glcore module
[13:57:37] <cmr> Semi-offtopic: why GLFW rather than SDL (specifically, what drove that decision for servo?)
[13:57:58] <mitsuhiko> cmr: for me it was because the only version of sdl that makes sense is 2.0
[13:58:02] <mitsuhiko> and nobody wrote a wrapper :P
[13:58:25] <bjz> cmr: you should ask jack
[13:58:26] <cmr> I thought rust-sdl was 2.0.. maybe I was thinking of glfw3
[13:58:29] <cmr> jack: ping
[13:58:45] <bjz> cmr: I do glfw
[13:58:47] <sebcrozet> slaren: I think it is not a glfw specific bug. All the module re-export seems buggy.
[13:58:58] <bjz> (glfw-rs, that is)
[13:59:12] <slaren> sebcrozet: yeah, it is definetely a problem in rustc
[13:59:17] <bjz> cmr: though you probs know that :D
[13:59:27] <cmr> bjz: yup, you do all the cool stuff :)
[13:59:32] <bjz> cmr: yes!
[13:59:49] * bjz wonders if cmr is joking
[14:00:06] <slaren> cmr: for what it is worth, I stopped considering SDL when I realized that their fonts module allocates a new buffer every time you want to draw some string
[14:00:18] <slaren> that is just wrong
[14:00:27] <cmr> yikes
[14:00:42] <bjz> cmr: glfw is much more lightweight than sdl
[14:00:44] <cmr> all I'd really be using it for is windowing and input I think
[14:01:03] <cmr> maybe SDL_mixer? not sure yet, haven't gotten that far..
[14:01:07] <bjz> cmr: if all you want is windowing and input
[14:01:36] <mitsuhiko> slaren: sdl for drawing is not very interesting anyways
[14:01:44] <mitsuhiko> i only ever used it for opengl bootstrapping
[14:01:53] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[14:02:02] <slaren> cmr: rust-sdl also converts the bitfields to vectors
[14:02:13] <slaren> cmr: which are used extensively in the inputs module
[14:02:22] <slaren> so if you care about efficiency, it is probably not very good either
[14:02:27] <bjz> cmr: my bindings still have some work to be done
[14:02:29] <cmr> bjz: Does GLFW do windowing "correctly", especially resizing? There are quite a few steam games that interact *very poorly* with window managers, or for fullscreen mirror across both of my monitors and don't put them back when it exits..
[14:03:06] <bjz> cmr: it has full screen and multiple window support with resize events
[14:03:19] <bjz> multiple monitors too
[14:03:34] <cmr> sounds like glfw will be fine then
[14:03:36] <cmr> thanks :D
[14:03:56] <bjz> cmr: if you have any issues, dreda (main dev) is extremely conciencious with her support
[14:04:06] <cmr> wonderful
[14:04:13] <cmr> the website also looks better than sdl's
[14:04:20] <cmr> and as much as I pretend that doesn't affect my decisions
[14:04:21] <cmr> it does
[14:04:27] <mitsuhiko> as far as i'm concerned glfw and sdl are different things
[14:04:42] <bjz> just hop on #glfw or you can submit an issue on the github repo
[14:04:48] <cmr> mitsuhiko: they seem to accomplish similar goals?
[14:04:52] <cmr> at least for the basics
[14:05:15] <mitsuhiko> cmr: if opengl is what you want to do there is some overlap
[14:05:17] <bjz> cmr: I follow the glfw issues and there is a quite fast response time
[14:05:33] <bjz> cmr: SDL is far more expansive
[14:05:58] <slaren> bjz: btw, lmath-rs is looking very nice, good job there
[14:06:06] <bjz> slaren: I need help
[14:06:20] <bjz> slaren: also users to battle test it
[14:06:36] <bjz> slaren: once I have gl going I will be able to as well
[14:06:47] <sebcrozet> bjz: help for what?
[14:06:48] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[14:07:30] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[14:07:32] <bjz> sebcrozet: implementing simplex noise and spatial partitioning algortithms
[14:07:35] <slaren> bjz: I am mainly working on a toy project to get used to rust
[14:07:55] <bjz> sebcrozet: I may eventually divide it up into separate repos
[14:08:04] <slaren> bjz: but I may be able to help, what would you need help with ?
[14:08:07] <sebcrozet> bjz: spatial partitioning on a linear algebra library?
[14:08:33] <bjz> sebcrozet: well, it may have to be renamed
[14:08:46] <sebcrozet> bjz: Iâ€™m working on a bounding volume hierarchy dynamic tree on my collision detection library.
[14:08:58] <bjz> sebcrozet: and reorganised
[14:09:07] <doomlord> linear algebra lib, then  a geometry lib build on that, ...
[14:09:14] <sebcrozet> bjz: this is a kind of partitioning, but which does not split the whole space.
[14:09:21] <bjz> doomlord: yep
[14:09:48] <bjz> doomlord: that is the way my dependencies point in my modules, it's just rolled into one atm
[14:10:15] <bjz> sebcrozet: nice
[14:10:19] <bjz> sebcrozet: github?
[14:10:28] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[14:10:43] <sebcrozet> bjz: https://github.com/sebcrozet/ncollide
[14:10:55] <bjz> sebcrozet: ohhhhh, it's you!
[14:10:58] <bjz> hullo!
[14:11:18] <sebcrozet> bjz: yep. Got a lot of free time now :p
[14:11:43] <bjz> sebcrozet: btw, I'm redoing Num in std::num
[14:11:50] <sebcrozet> bjz: you need spacial partitioning for some specific aplication?
[14:12:08] <bjz> Semiring <- Ring <- Field
[14:12:28] <sebcrozet> bjz: Nice
[14:12:54] <bjz> sebcrozet: I am doing graphics work
[14:13:46] <sebcrozet> bjz: well, if you have a specific algo. in mind just let me know. Iâ€™ll add it on ncollide.
[14:14:12] <sebcrozet> bjz: spacial partitioning is useful for both graphics and physics anyway.
[14:14:18] <bjz> indeed
[14:15:19] <bjz> sebcrozet: why don't you follow the Rust style guide?
[14:15:47] <sebcrozet> bjz: didnâ€™t know that existed
[14:16:29] <bjz> sebcrozet: still a wip, but it shows some of the conventions used in Rust and Servo: https://github.com/mozilla/rust/wiki/Note-style-guide
[14:16:31] <Ms2ger> (How about Aberian group / Group / Semigroup?)
[14:16:57] <Ms2ger> Abel, even
[14:17:10] <SiegeLord> So I have this C library that can be initialized/uninitialized... and it can create objects that can be used from in multiple threads... how would I wrap that in Rust?
[14:17:18] <bjz> Ms2ger: mm?
[14:17:19] <bstrie> bjz: what about it isn't following the style guide? it's got names_like_this and TypesLikeThis, that's the most important thing :P
[14:17:23] <SiegeLord> Sort of a... multithreaded object manager
[14:17:44] <SiegeLord> *resource manager
[14:17:55] <slaren> bjz: I actually missed some of the methods in the Color trait when trying to implement a text rendering function that could work with any arbitrary type of Color representation
[14:18:02] <slaren> bjz: perhaps I can help with that ?
[14:18:16] <sebcrozet> bjz: well Iâ€™ll follow that now. Thx.
[14:18:17] <bjz> slaren: that would be great
[14:18:34] *** Joins: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[14:18:58] <dbaupp> bstrie: and egyptian brackets!
[14:19:12] <bjz> slaren: it might be better to split it out in the future, it's just been easier to iterate with it inside lmath
[14:19:27] <dbaupp> (well, that library doesn't have them, but they're important!)
[14:19:42] <SiegeLord> The only important bit of styling is the public interface
[14:19:54] <SiegeLord> I couldn't care less what style the implementation uses
[14:20:14] <slaren> bjz: I don't know, I think it is good there since the library is supposed to be mainly for graphics
[14:20:15] <bjz> sebcrozet: it wasn't too bad - I just think 4 spaces, and egyptian
[14:20:15] <bstrie> dbaupp: everything that isn't naming can be fixed by a pretty-printer, so it's not a problem :P
[14:20:35] <dbaupp> bstrie: ah, yes, pretty printers & Rust. :P
[14:20:58] <bjz> slaren: yeah, the issue is if you want to go generic linear algebra you have to make certain compromises
[14:21:00] <bstrie> sebcrozet: don't let them cow you into a brace style, you got the naming conventions down and that's what's important
[14:21:20] <dbaupp> <3 CamelCaseTypes
[14:21:44] <bstrie> when I write rustfmt I'm going to put all semicolons at the start of the next line
[14:21:55] * bjz doesn't care what, but it does make it easier for new contibutors with standard formatting
[14:22:27] <bjz> slaren: what is your background?
[14:22:28] <cmr> SiegeLord: init/uninit it in the main task?
[14:22:33] <dbaupp> bstrie: how monstrous
[14:22:54] <sebcrozet> bjz: could be great to have a colorimetry lib. Could be a good place for the Color-related types.
[14:23:03] <SiegeLord> cmr: The objects need to not be invalidated after I deinit
[14:23:17] <SiegeLord> Or rather, invalidated by me
[14:24:06] <SiegeLord> So maybe they can be owned pointers and also hold a cross-task reference to the 'library object'?
[14:24:18] <dbaupp> SiegeLord: `fn with_my_library(&fn() { ... })` as the only way to use it, so `fn main() { with_my_library(real_main) }`?
[14:24:29] <slaren> bjz: I used to be somewhat involved in computer graphics a few years ago, doing game and demoscene related stuff
[14:24:38] <dbaupp> (that solves the init/deinit problem.)
[14:24:49] <bjz> slaren: awesome, I could really use your help
[14:25:02] <SiegeLord> dbaupp: I don't know how tasks work... is it not possible for the task to outlive the scope it was spawned in?
[14:25:23] <dbaupp> SiegeLord: yeah, it is...
[14:25:25] <dbaupp> hm.
[14:25:35] <bjz> slaren: my main issue coming to Rust was the lack of maths stuff, it would be great to have something people could include easily
[14:25:57] <cmr> Shove the "library object" in an Arc?
[14:26:18] <dbaupp> SiegeLord: I think bjz may've had similar issues with some of his graphics libraries.
[14:26:19] <slaren> bjz: absolutely, and I think that lmath-rs is looking very nice for that purpose
[14:26:30] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[14:26:31] <bjz> slaren: the main goal is for rust to be an attractive language for graphics. but it needs ans ecosystem
[14:26:33] <SiegeLord> I kind of want a real linear algebra library myself (not only 4x4 matrices and below)
[14:27:00] <bjz> SiegeLord: yep, I think a scientific maths lib would be a separate project
[14:27:01] <dbaupp> SiegeLord: bindings to a BLAS you mean :P
[14:27:13] *** Joins: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[14:27:18] <SiegeLord> BLAS can be a backend... the interface is the important bit
[14:27:29] <slaren> bjz: that's mainly my motivation for using rust as well, as a replacement of C++ for graphics programming
[14:27:33] <SiegeLord> I've never used BLAS directly, and I absolutely don't care to start :P
[14:27:36] <sebcrozet> SiegeLord: If you mean linear algebra with higher dimensional matrices, Iâ€™m working on it.
[14:28:01] <slaren> slaren: so I'll do some work on the Color types and I'll send you a pull request later
[14:28:06] <slaren> *bjz rahter
[14:28:08] <dbaupp> SiegeLord: "bindings with a nice high level interface", how's that ;)
[14:28:11] <SiegeLord> sebcrozet: Oh yeah? Any public code yet?
[14:28:32] <sebcrozet> SiegeLord: https://github.com/sebcrozet/nalgebra
[14:29:09] <sebcrozet> SiegeLord: I use it for n-dimensional physics simulation.
[14:30:13] *** Joins: yong_ (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[14:30:35] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[14:30:39] *** yong_ is now known as yong
[14:31:15] <SiegeLord> sebcrozet: What's the 6 in Vec6 mean?
[14:31:29] <sebcrozet> SiegeLord: 6 dimensional vector.
[14:31:41] <sebcrozet> SiegeLord: x, y, z, w, a, b.
[14:31:45] <SiegeLord> So you need a type per length?
[14:32:07] <SiegeLord> That doesn't seem ideal... I deal with 10000 dimensional vectors :P
[14:32:17] <sebcrozet> SiegeLord: ohâ€¦
[14:32:25] <sebcrozet> SiegeLord: well there is the DVec type.
[14:32:31] <SiegeLord> Ah
[14:32:41] <sebcrozet> SiegeLord: and DMat.
[14:33:22] <sebcrozet> SiegeLord: But if you need such big matrices, I dont have efficient algorithm for them (like QR decomposition)
[14:34:27] <SiegeLord> What I'm generally in immediate need for is slicing and scalar operations... sometimes I do a matrix multiply
[14:34:41] <SiegeLord> Well, and the dot product too
[14:34:44] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:34:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/oQyKRQ
[14:34:45] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:35:38] <sebcrozet> SiegeLord: The dot product is implemented for vectors.
[14:36:28] <sebcrozet> SiegeLord: What do you mean by "slicing"? Extracting a part of a vector?
[14:37:47] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:37:47] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/j17UCg
[14:37:47] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:37:47] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:37:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/P55GEg
[14:37:48] <ghrust> 13rust/06auto 14dc38e16 15Niko Matsakis: Generalize the `ty::substs` struct so that it can represent...
[14:37:48] <ghrust> 13rust/06auto 14baa649e 15bors: auto merge of #8027 : nikomatsakis/rust/issue-4846-multiple-lifetime-parameters-1, r=pcwalton...
[14:37:48] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:37:48] <SiegeLord> Well, to use matlab's syntax: a = ones(5, 5); a(2:4,2:4) = 1; produces a 5x5 matrix with a 3x3 matrix of ones in the middle
[14:38:24] *** Quits: StarLight (StarLight@moz-39D57FA9.dynamic.avangarddsl.ru) (Ping timeout)
[14:38:30] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[14:38:54] <sebcrozet> SiegeLord: ah. That would be great.
[14:38:56] *** Joins: bent (chatzilla@moz-2CD73AA6.triad.res.rr.com)
[14:39:08] <SiegeLord> Another thing I sometimes do is to do this a = ones(5,5,5,5); b = (1,:,1,1); that grabs a column of a matrix
[14:39:30] <SiegeLord> Well, that's not a matrix... 4D array
[14:39:31] <Ms2ger> Did you miss an a there?
[14:39:38] <SiegeLord> Yes
[14:39:47] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Quit: bye bye)
[14:40:01] *** Quits: rfw (rfw@moz-C65A114.rfw.name) (Ping timeout)
[14:40:14] <Ms2ger> Good, I was afraid I'd completely lost my matlab syntax :)
[14:41:34] <sebcrozet> SiegeLord: This would require overloading on the indexing operator.
[14:42:05] <Ms2ger> Anything wrong with that? :)
[14:42:22] <cmr> Ms2ger: yeah, it doesn't work
[14:42:28] <dbaupp> (not yet anyway)
[14:42:37] <SiegeLord> Well... it could be a[S!(1,:,1,1)]
[14:42:45] <sebcrozet> Ms2ger: I thing the current indexing operator does not allow assignations.
[14:42:46] *** Joins: StarLight (StarLight@moz-5295E00D.dynamic.avangarddsl.ru)
[14:42:55] <sebcrozet> * think
[14:42:58] <SiegeLord> There's no convenient slice syntax in Rust anyway... macros will be a must :P
[14:42:59] <dbaupp> https://github.com/mozilla/rust/issues/6515
[14:43:09] <Ms2ger> Well, is it by design or just not yet implemented
[14:43:19] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[14:43:23] <dbaupp> Ms2ger, sebcrozet: ^
[14:43:26] *** Joins: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP)
[14:43:27] <dbaupp> that issue.
[14:43:30] <cmr> NYI
[14:43:38] <cmr> the old implementation was broke
[14:43:45] <dbaupp> is broke
[14:43:56] <cmr> is? I thought it was removed
[14:44:20] <dbaupp> not yet (maybe you were thinking of += ?)
[14:44:24] <dbaupp> SiegeLord: https://github.com/mozilla/rust/issues/4160 btw
[14:44:28] <cmr> ah [rpbab;y
[14:44:39] <cmr> uh, probably
[14:44:58] <bstrie> that's the best misspelling since grautjat
[14:45:14] <SiegeLord> dbaupp: I don't agree with that proposal, as it exactly won't work for this case
[14:45:16] <cmr> what is grautjat supposed to be
[14:45:25] <dbaupp> SiegeLord: in what way?
[14:45:27] <bstrie> cmr: "grautjat" is patrick's misspelling of "graydon"
[14:45:31] <cmr> hahah
[14:45:42] <dbaupp> bstrie: misspelling? looks fine to me.
[14:45:47] <SiegeLord> I'd prefer <blah>..<blah> to desugar to Slice(<blah>, <blah)>
[14:45:58] <dbaupp> SiegeLord: it would presumably be a trait
[14:45:59] <cmr> graydon itself is a misspelling to MechaGraydon
[14:46:04] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[14:46:19] <bstrie> more an abbreviation than a misspelling
[14:46:21] <dbaupp> SiegeLord: so it would pass those args to the type-specific slice function.
[14:46:34] <SiegeLord> They propose desuraring [<blah>..<blah>] to opSlice(<blah>..<blah>)
[14:46:35] <dbaupp> SiegeLord: wait.
[14:46:40] <dbaupp> SiegeLord: yeah, I understand now.
[14:46:45] <SiegeLord> *opSlice(blah,blah)
[14:47:06] <dbaupp> SiegeLord: you could get pretty far with a proper Index and operator overloading
[14:47:53] <SiegeLord> I don't know... the only thing I can imagine working in that case would be: a[1..2][3..4][5..6]
[14:48:12] <SiegeLord> Which works, I suppose... but a bit too many []'s
[14:48:24] <bstrie> oh hey the mongodb folks got back to us
[14:48:27] <cmr> I can imagine x..y desugaring to a Range<T, U>
[14:48:34] <jedestep> bstrie: that was us
[14:48:37] <jedestep> :)
[14:48:40] <bstrie> aha :P
[14:48:57] <dbaupp> SiegeLord: `foo[(Idx(1), Slice(1,10))]` (possibly with some help to avoid having to actually write the things.)
[14:49:20] <Ms2ger> a..b? Why not a:b?
[14:49:37] *** Joins: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[14:49:38] <cmr> Ms2ger: we already use a..b for similar purposes in patterns
[14:49:55] <cmr> and the colon is already used for types
[14:50:25] <cmr> jedestep: Is Jao-ke on IRC?
[14:50:46] <jedestep> cmr: she has been posting from mibbit auto-generated names occasionally
[14:50:52] <cmr> ahh
[14:51:25] <cmr> Anyway this is really exciting!
[14:51:34] <jedestep> :D
[14:51:47] <cmr> jedestep: was TWiR helpful?
[14:52:24] <bjz> jedestep: who is you?
[14:52:28] <jedestep> pre 0.7 it was helpful to spot sneaky breaks that slipped in
[14:53:02] <jedestep> since 0.7 release we haven't been updating weekly, but i've been keeping up with it and marking things that will break
[14:53:13] <jedestep> bjz: who is i...?
[14:53:33] <bjz> jedestep: "that was us"
[14:53:40] <jedestep> oh. the mongodb driver
[14:54:08] <dbaupp> bjz: (they just sent an email to the mailing list)
[14:54:45] <bjz> ooo
[14:54:45] <cmr> jedestep: I see DB::new and such take ~str. Is it possible for them to take &str?
[14:55:09] <bjz> jedestep: sorry for ignorance, but what is a 'mongodb driver'?
[14:55:12] *** Joins: cornelius (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[14:55:18] <jedestep> cmr: probably
[14:55:45] <cmr> bjz: same as any db driver; a library/interface for accessing the db in a given language (I think)
[14:55:46] <jedestep> bjz: MongoDB is a nosql database, since it doesn't use a typical query language you interact with it through a native API
[14:55:50] <dbaupp> bjz: a library that allows one to talk to a MongoDB database natively from a rust program
[14:55:59] * dbaupp mutters about "web-scale"
[14:56:04] <bjz> nice
[14:56:39] <bjz> jedestep: did you end up with an interface you were happy with?
[14:57:03] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[14:57:35] <jedestep> bjz: yeah
[14:58:29] *** Joins: acm (textual@34641662.FB4DE631.66C78B76.IP)
[14:58:54] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[14:59:13] *** Quits: cornelius (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:59:21] *** Joins: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[14:59:41] <bjz> jedestep: yeah let db = DB::new(~"rust_ex", client); could have a &str
[15:00:21] *** Quits: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:00:40] *** Joins: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[15:00:41] *** Joins: nano (nano@moz-972880B.superkabel.de)
[15:01:24] <bjz> jedestep: so you can do: let db = DB::new("rust_ex", client);
[15:01:33] <doener> dbaupp: hm, I have another commit that removes the extraneous branch when an "if" can be removed. Of course that builds upon the previous improvement. Should I wait to make a new PR or just add it to the existing one?
[15:01:52] <dbaupp> doener: add it to the PR
[15:02:01] <jedestep> bjz: the new() function still has to clone that string, correct?
[15:03:10] <bjz> jedestep: oh, you you store it away
[15:03:28] <dbaupp> jedestep: (btw, the .rc file extension for crates is deprecated.)
[15:03:48] <dbaupp> just use a .rs like for normal mods
[15:04:45] <doener> dbaupp: updated
[15:04:48] <smvv> dbaupp: how about a lint that emits a warning for .rc files? that way you push the community towards .rs
[15:05:52] <dbaupp> doener: with_scope looks much nicer than make a new block.
[15:06:14] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Ping timeout)
[15:07:02] <dbaupp> smvv: sounds like a neat little feature
[15:11:24] <sebcrozet> Is this not supposed to compile: https://gist.github.com/sebcrozet/6080677 ?
[15:12:09] <cmr> sebcrozet: it is.
[15:12:10] <cmr> bug
[15:12:17] <cmr> I think sully fixed it just today?
[15:12:22] *** Joins: yonran (yonran@moz-962F33EB.acuitus.com)
[15:12:22] <cmr> what rev is your rustc
[15:12:42] <sebcrozet> cmr: rust 0.8-pre (906264b 2013-07-25 03:07:44 -0700)
[15:12:44] <dbaupp> cmr: doesn't look like it
[15:12:52] <sebcrozet> cmr: I pulled master a fiew hours ago.
[15:13:03] <dbaupp> sebcrozet: (I assume `doit` in the error message is meant to be `a`?)
[15:13:25] <sebcrozet> dbaupp: yep. Sorry.
[15:13:43] <dbaupp> https://github.com/mozilla/rust/issues/4100
[15:14:02] <cmr> oh it's a trait object
[15:14:17] <cmr> yeah those are still broken
[15:14:57] <sebcrozet> :(
[15:15:23] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[15:17:51] <dbaupp> jedestep: another point, vec + vec is very inefficient, so https://github.com/10gen-interns/mongo-rust-driver-prototype/blob/master/src/libmongo/msg.rs#L108-L167 would be *much* faster using `bytes.push(0u8)` and `bytes.push_all_move(r.to_bytes(...))`
[15:17:57] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:17:58] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[15:18:46] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[15:19:00] *** Quits: joone (joone@E10A1781.2160464A.A34EC3BB.IP) (Client exited)
[15:19:43] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[15:21:36] <jedestep> dbaupp: thanks for the spot, thought we had removed all of those :)
[15:22:04] *** Quits: sk (sk@4D49710A.1FD35C61.78DD174B.IP) (Quit: Leaving)
[15:23:42] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[15:23:58] <jchinlee> dbaupp speaking of which, out of curiosity, what's the state of null-terminating strings?
[15:24:24] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[15:24:45] <bstrie> jchinlee: https://github.com/mozilla/rust/issues/7235
[15:24:46] <dbaupp> jchinlee: I'm not sure there's been a resolution to remove the null-termination of ~str yet (but I think it will probably happen)
[15:25:01] <dbaupp> jchinlee: (you're Jao-ke?)
[15:25:25] <jchinlee> dbaupp (yes, pleased to meet you!)
[15:25:49] <dbaupp> awesome!
[15:25:49] <jchinlee> dbaupp thanks!
[15:25:51] <Ms2ger> Moving to len + ptr?
[15:26:00] <rntz> wait strings are null terminated :< :< :<
[15:26:05] <cmr> Ms2ger: they already are len+ptr
[15:26:10] <Ms2ger> Ah
[15:26:11] <doener> they're both
[15:26:12] <dbaupp> Ms2ger: it's that, plus a null terminator
[15:26:18] <cmr> They have a null terminator for FFI
[15:26:21] <rntz> ah, blech.
[15:26:23] <Ms2ger> Makes sense
[15:26:31] <cmr> Ms2ger: it doesn't really make sense
[15:26:38] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:26:39] *** Joins: Nefzaoui (chatzilla@D30EAED9.E7C31F37.80E43DAF.IP)
[15:26:49] <dbaupp> jchinlee, jedestep: reading the code now, looks nice! :)
[15:26:50] <Ms2ger> Well, it makes some sense if you need to interact with C
[15:27:00] <jedestep> dbaupp: good to hear :)
[15:27:05] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[15:27:15] <Ms2ger> I use "sense" loosely :)
[15:27:19] <rntz> Ms2ger: unless rust's strings are allowed to include null bytes in their contents, in which case it's a bug waiting to happen
[15:27:26] <cmr> yup
[15:27:31] <dbaupp> rntz: they are, they're utf8
[15:27:32] <Ms2ger> True
[15:27:41] <cmr> You shouldn't use str in FFI at all
[15:27:58] <cmr> Only vectors of u8 (or *libc::c_char)
[15:28:02] <Ms2ger> (We do have bugs in Gecko exactly for that reason)
[15:28:12] <dbaupp> rntz: (fwiw, rust is currently very loose and free about assuming things are utf8.)
[15:28:17] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[15:28:32] <dbaupp> e.g. run `rustc $(echo -e '\xff')`
[15:28:49] <dbaupp> or `RUST_LOG=$(echo -e '\xff') rustc`
[15:29:13] <rntz> failing an assert seems an appropriate thing to do given badly formatted input
[15:29:19] <rntz> I mean, a nice error message would be better 
[15:29:23] <rntz> but I'll take an assert
[15:29:27] <rntz> that is just fine
[15:29:34] <dbaupp> right, but it's assuming that the args and environment variables are utf8, which is entirely wrong.
[15:29:36] *** Joins: joone (joone@moz-D3B2E195.jf.intel.com)
[15:30:18] <dbaupp> (i.e. that's an assert at a very low level, there's literally no way for a program to read the environment or the args in either case, it's instant death.)
[15:30:25] <rntz> ah, hm.
[15:30:32] <doener> dbaupp: you added the literal if/else check for disabling debug!, right?
[15:30:38] <jchinlee> dbaupp thanks for taking the time to look through it, and for your comments too!
[15:30:40] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[15:30:41] <dbaupp> doener: correct
[15:30:55] <dbaupp> jchinlee: np :) thanks for making Rust have awesome libraries.
[15:31:07] <rntz> I wonder how python handles this?
[15:31:28] <cmr> jchinlee: One thing I noticed is that Collection and such keep a ~str, which means copies. Not the end of the world, but it'd be nice if it didn't have "extra" copies
[15:31:30] <rntz> or python3, rather. python2 has str vs unicode weirdness.
[15:31:36] <kimundi>  I think technically we need a `c_str` type. One that works like `str` (being unsized etc), but wich instead holds the invariant "ends with a \0, contains no \0"
[15:31:38] <jchinlee> dbaupp we were provided great base material :D
[15:31:44] <doener> dbaupp: sweet, then my change might even have an effect in the rustc codebase, at least for unoptimized builds :-)
[15:31:45] <dbaupp> rntz: $ python3 $(echo -e '\xff') python3: can't open file 'Ã¿': [Errno 2] No such file or directory
[15:31:52] <dbaupp> doener: :D
[15:32:00] <jedestep> cmr: would &'self str be preferred? or &'static str?
[15:32:01] <dbaupp> kimundi: erickt1 is working on it
[15:32:21] <dbaupp> jchinlee: :)
[15:32:26] <cmr> jedestep: Well, &'static would avoid copies
[15:32:32] <doener> dbaupp: by now I feel like the only thing I'm doing is improving unoptimized builds. Optimized ones likely don't benefit from what I'm doing lately
[15:32:39] <cmr> But building a string at runtime is useful
[15:32:51] <cmr> So &'self str would be ncie
[15:32:53] <dbaupp> jedestep, jchinlee: another thing, this copy is annoying: https://github.com/10gen-interns/mongo-rust-driver-prototype/blob/master/src/libmongo/cursor.rs#L62
[15:32:55] <rntz> dbaupp: right, sure, but I mean in *code*. like, if my arguments are represented by values of a type that is supposed to represent things in unicode, what happens if I feed it stuff not representable in unicode?
[15:33:04] <cmr> Or, having a single ~str somewhere, which everything else refers to
[15:33:06] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:33:07] <cmr> (so &'self str)
[15:33:19] *** Quits: pyrac (pyrac@D38C35DB.73C89388.AD05C589.IP) (Ping timeout)
[15:33:27] <cmr> rntz: exception
[15:33:29] <dbaupp> jedestep, jchinlee: do you ever need random-access to data?
[15:33:39] <cmr> UnicodeDecodeError or something similar
[15:34:00] <jedestep> dbaupp: not to my knowledge
[15:34:03] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:34:17] <rntz> cmr: oh? so what is sys.argv[1] if I give my python3 program something that ain't unicode as an argument?
[15:34:27] <rntz> presumably merely accessing sys.argv[1] isn't going to throw an exception
[15:34:32] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[15:34:53] <cmr> rntz: it does
[15:34:55] <cmr> UnicodeEncodeError: 'utf-8' codec can't encode character '\udcff' in position 0: surrogates not allowed
[15:35:11] <cmr> Well, when trying to print it, at least...
[15:35:40] <rntz> yeah, when trying to print only
[15:35:41] <rntz> interesting
[15:35:42] <dbaupp> jedestep: ah, ok, because it should be possible to consume the vector, rather than copy all the data on by one.
[15:35:47] <cmr> Encodings are weird and hard
[15:35:56] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[15:36:07] <rntz> so python3's 'str' type can represent things that aren't unicode despite ostensibly being a unicode string type
[15:36:13] <rntz> weeeeird
[15:36:17] <dbaupp> jedestep: (one could reverse data and then just .pop() to read the next element)
[15:36:17] <rntz> not sure I like that solution to this problem
[15:36:24] <dbaupp> rntz: apparently go does it too
[15:36:37] <cmr> rntz: python3 str can handle any encoding I thought
[15:36:43] <jedestep> dbaupp: 
[15:36:45] <jedestep> whoops
[15:36:55] <jedestep> dbaupp: we'll work on that :)
[15:36:59] <dbaupp> rntz: if you break the encoding, next time you try to use the string, it just gets replaced with the invalid bytes thing.
[15:37:21] <rntz> perhaps the "right" solution is that everything from the outside universe is just presented as a ~[u8]
[15:37:28] <rntz> incl. envvars and args
[15:37:29] <dbaupp> jedestep: awesome :D (there's also vec.consume_iter(), which does a similar thing, and would save you the work of reversing it.)
[15:37:36] <rntz> which would be a PITA
[15:37:42] <dbaupp> rntz: yeah, that's right.
[15:37:47] <kimundi> rntz: Not necessary
[15:37:55] <jedestep> cmr: Collection and DB wouldn't be Send if they contained &'self str, correct? I think sendability is something we'd like to potentially have
[15:37:57] <kimundi> That is, it shuolt be [u8]
[15:38:01] <dbaupp> rntz: or using 'conditions' to allow the user to avoid the failure.
[15:38:12] *** Joins: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net)
[15:38:25] <rntz> dbaupp: blech, that seems overengineered to me (using conditions to solve this)
[15:38:26] <kimundi> but you'd just have to add a .to_utf8() call or so
[15:38:33] *** Quits: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr) (Quit: Gone)
[15:38:57] <cmr> jedestep: Correct, good point.
[15:38:59] <dbaupp> rntz: that's what they're designed for
[15:39:04] <cmr> Actually
[15:39:06] <cmr> hm
[15:39:17] <cmr> Well, I dunno
[15:39:24] <dbaupp> rntz: (there's (or will be) a generic 'utf8_error' condition, for all such instances.)
[15:39:40] <jedestep> my understanding was that objects containing @ or & references are never sendable, and all others are always sendable
[15:39:50] <dbaupp> &'static is sendable
[15:40:02] <cmr> Since lifetimes aren't tied to values I don't think it's possible for & to ever be sendable
[15:40:14] <dbaupp> (and types can be annotated with #[no_send] to stop themselves being sendable)
[15:40:17] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[15:40:17] <jedestep> hmm.
[15:40:23] <cmr> But ideally a value could be Send if it only contained pointers into itself
[15:40:58] <kimundi> cmr: But then it would be unmovable
[15:41:21] <jedestep> I'm looking into replacing most of the @Clients with &'self Clients, which would make those structs unsendable anyway
[15:41:35] <cmr> kimundi: are values which contain borrowed references movable anyway?
[15:41:45] <rntz> "movable"?
[15:41:47] <cmr> oh wait I see what you're saying
[15:41:49] <dbaupp> cmr: static x: uint = 1; let y: &'static uint = &x; do spawn { printfln!("%?", y) } (btw.)
[15:41:49] <jedestep> (by the way, if people think this is a good or bad idea, please say so :D)
[15:41:53] <cmr> it is basically borrowing itself.
[15:42:12] <dbaupp> cmr: I don't think things can borrow themselves
[15:42:18] <cmr> right
[15:43:29] <dbaupp> jedestep: another question, https://github.com/10gen-interns/mongo-rust-driver-prototype/blob/master/src/libmongo/client.rs#L35 was there a reason for ~cell::Cell rather than just cell::Cell?
[15:43:47] <jedestep> jchinlee: ^
[15:44:09] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[15:44:53] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: Textual IRC Client: www.textualapp.com)
[15:45:00] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[15:45:06] <jchinlee> dbaupp not specifically, I'll change that, thanks
[15:46:27] <cmr> jchinlee: jedestep: have you done any profiling of it yet to spot the bottlenecks in the driver? (I imagine mocking the TCP interface to test that)
[15:46:46] <dbaupp> jchinlee, jedestep: btw, the change for DB::new taking &str and then call to_owned() is probably non-rustic. If there's going to be an allocation, push it as far up the stack as possible (because the originator of the string may already have a ~str, and so no point in borrowing it to &str and then copying it immediately).
[15:46:58] <jedestep> cmr: we have not
[15:47:01] <dbaupp> (not that it matters, since it's such a tiny string, and only happens once.)
[15:47:14] *** Joins: Esmil (esmil@moz-23E4A227.dk)
[15:47:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:47:59] <jedestep> dbaupp: this would be solved by having DB/Collection hold &'self str? or just go back to having the function take ~str
[15:48:28] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[15:48:38] <cmr> It might be best to have it take a ~str
[15:48:40] <dbaupp> jedestep: either.
[15:48:47] <cmr> having to keep alive a string just to use the DB is silly.
[15:49:15] <dbaupp> "having to allocate a string just to use the DB is silly" :P
[15:50:41] <jedestep> most obvious solution: just use *c_char
[15:50:50] <dbaupp> hahaha
[15:52:00] <dbaupp> (although, there is a pull request that puts lifetimes on * pointers too. there's no escape!)
[15:52:07] <jedestep> :o
[15:52:20] <jedestep> by the way, feedback on this would be appreciated: https://github.com/10gen-interns/mongo-rust-driver-prototype/pull/17
[15:52:40] <jedestep> mostly feedback on "is this a fundamentally bad idea"
[15:53:01] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[15:53:21] <dbaupp> (the example code can exist currently, aiui, btw.)
[15:53:45] <dbaupp> wait. you say this later.
[15:53:50] <jedestep> haha yes
[15:53:51] * dbaupp shuts up
[15:54:25] <jedestep> the point is that the program doesn't do what the programmer likely intended, because the intent is to do something incorrect
[15:55:15] <cmr> The programmer, upon using @, should know that it will survive for as long as it needs to
[15:55:49] <jedestep> hmm, point.
[15:55:54] <dbaupp> in any case, using less @ is almost never a mistake.
[15:56:03] <jedestep> that was my main thought
[15:56:06] <dbaupp> (unless it makes the library hard to use.)
[15:56:09] <jedestep> and in particular I really don't want this to turn into
[15:56:19] <jedestep> "let client = Gc<Client::new()>;
[15:56:39] <jedestep> that syntax was not even close but you know what I meant
[15:56:52] <dbaupp> right.
[15:57:19] <jedestep> from what I can tell, the API feels basically unchanged
[15:57:22] <jedestep> that program becomes
[15:57:38] <jedestep> "let client = Client::new(); let db1 = DB::new(~"db1", &client); ..."
[15:58:06] <dbaupp> nice enough
[15:58:17] <cmr> jedestep: the difference is you cannot let the client go out of scope while you are using the DB
[15:58:33] <cmr> So for example you can't just return the DB
[15:58:36] <cmr> you need to return both
[15:58:42] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:58:46] <jedestep> oooh that might be a blocker
[15:58:47] <dbaupp> (although it probably makes returning a client + DB pair from a function very tricky... but I guess using @ solves that, so this is strictly more flexible.)
[15:59:01] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[15:59:29] *** Joins: sigma_mibbit (Mibbit@moz-33FE9D62.range86-146.btcentralplus.com)
[15:59:30] * dbaupp could be wrong
[15:59:37] *** Quits: sigma_mibbit (Mibbit@moz-33FE9D62.range86-146.btcentralplus.com) (Quit: http://www.mibbit.com ajax IRC Client)
[16:00:10] <doener> dbaupp: ah, no doesn't help rustc at all, because it's "if false", (no else branch) which is translated to nothing anyway
[16:00:32] <dbaupp> doener: oh, yeah
[16:00:34] <dbaupp> :(
[16:02:51] *** Quits: jaen (jaen@moz-3142E42F.neoplus.adsl.tpnet.pl) (Ping timeout)
[16:05:03] <doener> meh... I'll try to get (closer to) stable mangled names. Diffs between .ll files suck atm
[16:05:14] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[16:05:33] <cmr> It'd be really sweet to have deterministic compilation
[16:05:39] <cmr> --seed=X
[16:06:18] *** Joins: ozten (ozten@19BD73A1.5D8BCA3A.A0C1B52F.IP)
[16:06:34] <dbaupp> RUST_SEED=aisjasgj might work?
[16:06:45] <dbaupp> although that might just be for the scheduler
[16:08:07] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[16:08:32] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[16:11:30] <jedestep> cmr: correct about DB return stuff. if I just want to make a function that makes me a DB, it becomes a big messy to-do. sticking with @ is much cleaner.
[16:12:00] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[16:12:47] <bstrie> smvv: ping
[16:12:56] <smvv> bstrie: pong
[16:12:57] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[16:13:02] <bstrie> smvv: were you doing the tbaa stuff?
[16:13:39] <smvv> i would like to start with it on Monday
[16:13:59] <bstrie> smvv: doest that involve making modifications to llvm, like a new pass?
[16:14:21] <bstrie> I recall strcat saying something about needing to "write some C++" to make it work
[16:16:30] *** Joins: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP)
[16:18:01] <dbaupp> cmr: in theory IRSY will be showing the new data in a few minutes
[16:18:16] <cmr> dbaupp: does it look weird, skewed, or wrong?
[16:18:28] <dbaupp> cmr: no idea, haven't been able to look at it yet
[16:18:29] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:18:39] <cmr> (don't you have it locally before pushing it to GH pages?)
[16:18:44] <bstrie> IRSY == is rust slow yet?
[16:18:49] <cmr> bstrie: slim
[16:18:53] <bstrie> ah
[16:18:53] *** Quits: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:19:10] <cmr> "is rust slow yet?" is yes :p
[16:19:21] <bstrie> yeah I was gonna say
[16:19:23] <cmr> it's only measuring rustc really though
[16:19:24] <bstrie> way to rub it in
[16:19:25] <dbaupp> cmr: sort of, I don't want to update the script to make it compile on my current computer, because then I'll have to wait an hour for a new rust to compile on the one that actually runs this thing
[16:19:55] <cmr> dbaupp: ah
[16:19:58] <dbaupp> cmr: tl;dr: I can't actually process the data to look locally
[16:20:19] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[16:20:42] <dbaupp> it's all downloading perfectly fine though.
[16:20:59] <smvv> bstrie: we've to attach metadata to instructions, but as far as I understand it, the pass could be written in Rust. I've not spend that much time with looking in to it because I planned to start on Monday
[16:21:23] <bstrie> smvv: ok, I'm just asking so I can put a comment on the "start using upstream llvm" if necessary
[16:21:23] <dbaupp> cmr: pushed!
[16:22:30] <dbaupp> bstrie: presumably other compilers using LLVM don't have to modify LLVM itself to add passes? (because we've already got a C++ wrapper in src/rustllvm, so if smvv needs to write some C++ it can probably go in there.)
[16:22:31] <smvv> bstrie: i see. I'll let you know if there's an upstream llvm necessary
[16:22:43] <dbaupp> or are you talking about something else?
[16:22:47] *** Joins: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr)
[16:22:57] <dbaupp> cmr: it's there!
[16:23:02] <cmr> dbaupp: ok, it seems CPU time is... variable
[16:23:07] <dbaupp> cmr: yeah :(
[16:23:17] <bstrie> dbaupp: all I care about is putting a note on https://github.com/mozilla/rust/issues/4259 on whether using upstream llvm is blocked on forthcoming patches
[16:23:22] *** Joins: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP)
[16:23:29] <dbaupp> bstrie: oh, ok.
[16:24:10] <cmr> here's the problem with rollups
[16:24:12] <cmr> https://github.com/mozilla/rust/pull/7982
[16:24:15] <dbaupp> somehow https://github.com/mozilla/rust/pull/7982 won us back 150 mb
[16:24:20] <dbaupp> haha
[16:24:26] <cmr> Which one caused the 150MiB memory win?
[16:24:49] <bstrie> haha
[16:24:53] <bstrie> we'll never know
[16:25:14] <bstrie> if I had to guess, I'd say the one that made commas mandatory between the arguments to fmt!
[16:25:22] <dbaupp> the only one that looks remotely reasonable is https://github.com/thestinger/rust/commit/8d3bb7eb306993430e5f5acf3e3fbf22d7a9d97f
[16:25:28] <dbaupp> oh and the commas, of course
[16:25:39] <cmr> dbaupp: I don't see cpuacct ticks on the bottom graph
[16:25:44] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:25:47] <cmr> are you still using the cpuacct info?
[16:25:52] <dbaupp> cmr: they're there for me
[16:26:11] <dbaupp> cmr: literally no script changes, just adjusted the dl url, added a gunzip and changed index.html
[16:26:12] <cmr> hm, it seems it's just these two PRs
[16:26:36] <bstrie> dbaupp: no more data pre-july 21?
[16:26:38] <cmr> maybe they're hidden by the graph
[16:26:42] <dbaupp> bstrie: it's coming
[16:26:59] <dbaupp> bstrie: new benchmarker http://octayn.net/benches/
[16:27:01] <cmr> bstrie: the server I "borrowed" for the old bencher is no longer accessible.
[16:27:15] <cmr> so I'm just running it on my desktop :p
[16:27:15] <bstrie> icic
[16:27:22] <bstrie> wait
[16:27:26] <dbaupp> that data is still there, btw. http://huonw.github.io/isrustfastyet/mem/old/ 
[16:27:29] <bstrie> so you're compiling every commit, one at a time?
[16:27:34] <cmr> bstrie: every bors merge
[16:27:36] <cmr> yes
[16:27:38] <bstrie> that's hideous
[16:27:46] <bstrie> good work
[16:27:51] <cmr> ...how else do you get the data?
[16:27:57] <bstrie> fudge it
[16:28:08] <dbaupp> bstrie: it's a magic script
[16:28:18] <cmr> well the point of this is to have real, actionable perf data
[16:28:25] <dbaupp> (the guy who wrote it was basically a genius. :P )
[16:28:36] <cmr> bstrie: (dbaupp wrote it)
[16:28:40] <bstrie> I guess you can stop once you get to The Great Regression
[16:28:47] <bstrie> since before that it was pretty boring data
[16:28:52] <cmr> it doesn't stop
[16:28:55] <cmr> it's a robot
[16:29:12] <bstrie> so is it going to look at all commits, from the beginning of time?
[16:29:15] <cmr> as long as there isn't new PRs to bench, it benches historical data
[16:29:16] <cmr> yup
[16:29:22] <bstrie> you're insane
[16:29:28] *** Joins: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP)
[16:29:28] *** ChanServ sets mode: +o dherman
[16:29:41] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[16:29:56] <cmr> it's just `while true; do auto-bench.py; rsync ...; done`
[16:30:06] <bstrie> I'm surprised it's even possible to compile rust builds from that long ago
[16:30:18] <bstrie> are all the old snapshots perma-saved somewhere?
[16:30:21] <cmr> yes
[16:30:24] <cmr> they're all in S3
[16:30:25] <dbaupp> bstrie: http://huonw.github.io/isrustfastyet/mem/old/#00dbbd0 is 0.6 btw.
[16:30:30] *** Quits: libertas (libertas@moz-8B59994C.cpe.netcabo.pt) (Quit: Lost terminal)
[16:30:54] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[16:31:03] <bstrie> well it will certainly be a very interesting graph
[16:31:06] <bstrie> when it's done populating
[16:31:08] <bstrie> in 2019
[16:31:29] *** Quits: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:31:38] <cmr> There are 1290 bors merges
[16:31:47] <dbaupp> ok, now that it works... bedtime. night all.
[16:31:51] <bstrie> night
[16:32:29] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[16:32:40] <cmr> At 19 minutes per benchmark that's 408 hours
[16:32:52] <cmr> Which is only 17 days
[16:32:57] <pnkfelix> graydon: did the bug triage mtg get cancelled?  Or am i in the wrong vidyo room...?
[16:33:03] <bstrie> ok I thought you were even going to try going back beyond bors
[16:33:05] <cmr> and since bors takes what, 1 hour? I can keep up
[16:33:15] <cmr> I have no idea what's going to happen if/when we get past bors
[16:33:17] <bstrie> which would be broken much more often
[16:33:20] <cmr> it will probably explode
[16:33:48] <bstrie> maybe the script is smart enough to start benching the ocaml compiler
[16:33:56] <cmr> definitely isn't
[16:34:22] <bstrie> o ye of little faith
[16:34:27] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[16:34:32] <cmr> it runs ../configure; make -j4; ..../stage2/..../rustc ../src/librustc/rustc.{rc,rs}
[16:34:41] <cmr> and times/memory profiles that last one
[16:34:46] <cmr> pnkfelix: OSCON?
[16:34:54] <pnkfelix> cmr: ah, good point
[16:35:40] *** Quits: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP) (Quit: dherman)
[16:36:29] <cmr> pnkfelix: #rust-triage
[16:36:38] *** Quits: brendan (brendaneic@moz-A451F224.hfc.comcastbusiness.net) (Ping timeout)
[16:36:47] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[16:36:56] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[16:37:04] <pnkfelix> cmr: wait, so it *is* going on?
[16:37:14] <cmr> pnkfelix: dunno
[16:37:51] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[16:39:14] *** Joins: eholk (eholk@moz-E654C98C.uconnect.utah.edu)
[16:40:33] *** Joins: jaen (jaen@moz-6DE4606C.play-internet.pl)
[16:43:04] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[16:43:06] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[16:43:24] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[16:44:37] *** Joins: judder (maradukewa@3226AE5F.7C541960.78E362FE.IP)
[16:47:14] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[16:47:20] *** Quits: RMF (RMF@5C293616.B791E6A9.8D19547B.IP) (Ping timeout)
[16:47:54] *** Joins: rfw (rfw@moz-C65A114.rfw.name)
[16:51:26] *** Joins: RMF (RMF@moz-6AD5ED61.dsl.telepac.pt)
[16:51:45] *** Quits: acrichto_ (acrichto@moz-B63D64BD.res.cmu.edu) (Quit: leaving)
[16:51:51] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[16:51:54] <graydon> nope. not enough people for quorum.
[16:52:02] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[16:52:05] <graydon> 2 people can't agree/disagree on things-for-the-team.
[16:54:03] <jdm> heh
[16:55:21] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[16:55:52] <kimundi> graydon: Hm, I'm not sure about how the 'in' placement operator would be better than an 'alloc' expression. Can you ellaborate a bit?
[16:56:07] *** Joins: brson (brson@33605CA4.9F929CFD.F9E1BAE1.IP)
[16:56:07] *** ChanServ sets mode: +o brson
[16:56:31] <graydon> kimundi: same idea, just recycling a keyword we're considering adding anyways
[16:56:35] *** Quits: brson (brson@33605CA4.9F929CFD.F9E1BAE1.IP) (Quit: leaving)
[16:56:36] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[16:56:38] <sully> wow, looks like my PR landed
[16:56:45] *** Joins: sanxiyn (tinuviel@33605CA4.9F929CFD.F9E1BAE1.IP)
[16:57:10] <kimundi> graydon: But doesn't this just cover the "allocate into an existing object"-part of it?
[16:57:13] <toddaaro> is brson going to be around on irc today?
[16:57:19] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[16:57:41] *** Joins: erickt2 (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[16:57:41] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Connection reset by peer)
[16:57:42] <graydon> brson just came and went
[16:57:52] * sanxiyn is at OSCON together with brson
[16:57:54] <graydon> I doubt he, pcwalton or jack are likely to be around a lot; they're at OSCON
[16:57:57] <kimundi> Or is the idea that things like the global Gc, Rc heap will be exposed as 'static objects?
[16:58:05] <toddaaro> hm
[16:58:06] <graydon> even if present, they're likely to be busy
[16:58:16] <graydon> sanxiyn: you made it! cool
[16:58:17] <toddaaro> blocked currently on what are likely major design decisions in the scheduler
[16:58:31] <toddaaro> so it would be nice to get his input before I decide
[16:58:43] <graydon> kimundi: I don't know what you're asking
[16:58:46] <cmr> toddaaro: there's this cool thing called "email" :p
[16:58:59] <graydon> toddaaro: email, or if not -- are there other things you can do in the meantime?
[16:59:01] <cmr> graydon: someone used the example of "foo in Gc"
[16:59:03] <toddaaro> graydon: no
[16:59:05] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[16:59:08] <cmr> Is what he's asking I think
[16:59:22] <graydon> cleanups, documentation, tests, etc? maybe start sketching the rtio::file thing? I tried to get into that on monday but got too confused about how it works
[16:59:33] <sully> ok, so, hm; I think I might want to do a snapshot
[16:59:48] <cmr> sully: we just had one the other day, shouldn't be hard
[16:59:53] *** erickt2 is now known as erickt
[17:00:19] <sully> has the process changed with the advent of bors?
[17:00:32] <cmr> https://github.com/mozilla/rust/wiki/Note-compiler-snapshots has directions
[17:00:34] <kimundi> graydon: Well you described '<exp1> in <exp2>' as "evaluating exp2 as a allocator interface, and placing expr1 into it", right?
[17:00:49] <cmr> aiui you justr push to.... some branch with the name 'snap' in it
[17:01:08] <toddaaro> graydon: I'm in the middle of trying to merge my work into task killing, but the merge has exposed a fundamental issue in how the runtime is implemented. We are using way too many of the abstractions we implement, so I can't get the merge to work.
[17:01:46] <toddaaro> graydon: so I can't really do anything at all until this is figured out, as documentation would be wrong, tests would be unrunnable, etc.
[17:01:53] <kimundi> I'm just wondering how that covers the situations where you don't have a specific object to allocati into... Like in the case of a task-local heap, or something that just calls malloc() and free()
[17:02:04] <graydon> sully: not especially. you land the snapshot-registration step like any other PR. you can give it a high priority if you like.
[17:02:24] <toddaaro> I've been trying to just wrangle it together, but without a clear "goal" for how to resolve the situation is is mostly just a pile of hacks, and my work recently has been cleaning up and removing that sort of thing
[17:02:24] <sully> ok
[17:02:28] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[17:02:51] <graydon> kimundi: you'd get an allocator interface from TLS or a global static that implements the trait, I imagine
[17:03:05] <graydon> kimundi: (just making stuff up presently)
[17:03:37] <graydon> sully cmr: snap-stage3, yeah
[17:03:44] <kimundi> So you'd have to do 'let x: Gc<T> = foo() in Gc::heap;' ?
[17:03:54] <sully> (now that default methods are basically working, I want to do a snapshot to make it so that people can fully use them in the libs)
[17:04:03] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[17:04:03] *** ChanServ sets mode: +o tjc
[17:04:11] <sully> ok, so, just start by pushing to stap-stage3?
[17:04:18] <graydon> sully: just push master to that, wait, for all-green on the snap3 builders, copy the hashes out the build logs into snapshots.txt, land that change
[17:04:40] *** bent is now known as bent|lunch
[17:04:59] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:05:00] <ghrust> 01[13rust01] 15msullivan merged 06master into 06snap-stage3: 02http://git.io/6eIL_A
[17:05:00] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:05:04] <sully> ok, so just like last two summers
[17:05:16] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[17:05:18] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Client exited)
[17:05:23] <sully> well, I guess where I watch for the builders is different
[17:05:49] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Ping timeout)
[17:06:26] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[17:07:03] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[17:07:23] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:07:27] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[17:07:34] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:07:56] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:09:10] <kimundi> graydon: It just seems strange to me... You loose the ability to easily allocate things in static heaps and all you win is that the allocation expression is one token shorter.
[17:09:23] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[17:09:46] * kimundi wishes he would be competent enough to talk about those things professionally
[17:10:01] <cmr> Using "in" as a "contains" operator would be cool too.
[17:10:04] *** Quits: jmsaunde (jmsaunde@moz-6FB6A254.cmclub.uwaterloo.ca) (Quit: leaving)
[17:10:13] <graydon> kimundi: I actually can't understand what you're getting at. too many conversations going on at once. what's the concern? it's not changing anything we currently do, as far as I can tell, just adding a capability
[17:10:58] <graydon> toddaaro: I think email is all you can do today then. or work on different bugs for a break. we do have a nice 1300-bug backlog. always stuff to do on other side-branches.
[17:11:19] <kimundi> graydon: Okay, the way I see it there are two different places where you can allocate objects
[17:11:27] *** Joins: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[17:11:48] <kimundi> 1. heaps with static lifetime. examples: ~T, @T, Rc<T>
[17:12:43] <kimundi> 2. heaps with non_static lifetime: let x: ArenaHandle<T> = arena.allocate(...);
[17:14:22] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[17:14:51] <kimundi> So I'd think that it would make sense to have two allocation expressions: One that just takes the expression to place int the new allocation, and one that does the same but also allows to specify a target.
[17:15:09] <toddaaro> graydon: I'm working on an e-mail now. I guess I could look at the compiler code for the first time today.
[17:15:12] <kimundi> let x: Gc<T> = alloc <expr>;
[17:15:29] <cmr> toddaaro: the E-needstest tag is nice and easy
[17:15:30] <kimundi> let x: Arena<T> = alloc <expr> in <expr>;
[17:15:45] *** Quits: BitPuffin (quassel@moz-712D2723.bredband.tre.se) (Ping timeout)
[17:16:00] <graydon> kimundi: why not "let <expr> in gc::Gc" ?
[17:16:18] <graydon> er, let x = <expr> in gc::Gc
[17:16:37] <kimundi> Well, what is Gc thete?
[17:16:41] <kimundi> there*
[17:17:00] <kimundi> a type, or a static dummy object?
[17:17:05] <bstrie> toddaaro: also take a look at the E-easy tag, some of those are actually easy :)
[17:17:46] *** Joins: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com)
[17:17:48] *** Joins: BitPuffin (quassel@moz-4DE4682C.mobile.tre.se)
[17:17:54] <kimundi> graydon: Maybe I'm misunderstanding the syntax you're propsing...
[17:18:45] *** Quits: jaen (jaen@moz-6DE4606C.play-internet.pl) (Ping timeout)
[17:19:12] *** Quits: RMF (RMF@moz-6AD5ED61.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[17:19:40] *** Joins: RMF (RMF@moz-6AD5ED61.dsl.telepac.pt)
[17:20:04] <doener> // XXX: clownshoes
[17:20:07] <doener> what's that?
[17:20:13] <cmr> doener: __foo__
[17:20:16] <cmr> those are clownshoes
[17:20:17] <graydon> kimundi: it's a static that implements a trait
[17:20:19] <cmr> (I asked th e same thing)
[17:20:30] <graydon> hah
[17:20:33] <graydon> who said that?
[17:20:45] <cmr> don't remember
[17:20:47] <cmr> bstrie I think
[17:21:01] <bstrie> what did I say?
[17:21:04] <graydon> "clownshoes" is a general expression (possibly mozilla-centric) for something that's ridiculously silly
[17:21:20] <graydon> awful, awkward, so bad it's funny
[17:21:23] <graydon> embarassing
[17:21:34] <bstrie> don't think I have ever used that term :)
[17:21:45] <graydon> with a tinge of "maybe incompetent"
[17:21:52] <cmr> oh it was dbaupp
[17:22:01] <cmr> 84:2013-06-28 16:47:20 bblum ugh, clownshoes extensions doesn't tell you in the debug symbol what the extensions are for
[17:22:03] <cmr> 234433:2013-07-12 05:33:39 dbaupp cmr: e.g. clownshoes_extensions `...::__extensions__::...`
[17:22:05] <graydon> the things in the compiler with the word "clownshoes" on them are things that are worse-than-awful-hacks
[17:22:25] <true_droid> why doesn't md4 implement Digest?
[17:22:38] <cmr> true_droid: probably didn't exist when md4 was written
[17:22:38] <graydon> because someone just made up the Digest trait recently and forgot to add it
[17:22:48] <true_droid> oh, ok
[17:23:22] <graydon> http://venge.net/graydon/clownshoes.png for example as an image martell cooked up for something that's _worse_ than clownshoes
[17:23:37] <kimundi> graydon: Okay, so... Your `in` would mean that you allways have to specify a target heap (the gc::Gc), right?
[17:23:54] <graydon> kimundi: I think so, though again I'm just making stuff up.
[17:23:56] <graydon> but yes
[17:24:00] <graydon> that's how I was picturing it
[17:24:14] <kimundi> graydon: Oh, so am I;)
[17:24:18] <kimundi> Anyway
[17:24:19] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:24:24] <graydon> and ~<expr> and @<expr> would wind up as sugar for that if we managed to get the library interfaces clean enough to support that
[17:25:10] <kimundi> graydon: Hm...
[17:25:13] <nmatsakis> erickt1: pin
[17:25:14] <nmatsakis> *ping
[17:26:02] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[17:26:08] <nmatsakis> graydon: one downside of "foo in bar" is that it exists in other languages with quite a different meaning...
[17:26:10] <kimundi> graydon: Ideally I'd like to see a convenient solution that isn't more cumbersome than necessary
[17:26:33] <cmr> nmatsakis: I don't think it's that big of a downside.
[17:26:34] <graydon> nmatsakis: as a has-element operator?
[17:26:37] <nmatsakis> graydon: also, how would we handle ~T? Would we just keep it?
[17:26:44] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[17:26:56] <nmatsakis> I liked that you could have `new expr` -> `~expr` and `new(X) expr` 
[17:27:06] <nmatsakis> and then have only one operator for allocation
[17:27:10] <olsonjeffery> libraritize *all* the language features!
[17:27:12] <graydon> nmatsakis: I don't think we'd lose @ or ~ as sugar. everyone seems to like 'em.
[17:27:39] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:27:46] <nmatsakis> hmm. ok. have to mull on it I guess.
[17:28:00] <nmatsakis> I do like how we've kept the expr forms mirroring the type forms for the most part
[17:28:06] <graydon> I haven't got anything remotely like a worked-out version of this in mind. I was really just asking about the keyword. personally I don't care _that_ much about custom smart pointers. I do care about arenas.
[17:28:17] <nmatsakis> yes
[17:28:33] <graydon> but the "we must put GC and RC in libraries" impetus is not .. something I care so much about. I'm fine with ~ and @ remaining builtins. that's other folks' interest :)
[17:28:33] <olsonjeffery> would there be some kind of allowance for run/build-overload of what allocator gets used for ~/@ .. seems like that'd be useful for zero.rs et al
[17:28:35] <nmatsakis> `new(arena) expr` vs `expr in arena` ... both are reasonably ok
[17:28:37] <kimundi> graydon: Yeah, the gereral idea to use the keyword is fine in my eyes
[17:28:55] <cmr> olsonjeffery: we already do
[17:28:55] *** Quits: xraycat (Adium@moz-64B9DD7.pool.mediaways.net) (Quit: Leaving.)
[17:28:56] *** Joins: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP)
[17:28:56] *** ChanServ sets mode: +o dherman
[17:29:01] <cmr> olsonjeffery: the allocator is a language item aiui
[17:30:02] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[17:30:22] <doomlord> thats would be an interesting halfway house, if ~ and @ allocs/frees simply bind to replaceable global functions if you dont use the suppled one..
[17:31:40] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[17:31:50] <nmatsakis> graydon: I...care about both, to some extent, but I think care mostly about things feeling simple and orthogonal. To that end, `new==allocation` was somewhat appealing to me, though obviously it makes Rust's syntax just that much more conventional, for better and worse
[17:32:01] <olsonjeffery> let n = foo::new() in my_tinfoil_hat::malloc;
[17:32:20] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Quit: WeeChat 0.4.2-dev)
[17:33:15] <erickt> nmatsakis: pong
[17:34:21] <nmatsakis> erickt: I didn't quite understand your comment on #7887
[17:34:24] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[17:34:32] <nmatsakis> erickt: " do we need partial forms of functions like
[17:34:39] <nmatsakis> erickt: +`.take()`"
[17:34:47] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[17:34:57] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Leaving)
[17:34:57] <nmatsakis> erickt: maybe I just don't know what take() is. I thought that was unwrap?
[17:35:10] <nmatsakis> one of the hard things with reading that bug is the mix of method names that are in use 
[17:35:14] <nmatsakis> :)
[17:35:20] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[17:35:27] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Ping timeout)
[17:35:32] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[17:37:39] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Ping timeout)
[17:37:44] <erickt> nmatsakis: option.rs has a function take, that if that option has a value, it'll return it and mutate the option to None. It's kind of like .unwrap() but it doesn't consume the value. It behaves similarly to cell. Anyway, I just noticed that we have three different variations of .take() in option.rs: .take(), .take_map(), which is just .take().map_consume(), and .take_map_default(), which returns a default value if the option is None
[17:38:13] <erickt> nmatsakis: there are 6 variations of Option.map
[17:38:15] <nmatsakis> erickt: ah, ok, that used to be called swap_mut or something
[17:38:59] <nmatsakis> erickt: thanks, that makes more sense.
[17:39:30] <erickt> I just think we need to draw the line somewhere between adding these sugar methods and just having people chain some method calls
[17:40:46] <olsonjeffery> anyone here planning to make it to the portland event tomorrow?
[17:40:58] <erickt> especially if I want to add a ".expect()" variant to give these partial functions a better error message. I'd end up having to add 6 more .map variants in order to be consistent
[17:42:06] <erickt> kimundi: ping
[17:42:14] <kimundi> pong?
[17:42:16] <nmatsakis> erickt: tbh I am not a big fan of expect
[17:42:30] <nmatsakis> erickt: constructing a good error message requires inserting useful values,
[17:42:37] <nmatsakis> erickt: which is too expensive to do when not failing,
[17:42:43] <nmatsakis> erickt: so expect tends to be a constant string,
[17:42:47] <nmatsakis> erickt: and you can get the same info from the backtrace.
[17:43:01] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[17:43:10] <nmatsakis> erickt: plus it clutters up the code at the call site
[17:43:27] *** Joins: devinus (devinus@moz-3C0F65B9.sw.biz.rr.com)
[17:43:33] <kimundi> nmatsakis: Could take a closure instead ;)
[17:43:52] <erickt> kimundi: I got a question about https://github.com/mozilla/rust/issues/7887 too :) I can't tell if you are in favor of replacing .take_unwap() with .take().unwrap(). Which side of the fence are you on?
[17:43:55] <nmatsakis> kimundi: yes, I know, but ... yet more clutter :) 
[17:44:51] <nmatsakis> erickt: maybe we should just define swap as a method for all T, then you could write "foo.swap(None)"
[17:44:56] <nmatsakis> erickt: and not have take at all
[17:45:23] <sully> eh, I think the constant string from expect() *would* be valuable if we actually printed it when the compiler failed
[17:45:30] <nmatsakis> I don't
[17:45:34] <nmatsakis> at least, no more valuable than the backtrace
[17:45:37] <kimundi> erickt: Well, following the strcat-school of library declutering: If it's expressible as two composable method calls, than there is no need for it.
[17:45:39] <nmatsakis> or the filename/line-number combo
[17:45:54] <nmatsakis> well, ok, slightly more valuable
[17:46:04] <nmatsakis> but not enough to justify it in my mind
[17:46:06] <erickt> nmatsakis: maybe I should have used .map() instead of .take() in my example. I see this same problem happening there as well
[17:46:15] *** Joins: dreamer__ (dreamer_@90E8C08F.8480A87C.DDAA0084.IP)
[17:46:17] <sully> I also think it makes people stop and think briefly about why they think it is guarenteed to be Some
[17:46:17] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[17:46:23] <tjc> sully: yes, I agree
[17:46:37] <tjc> to me "expect" is usually a placeholder for "I need to go back to this and justify why I'm assuming it's Some here"
[17:47:09] <nmatsakis> I can see the argument that making it more to type makes people more likely to try harder and align types,
[17:47:13] <nmatsakis> which I approve of
[17:47:14] <tjc> a little like "unsafe"â€¦ it says "there should be documentation here explaining this reasoning"
[17:47:23] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[17:47:32] <erickt> kimundi: I like the idea of using a closure for .expect()
[17:47:35] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:48:07] <nmatsakis> but overall I'm still pretty unpersuaded, particularly because I find reading code that uses expect vs get more difficult
[17:48:37] * nmatsakis shrugs
[17:48:50] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[17:48:51] <nmatsakis> I know I'm kind of swimming upstream here a bit. 
[17:49:13] <erickt> I personally find the name expect weird too. It'd probably be better named something like .unwrap_or_fail_with
[17:49:29] <sully> the other argument for .expect() is that if you get rid of it, tjc will go replace all your .get()s with 6 line matches :P
[17:49:32] <nmatsakis> particularly around hashtables, though, there's not a lot to say... some_map.find(id).expect("id really...should be there")
[17:49:38] <tjc> yeah, I probably will :-)
[17:49:45] <sully> I like it because it seems a decent middle ground between the two camps
[17:50:00] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:50:30] <nmatsakis> I can see that, though it might be a "worst of both worlds" sort of thing
[17:50:32] <nmatsakis> to me :)
[17:50:41] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:50:56] <nmatsakis> or perhaps I just feel argumentative today
[17:52:46] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[17:52:46] <tjc> nothing ruins my mood like seeing "get: option::None" or whatever the error message is
[17:52:46] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/P55GEg
[17:52:46] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[17:53:02] <tjc> because it tells me "somebody didn't think it was worth their time to think about why their code works, and now it's my problem"
[17:53:07] <tjc> of course, sometimes that "somebody" was me :-)
[17:53:11] <bstrie> haha
[17:53:20] <cmr> That's why I like .expect()
[17:53:27] <cmr> I put the invariant I expect in the message
[17:53:27] <bstrie> tjc: how about a lint pass that throws a warning when anyone uses .get?
[17:53:46] <tjc> bstrie: if we enabled it in rustc?  sure!
[17:54:05] <bstrie> well in rustc it should be forbidden rather than just a warning :P
[17:54:06] <erickt> nmatsakis: on another note, have you had any time to dive into my adding-regions-to-unsafe-ptrs PR? https://github.com/mozilla/rust/pull/7967
[17:54:09] <cmr> I never use Option::get, very rarely Option::unwrap
[17:54:17] <bstrie> we could have a whole attribute to put on things that are Bad
[17:54:26] <nmatsakis> erickt: I haven't really because I wanted to bring it up at the meeting first
[17:54:28] <bstrie> #[you_are_bad_and_you_should_feel_bad]
[17:54:30] <jedestep> #[clownshoes]
[17:54:32] <tjc> that's what I mean
[17:54:34] <bstrie> jedestep: +1
[17:54:35] * nmatsakis rolls his eyes
[17:54:39] <doomlord> get is a workaround to extract a value from Option ? 
[17:54:49] <doomlord> without a whole match ?
[17:54:51] <jedestep> :)
[17:54:56] <bstrie> doomlord: it's just a shorthand for if you want to fail on None
[17:54:58] * erickt would be happy to get rid of Option::get. In almost all cases it'd be better to use unwrap
[17:55:01] <cmr> doomlord: well it's just a match in the method
[17:55:09] <nmatsakis> erickt: I thought get was a synonym of unwrap now?
[17:55:10] <tjc> doomlord: it's a partial function, so it entails a proof obligation that the function is always defined on the input you give it
[17:55:18] <cmr> I don't really understand what the difference betwee get and unwrap is
[17:55:21] <tjc> in other words, it introduces a type constraint that Rust's type system can't check
[17:55:31] <cmr> They look identical to me
[17:55:44] <erickt> nmatsakis: oh hey it is, I thought it still had an implicit .clone()
[17:55:48] <cmr> One has an early return statement, one doesn't
[17:55:51] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[17:55:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Ne9O0A
[17:55:51] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[17:55:51] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:55:51] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/gkUq8Q
[17:55:51] <ghrust> 13rust/06auto 145c729c0 15Etienne Millon: Check for comparisons to NaN in patterns...
[17:55:51] <ghrust> 13rust/06auto 14fdd71be 15Etienne Millon: Generalize NaN pattern detection using walk_pat
[17:55:52] <ghrust> 13rust/06auto 14f929a49 15Etienne Millon: NaN patterns: indicate that is_NaN is a method
[17:55:52] <tjc> get is not the only such function, but it's possibly the most common one
[17:55:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:56:44] <graydon> I continue to feel very sad about the presence of get() and options in APIs, the general non-use of conditions
[17:56:46] <erickt> nmatsakis: I'm happy to wait until the next meeting to follow up on #7967. I doubt it'll get *that* bitrotten in a week :) 
[17:57:03] <graydon> (doubly so the use of Result)
[17:57:20] * cmr doesn't know how conditions work or how to use them
[17:57:39] <graydon> at very least option and result .get() should raise a condition, not fail on none/err
[17:57:40] <kimundi> nmatsakis, graydon: Hm... sorry for keeping distracting you, but I find this allocation expression stuff really interesting. :) I'd really like to see a solution that is general and nice enough so that you can allocate any type in any kind of allocator, and have it work with unsized types too.
[17:58:30] <sanxiyn> graydon: The thing is at the moment condition doesn't work at all across crate
[17:58:44] <nmatsakis> kimundi: not distracting, I think it's important. I guess at this point it's mostly a question of what syntax we decide is most...aestheticaly pleasing?
[17:58:48] <sanxiyn> So if Option.get condition is defined in std crate, it would be useless (at the moment)
[17:58:53] <sanxiyn> More on https://github.com/mozilla/rust/issues/6919
[17:59:11] <nmatsakis> kimundi: well I mean there are still some hard questions to work out, mostly (in my mind) around the GC integration and so forth
[17:59:18] <engla> graydon: the use of Option, to force explicit handling of the failing case, isn't that a good pattern?
[17:59:19] <tjc> bbiab
[17:59:22] <nmatsakis> graydon: I did a little poking at MPS, btw, it looks ... pretty neat?
[17:59:24] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: zzzzzzzzzzz)
[17:59:43] <graydon> sanxiyn: ah. only on windows?
[17:59:53] <graydon> sanxiyn: I should fix that. that's a bit of a showstopper isn't it? :((
[18:00:14] <sanxiyn> graydon: On everything, as far as I know
[18:00:19] <graydon> engla: if you have no reasonable way to handle it locally, as many APIs do, then it's a bad pattern.
[18:00:28] <graydon> sanxiyn: oh, awful. ok. I'll look into it.
[18:00:29] <cmr> graydon: A blogpost/tutorial about what conditions are, how to use them, and what they do at runtime would be very nice.
[18:00:31] <graydon> it needs reform anyways
[18:00:35] <kimundi> nmatsakis, graydon: Could something like this work: https://gist.github.com/Kimundi/f05175e89cb5c42a951b ? Semantically, that is.
[18:00:44] <graydon> yeah. I should write a tutorial. I should also make them work and fix the bugs in 'em.
[18:01:50] *** Joins: mellum (falk@moz-9E0B8A76.dip0.t-ipconnect.de)
[18:02:36] <sanxiyn> graydon: I encountered that bug while trying to write a character set encoder/decoder with error handling using condition
[18:02:44] *** Quits: bstrie (ben@moz-D5A1D0F5.members.linode.com) (Input/output error)
[18:03:40] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:03:52] <graydon> o
[18:03:53] <graydon> ok
[18:03:56] *** Quits: mellum (falk@moz-9E0B8A76.dip0.t-ipconnect.de) (Ping timeout)
[18:04:05] <graydon> I'll look into it. that should be on my short list. along with the existing deficiencies in conditions.
[18:04:35] <nmatsakis> graydon: one problem is that the borrowck treatment of closures isn't right yet, making conditions somewhat unsafe, but I imagine for normal uses that won't be an issue
[18:04:38] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:05:07] <nmatsakis> anyway I'm working on fixing that, slowly slowly. I'm trying to dedicate a day or two a week to Rust continuously now, hoping that works better than the finer-grianed time-slices, which mostly seemed to be getting me nowhere.
[18:05:22] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[18:06:35] *** Quits: Ms2ger (Ms2ger@E699BE68.4A4AF98A.F15B0BB3.IP) (Quit: nn)
[18:06:35] <graydon> nmatsakis: I appreciate it, thanks
[18:09:25] *** sam113101 is now known as sam113101_afk
[18:09:50] *** sam113101_afk is now known as sam113101
[18:09:58] <erickt> kimundi / nmatsakis: without giving any real thought to it, I wonder if there's some way of using regions to help define where a pointer lives. Being able to write something like `let 'my_arena = Arena::new(); let foo = ~'my_arena 123` feels almost natural to me, and carries over the semantics that those malloced pointers can't escape the lifetime of the arena
[18:10:22] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Quit: leaving)
[18:10:58] <kimundi> hmm...
[18:12:01] <nmatsakis> erickt: the basic idea was going to be "let my_arena = Arena::new(); let foo = new(my_arena) 123, or else let foo = 123 in my_arena
[18:12:55] <nmatsakis> although we had always talked about it as more of a smart pointer thing... have to hammer out details, presumably that could be made to work too
[18:13:27] <cmr> I much much much prefer the look of `123 in my_arena` to `new(my_arena) 123`
[18:13:35] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:14:26] *** Joins: Waka_Flocka_Flame (Waka_Flock@moz-AF1E4A33.clients.kiwiirc.com)
[18:16:11] <erickt> how do we handle allocating compound structures? Say we had something like `fn make_foo() -> ~Foo { ~Foo { a: ~"abc", b: Some(~5) } }`? Does calling `make_foo() in my_arena` cause all the allocations in make_foo to happen in the arena? Or just the top level structure?
[18:17:00] <cmr> erickt: just the top level structure I'd imagine... dunno
[18:17:05] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:17:18] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:17:33] <kimundi> erickt: Well, it would work like in other cases: just the outer one.
[18:18:04] <kimundi> it's like let x = @@~@~@@~~~@@~@~@~@@@~~~@@~"hello" :P
[18:18:11] <doomlord> are these arenas something the pointer adress carries the information of (when it comes to free, it knows which arena its in by the arenas' adress range)
[18:18:23] <cmr> doomlord: no
[18:18:33] <cmr> well, maybe
[18:18:37] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:18:37] <cmr> they're allocation strategies
[18:18:53] *** Joins: tcr (tcr@moz-78FFB457.hfc.comcastbusiness.net)
[18:18:53] <kimundi> doomlord: The idea is that you get a smartpointer that is somehow linked to the arena it corresponds to.
[18:19:03] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:19:03] <erickt> I kind of want both. It'd be to not have to thread an allocator throughout all these function calls, but then we'd have to thread that allocator into every function through an argument or TLSâ€¦ ick
[18:19:06] <cmr> specifically here I think it'd be a custom allocator, but the trait could be used to interface to a unified allocator if it exposed multiple allocation strategies.
[18:19:26] <doomlord> (i've seen peolpe do pooling using adress ranges to propogate the information, but it relied on VirtualAlloc or  its equivalent)
[18:19:49] <kimundi> doomlord: so if that smartpointer handle calls its destructor, it can return the memory it used to the arena
[18:20:18] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[18:21:07] <kimundi> doomlord: It would basically be the same as borrowing an interior pointer, or slicing an array of bytes.
[18:21:08] <doomlord> on another note i was wondering if template-template parameters were very hard to implement or not (aka "higher-kinded polymorphism"?) .. and whether or not that would help you propogate more information in pointer types eg  doSomethign<Ptr,X,Y>(a: Ptr<X>)->Ptr<Y> ...
[18:21:58] <cmr> doomlord: higher kinded types are planned afaik
[18:22:13] <doomlord> wow thats something to look forward to :)
[18:22:17] <kimundi> doomlord: hkt's are something where an patch would be welcome, and wich would be very handy, but they are no priority right now.
[18:23:18] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:23:47] <nmatsakis> fwiw, if anyone is thinking of implementing HKT's, I'd prefer they talk to me first, because I'd rather expend such energy on other projects and get things cleaned up first.
[18:25:42] <doomlord> i suppose with the pointers its easier for you to work directly in the compiler rather than implement an abstract system that lets libraries implement it
[18:26:10] <doomlord> and you get to make "real" syntax
[18:29:23] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[18:29:25] *** Joins: Blub\w (wry@moz-81ABD137.dip0.t-ipconnect.de)
[18:29:59] *** Quits: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP) (Quit: dherman)
[18:33:03] <sully> ok, snapshot building
[18:33:18] *** Quits: devinus (devinus@moz-3C0F65B9.sw.biz.rr.com) (Quit: Computer has gone to sleep.)
[18:35:23] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[18:35:47] *** Quits: Blub\w (wry@moz-81ABD137.dip0.t-ipconnect.de) (Quit: brb)
[18:36:10] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[18:36:23] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[18:36:45] *** Joins: Vert (quassel@8A83479C.391ACC8C.CAF63861.IP)
[18:38:09] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[18:38:18] *** Joins: Blub\w (wry@moz-3BB2D1B4.vps.tuwien.ac.at)
[18:38:20] *** Quits: ozten (ozten@19BD73A1.5D8BCA3A.A0C1B52F.IP) (Quit: ozten)
[18:40:22] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[18:40:24] <nmatsakis> anyone around who understands rpath / linking etc?
[18:40:34] <nmatsakis> I'm seeing a failure on my branch that I ... kind of don't get.
[18:40:52] <Blub\w> what's the issue?
[18:40:54] <mcpherrin> Who made the /r/rust subreddit?
[18:40:59] <mcpherrin> 'cause the description is "seriously, I have no idea where this "description" field is even used.
[18:41:07] <cmr> mcpherrin: bstrie did I think
[18:41:19] <mcpherrin> the answer is reddit.com/subreddits/mine at least displays it
[18:41:44] <nmatsakis> Blub\w: the immediate issue is that I get errors like "unmatched symbol dlsym" on my branch
[18:41:59] <nmatsakis> Blub\w: when compiling "run-pass/smallest-hello-world.rs" specifically
[18:42:08] <kmc> hm if I just put a hello world program in foo.rs and compile it, what crate and module have I created?  RUST_LOG='::help' doesn't show any
[18:42:11] <nmatsakis> this is the branch that removes external fn wrappers
[18:42:18] *** bent|lunch is now known as bent
[18:42:29] <cmr> kmc: foo
[18:42:52] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:42:56] <Blub\w> don't see how that relates to rpath
[18:43:13] <Blub\w> unless the order is important
[18:43:46] <nmatsakis> Blub\w: well, I don't know that it does, except that the command link to link ends in "-lrustrt"---if I manually add "-ldl -lrt" at the end, it works fine
[18:43:50] <Blub\w> but if the symbol doesn't "match" I'd expect it to look for the next "matching" one anyway (assuming it's a visibility or versioning thing)
[18:43:57] <nmatsakis> Blub\w: but then again it works for other tests, just not that one, without those flags
[18:44:01] <nmatsakis> Blub\w: and it seems to work on master
[18:44:12] *** Joins: devinus (devinus@moz-3C0F65B9.sw.biz.rr.com)
[18:44:24] <Blub\w> I'm guessing that's on linux, as ie freebsd doesn't use -ldl
[18:45:16] <Blub\w> nmatsakis: does this particular test use extern functions? and/or does it use dlsym()?
[18:45:40] <nmatsakis> Blub\w: you can see it yourself, it's a very specialized test that calls puts and overrides all the rest of the Rust stdlib
[18:45:49] <nmatsakis> Blub\w: it doesn't link against std, for example
[18:48:03] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[18:48:26] <Blub\w> hmmm
[18:48:59] <nmatsakis> it does not use dlsym that I can tell
[18:49:10] <nmatsakis> I think that requirements comes from the rustrt which is always added at the end
[18:49:16] <Blub\w> can't test myself as I'm on holidays with limited internet access and haven't pulled from git in ages on this machine
[18:49:20] <nmatsakis> it's not clear to me why this works normally though but just not with my particular test
[18:49:29] <nmatsakis> or rather just not on my branch
[18:50:26] <Blub\w> the librustrt.so I have on my machine though is linked against libdl.so 
[18:50:46] <Blub\w> has that changed since 0.6something?
[18:51:01] <nmatsakis> I don't think so
[18:51:09] <nmatsakis> but maybe
[18:51:13] *** Joins: tjc (tjc@moz-3685EAD3.hsd1.ca.comcast.net)
[18:51:13] *** ChanServ sets mode: +o tjc
[18:51:32] <kmc> cmr: I don't get debug output with RUST_LOG='foo=4' or RUST_LOG='foo::foo=4'
[18:51:35] <cmr> It does here
[18:51:44] <cmr> kmc: did you compile with `--cfg debug`
[18:51:46] <cmr> ?
[18:51:53] <Blub\w>    196: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND dlsym@GLIBC_2.2.5 (14)
[18:52:01] <Blub\w> hmm
[18:52:33] <kmc> cmr: oh, nope, I guess I've been using build systems that provide that for me
[18:52:34] <kmc> thanks!
[18:52:45] <cmr> kmc: nah, it hasn't been a requirement until the past few days
[18:53:01] <kmc> oh :)
[18:53:07] *** Parts: Waka_Flocka_Flame (Waka_Flock@moz-AF1E4A33.clients.kiwiirc.com) ()
[18:53:33] <Blub\w> nmatsakis: what does readelf show about librustrt, and about the object file before linking it?
[18:53:45] *** Quits: tjc (tjc@moz-3685EAD3.hsd1.ca.comcast.net) (Ping timeout)
[18:53:56] <Blub\w> (dynamic section, and dlsym in the symbol table)
[18:54:01] <Luqman> nmatsakis: we pass "-dl -rt" on linux at least since rustrt needs it according to rustc::back::link
[18:54:36] <sully> hm
[18:54:47] <Blub\w> but rustrt should pull -ldl automatically though - unless you're linking statically?
[18:55:15] <Luqman>     // On linux librt and libdl are an indirect dependencies via rustrt,
[18:55:16] <Luqman>     // and binutils 2.22+ won't add them automatically
[18:55:31] <Luqman> is what the comment above it has
[18:55:51] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[18:57:26] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[18:57:32] <sully> I want to collect the names of all type definitions and constructor names in rustc
[18:57:39] <sully> does anybody know the best way to do this?
[18:57:53] <cmr> sully: look trhough the values in the def_map maybe?
[18:57:57] <Blub\w> oh
[18:58:11] <nmatsakis> Luqman: I know, and they apear in the command line, but seemingly in the wrong position
[18:58:14] *** Parts: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) ()
[18:58:34] *** Joins: tjc (tjc@moz-7538DF93.lightspeed.sntcca.sbcglobal.net)
[18:58:35] *** ChanServ sets mode: +o tjc
[18:58:40] <nmatsakis> cmr: ah, maybe that's where the problem is arising from, though! I do have --enable-debug
[18:58:40] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:58:50] <sully> hm, how hard would it be... to use libsyntax to do this, making a separate tool?
[18:58:55] <nmatsakis> cmr: oh, never mind, I got confused.
[18:59:37] *** Quits: Blub\w (wry@moz-3BB2D1B4.vps.tuwien.ac.at) (Ping timeout)
[18:59:38] <sully> oh, wait, this tool already exists
[18:59:40] <sully> we have a lint mode
[18:59:51] <nmatsakis> sully: probably not *too* hard? the original version of auto_serialize, way back when, was a separate tool I cobbled together like that and I remember it being fairly straightforward
[18:59:52] <cmr> sully: maybe not too hard? use visit_item?
[19:00:01] * sully nod
[19:00:01] <nmatsakis> true, we do have a lint mode
[19:00:08] <sully> in any case, the right thing to do is to run the lint mode
[19:00:13] <sully> then scrape its output
[19:00:19] <cmr> what lint mode?
[19:00:26] <sully> and write a script that generates a sed command
[19:00:27] <sully> or something
[19:00:31] * sully -> yakshave
[19:00:45] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:02:42] <sully> argh, more unused variable warnings in the compiler!
[19:03:26] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:03:40] <jdm> #[allow_unused]
[19:03:46] *** Quits: KindOne (KindOne@C8A688FC.EF25844A.D6529392.IP) (Ping timeout)
[19:04:01] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[19:05:10] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[19:05:45] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[19:06:00] *** Joins: bstrie|mibbit (Mibbit@moz-D5A1D0F5.members.linode.com)
[19:06:49] <bstrie|mibbit> so I have a "mut_iter" iterator, and inside this iterator I want to send the iteratee to a helper function
[19:07:07] <bstrie|mibbit> I don't mutate the iteratee in the helper function
[19:07:25] <bstrie|mibbit> if I try to pass it as immutable, I get "cannot borrow `*rooms` as immutable because it is also borrowed as mutable"
[19:07:31] *** Joins: Blub\w (wry@moz-81ABD137.dip0.t-ipconnect.de)
[19:07:40] <bstrie|mibbit> and if I try to pass it as mutable, I get "cannot borrow `*rooms` as mutable more than once at a time"
[19:07:57] <bstrie|mibbit> so basically I'm wondering if the error message shouldn't just be "cannot borrow rooms at all, dummy"
[19:08:15] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:08:27] *** Joins: KindOne (KindOne@moz-618B1BE1.dynamic.ip.windstream.net)
[19:08:34] <bstrie|mibbit> rust-buildbot: dance
[19:08:35] <rust-buildbot> <(^.^<)
[19:08:36] <rust-buildbot> <(^.^)>
[19:08:38] <engla> yes, the mut_iter has a &mut  reference to the collection so yuo can't borrow at all
[19:08:39] <rust-buildbot> (>^.^)>
[19:08:39] <rust-buildbot> (7^.^)7
[19:08:41] <rust-buildbot> (>^.^<)
[19:09:11] <bstrie|mibbit> engla: so am I forced to manually inline the helper function?
[19:09:43] <engla> I don't think that helps, you can only access the iterator, not the collection
[19:09:48] <engla> as long as the mut_iter is alive
[19:09:55] <bstrie|mibbit> hm, I get it now
[19:10:02] *** Quits: Blub\w (wry@moz-81ABD137.dip0.t-ipconnect.de) (Connection reset by peer)
[19:10:09] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[19:10:18] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[19:10:48] <bstrie|mibbit> also I figured out how to increase my swap size on my vps, so let's see if rust can actually compile there for the first time in 18 months :)
[19:11:29] *** Joins: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[19:11:33] *** Quits: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Ping timeout)
[19:13:14] <engla> bstrie|mibbit: in some cases, it's almost as if you need a zipper instead of an iterator, to be able to mutate and iterate interleaved
[19:13:46] *** Joins: Blub\w (wry@moz-F0060145.vps.tuwien.ac.at)
[19:14:30] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Quit: ecr)
[19:15:04] *** Quits: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP) (Quit: lkuper)
[19:16:25] *** Quits: Blub\w (wry@moz-F0060145.vps.tuwien.ac.at) (Ping timeout)
[19:18:14] <bstrie|mibbit> if I have an array of structs and I want to update every field in one of the structs, is `foo[i] = Bar {x: 1, y: 2};` inefficient? or would it be better to do `foo[i].x = 1;` etc manually
[19:18:29] <bstrie|mibbit> maybe llvm is smart enough that it doesn't matter
[19:19:10] <bstrie|mibbit> in the former I'm worried about temporary objects, in the latter I'm worried about unnecessary bounds checks
[19:19:24] *** Quits: tcr (tcr@moz-78FFB457.hfc.comcastbusiness.net) (Client exited)
[19:19:44] <nmatsakis> bstrie|mibbit: you can always do "let mut f = &mut foo[i]; f.x = 1;"
[19:20:14] <nmatsakis> bstrie|mibbit: you will currently get a temp with the former, though LLVM may optimize it away, still I suspect unless this is a VERY tight inner loop you won't see much difference in the end. I'd go with the former (less room for error)
[19:20:56] <engla> can bounds checks be optimized away when they are redundant?
[19:21:10] <cmr> engla: what's a redundant bounds check?
[19:21:33] <tjc> cmr: redundant means the compiler can prove the check will always succeed
[19:21:37] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[19:21:48] <tjc> engla: LLVM does some of that, rustc doesn't do any of it on its own AFAIK
[19:21:53] <engla> what tjc said, that I couldn't express
[19:22:02] <engla> right
[19:22:02] <sanxiyn> tjc: LLVM does?
[19:22:17] <tjc> sanxiyn: eliminating bounds checks? I think so. I'm not familiar with the details.
[19:22:24] <sanxiyn> tjc: I thought LLVM does no value range analysis and that's one of their deficiency compared to GCC
[19:22:30] <tjc> sanxiyn: Oh, maybe
[19:22:39] <tjc> I assumed it would be a pretty obvious thing to do
[19:22:46] <sanxiyn> GCC certainly does, LLVM certainly doesn't last time I checked
[19:22:47] <tjc> but it sounds like you've looked into it more than I have
[19:23:01] <steven_is_false> Currently sum on iterators is implemented as fn sum(&mut self) -> A { self.fold(Zero::zero::<A>(), |s, x| s + x) }. Doesn't this make it impossible for the compiler to optimize it for floating point ops?
[19:23:09] *** Quits: redline6561 (redline656@moz-714529BD.members.linode.com) (Quit: ZNC - http://znc.in)
[19:23:37] <steven_is_false> Isn't (x + y) + (z + w) is faster than x + (y + (z + w)) right?
[19:23:38] <bstrie|mibbit> nmatsakis: ok, thanks
[19:23:55] *** Quits: KindOne (KindOne@moz-618B1BE1.dynamic.ip.windstream.net) (Ping timeout)
[19:23:59] <saati> steven_is_false: why would it be
[19:24:22] <steven_is_false> saati: There's a dependency in x + (y + (z + w)) unlike the other one.
[19:24:23] <engla> it could be faster, because of instruction parallelism. Floating-point accuracy is what comes to mind first though
[19:24:55] <steven_is_false> engla: It's less accurate?
[19:25:15] <engla> the method used in .sum() is not ideal
[19:25:23] <saati> but it's sorta commutative and associative
[19:25:49] <engla> saati: hardware floats are not associative
[19:25:54] <saati> that's why sorta
[19:27:30] <bstrie|mibbit> aaagh, haha I got ICE'd
[19:27:53] <bstrie|mibbit> "internal compiler error: trans_lvalue reached fall-through case"
[19:28:06] <steven_is_false> Maybe we shouldn't have sum be optimized like that but have a reduce method which will let one implement a faster sum method for floats.
[19:28:19] <bstrie|mibbit> we need to have a bot in here that posts a random Mr. Freeze quote every time it sees the string "ICE"
[19:28:23] *** Joins: KindOne (KindOne@moz-44F8C6C8.dynamic.ip.windstream.net)
[19:29:01] <cmr> bstrie|mibbit: and we have a volunteer!
[19:29:16] <steven_is_false> It'd be like f(f(x, y), f(z, w)) instead of like f(x, f(y, f(z, w))).
[19:29:48] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[19:29:52] *** Joins: ozten (ozten@19BD73A1.5D8BCA3A.A0C1B52F.IP)
[19:30:09] *** Joins: sigma (sigma@2AE71BC1.DC5B0862.37339E3A.IP)
[19:30:10] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[19:30:20] <engla> steven_is_false: so a divide-and-conquer algorithm
[19:30:42] <bstrie|mibbit> sigh, more swap did not suffice to let rust compile on my vps
[19:30:55] <engla> swap can't buy happiness
[19:30:59] <bstrie|mibbit> I guess it all has to fit in ram at once?
[19:31:02] <bstrie|mibbit> and I only have 1gb
[19:31:05] <kimundi> bstrie|mibbit: Only one solution: Add more swap
[19:31:11] <steven_is_false> engla: Yes.
[19:31:18] <bstrie|mibbit> kimundi: I have 1gb ram and 1gb swap! no way it was using more than that
[19:31:27] <engla> haha, it needs more
[19:31:36] <bstrie|mibbit> you really think that will help?
[19:31:40] <bstrie|mibbit> I'm willing to try
[19:31:50] <engla> I don't think swap will "help".
[19:32:00] <engla> but if you give it 4GB room it should be fine
[19:32:02] <kimundi> At most it will 'work'
[19:32:04] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[19:32:07] <bstrie|mibbit> by "help" all I care about it "actually compiling at all"
[19:32:11] <bstrie|mibbit> I don't care if it takes a day
[19:32:26] <bstrie|mibbit> as far as I'm concerned this compile's been ongoing since it first failed last february
[19:32:33] <kimundi> xD
[19:32:39] <engla> then give it more swap
[19:32:39] <bstrie|mibbit> we used to not use so much memory!
[19:32:43] <bstrie|mibbit> will do
[19:32:45] <bstrie|mibbit> 4gb swap
[19:33:06] <cmr> there might be a sysctl thing you need to set
[19:33:13] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[19:33:18] <kimundi> Don't forget to add some magic dust!
[19:33:35] *** Quits: sanxiyn (tinuviel@33605CA4.9F929CFD.F9E1BAE1.IP) (Quit: Leaving)
[19:33:41] <bstrie|mibbit> cmr: don't speak in riddles, I have no idea what a sysctl thing is
[19:33:41] *** Quits: KindOne (KindOne@moz-44F8C6C8.dynamic.ip.windstream.net) (Ping timeout)
[19:33:56] *** sam113101 is now known as sam113101_afk
[19:34:01] <cmr> sudo sysctl vm.overcommit_memory=1
[19:34:43] <engla> cmr: overcommit_memory= 0  already does overcommit
[19:35:02] *** Quits: devinus (devinus@moz-3C0F65B9.sw.biz.rr.com) (Ping timeout)
[19:35:02] <cmr> engla: yes but you need to think about the overcommit ratio and that's just pain
[19:35:07] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Client exited)
[19:35:18] <engla> aha
[19:35:18] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[19:35:26] * bstrie|mibbit types derstood incantations into his terminal
[19:35:37] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[19:35:38] <bstrie|mibbit> (derstood is the state of not understanding something)
[19:35:43] <sp3d> amazing
[19:35:45] <cmr> =1 will never fail an allocation
[19:35:58] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[19:36:15] <bstrie|mibbit> by jove I think it's working
[19:36:23] <brendanc> with 4GB of swap shouldn't need much overcommit :)
[19:36:30] <cmr> bstrie|mibbit: you should set that back to 0 when you're done :p
[19:37:24] <bstrie|mibbit> roger
[19:38:14] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[19:38:31] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Quit: Ignore me!!)
[19:38:36] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:38:37] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[19:38:54] *** sam113101_afk is now known as sam113101
[19:38:57] <bstrie|mibbit> should I have done a "sysctl -p" before this attempt
[19:39:18] <cmr> nah
[19:39:42] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:39:57] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[19:42:04] <bstrie|mibbit> graydon: here's a blog post from walter bright on how malloc'ing without freeing in dmd doubled the compiler speed http://www.drdobbs.com/cpp/increasing-compiler-speed-by-over-75/240158941
[19:42:15] <bstrie|mibbit> graydon: thought it sounded similar to nmatsakis' arena idea
[19:42:52] <cmr> Well of course never freeing your memory speeds it up :P
[19:42:59] <cmr> I mean, that's basically what we do with the ast
[19:43:03] <cmr> ;p
[19:43:45] <bstrie|mibbit> cmr: I was under the impression that this sort of thing was planned, but not implemented
[19:44:00] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[19:44:04] *** Joins: bheylin (brianheyli@moz-8255E94E.adsl.online.nl)
[19:44:05] <cmr> bstrie|mibbit: it was a poke at never collecting cycles
[19:44:37] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[19:45:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:46:11] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:46:22] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[19:46:49] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:46:53] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Connection reset by peer)
[19:47:10] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[19:47:23] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:50:03] *** Joins: KindOne (KindOne@moz-112B4553.dynamic.ip.windstream.net)
[19:52:35] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[19:54:43] <sully> graydon: ping
[19:55:22] <Luqman> cmr: thanks for reminding me. I meant to get rid of the duplication but it was kind of late :P
[19:55:36] <cmr> Luqman: :D
[19:58:25] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[19:59:39] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:59:48] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:00:06] *** Joins: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP)
[20:00:07] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[20:00:21] *** Quits: tjc (tjc@moz-7538DF93.lightspeed.sntcca.sbcglobal.net) (Quit: Places to go, people to annoy)
[20:00:46] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:03:49] *** Joins: seth (seth@moz-D840E602.dsl.static.sonic.net)
[20:05:10] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[20:06:05] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[20:06:32] <eatkinson> rusti: trait MyTrait { fn create() -> Self; } struct MyStruct { x : int } impl MyTrait for MyStruct { fn create() -> MyStruct { MyStruct { x: 1 } } }
[20:07:41] <cmr> "Since compilers are short-lived programs, and speed is of the essence, DMD just mallocs away, and never frees."
[20:07:48] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:07:53] <cmr> You know, that woudln't be a bad idea if our memory perf was reasonable.
[20:10:25] <steven_is_false> cmr: Isn't that basically an arena?
[20:10:44] <steven_is_false> I guess the advantage is that it'd require less refactoring of code.
[20:10:53] <cmr> (it also uses a bump allocator, apparently)
[20:11:32] <cmr> We have a lot bigger correctness and codegen issues to fix before optimizing silly things such as allocator and hash table lookup though
[20:11:33] <bstrie|mibbit> steven_is_false: it's basically a whole-program arena, afaict
[20:11:46] <bstrie|mibbit> also I think they only do it like that for -O0 builds
[20:11:54] <engla> the OS owns the arena and does the cleanup
[20:11:55] <bstrie|mibbit> otherwise they'd probably explode the box
[20:12:24] <bstrie|mibbit> in the hn thread walter mentions how they really don't care about the speed of optimized builds
[20:13:54] <bstrie|mibbit> I really should have put this compile job in a tmux pane, because it actually might take a day
[20:14:30] <bstrie|mibbit> (speaking of compiler speed)
[20:15:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:15:55] <steven_is_false> Is there a binding to sleep in the standard libraries?
[20:16:21] <engla> bstrie|mibbit: so you think it will work this time with more swap?
[20:16:45] <bstrie|mibbit> engla: hahaha, you jinxed it!
[20:16:51] <bstrie|mibbit> engla: it crashed just as I was typing this
[20:17:03] <engla> cool
[20:17:06] *** Quits: victorporof (victorporo@AF497F7E.60E0D239.9B1E38F4.IP) (Quit: victorporof)
[20:17:14] <bstrie|mibbit> maybe I really should try some more swap
[20:17:16] <engla> what happened?
[20:17:49] <bstrie|mibbit> it compiled everything up to stage0 rustc without incident
[20:18:01] <bstrie|mibbit> then on rustc it spat out some warnings and then hung for a long time
[20:18:04] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:18:10] <bstrie|mibbit> then
[20:18:20] <bstrie|mibbit> Killed
[20:18:22] <bstrie|mibbit> make: *** [x86_64-unknown-linux-gnu/stage0/lib/rustc/x86_64-unknown-linux-gnu/lib/librustc.so] Error 137
[20:19:26] <bstrie|mibbit> let's give this thing a ludicrous amount of swap, and also compile as root just for the hell of it
[20:19:42] <bstrie|mibbit> brb
[20:19:50] *** Quits: bstrie|mibbit (Mibbit@moz-D5A1D0F5.members.linode.com) (Quit: http://www.mibbit.com ajax IRC Client)
[20:21:17] <slaren> has letting traits contain types been considered ?
[20:21:26] <sully> what do you mean by that?
[20:21:31] <slaren> (I can't see any open issue about it)
[20:21:41] *** Quits: timm (timm@moz-37B954AF.superkabel.de) (Ping timeout)
[20:21:52] <engla> slaren: search for associated items
[20:22:09] *** bnicholson is now known as bnicholson|lunch
[20:22:16] <engla> https://github.com/mozilla/rust/issues/5033
[20:22:21] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[20:22:42] <slaren> engla: that's what I was looking for, thanks
[20:24:51] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[20:26:07] *** bent is now known as bent|brb
[20:26:54] *** Joins: timm (timm@moz-37B954AF.superkabel.de)
[20:27:36] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[20:27:48] *** Joins: bstrie|mibbit (Mibbit@moz-D5A1D0F5.members.linode.com)
[20:28:27] <bblum> slaren: if i am not mistaken that is basically the ML module system, right? short of functors, that is.
[20:31:13] <slaren> bblum: I am not sure, my background is C++, where it is common to have types inside templates
[20:31:15] <kmc> traits and typeclasses aren't that similar to ML modules
[20:31:21] <kmc> they have overlapping use cases
[20:31:24] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[20:31:54] *** Joins: dherman (dherman@33605CA4.9F929CFD.F9E1BAE1.IP)
[20:31:54] *** ChanServ sets mode: +o dherman
[20:32:17] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[20:33:36] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Quit: ZNC - http://znc.sourceforge.net)
[20:33:57] *** bnicholson|lunch is now known as bnicholson
[20:34:09] <graydon> proposal: I spend the next few days upgrading buildbot since everyone's either on vacation or at oscon
[20:34:26] <eholk> Luqman: thanks for giving me access to rust-opencl
[20:34:28] <graydon> immediate fallout: I might take buildbot offline for a while entirely, and/or break a bunch of stuff. queue will back up further.
[20:34:30] <bstrie|mibbit> the day the bots stood still
[20:34:35] <bblum> graydon: works for me, despite not being on vacation
[20:34:39] <graydon> long term results: things work better, we're several years behind
[20:34:42] *** Joins: btipling (btipling@moz-D51E0AEB.xen.prgmr.com)
[20:34:50] <bblum> "several years behind"?
[20:34:52] <graydon> we keep leaning on buildbot things that have been "fixed upstream"
[20:34:53] <graydon> yeah
[20:34:59] <bstrie|mibbit> graydon: you'll probably never have a better time than now
[20:35:13] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[20:35:19] <bstrie|mibbit> except for maybe christmas or something
[20:35:36] <kimundi> graydon: The amount of grieve the current buildbots have caused justify any amount of upgrade shortage I think ;)
[20:35:47] <graydon> buildbot 0.8.5 is from sept 2010
[20:35:54] <graydon> ok
[20:35:56] <bstrie|mibbit> does upgrading buildbot actually solve any of that grief? I thought our grief beef was with github's api
[20:36:09] <graydon> no, buildbot does a lot of funny stuff too
[20:36:21] <kimundi> bstrie|mibbit: You just have to hope! :P
[20:36:45] <graydon> its EC2 API, database layer, presentation layer, git polling system and subprocess management have all improved in the meantime. we've been backporting stuff.
[20:36:47] *** Quits: dherman (dherman@33605CA4.9F929CFD.F9E1BAE1.IP) (Quit: dherman)
[20:37:00] <graydon> brendanc: ping
[20:38:58] <bblum> graydon, btw, do you have any idea why we can't make check-stage0-std? we used to be able to do it last summer, and it is a huge pain to have to build stage1 rustc before making check-stage1-std.
[20:39:10] <graydon> no, I'm not sure why not
[20:39:15] <graydon> probably a bug in the makefiles
[20:39:19] <eatkinson> rusti: struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct; } }
[20:39:22] -rusti- <anon>:7:45: 7:79 error: not all control paths return a value
[20:39:22] -rusti- <anon>:7          struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct; } }
[20:39:22] -rusti-                                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[20:39:22] -rusti- error: aborting due to previous error
[20:39:23] -rusti- application terminated with error code 101
[20:39:32] <graydon> stage0 is done differently from the later stages since it unpacks its previous stage from snapshot
[20:39:48] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Ping timeout)
[20:40:14] <kimundi> eatkinson: remove the semicolon in new or add a return in front
[20:40:25] <eatkinson> rusti: struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct } }
[20:40:27] -rusti- ()
[20:40:27] <engla> didn't you add a libextra dependency on the std tests (for the bench tests)?
[20:40:54] <eatkinson> rusti: trait MyTrait{} struct MyStruct; impl<T:MyTrait> MyStruct { fn new() -> MyStruct { MyStruct } }
[20:40:55] -rusti- ()
[20:41:15] *** Joins: lkuper (lkuper@B422129.A402E718.C082B7DC.IP)
[20:41:37] <eatkinson> rusti: struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct } } let x = MyStruct::new();
[20:41:38] -rusti- <anon>:7:89: 7:102 error: cannot determine a type for this expression: unconstrained type
[20:41:38] -rusti- <anon>:7          struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct } } let x = MyStruct::new();
[20:41:38] -rusti-                                                                                                   ^~~~~~~~~~~~~
[20:41:38] -rusti- error: aborting due to previous error
[20:41:39] -rusti- application terminated with error code 101
[20:42:05] <eatkinson> anyone know what this error means?
[20:42:45] <engla> eatkinson: yeah, the T type parameter couldn't be inferred
[20:43:10] <bblum> that's an odd error because the T is a phantom type in the *impl*, not in a function or type
[20:43:17] <bblum> and we don't really have syntax for annotating that
[20:43:38] <eatkinson> engla: is there any way to tell it what type to use?
[20:43:52] <engla> eatkinson: yes,  let x = MyStruct::new::<int>();
[20:44:06] <bblum> graydon: all it says is "can't find crate for extra" and points to std.rs:1.
[20:44:15] <eatkinson> rusti: struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct } } let x = MyStruct::new::<int>();
[20:44:16] -rusti- <anon>:7:85: 7:86 warning: unused variable: `x` [-W unused-variable (default)]
[20:44:16] -rusti- <anon>:7          struct MyStruct; impl<T> MyStruct { fn new() -> MyStruct { MyStruct } } let x = MyStruct::new::<int>();
[20:44:16] -rusti-                                                                                               ^
[20:44:16] -rusti- ()
[20:44:27] <bblum> graydon: i really wish we could make check-stage0-std :(
[20:44:35] <eatkinson> engla: thanks
[20:44:42] <bblum> and would fix it if i knew what to do
[20:44:59] <graydon> bblum: oh. I landed a change that requires libextra for testing libstd
[20:45:25] <graydon> bblum: probably you need to add a dependency on libextra to the stage0 test rule
[20:45:40] <engla> recursive dependencies in paradise
[20:45:41] <sully> graydon: hey, so, I am planning to land a patch that changes everything to camel case
[20:45:46] <graydon> (you can also just issue the compile commands yourself in the meantime)
[20:45:47] <sully> graydon: is there any objection to this?
[20:45:51] <graydon> sully: "everything"?
[20:45:54] <toddaaro> ?
[20:46:05] <sully> all of the types, variants, and traits
[20:46:06] <sully> in rustc
[20:46:08] <bblum> graydon: to... do what, to build stage1 libextra or something?
[20:46:19] <graydon> bblum: stage0 target libextra
[20:46:27] <graydon> if there isn't one of those, I don't know what it's complaining about
[20:46:31] <bblum> what does target mean?
[20:46:31] <graydon> er, if there _is_ one of those
[20:46:45] *** Quits: dreamer__ (dreamer_@90E8C08F.8480A87C.DDAA0084.IP) (Connection reset by peer)
[20:46:47] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[20:46:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/gkUq8Q
[20:46:47] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[20:46:54] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:47:05] <graydon> we compile on a build machine, for a compiler hosted on a host machine, that emits code for a target machine
[20:47:14] <graydon> build, host, target are terms in cross compilers
[20:47:26] <graydon> they also correspond to directories in the workspace you're in
[20:47:33] <graydon> and rules in the makefile
[20:47:59] <graydon> when you see:
[20:48:01] <graydon> x86_64-unknown-linux-gnu/stage0/lib/rustc/x86_64-unknown-linux-gnu/lib/libextra.so
[20:48:16] <graydon> that's <host>/stage0/lib/rustc/<target>/lib/libextra.so
[20:48:38] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[20:49:45] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:49:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/i5wKFw
[20:49:45] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:49:46] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:49:46] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/JVFRqw
[20:49:46] <ghrust> 13rust/06auto 14ce1db94 15Daniel Micay: rm unused upcall_exchange_free
[20:49:46] <ghrust> 13rust/06auto 144517e39 15Daniel Micay: rm default method lint...
[20:49:46] <ghrust> 13rust/06auto 14ba41755 15Daniel Micay: improve container/iterator tutorial
[20:49:48] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:50:00] <bblum> graydon: i see
[20:50:27] <bblum> so, um, what sequence of commands should there be to build a stage0 stdtest?
[20:50:33] <sully> graydon: so, is there any reason to not do this?
[20:50:37] <bblum> or what files should exist?
[20:50:54] <sully> graydon: the other question I have about it, is that there are some types with names like MemoryBuffer_opaque
[20:51:15] <sully> graydon: where it is clear that it is mostly in the new style, and has the "_opaque" on there deliberatly to draw attention to it
[20:51:17] <graydon> sully: I don't think so. it'll bitrot a _ton_ of stuff though
[20:51:49] <sully> yeah, landing it /is/ likely to be painful
[20:52:07] <bstrie|mibbit> I get the feeling that linode is not going to be happy with me compiling rust on this vps
[20:52:12] <graydon> bblum: VERBOSE=1 make stage1-stdtest or whatever then change the commands from stage1 to stage0
[20:52:35] <graydon> sully: I'm particularly concerned that the hygiene patch is bitrotted to the point of not being able to land anymore :(
[20:52:38] <graydon> (already)
[20:52:45] <sully> ok
[20:52:55] <graydon> but john doesn't seem to be pushing on it
[20:52:57] <sully> well, I have the machinery to do this in place
[20:52:59] <olsonjeffery> bstrie|mibbit: to be fair, i run a node bot that leaks like a sieve and they've never given me any trouble
[20:53:05] <sully> and could apply it at any point
[20:53:07] <bblum> graydon: hm ok
[20:53:08] <graydon> sully: oh?
[20:53:14] <nmatsakis> sully: I was just going to sak, is it just a matter of rerunning the script?
[20:53:19] <sully> yeah, I wrote a script to do it
[20:53:26] <sully> we have a lint mode that detects them
[20:53:26] <nmatsakis> acrichto: ping
[20:53:38] <acrichto> nmatsakis: pong
[20:53:42] <sully> I slightly modified the lint mode to make it easier to extract the information I need to drive the script
[20:53:52] <nmatsakis> acrichto: so I am told you are the man to talk to about smallest-hello-world.rs
[20:53:52] <bstrie|mibbit> olsonjeffery: a node.js server on a linode? so many nodes. so beautiful.
[20:54:07] <acrichto> nmatsakis: I added it at least :)
[20:54:07] <strcat> bstrie|mibbit: why are you compiling it on linode? ;p
[20:54:09] <olsonjeffery> and it occasional thrashes on disk io and cpu
[20:54:27] <nmatsakis> acrichto: I am encountering a link failure running it on my branch, and I am ... somewhat baffled. Would you mind pulling my branch and inspecting it yourself?
[20:54:37] <sully> (the backstory on this is that I added a new type, and niko mentioned that he would prefer that new types use the new style, and so I was planning to change /all/ of the types in that module so it wouldn't be out of place, and then I wrote a script and figured I might as well fix the whole thing)
[20:54:38] <bstrie|mibbit> strcat: because I'm too lazy to figure out how to compile rust for debian on a linux mint box :)
[20:54:39] <nmatsakis> acrichto: the short version is that I get failures due to not having dlsym and so forth,
[20:54:44] <olsonjeffery> which i get automated threshold emails about
[20:54:51] *** Quits: lkuper (lkuper@B422129.A402E718.C082B7DC.IP) (Ping timeout)
[20:54:53] <nmatsakis> acrichto: it works if I run with -Z printlink-args and manually add -ldl and -lrt to the end of the command line
[20:55:10] <bstrie|mibbit> strcat: if you haven't been following along, now I've increased swap to 4gb in an attempt to actually compile
[20:55:13] <acrichto> nmatsakis: I could do it later tonight, sadly not right now. That's weird though... I have a feeling that this is something where the order of the '-l' arguments might matter?
[20:55:24] <acrichto> nmatsakis: if it's blocking anything remotely important feel free to xfail it and I'll investigate later
[20:55:35] <nmatsakis> acrichto: perhaps, for some reason we indiscrimanantly tack on a -lrustrt at the end
[20:56:00] <nmatsakis> acrichto: and I suspect the problem is that *this* is the source of those dependencies, and it comes at the end. anyway, ok, I'll xfail with a fixme
[20:56:15] <nmatsakis> acrichto: the change in question removes the FFI wrappers which SHOULD mean that you get closer to your goal of a runtime-less rust, incidentally
[20:56:33] <Luqman> nmatsakis: it does seem like we add rustrt at the end in back::link
[20:56:47] <nmatsakis> Luqman: what confuses me is why this works everywhere else
[20:56:58] <nmatsakis> Luqman: my theory is somewhat inconsistent
[20:57:19] <acrichto> nmatsakis: yeah I was running into that at some point, I think the best thing for now is to xfail it and I'll investigate when I get a chance
[20:57:31] <strcat> nmatsakis: it should have all the link parameters after the object
[20:57:34] <acrichto> nmatsakis: the ffi changes are far more important :)
[20:57:40] <strcat> foo.o -lbar -lbaz
[20:57:52] <strcat> if they're before it won't necessarily work
[20:57:55] <acrichto> although currently it should always have -lrustrt at the end except for rpath things and manually specified linker args
[20:58:24] <nmatsakis> yes, it does.
[20:58:32] <Luqman> nmatsakis: which platform is it failing on for you?
[20:58:38] <nmatsakis> Luqman: this is on linux
[20:59:11] <sebcrozet> Luqman: Thanks for giving me access to rust-opencl too.
[20:59:35] <sully> argh, snapshot failed a test
[20:59:53] <Luqman> sebcrozet: no problem, you've done more work on it than i have as of late
[20:59:57] <sully> command timed out: 3600 seconds without output, attempting to kill
[21:00:07] <sully> what should I do about that? just push again?
[21:00:26] <strcat> sully: force the build again in the buildbot UI
[21:00:33] *** Joins: Archer (Archer@moz-D28C17E1.bb.online.no)
[21:00:49] <sfackler> sully: any idea what's up with this segfault wrt default impls? https://github.com/mozilla/rust/pull/8036
[21:01:04] <sully> strcat: I need credentials, though?
[21:01:10] <strcat> sully: rust/rust ;p
[21:01:12] *** Quits: bstrie|mibbit (Mibbit@moz-D5A1D0F5.members.linode.com) (Quit: http://www.mibbit.com ajax IRC Client)
[21:01:17] *** Quits: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net) (Ping timeout)
[21:01:31] <sully> and how much of the stuff needs to be filled out to work?
[21:01:36] <strcat> sully: just branch
[21:01:39] <strcat> ignore the others
[21:01:39] *** Joins: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net)
[21:01:44] <strcat> make sure to build it on the right bot ofc :)
[21:02:01] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[21:02:36] <sully> sfackler: well, that is interesting.
[21:03:17] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[21:03:54] <sully> I mean, I feel like it should matter that there hasn't been a snap?
[21:04:08] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:04:15] <sully> hm, what is the easiest way for me to pull your change locally so I can test with it?
[21:04:32] <sfackler> there's some ref for pull requests iirc
[21:05:08] <sfackler> this maybe? https://gist.github.com/piscisaureus/3342247
[21:05:52] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[21:06:02] *** Quits: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP) (Quit: brendan)
[21:07:36] <graydon> sully: you're aware that brian has a snapshot-registering change in the queue already, yes?
[21:07:41] <graydon> for a snapshot that seems pretty recent
[21:08:13] <sully> hm, how recent?
[21:08:21] <sully> I have changes that landed overnight that I want to snapshot
[21:08:27] <graydon> https://github.com/brson/rust/commit/496363e05b34a8e6f26d2586b84c85728ed6957b
[21:08:35] <graydon> looks like not recent enough
[21:10:12] *** Joins: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP)
[21:11:07] <sully> ok, pulled your thing, sfackler, testing it out
[21:11:20] <toddaaro> I'm looking into chase-lev implementations, and I found an awesome PPOP paper from this year with full code with all the atomics for a C11 memory model implementation
[21:11:37] <toddaaro> does rust provide all of those atomic operations?
[21:11:43] <toddaaro> or is the rust memory model different?
[21:12:04] <toddaaro> if it is the same, I can probably just type this in and have it work which would be awesome
[21:12:35] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:13:26] <bblum> ok, toddaaro, when doing the task killed check, how did you get the task?
[21:13:35] <bblum> because sched doesn't have a current_task anymore right
[21:13:59] <toddaaro> correct, I think I checked tls? I'll have to wait until I'm at my desk to look at my current code
[21:15:10] <bblum> did you do unsafe borrow or safe borrow or what
[21:15:40] <toddaaro> don't remember, have to look at code
[21:16:57] *** Joins: reyre (reyre@CDB44924.8DBACF1E.47C41102.IP)
[21:17:24] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[21:17:49] <kmc> i have a question about methods on option:  map is to mutate as chain is to ?
[21:17:50] <kmc> does it exist
[21:18:07] *** Quits: bheylin (brianheyli@moz-8255E94E.adsl.online.nl) (Quit: bheylin)
[21:19:03] <rntz> what's the type of chain?
[21:19:16] <rntz> I'd suggest using hoogle
[21:19:20] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[21:19:45] <kmc> It's like a HOOGLE but for RUST!
[21:19:45] <bblum> toddaaro: why can't you look at your code from your laptop here
[21:19:56] <bblum> kmc: i think the equivalent does not exist
[21:20:07] <bblum> also mutate should probably return bool
[21:20:14] *** Joins: lkuper (lkuper@B422129.A402E718.C082B7DC.IP)
[21:20:24] <toddaaro> bblum: I have two VMs, as both platforms are majorly borked
[21:20:32] <toddaaro> so my work VM is inaccessible from my laptop
[21:20:38] <toddaaro> only usable on the external displays
[21:21:02] <engla> .chain should just be a composition of .map and join (join is Option<Option<T>> -> Option<T>)
[21:21:17] <engla> map is fmap and chain is >>=
[21:22:32] <rntz> hrm. and mutate?
[21:23:00] <bblum> mutate is fn(&mut Option<T>, fn(T) -> T)
[21:23:07] <rntz> oic
[21:23:08] <engla> mutate doesn't return anything so it doesn't need the two variants
[21:23:45] <rntz> ah, yeah, you'd want somethin of type fn(&mut Option<T>, &fn(T) -> Option<T>)
[21:23:51] <kmc> yes
[21:23:52] <rntz> presumably that is what was meant?
[21:23:56] <kmc> that's what I meant
[21:24:18] <bblum> does not exist
[21:24:20] <bblum> it could exist though
[21:24:24] <engla> hm ok
[21:24:24] <rntz> although there are two functions of that type
[21:24:28] <rntz> two reasonable functions of that type, rather
[21:24:37] <rntz> one does nothing if the callback returns None
[21:24:51] <rntz> the other mutatesthe first argument to be the result of the callback
[21:25:15] <rntz> probably best to just write the code explicitly; having too many of these little functions results in cognitive overload
[21:25:18] <aatch> toddaaro, Rust uses the underlying LLVM intrinsics as-is, which pretty much exactly maps to C++11 semantics
[21:25:32] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:25:35] <kmc> rntz: ah, true
[21:25:36] <toddaaro> aatch: ok, cool
[21:25:50] <aatch> toddaaro, and we now support most of the operations on actual atomic types (or will when the PR goes through)
[21:26:10] <engla> some consistency in the option module would reduce the overload
[21:26:26] <engla> I know the discussion is ongoing
[21:26:36] <cmr> Does LLVM guarantee atomicity of (say) u64 on hardware which does not natively support atomic operations on u64? Does that question make sense at all?
[21:26:40] <toddaaro> aatch: is there a thread_fence primitive? I didn't see one in the current atomics.rs file
[21:27:13] <aatch> toddaaro, as in a memory fence? I think that may be one we're missing.
[21:27:19] <strcat> cmr: atomics just turn into locks in cases like that
[21:27:28] <cmr> strcat, but does it do it?
[21:27:28] <toddaaro> aatch: yea, how hard is it to add these things?
[21:27:30] <strcat> they aren't necessarily any faster than a mutex (they might be one)
[21:27:37] <strcat> cmr: by using a lock
[21:27:38] <aatch> toddaaro, not too hard
[21:27:40] <cmr> ok
[21:27:45] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[21:27:50] <cmr> That is reasonable
[21:27:56] <bblum> um
[21:28:10] <strcat> cmr: if it supports the operation... it uses that
[21:28:12] <bblum> i don't know if LLVM supports u64 atomic ops on 32 bit platforms at all
[21:28:21] <bblum> it probably shouldn't
[21:29:15] <bblum> if it did i guess it would have to use a spinlock
[21:29:15] <strcat> bblum: I think it does
[21:30:02] <aatch> From reading the LLVM docs, it seems it depends on the underlying platform.
[21:30:08] <strcat> bblum: I think you can pretty much use arbitrarily sized integers on any platform, they'll just become awful code ;p
[21:30:18] <bblum> strcat: good grief :P
[21:30:28] <strcat> bblum: like, I think you could use i321
[21:30:32] <aatch> If an operation isn't supported the backend will throw an error.
[21:30:38] <bblum> strcat: i wonder how bad it is for the branch predictor
[21:30:43] *** Joins: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com)
[21:30:47] <strcat> aatch: but the backend knows how to map things to locks afaik
[21:30:51] <aatch> strcat, you might be thinking of the C++ semantics, where it will fall back to locks.
[21:31:26] <aatch> at any rate, Rust only uses word-sized things.
[21:31:51] <strcat> u64 on 32-bit arm, etc.
[21:31:54] *** Quits: acm (textual@34641662.FB4DE631.66C78B76.IP) (Quit: Textual IRC Client: www.textualapp.com)
[21:32:03] <strcat> I think an atomic store will still work fine in LLVM, it will just be slow
[21:32:22] <aatch> strcat, depends on the codegen backend.
[21:32:23] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[21:32:31] <aatch> But I don't think it falls back to locks.
[21:32:32] <sully> hm, is there a target for running the libstd tests on stage1?
[21:32:43] <bblum> sully: check-stage1-std
[21:33:43] *** Quits: Nefzaoui (chatzilla@D30EAED9.E7C31F37.80E43DAF.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[21:34:08] <aatch> I mean, I don't think there is anything stopping a backend from doing it, but locks seem too platform-specific for LLVM to deal with.
[21:34:42] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[21:34:56] <aatch> strcat, last line of this section: http://llvm.org/docs/Atomics.html#atomic-instructions
[21:35:28] <strcat> so I guess that's done by clang?
[21:35:42] <strcat> because those are the C++11 semantics
[21:36:05] <aatch> strcat, it is.
[21:36:34] <aatch> I'm guessing because it relies on the existence of C++11 threading stuff.
[21:36:41] *** Quits: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP) (Quit: brendan)
[21:37:02] <toddaaro> what is i321?
[21:37:19] *** Quits: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr) (Client exited)
[21:37:22] <aatch> toddaaro, a 321-bit signed integer, obviously :P
[21:37:31] <toddaaro> ok so that is as absurd as I thought
[21:39:33] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:40:24] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[21:43:33] <bblum> or a typo for i32 that trolls toddaaro 
[21:44:07] <toddaaro> given the context I think 321 bit integer was the intended use
[21:44:12] <bblum> really?
[21:44:20] <bblum> hmm
[21:44:21] *** Quits: reyre (reyre@CDB44924.8DBACF1E.47C41102.IP) (Client exited)
[21:44:29] <bblum> hmmm, maybe an untypo that trolls me
[21:44:30] <kmc> it would fit in http://software.intel.com/en-us/blogs/2013/avx-512-instructions
[21:44:46] <toddaaro> strcat strikes again
[21:45:06] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[21:45:12] *** Quits: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com) (Ping timeout)
[21:46:20] <cmr> heh
[21:46:22] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[21:50:02] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[21:51:34] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Connection reset by peer)
[21:52:21] <sully> sfackler: you were getting these failures on HEAD?
[21:52:21] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:52:29] <sully> sfackler: do you still get them?
[21:52:37] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[21:54:08] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[21:55:24] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[21:55:29] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[21:56:03] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[21:56:47] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[21:58:11] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[21:58:31] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[21:58:49] <tikue> hey all, what flag do I enable when compiling to get more information in borrow check failure error messages?
[21:58:55] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[21:59:02] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:59:14] *** Quits: igl (igl@moz-DFFD0851.adsl.alicedsl.de) (Ping timeout)
[21:59:22] *** Joins: igl (igl@moz-7CEFF82C.adsl.alicedsl.de)
[22:01:21] *** Quits: jchinlee (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:03:01] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Quit: leaving)
[22:03:42] <bblum> nmatsakis: ^ 
[22:03:48] <bblum> (tim's question above)
[22:03:57] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:05:42] <sully> sfackler: ok, so, I cherry-picked your branch onto HEAD, and make check passes fine
[22:08:19] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[22:10:47] <sully> hm, I might actually want to do it the eve central way, though
[22:10:54] <sully> because I'll just set a script running on my server
[22:11:05] <sully> that runs every so often and updates a static page, maybe?
[22:11:18] *** Joins: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP)
[22:11:24] <sully> er, wrong channel
[22:11:25] <sully> whoops
[22:11:26] <sully> sorry.
[22:11:58] *** Quits: Archer (Archer@moz-D28C17E1.bb.online.no) (Ping timeout)
[22:12:01] *** Joins: Archer (Archer@moz-95B9E238.bb.online.no)
[22:12:16] <sigma> sully: Eve market project?
[22:12:53] *** bent|brb is now known as bent
[22:12:54] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:13:43] *** Quits: Archer (Archer@moz-95B9E238.bb.online.no) (Ping timeout)
[22:14:20] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:14:26] *** Joins: Archer (Archer@moz-95B9E238.bb.online.no)
[22:16:01] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[22:16:20] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:17:12] <sfackler> sully: i'll try rebasing
[22:17:43] <cmr> I'm writing some C#, and I really miss Rust again :(
[22:18:05] <cmr> Mostly the syntax, the syntax is so pleasant.
[22:18:29] *** Joins: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:18:30] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:18:35] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[22:18:53] <geomyidae__> I'm afraid I don't understand Cell vs Option, even after reading https://mail.mozilla.org/pipermail/rust-dev/2013-April/003644.html
[22:19:04] *** Joins: Ubaion (Archer@moz-391D57CA.bb.online.no)
[22:19:28] <engla> geomyidae__: Cell allows you to mutate the content even if the Cell itself is not "mut"
[22:19:34] *** Quits: Archer (Archer@moz-95B9E238.bb.online.no) (Ping timeout)
[22:19:40] *** Joins: dherman (dherman@33605CA4.9F929CFD.F9E1BAE1.IP)
[22:19:40] *** ChanServ sets mode: +o dherman
[22:19:41] *** Joins: pcwalton (pcwalton@33605CA4.9F929CFD.F9E1BAE1.IP)
[22:19:41] *** ChanServ sets mode: +o pcwalton
[22:19:54] <engla> so it's a box for subverting the type system a tad
[22:20:14] *** Joins: bstrie (ben@moz-D5A1D0F5.members.linode.com)
[22:20:26] <bstrie> rust compiles on my vps
[22:20:33] <bstrie> infinite swap is infinite victory
[22:20:42] <kmc> engla: I don't think that's any more subversive than @mut
[22:20:46] <kmc> but people don't like @mut either ;)
[22:21:12] <pcwalton> dherman: cast::transmute::<&'static str,&[u8]>("L") == [12, 0]
[22:21:13] <engla> I think it is more subversive
[22:21:15] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[22:21:43] <engla> because @mut is visible in the type system
[22:22:05] <geomyidae__> that comment from pcwalton on the ml (https://mail.mozilla.org/pipermail/rust-dev/2013-April/003644.html) seems to indicate it was more of a workaround, or no?
[22:22:06] *** Quits: Ubaion (Archer@moz-391D57CA.bb.online.no) (Ping timeout)
[22:23:08] <kmc> engla: I guess so... are there special typing rules for @mut, or is it just special syntax
[22:23:20] *** Joins: Ubaion (Archer@moz-391D57CA.bb.online.no)
[22:23:58] *** Quits: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:24:34] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:24:34] *** Joins: gavinb (gavinb@73164866.7CE64DCC.C3991EA9.IP)
[22:24:46] <dherman> ahhhhhhhh
[22:24:48] <dherman> pcwalton: many thanks
[22:25:00] *** Quits: Ubaion (Archer@moz-391D57CA.bb.online.no) (Ping timeout)
[22:25:03] <erickt> bblum: you made me really excited by temporarily closing #5033 :(
[22:25:18] <bblum> erickt: haha.
[22:25:23] <bblum> i could close it again for you
[22:25:25] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[22:25:29] <erickt> I'm very much looking forward to that feature
[22:25:30] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[22:25:35] <bblum> yeah it looks pretty nice
[22:25:50] <erickt> bblum: I don't think my heart would survive another close/open cycle
[22:25:56] <bblum> erickt: is that so
[22:26:15] <erickt> although I'm probably exaggerating
[22:26:19] <bblum> how long does the wizard of os con last?
[22:26:39] <erickt> lol. I think it ends tomorrow
[22:27:44] <jld> Is Portland the Emerald City now?  I thought that was Seattle.
[22:28:03] <pcwalton> I'm excited for "for in" and "in Gc"
[22:28:05] <dherman> pcwalton: unresolved name `str`
[22:28:08] <engla> kmc: @mut and cell are similar for sure
[22:28:13] <dherman> what am I doing wrong..
[22:28:29] <pcwalton> wat
[22:28:58] <dherman> is &'static flaky?
[22:29:06] <pcwalton> no I don't think so
[22:29:08] <pcwalton> can I look?
[22:29:33] <pcwalton> dherman: it interpreted it as the "less than" operator
[22:29:47] <strcat> the end of the horrible .advance noise ;p
[22:30:01] <pcwalton> dherman: &[76u8, 0]
[22:30:12] <pcwalton> dherman: actually &[76, 0]
[22:30:14] <pcwalton> is even better
[22:30:20] <pcwalton> less noisy
[22:30:22] <dherman> sure
[22:30:31] *** Quits: gavinb (gavinb@73164866.7CE64DCC.C3991EA9.IP) (Ping timeout)
[22:31:08] <pcwalton> "for in" and "in Gc" will eliminate some of the punctuation heaviness
[22:31:15] <pcwalton> which I got two complaints about today on Twitter :)
[22:32:01] <bjz> I would be sad to see do go
[22:32:36] <bjz> :(
[22:32:43] <kimundi> me too
[22:32:45] <jensnockert> I really wish we had Ruby-like syntax for blocks, but I also understand why we do not.
[22:32:51] <engla> I guess syntax for do can be considered in context of the closure reform and the syntax for  do spawn { }
[22:32:54] <pcwalton> oh, I'm not advocating removing do!
[22:33:03] <pcwalton> I just mean "for in" and "in Gc"
[22:34:56] <bjz> pcwalton: was entioned in graydon's ML post
[22:35:01] <bjz> *mentioned
[22:35:12] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[22:35:13] <pcwalton> bjz: I'm personally probably in favor of keeping "do"
[22:35:17] <pcwalton> but of course we have to discuss
[22:35:35] <bjz> ofc
[22:36:25] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[22:36:32] *** Joins: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr)
[22:36:33] *** Quits: lkuper (lkuper@B422129.A402E718.C082B7DC.IP) (Quit: lkuper)
[22:36:50] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[22:37:06] <bjz> jensnockert: explain
[22:37:14] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:37:23] <jensnockert> bjz: Ruby block syntax?
[22:37:26] <bjz> mm
[22:37:27] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[22:37:35] <jensnockert> It's essentially an implicit do.
[22:38:07] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[22:38:30] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:38:30] *** Quits: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:38:30] <jensnockert> x.map { |i| i.to_s }.join(' ').each_byte { |c| puts c }
[22:38:40] <jensnockert> bjz: so you can chain it nice.
[22:38:47] <bjz> ahh
[22:38:52] <cmr> graydon, "As it's a little quiet this week"
[22:38:56] <cmr> graydon, "Bors queue: 44"
[22:39:02] <cmr> Something is not right here... :p
[22:39:02] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:39:13] <engla> jensnockert: looks like that one works fine if you replace {} with ()
[22:39:22] <graydon> cmr: it's been at 40 all week. 50 until strcat did another rollup.
[22:39:27] <graydon> (not that I'm pleased with this)
[22:39:32] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[22:39:42] <engla> (since all the lambdas are single expression)
[22:39:44] <graydon> we need to spend more energy on cycle time
[22:39:48] <cmr> right, it's just never really /quiet/, just... normal background hum
[22:39:57] <graydon> it's quieter than other times
[22:40:10] <jensnockert> engla: That's not necessarily true in Ruby though, I just didn't want to write more on IRC.
[22:40:32] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[22:40:40] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[22:41:03] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:41:15] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:41:31] <graydon> I don't understand why we seem to have regressed like ... 10-20% in compile time in the past 10 days?
[22:41:32] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Connection reset by peer)
[22:41:44] <graydon> (or else the numbers on isrustfastyet are just nonsense)
[22:42:19] <cmr> http://huonw.github.io/isrustfastyet/mem/ compile time is of unknown noise right now
[22:42:24] <brendanc> graydon: pong
[22:42:39] <cmr> I'm running it on my desktop because the old bencher was "borrowed"
[22:42:40] <graydon> brendanc: anything I should be worried about upgrading buildbot?
[22:42:53] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:42:58] <cmr> Memory is accurate, dunno about CPU time, it doesn't look righ to me
[22:43:26] <brendanc> graydon: not sure, I"m still on 0.8.5 :)
[22:43:30] <bblum> time: 48.403 s expansion
[22:43:32] <bblum> o_O
[22:43:35] <graydon> brendanc: wish me luck
[22:43:41] <brendanc> I imagine it depends on how much custom code you have. I didn't think you had much in your master.cfg
[22:43:47] <bblum> what is 'expansion'?
[22:43:50] <brendanc> good luck :)
[22:43:50] <bblum> macro expansion?
[22:43:54] <graydon> bblum: yes
[22:44:05] <graydon> if it's taking 48s, something's terribly wrong
[22:44:20] <bblum> well, this is a rustc built with CFG_DISABLE_OPTIMIZE
[22:44:23] <bblum> and it's building stdtest
[22:44:27] <bblum> maybe more macros in stdtest?
[22:44:51] <bblum> for comparison - parsing 37s, maybe building test harness 26s, resolution, 34s
[22:44:55] *** Quits: Vert (quassel@8A83479C.391ACC8C.CAF63861.IP) (Ping timeout)
[22:45:09] <graydon> those numbers are absurd
[22:45:13] <cmr> really absurd.
[22:45:20] <bblum> CFG_DISABLE_OPTIMIZE
[22:45:22] <cmr> unopt code is complete garbage.
[22:45:27] <bblum> yes
[22:45:35] <bblum> but i mean, is the proportion sensible?
[22:45:39] <bblum> should expansion ever take longer than parsing?
[22:45:48] <graydon> yeah, it tends to
[22:45:53] <graydon> (awful but true)
[22:45:58] <graydon> I do not know why, haven't looked into it
[22:46:04] <cmr> expansion is a bit less than parsing on irsy
[22:46:15] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[22:47:15] <pcwalton> please stop bashing the compiler
[22:47:18] * pcwalton grumpy
[22:47:22] <graydon> I'm sorry
[22:47:23] <pcwalton> unopt code is a lot better
[22:47:29] <pcwalton> than it used to be
[22:47:44] <graydon> but agreed, we should try to not use such dismissive terms
[22:47:55] <bblum> sorry patrick, just trying to get a sense for how long everything takes
[22:47:59] <cmr> pcwalton, it's still really bad though :(
[22:48:00] <graydon> for a young compiler it's still quite a thing. it's just generating a lot of code in a few places.
[22:48:00] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:48:04] <pcwalton> cmr: no it's not
[22:48:06] <pcwalton> it is not that bad
[22:48:21] <jld> It seems to be that, beyond a certain point, making unopt code "better" means... optimizing it (even if it's not called that).
[22:48:38] <graydon> I've been doing some more codegen tests here
[22:49:08] <graydon> and most of the idioms I translate, we're generating about 1.5x-2x more code than clang. some are closer to 1:1.
[22:49:17] <graydon> but I think there are still some bad interactions
[22:49:18] <pcwalton> ok, that's fine
[22:49:20] <pcwalton> not complete garbage
[22:49:25] <graydon> some of our functions are huge, unreasonably large
[22:49:27] <pcwalton> not tuned yet but not complete garbage
[22:49:32] <graydon> I agree
[22:49:35] <pcwalton> graydon: are you turning on opts in clang?
[22:49:38] <pcwalton> err
[22:49:39] <pcwalton> sorry
[22:49:41] <pcwalton> exceptions
[22:49:49] <pcwalton> I feel like a lot of our junk is due to landing pads
[22:49:52] <bblum> pcwalton: is there a make TIME_PASSES=1 flag or some such?
[22:49:55] <graydon> no, but I should.
[22:49:57] <pcwalton> bblum: yup, that's what it is
[22:50:00] <bblum> oh hotness
[22:50:11] <pcwalton> graydon: that'll skew the results a lot if you don't turn it on
[22:50:51] <aatch> Just as a note that rustc isn't as bad as it seems: I'm working on HipHop atm, and one of the files makes GCC use ~1GB of memory, it's big, but much, much smaller than the entire rustc code.
[22:51:15] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[22:51:17] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[22:51:18] <graydon> landing pads are part of it. we do a bunch of superfluous spills, don't align allocas/loads/stores, do a lot of superfluous bitcasts ..
[22:51:29] <graydon> something else has got to be going on for the huge functions though
[22:51:36] <bblum> why does aligning hurt codegen?
[22:52:16] <engla> strcat, sully: removing iterator dummy parameters compiles fine. Just needs a snapshot before it can go in
[22:52:22] <graydon> it hurts downstream, not at the llvm level
[22:52:23] <sully> rock!
[22:53:03] <sully> I've got a snap running
[22:53:08] <sully> but it timed out last time on linux
[22:53:09] <aatch> Oh right, that got through. I should dig up my old parser combinator code.
[22:53:12] <sully> and might be doing the same now?
[22:53:13] <sully> unclear
[22:53:26] <graydon> I think a _lot_ of what's going on is actually monomorphization explosion
[22:53:38] <pcwalton> I don't think so either
[22:53:39] <pcwalton> well
[22:53:41] <pcwalton> I have measured this
[22:53:49] <pcwalton> and the number of monomorphic instances seems small
[22:53:51] <graydon> I have too
[22:53:55] <graydon> am looking at it presently
[22:53:57] <pcwalton> bloat-o-meter said it was pretty small
[22:54:00] <pcwalton> but maybe not *shrug*
[22:54:04] <pcwalton> turning off type_use does very little
[22:54:05] *** sam113101 is now known as sam113101_afk
[22:54:13] <graydon> https://gist.github.com/graydon/87164517e0680ccd14d4 you tell me
[22:54:20] <engla> sully: the rocking things all come from you
[22:54:52] <pcwalton> graydon: what % of rustc is that though?
[22:54:52] <graydon> https://gist.github.com/graydon/17740c04e08a0ec28f8a there's another
[22:55:10] <nmatsakis> tikue: did anyone answer your question?
[22:55:24] <graydon> https://gist.github.com/graydon/d316d56e300e7d3bb52e
[22:55:28] <nmatsakis> tikue: about borrow check checks
[22:55:52] <pcwalton> graydon: hmm, 63 insns seems extreme for option::unwrap.
[22:56:05] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:56:55] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:57:51] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[22:58:09] *** sam113101_afk is now known as sam113101
[22:58:12] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[23:00:31] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:01:19] <pcwalton> graydon: your point is well taken but I think the problem is that these small functions are taking too many casts
[23:01:19] <bblum> nmatsakis: nobody did but he is currently distracted schmoozing with other interns
[23:01:24] <pcwalton> err
[23:01:27] <pcwalton> taking too many instructions
[23:01:30] <pcwalton> possibly due to bitcasts.
[23:01:54] <graydon> there are many dozens of copies of visit:: and hashmap:: and such in rustc also
[23:01:59] <graydon> I think there are a lot of things. cumulatively.
[23:02:00] <graydon> little things
[23:02:17] *** Quits: pcwalton (pcwalton@33605CA4.9F929CFD.F9E1BAE1.IP) (Quit: pcwalton)
[23:02:55] *** Quits: dherman (dherman@33605CA4.9F929CFD.F9E1BAE1.IP) (Quit: dherman)
[23:03:29] *** Joins: Guest (textual@moz-E64A54F3.nyc.res.rr.com)
[23:04:01] <bblum> toddaaro: ok, found one iloop before even adding task-killing capability or anything; test_stress_schedule_task_states hangs sometimes on a rebase up to "Do a task-killed check at the start of task 'timeslices'."
[23:04:11] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:04:16] <bblum> (which *doesn't* have "Change the HOF context switchers" or linked failure or anything like that
[23:04:41] <toddaaro> that hangs for you?
[23:04:42] <toddaaro> hm
[23:05:00] <tikue> nmatsakis: no, no one did :)
[23:05:15] <bjz> r+ on some numeric stuff? https://github.com/mozilla/rust/pull/8049
[23:05:32] <bjz> Luqman: ^?
[23:05:33] <engla> about namespaces. the way traits are imported undoes the namespaces a bit. You can't use a trait without bringing it directly into the current module by name
[23:06:09] <sfackler> sully: tests passed for me as well after a rebase. Maybe I didn't have your fixes last time *shrug*
[23:06:14] <bblum> toddaaro: getting some stack traces for you to look at
[23:06:37] <cmr> engla, you can do `use x = foo::bar::Trait` though
[23:07:19] <nmatsakis> tikue: are you asking about building rustc ? because it should be enabled by default otherwise
[23:07:38] <rpearl> a/win 13
[23:07:39] <engla> maybe that's enough cmr 
[23:07:50] <nmatsakis> tikue: but for rustc, do make DEBUG_BORROWS=1
[23:07:50] <tikue> nmatsakis: oh okay. I'll take another look, thanks!
[23:08:00] <toddaaro> bblum: so it was fine before that commit, and now it isn't?
[23:08:01] <tikue> nmatsakis: ah ok cool
[23:08:05] <nmatsakis> tikue: basically as long as you biuld w/o -O and w/o -Z no-debug-borrows, it'senabled
[23:08:07] <cmr> engla, it's not the greatest wrt namespacing, but it's there and works.
[23:08:14] <bblum> toddaaro: unknown - haven't bisected down to a one-commit window... just one thread is wedged; all others are waiting in pthread_cond_wait or pthread_join
[23:08:17] <nmatsakis> tikue: but rustc builds with -Z no-debug-borrows by default
[23:08:21] <bblum> toddaaro: here are some places it's looping through: http://pastebin.mozilla.org/2710998
[23:08:25] <tikue> nmatsakis: ok, sounds good then
[23:08:43] *** Joins: pcwalton (pcwalton@9B0BC9DC.71128241.F9E1BAE1.IP)
[23:08:43] *** ChanServ sets mode: +o pcwalton
[23:09:31] *** Joins: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP)
[23:09:31] *** ChanServ sets mode: +o dherman
[23:09:38] <bjz> pcwalton: https://github.com/mozilla/rust/pull/8049
[23:09:42] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:09:53] <bblum> toddaaro: http://pastebin.mozilla.org/2711020 detailed commit list
[23:10:04] <bblum> (sorry for the obscene branch name :P)
[23:10:10] <pcwalton> distracted by a talk but I'll look soon
[23:10:12] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:10:17] *** Quits: pcwalton (pcwalton@9B0BC9DC.71128241.F9E1BAE1.IP) (Quit: pcwalton)
[23:10:30] <bblum> toddaaro: i can get more stack traces if you want
[23:11:12] <toddaaro> bblum: ok, so in that first trace, the bottom thread is in malloc?
[23:11:42] <bblum> toddaaro: all stack traces are from the same thread, at different points in the iloop.
[23:11:45] <bblum> i can get more if you want
[23:12:05] <Luqman> bjz: how about Semiring -> SemiRing
[23:12:34] <toddaaro> bblum: oh, ok, I think I know what the loop is
[23:12:38] <bblum> oh really?
[23:12:44] <bjz> Luqman: seems to be the convention: http://mathworld.wolfram.com/Semiring.html
[23:12:46] * graydon swoons
[23:12:52] <toddaaro> bblum: a homed task is being sent home, and then on arrival being sent home again not run
[23:12:55] <toddaaro> I think
[23:13:04] <bjz> Luqman: https://en.wikipedia.org/wiki/Semiring
[23:13:31] <graydon> I mean, ok, I am a little concerned that this is opening up the door to having people add CoMonoidEndoFunctor to our library; but I must admit the math and PL undergrad in me likes working in a language that has typeclasses covering rings and fields
[23:14:05] <bblum> MonoidEndoFunctor is just Monad
[23:14:08] <bblum> what's the big deal????
[23:14:14] <graydon> (one level down to group as well?)
[23:14:47] <graydon> how many libraries program over groups rather than rings? not likely many
[23:15:11] <graydon> I mean "systems language libraries"; I realize there is always GAP for the purists
[23:15:17] <steven_is_false> bblum: We should really have a CategoryEndoFunctor. IndexedMonads are much more general than Monads.
[23:15:21] <bjz> graydon: I guess the thing is that Num is too general to be much use for lib authors
[23:15:33] <graydon> too general or too specific?
[23:15:46] <bjz> graydon: too specific
[23:15:49] <bjz> :)
[23:15:57] <graydon> yeah, I gather
[23:16:04] <kmc> I think we need a trait for nonassociative semicategories
[23:16:11] <bjz> graydon: trait set theory confuses me sometimes
[23:16:19] <sully> graydon: ok, so, do you have any guidance on whether I should try to do a type naming fix now, or wait for certain things to clear, or?
[23:16:41] <bjz> graydon: what is a subset of what
[23:16:45] <graydon> sully: if you have it all scripted up I'd appreciate waiting until I hear back from john about his patch
[23:16:47] <erickt> bjz: I tried to add those numeric traits a couple months ago, but ran into some ICEs. Glad to see we've gotten through them now
[23:16:48] <graydon> bjz: yeah
[23:16:57] <sully> graydon: ok, sounds good
[23:17:14] <sully> graydon: I will probably try to land the minor tweaks I've made to the lint pass
[23:17:21] <graydon> ok, sure
[23:17:23] <sully> graydon: I guess I'll land it when I register the snapshot I'm making
[23:17:30] <graydon> cool
[23:18:45] <sully> hm, something seems up with snap3-linux
[23:18:58] <sully> the estimated time until completion has not been going down
[23:19:00] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[23:19:03] <sully> and it timed out my previous attempt
[23:19:09] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[23:19:17] <sully> it looks like this has happened before, too
[23:19:35] <sully> hm...
[23:20:10] <sully> oh, wait, it does think that something succeeded
[23:21:11] <aatch> sully, it does happen sometimes with that bot.
[23:21:13] <graydon> one more manual bors run
[23:21:14] *** Joins: henrikhodne (henrikhodn@moz-87E975F1.dsl.static.sonic.net)
[23:21:15] <aatch> I'm not sure why though.
[23:21:20] <graydon> then I'm taking it offline to do buildbot upgrade
[23:21:24] <graydon> wish me luck!
[23:21:27] <sully> oh, hm, wait, maybe it did succeed
[23:21:37] *** Quits: ozten (ozten@19BD73A1.5D8BCA3A.A0C1B52F.IP) (Quit: ozten)
[23:21:38] <brendanc> may the force be with you
[23:21:41] <graydon> the snap3 linux machine is a not-very-fast vm
[23:21:45] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:21:57] <graydon> running centos 3 or red hat 7.2 or whatever
[23:21:59] <kmc> godspeed graydon / buildbot
[23:22:10] <graydon> (for maximal backwards compatibility)
[23:22:11] <kmc> slackware 4 life
[23:22:12] <aatch> I just want to say good luck, we're all counting on you
[23:22:15] <kmc> ++
[23:23:03] <graydon> oh gosh if we finish getting the runtime off C++ and into rust it'll make the whole issue of compatibility much easier. no libstdc++ compat.
[23:23:09] <graydon> snapshot compatibility I mean
[23:24:10] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:24:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JVFRqw
[23:24:10] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:24:58] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[23:25:04] <bjz> graydon: I guess the awesome thing is that we have the ability to express these things in Rust. Without concepts, C++ can't
[23:25:25] <bjz> graydon: shame we can't enforce associativity though :P
[23:25:32] <sully> oh, hm
[23:25:39] <graydon> you need to be in a fancier language
[23:25:46] <bjz> (Fortress had automatic unit tests for that)
[23:25:53] <sully> so, brson has a register snapshots PR in the queue
[23:26:02] <sully> I have a newer snapshot I want to register
[23:26:25] <sully> what is the best way to handle this? approve mine with a priority so his just bounces?
[23:26:45] <graydon> close his PR
[23:27:05] <graydon> the snaps are not going away, if he strongly disagrees he'll just reopen
[23:27:23] <graydon> they live forever in s3 (or until I do housecleaning there .. someday)
[23:27:23] <sully> ok, is it reasonable to approve mine with a priority, so as to not slow down him getting a snapshot?
[23:27:24] <tikue> hey guys, in destructuring a struct, e.g. `let Foo { fieldA, fieldB } = my_foo;` it's currently a syntax error to put a comma after the last field. Is this intentional?
[23:27:33] <graydon> there are many gigabytes of them by now
[23:27:41] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[23:27:42] <graydon> sully: yeah, sure. p=100, go for it
[23:27:43] <tikue> as in, `let Foo { fieldA, fieldB, } = my_foo;` won't compile
[23:27:48] <graydon> buildbot's offline presently anyway
[23:28:37] <sully> https://github.com/mozilla/rust/pull/8050
[23:28:53] *** Quits: dherman (dherman@9B0BC9DC.71128241.F9E1BAE1.IP) (Ping timeout)
[23:28:56] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[23:31:31] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Ping timeout)
[23:31:43] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[23:32:33] <toddaaro> s3 is such a blackhole
[23:32:47] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[23:33:04] <toddaaro> I have $10 a month there somehow from years ago and the effort to get it out is sufficient I probably never will
[23:33:54] <bblum> time: 116.112 sully translation
[23:34:05] <sully> hm?
[23:34:09] <bblum> stage1 libextra, CFG_DISABLE_OPTIMIZE is *not* set
[23:34:16] <bblum> that seems quite bad
[23:34:39] <bblum> uh, what?
[23:34:48] <henrikhodne> Is it normal for Rust to take a looong time to compile? It's been compiling for the last 20 minutes or so on my 2.2GHz i7 machine.
[23:34:50] <bblum> i swear it said '116.112 s translation' when i copied it
[23:34:54] <cmr> heftig, yes
[23:34:57] <cmr> henrikhodne, yes
[23:35:01] <cmr> henrikhodne, especially the first time.
[23:35:02] <kmc> henrikhodne: building LLVM takes the majority of the time
[23:35:03] <doy> bblum: those are probably tabs
[23:35:05] <doy> not spaces
[23:35:06] <cmr> henrikhodne, where it needs to build LLVM
[23:35:13] <cmr> Will probably take ~40min-1hr
[23:35:15] <bblum> oh, it tabbed.
[23:35:17] <bblum> damn it.
[23:35:18] <bblum> c.c
[23:35:18] <sully> I was like "wait did I regress performance what"
[23:35:25] <bblum> yeah, jerk
[23:35:49] <jld> ....I think I finally understand why xterm copies tabs as spaces.
[23:35:50] <Diamond> henrikhodne: make -j 8
[23:36:35] <sully> graydon: ok, so, when there is a bug that is a feature requset, and it is already accepted for a milestone
[23:36:38] <henrikhodne> Ok, I'll just wait a little longer then :)
[23:36:49] <sully> graydon: should I just be like "bump" when I get assigned to triage it, or what?
[23:37:26] <graydon> sully: check to make sure it's not been done yet, is well described, properly classified / tagged, check for dupes
[23:37:32] <graydon> then otherwise yes, just confirm it's been looked at
[23:38:14] <graydon> I find about 30% of bugs are closable as dupes or already-fixed by the time someone gets to looking at 'em
[23:38:16] *** Joins: hui (Mibbit@3624352C.AD379810.85518BE6.IP)
[23:38:21] *** Quits: rlbaker (rlbaker@moz-C8EE266C.hfc.comcastbusiness.net) (Quit: Leaving)
[23:39:09] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[23:39:23] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[23:39:37] *** Joins: ahui (Mibbit@3624352C.AD379810.85518BE6.IP)
[23:40:32] <ahui> under Windows platfrom,where to get pthread2-dll?
[23:40:41] <ahui> hi,
[23:41:17] <ahui> would you do some favor?
[23:41:38] <bblum> toddaaro: http://pastebin.mozilla.org/2711209
[23:42:15] *** Quits: kimundi (kimundi@moz-E839B363.dip0.t-ipconnect.de) (Ping timeout)
[23:42:57] *** Quits: cdidd (cdidd@moz-8DE79444.broadband.corbina.ru) (Ping timeout)
[23:43:21] *** Quits: hui (Mibbit@3624352C.AD379810.85518BE6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:44:03] *** Joins: zz_zz_kimundi (kimundi@moz-E839B363.dip0.t-ipconnect.de)
[23:44:22] *** zz_zz_kimundi is now known as kimundi
[23:45:20] *** Joins: cdidd (cdidd@moz-8DE79444.broadband.corbina.ru)
[23:45:43] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[23:45:58] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[23:46:11] *** Joins: LU324_ (stuff@moz-A17E9A7B.dyn.embarqhsd.net)
[23:46:39] *** Quits: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net) (Connection reset by peer)
[23:46:47] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:48:07] *** Quits: brendan (brendaneic@2D24BE81.5E7911EA.DA40C4B3.IP) (Quit: brendan)
[23:49:01] *** Quits: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP) (Ping timeout)
[23:53:02] <sully> ok, can anybody reproduce this? https://github.com/mozilla/rust/issues/6792
[23:53:20] *** Joins: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP)
[23:55:39] <graydon> brendanc: ping
[23:56:59] <sully> pnkfelix|rcirc: ping
[23:57:15] <brendanc> graydon: pong
[23:57:29] <brendanc> I have about 5 minutes before I have to catch a bus though
[23:57:38] <graydon> brendanc: any guess why I'd see
[23:57:41] <graydon>   self.ctl = interfaces.IControl(self.parent)
[23:57:41] <graydon>         exceptions.TypeError: ('Could not adapt', <buildbot.status.master.Status instance at 0x24b7ea8>, <InterfaceClass buildbot.interfaces.IControl>)
[23:57:42] <graydon> ?
[23:57:54] <graydon> in the interruptor you wrote
[23:58:07] <graydon> I don't know what a python interface _does_
[23:58:23] <brendanc> it's not python, it's a library over it
[23:58:28] <graydon> oh, ok
[23:58:39] <brendanc> sounds like it needs an update. Maybe I can port it tonight.
[23:58:46] <cmr> graydon, I fully stand behind the decision to not have function overloading.
[23:58:50] <graydon> fwiw only one of the methods in IControl appears to be a member of status.master.Status
[23:59:03] <graydon> so maybe I should just .. not do that cast
[23:59:09] <brendanc> you're on 0.8.7 I presume?
[23:59:12] <graydon> I assume it's basically a typecheck
[23:59:15] <graydon> 0.8.8rc1
[23:59:18] <brendanc> ok
[23:59:31] <cmr> graydon, in VS2012, for C#, which ostensibly has the best autocompletion and error reporting, the errors I get are along the lines of "The best overloaded method match for ... has some invalid arguments"
[23:59:36] <graydon> is the interface.IFoo() thing really just an assertion, like "prove you have these methods"?
[23:59:46] <cmr> The compiler itself can't reason about what I meant to call!
[23:59:58] <brendanc> I guess that's probably all it is, I can't remember
[23:59:59] <graydon> cmr: we have overloading, just only via traits :)
