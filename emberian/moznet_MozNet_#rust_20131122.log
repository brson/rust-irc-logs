[00:00:29] <ssbr> eh, do [...]
[00:00:31] <pcwalton> opt_foo.chain(|value| { … }), but we should probably have a monadic do-notation at least as a macro
[00:00:41] <pcwalton> "do" isn't great compared to Haskell do-notation anyway
[00:00:43] <pcwalton> our "do"
[00:00:48] <ssbr> I would greatly appreciate a monadic do-notation.
[00:01:01] <pcwalton> because it makes monadic chaining into pyramids of doom :)
[00:01:02] <kimundi> (It's and_then btw, not chain)
[00:01:14] <ssbr> what was chain then? I forget everything.
[00:01:22] <ssbr> maybe it was result.chain. or maybe I misremembered entirely.
[00:01:24] <kimundi> ssbr: and_then used to be chain
[00:01:27] <pcwalton> it's and_then
[00:01:29] <ssbr> kimundi: Oh, okay.
[00:01:32] *** Quits: tulloch_ (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[00:01:36] <ssbr> I should update my code.
[00:01:38] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[00:02:06] *** Joins: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net)
[00:02:53] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:02:53] <kimundi> pcwalton: A lot of the optimization disadvantages of closures would go away once we have function traits though
[00:03:09] <pcwalton> sure
[00:03:39] *** Quits: echristo (echristo@24D1937F.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[00:03:49] <kimundi> Right now, it certainly makes sense to eschew them in favor of something that does not dynamic dispatch
[00:04:15] <pcwalton> RAII is still more flexible though because you can move the result and it doesn't cause rightward drift
[00:05:22] <kimundi> Sure, not arguing against that
[00:06:01] <kimundi> Not arguing at all actually :)
[00:08:01] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:10:08] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[00:11:19] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:11:26] <pcwalton> do-pure.rs has really forgotten what it was supposed to be testing ;)
[00:11:30] * pcwalton puts it out of its misery
[00:11:39] <kimundi> haha :)
[00:12:11] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:12:11] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:13:28] *** Quits: peterdn (chatzilla@moz-30BAAE88.as13285.net) (Ping timeout)
[00:14:22] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:14:32] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:14:50] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[00:15:27] <sp3d> pcwalton: for someone with more C than C++ (where RAII is heralded as a big thing) experience, is there a good example somewhere of what "using RAII instead of closures" looks like?
[00:16:09] *** Joins: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net)
[00:16:23] <pcwalton> anywhere that uses Drop, really
[00:16:23] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:16:24] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:17:20] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[00:17:32] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[00:18:25] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:18:30] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:19:54] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[00:20:07] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[00:20:21] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[00:20:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:20:40] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:22:40] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[00:22:42] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:23:32] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:24:46] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:25:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:25:42] *** Joins: SingingBoyo (brandon@moz-5C373438.ubcsecure.wireless.ubc.ca)
[00:26:25] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[00:26:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:27:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:27:35] *** Quits: SingingBoyo (brandon@moz-5C373438.ubcsecure.wireless.ubc.ca) (Ping timeout)
[00:28:34] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[00:28:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:28:53] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:29:00] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[00:30:07] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[00:30:25] *** Quits: Jesse (jruderman@moz-7B0110AD.mv.mozilla.com) (Quit: Jesse)
[00:30:42] *** Joins: SingingBoyo (brandon@moz-5C373438.ubcsecure.wireless.ubc.ca)
[00:30:49] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[00:30:53] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:30:53] <cmr> sp3d: the proposed Mut<T> uses them
[00:31:08] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:31:10] <cmr> (https://github.com/mozilla/rust/pull/10514)
[00:31:32] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[00:31:36] <cmr> RAII is a very useful technique, it just lets you tie a resource into a scope
[00:32:17] *** Joins: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca)
[00:32:57] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:33:06] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:35:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:36:01] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[00:36:22] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:36:39] *** Joins: MrOrdinaire (Mibbit@BBA4818B.2D69868A.FD383126.IP)
[00:37:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:37:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:37:52] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[00:38:43] <MrOrdinaire> hi, is this a bug? http://mibpaste.com/yvBDTy 
[00:39:05] <cmr> pcwalton: ^
[00:39:19] <pcwalton> doesn't ~[T] implement Rand? 
[00:39:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:39:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:39:32] *** Joins: Jesse (jruderman@moz-7B0110AD.mv.mozilla.com)
[00:39:39] *** Joins: puritylake (Mibbit@moz-FF993AD8.b-ras1.mlw.mallow.eircom.net)
[00:39:41] <pcwalton> I think it does so that's not a bug
[00:39:54] *** Joins: tikue__ (tkuehn@97B597C6.D038900B.689607DE.IP)
[00:39:57] <MrOrdinaire> pcwalton: I see. Let me check it.
[00:40:26] <puritylake> hello again, just wanted to ask, is there an alternative to "fn iter(f: fn(&row: [str]) -> bool);"
[00:40:27] *** Quits: tikue__ (tkuehn@97B597C6.D038900B.689607DE.IP) (Quit: tikue__)
[00:40:32] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[00:40:51] <pcwalton> puritylake: for string in row.iter() { … }
[00:41:06] <MrOrdinaire> pcwalton: Sorry but I cannot find where `impl Rand for ~[T]` is http://static.rust-lang.org/doc/master/std/rand/trait.Rand.html
[00:41:28] <puritylake> thanks pcwalton
[00:41:31] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:41:34] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:41:48] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:42:00] *** Quits: Jesse (jruderman@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[00:42:05] <pcwalton> MrOrdinaire: yeah, I think that is a problem then
[00:42:13] <pcwalton> with our coherence checking being overconservative
[00:42:25] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[00:42:48] <MrOrdinaire> pcwalton: should I file an issue?
[00:42:55] <pcwalton> MrOrdinaire: sure, there may already be one
[00:42:57] <pcwalton> but feel free to file
[00:42:59] <pcwalton> dupes are cheap
[00:43:07] <MrOrdinaire> pcwalton: will do now. Thanks.
[00:43:16] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:43:33] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:43:33] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:44:56] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:45:34] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:45:36] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:45:36] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:46:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:47:32] *** Quits: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo_)
[00:47:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:47:38] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:47:40] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[00:47:56] *** Quits: MrOrdinaire (Mibbit@BBA4818B.2D69868A.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:49:06] *** Joins: MrOrdinaire (Mibbit@BBA4818B.2D69868A.FD383126.IP)
[00:49:38] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:49:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:50:28] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[00:50:39] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[00:50:47] *** Quits: SingingBoyo (brandon@moz-5C373438.ubcsecure.wireless.ubc.ca) (Ping timeout)
[00:51:39] *** Quits: MrOrdinaire (Mibbit@BBA4818B.2D69868A.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:51:40] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:52:19] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:53:47] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:54:01] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[00:54:01] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[00:55:51] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[00:55:57] *** Quits: valenting (Thunderbir@808EE6B5.84D5EFD5.FB866788.IP) (Ping timeout)
[00:55:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[00:59:02] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[01:00:52] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[01:03:41] *** Quits: fabrice1 (fabrice@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[01:04:02] <dg> does anyone have any advice on installing with rustpkg? i'm having trouble getting rust-sfml to install with this error: http://pastebin.com/2PMt91dn
[01:04:19] *** Joins: fabrice (fabrice@moz-BBE3ABD.mv.mozilla.com)
[01:06:23] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[01:07:30] *** Quits: puritylake (Mibbit@moz-FF993AD8.b-ras1.mlw.mallow.eircom.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:08:07] <bstrie> dg: sorry, rustpkg is a bit... raw right now. not many people have had the opportunity to use it
[01:10:49] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[01:10:53] <dg> no problem, I wasn't sure if it should be working or not. Seems to do this pretty consistently
[01:16:33] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[01:16:57] <pcwalton>  307 files changed, 3339 insertions(+), 3644 deletions(-)
[01:17:03] <pcwalton> removal of "do" except for "proc"s
[01:17:06] <pcwalton> and lots more to do
[01:17:16] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[01:17:24] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Ping timeout)
[01:17:45] *** Joins: Sgeo (quassel@moz-D0F30617.dyn.optonline.net)
[01:20:10] *** kimundi is now known as zz_kimundi
[01:21:04] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:21:49] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:21:49] *** ChanServ sets mode: +ao brson brson
[01:24:42] *** Quits: nkoep (nik@moz-AAC1F459.pool.mediaways.net) (Client exited)
[01:24:46] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[01:25:29] *** Joins: jordyd (jordyd@moz-9CF10CD3.seg39.ucf.edu)
[01:26:37] *** Joins: z0w0 (zack@moz-5E840EF3.lns3.woo.bigpond.net.au)
[01:26:55] *** Quits: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:26:59] <bstrie> pcwalton: is this the death knell of `do 3.times` ? :P
[01:27:05] <pcwalton> yes
[01:27:08] <pcwalton> and I want to remove "times" as well
[01:27:15] <pcwalton> it's been on the chopping block for a year
[01:27:17] <bstrie> ah well
[01:27:31] <bstrie> the inexorable march of progress
[01:29:05] *** Joins: adu (ajr@moz-47946E69.washdc.fios.verizon.net)
[01:29:36] <pcwalton> basically if we wanted to remove all instances of the magic "infer what kind of closure you mean" from the language we had to get rid of either "do 3.times" or "do spawn"
[01:29:40] <pcwalton> and we wanted to keep "do spawn"
[01:30:52] <pcwalton> so now "do" will always allocate
[01:31:01] *** Quits: huseby (huseby@moz-29C2662F.torproxy-readme-arachnide-fr-35.fr) (Ping timeout)
[01:31:24] *** Quits: flowsnake (flowsnake@moz-E4E567EE.aztw.cable.virginm.net) (Connection reset by peer)
[01:31:34] *** Joins: sockmister (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP)
[01:33:24] <tikue> so for things like sort_with(~[T], |x1: &T, x2: &T| -> bool) can it not be used with `do`?
[01:33:39] <sockmister> Can you add multiple values to enum variable? If I have `enum Days { None, Monday, Tuesday, Wednesday,Thursday, Friday, Saturday, Sunday }`, can I have `let day = Tuesday | Thursday`?
[01:35:28] <tikue> sockmister: no
[01:35:29] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:35:37] <pcwalton> tikue: right, you can't
[01:35:45] <pcwalton> sockmister: no. it would be nice to have bitfields as a syntax extension
[01:35:54] <pcwalton> I kind of felt "do" was an abuse for short closures like that
[01:35:58] *** Joins: flowsnake (flowsnake@moz-E4E567EE.aztw.cable.virginm.net)
[01:36:08] <pcwalton> sort_with(~[ 1, 2, 3, 4, 5 ], |a, b| a < b)
[01:36:11] <pcwalton> is much more readable IMHO than
[01:36:22] <pcwalton> do sort_with(~[ 1, 2, 3, 4, 5 ]) |a, b| {
[01:36:24] <pcwalton> a < b
[01:36:24] <pcwalton> }
[01:36:41] <tikue> yeah there's not really a win there anyway
[01:37:01] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[01:37:41] <tikue> so all the exciting vector talk that i saw today has got me confused. i'm assuming there isn't an informal writeup that explains the ramifications?
[01:37:44] *** Joins: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net)
[01:37:44] <tikue> (yet)
[01:37:56] <sockmister> Thank you. Have you any idea how should I proceed with porting code containing bit fields from C++ to Rust?
[01:38:24] *** Quits: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com) (Ping timeout)
[01:38:33] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[01:38:44] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[01:38:54] <tikue> sockmister: you could implement ToPrimitive and FromPrimitive using bit masks perhaps?
[01:39:40] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:39:46] <tikue> idk how usable it'd be to write from_primitive and to_primitive everywhere though
[01:40:01] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:40:05] *** Joins: derek_c (derek@moz-52C1645A.cit.cornell.edu)
[01:40:20] <sockmister> That would be awkward. Still, thanks, I'll think about that.
[01:40:59] *** Quits: alonlevy (alon@moz-EB7C9CF3.telavivmakers.org) (Ping timeout)
[01:41:47] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:42:16] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[01:46:11] <nmatsakis> tikue: no writeup yet, I think the plan is still very much under discussion
[01:46:20] * nmatsakis randomly checks into #rust
[01:46:29] *** Quits: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP) (Ping timeout)
[01:46:34] *** Joins: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP)
[01:46:50] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[01:47:16] <tikue> nmatsakis: cool t hanks. i see the etherpad you linked earlier, but I think it raised more questions than answered :O)
[01:47:39] *** Quits: jaeholee (uid4856@moz-31ABA2C0.irccloud.com) (Quit: )
[01:47:44] *** jorendorff is now known as jorendorff_away
[01:48:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:49:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:49:31] <nmatsakis> tikue: indeed
[01:50:30] *** Quits: GeneralMaximus (ankur@A6F89B8C.1D173DC.274D17D6.IP) (Quit: Computer has gone to sleep.)
[01:51:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:51:04] <sammykim> Can I send a variable as parameter to another functions several times?
[01:51:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:52:26] <jdm> "sometimes"
[01:52:26] *** Quits: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[01:52:27] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[01:52:45] <tikue> pcwalton: whoa did you really find compiler code that looked like `do do do do do {} {} {}`
[01:53:02] <pcwalton> tikue: there was one confusing, I forget where
[01:53:02] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:53:04] <pcwalton> but I also found a test case
[01:53:04] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:53:14] <tikue> amazing
[01:53:16] <sammykim> I tried to use Arc but the variable(struct) that I want to send has @mut or Cell type variable inside.
[01:53:42] <pcwalton> sammykim: there's no safe way to do it with @mut… @mut just isn't thread sfae
[01:53:43] <pcwalton> safe
[01:53:49] <pcwalton> in C++ you would crash
[01:53:53] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[01:53:54] <pcwalton> with Cell, the situation is better. you can use MutexArc
[01:54:10] *** Joins: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com)
[01:54:34] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[01:54:59] <tikue> when would you use mutexarc instead of rwarc?
[01:55:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:55:04] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:55:22] <cmr> tikue: when you don't want multiple readers
[01:55:40] <sammykim> pcwalt : Thanks patrick.
[01:55:42] <tikue> ah of course
[01:55:44] <cmr> (The doc comments explain this)
[01:55:46] <cmr> :P
[01:55:53] <tikue> can't find it on rust-lang
[01:55:59] <tikue> and i dont have rust on this comp
[01:56:00] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:56:22] <tikue> oh nvm just wasn't looking in extra
[01:57:00] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:57:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:57:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[01:57:57] *** Quits: adu (ajr@moz-47946E69.washdc.fios.verizon.net) (Quit: adu)
[01:58:10] <tikue> so all of the stuff like access(blk: &fn(x: &mut T) -> U) -> U is planned to be refactored to use RAII?
[01:58:41] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[01:59:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[01:59:10] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[01:59:11] *** Joins: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net)
[02:01:47] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[02:02:36] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[02:03:30] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[02:04:51] *** Quits: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net) (Ping timeout)
[02:06:22] *** Quits: sockmister (Mibbit@C83F40FA.C3C4EFEF.4BC5EF08.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:07:21] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[02:07:32] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[02:08:44] *** Quits: jdm (jdm@moz-ED0C7AC7.hinet-ip.hinet.net) (Quit: Lost terminal)
[02:10:23] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[02:11:36] *** Quits: brylie (quassel@moz-E27796EB.hsd1.or.comcast.net) (Input/output error)
[02:14:42] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[02:16:20] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[02:20:39] *** Quits: tikue_ (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Input/output error)
[02:21:23] <pcwalton> tikue: yes
[02:21:39] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[02:21:58] *** Joins: adu (ajr@moz-47946E69.washdc.fios.verizon.net)
[02:25:57] *** Quits: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com) (Quit: Leaving)
[02:30:46] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[02:32:16] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Ping timeout)
[02:32:17] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[02:32:35] <boredomist> what's the difference between "let (a,b) = (a_struct.owned_str, a_struct.other_member);" and "let a = a_struct.owned_str; let b = ...;" ?
[02:32:41] <boredomist> the first form doesn't seem to work
[02:33:18] <boredomist> the compiler complains about "use of partially moved value"
[02:33:50] <boredomist> i'd like for a to be &str, but i'm not sure how to do that for the tuple assignment
[02:34:53] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[02:34:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[02:35:05] *** Joins: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca)
[02:35:13] *** Quits: fabrice (fabrice@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[02:37:23] *** Joins: mib_sxl8fz (Mibbit@moz-24A8D406.hsd1.va.comcast.net)
[02:37:27] *** Joins: fabrice (fabrice@moz-7B0110AD.mv.mozilla.com)
[02:38:15] *** Quits: mib_sxl8fz (Mibbit@moz-24A8D406.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:38:27] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[02:38:33] *** Joins: MM (Mibbit@moz-24A8D406.hsd1.va.comcast.net)
[02:38:56] <MM> is the master branch rust-nightly?
[02:39:34] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:39:39] <boredomist> it's 760942d7d2a0701f526a5bc634419df7a1e941fe
[02:39:57] <boredomist> i built it this morning i believe
[02:40:16] <MM> okay thanks
[02:40:31] *** Quits: fabrice (fabrice@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[02:40:36] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:40:38] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[02:42:16] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:44:30] <pcwalton> what do people think about HashMap::empty() instead of HashMap::init()?
[02:44:33] <pcwalton> nmatsakis: brson: ^
[02:44:37] <pcwalton> for some reason
[02:44:41] <pcwalton> new HashMap::empty();
[02:44:43] <pcwalton> reads nice to me
[02:44:52] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[02:45:06] <cmr> What was the thinking on adopting the Default trait for default constructors?
[02:45:18] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[02:45:24] <pcwalton> new HashMap doesn't work because of 2 namespaces
[02:45:30] <pcwalton> HashMap is in type namespace
[02:45:34] <pcwalton> but you need something in value namespace
[02:45:34] <nmatsakis> pcwalton: reads well to me
[02:45:56] *** Quits: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net) (Ping timeout)
[02:46:14] <cmr> Hm, yeah, and magic around it would interact very strangly.
[02:46:19] <cmr> (I think it reads fine)
[02:46:48] <pcwalton> let a = new HashMap::empty();
[02:46:57] <pcwalton> a := make map[string][int]
[02:47:02] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[02:47:05] <pcwalton> only 2 characters more than Go...
[02:47:19] <pcwalton> could potentially allow dropping the parens
[02:47:22] <pcwalton> new HashMap::empty
[02:47:26] <pcwalton> might be too magical
[02:47:28] <cmr> I think it is
[02:47:45] <cmr> That idea also came to mind, but it'd be super weird with UFCS or whatever people want to call taking methods by value
[02:47:50] <pcwalton> oh wait
[02:47:56] <pcwalton> a := make(map[string][int])
[02:48:04] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[02:48:04] <pcwalton> forgot that make is this weird thing that takes a type, not a value
[02:48:04] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[02:48:11] <pcwalton> it's 1 character more than Go
[02:48:17] <pcwalton> err
[02:48:21] <pcwalton> a := make(map[string]int)
[02:48:29] <pcwalton> I never remember how to spell map types :(
[02:50:06] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[02:50:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[02:50:49] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:51:08] <cmr> Go also cheats by not needing to support arbitrary generics
[02:52:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[02:52:10] <boredomist> so was i simply not using the correct syntax for the tuple assignment example i posted above?
[02:52:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[02:52:29] <boredomist> here's the output: http://sprunge.us/ZDTU
[02:52:35] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:52:53] <pcwalton> boredomist: let foo { a, b, } = f;
[02:52:53] <cmr> boredomist: that's not an error, it's correct.
[02:52:56] <pcwalton> that's the syntax you want
[02:52:57] <pcwalton> err
[02:52:59] <comex> what is "new"?
[02:53:00] <pcwalton> let foo { a, b } = f;
[02:53:00] *** Joins: jdm (jdm@moz-8A85AB9E.dynamic.hinet.net)
[02:53:01] *** ChanServ sets mode: +o jdm
[02:53:04] <pcwalton> comex: the allocation operator
[02:53:07] <pcwalton> or soon-to-be
[02:53:14] <pcwalton> generic allocation operator supporting custom allocators
[02:53:35] <boredomist> pcwalton: wouldn't that create a "foo" struct though?
[02:53:43] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[02:53:45] <cmr> boredomist: no, it pattern matches out of foo
[02:53:45] <boredomist> i basically just want to extract two of the members
[02:53:51] <pcwalton> boredomist: it destructures the struct
[02:53:51] <boredomist> ahh, i see
[02:54:04] <cmr> boredomist: if you want a &str, you want f.a.as_slice()
[02:54:10] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[02:54:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[02:56:05] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[02:57:14] *** Quits: adu (ajr@moz-47946E69.washdc.fios.verizon.net) (Quit: adu)
[02:57:20] <cmr> pcwalton: ~fn is now ||, yeah?
[02:57:56] <pcwalton> cmr: no, it's proc()
[02:58:02] <pcwalton> || works for now but hopefully won't tomorrow
[02:58:12] <boredomist> cmr: let a: &str = f.a; seemed to work
[02:58:16] <boredomist> is that equivalent?
[02:58:23] *** Joins: jdm_ (jdm@moz-99690620.hinet-ip.hinet.net)
[02:58:24] <cmr> boredomist: yeah, just uses coercion
[02:58:26] <heftig> yes, due to autoslicing
[02:58:39] <cmr> pcwalton: I'm updating glfw-rs and it uses ~fn for the various callbacks
[02:58:53] <cmr> they aren't once fns though... should use a trait instead?
[02:58:54] <pcwalton> it can't do that if it want to call them more than once
[02:59:09] *** Quits: jdm (jdm@moz-8A85AB9E.dynamic.hinet.net) (Ping timeout)
[02:59:10] <pcwalton> a trait would be better. if you can group them you'll also save a huge number of allocations
[02:59:14] <acrichto> cmr: you could take a look at the uv bindings, they're all non-once callbacks as well (but kinda hacky)
[02:59:37] <acrichto> cmr: I also had to define 'trait Callback { fn call(&mut self); }' in std::rt::rtio
[03:00:22] <cmr> acrichto: thanks
[03:00:27] <klutzy> boredomist: .as_slice() is useful if you play with generics
[03:01:04] <klutzy> e.g. fn f<S: Str>(s: S) { let a: &str = s; /* notwork */ let b = s.as_slice(); /* work */ }
[03:01:20] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[03:01:26] *** Joins: adu (ajr@moz-47946E69.washdc.fios.verizon.net)
[03:03:18] <boredomist> interesting, thanks
[03:05:00] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[03:05:15] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[03:06:03] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[03:06:46] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[03:08:07] *** jdm_ is now known as jdm
[03:09:39] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:10:29] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:11:00] *** Joins: fabrice (fabrice@moz-94F028C6.hsd1.ca.comcast.net)
[03:11:26] *** Joins: tikue_ (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net)
[03:11:41] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:11:44] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:12:02] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[03:12:56] *** Quits: adu (ajr@moz-47946E69.washdc.fios.verizon.net) (Quit: adu)
[03:13:20] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[03:13:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:13:53] *** Joins: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP)
[03:14:33] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:15:27] *** Joins: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net)
[03:15:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:15:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:15:56] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[03:16:20] *** Joins: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net)
[03:16:29] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[03:17:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:17:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:20:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:20:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:20:45] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[03:21:42] *** Joins: mib_3p7ctk (Mibbit@moz-3FC497B9.hfc.comcastbusiness.net)
[03:21:51] *** Quits: mib_3p7ctk (Mibbit@moz-3FC497B9.hfc.comcastbusiness.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:22:06] <pcwalton> acrichto: r? https://github.com/mozilla/rust/pull/10581
[03:22:15] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:22:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:22:34] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[03:23:34] *** Joins: adu (ajr@moz-47946E69.washdc.fios.verizon.net)
[03:24:03] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[03:24:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:25:31] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:26:10] *** Quits: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net) (Client exited)
[03:26:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:26:59] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:27:21] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[03:28:43] *** Joins: mib_7n9xba (Mibbit@moz-24A8D406.hsd1.va.comcast.net)
[03:28:48] *** Quits: mib_7n9xba (Mibbit@moz-24A8D406.hsd1.va.comcast.net) (Quit: mib_7n9xba)
[03:28:55] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:29:07] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:29:26] *** Quits: MM (Mibbit@moz-24A8D406.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:29:38] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[03:29:56] *** Quits: zz_kimundi (kimundi@moz-BD4238C4.dip0.t-ipconnect.de) (Ping timeout)
[03:30:16] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[03:30:38] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[03:30:56] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:31:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:32:56] <boredomist> is it intentional that blocks don't need a comma after them in pattern matches?
[03:33:00] <boredomist> rusti: match 1 { 1 => {"foo"} 2 => "bar", _ => "baz" }
[03:33:01] -rusti- "foo"
[03:33:04] *** Joins: zz_kimundi (kimundi@moz-647B2DEA.dip0.t-ipconnect.de)
[03:33:04] <boredomist> it seemed odd to me
[03:33:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:33:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:33:32] *** zz_kimundi is now known as kimundi
[03:34:01] <sanxiyn> boredomist: Yes, it's intentional
[03:34:27] <sanxiyn> Yeah, can be odd
[03:35:09] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:35:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:35:17] <boredomist> why does it it work that way?
[03:35:53] *** Joins: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net)
[03:36:41] <sanxiyn> boredomist: Blocks are usually multiple lines. For multiple lines, omitting comma can read better.
[03:37:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:37:22] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:37:23] <boredomist> i see
[03:37:48] <brson> having a hard time figuring out which build target runs android stdtests
[03:38:02] <brson> this doesn't do it: make check-stage1-T-arm-linux-androidabi-H-x86_64-unknown-linux-gnu-std
[03:39:01] <brson> nor make check-stage1-T-arm-linux-androidabi-H-x86_64-unknown-linux-gnu-std-exec
[03:39:21] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[03:39:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:39:53] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[03:40:01] *** Quits: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP) (Ping timeout)
[03:40:37] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:41:35] <sanxiyn> brson: tests.mk:457 ff looks wrong to me
[03:41:47] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:42:02] *** Quits: Krymise (Nietzsche@moz-CA789EF5.nwrknj.fios.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[03:42:02] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:42:32] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:42:41] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[03:42:43] *** Joins: pnathan1 (Adium@moz-5EBBDD83.tukw.qwest.net)
[03:42:51] <wycats_> is it possible to use lifetimes to have a single struct with two references to a single struct?
[03:43:09] <brson> sanxiyn: why that line particular? this whole block looks a bit iffy but I didn't think that line was a problem
[03:43:27] <wycats_> for example, imagine that you want to store a single child in both an array and a map for different lookup requirements
[03:43:36] <wycats_> but the child's lifetime is always the same as the parent struct
[03:43:39] <brson> sanxiyn: i wonder why all these definitions are conditional at all
[03:43:39] <sanxiyn> brson: What is CFG_BUILD for you?
[03:43:45] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[03:43:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:43:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:44:16] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:44:37] <brson> sanxiyn: x86_64-unknown-linux-gnu
[03:45:03] <sanxiyn> brson: I think $(findstring $(target),$(CFG_BUILD)) is false then
[03:45:11] <sanxiyn> I am not sure why that test is there
[03:45:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:46:12] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[03:46:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:46:40] <sanxiyn> Ah now I understand :(
[03:46:48] <sanxiyn> Ugh
[03:46:50] <brson> sanxiyn: if it's false then it should drop to the android case (I think), but then if the android check is false, it looks like it should do the same thing as if $(findstring $(target),$(CFG_BUILD)) had been true
[03:46:50] <Luqman> sanxiyn: i think what it's doing is checking if we're cross compiling
[03:46:54] <brson> so that confuses me a bit
[03:47:19] <brson> Luqman: ah
[03:47:32] <sanxiyn> Uh hm
[03:47:34] <dbaupp> wycats_: you mean like `struct Foo<'a> { x: ~[&'a Bar], y: HashMap<~str, &'a Bar> }` where the Bar's get placed in both things?
[03:47:35] <brson> actually, no, I still don't get it ...
[03:47:50] <wycats_> dbaupp: exactly
[03:47:53] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[03:48:01] <sanxiyn> brson: Then check-stage$(1)-T-$(2)-H-$(3)-$(4)-exec seems to be defined...
[03:48:13] <dbaupp> wycats_: should be fine
[03:48:21] <dbaupp> in theory...
[03:48:21] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[03:48:21] <sanxiyn> Is there a debugger for Makefile?
[03:48:22] <Luqman> sanxiyn: brson i think the logic is something like if target==build { /* regular case */ } else { if target == android { ... } }
[03:49:02] <wycats_> dbaupp: acrichto is telling me that for my particular use-case a TreeMap would work
[03:49:22] <sanxiyn> brson: Does stage2 work?
[03:49:37] <brson> um, I made the same typo I always do when working on android "androidabi" vs "androideabi"
[03:49:39] <dbaupp> wycats_: ok, acrichto normally know what he's talking about so I guess it might. (I don't know your use-case...)
[03:49:41] <brson> why "eabi"?!
[03:49:45] <brson> so it works...
[03:49:48] <sanxiyn> brson: :(
[03:50:04] <Luqman> brson: e for embedded
[03:50:18] <sanxiyn> Yes EABI for embedded ABI
[03:51:17] <wycats_> dbaupp: I don't think I can actually use a TreeMap, I'll let you know what we work out
[03:51:19] <brson> Luqman: what confuses me about that logic is that it reads to me as `if target = build { /* regular case */ } else { if target == android { .. } else { /* ALSO regular case */ } }
[03:51:44] <sanxiyn> brson: That's right
[03:52:00] <Luqman> ah right
[03:52:06] <brson> sanxiyn: so why not just `if target == android { ... } else { regular case }`?
[03:52:40] <brson> maybe the android stuff was just added later
[03:52:40] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[03:52:48] <sanxiyn> brson: Yeah, I think that is equivalent
[03:52:59] <Luqman> brson: because in theory we build=android i guess
[03:53:13] <sanxiyn> Yes, assuming build != android, it's equivalent
[03:53:24] <sanxiyn> (That is, we don't build on Android, we always cross)
[03:53:32] <brson> ah
[03:53:40] <sanxiyn> If build = android, in theory, it shouldn't use adb remoting
[03:53:44] <brson> yeah
[03:53:49] <sanxiyn> And just do local testing
[03:53:51] <sanxiyn> In theory
[03:55:45] <sanxiyn> It would be great if we have proper remote testing infrastructure instead of Android special cases :(
[03:55:57] <sanxiyn> (Say, having ssh backend in addition to adb backend)
[03:56:20] <sanxiyn> So that, say, can remote test Raspberry Pi
[03:57:39] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[04:00:09] *** Parts: BossKonaSegway (Michael@moz-2986F42D.col.wideopenwest.com) ()
[04:00:19] <brson> stdtest passes on android. neato
[04:00:27] <brson> and it didn't even take that long
[04:00:27] <sanxiyn> Nice
[04:00:58] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[04:01:08] <sanxiyn> (Now we just need to fix all xfailed tests...)
[04:02:10] *** jorendorff_away is now known as jorendorff
[04:03:32] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Client exited)
[04:03:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:03:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:04:24] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[04:05:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:05:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:07:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:07:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:09:40] *** jdm is now known as jdm|f00ding
[04:09:53] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:09:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:14:19] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[04:18:18] *** jorendorff is now known as jorendorff_away
[04:18:40] *** Joins: jstevans (Instantbir@moz-5E56869C.washdc.fios.verizon.net)
[04:19:15] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[04:20:55] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Quit: )
[04:25:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:25:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:27:16] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:27:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:28:00] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[04:28:58] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[04:29:15] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[04:29:22] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Quit: Leaving)
[04:29:27] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:29:32] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:30:33] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[04:30:33] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:30:42] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[04:31:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:34:02] *** Quits: gandalf (zbraniecki@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: My lid went down)
[04:34:38] *** Quits: adu (ajr@moz-47946E69.washdc.fios.verizon.net) (Quit: adu)
[04:37:16] *** Quits: derek_c (derek@moz-52C1645A.cit.cornell.edu) (Ping timeout)
[04:37:39] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[04:38:37] <pcwalton> nmatsakis: ping
[04:39:56] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:41:44] *** Quits: jordyd (jordyd@moz-9CF10CD3.seg39.ucf.edu) (Ping timeout)
[04:43:37] *** Joins: adu (ajr@moz-47946E69.washdc.fios.verizon.net)
[04:43:58] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:44:44] <pcwalton> P-backcompat-lang has accumulated a bunch of cruft :(
[04:45:45] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:47:27] <ilyoan> Does rust have something like Scanner in Java or scanf in C?
[04:47:30] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[04:49:26] <pcwalton> ilyoan: there are a bunch of methods on Reader that may be what you want
[04:51:07] *** Joins: lugati (fooey@B50EDF86.82DE5651.FA4E5DC4.IP)
[04:51:11] <lugati> hmm
[04:52:09] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[04:52:24] <ilyoan> pcwaltion: Yeah but as far as I know, Reader is base on binary but what I need is string based scan method.
[04:53:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:53:57] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:54:06] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[04:54:18] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse_)
[04:54:55] *** Joins: dagnir (chatzilla@moz-AD50763C.hawaii.res.rr.com)
[04:55:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:55:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:56:26] <pcwalton> acrichto: ^
[04:57:52] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:57:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[04:58:49] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[04:59:53] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[04:59:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:00:07] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[05:01:03] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[05:01:10] <ChrisMorgan> There's Reader.bytes() which produces a Iterator<u8>, I thought there was some way to then turn that into an incremental UTF-8 reader (i.e. Iterator<char>), but I can't find it. Might potentially have been old io.
[05:01:22] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[05:01:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:01:59] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:02:11] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[05:02:27] <ChrisMorgan> ilyoan: provided you're happy reading it all at once, you can use read_to_end()
[05:02:34] <ChrisMorgan> http://static.rust-lang.org/doc/master/std/io/trait.Reader.html#method.read_to_end
[05:02:46] <lugati> nice browser
[05:02:52] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[05:03:00] <ChrisMorgan> Combine it with http://static.rust-lang.org/doc/master/std/str/fn.from_utf8_owned.html to turn it into a ~str
[05:03:05] <lugati> v25 is very stable
[05:03:22] <ChrisMorgan> lugati: ?
[05:03:38] <lugati> firefox
[05:03:39] <acrichto> ilyoan: pcwalton: I have not given it much thought, but I imagine that it may be difficult and need compiler support to be "super nice"
[05:04:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:04:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:04:10] <acrichto> ilyoan: with C sscanf you can have a string like "%s %s %d", but in rust everything has to be preinitialized and you have to validate the types which could get difficult
[05:04:13] <ChrisMorgan> (lugati: the cool kids are using Nightly, at 28, and enjoying the Australis UI. Join us! It's not quite as stable, but it's nicer.)
[05:04:31] <acrichto> ilyoan: that being said, we could probably have a type that's like StringDecoder or something like that which has read_int()/read_string() which does the right hting
[05:04:34] <lugati> thought i'd be thanking ya coders
[05:04:43] <lugati> ahh
[05:05:01] <lugati> damn i'll check out now
[05:05:10] <pcwalton> acrichto: probably doing it mutably on writers may be the worse-is-better thing
[05:05:46] <acrichto> pcwalton: hm yeah that could also wokr
[05:05:49] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[05:05:56] <pcwalton> err, on readers
[05:06:06] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:06:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:06:25] <lugati> looks nice ChrisMorgan
[05:06:39] *** sammykim is now known as recrack
[05:06:40] <pcwalton> I'm going through and removing a bunch of Cells
[05:07:10] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[05:07:10] <pcwalton> figured I should do something good to make up for removing "do" with stack closures :)
[05:07:49] <Eridius> pcwalton: nooooooooo gimme my `do` closures back!
[05:08:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:08:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:08:53] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[05:09:40] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[05:10:12] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:10:21] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:10:26] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[05:12:46] <pcwalton> it's done that way to remove all inference around || (except for maybe the set of trait bounds)
[05:12:57] <pcwalton> helps DST and makes allocations more obvious
[05:13:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:13:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:14:09] <dbaupp> ah, ick
[05:14:18] <dbaupp> rust/src/librustc/lib.rs:1:0: 1:0 error: Unsupported constant expr
[05:14:23] <dbaupp> in librustc
[05:14:30] * dbaupp sighs
[05:14:52] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[05:15:18] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:15:18] *** Quits: yuriks (yuriks@72011412.14007B8A.748B6D8D.IP) (Connection reset by peer)
[05:15:20] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:15:41] *** Joins: yuriks (yuriks@AA98A234.FE9B542E.10054EA3.IP)
[05:15:43] *** recrack is now known as sammykim
[05:16:26] <ilyoan> acrichto: thanks
[05:17:23] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:17:28] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:17:29] *** Quits: lugati (fooey@B50EDF86.82DE5651.FA4E5DC4.IP) (Quit: )
[05:17:37] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[05:17:50] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[05:18:02] <ChrisMorgan> pcwalton: so when 10581 lands we'll be able to change one-shot &fn(...) things with associated cell unwrapping at the calling closure to accepting proc(...) and not needing to use cells at all?
[05:18:04] <ilyoan> acrichto: I'm hoping that rust eventually provides a feature like Scanner in Java or something like that.
[05:18:38] <dbaupp> ChrisMorgan: one-short ~fn's
[05:18:41] <dbaupp> *shot
[05:18:54] <pcwalton> one shot &fns should generally be written in other ways
[05:18:59] <pcwalton> prefer RAII
[05:19:05] <ChrisMorgan> dbaupp: but at present such APIs have probably tended to be written as &fn, I think?
[05:19:08] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[05:19:11] <pcwalton> or if you must use &fn, use the "pass arguments through" trick of spawn_with
[05:19:27] <pcwalton> ChrisMorgan: that's right. I'm going to try to change them all
[05:19:28] <ilyoan> arichto: I'm currently working with space sperated text file. and about to give up programming in rust.
[05:19:34] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:19:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:19:43] <pcwalton> yeah, we need scanner
[05:20:16] <pcwalton> space separated text files you can probably do by just reading in lines and using split_iter
[05:20:36] <ChrisMorgan> `"foo bar" baz`—three chunks or two?
[05:20:38] <pcwalton> let line = read_line() and then: for token in line.split_iter() { … }
[05:21:13] <pcwalton> if you use that technique, two
[05:21:15] <pcwalton> err
[05:21:15] <pcwalton> three
[05:21:20] *** Quits: jstevans (Instantbir@moz-5E56869C.washdc.fios.verizon.net) (Ping timeout)
[05:21:22] * dbaupp wants a rust-parsec... need monads/functors for complete niceness though.
[05:21:35] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:21:37] <pcwalton> there is a regex library for rust, right?
[05:21:39] <pcwalton> or several
[05:21:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:22:02] <sfackler> just bindings to c libraries iirc, nothing native
[05:22:17] *** Joins: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP)
[05:22:28] <pcwalton> that's actually ideal IMHO
[05:22:36] <pcwalton> to do really good regexes you need a JIT
[05:22:39] <pcwalton> and I don't want to write one
[05:23:02] <ChrisMorgan> pcwalton: no it's not! Just as format! is done at compile time, regular expressions should be done at compile time where possible.
[05:23:06] <ChrisMorgan> ilyoan: don't be too concerned if you find you can't work with Rust yet—it *is* a language still definitely in development;but if you do give up, come back in a while and it'll be better.
[05:23:08] <ilyoan> pcwalton: spliting lines is possible but inconvenient
[05:23:08] <pcwalton> ChrisMorgan: agreed
[05:23:26] <pcwalton> if you aren't going to do it as a syntax extension, I mean
[05:23:37] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:23:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:23:41] *** Quits: yuriks (yuriks@AA98A234.FE9B542E.10054EA3.IP) (Connection reset by peer)
[05:23:44] <pcwalton> yeah, if you can't use split_iter() and regexes, then I think we need a Scanner
[05:23:49] <pcwalton> or something like that
[05:24:19] <ilyoan> ChrisMorgan: I know, rust is very rapidly improving. but this time I'd rather programming in c :)
[05:25:26] <ilyoan> Thanks all :)
[05:25:28] <ChrisMorgan> pcwalton: but Rust makes writing FSMs and the likes delightful. I'd much rather write a regex engine in Rust than C, C++ or Python.
[05:25:39] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:25:40] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:25:43] <pcwalton> ChrisMorgan: that's fair
[05:25:51] <pcwalton> I'm just saying that if we write it in Rust I want it to be good
[05:27:05] <dbaupp> fwiw, ssbr is writing a native Rust engine (based on https://github.com/mozilla/rust/wiki/Lib-re )
[05:27:41] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:27:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:27:54] <eddyb> if you restrict the regex' operation (in interacting with Rust code), then you should be able to do something like irregexp and couple it with the LLVM bindings for JIT
[05:28:03] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[05:28:04] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:28:08] <eddyb> without full Rust JIT
[05:28:08] <ChrisMorgan> pcwalton: sure thing. The effort I'd like is certainly toward genuinely compiled regular expressions rather than a Rust-native engine where significantly-lower-effort bindings wouldn't be so bad.
[05:28:24] <ssbr> oh, regex discussion
[05:28:26] <pcwalton> that sounds nice
[05:28:49] <pcwalton> for example, I'd like to move bigints out of lib extra and into the community supported packages
[05:28:55] <pcwalton> because they're really slow compared to GMP
[05:29:00] <pcwalton> which is not a slam against them
[05:29:03] <pcwalton> it's just really hard to compete with GMP
[05:29:35] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:29:37] <eddyb> about the scanner thing, I want to see this possible at some point (even if the style may be despicable): let x: int; cin >> x;
[05:29:56] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:30:22] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[05:30:22] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:30:32] <dbaupp> pcwalton: isn't the goal to split the entirity of libextra into either std or community-supported packages?
[05:30:46] <pcwalton> dbaupp: yup
[05:30:49] <ssbr> ChrisMorgan: I don't suppose you have any interest in this topic?
[05:30:57] <pcwalton> I was somewhat sad when the bigint-using benchmark got rewritten to use bigints
[05:31:02] <pcwalton> it just makes us look slow for no reason
[05:31:09] <pcwalton> to use Rust bigints that is
[05:31:10] <pcwalton> it got 10x slower
[05:31:24] <pcwalton> I know it's more honest and I respect that but… it's the shootout, it's no place for honesty :)
[05:31:25] <ChrisMorgan> ssbr: I do, but I've got too many things I've got an interest in.
[05:31:33] <ChrisMorgan> :P
[05:31:33] <ssbr> ChrisMorgan: I know that feeling too well. :(
[05:31:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:32:07] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:32:10] <ssbr> I've spent the past hour dividing my time between watching the daily show and trying to figure out the best way to pull out the firefox regex test suite
[05:32:32] <ChrisMorgan> Ten days with no meaningful progress on rust-http :-(
[05:32:54] <ChrisMorgan> At least I've finished my last exam now :-)
[05:32:56] <ssbr> (I've settled on hooking into the regexp engine to make it output all the patterns and what they are run against, but I've never read the firefox source code before, so it's a challenge')
[05:32:58] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[05:33:10] <ssbr> ChrisMorgan: exam season is the best season for getting stuff done! go go go
[05:34:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:34:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:34:05] *** Joins: weirdo (Mibbit@moz-3213C615.wavecable.com)
[05:34:52] <weirdo> Is this debugging session of mine on rusti useful at all? https://pastee.org/e65hv
[05:34:57] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[05:36:02] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:36:04] <ChrisMorgan> weirdo: rusti? But rusti is removed?
[05:36:25] <ChrisMorgan> (I thought rusti was removed before 0.8, but I presume that I'm wrong in that.)
[05:36:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:37:20] <weirdo> Oh, I'm sorry. Forgot to remove 0.8 installed by my package manager. 
[05:37:41] *** Joins: haxney (dan@moz-424CB7EB.cs.brown.edu)
[05:38:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:38:04] <ChrisMorgan> rustc is working?
[05:38:26] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[05:38:56] <haxney> How do I implement `Iterator` for a structure which takes a lifetime parameter? I keep getting "illegal anonymous lifetime" errors or "lifetime must be declared"
[05:38:56] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:38:59] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Ping timeout)
[05:39:21] <eddyb> haxney: impl<'a> I'd guess
[05:39:22] <haxney> I have `pub struct Tokenizer<'self>` and want to implement `Iterator` on it
[05:39:26] *** Quits: weirdo (Mibbit@moz-3213C615.wavecable.com) (Quit: http://www.mibbit.com ajax IRC Client)
[05:39:28] *** Quits: pnathan1 (Adium@moz-5EBBDD83.tukw.qwest.net) (Quit: Leaving.)
[05:40:09] <haxney> eddyb: aha! That seems to have done it. There's a lot of sprinkling declarations around to do, huh?
[05:40:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:40:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:40:20] <eddyb> impl<'a> Iterator<Token<'a>> for Tokenizer<'a>
[05:41:59] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[05:43:04] <eddyb> haxney: it might be simpler at some point in the future, but if you return something like Token<'a>, you need the explicit lifetime anyway, to link them
[05:45:20] <haxney> eddyb: I'm trying to store a borrowed pointer in a struct, and having some issues with the lifetime. I'm using an extra::arc::Arc and trying to keep around the result of Arc.get() in the structure
[05:45:49] <haxney> right now, I'm trying to implement `new()`
[05:46:36] <acrichto> dbaupp: ping
[05:46:45] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[05:47:00] <haxney> and getting "borrowed value does not live long enough"
[05:47:12] <dbaupp> acrichto: pong
[05:47:29] <acrichto> dbaupp: you seem to have updated 10588, but not r=me'd it, did you want me to look at it again?
[05:47:37] <haxney> I'm passing in an `Arc<~str>` and want to store it and a borrowed pointer to its contents in the struct
[05:48:09] <pcwalton> I don't think you do that
[05:48:11] <pcwalton> you can do that
[05:48:16] <dbaupp> acrichto: yeah, I thought of something else to add before I r='d, but had changed to another branch
[05:48:18] <haxney> Basically, I want to be able to access the string within without having to call `get()` all the time, since I think it might be slowing thigns down
[05:48:21] <dbaupp> acrichto: literally just updated now
[05:48:31] <acrichto> dbaupp: ah ok
[05:48:34] <dbaupp> acrichto: (a testcase to make sure TaskRng isn't sendable)
[05:48:52] <pcwalton> get() shouldn't have any performance cost
[05:48:54] <pcwalton> if it's inlined
[05:48:59] <pcwalton> (if it's not inlined file a bug) ;)
[05:49:10] <haxney> doesn't it have to do atmoic operations?
[05:49:14] <pcwalton> nope
[05:49:18] <pcwalton> only if you .clone()
[05:49:21] <dbaupp> acrichto: are you looking? or can I just r=you?
[05:49:32] <acrichto> dbaupp: nah feel free to r=me
[05:49:39] <pcwalton> regular ol' Arcs are immutable so there is nothing to keep track of other than the reference count
[05:49:45] <pcwalton> and since get() borrows it doesn't have to touch the ref count.
[05:49:58] <haxney> pcwalton: good to know. That simplifies things.
[05:51:01] <haxney> then I'm still working on how to increase performance of my parallel CSS lexer. I was thinking that there might be some atomic operations which hurt performance
[05:51:35] <dbaupp> acrichto: is https://github.com/mozilla/rust/pull/10583 just waiting on an r?
[05:51:53] <acrichto> dbaupp: should be yeah
[05:52:47] <pcwalton> and there's your r+
[05:52:55] <acrichto> wheeee
[05:53:59] <sfackler> pcwalton: r? https://github.com/mozilla/rust/pull/10514
[05:54:02] <pcwalton> making || into "proc" for procs doesn't break much code and makes things more readable IMHO
[05:54:08] <sfackler> std::mutable::Mut is now std::cell::RefCell
[05:54:15] <pcwalton> sfackler: r+
[05:54:18] <sfackler> thanks
[05:54:22] <pcwalton> thanks so much for that
[05:54:28] <pcwalton> that's an amazingly good job
[05:54:40] <pcwalton> and very important
[05:54:51] <pcwalton> now I can nuke my bad implementation of that from servo :)
[05:54:59] <sfackler> most of it is engla's, but thanks :)
[05:55:28] <sfackler> i'm not a huge fan of the name RefCell, but we can always change it later if it ends up being too confusing
[05:55:51] <pcwalton> I'm not an enormous fan of it, if someone has something better that's verbally distinguishable from "mut" I'm open to it
[05:56:16] <pcwalton> I did a survey of jeaye's q3
[05:56:22] <pcwalton> since he was hitting @mut problems the most
[05:56:35] <pcwalton> and I found that most of the stuff in his @muts were actually covered by Cell
[05:56:40] <pcwalton> the remaining stuff were mostly HashMaps
[05:56:43] <pcwalton> which would be covered by RefCell
[05:56:44] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:56:57] *** Joins: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net)
[05:56:59] <pcwalton> by Cell I mean the new cell that requires POD data and doesn't have any borrowing at all (it just copies in and out)
[05:57:41] <pcwalton> the nice thing about copies is that if your data is POD (meaning it has no destructors or ~ in it) then you might as well just copy and out because LLVM will optimize out all the fields you didn't mutate
[05:57:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:57:47] <pcwalton> dead store elimination
[05:57:51] <pcwalton> trivial in SSA form
[05:57:54] <jeaye> My biggest problem with @mut is that my in-game console needs to be able to modify 90% of the game's data at any moment. This rules out &mut.
[05:58:01] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[05:58:16] <sfackler> RefCell is still a bit awkward to use without the smart pointer trait(s)
[05:58:26] <pcwalton> sfackler: yeah, Cell should be a lot easier to use
[05:58:34] <pcwalton> can't always use it of course
[05:58:46] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:58:47] <sfackler> yeah
[05:58:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[05:58:56] <pcwalton> so I think moving to @ and switching the mutable fields in q3 over to Cell/RefCell will get rid of almost all of the dynamic borrow failures
[05:59:01] <pcwalton> knock on wood of course
[05:59:05] <pcwalton> but I believe it'll work
[05:59:09] <pcwalton> from my quick survey
[05:59:09] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[05:59:20] <pcwalton> and then we just need to improve the notational overhead of RefCell
[05:59:24] <pcwalton> then I think we'll be pretty good
[05:59:30] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:59:52] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[06:00:01] <pcwalton> I'm not 100% happy with the fact that we have two kinds of mutability in rust (inherited and cell/ref cell)
[06:00:16] <pcwalton> just from a learning curve POV
[06:00:40] <pcwalton> but if we get to the point where it's all sound and dynamic borrow failures don't happen in practice I'll be happy enough
[06:00:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:00:57] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:01:02] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[06:01:36] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[06:02:45] <pcwalton> depending on how much of "new" and moving GC into the library I can get done Friday and next week we may be pretty close to stable from a language point of view
[06:02:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:02:50] <pcwalton> which is really exciting
[06:02:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:02:56] <pcwalton> here's to hoping
[06:03:21] <dbaupp> we've now got std::gc::Gc<T> (currently just a wrapper for @)
[06:03:21] <pcwalton> by that I also mean the vec/str changes
[06:03:26] <pcwalton> right
[06:03:34] <pcwalton> new(GC) doesn't work
[06:03:39] <pcwalton> yet
[06:03:46] <sfackler> is the smart pointer trait happening for 1.0?
[06:04:02] <pcwalton> sfackler: unclear. it is currently not blocking 1.0
[06:04:11] <pcwalton> however if it's intolerable without it then we can see if we can get it in.
[06:04:21] <pcwalton> it's backwards compatible either way
[06:04:22] <pcwalton> so
[06:04:33] <pcwalton> right now I am most concerned with getting to a stable state
[06:04:40] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[06:04:48] <pcwalton> so that we don't break people's code if they don't use anything feature gated
[06:04:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:04:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:05:05] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[06:05:25] <pcwalton> nmatsakis does have a sketch of the trait
[06:05:48] <pcwalton> backwards compatible language changes are MUCH easier to make than backwards incompatible ones
[06:05:48] <sfackler> part of me will miss the daily "updates for rust master" commits :P
[06:05:58] <pcwalton> I don't think you'll miss them that badly ;)
[06:06:26] <pcwalton> there's a fair amount of backwards incompatible stuff which is under the heading of "tweak the type inference where it's kinda bogus right now"
[06:06:41] <pcwalton> which include unsoundnesses and stuff where it isn't unsound but is sketchy
[06:06:46] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[06:06:52] <pcwalton> I don't expect that to break much code though
[06:06:54] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:06:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:06:56] <pcwalton> in practice
[06:06:58] *** Quits: haxney (dan@moz-424CB7EB.cs.brown.edu) (Quit: ERC Version 5.3 (IRC client for Emacs))
[06:06:58] *** Quits: Jesin (Jesin@moz-63C897DA.res.lehigh.edu) (Quit: Leaving)
[06:07:16] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[06:07:31] *** Joins: derek_c (derek@moz-10A72C28.cit.cornell.edu)
[06:07:33] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[06:07:42] <eddyb> hmm, my huge file seems to compile slower with explicit types for locals
[06:07:42] <ChrisMorgan> pcwalton: it means you can get activity on a project with no activity otherwise
[06:07:58] *** Quits: apoelstra (username@moz-C92A9641.sw.biz.rr.com) (Ping timeout)
[06:08:11] <pcwalton> eddyb: yeah, the compiler generates type variables in most cases even if you explicitly type annotate
[06:08:15] <pcwalton> probably shouldn't
[06:08:17] <pcwalton> in some cases
[06:08:36] *** Quits: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:08:53] <ChrisMorgan> If you want slow, try a macro with thousands of rules :P
[06:08:59] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:09:07] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:09:18] <eddyb> ChrisMorgan: yay backtracking
[06:09:46] <eddyb> this is huge, and even with a significant decrease in the number of cases (10k lines -> 3k), it's still bad
[06:09:59] <ChrisMorgan> It's slow even if they're all constants.
[06:09:59] <eddyb> the actual size didn't go down much :(
[06:11:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:11:31] <eddyb> it's "just" a x86_16 emulator
[06:11:31] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:11:41] <eddyb> but it's almost as big as librustc itself :(
[06:12:50] *** Joins: SingingBoyo (brandon@DA28FB90.A5D0D593.4F048BDC.IP)
[06:13:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:13:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:14:51] <pcwalton> eddyb: wonder if it's unwinding info?
[06:14:53] <pcwalton> and cleanups?
[06:15:02] <pcwalton> that can bloat code a lot. I've been wanting to have a #[no_unwinding]; flag for a while
[06:15:06] <pcwalton> that just turns that stuff off
[06:15:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:15:16] <eddyb> no Drop, thankfully - but it grows waay before trans
[06:15:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:15:31] <eddyb> I mean, I get early typeck errors and it's already past 1GB
[06:16:05] <pcwalton> the compiler is a memory hog due to using big enums among other things probably
[06:16:12] <pcwalton> we should really look at the size of our enums carefully
[06:16:22] <eddyb> can we dump arena sizes?
[06:16:25] <pcwalton> also using @ doesn't help
[06:16:57] <eddyb> a -Z flag for total sizes after/before each pass would help IMO
[06:17:06] <pcwalton> yeah, that'd be a very good idea.
[06:17:06] <eddyb> at least I can guess what I can try to make it happy
[06:17:11] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:17:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:17:18] <eddyb> s/happy/unfat
[06:17:20] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[06:17:32] <pcwalton> the compiler really wasn't written with perf in mind sadly, although it's gotten a lot better
[06:17:58] <acrichto> is anyone here a self-proclaimed windows/mingw expert?
[06:18:13] <acrichto> or had any experience at all, b/c it's more than me!
[06:19:12] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:19:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:19:27] <eddyb> acrichto: eeeeh, I know a few things
[06:19:34] *** jdm|f00ding is now known as jdm
[06:19:43] <acrichto> my mingw apparently can't find -lpthread
[06:19:53] <acrichto> even though the pthread library is checked off as installed
[06:20:11] <dbaupp> does anyone happen to know what ast::TypeField is doing? it appears to be unused in the rest of the ast?
[06:20:15] <eddyb> I think mingw-w64 is better than the original project, you should statically link against libgcc, and maybe... nevermind
[06:20:50] <eddyb> acrichto: heh. no clue
[06:20:57] <acrichto> oh yay I insalled some random package and it found it
[06:20:59] <acrichto> who knew
[06:21:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:21:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:23:25] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:23:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:23:38] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Quit: Leaving)
[06:24:46] <eddyb> there's one hack I could use, wrap code in do self.create_commonly_used_expressions(a, b, c) {...}
[06:25:20] <eddyb> but implementing that in the codegen - eeeeeeh. I would have to make it more versatile than it already is
[06:25:27] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:25:30] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:26:30] <eddyb> why does chrome need a constant 10-20% CPU load?
[06:26:37] *** Joins: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP)
[06:26:50] *** Quits: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP) (Quit: Leaving.)
[06:27:00] *** Joins: Jesin (Jesin@moz-63C897DA.res.lehigh.edu)
[06:27:33] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:27:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:28:28] *** Quits: adu (ajr@moz-47946E69.washdc.fios.verizon.net) (Quit: adu)
[06:29:35] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:29:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:29:43] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[06:31:37] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:31:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:31:53] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[06:33:11] *** Joins: pnathan1 (Adium@moz-5EBBDD83.tukw.qwest.net)
[06:33:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:33:57] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:34:26] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[06:35:06] <klutzy> acrichto: latest mingw or old one? there were funky changes on pthread
[06:35:49] *** Quits: nfroidure (nfroidure@moz-C862FE50.w90-34.abo.wanadoo.fr) (Ping timeout)
[06:35:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:35:52] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[06:35:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:36:03] <eddyb> this is bullshit
[06:36:22] <eddyb> rusti: version
[06:36:22] -rusti- "rustc 0.8"
[06:37:16] *** Quits: moostik (Icedove@moz-63ED7231.w82-121.abo.wanadoo.fr) (Ping timeout)
[06:37:17] <eddyb> pcwalton, dbaupp, cmr: I'm looking at 2.5GB without monomorphization
[06:37:39] <dbaupp> eddyb: that's quite a lot
[06:37:46] <eddyb> this is way higher than rustc :(
[06:37:52] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:37:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:38:32] <eddyb> it's not hitting trans (not for anything large anyway) and it's still HUGE
[06:38:38] <cmr> eddyb: can I have the file? one of my spurious projects is rustc-memshrink
[06:39:07] <eddyb> I might have broken a record, unintentionally, with an auto-generated file :(
[06:39:09] <eddyb> woo, it died
[06:39:23] <eddyb> fish: Job 1, '~/Projects/rust/x*/stage1/bin/rustc disasm/arch-x86_16.rs' terminated by signal SIGABRT (Abort)
[06:39:37] <dbaupp> eddyb: how much ram do you have?
[06:39:43] <eddyb> (I'm happy because my laptop is unusable when it's running)
[06:39:46] <eddyb> dbaupp: 3GB
[06:40:00] <eddyb> 1GB of rustc's RAM usage goes into swap
[06:40:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:40:18] <eddyb> cmr: sure, let me gist it
[06:40:18] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:40:51] <dbaupp> eddyb: do you happen to have an equivalent auto-gen'd file in another language?
[06:41:04] <dbaupp> (if so, how much memory does compiling that eat?)
[06:41:12] <eddyb> barely anything
[06:41:29] <dbaupp> in C?
[06:41:33] <eddyb> and the JS version is larger because I haven't applied one of the optimizations
[06:41:41] <eddyb> dbaupp: this can't be written in C
[06:41:49] <eddyb> not without pain and suffering and tears of blood
[06:41:50] <dbaupp> oh, in JS?
[06:42:18] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[06:42:21] <eddyb> v8 has no problem with the large 10k file
[06:42:41] <dbaupp> it has a lot of matches, right?
[06:42:52] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:43:18] <eddyb> dbaupp: yupp. exactly one case per line, after the first 2k lines
[06:43:18] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:43:41] <eddyb> so it's something like 1-2k match cases (not a lot, in retrospective)
[06:44:00] <dbaupp> iirc, rustc is particularly bad at matches
[06:44:25] *** Joins: quiggle (Mibbit@moz-2034DBF7.jetstream.xtra.co.nz)
[06:44:26] <dbaupp> can you make it generate if's or is that ridiculous?
[06:44:32] <eddyb> keep in mind this never hits trans
[06:44:45] *** Quits: quiggle (Mibbit@moz-2034DBF7.jetstream.xtra.co.nz) (Quit: http://www.mibbit.com ajax IRC Client)
[06:44:54] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:44:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:45:09] <eddyb> so unless keeping track of numeric match cases is too much for rustc...
[06:45:19] <dbaupp> oh
[06:45:27] <dbaupp> maybe?
[06:45:30] * dbaupp shrugs
[06:45:44] <eddyb> why would it need more than 1MB for 1k cases?
[06:46:04] <eddyb> "The file /home/eddy/Projects/wIDE/modules/wiREd/disasm/arch-x86_16.rs was opened and contained lines longer than the configured Line Length Limit (8 192 characters)."
[06:46:41] <eddyb> I hope ix.io can hold it
[06:47:02] <eddyb> nope
[06:47:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:47:05] <pcwalton> eddyb: there's probably something stupid we're doing
[06:47:12] <pcwalton> I'm sure it's fixable
[06:47:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:48:33] <eddyb> at least it should be more obvious what's wrong, I'm not using as many features as librustc itself
[06:48:37] <eddyb> cmr, pcwalton: https://gist.github.com/eddyb/b802f5bdc4174e0fbf11/raw/5d61419bfbad6780414340ad98d52edf6f34329b/arch-x86_16.rs
[06:49:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:49:15] <pcwalton> aaaaaaaaa
[06:49:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:49:22] <pcwalton> what are you doing to the compiler ;)
[06:49:35] <eddyb> consider it a benchmark
[06:49:36] <dbaupp> eddyb: nice
[06:49:52] <dbaupp> eddyb: all handwritten, right? :P
[06:49:57] *** Quits: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (Ping timeout)
[06:50:05] <eddyb> can someone with more than 4GB of RAM try to compile it? I got an SIGABRT on my last try
[06:50:41] *** Joins: nfroidure (nfroidure@moz-72C6FB61.w90-34.abo.wanadoo.fr)
[06:51:13] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:51:13] <eddyb> dbaupp: yupp https://github.com/eddyb/wiREd/blob/master/disasm/x86.js#L195
[06:51:22] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:52:00] *** Joins: mib_hnv4xs (Mibbit@moz-21AB3946.dip0.t-ipconnect.de)
[06:52:18] <ChrisMorgan> That's the sort of thing where you start out by saying "hey, that's not... so—" then you get further down the file!
[06:52:47] <eddyb> ChrisMorgan: the runtime is pretty :D
[06:52:57] <eddyb> although it's also mostly auto-generated
[06:52:58] <pcwalton> LLVM is gonna have fun optimizing that IR :)
[06:53:01] <dbaupp> eddyb: what does _`...`(..) do?
[06:53:11] <pcwalton> I think several of its algorithms are superlinear
[06:53:12] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[06:53:15] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:53:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:53:34] <eddyb> dbaupp: _`...` is just a special case of f`...`, where _ and f are just functions
[06:53:50] <dbaupp> eddyb: what does `...` do in js?
[06:53:51] <eddyb> now, the awesome part.... `foobar` is a raw string in ES6
[06:54:05] <eddyb> `foo${x}bar` is a template (raw) string
[06:54:12] <eddyb> the value of x is interpolated
[06:54:51] <eddyb> f`foo${x}bar` is something like f(['foo', 'bar'], x), i.e. it interpolates/instantiates the template string using a function
[06:55:08] <dbaupp> oh
[06:55:19] <ChrisMorgan> Bah, debug info looks to be junk in arm-linux-unknown-gnueabi :-( Can't use GDB, it seems to get an infinite number of stack frames somewhere.
[06:55:25] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:55:54] <eddyb> traceur-compiler actually has support for partial parsing, you can do, e.g: parse`if(${cond}) {${block}}` where cond and block are ASTs
[06:56:03] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[06:56:11] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:56:13] <ChrisMorgan> For example, `#3  0x00015d4c in rt::task::begin_unwind::h933d19f3baf5f051aS::v0.0 ()` and every number after that as long as I care to take it is the same signature...
[06:56:17] <eddyb> I would love to see that in Rust, but it requires at least variadic functions
[06:56:31] <cmr> pcwalton: I'm 90% sure cfg stripping leaks AST nodes
[06:56:35] <cmr> "leaks"
[06:56:37] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[06:56:52] <pcwalton> wouldn't surprise me.
[06:57:11] *** Joins: fabiand (fabiand@moz-ADAFEF3A.adsl.alicedsl.de)
[06:57:32] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:57:37] <dbaupp> cmr: in what sense? the crate they came from doesn't get dropped?
[06:57:37] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[06:57:42] <eddyb> first 61 match blocks are actually in the runtime, interesting
[06:57:59] <eddyb> only 10 match blocks in dis
[06:58:08] <eddyb> with ~1k cases
[06:58:44] <dbaupp> eddyb: 1k each?
[06:58:51] <eddyb> cmr: if you feel like creating a smaller test case, you can remove any of the match blocks or cases in Disasm::dis
[06:58:54] <eddyb> dbaupp: 1k in total
[06:59:12] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[06:59:16] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[06:59:23] <eddyb> dbaupp: in chrome, Ctrl+F match, it's pretty neat
[06:59:34] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[06:59:44] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:59:55] <eddyb> the largest one starts at if ((((b[i] as u8) & 128u8 as u8) >> 7u8 as u8) & 0x1) == 0x1 {
[06:59:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:00:20] <eddyb> (it might help if I remove useless casts, but there's places where I need them :/)
[07:00:31] <Sharp> My internet is working but all DNS resolution is failing :(
[07:00:52] <eddyb> cmr: does it even compile?
[07:01:01] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[07:01:25] <cmr> dbaupp: in that memory usage should decrease after cfg stripping, but it only goes up.
[07:01:32] <cmr> (decrease or remain constant)
[07:01:46] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:01:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:02:14] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[07:02:54] <eddyb> I can't even test my own code :(
[07:03:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:04:25] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[07:04:37] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:05:05] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[07:05:24] <eddyb> I feel like I would have better luck working on those tuple extensions
[07:05:59] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:06:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:08:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:08:07] <eddyb> let _0 = U8Const((((b[i+2] as u8) & 56u8 as u8) >> 3u8 as u8) as u8);
[07:08:31] <eddyb> that's just stupid >_>
[07:09:00] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:09:15] *** Joins: alonlevy (alon@moz-C8A0236.bb.netvision.net.il)
[07:09:57] *** Quits: KindOne (KindOne@moz-7FE569E0.dynamic.ip.windstream.net) (Ping timeout)
[07:10:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:10:27] <acrichto> klutzy: I dunno, I just downloaded the "recent mingw" yesterday, but it seems to be working o now
[07:10:42] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:12:06] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:12:15] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:12:48] <cmr> eddyb: nope, coredump
[07:13:03] <eddyb> *great*
[07:13:14] <eddyb> cmr: backtrace?
[07:13:22] <cmr> eventually
[07:13:26] <eddyb> >_>
[07:13:35] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[07:14:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:14:14] *** Joins: KindOne (KindOne@moz-D386F8D6.dynamic.ip.windstream.net)
[07:14:19] <cmr> It dies after match checking but before liveness checking finishes
[07:14:20] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:14:56] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[07:15:23] <eddyb> biggest rust program to date *and* a superICE
[07:16:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:16:21] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:16:36] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[07:16:42] <cmr> looks like it's just an oom
[07:16:51] <eddyb> at 2.5GB?
[07:17:02] <cmr> https://gist.github.com/cmr/227eb6ec12faa57d3819
[07:17:06] <cmr> *shrug*
[07:17:18] <cmr> I only saw RES around 2G
[07:17:23] <cmr> memgraphing it now
[07:17:28] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:17:31] <eddyb> ah, malloc
[07:17:52] <eddyb> so the heap grows over MAX_INT
[07:18:07] <cmr> eh? no
[07:18:12] <cmr> malloc returned 0
[07:18:25] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:18:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:18:53] <eddyb> cmr: so what happened, sbrk failed?
[07:19:12] <eddyb> strace should work in this case, btw, it's not syscall intensive AFAIK
[07:19:14] <cmr> *fine*, I'll strace it
[07:19:26] <cmr> also nobody uses sbrk anymore
[07:19:29] <cmr> it's all mmap
[07:19:57] <eddyb> I was hoping it was something stupid. mmap failing is really bad
[07:20:12] <cmr> not really?
[07:20:14] <cmr> it's just oom
[07:20:23] <eddyb> cmr: how much free RAM did you have?
[07:20:26] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:20:31] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:20:39] <cmr> 14-15G
[07:21:02] <cmr> [pid 11286] mmap(NULL, 725222694912, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = -1 ENOMEM (Cannot allocate memory)
[07:21:02] <eddyb> so how could it be OOM? is there some default limit around 2GB that I don't know of?
[07:21:29] <eddyb> 0xa8daa42000
[07:21:32] <cmr> that's why
[07:21:34] <eddyb> is it trying to allocate that much?
[07:21:37] <cmr> yes
[07:21:40] <cmr> 725G
[07:21:45] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[07:21:57] <cmr> liveness is probably doing something bad
[07:22:21] <eddyb> middle::liveness::Visitor$LivenessVisitor::visit_fn hmmm
[07:22:32] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:22:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:23:36] <eddyb> https://github.com/mozilla/rust/blob/master/src/librustc/middle/liveness.rs#L364-L428
[07:24:01] *** Joins: Ms2ger (Ms2ger@moz-B6861E63.ibbt.be)
[07:24:13] <eddyb> what's the transmute doing? just for debug output?
[07:24:37] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:25:04] <eddyb> o_O you can have a function with the same name as a struct type? why haven't I seen that pattern before?
[07:25:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:25:29] <jdm> it used to be quite common
[07:25:46] <jdm> then we moved to impl StructName { fn new() -> StructName { ... } } instead
[07:26:02] <eddyb> I guess it needs to work for struct Foo(A, B, C);
[07:26:04] *** Quits: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP) (Quit: Computer has gone to sleep.)
[07:26:47] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:26:52] <eddyb> cmr: hmpf. I'm not seeing anything obvious, is it hard to create a debug stage1 rustc build?
[07:26:56] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:27:17] <klutzy> maybe transmute was for not printing internal elements but pointers only?
[07:27:30] <klutzy> interesting usage if so
[07:27:36] <eddyb> @~[CaptureInfo] uhmm, what?
[07:28:00] <eddyb> is that one of those things you should use Rc<~[T]> for?
[07:28:08] <cmr> eddyb: no, will do eventually.
[07:28:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:28:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:29:02] <eddyb> that value smells of overflow
[07:30:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:30:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:31:02] <eddyb> it's MAX_U64 / 25M, not that much of a correlation :(
[07:32:52] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:33:08] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:34:05] <eddyb> cmr: 108109 locals
[07:34:54] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:34:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:35:57] <eddyb> [09:35] <eddyb> << -1ull / 725222694912 / 108109
[07:35:58] <eddyb> [09:35] <geordi> 235
[07:37:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:37:08] *** Quits: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP) (Quit: )
[07:37:16] *** Quits: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:37:16] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:38:47] <eddyb> no, that still doesn't make sense :/
[07:39:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:39:10] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[07:39:21] <Heather> hey
[07:39:43] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:39:52] <Heather> how to know current absolute path?
[07:39:58] <Heather> of application
[07:40:25] <eddyb> Heather: the path to the binary or the current working directory?
[07:40:41] <Heather> eddyb binary
[07:40:55] <Heather> eddyb or both
[07:40:57] <eddyb> it's argv[0], try os::args()
[07:41:10] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:41:16] <Heather> ah thanks )
[07:41:19] *** Quits: dagnir (chatzilla@moz-AD50763C.hawaii.res.rr.com) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0.1/20131112160018])
[07:41:45] <eddyb> the other one is "current working directory", cwd
[07:42:22] <Heather> eddyb argv[0] is absolute?
[07:42:26] <cmr> No
[07:42:39] <Heather> that's problem
[07:42:52] <eddyb> cmr: I thought it was
[07:42:54] <cmr> no
[07:43:01] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:43:17] <dbaupp> Heather: http://static.rust-lang.org/doc/master/std/os/fn.self_exe_path.html
[07:43:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:43:38] <Heather> dbaupp why Option? )
[07:43:55] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:43:56] <cmr> Heather: it's not portable.
[07:44:03] <eddyb> Heather: what's with )? it shows up in most of your messages
[07:44:31] <Heather> eddyb it's smile...
[07:44:48] <eddyb> ) is just an unbalanced paren
[07:45:05] <eddyb> or an eyeless smiling face, but I'd rather not think of that
[07:45:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:45:32] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[07:46:19] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:46:53] <Heather> eddyb ... my hair close my eyes
[07:47:02] <eddyb> s/close/cover?
[07:47:14] <Heather> right, thanks for correction
[07:47:31] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:47:45] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:49:32] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:50:05] <eddyb> cmr: maybe an overflow *inside* HashMap?
[07:50:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:50:37] <cmr> Very much doubt it
[07:50:41] <cmr> But we'll see
[07:50:58] <cmr> eddyb: hashmap would be in the stacktrace
[07:51:18] <eddyb> because it's in std? but it's generic
[07:51:27] <cmr> no, because it's a function.
[07:51:34] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:52:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:52:29] <eddyb> the other option... allocating N*N instances for N local variables
[07:53:10] <eddyb> (62 * N * N, in this case)
[07:53:31] <cmr> more symbols: https://gist.github.com/cmr/227eb6ec12faa57d3819
[07:53:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:53:45] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:53:57] <eddyb> cmr: it's still inlined
[07:55:01] <eddyb> cmr: hmm, is there anything special about the assembly there?
[07:55:13] <cmr> Where?
[07:55:27] <eddyb> 0x00007ffff5ceeb43
[07:55:33] <cmr> eddyb: none of the map methods are inlined.
[07:55:47] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:55:49] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:55:52] <eddyb> seeing how it computes the size to allocate might make it obvious
[07:56:44] <eddyb> (intel syntax would be great. I wish I had that exact librustc.so to check myself)
[07:57:15] <eddyb> I don't see how N*N would be allocated all at once, though
[07:57:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[07:57:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:58:01] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[07:59:10] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[07:59:38] <eddyb> users: @mut vec::from_elem(ir.num_live_nodes * ir.num_vars, invalid_users()),
[07:59:53] <eddyb> cmr: ^ that's my #1 suspect right now
[07:59:55] <cmr> https://gist.github.com/cmr/cf26877eabf3aa05e214
[08:00:09] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:00:12] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:00:39] *** Joins: peterdn (chatzilla@moz-30BAAE88.as13285.net)
[08:00:59] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[08:01:11] <eddyb> cmr: I can see an optimized division there
[08:02:15] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:02:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:03:08] <eddyb> hmm, Users is just three words, max
[08:03:26] <eddyb> more like 17 bytes
[08:04:17] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:04:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:05:08] *** Joins: victorporof (victorporo@79FE7CA6.284D02A8.D111398B.IP)
[08:05:41] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[08:06:18] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:06:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:06:50] <eddyb> cmr: one way to check this is to add a line here https://github.com/mozilla/rust/blob/master/src/librustc/middle/liveness.rs#L596 - println!("(liveness) live_nodes={} num_vars={}" ir.num_live_nodes, ir.num_vars);
[08:07:09] <cmr> eddyb: debug!(), you fool!
[08:07:16] <eddyb> I wouldn't enable RUST_LOG if I were you
[08:07:23] <cmr> It's fine
[08:07:34] <cmr> RUSTLOG=rustc::middle::liveness::Liveness=4
[08:07:42] <eddyb> oh, that's a neat trick :D
[08:08:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:08:26] <derek_c> can someone explain to me what's the motivation for move semantics?  What problems does it try to solve?
[08:08:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:08:30] *** Joins: puritylake (Mibbit@moz-FF993AD8.b-ras1.mlw.mallow.eircom.net)
[08:08:40] <cmr> derek_c: use after free.
[08:08:57] <derek_c> cmr: could you elaborate?
[08:09:25] <cmr> derek_c: if you own something, you are responsible for freeing it.
[08:10:03] <cmr> fn foo(x: T), foo(bar), bar is moved into foo's stack frame.
[08:10:15] <cmr> foo free's it and runs the destructor
[08:10:16] <derek_c> and thus foo is responsible for freeing it?
[08:10:18] <eddyb> cmr: if this is the problem, users should be a HashMap<(LiveNode, Variable), Users>, and this https://github.com/mozilla/rust/blob/master/src/librustc/middle/liveness.rs#L696-L698 should return (ln, var)
[08:10:19] <cmr> if you try to access bar, it's invalid.
[08:10:22] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:10:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:10:48] <derek_c> ok. so what if I actually want to use bar after foo(bar)? I use a borrowed pointer?
[08:11:00] <cmr> Yes
[08:11:13] <eddyb> cmr: I'm curious what impact that change would have on benchmarks and are-we-slim-yet
[08:11:27] <cmr> eddyb: adding a line of debugging?
[08:11:41] <eddyb> cmr: changing the repr of Liveness::users
[08:12:24] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:12:24] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:12:45] <eddyb> librustc doesn't get hit by this because it doesn't have a hundred thousand locals in one function
[08:12:50] <cmr> eddyb: according to the data, liveness allocates approximately 0 memory
[08:13:03] <eddyb> lol
[08:13:43] <eddyb> I think I know how to trigger it
[08:14:13] *** Quits: puritylake (Mibbit@moz-FF993AD8.b-ras1.mlw.mallow.eircom.net) (Quit: http://www.mibbit.com ajax IRC Client)
[08:14:24] <derek_c> cmr: could you tell me what's wrong with this code? http://upl.io/ydoadb
[08:14:32] <derek_c> am I not using a borrowed pointer?
[08:14:47] <cmr> derek_c: rustc version?
[08:15:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:15:02] <derek_c> 0.9 pre
[08:15:02] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:16:14] <derek_c> cmr: this is the error: http://upl.io/x89tm6
[08:16:58] <cmr> derek_c: I don't know the status of closures atm.
[08:17:17] <eddyb> node -e 'var o=process.stdout;o.write("fn main(){let x=0u32;");for(var i=0;i<10000;i++)o.write("let x=x+1;");o.write("}\n");' | ~/Projects/rust/x*/stage1/bin/rustc -
[08:17:22] <cmr> derek_c: but you should be using || -> int, not &fn() -> int
[08:17:28] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:17:37] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:18:18] <derek_c> cmr: seems like both work if I only have one call to print_func
[08:18:28] <cmr> derek_c: &fn is going away.
[08:18:32] <cmr> ie will stop existing
[08:19:02] <derek_c> cmr: ok. regardless though, how do you call print_func twice with the closure?
[08:19:27] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[08:19:32] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:19:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:19:56] <cmr> derek_c: no idea, I still don't really understand closures myself.
[08:20:01] * cmr doesn't use them very much
[08:20:33] <derek_c> kk I see. anyone has an idea?
[08:20:56] <cmr> http://ix.io/96L
[08:20:58] <cmr> works
[08:21:30] *** Quits: peterdn (chatzilla@moz-30BAAE88.as13285.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[08:21:34] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:21:48] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:21:58] *** Joins: lomereiter (Mibbit@DCA86D02.F87CE5B3.F3172E58.IP)
[08:22:09] *** flaper87|afk is now known as flaper87
[08:23:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:24:15] <derek_c> cmr: very interesting.  thanks a lot.  I'm thinking about what's the lesson here
[08:24:28] <cmr> derek_c: the lesson, I think, is "closures are weird"
[08:24:28] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:24:38] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:24:38] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:25:00] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:25:38] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:25:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:25:57] <derek_c> cmr: on a side note, do you know why &fn is going away?
[08:26:23] <cmr> derek_c: it's the same as ||
[08:26:25] <cmr> part of closure reform.
[08:26:25] <derek_c> so if you use the || syntax, can you still give it a normal function, rather than a closure?
[08:26:46] *** Quits: z0w0 (zack@moz-5E840EF3.lns3.woo.bigpond.net.au) (Client exited)
[08:27:06] <derek_c> cmr: ^
[08:27:10] <cmr> derek_c: no
[08:27:12] <cmr> Well, yes.
[08:27:16] <cmr> fn gets coerced to it.
[08:27:22] <derek_c> ok, so that's cool
[08:27:40] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:27:49] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:29:31] <lomereiter> hi, what is the supposed way of iterating over character range? std::iter::range requires of-course-nonexistent Add<char, char> =\
[08:29:41] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:29:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:30:25] *** Joins: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net)
[08:30:57] *** Joins: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP)
[08:31:02] <TeXitoi> rusti: for c in range('0' as u8, '9' as u8) {let c = c as char; print!("{}", c);}
[08:31:10] <derek_c> does anyone know where the "write!" comes from in this code? http://static.rust-lang.org/doc/master/src/extra/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libextra/json.rs.html#100
[08:31:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:31:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:31:50] <lomereiter> ah, thanks, got it
[08:31:56] <TeXitoi> rusti is sleeping?
[08:32:10] <TeXitoi> lomereiter: not so great, but works
[08:32:48] *** Joins: eddyb (eddyb@336E3A7F.D51DAF03.FB866788.IP)
[08:33:07] <eddyb> I have to use my old PC, since my phone is dead
[08:33:21] <cmr> derek_c: what do you mean where?
[08:33:31] <eddyb> cmr: that 10k "let x = x+1" testcase worked. it worked too well
[08:34:19] *** Quits: jesse98 (jjones@6251EDC2.15651213.B46B86FA.IP) (Connection reset by peer)
[08:34:20] <eddyb> cmr: so it's quadratic when it should be linear
[08:34:22] <derek_c> cmr: oh, I mean like, where is it defined?
[08:34:40] <TeXitoi> derek_c: http://static.rust-lang.org/doc/master/std/fmt/index.html ?
[08:34:47] *** Quits: lomereiter (Mibbit@DCA86D02.F87CE5B3.F3172E58.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:35:03] *** Joins: jesse98 (jjones@6251EDC2.15651213.B46B86FA.IP)
[08:35:58] <derek_c> TeXitoi: ah!
[08:36:02] <derek_c> thanks :)
[08:36:14] <eddyb> cmr: do you have node.js installed? I'm curious what the same testcase with just 1000 repeats does
[08:36:43] <cmr> eddyb: I do
[08:37:01] <eddyb> whenever eddyb_ joins, I'll be able to use my laptop again :P
[08:38:16] <eddyb> I'm afraid of just changing it to a HashMap since the vector is faster, it just uses too much memory for larger numbers of variables
[08:39:01] <eddyb> cmr: for 1k locals: node -e 'var o=process.stdout;o.write("fn main(){let x=0u32;");for(var i=0;i<1000;i++)o.write("let x=x+1;");o.write("}\n");' | rustc -
[08:40:24] <eddyb> hmm, if it's using 17MB, it might not be obvious. but 10k is already 1.7GB. 5k locals would be a good compromise, I guess
[08:40:57] <eddyb> with 5k, it would end up using ~500MB in liveness
[08:42:39] *** Joins: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP)
[08:42:44] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[08:43:06] *** Quits: tikue_ (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net) (Quit: tikue_)
[08:43:35] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:43:43] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[08:43:48] *** Parts: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) ()
[08:44:56] <g3xzh> hi there, can anybody help me?
[08:45:16] <g3xzh> i have a question regarding the buildbot
[08:45:17] <cmr> eddyb: that compiled fine
[08:45:25] <cmr> eddyb: what number do you want me to use instead?
[08:45:30] <cmr> g3xzh: sure, what's up?
[08:45:50] <eddyb> cmr: 5000, the memory usage should be visibly high
[08:45:58] <Sharp> Wait, eddyb, what are you trying to do?
[08:46:22] <eddyb> Sharp: show that liveness uses quadratic space when it can do with linear
[08:46:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:46:45] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:46:48] <cmr> eddyb: yes, it is.
[08:46:53] <Sharp> Ah.
[08:46:57] <g3xzh> cmr: i have seen that the build failed because of my changes and wanted to know how to fix it. but i don't find any "error" in the logs
[08:46:58] <Sharp> I imagine it's a speed thing.
[08:47:21] <eddyb> memory usage blows up (ahem, attempting to allocate 700+GB) with a really large number of locals
[08:47:39] <cmr> g3xzh: link?
[08:48:01] <g3xzh> cmr: http://buildbot.rust-lang.org/builders/auto-linux-64-opt/builds/2583
[08:48:02] <Sharp> Can't conversion to SSA result in quadratic space explosion in theory?  Or am I confusing it with something else?
[08:48:16] <eddyb> Sharp: I wonder if the current (i * n + j) idx (using a vector like a C matrix) could be used as a hash for a HashMap
[08:48:50] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:48:50] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[08:49:08] <eddyb> Sharp: in this case, it connects variables with users, and I found a worst case for it (each variable having one user, with lots of variables and users) :P
[08:49:27] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[08:49:46] <eddyb> hmm, what about ~[~[]]?
[08:50:09] <Sharp> I think there are a few known pathological expressions like that
[08:50:15] <eddyb> but I'd have to talk to nmatsakis and try some perf tests to see how I should do that
[08:50:19] <Sharp> But in practice people dont' write them very often
[08:50:37] *** Joins: Jackneill (Jackneill@moz-5FBD4CA5.pool.digikabel.hu)
[08:50:55] <Sharp> What's the problem with preallocating a vector?
[08:51:00] <g3xzh> cmr: trailing whitespace? could it be the space at line 3922?
[08:51:32] <eddyb> Sharp: IMO the current implementation looks like a hack. if I can clean it up and fix these pathological cases, without impacting speed (and maybe slightly reducing memory usage), that would be great
[08:51:39] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[08:51:49] <eddyb> Sharp: it's preallocating N*N (uint, uint, bool)s
[08:52:00] <eddyb> or N*M, with N~M
[08:52:22] <Sharp> Maybe that makes interference very simple to calculate?
[08:52:54] <eddyb> Sharp: all accesses to that vector are C-matrix-like v[i*N+j]
[08:53:11] <Sharp> Where i < m?
[08:53:34] <eddyb> yeah
[08:54:01] <Sharp> The problem, I think, is that theoretically for optimal hash filling don't you need the ratio of filled:unfilled space to be around sqrt(n) anyway?
[08:54:22] <Sharp> Which suggests to me it would be very hard to find a better hashing scheme in general.
[08:54:47] <Sharp> Er, or rather, you need to have about sqrt(size of hash) filled.
[08:56:37] <derek_c> can someone tell me how to fix this code? http://upl.io/04h7qb
[08:57:05] <derek_c> error: mismatched types: expected `@mut std::io::Writer:'static` but found `std::io::stdio::StdWriter` (expected trait std::io::Writer but found struct std::io::stdio::StdWriter)
[08:57:26] *** Joins: refold (gman@moz-42D68426.a258.priv.bahnhof.se)
[08:57:42] <Sharp> You could get better space and sacrifice time with a balanced binary tree or something but in the general case (not a lot of locals) that would be very suboptimal.
[08:57:49] <Sharp> You might be able to do something with radix?
[08:58:30] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[08:58:47] *** Joins: Ferreus (ferreus@moz-2D8270FB.dip0.t-ipconnect.de)
[08:59:11] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[09:00:25] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:00:58] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:02:46] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[09:03:28] *** Joins: moostik (Icedove@moz-63ED7231.w82-121.abo.wanadoo.fr)
[09:03:52] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:06:31] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[09:10:08] <derek_c> can someone tell me what's wrong with line 24? http://upl.io/iwkx3f
[09:10:47] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[09:11:00] <eddyb> my laptop must be lost :(
[09:11:13] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[09:11:33] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:13:07] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:13:09] *** Quits: flowsnake (flowsnake@moz-E4E567EE.aztw.cable.virginm.net) (Ping timeout)
[09:15:53] *** Joins: peterdn (chatzilla@moz-30BAAE88.as13285.net)
[09:16:34] *** Joins: flowsnake (flowsnake@moz-E4E567EE.aztw.cable.virginm.net)
[09:16:50] <eddyb> cmr: it's alive! 5.3GB of swap, though
[09:17:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:17:22] <cmr> eddyb: (liveness) live_nodes=279477 num_vars=108122
[09:17:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:17:52] <eddyb> cmr: thanks. now we (I?) know what to fix, just not sure how
[09:18:13] <cmr> (definitely not me :p)
[09:18:19] <cmr> eddyb: nice catch though!
[09:18:22] <eddyb> pffft, 1h and 5-6GB for the 10k thing, it's bad :(
[09:19:05] <Sharp> So your thought is basically to switch schemes when it hits 5k?
[09:19:21] <eddyb> 5k is at least half a GB
[09:19:22] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:19:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:19:57] <Sharp> In theory it might be nicer to scale it to the available memory, I don't know how hard that would be though (or how worthwhile).
[09:20:03] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[09:20:40] <eddyb> Sharp: I'm considering binary space partitioning
[09:20:59] <eddyb> or radix space partitioning (is that a thing? I have no fucking clue)
[09:21:11] *** Joins: amro (quassel@moz-17EA8511.customers.ownit.se)
[09:21:14] <eddyb> since it's a sparse matrix
[09:21:14] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[09:21:24] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:21:59] <Sharp> I like radix a lot of fast, relatively compact identifier trees
[09:21:59] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:22:47] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[09:23:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:23:43] <eddyb> Sharp: what would you index by? it's a matrix :/
[09:24:21] <Sharp> Yeah, that's the tricky bit :P  But given that it's a matrix of numeric types, I don't know if it would be too bad...
[09:24:22] <eddyb> if you use (i*n+j), then it might be better to go with ~[~[Users]]
[09:24:25] <Sharp> I was thinking about interleaved bits.
[09:24:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:24:32] <eddyb> Sharp: heh, me too
[09:24:41] *** Joins: _eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP)
[09:24:49] <eddyb> _eddyb_: hello, dear laptop
[09:24:52] <Sharp> There may be some obvious problem with that I'm not seeing?
[09:25:30] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:25:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:25:36] <Sharp> Realistically if you have 4 billion variable assignments I don't think the compiler is obligated to support you at that point.
[09:26:01] <cmr> Sharp: it's only 100k
[09:26:07] <cmr> And we *need* to support it.
[09:26:13] <eddyb> 5k is not that big of a number, though, and it still uses waay to much memory
[09:26:17] <cmr> Compiler bugs like this aren't acceptable.
[09:26:19] <Sharp> cmr: I meant the point where you couldn't store a pair of 32 bit integers.
[09:26:24] <cmr> Sure
[09:26:25] <Sharp> Not 100k :P
[09:26:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:26:31] <cmr> Oh I see
[09:26:33] <cmr> Yes
[09:26:35] * cmr is distracted
[09:27:02] <eddyb> cmr: I wonder if there's more than one instance of quadratic space used for efficiency
[09:27:10] <cmr> eddyb: I don't doubt there isn't
[09:27:31] *** Quits: _eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[09:27:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:27:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:27:49] *** Quits: derek_c (derek@moz-10A72C28.cit.cornell.edu) (Quit: Leaving)
[09:27:55] <eddyb> it still hasn't freed any of that memory yet, there's just times where the IRC client can run
[09:28:01] <eddyb> s/where/when
[09:29:32] <eddyb> cmr: egrep '::\w+\([^)]* \* [^)]*\)' -r src/librustc
[09:29:38] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:29:47] <Sharp> eddyb: http://www-graphics.stanford.edu/~seander/bithacks.html#InterleaveBMN ?
[09:29:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:30:01] <Sharp> (Extended to 32 bits).
[09:30:14] *** Quits: Kxepal (Miranda@moz-E7A71549.pppoe.mtu-net.ru) (Ping timeout)
[09:31:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:31:51] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:32:40] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[09:33:32] *** Joins: Kxepal (Miranda@moz-68A931EE.pppoe.mtu-net.ru)
[09:33:36] <eddyb> cmr: do you have the time/courage to compile librustc with that debug output? then sort descending by either variables or uses, it would be good to know what the worst case is inside librustc itself
[09:34:19] <strcat> http://static.rust-lang.org/doc/master/tutorial.html#ownership-escape-hatches no more managed boxes section.
[09:34:21] *** Quits: victorporof (victorporo@79FE7CA6.284D02A8.D111398B.IP) (Ping timeout)
[09:34:26] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:34:27] <strcat> still need to purge them all over the place, I guess
[09:34:28] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[09:34:35] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:35:26] *** Joins: _eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP)
[09:36:10] *** Quits: amro (quassel@moz-17EA8511.customers.ownit.se) (Client exited)
[09:36:33] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:36:36] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:36:49] <eddyb> mozilla might be owing me a laptop HDD soon, if the swap partition starts failing
[09:37:21] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[09:38:07] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[09:38:20] <dbaupp> strmpnk: \o/
[09:38:34] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:38:36] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:38:39] <dbaupp> strmpnk: oh, sorry. that was at strcat.
[09:38:44] <_eddyb_> haha, it's printing the huge 10k let x = x+1; line, and then a line of the same length, for unused variable warnings
[09:39:02] <_eddyb_> fucking glad it's over
[09:39:14] <dbaupp> _eddyb_: _ prefix each variable?
[09:39:16] <_eddyb_> I ain't doing that again until it's fixed
[09:39:27] <_eddyb_> dbaupp: not each, just the last one, all others are chaining
[09:39:43] <_eddyb_> (so they are actually used)
[09:39:49] *** _eddyb_ is now known as eddyb_
[09:40:52] <dbaupp> oh, I see
[09:40:53] <eddyb_> but the darn thing compiled fine otherwise
[09:41:05] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:41:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:42:45] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[09:43:09] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:43:11] <eddyb_> cmr: hahaha, no optimizations, so it actually generated 10k: mov [rbp-i], eax; mov eax, [rbp-i]; add eax, 0x1; (with i increasing by 4 after each one)
[09:43:51] *** Quits: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[09:43:51] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:44:25] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[09:44:26] <strcat> eddyb_: it might not have taken along if you used optimization then ;p
[09:44:39] <strcat> at least, --opt-level=1
[09:45:00] <Sharp> strcat: Isn't liveness analysis done before optimization takes effect?
[09:45:15] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:45:19] <strcat> oh this is about liveness?
[09:45:24] <Sharp> Yeah.
[09:45:24] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:45:30] <cmr> strcat: yeah. liveness does stupid things with very large numbers of locals
[09:45:33] <strcat> ah then you're screwed.
[09:45:40] <eddyb_> quadratic space usage :(
[09:46:08] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:46:22] <eddyb_> strcat: swap went up to 5-6GB, and this laptop was unusable for 1h30m
[09:47:05] <eddyb_> with "just" a simple 10k locals testcase
[09:47:17] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:47:20] *** eddyb is now known as eddyb[pc]
[09:47:23] <cmr> eddyb_: http://ix.io/96N
[09:47:24] <cmr> eddyb_: have some data
[09:47:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:47:48] *** eddyb_ is now known as eddyb
[09:47:52] <eddyb> cmr: thanks a lot :D
[09:48:09] <cmr> uh, there's some junk lines in there
[09:48:13] <cmr> but it's fine
[09:49:01] <cmr> (overall it's fine data, that is)
[09:49:18] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:49:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:49:59] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[09:50:04] *** Quits: peterdn (chatzilla@moz-30BAAE88.as13285.net) (Ping timeout)
[09:51:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:51:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:51:51] <eddyb> cmr: largest allocation is 175010 * size_of::<Users>()
[09:52:13] <eddyb> that's just a few MBs at most
[09:52:57] <eddyb> 2321979 in total, which is between 32MB and 64MB
[09:53:22] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:53:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:53:33] <eddyb> it's larger than I thought, but not a serious problem (for librustc)
[09:53:58] <eddyb> cmr: any "standard" way to compare compilation times after a change?
[09:54:18] <cmr> eddyb: what do you mean by standard?
[09:54:34] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:54:47] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[09:54:51] <cmr> eddyb: usually librustc or libstd are used for simple benchmarking of changes
[09:55:21] <eddyb> I mean, is there a system somewhere to make this easier and reliable?
[09:55:21] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[09:55:21] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[09:55:23] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:55:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:55:43] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[09:56:03] <cmr> nope
[09:56:15] <eddyb> since compilation times can differ for the same code, depending on CPU load and available memory, in an uncontrolled environment
[09:57:27] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:57:36] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[09:58:01] <eddyb> cmr: remember my egrep? only that one occurence in liveness seems to match. need something smarter
[09:59:01] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[09:59:09] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[09:59:38] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[09:59:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:00:32] <cmr> eddyb: nothing matched for me..
[10:01:34] <eddyb> cmr: because it's split on two lines, if you remove everything after \* it will have some results
[10:01:40] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:01:49] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:01:58] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[10:02:35] <cmr> ah
[10:02:52] <eddyb> vec::from_elem isn't called with non-linear immediate size in other places, it seems
[10:03:41] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:03:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:05:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:05:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:06:53] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[10:07:36] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[10:07:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:07:49] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:09:43] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[10:10:54] <eddyb> ooold coooode https://github.com/mozilla/rust/blame/29f32b4a7298b0807408658bc8add1de8a06ab12/src/rustc/middle/liveness.rs
[10:11:36] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[10:12:05] <cmr> yup
[10:12:52] <Sharp> Wait, is it just doing union find?
[10:13:10] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[10:13:13] <Sharp> Like, does the index not actually matter?
[10:13:39] <Sharp> Because union find data structures can have much nicer representations than this.
[10:14:11] <eddyb> Sharp: oh, let me check
[10:15:43] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[10:19:31] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[10:20:14] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[10:20:17] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[10:21:07] <eddyb> Sharp: there's a lot of operations working with indexes, but I'm not sure yet
[10:21:19] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[10:21:49] <Sharp> Working with, sure, but if the order doesn't matter and they're effectively sets and points, you should be good.
[10:22:39] *** Quits: heftig (heftig@moz-D9FCE6C3.dip0.t-ipconnect.de) (Quit: Quitting)
[10:23:24] <eddyb> the key matters, not sure about the order
[10:23:45] <Sharp> https://github.com/ParkerK/Tigpiler/blob/master/RegisterAllocation/liveness.sml is a liveness implementation that explicitly uses sets.
[10:24:06] <Sharp> So I'm pretty sure it's possible (though I won't vouch for the industrial strength memory efficiency of that version).
[10:24:53] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[10:24:56] <eddyb> Sharp: it's a Map<(LiveNode, Variable), Users>
[10:26:16] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Client exited)
[10:26:24] <Sharp> Sure, but isn't "variable" essentially a set?
[10:26:52] <eddyb> LiveNode and Variable are newtypes of uint
[10:27:11] <eddyb> Sharp: hmm, it could be a Set<(LiveNode, Variable, Users)>
[10:27:32] <eddyb> the problem is that it's used as a Map
[10:27:57] <Sharp> You could rewrite the file :)
[10:27:58] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[10:29:16] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[10:29:33] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Client exited)
[10:29:48] <eddyb> Sharp: things like these would be O(lg N) at best instead of O(1) with a set https://github.com/mozilla/rust/blob/master/src/librustc/middle/liveness.rs#L715-L718
[10:30:07] *** Joins: nkoep (nik@moz-9466F5D6.pool.mediaways.net)
[10:30:14] <Sharp> Hashes aren't really O(1) anyway :P  But I'm actually not suggesting you use that implementation of set.
[10:30:28] <Sharp> I'm suggesting that, if you can get away with using a union find algorithm, you'll have much better performance than that
[10:30:35] <Sharp> http://en.wikipedia.org/wiki/Disjoint-set_data_structure
[10:34:49] <eddyb> Sharp: need moar brain
[10:34:55] *** kimundi is now known as zz_kimundi
[10:35:05] *** Quits: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP) (Quit: Textual IRC Client: www.textualapp.com)
[10:36:39] <Sharp> I actually got an old compiler book out to check out what it had to say about this but it leaves it at "it would be inadvisable to use bit vectors for dataflow problems where the sets are expected to be very sparse (so the bit vectors would be almost all zeros), in which case a different implementation of sets will be faster"
[10:36:48] <Sharp> But doesn't present any alternatives :P
[10:38:32] *** Quits: matt-r (mattr@8B499E37.E81D922B.BECC6F7D.IP) (Ping timeout)
[10:38:46] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[10:39:20] *** Joins: matt-r (mattr@8B499E37.E81D922B.BECC6F7D.IP)
[10:39:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:39:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:40:09] *** Quits: SingingBoyo (brandon@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[10:40:17] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[10:40:37] <eddyb> a lot of things require random access in the current implementation, and I don't see how that disjoint-set thing would help. but I can't think :(
[10:40:38] <Sharp> Ah, yeah, disjoint set won't work :(  I guess that would have been too easy.
[10:40:51] <Sharp> Not because of random access requirements though.
[10:41:41] <nmatsakis> are you guys talking about the bitsets we use in the compiler?
[10:41:49] <nmatsakis> I've got some work on refactoring all that stuff in a drastic way
[10:41:52] <nmatsakis> so i'd not advise editing it :)
[10:41:55] <pnkfelix> nmatsakis: they're looking at liveness.rs
[10:42:07] <nmatsakis> ok. i'd not advise editing it.
[10:42:10] <Sharp> Heh.
[10:42:27] <nmatsakis> well, liveness.rs I'll prob wind up rewriting completely
[10:42:33] <nmatsakis> so that one is ok :)
[10:42:34] <eddyb> nmatsakis: did you see what's going on, or do you need debriefing?
[10:42:41] <Sharp> Looking at it I think that's probably necessary :D
[10:43:07] <eddyb> nmatsakis: I have some nifty DDoS tricks :P
[10:43:16] <eddyb> s/DD/D/
[10:43:28] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[10:43:31] <Sharp> nmatsakis: What are the new bitsets going to look like?
[10:43:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:43:45] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:44:02] <nmatsakis> the biggest change is to build up a CFG,
[10:44:12] <nmatsakis> which will contain dense indices and so on.
[10:44:16] <Sharp> Oh, awesome!
[10:44:22] <Sharp> That should solve this sort of problem.
[10:44:24] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:44:37] <mmalecki> hi, are there any libraries for using https in rust?
[10:44:37] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:44:39] <Sharp> (I assume we'll also do iterative dead code elimination and so on).
[10:44:51] <nmatsakis> unlikely, llvm handles it.
[10:45:01] <nmatsakis> eddyb: funny thing is that liveness.rs only exists for warnings, I believe
[10:45:05] <Sharp> It's recommended as a way to speed up the compiler, moreso than a code optimization.
[10:45:08] <nmatsakis> at this point.
[10:45:10] <mmalecki> or any openssl bindings?
[10:45:16] <eddyb> offtopic: there's been an influx of programming jokes lately: http://9gag.com/gag/aG9pXZG
[10:45:22] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[10:45:25] <nmatsakis> Sharp: I don't think that applies in our situation
[10:45:37] <nmatsakis> Sharp: I don't think dead code is a common occurrence at the high-level IR we are working with
[10:45:49] <jdm> mmalecki: yes, there are some open PRs to rust-http
[10:45:49] <Sharp> Fair enough :)
[10:46:01] <eddyb> nmatsakis: hehe, I saw something about warnings, but... OOOOH
[10:46:07] <jdm> mmalecki: https://github.com/chris-morgan/rust-http/pull/31
[10:46:34] <eddyb> nmatsakis: borrowck also checks for read-before-write and other cases like that, right?
[10:46:49] <mmalecki> eddyb: if you enjoyed this, you'll also enjoy: http://www.youtube.com/watch?v=RnqAXuLZlaE ;)
[10:46:52] <cmr> nmatsakis: the liveness warnings are super useful, and I'd be sad to see them go, so please don't ;p
[10:46:55] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[10:46:57] <nmatsakis> eddyb: though I wouldn't be so surprised if you hit scaling problems elsewhere too? I'd be curious to know. I plan to rework the dataflow propagation in borrowck as well, it might have similar problems. 
[10:47:01] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:47:10] <nmatsakis> cmr: I wasn't planning to remove them outright, just to base the code on a CFG, which would make it much simpler.
[10:47:10] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:47:13] <cmr> mm
[10:47:23] <eddyb> nmatsakis: does borrowck use exponential space anywhere?
[10:47:57] <Sharp> I sure hope not :)
[10:48:07] <eddyb> mmalecki: heh, I knew that one
[10:48:07] <mmalecki> jdm: awesome, thanks! /me tries it out
[10:48:27] <cmr> nmatsakis: frankly I'm surprised it doesn't use a CFG already
[10:48:42] <nmatsakis> cmr: there was some...resistance to the idea. it's a long story.
[10:48:54] <cmr> afaik it was due to clarity of error messages, right?
[10:49:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:49:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:49:41] <eddyb> strcat: omg omg iterators :P
[10:50:00] <strcat> eddyb: well a tiny bit of it for now
[10:50:16] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:50:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:50:49] <eddyb> strcat: why am I seeing module-level functions instead of methods?
[10:50:53] <eddyb> len, iter, etc.
[10:51:13] <strcat> eddyb: because that's what they are going to be until methods can be defined on built-ins
[10:51:32] <Sharp> Is there an intrinsic problem with module level functions?
[10:51:48] <Sharp> Like, is it considered bad Rust style?
[10:52:08] <eddyb> Sharp: when they can be methods, they should be methods, I would think
[10:52:18] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:52:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:52:47] <strcat> they can't be methods though
[10:52:52] <strcat> unless you make a bunch of useless traits
[10:52:56] <eddyb> strcat: but you can impl Container<T> for &[T] {fn iter(&self) -> Iterator<T>{....
[10:53:04] <eddyb> not that useless :)
[10:53:14] <strcat> design a proper Iterable trait then
[10:53:19] <strcat> not all containers have iterators
[10:53:26] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[10:53:29] <eddyb> riiight
[10:53:50] <eddyb> strcat: ooh, Iterable could have default methods for the adaptor iterators
[10:53:51] <Sharp> In any case, self can't be null in Rust and methods have no more knowledge of the inner workings of a struct than a module function, so it seems to me there are not many advantages to methods :P
[10:53:52] <strcat> I'm not making 200 useless traits implemented by one type like the stdlib
[10:54:01] <strcat> and I'm not making traits until they're used for code reuse
[10:54:19] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:54:31] <strcat> fixing built-in types wouldn't be that hard
[10:54:45] <eddyb> so you can do [1, 2, 3].map(|&x| x*x), without the extra .iter()
[10:54:57] <Heather> Added ability to process custom build scripts after VCS actions to mirana so I feel like it's somehow alike multibuilder now... And what that means.... That means now I need to review and steal multibuilder code I miss to owerpower it ....
[10:54:57] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:55:51] <cmr> Heather: you mean the multibuilder I use for rust?
[10:55:54] <eddyb> cmr, nmatsakis: any way to disable liveness?
[10:56:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:56:21] *** Quits: jdm (jdm@moz-99690620.hinet-ip.hinet.net) (Quit: Lost terminal)
[10:56:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:56:51] <cmr> eddyb: remove it from librustc/driver/driver.rs, line 290-292
[10:57:01] <cmr> I don't *think* it makes structures other parts of the compiler use.
[10:57:10] <eddyb> cmr: thanks :D
[10:58:23] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[10:58:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[10:58:44] <nmatsakis> I believe that is correct,
[10:59:28] <nmatsakis> all of its crucial function has been moved to borrowck
[10:59:31] <nmatsakis> eddyb: cmr ^
[11:00:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:00:38] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:02:35] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:02:35] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:03:00] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:03:03] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:04:42] <eddyb> cmr: I'm not seeing the big allocation with strace
[11:05:11] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:05:13] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:05:24] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[11:05:37] *** Joins: andre (andre@CA528A4A.45A4338E.8EE27E6.IP)
[11:05:39] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[11:05:53] <strcat> eddyb: probably a lot of little ones, then
[11:06:18] <cmr> strcat: there was a 725G mmap attempt
[11:06:22] <cmr> :p
[11:06:30] <eddyb> strcat: just two significant ones (in MBs), and they are the same for 4k and 5k
[11:06:51] <eddyb> which would allocate 16M objects and 25M objects
[11:07:13] <eddyb> the allocation happens, it's either not mmap, I'm using strace wrong, or something else
[11:07:16] <eddyb> time: 13.945 s  expansion
[11:07:17] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:07:20] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:07:22] <eddyb> what's expansion?
[11:07:30] <strcat> macro expansion?
[11:07:32] <cmr> macro expansion
[11:07:35] <cmr> yes
[11:07:52] <eddyb> then why does it take so long just because I have 5k "let x = x+1;"?
[11:08:00] <cmr> Good question!
[11:08:04] <eddyb> that should be fixed
[11:08:23] <eddyb> at least something good came out of my crazy codegen output
[11:08:23] <cmr> Probably a very silly inefficiency during traversal.
[11:09:18] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:09:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:09:29] <eddyb> o_O all mmap calls happen while parsing
[11:09:35] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[11:09:40] <eddyb> (including 15MB and 25MB)
[11:10:02] *** Joins: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP)
[11:10:05] <Sharp> Makes sense.
[11:10:21] <eddyb> well, it could be somethin - I know what those are
[11:10:40] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[11:10:46] *** pmoore|away is now known as pmoore
[11:10:51] <eddyb> -rwxr-xr-x 1 eddy users  15M nov 19 22:01 librustc-8581899a03b03e-0.9-pre.so*
[11:11:06] <dbaupp> cmr, eddyb: macro expansion walks the whole ast constructing a new one...
[11:11:09] <eddyb> -rwxr-xr-x 1 eddy users  32M nov 19 22:01 librustllvm.so*
[11:11:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:11:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:11:27] <eddyb> dbaupp: can't it reuse the old one where there aren't changes?
[11:11:31] <cmr> yup sounds about right
[11:11:33] <Sharp> dbaupp: Sure, but stripped of syntactic significance, 10,000 unique variable assignments are just 10,000 lines, no?
[11:11:35] *** Quits: Ms2ger (Ms2ger@moz-B6861E63.ibbt.be) (Quit: bbl)
[11:11:39] <cmr> eddyb: that's not how our ast works, it's immutable.
[11:11:40] <Sharp> Er, semantic.
[11:12:02] <eddyb> cmr: I mean, at each level, return the previous tree if a new one isn't being constructed
[11:12:04] <Sharp> (Okay, 10,000 AST nodes, but still :))
[11:12:39] <eddyb> that's what I'd do, but then, I have no clue about compilers
[11:12:55] <eddyb> all mmap calls I'm seeing seems to happen before main
[11:13:06] *** zz_kimundi is now known as kimundi
[11:13:08] <eddyb> cmr: did you pass a flag to strace to track all threads?
[11:13:14] <cmr> eddyb: strace -f
[11:13:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:13:25] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:13:42] *** Quits: mib_hnv4xs (Mibbit@moz-21AB3946.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[11:14:04] <dbaupp> eddyb: kinda, but not really.
[11:14:19] <mmalecki> you should be able to get a stack trace of mmap call by setting a breakpoint on it btw
[11:14:20] <dbaupp> eddyb: not with the current set-up, at least.
[11:14:27] <mmalecki> (if rust works with gdb or lldb)
[11:14:36] <cmr> mmalecki: (it does)
[11:14:53] <mmalecki> haha, just realized that asking whether it works with lldb was kinda silly
[11:15:10] <eddyb> dbaupp: that's just lame
[11:15:23] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:15:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:15:28] <eddyb> especially for an immutable AST
[11:15:49] <eddyb> [pid 25422] 1201324032
[11:16:27] <eddyb> 1.2GB for 5k on x86_64
[11:16:53] <eddyb> mmalecki: I can't really run it under a debugger :P
[11:16:55] <eddyb> node -e 'var o=process.stdout;o.write("fn main(){let x=0u32;");for(var i=0;i<5000;i++)o.write("let x=x+1;");o.write("let _x=x;}\n");' | strace -e trace=memory -f ~/Projects/rust/x*/stage1/bin/rustc - -Z time-passes 2>| grep --line-buffered mmap | sed 's/mmap[^,]*, //' | sed 's/,.*$//'
[11:17:11] <eddyb> pipes <3
[11:17:26] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:17:26] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:17:35] <eddyb> cmr: unless it's a timing thing, there's a lot of allocations that appear for borrowck and none for liveness
[11:17:40] <cmr> eddyb: uhh... strace -e trace=mmap
[11:18:10] <strcat> mmalecki: yeah, it does work well, -Z extra-debug-info
[11:18:45] <eddyb> yeah, it's timing, it now showed up in "LLVM passes"
[11:19:35] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:20:02] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:20:48] *** Joins: AutomatedTester (David@moz-DB4A9C19.scl3.mozilla.com)
[11:21:26] <eddyb> 768MB for 4k, that's 16*3 * 4k * 4k
[11:21:42] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:21:47] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:21:51] <eddyb> so 3 entries for each of vars.len() squared?
[11:22:55] <eddyb> dbaupp: but why would duplicating the AST take so long, compared to the time it takes to parse it?
[11:23:43] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:23:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:24:24] <dbaupp> eddyb: the macros expansion does a silly amount of work.
[11:24:38] <eddyb> but I'm using no macros :P
[11:24:46] <dbaupp> yes
[11:25:01] <dbaupp> I think even the "fast" path of no macros does a silly amount of work :P
[11:25:37] <eddyb> if I replace let x=x+1; with let _=x+1;, it's instant, wtf?
[11:25:43] <dbaupp> magic!
[11:25:45] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:25:46] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:25:55] <cmr> hahah
[11:26:06] <cmr> I wonder if let hygiene is doing something incredibly dumb
[11:26:30] <eddyb> x+=1 is also fast
[11:26:46] <Sharp> Haha
[11:26:53] <eddyb> let x=x; is slow as fudge
[11:26:58] <Sharp> Maybe we should wait for nmatsakis's rewrite to do any more benchmarking.
[11:27:47] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:27:50] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:27:58] <eddyb> node -e 'var o=process.stdout;o.write("fn main(){");for(var i=0;i<6000;i++)o.write("let _x:int;");o.write("}\n");' | ~/Projects/rust/x*/stage1/bin/rustc - -Z time-passes
[11:28:26] <eddyb> time: 20.329 s  expansion
[11:28:43] <dbaupp> `echo 'fn main() { let _x = 0;' 'let _x=_x+'{1..5000}';' '}'  |  rustc - -Z time-passes` works too :P
[11:28:52] <dbaupp> no need for this node madness :P
[11:28:57] <eddyb> bash-specific?
[11:29:03] <dbaupp> guess so
[11:29:11] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[11:29:12] *** Joins: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP)
[11:29:33] <dbaupp> golly, expansion really doesn't like `let`s
[11:29:42] <cmr> My best guess is hygiene
[11:29:47] <eddyb> dbaupp: yours trips liveness
[11:29:49] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:29:52] <dbaupp> yeah, sounds reasonable.
[11:29:52] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:30:16] <dbaupp> eddyb: I see 8s expansion and only .8s for liveness
[11:30:19] <eddyb> it needs at least 1.2GB. I thought let _x:int; wouldn't be a problem, now I'm not sure
[11:30:23] <eddyb> dbaupp: memory usage
[11:30:33] <dbaupp> eddyb: oh
[11:31:25] <dbaupp> 32.15%     rustc  libsyntax-2bb2d559d93ae8f0-0.9-pre.so  [.] hash::Writer$SipState::write::hadb05778635375a2fhaT::v0.9$x2dpre
[11:31:28] <dbaupp> o_O
[11:31:33] <eddyb> hahaha
[11:31:39] <cmr> hmmmmmm
[11:31:48] <dbaupp> that's just 5000 `let _x: int;`'s
[11:31:53] <dbaupp> yay table look ups!
[11:31:55] <eddyb> just let _x; fails in typeck, but still takes a lot of time in expansion
[11:31:55] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:32:00] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:32:13] <eddyb> are those virtual or cross-crate calls?
[11:33:00] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[11:33:02] <dbaupp> http://ix.io/96O is the full `perf report`
[11:33:03] <eddyb> smells of no inline/LTO to me
[11:33:07] <dbaupp> 60% spent of hashmaps
[11:33:09] <dbaupp> *on
[11:33:32] <dbaupp> *70%
[11:33:33] <cmr> Like I said, none of the trait impls are inlined for hashmap
[11:33:45] <dbaupp> eurgh
[11:33:53] <Sharp> cmr: Why is that?
[11:33:55] <eddyb> wouldn't that be a good idea?
[11:34:06] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:34:07] <dbaupp> presumably that won't help *that* much, given it's likely being called so many times
[11:34:09] * dbaupp tries
[11:34:09] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:34:21] <cmr> They're not small.
[11:34:28] <eddyb> pffft :(
[11:34:37] <Sharp> But they're called an awful lot.
[11:34:40] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:34:44] <cmr> We need to stop being silly about how we inline, and let LLVM do its job.
[11:35:03] <eddyb> why do we need super-special-randomized-crazy-hashes?
[11:35:18] <cmr> eddyb: prevents DoS
[11:35:25] <eddyb> on the compiler?
[11:35:30] <Sharp> Sure, but hash tables are one of the places I routinely see inlines in C (although admittedly that doesn't necessarily mean it's a good idea :P)
[11:35:33] <eddyb> you can DoS that in liveness :P
[11:35:41] <cmr> No
[11:35:43] <cmr> On the hashmaps.
[11:36:04] <eddyb> Sharp: C isn't a good example, you know, lack of abstractions
[11:36:08] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:36:12] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:36:21] <eddyb> cmr: I mean, couldn't the compiler use something slimmer?
[11:36:22] <cmr> It's a serious concern, many languages were and still are vulnerable to severe DoS because of shoddy hashes.
[11:36:25] <cmr> eddyb: Yes.
[11:36:26] <dbaupp> ok, put an #[inline] on every method in hashmap and hash... let's see what happens. :/
[11:36:39] <Sharp> Hm?  More about performance than abstraction in this case.
[11:36:48] * dbaupp thinks this might've overdone it
[11:37:12] <eddyb> Sharp: C++ can get you more performance for abstracted implementations
[11:37:38] <Sharp> Okay, but I thought we were talking about inline?
[11:37:56] <eddyb> inline makes more sense in a C++ impl :P
[11:38:10] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:38:15] <eddyb> since you know all the types and the specializations
[11:39:14] <eddyb> dbaupp: I like kcachegrind, it can display callgrind output files (and you can navigate the trees of calls), but I'm not sure I want to run rustc under that :)
[11:39:23] <strcat> Sharp: manually inlining stuff is never supposed to be a good idea, that's what the compiler is for (LTO)
[11:39:38] <strcat> although LLVM doesn't run the automatic inline pass at -O1
[11:39:39] <Sharp> strcat: Yeah, but Rust doesn't support LTO.  Or is that no longer the case?
[11:39:48] <strcat> sure, rust doesn't support LTO
[11:39:50] <cmr> Sharp: It needs to support LTO.
[11:39:50] <dbaupp> strcat: https://github.com/mozilla/rust/pull/10606 r?
[11:39:53] <cmr> That's the poitn :p
[11:39:57] <Sharp> Haha
[11:40:02] <Sharp> I'll agree with you there.
[11:40:18] <strcat> Sharp: at least, crates don't support LTO
[11:40:27] <strcat> if you don't use crates (meaning no stdlib) it does
[11:40:58] <dbaupp> Sharp: https://github.com/mozilla/rust/wiki/Mixed-language-link-time-optimization is something strcat wrote a while ago
[11:41:32] <Sharp> Made even easier by lack of segmented stacks, I suppose?
[11:41:47] *** Parts: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) ()
[11:41:49] <strcat> Sharp: not really
[11:41:57] <strcat> segmented stacks were never used if you compiled that way
[11:42:02] <Sharp> Ah, okay.
[11:42:05] <strcat> they're a backend feature
[11:42:13] <strcat> so if you go IR -> clang, they weren't there anyway
[11:42:27] <eddyb> time: 31.316 s  expansion
[11:42:34] <strcat> rust doesn't support position dependent code, LTO, etc. anyway so you already have to use clang
[11:42:37] <eddyb> 1k let _x:int; under callgrind
[11:45:43] <eddyb> dbaupp: http://i.imgur.com/iUgfi07.png
[11:45:58] <eddyb> is it just me, or is it hashing a function by including all its contents?
[11:46:33] *** pmoore is now known as pmoore|away
[11:47:00] *** Quits: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se) (Ping timeout)
[11:47:53] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:48:15] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[11:48:43] *** Joins: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de)
[11:48:47] <eddyb> dbaupp: haha, needs more inlining http://i.imgur.com/T5zd0tB.png
[11:48:57] <eddyb> all those nested functions
[11:50:56] *** Joins: victorporof (victorporo@79FE7CA6.284D02A8.D111398B.IP)
[11:51:03] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[11:51:23] <dbaupp> filed as https://github.com/mozilla/rust/issues/10607
[11:51:36] <dbaupp> eddyb: it wouldn't surprise me if it was hashing like that
[11:52:21] <dbaupp> eddyb: yeah, it is; it's just using #[deriving(IterBytes)] everywhere, so the whole contents is hashed
[11:52:37] <eddyb> can't it just hash the pointers?
[11:53:20] <dbaupp> depends what it's trying to do
[11:53:32] <dbaupp> ... but why is it even hashing functions repeatedly?
[11:53:34] <eddyb> it feels like hashing the contents can make collisions more common, too
[11:53:40] <dbaupp> there's exactly 1 function in that code. :/
[11:53:46] <Sharp> Haha
[11:54:51] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:54:57] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:55:12] <eddyb> #[no_std]; makes no difference
[11:56:32] <eddyb> dbaupp: 6 million times, to be *very* precise
[11:56:37] <eddyb> no more, no less
[11:56:42] <cmr> Wait, really?
[11:56:44] <cmr> Exactly 6mil?
[11:56:54] <eddyb> for 1k let _x:int;
[11:56:56] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:56:59] <eddyb> I'll check with other values
[11:57:11] <dbaupp> strcat: btw, https://github.com/thestinger/rust-core/commit/46d5c33cd2f926d80e625faedc77bea4bd9669f5 appears to be missing iter.rs?
[11:57:21] <strcat> whoops
[11:57:26] <eddyb> inb4 force push
[11:57:31] <strcat> yep! ;p
[11:57:46] <eddyb> I've gotten used to seeing the same commit three times on my feed
[11:58:11] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:58:16] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[11:58:25] * strcat knows he's a bad person
[11:58:38] <dbaupp> strcat: does the rustdoc commit mean that it works properly under rustdoc?
[11:58:49] <strcat> dbaupp: well, 'properly', you can't pass cfg(libc) to it
[11:58:53] <strcat> but yes, acrichto fixed it
[11:58:57] <eddyb> 1000 -> 500 and 6mil -> 1.5mil
[11:58:58] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:59:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[11:59:21] <dbaupp> so it's quadratic?
[11:59:24] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[11:59:28] <eddyb> dbaupp: yupp
[12:00:01] <dbaupp> yum
[12:00:16] <eddyb> 6 * N * N calls
[12:00:30] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[12:00:30] <dbaupp> eddyb: do you have pictures/output to add to? https://github.com/mozilla/rust/issues/10607 :)
[12:00:41] <eddyb> 4 from to_bytes::IterBytes$__extensions__::iter_bytes::anon::expr_fn::Uzadaf
[12:00:57] <eddyb> 2 from hash::Hash$A::hash_keyed::h463e3d8e059f5319Cac::v0.9$x2dpre
[12:01:02] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:01:10] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[12:03:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:03:26] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[12:03:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Connection reset by peer)
[12:03:53] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:04:02] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Ping timeout)
[12:05:40] <dbaupp> with #[inline] on the entirety of std::{hashmap, hash} http://ix.io/96P
[12:05:44] <dbaupp> i.e. not much change
[12:06:21] <eddyb> the usage is the stupid part
[12:06:28] <dbaupp> yes
[12:06:38] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[12:06:39] <dbaupp> 6 million hashes of one functions is probably unnecessary.
[12:06:42] <dbaupp> possibly.
[12:07:04] <eddyb> dbaupp: I'll upload the dumps, then everyone can compare. I hope some people here use KDE :P
[12:10:00] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[12:12:18] <eddyb> dbaupp: added a comment, good enough?
[12:12:44] <eddyb> now I'm not sure if those dumps work without my binaries :/
[12:13:40] <dbaupp> eddyb: yup (I put the picture inline, fwiw.)
[12:14:09] <eddyb> wha, you can do that?
[12:14:24] <dbaupp> " Attach images by dragging & dropping or selecting them. "
[12:14:31] <dbaupp> at the bottom of the input box
[12:14:31] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[12:15:08] <eddyb> removed the extra paren :P
[12:16:13] <eddyb> https://github.com/mozilla/rust/blob/master/src/libsyntax/ast.rs#L24-L32 iter_bytes is called on this 4NN times
[12:16:42] <dbaupp> yup
[12:17:00] <eddyb> hashing every statement requires hashing the entire SyntaxContext
[12:17:22] *** Quits: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net) (Quit: Leaving)
[12:17:29] <dbaupp> pub type SyntaxContext = uint;
[12:17:39] <eddyb> wait wtf
[12:17:41] <dbaupp> the *entire* SyntaxContext :P
[12:17:45] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:17:47] <cmr> heh
[12:18:07] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[12:18:15] * dbaupp guess that can become i32 like with the spans.
[12:18:17] <dbaupp> *guesses
[12:18:33] <dbaupp> err, u32
[12:18:36] *** Quits: victorporof (victorporo@79FE7CA6.284D02A8.D111398B.IP) (Ping timeout)
[12:18:43] <eddyb> how does iter_bytes on that cause a call to iter_bytes on anon::expr_fn?
[12:19:08] <dbaupp> that's just saying its calling a closure
[12:19:24] <dbaupp> not that it's iter_bytes-ing on an "expr_fn"
[12:20:03] <eddyb> oh, right, the other way around
[12:20:10] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[12:22:43] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[12:26:09] *** Joins: ofeldt- (ofeldt@moz-AD581F9.dip0.t-ipconnect.de)
[12:26:33] <eddyb> dbaupp: it's doing some recursive folding shit
[12:26:50] *** Quits: ofeldt (ofeldt@moz-87D16EF2.dip0.t-ipconnect.de) (Ping timeout)
[12:27:26] <dbaupp> eddyb: that's what I expect, although I'd hope it was doing it not-shitly (which is clearly false.)
[12:28:32] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[12:28:53] <eddyb> dbaupp: fixed my comment https://github.com/mozilla/rust/issues/10607#issuecomment-29068827
[12:29:32] <eddyb> IdentRenamer::fold_ident is O(N) while it should be O(1), I would think
[12:29:54] <dbaupp> iirc that is hygiene
[12:29:56] * dbaupp checks
[12:30:25] <eddyb> dbaupp: https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/expand.rs#L722-L732
[12:30:43] <dbaupp> yup
[12:30:45] <dbaupp> :(
[12:30:52] <dbaupp> that's kinda bad :P
[12:32:45] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[12:33:11] <eddyb> dbaupp: missed my edit?
[12:33:13] *** Quits: GeneralMaximus (ankur@2B9456D9.591B27D3.D5D59AD9.IP) (Quit: Computer has gone to sleep.)
[12:33:21] <eddyb> my link is master - or is that bad?
[12:33:48] <eddyb> what's hygiene?
[12:33:57] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[12:34:08] <pnkfelix> eddyb:  aka referential transparency
[12:34:16] <pnkfelix> eddyb: http://en.wikipedia.org/wiki/Hygienic_macro
[12:34:31] <dbaupp> eddyb: https://github.com/mozilla/rust/blob/747213a280ac5505e2537952f1d28efceda0bfcc/src/libsyntax/ast_util.rs#L757
[12:35:01] <dbaupp> eddyb: well, I was mainly cc-ing jbclements (the main author of the hygiene stuff.)
[12:35:15] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[12:35:22] <eddyb> pnkfelix: is it related to alpha renaming?
[12:35:31] * eddyb is clueless
[12:35:53] <pnkfelix> eddyb: depends on your point of view.  I think dherman would say that hygeniene is very much related to alpha-renaming
[12:35:58] <dbaupp> eddyb: in general it's better to link to specific hashes, or the line numbers go wrong (can press `y` while on a file view to go to the "canonical" URL, i.e. expand branches to commits)
[12:36:07] <pnkfelix> (as that was the subject of his thesis.)
[12:36:09] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[12:36:35] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[12:37:05] <pnkfelix> eddyb: see also http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CC0QFjAA&url=http%3A%2F%2Fmumble.net%2F~jar%2Fpubs%2Fmacros_that_work.ps&ei=5U-PUqiLL6mb0wX6qIDICg&usg=AFQjCNGcXlgaqeSW55pwQoteG7vNc01KFA&sig2=GuuydUIgiGQusMyETFhivQ&bvm=bv.56988011,d.d2k&cad=rja
[12:37:07] <pnkfelix> doh
[12:37:27] <eddyb> the link works :)\
[12:37:29] <pnkfelix> i meant to say http://mumble.net/~jar/pubs/macros_that_work.ps
[12:37:37] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[12:38:39] <pnkfelix> in particular, the original Kohlbecker hygiene algorithm was quadratic, and the macros-that-work paper discusses a technique for doing it in linear time.
[12:38:52] <pnkfelix> I don't know whether the technique is applicable in this context.
[12:39:19] <pnkfelix> But if nothing else, the macros-that-work paper also presents a pretty nice explanation of hygiene (using C-preprocessor as the motivating example)
[12:39:22] *** Joins: peterdn (chatzilla@moz-30BAAE88.as13285.net)
[12:39:30] <dbaupp> ah, so we may be stuck with O(n^2)?
[12:39:36] <pnkfelix> dbaupp: I hope not
[12:39:37] * dbaupp sad
[12:40:18] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[12:40:36] <pnkfelix> dbaupp: I'm pretty sure we'd adjust our macro system in whatever way necessary to avoid quadratic expansion.  But I'm hoping in this case it was just an oversight.
[12:41:03] *** kimundi is now known as zz_kimundi
[12:41:03] <dbaupp> hopefully
[12:42:20] <dbaupp> heh, wrapping each `let _x: int` as `{let _x: int;}` makes it run as fast as one would expect.
[12:42:42] <dbaupp> i.e. time: 0.059 s   expansion
[12:43:31] *** Quits: Sgeo (quassel@moz-D0F30617.dyn.optonline.net) (Connection reset by peer)
[12:43:34] <eddyb> yes, because renames.len() isn't N
[12:44:39] <eddyb> https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/expand.rs#L577-L580
[12:44:50] <dbaupp> yup
[12:45:46] <eddyb> why do we even need renames without macros?
[12:46:16] *** Joins: victorporof (victorporo@8D527E2D.7DA5C600.9B1E38F4.IP)
[12:46:27] <eddyb> https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/expand.rs#L571-L576 this looks stupid to me
[12:48:10] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Ping timeout)
[12:48:10] *** Quits: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org) (Ping timeout)
[12:50:37] <eddyb> or is it this? https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/expand.rs#L680
[12:51:48] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[12:53:05] *** Joins: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org)
[12:53:15] *** Quits: andre (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: Lost terminal)
[12:54:31] *** Joins: andre (andre@F962503D.B2592716.5FA960DF.IP)
[12:56:38] *** zz_kimundi is now known as kimundi
[12:56:51] <eddyb> well, this won't bother me, to liveness disabling I go :D
[13:03:40] *** Quits: StarLight (StarLight@moz-EE605696.dynamic.avangarddsl.ru) (Ping timeout)
[13:03:45] *** Quits: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de) (Quit: Quitting)
[13:04:00] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[13:04:27] *** Joins: heftig (heftig@F7D8C690.E27EDB0.172227A7.IP)
[13:04:56] *** Quits: sigma (sigma@moz-D4F04D48.range86-174.btcentralplus.com) (Client exited)
[13:05:08] *** Quits: Jackneill (Jackneill@moz-5FBD4CA5.pool.digikabel.hu) (Ping timeout)
[13:05:11] <eddyb[pc]> nmatsakis: oh, I see what you mean about CFG. right now it's an adjacency matrix for a graph, the value being the edge
[13:07:08] *** Joins: g (Mibbit@moz-B73C74C9.tbcn.telia.com)
[13:07:45] *** Joins: StarLight (StarLight@moz-D95F7160.dynamic.avangarddsl.ru)
[13:10:19] *** Joins: canhtak (canhtak@moz-D91D0D39.wl.t.ulaval.ca)
[13:12:12] <dbaupp> eddyb[pc]: so an n^2 length (bit?) vector?
[13:12:51] <eddyb> dbaupp: not a bit, each edge has a value. that's right now
[13:13:26] <eddyb> I was thinking of ~[~[Users]], but ~[HashMap<LiveNode, Users>] might work better
[13:13:37] <eddyb> (the vector is indexed by variables)
[13:13:53] *** Quits: nkoep (nik@moz-9466F5D6.pool.mediaways.net) (Ping timeout)
[13:13:57] <eddyb> s/variables/Variable id/
[13:15:11] * ChrisMorgan suddenly conceives the notion of having  ², ³ et al. as operators evaluating to powers, so that `n²` would be a genuine expression meaning n.pow(2)
[13:15:30] <eddyb> and I can type those relatively easy :D
[13:15:51] *** pmoore|away is now known as pmoore
[13:15:54] <ChrisMorgan> dbaupp: I was just getting bored of your O(n^2), n^2 length vector, etc. :P
[13:16:11] *** Parts: g (Mibbit@moz-B73C74C9.tbcn.telia.com) ()
[13:16:15] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131118212339])
[13:16:26] <eddyb> now let's name a function √
[13:16:38] <eddyb> so √(n) is sqrt(n)
[13:17:14] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[13:17:28] <ChrisMorgan> Hey, I actually find myself genuinely wanting this toy unary operator √! (Unary operator, not function, so that √n works.)
[13:17:32] <Sharp> That would be a ballsy optimise-for-read move :)
[13:18:15] <ChrisMorgan> eddyb: is there a compose key combination for √?
[13:18:39] <ChrisMorgan> In Vim the digraph is RT, but it doesn't work with the compose key
[13:18:52] <eddyb> hmpf, I don't have a compose key
[13:19:09] <ChrisMorgan> (Anyway, √ isn't a valid identifier, so you can't have a function named √.)
[13:19:12] <eddyb> well, I mean, my layout is non-standard
[13:19:37] <eddyb> sub is AltGr+2, sup is AltGr+3
[13:19:45] <dbaupp> my emacs python and C modes rewrites 'sqrt' to the √, `from math import √` etc.
[13:19:45] <ChrisMorgan> Ah.
[13:19:47] <dbaupp> looks weird.
[13:19:53] *** Joins: Ms2ger (Ms2ger@moz-1B43DE50.adsl-dyn.isp.belgacom.be)
[13:20:11] <ChrisMorgan> Yeah, you can do that in Vim if desired too.
[13:20:29] * dbaupp doesn't know how it happened, it just started doing that after an update
[13:20:35] <eddyb> ₁₂₃₄₅₆₇₈₉₀₋₌₊
[13:20:45] <Sharp> dbaupp: Does it have the same problem as rustc's feature gates? :P
[13:20:55] <eddyb> ¹²³⁴⁵⁶⁷⁸⁹⁰⁻⁼⁺
[13:21:09] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[13:21:18] <dbaupp> Sharp: definitely
[13:21:21] <ChrisMorgan> In Vim, the feature is "conceal".
[13:21:23] <eddyb> wait, n⁻² works :D
[13:21:57] <Sharp> That must make it even weirder, then.
[13:22:01] <eddyb> sadly, only -+= are supported, apart from numbers :(
[13:22:04] * ChrisMorgan wants to be able to type n¯¹⁰
[13:23:21] <ChrisMorgan> s/¯/⁻/ (s/\N{MACRON}/\N{SUPERSCRIPT MINUS}/)
[13:23:33] *** Joins: apoelstra (username@moz-C92A9641.sw.biz.rr.com)
[13:24:01] <dbaupp> are any/all these superscript codepoints in XID_{Start,Continue}?
[13:24:01] <Sharp> Are you sure you want Rust and not LaTeX?
[13:24:02] <ChrisMorgan> s/type/use in Rust/
[13:24:21] <eddyb> rusti: let Å = 10⁻¹⁰; Å
[13:24:22] -rusti- <anon>:9:18: 9:18 error: unknown start of token: \u207b
[13:24:22] -rusti- <anon>:9          let Å = 10⁻¹⁰; Å
[13:24:22] -rusti-                            ^
[13:24:22] -rusti- application terminated with error code 101
[13:25:41] * ChrisMorgan tries to find a definition of XID_{Start, Continue}
[13:25:48] <ChrisMorgan> Sharp: let us have some fun!
[13:26:02] <ChrisMorgan> Besides, it's not as though LaTeX supports Unicode.
[13:26:09] <Sharp> Wait, it doesn't?
[13:26:15] <ChrisMorgan> No! It doesn't!
[13:26:21] <Sharp> That's utterly baffling.
[13:26:26] * ChrisMorgan hates LaTeX's lack of Unicode support
[13:26:33] *** Joins: jensnock_ (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:26:46] <ChrisMorgan> "I have this perfectly valid Unicode character! But what's the Unicode \something to get it?"
[13:26:50] <pnkfelix> doesn't that depend?  E.g. http://www.ece.uci.edu/~chou/unicode-tex.html
[13:27:08] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[13:27:28] <dbaupp> ChrisMorgan: XeLaTeX :P
[13:27:29] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[13:28:16] <dbaupp> or just a modern texlive; cool.
[13:28:24] *** Joins: nkoep (nik@moz-9516AA68.vpn.rwth-aachen.de)
[13:28:36] *** Joins: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk)
[13:29:02] <eddyb> http://www.koreaherald.com/view.php?ud=20131119001029 wait, what?
[13:29:27] <eddyb> 128bit ARM in two years
[13:30:09] <cmr> why
[13:30:19] <cmr> What is the advantage?
[13:30:33] <Sharp> You can do 128 bit multiplication!
[13:30:54] <cmr> You can do that without 128 bit everything elses!
[13:30:58] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Client exited)
[13:31:01] <mletterle> Happy Friday Rusters!
[13:31:10] <Sharp> Good morning.
[13:31:11] <Earnestly> ChrisMorgan: Uh, latex lacks unicode support?
[13:31:30] *** Quits: tulloch (tulloch@moz-BC895BC5.damtp.cam.ac.uk) (Ping timeout)
[13:31:34] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[13:32:15] <dbaupp> mletterle: happy saturday
[13:32:31] <Earnestly> *shrug*
[13:32:37] <dbaupp> cmr: to support more ram
[13:32:42] <eddyb> cmr: I don't know, 128bit pointers seem like a complete waste of space
[13:33:01] <Sharp> dbaupp: Shouldn't that be movitvated by someone actually running out of RAM first?
[13:33:21] <eddyb> I've heard an argument on the osdev forums, years ago, that 2^128 or 2^256 is larger than the number of atoms in the universe
[13:33:21] <cmr> dbaupp: yes, because we clearly need bajillabytes of ram :P
[13:33:32] <ChrisMorgan> I'm sure people underestimate how soon IPv6 will be exhausted.
[13:33:53] <Sharp> What's to stop people from just using subnets with IPv6?
[13:34:03] <dbaupp> Sharp: you mean you haven't hit 2^48 bytes of RAM in your home computer yet?  slacker :P
[13:34:15] <Sharp> Not enough slots :(
[13:34:29] <eddyb> can rustc do x32?
[13:34:50] <cmr> eddyb: if llc can, yes. doesn't mean the stdlib is going to do anything meaningful with it
[13:35:01] * eddyb wonders if it would be more memory efficient on x86_64
[13:35:34] <klutzy> I've heard sega saturn was promoted as 64-bit since it has two 32-bit cpus
[13:35:57] <Sharp> In that case, my computer is 256 bit.
[13:36:43] <dbaupp> fwiw, the stdlib is possibly incorrect when uint is 32 bits but target_word_size="64"
[13:36:46] *** Joins: zootm (calum@moz-150DDDC2.sgyl.cable.virginm.net)
[13:36:55] *** Joins: mib_sza5wl (Mibbit@EAA37BC4.D99684C8.7CE36546.IP)
[13:36:56] <dbaupp> *probably
[13:37:32] <klutzy> dbaupp: probably; I'm trying win64 work again, but I've got transmute error
[13:38:05] <klutzy> oh wait. but uint is 64bit. sorry
[13:41:12] <strcat> cmr: it needs language level support for it as a target afaik
[13:41:49] <strcat> dbaupp: I think target_word_size really means target_ptr_size
[13:41:53] <strcat> it's named wrong
[13:43:05] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[13:43:39] *** Joins: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com)
[13:43:46] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[13:43:55] <dbaupp> strcat: ok, that would make sense. (But would also mean that it's being misused.)
[13:44:05] <dbaupp> (well, either way, it's being misused.)
[13:44:33] <strcat> dbaupp: well I don't think there's ever much of a use case for 'word' size
[13:44:34] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[13:44:42] <strcat> it doesn't really mean anything.
[13:45:14] <dbaupp> optimisations :P
[13:45:20] <strcat> what optimizations?
[13:45:31] <dbaupp> std::rand uses it to choose 32 or 64-bit RNG for the task local RNG
[13:45:52] <strcat> those are architecture specific anyway
[13:46:30] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[13:46:52] <dbaupp> "those"?
[13:46:58] <strcat> those optimizations
[13:47:13] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:47:29] <dbaupp> right
[13:49:03] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[13:49:36] <strcat> dbaupp: it's true that most CPU architectures have "general purpose" registers of a certain size... it's not a detail the language should expose
[13:49:41] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[13:49:47] <strcat> C doesn't expose it
[13:51:06] <dbaupp> so it should be switching on `#[target_arch]` (or whatever it is?)?
[13:51:34] <strcat> if it really makes sense to optimize that way
[13:52:22] <Sharp> I see where strcat is coming from… if you're making target-specific optimizations, relying on word size is just going to make people think you're optimizing for platforms that you haven't really benchmarked.
[13:52:33] <strcat> word size isn't really a thing
[13:52:36] <strcat> what is word size on x86?
[13:52:54] <strcat> AVX-512 has 32 512-bit 'vector' registers that you can use to do integer, floating point and other operations
[13:52:56] <dbaupp> I agree with strcat
[13:53:27] <strcat> there are 16 'general purpose' registers, but Intel could easily decide to do to integers what they did to floating point
[13:53:54] <strcat> (and that's just x86 - obviously another CPU architecture could do something totally different)
[13:53:55] *** eddyb[pc] is now known as eddyb
[13:53:56] *** Quits: reyre (reyre@moz-89E9865B.com) (Ping timeout)
[13:54:16] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[13:54:52] <strcat> a CPU architecture could easily expose some 32-bit registers, some 64-bit ones, some 128-bit or whatever
[13:54:59] <strcat> it's pretty arbitrary.
[13:55:56] <strcat> for x86, that's just the external API, and it doesn't actually have much to do with the CPU architecture
[14:01:32] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[14:04:27] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[14:08:06] *** Joins: GeneralMaximus (ankur@A6F89B8C.1D173DC.274D17D6.IP)
[14:08:45] *** Joins: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net)
[14:10:32] *** Quits: mib_sza5wl (Mibbit@EAA37BC4.D99684C8.7CE36546.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:12:01] *** Quits: moostik (Icedove@moz-63ED7231.w82-121.abo.wanadoo.fr) (Ping timeout)
[14:12:52] *** Joins: moostik (Icedove@moz-63ED7231.w82-121.abo.wanadoo.fr)
[14:14:10] *** Joins: _eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP)
[14:14:52] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[14:15:19] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[14:16:29] *** eddyb is now known as eddyb[pc]
[14:17:12] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:19:52] *** kimundi is now known as zz_kimundi
[14:20:46] *** _eddyb_ is now known as eddyb
[14:21:10] <eddyb> cmr: great, now something is trying to allocate over 4GB. twice
[14:24:03] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[14:24:14] <eddyb> cmr: did you ever get to compile with liveness disabled? it seems something later on is trying to allocate a lot of RAM, too
[14:26:00] <dredozubov> hello, guys, i'm trying to make sense of generic functions with this doc: http://static.rust-lang.org/doc/master/rust.html#generic-functions
[14:26:11] <cmr> eddyb: I didn't bother.
[14:26:13] <dredozubov> can someone help with this?
[14:26:16] <dredozubov> https://gist.github.com/dredozubov/7600662
[14:26:30] *** pmoore is now known as pmoore|away
[14:27:01] <eddyb> cmr: thanks anyways, I'll see what I can do, most likely I'll go to sleep and try again tomorrow
[14:27:49] <cmr> dredozubov: so .iter() on vectors returns a type which implements Iterator<&T>
[14:28:05] <cmr> dredozubov: ie, it's yielding borrowed pointers into the vector.
[14:28:28] <dredozubov> so i have to provide function with &T argument?
[14:28:50] <cmr> dredozubov: So you either need to take a ~[T] and use .move_iter(), or bound T by clone and do acc.push(f(i.clone()))
[14:29:16] <cmr> dredozubov: that would also work
[14:29:23] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[14:29:43] <cmr> Also, if you're not using 0.8, you should use `|T| -> U`, the &fn syntax is going away
[14:29:52] <dredozubov> hm
[14:29:57] <dredozubov> i'm using 0.8
[14:30:04] <dredozubov> is it changed on trunk?
[14:30:06] <cmr> yes
[14:30:15] <dredozubov> nice one
[14:30:16] <cmr> things always change on master :p
[14:30:26] <dredozubov> yeah, i noticed :P
[14:31:52] <dredozubov> also can you please tell me how can i test libstd? I saw some opened issues and i'd like to work on them on weekend, but i don't have a clue how to test my changes.
[14:32:09] <eddyb> https://github.com/chrisdone/hell
[14:33:25] <cmr> dredozubov: `make check-stage1-std`
[14:33:41] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[14:34:05] <dredozubov> thx, i'll try it
[14:34:16] <dredozubov> what does stage1 mean exactly?
[14:34:20] *** Joins: sk_ (sk@3A2A826A.96BA6F2A.53D8F2EA.IP)
[14:34:22] *** Quits: jensnock_ (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[14:34:30] <cmr> dredozubov: http://en.wikipedia.org/wiki/Bootstrapping_%28compilers%29
[14:34:55] <cmr> dredozubov: it's the first part of compilation, the part built with the bootstrap compiler (stag0)
[14:35:31] <dredozubov> thanks! i'll give it a look
[14:38:01] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[14:42:38] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[14:42:59] *** Joins: mark_edward (AndChat806@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[14:43:32] *** Joins: abinader (abinader@D8B9C081.E820043D.D4C04133.IP)
[14:44:11] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[14:45:43] <dredozubov> cmr: ~[T] + .move_iter() worked! Can't get other one to work though.
[14:45:52] *** Quits: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net) (Ping timeout)
[14:47:06] <dredozubov> error: mismatched types: expected `T` but found `&T` (expected type parameter but found &-ptr)
[14:47:13] <dredozubov> map2.rs:4         acc.push(f(i.clone()));
[14:48:58] *** Joins: Jackneill (Jackneill@moz-5FBD4CA5.pool.digikabel.hu)
[14:49:01] *** Quits: canhtak (canhtak@moz-D91D0D39.wl.t.ulaval.ca) (Quit: canhtak)
[14:50:29] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[14:53:38] *** Joins: botolhejo (botolhejo@moz-4EAC9D1.three.co.id)
[14:55:14] *** Quits: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[14:56:21] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[14:56:51] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[14:59:07] <sbalmos> strcat: Feel free to smack me. Any thoughts on having an inline asm construct in an unsafe block?
[15:00:19] <strcat> sbalmos: there is inline asm
[15:00:26] *** Quits: heftig (heftig@F7D8C690.E27EDB0.172227A7.IP) (Quit: Quitting)
[15:00:45] *** Quits: StarLight (StarLight@moz-D95F7160.dynamic.avangarddsl.ru) (Ping timeout)
[15:01:57] *** Quits: sk_ (sk@3A2A826A.96BA6F2A.53D8F2EA.IP) (Ping timeout)
[15:02:07] <cmr> sbalmos: asm!(...) :P
[15:02:30] <pnkfelix> (might be feature guarded, I cannot remember...)
[15:03:04] <strcat> yeah, it is
[15:04:10] <sbalmos> !!!
[15:04:16] <sbalmos> LOL oh brother
[15:06:07] *** zz_kimundi is now known as kimundi
[15:06:47] <sbalmos> strcat: Whereabouts is that? Can't find any reference to it in master's manual
[15:06:57] <strcat> sbalmos: sure, the manual isn't complete
[15:07:06] <sbalmos> well, yeah...
[15:07:09] <strcat> lots of the information in the manual is just plain inaccurate.
[15:07:14] *** Joins: jdm (jdm@moz-ED0C7AC7.hinet-ip.hinet.net)
[15:07:14] *** ChanServ sets mode: +o jdm
[15:07:31] <strcat> the tutorial at least covers ~. Rc, Gc, vectors/strings, ownership/destructors accurately now
[15:07:34] <sbalmos> strcat: So it's buried somewhere in librustc?
[15:07:41] <strcat> sbalmos: there are tests you can look at
[15:07:56] <cmr> sbalmos: the release annonucement for... 0.7, I think, has detail
[15:07:58] <cmr> s
[15:08:19] <strcat> src/test/run-pass/asm-out-assign.rs
[15:08:31] <strcat> it's based on the gcc (and therefore, clang/icc) inline asm
[15:08:50] <sbalmos> ah, no, 0.6
[15:09:24] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[15:10:45] <sbalmos> strcat / cmr: Nevermind then. I'll go back to muttering and killing my brain with other ideas. ;)
[15:11:06] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Input/output error)
[15:11:08] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[15:11:19] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[15:11:54] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Ping timeout)
[15:15:41] *** Quits: victorporof (victorporo@8D527E2D.7DA5C600.9B1E38F4.IP) (Quit: victorporof)
[15:18:15] *** Joins: StarLight (StarLight@moz-45B013A5.dynamic.avangarddsl.ru)
[15:18:26] *** Joins: sk_ (sk@9E6B574B.EB2AA036.2CAF0D3B.IP)
[15:20:43] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[15:21:05] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: ZZZzzz…)
[15:21:17] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[15:22:27] *** Quits: Ferreus (ferreus@moz-2D8270FB.dip0.t-ipconnect.de) (Quit: WeeChat 0.4.2)
[15:23:01] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[15:24:13] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:25:33] *** Joins: Ferreus (ferreus@moz-2D8270FB.dip0.t-ipconnect.de)
[15:26:14] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[15:28:45] *** Quits: moostik (Icedove@moz-63ED7231.w82-121.abo.wanadoo.fr) (Ping timeout)
[15:28:58] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[15:29:08] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[15:31:11] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[15:31:11] *** ChanServ sets mode: +ao pcwalton pcwalton
[15:31:19] *** Quits: botolhejo (botolhejo@moz-4EAC9D1.three.co.id) (Quit: )
[15:31:44] *** Quits: eddyb[pc] (eddyb@336E3A7F.D51DAF03.FB866788.IP) (Quit: Konversation terminated!)
[15:32:08] *** Quits: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com) (Quit: Leaving)
[15:34:02] *** Joins: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net)
[15:34:05] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[15:34:15] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[15:34:51] *** Quits: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:40:42] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[15:40:51] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[15:41:04] *** Joins: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net)
[15:41:38] *** Quits: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP) (Ping timeout)
[15:41:50] *** Joins: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP)
[15:44:25] *** Joins: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net)
[15:44:30] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[15:44:32] *** Joins: sankha93 (uid12218@moz-31ABA2C0.irccloud.com)
[15:46:48] *** Joins: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net)
[15:48:29] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[15:48:50] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[15:49:13] *** Quits: fabrice (fabrice@moz-94F028C6.hsd1.ca.comcast.net) (Quit: Leaving.)
[15:49:25] *** Joins: fabrice (fabrice@moz-94F028C6.hsd1.ca.comcast.net)
[15:51:09] *** Joins: exobit_ (textual@moz-E06F46F0.corp.bitshelter.com)
[15:54:28] *** Joins: victorporof (victorporo@8D527E2D.7DA5C600.9B1E38F4.IP)
[15:55:46] *** Joins: negge (unlord@moz-5BD795E6.hsd1.va.comcast.net)
[15:57:16] <negge> I just tried to compile rust-0.8 and got this error "internal compiler error: encode_symbol: id not found 321677"
[15:57:48] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[15:58:14] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[15:58:34] *** Quits: fabrice (fabrice@moz-94F028C6.hsd1.ca.comcast.net) (Ping timeout)
[15:58:35] <Ms2ger> Try master :)
[16:02:45] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[16:05:19] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[16:05:24] *** Joins: adu (ajr@moz-1A861F1E.washdc.fios.verizon.net)
[16:05:27] *** Quits: Jesin (Jesin@moz-63C897DA.res.lehigh.edu) (Quit: Leaving)
[16:05:43] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[16:07:10] *** Quits: adu (ajr@moz-1A861F1E.washdc.fios.verizon.net) (Quit: adu)
[16:11:09] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[16:13:03] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[16:14:46] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[16:14:46] *** ChanServ sets mode: +ao pcwalton pcwalton
[16:14:52] *** Joins: yegha78tg (esucg0aq47@2B44676D.E4108C51.D623D704.IP)
[16:15:16] *** Quits: yegha78tg (esucg0aq47@2B44676D.E4108C51.D623D704.IP) (User has been banned from Mozilla (no spamming here))
[16:15:48] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[16:17:04] *** Joins: z0w0 (zack@moz-5E840EF3.lns3.woo.bigpond.net.au)
[16:21:57] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[16:22:05] *** Quits: victorporof (victorporo@8D527E2D.7DA5C600.9B1E38F4.IP) (Quit: victorporof)
[16:22:47] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[16:23:23] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[16:23:58] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[16:24:56] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[16:25:25] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[16:25:49] <bstrie> "If crypto is so hard that only one implementation is allowed to exist, it's crypto that needs to be rethought"
[16:25:52] <bstrie> #shitHNsays
[16:27:16] <Ke> HN?
[16:27:23] <Scriptor> hacker news
[16:27:31] <Ke> HitlerNapoleon
[16:27:33] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[16:28:02] <bstrie> HitlerNapoleon sounds like a pokemon whose type is doubly vulnerable to Russia
[16:28:07] <bstrie> #shitbstriesays
[16:28:13] <Ke> heh
[16:28:26] <dredozubov> bstrie: lol
[16:29:00] <bstrie> but really, folks, like, has anyone noticed how *hard* math is? I think it should be easier. has anyone tried making math easier?
[16:29:20] <bstrie> do we really need all these... numbers?
[16:29:35] <Ke> math gets easier all the time, as focus and study materials improve
[16:29:41] <Ke> and wolfram alpha
[16:29:54] <Ke> and even general availability of everything
[16:29:56] <bstrie> speaking as someone who will never be an inter-universal geometer, I disagree
[16:30:14] <bstrie> I can type math into wolfram alpha, but I can't understand it
[16:30:21] *** Joins: heftig (heftig@moz-D9FCE6C3.dip0.t-ipconnect.de)
[16:30:28] <cmr> Don't need to, W|A understands it for you!
[16:30:35] *** Parts: pnathan1 (Adium@moz-5EBBDD83.tukw.qwest.net) ()
[16:30:40] <Ke> sometimes it may help you to understand
[16:30:42] <cmr> *rainbow* computing
[16:30:50] <bstrie> I mean, literally, the reason that I got into CS was because I am bad at math, and wanted computers to do it for me
[16:30:59] *** Joins: fabrice (fabrice@moz-7B0110AD.mv.mozilla.com)
[16:31:02] <bstrie> and then I learned that CS is just a branch of math nooooo
[16:31:04] <bstrie> but it was too late
[16:31:07] <sbalmos> bstrie: There's a bit of a problem there. ;)
[16:31:42] <sbalmos> Vector math, booleam math, matrix math, computational cost analysis... Gotta love it
[16:31:44] <Scriptor> I was usually ambivalent about my calc courses
[16:31:51] <Scriptor> but I loved my discrete math class
[16:31:55] <bstrie> fortunately I managed to change my track away from "CS degree with a focus on math" to "CS degree with a focus on project management and economics"
[16:32:00] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[16:32:26] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[16:32:36] <bstrie> seriously, I had no idea that CS involved math
[16:32:38] <bstrie> nobody told me this
[16:32:44] <bstrie> when I was young and stupid
[16:32:58] <negge> bstrie: the best part of CS is the math
[16:33:04] <bstrie> not that I am any less stupid in my methuselian age
[16:33:57] <sbalmos> hence why there's Comp. Eng. and Systems Eng. degrees
[16:34:07] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[16:34:07] <bstrie> man, nobody told me about those
[16:34:13] <sbalmos> well, no, sorry. Comp. Eng. is more slanted towards the hardware side
[16:34:23] <sbalmos> I've got both
[16:34:26] <Seldaek> I was good at math until I started playing Mankind (sort of precursor to Eve Online), then thanks to that fucking my life I decided to skip CS :p
[16:34:35] <bstrie> college was like "what do you want to major in" and I was like "dunno, I like computers I guess"
[16:34:48] *** Quits: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com) (Quit: arodier74)
[16:34:55] <bstrie> "surely in computer science I will get to play with computers"
[16:35:02] <bstrie> and here we are
[16:35:33] <cmr> bstrie: I could have swore you got a major in Slave Driving at the University of Montezuma
[16:35:50] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[16:36:11] <Ms2ger> bstrie, but math is fun!
[16:36:14] *** Joins: fabrice1 (fabrice@moz-BBE3ABD.mv.mozilla.com)
[16:36:14] <bstrie> cmr: it was the University of Queztlcoatl, Montezuma was just my thesis advisor
[16:36:21] <cmr> ah
[16:36:22] <kimundi> I was never enthusiastic about the the theoretical math parts of my CS courses, and I'm was always struggling with them, but now that I'm done with them I'm happy they where mandatory :P
[16:36:36] * cmr loves theoretical CS
[16:36:59] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[16:37:13] <Ms2ger> bstrie, also, math doesn't do numbers much... Just letters :)
[16:37:15] <Scriptor> the best part about CS is that it doesn't require computers
[16:37:21] <Ms2ger> And funky symbols
[16:37:25] *** Quits: fabrice (fabrice@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[16:37:49] <bstrie> Ms2ger: letts in math are just meta-numbers
[16:37:54] <bstrie> *ers
[16:38:05] <cmr> heh
[16:38:32] *** Quits: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP) (Client exited)
[16:38:51] <kimundi> Though it's kinda annoying to hear a course about algorithms and their runtime analysis if the hardest aspect is understanding the vague, inconsistent psydocode notations of the prof :P
[16:39:05] <sbalmos> hehehe
[16:39:13] *** Joins: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com)
[16:39:19] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[16:39:22] <sbalmos> set theory, now that's a crapload of weird greek notation I could never get used to
[16:39:33] <sbalmos> Concepts, yeah. The written form, no
[16:39:42] *** Joins: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP)
[16:40:00] <bstrie> the professor for my introduction to algorithms class had a very heavy chinese accent. every lecture was an exercise in natural language processing
[16:40:20] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[16:40:21] <kimundi> It's not funny to be expected to solve hard problems correctly without ever getting a specific definition how the correct way would look like, and withhout being able to decipher the algorithmn itself :P
[16:41:11] <Scriptor> I liked set theory
[16:41:19] <bstrie> I actually did too
[16:41:40] <bstrie> set theory and discrete math were the math classes that I actually enjoyed
[16:41:53] <Scriptor> yeah, I loved the written form, I could finally start to sorta understand some of the mathy wikipedia articles
[16:41:57] <kimundi> I like the knowledge that is now in my brain, I don't remember the specifics of the courses though xD
[16:42:07] *** Quits: abinader (abinader@D8B9C081.E820043D.D4C04133.IP) (Quit: Fui!)
[16:42:34] <Scriptor> bstrie: same, they're a good intro to abstract math
[16:42:55] <Scriptor> meanwhile my math major friend dived head-first into that with analysis
[16:43:15] *** Joins: canhtak (canhtak@moz-FDA6CD72.wl.t.ulaval.ca)
[16:43:17] <bstrie> I remember in my first calc class in college, the professor was working through a problem on the board and I had to raise my hand and ask about a step in the process. she said, "that's factorization". I said, "what the fuck is factorization"
[16:43:44] *** Joins: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP)
[16:43:48] <bstrie> it doesn't help that ALL my high school math teachers were actually coaches for sports teams, who had to have token teaching positions in order to be employed by the school
[16:43:51] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[16:43:55] <sbalmos> awesome
[16:43:58] <cmr> bstrie: then you transfered to U of Q? :P
[16:44:11] *** Joins: Jesin (Jesin@moz-63C897DA.res.lehigh.edu)
[16:44:11] <sbalmos> And then your advisor had his revenge
[16:44:21] <sbalmos> (implied humor)
[16:44:30] <bstrie> cmr: and then she printed out high-school level algebra worksheets to teach me what factorization was
[16:44:33] <Ms2ger> bstrie, that sucks :( (math teachers)
[16:44:37] <bstrie> she was actually a godsend
[16:44:48] <bstrie> I got a D in the class, even with all the help she gave me
[16:44:54] <kimundi> My roommate never learned about vector calculation at school, which made the math courses additional challenging for him :P
[16:45:34] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[16:46:10] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Ping timeout)
[16:46:11] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Quit: leaving)
[16:46:18] <icarot> reading polymorphic lambda terms on the Wikipedia page for system F made me understand polymorphic functions as regular ones but with a type as an argument.
[16:46:42] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Connection reset by peer)
[16:46:42] <sbalmos> Had a Chinese prof for one of my last math classes. I think it was Statics (not statistics, statics). Every time he said "delta function", it ended up "durta foocheen"
[16:46:54] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[16:46:57] <icarot> Wikipedia is my math textbook.
[16:47:08] <sbalmos> Didn't help that the class was an 8am one, and he spent 45 minutes every time trying to turn on the overhead projector.
[16:47:13] <sbalmos> (only to find out it had a burnt bulb)
[16:47:15] *** Quits: icarot (yaaic@moz-BBFD6490.lightspeed.sntcca.sbcglobal.net) (Quit: Yaaic - Yet another Android IRC client - http://www.yaaic.org)
[16:47:25] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[16:47:26] <Scriptor> there were a ton of jewish profs in my cs department
[16:47:45] <Scriptor> very handy for both english comprehension and when there were jewish holidays and they took the day off
[16:48:36] <sbalmos> Very oddly, compared to the rest of my graduating class, my favorite classes were assembly language and microprocessor design / embedded systems.
[16:49:04] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[16:49:12] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[16:49:57] <mmalecki> I dropped out of high school, still happy to have decided to work instead of learning HS math
[16:54:00] *** jorendorff_away is now known as jorendorff
[16:56:32] *** Quits: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP) (Quit: eholk)
[16:58:06] *** Quits: fabrice1 (fabrice@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[16:58:08] *** Joins: fabrice (fabrice@moz-BBE3ABD.mv.mozilla.com)
[17:00:17] *** Quits: sk_ (sk@9E6B574B.EB2AA036.2CAF0D3B.IP) (Quit: Leaving)
[17:00:37] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[17:01:21] *** Quits: dredozubov (dredozubov@2F14E2C1.F70E5FA9.F63E14E8.IP) (Client exited)
[17:01:30] <sam113101> I finished high school but didn't pursue higher education
[17:01:44] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[17:02:20] *** Joins: jix (jix@moz-D969BFFC.de)
[17:03:15] *** Quits: z0w0 (zack@moz-5E840EF3.lns3.woo.bigpond.net.au) (Client exited)
[17:08:41] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Connection reset by peer)
[17:09:16] *** Quits: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net) (Quit: Leaving)
[17:11:26] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[17:12:02] *** Quits: rhelmer (rhelmer@moz-DB4A9C19.scl3.mozilla.com) (Quit: leaving)
[17:13:14] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[17:13:41] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[17:13:52] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[17:14:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[17:14:43] *** Joins: beifeng (Mibbit@32B41A.FA7FF645.C7DB8B78.IP)
[17:16:46] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[17:17:02] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[17:19:05] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[17:19:08] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:19:10] *** Parts: dumitru (dgherman@moz-7C253BEB.getcadre.com) ()
[17:19:19] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[17:20:10] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[17:22:50] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Ping timeout)
[17:24:32] *** Quits: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com) (Ping timeout)
[17:24:57] *** Joins: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com)
[17:26:50] *** Quits: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:28:50] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[17:28:56] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[17:29:17] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[17:29:30] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[17:29:45] *** Quits: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP) (Ping timeout)
[17:29:57] *** Joins: maxiepoo_ (Max@moz-DEDB4821.nuwlan.northwestern.edu)
[17:30:30] *** Joins: abinader (abinader@D8B9C081.E820043D.D4C04133.IP)
[17:31:04] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[17:31:17] *** Joins: jordyd (jordyd@moz-F956A47D.seg43.ucf.edu)
[17:32:30] *** Joins: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP)
[17:33:04] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[17:33:30] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:33:31] *** ChanServ sets mode: +ao brson brson
[17:36:18] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[17:36:46] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Connection reset by peer)
[17:36:58] *** Quits: maxiepoo_ (Max@moz-DEDB4821.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[17:37:02] *** Quits: canhtak (canhtak@moz-FDA6CD72.wl.t.ulaval.ca) (Quit: canhtak)
[17:37:37] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[17:37:41] *** Joins: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net)
[17:39:44] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[17:42:06] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[17:42:39] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[17:43:13] *** Quits: Ferreus (ferreus@moz-2D8270FB.dip0.t-ipconnect.de) (Ping timeout)
[17:44:26] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:45:56] *** Joins: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP)
[17:46:11] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:46:20] *** Joins: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net)
[17:46:29] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:49:40] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:50:27] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:50:56] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[17:51:22] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:51:36] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[17:51:36] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:52:48] *** Quits: Soft (soft@moz-EC8D39F.yok.fi) (Ping timeout)
[17:53:55] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[17:54:05] *** Joins: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP)
[17:54:21] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[17:54:24] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[17:55:13] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[17:56:07] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[17:57:03] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:57:28] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[18:00:25] *** Joins: huhlig-work (Hans@moz-62A47D90.aoltw.net)
[18:00:44] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[18:00:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[18:01:56] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[18:03:30] *** Joins: Soft (soft@moz-EC8D39F.yok.fi)
[18:04:32] *** Quits: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com) (Quit: arodier74)
[18:05:23] <kmapped> Does anyone know of any soft-cpus with an MMU?  I'd like to run Rust on an FPGA.
[18:05:58] *** Joins: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com)
[18:06:05] *** Quits: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP) (Quit: WeeChat 0.4.2)
[18:06:48] *** Quits: g3xzh (g3xzh@moz-5C189D89.red.bezeqint.net) (Ping timeout)
[18:06:59] <jensnockert> kmapped: You don't need an MMU for Rust.
[18:08:38] <jensnockert> kmapped: The limitation is what LLVM can generate code for, so I would look at something MIPS:y or ARM:y.
[18:08:41] *** Quits: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com) (Quit: arodier74)
[18:09:04] *** Joins: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP)
[18:09:09] *** Joins: arodier74 (Thunderbir@moz-D6235B0B.in-addr.btopenworld.com)
[18:09:17] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[18:09:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[18:09:42] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[18:11:44] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[18:11:51] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Client exited)
[18:11:56] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[18:12:13] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Client exited)
[18:12:52] *** Quits: nkoep (nik@moz-9516AA68.vpn.rwth-aachen.de) (Ping timeout)
[18:13:15] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[18:13:17] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:13:21] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:14:10] <kmapped> jensnockert: ah, thanks.
[18:14:26] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[18:14:28] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:14:28] *** ChanServ sets mode: +ao brson brson
[18:14:35] <jensnockert> Cortex M-series are known working with some trickery.
[18:17:13] *** Joins: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP)
[18:17:14] <r-A> Almost 2000 subscribers/readers in /r/Rust now!
[18:21:38] <brson> \(^0^)/
[18:22:42] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[18:23:56] *** Quits: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP) (Quit: WeeChat 0.4.2)
[18:23:58] *** Joins: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP)
[18:24:27] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Connection reset by peer)
[18:24:42] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:24:42] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[18:29:36] *** Quits: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net) (Ping timeout)
[18:30:20] *** Joins: eternaleye (eternaleye@moz-5668AFCB.hsd1.wa.comcast.net)
[18:31:26] *** Joins: nkoep (nik@moz-9466F5D6.pool.mediaways.net)
[18:33:52] *** Joins: fabiand_ (fabiand@moz-ADAFEF3A.adsl.alicedsl.de)
[18:34:26] *** Quits: fabiand (fabiand@moz-ADAFEF3A.adsl.alicedsl.de) (Ping timeout)
[18:37:18] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[18:38:21] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[18:39:06] *** Joins: SiegeLord (sl@moz-1DF56822.twcny.res.rr.com)
[18:39:38] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[18:39:51] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[18:40:07] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[18:40:07] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[18:40:32] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Connection reset by peer)
[18:40:36] *** Joins: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca)
[18:40:53] *** Joins: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net)
[18:42:58] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[18:45:43] *** Joins: mib_vp3s2s (Mibbit@moz-E04F7D7F.xlate.ufl.edu)
[18:45:55] <mib_vp3s2s> You can't value dispatch over trait objects, correct? Just enums?
[18:45:58] *** Joins: Ferreus (ferreus@moz-984CDD9B.pools.arcor-ip.net)
[18:46:14] <strcat> mib_vp3s2s: value dispatch?
[18:46:21] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:46:30] <mib_vp3s2s> strcat: Pattern match
[18:46:32] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[18:47:04] <strcat> mib_vp3s2s: yeah, you can't even get the original type back from a trait object
[18:47:09] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:47:15] <strcat> (except via some kind of reflection like Any)
[18:47:38] <strcat> an enum is bounded set of types you can match on, a trait object is an unknown boxed type
[18:47:46] *** Quits: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net) (Ping timeout)
[18:47:46] <strcat> s/types/variants/
[18:49:15] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[18:49:44] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[18:50:45] <mib_vp3s2s> strcat: Okay, thanks
[18:51:39] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:53:08] *** Quits: mib_vp3s2s (Mibbit@moz-E04F7D7F.xlate.ufl.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[18:53:39] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[18:55:56] *** Joins: Savago (Savago@44759A70.40BDE760.18DDB669.IP)
[18:56:42] *** Joins: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[18:57:27] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[18:58:25] *** Joins: brson_ (brson@moz-7B0110AD.mv.mozilla.com)
[18:58:32] *** Joins: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net)
[18:59:18] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:59:51] *** kimundi is now known as zz_kimundi
[19:00:05] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Quit: leaving)
[19:01:28] *** Quits: heftig (heftig@moz-D9FCE6C3.dip0.t-ipconnect.de) (Ping timeout)
[19:01:41] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[19:02:53] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[19:03:12] <tikue> should there be a way to match "number greater than or equal to n"? e.g. match 5 { 0 => "zero", 1.. => "nonzero" }
[19:03:23] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[19:04:17] <benh> x if x >= n => "number greater than or equal to n"
[19:04:19] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[19:04:20] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:04:27] <benh> I guess explicit range sugar reads better
[19:04:32] *** Joins: Jesse (jruderman@moz-7B0110AD.mv.mozilla.com)
[19:04:37] <tikue> benh: sure you can also use if { } else if { } everywhere
[19:04:53] <tikue> matching on numbers is already supported with n..m
[19:05:13] <benh> so 1..INT_MAX?
[19:05:18] <tikue> yeah
[19:05:22] <tikue> but you're not always matching on ints
[19:06:04] <TeXitoi> rusti: match 5 { 0 => "zero", x if x > 0 => "nonzero =
[19:06:04] -rusti- <anon>:11:16: 11:17 error: unknown start of token: ?
[19:06:04] -rusti- <anon>:11     println!("{:?}", r)
[19:06:04] -rusti-                           ^
[19:06:04] -rusti- application terminated with error code 101
[19:06:16] <TeXitoi> rusti: match 5 { 0 => "zero", x if x > 0 => "nonzero" }
[19:06:16] -rusti- <anon>:9:9: 9:57 error: non-exhaustive patterns
[19:06:17] -rusti- <anon>:9          match 5 { 0 => "zero", x if x > 0 => "nonzero" }
[19:06:17] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[19:06:17] -rusti- error: aborting due to previous error
[19:06:17] -rusti- application terminated with error code 101
[19:06:24] *** Quits: sankha93 (uid12218@moz-31ABA2C0.irccloud.com) (Quit: )
[19:06:31] <tikue> TeXitoi: try 5u
[19:06:46] <TeXitoi> rusti: match 5u { 0 => "zero", x if x > 0 => "nonzero" }
[19:06:46] -rusti- <anon>:9:9: 9:58 error: non-exhaustive patterns
[19:06:46] -rusti- <anon>:9          match 5u { 0 => "zero", x if x > 0 => "nonzero" }
[19:06:47] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[19:06:47] -rusti- error: aborting due to previous error
[19:06:47] -rusti- application terminated with error code 101
[19:07:04] <TeXitoi> not clever enouth ;)
[19:07:22] <TeXitoi> rusti: match 5u { 0 => "zero", x if x > 0 => "positive", _ => "negative" }
[19:07:23] -rusti- "positive"
[19:07:50] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[19:08:01] *** Quits: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP) (Quit: eholk)
[19:08:17] <o11c> stupid compiler
[19:08:24] *** zz_kimundi is now known as kimundi
[19:09:43] *** jorendorff is now known as jorendorff_away
[19:10:03] *** Joins: huseby (huseby@moz-652A28E0.amd.co.at)
[19:10:21] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[19:10:35] <sbalmos> strcat: So I see the stuff in librustc/middle/trans for LLVM mapping. Whereabouts near there does rustc tell LLVM to emit machine code, vs possibly a bitcode file, or even where the platform-dependent LLVM stage is registered?
[19:11:19] <strcat> sbalmos: the whole thing is platform dependent
[19:11:30] <strcat> bitcode is platform dependent
[19:11:30] *** Joins: heftig (heftig@moz-EFABD065.dip0.t-ipconnect.de)
[19:11:45] <strcat> the librustc/back dir is where it tells it what to do with codegen
[19:12:03] <sbalmos> ah, yeah, forgot about that back dir
[19:12:51] <sbalmos> strcat: It stems from talks with other guys I know, where bitcode itself is platform-dependent, but maybe you can have LLVM emit codegen before the platform-dependent register assignment, etc stuff to be a new form of bytecode.
[19:12:54] *** Joins: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP)
[19:13:08] *** Quits: andre (andre@F962503D.B2592716.5FA960DF.IP) (Quit: leaving)
[19:13:08] *** Quits: Jesin (Jesin@moz-63C897DA.res.lehigh.edu) (Quit: Leaving)
[19:13:27] <strcat> sbalmos: LLVM bitcode is fundamentally platform dependent
[19:13:41] <strcat> not because of register assignment, that's done in codegen
[19:13:57] <strcat> alignment, data layout, ABI for parameter passing/returns, etc. is all platform dependent
[19:14:09] <sbalmos> strcat: Ya, I know. Read the blog/paper where someone discussed whether bitcode could be platform-independent distributable.
[19:14:18] <strcat> how you pass 'struct { i32, i32, i32 }' depends entirely on the platform
[19:14:27] <strcat> sbalmos: well, LLVM bitcode isn't that
[19:14:35] <strcat> PNaCl is, and it's not LLVM bitcode
[19:14:48] <o11c> for restricted cases, you can generate platform-independent bitcode
[19:14:57] <sbalmos> strcat: Never heard of that one. My next level up would've been LLVM ASM
[19:15:03] <strcat> https://developers.google.com/native-client/dev/reference/pnacl-bitcode-abi
[19:15:13] <o11c> but you can't call most functions from libc
[19:15:39] <o11c> and you *certainly* can't make system calls yourself
[19:15:44] *** Quits: Savago (Savago@44759A70.40BDE760.18DDB669.IP) (Ping timeout)
[19:15:48] <strcat> o11c: for really restricted cases, sure, but a complete LLVM module is platform dependent
[19:16:04] *** Quits: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:16:07] <o11c> I've had some thoughts about writing code that's guaranteed to get DCE'd once that platform is known
[19:16:11] <sbalmos> strcat: thx. More to digest. :)
[19:16:29] <o11c> but I still don't think it would be able to handle, say, x32
[19:16:44] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[19:16:47] *** Joins: Savago (Savago@44759A70.40BDE760.18DDB669.IP)
[19:17:18] <strcat> o11c: a complete module has a target datalayout and target triple string afaik
[19:17:57] <strcat> maybe optional
[19:18:08] *** Joins: dagnir (chatzilla@A1D3E7F1.DBF4469E.7E8D5209.IP)
[19:18:28] <o11c> the triple string is ignored for optimizations AFAICT
[19:18:41] <o11c> the datalayout stirng is useful, but I think it's the same for x86 and x32
[19:18:55] <o11c> but x32 has different C types than x86, e.g. time_t
[19:18:59] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Quit: leaving)
[19:19:11] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:19:29] <strcat> o11c: and LLVM will output vector types matching SSE2 for it
[19:19:30] *** Quits: brson_ (brson@moz-7B0110AD.mv.mozilla.com) (Quit: leaving)
[19:19:32] <strcat> since the baseline arch has it
[19:19:34] *** Joins: brson (brson@moz-7B0110AD.mv.mozilla.com)
[19:19:34] *** ChanServ sets mode: +ao brson brson
[19:20:11] <strcat> it will output <double * 2>, <float * 4>, etc. for x86_64/x32 without a specific CPU
[19:20:21] *** Quits: Jesse (jruderman@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[19:20:48] <strcat> seems kind of pointless to abuse LLVM bitcode for that
[19:20:52] <strcat> PNaCl exists
[19:21:03] <strcat> does everything required to make it platform independent
[19:21:12] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[19:21:44] <strcat> strict portable alignment requirements, etc.
[19:22:11] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[19:22:38] <o11c> "platform independent" for a very limited number of platforms, not including x32
[19:22:58] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[19:23:46] <sbalmos> interesting stuff
[19:23:50] *** Joins: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr)
[19:24:03] <strcat> o11c: why wouldn't it work on x32?
[19:24:15] <o11c> it only lists x86, x64, arm, and mips
[19:24:27] <pcwalton> PNaCl is also not free of undefined behavior :(
[19:24:46] <strcat> o11c: that's what google supports, not what it fundamentally supports
[19:25:13] * pcwalton worries that if PNaCl takes off we are going to have to start standardizing the undefined behavior of LLVM
[19:25:18] <pcwalton> which would be a disaster
[19:25:23] <sbalmos> heh
[19:25:27] <pcwalton> for backwards compatibility with web content :(
[19:25:31] *** Quits: maxiepoo_ (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo_)
[19:25:54] <pcwalton> that's the most irresponsible thing google did with pnacl
[19:25:57] <pcwalton> IMHO anyway
[19:27:26] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[19:27:29] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[19:27:56] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[19:28:18] <Ms2ger> No, the irresponsible bit *was* PNaCl
[19:28:35] <pcwalton> I agree, but the undefined behavior is the worst part :)
[19:29:25] <sbalmos> What other alternative is there, if you wanted to still be platform-independent (reasonably) LLVM... or something similar?
[19:29:41] <sbalmos> (mind you, I'm coming from pure bytecode land of CIL & JVM bytecode. Which is damn heavy-handed0
[19:29:52] *** Quits: brson (brson@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[19:29:52] <strcat> sbalmos: distribute source code, compile it, seems to work well
[19:30:07] <o11c> well, at some point, you *do* need to ship your own platform-dependent bits. Not necessarily one for each platform, but at least one for each pointer size and one for x32
[19:30:13] <pcwalton> asmjs ;)
[19:30:31] <o11c> pointer size you can actually handle
[19:31:08] <o11c> the IR is unreadable, but you *can* store integers as {}* and cast to i64 when you need to do math on them
[19:31:40] <o11c> but x32 messes with everything
[19:32:23] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[19:32:23] *** ChanServ sets mode: +ao brson brson
[19:33:02] <sbalmos> strcat: *shrug*. Also thinking from an obfuscation perspective (damn corporate side coming out now). Maybe it is just a tar-gz under the covers. But maybe that's encrypted with an OS key.
[19:33:42] * o11c hates "security" by obscurity
[19:33:50] <o11c> if you can run it, you can read it
[19:34:10] <sbalmos> o11c: Don't disagree in principle. But realistically, there is an IP-protection component
[19:34:46] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[19:34:55] <strcat> that's what copyright is for
[19:35:04] *** Quits: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net) (Ping timeout)
[19:35:11] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[19:35:24] *** Quits: peterdn (chatzilla@moz-30BAAE88.as13285.net) (Ping timeout)
[19:35:25] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[19:35:25] <o11c> sbalmos: realistically, all such "security" is broken without days, if not hours
[19:37:07] <acrichto> pcwalton: do you have any idea what's going on in https://github.com/mozilla/rust/issues/10613 ?
[19:37:44] <sbalmos> o11c: Just playing devil's advocate
[19:38:08] *** Joins: Kruppe (user@moz-98AB5058.net.uwaterloo.ca)
[19:38:21] <o11c> and I out-advocated you
[19:38:25] <sfackler> acrichto: wouldn't llvm compile the memcpy intrinsic to that?
[19:38:45] <acrichto> sfackler: but why is the length 7?
[19:38:54] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[19:38:59] <acrichto> sfackler: there is nothin of length 7 that I know of
[19:40:08] <acrichto> oh whoa
[19:40:13] <acrichto> this is because of the discriminant
[19:40:14] *** Quits: GeneralMaximus (ankur@A6F89B8C.1D173DC.274D17D6.IP) (Quit: Computer has gone to sleep.)
[19:40:21] *** Joins: echristo (echristo@24D1937F.D6CCE4AE.77834EAA.IP)
[19:40:32] <o11c> what's the IR at -O0 ?
[19:40:51] <acrichto> worse, but this should be a much more readily optimizable case
[19:41:06] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[19:41:21] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[19:41:44] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[19:42:09] <strcat> acrichto: it can't optimize it
[19:42:16] <strcat> it's rust's fault
[19:42:30] <strcat> an &mut parameter can point to memory that will trap on a write
[19:42:32] <acrichto> strcat: it is, our discriminants are causing that, #[repr(uint)] makes good optimization again
[19:42:44] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[19:42:47] *** Quits: jdm (jdm@moz-ED0C7AC7.hinet-ip.hinet.net) (Quit: Lost terminal)
[19:42:48] <pcwalton> acrichto: interesting. I've seen similar weird memcpys in servo.
[19:42:54] <sbalmos> o11c: Didn't know I was advocating in the first place. :P Was just discussing.
[19:43:00] <strcat> LLVM can't optimize writes to output parameters
[19:43:03] <acrichto> pcwalton: this is because of the discriminant patch, updating the bug...
[19:43:29] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[19:43:39] <strcat> anyway we need a way to mark borrowed ptr parameters as valid
[19:43:50] <strcat> sadly LLVM doesn't have it.
[19:43:57] <strcat> just sret for the output parameter
[19:44:05] <pcwalton> strcat: that doesn't explain why #repr(uint) fixes it
[19:44:19] <acrichto> pcwalton: strcat: updated the bug
[19:44:21] <strcat> look at it pre-optimization then
[19:44:50] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[19:45:22] <mark_edward> pcwalton: ping
[19:45:28] <pcwalton> mark_edward: pong
[19:46:21] <mark_edward> I've seen a lot of discussion on IRC about DST's and vectors etc. And your mind seems to have changed since your last blog post
[19:46:49] <pcwalton> I haven't blogged lately, do you mean nmatsakis ?
[19:47:01] <mark_edward> I was wondering if you could write another to clarify things to the community, since what's going on in your head is a big deal to Rust
[19:47:28] <pcwalton> it'll all end up in the meeting minutes
[19:47:41] <mark_edward> pcwalton: not sure! Did he do that writeup on DST's and vectors?
[19:47:49] <mark_edward> When's the next meeting?
[19:48:09] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[19:48:09] *** ChanServ sets mode: +ao brson brson
[19:48:35] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[19:51:16] <pcwalton> Tuesday
[19:51:17] <pcwalton> and yeah he did
[19:54:21] <mark_edward> Cool,
[19:55:26] *** Quits: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP) (Quit: eholk)
[19:55:48] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[19:59:24] *** Quits: abinader (abinader@D8B9C081.E820043D.D4C04133.IP) (Quit: Fui!)
[19:59:37] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[20:00:13] *** Joins: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP)
[20:03:00] *** Quits: zootm (calum@moz-150DDDC2.sgyl.cable.virginm.net) (Ping timeout)
[20:04:17] *** Quits: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP) (Ping timeout)
[20:04:23] *** Joins: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP)
[20:05:23] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[20:07:42] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Client exited)
[20:09:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[20:11:15] *** Quits: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP) (Ping timeout)
[20:11:31] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:11:51] *** Joins: mikezaby (mikezaby@moz-AA896205.home.otenet.gr)
[20:11:55] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[20:12:34] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:12:55] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:13:20] *** Joins: steveklabnik (steveklabn@moz-74512D7C.nycmny.fios.verizon.net)
[20:14:53] *** Quits: Kruppe (user@moz-98AB5058.net.uwaterloo.ca) (Ping timeout)
[20:14:55] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[20:15:18] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:17:46] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[20:18:33] *** Quits: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP) (Ping timeout)
[20:18:38] *** Joins: FreeFull (freefull@E424A224.387C8A0C.DC9D01B1.IP)
[20:19:52] *** Quits: Savago (Savago@44759A70.40BDE760.18DDB669.IP) (Quit: Savago)
[20:19:52] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[20:21:46] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[20:22:49] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[20:23:45] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[20:25:41] *** Quits: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP) (Ping timeout)
[20:26:35] *** Joins: montezuma (Mibbit@moz-A653BFD7.hsd1.tn.comcast.net)
[20:27:00] *** Quits: montezuma (Mibbit@moz-A653BFD7.hsd1.tn.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:27:35] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[20:28:13] *** Joins: mib_hhtfjx (Mibbit@moz-3213C615.wavecable.com)
[20:28:33] <mib_hhtfjx> Is vim indent and source supposed to look like this? http://i.imgur.com/4rEV20Z.png
[20:29:02] <steveklabnik> nope, it should be four spaces
[20:29:12] <strcat> mib_hhtfjx: do you have filetype plugins/indent support enabled?
[20:29:23] <mib_hhtfjx> ?
[20:29:42] <strcat> vim doesn't use filetype plugins and indent files by default
[20:30:38] <mib_hhtfjx> I believe I do. Here's my .vimrc. https://pastee.org/sn5yf
[20:30:55] <steveklabnik> filetype plugin indent off
[20:30:58] <steveklabnik> it's off ;)
[20:31:05] <Scriptor> he sets it back on later
[20:31:14] <steveklabnik> duhhhhh
[20:31:15] <steveklabnik> sorry
[20:31:27] <strcat> mib_hhtfjx: and the rust indent/plugin/syntax files are installed? *shrug*, worksforme ;p
[20:31:51] * mib_hhtfjx nods
[20:31:59] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[20:32:11] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[20:33:15] <Scriptor> how did you install them? Copying the files into their respective directories?
[20:34:49] <mib_hhtfjx> Nevermind, fixed it.
[20:35:00] *** Joins: jstevans1 (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[20:35:01] * mib_hhtfjx realized he should've just used cp -R ;)
[20:35:55] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[20:37:19] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[20:37:39] *** Quits: jstevans1 (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[20:39:45] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[20:40:05] *** Quits: Ms2ger (Ms2ger@moz-1B43DE50.adsl-dyn.isp.belgacom.be) (Quit: nn)
[20:41:00] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[20:41:03] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[20:42:38] *** Quits: sam113101 (sam@moz-ADDDDFB1.mc.videotron.ca) (Quit: WeeChat 0.4.3-dev)
[20:44:32] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:44:54] *** Joins: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP)
[20:46:34] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[20:46:51] *** Quits: KindOne (KindOne@moz-D386F8D6.dynamic.ip.windstream.net) (Ping timeout)
[20:47:01] *** Quits: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP) (Ping timeout)
[20:47:59] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[20:48:41] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:49:42] *** Quits: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk) (Quit: Ex-Chat)
[20:50:42] *** Quits: eholk (eholk@CB4A62ED.7EDA02CF.51B6877.IP) (Quit: eholk)
[20:54:08] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[20:55:05] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[20:57:40] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:57:59] *** Quits: marshall_law (marshall@BCC5EC56.B2070AF7.505F6A0C.IP) (Ping timeout)
[20:58:18] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[21:01:02] *** Quits: steveklabnik (steveklabn@moz-74512D7C.nycmny.fios.verizon.net) (Ping timeout)
[21:01:21] *** Parts: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) ()
[21:04:33] *** Quits: beifeng (Mibbit@32B41A.FA7FF645.C7DB8B78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:05:51] <mib_hhtfjx> This looks interesting. http://www.rustforrubyists.com/book/book.html
[21:05:53] *** Joins: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net)
[21:07:05] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[21:08:42] <bstrie> mib_hhtfjx: yes, I hear it is highly recommended :)
[21:09:46] <mib_hhtfjx> It says to use rust instead of rustc though. I'm trying to let the author know it won't exist officially soon.
[21:10:00] <bstrie> mib_hhtfjx: steve is in here once in a while...
[21:10:26] <mib_hhtfjx> Ah, okay.
[21:10:33] <mib_hhtfjx> I guess I won't have to then.
[21:10:34] *** Joins: valenting (Thunderbir@808EE6B5.84D5EFD5.FB866788.IP)
[21:12:03] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:13:34] *** Quits: Jackneill (Jackneill@moz-5FBD4CA5.pool.digikabel.hu) (Input/output error)
[21:14:46] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:14:54] *** Joins: eholk (eholk@86C1F981.203A7E5B.51B6877.IP)
[21:16:18] *** Joins: dherman_ (dherman@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:16:50] *** Quits: mikezaby (mikezaby@moz-AA896205.home.otenet.gr) (Input/output error)
[21:18:56] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[21:19:25] *** Quits: eholk (eholk@86C1F981.203A7E5B.51B6877.IP) (Ping timeout)
[21:22:38] *** jorendorff_away is now known as jorendorff
[21:22:40] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[21:24:25] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[21:24:54] <wycats_> I'm trying to iterate over a ~[Option<T>] and then, inside the iteration, match the T into Some and None arms
[21:24:57] *** Quits: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP) (Quit: WeeChat 0.4.2)
[21:25:07] *** Joins: japaric (japaric@B17EFFD8.A23A5F6C.E5B504CC.IP)
[21:25:52] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[21:25:54] <kimundi> wycats_: Yes?
[21:26:16] <wycats_> https://gist.github.com/wycats/d818c9fd21be4464e31a#file-trace-rs-L160-L173
[21:26:19] <wycats_> that's the code
[21:26:35] <wycats_> I get:
[21:26:36] <wycats_> trace.rs:168:7: 168:23 error: cannot move out of dereference of & pointer
[21:26:36] <wycats_> trace.rs:168       &Some(annotation) => {
[21:26:39] <nmatsakis> wycats_: you probably want Some(ref annotation)
[21:26:57] <nmatsakis> wycats_: i.e., borrow the annotation from the Some, don't take it out
[21:27:01] *** Quits: ianj (ianjneu@moz-7140CF01.ccs.neu.edu) (Quit: leaving)
[21:27:09] <wycats_> success
[21:27:09] *** Quits: jordyd (jordyd@moz-F956A47D.seg43.ucf.edu) (Ping timeout)
[21:27:25] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[21:27:37] <wycats_> what does `ref` mean?
[21:28:07] *** Joins: derek_c (derek@moz-FB4F1795.cit.cornell.edu)
[21:28:37] <bstrie> wycats_: match arms are patterns
[21:28:48] <bstrie> wycats_: and &foo in a pattern means "match a reference to foo"
[21:29:20] <bstrie> wycats_: and hence would just allow you to refer to foo directly in the match body
[21:29:25] <bstrie> without having to dereference
[21:29:47] <nmatsakis> wycats_: a `ref` binding creates a borrowed pointer into the thing being matched
[21:29:51] <bstrie> if you actually *want* a reference to foo, you have to use "ref"
[21:30:18] <nmatsakis> wycats_: a non-ref binding takes the data out of the thing being matched; this is illegal, though, if the thing being matched is the contents of a borrowed pointer
[21:30:24] <derek_c> what do you do if you want two tasks to use the same variable, which is protected by a lock?  I mean, what would be the type of that variable?
[21:30:32] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[21:30:35] <nmatsakis> wycats_: in other words, if you do Some(foo) then you own the foo
[21:30:43] <bstrie> derek_c: I think that's the use case for the Arc type
[21:30:56] <nmatsakis> RwArc more likely
[21:31:23] <nmatsakis> but derek_c i'd suggest finding another sol'n if you can :) e.g., having a third task that controls the shraed data and communicates via messaging.
[21:31:46] <derek_c> interesting! thanks :)
[21:33:52] *** Joins: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net)
[21:34:23] <Luqman> nmatsakis: did you see https://mail.mozilla.org/pipermail/rust-dev/2013-November/006924.html ? i would expect rustc to not let you use x but i guess it ends up working because it's implicitly copyable
[21:35:17] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[21:36:02] <nmatsakis> Luqman: ha. that's... interesting. I'd call that a bug.
[21:36:22] <nmatsakis> Luqman: in particular, it ought to be passing a copy of `x` as the self param
[21:36:43] <nmatsakis> Luqman: `x` should still be usable afterwards, yes
[21:37:02] <Luqman> ah ok, that is more consistent
[21:37:09] *** Joins: peterdn (chatzilla@moz-D11BA78C.as13285.net)
[21:37:49] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[21:38:01] <benh> hm, wasn't sprocketnes updated for that talk?
[21:39:04] <wycats_> nmatsakis: so Some(foo) will trigger a deallocation when the arm is exited if the original pointer was a ~Foo?
[21:39:22] <nmatsakis> wycats_: if you mean Option<~Foo> then yes
[21:39:32] <wycats_> yes, in the case of an Option<~Foo>
[21:39:33] <wycats_> interesting
[21:39:49] <nmatsakis> wycats_: one use for that is "unwrapping" the option: let contents = match option { Some(v) => v, None => fail!() }
[21:39:54] <wycats_> makes sense
[21:40:04] <wycats_> related question: why do I have to &None and &Some(annotation) (the & prefix)
[21:40:23] <bstrie> wycats_: you shouldn't?
[21:40:24] <nmatsakis> wycats_: because we are not as magical as yo'd like :)
[21:40:31] <bstrie> need to see the code again
[21:40:36] <wycats_> https://gist.github.com/wycats/d818c9fd21be4464e31a#file-trace-rs-L160-L173
[21:40:37] <bstrie> I've never seen anyone resort to &None
[21:40:51] <nmatsakis> wycats_: usually, we write `match *foo { ... }`
[21:41:07] <nmatsakis> wycats_: but either way we don't hide the fact that it's a reference
[21:41:09] <wycats_> nmatsakis: ahhhh
[21:41:11] <bstrie> ah, that's why I've never seen it before
[21:41:27] <wycats_> such dereference
[21:41:37] <bstrie> so pointer
[21:41:42] <wycats_> wow
[21:41:44] <bstrie> haha
[21:42:02] <wycats_> this meme is getting too much play in Tilde HQ
[21:42:07] <bstrie> wycats_: patterns also exist in assignment position. which is why `let (x, y) = some_function();` works
[21:42:20] <SiegeLord> I'd even stick the dereference into the for loop... like for (index, &annotation)
[21:42:30] <nmatsakis> SiegeLord: in this case that'd be illegal.
[21:42:31] <SiegeLord> Although maybe that'll lead to a copy...
[21:42:35] <SiegeLord> Yeah, nvm
[21:43:43] <wycats_> I'm trying to write a compact() for an array and it is proving tricky :P
[21:43:52] <nmatsakis> what does compact() do
[21:43:58] <wycats_> removes all Nones
[21:44:02] <wycats_> my strategy is:
[21:44:06] <wycats_> iterate over the vector
[21:44:13] <nmatsakis> wycats_: in place, I presume? filtering is easy :)
[21:44:13] <wycats_> keep a "last" pointer
[21:44:18] <wycats_> in place yeah
[21:44:24] <wycats_> if I see a None, move on
[21:44:36] <wycats_> if I see a Some, swap it with the last and increment last
[21:44:45] <wycats_> at the end, truncate to the last
[21:44:49] <nmatsakis> wycats_: hold on 1 sec, there's an easier way :)
[21:44:52] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[21:44:53] <wycats_> but ownership is pwning me
[21:44:53] <wycats_> ok
[21:45:10] <nmatsakis> oh, wait, do you care about ordering?
[21:45:15] <wycats_> yes
[21:45:15] <nmatsakis> I guess you probably do
[21:45:26] <wycats_> the whole story here is that I start with a linear list of nodes with parents
[21:45:31] <wycats_> move the children into their parents
[21:45:36] <wycats_> and then want to compact the original array
[21:46:07] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[21:46:07] <wycats_> the reason for the list representation is so I can give a uint to C, which can refer to the annotations by position
[21:46:17] *** Quits: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net) (Input/output error)
[21:46:23] *** Joins: ssbr (~ssbr@46FE74EC.C60FE7DC.4065847B.IP)
[21:46:37] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[21:46:41] <nmatsakis> one sec...let me experiment briefly
[21:46:45] <nmatsakis> good distraction from what I should be doing
[21:46:56] <wycats_> mmmmm
[21:47:01] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse_)
[21:47:27] <Luqman> nmatsakis: ha, so it seems like the right behaviour happens if you add another field to Value. (i.e with non-immediate implictly copyable structs)
[21:48:13] <bascule>  13_4__8__ 9_11__12_  13_4__ 8_9__11_    13_ 4_8_   11__12_ 13_ 4_ 
[21:48:16] <bascule> 4|  8_9__11|  12_ 13\4|_ 8_9|  11_ 12\  4/ 8\\ 9\ 11/ 12/ 13| 4| 8|
[21:48:19] <bascule> 8| 9|_  12| 13|_4) 8|| 9|11| 12| 13| 4|/ 8_ 9\11\ 12V 13/| 4| 8| 9|
[21:48:22] <bascule> 9|  11_12| 13|  4_ 8< 9| 11|12| 13|_4| 8/ 9__11_ 12\| 13| 4|8_|9_|11_|
[21:48:25] <bascule> 11|_12|   4|_8| 9\_11\_12__13|_4__8_/9_/   12\13_\4_| 8(9_|11_|12_)
[21:48:28] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:48:28] <bascule>                                         
[21:48:31] <bascule> :D
[21:48:45] <bstrie> is there really a program that makes these things
[21:49:08] <bstrie> or are you just really, really dedicated to your craft
[21:49:24] <bascule> there is a program!
[21:49:26] <bascule> it's called toilet!
[21:49:27] <bascule> lol
[21:49:58] <bascule> gotta get down on friday
[21:50:12] <nmatsakis> Luqman: that makes sense
[21:50:29] <bstrie> rust-buildbot: dance
[21:50:30] <nmatsakis> wycats_: https://gist.github.com/nikomatsakis/7607473
[21:50:31] <rust-buildbot> <(^.^<)
[21:50:32] <rust-buildbot> <(^.^)>
[21:50:33] <rust-buildbot> (>^.^)>
[21:50:33] <rust-buildbot> (7^.^)7
[21:50:35] <rust-buildbot> (>^.^<)
[21:50:39] <nmatsakis> wycats_: that.. was bsaically the algorithm you said, right?
[21:50:39] <bstrie> it is a party in here
[21:50:41] <wycats_> that was fast
[21:50:47] <wycats_> bascule has joined
[21:51:03] <wycats_> I think so yeah
[21:52:14] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[21:52:22] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[21:52:40] <bstrie> that code is... beautiful
[21:52:40] <bascule> wycats_: hahaha
[21:52:41] * bstrie weeps
[21:52:50] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[21:53:04] <wycats_> nmatsakis: so you're suggesting I go with that code?
[21:53:09] <wycats_> or is there something easier, as you suspected
[21:53:29] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:53:47] <nmatsakis> wycats_: I'd go with that, I was going to say you can use swap_remove, but it doesn't preserve ordering
[21:54:19] <nmatsakis> wycats_: and it's not really that much simpler anyway.
[21:54:29] <bstrie> maybe someone should add that as a method on vectors
[21:55:00] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:55:04] <wycats_> so why wasn't this working for me?
[21:55:10] <wycats_> lemme gist what I had
[21:55:45] <wycats_> https://gist.github.com/wycats/80ccdfd0cbfa5c79c1e9#file-trace-rs-L160-L174
[21:55:53] <wycats_> I'm trying to borrow annotations mutably twice
[21:55:56] <wycats_> how do you avoid that?
[21:56:02] <wycats_> ah you don't iterate
[21:56:06] <bstrie> wycats_: I believe that's why, yeah
[21:56:06] <wycats_> you use a while loop
[21:56:09] <bstrie> why he used a while loop
[21:56:15] <wycats_> makes sense
[21:56:17] <wycats_> scumbag ownership
[21:56:21] <wycats_> :trollface:
[21:56:40] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[21:58:09] <bstrie> wycats_: this is also the reason for strangely specific methods like this one on hashmaps: http://static.rust-lang.org/doc/master/std/hashmap/struct.HashMap.html#method.insert_or_update_with
[21:58:56] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[21:58:58] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[21:59:16] <bstrie> wycats_: really the problem is scumbag mutability :P
[21:59:32] <wycats_> bstrie: yeah it's true
[21:59:40] <wycats_> hopefully this whole strategy will work
[21:59:42] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[21:59:50] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:59:58] <wycats_> I realized yesterday that if Rust wasn't looking out for me I would have given C a bunch of pointers to a possibly relocatable growable vector
[22:00:08] <wycats_> to entries inside of one anyway
[22:00:13] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[22:00:30] <wycats_> only after acrichto told me "that vector could be relocated" did I realize why the compiler was yelling at me
[22:00:55] <bstrie> then the borrow checker has been worth it
[22:01:00] <bstrie> nmatsakis can die happy
[22:01:02] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[22:01:05] <nmatsakis> I felt very gratified when I fixed up some borrow checker bugs at one point, correct rustc to deal with the resulting errors, and had a bunch of unexplained crashes go away 
[22:01:16] <sp3d> nice
[22:01:35] <wycats_> bstrie: hehe
[22:01:42] <wycats_> bstrie: better error messages would be very nice
[22:01:46] <wycats_> links to scenarios
[22:01:46] <bstrie> that would be a good quote for the back of the rust book dust jacket
[22:01:48] <wycats_> haha
[22:02:00] <wycats_> quote the hell out of me ;)
[22:02:25] <wycats_> also, I wish that the error messages for "you gave me a ~ and I expected a &" or whatever would tell you what to type to convert the first to the second
[22:03:22] <bstrie> wycats_: until I set up a RUST TESTIMONIALS site you will just have to plug us on twitter
[22:03:27] <wycats_> bstrie: truth
[22:03:31] <wycats_> lemme do that
[22:03:35] <wycats_> I have a Rust custom list :P
[22:03:45] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[22:03:57] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:04:44] <wycats_> one sec digging it up
[22:05:04] <wycats_> https://twitter.com/wycats/timelines/400421579042983936
[22:06:02] <wycats_> https://twitter.com/wycats/status/404007849400877058
[22:06:03] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[22:06:09] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[22:06:27] <nmatsakis> wycats_: we have a longstanding bug to have links to FAQ entries explaining the messages in detail, with examples of errorneous code
[22:06:35] <wycats_> nmatsakis: yeah makes sense
[22:06:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:06:42] <wycats_> we have a similar bug for Ember asserts :P
[22:06:57] <bstrie> wycats_: what the heck is the wizardry
[22:07:00] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:07:08] <wycats_> wizardry?
[22:07:08] <bstrie> "timelines"
[22:07:11] <wycats_> hahaha
[22:07:17] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[22:07:17] <wycats_> you mean "this wizardry"?
[22:07:31] <bstrie> indeedely do
[22:07:43] <wycats_> :)
[22:07:47] <wycats_> https://blog.twitter.com/2013/custom-timelines-in-tweetdeck
[22:08:28] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[22:08:40] <wycats_> such wizard
[22:09:25] <bstrie> I swear, I used to proofread before I typed things
[22:09:34] <bstrie> I would spent eight hours writing a single paragraph for a blog post
[22:09:37] <bstrie> it was bad for my heart
[22:09:46] <bstrie> my doctor told me to stop caring about putting text on the internet
[22:10:12] <bstrie> it's very liberating
[22:10:30] <wycats_> https://www.monosnap.com/image/OSYkVnEmAioSQGUDSftFEvUoL
[22:10:37] <wycats_> bstrie: lolol
[22:10:43] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[22:10:49] <wycats_> I can drag items from the right bar to the timeline
[22:10:59] <wycats_> I've been curating a "Rust" timeline this way
[22:11:32] <wycats_> nmatsakis: why do you need a kept count?
[22:11:43] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[22:11:54] <wycats_> ah your kept is my last
[22:11:58] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:12:02] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:12:06] <wycats_> and you added last because of the while loop
[22:12:07] <wycats_> got it
[22:12:20] <nmatsakis> wycats_: yeah last isn't really needed
[22:12:25] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:12:25] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:12:31] <nmatsakis> wycats_: if I were condensing it I'd write `while i < x.len()`
[22:12:34] <wycats_> right
[22:12:39] <nmatsakis> I thought I'd use it
[22:12:40] <wycats_> code.compact()
[22:12:48] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:12:48] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:13:06] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:13:07] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:13:11] <wycats_> nmatsakis: acrichto told me to ask you about the rationale for nuking do {} btw
[22:13:19] <wycats_> I was enjoying using do with and_then
[22:13:26] <wycats_> although... and_then requires you to return Option<T>
[22:13:28] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[22:13:30] <wycats_> which isn't really what I wanted
[22:13:41] <bstrie> nmatsakis: wouldn't that call a method with every iteration? wasteful :P
[22:13:42] <dbaupp> wycats_: sounds like you want .map?
[22:13:49] <wycats_> but in general, something like do option.if_some |value| { } is nice
[22:13:54] <wycats_> yeah
[22:13:55] <wycats_> confirm
[22:14:02] <wycats_> but still, do option.map |value| { }
[22:14:09] <wycats_> I think map requires returning a T
[22:14:11] <wycats_> iirc
[22:14:21] <nmatsakis> wycats_: rationale is to make distinction between closures/procs clearer
[22:14:30] <wycats_> this is for purely side-effecting uses
[22:14:32] <nmatsakis> procs copy the values that they capture from the stack
[22:14:36] <nmatsakis> whereas closures mutate them in place
[22:14:46] <wycats_> nmatsakis: and therefore procs are single-use
[22:14:46] <nmatsakis> if you have do be 'ambidexterous' (as it is today),
[22:14:47] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:15:08] <nmatsakis> then you can't tell whether `do foo |...| { ... }` allocates a proc or what
[22:15:13] <nmatsakis> which can sometimes affect the semantics
[22:15:27] <nmatsakis> it's something we've all found to be confusing in the past sometimes
[22:15:32] <dbaupp> wycats_: `for x in option.iter() { ... }` works (i.e. treat option as a zero-or-one element container), although it looks a little strange.
[22:15:32] <bstrie> wycats_: this discussion on closures has been a long, long road
[22:15:34] <nmatsakis> so we thought it'd be simpler to have do imply proc
[22:15:45] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[22:15:55] <bstrie> wycats_: and of course, you can still do all the same stuff, just with a bit less sugar
[22:16:04] <nmatsakis> it's not a strictly necessary change, just further pushing on this theme of being able to read a caller independently of its callees to the extent possible
[22:16:08] <wycats_> nmatsakis: and the problem is that things like and_then take closures, not procs?
[22:16:14] <nmatsakis> yes.
[22:16:15] <wycats_> which makes do fail?
[22:16:25] <wycats_> nmatsakis: hmmm
[22:16:29] <nmatsakis> wycats_: I mean you can write: option.map(|value| { ... })
[22:16:34] <nmatsakis> I guess it's uglier
[22:16:37] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:16:37] <wycats_> so what was the rationale for making it imply proc but not closure
[22:16:40] <nmatsakis> I've kind of come to favor it
[22:16:43] <wycats_> nmatsakis: the bigger issue was the return value
[22:16:48] <nmatsakis> wycats_: basically we want to be able to write: "do spawn { ... }"
[22:16:50] <nmatsakis> :)
[22:16:53] <wycats_> nmatsakis: hahaha
[22:16:59] <wycats_> scenario solving at its best
[22:17:03] <bstrie> wycats_: you laugh, but this has been a recurring theme
[22:17:07] <bstrie> everyone likes `do spawn`
[22:17:18] * nmatsakis not kidding at all
[22:17:25] <nmatsakis> actually I'd porbably just nuke `do`
[22:17:29] <nmatsakis> but I'm heartless
[22:17:35] * nmatsakis likes ugly
[22:17:47] <wycats_> nmatsakis: I can tell, I'm a Rust user
[22:17:50] <wycats_> I kid I kid
[22:18:04] <wycats_> nmatsakis: do you understand what I mean by return value?
[22:18:17] <wycats_> a lot of these calls are done for side-effecting reasons only
[22:18:19] *** Joins: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net)
[22:18:25] <wycats_> and the mandatory return values make them clumsy to work with
[22:18:43] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:18:48] <nmatsakis> because you need a semi-colon?
[22:19:00] <nmatsakis> or just because you must return something?
[22:19:12] <nmatsakis> I think you're just using the wrong method :)
[22:19:19] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:19:20] <dbaupp> wycats_: you can just return () and let the compiler cope with an unused Option<()>, fwiw.
[22:19:27] <wycats_> dbaupp: yeah it's ugly
[22:19:29] <nmatsakis> wycats_: also we often have some non-returning variants
[22:19:37] <nmatsakis> e.g., for x in option.iter() { }
[22:19:44] <wycats_> nmatsakis: right
[22:19:50] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[22:19:59] <wycats_> but isn't "I have an Option and I want to do some work but only if it's not None" pretty common?
[22:20:07] <wycats_> there's no non-returning variant for that, unless I missed it
[22:20:20] <nmatsakis> I think that's supposed to be iteration
[22:20:34] <wycats_> nmatsakis: do you think it makes sense to think about this as iteration?
[22:20:44] <wycats_> in other languages what you would type is if option { }
[22:20:45] *** Quits: alisdair (textual@moz-2F3322CF.hsd1.tx.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:20:53] <nmatsakis> if option.is_some() { ... }
[22:21:04] <nmatsakis> but I find it helpful to think of an option as a 0-or-1-element list
[22:21:05] <wycats_> but then you also have to unwrap
[22:21:06] <dbaupp> match { Some(..) => {}, None => () }
[22:21:11] <nmatsakis> plus it tells you what names to use :)
[22:21:17] <nmatsakis> we spent a long time periodically renaming all the methods on option
[22:21:22] <nmatsakis> we stll do of course :)
[22:21:27] <wycats_> I think you want something terse like: do option.if |value| { }
[22:21:39] <wycats_> option.if(|value| ... )
[22:21:47] <wycats_> the problem isn't really the name
[22:21:49] <wycats_> it's the return value
[22:21:50] <nmatsakis> wycats_: keep in mind also that you don't have to return a return value
[22:21:52] <nmatsakis> I mean:
[22:22:08] <nmatsakis> option.map(|val| { foo; bar; }) produces Option<()>...?
[22:22:13] <nmatsakis> I guess you then need a trailing semi
[22:22:17] <nmatsakis> option.map(|val| { foo; bar; });
[22:22:30] <wycats_> trailing semi didn't wokr
[22:22:31] <wycats_> work
[22:22:35] <wycats_> I tried that
[22:22:38] <wycats_> oh wait
[22:22:41] <wycats_> maybe it worked with {{}
[22:22:42] <wycats_> {}
[22:22:49] <nmatsakis> yeah, you'll need {}
[22:22:50] <wycats_> but you can't option.map(|val| foo; )
[22:22:54] <nmatsakis> right
[22:23:14] <bstrie> wycats_: if you don't like the semicolons, you can always just insert hundreds of spaces before each semicolon so that they are pushed off the right edge of your buffer
[22:23:19] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:23:21] <shachaf> Haskell calls this mapM_ (or traverse_ or for_ or something).
[22:23:23] <wycats_> bstrie: I don't mind semicolons
[22:23:29] <wycats_> it just feels like there should be an operation like this on Option that doesn't care about return value
[22:23:31] <wycats_> for side-effecting if
[22:23:32] <shachaf> I think it's useful to have an explicitly non-returning version.
[22:23:55] <nmatsakis> shachaf: eventually we'll add higher-kinded types and monads and then we can grow a bunch of things like that,
[22:23:58] <shachaf> Especially when you think about how it's nested.
[22:24:01] <nmatsakis> shachaf: but of course in haskell it IS producing a value :)
[22:24:13] <shachaf> nmatsakis: Sure, but you don't have to abstract it to recognize that it's concretely useful.
[22:24:16] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[22:24:19] <wycats_> nmatsakis: it would produce ()
[22:24:21] <shachaf> nmatsakis: Well, yes.
[22:24:39] <wycats_> I could always write an if! macro :P
[22:24:42] <wycats_> if! option { }
[22:24:52] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:24:52] <nmatsakis> if only
[22:24:59] <nmatsakis> we have to figure out how to make a macro like that work
[22:25:02] <bstrie> yeah
[22:25:09] <bstrie> it would be really really nice to have
[22:25:16] <bstrie> fortunately macros are gated for 1.0, so we can break them!
[22:25:20] <wycats_> haha
[22:25:31] <wycats_> what are the current constraints that make it not work
[22:25:34] <nmatsakis> wycats_: I'd probably call it when_some
[22:25:39] *** Quits: StarLight (StarLight@moz-45B013A5.dynamic.avangarddsl.ru) (Ping timeout)
[22:25:40] <nmatsakis> option.when_come(|v| ...)
[22:25:44] <wycats_> nmatsakis: sure
[22:25:49] <nmatsakis> but I've sort of come to just use `match`
[22:26:00] <nmatsakis> it takes an extra line or two, but it's so readable ...
[22:26:03] <wycats_> I don't hate match, but it's annoying because of the need to include None
[22:26:12] <bstrie> wycats_: `_ => ()`
[22:26:14] <shachaf> It seems like you could make a concrete iteration interface of some sort.
[22:26:20] <wycats_> the readability starts to reduce as it becomes mixed into more code
[22:26:28] <nmatsakis> shachaf: you mean like...iterators? ;) 
[22:26:34] <wycats_> readability matters at different granularity levels
[22:26:38] <shachaf> nmatsakis: Right, that's what I mean.
[22:26:45] <wycats_> being able to see a whole trivial method in one place is important
[22:26:51] <shachaf> But I hear Rust is totally different from a few months ago when I looked at it.
[22:26:56] <dbaupp> bstrie: and then when you have a static called `foo` `Some(foo) => ..., _ => ...` give you all sorts of enjoyable bugs :P
[22:26:58] <bstrie> wycats_: why not just define your own non-returning map method on options :) extend those built-in types!
[22:27:08] <wycats_> if you have to type a lot of 'readable' constructs that bloats up something simple it reduces the next level of granularity
[22:27:13] <wycats_> bstrie: via a Trait?
[22:27:14] <shachaf> Option is just a list that has at most one element.
[22:27:17] <bstrie> wycats_: yep
[22:27:25] <shachaf> So most things that makes sense on lists make sense on Option.
[22:27:29] <dbaupp> bstrie: *extend those defined-in-the-standard-library types :P
[22:27:29] <nmatsakis> shachaf: (we have this)
[22:27:34] <wycats_> so use wycats::ItShouldWorkLikeThisByDefault?
[22:27:47] <wycats_> ;)
[22:27:55] <bstrie> wycats_: no, not at all
[22:27:58] <shachaf> nmatsakis: Right, I know. I just don't know the concrete way you'd use it.
[22:28:02] <bstrie> wycats_: because, we_use_sname_case_here
[22:28:16] <wycats_> ItShouldWorkLikeThisByDefault would be a trait ;)
[22:28:20] <nmatsakis> shachaf: for x in option.iter() { ... }, I believe
[22:28:32] <shachaf> That's slightly verbose, but there you go.
[22:28:44] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:29:00] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[22:29:29] <bstrie> wycats_: I think you missed an opportunity to name your presentation "Ruby and C, sitting in a tree, r-u-s-t-i-n-g"
[22:30:02] <wycats_> it's true
[22:30:02] <shachaf> Can you say "for x in option { ... }"? Or could you extend it to let you say that?
[22:30:03] <nmatsakis> bstrie has a point there
[22:30:09] <wycats_> bstrie: were you there? I forget?
[22:30:20] <nmatsakis> shachaf: you can't say it, we might be able to extend it.
[22:30:24] <bstrie> shachaf: that's a planned future extension, yeah
[22:30:38] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:30:44] <bstrie> wycats_: nope, I am in pittsburgh, and caltrain doesn't run that far
[22:30:55] <bstrie> though I hear caltrain doesn't run at all most of the time
[22:31:31] <brson> bstrie: is the video up yet for wycats talk? i still can't get it to play
[22:31:55] <bstrie> brson: I've been refreshing AMO periodically, not seeing it under "recent events"
[22:32:01] <wycats_> brson: thanks for your kind words after the meetup :)
[22:32:23] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:32:56] <brson> wycats_: (^ㅂ^)
[22:33:50] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Quit: Leaving.)
[22:33:52] <wycats_> I was seriously worried I was doing insane things and you guys would be like "WTF ARE YOU DOING"
[22:33:57] <wycats_> "GET THE HELL OUT OF OUR HOUSE"
[22:34:14] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:34:49] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:35:13] <brson> wycats_ talk is really cool, he's doing a lot of wild embedding stuff including embedding the entire runtime in ruby
[22:35:54] *** Joins: bungoman (bungoman@5CF79DDD.6C181F01.F74C56B8.IP)
[22:36:23] *** Quits: derek_c (derek@moz-FB4F1795.cit.cornell.edu) (Ping timeout)
[22:37:09] <dbaupp> wycats_: we can do that if you'd like?
[22:37:22] <wycats_> dbaupp: wait until I ship :P
[22:37:48] <wycats_> nmatsakis: in your example you make last vector.len() - 1 and do while finger < last
[22:37:55] <wycats_> you mean <= right?
[22:37:58] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:38:10] <wycats_> you still have to swap the last element
[22:38:38] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[22:38:39] <nmatsakis> wycats_: I'd personally do "while finger < vec.len() { ... }"
[22:38:44] <nmatsakis> and remove last altogether
[22:38:56] <wycats_> nmatsakis: does that not end up doing a lot of unnecessary calculations?
[22:38:57] <nmatsakis> why do I have to swap the last element?
[22:39:04] <wycats_> nmatsakis: because there may be previous Nones?
[22:39:13] <wycats_> ~[ None, None, 1 ]
[22:39:17] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:39:20] <nmatsakis> wycats_: I mean I still need to swap with finger and kept
[22:39:20] <wycats_> ~[ None, None, Some(1) ]
[22:39:25] <wycats_> nmatsakis: right
[22:39:34] <wycats_> but in your code you stopped before you do anything with the last element
[22:39:37] <nmatsakis> wycats_: call vec.len() is wasteful theoretically but in practice it'll be inlined and optimized away
[22:39:39] <wycats_> wait
[22:39:40] <wycats_> I lied
[22:39:42] <wycats_> you did <=
[22:39:42] <brson> yichoi: had any problems with the debuginfo tests on android? a bunch fail for me, so I'll probably xfail them
[22:39:57] <wycats_> nmatsakis: hm... what heuristics should I use?
[22:40:03] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:40:06] <wycats_> to know when optimizations will likely be performed?
[22:40:28] <wycats_> remember my background is Ruby, where the answer is "never"
[22:40:29] <wycats_> :P
[22:40:33] <nmatsakis> wycats_: hard to say. small accessors will generally be inlined.
[22:40:39] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:40:40] *** Joins: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com)
[22:40:47] <nmatsakis> wycats_: assuming they are either intracrate or marked #[inline]
[22:40:54] <wycats_> inline isn't enough here, though, right?
[22:41:06] <wycats_> since you still have to access the len field in the struct
[22:41:13] <nmatsakis> it's possible it'll wind up reloading the length every time through the loop; depends how smart llvm is about that
[22:41:13] <dbaupp> wycats_: use `perf` to find the slow parts and don't think about it by hand/head :P
[22:41:21] <strcat> wycats_: no more expensive than accessing a local
[22:41:22] <nmatsakis> but yes I agree with dbaupp  :)
[22:41:26] <wycats_> strcat: nice
[22:41:35] <wycats_> nmatsakis: I haven't used `perf` before :(
[22:41:49] <dbaupp> `perf record ./my_program; perf report`
[22:41:49] *** Joins: brson_ (brson@moz-BBE3ABD.mv.mozilla.com)
[22:41:53] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Ping timeout)
[22:41:54] <dbaupp> (on linux)
[22:42:01] <wycats_> dbaupp: yeah I'm on Linux
[22:42:04] <wycats_> (inside of ChromeOS)
[22:42:08] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[22:42:20] *** Joins: jordyd (jordyd@7DAC4ACE.77F880E0.D9401097.IP)
[22:42:29] <dbaupp> you may need to install linux-tools or some package like that.
[22:42:38] <wycats_> should be fine
[22:42:42] <wycats_> my chroot has ubuntu
[22:42:59] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[22:43:09] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[22:43:26] <strcat> inlining is just based on a threshold
[22:43:29] <wycats_> do closures get inlined?
[22:43:31] *** Joins: StarLight (StarLight@moz-13419FB2.dynamic.avangarddsl.ru)
[22:43:35] <wycats_> or rather
[22:43:38] <strcat> any function below the threshold will be inlined
[22:43:41] <wycats_> calls to functions that take closures
[22:43:50] <strcat> wycats_: sure
[22:43:56] <wycats_> seems useful
[22:44:01] <strcat> to inline the closure itself, it has to determine that the function ptr is constant
[22:44:07] <strcat> wycats_: inlining isn't special
[22:44:18] <wycats_> strcat: I didn't think it was :)
[22:44:27] <wycats_> just don't know the heuristics that are used
[22:44:32] *** Quits: brson_ (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[22:44:33] <strcat> wycats_: a threshold
[22:44:36] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[22:44:36] *** ChanServ sets mode: +ao brson brson
[22:44:41] <strcat> LLVM counts the cost of the instructions in the function
[22:44:45] <strcat> if it's below the threshold it inlines
[22:44:51] <strcat> there won't be a missed function, it's iterative
[22:45:28] <wycats_> seems better than v8, which inlines based on the byte size of the source code :P
[22:45:31] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[22:45:47] <strcat> it only can't inline C varargs
[22:46:10] <wycats_> so do things like calls to map(closure) essentially become while loops?
[22:46:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:46:19] <strcat> wycats_: iterators become efficient loops
[22:46:41] <wycats_> right, but what about calls to functions that take closures
[22:46:48] <wycats_> where the function is implemented using a loop
[22:46:57] <strcat> calls to functions that take closures arne
[22:47:00] <strcat> aren't special*
[22:47:03] <wycats_> right
[22:47:05] <strcat> they get inlined if they're below the threshold
[22:47:19] <wycats_> does the call to the closure itself also get inlined?
[22:47:27] <strcat> the closure is inlined if LLVM proves it is a constant function ptr
[22:47:39] <strcat> which it can if you define it where you pass it
[22:47:40] <wycats_> which will often be true in this case?
[22:47:44] <wycats_> right
[22:47:45] <strcat> trivially true, yes
[22:48:06] <wycats_> so you get map(|a| a % 2) => while loop that inlines the check to a % 2 ?
[22:48:13] <strcat> sure
[22:48:16] <wycats_> seems legit
[22:48:18] <strcat> it will vectorize too
[22:48:19] <nmatsakis> the inlining heuristic is fairly complex, as I understand it: i.e., it also tries to model the advantage of inlining in terms of how much specialization it could do for parameters of constant value. I'm not sure precisely how intelligent that is tho
[22:48:24] <nmatsakis> I just think it's neat
[22:48:33] <strcat> nmatsakis: LLVM isn't very clever yet
[22:48:35] <strcat> gcc does that
[22:48:47] <nmatsakis> strcat: Chris Lattner told me personally otherwise, but the code speaks louder :)
[22:48:58] <strcat> well it does have weights for everything
[22:49:12] <strcat> afaik gcc will sometimes try inlining and then back out
[22:49:20] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: ZZZzzz…)
[22:49:23] <strcat> or partially inline
[22:49:33] <strcat> I don't think LLVM partially inlines by default or tries that
[22:49:45] <strcat> just uses costs and won't back out if it was wrong
[22:50:27] <strcat> wycats_: iterators are certainly faster than indexing with [i] and a counter
[22:50:37] <strcat> because that has bounds checks, without using unsafe_get
[22:50:42] <strcat> and LLVM sucks at eliminating them
[22:51:03] <strcat> although it often hoists it out...
[22:51:17] *** Joins: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net)
[22:51:52] <strcat> it doesn't handle fixed-size vectors well
[22:51:56] <wycats_> strcat: but iterators take ownership right?
[22:52:00] <strcat> wycats_: hm?
[22:52:15] <wycats_> strcat: if you use an iterator, you can't do mutation inside
[22:52:23] <strcat> you can use a mutable iterator
[22:52:24] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[22:52:28] <wycats_> still can't
[22:52:29] <kimundi> wycats_: Depends on the Iterator
[22:52:40] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[22:53:01] <strcat> wycats_: you can't mutate the vector directly if you have an iterator borrowed
[22:53:02] <wycats_> mut_iter lets you mutate the items, not the vector itself
[22:53:07] <wycats_> indeed
[22:53:35] <strcat> anyway it doesn't like fixed-size vectors because it doesn't understand where the length comes from
[22:53:39] <kimundi> wycats_: If you mean mutating the vector while mutably iterating over it - that has nothing to do with iterators, and everything with two &mut to the same data :P
[22:53:46] <wycats_> kimundi: indee
[22:53:48] <wycats_> indeed
[22:53:50] <strcat> and it doesn't trust that *[T, ..n] is really a valid ptr to a vector of that size
[22:53:54] <wycats_> which is why nmatsakis's solution uses a while loop
[22:53:59] <wycats_> https://gist.github.com/nikomatsakis/7607473#file-gistfile1-txt-L10
[22:54:05] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[22:54:11] *** Quits: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com) (Input/output error)
[22:54:23] *** Quits: jordyd (jordyd@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[22:55:02] <wycats_> anyway, I think I should go implement some more
[22:55:06] *** Joins: jordyd (jordyd@7DAC4ACE.77F880E0.D9401097.IP)
[22:55:08] <wycats_> MY TIME FOR LEARNING HAS COME TO AN END
[22:55:10] <wycats_> (jk)
[22:55:11] * strcat really wishes first-class aggregates were good enough to let you pass without pointers
[22:55:27] <strcat> then we wouldn't need a 'valid' attribute
[22:55:54] <dbaupp> strcat: iirc, the bounds checks on [T, .. n] get removed if you index by a type that's smaller than n (e.g. n == 1000, indexed with u8)
[22:56:03] <pcwalton> strcat++
[22:56:15] *** Joins: derek_c (derek@moz-3FCC4F91.cit.cornell.edu)
[22:56:22] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[22:56:33] <strcat> dbaupp: they don't get removed if it's inside a function receiving a fixed-size array
[22:56:54] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[22:56:55] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:57:00] <strcat> it can only remove them if it can see the array is valid
[22:57:14] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[22:57:18] <pcwalton> btw, once function/trait unification is complete it will be possible to do inlining of closures in the frontend
[22:57:42] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[22:57:43] <strcat> pcwalton: well if we have unboxed closures with unique types, they would do static calls
[22:57:45] <dbaupp> strcat: oh, ok.
[22:57:55] <pcwalton> yeah, by inlining I mean static calls, sorry
[22:58:01] <strcat> ah
[22:58:18] <strcat> I wish clang/LLVM supported -Winline
[22:58:43] <strcat> but they don't want warnings that require analysis/codegen ;(
[22:58:52] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[22:58:55] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[22:58:55] *** ChanServ sets mode: +ao brson brson
[22:59:00] <strcat> that's what clang-analyze is for.
[22:59:20] <dbaupp> it should be called clangalyise
[22:59:24] <dbaupp> *lyze
[22:59:52] <kimundi> clangalyterator
[22:59:58] *** Quits: bjz (bjz@1009100.A27A8065.D3BA2C17.IP) (Ping timeout)
[23:00:02] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[23:00:20] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[23:00:41] * kimundi tried to be funny ;|
[23:00:48] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[23:01:00] <strcat> pcwalton: do procs default to having a Send bound?
[23:01:11] <pcwalton> strcat: they *should* but I found a bug whereby they don't
[23:01:13] <pcwalton> needs to be fixed
[23:02:14] <pcwalton> hmm
[23:02:49] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:03:19] <pcwalton> I think we could perhaps change map(f: &fn(T)->U) to map<F:Func<U,T>>(f: F) backwards compatibly in post 1.0
[23:03:57] *** Joins: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca)
[23:04:01] <pcwalton> by impl<'self,T,U> Func<U,T> for 'self |T| -> U { … }
[23:04:27] <strcat> don't need 'self now :)
[23:04:30] <pcwalton> then programs would transparently get the performance upgrade
[23:04:40] <pcwalton> although I kind of doubt it will matter much in practice
[23:04:48] <pcwalton> since usually LLVM inlining devirtualizes it
[23:05:05] <strcat> pcwalton: yeah but it would let you move unboxed closures into it
[23:05:09] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Client exited)
[23:05:13] <strcat> and then you could return a Map iterator
[23:05:14] <pcwalton> it would help in some cases
[23:05:34] <strcat> well I guess not because we don't have return type inference
[23:06:15] <pcwalton> hmm
[23:06:16] *** Quits: nkoep (nik@moz-9466F5D6.pool.mediaways.net) (Ping timeout)
[23:06:36] <pcwalton> can we make `|x| x + 3` into a by-value closure backwards compatibly...
[23:06:43] *** Quits: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo_)
[23:06:44] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[23:06:51] <nmatsakis> pcwalton: actually i'd prefer to remove the default bounds, i've been meaning to bring that up in a meeting
[23:06:57] <strcat> pcwalton: I think so, it would just coerce to a borrowed one
[23:06:59] <pcwalton> we'd have to introduce a coercion to &Trait
[23:07:04] <pcwalton> from V to &Trait?
[23:07:09] <pcwalton> that's a different coercion from what we had in mind
[23:07:11] <pcwalton> but maybe a harmless one
[23:07:35] <strcat> the unboxed closure would already have to be pretty magical since the compiler would have to type each one differently
[23:07:45] <strcat> so it could find the function to call
[23:07:47] <pcwalton> true, it has an anonymous type
[23:09:24] <strcat> I think they are making C++ closures generic and that's why you can't move into them (without hacks)...
[23:10:04] <wycats_> hm... is it possible to extend a Struct with a trait?
[23:10:06] <strcat> oh wait
[23:10:08] <strcat> they will share the env
[23:10:12] <wycats_> sounds crazy
[23:10:30] <pcwalton> wycats_: it's planned
[23:10:37] <strcat>  For a generic lambda, the closure type has a public inline function call operator member template (14.5.2) whose template-parameter-list consists of one invented type template-parameter for each occurrence of auto in the lambda’s parameter-declaration-clause, in order of appearance
[23:10:37] <wycats_> pcwalton: seems nice
[23:10:38] <pcwalton> but not implemented
[23:10:46] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[23:10:50] <wycats_> sucks working with generated data structures I can't control
[23:11:10] <wycats_> I miss JS (not really)
[23:11:13] <strcat> wycats_: what do you mean extend?
[23:11:20] <wycats_> strcat: add fields
[23:11:23] <strcat> ah
[23:11:38] <wycats_> strcat: I have some local code that wants to put metadata on the original struct
[23:11:42] *** Joins: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP)
[23:11:45] <wycats_> composition would work but it would be pretty clunky
[23:11:51] <strcat> wycats_: not going to be possible afaik
[23:11:52] <wycats_> especially with ownership rules
[23:11:55] <strcat> every type has a fixed size
[23:11:57] <strcat> at compile-time
[23:12:03] <strcat> (well, until DST lands)
[23:12:40] <strcat> wycats_: the compiled code deals with objects as unboxed values, so you can't just add fields
[23:13:08] *** Quits: tautologico (iorek@E0D804D3.CFE755C8.C27E1635.IP) (Quit: zzz)
[23:13:13] <strcat> C++ actually doesn't protect you from slicing fields off of types even when they are boxed like trait objects ;p
[23:13:27] <wycats_> strcat: the local code would have to store the fields elsewhere, and do some magic to link them
[23:13:47] <strcat> wycats_: it doesn't work that way though
[23:13:51] <strcat> sizes are known at compile-time
[23:14:03] <strcat> sizes are a known compile-time constant
[23:14:09] <strcat> that's just how C/C++/Rust work
[23:14:14] <wycats_> strcat: ok
[23:14:28] <strcat> [T, ..4] is as large as 4 T
[23:14:40] *** Parts: jst (quassel@CB36FB4D.BE63433B.EE6E63A5.IP) (http://quassel-irc.org - Chat comfortably. Anywhere.)
[23:14:40] <strcat> ~T calls malloc with the size of T
[23:14:44] <wycats_> strcat: I could imagine ways for extensions to work less efficiently
[23:15:02] <strcat> wycats_: but existing code is compiled with the assumption of a known size for types
[23:15:24] <wycats_> something like https://developer.apple.com/library/ios/documentation/cocoa/reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/doc/uid/TP40001418-CH1g-SW68
[23:15:48] <strcat> wycats_: objective-C objects aren't unboxed objects
[23:16:07] <wycats_> strcat: It wasn't meant to be a direct analogy
[23:16:28] *** Quits: jvshahid (jvshahid@moz-81A4CFEA.lightspeed.irvnca.sbcglobal.net) (Ping timeout)
[23:16:31] <wycats_> you could imagine that traits extensions aren't part of the original struct, but the syntax allows you to treat them as though they were
[23:16:40] <dbaupp> wycats_: you could have trait objects with method calls for access/set
[23:16:48] <strcat> wycats_: so where is it stored?
[23:16:55] <wycats_> dbaupp: what strcat said
[23:17:10] <strcat> wycats_: I mean your proposal
[23:17:15] <wycats_> strcat: I know
[23:17:37] <wycats_> strcat: the compiler would have to see that you are using a trait with a struct and create additional storage for the extensions somewhere else
[23:17:45] <wycats_> strcat: I wouldn't call it a "proposal"
[23:17:51] <wycats_> I absolutely have not thought it through
[23:17:57] <strcat> wycats_: so, all the existing code compiled to the fixed size of the struct breaks
[23:18:06] <wycats_> strcat: how so?
[23:18:11] <wycats_> you have to import traits to use them
[23:18:20] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[23:18:25] <strcat> so
[23:18:25] <wycats_> all other code wouldn't know anything about the other fields
[23:18:26] <strcat> you have a Foo
[23:18:30] <strcat> you pass it to a function
[23:18:32] <strcat> you get back Foo
[23:18:40] <wycats_> the same Foo?
[23:18:40] <strcat> wycats_: you cannot add data to a type
[23:18:42] <strcat> wycats_: yes
[23:18:44] <strcat> the same Foo
[23:18:55] <strcat> I think you're missing that rust doesn't box objects
[23:19:00] <wycats_> strcat: I'm not missing that, no
[23:19:09] <strcat> if Foo is (uint, uint), and you pass it to a function, it passes two uint
[23:19:15] <wycats_> I'm just fuzzily guessing that the compiler could find and associate (statically) the storage
[23:19:16] <strcat> the code doesn't have to leave it that way
[23:19:28] <strcat> LLVM has no awareness of types, only data layouts
[23:19:30] <wycats_> but my fuzzy guess is probably wrong
[23:19:33] <derek_c> can someone tell me what's wrong with this piece of code?
[23:19:35] <derek_c> http://upl.io/n2eieo
[23:19:49] <derek_c> src/mapreduce.rs:21:20: 21:29 error: wrong number of type arguments: expected 1 but found 0
[23:19:58] <strcat> wycats_: the program isn't compiled as a whole, though, there are library boundaries
[23:20:15] <strcat> the size of the type is an ABI detail, it can't just be changed
[23:20:26] <strcat> it's fixed
[23:20:30] <wycats_> strcat: right... so you would only be able to use the storage in the same program unit that set it
[23:20:36] <strcat> wycats_: so
[23:20:43] *** Joins: nkoep (nik@moz-DAEA9198.vpn.rwth-aachen.de)
[23:20:44] <strcat> you receive a Foo from a function
[23:20:49] <strcat> you read one of these extended fields
[23:20:54] <strcat> it's undefined, you're reading uninit memory
[23:21:14] <strcat> lets say Foo is 4 bytes
[23:21:17] <strcat> [Foo, ..4] is 16 bytes
[23:21:20] <strcat> a function returns that to you
[23:21:36] <wycats_> you can only read from the extended field if you imported the Trait inside the same program unit and wrote to it
[23:21:37] <strcat> if you read past the end of one, you're reading invalid memory (part of the other Foo, and eventually off the end)
[23:21:40] *** Joins: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[23:21:44] <wycats_> not any Foo
[23:21:52] <wycats_> only a Foo you created and wrote to
[23:21:56] <wycats_> in the same program unit
[23:21:59] <wycats_> (file, whatever)
[23:22:03] <strcat> wycats_: it doesn't know which ones you wrote to
[23:22:08] *** Quits: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net) (Quit: dbaupp)
[23:22:09] <strcat> and which ones you got from somewhere else
[23:22:09] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[23:22:19] *** Joins: bungoman_ (bungoman@moz-833E2510.ptr.richards.com)
[23:22:20] *** Joins: lenstr (lenstr@2A2A2196.9DA5669E.3F2079FA.IP)
[23:22:27] <wycats_> it kind of does
[23:22:34] <wycats_> it won't work if you transfer ownership somewhere else
[23:22:40] <wycats_> but it will work if you lend it somewhere else
[23:22:41] *** Joins: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net)
[23:22:45] <kimundi> derek_c: Your Encodable and Decodable bounds need type paramters
[23:22:50] <strcat> wycats_: it doesn't know where you lended it from
[23:22:56] <strcat> that's why rust has named lifetime parameters
[23:22:57] <kimundi> KeyT1: Encodable<Foo>+Decodable<Bar>
[23:23:03] <strcat> it doesn't do perfect magical whole program analysis
[23:23:09] <wycats_> honestly, we are getting way down a proposal that I didn't mean to make
[23:23:13] <wycats_> so let's discard it please
[23:23:15] *** Quits: maxli (maxli@moz-4D28BA20.student.cs.uwaterloo.ca) (Ping timeout)
[23:23:15] *** Quits: bungoman (bungoman@5CF79DDD.6C181F01.F74C56B8.IP) (Ping timeout)
[23:23:16] <kimundi> No idea what'S supposed to go there though, never used that stuff
[23:23:25] <dbaupp> strcat: you could add rust-core to rust-ci and http://docs.octayn.net/ :)
[23:24:08] <strcat> dbaupp: I don't think it will work
[23:24:09] *** Quits: bungoman_ (bungoman@moz-833E2510.ptr.richards.com) (Ping timeout)
[23:24:21] <strcat> I need to compile with clang built with rust's llvm
[23:24:29] <derek_c> kimundi: ah!  thanks a lot :)
[23:24:41] <strcat> or at least llc + gcc
[23:24:42] <dbaupp> derek_c: `<D: Decoder, E: Encoder, KeyT1: Encodable<E> + Decodable<D>, ...>`
[23:24:49] *** Joins: maxiepoo_ (Max@moz-6F50ADE.hsd1.il.comcast.net)
[23:24:56] <dbaupp> strcat: do you have some C in it?
[23:24:59] <strcat> dbaupp: no
[23:25:02] *** Quits: valenting (Thunderbir@808EE6B5.84D5EFD5.FB866788.IP) (Ping timeout)
[23:25:07] <strcat> rustc can't compile no_std crates
[23:25:25] <dbaupp> oh, right; that broke recently.
[23:25:32] <strcat> it was broken before
[23:25:41] <strcat> once you had a function LLVM thinks may throw an exception
[23:25:48] <strcat> (any extern fn it doesn't hardcode as nounwind)
[23:25:52] *** Quits: jordyd (jordyd@7DAC4ACE.77F880E0.D9401097.IP) (Ping timeout)
[23:25:55] <strcat> and a dtor in scope
[23:26:01] <strcat> because rust puts where stuff in landing pads
[23:26:05] <strcat> weird stuff*
[23:26:13] <dbaupp> oh, ick :(
[23:26:13] *** Joins: jordyd (jordyd@7DAC4ACE.77F880E0.D9401097.IP)
[23:26:21] <strcat> and we don't have a way to mark external functions as being nounwind/readonly/readnone
[23:26:26] <strcat> the C headers often mark them as such
[23:26:30] *** Quits: exobit_ (textual@moz-E06F46F0.corp.bitshelter.com) (Quit: )
[23:27:18] <strcat> __attribute__((nothrow)) __attribute__((pure)) __attribute__((const)) are all over glibc headers
[23:27:35] <strcat> and __attribute__((nonnull)) but LLVM can't use it.
[23:28:00] *** Joins: bjz (bjz@1009100.A27A8065.D3BA2C17.IP)
[23:28:09] <strcat> anyway it makes rust's destructors pretty expensive
[23:28:18] <strcat> because it thinks basically everything can throw even though nothing can...
[23:29:29] *** Joins: SingingBoyo (brandon@moz-1B139F19.ubcsecure.wireless.ubc.ca)
[23:30:15] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[23:31:21] *** Joins: idog98 (idog98@moz-8F605F11.chrismail.de)
[23:33:39] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:33:45] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[23:35:34] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Quit: ...)
[23:35:53] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[23:36:21] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[23:36:37] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:38:06] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[23:38:08] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[23:38:28] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[23:39:05] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[23:40:15] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[23:40:19] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[23:40:43] *** Joins: luck (luck@77546E9A.1059820C.F58D6954.IP)
[23:40:53] *** Quits: luck (luck@77546E9A.1059820C.F58D6954.IP) (Quit:  HydraIRC -> http://www.hydrairc.com <- IRC with a difference)
[23:41:14] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Quit: ...)
[23:41:28] *** Joins: luck (luck@77546E9A.1059820C.F58D6954.IP)
[23:41:39] *** Joins: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com)
[23:41:52] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:44:01] *** Joins: Sgeo (quassel@moz-D0F30617.dyn.optonline.net)
[23:44:28] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[23:44:51] *** Joins: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net)
[23:45:13] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[23:46:10] *** flaper87 is now known as flaper87|afk
[23:47:12] <derek_c> can someone tell me what's wrong with this code? http://upl.io/c7n2a9
[23:47:31] <derek_c> log is here: http://upl.io/ks6vmv
[23:48:02] <derek_c> sorry but I'm still trying to understand all these pointers
[23:48:18] <dbaupp> derek_c: I think just `let res = map(pair);` should be fine?
[23:49:25] *** Quits: jstevans (Instantbir@moz-8D4AF6B1.washdc.fios.verizon.net) (Ping timeout)
[23:49:29] <dbaupp> derek_c: you can possibly write that as `let map_output = input.iter().flat_map(|res| res.iter()).collect();` (or `.to_owned_vec()` instead of .collect), btw.
[23:49:49] <dbaupp> err, map(res).iter()
[23:50:04] <dbaupp> *|pair| map(pair).iter()
[23:50:08] * dbaupp gets there eventually
[23:50:36] <dbaupp> hm, you might need .move_iter(), since .iter() will be yielding references into the ~[].
[23:51:47] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[23:52:19] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[23:52:44] <dbaupp> derek_c: another thing, unless actual benchmarks show it's faster or you have a recursive data type, you probably don't need/want ~KeyT1, ~ValT1 over passing by val (i.e. KeyT1, ValT1)
[23:52:51] *** Quits: SingingBoyo (brandon@moz-1B139F19.ubcsecure.wireless.ubc.ca) (Ping timeout)
[23:52:53] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[23:53:26] <strcat> if it's a generic type you definitely do not want to put it in ~
[23:53:36] <wycats_> nmatsakis: what does it mean to put a lifetime parameter on an entire impl?
[23:53:41] <strcat> the caller can do that
[23:53:41] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[23:53:58] <strcat> wycats_: it doesn't mean anything alone, it's just a place to declare it
[23:54:04] <strcat> impl<T> Foo<T> { }
[23:54:10] <strcat> impl<'a> Foo<'a> { }
[23:54:11] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[23:54:31] <strcat> and then you can tie that to some method's type signature
[23:54:31] <derek_c> dbaupp: thanks a lot! I'm guessing that since I'm writing a mapreduce framework, the value will potentially be large.  Think the canonical word count example
[23:54:37] <strcat> fn foo(&self) -> &'a T
[23:54:52] <dbaupp> derek_c: as strcat says, the caller can put the ~ themselves
[23:54:55] <strcat> wycats_: for example, iterators
[23:55:21] <dbaupp> derek_c: would the wordcount example be passing HashMaps and vectors around? they're not actually very large at all
[23:55:26] <strcat> wycats_: an iterator yielding &'a T references to some &'a Container<T>
[23:55:44] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[23:55:48] <strcat> the reference lifetime isn't tied to the iterator itself - you mutate that with each iteration, it wouldn't work out
[23:55:56] *** Joins: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net)
[23:56:00] <derek_c> dbaupp: I'm actually not very sure what strcat meant
[23:56:01] <dbaupp> rusti: (std::sys::size_of::<~[int]>(), std::sys::size_of::<std::hashmap::HashMap<int, int>>())
[23:56:05] -rusti- (8u, 40u)
[23:56:08] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:56:09] <strcat> derek_c: you don't want to use ~
[23:56:14] <dbaupp> (oh, hashmap isn't so small.)
[23:56:15] <wycats_> strcat: is there any reason not to put it on the impl if I end up using it a lot?
[23:56:18] <strcat> derek_c: the caller can pass and ~int if they want
[23:56:22] <strcat> well, bad example
[23:56:24] <strcat> that's useless
[23:56:24] <wycats_> i.e. should I prefer to define it per-method?
[23:56:26] <strcat> but...
[23:56:31] <strcat> the point is that it's a generic type
[23:56:43] <strcat> by using ~, you're forcing allocations
[23:56:53] <strcat> before, the caller could pass T or ~T
[23:56:59] <strcat> now they have to pass ~T
[23:57:05] <derek_c> strcat: allocations of what?
[23:57:18] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[23:57:21] <strcat> derek_c: ~T is a heap allocation, the caller now has to put stuff into ~
[23:57:26] *** Quits: azita (Azita@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: azita)
[23:57:37] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Quit: ...)
[23:57:42] *** Quits: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[23:57:42] <strcat> rusti: fn foo<T>(x: T) -> T { x } foo(5)
[23:57:44] -rusti- 5
[23:57:44] <derek_c> T would simply be stack allocation?
[23:57:48] <strcat> rusti: fn foo<T>(x: T) -> T { x } foo(~5)
[23:57:49] -rusti- ~5
[23:57:55] <strcat> either works that way
[23:58:03] <strcat> if you make it ~T, it's making it less efficient in most cases
[23:58:05] <strcat> without a benefit
[23:58:26] <derek_c> ok, I see what you are saying
[23:58:28] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[23:58:34] <derek_c> so if the caller wanted, he could just use ~
[23:58:38] <dbaupp> yes
[23:58:49] *** Quits: dherman_ (dherman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: dherman_)
[23:59:07] <derek_c> how about return value though?
[23:59:12] <dbaupp> derek_c: another question, why define your own Pair rather than just use (A, B)?
[23:59:17] <dbaupp> (i.e. a tuple)
[23:59:24] <strcat> derek_c: never want to allocate a ~ for no reason just to return
[23:59:35] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[23:59:38] <strcat> derek_c: http://static.rust-lang.org/doc/master/tutorial.html#boxes
[23:59:48] <strcat> it's very unlikely you want ~
[23:59:59] <strcat> if you aren't writing a recursive data structure, there are very few cases where you want it
