[00:06:24] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:06:24] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141405038 to 14a6310f6: 02http://git.io/N3iJvQ
[00:06:24] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:06:24] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[00:06:24] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/-wHaFQ
[00:06:24] <ghrust> 13rust/06auto 14d99efe8 15David Renshaw: encode trait lifetime params in metadata to allow cross-crate usage
[00:06:24] <ghrust> 13rust/06auto 14898d2c3 15bors: auto merge of #10813 : dwrensha/rust/xcrate-lifetime-param, r=huonw...
[00:06:25] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[00:06:27] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[00:16:22] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[00:16:48] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[00:18:21] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[00:27:00] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:27:00] *** ChanServ sets mode: +qo brson brson
[00:31:21] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[00:45:20] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[00:47:10] *** kimundi is now known as zz_kimundi
[00:49:58] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[00:59:23] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[01:02:50] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[01:13:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:29:23] <klutzy> acrichto: (on #10856) do you know why `Reader.bytes()` needs `self` rather than `&mut self`?
[01:37:30] <acrichto> klutzy: I don't see why it doesn't take &mut self
[01:42:23] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:42:33] <klutzy> error: failed to find an implementation of trait io::Reader for &mut &'r mut Self
[01:42:36] <klutzy> ugh
[01:44:12] <klutzy> s/&mut &/&/
[01:45:45] *** Quits: jack_ (uid19593@moz-A42E5B7B.irccloud.com) (Ping timeout)
[01:46:44] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:46:48] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[01:46:48] *** ChanServ sets mode: +qo brson brson
[01:47:35] *** Joins: jack_ (uid19593@moz-A42E5B7B.irccloud.com)
[01:48:02] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[01:51:17] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:53:37] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:54:09] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:55:53] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[02:07:31] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:07:31] *** ChanServ sets mode: +ao dherman dherman
[02:13:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:15:30] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[02:18:39] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[02:46:25] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:46:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/-wHaFQ
[02:46:25] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:03:33] <sfackler> r anyone? https://github.com/mozilla/rust/pull/10867
[03:08:54] *** Quits: zz_kimundi (kimundi@moz-F44E1D84.dip0.t-ipconnect.de) (Ping timeout)
[03:12:14] *** Joins: zz_kimundi (kimundi@moz-7496AA85.dip0.t-ipconnect.de)
[03:12:15] *** zz_kimundi is now known as kimundi
[03:19:32] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:24:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[03:26:25] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:26:25] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wK4WKw
[03:26:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:26:29] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:26:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Eyc1DQ
[03:26:29] <ghrust> 13rust/06auto 141f80ec4 15Kiet Tran: Fix comment on ast::DefStruct
[03:26:29] <ghrust> 13rust/06auto 149f3be46 15bors: auto merge of #10866 : ktt3ja/rust/edit-doc, r=huonw...
[03:26:29] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:40:18] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:40:18] *** ChanServ sets mode: +ao dherman dherman
[03:47:14] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:57:02] *** Joins: jdm (jdm@moz-78156D60.dsl.teksavvy.com)
[03:57:20] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[03:59:01] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:28:02] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[04:29:25] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Ping timeout)
[04:40:27] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:44:25] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[04:45:33] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[04:51:57] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Quit: leaving)
[04:54:05] *** Joins: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[05:07:47] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[05:19:44] *** Quits: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[05:20:45] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[05:30:06] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[05:32:37] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[05:48:09] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[05:52:02] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[05:59:30] *** Quits: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP) (Ping timeout)
[06:00:43] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[06:01:48] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:01:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Eyc1DQ
[06:01:48] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:04:23] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[06:06:26] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:06:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/14fdBw
[06:06:26] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:06:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:06:30] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/FskFNg
[06:06:30] <ghrust> 13rust/06auto 144d688e8 15Steven Fackler: Accept unsugared docs in missing-doc lint...
[06:06:30] <ghrust> 13rust/06auto 1409db61f 15bors: auto merge of #10867 : sfackler/rust/unsugared-doc, r=huonw...
[06:06:32] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:07:19] <ktt3ja> acrichto: do you mean I should override `visit_path` instead of `visit_arm` and rebase on top of your commit? (also, how do I rebase on top of an unmerged commit? :P) https://github.com/mozilla/rust/pull/10870#issuecomment-30106446
[06:08:02] <acrichto> ktt3ja: I'd probably do some cherry-picking, but yes, visit_path is what you want, not visit_arm, b/c right now there could be other paths that you're missing (impl Path for T, etc)
[06:08:09] <acrichto> (privacy was currently missing those as well)
[06:08:38] <acrichto> ktt3ja: but if I were you I'd 'git fetch' my repo, 'git rebase -i HEAD~1', then add 'pick <my sha1 hash>' to the top
[06:08:42] <klutzy> acrichto: I tried to change Reader.bytes(self) to (&'r mut self), but I got error: failed to find an implementation of trait io::Reader for &'r mut Self
[06:08:43] <acrichto> and that should rebase it above your commit
[06:09:03] <acrichto> klutzy: do you have the diff I could look at?
[06:09:54] <klutzy> acrichto: http://pastebin.mozilla.org/3740573
[06:10:26] <acrichto> strcat: can you remove your r+ on #10874 ? I want to discuss removing the external assembler stuff entirely
[06:10:46] <acrichto> klutzy: I think you're missing a modification to the struct definition
[06:11:06] <strcat> acrichto: I was actually going to suggest we remove it entirely, but looked at clang and it exposes it
[06:11:28] <strcat>        -integrated-as -no-integrated-as
[06:11:30] <strcat>            Used to enable and disable, respectively, the use of the integrated assembler. Whether the integrated assembler is on by
[06:11:32] <acrichto> if that's true, then we should add a test for it b/c that's something that will stop working very easily
[06:11:32] <strcat>            default is target dependent.
[06:11:50] <acrichto> we don't need to do something just because clang does something though
[06:11:50] <strcat> do we have a test harness for cli switches?
[06:11:57] <acrichto> compile-flags
[06:11:59] <strcat> if clang does it there's a use case
[06:12:02] <strcat> because gcc doesn't have that flag
[06:12:09] <acrichto> -S && clang foo.S
[06:12:21] <acrichto> it's a convenience use-case not a critical use-case
[06:12:38] <klutzy> acrichto: you mean modifying ByteIterator?
[06:13:02] <acrichto> klutzy: yeah the struct should probably contain "priv ptr: &'self mut T" where T: Reader
[06:13:04] <strcat> acrichto: unless rust ships with clang it's a real use case
[06:13:29] <strcat> checking out LLVM on the right revision and building clang is really annoying
[06:13:33] <strcat> clang 3.3 doesn't work on rust's IR
[06:13:38] <acrichto> strcat: I'm not saying we shouldn't have it, I'm saying we shouldn't blindly do something "just because clang has it so it must be useful"
[06:14:51] <klutzy> ah, str::ByteIterator != io::extensions::ByteIterator. yeah, definitely better to fix the struct
[06:15:39] <vadimcn> strcat: acrichto: I figured some day 'no-integrated-as' might be useful for debugging something else.   Besides, as you already mentioned, clang has it too.
[06:16:07] <strcat> acrichto: it seems useful enough based on GNU ASM not being completely implemented by LLVM, and LLVM having bugs
[06:16:33] <strcat> although on platforms where their assembly is really buggy it's not on by default
[06:16:51] <strcat> that's why clang has the reverse switch too, but we don't really need that because we're not going to be working on LLVM
[06:45:20] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[06:46:19] <Eridius> did something change with rustllvm? I last built on thursday, and building today gives me ar: x86_64-apple-darwin/rustllvm/librustllvm.dylib: Inappropriate file type or format
[06:48:06] <acrichto> Eridius: you'll need to 'make clean', it's a static library now
[06:48:11] <Eridius> ah
[06:58:00] *** Quits: jdm (jdm@moz-78156D60.dsl.teksavvy.com) (Quit: Lost terminal)
[06:58:57] <ktt3ja> acrichto: I'll just wait for your PR to land. git is too hard and I don't want to break anything :P
[07:00:09] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:00:20] *** Joins: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net)
[07:00:59] <acrichto> ktt3ja: ok, I think someone will have looked at it by the end of tomorrow
[07:03:52] *** Quits: ktt3ja (ktt3ja@moz-D69B60E4.hsd1.va.comcast.net) (Quit: Leaving)
[07:18:20] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[07:23:38] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[07:24:04] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Ping timeout)
[07:27:44] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[07:34:51] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Client exited)
[07:47:32] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[08:07:34] <cmr> acrichto: fwiw I thnik clang has those flags becauase the integrated assembler still isn't as mature as gas for some targets.
[08:07:46] <cmr> oh
[08:07:51] <cmr> I should have read more backlog... :p
[08:08:07] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Quit: Kxepal)
[08:08:25] *** Joins: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru)
[08:08:45] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:09:02] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[08:09:35] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:10:58] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[08:11:19] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:14:07] <acrichto> dbaupp: ping
[08:14:50] <dbaupp> acrichto: pong
[08:15:22] <acrichto> dbaupp: for the ignoring of the id in walk_path, I figured I'd follow the pattern of everything else where the signature of visit_X matched walk_X
[08:15:29] <acrichto> although in this case maybe I should make an exception
[08:15:35] *** Joins: vadimcn_ (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[08:15:36] *** Quits: vadimcn (chatzilla@91A9CD53.76F9E272.DA40C4B3.IP) (Ping timeout)
[08:15:37] *** vadimcn_ is now known as vadimcn
[08:16:17] <dbaupp> acrichto: yeah, I think making walk_... take an Option would stop someone accidentally assuming that the id was always valid if there is ever a reason to not ignore it. (either that or just remove the argument entirely.)
[08:16:28] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:16:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/FskFNg
[08:16:28] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:16:56] <acrichto> eh, I'll just remove it
[08:17:00] <acrichto> not needed for walking anyway
[08:17:06] <dbaupp> sounds good
[08:17:58] <dbaupp> r=me when you fix that
[08:18:07] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:18:13] <acrichto> cool, thanks!
[08:18:40] <acrichto> I also find that all patterns in foreign fns causing an ICE is amusing
[08:19:27] <dbaupp> not all :P
[08:19:56] <dbaupp> but yeah, seeing the shortcircuiting made me wonder if we handled it correctly anywhere.
[08:20:13] <acrichto> I guess it doesn't really make sense to destructure
[08:21:00] <dbaupp> yeah, having idents only (or even optional idents) would be fine.
[08:21:33] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[08:21:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/HXH9Tw
[08:21:33] <ghrust> 13rust/06auto 1436bd3e9 15Alex Crichton: Check the privacy of implemented traits...
[08:21:33] <ghrust> 13rust/06auto 14634245f 15bors: auto merge of #10862 : alexcrichton/rust/issue-10857, r=huonw...
[08:21:34] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[08:21:37] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[08:25:23] *** flaper87|afk is now known as flaper87
[08:35:08] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:39:27] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Ping timeout)
[08:43:02] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[09:01:44] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[09:01:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14634245f to 1409db61f: 02http://git.io/N3iJvQ
[09:01:44] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[09:01:47] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[09:01:47] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/lY7CIw
[09:01:47] <ghrust> 13rust/06auto 14554c3c3 15Vadim Chugunov: Use LLVM integrated assembler on Windows too.
[09:01:47] <ghrust> 13rust/06auto 14c8498c1 15Vadim Chugunov: Disable failing test.
[09:01:48] <ghrust> 13rust/06auto 14e5f2021 15bors: auto merge of #10874 : vadimcn/rust/integrated-as, r=alexcrichton...
[09:01:50] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[09:20:38] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[09:22:27] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[09:25:13] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[09:35:02] *** Quits: Kxepal (Miranda@moz-59F10283.pppoe.mtu-net.ru) (Ping timeout)
[09:37:52] *** Joins: Kxepal (Miranda@moz-BEA1ED22.pppoe.mtu-net.ru)
[09:43:26] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:55:45] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[09:56:12] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[09:59:07] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[10:01:40] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[10:04:22] *** Quits: sfackler (sfackler@moz-AEECCEBA.com) (Ping timeout)
[10:06:45] *** Joins: sfackler (sfackler@moz-AEECCEBA.com)
[10:32:54] <klutzy> acrichto: stdin() can throw eof error, which becomes problematic e.g. `for line in buf_stdin.lines()`
[10:33:14] <klutzy> is it better to just catch and ignore and condition inside next()?
[10:53:06] <dbaupp> klutzy: maybe catch the eof one bug re-raise any others?
[10:54:47] <klutzy> dbaupp: it will fix my pr, but I'm worried by general situation
[10:55:26] <klutzy> acrichto said if .read_line() will return Result<~str, IoError> later, then IoError is ignored or something
[10:56:07] <klutzy> it's in similar situation except that .read_line() currently returns Option<~str> but raises some conditions instead
[10:57:18] <cmr> I wonder if pcwalton is on to something when he says that we "want" catchable exceptions when we reject conditions and dealing with Result/Option...
[10:58:41] <eddyb> we thought we didn't watch catchable exceptions
[10:58:48] <eddyb> s/^we/I
[11:01:25] <cmr> well, we don't.
[11:01:37] <cmr> they cause lots of problems, but they're really the only alternative I can see atm.
[11:01:42] <dbaupp> klutzy: I was meaning check the IoError and raise it again if it's not the eof one.
[11:03:09] <klutzy> dbaupp: yep, but it would not work if .read_line() is changed to return Result<~str, IoError> instead of using condition
[11:04:29] <klutzy> dbaupp: and iterator.next() must return Option<~str>, so IoError is ignored here
[11:05:01] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[11:06:09] *** Joins: mib_4p37jb (Mibbit@5021D585.667D313.CBC7865F.IP)
[11:06:59] *** Quits: mib_4p37jb (Mibbit@5021D585.667D313.CBC7865F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:07:07] <eddyb> Option<Result<~str, IoError>>?
[11:07:47] <eddyb> what about refutable destructuring with built-in failure?
[11:08:02] <eddyb> for Ok(line) in line_iter {...}
[11:08:16] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:09:51] <dbaupp> klutzy: oh, are you talking long-term if conditions get removed?
[11:11:33] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:11:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/lY7CIw
[11:11:33] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[11:11:42] <klutzy> dbaupp: I was considering solutions which will be alive at the long-term.
[11:13:50] <klutzy> one solution is ignore-any-error as acrichto said at #10856
[11:14:16] <klutzy> e.g. fn next() { ignore_io_error(|| self.buffer.read_line()) }
[11:14:59] <klutzy> one folk at rust-kr community suggested other solution: save IoError inside iterator and return None
[11:15:06] <cmr> I would expect it to just return None.
[11:15:15] <eddyb> so you can check .has_error()?
[11:15:29] <eddyb> that is better than just ignoring it
[11:15:41] <klutzy> yep. let it = buffer.lines(); for { ... } if it.has_error() { ... }
[11:16:12] <cmr> Although that feels a bit like C++'s iostreams, which I really dislike as an API
[11:16:17] <cmr> But I don't see anything better atm
[11:16:18] <eddyb> myeah
[11:16:24] <eddyb> hmm
[11:17:08] <eddyb> if let Err(m) = it.has_error() {println!("error: {}", m);}
[11:17:22] <eddyb> (if with a refutable let pattern)
[11:17:29] * eddyb is just dreaming now
[11:17:52] <dbaupp> the lines iterator could even have a dtor that raised the condition if the stored error wasn't handled.
[11:18:05] <dbaupp> I guess this relies on failure inside drop though.
[11:18:38] <cmr> Failure in destructors is really not-good though
[11:18:52] <eddyb> this is a problem with promises
[11:18:54] <cmr> And I think there is a desire to statically verify that destructors *don't* fail
[11:19:01] <dbaupp> it sounds like a nice api for things though.
[11:19:05] <cmr> (ie, with future effect-system)
[11:19:06] <cmr> yeah
[11:19:22] <dbaupp> handling the error defuses the bomb, not handling it quits.
[11:19:32] <dbaupp> apparently D has something similar?
[11:19:59] <dbaupp> r? https://github.com/mozilla/rust/pull/10859
[11:20:55] <cmr> "of which a significant portion is boilerplate }'s and so on"
[11:20:57] <cmr> heh
[11:21:17] <eddyb> you want the error to show up somewhere if the promise didn't handle it, but anything keeping the promise alive can set an error handle/retrieve the error, so it doesn't always work
[11:21:46] <dbaupp> cmr: at least, like, 12 lines of the implementations are the closing } for an impl :P
[11:21:49] <eddyb> this is terribly hard in JS because it needs not-there-yet support from the engine (weak refs) to set dtors
[11:22:00] *** Joins: Kroisse (Kroisse@7CF4064D.E3B51CAE.ECA1BB11.IP)
[11:22:34] <dbaupp> (well, 24 lonely }'s if you count the data type and constructor ones.)
[11:22:38] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[11:24:10] <cmr> dbaupp: so, I *am* starting to feel like std::rand should be part of the `extra` conglomerate.
[11:24:21] <dbaupp> cmr: so am I
[11:24:38] <cmr> I've been meaning to send a post to the ML about how we want to handle this
[11:24:49] <dbaupp> (i've been thinking this for a while, but parts are required for the runtime etc.)
[11:24:54] <cmr> Do we want a monolithic stdlib, or do we want to lean on a robust packaging ecosystem?
[11:25:08] <eddyb> rustpkg seems so broken, though
[11:25:11] <dbaupp> we need a robust rustpkg. :(
[11:25:12] <cmr> ie, Java vs Node.js
[11:25:14] <cmr> Yes, I know
[11:25:23] <eddyb> node.js works, IMO
[11:25:30] <eddyb> pay-for-what-you-use
[11:25:34] <cmr> I agree
[11:25:37] <cmr> I like npm a lot
[11:25:42] * dbaupp would like the external-packages world
[11:26:05] <cmr> ...and with static linking, the problem of distributing dependencies is basically a non-issue.
[11:26:12] <cmr> (Ruby has this problem)
[11:26:13] <dbaupp> also, I've been seeing people talking about a proper numerics crate, and the rand stuff would slot perfectly into that.
[11:26:37] <eddyb> does HashMap/Sip need rand?
[11:26:49] <dbaupp> it uses the task rng
[11:26:59] <dbaupp> (to get some 2 64 bit keys.)
[11:27:02] <dbaupp> s/some //
[11:27:07] <eddyb> or just a safe source of randomness? because those don't need to overlap
[11:27:17] <dbaupp> yes, it just needs randomness
[11:27:24] <cmr> I think in order for us to live in the packaging world, we need to have the ability for a crate to inject a prelude, unless we like living with a billion and a half `use`s
[11:27:25] <dbaupp> as does the runtime
[11:27:33] <eddyb> os::safe_random_bytes() or something
[11:27:39] <dbaupp> cmr: o_O
[11:27:42] <dbaupp> cmr: seems dangerous
[11:27:46] <cmr> dbaupp: I agree
[11:28:01] <eddyb> it can't overwrite anything
[11:28:03] <dbaupp> eddyb: the problem is that's slow, the runtime certainly needs to be caching an RNG object
[11:28:12] <eddyb> dbaupp: eeeh. okay
[11:28:30] <cmr> dbaupp: I don't think crates should do it themselves.
[11:28:49] <cmr> But I would like to say, for example, `#[inject] use some_lib::*;`
[11:28:59] <dbaupp> eddyb: and, if, e.g. if it's reading from /dev/urandom, that's can be a lot of syscalls; or there's buffering with a global mutex.
[11:29:13] <cmr> Otherwise you get 50+ lines of `use` like is prevalent in  libsyntax...
[11:29:50] <eddyb> I've suggested making the prelude a mod lang item
[11:30:01] <dbaupp> cmr: having working globs would be marginally nicer
[11:30:03] <cmr> too limited
[11:30:05] <cmr> dbaupp: it would be.
[11:30:47] <eddyb> welll, if you could replace the prelude with mod { use std::prelude::*; use all::my::stuff::* }
[11:30:50] <dbaupp> cmr: also, using qualified things can work; especially with `use m = some::module;` to abbreviate it.
[11:31:44] <cmr> dbaupp: I agree that it's not *that* much of a problem.
[11:32:18] <dbaupp> cmr: I also agree that it can be annoying.
[11:32:23] <dbaupp> (especially/mainly with traits.)
[11:32:29] <cmr> mostly with traits
[11:32:39] <cmr> https://github.com/sebcrozet/kiss3d/blob/master/examples/post_processing.rs for example
[11:32:59] <dbaupp> being able to write m::Trait::method(&the_self_object); would be nice for when one needs only a few methods.
[11:33:00] <cmr> Any non-trivial library using traits is going to have a fair bit of boilerplate.
[11:34:08] <dbaupp> (being able to write that would also make #[deriving]'s error messages much nicer... :/ )
[11:35:44] <cmr> dbaupp: we agreed we want these distributions right? I remember a discussion about it, but can't find the issue.
[11:36:22] <dbaupp> cmr: https://github.com/mozilla/rust/pull/10223#issuecomment-27559825 and then a discussion on IRC
[11:36:33] <dbaupp> to which brson agreed that following C++11 was ok.
[11:36:58] <cmr> ok, that's what I remember, yeah
[11:41:22] <dbaupp> cmr: thanks
[11:41:32] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:41:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oE1nFA
[11:41:32] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[11:41:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:41:33] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/6YFRnA
[11:41:33] <ghrust> 13rust/06auto 149d5639d 15Huon Wilson: std::rand: move normal and exponential to their own file.
[11:41:33] <ghrust> 13rust/06auto 141d986de 15Huon Wilson: std::rand: implement the log-normal distribution.
[11:41:33] <ghrust> 13rust/06auto 141ee4291 15Huon Wilson: std::rand: implement the chi-squared distribution.
[11:41:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[11:49:34] *** kimundi is now known as zz_kimundi
[11:50:41] <cmr> r? https://github.com/mozilla/rust/pull/10880
[11:50:54] <cmr> I was going to wait until I had gone through the whole tutorial to send the PR, but there's no reason to, really.
[11:53:08] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[11:55:14] * ChrisMorgan loves it when you make a comment on GitHub and it gives the post time as "in a few seconds"
[11:56:01] <eddyb> ChrisMorgan: were you writing a state machine for HTTP decoding?
[11:56:18] <ChrisMorgan> eddyb: that's #rust or #rust-http matter
[11:56:34] <eddyb> err, yes
[12:04:26] <dbaupp> cmr: did you see my comment on https://github.com/mozilla/rust/pull/10840 ?
[12:05:13] <cmr> dbaupp: apparently not.
[12:17:39] *** Joins: w3lcome (Mibbit@EAD96774.6B9C41FA.6316A47C.IP)
[12:20:10] <dbaupp> cmr: should rustdoc be backtick'd in all places rustdoc.md? (Because it's currently not)
[12:20:29] <cmr> I thought about it, but decided not to.
[12:20:39] <cmr> I don't really have a reason to or not to.
[12:20:45] <cmr> Do you have an opinion?
[12:20:48] <dbaupp> no
[12:20:58] <dbaupp> just as long as it was a conscious decision.
[12:21:02] <cmr> Ok
[12:21:32] <dbaupp> (also, r=me for 10840 when you remove the double sentence.)
[12:21:35] * dbaupp -> bed
[12:21:41] <ChrisMorgan> Wow, that's early!
[12:22:08] <ChrisMorgan> dbaupp: my opinion on such matters is that rustdoc‚Äêthe‚Äêproduct should be rustdoc and rustdoc‚Äêthe‚Äêcommand should be `rustdoc`.
[12:22:49] * dbaupp is currently working an (almost) proper job, and hence starts early (by student standards :P )
[12:24:03] <ChrisMorgan> Meaning what time?
[12:24:59] <dbaupp> erm, I leave home at 8-8.30
[12:25:13] <dbaupp> well, 8.45 some days
[12:25:27] <ChrisMorgan> In the Faculty of IT at Monash, there is the occasional thing starting at 9am, but mostly 10am is the normal permissible start time. Certainly different from some other faculties where I've seen things starting at 8am and even once at 7:30am.
[12:25:49] * dbaupp had 8am classes in 1st and 2nd year
[12:26:01] * ChrisMorgan hasn't *ever* had anything before 9am
[12:26:05] <dbaupp> every week, for 3 semesters.
[12:26:26] * dbaupp was actually pretty good and attended almost all of them
[12:26:32] <ChrisMorgan> Well done.
[12:27:04] * ChrisMorgan wonders what constitutes an "(almost) proper job"
[12:29:23] <dbaupp> a summer research job at my uni
[12:32:53] <eddyb> "summer"?
[12:33:10] <ChrisMorgan> eddyb: yep, it's summer down here in Australia.
[12:33:25] <eddyb> oh, derp, forgot dbaupp was there, too ^_^
[12:35:03] * dbaupp actually just makes his own seasons. ;P
[12:35:43] <eddyb> geodome :P?
[12:35:49] <eddyb> (is that the proper term? I have no idea)
[12:51:53] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Ping timeout)
[12:56:21] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[13:00:08] *** Quits: jxs (joaoxsouls@moz-A7EE0DAF.compute-1.amazonaws.com) (Ping timeout)
[13:01:40] *** zz_kimundi is now known as kimundi
[13:04:31] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[13:06:04] *** flaper87 is now known as flaper87|afk
[13:07:55] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[13:17:39] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[13:20:01] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:27:44] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:46:35] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:46:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/6YFRnA
[13:46:35] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[13:51:30] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:51:30] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/-2-g9g
[13:51:30] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[13:51:32] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:51:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/gST7ow
[13:51:32] <ghrust> 13rust/06auto 144051713 15Corey Richardson: Add some Any docs.
[13:51:32] <ghrust> 13rust/06auto 144e0cb31 15bors: auto merge of #10840 : cmr/rust/any_docs2, r=huonw
[13:51:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:05:25] *** flaper87|afk is now known as flaper87
[14:14:20] *** Joins: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP)
[14:48:33] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[14:59:07] *** kimundi is now known as zz_kimundi
[15:03:23] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[15:05:26] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[15:06:18] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[15:10:30] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[15:10:31] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[15:13:26] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[15:14:16] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[15:14:35] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[15:29:34] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:31:17] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[15:43:54] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[15:47:54] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[15:56:33] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[16:00:02] *** Quits: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[16:00:33] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:00:33] *** ChanServ sets mode: +ao dherman dherman
[16:01:42] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[16:01:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/gST7ow
[16:01:42] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[16:05:43] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:21:34] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[16:21:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02https://github.com/mozilla/rust/compare/4e0cb316fc98...4e0cb316fc98
[16:21:34] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[16:21:34] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[16:21:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/7xlPAw
[16:21:34] <ghrust> 13rust/06auto 143b14f25 15Seo Sanghyeon: Extend allocation lint for boxing expressions
[16:21:34] <ghrust> 13rust/06auto 14b485e2b 15bors: auto merge of #10881 : sanxiyn/rust/allocation-lint-2, r=alexcrichton
[16:21:35] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[16:23:04] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[16:28:35] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[16:29:30] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[16:39:15] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[16:42:42] *** Joins: doomlord__ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[16:42:54] *** Quits: doomlord__ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Client exited)
[16:46:56] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[16:48:32] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:48:56] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[16:53:41] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[17:05:52] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[17:06:43] *** Joins: sanxiyn (tinuviel@62C85FC9.1C19B322.6A273BE4.IP)
[17:26:35] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:27:46] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:28:21] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[17:29:12] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[17:29:12] *** ChanServ sets mode: +qo brson brson
[17:33:04] <sanxiyn> brson: Sorry to bother, but who should I contact for increasing connection limit from given IP to irc.mozilla.org?
[17:33:50] <sanxiyn> (All Samsung Suwon traffic egresses from a single IP)
[17:40:06] *** zz_kimundi is now known as kimundi
[17:40:13] <brson> sanxiyn: I can't find a list of administrators anywhere. I think i've asked for help in #introduction before
[17:40:41] <sanxiyn> ok thanks
[17:40:46] <nmatsakis> pnkfelix: btw, I plan to land a partial patch for #5121 -- I was hoping to find the time to finish it up, but I keep seeing duplciate bugs filed that this patch would fix, and I don't think I'll have time to clean it up in next week or two
[17:40:47] <brson> i've heard that #helpdesk is useful for something but haven't been able to get a response there before
[17:41:18] <nmatsakis> #desktop maybe?
[17:41:23] <nmatsakis> they might at least have an idea
[17:41:33] <nmatsakis> though this doesn't really sound like a desktop related thing.
[17:41:41] <pnkfelix> #servicedesk maybe?
[17:41:41] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:41:46] *** Quits: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net) (Quit: carter)
[17:41:52] <nmatsakis> I guess #desktop == #servicedesk 
[17:41:53] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[17:42:42] <pnkfelix> nmatsakis: regarding patch for #5121, okay.  
[17:42:44] *** Joins: carter (carter@moz-F3C2A2D8.nycmny.fios.verizon.net)
[17:44:41] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[17:47:56] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[17:49:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[17:49:55] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[17:50:08] <jdm> sanxiyn: file a bug in mozilla.org :: Server Operations
[17:50:17] <jdm> https://bugzilla.mozilla.org/show_bug.cgi?id=937016 is one example of when we were at the workweek
[17:50:41] <sanxiyn> jdm: Oh
[17:50:59] <sanxiyn> jdm: Ah it was temporary and removed?
[17:51:02] <jdm> right
[17:51:14] <jdm> so make it clear that some sort of permanent bump is required
[17:51:24] <sanxiyn> Thanks!
[17:55:32] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:57:31] *** Quits: w3lcome (Mibbit@EAD96774.6B9C41FA.6316A47C.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:57:58] *** Quits: sanxiyn (tinuviel@62C85FC9.1C19B322.6A273BE4.IP) (Quit: Bye)
[18:03:04] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[18:18:40] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[18:22:11] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:22:11] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:29:42] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[18:31:43] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[18:31:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/7xlPAw
[18:31:43] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[18:36:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[18:36:33] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/NK6-SA
[18:36:33] <ghrust> 13rust/06auto 1422f14fb 15Niko Matsakis: Issue #9629 -- permit freezing `&mut` found within an `&` pointer
[18:36:33] <ghrust> 13rust/06auto 149f7baed 15Niko Matsakis: Address nits for PR for #9629
[18:36:34] <ghrust> 13rust/06auto 14e0a102d 15bors: auto merge of #10787 : nikomatsakis/rust/issue-9629-freeze-andmut, r=pnkfelix...
[18:36:36] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[18:37:05] *** Joins: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP)
[18:37:37] <acrichto> nmatsakis: ping
[18:41:18] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[18:41:49] <nmatsakis> acrichto: pong
[18:42:27] <acrichto> nmatsakis: I was talking with brson about a better design for comm::select, and he mentioned that you'd be interested in how I'm using pointers
[18:42:41] <acrichto> the idea I have is something like a "port set" which is added to and then selected on
[18:42:49] <acrichto> I would like to express the invariant, however, that a port is only added to the set once
[18:43:01] <acrichto> so right now I'm taking &mut Port and returning some sort of handle (that removes it from the set when it's dropped)
[18:43:08] <nmatsakis> acrichto: I was reading the comments on your PR and I thought a portset made sense
[18:43:09] <acrichto> but I don't need the ports to be mutable
[18:43:24] <acrichto> all of send/recv take &self, I just need the guarantee of unaliasability
[18:43:44] <acrichto> basically, kinda just an interesting use case
[18:43:52] <acrichto> having 'mut' on all the local ports kinda decreases readability
[18:44:00] <acrichto> but the alternative is failing at runtime
[18:44:12] <nmatsakis> right, it is interesting
[18:44:31] <acrichto> not sure if there's something we could do about i
[18:44:36] <nmatsakis> the extra mut needed to get uniqueness kind of irks me, which is probably why brson mentioned it :)
[18:44:45] <acrichto> &'a noalias Port seems a little odd
[18:45:04] <nmatsakis> right, I'm kind of opposed to adding a new ptr type for this purpose,
[18:45:10] <nmatsakis> just because it doesn't seem "worth it"
[18:45:25] <nmatsakis> I'd previously advocated just making everything mut instead, but nobody likes that
[18:45:30] <acrichto> yeah I don't think this is a good enough use case for a whole new pointer
[18:45:51] <acrichto> everything mut seems to conflate with the idea of "immutable by default"
[18:45:53] <nmatsakis> (or rather, making all locals mutable)
[18:46:17] <nmatsakis> I found the mantra "If you have unique access to it, it's mutable" appealingly simple,
[18:46:24] <nmatsakis> but there are real bugs to be caught by forcing to declare mut
[18:47:05] <nmatsakis> even though it does sometimes mean you have to declare things as mut that aren't precisely mut
[18:47:07] <acrichto> I think that's saved me on more than one occasion
[18:47:27] <nmatsakis> right. the other thing I suggested was renaming "mut" :)
[18:47:38] <acrichto> what would the options be?
[18:47:56] <nmatsakis> my suggestion was "my" -- since it's something you have unique access to
[18:48:00] <nmatsakis> but "let my x = 5" ...
[18:48:07] <nmatsakis> seemed too weird.
[18:48:08] <acrichto> oh I remember seeing that
[18:48:18] <nmatsakis> of course now I have another use for `my` :)
[18:48:27] <nmatsakis> handy potential keyword that
[18:48:33] <acrichto> lol
[18:48:57] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[18:49:36] <nmatsakis> (hat tip to pnkfelix for suggesting `my` initially, I think)
[18:50:30] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[18:50:57] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[18:51:19] *** Joins: jmbto (jmbto@moz-FE174E29.fbx.proxad.net)
[18:51:24] <nmatsakis> acrichto: I guess that send/recv take &self because they really do some sort of atomic edits on some heap-allocated-and-very-specially-managed memory?
[18:51:46] <nmatsakis> and hence it doesn't really matter?
[18:51:58] <acrichto> nmatsakis: nah it's mostly b/c &mut self doesn't really add any guarantees in terms of conceptual burden and its much less typing to take &self
[18:52:21] <acrichto> conceptually you're modifying the channel so it should take &mut self
[18:52:38] <nmatsakis> sort of, I mean "modifying"...
[18:52:49] <acrichto> there are definitely memory modfiications
[18:52:57] <acrichto> and the first line of all the function is cast::transmute_mut
[18:54:33] <sfackler> !
[18:55:30] <acrichto> chans/ports are all incredibly unsafe code anyway b/c &mut self is supposed to guarantee no aliasing but the whole point of a channel is to have shared mutable memory
[18:57:27] <nmatsakis> acrichto: presumably the chan/port share a pointer to some third memory space that is shared/mutable
[18:57:48] <nmatsakis> I have to read your PR
[18:58:21] <acrichto> indeed, although you have to go through a little indirection to get there
[18:58:23] <nmatsakis> acrichto: anyway that does sound interesting and, at least for time being, I agree that taking `&mut self` is prob best, unless you wanted to take by value and then move the port/chan back out
[18:58:39] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[18:58:44] <nmatsakis> which has its own appeal
[18:58:55] <acrichto> I'm worried you may not always have ownershipt though
[18:59:00] <acrichto> like if the ports are stored in an array
[18:59:07] <nmatsakis> right I was wondering about that
[18:59:09] <acrichto> although I suppose that wouldn't work either...
[18:59:14] <acrichto> in the system I've concocted
[18:59:23] <nmatsakis> well, it would if you had an &mut slice to that array
[18:59:34] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[18:59:42] <acrichto> can you have simultaneous mutable borrows into an array?
[18:59:48] <acrichto> &mut foo[0] and &mut foo[1] ?
[19:00:33] <nmatsakis> sure
[19:00:37] <nmatsakis> you just have to do it right :)
[19:00:49] <nmatsakis> the type system isn't smart enough right now to distinguish 0 and 1,
[19:00:50] <nmatsakis> but you could write:
[19:01:10] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:01:13] <nmatsakis> let (slice0, slice1) = foo.mut_split(1);
[19:01:22] <nmatsakis> let port0 = &mut slice0[0];
[19:01:26] <nmatsakis> let port1 = &mut slice1[0];
[19:01:39] <nmatsakis> obviously this generalizes as needed
[19:02:04] <nmatsakis> we could also add some helpers like foo.mut_index2(0, 1); foo.mut_index3(0, 1, 2); etc
[19:02:17] <nmatsakis> it'd also be pretty easy to handle literal indices
[19:02:24] <nmatsakis> it's the non-literal ones that are ... you know, tricky.
[19:03:06] <eddyb> s/\d+//
[19:03:40] * eddyb slightly points toward variadic generics
[19:03:45] <nmatsakis> let ([mut port0], [mut port1, ..]) = foo.mut_spit(1)
[19:04:16] <acrichto> nmatsakis: ah yes I can see where that would be useful
[19:04:24] <nmatsakis> er: let ([mut ref port0], [mut ref port1, ..]) = foo.mut_spit(1)
[19:04:39] <eddyb> (but that would mean some sort of an index trait)
[19:04:44] <eddyb> nmatsakis: you mean ref mut :P?
[19:04:45] <acrichto> that's clever
[19:05:04] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:05:13] <nmatsakis> I think right now we don't accept "let [mut ref port0, ref mut port1, ..] = foo" but we could also do that (similar in challenge to accepting literal indices)
[19:05:25] <nmatsakis> ref mut, mut ref.
[19:05:47] <eddyb> one of those is an error, and I'm pretty sure it's mut ref
[19:06:58] <nmatsakis> yes
[19:15:20] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[19:15:20] *** ChanServ sets mode: +ao dherman dherman
[19:16:44] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:16:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e0a102d to 14b485e2b: 02http://git.io/N3iJvQ
[19:16:44] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:16:44] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:16:44] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/gJo10g
[19:16:44] <ghrust> 13rust/06auto 1452b835c 15Alex Crichton: Store metadata separately in rlib files...
[19:16:44] <ghrust> 13rust/06auto 14b7dbec9 15Alex Crichton: Implement LTO...
[19:16:45] <ghrust> 13rust/06auto 14c1a94ab 15bors: auto merge of #10812 : alexcrichton/rust/lto, r=pcwalton...
[19:16:47] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:17:05] <cmr> !
[19:17:58] <eddyb> !!! LTO :D
[19:18:15] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[19:20:08] *** Quits: jmbto (jmbto@moz-FE174E29.fbx.proxad.net) (Client exited)
[19:21:02] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:21:02] <ghrust> 01[13rust01] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/1GpfCg
[19:21:02] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:26:33] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[19:26:33] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c1a94ab to 14b485e2b: 02http://git.io/N3iJvQ
[19:26:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[19:30:21] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:41:41] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[19:42:51] *** Joins: jmbto (jmbto@moz-FE174E29.fbx.proxad.net)
[19:49:53] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[19:51:55] *** Quits: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au) (Ping timeout)
[20:11:44] *** Quits: jack (jack@moz-DF5A9AA3.members.linode.com) (Quit: leaving)
[20:13:38] *** jack_ is now known as jack
[20:16:02] *** Joins: MOeltjenbruns (goofy@moz-D9C12442.hsd1.mn.comcast.net)
[20:16:28] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[20:16:29] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:20:59] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[20:25:33] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[20:25:33] *** ChanServ sets mode: +o tjc
[20:26:36] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:26:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143929cd9 to 14b485e2b: 02http://git.io/N3iJvQ
[20:26:36] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:26:37] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:26:37] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/-DiQvg
[20:26:37] <ghrust> 13rust/06auto 1422f14fb 15Niko Matsakis: Issue #9629 -- permit freezing `&mut` found within an `&` pointer
[20:26:37] <ghrust> 13rust/06auto 149f7baed 15Niko Matsakis: Address nits for PR for #9629
[20:26:38] <ghrust> 13rust/06auto 141252947 15Niko Matsakis: Make main pub in test case (cc #9629)
[20:26:40] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:32:14] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[20:33:04] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[20:40:19] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:43:46] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[20:44:21] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[20:47:10] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[20:47:10] *** ChanServ sets mode: +ao dherman dherman
[20:48:10] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:52:49] <jack> does rustpkg's test_c_dependency_*() stuff make any sense?
[20:52:57] <jack> it runs gcc with -c foo.c -o libfoo.dylib
[20:53:10] <jack> is that valid?
[20:53:54] <jack> will a -l link with that?
[20:55:55] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[20:56:45] <acrichto> jack: I thought you had do have -dylib or -dynamiclib somewhere in there
[20:56:58] <acrichto> also wait no, that means that libfoo.dylib is an object file
[20:57:01] <acrichto> unless gcc does weird inference
[20:57:05] <jack> yes, that's what i thought
[20:57:13] <jack> file libfoo.dylib also reports it as an object file
[20:57:21] <jack> will -lfoo then link foo.o?
[20:57:49] <acrichto> I guess so
[20:58:00] <acrichto> the linker must be looking for libXXX.dylib
[20:58:06] <acrichto> but not inferring the type of the file from the name of the file
[20:58:40] <jack> i have no idea why this test is failing on my branch, but the more i look at it, the more i wonder how it ever passed
[21:02:35] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:04:22] *** Joins: bjz (bjz@moz-C1B1AF2A.lnse2.cha.bigpond.net.au)
[21:06:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[21:06:31] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141cb007c to 14b485e2b: 02http://git.io/N3iJvQ
[21:06:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[21:06:35] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:06:35] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/Evl3pQ
[21:06:35] <ghrust> 13rust/06auto 1452b835c 15Alex Crichton: Store metadata separately in rlib files...
[21:06:36] <ghrust> 13rust/06auto 14e7f732f 15Alex Crichton: Implement LTO...
[21:06:36] <ghrust> 13rust/06auto 14c4fe48e 15bors: auto merge of #10812 : alexcrichton/rust/lto, r=pcwalton...
[21:06:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:12:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:14:23] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:16:38] <jack> ok, this is the broken test.
[21:16:40] <jack> sigh
[21:16:55] <jack> what's the way to mark a test as ok to fail?
[21:17:39] <sfackler> you can just #[ignore] it
[21:18:22] <ChrisMorgan> Or if it is *expected* to fail, #[should_fail]
[21:18:25] <pnkfelix> jack: you mean like `// xfail-test`
[21:18:40] <pnkfelix> jack: or  is that only for rustc tests, not for rustpkg ones ?
[21:18:40] <jack> pnkfelix: this is for a #[test] style test
[21:18:47] <pnkfelix> jack: k
[21:19:21] <jack> ah. #[ignore(reason="foo")]
[21:19:53] * ChrisMorgan would quite like something between #[ignore] and #[should_fail]‚Äîrun it, but don't consider its passing as a requirement for success
[21:23:39] <strcat> nmatsakis: when your changes land, will `let x = ~5; if cond { let y = x; }` be illegal or will it just implicitly destroy `x` in an implicit `else` branch?
[21:24:22] <nmatsakis> strcat: we could do it either way, but current plan was illegal; you'd have to consume `x` in the else branch
[21:28:07] *** Quits: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net) (Ping timeout)
[21:33:16] *** Quits: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com) (Quit: Leaving)
[21:35:32] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[21:51:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:51:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c4fe48e to 14b485e2b: 02http://git.io/N3iJvQ
[21:51:35] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:58:02] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[22:15:29] *** Quits: jmbto (jmbto@moz-FE174E29.fbx.proxad.net) (Quit: Leaving)
[22:35:28] <ChrisMorgan> In `compile_and_link: x86_64-unknown-linux-gnu/stage2/test/extratest-x86_64-unknown-linux-gnu`, I'm getting `LandingPadInst not the first non-PHI instruction in the block.` and plenty more and it's failing to compile: https://pastebin.mozilla.org/3744624
[22:35:44] <ChrisMorgan> This happened to me last time I built, a few days ago, as well, but I didn't report it then.
[22:36:59] *** Joins: dbaupp (Thunderbir@1D1B1F7A.D5A1DCF.37681C44.IP)
[22:40:13] <ChrisMorgan> Uh oh, rust-http `make check` is also failing in just the same way. Sounds like this is a genuine repeatable bug.
[22:42:06] <aatch> ChrisMorgan, was there an LLVM update recently?
[22:42:20] <ChrisMorgan> There was.
[22:42:23] <jack> aatch: on 12/5 or so
[22:42:36] <acrichto> ChrisMorgan: I was getting that error before I updated LLVM, but you're still getting it?
[22:42:38] <ChrisMorgan> It directly coincides with the previous build I made.
[22:42:45] <ChrisMorgan> acrichto: yes, I'm getting it still with a fresh build.
[22:43:02] <acrichto> weird
[22:43:26] <aatch> It could be either a change in trans or an update to the LLVM that adds that check.
[22:43:43] <aatch> It's possible that it's uncovered a bug in rustc.
[22:44:07] <acrichto> there was indeed a change in trans that accompanied that, but I believe it to be an LLVM bug b/c if you turn off optimizations it compiles ok
[22:44:20] <acrichto> the change was to stop emitting calls to upcall_reset_stack_limit()
[22:44:24] <acrichto> during a landing pad
[22:44:59] <ChrisMorgan> -O is killing it with rust-http.
[22:45:11] <ChrisMorgan> `rustc --test -o tmp src/http/lib.rs` works, but add in a -O and it doesn't.
[22:45:35] <aatch> Hmm, I'm inclined to agree with acrichto in that case.
[22:45:52] <dbaupp> bugpoint?
[22:45:57] <acrichto> ChrisMorgan: what version does rustc print?
[22:46:10] <ChrisMorgan> rustc 0.9-pre (b485e2b 2013-12-09 08:21:32 -0800)
[22:46:18] <ChrisMorgan> (Built just a couple of hours ago.)
[22:46:24] <acrichto> lol that is quite recent
[22:46:39] <acrichto> do you know how to use bugpoint?
[22:46:40] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Connection reset by peer)
[22:46:54] <ChrisMorgan> acrichto: I was actually just identifying the -O before you mentioned the "if you turn off optimizations", having noticed in rust-http that `make check` was failing and `make quickcheck` wasn't!
[22:46:59] <Eridius> I'm surprised it's necessary, but here's a PR for .as_mut_slice(): https://github.com/mozilla/rust/pull/10885
[22:47:04] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[22:47:18] <ChrisMorgan> I think it was rustc --emit-llvm, then run bugpoint on that thing.
[22:47:44] <acrichto> ChrisMorgan: yeah you'll find bugpoint in $target/llvm/Release+Asserts/bin
[22:47:50] <acrichto> and you'll probably have to point your PATH at that directory as well
[22:47:54] <ChrisMorgan> Yep, got it.
[22:48:14] <dbaupp> Eridius: I thought we had it already?
[22:48:54] <dbaupp> oh, I must've been remembering adding the convenience .mut_slice_{to,from}
[22:49:00] <Eridius> dbaupp: yeah, I couldn't find an .as_mut_slice()
[22:49:06] <ChrisMorgan> acrichto: "Sorry, I can't automatically select a safe interpreter!"
[22:49:21] <dbaupp> Eridius: hm
[22:49:25] <ChrisMorgan> (That with `PATH=../rust/x86_64-unknown-linux-gnu/llvm/Release+Asserts/bin/:$PATH bugpoint src/http/http.bc`.)
[22:49:46] <acrichto> perhaps use an absolute path
[22:49:55] <acrichto> instead of a relative one (not sure why that would change things though)
[22:50:04] <dbaupp> Eridius: why by-val self?
[22:50:06] <ChrisMorgan> No effect.
[22:50:12] <Eridius> dbaupp: I'm surprised a method like this is necessary, but apparently Rust won't coerce a &mut [T, ..N] to a &mut [T] via anything other than a method call
[22:50:29] <ChrisMorgan> Lines written: "Read input file      : 'src/http/http.bc'" "*** All input ok" "Initializing execution environment: Found lli: /home/chris/vc/rust/x86_64-unknown-linux-gnu/llvm/Release+Asserts/bin/lli" "Sorry, I can't automatically select a safe interpreter!" "" "Exiting."
[22:50:33] <Eridius> dbaupp: because why not? It matches the .mut_slice() method. This trait is only implemented on &'self mut [T]
[22:50:40] <dbaupp> Eridius: &mut[] moves
[22:50:49] <dbaupp> (at least, I think it does.)
[22:50:52] <acrichto> ChrisMorgan: sounds like your llvm installation may be a bit fishy?
[22:51:04] <Eridius> dbaupp: all of the MutableVector methods take by-val self
[22:51:12] <Eridius> well, most of them. mut_shift_ref doesn't
[22:51:16] <ChrisMorgan> acrichto: can't see why it would be, but I take it you'll suggest clean-llvm?
[22:51:24] <dbaupp> rusti: let mut x = [1,2,3]; let y = &mut x; let _z: &mut [int] = *y;
[22:51:25] -rusti- ()
[22:51:36] <dbaupp> Eridius: look ma, no method. ^ :P
[22:51:52] <acrichto> ChrisMorgan: yeah, although when cleaning llvm I normally nuke everything with 'git clean -fdx'
[22:51:59] <dbaupp> Eridius: oh, ok; I stand corrected.
[22:51:59] <acrichto> dunno what -fdx is but I always do it
[22:52:01] <Eridius> dbaupp: wait what? You derefernced your pointer. How'd you get another pointer?
[22:52:14] <acrichto> ChrisMorgan: also, can you paste the ll code?
[22:52:17] <acrichto> I can try running bugpoint
[22:52:28] <dbaupp> Eridius: &mut [T, .. n] is just &mut Y with Y (a normal, sized type) being [T, .. n]
[22:52:37] <dbaupp> Eridius: so it's a normal pointer
[22:52:55] <Eridius> dbaupp: so shouldn't *y be [T, ..n]? Why is it assignable to a &mut [int]?
[22:53:02] <aatch> Eridius, auto-slice
[22:53:21] <ChrisMorgan> acrichto: http://chrismorgan.info/temp/http.bc
[22:53:59] <ChrisMorgan> (1.2MB? Quite large.)
[22:54:00] <acrichto> ChrisMorgan: it's doing its thing
[22:54:03] <acrichto> whoa that was fast
[22:54:26] <acrichto> ugh it still has 3k lines of IR
[22:54:31] * ChrisMorgan hasn't ever actually run bugpoint before and so doesn't know how long it should be expected to take
[22:54:46] <ChrisMorgan> acrichto: what's the verdict? I should clean LLVM?
[22:55:02] <acrichto> looks like thi smay just be an LLVm bug
[22:55:05] <acrichto> I wouldn't clean llvm
[22:55:25] <acrichto> ChrisMorgan: did you optimize the IR ahead of time?
[22:55:31] <ChrisMorgan> (BTW, git clean -fdx has the effect of returning the repository to an absolutely pristine state, forcibly removing all ignored and unknown files.)
[22:55:50] <acrichto> this is dying when I try to do anything with it
[22:55:51] <ChrisMorgan> acrichto: that was `rustc --test -O src/http/lib.rs`
[22:55:59] <acrichto> can you take of the -O and give me that IR?
[22:55:59] <ChrisMorgan> --emit-llvm
[22:56:04] <acrichto> I wanna go from successful to failing
[22:56:09] <acrichto> right now it's failing => failing
[22:56:14] <acrichto> and bugpoint isn't doing so hot at that
[22:56:52] <ChrisMorgan> acrichto: http://chrismorgan.info/temp/http.noopt.bc
[22:57:12] <ChrisMorgan> (1.7MB? Quite large.)
[22:57:35] <acrichto> we generate a lot of IR
[22:58:00] <acrichto> ugh now it doesn't like my interpreter either
[22:58:07] <ChrisMorgan> Delightful.
[22:58:28] <acrichto> oh nvmd
[22:58:35] <jack> How do I add a new crate attribute?
[22:58:46] <acrichto> ChrisMorgan: wait no, so I'm optimizing that just fine
[22:58:49] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:58:50] <acrichto> ChrisMorgan: as in there are no crashes for me
[22:58:53] <jack> Ie, to satisfy the attribute_usage lint
[22:59:01] <acrichto> jack: somewhere in middle::lint there's a whitelist
[22:59:07] <acrichto> search for no_implicit_prelude
[22:59:13] <acrichto> that's a good unique one
[22:59:44] <acrichto> ChrisMorgan: it looks like your LLVM may have not gotten rebuilt
[22:59:47] <acrichto> or something is out of sync
[23:00:03] <acrichto> b/c if bugpoint prints that it couldn't find a safe interpreter above it it printed "All input ok"
[23:00:07] <acrichto> which means that it optimized just fine
[23:00:16] <acrichto> I think it tries to interpret it after that and we don't really care about that
[23:00:20] <jack> acrichto: thanks. found it.
[23:01:20] <ChrisMorgan> acrichto: LLVM is claiming to have been built on 2013-12-08, which is the right date.
[23:01:26] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:01:39] <acrichto> can llvm give you the revision it was built at?
[23:01:56] <ChrisMorgan> "3.5svn" :-(
[23:01:59] <acrichto> oh man we're on 3.5sv
[23:02:00] <acrichto> svn
[23:02:10] <acrichto> hm, what rev is your src/llvm at ?
[23:02:31] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[23:02:49] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[23:03:09] <ChrisMorgan> `git st` in src/llvm indicates eac6ff7; not certain if that's all in order for the submodule?
[23:03:29] <acrichto> hm, that's right as well
[23:03:30] <ChrisMorgan> Yeah, looks right.
[23:03:43] <acrichto> my best recommendation is nuking everything and starting over
[23:03:45] <acrichto> it *should* be working
[23:03:58] <acrichto> I don't think LLVm has much platform-specific behavior when optimizing...
[23:04:01] <ChrisMorgan> Yeah, I'll do that.
[23:04:10] <strcat> acrichto: it does
[23:04:14] <strcat> a lot of it ;]
[23:04:20] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[23:04:38] <acrichto> hm, I guess I was thinking more along the lines of if you do constant propagation on windows you probably want to do constant propagation on osx
[23:06:01] * ChrisMorgan goes for his first treely‚Äêruly‚Äêfresh rebuild
[23:06:37] <strcat> acrichto: ah it's probably not very OS-specific
[23:06:41] <strcat> I mean arch-specific
[23:06:43] <jack> acrichto: any ideas what this could be? i just rebased my pkgid patch onto your linker changes on master: https://gist.github.com/metajack/7882756
[23:06:55] <ChrisMorgan> ‚Ä¶ and after a quick ./configure, invokes his `git pull --ff-only mozilla master && git push && make && make install && make TAGS.vi && make check`
[23:07:13] <strcat> acrichto: like it will output <4 * float> or <4 * i32> vectors on x86_64 by default, since it knows it has SSE registers to shove things in
[23:07:39] <acrichto> jack: you didn't modify linker flags, did you?
[23:07:43] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:07:43] *** ChanServ sets mode: +qo brson brson
[23:07:44] <acrichto> strcat: oh yeah that makes sense
[23:07:48] <acrichto> vectorization is scary
[23:07:56] <strcat> there are  other things like that though
[23:08:07] <strcat> optimization passes have a lot of queries to target specific info
[23:08:07] <acrichto> yeah that makes sense
[23:08:10] <strcat> asking how much stuff costs
[23:08:12] <jack> acrichto: which flags?
[23:08:13] <strcat> like inlining, especially
[23:08:14] <acrichto> which we have now!
[23:08:22] <acrichto> jack: I'll take it the answer to that is no then
[23:08:40] <acrichto> jack: it may be picking up an old libstd, or possibly an old librustrt was linked into libstd
[23:08:54] <strcat> for example you can ask it how much llvm.sqrt costs, and on x86 it is cheaper than a function call
[23:09:08] <strcat> but on ARM it's probably super expensive
[23:10:20] <jack> acrichto: is make clean likely to fix that?
[23:12:04] <dbaupp> is https://github.com/mozilla/rust/pull/10791 r-able?
[23:12:18] <dbaupp> pcwalton: ^
[23:12:33] <pcwalton> dbaupp: working on it
[23:13:02] <ChrisMorgan> dbaupp: you mean "able to be given r-"? :P
[23:20:32] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[23:20:57] <acrichto> jack: yeah if that's the problem a make clean would blow things away
[23:21:00] *** kimundi is now known as zz_kimundi
[23:21:13] <jack> acrichto: that did indeed work. yay
[23:21:33] <acrichto> maybe make should run `make clean`
[23:21:43] <acrichto> or maybe I should just get better about cleaning out old deps :(
[23:27:27] <jack> acrichto: why was anon-extern-mod-cross-crate-2.rs have a #[link_name="rustrt"]?
[23:27:33] <jack> s/was/does/
[23:28:16] <acrichto> should probably be link(name = "rustrt")
[23:28:34] <acrichto> I also don't think that it does today
[23:28:35] <acrichto> it shouldn't
[23:28:48] <jack> must be some weird rebase artifact.
[23:40:26] *** flaper87 is now known as flaper87|afk
[23:42:04] *** Joins: doomlord_ (servitor@moz-D40D68D6.range86-184.btcentralplus.com)
[23:44:05] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[23:58:41] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
