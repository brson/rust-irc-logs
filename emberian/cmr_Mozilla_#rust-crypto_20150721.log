[00:08:51] <Ilari> "Copying Mozilla's certificate database into a PEM file to use in your OpenSSL app is a recipe for unpleasant surprises, unfortunately."
[00:09:56] <bascule> we do something like that :(
[00:11:22] <Ilari> Connecting to random servers or something like that?
[00:12:10] <bascule> we build our own truststore by running a bunch of (ruby?) scripts against Mozilla's stuff periodically
[00:13:15] <Ilari> Apparently some special restrictions are coded elsewhere. Like the special handling for CNNIC.
[00:15:30] <Tiffany> what's a good option if you're trying to connect to random websites?
[00:15:38] <Ilari> Also, the hash in DJB&co proposal is widepipe.
[00:16:32] <Tiffany> widepipe?
[00:17:38] *** Quits: _neal_ (neal@moz-of66u9.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:18:06] <Ilari> The internal state is wider (usually double) from output size.
[00:19:07] <Tiffany> that seems like a good idea
[00:26:40] <eternaleye> bascule: BTW, re: network chat and CP vs AP: https://aphyr.com/posts/288-the-network-is-reliable
[00:26:53] <eternaleye> bascule: Part of the (really good) "Jepsen" series of posts
[00:28:05] <eternaleye> Tiffany: Well, requiring the hash used to be wide pipe is difficult, since you need such a hash to exist at the sizes you want.
[00:28:16] <Ilari> I put 64 bit margin there, even for near-PoT curves.
[00:29:09] <Ilari> And given that it is intended to run with 512-bit hashes even with small curves.
[00:38:23] <bascule> eternaleye: yes I <3 aphyr
[00:39:06] <bascule> eternaleye: I think the Moxie arguments are much more relevant, heh
[00:39:16] <bascule> but ACKs are part of how you have good UX anyway
[00:39:23] <eternaleye> Ilari: Yup, yours not being nearly as wide as DJB's requires is a major benefit
[00:39:45] <eternaleye> bascule: Sure. That's why the Matrix federation protocol and the Matrix client-server protocol are different things.
[00:40:01] <Tiffany> yeah
[00:40:02] <eternaleye> bascule: The Matrix federation protocol is very much AP
[00:40:15] <Tiffany> when you submit something and you're just left hanging wondering if it went through
[00:40:17] <Tiffany> not a good time
[00:40:18] <eternaleye> bascule: The Matrix client-server protocol is very much simple, client-server REST
[00:40:42] <Ilari> eternaleye: The problems with running >896-bit pipe with Goldilocks?
[00:40:47] <eternaleye> bascule: And since the message DB is persistent, on network failure (no ack, no nack) you can check if it's back
[00:40:49] <bascule> I think what I want to do is very, very different from Matrix
[00:41:03] <bascule> and much closer to something like Google Wave
[00:41:16] <Tiffany> I think matrix is the best chance at getting something as popular as irc
[00:41:22] <eternaleye> bascule: Message threading inside of rooms is an explicitly planned feature, FYI
[00:41:33] <eternaleye> bascule: And doing collaborative art &c has already been done in Matrix
[00:41:36] <Tiffany> I thought matrix was social platform agnostic
[00:41:41] <eternaleye> bascule: And the AS protocol gives us bots
[00:41:42] <Tiffany> that you can map google wave to matrix
[00:41:59] <eternaleye> bascule: So yeah, the Wave _functionality_ makes sense over matrix' _protocol_
[00:42:09] <eternaleye> bascule: Also, the Wave folks aren't so hot on using OT again :P
[00:42:35] <eternaleye> bascule: See near the bottom of the OT wikipedia article for quotes
[00:43:03] <eternaleye> >> Similarly, Joseph Gentle who is an ex Google Wave engineer and an author of the Share.JS library wrote: Unfortunately, implementing OT sucks. There's a million algorithms with different tradeoffs, mostly trapped in academic papers. The algorithms are really hard and time consuming to implement correctly. ... Wave took 2 years to write and if we rewrote it today, it would take almost as long to write a second time.[35]
[00:43:36] <Ilari> if (!((_ok) ? true : (Math.random() > 0.1))) { return res; }    ... Seems legit.
[00:43:54] <bascule> eternaleye: I think the fundamental thing you're missing is I want to build a chat system using something far more abstract than a chat system :P
[00:44:59] <Tiffany> do you have a design doc bascule?
[00:45:02] <bascule> and where that might lead to things Matrix would consider UX nits, I think those can be worked around by providing good feedback to the user
[00:45:13] <bascule> Tiffany: it's the Cryptosphere, what design docs I have are on the github repo
[00:45:29] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[00:45:35] <Tiffany> chat over cryptosphere huh?
[00:46:03] <bascule> yes
[00:46:12] <Ilari> eternaleye: Hmm... Got any real-world "hash functions" that fail the requirements needed for Schnorr, but not fail 2nd (or 1st) preimage resistance. Or what kind of attacks could cause that sort of thing to happen?
[00:46:22] <bascule> also just a motivating use case
[00:47:24] <bascule> as opposed to your typical MNet/FreeNet/GNUnet/Tahoe-LAFS/MaidSafe/StorJ/IPFS-style "we'll build a platform. who knows what will use it?" approach
[00:48:07] <bascule> the most major innovation in recent history seems to be looping a Bitcoin-like blockchain into it
[00:48:08] <Ilari> Hmm... MD4 is probably so broken one could recover the signing key. :->
[00:49:20] <eternaleye> bascule: Well, the Matrix devs do describe Matrix as a "persistent JSON log database" :P
[00:49:32] <eternaleye> bascule: They just have chat as the primary use case
[00:50:00] <bascule> I think the names I just prattled off are much closer to what I have in mind than the Matrix
[00:50:07] <eternaleye> Mm
[00:50:39] <eternaleye> There's actually a plan to support federating (and connecting to) Matrix over GNUnet
[00:50:50] <eternaleye> And another person's pushing for the same thing re: IPFS
[00:51:43] <Ilari> Hmm... The internal structure of Schnorr (even deterministic) seems to make attacks via weak hash functions (unless those are broken enough to admit preimage attacks) annoying.
[00:52:21] <bascule> eternaleye: I think I'm envisioning something a little simpler and more parsimonious
[00:55:25] <Ilari> Hmm... DJB IIRC said that SHA-512 is great overkill as hash function for Ed25519.
[00:59:13] *** Quits: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe) (Quit: ZNC - http://znc.in)
[01:00:54] <Ilari> And it might tell something that the DB's scheme has "ECDSA" in its name...
[01:05:26] <Ilari> (Wonder why nobody pushed modified ECGDSA or ECKDSA. :-)
[01:08:52] <Ilari> Or why didn't ruskies post modified version of GOST. :->
[01:09:58] *** Quits: dcb (dcb@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:15:59] *** Joins: tiffany (kawaii@moz-601ti8.dhcp.embarqhsd.net)
[01:16:10] <tiffany> so for some reason my ZNC can't connect to mozilla?
[01:16:11] <bascule> FrankenECDSA!
[01:16:18] <tiffany> [21:15] <*status> Disconnected from IRC (error:140940E5:SSL routines:ssl3_read_bytes:ssl handshake failure). Reconnecting...
[01:19:12] <tiffany> I don't know what the 'ssl3' deal is
[01:19:18] <tiffany> znc can and does use TLS 1.2
[01:19:31] <Ilari> bascule: Well, DB's scheme is quite close to FrankenECDSA?
[01:21:23] <tiffany> I don't get it
[01:21:31] <tiffany> I can connect just fine with openssl s_client
[01:29:40] *** Quits: tiffany (kawaii@moz-601ti8.dhcp.embarqhsd.net) (Ping timeout: 121 seconds)
[01:44:37] <Ilari> Yup, if f() is chosen to be x(P) mod l, then the signature is ECDSA signature of M||R.
[01:46:44] *** Joins: dcb (textual@moz-v6l3du.ca.comcast.net)
[01:50:41] <Ilari> Also, the presentation claims "constant-time". No, it isn't, unless one implements that whole darn inversion in constant time, which is known to be slow.
[01:54:08] *** Quits: tomlikestorock (tomlikestor@moz-rjs7c5.static.sonic.net) (Client exited)
[01:55:06] *** Joins: dpc (dpc@moz-t6gr4b.ca.comcast.net)
[01:58:36] <Ilari> Also, DB's scheme (nor WL's) does not support online operation via hash-signing (well, one could sign hashes, bet that is not the way online operation works there).
[02:02:00] <Ilari> All the other three do online operation via hash-signing.
[02:05:17] <Ilari> bascule: Also, in IPSECME meeting, there were claims of NIST P-256 implementation as fast as fastest Curve25519 implementations. Little details tho.
[02:07:01] <bascule> haha, ok
[02:07:40] <Ilari> Done by some NIST employee or something.
[02:07:58] <bascule> well cool I guess
[02:08:35] <Ilari> Wonder how much gap there is between average speed of fully unprotected P-256 implementation and fully timing-protected one (of course, the latter is extremely nasty to write).
[02:14:08] <Ilari> bascule: There also were some claims that the very fast implementation was timing-unprotected. Dunno if it is true.
[02:14:21] <bascule> hahaha ok
[02:14:28] <bascule> one step forward, two steps back? ;)
[02:14:38] <bascule> next you're going to tell me it doesn't verify if points are on the curve or not
[02:14:53] *** Quits: dcb (textual@moz-v6l3du.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:17:09] <Ilari> Well, as I said, very little is known (and it hasn't been submitted to SUPERCOP).
[02:18:50] <eternaleye> Ooooh: https://github.com/waynenilsen/capnp-ffi
[02:19:14] <eternaleye> Cap'n Proto as an FFI interface :D
[02:21:32] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[02:44:28] <bascule> hahaha
[02:44:30] <bascule> eenteresting
[02:44:37] <bascule> I think I saw that earlier
[02:47:08] *** Joins: c74d3 (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP)
[02:47:52] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[02:48:36] *** c74d3 is now known as c74d
[02:49:03] *** Quits: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP) (Connection closed)
[02:49:29] *** Joins: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP)
[02:54:36] <Ilari> BTW, got warning about insecure connection to Jabber (logging in again seemed to fix things).
[03:01:18] <bascule> lol
[03:08:13] *** Joins: dcb (textual@moz-v6l3du.ca.comcast.net)
[03:15:00] *** Quits: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP) (Connection closed)
[03:15:44] *** Joins: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP)
[03:16:10] <Ilari> I have also long ago seen SSH print warning about new host (not the nasty warning) followed by password prompt (when hostkey was set up).
[03:16:39] <Ilari> *keypair was set up.
[03:17:13] <Ilari> Apparently SSH versions back then didn't handle hostkey algorithm change correctly (showing mild new host warning instead of the nasty hostkey change warning).
[03:17:52] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[03:18:44] *** Quits: eddyb (eddyb@moz-6s1.6n6.26.188.IP) (Ping timeout: 121 seconds)
[03:24:27] <Ilari> Oh, wow, seems like paper by Dan Brown about security of Schnorr signatures (only short-sig tho).
[03:24:42] *** Joins: eddyb (eddyb@moz-ic7.82i.25.188.IP)
[03:30:28] *** Quits: dcb (textual@moz-v6l3du.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[03:41:41] <bascule> hahaha Ilari 
[03:41:41] <bascule> seems bad
[03:49:50] *** Joins: dcb (textual@moz-v6l3du.ca.comcast.net)
[04:03:53] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[04:09:14] *** Joins: _neal_ (neal@moz-of66u9.ca.comcast.net)
[04:12:18] <bascule> here's another data point for an ARM-powered future: http://www.bitsofcents.com/post/118749233621/disassembling-the-dash
[04:12:35] <bascule> although granted, it seems it uses a lot of power (needs a AAA) and ends up being rather large
[04:12:55] <bascule> needs more 7nm ARM uCs! :o
[04:13:53] <bascule> those buttons would be so much cooler if they had a lithium battery
[04:14:00] <bascule> maybe two of them
[04:14:11] <bascule> but still it could be way flatter/smaller
[04:14:13] <bascule> that form factor sucks
[04:15:12] <bascule> maybe I'm just biased from Square where our hardware people are constantly blowing my mind with what is possible, heh
[04:15:55] <mcpherrin> STM32F, no real surprises there
[04:16:10] <mcpherrin> bascule: the dash button is intended as a fast-iteration tech demo
[04:17:06] <mcpherrin> The real value comes when appliances taking consumables build the button in
[04:17:32] <mcpherrin> They're not gonna spend real money on physical tooling, never mind a custom IC or something
[04:17:58] <bascule> yeah those things just... look even worse than I was expecting, lol
[04:20:25] <Ilari> Also, on another session, Kenny commented about the construction at hand that use of HMAC there could not provode any additional security (well, the whole thing was known to be rather low-security).
[04:20:32] <mcpherrin> the pcb design looks amateur
[04:21:47] <mcpherrin> looks like easily accessible test & debug pins though
[04:23:13] <mcpherrin> If I'm following those traces right, there's a socket hooked up to the serial flash
[04:32:37] <mcpherrin> The coin card on this same website has a neat teardown too
[04:38:00] <Ilari> I would expect real-world hash function to have Random Prefix Preimage and 1st Preimage  and Random Prefix 2nd Preimage and 2nd Preimage  to be close in complexity.
[04:38:08] *** Quits: dpc (dpc@moz-t6gr4b.ca.comcast.net) (Ping timeout: 121 seconds)
[04:39:20] <Ilari> And on real-world hash functions, preimage resistance seems much more solid than collision resistance.
[04:45:05] *** Quits: dcb (textual@moz-v6l3du.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[04:51:18] *** Quits: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP) (Connection closed)
[04:51:31] *** Joins: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP)
[05:00:29] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[05:04:39] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[05:08:07] <bascule> mcpherrin: yeah, that's what I was reading when I clicked over to the dash
[05:08:10] <bascule> mcpherrin: also lolcoin
[05:08:13] <bascule> that thing is doomed
[05:08:29] <bascule> in addition to everything else, sounds like the break frequently
[05:11:11] <mcpherrin> bascule: Have you seen the "Double double" tim's cards in Canada?
[05:11:26] <mcpherrin> it's like coin except hardcoded to be a visa + tim hortons reward card :P
[05:11:31] <mcpherrin> with LEDs and buttons!
[05:11:56] <mcpherrin> I hear they don't work very well either :P
[05:12:09] <mcpherrin> But at least it does EMV / NFC
[05:16:24] <bascule> yeah there are several that claim to be doing EMV
[05:16:26] <bascule> good luck
[05:16:34] <bascule> you have to actually partner with banks to do that
[05:16:39] <bascule> and it's a one-off integration per bank
[05:16:50] <bascule> and banks don't like proxy cards to begin with if they obscure their brand
[05:17:16] <bascule> if you can do that, you can use EMV tokenization. Also, you're basically reinventing Apple Pay with crappier technology
[05:17:46] <eternaleye> Or Google Wallet
[05:17:57] * eternaleye uses Wallet; it's quite nice really
[05:19:05] <bascule> Google Wallet is now Android Pay
[05:19:11] <bascule> it's like Apple Pay, except s/Apple/Android/
[05:19:13] <bascule> or rather
[05:19:30] <bascule> Google Wallet is now a peer-to-peer payments app competing with Apple Wallet, Venmo, and Square Cash
[05:19:45] <bascule> and I guess Facebook is trying to get into that space too
[05:21:11] <eternaleye> bascule: It already was peer-to-peer payment; you could put in an email address and send money, etc
[05:21:19] <eternaleye> bascule: I just like that I can use it as a cash card
[05:21:36] <eternaleye> bascule: And as the only actual CARD in my wallet, if someone mugs me, nothing much lost
[05:22:07] <bascule> eternaleye: well now it's only a peer-to-peer payment app, because Android Pay is taking over the Apple Pay-like retail payment functionality
[05:22:28] <eternaleye> Mm
[05:22:46] <eternaleye> Well then, my white card with a big W on it will be a limited-edition item :P
[05:22:57] <bascule> heh
[05:24:32] <mcpherrin> bascule: yeah, the doubledouble card is a single bank
[05:25:01] <eternaleye> bascule: As someone who actually uses Wallet all the time, this looks to be full of misinformation: http://www.wired.com/2015/06/android-pay-will-succeed-google-wallet-failed/
[05:25:11] <eternaleye> >> Many argue Apple didn’t do anything Google hadn’t already done. But it worked with MasterCard, Visa, and American Express so its system would dovetail securely with existing credit card networks.
[05:25:21] <eternaleye> Uh, yeah, my wallet card _is_ a mastercard...
[05:25:35] <bascule> eternaleye: Apple did EMV tokenization
[05:25:39] <eternaleye> Mm
[05:25:47] <bascule> Android Pay added EMV tokenization
[05:25:55] <mcpherrin> I am still angry google wallet didn't launch in Canada, where NFC card payment is widespread (and I was, at the time)
[05:25:56] <eternaleye> Also, practically nothing around here does NFC
[05:25:58] <eternaleye> At all
[05:26:06] <eternaleye> So a physical card is kind of necessary
[05:26:18] <mcpherrin> Instead I have a google wallet account in the US where I can only use it at walgreens
[05:26:21] <mcpherrin> and safeway
[05:26:28] <eternaleye> mcpherrin: You didn't get the card?
[05:26:36] <mcpherrin> eternaleye: yeah, but I never use it
[05:26:40] <eternaleye> Ah
[05:26:45] <mcpherrin> I just never use google wallet
[05:26:54] <mcpherrin> I would have paid with phone in Canada via NFC
[05:26:59] <eternaleye> I use it all the time - just keep $20 on it, and add money in the checkout line for bigger stuff
[05:27:15] <mcpherrin> Meh, I just use my credit card.
[05:27:21] <eternaleye> It's literally the only card I've used for months and months
[05:27:23] * bascule does Walgreens and Whole (a.k.a. LOL) Foods
[05:27:25] <c74d> What's the benefit of the Google Wallet card over a bank card?
[05:27:46] <bascule> c74d: the main benefit of NFC systems like that is native support for concurrent payments
[05:27:48] <eternaleye> c74d: I personally like the centralized log, and that as a cash card someone who steals it gets basically nothing of use
[05:28:20] <bascule> which works particularly well with Apple Pay, since it notifies you of the final charge when the transaction completes
[05:28:34] <bascule> on your phone, not their terminal
[05:28:34] <eternaleye> c74d: I have to explicitly move money to it with my phone, which I see as a huge plus, security-wise
[05:28:42] <c74d> Oh, the Google Wallet card does NFC? I guess I assumed it was just a normal swipe-y card.
[05:28:47] <eternaleye> c74d: And similarly, it alerts me
[05:28:52] <eternaleye> c74d: The card is swipe-y
[05:28:55] <eternaleye> c74d: The phone is NFC
[05:29:09] <eternaleye> c74d: I have an HTC One M8, so it has it
[05:29:25] <c74d> eternaleye: mm, makes sense.
[05:29:27] <eternaleye> c74d: But nothing in my area gives two shits about NFC, so I always use the card
[05:29:47] <eternaleye> For me, the benefit is not carrying _anything_ that's a direct line to my credit rating or bank account
[05:30:05] <eternaleye> At least not without unlocking my phone and entering my Google Wallet pin
[05:30:10] <bascule> hopefully Square can help improve adoption of NFC ;)
[05:32:29] <mcpherrin> bascule: More like square will help merchants get angry at their lost square NFC readers that aren't easily locked down to your food truck window ;p
[05:32:39] <bascule> lolol
[05:33:19] <mcpherrin> A standalone device with no easy (eg, laptop kensington lock slot) way to lock it down??
[05:34:09] <mcpherrin> (from my cursory examination of pictures online)
[05:34:46] <bascule> lol https://blog.shodan.io/its-the-data-stupid/
[05:35:30] <mcpherrin> part of me is really tempted to find out what's in those HackedDBs 
[05:35:32] <bascule> mcpherrin: I don't actually know about a lock slot
[05:35:54] <eternaleye> Apple has also removed the lock slot from... basically everything
[05:36:11] <mcpherrin> eternaleye: which is annoying because my employer demands laptops be locked up when unattended :|
[05:36:18] <mcpherrin> so newer apple users have to put our laptops in drawers
[05:36:36] <eternaleye> or get a dremel :P
[05:36:43] <mcpherrin> I just disobey instructions and leave my laptop out
[05:36:54] <mcpherrin> if it ever gets stolen I guess I will get grumbled at
[05:37:28] * bascule has a backpack, generally takes laptop with him
[05:37:40] <mcpherrin> Yeah, I hate carrying laptops to and from work
[05:37:42] <mcpherrin> especially since 
[05:37:51] <mcpherrin> especially since I like to bike
[05:37:59] <c74d> eternaleye: oh, but the money put in the Wallet card can't be from a credit card, so one doesn't get a credit score benefit from it?
[05:38:01] <bascule> I walk!
[05:38:06] <eternaleye> c74d: Yes it can
[05:38:16] <bascule> I used to bike with a laptop, albeit a smaller one
[05:38:25] <eternaleye> c74d: Oh, wait
[05:38:31] <eternaleye> c74d: It _used_ to be that you could
[05:38:39] <c74d> Oh? the FAQ says it can be from a linked bank account or debit card, but I guess that could be out of date
[05:38:40] <eternaleye> c74d: Now you can't put cash on wallet from credit
[05:38:45] <c74d> oh
[05:38:58] <eternaleye> c74d: I have a Discover card that I did so with in the past
[05:39:19] <eternaleye> c74d: (In fact, at one point I was between paychecks for a bit, so I looped money through for the Discover bill :P)
[05:39:33] <bascule> all I can say is I legitimately don't like Venmo
[05:39:55] <eternaleye> Discover -> Wallet -> Bank -> Discover
[05:41:38] <bascule> lol djb: https://twitter.com/hashbreaker/status/623366934579515392
[05:42:06] <bascule> CFRG IS CENSORING YOU
[05:42:35] <bascule> Kevin Igoe is using his remaining NSA power while it lasts to keep you down
[05:43:05] <eternaleye> Or, yknow, attachment limits/greylisting
[05:43:15] <bascule> haha yeah maybe that ;)
[05:44:03] <eternaleye> Then again, IIRC, didn't he refuse to add greylisting support to qmail or something?
[05:44:25] <bascule> I don't remember
[05:44:30] <Ilari> Eh, Kevin Igoe isn't CFRG chair anymore.
[05:44:40] <bascule> qmail was my first experience with his software needing to be de-Bernsteinized
[05:44:45] <bascule> Ilari: I just saw he was retiring, heh
[05:44:47] <bascule> but it was a joke
[05:44:50] <eternaleye> Ilari: thatsthejoke.gif
[05:45:36] <eternaleye> I wonder how hard it'd be to make a Rust-based, modern-standards MTA that uses session types for all IPC/protocols
[05:46:12] <eternaleye> with Nom-based RFC[2]822 parsing &c
[05:46:42] <eternaleye> (Actually, a session-types TLS library would be damn nice)
[05:48:23] <bascule> yeah perhaps start with a Rust TLS library lol
[05:49:21] <Ilari> Fun interpretations. It seemingly does some odd integer encoding for me...
[05:49:36] * Ilari goes to check what he actually wrote.
[05:49:55] <eternaleye> bascule: I personally perfer coming up with the common interface (Session types for TLS, crypto traits, etc), and then do a compliant implementation
[05:50:28] <eternaleye> bascule: Since the TLS spec really ought to be implemented as a state-machine anyway, it makes even more sense IMO
[05:50:41] <Ilari> Yeah, LEB128.
[05:51:14] <eternaleye> Also, still reading through https://aphyr.com/posts/288-the-network-is-reliable, and the "MLAG, Spanning Tree, and STONITH" one reads like something out of the Three Stooges or a Marx Brothers film
[05:52:35] <mcpherrin> selling people reliable networks is an amazing exercise in taking candy from babies
[05:54:10] <bascule> spanning tree needs to die, heh
[05:54:27] <mcpherrin> layer 2 networks need to die first
[05:54:41] <bascule> Radia Perlman, I love you and Imma let you finish, but
[05:54:50] <mcpherrin> or TRILL
[05:54:55] <bascule> mcpherrin: well that's the point, heh
[05:54:59] <bascule> die layer 2 die!
[05:55:17] <bascule> if only BGP security were like... better
[05:55:20] <mcpherrin> L2 over a TRILL network!
[05:55:37] <Ilari> Apparently DJB interpretted LEB128 as 128-bit little-endian integer encoding (it isn't).
[05:55:42] <bascule> I expect we will start rocking BIRD or Quagga soon
[05:55:59] <mcpherrin> I kinda want to bail out of networks for a while
[05:56:02] <mcpherrin> all this crap is crap ;p
[05:56:06] <bascule> hahaha
[05:56:08] <bascule> yeah
[05:56:28] <bascule> all of our latest moves are like... replace "hardware" (i.e. linux or freebsd in a shiny box) with software
[05:56:39] <mcpherrin> and nobody takes security seriously at all :|
[05:56:45] <bascule> lololol indeed!
[05:56:58] <mcpherrin> always a "we'll tack security on in a v2" kinda thing
[05:57:04] <mcpherrin> which of course half-ass happens later
[05:57:39] <bascule> the way we handle AuthN now is fuck TACACS+ or anything else, we have a centralized configuration deployer that can talk to all of our devices and grabs SSH keys from our central registry app and blasts them out to all the devices
[05:58:02] <bascule> don't worry about security, we'll add it later. it will be ok
[05:58:10] <bascule> that always works out great
[05:58:14] <bascule> just check out... the web
[05:58:19] <mcpherrin> bascule: replace "hardware", aka going office space on an F5?
[05:58:26] <bascule> mcpherrin: lolololol
[05:58:33] <bascule> literally remade the same image
[05:58:36] <bascule> I made like a year ago
[05:58:55] <mcpherrin> bascule: haha yeah I saw the image ;)
[05:59:28] <bascule> https://i.imgur.com/XCTDZJp.jpg
[06:00:02] *** Quits: _neal_ (neal@moz-of66u9.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[06:00:11] <Ilari> bascule: As note, the CFRG chairs list was changed on July 12th.
[06:00:31] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[06:00:44] <bascule> like, this day? https://twitter.com/bascule/status/620286380325744640
[06:00:46] <bascule> heh
[06:05:14] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:12:06] *** Joins: tomlikestorock (tomlikestor@moz-i312q9.ca.comcast.net)
[06:17:47] <eternaleye> bascule: Clearly, we should all just use MPLS over unswitched point-to-point Ethernet links :>
[06:18:07] <mcpherrin> eternaleye: nah vxlan and EVPN are the new hotness
[06:18:18] <bascule> lulz
[06:18:19] <mcpherrin> PBB-EVPN
[06:18:31] <eternaleye> mcpherrin: I thought it was GENEVE that was cool now?
[06:18:48] <bascule> eternaleye: replacing spanning tree with OSPF at least is nice
[06:18:48] <eternaleye> mcpherrin: (also, I've looked at vxlan. It's pretty icky IMO)
[06:18:58] <eternaleye> bascule: Too bad OSPF doesn't scale
[06:19:02] <bascule> zomg now you can utilize all your links
[06:19:04] <bascule> amazeballs
[06:19:05] <eternaleye> bascule: Babel ain't bad
[06:19:09] <mcpherrin> eternaleye: I was on the Vxlan team at Arista ;)
[06:19:11] <bascule> well spanning tree doesn't exactly scale either lol
[06:19:27] <bascule> especially the one fuckup destroys everything problem
[06:19:29] <mcpherrin> eternaleye: it's not so bad if what you need is L2 over a L3 clos network
[06:19:49] <eternaleye> bascule: Spanning Tree wastes hardware resources it could utilize; OSPF overloads hardware it shouldn't be utilizing to that degree
[06:20:14] <bascule> eternaleye: spanning tree is like a ticking time bomb waiting to cause a broadcast storm
[06:20:30] <eternaleye> bascule: (Specifically, it tries too hard for optimal routes considering the problem, which burns far more CPU and memory than is warranted)
[06:20:32] <mcpherrin> bascule: that's what Storm Control on your switches is for, though
[06:20:37] <eternaleye> bascule: Babel picks a better tradeoff
[06:20:54] <mcpherrin> What I want is a simplified routing protocol for ECMP (ie, folded clos) networks
[06:21:06] <eternaleye> https://en.wikipedia.org/wiki/Babel_%28protocol%29
[06:21:18] <mcpherrin> the hodge podge of bgp and isis and ospf people use to run their datacenters sucks
[06:21:28] <mcpherrin> big cloud people are already doing this proprietarily
[06:21:54] <bascule> our initial use of (probaly) Quagga will probably be for external TLS termination
[06:21:59] <eternaleye> There's also batman-adv, but I dunno how effective that is in practice
[06:22:11] <eternaleye> (OTOH, it's upstream in Linux, so...)
[06:22:19] <mcpherrin> hahaha batman
[06:22:28] <mcpherrin> Sure, it's in linux...
[06:22:36] <eternaleye> mcpherrin: Shorten the tails on your n's :P
[06:22:43] <mcpherrin> nananannana
[06:23:36] <mcpherrin> batman being in kernel is weird.
[06:23:40] <eternaleye> Anyway, Babel has a good track record on efficiency and convergence time, plus it works for both ipv4 and ipv6
[06:25:07] <mcpherrin> I see some stuff online about babel reconvergence taking "seconds"
[06:25:13] <mcpherrin> which does not seem nice
[06:25:34] <eternaleye> mcpherrin: Are you looking at wired, or large wireless mesh?
[06:25:42] <mcpherrin> eternaleye: wired
[06:25:43] <eternaleye> mcpherrin: Because a lot of the hype on it is for the latter...
[06:25:58] <mcpherrin> large wireless meshes are mostly a fool's errand anyways
[06:26:24] <eternaleye> Agreed
[06:26:59] <mcpherrin> eternaleye: Some absurdly high portion of my coworkers have worked for a failed mesh network startup ;p
[06:27:02] <eternaleye> mcpherrin: Also, babel tends to use two different forms of "convergence"
[06:27:03] <mcpherrin> at one time or another
[06:27:18] <eternaleye> mcpherrin: Converging to correctness, and then converging to optimality
[06:27:30] <eternaleye> mcpherrin: The former is supposed to be very rapid, the latter is on the order of minutes
[06:28:20] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[06:28:24] <eternaleye> mcpherrin: See also, https://tools.ietf.org/html/rfc6126#section-1.1
[06:28:24] <mcpherrin> eternaleye: yeah, the latter is what most people talk about when measuring routing algorithm convergence
[06:28:40] <eternaleye> Mm
[06:29:06] <eternaleye> Personally, I like the separation - I'd take a hit to the latter in exchange for accelerating the former, for example
[06:29:07] *** Quits: c74d (c74d3a4ebb6@moz-hhitpj.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[06:29:24] <mcpherrin> Eg, we measure it as time from a network change happening (link up, etc) to the final routing table change
[06:29:32] <mcpherrin> but like, that time is goal under 1 second
[06:29:39] <mcpherrin> and you should never misroute
[06:29:47] <mcpherrin> so 0 / 1 second is better than rapid / minutes ;p
[06:29:52] *** c74d3 is now known as c74d
[06:30:05] <eternaleye> mcpherrin: Well, "rapid" might be that, I don't have a big enough datacenter to have tested :P
[06:30:12] <mcpherrin> :)
[06:30:18] <mcpherrin> simulation!
[06:30:34] <eternaleye> mcpherrin: I don't have enough _time_ for that one!
[06:30:43] <eternaleye> mcpherrin: 8-person startups are a bitch on the free time :P
[06:30:48] <mcpherrin> haha yeah
[06:31:04] <eternaleye> Especially when it's not about networking
[06:31:22] <mcpherrin> if you need a real network to test your code, you're doing it wrong :P
[06:31:35] <mcpherrin> The iteration time will kill you
[06:31:41] <eternaleye> mcpherrin: Not my code, just something I read about for fun :P
[06:31:53] <eternaleye> (Spoilers: I read about almost everything for fun)
[06:31:58] <mcpherrin> :)
[06:32:14] <mcpherrin> routing loops aren't so bad because we have TTL decrement and drop
[06:32:31] <mcpherrin> stp failures are much worse because ou get packets flopping all over
[06:33:24] <eternaleye> I still like Babel's hard constraints on routing loops
[06:33:37] <mcpherrin> yeah
[06:33:54] <mcpherrin> I'll have to give it a try sometime
[06:33:56] <eternaleye> Never when prefixes are singly advertised; healed in time proportional to diameter otherwise (and _kept dead_ until the nodes forget it happened)
[06:34:02] <mcpherrin> see how well it handles 10M hosts or so
[06:34:17] <mcpherrin> 1M prefixes
[06:35:22] <eternaleye> I will note the RFC is a bit old
[06:35:40] <eternaleye> It's advanced a bit since then
[06:36:45] <eternaleye> https://github.com/jech/babeld seems to be the most current repo
[06:37:41] <eternaleye> Huh, it has a mode for routing on overlay networks
[06:37:43] <eternaleye> Shiny
[06:38:37] <eternaleye> >> The standard implementation of Babel compiles to 90kB of text on AMD64. There is a minimalistic, stub-only implementation of Babel that compiles to 12kB of text. 
[06:38:39] <eternaleye> Holy crap
[06:39:26] <mcpherrin> routing on overlays is useful since nobody will use it for anything else ;p
[06:39:52] <bascule> https://github.com/alex/rust-asn1
[06:39:53] <bascule> heh
[06:41:07] <eternaleye> Hahahahaha: https://tools.ietf.org/html/draft-chroboczek-babel-doesnt-care-00
[06:41:19] <eternaleye> >> Where we claim that, unlike typical IGPs, the Babel routing protocol just doesn't care.
[06:44:36] <eternaleye> They should rename it the Honey Badger Routing Protocol :P
[06:49:16] <Ilari> Wonder what other mistakes there are in the DJB signatures demo code besides the one I found...
[07:01:17] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[07:06:00] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[07:24:58] <eternaleye> mcpherrin: Huh, this might actually be more relevant to your use cases: https://tools.ietf.org/html/draft-sl-rtgwg-far-dcn-03
[07:25:06] <eternaleye> >> Generic Fault-avoidance Routing Protocol for Data Center Networks
[07:25:55] <mcpherrin> eternaleye: hmm, maybe
[07:26:46] <eternaleye> mcpherrin: It seems like the rtgwg is focusing on datacenter stuff more than it used to
[07:26:52] <eternaleye> https://datatracker.ietf.org/wg/rtgwg/documents/
[07:29:52] <mcpherrin> eternaleye: yeah, a bunch of those have my employer's name on them ;)
[07:30:23] <mcpherrin> and so have the concerns I have :)
[07:33:04] <eternaleye> Huh: https://datatracker.ietf.org/wg/arcmedia/charter/
[07:34:55] <eternaleye> Wonder how that'll go over with things that match mimetypes for application/x-tar and such currently...
[07:39:45] <eternaleye> mcpherrin: And it looks like the nvo3 WG is going for Geneve rather than VXLAN, looking at the active WG drafts: https://datatracker.ietf.org/wg/nvo3/documents/
[08:16:54] *** Quits: tomlikestorock (tomlikestor@moz-i312q9.ca.comcast.net) (Client exited)
[08:30:10] <mcpherrin> what drafts the IETF are working on is pretty independent from what people are deploying :)
[08:49:29] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[08:54:07] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[08:58:16] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[09:09:46] *** Joins: vks (quassel@moz-b54qc9.fias.uni-frankfurt.de)
[09:28:46] *** Joins: dcb_ (textual@moz-v6l3du.ca.comcast.net)
[09:28:47] *** Quits: dcb_ (textual@moz-v6l3du.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[09:46:34] *** Joins: dcb (dcb@moz-hkcots.idtl.bddv.0645.2601.IP)
[09:49:54] *** Quits: dcb (dcb@moz-hkcots.idtl.bddv.0645.2601.IP) (Quit: dcb quit)
[09:50:14] *** Joins: dcb (dcb@moz-v6l3du.ca.comcast.net)
[10:37:44] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[10:42:27] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[11:14:39] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[12:07:21] *** Joins: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe)
[12:08:09] <Tiffany> well.. the only way I can get znc is to connect without TLS
[12:08:27] <Elaine> what issues are you having?
[12:08:36] <Tiffany> [07:39] <*status> Disconnected from IRC (error:140940E5:SSL routines:ssl3_read_bytes:ssl handshake failure). Reconnecting...
[12:08:38] <Elaine> I use znc + tls on all the networks I use
[12:08:49] <Tiffany> it's been doing that since I restarted znc
[12:08:56] <Tiffany> I suspect it's because of an openssl version update
[12:09:28] <Ilari> Tiffany: Can you dump what the heck ZNC is sending in the handshake?
[12:09:40] <Tiffany> I don't know how to, if it's possible
[12:09:58] <Tiffany> I can connect using openssl s_client just fine
[12:10:48] <Ilari> Tiffany: Well, since TLS 1.3 isn't out yet, the relevant stuff is likely plaintext.
[12:13:33] *** Quits: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe) (Quit: ZNC - http://znc.in)
[12:14:26] *** Joins: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe)
[12:15:23] *** Quits: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe) (Quit: ZNC - http://znc.in)
[12:23:30] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[12:26:15] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[12:27:40] *** Joins: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe)
[12:27:59] <Tiffany> http://sprunge.us/RVZK
[12:28:10] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[12:28:26] <Tiffany> did that go through? http://sprunge.us/RVZK
[12:28:45] <Elaine> yeah
[12:29:19] <Tiffany> I can't really get any more out of it without setting some kind of TLS mitm...
[12:31:05] <Ilari> Tiffany: You can't just dump raw TCP stream (the interesting data might be cleartext)?
[12:31:15] <Tiffany> how?
[12:31:49] <Ilari> Tiffany: Especially things like client version, ciphersuite list and extensions from ClientHello.
[12:32:20] <Tiffany> I know there's tools like wireshark, but wireshark is a GUI application..
[12:32:29] <Tiffany> this is a headless debian VPS
[12:33:54] <Tiffany> bascule: how do you implement chat on an immutable file store?
[12:34:54] <Ilari> Tiffany: tcpdump can take a dump file that can be analyzed using wireshark (that's how I do dumps, since I can't run Wireshark as root).
[12:35:03] <Tiffany> oh
[12:36:09] <Ilari> Tiffany: Could be that ZNC does something with OpenSSL that causes it to send some pretty crazy ClientHello, which server either chokes on, or rejects as too insecure.
[12:49:34] <Ilari> Tiffany: Unless it is renegotiation (which shouldn't happen) whatever the data server barfs on is in plaintext, or can easily be guessed.
[13:21:32] <Ilari> By "easily guessed", I mean things like Finished check going wrong.
[13:35:47] <Tiffany> it would be nice if there was a built in base16 encode/decode in the stdlib
[14:07:53] <Tiffany> wow this is getting annoying
[14:08:00] <Tiffany> rustc_serialize only implements from_hex on str
[14:11:36] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[14:16:21] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[14:26:40] <Tiffany> so I have a kind of awkward to use command-line tool for noise boxes working
[14:32:13] <Tiffany> http://sprunge.us/NHFi
[14:35:43] <Tiffany> I should probably replace some of these options with proper commands
[14:35:49] <Tiffany> susurrus box, susurrus unbox, susurrus keygen
[14:36:04] *** Joins: _neal_ (neal@moz-of66u9.ca.comcast.net)
[14:48:30] <Ilari> Hah: "This would be somewhat easier if we had a la carte negotiation"
[14:53:04] <eternaleye> Michael StJohns' new draft looks... "interesting"
[14:55:54] <Ilari> eternaleye: Yeah, the stuff from him is usually... "interesting".
[14:57:26] <Ilari> eternaleye: Especially if he is trying to "fix" attacks that just can't work with methods that are unconventional to say the least.
[14:58:12] <eternaleye> Ilari: Voodoo solutions to banana attacks.
[14:59:25] <Tiffany> is there a way to match against Option<String>?
[14:59:51] <Elaine> you can match foo.map(|s| &*s) I think
[15:00:03] <Tiffany> that's pretty ugly but okay
[15:00:43] <Tiffany> it doesn't live long enough, apparently
[15:01:12] <Ilari> Tiffany: Or Some(x) => ..., None => ...   ?
[15:01:38] <Tiffany> ilari: I get an error about mismatched types with String and &'static str
[15:02:44] <Tiffany> src/bin/susurrus.rs:160:43: 160:44 error: `s` does not live long enough
[15:03:03] <Ilari> Tiffany: Or you might do Some(ref x) => ... instead.
[15:03:10] *** Quits: _neal_ (neal@moz-of66u9.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:04:08] <Tiffany> I found a way around it
[15:05:34] <Ilari> Tiffany: What are you trying to do anyway?
[15:05:51] <Tiffany> I'm working on the cli tool for my noise implementation
[15:11:17] *** Quits: Tiffany (tiffany@moz-6q5ofr.lyrical.lymia.moe) (Quit: ZNC - http://znc.in)
[15:13:26] *** Joins: Tiffany (tiffany@moz-5vj.q69.88.23.IP)
[15:22:31] <Ilari> "Unfortunately certificates are not made out of text"
[15:34:42] <Elaine> "WCF now supports SSL version TLS 1.1 and TLS 1.2, in addition to SSL 3.0 and TLS 1.0, when using NetTcp with transport security and client authentication. It is now possible to select which protocol to use, or to disable old less secure protocols"
[15:34:52] <Elaine> as of .net 4.6
[15:34:57] <Elaine> (released today)
[15:38:36] <Ilari> It got TLS 1.2 support today?
[15:38:59] <Elaine> yup
[15:39:44] <Elaine> now, to be fair, I'm not sure who actually uses WCF.
[15:39:47] <Elaine> but ouch.
[15:40:06] <Ilari> Wonder what its capabilities are (ciphersuites and extensions).
[15:41:06] <Tiffany> having certificates be text-based sounds like a recipe for incorrect implementations
[15:41:21] <Elaine> and ASN.1 isn't? :D
[15:41:44] <Tiffany> I don't know the details of ASN.1
[15:42:45] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[15:44:19] <Tiffany> I guess it depends on the format
[15:44:34] <Tiffany> I assumed that text-based X.509 would be bastardized XML or worse
[15:44:44] <Tiffany> you know, like HTML
[15:44:49] <Tiffany> but for certificates
[15:46:09] <Ilari> Tiffany: You know what, there is such thing. :-)
[15:46:14] <Tiffany> although I suppose certificates are generally not written by hand
[15:46:21] <Tiffany> and yeah, there is the XML-based ASN.1 format
[15:46:30] <Tiffany> X.509 certs are fortunately usually encoded in DER
[15:46:51] <Ilari> I think it is requirement of using DER (but there are many broken certs that are BER).
[15:47:55] <Ilari> Lol, the speaker on this presentation says "yo" really often.
[15:49:58] <Tiffany> good old XER
[15:51:33] <Tiffany> lol what
[15:51:40] <Tiffany> why did the ITU define BER and DER in the same standard?
[15:51:45] <Tiffany> why not define only DER?
[15:52:13] <Ilari> Tiffany: DER needs lengths beforehand.
[16:04:33] <Ilari> Pfft... This site is not accepting 16-char alphanum password password generator I have generates.
[16:05:43] <Ilari> Well, I just append some crap symbols.
[16:09:23] <Tiffany> BER lengths are overcomplicated...
[16:15:45] <eternaleye> What I don't get is why BER, DER, and CER all exist.
[16:15:52] <eternaleye> I can understand having two of the three.
[16:16:44] <Ilari> What was CER again?
[16:20:21] <Tiffany> it does the same thing as DER but... differently?
[16:24:21] <Tiffany> CER is less limited than DER
[16:24:41] <Tiffany> but presumably stays canonical somehow
[16:24:43] <eternaleye> While DER always uses the definite length form, CER (Canonical Encoding Rules) always uses the indefinite length form.
[16:24:48] <eternaleye> That's the big one.
[16:25:23] <eternaleye> So CER can be used for streaming/unknown-length use cases
[16:26:42] <eternaleye> https://en.wikipedia.org/wiki/X.690#BER.2C_CER_and_DER_compared
[16:29:35] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[16:33:56] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[16:37:00] *** Joins: skeuomorf (skeuomorf@moz-3tn.2md.32.197.IP)
[16:38:49] <Tiffany> http://arstechnica.com/security/2015/07/fiat-chrysler-connected-car-bug-lets-hackers-take-over-jeep-remotely/
[16:42:10] *** Joins: tomlikestorock (tomlikestor@moz-i312q9.ca.comcast.net)
[16:43:06] <Ilari> Pretty scary. And probably that car is so "advanced" it has no unonverridable shutdown.
[16:46:13] *** Quits: tomlikestorock (tomlikestor@moz-i312q9.ca.comcast.net) (Ping timeout: 121 seconds)
[16:54:22] *** Joins: dcb_ (dcb@moz-4hh.6p3.217.74.IP)
[16:54:43] *** Quits: dcb_ (dcb@moz-4hh.6p3.217.74.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:54:47] *** Quits: vks (quassel@moz-b54qc9.fias.uni-frankfurt.de) (Ping timeout: 121 seconds)
[16:56:54] <Ilari> In older cars, there is ignition lock cylinder. Override that.
[17:04:51] <Ilari> "I've read a few attorneys' periodicals warming up trial lawyers for IoT product liability"
[17:06:53] <Tiffany> I can't wait for all this IoT stuff gets hits with lawsuits
[17:07:00] <Tiffany> security needs to be taken seriously
[17:08:53] <Ilari> There are lots of places in computer security that could use some lawsuits...
[17:14:09] <Tiffany> also, I finished reading that article on distributed systems someone linked
[17:14:14] <Tiffany> saw a thing about mongodb
[17:14:16] <Tiffany> remembered about this
[17:14:17] <Tiffany> https://github.com/mongodb/mongo-java-driver/blob/1d2e6faa80aeb5287a26d0348f18f4b51d566759/src/main/com/mongodb/ConnectionStatus.java#L213
[17:26:25] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[17:27:45] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[17:28:47] *** Joins: NewUserIrcChat (NewUserIrc@moz-378f17.fbx.proxad.net)
[17:30:37] *** Joins: tomlikestorock (tomlikestor@moz-rjs7c5.static.sonic.net)
[17:36:14] <bascule> lol MongoDB
[17:36:20] <bascule> Ilari: hahaha
[17:36:27] <bascule> Tiffany: that phrase :(
[17:37:15] <Elaine> wat
[17:37:16] <Tiffany> what phrase?
[17:39:02] <NewUserIrcChat> HEllo
[17:39:04] <Elaine> Tiffany: is that supposed to do something sane?
[17:39:10] <bascule> "security needs to be taken seriously"
[17:39:23] <Tiffany> elaine: it appears to drop 90% of exceptions
[17:39:35] <bascule> Tiffany: https://twitter.com/bascule/status/572449089645772801
[17:40:04] <Ilari> NewUserIrcChat: Hi.
[17:40:19] <bascule> lol
[17:40:22] <bascule> that's quite the nickname
[17:41:31] <NewUserIrcChat> Are u dealing with cryptographic? Digest etc ...
[17:43:33] <Tiffany> oh
[17:43:40] <Tiffany> you're opposed to the phrase because it doesn't actually say anything, right?
[17:44:12] <Tiffany> like, taking something seriously can mean whatever the marketing department wants
[17:44:15] <Tiffany> which is usually nothing
[17:44:49] <Ilari> NewUserIrcChat: Especially anything crypto programmed in Rust. :->
[17:45:04] <Ilari> NewUserIrcChat: (At least even remotely good crypto).
[17:45:11] <Tiffany> as opposed to something more concrete like "We pay $respected_security_consultancy_firm to audit our source code, and fix security vulnerabilities as quickly as possible"
[17:46:23] <Tiffany> I think that's what I want
[17:46:37] <Tiffany> I don't trust these companies to get security right
[17:46:44] <Tiffany> so they should get someone else who can to do it
[17:49:42] <Ilari> Session Key Interface (one TLS WG presentation)... Too bad it deals with RSA key exchange. Would be more secure if it didn't.
[17:57:08] *** Joins: vks (quassel@moz-l5qmbl.pools.vodafone-ip.de)
[18:03:56] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[18:07:10] <Ilari> "and also select some Weierstrass representation for Curve25519, which generally seems to an unpopular approach."
[18:11:49] <eternaleye> Gee, I wonder why.
[18:14:07] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Connection closed)
[18:17:56] <bascule> hahahaha
[18:18:01] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[18:21:03] <Ilari> Also, I get bad flashbacks from implementing ECDSA using Curve25519.
[18:23:28] <bascule> haha oh god
[18:26:39] <Ilari> It is not just dealing with 19th century curve presentations, but also special cases Curve25519 triggers (and some of those aren't clear to me).
[18:28:40] <Ilari> I ended up using isogenies to transform those to something I could actually write code to work with.
[18:34:40] <bascule> really did feel like "one of these things is not like the others, one of these things just doesn't belong"
[18:34:43] <bascule> heh
[18:43:55] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[18:57:30] *** Quits: NewUserIrcChat (NewUserIrc@moz-378f17.fbx.proxad.net) (Quit: )
[19:00:55] <Tiffany> how should I model the noise handshake?
[19:04:29] <Tiffany> I guess I need a FSM
[19:05:02] <Tiffany> but it's weird since I need to be able to act as both server and client
[19:05:05] <Tiffany> should I just duplicate that code?
[19:05:08] <Tiffany> I don't know what to do
[19:06:27] <Tiffany> this isn't even the difficult case, this is the single-rtt handshakeNN case
[19:09:05] <Elaine> I was under the impression that you had written an interpreter for descriptors that did the right thing.
[19:09:19] <Tiffany> I wrote an interpreter for the descriptors of a single message
[19:09:22] <Tiffany> not the whole flow
[19:09:23] <Elaine> oh
[19:09:48] <Tiffany> hm
[19:09:51] <Tiffany> I think I might have a way?
[19:17:56] <Tiffany> how do you return an &'static[Foo]?
[19:19:32] <Elaine> like that?
[19:19:40] <Tiffany> I get a syntax error
[19:19:41] <Elaine> you obviously have to have a &'static [Foo] to start with
[19:19:49] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Ping timeout: 121 seconds)
[19:19:54] <Elaine> that's the type, the lifetime won't show up in an expression
[19:19:58] <Elaine> just &[a, b, c]
[19:20:02] *** Joins: skeuomor1 (skeuomorf@moz-mrf.u8d.32.197.IP)
[19:20:10] <Tiffany> that gives a lifetime error
[19:20:54] <Tiffany> what I'm trying to do is return a static array sliced based on an index
[19:21:06] <Elaine> mm, I guess you need to store it in a const or something
[19:21:20] <Tiffany> I'm trying to use a static, but it keeps giving errors
[19:21:26] <Tiffany> it seems very insistent on being fixed-size
[19:21:40] <Tiffany> so I'm getting an error that it expects an array of length 1 when I'm giving it an array of length 2
[19:21:52] <Tiffany> is there no such thing as a static slice?
[19:22:12] <Elaine> https://play.rust-lang.org/?gist=ff64c56a0b32f99f781e&version=stable
[19:22:40] *** Quits: skeuomorf (skeuomorf@moz-3tn.2md.32.197.IP) (Ping timeout: 121 seconds)
[19:22:42] <Tiffany> I'm trying to make a &'static [&'static [Descriptor]]
[19:23:33] <Elaine> https://play.rust-lang.org/?gist=50aa7a31aa1e7d1acefd&version=stable
[19:24:12] <Tiffany> almost there..
[19:24:25] <Tiffany> can a static be put somewhere that doesn't pollute the module scope?
[19:24:31] <Tiffany> I know it can't be put inside an impl
[19:24:39] <Elaine> it can be inside a function
[19:32:07] <Ilari> Hmm... Haven't seen presentation about DJB&co proposal (all the others are in).
[19:43:51] <Tiffany> I seem to have handshakeNN working
[19:51:07] *** Joins: LinuxBunny (Retep998@moz-vlal7g.east.verizon.net)
[19:55:04] *** Quits: WindowsBunny (Peter@moz-vlal7g.east.verizon.net) (Quit: Leaving.)
[20:01:33] <Ilari> "This could also be applied to some actual ciphersuite stuff, namely ARIA and CAMELLIA (there doesn't seem to be any usable SEED ciphers)." "I would be comfortable with taking a hard look at these."
[20:06:41] *** skeuomor1 is now known as skeuomorf
[20:07:31] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[20:15:14] <Ilari> Also, in last TLS WG meeting, someone said something about doing nasty things to persons responsible for EXPORT suites in TLS.
[20:19:29] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[20:24:55] <Ilari> Also, haha, the server involved in provoding the patches for the carhacking flaw is vulernable to FREAK, POODLE and POODLE TLS.
[20:25:15] <Elaine> of course it is
[20:37:57] <Tiffany> incredible
[21:02:07] <Ilari> Deserves F tho (no really serious flaws). There are other things, like only supporting RSA key exchange.
[21:17:12] <Ilari> And none of POODLE, POODLE TLS, HEARTBLEED, EARLYCCS, FREAK nor LOGJAM qualify as really serious.
[21:20:14] <Tiffany> what?
[21:21:31] <Ilari> Yes, each is serious and screws security of site pretty nicely, but not serious enough to be a menance.
[21:37:33] *** Quits: vks (quassel@moz-l5qmbl.pools.vodafone-ip.de) (A TLS packet with unexpected length was received.)
[21:42:33] <Tiffany> what do you mean a menace?
[21:45:15] <eternaleye> This is why we need capability systems: https://www.sektioneins.de/en/blog/15-07-07-dyld_print_to_file_lpe.html
[21:45:26] <eternaleye> Classic confused deputy
[21:45:46] *** Quits: mcpherrin (mcpherrin@moz-bhcp6n.8mb6.t84e.0645.2601.IP) (A TLS packet with unexpected length was received.)
[21:45:56] <Tiffany> lol yeah
[21:45:57] <Elaine> eternaleye: this is why we *have* capability systems ;)
[21:46:00] <Elaine> it's a shame they aren't used.
[21:46:55] <Tiffany> it seems kind of hard to implement POSIX on top of capabilities though
[21:47:03] <Tiffany> without just requesting a bucket full of privileges off the bat
[21:47:05] <Elaine> so don't do that
[21:47:11] <Elaine> POSIX is legacy.
[21:47:14] <Tiffany> yeah
[21:47:43] <eternaleye> Tiffany: Yes, if you want POSIX, you need a bunch of caps in each POSIX-using process
[21:47:55] <Tiffany> I guess that's not so bad
[21:47:59] <eternaleye> Tiffany: The thing is that you _can_ have each posix-using process have _different_ caps
[21:48:06] <Tiffany> the real trouble is actually using the capabilities to prevent the confused deputy problem
[21:48:13] <eternaleye> Tiffany: Per-process containerization, basically
[21:48:36] <Tiffany> changing up daemons and stuff
[21:48:43] <eternaleye> Oh sure
[21:49:09] <Tiffany> which means extending posix in weird ways
[21:49:22] <eternaleye> Not necessarily.
[21:49:22] <Tiffany> like adding 'openas' and similar alternatives, which take a capability
[21:49:29] <Tiffany> really?
[21:49:44] <eternaleye> It depends on what components you need to run inside the posix-compliant environment.
[21:50:02] <Elaine> and which components need to interact.
[21:50:21] <eternaleye> Also, if you do per-process isolation, then each "posix environment" is just a capabilities-level task
[21:50:48] <Tiffany> oh
[21:50:59] <Tiffany> you could pass the entire posix environment for a process as a capability
[21:51:18] <eternaleye> You give it something that acts like a wayland display, say, but is actually just a translator over an isolated "window" cap
[21:51:35] <eternaleye> (though the wayland protocol is pretty amenable to caps already)
[21:52:42] <eternaleye> Tiffany: More that you could spawn an entire posix environment for _each_ process, and passthrough some things in-place-of daemons that would otherwise run within
[21:53:07] <eternaleye> Tiffany: Just like how some people do containerization, but give the container access to some other container's postgresql socket
[21:53:12] <Tiffany> oh
[21:53:44] <eternaleye> Capabilities make _really_ aggressive containerization surprisingly feasibly
[21:53:47] <eternaleye> *feasible
[21:53:59] <Tiffany> yeah
[21:55:02] <Elaine> I tried to approximate a very strict setup with grsec and rbac, it worked decently well.
[21:55:30] <eternaleye> There's a thing using kvm-tool to do the same kind of thing
[21:55:46] <eternaleye> (since Linux's actual LXC containers don't have quite strong enough isolation yet)
[21:56:36] <eternaleye> https://lwn.net/Articles/644675/
[21:56:54] <Elaine> right now my setup is a grsec-hardened VM host running X (lol) that I use to ssh into VMs.
[21:56:57] <eternaleye> >> To provide a preview of the results: we can launch such a secured container that uses virtualization technology in under 150 milliseconds, and the per-container memory overhead is roughly 18 to 20MB (this means you can run over 3500 of these on a server with 128GB of RAM). While this is not quite as fast as the fastest Docker startup using kernel namespaces, for many applications this is likely going to be good enough. And we aren't 
[21:56:58] <eternaleye> finished optimizing yet. 
[21:57:34] <Elaine> one for irc/other chat, one for development (which often involves running untrusted code).
[21:57:45] <Elaine> I used to have one for my browser but I got sick of the latency.
[22:00:44] <eternaleye> Elaine: You've looked at Qubes, I take it?
[22:00:45] *** Joins: mcpherrin (mcpherrin@moz-bhcp6n.8mb6.t84e.0645.2601.IP)
[22:01:44] <Elaine> I did but I didn't really like its architecture.
[22:02:05] <Elaine> plus I don't want to use fedora :P
[22:03:01] <Elaine> my setup is "good enough", not watertight
[22:03:41] <eternaleye> One thing I'd really like is if Capsicum made it into Linux
[22:04:02] <Elaine> I'm building something up on top of seL4.
[22:04:14] <eternaleye> Nice!
[22:04:22] <Elaine> and lowRISC
[22:04:29] <Elaine> mostly in my head right now
[22:04:44] <Tiffany> I've been working towards building a thing
[22:05:47] <Tiffany> it's not really an OS, and I'm probably going to be building it on top of linux
[22:06:58] <Elaine> I don't think linux is trustworthy, nor most (all? hard to say) PC platforms.
[22:07:29] <Tiffany> linux has the benefit that I'm already running linux
[22:07:39] <Tiffany> I thought about using seL4 but I'm not sure I want to use its style of IPC
[22:07:50] <Tiffany> maybe I should just go with it
[22:12:11] <eternaleye> Tiffany: One thing I'm doing is designing both the library API and the underlying ABI, and making it so the library API will work in both a "dev mode" under Linux _and_ on the real system with the ABI.
[22:12:33] <Tiffany> yeah
[22:12:46] <Tiffany> running on both is pretty desirable
[22:13:04] <eternaleye> SyncSender is very close to the ABI guarantees I want, so rust threads are a very solid first approximation.
[22:14:31] <eternaleye> I'm also looking at implementing "drivers" by having the "kernel" export a memory range where each host syscall can be accessed by writing to specific offsets and reading back.
[22:14:49] <eternaleye> So the host read() and write() syscalls kind of act like DMA
[22:14:55] <eternaleye> etc
[22:15:20] *** Quits: cmn (cmn@moz-r1h.buc.47.78.IP) (Ping timeout: 121 seconds)
[22:17:22] *** Joins: cmn (cmn@moz-r1h.buc.47.78.IP)
[22:18:25] <Tiffany> eh.. I guess seL4's IPC isn't so bad
[22:18:37] <Tiffany> I just get put off at synchronous IO
[22:24:28] <Tiffany> it's not waiting on a reply or anything at least
[22:24:34] <Tiffany> it just blocks until the message is delivered one-way
[22:26:36] <bascule> hahaha
[22:26:44] <bascule> synchronous I/O is nice if you want low latency ;)
[22:27:26] <bascule> it really comes down to both synchronous and asynchronous I/O both having their pros and cons and both being needed in different scenarios
[22:27:37] <bascule> and anything trying to force a single model on you (node) is doing it wrong
[22:27:49] <eternaleye> Tiffany: Async IO can be built on sync IO trivially if you have the ability to share memory with threads.
[22:28:03] * bascule likes the other way around :o
[22:28:07] <eternaleye> Tiffany: Just instantiate a queue to a thread and let _it_ block while it works through the queue
[22:28:34] <eternaleye> bascule: To clarify: Do you mean async as in buffering, or async as in nonblocking?
[22:28:35] <bascule> was actually talking to pcwalton about this stuff
[22:28:56] <bascule> eternaleye: I'm talking about composing things in terms of CapTP-style event loops (per vat)
[22:29:02] <eternaleye> bascule: Mm
[22:29:03] <bascule> but still exposing a synchronous API
[22:29:13] <bascule> and also not hiding the suspend points
[22:29:44] <bascule> if you can do all of those things, you can get out of callback/promise hell, but still do deterministic testing of concurrent systems
[22:29:48] <eternaleye> bascule: And see, I'm saying more "You have a way of shoving bytes across to some other domain. Does it buffer, block, or fail if the other side is not ready?"
[22:30:04] <eternaleye> bascule: The layer _underneath_ such stuff
[22:30:18] <bascule> it eagerly attempts a send. if that fails, it reschedules the send for when the I/O handle in question is available for writing
[22:30:47] <Tiffany> I've never actually used node but I guess I have fallen into that mindset...
[22:30:49] <eternaleye> bascule: The last then, "nonblocking", is the _primitive_ required to build the _api_ you prefer.
[22:30:59] <bascule> eternaleye: you sure like being pedantic, don't you?
[22:31:01] <eternaleye> bascule: You're talking APIs, and I'm talking the ABI it's built on
[22:31:07] <eternaleye> bascule: They have very different tradeoffs
[22:31:26] <bascule> I have absolutely no idea what you're even talking about, and I've been writing this sort of I/O plumbing for like, gosh
[22:31:29] <bascule> 18 years?
[22:31:32] <Tiffany> I've found that promises can be a pain, but I don't like needing threadspam, and I especially don't like it being impossible to implement IRC like rust's tcp stuff used to be like
[22:31:43] <eternaleye> bascule: I'm talking about how the IO primitives the kernel provides should work
[22:32:02] <eternaleye> bascule: The raw syscall behavior
[22:32:10] <bascule> eternaleye: you should statefully register the interests you have about a particular I/O object with the kernel
[22:32:30] <eternaleye> bascule: That's pretty microkernel-hostile...
[22:32:34] <bascule> something like this: https://github.com/tarcieri/hotwired/blob/master/Multiplexer.kqueue.c
[22:32:38] *** Quits: atomic (atomic@moz-n481t9.squirrel.theremailer.net) (Ping timeout: 121 seconds)
[22:32:40] <bascule> that code is 15 years old, FYI
[22:32:50] <bascule> it doesn't support epoll because at the time I wrote it, epoll didn't exist
[22:33:05] <Tiffany> aw
[22:33:14] <Tiffany> initial import, rather than real history
[22:33:18] <bascule> :(
[22:33:26] <bascule> I found it on SourceForge
[22:33:37] <bascule> at the time I was writing it I wasn't using any sort of version control
[22:33:46] <Tiffany> what is it?
[22:34:10] <bascule> a Hotline server
[22:34:17] <Tiffany> hotline?
[22:34:21] <bascule> indeed
[22:34:34] <eternaleye> bascule: Anyway, the way I see it is that the kernel really needs to provide four primitives: send+block, send+fail-fast, recv+block, recv+fail-fast
[22:34:35] <bascule> a relic of the past
[22:34:44] <bascule> eternaleye: what about multiplexing?
[22:35:18] <eternaleye> bascule: If you have threads, you can build multiplexing on top - and in an aggressive microkernel, you can make the cost of a thread very close to sizeof(register file)
[22:35:19] <Tiffany> bascule: eternaleye mentioned that you can send reply caps and then read all your replies from one socket
[22:35:39] <Tiffany> a while ago
[22:35:48] <bascule> Tiffany: promise pipelining?
[22:35:54] <Tiffany> uhh
[22:36:00] <bascule> eternaleye: okay, so if I have 1 million connections, I just use 1 million threads?
[22:36:07] <mcpherrin> eternaleye: You can boil it down to Send/Recieve/Reply
[22:36:09] <Tiffany> I think it's more like generalized epoll
[22:36:15] <mcpherrin> eternaleye: The reciever calls reply to unblock send
[22:36:17] <Tiffany> since epoll itself is a file descriptor
[22:36:23] <Tiffany> I might be misinterpreting
[22:36:35] <eternaleye> bascule: epoll-style multiplexing would need one thread per interest; IOCP-style multiplexing means sending a send-cap with each outbound op.
[22:36:55] <Tiffany> oh
[22:36:57] <bascule> eternaleye: what if I want to wait on more than one file descriptor from a single thread?
[22:37:01] <Tiffany> I always mix up epoll and IOCP
[22:37:04] <bascule> I spawn a thread per file descriptor?
[22:37:20] <bascule> eternaleye: what you're describing is enormously wasteful
[22:37:22] <mcpherrin> bascule: At least in my microkernels, Recieve() is multiplexing
[22:37:28] <eternaleye> bascule: Not if you make threads cheap.
[22:37:40] <mcpherrin> This is the basic design of QNX
[22:37:43] <eternaleye> bascule: And that's only with epoll-style readiness multiplexing
[22:37:47] <bascule> I'm all for threads, but they have limits
[22:38:07] <eternaleye> bascule: IOCP-style completion notification doesn't need that, since multiple completions can arrive on one receive-cap
[22:38:45] <bascule> eternaleye: yes I've been using IOCP since Solaris completions :P
[22:38:48] <Tiffany> that's what I was trying to mention, IOCP completion notifications using receive caps
[22:39:03] <bascule> see also: Windows ;(
[22:39:16] <eternaleye> let (a, b) = channel(), foo(a), bar(a), b.recv(), b.recv()
[22:39:28] <eternaleye> Look ma, no threads!
[22:39:56] <bascule> you need a system for multiplexing userspace messaging with system calls
[22:40:02] <eternaleye> And as I said, you can make threads _really_ cheap - cheaper than Linux' kernel-side per-fd state for epoll.
[22:40:02] <bascule> Erlang used the ioserver to do that
[22:40:26] <bascule> and "ports"
[22:40:30] <eternaleye> So "wasteful" is a bit of an early call.
[22:40:39] <bascule> the ioserver was typically a single thread
[22:40:55] <bascule> performing all of the I/O operations for the entire VM
[22:41:07] <bascule> and converting completions internally to Erlang asynchronous messages
[22:41:40] <eternaleye> bascule: In a microkernel, system calls _are_ userspace messages.
[22:41:51] <bascule> so like
[22:41:56] <bascule> I don't need to be taught about any of this stuff
[22:41:57] <bascule> FYI
[22:42:01] <bascule> I'm just like
[22:42:04] <bascule> WTF are you talking about
[22:42:06] <bascule> microkernel?
[22:42:08] <bascule> what microkernel?
[22:42:12] <bascule> I ship shit for Linux bro
[22:43:15] <bascule> I don't have time for the architecture astronauts who have been peddling the same failed ideas for the past three decades to finally ship something that everyone actually ends up using
[22:43:21] <eternaleye> bascule: That's why I was making the distiction I was earlier, re: you talking about higher-level APIs than I was
[22:43:30] * bascule talking about how to build real-world systems
[22:43:41] <eternaleye> bascule: At which point you suggested I enjoyed being pedantic :P
[22:43:55] <bascule> when everyone replaces Linux with GNU/Hurd, let me know
[22:43:58] <eternaleye> bascule: I don't enjoy being pedantic; I just enjoy miscommunication less
[22:44:28] <eternaleye> bascule: And Hurd's gotten far too much wrong
[22:44:31] <Tiffany> excuse me, I believe you mean GNU/GNU-Hurd-libre
[22:44:36] <bascule> lulz
[22:44:39] <eternaleye> bascule: For one: Not caps
[22:44:44] <bascule> eternaleye: yeah that wasn't a serious statement, lol
[22:44:51] <Tiffany> what do real world systems do bascule?
[22:45:00] <Tiffany> I've mostly been using libuv
[22:45:02] <bascule> influence everyone's daily lives
[22:45:06] <Tiffany> no I mean for IO
[22:45:07] <bascule> haha oh
[22:45:10] <eternaleye> And the thing is, seL4 is getting plenty of real use, so...
[22:45:11] <bascule> I use libev on POSIX
[22:45:16] <mcpherrin> bascule: hey man I influence people's lives with my fighter jets running QNX
[22:45:19] <mcpherrin> pew pew pew
[22:45:25] <mcpherrin> microkernels blowin' up your terrorists
[22:45:28] <bascule> I... don't really like libuv?
[22:45:41] <Elaine> does anyone?
[22:45:43] <Elaine> lol
[22:45:55] <Tiffany> I used to use libevent before I used libuv
[22:45:56] <bascule> the Node.js community sure does, and we should look to their technical leadership
[22:46:09] <Tiffany> trying to see how libev compares
[22:46:17] <Tiffany> oh
[22:46:20] <Elaine> the only advantage of libuv is you can have slow async io on posix *and* windows.
[22:46:23] <Tiffany> it's like libevent
[22:46:33] <bascule> hahahaha Elaine <3
[22:46:51] <bascule> Tiffany: yeah, similar to libevent, just... more slimmed down and slightly less insane
[22:46:53] <Tiffany> do you use any abstractions on top of libev?
[22:46:56] <Tiffany> I found libevent really verbose
[22:47:19] <bascule> Tiffany: https://github.com/celluloid/celluloid-io
[22:47:29] <bascule> I would like something like that in Rust, but...
[22:48:00] <Elaine> I never looked hard at celluloid because I never really Ruby, is it excellent?
[22:48:01] <bascule> https://www.youtube.com/watch?v=4fFDFbi3toc&app=desktop
[22:48:03] <bascule> ^^^ more like that
[22:48:08] <bascule> Elaine: I made it, and not really, heh
[22:48:15] <Elaine> oh haha
[22:48:30] <bascule> it's probably the best option for concurrent IO in Ruby
[22:48:58] <bascule> ^^^ is nice because it provides a synchronous API where you get explicit suspend/resume points
[22:49:14] <bascule> and it can either run in a multithreaded / distributed manner, or in a single-threaded event loop
[22:49:29] <Elaine> mm
[22:49:29] <bascule> and if you can simulate a distributed system as a single-threaded event loop, you can have deterministic tests of failures
[22:49:47] <bascule> where failures == actually testing you don't believe in the fallacies of distributed computing
[22:50:03] <bascule> you can have pseudorandom chaos monkies that drop, reorder, and duplicate messages
[22:50:26] <bascule> or add latency
[22:51:13] <bascule> your test farm can continuously grind away at your code under different pseudorandom starting conditions
[22:51:21] <bascule> and when it finds a failure, you can get a seed to reproduce the problem locally
[22:51:36] <bascule> sort of the quickcheck idea, applied to distributed systems
[22:52:48] <eternaleye> bascule: Anyway, on seL4/ARM, a thread's TCB takes up 512bytes. Pretty sure that's less than epoll uses up per-fd: http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/fs/eventpoll.c#L117
[22:55:31] <bascule> eternaleye: that's cool (but not really applicable to anything I'm doing)
[22:59:34] <Elaine> eternaleye: I count ~96 bytes with 8 byte pointers :P
[22:59:42] <Elaine> for a single epitem
[23:01:02] <mcpherrin> bascule: I hear Twitch.tv is going to use macaroons
[23:03:42] <mcpherrin> delicious macaroons
[23:19:36] *** Joins: dpc (dpc@moz-52v2l7.nvidia.com)
[23:23:45] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:26:08] <eternaleye> Elaine: Hm? rb_node is { long, *, * }, list_head is {*, *}, there's the next*, epoll_filefd is {*, int}, there's int nwait, a second list_head {*, *}, the eventpoll*, another list_head {*,*}, and struct epoll_event is {u32, u64} packed, which will incur padding before it in the epitem. That's 12 pointer-sized values, 1 64-bit value, 3 32-bit values, and at least 32 bits of padding. That would be 120 bytes on its own. However, there's also 
[23:26:09] <eternaleye> going to be at least one eppoll_entry for each, which is another list_head {*,*}, an epitem*, a wait_queue_t {uint, void*, waitqueue_func_t {*}, list_head {*,*}}, and the whead*, which adds another 8 pointers, a 32-bit value, and 32 bits of misalignment padding, for an extra 72, bringing the total to 192. There's also an ep_pqueue, with a poll_table {poll_queue_proc {long,*}, long key}, epi*} (+32 bytes = 224), etc
[23:27:04] <eternaleye> Elaine: tl;dr: There are several per-fd things epoll has which point _to_ epitem, rather than being contained in it
[23:27:05] <eternaleye> Elaine: And I don't think I caught everything by a good bit
[23:27:27] <eternaleye> Elaine: And I'm quite sure I missed several misalignment-padding spots
[23:29:45] <eternaleye> Elaine: And that's not accounting for RB-tree overhead
[23:29:52] <eternaleye> etc.
[23:33:01] *** Quits: dpc (dpc@moz-52v2l7.nvidia.com) (Connection closed)
[23:33:12] *** Joins: dpc (dpc@moz-52v2l7.nvidia.com)
[23:36:05] <bascule> mcpherrin: lol whut, really?
[23:36:54] <mcpherrin> bascule: well, apparently their security people have never heard of them and don't trust the random non-security engineers who want to use them
[23:37:22] <mcpherrin> (complaints about which is how I heard of this whole shenanigans)
[23:37:28] <bascule> hahaha, oh really
[23:37:31] <bascule> wow I need to finish my blog post
[23:37:42] <bascule> it's really sad that's how this stuff works
[23:38:02] <bascule> don't use obscure stuff even though it's good
[23:38:05] <bascule> just use Node.js and MongoDB
[23:38:08] <bascule> they're popular
[23:38:13] <bascule> all the other cool kids are using them
[23:38:19] <bascule> they have awesome communities!
[23:38:52] <bascule> I'm scheduled to talk about them at Papers We Love in December
[23:40:30] <mcpherrin> bascule: The other complaint I hear about twitch.tv engineering is they choose the most popular technologies no matter what ;p
[23:41:58] *** Quits: dpc (dpc@moz-52v2l7.nvidia.com) (Ping timeout: 121 seconds)
[23:42:10] <bascule> Millions of PHP programmers can't be wrong!
[23:47:57] <sfackler> uninitialized byte arrays in IO II: electric boogaloo: https://github.com/rust-lang/rfcs/pull/1222
