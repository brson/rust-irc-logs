[00:00:39] <doomlord> can the info in ctxt_ get from a ty::t to a NodeId holding its definition
[00:03:12] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[00:04:47] <steven_is_false> Hi! I know many of you guys are interested in task-based isolation, and I remember that I read once there is a way to restrict the system calls that can be called from a thread on Linux. Does anyone know what I'm talking about?
[00:05:06] <cmr> steven_is_false: seccomp
[00:05:11] <steven_is_false> cmr: Thanks.
[00:05:17] <cmr> steven_is_false: https://github.com/thestinger/playpen uses it
[00:05:24] <cmr> The code is fairly simple
[00:06:05] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:06:20] <steven_is_false> I'm really bad at reading code but I'll try to take a look.
[00:06:38] *** Joins: syatchmenoff (syatchmeno@moz-AB5B740D.hsd1.or.comcast.net)
[00:07:03] <mark_edward>  cmr: i dunno if my keccak thing is worthy, it's not finished yet. i am making it to be included in extra though, under the digest module
[00:07:36] <cmr> mark_edward: Sure it is, I'll throw it in
[00:08:35] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[00:09:01] *** Quits: syatchmenoff (syatchmeno@moz-AB5B740D.hsd1.or.comcast.net) (Quit: syatchmenoff)
[00:10:35] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Connection reset by peer)
[00:10:38] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[00:11:13] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[00:11:39] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:12:09] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Ping timeout)
[00:12:16] <doomlord> now i'm trying to get the def of struct-fields.. i have a "expr_field(expr,ident,~[Ty]) .. i'm assuming thats an expr for the object (object.field), the ident of the field, and type parametes..
[00:12:27] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[00:12:36] <Luqman> r? https://github.com/mozilla/rust/pull/8220
[00:12:40] *** Parts: Havvy (Havvy@moz-4FE57F72.hsd1.wa.comcast.net) ()
[00:13:07] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:16:21] <Seldaek> anyone got a short example of a tcp server with newrt?
[00:16:45] <cmr> ldunn: ping
[00:19:52] <erickt1> kimundi: I pushed up my branch to https://github.com/mozilla/rust/pull/8294
[00:20:35] <Luqman> Seldaek: https://gist.github.com/luqmana/6152653
[00:21:20] <Seldaek> Luqman: thanks, that'll save me some trouble migrating :)
[00:21:40] <jeaye> If a module has a macro and the top of the crate imports it, all other modules can't just 'use' it or anything like that; they all have to import it on their own too, right?
[00:22:08] <cmr> http://cmr.github.io/blog/2013/08/04/this-week-in-rust/
[00:23:03] <kimundi> erickt1: Nice. One thing, the two new functions in result, could you change the doc comment style to /// ? afaik that's what our style guide recmmends
[00:23:15] <jeaye> cmr: q3 gets multithreaded rendering! :D
[00:23:30] <erickt1> Sure thing
[00:23:53] <cmr> jeaye: addition pushed :)
[00:24:02] <jeaye> Huzzah
[00:24:03] <kimundi> jeaye: importing is not a thing that can be done with a macro right now :P
[00:24:34] <jeaye> kimundi: I'm currently importing macros fine using #[macro_escape]
[00:24:46] <jeaye> I just havet to do it in every module that uses it.
[00:25:03] <kimundi> jeaye: that's not really imporing, thats 'using a hack to make a macro ignore scope'
[00:25:15] <jeaye> heh
[00:26:08] <kimundi> some day we will be able to import/use/reexport them like other items, hopefully
[00:26:15] <erickt1> kimundi: updated
[00:27:02] <kimundi> erickt1: looks good :)
[00:28:23] <kimundi> I'd put a r+ below it if I could :P
[00:28:42] <cmr> dbaupp: Do you think a -g flag that turns on --cfg debug and -Z debug-info (and -Z extra-debug-info when it's ready) would be appropriate?
[00:29:25] *** Quits: experimenter (Mibbit@moz-A6BB0F96.dsl.austtx.swbell.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:35:47] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Client exited)
[00:37:51] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Quit: tikue)
[00:38:39] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[00:38:58] <cmr> doomlord: do you know what a def_local is? A `let foo = bar` I imagine?
[00:39:14] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[00:39:17] <miloshadzic> What's a good way to build up a string in rust? I'm guessing that .fold(~"", |out, string| out.append(string)) isn't
[00:39:33] <doomlord> i think so
[00:40:40] <doomlord> a little more progress here, i can get something for struct-fields now, but i've only got it giving me the definition of the *struct*, not the *field*
[00:40:55] <cmr> miloshadzic: If you know the length beforehand, create the string with str::with_capacity, and that should be fine
[00:41:01] <cmr> Rust strings aren't immutable
[00:41:16] <cmr> So we don't have the O(n^2) problem with string building other language have
[00:41:41] <miloshadzic> cmr, thanks
[00:42:24] <Luqman> doomlord: getting the ast node (item_struct) for it would give you the struct_def which has the fields
[00:43:33] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:44:17] <strcat> steven_is_false: https://github.com/thestinger/rust-seccomp I have a *very* incomplete start of bindings
[00:44:31] <strcat> at some point I'll get around to finishing that up and getting namespaces, etc. working
[00:44:45] <steven_is_false> strcat: Oh Thanks!
[00:44:55] <doomlord> ok what i'd managed to do was get a t_box_ from the expr_field(expr,_), handle auto-deref, and that ave me a ty_struct
[00:45:06] <strcat> might need to be updated a bit
[00:45:22] <doomlord> ^gave ... so yes i can go through to get the individual item now..
[00:48:08] *** Joins: syatchmenoff (syatchmeno@moz-AB5B740D.hsd1.or.comcast.net)
[00:49:01] *** Quits: syatchmenoff (syatchmeno@moz-AB5B740D.hsd1.or.comcast.net) (Quit: syatchmenoff)
[00:49:15] <erickt1> does anyone know how #[unsafe_destructor] works?
[00:51:10] <sfackler> erickt1: I think it just tells the compiler to accept the Drop impl even though it's unsafe
[00:51:30] <brson> cmr: thanks for twir 9. you're my hero
[00:51:38] <cmr> brson: np
[00:52:20] <doomlord> i should have enough to generate useful ctags now .. functions,methods,fields(well,their enclosing struct until i do a lookup), and structs 
[00:53:59] <mark_edward> doomlord: that's cool!
[00:54:44] *** kimundi is now known as zz_kimundi
[00:54:46] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:55:41] *** Joins: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP)
[00:56:10] <tautologico> how can I test if a string begins with some prefix?
[00:56:25] <cmr> rusti: "foobar".starts_with("foo")
[00:56:26] -rusti- true
[00:56:49] <tautologico> thanks
[00:57:08] <tautologico> that's from trait StrSlice, reading the docs I didn't know if this applied to str
[00:57:46] <cmr> ~str implements StrSlice
[00:57:55] <cmr> there is no such type as `str`
[00:58:32] <tautologico> I see
[00:58:35] <tautologico> only pointers to strings
[00:58:54] <strcat> cmr: might want to add https://github.com/mozilla/rust/pull/8244 to that list of PRs too so it's clear 'foreach' is gone too
[00:58:55] <brson> dlist's drop glue is tail-recursive and this is a problem for the new scheduler since the dlist benchmarks smash the fixed-size stack
[00:59:28] <cmr> strcat: I never reported it as present ;p
[00:59:31] <cmr> but sure
[00:59:36] <cmr> Must have missed that one
[00:59:47] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Quit: Konversation terminated!)
[01:00:58] <engla> brson: it could implement a destructor that just dissolves the dlist backwards instead
[01:01:30] <strcat> acrichto: hm did you touch the file needed to trigger an LLVM rebuild?
[01:02:08] <doomlord> can a ctags file actually represeent definitions properly, i.e. given ambiguity in the names  
[01:02:32] <brson> engla: think I'll try that
[01:02:35] <cmr> doomlord: I think so. For example, you can have multiple structs with the same name in a given C codebase.
[01:02:39] <engla> brson: https://github.com/mozilla/rust/issues/8295
[01:02:52] <engla> brson: I already tested some code (just putting it in .clear())
[01:03:23] <engla> brson: something like this https://gist.github.com/anonymous/3738ba328db1c1bf99aa
[01:03:30] <engla> destructor could use it
[01:03:31] <acrichto> strcat: I think I did?
[01:03:37] <doomlord> how would ctags deal with the case of the same field name in different structs .. does it allow a mapping between a specific instance & a specific definition
[01:03:53] <cmr> hm, that I do not know
[01:04:22] <brson> engla: awesome! do you want to make a pull for it or should I just take you gist?
[01:04:23] <doomlord> thats the main reason for doing this IMO
[01:04:27] <erickt1> thanks sfackler
[01:04:35] <joelteon> how do i delay the current thread?
[01:04:36] <engla> brson: just take it/ either way doesn't matter
[01:04:41] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[01:04:42] <joelteon> or task, or whatever it is
[01:04:54] <engla> brson: did you discover this issue now or did you see the bug report I linked? Because we discussed here some hours ago
[01:05:35] <brson> engla: it's one of the last bugs holding up the runtime. the dlist benchmarks are segfaulting because the new scheduler doesn't have split stacks
[01:05:47] <brson> discovered independently
[01:05:58] <engla>  /o\ great, then we are resolving this
[01:06:04] <engla> if you want I can make a pull
[01:06:05] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[01:06:27] <engla> because the .clear() code resolves the issue but with a dtor, the pattern matches on DList have to be rewritten
[01:07:27] <engla> but the dlist benches breaking is not a good thing. They just  do b.iter { q.push_front(1) }  and basically the bench runner determines how much the q grows
[01:07:34] <engla> we could remove that infinite growth
[01:07:56] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[01:07:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AfXdWQ
[01:07:56] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[01:08:46] <doomlord> html with type information popups would be nice :)
[01:09:04] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[01:10:32] <geomyidae> I'm the world's biggest dummy, rust-git from AUR doesn't build from master.
[01:10:45] <brson> engla: if you don't mind I'll just test here and do a pull
[01:10:47] <geomyidae> never mind, that's not right either, I was trying to delete that, not send it
[01:10:56] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[01:10:56] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ZZqNJg
[01:10:56] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[01:10:56] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:10:56] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/E5KV5Q
[01:10:56] <ghrust> 13rust/06auto 14dc5b0b9 15bors: auto merge of #8282 : brson/rust/more-newsched-fixes, r=brson
[01:10:56] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:10:58] <engla> brson: sure ok
[01:11:08] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[01:11:59] <brson> engla: what's your github nick?
[01:12:04] <engla> blake2-ppc
[01:12:18] <brson> right. we really need a bot to correlate irc nicks with github nicks
[01:12:53] <brson> very often i have two people in my head that end up merging into a single entity
[01:12:55] <engla> I need to switch github nick anyway, I'll pick something more sensible
[01:13:29] <goffrie> rusti: {}
[01:13:29] -rusti- ()
[01:13:48] <goffrie> rusti: () == {}
[01:13:49] -rusti- true
[01:13:51] <goffrie> rusti: {} == ()
[01:13:52] -rusti- <anon>:5:12: 5:14 error: unexpected token: `==`
[01:13:52] -rusti- <anon>:5          {} == ()
[01:13:52] -rusti-                      ^~
[01:13:52] -rusti- application terminated with error code 101
[01:14:00] <goffrie> interesting :P
[01:14:08] <brson> urgh, DList can't have a `drop` trait because it gets destructured
[01:14:37] <cmr> goffrie: {} isn't a valid literal
[01:14:43] <cmr> although...
[01:14:46] <cmr> rusti: { true } == true
[01:14:46] -rusti- <anon>:5:18: 5:20 error: unexpected token: `==`
[01:14:47] -rusti- <anon>:5          { true } == true
[01:14:47] -rusti-                            ^~
[01:14:47] -rusti- application terminated with error code 101
[01:14:47] <joelteon> why is line 14 giving me "unconstrained type"? https://gist.github.com/joelteon/6152829
[01:14:55] <engla> brson: that's what I mentioned, I can fix that
[01:14:56] <brson> same for Node!
[01:14:59] <goffrie> I guess it parses as a statement, not an expression
[01:15:10] <joelteon> oh I'm not supposed to have new<T> >_>
[01:15:11] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:15:13] <joelteon> my bad everyone
[01:15:13] <cmr> joelteon: There's nothing that indicates to type inference what it is
[01:15:16] <brson> engla: oh. ok, maybe you should take a stab at it then
[01:15:31] <brson> thanks
[01:15:58] <geomyidae> let s = "
[01:16:58] <geomyidae> rusti, let s = "Hello World"; for c in s { printf!("%c", c); }
[01:17:03] <engla> brson: didn't test it yet https://gist.github.com/anonymous/93aecf15352083a477d5
[01:17:07] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[01:17:07] <engla> but it compiles^^
[01:17:13] <Seldaek> what's newrt-speak for spawn_supervised? can't seem to find it
[01:17:28] <geomyidae> rusti: let s = "Hello World"; for c in s { printf!("%c", c); }
[01:17:28] -rusti- <anon>:5:32: 6:5 error: type `&mut &'static str` does not implement any method in scope named `next`
[01:17:29] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:17:29] -rusti- <anon>:5          let s = "Hello World"; for c in s { printf!("%c", c); }
[01:17:29] -rusti- <anon>:6     };
[01:17:29] -rusti- error: aborting due to previous error
[01:17:29] -rusti- application terminated with error code 101
[01:18:00] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:18:00] *** ChanServ sets mode: +o brson
[01:19:02] <bblum> Seldaek: it is the same
[01:19:16] <brson> really close to turning on the new runtime
[01:19:27] <brson> engla: I think it's just this recursion bug and one more scheduler logic bug
[01:19:39] <engla> nice
[01:19:55] <engla> nope, that patch wasn't good
[01:19:56] *** Quits: Sergio965 (sergiobz@7BC29AAF.C3A89135.3A99D594.IP) (Quit: Textual IRC Client: www.textualapp.com)
[01:20:29] *** Quits: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP) (Quit: tautologico)
[01:20:38] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Client exited)
[01:21:07] <Seldaek> bblum: well the compiler doesn't agree :) or isn't it in the std prelude?
[01:21:17] <geomyidae> can for be used to iterate over chars in a string still? I assume I'm just doing it wrong there^ 
[01:21:24] <goffrie> geomyidae: you need an .iter() in there
[01:21:38] <bblum> Seldaek: it should be std::task::spawn_supervised
[01:21:38] <goffrie> rusti: let s = "Hello World"; for c in s.iter() { printf!(c); }
[01:21:39] -rusti- 'H''e''l''l''o'' ''W''o''r''l''d'()
[01:22:19] <Seldaek> bblum: oh yes thanks, not sure why it worked without before
[01:22:49] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[01:23:15] *** Joins: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP)
[01:23:29] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[01:25:17] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[01:25:38] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[01:26:57] <engla> brson: new patch. maybe you didn't see the previous one (you dropped?) but this one at least passes the dlist tests. https://gist.github.com/anonymous/d86e82af24c7d7a05435
[01:31:10] <Seldaek> it's a bit strange that if you don't use std::rt::io::Listener the compiler doesn't see a TcpListener's accept method
[01:31:23] <Seldaek> is this expected?
[01:31:25] <cmr> Seldaek: Yes
[01:31:33] <cmr> The trait needs to be in scope to call methods it defines
[01:32:02] <Seldaek> interesting.. 
[01:32:22] <Seldaek> it's a bit strange because you need a use that doesn't appear anywhere in the code
[01:32:29] <Seldaek> which is why I removed it, figured it wasn't needed
[01:33:55] <brson> engla: your patch fixes by stack overflow problem
[01:33:58] <cmr> If the compiler doesn't say it's unused, it's not unused :p
[01:35:03] <engla> brson: do you think it's expected of a such deeply recursive type as DList to resolve this in the destructor?
[01:36:08] <engla> brson: that's great, feel free to just take the patch/mangle it how you'd like
[01:36:18] <geomyidae> how about how has io_error::cond.trap().in() -> ? 
[01:37:16] <Seldaek> cmr: fair enough, I'm not used to compile checks like that:)
[01:37:22] <brson> engla: i'm not sure, drop recursion is certainly a wierd hazard
[01:37:27] <brson> *weird
[01:38:35] <joelteon> does rust have transactional memory/mutexes?
[01:39:10] <brson> joelteon: not yet
[01:39:14] <joelteon> ok
[01:39:18] <bblum> we have mutexes
[01:42:11] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[01:42:36] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Quit: tikue)
[01:42:39] <brson> engla: https://github.com/mozilla/rust/pull/8297 thanks
[01:43:04] <cmr> Is the ~[trait_ref] in an item_trait the traits it inherits from?
[01:43:50] * cmr can't think of anything else it could be
[01:44:38] <vk> Hey, what could lead to an unresolved name error?
[01:44:50] <cmr> vk: the thing you're trying to reference not existing
[01:45:42] <engla> brson: great
[01:45:57] <vk> cmr: What if that thing does exist? Or at least seemingly does/should.
[01:46:06] *** Quits: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP) (Quit: tautologico)
[01:46:22] <cmr> vk: check for typos? I think it should tell you when the thing you're trying to reference is private in all cases now
[01:46:26] <cmr> otherwise, check if it's private :p
[01:47:15] <vk> cmr: hrm. methods on structs are public or private by default?
[01:47:21] <cmr> vk: private
[01:47:46] <cmr> vk: can you pastebin your code?
[01:47:53] <cmr> (rather than playing 20 questions)
[01:48:23] <vk> aye, https://github.com/vkorapaty/rust-mustache/blob/0.8pre-update/mustache.rs, problems with line 281
[01:48:32] <bstrie> hm, people can't seem to agree on which date should be in the "Year" field in the infobox on rust's wikipedia page. now we're a 2014 language, up from 2012, 2008, and 2006
[01:48:49] <vk> cmr: struct Encoder is defined on line 165 with the new method on line 169
[01:49:10] <cmr> bstrie: hahah
[01:49:21] <joelteon> this is a long shot, but is it possible to take two Ports and wait until either one is ready to read from?
[01:49:43] <cmr> bblum: ^
[01:49:48] <cmr> joelteon: I think you can call select on them
[01:49:59] <bblum> joelteon: sure is, select()
[01:50:02] <joelteon> oh jesus, you can
[01:50:15] <joelteon> oh boy this problem is finally solvable
[01:50:35] <bblum> cmr: you could have answered that :P
[01:50:40] <bblum> oh, you did
[01:50:44] <cmr> vk: I don't see the new method on Encoder in http://static.rust-lang.org/doc/extra/serialize.html#trait-encoder
[01:50:49] <joelteon> but I'm definitely going to be up late tonight
[01:51:13] <cmr> bblum: well, I haven't actually done it, I just saw your PR for newrt pipes
[01:51:15] <vk> cmr: does the new method have to be implemented in the trait?
[01:51:16] <cmr> (whatever those are)
[01:51:27] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:51:34] <cmr> vk: defined, you're implemented serialize::Encoder
[01:51:38] <cmr> *implementing
[01:52:24] <bblum> the interface for select is probably a complete mess given the current state of the two runtimes
[01:52:34] *** Joins: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net)
[01:53:48] <vk> cmr: hmm, removing the serialize::Encoder from the impl that has the new method has given me a new set of errors. yay! thanks :D
[01:54:49] <bstrie> rusti: let x = ~[]; x.push(1); x
[01:54:50] -rusti- <anon>:5:22: 5:23 error: cannot borrow immutable local variable as mutable
[01:54:50] -rusti- <anon>:5          let x = ~[]; x.push(1); x
[01:54:50] -rusti-                                ^
[01:54:50] -rusti- error: aborting due to previous error
[01:54:51] -rusti- application terminated with error code 101
[01:54:55] <bstrie> rusti: let mut x = ~[]; x.push(1); x
[01:54:55] -rusti- ~[1]
[01:57:35] <Seldaek> ok finally done dealing with the compiler, here come the runtime errors :)
[01:57:38] <Seldaek> fatal runtime error: runtime tls key not initialized
[01:58:05] <cmr> Seldaek: run with RUST_NEWRT=1
[01:58:10] <cmr> (as an environment variable)
[01:58:12] <Seldaek> oh ok 
[01:58:22] <Seldaek> yay
[02:00:14] <Seldaek> ok seems I borked my code while porting it, but at least I can telnet to it now :)
[02:04:56] <bstrie> cmr: twir is so useful, I've been playing board games for four straight days and have missed everything that's been going on
[02:04:57] *** Joins: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP)
[02:05:37] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:05:43] <Seldaek> yup it's really a good resource
[02:05:44] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[02:06:15] * cmr cracks the whip at bstrie
[02:06:18] <cmr> back to work!
[02:07:47] <erickt1> strcat: r? https://github.com/mozilla/rust/pull/8296. Removing trailing nulls from strings. Probably shouldn't get a r+ yet, but it'd be nice to get a comment
[02:08:07] <erickt1> strcat: since you participated in https://github.com/mozilla/rust/issues/7235
[02:09:33] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[02:11:37] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[02:12:39] <strcat> acrichto: the src/rustllvm/llvm-auto-clean-stamp thing
[02:13:08] <strcat> geomyidae: there's an arch linux repo with nightly builds of rust-git btw
[02:16:41] *** Quits: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr) (Ping timeout)
[02:17:18] <jeaye> bjz: ping
[02:17:25] <joelteon> can I convert a TcpStream to a Port/Chan pair?
[02:18:20] <jeaye> strcat: The net module is currently undergoing massive changes, right?
[02:18:32] <strcat> well it's been replaced completely
[02:18:39] <jeaye> Has that landed?
[02:18:55] <strcat> kind of. it's not the default yet
[02:19:02] <cmr> extra::net was removed
[02:19:04] <cmr> so it half landed
[02:19:17] <Luqman> strcat: looking at the pull it does seem like acrichto modified that file
[02:19:29] <jeaye> Alright. I've been considering getting started on some UDP for q3, but I think I'll wait until it's fully landed.
[02:20:25] <Luqman> jeaye: it's mostly there and I think something like q3 fully exercising it would be quite helpful
[02:20:42] <Luqman> i don't know of anything doing udp with rust now
[02:20:48] <jeaye> Excellent. :)
[02:21:30] <brson> joelteon: not yet, but there's a sketch of such adapters in rt::io::comm_adapters
[02:21:32] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:21:36] <joelteon> oh good
[02:21:42] <brson> the implementation should be relatively trivial
[02:22:18] <brson> it's so close
[02:22:21] <erickt1> brson: if you got a free moment, I'd love any input to https://github.com/mozilla/rust/pull/8296. It's about removing trailing nulls from strings
[02:22:23] <brson> so so close
[02:22:43] <vk> How should use of emit_owned_str method be replaced/updated?
[02:22:57] <brson> erickt1: sure. I may get dinner first though
[02:23:06] <erickt1> no problem, thanks :)
[02:24:28] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:24:36] *** Quits: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP) (Quit: tautologico)
[02:24:57] *** Joins: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP)
[02:25:28] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:31:09] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[02:33:05] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[02:33:12] <brson> cmr: where did you find that visibily scope blog post? I missed it originally
[02:33:28] <brson> that's good stuff
[02:33:56] <cmr> bstrie: http://michaelwoerister.github.io/
[02:34:04] <cmr> He updates weekly as part of GSoC
[02:34:06] <cmr> erm, @brson
[02:34:56] <cmr> mw is doing some really good work
[02:35:31] <Luqman> <3 the debuginfo support
[02:36:42] <brson> is he on IRC?
[02:36:47] <cmr> Very infrequently
[02:36:51] <brson> that's not right
[02:36:56] <cmr> I agree completely!
[02:37:12] <cmr> He should always be around to receive our praise
[02:37:50] <brson> haha
[02:39:54] * brson dinner
[02:41:54] *** Quits: zz_kimundi (kimundi@moz-2E255F2E.dip0.t-ipconnect.de) (Ping timeout)
[02:43:53] <jeaye> Luqman: Do we have it?
[02:44:10] <Luqman> jeaye: it?
[02:44:19] <jeaye> debuginfo support?
[02:44:30] <cmr> yes
[02:44:32] <Luqman> oh yea, -Z debug-info
[02:44:37] <cmr> -Z debug-info, and -Z extra-debug-info
[02:44:42] <jeaye> Right, I thought it was busted.
[02:44:46] <jeaye> When was it fixed?
[02:44:46] <cmr> (extra-debug-info is quite experimental)
[02:44:54] <cmr> Maybe two and a half months ago?
[02:44:56] <aatch> jeaye, gradually, over time.
[02:45:12] *** Joins: zz_kimundi (kimundi@moz-22A48A03.dip0.t-ipconnect.de)
[02:45:14] <cmr> Well, it was entirely busted for a while
[02:45:14] <jeaye> ah
[02:45:23] <cmr> the current bustage is just unimplemented features
[02:45:29] *** zz_kimundi is now known as kimundi
[02:45:38] <jeaye> Yeah, I remember it caused an ICE and then I stopped using it entirely. I guess it's been a while. >.<
[02:45:39] <cmr> (it is very kind and emits a warning when debuginfo for something is not yet implemented)
[02:46:12] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:49:17] <bjz> jeaye: hoya
[02:49:43] <bjz> jeaye: did you get what I said before?
[02:49:49] <jeaye> bjz: Hey, mate. What is it that glfw-rs is blocked on?
[02:49:53] <jeaye> Nope, I don't think I did.
[02:50:00] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:50:00] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/M7GzVA
[02:50:00] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:50:29] <bjz> jeaye: what happens if the main window was dropped before the shared window?
[02:51:06] <bjz> jeaye: with your pull
[02:51:17] <jeaye> Ahh, I can look into that. About to have dinner with the gf, but I'll let you know tonight.
[02:51:49] <bjz> jeaye: it is blocked on the lack of the ability to run it on the main platform thread
[02:52:13] <bjz> jeaye: pcwalton seems to have hacked it to work with sdl and sprocket
[02:52:47] <jeaye> ahh, yeah I noticed that when trying to access some data stored in TLS earlier today. :P
[02:52:58] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:52:59] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/FgYCAw
[02:52:59] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:52:59] <bjz> the former question?
[02:53:00] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[02:53:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/EVp0Ag
[02:53:00] <ghrust> 13rust/06auto 144898a0d 15Brian Anderson: extra: Don't recurse in DList drop glue. #8295...
[02:53:00] <ghrust> 13rust/06auto 146c12ca3 15bors: auto merge of #8297 : brson/rust/dlist-dtor, r=brson...
[02:53:01] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[02:53:18] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[02:53:29] <jeaye> hmm?
[02:54:00] <bjz> jeaye: your previous point, what was thatr in relation to?
[02:54:14] <jeaye> Oh, just some singleton I was storing in TLS.
[02:54:34] <jeaye> Noticed that it wasn't available from outside the glfw::spawn
[02:54:49] *** Quits: tautologico (shung@74BFD9C3.5A3A7952.7B974E06.IP) (Quit: tautologico)
[02:55:00] <bjz> mm
[02:55:14] <bjz> maybe we need a better way, not sure
[02:55:38] <jeaye> Nah, it's fine. I just store it in all of my tasks now.
[02:55:41] <jeaye> Anyway, dinner.
[02:56:49] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[02:57:30] <tikue> anyone ever consider `yield` syntax for rust?
[02:57:36] <cmr> tikue: yes
[02:57:43] <tikue> cmr: what's the story?
[02:58:02] <cmr> tikue: you'd have to ask strcat or engla but aiui "not 1.0"
[02:58:10] <tikue> kk
[03:00:59] <strcat> it would be a big project
[03:01:10] <strcat> it can't be implemented with desugaring like C#
[03:02:11] <tikue> is there a count() iterator currently? didn't see one in std::iterator
[03:02:18] <strcat> tikue: it's called Counter
[03:02:19] <cmr> Counter
[03:02:32] <strcat> the constructor could be renamed from Counter::new to count to match range
[03:02:34] <tikue> ah thank you
[03:02:41] <tikue> that's why I missed it
[03:04:03] *** Joins: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de)
[03:04:59] <cmr> jsonify.rs:170:17: 170:77 error: type `std::iterator::Filter<,&clean::TraitMethod,std::vec::VecIterator<,clean::TraitMethod>>` does not implement any method in scope named `transorm`
[03:05:04] <cmr> strcat: why would that be?
[03:05:08] <cmr> oops
[03:05:10] <cmr> now it's obvious
[03:07:07] <strcat> :)
[03:08:01] <tikue> rusti: use std::iterator::Counter; [2].consume_iter().chain_(Counter::new(3, 2))
[03:08:04] -rusti- pastebinned 7 lines of output: http://sprunge.us/OZdH
[03:08:19] <strcat> tikue: consume_iter is only on ~[T]
[03:08:31] <tikue> right, i always forget
[03:08:40] <tikue> rusti: use std::iterator::Counter; ~[2].consume_iter().chain_(Counter::new(3, 2))
[03:08:41] -rusti- pastebinned 7 lines of output: http://sprunge.us/KhVh
[03:08:50] <tikue> rusti: use std::iterator::Counter; (~[2]).consume_iter().chain_(Counter::new(3, 2))
[03:08:52] -rusti- {a: {v: ~[2], idx: 0}, b: {state: 3, step: 2}, flag: false}
[03:09:27] <tikue> man I really want some kind of for-else syntax
[03:10:03] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[03:12:07] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[03:14:12] <cmr> rustdoc_ng now extracts traits \o/
[03:14:27] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[03:17:15] <jdm> woot
[03:22:49] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Connection reset by peer)
[03:23:11] *** Quits: eagen (eagen@moz-92A457CB.hsd1.mn.comcast.net) (Ping timeout)
[03:23:48] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[03:25:02] *** Joins: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP)
[03:25:53] <engla> tikue: as Eridius mentioned, you can check if the iterator is exhausted after a for;   let mut it = v.iter(); for _ in it { .. break; .. }  match it.next() {
[03:26:18] <tikue> engla: that's currently up in the air
[03:26:22] <cmr> engla: Pending the discussion on the ML, I think it's extremely unwise to call next again
[03:26:26] <tikue> engla: and fails if you're on the last one
[03:26:40] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[03:26:45] <engla> I guess it is to be defined 
[03:26:49] <engla> didn't read the ML
[03:26:55] <tikue> engla: it also just won't always work
[03:27:14] <engla> right, if you break on the last lap
[03:27:18] <tikue> for i in it { break on last element; } if it.next().is_some() { }
[03:27:20] <tikue> yea
[03:33:54] <goffrie> hmm, that could be a use for the Fuse adapter in #8276 if it exposed the done property
[03:34:28] <goffrie> although that wouldn't be the most lightweight way to do it
[03:34:50] <Eridius> goffrie: it actually is, since iterators get inlined
[03:35:27] <Eridius> well, I guess it adds a bool check on every pass through the for loop, which isn't strictly necessary (since you really only need to check it at the end)
[03:36:07] <Eridius> although it's possible that llvm could be smart enough to realize that's not necessary when the wrapped iterator makes the strong guarantee of never doing anything again once it's returned None
[03:36:25] <goffrie> right, it all depends on llvm :p
[03:37:12] <Eridius> well you're free to do whatever you want with a local mutable bool variable
[03:37:21] <goffrie> true
[03:37:55] <Eridius> speaking of the ML discussion, in my latest email I mentioned a hypothetical .prev() method you could add to some iterators (assuming we codify approach #3). I'm kind of tempted to add that to VecIterator
[03:38:21] <sanxiyn> Eridius: Which ML discussion?
[03:38:39] *** Quits: mreid (mreid@moz-5F4A70CA.yipyip.com) (Ping timeout)
[03:38:42] <Eridius> sanxiyn: https://mail.mozilla.org/pipermail/rust-dev/2013-August/005125.html
[03:38:58] *** Joins: mreid (mreid@moz-5F4A70CA.yipyip.com)
[03:39:30] <cmr> Personally I think anything except #1 is insane
[03:40:36] <sanxiyn> cmr: #1 is that once .next() returns None, it keeps returning None and is idempotent?
[03:40:42] <cmr> sanxiyn: yes
[03:41:45] <engla> #2 seems ok or #1 with a loose interpretation (as in, Zip doesn't need any fuse flag)
[03:42:03] *** Quits: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de) (Ping timeout)
[03:42:31] <cmr> I'd be ok with #2 but side-effects are yucky
[03:42:46] <Eridius> #2 is dangerous because most users won't even consider the side-effect issue
[03:42:54] <cmr> and not providing guarantees about them seems to be a surefire way to shoot yourself in the foot in a generic impl
[03:43:08] <Eridius> #1 is nice because it's what uses will tend to assume, but it rather complicates the iterator adaptor implementations
[03:43:11] <Eridius> and it's inflexible
[03:43:17] <cmr> Eridius: Why does it complete adaptors?
[03:43:26] <cmr> Once the thing you're iterating over returns None, stop
[03:43:37] <Eridius> cmr: you have to keep state that indicates whether you've returned None in the past
[03:43:47] <cmr> Eridius: Only if you have side effects
[03:44:04] <Eridius> cmr: you don't know if the iterator you're wrapping has side-effects
[03:44:26] <Eridius> in the case of Skip or Take, yeah, that's easy, since you return None before even querying your underlying iterator
[03:44:27] <cmr> Ohh I see what you're saying now
[03:44:33] <strcat> vector iterators can't do prev
[03:44:35] <cmr> Yeah that would be messy
[03:44:36] <Eridius> but in most other adaptors you call .next() on the underlying iterator before deciding if you should return None
[03:44:37] <engla> I think the adaptors that have to change are rather few
[03:44:41] <Eridius> strcat: no?
[03:44:44] <strcat> no
[03:44:46] <strcat> you can clone them
[03:44:46] <Eridius> why not?
[03:44:53] <strcat> because they don't know where the vector start is?
[03:45:01] <Eridius> ahh
[03:45:02] <strcat> that's not part of the abstraction
[03:45:05] <strcat> they are like a slice
[03:45:14] <strcat> next() is like popping from the start
[03:45:23] <Eridius> ok that's a good point. you'd have to add an extra field, and it's probably not worth it
[03:45:32] <strcat> well also because you can just clone them
[03:45:35] <strcat> D calls it 'save'
[03:45:40] <Eridius> but, say, a char iterator that supports a single .push_back() would be potentially useful for parsing things
[03:45:52] <tikue> hey guys, I wrote a _naive_ prime number iterator, and I was wondering if any of you might have some input on it in terms of ways it could be written better -- not from an algorithmic standpoint but from a rustic/rusty/rust-ish standpoint -- https://gist.github.com/tkuehn/c82d64f2093dc81f7102#file-primes-rs
[03:46:31] <cmr> tikue: make it generic!
[03:46:38] <tikue> cmr: what do you mean :)
[03:46:48] <Eridius> do we have a trait that means integral numeric type?
[03:46:52] <Eridius> if so, use that instead of uint
[03:47:15] <cmr> tikue: All you need is an object that supports the Rem trait
[03:47:29] <tikue> cmr: Rem? I've never heard of that :P 
[03:47:34] <cmr> std::ops::Rem
[03:47:40] <cmr> is trait that drives %
[03:47:51] <goffrie> cmr: also has to be incrementable (or similar), no?
[03:47:53] <strcat> Eridius: in D terms, an Iterator impl is an InputRange and one with Clone is a ForwardIterator
[03:47:57] <sanxiyn> Eridius: I think you can implement undo-like behavior if you can clone iterator
[03:48:01] <strcat> because you can iterate over the sub-ranges any number of times
[03:48:03] <strcat> via saving
[03:48:24] <cmr> goffrie: not in the current implementation, but it would need to be to be generic yes
[03:48:27] <Eridius> sanxiyn: occasionally .push_back() is (ab)used to push a character back other than the one that was consumed ;)
[03:48:37] <sanxiyn> Eridius: Ugh
[03:49:00] <tikue> cmr: can you explain to me what Rem does?
[03:49:08] <strcat> rusti: use std::iterator::*; for (x, y) in range(0, 10).zip(range(0, 2).cycle()) { printfln!("%d %d", x, y) }
[03:49:09] <tikue> cmr: or can you point me to somewhere I can read about it or something
[03:49:09] -rusti- pastebinned 11 lines of output: http://sprunge.us/fDDC
[03:49:13] <cmr> tikue: it's the modulo operator, x % y
[03:49:18] <tikue> cmr: oh oh ok
[03:49:19] <Eridius> also you can't necessarily clone your iterator. If this hypothetical iterator is yielding chars from a file descriptor, you can't clone it
[03:49:26] <mihneadb> cmr: I was tring to write the prototype of a function that takes Iter<T: Clone, Eq> (for the freq count function)
[03:49:33] <strcat> Eridius: you can
[03:49:36] <mihneadb> cmr: was goign with fn freq_count<T>(iter: Iterator<T: Clone, Eq>) { 
[03:49:39] <cmr> mihneadb: it's <T: Clone+Eq>
[03:49:45] <mihneadb> ah
[03:49:46] <strcat> Eridius: if you can implement prev() you can implement clone() instead
[03:49:46] <mihneadb> ok
[03:49:47] <tikue> cmr: why would I want it to be generic though? all primes are integers no?
[03:50:01] <Eridius> strcat: this isn't about .prev() this is about .push_back()
[03:50:03] <cmr> tikue: Only in your silly world where integers are the only numeric type ;)
[03:50:04] <strcat> Eridius: oh
[03:50:09] * strcat wasn't following
[03:50:10] <mihneadb> cmr: also rustc suggests ~Iterator or @Iterator, but I m not sure why. might be just because of my mistake of Clone, Eq?
[03:50:11] <tikue> lol :P
[03:50:12] <cmr> tikue: There are lots of things that behave like numbers that aren't numbers
[03:50:18] <aatch> tikue, you could have it work over bigints too.
[03:50:19] <cmr> mihneadb: Nope
[03:50:20] <tikue> that's a fair point
[03:50:24] <Eridius> strcat: I acknowledge your point that .prev() is irrelevant in the face of clonable iterators
[03:50:25] <tikue> aatch: how?
[03:50:29] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[03:50:31] *** Joins: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net)
[03:50:38] <cmr> mihneadb: fn freq_count<T: Iterator<U>, U: Clone+Eq>(...)
[03:50:39] <sanxiyn> Eridius: I think you are looking for something like tee
[03:50:43] <strcat> Eridius: yeah I just wasn't keeping up with the conversation :)
[03:50:48] <sanxiyn> (i.e. saving result from some speicifc point)
[03:50:51] <goffrie> cmr: but tikue's iterator only works for the integers' notion of prime :P
[03:50:55] <cmr> mihneadb: Iterator is a trait, so you need it either as a trait object, or as a parameter
[03:50:56] <Eridius> tikue: why are you using this divs thing instead of just iterating over your existing primes list?
[03:51:08] <mihneadb> cmr: ah, ok
[03:51:11] <strcat> http://docs.python.org/3.3/library/itertools.html#itertools.tee
[03:51:11] <goffrie> Eridius: divs is the list of candidates
[03:51:16] <Eridius> sanxiyn: I'm not looking to save off chars. Just have the ability to push back a single consumed char
[03:51:18] <tikue> Eridius: what goffrie said
[03:51:31] <strcat> can we actually implement tee without hacks?
[03:51:33] <Eridius> ahhh
[03:51:34] <cmr> tikue: talk to bjz or jensnockert about it, they're the numerics people
[03:51:37] <Eridius> sorry I didn't read carefully
[03:51:42] <tikue> np
[03:51:44] <strcat> hm
[03:51:45] <sanxiyn> strcat: Depending on what you consider to be a hack
[03:51:47] <bjz> hoy
[03:52:04] <bjz> tikue: hurro, did you need me?
[03:52:24] <Eridius> tikue: quick optimization: slap a .take_while(|x| *x <= i / 2) into your iterator pipeline
[03:52:26] <strcat> hmm
[03:52:31] <Eridius> no sense testing primes that are greater than half your candidate
[03:52:41] <strcat> you only need sqrt(n) + 1
[03:52:46] <tikue> Eridius: true 
[03:52:47] <Eridius> oh right sqrt, not half. thanks strcat 
[03:52:51] <tikue> :P
[03:52:53] <strcat> er
[03:52:55] <strcat> made not + 1
[03:53:00] <Eridius> so .take_while(|&x| x*x <= i)
[03:53:03] <sanxiyn> You actually don't need sqrt. Test x * x < n
[03:53:05] <sanxiyn> yup
[03:53:09] <tikue> bjz: hey, I'm not sure :P 
[03:53:13] <strcat> sanxiyn: yeah, that
[03:53:18] <tikue> Eridius: that would go before find right?
[03:53:21] <Eridius> yep
[03:53:26] <cmr> sanxiyn: Wouldn't that overflow comparatively quickly though?
[03:53:27] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Ping timeout)
[03:53:30] <engla> I think for Tee you need to fit your base iterator into a shared box. So it has to be 'static for @mut or or Send/Freeze for RcMut
[03:53:31] *** Joins: bobbyrward (bobbyrward@moz-66B120E.triad.res.rr.com)
[03:53:42] <Eridius> well since you have the transform you'd use |x| not |&x|
[03:53:44] <strcat> you can write a lazy sieve of eratosthenes though
[03:53:44] <sanxiyn> engla: Ugh
[03:53:50] <strcat> I have a python one lying around ;p
[03:54:01] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[03:54:04] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[03:54:18] <Eridius> strcat: those get kind of nasty
[03:54:23] <strcat> one implementation of tee would have ~[] internally, and put the elements in it lazily
[03:54:28] <strcat> and yield &T instead of T
[03:54:42] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[03:54:47] <strcat> Eridius: not really that bad
[03:54:47] <tikue> holy moley
[03:54:49] <tikue> huge speedups
[03:54:51] <tikue> from the take_while
[03:54:57] <tikue> xD
[03:54:58] <goffrie> strcat: would that basically be a list of primes and a slice in that list (of primes that are less than sqrt(current))
[03:55:05] <strcat> tikue: still much slower than a sieve ;p, like orders of magnitudes slower
[03:55:06] <Eridius> tikue: :D
[03:55:12] <tikue> strcat: yeah I know
[03:55:16] <tikue> strcat: this is just for fun
[03:55:21] <strcat> goffrie: a lookup table
[03:55:22] <goffrie> strcat: oh no, never mind
[03:55:25] <strcat> sec
[03:55:30] <Eridius> Haskell's Data.Numbers.Primes (primes-0.1.1) implements something called a "lazy wheel sieve", which looks neat
[03:55:35] <strcat> you can use a) a priority queue or b) a lookup table
[03:55:35] <Eridius> maybe implement one of those and stuff it in stdlib?
[03:55:46] <goffrie> hmm, that's pretty cool
[03:55:53] <bobbyrward> I'm trying to get an executable package in a workspace to use a library in the same workspace.  but i'm getting a multiple matching crates error.
[03:56:05] <bobbyrward> (using rustpkg of course)
[03:56:16] <sanxiyn> cmr: Can't overflow, since n didn't overflow and x * x stays less than n
[03:56:24] <strcat> goffrie: http://rosettacode.org/wiki/Sieve_of_Eratosthenes#Using_wheels there are some there
[03:57:03] <cmr> zsh: abort (core dumped)  rustdoc_ng libstd/std.rs
[03:57:06] <cmr> rust why ;_;
[03:57:08] <bobbyrward> Is this something simple I'm screwing up?  Or how do I go about tracking the issue down
[03:57:18] <strcat> cmr: OOM? ;p
[03:57:25] <strcat> gdb knows
[03:57:50] <strcat> Eridius: it doesn't really make sense to have it in the stdlib imo
[03:57:52] <cmr> #1  0x00007ffff39055c8 in abort () from /usr/lib/libc.so.6
[03:57:54] <cmr> #2  0x000000000045d638 in str::__extensions__::meth_18843::to_owned::_fac21418c42e63e6::_0$x2e1$x2e0 () at core.rs:48
[03:57:58] <Eridius> strcat: not even extra?
[03:58:02] <strcat> it's only useful with big integers
[03:58:03] <aatch> Must be OOM, anything else is just a failure. Or a segfault.
[03:58:08] <strcat> and we don't have good big integers
[03:58:13] <Eridius> :/
[03:58:13] <goffrie> hm does rust stdlib have a priority queue?
[03:58:14] <strcat> yet, at least
[03:58:16] <strcat> goffrie: yes
[03:58:23] <strcat> it was my first contribution to rust ;p
[03:58:27] <goffrie> aha, I see it
[03:58:28] <Eridius> goffrie: extra::priority_queue
[03:58:31] <Eridius> strcat: hah
[03:58:42] <cmr> Seems to be so
[03:58:54] <cmr> It doesn't make sense why it'd start doing that now though
[03:58:59] <cmr> all I added was impl extraction..
[03:59:18] <strcat> cmr: tcmalloc/massif can tell you where the memory comes from
[03:59:38] <strcat> Eridius: well, technically it was my 2nd
[03:59:43] <strcat> Daniel Micay (479):
[03:59:45] <strcat>       update syntax/rust.vim for keyword changes
[03:59:47] <strcat>       add priority queue implementation (binary heap)
[03:59:49] <strcat> ;p
[04:00:14] <sanxiyn> strcat: Heh, how do you get such output?
[04:00:15] <tikue> what is the er
[04:00:19] <strcat> sanxiyn: git shortlog
[04:00:23] <sanxiyn> Thanks
[04:00:25] <tikue> protocol for long lines due to pipelining iterators
[04:00:25] <tikue> ?
[04:00:52] <Eridius> strcat: nice commit count
[04:00:55] <engla> tikue: break before the periods
[04:01:15] <tikue> thx
[04:02:22] <cmr> So I seem to be getting an OOM cloning a structure
[04:02:36] *** Quits: ivan (ivan@moz-531C3EC9.members.linode.com) (Ping timeout)
[04:02:49] <tikue> does python have an equivalent of rusts iter().find_()
[04:02:54] <engla> tikue: it looks nice like this https://github.com/mozilla/rust/blob/master/src/libstd/rt/uv/net.rs#L115
[04:02:59] <strcat> tikue: no
[04:03:08] <tikue> engla: ah thank you, that does look nice
[04:03:16] <strcat> tikue: https://github.com/thestinger/util/blob/master/iterplus.py ;p
[04:03:51] <tikue> strcat: why aren't those in std::iterator :P
[04:04:03] <strcat> they require more thought in rust
[04:04:21] <strcat> to make them suitable generic + fast
[04:04:25] <tikue> yea
[04:04:42] <strcat> in python everything is slow anyway
[04:04:47] <tikue> haha true
[04:04:57] <sp3d> cmr: does it somehow contain ~ cycles?
[04:05:13] <cmr> sp3d: How is that possible/
[04:05:19] <sp3d> bad unsafe code?
[04:05:19] <darkf> dear god rustc please compile in under 30 minutes
[04:05:26] <aatch> It's not, without unsafe code.
[04:05:27] <cmr> I am using no unsafe code
[04:05:35] <strcat> tikue: and it's trivial to do n-ary zip, etc. in python
[04:05:35] <cmr> ...that I wrote
[04:05:39] <sp3d> !
[04:05:49] <cmr> it could be the stdlib being bad
[04:05:51] <cmr> but I doubt it
[04:05:59] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[04:06:00] <tikue> valid point
[04:06:02] <cmr> anyway investigating some
[04:06:06] <sp3d> yeah, needs more data I gues
[04:06:07] <sp3d> s
[04:06:17] <strcat> you can actually write n-ary zip in C++11
[04:06:37] <strcat> but it's not very fun to write ;p
[04:06:48] <tikue> heh
[04:07:07] * strcat 's metaprogramming cousin http://en.cppreference.com/w/cpp/utility/tuple/tuple_cat
[04:07:34] *** Joins: ivan (ivan@moz-531C3EC9.members.linode.com)
[04:07:35] <sfackler> haha
[04:08:06] <darkf> hrm so I get a test failure on windows (rust: task failed at 'assertion failed: end <= self.len()', C:\Users\BAK\Desktop\rust\src\libstd\vec.rs:781)
[04:08:21] <darkf> is there a way to like fix or ignore this so I can do more important things like commit a 1-char patch and test it?
[04:08:56] <cmr> darkf: are you running check-fast?
[04:09:05] <darkf> make check-test
[04:09:07] <strcat> rust doesn't fully work on windows
[04:09:18] <darkf> since the license check fails on just check
[04:09:30] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[04:09:36] <strcat> bors only runs check-fast so anything outside ofthat is possibly broken
[04:09:40] *** Quits: ivan (ivan@moz-531C3EC9.members.linode.com) (Ping timeout)
[04:09:43] <strcat> of that*
[04:10:34] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[04:12:38] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[04:13:55] <darkf> ah alright
[04:15:10] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[04:16:12] *** Joins: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de)
[04:16:57] *** Quits: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de) (Connection reset by peer)
[04:17:25] <cmr> strcat: so what about massif? I've never really used it before
[04:21:38] <cmr> Looking at htop memory usage stays at a constant 4%
[04:21:39] <joelteon> aww, man
[04:21:45] <joelteon> I saw comm_adapters and I was all excited
[04:22:51] <cmr> Oh here we go
[04:22:55] <cmr> rust: task 1f43e40 ran out of stack
[04:22:59] <cmr> When I don't compile with -O
[04:24:18] <darkf> man though, even with --disable-optimized this is still painful :D
[04:24:30] <cmr> darkf: --disable-optimized makes the build go slower
[04:24:40] <darkf> ow :\
[04:24:44] <cmr> Unoptimized rust code is really slow
[04:24:50] <cmr> and unoptimized rustc is /reallly/ slow
[04:25:07] <darkf> but but the getting started page says it reduces compilation time
[04:25:11] <Luqman> cmr: it's useful if I want to build only up to stage1 to test something
[04:25:16] *** Parts: jeff (jeff@moz-FC89C5BA.nycmny.east.verizon.net) ()
[04:25:52] <aatch> Actually I think an unoptimized build is slightly faster now.
[04:26:07] <aatch> not by much, I'll grant
[04:27:02] <cmr> it's still slower than valgrind it looks like
[04:28:34] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[04:28:40] <cmr> Aha found the source of my stack exhaustion
[04:28:53] <cmr> Compiling with optimizations inlined the infinte loop
[04:28:55] <cmr> impl<T: Clean<U>, U> Clean<U> for @T {
[04:28:57] <cmr>     pub fn clean(&self) -> U {
[04:28:59] <cmr>         self.clean()
[04:29:01] <cmr>     }
[04:29:03] <cmr> }
[04:29:07] <aatch> Oh, that bug.
[04:29:19] <aatch> "bug"
[04:29:27] <cmr> well, not loop, but recursion
[04:29:45] <aatch> it would be nice to have a lint for that...
[04:29:55] <aatch> at least for simple cases.
[04:30:17] <aatch> like that one ^
[04:30:24] <cmr> It's obnoxious when you can't implement a trait for both T and @T at the same time, and apparently can't share the implementation either
[04:30:47] * cmr ctrl-c's gdb after it faithfully prints 200k stack frames
[04:30:49] <aatch> cmr, well you should be able to do (*self).clean() ?
[04:31:18] <engla> what about (**self).clean() ?
[04:31:19] <engla> :)
[04:31:37] <aatch> hmm... not sure.
[04:31:50] <aatch> Should work.
[04:31:51] <cmr> no, neither of those work
[04:31:58] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:31:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/EVp0Ag
[04:31:59] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:33:15] <aatch> cmr, what does (**self).clean() say?
[04:33:16] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[04:33:23] <joelteon> how do I debug why rust_get_current_task is failing?
[04:33:24] <cmr> aatch: nothing, just blows the stack
[04:33:39] <aatch> cmr, so same issue? compiles but is infinite loop?
[04:33:47] <cmr> aatch: infinite recursion yes
[04:33:58] <cmr> actually I may have forgotten to copy the executasble
[04:34:00] <cmr> let me try again
[04:34:13] <aatch> With the double de-ref it should be fine.
[04:34:29] <engla> yes, it's going to work
[04:34:43] <aatch> (I.E. de-refing the `&` and then the `@`)
[04:34:57] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[04:34:57] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/2Q-AzA
[04:34:57] <ghrust> 13rust/06auto 149c39992 15Luqman Aden: Add support for vanilla linux on arm.
[04:34:57] <ghrust> 13rust/06auto 1483d2a04 15bors: auto merge of #8220 : luqmana/rust/arm-linux, r=cmr...
[04:34:57] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[04:35:06] <cmr> Ok yeah that worked
[04:35:16] <cmr> Obnoxious but I only have myself to blame
[04:35:18] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Quit: WeeChat 0.4.2-dev)
[04:35:23] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[04:35:24] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[04:35:25] <cmr> but a lint for that would be very nice
[04:35:43] <aatch> cmr, like I said, there's not much you can do about it, other than emit a warning.
[04:36:41] <aatch> (Since semantically it's identical to `fn foo(bar: int) -> int { foo(bar) }`)
[04:37:00] <ldunn> cmr: hi?
[04:37:17] <cmr> ldunn: Hi! I was going to ask if you'd like me to include `kern` in TWiR
[04:37:44] <bjz_> jeaye: ping
[04:37:54] <ldunn> oh, sure, if you think it's interesting
[04:38:18] <cmr> it's bare-metal rust, of course it's interesting :)
[04:38:25] <ldunn> The code's probably poor (I haven't really looked at rust before)
[04:38:46] <ldunn> but yeah, go for it
[04:39:38] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Connection reset by peer)
[04:39:53] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:40:20] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[04:42:01] *** Joins: ivan (ivan@moz-531C3EC9.members.linode.com)
[04:42:10] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[04:42:30] <sanxiyn> What is `kern`?
[04:42:41] <cmr> https://github.com/ldunn/kern/
[04:43:32] <joelteon> I don't know why I'm getting this error https://gist.github.com/joelteon/6153570
[04:43:38] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[04:43:51] <cmr> joelteon: are you running with RUST_NEWRT=1 ?
[04:44:27] <joelteon> yep
[04:44:36] <joelteon> that's in my zshrc now
[04:48:51] <ChemicalHarm> (sorry if I'm breaking protocol asking this--complete newb here, feel free to push me to the right spot): if I want to build a crate that links to an external C library, I can't use rustpkg to do it yet, right?  As in, that's not even expected to work right now?
[04:49:12] <cmr> ChemicalHarm: correct
[04:49:17] <aatch> ChemicalHarm, this is the right place to ask
[04:49:21] <ChemicalHarm> thanks
[04:49:22] <cmr> ChemicalHarm: Well, no, it works
[04:49:30] <cmr> You just can't *build* that external library with rustpkg
[04:49:52] <ChemicalHarm> I can get it to build my own code, but I can't find a way to tell it where to find the external C lib that I didn't write and is just installed by my package manager
[04:51:16] <aatch> ChemicalHarm, do you have `#[link_name="external_name"]` on the `extern { ... }` block?
[04:52:29] <ChemicalHarm> Yes.  But it causes rustpkg tries to look for a rust package with the name of my C library, and complains when it can't find it.
[04:52:36] <cmr> Ahh
[04:52:41] <cmr> So yeah that's probably broken right
[04:52:43] <cmr> *right now
[04:52:57] <cmr> I didn't know it looked for a package for extern blocks too
[04:53:10] <Luqman> maybe try #[link_args = "-lexternal_name"] instead
[04:53:17] <aatch> ChemicalHarm, ok. Well try changing it to `#[link_args="-lexternal_name"]`
[04:53:28] <aatch> Luqman, beat me to it.
[04:53:55] * aatch should really try using rustpkg at some point.
[04:54:12] <cmr> it's decently usable now
[04:54:30] <cmr> rough around the edges, but usable
[04:54:43] <ChemicalHarm> that's actually what I had...with the -l...actually it looks like it's not rustpkg looking for a package now.  It just tries to link and can't find the library
[04:55:08] <aatch> cmr, "rough around the edges" could describe a lot of rust
[04:55:13] <cmr> aatch: yup
[04:55:21] <cmr> aatch: could almost call it... rusty
[04:55:23] <ChemicalHarm> since the error message spits out what it passed to cc to link it, I could actually link it myself by adding the right -L flag to give it the path
[04:55:33] <ChemicalHarm> but there seems to be no way to tell rustpkg to do that
[04:55:46] <cmr> ChemicalHarm: you can add the -L in the #[link_args]
[04:55:58] <cmr> it literally passes that string to t he linker
[04:56:06] <ChemicalHarm> I see...
[04:57:08] <sfackler> cmr: infinite build loops unstable :P
[04:58:17] <mihneadb> cmr: so right now if my function takes in an Iterator it means I have to pass in something.iter(). But in the future the .iter() layer will disappear
[04:58:19] <mihneadb> ?
[04:58:48] <ChemicalHarm> cmr: that worked!  Thanks!
[04:58:50] <cmr> mihneadb: not sure, but you only need to pass in .iter() if the thing you have doesn't already implement Iterator
[04:59:06] <cmr> strcat: Iterable will implement Iterator yeah?
[04:59:13] <mihneadb> cmr: right, makes sense
[04:59:14] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0/20130729175331])
[04:59:16] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:59:18] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Client exited)
[04:59:45] <mihneadb> cmr: who implements Iterator right now?
[04:59:58] <mihneadb> I tried passing in a str and a HashMap, none worked
[05:00:00] <mihneadb> but .iter() works
[05:00:09] <cmr> mihneadb: there are tons of iterator adaptors, like Filter and Map and Chain and such
[05:00:10] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:00:10] *** ChanServ sets mode: +o brson
[05:00:16] <mihneadb> cmr: ah, I see
[05:00:21] <cmr> mihneadb: but you need a separate iterator object to iterate over a data structure
[05:00:34] <mihneadb> cmr: when I do let str = "Hello", what is the type of str? Str or &Str?
[05:00:42] <cmr> &'static str
[05:00:43] <brson> <3
[05:00:46] <cmr> lower-case str
[05:00:50] <darkf> ok i opened a pullreq for my one char patch, whoo
[05:00:54] <cmr> Str is a trait
[05:01:13] <mihneadb> cmr: what's the apostrophe ?
[05:01:20] <darkf> lifetime i believe
[05:01:25] <aatch> darkf, correct
[05:01:27] <cmr> mihneadb: "Named lifetime". static means it lives for the whole program
[05:01:41] <mihneadb> static, yes, but why the apostrophe? :)
[05:01:46] <mihneadb> or do they come together
[05:01:47] <darkf> that's the syntax
[05:01:53] <cmr> just the syntax
[05:01:54] <darkf> &'a would be another lifetime
[05:02:00] <mihneadb> ok
[05:02:10] <cmr> For example &mut vs &'mut mut
[05:02:20] <aatch> (for the record, we went through other syntaxes before setting on that one)
[05:02:27] <mihneadb> :)
[05:02:34] <darkf> i do recall the abhorrent "argument mode" syntax
[05:02:59] <mihneadb> I did not encounter any docs on the lifetime stuff yet
[05:03:01] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[05:03:10] <cmr> http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html
[05:03:14] <strcat> cmr: I don't think that makes sense
[05:03:22] <mihneadb> ahaa
[05:03:30] <mihneadb> there's a whole tutorial on that ,nice
[05:03:31] <mihneadb> ty
[05:04:30] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[05:05:04] <cmr> strcat: I don't really understand what Iterable is tbh
[05:05:08] <cmr> is/will be
[05:05:11] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:05:11] *** ChanServ sets mode: +o brson
[05:05:17] <strcat> cmr: containers with an iterator
[05:05:28] <strcat> the iter method
[05:05:28] <cmr> strcat: So like python's __iter__ magic method?
[05:05:33] <strcat> yes
[05:05:37] <cmr> ok, that makes sense
[05:06:14] <mihneadb> cmr: so.. for this, it tells me that it wants a mutable iter http://pastebin.mozilla.org/2784534
[05:06:22] <mihneadb> 1. why, 2. where would "mut" go?
[05:06:46] <cmr> mihneadb: 1. Because iterating over something modifies the state of the iterator, 2. fn ...(mut iter: T)
[05:06:53] <mihneadb> ah
[05:06:54] <mihneadb> mut iter
[05:06:56] <mihneadb> I did mut T
[05:06:58] <cmr> yup
[05:06:59] <mihneadb> why isn't the T mut?
[05:07:02] <cmr> it's just like `let mut`
[05:07:05] <mihneadb> right
[05:07:08] <mihneadb> syntax
[05:07:19] <cmr> It has to do with inherited mutability
[05:07:24] *** Quits: RMF (RMF@moz-713EF9F4.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[05:07:43] <cmr> since it owns the T, mutability isn't part of the type, it's part of where the type is stored ("slot")
[05:07:55] <cmr> `mut iter` puts it in a mutable slot
[05:08:17] *** Joins: RMF (RMF@moz-713EF9F4.dsl.telepac.pt)
[05:08:51] <mihneadb> cmr: makes perfect sense, thanks
[05:09:14] <mihneadb> I should stop writing rust code before going to sleep 
[05:11:06] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[05:11:59] <engla> mihneadb: it's smart to prime your dreams so they are about rust
[05:12:11] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[05:12:50] <tikue> dreaming about programming makes me anxious :(
[05:13:07] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[05:14:49] *** Joins: jaen (jaen@moz-58248497.play-internet.pl)
[05:18:37] *** Quits: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP) (Quit: Leaving)
[05:22:27] *** Joins: sebcrozet (sebcrozet@moz-D8879CC3.w80-13.abo.wanadoo.fr)
[05:25:37] *** Quits: jaen (jaen@moz-58248497.play-internet.pl) (Ping timeout)
[05:25:50] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[05:27:17] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[05:28:04] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[05:28:59] <mihneadb> haha
[05:30:11] <tikue> strcat: I don't know if you commented on this earlier or not, but is adding `yield` something you believe will be doable eventually?
[05:30:56] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:31:41] <tikue> would it have to return ~Iterator, thus making it inherently slower than rolling your own? or could there just be some generic Iterator that could be used in those cases
[05:31:49] <tikue> GeneratorIterator or something
[05:31:59] <cmr> Generatoritor
[05:32:06] <tikue> rofl
[05:32:13] <tikue> Generitor
[05:32:16] <tikue> Generiter
[05:33:34] <tikue> so the type signature when rolling your own would be, for instance, GeneratorIter<uint> or such
[05:37:02] <strcat> tikue: it wouldn't use ~Iterator if it did exist, that's too slow
[05:37:07] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[05:37:39] <strcat> there's no reason it couldn't exist in a proper form beyond needing someone to spend ages implementing it
[05:38:04] <bobbyrward> How would I get debug!'s in librustc out to stderr/out?
[05:38:22] <cmr> bobbyrward: compile with the configure optoin --enable-debug, RUST_LOG=rustc=4
[05:38:35] <cmr> (run with RUST_LOG=rustc=4, that is)
[05:38:56] <bobbyrward> perfect.  i was using 0 not 4
[05:40:17] <tikue> strcat: maybe 2.0, then :)
[05:40:55] <darkf> oh dear i also added a couple functions to extra::flate as well
[05:41:16] <darkf> when someone is bored could they review my (very short) pull reqs? (#8298 and #8301)
[05:42:36] *** Joins: jaen (jaen@moz-3DDD7E4C.play-internet.pl)
[05:44:16] <cmr> rustdoc_ng is now feature complete, extracting every item which can be documented and accessed
[05:44:52] <aatch> cmr, woo
[05:45:13] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[05:45:17] <darkf> nice
[05:49:39] *** Quits: jaen (jaen@moz-3DDD7E4C.play-internet.pl) (Quit: WeeChat 0.4.1)
[05:53:51] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Client exited)
[05:58:04] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[05:58:06] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[05:59:53] <bobbyrward> what causes "multiple matching crates"?  specfically the same file being matched twice
[06:02:28] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[06:02:52] *** Joins: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[06:02:57] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[06:05:29] *** Joins: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP)
[06:06:20] *** Quits: bobbyrward (bobbyrward@moz-66B120E.triad.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[06:07:52] *** Joins: jaen (jaen@moz-CD4BD3B3.neoplus.adsl.tpnet.pl)
[06:09:51] <sfackler> Are you sure it's the exact same fil? When ever I've run into that, it's either two versions of the library with different hashes or the same version in two directories
[06:09:54] <sfackler> *file
[06:09:57] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:11:35] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[06:13:37] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[06:14:01] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:14:01] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2Q-AzA
[06:14:01] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:17:00] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:17:01] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/h6T1VA
[06:17:01] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:17:04] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[06:17:04] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/dkGfeA
[06:17:04] <ghrust> 13rust/06auto 14d123df2 15Brian Anderson: std: Fix newsched logging truncation...
[06:17:04] <ghrust> 13rust/06auto 14167bdff 15Brian Anderson: std::rt: Schedule more scheduler callbacks to avoid dropping messages
[06:17:05] <ghrust> 13rust/06auto 144fdd720 15bors: auto merge of #8299 : brson/rust/yet-more-newsched-fixes, r=brson
[06:17:07] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[06:17:29] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[06:21:48] *** Joins: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net)
[06:23:25] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Ping timeout)
[06:25:03] <mihneadb> cmr: https://www.refheap.com/17236
[06:25:05] <mihneadb> so..
[06:25:14] <mihneadb> I was expecting elem to be &U
[06:25:20] <mihneadb> why is it not &U?
[06:26:55] <aatch> mihneadb, can you paste that to somewhere that loads?
[06:27:11] <mihneadb> :S loads fine for me, I ll put it on pastebin.mo
[06:27:30] <mihneadb> http://pastebin.mozilla.org/2784935
[06:27:31] <mihneadb> there we go
[06:28:08] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[06:28:33] <aatch> mihneadb, in an iterator, the type paramater is what it returns
[06:28:43] <mihneadb> oh
[06:29:11] <mihneadb> aatch: so.. should I do map.find(&elem) or change the type of the iter?
[06:29:31] <aatch> mihneadb, do `map.find(&elem)`
[06:30:07] <aatch> mihneadb, also, you don't have a return type on that
[06:30:14] <mihneadb> aatch: was working on that :)
[06:30:21] <mihneadb> wroks with HashMap<U, uint>
[06:30:27] <mihneadb> but could I somehow do a Map?
[06:30:30] <mihneadb> (Trait)
[06:31:00] <aatch> mihneadb, yep.
[06:31:08] <mihneadb> aatch: how?
[06:31:13] <mihneadb> it asks for a pointer type in front of it
[06:31:23] <mihneadb> down to http://pastebin.mozilla.org/2784936
[06:31:24] <aatch> mihneadb, You want to add it as a type parameter.
[06:32:01] <mihneadb> aatch: oh.. ok
[06:32:25] <gavinb> Running "rust" from master tip by itself on OS X aborts with: rust(6733,0x10c5c6000) malloc: *** mmap(size=18374686477717901312) failed (error code=12)
[06:32:25] <mihneadb> let's see if I can nail the syntax
[06:32:44] <gavinb> Running "rust --help" does a "Segfault: 11"
[06:32:51] <mihneadb> gavinb: which hash? I m on dc5b0b94101 and it works
[06:32:53] <gavinb> This is after doing a clean make
[06:33:03] <aatch> mihneadb, actually, that wont work because there's no way to construct the map
[06:33:18] <gavinb> mihneadb: f28e581
[06:33:52] <mihneadb> gavinb: I think there's some newer revisions over that. 
[06:34:11] <mihneadb> (I am on the 3rd after it.. if I can count)
[06:34:15] <mihneadb> aatch: so how should I do this
[06:34:28] <gavinb> mihneadb: aha, ok - things must be changing fast - it was only a little while ago I fetched
[06:34:34] <aatch> mihneadb, either stick to a concrete implementation
[06:34:43] <mihneadb> gavinb: not saying that will fix your problem :)
[06:34:50] <gavinb> mihneadb: although - the "rust --help" crash has been there for at least a week (since I noticed it)
[06:35:11] <mihneadb> gavinb: I encountered what you are describing with the release rust (brew install rust)
[06:35:20] <gavinb> mihneadb: Does "rust --foo" crash for you?
[06:35:24] <aatch> gavinb, it was definitely fixed.
[06:35:30] <mihneadb> gavinb: no, it does not
[06:35:50] <gavinb> aatch: ok thanks, will update again
[06:36:08] <aatch> mihneadb, or, take an existing map to insert into.
[06:36:11] <mihneadb> aatch: so why wouldn't a type parameter work?
[06:36:35] <mihneadb> if I require type T: Map
[06:36:38] <aatch> mihneadb, no way to construct the Map inside the function. There's no function on Map to create an empty one (that I can see)
[06:36:56] <mihneadb> ah, it will only see the methods on the trait
[06:37:06] <aatch> mihneadb, exactly.
[06:37:11] <mihneadb> then I'll leave it like this for now and see on review
[06:38:56] <mihneadb> I m out, thanks for helping!
[06:39:04] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Input/output error)
[06:39:55] *** Joins: Axord (xord@moz-54F934BB.lsanca.dsl-w.verizon.net)
[06:43:45] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[06:46:14] *** Joins: leaper (Mibbit@moz-2B18508A.kla-tencor.com)
[06:47:24] *** Quits: MiguelD (MiguelD@2ACDA535.A137FB69.46937063.IP) (Ping timeout)
[06:56:23] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[06:59:47] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[07:00:06] <leaper> could someone please help me with this wierd issue? http://mibpaste.com/7FmIgK 
[07:00:13] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[07:00:18] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[07:01:33] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[07:03:34] *** Joins: MiguelD (MiguelD@2ACDA535.A137FB69.46937063.IP)
[07:04:14] <sfackler> leaper: that website doesn't seem to load for me
[07:05:23] <leaper> sfackler: me too, i'll try a different site
[07:06:54] <leaper> heres a gist: https://gist.github.com/anonymous/6153996
[07:09:41] <leaper> made a mistake: a new gist https://gist.github.com/anonymous/6154001. 
[07:10:00] <leaper> * https://gist.github.com/anonymous/6154001
[07:11:24] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:12:03] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[07:12:43] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[07:14:07] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Ping timeout)
[07:14:59] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[07:15:30] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:20:07] *** Quits: thomaslee (thomaslee@moz-306D3DF4.hsd1.or.comcast.net) (Connection reset by peer)
[07:21:31] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[07:23:04] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Quit: Lost terminal)
[07:31:51] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[07:32:04] *** Joins: azita (Azita@C828EC68.8E67A50A.508D426F.IP)
[07:32:45] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[07:34:17] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[07:34:57] *** Quits: MiguelD (MiguelD@2ACDA535.A137FB69.46937063.IP) (Quit: KVIrc 4.1.3 Equilibrium http://www.kvirc.net/)
[07:36:16] *** Quits: Axord (xord@moz-54F934BB.lsanca.dsl-w.verizon.net) (Ping timeout)
[07:37:07] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Ping timeout)
[07:37:27] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[07:38:23] *** Joins: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net)
[07:38:43] *** Quits: tikue (tkuehn@moz-CF8BEBEF.dia.static.qwest.net) (Quit: tikue)
[07:40:00] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[07:40:53] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz)
[07:41:07] *** Joins: mib_vxeoc0 (Mibbit@45309175.95546F04.BFD9ED3C.IP)
[07:48:17] *** Joins: rust_noob (Mibbit@moz-72A1FE21.hiway.at)
[07:48:55] <rust_noob> hi! is there a function that "shuffels" a vector (randomizing it's order)?
[07:48:57] *** Joins: mib_9n3vh9 (Mibbit@moz-2B18508A.kla-tencor.com)
[07:52:17] <Luqman> rusti: use std::rand; use std::rand::RngUtil; let mut x = [0, 1, 2, 3]; let mut rng = rand::rng(); rng.shuffle_mut(x); x
[07:52:18] -rusti- [3, 1, 2, 0]
[07:52:41] <Luqman> rusti: use std::rand; use std::rand::RngUtil; let mut x = [0, 1, 2, 3]; let mut rng = rand::rng(); rng.shuffle_mut(x); x
[07:52:41] -rusti- [2, 0, 1, 3]
[07:52:46] <Luqman> rust_noob: ^
[07:52:52] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[07:53:02] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:53:02] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/dkGfeA
[07:53:03] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:53:04] <rust_noob> nice! thank you a lot! ;)
[07:54:03] *** Quits: mib_9n3vh9 (Mibbit@moz-2B18508A.kla-tencor.com) (Quit: http://www.mibbit.com ajax IRC Client)
[07:55:58] *** Quits: rust_noob (Mibbit@moz-72A1FE21.hiway.at) (Quit: http://www.mibbit.com ajax IRC Client)
[07:56:01] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:56:01] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PzEG_w
[07:56:01] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:56:05] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[07:56:05] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/eZRemg
[07:56:05] <ghrust> 13rust/06auto 141c1add2 15Brian Anderson: std::rt: Use magic to make TLS work from annihilated boxes. #8302
[07:56:05] <ghrust> 13rust/06auto 147b2163d 15bors: auto merge of #8303 : brson/rust/tls-magic-wtf, r=brson
[07:56:06] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[07:58:06] *** Quits: mib_vxeoc0 (Mibbit@45309175.95546F04.BFD9ED3C.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:58:11] *** Quits: azita (Azita@C828EC68.8E67A50A.508D426F.IP) (Quit: azita)
[08:01:23] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[08:02:01] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[08:07:53] *** Joins: DoomBoom (DoomBoom@6B14631A.ACEC7723.5D1D3FEF.IP)
[08:13:17] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[08:16:45] *** Quits: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP) (Quit: Leaving.)
[08:18:24] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:21:50] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:26:37] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:26:59] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[08:31:01] *** Joins: rust-noob (Mibbit@moz-72A1FE21.hiway.at)
[08:32:27] <rust-noob> hey! it's me again ;) I've got another question: How do I sum all uints in a vector? fn sum(v: ~[uint]) -> uint
[08:35:20] <doener> rusti: let x = [1,2,3,4,5,6]; x.iter().fold(0, |a,&v| a+v)
[08:35:21] -rusti- 21
[08:35:37] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[08:35:56] <rust-noob> thanks! what does the fold() method exactly do?
[08:37:21] <doener> rust-noob: calls the given closure for each element in the iterator, first argument is the accumulator whose initial value is the first argument to fold(). Second argument to the closure is a pointer to the element itself
[08:38:30] <doener> rusti: let x = [1,2,3,4,5,6]; x.iter().sum();
[08:38:31] -rusti- <anon>:5:32: 5:47 error: type `std::vec::VecIterator<,<VI5>>` does not implement any method in scope named `sum`
[08:38:31] -rusti- <anon>:5          let x = [1,2,3,4,5,6]; x.iter().sum();
[08:38:31] -rusti-                                          ^~~~~~~~~~~~~~~
[08:38:31] -rusti- error: aborting due to previous error
[08:38:31] -rusti- application terminated with error code 101
[08:38:49] <rust-noob> doener: thank you!!!
[08:39:10] <doener> rusti: use std::iterator::AdditiveIterator; let x = [1,2,3,4,5,6]; x.iter().sum();
[08:39:11] -rusti- <anon>:5:69: 5:84 error: failed to find an implementation of trait std::ops::Add<&int,&int> for &int
[08:39:11] -rusti- <anon>:5          use std::iterator::AdditiveIterator; let x = [1,2,3,4,5,6]; x.iter().sum();
[08:39:11] -rusti-                                                                               ^~~~~~~~~~~~~~~
[08:39:11] -rusti- application terminated with error code 101
[08:39:30] <dbaupp> rusti: use std::iterator::AdditiveIterator; let x = ~[1,2,3,4]; x.iter().transform(|&x| x).sum()
[08:39:30] -rusti- 10
[08:39:57] <doener> meh, that's longer than the manual fold
[08:40:37] <nielsle> Will this eventually become ~[1,2,3,4].sum() ?
[08:40:59] <rust-noob> nielsle: would be nice to have ;)
[08:43:21] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:46:46] <rust-noob> are there 2 dimensional vectors (aka matrices) available in rust?
[08:47:44] <jensnockert> rust-noob: Not really, but you can easily create a struct that represents them.
[08:48:54] <jensnockert> rust-noob: For example `struct Matrix { data:~[double], n:uint, m:uint }'
[08:50:50] <rust-noob> thank you! 
[08:51:30] <rust-noob> I'm going to try it out, I don't fully understand it yet ;)
[08:52:08] <sam113101> can't you have a vector of vectors?
[08:54:24] <rust-noob> ok, I don't get it
[08:55:41] <rust-noob> I would need a struct Matrix, but with a dynamic size of N*N
[08:57:31] <rust-noob> I thought of the following: let m = Matrix::build(10); 
[08:57:46] <rust-noob> and then m[1][2] -> element
[09:00:46] *** Quits: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com) (Ping timeout)
[09:00:48] <sebcrozet> rust-noob: you could so: struct Matrix { data: ~[~[double]] }
[09:01:09] <sebcrozet> rust-noob: s/so/do
[09:01:40] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[09:04:10] <sebcrozet> rust-noob: and use `vec::from_fn` and `vec::from_elem` on your matrix constructor to initialize the `data`.
[09:04:38] <rust-noob> ok, I'll try! ;)
[09:09:26] *** Joins: Florob (Florob@moz-39532932.de)
[09:20:59] <rust-noob> I made it!
[09:21:23] <rust-noob> I implemented the matrix as a tuple struct
[09:21:27] <rust-noob> http://static.rust-lang.org/doc/tutorial.html#data-structures
[09:21:43] <rust-noob> it works splendid, thanks for the great tips!!
[09:23:51] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:25:45] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[09:27:19] *** Joins: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch)
[09:35:00] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[09:35:00] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/eZRemg
[09:35:00] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[09:35:12] *** Quits: rust-noob (Mibbit@moz-72A1FE21.hiway.at) (Quit: http://www.mibbit.com ajax IRC Client)
[09:35:16] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[09:36:49] <doomlord> http://pastebin.com/78rFrR4z <<< does this already exist? ' get value from option, or return a given fallback value'
[09:38:00] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[09:38:00] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/SeXF6w
[09:38:00] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[09:38:02] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[09:38:02] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/KTYFeg
[09:38:02] <ghrust> 13rust/06auto 14302e6fe 15Brian Anderson: Turn on the new runtime
[09:38:02] <ghrust> 13rust/06auto 14d7ab540 15bors: auto merge of #8304 : brson/rust/newrt, r=brson...
[09:38:02] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[09:38:38] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[09:43:46] <dbaupp> doomlord: iirc get_or_default
[09:44:01] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[09:44:05] <doomlord> thanks
[09:47:25] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:50:43] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:52:57] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:52:57] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d7ab540 to 147b2163d: 02http://git.io/N3iJvQ
[09:52:57] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:52:59] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[09:52:59] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/pmGffQ
[09:52:59] <ghrust> 13rust/06auto 14d8e74b3 15Dmitry Ermolov: Additional check in treemap iterator test.
[09:52:59] <ghrust> 13rust/06auto 1498a6656 15Dmitry Ermolov: Remove redundant print.
[09:52:59] <ghrust> 13rust/06auto 1473ec9f3 15Dmitry Ermolov: Implemented TreeMap::{lower_bound_iter,upper_bound_iter}...
[09:53:01] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[10:02:29] <ldunn> noo, llvm, don't core dump :(
[10:06:05] <doomlord> if i have a &T, how can i clone it into a ~T;  i tried ~src.clone(),  ~*src.clone(),    ~(*(src.clone()))   T happens to be str
[10:07:29] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[10:09:25] <doomlord> oh, to_str()
[10:09:32] *** Quits: saati (bjb@moz-11469F61.harmless.hu) (Ping timeout)
[10:09:33] <dbaupp> doomlord: or to_owned
[10:09:34] <pnkfelix> doomlord: I don't think the Clone trait handles that use case in general.  The str class has an into_owned() method
[10:09:59] <doomlord> ok to_owned is the general case, better
[10:10:10] <dbaupp> doomlord: (just btw, `str` (and &[]) isn't a normal type, so `&str` can't be separated into & and str.)
[10:11:45] *** Joins: saati (bjb@moz-11469F61.harmless.hu)
[10:14:58] *** Parts: xyproto (alexander@moz-251295DE.members.linode.com) (WeeChat 0.4.1)
[10:28:28] *** Joins: rust-noob (Mibbit@moz-72A1FE21.hiway.at)
[10:29:38] <rust-noob> hi! how do I use vec::from_fn(size, fn)? I can't figure out how to enter the method, eg: test::method(argument)
[10:30:37] <kimundi> rust-noob: two possibilities
[10:30:45] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[10:30:58] <kimundi> vec::from_fn(size, || { ... })
[10:31:11] <kimundi> or fn foo() {} ... vec::from_fn(size, foo)
[10:31:56] <kimundi> that is, you can either write the function you pass inline with the closure syntax, or use a function defined somewhere else
[10:32:43] <kimundi> rusti: vec::from_fn(5, || 4)
[10:32:44] -rusti- pastebinned 11 lines of output: http://sprunge.us/WKae
[10:32:54] <rust-noob> ok, I tried the following: vec::from_fn(10, island::new(1000))
[10:33:09] <rust-noob> whats wrong with that?
[10:33:18] <rust-noob> *Island
[10:33:22] <kimundi> rust-noob: you're not passing a function
[10:33:36] <kimundi> rust-noob: you're passing the result of a function call
[10:33:41] <rust-noob> haha ok ;) so I need the || ? 
[10:34:09] <dbaupp> rust-noob: you could use vec::from_elem, if you're just copying the one thing 10 times.
[10:34:40] <kimundi> yeah, |<args>| <expr> constructs a closure (function that can capture variables)
[10:34:44] <rust-noob> thanks ;) but I wanted to learn how to pass in a function :S
[10:34:46] <rust-noob> :D
[10:35:19] <kimundi> rusti: let f = || print("Hello"); f(); f()
[10:35:20] -rusti- HelloHello()
[10:35:54] *** Joins: heftig (heftig@2995900D.EB04A670.172227A7.IP)
[10:36:02] <rust-noob> the following worked for me, is it correct?
[10:36:09] <kimundi> rusti: let f = |s| print(s); f("Hello\n"); f("...")
[10:36:10] -rusti- Hello
[10:36:10] -rusti- ...()
[10:36:16] <rust-noob> vec::from_fn(N, |n| Island::new_random(1000) );
[10:36:42] <rust-noob> neat, thanks kimundi and dbaupp
[10:36:51] <kimundi> rust-noob: yeah, though if you don't need the n variable you can just ignore it by replacing it with a _
[10:37:15] <kimundi> vec::from_fn(N, |_| Island::new_random(1000) )
[10:37:16] <rust-noob> thanks again, that's cleaner :D
[10:38:09] <rust-noob> so, in my example I could also use vec::from_elem(N, Island::new_random(1000) ), can't I?
[10:38:31] <rust-noob> I need a vector with N random Islands ;)
[10:38:36] <dbaupp> yep
[10:38:42] <rust-noob> thanks :D
[10:38:59] <rust-noob> it's awesome how friendly you guys are, really!
[10:39:14] <dbaupp> (although, for from_elem, you need Island to implement Clone, which you can do automatically with `#[deriving(Clone)] struct Island { ... }`.)
[10:39:31] <rust-noob> why do I need that?
[10:39:35] <dbaupp> ... also, from_elem will make a vector with N of the same islands, so you probably don't want that.
[10:40:03] <dbaupp> you need the Clone because from_elem copies the second argument N times (and copying is done via the Clone trait)
[10:40:05] <kimundi> rust-noob: You're passing in the  result of only one  Island::new_random(1000) call
[10:40:12] <rust-noob> ok, that's what I was afraid of
[10:40:32] <rust-noob> I'm going to use the function version
[10:40:48] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[10:42:05] <dbaupp> is anyone else getting "fatal error: llvm/TableGen/TableGenAction.h: No such file or directory" building LLVM?
[10:42:52] <rust-noob> another thing I would like to ask: How would you implement configuration variables I need in multiple source files? (eg the N)
[10:43:50] <ldunn> neat, I seem to have ~-ptrs on bare metal now. That should be handy :o
[10:45:30] <dbaupp> ldunn: awesome!
[10:46:01] <dbaupp> rust-noob: you can use `static N: uint = 10;` in some source file and import it as you would a fn or struct or enum.
[10:48:51] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[10:49:28] *** Quits: heftig (heftig@2995900D.EB04A670.172227A7.IP) (Quit: Quitting)
[10:50:01] <rust-noob> that sounds good, thank you (again)! :D
[10:51:10] *** Quits: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) (Client exited)
[10:54:11] *** kimundi is now known as zz_kimundi
[10:55:29] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[10:57:57] <orshem> is the pattern '*mut self' supported in an implementation? i can't get it to work
[11:06:41] * Florob shudders at the thought of a raw self pointer
[11:08:13] <orshem> Florob, no choice, it's a hierarchical structure and i couldn't make it work with unique + borrowed
[11:08:29] <orshem> with drop use it should be pretty safe though
[11:08:36] <orshem> at least from dangling refs
[11:11:04] <rust-noob> I get a linking error when trying to use a static variable from one file in another one.
[11:11:25] <rust-noob> file with static variable: static N: uint = 33;
[11:12:23] <rust-noob> other file: extern mod config; use config::N; fn test_N() { println(N.to_str()); }
[11:12:53] <rust-noob> also config::N throws the same error
[11:13:00] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:16:08] <dbaupp> rust-noob: what's the error? (I think I forgot to say `pub static` too.)
[11:16:25] <rust-noob> linking with `cc` failed with code 1
[11:16:37] <dbaupp> rusti: struct Foo; impl Foo { fn foo(*self) {} }
[11:16:37] -rusti- <anon>:5:39: 5:40 error: unexpected token: `*`
[11:16:37] -rusti- <anon>:5          struct Foo; impl Foo { fn foo(*self) {} }
[11:16:38] -rusti-                                                 ^
[11:16:38] -rusti- application terminated with error code 101
[11:16:38] <rust-noob> I'll try the pub version!
[11:16:49] <dbaupp> orshem: seems that it doesn't work.
[11:18:48] <rust-noob> pub works like a charm, thank you!
[11:23:58] *** Joins: heftig (heftig@moz-6E9FB584.dip0.t-ipconnect.de)
[11:24:29] *** zz_kimundi is now known as kimundi
[11:25:26] *** Quits: DoomBoom (DoomBoom@6B14631A.ACEC7723.5D1D3FEF.IP) (Quit: Leaving)
[11:26:16] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[11:26:57] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:28:00] <bjz> rusti: fn f(mut x: int) { x = 4; } let mut y = 1; f(y); y
[11:28:01] -rusti- pastebinned 10 lines of output: http://sprunge.us/PTSG
[11:28:27] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[11:28:55] <bjz> doomlord: ping
[11:29:04] <bjz> doomlord_: ping
[11:29:58] <orshem> dbaupp: is it supposed to?
[11:30:16] * dbaupp doesn't know
[11:30:17] <doomlord> hi
[11:30:39] <orshem> it could get tricky with the auto deref and auto borrow i think
[11:30:45] <bjz> doomlord: I'm trying to look at wrapping bullet
[11:30:55] <doomlord> oh nice
[11:31:06] <dbaupp> orshem: I suspect not: I imagine th advice will be a standalone function, or a static method in the rare case that one needs *mut self.
[11:31:29] <bjz> doomlord: http://bulletphysics.org/Bullet/BulletFull/Bullet-C-Api_8h.html#aceccfa9cfae0fc59c1aa472fbfa4b3cb
[11:31:45] <bjz> doomlord: not sure how to get that quaternion value
[11:32:01] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[11:32:01] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/pmGffQ
[11:32:01] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[11:32:12] <bjz> doomlord: the C api looks pretty ortinary
[11:32:13] <orshem> dbaupp: thanks. how do i allocate memory manually, malloc and free?
[11:32:14] <dbaupp> orshem: but, again, I don't know: you should open an issue, to get it clarified.
[11:32:18] <bjz> *ordinary
[11:32:21] <dbaupp> orshem: yeah
[11:33:30] <dbaupp> rusti: std::rt::global_heap::exchange_malloc(100)
[11:33:30] -rusti- <anon>:5:9: 6:5 error: call to unsafe function requires unsafe function or block
[11:33:31] -rusti- <anon>:5          std::rt::global_heap::exchange_malloc(100)
[11:33:31] -rusti- <anon>:6     };
[11:33:31] -rusti- error: aborting due to previous error
[11:33:31] -rusti- application terminated with error code 101
[11:33:41] <dbaupp> rusti: unsafe {std::rt::global_heap::exchange_malloc(100)}
[11:33:41] -rusti- 140548713220352
[11:34:03] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[11:34:04] <dbaupp> rusti: unsafe {std::rt::global_heap::exchange_free(std::rt::global_heap::exchange_malloc(100))}
[11:34:04] -rusti- ()
[11:34:08] <dbaupp> orshem: ^
[11:34:13] <bjz> doomlord: been doing some looking online, but getting info on the C api is pretty difficult. looking into the source it seems it mutates the parameters.
[11:34:29] <orshem> dbaupp: thanks.
[11:34:32] <doomlord> hmm.
[11:34:34] <dbaupp> orshem: (there's possibly a better way to do it... but I don't know it.)
[11:34:54] <bjz> doomlord: also, the C api looks pretty ancient, and doesn't really look that extensive compared to the rest of bullet
[11:34:56] <orshem> i think unsafe will be needed more than i thought originally because @mut just doesn't really work for cycles or trees
[11:34:58] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[11:34:58] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/WjDHJg
[11:34:58] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[11:35:09] <dbaupp> orshem: the other options is to get a ~T, transmute to *T and then transmute back to ~T when it needs to be freed.
[11:35:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[11:35:41] <dbaupp> orshem: e.g. https://github.com/mozilla/rust/blob/master/src/libextra/rc.rs#L51 and https://github.com/mozilla/rust/blob/master/src/libextra/rc.rs#L81
[11:36:00] <doomlord> is swig up to creating a c wrapper from their c++ stuff. i'm not sure it would be any better than something manually created
[11:36:30] <bjz> doomlord: ?
[11:36:43] <doomlord> i've been trying to make a c++ ->c->rust->impls  wrapper aswell, but i' fairly certain an off the shelf c++ library will defeat it :)
[11:36:54] <doomlord> ^binding generator
[11:37:21] <bjz> yeah, that would be an incredible challenge. I salute you if you can figure it out
[11:37:27] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:37:46] <orshem> dbaupp: thanks. that will help. what does rustc do with cycles?
[11:37:52] <doomlord> for *my own c++ code* i can re-work it to the limitations of my own tool :) so its useful to me
[11:37:58] <bjz> sometimes it pays to do some design though, these libs do some weird things sometimes
[11:38:01] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:38:01] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/WjDHJg
[11:38:01] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[11:38:01] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[11:38:01] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0ZtREQ
[11:38:01] <ghrust> 13rust/06auto 149c08db5 15Patrick Walton: librustc: Implement `#[no_main]`, which omits the entry point entirely....
[11:38:01] <ghrust> 13rust/06auto 14dbaca98 15bors: auto merge of #8279 : pcwalton/rust/no-main, r=brson...
[11:38:02] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[11:39:20] <bjz> dbaupp: any idea how this mutates `position`? http://bulletphysics.org/Bullet/BulletFull/Bullet-C-Api_8h.html#a8b235a758e7f92f6c7fc52ec80a531ed
[11:39:44] <bjz> dbaupp: it's kinda weird it doesn't take a pointer
[11:40:02] <bjz> ohh
[11:40:05] <bjz> wait
[11:40:32] <bjz> typedef plReal plVector3[3];
[11:41:03] <bjz> plVector3 is a pointer right?
[11:41:23] * dbaupp has literally no idea
[11:41:31] <bjz> I had: pub type plVector3 = [plReal, ..3];
[11:41:40] <doomlord> yes that''ll be a pointer
[11:41:53] <bjz> so it'd have to be: pub type plVector3 = *[plReal, ..3];
[11:41:59] <dbaupp> bjz: well, it's sort-of a pointer
[11:42:17] <doomlord> the pointer itself is const
[11:42:26] <doomlord> the data pointed to is not
[11:42:35] <bjz> mmk
[11:42:46] <bjz> weird C is weird
[11:42:53] <dbaupp> orshem: cycles?
[11:43:13] <doomlord> its certainly clearer when they make a struct plVector3 { plReal x,y,z} :)
[11:43:21] <dbaupp> orshem: oh, cyclic data types and destructors?
[11:43:32] <doomlord> but indexable vectors have their merits too
[11:45:05] <doomlord> does pub type plVector = &mut [plReal,..3] work
[11:45:35] *** Joins: jeff (jeff@moz-FC89C5BA.nycmny.east.verizon.net)
[11:47:07] <bjz> doomlord: you'd need lifetimes
[11:48:13] <doomlord> i guess that'll take a lot more thought with all their calls
[11:49:45] <doomlord> does rust allow c style array dereferencing of unsafe ptrs ... T* ptr; ptr[0],ptr[1]... i dont expect it would?
[11:51:09] <bjz> you could do: unsafe { *(ptr + 1) }
[11:52:20] <doomlord> ok using ptr arithmetic to get the same effect
[11:52:46] <bjz> rusti: unsafe { let ptr: *int = std::cast::transmute(&[1, 2, 3]); *(ptr + 2) }
[11:52:46] -rusti- <anon>:1:0: 1:0 error: transmute called on types with different sizes: &[int] (128 bits) to uint (64 bits)
[11:52:46] -rusti- <anon>:1 extern mod extra;
[11:52:46] -rusti-          ^
[11:52:46] -rusti- application terminated with error code 101
[11:52:52] <doomlord> just a case of how similar you want the rust side acessors to look
[11:53:04] <dbaupp> rusti: unsafe { let ptr: *int = std::cast::transmute(&([1, 2, 3])); *(ptr + 2) }
[11:53:04] -rusti- 3
[11:53:10] <bjz> heh
[11:53:39] <dbaupp> cmr: ping
[11:54:02] <bjz> rusti: let ptr: *[int, ..2] = &([1, 2, 3]);
[11:54:03] -rusti- <anon>:5:32: 5:45 error: mismatched types: expected `*[int, .. 2]` but found `&[<VI2>, .. 3]` ([] storage differs: expected 2 but found 3)
[11:54:03] -rusti- <anon>:5          let ptr: *[int, ..2] = &([1, 2, 3]);
[11:54:03] -rusti-                                          ^~~~~~~~~~~~~
[11:54:03] -rusti- error: aborting due to previous error
[11:54:03] -rusti- application terminated with error code 101
[11:54:19] <bjz> rusti: let ptr: *[int, ..3] = &([1, 2, 3]);
[11:54:20] -rusti- <anon>:5:13: 5:16 warning: unused variable: `ptr` [-W unused-variable (default)]
[11:54:20] -rusti- <anon>:5          let ptr: *[int, ..3] = &([1, 2, 3]);
[11:54:20] -rusti-                       ^~~
[11:54:20] -rusti- ()
[11:54:30] <bjz> rusti: let ptr: *[int, ..3] = &([1, 2, 3]); ptr
[11:54:31] -rusti- 139920005556104
[11:54:42] *** Quits: jeff (jeff@moz-FC89C5BA.nycmny.east.verizon.net) (Quit: jeff)
[11:54:46] *** Parts: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) ()
[11:56:36] * dbaupp doesn't like how & -> * is automatic
[11:57:09] <bjz> aye
[11:57:33] <dbaupp> especially since:
[11:57:40] <bjz> rusti: let ptr: *[int, ..3] = [1, 2, 3].to_raw_ptr();
[11:57:40] -rusti- <anon>:5:32: 5:55 error: type `[<VI2>, .. 3]` does not implement any method in scope named `to_raw_ptr`
[11:57:40] -rusti- <anon>:5          let ptr: *[int, ..3] = [1, 2, 3].to_raw_ptr();
[11:57:40] -rusti-                                          ^~~~~~~~~~~~~~~~~~~~~~~
[11:57:40] -rusti- error: aborting due to previous error
[11:57:41] -rusti- application terminated with error code 101
[11:58:11] <bjz> would be better like this?: let ptr: *[int, ..3] = (&[1, 2, 3]).to_raw_ptr();
[11:58:19] <dbaupp> rusti: let ptr: *[int, ..3] = &([1,2,3]); let other_ptr = ptr as *float; unsafe {*other_ptr}
[11:58:20] -rusti- 0
[11:58:32] <dbaupp> bjz: yeah, I think so
[11:59:36] <dbaupp> bjz: (fwiw, https://github.com/mozilla/rust/issues/7694)
[12:00:50] <orshem> dbaupp: yes
[12:03:40] <dbaupp> orshem: I don't actually know the details, but dtors don't execute "through" *, so if you have a cycle of *'s, then they'll get deallocated in the order that your program it to be done in.
[12:03:40] <bjz> rusti: fn f(&mut x) { *x = 2 } let mut y = 0; f(&mut y); f
[12:03:41] -rusti- pastebinned 7 lines of output: http://sprunge.us/FXdX
[12:04:08] <bjz> rusti: fn f<'a>(&'a mut x) { *x = 2 } let mut y = 0; f(&mut y); y
[12:04:08] -rusti- <anon>:5:19: 5:21 error: unexpected token: `'a`
[12:04:08] -rusti- <anon>:5          fn f<'a>(&'a mut x) { *x = 2 } let mut y = 0; f(&mut y); y
[12:04:09] -rusti-                             ^~
[12:04:09] -rusti- application terminated with error code 101
[12:04:35] <bjz> woops :P
[12:04:49] <bjz> reading C has messed my brains up
[12:05:04] <bjz> rusti: fn f(x: &mut int) { *x = 2 } let mut y = 0; f(&mut y); y
[12:05:05] -rusti- 2
[12:05:11] <rust-noob> how do I constantly assign a constant? (eg: pub static T: ~[int] = vec::from_elem(1, 1); )
[12:05:21] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[12:05:32] <rust-noob> rusti: pub static T: ~[int] = vec::from_elem(1, 1);
[12:05:33] -rusti- pastebinned 11 lines of output: http://sprunge.us/QbAT
[12:05:33] <orshem> dbaupp: ok, but i can still call each child dtor in the parent dtor, that will work?
[12:05:41] <bjz> rust-noob: you can't
[12:05:53] <bjz> rust-noob: rust doesn't have CTFE
[12:06:01] <bjz> :(
[12:06:04] <rust-noob> :(
[12:06:26] <rust-noob> hmm, well then, thanks anyway ;)
[12:06:45] <bjz> rust-noob: I normally just have a function that returns something
[12:07:15] <dbaupp> orshem: yeah, that's essentially what the `let _: ~T = transmute(..)` does in the extra::rc example
[12:07:26] <bjz> rust-noob: it's not very nice, but it's the best you can do
[12:07:28] <dbaupp> orshem: it runs the ~T dtor, which then runs the T dtor (if it exists.)
[12:07:34] <bjz> rust-noob: at least for now
[12:07:56] <dbaupp> rust-noob: do you just need a constant vector?
[12:08:06] <Seldaek> I need a build bot to work on libextra :/ compiliing it in a VM takes ages on my crappy laptop cpu
[12:08:08] <bjz> [0,..3]
[12:08:09] <rust-noob> it's a cost matrix
[12:08:11] <dbaupp> rusti: static foo: &'static [int] = [1,2,3];
[12:08:12] -rusti- <anon>:5:38: 5:45 error: mismatched types: expected `&'static [int]` but found `[<VI2>, .. 3]` ([] storage differs: expected &'static  but found 3)
[12:08:12] -rusti- <anon>:5          static foo: &'static [int] = [1,2,3];
[12:08:12] -rusti-                                                ^~~~~~~
[12:08:12] -rusti- error: aborting due to previous error
[12:08:12] -rusti- application terminated with error code 101
[12:08:23] <dbaupp> rusti: static foo: &'static [int] = &[1,2,3]; foo
[12:08:23] -rusti- &[1, 2, 3]
[12:08:36] <dbaupp> Seldaek: do you know about `make check-stage2-extra NO_REBUILD=1`?
[12:08:43] <bjz> dbaupp: your constants should be in caps!
[12:08:48] <bjz> >:[
[12:08:54] <rust-noob> the matrix itself is a tuple struct
[12:09:06] <Seldaek> dbaupp: no I do not, but as far as I see it only built libextra again 
[12:09:28] <dbaupp> rust-noob: ah, a tuple struct with ~[] in it?
[12:09:36] *** Joins: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP)
[12:09:49] <rust-noob> yep ;) ~[~[float]] to be precise :D
[12:10:05] <Seldaek> dbaupp: no ok it failed in stage1 now, dman
[12:10:05] <rust-noob> works really nice ;)
[12:10:13] <dbaupp> Seldaek: yeah, NO_REBUILD just builds extratest and runs it, so you don't have to do the full bootstrap for library-only changes.
[12:10:47] <dbaupp> Seldaek: (oh, if you're modifying stuff that affects the compiler itself too, then you'll need to run a proper make occasionally.)
[12:11:14] <dbaupp> rust-noob: yup, ~[] isn't possible in statics, so I'm afraid it's not possible.
[12:11:22] <Seldaek> dbaupp: just messing with extra::getopts
[12:12:00] <dbaupp> Seldaek: yeah, I guess using NO_REBUILD until the tests pass and then fixing up make should be perfect :)
[12:12:03] <rust-noob> ok :/ I think I'm going to do some function hack ;)
[12:12:11] <Seldaek> dbaupp: cheers
[12:12:53] *** Joins: ab (alex@BC9D99CC.37C1012D.FE617B51.IP)
[12:13:27] <jensnockert> Hurray, .au support \o/
[12:14:01] * jensnockert is starting to master this silly language.
[12:14:11] <sanxiyn> .au support?
[12:14:20] <jensnockert> For my multimedia framework.
[12:14:22] <dbaupp> jensnockert: Rust?
[12:14:30] <jensnockert> It's an old Sun format for audio.
[12:14:41] * dbaupp thought jensnockert was already a Rust-master
[12:14:48] <jensnockert> dbaupp: It is working against me in every way, or at least the compiler is.
[12:15:00] <dbaupp> jensnockert: it's being icy?
[12:15:07] <jensnockert> dbaupp: Frigid, to say the least.
[12:15:40] <jensnockert> Does anyone remember why ~Trait is not supposed to be used?
[12:15:41] * sanxiyn claims, compiler is your friend
[12:16:03] * jensnockert thinks that sanxiyn is one with the compiler.
[12:16:32] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[12:17:32] <dbaupp> jensnockert: because it was broken?
[12:17:47] <kimundi> jensnockert: Define not to be used. It used to be buggy, it's less so now I think
[12:17:49] <jensnockert> dbaupp: Yes, I remember that much.
[12:17:52] <dbaupp> (apparently they works now)
[12:17:56] <jensnockert> But buggy in what way?
[12:18:02] <jensnockert> Or do they work now?
[12:18:03] * dbaupp apparently can't grammar
[12:18:53] <dbaupp> rusti: trait Foo { fn go(&self); } impl Foo for int { fn go(&self) { println("gone") } } let x = ~1i as ~Foo; x.go()
[12:18:54] -rusti- gone
[12:18:54] -rusti- ()
[12:19:02] <kimundi> rusti: let x = ~12u; let y = x as ~ToStr; y.to_str()
[12:19:03] -rusti- ~"12"
[12:19:04] <dbaupp> jensnockert: well, they don't crash immediately
[12:19:24] <Seldaek> dbaupp: ok running test suite!
[12:19:27] <dbaupp> jensnockert: and apparently aatch is using them for his target-triples reform, so I guess they do mostly work.
[12:20:12] <jensnockert> Good, because the Rust Master once said "Fear leads to anger; anger leads to hate; hate leads to @"
[12:20:20] <Seldaek> dbaupp: do you know how to just run tests for one file though? I forgot again. But I can also just let it run..
[12:20:40] <rust-noob> ok I don't know how to do the static Matrix thing right. I need a way to store the matrix (aka tuple struct), that allows access to it from outside the method that's creating it, does something like this exist?
[12:20:55] <dbaupp> Seldaek: TESTNAME=some::substring
[12:20:59] <rust-noob> *to access
[12:21:21] <dbaupp> rust-noob: code example?
[12:21:43] <dbaupp> jensnockert: and we all know that @ is just a gateway drug to @mut
[12:21:59] <rust-noob> fn craft_cost_matrix() { let cost_matrix: Matrix = create_cost_matrix(create_islands()); }
[12:22:05] <jensnockert> I don't always use @, but when I do, I always add @mut to everything.
[12:22:27] <dbaupp> rust-noob: `fn craft_cost_matrix() -> Matrix { create_cost_matrix(create_islands()) }`
[12:22:35] <dbaupp> rust-noob: (assuming you want to return it?)
[12:22:45] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[12:22:50] <jensnockert> Might not help that I am essentially porting silly-optimized JS code.
[12:23:13] <rust-noob> but that will redo the whole calculation of the cost matrix
[12:23:21] <dbaupp> rusti: @mut @mut @mut "whatchu gonna do about it"
[12:23:21] -rusti- @@mut @mut "whatchu gonna do about it"
[12:23:45] <dbaupp> rust-noob: ah, yes... so call it as few times as possible
[12:23:47] <rust-noob> (I tried to implement it because I don't want the program to do this more than once ;) )
[12:23:48] <jensnockert> rusti: ~"Beat you down with a ~"
[12:23:49] -rusti- ~"Beat you down with a ~"
[12:24:03] <rust-noob> Is there really no other way?
[12:24:12] <dbaupp> jensnockert: you're porting audio processing stuff from js??
[12:24:21] <jensnockert> dbaupp: Like a boss.
[12:24:25] <dbaupp> rust-noob: you could put it into task-local storage
[12:24:36] <dbaupp> rust-noob: and so it only gets computed once for each task
[12:24:42] <rust-noob> how do I do that? :D
[12:24:43] <dbaupp> rust-noob: (give me second.)
[12:24:50] <rust-noob> ;)
[12:25:07] <jensnockert> dbaupp: Partially, but mainly because I wrote that code, so I know what bugs are in there.
[12:25:26] <dbaupp> rust-noob: https://github.com/mozilla/rust/blob/master/src/libstd/rand.rs#L866
[12:25:48] <dbaupp> rust-noob: although, if it's immutable, you should avoid the @mut like the plague
[12:25:55] <dbaupp> (it == the cost matrix)
[12:26:53] <sanxiyn> rust-noob: Eh, call the function once and *keep the result*?
[12:27:08] <rust-noob> ok nice, so I use something like fn craft_cost_matrix() -> @Matrix { create_cost_matrix(create_islands()) }
[12:27:30] <rust-noob> sanxiyn: yes! but where? :D
[12:27:40] <sanxiyn> rust-noob: In a local variable, for example.
[12:27:55] <rust-noob> but I need it about everywhere :/
[12:27:58] <dbaupp> rust-noob: something like that, but to cache the result you need to put it into tls, so only call create_cost_matrix if local_data::get() gives you None
[12:28:07] <dbaupp> (i.e. only create it on the first call.)
[12:28:25] <dbaupp> jensnockert: and fixing 'em, right?
[12:28:30] <sanxiyn> rust-noob: Ah, you want a global variable, which officially does not exist in Rust
[12:28:33] <rust-noob> ok, let's see how it works, thanks!
[12:28:42] <jensnockert> dbaupp: I use too much @mut right now.
[12:28:44] <rust-noob> exactly!
[12:28:55] <sanxiyn> rust-noob: You know global variables are bad, right? :)
[12:29:01] <jensnockert> dbaupp: Or at least @.
[12:29:26] <rust-noob> haha no, I just know ruby :P
[12:29:28] <dbaupp> sanxiyn: it's not so bad here: it should be a static (since it's immutable), but statics can't contain ~[], so this can't be.
[12:29:32] <jensnockert> dbaupp: I want to make them sendable in the future, but I also want to run this on a Cortex-M4 :S
[12:29:45] <sanxiyn> dbaupp: Ah. I see. :(
[12:29:47] <dbaupp> jensnockert: why is that a 'but'?
[12:30:02] <dbaupp> jensnockert: (also, you're a b@d person.)
[12:30:10] <dbaupp> :P
[12:30:15] <jensnockert> dbaupp: Cannot really use that they are sendable, since the M4 cannot support the runtime.
[12:30:26] <dbaupp> oh!
[12:30:29] <sanxiyn> dbaupp: Will compile time function evaluation help this case?
[12:31:01] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[12:31:11] <dbaupp> sanxiyn: I don't think so... ~[]/~ in statics requires code running before main starts and after it ends (the malloc/free)
[12:31:25] <jensnockert> dbaupp: 16k RAM and 128k Flash isn't really enough for the runtime. Not counting the total lack of OS.
[12:31:39] <dbaupp> jensnockert: meh, just port it more compactly :P
[12:32:01] <jensnockert> dbaupp: Or just stream code over the serial ports!
[12:32:01] <dbaupp> jensnockert: but yeah, that doesn't sound like a platform the rt will support ever
[12:32:19] <dbaupp> jensnockert: (also, ... you'll need to remove the @'s to get runtimeless anyway.)
[12:32:28] <jensnockert> dbaupp: FML.
[12:32:43] <dbaupp> jensnockert: just apply more 's
[12:32:55] <jensnockert> Can't I just add a faux implementation that never free's them?
[12:33:02] <dbaupp> yeah, probably
[12:33:28] <dbaupp> #[lang="free"] fn local_free(..) {}
[12:33:39] <Florob> Leaking in 16k RAM sounds like an amazing idea :P
[12:33:52] <dbaupp> although, I think @ comes with a pile of other baggage & langitems that'll just be annoying
[12:34:08] <dbaupp> Florob: stop being so sensible :P
[12:34:35] <jensnockert> Florob: I can just soft-reset the board between each song ;)
[12:35:08] <jensnockert> That's how real men(tm) do their memory management.
[12:35:15] <Florob> jensnockert, 8-bit music, right?
[12:35:28] <jensnockert> Florob: I am hoping that it should be able to play MP3s.
[12:36:04] <jensnockert> It should be able to read the bitstream over a serial port.
[12:36:44] <Florob> Well... if the decompressed data never leaves the chip 16k RAM only amounts to 2s of music though, I'd guess
[12:37:21] <jensnockert> Yeah, but it will throw it out to an amplifier.
[12:37:41] <dbaupp> and then not get deallocated... unless you're using a fixed buffer?
[12:37:49] <Florob> Ah, let the amplifier call free(), good plan.
[12:37:57] <Florob> *scnr*
[12:38:00] <rust-noob> I can't do it right, time unwind my brain :P
[12:38:15] * dbaupp thinks jensnockert's life would be much easier with less @
[12:38:24] <jensnockert> I reuse the buffers :(
[12:38:44] *** Joins: xorcon (Mibbit@moz-963D6814.redpill-linpro.com)
[12:39:17] <jensnockert> Even my 3s WAV sample would fit in the flash of the thing.
[12:39:38] <orshem> i don't understand anything :). i thought i did, but i don't! what is the purpose of the mod statement?
[12:39:39] <xorcon> I am trying to get started and get things like "error: failed to resolve import `core::pipes`"
[12:40:01] <jensnockert> No idea how ARM claims that you could do MP3 encoding on a 12MHz Cortex M4 though
[12:40:02] <xorcon> using the latest 0.7 releasse
[12:40:07] <jensnockert> Would like to see that.
[12:40:19] <ion> jensnockert: Did they say realtime? :-P
[12:40:28] <jensnockert> ion: Oh, right, that could be it ;)
[12:40:30] <xorcon> isnt comm superceded by pipes?
[12:40:57] <jensnockert> ion: Even 10MHz or decoding MP3 seems a bit tight, even though it has a lot of hardware for stuff like that.
[12:41:16] <ion> I can also do H.264 encoding with it, while doin 3D rendering.
[12:41:18] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[12:41:54] <dbaupp> rust-noob: https://gist.github.com/huonw/27380cb0540261214cbe
[12:41:59] <jensnockert> ion: Swapping on embedded boards is amazing! \o/
[12:42:11] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[12:42:14] <kimundi> orshem: where's the problem?
[12:42:26] <dbaupp> orshem: to create a submodule
[12:42:31] *** Quits: rust-noob (Mibbit@moz-72A1FE21.hiway.at) (Quit: http://www.mibbit.com ajax IRC Client)
[12:42:42] <ion> 10MHz does sound a bit low for realtime MP3 decoding in software, but i guess its plausible. I remember my 66MHz Amiga being able to do that with cycles to spare.
[12:43:05] <dbaupp> xorcon: s/core/std/
[12:43:26] <dbaupp> xorcon: (and the old std -> extra)
[12:43:49] *** Joins: Florob (Florob@moz-39532932.de)
[12:44:13] <dbaupp> https://github.com/mozilla/rust/pull/8305 r?
[12:45:42] <Seldaek> dbaupp: why the double braces in the str.rs diff?
[12:46:24] <dbaupp> rusti: macro_rules! t( () => { println("hi"); println("oops); }) t!()
[12:46:25] -rusti- <anon>:7:19: 7:20 error: unknown start of token: 63
[12:46:25] -rusti- <anon>:7     println(fmt!("%?", r))
[12:46:25] -rusti-                             ^
[12:46:25] -rusti- application terminated with error code 101
[12:46:51] <dbaupp> rusti: macro_rules! t( () => { println("hi"); println("oops"); }) t!()
[12:46:52] -rusti- hi
[12:46:52] -rusti- ()
[12:47:05] <dbaupp> Seldaek: ^ the second statements get dropped (silently!!)
[12:47:15] <Seldaek> oh, wtf:)
[12:47:24] <dbaupp> https://github.com/mozilla/rust/issues/8012
[12:48:26] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Ping timeout)
[12:48:45] <jensnockert> dbaupp: Top-3 multireported bugs?
[12:49:09] <Seldaek> stage1... all the comics about compiling taking time come back to mind
[12:50:25] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:50:36] <orshem> kimundi, dbaupp : i meant like so: mod foo; i thought it was to declare modules in other files but that doesn't work corrently ether 
[12:51:12] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[12:51:25] <xorcon> unresolved import: there is no `SharedChan` in `std::pipes`
[12:51:36] <xorcon> is it in extra???
[12:51:43] <Seldaek> orshem: as far as I understand, modules are named by whoevre loads them using the mod statement (unless you do mod foo {})
[12:52:11] <Seldaek> orshem: so to make a module you just mark stuff as pub in your file and that's that
[12:52:14] <sanxiyn> orshem: To refer to modules, use "use"
[12:52:54] <sanxiyn> That is, you should normally never have more than one "mod" statement referring to the same file in a crate
[12:54:17] <kimundi> orshem: mod allways creates a new module. if it's mod NAME { ... } then the stuff inside the brackets is the content of the new module. If it's mod NAME; then the content of NAME.rs or NAME/mod.rs becomes that content
[12:54:33] <xorcon> it was in comm :)
[12:54:51] <bjz> doomlord: eh, the C api looks like tumbleweed
[12:54:57] <bjz> doomlord: :(
[12:55:27] <dbaupp> jensnockert: hm?
[12:55:45] <bjz> doomlord: reading through the forum posts it's seems it's been 'a work in progress' for half a decade
[12:55:46] <jensnockert> dbaupp: Isn't there like 17 copies of that bug? Reported by different people?
[12:55:55] <dbaupp> jensnockert: maybe?
[12:56:14] <leaper> could someone please help me with this wierd issue? https://gist.github.com/anonymous/6155711
[12:56:40] <jensnockert> dbaupp: It really should be fixed :(
[12:57:21] <dbaupp> jensnockert: I was/am going to try fix it... but there's a huge pr in syntax::ext (hygenic macros!) that I don't want to make any harder to land.
[12:57:35] <jensnockert> dbaupp: Oh, wonderful! *hugs8
[12:57:38] <jensnockert> *hugs**
[12:58:15] <orshem> kimundi: sorry didn't understand that last statement
[12:58:27] <orshem> Seldaek, sanxiyn: thx
[12:58:40] * dbaupp strangely ended up doing most of his rust work in libsyntax.
[12:58:50] <orshem> let's say i have two files t1.rs and t2.rs
[12:58:52] *** Joins: gits1225 (gits@24C77723.43CEF437.C6104E0F.IP)
[12:59:01] <orshem> how do i reference fns from t1 in t2
[12:59:23] <kimundi> orshem: 'mod Foo;' is sugar for mod Foo { /* ./Foo.rs's file content or ./Foo/mod.rs's file content */ }
[12:59:51] <sanxiyn> orshem: use t1::function_from_t1;
[12:59:55] <sanxiyn> function_from_t1();
[13:00:08] <kimundi> orshem: First, you decide wich of the files is supposed to be the root of your module hienachy
[13:00:09] <sanxiyn> Or:
[13:00:11] <sanxiyn> use t1;
[13:00:15] <sanxiyn> t1::function_from_t1();
[13:01:02] <kimundi> orshem: The root can be either t1, t2 or a unrelated file like a main.rs
[13:03:03] <kimundi> orshem: Once you've decided wich ones the root of your crate, you then start adding submodules in that for the other file. Say you have a main.rs, then in that you add 'mod t1; mod t2;'
[13:05:11] <kimundi> then your cratey.s module hierachy is like this: the root module main, and two child modules t1 and t2
[13:05:19] <kimundi> crate's *
[13:05:46] <kimundi> now, if in t1 you want to use a function from t2 you have two options
[13:06:25] <kimundi> 1. directly refer to it by the full global path, eg: 'let x = ::t2::foo(42);'
[13:07:08] <kimundi> 2. import foo() into the local namespace with a 'use t2::foo;' and then just do 'let x = foo(42);'
[13:08:07] <orshem> kimundi: ok, didn't know about :: operator (like in c++) and i thought that mod file; referenced that file and only then you can use it
[13:08:20] <orshem> the weird thing is that it worked... up to a point
[13:08:22] <orshem> :D
[13:08:32] <orshem> thanks for the explanation!
[13:09:29] <orshem> why, though, i can't do 'use t1;' and then call 't1::foo();' ?
[13:09:34] <kimundi> orshem: the secret for understanding those paths is that they work the same in a expression and in a use statement, but have different syntax.
[13:09:44] <kimundi> orshem: you can do that too
[13:10:02] <kimundi> orshem: foo has to be public thoug in both cases
[13:10:16] <kimundi> and the mods themself too, I think
[13:10:26] <xorcon> Where can I read more about this structure: for evens.advance |&num| {......}
[13:10:35] <kimundi> visibilty has still weird behavior
[13:10:43] <xorcon> more specifically the | notation in this context
[13:10:57] <kimundi> xorcon: Nowhere anymore, that's legacy :)
[13:10:59] <darkf> xorcon: should be addressed with iterators in the tutorial. also, we're moving away from that syntax in 0.8-pre
[13:11:00] <orshem> kimundi, the functions are public, the mods are just the file themselves
[13:11:06] <orshem> but i get "error: unresolved import (maybe you meant `t2::*`?)"
[13:11:15] <kimundi> orshem: 'pub mod' vs 'mod'
[13:11:26] <xorcon> aha
[13:11:40] <kimundi> the file itself has no visibility, but the module you create with the file's content has
[13:11:49] <orshem> kimundi, but i don't declare the mods anywhere. i thought the file itself functioned as a mod
[13:11:51] <xorcon> should I really rebuild from master? 
[13:12:05] <orshem> i have no inner mods within the file
[13:12:09] <orshem> one sec
[13:12:13] <kimundi> xorcon: but that syntax still exists with 'let x = do foo |...| { ... '
[13:12:35] <kimundi> orshem: if you have a 'mod' somewhere, that's a module declaration
[13:12:40] *** Joins: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP)
[13:13:16] <kimundi> orshem: files are onld allways modules because you can only get the code in a file by creating a module with the file's content
[13:13:46] <dbaupp> xorcon: the |..| { } is a closure
[13:13:52] <Seldaek> dbaupp: thanks for helpng with the compile flags. PR sent, and I'll write those flags down somewhere for next time I forget :p
[13:13:52] <orshem> https://gist.github.com/dovreshef/6155824
[13:13:58] <orshem> kimundi, ^
[13:14:00] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[13:14:00] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/0ZtREQ
[13:14:00] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[13:14:02] <dbaupp> xorcon: `|args...| body`
[13:14:08] <kimundi> xorcon: Thet syntax is basically syntactic suger: 'foo(a, b, |x, y| { ... })' == 'do foo(a, b) |x, y| { ... }'
[13:14:10] <dbaupp> Seldaek: https://github.com/mozilla/rust/wiki/Note-testsuite :)
[13:14:14] <orshem> sorry for being obtuse
[13:14:24] <orshem> i really don't understand
[13:14:35] <orshem> i have no mods statements at all;
[13:14:40] <kimundi> orshem: no problem
[13:14:48] <Seldaek> dbaupp: yeah well, I need a --dummy flag :p
[13:15:10] <dbaupp> Seldaek: heh :)
[13:15:43] *** Quits: Guest_ (textual@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: Textual IRC Client: www.textualapp.com)
[13:16:02] <dbaupp> orshem: https://gist.github.com/huonw/6155841
[13:16:05] <kimundi> orshem: okay, what you have there is three files that have no connection to each other, but that want to reference to other modules with the 'use' . But each file has no other submodule, because you don't declare one with 'mod' anywhere, so of course none of thet can find one
[13:16:53] <dbaupp> orshem: (updated with some comments.)
[13:16:58] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:16:58] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3NMfZA
[13:16:58] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:16:58] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[13:16:58] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/yZCfcw
[13:16:58] <ghrust> 13rust/06auto 14a75f081 15James Deng: ast::Lifetime contains ast::Name instead of ast::ident.
[13:16:58] <ghrust> 13rust/06auto 14dd94059 15James Deng: Rewrite an expansion of quote_item to manual ast construnction.
[13:16:59] <ghrust> 13rust/06auto 146350d9d 15James Deng: Added a note about the deletion of a quote_item.
[13:17:01] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[13:17:10] <kimundi> orshem: Now, dbaupp has linked you an fix that makes it work, but woul'd you like me to go through how that stuff actually works?
[13:21:17] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[13:22:59] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[13:23:00] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a37ddd9 to 14dbaca98: 02http://git.io/N3iJvQ
[13:23:00] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[13:23:40] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Ping timeout)
[13:26:06] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[13:26:40] <orshem> dbaupp, kimundi: thanks a lot
[13:26:46] <orshem> kimundi, yes please
[13:27:02] <orshem> i thought mod statement was not necessary
[13:27:15] <kimundi> orshem: he, it's tho opposite xD
[13:27:17] <orshem> also why does t1 needs to know about t3
[13:27:27] <orshem> it breaks encapsulation 
[13:27:34] <orshem> it only uses t2
[13:27:46] <kimundi> orshem: let's start at the beginnig, okay?
[13:28:14] <orshem> ok
[13:28:35] <kimundi> so, rust has a module system
[13:28:47] <dbaupp> orshem: (t1 only needs to know about t3 in my example because I wanted to show what `use` does.)
[13:29:05] <orshem> dbaupp, yeah i know see! i'm an idiot
[13:29:10] <kimundi> all your code lives in an module
[13:29:11] <orshem> but i know that so it's ok
[13:29:19] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[13:29:35] <kimundi> modules can contain other module, it's a tree structure starting from the root module
[13:29:54] <kimundi> your root mrodule is the file you're passing to rustc
[13:30:07] <kimundi> rustc t1.rs -> t1 becomes your root module
[13:30:13] <kimundi> rustc t2.rs -> t2 becomes your root module
[13:30:41] <orshem> i see
[13:31:05] <kimundi> if you compile a file with rustc, the result is a single binary. that binary contains all code of the module tree that starts with the root moudle as root
[13:31:27] <kimundi> you build that module tree with mod statements
[13:32:31] <kimundi> for example, what you're usually going to do for small-mid size projects is to just put all modules you're using right next to each other in your root module
[13:33:19] <kimundi> like, your root modules contains the lines 'mod a; mod b; mod c; mod d { ...} ' etc
[13:33:47] <orshem> i see
[13:33:50] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[13:33:52] <kimundi> wich results in a module tree that is just one layer deep
[13:34:10] *** Joins: rust-noob (Mibbit@moz-72A1FE21.hiway.at)
[13:34:24] <kimundi> technically, just mod statemnts is all you need for your code to run and acces other modules
[13:34:35] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[13:34:57] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[13:35:21] <kimundi> if in module a, you want to access something from module b, you just write down the whole path to it, starting at the root module
[13:35:33] <rust-noob> hey! how do I iterate over each 2 consecutive elements of a vector in rust? eg: v = [1,2,3] I would like to iterate over [1,2] and [2,3]
[13:35:38] <kimundi> let x = ::b::foo(...)
[13:35:44] <dbaupp> rust-noob: x.window_iter()
[13:35:53] <dbaupp> rust-noob: x.window_iter(2)
[13:35:56] <orshem> so the use statement is doesn't import anything only brings and rename into local scope
[13:36:25] <kimundi> but because that's impracticable, you can import names into the scope of the local module
[13:36:34] <kimundi> orshem: right
[13:36:42] <orshem> kimundi, also if i use the global path :: then i don't need mod statement?
[13:36:42] <rust-noob> haha nice, thanks dbaupp!
[13:36:58] <dbaupp> rusti: let v = [1,2,3]; for w in v.window_iter(2) { printfln!(w) }
[13:36:59] -rusti- &[1, 2]
[13:36:59] -rusti- &[2, 3]
[13:36:59] -rusti- ()
[13:37:00] <kimundi> orshem: nono
[13:37:06] *** Joins: mike (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net)
[13:37:06] *** Quits: rust-noob (Mibbit@moz-72A1FE21.hiway.at) (Quit: http://www.mibbit.com ajax IRC Client)
[13:37:20] <orshem> kimundi, ok ok i got it now :D
[13:37:23] <orshem> :)
[13:37:32] <kimundi> orshem: the path is for refering directly to other items in possible other mods without needing to import them into the local scope with use
[13:37:39] <mike> Hi, is there a port of Qt or another graphic library for rust?
[13:38:16] <orshem> kimundi, i think i finally  got it
[13:38:22] <orshem> last question
[13:38:39] <kimundi> shoot
[13:38:46] <darkf> mike: there are some ancient GTK+ ports but I doubt they work well
[13:38:59] <orshem> if that so why does use statement have to precede mod statements. it sounds like should be the opposite logically
[13:39:14] <orshem> ?
[13:39:15] <mike> So there isn't any way to create a GUI?
[13:39:39] <kimundi> orshem: that is a very big wart, indeed it would be more logical other way round
[13:40:19] <kimundi> orshem: the reason the order is 'backwards' is that modules you create with mod can shaddow names you imported with use
[13:40:43] <kimundi> say you have 'use a::b::foo; mod foo;'
[13:41:23] <kimundi> then if you access foo in your module, you're getting the content of the module foo you defined in this module, not the one you miported with use from a::b
[13:41:44] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[13:42:11] *** Joins: rust-noob (Mibbit@moz-72A1FE21.hiway.at)
[13:42:32] <orshem> kimundi, still seems to me that it should be the opposite and you can always rename... 
[13:42:51] <kimundi> orshem: yeah, but that is the reason for the current rule
[13:43:16] <orshem> was it a final bdfl decision or can i appeal ? :)
[13:43:23] <rust-noob> how could I rewrite the following piece of code so that it writes the return value of the distance method directly into a vector? code: for slice in s.dna.window_iter(2) { distance(slice[0], slice[1]); }
[13:43:28] <kimundi> orshem: I think the problem is mostly with accidental imports with * (use bigmodule::*;)
[13:43:38] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[13:44:11] <mike> Could anyone answer my question about the GUI? Thanks...
[13:44:48] <sanxiyn> mike: I don't know of any GUI toolkit binding yet
[13:45:34] <orshem> kimundi: rust could always warn about ambiguities.. or have a lint for them. i dunno, i feel that rule helped me to misunderstand the way use and mod works
[13:46:54] <engla> rust-noob: you can map the iterator elements to a distance, then collect into a vector
[13:47:02] <engla> rusti: let v = [1,2,3,5]; v.window_iter(2).transform(|s| s[1] - s[0]).to_owned_vec()
[13:47:03] -rusti- ~[1, 1, 2]
[13:47:43] <bstrie> orshem: feel free to bring up this issue on the mailing list, I've noticed it before as well and it seems very unfortunate
[13:47:45] <rust-noob> thanks!
[13:48:02] *** Quits: mike (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net) (Quit: http://www.mibbit.com ajax IRC Client)
[13:51:05] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[13:53:07] <rust-noob> engla: could you please give me the link to the documentation for transform(), I can't find it ;)
[13:53:23] <engla> ok
[13:53:36] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[13:53:47] <orshem> bstrie, i feel uncomfortable doing it because it's very close to bikeshedding
[13:53:57] <orshem> but i think it important nonetheless
[13:54:13] <engla> rust-noob: http://static.rust-lang.org/doc/std/iterator.html#method-transform
[13:54:38] <rust-noob> thank you very much!
[13:55:16] <bstrie> orshem: don't be afraid to bring it up, it hasn't been brought up before on the mailing list. it's important to get a final ruling on whether or not a better solution should be sought
[13:55:43] <orshem> bstrie: ok i will
[13:56:14] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Ping timeout)
[13:56:45] <bstrie> orshem: btw it's not bikeshedding if it actually changes the semantics :P
[13:57:38] <rust-noob> engla: I'm sorry I have to ask again, but what am I doing wrong? code:   let distances: ~[float] = s.dna.window_iter(2).transform( |slice| island::distance(islands(slice[0]), islands(slice[1]) ) ).to_owned_vector();
[13:57:56] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Quit: victorporof)
[13:58:02] <orshem> :P
[13:59:07] <xorcon> dbaupp: yes i got that but there is something I am unfamiliar with "move"  (?)
[13:59:32] <engla> rust-noob: looks correct
[14:00:48] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[14:02:27] <rust-noob> error: expected function but found `~[island::Island]`
[14:02:54] <rust-noob> seems odd to me...
[14:02:56] <jedestep> you probably tried to invoke that item
[14:03:01] <jedestep> like foo() instead of foo
[14:03:23] <engla> rust-noob: did you mean to write islands[slice[0]] etc?
[14:03:40] <rust-noob> yep, the two of you are right, thanks!!
[14:05:43] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[14:08:30] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[14:09:14] *** Joins: krebla (Mibbit@moz-D3D15A0C.vie.surfer.at)
[14:10:56] *** Quits: jaen (jaen@moz-CD4BD3B3.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:11:07] *** Quits: rust-noob (Mibbit@moz-72A1FE21.hiway.at) (Quit: http://www.mibbit.com ajax IRC Client)
[14:11:34] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[14:12:39] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[14:13:53] <xorcon> Can someone explain why this does not work? https://gist.github.com/anonymous/6156210
[14:14:11] <xorcon> it complains of "chan" being of unknown type
[14:14:17] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[14:17:52] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz)
[14:24:38] *** Joins: fabiand (fabiand@moz-4D04EC8E.adsl.alicedsl.de)
[14:25:06] *** Parts: gcarter (Greg_Carte@moz-DAA5D15C.san.res.rr.com) ()
[14:26:39] <SimonSapin> Its unfortunate that the only way to update a Github pull request is to force-push, which does not keep the previous version
[14:27:26] <darkf> SimonSapin: what do you mean? just pushing works for me, and preserves all of the previous state
[14:27:34] <SimonSapin> r? https://github.com/mozilla/rust/pull/8231
[14:27:46] <sanxiyn> xorcon: Eh, |&num, chan| should be just |&num|?
[14:28:14] <SimonSapin> darkf: Id want what I propose to merge to be a single commit, but have the previous proposed changed visible
[14:31:45] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[14:31:47] <jack> SimonSapin: it sometimes keeps the previous comments, but sometimes not. i'm not sure what affects which it does.
[14:32:16] <SimonSapin> jack: I meant the code itself, but code comments too, yes
[14:32:42] *** Joins: cypher (ircnet@moz-EA42E471.static.surfer.at)
[14:33:06] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[14:33:20] *** Joins: nano (nano@moz-972880B.superkabel.de)
[14:34:12] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[14:34:26] <cypher> Hi everyone. Anyone around to critique a small piece of Rust code?
[14:34:36] <sanxiyn> cypher: Go ahead
[14:35:09] <cypher> The code is here: https://github.com/cypher/exercism.io/blob/561eaf45f318e27693e60112dc4f31077363b67c/assignments/rust/example.rs
[14:35:44] <cypher> It's supposed to be the reference implementation for Rust on http://exercism.io, but I'm a Rust newbie, so I'd like feedback on the code (especially the `is_yelling` function)
[14:36:21] <cypher> For reference, this are the unit tests: https://github.com/kytrinyx/exercism.io/blob/master/assignments/rust/bob_test.rs
[14:36:26] <SimonSapin> cypher: it will fail on non-ASCII input
[14:37:00] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[14:37:42] <cypher> SimonSapin, I only saw `to_upper` implemented for Ascii, is there one for UTF-8 as well in the std lib?
[14:38:00] <sanxiyn> cypher: What should is_yelling implement?
[14:38:00] *** Joins: mrordinaire (Mibbit@3749AFFF.391F484.FD383126.IP)
[14:38:57] <SimonSapin> cypher: if you want to handle non-ASCII characters correctly (eg.  vs. ) then its quite complex and we dont have that in Rust right now
[14:38:59] <cypher> It should check wether the string only contains upper-case characters, while ignoring non-alpha  characters
[14:39:07] <SimonSapin> cypher: define upper-case?
[14:39:47] <sanxiyn> cypher: Is that equivalent to not containing any alphabetic but lowercase character?
[14:39:59] <cypher> SimonSapin, ""WATCH OUT!" and "ZOMG THE %^*@#$(*^ ZOMBIES ARE COMING!!11!!1!" should be considered upper case, while "Tom-ay-to, tom-aaaah-to." shouldn't
[14:40:45] <SimonSapin> cypher: What about non-ASCII characters?  vs. 
[14:40:55] <Florob> upper-case: "Is in unicode category Lu"
[14:41:06] <cypher> SimonSapin, basically undefined. Though for this exercise, it won't matter (see the unit tests)
[14:41:09] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[14:41:10] *** Quits: krebla (Mibbit@moz-D3D15A0C.vie.surfer.at) (Quit: http://www.mibbit.com ajax IRC Client)
[14:42:07] <SimonSapin> oh, we do have this: http://static.rust-lang.org/doc/std/char.html#function-is_lowercase
[14:42:20] <SimonSapin> you dont really need mapping, just checking
[14:42:21] <engla> yes, the unicode categories are there
[14:42:48] <sanxiyn> cypher: s.byte_iter().all(|&byte| !('a' as u8 <= byte && byte <= 'z' as u8))
[14:42:51] <sanxiyn> Or something
[14:42:57] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[14:43:08] <sanxiyn> cypher: Really, you shouldn't convert to uppercase and compare
[14:43:10] <sanxiyn> That is wasteful
[14:43:17] <sanxiyn> (That needs to allocate uppercase copy!)
[14:44:06] <engla> Where does Rust draw the line of what should be included in its unicode support and what belongs to external libraries?
[14:44:14] <cypher> SimonSapin, oh, neat, didn't see that.
[14:44:45] <cypher> So, `s.char_iter().all(|&char| char.is_lowercase())` should also work?
[14:45:25] <SimonSapin> not any rather than all, but yes something like that
[14:45:32] <engla> the char iter is called  .iter() and passes char by value
[14:45:54] <SimonSapin> engla: depending on the Rust version youre using
[14:46:27] <mrordinaire> SimonSapin: what's the new behaviour now?
[14:46:35] <sanxiyn> cypher: Argument to all is what all char in s needs to satisfy
[14:46:50] <sanxiyn> cypher: In this case, char needs to be not alphabetic at all, or uppercase
[14:47:12] <sanxiyn> So !char.is_alphabetic() || char.is_uppercase()
[14:47:13] <SimonSapin> mrordinaire: Im not sure, but try it on the version youre using
[14:47:26] <SimonSapin> I think it changed in the past few weeks
[14:47:26] *** Quits: xorcon (Mibbit@moz-963D6814.redpill-linpro.com) (Quit: http://www.mibbit.com ajax IRC Client)
[14:47:36] <kimundi> rusti: "FOO".char_iter().all(|&c| c.is_lowercase())
[14:47:37] -rusti- pastebinned 8 lines of output: http://sprunge.us/dPBO
[14:47:38] <engla> the current char iterator is called .iter()
[14:47:45] <kimundi> rusti: "FOO".iter().all(|&c| c.is_lowercase())
[14:47:46] -rusti- <anon>:5:27: 5:29 error: mismatched types: expected `char` but found an &-pointer pattern
[14:47:46] -rusti- <anon>:5          "FOO".iter().all(|&c| c.is_lowercase())
[14:47:46] -rusti-                                     ^~
[14:47:46] -rusti- error: aborting due to previous error
[14:47:46] -rusti- application terminated with error code 101
[14:47:51] <kimundi> rusti: "FOO".iter().all(|c| c.is_lowercase())
[14:47:52] -rusti- false
[14:48:04] <kimundi> rusti: "FOO".iter().all(|c| c.is_uppercase())
[14:48:05] -rusti- true
[14:48:11] <kimundi> rusti: "FOO-BAR".iter().all(|c| c.is_uppercase())
[14:48:12] -rusti- false
[14:48:22] <kimundi> rusti: "FOO-BAR".iter().all(|c| !c.is_lowercase())
[14:48:22] -rusti- true
[14:48:38] <cypher> SimonSapin, ok, now I have this: message.iter().all(|char| !char.is_lowercase())
[14:48:43] <kimundi> rusti:  "ZOMG THE %^*@#$(*^ ZOMBIES ARE COMING!!11!!1!".iter().all(|c| !c.is_lowercase())
[14:48:44] <cypher> Which works, all tests pass
[14:48:44] -rusti- true
[14:48:46] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[14:48:58] <SimonSapin> cypher: cool
[14:49:11] <SimonSapin> Is  a Rust thing?
[14:49:12] <kimundi> rusti: "Tom-ay-to, tom-aaaah-to.".iter().all(|c| !c.is_lowercase())
[14:49:13] -rusti- false
[14:49:17] <cypher> No, that's from my editor
[14:49:19] <sanxiyn> cypher: Yeah, the main thing I want to say is allocating copy just to see whether it's all uppercase is very not Rust-y.
[14:49:40] <sanxiyn> (I consider that wasteful in other languages too, but well other languages have other idioms)
[14:49:43] *** Joins: lkuper (lkuper@319D299F.404EA247.57709FEB.IP)
[14:49:55] <cypher> sanxiyn, I figured, but it's been a long time since I did anything in such a low-level language
[14:50:33] <cypher> So my thinking is still very much along the lines of "Ok, just give me a copy of the string, but with all characters upper cased, then check if the strings are equal"
[14:50:56] <SimonSapin> cypher: this could work too, 
[14:51:18] <SimonSapin> but has many more subtle corner cases with non-ASCII characters
[14:51:22] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[14:51:36] <cypher> Because that's far easier to read in e.g. Ruby: message == message.upcase vs. message.all?{|c| c == c.upcase}
[14:51:49] <sanxiyn> cypher: Eh... both are easy to read?
[14:52:09] <cypher> I'd prefer the first version
[14:52:20] <sanxiyn> Why?
[14:52:27] <engla> none of them do the same test as the !c.is_lowercase()   version
[14:52:28] <kimundi> message.is_not_uppercase()
[14:52:38] <sanxiyn> (I think the first version will be faster in Ruby though)
[14:52:59] <cypher> shorter, doesn't iterate over all characters in the string, no block, and it states the intent clearer
[14:53:03] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[14:53:07] <cypher> sanxiyn, I think so too
[14:53:11] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:53:16] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[14:53:24] <sanxiyn> That's because in Ruby, iterating over all characters *in Ruby* is slow, and block is slow
[14:53:28] <cypher> yep
[14:53:33] <sanxiyn> In Rust, iterating over all characters is *fast*
[14:53:36] <sanxiyn> Block is *fast*
[14:53:59] <sanxiyn> (Of course, Ruby also is iterating over all characters in message.upcase version, it is just doing that in C)
[14:54:01] *** Quits: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch) (Connection reset by peer)
[14:54:06] <SimonSapin> sanxiyn: of course, things that are fast in Rust and Ruby are very much not the same
[14:54:07] <sanxiyn> (Rust has no "C level")
[14:54:11] *** Quits: fabiand (fabiand@moz-4D04EC8E.adsl.alicedsl.de) (Quit: Verlassend)
[14:54:43] <miloshadzic> sanxiyn, while it's true that Ruby is not as fast as say Rust, you don't really use it for the same type of code
[14:54:45] <cypher> sanxiyn, technically it does, but it's ugly to use (there's a gem where you can include bits of C code in Ruby, which get compiled on the fly and then magically called)
[14:54:48] <sanxiyn> cypher: I am not sure about clearer intent. To me .all version is clearer intent.
[14:54:52] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[14:55:06] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[14:55:14] <cypher> sanxiyn, I'll be sure to let you know when exercism.io has Rust available, you could do a lot of nitpicking :)
[14:55:58] <sanxiyn> I think Ruby(Python, etc) mainly does allocation because while allocation is expensive, iteration is so expensive that iterating in C level is worth the cost of allocation
[14:56:04] <sanxiyn> Which is... ugh
[14:56:20] <sanxiyn> I mean, allocation is supposed to be expensive and iteration cheap
[14:56:23] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[14:56:26] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[14:56:41] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Client exited)
[14:57:09] *** Quits: leaper (Mibbit@moz-2B18508A.kla-tencor.com) (Quit: http://www.mibbit.com ajax IRC Client)
[14:57:47] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[14:58:10] <cypher> sanxiyn, while I agree, it depends on what you're doing. Most of the stuff I do in Ruby or Python is not CPU-bound, but IO-bound, so saving a few extra allocations usually doesn't matter that much performance-wise.
[14:58:34] <cypher> That said, there is a reason why most Ruby and Python webservers have an option of restarting the worker processes every n requests ---
[14:58:55] <miloshadzic> cypher, exactly
[14:58:59] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[14:58:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/R8g5PQ
[14:58:59] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[14:59:24] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[14:59:51] <cypher> Any other criticism or nitpicks for the code? Currently looks like this: https://github.com/cypher/exercism.io/blob/a60a4edb613b59530d907b6a7e7f10580b142bc3/assignments/rust/example.rs
[15:00:45] <engla> cypher: does it compile? I don't think 'char' is a valid variable name
[15:00:49] <engla> since it's a type
[15:00:53] <cmr> It is valid
[15:00:57] <cmr> Value and type namespaces are different
[15:01:10] <cypher> It does compile, and all unit tests pass
[15:01:13] <engla> oh, I never knew :)
[15:01:22] <engla> rusti: let char = 1; char
[15:01:22] -rusti- 1
[15:01:31] <sanxiyn> Yeah you can use "char" as a variable name
[15:01:39] <bstrie> engla: this is how it's legal for us to have stuff like modules named "str"
[15:01:41] <sanxiyn> I just used "float" as a variable name today
[15:01:54] <engla> I don't know if this is nice or horrible
[15:01:59] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[15:02:00] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/_mx5hQ
[15:02:00] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[15:02:00] <sanxiyn> (As in, CSS float. Don't hate me.)
[15:02:03] <engla> it's against all learned reflexes
[15:02:04] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:02:04] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/m7_4lQ
[15:02:04] <ghrust> 13rust/06auto 14aab5d5a 15Marvin Lbel: Updated std::Option, std::Either and std::Result...
[15:02:04] <ghrust> 13rust/06auto 14418cdcf 15bors: auto merge of #8288 : Kimundi/rust/opteitres4, r=erickt...
[15:02:05] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:02:10] <cmr> I love it
[15:02:20] <bstrie> engla: the alternative is to reserve all "primitive" types as keywords
[15:02:21] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[15:02:23] <sanxiyn> engla: It is sort of nice to have a variable storing CSS float to be named "float"
[15:02:30] <engla> it is nice
[15:02:54] <engla> it is nice, it's just my body resisting it
[15:03:01] <bstrie> rusti: struct foo; let foo: foo = foo; foo
[15:03:01] -rusti- <anon>:5:25: 5:28 error: declaration of `foo` shadows an enum variant or unit-like struct in scope
[15:03:01] -rusti- <anon>:5          struct foo; let foo: foo = foo; foo
[15:03:01] -rusti-                                   ^~~
[15:03:01] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Connection reset by peer)
[15:03:01] -rusti- error: aborting due to previous error
[15:03:01] -rusti- application terminated with error code 101
[15:03:12] <sanxiyn> cypher: Looks good to me
[15:03:25] <sanxiyn> cypher: Nit: you seem to have two spaces between else and {?
[15:03:58] <cypher> Indeed. Thanks for pointing that out.
[15:04:35] <engla> I think you should have an explicit lifetime on the return value of reply
[15:04:39] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[15:04:40] *** Quits: lkuper (lkuper@319D299F.404EA247.57709FEB.IP) (Quit: lkuper)
[15:04:42] <engla> -> &'static str
[15:04:45] <sanxiyn> engla: Ah right
[15:04:49] <sanxiyn> Yup
[15:05:03] <bstrie> it passes without an explicit lifetime?
[15:05:12] <cypher> Yeah
[15:05:14] <sanxiyn> bstrie: Yeah :(
[15:05:15] <bstrie> if it's not needed, I'd say omit it
[15:05:16] <cypher> engla, ok. Added.
[15:05:29] <bstrie> we allow them to be inferred for a reason
[15:05:47] <bstrie> the lifetimes are inconsequential, no need to imply otherwise
[15:05:55] <cypher> alright.
[15:06:20] <sanxiyn> bstrie: Eh... I am not sure
[15:06:25] <sanxiyn> I guess it's okay either way
[15:07:18] <cypher> bstrie, it's supposed to be the reference solution for an exercise, so it might make sense to add an explicit lifetime?
[15:07:18] <bstrie> it's like how we used to allow `unsafe` on functions in `extern` blocks. you can say that it doesn't change the meaning but it does: it implies that there exist safe extern functions. the presence of irrelevant data is capable of causing confusion
[15:08:08] <engla> if you return ->&str   but try to return a value not valid for the 'static lifetime, you get this wonderful error message:
[15:08:26] <engla> fn f(s: &str) -> &str { if true { s } else { "a" } }; f("b")
[15:08:32] <engla> rusti: fn f(s: &str) -> &str { if true { s } else { "a" } }; f("b")
[15:08:33] -rusti- pastebinned 11 lines of output: http://sprunge.us/WGfR
[15:08:44] <engla> expected `&str` but found `&str`
[15:08:57] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[15:09:08] <cypher> Ok, I think I'll leave the lifetime out for now
[15:09:29] <bstrie> if it's a bug that the compiler allows there to be no lifetime there, then it needs to be filed. otherwise I don't think anyone really cares that the lifetime is static, since all string literals like that have a static lifetime
[15:10:06] *** Joins: chiii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[15:10:08] *** Quits: chiii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: chiii)
[15:10:16] <engla> not sure what you mean bstrie. The only valid non-parameter lifetime is 'static
[15:10:18] *** Joins: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[15:10:25] <engla> so -> &str should mean &'static str
[15:10:54] <bstrie> engla: then perhaps file a bug to make it mandatory
[15:10:57] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[15:10:57] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14418cdcf to 14c2bacd2: 02http://git.io/N3iJvQ
[15:10:57] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[15:10:58] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[15:10:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/RQckfg
[15:10:59] <ghrust> 13rust/06auto 14147c4fd 15Steven Fackler: Fixed str::raw::push_byte...
[15:10:59] <ghrust> 13rust/06auto 14d89ff7e 15bors: auto merge of #8289 : sfackler/rust/push_byte, r=erickt...
[15:10:59] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[15:11:09] *** Quits: mrordinaire (Mibbit@3749AFFF.391F484.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:11:11] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[15:11:15] <cmr> engla: that's not true, but it is true when returning a borrowed reference  with anonymous lifetime.
[15:11:58] <engla> cmr: what other alternative can it be?
[15:12:02] <cmr> Oh my std::reflect is quite ancient.
[15:12:05] <cmr> visit_class_field
[15:12:19] <cmr> engla: Lifetimes are infered
[15:12:28] <cmr> fn(foo: &u8, bar: &u8) is valid
[15:12:32] <cmr> And those are not 'static
[15:12:39] <engla> cmr: those are not return types
[15:12:59] <cmr> you didn't say return type?
[15:13:17] <engla> yes
[15:13:21] <cmr> ok
[15:14:08] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[15:14:30] <sanxiyn> Night everybody
[15:14:35] <bstrie> night!
[15:14:35] *** Quits: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP) (Quit: Leaving)
[15:14:45] <anshin> How can I find documentation for e.g. fmt!()?
[15:15:05] <cmr> anshin: there is none
[15:15:10] *** Parts: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) ()
[15:15:22] <bstrie> anshin: https://gist.github.com/cmr/6137529 helps
[15:15:31] <bstrie> wait not
[15:15:47] <bstrie> I thought those perf summaries were actually format documentation :P
[15:15:53] <cmr> ....lol
[15:16:10] <bstrie> I just came back from vacation, I only had time to skim!
[15:16:23] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:16:23] *** ChanServ sets mode: +o dherman
[15:18:33] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[15:18:50] <anshin> cmr: in that case, I can find e.g. println by searching for "fn println". How can I find fmt! or other macros?
[15:18:57] <cmr> anshin: they aren't documented
[15:19:14] <cmr> the old rustdoc wasn't capable of documenting macros or syntax extensions
[15:19:30] <anshin> cmr: sorry. I was unclear. I meant in the Rust source
[15:19:33] <bstrie> engla: would DST fix the problem of "->&str" always secretly implying "->&'static str", since strings would no longer be special?
[15:19:35] <cmr> anshin: Oh!
[15:19:42] <cmr> anshin: Look in src/libsyntax/ext
[15:19:51] <anshin> cmr: Thanks!
[15:19:51] <cmr> fmt is in fmt.rs
[15:19:58] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[15:20:17] <cmr> anshin: The supporting runtime code is in the src/libstd/unstable/extfmt.rs
[15:20:49] <anshin> cmr: Thanks again
[15:23:49] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Quit: leaving)
[15:24:42] <engla> bstrie: I don't think it has anything to do with string literals or string representation
[15:24:52] <cmr> rusti: 0 == -0
[15:24:53] -rusti- true
[15:25:00] <cmr> rusti: 0f == -0f
[15:25:01] -rusti- true
[15:25:16] <engla> bstrie: you always have to parameterise lifetimes for return values. The exception seems to be 'static which is larger than any other lifetime
[15:28:07] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:28:11] <engla> rusti: static NIL: () = (); fn f() -> &() { &NIL }
[15:28:11] -rusti- ()
[15:30:40] <engla> the only place -> &str is used in our code is in  str.rs, pub unsafe fn slice_bytes(s: &str, begin: uint, end: uint) -> &str
[15:30:54] <bstrie> I'll file an issue about changing it
[15:31:03] <engla> it's used together with transmute, so that's why it can extend the lifetime
[15:31:59] *** Joins: goffrie_ (goffrie@moz-A6D377FA.dsl.ncf.ca)
[15:32:32] <engla> that function should probably encode the lifetime in the function signature even when marked unsafe
[15:32:36] *** Quits: goffrie (goffrie@moz-E9EC021C.dsl.ncf.ca) (Ping timeout)
[15:34:19] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:34:43] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (Connection reset by peer)
[15:34:43] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Connection reset by peer)
[15:34:59] *** Joins: erickt__ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:35:43] *** erickt_ is now known as erickt
[15:38:07] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[15:38:28] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[15:38:55] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Ping timeout)
[15:42:12] <erickt> kimundi: ping
[15:44:05] <engla> bstrie: after this dissection, maybe it's by design? we can accept that -> &T means -> &'static T ?
[15:45:21] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[15:46:12] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[15:46:22] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:47:15] <erickt> sfackler: ping
[15:51:02] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[15:51:37] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:53:06] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:53:08] *** ChanServ sets mode: +o dherman
[15:53:29] *** Joins: TadLondon (tad@514D186.F3BBB17D.144F44FA.IP)
[15:55:19] <kimundi> erickt: trying to rebase, but my llvm won't compile :(
[15:55:30] <erickt> :(
[15:55:31] <bstrie> engla: I'm still going to file the issue. if nothing else we can clarify whether it's an intended redundancy
[15:56:01] <engla> yeah good idea
[15:56:04] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[15:56:56] <kimundi> erickt: gonna try deleting all build artifacts now...
[15:57:20] <erickt> kimundi: did you try doing another build again?
[15:57:31] <kimundi> erickt: twice
[15:57:44] <erickt> shucks
[15:58:02] <erickt> sometimes doing make && make works for me to get through an llvm upgrade
[15:59:19] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:02:32] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[16:02:45] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[16:03:38] <jdm> there's no way to import and export macros yet?
[16:03:39] <jdm> sadness
[16:04:48] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:07:12] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[16:07:37] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[16:10:01] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:12:21] *** Joins: kspaans (kspaans@moz-4EB8D1D8.csclub.uwaterloo.ca)
[16:13:25] *** Joins: steveklabnik (steveklabn@moz-5364052E.z73-46-65.customer.algx.net)
[16:13:47] *** Joins: Florob (Florob@moz-39532932.de)
[16:14:41] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[16:15:06] <Florob> Is there a particular reason unicode.py does not generate unicode::decomp (anymore)?
[16:18:25] *** Quits: cypher (ircnet@moz-EA42E471.static.surfer.at) (Quit: Leaving...)
[16:22:36] *** Quits: TadLondon (tad@514D186.F3BBB17D.144F44FA.IP) (Ping timeout)
[16:23:02] *** Joins: eagen (eagen@15B176CF.7A99C13A.B7961A98.IP)
[16:24:34] <miloshadzic> how would i zip an arbitrary amount of vectors together?
[16:24:59] *** Quits: igl1 (igl@moz-26DABC9F.adsl.alicedsl.de) (Ping timeout)
[16:25:27] <mark_edward> miloshadzic: i'm not sure there's a built in way to do that...
[16:26:27] *** Joins: igl (igl@moz-DE59721C.adsl.alicedsl.de)
[16:26:43] *** Joins: cpeterson (cpeterson@moz-7626A9DE.lmi.net)
[16:26:50] <cmr> rusti: fmt!("%f", 5.82)
[16:26:51] -rusti- ~"5.82"
[16:26:56] <cmr> rusti: fmt!("%f", std::float::NaN)
[16:26:56] -rusti- ~"NaN"
[16:27:14] <miloshadzic> mark_edward, pretty sure that there isn't. I tried making a mutable iterator and then zipping vectors to it but that can't pass the typechecker
[16:27:17] <cmr> rusti: fmt!("%f", -0)
[16:27:18] -rusti- pastebinned 7 lines of output: http://sprunge.us/jUKa
[16:27:20] <cmr> rusti: fmt!("%f", -0f)
[16:27:21] -rusti- ~"-0"
[16:29:29] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[16:29:35] *** Quits: cdidd (cdidd@moz-C645E30B.broadband.corbina.ru) (Input/output error)
[16:30:44] <engla> miloshadzic: there is no adaptor for that. except  .zip(..).zip(..).zip(..)  which makes an awkwardly nested tuple
[16:31:28] <Florob> engla, lispers call them lists ;)
[16:32:00] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:32:26] <engla> hehe
[16:32:28] *** Quits: steveklabnik (steveklabn@moz-5364052E.z73-46-65.customer.algx.net) (Ping timeout)
[16:33:18] <miloshadzic> engla, do you think writing an adapter for that would be "hard"?
[16:33:31] <engla> not really
[16:33:57] <engla> all the adaptors today are very simple
[16:34:11] <engla> none that allocate etc
[16:34:30] <engla> so what is it exactly you want to do. The iterators all have the same type?
[16:35:30] <engla> or, is it about heterogenous zips like   loosely T.zip3(U, V) -> Iterator<(A, B, C)> 
[16:35:31] <miloshadzic> engla, exactly this(sorry for the clojure example): http://stackoverflow.com/a/10523790/78241
[16:35:55] <miloshadzic> the vectors are homogenous
[16:36:01] <engla> ok so that's "zip3" ?
[16:36:11] <engla> yeah but each iterator has a different element type
[16:37:09] <miloshadzic> sorry, zip3?
[16:37:24] <engla> like the example above
[16:37:24] *** Quits: kspaans (kspaans@moz-4EB8D1D8.csclub.uwaterloo.ca) (Quit: leaving)
[16:37:35] <engla> loosely expressed   T.zip3(U, V) -> Iterator<(A, B, C)>
[16:37:44] <engla> where today we have  T.zip(U) -> Iterator<(A, B)> 
[16:37:48] <miloshadzic> oh sorry, thought that you meant that it was somewhere in the library
[16:38:52] <miloshadzic> more like zip for an arbitrary amount of vectors. Like [1,2,3].zip_vec([1,2,3], [1,2,3]) -> [(1,1,1), (2,2,2)]
[16:39:34] <miloshadzic> sorry the output should be [(1,1,1), (2,2,2), (3,3,3)], would be even better if those were vectors not tuples
[16:40:02] <engla> I don't think you can have both in the same implementation. You can have zipN for arbitrary (runtime) number of iterators, but the iterators must all have the same element type
[16:40:05] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:40:18] *** Joins: mihneadb (mihneadb@E48845AB.3A9F9BD4.4C2245EF.IP)
[16:40:19] <engla> or code zip3, zip4 for heterogenous tuple iterators
[16:40:33] <miloshadzic> yeah, vectors of the same type is fine
[16:40:38] <miloshadzic> perfect actually
[16:40:59] <engla> ok, but your linked example wasn't like that :)
[16:41:13] <miloshadzic> engla, I know, sorry about that :)
[16:41:39] <miloshadzic> Any pointers where I should look for inspiration to try and implement it?
[16:43:07] <engla> don't know. look at Zip in iterator, but you'll need to use a ~[T] of iterators and yield a &[A] as iterator element type I guess
[16:43:16] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[16:43:23] <miloshadzic> engla, cool, thanks a lot
[16:44:20] <engla> It's actually tricky to yield elements that are borrowed from the iterator itself
[16:44:26] <engla> could be a flaw
[16:46:29] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[16:46:32] <cpeterson> When I run `rust help` (0.7) installed from Homebrew, rust crashes with: mmap(size=7522747388523884544) failed
[16:47:04] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[16:47:04] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/RQckfg
[16:47:04] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[16:47:20] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: bbll)
[16:47:27] <cmr> cpeterson: known issue, has been fixed on master afaik
[16:47:46] <cpeterson> cmr: thanks, I assumed, but just wanted to make sure <:)
[16:47:53] <cmr> cpeterson: sure, thanks :)
[16:48:08] *** Joins: true_droid (true_droid@moz-123FD9B8.beck.volia.net)
[16:50:00] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:50:00] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/0EKMJA
[16:50:00] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:50:00] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[16:50:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/bvxRVw
[16:50:00] <ghrust> 13rust/06auto 14c327835 15Daniel Micay: fix warning still mentioning the `again` keyword
[16:50:00] <ghrust> 13rust/06auto 142d1eb19 15bors: auto merge of #8292 : thestinger/rust/fix_loop_warning, r=brson
[16:50:01] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[16:50:31] *** Parts: cpeterson (cpeterson@moz-7626A9DE.lmi.net) ()
[16:51:04] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[16:51:41] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:52:47] *** Joins: cypher (ircnet@moz-1D494DB3.vie.surfer.at)
[16:53:02] <kimundi> erickt: I still get an llvm compile error
[16:53:06] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[16:53:50] <mark_edward> do we have any encryption modules in the stdlib yet?
[16:55:25] *** Joins: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net)
[16:56:22] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[16:56:37] <true_droid> does stage2 of Rust build produce the final executable and dylibs to be used by programmers?
[16:56:44] <true_droid> stage3/bin is empty
[16:56:57] <cmr> true_droid: yes
[16:57:01] <kimundi> true_droid: yes
[16:58:28] <joelteon> does anybody know whether I will eventually be able to make a Selectable chan/port pair out of a TcpStream?
[16:58:36] <joelteon> comm_adapters doesn't mention Selectable
[16:58:51] *** Quits: mihneadb (mihneadb@E48845AB.3A9F9BD4.4C2245EF.IP) (Input/output error)
[16:59:04] <olsonjeffery> what's the env var to set to see the output of rtdebug! ?
[16:59:34] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[17:00:10] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:00:25] *** Quits: StarLight (StarLight@moz-2BB01424.dynamic.avangarddsl.ru) (Ping timeout)
[17:01:01] *** Joins: mihneadb (mihneadb@E48845AB.3A9F9BD4.4C2245EF.IP)
[17:01:40] *** Joins: jephir (jephir@moz-94BDA6BA.dsl.teksavvy.com)
[17:02:27] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:03:01] *** Joins: steveklabnik (steveklabn@moz-5364052E.z73-46-65.customer.algx.net)
[17:03:44] <jephir> hi, anyone know how to solve this error? "error: cannot move out of captured outer variable in a heap closure"
[17:03:50] <jephir> code is here: https://gist.github.com/jephir/f72dafabe078d09fcabf#file-http-rs-L90
[17:04:03] <jdm> cmr: can't get enough of triage, can you?
[17:04:06] <cmr> jephir: https://github.com/mozilla/rust/wiki/Doc-under-construction-FAQ#once-functions
[17:04:19] *** Joins: StarLight (StarLight@moz-14366CBD.dynamic.avangarddsl.ru)
[17:04:20] <cmr> jdm: I get 100 every week
[17:04:26] <cmr> (although the past two weeks I've been slacking)
[17:04:34] *** Quits: eagen (eagen@15B176CF.7A99C13A.B7961A98.IP) (Ping timeout)
[17:04:34] <olsonjeffery> cmr: btw, the rustdoc_ng stuff is great.. who's working on the frontend?
[17:04:39] <jdm> cmr: are they all on monday, or do you just save them until monday? :)
[17:04:40] <cmr> olsonjeffery: Seldaek is
[17:04:52] <cmr> jdm: graydon's bot sends the email on monday
[17:04:53] <jephir> thanks cmr, i'll look at that
[17:04:54] <olsonjeffery> and what's the perf? thank it could be used for some kind of etags/autocomplete type stuff?
[17:04:55] <jdm> ah
[17:04:56] <cmr> I usually do them thursday
[17:05:08] <cmr> olsonjeffery: No, definitely not, perf is abyssmal right now
[17:05:22] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:05:22] *** ChanServ sets mode: +o tjc
[17:05:28] <cmr> olsonjeffery: it would be 2-3x faster if rustc let me stop after typeck rather than running coherence checking and all that stuff
[17:05:39] *** Joins: thomaslee (thomaslee@moz-6C3931E3.static.twtelecom.net)
[17:05:41] <joelteon> why is this happening? https://gist.github.com/joelteon/6157568
[17:05:44] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[17:05:45] <cmr> https://github.com/mozilla/rust/blob/master/src/librustc/driver/driver.rs#L255
[17:05:52] <joelteon> oh whoops
[17:05:54] <joelteon> wrong program nvm
[17:05:57] <cmr> Would be broken into two more passes
[17:06:12] <cmr> olsonjeffery: Anyway, the generated json could definitely be used for autocomplete
[17:06:25] <cmr> olsonjeffery: doomlord is working on some ctags stuff
[17:07:22] <cmr> olsonjeffery: basically all the time is spent in rustc though
[17:08:13] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Client exited)
[17:09:45] <joelteon> is there a tutorial for proto!
[17:09:54] <joelteon> I don't really understand how it works
[17:10:01] <cmr> joelteon: it has been removed
[17:10:09] <joelteon> proto or the tutorial?
[17:10:11] <cmr> proto!
[17:10:13] <joelteon> oh
[17:10:18] <joelteon> is there a replacement?
[17:10:19] <cmr> no
[17:10:22] <joelteon> oh
[17:10:27] <joelteon> well, never mind then
[17:10:29] <joelteon> it looked kinda cool
[17:10:30] <cmr> I mean all it did was generate a state machine
[17:10:33] <cmr> "all"
[17:10:40] <joelteon> i see
[17:10:41] <engla> miloshadzic: did you come up with a working adaptor?
[17:10:42] <joelteon> ok
[17:10:43] <cmr> it was pretty cool, but was old and maintenance burden
[17:10:57] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[17:11:04] <joelteon> ok, close enough
[17:11:28] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:11:50] *** Joins: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de)
[17:13:26] <joelteon> well
[17:13:37] <joelteon> I'll just keep reading TWiR and wait until I can make a chan out of a tcp socket
[17:14:10] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[17:15:10] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Connection reset by peer)
[17:15:19] *** Joins: Luqman (laden@moz-345B5EBA.csclub.uwaterloo.ca)
[17:15:32] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:15:42] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[17:15:44] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[17:15:49] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:16:10] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[17:16:39] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[17:23:34] <bjz> jeaye: ping
[17:24:20] <miloshadzic> engla, sorry not yet. I did manage to make a pretty nice dinner :)
[17:25:14] *** Quits: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de) (Connection reset by peer)
[17:25:55] <jeaye> bjz: pong
[17:26:16] <jeaye> bjz: Didn't have a chance to try that window destruction out yet.
[17:26:18] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Quit: Leaving)
[17:26:36] <bjz> jeaye: have you had any experience with bullet?
[17:27:01] *** Joins: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de)
[17:27:31] <jeaye> bjz: I've used it only briefly with a small project a few years ago. I wouldn't count that as experience anymore.
[17:27:31] *** Joins: paupau (textual@205C99BA.79CCD72B.F20F0C5A.IP)
[17:27:33] <maikklein> what is the replacement of PlatformScheduler? is it DefaultScheduler?
[17:27:38] <jeaye> Why, you planning to wrap it, bjz?
[17:27:41] <bjz> jeaye: I looked at the C api, and it's kinda like tumbleweed
[17:28:08] <bjz> jeaye: only a fraction of the functionality is covered
[17:28:18] <bjz> :(
[17:28:29] *** Joins: TadTrain (tad@4F553A44.5698AFB7.4966A68C.IP)
[17:28:32] <jeaye> Ah, I'm a C++ guy, so I didn't run into that. :|
[17:28:40] <bjz> hehe
[17:28:47] <jeaye> What do you need it for?
[17:29:38] <bjz> jeaye: was just curious. might be useful in the future
[17:29:41] <doomlord> i think this is a general problem - whats the best way of making an interfact to a c++ library (dealing with overloading .. )
[17:30:25] <bjz> aye
[17:30:40] <jeaye> doomlord: That's a tough problem.
[17:31:16] *** Quits: jephir (jephir@moz-94BDA6BA.dsl.teksavvy.com) (Quit: Leaving)
[17:32:16] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[17:32:24] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:32:24] *** ChanServ sets mode: +o tjc
[17:32:27] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[17:32:51] <bjz> c++ doesn't really play nice when it comes to working with other languages :(
[17:33:08] <bjz> dunno how Rust will fare in that regard
[17:34:17] <sp3d> yeah, I was thinking about that a little, it'd suck to have rust be the kind of language where people say "oh well I can't really use that... it's in <unlinkable language>/C++"
[17:34:26] <doomlord> the price of templates & overloading being so expressive  :)
[17:34:38] <sp3d> but I think that has to do mostly with ABI and calling convention?
[17:34:39] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:34:49] <cmr> No, the ABI/CC is fine
[17:34:54] <cmr> It's the metaprogramming
[17:35:13] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:35:13] *** ChanServ sets mode: +o pcwalton
[17:36:04] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[17:36:05] <tjc> Has anyone else gotten an error Undefined symbols for architecture x86_64:
[17:36:05] <tjc>   "_LLVMBuildAtomicRMW"
[17:36:11] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[17:36:12] *** Joins: mib_ez2pnb (Mibbit@894D2C62.9F275360.C28326FD.IP)
[17:36:13] <tjc> when building librustllvm?
[17:36:16] <cmr> tjc: did you rebuild llvm?
[17:36:31] <tjc> cmr: I blew away the build directory, started over, and got the same error
[17:36:47] <mib_ez2pnb> is it possible to call a function pointer to c++ func from rust?
[17:36:59] <cmr> tjc: I haven't gotten that :(
[17:37:09] <tjc> I'm on OS X, if that matters
[17:37:11] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:37:12] <cmr> mib_ez2pnb: no
[17:37:39] <tjc> Oh, never mind
[17:37:46] <cmr> mib_ez2pnb: not using the C++ calling convention at least
[17:37:53] <tjc> I accidentally committed with a different src/llvm revision
[17:37:55] <tjc> *facepalm*
[17:38:07] <tjc> git submodules, I hate you
[17:38:09] <mib_ez2pnb> cmr: which calling convention is required in that case?
[17:38:22] <cmr> mib_ez2pnb: thiscall I think
[17:38:31] <cmr> Or, that's for method calls, sorry.
[17:38:43] <cmr> If you have an extern "C" in the C++ it will be fine
[17:39:46] *** Joins: Home (chatzilla@moz-65C5BBC4.dynamic.isp.telekom.rs)
[17:39:59] <mib_ez2pnb> i have __stdcall on c++ and extern "stdcall" fn on rust...https://gist.github.com/anonymous/6155711
[17:40:30] <mib_ez2pnb> i'm able to successfully invoke the function, but the parameters are screwed up...
[17:40:42] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:41:17] <sully> ... my rust build just failed building llvm
[17:41:18] <sully> uhoh
[17:41:28] *** Joins: umbridge (Mibbit@moz-D3D15A0C.vie.surfer.at)
[17:41:44] <acrichto> sully: run 'make' again
[17:41:46] <sully> ok
[17:42:11] <acrichto> llvm is weird sometimes
[17:44:15] <sully> ok.
[17:45:31] <pcwalton> sully: acrichto found a bunch of &Trait breakage that was blocking him if you weren't aware
[17:46:13] <doomlord> cmr - i wonder if i could make 'rustfind' spit out an html link for 'rustdoc' ..
[17:46:23] <cmr> doomlord: I was thinking about that last night
[17:46:27] * pcwalton liked the name "rustle" for rustfind
[17:46:30] <sully> acrichto: oh, rock! you file bugs?
[17:46:38] <cmr> pcwalton: rustle is something different
[17:46:48] <cmr> dbp is working on it again, with rustdoc_ng integration
[17:46:57] <pcwalton> oh, cool
[17:47:30] <doomlord> what is rustle ?
[17:47:36] <cmr> search by type signature
[17:47:45] <cmr> like hoogle
[17:47:49] <doomlord> oh wow, like hoogle 
[17:47:59] <doomlord> thats an awesome tool
[17:48:17] <umbridge> Maybe interesting to some of you: First info on the new language designed by Tim Sweeney and some guys at Intel, called "Lambda Aleph": http://www.leafpetersen.com/leaf/publications/dtp2013/lambda-aleph-overview.pdf and http://arxiv.org/pdf/1307.5277v1.pdf
[17:48:26] <mib_ez2pnb> cmr, pcwalton: any idea why this is happening: https://gist.github.com/anonymous/6155711
[17:48:42] <pcwalton> mib_ez2pnb: please file a bug
[17:49:10] *** Joins: jensn (jensn@moz-32C5EE18.mobileonline.telia.com)
[17:49:11] <doomlord> would this be a rust competitor. i remember seeing the old tim-sweeny slides and thinking "rust has 2/3rds of what he wanted.."
[17:49:26] <pcwalton> interesting
[17:49:28] * pcwalton skims the paper
[17:49:44] <tjc> doomlord: I don't think it's in the same space as Rust. Rust doesn't have dependent types.
[17:49:48] <mib_ez2pnb> pcwalton: i would, but i want to make sure the code is not incorrect...
[17:50:18] <pcwalton> doomlord: it seems somewhat orthogonal, from skimming. it's a theoretical mini-language
[17:50:19] <acrichto> sully: yeah, somewhere in your inbox :P
[17:50:30] <pcwalton> not an actual implementation
[17:50:35] <pcwalton> I don't see anything about implementation
[17:50:59] <doomlord> ok pure reesearch
[17:51:41] <umbridge> Few more papers from one of the Intel guys here: http://www.leafpetersen.com/leaf/publications.htm
[17:52:28] <pcwalton> I wouldn't be surprised if they're working on a practical language derived from lambda-aleph though
[17:52:41] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Quit: jorendorff)
[17:53:40] <pcwalton> kind of surprised they don't cite ATS
[17:53:50] <pcwalton> but I guess there a lot of dependently-typed languages out there
[17:54:21] <pcwalton> mib_ez2pnb: it looks right to me.
[17:55:02] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[17:55:14] *** Quits: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:56:01] <maikklein> bjz, https://github.com/bjz/glfw-rs/pull/25
[17:56:12] <mib_ez2pnb> pcwalton: ha...i'm relieved...i couldn't find any test cases that covers a scenario where extern fn's are invoked through pointer..
[17:56:14] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[17:56:18] <sully> acrichto: which email?
[17:56:23] <cmr> mib_ez2pnb: pcwalton it doesn't look right to me. don't rust method calls include the tydesc pointer?
[17:56:43] <cmr> oh wait i'mre ading it wrong
[17:56:45] <cmr> sorry
[17:56:46] <mib_ez2pnb> cmr: the method is just a wrapper
[17:56:50] <cmr> right
[17:56:54] <acrichto> sully: 824{8,9}
[17:57:07] <bjz> maikklein: have you tested the examples?
[17:57:12] *** Quits: TadTrain (tad@4F553A44.5698AFB7.4966A68C.IP) (Client exited)
[17:57:26] <sully> oh, you mean I got bugmail
[17:57:30] <sully> not that you emailed me about it
[17:57:36] <sully> my bugmail goes to /dev/null, mostly
[17:57:37] <sully> >_>
[17:57:52] *** Joins: nano (nano@moz-972880B.superkabel.de)
[17:58:10] <mib_ez2pnb> how do i generate the assembly file in rust?
[17:58:17] <cmr> mib_ez2pnb: rustc -S
[17:58:24] <maikklein> bjz, only a few of them
[17:58:24] <cmr> (also rustc -S --emit-llvm for llvm IR)
[17:58:47] <maikklein> bjz, we only have two schedulers atm the default one and a SingleThreaded
[17:59:01] <maikklein> bjz, seems I have to update some examples too 
[17:59:03] <bjz> maikklein: I know
[17:59:08] <mib_ez2pnb> cmr: thanks, 
[17:59:19] <maikklein> bjz, I update the examples and do the tests
[17:59:28] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[17:59:40] <bjz> maikklein: pcwalton and brson were talking about it yesterday
[18:00:12] <mib_ez2pnb> also on 64 bit linux build, the size of 'int' in g++ is 4 bytes while in rust it is 8. Is this right?
[18:00:19] <cmr> mib_ez2pnb: yes
[18:00:23] <cmr> int is pointer-sized
[18:00:27] <cmr> i32 is 32 bits
[18:00:52] <cmr> there is std::libc::c_int for the C types
[18:01:39] <mib_ez2pnb> why does g++ still use 4 byte int. isn't int defined as size of machine word?
[18:01:47] <cmr> no
[18:01:56] *** Quits: jensn (jensn@moz-32C5EE18.mobileonline.telia.com) (Quit: jensn)
[18:01:57] <maikklein> bjz, no default.rs doesn't work
[18:02:28] <bjz> yeah :(
[18:02:35] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:02:43] <bjz> will have to look ate what sprocket does
[18:02:58] <jeaye> mib_ez2pnb: C++ just needs int to be atleast 32 bits. It could be 64 on some implementation somewhere.
[18:02:59] <bjz> apparently it's running atm, using SDL
[18:03:04] <jeaye> But it's generally not.
[18:03:21] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:03:58] <mib_ez2pnb> jeaye, cmr: ha...but i guess that the definition of int holds in rust
[18:04:10] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:05:47] *** Joins: cdidd (cdidd@moz-1858598B.broadband.corbina.ru)
[18:06:27] <jeaye> mib_ez2pnb: In Rust, and almost always in C++,  I just use fixed-width integral types. It's too easy to expect the width of a type to be something and have it be something else entirely.
[18:06:38] <cmr> yup
[18:06:54] <ecr> I'd much rather people use i32 and i64 than int.
[18:06:56] * jeaye had a ery annoying bug with this and OpenGL when he started Rust. 'floats' turned out being a lot bigger than he thought. :P
[18:07:27] <maikklein> bjz, okay it works now when I use "task::spawn_sched(task::DefaultScheduler)"
[18:07:28] <kmc> mib_ez2pnb: http://www.unix.org/version2/whatsnew/lp64_wp.html
[18:07:38] <kmc> http://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models
[18:07:41] <maikklein> bjz, strange I thought spawn uses the default one
[18:07:53] <bjz> maikklein: orly? odd
[18:08:01] <bjz> pcwalton: ^?
[18:08:36] <erickt> brianm: I've got https://github.com/erickt/rustcrypto, but it needs to be updated to rust HEAD
[18:08:46] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:09:07] <brianm> erickt: I think you meant to target someone else
[18:09:12] <cmr> Someone else was working on crypto too
[18:09:25] <mib_ez2pnb> kmc: thanks, really comprehensive
[18:09:27] <cmr> jensnockert maybe
[18:10:23] <maikklein> bjz, when I was using just spawn I was getting "rust: task 1619ff0 ran out of stack"
[18:10:34] <erickt> brianm: oops, sorry
[18:10:35] <mib_ez2pnb> has anyone tried to invoke an extern function through a pointer and succeeded?
[18:10:46] <erickt> mark_edward: I've got https://github.com/erickt/rustcrypto, but it needs to be updated to rust HEAD
[18:10:59] <bjz> mib_ez2pnb: it's broked atm
[18:11:08] <bjz> mib_ez2pnb: oh wait
[18:11:25] <bjz> mib_ez2pnb: oh actully yes
[18:12:00] <bjz> mib_ez2pnb: you can send fn ptrs to C libs, but you can't call them
[18:12:17] <mib_ez2pnb> bjz: how difficult is it to fix? i have some spare time...
[18:12:24] <kmc> you can call them if they're declared extern "C" right?
[18:12:27] <bjz> mib_ez2pnb: talk to nmatsakis
[18:13:22] <bjz> mib_ez2pnb: what exactly is your problem?
[18:13:40] <mib_ez2pnb> bjz: https://gist.github.com/anonymous/6155711
[18:14:02] *** Joins: jensn (jensn@moz-32C5EE18.mobileonline.telia.com)
[18:14:43] <mib_ez2pnb> bjz: both the rust and msvc generated code were 32 bit.
[18:14:57] <cmr> Oh you're using windows
[18:14:59] <cmr> that might be the problem
[18:15:07] <cmr> Windows isn't really well-tested
[18:15:17] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:15:26] <bjz> haha
[18:15:39] <cmr> Rust on Windows, that is :p
[18:15:41] <mib_ez2pnb> cmr: maybe...but right now, i tried a very simple program on 64 bit ubuntu....
[18:15:41] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[18:15:53] <mib_ez2pnb> the results are worse than windows
[18:16:09] <mib_ez2pnb> at least on windows i was able to invoke the function
[18:16:23] <mib_ez2pnb> but on linux, it just crashes at the site of invocation
[18:16:57] *** Joins: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net)
[18:16:58] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[18:17:53] *** Joins: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com)
[18:18:34] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[18:19:41] <maikklein> bjz,  also lmath is broken again :p
[18:20:24] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:21:03] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:21:03] *** ChanServ sets mode: +o brson
[18:22:32] <kmc> what is the in-memory representation of &Trait / @Trait
[18:22:46] <cmr> kmc: pointer to vtable, pointer to object
[18:22:54] <kmc> ok
[18:22:59] <cmr> object as in struct/enum
[18:23:29] <kmc> if the trait has no methods is the vtable pointer useless, NULL, or is it not present at all?
[18:23:47] <cmr> I do not know
[18:24:11] <cmr> I can't imagine why you'd want a trait object that you can't do anything with though
[18:24:13] *** Quits: jensn (jensn@moz-32C5EE18.mobileonline.telia.com) (Quit: jensn)
[18:24:38] <kmc> the local_data module has pub trait LocalData { }; impl<T: 'static> LocalData for @T { }
[18:24:56] <kmc> and then stores @LocalData values in a map
[18:26:06] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[18:26:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/bvxRVw
[18:26:06] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[18:28:58] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[18:28:58] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/53pGGQ
[18:28:58] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[18:28:58] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[18:28:58] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/j8sYJQ
[18:28:58] <ghrust> 13rust/06auto 14d49bb43 15Dmitry Ermolov: Implemented iterator for TrieMap...
[18:28:58] <ghrust> 13rust/06auto 1428165d5 15Dmitry Ermolov: Remove debug printing.
[18:28:58] <ghrust> 13rust/06auto 14d8b299d 15bors: auto merge of #8293 : dim-an/rust/trie-iterator, r=thestinger...
[18:29:00] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[18:29:57] *** Quits: Home (chatzilla@moz-65C5BBC4.dynamic.isp.telekom.rs) (Broken pipe)
[18:30:59] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:31:06] *** Quits: mib_ez2pnb (Mibbit@894D2C62.9F275360.C28326FD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:31:25] <kimundi> erickt: hu.... I rebased, tested, and didn't gat any test failure
[18:32:03] *** Joins: Florob (Florob@moz-39532932.de)
[18:32:20] *** Joins: Ms2ger (Ms2ger@EDC982F3.6890FC55.187A1082.IP)
[18:32:44] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[18:32:55] *** Quits: nonehaxor (nonehaxor@BA9CBAE.4C3B0355.EE6E63A5.IP) (Ping timeout)
[18:32:56] <kimundi> erickt: coult you tell bors to retry the pr?
[18:33:34] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[18:33:55] <brson> ecr: ping
[18:35:05] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:35:05] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Connection reset by peer)
[18:35:07] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[18:35:19] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:35:20] <kmc> I didn't even know that browsers do XSLT... ;_;
[18:35:26] <kmc> whoops wrong channel
[18:35:43] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[18:36:04] *** Quits: umbridge (Mibbit@moz-D3D15A0C.vie.surfer.at) (Quit: http://www.mibbit.com ajax IRC Client)
[18:37:37] <kmc> bblum: I like your class/enum names in https://github.com/mozilla/rust/issues/3039
[18:37:37] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Connection reset by peer)
[18:37:39] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[18:37:57] <kmc> also it's interesting reading year old bug reports and trying to work out what the language syntax used to be
[18:37:58] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[18:38:01] *** Joins: nonehaxor (nonehaxor@BA9CBAE.4C3B0355.EE6E63A5.IP)
[18:38:02] <kimundi> brson: r+? https://github.com/mozilla/rust/pull/8288 - erickt already reviewed it, just needed a rebase
[18:38:08] <cmr> kmc: yes it is
[18:38:15] <bblum> kmc: thanks :P
[18:38:43] <bblum> kmc: oh man that is charmingly old syntax
[18:38:52] <bblum> (not bogglingly old syntax, which would be before my time entirely)
[18:39:40] <bstrie> haha. classes and alt check, oh my
[18:40:04] <jdm> those were the days
[18:40:14] <pnkfelix> pcwalton: if you want me to have a go at finishing off the visitor work (and assign you as reviewer), I'd be happy to do so.  but if you've already got it 75% finished then I won't dupe the effort.
[18:40:15] <bblum> they were certainly days
[18:40:21] <jdm> when declaring local vars looks like "auto foo"
[18:41:20] <ecr> brson: pong
[18:41:41] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[18:42:14] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[18:43:38] <steveklabnik> this is a bit off topic, but does anyone know how i'd test the value of prefix in autoconf?
[18:43:42] <steveklabnik> :)
[18:45:02] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[18:45:12] <pcwalton> pnkfelix: I've got nothing done beyond that patch
[18:45:16] <pcwalton> so feel free to grab it!
[18:45:25] <pnkfelix> pcwalton: cool-cool.
[18:45:28] <pcwalton> that would be a big help, I'm just doing it to get rid of @fn
[18:45:35] *** Quits: Luqman (laden@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[18:45:37] <pcwalton> but there are other things I can prioritize
[18:45:41] <brson> ecr: Can you start working on making the I/O types threadsafe, i.e. always do I/O on the correct scheduler? This is going to be our biggest priority once the new scheduler is turned on.
[18:46:54] <pnkfelix> pcwalton: sure, I'm happy to take over.  (I'll make sure to first get rid of @fn, to make you happy, and leave the other stuff like moving away from @Trait and/or moving to something like aatch's visitor interface for afterward)
[18:49:27] *** Joins: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP)
[18:49:39] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[18:50:59] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[18:51:15] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:52:28] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[18:53:09] *** Joins: cyndis (cyndis@moz-677BEAB.kyla.fi)
[18:54:01] <sully> hey, just pushed a "little things" PR
[18:54:08] <sully> can anybody take a look: https://github.com/mozilla/rust/pull/8313
[18:54:24] <tjc> sully: I'll look
[18:54:29] <sully> I think the only possibly controversial thing in it is that I make the compiler warn when you use -o for a library
[18:54:42] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[18:54:45] <cmr> Why?
[18:55:01] <sully> (there used to be a bug open to do exactly that, then it got closed prematurely, now there is a different bug just saying that -o doesn't do anything sensible...)
[18:55:08] <cmr> ah it doesn't work properly
[18:55:09] <tjc> cmr: I take it because it was already ignored anyway -- see https://github.com/mozilla/rust/issues/6554
[18:55:10] <sully> because -o isn't really listened to for libraries
[18:55:11] <cmr> ok
[18:55:13] <cmr> yeah
[18:55:15] <ecr> brson: Sure. That's what I'm looking into right now.
[18:55:19] <brson> ecr: awesome
[18:55:45] <ecr> brson: I figured I'd dive into the sched/task code and make sure I have a handle on what's going on first.
[18:55:52] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:55:53] <brson> ok
[18:55:55] <sully> hey, tjc, hold off on that for 2 minutes?
[18:56:01] <tjc> sully: Sure
[18:56:20] <tjc> sully: commented with one suggestion -- to make the NOTEs FIXMEs with issue numbers instead of removing the NOTE part
[18:56:25] <sully> just realized I didn't delete a function I made dead
[18:56:48] <brson> ecr: we're also going to have to start thinking about how I/O timeouts affect the scheduler. when we're waiting on I/O we want to make sure that we drop back into the event loop at every opportunity to let that I/O happen. atm there are workloads that never defer to the scheduler and will cause timeouts
[18:57:09] *** Joins: fabiand (fabiand@moz-4D04EC8E.adsl.alicedsl.de)
[18:57:12] <sully> tjc: I'm not totally sure how I feel about that sort of issue, though; the like "There is a FIXME, and I don't understand what it means, but oh well..." issues
[18:57:18] <brson> well, workloads that *could* defer to the scheduler but don't. obviously iloops just screw us
[18:57:35] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[18:57:40] <tjc> sully: if you want to be really diligent, you could do a `git blame` and ask the author what they meant...
[18:57:57] <tjc> either something needs to be fixed and it should have an issue number, or there's really no problem and the comment should be removed
[18:57:57] <tjc> IMO
[18:58:18] <tjc> I don't like the whole "something needs to be done but I'll ensure that it'll never actually get done by not using the bug tracker" business
[18:58:39] <sully> yeah, I definitely see your side as well
[18:58:56] <tjc> not blaming you here, I'm blaming the people who wrote the comments for not being clearer :-)
[18:59:02] <sully> the construct.rs note in particular, though, doesn't seem like it is worth a bug opened
[18:59:13] <tjc> Yeah, I'm not sure what that means
[18:59:15] <sully> because like, "experimental unused cfg code still experimental"...
[18:59:26] <tjc> Oh, didn't realize that code was unused
[18:59:27] *** bent is now known as bent|lunch
[18:59:46] <sfackler> sully: -o is respected when compiling a lib, at least when the lib doesn't define a name itself
[18:59:47] <ecr> brson: roger that
[18:59:58] <cmr> Anyone else having trouble applying labels on github?
[19:00:00] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:00:45] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:00:46] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[19:00:56] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[19:02:39] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:04:43] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:04:43] *** Joins: maikklein2 (maik@moz-CE8DD265.dip0.t-ipconnect.de)
[19:04:46] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[19:05:34] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:05:37] *** Quits: maikklein (maik@moz-E6B4E665.dip0.t-ipconnect.de) (Ping timeout)
[19:06:27] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:06:53] <miloshadzic> engla, honestly I'm giving up. I can't even write the type signature. I'll write an imperative function to do it until I know Rust better
[19:07:23] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[19:07:35] *** Quits: paupau (textual@205C99BA.79CCD72B.F20F0C5A.IP) (Ping timeout)
[19:08:00] <engla> miloshadzic: maybe you can use the simple experiment i wrote
[19:09:10] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:09:15] <engla> miloshadzic: https://gist.github.com/anonymous/0bf16a4a564f8bb88d71
[19:09:23] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[19:09:47] <miloshadzic> engla, wow thanks
[19:09:54] <engla> iterator element has to be a ~[] I think
[19:12:01] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[19:12:18] <engla> the line with 'let mut ret = ~[]' should be let mut ret = std::vec::with_capacity(self.iters.len());  for at least not allocating twice
[19:13:54] *** Quits: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[19:15:57] <sully> brson: ping
[19:17:21] *** Joins: Simon80 (Mibbit@moz-F1ED47A9.cpe.teksavvy.com)
[19:17:32] <miloshadzic> engla: this is what I needed, thanks. I'd maybe name it interleave and make it work on self. Any chance of this making it into the std lib?
[19:18:09] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Ping timeout)
[19:18:19] <engla> miloshadzic: by interleave I would see  AAAA.. BBBB... -> ABABAB.. i.e. interleaving the elements by alternating
[19:18:48] *** Joins: jensn (jensn@moz-32C5EE18.mobileonline.telia.com)
[19:19:05] <brson> sully: pong
[19:19:19] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[19:19:29] <sully> brson: in flate.rs, you have a NOTE, saying, "These ultimately belong somewhere else"
[19:19:38] <sully> brson: do you know what you mean by that; is this still true?
[19:19:41] <miloshadzic> engla, makes sense
[19:19:51] <brson> sully: i believe flate should go in extra, not std
[19:19:52] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Ping timeout)
[19:20:04] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[19:20:06] *** Quits: fabiand (fabiand@moz-4D04EC8E.adsl.alicedsl.de) (Quit: Verlassend)
[19:20:19] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:20:42] *** Joins: igl1 (igl@moz-7572D644.adsl.alicedsl.de)
[19:20:47] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0a2/20130726004002])
[19:20:49] <sully> brson: ok
[19:21:27] *** Quits: igl (igl@moz-DE59721C.adsl.alicedsl.de) (Ping timeout)
[19:21:48] <brson> guess I should have said that instead of being so cryptic
[19:21:50] <engla> miloshadzic: no idea if it's material for libstd
[19:23:30] *** Quits: maikklein2 (maik@moz-CE8DD265.dip0.t-ipconnect.de) (Ping timeout)
[19:23:39] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[19:23:40] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Quit: victorporof)
[19:24:04] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[19:24:38] <brson> what's the right way to parse a string as a uint?
[19:25:12] *** Joins: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP)
[19:25:22] <sfackler> brson: FromStr::from_str::uint(s) ?
[19:25:23] *** Quits: cdidd (cdidd@moz-1858598B.broadband.corbina.ru) (Connection reset by peer)
[19:25:44] <sfackler> er, FromStr::from_str::<uint>(s)
[19:25:49] <brson> thanks
[19:25:59] <engla> there is FromStr and FromStrRadix
[19:26:52] *** Quits: cyndis (cyndis@moz-677BEAB.kyla.fi) (Quit: leaving)
[19:27:12] <brson> good old from_str::FromStr::from_str. the definition of elegance
[19:27:50] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[19:28:00] <bstrie> brson: I was moaning about that the other day :P
[19:28:53] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[19:29:16] <steven_is_false> Can anyone help explain what bblum means here: https://github.com/mozilla/rust/issues/5942#issuecomment-22128049 ?
[19:29:50] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:30:34] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:30:39] <sully> tjc: ok, I updated the PR
[19:30:46] *** Joins: cdidd (cdidd@moz-EFDE14D1.broadband.corbina.ru)
[19:30:58] <tjc> sully: looking
[19:31:41] <tjc> sully: r+'ed, thanks!
[19:31:59] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[19:32:07] <sully> awesome, thank you
[19:32:28] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[19:35:26] <jedestep> rusti: use extra::json::Encoder; use std::io::stdout; #[deriving(Encodable)]struct Foo; let foo = Foo; foo.encode(Encoder(stdout()));
[19:35:57] <cmr> deriving doesn't work in rusti since it runs the input in a function body
[19:36:27] <jedestep> blergh
[19:36:33] <kmc> cmr: I think linkers will resolve relocations in any section
[19:36:41] <jedestep> deriving(Encodable) isn't working for me
[19:36:49] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:36:57] <kmc> an oldschool use case for relocations in rodata would be an ops struct that points to functions in another compilation unit
[19:37:29] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[19:37:30] <jedestep> I have #[deriving(Encodable)]pub struct Crate {...} ........ crate.encode(encoder)
[19:38:21] <jedestep> never mind I'm just bad at importing.
[19:39:13] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Ping timeout)
[19:45:26] *** Joins: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com)
[19:45:39] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:46:49] *** Quits: jensn (jensn@moz-32C5EE18.mobileonline.telia.com) (Quit: jensn)
[19:47:36] *** Joins: Sergio965 (sergiobz@CFE01F07.996A1888.3A99D594.IP)
[19:47:47] <Sergio965> Is there a way to get the file name and line number in a macro?
[19:48:12] <cmr> file!(), line!()
[19:48:17] <cmr> or, I dunno actually
[19:48:22] <cmr> I don't know how that interacts with expansion
[19:48:23] <pauls> Sergio965: try `file!()` and `line!()`, but I don't remember whether they work.
[19:48:54] *** Quits: sebcrozet (sebcrozet@moz-D8879CC3.w80-13.abo.wanadoo.fr) (Client exited)
[19:49:10] <pauls> cmr: they're supposed to be the original invocation site. 
[19:49:49] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[19:50:04] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[19:52:08] *** Joins: jensn (jensn@moz-32C5EE18.mobileonline.telia.com)
[19:54:00] <Sergio965> That seems to work.
[19:54:04] <Sergio965> Thanks!
[19:54:12] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:54:29] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[19:54:54] *** Joins: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu)
[19:54:59] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:55:07] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[20:00:44] <brson> graydon: where are you?
[20:01:51] <tjc> asking on IRC will likely not help :-)
[20:01:57] <bstrie> uh oh, llvm update
[20:02:09] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[20:02:32] <bstrie> new llvm build == You Will Not Build Rust Today
[20:02:40] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz)
[20:02:41] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:02:51] <tjc> new llvm build == party time
[20:03:12] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[20:03:16] *** Joins: gareth0 (gareth0@moz-A2DA68D9.dynamic.dsl.as9105.com)
[20:03:26] <tjc> perfect time to work on documentation :-)
[20:03:43] <bstrie> I have to build pandoc to work on documentation :-(
[20:03:56] <tjc> I find that with documentation, getting it to build isn't the hard part :-)
[20:03:56] *** Parts: Simon80 (Mibbit@moz-F1ED47A9.cpe.teksavvy.com) ()
[20:04:04] <bstrie> You Will Not Resolve Haskell Dependencies Today
[20:04:55] <bstrie> actually last time I installed pandoc from repo it seemed fine, but strcat seems to have horror stories of keeping it working on arch
[20:05:29] <bstrie> I really just wanted to play with bigints, but rusti isn't even here :(
[20:05:54] <orshem> i need a little help understanding rc.rs from libextra
[20:05:58] <smvv> same here. in the end I used `cabal' instead of portage to avoid all the dependency issues
[20:06:04] <orshem> specifically in this line https://github.com/mozilla/rust/blob/master/src/libextra/rc.rs#L78
[20:06:19] <orshem> where is is_not_null() defined?
[20:06:19] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[20:07:02] <engla> orshem: std::ptr::RawPtr
[20:07:10] <smvv> rust/src/libstd/ptr.rs
[20:07:10] *** Joins: maikklein2 (maik@moz-18E00DC1.dip0.t-ipconnect.de)
[20:07:45] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:07:52] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[20:07:58] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[20:07:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/j8sYJQ
[20:07:58] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[20:08:05] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[20:08:08] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[20:08:14] <orshem> engla, thanks! but where is it imported into scope?
[20:08:24] <engla> it must be in the prelude
[20:09:17] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[20:09:20] <orshem> engla, i can't call it from my code
[20:09:44] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:09:48] <engla> where is your code?
[20:10:02] <orshem> engla, one sec
[20:10:15] <engla> as in, is it in libstd?
[20:10:29] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:10:58] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[20:10:59] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/K9mUbA
[20:10:59] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[20:10:59] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[20:11:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/KCaotQ
[20:11:00] <ghrust> 13rust/06auto 144ddfceb 15Marvin Lbel: Updated std::Option, std::Either and std::Result...
[20:11:00] <ghrust> 13rust/06auto 14e1656ec 15bors: auto merge of #8288 : Kimundi/rust/opteitres4, r=brson...
[20:11:00] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[20:11:13] <orshem> engla, https://gist.github.com/dovreshef/6159147
[20:11:38] <engla> is_not_null is a method on *T and *mut T
[20:11:44] <orshem> i feel very powerful, messing with unsafe, but it is probably wholly incorrect
[20:11:54] <engla> not on &T (which is *never* NULL)
[20:12:13] *** Joins: jviereck1 (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:12:24] <orshem> I see. thanks!
[20:13:06] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Ping timeout)
[20:13:14] <engla> is_not_null is a method in the RawPtr trait after all
[20:13:56] <smvv> orshem: out of curiosity; why so many unsafe blocks?
[20:14:07] <doomlord_> i've seen 'Either<A,B>' and Option<T> .. is there something like enum ValueOrError<T,E> { struct Ok(T),struct Error(E) }
[20:14:18] <thomaslee> doomlord: Result ?
[20:14:27] <bstrie> Result sounds like what you want
[20:14:36] <bstrie> Either is a bit redundant imo
[20:14:47] <engla> result and either have exactly the same shape
[20:14:48] <doomlord_> thats it yes
[20:15:13] <doomlord_> i suppose 'Result' is the more common one, but perhaps Either has its uses..
[20:15:46] <orshem> smvv, because i need to be able to call new, reparent and equal from safe code..
[20:16:03] <orshem> and i think if i mark it all as unsafe it won't let me
[20:16:07] *** Quits: steveklabnik (steveklabn@moz-5364052E.z73-46-65.customer.algx.net) (Quit: bye!)
[20:16:11] <orshem> but i'm very new to unsafe
[20:16:26] <engla> you need unsafe to dereference a *mut T
[20:16:48] <bstrie> using unsafe is a game of code golf
[20:16:54] <smvv> orshem: i see, i was just wondering if it was possible to do it without unsafe operations :)
[20:17:00] <bstrie> the goal is to refactor your code such that the total characters in unsafe blocks is as few as possible
[20:17:32] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:17:41] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:18:14] <orshem> smvv, me too. i couldn't find a way to do it with unique + borrowed without moving all over the place. using gc doesn't help because you can't create mut cycle
[20:18:22] <orshem> or at least i can't figure out how
[20:18:29] <bblum> steven_is_false: you could just ping me and ask directly :P
[20:19:12] <smvv> orshem: i was working on a b-tree implementation in rust and omitted the `parent' attribute because that would introduce cycles
[20:19:30] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:19:35] <steven_is_false> bblum: Oh high.
[20:19:37] *** Joins: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net)
[20:19:40] <Sergio965> Is there a way to do what extern mod does without using extern mod?
[20:19:49] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:19:54] <steven_is_false> bblum: Yeah I should have. Don't know what I thought.
[20:19:58] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[20:19:58] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e1656ec to 14d8b299d: 02http://git.io/N3iJvQ
[20:19:58] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[20:20:01] <steven_is_false> *I meant hi not high
[20:20:01] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[20:20:01] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/K1P7TQ
[20:20:01] <ghrust> 13rust/06auto 143c6895d 15Brian Anderson: std::rt: 2MB stacks again
[20:20:01] <ghrust> 13rust/06auto 145cc8fa0 15Brian Anderson: std::rt: Pull RUST_MIN_STACK from the environment
[20:20:02] <ghrust> 13rust/06auto 14b89d83d 15Brian Anderson: std: Allow spawners to specify stack size
[20:20:04] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[20:20:26] *** Joins: kud1ing (Mibbit@moz-EEC1DBE2.pools.arcor-ip.net)
[20:20:33] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[20:20:38] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[20:20:48] <Sergio965> IE, I have some modules that `use` everything as if if they're in some crate a. I have another crate, b, for which I'd like to extern mod crate a without actually extern modding. That is, I want to do mod a. But doing this means that the modules in a have to `use a::`.
[20:20:53] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[20:20:57] <bstrie> steven_is_false: aha, freudian slip. the dea is already halfway to your house.
[20:21:02] <orshem> smvv, but sometime you must have cycles :)
[20:21:12] <orshem> i want my cycles
[20:21:17] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[20:21:18] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[20:21:27] <steven_is_false> :)
[20:21:33] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:21:37] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[20:21:42] *** Quits: jensn (jensn@moz-32C5EE18.mobileonline.telia.com) (Quit: jensn)
[20:21:59] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Max SendQ exceeded)
[20:22:52] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[20:23:18] <bblum> steven_is_false: left a comment for you
[20:23:22] <steven_is_false> bblum: Thanks.
[20:23:46] <bblum> no prob
[20:24:54] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[20:25:06] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[20:25:48] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[20:26:56] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[20:27:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:27:54] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[20:27:54] *** ChanServ sets mode: +o dherman
[20:28:15] *** Quits: kud1ing (Mibbit@moz-EEC1DBE2.pools.arcor-ip.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:30:36] *** Quits: Ms2ger (Ms2ger@EDC982F3.6890FC55.187A1082.IP) (Quit: nn)
[20:31:02] *** Joins: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr)
[20:31:32] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:33:01] *** Joins: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com)
[20:34:27] <bblum> make: *** No rule to make target `/home/bblum/scratch2/rust/src/llvm//lib/Linker/Linker.cpp', needed by `/home/bblum/scratch2/rust/llvm/x86_64-unknown-linux-gnu/Release+Asserts/bin/llvm-config'.  Stop.
[20:34:31] <bblum> sigh
[20:34:49] <bblum> just doing make again seems to pretend the error doesn't exist and continues with the compile
[20:34:53] <bblum> but still, sigh
[20:35:09] *** Quits: maikklein2 (maik@moz-18E00DC1.dip0.t-ipconnect.de) (Ping timeout)
[20:36:24] *** Quits: gits1225 (gits@24C77723.43CEF437.C6104E0F.IP) (Quit: )
[20:37:40] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[20:37:40] *** ChanServ sets mode: +o pcwalton
[20:39:00] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[20:42:50] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:43:13] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[20:45:05] *** Quits: Sergio965 (sergiobz@CFE01F07.996A1888.3A99D594.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz)
[20:45:13] <kimundi> brson / erickt: Fixed my PR failing (a function only compiled under windows target was the cause) - r+ again? - https://github.com/mozilla/rust/pull/8288
[20:45:49] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:46:16] <joelteon> is it possible to define a recursive lambda?
[20:46:18] *** Quits: jviereck1 (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[20:48:05] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:49:27] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[20:49:57] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[20:49:57] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141f657c8 to 14d8b299d: 02http://git.io/N3iJvQ
[20:49:57] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[20:49:57] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:49:58] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rAVGOw
[20:49:58] <ghrust> 13rust/06auto 14180d050 15darkf: Open files in binary mode. Closes #3948
[20:49:58] <ghrust> 13rust/06auto 1429099e4 15bors: auto merge of #8298 : darkf/rust/fix-3948, r=pcwalton
[20:49:58] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:51:34] <jeaye> bjz: ping
[20:52:09] <jeaye> bjz: Is there a Github issue for the glfw-rs bustedness? I keep wanting to check the progress on iti so I can update Rust.
[20:54:48] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Connection reset by peer)
[20:55:35] <bblum> oh dear.
[20:55:44] <bblum> rtdebug!("boostraping a 1:1 scheduler");
[20:56:20] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[20:56:38] <kmc> what's busted about glfw-rs?
[20:56:53] *** Joins: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu)
[20:57:33] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:57:33] *** ChanServ sets mode: +o tjc
[20:58:46] <toddaaro> bblum: ?
[21:02:01] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[21:03:24] *** Joins: diegoyam_ (quassel@FF9B1514.A4EC3D18.3A1EC144.IP)
[21:04:45] *** Joins: jeff (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net)
[21:04:57] <jeff> I just saw the report Tiobe, and Rust is not even among the top 50 most used languages! Is that true?
[21:05:01] <jeff> http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html
[21:05:27] <doy> rust hasn't even had a stable release yet
[21:05:32] *** Quits: Palmik (palmik@moz-CC484FDD.tmcz.cz) (Quit: Lost terminal)
[21:05:48] <kmc> haha tiobe
[21:06:06] <doy> also, yeah, stop paying attention to tiobe
[21:06:06] <kmc> I'm betting it all on MATLAB, look at those up arrows!
[21:06:09] <Sergio965> Is there a clean way to implement the singleton pattern in Rust without using the heap?
[21:06:33] <tjc> also, assembly is on the rise too
[21:06:39] <tjc> showing that assembly is truly the language of the future :-)
[21:06:49] <jeff> xD
[21:07:03] <joelteon> where is range() defined
[21:07:15] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:07:17] <jeff> Yeah, you are right, but everybody knows that rust is not used too much
[21:07:38] <doomlord_> well, it is alpha..
[21:07:56] <tjc> jeff: also, three-year-olds are usually pretty bad at calculus :-)
[21:07:58] *** Joins: DoomBoom (DoomBoom@6B14631A.ACEC7723.5D1D3FEF.IP)
[21:08:16] <joelteon> the docs say it's in iterator, but iterator::range is not defined
[21:08:18] <joelteon> nor is just range()
[21:08:23] <tjc> Sergio965: I'm not that familiar with design patterns, but it seems like what you would do with the singleton pattern could be done more naturally with unique pointers instead?
[21:08:35] <Sergio965> Unique pointers?
[21:08:35] <sfackler> joelteon: it's in std::prelude iirc
[21:08:41] <jeff> The 1.0 could be considered stable?
[21:08:41] <tjc> owned pointers
[21:08:49] *** Quits: cypher (ircnet@moz-1D494DB3.vie.surfer.at) (Quit: Leaving...)
[21:08:50] <tjc> all this goshdarn changing terminology
[21:08:52] <joelteon> sfackler: that's what I thought too, but evidently it is not
[21:08:58] <Sergio965> That involves using the heap, no?
[21:09:10] <doomlord_> singletons are globals usually, mutable globals are usually avoided
[21:09:21] <bblum> ??? why did make stop after building the stage0 runtime
[21:09:22] <toddaaro> joelteon: what rust version are you using? this was just shuffled up quite a bit
[21:09:24] <bblum> that is not what make means
[21:09:29] <doomlord_> (singletons are globals i mean)
[21:09:30] <bblum> go home build system, you are drunk
[21:09:37] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:09:45] <tjc> Sergio965: Oh, I see, somehow my brain turned "heap" into "shared heap" even though that's not what you said...
[21:09:46] <toddaaro> bblum: did you give it a -j? I've found that happens all the time due to race conditions
[21:09:56] <strcat> joelteon: it's in the prelude
[21:10:01] <Sergio965> doomlord_: Yeah, but how do I implement something like a global logging system?
[21:10:06] <joelteon> ok
[21:10:07] <strcat> if it's not, you're not on an up-to-date master
[21:10:10] <joelteon> toddaaro: git HEAD
[21:10:13] <Sergio965> Without using the heap.
[21:10:13] <joelteon> ok
[21:10:16] <joelteon> I'll go update
[21:10:23] *** Quits: jeff (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:10:38] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:10:45] <Sergio965> tjc: But even if I use owned pointers, can I have multiple mutable references to the same object?
[21:10:56] <strcat> tjc: singleton pattern == global variable ;p
[21:11:05] <tjc> Sergio965: no, in Rust you can't have multiple mutable references to the same object, at least not without unsafe code
[21:11:10] <tjc> strcat: Then why don't they just say that? :P
[21:11:13] <toddaaro> joelteon: once there it should be std::iterator::range if you aren't getting it from the prelude
[21:11:33] <Sergio965> So how would I go about implementing a logging system?
[21:11:39] <strcat> tjc: it's a way of disguising global state as an over-engineered OOP thing
[21:11:51] <Sergio965> strcat: It's a bit more than that.
[21:11:54] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[21:12:34] <kmc> in C++ it's often used because the order of creation of global objects is unspecified
[21:12:34] <tikue> singleton pattern instantiates if it doesn't already exist, otherwise returns the reference
[21:12:41] <Sergio965> In any case, I'm looking for a way to implement a log function that any part of my code can call.
[21:12:45] <Sergio965> logging*
[21:12:49] <tikue> Sergio965: make a task
[21:12:53] <tikue> Sergio965: a log task
[21:12:56] <kmc> singletons are created on first use, so the order falls out of your call graph in a way that's usually what you want
[21:12:56] <tikue> Sergio965: send it log messages
[21:13:01] *** Quits: gareth0 (gareth0@moz-A2DA68D9.dynamic.dsl.as9105.com) (Input/output error)
[21:13:04] <tikue> Sergio965: using shared chans
[21:13:11] <Sergio965> Unfortunately, I don't have access to any of the task system.
[21:13:19] <tikue> :(
[21:14:13] <Sergio965> Is there no way to do it without using tasks?
[21:14:52] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:15:14] <tikue> there's always unsafe {}
[21:18:16] <Sergio965> How would I do it with unsafe?
[21:18:30] <doomlord_> inside an unsafe block you can do anything c can
[21:18:44] <sfackler> Sergio965: a mutabe static Option<T> should do it
[21:18:47] <sfackler> *mutable
[21:18:49] <doomlord_> write all the mutating code you like
[21:22:46] <kmc> the joy of rust...  "why the f#%&$ is this code broken now... oh, somebody changed the relative precedence of * and 'as'"
[21:23:06] <doomlord_> lol :)
[21:24:22] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:25:49] <engla> hehe
[21:26:11] <tjc> sully: how do you call a static method on Self inside a default method? (can you?)
[21:26:31] <sully> tjc: same as any static method call
[21:26:38] <sully> Traitname::methodname(args)
[21:26:41] <sully> should work.
[21:27:00] <bblum> where is brson?
[21:28:32] <Sergio965> What does, "error: non-scalar cast" mean?
[21:28:43] <jeaye> Sounds like you're using 'as' when you shouldn't.
[21:28:54] <tjc> Sergio965: it means you tried to cast something to a type that things aren't allowed to be cast to :-)
[21:29:25] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[21:29:50] <Sergio965> I'm trying to cast a raw pointer to a borrowed pointer.
[21:30:12] <bblum> indeed, that is not safe in several ways
[21:30:23] <bblum> transmute will do the job
[21:30:34] <jeaye> std::cast::transmute, that is.
[21:30:37] <strcat> transmute will happily do any job, it's not picky ;p
[21:30:49] <Sergio965> But I'm trying to do it statically.
[21:31:00] <jeaye> reinterpret_cast it? :P
[21:31:34] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:31:43] <jeaye> When's the new doc system gonna land? It looked pretty nice.
[21:31:56] <strcat> seems the frontend still needs to handle methods
[21:31:56] <engla> Sergio965: RawPtr has a method .to_option()
[21:32:11] <Sergio965> engla: I'm trying to do it within a static delcaration.
[21:32:52] <strcat> you can't afaik
[21:33:00] <strcat> unless unsafe {} works in statics
[21:33:02] <jeaye> Sounds like you're writing an OS. :P
[21:33:14] *** Quits: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com) (Ping timeout)
[21:33:21] <Sergio965> I am indeed.
[21:33:43] <jeaye> Yup, that'd do it.
[21:33:48] <strcat> rusti: static x: &'static int = 5; static y: *int = x;
[21:33:49] -rusti- pastebinned 8 lines of output: http://sprunge.us/bcZh
[21:33:51] <bblum> Sergio965: oh, we don't have CTFE for transmute, so...
[21:34:02] <strcat> rusti: static x: &'static int = &5; static y: *int = x;
[21:34:02] -rusti- <anon>:5:55: 5:56 error: mismatched types: expected `*int` but found `&'static int` (expected *-ptr but found &-ptr)
[21:34:02] -rusti- <anon>:5          static x: &'static int = &5; static y: *int = x;
[21:34:02] -rusti-                                                                 ^
[21:34:02] -rusti- error: aborting due to previous error
[21:34:02] -rusti- application terminated with error code 101
[21:34:04] <bblum> Sergio965: maybe just write a macro that uses the global and transmutes it for you
[21:34:40] <Sergio965> bblum: Yeah, I considered doing something like that, but then every call would be needlessly expensive.
[21:34:43] <strcat> rusti: static x: *int = 0; static y: &int = unsafe { &*x };
[21:34:44] -rusti- <anon>:5:39: 5:43 error: Illegal anonymous lifetime: only 'static is allowed here
[21:34:44] -rusti- <anon>:5          static x: *int = 0; static y: &int = unsafe { &*x };
[21:34:44] -rusti-                                                 ^~~~
[21:34:44] -rusti- error: aborting due to previous error
[21:34:44] -rusti- application terminated with error code 101
[21:34:50] <strcat> rusti: static x: *int = 0; static y: &'static int = unsafe { &*x };
[21:34:50] -rusti- <anon>:5:26: 5:27 error: mismatched types: expected `*int` but found `<VI0>` (expected *-ptr but found integral variable)
[21:34:50] -rusti- <anon>:5          static x: *int = 0; static y: &'static int = unsafe { &*x };
[21:34:50] -rusti-                                    ^
[21:34:52] -rusti- error: aborting due to previous error
[21:34:54] -rusti- application terminated with error code 101
[21:34:57] <bblum> Sergio965: if all you're using is transmute, that would not be expensive at all
[21:35:01] <strcat> rusti: static x: *int = 0 as *int; static y: &'static int = unsafe { &*x };
[21:35:01] -rusti- <anon>:5:62: 5:76 error: constant contains unimplemented expression type
[21:35:01] -rusti- <anon>:5          static x: *int = 0 as *int; static y: &'static int = unsafe { &*x };
[21:35:02] -rusti-                                                                        ^~~~~~~~~~~~~~
[21:35:03] -rusti- error: aborting due to previous error
[21:35:05] -rusti- application terminated with error code 101
[21:35:06] <strcat> yeah you can't do it
[21:35:07] <bblum> Sergio965: transmute is an intrinsic that compiles to zero instructions
[21:35:20] <pcwalton> (after inlining)
[21:35:24] <bblum> uh yeah
[21:35:47] <pauls> 0-instruction functions are great candidates for inlining, I suppose.
[21:35:54] <jeaye> ^_^
[21:35:55] <pauls> No need to worry about bloat.
[21:36:20] <Sergio965> Interesting.
[21:36:21] <Sergio965> Hmm.
[21:36:30] *** Quits: victorporof (victorporo@B4B1C8EE.73B1E539.9B1E38F4.IP) (Quit: victorporof)
[21:36:44] <kmc> is there a nice way to convert an old-style 'for' loop internal iterator to an external iterator?
[21:37:02] <kmc> by convert I either mean a function I can apply or just a pattern for transforming the code which is nicer than I would come up with by default
[21:37:43] <doomlord> i guess you need an ast->ast transformation tool :)
[21:39:17] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[21:39:26] <strcat> sed -i 's/for \(.*\).advance() |\(.*?\)|/for \2 in \1/
[21:39:29] <strcat> kmc: 
[21:39:33] <strcat> well assuming it uses advance
[21:39:41] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[21:39:46] <strcat> sed -i 's/for \(.*\).advance |\(.*?\)|/for \2 in \1/
[21:39:49] <strcat> guess it won't have ()
[21:40:08] <strcat> kmc: or do you mean the iterator itself?
[21:40:10] <kmc> strcat: it doesn't, home-grown "for each" function
[21:40:21] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[21:40:34] <strcat> you'd have to rewrite it
[21:40:48] <kmc> ok
[21:40:49] <Sergio965> How does the fmt! macro statically check that the types are correct? Can that functionality be implemented with regular macros?
[21:40:56] <strcat> external ones are strictly more powerful than an internal one
[21:41:11] <strcat> you can transform external -> internal but not the other way without compiler magic like a yield + state machine generator
[21:41:42] <joelteon> this is happening on OSX 10.8! https://gist.github.com/anonymous/81140953f893332d58dd
[21:41:55] <joelteon> sorry about the weird syntax highlighting, forgot to tell jist it's not ruby
[21:42:20] <pauls> Sergio965: no; `macro_rules!` cannot examine literals in any way.
[21:42:46] <Sergio965> So fmt! is quite special in that regard?
[21:43:07] <pauls> (furthermore, `macro_rules!` doesn't have any access to the type machinery, unless you're willing to implement the whole Rust typechecker in it...
[21:43:11] <engla> fmt! doesn't check types either, it just constructs an expression that has type requirements
[21:43:46] <pauls> Sergio965: yes, it's officially a "syntax extension" (I try to only use "macro" for things that can be user-defined).
[21:44:07] <pauls> engla: oh, good point.
[21:44:08] *** Quits: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com) (Ping timeout)
[21:44:34] <Sergio965> engla: Could fmt! be implemented just using macro_rules!?
[21:44:39] <pauls> So, you could use type ascription in a macro to do the checking.
[21:44:55] <pauls> Sergio965: no, the literal-opaqueness remains.
[21:45:00] <engla> Sergio965: I don't think so, it uses the format string to build an expression
[21:45:16] <Sergio965> That's unfortunate.
[21:46:04] <Sergio965> That sheds some light though, thanks!
[21:46:04] <pauls> Sergio965: arbitrary procedural macros are tricky beats. It's pretty well-understood how to do them right, but there's an awful lot of machinery.
[21:46:28] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[21:46:28] *** ChanServ sets mode: +o dherman
[21:46:31] <Sergio965> That would be an awesome feature.
[21:46:38] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[21:46:50] <Sergio965> Some languages have such "macros" that allow you to extend the language grammar and parse the AST.
[21:46:57] *** Joins: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com)
[21:47:04] <Sergio965> A restricted version of that sounds awesome.
[21:47:09] <pauls> Sergio965: I know! I usually work in Racket.
[21:47:18] <Sergio965> Ah, indeed.
[21:47:33] <aatch> lisps don't have syntax
[21:48:07] <Sergio965> Sure they do.
[21:48:14] <Sergio965> Except it's extremely minimal.
[21:48:16] <pauls> Sergio965: although, strictly speaking, *that* is what Rust already has (assuming that by "parse the AST", you meant "parse the lexed code")
[21:48:44] <Sergio965> pauls: I meant parse the AST generated from the newly introduced grammar.
[21:48:57] <Sergio965> In Rust, I can only refer to already defined grammar.
[21:49:11] <pauls> ASTs are the result of parsing. I am confused.
[21:49:28] <Sergio965> ...
[21:49:33] <Sergio965> I want to parse using newly defined grammar.
[21:49:47] <pauls> Sergio965: you can use arbitrary syntax inside the invocation, and use a grammar to define it (with certain limitations). 
[21:50:02] <Sergio965> But it's still textual substitution.
[21:50:08] *** Quits: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr) (Quit: Gone)
[21:50:36] <pauls> Sergio965: Yes, but that's not a limitation of the parser, that's just a limitation of what operations are available.
[21:50:45] <pauls> (and it's not really textual, once hygiene is done)
[21:50:47] <Sergio965> I couldn't, for example, write a macro that takes in some mathematical expression "5 + 2" and substitutes "10".
[21:51:02] *** Quits: heftig (heftig@moz-6E9FB584.dip0.t-ipconnect.de) (Ping timeout)
[21:51:16] <Sergio965> (Assuming no constant folding).
[21:51:18] <pauls> (and it's still quite powerful; you can do a lot with recursive macros)
[21:51:26] *** Joins: cypher (ircnet@moz-1D494DB3.vie.surfer.at)
[21:51:29] <pauls> Sergio965: yeah, but that's what constant folding is for!
[21:51:33] *** Joins: lmandel (lmandel@279FD858.EFF8FC7B.ADB88A9.IP)
[21:51:38] <Sergio965> ...
[21:51:42] <Sergio965> That was just an example.
[21:52:11] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[21:52:20] <Sergio965> Ideally, I'd like to write a macro like fmt! that actually substitutes a generated string at compile time when the parameters are all constants.
[21:52:29] <pauls> My point is that macros often don't have to do computation; they can expand to constant expressions and count on the optimizer.
[21:52:50] <Sergio965> So: fmt!("Hello, %s, you are %d.", "world", 10) would become "Hello world, you are 10.".
[21:52:54] <pauls> I'm not trying to deny that procedural macros are useful...
[21:53:46] <pauls> ...I'm just claiming pattern-matching is a good chunk of what macros are useful for.
[21:54:39] <Sergio965> Or expand to something like: "Hello , ".print(); string.print(); ", you are ".print(); num.print(); ".".print();
[21:54:55] <Sergio965> Really, the latter.
[21:56:19] <Sergio965> That latter would be awesome.
[21:56:56] <pcwalton> Sergio965: we need procedural macros
[21:57:45] <Sergio965> That'd be awesome.
[21:59:08] *** Joins: heftig (heftig@moz-51BCBA1E.dip0.t-ipconnect.de)
[21:59:47] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[22:00:10] <pcwalton> is there a nice iteratory way to map function f over all but the last element of a vector, map function g to the last element of the vector, and concatenate the results into a new vector?
[22:00:11] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[22:00:11] *** ChanServ sets mode: +o brson
[22:00:44] *** Quits: DoomBoom (DoomBoom@6B14631A.ACEC7723.5D1D3FEF.IP) (Client exited)
[22:00:52] <bblum> brson: ok, i have good news and i have bad news
[22:01:18] <bblum> the good news is that lazily initializing taskgroups for spawn_unlinked tasks improves spawn performance by 21% (when they don't spawn children of their own)
[22:01:40] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Ping timeout)
[22:01:42] <bblum> the bad news is that since last week our spawn performance seems to have gone from 15us/spawn to 27us/spawn
[22:02:01] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[22:02:03] <Sergio965> Rust is so hard to love.
[22:02:12] <Sergio965> I always feel like I'm fighting it. :(
[22:02:13] <pcwalton> we do have them
[22:02:17] <pcwalton> procedural macros
[22:02:24] <olsonjeffery> rust is a known tsundere
[22:02:26] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[22:02:28] *** bent|lunch is now known as bent
[22:02:28] <pcwalton> but they have to be built into the compiler at the moment.
[22:02:39] <pcwalton> I have a plan for how to fix that
[22:03:02] <Sergio965> Really, I want to like Rust.
[22:03:13] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[22:03:18] <brson> bblum: maybe your machine is running at 800Mhz again?
[22:03:19] <Sergio965> Been spending every day for the last two weeks learning it.
[22:03:31] <Sergio965> And yet...
[22:03:35] <strcat> pcwalton: there's not a great way to do it because adaptors take self by-value instead of &mut self
[22:03:40] <bblum> brson: I checked
[22:03:43] <pcwalton> strcat: ok
[22:03:48] <brson> :-(
[22:03:57] <pcwalton> I'll just pop then
[22:04:41] <brson> oh, it's a canadian holiday
[22:04:48] <brson> bummer
[22:04:51] <pcwalton> Sergio965: the language isn't done.
[22:05:00] <pcwalton> please file bugs when you find them
[22:05:10] <strcat> brson: the most boring one ;]
[22:05:18] <strcat> well "family day" is pretty boring too
[22:05:21] <kmc> two weeks isn't enough time to learn an interesting language, even if it's not changing :)
[22:05:29] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[22:05:31] <bblum> brson: spawn performance looks peachy at master~34, which is right after my last PR
[22:05:32] <Sergio965> pcwalton: I'm not sure when it's a bug or when it's not...
[22:05:35] <bblum> i guess i'm gonna try bisecting
[22:05:38] <brson> strcat: which one is it?
[22:05:53] <strcat> brson: in ontario it's *actually* called "civic holiday"
[22:05:53] <pcwalton> that's part of the fun ;)
[22:06:02] <brson> bblum: ok, thanks
[22:06:02] <strcat> brson: apparently it varies per province though
[22:06:06] *** Quits: cypher (ircnet@moz-1D494DB3.vie.surfer.at) (Quit: Leaving...)
[22:06:12] <brson> strcat: yeah, that sounds lame
[22:06:33] <brson> how do you celebrate Civic Holiday?
[22:06:33] <Sergio965> Like, the other day, I made the compiler die. It was generating incorrect LLVM bytecode and LLVM was throwing an assertion error. Turned it it was because of an incorrect function definition.
[22:06:39] <pcwalton> but yeah, I understand your frustration
[22:06:42] <pcwalton> please pardon our dust
[22:06:47] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[22:06:47] <brson> I <3 Rust
[22:07:11] <Sergio965> I like Rust, but I don't know if it's practical.
[22:07:17] <Sergio965> For system development.
[22:07:23] <pcwalton> for what reasons?
[22:07:24] <Sergio965> Low-level stuff.
[22:07:26] <kmc> that's what we're trying to discover
[22:07:56] <bblum> bisecting based on performance: :(
[22:08:05] <kmc> fortunately we only need to be more practical than C++ :)
[22:08:09] <Sergio965> Because it's extremely difficult for me to do common things. For example, right now, I want a way to create a global logging system that any part of my code can call. I can't figure out how to do it without doing what I consider are strange hacks.
[22:08:13] <Sergio965> Without using tasks, that is.
[22:08:14] <brson> bblum: it might be all the extra idle callback i had to throw in over the weekend
[22:08:23] <brson> scheduler is currently very wasteful with them
[22:08:25] <bblum> brson: which commit is that?
[22:08:31] <kmc> Sergio965: why can't you use tasks?
[22:08:42] <Sergio965> kmc: Because I'm running on bare metal.
[22:08:42] <strcat> bblum: what kind of performance issue?
[22:08:53] <pcwalton> it sounds like you're trying to do global shared mutable state
[22:08:56] <brson> bblum: a27f339cb4480e723aa7e06070683966d026d1ae & 167bdff04164c92c203c319b730bdc2344dbe089
[22:09:00] <bblum> strcat: spawn performance has gone down
[22:09:10] <kmc> if Rust is still experimental then I would say that Rust on bare metal / Rust with no RT is like 10 times as experimental
[22:09:10] <Sergio965> pcwalton: Indeed. I understand it's inherently unsafe, but Java does it.
[22:09:14] <Sergio965> (Safely)
[22:09:24] <strcat> it doesn't do it safely, java has data races afaik
[22:09:25] <pcwalton> via concurrent global garbage collection
[22:09:27] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:09:28] <kmc> so, kudos to you for being a test pilot :)
[22:09:30] *** Quits: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com) (Ping timeout)
[22:09:32] <strcat> and you can have inconsistent views of objects
[22:09:34] <kmc> but yeah a lot of things don't work yet in that environment
[22:09:44] <pcwalton> rust doesn't have concurrent global garbage collection
[22:09:46] <strcat> inconsistent views of objects -> breaking invariants needed for wrapping unsafe concepts to safe ones
[22:09:54] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:09:56] <strcat> unless they put locks in any case involving that
[22:10:04] <pcwalton> so to be fair
[22:10:06] <sully> sigh. trying to merge an old branch of niko's
[22:10:08] <brson> what the scheduler should be doing is only ever having one idle callback, and every time it goes through the scheduler loop and does *something*, schedule's one additional idle callback. only when there is definitely nothing to do should it not schedule an idle callback and sleep
[22:10:09] <sully> and it uses a function
[22:10:13] <pcwalton> I do think that we could do more to allow shared global mutable state
[22:10:15] <pcwalton> safely
[22:10:16] <sully> "non_gc_box_cast", which is gone
[22:10:20] <sully> does anybody know what it became?
[22:10:25] <brson> right now it's just throwing new idle callbacks into the queue if there's any possibility it will need it
[22:10:34] <pcwalton> by making it easy to have static RWARCed data, for example
[22:10:47] <ecr> shared mutable state hurts my soul
[22:10:48] <pcwalton> that would allow you to do what you're trying to do easily
[22:11:20] <Diamond> Doesn't rust use green threads?
[22:11:29] <ecr> Diamond: yes
[22:11:30] <aatch> Diamond, essentially, yes
[22:11:42] <aatch> multiplexed onto OS threads
[22:11:48] <pcwalton> Sergio965: if you'd like to file a bug on making static RWARC'd data easy to use that would be great
[22:11:52] <pcwalton> I *am* interested in fixing this stuff
[22:11:53] <Diamond> My question is; how would a green thread not be possible on 'bare metal'?
[22:12:09] <aatch> Diamond, needs the scheduler running.
[22:12:10] <kmc> Diamond: it's possible, you just need your own scheduler
[22:12:14] <sam113101> is there anything on the std lib to make a md5 hash of some string?
[22:12:24] <aatch> sam113101, I think there is in extra
[22:12:31] <Sergio965> pcwalton: I've come to terms with being able to do it safely and have succumb to doing it unsafely. I have no idea how to do that "correctly". Every options seems to involve weird hacks using transmute() in a macro and then generating a new safe struct.
[22:12:32] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[22:12:33] <kmc> they're green threads that map onto a few OS threads
[22:12:36] <strcat> aatch: I don't think it's merged yet
[22:12:38] <ldunn> You get very little of Rust on bare metal for free, I'm finding
[22:12:47] <kmc> when they do IO the Rust scheduler suspends the green thread and schedules another
[22:12:48] <Sergio965> ldunn: Indeed.
[22:12:50] <pcwalton> Sergio965: there is a way to do it safely
[22:12:52] <Sergio965> I should publish my stuff.
[22:12:54] <pcwalton> we just haven't implemented it
[22:13:00] <kmc> it needs OS support in order to know which green threads are runnable
[22:13:00] <Sergio965> pcwalton: Yeah, I mean currently.
[22:13:04] <pcwalton> that's fine
[22:13:13] <Sergio965> But I'm working with it now :P
[22:13:17] <strcat> ldunn: because no one has put effort into making the stdlib available
[22:13:19] <ecr> sam113101, aatch: there's md4 in extra but not md5 yet
[22:13:24] <pcwalton> I would just not like to leap to conclusions like that Rust is not practical
[22:13:27] <pcwalton> for low level stuff
[22:13:28] <Sergio965> strcat: I have.
[22:13:29] <pcwalton> that may be true
[22:13:34] <Sergio965> strcat: And I do have it running on bare metal.
[22:13:35] <pcwalton> but I want to see if we can fix it
[22:13:43] <pcwalton> it was only recently that bare metal Rust worked at all :)
[22:13:47] <Sergio965> pcwalton: I mean currently.
[22:13:57] <pcwalton> ok, that much I buy
[22:13:57] <Sergio965> Like, as of now.
[22:14:01] <pcwalton> heck, rust isn't practical for *anything* now
[22:14:07] <pcwalton> too many compile bugs
[22:14:09] <pcwalton> compiler
[22:14:19] <Sergio965> Really, I feel like applying to Mozilla to work on Rust and releasing a production ready version.
[22:14:20] <sam113101> alright
[22:14:21] <Sergio965> I've felt*
[22:14:44] <pcwalton> and I don't mean to be combative; I'm really happy you're playing around with what we have so far :)
[22:14:49] <kmc> there is in fact a Rust position open now: https://careers.mozilla.org/en-US/position/oKiEXfwn
[22:14:50] <pcwalton> and any feedback is very welcome
[22:14:52] <tikue> Sergio965: Rust is probably at least a year away from a 1.0 release, so there's plenty of time to get this kind of thing working well
[22:15:08] <Sergio965> kmc: I may just apply.
[22:15:15] <pcwalton> well, I do want it to be end of this year but it's optimistic
[22:15:16] <kmc> I doubt that bare metal is considered a requirement for 1.0 either, but it wouldn't hurt to have it working better
[22:15:18] <aatch> To be honest, the fact that there is an entire compiler written in rust shows that it is practical most of the time.
[22:15:30] <pcwalton> however I work as though that were the goal :)
[22:15:31] <kmc> a compiler *and* a browser rendering engine that can sort of render Wikipedia!
[22:15:36] <kmc> and an NES emulator
[22:15:42] <Sergio965> (And soon, an OS).
[22:15:45] <kmc> :)
[22:16:02] <pcwalton> I should go back and add turbo mode to sprocketnes
[22:16:11] <pcwalton> I started on the feature this weekend
[22:16:22] <aatch> I managed to write a benchmarking tool that uses linux syscall instructions for talking to the kernel.
[22:16:44] <aatch> so it's perfectly possible to very low-level code in rust.
[22:16:48] <pcwalton> but yeah, figuring out how to make RWARCs work on bare metal for globals would be awesome, I think we can do it with macros and maybe a little compiler support
[22:17:14] <pcwalton> that would solve a lot of usability concerns for small programs actually
[22:17:26] <pcwalton> globals are useful for small programs, the problem is they're racy
[22:17:35] <Sergio965> Keep them to a single task.
[22:17:38] <pcwalton> but thanks to bblum we have a facility for safe globals: the RWARC
[22:17:41] <Sergio965> Problem solved.
[22:17:46] <strcat> we already have TLS
[22:17:46] <bblum> :D
[22:17:57] <Sergio965> strcat: Global?
[22:17:58] <bblum> it's hard to have a static RWARC though
[22:18:00] <pcwalton> it's a global that makes sure you take the lock on it
[22:18:05] <strcat> Sergio965: within the task
[22:18:07] <pcwalton> bblum: right, that's what we would need to fix, probably needs compiler support
[22:18:09] <bblum> well, it's a shareable-between-threads thingie
[22:18:15] <pcwalton> well, we have static mut
[22:18:16] <bblum> pcwalton: it needs to allocate to initialize unfortunately :(
[22:18:17] <pcwalton> I was thinking a macro
[22:18:28] <pcwalton> hmm, is that a necessity in the implementation?
[22:18:33] <Sergio965> Macros built into the language is a bad idea, I think.
[22:18:35] <pcwalton> maybe this isn't an RWARC that I'm thinking of
[22:18:44] <pcwalton> it's more like... a safe global
[22:18:48] <aatch> pcwalton, there's also atomics.
[22:18:53] <bblum> pcwalton: it could be hacked around with a lot of gross abstraction breaking :P
[22:19:03] <pcwalton> just a "static mut" that enforces that you take a lock on it
[22:19:12] <ecr> Sergio965: how would you do macros that aren't built into the language?
[22:19:13] <pcwalton> actually that should be quite doable
[22:19:32] <Sergio965> ecr: Lol. I mean predefined macros.
[22:19:36] <aatch> And I recently added support for static initialization of atomic values.
[22:19:42] <doomlord> i always thought globals were the enemy of modularity
[22:19:42] <bblum> pcwalton: i was thinking of a macro that would lazily initialize it the first time it's used, using a compare-and-swap, like this https://github.com/mozilla/rust/issues/8140
[22:19:53] <pcwalton> bblum: ah yeah. that works too.
[22:20:26] <aatch> doomlord, they are, but they're useful for small programs or initialize-once code.
[22:20:53] <doomlord> its like if you use globals.. your programs will stay small :)
[22:21:14] <strcat> Sergio965: you mean like fail!?
[22:21:37] <tikue> Sergio965: strcat means `fail!` 
[22:21:39] <tikue> :P
[22:21:42] <Sergio965> Yeah.
[22:21:49] <strcat> why is it a bad idea?
[22:21:54] <Sergio965> Why is it a good idea?
[22:21:58] <tikue> ...
[22:22:02] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[22:22:05] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[22:22:06] <strcat> because assert_eq! and fail! are useful
[22:22:12] <ecr> and very common
[22:22:18] <ecr> so everyone would define them anyway
[22:22:23] <Sergio965> Well, fail! is OS dependent.
[22:22:28] <aatch> doomlord, but sometimes that's fine. Or you don't want the overhead of passing around context objects that grow endlessly.
[22:22:35] <strcat> Sergio965: so is spawn(), and it's in prelude
[22:22:51] <ecr> part of the point is to write platform independent code
[22:22:52] <Sergio965> strcat: Exactly; that sounds like the wrong direction to me.
[22:22:53] <aatch> Sergio965, depends on what you mean by "OS dependent" it unwinds the task.
[22:23:05] <Sergio965> aatch: Unwinding is OS dependent.
[22:23:10] <Sergio965> You need an unwinding library.
[22:23:33] <strcat> C++ has unwinding and threads as part of the language :s
[22:23:35] <aatch> Sergio965, so?
[22:23:42] <strcat> C does too, if setjmp/longjmp count
[22:23:49] <kmc> a part of the language that half the users tell you not to use :/
[22:23:52] <Sergio965> strcat: C++ exceptions are about the only thing you need runtime support for.
[22:23:58] <strcat> Sergio965: threads
[22:24:15] <Sergio965> You're not going to be using the built-in threads stuff if you're writing bare metal code.
[22:24:17] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[22:25:02] <Sergio965> I think one of the greatest accomplishments of C is the ability to use it without a standard library.
[22:25:11] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[22:25:12] <Sergio965> You can use the entirety of the language with no runtime support.
[22:25:32] <tikue> Sergio965: rust really doesn't view itself as separate from the standard library, though
[22:25:41] <tikue> Sergio965: they're fairly intertwined
[22:25:47] <aatch> Sergio965, but that's because there's little that needs runtime support.
[22:25:56] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:25:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rAVGOw
[22:25:56] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:26:18] <doomlord> i really like the fact globals need 'unsafe' in rust
[22:26:26] <doomlord> ^mutable globals
[22:26:40] <strcat> well it's not memory safe
[22:26:47] <ecr> doomlord: well they're about as unsafe as it gets
[22:26:48] <Sergio965> aatch: Well, that's because C has set the standard for what should and shout not be implemented as part of a library. C could have easily implemented array accesses as part of their runtime.
[22:26:57] <Sergio965> should*
[22:27:22] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:27:36] <Sergio965> Anyways, I think it's a nice ideal.
[22:27:53] <aatch> Sergio965, and it pays for it in other ways. Don't get me wrong, I'd like rust to be more like C in that way.
[22:27:56] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[22:28:40] <aatch> But at the end of the day `~` requires allocation and that means you need support for that.
[22:28:54] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:28:54] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Vi32Dg
[22:28:54] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:28:55] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[22:28:55] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Xo-ivQ
[22:28:55] <ghrust> 13rust/06auto 144c1ee75 15Patrick Walton: librustc: Remove `&const` and `*const` from the language....
[22:28:55] <ghrust> 13rust/06auto 14964c2dc 15bors: auto merge of #8252 : pcwalton/rust/deconst, r=pcwalton...
[22:28:56] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[22:29:33] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[22:29:34] <doomlord> i would definitely like the layered library idea (rust zero..)
[22:29:39] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:29:45] <strcat> pcwalton: there wasn't actually a huge amount of `for` code to rip out, at least that I found
[22:29:48] <strcat> only ~500 lines
[22:30:11] <strcat> maybe there's some more I missed related to closures
[22:30:30] <steven_is_false> Hi. I would like to break up the implementation (but not the interface) of extra::sync into multiple files. How can I do this, and preserve the documentation attached to the values?
[22:30:30] <aatch> doomlord, that is planned to some extent. With the standard library having compilation "profiles" for different use cases.
[22:30:44] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[22:31:04] <aatch> steven_is_false, well you can use `pub use` to re-export
[22:31:29] <steven_is_false> aatch: That's what I tried but rust doc doesn't re-export the documentation.
[22:31:40] <aatch> steven_is_false, don't worry about that for now.
[22:31:50] <steven_is_false> aatch: Really?
[22:31:57] <aatch> There is a reason why cmr is working on a new rustdoc
[22:32:02] <steven_is_false> aatch: Okay.
[22:34:55] <strcat> rusti: struct Take<T> { iter: T, n: uint} fn take<A, T: Iterator<A>>(iter: &mut T, n: uint) -> Take<T> { Take{iter: iter, n: n} }
[22:34:55] -rusti- <anon>:5:107: 5:111 error: mismatched types: expected `main::Take<T>` but found `main::Take<&mut T>` (expected type parameter but found &-ptr)
[22:34:55] -rusti- <anon>:5          struct Take<T> { iter: T, n: uint} fn take<A, T: Iterator<A>>(iter: &mut T, n: uint) -> Take<T> { Take{iter: iter, n: n} }
[22:34:55] -rusti-                                                                                                                     ^~~~
[22:34:56] -rusti- error: aborting due to previous error
[22:34:57] -rusti- application terminated with error code 101
[22:35:34] <strcat> rusti: struct Take<'self, T> { iter: &'self mut T, n: uint} fn take<'r, A, T: Iterator<A>>(iter: &'r mut T, n: uint) -> Take<'r, T> { Take{iter: iter, n: n} }
[22:35:34] -rusti- ()
[22:35:42] * strcat ponders redoing a lot of the adaptors
[22:36:31] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:38:45] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[22:39:06] <bblum> brson: you appear to be right about the idle loops being the cause
[22:40:40] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[22:41:09] <brson> bblum: bummer :-/ it's pretty easy to fix though. maybe i can do it tommorrow. it's high priority
[22:41:36] <jdm> rusti: type T = &'static fn();
[22:41:49] <bblum> (well, it could have been another commit in between the two commits you named)
[22:42:04] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:42:05] <bblum> (but right before the former is fast and right after the latter is slow)
[22:42:13] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[22:42:16] <jdm> rusti: fn f() {}; type T = &'static fn(); pub static C: T = f; C
[22:42:26] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Client exited)
[22:42:27] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:42:34] <jdm> rusti: fn f() {}; type T = &'static fn(); pub static C: T = f; C
[22:42:38] -rusti- <anon>:5:62: 5:63 error: mismatched types: expected `&'static fn<no-bounds>()` but found `extern "Rust" fn()` (expected fn but found extern fn)
[22:42:38] -rusti- <anon>:5          fn f() {}; type T = &'static fn(); pub static C: T = f; C
[22:42:38] -rusti-                                                                        ^
[22:42:38] -rusti- error: aborting due to previous error
[22:42:38] -rusti- application terminated with error code 101
[22:42:51] <jdm> rusti: fn f() {}; type T = &'static extern "Rust" fn(); pub static C: T = f; C
[22:42:51] -rusti- <anon>:5:76: 5:77 error: mismatched types: expected `&'static extern "Rust" fn()` but found `extern "Rust" fn()` (expected &-ptr but found extern fn)
[22:42:51] -rusti- <anon>:5          fn f() {}; type T = &'static extern "Rust" fn(); pub static C: T = f; C
[22:42:51] -rusti-                                                                                      ^
[22:42:52] -rusti- error: aborting due to previous error
[22:42:53] -rusti- application terminated with error code 101
[22:42:57] *** Quits: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP) (Client exited)
[22:43:00] <jdm> rusti: fn f() {}; type T = &'static extern "Rust" fn(); pub static C: T = &f; C
[22:43:02] -rusti- &
[22:43:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:43:07] <jdm> heh
[22:43:35] <sully> hm...
[22:43:43] <sully> I... am getting a type error on a Clone declaration
[22:43:47] <jdm> rusti: fn f() {}; struct S(&'static extern "Rust" fn()); pub static C: S = S(&f); C
[22:43:48] -rusti- {__field__: &}
[22:44:09] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:44:13] <tjc> sully: paste the code?
[22:44:20] <strcat> meh, rvalues would really make using &mut in the adaptors painful
[22:44:22] <tjc> though I think I know what you're talking about
[22:44:24] <strcat> until that issue gets fixed
[22:44:25] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:44:26] <tjc> in which case you're in a world of sadness
[22:44:49] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Quit: Leaving.)
[22:45:18] *** Joins: gavinb (gavinb@A96C7C3.60EC9D3E.C98315F2.IP)
[22:46:03] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:49:38] <strcat> nooo
[22:49:41] <strcat> expected type parameter but found type parameter)
[22:49:45] * strcat hates lifetime errors
[22:50:13] <bblum> brson: https://github.com/mozilla/rust/pull/8317
[22:51:12] *** Quits: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net) (Ping timeout)
[22:51:18] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[22:53:50] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:54:53] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[22:55:26] *** kimundi is now known as zz_kimundi
[22:55:47] *** Parts: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) ()
[22:58:18] <strcat> pcwalton: http://ix.io/750 so this does work (taking &mut self) but then a temporary is currently required for each adaptor call
[22:58:49] <sully> tjc: oh, I figured it out
[22:59:02] <sully> tjc: the problem was just that one of the types it used didn't have the trait, which...
[22:59:07] <sully> well, bad error message
[22:59:11] <tjc> sully: ah ok, that's less bad than I thought :-)
[22:59:15] <strcat> hm
[22:59:20] <tjc> couple of times when I've tried to change the AST, I got an error message like that
[22:59:22] <strcat> oh I might be wrong
[22:59:31] <tjc> which I assume meant I needed to do the whole stage0/stage1/stage2 dance
[22:59:35] <tjc> and I decided not to change the AST
[22:59:56] <strcat> meh no
[23:00:05] <engla> strcat: I think it makes it impossible to return a new iterator from a function
[23:00:50] <strcat> engla: I don't think it does
[23:01:14] <strcat> although you'd need a way to tie the lifetime to something else
[23:01:43] <engla> a new veciterator will live on the stack
[23:02:06] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[23:02:27] <strcat> true
[23:02:28] <kmc> i read "a new velociraptor"
[23:02:53] <engla> strcat: but I can see the use of these semantics
[23:03:26] *** Quits: veddan (viktor@moz-C79BC80B.csbnet.se) (Ping timeout)
[23:03:42] <engla> If  <T:Iterator<..>> &mut T  implements iterator, can't you have both?
[23:04:00] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[23:04:11] *** Joins: veddan (viktor@moz-C79BC80B.csbnet.se)
[23:04:13] <engla> all my generic trait constructions with &T usually fail, though
[23:04:22] <brson> could somebody familiar with trans review https://github.com/mozilla/rust/pull/8270? The thing that most concerns me is that it incidentally adds two high-level bindings for LLVM types, and I'm not sure whether that jives with whatever intentions we have here
[23:04:25] <bblum> brson: oh, btw, the 21% speedup becomes a 11% speedup when i remember to use rustc -O when building the benchmark program
[23:05:54] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Ping timeout)
[23:06:49] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[23:08:36] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[23:09:14] <bblum> i wonder if i can lazily initialize KillHandle too
[23:09:36] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:09:55] <gavinb> Getting all confused with iterators and types can someone shed any light on https://gist.github.com/gavinb/6160470 ?
[23:10:21] <gavinb> First issue is that all() can happily unpack a tuple, whereas switching the same expression to take_while() cannot.
[23:10:38] <strcat> take_while is passed a reference
[23:10:45] <gavinb> Second issue is I can't figure out the right types to get the iterator to collect the results.
[23:10:52] <strcat> 'all' ends the iterator stack so it takes it by-value
[23:10:58] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[23:10:58] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14964c2dc to 1429099e4: 02http://git.io/N3iJvQ
[23:10:58] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[23:10:59] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:10:59] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/zUzxSw
[23:10:59] <ghrust> 13rust/06auto 143c6895d 15Brian Anderson: std::rt: 2MB stacks again
[23:10:59] <ghrust> 13rust/06auto 145cc8fa0 15Brian Anderson: std::rt: Pull RUST_MIN_STACK from the environment
[23:10:59] <ghrust> 13rust/06auto 14c2d1e9e 15Brian Anderson: std: Allow spawners to specify stack size
[23:11:01] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:11:17] <strcat> if you have Iterator<A>, take_while is passed &A
[23:11:40] <strcat> iter() on ~[int] is Iterator<&A>
[23:11:42] <gavinb> strcat: ok, but why can't you have a reference to a tuple then?
[23:12:08] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[23:12:26] *** Joins: dim-an (ermolovd@moz-A1FD62E4.yandex.net)
[23:12:33] <Eridius> strcat: I'm tempted to extend ConsumeIter to support DoubleEndedIterator, as well as RandomAccessIterator if A: Clone. Any objections/
[23:12:44] <Eridius> By doing that I can also change ConsumeRevIterator to just be Invert<ConsumeIterator>
[23:13:00] <strcat> well it can't do the RandomAccessIterator part
[23:13:04] <Eridius> strcat: it can if A: Clone
[23:13:06] <strcat> RandomAccessIterator isn't finished
[23:13:09] <Eridius> oh
[23:13:16] <Eridius> what's not finished about it?
[23:13:30] <strcat> it's probably going to have to hardcode the need to yield a reference
[23:13:45] <Eridius> hmm
[23:13:47] <dim-an> hi, what should I do to enable `debug!` messages while running rustc?
[23:13:52] <strcat> consider...
[23:14:00] <strcat> a mutable random access iterator
[23:14:14] <strcat> where you have swap() and the ability to index - you can only index one thing at a time
[23:14:24] <strcat> so you still need the immutable one around to be able to write something like a sort
[23:14:37] <Eridius> I was assuming that RandomAccessIterator was basically designed for iterators that already yielded references or otherwise-clonable things
[23:14:38] <strcat> so you need the same iterator implementing both
[23:14:47] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:15:14] <tjc> dim-an: RUST_LOG=rustc::middle::trans rustc foo.rs
[23:15:28] <tjc> dim-an: instead of rustc::middle::trans you can put whatever module or modules in rustc you want debug! messages from, comma-separated
[23:15:31] <Eridius> strcat: ok well anyway, I can at least support DoubleEndedIterator
[23:15:38] <tjc> you can also say RUST_LOG=rustc but that's a lot of noise
[23:15:43] <strcat> Eridius: yeah
[23:15:51] <Eridius> tjc: actually debug! gets compiled-out now without the right config
[23:15:58] *** Quits: mark_edward (quassel@moz-9631ECE3.public.wayport.net) (Ping timeout)
[23:16:00] <tjc> Eridius: d'oh, forgot about that
[23:16:15] <Eridius> I forget the correct flag to turn it on. It's not in `rustc --help`, which it probably should be
[23:16:18] <tjc> dim-an: you actually have to build rustc with ./configure --enable-debug for this to work
[23:16:35] <dim-an> tjc: thanks!
[23:16:40] <brson> toddaaro: I had to make some parts of the scheduler uglier to get things working. My current pull request adds `stack_size: Option<uint>` to all the Task ctors, and I threw in a bunch of new idle callbacks. Accumulating some debt here. Sorry
[23:16:51] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[23:18:05] *** Joins: mark_edward (quassel@981AA104.E81F12CD.76F66111.IP)
[23:18:28] <jdm> huh, does make rustc not build llvm any more?
[23:18:28] <Eridius> strcat: hmm, ConsumeIterator's next() isn't marked #[inline]. I assume that's just an oversight?
[23:18:34] <strcat> Eridius: yes
[23:18:39] <jdm> I ran that, then make install, and now llvm is building o.o
[23:19:10] <gavinb> strcat: what about getting the types right for collect()-ing the results of the take_while() in that gist?
[23:19:16] *** Quits: Sergio965 (sergiobz@moz-BB21156B.dynamic.csail.mit.edu) (Ping timeout)
[23:19:19] <toddaaro> brson: what idle callbacks?
[23:19:45] <strcat> gavinb: all receives A, take_while receives &A
[23:20:00] <strcat> you're being passed & &(...)
[23:20:50] <Eridius> strcat: d'oh, the way ConsumeIterator works, implementing .next_back() becomes really expensive :/
[23:21:05] <gavinb> strcat: oh so changing the type to "& &()" is valid? ok.
[23:21:22] <strcat> Eridius: yeah it might not make sense to have it
[23:21:30] <gavinb> I tried && and it gave me an error about an outmoded syntax or something.
[23:21:50] <strcat> Eridius: if you need it, you probably really want a deque
[23:21:54] <aatch> gavinb, you need to put a space between the '&'
[23:22:06] <Eridius> strcat: well I mean it's trivial if you haven't called .next() yet, it just becomes expensive after that
[23:22:09] <gavinb> aatch: thanks; is that a bad code smell?
[23:22:21] <strcat> no
[23:22:25] <aatch> gavinb, not really, just a syntax wart
[23:22:35] <gavinb> ok, cool
[23:22:43] <aatch> though the mode thing is just obsolete syntax that should be removed.
[23:23:38] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[23:24:01] <gavinb> Well I still can't figure out how to get the types right for collect(). It seems to me it should be able to infer the right type, since take_while() is returning a vector of types it already knows. But as per that gist, I just can't seem to get it right! :/
[23:24:25] <strcat> vector's iter() gives you Iterator<&A>
[23:24:31] <gavinb> If someone would kindly set me straight, I will put up a patch to the docs to help explain it for n00bs like me.
[23:24:45] <tjc> gavinb: you need a type annotation, I'm not sure if it's a typechecker bug or not but collect is weird
[23:24:50] <tjc> basically just name one of the intermediate results
[23:25:04] <strcat> collect returns a generic collection type
[23:25:11] <strcat> so it does need some way to infer that
[23:25:22] <engla> strcat: what do you think about just a by-ref adaptor? https://gist.github.com/anonymous/35c42b56f07e00e32c33
[23:25:36] <engla> strcat: also, .take_() is buggy and swallows a value it doesn't need to see
[23:25:51] <strcat> engla: I know I just fixed it
[23:25:56] <strcat> it's not really a bug
[23:26:20] <gavinb> strcat: but I put ~[(&int, &int)] on the collect() result and it seems to ignore it. Putting a type annotation on collect() seems to have some effect.
[23:26:21] <engla> hehe. well if you want to use references instead of owning the iterator, it matters
[23:26:30] <strcat> engla: yeah but it's not defined in the API
[23:26:31] <engla> strcat: what do you think about the code example?
[23:27:03] <strcat> gavinb: because you don't have Iterator<(&int, &int)>
[23:27:18] <strcat> you have Iterator<&(&int, &int)>
[23:27:20] <brson> toddaaro: more Scheduler::run_sched_once's. The issue is that the async callbacks enqueued on message sends are not guaranteed to all run, so we were dropping lots of messages. so now the scheduler is very conservative and creates way too many idle callbacks to run run_sched_once. what should be happening is that there should only ever be a single idle run_sched_once callback and every time it succeeds at doing a 'scheduler action' it should reenqueue
[23:28:09] <strcat> rusti: range(0, 10).collect::<~[int>()
[23:28:09] -rusti- <anon>:6:4: 6:5 error: incorrect close delimiter: `}`
[23:28:09] -rusti- <anon>:6     };
[23:28:09] -rusti-              ^
[23:28:10] -rusti- application terminated with error code 101
[23:28:13] <strcat> rusti: range(0, 10).collect::<~[int]>()
[23:28:13] -rusti- ~[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[23:28:29] <strcat> rusti: let xs = ~[1, 2, 3]; xs.consume_iter().collect::<~[int]>()
[23:28:29] -rusti- ~[1, 2, 3]
[23:28:40] <strcat> rusti: let xs = ~[1, 2, 3]; xs.iter().transform(|&x| x).collect::<~[int]>()
[23:28:41] -rusti- ~[1, 2, 3]
[23:31:03] <toddaaro> brson: ah ok, I think I saw that
[23:31:28] <toddaaro> brson: yea, eventually that will be the active work unit and we can stamp them all out
[23:31:37] <gavinb> 
[23:32:11] <strcat> gavinb: hm?
[23:32:22] *** Parts: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) ()
[23:32:36] <gavinb> strcat: sorry, still a bit confused!
[23:32:54] <strcat> rusti: range(0, 10).zip(range(20, 30)).collect::<~[(int, int)]>()
[23:32:54] <gavinb> If I use collect::<~[&(&int, &int)]>(); it seems to work
[23:32:55] -rusti- ~[(0, 20), (1, 21), (2, 22), (3, 23), (4, 24), (5, 25), (6, 26), (7, 27), (8, 28), (9, 29)]
[23:33:09] <strcat> gavinb: you have Iterator<&(&int, &int)>
[23:33:18] <strcat> next() yields &(&int, &int)
[23:33:21] <strcat> not (int, int)
[23:33:29] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[23:33:32] <strcat> collect will take everything it yields and put it into a container
[23:33:39] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[23:33:41] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[23:33:47] <strcat> it's yielding &(&int, &int), so it will make a container of &(&int, &int)
[23:33:59] <strcat> if you want (&int, &int) you need to copy in a transform
[23:34:12] <mihneadb> how do I use make (in the rust tree) to rebuild just the extra lib?
[23:34:20] <gavinb> strcat: aha, ok that makes sense
[23:34:38] <Eridius> strcat: looks like a bunch of iterators in vec.rs are missing #[inline]. I assume that this is all just an accident, and that none of these were intentionally not inlined?
[23:34:51] <Eridius> strcat: e.g. RandomAccessIterator for VecIterator has #[inline] on indexable() but not idx()
[23:35:06] <strcat> RandomAccessIterator is just a sketch
[23:35:12] <strcat> doesn't really matter
[23:35:20] <Eridius> ok but there's a bunch of Iterators missing it too
[23:35:23] <Eridius> and a bunch of them missing size_hints
[23:35:45] <gavinb> strcat: I think I just need to write out the types step by step for it to make sense. Thanks for your help...
[23:35:46] <mihneadb> also what's the style convention with function prototypes that are longer than 80 chars?
[23:35:53] <strcat> I don't know about the implementations of the others, I only wrote VecIterator
[23:35:56] <Eridius> mihneadb: the line length limit is 100
[23:36:07] <mihneadb> ah, I m safe, 95
[23:36:08] <mihneadb> Eridius: still
[23:36:10] <aatch> Eridius, some of that is down to strcat being too lazy to implement size_hints on all of them.
[23:36:17] <Eridius> hehe
[23:36:27] <Eridius> aatch: I did a pass a while ago to add all the missing size_hints, looks like I have to do another
[23:36:30] <mihneadb> Eridius: still, with long type annotations and stuff, that could be easily reached. What then?
[23:36:35] <Eridius> mihneadb: then add newlines
[23:36:37] <strcat> engla: I guess I like by_ref
[23:36:52] <Eridius> mihneadb: if you wrap the argument list, the second line should start on the column after the opening (
[23:36:53] <mihneadb> Eridius: right but where do I split? Or.. where can I read about this
[23:36:54] <strcat> engla: it would be much uglier to make more adaptors
[23:36:59] <strcat> engla: it's too bad 'ref' is a keyword ;p
[23:37:09] <Eridius> mihneadb: if you wrap just the return type, I've seen it placed on that same column, but IMO it should be placed level with the (, not after
[23:37:24] <mihneadb> Eridius: ty
[23:37:45] <mihneadb> Eridius: do you know how I could rebuild just a specific folder?
[23:38:00] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[23:38:07] <Eridius> mihneadb: due to the multi-stage compilation, you can't just rebuild a specific folder
[23:38:16] <mihneadb> Eridius: even for libs?
[23:38:21] <Eridius> mihneadb: but if you're e.g. just working on libstd, you can use `make check-stage1-std NO_REBUILD=1` to speed up the process
[23:38:25] <engla> strcat: It could be a wrapper type like that and not an adaptor, maybe that's less confusing. It's just cute that it can be done, I'm sure there will be other "bugs" like the take one
[23:38:30] <mihneadb> Eridius: aha, thanks!
[23:39:05] <Eridius> mihneadb: I still recommend doing a `make check-stage2-std` or a full `make clean` when you're done, just in case
[23:39:16] <Eridius> err `make check`, not `make clean`
[23:39:45] <mihneadb> Eridius: ok. No need to rerun configure, though
[23:39:57] <Eridius> mihneadb: nope. and `make` will actually re-configure for you if it thinks it needs to
[23:40:04] <Eridius> (preserving your last-used configure args)
[23:40:09] <mihneadb> ok
[23:40:12] <mihneadb> cool
[23:41:38] *** Quits: gavinb (gavinb@A96C7C3.60EC9D3E.C98315F2.IP) (Ping timeout)
[23:42:10] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[23:43:26] <strcat> engla: yeah but it's mostly an implementation detail since it's not specified in the docs
[23:43:30] <strcat> we'd need to specify their behaviour
[23:43:47] <strcat> for example, does zip short-circuit - atm it doesn't
[23:44:19] <mihneadb> Eridius: could it be that by default rust's make uses just 1 cpu core?
[23:44:29] <engla> sure. it's not a big deal, we don't have to call it a bug
[23:45:05] <aatch> mihneadb, it's because rustc doesn't parallelize
[23:45:27] <mihneadb> aatch: oh. work in progress I guess?
[23:45:36] <strcat> not really in progress
[23:46:03] <mihneadb> is figuring out dependencies an issue, or why doesn't it do it already?
[23:46:10] <aatch> I've looked at what needs to be done, and it's a lot.
[23:46:16] <aatch> mihneadb, it's complicated.
[23:46:16] <mihneadb> ok
[23:47:02] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[23:47:03] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[23:47:03] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f65fa69 to 1429099e4: 02http://git.io/N3iJvQ
[23:47:03] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[23:47:05] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[23:47:05] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JJ1jHg
[23:47:05] <ghrust> 13rust/06auto 140ac7a21 15Marvin Lbel: Updated std::Option, std::Either and std::Result...
[23:47:05] <ghrust> 13rust/06auto 14bbda3fa 15bors: auto merge of #8288 : Kimundi/rust/opteitres4, r=brson...
[23:47:06] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[23:47:14] <tikue> rusti: let mut v: ~[&uint] = ~[]; let v2 = [1u, 2, 3]; v.push_all(v2.iter().collect()); v
[23:47:14] -rusti- <anon>:5:68: 5:88 error: failed to find an implementation of trait std::iterator::FromIterator<&uint,std::vec::VecIterator<,uint>> for &[&uint]
[23:47:14] -rusti- <anon>:5          let mut v: ~[&uint] = ~[]; let v2 = [1u, 2, 3]; v.push_all(v2.iter().collect()); v
[23:47:15] -rusti-                                                                              ^~~~~~~~~~~~~~~~~~~~
[23:47:15] -rusti- application terminated with error code 101
[23:47:23] <tikue> anyone know what that means?
[23:47:25] <strcat> mihneadb: there aren't usually reasons beyond lack of infinite time
[23:48:03] <mihneadb> strcat: I was thinking that since you guys have to rebuild rust so often (you do, right?) this would actually get you more time :)
[23:48:37] <mihneadb> but I can see how it's not a priority
[23:48:44] <tikue> is there no way to use collect with poitners/
[23:48:51] <strcat> tikue: you can
[23:49:01] <tikue> strcat: what did I do incorrectly in the above?
[23:49:12] <strcat> tikue: push_all takes a slice
[23:49:13] <cmr> mihneadb: language features and correctness of implementation are pretty important
[23:49:22] <strcat> tikue: it inferred you wanted &[]
[23:49:25] <strcat> and you can't collect a &[]
[23:49:31] <tikue> ah
[23:49:32] <strcat> but in that use case you really want 'extend'
[23:49:43] <strcat> building a vector just to append to another is very wasteful
[23:49:56] <aatch> mihneadb, the issue is more complex than that. We have to figure out what we need to rebuild, what we don't, how to store the data, where to store it, how to deal with inconsistent state.
[23:49:57] <strcat> rusti: let mut xs = [1, 2]; xs.extend(range(3, 10)); xs
[23:49:58] -rusti- <anon>:5:30: 5:54 error: type `[<VI1>, .. 2]` does not implement any method in scope named `extend`
[23:49:58] -rusti- <anon>:5          let mut xs = [1, 2]; xs.extend(range(3, 10)); xs
[23:49:58] -rusti-                                        ^~~~~~~~~~~~~~~~~~~~~~~~
[23:49:58] -rusti- error: aborting due to previous error
[23:49:58] -rusti- application terminated with error code 101
[23:50:06] <strcat> rusti: use std::iterator::*; let mut xs = [1, 2]; xs.extend(range(3, 10)); xs
[23:50:06] -rusti- <anon>:5:52: 5:76 error: type `[<VI1>, .. 2]` does not implement any method in scope named `extend`
[23:50:06] -rusti- <anon>:5          use std::iterator::*; let mut xs = [1, 2]; xs.extend(range(3, 10)); xs
[23:50:06] -rusti-                                                              ^~~~~~~~~~~~~~~~~~~~~~~~
[23:50:08] -rusti- error: aborting due to previous error
[23:50:10] -rusti- application terminated with error code 101
[23:50:11] * strcat sighs
[23:50:14] <strcat> rusti: use std::iterator::*; let mut xs = ~[1, 2]; xs.extend(range(3, 10)); xs
[23:50:15] -rusti- pastebinned 7 lines of output: http://sprunge.us/WiFK
[23:50:27] <strcat> rusti: use std::iterator::*; let mut xs = ~[1, 2]; xs.extend(&mut range(3, 10)); xs
[23:50:28] -rusti- ~[1, 2, 3, 4, 5, 6, 7, 8, 9]
[23:50:29] <strcat> ;p
[23:50:38] <mihneadb> cmr: right, that's why I said that I see how parallelizing the compiler is not a priority. :) I was being honest
[23:50:50] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[23:50:55] <mihneadb> aatch: right, makes sense
[23:51:19] <strcat> it's easier to speed up rustc by 50% than teach it to use 2 cores
[23:51:19] <bblum> oh come on what
[23:51:19] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; xs.extend(&mut range(3, 10)); xs
[23:51:20] -rusti- pastebinned 8 lines of output: http://sprunge.us/bLGj
[23:51:24] <bblum> you can't have typaram arguments in macros?
[23:51:33] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; v.extend(&mut range(3, 10)); v
[23:51:34] -rusti- pastebinned 14 lines of output: http://sprunge.us/eJFO
[23:51:46] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; v.extend(&mut range(3u, 10)); v
[23:51:47] -rusti- pastebinned 14 lines of output: http://sprunge.us/BDWZ
[23:51:54] <strcat> tikue: it's not going to let you do that
[23:52:03] <strcat> range returns int or uint
[23:52:13] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[23:52:25] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[23:52:29] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; v.extend([3, 4, 5].iter()); v
[23:52:30] -rusti- pastebinned 7 lines of output: http://sprunge.us/JKWd
[23:52:34] <aatch> and that's just the design stage. The current code isn't set up for it. And there isn't much precedent. clang and gcc don't parallelize (afaik), it's just that their unit of compilation is much smaller.
[23:52:35] <cmr> dbaupp: pong
[23:52:38] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[23:52:43] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; v.extend([3u, 4, 5].iter()); v
[23:52:44] -rusti- pastebinned 7 lines of output: http://sprunge.us/EFaW
[23:52:51] <strcat> tikue: won't work either - that vector is a temporary
[23:53:04] <strcat> the lifetime of pointers to it is nil
[23:53:09] <mihneadb> strcat: interesting! wow
[23:53:14] <brson> what's ChrisMorgan's github nick?
[23:53:22] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3, 4, 5]; v.extend(xs.iter()); v
[23:53:23] -rusti- pastebinned 7 lines of output: http://sprunge.us/DFhO
[23:53:24] <cmr> brson: ChrisMorgan
[23:53:26] <mihneadb> aatch: I was talking about the equivalent for make -j N
[23:53:28] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[23:53:37] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3, 4, 5]; v.extend(&xs.iter()); v
[23:53:38] -rusti- pastebinned 14 lines of output: http://sprunge.us/ZHMc
[23:53:42] * tikue gives up
[23:53:45] <cmr> mihneadb: We compile the entire crate at once, we don't compile .rs files individually like you can do with C
[23:53:48] <brson> cmr: are you sure? he has no repos? do you know where his http impl is?
[23:53:56] <mihneadb> cmr: oh, ok, I see
[23:53:58] <cmr> brson: http://hg.chrismorgan.info/rusthttpserver/
[23:54:00] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&xs.iter()); v
[23:54:02] -rusti- pastebinned 47 lines of output: http://sprunge.us/ANPX
[23:54:15] <engla> tikue: must pass &mut xs.iter()
[23:54:24] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); v
[23:54:25] -rusti- pastebinned 44 lines of output: http://sprunge.us/gbeT
[23:54:26] <aatch> tikue, you can't return the constructed vector
[23:54:27] <strcat> and you can't have `v` at the end
[23:54:39] <aatch> because it's contents won't live long enough.
[23:54:46] <strcat> it does 'let r = { your code }'
[23:54:58] <strcat> so unless you use static vectors, the lifetime won't last beyond the block
[23:55:02] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); for & &x in v { printfln!(x); }
[23:55:03] -rusti- <anon>:5:102: 6:5 error: type `&mut ~[&uint]` does not implement any method in scope named `next`
[23:55:03] -rusti- <anon>:5          use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); for & &x in v { printfln!(x); }
[23:55:03] -rusti- <anon>:6     };
[23:55:03] -rusti- error: aborting due to previous error
[23:55:04] -rusti- application terminated with error code 101
[23:55:05] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[23:55:11] <engla> maybe we should have a by_ref() adaptor anyway for that
[23:55:11] <brson> cmr: i'm going to have to take him to task about this hg business
[23:55:13] <tikue> rusti: use std::iterator::*; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); for & &x in v.iter() { printfln!(x); }
[23:55:14] -rusti- pastebinned 6 lines of output: http://sprunge.us/cYdH
[23:55:19] * tikue cheers
[23:55:40] <strcat> rusti: range(0, 0)
[23:55:40] -rusti- {state: 0, stop: 0, one: 1}
[23:56:46] * strcat wants 'join' for iterators
[23:56:48] <tikue> rusti: use std::iterator::Extend; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); for & &x in v.iter() { printfln!(x); }
[23:56:48] -rusti- pastebinned 8 lines of output: http://sprunge.us/ciAJ
[23:56:48] <brson> servo can't use hg submodules!
[23:57:05] <tikue> strcat: what do I import for extend
[23:57:13] <strcat> iterator::Extendable
[23:57:14] <aatch> brson, why would servo want to use a http server?
[23:57:19] <strcat> I forgot to put it in prelude
[23:57:20] <tikue> thanks
[23:57:21] <strcat> I'll do that now
[23:57:42] <tikue> rusti: use std::iterator::Extendable; let mut v = ~[&1u, &2]; let xs = [3u, 4, 5]; v.extend(&mut xs.iter()); for & &x in v.iter() { printfln!(x); }
[23:57:43] -rusti- pastebinned 6 lines of output: http://sprunge.us/ijFi
[23:57:53] <tikue> strcat: is extendable new? 
[23:57:58] <strcat> fairly new
[23:58:00] <brson> aatch: i've been led to believe he will implement a client too
[23:58:01] <tikue> gah
[23:58:10] <aatch> brson, ahh, fair enough
[23:58:13] <strcat> fe955e7b src/libstd/iterator.rs    35 (Daniel Micay         2013-07-27 17:41:30 -0400   34) /// A type growable from an `Iterator` implementation
[23:59:38] <strcat> hm
