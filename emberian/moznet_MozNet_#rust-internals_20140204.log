[00:03:22] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:04:23] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[00:05:03] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[00:05:03] *** ChanServ sets mode: +ao pcwalton pcwalton
[00:07:10] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[00:07:10] *** ChanServ sets mode: +o tjc
[00:18:09] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[00:19:03] *** kimundi is now known as zz_kimundi
[00:22:07] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[00:25:51] <SimonSapin> aww, I know Iâ€™m the one who requested to disallow str[i] = byte, but now I canâ€™t even do in with unsafe{} ?
[00:26:33] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:26:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ztHXlg
[00:26:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:29:40] <SimonSapin> str::raw::as_owned_vec to the rescue
[00:31:34] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:31:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/xa-jvg
[00:31:34] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:31:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:31:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4ut28Q
[00:31:35] <ghrust> 13rust/06auto 14c6b1bce 15Flavio Percoco: Replace NonCopyable usage with NoPod...
[00:31:35] <ghrust> 13rust/06auto 142877928 15bors: auto merge of #12016 : FlaPer87/rust/remove-non-copyable, r=alexcrichton...
[00:31:35] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:33:32] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[00:34:03] *** Quits: ecr (chatzilla@moz-CC701484.dhcp4.washington.edu) (Ping timeout)
[00:34:42] *** Joins: ecr (chatzilla@moz-CC701484.dhcp4.washington.edu)
[00:35:29] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[00:59:47] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:02:56] *** Quits: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP) (Ping timeout)
[01:05:15] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[01:06:12] *** Joins: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP)
[01:07:53] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[01:08:56] <acrichto> ah, right, snapshot
[01:10:14] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:20:10] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[01:20:10] *** ChanServ sets mode: +ao dherman dherman
[01:20:48] <cmr> SimonSapin: also .as_bytes
[01:20:59] <cmr> or there probably isn't a mutable version of that is there
[01:21:13] <cmr> as_owned_vec to the rescue indeed
[01:21:14] <SimonSapin> cmr: there isnâ€™t
[01:22:04] <SimonSapin> str::raw::as_owned_vec is close enough, returning &mut ~[u8]
[01:23:33] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[01:23:42] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:32:49] *** Joins: zimbabao (rajaram@BD340D8A.B67BB2DC.D2D1FAF0.IP)
[01:33:57] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse_)
[01:34:16] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[01:36:22] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[01:37:22] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[01:41:42] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:41:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/4ut28Q
[01:41:42] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:42:14] *** Quits: zimbabao (rajaram@BD340D8A.B67BB2DC.D2D1FAF0.IP) (Ping timeout)
[01:43:24] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[01:43:45] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[01:45:25] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[01:46:38] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:46:38] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/YN0OXQ
[01:46:38] <ghrust> 13rust/06auto 14b69c81c 15joaoxsouls: doc: update boxes section on Manual, remove managed pointers references
[01:46:38] <ghrust> 13rust/06auto 14c1395ea 15bors: auto merge of #11999 : joaoxsouls/rust/master, r=cmr
[01:46:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:46:43] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[01:46:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/n-QSjw
[01:46:43] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[01:46:59] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[01:48:03] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[01:48:32] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[01:50:37] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[01:51:02] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[01:52:54] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[01:57:11] *** Joins: zimbabao (rajaram@45C2CE6D.3AF94ACE.D2D1FAF0.IP)
[01:57:31] *** Quits: ecr (chatzilla@moz-CC701484.dhcp4.washington.edu) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0/20140127194636])
[02:09:59] *** Quits: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:12:38] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:14:21] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[02:17:10] <Eridius> acrichto: "it's not much cleaner" <- oops
[02:17:13] <Eridius> also, yay
[02:17:35] <acrichto> oh argh
[02:17:49] <cmr> much yay, but very typo..
[02:18:10] <Eridius> also, due to the naming, this is kind of confusing: "you can turn on the unused_result lint which will warn about *all* unused results, not just those of type Result/IoResult."
[02:18:23] <Eridius> unused_result means it warns on unused results, not just unused Results...
[02:22:53] <cmr> nrc: congrats!
[02:22:57] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[02:23:06] <nrc> cmr: thank you :-)
[02:23:28] <Eridius> nrc: congrats!
[02:24:09] <nrc> thanks Eridius!
[02:24:25] <brson> acrichto: thanks for sending that email about i/o to the list
[02:35:02] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[02:36:53] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[02:42:03] <acrichto> brson: how would you feel about renaming if_ok! to try!
[02:42:13] <cmr> eh
[02:42:24] <acrichto> not a fan?
[02:42:42] <cmr> it's certainly a better name
[02:43:00] <acrichto> I found if_ok!() to be awkward when using it in a conditional if statement
[02:43:06] <acrichto> if if_ok!(some_io_thing()) { ... }
[02:45:23] <Eridius> try!() sounds like something to catch exceptions
[02:45:28] <Eridius> maybe ensure!()?
[02:45:46] <sfackler> I was thinking or_return! but that's a bit long
[02:46:03] <acrichto> I feel like try!() is the most natural name and good documentation will tell you it's not exception handling
[02:46:11] <acrichto> try is also a very small name
[02:46:31] <sfackler> the try!(try(proc() { ... })) case will be a bit weird, but I don't think it'll be that common
[02:46:50] <acrichto> hm that's a good point
[02:47:02] <acrichto> although it'll probably look like try!(task::try(...))
[02:47:09] <acrichto> which is a little better, but not by much
[02:47:14] <Eridius> maybe just ok!()?
[02:47:18] <Eridius> because it returns the Ok result..
[02:47:28] <cmr> hm
[02:47:31] <cmr> and that reads well too imo
[02:48:12] <acrichto> let a = ok!(foo());
[02:48:15] <acrichto> let b = ok!(bar());
[02:48:20] <Eridius> I like it
[02:48:38] <brson> slight preference for ok! over try! because of the overloading
[02:51:42] *** Quits: gwty (gwtypc@3981F4ED.79F5D148.BD94A9D5.IP) (Ping timeout)
[02:51:54] <acrichto> brson: thoughts on https://github.com/mozilla/rust/pull/11894 ?
[02:52:51] <brson> acrichto: merge it
[02:53:31] *** Joins: wycats (sid79@moz-5F4AA75A.irccloud.com)
[02:53:39] <wycats> ok! doesn't really make sense
[02:53:45] <wycats> it doesn't indicate that the expression may fail
[02:53:55] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[02:54:05] <brson> acrichto: i do think the Arc solution may be better than calling dup
[02:54:13] <brson> but it's an implementation detail hopefully
[02:54:36] <acrichto> brson: hm, well if we did that then we could impl Clone instead of have a freestanding 'fn clone() -> Option<T>'
[02:54:49] <acrichto> I think I'll jsut do that
[02:54:49] <brson> acrichto: oh this doesn't impl clone?
[02:54:50] <brson> why not?
[02:54:55] <acrichto> b/c dup can fail
[02:55:29] <brson> interesting
[02:55:40] <Eridius> wycats: you have to read the docs on the macro no matter what it's called
[02:55:53] <acrichto> brson: Arc just means that non-cloned things need to be in an arc
[02:55:57] <acrichto> brson: but that's not too bad
[02:56:03] <Eridius> ok!() is short, doesn't have existing semantic baggage (like "try" does), and matches the name of the variant it's destructuring
[02:56:18] <brson> acrichto: can't they be arced lazily?
[02:56:31] <acrichto> brson: I suppose they could yeah, internal enum magic
[02:56:35] <acrichto> good point
[02:56:36] <brson> maybe arc can just do atomics lazily
[02:56:37] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:56:37] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/YN0OXQ
[02:56:37] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:56:41] <brson> probably just bake that in to Arc
[02:56:49] <acrichto> .clone() allocates
[02:56:53] <acrichto> oh wait that always does
[02:57:05] <acrichto> well it's not like we're going for efficiency here
[02:57:14] <acrichto> this is just a implementation un-nicety
[02:57:21] <acrichto> but it's not that bad
[02:57:29] <sfackler> iirc the JVM does some dark magic to make non-shared access to a synchronized block super fast
[02:57:38] <sfackler> may be worth looking at
[02:57:49] <acrichto> the JVM is purely dark magic to me lol
[03:01:35] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:01:35] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/NKAEbw
[03:01:35] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:01:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[03:01:36] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/sBYT5A
[03:01:36] <ghrust> 13rust/06auto 1465f3578 15David Manescu: Rename reserve to reserve_exact and reserve_at_least to reserve...
[03:01:36] <ghrust> 13rust/06auto 140131f69 15bors: auto merge of #11951 : dmanescu/rust/reserve-rename, r=huonw...
[03:01:37] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[03:04:05] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:04:13] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[03:05:25] <wycats> having to read the docs isn't really the point
[03:05:43] <wycats> ok! is totally meaningless
[03:05:48] <wycats> it's semantically void of meaning
[03:05:52] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[03:05:58] <wycats> try! may have baggage, but the baggage is actually close to the meaning
[03:06:28] <wycats> "try to do this thing, which may "raise an exception""
[03:06:38] <wycats> in our case "try to do this thing, which may return a result"
[03:06:44] <wycats> "an error result"
[03:12:16] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[03:14:58] *** Quits: gimpf (gimpf@moz-2E64FEA7.adsl.highway.telekom.at) (Quit: Leaving.)
[03:19:17] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[03:22:07] *** Quits: zz_kimundi (kimundi@moz-B1BB70A3.dip0.t-ipconnect.de) (Ping timeout)
[03:26:02] *** Joins: zz_kimundi (kimundi@moz-68679156.dip0.t-ipconnect.de)
[03:26:04] *** zz_kimundi is now known as kimundi
[03:31:39] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:31:39] *** ChanServ sets mode: +ao dherman dherman
[03:35:46] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[03:37:53] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[03:38:05] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[03:41:10] *** Joins: pcwalton (pcwalton@moz-14285ACF.ptr.us.xo.net)
[03:41:11] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:41:32] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:41:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140131f69 to 14c1395ea: 02http://git.io/N3iJvQ
[03:41:32] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:41:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:41:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/FQlDsA
[03:41:33] <ghrust> 13rust/06auto 14882b482 15Alex Crichton: xfail a test to unblock the snapshot...
[03:41:33] <ghrust> 13rust/06auto 14346d378 15bors: auto merge of #12022 : alexcrichton/rust/unblock-snapshot, r=thestinger...
[03:41:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:41:34] *** Quits: pcwalton (pcwalton@moz-14285ACF.ptr.us.xo.net) (Quit: pcwalton)
[03:42:31] *** Joins: pcwalton (pcwalton@moz-14285ACF.ptr.us.xo.net)
[03:42:31] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:43:08] <cgaebel> how do I build stage1 with asserts? or does it do that by default already?
[03:43:33] <acrichto> everything should always be built with asserts
[03:43:39] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[03:43:41] <cgaebel> ok
[03:44:00] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[03:44:00] <acrichto> we currently don't have an assert that can be compiled away
[03:45:38] <sfackler> should all rustpkg issues get closed out now?
[03:45:49] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[03:46:19] <SiegeLord> That's one way to reduce the number of issues... maybe we should remove rustc next ;)
[03:48:06] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[03:51:18] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[04:02:05] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[04:02:13] <Eridius> well this is a curious warning spam from unused_must_use:
[04:02:13] <Eridius> common.rs:24:44: 24:48 warning: unused result which must be used, #[warn(unused_must_use)] on by default
[04:02:16] <Eridius> common.rs:24             Err(err) => { writeln!(stderr, "{}", err.to_str()); continue; }
[04:02:20] <Eridius> oops, I forgot the span line. It was on the "{}"
[04:02:42] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:02:44] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[04:02:59] <acrichto> write! returns an error
[04:03:07] <Eridius> acrichto: yes, and the span should be pointing at it
[04:03:14] <Eridius> instead it's always pointing at the format string
[04:03:36] <acrichto> whee macro expansions
[04:07:17] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:13:52] <ChrisMorgan> I'd rather like to know the answer to cmr's question on the mailing list yesterdayâ€”why are default type parameters feature gated? Is there any official answer? Are they staying? Going? Are they gated because of bikeshedding? Or merely because they might be buggy?
[04:16:35] <ChrisMorgan> Suppose, for example, that in rust-http I make RequestWriter<S: Stream = TcpStream>, enabling the feature gate for the http crate. Is that safe for public consumption?
[04:16:58] <larsberg> ChrisMorgan: there was the beginning of a discussion at last week's meeting - https://github.com/mozilla/rust/wiki/Meeting-weekly-2014-01-28
[04:17:14] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[04:17:17] <larsberg> IIRC, there were questions of whether the gate was for producers only or consumers as well
[04:17:36] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[04:17:41] *** Quits: pcwalton (pcwalton@moz-14285ACF.ptr.us.xo.net) (Quit: pcwalton)
[04:17:58] <larsberg> There were also questions about the interaction with other features of the compiler (e.g. if you don't provide them, do they show up in related type error messages?).
[04:18:03] <cmr> iirc from reading the pr, if you *supply* any default parameters you need the gate.
[04:18:14] <cmr> If they aren't provided they don't show up in errors.
[04:18:31] <ChrisMorgan> larsberg: I really don't understand why it's feature gated from the meeting notes. The reason is not made clear to me at all.
[04:19:21] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[04:21:02] <larsberg> ChrisMorgan: Sorry if I didn't capture the meeting notes well - things fly quickly. It sounded like there was just a lot more discussion to be had for everybody and on the PR about the feature, especially with niko out of town during that meeting.
[04:24:19] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Input/output error)
[04:24:29] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[04:26:08] <ChrisMorgan> OK. Proposal: ungate default type parameters. Now you can tell me why that's not a good idea. â˜º (nmatsakis, brson, acrichto?)
[04:26:43] <acrichto> ChrisMorgan: personally, I feel that they are a very new and untested feature, so I feel like they should get some traction before we un-feature-gate them
[04:26:59] <ChrisMorgan> But isn't ungating them the best way to *get* such feedback?
[04:27:10] <acrichto> we haven't previously taken anything out from behind a feature gate, so we don't have an existing process in place for doing that
[04:27:14] <cmr> ungating is comitting to backwards compat.
[04:27:18] <acrichto> perhaps, again, this is just my opinion
[04:27:20] <cmr> (at least, in a 1.0 context)
[04:28:00] <ChrisMorgan> They'd be convenient in rust-http for RequestWriter<S: Stream = TcpSream>, for example, but if that won't work without affecting other projects tooâ€”well, maybe it just won't happen, and so the testing that could have happened won't.
[04:28:02] <acrichto> the current idea of feature gates is that a gated user can used the default parameters, they just can't override them
[04:28:10] <acrichto> you can do that now, only your project would opt-in
[04:28:20] <acrichto> everyone else will just use RequestWriter
[04:32:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[04:32:18] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:32:18] <ghrust> 01[13rust01] 15alexcrichton merged 06auto into 06snap-stage3: 02http://git.io/kAcTjA
[04:32:18] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:32:32] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[04:32:58] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:33:54] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[04:34:48] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[04:36:29] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[04:39:56] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[04:43:22] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[04:51:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:51:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/FQlDsA
[04:51:39] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:56:27] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:56:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3RX4rg
[04:56:27] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[04:56:28] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:56:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4TXvlQ
[04:56:28] <ghrust> 13rust/06auto 14fd9777c 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[04:56:28] <ghrust> 13rust/06auto 14ef741af 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[04:56:29] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[05:00:31] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[05:08:37] *** Quits: zimbabao (rajaram@45C2CE6D.3AF94ACE.D2D1FAF0.IP) (Ping timeout)
[05:11:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:11:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ef741af to 14346d378: 02http://git.io/N3iJvQ
[05:11:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:11:41] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[05:11:41] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Aykwqg
[05:11:41] <ghrust> 13rust/06auto 145b600ee 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[05:11:41] <ghrust> 13rust/06auto 14fd54641 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[05:11:42] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[05:11:44] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:16:53] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Ping timeout)
[05:17:03] *** bstrie_boot is now known as bstrie_maester
[05:17:13] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[05:17:39] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:19:25] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[05:21:37] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:21:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14fd54641 to 14346d378: 02http://git.io/N3iJvQ
[05:21:37] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:24:27] *** bstrie_maester is now known as bstrie_iro_Days
[05:30:14] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:33:43] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[05:39:23] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[05:39:33] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:39:33] *** ChanServ sets mode: +ao dherman dherman
[05:48:48] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[05:49:24] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:50:45] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[05:51:08] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[05:58:03] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[06:00:30] *** Joins: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[06:03:18] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[06:30:07] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[06:33:38] *** Joins: andrew-d_w (andrew-d_w@moz-963E7120.nat.bb.dnainternet.fi)
[06:33:42] *** Quits: andrew-d_w (andrew-d_w@moz-963E7120.nat.bb.dnainternet.fi) (Input/output error)
[06:34:06] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[06:35:15] *** Joins: eddyb (eddy@832D2DE5.66315F97.FB866788.IP)
[06:39:03] *** Quits: ktt3ja (ktt3ja@moz-85E2770C.hsd1.va.comcast.net) (Quit: Leaving)
[06:45:14] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[06:47:50] *** Joins: cluelessperson (cluelesspe@moz-617B0E16.tx.res.rr.com)
[06:56:21] *** Joins: dbaupp (Thunderbir@moz-25BBAF91.lns20.syd6.internode.on.net)
[06:57:27] <eddyb> &Trait still creates a tydesc :/
[06:57:49] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:58:22] <cmr> eddyb: I wanted to ping you earlier but now I can't remember what it was about
[07:00:02] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:00:22] *** Quits: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[07:01:19] *** Joins: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[07:01:40] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[07:01:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/MYE13Q
[07:01:40] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[07:01:50] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[07:03:02] *** Quits: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[07:03:15] *** Joins: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[07:06:03] <eddyb> doener: I was trying to minimize the testcase (in LLVM IR) and I think I've made it harder :/
[07:06:33] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:06:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/d_A7Lw
[07:06:33] <ghrust> 13rust/06auto 14aa78e4c 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[07:06:33] <ghrust> 13rust/06auto 14f975057 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[07:06:34] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:06:36] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:06:36] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/x5OnCg
[07:06:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:06:44] <doener> eddyb: :-(
[07:06:52] *** Quits: Kxepal (Miranda@moz-94E27C3F.pppoe.mtu-net.ru) (Quit: Kxepal)
[07:07:08] *** Joins: Kxepal (Miranda@moz-94E27C3F.pppoe.mtu-net.ru)
[07:07:40] <eddyb> I wonder why strcat didn't fix the stupid bitcasts for vtables
[07:10:01] <eddyb>   %1 = load void (i8*)** bitcast ({ void ({}*)* }* @vtable1301 to void (i8*)**), align 8
[07:12:33] <eddyb> doener: okay, fixed the vtable issue, -sroa -jump-threading -instcombine doesn't inline
[07:19:44] <eddyb> omg why do we copy out trait pointers *with memcpy*?
[07:20:00] <cmr> eddyb: are we doing that or is llvm?
[07:20:09] <eddyb> virtual calls are more expensive around the call than the call itself
[07:20:15] <cmr> heh
[07:20:33] <eddyb> cmr: well, some of it optimizes out, but it's stupid to output that IR
[07:20:44] <cmr> I agree.
[07:20:51] <cmr> please OCD all over all of trans <3 <3 <3
[07:21:45] *** flaper87|afk is now known as flaper87
[07:22:13] <eddyb> oh, and the lifetime of the copy (according to LLVM) is larger
[07:22:27] <eddyb> in this case, it crosses over a jump
[07:26:43] *** Joins: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com)
[07:27:25] <flaper87> acrichto: r? https://github.com/mozilla/rust/pull/11979 (updated the error message)
[07:27:29] <flaper87> or anyone ^
[07:27:51] <flaper87> (I mean, since it was already approved :P)
[07:29:35] <eddyb> cmr: I wonder why strcat never fixed the entire vtable thing to use the right structure
[07:29:43] <cmr> flaper87: r+
[07:29:51] <flaper87> cmr: thank you, sir!
[07:32:10] <eddyb> doener: the worst part in manual optimizations is that SSA variables need consecutive numbers
[07:32:45] <cmr> eddyb: wait they do?
[07:32:55] <cmr> like, it's malformed ir otherwise?
[07:33:08] <eddyb> cmr: I guess... I don't really know
[07:33:28] <eddyb> cmr: probably just the module verifier is bitching about it
[07:33:40] <cmr> ah
[07:34:34] <doener> I tend to use %foo for new names and insert dummy stuff when I remove var
[07:34:37] <doener> s
[07:41:31] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:41:31] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/DeBiPw
[07:41:31] <ghrust> 13rust/06auto 148658a43 15Richard Diamond: Allow SIMD types in generics. Closes #10604
[07:41:31] <ghrust> 13rust/06auto 1463ba2e1 15Richard Diamond: Simd feature gating + Win32/64 fixes.
[07:41:32] <ghrust> 13rust/06auto 14539ba67 15bors: auto merge of #11717 : DiamondLovesYou/rust/master, r=alexcrichton...
[07:41:34] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:42:04] <cmr> acrichto: http://buildbot.rust-lang.org/builders/auto-win-32-nopt-c/builds/3112/steps/compile/logs/stdio
[07:42:07] <cmr> acrichto: what a silly error!
[07:42:39] <cmr> acrichto: at one point I had a working mingw-xcompile setup for catching windows errors.
[07:42:55] <cmr> I've been extremely unproductive with Rust as of late :(
[07:43:03] <cmr> school can be such a drag
[07:43:22] <eddyb> cmr: you know my solution to that :P
[07:43:29] <eddyb> though not universally applicable
[07:43:41] <eddyb> doener: pffft... I removed alwaysinline from my optimizations, forgetting that it was required, and now I'm past the point where it gets inlined. *sigh*
[07:43:50] <acrichto> cmr: ugh, I need to compile on windows more often...
[07:44:02] <acrichto> we have a snapshot!
[07:44:07] <cmr> !!! \o/
[07:44:19] <cmr> I honestly thought we were past the era of painful snapshots
[07:45:12] <acrichto> we never will be
[07:45:14] <cmr> although that's not really pain compared to some of the older snapshots
[07:45:24] <acrichto> at least not as long as the snapshot builders are different from the auto builders
[07:45:31] <acrichto> it's not that bad though
[07:45:38] <cmr> that month or so where we didn't have a single snapshot was awful :\
[07:45:40] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[07:45:50] <acrichto> I do remember that...
[07:46:25] <acrichto> oh wow there's a lot of stage0 stuff
[07:46:37] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:47:16] <eddyb> doener: I was wrong... I ran alwaysinline before everything else, sepparately, forgetting that I need it to do something otherwise it's not BLEAH scratch all that, redo!
[07:49:03] <eddyb> doener: you must be kidding me
[07:49:16] <doener> hm?
[07:49:28] <doener> what did I do?
[07:49:32] <eddyb> &0u8 works, &(0u8,) doesn't
[07:49:40] <eddyb> it's a structural issue >_>
[07:49:54] <eddyb> I fixed one of these stupid things as my first LLVM patch. in that case, it was a return value
[07:50:19] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[07:50:40] <eddyb> err, no. it's a != i8 issue
[07:51:26] <dbaupp> cmr: did you get anywhere with the coverage stuff? (it was you who experimented with it, right?)
[07:52:07] <cmr> dbaupp: I didn't actually get to it yet.
[07:52:24] <dbaupp> I assume https://github.com/mozilla/rust/wiki/Note-core-team needs updating?
[07:52:30] <dbaupp> cmr: okay
[07:52:33] <dbaupp> I might try
[07:52:55] <dbaupp> it'd be cool to have 100% coverage of (certain modules) in libstd/extra
[07:53:03] <cmr> It *looks* deceivingly simple, to me.
[07:53:13] <dbaupp> (with all the caveats that come with the "100%" number, of course.)
[07:53:34] <dbaupp> some things (kcov?) can use the DWARF info, right?
[07:53:46] <cmr> uh I didn't find anything
[07:53:48] <cmr> but
[07:53:57] <cmr> see llvm/lib/Transforms/Instrumentation
[07:54:02] <cmr> and all the fun stuff in there!
[07:54:03] <eddyb> dbaupp: who's missing from the core team list?
[07:54:06] <cmr> all of it is an LLVM pass.
[07:54:11] <dbaupp> eddyb: nrc
[07:54:11] <cmr> eddyb: nrc, announced today.
[07:54:21] <eddyb> ohh, I missed that
[07:54:39] <eddyb> the API Design spot?
[07:54:40] <dbaupp> eddyb: hang out on the ML more :P
[07:54:51] <cmr> good question
[07:54:54] <cmr> nrc: what are you working on?
[07:55:25] <dbaupp> he was/is working on DXR integration
[07:55:38] <nrc> cmr: for now the 1.0 burn down, I'll take some bigger projects once I am more familiar with the code base
[07:55:45] <nrc> probably langauge/compiler stuff
[07:55:50] <cmr> cool
[07:55:55] <nrc> dbaupp: DXR is a side-project :-)
[07:56:05] <dbaupp> nrc: oh, how confusing :P
[07:56:27] <nrc> I'll continue to work on it in my spare time and maybe a little bit of Mozilla time too
[07:56:40] <dbaupp> cool
[07:56:46] <dbaupp> nrc: (add yourself to https://github.com/mozilla/rust/wiki/Note-core-team :) )
[07:57:22] <nrc> I don't have commit access yet :-(
[07:57:30] <cmr> really? jeez
[07:57:38] <cmr> you shouldn't need it for the wiki though
[07:57:45] <cmr> although
[07:57:53] <cmr> maybe you should earn your commit access, like the rest of us did ;p
[07:57:53] <nrc> oh really, cool, in which case I will
[07:58:11] <dbaupp> cmr: https://github.com/SimonKagstrom/kcov "Kcov, like Bcov, uses DWARF debugging information to make it possible to collect coverage information without special compiler switches"
[07:58:13] * dbaupp will try it
[07:58:14] <nrc> For Firefox, that is how it goes, not sure what the policy is with Rust
[07:58:25] <cmr> We don't really have a policy yet
[07:58:39] <cmr> dbaupp: that looks seriously promising
[07:58:47] <cmr> I'm tinkering with insert-gcov-profiling right now
[07:58:52] <cmr> it doesn't seem to do anything
[07:58:56] <eddyb> nrc: congrats :) - what I was wondering about is whether you fill in this spot (in which case, it should be removed from the job listing) https://careers.mozilla.org/en-US/position/o3VZWfwD
[07:59:15] <cmr> I think we might need to give some extra options to the pass
[07:59:22] <cmr> Not really sure, I haven't played with LLVM like this before
[08:00:16] <nrc> eddyb: Thanks! I am not really sure. I thought there were two open positions for Rust and I filled one. Beyond that I have no idea
[08:00:20] *** Joins: andrew-d_w (andrew-d_w@4CCE6E0C.339B431B.1E537B93.IP)
[08:00:26] *** Quits: andrew-d_w (andrew-d_w@4CCE6E0C.339B431B.1E537B93.IP) (Input/output error)
[08:00:27] <cmr> dbaupp: kcov looks sweet
[08:00:45] <eddyb> nrc: two? pretty sure there was only one listed. hmm
[08:00:48] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[08:01:09] <dbaupp> cmr: it works! \o/
[08:01:16] <dbaupp> although it picks up a pile of .c files
[08:01:22] <cmr> dbaupp: insert-gcov-profiling definitely doesn't!
[08:01:25] * dbaupp uploads the output
[08:01:29] <cmr> (with just --passes)
[08:01:36] <nrc> eddyb: I could be wrong
[08:02:50] <cmr> ohhhhh it looks like asan works though
[08:03:21] <dbaupp> cmr: http://www.ug.it.usyd.edu.au/~hwil7821/rust/kcov/
[08:03:34] <cmr> 16.6%? miserable.
[08:03:41] <dbaupp> just fn main() { println!("hello world") }
[08:03:56] <dbaupp> look at all the junk it's measuring though
[08:04:09] <eddyb> dbaupp: use libnative
[08:04:47] <eddyb> what is this coverage stuff?
[08:04:48] <cmr> jeez
[08:04:56] <cmr> it's actually really cool that it's seeing into libuv
[08:05:10] <cmr> this could be a very useful tool
[08:05:14] <cmr> dbaupp: ML post!
[08:05:19] * dbaupp tries libstd
[08:05:26] <Diamond> is there anyway to reuse a stage1 build?
[08:05:37] <eddyb> Diamond: for?
[08:05:47] <Diamond> target specific changes
[08:05:53] <Diamond> rustc
[08:06:00] <Diamond> well libstd.
[08:06:01] <dbaupp> Diamond: NO_REBUILD=1 if you're just running test in libstd
[08:06:04] <cmr> Anyone know what I need to link to to get asan symbols?
[08:06:11] <dbaupp> (i.e. `make check-stage1-std NO_REBUILD=1`)
[08:06:14] <cmr> Also, how can I search for symbols without grepping nm...
[08:06:21] *** nrc is now known as nrc|afk
[08:06:22] <dbaupp> cmr: clang's compiler-rt?
[08:06:23] <Diamond> thanks
[08:06:33] <cmr> dbaupp: is that all it's in? ok
[08:06:35] <dbaupp> Diamond: NO_BENCH=1 is nice too
[08:06:38] <dbaupp> cmr: no idea
[08:06:59] <dbaupp> cmr: check the rust issue about it, I vaguely remember strcat saying something about it
[08:08:53] <cmr> bhrm
[08:09:09] <cmr> clang -fsanitize=address links to /usr/bin/../lib/clang/3.4/lib/linux/libclang_rt.asan-x86_64.a
[08:09:18] <cmr> can't hurt to try!
[08:09:42] <cmr> !!!
[08:09:45] <cmr> rust with asan achieved
[08:10:00] <cmr> rustc --passes asan,asan-module --link-args "/usr/bin/../lib/clang/3.4/lib/linux/libclang_rt.asan-x86_64.a" foo.rs
[08:10:01] <Diamond> well I can't actually run tests for the target I'm adding without preforming some back-flips to do so. And I still need to figure out how to do the back-flip (it's PNaCl).
[08:10:12] <cmr> Diamond: ohhh sweet!
[08:10:41] <dbaupp> cmr: also, I just updated that example link to include the annotated files, for some reason they didn't get uploaded originally
[08:10:46] <dbaupp> (e.g. http://www.ug.it.usyd.edu.au/~hwil7821/rust/kcov/hello-world/hello-world.rs.0.html )
[08:11:03] <Diamond> but it would be nice to not have to rebuild stage0-1 just for a typo that doesn't appear until stage2
[08:11:12] <cmr> Diamond: yeah, it's quite unfortunate :(
[08:11:25] <cmr> A necessary pain when doing compiler dev
[08:11:31] <cmr> You can do a make VERBOSE=1
[08:11:34] <cmr> and copy the line it runs
[08:12:16] <dbaupp> cmr: that asan stuff works?
[08:12:34] <cmr> dbaupp: yup
[08:12:40] <Diamond> when I was actively writing LLVM passes, it was WAAAAAAYY worse of a problem. Until I realized I'm an idiot and can use opt on the no-opt bytecode rustc so kindly outputs.
[08:12:43] <dbaupp> cmr: (e.g. does *ptr::null() trigger it?)
[08:12:57] <dbaupp> or whatever it's meant to pick up
[08:13:40] <cmr> hm
[08:14:11] <cmr> oh
[08:14:15] <cmr> that'd be msan I think...
[08:14:28] <cmr> wait waaaat
[08:14:38] <cmr> rusti: unsafe { *std::ptr::null() }
[08:14:43] -rusti- pastebinned 8 lines of output: http://ix.io/aaw
[08:14:48] <cmr> rusti: unsafe { *std::ptr::null() } 42
[08:14:52] -rusti- 42
[08:14:54] <cmr> why
[08:15:05] <cmr> srsly wut
[08:15:08] <dbaupp> undefined behaviour
[08:15:11] <dbaupp> LLVM can just kill it
[08:15:11] <cmr> yeah but still :(
[08:15:20] <acrichto> rusti: unsafe { *std::ptr::null::<int>() }
[08:15:22] -rusti- 0
[08:15:28] <dbaupp> lulz
[08:15:29] <cmr> hahah
[08:15:40] <cmr> there's a joke in the cslabs that the dereference of a null pointer is Chris
[08:15:45] <cmr> (he writes some seriously crazy C)
[08:15:48] <dbaupp> cmr: how about `let p = malloc(); free(p); free(p);`
[08:16:05] <dbaupp> rusti: unsafe { *std::ptr::null::<&str>() }
[08:16:06] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[08:16:15] * cmr does both
[08:17:09] <dbaupp> (that segfault is presumably from trying to print the string, not the null derefence)
[08:17:28] <cmr> hm
[08:17:43] <cmr> derp
[08:17:50] <cmr> -S is a surefire way to not get the expected output
[08:17:54] <cmr> asan working beautifully
[08:18:02] <cmr> stacktraces etc
[08:18:36] <dbaupp> can we just use that for failure backtraces?
[08:18:44] <cmr> asan? ;p
[08:18:50] <dbaupp> just trigger a out-of-bounds memory access
[08:18:52] <dbaupp> bam, backtrace
[08:19:02] <dbaupp> although... I guess that takes down the whole process
[08:19:07] <cmr> yeah...
[08:19:08] <dbaupp> hm, back to the drawing board :P
[08:19:24] <cmr> if we could hook into its stack tracer that'd be nice
[08:19:38] <cmr> https://gist.github.com/cmr/689de982aad0c6765395
[08:19:47] <cmr> looks like it does demangling and works with static linking too
[08:19:54] <eddyb> doener: this smells of LLVM bug:   %1 = load void (i8*)** bitcast ({ void (i16*)* }* @vtable to void (i8*)**), align 8
[08:20:00] <dbaupp> cmr: awesome
[08:20:04] * cmr loves non-stripped binaries
[08:20:15] <dbaupp> cmr: why's that backtracing from pthread_create?
[08:20:36] <cmr> dbaupp: it's thread two
[08:20:40] *** Joins: sokomo (sokomo@8293D4FC.93FF164A.408809BB.IP)
[08:20:44] <cmr> libgreen
[08:21:36] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:21:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14539ba67 to 14e99fe7e: 02http://git.io/N3iJvQ
[08:21:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:21:37] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:21:37] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0wspWA
[08:21:37] <ghrust> 13rust/06auto 142ef42a6 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[08:21:37] <ghrust> 13rust/06auto 144d1e7b5 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[08:21:38] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:22:48] *** Quits: dbaupp (Thunderbir@moz-25BBAF91.lns20.syd6.internode.on.net) (Ping timeout)
[08:26:11] *** Joins: dbaupp (Thunderbir@moz-25BBAF91.lns20.syd6.internode.on.net)
[08:26:44] <dbaupp> eddyb: using libnative means that no code from libuv is executed... but all the files are still listed :(
[08:27:21] <eddyb> dbaupp: with #[no_uv]?
[08:27:28] <dbaupp> eddyb: oh, forgot that
[08:27:45] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:27:55] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:28:07] <dbaupp> eddyb: it works!
[08:28:07] <eddyb> coverage just means "percentage of code executed while running this program" or what?
[08:28:08] <dbaupp> much nicer
[08:28:17] <dbaupp> percentage of lines executed, yeah
[08:28:20] <eddyb> you're welcome :P
[08:28:35] <dbaupp> although rust_builtin.c is still there and has 0% coverage
[08:28:41] <dbaupp> which is nice
[08:28:50] <eddyb> doener: okay, so I found a LLVM bug, but it's not the cause of my issue
[08:28:58] <cmr> expcov looks like it has expression coverage
[08:29:00] <cmr> which is cool
[08:29:03] <cmr> but it's not free
[08:29:07] <cmr> and it only works with clang ;(
[08:29:30] <dbaupp> cmr: not LLVM?
[08:29:40] <doener> eddyb: *sigh*
[08:29:41] <cmr> yeah
[08:29:43] <cmr> much unfortunate
[08:29:49] <cmr> I contacted the author about it
[08:30:01] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Input/output error)
[08:32:33] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[08:42:57] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:43:05] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:44:48] *** Quits: sokomo (sokomo@8293D4FC.93FF164A.408809BB.IP) (Quit: Read error: Connection reset by peer)
[08:45:47] *** Joins: sokomo (sokomo@8293D4FC.93FF164A.408809BB.IP)
[08:46:03] <cmr> https://mail.mozilla.org/pipermail/rust-dev/2014-February/008521.html
[08:51:26] <flaper87> cmr: +1
[08:51:36] <flaper87> thanks for experimenting with that
[08:52:45] <eddyb> doener: [10:46] <nicholas> whoa. this FoldReinterpretLoadFromConstPtr looks like it took a bad refactoring to the knee ....
[08:53:01] <eddyb> doener: I think strcat might've hit this some time ago
[08:53:09] <eddyb> (the unrelated LLVM bug)
[08:53:17] *** Joins: gimpf (gimpf@moz-2EECDFD6.adsl.highway.telekom.at)
[08:53:21] <eddyb> [10:53] <nicholas> eddyb: it's certainly broken.
[08:53:26] <cmr> hah
[08:53:34] <cmr> that's the first time I've seen that phrase used like that
[08:53:42] <cmr> very humor, much hilar
[08:53:57] * cmr very sleep, much bed. zzz
[09:11:37] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:11:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144d1e7b5 to 14e99fe7e: 02http://git.io/N3iJvQ
[09:11:37] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:11:39] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[09:11:39] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/FoFLig
[09:11:39] <ghrust> 13rust/06auto 148658a43 15Richard Diamond: Allow SIMD types in generics. Closes #10604
[09:11:39] <ghrust> 13rust/06auto 1463ba2e1 15Richard Diamond: Simd feature gating + Win32/64 fixes.
[09:11:39] <ghrust> 13rust/06auto 147becc0f 15Richard Diamond: Added missing xfail-fast.
[09:11:42] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[09:27:36] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[09:44:01] *** Joins: rca (rcatolino@moz-314B78.adsl.proxad.net)
[09:47:36] *** Quits: nrc|afk (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:05:09] *** Quits: zv (zv@moz-955F83E9.hsd1.ca.comcast.net) (Ping timeout)
[10:05:09] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[10:05:09] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[10:05:09] *** Quits: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca) (Ping timeout)
[10:05:09] *** Quits: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP) (Ping timeout)
[10:05:09] *** Quits: benh (ben@moz-4A0366D2.org) (Ping timeout)
[10:05:09] *** Quits: friggle (friggle@moz-A607EAFA.members.linode.com) (Ping timeout)
[10:05:09] *** Quits: xales (xales@moz-7DEA692E.forevernothing.com) (Ping timeout)
[10:05:09] *** Quits: cyndis (cyndis@moz-C4357EA7.kapsi.fi) (Ping timeout)
[10:05:09] *** Quits: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw) (Ping timeout)
[10:05:09] *** Quits: Kxepal (Miranda@moz-94E27C3F.pppoe.mtu-net.ru) (Ping timeout)
[10:05:09] *** Quits: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com) (Ping timeout)
[10:05:09] *** Quits: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[10:05:09] *** Quits: Yurume (Yurume@A826BD81.8A0DEF81.38747683.IP) (Ping timeout)
[10:05:09] *** Quits: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com) (Ping timeout)
[10:05:09] *** Quits: madmoose (Hat@moz-E1973371.nerp.net) (Ping timeout)
[10:05:09] *** Quits: angdev (uid7041@moz-E77DEB21.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: jld (jld@moz-B94C75AD.xlerb.net) (Ping timeout)
[10:05:09] *** Quits: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP) (Ping timeout)
[10:05:09] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[10:05:09] *** Quits: shachaf (shachaf@moz-F37E0395.members.linode.com) (Ping timeout)
[10:05:09] *** Quits: Eridius (kevin@moz-533B0DB4.us) (Ping timeout)
[10:05:09] *** Quits: larsberg (sid16141@moz-A42E5B7B.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: geomyidae_ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: wycats (sid79@moz-5F4AA75A.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP) (Ping timeout)
[10:05:09] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[10:05:09] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[10:05:09] *** Quits: jack (sid19593@moz-A42E5B7B.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com) (Ping timeout)
[10:05:09] *** Quits: gifnksm (gifnksm@moz-2EC7BA37.szoknt01.ap.so-net.ne.jp) (Ping timeout)
[10:05:09] *** Quits: dbaupp (Thunderbir@moz-25BBAF91.lns20.syd6.internode.on.net) (Ping timeout)
[10:05:09] *** Quits: sfackler (sfackler@moz-AEECCEBA.com) (Ping timeout)
[10:05:09] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[10:05:09] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[10:05:09] *** Quits: steveklabnik (uid17044@moz-A42E5B7B.irccloud.com) (Ping timeout)
[10:26:32] *** Joins: cmr (moznet@moz-EC676DFE.members.linode.com)
[10:26:32] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[10:26:34] *** Joins: friggle (friggle@moz-A607EAFA.members.linode.com)
[10:26:35] *** Joins: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP)
[10:26:37] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[10:26:39] *** Joins: angdev (uid7041@moz-E77DEB21.irccloud.com)
[10:26:41] *** Joins: bstrie_iro_Days (ben@moz-D5A1D0F5.members.linode.com)
[10:26:43] *** Joins: mrmonday (mrmonday@moz-C7DC1A73.lin.openzula.org)
[10:26:43] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[10:26:44] *** Joins: wycats (sid79@moz-5F4AA75A.irccloud.com)
[10:26:45] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[10:26:47] *** Joins: blaze (blaze@moz-9B9AB2F0.dhcp.inet.fi)
[10:26:50] *** Joins: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk)
[10:26:50] *** Joins: zz_kimundi (kimundi@moz-68679156.dip0.t-ipconnect.de)
[10:26:56] *** Joins: sfackler (sfackler@moz-AEECCEBA.com)
[10:26:59] *** zz_kimundi is now known as kimundi
[10:27:06] *** Joins: Yurume (Yurume@A826BD81.8A0DEF81.38747683.IP)
[10:27:18] *** Joins: km (quassel@moz-777F24DE.kevinmehall.com)
[10:27:22] *** Joins: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com)
[10:27:29] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[10:27:50] <eddyb> dbaupp, doener: I'm getting somewhere :D
[10:27:57] *** Quits: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com) (Client exited)
[10:28:03] *** Joins: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com)
[10:28:18] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[10:28:34] <dbaupp> eddyb: \o/
[10:28:44] <eddyb> aaaand I don't need devirtualization o_O
[10:28:53] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:29:10] *** Joins: madmoose (Hat@73F3A637.B23483B.7BA20D97.IP)
[10:29:11] *** Joins: cyndis (cyndis@moz-C4357EA7.kapsi.fi)
[10:29:22] <eddyb> crap, I broke it :/
[10:29:31] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[10:29:49] *** Joins: nate (pinkeh@moz-A3C418FF.hcs.harvard.edu)
[10:30:01] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[10:30:09] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[10:30:09] *** ChanServ sets mode: +o acrichto
[10:30:09] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[10:30:09] *** Joins: larsberg (sid16141@moz-A42E5B7B.irccloud.com)
[10:30:32] <eddyb> no, it just has one less escape hatch
[10:31:25] *** Joins: nmatsakis (nmatsakis@moz-DB4A9C19.scl3.mozilla.com)
[10:31:25] *** ChanServ sets mode: +ao nmatsakis nmatsakis
[10:31:37] *** Joins: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP)
[10:31:50] <eddyb> doener: just -always-inline -instcombine now
[10:31:52] *** Joins: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com)
[10:31:53] *** Joins: zv (zv@moz-955F83E9.hsd1.ca.comcast.net)
[10:32:12] *** Joins: xales (xales@moz-7DEA692E.forevernothing.com)
[10:32:26] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[10:32:55] <flaper87> eddyb: what are you working on now? :D
[10:32:56] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[10:32:59] * flaper87 is always curious :D
[10:33:20] <eddyb> flaper87: finding a LLVM bug related to devirtualization
[10:33:49] <flaper87> eddyb: ooooook, I'll keep reading your progress on IRC :D
[10:35:09] *** Joins: geomyidae_ (uid214@moz-E77DEB21.irccloud.com)
[10:36:37] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[10:36:39] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[10:40:07] *** Joins: sokomo (sokomo@8293D4FC.93FF164A.408809BB.IP)
[10:41:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:41:38] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/FoFLig
[10:41:38] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[10:43:44] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[10:44:16] <flaper87> dbaupp: re the extern crate patch. I thought about getting rid of some of the obsolete messages. I removed 2 of them but I had some doubts about the ABI syntax error. After reading your comment, I think we should remove it too.
[10:45:20] <eddyb> doener: updated: https://gist.github.com/eddyb/5705c1dd292e58ccd210#file-bad-ll vs https://gist.github.com/eddyb/5705c1dd292e58ccd210#file-good-ll
[10:46:34] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:46:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pqTndg
[10:46:35] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:46:35] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[10:46:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/nOGrSA
[10:46:35] <ghrust> 13rust/06auto 14080a968 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[10:46:35] <ghrust> 13rust/06auto 148575671 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[10:46:36] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:01:03] *** Quits: rca (rcatolino@moz-314B78.adsl.proxad.net) (Ping timeout)
[11:11:27] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[11:12:39] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Input/output error)
[11:14:36] <eddyb> dbaupp: r? nit fixed https://github.com/mozilla/rust/pull/12014
[11:21:17] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[11:22:34] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Input/output error)
[11:23:50] *** Quits: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk) (Quit: Ex-Chat)
[11:30:06] *** Quits: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com) (Client exited)
[11:43:28] *** Joins: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com)
[11:44:22] *** Joins: rca (rcatolino@moz-314B78.adsl.proxad.net)
[11:52:55] *** Joins: Kxepal (Miranda@moz-94E27C3F.pppoe.mtu-net.ru)
[12:18:50] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[12:19:40] *** Joins: jensnockert (jensnocker@moz-AB60F11D.wireless.lu.se)
[12:23:29] <eddyb> omg I blindly replaced @T with &T in typeck::infer with 0 previous experience of that code and it worked :D
[12:26:40] <doener> eddyb: wtf? removing a call from the branch that is not taken makes a difference?!
[12:27:03] <eddyb> doener: jump threading doesn't run
[12:27:17] <eddyb> so you can actually branch on a constant false value
[12:27:50] <doener> but @foo is marked alwaysinline, yet it isn't inlined
[12:28:18] *** Quits: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[12:29:04] <eddyb> doener: the difference in the "good" case is that a rerun is triggered
[12:29:17] <eddyb> I just can't see why it isn't triggered in the "bad" case
[12:31:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:31:38] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/RjFw8Q
[12:31:38] <ghrust> 13rust/06auto 1465f3578 15David Manescu: Rename reserve to reserve_exact and reserve_at_least to reserve...
[12:31:38] <ghrust> 13rust/06auto 14cdc6789 15bors: auto merge of #11951 : dmanescu/rust/reserve-rename, r=huonw...
[12:31:38] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:33:53] <eddyb> rusti: pub struct NoAnn; &NoAnn
[12:33:54] -rusti- <anon>:10:9: 10:26 error: visibility has no effect inside functions
[12:33:54] -rusti- <anon>:10         pub struct NoAnn; &NoAnn
[12:33:55] -rusti-                   ^~~~~~~~~~~~~~~~~
[12:33:55] -rusti- error: aborting due to previous error
[12:33:55] -rusti- application terminated with error code 101
[12:34:05] <eddyb> rusti: struct NoAnn; &NoAnn
[12:34:07] -rusti- &main::NoAnn
[12:34:13] <eddyb> so that's a static?
[12:35:22] *** Joins: jack (sid19593@moz-A42E5B7B.irccloud.com)
[12:40:52] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[12:43:22] *** Quits: jensnockert (jensnocker@moz-AB60F11D.wireless.lu.se) (Connection reset by peer)
[12:43:42] *** Joins: jensnockert (jensnocker@moz-C6FC9FF5.wireless.lu.se)
[12:50:50] *** Quits: jensnockert (jensnocker@moz-C6FC9FF5.wireless.lu.se) (Input/output error)
[12:51:07] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Quit: Leaving)
[12:56:15] *** blaze is now known as Blaze-
[13:00:44] *** Joins: gwty (gwtypc@1B95AFF8.4A426DC1.B29E8538.IP)
[13:03:04] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[13:05:00] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[13:09:20] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[13:16:17] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[13:20:22] *** Quits: gimpf (gimpf@moz-2EECDFD6.adsl.highway.telekom.at) (Client exited)
[13:20:34] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[13:22:35] *** Joins: gifnksm (gifnksm@moz-2EC7BA37.szoknt01.ap.so-net.ne.jp)
[13:22:40] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[13:25:21] *** bstrie_iro_Days is now known as bstrie
[13:27:32] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[13:29:21] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[13:35:28] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[13:38:56] *** Joins: zimbabao (rajaram@8A4BB8B4.FEB68FB8.D2D1FAF0.IP)
[13:39:09] *** Quits: zimbabao (rajaram@8A4BB8B4.FEB68FB8.D2D1FAF0.IP) (Connection reset by peer)
[13:41:48] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:41:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/RjFw8Q
[13:41:48] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:46:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:46:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3mOhlw
[13:46:32] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:46:59] *** Joins: jsonnull (Thunderbir@26F61E6.CFD9471D.494A0F8B.IP)
[13:47:00] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[13:48:32] <dbaupp> rusti: version
[13:48:34] -rusti- "rustc 0.10-pre (4cd555d 2014-01-24 03:28:15 -0500)"
[13:48:45] <dbaupp> eddyb: it's not any more; rusti is too old
[13:49:32] <eddyb> I'll make a static then, meh
[13:54:00] *** Joins: jensnockert (jensnocker@moz-8620B324.wireless.lu.se)
[13:54:59] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:55:44] *** Joins: zimbabao (rajaram@8A4BB8B4.FEB68FB8.D2D1FAF0.IP)
[13:57:50] *** Quits: japaric (japaric@DA9B0B44.F596884F.F29ED47E.IP) (Ping timeout)
[14:01:01] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:01:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:01:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14180f4aa to 14cdc6789: 02http://git.io/N3iJvQ
[14:01:36] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:01:39] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[14:01:39] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/bWUJgA
[14:01:39] <ghrust> 13rust/06auto 145818f13 15Alex Crichton: Adding tests for closed issues...
[14:01:39] <ghrust> 13rust/06auto 1498d5090 15Alex Crichton: Make cfail test error messages more precise...
[14:01:40] <ghrust> 13rust/06auto 14a9db04f 15Alex Crichton: Run all target crate tests on the windows/try bots...
[14:01:42] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[14:07:56] *** Quits: gwty (gwtypc@1B95AFF8.4A426DC1.B29E8538.IP) (Ping timeout)
[14:15:17] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:15:56] <eddyb> MRAny(@AnyMacro) with an AnyMacro only implemented by ParserAnyMacro in tt::macro_rules
[14:16:17] <eddyb> dbaupp: should I remove the indirection?
[14:18:10] *** Quits: jensnockert (jensnocker@moz-8620B324.wireless.lu.se) (Input/output error)
[14:18:39] *** Joins: jensnockert (jensnocker@moz-8620B324.wireless.lu.se)
[14:19:07] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[14:20:30] *** Quits: jensnockert (jensnocker@moz-8620B324.wireless.lu.se) (Ping timeout)
[14:23:17] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:23:17] *** ChanServ sets mode: +ao dherman dherman
[14:31:37] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[14:31:37] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/TSiOdA
[14:31:37] <ghrust> 13rust/06auto 146c41192 15Alex Crichton: Register new snapshots
[14:31:37] <ghrust> 13rust/06auto 14ef53b7a 15bors: auto merge of #12026 : alexcrichton/rust/snapshots, r=cmr
[14:31:37] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:31:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:31:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144096faf to 14cdc6789: 02http://git.io/N3iJvQ
[14:31:38] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:33:07] <eddyb> acrichto: troubles :(?
[14:33:32] *** Joins: jensnockert (jensnocker@moz-8620B324.wireless.lu.se)
[14:36:58] *** Quits: jensnockert (jensnocker@moz-8620B324.wireless.lu.se) (Input/output error)
[14:39:55] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:42:42] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:51:17] <eddyb> hang on a second... turns out every token read ever goes through a virtual call on a trait object
[14:52:09] <eddyb> I wonder how much faster it would be if Parser were generic instead. though it could be an intentional decision, given how big Parser is
[15:01:37] <doener> eddyb: looks like the counting in RefreshCallGraph is "broken" (like the comment already suggests)
[15:01:54] <doener> eddyb: if I duplicate the indirect call in bad.ll, it gets optimized just fine
[15:02:36] <eddyb> LOL?
[15:03:00] <eddyb> doener: thank you for your work on this :D
[15:03:14] <doener> you did most of it
[15:03:15] <eddyb> sounds like a serious issue, wonder why it hasn't been fixed yet
[15:04:22] <eddyb> doener: if you have everything you need, feel free to attempt a fix. I'm currently fiddling with something else
[15:05:04] <doener> I'll probably try once I get home
[15:05:31] *** Joins: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com)
[15:17:07] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:18:19] *** Quits: zimbabao (rajaram@8A4BB8B4.FEB68FB8.D2D1FAF0.IP) (Ping timeout)
[15:22:17] <erickt> nmatsakis: ping
[15:22:39] <nmatsakis> erickt: pong
[15:22:44] <erickt> good morning!
[15:23:45] <erickt> I had a question if you have a moment. I ran into a "unconstrained type" error that I'm not sure is correct: https://gist.github.com/erickt/8805705
[15:24:47] <erickt> nmatsakis: do you happen to know if it's something I'm doing wrong? If not, I'll file a bug report about it
[15:24:49] <nmatsakis> erickt: I imagine the parameter H is unconstrianed
[15:25:28] <erickt> nmatsakis: it's not constrained by the impl on line 20?
[15:31:30] <erickt> nmatsakis: ack it's late I need to run. I ended up filing the bug. Please close if I'm doing something wrong :) https://github.com/mozilla/rust/issues/12028
[15:32:22] <nmatsakis> erickt: ok
[15:33:42] <eddyb> nmatsakis: nobody actually gave me an r+ on https://github.com/mozilla/rust/pull/12014 :/
[15:33:55] *** Joins: zimbabao (rajaram@AB819C17.5B6EDC44.D2D1FAF0.IP)
[15:37:50] <eddyb> / replace all contexts in a given expr with the given mark. Used for capturing macros
[15:37:56] <eddyb> this function isn't even called!
[15:38:44] <eddyb> can I remove dead code?
[15:40:28] <eddyb> @self isn't enough, @Trait is going down as well
[15:40:33] <nmatsakis> eddyb: one sec, lemme look
[15:40:42] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[15:40:46] <nmatsakis> oh, I see cmr r+'d it
[15:41:05] <eddyb> cmr: good morning and thanks :)
[15:41:12] <cmr> eddyb: good morning and np
[15:41:23] <eddyb> cmr: were you asleep while me and doener found two LLVM bugs?
[15:41:31] <cmr> yes
[15:42:19] <eddyb> can I remove syntax::ext features used only in tests?
[15:42:24] <eddyb> that is, libsyntax tests
[15:43:02] <cmr> eddyb: probably, but jclements or pauls should review.
[15:43:59] <doener> eddyb: I guess I see what's the problem
[15:44:12] <doener> eddyb: the requirement is that we get _more_ direct calls and _less_ indirect calls
[15:44:21] <eddyb> hahahaha
[15:44:32] <eddyb> +1-1 => 0
[15:44:34] <doener> eddyb: but since the call to the empty @bar function is removed, the number of direct calls doesn't change
[15:44:36] <doener> rigth
[15:45:09] <eddyb> who thought that was smart? I mean, it probably is, but not in that form
[15:46:01] *** Joins: gwty (gwtypc@3DBB567C.D38441B7.553D87E5.IP)
[15:46:58] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[15:46:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/TSiOdA
[15:46:58] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:51:53] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[15:51:53] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ayYMSg
[15:51:53] <ghrust> 13rust/06auto 1439bcdba 15Eduard Burtescu: Don't copy arguments passed by value with indirection to allocas.
[15:51:53] <ghrust> 13rust/06auto 146eb8800 15bors: auto merge of #12014 : eddyb/rust/less-copies, r=cmr
[15:51:53] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[15:52:21] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[15:52:56] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[15:54:43] <cmr> http://www.reddit.com/r/rust/comments/1wz7ws/handling_io_errors/cf6rdln
[15:54:47] <cmr> it all makes sense now.
[15:57:21] <eddyb> the one time I forget about my chrome crashing when I drag links, it does it
[15:58:04] <eddyb> in other news, Emitter in libsyntax::diagnostic is only implemented by DefaultEmitter... do we really need to have it as a trait object?
[15:58:16] *** Joins: japaric (japaric@DA9B0B44.F596884F.F29ED47E.IP)
[15:58:29] <cmr> eddyb: if you want to keep your sanity, don't touch diagnostics.
[15:58:47] <eddyb> but I want to remove the last libsyntax trait used like @Trait!
[15:59:00] <eddyb> it's actually one of the few @Trait's left *in the entire codebase*
[15:59:02] <cmr> sure, sure.
[15:59:07] <cmr> just... don't go too crazy
[15:59:11] <cmr> or you'll go crazy
[15:59:21] <eddyb> I just want to know if we really need it
[15:59:24] <cmr> we don't
[15:59:35] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[15:59:46] <eddyb> I guess we can always put it back if a libsyntax consumer starts needing it. maybe as a type param (with a default!)
[16:00:02] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[16:01:48] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[16:04:14] *** Quits: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com) (Client exited)
[16:05:29] *** Joins: steveklabnik (uid17044@moz-A42E5B7B.irccloud.com)
[16:06:52] *** Joins: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com)
[16:07:39] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[16:10:28] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[16:17:51] <olsonjeffery> i am having a lot of fun detangling the web of dependencies arising from the balkinization of extra
[16:18:59] <olsonjeffery> mostly this is do to age old adage of 'they who land first, win'
[16:19:09] <olsonjeffery> blessed are the meek, for they shall handle the merge conflicts
[16:23:07] *** Quits: sokomo (sokomo@8293D4FC.93FF164A.408809BB.IP) (Quit: Read error: Connection reset by peer)
[16:24:51] *** Joins: sunfish (chatzilla@moz-8DE7F965.dsl.dynamic.sonic.net)
[16:28:29] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:28:45] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[16:32:28] <cmr> bahahah
[16:34:32] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[16:34:32] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14f174586 to 14ef14f91: 02http://git.io/k471pw
[16:34:32] <ghrust> 13rust/06try 14ef14f91 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[16:34:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[16:34:40] *** Quits: luz (lucy@moz-CD18B14B.customer.cdi.no) (Input/output error)
[16:34:49] *** Joins: luz (lucy@moz-CD18B14B.customer.cdi.no)
[16:35:18] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[16:37:55] *** Quits: larsberg (sid16141@moz-A42E5B7B.irccloud.com) (Quit: )
[16:39:27] <olsonjeffery> due*
[16:41:31] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[16:41:31] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146eb8800 to 14ef53b7a: 02http://git.io/N3iJvQ
[16:41:31] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[16:41:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:41:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/I4I0BA
[16:41:34] <ghrust> 13rust/06auto 14444aaf4 15JeremyLetang: move concurrent stuff from libextra to libsync
[16:41:34] <ghrust> 13rust/06auto 140d99292 15bors: auto merge of #11939 : JeremyLetang/rust/move-libsync, r=alexcrichton...
[16:41:34] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:46:26] *** Quits: Kxepal (Miranda@moz-94E27C3F.pppoe.mtu-net.ru) (Connection reset by peer)
[16:49:11] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:49:11] *** ChanServ sets mode: +ao dherman dherman
[16:50:09] *** Joins: Kxepal (Miranda@moz-6CFAB9DE.pppoe.mtu-net.ru)
[16:52:17] *** Joins: andrew-d_w (andrew-d_w@moz-A790E83C.nat.bb.dnainternet.fi)
[16:54:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[16:57:57] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[16:58:18] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[16:59:59] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[17:01:53] *** Quits: andrew-d_w (andrew-d_w@moz-A790E83C.nat.bb.dnainternet.fi) (Ping timeout)
[17:03:14] <flaper87> olsonjeffery: loool
[17:10:42] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[17:10:43] *** Quits: gwty (gwtypc@3DBB567C.D38441B7.553D87E5.IP) (Connection reset by peer)
[17:11:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[17:11:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140d99292 to 14ef53b7a: 02http://git.io/N3iJvQ
[17:11:35] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[17:12:44] *** Quits: zimbabao (rajaram@AB819C17.5B6EDC44.D2D1FAF0.IP) (Ping timeout)
[17:14:42] <eddyb> cmr: I found why we were copying trait objects: // Convert a @Object, ~Object, or &Object pair into an &Object pair.
[17:21:13] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[17:21:46] <doener> eddyb: hm, part of the problem is that transformConstExprCastCall in instcombine actually erases the old call and insert a new one
[17:22:34] <doener> eddyb: if it wouldn't do that, then refreshCallGraph (or whatever it is called) could actually detect the devirtualization
[17:22:47] *** Quits: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com) (Client exited)
[17:22:53] *** Joins: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com)
[17:23:33] <eddyb> doener: can't instcombine set a "devirtualized call" flag somewhere?
[17:23:44] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[17:23:48] <eddyb> doener: SCC actually passes a bool& to a few functions exactly for this
[17:24:10] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[17:24:37] *** Quits: sigma (sigma@moz-B2E77065.range86-184.btcentralplus.com) (Client exited)
[17:24:46] <doener> eddyb: isntcombine doesn't run via runOnSCC, but needs an intermediate FunctionPassManager. So I guess, no
[17:24:58] <eddyb> riight :(
[17:25:11] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[17:25:35] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[17:25:39] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:27:01] *** Joins: c74d (c74d@moz-E2EAC718.oc.oc.cox.net)
[17:27:28] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[17:28:06] *** Joins: zimbabao (rajaram@ED6E1952.3009F76A.D2D1FAF0.IP)
[17:29:34] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:29:34] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14f2448e4 to 1412931c5: 02http://git.io/k471pw
[17:29:34] <ghrust> 13rust/06try 1412931c5 15Alex Crichton: Invoke gcc with -nodefaultlibs...
[17:29:34] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:30:57] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[17:31:00] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[17:31:46] *** Quits: zimbabao (rajaram@ED6E1952.3009F76A.D2D1FAF0.IP) (Ping timeout)
[17:32:24] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:35:28] <eddyb> cmr: I may have to implement Deref myself soon, @ are dropping like flies
[17:35:42] <cmr> eddyb: are you removing @ !?
[17:35:57] <eddyb> not yet. will have to change @T to P<T> in the AST
[17:36:26] *** Joins: notmatt (notmatt@CC62CF7E.1E7FDFDB.A82DBDDB.IP)
[17:37:00] <cmr> âŽˆ
[17:37:03] <cmr> oops
[17:39:02] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:39:47] *** Joins: gwty (gwtypc@3DBB567C.D38441B7.553D87E5.IP)
[17:42:10] *** Joins: nrc|afk (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[17:42:18] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[17:42:24] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[17:48:32] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:52:00] <doener> eddyb: no idea what I broke so far, but a first hack at least lets the devirtualization detection work
[17:52:15] <eddyb> doener: sweet :D
[17:52:24] <doener> eddyb: hack == update the call inst, instead of replacing it
[17:52:57] <eddyb> update sounds saner than replacing
[17:53:23] <doener> it's a bit tricky
[17:53:45] <doener> you might need to add a cast for the return value, which means you must update all users, which now include the cast
[18:02:04] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:02:05] *** ChanServ sets mode: +qo brson brson
[18:03:48] *** Quits: sunfish (chatzilla@moz-8DE7F965.dsl.dynamic.sonic.net) (Client exited)
[18:03:59] *** Joins: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk)
[18:04:21] *** Quits: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca) (Quit: canhtak)
[18:04:50] *** Joins: canhtak (canhtak@moz-8A625E1D.wl.t.ulaval.ca)
[18:06:33] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:06:33] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148d6e7de to 14ef53b7a: 02http://git.io/N3iJvQ
[18:06:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:06:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[18:06:33] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/fHwfNg
[18:06:33] <ghrust> 13rust/06auto 141c1defe 15Alex Crichton: Shuffle around ownership in concurrent queues...
[18:06:33] <ghrust> 13rust/06auto 14d854e62 15Alex Crichton: Rewrite channels yet again for upgradeability...
[18:06:34] <ghrust> 13rust/06auto 14d35ae08 15bors: auto merge of #11578 : alexcrichton/rust/chan-changes, r=brson...
[18:06:36] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[18:09:59] *** Joins: sunfish (chatzilla@moz-8DE7F965.dsl.dynamic.sonic.net)
[18:20:01] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[18:38:32] *** Quits: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk) (Quit: Ex-Chat)
[18:42:56] <eddyb> oops...     [debug-info] debug-info/by-value-non-immediate-argument.rs
[18:46:58] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[18:46:58] *** Quits: gwty (gwtypc@3DBB567C.D38441B7.553D87E5.IP) (Ping timeout)
[18:49:00] *** Joins: gwty (gwtypc@CD7F90EE.DDD319A2.137C914F.IP)
[18:50:37] <bstrie> acrichto: reading the comments in mutex.rs, you mention that the compromise approach leads to "fairly decent performance". how decent?
[18:50:49] <eddyb> cmr, dbaupp: r? (I hope) I fixed the debug-info tests by disabling the optimization for -Z extra-debug-info https://github.com/mozilla/rust/pull/12014
[18:50:58] <cmr> bstrie: I think we're within 25% of pthread?
[18:51:34] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[18:51:34] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d35ae08 to 14ef53b7a: 02http://git.io/N3iJvQ
[18:51:34] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[18:51:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:51:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/iFVhsw
[18:51:35] <ghrust> 13rust/06auto 14a7658b7 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[18:51:35] <ghrust> 13rust/06auto 14a93b0fb 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[18:51:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:51:42] <bstrie> cmr: when using libnative?
[18:51:57] <cmr> bstrie: for both, iirc.
[18:52:17] <bstrie> that's not too bad
[18:52:19] <doener> meh, when the retval needs to be casted, the devirtualization detection still fails. 
[18:52:48] <cmr> bstrie: I could be remembering wrong. I didn't follow that change too too closely
[18:53:18] <yuriks> I think it was 25% on the uncontended case and slightly superior for the contended case, iirc
[18:54:15] <eddyb> cmr: better?
[18:55:04] *** Quits: rca (rcatolino@moz-314B78.adsl.proxad.net) (Ping timeout)
[18:55:04] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Client exited)
[18:55:39] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[18:56:51] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Connection reset by peer)
[18:57:08] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[18:57:57] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[18:58:30] <eddyb> we have a snapshot :D?
[18:59:30] *** Joins: rca (rcatolino@moz-BC04AA53.adsl.proxad.net)
[19:01:27] <eddyb> cmr: thanks :)
[19:02:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:04:38] <cmr> eddyb: we do!
[19:05:05] <nrc|afk> so, if I want to get a review for a patch, should I do the r? link in this channel I see people do?
[19:05:13] *** nrc|afk is now known as nrc
[19:05:35] <cmr> nrc: yeah that's usually a good way to get a review faster.
[19:05:43] <cmr> otherwise it's pinging someone or waiting for someone to go through the queue
[19:05:50] <cmr> which is... not the most reliable.
[19:06:09] <nrc> and if I want to draw peoples attention to a question in an issue, is there something to do, or should I just ask here too?
[19:06:36] <nrc> r? https://github.com/mozilla/rust/issues/3512
[19:06:39] * nrc tries
[19:06:43] <cmr> r? is for review :P
[19:06:57] <nrc> yes, that is the one I want for review for :-)
[19:06:58] <cmr> you can just ask here too though
[19:07:09] <nrc> er, no its not
[19:07:10] <cmr> no, you want a review for https://github.com/mozilla/rust/pull/12023
[19:07:15] <nrc> https://github.com/mozilla/rust/pull/12023
[19:07:30] <nrc> :-p
[19:08:54] <cmr> "// Unify pairs of polytypes."
[19:08:58] <cmr> that's a frightening comment
[19:09:31] <nrc> The question is in https://github.com/mozilla/rust/issues/4110 - question about how to deal with ambiguous 'use'
[19:10:51] <olsonjeffery> acrichto: hey im still chugging along on this serialize stuff
[19:11:03] <olsonjeffery> working through make check
[19:11:13] <olsonjeffery> lots of stuff shaking out.
[19:11:14] <nrc> cmr: thanks for the info
[19:11:25] <acrichto> olsonjeffery: yeah sorry abut all the rebase conflicts :(
[19:13:00] <olsonjeffery> it is what it is
[19:13:17] *** Joins: gimpf (gimpf@moz-9A3C6795.adsl.highway.telekom.at)
[19:13:32] <eddyb> acrichto: https://github.com/mozilla/rust/pull/12030#discussion_r9433714 do you have time to grep @ -r src/lib*?
[19:13:54] <olsonjeffery> i think ill write an email to the list about my emerging concerns about the DAG of dependencies between extra and its balkanized child libs
[19:13:57] <eddyb> since I don't really have an easy way to do it (I guess I could clone in another dir)
[19:13:58] <acrichto> eddyb: ?
[19:14:09] <eddyb> acrichto: oops, incomplete command
[19:14:12] <olsonjeffery> there doesn't seem to be a consistent rigor in enforcing the deps go only one way
[19:14:18] <eddyb> grep @ -r src/lib* | wc -l
[19:14:29] <olsonjeffery> maybe it'll get better if/when extra::test moves out. that seems to be a big part of it
[19:14:42] <eddyb> olsonjeffery: libtest? sweet :D
[19:15:03] <eddyb> acrichto: 2458 here, I'm curious what it was before
[19:15:15] <acrichto> 2983
[19:15:31] <eddyb> 525 @ removed \o/
[19:15:39] <acrichto> eddyb: this is awesome, nice work!
[19:15:47] <acrichto> so many lifetimes!
[19:15:49] <acrichto> this is so great
[19:16:21] <eddyb> acrichto: all in a few hours' work :P. I had nothing better to do, doener handled the LLVM thing better than me
[19:16:33] <eddyb> I guess I have that PNG thing I could work on
[19:19:31] *** Joins: geoffhill (geoffhill@moz-95FF7399.members.linode.com)
[19:23:45] <olsonjeffery> wow, this blows: libsyntax tests run *after* run-pass, etc
[19:23:56] <olsonjeffery> also.. do the libserialize, libuuid, etc tests get lumped into make check?
[19:24:11] <olsonjeffery> i know that make check-stage1-{uuid,serialize} works
[19:24:22] <cmr> it should be, yes.
[19:25:27] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:25:37] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[19:26:47] <nrc> git question - if I do a git rebase -i and squash commits, can I thine force push to my local branch and will the related PR do the right thing?
[19:26:54] <cmr> yes
[19:27:02] <nrc> great, thanks
[19:27:39] <eddyb> nrc: I amend with git gui. a lot
[19:28:04] <eddyb> my workflow is "add things to the commit"
[19:29:09] <nrc> I heard you shouldn't change the history on public branches - not sure if PRs count as public branches...
[19:29:19] <eddyb> they don't :P
[19:29:31] <nrc> awesome
[19:29:38] <doener> eddyb: omfg...
[19:29:42] <cmr> well
[19:29:46] <cmr> that's... not strictly true
[19:29:51] <cmr> they *are* public branches
[19:29:56] <doener> eddyb: the WeakVH should already track the call replacement...
[19:30:16] * nrc should not have expected anything git-related to be that simple
[19:30:19] <doener> eddyb: BUT... the function returns _void_, so there's no user, and no actual replacement happens
[19:30:26] <strcat1> nrc: you shouldn't alter history on the development branch or stable branches, but it's certainly the normal thing on feature branches
[19:30:31] <doener> eddyb: instead we have separate insert and erase operations
[19:30:49] <eddyb> doener: this sounds fun
[19:30:49] <doener> eddyb: change the return type to i8 and do something with it, and it all works
[19:31:00] <strcat1> nrc: ideally, your feature branch is a logical set of standalone patches, that each compile and pass the tests
[19:31:29] <strcat1> you can split or join commits together
[19:32:35] <eddyb> doener: so... how hard is to handle it properly for the insert/erase case?
[19:32:46] <nrc> strcat1: makes sense, thanks
[19:33:09] <doener> eddyb: I hope that I just need to insert a call to the code that tells the WeakVH about the "replacement"
[19:33:34] <strcat1> nrc: and if it's your own project without other developers/users, you might as well go crazy and make yourself look clever in case it ever does become public :P
[19:33:38] <eddyb> doener: right, that makes sense. I hope it works
[19:34:02] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[19:34:02] *** ChanServ sets mode: +o tjc
[19:34:26] *** strcat1 is now known as strcat
[19:34:36] * eddyb wonders if his @Trait removal makes &Trait uses not memcpy the fat pointer into an alloca. though I remember the alloca was called "trait_callee" so maybe it's not the same thing
[19:36:47] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[19:37:58] <eddyb> wait, did I ever finish the struct literal field shorthand PR?
[19:38:05] <doener> eddyb: works if there's no cast for the return value
[19:38:10] *** Quits: sunfish (chatzilla@moz-8DE7F965.dsl.dynamic.sonic.net) (Ping timeout)
[19:38:35] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[19:39:23] <doener> eddyb: I guess we can't handle the case in which the retval needs to be cast
[19:40:08] <doener> eddyb: because we would need to have the call graph nodes track the actual call, but all other WeakVH would want to track the change from call->cast inst
[19:41:21] <doener> eddyb: does that matter for rustc in practice? 
[19:41:56] <eddyb> no idea
[19:50:37] <doener> eddyb: at least the change I could make works with your original "Indirect" testcase
[19:55:19] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:55:43] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[19:56:52] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[19:56:52] *** ChanServ sets mode: +qo brson brson
[19:57:49] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[19:58:50] *** Joins: glaebhoerl (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP)
[19:59:44] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: back later)
[20:04:31] <nmatsakis> has there been any movement on a snapshot?
[20:04:42] <acrichto> nmatsakis: one just landed this morning
[20:04:42] <eddyb> nmatsakis: well, we have one :)
[20:04:56] <eddyb> default type params if you need them
[20:05:44] <nmatsakis> acrichto: eddyb: oh :)
[20:05:50] <nmatsakis> hmm
[20:06:09] <nmatsakis> we may want to change how format! expands then
[20:06:13] <nmatsakis> to improve how it interacts with temporary lifetimes
[20:06:29] <acrichto> in order to support 'let a = format_args!(...)' ?
[20:06:34] <nmatsakis> no, to support:
[20:06:46] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[20:06:46] *** ChanServ sets mode: +ao pcwalton pcwalton
[20:06:47] <nmatsakis> format!("foo{}", produce_some_temp().get())
[20:06:54] <nmatsakis> in particular
[20:07:00] <acrichto> oh hmm, how would the codegen look?
[20:07:00] <nmatsakis> token::get_ident(name).get()
[20:07:05] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:07:12] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[20:07:12] *** ChanServ sets mode: +ao dherman dherman
[20:07:15] <acrichto> right now it generates "let temp = &arg_you_provided;"
[20:07:15] <nmatsakis> probably it wants to use nested matches rather than lets
[20:07:26] <nmatsakis> match &arg_you_provided { temp => ... }
[20:07:38] <acrichto> let temp = match &arg { foo => foo } ?
[20:07:42] <acrichto> or would that not work?
[20:07:44] <nmatsakis> no
[20:07:48] <eddyb> wait, we already do that before putting them in an array?
[20:08:00] <nmatsakis> i.e., if it now does:
[20:08:02] <nmatsakis> let temp1 = ...;
[20:08:04] <nmatsakis> let temp2 = ...;
[20:08:07] <nmatsakis> something([temp1, temp2])
[20:08:08] <eddyb> that means my modifications should be even cheaper
[20:08:25] <nmatsakis> match ... { temp1 => match ... { temp2 => { something([temp1, temp2]) } }
[20:08:36] <nmatsakis> that would keep all temporaries around until something() had been called
[20:08:42] <acrichto> would codegen handle that well in terms of compile-time?
[20:08:49] <nmatsakis> got me
[20:08:50] <nmatsakis> ;)
[20:08:55] <nmatsakis> we could optimize the case of a match with one arm
[20:08:59] <nmatsakis> it's not optimized right now
[20:09:19] <acrichto> out of curiosity, how is match different from a let?
[20:09:21] <nmatsakis> given the rust rules, such an arm must be an infallible pattern
[20:09:28] <nmatsakis> you mean with respect to temporary lifetimes?
[20:09:30] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[20:09:35] <nmatsakis> the difference is somewhat intentional
[20:09:38] <eddyb> acrichto: match and let are the statements that give the maximum lifetimes
[20:09:40] * nmatsakis has to finish that damn blog post I've been wokring on
[20:09:56] <nmatsakis> basically temporaries (generally) live as long as the enclosing statement,
[20:10:03] <nmatsakis> and let foo = ...; is a statement for this purpose
[20:10:12] <nmatsakis> so that means that the temporaties in the `...` live until the end of the let
[20:10:29] <acrichto> isn't that the same as a match then? the let is in scope for the whole format call
[20:10:33] <nmatsakis> no
[20:10:35] <eddyb> acrichto: nope
[20:10:41] <nmatsakis> because the code that comes after the let is INSIDE the match
[20:10:58] <eddyb> acrichto: the result lives as long in both cases, but temporaries live only within the same statement
[20:11:08] <acrichto> ooooh
[20:11:17] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[20:11:29] <nmatsakis> it's equivalent but for when the temporary destructors run
[20:11:41] <nmatsakis> the reason I said this was intentional is more-or-less to give you that choice, without using inference
[20:11:47] <nmatsakis> so you can write:
[20:11:56] <nmatsakis> let entry = *my_map.borrow_mut().get(&key);
[20:12:03] <nmatsakis> and your borrow_mut() destructor runs after the let
[20:12:20] <nmatsakis> as (I think) one would reasonably expect
[20:12:33] <acrichto> yeah that makes sense
[20:13:43] <eddyb> now I have to sort through issues and possibly remove a handlful of tests
[20:17:58] <nmatsakis> acrichto: hey the unused result lint is neat-o
[20:18:15] <nmatsakis> acrichto: how extensible is it, could we apply it to Block in trans? (is eddyb way ahead of me here?;)
[20:18:40] <eddyb> nmatsakis: nope. but I believe it might not work because we return &Block
[20:20:44] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[20:22:02] <nmatsakis> eddyb: hmm well we could newtype that
[20:22:14] <nmatsakis> it'd be more concise to boot
[20:22:25] <nmatsakis> struct Block<'a> { ptr: &'a BlockStruct<'a> } 
[20:29:42] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[20:30:24] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[20:31:58] *** Joins: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com)
[20:32:37] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[20:33:18] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[20:33:19] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[20:36:34] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:36:35] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/NUqBhQ
[20:36:35] <ghrust> 13rust/06auto 141c1defe 15Alex Crichton: Shuffle around ownership in concurrent queues...
[20:36:35] <ghrust> 13rust/06auto 1466ba6fd 15Alex Crichton: Rewrite channels yet again for upgradeability...
[20:36:35] <ghrust> 13rust/06auto 1422e5706 15bors: auto merge of #11578 : alexcrichton/rust/chan-changes, r=brson...
[20:36:37] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:39:09] <eddyb> nmatsakis: I hate how old code overuses @T *sigh*
[20:39:18] <eddyb> test result: FAILED. 940 passed; 16 failed; 44 ignored; 0 measured // and it's late already
[20:42:00] <doener> eddyb: looking just at filesizes, only libstd improves a bit with the llvm change. In the assembly, most changes seem to be a few lines being shifted up and down
[20:48:34] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[20:50:45] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:51:07] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[20:51:53] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:55:18] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:55:37] <eddyb> cmr, acrichto: https://github.com/mozilla/rust/pull/12030 this can go to try while I sleep (to catch more test failures that I missed. because I probably missed some)
[20:56:33] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[20:56:46] <eddyb> doener: send me a link if you submit a PR (problem report) or a patch to LLVM :)
[20:58:26] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[20:58:57] <doener> currently preparing one
[21:00:09] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[21:03:05] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[21:04:23] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[21:06:46] <bstrie> more people conflating ARC in objc and Arc in rust
[21:06:58] <bstrie> 1.0 blocker: finally think of a new name for Arc
[21:07:48] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[21:08:31] *** Quits: Kxepal (Miranda@moz-6CFAB9DE.pppoe.mtu-net.ru) (Quit: Kxepal)
[21:08:40] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:08:49] *** Joins: Kxepal (Miranda@moz-6CFAB9DE.pppoe.mtu-net.ru)
[21:09:45] *** Quits: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[21:10:19] *** Joins: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com)
[21:12:29] *** Quits: yuriks (yuriks@6A0B4D7B.A9CCF389.F3163DCD.IP) (Ping timeout)
[21:17:21] <eddyb> bstrie: type id = RWArc<Many>; so I say it's close enough :P
[21:17:23] *** Joins: yuriks (yuriks@541FB14B.E4E1C694.748B6D8D.IP)
[21:19:10] <bstrie> how about just
[21:19:11] <bstrie> Ark
[21:19:25] <eddyb> bstrie: atomic reference kounting?
[21:19:25] <bstrie> it can be the ship that you stuff your animals inside to survive the flood of concurrency
[21:19:33] <eddyb> kunting? no, that's offensive
[21:19:48] <eddyb> konting. what's kont?
[21:20:34] <bstrie> eddyb: I don't CARE what's it called, we just need a name that isn't already taken by a different pointer type in a different language!!
[21:20:40] <bstrie> this will be in the top 10 rust SO questions
[21:21:18] <bstrie> I might as well go ask it now and rake in the karma
[21:21:18] <doener> *sigh* failing testcase in llvm with the change to instcombine... that will that to wait till tomorrow
[21:21:29] <bstrie> doener: are you llvm hacking
[21:22:11] *** Quits: eddyb (eddy@832D2DE5.66315F97.FB866788.IP) (Ping timeout)
[21:22:13] * glaebhoerl votes for AtomicRc
[21:22:47] <doener> bstrie: yeah, fixing a very specific case that eddyb uncovered where the CGSCC pass might fail to notice that a call was devirtualized and in turn fails to consider inlining it
[21:23:11] <bstrie> doener: are you going to try to get it upstreamed or is this another patch that we're gonna carry around forever :P
[21:23:39] <doener> the former, in the the failure was I'm seeing is not in rust but in the llvm testsuite.
[21:25:07] <doener> s/in the the/in fact the/
[21:25:12] * doener should go to bed
[21:25:46] <bstrie> nighty night
[21:25:52] <doener> g'night
[21:25:54] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[21:30:50] *** Joins: dherman (dherman@F5DBC48.1E9D22A9.3A1BB2FB.IP)
[21:30:50] *** ChanServ sets mode: +ao dherman dherman
[21:31:08] *** Quits: geoffhill (geoffhill@moz-95FF7399.members.linode.com) (Ping timeout)
[21:33:01] <brson> larsberg: thanks for taking rust minutes today
[21:33:52] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[21:33:52] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 1412931c5 to 1468c4f05: 02http://git.io/k471pw
[21:33:52] <ghrust> 13rust/06try 1468c4f05 15Eduard Burtescu: Removed @self and @Trait.
[21:33:52] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[21:34:02] *** Quits: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[21:34:27] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[21:34:27] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:34:32] *** Joins: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com)
[21:36:20] *** Quits: jensnockert (jensnocker@moz-988C9930.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[21:37:17] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:37:17] *** ChanServ sets mode: +o tjc
[21:38:20] <pcwalton> nmatsakis: ping
[21:41:25] <nmatsakis> pcwalton: pong
[21:41:59] <pcwalton> nmatsakis: I'm getting sufficiently annoyed by zeroing structs out that I'm wondering if I could just knock that out real quick :) can you summarize what needs to be done for that?
[21:42:33] *** Quits: japaric (japaric@DA9B0B44.F596884F.F29ED47E.IP) (Ping timeout)
[21:42:52] <nmatsakis> pcwalton: depends what you mean. we might to handle the simple cases relatively easily (like when the entire variable is moved)
[21:43:18] <nmatsakis> pcwalton: so if it is primarily perf that's annoying you, that might address majority of the prob
[21:43:22] <pcwalton> by handling the simple cases do you mean conservatively forbidding everything else?
[21:43:24] *** Quits: dbaupp (Thunderbir@moz-25BBAF91.lns20.syd6.internode.on.net) (Ping timeout)
[21:43:35] <nmatsakis> no
[21:43:50] <nmatsakis> I mean just falling back to zeroing for complex patterns for now
[21:43:54] <pcwalton> I mean doing it right -- i.e. forbidding moving in one branch but not the other
[21:44:32] <nmatsakis> so there's probably three parts, I think -- imposing the right static rules, which (imo) are both more restrictive and more permissive than what we have now -- but I imagine we'd start with the more restrictive part
[21:45:03] <nmatsakis> that's not too hard, I had hoped to land my patch for #6801 first, since it makes the handling for closures etc cleaner
[21:45:16] <nmatsakis> that's actually passing all tests
[21:45:24] <nmatsakis> I just wanted to write up docs and so on
[21:45:32] <nmatsakis> but I guess it's somewhat orthogonal
[21:45:41] *** Joins: japaric (japaric@FDCA8EB5.4F37C8B4.BFC118EE.IP)
[21:45:57] <pcwalton> does your patch significantly overhaul liveness?
[21:46:03] <nmatsakis> liveness isn't really involved
[21:46:04] <pcwalton> or is the basic structure the same and can I start on it now?
[21:46:07] <pcwalton> ok
[21:46:09] <nmatsakis> move checking is done by borrow checker now
[21:46:14] <nmatsakis> liveness is only used for issuing warnings
[21:46:22] <nmatsakis> about unused variables and the like
[21:46:36] <pcwalton> now == your patch or now == now now?
[21:46:38] <nmatsakis> now
[21:46:39] <nmatsakis> now now
[21:46:41] <pcwalton> ok
[21:46:42] <pcwalton> :)
[21:47:09] <pcwalton> what about moves.rs? I thought moves.rs used liveness
[21:47:15] <nmatsakis> nope
[21:47:26] <nmatsakis> how it works is:
[21:47:45] <nmatsakis> moves.rs identifies which expressions are moves, which is based purely on where the expression appears and its type 
[21:47:54] <nmatsakis> this could perhaps be rolled in with later passes, but for now it is a separate thing
[21:48:22] <nmatsakis> then the borrow checker computes moves in middle/borrowck/gather_loans/gather_moves.rs
[21:48:35] <nmatsakis> this basically computes kill/gen sets for a dataflow analysis
[21:48:43] <nmatsakis> (same code as is used with loans)
[21:48:47] <nmatsakis> the dataflow then runs
[21:48:49] <pcwalton> right, ok
[21:48:59] <pcwalton> so I'm wondering what the precise rule is for the static check
[21:49:01] <nmatsakis> and finally we check in middle/borrowck/check_loans
[21:49:19] <pcwalton> it's something likeâ€¦ if you join a dead node with a non-dead node then you issue an error?
[21:49:22] <nmatsakis> well, that's kind of what I was getting at by saying I think our current rules is both too restrictive and too liberal
[21:49:45] <nmatsakis> what is actually computed at any given point is the set of initialized paths, I believe
[21:50:00] <nmatsakis> so at a high level I think the rule is that at any point in the CFG with multiple preds,
[21:50:08] <nmatsakis> we want to check that the set of initialized paths is the same for all preds
[21:50:38] <pcwalton> makes sense
[21:50:40] <nmatsakis> it gets a bit tricky with compound paths like *x and x.f and so on, but as a first pass we can just consider the variables
[21:50:48] <pcwalton> that seems fairly straightforward
[21:51:07] <nmatsakis> it's not too hard, one annoyance is that we don't have a CFG yet -- I wrote up the code to build one,
[21:51:11] <nmatsakis> but it's unused.
[21:51:17] <nmatsakis> I was hoping to start using it after #3608 lands
[21:51:24] <nmatsakis> since then all analysis is internal to one function
[21:51:29] <nmatsakis> making the CFG much more natural
[21:51:36] <nmatsakis> cross-procedural CFG doesn't make as much sense
[21:51:49] <nmatsakis> the current "knowledge" of the CFG is encoded into dataflow
[21:51:52] <pcwalton> ok, I'll start reading the code
[21:52:00] <nmatsakis> which basically calls methods to say "there's an edge here"
[21:52:06] <nmatsakis> if we had a real CFG, dataflow would be much much simpler,
[21:52:08] <nmatsakis> it'd just interpret the CFG
[21:52:17] <nmatsakis> probably faster too, since walking the AST is a pain
[21:52:32] <pcwalton> ah, ok
[21:52:34] <pcwalton> so that's step 1
[21:52:42] <nmatsakis> that was step 1 in my head,
[21:52:46] <pcwalton> maybe I'll tackle that while sick
[21:52:47] <pcwalton> sounds fun
[21:52:56] <nmatsakis> if you want, you can start from my branch
[21:52:58] <pcwalton> after fixing up this LLVM optimization per sunfish's comments
[21:53:01] <nmatsakis> as I said, it builds
[21:53:23] <nmatsakis> https://github.com/nikomatsakis/rust/tree/issue-6801-borrowck-closures
[21:53:39] <nmatsakis> maybe I can writeup the impcat of these changes today
[21:53:43] <nmatsakis> so that this can get underway towards landing
[21:54:00] <nmatsakis> it's (hopefully!) the last major type system change, I think, that we are going to need...
[21:54:15] <nmatsakis> though I guess time will tell
[21:57:20] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[21:59:06] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[21:59:29] <pcwalton> nmatsakis: btw, my LLVM change fixes the copying of padding
[21:59:37] <pcwalton> so that padding is no longer copied around in most circumstances
[22:02:00] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:02:54] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[22:03:21] *** Quits: glaebhoerl (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP) (Quit: )
[22:04:17] <nmatsakis> pcwalton: cool
[22:06:35] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[22:06:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1422e5706 to 14ef53b7a: 02http://git.io/N3iJvQ
[22:06:36] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[22:09:24] *** Joins: ecr (chatzilla@moz-10C88DA7.dyn.cs.washington.edu)
[22:21:04] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Quit: Leaving)
[22:21:07] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:21:25] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Client exited)
[22:21:51] *** Quits: rca (rcatolino@moz-BC04AA53.adsl.proxad.net) (Ping timeout)
[22:27:41] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:28:45] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[22:29:18] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:38:47] <olsonjeffery> so for rustdoc tests.. extern mod extra is automatically inserted, right?
[22:39:08] <olsonjeffery> what should we do, for this, as more stuff migrates into the balkinized libs? put in extern mod into the docs for these libs?
[22:39:22] <olsonjeffery> or add them to this rustdoc code test prelude.. ?
[22:39:27] <olsonjeffery> i don't understand the mechanisms at work, here.
[22:39:31] <olsonjeffery> cmr: ^
[22:40:07] *** Joins: andrew-d_w (andrew-d_w@moz-821EBDED.nat.bb.dnainternet.fi)
[22:40:31] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[22:40:47] <acrichto> olsonjeffery: rustdoc --test injects "extern mod <crate>;" where <crate> is the crate that's being tested
[22:41:14] <olsonjeffery> ok. so like the json doc tests need to have extern mod serialize thrown in
[22:41:19] <olsonjeffery> that's all i needed to know
[22:41:37] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:41:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b835584 to 14ef53b7a: 02http://git.io/N3iJvQ
[22:41:37] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:41:38] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[22:41:38] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/m7toQg
[22:41:38] <ghrust> 13rust/06auto 1406a8d59 15Colin Sherratt: Add a copy-on-write container.
[22:41:38] <ghrust> 13rust/06auto 144f462a0 15Colin Sherratt: Added Freeze trait to CowArc
[22:41:39] <ghrust> 13rust/06auto 14acb1ec0 15bors: auto merge of #11230 : csherratt/rust/cow, r=alexcrichton...
[22:41:41] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[22:41:42] <acrichto> olsonjeffery: yeah that should do the trick
[22:42:59] <olsonjeffery> what's the make task to compile/run the code in the docs?
[22:43:56] *** Quits: gwty (gwtypc@CD7F90EE.DDD319A2.137C914F.IP) (Ping timeout)
[22:44:16] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[22:44:19] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[22:44:20] *** ChanServ sets mode: +qo brson brson
[22:46:18] <steveklabnik> olsonjeffery: it does it automatically when you 'make check' iirc
[22:46:36] <acrichto> olsonjeffery: make check-stage1-doc-std
[22:46:49] <acrichto> olsonjeffery: or just "rustdoc --test foo.rs"
[22:47:26] <olsonjeffery> ty
[22:47:37] <olsonjeffery> steveklabnik: yeah i ran into the tests as a part of make check
[22:47:46] <olsonjeffery> and after fixing a specific issue, i just want to jump back to that point
[22:47:56] <olsonjeffery> ill be waiting another 90 minutes if i run make check again :((((
[22:48:33] <steveklabnik> i think it's all here? https://github.com/mozilla/rust/blob/master/mk/tests.mk#L656-L727
[22:49:52] <acrichto> you get 20 gold stars if you can understand the makefiles
[22:50:02] <acrichto> I wrote that and I don't understand it
[22:52:39] <flaper87> so, the new rule for statics doesn't like this: https://github.com/mozilla/rust/blob/master/src/libsyntax/codemap.rs#L94 :D
[22:53:06] <flaper87> I'm not sure what I should change that @ExpInfo pointer to, though :/
[22:53:25] <flaper87> acrichto: ^ any hint ?
[22:53:49] <acrichto> flaper87: that can't be a static
[22:54:02] <flaper87> exactly :)
[22:54:26] <acrichto> as in, you can't change Span, DUMMY_SPAN can't exist
[22:55:08] <flaper87> acrichto: oh, mmh, I'll get rid of it then. It's used in several places, though.
[22:55:32] <acrichto> flaper87: it still needs to be around in one form or another, you probably just need to make it a function that generates a dummy span
[22:55:39] <acrichto> that's what it used to be, but it changed recently to a static
[22:56:06] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:56:08] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:56:12] <flaper87> acrichto: yeah, I was going to add a function that returns a dummy span.
[22:56:21] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:56:21] *** ChanServ sets mode: +o tjc
[22:57:03] <flaper87> the weird thing is that libsyntax compiles fine here
[22:57:29] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:57:36] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[22:58:07] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
[22:59:57] *** Quits: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP) (Ping timeout)
[23:08:40] <nmatsakis> so, for a while I was pushing for a rule that permitted managed/owned pointers in *Types*,
[23:08:47] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[23:08:47] <nmatsakis> precisely so as to allow cases like that
[23:08:49] <nmatsakis> flaper87: ^
[23:08:53] <nmatsakis> but we decided to go simpler
[23:09:04] <nmatsakis> that is, you'd be allowed to have statics whose types contained managed/owner pointers,
[23:09:11] <nmatsakis> you just couldn't initialize them with a managed/owned *value*
[23:09:20] <nmatsakis> but it does get a bit messy with static mut
[23:09:31] <nmatsakis> and it's probably just fine to make it DUMMY_SP()...
[23:11:43] <flaper87> nmatsakis: mmh, TBH, i thought about that when I was writing this patch, I mean, just forbidding static initialization with managed/owned values
[23:12:10] <flaper87> I agree it gets messy but it kinda feels right. 
[23:12:34] <flaper87> I think it's fine to first add the rule as is and then revisit this later
[23:13:05] *** Joins: dbaupp (Thunderbir@2702835C.D5A1DCF.37681C44.IP)
[23:13:19] <flaper87> I don't think I've enough knowledge about the whole compiler and type system to provide a good feedback for this
[23:13:50] <flaper87> my first thought would be to just forbid values but again I might be missing something
[23:14:02] <flaper87> nmatsakis: I'll make DUMMY_SP a function
[23:14:13] <flaper87> for some reason it compiles here and that's why I didn't spot that case
[23:14:29] <nmatsakis> flaper87: "compiles here"?
[23:14:40] <flaper87> nmatsakis: erm sorry, compiles in my laptop
[23:18:12] *** Quits: ecr (chatzilla@moz-10C88DA7.dyn.cs.washington.edu) (Ping timeout)
[23:18:59] *** Quits: andrew-d_w (andrew-d_w@moz-821EBDED.nat.bb.dnainternet.fi) (Input/output error)
[23:19:22] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[23:21:34] *** Joins: ecr (chatzilla@moz-22A3616E.dhcp4.washington.edu)
[23:23:49] <olsonjeffery> acrichto: are the rust doc tests the "last step" in terms of running tests?
[23:23:52] <olsonjeffery> in make check
[23:24:29] <olsonjeffery> ive got all my changes up. and im wondering if its worth waiting for another make check run on my machine to churn through before asking for an r+
[23:25:12] <brson> olsonjeffery: they are close to the last step
[23:30:04] *** Joins: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[23:30:38] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Ping timeout)
[23:30:50] *** Quits: dherman (dherman@F5DBC48.1E9D22A9.3A1BB2FB.IP) (Quit: dherman)
[23:31:31] *** flaper87 is now known as flaper87|afk
[23:33:37] *** Quits: ecr (chatzilla@moz-22A3616E.dhcp4.washington.edu) (Ping timeout)
[23:33:39] *** Quits: yuriks (yuriks@541FB14B.E4E1C694.748B6D8D.IP) (Quit: leaving)
[23:36:39] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[23:50:18] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[23:50:21] *** Joins: ecr (chatzilla@moz-22A3616E.dhcp4.washington.edu)
[23:51:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[23:51:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/m7toQg
[23:51:40] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[23:53:29] *** Quits: ecr (chatzilla@moz-22A3616E.dhcp4.washington.edu) (Ping timeout)
[23:56:41] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:56:41] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/_6__CA
[23:56:41] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:56:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:56:42] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/y3FKIQ
[23:56:42] <ghrust> 13rust/06auto 14b03ba5f 15Alex Crichton: Implement clone() for TCP/UDP/Unix sockets...
[23:56:42] <ghrust> 13rust/06auto 1491996b5 15bors: auto merge of #11894 : alexcrichton/rust/io-clone, r=brson...
[23:56:43] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:58:56] *** Joins: lpy (lpy@51E8C831.DDD9F058.E99F7FDB.IP)
