[00:05:08] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Bye!)
[00:05:19] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[00:06:32] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:10:03] <Luqman> cmr: yea, didn't really expect it to change much
[00:10:21] <Luqman> cmr: really the only reason i did it was the @mut bool thing just annoyed me :P
[00:29:35] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[00:32:10] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:32:10] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14f0b27a4 to 14813ecb5: 02http://git.io/k471pw
[00:32:10] <ghrust> 13rust/06try 14813ecb5 15Tim Chevalier: rustpkg: Make rustpkg tests stop comparing dates...
[00:32:10] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:32:53] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:32:53] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14813ecb5 to 14ca843f1: 02http://git.io/k471pw
[00:32:53] <ghrust> 13rust/06try 14ca843f1 15Tim Chevalier: rustpkg: Make rustpkg tests stop comparing dates...
[00:32:53] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:35:00] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[00:41:37] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[00:51:15] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[00:51:15] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/xO2Xow
[00:51:15] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[00:53:18] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:53:18] <ghrust> 01[13rust01] 15catamorphism pushed 1 new commit to 06try: 02http://git.io/PkrvXQ
[00:53:18] <ghrust> 13rust/06try 1412ffefb 15Tim Chevalier: Add a comment so the try bot will rebuild this
[00:53:18] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:56:13] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:56:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vRG2mA
[00:56:13] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:56:18] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:56:18] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Nb-qqA
[00:56:18] <ghrust> 13rust/06auto 14c687f6f 15Alex Crichton: Put a newline after each logging message
[00:56:18] <ghrust> 13rust/06auto 140fd8cb0 15bors: auto merge of #9609 : alexcrichton/rust/fix-logging-newline, r=catamorphism...
[00:56:18] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:01:33] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[01:08:50] <Luqman> haha gonna need a snapshot after https://github.com/mozilla/rust/pull/9609
[01:15:33] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:16:07] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[01:29:05] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[01:29:26] *** Joins: steveklabnik (steveklabn@moz-F736A796.lsanca.dsl-w.verizon.net)
[01:38:34] <engla> Facepalm + Breakthrough in the @mut conversion
[01:39:15] <engla> @mut Block -> &mut Block was abandoned for all the dynamic borrow failures.. turns out most of them can just be -> &Block instead..
[01:39:30] <aatch> engla, hah
[01:39:30] <cmr> Heh
[01:40:14] <aatch> I encountered something similar with the CrateContext stuff I did
[01:40:54] <Luqman> engla: i will be so happy if you can get rid of @mut Block!
[01:41:31] <engla> Luqman: I probably won't do that.. but all of trans::build so far
[01:41:42] <engla> and that's one of the roots at least
[01:41:50] <Luqman> small steps
[01:42:21] <engla> yeah I see now how much work it is, I think it must be ok to do incremental improvements
[01:43:19] <Eridius> anyone around who has the power to push to try?
[01:43:35] <dbaupp> engla: \o/
[01:43:37] <cmr> Eridius: yes, what's up?
[01:43:37] <dbaupp> Eridius: yes
[01:43:48] <Eridius> can someone push https://github.com/kballard/rust/commit/1ffab206089578fc1e97b7e44b23d7694024e6f9 to try? I want to see if it fails on windows or linux
[01:43:51] <Eridius> since I can't test those myself
[01:44:01] <cmr> yry is currently doing rustpkg things
[01:44:07] <Eridius> bah
[01:44:18] <engla> dbaupp: the facepalming feeling is stronger at the moment still :)
[01:44:45] <dbaupp> try can run more than one thing at a time
[01:44:47] <dbaupp> I believe
[01:44:54] <cmr> tjc: can you confirm ^ ?
[01:44:58] <dbaupp> engla: don't hurt yourself :P
[01:45:00] * cmr would hate to clobber it
[01:45:18] <tjc> cmr: yes
[01:45:22] <aatch> The builders themselves cannot run more than one thing at a time.
[01:45:33] <aatch> However, you can have queued builds
[01:45:42] <tjc> if you look at http://buildbot.rust-lang.org/console?branch=try&refresh=15 , you can see it's running 3 different try builds that I pushed
[01:46:19] <tjc> also http://buildbot.rust-lang.org/buildslaves shows you all the buildslaves
[01:46:32] <tjc> the try builders are each associated with multiple buildslaves
[01:47:24] <aatch> Oh right, multiple buildslaves (I only have 1 machine for CI so it's both master and slave)
[01:47:53] <Eridius> btw tjc, I had to do a lot in rustpkg to make it work with the new Path, if you have a chance to look over the commit I linked
[01:48:09] <Eridius> tjc: including fixing what seemed like a couple of bugs, which I guess had no tests? i.e. the Prefixes impl seemed completely wrong
[01:48:12] <tjc> Eridius: I'll take a look
[01:48:41] <Eridius> from reading the code it seemed like it would yield paths constructed out of the string "[a, b, c]" for a path a/b/c, because it was calling .to_str() on the &[~str]
[01:49:02] <tjc> Eridius: first and least important, I suggest you change the XXXes to NOTEs so you remove them before committing (or change them to FIXMEs before committing)
[01:49:30] <Eridius> tjc: I can't remove them, because I have no solution for them at the moment. At the very least we need run to support vectors instead of strings for arguments, and environment, and more
[01:49:36] <Eridius> and FIXME requires a bug to reference for all of this
[01:49:38] <tjc> Eridius: then they need to be FIXMEs
[01:49:44] <tjc> it's fine to make a FIXME before you check in the code
[01:51:03] <Eridius> I suppose I can make one master bug saying that all things that interact with Path need to be vec-aware, but there's really a bunch of components to that
[01:58:13] <tjc> Eridius: the test for the Prefixes impl is `tests::pkgid_pointing_to_subdir`
[01:58:25] <tjc> that passed, so IDK what's up there, but your code looks better
[01:58:31] <tjc> I don't see any obvious issues, I'll push it to try
[02:01:01] <Eridius> tjc: thanks
[02:01:11] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[02:01:11] <ghrust> 01[13rust01] 15catamorphism created 06kballard-path-rewrite (+19 new commits): 02http://git.io/Z_rvZw
[02:01:11] <ghrust> 13rust/06kballard-path-rewrite 14d8f8114 15Kevin Ballard: Initial sketching out of the new path module...
[02:01:11] <ghrust> 13rust/06kballard-path-rewrite 144bfd0b8 15Kevin Ballard: path2: Implement PosixPath
[02:01:12] <ghrust> 13rust/06kballard-path-rewrite 14cd75a18 15Kevin Ballard: path2: Start reimplementing in terms of ~[u8] instead of ~str...
[02:01:14] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[02:01:30] <Eridius> tjc: I figured I must have just been missing something about Prefixes, but I looked at how it was used and tried to reimplement it the way the client code was expecting
[02:06:19] <klutzy> Eridius: on using ~[u8] on windows, is it assumed that they are really wchar_t array with system endianness?
[02:06:53] <Eridius> klutzy: no. It represents WindowsPaths using a utf-8 string. Interoperating with Windows APIs that need wchar_ts will come later. I don't use Windows so I can't really write that
[02:06:57] <Eridius> since I have no way of testing it
[02:07:19] <Eridius> but I'm imagining a Windows equivalent of c_str::CString that represents a UCS2 buffer
[02:07:32] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:07:50] <klutzy> so it is not transparent to system api?
[02:11:31] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:12:29] *** Joins: stevekla1nik (steveklabn@moz-F736A796.lsanca.dsl-w.verizon.net)
[02:13:20] <Eridius> klutzy: I know nothing about Windows APIs aside from the fact that at least some of them take UCS2-encoded paths
[02:13:38] <Eridius> there's also issues with path length, etc, so long paths would need to be converted into \\?\-style "verbatim" paths
[02:14:16] <klutzy> Eridius: I'm still unclear what parts use ucs2
[02:14:42] <klutzy> on \\?\: I and my friends played on win32 some days ago, then we found it is able to create file named (0xFFFF).txt or (0xDC00).txt
[02:15:00] <Eridius> klutzy: yeah, \\?\ disables all filename processing. Apparently you can create files named . or .. or /
[02:15:18] <Eridius> which is one reason why my WindowsPath impl is so much larger than PosixPath
[02:16:27] <klutzy> I created con.txt then accidently closed python console I've played. explorer refuses to remove it and I'm lazy to reopen console so it is still alive :p
[02:16:38] <cmr> heh
[02:17:24] <Eridius> how often does the builder notice changes to try? the console hasn't changed
[02:17:47] <Eridius> oh wait, the push wasn't to try. no wonder
[02:18:04] <klutzy> anyway, I've thought win32 apis assume utf16 or just-raw-u16-array. but you are saying there are other cases assuming ucs2?
[02:18:04] <Eridius> tjc: you pushed it to a branch named kballard-path-rewrite
[02:18:14] <tjc> Eridius: *smacks self*
[02:18:18] <Eridius> klutzy: they're UCS2, not UTF-16
[02:18:28] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:18:28] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 1412ffefb to 141ffab20: 02http://git.io/k471pw
[02:18:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:18:32] <Eridius> at least, everything I've read says UCS2
[02:18:38] <Eridius> tjc: thanks
[02:18:59] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:18:59] <ghrust> 01[13rust01] 15catamorphism 04deleted 06kballard-path-rewrite at 141ffab20: 02http://git.io/VY_46w
[02:18:59] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:20:01] <klutzy> Eridius: you mean CreateFileW() only accepts ucs2? (except for \\?\)
[02:20:21] *** Quits: steveklabnik (steveklabn@moz-F736A796.lsanca.dsl-w.verizon.net) (Ping timeout)
[02:20:34] <Eridius> klutzy: again, I'm not a windows programmer. I looked up CreateFileW once though and it gave me docs on CreateFile instead of CreateFileW.
[02:20:42] *** Quits: stevekla1nik (steveklabn@moz-F736A796.lsanca.dsl-w.verizon.net) (Ping timeout)
[02:21:35] <Eridius> hrm, I just checked StackOverflow and someone's answer asserts that since Windows 2000, most of the FooW functions take UTF-16 instead of UCS2. But I don't know the details
[02:21:49] <klutzy> ah, windows 2000
[02:21:52] <Eridius> I also don't know if the answerer is actually correct
[02:21:53] <klutzy> then it might be
[02:22:04] <klutzy> I think it has changed over time
[02:22:12] <cmr> I thought microsoft called UCS2 UTF-16
[02:22:19] <Eridius> cmr: UCS2 and UTF-16 aren't the same thing
[02:22:22] <cmr> I know
[02:22:31] <cmr> But I thought in microsoftland, they were.
[02:22:55] <Eridius> I don't know
[02:23:18] <Eridius> in any case, converting a WindowsPath to a Microsoft WChar is a task for a later day
[02:23:23] * dbaupp thinks we should just write a "virus" (in rust of course) that patches every windows installation to use UTF-8 everywhere
[02:23:25] <Eridius> hopefully by someone who's actually using Windows
[02:24:01] <Eridius> tjc: woohoo, linux failed! \p/
[02:24:02] <Eridius> err \o/
[02:24:18] <tjc> Eridius: well, you probably would be worried if it had succeeded, right? :-)
[02:24:26] <Eridius> windows failed too
[02:24:37] <Eridius> oh great, std::os has windows-specific code that I didn't see
[02:24:43] <Eridius> which apparently does utf-16 conversions on Paths ;)
[02:25:46] <sfackler> acrichto: ping?
[02:27:01] <klutzy> cmr: windows called ucs2 as "unicode" long time ago, but they differentiate utf16 and ucs2 from xp
[02:27:16] <cmr> ok
[02:27:28] <klutzy> but legacy are still poking us :(
[02:31:45] <tjc> Eridius: fyi, a couple weeks ago brson said he would change the bors whitelist so that some more people, including you, could push to try...
[02:31:55] <tjc> I don't know how to check that, but tomorrow I'll ask him if he got around to doing that
[02:33:47] *** Quits: kimundi (kimundi@moz-AAC1E158.dip0.t-ipconnect.de) (Ping timeout)
[02:35:28] <dbaupp> cmr: re https://github.com/mozilla/rust/issues/9467#issuecomment-25334775
[02:35:40] <dbaupp> cmr: continue is alreday valid syntax
[02:35:48] <dbaupp> so we just need to take a snap and then rename
[02:36:02] <dbaupp> rusti: for _ in range(0, 10) { continue }
[02:36:03] -rusti- ()
[02:36:03] <cmr> Ah so it is
[02:36:13] <cmr> Wait
[02:36:21] <Eridius> tjc: that would be handy
[02:36:22] <cmr> When did that happen?
[02:36:31] <dbaupp> cmr: brson added it a few days ago
[02:36:32] <cmr> Shouldn't continue be a undefined variable there?
[02:36:34] <cmr> oh
[02:36:36] <klutzy> cmr: https://github.com/mozilla/rust/pull/9504
[02:37:33] *** Joins: zz_kimundi (kimundi@moz-FECF1514.dip0.t-ipconnect.de)
[02:37:36] *** zz_kimundi is now known as kimundi
[02:37:37] <Eridius> any particular reason we're renaming to continue? Just for familiarity with other languages?
[02:38:57] <dbaupp> Eridius: yeah, 'loop' is pretty weird
[02:39:20] <acrichto> sfackler: pong
[02:42:15] <sfackler> is the behavior of rustdoc's output of trait impls a known issue? e.g. http://static.rust-lang.org/doc/master/std/from_str/trait.FromStr.html
[02:42:32] <sfackler> only some are impl Foo for Bar, the rest are just Bar
[02:42:57] <acrichto> that's intentional
[02:43:08] <acrichto> one-word things are structs/enums which implement the trait, otherwise it's some sort of non-linkable types
[02:43:19] <acrichto> although arguably it'd be nice to have the same syntax
[02:43:50] <Eridius> could I ask somsone to push https://github.com/kballard/rust/commit/376fc2a54b3b744af69fc72830ea3dc8b4804aec to try? This fixes the identified linux/windows issues. Of course I'm expecting more :/
[02:44:55] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[02:44:55] <ghrust> 01[13rust01] 15alexcrichton pushed 1 new commit to 06try: 02http://git.io/BLeFfw
[02:44:55] <ghrust> 13rust/06try 14376fc2a 15Kevin Ballard: path2: Fix some linux/windows issues
[02:44:55] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[02:44:58] <acrichto> Eridius: done
[02:44:58] <Eridius> thanks
[02:50:59] *** Joins: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[03:01:16] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[03:01:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Nb-qqA
[03:01:16] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[03:06:14] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:06:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ej1fTw
[03:06:14] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:06:19] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:06:19] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/TF1-eg
[03:06:19] <ghrust> 13rust/06auto 1422ef7e7 15Alex Crichton: Require &Crate instead of @Crate...
[03:06:19] <ghrust> 13rust/06auto 147b18976 15Alex Crichton: Remove all usage of @ast::Crate
[03:06:19] <ghrust> 13rust/06auto 1480b6056 15bors: auto merge of #9612 : alexcrichton/rust/rc-crate2, r=huonw...
[03:06:21] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:28:14] <Luqman> anyone against making a snapshot now that https://github.com/mozilla/rust/pull/9609 has merged?
[03:28:32] <tjc> Luqman: go for it
[03:30:35] <Eridius> oh crap. linux biuld of my path stuff failed with an ICE
[03:30:45] <cmr> uh oh
[03:30:46] <Eridius> which means I don't know where the problem is
[03:30:55] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:30:55] <ghrust> 01[13rust01] 15luqmana merged 06master into 06snap-stage3: 02http://git.io/1Kd09g
[03:30:55] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:32:24] <Eridius> heh, silly error in windows
[03:32:38] <Eridius> wish I could build on linux myself but the memory usage has gone too high I think
[03:33:14] <cmr> I can give you a temporary VM
[03:35:36] <Eridius> I'm gonna see what happens if I try building anyway
[03:35:47] <cmr> (nobody *ever* takes me up on that :p)
[03:36:07] <Eridius> lol
[03:40:51] <Eridius> I bet grabbing an EC2 m1.medium instance would be pretty cheap for running quick compiles on
[03:41:07] <Eridius> looks like it's $0.120 per hour
[03:43:41] <dbaupp> does that give you enough memory?
[03:44:39] <Eridius> dbaupp: m1.medium apparently has 3.75GiB
[03:44:58] <Eridius> vs m1.small which is 1.7 and t1.micro which is 0.615
[03:45:03] <Eridius> or m1.large which is 7.5
[03:50:02] <Eridius> "Getting start" note still claims rust peaks at 1.6GiB
[03:59:56] *** Quits: tjc (tjc@moz-D91BA12F.sfba.hfc.comcastbusiness.net) (Quit: zzzzzzzzzz)
[04:04:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[04:22:03] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:30:48] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:45:29] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:46:16] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:46:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/TF1-eg
[04:46:16] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:51:17] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:51:17] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/le8LBw
[04:51:17] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:51:17] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:51:18] <ghrust> 01[13rust01] 15bors pushed 14 new commits to 06auto: 02http://git.io/SP56ng
[04:51:18] <ghrust> 13rust/06auto 14d9bf8c7 15Erick Tryzelaar: std: Replace num::IntConvertible with {To,From}Primitive
[04:51:18] <ghrust> 13rust/06auto 146f36864 15Erick Tryzelaar: syntax: Add #[deriving(FromPrimitive)] syntax extension...
[04:51:18] <ghrust> 13rust/06auto 1474e1fb0 15Erick Tryzelaar: syntax: swap from .span_fatal to .span_err in #[deriving(FromPrimitive)]
[04:51:20] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[05:01:15] <dbaupp> klutzy: do you know what fixed https://github.com/mozilla/rust/pull/9616 ?
[05:01:48] <klutzy> dbaupp: the libuv_buf_t nightmare I guess
[05:02:04] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[05:02:05] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:02:22] <klutzy> ( https://github.com/mozilla/rust/pull/9165 this )
[05:03:24] <Luqman> klutzy: that inconsistent struct just makes me sad :(
[05:03:52] <dbaupp> klutzy: that was horrible :( nice work catching it
[05:04:48] <klutzy> actually I tried to enable all network tests on win32, but https://github.com/mozilla/rust/issues/9605 this is blocking me
[05:05:22] <klutzy> we schedules blocked_task via read callback, but libuv sometimes does not call it
[05:05:55] <klutzy> it is partially again because libuv's uv_read_start win32 impl is different to unix
[05:09:08] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[05:20:05] *** Joins: nrc (nrc@69827E11.2BFB5F16.7D44F35.IP)
[05:25:48] <Luqman> tests::test_rustpkg_test_output failed on the linux snapshot builder :(
[05:26:10] <Luqman> known intermittent failure?
[05:26:42] <klutzy> some rustpkg tests depend on times, so sometimes fails
[05:26:47] <klutzy> don't know if it is in the case though
[05:27:23] <acrichto> 795 files changed, 4673 insertions(+), 4668 deletions(-)
[05:27:26] <acrichto> fmt! is everywhere...
[05:28:29] <dbaupp> <3 fmt! :P
[05:36:17] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:36:18] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e1e223a to 1480b6056: 02http://git.io/N3iJvQ
[05:36:18] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:36:19] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[05:36:19] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/8cJ1Fw
[05:36:19] <ghrust> 13rust/06auto 148e69c05 15blake2-ppc: rustc: Convert lang_items hashmap to use &'static str keys
[05:36:19] <ghrust> 13rust/06auto 14abcca1c 15blake2-ppc: rustc: Convert lang_item to use an iterator
[05:36:20] <ghrust> 13rust/06auto 14d7b4033 15bors: auto merge of #9614 : blake2-ppc/rust/lang-item-iter, r=alexcrichton...
[05:36:22] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:46:00] *** Quits: nrc (nrc@69827E11.2BFB5F16.7D44F35.IP) (Ping timeout)
[05:55:20] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:21:23] <dbaupp> klutzy: should I rename https://github.com/mozilla/rust/issues/9618 to something?
[06:21:23] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:21:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d7b4033 to 1480b6056: 02http://git.io/N3iJvQ
[06:21:23] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:23:32] <klutzy> dbaupp: renaming seems better. failure on non-English path or something?
[06:24:18] <klutzy> we use non-unicode functions on unicode here and there which lead is_utf8 assertion failure.
[06:24:21] <klutzy> e.g. https://github.com/mozilla/rust/issues/9418
[06:25:47] <dbaupp> klutzy: renamed
[06:25:53] <klutzy> thanks! :D
[06:26:29] <dbaupp> (tagged both of those issue A-windows too :P )
[06:37:20] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:37:30] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[06:44:50] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:49:40] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:49:40] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06master from 1480b6056 to 141a6abad: 02http://git.io/V2xBBQ
[06:49:40] <ghrust> 13rust/06master 14795043f 15Steven Fackler: Don't redirect output in rustpkg test...
[06:49:40] <ghrust> 13rust/06master 14f40f57c 15Alex Crichton: Put a newline after each logging message
[06:49:41] <ghrust> 13rust/06master 141a6abad 15Alex Crichton: Remove all usage of @ast::Crate
[06:49:43] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:51:22] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:51:22] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149d5343e to 141a6abad: 02http://git.io/N3iJvQ
[06:51:22] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:51:22] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:51:23] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/w7yTOw
[06:51:23] <ghrust> 13rust/06auto 14e3be8a6 15blake2-ppc: trans: Change @ast::Expr -> &ast::Expr where possible
[06:51:23] <ghrust> 13rust/06auto 14f059203 15blake2-ppc: trans: Change @ast::Pat and @mut CrateContext in a few places...
[06:51:23] <ghrust> 13rust/06auto 14d0ef42b 15blake2-ppc: trans::build: Change @mut Block to &Block or &mut Block...
[06:51:25] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:56:00] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[06:56:00] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06master from 141a6abad to 1480b6056: 02http://git.io/V2xBBQ
[06:56:00] <ghrust> 13rust/06master 147b18976 15Alex Crichton: Remove all usage of @ast::Crate
[06:56:00] <ghrust> 13rust/06master 1480b6056 15bors: auto merge of #9612 : alexcrichton/rust/rc-crate2, r=huonw...
[06:56:00] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[06:56:21] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:56:21] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140ee1384 to 1480b6056: 02http://git.io/N3iJvQ
[06:56:21] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:56:22] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:56:22] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/Y5nTSQ
[06:56:23] <ghrust> 13rust/06auto 14e3be8a6 15blake2-ppc: trans: Change @ast::Expr -> &ast::Expr where possible
[06:56:23] <ghrust> 13rust/06auto 14f059203 15blake2-ppc: trans: Change @ast::Pat and @mut CrateContext in a few places...
[06:56:23] <ghrust> 13rust/06auto 14d0ef42b 15blake2-ppc: trans::build: Change @mut Block to &Block or &mut Block...
[06:56:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[07:13:06] *** flaper87|afk is now known as flaper87
[07:20:37] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[07:31:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[07:31:06] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[07:31:23] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:57:41] <Eridius> random thought: buildbots should build with RUST_LOG=rustc=1 to show more info in the event of an ICE
[07:59:12] <dbaupp> Eridius++
[07:59:23] * Eridius will file an issue
[07:59:42] <dbaupp> They could even just build with RUST_LOG=warn to pick up everything that could be concerning?
[08:00:04] <Eridius> perhaps? I don't know if we have any spurious output during the build for warn at the moment
[08:00:08] <Eridius> https://github.com/mozilla/rust/issues/9623
[08:01:49] * dbaupp compiles with RUST_LOG=warn to see
[08:02:28] * dbaupp has to fix the bugs in his branch first 
[08:03:51] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[08:14:34] *** flaper87 is now known as flaper87|afk
[08:21:53] *** flaper87|afk is now known as flaper87
[08:30:14] <Eridius> woo, repro'd the ICE
[08:31:12] <Eridius> ah hah! I fucked up self_exe_path
[08:31:53] <Eridius> which is interesting because I barely touched the linux one, but I rewrote the freebsd one completely and that seems to be fine
[08:32:57] <Eridius> wait what? try-mac finished with a failure?!? but I run on mac myself!
[08:36:35] <Eridius> oh dear. I know what happened. .as_mut_buf passes the length, not the capacity, and I have a zero-len vector with a 2048 cap
[08:37:02] <Eridius> I kind of wish .as_imm_buf and .as_mut_buf would pass cap too
[08:40:19] <dbaupp> add .as_{imm,mut}_buf_cap to OwnedVector?
[08:40:31] * dbaupp wishes 'as' was three letters long
[08:40:33] <Eridius> ehh, more methods? that might be worse
[08:40:58] <Eridius> I wonder how many uses of .as_imm/mut_buf use len and how many actually need cap?
[08:41:51] <dbaupp> I think engla tried to migrate all the users of .as_muf_buf + set_len off that, because of danger
[08:41:59] <Eridius> danger?
[08:41:59] <dbaupp> so, hopefully none
[08:42:08] <Eridius> what's the alternative?
[08:42:13] <dbaupp> integer overflow not being accounted for
[08:42:18] <dbaupp> with_capacity + push
[08:42:19] <Eridius> overflow of what?
[08:42:21] <dbaupp> (I think)
[08:42:26] <dbaupp> size_of<T>() * len
[08:42:38] <dbaupp> it may wrap
[08:42:55] <Eridius> a) my vector is of u8 so that's not applicable, b) how is that any different than any with_capacity of any other type? and c) what's the alternative?
[08:43:01] <dbaupp> (I'm not sure if that's the exact reason, though)
[08:43:25] <dbaupp> what do you mean, "what's the alternative"? how are you building it?
[08:43:52] <Eridius> vec::with_capacity(), .as_mut_buf(), call a C func with FFI that returns the amount of space it actually wrote to, pass that to set_len()
[08:44:17] <Eridius> https://gist.github.com/kballard/6760991
[08:44:18] <dbaupp> ah, FFI might make doing anything other than that hard
[08:44:44] <Eridius> .as_imm/mut_buf vend *T. FFI seems to be the primary purpose. Using that as an optimization hack is, well, a hack
[08:45:00] <Eridius> (the bug in this code, btw, was the use of `len` instead of `TMPBUF_SZ` on the readlink call)
[08:45:31] <Eridius> which is because the old code used `[0 as c_char, ..TMPBUF_SZ]` so `len` was appropriate, but since I'm returning the ~[u8] now I just allocate it up-front
[08:45:41] <dbaupp> yeah, looks good to me
[08:45:54] <dbaupp> (although use libc::readlink should work?)
[08:46:01] <Eridius> and yeah, it means a 2048k buffer is returned to the caller, but it doesn't live very long (Path then copies data out of it)
[08:46:06] <Eridius> well this is in std
[08:46:09] <Eridius> std::os
[08:46:17] <Eridius> it's older code
[08:46:35] <Eridius> since libc does re-use those funcs I imagine `libc::readlink` would work, but I'm not really trying to fix up that stuff
[08:46:37] <dbaupp> 2meg buffer?
[08:46:40] <Eridius> 2kb
[08:46:43] <Eridius> sorry I mistyped
[08:46:50] <dbaupp> haha :)
[08:47:14] <Eridius> so the old code would allocate 2KiB on stack, then convert it to a str. This code just heap-allocates it and returns it to its caller, which then passes it to Path
[08:47:36] <Eridius> (which copies the actual relevant data out and then the buffer is deallocated)
[08:48:48] <Eridius> for the record, using an EC2 m1.medium instance is actually doable for building linux, but it's slower than on my local machine
[08:50:44] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[08:50:50] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: nejucomo)
[08:53:15] <Eridius> ok yeah, I just checked again, the rustpkg test suite passes on my local machine, but it failed on the try-mac builder. wtf.
[08:56:25] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[08:56:25] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ddc3bde to 1480b6056: 02http://git.io/N3iJvQ
[08:56:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[08:56:26] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[08:56:26] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/jxoG7Q
[08:56:26] <ghrust> 13rust/06auto 148e69c05 15blake2-ppc: rustc: Convert lang_items hashmap to use &'static str keys
[08:56:26] <ghrust> 13rust/06auto 14abcca1c 15blake2-ppc: rustc: Convert lang_item to use an iterator
[08:56:27] <ghrust> 13rust/06auto 14ca2d596 15bors: auto merge of #9614 : blake2-ppc/rust/lang-item-iter, r=alexcrichton...
[08:56:29] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[08:59:29] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[09:00:55] <dbaupp> Eridius: did it fail reliably on the try builders?
[09:01:27] <Eridius> dbaupp: no. I did two builds. the first passed try-mac
[09:01:48] <Eridius> and the commit that was added for the second was only on linux/windows-cfg'd code
[09:01:53] <dbaupp> Eridius: probably a spurious failure then?
[09:01:58] <Eridius> I guess so. Still worrisome
[09:02:21] <Eridius> wish I could get windows working to compile rust
[09:02:23] <dbaupp> not much you can do if it passes reliably locally
[09:02:25] <Eridius> I still haven't been able to do it
[09:03:22] <Eridius> dbaupp: could I trouble you to push https://github.com/kballard/rust/commit/18c74c49f22b7064cfcb59246f173a4f2790addd to try, for windows?
[09:05:40] <dbaupp> Eridius: in a second
[09:05:47] <Eridius> thanks
[09:06:04] <Eridius> my EC2 successfully built stage1 libstd, so the linux ICE should be fixed
[09:06:28] <Eridius> of course, when this is all done, I still need to merge it with latest master, but hopefully those changes will be easy enough that I don't need to bother with try
[09:07:54] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[09:07:54] <ghrust> 01[13rust01] 15huonw 04force-pushed 06try from 14376fc2a to 1418c74c4: 02http://git.io/k471pw
[09:07:54] <ghrust> 13rust/06try 1418c74c4 15Kevin Ballard: path2: Fix some linux/windows issues
[09:07:54] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[09:08:23] <dbaupp> Eridius: ^
[09:08:26] <Eridius> thanks
[09:09:02] <Eridius> I guess I may as well shut down this EC2 instance now, since the ICE is fixed
[09:28:47] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:36:28] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:36:28] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/jxoG7Q
[10:36:28] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:41:21] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:41:21] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/XgTXGA
[10:41:21] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[10:41:22] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:41:22] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/drn3QQ
[10:41:22] <ghrust> 13rust/06auto 14f4f6b95 15klutzy: std::rt::uv::net: Enable tests on Win32...
[10:41:22] <ghrust> 13rust/06auto 14aafad43 15bors: auto merge of #9616 : klutzy/rust/win32-uv-test, r=huonw...
[10:41:23] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[11:56:18] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:56:18] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/drn3QQ
[11:56:18] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[12:01:25] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[12:01:25] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/tHVm4g
[12:01:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[12:01:25] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:01:25] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/DE6v5g
[12:01:25] <ghrust> 13rust/06auto 14b617569 15Jason Toffaletti: reduce heap allocations for MemoryMap
[12:01:25] <ghrust> 13rust/06auto 148174618 15bors: auto merge of #9619 : toffaletti/rust/mmap, r=huonw
[12:01:26] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:37:50] <dbaupp> pnkfelix: ping
[12:37:56] <pnkfelix> dbaupp: pong
[12:38:18] <dbaupp> re https://github.com/mozilla/rust/issues/3810, I think %g is slgihtly more subtle that just trailing zeros
[12:38:57] <dbaupp> >>> '%g' % 1e-10
[12:38:58] <dbaupp> '1e-10'
[12:38:58] <dbaupp> >>> '%f' % 1e-10
[12:38:58] <dbaupp> '0.000000'
[12:38:59] <dbaupp> >>> '%g' % 1e-2
[12:38:59] <dbaupp> '0.01'
[12:38:59] <dbaupp> >>> '%f' % 1e-2
[12:38:59] <dbaupp> '0.010000'
[12:39:01] <dbaupp> (python)
[12:39:36] <pnkfelix> dbaupp: Yeah I was looking at the man page for format and going on what it said
[12:39:53] <dbaupp> which?
[12:40:03] * dbaupp pulls up his printf man page
[12:40:16] <pnkfelix> dbaupp: Actually, that's not true, the man page is consistent with what you said
[12:40:30] <pnkfelix> dbaupp: okay, I was misinterpreting the man page
[12:40:33] <dbaupp> ah, ok :)
[12:40:45] <pnkfelix> dbaupp: I'll reopen the ticket, but I'm not sure â€¦ well, we'll see
[12:42:14] <pnkfelix> dbaupp: erickt specifically mentioned not including trailing zeroes in the ticket description.  So I guess the question is: Is the more general behavior (of dynamically selecting between %f and %e based on which uses less space) well motivated for us?
[12:43:19] <pnkfelix> dbaupp: does format! even have something analogous to %e ?
[12:43:27] <dbaupp> not yet
[12:43:38] <dbaupp> at least, I don't think it does
[12:43:53] <dbaupp> rusti: format!("{:e}", 1e10)
[12:43:54] -rusti- <anon>:7:25: 7:29 error: unknown format trait `e`
[12:43:54] -rusti- <anon>:7          format!("{:e}", 1e10)
[12:43:54] -rusti-                                   ^~~~
[12:43:54] -rusti- error: aborting due to previous error
[12:43:54] -rusti- application terminated with error code 101
[12:44:15] <pnkfelix> dbaupp: yeah I was wondering if there might be some modifier on `{:f}` to do it
[12:44:25] <pnkfelix> dbaupp:  since that seems like it would be more in line with the overall design
[12:44:33] <dbaupp> yeah, but I'm not sure if we need separate specifiers, or if we can just use new-type structs with a different implementation of Default / whatever trait f uses
[12:44:36] <dbaupp> oh, I see
[12:44:43] <dbaupp> I don't think so
[12:47:00] <dbaupp> rusti: struct Sci(f32); impl std::fmt::Default for Sci { fn fmt(&self, fmter) { f.pad("1e-10"); /* lets pretend */ } } format!("{}", Sci(1e-10))
[12:47:00] -rusti- pastebinned 4 lines of output: http://sprunge.us/dPSC
[12:47:55] <dbaupp> rusti: struct Sci(f32); impl std::fmt::Default for Sci { fn fmt(_: &Sci, fmter: &mut std::fmt::Formatter) { fmter.pad("1e-10"); /* lets pretend */ } } format!("{}", Sci(1e-10))
[12:47:56] -rusti- ~"1e-10"
[12:50:22] <pnkfelix> dbaupp: so one can emulate it with wrapper structsâ€¦ is that meant to show that we don't need `%e` or `%g`?  (I'm inclined to agree, though part of me wonders if that reasoning could be used to get rid of other format flags...)
[12:50:37] <dbaupp> pnkfelix: yeah
[12:51:15] <dbaupp> (I and others had actually suggested using wrapper structs to remove some of the flags a while ago, but nothing has come of it yet.)
[12:52:05] <dbaupp> in any case, I do think we should at least provide a %e equivalent in the stdlib
[12:52:40] <dbaupp> and I imagine %g is useful for making output nice when possible, but still manageable otherwise. 
[12:52:48] * dbaupp hasn't really used %g at all though
[12:53:00] <pnkfelix> dbaupp: but you're opposed to expressing the `%e` format as some flag on {:f} ?
[12:53:11] <pnkfelix> dbaupp: (I don't care too much either way, just curious)
[12:53:19] <dbaupp> pnkfelix: not particularly
[12:53:46] <pnkfelix> dbaupp: I'm going to need a full sentence there
[12:54:02] <dbaupp> I don't actually have a strong opinion between the 3 options ({:e}, flag on f, or wrapper structs)
[12:54:09] * dbaupp can't type fast enough
[12:54:11] <pnkfelix> dbaupp: ah okay
[12:55:30] <dbaupp> I think having fewer magical characters would be nice, but %g/%e etc have a pile of history, so just going with that is fine by me.
[12:59:34] <dbaupp> also, having fewer characters also means std::fmt needs fewer traits (http://static.rust-lang.org/doc/master/std/fmt/index.html at the bottom), e.g. I think we could replace Octal and Binary with newtype structs implementing Unsigned/Signed
[12:59:42] <dbaupp> and even the two hex ones
[13:02:54] <pnkfelix> dbaupp: i guess there is some mental attachment when reading a format string and expecting a certain output for a certain pattern.  E.g I might be surprised if a {:u} ended up yielding hexadecimal output, though I completely understand why it works out that way in your proposal.
[13:04:42] <dbaupp> pnkfelix: yeah, I do agree; I think we'd need a very good reason to remove of each one, and I don't think that just "few magic characters & traits" cuts it.
[13:08:05] <dbaupp> *fewer
[13:08:57] <pnkfelix> dbaupp: it is funny that there are *so many* variants dedicated to printing integers, and just, what, Float for f32/f64/float ?
[13:09:15] <nmatsakis> I've not been following closely, but I do wonder if it makes sense to have only %s, and to do the rest via wrappers
[13:09:37] <dbaupp> nmatsakis: I assume you mean {} and {:?} ?
[13:09:48] <nmatsakis> e.g., %3.2f would be something like fmt!("%s", fmt_float(3, 2, the_num)
[13:10:00] <nmatsakis> dbaupp: actually if it were up to me I'd just make it %s
[13:10:05] <nmatsakis> dbaupp: but I guess I can live with {}
[13:10:15] <dbaupp> I've been thinking about that, but I think it looses us some of the "type safety" of format strings
[13:10:20] <nmatsakis> why?
[13:10:28] <pnkfelix> nmatsakis: â€¦ I think people would complain.  Did noone propose that back when ifmt was being redesigned?
[13:10:54] <nmatsakis> pnkfelix: I don't know, I confess I didn't follow it too closely, too much on my plate at the time,
[13:10:57] <nmatsakis> pnkfelix: but I tihnk thy're wrong to complain :)
[13:11:15] <dbaupp> nmatsakis: you know you want an integer, so you write {:u} or {:i} or whatever, and if you somehow end up with something that's not an integer you get a complaint, rather than weird output
[13:11:45] <dbaupp> (so not from an unsafe/safe point of view, just acting-as-the-programmer-wants point of view)
[13:11:49] <nmatsakis> dbaupp: I guess, I just don't find that to be a problem most of the itme -- more the opposite. It used to be an integer, but it's evolved from a uint into an int or something and now I get spurious type errors
[13:11:54] <dbaupp> but i guess most people just use {} anyway
[13:11:55] <pnkfelix> nmatsakis: eh, I see both sides of it.  In the end, if you want control, resorting to "{:s}" is your best bet.  but it can be nice to have those specifiers written inline in the format string.
[13:12:08] <dbaupp> (i.e. {} without any format specifier)
[13:12:32] <nmatsakis> pnkfelix: I suppose, it just seems like a ... never-ending quest for control that is better off-loaded
[13:12:58] <nmatsakis> pnkfelix: i'd probably keep padding in the format string, though, just to be inconsistent ;)
[13:13:20] <dbaupp> I do think that {:b }and {:c} (bools and chars) can be removed, since there is no sane way that will differ from the default output of {} (right?)
[13:13:28] <dbaupp> *{:b}
[13:13:35] <nmatsakis> dbaupp: well, if the point is to express the type you expect...
[13:13:45] <nmatsakis> dbaupp: ...then you might as well keep 'em I guess?
[13:13:47] <pnkfelix> dbaupp: I could imagine variations on {:c}
[13:14:04] <dbaupp> nmatsakis: yeah, I'm not sure that arg holds water; e.g. I always just use {}.
[13:14:22] * dbaupp hates it when he says things that he disproves with his own behaviour
[13:14:30] <pnkfelix> dbaupp: And maybe I'll make a SchemeBool that implements the fmt::Bool by writing `#t` and `#f`
[13:14:31] <dbaupp> pnkfelix: oh, unicode escaping?
[13:14:35] <pnkfelix> dbaupp: yeah
[13:15:49] <pnkfelix> (and no, I don't know why SchemeBool wouldn't/couldn't just do the same thing for its fmt::Default impl.)  ;)
[13:16:23] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[13:16:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/DE6v5g
[13:16:23] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[13:16:39] <nmatsakis> dbaupp: also I think i've decided I DO prefer `{}` over `%s` -- since `%s` implies the full set of printf formatting I guess :)
[13:44:12] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[13:55:23] *** flaper87 is now known as flaper87|afk
[14:06:40] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[14:08:46] <dbaupp> nmatsakis: btw, if you're still around, https://github.com/mozilla/rust/pull/9517 has been sitting in the queue with an @you for a while :)
[14:09:12] <nmatsakis> dbaupp: thanks
[14:09:50] * nmatsakis grumbles about how github handles diffs.
[14:10:06] <nmatsakis> I wish you could choose to see the old/new code side-by-side, rather than inline
[14:12:03] <dbaupp> I imagine someone has written code-review wrappers for github.
[14:12:06] * dbaupp googles
[14:21:39] *** Joins: doomlord___ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[14:21:56] *** Quits: doomlord___ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Client exited)
[14:34:30] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:44:27] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:50:11] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[14:50:54] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:52:24] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[14:53:18] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[14:55:41] <cmr> nmatsakis: dbaupp: {:b} and {:c} don't print bools and chars, they print anything implement std::fmt::{Bool,Char}. You can print your own types with them too.
[14:57:47] <cmr> which tbh I'm not sure is all that useful
[14:57:59] <dbaupp> cmr: I know, and yes, that's mostly my point
[14:58:20] <cmr> But I'm quite happy with ifmt, and I don't think moving around the complexity is very fruitful.
[14:59:26] <pnkfelix> cmr: We might want more variants for floating point output, though
[15:00:16] <pnkfelix> cmr: There's currently, what, six variants (as in (char,Trait) pairs) for integer output, and only one for float, right?
[15:01:18] <cmr> 7 actually :p
[15:02:22] <pnkfelix> cmr: hmm.  I didn't count Poly (or Pointer or Char or Binary) as being integer output ...
[15:02:35] <cmr> Well I counted Pointer but not those others
[15:02:45] <pnkfelix> cmr: Ah well that answers my Q
[15:03:08] <pnkfelix> cmr: (I was trying to just count (char,Trait) pairs that have impl T for int or impl T for uint...)
[15:35:07] *** Quits: StarLight (StarLight@moz-3B2C1A39.dynamic.avangarddsl.ru) (Ping timeout)
[15:38:23] <dbaupp> pnkfelix: what's an "alpha-renaming"?
[15:39:18] <pnkfelix> dbaupp: a consistent renaming of a variable.  http://en.wikipedia.org/wiki/Name_resolution#Alpha_renaming_to_make_name_resolution_trivial
[15:39:32] *** Joins: StarLight (StarLight@moz-21100A01.dynamic.avangarddsl.ru)
[15:39:37] <pnkfelix> dbaupp: and also http://en.wikipedia.org/wiki/Lambda_calculus#.CE.B1-conversion
[15:40:09] <dbaupp> pnkfelix: I see, thanks
[15:42:59] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[15:43:36] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[15:54:55] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[15:58:34] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[16:01:26] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[16:01:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/m1RGqA
[16:01:26] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[16:01:32] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[16:01:32] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/5spvvA
[16:01:32] <ghrust> 13rust/06auto 14e3be8a6 15blake2-ppc: trans: Change @ast::Expr -> &ast::Expr where possible
[16:01:32] <ghrust> 13rust/06auto 14f059203 15blake2-ppc: trans: Change @ast::Pat and @mut CrateContext in a few places...
[16:01:32] <ghrust> 13rust/06auto 14d0ef42b 15blake2-ppc: trans::build: Change @mut Block to &Block or &mut Block...
[16:01:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[16:08:31] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[16:08:31] *** ChanServ sets mode: +o pnkfelix
[16:10:28] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[16:12:06] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[16:14:19] *** flaper87|afk is now known as flaper87
[16:19:54] *** Quits: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Quit: Leaving)
[16:37:22] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[16:39:10] <dbaupp> acrichto: does https://github.com/mozilla/rust/pull/9615 need to be retried again due to the buildbot interruption? (engla)
[16:39:32] <acrichto> looks to have been picked up again
[16:40:07] <acrichto> although bors might get confused...
[16:40:25] <acrichto> I'll cancel and @bors: retry it
[16:45:45] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[16:48:54] <acrichto> engla: would you mind re-opening 9615? a combination of me and bors seems to have horked it :(
[16:49:11] <cmr> poor bors, his tiny brain can't handle it.
[16:49:19] <dbaupp> acrichto: wrecking all the PRs!
[16:49:23] * dbaupp shakes his head
[16:50:09] <cmr> So I'm thinking we should nuke the obsolete syntax thingy.
[16:50:59] <cmr> It's been 6 months since we've added any obsolete syntax checkers (afaik) and it's starting to get really weird when you write invalid code and it tells you that that mode is obsolete and replaced with some other mode that doesn't exist either.
[16:51:25] <dbaupp> there was one recently
[16:51:28] <cmr> Which?
[16:51:31] * dbaupp can't remember what it was
[16:52:18] <dbaupp> &const, impl Foo;
[16:52:32] <cmr> rusti: let x: &const int;
[16:52:33] -rusti- pastebinned 6 lines of output: http://sprunge.us/ijgM
[16:52:38] <dbaupp> "ObsoleteTraitFuncVisibility" (I assume that's pub fn in the traits.)
[16:53:10] <cmr> Ok, so perhaps we shouldn't nuke it entirely.
[16:53:35] <dbaupp> yeah, all the really old stuff should be returned to the pit from which it came. :P
[16:53:40] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[16:54:23] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:54:35] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:57:22] <acrichto> in theory all obsolete syntax is just removed from the parser entirely
[16:57:28] <acrichto> it's just a transitional help
[16:58:30] <cmr> #9627
[17:01:30] <dbaupp> https://github.com/mozilla/rust/issues/9218#issuecomment-25381773 :(
[17:03:25] <cmr> sadface.png indeed
[17:04:49] <klutzy> I'm really curious why installer or stage0 tarball don't include mingw dlls
[17:05:49] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[17:06:49] <nejucomo> I'm curious if this diff: https://github.com/mozilla/rust/pull/8092/files - could have instead used ~ and moves/consumption to keep the code un-nested while still keeping memory usage low...
[17:07:25] <cmr> Where is doener anyway, I haven't seen him in a while :\
[17:07:47] <cmr> It seems he disappeared off the face of github in late july.
[17:07:56] <acrichto> nejucomo: I believe that was the problem, yes, @ gets un-reference later than you may expect during a function
[17:08:00] <cmr> Early August more like it.
[17:08:37] <dbaupp> cmr: possibly gone back to normal life after summer(?)
[17:08:56] <cmr> Ah, maybe.
[17:09:53] <klutzy> time to fix yet another win32-only-bugs
[17:09:54] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:09:54] *** ChanServ sets mode: +qo brson brson
[17:10:05] <cmr> brson: https://github.com/mozilla/rust/issues/9218#issuecomment-25381773
[17:10:14] *** Joins: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net)
[17:10:53] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[17:23:06] *** Quits: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net) (Input/output error)
[17:23:27] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[17:23:30] <jdm> hmm, #2419 looks super useful and even has a plan of attack
[17:23:35] * jdm must resist taking it on
[17:28:51] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[17:33:22] <brson> cmr: yep
[17:34:06] <engla> acrichto: I'll do it
[17:34:42] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:34:42] *** ChanServ sets mode: +o pnkfelix
[17:36:34] <engla> acrichto: https://github.com/mozilla/rust/pull/9630
[17:36:38] <brson> cmr: not sure if there's any useful response to that. I'll try to fix the windows install for 0.9
[17:36:41] <engla> but is that enough? Should I push a new commit
[17:36:44] <cmr> brson: yeah
[17:36:56] <acrichto> engla: try rebasing
[17:37:04] <engla> ok
[17:37:11] <cmr> I'm going to be experimenting with lld todayish, that should remove the dep on gcc
[17:37:15] <acrichto> or if you roll-back the head commit and then re-commit with the same message
[17:37:16] <cmr> (if it works out)
[17:38:41] <engla> acrichto: git commit --amend --reset-author is a quick way to do that
[17:38:44] <engla> (resets the date)
[17:38:48] <acrichto> oh nice
[17:38:50] <engla> anyway, I reset the date on all of the commits
[17:38:58] <klutzy> brson: I think bundling mingw dlls are easy; it could done by copying 3 files
[17:39:04] <acrichto> engla: yeah sorry about this :(
[17:39:10] <engla> no problem
[17:39:19] <klutzy> but usual windows users have no experience of mingw, and mingw itself is confusing. it's the problem
[17:39:32] <engla> you're a professional Rust dev, you know what you are doing right :-)
[17:40:57] <brson> klutzy: we'll upgrade mingw and start bundling the libraries
[17:41:22] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:41:22] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141c9c65e to 148174618: 02http://git.io/N3iJvQ
[17:41:22] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:41:23] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[17:41:23] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/_AflSQ
[17:41:23] <ghrust> 13rust/06auto 14948b5ab 15blake2-ppc: trans: Change @ast::Expr -> &ast::Expr where possible
[17:41:23] <ghrust> 13rust/06auto 14b88517e 15blake2-ppc: trans: Change @ast::Pat and @mut CrateContext in a few places...
[17:41:23] <ghrust> 13rust/06auto 14f4d8d8c 15blake2-ppc: trans::build: Change @mut Block to &Block or &mut Block...
[17:41:25] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[17:48:58] *** flaper87 is now known as flaper87|afk
[17:49:09] * acrichto rejoices as `make check` finally passes on fmt! removal
[17:53:02] <engla> that's great
[17:53:20] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[17:53:20] *** ChanServ sets mode: +o tjc
[17:53:58] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[17:54:06] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[17:55:00] <acrichto> I added 11 lines :(
[17:55:04] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[17:55:52] <engla> did you fully remove fmt!?
[17:55:58] <engla> or just all users
[17:56:05] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:56:05] *** ChanServ sets mode: +o tjc
[17:57:20] *** Joins: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[17:59:34] <acrichto> engla: just all rustc users
[17:59:44] <acrichto> I figured I'd leave the complete removal for later
[17:59:53] <acrichto> at least let this bake for awhile
[18:00:04] <acrichto> you can build with --cfg nofmt to start transitioning all your code
[18:00:18] * cmr includes that in twir
[18:02:12] <engla> well then I think 11 lines is a small price
[18:02:30] <engla> oh neat
[18:03:08] <engla> acrichto: if you really wanted to push the line count down, I bet you could just put a guilt comment on every PR and we will start the golfing
[18:03:39] <acrichto> create a bot that say, "wow, another N lines? I guess bors will just keep working harder..."
[18:03:43] <tjc> haha
[18:03:47] <acrichto> @passive_aggressive_bors
[18:05:22] <nmatsakis> acrichto: you should definitely remove fmt! completely, or at least make a warning or lint or something, or I promise you more users will crop up
[18:05:30] <cmr> yeah
[18:05:33] <acrichto> nmatsakis: it's turned off by default for rustc
[18:05:37] <nmatsakis> k
[18:05:41] <acrichto> turned on by default for everyone else though
[18:05:49] <acrichto> although I could switch it to --cfg fmt instead of --cfg nofmt
[18:11:18] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:25:22] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[18:26:19] <vadimcn> brson: I'd be happy to look into bundling mingw dlls into snapshot0 and installer if that's what you want to do.    The alternative is, of course, to get rid of gcc dependency alltogether.   I believe @strcat and @cmr were looking into that recently.
[18:27:04] <vadimcn> brson: Is there a consensus among the core team about which way you want to go?
[18:27:28] <cmr> vadimcn: bundling is the way to go right now I think
[18:28:41] <vadimcn> cmr: okay
[18:29:20] <brson> vadimcn: i think we want to bundle, yes. how do you get rid of the gcc dependency? which libs do we need to link to?
[18:32:02] <vadimcn> brson: by using clang runtime libs, presumably.   That would remove runtime dependency.   Rust build would still depend on g++ for invoking linker, though.
[18:32:57] <brson> which libstdc++ do we link to currently?
[18:34:26] <vadimcn> gcc's
[18:36:32] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:38:12] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[18:38:12] *** ChanServ sets mode: +o pnkfelix
[18:39:44] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[18:39:44] <ghrust> 01[13rust01] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/dRMatA
[18:39:44] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[18:41:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[18:41:38] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 1418c74c4 to 14f0ea31a: 02http://git.io/k471pw
[18:41:38] <ghrust> 13rust/06try 14f0ea31a 15Tim Chevalier: Try un-xfailing unit-like-struct-drop-run on Windows
[18:41:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[18:42:03] <acrichto> man these bots are really getting worked today
[18:42:27] <tjc> bots gotta earn their keep
[18:42:38] <acrichto> or brson is cold today
[18:43:38] <tjc> haha
[18:43:46] <tjc> they have been turning up the AC pretty high
[18:45:49] <strcat> brson: we can drop the mingw deps by using the LLVM libs
[18:46:07] <strcat> compiler-rt replaces libgcc, libc++abi for unwinding support, etc.
[18:47:17] <strcat> although I don't think lld is solid enough... so we would still need a linker and a linker driver (like libclang)
[18:47:29] <strcat> maybe we could get libclang to handle the ABI stuff for us to make it worth having
[18:47:30] <cmr> strcat: I'll be experimenting with lld today/tomorrow
[18:48:51] <brson> strcat: even if we purge all c++ frum rust, llvm still needs a c++ to link against
[18:49:28] <strcat> brson: true, but it could be libc++
[18:49:57] <strcat> and we could ship it ourselves in the snapshot + add a configure switch to use an external one for the actual build
[18:50:18] <strcat> it's only a 755KiB .so
[18:50:22] <brson> sounds plausible
[18:50:26] <strcat> and we'd statically link it to llvm so it'd be smaller
[18:50:49] <vadimcn> strcat: btw, I checked libc++abi source and I don't see where _Unwind_RaiseException would be defined
[18:51:28] <vadimcn> strcat: I only found a comment that it is provided by "the system unwind library"
[18:52:49] <cmr> libunwind provides it.
[18:52:52] <strcat>     68: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _Unwind_RaiseException
[18:52:55] <strcat> it's in libc++abi
[18:53:04] <strcat> it's not in libc++
[18:53:29] <strcat> libc++ lets you pick one of 3 C++ exception ABI libraries (libc++abi, libsupc++, libcxxrt)
[18:54:25] <cmr> strcat: libc++abi doesn't define it.
[18:54:55] <vadimcn> cmr: libunwind is not supported on Windows as far as I know
[18:55:36] <strcat> cmr: so why is there a symbol? ;p
[18:55:51] <vadimcn> strcat: I am looking at libc++abi.  specifically cxa_exception.cpp
[18:56:06] <strcat> I'm looking at the compiled binary
[18:56:07] <cmr> strcat: notice it's UND: undefined
[18:56:12] <vadimcn> strcat: is that a definition or a reference?
[18:56:25] <strcat> ah
[18:56:41] <vadimcn> apparently libsystem does exist but only on macos
[18:57:25] <strcat> so it's useless for us on windows? or does it link to a system dll
[18:57:51] <vadimcn> useless unless you link to libgcc
[18:58:16] <strcat> not in compiler-rt either? :s
[18:58:54] <vadimcn> no, not in compiler-rt
[18:59:46] <vadimcn> Are there any license limitations?    rustrt could link to libgcc statically...
[19:00:26] <vadimcn> would have to add code to deal with unwind table registration, but that's not too much code
[19:01:40] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[19:01:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_AflSQ
[19:01:40] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[19:05:43] <cmr> http://msdn.microsoft.com/en-us/library/windows/desktop/ms680552%28v=vs.85%29.aspx
[19:05:59] <cmr> Is that usable?
[19:06:34] <vadimcn> That's for Windows SEH exceptions
[19:06:54] <vadimcn> For win32 we need DWARF unwinder
[19:08:46] <cmr> Wait, if we use DWARF anyway, can't we use libunwind?
[19:11:36] *** Quits: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net) (Ping timeout)
[19:12:48] <vadimcn> libunwind not ported to Windows yet (AFAIK)
[19:13:03] <cmr> right but if we're using dwarf it should be trivial to port.
[19:14:06] <vadimcn> linking to libgcc is easier yet
[19:14:18] <vadimcn> depends on what we want to achieve
[19:14:35] <acrichto> cmr: you had mentioned you wanted to look into generating rustdoc from json and from crates, I'm looking into both currently (just fyi)
[19:14:45] <cmr> acrichto: alright, cool
[19:14:58] <cmr> I love it when you do work for me :p
[19:15:42] <acrichto> :D
[19:21:26] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Quit: lol usernames)
[19:22:09] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[19:23:18] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[19:23:25] <vadimcn> cmr: Looks like somebody tried windows port: http://lists.nongnu.org/archive/cgi-bin/namazu.cgi?query=windows&submit=Search!&idxname=libunwind-devel&max=20&result=normal&sort=score
[19:24:14] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (NickServ (GHOST command used by stevekla1nik))
[19:24:19] *** stevekla1nik is now known as steveklabnik
[19:24:30] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[19:25:29] <vadimcn> cmr: but since that "aux" folder is still there, I conclude that he abandoned the effort
[19:26:27] <tjc> So in general, if I see a message like "dyld: lazy symbol binding failed: Symbol not found: __ZN7context12BuildContext16add_library_path21h223abc43c0545db6o7aa11v0.9$x2dpreE" when i try to run a rustc-compiled executable...
[19:26:31] <tjc> what does that mean?
[19:26:46] <tjc> I looked at the rpaths and they point to a library that should define that method
[19:31:52] <Eridius> dammit, buildbot console has already pushed off my try build from last night. How can I find it?
[19:33:11] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:33:11] <ghrust> 01[13rust01] 15catamorphism 04force-pushed 06try from 14f0ea31a to 145592df8: 02http://git.io/k471pw
[19:33:11] <ghrust> 13rust/06try 145592df8 15Tim Chevalier: Try un-xfailing unit-like-struct-drop-run on Windows
[19:33:11] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:35:07] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Client exited)
[19:39:59] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[19:40:29] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[19:41:53] <acrichto> engla: why can't 9634 be replaced with the identity function?
[19:41:53] <tjc> well, I figured that out, FWIW
[19:42:03] <tjc> (my link error above)
[19:42:16] <tjc> it's what happens if you call a method that's defined in a private module in another crate
[19:42:23] <tjc> that should be a compile-time error, so I'm filing a bug
[19:42:33] <engla> acrichto: because of all the iterator adaptors which are methods called by `self` (by value)
[19:42:51] <engla> self by value is great, it means that  range(0, 5).take(2) is its own object that can be returned
[19:43:26] <acrichto> fn by_ref<'a>(&'a mut self) -> &'a mut Self { self } ?
[19:43:58] <engla> it needs to return something that implements Iterator
[19:44:04] <engla> &mut Self doesn't
[19:44:29] <acrichto> it's unfortunate b/c it's just *one more* hack around lifetimes/references
[19:44:49] <Eridius> what happens if you impl<T, I: Iterator<T>> Iterator<T> for &mut I?
[19:44:53] <engla> I'm not sure if it's a hack
[19:45:03] <Eridius> or is that just non-workable?
[19:45:16] <engla> Eridius: I'm not sure if it works. I imagine it to be confusing
[19:45:22] <Eridius> there's probably issues with it
[19:46:10] <engla> .by_ref() is just my idea how to allow both by-ref adaptors (by some considered to be the expected default) and by-value adaptors
[19:47:18] <acrichto> is there a reason for all adaptors to not be by-vaule?
[19:47:36] <engla> they are by value
[19:47:39] <strcat> acrichto: because if they took references, you couldn't return an iterator
[19:47:55] <strcat> rusti: range(3, 5).map(|x| x * 2)
[19:47:55] -rusti- std::iter::Map<,int,int,std::iter::Range<int>>{iter: std::iter::Range<int>{state: 3, stop: 5, one: 1}, f: fn(int) -> int}
[19:47:56] <strcat> like that
[19:48:04] <strcat> well, bad example since our closures suck
[19:48:06] <acrichto> if they're all by value why do we want referenes?
[19:48:16] <engla> that closure is fine to return
[19:48:24] <strcat> acrichto: sometimes you want to use the iterator again
[19:48:28] <engla> acrichto: see the example in the PR
[19:48:57] <acrichto> hm it's not as bad as I thought then
[19:49:29] <acrichto> it may need all the other fancy iterator stuff though, ExactSize, delegating size_hint(), maybe RandomAccess?
[19:49:45] <Eridius> oh good, try-linux passed the latest path2 build. Windows still fails :/
[19:49:50] <engla> acrichto: that's blocked on the other issue I filed
[19:50:03] <engla> acrichto: https://github.com/mozilla/rust/issues/9629
[19:50:10] <Eridius> goddammit! Fails in the same method! Because I obviously can't code types properly
[19:50:52] <acrichto> engla: that just blocks size_hint though,right?
[19:51:08] <engla> acrichto: and RAI, but that part I consider experimental anyway
[19:51:11] <Eridius> could someone push this to try? https://github.com/kballard/rust/commit/451bd9d6654cc6d0915b06bb44579ad44c1f55c2
[19:51:36] <acrichto> Eridius: done
[19:51:36] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[19:51:36] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 145592df8 to 14451bd9d: 02http://git.io/k471pw
[19:51:36] <ghrust> 13rust/06try 14d8f8114 15Kevin Ballard: Initial sketching out of the new path module...
[19:51:36] <ghrust> 13rust/06try 144bfd0b8 15Kevin Ballard: path2: Implement PosixPath
[19:51:37] <ghrust> 13rust/06try 14cd75a18 15Kevin Ballard: path2: Start reimplementing in terms of ~[u8] instead of ~str...
[19:51:39] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[19:51:45] <Eridius> thanks
[19:54:34] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[19:55:51] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:56:08] <engla> it could be called a hack, but say we have the adaptor take:   fn take(self) -> Take<Self>.  What's the best way to call it either with self = Range<int>  or self = &mut Range<int> ?
[19:56:44] <engla> What's the best syntax to allow the user both, since you could call (maybe) both Range and &mut Range iterators
[19:57:12] <Eridius> a different approach I've seen others take is add the ability to unwrap iterators
[19:57:13] <acrichto> engla: yeah no sorry I thought that there was a mixture of &mut/self for all the adaptors, but if they're all self then I think that this makes sense
[19:57:31] <acrichto> engla: what happens if you impl Iterator for &mut Iterator ?
[19:57:50] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[19:59:06] <Eridius> std::rt::io::Decorator
[19:59:32] <Eridius> of course using this with iterator adaptors requires the adaptors to all implement it
[19:59:46] <Eridius> and e.g. Zip can't (though Zip could of course implement custom methods .inner_left() and .inner_right())
[19:59:55] <Eridius> (or maybe just have .inner() return (left, right), which makes more sense)
[20:00:04] <engla> acrichto: I'm trying now, but I didn't get very far, because the method resolve bug shows up again
[20:00:17] <acrichto> engla: I figured that'd happen :(
[20:00:55] <Eridius> oh crud, windows build still fails
[20:01:30] <acrichto> engla: oh hm, looking at the documentation it appears that nth/last/fold/len/all/any/find/position/count/max_by/min_by all take by-ref self
[20:01:40] <acrichto> and the other half all take self by-vaule
[20:02:09] <engla> they are not adaptors, they are methods
[20:02:19] <engla> they return a value that's not an iterator
[20:02:22] <engla> for example fold
[20:02:24] <strcat> any idea how I would get the size of a type in ty.rs? it seems wrong to depend on trans there
[20:02:32] <strcat> dunno if there's an LLVM context yet
[20:02:36] <acrichto> engla: but most of them still consume the entire iterator?
[20:02:50] <engla> acrichto: yes
[20:02:58] <Eridius> acrichto: could you push this one? https://github.com/kballard/rust/commit/11d2225c122af474fe3932e45d1c5c6e9ea9fe6c
[20:03:09] <acrichto> Eridius: do you want the previous one cancelled?
[20:03:12] <Eridius> yes
[20:03:24] <Eridius> I only care about the windows build right now. The others passed the last attempt
[20:04:44] <engla> acrichto: &mut self  methods are callable on iterators that you can't move out, but are mutable. So that's another way .by_ref() can be used
[20:04:47] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:04:47] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14451bd9d to 1411d2225: 02http://git.io/k471pw
[20:04:47] <ghrust> 13rust/06try 1411d2225 15Kevin Ballard: path2: Fix some linux/windows issues
[20:04:47] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:04:56] <Eridius> thanks
[20:06:15] <acrichto> Eridius: I'm cancelling the mac/linux try builds
[20:06:19] <Eridius> ok
[20:16:46] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[20:20:07] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:24:36] <Luqman> tjc: tests::test_rustpkg_test_output failed on the linux snapshot builder last night. does rustpkg have intermittent failures?
[20:24:52] <tjc> Luqman: It shouldn't
[20:25:22] <tjc> Luqman: I'll look at it
[20:25:30] <Luqman> the same commit passed fine since it got successfully merged into master
[20:26:43] <tjc> Luqman: if you want to #[ignore] it for now, that's fine
[20:27:23] <Luqman> hmm ok, i'll give it a try again later
[20:28:55] <acrichto> Luqman: I restarted a snapshot build
[20:29:15] <acrichto> looks like it failed on the same test though
[20:30:02] <Luqman> maybe there's something different in the snapshot environment than the other buildbots?
[20:30:32] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:33:53] <acrichto> tjc: oh that's a good point, it's got RUST_THREADS=1 so the test output may have colors 
[20:34:09] <acrichto> task '<unnamed>' failed at 'assertion failed: output_str.contains("test f ... ok")',
[20:34:26] <tjc> ohhhh
[20:34:28] <acrichto> it wouldn't contain that literal strings b/c it's be something like test f ... [32mok(B[m
[20:34:42] <tjc> ok, I'll change it to test for "test f" and "ok"
[20:34:47] <acrichto> cool
[20:36:32] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:36:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/sx3BpQ
[20:36:32] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:36:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[20:36:36] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JRHnfw
[20:36:36] <ghrust> 13rust/06auto 1460eb04a 15Tim Chevalier: testsuite: Un-xfail unit-like-struct-drop-run on Windows...
[20:36:36] <ghrust> 13rust/06auto 145c01685 15bors: auto merge of #9635 : catamorphism/rust/issue-7999, r=catamorphism...
[20:36:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[20:37:27] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[20:38:23] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:38:23] *** ChanServ sets mode: +o pnkfelix
[20:42:47] <Eridius> woohoo, windows compiles. now on to testing
[20:47:03] <acrichto> the privacy changes caught an actual bug!
[20:47:12] <acrichto> now I just have no idea how to fix it
[20:47:19] <Eridius> :O
[20:47:29] <Eridius> nooooooooo test failure
[20:47:40] <Eridius> goddamn glob tests
[20:48:03] <acrichto> *coverage* tests :)
[21:23:10] <Eridius> ah hah, found the windows issue
[21:23:24] <Eridius> it was only treating \ as a component separator for glob patterns
[21:23:55] <Eridius> acrichto: could I ask you to once again push https://github.com/kballard/rust/commit/5808ed171c43baa43b23f4ada5d4f82b51872062 to try (and cancel non-windows builds)?
[21:24:34] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:24:34] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 1411d2225 to 145808ed1: 02http://git.io/k471pw
[21:24:34] <ghrust> 13rust/06try 145808ed1 15Kevin Ballard: path2: Fix some linux/windows issues
[21:24:34] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:24:41] <Eridius> thanks
[21:24:44] <acrichto> np
[21:32:10] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[21:32:15] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[21:32:15] *** ChanServ sets mode: +o pnkfelix
[21:55:51] <acrichto> strcat: r? https://github.com/mozilla/rust/pull/9628
[21:56:23] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[21:56:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JRHnfw
[21:56:23] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[21:57:32] <strcat> acrichto: does mingw have 'file'?
[21:57:53] <acrichto> dunno
[21:59:35] <strcat> I guess it'd be far too slow to do it without using libmagic anyway
[22:00:24] <strcat> oh well we can make it better later
[22:01:38] <acrichto> privacy changes, bootstrapped all the way through libstd and libextra
[22:06:24] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:06:24] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/kT9puw
[22:06:24] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:06:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[22:06:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rJjjVw
[22:06:29] <ghrust> 13rust/06auto 14d29b3ac 15Alex Crichton: Expand tidy to prevent binaries from being checked...
[22:06:29] <ghrust> 13rust/06auto 147ddcd2a 15bors: auto merge of #9628 : alexcrichton/rust/tidy-binaries, r=thestinger...
[22:06:30] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[22:26:48] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[22:29:39] *** Joins: Luqman (laden@moz-345B5EBA.csclub.uwaterloo.ca)
[22:30:22] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:33:35] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[22:33:35] *** ChanServ sets mode: +o tjc
[22:34:10] *** Quits: Luqman (laden@moz-345B5EBA.csclub.uwaterloo.ca) (Quit: leaving)
[22:34:19] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[22:37:25] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[22:39:36] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[22:39:42] <Eridius> damn, really? I fixed what I thought was the issue with test_matches path, but that still fails and the other two test failures are fixed! grr
[22:39:47] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[22:40:28] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:40:39] <Eridius> oddly the assertion failure is in extra::flatpipes
[22:50:19] <Eridius> ah hah, found it
[22:50:29] <Eridius> there was another case of path::windows::is_sep() that needed to be is_sep2
[22:50:42] <strcat> rustc: /home/strcat/projects/rust/src/llvm/include/llvm/IR/Instructions.h:970: llvm::ICmpInst::ICmpInst(llvm::CmpInst::Predicate, llvm::Value*, llvm::Value*, const llvm::Twine&): Assertion `getOperand(0)->getType() == getOperand(1)->getType() && "Both operands to ICmp instruction are not of the same type!"' failed.
[22:50:44] <strcat> :s
[22:51:05] <Eridius> strcat: can you push https://github.com/kballard/rust/commit/4bd174934cad61b20379a5d12e4eb1a671dbf7d4 to try (and cancel the non-windows builds)?
[22:51:10] <strcat> Eridius: okay
[22:51:14] <Eridius> thanks
[22:51:35] <Eridius> this should fix libextra::glob. Now I'm just hoping rustpkg behaves properly on Windows
[22:51:54] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[22:51:54] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 145808ed1 to 144bd1749: 02http://git.io/k471pw
[22:51:54] <ghrust> 13rust/06try 144bd1749 15Kevin Ballard: path2: Fix some linux/windows issues
[22:51:54] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[22:51:59] <Eridius> danke
[22:52:17] <strcat> hm actually maybe cancelling them won't work
[22:52:25] <strcat> I forget if auto-cancelling the other builds applies to try
[22:52:43] <Eridius> acrichto cancelled the other builds on a previous try
[22:56:39] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[23:00:54] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[23:00:54] *** ChanServ sets mode: +o tjc
[23:05:55] <acrichto> sfackler: I'm so glad you wrote BufferedWriter, that took libstd rendering time for rustdoc from 12s to 0.1s
[23:06:27] <dbaupp> are we done to 0.1s for rustdoc?
[23:06:31] <dbaupp> or is that not the total time?
[23:06:42] <acrichto> ~0.8s from libstd if you start from doc.json
[23:06:58] <dbaupp> cool, pretty fast :)
[23:07:01] <acrichto> 0.1s for writing all the source files (not parallelized at all and easily could be)
[23:07:14] <acrichto> 0.4s for generating documentation from the entire crate
[23:07:26] <acrichto> down from 0.9s to 0.4s when parallelized 10x
[23:07:31] <strcat> acrichto: probably don't really want to bother with parallel writing
[23:07:47] <strcat> writes don't really block to a local filesystem
[23:07:47] <acrichto> the crate was for markdown initially
[23:07:56] <strcat> since it has write buffers
[23:08:00] <acrichto> markdown got way faster now though, and I just left in the parallelization
[23:08:59] <acrichto> yeah I don't think write! is really feasible unless it uses a BufferedWriter
[23:09:42] <strcat> it'll work fine to in-memory writers without it ;p
[23:10:06] <acrichto> oh yeah it definitely shouldn't wrap in a BufferedWriter for you I think
[23:10:06] <strcat> or mmap
[23:10:13] <acrichto> especially b/c BufferedWriter has a 64k buffer
[23:10:20] <strcat> acrichto: well, buffering in the language is only useful to avoid syscalls
[23:10:26] <strcat> if you mmap a file, you don't want buffers
[23:10:30] <acrichto> exactly
[23:11:09] <strcat> meh
[23:11:15] <strcat> lots of our code assumes things aren't immediate
[23:11:25] <acrichto> immediate?
[23:11:52] <strcat> type_is_immediate returns true -> it gets passed/returned directly by-value, when you pass/return by-value
[23:11:58] <strcat> otherwise it uses pointer indirection
[23:12:12] <strcat> atm it's very dumb and too much stuff is not immediate
[23:12:18] <acrichto> lik what?
[23:12:30] <strcat> like a 1-word (or less) struct/enum is never immediate
[23:12:33] <strcat> even C-like enums
[23:12:36] <acrichto> whoa
[23:12:41] <acrichto> I thought those were explicitly
[23:12:47] <strcat> nope
[23:12:50] <acrichto> wow
[23:12:50] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[23:12:52] <strcat> only newtype structs of immediates
[23:12:58] <strcat> are currently immediate
[23:13:00] <acrichto> oh that's a little better
[23:13:02] <acrichto> but not by much
[23:13:11] <strcat> (int,) is returned via an out ptr
[23:13:13] <strcat> it sucks ;p
[23:13:38] <strcat> anyway I fixed it but I caused a bunch of asserts due to code assuming stuff about what is immediate...
[23:13:41] <acrichto> dbaupp: do I have a rubber stamp from you on https://github.com/mozilla/rust/pull/9599 for when it's mergeable?
[23:14:29] <dbaupp> acrichto: definitely
[23:14:37] <acrichto> woohoo!
[23:15:46] <Luqman> strcat: i remember back when we were changing newtype structs to be immediate we also wanted to do it with similar structs but ran into llvm asserts
[23:16:24] <strcat>     let llty = sizing_type_of(ccx, ty);
[23:16:27] <strcat>     llsize_of(ccx, llty) <= llsize_of(ccx, ccx.int_type)
[23:16:28] <strcat> I made it that atm
[23:16:34] <strcat> and plan on increasing it to the target's preferred size
[23:16:39] <strcat> first.... fixing these issues
[23:16:45] <acrichto> cmr: it's so nice to be working on rustdoc b/c I can compile with rustc instead of going through 2 stages
[23:17:09] <acrichto> strcat: when is the preferred size larger than int?
[23:17:28] <strcat> acrichto: on x86/x86_64, clang does 2 words this way
[23:17:37] <acrichto> interesting
[23:19:01] <strcat> this is just one of 50-100 things we're doing wrong ;p
[23:19:05] *** Joins: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP)
[23:19:13] <strcat> but each one is a nice perf improvement in edge cases
[23:19:20] <strcat> fixing them, I mean
[23:36:21] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[23:36:21] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rJjjVw
[23:36:21] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[23:41:02] <strcat> wtf
[23:41:19] <strcat> I think sizing_type_of might just be broken
[23:43:22] <acrichto> nmatsakis: are there plans to detect moves out of separate fields of a struct and allow them?
[23:43:41] <strcat> can always just deconstruct it all at once
[23:44:03] <acrichto> oh hm maybe I'll do that
[23:44:31] <acrichto> yes, that is exactly what I wanted
[23:48:05] <strcat> my type_is_immediate check apparently isn't working
[23:48:10] <strcat> it's non-deterministic ;\
[23:48:29] <acrichto> there was an email about deterministic builds recently...
[23:48:30] <acrichto> :P
[23:49:18] <strcat> really wtf
[23:49:23] <strcat> all it does is check the size
[23:49:33] <strcat> :s
[23:49:44] <cmr> ...heh
[23:50:19] <strcat> it's sometimes randomly adding an out pointer for functions without a return value...
[23:50:28] <strcat> and I really do mean randomly
[23:50:31] <strcat> different every time
[23:50:42] <strcat> is the size of nil... random? :\
[23:52:42] <acrichto> argh someone correctly removed doc-blocks from all impls
[23:52:47] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[23:52:49] <acrichto> now I have to go make my own to test this :(
[23:53:03] <strcat> hrm?
[23:53:14] <acrichto> /// dox\n impl A {}
[23:53:17] <acrichto> dox is completely hidden
[23:53:31] <acrichto> but I made a change to surface it, it's just that there are no examples in libstd :(
[23:53:36] <strcat> isn't that a rustdoc deficiency?
[23:53:39] <acrichto> yeah
[23:53:43] <acrichto> that's what I'm chaning
[23:53:53] <strcat> so doesn't that mean we lost useful docs that had been written?
[23:53:56] <acrichto> but libstd has already had all impl doc-blocks moved to traits (where they kinda should belong anyway)
[23:54:11] <acrichto> only in the sense that they're not rendered to html
[23:54:12] <strcat> we really don't have any saying extra things in addition to the trait?
[23:54:25] <acrichto> impl<A: Send>
[23:54:29] <acrichto> might need some explanation
[23:54:32] <acrichto> or some trait bound like that
[23:54:43] <Eridius> woohoo, windows tests passed! \o/
[23:54:50] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[23:54:54] <strcat> acrichto: or it might provide guarantees the trait doesn't
[23:54:55] <Eridius> now I need to update to latest master :/
[23:55:14] <strcat> I am 99% sure some of them did that
[23:55:16] <strcat> :s
[23:55:27] <acrichto> strcat: this is just for surfacing the documentation
[23:55:38] <acrichto> if you write dox it's nice for rustdoc to show it somewhere
[23:55:47] <strcat> acrichto: I'm talking about you saying they were removed
[23:55:59] <strcat> I'm sure I've written useful docs on impl methods, like time complexity
[23:56:01] <acrichto> oh no not removed, just moved I think to traits
[23:56:12] <acrichto> I also could just be thinking wrong
[23:56:12] <strcat> how can it be moved to a trait?
[23:56:14] <acrichto> I didn't search very hard
[23:56:26] <acrichto> impl Foo for A {} was often the only implementor of Foo
[23:56:32] <acrichto> and the documentation was better placed on Foo anyway
[23:56:34] <strcat> so, useless traits ;p
[23:56:38] <acrichto> yeah
[23:56:45] <strcat> this is weird
[23:56:50] <strcat> define void @_ZN3foo19hd9b62e97134c38c8ae4v0.0E({ i64, %tydesc*, i8*, i8*, i8 }* nocapture) #0 {
[23:56:53] <strcat> what I expect
[23:56:57] <strcat> define void @_ZN3foo19hd9b62e97134c38c8ae4v0.0E({}* noalias nocapture sret, { i64, %tydesc*, i8*, i8*, i8 }* nocapture) #0 {
[23:57:00] <strcat> what I randomly get sometimes
[23:57:02] <strcat> :s
[23:57:10] <acrichto> what
[23:57:20] <acrichto> that seems... unforunate
[23:57:28] <strcat> don't understand why this happens
[23:57:42] <strcat> it's from my change...
[23:57:48] <brson> anybody doing or done snapshot?
[23:57:49] <strcat> taking the size is for some odd reason non-deterministic
[23:58:17] <strcat> or ccx.int_type doesn't work? :s
[23:58:19] <acrichto> brson: let me check on the one from a few hours agoo
[23:58:26] <cmr> brson: Luqman was working on one
[23:58:43] <acrichto> brson: they're blocked on a fix to a rustpkg test tjc was fixing
[23:58:47] <Luqman> cmr: i tried one last night but a test failed so i went to bed instead
[23:59:10] <tjc> acrichto: I got distracted and forgot about that test, but I was just rebuilding the fix now...
[23:59:16] <tjc> feel free to xfail if you want to make the snapshot sooner
[23:59:20] <tjc> s/xfail/ignore
[23:59:33] <acrichto> brson: I just kinda casually wanted a snapshot, is it urgen enough to xfail in the meantime?
