[00:05:42] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[00:07:05] <Gankro> Wait, I think I have it
[00:09:23] <Gankro> Yesssss
[00:09:33] <Gankro> I just need to add a FakeBorrow type to std::borrow
[00:10:09] <Gankro> https://play.rust-lang.org/?gist=19182de2e611b985619a&version=stable
[00:10:44] <Gankro> (past line 153)
[00:10:54] <Gankro> aturon: How awful would FakeBorrow be to you?
[00:14:54] <aturon> Gankro: the name
[00:15:00] <aturon> Alone scares me
[00:15:06] <aturon> Sorry typing on phone
[00:16:12] <aturon> Gankro: hmm feels pretty hacky. But I need the full context
[00:18:26] <aturon> Gankro: that's going off your earlier gist, play won't load the full code on
[00:18:35] <aturon> My phone :(
[00:19:36] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:22:08] <Gankro> aturon: Need to lie about ToOwned to ditch the Clone bound on Entry
[00:22:19] <Gankro> So FakeBorrow is a "Borrow" that can't ever be realized
[00:22:44] <Gankro> It's so beautiful
[00:22:51] <Gankro> It solves all my problems
[00:23:18] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[00:24:56] <huon> can it be implemented outside std?
[00:25:30] <eternaleye> Gankro: Maybe call it "BorrowSyke" :P
[00:25:40] <eternaleye> Gankro: "Sure, you can borrow this from me... SYKE!"
[00:26:21] <Gankro> ahaha
[00:26:26] <Gankro> huon: No, because coherence
[00:29:31] <eternaleye> Gankro: Anyway, ! really ought to implement every trait
[00:29:48] <eternaleye> Gankro: Since it's coercible to any type
[00:30:05] <aturon> Gankro: ah, figured that's where it was heading. i'd rather do something more principled :P anyway, sorry i wasn't able to help with this today, will get to it in the morning
[00:31:44] <eternaleye> Gankro: So rather than being able to "implement arbitrary traits arbitrarily many times", it should just already count as fulfulling any bound
[00:32:05] <eternaleye> Gankro: Including both !Sized and ?Sized, amusingly
[00:33:55] <Gankro> eternaleye: That probably has troubling consequences in general. Probably.
[00:36:50] <eternaleye> Gankro: No, because the only ways to produce a ! value result in all code dependent on that execution path being unreachable
[00:37:00] <eternaleye> Gankro: So it gets pruned
[00:37:49] <Gankro> Wait
[00:37:51] <Gankro> Fuck
[00:37:56] <Gankro> This doesn't work
[00:38:23] <Gankro> Wait
[00:38:26] <Gankro> Maybe
[00:38:30] <Gankro> With a bit of nudging
[00:39:12] <Gankro> Making this Cow forces the way the Key is borrowed to be via FakeBorrow
[00:39:14] <Gankro> Which panics
[00:39:32] <Gankro> The way the entry API is written this is actually fine
[00:39:54] <Gankro> But it would preclude allowing you to ask about the key in the future (which a lot of people want)
[00:44:01] <Gankro> I just need to make every Entry roll its own impl of Cow
[01:42:00] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[01:42:26] *** Joins: c74d (c74d3a4ebb6@moz-kfb9ol.mggc.hibn.4404.2002.IP)
[02:06:36] <SimonSapin> acrichto: What do you think of having both Ref::map with a &T -> &U closure and Ref::filter_map with a &T -> Option<&U> closure?
[02:07:03] <SimonSapin> kinda similarly to how Iterator has these two methods
[02:21:27] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[02:56:43] *** Quits: zz_kimundi (kimundi@moz-0meql0.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:58:02] *** Joins: zz_kimundi (kimundi@moz-siarqd.dip0.t-ipconnect.de)
[02:58:03] *** zz_kimundi is now known as kimundi
[03:10:02] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[03:37:15] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[03:41:29] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[04:13:12] <acrichto> SimonSapin: yeah that seems pretty nice
[04:24:16] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[04:28:32] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[04:57:57] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[04:59:26] *** Quits: c74d (c74d3a4ebb6@moz-kfb9ol.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[04:59:35] *** c74d3 is now known as c74d
[05:02:33] *** Quits: aatch (james@moz-8r6eer.orns.ubhm.e000.2406.IP) (Connection closed)
[05:18:26] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[05:22:40] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[06:10:34] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[06:12:34] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[06:16:50] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[07:06:42] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[07:10:58] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[07:19:09] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[08:00:52] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[08:05:06] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[08:20:00] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[08:54:59] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[08:59:15] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[09:45:34] *** kimundi is now known as zz_kimundi
[09:49:10] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[09:53:23] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[10:43:18] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[10:47:34] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[11:05:16] *** Joins: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net)
[11:37:29] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[11:41:43] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[11:48:05] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[11:52:30] *** Quits: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net) (Quit: Leaving...)
[11:55:36] *** Joins: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net)
[11:57:11] *** zz_kimundi is now known as kimundi
[12:17:43] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[12:20:20] *** kimundi is now known as zz_kimundi
[12:30:25] *** Quits: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net) (Connection closed)
[12:31:03] *** Joins: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net)
[12:31:39] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[12:35:51] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[13:18:46] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[13:23:06] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Connection closed)
[13:23:20] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[13:24:55] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (A TLS packet with unexpected length was received.)
[13:26:40] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:33:19] *** zz_kimundi is now known as kimundi
[14:58:15] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[14:58:49] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[15:25:26] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[15:44:52] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[16:19:12] *** Joins: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net)
[16:23:05] <SimonSapin> acrichto: re a "cell_extras" feature gate, should Ref::clone be there too?
[16:23:11] *** Joins: brson (brson@moz-48fqub.res.rr.com)
[16:23:11] *** ChanServ sets mode: +qo brson brson
[16:23:13] <acrichto> SimonSapin: yeah
[16:23:17] <acrichto> that was under the 'core' feature before
[16:23:23] <acrichto> but we're trying to not put anything new under that feature
[16:23:26] <acrichto> and slowly bring things out of that
[16:40:59] <SimonSapin> acrichto: "This API looks good to me" refers to map+filter_map, not the generalized_map that doesn’t work, right?
[16:41:07] <acrichto> SimonSapin: yeah
[16:41:18] <acrichto> ah I think that comment snuck in the middle of mine :P
[16:47:04] <SimonSapin> acrichto: Does this look right? #[deprecated(since = "1.2.0", reason = "moved to a `Ref::clone` associated function")]
[16:47:22] <acrichto> SimonSapin: lgtm
[16:50:34] <SimonSapin> updated
[16:54:30] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[17:29:14] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[17:59:30] *** Quits: brson (brson@moz-48fqub.res.rr.com) (Quit: leaving)
[18:03:55] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[18:13:16] <SimonSapin> acrichto: I think it was good to restrict the std::fmt system to Unicode, but it means we don’t support non-Unicode directory names in things like https://github.com/servo/libexpat/pull/4/files
[18:13:47] <acrichto> SimonSapin: that is correct!
[18:14:05] <acrichto> SimonSapin: there are other reasons that using stdout to print file names is limiting to only unicode though
[18:14:06] <SimonSapin> On Unix we could write bytes on stdout directly, but I don’t know how that would work on Windows
[18:14:12] <acrichto> SimonSapin: on windows, for example, we can only print unicode
[18:14:30] <acrichto> all of cargo/rustc will explode very quickly on non-unicode dirs
[18:14:38] <SimonSapin> Is that a Rust limitation or a Windows limitation?
[18:15:13] <SimonSapin> ok
[18:19:58] <steveklabnik> hey #rust-libs, what do you think about my comment here? http://www.reddit.com/r/rust/comments/374zw6/pushing_an_array_into_a_vector/crkgxsf?context=3
[18:20:06] <steveklabnik> are the iterator structs something we should be stabilizing?
[18:28:37] <sfackler> steveklabnik: IIRC Cloned's instability was just an oversight
[18:28:47] <steveklabnik> yeah, thats what i figured
[18:29:12] <sfackler> I thought there was a PR a while ago to stabilize it
[18:29:19] <steveklabnik> hmm
[18:29:22] *** Parts: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net) ("Ex-Chat")
[18:29:36] <steveklabnik> https://github.com/rust-lang/rust/pull/25496
[18:41:35] <bluss> oh we could have had all the iterator structs unstable to allow abstact return types immediately. Maybe a bit too limiting
[18:53:27] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[18:57:39] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[19:09:37] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[19:20:30] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[19:24:47] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[20:14:40] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[20:18:55] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[20:23:43] <SimonSapin> steveklabnik: it seems weird that we can obtain values of unstable types through stable APIs, and surprising that this does not trigger an error
[20:26:41] <steveklabnik> yeah i'm of two minds
[20:28:23] *** Joins: sigma (sigma@moz-k1ghg8.range109-153.btcentralplus.com)
[20:34:26] <bluss> SliceConcatExt is similar
[20:34:39] <bluss> it's in the prelude, the methods are stable, but you can't say the trait's name
[20:34:49] <bluss> which was intentional
[20:34:58] <bluss> Maybe it even got stabilized by now (after 1.0)
[20:40:22] <sfackler> still unstable but the change made in the instability description from the 1.0 version has been made
[20:44:05] *** Quits: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net) (Connection closed)
[20:44:30] *** Joins: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net)
[20:52:35] *** Quits: sigma (sigma@moz-k1ghg8.range109-153.btcentralplus.com) (Ping timeout: 121 seconds)
[20:52:35] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[21:08:48] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[21:13:04] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[21:35:07] *** kimundi is now known as zz_kimundi
[21:36:08] *** zz_kimundi is now known as kimundi
[22:00:59] <bluss> I think BinaryHeap has caused enough trouble with it's non exception safe code
[22:01:09] <bluss> well according to acrichto it's broken at least
[22:01:58] <bluss> I'm looking to fix it. Two immediate ways  A) Use PPYP and set vector length to zero temporarily. Panicing in comparison functions will leak all elements in the heap  B) Use more swaps
[22:02:19] <bluss> Gankro: ^ it's totally a thing
[22:02:47] <Gankro> haha
[22:03:00] <Gankro> I thought this was already fixed... -.-
[22:03:15] <bluss> hey it's even still using zeroed(), not dropped(), no idea why
[22:03:28] <Gankro> wasn't cmr looking at this...
[22:03:39] * Gankro can't remember anymore
[22:04:06] <bluss> idea: create a location in the issue tracker for this
[22:04:12] <bluss> I think that's a thing too
[22:06:16] <Gankro> I thought cmr and I hashed out a really elegant fix to this
[22:06:33] <bluss> he gets a cc
[22:08:14] <bluss> gh25842
[22:08:19] <bluss> https://github.com/rust-lang/rust/issues/25842
[22:09:19] <Gankro> bluss: found it!
[22:09:53] <Gankro> My plan was to build a panic guard that puts the "floating" value back in the "uninit" spot on panic.
[22:10:05] <bluss> ah ok nice
[22:10:31] <Gankro> bluss: https://botbot.me/mozilla/rust-internals/2015-03-24/?msg=34945483&page=6 (and a bit after)
[22:10:46] <bluss> thanks a ton
[22:11:29] <bluss> ah, so it was *you*
[22:12:09] <bluss> Gankro: should I try?
[22:12:53] <bluss> oh you said "cmr and I" from the start, my confusion
[22:13:23] <Gankro> bluss: Yeah go for it!
[22:13:30] <Gankro> I'd be super interested to see the perf impact
[22:14:13] <bluss> hm do you know offhand a simple way to bench it without reboostrapping a whole stage?
[22:16:52] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[22:18:22] <bluss> ah I'll just extract the methods
[22:18:41] <Gankro> bluss: eh, yeah I tend to just rip code out of std to test stuff
[22:18:54] <Gankro> I've gotten quite profficient at de-std'ing code :P
[22:19:33] *** Quits: o11c (ben@moz-9bd9kh.customer.t3.se) (Connection closed)
[22:19:49] <bluss> from_vec exercises both sift up and sift down so I'm going to focus on that
[22:22:48] <Gankro> acrichto: Should I be able to fiddle with tags or whatever on /rfcs?
[22:23:38] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:27:04] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[22:32:14] <acrichto> Gankro: hm I dunno how github permissions work there
[22:32:23] <acrichto> Gankro: I take it you can't though?
[22:32:29] <Gankro> Yeah
[22:33:07] <steveklabnik> you need commit
[22:33:10] <acrichto> hm for now I'd just add a comment saying some tag should be added
[22:33:11] <acrichto> ah
[22:33:12] <steveklabnik> to do issue changes
[22:35:07] *** Quits: JustAPerson (JustAPerson@moz-un628q.moe) (Ping timeout: 121 seconds)
[22:38:35] *** Joins: JustAPerson (JustAPerson@moz-un628q.moe)
[22:46:47] *** Quits: JustAPerson (JustAPerson@moz-un628q.moe) (Ping timeout: 121 seconds)
[23:07:35] *** Joins: JustAPerson (JustAPerson@moz-un628q.moe)
[23:08:16] *** Joins: o11c (ben@moz-9bd9kh.customer.t3.se)
[23:16:42] *** kimundi is now known as zz_kimundi
[23:30:13] <cmr> Gankro: yeah, you got it right.
[23:30:43] <Gankro> cmr: Did you ever end up trying in of those strategies...?
[23:37:14] <bluss> this is turning out relatively nice
[23:39:14] <bluss> optimizing compilers are worst. In one method, trivial accessor .pos() is better, in the other, accessing field. pos is better
[23:54:57] <WindowsBunny> Gankro: Is this channel the channel the libs subteam uses?
[23:57:33] <cmr> Gankro: lolno.
[23:57:43] <cmr> WindowsBunny: I hope so.
[23:57:45] <Gankro> WindowsBunny: yep
[23:58:14] <WindowsBunny> neat
[23:59:31] <Gankro> WindowsBunny: WELCOME TO THE LIBS OF TOMORROW
[23:59:49] <aturon> acrichto: oh hm, the subteam members should all have rights on the rfc repos
