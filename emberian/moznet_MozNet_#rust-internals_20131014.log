[00:03:36] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:08:55] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffb)
[00:19:56] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[00:22:25] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[00:35:21] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[00:36:28] <eddyb> I'm in the process of making the testcase here (ignore the other files) work: https://gist.github.com/eddyb/aac212991118712b20df#file-test-rs
[00:37:53] <eddyb> currently rustc is conservative and doesn't recognize the constraint modifier = (write-only) http://gcc.gnu.org/onlinedocs/gcc/Modifiers.html
[00:39:03] <eddyb> I'm almost there, but I have to go :(
[00:39:59] <eddyb> aatch: it kinda works, and the inline asm become initialization, so I get variable does not need to be mutable, #[warn(unused_mut)] on by default :D
[00:40:02] <eddyb> good night
[00:40:34] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Quit: Konversation terminated!)
[00:40:50] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[00:41:50] *** Joins: eddyb9 (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[00:42:22] <eddyb9> aatch: this got me hacking on rust until 4am, and the slow compilation didn't help :(
[00:42:56] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[00:43:33] <eddyb9> I'll fix the (hopefully) last problem (a LLVM cast error) and I'll make a pullreq tomorrow (actually today)
[00:43:51] <aatch> eddyb9, yeah. I know. In the mutable case, it's probably actually correct, since initialization doesn't require it to be mutable
[00:44:10] <aatch> rusti: let a : int; a = 1; a
[00:44:11] -rusti- 1
[00:44:17] <aatch> rusti: let mut a : int; a = 1; a
[00:44:18] -rusti- 1
[00:45:34] <eddyb9> yupp, that's all fine, it would have fully compiled if it weren't for the LLVM error (most likely a side-effect of removing the use of ExprAddrOf)
[00:45:52] <eddyb9> but I have to wake up in two hours, so that's that
[00:46:37] <eddyb9> aatch: not sure what to do about tests, this is very easy to break by ignoring it in a checker
[00:54:41] <eddyb9> rusti: asm!("in $1, $0" : "={ax}" : "{dx}" (0u16)) as u32
[00:54:43] -rusti- pastebinned 7 lines of output: http://ix.io/8sQ
[00:56:06] <eddyb9> not sure how many uses it would have, but I'm tempted to add that (outputs with just a constraint and no referenced are put in a tuple)
[00:59:13] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[01:15:03] *** Quits: tikue3 (tikue_star@3DC9855F.F3E8A984.689607DE.IP) (Client exited)
[01:25:11] *** Joins: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP)
[01:32:27] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[01:35:58] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[01:44:43] <cmr> acrichto: are you working on killing oldio?
[01:45:00] <cmr> The fact that extra::serialize still works with it is seriously ruining my day :p
[01:45:17] <acrichto> cmr: slowly, it's almost gone from extra::json
[01:45:21] <acrichto> extra::flatpipes is annoying
[01:45:27] <acrichto> and extra::ebml is looking almost impossible right now
[01:45:44] <cmr> mm
[02:06:26] <sfackler> acrichto: how do you feel about hiding private fields in rustdoc output?
[02:10:00] <acrichto> sfackler: I'm ok with doing so, but I think that there should still be an indicator that there are some hidden private fields, just so yo don't think that the struct is empty
[02:10:57] <sfackler> yeah, godoc puts "// private fields omitted" in
[02:11:25] <acrichto> I personally kinda like that, but I don't have strong feelings
[02:14:38] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[02:18:07] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffb)
[02:19:04] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[02:27:45] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[02:27:55] *** Quits: zz_kimundi (kimundi@moz-5EF96D6C.dip0.t-ipconnect.de) (Ping timeout)
[02:31:15] *** Joins: zz_kimundi (kimundi@moz-2FF9FB9A.dip0.t-ipconnect.de)
[02:31:16] *** zz_kimundi is now known as kimundi
[02:37:07] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[02:51:09] <klutzy> acrichto: is it intentional that begin_unwind() doesn't have #[no_split_stack]?
[02:52:14] <klutzy> since it is called by rust_stack_exhausted() which has the attr
[03:06:59] *** Joins: dbaupp (Thunderbir@299A223E.D5A1DCF.37681C44.IP)
[03:10:03] <sfackler> acrichto: would you rather the private field/variant stripping happen at render time or as part of the strip_private pass? If it's part of the pass, I'll have to add a field to clean::{Struct, VariantStruct, Enum} to tell it that fields/variants were stripped
[03:10:37] <cmr> sfackler: render
[03:11:22] <cmr> I want a "Developer mode" wherein all private things are rendered.
[03:11:58] <sfackler> cmr: that'd be easier to do if it's handled in strip_private since you can just disable that pass for dev mode docs
[03:12:18] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[03:12:33] <cmr> But then you can't use that same JSON to generate both dev and normal docs
[03:13:33] <sfackler> you can't do that now, since private variants, modules, structs, traits, etc are already stripped in strip_private
[03:14:06] <sfackler> it seems like the solution there would be to allow passes to run over json input
[03:14:15] <cmr> Mmm, good idea.
[03:14:22] <sfackler> so you'd generate the json without strip_private and then run that pass for the public api docs
[03:58:39] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffb)
[03:59:19] *** Quits: dbaupp (Thunderbir@299A223E.D5A1DCF.37681C44.IP) (Ping timeout)
[04:03:10] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[04:28:55] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[04:35:02] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[04:36:00] *** Quits: eddyb9 (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Quit: Leaving)
[04:42:19] *** Quits: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP) (Ping timeout)
[04:50:12] *** Quits: doomlord_ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Ping timeout)
[04:50:49] *** Joins: doomlord_ (servitor@moz-6732E9D4.range86-184.btcentralplus.com)
[04:51:54] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[04:57:47] *** Joins: isenmann (isenmann@moz-B656BA79.science-computing.de)
[05:11:02] *** Joins: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP)
[05:16:48] *** Quits: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP) (Ping timeout)
[05:20:57] <acrichto> klutzy: yes, it's unreasonable to have the requirement that *everything* called from rust_stack_exhausted have #[no_split_stack], so that's why it raises the limit by 10k and then continues
[05:21:24] <acrichto> in theory we'll "quickly" start unwinding, but up until that point there's actually a fair amount of code that needs to run, basically anything other than an FFI call
[05:22:24] <acrichto> sfackler: strip_private should handle it
[05:22:43] <acrichto> I also think a sentinel "fields removed" would be fine instead of a flag
[05:27:54] <sfackler> acrichto: yeah, that's what I ended up doing: https://github.com/mozilla/rust/pull/9843
[05:28:07] <acrichto> sfackler: let's change "stripped" to "omitted"
[05:28:10] <acrichto> otherwise lgtm
[05:29:13] <sfackler> acrichto: updated
[05:29:39] <acrichto> it would be nice to have tests for some of this
[05:29:43] <acrichto> but it is hard to add tests...
[05:29:45] <acrichto> thanks though!
[05:30:10] * acrichto goes back to removing std::io
[05:31:04] <sfackler> the best way of testing would probably be to look at the json output, but the build infrastructure isn't there and Rust's makefile is terrifying
[05:31:33] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:31:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/LFU6XA
[05:31:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:31:34] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:31:34] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/tq0JIw
[05:31:34] <ghrust> 13rust/06auto 14d6d31d7 15Steven Fackler: Make Rustdoc strip private fields...
[05:31:34] <ghrust> 13rust/06auto 146aa556d 15bors: auto merge of #9843 : sfackler/rust/rustdoc-strip-private, r=alexcrichton...
[05:31:34] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:31:43] <acrichto> that's actually an interesting though
[05:31:46] <acrichto> thought*
[05:31:56] <acrichto> although it still omits looking at any rendered html
[05:32:04] <acrichto> which is probably what'll regress the easiest
[05:32:34] <sfackler> yeah. you'll at least be able to make sure that private stuff is properly removed though
[05:32:36] <cmr> Hm
[05:32:54] <cmr> I wonder if ChrisMorgan's dead link catcher thing would be of service here..
[05:33:22] <sfackler> looking at render.rs really makes me want to write a templating library, but a reasonable API would depend on a reasonable reflection API
[05:33:24] <acrichto> I'm more worried about visuals than dead links
[05:33:31] <sfackler> or dynamically loadable syntax extensions
[05:33:43] <acrichto> yeah the ad-hoc templating thing I wrote is not at all adequate for what it's doing
[05:34:02] <acrichto> I saw vague hints of a possible templating library based on format!, but I couldn't ever quite grasp
[05:34:05] <acrichto> it
[05:34:36] <sfackler> i wonder how hard it would be to get dynamic_lib to look at type metadata
[05:34:36] <sanxiyn> How does reasonable reflection API look like?
[05:35:08] <acrichto> sfackler: you're not guaranteed to have a metadata section though
[05:35:26] <sanxiyn> acrichto: You aren't?
[05:35:32] <sfackler> sanxiyn: I haven't spent a ton of time thinking about it, but some way to take a trait object and look at its fields/methods, etc
[05:35:47] <cmr> It's like headers; they aren't necessary for execution.
[05:35:52] <acrichto> sanxiyn: static linking and just plain old executables are the one missing it
[05:36:30] <sfackler> acrichto: right, but iirc the blocker for dynamically loaded syntax extensions was support for typechecking the external symobols. there'd need to be a fallback for libraries without metadata for sure though
[05:36:46] <cmr> Put it in the mangled name!
[05:36:55] <acrichto> oh I thought the blocker was just that it wasn't quite done yet
[05:37:20] <sanxiyn> If we go to route of using metadata for reflection, we would need to include them in static libraries and executables
[05:37:22] <acrichto> as in you'd have to load crates before any of the compiler passes, but things like macros could possibly expand to more 'extern mod' directives, etc.
[05:37:22] <cmr> No, it was working quite well.
[05:37:40] <sanxiyn> As I understand C++ RTTI does get included in executables
[05:37:42] <acrichto> sanxiyn: that's kinda what the tydesc is doing
[05:37:50] <sanxiyn> Hm
[05:37:51] <sfackler> iirc graydon didn't want to support it until we could typecheck the functions being loaded
[05:38:06] <sanxiyn> So tydesc can't do what sfackler wants?
[05:38:19] <acrichto> I'm not quite sure, but it may require different aspects
[05:38:22] <sanxiyn> (What is missing in tydesc that is in metadata?)
[05:38:48] <cmr> Hm, good question.
[05:38:53] <sfackler> tydesc may give everything needed, but no one's taken that and made a reasonable API
[05:39:18] <sfackler> the metadata discussion is about the dynamic_lib module
[05:39:31] <klutzy> acrichto: ah, got it. I should have read code carefully :o
[05:39:44] <acrichto> klutzy: no worries :) this is super tricky...
[05:39:50] <cmr> Although, tydescs aren't emitted if the type isn't used as a trait object iirc.
[05:39:53] <acrichto> I still wish I knew why windows didn't work...
[05:39:58] <cmr> Or some other use of get_tydesc
[05:40:37] <sfackler> i'm also not totally sure if the tydesc stuff will be around long term. I thought I heard strcat talking about wanting to get rid of it
[05:40:51] <sanxiyn> It's the first time I hear that
[05:40:57] <sfackler> but maybe it'd just be optional like C++'s --disable-rtti
[05:41:07] <sanxiyn> What depends on tydesc?
[05:41:11] <cmr> He's mentioned it before, said it's a perf burden on vtables.
[05:41:28] <sanxiyn> I think ? format uses tydesc?
[05:44:18] <sfackler> acrichto: are there any users of the rustdoc plugin API?
[05:44:51] <cmr> No
[05:45:04] <cmr> dbp wanted to implement rustle in terms of it, but that hasn't materialized
[05:45:12] <sfackler> rustle?
[05:45:22] <sanxiyn> API search
[05:45:26] <sfackler> ah
[05:45:29] <cmr> Like hoogle
[05:46:34] <sfackler> oh man, libstd can't link to librustc can it?
[05:46:48] <cmr> No
[05:47:27] <acrichto> what would libstd need to link to librustc for?
[05:47:32] <cmr> metadata
[05:47:34] <acrichto> perhaps things in comments I guess
[05:47:42] <sfackler> pulling metadata in dynamic_lib
[05:48:03] <sanxiyn> There was a talk of separating metadata loading from rustc
[05:48:22] <sfackler> I think there'll be a mutual dependency issue no matter what though
[05:48:31] <sanxiyn> #2213
[05:48:34] <sfackler> unless libmetadata can avoid everythin in libstd
[05:48:41] <sanxiyn> yeah
[05:49:01] <sanxiyn> sfackler: I heard same thing actually happens in C world
[05:49:04] <sfackler> you'd have to extract it into libstd itself or make a separate lib for dyamic_lib
[05:49:11] <sanxiyn> That is, ld.so depends on malloc, but libc.so depends on ld.so to be loaded
[05:49:13] <sanxiyn> Something like that
[05:49:20] <cmr> dynamic_lib could conceivably move to libextra?
[05:49:26] <cmr> Or, a safe interface on top of it.
[05:49:51] <sfackler> the compiler doesn't link to that? that could work
[05:49:58] <sfackler> although there are rumors that libextra's going abway
[05:49:58] <cmr> It does.
[05:50:00] <sfackler> *away
[05:50:03] <cmr> It will be.
[05:50:14] <cmr> I'm saying, the metadata stuff could also be in extra or the extra conglomerate
[05:50:21] <sfackler> oh, right
[05:50:34] <acrichto> #[no_std] everyting!
[05:50:40] <cmr> r? https://github.com/mozilla/rust/pull/9846
[05:51:36] <sfackler> c.c // FIXME #9845: Test these
[05:52:12] <acrichto> cmr: isn't a uuid just 16 bytes?
[05:52:29] <cmr> acrichto: yes?
[05:52:54] <acrichto> seems odd to serialize it as a string
[05:53:24] <sanxiyn> Yeah should it be hex encoded like that?
[05:53:25] <acrichto> I also think that it's fine to test with an existing encoder
[05:53:40] <acrichto> there's few round-trip style tests in the src/test/run-pass
[05:54:00] <acrichto> ebml is the most reliable one that I've found
[05:55:07] <cmr> Well that makes it super ugly in the JSON
[05:55:24] <cmr> And is the only one I care about
[05:55:58] <cmr> (Even more evidence, to me, that a generic serializer is an awful idea)
[05:56:22] <acrichto> erickt was the original author of all the serialization stuff if I remember correclty (if you want to chat with him)
[05:56:27] <sfackler> acrichto: once std::io goes away, how would you feel about stuff like extra::base64 and extra::flate turning into Stream implementations?
[05:56:39] <acrichto> sfackler: +1
[05:56:46] <sfackler> the current functionality would then just be streaming into and out of MemReaders or witers
[05:56:49] <sfackler> *writers
[05:56:56] <acrichto> I I think that it's still a bit too tough to use
[05:57:14] <acrichto> b/c getting piles of bytes arrays and whatnot should still be simple
[05:57:21] <sfackler> I'd leave the current API there
[05:57:27] <acrichto> sweet
[05:57:36] <sfackler> it'd just be backed by the Stream impl running into or out of a byte buffer
[05:57:38] <acrichto> I'm all for making everything streams
[05:57:46] <sfackler> cool
[05:58:07] <acrichto> git grep 'std::io' src | wc -l => 92, and that's it for tonight
[06:03:50] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Ping timeout)
[06:04:11] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[06:05:09] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[06:09:13] *** Joins: eddyb9 (eddy@AA266592.834833CE.4A6B528C.IP)
[06:09:59] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:10:28] <eddyb9> aatch: at school, found the cause for the LLVM error. I removed the ExprAddrOf wrapper for asm outputs, but in trans/asm, aoutputs need addrOf, I have to add it back there
[06:18:34] <klutzy> acrichto: is this normal? http://pastebin.mozilla.org/3255479
[06:19:16] <klutzy> uh.. it is ambiguous. is it what we want or is the failure that you expect?
[06:23:57] *** Quits: eddyb9 (eddy@AA266592.834833CE.4A6B528C.IP) (Quit: Leaving)
[06:24:53] *** Quits: Kxepal (Miranda@moz-8B4910BA.pppoe.mtu-net.ru) (Ping timeout)
[06:27:46] *** Joins: Kxepal (Miranda@moz-ABE04B8C.pppoe.mtu-net.ru)
[06:35:05] *** Joins: steveklabnik (steveklabn@moz-1DC93A6C.wiera.hu)
[06:36:34] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[06:36:34] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/tq0JIw
[06:36:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[06:41:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:41:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wRpdEw
[06:41:32] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:41:32] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:41:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/t0eWlw
[06:41:32] <ghrust> 13rust/06auto 1485f19a8 15Scott Lawrence: std::libc: rustdoc indicates reexports now
[06:41:32] <ghrust> 13rust/06auto 145b10781 15bors: auto merge of #9844 : bytbox/rust/master, r=alexcrichton
[06:41:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:00:35] *** Joins: dbaupp (Thunderbir@moz-BFBD65B3.lns20.syd6.internode.on.net)
[07:14:37] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Ping timeout)
[07:14:58] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[07:19:57] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Ping timeout)
[07:20:45] *** Quits: dbaupp (Thunderbir@moz-BFBD65B3.lns20.syd6.internode.on.net) (Quit: dbaupp)
[07:24:17] *** Joins: dbaupp (Thunderbir@moz-BFBD65B3.lns20.syd6.internode.on.net)
[07:32:39] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffb)
[07:42:06] *** Quits: steveklabnik (steveklabn@moz-1DC93A6C.wiera.hu) (Ping timeout)
[07:46:33] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[07:46:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/t0eWlw
[07:46:33] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[07:54:59] <cmr> I'm going to be doing zero work on Rust for the foreseeable future, excluding TWiR, to focus on my academics.
[07:55:43] <sanxiyn> cmr: TWiR is truly a great service, thanks
[08:40:36] *** Joins: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP)
[08:42:51] *** Quits: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP) (Ping timeout)
[08:46:01] *** Joins: eddyb9 (eddy@AA266592.834833CE.4A6B528C.IP)
[09:03:08] <eddyb9> aatch: where should I add tests? I've modified liveness and borrowck to be aware of inline asm constraints, but I'm not sure I can test the fixes sepparately
[09:04:20] <sanxiyn> eddyb9: What went wrong before the fix?
[09:04:46] <eddyb9> and I have to make sure the + constraint (always read+write) behaves correctly (just implementing =, write-only, seemed like half a job)
[09:05:11] <eddyb9> sanxiyn: liveness/borrowck didn't know inline asm can initialize a local, basically
[09:05:35] <eddyb9> there's a = constraint which means the output is always and only written to
[09:05:48] <sanxiyn> So did compiler reported uninitialized variable?
[09:05:53] <eddyb9> yupp
[09:06:13] <sanxiyn> You should add a test to run-pass that asserts variable is initialized, I think
[09:06:54] <eddyb9> now it understands two constraints, which should give better analysis, however small the user base for inline asm is
[09:07:54] <eddyb9> sanxiyn: and compile fail for the cases where it should still report an error?
[09:08:00] <sanxiyn> Ah yes
[09:08:36] <eddyb9> i.e. no constraint modifiers or + on initiliazed variable (add a, b would have + for a)
[09:10:21] <eddyb9> not sure if liveness affects codegen, but before this, it didn't record a write in liveness, so if any optimizations depended on that, they could inline the previous value of the output
[09:11:02] <eddyb9> *output destination
[09:12:02] <eddyb9> sanxiyn: now to fix the type error introduced by the fix to the LLVM error caused by the removal of ExprAddrOf wrapping for ExprInlineAsm outputs
[09:12:47] <eddyb9> 1 bug to fix, half an hour of waiting, another bug to fix
[09:14:24] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[09:15:04] <eddyb9> sanxiyn: should I put my name into AUTHORS or anything like that?
[09:15:27] <dbaupp> eddyb9: no, it's done automatically just before each release
[09:15:36] <eddyb9> I remember I had to sign the CLA for a google project, anything like that here?
[09:15:42] <eddyb9> oh, neat :D
[09:15:53] <dbaupp> there is, but small patches aren't required to sign it
[09:16:33] <sanxiyn> eddyb9: More on CLA at https://github.com/mozilla/rust/wiki/Note-development-policy
[09:17:16] *** Joins: jdm (jdm@88F51059.F3BBB17D.144F44FA.IP)
[09:18:37] *** Quits: eddyb9 (eddy@AA266592.834833CE.4A6B528C.IP) (Quit: Leaving)
[09:19:34] <eddyb> dbaupp: the only original code is an if condition, I think, the rest is just moving around existing code :P
[09:20:27] <eddyb> oh, I can't create an Expr with id: ast::DUMMY_NODE_ID in trans/asm.rs
[09:20:46] <dbaupp> correct
[09:20:58] <eddyb> wrapping each output in ExprAddrOf at parse-time is more trouble than it's worth
[09:21:16] <dbaupp> it should be pretty easy to do in ext/asm.rs?
[09:22:07] <eddyb> dbaupp: that's was the case before I removed that wrapper
[09:22:13] <dbaupp> oh, why?
[09:22:26] <dbaupp> (why did you remove it, that is)
[09:22:58] <eddyb> it was borrowing the lvalue, instead of acting like it's writing to it
[09:23:22] <sanxiyn> Hm
[09:23:24] <eddyb> I would have unwrap ExprAddrOf everywhere ExprInlineAsm might end up
[09:23:29] <eddyb> *would have had to
[09:23:29] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[09:24:24] <eddyb> in trans/asm.rs, I would like to create the aoutputs without using ExprAddrOf, or at least without changing ExprInlineAsm's structure
[09:26:04] <dbaupp> ah, so why do you need to create an ExprAddrOf later?
[09:26:45] <eddyb> dbaupp: to create the aoutputs vector in trans/asm.rs. I'm not sure how to change that and keep the same functionality
[09:27:31] <dbaupp> ah; yeah, I'm pretty sure you're not allowed to be creating new AST after ast-indexing/generation of node ids (and *especially* not after type-checking)
[09:29:39] <eddyb> well, it needs a pointer to store to an lvalue
[09:29:58] <eddyb> hmm, how does assign do this?
[09:30:10] <eddyb> (since that's been my template the whole time anyway)
[09:33:26] <eddyb> unpack_datum!(bcx, trans_lvalue(bcx, dst)).val should be a ValueRef
[09:33:42] <eddyb> (where dst is any expression)
[09:40:49] <eddyb> dbaupp: is this safe to do? Store(bcx, r, unpack_datum!(bcx, trans_lvalue(bcx, outputs[0])).val);
[09:41:41] <dbaupp> eddyb: I have literally no idea
[09:42:46] <eddyb> dbaupp: this is how it was done before: https://github.com/mozilla/rust/blob/master/src/librustc/middle/trans/asm.rs#L131
[09:46:49] <eddyb> hmm, trans_lvalue is priv, but doesn't do much more than trans_to_datum (the check is redundant, liveness checks that outputs are lvalues)
[09:52:53] <eddyb> dbaupp: not sure if I'm breaking anything, but it seems like the old way would create unnecessary scratch registers for outputs
[09:57:39] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Input/output error)
[10:12:01] *** Quits: StarLight (StarLight@moz-879AB5FF.dynamic.avangarddsl.ru) (Ping timeout)
[10:13:49] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[10:16:12] *** Joins: StarLight (StarLight@moz-F2756DD7.pppoe.avangarddsl.ru)
[10:24:07] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[10:24:44] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[10:30:56] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[10:34:27] *** Joins: steveklabnik (steveklabn@moz-1DC93A6C.wiera.hu)
[10:40:34] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[11:19:26] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Bye!)
[11:19:33] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:21:09] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[11:30:16] *** jdm is now known as jdm|f00ding
[11:57:19] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[11:57:28] <eddyb> dbaupp: woo, I've made it work, at last :P
[12:01:19] <eddyb> dbaupp: tempted to desugar asm!() with output references to (out1, out2, ...) = asm!(...) (with no references for outputs, just constraints), apart from having an optional rust-ier syntax, there's some Stores that belong in ExprAssign IMHO
[12:20:58] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[12:21:34] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[12:25:53] *** kimundi is now known as zz_kimundi
[12:27:29] *** jdm|f00ding is now known as jdm
[12:41:01] *** Joins: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[12:53:39] *** Quits: steveklabnik (steveklabn@moz-1DC93A6C.wiera.hu) (Ping timeout)
[13:04:42] <acrichto> klutzy: that's expected, it's windows unable to unwind through the __morestack frame, I couldn't figure out why (and it's the same boat we were in with segmented stacks)
[13:16:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:16:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Kj2lzg
[13:16:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[13:16:35] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[13:16:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ys3N9w
[13:16:35] <ghrust> 13rust/06auto 14a6d7fe6 15Huon Wilson: std::vec: move documentation from impls to traits....
[13:16:35] <ghrust> 13rust/06auto 14b571039 15bors: auto merge of #9848 : huonw/rust/move-trait-doc, r=alexcrichton...
[13:16:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[13:43:39] *** Joins: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP)
[13:44:55] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:21:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:21:33] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ys3N9w
[14:21:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:26:50] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[14:26:50] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/cAqVhw
[14:26:50] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:26:51] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:26:51] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/-psgVw
[14:26:51] <ghrust> 13rust/06auto 1416fc6a6 15Steve Klabnik: Remove unused abi attributes....
[14:26:51] <ghrust> 13rust/06auto 14309ab95 15Steve Klabnik: Removing ccdecl...
[14:26:51] <ghrust> 13rust/06auto 14c8e77d5 15bors: auto merge of #9606 : steveklabnik/rust/abi_removal, r=alexcrichton...
[14:26:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:30:32] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[14:39:46] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[14:39:50] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[14:43:51] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[14:57:04] *** flaper87|afk is now known as flaper87
[15:09:27] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:11:34] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[15:14:36] <eddyb> dbaupp, aatch, cmr, and whoever else was interested: https://github.com/mozilla/rust/pull/9850 (this took me way too long)
[15:16:32] <eddyb> feel free to complain about the way I did any of those things, I want to be done with this :P
[15:31:43] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[15:31:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/-psgVw
[15:31:43] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[15:37:47] *** Joins: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[15:40:33] *** Quits: jeffb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Ping timeout)
[15:47:29] <eddyb> acrichto: to be honest, I'm not sure. I initially thought not having = meant it might not be always written, but that's obviously not the case. llvm merges all the constraints in one list, so = matters there. my current checks would make more sense if other modifiers were implemented in LLVM
[15:47:33] *** flaper87 is now known as flaper87|afk
[15:48:26] <acrichto> eddyb: we're at liberty to tweak the asm! syntax as we see fit, and I think that we're already not 1 for 1 compatible with gcc, so I would rather us expand this to be a bit more sane if possible
[15:48:42] <acrichto> let me take a look at trans real quick
[15:49:21] <eddyb> acrichto: heh, it seems clang fakes + (as well as the GCC register shorthands), even though LLVM doesn't support it. maybe it adds both an input and an output?
[15:51:45] <acrichto> eddyb: does LLVM actually do somthing different on '=' vs '+' vs nothing?
[15:52:46] <eddyb> acrichto: = is output, ~ is clobber, nothing is input. I'm trying to find how clang fakes +
[15:54:48] <acrichto> hm, we should attempt to make this as "not unsafe" as possible, and we should at least have validation on constraints if we require them at all
[15:55:31] <eddyb> my PR only makes rustc less conservative when = is present
[15:55:56] <acrichto> but you can still put = on inputs
[15:56:00] <acrichto> and you can forget = on outputs
[15:56:19] <acrichto> also if we need ~ as clobber then we could be doing this completely wrong
[15:57:01] <eddyb> acrichto: ~ is added automatically for the third param section
[15:57:19] <eddyb> %3 = call i32 asm "in $1, $0", "={ax},{dx},0,~{dirflag},~{fpsr},~{flags}"(i16 %2, i32 %1)
[15:57:23] <acrichto> eddyb: ah I see, so we don't need to worry about clobbers
[15:57:33] <eddyb> that 0 there is for +
[15:58:00] <acrichto> eddyb: I think that we should prepend all outputs with = automatically
[15:58:06] <acrichto> instead of attempting to detect one way or another
[15:59:01] <acrichto> the same way that clobbers currently work
[16:00:10] <eddyb> + is easier to do than I thought. LLVM supports it in a "back-reference" way
[16:00:52] <acrichto> so + is input and output?
[16:01:47] *** zz_kimundi is now known as kimundi
[16:02:07] <eddyb> yes. to encode it, put the output index into the input constraints list
[16:02:32] <acrichto> what's an example of that?
[16:02:49] <eddyb> "={ax},{dx},0"
[16:03:07] <eddyb> source code is: asm("in %1, %0" : "+a"(val) : "d"(port));
[16:03:19] <eddyb> 0 there means "output #0 is also an input"
[16:03:46] <acrichto> interesting...
[16:04:19] <eddyb> I shouldn't have removed the code for +, now I don't want to spend five hours rebuilding rust
[16:04:28] *** Joins: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net)
[16:04:29] *** ChanServ sets mode: +o pnkfelix
[16:04:33] <acrichto> :(
[16:04:58] <acrichto> so how about all outputs will implicitly have the '=' constraint to passed to LLVM unless they're marked as '+' ?
[16:05:20] <eddyb> (or they already have a =)
[16:05:27] <acrichto> and for borrowck/trans a '=' contraint means that it doesn't necessarily have to be initialized beforehand but a '+' constraint does mean so
[16:05:47] <eddyb> if we consider = by default for outputs, then it's only different in one place: liveness, where + is ACC.WRITE|ACC.READ, compared to ACC.WRITE for =
[16:05:56] <acrichto> I suppose we could allow '=', although I don't like implicit behavior when you can also write it explicitly in a situation like this
[16:06:16] <acrichto> I'm not really liking '+'
[16:06:25] <acrichto> inline assembly is already confusing enough as-is :(
[16:06:42] <eddyb> acrichto: it's required for things like add a, b. a is going to be read and written, so it has to be initialized
[16:07:09] <acrichto> eddyb: oh yeah I know it's required, but I was wondering if we could remove requiring '+' as a constraint
[16:07:20] <acrichto> it's just another weird symbol which doesn't quite correlate to what it's used for
[16:07:27] <acrichto> if we could encode it in a more readable manner that'd be awesome
[16:08:06] <eddyb> I guess they thought read+write (that's what I used in the comments and commit messages before I removed that stuff)
[16:08:37] <acrichto> yeah that makes sense, and I can't think of anything better at the moment
[16:08:58] <eddyb> should I go rewriting?
[16:09:05] <acrichto> let's not require '=' though
[16:09:53] <acrichto> I think the logic should be "let llconstraint = if constraint.starts_with("+") { "={" constraint[1:] "}" } else { "={" constraint "}" }
[16:10:10] <acrichto> and then at the end of the constraint expression you re-scan for '+' outputs and add their indices to flag that they're inputs
[16:10:44] <eddyb> yupp
[16:10:56] <acrichto> also, are you looking at llvm documentation for this? I was never able to find any
[16:11:09] <acrichto> the {}-style constraints was news to me :)
[16:11:14] <eddyb> I'm looking at generated ll
[16:11:29] <eddyb> acrichto: they're in trans/asm.rs as well
[16:11:54] <eddyb> acrichto: the best part is that they all do what GCC shorthands do. {ax} used on an int becomes {eax}
[16:12:31] <acrichto> I thought 'a' was eax?
[16:13:41] <eddyb> in clang: a -> {ax} -> any of the sizes
[16:13:53] <eddyb> LLVM handles that last part
[16:14:12] <acrichto> eddyb: actually, maybe we should require '='
[16:14:19] <eddyb> hehe
[16:14:21] <acrichto> it looks like we just raw-concatenate input/output constraints
[16:14:31] <acrichto> with a comma
[16:14:32] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[16:15:16] <acrichto> well hm
[16:15:20] <acrichto> so llvm doesn't understand +
[16:15:27] <acrichto> so we already need to do some massaging if we see a +
[16:15:49] <eddyb> https://github.com/pcmattman/rustic/blob/master/src/io/mod.rs#L41 all this work is to get rid of ::zero
[16:16:37] <acrichto> whoa what is N{dx} ?
[16:16:53] <acrichto> also are the {} required to be a constraint?
[16:17:06] <eddyb> they're for register names
[16:17:13] <acrichto> N ?
[16:17:36] <eddyb> N is some sort of "try to use an instruction with an inlined numeric value"
[16:18:07] <acrichto> we seriously need to find some documentation on this
[16:18:16] <acrichto> the llvm constraint syntax that is
[16:18:49] <acrichto> apparently "==&{eax}" is a valid constraint
[16:18:52] <acrichto> what in the world does that do
[16:19:02] <eddyb> http://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html
[16:19:27] <acrichto> are you sure this is the exact same as gcc?
[16:20:52] <eddyb> acrichto: the {regname} syntax is custom, but clang doesn't do much apart from handling the GCC register shorthands and weird constraints like +, and it doesn't have its own inline asm (it implements both GCC and MSVC)
[16:21:38] <acrichto> eddyb: as rust, we should either attempt to fully understand constraint syntax, or never look at it entirely and just pass it along to llvm
[16:21:43] <acrichto> right now it looks like we're doing a mixture
[16:22:10] <acrichto> from the llvm langref manual: "TODO: The format of the asm and constraints string still need to be documented here"
[16:23:32] <eddyb> great, I wasted two days on it and it's still hanging
[16:37:55] <Luqman> acrichto: i think the best approach is to just see what clang outputs
[16:40:08] <eddyb> echo -e 'int main() {short port = 0; int val; asm("in %1, %0" : "=a"(val) : "id"(port));}' | clang -o foo.bc -emit-llvm -c -x c -; llvm-dis foo.bc; less foo.ll
[16:40:20] <eddyb> id and nd both get passed through. there's probably more
[16:41:34] <acrichto> eddyb: I think the only change that I'd request to your patch for now is to remove the checks for "if constraint.starts_with('=')"
[16:42:08] <eddyb> okay, that makes it easier
[16:42:20] <acrichto> + sounds like it'll be tricky
[16:45:25] *** Quits: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net) (Ping timeout)
[16:45:37] *** Joins: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net)
[16:45:37] *** ChanServ sets mode: +o pnkfelix
[16:46:03] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[16:49:59] *** Quits: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net) (Ping timeout)
[16:50:26] *** Joins: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net)
[16:50:26] *** ChanServ sets mode: +o pnkfelix
[16:52:21] *** Quits: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net) (Ping timeout)
[16:53:12] <eddyb> acrichto: there's no more compile-fail test because now it can't really fail. but should I prefix outputs with = (unless already prefixed)?
[16:53:54] <acrichto> eddyb: it should fail if the local variable isn't 'mut'
[16:58:23] *** Joins: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net)
[16:58:23] *** ChanServ sets mode: +o pnkfelix
[16:58:54] *** Joins: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net)
[17:02:31] *** Quits: pnkfelix (pnkfelix@moz-3E993C4C.public.wayport.net) (Ping timeout)
[17:10:37] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:10:37] *** ChanServ sets mode: +qo brson brson
[17:16:42] <eddyb> acrichto: @*("=" + c) doesn't work, how do I change ~str into @str?
[17:17:04] <acrichto> eddyb: to_managed
[17:24:51] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[17:26:01] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:28:29] <brson> now that debuginfo works should we be turning it on by default?
[17:29:23] <sfackler> +1
[17:30:11] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[17:30:11] *** ChanServ sets mode: +o tjc
[17:36:33] <acrichto> brson: mw had some concerns on #9770
[17:38:57] <brson> does anybody actually use rust-commits? I'm not even subscribed to it
[17:39:05] <brson> acrichto: ok sounds like it's not ready
[17:39:20] <acrichto> it's close though
[17:40:27] <tjc> brson: I wasn't aware that rust-commits existed till last month
[17:40:40] <tjc> do we need it? it seems like github has features that supersede it
[17:41:28] <tjc> as in, there's *probably* a "notify me of every commit" checkbox somewhere in the github preferences
[17:41:32] <tjc> though I certainly haven't found it
[17:44:20] <eddyb> acrichto: I'm sloow :( updated (I hope I got everything): https://github.com/mozilla/rust/pull/9850/files
[17:45:02] <acrichto> eddyb: awesome, thanks! I'll take a look at it this afternoon
[17:45:09] <eddyb> acrichto: + requires only a couple lines in both liveness and trans
[17:45:33] <eddyb> but I'm not getting that to work with these compile times
[17:46:07] <eddyb> is per-file compilation something that's coming at some point in the future?
[17:46:49] <benh> I'm curious what long term goals/expectations for compile times are :)
[17:47:13] <Luqman> eddyb: thank you for fleshing out asm!
[17:47:30] <eddyb> Luqman: I'm doing the best I can :))
[17:48:35] *** Quits: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net) (Quit: geoffhill)
[17:49:43] *** Joins: pnkfelix (pnkfelix@moz-813314A4.hsd1.ma.comcast.net)
[17:49:43] *** ChanServ sets mode: +o pnkfelix
[17:50:51] *** Joins: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net)
[17:59:30] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[17:59:32] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[18:02:34] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:04:57] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[18:07:13] *** Quits: jdm (jdm@88F51059.F3BBB17D.144F44FA.IP) (Quit: Lost terminal)
[18:08:55] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:08:55] *** ChanServ sets mode: +o tjc
[18:12:56] *** Quits: tikue_ (tikue_star@3DC9855F.F3E8A984.689607DE.IP) (Ping timeout)
[18:16:00] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[18:19:21] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:34:48] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:37:56] *** Quits: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net) (Quit: geoffhill)
[18:38:22] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[18:39:08] *** Joins: tikue_ (tikue_star@E7B9D891.DF8FC23A.689607DE.IP)
[18:45:32] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[18:48:10] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[18:48:10] *** ChanServ sets mode: +o tjc
[18:49:57] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[18:54:00] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:54:00] *** ChanServ sets mode: +o tjc
[18:56:37] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[19:05:21] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[19:06:07] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:13:22] *** Joins: geoffhill (geoffhill@moz-244CF33A.amazon.com)
[19:21:28] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Connection reset by peer)
[19:21:52] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[19:23:50] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[19:30:13] *** Quits: tikue_ (tikue_star@E7B9D891.DF8FC23A.689607DE.IP) (Ping timeout)
[19:32:47] <acrichto> brson: I was also very sad to remove all the so carefully crafted bits of __morestack, I don't mind at all leaving them around for historical purposes if we think we have a chance of coming back to them at some point
[19:33:15] <acrichto> I forgot to do this originally, but I want to leave a comment somewhere with a git commit hash pointing at when we actually had __morestack bits working with each other.
[19:33:54] *** Joins: ecr (Thunderbir@moz-BEB13C3B.dhcp4.washington.edu)
[19:38:12] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[20:01:48] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:01:49] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/EunxnQ
[20:01:49] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:01:51] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:01:51] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/GIzg_A
[20:01:51] <ghrust> 13rust/06auto 14e89ca84 15Alex Crichton: Implement task unwinding on stack overflow...
[20:01:51] <ghrust> 13rust/06auto 14f77a2a5 15bors: auto merge of #9834 : alexcrichton/rust/morestack, r=brson...
[20:01:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:04:04] <sfackler> acrichto: that's what git is for!
[20:04:26] <acrichto> yeah I ended up just putting current HEAD into a comment :)
[20:04:28] *** Quits: benh (ben@moz-4A0366D2.org) (Ping timeout)
[20:07:03] <Luqman> acrichto: hmm, i think asm! should be behind a feature flag
[20:07:19] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[20:07:52] <acrichto> Luqman: perhaps, it's not very well understood by anyone from what I gather
[20:08:26] <Luqman> in it's current state it's quite basic and doesn't quite handle the constraints properly
[20:08:54] <acrichto> that I would believe
[20:09:52] *** Joins: benh (ben@moz-4A0366D2.org)
[20:11:08] <Luqman> relocation R_X86_64_PC32 against `rust_stack_exhausted' can not be used when making a shared object; recompile with -fPIC
[20:11:14] <Luqman> acrichto: ^ :( on the bsd bot
[20:11:28] <acrichto> I think that just needs @PLT
[20:11:54] <acrichto> that's what linux needed at least
[20:13:00] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:13:00] *** ChanServ sets mode: +o tjc
[20:13:08] <acrichto> also what in the world does that error message even mean
[20:13:17] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:13:24] <brson> acrichto: no, it's fine to remove them. it's all in the history
[20:16:51] <Luqman> acrichto: when doing relocations, the linker can't know in advance if 32bits is enough for the offset in a mov since in a 64-bit arch the symbol may be much farther away from where it's referenced
[20:16:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:16:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f77a2a5 to 14c8e77d5: 02http://git.io/N3iJvQ
[20:16:53] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:16:59] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:16:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/19_nyQ
[20:16:59] <ghrust> 13rust/06auto 141492a6a 15Alex Crichton: Implement task unwinding on stack overflow...
[20:16:59] <ghrust> 13rust/06auto 14aabdc53 15bors: auto merge of #9834 : alexcrichton/rust/morestack, r=brson...
[20:16:59] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:17:30] <acrichto> Luqman: oh hm interesting!
[20:20:08] *** Quits: ecr (Thunderbir@moz-BEB13C3B.dhcp4.washington.edu) (Ping timeout)
[20:26:35] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[20:31:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[20:31:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Emu2qA
[20:31:46] <ghrust> 13rust/06auto 1442c3884 15Alex Crichton: Implement task unwinding on stack overflow...
[20:31:46] <ghrust> 13rust/06auto 149eadaa1 15bors: auto merge of #9834 : alexcrichton/rust/morestack, r=brson...
[20:31:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[20:33:06] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[20:33:35] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[20:34:38] <brson> acrichto: you didn't answer my question about why the stack limit calculation is different if limit < RED_ZONE
[20:35:19] <acrichto> brson: oh I just removed it, it was incorrectly "limit = stack - RED_ZONE" at one point and I wanted to make sure there was no overflow
[20:35:32] <acrichto> it was supposed to be "lo + RED_ZONE" all along anyway
[20:35:52] <acrichto> sorry I should have commented to that effect as well...
[20:38:41] <acrichto> hm I thought I had already verified that this worked on linux...
[20:42:59] *** Joins: vadimcn_ (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[20:43:01] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[20:43:01] *** vadimcn_ is now known as vadimcn
[20:47:19] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[20:47:23] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[20:47:44] <bstrie> brson: small PR to rust-www, resulting site visible at http://seleniac.org/rust-www/
[20:48:17] *** Joins: tikue_ (tikue_star@18C1ABA5.D038900B.689607DE.IP)
[20:48:50] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[20:50:31] *** Quits: tikue_ (tikue_star@18C1ABA5.D038900B.689607DE.IP) (Ping timeout)
[20:51:29] *** Joins: tikue_ (tikue_star@18C1ABA5.D038900B.689607DE.IP)
[20:54:27] *** Quits: dbaupp (Thunderbir@moz-BFBD65B3.lns20.syd6.internode.on.net) (Ping timeout)
[21:21:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[21:21:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149eadaa1 to 14c8e77d5: 02http://git.io/N3iJvQ
[21:21:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[21:21:45] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[21:21:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/5Ek-Hw
[21:21:45] <ghrust> 13rust/06auto 1442c3884 15Alex Crichton: Implement task unwinding on stack overflow...
[21:21:45] <ghrust> 13rust/06auto 1474ce951 15bors: auto merge of #9834 : alexcrichton/rust/morestack, r=brson...
[21:21:46] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[21:24:01] *** kimundi is now known as zz_kimundi
[21:43:26] *** Quits: tikue_ (tikue_star@18C1ABA5.D038900B.689607DE.IP) (Ping timeout)
[21:43:28] *** Joins: ecr (Thunderbir@moz-CE637C05.dhcp4.washington.edu)
[21:51:39] *** Joins: tikue_ (tikue_star@18C1ABA5.D038900B.689607DE.IP)
[22:01:00] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[22:01:39] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[22:06:38] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:06:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1474ce951 to 14c8e77d5: 02http://git.io/N3iJvQ
[22:06:38] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:06:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:06:39] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/wueodg
[22:06:39] <ghrust> 13rust/06auto 14c56bf67 15Felix S. Klock II: Issue 7655: align the bench printouts so that the numbers tend to be aligned....
[22:06:39] <ghrust> 13rust/06auto 14602b3cd 15Felix S. Klock II: Only use padded test names to calculate the target padding size.
[22:06:39] <ghrust> 13rust/06auto 14a7e8957 15bors: auto merge of #9823 : pnkfelix/rust/issue7655-bench-papercuts, r=alexcrichton...
[22:06:41] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:08:55] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[22:09:22] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[22:09:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:16:38] *** pnkfelix is now known as pnkfelix|taqueria
[22:21:47] *** Quits: ecr (Thunderbir@moz-CE637C05.dhcp4.washington.edu) (Quit: ecr)
[22:22:47] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[22:30:51] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[22:31:18] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Connection reset by peer)
[22:31:39] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[22:31:41] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[23:05:26] *** Joins: dbaupp (Thunderbir@BEECE994.D5A1DCF.37681C44.IP)
[23:06:43] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[23:06:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/wueodg
[23:06:44] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[23:16:35] *** Quits: dbaupp (Thunderbir@BEECE994.D5A1DCF.37681C44.IP) (Quit: dbaupp)
[23:19:43] *** Joins: dbaupp (Thunderbir@BEECE994.D5A1DCF.37681C44.IP)
[23:26:42] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[23:26:49] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
