[00:01:05] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[00:02:47] *** Quits: swgillespie (swgillespie@moz-1i5.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:05:02] *** Joins: erz (erz@moz-n26c5c.broadband.corbina.ru)
[00:05:33] *** Joins: steshaw (uid30841@moz-eom82r.uxbridge.irccloud.com)
[00:07:06] *** Joins: stomper (Mibbit@moz-juv.9o3.252.72.IP)
[00:09:19] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[00:09:23] <huon> r? https://github.com/rust-lang/rust-playpen/pull/90
[00:12:02] *** Quits: stomper (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:14:30] <brson> ChrisMorgan: awesome updates to play.rlo
[00:14:59] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[00:16:13] <bstrie> ChrisMorgan: ping
[00:16:17] <ChrisMorgan> bstrie: pong
[00:16:34] <bstrie> ChrisMorgan: the gear icon on the new play.rlo is unclickable
[00:16:41] <bstrie> ChrisMorgan: kmc has confirmed for him as well
[00:16:42] <kmc> that's my observation yes
[00:16:42] <ChrisMorgan> Oh?
[00:16:48] <ChrisMorgan> Browser?
[00:16:50] <bstrie> firefox
[00:16:52] <kmc> =
[00:16:55] <ChrisMorgan> WFM on Firefox on Linux.
[00:17:10] <ChrisMorgan> Ah, but not on play.rust-lang.orgâ€¦ hmm.
[00:17:25] <bstrie> ChrisMorgan: TypeError: formatButton is null web.js:337:4
[00:17:38] <huon> oh, whoops, my fault
[00:17:51] <ChrisMorgan> Oh, of course.
[00:18:03] * ChrisMorgan was about to blame huon for it too.
[00:19:40] * ChrisMorgan has now completed a flexbox-powered layout which switches to side-by-side panels when the viewport width reaches 1600px (allowing for an 80 character editor)
[00:20:50] <ChrisMorgan> Using display: flex; rather than position: absolute; makes it work better on small screens too. The position: absolute approach stays as a fallback where @supports (display: flex) fails.
[00:21:38] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[00:21:55] <huon> ChrisMorgan: hm, line ~177 of web.hs is just "result.offsetHeight;" should it be being set to something?
[00:22:01] <ChrisMorgan> huon: no
[00:22:08] <ChrisMorgan> huon: itâ€™s to force a repaint.
[00:22:14] <ChrisMorgan> Firefox rendering glitch.
[00:22:18] <huon> oh, seems worth a comment ;P
[00:22:21] <ChrisMorgan> There is one.
[00:23:08] <huon> it doesn't say anything about why it's doing nothing with offsetHeight unless you already know that doing that with offsetHeight will force a redraw
[00:23:26] <ChrisMorgan> `setTimeout(function() { result.style.position = ""; }, 0);` instead of `result.offsetHeight; result.style.position = "";` would work too.
[00:23:55] <ChrisMorgan> huon: itâ€™s a standard technique to force a redraw.
[00:24:20] <huon> this code will be read by rustaceans usually, not javascript experts :)
[00:26:07] <huon> acrichto: made a mistake, r? https://github.com/rust-lang/rust-playpen/pull/92
[00:26:17] *** Quits: larsberg (Adium@moz-kmvlue.cable.rcn.com) (Quit: Leaving.)
[00:26:20] <acrichto> merged
[00:26:25] <huon> thanks
[00:26:28] *** Joins: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP)
[00:26:57] *** Quits: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP) (Quit: Leaving)
[00:33:00] <ChrisMorgan> Aww, as soon as I try my nice flexbox layout in Chrome it all falls apart â˜¹
[00:33:10] <ChrisMorgan> Chromeâ€™s implementation of flexbox is seriously dodgy.
[00:33:57] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[00:34:17] <ChrisMorgan> !! My @media screen and (min-width: 1600px) styles donâ€™t even get applied/removed when the viewport size changes!
[00:40:03] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Connection closed)
[00:42:52] <kmc> the really important question: does it work in servo
[00:43:35] <kmc> the servo team has switched to a web-based code review tool whose UI is a bit... overwhelming for Gecko
[00:43:49] <kmc> I'm hoping we fix this by getting it working in Servo :)
[00:44:26] <cmr> kmc: does it work significantly better in chrome? I just assumed it was slow universally, since it was *really really* slow in firefox.
[00:45:09] *** Quits: Manishearth (manishearth@moz-8puj7k.net) (Ping timeout: 121 seconds)
[00:45:10] <kmc> I think so, yeah
[00:45:12] *** Quits: jga (jga@moz-7vm.t1q.244.77.IP) (Ping timeout: 121 seconds)
[00:45:15] <kmc> but I haven't tried it first-hand
[00:45:26] <kmc> firefox tends to come last at animation-y things
[00:46:07] <kmc> ChrisMorgan: omg, now :w runs the code in vim mode
[00:46:09] <kmc> <3
[00:46:37] <ChrisMorgan> kmc: yep, I slipped that in because I had missed it slightly. Ctrl+Enter might be faster, though.
[00:47:03] * ChrisMorgan updates his servo build so he can try the playpen out
[00:47:19] <ChrisMorgan> Havenâ€™t built it for a couple of weeks at least.
[00:47:34] <ChrisMorgan> Probably a month.
[00:48:04] *** Joins: joneshf-laptop (joneshf@moz-5q88jj.ucdavis.edu)
[00:48:39] <Eridius> brson: you got the invites already, right? You don't need any more?
[00:48:55] <kmc> http://i.imgur.com/YHBLPLl.png lol not great
[00:49:12] *** Joins: insaneinside (user@moz-dgv9mb.customer.broadstripe.net)
[00:49:12] <seanmonstar> is that servo
[00:49:14] <ChrisMorgan> kmc: not the most impressive.
[00:49:15] <kmc> ye
[00:49:16] <kmc> s
[00:49:29] <ChrisMorgan> I will admit that I use things like ::before and ::after fairly freely.
[00:49:44] <kmc> ChrisMorgan: if my brain is in vim mode, I will obsessively type :w<Enter> all the time whether or not it does anything
[00:49:45] <ChrisMorgan> ACE is clearly not loading.
[00:49:55] <kmc> servo supports generated content
[00:49:57] <ChrisMorgan> kmc: thatâ€™s why I only said Ctrl+Enter *might* be faster!
[00:50:01] *** Quits: eibwen (eibwen@moz-uadegq.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[00:50:34] * ChrisMorgan actually has nnoremap ; : so he doesnâ€™t type :w<Enter> often at all
[00:50:38] <Eridius> ok, vim mode is cool, but not having my normal `:imap jk <Esc>` is going to throw me
[00:51:27] <brson> Eridius: i got some. thanks
[00:52:13] <ChrisMorgan> kmc: if I can conveniently do so, Iâ€™ll make it so you can run the code even if ACE doesnâ€™t load.
[00:53:25] *** Joins: swgillespie (swgillespie@moz-1i5.3un.220.167.IP)
[00:54:30] <insaneinside> Is there a timeline for when `std::ops::CoerceUnsized` will land in the nightlies?
[00:54:30] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[00:55:07] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[01:00:28] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:01:02] <seanmonstar> hrm, did newest nightly merge something unstablish? cargo build --release now spins forever in hyper, which built yesterday
[01:01:06] <seanmonstar> crap
[01:01:20] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[01:01:25] <seanmonstar> just as i pressed enter, it finally completed
[01:02:37] <cmr> seanmonstar: sounds like a regression, though.
[01:03:08] <geofft> ChrisMorgan: Could you change the stylesheet URL (to like "web.css?20150513") to work around the reload problem? 
[01:03:25] <geofft> happy to send a PR, just unsure if you care :) 
[01:04:02] <ChrisMorgan> kmc: whoa, in my local servo build and current changes, moving my mouse over the buttons is causing the share button to increase its height in steps until it gets to around 100px and then it snaps back to the right height. ðŸ˜•
[01:04:29] <ChrisMorgan> geofft: good idea. Iâ€™ll do that with my next changes.
[01:05:34] <kmc> haha lol
[01:05:47] *** Joins: mib_6aysvg (Mibbit@moz-juv.9o3.252.72.IP)
[01:05:57] <shep-home> Ok, the shrinking text on share is pretty fun
[01:06:24] <ChrisMorgan> â€¦ and thatâ€™s why a slow internet connection is good :P
[01:06:31] *** Quits: swgillespie (swgillespie@moz-1i5.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:06:48] <huon> seanmonstar: could you open a bug, and possibly include the output of `cargo rustc --release -- -Z time-passes`?
[01:08:15] <seanmonstar> huon: i may have misspoken. i first noticed that cargo bench hangs, and thought it might be build --release (cause i didnt change the code). currently running bench with --verbose
[01:08:31] <seanmonstar> its been on the first command, rustc, since i spoke last
[01:10:13] <seanmonstar> ChrisMorgan: is the bottom: 30% on the editor needed?
[01:10:38] <ChrisMorgan> seanmonstar: when using position: absolute; for layout, definitely.
[01:10:43] <huon> ah, well, `cargo rustc --release -- -Z time-passes --test` will be informative if it's only the bench case
[01:11:03] <seanmonstar> ChrisMorgan: oh i meant that 30%, instead of like 5% or 10%
[01:11:04] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[01:11:24] <ChrisMorgan> seanmonstar: you do want to be able to see the results, right?
[01:11:32] *** Parts: insaneinside (user@moz-dgv9mb.customer.broadstripe.net) ("bye")
[01:11:35] <seanmonstar> oh thats why
[01:11:39] <ChrisMorgan> â˜º
[01:12:56] *** Joins: gsingh93 (uid22642@moz-aq0iah.charlton.irccloud.com)
[01:15:49] <seanmonstar> huon: what comes after `llvm function passes`
[01:16:40] <seanmonstar> cause thats the last line currently, a couple minutes ago
[01:17:16] <aatch> seanmonstar, code generation.
[01:17:31] <aatch> and linking.
[01:17:35] <ChrisMorgan> Iâ€™ve just finished polishing a flexbox layout which is superior and offers for 1600px-wide viewports horizontal layout; http://temp.chrismorgan.info/rust-playpen/static/web.html is now using it.
[01:18:10] <aatch> ChrisMorgan, ooo, very nice.
[01:18:18] *** Joins: Manishearth (manishearth@moz-8puj7k.net)
[01:18:35] <seanmonstar> ChrisMorgan: i much prefer the output window expanding over it
[01:18:47] <seanmonstar> is there a way to dismiss it after?
[01:18:49] *** chmanchester is now known as chmanchester|afk
[01:19:03] * ChrisMorgan sets about reducing the layout viewport from 800â€“1000px to 700px for mobile browsers
[01:19:05] <huon> ChrisMorgan: very nice
[01:19:25] <ChrisMorgan> seanmonstar: I wondered about adding an Ã— button to its top right corner
[01:19:27] <huon> fwiw, I've always found that ACE interacts badly with mobile browsers (to the point of unusability)
[01:19:47] <frewsxcv> kmc: do you mind if i use the afl.rs wiki to keep track of progress with projects?
[01:19:50] <seanmonstar> ChrisMorgan: or focusing the editor?
[01:20:08] <ChrisMorgan> huon: seems to work fine for me on Firefox for Android.
[01:20:12] <frewsxcv> kmc: i thought about making a separate repo or google spreadsheet, but the wiki seems like a good place to put this info
[01:20:18] <aatch> ChrisMorgan, one nit, the fact that all the optimisation-level buttons highlight when you click is quite distracting.
[01:20:18] <ChrisMorgan> seanmonstar: no, that would be VERY evil.
[01:20:36] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[01:20:49] <seanmonstar> evil?
[01:20:51] <huon> ChrisMorgan: hm, that's the browser that I was using too, although it's been quite a while since I tried
[01:20:53] <ChrisMorgan> aatch: oops, that was a mistake.
[01:21:10] <kmc> frewsxcv: fine by me
[01:21:27] <kmc> what do you have planned? :)
[01:21:33] <seanmonstar> huon: hasn't gone past llvm function passes...
[01:21:58] <huon> seanmonstar: ah, well, LLVM taking "ages" is expected
[01:22:06] *** Quits: mib_6aysvg (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[01:22:17] <huon> seanmonstar: but if it's a noticable regression, that's weird
[01:22:26] <seanmonstar> huon: benches always ran much faster than this in hyper
[01:22:47] <seanmonstar> i'll try with beta5
[01:22:52] <seanmonstar> er
[01:22:59] <seanmonstar> derp, cant run benches in beta
[01:24:01] <huon> one can use multirust to download specific nightlies, e.g. 'nightly-2015-05-12' (or earlier)
[01:24:04] <seanmonstar> ChrisMorgan: maybe not dismissing outright on focusing the editor. it could minimize to 1 line, and clicking could re-grow the results panel
[01:24:05] <frewsxcv> kmc: i feel pretty disorganized. going to paste in the code blocks i use to run libraries. going to log when i do them and if i finish them.
[01:24:42] <ChrisMorgan> seanmonstar: wanting to be able to see the resultsâ€”especially errorsâ€”while you alter the code is normal.
[01:25:08] <ChrisMorgan> seanmonstar: also the user might have used Ctrl-Enter to run the code, so thereâ€™s not even a guarantee that the editor lost focus in the first placeâ€¦
[01:25:29] <seanmonstar> shortcuts? since when?
[01:25:35] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[01:26:30] <ChrisMorgan> seanmonstar: I donâ€™t know how long Ctrl-Enter has worked for, but it was there when I tried it first a week or two back.
[01:26:41] <seanmonstar> huon: oh hey, llvm module passes just output, 600s
[01:31:44] *** GBGamer is now known as npm
[01:32:34] *** Joins: GBGamer (npm@moz-92sbjt.wa.comcast.net)
[01:33:00] <seanmonstar> huon: yea, difference with yesterday nightly is huge. will paste results
[01:38:05] <huon> seanmonstar: woah
[01:39:28] *** Joins: Rym_ (y@moz-ife.8p4.39.217.IP)
[01:39:34] <seanmonstar> yep
[01:39:47] *** Joins: Rym__ (y@moz-odvbki.in-addr.btopenworld.com)
[01:39:50] <seanmonstar> it taking longer than 10minutes kills the travis build :(
[01:39:54] *** Quits: GBGamer (npm@moz-92sbjt.wa.comcast.net) (Ping timeout: 121 seconds)
[01:40:06] *** Joins: Rym___ (y@moz-gqu.fea.39.217.IP)
[01:40:24] *** Joins: Rym____ (y@moz-nnr.gec.39.217.IP)
[01:40:45] *** Joins: Rym_____ (y@moz-bul.d1r.39.217.IP)
[01:40:49] <seanmonstar> huon: were asserts re-enabled or something?
[01:41:03] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[01:41:23] <huon> seanmonstar: no idea
[01:41:29] <seanmonstar> i'll check the pulse
[01:42:14] *** Quits: Rym (y@moz-o80acm.range86-189.btcentralplus.com) (Ping timeout: 121 seconds)
[01:43:31] *** Quits: Rym_ (y@moz-ife.8p4.39.217.IP) (Ping timeout: 121 seconds)
[01:43:50] *** Quits: Rym__ (y@moz-odvbki.in-addr.btopenworld.com) (Ping timeout: 121 seconds)
[01:44:07] *** Quits: Rym___ (y@moz-gqu.fea.39.217.IP) (Ping timeout: 121 seconds)
[01:44:30] *** Quits: Rym____ (y@moz-nnr.gec.39.217.IP) (Ping timeout: 121 seconds)
[01:44:42] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[01:44:46] *** Quits: Rym_____ (y@moz-bul.d1r.39.217.IP) (Ping timeout: 121 seconds)
[01:45:24] <seanmonstar> nothing jumps out
[01:45:37] <huon> weird
[01:45:47] <huon> file a bug and hope someone else has a brainwave?
[01:45:52] *** Joins: Bira (bira@moz-sq6.nc4.106.187.IP)
[01:45:55] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[01:47:05] <seanmonstar> i did
[01:47:26] <seanmonstar> i assumed tahts how you saw it
[01:48:05] <huon> nah, I was 'woah'ing at what you said, hadn't see any specifics until now
[01:48:12] * huon reloads his github news feed
[01:48:33] <seanmonstar> hm, dst coercions looks like it touches rustc_trans and friends...
[01:49:27] <huon> and so maybe it resulted in very horrible codegen? sounds like a possibility
[01:50:35] <huon> seanmonstar: could you try with 2015-05-12, or doesn't that nightly exist?
[01:51:20] <seanmonstar> i assumed that was today XD
[01:51:43] <huon> oh, I was just going off the 'built ...' dates, there's a gap :P
[01:52:10] <seanmonstar> i typed that date just now and am running again
[01:57:46] <seanmonstar> huon: you're right, it was a gap. still fast tho
[01:57:53] <seanmonstar> so regression was last night
[01:59:19] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[02:00:02] <huon> seanmonstar: could you update the issue?
[02:03:12] <brson> erickt: pizza is ordered for friday
[02:05:08] <brson> noooooo
[02:05:11] <brson> stable distcheck failed http://buildbot.rust-lang.org/builders/stable-dist-rustc-linux/builds/1/steps/distcheck/logs/stdio
[02:05:21] <WindowsBunny> brson: oh goodie
[02:05:22] <brson> i will investigate
[02:05:31] <brson> glad we have another day
[02:06:18] <cmr> brson: it appears that trpl has an associated constant example, but that 1.0 doesn't have associated constants.
[02:06:22] <WindowsBunny> can someone update the counter in the topic?
[02:06:39] *** cmr changes topic to '~1-2 days to 1.0.0 http://blog.rust-lang.org/2015/02/13/Final-1.0-timeline.html | https://botbot.me/mozilla/rust-internals | https://buildbot.rust-lang.org/homu/queue/rust | see also #rustc and #rust-libs'
[02:06:42] <acrichto> brson: there's a bug in our makefiles, if I specify the super obscure configuration of --build=gnu and --host=msvc, --target=msvc everything dies
[02:06:57] <acrichto> brson: e.g. j/k
[02:07:06] <cmr> acrichto: don't we need --build = --host?
[02:07:13] <acrichto> we probably do
[02:07:28] <cmr> last I checked we did, but it's possible that has changed...
[02:07:33] <WindowsBunny> ah, our wonderful rust build system
[02:08:07] *** Quits: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl) (Ping timeout: 121 seconds)
[02:09:22] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[02:09:53] *** Joins: eataix (uid37918@moz-79aeif.ealing.irccloud.com)
[02:11:59] *** Quits: zz_kimundi (kimundi@moz-mmvhvu.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:14:33] *** Joins: zz_kimundi (kimundi@moz-ol7m65.dip0.t-ipconnect.de)
[02:14:34] *** zz_kimundi is now known as kimundi
[02:15:10] *** Joins: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net)
[02:16:06] *** nrc|afk is now known as nrc
[02:21:02] *** Joins: GBGamer (npm@moz-92sbjt.wa.comcast.net)
[02:21:39] *** Joins: fuogo (Mibbit@moz-juv.9o3.252.72.IP)
[02:22:35] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[02:23:44] <huon> nrc: \o/ dxr
[02:24:56] <nrc> \o/ indeed!
[02:25:06] <brson> i'm going to have to head out soon, but I'll address the stable doctest failure tonight
[02:25:07] <nrc> I'm so happy
[02:25:22] <nrc> (not about brson heading out)
[02:25:27] <nrc> sorry brson
[02:26:06] <brson> lol
[02:27:44] *** Quits: joneshf-laptop (joneshf@moz-5q88jj.ucdavis.edu) (Ping timeout: 121 seconds)
[02:28:44] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Ping timeout: 121 seconds)
[02:30:30] *** Quits: freebroccolo (sid51271@moz-ealde0.ealing.irccloud.com) (Quit: )
[02:31:43] <acrichto> vadimcn: so I've been trying to get MSVC working on the bots, and I ran into precisely the same bug you had this morning
[02:32:04] <acrichto> vadimcn: the fix was to not use MinGW python but instead a python which doesn't auto-translate windows paths to msys paths by default
[02:32:30] <acrichto> vadimcn: e.g. /usr/bin/python.exe and /bin/python.exe were both "bad", and I locally was using /mingw64/bin/python.exe and the bots are now using /Python27/python.exe
[02:32:47] <acrichto> not sure if there's a way that we can detect this... but that's at least the fix
[02:33:04] *** Quits: tamird (textual@moz-ti3.9hm.3.173.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[02:34:11] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[02:36:16] *** Joins: zxq9 (ceverett@moz-qsm369.mesh.ad.jp)
[02:36:48] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[02:37:50] *** Quits: fuogo (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:38:26] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[02:38:31] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[02:40:18] <WindowsBunny> acrichto: I wish we could rewrite the make system in rust
[02:40:30] <acrichto> WindowsBunny: you are not alone in these desires!
[02:40:40] <XMPPwocky> https://xkcd.com/927/ build systems
[02:40:42] <nrc> s/rust/anything other than make
[02:40:55] <WindowsBunny> acrichto: Then it would be trivial to access the registry to find where VS is installed :D
[02:41:32] <acrichto> lol
[02:43:52] *** Joins: tamird (textual@moz-gkumi9.dyn.optonline.net)
[02:44:16] <huon> nrc: malbolge!
[02:45:05] * nrc discovers another esolang
[02:45:21] <huon> acrichto: we could at least detect/error out for a bad python, right? (run a windows path through python and see what comes out?)
[02:45:43] <acrichto> huon: hm that's not a bad idea, let me try that
[02:46:02] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[02:46:09] <aatch> You know what I love about Rust. I can basically replicate the functionality of `#if FOO <stuff> #else <stuff> #endif` with macros.
[02:46:34] <aatch> s/macros/a macro
[02:46:42] <aatch> https://gist.github.com/Aatch/5aad060daf4f5bd5946e
[02:46:47] <acrichto> huon: that should work excellently
[02:46:54] * acrichto learns python
[02:47:23] <huon> aatch: neat!
[02:48:13] <aatch> huon, really useful for the stuff I'm doing at the moment where I have 1 function for x86, 1 function for x86_64 and a generic fallback.
[02:49:59] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[02:50:07] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[02:52:37] <shep-home> acrichto: i'm picturing you just downloading stuff, matrix-style
[02:52:46] <shep-home> aatch: that is relevnt to my interests!
[02:53:52] <aatch> shep-home, oh right, yeah, for jetscii. Feel free to copy and use it.
[02:54:07] <acrichto> shep-home: hahaha
[02:54:21] <huon> aatch: you should publish it on crates.io!
[02:55:42] <aatch> huon, lol
[02:55:57] <shep-home> aatch: what are you using it for?
[02:56:21] <aatch> shep-home, arbitrary-precision arithmetic.
[02:56:31] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[02:56:53] <acrichto> huon: https://github.com/alexcrichton/rust/commit/e6c0378c4efd1e70972a94598b2d40e115ed505f
[02:57:19] <aatch> shep-home, specifically, there are some operations that can be done with 1 instruction that end up being like 20 if you can't use it directly.
[02:58:27] <huon> acrichto: nice
[02:58:29] <ChrisMorgan> acrichto: r? https://github.com/rust-lang/rust-playpen/pull/93
[02:58:35] <shep-home> aatch: intriguing!
[02:58:39] <huon> aatch: (I wasn't joking about publishing it)
[02:58:50] *** Quits: erz (erz@moz-n26c5c.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[02:59:13] <aatch> shep-home, a notable example is that `div` on x86 divides a double-machine-word sized numerator by a machine-word sized denominator.
[03:00:15] <huon> ChrisMorgan: is that code the stuff used on your version?
[03:00:44] *** Quits: bdero (bran@moz-216hqv.oo5r.e4su.0006.2601.IP) (Quit: Leaving.)
[03:00:45] *** Joins: bdero (bran@moz-216hqv.oo5r.e4su.0006.2601.IP)
[03:01:37] <ChrisMorgan> huon: yep
[03:01:38] *** Joins: davebettin_ (davebettin@moz-ip635p.or.comcast.net)
[03:01:47] <huon> eurgh, chrome's handling of media queries and flexbox is weird (as you said before)
[03:02:06] <ChrisMorgan> I think I fixed everything up so it worked properly? Did I mess something up?
[03:02:07] <aatch> You know you're doing strange things when you're implementing `Add<bool>` for a type.
[03:02:27] <huon> ChrisMorgan: it seems to not adjust automatically?
[03:02:45] <ChrisMorgan> Oh, just that part of resizing the viewport requiring a refresh. Yeah, thatâ€™s a bit messed up, but itâ€™s not my fault.
[03:02:53] <huon> ChrisMorgan: in fact, it takes a cache-clearing refresh
[03:02:59] <huon> (for me, at least)
[03:03:12] <huon> yeah, just commiserating with you :)
[03:03:18] <ChrisMorgan> Not for me.
[03:03:54] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[03:04:12] <ChrisMorgan> Anyway, itâ€™s fairly pretty now, so Iâ€™m happy â˜º
[03:04:44] <huon> yeah, I like it
[03:05:08] <brson> does anybody know the build command for testing the book?
[03:06:00] <brson> oh there's not a single command to test the book
[03:06:42] <ChrisMorgan> Next up: rewrite the web interface in Rust and implement a proper URL shortener for it. But Iâ€™m not embarking on that task now. Maybe in a few weeksâ€™ time Iâ€™ll feel like it.
[03:07:56] <brson> starting another stable build
[03:07:57] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[03:08:33] <shep-home> ChrisMorgan++
[03:14:29] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[03:17:20] *** Quits: GBGamer (npm@moz-92sbjt.wa.comcast.net) (Connection closed)
[03:21:49] *** Quits: bdero (bran@moz-216hqv.oo5r.e4su.0006.2601.IP) (Ping timeout: 121 seconds)
[03:27:33] *** Joins: semarie (semarie@moz-91l.1av.83.212.IP)
[03:27:46] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[03:29:57] *** Joins: quantheory (quantheory@moz-uiqd7j.co.comcast.net)
[03:31:01] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[03:34:43] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[03:34:43] *** ChanServ sets mode: +o pcwalton
[03:34:51] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[03:35:26] *** Quits: aatch (james@moz-ciignl.bmm3.j08e.e000.2406.IP) (Connection closed)
[03:35:42] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[03:35:56] *** Quits: davebettin_ (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[03:38:57] *** Quits: quantheory (quantheory@moz-uiqd7j.co.comcast.net) (Ping timeout: 121 seconds)
[03:40:04] *** Joins: quantheory (quantheory@moz-uiqd7j.co.comcast.net)
[03:40:25] *** Quits: quantheory (quantheory@moz-uiqd7j.co.comcast.net) (Quit: Bye)
[03:41:48] <eddyb> ugh, I just wasted the whole night *not* getting a build
[03:43:08] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[03:43:17] <eddyb> acrichto: make -k rustc-stage3 check -jN is broken. I believe the tidy stuff generates some kind of stats about diagnostics, and that breaks the compilation if it happens too soon
[03:43:40] <eddyb> acrichto: I could be wrong though. /home/eddy/Projects/rust/src/librustc/lib.rs:170:1: 170:52 error: error E0038 from `librustc' also found in `tmp/extended-errors/librustc_typeck.json'
[03:46:04] *** Joins: c74d3 (c74d3a4ebb6@moz-s0g0co.mggc.hibn.4404.2002.IP)
[03:46:09] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[03:46:27] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[03:47:29] *** c74d3 is now known as c74d
[03:53:50] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[03:54:28] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[03:54:43] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Connection closed)
[04:02:56] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[04:04:38] *** Joins: anders (andars@moz-bsldst.sntcca.sbcglobal.net)
[04:05:38] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[04:15:09] *** Quits: semarie (semarie@moz-91l.1av.83.212.IP) (A TLS packet with unexpected length was received.)
[04:15:21] *** Joins: semarie (semarie@moz-67r1nt.torservers.net)
[04:17:39] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[04:18:10] *** Joins: bjz (bjz@moz-0j4.2c9.87.203.IP)
[04:19:52] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[04:19:54] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[04:29:00] *** Quits: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu) (Quit: Leaving)
[04:32:59] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[04:38:21] *** Quits: Diggsey (diggsey@moz-e3pv94.dsl.pipex.com) (Ping timeout: 121 seconds)
[04:41:02] *** Joins: semarie_ (semarie@moz-1nufks.zenger.nl)
[04:41:06] <npm> how many people have checked out japaric's unsized RFC?
[04:41:10] <npm> It's pretty damned cool
[04:42:07] <eddyb> npm: there's an RFC now?
[04:42:30] *** Quits: semarie_ (semarie@moz-1nufks.zenger.nl) (Quit: WeeChat 1.1)
[04:44:05] <npm> it's not PR'd yet, but it's written
[04:44:13] <npm> https://github.com/japaric/rfcs/blob/unsized/text/0000-unsized-structs.md
[04:44:23] *** Quits: semarie (semarie@moz-67r1nt.torservers.net) (Ping timeout: 121 seconds)
[04:44:24] <npm> (obviously, WIP)
[04:44:31] <npm> but still, I want this so bad
[04:44:40] *** Quits: anders (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[04:47:36] <npm> although, I really need to find japaric so I can ask some questions
[04:48:04] <eddyb> npm: I gave some half-baked feedback on reddit. the initial implementation misses a bunch of things
[04:48:35] <npm> eddyb: Yes, it does, but I think it's important that we start this process at all
[04:49:09] <eddyb> like, it doesn't specify size_of_val at all
[04:49:13] <npm> imho, one of the big remaining failings of Rust is it's inability to allow for user-defined unsized types
[04:49:24] <eddyb> neither does it introduce any way for a type to opt out of sizeability
[04:49:41] *** Joins: c74d3 (c74d3a4ebb6@moz-nvc5h7.mggc.hibn.4404.2002.IP)
[04:50:13] <npm> (similar to C's struct T { size_t size; int unsized[]; })
[04:50:20] *** Quits: c74d (c74d3a4ebb6@moz-s0g0co.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[04:50:43] <npm> this is obviously a different implementation, but it has a similar effect
[04:51:08] *** c74d3 is now known as c74d
[04:51:10] <eddyb> having the pointer explicit seems very hacky to me. but I'll wait and see where this goes
[04:51:53] <npm> yeah, I agree about that
[04:52:33] *** Quits: amir_ (amir@moz-jnohkj.3bcq.01f6.0168.2a02.IP) (Ping timeout: 121 seconds)
[04:53:56] <npm> I'm just very excited that it's starting to get discussed
[04:55:46] *** Quits: eddyb (eddyb@moz-egg.q07.26.188.IP) (Ping timeout: 121 seconds)
[04:57:45] <bstrie> would we be able to use that feature to move `str` and `[T]` into the stdlib?
[04:57:51] <npm> bstrie: yes
[04:57:59] <npm> that's one of the major pointer
[04:58:05] <npm> s/er/s/
[04:58:47] <npm> (although, obviously, there would be a lang item allowing [] to be used as a "type name")
[04:58:53] <bstrie> could be promising, then. I'm always wary about making the language bigger, but this is just the typical make-the-language-bigger-to-make-it-smaller dance we always do
[04:59:03] *** Joins: acharles (acharles@moz-mi1459.static.qwest.net)
[04:59:25] <npm> pretty much, and unsized types are very useful to allow people to write
[04:59:38] <npm> (or, at least, you miss them when you want them)
[04:59:42] <bstrie> no comment on the proposal itself, just the sentiment
[04:59:51] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[05:00:07] <npm> do we allow a thing like C, where we have 0-length arrays?
[05:00:12] <npm> maybe just for C-interop
[05:01:05] <bstrie> how does C handle zero-length arrays?
[05:01:18] <npm> (well at the end of structs at least)
[05:01:56] <npm> So if you have a struct T { size_t size; int arr[0]; }, it's treated as struct T { size_t size; }
[05:02:12] <npm> but with a contiguous block of memory, as an array, after it
[05:02:39] <bstrie> weird, how long is the block of memory that it reserves?
[05:03:01] <npm> Well, it's only used on the heap, afaik
[05:03:03] <nrc> these are not custom unsized structs so much as custom fat pointers
[05:03:26] <npm> So you just malloc(sizeof(struct T) + length_of_array)
[05:03:38] <nrc> I see the motivation, it makes me a little bit uneasy though
[05:03:40] <npm> then set the struct T's size field to length_of_array
[05:04:08] <bstrie> nrc: why so?
[05:04:25] <nrc> I'm not sure we should expose that kind of low level stuff
[05:04:36] <npm> well... for C interop though
[05:04:38] <nrc> the codegen would be terrifying too
[05:04:52] <npm> we can't really avoid it
[05:05:13] <npm> and Clang/LLVM's already solved the codegen
[05:05:33] <npm> (admittedly, not a very common pattern, but one that does get used)
[05:05:42] <bstrie> nrc: are you talking about custom unsized types or the C array[0] thing
[05:05:47] *** Joins: amir (amir@moz-qbf4gg.fiber7.init7.net)
[05:05:48] <nrc> well, we put a lot of effort into encoding fat poiners into LLVM ir, generalising that would be interesting
[05:06:02] <nrc> bstrie: japaric;s proto-RFC
[05:06:29] <npm> oh, I thought you were talking about C's thing, and was very confused
[05:06:50] <npm> honestly, Rust is a low-level language
[05:07:07] <npm> We should try to allow people to do what they want
[05:07:12] <npm> (imo, at least)
[05:07:33] <npm> And take as much out of the compiler as possible, and special case as little as possible
[05:07:56] <bstrie> nrc: just yesterday I ran into someone wanting to implement his own unsized types for use in a GC that he's writing in rust, for now he's just hacking around it with unsafe code
[05:07:57] *** Joins: p1start (p1start@moz-nftjhe.org)
[05:08:22] <npm> nrc: that's pretty much what we're left with
[05:08:24] <bstrie> nrc: not advocating the RFC, but it might become a common pain point. and if this is safer than manual unsafe hackery, that's still a net safety win
[05:08:40] <npm> either we expose everything we can, or people will hack around it
[05:08:51] <nrc> yeah, I'm not against it, I understand the motivation
[05:09:57] <nrc> we're talking about having 'fat' pointers which are only one word sized too, so perhaps exposing some of this machinary makes that less ad hoc too
[05:10:17] <bstrie> I think this is the sort of thing that it would be good to start specifying and take our time iterating on the design. doesn't need to be a priority, but it helps people to know that it's on the radar
[05:10:25] <npm> nrc: how would that work? (the one-word fat pointers)
[05:10:40] <npm> (what's it useful for?)
[05:10:41] <nrc> Seems like something we should do along the same lines as facilitating regular smart pointers
[05:10:47] <bstrie> and in the meantime we could implement this behind a feature gate and still manage to use it for `str` until it's baked
[05:11:01] <nrc> npm: efficient inheritance stuff - the vtable is at the end of the pointer, rather than beside it
[05:11:11] *** Joins: mib_jcyyj5 (Mibbit@moz-juv.9o3.252.72.IP)
[05:11:19] <nrc> but other than its size, the compiler treats it like a fat pointer
[05:11:20] <npm> interesting...
[05:11:25] <nrc> wrt sized-ness etc.
[05:11:37] <bstrie> I agree that it should wait until the virtual inheritance stuff is proposed
[05:11:45] <nrc> def this will need some thought
[05:12:11] <nrc> it gives me the creeps for reasons I can't really articulate
[05:19:24] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[05:22:42] *** Joins: Jesin (Jesin@moz-34r.q2b.180.128.IP)
[05:23:15] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Connection closed)
[05:24:21] *** Quits: Bira (bira@moz-sq6.nc4.106.187.IP) (Connection closed)
[05:26:15] *** Quits: mib_jcyyj5 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:32:40] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[05:32:46] *** Quits: bjz (bjz@moz-0j4.2c9.87.203.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[05:33:24] *** Joins: sp3d (sp3d@moz-ik970v.enn1.s22b.000d.2601.IP)
[05:34:20] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[05:37:42] *** Joins: rprichard (rprichard@moz-0nj8tl.en8f.d045.0009.2601.IP)
[05:39:44] *** Quits: nham (nham@moz-755.bu3.214.98.IP) (Ping timeout: 121 seconds)
[05:40:00] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[05:46:52] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[05:48:29] <npm> I'm getting a weird error?
[05:48:37] <npm> with stage2 librustc?
[05:48:46] <npm> error E0038 from `librustc' also found in `tmp/extended-errors/librustc_typeck.json'
[05:49:38] <nrc> delete your tmp/extended-errors dir
[05:49:49] <nrc> it probably needs fixing, but that is a work around
[05:50:18] <npm> what's up with that?
[05:50:29] <npm> (what does it meeeean)
[05:51:24] <nrc> make tidy keeps track of declared diagnostics and makes sure there are no mulitple declarations
[05:51:39] <nrc> but either a dup got checked in or it is screwing up some how
[05:51:46] <nrc> I think the latter
[05:52:26] *** Joins: kmcguire (kmcguire@moz-bbqf14.res.bhn.net)
[05:53:16] <npm> ah okay
[05:53:25] <npm> dnake
[05:53:29] <npm> *danke
[05:54:41] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[05:55:38] *** Quits: rprichard (rprichard@moz-0nj8tl.en8f.d045.0009.2601.IP) (Connection closed)
[06:01:00] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[06:02:47] *** Joins: kushal (kdas@moz-plp31c.202.sitibroadband.in)
[06:02:48] *** Joins: zmack (zmack@moz-j05.1kc.25.188.IP)
[06:05:32] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[06:05:37] *** Joins: c0170_ (c0170@moz-bb29a4.cambridge.arm.com)
[06:07:11] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[06:07:48] *** Quits: c0170 (c0170@moz-dev.ffi.127.79.IP) (Ping timeout: 121 seconds)
[06:09:31] *** Joins: James (quassel@moz-225vcm.range86-148.btcentralplus.com)
[06:12:13] <ChrisMorgan> huon: r? https://github.com/rust-lang/rust-playpen/pull/94
[06:12:58] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[06:13:01] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[06:15:06] <ChrisMorgan> huon: I must also retract my statement about not finding anything wrong with ACE on mobile. One can write all one likes, but not edit: backspace on a soft keyboard doesnâ€™t work, and navigation with arrows with a physical keyboard doesnâ€™t work. With Vim mode one can work, though.
[06:15:19] *** Joins: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP)
[06:15:22] *** Joins: flabbergaster (Mibbit@moz-juv.9o3.252.72.IP)
[06:15:53] *** Quits: gsingh93 (uid22642@moz-aq0iah.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[06:15:55] <ChrisMorgan> (Imagine! Vim mode being more usable on a mobile device than the alternative!)
[06:16:47] *** Joins: nham (nham@moz-755.bu3.214.98.IP)
[06:16:54] *** Quits: zmack (zmack@moz-j05.1kc.25.188.IP) (Connection closed)
[06:17:54] <quantheory> TBH, even though I'm on the emacs side of the "religious" conflict, I've always felt that vim should find the mobile device niche very hospitable.
[06:18:45] <Manishearth> I've used vim over ssh over mobile often, and it's quite good for a mobile editor
[06:18:49] <quantheory> The only trouble being that mobile devices have consistently shown that my intuition is usually wrong.
[06:19:15] <ChrisMorgan> Manishearth: so long as you contrive to have an escape key, Vim does indeed work well.
[06:19:24] <Manishearth> yep
[06:19:52] <Manishearth> the one dev app I have installed on my (Windows) phone is an ssh terminal; and it handles special keys well
[06:19:57] <Manishearth> not as well as ios7
[06:20:00] <Manishearth> but decently well
[06:20:13] <Manishearth> (ios7 provides an extended keyboard api that ssh app writers use)
[06:22:39] <quantheory> Interesting. I left Apple devices entirely, due in no small part to the difficulty of working from the command line on an iPhone or iPad (I never really transitioned for laptop/desktop).
[06:23:05] <quantheory> If iOS has improved in the many years since then, maybe I should give it a go.
[06:27:29] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[06:27:32] *** Joins: rprichard (rprichard@moz-5v7oqc.en8f.d045.0009.2601.IP)
[06:27:51] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[06:32:27] *** Joins: eddyb (eddyb@moz-hdr.5ot.166.109.IP)
[06:32:48] <npm> domgetter: doesn't rustc have a non-zero exit when it fails?
[06:33:03] <npm> I'm still terrible with irssi...
[06:33:39] *** Quits: flabbergaster (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:33:45] <Mutabah> r? https://github.com/rust-lang/rfcs/pull/1119
[06:35:56] <eddyb> nrc: I share most of those concerns. I would almost prefer special cases for "extra data alongside pointer" and "extra data behind pointer" but I'm not sure that's a good idea either
[06:36:13] <eddyb> (i.e. specifying the data, not the whole thing)
[06:36:22] <eddyb> it's also hard to design something composable
[06:38:17] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[06:39:17] <eddyb> nrc: there's also the whole option of first-class existential support, but that does not solve the fat/thin pointer distinction
[06:42:21] <npm> I have to say, I do prefer C's solution
[06:42:38] <npm> (although I think it could be implemented better)
[06:43:01] <npm> unsized types just run off the end of the types
[06:44:30] <eddyb> and the pointers are thin and it's entirely unsafe
[06:44:42] <npm> although you then have to worry about malloc'ing the extra baggage, you also don't have to worry about copying around fat pointers
[06:45:01] <npm> eddyb: well, to be fair, our pointers are fat and it's entirely unsafe
[06:45:14] <npm> the only reason it's safe is because the compiler makes it so
[06:45:22] <npm> the other could be implemented safely
[06:45:36] <npm> (or, just as safely as fat pointers)
[06:45:56] <eddyb> if you store the data in the struct?
[06:46:08] <eddyb> as in, behind the pointer?
[06:46:27] <npm> what's the difference in safety between &[T], where the pointer is a struct { ptr, size }
[06:46:44] <npm> and an &[T], where the & is a pointer, and the [T] is a struct { size, data }
[06:47:10] <npm> you can still (really easily) walk all over the heap in the first case, which I've done
[06:47:24] <npm> (transmute to a &[T] of a larger type)
[06:47:31] <eddyb> the problem is there is no link from the size to the data
[06:47:36] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Quit: Konversation terminated!)
[06:47:46] <npm> how do you mean?
[06:48:06] <npm> in this case, the size is stored with the data, which, at least imho, means there's more of a link
[06:48:40] <eddyb> struct Slice<T> { len: usize, data: [T; self.len] } // this would work
[06:48:56] <eddyb> but you get into a whole lot of design issues if you want to enforce it like that
[06:49:10] <npm> well yeah, but you don't enforce it like that
[06:49:27] <npm> you just make it unsafe to create slices manually, just like we do currently
[06:49:35] <eddyb> if your answer is "unsafe code" then it's not a great solution. it's working, but so is the status quo
[06:49:54] <npm> I'm not saying change it, I'm saying I prefer it
[06:50:06] <npm> the status quo is unsafe code
[06:50:16] <npm> they're pretty much exactly the same
[06:50:25] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:50:26] <eddyb> also, to some extent, traits can represent slices, but we don't have a way of restricting the genericity enough to allow compressing to the current slice representation
[06:50:32] <npm> except that in one case, the len is behind a pointer
[06:50:59] <npm> eddyb: what do you mean by that?
[06:53:00] <eddyb> trait Array<T>: ?Drop + ?Sizeable { const LEN: usize; } impl<T, const N: usize> Array<T> for [T; N] { const LEN: usize = N; } impl<T> Drop for Array<T> { fn drop(self: Own<Self>) { for _ in self {} } } impl<T> Sizeable for Array<T> { fn size_of(&self) { self.len() * size_of::<T>() } }
[06:53:01] <eddyb> something like that
[06:53:35] <eddyb> (that last method should be size_of(&self) -> usize)
[06:53:39] <npm> hrmm, yeah, I guess
[06:54:14] <npm> now that I think about it, the C solution isn't super great for already existing *T arrays
[06:54:31] <npm> fat pointers are really the best option that I can think off
[06:54:36] <npm> s/ff/f
[06:54:49] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[06:55:01] <eddyb> the "behind the pointer" existential data is more useful to safe Rust code than unsafe code
[06:55:08] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[06:55:18] <npm> eddyb: would you mind rephrasing that?
[06:55:32] <npm> sorry, I didn't get that at all
[06:55:40] <eddyb> struct Node { vtable: Vtable<NodeOps, Node>, ... }
[06:55:52] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[06:56:06] <npm> I don't understand...
[06:56:08] *** Joins: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net)
[06:56:12] <npm> I'm gonna blame it on tiredness
[06:56:12] <eddyb> the whole "efficient inheritance" stuff which isn't as much about inheritance but about data layout optimizations and DRY
[06:56:25] <npm> oh
[06:56:31] <eddyb> you have common data to many pointers
[06:56:44] <npm> right
[06:56:46] <npm> inheritance
[06:56:47] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[06:56:53] <npm> outside my field, unfortunately
[06:57:02] *** Quits: James (quassel@moz-225vcm.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[06:57:10] <npm> you'd have to explain in C terms for me to get it :P
[06:57:31] <eddyb> OOP terms to no good to these features, it's just a layout optimization
[06:58:00] <eddyb> npm: exactly like putting the length of a vector before the data instead of passing it alongside the pointer
[06:58:26] <eddyb> it's only beneficial if you're never slicing and you have a lot of pointers to the same data
[06:58:38] <npm> yeah, exactly, okay
[06:58:45] <npm> you're speaking my language now :P
[06:59:01] <npm> io comprendo
[06:59:17] <eddyb> this helps the DOM in Servo which is why it's painted in OOP colors
[06:59:23] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[06:59:26] <npm> ah, okay
[06:59:40] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[06:59:45] <npm> personally never been a big fan of OOP, so I've never given it much thought
[06:59:53] <eddyb> there was a big RFC about higher-level features that could be combined to allow such optimizations
[06:59:53] <npm> I've always disliked it when I try it
[07:00:04] <eddyb> but it was maybe too high-level. I still want to have it safe
[07:00:20] <npm> ach, you're too obsessed with safety :P
[07:00:35] <npm> real programmers and all that crap :P
[07:00:48] <eddyb> npm: Servo can already do this perfectly with unsafe code
[07:01:54] <npm> yeah, I can see we need to work on getting this safe
[07:02:12] <npm> just as long as I don't have to do anything with it
[07:04:17] <eddyb> npm: I hope that one day we can prove most of the commonly used abstractions which have unsafe implementations
[07:05:13] <npm> that will be the day, won't it
[07:05:30] <eddyb> which means that we can safely express most usecases with a language feature, we should. but there's also other concerns like orthogonality and implementation cost
[07:05:43] <eddyb> npm: that and bootstrapping from scratch
[07:06:11] <eddyb> Rust was built on principles that allows it to be one of a kind. we should not take this aspect lightly
[07:06:15] <npm> eddyb: that is a more difficult problem
[07:06:36] <eddyb> npm: it's also a practical problem and mainly requires time
[07:06:48] <eddyb> npm: while proving safety might have impossible bits
[07:07:01] <npm> wait, just to be clear, what do you mean by bootstrapping?
[07:07:12] <npm> (I'm thinking compiling a rust compiler w/o a rust compiler)
[07:07:24] <eddyb> npm: compiling from assembly. or even building a FPGA
[07:07:43] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[07:08:11] <Manishearth> npm: theoretically you can build rustc from the old ocaml compiler through a few hundred bootstrap steps
[07:08:15] <Manishearth> see you next year :p
[07:08:22] <npm> are there things like that for C?
[07:08:28] <npm> (fpgas, I mean)
[07:08:28] <eddyb> there's tcc
[07:09:00] <eddyb> npm: there's open-source RISC architectures
[07:09:16] <eddyb> and there's C compilers with support for them
[07:09:48] <npm> wait, what are you actually asking for?
[07:09:56] <eddyb> but you'd have to start with something written in assembly
[07:10:00] <npm> I can't actually figure that out
[07:10:18] <npm> like, a rust boot sequence?
[07:10:22] <eddyb> npm: defeat the thompson hack with some good confidence value
[07:10:52] <eddyb> wait, I think I got the name wrong
[07:11:09] <npm> so a bootstrap from asm to a subset of rust to rustc?
[07:11:17] <npm> Or an asm rustc compiler
[07:11:19] <eddyb> no, it's Thompson alright
[07:11:35] <npm> Yeah, Ken Thompson and his login thing
[07:11:35] <eddyb> npm: aren't both variations of the same thing?
[07:11:46] <npm> well, yes
[07:11:55] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[07:12:04] <npm> but one requires implementing a subset of rust
[07:12:10] <npm> and the other requires implementing rust
[07:12:16] <eddyb> asm -> specialized language (doesn't have to be parallel/concurrent, for example. JS is thread-safe by not having threads :P)
[07:12:19] <npm> and both are gonna be fucking difficult
[07:12:22] <eddyb> specialized language -> rust
[07:12:32] <eddyb> npm: but it's engineering
[07:12:40] <npm> true
[07:12:51] <npm> but I think the best option would be a C rust compiler
[07:12:55] <npm> and then bootstrap on that
[07:12:58] <eddyb> a Rust compiler written in C?
[07:13:01] <eddyb> IMO that's a terrible idea
[07:13:02] <npm> yeah
[07:13:12] <eddyb> this was actually Go's mistake
[07:13:26] <npm> well, it'd work better and faster, and easier than an asm/specialized language compiler
[07:13:36] <eddyb> no it wouldn't
[07:13:51] <eddyb> rustc was bootstrapped from higher-level OCaml code
[07:14:03] <npm> if you want to write rust in asm, go ahead
[07:14:05] <eddyb> try converting that to C
[07:14:11] <eddyb> npm: I don't
[07:14:15] <npm> I'm just telling you it's going to be terrible
[07:14:16] <huon> ChrisMorgan: yeah, that's exactly the problem I had (backspace not working)
[07:14:41] <eddyb> npm: so is C. it's hard to write a compiler for a language with abstractions like generics in a language that doesn't have said abstractions
[07:15:02] <eddyb> no I am not going to write rustc in asm. that would be a bit dumb
[07:15:47] <eddyb> npm: the whole point of a specialized language is to be specialized for writing a Rust compiler
[07:16:01] <npm> so you'd basically be writing a rust--, in asm?
[07:16:19] <eddyb> if it lacks something, you adjust the language. if you really need an optimized operation, you add an opcode in the VM
[07:16:36] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[07:16:37] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[07:16:40] <eddyb> npm: rs-3 -> rs-2 -> rs-1 -> rs-0 -> rustc
[07:16:55] <npm> I mean, sure, that'll work
[07:16:56] <eddyb> this is a specific instance of bootstrapping that I want to work on
[07:17:21] <npm> with or without llvm?
[07:17:24] *** Quits: njn (chatzilla@moz-6gdjm4.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 40.0a1/20150510205108])
[07:17:35] <npm> (will you compile to llvm bc first, or directly to asm)?
[07:17:58] <eddyb> you can replace the LLVM C API that Rust uses with a mock that just records the IR
[07:18:09] <quantheory> eddy, npm: I'm still catching up on your conversation, but I want to point out that for science codes I've worked on (which may or may not be relevant to the community in general), it's often necessary to get a slice into an existing array, which is an incentive for dimensions to be available next to the pointer, not next to the target of the pointer (i.e. fat pointers rule).
[07:18:21] <eddyb> quantheory: yupp <3
[07:18:31] <npm> yes they do
[07:18:38] <npm> I just needed to think about them
[07:18:45] <npm> and then, my eyes were opened
[07:18:45] <eddyb> npm: there's no easy way to get a complete executable in such a bootstrapped environment because that depends on LLVM
[07:19:02] <npm> yeah, so I think I see what you're saying
[07:19:06] <eddyb> (unless we replace LLVM entirely with own own backend, but that is not likely to happen in the next couple of years)
[07:19:39] <npm> you want to be able to bootstrap rustc
[07:20:04] <npm> from asm, through an intermediate language, and then compiling rustc?
[07:20:14] <eddyb> I believe it would be sufficient to generate IR from such a bootstrapped compiler and a snapshotted one and compare it, to show that at least the rustc snapshots weren't contaminated (with some degree of convenience)
[07:20:30] <eddyb> npm: one bytecode format and two intermediate languages
[07:21:16] <npm> well, I completely understand where you're coming from.
[07:21:24] <npm> I would really like to see this come to fruition
[07:22:04] <eddyb> it's mostly a challenge in design and engineering for me. I would love to be able to work full-time on it, but that's not likely to happen
[07:22:29] <npm> yeah, I wish I could work on it
[07:22:43] <npm> but I haven't even gotten through Let's Build A Compiler yet :P
[07:22:53] <npm> I need to work on my compiler building skills
[07:23:10] <eddyb> I don't know much other than my own parser experiments and fiddling with the internals of the Rust compiler
[07:23:36] <eddyb> and I have never written any asm before this VM
[07:23:55] <eddyb> (ignoring copy-pasted IDT handlers and other such things found in osdev)
[07:24:10] <npm> well, we all start somewhere
[07:24:11] <eddyb> npm: oh, it should also be possible to do (terrible) codegen from LLVM IR to a bytecode or to x86
[07:24:30] <eddyb> npm: -> #rust-offtopic?
[07:24:44] <npm> yeah, I guess it is
[07:24:52] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[07:24:53] <npm> but I want to work on unsized types :P
[07:25:17] <eddyb> can you join that channel? I don't want to continue spamming this one
[07:29:43] <quantheory> Out of curiosity, is anyone (on right now) thinking about alignment in Rust? Specifically, I'm thinking of certain Intel compiler directives for alignment that cause memory unsafety (out-of-bounds) if you get them "wrong enough" on an architecture with wide registers. I'm not sure how much rustc/LLVM could trigger the same errors, but there's an appeal due to SIMD (which is why Intel is the big player here).
[07:29:48] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[07:30:18] <npm> fairly certain llvm deals with all that stuff for us
[07:30:19] *** Quits: eddyb (eddyb@moz-hdr.5ot.166.109.IP) (Connection closed)
[07:32:07] <aatch> quantheory, that's really vague. Do you have a specific concern?
[07:32:09] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[07:32:17] *** Joins: eibwen (eibwen@moz-0oubi8.dip0.t-ipconnect.de)
[07:32:51] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[07:33:35] <npm> ooh there's a cool new error
[07:34:12] <npm> "mutating transmuted &mut T from &T may cause undefined behavior,consider using an UnsafeCell"
[07:34:25] <quantheory> aatch: I want to make arrays that track alignment in the type itself, and I want to know if anyone else is thinking along similar lines (granting that this may require dependent types that we don't have yet).
[07:35:09] <aatch> quantheory, what do you mean "track alignment in the type itself"? Alignment is a property of a type, like it's size.
[07:37:31] <quantheory> aatch: Yes. But I'm thinking of multi-dimensional arrays used in the codes I work with, where you have piecewise contiguous views into an array, and you can either preserve or lose (or with objects maybe regain) information about alignment of the pieces that make up a view.
[07:38:33] <aatch> quantheory, sounds like you need to handle all of that dynamically.
[07:38:39] <quantheory> I.e. I have an array with the "shortest" dimension being 16, so alignment of the first slice implies alignment of later slices, even if the data is not contiguous overall.
[07:39:42] *** Joins: semarie (semarie@moz-vjb.r8r.42.192.IP)
[07:40:00] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[07:40:26] <quantheory> aatch: That's no good for (really intense) SIMD. The compiler needs to do codegen for the aligned version, and branching between two versions at runtime is an unacceptable cost (except at the beginning and end of very long data views).
[07:40:33] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[07:41:13] <quantheory> aatch: I suspect that in the long term LLVM itself needs some upgrades, but bridges when we come to them...
[07:41:17] <aatch> quantheory, I really don't know what you want. But if you're losing type information, you're losing type information and there's no way around that.
[07:41:27] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[07:42:02] <quantheory> aatch: Right, the goal is not to lose it. Which means making the alignment as explicit as it needs to be in the type unless the compiler can handle it.
[07:42:25] *** Joins: eddyb (eddyb@moz-hdr.5ot.166.109.IP)
[07:42:53] <quantheory> It's not even a concern yet because there are more basic things to worry about, like specifying the alignment of an array *at all* in Rust.
[07:43:31] <aatch> quantheory, I'm still really confused as to what your problem is. Either you have raw bytes and no static alignment information (and no amount of compiler technology will bring it back) or you know what the correct types are.
[07:43:42] <aatch> quantheory, apparently you know what the types are, but not the alignment?
[07:45:39] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[07:45:39] <aatch> If you need specific alignment to do stuff like SIMD work, then why not do what compilers do and have a prologue and epilogue for the unaligned portion?
[07:46:18] <quantheory> aatch, yep. Again, think of multi-dimensional arrays, which are ultimately built on 1-D slices (or similar). If the shortest dimension is 3, then a slice into an array may mean every 3rd float, whereas a dimension of 16 means that slices may be every 16 elements, which for certain sizes are aligned. The idea is that if you know this ahead of time (which isn't always the case), it would be good to represent in types.
[07:47:07] <quantheory> (I.e. elements 4-7 of every 16 floats.)
[07:48:29] <aatch> quantheory, I feel that you keep leaving out important words: "If the shortest dimension is 3, then a slice into an array may mean every 3rd float, whereas a dimension of 16 means that slices may be every 16 elements, which for certain sizes are aligned" Every third float is what?
[07:49:01] <aatch> Or do you mean, that the slice is, itself, every third float?
[07:49:19] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[07:49:55] <aatch> quantheory, it doesn't help that you keep saying "slices" which is a thing in Rust and are most definitely contiguous.
[07:49:57] <quantheory> I think the latter has it. I am not talking about Rust slices, but about some view that picks out elements with some stride, which ends up being maybe every three floats or something.
[07:50:23] <quantheory> Right. I forget what channel I'm on. The word "slice" means something very different to me.
[07:50:44] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[07:52:05] <quantheory> I really mean something like a view with a regular pattern to the selected items, e.g. 4 items out of every 16, in every 48, in... (repeat items that are multiples of the previous one).
[07:53:51] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[07:59:16] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[07:59:53] *** Joins: mgottschlag (quassel@moz-j4umq0.scc.kit.edu)
[08:12:46] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[08:15:24] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[08:18:39] *** Quits: eddyb (eddyb@moz-hdr.5ot.166.109.IP) (Connection closed)
[08:19:10] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[08:19:13] *** Joins: eddyb (eddyb@moz-hdr.5ot.166.109.IP)
[08:27:22] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[08:31:58] <Manishearth> quantheory: that would be an iterator I guess
[08:32:03] <Manishearth> skip, perhaps?
[08:32:07] <Manishearth> no, not skip
[08:32:31] <bluss> stride
[08:34:36] <quantheory> Data layout is *the* central property here, so nothing based solely on an iterator will work AFAICT. Iterators *deliberately* throw away any information about where the data they yield is coming from.
[08:36:01] <bluss> I'm not sure what you are getting at (Sorry if I've read the backlog a bit quickly)
[08:36:37] <bluss> so say a compact 4x4 matrix of f32
[08:36:53] <bluss> the first row is 16-byte aligned while the second row is not, that kind of information?
[08:37:06] <bluss> (or column)
[08:37:57] <huon> quantheory: https://crates.io/crates/strided (although that only does simple patterns of elements spaced evenly in memory)
[08:38:03] <aatch> bluss, not the best example, since each row/column *would* be 16-byte aligned if the first one was.
[08:38:13] <huon> it's also not in the type, much.
[08:38:41] <aatch> bluss, maybe a 3x3 matrix?
[08:38:42] <bluss> aatch: true, yeah so you understood what I meant even if I said it wrong ..
[08:39:02] <bluss> huon: http://bluss.github.io/rust-itertools/doc/itertools/struct.Stride.html
[08:39:15] <huon> bluss: oh, haha
[08:39:21] <bluss> smaller crates are better I guess :)
[08:39:55] <bluss> it really makes more sense to be separate
[08:39:57] *** Joins: eddyb_ (eddyb@moz-jm7.2kg.166.109.IP)
[08:40:55] *** Quits: eddyb (eddyb@moz-hdr.5ot.166.109.IP) (Ping timeout: 121 seconds)
[08:40:59] *** Joins: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de)
[08:41:19] *** eddyb_ is now known as eddyb
[08:42:15] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[08:42:53] <quantheory> I want a view that picks the "1" elements from this mask: [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]
[08:43:28] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[08:43:47] <quantheory> And the fact that you are aligned and contiguous in 4-element chunks is in the type (and you can deal with 2-element or no alignment on the same architecture).
[08:44:30] <quantheory> And if you are not so aligned, it still works, just without the (same) SIMD advantage.
[08:46:29] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[08:46:36] <quantheory> The fact that you are dealing with multi-dimensional arrays is what generates that pattern, and what you can use to hopefully prove things to the compiler, but not central.
[08:47:30] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[08:48:02] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[08:51:10] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[08:51:46] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[08:55:16] *** Joins: larhat1 (Adium@moz-egv.ld6.128.213.IP)
[08:55:48] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[08:59:25] *** Quits: larhat1 (Adium@moz-egv.ld6.128.213.IP) (Ping timeout: 121 seconds)
[09:00:37] *** Quits: quantheory (quantheory@moz-dsb104.crel.jtvf.0001.2601.IP) (Quit: Leaving)
[09:09:36] *** Joins: genbattle (genbattle@moz-r09mao.xtra.co.nz)
[09:16:00] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[09:17:11] *** Joins: anom (anhedonia@moz-oadaam.torservers.net)
[09:17:24] *** Quits: Kxepal832 (Miranda@moz-u0omr9.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[09:17:54] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[09:20:35] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[09:21:13] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[09:24:05] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[09:24:37] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Ping timeout: 121 seconds)
[09:26:08] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[09:31:37] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[09:31:48] *** Joins: erz (erz@moz-n26c5c.broadband.corbina.ru)
[09:32:51] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[09:37:25] *** Joins: jga (jga@moz-08s.t1q.244.77.IP)
[09:37:41] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[09:42:12] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[09:45:24] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[09:47:40] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Connection closed)
[09:49:03] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[09:50:48] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[09:57:52] *** Quits: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de) (Connection closed)
[09:58:03] *** Joins: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de)
[09:58:11] *** Joins: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net)
[10:04:08] *** Quits: c74d (c74d3a4ebb6@moz-nvc5h7.mggc.hibn.4404.2002.IP) (Connection closed)
[10:04:33] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[10:09:01] *** Quits: nham (nham@moz-755.bu3.214.98.IP) (Quit: leaving)
[10:13:02] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[10:17:04] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[10:18:07] *** Quits: killercup (killercup@moz-qj5qhi.dip0.t-ipconnect.de) (Quit: Bye)
[10:20:07] *** Quits: eddyb (eddyb@moz-jm7.2kg.166.109.IP) (Connection closed)
[10:21:16] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:31:47] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[10:35:05] *** Joins: mpk (mpk@moz-m0q.67q.47.195.IP)
[10:35:14] *** Quits: mpk (mpk@moz-m0q.67q.47.195.IP) (Client exited)
[10:36:10] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[10:36:21] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[10:38:43] <WindowsBunny> acrichto: use REG to query the registry from the command line
[10:43:47] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[10:48:02] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[10:48:31] *** Quits: npm (npm@moz-92sbjt.wa.comcast.net) (Quit: process:exit(EXIT_TIRED_AF))
[10:48:33] *** Quits: anom (anhedonia@moz-oadaam.torservers.net) (Ping timeout: 121 seconds)
[10:48:53] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[10:49:31] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[10:51:55] *** Joins: anom (anhedonia@moz-r7m2fk.snydernet.net)
[10:53:46] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[10:53:46] *** ChanServ sets mode: +o pnkfelix
[10:55:06] *** Joins: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl)
[10:56:10] *** Quits: anom (anhedonia@moz-r7m2fk.snydernet.net) (Ping timeout: 121 seconds)
[11:02:25] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[11:09:22] *** Quits: yuriks (quassel@moz-hnlou0.yuriks.net) (Ping timeout: 121 seconds)
[11:09:28] *** Quits: jga (jga@moz-08s.t1q.244.77.IP) (Ping timeout: 121 seconds)
[11:09:55] *** Joins: ytain (ytain@moz-07c3h9.dsl.teksavvy.com)
[11:10:09] *** Quits: genbattle (genbattle@moz-r09mao.xtra.co.nz) (Quit: Leaving)
[11:10:20] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[11:10:32] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:15:05] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[11:16:31] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:16:59] *** Joins: Nekit1234007 (nekit@moz-jpa.hli.189.91.IP)
[11:17:03] *** Quits: nrc (nrc@moz-9luh02.xtra.co.nz) (Ping timeout: 121 seconds)
[11:18:16] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[11:19:44] *** Joins: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP)
[11:21:34] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[11:25:29] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (Ping timeout: 121 seconds)
[11:25:57] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[11:27:44] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[11:28:31] *** Joins: anom (anhedonia@moz-p76.o9j.219.91.IP)
[11:30:31] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[11:31:00] *** Quits: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net) (Ping timeout: 121 seconds)
[11:31:29] *** Joins: dinfuehr (dinfuehr@moz-5kt7gr.highway.telekom.at)
[11:31:42] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:33:11] *** Quits: dinfuehr (dinfuehr@moz-5kt7gr.highway.telekom.at) (Connection closed)
[11:35:25] *** Quits: mgottschlag (quassel@moz-j4umq0.scc.kit.edu) (Ping timeout: 121 seconds)
[11:36:39] <WindowsBunny> um
[11:36:45] <WindowsBunny> I can't compile rust :|
[11:37:25] <XMPPwocky> yes you can, i believe in you
[11:38:05] *** Joins: nrc (nrc@moz-9luh02.xtra.co.nz)
[11:38:05] *** ChanServ sets mode: +o nrc
[11:38:39] <WindowsBunny> https://github.com/rust-lang/rust/issues/25364
[11:38:43] <WindowsBunny> I'm running into that
[11:39:44] <WindowsBunny> XMPPwocky: Curse this foul build system
[11:42:48] *** Quits: nrc (nrc@moz-9luh02.xtra.co.nz) (Ping timeout: 121 seconds)
[11:42:52] *** Quits: tamird (textual@moz-gkumi9.dyn.optonline.net) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:50:41] <pnkfelix> WindowsBunny: yeah just delete  the files: `rm tmp/extended-errors/*`
[11:51:15] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[11:52:39] <pnkfelix> WindowsBunny: I'm still wondering about the best fix; I'll probably do something like what acrichto suggests
[11:53:09] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[11:54:03] *** Quits: jevin_ (jevin@moz-sra.ovp.12.72.IP) (Ping timeout: 121 seconds)
[11:54:09] *** Joins: nrc (nrc@moz-9luh02.xtra.co.nz)
[11:54:10] *** ChanServ sets mode: +o nrc
[11:55:10] *** Joins: michalt (uid82910@moz-7jrol4.charlton.irccloud.com)
[11:55:43] *** Quits: erz (erz@moz-n26c5c.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:56:21] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:58:59] *** Joins: samnmax (samnmax@moz-1vk.aq9.27.72.IP)
[11:59:03] *** Quits: nrc (nrc@moz-9luh02.xtra.co.nz) (Ping timeout: 121 seconds)
[12:00:23] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[12:03:03] *** Joins: yuriks (quassel@moz-hnlou0.yuriks.net)
[12:08:46] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[12:20:08] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[12:24:40] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[12:25:22] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[12:26:22] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Quit: Konversation terminated!)
[12:27:29] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[12:31:44] *** Quits: anom (anhedonia@moz-p76.o9j.219.91.IP) (Ping timeout: 121 seconds)
[12:33:29] *** Joins: anom (anhedonia@moz-pefcoq.torproxy-readme-arachnide-fr-35.fr)
[12:44:08] *** Joins: eddyb (eddyb@moz-uo6.6db.166.109.IP)
[12:54:15] *** Quits: eddyb (eddyb@moz-uo6.6db.166.109.IP) (Ping timeout: 121 seconds)
[12:54:23] *** Joins: eddyb (eddyb@moz-egg.q07.26.188.IP)
[12:58:24] *** Joins: bdero (bran@moz-mqs.7dh.189.18.IP)
[13:00:43] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[13:02:39] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[13:02:53] *** rkruppe_ is now known as rkruppe
[13:03:07] *** Quits: anom (anhedonia@moz-pefcoq.torproxy-readme-arachnide-fr-35.fr) (Ping timeout: 121 seconds)
[13:03:18] *** Joins: erz (erz@moz-8v4.af0.232.213.IP)
[13:05:37] *** Quits: erz (erz@moz-8v4.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[13:08:12] *** Joins: tamird (textual@moz-gkumi9.dyn.optonline.net)
[13:09:48] *** Joins: eddyb_ (eddyb@moz-egg.q07.26.188.IP)
[13:11:08] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[13:14:16] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[13:15:23] *** Joins: anom (anhedonia@moz-qpd.aq7.187.37.IP)
[13:15:45] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (Ping timeout: 121 seconds)
[13:17:41] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[13:18:44] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[13:18:50] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[13:19:49] *** Joins: mib_vuj7h9 (Mibbit@moz-juv.9o3.252.72.IP)
[13:20:07] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[13:26:32] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[13:29:03] *** Joins: dinfuehr (dinfuehr@moz-vjrefd.highway.telekom.at)
[13:36:41] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[13:37:46] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[13:40:38] *** Joins: erz (erz@moz-8v4.af0.232.213.IP)
[13:44:07] *** Joins: harrisonclarke (harrisoncla@moz-th044a.ns.bellaliant.net)
[13:46:30] *** Joins: jga (jga@moz-08s.t1q.244.77.IP)
[13:53:00] *** Quits: harrisonclarke (harrisoncla@moz-th044a.ns.bellaliant.net) (Connection closed)
[13:54:17] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[13:59:14] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[13:59:55] *** Joins: harrisonclarke (harrisoncla@moz-th044a.ns.bellaliant.net)
[14:01:06] *** Joins: duesenfranz_ (jona@moz-711djm.tirol.surfer.at)
[14:01:56] *** Quits: imperio (Mibbit@moz-8otf3a.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:04:16] *** Quits: mib_vuj7h9 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:04:36] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[14:04:53] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[14:04:58] *** Quits: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl) (Ping timeout: 121 seconds)
[14:07:23] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Connection closed)
[14:09:22] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[14:11:29] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[14:11:37] *** Quits: erz (erz@moz-8v4.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[14:13:11] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[14:17:26] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[14:18:15] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[14:18:18] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[14:20:23] *** Joins: jdm (jdm@moz-js24q5.ckpj.s0pt.0450.2001.IP)
[14:20:36] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[14:22:21] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[14:24:08] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[14:24:47] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[14:26:19] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[14:27:50] *** Quits: jdm (jdm@moz-js24q5.ckpj.s0pt.0450.2001.IP) (Quit: )
[14:28:01] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[14:28:38] *** Joins: jshs (jshs@moz-bafoi9.dip0.t-ipconnect.de)
[14:30:40] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[14:31:07] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[14:32:39] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[14:32:47] *** Quits: anom (anhedonia@moz-qpd.aq7.187.37.IP) (Ping timeout: 121 seconds)
[14:32:48] *** rkruppe_ is now known as rkruppe
[14:33:32] *** Quits: dinfuehr (dinfuehr@moz-vjrefd.highway.telekom.at) (Connection closed)
[14:44:50] *** Joins: anom (anhedonia@moz-r4sqrm.tor.camolist.com)
[14:45:07] <Fenhl> what do you think about `impl FromIterator<()> for ()`? I'm thinking of writing an RFC. Rationale would be enabling the use of Iterator::collect for Result<(), E>
[14:45:35] *** Joins: larsberg (Adium@moz-kmvlue.cable.rcn.com)
[14:45:41] *** Joins: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl)
[14:46:08] <eddyb_> Fenhl: huh
[14:46:28] <Fenhl> eddyb_: ?
[14:46:29] <eddyb_> Fenhl: could you give a one-line usecase?
[14:46:51] <eddyb_> it sounds interesting but I'm not sure how you mix Result and iterators
[14:47:39] <Fenhl> current code: let join_handle = thread::spawn(move || self.values.into_iter().map(dst.send).fold(Ok(()), Result::and));
[14:48:00] <Fenhl> with the impl: let join_handle = thread::spawn(move || self.values.into_iter().map(dst.send).collect();
[14:48:29] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[14:49:36] <Fenhl> eddyb_: actual code from the project I'm working on right now ^
[14:50:19] *** Joins: montezuma (Mibbit@moz-juv.9o3.252.72.IP)
[14:51:07] *** Quits: anom (anhedonia@moz-r4sqrm.tor.camolist.com) (Ping timeout: 121 seconds)
[14:51:34] <Fenhl> as pointed out by FreeFull in #rust, the current code has the additional disadvantage of consuming the entire iterator, which in this case means the thread will attempt to send all of the values, and potentially live significantly longer than it needs to
[14:53:03] *** Quits: montezuma (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:55:00] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:55:53] *** Joins: cods (fred@moz-g6qd4k.net)
[14:57:19] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[14:57:33] <eddyb_> Fenhl: how does that actually work? I'm a bit confused
[14:58:40] <eddyb_> so the impl you want would allow let _: () = iterator_of_units.collect();
[14:58:54] *** Joins: erz (erz@moz-imu.af0.232.213.IP)
[14:59:22] *** Quits: acharles (acharles@moz-mi1459.static.qwest.net) (Client exited)
[14:59:30] <eddyb_> does Result already have a generic FromIterator impl that would be composed with this () impl?
[14:59:59] <Fenhl> yes
[15:00:02] <Fenhl> impl<A, E, V> FromIterator<Result<A, E>> for Result<V, E> where V: FromIterator<A>
[15:00:05] *** Joins: frogonia (Mibbit@moz-juv.9o3.252.72.IP)
[15:00:24] *** Quits: frogonia (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:01:27] <eddyb_> Fenhl: so iterator collection works with Result like a monad?
[15:01:45] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[15:01:55] <eddyb_> I... I have to reevaluate every bit of code where I have iterators and Result and try to apply this
[15:03:04] <Fenhl> it returns the first error it finds, or else collects the contents of all Ok
[15:03:56] *** Quits: eddyb (eddyb@moz-egg.q07.26.188.IP) (Connection closed)
[15:04:00] *** eddyb_ is now known as eddyb
[15:04:11] <Fenhl> I've found it to be very useful since Vec<Result> -> Result<Vec> or similar is a fairly common pattern
[15:04:31] <Fenhl> especially with try!
[15:05:34] <eddyb> well, this is like .map(try!(_)), if that worked in a closure
[15:06:30] *** Quits: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl) (Ping timeout: 121 seconds)
[15:08:28] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[15:09:01] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[15:11:28] *** Joins: davebettin (davebettin@moz-l35chj.hfc.comcastbusiness.net)
[15:13:03] *** Joins: kumpler (Mibbit@moz-juv.9o3.252.72.IP)
[15:13:37] *** Quits: kumpler (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:17:41] <imperio> y a pas moyen de crÃ©er des mÃ©thodes pour des membres d'enums ?
[15:17:45] <imperio> me semblait avoir vu Ã§a quelque part...
[15:18:40] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[15:19:56] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[15:20:12] <kmc> imperio: impl MyEnum { ... } ?
[15:20:22] <geofft> imperio: an enum is a single type, methods have to be on an entire type 
[15:21:03] <imperio> oh sorry, I thought I was in #rust-fr
[15:21:32] <imperio> geofft: arf, i wanted to impl a different struct on each entry
[15:22:40] <imperio> geofft: hum... And if I want to impl the same function but with different code on each entry, is that possible ?
[15:23:01] <eddyb> imperio: you'd have to match over the variants
[15:26:06] *** Quits: erz (erz@moz-imu.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[15:27:26] *** Joins: erz (erz@moz-8v4.af0.232.213.IP)
[15:32:59] *** Quits: blank_name (blank_name@moz-lg2.tgt.79.172.IP) (Ping timeout: 121 seconds)
[15:34:06] *** Joins: blank_name (blank_name@moz-b044u1.mi.frontiernet.net)
[15:35:36] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[15:36:12] *** Quits: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP) (Client exited)
[15:37:14] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:38:04] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[15:38:07] *** Joins: dinfuehr (dinfuehr@moz-vjrefd.highway.telekom.at)
[15:38:08] *** Quits: blank_name (blank_name@moz-b044u1.mi.frontiernet.net) (Ping timeout: 121 seconds)
[15:40:44] *** Quits: davebettin (davebettin@moz-l35chj.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[15:41:09] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[15:41:20] *** Joins: brson (brson@moz-u3dg2t.sfo1.mozilla.com)
[15:41:21] *** ChanServ sets mode: +o brson
[15:41:40] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[15:41:49] *** rkruppe_ is now known as rkruppe
[15:43:17] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[15:43:32] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[15:44:09] *** Joins: kermit (Mibbit@moz-juv.9o3.252.72.IP)
[15:44:31] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[15:44:34] *** Quits: kermit (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:45:45] *** Quits: erz (erz@moz-8v4.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[15:47:22] *** Joins: davebettin (davebettin@moz-hde.5e5.136.67.IP)
[15:48:54] *** Joins: panitaliemom (Mibbit@moz-juv.9o3.252.72.IP)
[15:49:32] *** Joins: nodweber_ (nodweber@moz-knt.fgq.178.5.IP)
[15:49:54] *** Joins: blank_name (blank_name@moz-i5m.qsg.79.172.IP)
[15:51:50] *** Joins: erz (erz@moz-8v4.af0.232.213.IP)
[15:52:08] *** Joins: vhbit (textual@moz-u66.qv5.65.95.IP)
[15:52:32] *** Quits: erz (erz@moz-8v4.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[15:52:36] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[15:53:34] *** Joins: erz (erz@moz-8v4.af0.232.213.IP)
[15:58:51] <seanmonstar> eddyb: how should i include these .ll files? the first is 32mb
[15:59:28] *** Quits: nodweber_ (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[16:00:18] *** Quits: jevin (jevin@moz-sra.ovp.12.72.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:00:59] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[16:02:32] *** Quits: erz (erz@moz-8v4.af0.232.213.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[16:04:18] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[16:04:23] <eddyb> seanmonstar: can you reduce? if it's a library, comment out some modules that... well, it's not likely your library can be split into pieces
[16:04:33] <eddyb> seanmonstar: which one is smaller and by how much?
[16:04:43] <seanmonstar> currently building the slower one
[16:08:00] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[16:10:25] <eddyb> the fast one is 32MB? sheesh
[16:10:44] <eddyb> seanmonstar: wait, are optimizations enabled?
[16:10:59] <eddyb> seanmonstar: because then you get post-opt IR which is not as useful for the comparison
[16:11:04] <seanmonstar> --release
[16:11:12] <seanmonstar> :(
[16:11:23] *** Joins: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP)
[16:11:26] <eddyb> because the issue is likely in Rust's trans
[16:11:36] <seanmonstar> i assume with -O0 they'll be even bigger
[16:11:57] <eddyb> I hope you have somewhere to upload them :P
[16:12:03] <seanmonstar> of course
[16:12:05] <eddyb> (after compressing with xz)
[16:12:06] <seanmonstar> a gist :D
[16:12:21] <eddyb> I do not plan on reading them, if that's what you're thinking
[16:12:31] <seanmonstar> no
[16:12:46] <seanmonstar> its the easiest thing i can think of since the machine has no gui
[16:12:50] *** Joins: avikpal (avikpal@moz-q93.ti7.194.117.IP)
[16:13:02] <seanmonstar> git clone gist.github.com; git add hyper.ll; etc
[16:13:12] <eddyb> oh I forgot that is a thing
[16:13:35] <seanmonstar> so rebuild with -O0
[16:13:46] <eddyb> yeah
[16:14:09] <eddyb> so one theory would be that there is a larger number of monomorphized functions, but for that to happen, trans should take longer
[16:14:15] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[16:15:29] <seanmonstar> so much faster with -O0 XD
[16:15:53] <eddyb> it's not impossible I triggered some terrible corner case in LLVM
[16:17:59] *** Joins: jethrogb (jethrob@moz-p2iedd.scintilla.utwente.nl)
[16:18:25] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[16:19:11] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[16:19:28] <seanmonstar> joy, 64mbs
[16:19:33] <seanmonstar> oh well, take that gist
[16:20:22] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[16:21:39] *** Quits: harrisonclarke (harrisoncla@moz-th044a.ns.bellaliant.net) (Connection closed)
[16:22:18] *** Quits: amir (amir@moz-qbf4gg.fiber7.init7.net) (A TLS packet with unexpected length was received.)
[16:22:23] *** cmr changes topic to 'ERMAGER 1 day to 1.0.0 http://blog.rust-lang.org/2015/02/13/Final-1.0-timeline.html | https://botbot.me/mozilla/rust-internals | https://buildbot.rust-lang.org/homu/queue/rust | see also #rustc and #rust-libs'
[16:22:25] *** Joins: amir (amir@moz-jnohkj.3bcq.01f6.0168.2a02.IP)
[16:23:43] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[16:25:01] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[16:26:15] *** Joins: Rym______ (y@moz-dhb.0vk.38.217.IP)
[16:26:39] *** Quits: avikpal (avikpal@moz-q93.ti7.194.117.IP) (Connection closed)
[16:26:51] *** Joins: Diggsey (diggsey@moz-e3pv94.dsl.pipex.com)
[16:29:20] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[16:29:42] *** Joins: jdm (jdm@moz-js24q5.ckpj.s0pt.0450.2001.IP)
[16:30:07] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[16:33:29] *** Quits: jdm (jdm@moz-js24q5.ckpj.s0pt.0450.2001.IP) (Quit: )
[16:33:53] <aturon> burntsushi: just saw your error handling blog post -- thanks so much for writing this!
[16:34:04] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[16:34:06] <cmr> yeah, it's pretty incredible.
[16:34:11] <seanmonstar> ++
[16:35:28] <Eridius> link?
[16:36:32] <seanmonstar> Eridius: http://blog.burntsushi.net/rust-error-handling/
[16:37:09] <Eridius> wow, that's pretty long
[16:37:20] *** Joins: blank_na1e (blank_name@moz-6n9.3ar.36.50.IP)
[16:37:20] <seanmonstar> its for complete beginners
[16:37:26] <seanmonstar> so theres lots to discuss
[16:37:29] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[16:37:29] *** Quits: blank_name (blank_name@moz-i5m.qsg.79.172.IP) (Ping timeout: 121 seconds)
[16:37:34] <steveklabnik> yeah
[16:37:38] <steveklabnik> it's so good though
[16:37:45] <steveklabnik> like, this is what chpaters of 'effective rust' should be like
[16:39:14] *** Quits: dinfuehr (dinfuehr@moz-vjrefd.highway.telekom.at) (Connection closed)
[16:39:26] <brson> i have 1.0 builds to test. please don't post them to reddit
[16:39:26] <brson> https://static.rust-lang.org/dist/staging/index.html
[16:40:32] <brson> but please do test things. i'll verify hashes and sigs
[16:40:38] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[16:40:47] <brson> vadimcn WindowsBunny: do you mind testing the windows installs?
[16:40:56] <cmr> I can test them too.
[16:41:01] <brson> cmr: thanks!
[16:41:28] <geofft> brson: why are there .asc and .asc.asc files? 
[16:41:32] <brson> 1.0 docs are up too http://doc.rust-lang.org/1.0.0/
[16:42:08] <geofft> and, uh, .asc.sha256.asc.sha256 
[16:42:13] <brson> geofft: lol
[16:42:25] <brson> the script for generating them is pretty dumb
[16:42:32] <brson> i actually don't know offhand what causes .asc.asc
[16:42:42] <brson> the ones that matter are all there though
[16:42:46] <brson> there's just lots of extra garbage
[16:42:47] <geofft> did you run the signing script twice? 
[16:43:01] <geofft> it sounds like you signed and sha256'd all the signatures and sha256es 
[16:43:16] <doener> seanmonstar: can you check if there are calls to the assume intrinsic left in optimized .ll file?
[16:43:34] <brson> geofft: oh, the packaging process happens twice and during the second stage everything gets re-hashed and signed
[16:43:45] <brson> well, not twice, but it's a two step process
[16:44:32] <steveklabnik> hehe
[16:44:39] <steveklabnik> HOW DO YOU KNOW THE SIG IS CORRECT WITHOUT SIGNING IT?
[16:44:43] <steveklabnik> ahh computers
[16:44:45] *** Joins: c0170 (c0170@moz-dev.ffi.127.79.IP)
[16:44:45] <brson> lol
[16:44:47] <cmr> brson: may want to consider setting up https://www.certum.eu/certum/cert,offer_en_open_source_cs.xml to sign the windows installers, they get trust warnings right now.
[16:45:13] <brson> awesome. i'll file a bug on it
[16:45:16] <cmr> it's especially obnoxious on windows 8/10 where you have to dig through a dialog to get it to actually run the exe
[16:45:22] <seanmonstar> doener: grep assume hyper.ll?
[16:45:33] <doener> seanmonstar: should do the trick
[16:45:38] <doener> seanmonstar: may call.*assume
[16:45:41] <doener> *maybe
[16:46:00] <seanmonstar> its not in the before, i'll need to build the after
[16:46:25] <brson> https://github.com/rust-lang/rust-packaging/issues/31
[16:46:35] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Ping timeout: 121 seconds)
[16:48:31] *** Quits: c0170_ (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[16:49:32] <brson> uploading 1.0 docs to doc.rlo/stable/ now
[16:49:44] *** Joins: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net)
[16:50:25] <seanmonstar> doener: 0 results for after as well
[16:50:46] <doener> seanmonstar: ok, thanks
[16:50:58] <seanmonstar> oh boy, should i be adding `stable` to my travis.yml?
[16:51:23] <brson> seanmonstar: ooh, good point. does travis have stable support in place?
[16:51:36] <seanmonstar> brson: it just passes the "version" string to rustup
[16:51:44] <seanmonstar> so "nightly" and "beta" just work
[16:52:10] <cmr> brson: all's smooth with the windows exe and installers on 10 and 8.1
[16:52:35] <brson> seanmonstar: cool
[16:52:44] <brson> cmr: awesome. thank you so much
[16:52:53] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[16:53:26] <cmr> brson: there doesn't seem to be a source tarball?
[16:53:29] <seanmonstar> brson: https://travis-ci.org/hyperium/hyper/jobs/62508195#L85
[16:53:36] <seanmonstar> --spec=$version
[16:53:44] <brson> cmr: hm...
[16:54:24] <seanmonstar> i wonder if i should add 'stable' or '1.0.0'
[16:55:03] <cmr> brson: (which is really important for distro packagers!)
[16:56:35] <brson> cmr: due to minutia of how the automation works, source is already uploaded here https://static.rust-lang.org/dist/rustc-1.0.0-src.tar.gz
[16:56:51] <cmr> Ok.
[16:58:24] <eddyb> seanmonstar: so what's up?
[16:58:33] <eddyb> seanmonstar: I don't see any links to data
[16:58:41] <seanmonstar> eddyb: i pasted link into the issue?
[16:59:01] <seanmonstar> didnt want it lost in the channel with 1.0 stuffs happening
[16:59:03] <eddyb> I reloaded that after you said something about gist, and there was nothing new :(
[16:59:10] <eddyb> there we go :D
[16:59:46] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[16:59:46] *** ChanServ sets mode: +o pnkfelix
[17:02:24] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Connection closed)
[17:03:09] <eddyb> seanmonstar: wtf, wget gives me 403. I know I've downloaded things from gists before
[17:03:30] <seanmonstar> eddyb: they're too big to download, must git clone
[17:04:51] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[17:06:32] *** Joins: dschatzberg (dschatz@moz-nk1clf.bu.edu)
[17:08:18] <dschatzberg> Why does libcore have a link dependency on _Unwind_Resume?
[17:08:32] <steveklabnik> dschatzberg: to support unwinding?
[17:08:58] <dschatzberg> why is it unwinding? I thought it just panics
[17:09:04] *** Parts: dschatzberg (dschatz@moz-nk1clf.bu.edu) ("Leaving")
[17:09:09] *** Joins: dschatzberg (dschatz@moz-nk1clf.bu.edu)
[17:10:11] <seanmonstar> dschatzberg: panic causes unwinding
[17:10:35] <dschatzberg> then I would expect librt to have such a dependency, not libcore
[17:11:05] <dschatzberg> the docs say that consumers of core get to define rust_begin_unwind
[17:11:19] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[17:12:24] <dschatzberg> https://doc.rust-lang.org/core/panicking/ -> "The core library cannot define panicking"
[17:12:39] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[17:12:43] *** rkruppe_ is now known as rkruppe
[17:12:44] <dschatzberg> so I see no reason why libcore would try to unwind
[17:14:08] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[17:15:08] <seanmonstar> if i want to make a rustc plugin that modifies every function without decorating it, can i?
[17:15:35] <cmr> seanmonstar: I think so, yeah.
[17:15:48] <seanmonstar> possibly best i can see is requiring #![do_stuff] after #[plugin(do_stuff)]?
[17:15:50] <cmr> seanmonstar: easiest way I can think of is a crate-level attribute.
[17:15:53] <cmr> yeah
[17:16:09] <seanmonstar> ok
[17:16:23] <Eridius> I wonder if it's worth letting plugins add arbitrary folders to the crate without requiring decorators?
[17:17:18] <seanmonstar> cmr: looks like ItemModifier receives an Annotatable, and i dont see crate in that enum
[17:17:46] <seanmonstar> or a crate is Item?
[17:18:26] *** Joins: Kxepal (Miranda@moz-u0omr9.pppoe.mtu-net.ru)
[17:19:48] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[17:20:25] *** chmanchester|afk is now known as chmanchester
[17:21:06] <cmr> pretty sure crates are just modules.
[17:21:54] *** Quits: vhbit (textual@moz-u66.qv5.65.95.IP) (Quit: Textual IRC Client: www.textualapp.com)
[17:25:22] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[17:25:54] *** Parts: dschatzberg (dschatz@moz-nk1clf.bu.edu) ("Leaving")
[17:26:06] <Manishearth> Eridius: I want that]
[17:26:38] <Manishearth> though I wonder if overuse will cause  immensely cryptic spans
[17:29:41] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[17:31:24] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Ping timeout: 121 seconds)
[17:31:47] <nmatsakis> acrichto: ping
[17:31:50] *** Quits: imperio (Mibbit@moz-8otf3a.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:31:52] <acrichto> nmatsakis: pong
[17:32:12] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[17:32:13] <nmatsakis> acrichto: so I am constnatly annoyed by how rustdoc uses compiler-internal data structures to generate its output;
[17:32:27] <nmatsakis> acrichto: mostly because I want to generally desugar and simplify those, and this makes it harder to reconstruct what the user wants to see;
[17:32:36] <nmatsakis> acrichto: have we given any thought to an alternate approach?
[17:32:49] <nmatsakis> acrichto: I'm not really sure just what that means, I can imagine it might mean serializing two things
[17:33:03] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[17:33:09] <nmatsakis> acrichto: I guess this is only used for `pub use` things from another crate?
[17:33:20] <acrichto> nmatsakis: we already do have quite a bit of logic to decompose bounds and reassemble them back into a user-presentable state, but yeah this is all connected to building documentation from metadata
[17:33:39] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[17:33:42] *** rkruppe_ is now known as rkruppe
[17:33:43] <nmatsakis> acrichto: right, it's the need for that logic that i'm referring to
[17:33:56] <acrichto> when we build docs from metadata we only have comipler data structures to go from unfortunately
[17:34:01] *** Joins: anom (anhedonia@moz-cfrupk.tor-exit.network)
[17:34:05] <acrichto> we could put more stuff in the metadata so we don't have to recompose the original AST
[17:34:09] <acrichto> but that bloats metadata :(
[17:34:26] <acrichto> nmatsakis: the primary alternative approach here would be for rustdoc to have its own metadata
[17:34:26] <nmatsakis> acrichto: that's the only thing I've thought of so far :) -- well, that or go fetch sources somehow
[17:34:40] <acrichto> e.g. foo.rustdoc.meta
[17:34:41] <nmatsakis> acrichto: by "that" I mean serializing both the compiler's internal contents as well as some suvbset of the AST
[17:34:50] <acrichto> yeah
[17:34:55] <nmatsakis> acrichto: I see, yes I guess that's be an option
[17:35:00] <acrichto> I feel like it's bad enough though that comments are in metadata :P
[17:35:16] <nmatsakis> having a side file might make a lot of sense
[17:35:23] <nmatsakis> or alternatively a tool for stripping rustdoc metadata out
[17:35:31] <nmatsakis> but a side file seems just easier
[17:35:58] <nmatsakis> I wonder how often people would want to be able to generate docs for somebody else's crates
[17:36:06] <nmatsakis> like, we're using this for pub use'd items,
[17:36:16] <nmatsakis> that are all from our control,
[17:36:21] <nmatsakis> but I can imagine if you wrap someone's else's libary
[17:36:25] <nmatsakis> it's a kind of different feature
[17:36:28] <acrichto> nmatsakis: yeah while a side file is easier it's also a super nice property to not need to have one
[17:36:34] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Ping timeout: 121 seconds)
[17:36:35] <nmatsakis> and in that case side file would be a kind of pain
[17:36:35] <acrichto> b/c it's an extra piece of metadata that has to be generated and managed
[17:37:09] <nmatsakis> acrichto: seems like we should measure what the cost to metadata would really be :)
[17:37:10] <acrichto> in practice this probably doesn't matter too much though
[17:37:13] <nmatsakis> after all
[17:37:15] <nmatsakis> in a lot of cases
[17:37:15] <acrichto> yeah lol
[17:37:18] <nmatsakis> we're seraizliing the whole ast anyway!
[17:37:28] <acrichto> one plausible part is to compress all the rustdoc metadata
[17:37:33] <acrichto> b/c metadata is in general uncompressed today
[17:37:38] <acrichto> but rustdoc does not need to be that speedy
[17:37:39] <acrichto> just the compiler
[17:37:41] <nmatsakis> we used to compress it, right?
[17:37:46] <brson> there are now docs at stable/ http://doc.rust-lang.org/stable/index.html
[17:37:54] <nmatsakis> brson: nice!
[17:37:56] <Manishearth> \o/
[17:38:00] <steveklabnik> :D :D :D
[17:38:26] <acrichto> nmatsakis: yeah we used to, but it's super slow :(
[17:38:31] <acrichto> libstd has a lot of metadata
[17:38:37] <Manishearth> seanmonstar: http://doc.rust-lang.org/syntax/ast/struct.Crate.html
[17:38:38] <acrichto> and decompressing all of it for all compiles is bad
[17:39:02] <seanmonstar> Manishearth: ?
[17:39:14] *** Quits: blank_na1e (blank_name@moz-6n9.3ar.36.50.IP) (Ping timeout: 121 seconds)
[17:39:18] <Manishearth> seanmonstar: a crate is actually a module
[17:39:43] <Manishearth> the only difference is that Item_::Mod  inside an Item is a mod
[17:39:47] <seanmonstar> Manishearth: so my extension can receive it as Annotatable::Item?
[17:39:52] <Manishearth> and Item_::Mod inside a Crate is a crate
[17:39:53] <Manishearth> yes
[17:40:07] <Manishearth> http://doc.rust-lang.org/syntax/ast/struct.Item.html
[17:40:11] <Manishearth> http://doc.rust-lang.org/syntax/ast/enum.Item_.html
[17:40:29] <Manishearth> well, maybe
[17:40:32] <Manishearth> hm
[17:40:35] <seanmonstar> i'll be doing some printlns :D
[17:40:37] <nmatsakis> acrichto: yeah ok
[17:40:47] <Manishearth> I thought it was Annotatable::Item(Item_)
[17:40:49] * Manishearth looks
[17:41:07] <Manishearth> seanmonstar: ...perhaps not
[17:41:20] <Manishearth> an Item is never a crate
[17:41:25] <nmatsakis> acrichto: mostly I'm annoying because I'm trying to add some implicit predicates here and there, which feels like the cleanest way  to address what I'm working on, and it works great in the compiler, but it's a pain to filter them out from rustdoc 
[17:41:29] <Manishearth> but the expander might be converting items to crates
[17:41:33] <nmatsakis> acrichto: er, I'm annoyed. maybe annoying too
[17:41:48] <Manishearth> *crates to items
[17:42:02] <Manishearth> seanmonstar: test it and let me know; I'll fix it over the weekend if it doesn;t work
[17:42:13] <acrichto> nmatsakis: lol I know what you mean, reassembling things in rustdoc isn't always... fun
[17:42:15] <seanmonstar> Manishearth: well, im soon to find out. i've stuck #![my_thing] in an example, and will println!("{:?}", item) in the expand fn
[17:42:16] <Manishearth> seanmonstar: wait. crates aren't annotatable in the usual sense
[17:42:22] <acrichto> nmatsakis: I can try to take care of the reassembly though if you want to just ignore it for now
[17:42:38] <Manishearth> seanmonstar: you can't decorate a crate, though you can modify it
[17:42:58] <seanmonstar> Manishearth: i have a MultiModifier
[17:43:05] <Manishearth> yeah, I know
[17:43:08] <Manishearth> but what
[17:43:18] <Manishearth> if you weore a decorator that decorated a crate
[17:43:20] *** Quits: anom (anhedonia@moz-cfrupk.tor-exit.network) (Ping timeout: 121 seconds)
[17:43:28] <Manishearth> I should have another look at those code paths
[17:44:09] *** Joins: SilverKey (SilverKey@moz-b7q751.biz.rr.com)
[17:44:40] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[17:44:40] *** ChanServ sets mode: +o pcwalton
[17:45:22] <nmatsakis> acrichto: in this case it's mostly just filtering things out
[17:45:35] *** Joins: blank_name (blank_name@moz-2kp51l.mi.frontiernet.net)
[17:45:37] <nmatsakis> acrichto: I can do it I was just pondering how to fix the situation in longe term
[17:45:59] <acrichto> nmatsakis: this may end up getting too unwieldy yeah 
[17:46:05] <nmatsakis> acrichto: I was trying to add a kind of "implicit" field, but it got a bit annoying, trying to think what's the easiest way to record in the compiler what's implicit and what's not;
[17:46:14] <nmatsakis> acrichto: maybe I'll just hack up rustdoc in a hard-coded way instead
[17:46:17] <nmatsakis> acrichto: to know what to ignore
[17:46:55] <seanmonstar> Manishearth: just tested, the item passed to expand is an Item_::Mod
[17:47:04] <seanmonstar> and its the one i wanted, so i'm set
[17:47:09] <Manishearth> cool
[17:47:10] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[17:47:16] <eddyb> nmatsakis: the phantom stuff?
[17:48:51] <nmatsakis> eddyb: phantom?
[17:49:41] <eddyb> the PhantomData marker
[17:49:56] <seanmonstar> Manishearth: now to modify every fn... do i register a visitor, or recurse the item myself?
[17:49:58] <eddyb> I recall you wanted to add special support for that
[17:51:15] <Manishearth> seanmonstar: careful, P<T> is not DerefMut
[17:51:24] <Manishearth> so you basically have to COW the AST
[17:51:26] <Manishearth> good luck
[17:51:35] <seanmonstar> \o/
[17:51:40] <Manishearth> seanmonstar: try Folder
[17:51:48] <Manishearth> not sure if it will work for you
[17:51:55] <Manishearth> but that soudns like a better pattern
[17:52:16] *** Quits: jga (jga@moz-08s.t1q.244.77.IP) (Ping timeout: 121 seconds)
[17:52:31] <seanmonstar> Manishearth: is that... right? it sounds like the opposite of what i'm doing
[17:52:35] <Manishearth> I wish the AST was derefmut during expansion
[17:52:38] <Manishearth> doener: *shrug*
[17:52:39] <Manishearth> it might
[17:52:42] <Manishearth> * seanmonstar 
[17:52:48] <Manishearth> otherwise visitor
[17:52:48] <seanmonstar> in that, i'm inserting Expr, not folding
[17:52:54] <Manishearth> otherwise manual recursion
[17:53:13] <rkruppe> Yurume: I have a question about flt2dec/grisu, specifically the powers of ten cache, got a minute?
[17:54:07] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[17:54:46] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[17:54:56] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[17:58:20] <Manishearth> aw, I need HKT for a nice AST typestate api
[17:59:23] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[17:59:26] <Manishearth> it's still doable, just not so neat
[17:59:40] <Manishearth> eddyb: does P<T> *need* to be non-DerefMut during expansion?
[18:01:02] *** Quits: untitaker (untitaker@moz-p6f4vq.highway.telekom.at) (Ping timeout: 121 seconds)
[18:01:12] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[18:01:38] <eddyb> what are you doing to precious?
[18:02:12] <Manishearth> eddyb: precious?
[18:02:23] <eddyb> P
[18:02:29] <eddyb> what do you think it stood for?
[18:02:33] <Manishearth> eddyb: no, just that COW-ing the AST during expansion  seems heavy
[18:02:34] <Manishearth> :P
[18:02:47] <eddyb> it's not CoW, it's in-place functional update
[18:03:05] *** Joins: untitaker (untitaker@moz-4k4vpj.highway.telekom.at)
[18:03:11] <eddyb> i.e. folding reuses all the P<T> allocations (spare a few that have weird data flow out of them)
[18:03:14] <Manishearth> eddyb: I mean that SyntaxExtensions usually need to be written in a way that COWs it
[18:03:41] <Manishearth> for example if I want to replace a function with a slightly modified function, I have to clone its components and reconstruct it
[18:03:50] <eddyb> no you don't
[18:04:02] <Manishearth> then what?
[18:04:08] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[18:04:27] <eddyb> you get ownership of the right level so you take apart the components and then reconstruct them
[18:04:53] <Manishearth> hmmm
[18:04:57] <Manishearth> oh nvm
[18:05:21] <Manishearth> my case was different, I needed to clone things because I was  doing something else
[18:05:28] *** chmanchester is now known as chmanchester|mtg
[18:05:40] *** Quits: Rym______ (y@moz-dhb.0vk.38.217.IP) (Ping timeout: 121 seconds)
[18:06:38] <eddyb> seanmonstar: if you have to modify things, you do need the Folder
[18:07:55] <eddyb> seanmonstar: the AST is immutably affine, folding lets you restructure parts of its interior correctly
[18:14:05] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[18:14:59] <seanmonstar> eddyb: so in expand, i create a Folder and fold the received Item
[18:16:37] <eddyb> what is this supposed to do, in the end?
[18:17:14] *** Quits: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP) (Ping timeout: 121 seconds)
[18:17:16] <seanmonstar> eddyb: at the end, have converted every Expr into a (my_expr, orig_expr)
[18:17:27] <eddyb> a tuple?
[18:17:32] <seanmonstar> or, {my_expr; orig_expr}
[18:17:40] <eddyb> ah
[18:18:17] <eddyb> yeah, this is the typical usecase for a Folder. overload fold_expr and return an ExprBlock with the trailing expression being the one you get as an argument
[18:18:29] <bstrie> when you compile rust from source, where are you supposed to get cargo from?
[18:18:32] <eddyb> (and then a bunch of statements that do what you want to do)
[18:18:46] <eddyb> bstrie: they aren't very tightly locked together
[18:18:58] <bstrie> people are always complaining about how tightly locked together they are
[18:19:02] <eddyb> bstrie: you can use a cargo nightly with a custom build
[18:19:11] <eddyb> idk, just use a nightly from the same week?
[18:19:32] <geofft> does this work if your rust is a cross-compiling rust? 
[18:19:37] <eddyb> sure
[18:19:42] <geofft> do you have to build a cross-cargo, or can a normal cargo work with a cross-rust? 
[18:19:47] <eddyb> there is no such thing as a cross-compiling rustc btw
[18:19:59] <eddyb> it's the libraries that you need to cross-compile
[18:20:17] <eddyb> any rustc can compile for any target, even ones it doesn't know about (via target specs)
[18:20:37] <eddyb> geofft: same goes for cargo, the tooling is cross-capable
[18:20:53] <seanmonstar> eddyb: and is there a particular entry fn to start off the folder?
[18:20:57] <eddyb> the main issue with building libraries for the target is that they have to be the exact same version
[18:21:06] <eddyb> seanmonstar: what kind of node do you have?
[18:21:17] <seanmonstar> Item
[18:21:19] <eddyb> seanmonstar: folder.fold_item(item)
[18:21:34] <eddyb> you can look at the docs ;;)
[18:21:38] <seanmonstar> ok, so i can construct the folder in my fn and just call that directly
[18:21:46] <eddyb> yes
[18:21:51] <seanmonstar> yea i see all the fold_*
[18:23:02] <seanmonstar> eddyb: i see it return SmallVec, but expand expects Item as return value
[18:23:20] <seanmonstar> fold_item_simple looks closer to what i want
[18:24:06] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[18:24:17] <eddyb> wait, is expansion limited to a single item? that doesn't seem right?
[18:24:35] <eddyb> seanmonstar: what kind of syntax extension are you registering?
[18:24:46] <seanmonstar> a modifier
[18:25:13] <eddyb> if fold_item_simple works, use it
[18:25:30] <eddyb> http://doc.rust-lang.org/syntax/fold/trait.Folder.html I meant to link this btw
[18:25:37] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[18:25:42] <seanmonstar> eddyb: http://doc.rust-lang.org/nightly/syntax/ext/base/trait.MultiItemModifier.html
[18:26:25] <seanmonstar> ok, i think i got it, thanks
[18:28:20] <eddyb> seanmonstar: someone had me listen to design specs for a few hours, I'm back to your IR. I see they are very similar in size
[18:28:26] *** Parts: imperio (Mibbit@moz-8otf3a.fbx.proxad.net) ()
[18:28:29] <seanmonstar> yep
[18:28:35] * eddyb fires up kdiff3
[18:29:46] <eddyb> even the progress window is lagging!
[18:30:11] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[18:30:29] *** Joins: anom (anhedonia@moz-ib8bp9.us.unmetered.com)
[18:30:55] *** Quits: apoelstra (username@moz-pvbasl.net) (Ping timeout: 121 seconds)
[18:32:43] *** Joins: apoelstra (username@moz-pvbasl.net)
[18:32:54] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[18:35:15] <eddyb> seanmonstar: and I'm in
[18:35:37] <seanmonstar> godspeed
[18:36:57] <seanmonstar> oh huh. fold_mac panics by default
[18:37:03] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[18:37:09] <eddyb> hehe yeah
[18:37:25] <eddyb> take a look at other Folder impls used during expansion
[18:38:45] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[18:38:51] <eddyb> seanmonstar: oops I forgot to use rustfilt
[18:39:13] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[18:39:46] <eddyb> seanmonstar: I wish there was a way to disable both debuginfo and optimizations
[18:40:00] <seanmonstar> isn't there?
[18:40:03] <cmr> `rustc`?
[18:40:45] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[18:40:49] <eddyb> cmr: via cargo
[18:41:02] <seanmonstar> eddyb: cargo rustc -- weeeeeeee
[18:41:03] <eddyb> I mean, you can set some flags in Cargo.toml
[18:41:18] <eddyb> seanmonstar: doesn't that default to the profile's flags?
[18:41:37] <seanmonstar> no idea
[18:43:30] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[18:45:23] *** Joins: edunham (edunham@moz-meu.gm8.131.104.IP)
[18:47:19] <eddyb> and rustfilt is broken :/
[18:49:47] *** chmanchester|mtg is now known as chmanchester
[18:49:55] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[18:50:18] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[18:50:25] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[18:50:27] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[18:50:50] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[18:53:05] *** Joins: arielb1 (Mibbit@moz-os36bp.tau.ac.il)
[18:55:12] <Manishearth> Ugh I want to write this blog post before 1.0 but I'm sleepy but my mind isn't letting me sleep because I haven't written this blog post....
[18:55:17] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[18:56:13] *** Joins: hyunsik (hyunsik@moz-3qgjl9.ca.comcast.net)
[18:58:26] <Eridius> > Rust is a systems language. Iâ€™m not sure what that term means, but it seems to imply some combination of native code compilation, not being Fortran, and making no mention of category theory in the documentation.
[18:58:30] <Eridius> :D
[18:58:33] <Eridius> (http://www.evanmiller.org/a-taste-of-rust.html)
[18:58:45] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[18:58:54] <Eridius> Manishearth: jot down some notes on what you're thinking about now to get it out of your brain and then write the post tomorrow
[18:59:24] <Eridius> your brain is keeping you up because it thinks this is important, but if you write down what you're thinking then it'll be satisfied that you've captured it
[18:59:39] *** Quits: tamird (textual@moz-gkumi9.dyn.optonline.net) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[18:59:53] <steveklabnik> Eridius: i wrote a huuuuge reply to that post on HN
[19:00:20] <Eridius> that's where I found it. I'll read the comments after I read the post :)
[19:00:24] <steveklabnik> :)
[19:00:28] *** Joins: tamird (textual@moz-gkumi9.dyn.optonline.net)
[19:00:29] <steveklabnik> it's a good post
[19:00:43] <Manishearth> Eridius: I did, I did, still not good
[19:00:49] <Manishearth> my brain wants to write and write and write
[19:00:56] <Manishearth> and when I sit down to write, my brain wants to sleep
[19:00:59] <Manishearth> I wish I was a robot
[19:01:29] <Manishearth> and then people keep posting awesome Rust posts on reddit/HN, so i want to read those too
[19:01:32] <Manishearth> :p
[19:04:25] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[19:05:16] *** Quits: larsberg (Adium@moz-kmvlue.cable.rcn.com) (Quit: Leaving.)
[19:05:39] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[19:05:51] *** rkruppe_ is now known as rkruppe
[19:05:54] <Manishearth> kmc: might want to talk about how h5e does awesome parsing via Rust magic here https://news.ycombinator.com/item?id=9546382
[19:07:14] *** Joins: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at)
[19:07:14] *** Quits: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at) (Connection closed)
[19:07:22] *** Joins: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at)
[19:07:29] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[19:11:17] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[19:13:27] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[19:14:35] *** Quits: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net) (Connection closed)
[19:16:57] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[19:17:09] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[19:17:18] *** Quits: arielb1 (Mibbit@moz-os36bp.tau.ac.il) (Quit: http://www.mibbit.com ajax IRC Client)
[19:17:40] *** Joins: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net)
[19:18:28] *** Quits: brson (brson@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[19:20:30] *** Quits: anom (anhedonia@moz-ib8bp9.us.unmetered.com) (Ping timeout: 121 seconds)
[19:21:11] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[19:22:14] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[19:23:56] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[19:24:46] *** Quits: michalt (uid82910@moz-7jrol4.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[19:27:22] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[19:27:41] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[19:34:17] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[19:37:05] <kmc> Manishearth: I don't post on hn
[19:37:20] <kmc> but feel free
[19:37:36] <Manishearth> kmc: k
[19:38:43] *** Quits: panitaliemom (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:38:46] <Manishearth> kmc: FWIW I really want a blog post version of that talk of yours. (a) the talk is hard to link to, being part of a video with 4 other talks (b) blog posts are read by more people and can contain links and more info
[19:39:04] <Eridius> oh wow, it's been almost 2 years since I got involved in rust. How has it been that long?
[19:39:05] <Manishearth> h5e is a great example of the awesomeness of libsyntax and macros and Rust
[19:39:30] <kmc> Manishearth: the thing is that HTML is *specified* as "C-style state machines"
[19:39:42] <kmc> so that's what the tokenizer looks like
[19:39:53] <kmc> but at least it's 1,000 lines and not 8,000
[19:39:57] <steveklabnik> heh
[19:40:01] <Manishearth> kmc: yeah the loc thing was my point
[19:40:19] <kmc> the HTML syntax has nothing to do with the lexer/parser theory you learn in school
[19:40:39] <kmc> but the extent of this is very hard to appreciate until you start looking into writing a HTML parser :)
[19:40:43] <kmc> anyway you can say that on hn if you want
[19:40:51] <Manishearth> Rust's features come together quite well in h5e -- whether it's just that html5 is well suited for that or you just were awesome and came up with a great design, it's stilla nice example
[19:41:34] <kmc> yeah
[19:41:41] <kmc> plus we'll have good parser combinators / generators eventually
[19:41:44] <kmc> for non-insane syntax
[19:41:58] <Manishearth> I hsould contribute more to h5e, it's DOM-y and  libsyntaxy and fun
[19:42:02] <Manishearth> *should
[19:42:02] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[19:42:15] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[19:42:24] <Manishearth> then again, the html spec ....
[19:44:26] <kmc> Manishearth: btw you can link to the slides istead of video
[19:44:54] <Manishearth> yeah but the slides don't contain the meat of it
[19:44:56] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[19:45:01] <Manishearth> (I usually link to both)
[19:45:02] *** Quits: semarie (semarie@moz-vjb.r8r.42.192.IP) (A TLS packet with unexpected length was received.)
[19:49:28] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[19:50:18] *** Joins: bytewise (bytewise@moz-agoafm.adsl.alicedsl.de)
[19:51:33] *** Quits: bdero (bran@moz-mqs.7dh.189.18.IP) (Ping timeout: 121 seconds)
[19:52:27] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[19:54:18] <eddyb> seanmonstar: my rustfilt script is broken again so I'm attempting to peek at the IR with some manual preprocessing
[19:54:28] <seanmonstar> :(
[19:55:31] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[19:59:58] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[20:00:21] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[20:01:00] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[20:01:26] *** Joins: genbattle (genbattle@moz-4v0.gkd.16.182.IP)
[20:01:33] <eddyb> seanmonstar: sheesh sed just doesn't want to cooperate >_<
[20:02:30] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[20:03:39] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[20:08:44] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[20:08:59] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[20:09:57] *** Joins: anom (anhedonia@moz-ums8mr.tor-exit.network)
[20:11:16] *** Joins: mib_5q5abe (Mibbit@moz-juv.9o3.252.72.IP)
[20:12:00] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[20:14:39] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[20:16:21] *** Joins: arielb1 (Ariel@moz-2trv48.red.bezeqint.net)
[20:18:08] <eddyb> seanmonstar: this is really weird
[20:18:43] <doener> eddyb: any clues what's going on?
[20:18:48] <eddyb>   %31 = call i64 @num::usize::wrapping_add::hc20f20bd511909374ch(i64 %26, i64 %30), !dbg 
[20:18:59] <eddyb> this call does not exist before
[20:19:07] <eddyb> I mean, it's inlined
[20:19:24] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Connection closed)
[20:19:41] <eddyb> was #[inline(always)] removed?
[20:19:52] <eddyb> hang on a second
[20:20:27] <doener> eddyb: that call probably wasn't made before. There was a PR to change the pointer arith in iterators from regular add to wrapping_add
[20:20:31] <eddyb> it's something that used to do... yeah
[20:20:47] <eddyb> seanmonstar: okay, so this data is useless :(
[20:20:53] <doener> eddyb:  let me check if the problem is gone with my work to replace that with GEP
[20:21:07] <eddyb> doener: I don't think it has anything to do with this
[20:21:24] <eddyb> (but why do the wrapping functions not have #[inline(always)]?!
[20:21:27] <doener> yeah, seems unlikely, but doesn't hurt to try, right?
[20:21:37] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[20:21:55] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[20:22:03] <eddyb> seanmonstar: what I seem to need is pre-optimization IR for -O
[20:22:11] <eddyb> -Z save-temps, maybe?
[20:22:14] <doener> -C
[20:22:16] <eddyb> does that even output .ll?
[20:22:45] <doener> only a .bc, needs to go through llvm-dis to get an .ll
[20:22:53] <eddyb> cah
[20:25:56] <eddyb> there's nothing else that's obvious
[20:27:44] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[20:28:32] <vadimcn> brson: the installers look ok
[20:28:52] <vadimcn> ...except for not being signed, of course.  I dunno if you want to deal with certs right now.
[20:30:27] *** Joins: nham (nham@moz-755.bu3.214.98.IP)
[20:30:34] *** Joins: brson (brson@moz-u3dg2t.sfo1.mozilla.com)
[20:30:35] *** ChanServ sets mode: +o brson
[20:32:09] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[20:32:46] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Ping timeout: 121 seconds)
[20:34:30] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[20:34:43] <Manishearth> Any feedback on this partially-written post?
[20:34:45] <Manishearth> https://github.com/Manishearth/manishearth.github.io/blob/source/source/_posts/2015-05-08-the-problem-with-shared-mutability.markdown
[20:34:54] <Manishearth> feel free to eave comments in the github commit
[20:35:09] <Manishearth> or ping me
[20:35:28] <Manishearth> I'm going to bed now, but some feedback in the morning (what more I can add, what could be improved) would be nice
[20:35:36] *** Quits: kushal (kdas@moz-plp31c.202.sitibroadband.in) (Quit: Leaving)
[20:36:11] <eddyb> Manishearth: I don't see you mentioning reentrance
[20:36:14] <reem> There are currently three rust posts on page 1 of hn, wow
[20:36:44] <eddyb> (which gives you multi-threaded issues even if you have a single actual thread of execution)
[20:37:55] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[20:39:04] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[20:40:46] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[20:40:49] *** Joins: nrc (nrc@moz-9luh02.xtra.co.nz)
[20:40:49] *** ChanServ sets mode: +o nrc
[20:40:56] *** Joins: redshift (redshift@moz-c8c.73t.246.204.IP)
[20:41:14] *** Quits: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at) (Connection closed)
[20:41:16] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[20:42:25] *** Joins: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at)
[20:42:35] <vadimcn> dschatzberg: LLVM generates a call to _Unwind_Resume at the end of landing pads to resume unwinding, so virtually every object file has this dependency.
[20:43:38] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[20:45:38] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[20:46:32] *** Quits: dinfuehr (dinfuehr@moz-8rennh.highway.telekom.at) (Ping timeout: 121 seconds)
[20:49:57] <Eridius> AsRef is defined as a "cheap, reference-to-reference conversion". How cheap is "cheap"? Is O(N) cheap enough?
[20:50:07] <Eridius> or is it just for constant-time conversions?
[20:50:28] <sfackler> I believe cheap, &str -> &[u8] style conversions
[20:50:42] <aturon> Eridius: O(1)
[20:51:41] <redshift> Is this a good place to ask about troubles building rustc?
[20:52:23] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[20:52:36] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[20:52:37] *** Quits: jshs (jshs@moz-bafoi9.dip0.t-ipconnect.de) (Client exited)
[20:52:56] <sfackler> yep
[20:53:46] <eddyb> redshift: hey, what's up :D?
[20:53:58] <redshift> oh, cool, thanks.  I'm trying to build beta.5, then build it again with the just-built rustc.  I'm seeing a lot of "unresolved name `core::intrinsics::discriminant_value`" from libcore.
[20:54:29] <eddyb> redshift: typical bootstrap issues
[20:54:38] <redshift> I've been having this trouble since 93f7fe32d30b6 that added the intrinsic, and I've tried a bunch of commits and stage0's
[20:55:06] *** Joins: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP)
[20:55:10] <eddyb> --cfg stage0, you mean?
[20:55:37] <eddyb> redshift: also, are you using master or the beta branch?
[20:56:31] <redshift> beta branch, since I'd like to be on the 1.0 path.  I'm getting the stage0's from static.rust-lang.org to match up with src/snapshots.txt.  I've tried the latest snapshot from the beta branch (from src/snapshots.txt) from 3/27, and also the newer one from the master branch
[20:57:10] <eddyb> redshift: beta snapshot + --cfg stage0 should work
[20:57:23] <eddyb> since that's what building the beta branch from source entails
[20:57:27] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (A TLS packet with unexpected length was received.)
[20:57:30] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[20:57:33] <redshift> ok, I wasn't aware of that --cfg option -- taking a look now
[20:57:42] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[20:57:57] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[20:58:01] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[20:58:02] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[20:58:03] <eddyb> redshift: how are you doing the build? any specific reason for not going through the Makefile-based built system?
[20:58:38] <redshift> I'm doing a fairly standard configure, make, make check, make install.  So, I'm not sure where to insert --cfg stage0, since I assume that's a direct rustc option
[20:58:53] <redshift> (for the second build, I'm adding --local-rust-root and --enable-local-rust)
[20:59:07] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[20:59:20] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[20:59:50] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (A TLS packet with unexpected length was received.)
[21:00:11] <eddyb> redshift: oh, I've never seen local-rust working
[21:00:15] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[21:00:21] <redshift> oh!
[21:00:58] <redshift> I was assuming that's how distribution packagers would build rust
[21:01:00] <eddyb> the build system sets --cfg stage0 for all the libs built with the snapshot
[21:01:00] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Connection closed)
[21:01:14] <eddyb> redshift: with an older Rust of their own?
[21:01:26] <eddyb> redshift: no, that's not expected to work, at least not for a while
[21:01:42] <redshift> ok, good to know.  I wasn't able to find documentation for how they're doing it now.
[21:01:48] <redshift> but I'm very curious!
[21:02:03] <eddyb> redshift: don't fight the build system, pretty much
[21:02:48] <eddyb> if you cannot download the snapshot on demand, you can put it in the cache dir (I think it's "dl") ahead of time
[21:02:59] <redshift> eddyb: yeah, that's what I'm doing.
[21:03:11] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[21:03:25] <redshift> I was assuming I should be able to rebuild it with local-rust, as a test of the built compiler, but I didn't get that assumption from anywhere in particular
[21:03:38] *** Quits: brson (brson@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[21:03:46] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[21:03:46] <eddyb> I wanted that local-rust option gone, it tends to mislead people. I don't recall why it survived
[21:03:55] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[21:03:55] *** ChanServ sets mode: +o pnkfelix
[21:04:27] <redshift> so right now it's safe to say that any new rust builds should use a published snapshot?
[21:04:42] <eddyb> nothing else is known to work
[21:05:56] <eddyb> you usually can't use something older than the snapshot because most of the time a snapshot is made, it's because of an incompatibility
[21:05:57] *** Joins: larsberg (Adium@moz-kmvlue.cable.rcn.com)
[21:06:02] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[21:06:15] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[21:06:35] <eddyb> you can use something newer, but the cutoff commit is not documented so you'd end up trying them in sequence if you wanted to do it that way
[21:06:45] <redshift> I tried a lot of things, but the most common two were using a published rust source tarball with the last snapshot before it, or using the exact commit of rust used to build the snapshot
[21:07:12] <redshift> I tried a lot of sequences.  This is the first "breakage" I wasn't able to work around by finding the right set of snapshot/source.
[21:07:24] <redshift> but now I know it's not expected to work the way I thought :)
[21:07:50] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (Ping timeout: 121 seconds)
[21:07:53] *** Quits: harrisonclarke (harrisoncla@moz-g1kp2c.ns.bellaliant.net) (Connection closed)
[21:08:12] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[21:08:33] <arielb1> nrc: ping
[21:08:58] *** Quits: anom (anhedonia@moz-ums8mr.tor-exit.network) (Quit: leaving)
[21:09:00] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[21:09:58] <redshift> I'm willing to put time into getting this kind of build to work to help the distro use case, but I'm not an expert, so I'd probably need pointers.  For the moment I'll continue to use the published snapshots.
[21:10:04] <redshift> eddyb: thanks for your help :)
[21:10:24] <eddyb> redshift: it's just that the development workflow is not designed to accomodate such issues
[21:10:32] <eddyb> redshift: so you're going to get breakages
[21:10:35] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (A TLS packet with unexpected length was received.)
[21:11:00] <redshift> I know, and it's valuable enough to me to find ways around them or fix them :)
[21:11:22] <redshift> ideally it gets worked out for everyone, so a built rustc can be used in place of a stage0, I would think
[21:12:00] *** Joins: brson (brson@moz-u3dg2t.sfo1.mozilla.com)
[21:12:01] *** ChanServ sets mode: +o brson
[21:12:08] <brson> https://static.rust-lang.org/dist/staging/index.html
[21:12:24] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[21:12:50] *** Quits: SilverKey (SilverKey@moz-b7q751.biz.rr.com) (Ping timeout: 121 seconds)
[21:13:03] <eddyb> redshift: you'd need a team proportional to the number of contributions
[21:13:26] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[21:14:29] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[21:14:50] <eddyb> redshift: without alternative bootstrap methods, though, you'll still have to depend on binary builds that trace back to the official snapshots
[21:14:56] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[21:16:55] <redshift> eddyb: Yep, we have to trust, but there's another level of challenge (and often policy) for packagers, where including a binary blob in every build (rather than just a bootstrap build) is not ideal
[21:16:59] *** Quits: larsberg (Adium@moz-kmvlue.cable.rcn.com) (Quit: Leaving.)
[21:17:15] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Quit: Leaving)
[21:17:21] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[21:17:55] <eddyb> redshift: you can save your own snapshots, I guess
[21:18:11] <eddyb> using the commit hashes in snapshots.txt
[21:19:06] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[21:19:18] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[21:19:48] *** Joins: jga (jga@moz-08s.t1q.244.77.IP)
[21:20:41] <arielb1> nrc: ping
[21:24:49] <redshift> eddyb: I've been getting the source and snapshot tarballs matching the commits in snapshots.txt, yeah.  I think you're saying I could save the stage0 from my own build and use that instead of the public snapshots?  That might help
[21:25:19] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[21:25:21] *** Quits: sprang_ (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP) (Ping timeout: 121 seconds)
[21:26:14] <nrc> arielb1: pong (sorry, was in a meeting)
[21:26:19] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[21:26:29] <arielb1> could you r+
[21:28:10] <nrc> sure
[21:28:23] <arielb1> now I just need this to pass the checks on the bot
[21:28:27] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (A TLS packet with unexpected length was received.)
[21:28:29] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[21:28:34] <eddyb> redshift: yupp
[21:29:12] <arielb1> actually thinking of it I would prefer to rebase manually
[21:29:49] <nrc> arielb1: should I un-r+ ?
[21:29:58] <arielb1> I am now testing the rebase
[21:30:39] <nrc> I'll leave it then, if you upload something new it will cancel the r+ anyway
[21:31:35] <arielb1> this was so bigger than I expected
[21:31:49] <redshift> eddyb: cool.  Can you give a pointer as to building/saving my own stage0?  :)
[21:33:17] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[21:33:32] *** Joins: reed (reed@tech.monkey)
[21:34:20] *** Joins: zmack (zmack@moz-8vhf46.residential.rdsnet.ro)
[21:34:54] *** Joins: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net)
[21:35:37] <eddyb> redshift: make snap-stage3
[21:36:30] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Connection closed)
[21:37:09] <redshift> eddyb: cool, I missed that!  I'll play with it, and thanks again
[21:37:47] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[21:41:41] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[21:43:43] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[21:45:18] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[21:45:23] *** rkruppe_ is now known as rkruppe
[21:47:51] *** Quits: ConnorDoyle (ConnorDoyle@moz-edrulj.static.monkeybrains.net) (A TLS packet with unexpected length was received.)
[21:48:37] *** Quits: Kxepal (Miranda@moz-u0omr9.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[21:50:35] *** Joins: larsberg (Adium@moz-kmvlue.cable.rcn.com)
[21:50:54] *** Joins: Kxepal (Miranda@moz-eduvui.pppoe.mtu-net.ru)
[21:52:06] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[21:54:45] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[21:55:22] *** Joins: zeiris (dan@moz-8jbmam.letter.agency)
[21:59:16] <arielb1> nrc: good. more check failures from rebase
[21:59:38] <arielb1> the fallback issue again
[22:00:50] *** Joins: James (quassel@moz-225vcm.range86-148.btcentralplus.com)
[22:01:08] *** Quits: zmack (zmack@moz-8vhf46.residential.rdsnet.ro) (Connection closed)
[22:01:39] <arielb1> why are some of the -Z time-passes outputs in ns, some in µs, and some in s?
[22:01:53] *** Joins: Guest63 (textual@moz-6gq.t8s.78.166.IP)
[22:02:09] <nrc> they used to be all in s
[22:02:15] <nrc> maybe they changed?
[22:02:17] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[22:02:17] *** ChanServ sets mode: +o pcwalton
[22:02:25] <nrc> that's pretty crap if they did
[22:02:42] <arielb1> it doesn't seem to be normalized
[22:02:45] <Eridius> are they not showing whatever is the most appropriate unit given the duration?
[22:03:17] <arielb1> I have both 25832µs
[22:03:29] <aturon> the new Duration just landed, and its display mode is supposed to pick the most appropriate unit (cc acrichto)
[22:03:30] <arielb1> and 298080958ns
[22:03:43] <nrc> oh
[22:03:53] <nrc> we really shouldn't use that time passes
[22:04:04] <nrc> it is good for them to be easily machine processed
[22:04:06] <arielb1> it breaks my benchmark script
[22:04:08] <Eridius> wacky
[22:04:12] <aturon> acrichto: ^
[22:04:38] <Eridius> nrc: how about something like "2.2s (2200000000ns)" if you want machine-parsed?
[22:04:42] <nrc> I bet it'll break my scripts too :-(
[22:04:42] <Eridius> that way humans can read it easily
[22:05:22] <nrc> I think seconds is fine - if it is less than 0.001s or something it isn't significant
[22:05:36] <arielb1> I think it just turns 25832000ns (exactly) into 25832µs
[22:05:51] *** Joins: jdm (jdm@moz-i5m.05u.207.66.IP)
[22:07:03] <Eridius> oh that's weird
[22:07:08] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[22:07:11] <nrc> :-p
[22:07:15] <Eridius> I would expect something like 253123ns to become 253.123ms
[22:07:21] <arielb1> https://github.com/rust-lang/rust/blob/master/src/libstd/time/duration.rs#L169
[22:08:04] <Eridius> did the duration RFC define how display should work?
[22:08:23] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[22:08:29] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:09:00] <Eridius> also, this jumps from nanos to millis without micros?
[22:09:05] <Eridius> oh wait, nevermind I misread
[22:09:06] <Eridius> it has micros
[22:09:16] <arielb1> it jumps from nanos to seconds
[22:09:19] <arielb1> Eridius: ^
[22:09:42] <arielb1> unless you get lucky, in that case you get micros or maybe even millis
[22:09:43] <nrc> is there any time formatting API?
[22:09:53] <Eridius> is there any reason for 123456789ns to display that full precision? I'm inclined to say that should display as 123.456ms (and forget the ns entirely, it's typically noise)
[22:10:06] *** bvssvni is now known as bvssvni_
[22:10:20] <Eridius> which is to say, I'm inclined to say it should use whatever the largest unit is that is <= the value, and display up to 3 digits of precision
[22:10:22] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[22:11:00] <acrichto> arielb1: ah yeah the output got tweaked slightly, it tries to pick a nice repr but I'd imagine there are some better ones
[22:11:55] <arielb1> acrichto: I don't like the "use µ or m if you are lucky" part
[22:12:26] <Eridius> arielb1: seems like a reasonable choice for Display. This is most likely going to be read by a human. I think it's just a bad idea to jump only if the smaller unit is 0
[22:12:40] <arielb1> Eridius: I mean, the "if you are lucky" part
[22:12:42] <acrichto> arielb1: oh that's trying to print a u for microsecond
[22:12:47] <Eridius> i.e. 2000ns and 2001ns should display with the same unit
[22:12:52] <acrichto> arielb1: that could definitely change to an ascii u instead of a unicode unit
[22:12:59] <nrc> yeah, it seems not bad for Display, but wrong for time passes
[22:13:00] <arielb1> acrichto: the micro is fine
[22:13:06] <Eridius> acrichto: an ascii u would be incorrect :P
[22:13:10] <acrichto> oh I'm seeing that character as ï¿½
[22:13:20] <Eridius> acrichto: you're not reading IRC with UTF-8 then
[22:13:33] <Eridius> check your LANG or LC_CTYPE
[22:13:41] <Eridius> actually, irssi might have a specific setting for it too
[22:13:51] <arielb1> Eridius: or your terminal encoding setting
[22:13:58] <Eridius> my settings file has a 'term-charset' setting with the value 'utf-8'
[22:14:00] <acrichto> oh I don't mind nearly enough to look into that lol
[22:14:21] <Eridius> arielb1: true, although if you're using a terminal that doesn't support UTF-8 then I don't know what to think ;)
[22:14:31] <arielb1> Eridius: gnome-terminal defaults to some crazy encoding
[22:14:34] <Eridius> :/
[22:14:41] <arielb1> but you can set it to UTF-8
[22:15:37] <arielb1> anyway, the problem is that you get the micro-sign if you have an even number of micro-seconds
[22:15:57] <arielb1> (round number)
[22:16:04] <arielb1> and the milli-sign if you have a round number of milliseconds
[22:16:26] <arielb1> that is essentially randomly from a user perspective
[22:17:20] <arielb1> acrichto: I hate hate that diagnostics bug
[22:17:25] <arielb1> I mean, the "decoder error" bug
[22:17:56] <acrichto> ?
[22:20:00] *** Quits: mib_5q5abe (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:24:30] *** Joins: njn (chatzilla@moz-6gdjm4.iinet.net.au)
[22:25:16] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[22:25:21] <arielb1> acrichto: different issue
[22:26:26] <arielb1> but anyway I think duration should display closest unit + all digit
[22:27:23] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[22:27:42] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:27:49] <Eridius> I've submitted https://github.com/rust-lang/rfcs/issues/1121 with how I think it should work
[22:28:04] *** Quits: jdm (jdm@moz-i5m.05u.207.66.IP) (Quit: )
[22:28:13] *** Joins: acharles (acharles@moz-dvfnah.static.qwest.net)
[22:31:14] *** Joins: sprang_ (sprang@moz-sd1pe6.tmodns.net)
[22:31:37] *** Quits: duesenfranz_ (jona@moz-711djm.tirol.surfer.at) (Connection closed)
[22:31:54] <Eridius> arielb1: Duration != timestamp. A duration is a span of time, not an absolute point in time
[22:31:57] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[22:32:01] <arielb1> Eridius: fixed
[22:32:22] <arielb1> also, equivalent up to epoch
[22:32:27] *** Quits: brson (brson@moz-u3dg2t.sfo1.mozilla.com) (Quit: leaving)
[22:32:36] <arielb1> anyway, the less-significant bits are supposed to be noise
[22:32:36] <Eridius> arielb1: I don't know what you mean by "durations to randomly not align". What does it mean for a duration to align?
[22:33:03] <Eridius> the less significant bits are indeed noise, which is why 1_000_999ns and 1_001_000ns should display the same
[22:33:06] <Eridius> because that's a 1ns difference
[22:33:18] *** Joins: duesenfranz_ (jona@moz-711djm.tirol.surfer.at)
[22:33:23] <arielb1> you would have 90% of your durations as 5.111ms, 9% of your durations as 6.22ms, 0.9 as 6.2ms
[22:33:25] <arielb1> ugly
[22:33:30] <arielb1> (0.9%)
[22:34:27] <Eridius> arielb1: so use the precision field for that. If you always want 3 digits of precision, then use {:.3}. I guess I should put that in here though
[22:34:31] <Eridius> as the current code ignores precision
[22:34:44] <arielb1> Eridius: precision depending on noise is ugly
[22:34:56] <Eridius> how is that precision based on noise?
[22:35:27] <arielb1> I would like to say always use 3 digits
[22:35:36] <arielb1> or 4
[22:35:48] <Eridius> so anyone using durations to represent whole seconds would always see e.g. 1.000s 2.000s 3.000s
[22:35:51] <arielb1> so you have ijk.l ms or ij.kl ms or i.jkl ms
[22:35:55] <Eridius> if you want 3 digits, then use {:.3}.
[22:35:59] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[22:36:12] <Eridius> I suspect you're thinking of Duration purely in the context of timing code
[22:36:27] <Eridius> but Durations are not just representative of timing runs, they're also descriptions of spans of time, e.g. how long to wait before doing something
[22:36:29] <doener> eddyb: hrm, with the GEP instead of the call to wrapping_add, it's a lot faster, but not as fast as it used to be (I think)
[22:37:20] <Eridius> doener: what are you doing?
[22:37:44] <arielb1> Eridius: so default to variable precision?
[22:38:01] <arielb1> I think that is the normal default
[22:38:44] <doener> Eridius: building upon your recent PR that did the wrapping_add for the iterators, I'm replacing the "as usize" + wrapping_add stuff by a new intrinsic that does a GEP instead (casting to *const i8 first, and without inbounds)
[22:38:46] *** Joins: isis (isis@moz-uprl14.patternsinthevoid.net)
[22:39:06] <Eridius> arielb1: defaulting to variable precision up to 3 digits is what I want. And if you cap precision, then you need to either floor, ceiling, or round. Rounding seems the most sensible
[22:39:21] <doener> Eridius: that's what LLVM can optimize while the current code leads to ptrtoint/inttoptr that is not optimized well
[22:39:36] <doener> Eridius: the thing about it being faster is about gh25393 though
[22:39:37] <[o__o]> LLVM -O2 compile time regression: https://github.com/rust-lang/rust/issues/25393
[22:39:41] <Eridius> doener: I take it GEP without inbounds is safe to do on arbitrary pointers?
[22:40:13] <doener> Eridius: yes. All calculations are defined and use two's complement. You just may not necessarily deref
[22:40:24] <Eridius> in that case, GEP without inbounds sounds like a good idea
[22:40:28] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[22:40:47] <Eridius> I briefly thought ab out looking into that when doing my wrapping PR, but I assumed it wouldn't make a difference
[22:40:56] <doener> yeah, asked on #llvm about it, and got confirmation that it's the right thing to do
[22:41:06] <Eridius> why is ptrtoint/inttoptr not optimized well? The integral value is defined to be the same size as a word
[22:41:30] <arielb1> Eridius: if you have a human duration
[22:41:39] <arielb1> you may want to show it in minutes
[22:42:26] <Eridius> doener: should we perhaps have a ptr.offset() variant that does GEP without inbounds, or are you thinking of just using an intrinsic directly in core::slice?
[22:42:33] <arielb1> but DIsplay always defaults to variable-precision
[22:42:42] <arielb1> OTOH
[22:42:55] <Eridius> arielb1: I originally had an unresolved question in there about showing minutes/hours, but I decided that if you're working with durations of that length then you might need to start using a real time formatter
[22:43:07] <doener> Eridius: I guess because you lose aliasing information (and probably more), it just gives up on it entirely, expecting you to use GEPs to do pointer arithmetic
[22:43:14] <Eridius> because e.g. if you're showing hours, is precision down to the second important? It might be.
[22:43:40] <doener> Eridius: for now, just an intrinsic. Alex agreed on doing it like that for now
[22:44:13] <Eridius> doener: of course the real problem is that we're using pointers at all, when ideally we'd just be using an integer counter. But we'd need to be able to specialize the struct fields based on type parameters for that, and have constexpr that can evaluate mem::size_of
[22:44:13] <doener> might add a new method on raw pointers later
[22:44:30] <doener> tight
[22:44:32] <doener> *right
[22:45:17] <arielb1> I mean, Duration is pretty much intended for random timing purposes
[22:45:50] <arielb1> if you want to do human-y time you would use a calendar library
[22:47:38] <Eridius> there's very little value in showing 123_456_789ns as the string "123456789ns". There's also very little value in showing it as "123.456789ms" because that's more precise than anyone really wants to see. So the idea here is a fairly simple rule that results in a string that is reasonably readable to most people
[22:48:09] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[22:48:20] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[22:48:20] *** Quits: Guest63 (textual@moz-6gq.t8s.78.166.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:49:56] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[22:51:43] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[22:52:33] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[22:52:40] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[22:52:42] *** rkruppe_ is now known as rkruppe
[22:53:03] <arielb1> I actually prefer it the old way
[22:54:17] *** Joins: swgillespie (swgillespie@moz-1i5.3un.220.167.IP)
[22:54:51] <cmr> RE: disjoint polymorphism, I feel ike &str *should* be convertible to &String
[22:55:01] <cmr> They're both non-owning, you just need to add a capacity field.
[22:55:50] *** Quits: swgillespie (swgillespie@moz-1i5.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:56:24] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[22:56:37] <arielb1> cmr: strcat had that ugly hack back then
[22:56:41] <cmr> Although I guess I'm assuming that by 'a String they meant to write &'a String, which may not be true.
[22:57:02] <cmr> arielb1: why is it ugly?
[22:57:04] <nrc> arielb1: fixed for time passes at least: https://github.com/rust-lang/rust/pull/25419
[22:57:21] <arielb1> at least he implemented with with lots of transmutes
[22:57:35] <cmr> Ah, yes, the implementation certainly isn't pretty.
[22:57:36] <nrc> (to keep the scripts working)
[22:57:49] <arielb1> nrc: how does it print?
[22:57:59] <nrc> exactly like before
[22:58:18] <arielb1> why {:.3}
[22:58:32] <arielb1> rusti: println!("{:.3}", 1.23456789)
[22:58:33] -playbot- 1.235
[22:58:33] -playbot- ()
[22:58:48] <nrc> that was the previous behaviour, no?
[22:58:51] <arielb1> rusti: println!("{:.3}", 987654321.23456789)
[22:58:53] -playbot- 987654321.235
[22:58:53] -playbot- ()
[22:59:36] <arielb1> yes
[22:59:38] <arielb1> actually
[22:59:47] <bluss> as_string still exists
[23:00:04] <cmr> bluss: oh, so it does.
[23:00:41] <arielb1> nrc: I rebased and test-fixed gh24333
[23:00:41] <[o__o]> Make casts follow the new RFC401: https://github.com/rust-lang/rust/pull/24333
[23:01:33] <nrc> thanks! r+ed
[23:01:44] <arielb1> hopefully for good this time
[23:02:24] *** Joins: swgillespie (swgillespie@moz-1i5.3un.220.167.IP)
[23:02:25] <acrichto> nrc: hm, why not use {}? to not break script scraping output?
[23:02:43] <cmr> acrichto: yes.
[23:02:51] <cmr> (it broke arielb1's scripts)
[23:03:13] <acrichto> well every change to anything will break scripts somewhere...
[23:04:28] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[23:04:45] <nrc> acrichto: do you mean {:?}
[23:05:18] <nrc> Oh sorry
[23:05:27] <nrc> I mis-parsed that question
[23:05:29] <acrichto> nrc: ah with reference to https://github.com/rust-lang/rust/pull/25419
[23:06:05] <nrc> Yeah, to make it easier for scipts - having a consistent unit makes it easier for scripts
[23:06:34] <nrc> and I don't think there is much benefit for human readers having it different units
[23:06:38] *** Parts: aatch (james@moz-is4j4r.cable.telstraclear.net) ("Leaving")
[23:06:48] <acrichto> could you add a comment saying why the standard impl is not being used?
[23:06:56] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[23:07:11] <nrc> (I don't mind breaking scripts by making something different so much as making harder)
[23:07:12] <nrc> sure
[23:07:43] *** Quits: Jesin (Jesin@moz-34r.q2b.180.128.IP) (Quit: Leaving)
[23:08:50] *** Quits: James (quassel@moz-225vcm.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[23:08:52] <acrichto> nrc: with that though r=me
[23:09:18] <nrc> acrichto: updated
[23:10:01] <nrc> thanks!
[23:12:48] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[23:13:22] <doener> seanmonstar: hm, just had a look at a .ll file compiled locally, and there are tons of calls to assume in there
[23:14:55] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[23:15:20] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[23:15:35] *** Joins: mib_6h4qar (Mibbit@moz-juv.9o3.252.72.IP)
[23:16:07] <doener> I guess that's from e1e34e9275918679336210874f8dd770323daa81
[23:16:19] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:16:32] <doener> the new location for the assume intrinsic probably doesn't allow for it to be transformed into nonnull metadata anymore
[23:17:35] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[23:18:26] <eddyb> doener: oh, I saw that some blocks moved and I actually thought of metadata. but there was too much noise to deduce anything
[23:19:00] <kmc> acrichto: do you have a sec to publish a new version of https://crates.io/crates/miniz-sys ? I'm using it in one of servo's deps
[23:19:38] <acrichto> kmc: certainly!
[23:19:39] <acrichto> done
[23:19:58] <kmc> i'm using it in a weird kinda cool way which is that I'm building some C++ code that uses autoconf to look for libz but I'm pointing it at the miniz built by the crate, instead
[23:20:02] <kmc> :3
[23:20:11] <kmc> I would love to offer that as a supported thing
[23:20:20] <acrichto> that sounds kinda awesome
[23:20:36] <kmc> just need to find / write a zlib.h that's compatible with miniz and contains the necessary aliases
[23:21:00] *** Quits: nham (nham@moz-755.bu3.214.98.IP) (Ping timeout: 121 seconds)
[23:21:44] <kmc> in this case the C++ code only uses 2 functions so it was easy
[23:22:33] *** Quits: eddyb (eddyb@moz-egg.q07.26.188.IP) (Ping timeout: 121 seconds)
[23:22:34] *** kimundi is now known as zz_kimundi
[23:23:11] *** Quits: arielb1 (Ariel@moz-2trv48.red.bezeqint.net) (Quit: Ex-Chat)
[23:23:49] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[23:25:06] *** Quits: sprang_ (sprang@moz-sd1pe6.tmodns.net) (Ping timeout: 121 seconds)
[23:31:35] *** Quits: davebettin (davebettin@moz-hde.5e5.136.67.IP) (Ping timeout: 121 seconds)
[23:36:00] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[23:36:00] *** ChanServ sets mode: +o pcwalton
[23:38:51] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[23:38:59] *** Joins: nham (nham@moz-755.bu3.214.98.IP)
[23:39:11] <nrc> brson, acrichto: do you know if I can get a list of commits used to make nightlies?
[23:39:15] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[23:39:45] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[23:39:59] *** rkruppe_ is now known as rkruppe
[23:41:45] <acrichto> nrc: it may be in the channel metadata itself, but if not I think you'd have to download and run rustc -vV
[23:42:10] *** Quits: duesenfranz_ (jona@moz-711djm.tirol.surfer.at) (Client exited)
[23:42:44] <nrc> do we keep all the past nightlies around?
[23:44:31] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[23:45:14] <acrichto> nrc: yeah they're all in /dist/$datte
[23:45:39] <nrc> sweet
[23:45:43] <nrc> thanks acrichto 
[23:47:12] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Quit: leaving)
[23:47:17] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[23:48:25] *** Quits: Rym (y@moz-aun.38r.38.217.IP) (Ping timeout: 121 seconds)
[23:49:49] *** Joins: Rym (y@moz-aun.38r.38.217.IP)
[23:53:16] <reem> requesting labels https://github.com/rust-lang/rust/issues/25415
[23:56:00] *** Quits: zeiris (dan@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[23:56:11] <cmr> playbot: struct Foo { a: u8 } impl Drop for Foo { fn drop(&mut self) { self.a = 0; } } let x = Foo { a: 42 }; Drop::drop(&mut x); x.a
[23:56:13] -playbot- <anon>:9:110: 9:120 error: explicit use of destructor method [E0040]
[23:56:13] -playbot- <anon>:9         struct Foo { a: u8 } impl Drop for Foo { fn drop(&mut self) { self.a = 0; } } let x = Foo { a: 42 }; Drop::drop(&mut x); x.a
[23:56:13] -playbot- output truncated; full output at: http://bit.ly/1FhlBtq
[23:56:18] <cmr> Ah good.
[23:56:19] <sfackler> reem: you want anything other than ice?
[23:57:12] <reem> sfackler: donâ€™t think so; it probably has to do with lifetimes/typesystem, since thatâ€™s what I changed from eventual master to cause the error.
[23:57:59] *** Joins: zeiris (dan@moz-8jbmam.letter.agency)
