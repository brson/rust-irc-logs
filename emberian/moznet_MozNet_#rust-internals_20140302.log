[00:02:45] <eddyb> bah, C++ types have the wrong order :/
[00:03:12] <eddyb> yes, we can abuse expressions, but it's limited
[00:08:03] <huon> acrichto: ping
[00:12:10] *** Quits: cgaebel (clark@moz-8E0C6BCA.nyc.res.rr.com) (Client exited)
[00:12:42] <eddyb> nmatsakis: ohh, I do think borrowck rules changed. my code seems to have been invalid anyway
[00:13:45] <eddyb> now I'm left with 18 "error: cannot infer an appropriate lifetime for automatic coercion due to conflicting requirements"
[00:13:54] <brson> i'm turning old-bors back on while I go to dinner, but when I get back I'm going to try turning new-bors on
[00:14:04] <eddyb> brson: what's the difference?
[00:15:18] <eddyb> nmatsakis: but this is the point where I give up and use Rc<Expr> instead :P
[00:15:32] <brson> eddyb: very little featurewise https://github.com/graydon/bors/pull/21
[00:15:35] <eddyb> not sure why I named it Expr... Value fits better. maybe
[00:15:40] <brson> just incorporating upstream changes
[00:15:53] <huon> (should bors move to rust-lang/bors too?)
[00:15:56] <brson> it does fix the big security hole
[00:16:19] <brson> huon: i'm not where i think bors should live yet
[00:16:19] <huon> how?
[00:16:38] <eddyb> "Loop through all pull-requests, instead of only operating one-per-run." does this allow for smaller wait times between runs?
[00:16:45] <brson> huon: it doesn't allow commands on edited commits
[00:16:54] <brson> eddyb: i'm not sure but we're not going to use it at first
[00:16:58] <brson> sounds to scary to me
[00:17:11] <brson> *edited comments
[00:17:22] <huon> oh
[00:17:44] <eddyb> "Create unique integration branch per PR." I guess this would work for parallel builds? (if we had those)
[00:17:49] <huon> (I guess that means that it will ignore the reviewer editing the commit?)
[00:17:54] <huon> eddyb: that's exactly what it's for
[00:18:04] <brson> huon: that's right. they'd have to deltee
[00:18:32] <brson> that is for speculation that a useful number of builds will ail
[00:18:59] <brson> it still won't build two in parallel and merge both on success
[00:19:42] <brson> anyway, doing more than one integration at a time would stress our slaves a lot and the gain isn't clear
[00:19:47] <brson> i want to try adding -j2 to 'make' first
[00:20:28] * brson dinner
[00:21:05] <eddyb> amazing that people are finding *our testing bot* useful
[00:21:14] <ericmr> it's pretty general
[00:21:24] <huon> it's not that amazing, right? given we find it useful
[00:22:35] <eddyb> can I impl Rc<Foo> yet?
[00:22:48] <eddyb> or will it fail with some module-related error?
[00:23:12] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[00:23:34] <huon> you can inside libstd
[00:23:42] <eddyb> riiight
[00:23:51] <eddyb> why would it even be different?
[00:24:10] <eddyb> in resolve, that is. coherence cares about which crate the type and the trait come from
[00:28:14] <nrc> huon: it looks like new_span is being called by fold (I have no idea why) and that creates a new span with expn_info from backtrace, but in my test case the backtrace is None. How does fold/new_span fit in with deriving expansions? And do any of the recent changes look like they could hav e changed this? Doesn't look likeit to me...
[00:29:47] <eddyb> it's the folder's new_span method, no?
[00:29:50] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[00:30:19] <eddyb> I think astencode might use that to translate the span when - wait, we don't encode spans
[00:30:25] <eddyb> so it's just expansion that uses new_span?
[00:33:13] <huon> nrc: hm... I'll have a look in a few minutes
[00:33:20] *** erimundi is now known as kimundi
[00:34:10] <nrc> ta!
[00:34:40] <nrc> if I had hair, I'd really be pulling it out at this stage - its driving me nuts
[00:36:17] *** Quits: bytewise_ (bytewise@moz-4971A7D6.adsl.alicedsl.de) (Quit: Leaving)
[00:39:48] <eddyb> nrc: I'd rather say it's deriving ye nuts
[00:41:11] <nrc> ooof
[00:41:27] <nrc> taxi for eddyb!
[00:42:43] <ericmr> hahah
[00:43:40] <huon> nrc: I'm pretty confused right now :S
[00:45:17] <eddyb> do we have an issue for impl Foo<Bar> where Foo is from another crate?
[00:45:34] <ericmr> nmatsakis has an RFC-in-pending for that and other issues, iirc.
[00:45:42] <eddyb> RFC?
[00:45:49] <ericmr> coherence changes
[00:45:52] <eddyb> riiight
[00:46:01] <eddyb> too bad it errors during resolve :P
[00:46:15] <eddyb> coherence never actually runs on that :/
[00:46:26] <eddyb> what was I going to do? helper trait, right
[00:47:15] <huon> nrc: I'd recommend just throwing a pile of debug!'s into expand_item and .fold_span and whatever
[00:54:02] <nrc> ok
[01:00:40] *** Joins: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP)
[01:00:56] *** Parts: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP) ()
[01:02:57] *** Joins: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP)
[01:03:51] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[01:05:56] *** Parts: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP) ()
[01:07:45] *** Joins: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP)
[01:09:14] <xorcon> I'm using the push_bytes() function under std::io::Reader. I'm trying to handle the case when EOF is reached. However when I compile the rust compiler says that the return type of push_bytes() is () but in documentation it should return a result correct? Can someone help me with this?
[01:09:33] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[01:09:45] <eddyb> xorcon: what does the code look like?
[01:10:09] <eddyb> acrichto: is travis down?
[01:10:20] <ericmr> xorcon: are you using master?
[01:10:40] <ericmr> eddyb: http://status.travis-ci.com/ doesn't seem to be?
[01:10:52] <eddyb> I mean, disabled for rust
[01:10:54] <ericmr> ah
[01:11:03] <eddyb> https://github.com/mozilla/rust/pull/12610 this was hours ago
[01:11:14] <eddyb> (the latest push, I mean)
[01:11:21] <huon> eddyb: needs a rebase
[01:11:28] <eddyb> ohh
[01:11:35] <eddyb> (why doesn't github tell me that :(?)
[01:11:42] <ericmr> yeah seriously
[01:11:50] <huon> yeah, it's really dumb how not even the PR submitter gets told
[01:11:55] * ericmr sends email to github
[01:11:57] <huon> only repo collabs :/
[01:12:21] <xorcon> I'm trying to follow the src code for read_bytes() but instead of returning an Err(e) still want to be able to add the remaining bytes to my buffer
[01:12:49] <xorcon> ericmr: sorry but what do you mean by master?
[01:13:07] <ericmr> xorcon: the master branch, not a release.
[01:13:14] *** ericmr is now known as cmr
[01:13:45] <xorcon> ericmr: don't think so. I'm using the current release 0.9 i believe?
[01:13:57] <cmr> ok.
[01:14:11] <cmr> you should be looking at these docs: http://static.rust-lang.org/doc/0.9/std/index.html
[01:14:19] <cmr> IoResult did not exist then.
[01:14:39] <huon> (btw, #rust is a better place to ask about using the various libraries)
[01:14:52] <eddyb> 0.9 is not "current" but "previous" :P - we only really support master
[01:15:13] <xorcon> huon: sorry this is my first time on the irc. thanks for redirecting me!
[01:15:28] <huon> xorcon: np, it would be the same people answering your questions anyway :)
[01:16:07] <xorcon> cmr: ohhh ok. was looking at wrong documentation 
[01:16:28] <xorcon> cmr: thanks 
[01:16:47] *** Joins: rocode (rocode@moz-B9927398.clsp.qwest.net)
[01:18:15] <xorcon> cmr: so say I read number of bytes less than len. I get an error message on my terminal saying eof, how would you guys suggest I handle this since push_bytes doesnt return anything?
[01:19:38] <eddyb> update to master :)
[01:20:03] <xorcon> eddyb: would love to but my class is using 0.9 :(
[01:20:19] <huon> oh, you're doing cs4414?
[01:20:33] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[01:20:37] <xorcon> huon: yup did you take it?
[01:20:49] <huon> xorcon: nope
[01:21:00] <eddyb> but dealing with breaking changes is important!
[01:21:54] <eddyb> (says the guy who has code that is lifetime-assignment-impossible under the latest borrowck rules)
[01:22:13] <eddyb> (well, technically it's regionck+borrowck. meh)
[01:24:53] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[01:26:46] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:29:16] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:29:16] *** ChanServ sets mode: +qo brson brson
[01:32:20] <brson> turning on new bors
[01:32:53] <eddyb> [0_0]
[01:33:09] <brson> bors has *nothing* to do
[01:33:12] <brson> very suspect
[01:33:27] <eddyb> brson: not really
[01:33:38] <eddyb> seen that during the last few days
[01:33:58] <eddyb> shortage of reviews?
[01:36:42] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[01:36:42] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14da04b6c to 14999d55d: 02http://git.io/N3iJvQ
[01:36:42] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[01:36:42] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[01:36:42] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/UKUHiA
[01:36:42] <ghrust> 13rust/06auto 14bc35eb7 15Kevin Ballard: vim: Tweak how comment nesting works...
[01:36:42] <ghrust> 13rust/06auto 14b349fee 15bors: Merge pull request #12308 from kballard/vim-nested-comments...
[01:36:43] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[01:37:28] <brson> gj bors
[01:38:17] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[01:39:51] <huon> cmr: RH hashmap import thing is fixed
[01:40:05] <huon> cmr: https://github.com/mozilla/rust/pull/12081#discussion-diff-10188919
[01:40:06] <cmr> oh ok
[01:43:02] <eddyb> https://etherpad.mozilla.org/Rust-meeting-weekly I guess the date needs updating
[01:44:21] <huon> cmr: btw, do you have sound troubles with the vidyo client?
[01:44:23] <cmr> there won't be a meeting next week I don't think
[01:44:25] <cmr> huon: yes.
[01:44:30] <cmr> because of the workweek
[01:44:45] <cmr> next one is scheduled for March 11
[01:44:51] <huon> silly vidyo! :/
[01:44:51] <cmr> huon: I gave up on vidyo on linux
[01:44:56] <cmr> just rebooted into windows
[01:45:16] <huon> :'(
[01:45:20] <cmr> yeah :(
[01:48:23] <eddyb> wait, so what's there if there's no meeting?
[01:48:50] <cmr> everyone is going to be in the same room most of the week :p
[01:48:54] <huon> a work week
[01:49:10] <eddyb> cmr: I mean, for taking decisions :/
[01:49:17] <cmr> see above
[01:49:21] <huon> people talking to each other
[01:49:38] <eddyb> without someone recording every word :P?
[01:50:07] <eddyb> I just hope this gets resolved this week https://github.com/mozilla/rust/pull/12081#issuecomment-36414119
[01:52:02] *** kimundi is now known as zz_kimundi
[01:53:31] *** Quits: xorcon (Mibbit@5792FA03.CE6A8161.D5851B94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[01:57:28] <Eridius> crud, ICE
[01:58:37] <sfackler> acrichto: how would you feel about making IoErrorOther into IoErrorOther(~Any)?
[02:03:08] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140226030202])
[02:05:48] <brson> acrichto: how do you feel about the robin hood hashmap?
[02:06:03] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[02:16:30] *** Joins: lpy|afk (lpy@7360AA58.F09091A8.1348A864.IP)
[02:17:06] *** lpy|afk is now known as lpy
[02:20:40] *** Joins: cgaebel (clark@moz-8E0C6BCA.nyc.res.rr.com)
[02:33:33] *** Joins: angdev (angdev@16F167B.4C57D258.D8E8354F.IP)
[02:46:50] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[02:46:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/UKUHiA
[02:46:50] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[02:46:53] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[02:46:53] <ghrust> [13rust] 15bors 04deleted 06auto at 14b349fee: 02http://git.io/BXwckg
[02:46:53] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[02:49:45] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Quit: Leaving...)
[02:50:14] <eddyb> brson: I wish the GitHub bot would show the PRs bors merged
[02:50:20] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[02:52:04] <sfackler> .
[02:54:08] <eddyb> Ä±
[02:54:17] <eddyb> aww, it's not aligned
[02:56:32] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[02:56:32] <ghrust> [13rust] 15none pushed 5 new commits to 06master: 02http://git.io/_IS1Yg
[02:56:32] <ghrust> 13rust/06master 14bc35eb7 15Kevin Ballard: vim: Tweak how comment nesting works...
[02:56:32] <ghrust> 13rust/06master 14b9d3844 15Steven Fackler: Add a test for #11552...
[02:56:33] <ghrust> 13rust/06master 1411ca7ec 15bors: auto merge of #12641 : sfackler/rust/issue-11552, r=huonw...
[02:56:35] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[02:57:06] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[02:57:06] <ghrust> [13rust] 15none pushed 5 new commits to 06master: 02https://github.com/mozilla/rust/compare/2cb83fdd7ea4...b349fee46e39
[02:57:06] <ghrust> 13rust/06master 14bc35eb7 15Kevin Ballard: vim: Tweak how comment nesting works...
[02:57:06] <ghrust> 13rust/06master 14b9d3844 15Steven Fackler: Add a test for #11552...
[02:57:07] <ghrust> 13rust/06master 1411ca7ec 15bors: auto merge of #12641 : sfackler/rust/issue-11552, r=huonw...
[02:57:09] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[02:57:51] <acrichto> sfackler: seems fairly reasonable
[02:57:55] <acrichto> brson: uncomfortable still
[02:58:50] <eddyb> "none pushed 5 new commits to master"
[02:59:00] <eddyb> and twice :/
[03:01:41] <brson> i was testing github hooks
[03:01:49] <eddyb> ahh
[03:03:04] *** Quits: zz_kimundi (kimundi@moz-E299220C.dip0.t-ipconnect.de) (Ping timeout)
[03:03:23] <eddyb> nmatsakis: are we considering allowing overloading == and < with custom types for RHS and result?
[03:06:35] *** Joins: zz_kimundi (kimundi@moz-C4D127AF.dip0.t-ipconnect.de)
[03:06:36] *** zz_kimundi is now known as kimundi
[03:08:49] <eddyb> does Rc not implement Show :(?
[03:10:20] <eddyb> though I would think deriving could go through Rc via overloaded autoderef
[03:11:11] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[03:11:39] <huon> auto-deref: the bane of #[deriving]
[03:11:52] <eddyb> oh, I know what's going on
[03:12:17] <eddyb> it's our stupid formatting runtime. I should've changed that... but I'm afraid of making it worse :(
[03:12:34] <eddyb> we make vectors of instructions that the formatter has to take etc.
[03:12:43] <huon> our formatting runtime isn't stupid
[03:13:39] <eddyb> instead of actually calling the fmt methods within the generated code
[03:13:47] <eddyb> huon: --pretty expanded disagrees
[03:15:17] <huon> the generated code is mildly ugly? so?
[03:15:33] <eddyb> acrichto seems to think that doing the operations inline would lead to generic bloat
[03:15:57] <eddyb> but my tests show reduction in resulting IR. maybe they were too simple
[03:16:03] <huon> it's theoretically possible to use std::fmt with dynamic format strings too (would probably need some adjustments though)
[03:16:28] <huon> overall reductions? or reductions specifically at the callsite?
[03:16:42] <eddyb> there's only the call site
[03:17:02] <eddyb> (for format!)
[03:17:54] <eddyb> I would think it would just be a bunch of calls to Writer::write for write!
[03:18:40] <eddyb> huon: I guess I have to show callsite reductions for integer formatting
[03:18:50] <huon> what about alignment and {select}/{plural}, etc?
[03:19:18] <eddyb> compiler generated code would call in that functionality in the runtime *if it is used*
[03:19:38] <eddyb> right now it's a bytecode interpreter, so anything can be anything
[03:20:30] <eddyb> I guess you're thinking of costs
[03:20:58] <cmr> that'd be one hell of a paper: "Design Of String Formatting Virtual Machines"
[03:21:02] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[03:21:54] <eddyb> "On The Turing Completeness Of Select and Plural"
[03:21:58] <huon> I'm thinking of code bloat at the call site of `format!("a {0, select, =foo{ {:<2.3} }", ...)`
[03:22:22] <huon> if that expanded to `if ... == "foo" { let aligned = ...; w.write(...); } ...`
[03:22:58] <eddyb> nah I'm not sadistic enough to construct those expressions in deriving
[03:22:59] <huon> that would be a huge chunk of IR where as currently most of that IR is shared between all callsites via std::fmt's VM
[03:23:22] <huon> eddyb: btw, `&'static std::kinds::marker::NoSend` is not send
[03:23:34] <eddyb> that's... interesting
[03:23:48] <eddyb> so &'static T is Send iff T is Send?
[03:24:43] <eddyb> transmuting &'static T to &'static (T, NoSend) should work, right?
[03:25:12] <eddyb> &'static TaskLocal<StrInterner> is a big ugly, though
[03:25:28] *** Joins: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP)
[03:25:47] <eddyb> huon: problem is... if you can take a 'static inner reference, you're doomed
[03:26:05] <eddyb> so you can't implement Deref<T> on TaskLocal<T>
[03:26:21] <eddyb> I guess it might work if it hides a &'static (T, NoSend) inside
[03:26:40] <huon> eddyb: privacy
[03:27:02] <eddyb> no, I mean, you want to be able to get inner references
[03:27:09] <eddyb> otherwise it's unusable
[03:27:43] <huon> `fn with_str(&self, f: |&str| -> T) -> T` :P
[03:27:50] <eddyb> NOPE
[03:28:07] <eddyb> huon: really, TaskLocal<T> can implement Deref<T>, so we should be good
[03:28:07] <huon> or abuse the fact that `-> &str` can be satisfied by a `&'static str`
[03:28:22] <eddyb> but then you can send a &'static str
[03:28:42] <eddyb> (it comes from an Rc<~str> anyways)
[03:28:44] <huon> brson: bors seems to have hung?
[03:28:58] <huon> eddyb: no, return -> &str and then the compiler doesn't know it's &'static str from outside
[03:29:19] <eddyb> can't return &str
[03:29:24] <huon> yes you can
[03:29:30] <eddyb> erm... what?
[03:29:30] <huon> (it's a bug... but still.)
[03:29:33] <eddyb> hehehe
[03:29:40] <huon> 'static is the super lifetime of everything
[03:29:47] <huon> including the anonymous ones that get inserted
[03:30:01] <eddyb> anyways, task_local::get(Key<T>) -> Option<TaskLocal<T>>
[03:30:10] <eddyb> impl Deref<T> for TaskLocal<T>
[03:30:41] <eddyb> so TaskLocal is a copiable non-sendable handle
[03:30:57] <eddyb> and you can call T methods on it
[03:32:11] <eddyb> since deref links &'a self -> &'a T, you're only going to get &'static T (sendable) if you put the TaskLocal in a static mut
[03:32:33] <eddyb> static muts are unsafe anyways, so we can discard that possibility (can we? cc nmatsakis)
[03:34:07] <eddyb> huon: I was struggling between purple and pink... I hope it's magenta
[03:34:24] <eddyb> anyways, it's a disturbing color IMO
[03:34:37] <eddyb> and we currently use green for silly things like mut and &
[03:35:28] <eddyb> huon: the kate highlighting (or at least the local one) uses green for macros and attributes
[03:36:01] <eddyb> (the scheme is general, C uses the same green for macros)
[03:38:27] <brson> huon: i'm trying to figure out why
[03:40:01] <eddyb> error: failed to find an implementation of trait std::fmt::Show for std::rc::Rc<U>
[03:40:14] <eddyb> this is bad >_>
[03:40:17] <huon> brson: because the auto branch was deleted?
[03:40:39] <cmr> feedback before I send this to the ML? https://gist.githubusercontent.com/cmr/41ddd4ffd194450dffc3/raw/bfcb4ba974dc7e780b3453e87718c5df7ec57e51/gistfile1.txt
[03:40:57] <eddyb> gists are too mainstream
[03:44:11] *** Quits: eddyb (eddy@DD15F8DE.17CB6122.FCAAE698.IP) (Ping timeout)
[03:44:38] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[03:44:38] <ghrust> [13rust] 15bors created 06auto from 06master (+0 new commits): 02http://git.io/N3iJvQ
[03:44:38] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[03:47:18] <cmr> brson: We should have a low-traffic rust-announce mailing list
[03:53:20] <huon> cmr: does it support building with/without optimisations without editing the conf files?
[03:53:32] <cmr> huon: not 1.0 no
[03:53:41] <cmr> I'm adding it now, it will be 1.1 :P
[03:53:48] <huon> ok cool
[03:53:48] <cmr> I'm actually holding off the email until I have it
[03:54:09] <huon> (it's pretty important, since our no-opt performance is so much worse than the opt performance.)
[03:54:15] <cmr> mhm
[03:57:20] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:00:18] *** Quits: kimundi (kimundi@moz-C4D127AF.dip0.t-ipconnect.de) (Ping timeout)
[04:04:06] *** Joins: zz_kimundi (kimundi@moz-94744042.dip0.t-ipconnect.de)
[04:04:07] *** zz_kimundi is now known as kimundi
[04:23:08] *** Joins: ktt3ja (ktt3ja@moz-54586A12.washdc.fios.verizon.net)
[04:56:10] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[04:56:10] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/qkLshQ
[04:56:10] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[04:56:11] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[04:56:11] <ghrust> [13rust] 15bors 04deleted 06auto at 14c81b3fb: 02http://git.io/iyCMgw
[04:56:11] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[04:56:43] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[04:56:43] <ghrust> [13rust] 15bors created 06auto from 06master (+0 new commits): 02http://git.io/N3iJvQ
[04:56:43] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[05:12:35] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[05:15:08] <brson> i'm going to leave new bors running
[05:15:22] <cmr> bors is dead; long live bors?
[05:17:12] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[05:17:12] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[05:17:16] <huon> brson: I'm confused by the last two comments here: https://github.com/mozilla/rust/commit/e2afa1cd5caef171353707c9d1acde78541b40f7#commitcomment-5534555
[05:17:47] <huon> (they're after the PR successfully landed)
[05:25:13] <brson> i'm not sure why that happened
[05:48:05] *** Quits: cgaebel (clark@moz-8E0C6BCA.nyc.res.rr.com) (Ping timeout)
[05:53:50] *** Quits: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP) (Ping timeout)
[05:58:56] *** Joins: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP)
[05:59:07] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[05:59:10] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:59:10] *** ChanServ sets mode: +qo brson brson
[06:02:35] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[06:05:13] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[06:05:13] *** ChanServ sets mode: +qo brson brson
[06:07:13] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[06:09:26] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[06:09:26] *** ChanServ sets mode: +qo brson brson
[06:18:42] <brson> :-/ it's hard to have much confidence in newbors when he's only merged one branch
[06:19:02] <brson> I think I'm going to put old bors back for the week
[06:20:14] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[06:22:44] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[06:23:55] *** Joins: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP)
[06:24:50] *** Quits: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP) (Connection reset by peer)
[06:24:51] *** Joins: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP)
[06:26:42] *** Quits: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP) (Ping timeout)
[06:27:48] *** Joins: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP)
[06:28:10] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[06:28:52] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[06:28:52] *** ChanServ sets mode: +qo brson brson
[06:30:36] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[06:37:05] *** Quits: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca) (Quit: canhtak)
[06:46:28] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[06:46:28] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/PYzxQQ
[06:46:28] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[06:46:29] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[06:46:29] <ghrust> [13rust] 15bors pushed 7 new commits to 06auto: 02http://git.io/MuZjNQ
[06:46:29] <ghrust> 13rust/06auto 14df40aec 15Patrick Walton: libstd: Add some functionality to `Vec<T>`
[06:46:29] <ghrust> 13rust/06auto 1458fd6ab 15Patrick Walton: libsyntax: Mechanically change `~[T]` to `Vec<T>`
[06:46:29] <ghrust> 13rust/06auto 14198cc3d 15Patrick Walton: libsyntax: Fix errors arising from the automated `~[T]` conversion
[06:46:31] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[06:49:12] *** Quits: bjz (bjz@AE0B7388.B8C2BBC3.F4A11E52.IP) (Ping timeout)
[06:50:59] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[06:51:34] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[06:51:34] *** ChanServ sets mode: +qo brson brson
[06:53:30] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[07:13:55] *** Joins: zv (zv@moz-955F83E9.hsd1.ca.comcast.net)
[07:19:51] *** Joins: Eric (textual@moz-CD721145.hsd1.mi.comcast.net)
[07:21:17] *** Quits: Eric (textual@moz-CD721145.hsd1.mi.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:31:30] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[07:31:30] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14f69a996 to 14c81b3fb: 02http://git.io/N3iJvQ
[07:31:30] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[07:31:32] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:31:32] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/xP9H9g
[07:31:32] <ghrust> 13rust/06auto 14c602c81 15Huon Wilson: rustdoc: syntax highlight macro definitions, colour $... substitutions....
[07:31:32] <ghrust> 13rust/06auto 14b9ae48a 15bors: auto merge of #12647 : huonw/rust/rustdoc-highlight-macros, r=alexcrichton...
[07:31:33] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:33:44] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[07:44:16] *** Quits: ktt3ja (ktt3ja@moz-54586A12.washdc.fios.verizon.net) (Quit: Leaving)
[07:57:39] *** Quits: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP) (Quit: Leaving...)
[08:02:51] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[08:20:39] *** Quits: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net) (Ping timeout)
[08:23:09] *** Joins: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net)
[08:25:40] *** Quits: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net) (Ping timeout)
[08:26:28] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[08:26:28] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Wajq5Q
[08:26:28] <ghrust> 13rust/06auto 14997ff7a 15Alex Crichton: rustc: Better error when loading invalid libraries...
[08:26:28] <ghrust> 13rust/06auto 14b5ad302 15bors: auto merge of #12645 : alexcrichton/rust/invalid-libraries, r=brson...
[08:26:28] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[08:26:29] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[08:26:29] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14b9ae48a to 14c81b3fb: 02http://git.io/N3iJvQ
[08:26:29] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[08:27:34] *** Joins: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net)
[08:29:23] *** Quits: meTaAU (admin@moz-8914DFBA.lns20.per1.internode.on.net) (Ping timeout)
[08:29:52] *** Joins: meTaAU (admin@moz-52BDAB21.lns20.per1.internode.on.net)
[08:31:03] *** Joins: eddyb (eddy@DD15F8DE.17CB6122.FCAAE698.IP)
[08:32:40] <doener> "double-failure - total drag!" heh
[08:39:30] *** Quits: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net) (Ping timeout)
[08:40:40] <eddyb> I really wish I could say impl Foo for Bar<_, _, _>
[08:41:08] <eddyb> Bar<..> even
[08:41:40] <eddyb> error: failed to find an implementation of trait std::fmt::Show for std::rc::Rc<~[std::rc::Rc<Expr<U>>]>
[08:41:53] <eddyb> bleah
[08:47:35] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[08:51:50] <eddyb> note: candidate #1 is `Rc<Expr<U>>.ExprExtensions<U>::eq`
[08:51:58] <eddyb> note: candidate #2 is `std::rc::Rc<T>.Eq::eq
[08:52:02] <eddyb> of course...
[08:54:35] *** kimundi is now known as zz_kimundi
[08:55:36] *** Joins: eibwen (kvirc@moz-E076B815.dip0.t-ipconnect.de)
[09:07:14] *** Quits: eibwen (kvirc@moz-E076B815.dip0.t-ipconnect.de) (Ping timeout)
[09:07:36] <eddyb> nmatsakis: trait Array<unsized*.. T>: Covariant<T> {const LEN: uint;} impl<T> Drop for Array<T> {...} impl<const N: uint> Array<T> for [T, ..N] {const LEN = N;}
[09:08:42] <eddyb> nmatsakis: now ~Array<Array<T>> should have the same repr as ~[[T]]. this abstraction shows that you can extend DST to any erased data, as long as it fits in an uint
[09:11:05] <eddyb> there was that thing on reddit. so you could have DST enums, where the discriminant is stored in the pointer to the enum
[09:15:26] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[09:15:53] <eddyb> trait Tree<T> {const IS_LEAF: bool;} impl Tree<T> for T {const IS_LEAF = true;} impl Tree<T> for (~Tree<T>, ~Tree<T>) {const IS_LEAF = false;}
[09:16:43] <eddyb> this could be used to achieve syntax sugar for those DST enums I've mentioned
[09:17:08] <eddyb> but we may need some sort of way of limiting a trait's impls to a safe subset
[09:18:06] <eddyb> otherwise, someone can do impl Tree<T> for () {const IS_LEAF = true;} // SEGFAULT
[09:29:16] <eddyb> huon, cmr: libir-77a5313b-0.0.rlib
[09:30:08] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[09:36:24] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[09:36:24] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/Wajq5Q
[09:36:24] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[09:39:55] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Ping timeout)
[09:41:26] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[09:41:26] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/97GAyg
[09:41:26] <ghrust> 13rust/06auto 14c602c81 15Huon Wilson: rustdoc: syntax highlight macro definitions, colour $... substitutions....
[09:41:26] <ghrust> 13rust/06auto 14baf7908 15bors: auto merge of #12647 : huonw/rust/rustdoc-highlight-macros, r=alexcrichton...
[09:41:27] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[09:46:46] <eddyb> huon, cmr: so I have operator overloading in Rust... but no simple way to do constant construction :(
[09:47:38] <eddyb> since I originally used the same names as the rust integer & floating-point types. and I can't see what other names I can use
[09:47:52] <eddyb> probably the wrong channel, too. this is almost osdev stuff. but actually RE
[09:48:52] <eddyb> acrichto: travis still hasn't picked up https://github.com/mozilla/rust/pull/12610
[09:49:05] <eddyb> ahhh I remember. needs rebase. hehe
[09:56:34] *** Quits: zv (zv@moz-955F83E9.hsd1.ca.comcast.net) (Ping timeout)
[09:57:53] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[09:58:16] *** Joins: zv (zv@moz-955F83E9.hsd1.ca.comcast.net)
[10:14:47] *** Quits: jsonnull (Thunderbir@20DADFC2.48C8B17D.494A0F8B.IP) (Quit: jsonnull)
[10:14:52] *** Joins: jsonnull (Thunderbir@20DADFC2.48C8B17D.494A0F8B.IP)
[10:20:12] <eddyb> hmm... you know what's amazing? we can make Any as cheap as an enum to match over...
[10:20:30] <eddyb> there's just no real cost to that kind of erasure
[10:22:49] <eddyb> well, ~Any has an indirection, which is a bit sad
[10:23:47] *** Quits: jsonnull (Thunderbir@20DADFC2.48C8B17D.494A0F8B.IP) (Quit: jsonnull)
[10:27:54] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[10:49:00] <huon> eddyb: lib 'ir'?
[10:49:15] <eddyb> just the result of my rustc invocation
[10:49:49] <huon> librandom_test-6891ed61-0.0.rlib
[10:49:55] <huon> what's your point? :P
[10:50:23] <eddyb> my point was easier to show if I didn't have to design trait-based workarounds for the demo
[10:51:04] <eddyb> https://travis-ci.org/mozilla/rust/builds/19906574 huh
[10:51:10] <eddyb> did something change?
[10:51:29] <huon> oh, is libir your Rust decompiler?
[10:51:30] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[10:51:30] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/97GAyg
[10:51:30] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[10:51:53] <eddyb> huon: ir just one module - the auto-generated one
[10:51:59] <eddyb> it finally compiled :P
[10:52:08] <huon> oh, awesome \o/
[10:52:14] <eddyb> didn't assert_eq use to use {:?}? are we moving away from that?
[10:52:35] <eddyb> I didn't see any PRs. must've opened and closed while I wasn't looking
[10:53:01] <huon> eddyb: yes, you blinked
[10:53:08] <huon> https://github.com/mozilla/rust/pull/12626
[11:00:20] *** zz_kimundi is now known as kimundi
[11:01:25] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:06:27] <eddyb> mkay, that should work now
[11:07:22] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[11:08:40] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[11:25:06] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[11:36:37] <kimundi> eddyb: What do you mean with making Any cheap?
[11:37:03] <eddyb> Any is semantically (*T, TypeId)
[11:37:13] <eddyb> I guess on u32 you'd need a pointer, oof
[11:37:25] <kimundi> ah, yeah
[11:37:48] <eddyb> s/u32/32-bit architectures/
[11:37:55] <kimundi> though I personally think that using a fixed sized hash is unwise
[11:38:07] <kimundi> because colisions etc
[11:38:18] <eddyb> hashes overlap too much
[11:38:25] <eddyb> while pointers overlap too little :(
[11:38:41] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[11:39:11] <kimundi> Well, we could also make Any not a trait - then we can tweak the representation as we like
[11:39:47] <eddyb> I want to keep Any as safe and clean as possible
[11:39:51] <kimundi> struct Any { priv data: *Erased, priv id: UniqueTypeDescriptor }
[11:40:03] <eddyb> and having general repr optimizations is good
[11:40:18] <kimundi> hash collision == memory unsafety
[11:40:25] <eddyb> kimundi: I know :(
[11:40:36] <eddyb> but I meant the trait-based impl
[11:40:49] <kimundi> but yeah, general optimizations of trait objects are a plus always
[11:40:51] <eddyb> (any &Trait with one method doesn't need a vtable, can store the method directly)
[11:41:07] <eddyb> (can possibly make Write have only one virtual method and everything else is an extension)
[11:41:14] <eddyb> *Writer (and Reader)
[11:42:04] <kimundi> That reminds, I should try removing those .as_void() and .as_mut_void() methods
[11:42:16] <eddyb> I should've done it already :/
[11:42:17] <kimundi> are managed data headers gone?
[11:42:30] <eddyb> &Trait never had headers :P
[11:42:47] <kimundi> yeah, but for ~Trait?
[11:42:48] <eddyb> that is, it would point directly at data - well, no
[11:43:09] <eddyb> ~Trait => &Trait didn't perform an adjustment and ~T could have @ headers
[11:43:22] <eddyb> so I guess you needed those methods - now that's gone :D
[11:43:59] <kimundi> so, again, are managed headers gone now? :)
[11:44:37] <eddyb> that's what I just said :). only for ~T though, so don't try to make @Any work without casting it to &Any first
[11:44:47] <eddyb> oh, wait, I removed @Trait. hehe
[11:45:41] <kimundi> So it would work, then. :) ets try this
[11:53:12] <kimundi> Is there a module with structs for raw casts of the representation of a trait object?
[11:53:38] <eddyb> there's "raw" but I'm not sure it has trait objects
[11:54:16] <huon> it can't parameterise over traits, and so could only have a limited subset of the possible trait objects
[11:54:41] <kimundi> right, just "pointer to data, pointer to vtable" would be enough for this
[11:54:56] <kimundi> yeah, nothing there in raw
[11:54:58] <eddyb> librustc/back/abi.rs should have some constants
[11:55:30] <kimundi> hm... add a limited trait obj repr, or just the unsafe casts directly...
[11:55:48] <kimundi> which one would be prefferable here?
[12:00:15] <eddyb> kimundi: I'd say... copy something like Closure
[12:01:44] <huon> `struct TraitObject { data: *(), vtable: *() } /** Only sensible to call with a trait object */ unsafe fn trait_object_repr<T>(x: T) -> TraitObject { transmute(x) } `
[12:02:17] <kimundi> huon: Is that copied from somewhere? Or is that a proposal for adding it. :)
[12:02:20] <eddyb> you don't even need the function... I don't think there are functions like that for Closure
[12:02:42] <eddyb> the structures are nice because they give you the layout. that's all you need, really
[12:02:55] <huon> kimundi: add it
[12:03:04] <huon> eddyb: how do you do it without the function?
[12:03:16] <eddyb> transmute?
[12:03:23] <eddyb> like everything working with Closure does :P
[12:03:39] <huon> yeah, the function just makes it obvious what's going on
[12:03:51] <huon> and avoids the need to type out any type hints
[12:04:12] <huon> (all of std::unstable::raw is unnecessary by that logic, since it's just fancy wrappers for transmutes)
[12:04:15] <huon> :P
[12:41:11] <eddyb> huon: yay, both PRs pass travis
[12:46:51] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Ping timeout)
[12:48:27] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[13:00:13] <kimundi> Hm, where do I find the typedescriptor struct again in libstd?
[13:00:40] <eddyb> TypeId in intrinsics
[13:00:53] <eddyb> unless you mean TyDesc which we hope to remove at some point
[13:00:53] <kimundi> thanks
[13:01:05] <kimundi> Err, I meant TypeDesc
[13:01:13] <kimundi> TyDesc
[13:01:28] <eddyb> still intrinsics. why do you want it?
[13:01:40] <kimundi> Just want to include it in the Traitobject repr
[13:01:45] <kimundi> as long as its there
[13:01:48] <eddyb> it's not
[13:01:55] <eddyb> vtables only have dtors now
[13:02:00] <kimundi> ...oh
[13:02:08] <kimundi> no longer first pointer == tydesc?
[13:02:12] <eddyb> nope
[13:02:15] <kimundi> well then, that makes this easier
[13:02:26] <eddyb> you don't need to touch the vtable, anyways
[13:02:44] <kimundi> sure
[13:03:07] <eddyb> DSTs are going to be (*data, ..erased_info)
[13:03:26] <kimundi> but the point of these repr structs is to map out what common structure there is, so I wanted to add it
[13:03:38] <kimundi> ANd yeah, if DST lands all this gets thrown out anyway
[13:03:59] <eddyb> with no constraints on the erased info, for traits. arrays will just have their dimensions
[13:04:17] <eddyb> [[[T]]] will be (*T, w, h, d) or something like that
[13:04:40] <eddyb> traits... can't rely on there being a vtable. could be just a function. or a pure value
[13:05:33] <eddyb> kimundi: we can turn TypeId into unique address-significant static values
[13:05:45] <kimundi> ah, so all this nested [] talk was about adding additional size fields
[13:05:46] <eddyb> with the right name mangling, should work cross-crate
[13:06:14] <eddyb> kimundi: yeah, shouldn't conflict with trait erasure (where you generally can only have one unsized data. but that can also be extended, safely)
[13:07:24] <eddyb> so fortran does some magic... I think it can have offsets and strides
[13:08:00] <eddyb> I don't think we want to burden slices with that kind of flexibility
[13:08:27] <eddyb> but we should make it relatively easy to implement such a flexible view in the library
[13:23:25] *** Joins: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca)
[13:27:22] *** Joins: aepsil0n (eduard@moz-BA8E3056.hsi8.kabel-badenwuerttemberg.de)
[13:29:14] *** Joins: eibwen (kvirc@moz-E076B815.dip0.t-ipconnect.de)
[13:29:43] <eddyb> huon: the bold keywords look *so good* :D
[13:30:17] <eddyb> it's not how it looks in my kdevelop, because I use a dark theme (so it's bold white there), but I love it
[13:30:54] *** Joins: edwardw (edwardw@B5386878.16F55560.50B134B9.IP)
[13:31:57] <eddyb> huon: we also ought to fix &&, that & & is so derpy
[13:32:44] <eddyb> I tend to use &("foo") because it's not entirely obvious that &"foo" is &'static str (and maybe it shouldn't be)
[13:40:31] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[13:41:59] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[14:00:36] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:04:06] *** Quits: aepsil0n (eduard@moz-BA8E3056.hsi8.kabel-badenwuerttemberg.de) (Ping timeout)
[14:07:05] *** Quits: angdev (angdev@16F167B.4C57D258.D8E8354F.IP) (Quit: Textual IRC Client: www.textualapp.com)
[14:19:30] *** Quits: edwardw (edwardw@B5386878.16F55560.50B134B9.IP) (Quit: Leaving...)
[14:40:49] <doener> I wonder if there's a downside to using internal linkage for functions with an inline hint or alwaysinline 
[14:41:10] <eddyb> doener: is there any upside?
[14:41:17] <doener> faster compile times
[14:41:27] <eddyb> those functions are expected to be inlined in each crated
[14:41:38] <eddyb> and inlined items should be internal
[14:41:48] <eddyb> AFAIK
[14:41:52] <doener> libstd (with --emit asm,ir -O) goes down from ~19s to ~16.8s
[14:42:06] <eddyb> :shipit:
[14:43:08] <doener> AFAIK, we're exporting the AST for inline functions, as we do for generics, which are also using internal linkage
[14:43:59] <eddyb> we can turn that optimization off if we decide to reuse generics cross-crate
[14:44:13] <eddyb> but it feels like pointless deoptimization without LTO
[14:44:49] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[14:46:39] <doener> eddyb: I meant that as to support my point, i.e. that I'm just following suit there by also using internal linkage ;-)
[14:46:49] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[14:48:51] <eddyb> doener: sure, I wonder why we don't do it already :/
[14:49:06] <eddyb> probably because of the different code path when we inline cross-crate
[15:00:43] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:00:55] <doener> hm, I wonder if it should be linkonce_odr instead
[15:02:35] <doener> hm, strcat opened (and closed) #5490 for this, so I guess internal will do for now
[15:15:24] *** Joins: Eric (textual@moz-CD721145.hsd1.mi.comcast.net)
[15:16:31] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:16:32] *** ChanServ sets mode: +ao dherman dherman
[15:25:08] <doener> why do we need to enable multithreading for llvm again?
[15:26:22] <eddyb> rustdoc
[15:26:31] <eddyb> (of all the things
[15:27:23] <doener> where/why does that use LLVM?
[15:36:59] <doener> ah, the test module
[15:46:15] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:55:44] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:05:22] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[16:05:43] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[16:07:25] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[16:09:23] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:09:23] *** ChanServ sets mode: +ao dherman dherman
[16:09:50] *** Joins: aepsil0n (eduard@moz-4C8FF5AA.hsi8.kabel-badenwuerttemberg.de)
[16:12:21] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:22:40] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:31:37] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[16:31:37] <ghrust> [13rust] 15bors pushed 7 new commits to 06auto: 02http://git.io/Q1A9Zg
[16:31:37] <ghrust> 13rust/06auto 14df40aec 15Patrick Walton: libstd: Add some functionality to `Vec<T>`
[16:31:37] <ghrust> 13rust/06auto 1458fd6ab 15Patrick Walton: libsyntax: Mechanically change `~[T]` to `Vec<T>`
[16:31:38] <ghrust> 13rust/06auto 14198cc3d 15Patrick Walton: libsyntax: Fix errors arising from the automated `~[T]` conversion
[16:31:40] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[16:42:18] <kaeso> aren't the lib hashes supposed to be stable and only based on crate_id? If so, why I am seeing libsyntax-ebc61d75-0.10-pre.so and libsyntax-d4b01541-0.10-pre.so building two different commits?
[16:42:36] <eddyb> we changed the scheme or something
[16:43:03] <cmr> no, we now have so-called "strict version hashes", and they are a hash of the entire crate.
[16:43:29] <cmr> https://github.com/mozilla/rust/pull/12533
[16:43:34] <SiegeLord> So the "let's compute the hash without rustc" went out of the window?
[16:44:23] <eddyb> I wonder how much normalization we do
[16:44:44] *** Quits: japaric (japaric@78791742.A23A5F6C.E5B504CC.IP) (Ping timeout)
[16:45:14] <cmr> yes, reasoning: https://github.com/mozilla/rust/issues/10207
[16:46:10] <SiegeLord> That doesn't even mention that feature... I guess it wasn't deemed important
[16:46:27] <cmr> that principle (not really a feature) wasn't a gleam in anyone's eye when it was proposed :p
[16:46:56] <eddyb> cmr: I guess I've should've explicitly proposed a simpler testcase https://github.com/mozilla/rust/issues/8516
[16:47:02] <SiegeLord> Need to fix the --crate-name etc now, heh
[16:47:11] <cmr> are they broken?
[16:47:26] <SiegeLord> For some crate names (e.g. with newlines in them)
[16:47:28] <eddyb> cmr: I know enum Either { One(()), Other(~str, ~str) } triggers the same problem
[16:47:41] *** Quits: Kxepal (Miranda@moz-7A0000DE.pppoe.mtu-net.ru) (Ping timeout)
[16:47:43] <eddyb> cmr: I found that issue searching for struct_variant bugs, wondering if we can lift the feature gate
[16:47:59] <cmr> eddyb: that doesn't really matter, the bug was never involving struct_variants explicitly...
[16:48:10] <eddyb> the testcase was :/
[16:48:24] <cmr> so?
[16:48:43] <eddyb> and I've seen waaay more irrelevant testcases, so I shouldn't complain
[16:48:58] <cmr> it's not really irrelevant... it exhibits the bug.
[16:49:07] <cmr> it's not like struct variants are evil
[16:49:39] <eddyb> it's just that it's the only open issue with struct_variants in it that I've found, and it's not related to struct variants :P
[16:49:56] <eddyb> and it bugs me a bit
[16:50:29] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[16:51:34] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[16:52:04] *** Joins: Kxepal (Miranda@moz-D26FCE20.pppoe.mtu-net.ru)
[16:53:17] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[16:53:35] <cmr> hm
[16:53:53] <cmr> rustdoc should show reexports of privates items like regular items, not as reexports.
[16:54:13] <SiegeLord> I thought it did already, no?
[16:54:23] <cmr> does it?
[16:54:25] * cmr checks
[16:54:39] <SiegeLord> For most things, at least
[16:57:32] <cmr> indeed it does.
[16:57:36] <cmr> that's incredibly convenient.
[16:58:01] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[16:58:05] <eddyb> "`eax` moved here because it has type `std::rc::Rc<lib::ir::Expr>`, which is non-copyable"
[16:58:22] <eddyb> this is a bit sad, usability-wise
[17:01:08] *** Joins: japaric (japaric@8D66AA8D.A8462175.F29ED47E.IP)
[17:04:08] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[17:06:12] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[17:14:22] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[17:15:24] *** Quits: Eric (textual@moz-CD721145.hsd1.mi.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:15:30] *** Joins: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP)
[17:23:23] *** Joins: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP)
[17:32:23] *** Joins: intuxicated (intuxicate@C36E0E08.A0BADBCC.DA0107E2.IP)
[17:41:32] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[17:41:32] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/Q1A9Zg
[17:41:32] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[17:45:08] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:50:53] <cmr> eddyb: did removing callee-id's have any notable impact on compiler perf?
[17:51:09] <eddyb> I don't think I checked
[17:51:19] <cmr> k
[17:51:20] <eddyb> I did it so I can implement auto-overloaded-deref
[17:51:46] <eddyb> http://huonw.github.io/isrustfastyet/mem/#3b09469 lol
[17:52:51] <eddyb> cmr: it's maybe slightly faster, but that might as well be noise
[17:53:11] <eddyb> see http://huonw.github.io/isrustfastyet/mem/#05a2d32,6c41f99
[18:06:34] *** kimundi is now known as zz_kimundi
[18:16:53] *** Joins: Eric (textual@moz-CD721145.hsd1.mi.comcast.net)
[18:25:53] *** Quits: eibwen (kvirc@moz-E076B815.dip0.t-ipconnect.de) (Ping timeout)
[18:33:04] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[18:42:27] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[18:48:02] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[18:49:13] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[18:51:23] *** Joins: asdf (Mibbit@5792FA03.CE6A8161.D5851B94.IP)
[18:52:23] *** Quits: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca) (Quit: canhtak)
[18:54:24] *** Parts: asdf (Mibbit@5792FA03.CE6A8161.D5851B94.IP) ()
[18:55:52] *** Joins: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca)
[18:55:54] *** Quits: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0.1/20140218135856])
[19:15:23] *** Quits: Eric (textual@moz-CD721145.hsd1.mi.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[19:21:36] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[19:21:36] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/bjzO2w
[19:21:36] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[19:25:30] *** Joins: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net)
[19:26:17] *** Joins: gwty (gwtypc@202D8814.52057CB1.137C914F.IP)
[19:27:27] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Client exited)
[19:33:34] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[19:40:47] *** Parts: aepsil0n (eduard@moz-4C8FF5AA.hsi8.kabel-badenwuerttemberg.de) ()
[19:41:38] *** Quits: luzie (lu.cy@moz-CD18B14B.customer.cdi.no) (Input/output error)
[19:41:45] *** Joins: luz (lu.cy@moz-CD18B14B.customer.cdi.no)
[19:47:49] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[19:47:49] <ghrust> [13rust] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/Z5NA7Q
[19:47:49] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[19:47:59] <cmr> We had a new contributor for every day last week.
[19:52:41] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[19:55:07] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[20:04:52] *** Quits: esummers_ (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[20:05:16] *** Joins: esummers_ (esummers@moz-3B015C90.wi.res.rr.com)
[20:06:56] *** Quits: esummers_ (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[20:11:21] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[20:15:59] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[20:18:38] *** zz_kimundi is now known as kimundi
[20:31:39] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[20:31:39] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/CcYMnw
[20:31:39] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[20:32:15] *** Quits: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP) (Quit: Leaving...)
[20:32:16] *** Joins: esummers_ (esummers@moz-3B015C90.wi.res.rr.com)
[20:34:34] *** Quits: gwty (gwtypc@202D8814.52057CB1.137C914F.IP) (Connection reset by peer)
[20:39:03] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[20:51:37] *** Quits: intuxicated (intuxicate@C36E0E08.A0BADBCC.DA0107E2.IP) (Ping timeout)
[20:53:38] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[20:57:45] *** Joins: blank_name1 (blank_name@463DB555.53526368.6D228269.IP)
[20:57:55] *** Quits: blank_name1 (blank_name@463DB555.53526368.6D228269.IP) (Quit: WeeChat 0.4.3)
[21:22:01] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Client exited)
[21:23:07] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[21:39:57] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[21:41:30] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[21:41:30] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/OLK-uw
[21:41:30] <ghrust> 13rust/06auto 149790460 15Virgile Andreani: Add /etc/terminfo to the terminfo search paths
[21:41:30] <ghrust> 13rust/06auto 1451233c5 15bors: auto merge of #12656 : Armavica/rust/terminfo, r=sfackler...
[21:41:31] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[21:41:57] <eddyb> acrichto: this makes panda and koalas everywhere sad https://github.com/mozilla/rust/pull/12635#discussion_r10197050
[21:42:00] <eddyb> *pandas
[21:42:14] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[21:43:30] <acrichto> eddyb: ?
[21:44:04] <eddyb> not being able to do HashMap::new() and have it work with different hashers
[21:44:18] <acrichto> that's what with_hasher() is for
[21:44:55] <eddyb> and then you had to wrap them in NodeMap and NodeSet
[21:45:28] <eddyb> I just hoped it would require less changes to change the hasher
[21:45:48] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[21:46:31] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:47:07] <eddyb> bleah. I should go to sleep and find something to do tomorrow. any kind of syntax/rustc refactoring I think of would affect my deref PRs. I could try to turn std::fmt upside down, I've been planning to do that for a while now
[21:48:26] <acrichto> I had to wrap them?
[21:48:31] <acrichto> I just put them in a typedef?
[21:48:45] <eddyb> NodeMap::new() and NodeSet::new()
[21:49:09] <acrichto> for convenience, yes
[21:50:03] <eddyb> don't worry, I just have conflicted feelings about the way we use type hints and whatnot
[21:50:36] <eddyb> there's a similar problem with box. you may want let x = box 5; to produce ~int, for convenience
[21:51:12] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[21:51:53] <eddyb> I want let x: Rc<int> = box 5; to work, and *just* that is expressible with a trait (something like FromStr or FromPrimitive), but it won't default to anything if it can't infer the type
[22:01:38] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:02:19] <huon> acrichto: did you see the discussion around https://botbot.me/mozilla/rust-internals/msg/11617408/ ?
[22:09:04] *** Joins: bytewise (bytewise@moz-20A3039F.adsl.alicedsl.de)
[22:10:03] <acrichto> huon: I did not, but why does anyone need to compute the crate hash?
[22:10:06] <acrichto> it is not the hash listed in the filename
[22:10:26] <huon> Oh, ok; I guess SiegeLord had misinterpreted (as had I)
[22:10:43] <SiegeLord> There are two hashes :?
[22:10:44] <acrichto> the hash in the filename is purely just for disambiguation righ tnow
[22:10:45] <acrichto> nothing reads it
[22:11:01] <acrichto> yes, I specificaly didn't change the filename one for the reasons you mentioned
[22:11:20] *** Joins: eibwen (kvirc@moz-B706ADB3.dip0.t-ipconnect.de)
[22:11:43] <acrichto> ah, so we do use the hash in the filename
[22:11:47] <acrichto> but just for loading libraries
[22:12:00] <acrichto> the new SVH is entirely an implementation detail that is invisible to all but the compiler
[22:12:25] <eddyb> weird
[22:12:37] <acrichto> abi is hard
[22:12:53] <huon> (and users, when they see the errors created by a mismatch hash... but it's better than the ICE that previously happened)
[22:12:55] <jensnockert> Everything is hard.
[22:13:19] <huon> Talc is not
[22:13:42] <eddyb> jensnockert: that's what she said
[22:16:20] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[22:17:59] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:18:04] *** Joins: Eric (textual@B5214553.C1B4C78F.817B4D31.IP)
[22:19:07] <cmr> wait so I don't understand SVH either
[22:19:15] <cmr> acrichto: what exactly is it, where is it used?
[22:19:22] <cmr> is it *just* in metadata, for detecting version change?
[22:19:51] <acrichto> yes
[22:20:02] <acrichto> it's a hash saying that you are linked against library version X
[22:20:12] <acrichto> that library can then only ever link to library version X
[22:20:21] <acrichto> if the library is found with version Y, it is rejected
[22:20:51] <cmr> so... why aren't we just using build id's for this?
[22:20:54] <acrichto> the hash is currently only used when loading dependencies
[22:21:02] <acrichto> this hash is a mirror of the ABI
[22:21:08] <acrichto> std#0.10-pre changes a lot
[22:21:21] <acrichto> just because you linked to one doesn't mean you can link to another one
[22:21:35] <cmr> right
[22:21:35] <eddyb> hmm...
[22:21:36] <acrichto> the crate id is for the filename and the filename only, beyond that it means nothing about ABI
[22:21:47] <eddyb> dynamic linking should care about the public ABI
[22:22:02] <eddyb> while... nevermind we always inline generics and whatnot
[22:22:14] <acrichto> that's why generics are part of the ABI
[22:22:20] <acrichto> that's why they're part of the SVH
[22:22:32] <eddyb> yeah, makes sense
[22:22:37] <acrichto> the ABI of a rust crate is more encompassing than most think
[22:22:52] <eddyb> Rust being incompatible with dependency patching and whatnot, by default
[22:25:10] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[22:25:11] <cmr> updated the twir bit about it
[22:25:53] <acrichto> lgtm
[22:26:10] <cmr> thanks
[22:26:56] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[22:28:16] *** Quits: Eric (textual@B5214553.C1B4C78F.817B4D31.IP) (Quit: )
[22:29:33] *** Joins: Puzzler (puzzler@B5214553.C1B4C78F.817B4D31.IP)
[22:30:03] <acrichto> building stage{1,2} {x86/i686} rustc in parallel
[22:30:06] <acrichto> go make -j10
[22:30:07] <acrichto> !
[22:31:12] <eddyb> huh, what's {x86/i686}?
[22:31:44] <acrichto> oh just the 2 archs
[22:31:58] <aatch> I think you mean x64 or something
[22:31:59] <acrichto> basically 4 parallel builds of rustc on one machine
[22:32:02] <acrichto> it is quite sad at the moment
[22:32:05] <aatch> those two arch are the same
[22:32:12] <acrichto> yay intel
[22:32:32] <aatch> (the 'x' is a placeholder)
[22:32:48] <cmr> acrichto: r? https://github.com/mozilla/rust/pull/12526
[22:47:50] <acrichto> sfackler: I found the bug, commenting now
[22:48:54] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[22:50:18] <cmr> eugh
[22:50:53] <cmr> huon: https://gist.github.com/cmr/9315182
[22:51:03] <cmr> I think the prelude's Primitive is overriding it :(
[22:51:16] <cmr> not entirely sure.
[22:51:25] <cmr> but it works for non-prelude names.
[22:51:26] <acrichto> sfackler: https://github.com/mozilla/rust/issues/12102#issuecomment-36470566
[22:51:58] <huon> cmr: weird
[22:52:07] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Connection reset by peer)
[22:52:31] <huon> cmr: that lint gets all its information from the canonical source (i.e. the pass that exports things)
[22:52:35] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[22:52:35] *** ChanServ sets mode: +o acrichto
[22:52:53] <huon> so I think it is being shadowed or something (and so is "legitimately" not exported)
[22:53:02] <cmr> yes, this is my thinking as well.
[22:53:21] *** Quits: Puzzler (puzzler@B5214553.C1B4C78F.817B4D31.IP) (Quit: )
[22:53:24] <cmr> I think the reexport is getting the trait
[22:53:27] <cmr> let me try..
[22:53:50] <cmr> ... nope
[22:53:53] <sfackler> acrichto: yeah, cross compilation + phase(syntax) is super busted
[22:53:54] <cmr> that's extra weird.
[22:59:45] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[23:00:12] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[23:01:40] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[23:01:40] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/OLK-uw
[23:01:40] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[23:02:03] *** Quits: eddyb (eddy@DD15F8DE.17CB6122.FCAAE698.IP) (Ping timeout)
[23:02:13] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:02:47] <acrichto>  // Copyright 2012-2013-2014 The Rust Project Developers.
[23:02:49] <acrichto> lol
[23:03:35] <cmr> huon: https://gist.github.com/cmr/9315182
[23:03:42] <cmr> extra weird :\
[23:06:10] <huon> cmr: bugs \o/
[23:06:14] <cmr> acrichto: could you take a look at that perhaps? I think it's a bug in privacy.
[23:06:37] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[23:06:37] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/E64s5g
[23:06:37] <ghrust> 13rust/06auto 14a0e54c7 15Steven Fackler: Expand string literals and exprs inside of macros...
[23:06:37] <ghrust> 13rust/06auto 14813544f 15bors: auto merge of #12658 : sfackler/rust/asm-expand, r=alexcrichton...
[23:06:38] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[23:06:39] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[23:06:39] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/zhjAKg
[23:06:39] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[23:07:30] <acrichto> cmr: that seems bad
[23:08:28] <huon> wasn't there concerns about nested expansion? ^
[23:08:48] <acrichto> whoa
[23:08:55] <acrichto> if you change the name you hit a rustc assertion
[23:09:09] <cmr> what'd you change it to?
[23:09:29] <acrichto> T
[23:09:35] <acrichto> task 'rustc' failed at 'expected bare rust fn or an intrinsic', /Users/alex/code/rust3/src/librustc/middle/trans/base.rs:1790
[23:09:49] <cmr> hm, looking for the constructor perhaps?
[23:11:35] <acrichto> cmr: https://github.com/mozilla/rust/issues/12660
[23:12:40] <acrichto> ooooh
[23:12:45] <huon> r? https://github.com/mozilla/rust/pull/12650
[23:12:45] <acrichto> I think it's b/c you have 'pub use foo'
[23:12:48] <acrichto> as well as 'mod foo'
[23:13:07] <acrichto> huon: r+ from me, but I want to get some more opinions
[23:14:23] <huon> sure
[23:16:49] <acrichto> cmr: https://github.com/mozilla/rust/issues/12661
[23:23:34] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[23:26:43] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:29:05] <cmr> well
[23:29:12] <cmr> I'll just work around it for now
[23:29:24] <cmr> but once this project is turned in I'll try fixing those :)
[23:30:32] <huon> rename the types in libstd! :P
[23:30:40] <cmr> acrichto: my situation is really a struct `Primitive` in a mod `container`, reexported from the crate root.
[23:31:27] <cmr> enum, sorry.
[23:32:55] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[23:56:47] <huon> acrichto: I thought of another solution to that random stuff in `std::io::test`: can it become it's own crate that's only used for `cfg(test)`? (it would remove that module from every libstd build too, which is a small benefit too)
[23:56:58] <huon> anyway, gtg so I can't explore that now.
[23:57:13] *** Quits: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net) (Ping timeout)
[23:57:52] <acrichto> huon: probably yeah, nothing outside of libstd currently depends on it
[23:58:08] <acrichto> an increasing number is arguable more correct though
[23:58:17] <acrichto> arguably*
[23:58:54] *** Joins: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net)
[23:59:04] *** Quits: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net) (Connection reset by peer)
[23:59:38] <huon> I guess so; I'll just leave it as is then
[23:59:41] * huon disappears
[23:59:43] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Quit: huon)
