[00:00:15] <strcat> so if you do...
[00:00:18] <strcat> rustc -Z l<tab>
[00:00:21] <strcat> it menu completes fine
[00:00:24] <strcat> but then
[00:00:29] <strcat> rustc -Z lint-llvm <tab>
[00:00:38] <strcat> will try completing another debug opt instead of a .rs file :(
[00:00:44] <MaikKlein> bjz_, couldn't find anything. but sth like lmath::mat::translate(vec4) would be nice I guess
[00:00:45] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90-rdmsoft [XULRunner 18.0.2/20130201065344])
[00:00:46] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[00:00:50] <strcat> anyway being fixed by someone who actually understands that
[00:01:19] <bjz_> MaikKlein: I'm thinking a transform trait might be good, and impl on a mat4 and QuatTransoform type
[00:01:32] * strcat also needs to teach it that 0, 1, 2 and 3 are the parameters to opt-level, and the pretty parameters, etc.
[00:01:39] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[00:01:39] *** ChanServ sets mode: +o dherman
[00:01:58] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[00:02:04] <bjz_> MaikKlein: I already have the skeleton in place, but it's great to have somebody asking for them
[00:02:19] <bjz_> MaikKlein: makes me work harder :)
[00:02:29] <MaikKlein> bjz_, I send you a PR later, is it okay if I put everything in one PR?
[00:02:38] <bjz_> MaikKlein: sure thing
[00:02:40] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[00:02:41] <MaikKlein> bjz_, haha nice
[00:02:54] <bjz_> MaikKlein: sorry for the messy state of the lib :(
[00:03:12] <MaikKlein> bjz_, I found that the identity matrix for mat4 is broken, gonna investigate now.
[00:03:22] <bjz_> 8O
[00:03:25] <bjz_> wah?
[00:03:26] <cmr> There's really no way to write rustdoc without resolve.
[00:03:29] <MaikKlein> bjz_, it actually is very impressive, I help as much as I can
[00:04:09] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[00:04:44] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[00:04:46] <cmr> pcwalton: would it be possible to slip in a conditional pass after resolve that just dumps the AST + what resolved to where
[00:04:53] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[00:05:00] *** Joins: jedestep (jedestep@moz-CFA8EBCD.natpool.nyu.edu)
[00:05:36] *** Quits: jedestep (jedestep@moz-CFA8EBCD.natpool.nyu.edu) (Quit: jedestep)
[00:05:48] *** Joins: dbaupp (Thunderbir@moz-EAB436DB.lns20.syd6.internode.on.net)
[00:06:13] *** Parts: ecr (ereed@2557E599.66715431.D25A875A.IP) ()
[00:06:51] <cmr> pcwalton: that probably wouldn't work well with lazy resolve though, would it?
[00:07:34] <strcat> wooo fixed zsh completion
[00:07:39] <cmr> that was fast
[00:07:43] <MaikKlein> zsh?
[00:07:54] <Seldaek> any clue how I can turn 'X' (char) in a u8? 
[00:08:06] <cmr> rusti: 'X' as u8
[00:08:07] -rusti- 88
[00:08:13] <Seldaek> oh 
[00:08:14] <cmr> Seldaek: not really possible though
[00:08:18] <cmr> char is a 32bit unicode codepoint
[00:08:20] <pcwalton> cmr: it'd work fine :)
[00:08:25] <Eridius> someone should write a shell named ysh, and pronounce it "yeesh"
[00:08:41] <Seldaek> cmr: well, I only need it for \r which is ascii range, so I guess it's fine for that?
[00:08:50] <strcat> MaikKlein: cmr: https://paste.xinu.at/pUmjdo/ :)
[00:09:24] <MaikKlein> nice
[00:10:15] <cmr> Seldaek: not really. use to_byte from std::ascii
[00:10:38] *** Quits: rix (mindginati@moz-90AB6445.dyn.cust.vf.net.nz) (Quit: zzZZZ)
[00:10:45] <nmatsakis> pcwalton: regarding my branch for extern fns,
[00:10:53] <nmatsakis> pcwalton: I've been rebasing it today. 
[00:10:56] <nmatsakis> strcat: bstrie ^
[00:11:05] <strcat> nice :)
[00:11:19] <Thad> rusti: char(1)
[00:11:19] -rusti- <anon>:9:9: 9:13 error: unresolved name `char`.
[00:11:19] -rusti- <anon>:9          char(1)
[00:11:19] -rusti-                   ^~~~
[00:11:19] -rusti- error: aborting due to previous error
[00:11:19] -rusti- application terminated with error code 101
[00:11:38] <cmr> rusti: 1 as char
[00:11:39] -rusti- '\x01'
[00:11:51] <Thad> cmr:  SOH as alias ???
[00:12:02] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[00:12:04] <cmr> Thad: what?
[00:12:17] <Thad> char 1 is Start of Header (SOH)
[00:12:29] <pcwalton> nmatsakis: great!
[00:12:37] <MaikKlein> what?
[00:12:51] <MaikKlein> we might get https://github.com/mozilla/rust/pull/6661in 0.7?
[00:12:56] <nmatsakis> pcwalton: it's very painful due to the Great Trans Rewrite and the move to iterators, but mostly done now
[00:13:00] <Seldaek> cmr: alright thanks
[00:13:46] *** Quits: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net) (Quit: Quitting)
[00:14:26] <strcat> cmr: https://github.com/mozilla/rust/pull/7470 r?
[00:14:35] *** Joins: heftig (heftig@moz-207A74ED.dip0.t-ipconnect.de)
[00:14:39] <cmr> ah gtmanfred
[00:14:43] <cmr> who else :p
[00:15:50] <nmatsakis> I've also been rebasing the irrefutable pattern changes; according to cmr they regressed cycle time slightly, but I'm tempted to just land anyhow. I observe no difference locally so it's had for me to test, and the code is doing such very wrong things...
[00:16:05] <nmatsakis> pcwalton: graydon: anyone: thoughts on ^?
[00:16:29] <cmr> nmatsakis: land it anyway I say
[00:16:39] <graydon> if we don't have the ability to measure in clear enough detail, I'd land it.
[00:16:54] <nmatsakis> it might also be that cycle time goes up a bit because the borow checker is checking a lot of thing sthat were previously unchecked
[00:16:56] <Seldaek> ok now I'm properly confused, "let command = str::from_bytes(args[0]).to_ascii().to_lower().to_str();" yields "error: borrowed value does not live long enough" on the str::from_bytes() bit.. really not sure how to fix that
[00:16:58] <graydon> if it's like an off-the-charts perturbation, we can investigate after
[00:17:06] <cmr> it was like 4-6% iirc
[00:17:12] <graydon> :(
[00:17:23] <graydon> well, we're moving that much regularly due to obvious low hanging fruit at the moment
[00:17:33] *** Quits: echristo (echristo@D423593A.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[00:17:33] <cmr> I'd definitely buy the borrow checker story though
[00:17:37] <graydon> this is important stuff. major correctness, yes?
[00:17:59] <Eridius> Seldaek: you fix it by assigning the results of str::from_bytes() to a variable
[00:18:25] <Seldaek> Eridius: I see, no way to just chain this eh? sad
[00:18:39] <Eridius> Seldaek: yeah it's an issue. rvalues aren't kept alive
[00:19:10] <Seldaek> indeed turning it into this works, but looks silly: let command = str::from_bytes(args[0]); let command = command.to_ascii().to_lower().to_str();
[00:19:21] <Seldaek> thanks though
[00:19:25] <cmr> graydon: strcat: doener: nmatsakis: (anyone else): there is a lot of variability in my benchmarks time-wise though
[00:19:40] <cmr> they're intended for memory usage for the most part..
[00:19:53] <cmr> we're talking +/- 30 seconds
[00:20:02] <cmr> (and that's with turbo off!)
[00:20:10] <Eridius> Seldaek: you're parsing it as utf-8, then asserting it's ascii. you should just say `let command = args[0].into_ascii()`
[00:20:19] <Eridius> actually no you can't use into, that takes ownership
[00:20:32] <Eridius> but you can still say args[0].to_ascii()
[00:20:35] <Eridius> and you should be able to chain that one
[00:20:44] <cmr> Sometimes I can get reproducible timings, sometimes I can't
[00:22:14] <graydon> nmatsakis: please land if you can
[00:22:23] <nmatsakis> graydon: yeah, will do, I'm rebasing now
[00:22:56] <strcat> cmr: try using cpuacct too
[00:22:59] <strcat> instead of real time
[00:23:06] <cmr> strcat: I do measure cpuacct
[00:23:08] <strcat> oh
[00:23:12] <cmr> it's in all the json
[00:23:12] *** Joins: mib_0mp2bs (Mibbit@moz-D676CF1C.tampfl.fios.verizon.net)
[00:23:15] <zargony> Should it be possible to get a &Trait from a ~Trait?
[00:23:17] <cmr> I just don't do anything with it
[00:23:19] <sully> !
[00:23:21] <doener> cmr: hm, too bad. I wonder why that happens, I usually get pretty stable results here (with turbo, but not using the box otherwise while benchmarking)
[00:23:25] <strcat> cmr: might be better to use that than the real time
[00:23:33] <strcat> measures how long it was scheduled for
[00:23:38] <sully> god, I love the feeling when you finally crack the case on a tricky bug
[00:23:48] <Seldaek> Eridius: ah yup that works, a bit better thanks
[00:24:01] <Seldaek> and it finally compiles again, about time
[00:24:59] <cmr> I'm using a bit older kernel right now though because my staging one exploded when I pulled in the radeon dpm changes... so it could be a config thing, I used to get reliable results
[00:28:43] *** Quits: deioddd (Mibbit@moz-2F7B19D2.dynamic.tstt.net.tt) (Quit: http://www.mibbit.com ajax IRC Client)
[00:28:58] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[00:30:17] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[00:30:24] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Ping timeout)
[00:30:25] <graydon> strcat: aside from "nobody having run with it yet", is there anything blocking migration of the for protocol to use external iterators?
[00:30:39] <strcat> graydon: not really anything blocking it
[00:31:15] <strcat> graydon: there are still maybe 100 uses of it with internal iterators
[00:31:30] <strcat> but they could use 'do'
[00:32:04] <MaikKlein> bjz_, https://github.com/bjz/lmath-rs/pull/16
[00:32:05] <sully> doh.
[00:33:12] <strcat> graydon: nmatsakis suggested just making 'advance' a no-op to land it, so they can be the same in stage0/stage{1,2}
[00:33:24] <bjz_> is Clone implemented for numbers?
[00:33:40] <strcat> bjz_: yes
[00:33:43] <dbaupp> rusti: 1u.clone()
[00:33:44] -rusti- 1
[00:33:57] <bstrie> rusti: -1u.clone()
[00:33:58] -rusti- 18446744073709551615
[00:34:10] <Eridius> rusti: (-1u).clone()
[00:34:11] -rusti- 18446744073709551615
[00:34:13] <strcat> https://github.com/mozilla/rust/blob/master/src/libstd/clone.rs#L27
[00:34:29] <bstrie> rusti: -1u8.clone() as u16
[00:34:29] -rusti- 255
[00:34:43] <bjz_> MaikKlein: could you do a find/replace on Copy -> Clone, and change the copy keyword to the .clone() method?
[00:34:57] <bjz_> MaikKlein: copy is deprecated
[00:35:07] <MaikKlein> bjz_, oh I didn't know that
[00:35:10] <MaikKlein> bjz_, sure
[00:35:17] <bjz_> MaikKlein: thanks! :D
[00:35:21] <graydon> strcat: ok. has anyone sketched the actual translation yet?
[00:35:46] <Thad> Rust is ... a WIMP.
[00:35:53] <Thad> Work in MAJOR Progress
[00:35:55] <bjz_> MaikKlein: I think we should do #[deriving(Clone)] for everything too
[00:36:21] <Eridius> rusti: (1,1).clone()
[00:36:21] -rusti- (1, 1)
[00:36:41] <Eridius> strcat: I don't see a Clone impl in clone.rs. How did that just work?
[00:36:48] <Eridius> is it defined elsewhere?
[00:36:56] <strcat> graydon: https://github.com/mozilla/rust/issues/6997#issuecomment-19138751 you mean like that?
[00:37:04] <MaikKlein> is copy really deprecated? I thought copy is shallow and clone is deep?
[00:37:16] <strcat> graydon: liveness/borrowck will need updating too
[00:37:16] <Eridius> .deep_clone() is deep
[00:37:24] <strcat> clone is the same as copy
[00:37:30] <MaikKlein> ah ok
[00:37:33] <strcat> it copies anything owned
[00:37:38] <strcat> by that variable
[00:37:55] <strcat> &, &mut, slices, @ and @mut get shallowly copied
[00:38:03] <strcat> DeepClone traverses through @/@mut/Rc/RcMut
[00:38:14] <sully> hm
[00:38:18] <Eridius> ah tuple.rs
[00:38:33] <sully> graydon: after having tracked the bug down that was blocking me, I think I am going to submit my PR without fixing it
[00:38:38] <sully> graydon: and fix it early next week
[00:38:39] <bjz_> would be nice if Clone could be renamed to Copy eventually
[00:39:15] <MaikKlein> bjz_, do you know if I can replace sth like "copy xxx" to "xx.clone()" in sublime?
[00:39:30] <bjz_> MaikKlein: I don't think so
[00:39:31] <graydon> strcat: yeah. I mean actually implementing that transformation in trans. or potentially an earlier pass if we want to lower it earlier. has anyone done that yet?
[00:39:33] <MaikKlein> :(
[00:39:38] <strcat> graydon: nope
[00:39:41] <Eridius> MaikKlein: building a regex to match "an expression" (e.g. your xxx) is not doable
[00:39:41] <graydon> strcat: ok
[00:39:54] <cmr> bjz_: MaikKlein if it has good regexps you can
[00:39:54] <MaikKlein> bjz_, ok I do it tomorrow then
[00:39:57] <bjz_> MaikKlein: I'd just to a project find on copy
[00:40:02] <cmr> well, not really, actually
[00:40:06] <dbaupp> MaikKlein: how many are just a plain `copy ident`?
[00:40:06] <bjz_> MaikKlein: it has good regex
[00:40:10] <cmr> you'd need a rust parser in your regex :p
[00:40:19] <bjz_> MaikKlein: not sure how to do it though
[00:40:23] <Eridius> maybe someone should build a rust equivalent to Go's gofmt (which can transform expressions based on user-provided rules)
[00:40:30] <sully> graydon: (it is a default bug unrelated to the bugs I am fixing in this PR)
[00:40:36] <MaikKlein> dbaupp, like 100 or so
[00:40:47] <bjz_> MaikKlein: the issue is that they're not all idents
[00:40:54] <cmr> Eridius: maybe that someone... is you! :P
[00:40:56] <bjz_> MaikKlein: I can do it if you like
[00:41:12] <Eridius> cmr: hehe. I wish I had the time to take on more than the small fixes I've been making so far
[00:42:32] <cmr> Eridius: an aside: someone tried porting rust to iOS, do you or do you know someone who has the time and knowledge to help with that effort?
[00:42:38] <dbaupp> MaikKlein, bjz_: something like `copy ([a-z_]+)([^a-z_(.])` -> `\1.clone()\2` should help for the ident ones, I guess
[00:42:45] <MaikKlein> bjz_, I am just a text editor newb
[00:42:55] <MaikKlein> dbaupp, I give it a shot
[00:42:56] <Eridius> cmr: I could possibly provide advice, but probably no actual coding help
[00:43:03] <bjz_> MaikKlein: I am a regexp noob :)
[00:43:11] <MaikKlein> bjz_, m2 :D
[00:43:18] <bjz_> MaikKlein: do you use ides mainly?
[00:43:32] <cmr> Eridius: cool!
[00:44:05] <Eridius> working on OSS at all without legal approval isn't really something I'm supposed to be doing, but I do it anyway because nobody cares much as long as what I work on is outside of Apple's areas of interest
[00:44:15] <Eridius> but I think working on "<foo> on iOS" suddenly brings it into Apple's area of interest
[00:44:31] <cmr> ah
[00:45:08] <MaikKlein> bjz_, well sort of. but I am a relatively new programmer. I think I started 2 years ago
[00:45:23] <graydon> Eridius: um, about that: if you're filing patches with us and you have even the _slightest_ reason to believe your company will object, we would very much like you to clarify
[00:45:37] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[00:45:44] <Eridius> graydon: my manager in the past told me "I don't care as long as what you're working on doesn't affect Apple"
[00:45:53] <bjz_> MaikKlein: same :)
[00:47:35] *** Quits: rubber-duck (rubber-duc@moz-70AB535C.dsl.iskon.hr) (Ping timeout)
[00:47:48] *** Joins: rubber-duck (rubber-duc@moz-70AB535C.dsl.iskon.hr)
[00:49:28] <MaikKlein> bjz_, ok yeah we also need derive clone on everything then
[00:50:00] <MaikKlein> dbaupp, haha nice thanks, I really need to learn regex at some point
[00:50:15] <MaikKlein> dbaupp, I always forget the syntax in like 7 days :(
[00:50:38] <cmr> http://rustlog.octayn.net/post/54140959968/status-update, good night
[00:50:54] <MaikKlein> cmr, bb
[00:51:01] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[00:51:12] <MaikKlein> cmr, btw u live in the usa?
[00:51:16] <cmr> yes
[00:51:19] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[00:51:26] <Seldaek> well, I'm not sure what i did, but my little play server is now using 100% cpu pretty quickly since the 0.7 migration
[00:51:35] <Seldaek> I almost had to hard reset my machine 
[00:51:49] <Seldaek> took me 5min to switch tabs and kill the process..
[00:52:05] <MaikKlein> cmr, haha my sleep cycle is so broken that I go at the same time to bed as you and we have a time differnce of like 8-10 hours
[00:52:07] <cmr> Seldaek: you're in a linux vm yeah? https://perf.wiki.kernel.org/, very good tool if you don't know it already
[00:52:16] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Ping timeout)
[00:52:27] <cmr> MaikKlein: heh. I go to bed early (usually aim for 2000) and wake up at like 430
[00:52:34] <MaikKlein> lol
[00:52:50] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[00:52:58] <Seldaek> cmr: yeah I might give this a shot, this is really weird
[00:53:12] <MaikKlein> I always go to bed like at 4  am and aim for 1pm 
[00:53:13] <MaikKlein> :D
[00:53:39] <MaikKlein> cmr, wait until you go to university! :p
[00:53:51] <Seldaek> ah man, when US folks go to bed it clearly is time for me to go as well
[00:54:37] <sully> graydon: ok, I finally have the pull request ready: https://github.com/mozilla/rust/pull/7471
[00:55:19] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:56:20] <sully> graydon: it's 6 PM on Friday, though, and this can easily wait until next week
[00:56:28] <sully> I just wanted to get it pushed
[00:56:45] <MaikKlein> do you have no word in english to express sth like tomorrow +1  day?
[00:56:48] *** Quits: RMF (RMF@moz-9DB2BEB.dsl.telepac.pt) (Ping timeout)
[00:57:09] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[00:57:19] <dbaupp> MaikKlein: "day after tomorrow", I guess
[00:57:21] <sully> "the day after tomorrow" is the best we have
[00:57:27] <strcat> sully: yay, the fix FromIterator needs ;)
[00:57:47] *** Joins: RMF (RMF@moz-9DB2BEB.dsl.telepac.pt)
[00:57:53] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[00:58:00] <sully> strcat: there is another more subtle bug you are probably going to run into soon
[00:58:06] <strcat> heh
[00:58:24] <strcat> sully: another region one?
[00:58:28] <sully> it is probably an hour of work for me to fix and test
[00:58:51] <sully> but I am heading out approximately now
[00:58:58] <sully> no, it isn't region related
[00:59:01] <sully> it is so bad
[00:59:22] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[00:59:26] <sully> make_mono_id doesn't take self types into account
[01:00:00] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[01:00:00] *** ChanServ sets mode: +o brson
[01:00:13] <sully> so under certain circumstances it will decide that two invocations of a method at different self types
[01:00:17] <sully> (but using the same impl)
[01:00:23] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[01:00:24] <sully> are the same
[01:01:06] <dbaupp> graydon: is the p=1 meant to go on the PR or the commit? https://github.com/mozilla/rust/pull/7468
[01:01:06] <graydon> sully: reviewing
[01:01:13] <graydon> the commit
[01:01:36] <graydon> oops
[01:01:38] <graydon> fixed
[01:02:21] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[01:02:21] <ghrust> 01[13rust01] 15brson merged 06master into 06dist-snap: 02http://git.io/hgfQEQ
[01:02:21] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[01:02:27] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[01:02:32] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[01:02:44] <Seldaek> ok so the uint::max_value might be biting me in the ass and turn into an "endless" loop
[01:02:59] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[01:04:21] <graydon> sully: why did you remove the impl id from fcx?
[01:04:32] *** Quits: zargony (zargony@moz-FA1DD09E.versanet.de) (Input/output error)
[01:04:50] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[01:05:04] <graydon> sully: and .. why was type_param_defs unused? I don't know what it did but it sure sounds important
[01:05:09] <sully> graydon: because after I had changed how self methods were resolved, it was used for zero things
[01:05:23] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Ping timeout)
[01:06:14] <sully> graydon: well, I'm not really sure why type_param_defs was there at all
[01:06:25] <graydon> sully: ok
[01:06:36] <sully> graydon: I think it can be easily looked up from what method you are compiling? I don't know if it comes up much in trans
[01:07:05] <sully> graydon: in any case, it definitely isn't part of the substitution information that param_substs is supposed to have
[01:07:18] <dbaupp> hmm, it seems std/unicode.rs has been edited without changing etc/unicode.py
[01:07:23] <sully> rustc data structures tend to accumulate cruft
[01:07:25] <graydon> ok. that much is .. over my head. sorry.
[01:07:27] <graydon> there's a comment in trans_fn_with_vtbls that includes extreme self-recrimination along with "ThisÂ willÂ beÂ fixedÂ inÂ theÂ nextÂ commit.". it's not clear to me that it gets fixed elsewhere, much less the next commit.
[01:07:33] <graydon> dbaupp: slightly, yes
[01:07:47] * dbaupp updates unicode.py
[01:07:53] <sully> oh, it gets fixed 3 commits later
[01:07:56] <graydon> dbaupp: or extensively? I might have just twiddled something to make-it-compile without a rerun
[01:08:05] <sully> I can reorder the commits to make that not a lie
[01:08:07] <graydon> sully: ah I see
[01:08:09] <graydon> no it's fine
[01:08:11] <graydon> missed it
[01:08:19] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[01:08:26] <graydon> in all honesty I don't understand what most of this code is doing
[01:08:29] <sully> well, I would prefer not to be lying in my comment, though
[01:08:39] <kini> I can't seem to build master right now, is anyone else having the same problem? src/librustc/rustc.rs:29:0: 29:18 error: multiple matching crates for `syntax`
[01:08:46] <dbaupp> graydon: well, it still has `const foo: &[(char, char)]` instead of `static foo: &'static [(char, char)]` and a few minor other things
[01:09:00] <graydon> so I'm looking for stylistic scary stuff, not .. so much correctness. I'm assuming "passes all tests + new tests" and "nothing scary-looking with a + marker in the diff" means "ok"
[01:09:02] <dbaupp> kini: run `make clean` to remove the old versions of the crates
[01:09:13] <graydon> which is possibly a bit too light a standard for review, but the best i can do in areas of code like this
[01:09:14] <kini> ah, thanks
[01:09:20] <sully> graydon: yeah, vtable and subst handling for default methods is shockingly tricky
[01:09:46] <graydon> anything you could do while in there to enforce self-consistency by adding abstractions would be welcome
[01:09:47] *** Quits: pcwalton (pcwalton@2557E599.66715431.D25A875A.IP) (Quit: pcwalton)
[01:10:01] <graydon> a la Datum, Type and such. they seem to have helped. I think.
[01:10:05] * sully nod
[01:10:09] <shachaf> Is there a shorter way of saying println(fmt!("%?", x)); ?
[01:10:26] <sully> I think that the vtable deflattening helped that a bit, probably
[01:10:50] <sully> and nmatsakis and I have discussed changing how substs are represented
[01:11:04] <dbaupp> shachaf: not really
[01:11:09] <sully> ok, I am going to do a quick rebase to reorder the commits, and then push again
[01:11:14] <dbaupp> shachaf: (not yet, anyway)
[01:11:31] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[01:11:54] <shachaf> dbaupp: Hm, OK.
[01:12:05] <graydon> sully: it seems to me that typeck::vtable_self is the major new innovation in this set, yes?
[01:12:23] <graydon> which is .. a bit of a "defer resolving further until you know what self is in a concrete instance" trick?
[01:12:36] <sully> graydon: that and the vtable_res changes
[01:12:55] <graydon> sigh. the whole system of calling all these concepts "vtable_foo" is wrong
[01:13:19] <sully> graydon: it is saying that the resolution is the "current impl", which we will know when we are actually compiling the default method
[01:13:38] <graydon> it dates back to when we were blurring static and dynamic dispatch more than we do now, when marijn first introduced the "typeclass name as a type" trick.
[01:13:51] <graydon> I think it probably does more harm than good, since in many cases it has _nothing_ to do with vtables
[01:14:00] <graydon> (in the C++ table of function pointers sense)
[01:14:06] <sully> yeah.
[01:14:11] <sully> we /sometimes/ generate vtables
[01:14:12] <sully> but
[01:14:30] <graydon> I'd be happy to see it renamed / reworked systematically to represent terms that are closer to the reality we're trying to compile
[01:14:31] <sully> hm, doing a new push to my branch should automatically update the pull request, shouldn't it?
[01:14:35] <graydon> yes
[01:14:46] <sully> it doesn't seem to have...
[01:14:58] <sully> hm.
[01:15:06] <Eridius> you sure you pushed to the right thing?
[01:15:22] <graydon> looks like it updated to me
[01:15:22] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[01:15:30] <graydon> 9340fd5ce0d7bd0f1bbfbda73944920bcc1364eb is the new head, yes?
[01:15:57] <sully> oh, huh
[01:16:11] <sully> yeah
[01:16:18] <graydon> github is all on the flashy push-auto-refresh stuff in web UI
[01:16:23] <graydon> I don't even know how that stuff works anymore
[01:16:24] <sully> but the order they are sorted in hasn't changed
[01:16:33] <graydon> things randomly change in your browser while you're looking at 'em
[01:16:36] <graydon> "web pages" ha
[01:16:40] <graydon> "web display media"
[01:16:49] <graydon> they're sorted in timestamp order
[01:16:53] <sully> yeah
[01:16:59] <graydon> tell me which one is the actual HEAD of your repo
[01:17:03] <graydon> it's the one I have to r+
[01:17:11] <sully>  9340fd5 
[01:18:32] <strcat> graydon: bblum actually reported that issue and apparently they intend to mess up the commit order
[01:18:48] <strcat> their recommendation is basically "don't rebase" :|
[01:18:53] <bblum> yeah
[01:19:02] <bblum> i responded to their response being like "no, please, look"
[01:19:05] <Eridius> strcat: they don't intentionally mess it up. the problem is they sort commits in ruby, instead of using git directly
[01:19:11] <graydon> they have amazing responses to bug reports sometimes
[01:19:12] <Eridius> and they've lost the topological information at that point
[01:19:18] <strcat> Eridius: but why do they sort them?
[01:19:29] <Eridius> they apparently have wanted to fix this for a while internally, but it'll involve a non-trivial rearchitecting of some stuff to do so
[01:19:34] <Eridius> and it hasn't been a large-enough pain point to make it worthwhile
[01:19:35] <strcat> I'm sure they're using libgit2, they wrote most of it ;p
[01:19:38] <Eridius> (according to a github engineer)
[01:19:43] <Eridius> strcat: I don't know
[01:19:43] <strcat> s/I'm sure/I hope/
[01:19:50] <Eridius> maybe they're not loading them topologically to begin with?
[01:20:01] <strcat> Eridius: libgit2 walks them topologically though
[01:20:07] <Eridius> I really don't know
[01:20:11] <strcat> you have to do a recursive traversal from the HEAD
[01:20:27] <graydon> but then I watched http://vimeo.com/64716825 and I just love it so much I forgive them everything
[01:20:35] <Eridius> at a random guess, maybe they collect a set of SHA1s at some point, and then go load them from disk at another point, and they lost the topological information ages ago?
[01:21:02] <kini> am I right in thinking that building rust downloads and builds a local copy of llvm? (in the llvm/ directory under the repository root)
[01:21:28] <sully> graydon: any other questions about my PR?
[01:21:35] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[01:21:41] <Eridius> kini: a local copy with modifications, IIRC
[01:21:48] <graydon> sully: no, it's fine, I just have to relocate the tab and type r+ and maybe p=1
[01:21:54] * graydon checks out what else is in the queue
[01:22:17] <sully> awesome, thanks a lot
[01:22:22] <sully> what do the priorities mean?
[01:22:32] <Eridius> bors sorts by priority before sorting by date
[01:22:59] <graydon> it doesn't do date sorting
[01:23:02] <graydon> date sorting is madness
[01:23:09] <graydon> it sorts by PR number!
[01:23:10] <Eridius> sorting by PR # then?
[01:23:11] <Eridius> heh
[01:23:16] <graydon> just does priority before PR
[01:23:16] <Eridius> it should sort by r+ date :P
[01:23:24] <Eridius> (not really, PR # is fine)
[01:23:31] <Eridius> PR# is a proxy for date created
[01:23:33] <graydon> I refuse to touch dates. dates are opaque strings for human amusement.
[01:23:35] <strcat> PR # is great because older ones go in first
[01:23:44] <graydon> they have absolutely worthless semantics to computers
[01:23:46] <graydon> they should be destroyed
[01:23:50] <Eridius> I should totally submit a PR right now with nothing in it, and then force-push to that later when I have something
[01:23:57] <kini> Eridius: I see - what kind of modifications, do you know? Will rust eventually be able to just use the systemwide llvm?
[01:24:01] <Eridius> graydon: time is worthless to computers?
[01:24:05] <Eridius> kini: I have no idea
[01:24:19] <strcat> graydon: don't worry we'll switch to nanoseconds single singularity once bors enslaves us
[01:24:19] <graydon> Eridius: no, _dates_. like "calendar time"
[01:24:25] <strcat> since singularity*
[01:24:45] * strcat still thinks we need to give bors commit access to himself
[01:24:57] <Eridius> graydon: there are plenty of computer-parseable date formats, such as ISO. And a numeric timestamp is still a "date" in anothre format
[01:25:11] <graydon> tai64na labels, maybe
[01:25:33] <graydon> even then, call me when you figure out whether you want to handle leap seconds or not
[01:25:55] <Eridius> graydon: never heard of tai64na before. interesting
[01:26:01] <graydon> what's nice: pointers in finite address spaces, chained cryptographic causality graphs.
[01:26:04] <graydon> what's not nice: time
[01:26:20] <graydon> time is a monstrosity. spacetime is a mess!
[01:26:55] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:26:56] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[01:27:13] <Eridius> graydon: meh just use UT1
[01:27:20] <graydon> I dunno. I mean, ok, sure, if you're jeff dean and you are being paid to get those vector clocks under control and you can afford atomic clocks and GPS receivers and represent time as an uncertainty window off of those, _maybe_
[01:27:22] *** Quits: mib_0mp2bs (Mibbit@moz-D676CF1C.tampfl.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:27:49] <graydon> but I am basically a "use dates and/or timestamps as a last resort" kind of person
[01:28:46] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[01:28:48] <graydon> they have no integrity checks, they are usually wrong by some significant quantity relative to "reality", and even things like 8601 isn't uniformly parsed or produced.
[01:28:55] <graydon> (whatever reality is)
[01:29:47] <graydon> almost nothing does a complete or correct 8601 parser / printer. they almost all do "something mysterious" when fields are missing. which some always are.
[01:29:49] <strcat> graydon: and they had to be cruel and standardized the non-metric second as the SI second ;p
[01:30:47] <graydon> sorry, rant over. it's 6:30 and my shoulder is broken, so I had a beer, which makes me get angry at datestamps :)
[01:31:15] <Thad> beer provides an AMAZING reality for some. :)
[01:31:19] <strcat> graydon: what daring thing were you doing when you broke your shoulder? or was it just a boring fall
[01:31:57] <graydon> I was travelling sideways when propelled from the wall of a trampoline halfpipe, trying to imitate a 5 year old who was clearly _way_ cooler than me
[01:32:05] <graydon> note: 5 year olds are much more robust
[01:33:12] <Thad> yeah, they basically don't have shoulders.
[01:33:47] <Jesse> also they have less momentum to focus on whatever body part they land on
[01:34:11] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:34:52] <Thad> less kinetic energy actually.  momentum is a graduation against other physical forces.
[01:35:16] <Thad> but whose counting... that damn shoulder must have hurt, regardless
[01:36:06] <Jesse> i hope pcwalton doesn't hurt his shoulder trying to yank @ out of rustc
[01:37:06] <graydon> no, he's much more precise than me
[01:38:30] * strcat forgot about https://github.com/mozilla/rust/issues/6736
[01:38:41] <strcat> that'd probably reduce size a lot
[01:38:54] <strcat> lets it use fewer instructions for copies since it will ignore padding
[01:39:12] <strcat> assuming we copy them with memcpy :)
[01:43:28] <graydon> woah. what .. does that do?
[01:44:35] <strcat> graydon: well it serves two purposes, telling it which parts of the struct are fields (rather than padding) + attaching TBAA data
[01:44:59] <Eridius> graydon: sorry, back. is it even legal to omit fields from 8601?
[01:45:04] <strcat> and the memcpy intrinsic will avoid copying padding (if it decides to use individual instructions)
[01:45:21] <strcat> so instead of 4 movs for a struct, we might get 2 or 3
[01:45:30] <strcat> in some cases
[01:46:05] <graydon> Eridius: yeah. lots and lots of different ways. http://en.wikipedia.org/wiki/ISO_8601
[01:46:13] <graydon> Eridius: show me a library that conforms to all that!
[01:46:26] <graydon> strcat: ah, nice
[01:46:53] <nmatsakis> I think somebody ... rather completely broke unsafe checking.
[01:46:56] * nmatsakis wonders if it was him
[01:47:06] <nmatsakis> oh, wait, never mind.
[01:47:12] <nmatsakis> I just had two nested unsafe sections :)
[01:47:26] <nmatsakis> so yes removing the inner one doesn't do anything
[01:47:26] <graydon> rfc3339 is a bit better
[01:47:43] <strcat> or I can just use unix timestamps
[01:47:51] <strcat> don't even need to worry about leap seconds that way! ;p
[01:49:00] <strcat> until you want to convert them
[01:49:06] <strcat> :(
[01:49:19] <graydon> TAI or UTC unix time?
[01:49:25] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[01:49:47] <Seldaek> is it easy to run tests for just std/str.rs for example?
[01:50:05] <Eridius> Seldaek: `rustc std.rs --test --cfg stage2; ./std str::`
[01:50:10] <Eridius> str::tests? maybe
[01:50:10] <strcat> graydon: heh, why are there multiple versions of *any* standard
[01:50:20] <graydon> unix time is UTC offset, ok
[01:50:22] <graydon> well, meh
[01:50:23] <Eridius> relevant XKCD: http://xkcd.com/927/
[01:50:32] <dbaupp> Seldaek: (or, `make check-stage2-str NO_REBUILD=1 TESTNAME=str`)
[01:50:51] <Eridius> ooh didn't know that one
[01:50:55] <Seldaek> thanks 
[01:51:01] <Eridius> dbaupp: is that supposed to be check-stage2-std?
[01:51:10] <dbaupp> Eridius: right
[01:51:19] * strcat didn't know about TESTNAME
[01:51:20] * dbaupp always does that typo
[01:51:22] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:52:57] <strcat> dbaupp: what is TESTNAME supposed to do?
[01:53:14] <Eridius> presumably passes it as an argument to the test binary
[01:53:29] <dbaupp> strcat: in theory TESTNAME=some_filter is the same as `./testbinary some_filter`
[01:53:34] <strcat> ah
[01:53:56] <strcat> new optimization passes are about to land \o/
[01:55:01] <nmatsakis> egads.
[01:55:07] <nmatsakis> I rebased an hour ago and it's already bitrotted.
[01:56:24] <strcat> cmr: if you want something else to benchmark, 'chrt -b 0 make check' vs 'make check' ;p
[01:57:29] * nmatsakis looks at cmr's PR with fear.
[01:58:41] <dbaupp> nmatsakis: don't worry, it'll probably bounce many many times
[01:59:12] <Seldaek> gee trying to work on rust itself makes me want a new laptop with more cpu
[01:59:14] <nmatsakis> dbaupp: I'm fairly certain that one of the other p=1 PRs will conflict with mine :)
[01:59:27] <dbaupp> :(
[01:59:31] * nmatsakis tempted to go for p=2 ;)
[01:59:52] <strcat> hurry bors
[02:00:03] <nmatsakis> but I guess I can wait another night. maybe tomorrow I'll jump the queue. this PR has been a long time coming.
[02:00:18] <strcat> nmatsakis: it looks like it's next anyway
[02:00:40] <nmatsakis> strcat: oh, true, PR number is low enough. 
[02:00:51] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[02:00:53] <nmatsakis> I thought I looked and itwas low in the list, must have been a stale page
[02:01:01] <strcat> but bors decided to take a break
[02:01:17] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[02:01:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/4UbhLw
[02:01:17] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[02:01:18] <nmatsakis> and they says robots never tire
[02:01:25] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Ping timeout)
[02:02:39] <graydon> bors is very patient
[02:02:40] *** Joins: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net)
[02:03:00] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[02:04:19] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[02:04:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HUAy8Q
[02:04:19] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[02:04:21] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[02:04:21] <ghrust> 01[13rust01] 15bors pushed 18 new commits to 06auto: 02http://git.io/SZ5WWA
[02:04:21] <ghrust> 13rust/06auto 14adfa427 15Niko Matsakis: Update existing tests to account for stricter, more correct handling of irrefutable patterns
[02:04:21] <ghrust> 13rust/06auto 1475eba92 15Niko Matsakis: Add new tests for irrefutable patterns used in various tricky ways
[02:04:22] <ghrust> 13rust/06auto 14e928565 15Niko Matsakis: update ptr intrinsics and rewrite vec routines to be more correct....
[02:04:24] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[02:04:51] <Jesse> is there something like unsafe::__builtin_unreachable
[02:05:49] <Eridius> yes
[02:06:01] <Eridius> std::util::unreachable()
[02:06:12] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[02:06:24] <Eridius> rusti: std::util::unreachable()
[02:06:25] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HdfT
[02:06:47] <aatch> Eridius, not strictly true... since that just wraps a fail!() call
[02:07:19] <aatch> Also, release is now?
[02:07:27] <steven_is_false> Hi! What exactly is MutexARC intended to do? I thought it was just an unsafe RWARC which didn't have the kind bounds but it seems as if doesn't have concurrent read capabilities?
[02:07:33] <Eridius> aatch: well what exactly do you want it to do?
[02:07:58] <aatch> Eridius, well technically it could be an intrinsic that just emits and unreachable instruction.
[02:08:02] <Eridius> rusti: fn x() -> int { std::util::unreachable() }; x()
[02:08:03] -rusti- rust: task failed at 'internal error: entered unreachable code', /build/rust-git/src/rust/src/libstd/util.rs:124
[02:08:04] -rusti- rust: domain main @0x1e181b0 root task failed
[02:08:04] -rusti- application terminated with error code 101
[02:08:07] <aatch> However, there is little call for it.
[02:08:20] <Eridius> aatch: ok, and if rust ever learns to do that, util::unreachable() will presumably be updated to behave that way
[02:08:30] <aatch> Since if you're wrong that ^^^ is much better
[02:09:00] <aatch> I have yet to find a good use-case for it, so it hasn't been implemented
[02:10:03] <aatch> steven_is_false, MutexARC is an ARC variable that you can write through. It uses a lock for all access though.
[02:10:25] <aatch> So it easier to use.
[02:11:19] *** Joins: lmandel (lmandel@moz-344B563E.dsl.bell.ca)
[02:11:41] <aatch> And is more performant in low-contention environments.
[02:11:47] <steven_is_false> aatch: Does it not to have the lock for all access behaviour?
[02:12:08] <steven_is_false> aatch: It'd be awesome if I can reuse code with it.
[02:12:15] <aatch> steven_is_false, all access to a MutexARC is protected with a lock.
[02:12:51] *** Quits: lmandel (lmandel@moz-344B563E.dsl.bell.ca) (Quit: lmandel)
[02:13:13] <steven_is_false> aatch: I'm refactoring the arc stuff, and the less work I have to do the better.
[02:13:38] <aatch> steven_is_false, I don't know sorry. You'd have to ask bblum about the code.
[02:13:49] <aatch> I just know the concurrency theory behind it.
[02:13:50] <steven_is_false> aatch: Fair enough. Thanks.
[02:14:06] <aatch> cmr, it only three of us, but we got that PR through!
[02:14:16] <aatch> only took*
[02:14:25] <bblum> steven_is_false: MutexARC and RWARC make opposite choices for two different design features --
[02:14:45] <bblum> mutex (writing is cheaper, but reading is impossible) vs rwarc (read and write are both slightly more expensive)
[02:15:10] <bblum> and Const requirement (safe interface, can't nest) vs no Const (unsafe interface, permits nesting and cycles) 
[02:15:32] <steven_is_false> bblum: It seems bad that the two different ideas are mixed up.
[02:15:37] <bblum> maybe
[02:15:41] <bblum> i decided not to make there be four different types with the other two combinations because i didn't anticipate them to be used
[02:15:51] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:16:10] <bblum> as far as i can tell you would have to have a new type maybe?
[02:16:12] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[02:16:12] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14110a249 to 14e239346: 02http://git.io/N3iJvQ
[02:16:12] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[02:16:13] <steven_is_false> bblum: Aren't people trying to figure out a way to make RWARCs recursive safely?
[02:16:14] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[02:16:14] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/SIbyXQ
[02:16:14] <ghrust> 13rust/06auto 1471d14e5 15Alex Crichton: Change char::escape_{default,unicode} to take callbacks instead of allocating...
[02:16:14] <ghrust> 13rust/06auto 14a48a887 15Alex Crichton: Specialize to_str_common for floats/integers in strconv...
[02:16:15] <ghrust> 13rust/06auto 14aa98a28 15bors: auto merge of #7465 : alexcrichton/rust/issue-4432, r=graydon...
[02:16:17] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[02:16:20] <bblum> actually you might be able to get away with just a new impl for each one
[02:16:36] <bblum> steven_is_false: i don't know about that; i would like to hear about it though
[02:17:07] <steven_is_false> bblum: Okay, I'll guess I'll have to wait on clearing up some of that stuff in the library up until later.
[02:17:19] <bblum> i'll file an issue for new impls for non-const and whatever
[02:17:26] <steven_is_false> okay.
[02:17:30] <strcat> Eridius: the point of __builtin_unreachable is to pass along information to the compiler that it will never reach it
[02:17:41] <strcat> so for example...
[02:17:56] <strcat> if (x > 4) { __builtin_unreachable() } // now it knows x is not more than 4
[02:18:02] <nmatsakis> aatch: https://github.com/mozilla/rust/pull/7455 fixes #7336, btw... though it's already bit-rotted
[02:18:07] <strcat> LLVM understands a few kinds of assertions like that
[02:18:54] <Eridius> strcat: if (x > 4) { someFuncThatDoesn'tReturn() } doesn't also tell LLVM that x can't be > 4 for the rest of the function?
[02:19:16] <bblum> steven_is_false: https://github.com/mozilla/rust/issues/7473
[02:19:26] <steven_is_false> Are Condvars like Java's Conditions in that there may be spurious wakeups? (One has to do do condition.wait() while (conditionIsTrue()); ?
[02:19:56] <steven_is_false> bblum: Okay.
[02:20:45] <bblum> i dunno about java's spurious wakeups, but the pthread condvars saying spurious wakeups are possible is an absolute lie
[02:21:09] <bblum> the reason being, not using "while" around a cond_wait is a recipe for paradise lost race conditions if you are not really really careful
[02:21:14] <bblum> so they just say by spec that you have to
[02:21:28] <aatch> nmatsakis, nice. I was only really interested in it because it initially seemed like a codegen problem.
[02:21:33] <bblum> my condvars do not have spurious wakeups but the need to be careful if you don't use while still applies :P
[02:22:02] <steven_is_false> bblum: Fair enough.
[02:22:50] <bblum> steven_is_false: http://www.cs.cmu.edu/~410/lectures/L12a_Lost.pdfâ€Ž
[02:23:09] <aatch> nmatsakis, though I like that it doesn't allocated a box if there are not captured variables.
[02:23:17] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Ping timeout)
[02:23:25] *** aatch is now known as aatch|bbl
[02:23:40] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[02:24:30] <steven_is_false> The while loops in conditions reminds me of STM. If badness happens things are reset, and checked again.
[02:24:50] <strcat> Eridius: util::unreachable() returns via unwind
[02:24:56] *** Joins: lmandel (lmandel@moz-344B563E.dsl.bell.ca)
[02:25:12] <strcat> Eridius: it will actually insert the x > 4 check
[02:25:13] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[02:25:13] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14aa98a28 to 14e239346: 02http://git.io/N3iJvQ
[02:25:13] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[02:25:15] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[02:25:15] <ghrust> 01[13rust01] 15bors pushed 19 new commits to 06auto: 02http://git.io/X8caMw
[02:25:15] <ghrust> 13rust/06auto 14adfa427 15Niko Matsakis: Update existing tests to account for stricter, more correct handling of irrefutable patterns
[02:25:15] <ghrust> 13rust/06auto 1475eba92 15Niko Matsakis: Add new tests for irrefutable patterns used in various tricky ways
[02:25:15] <ghrust> 13rust/06auto 14e928565 15Niko Matsakis: update ptr intrinsics and rewrite vec routines to be more correct....
[02:25:17] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[02:25:22] <strcat> and the code to throw
[02:25:30] <strcat> so it's the opposite of an optimization
[02:25:43] <Eridius> strcat: meh. it's safer
[02:25:50] <strcat> Eridius: it's not an optimization though
[02:25:54] <Eridius> well no
[02:26:04] <strcat> __builtin_unreachable is a micro-optimization
[02:26:10] <strcat> util::unreachable is just fail!()
[02:26:27] <Eridius> ok
[02:26:35] <Jesse> i think i'd be most likely to use unsafe::__builtin_unreachable in a "_" match arm
[02:26:49] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[02:28:21] <steven_is_false> So unsafe::__builtin_unreachable is basically undef in LLVM?
[02:28:42] *** Quits: lmandel (lmandel@moz-344B563E.dsl.bell.ca) (Quit: lmandel)
[02:29:02] <shachaf> Can you have a "trait object" of multiple traits? As in x: ~(Foo + Bar) or something.
[02:29:04] <strcat> steven_is_false: http://llvm.org/docs/LangRef.html#unreachable-instruction well it's this
[02:29:19] <Ralith> shachaf what are you doing here!
[02:29:22] <steven_is_false> Okay.
[02:29:45] <shachaf> Ralith: I might ask you the same question!
[02:29:52] <shachaf> Rust certainly doesn't have dependent types.
[02:30:08] <Ralith> it does have people targeting LLVM from a functional language, though.
[02:30:17] <Ralith> functional-ish
[02:30:35] <Ralith> there's interest in efficient GC and immutable stuff anyway :P
[02:31:05] <shachaf> Your contribution should be adding rank-2 types to the language.
[02:32:00] <Ralith> :P
[02:33:26] <graydon> um
[02:33:34] <graydon> how do I turn off the color output for an emacs compilation buffer?
[02:33:38] <graydon> it seems to be making emacs very upset
[02:34:29] <dbaupp> Eridius: ^ ?
[02:34:51] <steven_is_false> graydon: Maybe you can fiddle with some of the compilation variables like compilation-error-regexp-alist?
[02:35:10] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Ping timeout)
[02:36:52] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Ping timeout)
[02:37:44] <Eridius> graydon: can you set the TERM to dumb?
[02:37:48] <Eridius> I kinda thought emacs did that by default
[02:37:57] <Eridius> dumb is a terminfo that doesn't really define anything
[02:38:09] *** Joins: z0w0 (zack@moz-730D2B29.lnse3.woo.bigpond.net.au)
[02:38:52] <graydon> https://gist.github.com/graydon/9e450e5103b7548b1fd9 <- this is what the output looks at
[02:39:08] <graydon> *like
[02:39:18] <Eridius> wacky
[02:39:35] *** Joins: lmandel (lmandel@moz-344B563E.dsl.bell.ca)
[02:39:45] <Eridius> graydon: this SO answer says how to enable ANSI coloration for the compilation buffer: http://stackoverflow.com/questions/3072648/cucumbers-ansi-colors-messing-up-emacs-compilation-buffer
[02:39:58] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:40:14] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:40:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146e52076 to 14e239346: 02http://git.io/N3iJvQ
[02:40:14] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:40:17] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:40:17] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rCK8nQ
[02:40:17] <ghrust> 13rust/06auto 144dd2401 15Corey Richardson: Great renaming: propagate throughout the rest of the codebase
[02:40:17] <ghrust> 13rust/06auto 143dcc6a9 15bors: auto merge of #7468 : cmr/rust/great_renaming, r=pcwalton
[02:40:17] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:40:34] <brson> what is the great renaming?
[02:40:39] <Ralith> shachaf: so what's your excuse
[02:41:01] <graydon> Eridius: huh. nope.
[02:41:03] <brson> is it ok to release 0.7 with android broken?
[02:41:06] <engla> it's the core to std brson 
[02:41:36] <graydon> Eridius: it looks more like .. the output is just truncated, or something
[02:41:49] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[02:41:54] <brson> engla: thanks
[02:41:57] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[02:42:09] <graydon> brson: I think we'll need to discuss on tuesday. i'm ok with it but it's not on the "tier 1" list yet; I don't know how others will feel
[02:42:10] <Eridius> graydon: yeah it's like emacs just deletes from the ANSI color code onwards. seems odd
[02:42:17] <Eridius> graydon: what's the TERM used during compilation in emacs?
[02:42:33] <graydon> Eridius: dumb
[02:42:41] <graydon> (just checked)
[02:42:50] <Eridius> graydon: if it's "dumb" then you shouldn't get colors
[02:43:05] <Eridius> num_colors will be 0, so fg() and bg() will do nothing, and "dumb" doesn't define op so reset() will do nothing
[02:43:06] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[02:43:12] <graydon> oh!
[02:43:18] <Thad> Would this be a "cool thing" for someone to hack on against Rust ?  A Chip-8 interpreter ? http://www.multigesture.net/articles/how-to-write-an-emulator-chip-8-interpreter/
[02:43:21] <graydon> it .. actually truncates output on a terminal with 'dumb'
[02:43:45] <graydon> $ TERM=dumb ./x86_64-unknown-linux-gnu/stage2/bin/rustc percentile.rs 
[02:43:46] <graydon> percentile.rs:81:8: 81:18 error: error: 
[02:43:47] <graydon> that's it
[02:44:04] <Eridius> o_O
[02:44:04] <brson> true to its name
[02:44:06] <yichoi> brson: i am not ok 0.7 with android broken
[02:45:12] <brson> yichoi: ok, let's get it fixed soon. are you working on it or do you want me to?
[02:45:52] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[02:45:53] <Thad> Is there a page on the Wiki for those sort of interesting things to flex Rust muscle, where I could post interesting ideas to ... is that kinda page already around ?
[02:46:09] <Eridius> graydon: I see errors with TERM=dumb
[02:46:20] <graydon> Eridius: huh
[02:46:22] <yichoi> brson: when will you release 0.7 ?
[02:46:25] <brson> my current release plan: smoke test 0.7-pre artifacts tomorrow; bump to 0.7 and roll a release candidate sunday, test on monday; tag and release tuesday
[02:46:26] <dbaupp> Eridius: didn't https://github.com/mozilla/rust/pull/7436 fix that?
[02:46:27] <graydon> maybe my workspace is out of date
[02:46:30] <Eridius> graydon: what does your `infocmp dumb` say?
[02:46:46] <Eridius> dbaupp: that fixed the rustc task failure on reset() with TERM=dum
[02:46:48] <Eridius> *TERM=dumb
[02:46:50] *** Joins: busylizzy (lisa@FC306F0C:BF233E95:2EB9049C:IP)
[02:46:58] <brson> yichoi: tuesday
[02:47:01] <Eridius> it wouldn't have just silently truncated
[02:47:10] <Eridius> graydon: sounds like your dumb terminfo might define an op that does something stupid
[02:47:11] <brson> but we need to test the release candidate monday at the latest
[02:47:12] <graydon> https://gist.github.com/graydon/5b7c529cd3e3a44d0903
[02:47:21] <Eridius> nope, no op there
[02:47:25] <graydon> Eridius: ^ but I know zilch about terminfo
[02:47:26] <dbaupp> Eridius: oh. fwiw, someone else had problems with silent truncation with TERM=dumb yesterday/the day before
[02:47:38] <graydon> huh, ok. well, I'll update, maybe it's fixed
[02:47:59] <Eridius> graydon: what rustc version are you using
[02:48:07] <graydon> "something near trunk", sec
[02:48:11] <yichoi> brson: ok. I'll keep digging. if I cannot solve by today, I will ask your help
[02:48:22] <Eridius> dbaupp: the issue with dumb is it tried to call .unwrap() on an Err(~str) value, which would have loudly failed
[02:48:25] <brson> yichoi: great, thanks. sorry for the constant breakage
[02:48:40] <graydon> Eridius: 4c86a04 2013-06-27 12:52:43 -0700
[02:48:41] <Eridius> graydon: what do you get with RUST_LOG=extra::term
[02:49:09] <Eridius> graydon: that's missing my dumb fix
[02:49:16] <Eridius> I'm surprised it's not loudly failing for you
[02:49:24] <Eridius> oooh I bet it loudly failed for me because I can't catch task failure ;)
[02:49:47] <graydon> https://gist.github.com/graydon/e790bb6c5b535d3824cd
[02:49:49] <Eridius> graydon: updating will fix the issue for you
[02:49:54] <graydon> Eridius: if it's missing a fix, I'll update
[02:49:55] <graydon> thanks
[02:49:56] <Eridius> yep, task failed
[02:50:17] <yichoi> brson: no problem.
[02:50:26] <graydon> much appreciated
[02:51:09] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[02:51:33] <shachaf> Ralith: Excuse for what?
[02:52:06] <Ralith> shachaf: being here! I told you mine.
[02:52:59] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[02:53:00] *** Joins: brendan (brendaneic@9EFD4BF3.615B56E6.43362C16.IP)
[02:54:17] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Input/output error)
[02:54:25] *** Joins: kimundi_ (kimundi@moz-32D3BEA7.dip0.t-ipconnect.de)
[02:54:39] *** Quits: kimundi (kimundi@moz-BDA1F045.dip0.t-ipconnect.de) (Ping timeout)
[02:54:40] <shachaf> Ralith: Do I need an excuse?
[02:54:40] *** kimundi_ is now known as kimundi
[02:54:58] <Ralith> shachaf: maybe.
[02:55:14] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[02:55:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143dcc6a9 to 14e239346: 02http://git.io/N3iJvQ
[02:55:14] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[02:55:15] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:55:15] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/tuQ_2g
[02:55:15] <ghrust> 13rust/06auto 14cd17295 15Patrick Walton: librustc: Add a lint mode for unnecessary `copy` and remove a bunch of them.
[02:55:15] <ghrust> 13rust/06auto 140c3af33 15bors: auto merge of #7469 : pcwalton/rust/unnecessary-copy, r=graydon...
[02:55:16] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:55:44] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[02:56:22] *** Joins: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca)
[02:58:13] *** Joins: eatkinson (eatkinson@A01051A9.6F669779.3D1CA460.IP)
[03:01:21] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[03:01:26] <engla> can it be safe to transmute &'static fn to extern fn ?
[03:01:52] <engla> I guess I know by experience that it can be.. better question, is it?
[03:02:10] <dbaupp> Do you have to supply an environment pointer?
[03:02:14] *** Joins: elifrey (peripateti@E1EC911.1221ACDB.1A968954.IP)
[03:02:50] <engla> i don't do that
[03:03:16] <Seldaek> how are the merges handled exactly? someone +r's and then it's in the queue or do you need >1 approvals?
[03:03:29] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[03:03:30] <Eridius> a committer r+'s and bors sees it
[03:03:49] <engla> Seldaek: the buildbot needs to build it and verify the tests pass
[03:04:23] <Seldaek> alright thanks
[03:04:24] *** Quits: lmandel (lmandel@moz-344B563E.dsl.bell.ca) (Quit: lmandel)
[03:04:36] <engla> dbaupp: it should work as long as the &'static fn doesn't need its environment pointer
[03:04:41] <dbaupp> engla: oh... aren't &fn and extern fn different sizes?
[03:04:56] <engla> yeah you throw the env ptr away .. evil
[03:05:10] <engla> let (f, _): (extern fn(A) -> B, *()) = ::std::cast::transmute(f);
[03:05:22] <dbaupp> engla: oh
[03:05:39] <dbaupp> that seems like it might break if `f` captures anything with a 'static lifetime
[03:05:50] <dbaupp> but other than that, it's possibly fine
[03:06:23] <engla> it's just to experiment a bit. &'static fn are not Owned and  extern fn  can't be defined with closure syntax
[03:06:59] <dbaupp> right
[03:07:15] <dbaupp> but you can just throw a fn foo() {} anywhere
[03:07:20] <engla> but there are a lot to closures I don't know. They have trait bounds now
[03:07:31] <engla> yes you can, but it has to have generic parameters and types
[03:07:55] <engla> so it's not a good option for this
[03:08:04] <graydon> what is the replacement idiom for vec::fold(...)?
[03:08:08] *** Joins: roo (jesse.rudo@moz-AA4B9B1E.dynamic.ip.windstream.net)
[03:08:20] <graydon> nm, got it
[03:08:21] <engla> should be vec.iter().fold
[03:10:24] <Eridius> engla: do you particularly need to define extern fn with closure syntax? Or are you just dicking around?
[03:11:02] *** kimundi is now known as zz_kimundi
[03:11:08] <engla> I'm dicking around in the good sense of the expression
[03:11:24] <SiegeLord> Hmm, you can't define two enum constructors of the same name (in different enums)?
[03:11:26] <Thad> How do I tell Configure where my x86_64-w64-mingw32-gcc.exe is located at ??
[03:11:37] *** Quits: roo (jesse.rudo@moz-AA4B9B1E.dynamic.ip.windstream.net) (Ping timeout)
[03:11:46] <engla> Eridius: it's just to experiment basically with the ideas in niko's blogs about closure reform
[03:11:55] <engla> based on naked extern fn
[03:12:23] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[03:12:49] <dbaupp> SiegeLord: yeah (you can do it in different modules, though)
[03:13:42] <engla> Eridius: ~fn() is limited because values moved into the closure can not be mutated
[03:14:15] <Thad> graydon: do you have any idea ?  It would help us to cross compile for x86_64
[03:14:17] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[03:16:05] <graydon> Thad: look at mk/platform.mk 
[03:16:16] <strcat> graydon: btw there are old docs at dl.rust-lang.org and they show up in google searches near the top
[03:16:23] <graydon> :(
[03:16:23] <strcat> should probably delete them
[03:16:26] <Thad> that old rats nest again... ah ok.
[03:16:41] <graydon> Thad: it's much less of a rats nest since the cleanup during android porting
[03:16:48] *** Quits: BitPuffin (quassel@moz-49828767.cust.tele2.se) (Ping timeout)
[03:16:50] <Thad> graydon: cool !
[03:16:57] <graydon> Thad: note all the blocks of target-dependent variables
[03:17:01] <SiegeLord> dbaupp: You can't really use it if you import both modules though...
[03:17:12] <dbaupp> SiegeLord: right
[03:17:14] <SiegeLord> It'd be nice if it inferred, but maybe that's impossible
[03:17:26] <strcat> graydon: and core is still under static.rust-lang.org ;p
[03:17:34] <strcat> http://static.rust-lang.org/doc/core/index.html
[03:17:38] <dbaupp> SiegeLord: (you can use it qualified though)
[03:17:41] <graydon> strcat: can you file both of those and assign to me? I will delete them, but not tonight :(
[03:17:45] <strcat> graydon: yeah
[03:17:48] <graydon> thanks
[03:18:57] <Thad> graydon: I'm approaching the effort using this: http://sourceforge.net/projects/mingwbuilds/
[03:19:11] <brson> graydon: your GC doesn't depend on frame pointers to walk the stack does it?
[03:19:18] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Ping timeout)
[03:19:20] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[03:19:20] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140c3af33 to 14e239346: 02http://git.io/N3iJvQ
[03:19:20] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[03:19:23] <graydon> brson: not presently, but it will / should, imo
[03:19:48] <strcat> I thought x86_64 had some replacement for that
[03:20:12] <brson> it's a shame that we have frame pointer elimination off
[03:20:24] <strcat> dwarf call frame instructions
[03:20:27] <brson> and doesn't arm not use frame pointers?
[03:20:41] <strcat> brson: don't know about that, just that x86_64 usually doesn't
[03:20:52] <brson> maybe we can use libunwind to walk the stack by interpreting dwarf
[03:21:14] <brson> well, I'll open the issue at least
[03:21:26] <strcat> https://bugzilla.mozilla.org/show_bug.cgi?id=464750 heh
[03:22:16] <Thad> DWARF is lacking on x86_64 according to this https://code.google.com/p/mingw-builds/  they recommend SJLJ
[03:22:26] <strcat> https://bugzilla.mozilla.org/show_bug.cgi?id=517829
[03:22:32] <strcat> Thad: on windows
[03:23:00] <strcat> exceptions and gdb on linux definitely use DWARF, gcc defaults to no frame pointers
[03:23:11] <strcat> on x86_64
[03:23:51] <strcat> windows x64 has table based unwinding stuff afaik
[03:24:05] <strcat> just not the dwarf standard
[03:24:21] <Thad> I wonder about dwarf2 ?
[03:24:43] <strcat> brson: we should probably use libunwind instead of the stuff we're currently hardcoding atm anyway
[03:24:58] <strcat> the weird exception ABI stuff in the C++ part of the runtime
[03:25:09] *** Quits: brendan (brendaneic@9EFD4BF3.615B56E6.43362C16.IP) (Quit: brendan)
[03:25:27] <strcat> Thad: well afaik it's dwarf3 now
[03:25:30] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[03:25:38] <Thad> strcat: ha
[03:25:48] <brson> strcat: some of it can't be avoided - we have to have our own personality function at least to change stacks
[03:25:54] *** Quits: H4199 (chatzilla@moz-64E556D3.austin.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 23.0a2/20130617004017])
[03:26:06] <acrichto> r? https://github.com/mozilla/rust/pull/7465
[03:26:09] <brson> also libunwind doesn't work on windows
[03:26:11] <brson> naturally
[03:26:37] <Thad> windows64 or just all windows ?
[03:26:51] <Eridius> brson: I've exchanged some emails with the libc++abi author, who was primarily focused on the visibility of the typeinfo symbols, but that doesn't seem to be the issue
[03:26:59] <dbaupp> Is `tests::package_script_with_default_build` failing for anyone else?
[03:27:02] <Eridius> I don't suppose you have any ideas for what to suggest, or what to tell him?
[03:27:12] <strcat> dbaupp: yes
[03:27:24] <dbaupp> strcat: do you happen to have a solution?
[03:27:28] * strcat thought he did something to make it fail :|
[03:27:51] <dbaupp> (is there a way to skip a step in make check?)
[03:27:55] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[03:28:00] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[03:31:27] <brson> Eridius: i don't have any great ideas. one think to think about is that mac uses it's own 'compact unwind info' (vs. dwarf) and we originally had difficulty making the llvm assembler generate the correct unwind metadata for or unusual __morestack frames. we may no longer be campatible with whatever 10.9 is doing
[03:31:58] <brson> Eridius: would be good to find a reduced test case. Is the problem in C++ or Rust? Can we eliminate __morestack frames from the unwind path, etc?
[03:32:03] *** Quits: graydon (graydon@moz-9918B407.vc.shawcable.net) (Quit: Leaving.)
[03:32:57] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[03:32:59] <Eridius> brson: I wish I understood what exactly rust was doing here. I've never had to care about how exceptions are implemented before, and I don't even know what __morestack is
[03:34:20] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[03:34:51] <Thad> looks like most projects use -march=core2 for x86_64 projects... any objections ?
[03:35:10] <strcat> you can't
[03:35:22] <strcat> won't run on older cpus if you do
[03:35:30] <Thad> buy new
[03:36:40] <strcat> with that logic you should use core-avx2 ;p
[03:36:58] <brson> Eridius: __morestack is a special function for growing the segmented stack (and also lately for ffi) that is called from the rust function prologue. it has a very unusual ABI though
[03:37:05] <brson> Eridius: I have to go drinking just now. sorry
[03:37:07] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Quit: leaving)
[03:37:14] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[03:37:20] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[03:37:29] <vk> Can Rust be run from PowerShell on Windows or only through the MinGW shell?
[03:37:42] <Thad> strcat: for me it's corei7-avx ... anyways... so native then ?
[03:38:12] <strcat> Thad: well -march=native sets the cpu + extensions + cache sizes
[03:38:17] <strcat> for the specific cpu
[03:38:44] <Thad> strcat: so, perhaps some more scripting in the make to do cpu discovery on windowsy systems ?
[03:38:49] <strcat> need to give rustc a march flag
[03:38:55] <strcat> Thad: clang knows how afaik
[03:39:06] <strcat> so it's either in llvm or libclang
[03:39:09] <Thad> k
[03:39:25] <strcat> on linux it just reads /proc/cpuinfo
[03:39:41] <Thad> first things first... I gotta ensure the toolchain actually WORKS on my system for the cross compile effort.
[03:41:00] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Ping timeout)
[03:41:04] <Thad> strcat: does this look ok so far ?  http://pastebin.mozilla.org/2574035
[03:41:19] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[03:41:22] <strcat> Thad: well it can't be set by default
[03:41:38] <Thad> strcat: I know that, you told me.
[03:41:46] <strcat> rustc should respect CFLAGS/CXXFLAGS/LDFLAGS
[03:41:52] <strcat> well, the rust build system *
[03:41:55] *** Joins: roo (jesse.rudo@moz-942EE8CF.dynamic.ip.windstream.net)
[03:42:06] <strcat> Thad: does -march=native work?
[03:42:26] <Thad> dunno... i haven't even tried ANYTHING yet with the new toolchain in place.
[03:42:52] <Thad> just now getting things setup for hacking over this weekend.
[03:43:45] *** Quits: eatkinson (eatkinson@A01051A9.6F669779.3D1CA460.IP) (Ping timeout)
[03:43:52] *** Quits: heftig (heftig@moz-207A74ED.dip0.t-ipconnect.de) (Ping timeout)
[03:44:32] <Thad> hmm... so my x86_64 gcc.exe is found in path just fine.... so how do I configure that during the build of Rust ? (or pass it correctly for configure ?)
[03:45:38] <Thad> oh just CC= ???
[03:47:02] <strcat> doesn't it use it by default?
[03:47:21] <Thad> hmm... no
[03:47:39] *** Joins: eatkinson (eatkinson@A01051A9.6F669779.3D1CA460.IP)
[03:47:51] <Thad> ah, I have cross compiling setup I think.. keeping 32 in default and 64 in the /c/mingw64/bin
[03:48:02] <Thad> they recommended it that way.
[03:50:16] <Thad> which gcc  shows... /mingw/bin/gcc.exe    (that's right for a 32bit app compile)
[03:50:48] <Thad> hmm how to handle the 64bit app compile  ?
[03:51:54] *** Joins: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net)
[03:52:15] <strcat> Eridius: cmr: the terminfo support turned out quite nice :), glad we're doing it properly now
[03:53:36] <Eridius> strcat: so am I. Good think cmr went ahead and wrote the initial terminfo parser, I never would have bothered to get away from emitting hardcoded sequences ;)
[04:01:55] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[04:03:58] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[04:04:25] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:05:42] *** Joins: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net)
[04:09:38] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[04:09:55] *** Quits: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au) (Quit: Leaving)
[04:11:38] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:11:57] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Input/output error)
[04:13:38] *** Parts: elifrey (peripateti@E1EC911.1221ACDB.1A968954.IP) (WeeChat 0.4.0)
[04:16:20] *** Joins: pcwalton (pcwalton@C99F244D.5B209293.746E7A12.IP)
[04:16:20] *** ChanServ sets mode: +o pcwalton
[04:16:23] *** Quits: roo (jesse.rudo@moz-942EE8CF.dynamic.ip.windstream.net) (Ping timeout)
[04:16:25] *** Quits: eatkinson (eatkinson@A01051A9.6F669779.3D1CA460.IP) (Quit: eatkinson)
[04:16:55] *** Joins: roo (jesse.rudo@moz-5BE48B27.dynamic.ip.windstream.net)
[04:17:17] <roo> Thad: as long as /c/mingw64/bin is before /mingw/bin in the path, the 64 bit tools should shadow the 32 bit tools. Just `export PATH=/c/mingw64/bin:$PATH`
[04:17:56] <Thad> roo: yeah... did that.   now I just need help specifying my loca-rust-root
[04:18:11] <Thad> it's under msys/1.0/local/bin
[04:18:33] <Thad> looks like makefile adds the /bin/rustc --version
[04:18:49] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[04:18:58] <Thad> but /local doesn't seem to work.... --local-rust-root=/local
[04:19:55] <roo> try /usr/local, i think msys does some weird path mangling
[04:20:20] <Thad> did not work
[04:20:49] *** Joins: AndroUser (androirc@moz-3E3D9A82.tmodns.net)
[04:21:05] *** AndroUser is now known as my_name
[04:21:22] *** Joins: AndroUser2 (androirc@moz-68D4A82C.cm.sunflower.com)
[04:21:22] *** Quits: my_name (androirc@moz-3E3D9A82.tmodns.net) (Connection reset by peer)
[04:22:11] *** Quits: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP) (Quit: (quit))
[04:22:56] <Thad> export PATH=".:/usr/local/bin:/bin:/mingw/bin:$PATH"
[04:23:14] <Thad> hmm... what the hell does that mean
[04:25:29] <roo> its how mingw sets up its default PATH, based on the windows PATH
[04:25:48] *** Quits: kornholi (kornholi@moz-185F17B0.net) (Ping timeout)
[04:26:21] <Thad> not even this works... /c/MinGW/msys/1.0/local
[04:26:38] *** Joins: kornholi (kornholi@moz-185F17B0.net)
[04:26:48] <Thad> and /bin/ rustc.exe is right under there.
[04:27:53] *** Joins: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca)
[04:28:21] *** aatch|bbl is now known as aatch
[04:28:47] <aatch> yichoi, poing
[04:30:10] <Thad> roo:  gave it the stage1 path and it's working better....  --local-rust-root=i686-pc-mingw32/stage1/bin/rustc/i686-pc-mingw32
[04:30:20] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[04:30:44] <roo> are you also passing in --enable-local-rust
[04:31:06] * roo stabs
[04:31:13] <vk> Argh, I've accidentally reverted a change on the wiki, for https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust, I'm not sure what the proper course of action is now. Halp please ><.
[04:32:17] <Thad> roo:  yes I was... it only worked with that full path to the stage1 under that.
[04:34:21] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[04:36:12] *** Joins: roo_ (jesse.rudo@moz-68893D7F.dynamic.ip.windstream.net)
[04:36:15] <yichoi>  aatch: pong
[04:36:23] *** Quits: roo (jesse.rudo@moz-5BE48B27.dynamic.ip.windstream.net) (Ping timeout)
[04:36:30] <yichoi> aatch: i fixed 
[04:36:35] <aatch> yichoi, you did?
[04:36:49] <roo_> Thad: hmm, maybe what it actually wants is /usr/local/bin/rustc/i686-pc-mingw32/ though I can't imagine why it would matter
[04:37:15] <Thad> roo_: whatever outputs the --version
[04:37:29] <aatch> Ok, then. So I don't have to make the change I'm about to :D
[04:38:11] <Thad> roo_: there's no .exe under that path you mentioned however...
[04:38:11] <yichoi> aatch: can you review it? https://gist.github.com/yichoi/5889765
[04:38:22] <Thad> roo_: only .dll's
[04:38:36] <roo_> yeah ok im no help XD
[04:38:49] <yichoi> other breakage on android :'
[04:39:03] <yichoi> eblm.rs 
[04:39:11] <pnkfelix|rcirc> vk: I'll help, give me a sec
[04:39:14] <yichoi> too many breakage on android 
[04:39:23] <bblum> aatch: ping
[04:39:31] <vk> pnkfelix|rcirc: thanks.
[04:39:45] <aatch> yichoi, hmm, I was going to run the name through back::link::sanitize instead.
[04:39:52] <aatch> bblum, pong
[04:40:24] <yichoi> aatch: if you have better approach, raise your patch
[04:40:24] <pnkfelix|rcirc> vk: The wiki is itself a git repository; do you want me to just revert all of your changes?
[04:40:25] <bblum> aatch: so i wanna add a cmpxchg method to AtomicOption
[04:40:26] <Thad> roo_: any ideas on how to property setup cross compiling ?  I built 32bit rust i686 just fine... now trying to build x86_64-w64-mingw32 version...  http://pastebin.mozilla.org/2574160
[04:40:37] <bblum> aatch: and i was undecided about what the signature should be:
[04:41:04] <vk> pnkfelix|rcirc: pretty much, the first change was accidental, the second was an attempt to revert the first but didn't look like it did anything.
[04:41:24] <bblum> aatch: fn put(&mut self, ~T, Ordering) -> bool  ...or... fn put(&mut self, ~T, Ordering) -> Option<~T> // returns the rejected value if the cmpxchg fails
[04:41:26] <pnkfelix|rcirc> vk: okay, that is easy enough.
[04:41:47] <vk> pnkfelix|rcirc: thank you kindly.
[04:41:51] <dbaupp> yichoi: (for that patch, please use `vtable.as_c_str`, not `str::as_c_str(vtable)`)
[04:42:28] <bblum> aatch: in my use case, the former is more concise, but i felt like somebody might need the latter use case
[04:42:36] <bblum> so, thoughts?
[04:43:08] <pnkfelix|rcirc> vk: actually, it looks to me like you are all good
[04:44:02] <pnkfelix|rcirc> vk: if you checkout the repo git@github.com:mozilla/rust.wiki.git you can compare it yourself against Corey's last version, cca7642ee9fd
[04:44:06] <aatch> bblum, well doesn't cmpxchg need an old value and a new value?
[04:44:22] <bblum> aatch: old value would be 'None' in this case
[04:44:30] <vk> pnkfelix|rcirc: ah, so that's how you get the wiki git, didn't know that.
[04:44:51] *** Joins: elifrey (peripateti@moz-B5928FE2.hsd1.wa.comcast.net)
[04:45:46] <aatch> bblum, oh. In that case the second one. Since taking a ~T moves it in, you might want to keep it if it doesn't work.
[04:46:04] <bblum> yeah that was my thinking
[04:46:19] <bblum> but i also worried that someone might confuse the type signature for just a simple xchg, which gives you what used to be there
[04:46:34] <strcat> aatch: we really need an llvm update
[04:46:43] <aatch> strcat, yes, yes we do.
[04:46:45] * strcat wants the smarter loop vectorize
[04:46:45] <bblum> so maybe it wants a better name than 'put'
[04:46:51] <pnkfelix|rcirc> vk: So you did not mean to add a note about VERBOSE=1 ?
[04:47:17] <aatch> bblum, maybe give? Since it's the partner for take?
[04:47:24] <dbaupp> strcat: what's blocking it?
[04:47:29] <strcat> dbaupp: dunno
[04:47:36] <bblum> aatch: some name that suggests "this might fail"
[04:47:37] <vk> pnkfelix|rcirc: negative. I meant no changes whatsoever, was trying to figure out when a particular change was made.
[04:47:41] <pnkfelix|rcirc> vk: or, wait, sorry, I'm confusing myself.  (Goes back to review again)
[04:48:09] <pnkfelix|rcirc> vk: Ah.  Okay well then having a local git copy + git blame should be good for that
[04:48:23] <aatch> bblum, fill? (So if it's already full, it doesn't work)
[04:48:34] <bblum> fill is decent
[04:48:39] <dbaupp> strcat: seems to be windows https://github.com/mozilla/rust/pull/7115
[04:48:54] <strcat> ofc, it's always windows
[04:49:01] <strcat> that's why we can't have fast ffi
[04:49:04] <strcat> ;[
[04:49:07] <dbaupp> really?
[04:49:17] <strcat> yep that's what blocked it
[04:49:22] *** Quits: roo_ (jesse.rudo@moz-68893D7F.dynamic.ip.windstream.net) (Ping timeout)
[04:49:24] <strcat> and it's still not in
[04:49:46] <dbaupp> Oh, I see
[04:49:54] <dbaupp> you mean niko's #6661?
[04:49:57] <strcat> yes
[04:50:35] <aatch> failed on basiccg?
[04:50:40] <aatch> But... how?
[04:50:45] *** Joins: roo (jesse.rudo@moz-AE180607.dynamic.ip.windstream.net)
[04:50:54] <aatch> basiccg is a requirement for pretty much all of the passes.
[04:51:02] <roo> Thad: i think using the stage1 as the local is tying a knot in the bootstraps. I don't really know enough about the rust build process to say much more than that. It is trying to copy files that dont exist.
[04:51:44] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[04:51:59] <Thad> roo: yeah, it's brson question... he's helped much before...and sort of told me how to get the bootstrap going... we need a wiki page on this cross-compiling setup, so I can remember, and others can step in as well with help.
[04:52:43] <strcat> aatch: there's also a function pass step
[04:52:50] <strcat> we don't explicitly set it up atm
[04:52:55] <strcat> I hope it has sane defaults
[04:53:33] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[04:53:45] <strcat> aatch: clang -03 foo.c -mllvm -debug-pass=Arguments
[04:53:51] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Client exited)
[04:53:57] <strcat> err
[04:54:01] <strcat> aatch: clang -O3 foo.c -mllvm -debug-pass=Arguments
[04:54:03] <strcat> ;p
[04:54:05] <strcat> anyway
[04:54:09] <aatch> strcat, yeah, there's better ways of doing the passes, but this was the easiest way to get it working with a --passes flag
[04:54:15] <strcat> it shows the function pass first, then the module pass (what we set up) and then codegen
[04:55:22] <strcat> dbaupp: the default method fix that makes the size hint actually useful is landing atm \o/
[04:55:31] <dbaupp> strcat: yay!
[04:55:36] <strcat> https://github.com/mozilla/rust/commit/d681bccb6a2141012a747cc272991a7440cb2408#L14L2359
[04:55:45] * dbaupp thinks sully is amazing
[04:55:55] <strcat> yep
[04:56:16] <dbaupp> strcat: 40 files changed, 391 insertions(+), 704 deletions(-) btw
[04:56:17] <yichoi> dbaupp: https://gist.github.com/yichoi/5889821
[04:56:34] <sully> there are still bad bugs in default methods
[04:57:06] <dbaupp> yichoi: that looks nicer (the libraries are moving from functions to methods, so no need to introduce more uses of the functions)
[04:57:07] <strcat> sully: there are bad bugs in every language feature ;p
[04:58:25] <Thad> nite all... try in the morning.
[04:58:32] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Input/output error)
[04:59:14] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:59:14] <ghrust> 01[13rust01] 15thestinger created 06rollup (+2 new commits): 02http://git.io/JFtEbg
[04:59:14] <ghrust> 13rust/06rollup 144af7ebc 15Brian Anderson: Rename #[non_sendable] to #[no_send]
[04:59:14] <ghrust> 13rust/06rollup 1422b7eb3 15Brian Anderson: Rename #[mutable] to #[no_freeze]
[04:59:14] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:01:04] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:01:04] <ghrust> 01[13rust01] 15thestinger pushed 1 new commit to 06rollup: 02http://git.io/gxforw
[05:01:04] <ghrust> 13rust/06rollup 1428a3613 15Daniel Micay: fix zsh completion for lint and debug flags...
[05:01:04] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:01:27] <aatch> Ok, looks like everything will be good to do a new snapshot either tonight or tomorrow.
[05:01:54] <strcat> aatch: I thought brson started one
[05:02:09] <aatch> So he has
[05:02:20] <yichoi> aatch: hope so :_(
[05:02:23] <aatch> Oh, wait no
[05:02:24] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[05:02:41] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[05:02:41] <ghrust> 01[13rust01] 15thestinger pushed 1 new commit to 06rollup: 02http://git.io/FlJRBQ
[05:02:41] <ghrust> 13rust/06rollup 14a0c31ec 15Jordi Boggiano: Remove unused variable
[05:02:41] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[05:03:15] <aatch> yichoi if you send the PR in for that vtable name fix, strcat can roll it up.
[05:03:52] <aatch> strcat, brson started a dist build
[05:04:07] * strcat doesn't know what that means
[05:04:10] <yichoi> aatch: i want to be handled with priority. i am checking and almost done
[05:04:25] *** Quits: pcwalton (pcwalton@C99F244D.5B209293.746E7A12.IP) (Quit: pcwalton)
[05:04:32] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[05:04:34] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:04:34] <ghrust> 01[13rust01] 15thestinger pushed 1 new commit to 06rollup: 02http://git.io/jfJssA
[05:04:34] <ghrust> 13rust/06rollup 14ee7307e 15Kevin Ballard: Smarter warning in extra::term::Terminal.reset()...
[05:04:34] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:05:49] <dbaupp> strcat: I'd guess the dist-snap is the 0.7 release/RC build
[05:06:05] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[05:06:05] <ghrust> 01[13rust01] 15thestinger pushed 1 new commit to 06rollup: 02http://git.io/pyv1qA
[05:06:05] <ghrust> 13rust/06rollup 14b9cf6a3 15blake2-ppc: iterator: UnfoldrIterator::new should have function argument last...
[05:06:05] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[05:06:29] <aatch> yichoi, sure, but it's a two-line change that will almost certainly pass. It doesn't need to go through all by itself. The point of the rollup PRs is that testing time is at a premium at the moment.
[05:07:54] <yichoi> aatch: ebml.rs breakage again :_(
[05:08:17] <aatch> yichoi, oh, if you bundle it with that, then that's fine.
[05:09:17] *** Quits: roo (jesse.rudo@moz-AE180607.dynamic.ip.windstream.net) (Ping timeout)
[05:10:07] <aatch> more default method fixes, on the home stretch!
[05:11:26] *** Joins: pcwalton (pcwalton@C99F244D.5B209293.746E7A12.IP)
[05:11:26] *** ChanServ sets mode: +o pcwalton
[05:13:08] <bstrie> ugh, why have all the prs failed
[05:13:28] <strcat> just the important ones
[05:14:04] <aatch> Hey, default methods are almost through.
[05:14:23] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[05:14:24] <strcat> not yet ;p
[05:14:32] <strcat> something can still go horribly wrong
[05:14:39] <strcat> someone spills coffee on the mac mini
[05:15:00] <aatch> strcat, you shut your mouth! The universe might hear
[05:21:01] <aatch> Hurrah!
[05:21:05] <aatch> it passed!
[05:25:03] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:25:03] <ghrust> 01[13rust01] 15thestinger pushed 2 new commits to 06rollup: 02http://git.io/iTgzcQ
[05:25:03] <ghrust> 13rust/06rollup 1451beba6 15Young-il Choi: libextra: unused import fix for android AGAIN
[05:25:03] <ghrust> 13rust/06rollup 1421cc0cc 15Young-il Choi: librustc: fix #7467 for android
[05:25:04] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:25:12] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:25:12] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rBrzHg
[05:25:12] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[05:25:26] *** Quits: pcwalton (pcwalton@C99F244D.5B209293.746E7A12.IP) (Quit: pcwalton)
[05:25:58] <aatch> Yay!
[05:26:46] *** Quits: rubber-duck (rubber-duc@moz-70AB535C.dsl.iskon.hr) (Quit: Leaving)
[05:28:09] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[05:28:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/a8bGuA
[05:28:09] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[05:28:13] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[05:28:13] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/Dua4AQ
[05:28:13] <ghrust> 13rust/06auto 144e78c1e 15bors: auto merge of #7479 : mozilla/rust/rollup, r=thestinger...
[05:28:13] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:28:54] <strcat> yichoi: ok it's being tested now :)
[05:29:01] <strcat> got in just in time
[05:29:14] <yichoi> strcat: thanks. hope to pass :)
[05:29:49] *** Quits: AndroUser2 (androirc@moz-68D4A82C.cm.sunflower.com) (Quit: AndroIRC - Android IRC Client ( http://www.androirc.com ))
[05:30:12] *** Joins: mib_3oqjax (Mibbit@moz-D676CF1C.tampfl.fios.verizon.net)
[05:30:27] <mib_3oqjax> Anyone online at the moment?
[05:30:43] <dbaupp> mib_3oqjax: nope, no-one here ;P
[05:30:45] <aatch> aye
[05:31:10] <mib_3oqjax> Hey, guys. Real quick - I've been using the .6-4 release that was packaged on Arch for a while and just switched to the master.
[05:31:40] <mib_3oqjax> Most of the port went by just fine, but I can't seem to find a replacement for the good ol' std::test::BenchHarness?
[05:31:53] <dbaupp> std got renamed to extra
[05:31:56] <dbaupp> (and core to std)
[05:32:07] <mib_3oqjax> Yeah, I switched it to extern mod extra and extra::test, no avail.
[05:32:18] <dbaupp> what's the error message?
[05:32:46] <mib_3oqjax> "unresolved import. maybe missing `extern mod extra` followed by `failed to resolve import `extra::test`
[05:33:07] <dbaupp> oh, can you put the code somewhere?
[05:33:17] <mib_3oqjax> Oh, yeah, sure thing. 
[05:33:20] <strcat> mib_3oqjax: there's a daily build for arch linux btw in a repo
[05:33:30] <strcat> [thestinger]
[05:33:32] <strcat> SigLevel = Optional
[05:33:34] <strcat> Server = http://pkgbuild.com/~thestinger/repo/$arch
[05:33:39] <mib_3oqjax> http://mibpaste.com/u4NRTE 
[05:34:05] <mib_3oqjax> Yeah, I'm about to test how  that works on Manjaro on my not-work machine.
[05:34:19] <mib_3oqjax> Hate to have a total breakdown on this one though
[05:35:25] <mib_3oqjax> http://mibpaste.com/kogprM 
[05:35:31] <mib_3oqjax> Sorry, that one includes the offending code.
[05:35:52] <dbaupp> mib_3oqjax: (you're FG_Regulus on reddit?)
[05:35:54] <strcat> rusti: let xs = [1, 2, 3, 9, 11]; xs.iter().skip(1).fold(0, |a, &b| a + b)
[05:35:58] -rusti- 25
[05:36:03] <mib_3oqjax> As a matter of fact, I am.
[05:36:09] <strcat> rusti: let xs = [1, 2, 3, 9, 11]; xs.iter().size_hint()
[05:36:10] -rusti- (Some(5), Some(5))
[05:36:17] <strcat> rusti: let xs = [1, 2, 3, 9, 11]; xs.iter().chain(xs.iter().size_hint()
[05:36:17] -rusti- <anon>:10:4: 10:5 error: incorrect close delimiter: `}`
[05:36:17] -rusti- <anon>:10     };
[05:36:18] -rusti-               ^
[05:36:18] -rusti- application terminated with error code 101
[05:36:22] <strcat> rusti: let xs = [1, 2, 3, 9, 11]; xs.iter().chain_(xs.iter()).size_hint()
[05:36:22] -rusti- (Some(10), Some(10))
[05:36:26] <dbaupp> mib_3oqjax: you need `fn Bench_toBase64(b: &mut test::BenchHarness) {}`
[05:36:45] <strcat> yay default methods
[05:36:53] <dbaupp> mib_3oqjax: (although, with that code, `fn Bench_toBase64(b: &mut extra::test::BenchHarness) {}` should work too)
[05:37:16] <aatch> strcat, woot!
[05:37:30] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[05:37:35] <strcat> rusti: let xs = [1, 2, 3, 9, 11]; xs.iter().take_(2).size_hint()
[05:37:35] -rusti- <anon>:9:36: 10:5 error: internal compiler error: method not found in AST map?!
[05:37:36] -rusti- <anon>:9          let xs = [1, 2, 3, 9, 11]; xs.iter().take_(2).size_hint()
[05:37:36] -rusti- <anon>:10     };
[05:37:36] -rusti- application terminated with error code 101
[05:37:39] <strcat> heh
[05:37:42] <mib_3oqjax> Nope, went for `extra::test::BenchHarness`, `test::BenchHarness` and just `BenchHarness` none of which worked.
[05:38:21] <aatch> strcat, so FromIterator pre-allocates based on size_hint now/
[05:38:24] <aatch> ?*
[05:38:26] <strcat> aatch: yes
[05:38:36] <dbaupp> mib_3oqjax: that's very strange
[05:38:43] <strcat> sully: do you know about them being broken when they're #[inline]'ed?
[05:38:46] * strcat looks for a bug
[05:38:56] <dbaupp> mib_3oqjax: that code works for me (if I remove the toBase64 call)
[05:39:07] <dbaupp> strcat: oh, is that what that error is??
[05:39:11] <aatch> strcat, that sounds like it's a problem with astencode.
[05:39:15] <dbaupp> no wonder I couldn't narrow it down very well
[05:39:23] <strcat> dbaupp: well I assume so
[05:39:29] <strcat> since that's the only reason it would look in there
[05:39:40] <mib_3oqjax> dbaupp: The compiler doesn't even make it to the Base64 definition, though
[05:40:06] <mib_3oqjax> Could have had a problem building the compiler/std
[05:40:16] <aatch> mib_3oqjax, is that the /exact/ code you are using?
[05:40:37] <strcat> https://github.com/mozilla/rust/issues/7481 anyway
[05:40:38] <dbaupp> mib_3oqjax: it does for me, i.e. compiling `extern mod extra; #[bench] fn Bench_toBase64(b: &mut extra::test::BenchHarness) {}` works fine
[05:40:41] <mib_3oqjax> aatch: Without the "std" in the function definition, yes.
[05:40:41] <strcat> yay bugs
[05:40:43] <strcat> :)
[05:40:59] <strcat> it works within the crate
[05:41:36] <dbaupp> mib_3oqjax: what does `rustc --version` say?
[05:41:40] <aatch> strcat, hence why I reckon it's an astencode issue, since functions marked #[inline] are pulled from the crate metadata.
[05:41:48] <strcat> aatch: yep
[05:42:00] <strcat> the important part is that I can use it in libstd for FromIterator
[05:42:02] <mib_3oqjax> dbaupp: 0.7-pre (e239346 2013-06-28 16:49:49 -0700)
[05:42:18] <strcat> but it's going to break if I try to use it for something like extra::deque
[05:42:26] <dbaupp> mib_3oqjax: hm, strange
[05:42:33] <aatch> strcat, baby steps man, baby steps.
[05:42:37] <strcat> but treemap, deque and priority_queue should likely be in libstd
[05:42:51] <strcat> they're owned, Copy/Clone-free containers
[05:42:54] <mib_3oqjax> Knowing myself and my luck, I probably bonkered up building the master.
[05:42:58] <dbaupp> mib_3oqjax: what happens if you copy my snippet of code above into a file by itself and run `rustc --test` on it?
[05:43:09] <dbaupp> mib_3oqjax: (that version looks fine, btw)
[05:43:13] <yichoi> r? #7449
[05:43:35] <dbaupp> mib_3oqjax: if you just ran `make && make install` or something similar, it should work fine
[05:44:39] <sully> strcat: is that a thing?
[05:44:41] <sully> strcat: ugh.
[05:44:43] <mib_3oqjax> dbaupp: Well copy & pasting your code works.
[05:44:56] <strcat> sully: yeah when you mark stuff as inline, the AST is encoded and dumped into metadata
[05:45:02] <strcat> so for cross-crate inlining it uses that AST
[05:45:26] <strcat> no idea why it breaks
[05:45:32] <strcat> wrong mangling? doesn't get encoded? *shrug*
[05:46:04] <dbaupp> mib_3oqjax: ok cool, but the code you pasted above doesn't? (Could you paste the exact code you're compiling, btw? :) )
[05:46:42] <aatch> mib_3oqjax, I know it seems a little odd, but a tiny change can make a significant difference.
[05:47:07] <mib_3oqjax> dbaupp: Give me a couple seconds, I'll be right back with the implementation that's breaking!
[05:48:41] *** Quits: bjz_ (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au) (Quit: Leaving...)
[05:49:42] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[05:49:48] <dbaupp> error: mismatched types: expected `~[(std::option::Option<ast::ident>,@ast::expr,~[@ast::expr])]` but found `std::iterator::MapIterator<,(&(std::option::Option<ast::ident>,@ast::expr),&~[@ast::expr]),(std::option::Option<ast::ident>,@ast::expr,~[@ast::expr]),std::iterator::ZipIterator<&(std::option::Option<ast::ident>,@ast::expr),std::vec::VecIterator<,(std::option::Option<ast::ident>,@ast::expr)>,&~[@ast::expr],std::vec::VecIterat
[05:49:58] <dbaupp> yay?
[05:50:34] <Eridius> nice type
[05:50:45] <aatch> Type inference is a godsend
[05:51:03] <aatch> sully, if it helps, that error happens during privacy checking.
[05:51:38] <mib_3oqjax> http://mibpaste.com/h6DdT3 
[05:51:57] <mib_3oqjax> dbaupp: Well butter my biscuits and call me nancy. I think I found what's going on, actually. 
[05:52:19] <mib_3oqjax> By including "extern mod extra" in my crate file, rather than the base64 module, it works.
[05:52:31] <sully> aatch: ok
[05:52:34] <strcat> dbaupp: yay iterators. ;p
[05:52:36] <sully> aatch: I won't be looking at it until monday
[05:52:59] <aatch> sully, that's ok. Just trying to help :D
[05:53:11] <strcat> dbaupp: that's one of the reasons I hate the dummy type params we need atm so much
[05:53:16] <strcat> they clutter the errors *so much*
[05:53:20] <dbaupp> mib_3oqjax: yup, `extern mod` seems to be a little strange like that (sometimes it works in submodules, sometimes it only works in the crate. I don't know the rules yet.)
[05:53:25] <dbaupp> strcat: yeah :(
[05:53:47] <mib_3oqjax> dbaupp: Well now I know what do for all future breaking! :D
[05:54:18] <mib_3oqjax> dbaupp: Of course, it'd be interesting to know why that is?
[05:54:45] <dbaupp> did you have `extern mod extra` in any other module?
[05:55:51] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[05:55:56] <mib_3oqjax> dbaupp: Nope. This was just some dummy code I wrote to play with Rust, and I was just testing my new rust install, the only code there is the crate with the main, then the module with the base64.
[05:56:06] <mib_3oqjax> (and it's benchmark/test)
[06:01:20] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[06:04:43] <mib_3oqjax> Hm, that's strange. On the .6-4 release, I got 115 ns/op on this benchmark. Now I've gone up to 175 ns/op.
[06:05:35] <aatch> mib_3oqjax, are you optimizing?
[06:05:58] <mib_3oqjax> aatch: `-O` is all I've been using, without it it's 485 ns/op.
[06:06:13] <strcat> mib_3oqjax: what's the benchmark of?
[06:06:16] <aatch> mib_3oqjax, hmm, I have no simple explanation then.
[06:07:31] <mib_3oqjax> http://mibpaste.com/PN6zD5  
[06:08:10] <mib_3oqjax> I apologize for the uncommented horror. It was just part of a quick write-up to play with Rust.
[06:08:34] *** Quits: busylizzy (lisa@FC306F0C:BF233E95:2EB9049C:IP) (Ping timeout)
[06:09:04] <strcat> mib_3oqjax: still slower with RUST_MIN_STACK=5000000 ? might be related to ffi bugs
[06:09:17] <strcat> RUST_MIN_STACK=5000000 ./foo
[06:10:10] <mib_3oqjax> strcat: Haha, even worse actually! 188 ns/iter (+/- 3)
[06:10:45] <mib_3oqjax> (and I mean consistently, I ran it multiple times)
[06:11:07] <dbaupp> strcat:  there's no FFI?
[06:11:27] <strcat> str::from_bytes
[06:12:49] <mib_3oqjax> strcat: I shouldn't be trying to work out these things late at night. Forgive me, but I accidentally buggered up the command
[06:13:08] <mib_3oqjax> Running it PROPERLY the way you asked - 105 ns/iter. Even faster than original.
[06:13:30] <strcat> mib_3oqjax: I think you're likely hitting one of the known bugs in the current ffi implementation
[06:13:39] <strcat> or it's just pain from segmented stack thrashing
[06:14:59] <mib_3oqjax> strcat: Oh? Well then... Any suggestions beyond setting the min stack?
[06:15:16] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[06:15:23] <dbaupp> I see 100ns with `rustc 0.6 (ba05af7 2013-06-20 22:28:52 -0700)` and 153 ns with `0.7-pre (b260c06 2013-06-29 11:41:04 +1000)`
[06:15:24] <strcat> mib_3oqjax: well you can put #[fixed_stack_segment] on main (or maybe the test fn) to ask for a 2MiB stack for now
[06:15:42] <strcat> there isn't really a fix yet
[06:15:45] <strcat> it's a WIP
[06:15:53] <strcat> there's an open PR fixing it a *lot*
[06:16:22] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[06:16:24] <mib_3oqjax> dbaupp: That's exactly what I got. strcat's suggestion made the performance better.
[06:16:24] <strcat> anyway whenever I see a perf problem I suspect segmented stacks and it's often what it is ;p
[06:16:31] <dbaupp> (ah, right, with RUST_MIN_STACK the second made it better)
[06:16:36] <dbaupp> mib_3oqjax: yup
[06:16:46] <dbaupp> *for the
[06:18:13] <mib_3oqjax> strcat: Thanks! I'll keep that in mind as I work, then. 
[06:19:37] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[06:19:43] <strcat> mib_3oqjax: since we want both great single-threaded perf and scaling to a million I/O bound tasks, there's just some pain to get to the point where it works for both ;p
[06:19:56] <strcat> small stacks will hopefully be optional on a per-task basis
[06:20:24] <strcat> so for I/O-bound tasks, you can spawn one with a tiny stack, and for number-crunching you could ask for a big starting segment (like C)
[06:20:54] <strcat> atm due to bugs it doesn't perform great for either ;p
[06:21:05] <strcat> without hacking around it with #[fixed_stack_size] or RUST_MIN_STACK
[06:21:05] <mib_3oqjax> strcat: Yeah, I understand that. Honestly a 50 ns/iter performance hit on FFI calls is absolutely trivial on almost everything, even real-time. 
[06:21:21] <strcat> mib_3oqjax: well that should go away
[06:22:45] <strcat> the cost should just be 1-5% for preventing stack overflows with checks, and 0% for segmented stacks because they should be usable as-needed
[06:23:15] * strcat is sure it will be fixed up soon
[06:23:31] <mib_3oqjax> strcat: Even better! I was just saying while it's not working the optimal way, this cost is something that isn't really worth fussing over! 
[06:24:07] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[06:24:55] <mib_3oqjax> Well thank you everyone for your help tonight, but I'm off to bed! Have a great day.
[06:25:01] *** Quits: mib_3oqjax (Mibbit@moz-D676CF1C.tampfl.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:25:48] <bjz> dbaupp strcat: src/dim_macros.rs:218:16: 219:13 error: failed to find an implementation of trait std::iterator::Iterator<<V36>> for [bool, .. 2]
[06:26:02] <dbaupp> bjz: code?
[06:26:23] <dbaupp> bjz: wait, you need to call .iter()
[06:26:26] <bjz> self.zip(other, |a, b| a.approx_eq_eps(b, epsilon)).all(|&x| x)
[06:26:37] <strcat> rusti: let strcat_is_awesome = [true, ..10]; strcat_is_awesome.iter().all(|&x| x)
[06:26:41] -rusti- true
[06:26:52] <dbaupp> strcat: :/
[06:26:59] <bjz> that works
[06:27:17] <strcat> bjz: you need to get an iterator somewhere
[06:27:25] <strcat> .zip there is returning [bool, ..2]
[06:27:28] <strcat> so it needs a .iter()
[06:27:37] <bjz> no default methods
[06:27:37] <strcat> to get a VecIterator
[06:27:52] <bjz> will default methods fix that?
[06:27:54] <strcat> bjz: yes
[06:28:00] <bjz> ok, cool
[06:28:06] <strcat> [1, 2, 3].fold(0, |a, *b| a + b)
[06:28:07] <strcat> err
[06:28:10] <strcat> [1, 2, 3].fold(0, |a, &b| a + b)
[06:28:20] <strcat> and it will just use the iterator for you
[06:28:46] <strcat> but they aren't really solid enough for that yet.
[06:30:49] <bjz> yeah :(
[06:31:20] *** Parts: jga (asdf@F625A258.D9BC707.B5524284.IP) ()
[06:32:17] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: Don't tell them I was here...)
[06:34:27] <dbaupp> rusti: let v = [1,2,3]; let it = if true { v.iter() } else { v.iter().transform(|&x| x + 1) };
[06:34:28] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/fhWa
[06:35:02] <dbaupp> strcat: there's no way to get around ^ is there? (other than a trait object)
[06:35:24] <strcat> dbaupp: no not yet, there's an open bug
[06:35:48] <strcat> dbaupp: well
[06:35:54] <strcat> I'm not sure that could ever work
[06:36:01] <dbaupp> .collect it is :/
[06:36:06] <strcat> .transform(|&x| x) in the other?
[06:36:24] <strcat> you're also change &int -> int
[06:36:25] <engla> it's the same as the trait problem
[06:36:27] <strcat> changing*
[06:36:29] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[06:36:53] <dbaupp> strcat: well, the situation is `v.zip(w).transform( ... (a,Some(b)))` and `v.transform( ... (a, None))`, so no, not really
[06:37:19] <dbaupp> rusti: let v = [1,2,3]; let it = if true { v.iter() } else { v.iter().transform(|x| x) };
[06:37:20] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/bCHj
[06:37:57] <strcat> dbaupp: you could hoist the code using 'it' into a generic function
[06:38:06] <strcat> and branch into the function instead
[06:38:24] <dbaupp> yes, I'm not keen on that though, just trying to remove vec::map
[06:38:34] <dbaupp> not rewrite a whole swathe of code
[06:41:14] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[06:42:22] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[06:42:59] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[06:45:06] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Connection reset by peer)
[06:46:22] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[06:46:51] *** Joins: Ms2ger (Ms2ger@9D2CFE09.F6F1767D.3773EA9F.IP)
[06:49:08] <dbaupp> strcat: have you filed a bug about .collect not inferring very well?
[06:51:39] <strcat> dbaupp: I think there are issues open for the problems causing it
[06:51:40] *** Joins: berak (chatzilla@2D75AEFC.3A27401E.16E13E53.IP)
[06:52:21] <strcat> my evil plan is obviously to get everyone using this very generic set of traits and find/fix the problems for me ;p
[06:55:02] <dbaupp> heh
[06:57:23] *** Parts: berak (chatzilla@2D75AEFC.3A27401E.16E13E53.IP) ()
[06:57:41] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:01:42] <engla> does niko have a branch for closure reform?
[07:01:50] <yichoi> ah..
[07:03:28] *** Quits: Kroisse (Kroisse@7CF4064D.E3B51CAE.ECA1BB11.IP) (Ping timeout)
[07:03:41] *** Quits: klutzy (th@BA61F396.8E859986.ECA1BB11.IP) (Ping timeout)
[07:04:33] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[07:10:51] *** Joins: Kroisse (Kroisse@7CF4064D.E3B51CAE.ECA1BB11.IP)
[07:11:34] *** Quits: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net) (Client exited)
[07:13:00] *** Joins: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net)
[07:13:06] *** Joins: klutzy (th@BA61F396.8E859986.ECA1BB11.IP)
[07:15:01] <aatch> Yay, default method based AST visitor works!
[07:15:44] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[07:15:48] *** Quits: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[07:16:15] *** Quits: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu) (Ping timeout)
[07:16:51] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[07:16:55] <strcat> aatch: nice
[07:17:08] <strcat> rollup pull about to merge ;]
[07:17:26] <aatch> cool
[07:17:41] *** Quits: rbancroft (rumble@moz-4E8E0D7F.cg.shawcable.net) (Ping timeout)
[07:17:43] *** Joins: rbancroft (rumble@moz-4E8E0D7F.cg.shawcable.net)
[07:17:44] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[07:17:55] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[07:19:07] <yichoi> aatch: android as problem remains 
[07:19:09] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[07:19:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/RWWmRw
[07:19:09] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[07:19:18] *** Quits: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[07:20:05] <yichoi> aatch: compile fine but run-pass fails  utf8_idents.rs  for android
[07:20:08] *** Quits: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[07:20:18] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[07:20:29] *** Joins: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu)
[07:21:35] *** Parts: elifrey (peripateti@moz-B5928FE2.hsd1.wa.comcast.net) (WeeChat 0.4.0)
[07:22:07] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[07:22:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/L8PUlA
[07:22:08] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[07:22:09] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:22:09] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/eLWNmw
[07:22:09] <ghrust> 13rust/06auto 142c7903d 15Ben Blum: Consume once fns when calling them (#2549).
[07:22:09] <ghrust> 13rust/06auto 141496216 15Ben Blum: Permit moving out of captured upvars in once fns. Close #2549.
[07:22:09] <ghrust> 13rust/06auto 14c1f037e 15Ben Blum: Add tests for once functions (#2549).
[07:22:11] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:22:22] <dbaupp> yichoi: what is the error message?
[07:22:41] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[07:23:09] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Quit: Leaving.)
[07:23:13] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[07:23:31] *** Joins: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu)
[07:24:30] <yichoi> dbaupp: https://gist.github.com/yichoi/5890213
[07:25:02] <yichoi> abaupp: android as cannot handle utf8 characters properly
[07:25:32] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[07:26:29] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Connection reset by peer)
[07:26:53] <yichoi> aatch: https://gist.github.com/yichoi/5890213
[07:27:58] <aatch> yichoi, no idea there sorry.
[07:28:32] <aatch> I don't think that would have been cause by my change. It looks like it thinks the first part of the path is 68 chars long.
[07:28:44] <dbaupp> yichoi: you could probably modify `back::link::sanitize` to take an `escape_utf8` parameter, and escape non-ascii characters there
[07:30:16] <yichoi> that's not my expertise but i'll try 
[07:31:03] <Blei> yes, i think utf8 characters should be escaped anyway, even gas has trouble with them
[07:31:22] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:32:27] *** Joins: n00b6502 (kwr5y54@moz-6651F8D4.range86-145.btcentralplus.com)
[07:32:34] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[07:35:17] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[07:35:17] <ghrust> 01[13rust01] 15thestinger 04deleted 06rollup at 1421cc0cc: 02http://git.io/lWCJfw
[07:35:17] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[07:39:27] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[07:41:13] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[07:43:06] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:43:21] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[07:43:37] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:49:47] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[07:52:07] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:52:07] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149f7e410 to 144e78c1e: 02http://git.io/N3iJvQ
[07:52:07] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:52:07] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:52:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/pcSpcw
[07:52:07] <ghrust> 13rust/06auto 143dfbc5a 15Tim Chevalier: rustpkg: Silence extra output from rustpkg tests...
[07:52:07] <ghrust> 13rust/06auto 14a229c98 15bors: auto merge of #7439 : catamorphism/rust/cut-rustpkg-output, r=catamorphism...
[07:52:08] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:54:14] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[07:58:38] <pnkfelix> is the pretty-printer *supposed* to aggressively reorder comments, e.g. pulling them outside for loops?
[07:58:56] <pnkfelix> (even when they occur after statements within the for loop)
[07:59:02] *** Joins: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au)
[07:59:37] <strcat> pnkfelix: no, it's just really bad :)
[08:04:18] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[08:05:35] *** Joins: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz)
[08:05:38] *** Joins: jviereck (Adium@AEB16474:AC8F4797:B552101A:IP)
[08:11:00] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[08:15:37] *** Quits: jviereck (Adium@AEB16474:AC8F4797:B552101A:IP) (Quit: Leaving.)
[08:28:49] *** Quits: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz) (Ping timeout)
[08:35:12] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[08:36:33] <cmr> mornin'
[08:36:39] <aatch> cmr, morning
[08:44:09] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[08:45:48] <aatch> Ok, so I implemented a trait-based AST visitor, replaced one of the old implementations with it, now to see what breaks.
[08:45:53] *** Joins: spider-mario (spidermari@moz-B8FA2FF4.rev.sfr.net)
[08:54:17] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[08:55:32] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[09:05:49] <aatch> Hey, is .clone() impl'd for @/@mut?
[09:06:08] <cmr> yes
[09:07:09] <aatch> Cool, trying to avoid using Copy where I can get away with it.
[09:07:52] *** Joins: mib_k5u90u (Mibbit@moz-C53C7F97.cable.dyn.cableonline.com.mx)
[09:08:14] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[09:10:14] <mark_edward> hey, does anyone know where the source of this issue that filed would be found?
[09:10:17] <mark_edward> https://github.com/mozilla/rust/issues/7464
[09:10:35] <mark_edward> I don't know the structure of rustc code that well, and I'd like to give it a look
[09:10:59] <cmr> That's not a bug I don't think
[09:11:03] <cmr> use `let mut slide = ...`
[09:11:52] <cmr> oh you noted that a mut binding works
[09:12:02] <aatch> bblum, ping
[09:12:22] <cmr> mark_edward: src/librustc/middle/borrowck
[09:12:57] *** Quits: mib_k5u90u (Mibbit@moz-C53C7F97.cable.dyn.cableonline.com.mx) (Quit: http://www.mibbit.com ajax IRC Client)
[09:13:00] <cmr> I'm not sure it's a bug though
[09:13:08] <mark_edward> cmr: but the type of slide is &mut Slide isnt it?
[09:13:15] <aatch> mark_edward, looks like it's having some issues with the method dispatch.
[09:13:28] <mark_edward> so it's a reference to a mutable Slide right?
[09:13:40] <aatch> Trait objects are weird though, because you can't dereference &Trait (or &mut Trait)
[09:14:41] <mark_edward> aatch: right, but it's type is &mut Slide, which is the &mut self type required for the x_mut method?
[09:15:33] <aatch> So I'm pretty sure the issue is that it finds the impl for x_mut() on Bead, then sees it's a mutable borrow, then checks the mutability of the variable.
[09:15:55] <aatch> mark_edward, it is a bug, just not a simple one.
[09:16:16] <cmr> I didn't even know &mut Trait was a thing :p
[09:16:26] *** Parts: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (rust)
[09:16:33] <mark_edward> aatch: so instead of checking the mutability of the variable, it should be checking the mutability of...
[09:16:36] <mark_edward> ?
[09:16:44] <aatch> mark_edward, the type.
[09:16:55] <mark_edward> right!
[09:17:14] <aatch> but remember that &Trait only started working in last week.
[09:17:20] <mark_edward> i see now. wouldn't that require some sort of special casing for such situations?
[09:17:51] <aatch> mark_edward, not really, it's just that trait stuff seems to work off of different paths to everything else.
[09:18:09] <aatch> you also end up with all sorts of weird interactions with bounds and especially lifetimes.
[09:18:33] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[09:18:52] <aatch> because a &Trait isn't a &-ptr
[09:19:01] <mark_edward> i see
[09:19:15] <mark_edward> when is this sort of stuff planned to be fixed? i understand that there's a lot of stuff being done on optimization and better IR, but this is a language feature that is broken.
[09:19:33] <aatch> mark_edward, it's more-or-less being fixed now.
[09:19:42] <mark_edward> how so?
[09:19:43] <cmr> doomlord: are you FG_Regulus?
[09:20:06] <aatch> bblum has been working on trait bounds.
[09:20:30] <aatch> Until fairly recently, ~Traits segfaulted if you looked at them the wrong way
[09:21:02] <mark_edward> do you know his github handle?  I'd love to watch his work, it'd help me see which parts of rustc do what, i think.
[09:21:15] <aatch> by trait bounds, I mean being able to say Trait:Bound1+Bound2 in an argument.
[09:21:18] <cmr> bblum :p
[09:21:19] <mark_edward> and yeah i noticed. I was using @Trait for a while recently
[09:21:21] <aatch> mark_edward, same as here.
[09:21:48] <mark_edward> oh ok. wnould fixing trait bounds also make inheritance work properly?
[09:21:57] <aatch> mark_edward, there's a focus on cleaning up because it's starting to impact our ability to fix features.
[09:22:14] <aatch> mark_edward, I don't think so.
[09:22:30] *** Joins: Earnestly (earnest@2A2BF8F5.321FA5E6.BFD1ABFD.IP)
[09:22:35] <aatch> more that you are able to pass traits to places you couldn't before.
[09:22:49] <aatch> and more importantly, can't pass them places you shouldn't have been able to.
[09:23:42] <mark_edward> ah i see.
[09:23:52] <mark_edward> what sort of work would make inheritance work?
[09:24:13] <aatch> mark_edward, depends on what you mean by inheritance, since it's broken in several places.
[09:25:05] <mark_edward> well my use case was a trait that depended on others (pub trait Monster: ToStr + Move + Position {...})
[09:25:10] <doomlord> cmr - no i am not.
[09:25:18] <doomlord> just curious who/what/why you assumed that
[09:25:26] <cmr> http://www.reddit.com/r/rust/comments/1ha3yi/planning_a_project_in_rust/
[09:25:28] <mark_edward> but callig self.to_str() on a ~Monster object didn't work
[09:25:43] <cmr> It coincided eerily with your comparison to C++
[09:26:04] <doomlord> ok interesting, i figure many people have parallel issues
[09:26:20] <mark_edward> or on a @Monster or &Monster
[09:26:33] <aatch> mark_edward, ah. That _may_ be fixed now.
[09:26:37] <doomlord> my slant is i'm an ex-game dev, looking into indie games and mobile, but generally interested in low-level coding
[09:27:08] <doomlord> heh lol.
[09:27:10] <aatch> I vaguely remember seeing something related going through earlier today.
[09:27:11] <mark_edward> aatch: cool, i'll check. i literally just pulled and compiled rust (5am cron job) so i'll see
[09:27:21] <aatch> mark_edward, no promises though.
[09:27:23] <pnkfelix|rcirc> cmr: https://botbot.me/mozilla/rust/msg/4161960/
[09:27:26] <mark_edward> i know
[09:27:39] <cmr> ah!
[09:27:51] <pnkfelix|rcirc> cmr: that provides the irc nick for FG_Regulus
[09:28:32] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[09:29:11] <mark_edward> aatch: :-( adventure.rc:29:4: 29:16 error: type `~common::Character:Send` does not implement any method in scope named `to_str`
[09:29:11] <mark_edward> adventure.rc:29     sk.to_str();
[09:29:28] <mark_edward> soon...
[09:29:37] <cmr> mark_edward: can you gist your code?
[09:29:47] <doomlord> r.e. *my* thought process:I'm patient waiting for language features- my concern is "whats the smaller niche"
[09:29:57] <cmr> You might need to provide a separate impl for every trait
[09:29:59] <doomlord> ... my own NIH c++ sourcebase, or Rust.
[09:30:34] <mark_edward> cmr: it's a bit complex. there's a git repo for it. i'll push what i have and link you to the relevant files? will that be okay?
[09:30:40] <cmr> mark_edward: yeah
[09:31:49] <cmr> dbaupp: do you know much about http://graphite.wikidot.com/? I'm thinking about standing up an instance and seeing if it'd be useful for tracking perf data
[09:32:24] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[09:33:26] <aatch> mark_edward, :(
[09:34:08] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[09:34:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/pcSpcw
[09:34:08] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[09:37:07] <mark_edward> cmr: the Character trait is foudn here: https://github.com/MarkJr94/rust_adventure/blob/master/common.rs
[09:37:08] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[09:37:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/N6myug
[09:37:08] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[09:37:14] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[09:37:27] <mark_edward> the relevant implementation is here: https://github.com/MarkJr94/rust_adventure/blob/master/monster/skeleton.rs
[09:37:46] <cmr> mark_edward: I don't see a to_str, I see an as_str
[09:38:12] <mark_edward> it inheits to the ToStr trait
[09:38:21] <cmr> Right, but you don't actually implement it.
[09:38:40] <cmr> ToStr doesn't provide a default implementation
[09:39:19] <mark_edward> I do #[deriving(ToStr)]
[09:39:21] <cmr> Oh you have a #[deriving(ToStr)]... hm, I wonder how that interacts with everything else
[09:39:26] <mark_edward> here is the error: https://github.com/MarkJr94/rust_adventure/blob/master/adventure.rc#L28-L30
[09:39:59] <mark_edward> cmr: doesn't rust just insert the necessary could in a regular impl? shouldn't be an issue
[09:40:09] <cmr> mark_edward: I have no idea how deriving works :p
[09:40:50] <mark_edward> if you do rustc --mypackage --pretty typed, you'll see any auto-derived stuff expanded
[09:43:11] <mark_edward> so it seems to happen sometime before typechecking... --pretty normal doesn't show it, but --pretty expanded does
[09:43:36] *** Joins: BitPuffin (quassel@moz-49828767.cust.tele2.se)
[09:44:50] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[09:45:10] *** Quits: Earnestly (earnest@2A2BF8F5.321FA5E6.BFD1ABFD.IP) (Ping timeout)
[09:46:10] <cmr> Seems like inheritance with trait objects is indeed broken
[09:46:37] <cmr> I'm not too sure though
[09:46:41] <cmr> adventure.rc:29:13: 29:26 error: failed to find an implementation of trait ~std::to_str::ToStr:Owned for ~common::Character:Owned
[09:46:43] <cmr> adventure.rc:29     let s = (~sk as ~ToStr).to_str();
[09:46:45] <cmr> for example
[09:46:54] <aatch> cmr, though, the issue blocking the trait based ast visitor has now been fixed!
[09:47:02] <cmr> aatch: how's it working out?
[09:47:03] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[09:47:28] <mark_edward> it will be fixed soon, i think... and to make sure it wasnt the #[deriving()] thing, i tried it using methods from traits that I impled myself
[09:47:34] <aatch> cmr, seems to be ok. I re-implemented the ast map builder with it, but I have to re-implement several other bits first...
[09:47:45] <cmr> mark_edward: I think it wants a ToStr implementation for Character, which... not sure why
[09:47:50] <aatch> I might find a smaller example.
[09:48:59] <cmr> Anyone know what the wierd "bootstrapping" modules in all the crates are? Ie, ` mod std { ... bunch of stuff ... }`?
[09:49:16] <cmr> When I remove them and the extern mod core and #[no_std], everything explodes
[09:49:37] <cmr> https://gist.github.com/cmr/800868cc34ccc6010c29
[09:49:37] <aatch> cmr, some things expand out to reference to std.
[09:49:56] <aatch> but if they're /inside/ std, they don'
[09:50:00] <aatch> t resolve
[09:50:12] <cmr> aatch: That *should* work without #[no_std] in like rustdoc though, right?
[09:50:57] <aatch> cmr, not sure.
[09:51:06] <aatch> in rustdoc?
[09:51:08] <aatch> Sure
[09:51:27] <cmr> The reason it's needed in std is obvious, not so obvious why it's needed elsewhere
[09:51:40] <cmr> https://github.com/cmr/rust/blob/great_renaming/src/librustdoc/rustdoc.rs is what I haev that explodes
[09:52:29] <cmr> maybe it's the use std::*
[09:52:34] <aatch> cmr, possibly.
[09:52:40] <cmr> yup
[09:52:44] <cmr> that's really weird :S
[09:52:55] <aatch> yeah, glob imports break like, everything.
[09:53:19] <cmr> Glob imports are also the reason I can't do half-assed resolve in rustdoc2
[09:53:32] <cmr> Impossible to tell if something is undefined or came from a glob import
[09:53:44] <cmr> (and by "half-assed" resolve I mean "ignore external crates")
[09:54:00] <aatch> cmr, so you're gonna have to use rustc's resolve pass?
[09:54:32] <cmr> aatch: well I planned on doing that anyway, but I wanted to have a "good enough"/best effort mode that could at least work when you don't have all your deps.
[09:54:48] <aatch> cmr, ah right...
[09:55:12] <cmr> Because requiring all your deps just to make docs is kinda gnarly
[09:56:15] <cmr> but it seems the only way that I'm going to be able to do that is either not having links when types/traits etc are referenced or implementing my own resolver that tries its best given limited information (and is bound to be incorrect in countless ways)
[09:58:44] <aatch> cmr, I wonder how easy it would be to add conditions to resolve to allow it to continue when a resolution fails...
[09:59:03] <cmr> aatch: pcwalton said he didn't want to further complicate resolve, and I kinda agree with him
[09:59:10] <cmr> resolve is a rats nest of complexity
[09:59:13] <aatch> cmr, fair enough.
[10:04:35] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Quit: victorporof)
[10:06:14] <aatch> oh dammit. need a snapshot...
[10:07:12] *** Joins: Earnestly (earnest@2A2BF8F5.321FA5E6.BFD1ABFD.IP)
[10:10:12] <aatch> local snapshot it is!
[10:10:15] <cmr> heh
[10:13:42] <aatch> it's a little too late here to start one now, I'll do one tomorrow though. since there are some useful things that have now gone through.
[10:13:54] <aatch> cmr, also, this is the visitor I made: https://github.com/Aatch/rust/blob/new_visitor/src/libsyntax/visit_new.rs
[10:14:07] <cmr> I can do it, is the doc on the wiki up to date?
[10:14:59] <cmr> aatch: default methods work that well now? nice
[10:15:30] <aatch> cmr, not completely up-to-date, but it's pretty close
[10:17:16] <aatch> Also, I suggest waiting until there is a definately-green master.
[10:17:46] <aatch> strcat has a habit of stopping the mac builds because it steals a builder from auto.
[10:18:24] <cmr> in theory master is a struct subset of the tests that happen auto
[10:18:44] <aatch> cmr, in theory.
[10:19:09] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:19:29] <aatch> still, we don't want a broken snapshot, that is just pain.
[10:19:34] <cmr> yeah
[10:20:20] <cmr> aatch: llcx and llmod should be sendable between tasks, right?
[10:20:30] <aatch> cmr, nope.
[10:20:42] <aatch> they probably _are_, but they shouldn't be.
[10:20:48] <aatch> wait, sendable?
[10:20:55] <cmr> Yeah
[10:21:13] <aatch> yes, but rustc stores an llcx in task-local storage.
[10:21:30] <aatch> which is then used in a handful of places.
[10:22:01] <cmr> I want to try and make the change to driver that runs all the passes in a separate task and just pulls out the llcx/llmod, so the task annihilator runs and actually frees the huge amounts of memory that seem to be in cycles
[10:22:30] <cmr> (line 216 driver.rs)
[10:22:42] <cmr> I don't think it will work though
[10:22:45] <cmr> the ast isn't sendable
[10:22:51] <aatch> cmr, hmm, as long as you isolate trans...
[10:23:14] <aatch> oh true...
[10:23:17] <aatch> dammit.
[10:23:27] <aatch> stupid AST.
[10:23:44] <aatch> We really need fix that...
[10:23:54] <cmr> it's not a trivial change :p
[10:24:27] <aatch> cmr, no, it's not.
[10:24:49] <aatch> we should make most things Rc<T>
[10:25:35] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[10:26:21] *** Joins: Zol (Zolomon@moz-CE018D85.members.linode.com)
[10:26:54] *** Zol is now known as zol
[10:29:41] <cmr> I wonder if that could be accomplished by extensive typedefs
[10:32:11] <aatch> cmr, some of it, though we do run into the problem of not being able to impl on typedefs.
[10:34:18] <aatch> Technically, we don't need Rc at all, since we /could/ just use borrowed pointers based on the lifetime of the crate
[10:34:45] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[10:34:57] <aatch> and then it's all owned by the AST
[10:35:56] <cmr> While we're at it we shouldn't be using @str everywhere, we should be interning everything, or storing a simple span (span without expn_info)
[10:37:18] <aatch> cmr, yes. And gold toilets for all!
[10:37:28] <cmr> and ponies!
[10:41:07] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[10:45:51] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[10:46:27] <aatch> cmr, heh, if you do a snapshot, you get to deal with all the breakage from staging!
[10:47:00] *** Quits: timot (timot@moz-1027AC1.cust.telenor.se) (Ping timeout)
[10:51:47] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[10:53:11] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[10:53:36] *** zz_kimundi is now known as kimundi
[10:53:37] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[10:53:49] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[10:55:42] *** Quits: Mowah (Mowah@moz-C7674B3E.cust.bredbandsbolaget.se) (Ping timeout)
[10:59:28] <aatch> yay, random segfault!
[11:00:58] <cmr> rusti: std::int::range
[11:01:05] <cmr> rusti: 5
[11:01:06] -rusti- 5
[11:01:14] <cmr> rusti: std::int::range(6, 9)
[11:01:15] -rusti- <anon>:9:9: 10:5 error: this function takes 3 parameters but 2 parameters were supplied
[11:01:15] -rusti- <anon>:9          std::int::range(6, 9)
[11:01:15] -rusti- <anon>:10     };
[11:01:15] -rusti- error: aborting due to previous error
[11:01:15] -rusti- application terminated with error code 101
[11:01:17] <cmr> ok
[11:01:30] <aatch> huh, I apparently broke drop glue...
[11:05:00] <aatch> nope, forgot to unstage some of rt/
[11:15:07] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[11:17:14] *** Joins: mindginative (mindginati@moz-90AB6445.dyn.cust.vf.net.nz)
[11:17:39] *** mindginative is now known as rix
[11:17:47] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[11:22:12] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[11:22:12] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/lnkG3g
[11:22:12] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[11:22:59] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[11:25:14] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[11:25:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/au2SZQ
[11:25:14] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[11:25:16] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:25:16] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/GnkcGQ
[11:25:16] <ghrust> 13rust/06auto 145784c09 15Ben Blum: Change taskgroup key type to fn:Copy in prep for noncopyable stack closures.
[11:25:16] <ghrust> 13rust/06auto 1475b80ba 15Ben Blum: Use more deriving(IterBytes) in libsyntax.
[11:25:17] <ghrust> 13rust/06auto 1489110fd 15Ben Blum: Use more deriving(IterBytes) in librustc.
[11:25:19] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:27:02] <aatch> cmr, so I went with an easier change and made the entry finder use that visitor trait, seems to have worked fine.
[11:27:12] <aatch> I also managed to kill a @mut usage.
[11:28:47] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[11:32:51] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[11:39:48] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[11:41:49] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[11:43:09] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[11:51:39] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[11:58:55] *** Joins: vosen (vosen@moz-3B059DC4.sta.asta-net.com.pl)
[12:04:14] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[12:07:02] <dbaupp> cmr: never seen/used graphite
[12:07:34] <dbaupp> cmr: it *looks* good... no idea if it functions good too ;P
[12:08:35] *** Joins: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch)
[12:08:39] <aatch> dbaupp, are you and strcat going after at_vec any time soon?
[12:09:43] <dbaupp> aatch: eventually, maybe
[12:09:46] <dbaupp> I guess
[12:09:46] <dbaupp> why?
[12:10:10] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Client exited)
[12:10:22] *** Joins: kyle2000 (kyle2000@moz-AF9EC238.mc.videotron.ca)
[12:10:56] <aatch> dbaupp, just tried to convert a ~[T] to a @[T], kinda expected .to_managed() to work.
[12:11:23] <dbaupp> oh, I see
[12:11:47] *** Quits: kyle2000 (kyle2000@moz-AF9EC238.mc.videotron.ca) (Quit: Leaving)
[12:12:00] <aatch> I then looked in at_vec and despaired at it's sparseness
[12:12:19] <dbaupp> :(
[12:12:45] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[12:13:15] <aatch> dbaupp, meh, it's not that big a deal. I ended up not using it since the change it was for would have required propagating further than I want.
[12:13:20] <dbaupp> aatch: there's at_vec::to_managed[_consume], but I guess you saw that?
[12:13:29] <aatch> dbaupp, yeah.
[12:13:38] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[12:14:05] <aatch> I was hoping the change was a "quick clean up" type-change. Yeah, no.
[12:14:22] <aatch> dbaupp, I'm playing around with this at the moment: https://github.com/Aatch/rust/blob/new_visitor/src/libsyntax/visit_new.rs\
[12:14:23] <dbaupp> :(
[12:14:39] <dbaupp> github appears to be down?
[12:14:52] <aatch> dbaupp, so it is.
[12:14:57] <dbaupp> "We are starting a brief scheduled maintenance window, and will return shortly"
[12:15:15] <aatch> (That page was already open, so I saw no message)
[12:15:41] <aatch> dbaupp, anyway, it's an ast visitor using a trait and default methods.
[12:15:46] <aatch> works perfectly now.
[12:15:57] <aatch> thanks to the godly work of mr sully
[12:17:19] <aatch> And since it's not using heap closures anymore, it should make a lot of things much easier to write.
[12:18:15] <dbaupp> awesome! (and faster too, probably)
[12:18:32] <dbaupp> <3 default methods
[12:18:40] <aatch> dbaupp, yep, because before you couldn't capture borrowed variables in heap closures.
[12:18:57] <dbaupp> right
[12:19:07] <aatch> so you'd end up copying or using @/@mut
[12:19:19] <aatch> and then that infects the rest of your code.
[12:19:19] <dbaupp> (you had some unsafe-transmute-y work around for that, right?)
[12:19:26] <aatch> dbaupp, in a couple locations.
[12:19:47] <dbaupp> yeah, so it's much better all round
[12:19:56] * dbaupp dreams of a day when rustc doesn't have any @ internally
[12:19:59] <aatch> but that's only because it was the last place and fixing required, well, re-writing the AST visitor.
[12:20:27] <aatch> which I have now done, but was somewhat outside of the scope of the work at the time.
[12:21:44] <dbaupp> yeah
[12:21:53] <dbaupp> wasn't pnkfelix(?) working on this too?
[12:22:43] <aatch> dbaupp, I believe so.
[12:24:02] <aatch> there are (now) 29 old visitors in middle, 10 are in lint.
[12:24:38] <dbaupp> that's a lot of visitors
[12:24:57] <dbaupp> (github is back up, btw, looking at the code now)
[12:25:43] <dbaupp> looks pretty good... much better than a huge struct with millions of heap closures at least
[12:26:32] <aatch> dbaupp, yeah the only thing is the visit_*_contents methods.
[12:27:00] <aatch> But I'm not sure how else to deal with it without giving up the control over the visiting oder.
[12:27:02] <aatch> order*
[12:27:50] <dbaupp> oh, those are to make overriding the normal methods not require writing out the whole huge matches to recurse properly?
[12:28:03] <aatch> dbaupp, yep
[12:28:34] *** Joins: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de)
[12:28:40] <aatch> so you can override visit_item, grab what you're interested in, then call visit_item_contents
[12:28:47] <dbaupp> right
[12:29:03] <dbaupp> cmr: was it you who left a pile of unused import warnings in libsyntax? :/
[12:29:26] <aatch> it's not actually much different to what the current pattern is.
[12:29:47] *** Joins: mnemotic (niko@8FFD1BD2.9D81E74C.53DF0002.IP)
[12:29:50] <dbaupp> aatch: I was about to suggest taking &mut self... but then I saw you've already done that, heh
[12:30:12] <aatch> dbaupp, how else are you supposed to update state as you go along?
[12:30:29] <dbaupp> it's currently done by an extra argument, right?
[12:30:42] <aatch> dbaupp, yep, that also passes the visitor around.
[12:32:30] <aatch> Ugh, updating the linter isn't going to be fun.
[12:32:44] <aatch> Not hard, but just... tedious.
[12:33:06] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[12:33:29] <dbaupp> yeah, I've experienced that
[12:33:42] <dbaupp> (once for every function in vec and str :/ )
[12:33:46] *** Quits: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au) (Ping timeout)
[12:33:54] <aatch> dbaupp, also, I have to wait for a snapshot to submit this :S
[12:34:25] <dbaupp> the newest default method fixes are required?
[12:34:42] <aatch> dbaupp, yep
[12:35:08] <dbaupp> cool
[12:35:08] <aatch> before it would lose the impl_id while translating and try to get the type of `self`
[12:35:12] <aatch> which it can't do.
[12:37:20] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[12:38:32] <dbaupp> wow, there are a lot of new warnings in rustc :(
[12:40:12] *** Quits: Earnestly (earnest@2A2BF8F5.321FA5E6.BFD1ABFD.IP) (Ping timeout)
[12:40:18] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[12:42:24] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[12:46:25] <doomlord> what does using 'blobs' look like in rust- binary large objects as one might have used in C .. a datastrucuture in a sequential block of memory with custom pointer-arithmetic to parse/extract -usually **immutable** which makes me think it should be possible to do in a way that isn't completely unpleasant
[12:47:01] <doomlord> a "blob" could be a precompiled object graph ... serialized  file , but still conceptually maps/arrays
[12:47:18] <dbaupp> doomlord: you can use `include_bin!()` to load a file into a &[u8] at compile time
[12:47:39] <aatch> doomlord, well normally you start with a u8 vector, depending on how it's allocated.
[12:47:40] <doomlord> nice, reminds me of .include in asm..
[12:47:54] <aatch> then you can slice into it.
[12:48:02] <doomlord> any examples around ?
[12:48:13] <aatch> doomlord, not as far as I know.
[12:48:25] <aatch> but you can take multiple immutable slices.
[12:48:30] <doomlord> it comes to mind for interacting with C in the type of libraries i would be likely to write
[12:48:32] *** Quits: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net) (Input/output error)
[12:48:35] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[12:48:37] <dbaupp> rusti: let v = include_bin!("/bin/sh"); v.len()
[12:48:39] -rusti- Killed
[12:48:39] -rusti- application terminated with error code 137
[12:48:44] <doomlord> use case - things like collisiion detection mesh datastructures
[12:48:47] <dbaupp> rusti: let v = include_bin!("/bin/true"); v.len()
[12:48:49] -rusti- 27208
[12:49:10] <doomlord> ... and definitely for things coming from 'C'
[12:49:37] <aatch> doomlord, well I'm pretty sure you can construct a slice from a ptr+length
[12:49:56] <aatch> though it's up to you to guarantee the lifetime.
[12:50:18] <aatch> (so you don't have to copy the data.
[12:50:19] <doomlord> i suppose i will lose a lot of rust benefits if doing this a lot .. lifetime checking
[12:50:33] <aatch> doomlord, not necessarily.
[12:51:02] <aatch> its more that rust can no _guarantee_ that the data lives for a certain amount of time.
[12:51:19] <aatch> since it has no idea, but you can tell it easily enough.
[12:51:22] <dbaupp> doomlord: it's not always static data, is it?
[12:51:29] <doomlord> ok. "constructing a slice" sounds promising
[12:51:48] <doomlord> dbaupp - the cases I have in mind are usually immutable data - graphics resources
[12:52:12] <dbaupp> doomlord: I mean known at compile time
[12:52:20] <doomlord> oh, no definitely not
[12:52:25] <doomlord> its data read in from files
[12:53:16] <dbaupp> `vec::raw::buf_as_slice` converts *T, number-of-elements to &[T] btw
[12:53:35] <doomlord> Perhaps there are better ways of conditioning data in C for visibility in rust
[12:54:11] <aatch> dbaupp, though it's contained within a closure, which may be an issue.
[12:54:17] <dbaupp> aatch: right
[12:54:48] <doomlord> do rust enums have a defined binary layout
[12:54:53] <aatch> doomlord, no
[12:55:11] <dbaupp> (by design, it gives potential for optimisation)
[12:55:22] <doomlord> yes i was going to say, what about alignment
[12:55:42] <dbaupp> (e.g. Option<pointer> -> nullable pointer)
[12:55:51] <aatch> doomlord, alignment is the same as C for structs.
[12:56:02] <aatch> but there is a #[packed] attribute
[12:56:35] *** Quits: rix (mindginati@moz-90AB6445.dyn.cust.vf.net.nz) (Quit: brb)
[12:57:08] *** Joins: Earnestly (earnest@2A2BF8F5.321FA5E6.BFD1ABFD.IP)
[12:58:06] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Quit: Leaving)
[12:58:12] *** Joins: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de)
[12:58:32] <MaikKlein> whats the replacement for ? uint::range(0,10)
[12:58:45] <dbaupp> MaikKlein: it still exists
[12:59:08] <dbaupp> aatch, doomlord: (for reference, #[packed] only has an effect on structs.)
[12:59:08] <doomlord> i think i'd find include_bin useful too
[13:00:14] *** Joins: mindginative (mindginati@moz-90AB6445.dyn.cust.vf.net.nz)
[13:00:18] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[13:00:35] <MaikKlein> dbaupp, are u sure? http://static.rust-lang.org/doc/std/int.html
[13:01:13] <dbaupp> MaikKlein: look at the source ;)
[13:01:26] <dbaupp> MaikKlein: (it's yet another instance of rustdoc being bad)
[13:01:34] *** Joins: berak (chatzilla@C7E42EB4.C4D4A1E0.1A5CC7E5.IP)
[13:01:47] <dbaupp> rusti: for std::uint::range(0,2) |i| { println(i.to_str()) }
[13:01:48] -rusti- 0
[13:01:48] -rusti- 1
[13:01:48] -rusti- ()
[13:02:31] <dbaupp> MaikKlein: it's because the main bodies of the integer modules is defined by a macro, and rustdoc doesn't look into macros
[13:02:42] <MaikKlein> ahhh
[13:02:48] <MaikKlein> it used iter.advance on it
[13:02:54] <MaikKlein> i*
[13:03:00] <aatch> cmr's going to fix that. RIGHT CMR?
[13:03:16] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[13:03:41] <dbaupp> cmr: (I think aatch is hinting that you should fix rustdoc. Just in case you missed it.)
[13:03:44] <dbaupp> :P
[13:04:04] <aatch> HINT HINT
[13:04:05] <MaikKlein> bjz, ping
[13:04:46] * aatch is a verbal ninja, so subtle
[13:05:09] <bjz> MaikKlein: oh wow, I literally just walked in the door
[13:05:13] <MaikKlein> bjz, :D
[13:05:16] <MaikKlein> bjz, https://gist.github.com/MaikKlein/5891024
[13:05:21] <MaikKlein> bjz, this is super weird
[13:05:39] <dbaupp> aatch: what did you say? I think I missed it.
[13:05:51] <bjz> MaikKlein: :O
[13:05:58] <bjz> MaikKlein: holy wut
[13:06:47] <mnemotic> I have a l
[13:06:49] <aatch> WAT
[13:06:54] <mnemotic> whoops :S
[13:07:01] <mnemotic> disregard that
[13:07:23] <aatch> _these are not the droids you are looking for_
[13:07:51] <dbaupp> mnemotic: I have a k, swap?
[13:07:59] <mnemotic> deal
[13:08:14] * dbaupp gives mnemotic his k
[13:08:38] <MaikKlein> bjz, I have no idea why this happens, the macro looks fine
[13:08:47] * mnemotic gives up his `l` to dbaupp
[13:08:55] <bjz> MaikKlein: that is so odd
[13:09:33] <bjz> MaikKlein: what happens if you just just copy it multiple times rather than looping?
[13:10:51] *** Joins: igl1 (igl@moz-25A8A85C.adsl.alicedsl.de)
[13:11:14] *** Quits: igl (igl@moz-8FA77247.adsl.alicedsl.de) (Ping timeout)
[13:12:30] <MaikKlein> bjz, this works. 
[13:12:46] <bjz> super strange
[13:13:09] <MaikKlein> bjz, I encountered this problem in my scenegraph, the first node was has a correct matrix and the then every x vector of the identity matrix was 0
[13:13:09] <bjz> wonder if llvm is doing some weird optimisation
[13:13:42] <MaikKlein> oh hm
[13:13:57] <MaikKlein> do we compile lmath with -O?
[13:14:17] <bjz> MaikKlein: no, perhaps we should have a go
[13:14:48] <bjz> MaikKlein: do the other matrices work ok?
[13:16:00] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[13:16:07] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[13:16:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GnkcGQ
[13:16:07] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[13:16:31] <MaikKlein> bjz, let me test
[13:16:56] <MaikKlein> lol
[13:17:05] <MaikKlein> mat3 is working so far
[13:17:16] <MaikKlein> mat2 also
[13:17:49] <MaikKlein> but I inspected the code for mat4 and it looked correct
[13:19:21] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:19:21] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vj6zpw
[13:19:21] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:19:37] *** Parts: berak (chatzilla@C7E42EB4.C4D4A1E0.1A5CC7E5.IP) ()
[13:22:08] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[13:22:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vj6zpw
[13:22:09] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[13:22:10] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[13:22:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/qsmGEA
[13:22:10] <ghrust> 13rust/06auto 1476b910d 15Tim Chevalier: testsuite: Add test cases, some xfailed...
[13:22:10] <ghrust> 13rust/06auto 140326b0a 15bors: auto merge of #7441 : catamorphism/rust/testcases_2013-06-27, r=catamorphism
[13:22:10] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[13:23:01] <doomlord> i dont suppose there's a rust news podcast
[13:23:16] <doomlord> perhaps one could be made with text-to-speech..
[13:23:38] <doomlord> from material on the mailing list
[13:24:11] <dbaupp> doomlord: there's "this week in rust" http://cmr.github.io/blog/categories/this-week-in-rust/
[13:24:12] <MaikKlein> haha
[13:24:28] *** Quits: _1126 (1126@moz-83D60E55.lileth.net) (Quit: Lost terminal)
[13:24:42] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[13:26:19] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[13:27:27] <bjz> MaikKlein: perhaps we should just write everything out as I used to do
[13:27:59] <bjz> MaikKlein: instead of trying to use macros and the weird map and zip stuff
[13:28:03] <dbaupp> bjz: I'd guess that problem is something screwy happening with rustc/LLVM
[13:28:07] <MaikKlein> bjz, yeah i did that
[13:28:34] <bjz> MaikKlein: sorry for trashing the lib :(
[13:28:40] <MaikKlein> bjz, :D
[13:28:49] <dbaupp> bjz: (there is/has been several bugs about structs and floats)
[13:28:55] <bjz> MaikKlein: probably should have done it on a dev branch
[13:28:59] <bjz> dbaupp: oh ok
[13:29:11] <bjz> dbaupp: cool
[13:29:19] <dbaupp> (I've got no idea if they are relevant at all though.)
[13:29:25] <bjz> dbaupp: well, not cool, but at least it is on the radar
[13:30:00] <bjz> MaikKlein: did you see I switched everything over to clone?
[13:30:10] <dbaupp> bjz, MaikKlein: https://github.com/mozilla/rust/issues/7415
[13:30:25] <MaikKlein> bjz, yeah I saw it. does it now compile?
[13:30:36] <bjz> not yet
[13:31:17] <bjz> MaikKlein: I'll try updating my Rust
[13:32:04] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Ping timeout)
[13:34:17] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[13:36:04] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[13:38:33] <aatch> dbaupp, that one has been fixed now, though the fix isn't in master yet.
[13:39:04] <dbaupp> aatch: right, https://github.com/mozilla/rust/pull/7457
[13:39:20] <aatch> dbaupp, correct!
[13:39:35] * aatch sticks a gold start on dbaupp's forehead
[13:39:37] * dbaupp won the pull request lottery
[13:39:39] <aatch> star*
[13:40:03] <dbaupp> aatch: surely you mean #[start], so I can run with a golden runtime
[13:40:48] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[13:42:54] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[13:43:05] <MaikKlein> will servo switch to 0.7 when it is released?
[13:43:43] <aatch> MaikKlein, servo will switch to the latest rust when they get all the code ported.
[13:44:01] <aatch> unfortunately it seems we break servo faster than they can fix it...
[13:44:42] <MaikKlein> :)
[13:44:54] <aatch> As far as I can tell, they've been trying to move to a new version for a while now.
[13:48:04] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[13:48:23] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[13:48:30] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[13:51:19] *** Joins: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP)
[13:54:03] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[13:54:20] <cmr> I think they're almost done porting
[13:54:25] <cmr> most of their deps have been updated
[13:54:30] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[13:54:38] *** Joins: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP)
[13:56:10] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[13:56:10] <cmr> dbaupp: place I interned over the summer used graphite for all their service perf monitoring (latency, uptime, etc), it works pretty well for large-scale stuff. Not sure about small-scale though
[13:56:35] <cmr> aatch: I can only do so much :p
[13:57:13] <cmr> dbaupp: yeah that was probably me :)
[13:57:18] <cmr> (re: unused imports)
[13:57:34] * dbaupp whacks cmr over the head
[13:57:39] <cmr> not positive they're actually unused though, it seems to be fond of marking glob imports as unused
[13:57:42] <dbaupp> :P
[13:58:24] <dbaupp> cmr: (none of them are glob imports ;) )
[13:58:36] <cmr> damn :p
[13:58:54] <cmr> my local renaming branch is marking almost every glob import as unused though
[13:59:50] <dbaupp> re graphite, feel free to experiment :)
[14:00:12] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[14:00:27] <dbaupp> (just looking at it now, I have a feeling it won't be conducive to being able to drill into specific pull requests, but it might be nice for a high-level overview.)
[14:01:51] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[14:01:54] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[14:02:28] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[14:02:49] <zol> How useful is it to know SML if I want to learn Rust? 
[14:03:22] <cmr> zol: well I don't even know what SML looks like and I've had a fine time of it
[14:03:57] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[14:04:00] <zol> cmr: http://4.bp.blogspot.com/-09x0JwtKyCk/USDouYn9GHI/AAAAAAAAAr8/9ZEIRVaD7_M/s1600/WishISawThisForAssignment2.png :)
[14:05:01] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Quit: Leaving)
[14:05:58] <dbaupp> zol: knowing a functional language probably helps understand some design decisions and adapt to the idioms of Rust, but it's not worth/required learning one to learn Rust
[14:06:21] *** Quits: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch) (Connection reset by peer)
[14:06:52] <zol> dbaupp: If I would like to learn the idioms of Rust, where should I look, or can that only come through experience and by reading other Rust code? 
[14:07:00] <cmr> The latter
[14:07:15] <cmr> Rust is so young I don't even know if it /has/ idioms yet
[14:07:54] <zol> I guess that today's idioms will be replaced by tomorrow's as well? 
[14:08:10] <zol> Since Rust is changing so fast? 
[14:08:27] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[14:08:36] <cmr> the language itself has settled down a lot, it's mostly library and finer details that are changing/being completed
[14:08:45] <cmr> but yeah
[14:09:08] <cmr> dbaupp: there, fixed all the warnings, happy? :P
[14:09:08] <zol> library, you mean the standard library? 
[14:09:13] <cmr> yes
[14:09:27] <dbaupp> cmr: yep
[14:09:41] <cmr> dbaupp: dynamic freeze extension is annoying though
[14:09:42] <engla> and some parts of the library are not up to date with current rust idioms (mostly extra)
[14:09:42] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[14:09:50] <dbaupp> cmr: (in general, it's polite to clean up after yourself :P )
[14:09:58] <dbaupp> engla: s/some parts/many parts/
[14:10:10] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[14:10:46] *** Joins: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz)
[14:11:28] <engla> would there be any downside to tack #[deriving(Clone)] onto HashMap?
[14:13:29] <cmr> engla: is hashmap clonable for all <K, V>?
[14:13:44] <cmr> does Clone respect trait bounds?
[14:14:16] <engla> obviously only if K and V are also clonable
[14:16:09] <engla> any simple datastructure with only owning structures inside etc should be easy to clone
[14:16:46] <engla> we are still stuck between Copy and Clone to an extent
[14:19:33] <aatch> zol, the best way to get a good idea is to write something, then ask somebody here to review
[14:19:46] <aatch> we're all pretty willing to lend a hand.
[14:20:41] <cmr> that's not fun, core dump when running the tcp tests :\
[14:20:52] <cmr> all I changed are the imports!
[14:20:54] * cmr reruns
[14:20:57] <zol> aatch: thanks -- I think I'm going to dabble a little more with SML and Racket to get a better at FP in general. 
[14:21:09] *** Joins: yichoi_ (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[14:21:58] <cmr> zol: rust isn't really a FP language though, it just steals some awesome features from them
[14:22:10] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[14:23:28] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[14:24:10] <zol> cmr: Guess it helps knowing those awesome features better then!
[14:24:39] *** Joins: vittorioromeo (quassel@moz-804BA27C.retail.telecomitalia.it)
[14:24:45] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[14:25:33] *** Parts: z0w0 (zack@moz-730D2B29.lnse3.woo.bigpond.net.au) ()
[14:25:56] <aatch> zol, don't get get too hung up on the functional stuff though.
[14:26:24] <MaikKlein> it's also not the usual oop language that you would expect ( java c++ c# etc )
[14:26:42] <aatch> Rust is actually more like C++, since it's more interested in low-level control than elegance.
[14:27:22] * zol nods.
[14:28:00] *** aatch is now known as aatch|bed
[14:28:11] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Client exited)
[14:28:34] <zol> Should I use trunk or .6 if I'm just testing things out? 
[14:28:41] <MaikKlein> master
[14:30:19] <zol> Thanks
[14:33:07] <zol> If I'm on Windows 7, I'll have to compile it manually (with mingw)? There are no installers continuously available for master, right? 
[14:33:28] <dbaupp> zol: yes (you could also wait a few days for 0.7 to be released :) )
[14:33:35] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[14:33:59] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[14:35:29] <dbaupp> https://github.com/mozilla/rust/pull/7487 r?
[14:35:43] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[14:35:50] <mnemotic> how recently was `finalize` renamed to `drop`?
[14:35:50] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[14:36:52] <engla> mnemotic: commit 22408d9, june 25
[14:36:52] <MaikKlein> at least 1 months i guess. it was there when i started with rust
[14:36:59] <MaikKlein> hm
[14:37:11] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[14:37:42] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Ping timeout)
[14:38:46] <MaikKlein> the drop trait is already in the 0.6 tutorial
[14:38:54] <mnemotic> engla: cheers! my git-foo is weak. how did you find that so quickly?
[14:38:56] <MaikKlein> or is it now sth different?
[14:39:07] <mnemotic> MaikKlein: trait yes, I meant the function
[14:39:14] <engla> mnemotic: git log --grep finalize
[14:39:24] <MaikKlein> ah ok
[14:39:47] <dbaupp> MaikKlein: the trait used to be `trait Drop { fn finalize(&self); }`, it's now `trait Drop { fn drop(&self); }`
[14:39:48] <engla> mnemotic: git log --grep  to search commit logs, git grep to search the files in the current checkout.. both very useful
[14:40:22] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[14:40:28] *** Joins: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl)
[14:40:45] <mnemotic> engla: re-cheers! :)
[14:41:02] <zol> Are traits kind of like mixins (or like extension methods in C#, but for classes instead)?
[14:41:10] *** Quits: vosen (vosen@moz-3B059DC4.sta.asta-net.com.pl) (Ping timeout)
[14:41:30] <MaikKlein> think of them like interfaces just with functions and methods
[14:41:32] <MaikKlein> i guess
[14:42:08] <mnemotic> zol: they seem closer to interfaces, or traits if you're coming from C++, I believe
[14:42:27] <engla> more like an interface. Traits need to be implemented per class
[14:42:30] <engla> per tyep
[14:42:41] <engla> sorry.. rust doesn't have class :)
[14:42:59] <MaikKlein> btw
[14:43:01] <zol> engla: tyep = translation unit? 
[14:43:05] <MaikKlein> what are typeclasses in rust?
[14:43:07] <engla> zol: typo. type.
[14:43:10] <MaikKlein> just struct foo?
[14:43:26] <zol> engla: Hah, should've seen that one. Thanks.
[14:43:57] <dbaupp> MaikKlein: type classes in Haskell are traits in Rust
[14:44:59] <MaikKlein> dbaupp, ah ok, I just read type classes several times in the irc and I was confused
[14:45:37] <engla> it's possible to do something like a mixin with traits and default methods I guess
[14:46:39] *** Quits: dbaupp (Thunderbir@moz-EAB436DB.lns20.syd6.internode.on.net) (Ping timeout)
[14:47:27] <engla> Ã¶
[14:48:30] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:50:51] <MaikKlein> btw is int a struct like "struct int"?
[14:51:30] <engla> no
[14:54:56] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[14:56:00] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[14:56:05] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[14:59:41] <engla> here's a question.. Why does this work, it calls .next() from the regular impl. Why is it not a loop?  impl<T> Iterator<T> for Lazy<T> { fn next(&mut self) -> Option<T> { self.next() } }
[15:01:25] <MaikKlein> why do you think it is a loop?
[15:01:36] <MaikKlein> ah 
[15:01:37] <MaikKlein> hm
[15:02:01] <cmr> engla: because an iterator only yields a single item at a time
[15:02:28] <cmr> Oh I see what you're saying
[15:02:44] <cmr> good question!
[15:03:09] <MaikKlein> yeah it definitely looks like a loop
[15:08:01] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[15:09:21] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[15:13:15] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[15:13:16] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qsmGEA
[15:13:16] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[15:14:12] <MaikKlein> does this even work? fn next(&mut self) -> Option<T> { self.next() }
[15:15:07] <MaikKlein> looks like an infinite recursion to me
[15:15:07] <doener> endless recursion?
[15:16:10] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[15:16:10] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vGq11Q
[15:16:10] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[15:16:14] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[15:18:01] <engla> it works
[15:18:08] <doener> ah, it's from engla's example, didn't see that
[15:19:23] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[15:19:23] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vGq11Q
[15:19:23] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[15:19:25] <doener> probably higher priority for type impls than for trait impls
[15:19:25] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[15:19:26] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/mZa6BA
[15:19:26] <ghrust> 13rust/06auto 149591832 15Graydon Hoare: mk: add mechanisms for triggering clean-llvm builds from commits
[15:19:26] <ghrust> 13rust/06auto 148883099 15bors: auto merge of #7442 : graydon/rust/clean-llvm-trigger, r=brson...
[15:19:26] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[15:19:32] <doener> let me dig up the code in the compiler
[15:19:42] <engla> tell me where I could find it
[15:19:51] <engla> if you find it
[15:23:11] <doener> engla:  src/librustc/middle/typeck/check/method.rs -- the doc at the top, specifically the last paragraph in "Candidate collection"
[15:23:35] <engla> thousand thanks
[15:23:57] <doener> you're welcome
[15:25:00] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[15:29:26] <engla> I verified it doesn't loop even if it is wrapped as ~Iterator<T> object.
[15:30:08] <doener> inside next()?
[15:30:44] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[15:30:48] <doener> if you wrap it up outside next() that doesn't matter for next()
[15:30:53] <engla> no when using the type
[15:30:54] <engla> ok
[15:31:19] <doener> the method choice inside next() is made at compile time, so the way next() is called doesn't matter
[15:31:52] <doener> static dispatch :-)
[15:32:01] <engla> ok yeah, I guess it makes sense now
[15:32:17] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[15:32:20] <engla> I was just worried that this piece of code might turn into a loop in when rustc changes
[15:32:29] <engla> sure, anything might still happen, but it seems well-defined
[15:32:55] <doener> yeah, it says "for better or worse". Though I think that example is clearly a case for "better"
[15:33:12] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Ping timeout)
[15:33:13] <doener> (except for being not quite obvious)
[15:41:49] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[15:45:19] *** Quits: jpf (jan@moz-A8C26A15.org) (Quit: leaving)
[15:45:45] *** Joins: jpf (jan@moz-A8C26A15.org)
[15:51:35] *** Quits: victorporof (victorporo@475EFE2D.75AF2AF4.D111398B.IP) (Ping timeout)
[15:53:34] *** Joins: victorporof (victorporo@98A8A9B5.F8731F63.9B1E38F4.IP)
[15:58:28] *** Joins: nano (nano@moz-972880B.superkabel.de)
[16:00:31] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[16:02:13] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[16:04:21] *** Joins: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de)
[16:04:22] <SiegeLord> Is there a way to make a mutable reference expire without wrapping the whole bit in a block?
[16:05:32] <MaikKlein> SiegeLord, well one way is chaining, like https://gist.github.com/MaikKlein/5891674
[16:06:13] <SiegeLord> I guess... that seems more invasive than a block
[16:06:14] *** Joins: illissius (illissius@moz-19397A63.catv.broadband.hu)
[16:06:28] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[16:07:06] <doener> SiegeLord: have an example for which you need that?
[16:09:58] <SiegeLord> doener: http://pastebin.ca/2412111
[16:13:07] <doener> well, that's easily solved by just doing "self.a = 5". I guess your case is a bit more involved?
[16:14:40] <SiegeLord> Sure
[16:15:31] *** Quits: victorporof (victorporo@98A8A9B5.F8731F63.9B1E38F4.IP) (Quit: victorporof)
[16:17:24] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[16:19:20] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[16:22:19] *** Quits: yichoi_ (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[16:26:01] *** Quits: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net) (Ping timeout)
[16:27:20] <MaikKlein> do you think chaining isn't a good idea? https://gist.github.com/MaikKlein/5891674
[16:27:26] *** Joins: Dk (Sohbet@736BC8D4.26C0A60B.C687B15D.IP)
[16:27:51] <MaikKlein> for me it seems a lot simpler then creating an extra variable
[16:28:57] *** Joins: samx (sami@moz-369757A0.pp.htv.fi)
[16:29:34] <SiegeLord> What if there's flow control?
[16:30:19] <MaikKlein> damn spam
[16:30:31] <MaikKlein> did you just get spamed too?
[16:30:38] <cmr> no
[16:30:44] <SiegeLord> I did
[16:30:44] <MaikKlein> hm
[16:32:00] <MaikKlein> rusti went rogue
[16:32:34] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Quit: Leaving)
[16:32:44] *** Joins: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de)
[16:33:58] *** Joins: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net)
[16:34:18] <cmr> rusti: 291-244
[16:34:19] -rusti- 47
[16:34:54] <cmr> rusti: 178531-125184
[16:34:55] -rusti- 53347
[16:36:06] *** Quits: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz) (Ping timeout)
[16:36:18] *** Joins: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr)
[16:38:06] <acrichto> r? https://github.com/mozilla/rust/pull/7342
[16:38:19] <SiegeLord> rusti: enum E { A(int), B(int) } match A(5) { A(x) | B(x) => x }
[16:38:20] -rusti- 5
[16:38:34] <SiegeLord> rusti: enum E { A(int), B(int) } match A(5) { A(x) | B(y) => x }
[16:38:35] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QEON
[16:38:59] *** Quits: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net) (Ping timeout)
[16:39:15] <acrichto> cmr: thanks!
[16:39:17] <cmr> np
[16:40:06] <SiegeLord> rusti: enum E { A } let A = A; let A2 = A; A2
[16:40:07] -rusti- <anon>:9:26: 9:27 error: declaration of `A` shadows an enum variant or unit-like struct in scope
[16:40:07] -rusti- <anon>:9          enum E { A } let A = A; let A2 = A; A2
[16:40:07] -rusti-                                    ^
[16:40:07] -rusti- error: aborting due to previous error
[16:40:07] -rusti- application terminated with error code 101
[16:41:01] <SiegeLord> I wonder if it's a faux pas to have single letter enum constructors...
[16:41:23] *** Joins: Jane-18f (Mozilla@moz-EC8FBC4.hsd1.ma.comcast.net)
[16:41:23] *** Joins: oIivetti (Mozilla@7200B883.A88C706E.4F3E55D3.IP)
[16:41:23] *** Joins: asi_girl (Mozilla@moz-D992FD5A.lightspeed.brhmmi.sbcglobal.net)
[16:41:23] *** Joins: MerwE^^ (Mozilla@moz-2A4E7D07.hsd1.fl.comcast.net)
[16:41:23] *** Joins: Begum__ (Mozilla@moz-D992FD5A.lightspeed.brhmmi.sbcglobal.net)
[16:41:23] *** Joins: [LADy20] (Mozilla@7200B883.A88C706E.4F3E55D3.IP)
[16:41:23] *** Joins: Alexandra20f (Mozilla@moz-969A1692.hsd1.ma.comcast.net)
[16:41:23] *** Joins: TeenHot-17F (Mozilla@moz-23A5F230.hsd1.wv.comcast.net)
[16:41:23] *** sand.mozilla.org sets mode: +R 
[16:41:26] <Jane-18f> HeLLo
[16:41:26] <Begum__> HeLLo
[16:41:26] <asi_girl> HeLLo
[16:41:26] <TeenHot-17F> HeLLo
[16:41:26] <MerwE^^> HeLLo
[16:41:26] <oIivetti> HeLLo
[16:41:26] <[LADy20]> HeLLo
[16:41:26] <Alexandra20f> HeLLo
[16:41:26] <cmr> well generally you want the name to be descriptive
[16:41:27] <TeenHot-17F> HeLLo
[16:41:27] <oIivetti> HeLLo
[16:41:27] *** sand.mozilla.org sets mode: +M 
[16:41:35] <cmr> Blech
[16:41:44] <SiegeLord> Nothing some documentation can't fix
[16:41:50] <SiegeLord> I'll probably avoid it though
[16:42:01] <cmr> *Now* I'm getting spammed
[16:42:03] <cmr> heh
[16:42:21] <SiegeLord> I mean, soon we'll have intellisense that shows documentation after your type an identifier... right cmr ;)
[16:42:32] <SiegeLord> *you type
[16:42:39] <cmr> SiegeLord: Only if someone implements that :p
[16:42:45] <cmr> Anyway counterexample: rustc
[16:42:59] <cmr> tcx, fcx, ccx, cx, cm, edx, etc
[16:43:07] <SiegeLord> Holy cow
[16:43:08] <cmr> (etc isn't a name used in rustc I think)
[16:43:15] <cmr> No amount of documentation can fix that
[16:43:21] <SiegeLord> >640 people just pm'd me >_<
[16:43:24] <cmr> yeap
[16:43:28] <cmr> 694 and rising
[16:43:31] <cmr> 700 that is
[16:44:01] * cmr wanders off
[16:44:01] <SiegeLord> Yay for weechat
[16:45:01] *** Quits: Alexandra20f (Mozilla@moz-969A1692.hsd1.ma.comcast.net) (Ping timeout)
[16:45:01] *** Quits: TeenHot-17F (Mozilla@moz-23A5F230.hsd1.wv.comcast.net) (Ping timeout)
[16:45:01] *** Quits: asi_girl (Mozilla@moz-D992FD5A.lightspeed.brhmmi.sbcglobal.net) (Ping timeout)
[16:45:01] *** Quits: MerwE^^ (Mozilla@moz-2A4E7D07.hsd1.fl.comcast.net) (Ping timeout)
[16:45:01] *** Quits: Begum__ (Mozilla@moz-D992FD5A.lightspeed.brhmmi.sbcglobal.net) (Ping timeout)
[16:46:26] *** sand.mozilla.org sets mode: -M 
[16:46:26] *** sand.mozilla.org sets mode: -R 
[16:46:46] *** Quits: Jane-18f (Mozilla@moz-EC8FBC4.hsd1.ma.comcast.net) (Ping timeout)
[16:46:46] *** Quits: [LADy20] (Mozilla@7200B883.A88C706E.4F3E55D3.IP) (Ping timeout)
[16:46:50] *** Quits: oIivetti (Mozilla@7200B883.A88C706E.4F3E55D3.IP) (Ping timeout)
[16:46:54] <cyndis> do /mode yourself +R to block the private messages
[16:46:56] *** Joins: heftig (heftig@moz-C12DDF6A.heftig.linuxsecured.net)
[16:48:40] <SiegeLord> Thanks
[16:49:14] <doener> r? https://github.com/mozilla/rust/pull/7452https://github.com/mozilla/rust/pull/7452
[16:49:20] <doener> oops... https://github.com/mozilla/rust/pull/7452
[16:49:44] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[16:51:52] <SiegeLord> rusti: enum E { float } let a : E = 5.0;
[16:51:52] -rusti- <anon>:9:38: 9:41 error: mismatched types: expected `main::E` but found `<VF0>` (expected enum main::E but found floating-point variable)
[16:51:53] -rusti- <anon>:9          enum E { float } let a : E = 5.0;
[16:51:53] -rusti-                                                ^~~
[16:51:53] -rusti- error: aborting due to previous error
[16:51:53] -rusti- application terminated with error code 101
[16:52:16] <SiegeLord> No anonymous constructors, I take it
[16:52:25] <bblum> aatch|bed: i'm not responsible for traits working or not
[16:52:35] <bblum> i just changed the way they kindcheck
[16:52:49] *** Quits: Dk (Sohbet@736BC8D4.26C0A60B.C687B15D.IP) (Ping timeout)
[16:54:54] <MaikKlein> btw what is the advantage of not having constructors?
[16:55:21] <MaikKlein> like in java c# etc
[16:55:25] <doomlord> hidden bugs , hudden code..
[16:55:34] <doomlord> easier to trace what is happening
[16:55:56] <SiegeLord> It seems like an unnecessary feature
[16:56:11] <doomlord> a lot of 'write-only' code in c++ stems from the ability to invoke conversion operators and conversion constructors
[16:56:42] <doomlord> while (file>>value) { use value...}  /*who'd have guessed that file has a conversion to 'bool',  thats testing the file is stilll valid */
[16:57:06] <SiegeLord> Pretty sure it's an operator void* :P
[16:57:17] <doomlord> its a bool i think
[16:57:29] <doomlord> and i recall this specificly surprising people in a discusion :) 
[16:58:38] <SiegeLord> Oh, it's a C++11 thing
[16:58:40] <Thad> any hints on what to modify for /src/rt/sync/timer.cpp to get 64-bit mode compiled in for x86_64 ??
[16:58:47] <SiegeLord> Operator void* before C++11, bool after
[16:58:53] <doomlord> ah ok
[16:59:00] <doomlord> so we were both right
[17:00:29] *** Joins: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz)
[17:00:57] <doomlord> initializing elements is enough i think... i dont like the sort of code that actually tries to do significant processing inside constructors
[17:01:17] <doomlord> the main purpose of constructors/destructors IMO is alloc/dealloc - which is already built in via the smartpointers
[17:01:25] <doomlord> is that the gist of it 
[17:01:32] <sully> oh my god, conversion constructors.
[17:02:04] *** Quits: samx (sami@moz-369757A0.pp.htv.fi) (Quit: This computer has gone to sleep)
[17:02:07] *** Quits: kini (kini@moz-92AA953A.members.linode.com) (Ping timeout)
[17:02:22] * sully got very angry about conversion constructors while trying to modify pcwalton's too clever by half interpreted shape glue
[17:02:25] <sully> last summer
[17:03:23] *** Joins: kini (kini@8CE7D24D:6948BCE:9B80811F:IP)
[17:04:18] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[17:05:46] <steven_is_false> The usual name for a value which lets one synchronize reads, and writes is a lock but the names ReadLock, or WriteLock work so much better for the results of RAII style scoping mechanisms. Is there an alternate name I could use?
[17:11:45] *** Quits: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au) (Quit: Leaving...)
[17:15:18] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[17:16:49] *** Joins: busylizzy (lisa@FC306F0C:BF233E95:2EB9049C:IP)
[17:16:56] *** Quits: ruediger (quassel@moz-C9B8D8D0.org) (Ping timeout)
[17:16:58] *** Joins: ruediger (quassel@moz-C9B8D8D0.org)
[17:17:18] *** Quits: geomyidae__ (uid214@moz-C944F5EC.irccloud.com) (Ping timeout)
[17:17:53] *** Joins: geomyidae__ (uid214@moz-C944F5EC.irccloud.com)
[17:24:26] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[17:24:38] *** Joins: timot (timot@B6E22A55.9756F818.898DC978.IP)
[17:24:58] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[17:26:50] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[17:27:15] *** Joins: xLII (xLII@4BED3CB3.F5F53E8A.2D6DB75E.IP)
[17:29:28] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Ping timeout)
[17:31:03] *** Quits: RMF (RMF@moz-9DB2BEB.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[17:32:03] *** Joins: RMF (RMF@moz-9DB2BEB.dsl.telepac.pt)
[17:36:18] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[17:39:39] *** Quits: mindginative (mindginati@moz-90AB6445.dyn.cust.vf.net.nz) (Quit: zzZZZ)
[17:39:39] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[17:41:24] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[17:50:40] <steven_is_false> Is there some kind of flag that could be set on the standard library (, and extra) so that #[inline] doesn't have to be set on every function?
[17:51:27] <doomlord> #inline at module level ?
[17:51:34] <doomlord> (perhaps)
[17:51:52] <steven_is_false> doomlord: I was thinking that would be a good syntax but I don't think it's been implemented.
[17:52:07] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[17:52:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/mZa6BA
[17:52:07] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[17:52:21] <doomlord> so i suppose the ideal would be such annotations generalized to modules, impls / traits..
[17:52:48] *** Joins: feduser (feduser@EA67B848.BC74D.799BF54A.IP)
[17:52:59] <steven_is_false> I guess
[17:55:08] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[17:55:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/A1x7lA
[17:55:08] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[17:55:10] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[17:55:10] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/3X9HUw
[17:55:10] <ghrust> 13rust/06auto 141662bd3 15Corey Richardson: Great renaming: propagate throughout the rest of the codebase
[17:55:11] <ghrust> 13rust/06auto 1495d22a3 15Corey Richardson: Fix merge fallout
[17:55:11] <ghrust> 13rust/06auto 1471b1c6a 15Corey Richardson: Warning cleanup
[17:55:11] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[17:57:06] <jyyou> 0/win 12
[17:57:26] <bblum> sweet action, both of my PRs succeeded overnight
[17:59:17] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[18:00:19] <xLII> i have a suggestion that if an object implement the ToStr trait,the fmt! macro will invok to_str method to format the string.
[18:00:32] <xLII> like Go's String interface
[18:00:49] <xLII> could this be ok?
[18:01:10] <engla> bblum: once functions are nice, but why can they not be enabled by default?
[18:02:45] <bblum> engla: because the fulltimers are scared that it will be too much cognitive overhead for newcomers to the language
[18:03:00] <bblum> when they look at library function signatures and are like "why do you have so many function types"
[18:03:39] <mnemotic> what are once functions and why are they awesome?
[18:04:20] <doener> functions that may only be executed once, so you can move ~ into them
[18:04:23] <engla> mnemotic: because you can mutate and use  movable values.. it allows a closure to truly take ownership of a value
[18:04:26] <bblum> they restrict the receiver of such a function to only being able to call it once (it is consumed when called)
[18:04:40] <engla> my lazy list using thunks needs once functions.
[18:04:41] <bblum> and they permit the maker of such a function to move noncopyable values out of the environment
[18:05:07] <Thad> I text crawed for "sorry, unimplemented" and found NOTHING in /rust/src/
[18:05:16] <Thad> or /rust/
[18:05:23] <bblum> engla: are you using heap closures or stack closures
[18:05:33] <mnemotic> sounds nifty, at the least :)
[18:05:34] <engla> I was using heap closures
[18:05:37] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Quit: Leaving)
[18:06:04] <bblum> engla: the plan is for heap closures to be replaced by macros that generate traits
[18:06:20] <engla> right, that's the type of code I'm experimenting with
[18:06:20] <bblum> a trait that takes by-value self will have the same properties as once
[18:06:28] <engla> now I'm using extern fn
[18:06:44] <engla> since the upvar is supplied separately anyway so it can be mutated
[18:07:32] *** Joins: brendan (brendaneic@moz-A98640B0.sub-70-197-2.myvzw.com)
[18:08:03] <engla> I tried the macro + extern fn  way but that's not workable in a nice way since a plain  fn definition needs type parameters and argument types
[18:08:11] <engla> so now it's using a hack.. I'll show you the code
[18:09:02] <engla> bblum: https://github.com/blake2-ppc/qc.rs/blob/master/lazy.rs
[18:09:15] <bblum> can you be like, trait OnceFn<Env,Args,Ret> { fn call(self, Env, Args) -> Ret; } ?
[18:09:31] <engla> so each Thunk can have it's own type of upvalue.. to regularise things we have to hide it behind a trait object
[18:09:52] <engla> this module is able to be implemented with ~fn  but now using extern fn for fun and experiment
[18:10:14] <engla> and using a trait object requires an Owned function type
[18:10:24] <engla> &'static fn can not be made owned (I think).
[18:11:15] *** Joins: dddxxx (Mibbit@moz-8458B748.dynamic.tstt.net.tt)
[18:11:20] *** Quits: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl) (Connection reset by peer)
[18:11:22] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[18:11:31] *** Joins: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl)
[18:11:33] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[18:11:56] <bblum> engla: using stage1 or stage2 you should be able to capture non owned things in traits
[18:11:59] <bblum> if you write
[18:12:01] <bblum> "~Trait:'static"
[18:12:11] <bblum> that overrides the default bound of ~Trait:Owned
[18:12:16] <engla> hm ok
[18:12:19] <bblum> s/Owned/Send/
[18:12:26] <bblum> although you  will then not be able to send it between tasks
[18:12:49] <engla> cool thanks
[18:12:51] <engla> yeah that's not needed
[18:13:03] <engla> so maybe I can go back to &'static fn then
[18:13:42] *** Quits: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr) (Quit: pyrac)
[18:14:38] <engla> very valuable to chat with you.. I think that's the best access I have to knowing how closures actually work
[18:15:10] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[18:15:19] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Connection reset by peer)
[18:15:37] <bblum> engla: glad to help
[18:16:20] <engla> give me an hour to figure out if I can put correct 'static bounds on everything and remain sane
[18:16:57] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Ping timeout)
[18:18:51] *** Joins: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr)
[18:19:07] <engla> hm it would be even better if there was a way to make &'static fn owned.
[18:20:02] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[18:20:13] <bblum> you mean to make it fulfill the owned bound?
[18:20:25] <bblum> or to restrict its environment
[18:20:32] *** Joins: samx (sami@moz-369757A0.pp.htv.fi)
[18:20:36] *** Quits: samx (sami@moz-369757A0.pp.htv.fi) (Quit: samx)
[18:21:13] <engla> the former
[18:22:40] <bblum> can't
[18:25:16] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[18:26:33] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Quit: Leaving)
[18:26:55] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[18:28:02] *** Quits: brendan (brendaneic@moz-A98640B0.sub-70-197-2.myvzw.com) (Quit: brendan)
[18:30:36] <engla> hm, but   &'static fn(A) ->  B; does not fulfill 'static
[18:30:55] <bblum> try &'static fn:'static(A) -> B
[18:31:31] <doomlord> what is 'static, permanent lifetime?
[18:31:42] <cmr> yes, valid for entire life of program
[18:31:53] *** Quits: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz) (Ping timeout)
[18:32:00] <cmr> it's the lifetime of string literals, for example
[18:32:03] <engla> bblum: I've tried it
[18:33:02] *** Joins: dwrensha (Mibbit@moz-DE44EA45.hsd1.pa.comcast.net)
[18:33:49] <engla> rusti: trait Any {}; impl<'self,A> Any for &'self fn(A) {}; let f: &'static fn:'static(int) = |x| { }; ~f as ~Any:'static
[18:33:49] -rusti- <anon>:9:105: 9:123 error: cannot pack type `~&'static fn:'static(int)`, which does not fulfill `'static`, as a trait bounded by 'static
[18:33:50] -rusti- <anon>:9          trait Any {}; impl<'self,A> Any for &'self fn(A) {}; let f: &'static fn:'static(int) = |x| { }; ~f as ~Any:'static
[18:33:54] -rusti-                                                                                                                   ^~~~~~~~~~~~~~~~~~
[18:33:56] -rusti- error: aborting due to previous error
[18:33:58] <SiegeLord> Damn... busted by an enum variant conflict again... there's a Left/Right in the prelude :(
[18:33:58] -rusti- application terminated with error code 101
[18:34:49] *** Joins: BitPuffin_ (quassel@moz-252CF7BC.cust.tele2.se)
[18:35:48] <dwrensha> I'm trying to construct a value `a` of type: `struct A<'self> { borrowed : &'self [u8], owned : ~[u8] }`
[18:36:04] <dwrensha> and I want a.borrowed to be a slice referring to part of a.owned
[18:36:09] <dwrensha> should this be possible?
[18:36:15] <engla> What I actually wish for in this lazy module is just that closure syntax could be used for functions without environment
[18:36:41] *** Quits: BitPuffin_ (quassel@moz-252CF7BC.cust.tele2.se) (Ping timeout)
[18:37:11] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[18:37:11] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f98ab61 to 148883099: 02http://git.io/N3iJvQ
[18:37:11] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[18:37:12] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[18:37:12] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/usikPw
[18:37:12] <ghrust> 13rust/06auto 1408a5278 15BjÃ¶rn Steinbrink: Add missing argument to a debug! call in trans_arg_expr
[18:37:12] <ghrust> 13rust/06auto 142a40c5d 15BjÃ¶rn Steinbrink: Avoid extra casts for "self" arguments...
[18:37:12] <ghrust> 13rust/06auto 14ba922a4 15BjÃ¶rn Steinbrink: Fix handling of temp cleanups for the "self" argument...
[18:37:14] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[18:37:20] *** Joins: BitPuffin_ (quassel@moz-252CF7BC.cust.tele2.se)
[18:37:29] <cmr> feh, bounced again
[18:37:35] <doener> :-(
[18:38:02] <cmr> https://github.com/mozilla/rust/pull/7111 landed! yay!
[18:39:36] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[18:41:12] <cmr> A lot of cleanup this week.
[18:41:17] *** Joins: mcstar (mcstar@moz-D7A16997.monradsl.monornet.hu)
[18:42:48] <dwrensha> can anyone help with my n00b question above?
[18:43:35] <kimundi> dwrensha: I think this is not possible
[18:44:51] <kimundi> .borrowed could only be valid if you never move the struct somewhere else
[18:45:17] <engla> dwrensha: think of lifetimes as being tied to scopes, not values
[18:48:47] <bblum> dwrensha: that seems possible
[18:49:11] <bblum> but you can't partially initialize the struct
[18:49:17] <bblum> and you can't move a borrowed value
[18:49:24] <bblum> so i don't think you can initialize it all in one go
[18:49:39] *** Quits: kini (kini@8CE7D24D:6948BCE:9B80811F:IP) (Ping timeout)
[18:50:18] *** Joins: kini (kini@8CE7D24D:6948BCE:9B80811F:IP)
[18:50:41] <bblum> also
[18:50:48] <dwrensha> yeah, that's where I got stuck--- trying to construct a throwaway temporary object for a.borrowed
[18:50:51] <bblum> i think that will prevent you from ever moving the struct
[18:50:54] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[18:50:58] <bblum> because that would make the pointer invalid
[18:51:14] *** Joins: Dk (Sohbet@736BC8D4.26C0A60B.C687B15D.IP)
[18:51:16] *** Joins: calatalee (Mibbit@moz-72830A1C.nyc.res.rr.com)
[18:52:02] <dwrensha> ok, I probably don't want to do things this way
[18:52:10] <bblum> dwrensha: oh, it won't let you make a throwaway object unless the throwaway object lives longer than the struct, anyway
[18:52:14] <bblum> that's kind of funny
[18:52:15] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[18:52:24] <bblum> you can use a static value though
[18:53:06] <bblum> static lifetime is the top lifetime
[18:53:19] <dwrensha> I tried `static x : ~[u8] = ~[]` but the compiler complained
[18:53:45] <bblum> ~ means allocation
[18:53:53] <dwrensha>  error: constant contains unimplemented expression type
[18:54:03] <engla> dwrensha: you can do it with unsafe code
[18:54:09] <engla> initialize it
[18:54:10] <bblum> so you can't allocate for a global
[18:54:18] <bblum> engla: no
[18:54:21] <bblum> do this: static x: [u8..0] = []
[18:54:27] *** Joins: jviereck1 (Adium@moz-340574DC.dclient.hispeed.ch)
[18:55:06] <engla> (you can construct a value of type struct A<'r>  with unsafe code. I don't think it's useful though)
[18:55:06] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Ping timeout)
[18:55:11] <dwrensha> I think you mean `static x: [u8,..0] = []`
[18:55:13] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[18:55:48] *** Joins: roo (jesse.rudo@moz-FAF2828A.dynamic.ip.windstream.net)
[18:55:57] <dwrensha> anyway, sounds like this struct isn't actually what I want
[18:56:21] <bblum> yeah, [u8, ..0]
[18:58:18] *** Quits: BitPuffin (quassel@moz-49828767.cust.tele2.se) (Ping timeout)
[18:59:57] *** Joins: _1126 (1126@moz-83D60E55.lileth.net)
[19:02:01] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[19:03:47] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[19:03:55] *** Joins: lkuper_ (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[19:04:12] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[19:04:26] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:04:27] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ea89b66 to 148883099: 02http://git.io/N3iJvQ
[19:04:27] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:04:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[19:04:32] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/laIfKg
[19:04:32] <ghrust> 13rust/06auto 14b29c368 15Alex Crichton: Removing a lot of usage of '&const'
[19:04:32] <ghrust> 13rust/06auto 143bad712 15Alex Crichton: Remove mutability from unique boxes in the AST
[19:04:32] <ghrust> 13rust/06auto 14c86df3a 15bors: auto merge of #7342 : alexcrichton/rust/assort-cleanup, r=cmr...
[19:04:34] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[19:04:43] <doener> *sigh*
[19:05:04] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[19:05:15] *** Quits: timot (timot@B6E22A55.9756F818.898DC978.IP) (Ping timeout)
[19:05:26] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[19:06:07] *** Quits: dwrensha (Mibbit@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:07:44] *** Quits: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr) (Quit: pyrac)
[19:09:26] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[19:10:33] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[19:14:07] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:15:11] *** Quits: xLII (xLII@4BED3CB3.F5F53E8A.2D6DB75E.IP) (Ping timeout)
[19:15:31] *** Joins: xLII (xLII@4BED3CB3.F5F53E8A.2D6DB75E.IP)
[19:15:40] *** Quits: xLII (xLII@4BED3CB3.F5F53E8A.2D6DB75E.IP) (Quit: Bye)
[19:21:07] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[19:21:19] *** Joins: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr)
[19:21:51] *** Joins: jpochyla (jpochyla@moz-DDB6BA4E.broadband9.iol.cz)
[19:22:01] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[19:22:25] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[19:22:29] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[19:23:51] <SiegeLord> Is anybody making a linear algebra package (ala scipy)?
[19:24:05] <doener> hrm, I don't see why that test would fail on x86 but not on x86_64...
[19:24:15] <Jeaye> SiegeLord: bjz has lmath.
[19:24:22] <SiegeLord> I think that's just for games
[19:24:31] <SiegeLord> /computer graphics
[19:24:35] <Jeaye> Ehh, not really. It's just for linear algebra.
[19:24:51] <Jeaye> Ok games/computer graphics probably fits it better.
[19:25:45] <SiegeLord> It only seems to have vectors/matrices up to 4x4
[19:25:59] <Jeaye> You want nxm matrices?
[19:26:09] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[19:26:12] <SiegeLord> Yeah
[19:26:15] *** Joins: bjz (brendanzab@moz-E17AB2AB.lnse2.cha.bigpond.net.au)
[19:26:56] <Jeaye> Gotcha. I haven't seen anything like that float by in IRC or on the mailing list. :|
[19:27:03] <SiegeLord> Maybe I'll make one after I'm done with my plotting library, if nobody else gets around to it
[19:27:18] <Jeaye> We'd <3 you for it.
[19:28:17] <Jeaye> bjz: I spoke in #glfw the other day about the mouse problems on Mac. Apparently they know about it, but didn't seem too interested in... fixing it.
[19:28:54] <bjz> Jeaye: did you hear from dreda?
[19:29:28] <Jeaye> Nope, only Nilium
[19:31:06] <bjz> Jeaye: be sure to talk to dreda, she is the main dev working on it
[19:31:29] <bjz> Jeaye: she also has OSX, so can test it
[19:31:34] *** Parts: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (WeeChat 0.4.1)
[19:31:37] <bjz> :)
[19:32:00] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[19:32:12] <Jeaye> Ahh, sounds good. Thanks for the tip. :)
[19:32:52] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[19:33:03] <engla> bblum: your change "'Borrow' stack closures rather than copying them"  is that something we have to do to our code too to adapt?
[19:34:19] <bblum> engla: yes, unfortuntely, for the moment
[19:34:24] <bblum> niko wants to auto-borrow them
[19:34:47] <engla> ok it's not so bad, just surprising
[19:34:49] <bblum> it's only an issue if you're passing them to other functions inside of loops
[19:35:00] <bblum> yeah i also wanted to make a better error message
[19:35:04] <bblum> to tell you what you had to do
[19:35:11] <bblum> might do that on monday
[19:35:46] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[19:35:52] <engla> bblum: oh ok.. well of course I did pass closures like that :-)
[19:35:56] <engla> in a few places
[19:36:17] <bblum> the most common place by far is the IterBytes implementation
[19:36:22] <bblum> which you can autoderive
[19:39:58] *** Quits: jpochyla (jpochyla@moz-DDB6BA4E.broadband9.iol.cz) (Ping timeout)
[19:44:40] <doener> hrm, can't reproduce that test failure locally :-/
[19:45:31] *** Joins: victorporof (victorporo@47ED472A.8A34D153.9B1E38F4.IP)
[19:47:28] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[19:48:05] *** Joins: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de)
[19:49:45] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[19:53:13] *** Quits: roo (jesse.rudo@moz-FAF2828A.dynamic.ip.windstream.net) (Ping timeout)
[19:53:58] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[19:54:18] <MaikKlein> rusti: let xs = [1, 9, 2, 3, 14, 12]; println(fmt!("%?, xs.iter().fold(0, |accumulator, item| accumulator - *item)));
[19:54:22] -rusti- <anon>:11:19: 11:20 error: unknown start of token: 63
[19:54:22] -rusti- <anon>:11     println(fmt!("%?", r))
[19:54:23] -rusti-                              ^
[19:54:23] -rusti- application terminated with error code 101
[19:54:50] <strcat> MaikKlein: missing a quote
[19:54:51] <MaikKlein> rusti: let xs = [1, 9, 2, 3, 14, 12]; println(fmt!("%?", xs.iter().fold(0, |accumulator, item| accumulator - *item)));
[19:54:56] -rusti- -41
[19:54:57] -rusti- ()
[19:56:02] *** Quits: jviereck1 (Adium@moz-340574DC.dclient.hispeed.ch) (Ping timeout)
[19:56:10] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[19:56:37] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[19:56:52] <engla> strcat: I'm implementing a consume iterator for vec. I guess it's planned already, is it ok? What should the method be named?
[19:57:15] <strcat> engla: I don't know if consume is actually correct
[19:57:25] <strcat> it won't be possible under the changes to the drop flag
[19:58:09] <strcat> it relies on being able to swap init() into something and have that make it be valid for destruction
[19:58:28] <engla> oh that's bad
[19:58:51] <strcat> consuming in reverse can definitely be done safely via pop
[19:58:52] <engla> if current consume isn't correct then this project is suddenly very outside my skill range
[19:59:03] <engla> yeah that's what my first impl does for rev
[19:59:09] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[19:59:43] <engla> in order consume is the crucial one though
[19:59:58] *** Joins: roo (jesse.rudo@moz-FAF2828A.dynamic.ip.windstream.net)
[20:01:17] <mcstar> what's %?? is it a wildcard?
[20:01:39] <engla> %? is the fmt! specifier to print the repr of the value
[20:01:50] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[20:02:02] <mcstar> does everything have that 'repr'?
[20:02:03] <engla> it's valid for any type so it's convenient for debugging
[20:02:21] <engla> yeah. not everything has a useful repr but normal struct and enum types do
[20:02:26] <strcat> mcstar: there will likely be another one using a trait for conversion to a Writer/str
[20:02:43] <strcat> fmt! is probably older than traits
[20:02:57] <mcstar> strcat: are there automatically derived typeclasses?
[20:03:02] <strcat> mcstar: yes
[20:03:06] <mcstar> besides repr
[20:03:13] <engla> strcat: consume iterator will be useful to map between different containers
[20:03:23] <strcat> mcstar: atm, Clone/DeepClone/Zero/Eq/Ord/TotalEq/TotalOrd/IterBytes and maybe some others
[20:03:32] <strcat> you have to opt-in to deriving them though
[20:03:47] <strcat> engla: yup but I don't think it can be represented in-order for vec
[20:03:49] <strcat> efficiently
[20:03:55] <strcat> without that hack
[20:04:08] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[20:04:12] *** Quits: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr) (Quit: pyrac)
[20:04:32] <engla> ok
[20:04:33] *** Quits: BitPuffin_ (quassel@moz-252CF7BC.cust.tele2.se) (Ping timeout)
[20:04:35] <strcat> and niko/patrick want to remove the drop flag and have the compiler exhaustively deal with moves/destructor so moves won't need to zero anything
[20:04:36] <engla> there's got to be some way
[20:05:12] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[20:06:16] <engla> vec::pop  uses replace_ptr the same way consume does though
[20:06:28] <jmgrosen> bjz: know of the best way of install glfw on mac? i'd normally use homebrew, but it's outdated
[20:06:44] <jmgrosen> is compiling from source my best option?
[20:08:24] *** Joins: samx (sami@moz-77A1C177.pp.htv.fi)
[20:08:56] <strcat> engla: but vec::pop does it in a safe way
[20:09:07] <MaikKlein> jmgrosen, u need to compile from source 
[20:09:14] <strcat> engla: consume takes a closure
[20:09:16] <strcat> the closure can *fail*
[20:09:16] <jmgrosen> ok, thanks
[20:09:18] <MaikKlein> jmgrosen, because you need to compile it to .so
[20:09:22] <strcat> failure == unwinding, and will call destructors
[20:09:51] <engla> strcat: ah ok, so after the vec len is updated, it's ok?
[20:09:52] <strcat> you can't consume from the start of a vector in-order without it relying on drop flags
[20:09:56] <strcat> engla: yes
[20:10:17] <strcat> engla: the issue is that consume claims they are valid elements, and if a failure happens a destructor is run on them
[20:10:20] <AutomatedTester> hi, stupid question, how do I make an empty arry
[20:10:24] <AutomatedTester> array
[20:10:24] <strcat> since atm we use a drop flag, there is no error
[20:10:28] <strcat> AutomatedTester: []
[20:10:35] <engla> strcat: yes I see, but it zeroes the elements
[20:10:55] <AutomatedTester> <anon>:34:4: 34:12 error: cannot determine a type for this local variable: unconstrained type
[20:10:55] <AutomatedTester> <anon>:34 let foo = []
[20:11:18] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[20:11:28] <mcstar> rusti: let foo : int = []
[20:11:28] -rusti- <anon>:10:4: 10:5 error: expected `;` but found `}`
[20:11:29] -rusti- <anon>:10     };
[20:11:29] -rusti-               ^
[20:11:29] -rusti- application terminated with error code 101
[20:11:39] <mcstar> rusti: let foo : int = [];
[20:11:40] -rusti- <anon>:9:25: 9:27 error: mismatched types: expected `int` but found `[<V5>, .. 0]` (expected int but found vector)
[20:11:40] -rusti- <anon>:9          let foo : int = [];
[20:11:40] -rusti-                                   ^~
[20:11:40] -rusti- error: aborting due to previous error
[20:11:40] -rusti- application terminated with error code 101
[20:11:43] <doener> can we retry https://github.com/mozilla/rust/pull/7452 ? I can' reproduce the failure at all, and bors didn't even link the build that actually failed in his comment
[20:11:49] <doener> s/can'/can't/
[20:11:51] <strcat> rusti: let xs: ~[int] = ~[]; let ys: [int, ..0] = [];
[20:11:51] <Jesse> AutomatedTester: once you use the array, the typechecker will usually have enough info to figure out its type
[20:11:53] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/hgPS
[20:11:53] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[20:11:58] <MaikKlein> rusti: let v = [int,..5];
[20:11:59] -rusti- <anon>:9:18: 9:21 error: unresolved name `int`.
[20:12:00] -rusti- <anon>:9          let v = [int,..5];
[20:12:00] -rusti-                            ^~~
[20:12:00] -rusti- error: aborting due to previous error
[20:12:00] -rusti- application terminated with error code 101
[20:12:01] <strcat> rusti: let _xs: ~[int] = ~[]; let _ys: [int, ..0] = [];
[20:12:02] -rusti- ()
[20:12:08] <strcat> anyway it needs somewhere to infer the type
[20:12:12] <strcat> otherwise you need to specify a type
[20:12:35] <strcat> rusti: let mut xs = ~[]; xs.push(5) /* infers from here */; xs
[20:12:35] -rusti- ~[5]
[20:12:40] <mcstar> thats soo weird that you need the ~ for the initialization too
[20:12:56] <mnemotic> why?
[20:13:00] <MaikKlein> ~ is not an array
[20:13:03] <strcat> mcstar: well [] is a stack vector, ~[] is a dynamically sized heap one
[20:13:11] *** Joins: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz)
[20:13:16] <mcstar> but why is the type not enough info?
[20:13:17] *** Quits: victorporof (victorporo@47ED472A.8A34D153.9B1E38F4.IP) (Ping timeout)
[20:13:19] <mcstar> ~[int]
[20:13:29] <mcstar> i guess it is only for consistency?
[20:13:39] <strcat> mcstar: well vector/string literals aren't generic
[20:13:45] <strcat> usually you don't say the type
[20:13:51] <strcat> so it's more convenient to have it part of construction
[20:13:57] <mcstar> ok
[20:14:21] <mcstar> what does [int, ..0] mean?
[20:14:35] <strcat> mcstar: a zero-size stack array ;p, not useful
[20:14:45] <MaikKlein> :D
[20:15:05] <mcstar> so the size annotated type?
[20:15:10] <mcstar> so is it a*
[20:15:19] <strcat> mcstar: yeah the size is part of the type for stack-allocated ones
[20:15:27] <AutomatedTester> because It was technically an unused  array it wasnt finding the type
[20:15:34] <AutomatedTester> that was a useful thing to learn
[20:15:46] <strcat> mcstar: you can coerce any vector to a slice &[T] so that's usually how you'd deal with all of them
[20:15:50] <jmgrosen> MaikKlein: sorry for being rather stupid about this stuff, but how do i build a glfw .so? `cmake && make && make install` didn't work
[20:16:08] <strcat> rusti: let xs = [1, 2, 3, 4]; let ys: &[int] = xs; ys
[20:16:10] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/KVJT
[20:16:16] <strcat> rusti: let xs = [1, 2, 3, 4]; let ys: &[int] = xs; fmt!("%?", ys)
[20:16:17] -rusti- ~"&[1, 2, 3, 4]"
[20:16:30] <strcat> rusti: let xs = [1, 2, 3, 4]; let ys: &[int] = xs; println(fmt!("%?", ys.slice(1, 3)))
[20:16:31] -rusti- &[2, 3]
[20:16:31] -rusti- ()
[20:16:41] <MaikKlein> jmgrosen, there is sth in the cmake file , sec...
[20:17:26] <MaikKlein> jmgrosen, option(BUILD_SHARED_LIBS "Build shared libraries" ON)
[20:17:27] *** Joins: victorporof (victorporo@74A9C5E8.1745F5FA.9B1E38F4.IP)
[20:17:31] <strcat> mcstar: they're just special cases until http://smallcultfollowing.com/babysteps/blog/2013/04/30/dynamically-sized-types/ goes through (if it does)
[20:17:35] <MaikKlein> jmgrosen, in cmakelist.txt
[20:17:38] <jmgrosen> MaikKlein: thanks!
[20:19:40] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[20:21:33] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[20:24:03] <jmgrosen> bjz: sent you a tiny pull request for glfw-rs to work on the latest version of rust
[20:24:16] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Input/output error)
[20:24:59] <bjz> jmgrosen: cheers! I will take a look.
[20:25:12] <jmgrosen> only changed one line :P
[20:26:14] *** Quits: MaikKlein (maik@moz-C8D04999.dip0.t-ipconnect.de) (Ping timeout)
[20:26:33] <Thad> Neat Statistics and Code Search is on Ohloh.net for Rust: http://www.ohloh.net/p/rust-lang
[20:26:56] *** Quits: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl) (Connection reset by peer)
[20:26:59] <bjz> jmgrosen: no, that stuff is super useful
[20:27:07] *** Joins: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl)
[20:27:23] <jmgrosen> i assume i still need glcore-rs to do stuff, though?
[20:27:33] <bjz> jmgrosen: I can't keep up to date with everything
[20:27:51] <bjz> jmgrosen: I would reccomend opengles for now
[20:27:58] <jmgrosen> oh, ok
[20:28:08] *** Joins: sankha93 (Instantbir@EBD91EDB.71DC40C8.FE9EB363.IP)
[20:28:16] <strcat> Thad: it can't detect rust though
[20:28:22] <bjz> jmgrosen: glcore aint the easiest thing to get working :(
[20:28:29] <strcat> so it misses the 250k lines of rust in the codebase
[20:28:37] <jmgrosen> bjz: aw :/
[20:28:38] <bjz> jmgrosen: I will have a function loader soon though
[20:28:45] <jmgrosen> sounds awesome
[20:29:08] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[20:29:30] <bjz> jmgrosen: do you need some of the extended functionality of opengl?
[20:29:43] *** Joins: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr)
[20:30:00] <jmgrosen> bjz: probably not -- i haven't really used opengl at all before :P
[20:30:10] <jmgrosen> bjz: but i figured i might as well start in rust
[20:30:20] <mark_edward> bjz: i have
[20:30:20] <bjz> jmgrosen: oh ok, then opengles should be fine for you
[20:30:21] <Thad> strcat: nope it doesn't. but that's a minor annoyance until Rust is parsed by CodeSight (Black Duck Software).
[20:30:27] <mark_edward> but i only learned mostly immediat emode stuff
[20:32:54] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Ping timeout)
[20:33:48] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[20:34:42] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Ping timeout)
[20:36:02] <jmgrosen> bjz: have any getting started material? :P
[20:36:15] <jmgrosen> bjz: i'm looking at your open.gl-tutorials, but it seems that's not meant for es
[20:36:54] <bjz> jmgrosen: opengles is just a subset of opengl
[20:37:07] <bjz> most of the tutorials out there should work
[20:37:10] <jmgrosen> ok
[20:37:28] *** Joins: jviereck (Adium@moz-499179CD.dynamic.hispeed.ch)
[20:37:50] <bjz> but it depends on what features they use
[20:40:25] *** Quits: dddxxx (Mibbit@moz-8458B748.dynamic.tstt.net.tt) (Quit: http://www.mibbit.com ajax IRC Client)
[20:43:14] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[20:43:47] <Thad> how do I separate the --target-triples ??  with a pipe char ?
[20:44:49] <Luqman> Thad: comma
[20:48:55] *** Quits: sankha93 (Instantbir@EBD91EDB.71DC40C8.FE9EB363.IP) (Ping timeout)
[20:50:15] <Thad> Luqman: thanks.
[20:50:16] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:50:16] *** ChanServ sets mode: +o brson
[20:51:41] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[20:52:16] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:56:32] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[20:57:10] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[20:58:05] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:58:05] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/laIfKg
[20:58:05] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:58:45] *** Quits: victorporof (victorporo@74A9C5E8.1745F5FA.9B1E38F4.IP) (Ping timeout)
[21:00:12] <jmgrosen> how can i get a &'static str to a ~[u8]?
[21:00:47] <steven_is_false> jmgrosen: I think it's string.as_bytes().to_owned()
[21:00:58] <steven_is_false> rusti: "Hello World!".as_bytes().to_owned()
[21:01:02] -rusti- ~[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33]
[21:01:07] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:01:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Id4dfA
[21:01:07] <ghrust> 13rust/06auto 14244a1c3 15Tim Chevalier: rustpkg: Make rustpkg commands work without a package ID...
[21:01:07] <ghrust> 13rust/06auto 14c638715 15bors: auto merge of #7419 : catamorphism/rust/default-package, r=catamorphism...
[21:01:09] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:01:13] <steven_is_false> rusti: "Good boy!"
[21:01:14] -rusti- "Good boy!"
[21:01:17] <steven_is_false> rusti: botsnack
[21:01:18] -rusti- "nom nom"
[21:01:19] <jmgrosen> steven_is_false: awesome! thanks
[21:01:26] <steven_is_false> jmgrosen: Your welcom.
[21:04:07] *** Joins: jviereck1 (Adium@moz-499179CD.dynamic.hispeed.ch)
[21:04:10] *** Quits: jviereck (Adium@moz-499179CD.dynamic.hispeed.ch) (Connection reset by peer)
[21:05:24] *** Quits: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr) (Quit: pyrac)
[21:07:14] <doener> rusti: bytes!("Hello World!")
[21:07:15] -rusti- &[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33]
[21:07:36] <doener> jmgrosen: there's a macro for that, see above
[21:07:54] <jmgrosen> blz: i'm going though c2_triangle.rs of your open.gl-tutorials, but what should i use instead of glBindFragDataLocation? it's not in es
[21:07:57] <jmgrosen> doener: thanks!
[21:08:08] <jmgrosen> bjz: see my misspelling of your name :P
[21:08:23] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[21:08:38] *** Joins: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr)
[21:13:43] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[21:13:48] <Thad> Does anyone know if this looks right so far to build Rust (attempting) on x86_64 with my mingw64 toolchain in place now ? http://pastebin.mozilla.org/2577903
[21:14:23] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Quit: WeeChat 0.4.1)
[21:14:30] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[21:16:30] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[21:17:50] *** Quits: mcstar (mcstar@moz-D7A16997.monradsl.monornet.hu) (Quit: mcstar)
[21:21:25] *** Quits: pyrac (pyrac@moz-3A4AC930.w90-55.abo.wanadoo.fr) (Quit: pyrac)
[21:21:41] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:23:05] *** Quits: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org) (Ping timeout)
[21:23:11] *** Joins: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org)
[21:27:38] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:27:38] <ghrust> 01[13rust01] 15thestinger created 06rollup (+1 new commit): 02http://git.io/Wu8kYw
[21:27:38] <ghrust> 13rust/06rollup 14603137c 15Daniel Micay: fix code block syntax in two docstrings
[21:27:38] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:28:56] *** Quits: Ms2ger (Ms2ger@9D2CFE09.F6F1767D.3773EA9F.IP) (Quit: nn)
[21:29:17] <mnemotic> what information does the hash part of a lib name built by rustc carry?
[21:29:37] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[21:29:37] <ghrust> 01[13rust01] 15thestinger pushed 1 new commit to 06rollup: 02http://git.io/bytyuA
[21:29:37] <ghrust> 13rust/06rollup 14fe10db2 15Jordi Boggiano: Add -v/--version support to rust binary
[21:29:37] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[21:30:59] <sp3d> mnemotic: I wrote about that! https://github.com/mozilla/rust/wiki/Doc-crate-hashes
[21:31:05] <sp3d> see "Hash inputs"
[21:34:04] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:34:04] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c638715 to 14c86df3a: 02http://git.io/N3iJvQ
[21:34:04] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:34:06] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[21:34:06] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rEAnhg
[21:34:06] <ghrust> 13rust/06auto 149b95b6d 15Young-il Choi: std: adjust run.rs test for android
[21:34:06] <ghrust> 13rust/06auto 14439b13f 15bors: auto merge of #7449 : yichoi/rust/std_test, r=cmr...
[21:34:07] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[21:34:56] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[21:35:01] <Thad> Anyone have any idea where I might need to tweak Clean.mk to handle this error ? http://pastebin.mozilla.org/2577960
[21:36:00] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[21:36:00] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06rollup from 14fe10db2 to 14ab7efa8: 02http://git.io/MFuO7Q
[21:36:00] <ghrust> 13rust/06rollup 14d820355 15Daniel Micay: fix code block syntax in two docstrings
[21:36:00] <ghrust> 13rust/06rollup 14eee7acc 15Jordi Boggiano: Add -v/--version support to rust binary
[21:36:00] <ghrust> 13rust/06rollup 14ab7efa8 15Daniel Micay: minor vec cleanup...
[21:36:01] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[21:36:20] <mnemotic> sp3d: cheers!
[21:36:35] *** Quits: jviereck1 (Adium@moz-499179CD.dynamic.hispeed.ch) (Quit: Leaving.)
[21:37:19] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[21:37:40] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[21:39:33] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[21:39:33] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06rollup from 14ab7efa8 to 14052f28a: 02http://git.io/MFuO7Q
[21:39:33] <ghrust> 13rust/06rollup 14052f28a 15Daniel Micay: minor vec cleanup...
[21:39:33] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[21:40:09] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Client exited)
[21:43:08] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[21:45:16] <jmgrosen> MaikKlein: why would glGetAttribLocation be returning -1? name doesn't start with gl_ and it seems to be an active attribute in the program
[21:48:01] *** Quits: spider-mario (spidermari@moz-B8FA2FF4.rev.sfr.net) (Input/output error)
[21:48:54] <bjz> jmgrosen: hmm, odd
[21:49:29] <jmgrosen> bjz: well, it seems that glUseProgram is giving me a GL_INVALID_OPERATION error
[21:50:03] * bjz sighs at opengl's opaqueness
[21:50:10] <jmgrosen> yeah really :(
[21:51:20] <bjz> jmgrosen: weird, didn't know ES didn't have glBindFragDataLocation
[21:51:37] <jmgrosen> yeah, SO said to use gl_FragColor instead
[21:52:20] <bjz> http://stackoverflow.com/questions/16576390/equivalent-opengl-es-2-0-method-to-void-glbindfragdatalocationgluint-program-g
[21:52:23] <bjz> yup
[21:52:44] <bjz> nmatsakis: ping
[21:53:26] <jmgrosen> bjz: could you take a look to see if i'm doing anything drastically wrong? https://gist.github.com/jmgrosen/66a1bbf2763c5cb59518
[21:54:06] <jmgrosen> bjz: it compiles and doesn't crash, but only shows a gray window
[21:55:42] <bjz> any idea Jeaye? ^
[21:55:52] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[21:57:23] *** Quits: samx (sami@moz-77A1C177.pp.htv.fi) (Ping timeout)
[21:58:18] *** Joins: samx (sami@moz-77A1C177.pp.htv.fi)
[21:59:27] *** Joins: victorporof (victorporo@74A9C5E8.1745F5FA.9B1E38F4.IP)
[22:06:23] *** Quits: samx (sami@moz-77A1C177.pp.htv.fi) (Ping timeout)
[22:06:41] <jmgrosen> :(
[22:07:56] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[22:08:36] <steven_is_false> jmgrosen: What I'd suggest is to wrap up OpenGL ES in a safety layer which forces safety.
[22:09:02] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[22:09:28] <jmgrosen> steven_is_false: rust-opengles should already do that -- the only unsafe block was originally safe, but i changed it to how i'm doing it now to see if that would work
[22:09:35] <cmr> Bad day for landing stuff it seems
[22:10:10] <steven_is_false> jmgrosen: There is a lot of stuff one can do to make OpenGL more safer, and harder to misuse.
[22:10:40] <jmgrosen> steven_is_false: wellâ€¦ seeing as i'm a opengl beginner, i wouldn't know what that stuff is :(
[22:10:42] <cmr> Someone in #servo mentioned that there is a safe subset of GL that exists, not just safe wrapper of it
[22:11:26] <steven_is_false> Here's how I'm wrapping it (although there's still a lot I can do like check types in shader programs for example,) http://gitorious.org/p-x/p-x/blobs/master/src/safegl.rs
[22:12:49] *** Quits: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu) (Ping timeout)
[22:14:10] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Client exited)
[22:14:45] *** Joins: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu)
[22:15:32] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[22:17:00] <strcat> cmr: https://www.opengl.org/registry/specs/ARB/robustness.txt ?
[22:17:51] <strcat> I don't think you can wrap opengl or opengles and not mark most of the functions unsafe
[22:19:14] *** Quits: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu) (Ping timeout)
[22:19:25] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[22:20:48] <cmr> strcat: I wasn't really paying attention, I saw it in passing
[22:22:02] *** Joins: mjrosenb (mjrosenb@moz-B3592BDA.club.cc.cmu.edu)
[22:23:00] <cmr> SiegeLord: You're writing a plotting library?
[22:23:57] *** Joins: MaikKlein (maik@moz-B7E461DC.dip0.t-ipconnect.de)
[22:24:12] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[22:24:33] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[22:27:03] <SiegeLord> cmr: Yes, https://github.com/SiegeLord/RustGnuplot
[22:27:05] *** Joins: samx (sami@moz-369757A0.pp.htv.fi)
[22:27:10] <Jeaye> jmgrosen: Add some error checking.
[22:27:17] <Jeaye> You... have none.
[22:27:24] <cmr> Ah gnuplot
[22:28:01] <Jeaye> I wrote a macro to do it for me, so I say something like: check!(gl::bind_buffer(gl::ARRAY_BUFFER, foo));
[22:28:18] <cmr> SiegeLord: if graphite doesn't work out maybe I'll use that for graphing my benchmark data!
[22:28:20] <cmr> ;)
[22:28:24] <cmr> Nothing looking dogfooding
[22:29:38] <Jeaye> jmgrosen: Anything could be going awry in there and you wouldn't be able to trace it down, since you're using neither glGetError nor ARB_debug_output.
[22:33:43] <MaikKlein> is anyone working on rust bindings for http://assimp.sourceforge.net/ ?
[22:33:43] <cmr> bblum: ping
[22:36:47] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[22:37:04] <MaikKlein> is rustpkg usable?
[22:38:10] *** Quits: lkuper_ (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[22:38:17] <SiegeLord> cmr: I'm planning on using Rust for scientific stuff... so I need something to make nice plots ;)
[22:38:31] <MaikKlein> i need a good name for a scenegraph in rust, hmm I always so bad with naming :X
[22:38:33] <SiegeLord> Then I'll need a linear algebra library, but that's for the future
[22:39:00] <cmr> SiegeLord: could you wrap blas or something?
[22:41:10] <SiegeLord> That seems complicated
[22:41:37] <Jeaye> MaikKlein: I've been thinking about it, but I'll probably just write my own.
[22:41:39] <SiegeLord> I'm more interested in a nice interface rather than raw speed
[22:41:43] <Jeaye> It's a pain to wrap things. >.<
[22:41:45] <doomlord> curious if there's a set of raw gl bindings without the names rust-ified .. glBindBuffer, GL_ARRAY_BUFFER  etc..
[22:42:08] *** Joins: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com)
[22:42:11] <Jeaye> doomlord: You can access the raw function names in rust-opengles
[22:42:17] <Jeaye> gl2::glBindBuffer
[22:42:30] <MaikKlein> Jeaye, ?
[22:42:39] <MaikKlein> Jeaye, writing a scene graph?
[22:42:48] <doomlord> ok thats what i'm after, does it have all the constants aswell
[22:42:49] <Jeaye> 15:32:47        MaikKlein â•¡ is anyone working on rust bindings for http://assimp.sourceforge.net/ ?
[22:42:59] <MaikKlein> Jeaye, ah
[22:43:21] <Jeaye> doomlord: The constants are gl2::ARRAY_BUFFER. It's stupidly simple to port anything.
[22:43:44] <Jeaye> s/GL_/gl2::/g
[22:44:03] <MaikKlein> SGiR -> Scene Graph in Rust , lol I am so bad naming stuff
[22:44:34] <cmr> MaikKlein: just name it rust-scenegraph or something
[22:44:45] <doomlord> maybe i'm fussing over nothing but i'd like things to stay as similar as possible jumping between C/C++  & rust 
[22:45:22] <MaikKlein> Jeaye, keep me up to date if you start something :) maybe I can help
[22:45:40] <Jeaye> sure
[22:48:08] *** Quits: jyeo (user@moz-FEFE526F.cpe.net.cable.rogers.com) (Ping timeout)
[22:49:14] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Ping timeout)
[22:52:04] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[22:52:18] *** Parts: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Leaving)
[22:53:49] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[22:53:50] <jmgrosen> Jeaye: I've added error checking and gotten rid of the unsafe block: https://gist.github.com/jmgrosen/66a1bbf2763c5cb59518
[22:54:10] <mnemotic> is there already a lib with a name that is the mandatory play on iron oxide? :D
[22:54:20] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[22:55:06] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 23.0/20130625125232])
[22:55:06] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[22:55:13] <engla> Feo means ugly in spanish
[22:56:34] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[22:56:37] <MaikKlein> is everything private by default?
[22:56:43] <mnemotic> no
[22:57:26] <engla> mnemotic: just saying it can be a double wordplay if you've got something ugly to publish
[22:57:31] <engla> ^^
[22:57:46] <mnemotic> huh, double points for the same effort :)
[22:58:10] <mnemotic> MaikKlein: items are module-private, but fields and methods are public
[22:58:50] <mnemotic> so, nothing is visible from outside by default, but locally everything is public
[22:59:51] <MaikKlein> ah ok 
[23:00:07] <MaikKlein> but if I want to write a lib then I have to use "pub fn"
[23:00:16] <MaikKlein> if my clients want to use it
[23:00:59] *** Quits: kini (kini@8CE7D24D:6948BCE:9B80811F:IP) (Ping timeout)
[23:01:00] *** Quits: samx (sami@moz-369757A0.pp.htv.fi) (Quit: This computer has gone to sleep)
[23:01:24] <mnemotic> MaikKlein: yes
[23:01:36] *** Joins: kini (kini@8CE7D24D:6948BCE:9B80811F:IP)
[23:01:55] <MaikKlein> k thanks
[23:03:23] <mnemotic> you're welcome
[23:03:50] <cmr> mnemotic: there's hydroxy
[23:04:20] <cmr> I thought...
[23:04:33] *** Quits: n00b6502 (kwr5y54@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[23:05:59] <MaikKlein> is this still up to date? http://static.rust-lang.org/doc/rustpkg.html
[23:11:47] <cmr> MaikKlein: https://github.com/mozilla/rust/blob/master/doc/rustpkg.md is always up to date, you should use it :)
[23:12:58] *** Quits: jpochyla (jpochyla@moz-8D99AE5D.broadband18.iol.cz) (Ping timeout)
[23:13:24] *** Quits: vosen_ (vosen@moz-3B059DC4.sta.asta-net.com.pl) (Quit: Leaving)
[23:13:57] <cmr> Does anyone have any projects or libraries they would like linked in TWiR?
[23:15:09] <steven_is_false> TWiR?
[23:15:12] <engla> my quickcheck
[23:15:13] <cmr> this week in rust
[23:15:45] <engla> https://github.com/blake2-ppc/qc.rs
[23:18:53] <thiez> seems like rustray got slightly slower lately
[23:19:12] <doener> cmr: can we retry #7452? The failure makes no sense
[23:19:21] <thiez> but it looks like loading the model file got faster
[23:19:23] <MaikKlein> cmr, thanks!
[23:19:46] <thiez> I wish I had kept track of the total runtimes
[23:19:47] <cmr> thiez: really? I would have expected it to have gotten faster, given the optimization pipeline improvements and some codegen cleanup
[23:19:55] <strcat> thiez: since when did it get slower?
[23:20:22] <cmr> doener: I saw one of those errors locally actually!
[23:20:30] <cmr> doener: it was extremely strange, and I could not reproduce it
[23:20:44] <cmr> brson: ^ probably does not bode well
[23:21:00] <doener> cmr: with that PR only? Or with master as well?
[23:21:17] <cmr> doener: well on my great_renaming branch, which is just master + import renames
[23:21:20] <thiez> I hesitate to make a strong statement here, I run those tests on a VM, and sometimes I may or may not have my browser open
[23:21:40] <strcat> thiez: where's the source?
[23:21:46] <cmr> https://github.com/Thiez/rustray
[23:21:52] <doener> cmr: ok, then I guess a retry is fine, right?
[23:22:00] <cmr> doener: yep, already commented with it
[23:22:02] <doener> ah, thanks!
[23:22:03] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[23:22:06] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[23:22:58] * doener will have a small celebration when that PR lands
[23:23:01] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[23:23:02] <thiez> with compiler c6515ee with rustray 23eef5f I got 3.488 after a few benchmarks, with c86df3a and de4ef1d I get 3.647
[23:23:18] <thiez> I wish I could keep the rustray code the same, but the compiler changes and I must change with it :p
[23:23:20] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[23:23:27] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[23:23:35] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[23:24:27] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Quit: eholk)
[23:25:27] <doener> where can I find rustray? I only find brson's version, which is outdated
[23:25:40] <cmr> I *just* linked to it!
[23:25:52] <doener> ah, sorry, missed that
[23:26:13] <MaikKlein> does anyone know a lib which uses rustpkg?
[23:26:31] <steven_is_false> Does rust build with --opt-level=3, or --opt-level=2? Because it rebuilds itself --opt-level=3 could be faster than --opt-level=2.
[23:26:51] <cmr> steven_is_false: 2
[23:26:54] <cmr> I think
[23:27:36] <strcat> thiez: what about a newer compiler?
[23:27:40] <strcat> I redid all the optimization passes
[23:27:51] <strcat> steven_is_false: it uses --opt-level=2 (that's -O)
[23:28:07] <thiez> strcat: we have a newer version than c86df3a?
[23:28:18] <steven_is_false> Okay, I should compare, and profile the differences in time then.
[23:28:20] <strcat> thiez: oh nvm
[23:28:25] <thiez> :)
[23:28:38] <cmr> https://gist.github.com/cmr/841decab931f654fafab did I exclude anything important?
[23:28:39] <thiez> it's less than 0.2s difference so it may just be noise
[23:28:43] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[23:28:52] *** Joins: mindginative (mindginati@moz-90AB6445.dyn.cust.vf.net.nz)
[23:28:56] <strcat> thiez: have you done any profiling?
[23:28:59] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[23:29:10] <steven_is_false> They're single-threaded, and IO time is very small so I can fairly profile both builds at the same time right?
[23:29:23] <cmr> steven_is_false: not really
[23:29:33] <strcat> can't profile multiple things at once
[23:29:39] <strcat> cache is by far the most important thing
[23:29:52] <steven_is_false> Oh okay then.
[23:30:07] <cmr> plus any thermal/power throttling or turbo
[23:30:18] <steven_is_false> I guess I'll have to make a batch script to run the jobs overnight then?
[23:31:27] <doener> cmr: maybe sully's work on default methods?
[23:31:28] <thiez> strcat: not really, I just keep rustray up to date. Besides, my goal isn't to make the best ray tracer (I barely understand how it works), I just like an indication of how well the compiler is compiling it
[23:31:39] <cmr> doener: nothing landed this week unfortunately, besides some tests.
[23:31:46] <strcat> thiez: it looks like it's mostly bound by libraries though
[23:31:50] <strcat> thiez: it's not a compiler benchmark
[23:32:07] <thiez> I did some profiling once and ended up replacing fmin/fmax by a rust implementation :p
[23:32:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[23:32:32] <doener> cmr: what about https://github.com/mozilla/rust/pull/7471?
[23:32:37] <thiez> strcat: it doesn't really use libraries in the raytracer-part?
[23:32:40] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[23:32:50] <thiez> perhaps some vec functions/methods
[23:33:03] <strcat> thiez: vec methods/functions is definitely making it not a compiler bench
[23:33:04] <cmr> doener: yech how'd I miss that :\
[23:33:08] <strcat> the vec implementation is very bad
[23:33:23] <strcat> it's not even well defined so it breaks optimization passes
[23:33:46] <thiez> I think I was one of the first to notice the optimizations broke a while ago because rustray got twice as slow ;)
[23:33:47] <MaikKlein> Owned got renamed to Send?
[23:33:52] <strcat> MaikKlein: yes
[23:33:56] <MaikKlein> k
[23:34:04] <strcat> thiez: well they didn't break ;\
[23:34:14] <strcat> vec has always been broken
[23:34:26] <thiez> but it was faster a few revisions ago :p
[23:34:38] <strcat> thiez: from which commit?
[23:34:57] <thiez> I just said so, c6515ee
[23:35:04] <thiez> sadly I can't benchmark each commit :(
[23:35:23] <strcat> you can bisect a regression
[23:35:39] <thiez> sure, but it's a 0.2s regression, and stuff is still changing
[23:35:58] <thiez> maybe virtualbox got worse, I updated recently :p
[23:36:06] <thiez> I really should get a proper linux box for this kind of stuff
[23:36:43] <strcat> thiez: yeah but as far as everyone is concerned, there hasn't been a perf regression
[23:36:56] <strcat> no one is working on fixing a perf issue/regression that you say happened at some point
[23:37:01] <thiez> let's get the actual benchmarks in the rust testing suite working and keep track of it
[23:37:16] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[23:37:19] <cmr> funny you mention that, because I'm setting up my spare box for that exact purpose as soon as I publish twir
[23:37:56] * thiez waves a little flag saying 'cmr yay!'.
[23:38:42] *** Joins: samx (sami@moz-369757A0.pp.htv.fi)
[23:39:12] <cmr> I'm pretty sure it has a P4
[23:39:21] <cmr> so, it's really not the best thing in the world
[23:39:24] <strcat> turning off jemalloc was a regression
[23:39:32] <thiez> so it's basically useless for the multitasking? ;)
[23:39:33] <cmr> but it will be completely idle besides whatever the kernel decides to do, and the benchmarks
[23:39:36] <steven_is_false> It seems like I'll have to use a Makefile option to set the RUSTFLAGS for comparing the performance of the two.
[23:39:36] <bblum> cmr: pong
[23:39:37] <strcat> but I don't think we can fix it
[23:39:55] <Jeaye> jmgrosen: Check your winding. :)
[23:39:59] <cmr> bblum: better late than never I guess: http://cmr.github.io/blog/2013/06/29/this-week-in-rust/
[23:40:05] <Jeaye> Looks like you're going clockwise.
[23:40:18] <Jeaye> GL assumed counter clockwise by default.
[23:40:20] <cmr> bblum: I don't really understand your trait pr's, would you mind giving me a sentance or two to put up there?
[23:40:27] <thiez> strcat: might be, we'll find out when we get jemalloc back
[23:40:36] <strcat> thiez: don't think we will
[23:40:41] <thiez> why?
[23:40:50] <strcat> because it doesn't fit in the red zone
[23:40:57] <Jeaye> jmgrosen: Alternatively, you can disable GL_CULL_FACE and see if it shows.
[23:41:07] <thiez> I don't follow
[23:41:17] <bblum> cmr: i see
[23:41:20] <strcat> thiez: we use segmented stacks
[23:41:25] <strcat> the space reserved at the end isn't enough to run jemalloc
[23:41:31] <thiez> right
[23:41:46] <jmgrosen> Jeaye: at the moment, the gl2::use_program call gives an error
[23:41:47] <thiez> so when will we get the option of not having segmented stacks? :p
[23:41:58] <doener> maybe I'm just naive, but can't we just reserve a bit more?
[23:42:02] <strcat> thiez: don't think it will ever happen in a way that we can use jemalloc
[23:42:04] <jmgrosen> Jeaye: and I'm not quite sure what you mean by windingâ€¦ X3
[23:42:04] <thiez> oh wait, we have #[fixed_stack_segment] these days, right?
[23:42:09] <thiez> oh :(
[23:42:10] <strcat> doener: then we might as well use regular stacks
[23:42:15] <bblum> cmr: it changes the way traits/closures and captured data fulfill kind bounds, so you can restrict or loosen the requirements instead of having the fixed defaults of "can only capture Send things in ~fn/~Trait"
[23:42:16] <strcat> a regular stack starts at 4K
[23:42:23] <strcat> if we can't beat 4K, we should use plain old allocations
[23:42:49] <Jeaye> jmgrosen: Your verts are laid out in clockwise order. They should be in counter clockwise order (swap the last two). Draw your triangle on paper to see what I mean.
[23:43:05] <strcat> segmented stacks and performance are in direct conflict
[23:43:07] <strcat> you can pick one
[23:43:16] <thiez> I'll pick the latter.
[23:43:23] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[23:43:29] <strcat> well you probably don't want rust then ;p
[23:43:34] <thiez> :'(
[23:44:06] <strcat> at least as it is now
[23:44:30] <thiez> I am aware that it's rather unreliable and slow at the time
[23:44:30] <jmgrosen> Jeaye: ah, the winding makes sense now -- thanks! however, that didn't fix the error -- gl2::use_program still gives a GL_INVALID_OPERATION error
[23:44:32] <bblum> cmr: one example is that you can add the extra requirement of Freeze, so you can put existential data inside of ARCs
[23:44:53] *** Quits: RMF (RMF@moz-9DB2BEB.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[23:44:55] <bblum> cmr: see https://github.com/mozilla/rust/blob/master/src/test/run-pass/trait-bounds-in-arc.rs
[23:44:58] <thiez> but I think they'll be better eventually
[23:45:42] <cmr> bblum: ok, thanks!
[23:45:56] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[23:45:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rEAnhg
[23:45:56] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[23:45:57] <Jeaye> jmgrosen: You're not checking for shader errors. 
[23:46:33] <MaikKlein> what is gl2:: is it opengles2?
[23:46:41] <Jeaye> MaikKlein: Yes.
[23:46:53] <jmgrosen> Jeaye: you may not be looking at my latest version -- https://gist.github.com/jmgrosen/66a1bbf2763c5cb59518
[23:46:54] <Jeaye> jmgrosen: See glGetShaderiv
[23:46:58] <jmgrosen> oh
[23:47:01] <Jeaye> I am.
[23:47:10] <Jeaye> You're not checking for compilation/linking erros.
[23:47:13] <Jeaye> Or errors
[23:47:16] *** aatch|bed is now known as aatch
[23:47:17] <bblum> cmr: http://smallcultfollowing.com/babysteps/blog/2013/06/11/data-parallelism-in-rust/ is another, more complicated but less contrived, example for how they would be useful
[23:47:33] <Jeaye> jmgrosen: See https://github.com/Jeaye/q3/blob/master/src/gl/shader.rs#L242 for reference.
[23:47:33] <MaikKlein> Jeaye, does it compile in the current master?
[23:47:51] <Jeaye> MaikKlein: Probably not. I just have a fork of it that I use.
[23:48:15] <Jeaye> It updates when servo gets a lang update.
[23:48:25] <Jeaye> Which happens sometimes. :P
[23:48:43] <MaikKlein> :d
[23:48:48] *** Quits: samx (sami@moz-369757A0.pp.htv.fi) (Quit: This computer has gone to sleep)
[23:48:55] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[23:48:55] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/NsYTIw
[23:48:55] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[23:48:56] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[23:48:56] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/6nfRiA
[23:48:56] <ghrust> 13rust/06auto 1408a5278 15BjÃ¶rn Steinbrink: Add missing argument to a debug! call in trans_arg_expr
[23:48:56] <ghrust> 13rust/06auto 142a40c5d 15BjÃ¶rn Steinbrink: Avoid extra casts for "self" arguments...
[23:48:56] <ghrust> 13rust/06auto 14ba922a4 15BjÃ¶rn Steinbrink: Fix handling of temp cleanups for the "self" argument...
[23:48:59] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[23:49:41] <cmr> ttp://cmr.github.io/blog/2013/06/29/this-week-in-rust/
[23:49:43] <cmr> http://cmr.github.io/blog/2013/06/29/this-week-in-rust/
[23:50:06] <MaikKlein> ah is
[23:50:19] <MaikKlein> tjc's talk already online (voice)?
[23:50:25] <cmr> Not that I know of
[23:50:27] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[23:50:30] <MaikKlein> :(
[23:50:55] <aatch> cmr, I'm guessing you didn't get around to doing that snapshot :P
[23:51:34] <Jeaye> cmr: Would I be able to get q3 on there if it ever becomes useful?
[23:51:36] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[23:52:09] <cmr> Jeaye: Sure, whenever you want
[23:52:13] <cmr> aatch: nope
[23:52:54] <aatch> cmr, heh, I'm just starting on one now.
[23:52:57] <cmr> and I seem to have lost my arch install disk, which minorly upsets me
[23:52:59] <MaikKlein> lol
[23:53:07] <MaikKlein> someone changed the color in the terminal
[23:53:09] <strcat> cmr: disk? just use a random drive ;p
[23:53:20] <MaikKlein> my warnings are now brown
[23:53:21] <MaikKlein> :x
[23:53:29] <cmr> strcat: that'd require actually opening the case!
[23:53:43] <strcat> cmr: you don't have a random sd card or flash drive?
[23:53:55] <cmr> no, I don't own either of those things
[23:53:57] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[23:54:00] <jmgrosen> Jeaye: you were right >.< the vertex_shader iv check thing was 1
[23:54:12] <Jeaye> Winding is another
[23:54:31] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[23:54:32] <ghrust> 01[13rust01] 15Aatch fast-forwarded 06snap-stage3 from 14f827561 to 14c86df3a: 02http://git.io/MgAKAA
[23:54:32] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[23:54:46] <strcat> anyway a custom unique pointer is 3x faster than ~
[23:54:52] <cmr> Wow!
[23:54:55] <jmgrosen> Jeaye: soâ€¦ what's wrong with the shader? :P
[23:54:55] <strcat> and uses 1/4 of the memory for small allocations
[23:54:55] <MaikKlein> oO
[23:55:05] <MaikKlein> jmgrosen, post me the shader
[23:55:06] <Jeaye> jmgrosen: What's your error?
[23:55:09] <cmr> Mostly allocation and cache overhead I imagine?
[23:55:21] <strcat> cmr: no, also overhead from all the horrible things it does
[23:55:21] <Jeaye> jmgrosen: Do the error checking properly... and it'll tell you.
[23:55:23] *** Joins: samx (sami@moz-369757A0.pp.htv.fi)
[23:55:27] <cmr> heh
[23:55:33] <Jeaye> jmgrosen: Quit bein' lazy. ;)
[23:55:41] <strcat> cmr: a 32-byte header on every allocation is a huge cost
[23:55:48] <jmgrosen> Jeaye: it told me "1"â€¦ i'm guessing that maps to an enum :P
[23:56:06] <jmgrosen> MaikKlein: the vertex_src in https://gist.github.com/jmgrosen/66a1bbf2763c5cb59518
[23:56:09] <Jeaye> jmgrosen: That's not a valid GL error, and you're not reading it properly. It's a full string.
[23:56:12] <thiez> 32-byte headers, if nothing else they make your cache cry :p
[23:56:18] <strcat> cmr: it also has an atomic counter, and that's not free
[23:56:30] <cmr> It does? What for :\
[23:56:30] <jmgrosen> Jeaye: â€¦oh X3
[23:56:33] <Jeaye> It'll have line number and column, as well as some prose, jmgrosen 
[23:56:35] <strcat> thiez: and it bumps a 16-byte allocation from the 16-byte size class to 48 byte or 64 byte
[23:56:37] <aatch> cmr, leak checking.
[23:56:43] *** Quits: samx (sami@moz-369757A0.pp.htv.fi) (Quit: This computer has gone to sleep)
[23:57:03] <thiez> aatch: why would they leak? they're ~
[23:57:16] <strcat> aatch: yeah but we run valgrind builds on the bots
[23:57:17] <MaikKlein> \n\ what is this? shouldn't it just be \n?
[23:57:24] <aatch> thiez, because you can get things wrong.
[23:57:27] <Jeaye> jmgrosen: I linked you a reference for how to check it. Other ones can be found online. This channel is not about learning OpenGL. :P
[23:57:27] <strcat> and valgrind catches leaks from other allocations
[23:57:43] <jmgrosen> Jeaye: the rust-opengles returns a GLint for it
[23:57:43] <strcat> cmr: want to benchmark something for me? ;p
[23:57:52] <thiez> perhaps we should just trust valgrind? :)
[23:58:03] <Jeaye> jmgrosen: Read the code I linked you to.
[23:58:04] <cmr> strcat: busy atm. the scripts are all on github
[23:58:09] <aatch> It has been useful for me, but valgrind would work just as well.
[23:58:12] <Jeaye> jmgrosen: https://github.com/Jeaye/q3/blob/master/src/gl/shader.rs#L252
[23:58:12] <jmgrosen> Jeaye: don't tell me anymore, i'll try to figure it out on my own now :P
[23:58:37] <mnemotic> jmgrosen: that's where you should have started :P
[23:58:46] <cmr> strcat: https://github.com/cmr/rust-bench
[23:58:51] <jmgrosen> mnemotic: quite true, my fine sir
[23:59:08] <mnemotic> verily
[23:59:14] <cmr> strcat: it wants something like `sudo cgcreate -a cmr -t cmr -g memory,cpuacct:rustbench` by default... I don't remember if the user is configurable :p
[23:59:18] <cmr> probably need to edit strings
