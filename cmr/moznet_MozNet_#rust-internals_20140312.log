[00:06:21] <acrichto> brson: r? https://github.com/mozilla/rust/pull/12818
[00:15:31] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[00:15:52] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[00:16:03] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[00:17:34] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[00:19:22] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:27:48] <huon> erickt: s/module/crate/ https://github.com/mozilla/rust/issues/11783#issuecomment-37363095 ?
[00:28:03] <erickt> huon: haha yeah
[00:28:30] <erickt> huon: edited, thanks
[00:30:33] *** Quits: ecr (chatzilla@moz-B0A20DAA.dhcp4.washington.edu) (Ping timeout)
[00:33:27] *** Joins: luz1 (luziie@moz-CD18B14B.customer.cdi.no)
[00:34:03] *** Quits: luziiie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[00:37:03] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[00:37:11] *** Quits: luz1 (luziie@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[00:37:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:37:56] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[00:38:15] *** Quits: fhahn (fhahn@moz-7924DB5C.vie.surfer.at) (Ping timeout)
[00:38:16] *** Quits: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Ping timeout)
[00:38:27] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[00:42:36] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[00:42:36] <ghrust> [13rust] 15alexcrichton merged 06auto into 06snap-stage3: 02http://git.io/1dJUkQ
[00:42:36] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[00:42:52] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[00:45:46] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[00:49:45] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[00:50:56] *** Quits: gimpf (gimpf@moz-92FB2E02.adsl.highway.telekom.at) (Client exited)
[00:51:58] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:52:49] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:52:49] *** ChanServ sets mode: +qo brson brson
[00:56:07] <cgaebel> was iterbytes just removed?
[00:56:19] <huon> replaced with Hash
[01:00:16] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[01:00:48] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Quit: huon)
[01:06:30] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[01:07:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:07:20] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[01:10:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:18:12] *** Quits: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:24:52] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:31:59] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[01:37:21] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[01:38:16] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[01:47:49] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[01:47:49] *** ChanServ sets mode: +o tjc
[01:55:37] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[01:56:51] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[01:56:59] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[01:56:59] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1454e7555 to 1474bfa71: 02http://git.io/N3iJvQ
[01:56:59] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[01:57:03] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[01:57:03] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Ql7aVQ
[01:57:03] <ghrust> 13rust/06auto 14fb5256f 15Alex Crichton: Add basic backtrace functionality...
[01:57:03] <ghrust> 13rust/06auto 142480c11 15bors: auto merge of #12602 : alexcrichton/rust/backtrace, r=brson...
[01:57:03] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[01:57:04] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[01:57:17] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[01:58:00] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Quit: leaving)
[01:59:40] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[02:00:49] *** Quits: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com) (Quit: pcwalton)
[02:01:39] *** Joins: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net)
[02:02:59] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[02:06:57] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[02:06:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 142480c11 to 1474bfa71: 02http://git.io/N3iJvQ
[02:06:57] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[02:06:58] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[02:06:58] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/LUeBkA
[02:06:58] <ghrust> 13rust/06auto 14bf222c8 15Patrick Walton: libstd: Add some methods to `Vec<T>`.
[02:06:58] <ghrust> 13rust/06auto 147a41465 15Patrick Walton: test: Automatically remove all `~[T]` from tests.
[02:06:58] <ghrust> 13rust/06auto 1438b1bf8 15Patrick Walton: test: Make manual changes to deal with the fallout from removal of...
[02:07:00] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[02:08:49] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:10:44] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:12:02] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[02:14:33] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[02:17:02] *** Joins: vadimcn_ (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[02:17:08] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[02:17:35] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[02:17:42] *** vadimcn_ is now known as vadimcn
[02:18:54] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:22:43] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:31:55] *** Joins: lpy (lpy@54AA05A8.F09091A8.1348A864.IP)
[02:31:57] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[02:31:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 147b1c700 to 1474bfa71: 02http://git.io/N3iJvQ
[02:31:57] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[02:31:58] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[02:31:58] <ghrust> [13rust] 15bors pushed 5 new commits to 06auto: 02http://git.io/5kOXRA
[02:31:58] <ghrust> 13rust/06auto 146fa4bbe 15Huon Wilson: std: Move rand to librand....
[02:31:58] <ghrust> 13rust/06auto 1415e2898 15Huon Wilson: Remove the dependence of std::io::test on rand....
[02:31:58] <ghrust> 13rust/06auto 14198caa8 15Huon Wilson: Update users for the std::rand -> librand move.
[02:32:00] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[02:32:48] <brson> i wonder if we could inspire a bunch of celebrity language designers to write posts like 'What Rust can learn from X about Y"
[02:33:14] <ChrisMorgan> Sounds like a good idea.
[02:33:25] <brson> not necessarily just language designers though, but people who are e.g. using C++ in industry
[02:35:02] *** Quits: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca) (Quit: canhtak)
[02:39:04] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[02:41:54] *** Quits: tikue (tkuehn@CB7FC854.FAD414BA.D74CC41D.IP) (Quit: tikue)
[02:48:22] <bstrie> https://github.com/rust-lang/rfcs/pull/2
[02:49:16] <bstrie> brson: maybe we can tempt guido with rust stickers and a tray of fancy cheeses
[02:49:31] * bstrie does not actually think that guido would be all that fond of rust
[02:50:16] * ChrisMorgan is curious on the matter
[02:50:19] *** Quits: lpy (lpy@54AA05A8.F09091A8.1348A864.IP) (Client exited)
[02:50:58] *** Joins: lpy (lpy@F7AFA3.F09091A8.1348A864.IP)
[02:51:20] <bstrie> brson: bartoszmilewski.com/2014/02/26/c17-i-see-a-monad-in-your-future/ and http://www.modernperlbooks.com/mt/2014/02/the-mid-career-crisis-of-the-perl-programmer.html? are both popular articles that have made rounds recently and mentioned rust in passing
[02:51:33] <bstrie> brson: might not be futile to reach out to them :)
[03:00:21] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:00:21] *** ChanServ sets mode: +ao dherman dherman
[03:02:55] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[03:07:23] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:09:17] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Ping timeout)
[03:09:29] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:15:07] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[03:15:21] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[03:27:07] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[03:36:09] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[03:37:55] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:42:02] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[03:42:02] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/5kOXRA
[03:42:02] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[03:46:56] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[03:46:56] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/ZWSJTw
[03:46:56] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[03:47:35] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[03:48:04] *** Quits: aphistic (aphistic@moz-D08A46AA.erikd.org) (Client exited)
[03:48:21] *** Quits: zz_kimundi (kimundi@moz-B5D25C17.dip0.t-ipconnect.de) (Ping timeout)
[03:48:40] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[03:51:58] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[03:51:58] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/xaqSMQ
[03:51:58] <ghrust> 13rust/06auto 147b4ee5c 15Alex Crichton: syntax: Add support for trait bounds on procs...
[03:51:58] <ghrust> 13rust/06auto 148a32ee7 15bors: auto merge of #12774 : alexcrichton/rust/proc-bounds, r=pcwalton...
[03:51:58] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[03:52:37] *** Joins: zz_kimundi (kimundi@moz-7F0BEAFC.dip0.t-ipconnect.de)
[03:52:38] *** zz_kimundi is now known as kimundi
[03:58:15] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[03:58:36] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[04:00:16] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[04:03:36] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[04:03:36] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 14f7f2f72 to 148dc0b3a: 02http://git.io/k471pw
[04:03:36] <ghrust> 13rust/06try 149a21b90 15Alex Crichton: Bundle libbacktrace with the compiler...
[04:03:36] <ghrust> 13rust/06try 148dc0b3a 15Alex Crichton: Add basic backtrace functionality...
[04:03:37] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[04:06:45] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[04:07:23] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:09:28] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:15:36] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[04:16:38] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[04:18:43] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[04:19:30] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:21:26] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[04:22:45] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:33:21] *** Joins: nrc (nrc@C6E9F232.74528455.3CFEB252.IP)
[04:34:19] <nrc> Who can tell me what the colon in this line is for? https://github.com/mozilla/rust/blob/master/src/libsyntax/parse/lexer.rs#L32
[04:34:34] <nrc> that's `fn dup(&self) -> ~Reader:;`
[04:34:43] <nrc> where `Reader` is a trait
[04:36:06] <nrc> there seem to be eight instances of this mysterious pattern in the rust compiler, but I can't see how it even parses, let alone what it means
[04:36:30] <sfackler> nrc: It says that there aren't any kind bounds on the ~Reader
[04:36:43] <sfackler> you can have things like ~Reader:'static+Freeze for example
[04:36:56] <sfackler> ~Reader is equivalent to ~Reader:Send, though that should be changing soon
[04:37:29] <nrc> sfackler: huh, so you can spacify kind bounds on actual types, not just formal type parameters?
[04:37:53] <sfackler> this is specifically for a trait object
[04:38:19] <nrc> oh, right, I see
[04:39:16] <nrc> and indeed there are two instances of trait:static
[04:40:12] <nrc> thanks sfackler!
[04:41:48] *** Quits: nrc (nrc@C6E9F232.74528455.3CFEB252.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140311030201])
[04:45:53] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:57:00] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:57:33] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[04:57:33] <ghrust> [13rust] 15alexcrichton 04force-pushed 06snap-stage3 from 1454e7555 to 148a32ee7: 02http://git.io/f3Qwfg
[04:57:33] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[05:02:05] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[05:02:05] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/xaqSMQ
[05:02:05] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[05:06:58] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[05:06:58] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/CR5Q_g
[05:06:58] <ghrust> 13rust/06auto 14be1afb5 15Alex Crichton: Add basic backtrace functionality...
[05:06:58] <ghrust> 13rust/06auto 145c8adc9 15bors: auto merge of #12602 : alexcrichton/rust/backtrace, r=brson...
[05:06:59] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[05:07:01] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[05:07:01] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/9CDgqw
[05:07:01] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[05:07:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:09:31] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:14:01] *** Quits: lpy (lpy@F7AFA3.F09091A8.1348A864.IP) (Ping timeout)
[05:29:34] *** Quits: eibwen (kvirc@moz-4DC959C4.dip0.t-ipconnect.de) (Ping timeout)
[05:30:09] *** Joins: lpy (lpy@D4DF2483.F09091A8.1348A864.IP)
[05:31:55] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[05:31:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 145c8adc9 to 148a32ee7: 02http://git.io/N3iJvQ
[05:31:55] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[05:31:56] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[05:31:56] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/fJMLMA
[05:31:56] <ghrust> 13rust/06auto 140349f2a 15Piotr Czarnecki: libstd: Change `slice_shift_char`, `shift_char`, `pop_char`, `shift_byte` and `pop_byte` to return an Option instead of failing
[05:31:56] <ghrust> 13rust/06auto 14262d154 15Piotr Czarnecki: libstd: Add unit tests for `slice_shift_char`
[05:31:57] <ghrust> 13rust/06auto 14b0e855a 15Piotr Czarnecki: libstd: Update docs for `slice_shift_char` and {shift,pop}_{char,byte}
[05:31:59] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[05:37:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[05:43:58] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[05:44:28] <eddyb> nmatsakis: r? I don't see anything :S
[05:45:04] <eddyb> I was fearing "oh but you need the other 10 ten tests you forgot about"
[05:48:04] <cmr> I pushed separate-libc to try a bit ago.
[05:48:11] <cmr> Maybe over the weekend...
[05:48:18] <cmr> is it gone from the buildbot history?
[05:48:36] <eddyb> there was the android fiasco
[05:48:49] <eddyb> maybe part of the logs were wiped in the process?
[05:49:36] <eddyb> I almost feel like I should ask for r=nmatsakis on https://github.com/mozilla/rust/pull/12610
[05:49:42] <eddyb> where's pcwalton :P?
[05:50:07] <eddyb> my autoderef snapshot is like two weeks overdue :(
[05:51:02] <eddyb> btw... I want an RcRef<'a, T>
[05:51:56] <eddyb> which is like &'a T obtained from an Rc<T>, and it allows you to clone an Rc handle from it, as with &Rc<T>, but without the extra indirection
[05:52:07] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[05:52:20] <eddyb> I wish we could encode this without an extra type
[05:54:36] *** Joins: edwardw (edwardw@E6E87FA7.354F6412.B9C6B12A.IP)
[05:58:13] <eddyb> rusti: let listed_elements = ["button", "fieldset", "input", "keygen", "object", "output", "select", "textarea"]; (~[~"foo", ~"select"]).iter().filter(|elem| listed_elements.contains(&elem.as_slice())).to_owned_vec()
[05:58:16] -rusti- pastebinned 16 lines of output: http://sprunge.us/AUDh
[05:58:34] <eddyb> rusti: let listed_elements = ["button", "fieldset", "input", "keygen", "object", "output", "select", "textarea"]; let v = ~[~"foo", ~"select"]; v.iter().filter(|elem| listed_elements.contains(&elem.as_slice())).to_owned_vec()
[05:58:34] -rusti- pastebinned 16 lines of output: http://sprunge.us/UDad
[05:58:54] <eddyb> rusti: let listed_elements = ["button", "fieldset", "input", "keygen", "object", "output", "select", "textarea"]; (~[~"foo", ~"select"]).move_iter().filter(|elem| listed_elements.contains(&elem.as_slice())).to_owned_vec()
[05:58:56] -rusti- pastebinned 17 lines of output: http://sprunge.us/JObV
[05:59:45] *** Joins: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP)
[06:00:41] <cmr> eddyb: PM it
[06:01:06] <eddyb> cmr: now all I'm missing is someone from a different channel to say the same thing
[06:07:00] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[06:07:00] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1409dad0a to 148a32ee7: 02http://git.io/N3iJvQ
[06:07:00] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[06:07:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:09:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:21:10] <eddyb> edwardw: did you fix that Self issue?
[06:21:21] <edwardw> yes I did
[06:21:33] <edwardw> #12828
[06:21:41] *** Joins: luziiie (luziie@moz-CD18B14B.customer.cdi.no)
[06:21:44] <eddyb> edwardw: can you check if this works (if you have it built): let list = ["foo", "bar"]; ~[~"foo", ~"baz"].move_iter().filter(|x| list.contains(&x.as_slice())).to_owned_vec()
[06:21:47] <edwardw> the Self here refers to self type parameter
[06:21:59] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:22:10] <eddyb> (I don't consider it to be a type parameter but rather the "target" of trait implementation)
[06:22:13] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[06:22:19] <eddyb> edwardw: because I feel like it's the same issue
[06:22:35] <edwardw> lemme try that locaaly
[06:22:43] <edwardw> *locally
[06:25:37] <eddyb> nmatsakis: I wonder it would be a sane idea to allow numeric upcasts, based on variance
[06:26:08] <eddyb> so u8 <: u16 <: u32 <: u64
[06:26:22] <eddyb> and u32 <: uint
[06:26:28] <edwardw> rusti: let list = [~"foo", ~"bar"]; (~[~"foo", ~"baz"]).move_iter().filter(|x| list.contains(&x.to_owned())).to_owned_vec()
[06:26:29] -rusti- ~[~"foo"]
[06:26:41] <eddyb> no, don't do that :P
[06:26:41] <edwardw> otherwise it couldn't work for me
[06:26:59] <eddyb> okay so it's not the same issue. thanks anyways
[06:27:16] <edwardw> np
[06:27:42] <eddyb> (I'm guessing the lifetime gets fixed by the concrete 'static, instead of being left for inference)
[06:28:28] <eddyb> (should we use "infer wrt 'static" instead of 'static?)
[06:28:40] <ChrisMorgan> eddyb: "u32 <: uint"? What about using Rust on 16-bit microprocessors?
[06:28:46] <eddyb> sorry :S
[06:29:35] <eddyb> I wonder if we could make graphs out of this stuff... u8 <: i16 and whatnot
[06:30:56] *** Quits: lpy (lpy@D4DF2483.F09091A8.1348A864.IP) (Ping timeout)
[06:36:55] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[06:36:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14fbd790b to 148a32ee7: 02http://git.io/N3iJvQ
[06:36:55] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[06:36:55] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[06:36:55] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/4AcKjA
[06:36:55] <ghrust> 13rust/06auto 140349f2a 15Piotr Czarnecki: libstd: Change `slice_shift_char`, `shift_char`, `pop_char`, `shift_byte` and `pop_byte` to return an Option instead of failing
[06:36:55] <ghrust> 13rust/06auto 14262d154 15Piotr Czarnecki: libstd: Add unit tests for `slice_shift_char`
[06:36:57] <ghrust> 13rust/06auto 14b0e855a 15Piotr Czarnecki: libstd: Update docs for `slice_shift_char` and {shift,pop}_{char,byte}
[06:37:00] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[06:37:28] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[06:48:32] *** Joins: lpy (lpy@D4DF2483.F09091A8.1348A864.IP)
[06:50:39] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[07:03:01] *** Quits: edwardw (edwardw@E6E87FA7.354F6412.B9C6B12A.IP) (Ping timeout)
[07:04:07] *** Joins: edwardw (edwardw@CBC31673.351D1665.B9C6B12A.IP)
[07:07:19] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:09:29] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:12:39] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[07:12:39] *** ChanServ sets mode: +o huon
[07:21:17] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:22:44] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[07:23:04] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:25:00] *** flaper87|afk is now known as flaper87
[07:25:07] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[07:26:25] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[07:26:30] <flaper87> o/
[07:26:58] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[07:28:40] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[07:32:03] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[07:32:03] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14acf8a8d to 148a32ee7: 02http://git.io/N3iJvQ
[07:32:03] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[07:32:04] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[07:32:04] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/gfXh7g
[07:32:04] <ghrust> 13rust/06auto 14486a25a 15Alex Crichton: test: Relax a debuginfo test...
[07:32:04] <ghrust> 13rust/06auto 14397abb7 15bors: auto merge of #12839 : alexcrichton/rust/fix-snap, r=huonw...
[07:32:05] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[07:38:17] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[07:46:05] *** Quits: lpy (lpy@D4DF2483.F09091A8.1348A864.IP) (Client exited)
[07:49:17] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:51:12] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[08:01:34] *** Joins: lpy (lpy@F7AFA3.F09091A8.1348A864.IP)
[08:03:28] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[08:05:08] *** Quits: edwardw (edwardw@CBC31673.351D1665.B9C6B12A.IP) (Quit: Leaving...)
[08:07:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:08:27] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[08:09:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:15:10] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[08:19:24] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:24:44] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:25:03] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:25:18] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[08:33:48] *** Quits: ecr (chatzilla@7C463196.5BB0586B.11F8506F.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 28.0/20140306171728])
[08:40:21] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:40:52] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:41:55] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[08:46:55] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[08:46:55] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/gfXh7g
[08:46:55] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[08:51:56] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[08:51:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/AjPrbg
[08:51:56] <ghrust> 13rust/06auto 14f498c0e 15Alex Crichton: Add basic backtrace functionality...
[08:51:56] <ghrust> 13rust/06auto 1424db5bb 15bors: auto merge of #12602 : alexcrichton/rust/backtrace, r=brson...
[08:51:56] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[08:51:58] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[08:51:58] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/_EpWWQ
[08:51:58] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[08:56:05] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[08:57:01] *** Joins: gimpf (gimpf@moz-648EA225.adsl.highway.telekom.at)
[09:07:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:08:19] *** Quits: fhahn (fhahn@moz-7924DB5C.vie.surfer.at) (Ping timeout)
[09:08:52] *** Quits: lpy (lpy@F7AFA3.F09091A8.1348A864.IP) (Ping timeout)
[09:09:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:15:39] <eddyb> rusti: format!("{: 8i}", 42)
[09:15:40] -rusti- <anon>:10:17: 10:25 error: invalid format string: expected `}` but found `8`
[09:15:40] -rusti- <anon>:10         format!("{: 8i}", 42)
[09:15:40] -rusti-                           ^~~~~~~~
[09:15:40] -rusti- error: aborting due to previous error
[09:15:40] -rusti- application terminated with error code 101
[09:15:56] <eddyb> rusti: format!("{:08i}", 42)
[09:15:56] -rusti- ~"00000042"
[09:16:00] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[09:16:02] <eddyb> rusti: format!("{:> 8i}", 42)
[09:16:02] -rusti- <anon>:10:17: 10:26 error: invalid format string: expected `}` but found `8`
[09:16:03] -rusti- <anon>:10         format!("{:> 8i}", 42)
[09:16:03] -rusti-                           ^~~~~~~~~
[09:16:03] -rusti- error: aborting due to previous error
[09:16:03] -rusti- application terminated with error code 101
[09:16:07] <eddyb> rusti: format!("{:< 8i}", 42)
[09:16:07] -rusti- <anon>:10:17: 10:26 error: invalid format string: expected `}` but found `8`
[09:16:07] -rusti- <anon>:10         format!("{:< 8i}", 42)
[09:16:08] -rusti-                           ^~~~~~~~~
[09:16:10] -rusti- error: aborting due to previous error
[09:16:12] -rusti- application terminated with error code 101
[09:16:13] <eddyb> hmpf, what's the syntax?
[09:16:15] <eddyb> rusti: format!("{:<8i}", 42)
[09:16:16] -rusti- ~"42      "
[09:16:19] <eddyb> rusti: format!("{:>8i}", 42)
[09:16:19] -rusti- ~"      42"
[09:16:23] <eddyb> there we go :D
[09:31:57] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[09:31:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1424db5bb to 14397abb7: 02http://git.io/N3iJvQ
[09:31:57] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[09:32:01] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[09:32:01] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/9FENgA
[09:32:01] <ghrust> 13rust/06auto 140349f2a 15Piotr Czarnecki: libstd: Change `slice_shift_char`, `shift_char`, `pop_char`, `shift_byte` and `pop_byte` to return an Option instead of failing
[09:32:01] <ghrust> 13rust/06auto 14262d154 15Piotr Czarnecki: libstd: Add unit tests for `slice_shift_char`
[09:32:03] <ghrust> 13rust/06auto 14b0e855a 15Piotr Czarnecki: libstd: Update docs for `slice_shift_char` and {shift,pop}_{char,byte}
[09:32:05] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[09:33:46] <eddyb> stats::report(tcx); // now let's fire it up
[09:38:58] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:39:55] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[09:40:16] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:41:58] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[09:44:21] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:46:24] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[09:50:56] *** Joins: lpy (lpy@DF47E728.25165A39.3F03179E.IP)
[09:52:10] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[09:52:38] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:53:23] *** Joins: lpy_ (lpy@32DE1D6C.56B853B.8C13C571.IP)
[09:54:27] *** Quits: lpy (lpy@DF47E728.25165A39.3F03179E.IP) (Ping timeout)
[09:56:35] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[09:56:53] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:57:47] <pnkfelix> hmm, print! of "{:?}" has become less useful with the switch to vec_ng::Vec.
[10:01:41] <eddyb> [BUG] found empty ty_tup in the interner (should be ty_nil)
[10:01:55] <eddyb> this is paying off already
[10:02:11] <eddyb> tcx interner has 494599 types (each taking 192 bytes, so 90.564MB total, not including indirect storage):
[10:02:19] <eddyb> O_O and that's just libstd
[10:03:02] <eddyb> but I screwed up the has_infer check so I have to do it again
[10:03:59] <eddyb> if I had some patience, I could compute indirect storage waste as well
[10:04:41] <huon> pnkfelix: yeah, that's what's making me think removing :? entirely might not be so bad
[10:04:49] <huon> (and Rc and Gc, etc.)
[10:05:12] <eddyb> problem is Show may not have enough debugging info
[10:05:22] <pnkfelix> huon: wait, how did Rc/Gc come into this?
[10:05:30] <huon> pnkfelix: they have the same problem
[10:05:33] <pnkfelix> huon: oh I se
[10:05:34] <pnkfelix> see
[10:05:34] <eddyb> not anymore
[10:05:43] <huon> rusti: print!("{:?}", std::rc::Rc::new(1))
[10:05:44] -rusti- std::rc::Rc<int>{ptr: (0x7f2cb0000dc0 as *mut ()), marker: std::kinds::marker::NoSend}()
[10:05:47] <eddyb> well, {:?} maybe
[10:06:00] <huon> eddyb: yes, we're talking about :? specifically
[10:06:03] <eddyb> huon: nevermind I was thinking of something else
[10:06:45] <pnkfelix> huon: I still want to try to keep {:?}, though I do think the implementation should change, and probably should be factored into a separate crate.  I talked with acrichto about this briefly last week.
[10:06:46] <eddyb> if we change things around in formatting macro expansions, it should be able to pass through overloaded deref
[10:06:53] <eddyb> and then everything works, not just Show
[10:07:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:07:31] <eddyb> pnkfelix: I had some plans as well, replacing methods taking *TyDesc with generic methods and using more CPS >_>
[10:07:37] <huon> pnkfelix: I guess I should say "removing :?'s current implementation", since it's not so useful
[10:07:45] <huon> rather than removing it completely
[10:07:53] <eddyb> TyVisitor would be cool if it weren't so useless
[10:08:15] <eddyb> a generic implementation can be const-eval'd
[10:09:00] <pnkfelix> eddyb: I'm not sure if your ideas for *TyDesc are aligned with what I was thinking for {:?}
[10:09:26] <pnkfelix> eddyb: In particular, my main goal was to change things to minimize the burden it presents at compile time
[10:09:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:09:46] <pnkfelix> eddyb: at the cost of making {:?} more expensive at runtime
[10:09:47] <eddyb> monomorphization could still be a burden
[10:09:55] <eddyb> pnkfelix: oh that's the opposite direction
[10:10:06] <eddyb> it's already much more expensive than Show
[10:10:29] <pnkfelix> eddyb: making it non-monomorphizing was part of the plan I was thinking of
[10:10:37] *** Quits: lpy_ (lpy@32DE1D6C.56B853B.8C13C571.IP) (Ping timeout)
[10:10:46] *** Joins: lpy (lpy@81C4458B.25165A39.3F03179E.IP)
[10:10:53] <eddyb> it's already partly non-monomorphizing (TyDesc and visitor_glue)
[10:11:05] <eddyb> but that's not necessarily a good thing
[10:11:39] <pnkfelix> anyway, the things I've been thinking about wouldn't address this issue with native pointers
[10:11:44] <eddyb> though my version should technically remove visitor glue
[10:11:51] <eddyb> pnkfelix: mine *could*
[10:12:13] <eddyb> by explicitly implementing a trait for Rc. or having an attribute to go through Deref instead
[10:12:36] <eddyb> though "@Rc[refcount] value" wouldn't be a bad thing to have
[10:13:10] <pnkfelix> anyone in here have any idea how bad it would be to try to make Expr derive Show ?
[10:13:26] <pnkfelix> (even for local debugging, that is)
[10:13:39] <eddyb> I think Item is the root
[10:14:21] <huon> pnkfelix: bad in terms of code size?
[10:14:30] <eddyb> pnkfelix: you won't find until you try it. should be limited to libsyntax though
[10:14:39] <eddyb>   430603 types contain inference variables
[10:14:47] <pnkfelix> huon: bad in terms of everything.  Number of spots to update in the code, etc.
[10:15:01] <pnkfelix> huon: Code size would be a concern if I was going to put up a PR with it
[10:15:03] <eddyb> rusti: 430603.0 / 494885.0
[10:15:04] -rusti- 0.870107f64
[10:15:12] <pnkfelix> huon: but right now I'm more just thinking of doing it locally
[10:15:20] <eddyb> 87% of our types can be discarded microseconds after their creation
[10:15:21] <pnkfelix> huon: since {:?} is not as useful as I would like.
[10:15:24] <eddyb> I was right \o/
[10:15:58] <eddyb> pnkfelix: do you want to use pprust for this?
[10:16:03] <pnkfelix> eddyb: what are you going to do, make the interning have a generational element?
[10:16:10] <huon> pnkfelix: I think it would make the whole AST except for ast::Crate require a deriving(Show)
[10:16:17] <huon> (well,  Show impl of some sort)
[10:16:23] <pnkfelix> eddyb: pprust shows you something approximating the original source, right?  I want to see the underlying structure.
[10:16:38] <eddyb> riight
[10:16:57] <eddyb> pnkfelix: no, just using a per-function interner for has_infer types
[10:17:04] <eddyb> with an arena that can be dropped ASAP
[10:17:15] <eddyb> can't wait to see the stats on stage2 librustc
[10:18:50] <huon> pnkfelix: assuming you're happy with a derived Show everywhere, I'd just guess it's just adding Show to the various ast structs
[10:18:58] <pnkfelix> huon: yeah I'm doing that now
[10:19:07] <pnkfelix> huon: was debating about whether to do it blindly
[10:19:23] <pnkfelix> huon: or attempt to find the minimal set via iteration
[10:19:38] <eddyb> pnkfelix: you can have a macro to derive Show to delegate to .node
[10:19:50] <eddyb> to remove the Span from Spanned<T>
[10:21:01] <huon> pnkfelix: Expr transitively includes modules which include functions, view items, types etc... so I have a feeling the minimal set will be most of the ast module
[10:21:21] <pnkfelix> huon: yeah, i will probably switch to blind addition of Show soon
[10:21:32] <eddyb> rusti: 1085634.0 / 1085634.0 * 100.0
[10:21:34] -rusti- 100f64
[10:21:40] <eddyb> err
[10:21:47] <eddyb> rusti: 1085634.0 / 1209187.0 * 100.0
[10:21:48] -rusti- 89.782143f64
[10:21:57] <pnkfelix> eddyb: So, what is your proposal again for making {:?} work with Vec?  I can understand how integrating Deref will help fix Rc<T>/Gc<T>, but it won't address Vec, no?
[10:21:58] <eddyb> 90% garbage. gj
[10:22:14] <eddyb> pnkfelix: there the trait-based option would work best
[10:22:32] <pnkfelix> eddyb: where structures opt into providing their own impl for {:?} ?
[10:22:36] <huon> sounds like the Show trait :P
[10:22:40] <pnkfelix> eddyb: At that point it really sounds like SHow
[10:22:47] <eddyb> pnkfelix: but it's a proxy, instead
[10:22:49] <pnkfelix> I guess I didn't need to hit enter
[10:23:09] <huon> https://github.com/mozilla/rust/issues/12128 btw
[10:23:10] <eddyb> it's only useful if you want to keep {:?} alive
[10:23:21] <huon> (re deriving(Show) being used for debugging)
[10:23:30] <eddyb> auto-derived and with more debug info
[10:23:46] <pnkfelix> I see.
[10:23:55] <huon> Oh, I never saw acrichto's comment
[10:24:03] <eddyb> the alternate output does sound like what I'd want
[10:24:06] <pnkfelix> The fact that you couldn't override behavior was a selling point of {:?} for me.
[10:24:13] <pnkfelix> though perhaps not for others
[10:24:27] <eddyb> it's good for ADTs, bad for abstractions
[10:25:27] <eddyb> nmatsakis, pnkfelix, huon, cmr: omlette du garbage: https://gist.github.com/eddyb/20fb641bc5e3794049da
[10:25:39] <eddyb> that's at least 400MB
[10:26:22] <pnkfelix> eddyb: so how are you determining which ones are unused?
[10:26:30] <eddyb> pnkfelix: has_infer
[10:26:46] <eddyb> those are per-function and stop being used after writeback
[10:26:56] <eddyb> well, maybe not 400. but still, 221MB is quite lower than the actual used space
[10:26:56] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[10:26:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/DQpvaA
[10:26:56] <ghrust> 13rust/06auto 14054e237 15Alex Crichton: std: Relax an assertion in oneshot selection...
[10:26:56] <ghrust> 13rust/06auto 14f44931e 15bors: auto merge of #12803 : alexcrichton/rust/issue-12802, r=brson...
[10:26:56] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[10:26:57] <pnkfelix> eddyb: I'm missing context, is there an issue discussing this?
[10:27:03] <eddyb> nope, just a hunch
[10:27:14] <eddyb> a hunch that will be massively paying off
[10:27:15] <pnkfelix> eddyb: i mean e.g. for what `has_infer` means
[10:27:54] <eddyb> pnkfelix: it means the type (or anything the type contains, recursively) has a ty_infer (type infer variable) or a ReInfer (region infer variable)
[10:28:33] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Client exited)
[10:28:45] <pnkfelix> eddyb: and therefore its instantiation cannot live beyond ... the scope of its instantiation?
[10:29:13] <eddyb> which is a type-checking function context
[10:29:55] <eddyb> it starts by typing the AST with ty_infer/ReInfer and it ends by resolving all the type & region variables and writing them to the NodeId -> type map
[10:30:31] <eddyb> I think this can speed up type checking a lot, since wasting space is not a cheap operation
[10:31:50] <eddyb> pretty sure that interner has a capacity of 2 * 1024 * 1024
[10:32:33] <eddyb> h % self.buckets.len()
[10:32:39] <eddyb> erm, what?
[10:32:53] <eddyb> why are we using modulo in our hashmap?
[10:33:51] <eddyb> I mean, I don't know that much about these things, but isn't it supposed to maintain the invariant that there are 2^n buckets and do h & (self.buckets.len() - 1) instead?
[10:34:56] <pnkfelix> eddyb: I'm not sure we maintain that invariant
[10:35:04] <eddyb> bwahaha
[10:35:08] <pnkfelix> eddyb: expand tries to preseve it
[10:35:17] <eddyb> so we use about 64MB
[10:35:21] <pnkfelix> eddyb: but looking at resize, it seems like we allow for arbitrary capacity
[10:35:25] <eddyb> just to hold the buckets
[10:35:54] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[10:36:09] <eddyb> I'm now doubt that previous 400MB was an overestimation
[10:36:27] <pnkfelix> eddyb: and with_capacity also seems to allow for an arbitrary non-power-of-two
[10:36:44] <eddyb> pnkfelix: I figured. but next_pow_2 is pretty easy to do
[10:37:01] <pnkfelix> eddyb: Its not necessarily about the difficulty of computing powers of two
[10:37:03] <eddyb> I would've been happy with 50% garbage... 90% is a gift
[10:37:11] <eddyb> pnkfelix: but space wasted. I know
[10:37:13] <huon> the new hashmap maintains the power of two invariant
[10:37:22] <eddyb> huon: and does cheap addressing?
[10:37:36] <huon> i.e. & bitmask instead of % n ?
[10:37:38] <huon> yes
[10:37:39] <eddyb> yeah
[10:37:48] <eddyb> <3 cgabel
[10:37:56] <eddyb> wait, the current hashmap doesn't even allow for collisions?
[10:37:57] <huon> *cgaebel
[10:38:06] <huon> sure it does
[10:38:20] <eddyb> buckets: Vec<Option<Bucket<K, V>>>
[10:38:38] <eddyb> looks like a maximum of 1 entry per bucket
[10:38:56] *** Joins: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de)
[10:38:56] <huon> linear probing
[10:38:59] <pnkfelix> eddyb: its an open-addressing
[10:39:06] <huon> colliding entries are stored in the next slot
[10:39:19] <huon> (and the next one after that, etc. etc.)
[10:39:25] <pnkfelix> huon: is that right, we use linear probing?  I hadn't looked
[10:39:33] <eddyb> huon: that sounds... wrong
[10:39:56] <huon> eddyb: it's a standard hashmap implementation ;P
[10:40:02] <eddyb> a bad standard one?
[10:40:03] <huon> pnkfelix: I may have the jargon wrong...
[10:40:07] <huon> eddyb: why is it bad?
[10:40:12] <pnkfelix> huon: no you are right, it does look like linear probing
[10:40:18] <pnkfelix> huon: from looking at next_bucket
[10:40:23] <huon> eddyb: it's asymptotically the same
[10:40:29] <eddyb> how can that be?
[10:40:32] <huon> and requires fewer allocations
[10:40:42] <pnkfelix> huon: but I had thought linear probing was known to be bad compared to the alternatives
[10:40:49] <eddyb> well, let me point out that the current implementation does a modulo per bucket during linear probing
[10:40:58] <eddyb> pnkfelix: me too, knowing what it actually does
[10:41:05] * huon points at cgaebel's PR
[10:41:12] <huon> this discussion is moot :P
[10:41:22] <eddyb> right, I'm happy for that
[10:41:37] <eddyb> now let's purge the tcx of all inference sins
[10:42:09] <eddyb> pnkfelix: did that PR that allows lifetimes in traits go through?
[10:42:27] <eddyb> I want to remove some of the hacks I had to use to work around that issue
[10:42:50] <huon> it's in the queue now
[10:43:04] <eddyb> I think we need to switch to an arena first
[10:43:30] <eddyb> since allocating and freeing an object as big as t_box_ on the heap isn't going to help much
[10:44:01] <pnkfelix> huon: hmm, skimming knuth, it seems like linear probing may be okay if you ensure your load factor is < 75%.  Which is the policy this code follows.  Anyway, as you said, conservation is moot.
[10:44:39] <eddyb> so, by far, structures are the most prevalent type
[10:45:19] <eddyb> that means we have to keep their total reachable size small
[10:46:04] <eddyb> but, say, these three could totally have indirection, if that helps t_box_ get smaller https://gist.github.com/eddyb/20fb641bc5e3794049da#file-librustc-L9-L11
[10:47:54] <eddyb> ClosureTy is probably the main culprit for the 192 byte size
[10:54:22] <kimundi> Hm, I'm struggling to find a good name for `_` in a type context
[10:54:36] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[10:54:39] <eddyb> inference hole?
[10:54:44] <eddyb> placeholder?
[10:55:47] <pnkfelix> +1 to placeholder.  (I'm trying to think of something with fewer syllables, but I don't like "wildcard"...)
[10:56:06] <kimundi> type hole?
[10:56:06] <pnkfelix> (plus I guess "wildcard" has the same # of syllables...)
[10:56:57] <kimundi> For context, see the two line comments at the bottom of https://github.com/mozilla/rust/pull/12764
[10:57:09] <kimundi> For both, I need a good name for the darn thing :)
[10:57:45] <huon> haskell has things called "type holes" http://www.haskell.org/haskellwiki/GHC/TypeHoles
[10:58:07] <huon> they're not quite the same
[10:58:22] <huon> maybe an argument against call it "type hole"
[10:58:27] <eddyb> haha
[10:58:35] <pnkfelix> we use "placeholder" to describe `_` in rust.md
[10:58:40] <huon> eddyb: ?
[10:58:49] <pnkfelix> so I think "type placeholder" would be fine
[10:59:21] <eddyb> "I'm confused!" every time I read Haskell code
[10:59:40] <eddyb> "...a hole in the definition, which is designated by the same syntax for wildcard patterns, _"
[10:59:54] <huon> eddyb: fwiw, I'd recommend learning enough haskell to at least be able to read it; it's a neat language :)
[11:00:11] * huon likes "placeholder"
[11:00:37] <eddyb> I can tokenize it but not understand the flow
[11:00:49] <eddyb> well, I can understand simple recursive functions, but I easily overflow
[11:01:08] <huon> that doesn't change my statement :)
[11:01:24] <kimundi> Does "the type placeholder `_` is not allowed on item signatures, because global inference is unsupported by design." sound like a good error message? Or is it to verbose?
[11:01:26] <eddyb> s/learning/training/
[11:02:15] <huon> kimundi: I'd be happy to skip the "because ..." bit, and defer that to our error diagnostics registry
[11:02:19] <huon> (if/when we get one)
[11:02:20] <pnkfelix> kimundi: I'd say "because global _type_ inference is unsupported .."
[11:02:27] <pnkfelix> kimundi: or do what huon said
[11:02:53] <kimundi> Right, we get some kind of error registry. "the type placeholder `_` is not allowed on item signatures."?
[11:03:02] <pnkfelix> kimundi: also, since you can use the data placeholder `_`  in item signatures, ...
[11:03:15] <pnkfelix> kimundi: maybe say "the type placeholder `_` is not allowed within types on item signatures" ?
[11:03:27] <huon> kimundi: that error message includes `struct Foo { x: _ }` etc. right?
[11:03:34] <huon> (do you have a test for that, btw?)
[11:03:49] <kimundi> huon: It should include that, and I haven't a test yet
[11:03:55] * kimundi writes one
[11:06:10] <kimundi> pnkfelix: "type placeholder" already implies that, no?
[11:07:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:09:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:09:48] <pnkfelix> kimundi: <shrug>
[11:09:51] <kimundi> Hm, does someone know a nice command-line-ish way to rename a few files of the format foo_{a, b, c, d}.rs into bar_{a, b, c, d}.rs
[11:10:12] <huon> rename s/^foo/bar/ foo_*
[11:10:17] <kimundi> "the type placeholder `_` is not allowed within types on item signatures" sounds good though, I'll take it
[11:10:20] <huon> assuming you have the rename utility
[11:10:53] <kimundi> apparently I have
[11:10:58] <pnkfelix> kimundi: a for loop in bash?  e.g. `for i in a b c d ; do mv foo_$i.rs bar_$i.rs ; done`
[11:12:07] <kimundi> pnkfelix: okay bad example from me, its not literally "a", "b", "c"... :P
[11:12:40] <pnkfelix> kimundi: well my point was more about whether you were willing to list out the suffixes explicitly
[11:12:51] <pnkfelix> kimundi: sounds like you have too many for that to be a good plan
[11:13:33] *** Quits: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de) (Ping timeout)
[11:14:55] <kimundi> well, the goal here for me is to perform the action more easily than manually typing out 4 different file names ;) - the "rename" way fulfills that requirement nicely
[11:15:08] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[11:16:28] <kimundi> One could argue that the time it costed all three of us to talk about it took longer than typing it out, but eh.
[11:17:00] <huon> we all learn something
[11:17:14] <pnkfelix> indeed.  e.g., I learned that I do not have a `rename` command
[11:17:26] <huon> I learnt that kimundi does
[11:18:05] * huon files that away for the Rust-contributors trivia quiz that is sure to happen at some point in the future; right?
[11:18:53] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:19:25] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[11:21:41] <eddyb> https://ghc.haskell.org/trac/ghc/ticket/8854 hah
[11:21:58] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[11:21:58] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14f44931e to 14397abb7: 02http://git.io/N3iJvQ
[11:21:58] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[11:21:58] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[11:21:58] <ghrust> [13rust] 15bors pushed 7 new commits to 06auto: 02http://git.io/AiS0dA
[11:21:58] <ghrust> 13rust/06auto 14da19563 15Felix S. Klock II: Port partition method from ~[T] to Vec<T>, for use early-late lifetime code.
[11:21:58] <ghrust> 13rust/06auto 14460ca4f 15Felix S. Klock II: Alpha-rename `.ident` fields of type `Name` to `.name`.
[11:21:59] <ghrust> 13rust/06auto 14189c008 15Felix S. Klock II: alpha-rename .ident to .name in Lifetime, including in rustdoc.
[11:22:01] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[11:22:04] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Ping timeout)
[11:22:09] <eddyb> please pass
[11:22:13] * pnkfelix crosses fingers
[11:22:51] <eddyb> coercion seems to clone expensive resources
[11:23:02] <eddyb> ntz ntz
[11:23:22] <pnkfelix> ntz?
[11:23:25] <huon> eddyb: Rust would have the same problem?
[11:23:55] <huon> (cf. https://github.com/mozilla/rust/issues/7771 )
[11:24:02] <eddyb> now I'm not sure I know what you're talking about - even worse, I'm not sure you know what I'm talking about
[11:24:25] <huon> eddyb: I don't understand why that GHC bug is funny
[11:24:37] <huon> or worth pointing out at all, in fact
[11:24:45] <eddyb> oh, it wasn't a laugh, more like an interesting sight
[11:25:00] <eddyb> and now I know about an interesting rust issue!
[11:25:53] * huon has been talking to himself on #7771 :(
[11:26:10] <kimundi> huon: Do you know why rename "s/^type_hole/type_placeholder/" src/test/compile-fail/type_hole_* would not work?
[11:26:42] <pnkfelix> kimundi: Just a guess, but doesn't the ^ in `^type_hole` mean that it needs to be at the beginning of the path
[11:26:50] <huon> kimundi: I'd guess the regex applies to the whole path, not just the file name
[11:26:52] <kimundi> ah
[11:27:20] <kimundi> ... nope removing the ^ does not work either
[11:27:23] <kimundi> hmm
[11:27:44] <eddyb> I'd quote the path
[11:27:57] <huon> kimundi: `rename -v`
[11:28:12] <huon> iirc, there's several different utilities called "rename" that do different things
[11:28:16] <kimundi> huon: that does literally print nothing
[11:28:20] <kimundi> ah
[11:28:30] <kimundi> Usage:
[11:28:30] <kimundi>  rename [options] expression replacement file...
[11:28:46] <huon> mine's `Usage: rename [-v] [-n] [-f] perlexpr [filenames]`
[11:28:50] <eddyb> lol
[11:28:57] <eddyb> I've only seen's kimundi's version
[11:29:00] <pnkfelix> kimundi: there is always the option of cd'ing into the directories of interest
[11:29:14] * huon guesses using a bash loop would've been fater...
[11:29:22] <huon> *faster
[11:29:24] <eddyb> For more details see rename(1).
[11:29:24] <pnkfelix> victory!
[11:29:39] <eddyb> huon: what's yours say for man?
[11:30:16] <kimundi> AT this point, doing it manually would definitly be faster, but I want to know whats going wrong here now :)
[11:30:23] * huon pastes the whole man page into IRC
[11:30:25] <huon> ;P
[11:30:36] <eddyb> huon: I mean, what's the man reference?
[11:30:44] <kimundi> aah
[11:30:48] <kimundi> of course
[11:31:06] <kimundi> should actually _read_ the help description
[11:31:18] <huon> eddyb: rename(1) also
[11:31:26] <eddyb> huon: ohh, odd then
[11:31:27] <kimundi> "rename -v hole placeholder ./*.rs" is the way I needed to do it
[11:31:33] <huon> kimundi: that's just crazy talk :P
[11:31:40] <kimundi> heh
[11:31:42] <huon> reading help pages?? who does that
[11:31:43] <kimundi> nice and simple
[11:32:02] <eddyb> > rpm -qf /usr/bin/rename
[11:32:04] <eddyb> util-linux-2.23.2-3.1.x86_64
[11:32:37] <eddyb> huon: where's yours from?
[11:33:12] *** Joins: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de)
[11:35:15] <eddyb> was I that late yesterday? or did nmatsakis not have time to read through all that stuff (though it wasn't a big pile of changes)
[11:35:38] <huon> weird, mine doesn't appear to be in any package
[11:35:45] <huon> phantom binary
[11:35:47] <huon> spoooky
[11:35:50] <eddyb> is it a symlink?
[11:36:02] <huon> (but i have the other rename as rename.ul from an equivalent package)
[11:36:53] <huon> ah, it's an alternative pointing to http://man.cx/prename
[11:37:03] <huon> from the perl package
[11:37:35] <eddyb> something like "prename" is what I was hoping to get from the man reference. apparently not
[11:38:11] <huon> nope, prename is mentioned on the manpage at all
[11:38:33] <eddyb> sounds like "there is only Perl"
[11:38:37] <huon> and `man prename` goes straight to the same rename(1) page
[11:38:50] <huon> anyway...
[11:39:03] * huon has better things to do than pointer the peculiarities of a debian package
[11:39:10] <huon> *ponder
[11:39:24] <eddyb> &peculiarities
[11:43:03] <eddyb> well, that was an exciting waste of time
[11:44:30] <eddyb> then what, Region?
[11:50:29] <eddyb> this is cool, albeit quite verbose: echo 'extern crate '{syntax,rustc}\;
[11:51:59] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[11:51:59] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/OOI4gQ
[11:51:59] <ghrust> 13rust/06auto 141922957 15Clark Gaebel: Performance-oriented hashtable....
[11:51:59] <ghrust> 13rust/06auto 14961ae4e 15bors: auto merge of #12081 : cgaebel/rust/robinhood-hashing, r=huonw...
[11:51:59] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[11:52:00] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[11:52:00] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14982fa27 to 14397abb7: 02http://git.io/N3iJvQ
[11:52:00] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[11:55:01] <eddyb> so ty::substs uses 96 bytes... but when you look at it, it seems tiny
[11:55:54] <eddyb> each Vec<T> is 24 bytes... that's sad
[11:56:17] <eddyb> but it only accounts for half of substs, where's the rest?
[11:56:38] <pnkfelix> hmm, another odd failure for my PR ...
[11:56:41] <eddyb> Option<ty::t> is 16 bytes, that's bad
[11:58:41] <eddyb> RegionSubsts is technically a vector, with an additional meaning when it's empty. but it's twice as big as a Vec
[11:59:28] * eddyb blinks
[11:59:35] <eddyb> why is Vec 32 bytes long?
[12:00:13] * eddyb prods strcat and pcwalton
[12:00:38] <pnkfelix> eddyb: beause it has a destructor?
[12:00:46] <eddyb> oh dear
[12:01:07] <eddyb> keep in mind we went up to 1.5GB in the trans peak. an oversight like that is devastating
[12:01:30] <kimundi> "TyInfer also appears as the type of arguments or return values in a fn_expr, or as the type of local variables." - do we still have a fn_expr, or did it change to FnExpr, or does it have a completely different name now?
[12:01:37] <kimundi> (Updating a comment)
[12:01:48] <eddyb> it's ExprBlockFn i.e. closures and procs
[12:02:12] <eddyb> it could be named differently though, not sure atm
[12:02:14] <kimundi> thanks
[12:02:26] <kimundi> hm
[12:02:27] <eddyb> (I can't really compile stage2 anymore without killing every non-trivial app)
[12:03:02] <eddyb> so here's what I'm going to do :P
[12:03:16] <eddyb> pnkfelix: thanks btw, I thought it was alignment related
[12:03:44] <pnkfelix> eddyb: np.  I was only reminded about that extra word for structs-with-drop yesterday
[12:04:10] <eddyb> is setting the length to zero considered sane?
[12:04:26] <eddyb> to prevent drop recursion
[12:04:43] <eddyb> hmm, before or after, that is the question
[12:05:01] <eddyb> well, no, recursion shouldn't happen, the issue is double drops
[12:05:31] <eddyb> (I also have to set the pointer to 0)
[12:05:50] <kimundi> Where would I most likely find the the thing descended from "fn_expr" in the source? grepping for ExprBlock tells me the name is wrong
[12:06:07] <eddyb> it's not Block, but BlockFn
[12:06:19] <eddyb> {} vs closures
[12:07:03] <kimundi> only two lines in the pretty printer contain BlockFn, in the from of BlockBlockFn
[12:07:19] <eddyb> maybe it was renamed to ExprClosure or something nice like that?
[12:07:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:08:15] <eddyb> kimundi: ExprLambda and ExprProc
[12:08:28] <eddyb> wait, no, ExprLambda is a run-pass test =))
[12:09:05] <eddyb> kimundi: ExprFnBlock, not sure how I missed it
[12:09:22] <kimundi> aah, yeah
[12:09:30] <kimundi> should just have tried all permutations first
[12:09:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:09:49] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Quit: leaving)
[12:09:56] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[12:10:02] *** Joins: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca)
[12:10:07] <kimundi> "TyInfer also appears as the type of arguments or return values in a ExprFnBlock, ExprProc, or as the type of local variables." - does that sound right?
[12:11:05] <eddyb> kimundi: the entire arguments/return value part should refer to ExprFnBlock or ExprProc
[12:11:31] <kimundi> Heh, I though it does with that sentence
[12:11:34] <pnkfelix> anyone have any clue why run-fail/assert-macro-explicit.rs may have seemingly changed its error output ?
[12:11:47] <kimundi> pnkfelix: hm?
[12:11:57] <pnkfelix> I'm trying to understand a bors build failure
[12:12:02] <pnkfelix> http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-t/builds/3791/steps/test/logs/stdio
[12:12:05] <kimundi> what did change?
[12:12:20] <huon> pnkfelix: that looks like a spurious failure :(
[12:12:21] <pnkfelix> its claiming "error: error pattern 'failed at 'assertion failed: false'' not found!"
[12:12:30] <pnkfelix> bizarre...
[12:12:31] <huon> given the output just cuts off
[12:12:40] <huon> I think I've seen that one fail a few times before
[12:13:02] <pnkfelix> huon: wait, what do you mean the output... oh, you mean in the "warning: got" section ?
[12:13:04] <huon> why is our testsuite so unreliable?? how many bugs do we have hiding in all these failures :(
[12:13:07] <huon> pnkfelix: yeah
[12:13:20] <pnkfelix> huon: Okay.  I guess I will retry.
[12:13:47] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Quit: leaving)
[12:13:48] <huon> pnkfelix: btw, did you fix the PR title issue that bors has or should I still put the title in the main description?
[12:13:48] <pnkfelix> huon: I am also unhappy with testsuite fragility.  Though I do think its gotten better since we dropped rustpkg
[12:13:52] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[12:13:59] <pnkfelix> huon: it got "fixed" by others
[12:14:01] <eddyb> no kidding
[12:14:11] <pnkfelix> huon: bors now pulls in your title but drops your description
[12:14:17] <eddyb> rustpkg was source of endless wonder
[12:14:30] <pnkfelix> huon: which is a net improvement
[12:14:51] <huon> pnkfelix: hm... that doesn't seem to be the case looking at the most recent history?
[12:15:02] <pnkfelix> huon: oh, maybe we haven't upgraded to that version yet
[12:15:14] <huon> ah, right
[12:15:17] <pnkfelix> huon: I had asked about an upgrade, let me see if brson ever responded
[12:15:59] <huon> oh, yes, iirc he said he reverted the upgrade for the workweek to avoid having to fight automation fires
[12:16:12] <pnkfelix> huon: okay, I'll ping him again about it
[12:18:22] <darnuria> Hello!
[12:18:32] <pnkfelix> Do we have an issue cataloguing the various spurious bors failures?
[12:18:39] <eddyb> huon: right now getting rid of OptVec is the best option. how are we moving on that front?
[12:19:04] <pnkfelix> darnuria: hi
[12:20:15] <huon> eddyb: wait for cmr's benches
[12:20:18] <huon> *waiting
[12:20:31] <eddyb> it can't be worse than Option<Vec<T>>
[12:21:07] <eddyb> how do you say "owned slice" in a way that's short like "Vec"?
[12:21:11] <huon> eddyb: it might be worth keeping the OptVec type around and changing its internal representation
[12:21:19] <eddyb> but the name is all wrong
[12:21:48] <eddyb> if anything, let's implement the ~[T] DST in the library
[12:22:11] <huon> pnkfelix: https://github.com/mozilla/rust/pull/12844 r? (two line doc change)
[12:22:57] <eddyb> you should create it from a Vec<T>, and it should have a few utility things implemented (including FromIterator, collecting in a Vec and converting from that)
[12:23:14] <eddyb> FromIterator and .as_slice() are probably the only ones it would really need
[12:23:18] <pnkfelix> huon: ah, my local repo is a little out of date (didn't have the librand move)
[12:23:27] *** Joins: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net)
[12:24:25] <huon> eddyb: keeping the OptVec type around and just changing its name will be easier than going through later and working out which Vec's should be ~[]/OptVec/whatever
[12:24:44] <eddyb> DST ~[T] is superior to Vec/OptVec
[12:24:46] <huon> oh
[12:24:47] * huon can't spell hexadecimal
[12:24:54] <huon> eddyb: I'm not debating that
[12:25:05] <huon> but the reality is we don't have DST ~[T] yet
[12:25:07] <eddyb> so the choice is "growable" vs "non-growable"
[12:25:07] <huon> so we can't use it
[12:25:10] <pnkfelix> huon: ugh, I missed that
[12:25:20] <eddyb> huon: what I'm saying is that we can implement it in like 20 lines
[12:25:38] <huon> the "change the internal representation" would just be DST ~[T] in the library
[12:25:55] <eddyb> right, but then the "OptVec" name is wrong
[12:25:55] <pnkfelix> huon: but then again, hexidecimal has 12M results on google; hexadecimal only 6.7M
[12:26:02] <eddyb> it's more like Array<T>
[12:26:31] <huon> pnkfelix: that's peculiar
[12:26:34] <eddyb> r? https://github.com/mozilla/rust/pull/12845
[12:26:52] <huon> eddyb: "and just changing its name" https://botbot.me/mozilla/rust-internals/msg/12014261/
[12:26:58] <pnkfelix> huon: goofy, right?  Anyway, I'll remove the r+ and let you fix your PR
[12:27:05] <eddyb> huon: I'm blind
[12:27:12] <huon> pnkfelix: already fixed :
[12:27:18] <huon> )
[12:27:38] <eddyb> huon: anything that's not a context shouldn't use Vec, it's almost as simple as that
[12:27:47] <huon> thanks
[12:28:05] <eddyb> I just hope I don't have to wait for a meeting for this PR
[12:28:33] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[12:28:35] <eddyb> I am sick of waiting (nobody's fault. I'm actually responsible for most delays)
[12:28:48] * huon -> bed
[12:28:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[12:29:34] * eddyb now wonders whether syntax sugar makes for sweet dreams
[12:29:58] <pnkfelix> eddyb: ... did you even build that?  the field is named `len`, not `length`
[12:30:06] <eddyb> that must be git gui
[12:30:17] <eddyb> *clicks Rescan* yupp
[12:30:58] <eddyb> pnkfelix: I tested it to make sure the fix worked, pushed with the fix
[12:31:11] <eddyb> s/fix$/length -> len/
[12:32:08] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[12:32:08] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/XcuFCw
[12:32:08] <ghrust> 13rust/06auto 14b0c698a 15Alex Crichton: std: Rename Chan/Port types and constructor...
[12:32:08] <ghrust> 13rust/06auto 14cd61ea1 15bors: auto merge of #12815 : alexcrichton/rust/chan-rename, r=brson...
[12:32:08] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[12:32:12] <huon> pnkfelix: I think retries have to go on the commit with the r+, not the commit that bors speaks on
[12:32:37] <eddyb> shouldn't those two be the same?
[12:32:40] <pnkfelix> huon: sigh
[12:33:04] <huon> eddyb: they have the same hash, but are in different repos
[12:33:14] <eddyb> ah
[12:34:56] <pnkfelix> huon: would it be crazy for bors to look in both places? hmm..
[12:41:10] *** Quits: lpy (lpy@81C4458B.25165A39.3F03179E.IP) (Client exited)
[12:43:14] *** Quits: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Client exited)
[12:48:51] <eddyb> -16 bytes on t_box_ but it's not enough
[12:49:43] <eddyb> ty_trait is still huge
[12:52:30] <pnkfelix> eddyb: I'll r+ the vec_ng change; it looks good to me and is trivial to revert if we decide to do so.
[12:53:19] <eddyb> my glibc gives a meaningful error message and dumps a backtrace for double-free, I hope bors' does the same
[12:53:36] <eddyb> (double-free with no malloc in between)
[12:54:44] <pnkfelix> eddyb: was that last statement about glibc in anticipation of my comment?
[12:54:56] <pnkfelix> (the comment I just added to the PR, that is)
[12:55:02] <eddyb> oh I did not see that yet
[12:55:13] <pnkfelix> eddyb: I only added it after I lied and said I'd r+ it.  
[12:55:19] <pnkfelix> eddyb: (but I do intend to do so)
[12:55:54] <eddyb> I wonder how to test
[12:56:00] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[12:56:31] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[12:56:31] *** ChanServ sets mode: +o tjc
[12:56:38] <eddyb> I guess I'll have a Vec<DropCounter> and make sure it only drops the element(s) once
[12:57:52] <pnkfelix> eddyb: yeah.  That and setting up the test to actually attempt to call drop >1 times seem like the important bits.
[12:58:25] <eddyb> drop(transmute_copy::<Vec<T>, Vec<T>>(&x)) I think
[12:58:29] <eddyb> and drop(x)
[13:01:05] <pnkfelix> eddyb: wait, transmute_copy just seems like a terrible thing to do on Vec<T>, no?
[13:01:13] <eddyb> why?
[13:01:20] <eddyb> it does what I want
[13:01:27] <huon> isn't that purposely making it double-free?
[13:01:38] <eddyb> wait, no, I know why I didn't want transmute_copy
[13:01:40] <huon> with no chance for the zeroing to help?
[13:01:54] <eddyb> pnkfelix: thanks, I forgot why I didn't want to do that *sigh*
[13:02:02] <eddyb> is there something like transmute_copy but for the same type?
[13:02:18] <eddyb> there's read_ptr, I guess I'll use that
[13:02:30] <eddyb> ptr::read even
[13:03:07] <huon> that still seems wrong...
[13:03:21] *** Joins: lpy (lpy@F7AFA3.F09091A8.1348A864.IP)
[13:03:26] <eddyb> *sigh*
[13:03:32] <eddyb> yeah, it's not in place
[13:03:59] <pnkfelix> eddyb: maybe transmute_copy<~Vec<T>, ~Vec<T>>
[13:04:00] <eddyb> rusti: ::std::vec_ng::Vec::new().drop()
[13:04:01] -rusti- <anon>:10:9: 10:41 error: explicit call to destructor
[13:04:01] -rusti- <anon>:10         ::std::vec_ng::Vec::new().drop()
[13:04:01] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[13:04:01] -rusti- error: aborting due to previous error
[13:04:01] -rusti- application terminated with error code 101
[13:04:40] <eddyb> pnkfelix: that will double-free the ~
[13:04:46] <pnkfelix> eddyb: oh yeah, that's bad too
[13:05:12] <huon> do we actually have a wait to run the destructor on a memory location, rather than having to copy out the value by-value?
[13:05:21] <eddyb> I... don't think so
[13:05:33] <eddyb> you can get the drop glue
[13:05:48] <huon> that's what you need, right?
[13:05:51] <eddyb> should I do that?
[13:06:08] <huon> (that == "run dtor on memory location")
[13:06:16] <eddyb> ah, yeah
[13:06:28] <huon> using drop glue directly seems like a wild hack that's nearly worse than not having a test
[13:06:49] <eddyb> there's also the option of let x = x; which will call drop glue twice
[13:07:00] <eddyb> but might not in the future
[13:07:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:07:27] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[13:07:30] <pnkfelix> eddyb: wait, I think I know
[13:07:37] <eddyb> here comes the masterhack
[13:07:48] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[13:08:06] <pnkfelix> struct twovec { x: Vec<DropCount>, y: Vec<DropCount> }
[13:08:14] <pnkfelix> let tv = twovec { ... }
[13:08:19] <pnkfelix> let x = tv.x
[13:08:32] <pnkfelix> then when the tv is dropped, it will still attempt to drop tv.x
[13:08:48] <eddyb> that's let x = x; but with more style
[13:08:52] <pnkfelix> (at least, I believe cases like this are the motivation for drop glue)
[13:08:58] <huon> eddyb: not quite?
[13:09:01] <eddyb> s/drop glue/zeroing
[13:09:09] <eddyb> huon: it has the exact same effect *right now*
[13:09:19] * huon disagrees with dropping TVs on principal, though
[13:09:32] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[13:09:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:09:33] <pnkfelix> huon: funny man
[13:09:44] <huon> (and also dropping them on principals)
[13:10:17] <eddyb> isn't that word "principle"? (bad time for my spellchecker to die)
[13:10:41] <huon> eddyb: yeah, probably... the second one is meant to be -al though
[13:10:50] * huon .english_skills -= 1
[13:10:57] <eddyb> "Principal should not be confused with principle"
[13:11:04] * eddyb .level_up()!
[13:11:20] <pnkfelix> eddyb: for some reason the twovec variant is more immediately clear to me about why one would expect drop glue to run twice, at least until we put in enough infrastructure to get rid of drop flags entirely.
[13:11:22] * huon stops distracting #rust-internals and goes to bed (eventually)
[13:11:36] *** Quits: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca) (Quit: canhtak)
[13:11:46] <eddyb> pnkfelix: right, I'll do that
[13:13:07] <eddyb> let mut count_x @ mut count_y = 0; // @buse
[13:21:04] <eddyb> pnkfelix: r? https://github.com/mozilla/rust/pull/12845
[13:21:12] <eddyb> though I'd wait until travis finishes
[13:21:59] <eddyb> and no, I will not build stdtest on this machine. it takes around 300MB more than librustc does. that would be technically impossible without booting in single user mode and using the VGA console
[13:22:13] <pnkfelix> hmm, I did not know we had `drop` in the prelude
[13:22:30] <eddyb> rusti: let pnkfelix = true; drop(pnkfelix)
[13:22:31] -rusti- ()
[13:23:10] *** Joins: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca)
[13:23:21] <eddyb> "everything drops" but sometimes it's nice to have it explicit
[13:26:15] <pnkfelix> plus we might end up making it explicit for certain cases
[13:26:25] <pnkfelix> e.g. on control flow forks
[13:27:04] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[13:27:04] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14cd61ea1 to 14397abb7: 02http://git.io/N3iJvQ
[13:27:04] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[13:27:04] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[13:27:04] <ghrust> [13rust] 15bors pushed 7 new commits to 06auto: 02http://git.io/gTf1xQ
[13:27:04] <ghrust> 13rust/06auto 14da19563 15Felix S. Klock II: Port partition method from ~[T] to Vec<T>, for use early-late lifetime code.
[13:27:04] <ghrust> 13rust/06auto 14460ca4f 15Felix S. Klock II: Alpha-rename `.ident` fields of type `Name` to `.name`.
[13:27:05] <ghrust> 13rust/06auto 14189c008 15Felix S. Klock II: alpha-rename .ident to .name in Lifetime, including in rustdoc.
[13:27:07] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[13:27:15] * pnkfelix crosses fingers a second time
[13:27:31] <eddyb> oh, you mean it should be moved from in all branches?
[13:27:38] <pnkfelix> eddyb: yeah
[13:27:42] <eddyb> and a drop call would do that
[13:27:48] <eddyb> pnkfelix: I totally agree with that
[13:27:52] <pnkfelix> eddyb: I think there was some meeting where this was discussed, let me see...
[13:27:57] <eddyb> have you seen the transmute to ~str monster?
[13:28:27] <pnkfelix> inferring where to insert the drops seems way too magical to me.
[13:28:56] <eddyb> pnkfelix: check out this IR https://github.com/mozilla/rust/issues/11445
[13:29:20] <eddyb> that's also what fn id<T>(x: T) {x} would do, I think
[13:30:09] <eddyb> that needs SROA magic to clean up
[13:31:40] <eddyb> when we could just emit ret %0 from the start
[13:32:02] <nmatsakis> eddyb: sorry didn't get through PRs, I've scheduled an hour or two today for reviews 
[13:32:20] <eddyb> nmatsakis: good morning http://servomemes.tumblr.com/post/79357480162/eddyb-has-feelings-about-how-long-servo-goes
[13:32:35] <nmatsakis> :)
[13:32:52] <eddyb> and yeah, we can totally remove almost half a gig from the trans peak
[13:33:19] <eddyb> and probably make typeck a bit faster, too, in the process
[13:36:58] <eddyb> nmatsakis: we can also prevent heap fragmentation by increasing locality, I think
[13:37:23] <kimundi> haha
[13:37:35] * kimundi totally starts following that tumblr
[13:38:46] * eddyb sets "512MB trans peak for librustc by Q3" as primary objective
[13:40:24] <eddyb> nmatsakis: I feel like I should start writing a long list of possible optimizations and just stick it somewhere so people can try them
[13:40:45] <nmatsakis> eddyb: not a bad idea. I've always gone back and forth on whether this is a suitable use for the issue tracker.
[13:42:55] <eddyb> rusti: struct Foo<'a, 'b>; let x: Foo;
[13:42:57] -rusti- <anon>:10:33: 10:34 warning: unused variable: `x`, #[warn(unused_variable)] on by default
[13:42:57] -rusti- <anon>:10         struct Foo<'a, 'b>; let x: Foo;
[13:42:57] -rusti-                                           ^
[13:42:57] -rusti- ()
[13:43:06] <eddyb> rusti: struct Foo<'a, 'b>; let _x: Foo<'static>;
[13:43:06] -rusti- <anon>:10:37: 10:49 error: wrong number of lifetime parameters: expected 2 but found 1
[13:43:06] -rusti- <anon>:10         struct Foo<'a, 'b>; let _x: Foo<'static>;
[13:43:06] -rusti-                                               ^~~~~~~~~~~~
[13:43:06] -rusti- error: aborting due to previous error
[13:43:06] -rusti- application terminated with error code 101
[13:43:11] <eddyb> rusti: struct Foo<'a, 'b>; let _x: Foo<'static, _>;
[13:43:11] -rusti- <anon>:10:50: 10:51 error: expected type, found token UNDERSCORE
[13:43:11] -rusti- <anon>:10         struct Foo<'a, 'b>; let _x: Foo<'static, _>;
[13:43:11] -rusti-                                                            ^
[13:43:13] -rusti- application terminated with error code 101
[13:43:38] <eddyb> nmatsakis: ^ once I can do something like that, then we can merge the arena change without much code ugliness
[13:44:10] <eddyb> with type Block<'a, 'tcx> = &'a BlockS<'a, 'tcx>;
[13:45:38] <eddyb> nmatsakis: variance might help a bit (struct literals are currently stricter than function calls, not sure if edward filed a bug for that), but I figured ty::ctxt<'a> = &'a ctxt_<'a> ain't gonna fly
[13:47:06] <nmatsakis> eddyb: whta do you mean by "ain't gonna fly"?
[13:47:24] <nmatsakis> that sounds like exactly what I expected, actually
[13:47:35] <nmatsakis> (I assume you mean a type alias)
[13:48:06] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[13:49:22] <eddyb> nmatsakis: oh, right, the issue was that I should have ctxt<'tcx> and not <'a> where 'a is also used somewhere else in the same structure
[13:49:36] <eddyb> not sure whether to keep the type alias or not
[13:52:32] <nmatsakis> I like the alias personally, I've found it makes code nicer to read than &'a Tcx<'a>
[13:52:47] <nmatsakis> TypeContext<'tcx> is quite reasonable
[13:53:20] <nmatsakis> (though often &TypeContext<'tcx> would be enough)
[13:53:26] <nmatsakis> that is, the pointer to the tcx doesn't have to have the lifetime 'tcx
[13:53:34] <nmatsakis> so maybe the alias isn't worth the trouble
[13:53:44] * nmatsakis shrugs
[13:55:11] <pnkfelix> nmatsakis: since you're here
[13:55:30] <pnkfelix> nmatsakis: any objection to removing the drop flag on vec_ng::Vec? 
[13:55:46] <pnkfelix> nmatsakis: it's eddyb's PR: https://github.com/mozilla/rust/pull/12845
[13:56:00] <eddyb> wait, it failed
[13:56:10] <eddyb> development by travis
[13:56:24] <eddyb> huh, it's not in the prelude?
[13:56:54] <pnkfelix> odd, I thought I checked that it was
[13:57:01] <eddyb> it was at one point
[13:57:01] <pnkfelix> we even talked about it
[13:57:06] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[13:58:12] <pnkfelix> easily fixed, in any case.
[13:58:44] <pnkfelix> I don't understand the travis presentation.  E.g. 779.1 is green, so it passed?  Yet its sole difference from 779.2 is that it has a different setting for LLVM_VERSION ?
[13:58:59] <eddyb> pnkfelix: only merges to master are checked on 3.3
[13:59:18] <pnkfelix> eddyb: ah, not the PR's themselves, okay
[13:59:35] <eddyb> I tried to make acrichto fix it so it doesn't have to touch a build server at all for 3.3 but apparently his hack is the only thing that works :(
[13:59:43] * pnkfelix failed to read the terminal output completely
[13:59:44] <eddyb> 3.3 + PR, that is
[14:01:13] <pnkfelix> the prelude even says `pub use mem::drop` on your PR.  Does the travis system checks the PR's themselves, or does it do a merge with main the way that bors does?
[14:01:27] <nmatsakis> pnkfelix: no particular objection, no
[14:01:47] <eddyb> pnkfelix: I think it's because I'm still inside the std
[14:01:50] <nmatsakis> pnkfelix: obviously I want to solve this problem generally eventually but no reason not to solve this case now
[14:02:03] <pnkfelix> nmatsakis: yeah, that's what I figured
[14:02:11] <eddyb> and std does #[no_std];
[14:02:34] <pnkfelix> eddyb: ah, of course
[14:02:49] <eddyb> so no prelude, just linking against realstd for lang items and whatnot
[14:07:17] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[14:07:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:07:28] *** Joins: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[14:09:16] <erickt_> ack, github doesn't seem to be showing old comments on a PR after a rebase anymore :(
[14:09:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:11:32] <Zr40> on the PR or on rebased-away commits?
[14:12:23] <erickt_> rebased-away commits
[14:13:18] <erickt_> acrichto gave me a r+ on 12820, but there was a merge conflict. I rebased to fix it, but now I've lost his comment
[14:14:10] <erickt_> this seems to be new as of a couple days ago. checks the blog
[14:14:56] <pnkfelix> mrrh
[14:16:33] <Zr40> do you still have the commit hash?
[14:16:49] <erickt_> Zr40: yeah, https://github.com/erickt/rust/commit/9e39987de7e8b811648ffd9c6f483e2017b02281
[14:16:55] <erickt_> the comment is still there
[14:17:50] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[14:19:12] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[14:20:24] <eddyb> OOPS
[14:20:52] <eddyb> pnkfelix: you didn't see anything
[14:24:00] *** Joins: edwardw (edwardw@F3BE8D26.1B2F6624.7F41E82D.IP)
[14:26:13] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[14:26:25] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[14:27:22] <larsberg> What's the cleanest way to work around the need for multiple mutable borrows into closures? e.g., something like: https://gist.github.com/larsbergstrom/9507968 ? We're interfacing with an external library that has a struct filled with callback closures, so "just fix the API" is, alas, not a good option for us. Wrap it in a RefCell, clone it into all the
[14:27:23] <larsberg> closures, and call borrow?
[14:27:57] *** jdm is now known as jdm|away
[14:27:57] <larsberg> (fyi, yes our Rust is so old that this code used to "just work" <grin>)
[14:27:59] <eddyb> larsberg: no need to clone
[14:28:15] <eddyb> just capture a &RefCell
[14:28:23] <eddyb> or capture the original (x)
[14:28:52] <eddyb> rusti: let mut x = 0; let f = || x += 1; let g = || x += 1; f(); g(); x
[14:28:53] -rusti- pastebinned 16 lines of output: http://sprunge.us/MFSc
[14:29:58] <eddyb> rusti: let x = ::std::cell::RefCell::new(0); let f = || *x.borrow_mut().get() += 1; let g = || *x.borrow_mut().get() += 1; f(); g(); *x.borrow().get()
[14:29:59] -rusti- 2
[14:30:04] <eddyb> larsberg: ^^
[14:30:22] <larsberg> eddyb: thanks! I had a feeling I'd have to do your second rusti option :-)
[14:30:58] <larsberg> Was trying to get something like the first to work, but nmatsakis has been working hard to stymie my efforts to circumvent the type system apparently...
[14:31:13] <eddyb> you really need to make it a runtime check, otherwise it *could* be unsafe. though I wonder if borrowck could allow some cases to go through, as they will never concurrently mutate the common reference
[14:31:26] <eddyb> maybe deny taking the address of the common mutable capture?
[14:31:32] <eddyb> nmatsakis: ^^ random thoughts
[14:32:07] <larsberg> yeah, it seems to come up when we have C APIs with callbacks where we know it's a simple callback model (they will never be nested or called concurrently)
[14:32:21] <larsberg> but kmc is planning to rewrite that C API in rust down the road anyway :-)
[14:32:26] <eddyb> \o/
[14:32:37] * nmatsakis reads backscroll
[14:33:00] <nmatsakis> larsberg: RefCell is the safe way to do this
[14:33:20] <nmatsakis> and that's what I'd default to
[14:33:31] * nmatsakis still has mental dissonance from working on spidermonkey sometimes
[14:34:15] <nmatsakis> particularly with regard to dropping asserts in optimized code
[14:34:26] <nmatsakis> but I guess that servo ought not to do that, if those asserts are needed to guarantee memory safety
[14:34:39] <nmatsakis> or at least not without careful thought
[14:35:20] <larsberg> nmatsakis: I'd expect that RefCell would still perform dynamic checks of safety and fail! if they're not satisfied, even with the change to make assert! debug-only in the future
[14:35:38] <nmatsakis> larsberg: yes
[14:35:50] <erickt_> Zr40: hrm, it seems like this might be a github bug, I can see comments on outdated diffs in https://github.com/mozilla/rust/pull/12544
[14:37:07] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[14:37:07] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/gTf1xQ
[14:37:07] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[14:37:43] <Zr40> erickt_: it seems it has worked yesterday, at least. https://github.com/mozilla/rust/pull/12826
[14:40:28] * pnkfelix wonders what eddyb managed to hide under the rug
[14:40:40] <eddyb> pnkfelix: a missing dereference
[14:41:25] <pnkfelix> PR 12807 landed!  \o/
[14:42:02] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[14:42:02] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/CnLJBQ
[14:42:02] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[14:42:06] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[14:42:06] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/71iAeA
[14:42:06] <ghrust> 13rust/06auto 143ea50f0 15Michael Woerister: debuginfo: Improve commandline option handling for debuginfo (fixes #12811)...
[14:42:06] <ghrust> 13rust/06auto 141835667 15bors: auto merge of #12816 : michaelwoerister/rust/limited-debuginfo, r=alexcrichton...
[14:42:06] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[14:42:23] *** Quits: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca) (Quit: canhtak)
[14:42:25] <eddyb> pnkfelix: annotate all the traits!
[14:42:30] <eddyb> TyFold and AstConv, at least
[14:42:43] * pnkfelix needs to leave for french class soon
[14:42:53] <eddyb> pnkfelix: r? https://github.com/mozilla/rust/pull/12845
[14:43:09] <eddyb> I'll remove it if the travis build fails, I promise
[14:43:49] <pnkfelix> eddyb: so I take it the previous version did not compile?
[14:44:00] <eddyb> yupp :(
[14:44:06] <pnkfelix> k.  just checking.
[14:44:42] <eddyb> std tests already passed, fwiw
[14:44:58] <eddyb> test vec_ng::tests::test_double_drop ... ok
[14:45:07] <eddyb> pnkfelix: thanks :D
[14:46:13] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[14:46:14] *** ChanServ sets mode: +o tjc
[14:47:06] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Textual IRC Client: www.textualapp.com)
[14:47:10] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[14:47:10] *** ChanServ sets mode: +o tjc
[14:47:15] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: tjc)
[14:47:52] *** Quits: lpy (lpy@F7AFA3.F09091A8.1348A864.IP) (Client exited)
[15:01:42] *** jdm|away is now known as jdm
[15:07:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:09:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:15:32] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[15:15:32] <ghrust> [13rust] 15alexcrichton merged 06master into 06snap-stage3: 02http://git.io/Lp10AA
[15:15:32] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[15:15:56] <eddyb> without autoderef though :(
[15:15:56] <erickt_> acrichto: it looks like the issue I mentioned on https://github.com/mozilla/rust/pull/12820 is just a github bug, other PRs still have the comments on outdated diffs
[15:16:06] <erickt_> acrichto: so I filed a bug with github support
[15:18:27] *** Quits: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de) (Ping timeout)
[15:19:32] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:21:04] *** Joins: eibwen (kvirc@moz-48B987C8.dip0.t-ipconnect.de)
[15:21:14] <acrichto> erickt_: those are comments on the PR diff, not comments on commits
[15:23:31] <erickt_> acrichto: yeah, for some reason #12820 doesn't show "comments on an outdated diff", but they show up in a more recent https://github.com/mozilla/rust/pull/12826
[15:24:01] <erickt_> I meant to say "diff" not "commit"
[15:24:26] *** Quits: zxcdw (r-a@F4A4796.FC390A29.3933CC16.IP) (Ping timeout)
[15:24:32] <acrichto> github makes a distinction between commenting on a diff and commenting on a commit
[15:24:44] <acrichto> commits are lost but diffs are kept
[15:24:55] *** Joins: aochagavia2 (Mibbit@moz-C82E8769.static.ziggozakelijk.nl)
[15:25:52] <aochagavia2> Is there a reason why [1, ..9] copies the value 1 instead of cloning it?
[15:25:56] <erickt_> hrm, odd, I thought both were kept. anyway I got to run to work, thanks for the review
[15:31:17] <aochagavia2> Does anybody know  why [1, ..9] copies the value 1 instead of cloning it?
[15:31:20] *** Quits: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[15:32:47] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[15:32:47] *** ChanServ sets mode: +o tjc
[15:32:55] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: tjc)
[15:33:23] *** Joins: aphistic (aphistic@moz-D08A46AA.erikd.org)
[15:35:23] *** Joins: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca)
[15:36:01] *** Quits: aochagavia2 (Mibbit@moz-C82E8769.static.ziggozakelijk.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[15:40:49] *** Joins: lpy (lpy@54AA05A8.F09091A8.1348A864.IP)
[15:48:08] *** Quits: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca) (Quit: canhtak)
[15:50:37] <edwardw> nmatsakis: you around? I got a fix for #3598 "infer or permit declarations of variance for type parameters". basically it treats "Bivariant" as if it were "Invariant" then substituting type parameters 
[15:50:52] <edwardw> doesn't it make senes theroratically?
[15:50:57] <edwardw> *theoretically 
[15:51:27] <edwardw> I mean does it make sense theoretically?
[16:01:42] *** Joins: krdln (Mibbit@moz-C271714F.dynamic.chello.pl)
[16:02:55] *** Joins: tedh_ (tedh@moz-F3B34318.hsd1.il.comcast.net)
[16:03:16] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[16:07:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:09:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:13:15] *** Quits: lpy (lpy@54AA05A8.F09091A8.1348A864.IP) (Connection reset by peer)
[16:14:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:16:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:22:21] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Ping timeout)
[16:23:48] *** Quits: edwardw (edwardw@F3BE8D26.1B2F6624.7F41E82D.IP) (Connection reset by peer)
[16:24:53] *** Joins: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP)
[16:30:29] *** Joins: erickt (etryzelaar@moz-A9F9654D.keplers.com)
[16:30:31] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Client exited)
[16:30:57] *** Quits: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP) (Quit: Leaving...)
[16:32:31] *** Joins: canhtak (canhtak@moz-9F5D2CD3.wl.t.ulaval.ca)
[16:33:30] *** Quits: erickt (etryzelaar@moz-A9F9654D.keplers.com) (Ping timeout)
[16:33:34] *** Quits: japaric (japaric@66349AB0.E05ED48F.F29ED47E.IP) (Ping timeout)
[16:34:05] *** Joins: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP)
[16:34:44] *** Joins: edwardw (edwardw@D286B842.1B2F6624.7F41E82D.IP)
[16:53:54] *** Quits: Kxepal (Miranda@moz-A34EDBE5.pppoe.mtu-net.ru) (Ping timeout)
[16:56:05] *** Joins: Kxepal (Miranda@moz-E7D8C0DD.pppoe.mtu-net.ru)
[17:00:11] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[17:01:29] *** Joins: lpy (lpy@54AA05A8.F09091A8.1348A864.IP)
[17:07:07] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[17:07:08] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/71iAeA
[17:07:08] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[17:08:06] <cmr> "pcwalton: This will break Servo badly. And nearly all Rust code that uses the FFI."
[17:08:27] <larsberg> div_ceil is gone, right?
[17:08:39] <cmr> again with pcwalton's last-minute cliffhangers
[17:08:58] <cmr> larsberg: seems so.
[17:09:16] <larsberg> cmr: par for the course. The ~[] removal will also eat a few days of somebody's time. As will the "structs now default to priv". 
[17:12:07] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[17:12:07] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/9Y9Okg
[17:12:07] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[17:13:48] <nmatsakis> edwardw: ping
[17:13:58] <edwardw> nmatsakis: pong
[17:14:26] <nmatsakis> edwardw: first, I think ncr is working on that (just fyi), but second, that doesn't quite sound like a fix
[17:15:04] <nmatsakis> in particular, what I was concerned about is not so much the cases where we infer bivariance,
[17:15:10] <nmatsakis> as the cases where we infer covariant etc
[17:15:15] <nmatsakis> right now we treat everything as invariant
[17:15:26] <nmatsakis> I could imagine emitting an error if something is inferred to bivariant,
[17:15:31] <nmatsakis> or more likely a lint 
[17:15:46] <nmatsakis> since it indicates an unused parameter that should either be removed
[17:15:49] <nmatsakis> or constrained with a marker
[17:16:05] <edwardw> I tried to apply variance to type parameters
[17:16:12] <nmatsakis> eddyb: ping
[17:16:41] <edwardw> then I stuck with `kinds.rs`, failed to compile with `bivariance` emitted to `combine.rs`
[17:16:42] <eddyb> nmatsakis: pong. leaving in a few minutes
[17:17:29] <edwardw> if I treats that bivariance as invariant, it compiles. so I thought to check it with you
[17:17:37] <edwardw> treat*
[17:18:23] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[17:19:25] <nmatsakis> eddyb: when I try to build your branch, I get errors in rustdoc?
[17:20:06] <nmatsakis> edwardw: I don't understand quite what you mean by "I stick with..."
[17:20:09] <nmatsakis> er, I stuck with
[17:20:35] <nmatsakis> eddyb: I think it's just fallout from renaming borrow() to deref in Rc
[17:20:52] <nmatsakis> oh, he's gone I guess.
[17:20:53] <edwardw> bad english :) "#[deriving(Eq,Clone)] pub struct CovariantType<T>;" T isn't used here
[17:21:04] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[17:21:21] * pnkfelix wonders if we'd all be better off if we pitched in and bought eddyb a computer with more RAM so that he would do builds more often
[17:21:42] <pnkfelix> (builds+make check etc)
[17:22:47] * nmatsakis looks guiltily the other way
[17:23:02] <nmatsakis> I am notorious for letting bors just sort this kind of piddling nonsense out for me ;)
[17:23:08] * pnkfelix is joking, although it would be a funny Kickstarter campaign
[17:23:50] <nmatsakis> edwardw: yes? I'm still not clear on just what error etc is. Maybe you can just push your branch somewhere? Note that this is a specially treated lang item...
[17:24:12] <nmatsakis> edwardw: treating bivariance as invariance just byitself doesn't seem sound or reasonable to me
[17:24:12] <edwardw> I'll make a gist
[17:24:39] <nmatsakis> in particular, if I have `struct Foo<T>;` (T is bivariant) and then `struct Bar<T> { x: Foo<T>, y: T }`, then Bar is covariant in T,
[17:24:43] <nmatsakis> but if Foo were forced to invariant,
[17:24:49] <nmatsakis> since Bar contains a Foo,
[17:24:57] <nmatsakis> you'd want to force Bar to covariant too
[17:27:39] <nmatsakis> pnkfelix: you know how we were talking about the ShallowFree etc
[17:27:50] <nmatsakis> I am wondering more and more if we just want owned pointers to be a lang item with special treatment
[17:28:07] <nmatsakis> i.e., maybe we want to implement Own<T,A> where ~T is shorthand for Own<T,DefaultAlloc>
[17:28:13] <nmatsakis> but Own is specially known to the compiler
[17:28:28] <edwardw> here it is: https://gist.github.com/edwardw/9511894
[17:28:53] <nmatsakis> it's not clear to me what value there is in extensibility there, and I realize there are a few different places where the notion of "deeply owned paths" comes into play
[17:29:33] *** Quits: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP) (Quit: WeeChat 0.4.2)
[17:31:30] * nmatsakis wonders whether to create his own PR with some tiny fixes to eddyb's commits and r+ that
[17:31:44] <nmatsakis> oh, it needs rebase anyway
[17:33:03] <nmatsakis> it's annoying that github won't let me create a PR against eddyb's repo
[17:33:26] *** Joins: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP)
[17:33:32] *** Quits: lpy (lpy@54AA05A8.F09091A8.1348A864.IP) (Client exited)
[17:34:08] *** Joins: lpy (lpy@54AA05A8.F09091A8.1348A864.IP)
[17:34:50] *** Quits: lpy (lpy@54AA05A8.F09091A8.1348A864.IP) (Connection reset by peer)
[17:34:55] *** Quits: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP) (Quit: WeeChat 0.4.2)
[17:35:21] *** Joins: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP)
[17:35:30] <edwardw> nmatsakis: in addition to the gist, there's the patch: https://github.com/mozilla/rust/pull/12828/commits
[17:35:40] <edwardw> here's*
[17:36:09] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[17:36:28] <nmatsakis> edwardw: probably the answer is just that we should not derive clone but rather implement it manually
[17:36:56] <edwardw> nmatsakis: I see. I'll try that. Thanks
[17:37:07] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[17:37:11] <nmatsakis> edwardw: in particular we can do something like `impl<T> Clone for CovariantType<T> { fn clone(&self) -> CovariantType<T> { CovariantType } }`
[17:37:25] <edwardw> gotcha
[17:37:34] <eddyb> nmatsakis: herp derp
[17:37:49] <eddyb> this is what happens when you stop the fan keeping your laptop from overheating
[17:38:04] <nmatsakis> eddyb: :) I'll push a tiny patch, but you need to rebase, d oyou have time to do it now?
[17:38:10] <eddyb> and for some reason I hit that corner case again where it doesn't even boot
[17:38:27] <eddyb> nmatsakis: sure
[17:38:36] <nmatsakis> eddyb: in particular maybe cherry-pick last 3 commmits from https://github.com/nikomatsakis/rust/tree/eddyb-deref-now-auto
[17:38:39] <acrichto> quick r? https://github.com/mozilla/rust/pull/12847
[17:38:43] <acrichto> (making a rollup soon)
[17:39:06] <nmatsakis> acrichto: r+ I guess :)
[17:39:14] <acrichto> hehe
[17:39:18] <acrichto> I'll take it
[17:39:21] <nmatsakis> oh, I see
[17:39:22] <nmatsakis> yes r+
[17:39:46] <eddyb> thanks chrome, for losing all my tabs and stuff
[17:40:40] <eddyb> nmatsakis: are you rebased?
[17:40:50] <eddyb> I wonder how cherry picking works
[17:41:29] <eddyb> nmatsakis: huh https://github.com/nikomatsakis/rust/commit/b90a3f0dca56ecf6085599b95b6aa44e1f5cfadf
[17:41:46] <eddyb> is that an Rc?
[17:45:00] *** Joins: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[17:45:25] <nmatsakis> eddyb: I just fetchd and did "git reset --hard eddyb/deref-now-auto", so those should be up to date I think,
[17:45:34] <nmatsakis> eddyb: and yes I believe it was an Rc (from the error messages I saw)
[17:45:38] <eddyb> "derefence" heh
[17:45:45] <eddyb> nmatsakis: should've replaced it with .deref()
[17:45:52] <eddyb> that's what I did, anyways
[17:46:00] <eddyb> don't want to break things before a snapshot
[17:46:14] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[17:46:14] *** ChanServ sets mode: +ao dherman dherman
[17:47:49] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[17:48:45] <nmatsakis> eddyb: rust-doc in particular doesn't have to be built by snapshot, I don't think
[17:48:52] *** Quits: tabraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[17:48:56] <nmatsakis> or at least I never try to ensure it builds with stage0 :)
[17:49:21] *** Quits: luziiie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[17:49:28] <eddyb> wow cherry pick is easy
[17:49:46] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[17:50:40] <eddyb> nmatsakis: thanks for the tests, I hope this works https://github.com/mozilla/rust/pull/12610
[17:50:54] <eddyb> hmm, why isn't travis picking it up?
[17:51:58] <nmatsakis> eddyb: r+ anyhow
[17:52:08] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[17:52:08] <ghrust> [13rust] 15bors pushed 18 new commits to 06auto: 02http://git.io/2_m9ow
[17:52:08] <ghrust> 13rust/06auto 147b33d51 15Alex Crichton: std: Relax an assertion in oneshot selection...
[17:52:08] <ghrust> 13rust/06auto 14c404e4b 15Alex Crichton: green: Fix a scheduler assertion on yielding...
[17:52:08] <ghrust> 13rust/06auto 1420f8220 15Peter Marheine: doc: discuss try! in std::io
[17:52:10] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[17:52:14] <eddyb> rollup?
[17:52:22] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[17:52:27] * nmatsakis nervous that he forgot the change to check autoderef in borrow checker
[17:52:31] <nmatsakis> I wonder what else i've forgotten :)
[17:52:41] <eddyb> (but not for autoderef, that's complicated enough)
[17:52:44] <eddyb> nmatsakis: hmm?
[17:53:03] <nmatsakis> just saying, your fix to borrowck reminds me that while I understood the code you wrote, it's hard to think about the code you DIDN'T write that might have been needed
[17:53:20] <eddyb> oh, yeah, regionck & borrowck can be like that
[17:53:23] <nmatsakis> but best we can do is try to add a lot of tests for corner cases and make sure they do what we expect
[17:53:27] <eddyb> hopefully CFG makes it easier
[17:53:32] <nmatsakis> yes 
[17:53:35] <nmatsakis> it would be vastly vastly easier
[17:53:37] <nmatsakis> if we desugared
[17:53:40] <eddyb> nmatsakis: thanks, be back in some time
[17:55:49] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:55:49] *** ChanServ sets mode: +qo brson brson
[18:02:17] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:02:17] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:05:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:07:38] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[18:10:20] *** Quits: krdln (Mibbit@moz-C271714F.dynamic.chello.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[18:17:10] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[18:22:05] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[18:22:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14be13b76 to 141835667: 02http://git.io/N3iJvQ
[18:22:05] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[18:22:06] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[18:22:06] <ghrust> [13rust] 15bors pushed 18 new commits to 06auto: 02http://git.io/z94OdA
[18:22:06] <ghrust> 13rust/06auto 147b33d51 15Alex Crichton: std: Relax an assertion in oneshot selection...
[18:22:06] <ghrust> 13rust/06auto 14c404e4b 15Alex Crichton: green: Fix a scheduler assertion on yielding...
[18:22:07] <ghrust> 13rust/06auto 1420f8220 15Peter Marheine: doc: discuss try! in std::io
[18:22:09] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[18:27:15] <erickt> acrichto / kimundi: does your `_` type pr (https://github.com/mozilla/rust/pull/12764) support top level fn return types? or is it only for inside a fn?
[18:28:05] <erickt> acrichto / kimundi: oh, I see you explicitly forbid it on top-level items.
[18:28:22] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:28:22] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:28:40] <kimundi> erickt: Right, it does not work for for global inference
[18:29:12] <erickt> kimundi: I only mention this because of my old rfc to support fn return type deduction: https://github.com/mozilla/rust/issues/10448
[18:30:23] <erickt> kimundi: something like this, in my opinion, is really needed for returning iterators or generators if/when we add them
[18:32:04] <kimundi> erickt: Talk to eddyb about that :)
[18:32:34] <kimundi> Personally I think you don't need that for that feature in peculiar
[18:32:58] <edwardw> nmatsakis: still got `unconstrained type` error even manually implementing `Clone` and `Eq` for CovariantType. couldn't found a way to circumvent that either: transmute is not present for stage0 `std`
[18:33:06] <erickt> kimundi: for iterators/generators? why not?
[18:34:03] <edwardw> nor `rustc::middle::lang_items` for that matter
[18:34:05] <eddyb> erickt: that's different
[18:34:10] <eddyb> erickt: that's not inference at all
[18:34:30] <kimundi> erickt: Because you can just as well require the user to pick a name, like for any other type definition
[18:35:06] <eddyb> erickt: I know how to implement anonymous types
[18:35:12] <eddyb> type checking and everything
[18:35:24] <eddyb> I can explain it in detail if you want to do it
[18:35:34] <erickt> eddyb: cool! sure
[18:35:53] <nmatsakis> edwardw: send me your impls
[18:36:54] *** Quits: japaric (japaric@4DDCA20.F60EC59D.F29ED47E.IP) (Ping timeout)
[18:37:43] *** Joins: japaric (japaric@A3BB1393.E3ED3AAA.BFC118EE.IP)
[18:38:00] <erickt> eddyb / kimundi: I'm not really crazy about adding return type deduction/inference/whatever, I just couldn't think of a better way to make `fn foo<'a>(x: &'a [int]) -> ?? { x.iter().map(|x| *x + 1).map(|x| *x + 2).filter(|x| *x == 1) }` not have to have a 50+ char type
[18:38:39] <edwardw> nmatsakis: https://gist.github.com/edwardw/9513465
[18:38:48] <kimundi> erickt: Eh, if thats the only problem you can just define a wrapper type
[18:39:01] <kimundi> or typedef
[18:40:00] <eddyb> erickt: it's a different type, like ty_param, with traits on it
[18:40:04] <SiegeLord> With a sufficiently advanced IDE plugin, you could auto-complete the return type, hehe
[18:40:21] <eddyb> erickt: the identifying information is the DefId of the function that returns it
[18:40:50] <erickt> kimundi: yeah, and that's what we do, it can just get pretty painful.
[18:41:04] <eddyb> erickt: that allows type checking without knowing the concrete type. type checking the function returning the anonymous type will combine all the return types to obtain the concrete return type
[18:41:21] <eddyb> that return type has to implement all the traits it wants to expose
[18:42:00] <eddyb> the concrete return type is inserted into a map, which trans uses to substitute the anonymous-return-type-of-function with
[18:42:04] <eddyb> erickt: does that make sense?
[18:43:41] <erickt> eddyb: cool. I think so.
[18:44:05] <eddyb> it should allow things like struct {x: Some(x)} impl Iterator<T> {fn next(&mut self) -> Option<T> {self.x.take()}}
[18:44:34] <eddyb> so that's an anonymous type, but only because you can't refer to it
[18:44:36] <erickt> eddyb: this is a little bit of a silly question, but could we give these anonymous types a name? so rather than them being anonymous, they're abstract to the user?
[18:44:59] <mrmonday> any chance someone could compile the test suite for my branch and see what's going wrong? (github/mrmonday/raw-socket-support) I'm getting weird errors about mismatching types when the types are definitely the same.
[18:45:15] <eddyb> erickt: hmm, that's a bit of a hard question
[18:45:29] <mrmonday> I'm leaning towards calling it a compiler bug, but I can't be sure/can't reduce it right now
[18:45:43] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[18:45:45] <erickt> eddyb: just so someone could do `struct Foo { a_generator: generator_method::Ty }`
[18:45:47] <mrmonday> (needs to be compiled with --cfg hasroot, which the build system won't do yet)
[18:45:58] <eddyb> erickt: ohh, associated types
[18:46:09] <eddyb> erickt: you can totally do that with traits
[18:46:29] <erickt> just another reason for associated types :)
[18:46:54] <eddyb> impl<..Args, Ret> BareFn for fn(..Args) -> Ret {type ReturnType = Ret;}
[18:47:04] <eddyb> that's a very elegant solution IMO
[18:47:38] <erickt> I agree
[18:47:40] *** Joins: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net)
[18:47:59] <erickt> has anyone implemented `nmatsakis.clone()` yet? :)
[18:48:33] <eddyb> erickt: across one Atlantic ocean and one Europe, it's hard
[18:48:49] <kimundi> Eh, thats what RPC are for
[18:48:54] <eddyb> memcpy-ing the brain, that is. not a lot of bandwidth
[18:48:58] <eddyb> kimundi: hehehe
[18:49:05] <eddyb> erickt: what I was thinking is, with that struct literal: anonymous struct/enum, which doesn't have a name but still is a concrete type which can be inferred and you can impl a bunch of traits on it
[18:49:06] <erickt> hehe
[18:49:45] <erickt> eddyb: I like this
[18:49:51] <edwardw> IRC is human-oriented RPC then
[18:50:06] <eddyb> erickt: it may be a bad idea, but would be useful for creating Fn impls when we get that
[18:50:34] <eddyb> like Java's anonymous classes, which are a poor substitute for anonymous functions
[18:50:40] <erickt> eddyb: there seems to be some strong movement towards a Fn trait, so I bet it'll happen before 1.0
[18:51:15] <eddyb> just need VG. brson&others don't seem too keen on advancing on that front
[18:51:38] <eddyb> and I understand, DST still needs a lot of work put into it
[18:51:43] <erickt> VG? I'm unfamiliar with that acronym.
[18:51:54] <cmr> variadic generics
[18:51:58] <eddyb> I've gotten tired of spelling out "variadic generics"
[18:51:59] <erickt> and here I was thinking we were due for a new rust acroynm
[18:52:51] <erickt> all we need is two more and we probably have enough for the next rust t shirt
[18:52:57] <eddyb> nmatsakis: *sigh* I think pnkfelix introduced more borrow calls and whatnot (i.e. that rebase had issues other than conflicts)
[18:53:13] <eddyb> DeSTiny
[18:53:21] <eddyb> HusKy Trainer
[18:53:34] <eddyb> Virgin Galactics
[18:53:39] <erickt> Vain Groupies
[18:53:45] <eddyb> those are awful, but I tried
[18:54:59] <erickt> INHTPAMA is going to be a hard one
[18:55:18] <erickt> or is it INHTWAMA?
[18:55:37] <eddyb> "write barriers on @" aka INHTPAMA aka INHTWAMA aka &alias mut (nmatsakis)
[18:55:43] <eddyb> https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-01-08 what?
[18:56:14] <erickt> eddyb: have you made an issue for this anonymous type idea of yours?
[18:56:39] <pnkfelix> eddyb: Imagine Never Having To Hear blah blah 
[18:56:40] <eddyb> it's mostly implementation details of someone else's idea (one that includes a list of traits in the return type)
[18:56:51] <pnkfelix> eddyb: http://www.smallcultfollowing.com/babysteps/blog/2012/11/18/imagine-never-hearing-the-phrase-aliasable/
[18:57:30] <pnkfelix> eddyb: or maybe you already knew that
[18:57:39] <eddyb> no I didn't
[18:57:49] <eddyb> pnkfelix: so thanks :)
[18:58:21] <eddyb> so 3 days of this weeks have already been wasted. good job, dude
[18:58:25] <pnkfelix> eddyb: I have to go, but I saw your note to nmatsakis; is introducing borrow calls a problem?
[18:58:42] <eddyb> yes, because I have to rewrite them to "deref"
[18:58:56] <eddyb> I hope no patch in the rollup does that
[18:59:06] <eddyb> pnkfelix: and remove them when we get a snapshot
[18:59:28] <eddyb> pnkfelix: fixing these atm https://travis-ci.org/mozilla/rust/jobs/20627242
[18:59:43] <pnkfelix> eddyb: hmm, I didn't realize we were handling borrows under Deref trait, for some reason I thought we were treating them under a different class
[18:59:57] <pnkfelix> eddyb: but I'll have to ask you more about that at a different time, since I do need to go now
[19:00:03] <eddyb> "borrow" was just a simple impl on Rc
[19:00:15] <eddyb> we want x.borrow().foo to become x.foo
[19:00:26] <eddyb> deref technically does what borrow did, if you call it as a method
[19:00:26] <pnkfelix> eddyb: maybe it was borrow_mut I was thinking of
[19:00:48] <eddyb> when you use it through *x or auto-deref, it also derefs the &T you get from the deref call
[19:00:58] <eddyb> magic, basically
[19:02:06] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[19:05:47] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[19:07:08] <eddyb> crap, I shouldn't have touched that commit with rebase :(
[19:09:43] <eddyb> aaaand github is laggy. gj
[19:12:05] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[19:12:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14097ff69 to 141835667: 02http://git.io/N3iJvQ
[19:12:05] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[19:12:06] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[19:12:06] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/e6BxgQ
[19:12:06] <ghrust> 13rust/06auto 140349f2a 15Piotr Czarnecki: libstd: Change `slice_shift_char`, `shift_char`, `pop_char`, `shift_byte` and `pop_byte` to return an Option instead of failing
[19:12:06] <ghrust> 13rust/06auto 14262d154 15Piotr Czarnecki: libstd: Add unit tests for `slice_shift_char`
[19:12:08] <ghrust> 13rust/06auto 14b0e855a 15Piotr Czarnecki: libstd: Update docs for `slice_shift_char` and {shift,pop}_{char,byte}
[19:12:10] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[19:12:12] <eddyb> *sigh*
[19:20:01] *** Quits: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net) (Quit: Sharp)
[19:21:34] <TimAbraldes> I'm seeing this when trying to build rust on Windows - ln: creating symbolic link `/c/src/rust/i686-pc-mingw32/llvm/Release+Asserts/bin/llvm-ranlib.exe' to `llvm-ar.exe': No such file or directory - Anyone seen this before?
[19:22:34] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:23:11] *** Joins: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net)
[19:25:57] *** Quits: edwardw (edwardw@D286B842.1B2F6624.7F41E82D.IP) (Ping timeout)
[19:26:35] <eddyb> nmatsakis: r? https://github.com/mozilla/rust/pull/12610
[19:26:58] *** Joins: edwardw (edwardw@B5386878.16F55560.50B134B9.IP)
[19:29:36] <eddyb> strcat isn't here and I don't understand his comment
[19:30:31] <eddyb> he didn't r- so I guess I'm fine
[19:31:16] <eddyb> oh dear is there anyone around to r=nmatsakis https://github.com/mozilla/rust/pull/12610?
[19:31:57] <eddyb> I don't want it to be delayed another day
[19:32:05] <eddyb> acrichto: the rollup failed on windows? *sigh*
[19:32:08] <cmr> did he already r+ it?
[19:32:44] <eddyb> cmr: yupp
[19:33:04] <eddyb> but travis failed because of a rebase that I didn't inspect carefully
[19:33:14] <eddyb> (pnkfelix changed things around)
[19:33:26] <eddyb> cmr: thanks :D
[19:33:50] <eddyb> "last week in rust" hehe
[19:33:53] <eddyb> *almost* made it
[19:34:58] <eddyb> nmatsakis: the syntax for self destructuring isn't new, fwiw... it's just the @ syntax we have on patterns anyway
[19:36:57] <eddyb> "brson: Let's do it." best sound to my ears
[19:37:58] <larsberg> eddyb: I've been debating turning those into "Make it so, #1." in the notes (since I already take some small liberties...)
[19:39:16] <eddyb> Rust RFCs: essays + technical writing. two things I'm bad at
[19:39:35] <eddyb> so tempted to get 0001-variadic-generics in that repo
[19:39:45] <eddyb> or maybe I should wait for 0007
[19:39:59] <eddyb> "the bullet to kill them all"
[19:46:22] <kimundi> eddyb: You need to speed up a bit if you still want to be 7th ;)
[19:46:32] <eddyb> sheesh
[19:47:08] <eddyb> https://github.com/rust-lang/rfcs/pull/5/files :(
[19:49:13] <eddyb> cmr: travis build passed \o/
[19:49:24] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[19:49:26] <eddyb> just have to wait in line
[19:51:50] <eddyb> kimundi: sometimes I just give up and relax
[19:52:05] <eddyb> I should stop caring about progress and enjoy the ride *without slacking*
[19:52:55] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:53:34] <eddyb> strcat: what's this about? https://github.com/mozilla/rust/pull/12845#discussion_r10533788
[19:53:54] <strcat> unsafe drop flag doesn't work that way
[19:54:05] <eddyb> I got that part
[19:54:05] <strcat> zeroing fields yourself doesn't do anything
[19:54:26] <strcat> it's unsafe because after a move, it still runs the destructor on the moved from value
[19:54:28] <strcat> no other reason
[19:54:40] <eddyb> so... I shouldn't zero anything?
[19:54:44] <strcat> you shouldn't zero anything
[19:54:46] <strcat> it doesn't do anything
[19:54:53] <eddyb> for some reason I thought it was efficient
[19:55:00] <eddyb> and zeroing only the drop flag
[19:55:07] <strcat> unsafe_no_drop_flag zeroes the entire struct
[19:55:12] <strcat> on a move
[19:55:18] <eddyb> oh ok wasn't sure
[19:55:33] <strcat> eddyb: it wouldn't work if it was implemented the way you're handling
[19:55:55] <strcat> foo(x)
[19:55:58] <strcat> move from `x`
[19:56:01] <eddyb> derp
[19:56:02] <strcat> anyway lets say `x` has the dtor called now
[19:56:12] <eddyb> yeah I totally get it now
[19:56:23] <eddyb> strcat: had this issue while trying to design a test
[19:56:32] <strcat> eddyb: you just need to add a null ptr check at the top of the dtor
[19:56:55] <strcat> we could improve #[unsafe_no_drop_flag] to be called #[unsafe_drop_flag] and be placed on a field instead of the whole struct
[19:56:56] <eddyb> doesn't it do nothing when zeroed out?
[19:57:08] <strcat> eddyb: I guess not
[19:57:27] <strcat> in that case you don't need to do anything
[19:57:30] <strcat> other than adding the attribute
[19:57:40] <eddyb> okay, changing it
[19:57:48] <strcat> just add a comment saying that it's a no-op when zeroed by unsafe_no_drop_flag
[20:01:28] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[20:01:53] <eddyb> strcat: r? https://github.com/mozilla/rust/pull/12845#discussion_r10533788
[20:03:48] <eddyb> thanks :D
[20:04:09] <eddyb> strcat: did you see this? can you tell why it's awesome? https://gist.github.com/eddyb/20fb641bc5e3794049da
[20:10:35] <strcat> eddyb: hm?
[20:11:04] <eddyb> strcat: 90% of our types are garbage by the time type checking the function that created them finishes
[20:11:22] <eddyb> hundreds of MBs for the picking
[20:11:49] <aatch> eddyb, the "1085634 types contain inference variables"?
[20:11:55] <eddyb> yupp
[20:12:41] <eddyb> also, ty_trait is the largest sty variant, but look how rare it is
[20:13:09] <aatch> eddyb, so move some of it's contents behind a pointer?
[20:13:26] <eddyb> mhmm. thought ClosureTy was the largest, I think it's the second actually
[20:13:56] <eddyb> that doesn't help too much though, just reduces heap bloat
[20:14:24] <eddyb> the main fix is a per-function has_infer interner with an arena that can be dropped as soon as type checking finishes in that function
[20:15:01] <eddyb> there are some issues with that... mainly the two lifetimes that may cause problems
[20:15:19] <eddyb> but, for example, types in the main interner shouldn't refer to types in the has_infer interner
[20:15:31] <eddyb> so it's not like you can construct anything unsafe with it
[20:15:49] <eddyb> (even when we switch to a completely safe tcx :D)
[20:22:09] *** Quits: edwardw (edwardw@B5386878.16F55560.50B134B9.IP) (Quit: Leaving...)
[20:22:14] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[20:22:14] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/e6BxgQ
[20:22:14] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[20:24:19] <cmr> eddyb: good luck.
[20:25:03] <eddyb> cmr: may the odds be ever in my favor, amirite?
[20:25:06] <eddyb> (thanks :D)
[20:27:10] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[20:27:10] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/CcX4-g
[20:27:10] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[20:27:10] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[20:27:10] <ghrust> [13rust] 15bors pushed 8 new commits to 06auto: 02http://git.io/9HnB7g
[20:27:10] <ghrust> 13rust/06auto 1463a14a1 15Eduard Burtescu: Remove Rc's borrow method to avoid conflicts with RefCell's borrow in Rc<RefCell<T>>.
[20:27:10] <ghrust> 13rust/06auto 14c633378 15Eduard Burtescu: Implement automatic overloaded dereference....
[20:27:11] <ghrust> 13rust/06auto 14b052929 15Eduard Burtescu: Introduce a common recursion limit for auto-dereference and monomorphization.
[20:27:13] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[20:31:59] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[20:32:12] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[20:32:31] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[20:32:31] *** ChanServ sets mode: +ao pcwalton pcwalton
[20:33:22] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:33:26] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:45:59] *** Quits: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net) (Quit: Sharp)
[20:47:53] *** Joins: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net)
[20:49:55] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[20:50:32] *** Joins: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu)
[20:53:31] <brson> should have called rfcs rust
[20:53:35] <brson> er, rust-rfcs
[21:01:33] <nmatsakis> eddyb: regarding types etc, I'd like to have types with inference variables be a distinct type,
[21:01:49] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[21:01:58] <nmatsakis> eddyb: we could have an arena in the fcx that is used to allocate types during typeck,
[21:02:05] <nmatsakis> eddyb: and then during writeback we allocate from the central arena
[21:02:11] <eddyb> nmatsakis: nah there's no need
[21:02:28] <eddyb> nmatsakis: it's pretty easy to allocate in an arena based on has_infer
[21:02:30] <nmatsakis> there is a need
[21:02:35] <nmatsakis> that has nothing to do with that
[21:02:55] <nmatsakis> it cleans up the code, proves that bad situations don't occur, guarantees that writeback always does substitutions, and so on.
[21:03:00] <nmatsakis> well, need is strong, but there are advantages
[21:03:01] <eddyb> good job, whoever made this fail http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-t/builds/3800/steps/test/logs/stdio
[21:03:20] <eddyb> *sigh* we'll have to wait until tomorrow
[21:04:04] <eddyb> and I'll have to rebase again on top of the rollup
[21:04:19] <eddyb> good night
[21:04:49] <nmatsakis> eddyb: d'oh 
[21:05:54] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[21:06:13] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[21:06:45] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[21:08:55] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:12:10] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[21:12:10] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ca0f57e to 143316a0e: 02http://git.io/N3iJvQ
[21:12:10] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[21:12:11] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[21:12:12] <ghrust> [13rust] 15bors pushed 14 new commits to 06auto: 02http://git.io/Os9yQA
[21:12:12] <ghrust> 13rust/06auto 1480f92f5 15Alex Crichton: std: Relax an assertion in oneshot selection...
[21:12:12] <ghrust> 13rust/06auto 1491bed14 15Alex Crichton: green: Fix a scheduler assertion on yielding...
[21:12:12] <ghrust> 13rust/06auto 14207ebf1 15Peter Marheine: doc: discuss try! in std::io
[21:12:14] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[21:15:24] <strcat> nmatsakis: https://github.com/mozilla/rust/issues/12853 have you seen this issue before?
[21:15:51] <strcat> I wonder if it's a type inference bug caused by generic integers, hm
[21:16:15] <strcat> brson: +1000 for the new rfc process btw ;p
[21:16:24] *** Joins: esummers_ (esummers@moz-3B015C90.wi.res.rr.com)
[21:16:27] <strcat> the current situation has frustrated me a lot
[21:16:36] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[21:16:49] *** Quits: esummers_ (esummers@moz-3B015C90.wi.res.rr.com) (Connection reset by peer)
[21:17:03] *** Joins: esummers_ (esummers@moz-3B015C90.wi.res.rr.com)
[21:18:32] <sfackler> strcat: that may be related to https://github.com/mozilla/rust/issues/11640
[21:20:36] <nmatsakis> strcat: I hadn't seen that, I'm not surprised by the behvaior
[21:20:59] <nmatsakis> that is, it's the defined behavior right now, but I agree it's suboptimal
[21:21:17] <nmatsakis> it's basically the same as #11640,
[21:21:20] <nmatsakis> I guess there is some question,
[21:21:26] <nmatsakis> as to whether we should require the &'static [1, 2, 3]
[21:21:29] <strcat> nmatsakis: the weird thing is that I think it's different in some cases
[21:21:34] <nmatsakis> no, not really
[21:21:37] <strcat> rusti: let xs = [1, 2, 3]; xs.as_slice()
[21:21:38] -rusti- pastebinned 16 lines of output: http://sprunge.us/hWWW
[21:21:44] <strcat> rusti: &[1, 2, 3]
[21:21:45] -rusti- &[1, 2, 3]
[21:21:48] <strcat> why does that work?
[21:22:10] <nmatsakis> I'd have to see the actual program in question
[21:22:25] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[21:22:30] <nmatsakis> rusti: let xs = &[1, 2, 3]; xs
[21:22:31] -rusti- pastebinned 34 lines of output: http://sprunge.us/cXIC
[21:22:38] <nmatsakis> I presume that expands to something like:
[21:22:42] <nmatsakis> let foo = { ... }; print(foo)
[21:22:46] <strcat> let r = { expr } yeah
[21:22:50] <nmatsakis> in that case, the temporary lifetime rules apply, they treat the tail expr in a block
[21:22:54] <nmatsakis> differently from the statements
[21:22:58] <strcat> ah
[21:23:31] <brson> strcat: good to know, thanks
[21:24:28] <strcat> I wonder if I should switch rusti to Show
[21:25:46] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[21:29:29] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[21:30:00] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[21:30:00] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:30:23] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[21:32:42] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[21:37:21] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[21:37:21] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:40:16] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[21:42:59] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[21:50:42] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:52:59] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Quit: Leaving)
[21:56:58] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[22:00:57] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[22:00:58] *** ChanServ sets mode: +o tjc
[22:02:44] *** Quits: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu) (Quit: lkuper)
[22:07:09] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[22:07:09] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14201fd5d to 143316a0e: 02http://git.io/N3iJvQ
[22:07:09] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[22:07:11] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[22:07:11] <ghrust> [13rust] 15bors pushed 13 new commits to 06auto: 02http://git.io/eaXfZg
[22:07:11] <ghrust> 13rust/06auto 1480f92f5 15Alex Crichton: std: Relax an assertion in oneshot selection...
[22:07:11] <ghrust> 13rust/06auto 1491bed14 15Alex Crichton: green: Fix a scheduler assertion on yielding...
[22:07:12] <ghrust> 13rust/06auto 14207ebf1 15Peter Marheine: doc: discuss try! in std::io
[22:07:14] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[22:22:47] *** Joins: intuxicated (intuxicate@7269D995.26CEB0C7.3FFBF42F.IP)
[22:28:19] <larsberg> This may require pcwalton (it's his code, and is a bit magical), but can anybody decipher the error messages at: https://gist.github.com/larsbergstrom/9517788 ? I don't even know what "mismatched types" can mean on the declaration of a field of a struct...
[22:30:25] <acrichto> larsberg: oh that's probably coming from deriving
[22:30:36] <acrichto> it may not have one of Clone/Eq implemented for it
[22:30:42] <acrichto> although I would think that () would have both implemented...
[22:31:40] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[22:31:40] *** ChanServ sets mode: +ao pcwalton pcwalton
[22:36:05] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:42:52] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Quit: leaving)
[22:46:30] <larsberg> acrichto: thanks! I'll also bug pcwalton, since he just appeared :-)
[22:46:55] <larsberg> pcwalton: https://gist.github.com/larsbergstrom/9517788 are some errors in the wrapper.rs code in layout - acrichto thinks it might be missing Clone/Eq - any ideas what I should do here?
[22:47:48] <pcwalton> probably something is missing a trait bound
[22:47:52] <pcwalton> just try manually implementing Clone/Eq
[22:48:05] <larsberg> OK, will do
[22:55:16] <larsberg> pcwalton, acrichto: that did it (had to implement both Clone & Eq manually)
[22:56:07] <acrichto> rusti: () == ()
[22:56:08] -rusti- true
[22:56:12] <acrichto> rusti: ().clone()
[22:56:13] -rusti- ()
[22:56:21] <acrichto> rusti: (&()) == (&())
[22:56:22] -rusti- true
[22:56:26] <acrichto> rusti: (&()).clone()
[22:56:27] -rusti- ()
[22:56:36] <acrichto> larsberg: huh, I dunno why the deriving impl didn't work
[22:57:02] <acrichto> or actually I don't think you can derive clone for structs with borrowed pointers
[22:57:20] <acrichto> rusti: #[deriving(Clone)] struct Foo<'a>(&'a int);
[22:57:21] -rusti- pastebinned 7 lines of output: http://sprunge.us/bZNC
[22:57:37] <acrichto> rusti: #[deriving(Clone)] struct Foo<'a>(&'a ());
[22:57:38] -rusti- pastebinned 7 lines of output: http://sprunge.us/WWVI
[22:57:50] <acrichto> aha
[23:01:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:02:20] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[23:02:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:02:33] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[23:04:45] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[23:05:33] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[23:07:39] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:09:03] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[23:09:03] *** ChanServ sets mode: +o tjc
[23:12:01] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[23:12:13] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[23:17:10] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[23:17:10] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/eaXfZg
[23:17:10] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[23:18:12] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[23:21:49] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[23:21:49] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/2Q5J4w
[23:21:49] <ghrust> 13rust/06auto 145bdbd21 15Clark Gaebel: Performance-oriented hashtable....
[23:21:49] <ghrust> 13rust/06auto 14ec04937 15bors: auto merge of #12081 : cgaebel/rust/robinhood-hashing, r=alexcrichton...
[23:21:49] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[23:23:57] *** Quits: esummers_ (esummers@moz-3B015C90.wi.res.rr.com) (Connection reset by peer)
[23:23:57] *** Joins: esummers__ (esummers@moz-3B015C90.wi.res.rr.com)
[23:24:19] *** Quits: esummers__ (esummers@moz-3B015C90.wi.res.rr.com) (Connection reset by peer)
[23:24:39] *** Joins: esummers__ (esummers@moz-3B015C90.wi.res.rr.com)
[23:41:00] *** Joins: mawuli (mawuli@moz-A135DF9D.com.gh)
[23:43:21] *** Quits: gimpf (gimpf@moz-648EA225.adsl.highway.telekom.at) (Quit: Leaving.)
[23:43:32] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[23:45:30] <cgaebel> yay hashmap landed!
[23:45:45] *** Joins: luziiie (luziie@moz-CD18B14B.customer.cdi.no)
[23:46:47] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[23:47:03] *** Quits: mawuli (mawuli@moz-A135DF9D.com.gh) (Ping timeout)
[23:49:03] *** Quits: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net) (Quit: Sharp)
[23:54:38] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
