[00:00:08] <aatch> It propogates known limits on values
[00:00:21] <acrichto> aatch: if I told you that upgrading to llvm-current caused an infinite loop in that pass, would it mean anything?
[00:00:34] *** Joins: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com)
[00:00:38] <aatch> acrichto, nope.
[00:00:46] <acrichto> aww :(, oh well
[00:00:48] <strcat> maybe we output an incorrect range metadata node
[00:01:10] <acrichto> we have range metadata?
[00:01:14] <strcat> yes
[00:01:22] <strcat> on enum discriminants and bools
[00:01:26] <strcat> on the loads
[00:01:36] <acrichto> oh that's nice
[00:02:06] <strcat> anyway that's a shot in the dark
[00:02:26] <acrichto> oh wait no, it made progress, it just took waaaaay longer than usual
[00:02:41] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[00:02:42] *** Quits: jeff (jeff@moz-F81F6C4E.nyc.biz.rr.com) (Quit: jeff)
[00:02:44] <acrichto> and then hit an assertion in llvm
[00:03:01] *** Quits: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[00:03:21] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[00:03:50] <busylizzy> hi guys. i can't find libuv bindings in 'extra' crate. where did it go?
[00:05:02] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[00:05:12] <brson> i probably should have sent an email to the list about this
[00:05:34] <brson> busylizzy: they've been removed in preparation for replacing the scheduler with a new implementation
[00:06:10] <brson> there will be a new way to do i/o when that happens
[00:06:22] <brson> could be a week still
[00:07:02] <acrichto> strcat: r? https://github.com/mozilla/rust/pull/7115 the current llvm is tripping internal assertions during object emission :(
[00:07:02] <busylizzy> brson: is there some example of this new way? :)
[00:07:17] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:07:39] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[00:07:51] <strcat> acrichto: r+, oh well :
[00:07:53] <strcat> :) *
[00:08:01] <acrichto> thanks!
[00:08:26] *** Joins: muslimasry (dasdasd@E359850F.797E8147.DB9D6342.IP)
[00:08:29] *** Quits: muslimasry (dasdasd@E359850F.797E8147.DB9D6342.IP) (User has been banned from Mozilla (abuse))
[00:09:20] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[00:09:38] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[00:09:49] <strcat> graydon: seems the transition to foreach also dropped off ~0.5MiB from the size
[00:10:02] <graydon> not surprised
[00:10:17] <graydon> I am curious how much room there is for optimizing codegen on match { ... }
[00:10:22] <graydon> it seems like still some, in the codegen tests
[00:11:09] <strcat> rusti: let copy = 5; copy
[00:11:10] -rusti- 5
[00:11:15] <steven_is_false> Hello. With the following buggy version of dynamic_lib.rs http://pastebin.mozilla.org/2761597 compiling the test version of the standard library works fine. With http://pastebin.mozilla.org/2761598 (which should fix a crash) though an ICE occurs. Can anyone figure out what causes the ICE?
[00:12:45] <brson> busylizzy: no, there isn't but here are some tcp test cases https://github.com/mozilla/rust/blob/master/src/libstd/rt/io/net/tcp.rs#L392
[00:14:55] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[00:17:11] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[00:18:07] <brson> toddaaro: is this pr ready to r+?
[00:18:37] <toddaaro> brson: maybe? I think I xfailed the test correctly
[00:18:58] <toddaaro> brson: I did "// xfail-fast" at the top of the testcase and I don't think it ran when I tried running the suite
[00:19:47] <toddaaro> brson: I'll push the commit now
[00:19:50] <brson> toddaaro: it needs to say '// xfail-test'. xfail-fast is only for win32
[00:20:02] <toddaaro> ok, change made
[00:20:18] <brson> how do I cast a register to rust_task* in gdb: `print/x (rust_task*)$esi` doesn't work
[00:21:00] <busylizzy> brson: thanks
[00:21:05] <kmc> how does it fail?
[00:21:57] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:22:04] <brson> kmc: A syntax error in expression, near `)$esi'.
[00:22:59] <brson> gr, can't db-attach in valgrind without root
[00:23:46] <kmc> brson: huh, that syntax works for me in GDB 7.4.1
[00:24:08] <toddaaro> brson: k, should be all set
[00:24:20] <toddaaro> brson: double-check I did the xfail correctly in the final commit
[00:24:30] <brson> toddaaro: thanks, looks good
[00:26:33] *** Quits: sigma-pc (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Connection reset by peer)
[00:27:17] *** Quits: eholk (eholk@8CCCE0FC.83FFA18A.ABD5273E.IP) (Quit: eholk)
[00:28:09] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[00:28:29] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[00:31:37] <brson> does anybody else have specific opinions about whether ToStr should have a method that writes to a StringWriter and to_str() -> ~str should be implemented in terms of that?
[00:31:46] <brson> #8089
[00:32:21] *** Quits: KindOne (KindOne@F65A5124.5D2364C3.EC6A1518.IP) (Ping timeout)
[00:32:57] <brson> I'm inclined to do it
[00:33:28] <Eridius> brson: sounds reasonable, assuming this to_str() definition is a default impl so you can override it
[00:33:42] *** Joins: maikklein (maik@moz-AEFED0CC.dip0.t-ipconnect.de)
[00:34:06] <brson> Eridius: I think write_str is non-default and to_str is default, so you have to implement write_str and can't iloop between the mutually recursive default methods
[00:35:53] <Eridius> brson: can you not make them both default, so you only have to implement one?
[00:36:14] *** Joins: KindOne (KindOne@187DC4EC.E114B4AE.EC6A1518.IP)
[00:36:31] <sfackler> i'd prefer to force people to implement at least one of to_str and to_str_writer
[00:36:50] <sfackler> but since that isn't possible at the moment...
[00:37:19] <Eridius> would be nice if the default method stuff could detect when a trait requires that at least one method is overridden
[00:38:10] <brson> we can make them both default
[00:38:29] <sfackler> but then you infinite loop if you do an empty impl, right?
[00:38:49] <engla> brson: I see your comment
[00:41:45] <brson> how do I make gdb always show the current instruction?
[00:41:48] <brson> god i hate gdb
[00:41:52] <brson> i'll never figure it out
[00:42:14] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[00:42:15] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:43:50] <brson> display/i $pc
[00:43:55] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[00:44:25] *** Joins: tjc (tjc@5CF3EFEE.5BF962AE.AA5CA73A.IP)
[00:44:25] *** ChanServ sets mode: +o tjc
[00:44:47] <steven_is_false> So I figured out the bug, and filed an issue https://github.com/mozilla/rust/issues/8208
[00:46:40] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[00:46:42] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[00:47:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[00:48:16] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[00:48:16] *** ChanServ sets mode: +o pcwalton
[00:48:39] <Eridius> bblum: you around?
[00:48:44] <bblum> Eridius: ayup
[00:48:49] <pcwalton> sully: I believe I found a workaround for my traits problem
[00:48:54] <pcwalton> my @Trait problem
[00:48:58] <pcwalton> it involves getting rid of a generic
[00:49:09] <Eridius> bblum: was 9cc8d2551df191d4a94a4e28c2b45b94403a3f9c (std::rt: Use a constant 4 threads for multithreaded sched tests) actually desired, or is this considered an unfortunate worakround for the low fd limit?
[00:49:19] <pcwalton> is it fine if I post a diff containing the workaround in a bug and @ you on GitHub?
[00:49:22] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:49:30] <Eridius> bblum: because I have an alternate solution that raises the fd limit at https://github.com/kballard/rust/tree/fd-limit
[00:49:44] <Eridius> (which I just rebased onto recent master, but it was written and tested before your commit)
[00:50:09] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:50:38] <bblum> Eridius: i can't find that commit; i don't remember writing it
[00:50:44] <bblum> it does not seem like it would be desired at all
[00:50:51] <Eridius> bblum: ohh, you didn't. you just committed it. Sorry, didn't erad carefully
[00:50:53] <Eridius> *didn't read
[00:51:02] <bblum> no prob
[00:51:06] <Eridius> looks like brson wrote it. brson, you htere?
[00:51:12] <Eridius> dammit I'm typoing a lot today
[00:52:58] <Eridius> bblum: also you couldn't find it because the correct short hash is 49b72bdd. There were 4 versions that got referenced in #7772 and I assumed the last was the correct one
[00:53:08] <bblum> i see
[00:53:20] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[00:54:01] <mihneadb> I have a question
[00:54:03] <mihneadb> so.. this will not work
[00:54:05] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[00:54:06] <mihneadb> rusti: foreach c in "hello".iter() {printfln!("%?", c)}
[00:54:10] <mihneadb> sorry
[00:54:12] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/NDjj
[00:54:15] <mihneadb> rusti: foreach c in @"hello".iter() {printfln!("%?", c)}
[00:54:16] <mihneadb> this
[00:54:18] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/iLiG
[00:54:18] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Max SendQ exceeded)
[00:54:19] <mihneadb> with @"hello"
[00:54:29] <mihneadb> how could I make it work
[00:54:52] <mihneadb> as in.. can I give a whole function (with explicitly typed arguments) literal ?
[00:55:02] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[00:55:13] <Eridius> rusti: foreach c in (@"hello").iter() { printfln!(c) }
[00:55:15] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/GUXS
[00:55:19] <Eridius> mihneadb: ^
[00:55:29] <mihneadb> Eridius: wow what
[00:55:32] <mihneadb> what's the difference?
[00:55:40] <Eridius> your version put the @-box around the results of "hello".iter()
[00:55:43] <engla> operator precedence of @ and .
[00:55:46] <Eridius> precedence is lower than you expected
[00:55:48] <mihneadb> oh crap
[00:55:56] <mihneadb> so it's like in C
[00:56:01] <mihneadb> where you want to do (*x)++
[00:56:04] <bblum> ??????? this is so wrong, how could this not have crashed things earlier?
[00:56:16] <Eridius> bblum: ?
[00:56:22] <mihneadb> Eridius: engla: thanks!
[00:56:33] <bblum> ah, wait, it's not as wrong as i thought
[00:56:36] <bblum> ok, hmm
[00:56:44] <bblum> it's just a little wrong, in a severe but unknown way
[00:58:32] <brson> Eridius: no, I better solution to the fd problem on mac would be great
[00:58:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:58:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/23shsg
[00:58:44] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:59:01] <Eridius> brson: https://github.com/kballard/rust/commit/c4ff250fd7daba3e3642f404a3a577a7c7e1767c
[00:59:25] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[01:00:26] <Eridius> could probably use one tweak to make rlim_cur be cmp::min(maxfiles, rlim_max) instead of just assuming maxfiles is <= rlim_max, but otherwise it works in my tests
[01:00:28] <brson> Eridius: I'm skeptical that using rlimit works though, because limits are inherited from launchctl and, at least on the macs I have, you have to tell launchctl to raise the limit before setting ulimit (otherhwise ulimit silently tells you everything went fine but the limits are still in place). I'm happy to be wrong about this though. Have you verified this fixes the problem when bumping that constant?
[01:00:30] <Eridius> (or at least, it did 15 days ago)
[01:00:50] <Eridius> brson: I tested it when I wrote it, and it fixed the problem for me
[01:02:04] <Eridius> brson: I'm pretty sure launchctl isn't imposing the low 256 fd limit. That's either an artifact of bash or of Terminal.app. Because other OS X apps get a higher default fd limit, only command-line apps don't
[01:02:04] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[01:02:04] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qIaopA
[01:02:04] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[01:02:04] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[01:02:04] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/yClxTw
[01:02:04] <ghrust> 13rust/06auto 14f7eed22 15toddaaro: A major refactoring that changes the way the runtime uses TLS. In the...
[01:02:04] <ghrust> 13rust/06auto 1437f385e 15Ben Blum: Have linked failure tests run on the new scheduler instead of requiring RUST_NEWRT to test.
[01:02:04] <ghrust> 13rust/06auto 14997719c 15toddaaro: Fixed a race where a scheduler configured to only run tasks pinned to it would "bounch" a regular task in and out of the work queue without allowing a different scheduler to run it.
[01:02:04] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[01:02:50] <Eridius> either that or Cocoa bumps the FD limit for you, I haven't actually investigated
[01:02:54] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[01:03:01] *** Joins: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP)
[01:03:51] <Eridius> if I say `launchctl limit` (which I didn't actually realize was a launchctl sub-command until now), it reports 256/unlimited
[01:03:52] <Eridius> so maybe Cocoa is just bumping the FD limit for GUI apps, I dunno
[01:04:33] <Eridius> because this actually reflects the getrlimit values I'm getting back. But sysctl puts an upper limit on the maxfilesperproc, and if you try and set the soft limit above that setrlimit will fail
[01:05:20] <brson> Eridius: does setting cur/max to 0 mean unlimited?
[01:05:20] <Eridius> brson: getrlimit actually returns 1<<63 (or was it 1<<62?) to mean unlimited
[01:05:20] <Eridius> although now I'm curious, what if I set that same value for soft limit? Will that magically work?
[01:05:20] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[01:07:16] <Eridius> brson: nope, setting rlim_cur to rlim_max fails
[01:11:46] <Eridius> brson: https://gist.github.com/kballard/6136777
[01:12:37] <graydon> acrichto: r? https://github.com/mozilla/rust/pull/8209
[01:13:51] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:14:02] <brson> Eridius: it's definitely saying it succeeded, but - just to confirm - you've verified that you can then open 10k files afterwards? not trying to be dense here
[01:14:12] *** Quits: thomaslee (thomaslee@moz-6C3931E3.static.twtelecom.net) (Client exited)
[01:14:24] <Eridius> brson: I did not try to open 10k files, but I confirmed that `make check` succeeded with the patch, whereas it crashed every time without it
[01:14:29] <brson> ok
[01:16:03] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Ping timeout)
[01:16:03] <brson> Eridius: can you add a comment explaining why we're doing this, with the issue number, as well as comments explaining the three library calls, and a commit to revert my workaround, submit a pr and @-mention me?
[01:16:03] <Eridius> brson: will do
[01:16:03] <brson> thanks a bunch
[01:16:03] * Eridius will also run a complete make check again to double-check
[01:20:13] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[01:22:09] <brson> graydon: does your gc branch completely replace std::gc or is there stuff I need to be careful to preserve?
[01:22:32] <brson> it isn't integrated with the new scheduler at all, so I'm stubbing out lots of stuff
[01:23:13] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[01:24:14] <graydon> brson: completely removes it
[01:24:20] <graydon> drop the file, it's dead
[01:24:43] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[01:24:47] <graydon> I'm going to wait on you finishing the new-runtime landing before I have another go at the GC anyways
[01:24:59] <graydon> so I only have one runtime to contend with, not two :)
[01:25:43] <graydon> r? anyone for that matter https://github.com/mozilla/rust/pull/8209
[01:26:53] <Eridius> huh, github has a cute way of indicating that you have no trailing newline on those files
[01:26:55] <tjc> strcat: you got there before me this time :-)
[01:26:56] <Eridius> hadn't seen that one before
[01:27:43] <strcat> Eridius: pretty sure git does that
[01:27:46] <pcwalton> hmm, big bors queue
[01:28:03] *** Joins: brendan (brendaneic@moz-FB09EACF.public.wayport.net)
[01:28:13] <strcat> Eridius: they translate it to a symbol though
[01:28:22] <strcat> it's from git diff --check
[01:29:16] <pcwalton> is everything foreachified yet?
[01:29:21] <bblum> oh freaking brilliant
[01:29:36] <bblum> using valgrind to try to find where this packet was previously freed makes the test case pass.
[01:29:44] <strcat> pcwalton: no, just a lot
[01:29:48] <Eridius> strcat: yeah, and regular diff also has an indicator of it. But github's symbol is cute
[01:29:51] <strcat> pcwalton: 20% drop in compile time from doing most of them
[01:29:58] <pcwalton> optimized compile time?
[01:30:16] <strcat> yeah
[01:30:18] <pcwalton> blammo
[01:30:20] <pcwalton> that's awesome
[01:30:57] <strcat> I don't think it will actually matter much for non-optimized compile-time
[01:31:20] <pcwalton> I don't care about non-optimized compile time as much
[01:31:22] <pcwalton> that's great
[01:31:27] <pcwalton> it avoids closure construction though
[01:31:33] <pcwalton> and virtual method calls
[01:31:49] <pcwalton> btw, looking through some asm had me thinking: does clang always copy args to allocas?
[01:31:52] <pcwalton> or is it lazy?
[01:31:53] <strcat> yeah it replaces N indirect calls with N static calls
[01:32:04] <pcwalton> O(n) static calls I guess
[01:33:08] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[01:33:10] <pcwalton> yeah, it does always copy args to allocas. OK.
[01:33:17] <pcwalton> it doesn't make a retptr though
[01:33:24] *** Quits: brendan (brendaneic@moz-FB09EACF.public.wayport.net) (Ping timeout)
[01:34:15] *** Quits: lkuper (lkuper@215593FA.A402E718.C082B7DC.IP) (Quit: lkuper)
[01:34:19] <strcat> the vector iterator also has room for improvement
[01:34:32] <strcat> can avoid inttoptr by special-casing it for non-zero-size types
[01:34:44] <strcat> it doesn't optimize that out
[01:35:00] <strcat> LLVM just seems to treat inttoptr/ptrtoint as an entirely opaque action
[01:35:16] <strcat> even though they have aliasing rules for it, they don't *use* them
[01:35:32] <pcwalton> ah, let's get a bug on that
[01:35:50] <pcwalton> ok, yeah, I made a function that was "return c + 3" and clang wasn't particularly smart about avoiding allocas
[01:35:55] <pcwalton> the only one that it avoided over us was the retptr
[01:36:03] <pcwalton> at -O0 of course
[01:36:07] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[01:37:20] <pcwalton> well, I worked around my -O0 segfault so I'm happy
[01:37:23] <pcwalton> brb
[01:37:26] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: pcwalton)
[01:42:10] *** Quits: sebcrozet (sebcrozet@moz-D8879CC3.w80-13.abo.wanadoo.fr) (Ping timeout)
[01:42:38] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[01:44:03] <bobbyrward> any one mind reviewing some code?  I feel I'm going about a lot of things wrong.  https://github.com/bobbyrward/rust-sandbox/pull/1
[01:45:41] <bblum> SIGHHHHHHHHHHH
[01:45:44] <bblum> this stupid test case
[01:45:46] <cmr> bobbyrward: nit: unnecessary braces https://github.com/bobbyrward/rust-sandbox/commit/cd2cac68edb560ba4a37c4ea1330ff102f05033c#L7R21
[01:45:51] <bblum> at least it was a legit bug that it exposed.
[01:46:03] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:46:08] <bblum> but sheesh, this took me like two hours to find
[01:47:24] *** Joins: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu)
[01:47:55] <cmr> bobbyrward: do you just want github line comments instead? :)
[01:48:03] <bobbyrward> cmr: please
[01:50:02] <strcat> ugh why must all these tests use for loops for test closures ;p
[01:52:05] *** Quits: graydon (graydon@moz-F14EE0DB.cable.teksavvy.com) (Quit: Leaving.)
[01:53:48] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[01:54:18] *** Joins: DeokjinKim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[01:54:42] *** Quits: maikklein (maik@moz-AEFED0CC.dip0.t-ipconnect.de) (Ping timeout)
[01:56:27] <cmr> bobbyrward: done! :)
[01:56:37] <bobbyrward> cmr: thank you!
[01:56:58] <cmr> bobbyrward: Thank you for working on this! It's nice to see more work/interest in this area.
[01:58:46] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[01:58:51] *** Quits: BitPuffin (quassel@moz-49828767.cust.tele2.se) (Ping timeout)
[01:59:16] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[01:59:40] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[02:00:04] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[02:00:26] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[02:00:29] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[02:01:21] *** Quits: heftig (heftig@8D5076D2.6FC4DE2F.FEC4A986.IP) (Quit: Quitting)
[02:01:45] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[02:03:18] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[02:03:39] <Eridius> since graydon left, can someone else cancel out his r+ on https://github.com/mozilla/rust/pull/8203 ?
[02:03:45] <Eridius> (assuming that's possible)
[02:04:00] <strcat> Eridius: can't, it's your repo
[02:04:01] <cmr> Eridius: It was a comment on your repo, you should be able to delete it
[02:04:03] <strcat> you should be able to delete it
[02:04:05] <strcat> heh
[02:04:25] <Eridius> oh hrm, github wasn't showing editing controls, but if I go to the commit it does. bors will notice that I deleted it?
[02:04:29] <engla> or push a different commit to the branch, I think
[02:04:53] <cmr> both work
[02:05:02] <cmr> Eridius: bors will notice absence of r+
[02:05:08] <cmr> He doesn't keep state afaik
[02:05:16] <Eridius> ah
[02:07:28] <sammykim> Eridius : When you compiled the rust with your pullreqeust 8200, didn't you get error in src/librustc/middle/trans/_match.rs?
[02:08:17] <Eridius> sammykim: no. I may have only run check-stage1-std for that one though. Why would adding a return type cause a failure?
[02:08:48] <Eridius> ah I see why. last call in a match arm, no semicolon. hmm
[02:09:17] <sammykim> Eridius : Because I also tried to fix it . But since I changed mutate to return bool. "do" syntax doesn't work : ( so I needed to change some codes in "_match.rs". However in your pullrequest, It doesn't look like.
[02:09:37] <Eridius> sammykim: yeah I'm building again right now to see what happens. Adding a semicolon after the do line should work though
[02:10:07] <dbaupp> cmr: re https://github.com/mozilla/rust/issues/8205#issuecomment-21982495, trailing nulls are possibly detailing
[02:10:11] <dbaupp> *disappearing
[02:10:20] * dbaupp doesn't know where that came from
[02:10:24] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[02:10:28] <cmr> dbaupp: I wasn't assuming it was a trailing null, because I have no idea what the rules around it are
[02:10:36] <cmr> I was advocating replacing the arbitrary byte that is potentially invalid
[02:10:38] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[02:11:04] <dbaupp> cmr: oh, so possibly triggering an out-of-bounds crash?
[02:11:16] <dbaupp> cmr: that's a silly idea :P
[02:11:16] <cmr> dbaupp: segfault, but yes
[02:11:23] <cmr> I noted that it was a bad idea
[02:11:46] <Eridius> cmr: I just posted an alternative idea, don't know if it will work
[02:12:00] <bblum> brson: i have the sync/arc tests bug fixed, and fixed another one, but there are two more
[02:12:04] <cmr> Eridius: Hm, forgot about writev
[02:12:09] <cmr> I don't know if it's atomic or not
[02:12:10] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:13:02] * cmr hasn't done any work in the data plane, hasn't seen much use for writev
[02:13:09] <Eridius> cmr: I've never actually used it. Assuming writev is an independent syscall (and if it's not, why is it in man section 2?), I would hope it's atomic, because otherwise why would you use it instead of a sequence of write()s?
[02:13:29] <cmr> Eridius: better scheduling in the kernel I'd imagine
[02:15:00] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:15:00] *** ChanServ sets mode: +o dherman
[02:15:44] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[02:16:12] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[02:17:34] <Eridius> sammykim: looks like that one spot in trans/_match.rs is the only failure, and a semicolon fixes it. I'll push out an updated PR shortly, thanks for catching it
[02:17:51] <brson> bblum: that's awesome
[02:18:03] <bblum> awesome that there are two more huh :P
[02:19:32] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[02:20:52] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[02:21:33] <brson> toddaaro: in this failing test case the dynamic linker is overflowing the stack red zone. i'm still not sure how it got that far up the stack though
[02:21:39] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:21:52] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[02:21:59] <brson> or down as the case may be
[02:22:09] <toddaaro> brson: the static linked?
[02:22:14] <toddaaro> brson: *linker
[02:22:43] <brson> toddaaro: no. the dynamic linker is resolving a symbol in the red zone and stomps on important metadata
[02:22:58] <brson> during lazy symbol relocation
[02:23:56] *** Joins: june0cho (june0.cho@5AB4884B.FCC4549.14D5B978.IP)
[02:24:35] <cmr> Ugggh
[02:24:44] <cmr> I had a bug from using .get() rather than .unwrap() on a result
[02:24:54] <toddaaro> brson: sounds weird, is this a runtime bug or something else that we uncovered?
[02:24:57] <cmr> I thought .get was the "proper" way, and I added a #[deriving(Clone)] without thinking
[02:25:09] *** Quits: geomyidae (cole@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[02:25:17] *** Joins: int3_ (int3_@moz-B826F49B.googlewifi.com)
[02:25:20] <cmr> but you can't clone that thing, because calling the destructor makes all other clones invalid
[02:25:39] <cmr> I'm not sure how this fits in with the earlier naming bikeshed surrounding get/unwrap
[02:25:42] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[02:25:45] <cmr> but they are *not* the same thing for Result
[02:25:56] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[02:26:18] <enix> brson: I rebased my Sha2 changes and checked that each patch still compiles and passes tests
[02:26:43] <dbaupp> cmr: yeah, Optoin/Result .get/.unwrap need to be merged into a single one that doesn't use Clone
[02:27:00] *** Joins: int3__ (int3_@moz-15FB2963.hfc.comcastbusiness.net)
[02:27:15] <brson> enix: thanks, r+ed again
[02:27:18] <cmr> dbaupp: I can't really picture a usecase where you'd want to clone out of the Option/Result and still retain the Option/Result
[02:27:21] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[02:27:22] <enix> thanks!
[02:27:37] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Ping timeout)
[02:27:37] <cmr> unwrap() is the better name describing the functionality, but get is pleasant and short
[02:27:57] *** Quits: int3_ (int3_@moz-B826F49B.googlewifi.com) (Ping timeout)
[02:28:08] <strcat> Eridius: writev exists to reduce context switch overhead
[02:28:09] <dbaupp> cmr: exactly, .unwrap() and .get_ref() should be enough (modulo naming concerns)
[02:28:10] <strcat> libuv uses it
[02:28:31] <strcat> you batch your I/O actions together
[02:29:03] <strcat> especially since libuv will spin up threads for writes
[02:29:07] <strcat> because they block
[02:29:20] <dbaupp> strcat: with Range iterator: it appears that it will break horribly with a negative step: just not bothering with that for the moment?
[02:29:20] <cmr> strcat: surely it uses a thread pool?
[02:29:40] <brson> toddaaro: I think it must be a bug in the old runtime related to stack growth and unwinding. there's a bunch of rust code running in the red zone, then the dynamic linker kicks in in the red zone. it's crazy
[02:30:01] <strcat> cmr: it does use a thread pool, but a thread per write would be a bit much
[02:30:03] <cmr> brson: pretty sure that's the exact bug that jemalloc was hitting
[02:30:11] <Eridius> strcat: I see
[02:30:13] <strcat> dbaupp: well it's the same as range was
[02:30:23] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[02:30:26] <dbaupp> strcat: right.
[02:30:34] *** Quits: june0cho (june0.cho@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[02:30:34] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[02:30:48] <strcat> just converted while { } to next { }
[02:31:10] <strcat> this one has no step though
[02:31:12] <strcat> it's always 1
[02:31:20] <strcat> RangeStep, etc. still need to be done
[02:31:49] <dbaupp> yep
[02:32:03] <dbaupp> (could it be called `range` rather than `Range::new`?)
[02:32:34] <cmr> rusti: struct F; impl F { pub fn n() { } } use x = F::n;
[02:32:35] -rusti- <anon>:5:45: 5:58 error: `use` and `extern mod` declarations must precede items
[02:32:35] -rusti- <anon>:5          struct F; impl F { pub fn n() { } } use x = F::n;
[02:32:36] -rusti-                                                       ^~~~~~~~~~~~~
[02:32:36] -rusti- error: aborting due to previous error
[02:32:36] -rusti- application terminated with error code 101
[02:32:44] <strcat> dbaupp: it could, didn't feel like worrying much about naming yet
[02:32:47] <cmr> rusti: use x = F::n; struct F; impl F { pub fn n() { } }
[02:32:49] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HaiE
[02:32:52] <cmr> shame
[02:32:56] *** Joins: june0cho (june0.cho@5AB4884B.FCC4549.14D5B978.IP)
[02:33:11] <toddaaro> brson: sounds finicky
[02:33:36] *** Quits: Voomer (Voomer@moz-CC05FF5E.hsd1.wa.comcast.net) (Connection reset by peer)
[02:33:42] <brson> it may not be worth fixing since all the old segmented stack code is going to die with the old scheduler, but I'll spend a few more hours on it
[02:33:49] <brson> dinner now
[02:33:57] <dbaupp> strcat: is that pr r-able?
[02:34:34] <strcat> dbaupp: I think so
[02:34:38] <strcat> it might have broken a benchmark
[02:35:17] <strcat> yes it did
[02:35:19] <strcat> so not yet
[02:35:33] <strcat> + it broke the tutorials
[02:36:04] <dbaupp> too late :P
[02:36:39] <cmr> strcat: is `times` already converted to `do` on master/
[02:36:45] <strcat> cmr: partially
[02:37:18] <strcat> I think I'll convert them to Range too though
[02:37:32] <strcat> just because needless closures are painful
[02:37:35] <cmr> I mean more of "can I use it with do", but I suppose the internal iterator protocol isn't bagic, just verbose.
[02:37:41] <cmr> *magic
[02:38:08] <dbaupp> rusti: do 3u.times { print("foo"); }
[02:38:10] -rusti- foofoofoo()
[02:38:41] <cmr> It's really pleasing to use foreach loops
[02:39:16] *** Quits: int3__ (int3_@moz-15FB2963.hfc.comcastbusiness.net) (Client exited)
[02:39:42] <engla> does the output splitting with println matter? there should be a buffered writer for that right (in the future)
[02:40:07] <cmr> engla: buffered writer would require allocations
[02:40:12] <cmr> but I agree that's it's a non-issue
[02:40:19] <cmr> and not really solvable...
[02:40:28] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[02:40:29] <cmr> As the borrow checker would say, "conflicting requirements"
[02:40:30] <engla> a buffered writer would allocate the buffer, and that's it
[02:40:48] <dbaupp> rusti: struct Foo; impl Foo { fn next(&self) -> Option<~str> { if 220u8 > std::rand::random() { Some(~"foo") } else { None } } } let mut f = Foo; foreach s in f { println(s); }
[02:40:50] -rusti- foo
[02:40:50] -rusti- foo
[02:40:50] -rusti- foo
[02:40:50] -rusti- ()
[02:41:03] <dbaupp> cmr: abusing foreach is fun too :P
[02:41:04] <engla> cmr: printlnf! in particular is simple.. just append "\n" statically in the macro :-)
[02:41:35] <cmr> dbaupp: I'm jiggy with compile-time duck typing :D
[02:41:47] <bblum> toddaaro: ping
[02:41:50] <strcat> cmr: it's not intended
[02:41:59] <bblum> i bet he's playing spaceship battles in space
[02:42:13] <aatch> rusti: struct Foo; impl Foo { fn next(&self) -> Option<~str> { if 220u8 > std::rand::random() { Some(~"foo") } else { None } } } let mut f = Foo; foreach s in f { println(s); }
[02:42:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RcFe
[02:42:56] <toddaaro> bblum: pong
[02:43:10] <toddaaro> bblum: clusterfick doesn't even begin to describe what is going on in spaceships
[02:43:33] <aatch> toddaaro, EvE?
[02:43:38] <toddaaro> aatch: yea
[02:43:47] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[02:43:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/yClxTw
[02:43:47] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[02:44:00] <aatch> toddaaro, cool. That game ate a couple years of my life.
[02:44:11] <bblum> toddaaro: ok great, hey, so, the check_killed() call in the context switchers needs to take task.unwinder.unwinding as an already_failing parameter, and not fail!() if it's true; can you put that into your PR?
[02:44:18] <bblum> toddaaro: i don't want to do it now because it will conflict with you for sure
[02:44:32] <toddaaro> bblum: already_failing?
[02:45:10] <bblum> toddaaro: yeah, add an argument 'already_failing: bool' to check_killed in kill.rs, exactly like inhibit_kill and friends
[02:45:53] *** Quits: kimundi (kimundi@moz-CA8AB5FA.dip0.t-ipconnect.de) (Ping timeout)
[02:46:49] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:46:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/NxNETQ
[02:46:49] <ghrust> 13rust/06auto 14ea5f829 15Alex Crichton: Resolve globals having different addresses across crates...
[02:46:49] <ghrust> 13rust/06auto 14ecefeb0 15bors: auto merge of #8185 : alexcrichton/rust/issue-8179, r=pcwalton...
[02:46:49] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:47:05] <cmr> Ahh the joy of zmq, such a wonderful library
[02:47:12] <bblum> toddaaro: i can also do it myself after your thingie lands, if your thingie is already reviewed or whatever
[02:49:00] *** Joins: kimundi (kimundi@moz-467E131.dip0.t-ipconnect.de)
[02:49:37] <toddaaro> bblum: I think bors is going for it
[02:50:23] *** kimundi is now known as zz_kimundi
[02:52:00] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[02:54:05] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[02:54:51] *** Quits: tjc (tjc@5CF3EFEE.5BF962AE.AA5CA73A.IP) (Quit: zzzzzzzzzz)
[02:57:10] <toddaaro> bblum: my code is in master!
[02:57:17] <bblum> toddaaro: you're a pro
[02:57:24] <toddaaro> bblum: brson is the pro
[02:57:35] <bblum> mozilla pays all of us
[02:57:52] * cmr things all the RT people are superawesome
[02:58:37] <toddaaro> bblum: so you should have an easy time making that change
[02:58:45] <bblum> great, i expect i will
[02:59:40] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:59:58] <tikue> damn that's a pretty big patch toddaaro 
[03:00:49] *** Joins: chii (Mibbit@moz-474FFD66.nycmny.east.verizon.net)
[03:01:34] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[03:01:34] *** ChanServ sets mode: +o pcwalton
[03:01:40] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:02:10] <chii> just for an idea, what's the state of TcpStream and TimerWatcher and friends?
[03:02:19] <chii> the new io, basically
[03:02:28] <strcat> pcwalton: https://github.com/mozilla/rust/issues/8212 the remaining vec iterator issue btw
[03:02:49] *** Joins: Voomer (Voomer@moz-CC05FF5E.hsd1.wa.comcast.net)
[03:02:51] <strcat> it just breaks down LLVM's reasoning about where those pointers came from
[03:03:05] <strcat> fixable though
[03:03:10] <chii> just want to be clear on their known bugs
[03:03:28] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:03:29] *** ChanServ sets mode: +o brson
[03:04:51] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:05:10] *** Quits: june0cho (june0.cho@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[03:05:16] * strcat expects big wins when loop-vectorize is enabled with that fixed
[03:05:44] <cmr> I saw on phoronix that LLVM switched on the basic-block vectorizer as well too, for 3.4?
[03:05:50] <Luqman> chii: the TCP stuff works fairly well afaik
[03:06:00] <strcat> cmr: well they are talking about switching on the SLP vectorizer
[03:06:11] <strcat> cmr: I'll copy it from clang to our passes when we're at an LLVM revision where they have it on
[03:06:23] <strcat> it
[03:06:33] <strcat> it's not as impressive as loop vectorization though*
[03:06:38] <cmr> yeah
[03:06:47] <strcat> overall it doesn't do much on most applications, loop-vectorize does
[03:07:23] <chii> Luqman thanks for the response - so it also does well with tasks, etc? (global_loop was not doing well with tasks)
[03:08:19] <cmr> chii: afaik it falls over with concurrency
[03:08:35] <cmr> ChrisMorgan encountered segfaults with his http server using the newrt concurrently
[03:08:43] <chii> oh :(
[03:08:50] <chii> thanks for the note cmr
[03:09:03] <cmr> It's a rapidly moving target though
[03:09:04] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[03:09:06] <cmr> for all I know it's been fixed
[03:09:31] <brson> it has not yet. the scheduler will happily run I/O on the wrong thread atm
[03:09:41] <ChrisMorgan> Unfortunately, it's not immediateâ€”it tends to take at least a few seconds of hammering it before it segfaults (though sometimes it's faster than that).
[03:09:44] <chii> well, if I were to stick with the old net io, that uses global_loop, are there consistent reasons for when it trips up in concurrent situations?
[03:09:44] <bblum> ok, bam, found the last race
[03:09:56] <bblum> this one, not immediately sure how to deal with
[03:10:05] <cmr> chii: old net code has been removed on master
[03:10:15] *** zz_kimundi is now known as kimundi
[03:10:15] <chii> right, I meant with 0.7 :P
[03:10:17] <brson> ChrisMorgan: it is reliable in single-threaded mode though?
[03:10:22] <ChrisMorgan> brson: yes
[03:10:27] <brson> that's a relief
[03:10:44] <ChrisMorgan> That is, with one request at a time (not sure if they'd end up being handled on the same thread or not)
[03:10:54] <chii> if maybe that was better understood in any way with the old library cmr
[03:10:58] <brson> the multithreaded case isn't hard to fix, and it's a high priority. ecr will probably do that first when he gets back monday
[03:11:16] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[03:12:10] <cmr> chii: don't think so. it's been unmaintained for some time
[03:12:30] <chii> cmr: I see. Well, thanks for the responses, all!
[03:12:39] <ChrisMorgan> Ah, which is more important for newrt I/O: safe multithreadedness or file reading?
[03:14:24] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[03:14:44] <chii> ChrisMorgan: I'm biased for multithreadedness... heh
[03:15:09] * ChrisMorgan for file reading, so that he can demonstrate a file serving HTTP server
[03:15:23] <ChrisMorgan> (Even if it crashes when multiple people try to use it at once!)
[03:15:24] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[03:16:10] <brson> It's more important to me that we get the infrastructure for multithreading in now - std::io does do file I/O already, just blocking. It really shouldn't take more than a few days to fix the multithreading issue
[03:16:15] <vk> Hey, I'm trying to compile some old rust code and it's failing on this bit, "static fn new() -> Encoder {", how could I fix the static fn declaration?
[03:16:32] <cmr> vk: `fn new() -> Encoder`
[03:16:42] <olsonjeffery> brson: this is about running IO on a scheduler outside of the one the handle was created on?
[03:16:46] <olsonjeffery> task pinning and whatnot
[03:16:57] <vk> cmr: ... that's too simple -_-.
[03:17:00] <cmr> vk: Methods are now differentiated from associated functions ("static methods") by the presense of `self`
[03:17:10] <cmr> (in any of its forms, &self, &mut self, ~self, etc)
[03:18:27] <brson> olsonjeffery: yeah, when an I/O handle goes to do I/O it needs to make sure it's on the right scheduler: `do self.put_me_on_the_right_scheduler_please { // thanks }`
[03:18:33] <vk> cmr: interesting, don't entirely understand, but hope to soon.
[03:20:11] <olsonjeffery> brson: is there going to end up being a less magical solution to the whole handle sourcing thing? .. eg right now the user-facing IO types do Local::borrow::<IoFactoryObject>()
[03:20:30] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:21:02] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[03:21:10] <olsonjeffery> meh, i guess it's still pretty fair. reaching out to the iofactory is probably the most magical part
[03:21:29] <olsonjeffery> although the underlying impls rt::uv do a lot of borrowing the current scheduler
[03:21:51] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[03:23:37] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:23:37] *** ChanServ sets mode: +o brson
[03:23:43] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[03:23:46] <ChrisMorgan> I do find it a little concerning, though, that sometimes when I start the server it will respond at only about 12% of the normal rate with perhaps a spurious failure ("socket is not connected") and one or two timeouts per thousand requests. Restart it and that normally fixes it, but not always.
[03:24:19] <mark_edward> doomlord_: poingo
[03:24:39] <olsonjeffery> ChrisMorgan: :/
[03:24:40] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[03:25:01] <brson> timeouts are a concern because we don't have preemption
[03:25:07] <olsonjeffery> i created the old net::tcp API and it felt like we never got it hammered down and reliable
[03:25:25] <olsonjeffery> ChrisMorgan: re: socket timeouts.. there's good failure detection/retry mechanisms, right? does the conditions stuff work?
[03:26:26] <ChrisMorgan> olsonjeffery: I haven't tried pinning down where it's failing, but that failure could indeed be handled as a condition
[03:27:43] *** Joins: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:29:24] <ChrisMorgan> I said 12%â€”it looks like it can be 3%, too...
[03:29:59] <olsonjeffery> well, as your API gets more mature, being able to distribute a server configuration and stress-test script that repros it will be helpful
[03:30:05] <olsonjeffery> so at least you're not in a bad place, as far as that goes
[03:30:16] <ChrisMorgan> That time, 1.2%... weird.
[03:31:04] <cmr> Does anyone know if GetCommandLineW on Windows is implemented with an allocation or returns a pointer into some special OS-mapped page?
[03:31:11] <ChrisMorgan> Grr, now it's not going at full speed at all :-(
[03:31:17] <brson> unwinding is indeed completely broken re segmented stacks
[03:31:23] <brson> it's amazing it works at all
[03:31:44] <brson> wonder how long this has been going on
[03:31:45] <ChrisMorgan> How am I meant to compare performance between two versions of the code if it ain't consistent? :-(
[03:32:25] <klutzy> cmr: no extra alloc I think
[03:32:53] <ChrisMorgan> And just the last time before I give up on it, it starts working again.
[03:33:01] <cmr> klutzy: So it'd be reasonable to expect that `argv` using the msvcrt is allocation-free, just as in its unix counterparts?
[03:33:31] *** Quits: Jesin (Jessin_@moz-157A63DD.cc.lehigh.edu) (Quit: Leaving)
[03:34:26] <klutzy> cmr: but GetCommandLineW is just one-liner, so you may have to call CommandLineToArgvW which returns allocated one
[03:34:32] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:35:02] <cmr> Ah makes sense
[03:40:12] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:40:12] *** ChanServ sets mode: +o brson
[03:40:19] <ChrisMorgan> YAY! I'm now sufficiently confident that my new approach (with *extremely* verbose and very deepâ€”generatedâ€”code but no unnecessary allocations) is distinctly faster than the old approach (load the lines into a ~str and then work through it).
[03:41:36] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[03:41:40] <ChrisMorgan> Sure, there's still going to be a place for further optimisations of it, but my hypothesis was successful :-)
[03:45:32] <dbaupp> ChrisMorgan: deep deep matches?
[03:45:41] <ChrisMorgan> dbaupp: yep
[03:47:03] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:47:10] <ChrisMorgan> First time (for HTTP methods) I wrote it by hand, but now I'm generating the same thing (in Rust codeâ€”macros aren't powerful enough) and including it in the other file. Assuming it is successful for HTTP headers also, that will certainly be generated! (Hand-writing it would be a menace.)
[03:47:30] <dbaupp> ChrisMorgan: awesome! how much faster?
[03:47:42] <cmr> ChrisMorgan: Ragel has rust support, in erickt's fork
[03:47:53] <cmr> Also see joyent's http-parser, but that could be considered cheating
[03:48:01] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[03:48:20] <erickt2> ChrisMorgan: my ragel fork needs to be updated to 8.x though
[03:48:21] <ChrisMorgan> I'm just starting to show my hand with my latest commit on why I don't like Joyent's http-parser and what can be done better.
[03:48:25] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:48:26] *** ChanServ sets mode: +o brson
[03:48:27] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[03:48:28] <pcwalton> :)
[03:48:36] * ChrisMorgan doesn't know anything much about Ragel
[03:48:50] <cmr> ragel is a state machine compiler
[03:48:52] <erickt2> ChrisMorgan: http://www.zedshaw.com/essays/ragel_state_charts.html
[03:49:02] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[03:49:04] <pcwalton> roughly how competitive are we vis-a-vis other HTTP servers?
[03:49:07] <pcwalton> at the moment
[03:49:20] <pcwalton> I'm just curious, I know there's a ton of work to be done
[03:49:44] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Quit: Leaving)
[03:49:49] <strcat> ragel is pretty darn awesome, debugging with graphviz output is awesome
[03:50:03] <cmr> yes, ragel is fantastic
[03:50:05] <erickt2> pcwalton: I have my old mre, that hasn't been updated since rust 0.4. I've seen some other people building on top of my rust-mongrel2
[03:50:10] <erickt2> that's up to date
[03:50:19] <ChrisMorgan> dbaupp: at present it's only in use for the Request-Line, but loading the request is averaging around 62000-70000ns instead of 85000-90000. (This for requests which will have just one header, `Host: 127.0.0.1:8001`, I believe.)
[03:51:37] <dbaupp> pcwalton: http://hg.chrismorgan.info/rusthttpserver/file/02fe86015d5d/comparisons/README.txt
[03:51:58] <dbaupp> pcwalton: (for single threaded essentially equal to Go and Node)
[03:52:01] <erickt2> ChrisMorgan: I'm in the middle of another patch right now, but I'll update my ragel fork to work with head this weekend
[03:52:20] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[03:52:33] <pcwalton> so bigger is better I assume
[03:52:37] <strcat> requests/s
[03:52:49] <dbaupp> ChrisMorgan: cool, that's a big win!
[03:52:51] <strcat> it's 3x as fast on my laptop compared to his old machine though ;p
[03:52:57] <strcat> (all of them, I'd guess)
[03:53:05] <bblum> ARGH, i can't believe i made this stupid mistake
[03:53:07] <strcat> but I only ran the rust one
[03:53:17] <pcwalton> hmmm
[03:53:23] <pcwalton> I wonder what the keepalive problem is
[03:53:55] <pcwalton> brson: any idea?
[03:53:59] <ChrisMorgan> dbaupp: it means that for a normal request line (with a supported HTTP verb) there is only a string allocated for the Request-URI rather than one for the whole thing as well
[03:54:05] <brson> what is the keepalive problem?
[03:54:10] <pcwalton> http://hg.chrismorgan.info/rusthttpserver/file/02fe86015d5d/comparisons/README.txt
[03:54:14] <pcwalton> we drop perf a lot with keepalive
[03:54:26] <pcwalton> while we're Node/Go level perf without it
[03:54:57] <brson> what does node concurrency mean here? they're single-threaded
[03:55:05] <olsonjeffery> concurrency of ab
[03:55:08] <cmr> Concurrent connections in ab
[03:55:24] <pcwalton> I wonder what happens if you turn off task killing
[03:55:28] <ChrisMorgan> ab keep-alive didn't work, but pcwalton is talking about wrk keep-alive, which works.
[03:55:43] <ChrisMorgan> And which shows only 2x perf increase rather than 3x as go/node get
[03:55:52] <pcwalton> let's file a bug on that
[03:56:01] <pcwalton> we *used* to have faster reading/writing than go/node
[03:56:09] <pcwalton> I don't know what regressed it
[03:56:21] <pcwalton> if indeed that's the problem
[03:56:40] <strcat> acrichto: hopefully just a bad LLVM revision I guess
[03:57:00] <ChrisMorgan> pcwalton: just remember that the fault *could* be in my code. (Keep-alive is a fairly simple thing, thoughâ€”just wrap code in `loop { ...; if request.close_connection { break } }`.)
[03:57:08] <pcwalton> ChrisMorgan: right
[03:57:15] <pcwalton> it may just be a simple matter of pointing a profiler at it
[03:57:28] <brson> i have no idea about keepalive
[03:58:01] <ChrisMorgan> I haven't tried to figure out why ab -k doesn't work. Keep-Alive works as I would expect it to with formulating requests manually in telnet.
[03:58:34] <pcwalton> well, the good perf for opening indicates to me that the scheduler design is probably OK
[03:58:39] <pcwalton> if we're on par with Go/Node
[03:58:47] <strcat> pcwalton: about to put down another 300 for loops ;p
[03:58:54] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[03:58:54] <strcat> don't know how many more are left
[03:59:00] <strcat> there's a lint for them now at least
[03:59:17] <cmr> ChrisMorgan: Compare it to a very simple nginx/mongrel2 setup!
[03:59:19] <ChrisMorgan> erickt2: how would I utilise ragel? Would it be a runtime dependency or would it generate code or something else?
[03:59:22] * cmr thinks it would be interesting
[03:59:27] <cmr> ChrisMorgan: ragel is a code generator
[03:59:30] <erickt2> ChrisMorgan: it generates a .rs
[03:59:49] <cmr> You'd probably use it to generate your parser or even some of your logic
[03:59:56] <pcwalton> brson: do you know why concurrency levels greater than 1 wouldn't segfault, like, always?
[04:00:03] <pcwalton> I would expect insta-segfaults since tasks don't go home
[04:00:15] <pcwalton> maybe we're load balancing reallllly poorly
[04:00:25] <ChrisMorgan> Ah. Well, that's what I've done myself already... I generate http://sprunge.us/fXIh
[04:00:34] <erickt2> ChrisMorgan: if you're interested, you can check out zed shaw's http parser that's written in ragel. It targets C though: https://github.com/zedshaw/mongrel2/blob/master/src/http11/http11_parser.rl
[04:00:41] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[04:00:52] <erickt2> it's pretty straight forward
[04:01:04] <brson> pcwalton: it could be possible. would be worth seeing if all the cores are lighting up
[04:01:13] <pcwalton> brson: can we round robin accept()s?
[04:01:15] <pcwalton> between schedulers
[04:01:16] <ChrisMorgan> Erk, `CRLF = ( "\r\n" | "\n" )`?
[04:01:16] <dbaupp> ChrisMorgan: isn't the HTTP version parser backwards?
[04:01:26] <strcat> ChrisMorgan: ragel will probably generate better code than rustc does from those matches
[04:01:29] <brson> pcwalton: not with libuv's current limitations
[04:01:35] <pcwalton> blech!
[04:01:47] <brson> in a server, even with multi-core rust all the i/o is going to be on one thread
[04:01:50] <dbaupp> ChrisMorgan: i.e. "12" parses to 21
[04:01:54] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[04:01:59] <brson> until we look into lifting this limitation
[04:02:01] <pcwalton> brson: we're never going to catch Go then :|
[04:02:05] <brson> yes we are
[04:02:07] <brson> jesus
[04:02:13] <brson> we haven't even *started*
[04:02:18] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Ping timeout)
[04:02:19] <pcwalton> okay, sorry
[04:02:22] <toddaaro> pcwalton: yea, don't worry about Go
[04:02:31] <ChrisMorgan> dbaupp: hmm?
[04:02:51] <brson> it's going to be a long process
[04:02:54] <dbaupp> ChrisMorgan: http://hg.chrismorgan.info/rusthttpserver/rev/02fe86015d5d#l2.212
[04:03:03] <toddaaro> I need to get the final version of that haskell paper, where they use an approach very similar to ours, and get IO performance that is truly mindboggling
[04:03:25] <dbaupp> ChrisMorgan: that is parsing the 1 with ord == 1, so n1 = 1, then the 2 with ord == 10, so n1 = 21.
[04:03:30] <dbaupp> ChrisMorgan: (for a string "12")
[04:04:08] <ChrisMorgan> Oh, I see. This is what happens when you don't make tests for it...
[04:04:13] <dbaupp> ChrisMorgan: you want something like n1 += (b - '0') as uint; ... n1 *= 10; I think.
[04:04:18] <ChrisMorgan> And when the "real" data is only one digit long...
[04:06:03] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[04:06:14] <pcwalton> strcat: I'm not sure about Range::new
[04:06:20] <pcwalton> maybe we should alias range() to Range::new()?
[04:06:26] <strcat> pcwalton: could just be called range()
[04:06:28] <pcwalton> yeah
[04:06:31] <strcat> easy to change them all
[04:06:54] <dbaupp> ChrisMorgan: "go_down_moses" ?
[04:06:56] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[04:07:09] <ChrisMorgan> dbaupp: no obvious method name occurred to me at that point :D
[04:07:10] <strcat> pcwalton: same thing applies to Counter::new
[04:07:15] <ChrisMorgan> s/method/function/
[04:07:22] <dbaupp> ChrisMorgan: haha
[04:07:23] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[04:07:27] <pcwalton> I'm fine with having Range::new() but just for brevity range() might be nice
[04:07:48] * strcat has no strong opinion either way and changed his mind 10 times
[04:07:56] <brson> toddaaro: found the fix for that bug!
[04:07:58] <ChrisMorgan> (Are you familiar with the associated song, When Israel was in Egypt's Land?)
[04:08:00] * brson so useful
[04:08:02] <Eridius> I'm a fan of range()
[04:08:09] <pcwalton> is there a problem with making Iterator implement Iterable?
[04:08:10] <Eridius> Range::new() seems like an odd construct to use for a simple numeric for loop
[04:08:11] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[04:08:12] <dbaupp> ChrisMorgan: nope
[04:08:23] <toddaaro> brson: !! nice
[04:08:25] <strcat> pcwalton: possibly, I haven't fully thought it through
[04:08:26] <toddaaro> brson: what was it?
[04:08:34] <ChrisMorgan> dbaupp: "Go down, Moses" are the first three words in the chorus.
[04:08:35] <pcwalton> so we can do for i in [ "Fred", "Barney", "Wilma" ] ...
[04:08:35] <strcat> pcwalton: the iterator needs to be handled with &mut
[04:08:44] <pcwalton> with a desugaring
[04:08:45] <strcat> and Iterable would use &self or self
[04:08:49] <dbaupp> ChrisMorgan: ... so entirely unrelated to the code?
[04:08:53] <ChrisMorgan> Yep :D
[04:08:56] <strcat> I'm sure we can make it handle both but possibly not by using a single trait
[04:09:09] <strcat> pcwalton: atm it doesn't check the type at all :(
[04:09:18] <pcwalton> well, if it's not a single trait it can't be a desugaring
[04:09:18] <brson> toddaaro: there's a corner case in the unwinding code where upcall_reset_stack_limit failed to put any value in the TCB stack pointer, leaving subsequent rust code to not see the end of the stack and go crazy
[04:09:22] <strcat> just a prototype basically
[04:09:32] <brson> and it's been there *forever*
[04:09:34] <strcat> pcwalton: yeah, that's true
[04:09:43] <ChrisMorgan> I could have called it "do_things" or "what_should_i_call_this_method" or "the_function_with_no_name".
[04:09:57] <toddaaro> brson: wow, excellent work
[04:10:14] <dbaupp> ChrisMorgan: is the codegen directory the code thta does the codegen, or the code that was generated?
[04:10:33] <ChrisMorgan> dbaupp: it does the code generation. Generated code goes in librusthttpserver/generated/ (not checked in)
[04:10:44] <dbaupp> ChrisMorgan: aha
[04:11:00] <ChrisMorgan> Initially I had a generate_generated.rs...
[04:11:12] <dbaupp> ChrisMorgan: (`match`-ing on bool?? `if` exists you know :P)
[04:11:23] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[04:11:35] <strcat> pcwalton: for (a, b) in range(0, 10).zip(range(20, 30)) { } does look much better
[04:11:52] <pcwalton> yeah, that makes Rust look like Python-with-braces
[04:11:54] <pcwalton> which is great
[04:12:11] <strcat> nicer than python because we can use method chaining ;p
[04:12:32] <dbaupp> (also, we have more pointers ... <3 fancy pointers.)
[04:12:37] <ChrisMorgan> In Python that'd be zip(range(0, 10), range(20, 30)).
[04:12:55] <pcwalton> well, yeah, also :: and ;
[04:13:03] <pcwalton> much to some people's chagrin
[04:13:18] *** Quits: tautologico (lymph@9F01D096.92EA1F6.C27E1635.IP) (Quit: tautologico)
[04:13:28] <ChrisMorgan> Rust's traits can lead to nice code like that with no need of built-in functions like in Python.
[04:13:44] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[04:14:04] <vk> How can this, " lookahead <-> self.lookahead;", be fixed with swap?
[04:14:16] <pcwalton> I think where we're going is Haskell typeclasses with OO sugar layered on top
[04:14:18] <dbaupp> vk: sawap(&mut lookahead, self.lookahead)
[04:14:25] <ChrisMorgan> dbaupp: yeah? Any objections to matching on bool?
[04:14:30] <vk> dbaupp: thanks.
[04:14:42] <dbaupp> ChrisMorgan: it's utter madness :P
[04:15:44] <ChrisMorgan> dbaupp: I suppose you'd prefer `let c = c.to_ascii().{if capitalise { to_upper } else { to_lower }}()`?
[04:16:07] <strcat> pcwalton: I mostly just went with ::new because it made grep easier ;p, I could just convert them all to range with sed now
[04:16:08] <dbaupp> ChrisMorgan: any particular reason the generated code uses Some(b) if b == 'char' as u8 rather than either generating a pile of constants and matching on Some(CHAR) (or just doing the as u8 itself)?
[04:16:29] <strcat> just fixing up the tutorials atm...
[04:16:37] <strcat> the benchmarks use a ridiculous number of these
[04:16:53] <dbaupp> ChrisMorgan: heh, no! clearly it should be `if capitalise {to_upper} else {to_lower}}()`. spacing is important, man.
[04:17:29] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[04:17:33] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[04:17:33] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:17:33] *** ChanServ sets mode: +o brson
[04:17:34] <ChrisMorgan> dbaupp: I used constants when I hand-wrote it, but it's simpler and more general not needing to do it that way. With headers, I'll have -, which isn't valid for ident.
[04:17:54] <dbaupp> ChrisMorgan: right, I was more wondering if it was faster?
[04:18:17] <cmr> fmt! is really really really slow. several orders of magnitude slower than sprintf, it seems, for `fmt!("%05d %d %d", zipcode, temperature, relhumidity)`
[04:18:33] <pcwalton> too many allocations
[04:18:35] <ChrisMorgan> It certainly shouldn't beâ€”literals with casts like that should be handled at runtime.
[04:18:41] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[04:18:44] <cmr> way too many, plus strconv isn't that great either
[04:18:46] <strcat> stdio is slow
[04:18:50] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:18:54] <n0vember> Does Rust's 'while !rdr.eof()' have the same issues as C's 'while( !feof( f ))'? I've seen it in a few places in the compiler tree. 
[04:19:00] <cmr> strcat: never touches stdio :p
[04:19:13] <strcat> cmr: oh I thought you meant sprintf from stdio
[04:19:27] <cmr> no, C's sprintf, sorry
[04:19:39] <cmr> unless that's also what you mean
[04:19:41] *** Quits: cdidd (cdidd@moz-3285B1AC.broadband.corbina.ru) (Ping timeout)
[04:19:42] <strcat> yeah, C's sprintf is slow ;p
[04:19:55] <dbaupp> ChrisMorgan: also: I imagine it would be faster if you could somehow rejigger-fy it so that the huge matches return static strings, not ~str. (makes the code smaller having the allocation in one place at the end, but this is probably just me fantasising)
[04:19:56] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[04:19:59] <strcat> there are much faster I/O libs
[04:20:54] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[04:20:58] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:21:03] <ChrisMorgan> dbaupp: bear in mind with those that they are *never* expected to happen. Malicious requests only, probably... just the type people do to make things slow down.
[04:21:38] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[04:21:51] <dbaupp> ChrisMorgan: right, and so they are bloating up the match with all the crap associated with the malloc
[04:22:02] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:22:26] <ChrisMorgan> So you'd end up with a smaller amount of generated code, which could be faster in cache?
[04:23:03] <strcat> 132s to change Range::new to range ;p
[04:23:20] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[04:23:25] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:23:35] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[04:23:53] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[04:23:55] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:25:02] <cmr> code runs a lot faster when you don't have an iloop
[04:25:04] * ChrisMorgan is coming to rapidly hate /~ in Vim (matches the last searched query rather than a literal ~)
[04:25:23] *** Joins: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP)
[04:25:26] <olsonjeffery>  /\~ 
[04:25:26] <olsonjeffery> ?
[04:25:53] <dbaupp> ChrisMorgan: yeah, less icache pressure
[04:26:08] *** Quits: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[04:26:09] <ChrisMorgan> olsonjeffery: I know, but it takes getting used to and it's an extra char
[04:26:09] <dbaupp> cmr: that seems unlikely. :P
[04:26:54] <dbaupp> ChrisMorgan: there's no make target for benchmarks is there?
[04:27:03] <ChrisMorgan> dbaupp: nope.
[04:27:18] <ChrisMorgan> Still manual.
[04:27:42] <strcat> dbaupp: you're okay with range() instead of Range::new() right?
[04:27:53] <dbaupp> strcat: 110%
[04:28:14] * strcat fires a sed
[04:28:49] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[04:28:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/NxNETQ
[04:28:49] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[04:28:50] <strcat> hopefully nothing breaks outside of libstd ;p
[04:29:16] <ChrisMorgan> The sed trudges out of the room sadly, seeking alternative employment
[04:29:30] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:29:52] <ChrisMorgan> What exactly *is* a sed? I'm picturing it as a small furry (but not to the degree of fuzziness) thing.
[04:30:09] <strcat> it's an ed with streams pouring out of it
[04:30:51] <olsonjeffery> that's what she sed!
[04:31:03] <olsonjeffery> sorry. that was quite awk-ward, wasn't it.
[04:31:07] <ChrisMorgan> I think they only have streams pouring out of them when they're working, and you just fired that one, so no streams coming out of it.
[04:31:09] <cmr> hah!
[04:31:12] <cmr> that second one was golden
[04:31:14] <ChrisMorgan> ack!
[04:31:27] <strcat> heh this somehow broke something
[04:31:49] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[04:31:49] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ios59w
[04:31:49] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[04:31:49] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:31:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_ndTHw
[04:31:49] <ghrust> 13rust/06auto 1447a2468 15Daniel Micay: replace `range` with an external iterator
[04:31:49] <ghrust> 13rust/06auto 14e33a792 15bors: auto merge of #8216 : thestinger/rust/range, r=huonw
[04:31:50] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[04:31:51] <strcat> ah check_match has a variant claled range
[04:32:38] <vk> Did "use dvec:DVec;" work at one point?
[04:32:48] <strcat> yes it was replaced with ~[]
[04:32:51] <cmr> https://gist.github.com/cmr/6137529
[04:32:54] <cmr> Not apples-to-apples obviously
[04:33:00] <cmr> But I think the perf traces are telling
[04:33:27] *** Quits: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP) (Connection reset by peer)
[04:33:32] <pcwalton> I really like the aesthetics of the new for loop over the old
[04:33:47] *** Joins: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP)
[04:33:50] <pcwalton> once .iter() is gone it'll it look better than Go's even
[04:33:51] <ChrisMorgan> Anyway, sounds like I should investigate ragel.
[04:33:58] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[04:34:03] <pcwalton> for expression in expressions { visitor.visit_expr(*expression, env.clone()) }
[04:34:17] <ChrisMorgan> Enormously better than Go's. Go only allows proper iteration of builtin types, by design...
[04:34:44] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:34:44] *** ChanServ sets mode: +o brson
[04:34:48] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[04:34:49] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e33a792 to 14ecefeb0: 02http://git.io/N3iJvQ
[04:34:49] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[04:34:50] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[04:34:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/07cqBA
[04:34:50] <ghrust> 13rust/06auto 14dc8b8f8 15Daniel Micay: replace `range` with an external iterator
[04:34:50] <ghrust> 13rust/06auto 144010d46 15bors: auto merge of #8216 : thestinger/rust/range, r=huonw
[04:34:50] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[04:34:52] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[04:35:09] <brson> strcat: once the new scheduler lands will be a good time to turn jemalloc back on, since there will be no worry about stack smashing
[04:35:26] <strcat> brson: wouldn't we hit the issue again though?
[04:35:28] <strcat> whatever it was
[04:35:45] <vk> strcat: So, how can I update code like this, "Vec(@DVec<Data>)"? Vec(@[Data]) or is that a completely wrong guess...
[04:35:54] <brson> eventually, but it'll be whoever reimplements segmented stacks' problem (i.e. mine)
[04:36:01] <strcat> vk: @~[Data]
[04:36:04] <strcat> @[] can't be resized
[04:36:18] <vk> strcat: oh cool, thanks!
[04:37:05] * strcat had to kill two functions called range in run-pass
[04:37:08] <strcat> should be good now...
[04:37:12] *** Quits: n0vember (n0vember@moz-690FFF9D.org) (Quit: ZNC - http://znc.in)
[04:37:21] <strcat> they're been nailed to underscores
[04:37:41] <pcwalton> brendan wanted GC<> instead of Gc<>
[04:37:42] <dbaupp> vk, strcat: @~[Data]` can't be resized either.
[04:37:48] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:37:49] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144010d46 to 14ecefeb0: 02http://git.io/N3iJvQ
[04:37:49] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:37:50] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[04:37:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/wqIARQ
[04:37:50] <ghrust> 13rust/06auto 14aecd537 15Daniel Micay: replace `range` with an external iterator
[04:37:50] <ghrust> 13rust/06auto 1447fbc38 15bors: auto merge of #8216 : thestinger/rust/range, r=huonw
[04:37:51] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[04:37:51] <strcat> er, @mut ~[Data]
[04:37:56] <strcat> I forgot DVec acted like Cell too
[04:38:03] <pcwalton> I wonder if we should just change our capitalization rules on abbreviations from .NET-style to Java-style
[04:38:04] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[04:38:14] <pcwalton> since Java-style matches JavaScript better anyway
[04:38:22] <vk> dbaupp: strcat: thanks
[04:38:28] *** Joins: cdidd (cdidd@moz-D1CFF15B.broadband.corbina.ru)
[04:38:36] <dbaupp> ChrisMorgan: it appears the ~"" -> "" change breaks it :(
[04:38:38] <cmr> pcwalton: what are the differences?
[04:38:40] <pcwalton> GC<Cell<~[Data]>> looks reasonable to me
[04:38:55] <pcwalton> cmr: XMLHTTPRequest would be Java-style, while XmlHttpRequest would be .NET-style
[04:39:02] <brson> yeah, when your abbreviation is only two letters. each letter gets angrier and angrier
[04:39:03] <cmr> ah
[04:39:09] <dbaupp> ChrisMorgan: http://ix.io/70D/diff
[04:39:10] <ChrisMorgan> dbaupp: what, in `("", c)`, then replacing `let mut s = s;` with `let mut s = s.to_owned();`?
[04:39:13] *** Joins: n0v (n0v@moz-690FFF9D.org)
[04:39:17] <brson> XMLHTTPRequest -yuck
[04:39:18] <pcwalton> I always though .NET-style looked weird
[04:39:22] <strcat> brson: smallcaps! we have unicode identifiers ;p
[04:39:25] <cmr> I don't really mind, but I prefer .NET style
[04:39:27] <pcwalton> XMLHTTPRequest looks better to me :P
[04:39:33] * strcat runs
[04:39:35] <pcwalton> but I've learned that I have weird tastes
[04:39:44] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[04:39:51] <dbaupp> ChrisMorgan: yes
[04:39:52] <ChrisMorgan> dbaupp: that is what I did myself and it at least compiled
[04:39:59] <pcwalton> brendan emailed me requesting GC<> instead of Gc<> so :P
[04:40:02] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:40:06] <strcat> É¢á´„<T>
[04:40:08] *** Quits: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP) (Quit: lmandel)
[04:40:10] <dbaupp> ChrisMorgan: yeah, it compiles, but ab just sits there doing nothing
[04:40:13] <strcat> wow dejavu sans mono has ugly smallcaps
[04:40:14] <pcwalton> strcat: +1
[04:40:30] <strcat> sadly no one can type those
[04:40:53] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[04:40:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1447fbc38 to 14ecefeb0: 02http://git.io/N3iJvQ
[04:40:53] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[04:40:54] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:40:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ZanzCg
[04:40:54] <ghrust> 13rust/06auto 14f431424 15Daniel Micay: replace `range` with an external iterator
[04:40:54] <ghrust> 13rust/06auto 143593ad4 15bors: auto merge of #8216 : thestinger/rust/range, r=huonw
[04:40:54] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:41:10] <pcwalton> â“â“‚â“â’½â“‰â“‰â“…â“‡â“”â“ â“¤â“”â“¢â“£
[04:41:15] * strcat thinks bors gets a feed from github that's 5 minutes behind ;p
[04:41:28] <dbaupp> ChrisMorgan: also, hello_world takes forever to compile :(
[04:41:29] <cmr> I wouldn't be surprised in the least
[04:41:40] <strcat> ()ÊÇu::dÉWÉ¥sÉH::dÉÉ¯É¥sÉÉ¥::pÊ‡s
[04:42:14] <pcwalton> I think once @ goes away Rust will be a fairly elegant looking language
[04:42:19] <pcwalton> and the iter transition is done
[04:42:27] <pcwalton> at least I hope so, so people will stop yelling at me on twitter ;)
[04:42:29] <dbaupp> ChrisMorgan: yeah, it times out.
[04:42:32] <strcat> I hope this cuts off more time
[04:42:38] <pcwalton> but I really like the look of it
[04:42:40] <cmr> Me too
[04:42:43] *** Joins: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP)
[04:43:01] <pcwalton> looks basically like Scala which is fine
[04:43:01] <ChrisMorgan> There's something to be said about having Xá´ÊŸHá´›á´›á´˜Request...
[04:43:15] <ChrisMorgan> But unfortunately, that thing is "argh! poor font support!"
[04:43:34] <cmr> I mean it's not the /perfect/ language, but I think it occupies the perfect spot of tradeoffs
[04:43:47] <dbaupp> ChrisMorgan: and being able to type it is kinda useful.
[04:43:50] <dbaupp> cmr: heretic!
[04:44:13] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Ping timeout)
[04:44:15] <cmr> dbaupp: guilty as charged! where's the nearest gallows?
[04:44:17] <ChrisMorgan> dbaupp: what, don't you have caps lock mapped as a modifier key to get small caps?
[04:44:19] <pcwalton> if it ends up that we're like Scala : Java :: Rust : C++
[04:44:21] <pcwalton> then I'll be happy
[04:44:25] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[04:44:32] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[04:44:46] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Ping timeout)
[04:44:49] <pcwalton> we don't have nearly as many features as Scala of course, but I mean just practically speaking
[04:45:08] <dbaupp> ChrisMorgan: nope, mine toggles keyboard layouts (I guess I could have a small caps layout there too.)
[04:45:23] <strcat> foreach is nice ;]
[04:45:52] *** Joins: int3_ (int3_@66D0A465.4F21B31A.AFDFC0EC.IP)
[04:45:57] <cmr> erickt: alright I'm done with rust-zmq for now, it seems fine
[04:46:04] *** Quits: lmandel (lmandel@B9FBB49.1F93A08E.ADB88A9.IP) (Quit: lmandel)
[04:46:05] <ChrisMorgan> dbaupp: times out with what, just `ab -n 10000 http://127.0.0.1:8001/`?
[04:46:09] <pcwalton> hmm, can't type annotate patterns in foreach?
[04:46:18] <dbaupp> cmr: you're doing that think where you're testing RNGs in https://gist.github.com/cmr/6137529
[04:46:21] <dbaupp> *thing
[04:46:28] <strcat> pcwalton: it just puts the pattern as Some(pattern)
[04:46:30] <dbaupp> ChrisMorgan: yup
[04:46:31] <cmr> feel free to pull the cleanup branch, though note that it requires https://github.com/mozilla/rust/pull/8193 to land for linux
[04:46:44] <strcat> pcwalton: atm it actually requires Some/None to be in scope
[04:46:45] <ChrisMorgan> dbaupp: did it work before that tweak?
[04:46:48] <cmr> dbaupp: I don't think so. I said it's naive, and it is, but just look at the perf traces.
[04:46:48] <strcat> somewhat annoying in libstd itself
[04:46:54] <dbaupp> ChrisMorgan: yes
[04:46:56] <ChrisMorgan> Try it again, several times.
[04:46:59] <cmr> dbaupp: the time spent in rust rng is trivial
[04:47:07] <dbaupp> cmr: oh, right.
[04:47:16] <cmr> dbaupp: and... I could change it to libc::random, but would that actually be faster?
[04:47:28] <cmr> My guess is "maybe, probably not" :p
[04:47:35] <strcat> it'll be fun to see if making the vector iterator "perfect" by fixing that remaining issue will help anything
[04:47:42] <strcat> should play well with loop-vectorize
[04:47:52] <strcat> now that *everything* uses it
[04:47:53] <dbaupp> cmr: you could change it to a simple function, not a random number, so it's an untainted comparison.
[04:47:54] <ChrisMorgan> dbaupp: and try it in a reg'lar browser, too. Sometimes it just doesn't work and restarting it fixes it.
[04:48:16] <cmr> dbaupp: I could use musl's simple bitshift rng
[04:48:19] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[04:48:44] <dbaupp> cmr: ... you don't need random numbers for that benchmark
[04:48:58] <strcat> although atm you'd have to write a function like 'fn foo(xs: ~[T]) -> ~[T]' instead of 'fn foo(xs: &mut [T])' to make the loop vectorizer happy
[04:48:59] <dbaupp> ChrisMorgan: nope :(
[04:48:59] <cmr> sure I do, don't want branch prediction in fmt! or sprintf to happen
[04:49:24] <bobbyrward> so if i wanted to contribute where would the best place to start be?  any cleanup left with foreach switch over?
[04:49:29] <strcat> cmr: fill an array with random numbers (100k+) and iterate over it?
[04:49:35] <dbaupp> cmr: just make it a "random" function of i: (i << 10 ^ i >> 2) or something.
[04:49:36] <cmr> strcat: hm, that's a good idea
[04:49:48] <cmr> dbaupp: that's basically what musl does, though slightly more robust :p
[04:49:50] <strcat> bobbyrward: the foreach thing is actually pretty close to done
[04:49:59] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[04:50:04] <strcat> well, I'm not sure - there might be 300 or so left
[04:50:17] <strcat> but it *feels* close to done after doing 2000 of them. ;p
[04:50:21] <cmr> bobbyrward: Look through https://github.com/mozilla/rust/issues?labels=E-easy for something interesting.
[04:50:23] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[04:50:27] <dbaupp> strcat: you broke it! :P
[04:50:35] <strcat> dbaupp: hm?
[04:50:36] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:50:43] <dbaupp> strcat: windows failed
[04:50:43] <strcat> oh windows
[04:50:57] <strcat> windows specific path with an unused import
[04:50:59] <strcat> *sigh*
[04:51:21] <ChrisMorgan> dbaupp: I haven't a clue. It's working fine for me. Sometimes this newrt stuff is a little temperamental.
[04:51:39] <ChrisMorgan> Actually, does the old version still work (i.e. undo the change, make)?
[04:52:47] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[04:52:47] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143593ad4 to 14ecefeb0: 02http://git.io/N3iJvQ
[04:52:47] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[04:52:48] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[04:52:48] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/XTKMCQ
[04:52:48] <ghrust> 13rust/06auto 14f65ba63 15Brian Anderson: Try to fix a periodic windows build failure due to broken rwildcard macro
[04:52:48] <ghrust> 13rust/06auto 14508d00d 15Alex Crichton: Update LLVM
[04:52:48] <ghrust> 13rust/06auto 14dc88b61 15Alex Crichton: Fix build issues once LLVM has been upgraded...
[04:52:50] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[04:53:09] *** Quits: int3_ (int3_@66D0A465.4F21B31A.AFDFC0EC.IP) (Client exited)
[04:53:32] *** Joins: mrordinaire (Mibbit@3749AFFF.391F484.FD383126.IP)
[04:53:47] *** Quits: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[04:54:07] <mrordinaire> hi, could anyone tell me why there are both Result and Either in the code base?
[04:54:15] <cmr> mrordinaire: there are iirc
[04:54:20] <cmr> unless Either was removed recently
[04:54:20] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[04:54:27] <cmr> oh you're asking why
[04:54:36] <mrordinaire> cmr: yeah
[04:54:41] <strcat> Result isn't what it should be
[04:54:58] <mrordinaire> strcat: could you elaborate more on that?
[04:55:02] <strcat> it could be useful type, but as it is it's not
[04:55:11] <cmr> mrordinaire: conceptually they are different things. Result represents an operation that succeeded or failed, Either is any arbitrary thing that could be one of two types
[04:55:35] <strcat> it should require <R, E: ToStr> Result<R, E> to be marginally useful
[04:55:39] <mrordinaire> cmr: in Haskell, Either is used just as Result is currently used in Rust
[04:56:00] *** Quits: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[04:56:01] *** Quits: gazoombo (uid6629@moz-E77DEB21.irccloud.com) (Ping timeout)
[04:56:01] <cmr> mrordinaire: Left and Right aren't useful names, Ok and Err are.
[04:56:16] <strcat> Err should always be something it can convert into an error message
[04:56:27] <strcat> and it can extend that with extension traits
[04:56:35] <cmr> strcat: all the code I write that uses Result has an enum as the Err and a ToStr
[04:56:43] <ChrisMorgan> I find Either to be useful for internal things where both are correct, and Ok/Err to be useful for external things where that is the semantic meaning of it.
[04:56:45] <cmr> (and all the code I stamp an r+ on :p)
[04:56:52] *** Joins: int3_ (int3_@66D0A465.4F21B31A.AFDFC0EC.IP)
[04:57:11] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:57:12] *** ChanServ sets mode: +o brson
[04:57:15] <strcat> let x = can_fail(); x.get()
[04:57:28] <strcat> it fails, it returns Err(SystemError) lets say
[04:57:33] <strcat> and SystemError has an error code
[04:57:44] <strcat> get will just report the strerror_r message with ToStr
[04:57:47] *** Quits: chii (Mibbit@moz-474FFD66.nycmny.east.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[04:59:03] <mrordinaire> I see
[04:59:15] <dbaupp> ChrisMorgan: yes, the old one still works.. strange :(
[04:59:17] <strcat> right now it's indeed pretty useless though
[04:59:43] <mrordinaire> so there is no favorite between the two?
[05:00:03] <cmr> I have never desired Either rather than Result in writing "normal" code
[05:00:04] <dbaupp> mrordinaire: Result if it is worked/failed, Either if it can be one or the other
[05:00:19] <strcat> use Result if you're reporting an error and the error is some type with a sensible ToStr implementation
[05:00:22] <ChrisMorgan> dbaupp: compiled the new one again and still not working?
[05:00:32] <strcat> where formatted as "error: %?" it would look reasonable
[05:00:42] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[05:00:52] <mrordinaire> strcat, cmr, dbaupp I see, thanks a bunch
[05:00:58] <dbaupp> mrordinaire: i.e. fn read_an_int_or_str() -> Either<int,~str>, fn open_file() -> Result<File, FileError>
[05:01:32] <mrordinaire> dbaupp: and FileError has a ToStr trait?
[05:01:34] <strcat> where FileError is an enum of possible errors, with a ToStr impl to get an explanation
[05:01:37] <strcat> yeah
[05:01:43] <mrordinaire> I see
[05:01:55] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[05:02:25] <dbaupp> ChrisMorgan: ah, recompiling seemed to fix it
[05:02:33] <ChrisMorgan> Weird. Unpleasant.
[05:02:39] <ChrisMorgan> But at least it's working as it should.
[05:03:24] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:03:24] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 14ad7a189 to 14234acad: 02http://git.io/k471pw
[05:03:24] <ghrust> 13rust/06try 14234acad 15Daniel Micay: replace `range` with an external iterator
[05:03:24] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[05:03:46] * strcat hates landing things like this
[05:04:00] <dbaupp> ChrisMorgan: and it appears I might have to recompile every time :/
[05:04:02] *** Quits: mrordinaire (Mibbit@3749AFFF.391F484.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:04:22] <sfackler> what's the safest way to interface with a C function that returns an enum? Will a Rust C-like enum end up with the same representation?
[05:04:25] <ChrisMorgan> dbaupp: recompile what?
[05:04:33] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[05:04:40] <cmr> sfackler: no
[05:04:41] <ChrisMorgan> And every time what?
[05:04:48] <cmr> maybe for now, but definitely not in the future
[05:04:55] <dbaupp> ChrisMorgan: the whole thing, everytime I ^C hello_world, it stops working the next time I run it
[05:05:00] <Diamond> sfackler: use the underlaying type equivalent in rust
[05:05:23] <cmr> And definitely don't do that either, at least not when dealing with the Rust side of things.
[05:05:30] <ChrisMorgan> dbaupp: that's weird. Could be the port isn't being released appropriately, though it is for me.
[05:05:38] <cmr> https://github.com/cmr/rust-zmq/blob/a69b432dbf1312d7e92bc26dcc1dc369281ae0d3/zmq.rs#L75 as a trivial example
[05:05:39] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[05:05:41] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[05:05:47] <ChrisMorgan> Then there's some period of time before you can bind to it again.
[05:05:57] <cmr> That pattern seems to be the cleanest, safest way :(
[05:06:06] <ChrisMorgan> I found out all about that when writing an HTTP server in C for a Uni assignment some time last year.
[05:06:07] <cmr> I don't like it though, feels gross
[05:06:15] <strcat> ChrisMorgan: if you run both in a network namespace they get their own loopback ;p
[05:06:19] <dbaupp> ChrisMorgan: ... and performance is really variable; 2000 - 4500 req/s, but that could just be my computer being silly
[05:06:35] <ChrisMorgan> dbaupp: for which example?
[05:06:52] <dbaupp> ChrisMorgan: hello_world
[05:07:04] <dbaupp> ChrisMorgan: which are you benching?
[05:07:12] <ChrisMorgan> apache_fake. It's got a little more meat to it.\
[05:07:27] <dbaupp> ok
[05:07:41] <ChrisMorgan> Still not much, but perhaps enough to make it a little more stable?
[05:07:53] <ChrisMorgan> (And also because when I started I could compare it against Apache.)
[05:08:23] <sfackler> cmr: thanks. i32 seems like not the right type for the raw version though
[05:08:44] <cmr> sfackler: (it is for zeromq, it's obviously different depending on the library you use)
[05:08:55] <strcat> sfackler: C enums don't have a defined layout
[05:09:11] <cmr> And neither do Rust enums!
[05:09:12] <sfackler> sad
[05:09:17] <strcat> on x86/x86_64 linux, gcc/clang make them start as 32-bit and then increase the size when they get bigger
[05:09:17] * cmr hates enums all around now.
[05:09:32] <strcat> but with -fshort-enums, they're as small as required
[05:09:37] <strcat> and on some archs that's the default
[05:10:17] <sfackler> i guess the register will (hopefully?) zero extend anyways
[05:10:20] <strcat> pretending they're c_int will often work though ;p
[05:10:34] <brson> pcwalton: what's the name for macros that are written in rust (the opposite of macro by example)?
[05:10:47] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[05:10:47] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14011028a to 14ecefeb0: 02http://git.io/N3iJvQ
[05:10:47] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[05:10:48] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[05:10:48] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/PYUjpA
[05:10:48] <ghrust> 13rust/06auto 14bbcce8d 15bors: auto merge of #8216 : thestinger/rust/range, r=huonw
[05:10:48] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[05:10:58] <dbaupp> brson: 'syntax extension', I think.
[05:10:59] <pcwalton> procedural macros is the theoretical term, syntax extensions is the rust term
[05:11:02] <strcat> well so much for seeing if it would get through try
[05:11:14] <brson> yeah, 'procedural' was what i was looking for
[05:11:26] <brson> danke
[05:11:41] <dbaupp> ChrisMorgan: ok, I don't see a big difference between "" and ~""
[05:12:39] <Eridius> brson: you r+'d the wrong commit (github's showing them out of order on the PR again)
[05:12:44] <Eridius> brson: regarding https://github.com/mozilla/rust/pull/8213
[05:13:18] <Eridius> well, I'm assuming bors looks at the correct latest commit
[05:15:40] <brson> Eridius: r+ :statue_of_liberty:
[05:15:49] <Eridius> hah
[05:16:25] *** Joins: jaen (jaen@moz-74B7B7.play-internet.pl)
[05:17:58] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[05:18:05] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[05:18:19] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[05:19:34] *** Joins: pwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[05:19:41] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Ping timeout)
[05:19:59] *** pwalton is now known as pcwalton
[05:23:21] *** Joins: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de)
[05:23:31] *** Quits: n0v (n0v@moz-690FFF9D.org) (Quit: ZNC - http://znc.in)
[05:23:41] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:23:41] *** ChanServ sets mode: +o dherman
[05:24:01] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[05:24:44] *** Quits: bobbyrward (bobbyrward@moz-66B120E.triad.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[05:26:02] *** Joins: pwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[05:26:13] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Ping timeout)
[05:27:43] *** Quits: pwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Ping timeout)
[05:30:28] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[05:30:59] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:30:59] *** ChanServ sets mode: +o brson
[05:32:27] *** Quits: int3_ (int3_@66D0A465.4F21B31A.AFDFC0EC.IP) (Client exited)
[05:34:44] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Ping timeout)
[05:35:17] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[05:41:50] *** Quits: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:43:10] *** Joins: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr)
[05:44:02] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[05:44:06] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[05:44:18] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[05:44:18] *** ChanServ sets mode: +o brson
[05:44:29] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[05:47:29] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[05:51:08] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:51:34] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:52:20] *** Quits: jaen (jaen@moz-74B7B7.play-internet.pl) (Ping timeout)
[05:53:23] <ChrisMorgan> I seem to recall there being some discussion about having an "mod enum" or such.
[05:57:59] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[05:58:06] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[06:07:14] *** Quits: Crnobog (uid1041@moz-E77DEB21.irccloud.com) (Ping timeout)
[06:08:24] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[06:11:32] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[06:13:59] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[06:16:11] <Eridius> brson: not sure if you get notified when I add a comment to your line comment
[06:16:30] <Eridius> brson: if not, I put the docstring on the impl for RWArc because it's on the impl for Arc, but you have a good point, MutexArc puts it on the fn. We should standardize for all 3
[06:16:50] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[06:25:37] *** Joins: jaen (jaen@moz-889822DC.neoplus.adsl.tpnet.pl)
[06:26:42] <brson> Eridius: maybe you are thinking of bblum
[06:26:59] <brson> or I have amnesia
[06:28:31] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[06:28:32] <bblum> probably me
[06:28:39] <bblum> considering i just commented on it
[06:28:59] <bblum> Eridius: yes, that was basically what i meant
[06:29:10] <bblum> i don't care whether it's on the impl or function in particular
[06:29:12] <strcat> bunch of ad-hoc internal iterators left in librustc ;[
[06:29:38] <bblum> Eridius: also, i do get email, but i may be the only person who reads his or her github notification emails
[06:31:01] *** Joins: Ms2ger (Ms2ger@moz-BA3429A8.adsl-dyn.isp.belgacom.be)
[06:37:14] <sfackler> why won't rust allow this?
[06:37:18] <sfackler> rusti: struct Box<'self> {x: &'self int} fn foo<'a>(x: &'a mut int) -> Box<'a> {Box{x: x}} let mut x = ~5; let a = foo(x); let b = foo(x);
[06:37:19] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DFQD
[06:38:03] <Luqman> what's the syntax for --target-feature?
[06:38:32] *** Quits: RMF (RMF@moz-F27ACC15.dsl.telepac.pt) (Ping timeout)
[06:39:18] <strcat> Luqman: --target-feature avx,sse41
[06:39:29] <dbaupp> sfackler: because `x` gets frozen for the lifetime of a, so you can't reuse it in a &mut slot
[06:39:34] <strcat> Luqman: just keep in mind it will break if you have tasks because we don't save the registers on context switches
[06:39:40] <brson> i just need john carmack to acknowlede rust
[06:39:54] <Luqman> strcat: can I also pass the mcpu options?
[06:40:28] <strcat> Luqman: don't think so
[06:40:30] <bblum> rusti: struct Box<'self> {x: &'self int} fn foo<'a>(x: &'a mut int) -> Box<'a> {Box{x: x}} let mut x = ~5; let a = foo(&*x); let b = foo(&*x);
[06:40:31] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/iNaF
[06:40:33] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[06:40:37] <Luqman> strcat: ok, thanks
[06:40:49] <bblum> sfackler: ^ that's why
[06:41:01] <bblum> sfackler: oh wait, sorry --
[06:41:10] <bblum> sfackler: it's because &mut
[06:41:19] <bblum> rusti: struct Box<'self> {x: &'self int} fn foo<'a>(x: &'a int) -> Box<'a> {Box{x: x}} let mut x = ~5; let a = foo(x); let b = foo(x);
[06:41:20] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/YcfT
[06:41:41] <bblum> rusti: struct Box<'self> {x: &'self int} fn foo<'a>(x: &'a int) -> Box<'a> {Box{x: x}} let mut x = ~5; let _a = foo(x); let _b = foo(x);
[06:41:42] -rusti- <anon>:5:97: 5:98 warning: variable does not need to be mutable [-W unused-mut (default)]
[06:41:42] -rusti- <anon>:5          struct Box<'self> {x: &'self int} fn foo<'a>(x: &'a int) -> Box<'a> {Box{x: x}} let mut x = ~5; let _a = foo(x); let _b = foo(x);
[06:41:42] -rusti-                                                                                                           ^
[06:41:42] -rusti- ()
[06:42:52] <sfackler> ah :/
[06:42:55] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[06:43:56] <shachaf> What behavior are you hoping for here?
[06:44:21] <sfackler> I'm working on bindings to libpq, Postgres's C interface
[06:44:46] <sfackler> for whatever reason, libpq doesn't manage prepared statements for you
[06:44:51] *** Joins: heftig (heftig@8D5076D2.6FC4DE2F.FEC4A986.IP)
[06:44:59] <sfackler> you refer to them by the string handles they're stored as in the database
[06:45:07] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[06:45:21] <sfackler> so to make multiple prepared statements on one connection, you need some way of creating a unique identifier for each
[06:45:43] <sfackler> and having a "next_stmt_id: uint" in the connection struct seems like a straightforward solution
[06:45:46] <sfackler> but
[06:46:09] <sfackler> the prepared statement object that the bindings return need to contain a reference to the postgres connection
[06:46:14] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:46:24] <sfackler> and the best way to do that lifetime-wise is to store a borrowed pointer to the Rust connection struct
[06:46:49] <sfackler> er, actually the second part doesn't matter
[06:47:04] <sfackler> anyways, it means that you end up with something like
[06:47:34] <sfackler> impl PostgresConnection { fn prepare(&mut self, query: &str) -> PostgresStatement {...}
[06:47:49] <sfackler> which means you can't have two prepared statements alive at the same time
[06:47:55] <sfackler> which is sad
[06:48:23] <sfackler> er, ... -> ~PostgresStatement {...}
[06:48:26] <bblum> you can't make them be immutable borrows?
[06:48:42] <strcat> you can use the address of a unique ptr as the id
[06:49:09] <bblum> you might consider having an immutable borrow to a Cell
[06:49:09] <sfackler> that's a neat idea
[06:49:25] <bblum> and mutate the cell by taking and putting_back
[06:50:07] <sfackler> cool, thanks
[06:50:27] <strcat> could you just make Statement an object with a destructor, and a uint id as a priv field?
[06:50:32] <strcat> hrm
[06:50:54] <sfackler> the current layout is
[06:51:04] <bblum> the cell is basically moving the borrow failure to runtime, but if you are careful with the interface, you can make it always work probably
[06:51:22] <sfackler> struct PostgresStatement<'self> {conn: &'self PostgresStatement, name: ~str}
[06:51:37] <sfackler> with a destructor that deallocates the statement
[06:51:52] <sfackler> and sadly has to be tagged #[unsafe_destructor] due to the borrowed pointer
[06:53:00] <strcat> bye bye uint::range
[06:53:06] <bblum> every destructor is unsafe destructor it turns out
[06:53:56] <sfackler> how so?
[06:54:09] *** Joins: n0v (n0v@moz-690FFF9D.org)
[06:54:35] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[06:55:36] <bblum> not in a type system way
[06:55:41] *** Joins: gazoombo (uid6629@moz-E77DEB21.irccloud.com)
[06:55:51] <bblum> but like most use cases of destructors are for things that have borrowed pointers
[06:56:20] <sfackler> oh
[06:56:34] <sfackler> the worry with unsafe_destructor is that you can create a reference cycle?
[06:58:53] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[06:58:53] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/6nWjRw
[06:58:53] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[06:59:15] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Quit: dim-an)
[07:00:37] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:00:54] <Luqman> r? https://github.com/mozilla/rust/pull/8220
[07:01:02] <bblum> sfackler: yep
[07:01:15] <Luqman> klutzy: ^
[07:01:42] <klutzy> Luqman: :D wow!!
[07:01:51] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:01:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/31YXXQ
[07:01:51] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:01:54] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:01:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/dRcs8A
[07:01:54] <ghrust> 13rust/06auto 14b424956 15Patrick Walton: librustc: Introduce a new visitor type based on traits and port syntax to it....
[07:01:54] <ghrust> 13rust/06auto 147666cd3 15bors: auto merge of #8163 : pcwalton/rust/new-visitor, r=pcwalton...
[07:01:54] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:02:21] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Client exited)
[07:02:22] *** Quits: maikklein2 (maik@moz-41F03AC8.dip0.t-ipconnect.de) (Ping timeout)
[07:02:28] <strcat> buildbot noise is annoying
[07:02:37] * strcat had try builds running at the same time >.<
[07:03:47] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[07:04:27] <Luqman> klutzy: i had been meaning to do that for a while
[07:05:43] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[07:07:13] <doomlord>  if i ever work on another c++ project collaboratively, i wonder if #define fn auto #define let auto is going to bug people..
[07:07:20] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[07:08:17] <strcat> any lowercase define is going to bug people ;p
[07:08:33] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[07:08:35] <doomlord> hehe also any #define usually
[07:10:50] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[07:10:50] *** ChanServ sets mode: +o brson
[07:11:16] <bblum> auto von bismarck
[07:11:32] <doomlord> i tried making making something to hack function prototpes out using sed in the makefile (go through foo.cpp, extract lines with fn yada::....  and emit foo_methods.h, to be #included in foo.h class{...#include foo_methods } . worked great until default arguments
[07:13:45] <sfackler> is there something like fn as_c_str_arr<T>(&[~str], &fn(**c_char) -> T) -> T anywhere?
[07:14:58] <mark_edward> is there a way to get an int from a hex string?
[07:15:36] <strcat> from_str_radix?
[07:15:39] <ChrisMorgan> mark_edward: uint::from_str_radix(s, 16)
[07:15:47] <mark_edward> ChrisMorgan: thanks!
[07:16:20] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[07:17:00] <Ms2ger> Rightfully so, defines are horrible
[07:17:03] <ChrisMorgan> (More generally, it's the num::FromStrRadix::from_str_radix trait method.)
[07:17:26] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Client exited)
[07:20:10] *** Joins: HERTZ (Xplod@moz-6BDFDFBE.dynamic.amis.net)
[07:21:37] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[07:22:41] <sammykim> I look in old rust code. Why do we use a return value of closure ? like If implementation is pub fn each<'r,T>(v: &'r [T], f: &fn(&'r T) -> bool) -> bool. I understand "return value of fn each" to finish loop(for) but I don't understand why closure has return value. 
[07:23:37] <sammykim> Even when we use each, no return value in closure body. then why is it defined that closure has bool return type..?
[07:23:48] <dbaupp> sammykim: no, the closure returns to finish the for loop, the outside -> bool is to say that the loop ran to completion, or that it broke
[07:24:27] <dbaupp> sammykim: the `for` syntax automatically inserts "return true" and "return false" at the appropriate places in the closure (e.g. `break` == `return false`)
[07:25:13] * strcat might just remove for right now ;s
[07:25:30] <strcat> well, I guess we need the other range fns first
[07:26:53] <dbaupp> rusti: let v= [1]; 'loop: foreach _ in v.iter() { break 'loop; }
[07:26:53] -rusti- <anon>:5:28: 5:35 error: expected `loop`, found `foreach`
[07:26:53] -rusti- <anon>:5          let v= [1]; 'loop: foreach _ in v.iter() { break 'loop; }
[07:26:54] -rusti-                                      ^~~~~~~
[07:26:54] -rusti- application terminated with error code 101
[07:27:29] <strcat> dbaupp: I know it doesn't work but it's a different bug ;p
[07:27:34] <strcat> and easy to fix
[07:27:43] <dbaupp> strcat: yeah, I was just checking
[07:27:57] * dbaupp was interested, not worried
[07:28:48] <strcat> dbaupp: I don't get to see the actual speedup from this because of the stupid try builds :(
[07:28:51] * ChrisMorgan wishes one could have more compact structs with enums: `struct Foo { bar: enum { A, B } }`
[07:29:05] <dbaupp> strcat: :(
[07:29:09] <strcat> oh well
[07:29:16] <dbaupp> strcat: next build
[07:29:19] <strcat> can see the tests dropped
[07:29:30] <dbaupp> ... which is the new visitor... that uses @mut :/
[07:29:58] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[07:30:01] <dbaupp> does anyone know why pcwalton decided to rewrite the visitor, and *not* move away from @mut?
[07:31:02] * strcat shrugs
[07:31:05] <strcat> one thing at a time
[07:32:45] <sfackler> anyone know what's going on here/how to do this in a less awful way? https://gist.github.com/sfackler/be5e005ff8e6d134b72d
[07:33:27] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[07:33:45] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[07:34:19] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[07:34:28] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[07:35:29] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[07:39:54] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[07:43:46] <ChrisMorgan> sfackler: I can just imagine it: `use postgres::sadface;`
[07:43:55] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[07:43:55] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 147666cd3 to 14bbcce8d: 02http://git.io/N3iJvQ
[07:43:55] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[07:43:57] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:43:57] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/y_tDPA
[07:43:57] <ghrust> 13rust/06auto 14162d256 15Graydon Hoare: test: un-xfail now working run-pass/foreign-struct.rs, close #2334.
[07:43:57] <ghrust> 13rust/06auto 149982025 15bors: auto merge of #8173 : graydon/rust/2013-07-31-issue-2334-un-xfail-a-test, r=brson
[07:43:58] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:46:05] <mark_edward> sfackler: what are you trying to do with the str array?
[07:46:52] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[07:47:42] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[07:50:30] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Ping timeout)
[07:53:33] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[07:53:44] <dbaupp> strcat: I got stuck in an iloop https://github.com/mozilla/rust/issues/4813#issuecomment-21990971
[07:53:57] <strcat> heh
[07:54:38] <strcat> dbaupp: https://github.com/mozilla/rust/issues/5323 ;p
[07:55:01] * strcat fixes the comment
[07:56:04] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[07:57:30] *** Joins: vosvos (vosvos@moz-9B8AD3A8.vinita.lt)
[08:00:46] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[08:02:18] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[08:03:36] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[08:05:51] *** Joins: Crnobog (uid1041@moz-E77DEB21.irccloud.com)
[08:06:24] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[08:07:09] *** Quits: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net) (Ping timeout)
[08:07:47] *** Joins: dim-an (ermolovd@moz-C6393EED.yandex.net)
[08:08:08] *** Quits: nyx (cedalion@moz-FC228802.wp.shawcable.net) (Ping timeout)
[08:08:26] *** Parts: dim-an (ermolovd@moz-C6393EED.yandex.net) ()
[08:09:52] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[08:10:31] *** Joins: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net)
[08:12:28] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[08:12:33] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[08:13:52] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[08:13:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149982025 to 14bbcce8d: 02http://git.io/N3iJvQ
[08:13:53] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[08:13:54] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[08:13:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_nhYog
[08:13:54] <ghrust> 13rust/06auto 1405eff5f 15Brian Anderson: extra: Remove dbg module and rt support code...
[08:13:54] <ghrust> 13rust/06auto 14dbde42e 15bors: auto merge of #8175 : brson/rust/nodbg, r=graydon...
[08:13:54] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[08:15:48] *** Joins: cyndis (cyndis@moz-939B4D35.dy.asm.fi)
[08:20:30] *** Quits: thesnowdog (doug@629A8C2F.CDB23781.6F17036B.IP) (Quit: WeeChat 0.4.1)
[08:20:42] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[08:21:13] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[08:21:57] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[08:22:11] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[08:22:21] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[08:22:40] *** Quits: Crnobog (uid1041@moz-E77DEB21.irccloud.com) (Ping timeout)
[08:23:25] *** Quits: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[08:23:53] *** Joins: Crnobog (uid1041@moz-E77DEB21.irccloud.com)
[08:25:04] *** Joins: pupoque1 (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[08:25:29] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[08:26:12] <cyndis> how strange. every time i compile a lib (bjz: glcore-rs) rust seems to think the list of stuff it has changes
[08:26:13] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Ping timeout)
[08:26:50] <bjz> cyndis: I haven't updated glcore-rs in yonks
[08:26:59] <bjz> :(
[08:27:10] <cyndis> yeah, but it doesn't look like it's glcore's fault
[08:27:21] <cyndis> `nm' shows all the correct symbols in there
[08:27:44] <cyndis> and when i happen to get a good enough subset, everything works properly :p
[08:28:35] <dbaupp> cyndis: iirc, it's because glcore uses `pub use ...`, and that essentially doesn't work.
[08:28:50] <cyndis> okay
[08:30:21] <cyndis> bjz: so how do you use glfw-rs if not with glcore-rs
[08:30:24] <cyndis> or do you not? :p
[08:30:56] <bjz> operngles is good
[08:31:02] <bjz> *opengl-es
[08:31:20] <bjz> cyndis: we will eventually have a function loader
[08:31:25] <bjz> but not yet
[08:31:25] <cyndis> ah yes, that should work
[08:31:28] <cyndis> yep
[08:31:39] <bjz> I would reccomend using opengl-es for now
[08:32:07] <cyndis> i thought the extern function pointer support was pretty closed to being merged. what happened to it?
[08:35:04] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[08:36:18] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[08:36:21] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:41:40] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:42:07] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[08:46:47] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:46:53] *** Quits: heftig (heftig@8D5076D2.6FC4DE2F.FEC4A986.IP) (Ping timeout)
[08:47:58] *** Joins: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP)
[08:49:44] *** Joins: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de)
[08:50:22] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:52:48] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[08:54:28] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[08:55:22] <cde> cyndis: it got drunk one too many times and had a car accident
[08:55:28] <cde> don't drink and drive, I guess
[08:57:01] *** Quits: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de) (Ping timeout)
[08:57:22] *** Quits: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) (Client exited)
[08:59:08] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[08:59:56] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[09:05:02] <doener> cmr: hm, your fmt! benchmark tells me you're working with ZMQ :-)
[09:17:59] *** Quits: rsaarelm (rsaarelm@moz-D1CB7158.dhcp.inet.fi) (Quit: leaving)
[09:18:41] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[09:18:54] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:21:47] <bjz> cyndis: It has been close for several months. Lots of unforceen stuff. It will be there eventually! :)
[09:26:41] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[09:26:41] <nmatsakis> how do I call uint::range now?
[09:26:44] <vk> What's become of split_char_nonempty()?
[09:29:20] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[09:30:16] <orshem> hi everyone
[09:30:19] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Input/output error)
[09:30:26] <orshem> i'm getting an ICE with a note: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details
[09:30:32] <orshem> how do i do that?
[09:30:45] <orshem> i set RUST_LOG=rustc=1 and ??
[09:31:20] <klutzy> $ RUST_LOG=rustc=1,::rt::backtrace /some/executable
[09:31:54] <orshem> klutzy: thanks!
[09:33:53] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[09:35:53] *** Quits: pupoque1 (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[09:36:09] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[09:39:02] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:39:25] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[09:39:46] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[09:40:52] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[09:41:42] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[09:43:10] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:43:35] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[09:44:01] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[09:45:48] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[09:48:23] *** Quits: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net) (Ping timeout)
[09:48:49] *** Joins: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net)
[09:49:55] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[09:49:55] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_nhYog
[09:49:55] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[09:50:42] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[09:50:55] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[09:51:14] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[09:51:26] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[09:52:51] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[09:52:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/55f44A
[09:52:51] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[09:52:54] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[09:52:54] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/5zh_Ew
[09:52:54] <ghrust> 13rust/06auto 14f65ba63 15Brian Anderson: Try to fix a periodic windows build failure due to broken rwildcard macro
[09:52:54] <ghrust> 13rust/06auto 14508d00d 15Alex Crichton: Update LLVM
[09:52:54] <ghrust> 13rust/06auto 14dc88b61 15Alex Crichton: Fix build issues once LLVM has been upgraded...
[09:52:55] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[09:53:07] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[09:54:48] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[09:55:25] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:58:59] *** Joins: BitPuffin (quassel@moz-49828767.cust.tele2.se)
[10:00:17] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[10:04:15] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0/20130729175331])
[10:04:34] *** Quits: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[10:04:34] *** Joins: pupoque1 (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[10:07:46] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[10:08:27] *** Joins: nyx (cedalion@moz-FC228802.wp.shawcable.net)
[10:10:09] *** Joins: jafu (bzlandfill@C8AEB144.5F4361F8.9105FBCF.IP)
[10:12:02] <jafu> hey guys I ran into a little problem with this piece of code I was experimenting with .. So i have this generic fucntion fn f<s: Str>[vector: [s]] {}
[10:12:07] *** Quits: jafu (bzlandfill@C8AEB144.5F4361F8.9105FBCF.IP) (Quit: CGI:IRC)
[10:12:44] *** Joins: jafu (bzlandfill@C8AEB144.5F4361F8.9105FBCF.IP)
[10:13:51] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[10:16:03] <jafu> So I have this generic function fn f<S: Str>{vec: [S]} {} And I create the vector on the fly. and at times it happens that the vector is empty and the rustc throws an error saying that it is unable to deduct the type.
[10:16:29] <jafu> So how do u pass an empty vector to a generic function like this ?
[10:16:38] *** Joins: thesnowdog (doug@629A8C2F.CDB23781.6F17036B.IP)
[10:17:01] <jafu> Some how I was unable to type the round brackets so I used curly braces ..
[10:17:30] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:19:04] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[10:19:52] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:21:02] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[10:22:06] <orshem> jafu: i think there is no such type as [n]. there is either a pointer to dynamic vector ~[Type], or fixed vector [TYPE, ..CONST_COUNT]
[10:22:24] <orshem> or other pointers such as &[Type] and @[Type]
[10:22:52] <orshem> but i'm new to Rust as well
[10:24:01] *** Joins: sigma-pc (sigma@moz-BE11A887.range109-151.btcentralplus.com)
[10:28:17] <mark_edward> jafu: the signature should be  fn f<s: Str>[vector: &[str]] {}
[10:28:39] <mark_edward> jafu: actually there's no such type as str either, just ~str and &str i believe
[10:30:37] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[10:31:59] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[10:32:12] <kimundi> fn f<S: Str>[vector: &[S]] {} would accept reasonable combinations of string vectors
[10:32:36] <kimundi> that is: ~[&str], ~[~str], &[&str], &[~str]
[10:33:15] <kimundi> the outer vector gets borrowed to a &[S], and both &str and ~str implement Str
[10:33:18] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[10:33:48] <kimundi> and then you can get an &str from both by calling as_slice() on it
[10:34:00] <kimundi> jafu: ^
[10:34:46] <kimundi> " by calling as_slice() on each element"*
[10:35:15] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[10:36:02] *** Quits: jafu (bzlandfill@C8AEB144.5F4361F8.9105FBCF.IP) (Quit: CGI:IRC (EOF))
[10:38:10] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[10:39:00] <kimundi> oh damn, that wasn't jafu's actual question
[10:39:09] <kimundi> come bacck! :P
[10:39:55] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[10:40:44] <sebcrozet> Hi! Is there a way to clone a trait-object?
[10:43:29] *** Quits: StarLight (StarLight@moz-966906A6.dynamic.avangarddsl.ru) (Ping timeout)
[10:43:56] *** Joins: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de)
[10:45:50] *** Quits: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de) (Ping timeout)
[10:45:50] *** Quits: igl (igl@moz-54CC9C07.adsl.alicedsl.de) (Connection reset by peer)
[10:46:41] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[10:46:42] *** Joins: igl (igl@moz-5248A071.adsl.alicedsl.de)
[10:46:58] *** Joins: StarLight (StarLight@moz-8794D28B.pppoe.avangarddsl.ru)
[10:49:29] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[10:50:59] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[10:52:53] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[10:52:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145009002 to 14dbde42e: 02http://git.io/N3iJvQ
[10:52:53] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[10:52:54] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[10:52:54] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/qHsnxw
[10:52:54] <ghrust> 13rust/06auto 14e995d99 15Huon Wilson: syntax: implement cfg!() which evaluates to true/false where #[cfg] would keep/remove....
[10:52:54] <ghrust> 13rust/06auto 142460170 15bors: auto merge of #8188 : huonw/rust/cfg-macro, r=pcwalton...
[10:52:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[10:53:28] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[10:55:09] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[10:56:35] <SimonSapin> can I use macros defined in other modules?
[10:59:47] <orshem> SimonSapin, iirc no. you can't import export macros yet
[10:59:59] <SimonSapin> ok, thanks orshem 
[11:01:14] *** Joins: Florob (Florob@moz-39532932.de)
[11:06:40] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:09:38] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[11:11:58] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[11:12:18] *** Quits: DeokjinKim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:14:09] <dbaupp> nmatsakis: just `foreach i in range(lo, hi) { .. }` (it's in the prelude)
[11:14:39] <dbaupp> SimonSapin: other modules in one crate, or cross-crate?
[11:14:45] <SimonSapin> same crate
[11:15:23] <dbaupp> rusti: mod foo { #[macro_escape];  macro_rules! bar( () => { 1 } ) } bar!()
[11:15:24] -rusti- 1
[11:15:33] <dbaupp> rusti: mod foo {  macro_rules! bar( () => { 1 } ) } bar!()
[11:15:34] -rusti- <anon>:5:54: 5:57 error: macro undefined: 'bar'
[11:15:34] -rusti- <anon>:5          mod foo {  macro_rules! bar( () => { 1 } ) } bar!()
[11:15:34] -rusti-                                                                ^~~
[11:15:34] -rusti- application terminated with error code 101
[11:15:43] <SimonSapin> If I use $foo multiple times in a macro, is is evaluated every time?
[11:15:48] <SimonSapin> $foo:expr
[11:16:32] <dbaupp> rusti: macro_rules! foo( ($e:expr) { { $e; $e } } ) foo!(println("hi"))
[11:16:32] -rusti- <anon>:5:37: 5:38 error: No rules expected the token: {
[11:16:32] -rusti- <anon>:5          macro_rules! foo( ($e:expr) { { $e; $e } } ) foo!(println("hi"))
[11:16:32] -rusti-                                               ^
[11:16:33] -rusti- application terminated with error code 101
[11:16:44] <dbaupp> rusti: macro_rules! foo( ($e:expr) => { { $e; $e } } ) foo!(println("hi"))
[11:16:44] -rusti- hi
[11:16:45] -rusti- hi
[11:16:45] -rusti- ()
[11:18:48] <orshem> dbaupp: http://huonw.github.io/isrustfastyet/mem/ is up to date?
[11:19:01] <orshem> i can't see any improvement from the new foreach
[11:19:04] <dbaupp> orshem: nope, benchmarker is down
[11:19:20] <orshem> dbaupp, oh great
[11:19:27] <orshem> well not great that it's down
[11:19:50] <orshem> but that there that is probably an improvement
[11:19:53] <dbaupp> well, not exactly down; cmr's just in the process of improving it
[11:20:27] <orshem> the zigzag of the cputime graph is weird
[11:20:38] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[11:20:58] <dbaupp> yeah, just noise
[11:21:36] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[11:21:42] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[11:30:28] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[11:35:27] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[11:36:59] *** Joins: wilfred (uid159@moz-5F4AA75A.irccloud.com)
[11:42:19] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:44:58] *** Quits: sigma-pc (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Connection reset by peer)
[11:46:00] *** Quits: mark_edward (quassel@moz-9631ECE3.public.wayport.net) (Ping timeout)
[11:48:39] *** Quits: BitPuffin (quassel@moz-49828767.cust.tele2.se) (Ping timeout)
[11:52:10] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:53:37] *** Joins: fabiand (fabiand@moz-673F23F0.adsl.alicedsl.de)
[11:53:48] *** Quits: fabiand (fabiand@moz-673F23F0.adsl.alicedsl.de) (Quit: Verlassend)
[11:56:41] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[11:57:10] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:58:04] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[11:58:07] *** Quits: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP) (Ping timeout)
[11:58:25] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[11:59:38] *** Quits: pupoque1 (Adium@297D6F99.EF706C30.C0C64AB3.IP) (Connection reset by peer)
[12:00:47] *** Joins: fabiand (fabiand@moz-673F23F0.adsl.alicedsl.de)
[12:01:04] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[12:04:15] *** Quits: ssbr (ssbr@moz-141F89C6.block0.gvtc.com) (Ping timeout)
[12:05:31] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[12:07:52] *** Joins: ssbr (ssbr@moz-141F89C6.block0.gvtc.com)
[12:07:52] *** Joins: heftig (heftig@6573ED45.9A77AED9.3663C14F.IP)
[12:08:17] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[12:09:33] *** Quits: ssbr (ssbr@moz-141F89C6.block0.gvtc.com) (Ping timeout)
[12:10:18] *** Joins: ssbr (ssbr@moz-141F89C6.block0.gvtc.com)
[12:10:40] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[12:13:18] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[12:13:18] *** Joins: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com)
[12:21:43] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[12:23:05] <engla> dbaupp: you pushed to have it named range()  \o/
[12:23:07] <engla> :-)
[12:23:48] <dbaupp> pcwalton did too :)
[12:23:54] <engla> ah
[12:26:43] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Quit: dbaupp)
[12:32:19] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[12:34:08] *** Quits: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Client exited)
[12:34:09] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:35:12] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[12:41:22] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[12:42:02] *** Quits: fabiand (fabiand@moz-673F23F0.adsl.alicedsl.de) (Quit: Verlassend)
[12:43:30] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[12:43:45] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[12:43:58] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[12:43:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qHsnxw
[12:43:58] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[12:45:34] *** Parts: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP) ()
[12:45:43] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[12:46:53] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[12:46:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/zgBMwA
[12:46:53] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[12:47:36] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:49:55] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:49:55] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/zgBMwA
[12:49:55] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:51:05] *** Quits: jaen (jaen@moz-889822DC.neoplus.adsl.tpnet.pl) (Ping timeout)
[12:54:27] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[12:56:07] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[12:58:56] *** Joins: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de)
[12:59:20] *** Joins: pupoque (Adium@297D6F99.EF706C30.C0C64AB3.IP)
[13:00:51] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[13:02:56] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[13:10:30] *** Quits: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP) (Ping timeout)
[13:12:10] *** Joins: yong (chatzilla@89F941DF.4E87ADC2.263D9828.IP)
[13:15:55] <olsonjeffery> sully: ping
[13:16:15] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[13:16:28] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[13:16:58] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[13:17:21] *** Quits: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de) (Ping timeout)
[13:18:38] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[13:19:28] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[13:26:02] *** Joins: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[13:27:26] *** Joins: jaen (jaen@FB01674D.56B727FE.4B52F012.IP)
[13:28:41] <SimonSapin> I wish function return types could be infered
[13:31:28] *** Quits: zq (p@moz-4C4640FD.com) (Ping timeout)
[13:34:33] *** Quits: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net) (Quit: Leaving...)
[13:34:48] *** Joins: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net)
[13:35:53] *** Joins: lmandel (lmandel@3E0B9D77.C1F57925.ADB88A9.IP)
[13:37:33] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[13:38:59] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[13:39:41] <smvv> sfackler: https://github.com/mozilla/rust/wiki/Doc-under-construction-FAQ#noncopyable-stack-closures
[13:41:11] *** Quits: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net) (Quit: Leaving...)
[13:42:05] <cmr> doener: Yes it does :)
[13:42:26] <cmr> doener: it came up because my port of hte weather update example in rust was horrifically slow
[13:43:26] <doener> cmr: yeah, lots of time wasted in bounds checking. But using mut_iter() makes it even slower
[13:43:36] <Seldaek> SimonSapin: I think it's kinda good to force you to declare your interfaces, makes you think about api a bit more
[13:43:39] <engla> dbaupp: your change to the vec iterator should probably do the same to the rev iterator
[13:43:51] <orshem> SimonSapin: i find it very helpful that function arguments and return type have to be annotated. it is helpful as documentation as well
[13:43:53] <smvv> sfackler: change the line to "as_c_str_array_helper(array, c_array, idx + 1, |x| blk(x))"
[13:44:01] <dbaupp> engla: woops, forgot that
[13:44:29] <engla> dbaupp: and by the way, I don't know why, but the random access iterator further down uses ptr offset
[13:44:42] *** Joins: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de)
[13:44:49] <engla> that must be wrong too
[13:45:07] <SimonSapin> Seldaek: the body of my function is `iter.filter(|c| c != Whitespace)`, the signature is four times as big and not even right yet. But the compiler knows what it shoud be!
[13:45:29] <dbaupp> engla: yup
[13:45:49] <dbaupp> engla: wait no, it's not
[13:46:13] <Seldaek> SimonSapin: yeah ok for anon functions it's nonsense
[13:46:13] <dbaupp> engla: because if a thing is zero-sized, then every version of it looks the same, so offset == noop is fine.
[13:46:23] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[13:46:34] <engla> dbaupp: it returns identical &T for every index
[13:46:35] <kimundi> SimonSapin: You can allways reduce the signature burden by introducing typedefs
[13:46:52] <dbaupp> engla: yeah? but *x is indistiguishable
[13:47:11] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[13:47:14] <engla> dbaupp: yes, but it's not a by-value iterator so you can detect the difference
[13:47:20] <engla> sure, it doesn't matter, it doesn't break
[13:47:25] <dbaupp> engla: true
[13:47:38] <dbaupp> engla: (I guess you'll have to talk to strcat about it)
[13:48:48] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:49:01] *** Joins: BitPuffin (quassel@moz-49828767.cust.tele2.se)
[13:49:16] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[13:49:17] <engla> dbaupp: it seems consistent.. x_x
[13:49:21] <engla> rusti: use std::iterator::*; struct A; let v = [A,A]; let it = v.iter(); (it.idx(0).unwrap() as *A, it.idx(1).unwrap() as *A, &v[0] as *A, &v[1] as *A)
[13:49:21] -rusti- ((0x7fe79a111788 as *()), (0x7fe79a111788 as *()), (0x7fe79a111788 as *()), (0x7fe79a111788 as *()))
[13:50:05] <dbaupp> engla: haha, cool.
[13:53:09] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[13:53:27] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[13:55:16] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[13:57:05] *** Quits: maikklein (maik@moz-40DD7537.dip0.t-ipconnect.de) (Ping timeout)
[13:58:58] <mark_edward> i'm having weird troubles with my Keccak impl... I know the actual block function/permutations are working right, but my final output isn't right... I suspect a padding problem..
[14:00:00] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[14:00:49] <mark_edward> is there a Rustequivalent for memset?
[14:00:54] <engla> rusti: use std::iterator::*; struct A; let v = [A,A]; let mut it = v.iter(); (it.next().unwrap() as *A, it.next().unwrap() as *A , &v[0] as *A, &v[1] as *A)
[14:00:55] -rusti- ((0x7f055ef12788 as *()), (0x7f055ef12789 as *()), (0x7f055ef12788 as *()), (0x7f055ef12788 as *()))
[14:01:14] <engla> dbaupp: (the normal iterator progresses in ptr addresses of course)
[14:01:45] <cmr> mark_edward: std::ptr::set_memory
[14:01:52] <mark_edward> cmr: thanks!
[14:02:59] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[14:03:00] <engla> foreach x in v.mut_iter() { *x = 0 }   *should* compile to something efficient like memset too
[14:04:08] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[14:04:18] <dbaupp> doener: do you reckon https://github.com/mozilla/rust/pull/8225 might fix the bit where mut iter is slow?
[14:05:31] <doener> dbaupp: likely, IIRC strcat said that the ptrtoint/inttoptr leads to awful asm
[14:05:52] <miloshadzic> Does anyone know  how I can iterate over a string's pairs of characters?
[14:07:14] <engla> miloshadzic: take two iterators, advance one of them 1 step, then iterate over them together with  i.zip(j)?
[14:07:33] <doener> dbaupp: what do the bench results look like?
[14:07:52] <dbaupp> doener: no different for .iter()
[14:07:59] <dbaupp> doener: testing mut_iter now
[14:08:31] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[14:08:32] <miloshadzic> engla, thanks I will give it a try
[14:09:26] <olsonjeffery> ok. i know this is probably a simple fix, but i guess i didn't get the memo: https://gist.github.com/olsonjeffery/6140063
[14:09:47] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[14:09:50] *** Joins: alex_abreu (alex@moz-7421D6C9.mc.videotron.ca)
[14:10:24] <cmr> olsonjeffery: First, why are you doing (*self) ?
[14:11:08] <olsonjeffery> cmr: first, is it germaine to answering my question or are you just picking nits?
[14:11:32] <cmr> olsonjeffery: not a nit
[14:12:29] <kimundi> olsonjeffery: You want to dereference to get to the Chan, right?
[14:12:36] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[14:12:42] <olsonjeffery> yes.
[14:12:55] <kimundi> but rustc thinks you want to deref the &mut here
[14:12:56] <olsonjeffery> anyways, yeah yeah. auto-deref.
[14:12:59] *** Joins: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net)
[14:13:13] <olsonjeffery> i did self.send(p) w/ the same results
[14:13:16] <kimundi> I'm not sure if **self would worw
[14:13:56] <kimundi> olsonjeffery: Alternativly, try to pattern match on self
[14:13:58] <olsonjeffery> does not work
[14:14:02] <dbaupp> kimundi: won't help
[14:14:15] <cmr> What is the signature of send?
[14:14:18] <olsonjeffery> yeah.. can't match on self w/ a single, anon variant?
[14:14:24] <dbaupp> olsonjeffery: the only way that will work without a copy of some sort (impossible), is if fulfill takes (self, ..) i.e. self by value
[14:14:28] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:14:28] *** ChanServ sets mode: +o dherman
[14:14:29] <kimundi> let &mut Promise(ref c) = self; c.send()
[14:14:37] <dbaupp> cmr: send consumes
[14:14:39] *** Quits: tcr (tcr@moz-EE576D3C.hsd1.ma.comcast.net) (Ping timeout)
[14:14:44] <cmr> ah, that's the problem
[14:14:49] <olsonjeffery> pub fn send(self, val: T) {
[14:14:50] <engla> olsonjeffery: why doesn't just self.send(v)  work?
[14:14:56] <engla> oh
[14:15:04] <olsonjeffery> oh
[14:15:08] <kimundi> yeah, then proimse needs to consume too
[14:15:09] <olsonjeffery> its trying to consume the chan
[14:15:14] * olsonjeffery nods
[14:15:52] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[14:16:00] <olsonjeffery> cmr: good call, thanks
[14:16:12] <dbaupp> erickt: ping
[14:16:19] <erickt2> hey dbaupp
[14:16:35] <dbaupp> erickt2: for https://github.com/mozilla/rust/pull/8226, there's `!` right?
[14:16:39] <dbaupp> rusti: !(-1)
[14:16:40] -rusti- 0
[14:16:51] <dbaupp> rusti: !0x88u8
[14:16:51] -rusti- 119
[14:17:09] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[14:17:15] <dbaupp> erickt2: (mostly nitpicking the implementation, not the use of the trait.)
[14:17:26] <erickt2> ooh I didn't even know about that operator
[14:17:28] <mark_edward> dbaupp: for your pointer fix, do you think the Add operator would compile to the same? it's marked as #[inline] is just a wrapper around ptr.offset
[14:17:47] <miloshadzic> engla, wouldn't zipping the two strings(say "abcd") give me [[a, b], [b, c] [c, d]]. I'm looking for [[a,b] [c,d]]
[14:17:54] <dbaupp> mark_edward: should be fine
[14:18:17] <mark_edward> dbaupp: okay. was wondering if my addition was useless or not performant
[14:18:31] <erickt2> rusti: !2
[14:18:31] -rusti- -3
[14:18:40] <kimundi> miloshadzic: I thnik there is something witk the name 'windowed' in str?
[14:18:52] <dbaupp> mark_edward: you mean Add? no, with #[inline] it should be no-cost (i.e. it's just sugar for .offset)
[14:18:57] <dbaupp> kimundi: don't think so
[14:19:09] <mark_edward> miloshadzic: no that's only in std::vec i think
[14:19:18] <engla> miloshadzic: aha! yeah it only exists for vec so far
[14:19:20] <mark_edward> dbaupp: are strings implemented with an underlying vec?
[14:19:39] <kimundi> mark_edward: yes, they are [u8]
[14:19:41] *** Quits: BitPuffin (quassel@moz-49828767.cust.tele2.se) (Ping timeout)
[14:19:44] <dbaupp> miloshadzic: you have to do it yourself, unfortunately
[14:19:53] <kimundi> but that doesn't help for for char'?
[14:20:10] <kimundi> hmm... that would be an candidate for a new Iterator adapter
[14:20:21] <erickt2> dbaupp: I'll close my PR since our not is bitwise
[14:20:30] <kimundi> ChunckedIterator
[14:20:40] <dbaupp> miloshadzic: let mut it = s.iter(); let (c1, c2) = match (it.next(), it.next()) { (Some(c1), Some(c2)) => { (c1,c2) } (_, _) => { fail!() } } or something
[14:21:09] <dbaupp> erickt2: I'm not sure... `not` seems like it could mean something different to compl in some circumstances.
[14:21:10] *** Quits: wilfred (uid159@moz-5F4AA75A.irccloud.com) (Ping timeout)
[14:21:13] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[14:21:14] *** Quits: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:21:24] *** Quits: Crnobog (uid1041@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:21:31] <olsonjeffery> it's sad how many problems can be solved with cell.take();
[14:21:40] <miloshadzic> dbaupp, thanks I'll try to work it out
[14:21:41] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Ping timeout)
[14:21:50] *** Quits: gazoombo (uid6629@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:21:52] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:22:20] <erickt2> dbaupp: I could add a ops::BitNot trait that just compiles to !x for ints/uints
[14:22:32] <mark_edward> dbaupp: does declaration order matter in Rust?
[14:22:44] <dbaupp> mark_edward: of functions, etc? no
[14:22:55] <mark_edward> cool, thanks!
[14:23:16] <dbaupp> erickt2: I'd be (weakly) in favour of that, but you'll have to run it passed others
[14:23:19] <miloshadzic> I'm not sure how hard would it be to add the chunked iterator to strings but I'd be down to write it as an exercise. Somewhat new to rust tho.
[14:25:58] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:25:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GR7CUw
[14:25:58] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:26:53] <erickt2> dbaupp: do we have a logical not operator?
[14:27:04] <cmr> erickt2: also !
[14:27:17] <cmr> only logical when applied to bool
[14:27:21] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:27:21] *** ChanServ sets mode: +o dherman
[14:28:53] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[14:28:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PCmHng
[14:28:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:29:18] <dbaupp> doener: it's possibly 87 ns (old) vs 79 ns (new)
[14:29:26] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[14:29:48] <engla> "Instead of the poems I had hoped for, there came only a shuddering blackness..."
[14:30:01] <dbaupp> engla: a test failure in std?
[14:30:25] <engla> yeah
[14:30:30] <engla> it's a new one :)
[14:30:48] <engla> I like it
[14:31:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:31:54] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/PCmHng
[14:31:54] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:31:55] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[14:31:56] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/_A-iIQ
[14:31:56] <ghrust> 13rust/06auto 148802466 15Ben Blum: Relax some atomic barriers. Loosen up all that tension. There, doesn't that feel good?
[14:31:56] <ghrust> 13rust/06auto 14036a6d2 15Ben Blum: Document task killing design and relaxed barrier rationale.
[14:31:56] <ghrust> 13rust/06auto 14aeaed77 15Ben Blum: Make a forgotten assert in comm be cfg(test)-dependent
[14:31:58] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[14:33:31] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[14:34:27] *** Quits: marc (marc@E31B39DA.F9D61A8.416A0103.IP) (Ping timeout)
[14:37:36] *** Quits: ssbr (ssbr@moz-141F89C6.block0.gvtc.com) (Ping timeout)
[14:37:46] *** Joins: ssbr (ssbr@moz-141F89C6.block0.gvtc.com)
[14:39:39] *** Joins: marc (marc@E31B39DA.F9D61A8.416A0103.IP)
[14:43:50] *** Joins: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[14:44:28] *** Quits: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com) (Ping timeout)
[14:46:29] *** Joins: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com)
[14:46:50] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:58:20] *** Joins: nano (nano@moz-972880B.superkabel.de)
[14:59:07] <mark_edward> cmr: how would i reexport stuff from a submodule of the crate? pub use self::<mod>::* is giving me erros
[14:59:35] <kimundi> mark_edward: Needs to be explicit afaik
[14:59:48] <kimundi> at leasnt due to bugs
[14:59:50] <mark_edward> kimundi: meaning what?
[14:59:57] <mark_edward> explicit meaning what I mean
[15:00:00] <kimundi> no *, but list all manually
[15:00:57] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[15:01:35] <jedestep> unfortunate bug
[15:02:07] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[15:02:17] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[15:02:46] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[15:05:26] *** Quits: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[15:07:03] <mark_edward> :-(
[15:07:06] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[15:08:13] *** Quits: telotortium (rmi1@moz-90BFA359.dhcp.mdsn.wi.charter.com) (Ping timeout)
[15:08:44] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:11:16] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[15:11:17] <jedestep> pub use self::<mod>::item isn't working out for me either actually
[15:11:22] <jedestep> maybe it's because I'm in a macro
[15:11:35] <jedestep> but pub use self::$t isn't resolving (better than getting ICE though I suppose)
[15:12:55] *** Joins: telotortium (rmi1@moz-90BFA359.dhcp.mdsn.wi.charter.com)
[15:13:00] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:14:42] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[15:17:03] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[15:17:20] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[15:17:21] *** Joins: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:17:34] <SimonSapin> rusti: 1.1 % 1.
[15:17:34] -rusti- 0.1
[15:17:38] <SimonSapin> rusti: -1.1 % 1.
[15:17:39] -rusti- -0.1
[15:18:02] *** Joins: yonran (yonran@moz-962F33EB.acuitus.com)
[15:18:04] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Ping timeout)
[15:18:17] <SimonSapin> rusti: let a = 1.1; a - a.floor()
[15:18:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/XGaJ
[15:18:39] <SimonSapin> rusti: let a = 1.1f64; a - a.floor()
[15:18:40] -rusti- 0.1
[15:18:44] <SimonSapin> rusti: let a = -1.1f64; a - a.floor()
[15:18:45] -rusti- 0.9
[15:18:47] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:19:02] <SimonSapin> rusti: let a = 0f64; a - a.floor()
[15:19:03] -rusti- 0
[15:19:10] <SimonSapin> rusti: let a = 2f64; a - a.floor()
[15:19:11] -rusti- 0
[15:20:29] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[15:22:22] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[15:24:21] <mark_edward> kimundi: that still doesn't seem to be working..
[15:24:29] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:27:43] *** Joins: MiguelD (kvirc@2ACDA535.A137FB69.46937063.IP)
[15:27:58] *** Joins: RMF (RMF@moz-79BD8246.dsl.telepac.pt)
[15:29:34] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[15:34:04] <jedestep> mark_edward: not working for me either
[15:34:11] <jedestep> :(
[15:35:07] <mark_edward> ./me commiserates
[15:35:10] * mark_edward commiserates
[15:38:19] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:38:23] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:38:48] <jedestep> if i could figure out how to fix this macro business i wouldn't even need that to work
[15:40:59] *** Quits: RMF (RMF@moz-79BD8246.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[15:41:07] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[15:41:15] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[15:45:18] *** Quits: erickt2 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[15:45:49] <pauls> SimonSapin: (to hone your intuition about macros, I suggest using `rustc --pretty expanded` to look at the result of macro expansion.)
[15:46:04] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[15:46:13] <SimonSapin> interesting, thanks pauls 
[15:46:21] *** Joins: Guest (textual@34641662.FB4DE631.66C78B76.IP)
[15:46:56] *** Joins: RMF (RMF@moz-79BD8246.dsl.telepac.pt)
[15:47:05] <pauls> No problem, just spreadin' the good news about meta-programmin'
[15:51:57] <cmr> So if I do this right I think I'll be able to have J Random Trustworthy Community Member do builds for the benchmarker..
[15:52:03] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[15:52:18] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[15:52:21] <cmr> Only non-trivial part is communicating the build artifacts in a good way with zmq
[15:52:31] *** Joins: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net)
[15:54:11] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[15:56:24] *** Quits: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net) (Ping timeout)
[15:56:29] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[15:56:45] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[15:57:04] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:57:14] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[15:57:16] <kimundi> cmr: Ouoh, I volunteer for arm benchmarks on a rasberry pie! :P
[15:57:41] <kimundi> expect one data point per week
[15:58:02] <cmr> kimundi: the thing is, the builds don't need to take place on the same box as the benchmarks
[15:58:10] <cmr> the Build Network could cross-compile stuff for the rpi
[15:58:14] <cmr> and it just sits there benchmarking
[15:58:17] <kimundi> pah, where's the fun in that
[15:58:20] <jedestep> I have a netbook from 2008 if you want something else painfully slow
[15:58:26] <pauls> kimundi: I am imagining that you will see how many times you can lift a pie with one hand.
[15:58:51] <kimundi> xD
[15:58:52] *** Joins: slartoff (Mibbit@CDEB6BFF.D3A46DCA.B1AF74A1.IP)
[15:59:06] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[15:59:26] <SimonSapin> pauls: well, Rust macros are a bit weak to be called meta-programming IMO.
[15:59:38] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: WeeChat 0.4.2-dev)
[15:59:43] <SimonSapin> Though I would love to transform AST nodes with rust code
[15:59:45] <kimundi> I% not sure who would loose that benchmark comzparison.. the ARM processor, or my actual arm
[15:59:46] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[15:59:58] *** Joins: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net)
[16:00:16] <kimundi> SimonSapin: You can, with syntax extensions
[16:00:29] <kimundi> they will be user writable in the future
[16:00:38] <pauls> SimonSapin: ahem! They're based on Scheme's `syntax-rules`, which is a totally legit metaprogramming system.
[16:00:41] <SimonSapin> oh, nice
[16:00:59] <SimonSapin> kimundi: for now thatâ€™s a privilege reserved to rustc, right?
[16:01:01] <pauls> (plus, they're Turing-complete!)
[16:01:05] <kimundi> yeah
[16:01:08] <SimonSapin> pauls: are they?
[16:01:17] <cde> yes, are they?
[16:01:20] <cmr> yes, they are
[16:01:28] <cde> fine.
[16:01:40] <SimonSapin> cmr: could you elaborate?
[16:01:51] <pauls> It's mostly a party trick...
[16:01:57] *** Joins: ecr (Thunderbir@moz-F724119C.uoregon.edu)
[16:01:57] <cmr> eholk wrote a lambda calculus interpreter
[16:01:58] <SimonSapin> still :)
[16:02:14] <pauls> ...but it's possible to use pattern matching to do computation.
[16:02:26] <SimonSapin> oh, right
[16:02:59] *** Quits: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net) (Quit: syatchmenoff)
[16:03:36] <pauls> Note that this doesn't mean that you can write any syntax extension in `macro_rules!`; for example, only syntax extensions can even peer into literals, so `do_n_times!(3, ...)` isn't possible in `macro_rules!`
[16:04:07] <jedestep> pauls: so I gave fold.rs a function to fold up a vector of items, and used it in fold_mod. modified the existing expand_item to work on a vector of items. does this approach seem sane at all?
[16:04:29] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[16:04:31] <jedestep> right now the result is that it fails to expand std-macros so obviously something is still wrong with it
[16:04:36] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[16:05:58] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[16:07:51] <pauls> jedestep: That sounds pretty reasonable.
[16:07:52] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[16:07:53] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:07:53] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_A-iIQ
[16:07:53] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:08:05] <pauls> What do you mean by "std-macros" and "fails to expand"?
[16:08:22] *** Joins: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP)
[16:08:41] <pauls> You're adding a new "many items here, but please pretend I'm flat" AST node?
[16:09:07] <pauls> I think most dangers with that will be caught by the type system.
[16:09:22] <pauls> (got to go to lunch now, sorry)
[16:09:32] <miloshadzic> there has to be a better way to do this conversion: https://gist.github.com/miloshadzic/7c485934c2f243546cbd
[16:10:04] <cmr> miloshadzic: why would you use iterators for that?
[16:10:13] <cmr> it's much more easily and efficiently expressed imperatively
[16:10:51] <miloshadzic> cmr: i'm used to doing stuff with map/fold etc :/
[16:10:53] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[16:10:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/tYh1hg
[16:10:53] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[16:11:12] <cmr> miloshadzic: sure, but there's a place and a time for everything, and this is not that :p
[16:12:19] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:12:30] <miloshadzic> will try again
[16:12:39] <dbaupp> miloshadzic: match o { Some(v) => v, None => fail!() } == o.unwrap()
[16:13:02] <miloshadzic> dbaupp: thanks!
[16:13:33] <cmr> miloshadzic: you should be able to assert that the length of input is a multiple of two, then take successive two-byte slices and give it to u8::from_str_radix
[16:13:54] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[16:13:54] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/tYh1hg
[16:13:54] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[16:13:56] <dbaupp> miloshadzic: also .filter(|o| o.is_some()).transform(|o| o.unwrap()) == .filter_map(|o| o)
[16:13:57] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[16:13:58] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/AwZH9Q
[16:13:58] <ghrust> 13rust/06auto 143e5b058 15Felix S. Klock II: Make crate tests depend on their extern crates.  Reorder TEST_HOST_CRATES in hopes of exposing future instances of this bug.
[16:13:58] <ghrust> 13rust/06auto 14fc57182 15bors: auto merge of #8202 : pnkfelix/rust/fsk-issue8056-make-crates-must-dep-on-subcrates, r=graydon...
[16:13:59] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[16:15:03] <dbaupp> miloshadzic: and filter_map(|x| foo).transform(|y| something_returning_optoin) == .filter_map(|x| foo.chain(|y| bar))
[16:16:54] <miloshadzic> foo and bar are some functions?
[16:17:03] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[16:18:21] <dbaupp> miloshadzic: nah, just whatever you've got written in those places (but, i typoed: bar == something_returning_option)
[16:18:42] <sully> olsonjeffery: pong
[16:19:04] <dbaupp> miloshadzic: so .filter_map(|o| o.chain(|s| u8::from_str_radix(s, 16)).unwrap())
[16:20:29] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:21:12] *** Joins: wilfred (uid159@moz-5F4AA75A.irccloud.com)
[16:21:50] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[16:22:02] *** Joins: gazoombo (uid6629@moz-E77DEB21.irccloud.com)
[16:22:03] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[16:22:23] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[16:22:52] *** Quits: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:23:03] *** Quits: jaen (jaen@FB01674D.56B727FE.4B52F012.IP) (Ping timeout)
[16:23:09] <miloshadzic> dbaupp: thanks a lot, doesn't even need the unwrap in the end
[16:23:26] <dbaupp> miloshadzic: ah, right, yes.
[16:23:44] *** Joins: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net)
[16:23:56] <miloshadzic> cmr, i'll try doing it in a more efficient/imperative fashion but since I use iteration a lot generally I want to get a hang of it
[16:24:12] <cmr> miloshadzic: sure
[16:24:19] *** Joins: Crnobog (uid1041@moz-E77DEB21.irccloud.com)
[16:24:35] <olsonjeffery> sully: hey.. ended up fixing that compiler error w/ ~Trait-as-type .. was pebkac-related
[16:24:51] <sully> olsonjeffery: ok
[16:28:58] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[16:30:20] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[16:30:35] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:32:09] *** Quits: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net) (Quit: Leaving...)
[16:32:16] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:32:59] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[16:35:07] <cmr> Is there a portable, safe way to turn a 4-byte slice into a u64?
[16:35:38] <cmr> The inverse of ToBytes
[16:35:45] <kimundi> cmr: depends on what you mean with portable
[16:36:07] <cmr> kimundi: Portable in that I can specify an endianness and it won't fail on unaligned access
[16:36:13] <cmr> (though that second part is "safe")
[16:36:14] <kimundi> are those 4 bytes a specific byte order, or are they system byte order
[16:36:32] <cmr> specific, although it's going to be system byte order for all the sane archs (little endian)
[16:36:39] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[16:37:22] <kimundi> cmr: If you know the order, you can just shift the 4 bytes into the right place, no?
[16:37:29] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[16:37:57] <cmr> kimundi: I was hoping there was something in std to do it for me
[16:38:18] <kimundi> there might be... But this sounds easy enough
[16:38:39] <cmr> not just the bswap intrinsics, but doing a safe, potentially unaligned read of a u64 from the slice
[16:38:52] <kimundi> We should probably have a from_bytes module
[16:39:06] <kimundi> (would need to be unsafe thougk)
[16:40:09] <kimundi> cmr: hm, isn't a direcd read a different operation than that before? 
[16:40:22] <cmr> direcd?
[16:40:25] <cmr> what?
[16:40:32] <kimundi> direct*
[16:40:55] <cmr> I cannot understand that sentence even with the typo fixed :(
[16:42:07] <sp3d> cmr: io::read_[le/be]_uint_n?
[16:42:20] <kimundi> what I mean is: If you do 4 seperate byte reads, then 3 shifts into a u64, you assume that &[u8] has a fixed byte order, and convert to the byte order of a u64 implicitly through the shifts
[16:42:25] <sp3d> &[uint] -> u64
[16:42:26] <cmr> sp3d: Ah yes, bytes reader!
[16:42:33] <sp3d> er, u8 or w/e
[16:42:56] <cmr> kimundi: yes, that is what I would have hoped was in std
[16:43:04] <cmr> and it is! read_u64 on a Reader
[16:43:09] <sp3d> ah
[16:43:14] <kimundi> IF you just directly want to go &[u8] -> u64, then you are assuming that the byte order in the &[u8] is the same as that of an u64
[16:43:20] *** Joins: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net)
[16:43:20] *** Parts: yonran (yonran@moz-962F33EB.acuitus.com) (Leaving)
[16:43:51] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[16:44:25] <kimundi> In short: where does your &[u8] come from, and what do you know about it :P
[16:44:32] <cmr> The network!
[16:44:40] <kimundi> That's an important question here
[16:44:48] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:44:53] <cmr> I know its byte order, but not that it's necessarily aligned that I can do a direct read
[16:45:21] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:53:09] *** dherman is now known as dherman-errands
[16:54:22] *** Quits: StarLight (StarLight@moz-8794D28B.pppoe.avangarddsl.ru) (Client exited)
[16:57:14] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:57:35] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[16:57:42] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[16:58:09] *** Joins: eholk (eholk@moz-B0798A8B.uconnect.utah.edu)
[16:59:03] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:59:30] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[16:59:31] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[16:59:35] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:59:57] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[17:00:50] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[17:01:20] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[17:02:48] *** Joins: StarLight (StarLight@moz-24285283.dynamic.avangarddsl.ru)
[17:02:55] <jedestep> pauls: I'm using an actual vector of items; parsing it with parse_items_and_view_items. The issue is at stage1, macros from the std_macros module are unrecognized i.e. "undefined macro 'assert!'"
[17:04:57] <erickt> cmr: thanks for the help with rust-zmq
[17:05:07] <cmr> erickt: np
[17:05:14] <cmr> thanks for doing all the hard work :)
[17:07:48] *** Joins: thomaslee (thomaslee@moz-6C3931E3.static.twtelecom.net)
[17:07:58] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:08:11] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[17:11:18] <pauls> jedestep: hm. Nothing obvious comes to mind.
[17:12:47] *** Joins: brianm (brianm@D2D642B9.79695EE7.489C5759.IP)
[17:13:19] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[17:14:46] <jedestep> I think I spotted it; it still has a default fold_item
[17:20:09] <syatchmenoff> hello, can someone help me understand how to deal with this error? https://gist.github.com/syatchmenoff/6141655
[17:20:31] <cmr> syatchmenoff: there's a bug right now with rvalue lifetimes.
[17:20:46] <cmr> syatchmenoff: you need to create another intermediate, let third2 = first.next(), and then call next on that
[17:21:07] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:21:07] *** ChanServ sets mode: +o pcwalton
[17:21:21] <syatchmenoff> ah
[17:21:58] <syatchmenoff> can you point me toward the issue ticket if there is one or recommend some key words to search for?
[17:22:15] <cmr> https://github.com/mozilla/rust/issues/3511 I think
[17:22:27] *** Quits: dherman-errands (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman-errands)
[17:22:31] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[17:23:28] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:23:28] *** ChanServ sets mode: +o brson
[17:24:29] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[17:24:55] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:25:13] <erickt> cmr: great work, but I don't think you need recv_into. Instead we can extend the zmq::Message to be used with zmq_recvmsg. I think that'll be a safer interface
[17:25:25] <Seldaek> ah crap, #[link(name="..")] doesn't define the default name of the binary? I tried to use the foo/mod.rs convention but then it builds as mod.exe :/ 
[17:26:06] <cmr> erickt: I only added it for the first zguide example, I don't think it's a useful API
[17:26:12] <cmr> I'd be perfectly fine removing it
[17:27:00] <cmr> (also, zmq_msg_recv, zmq_recvmsg is deprecated)
[17:27:47] <erickt> cmr: yeah, that one :)
[17:28:18] <syatchmenoff> cmr: thanks
[17:28:34] <erickt> cmr: I'll merge your stuff in, then play around with using zmq_msg_recv
[17:29:06] <erickt> cmr: done!
[17:29:20] <cmr> erickt: thanks!
[17:30:23] *** Joins: mschifer (Adium@moz-7B0110AD.mv.mozilla.com)
[17:30:23] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[17:30:40] *** Quits: sebcrozet (sebcrozet@moz-7FB6C00B.w193-252.abo.wanadoo.fr) (Ping timeout)
[17:31:01] <Seldaek> btw is the size of the binaries generally considered too big right now or is this not likely to improve?
[17:31:02] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[17:31:17] <cmr> Seldaek: too big
[17:31:32] <Seldaek> alright good to hear
[17:31:36] <cmr> most of it is metadata
[17:31:41] *** bnicholson is now known as bnicholson|pto
[17:31:57] <Seldaek> because yeah a main() {} build is 53K here 
[17:31:57] * cmr thinks it would be useful to allow separating metadata from the binary
[17:32:15] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:32:37] <cmr> We could probably have an --opt-level=small for less inlining and usch
[17:32:47] *** Quits: slartoff (Mibbit@CDEB6BFF.D3A46DCA.B1AF74A1.IP) (Ping timeout)
[17:33:15] <Seldaek> eh well, it's not like it matters a lot in most cases
[17:33:56] <cmr> ugh rustdoc_ng ICEs
[17:35:11] <jdm> is there a way to loop something like continue in a for loop?
[17:36:08] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:36:11] <jdm> oh look, continue expression in the manual
[17:36:17] <kimundi> jdm: `loop;`
[17:36:30] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:36:43] <kimundi> actually, no that I think about it... Does loop and break work in a foreach yet?
[17:37:00] *** Quits: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[17:37:00] <engla> yes, it desugars to a loop { } 
[17:37:49] *** Joins: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP)
[17:37:55] <engla> foreach x in iter  ~~>   loop { match iter.next() { None => break, Some(x) => ... } }
[17:39:43] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:41:00] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:41:09] *** Joins: nano (nano@moz-972880B.superkabel.de)
[17:41:09] <kimundi> right, no need for explicit support
[17:41:17] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[17:42:10] *** Quits: mschifer (Adium@moz-7B0110AD.mv.mozilla.com) (Quit: Leaving.)
[17:42:14] *** Joins: mschifer (Adium@moz-7B0110AD.mv.mozilla.com)
[17:42:41] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:42:45] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[17:43:15] *** Joins: tcr_ (tcr@moz-6EBF8439.mycingular.net)
[17:43:22] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[17:43:48] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[17:45:04] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[17:47:00] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[17:49:13] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[17:49:15] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[17:49:42] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[17:49:54] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:49:54] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AwZH9Q
[17:49:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:52:51] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[17:52:52] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/q6sWtQ
[17:52:52] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[17:52:52] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[17:52:52] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Zm1pyQ
[17:52:52] <ghrust> 13rust/06auto 14c3fa411 15Brian Anderson: std: Implement SingleThreaded spawn mode for newsched
[17:52:52] <ghrust> 13rust/06auto 14f1c1f92 15bors: auto merge of #8221 : brson/rust/single-threaded, r=graydon...
[17:52:53] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[17:53:16] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[17:54:21] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[17:55:54] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:57:15] *** Quits: mschifer (Adium@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[17:57:32] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[17:57:49] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[18:00:24] <toddaaro> brson: awesome, so once bors finishes your PR we are all set for newrt?
[18:01:16] <bblum> toddaaro: i gotta fix the remainder of my bugs
[18:01:26] <bblum> should only be a couple hours before that's ready though
[18:01:47] <bblum> (i have them all fixed, just have to confirm and write a few test cases)
[18:02:25] <Eridius> bblum: not sure if GH will email you on this one, I commented on GH last night but, again, referenced brson instead of you (don't know why I was doing that). I just edited the comment to reference you instead
[18:02:29] <Eridius> this is on https://github.com/mozilla/rust/pull/8198
[18:03:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:03:43] <toddaaro> bblum: great
[18:04:01] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[18:04:15] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:04:35] <bblum> Eridius: thx
[18:06:08] <brson> toddaaro: after my SingleThreaded fix there's still a failure in stdtest when running it under RUST_NEWRT=1 that I haven't looked at, and there may be other lurking problems
[18:06:25] <kimundi> strcat: ping
[18:06:46] <brson> toddaaro: I need to work on the android buildbot today though so don't think I'll get make any further progress. maybe you can take another pass over the test suite looking for failures?
[18:06:57] <strcat> kimundi: pong
[18:07:48] <toddaaro> brson: sure, should I pull from your fork?
[18:07:55] <kimundi> strcat: I'm polishing Option, Result and Either a bit. On result I'm adding a ToStr constraint for the Error tdype, by I'm wondering how strong I should force that
[18:08:08] <strcat> kimundi: enforce it everywhere
[18:08:16] <brson> toddaaro: yeah take that branch, merge it into master, then modify std::unstable::lang::start to only use the new runtime and run make check
[18:08:19] <brson> thanks
[18:08:32] <toddaaro> brson: k
[18:08:37] <strcat> kimundi: well, I guess Err will still be public :(
[18:08:40] <strcat> we need private variants
[18:08:56] <kimundi> strcat: That is, should only get() require E: ToStr, and the other methods work on a non ToStr E, or should all fall usnder the ToStr constraint
[18:09:09] <strcat> kimundi: all of them should
[18:09:13] <kimundi> okay
[18:09:17] <strcat> Err itself should, but we don't have priv for variants
[18:09:19] <strcat> so you can't
[18:09:54] <strcat> hm
[18:09:56] <kimundi> how would... a private Err make sense? To bmake sure it can only be constructed with functions with type bounds?
[18:10:05] <strcat> yes
[18:10:09] *** Joins: Florob (Florob@moz-39532932.de)
[18:10:17] <kimundi> yeah, that would probably be good
[18:10:18] <strcat> kimundi: maybe don't bother with ToStr on all of them yet
[18:10:19] <brson> why should Err require ToStr? where is this going to matter?
[18:10:32] <kimundi> strcat: To late
[18:10:40] <brson> i.e. what code is parameterized over a generic error type?
[18:10:58] <strcat> brson: because if you're using Result, you should have an error type people can convert to a string
[18:11:05] <strcat> it's more about upholding the convention
[18:11:13] <kimundi> strcat: I'm basically done. Had to stuff a bunch of deriving ToStr on compiler bits to satisfy a singular `is_ok()` call, but so far it seems to work
[18:11:32] <strcat> and some methods will use it
[18:11:40] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[18:11:59] <strcat> but it'd be surprising to have those methods missing because something was not fulfilling that requirement
[18:12:02] *** Joins: erickt2 (Adium@8C9ECD8F.3A598286.F12515B4.IP)
[18:12:02] <strcat> like .get()
[18:12:04] *** Quits: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP) (Connection reset by peer)
[18:12:08] <strcat> or .unwrap()
[18:12:12] <kimundi> yeah
[18:12:17] <kimundi> he... about that
[18:12:28] <kimundi> I'm kinde... also removing unwrap here :)
[18:12:37] <strcat> that's fine, it's a mess
[18:12:42] <kimundi> (renaming it to get, that is)
[18:12:46] <strcat> Option got updated a lot more
[18:12:50] <kimundi> yeah
[18:13:05] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:13:07] <kimundi> I'm basically lifting Either and Result to Options standarts
[18:13:31] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:14:32] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:14:32] *** ChanServ sets mode: +o brson
[18:15:47] <toddaaro> brson: do we have bindings to manually call "check_events" in a nonblocking way for the UV event loop?
[18:16:28] <toddaaro> brson: idea being that the scheduler loop is "run tasks" "nonblocking event check, deal with events" repeat
[18:16:58] *** Quits: tcr_ (tcr@moz-6EBF8439.mycingular.net) (Ping timeout)
[18:17:18] *** Joins: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP)
[18:17:18] *** Quits: erickt2 (Adium@8C9ECD8F.3A598286.F12515B4.IP) (Connection reset by peer)
[18:18:01] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[18:19:51] *** Parts: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP) ()
[18:20:04] <brson> toddaaro: no, and I don't whether or not libuv has that ability. i don't quite understand the logic you're suggesting either. would the scheduler never block on the event loop?
[18:20:43] <toddaaro> brson: correct, it would never block on it if there was other stuff to do, but blocking on the event loop would be the "sleep" state for the scheduler thread
[18:21:02] <jdm> who can point me to some reference visitor implementations?
[18:21:32] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[18:21:33] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[18:21:46] <toddaaro> brson: I'll take a look at the libuv api soonish, for now I don't need that functionality, but it would be nice for round 2 on the workstealing
[18:22:02] <toddaaro> brson: round 1 should be really quick and easy to do (knocks on wood)
[18:22:03] <jdm> do you always have to start from a crate?
[18:22:18] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[18:23:06] <pcwalton> jdm: you mean syntax::visit:: ?
[18:23:11] <jdm> pcwalton: yeah, found it
[18:23:12] <jdm> thakns
[18:23:12] <pcwalton> if so I'm rearchitecting that
[18:23:17] <jdm> I see
[18:23:22] <pcwalton> to use traits
[18:23:24] *** Joins: slartoff (Mibbit@CDEB6BFF.D3A46DCA.B1AF74A1.IP)
[18:23:24] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[18:24:48] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[18:24:48] *** Quits: heftig (heftig@6573ED45.9A77AED9.3663C14F.IP) (Connection reset by peer)
[18:25:05] *** Joins: heftig (heftig@8D5076D2.6FC4DE2F.FEC4A986.IP)
[18:26:11] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[18:28:38] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[18:28:45] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[18:31:17] <strcat> rusti: foreach x in range(0, 3) { println(x.to_str()) }
[18:31:18] -rusti- 0
[18:31:18] -rusti- 1
[18:31:18] -rusti- 2
[18:31:18] -rusti- ()
[18:32:11] <strcat> rusti: let xs: std::hashmap::HashSet<int> = range(0, 3).collect(); xs.len()
[18:32:11] -rusti- 3
[18:32:24] <strcat> rusti: let xs: ~[int] = range(0, 3).collect(); xs
[18:32:25] -rusti- ~[0, 1, 2]
[18:33:07] <jdm> rusti: let o = None; o.iter().any
[18:33:08] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/PAab
[18:33:23] <jdm> rusti: let o = Some(5); o.iter().any
[18:33:24] -rusti- <anon>:5:26: 5:38 error: attempted to take value of method `any` on type `std::option::OptionIterator<,<VI0>>` (try writing an anonymous function)
[18:33:24] -rusti- <anon>:5          let o = Some(5); o.iter().any
[18:33:24] -rusti-                                    ^~~~~~~~~~~~
[18:33:24] -rusti- error: aborting due to previous error
[18:33:24] -rusti- application terminated with error code 101
[18:33:40] <jdm> rusti: let o = Some(5); o.iter().any(|i| i == 5)
[18:33:40] -rusti- <anon>:5:48: 5:49 error: mismatched types: expected `&int` but found `<VI1>` (expected &-ptr but found integral variable)
[18:33:41] -rusti- <anon>:5          let o = Some(5); o.iter().any(|i| i == 5)
[18:33:41] -rusti-                                                          ^
[18:33:41] -rusti- error: aborting due to previous error
[18:33:41] -rusti- application terminated with error code 101
[18:33:47] <jdm> rusti: let o = Some(5); o.iter().any(|&i| i == 5)
[18:33:47] -rusti- true
[18:33:57] <jdm> rusti: let o: Option<int> = None; o.iter().any(|&i| i == 5)
[18:33:58] -rusti- false
[18:34:00] *** Quits: brianm (brianm@D2D642B9.79695EE7.489C5759.IP) (Ping timeout)
[18:34:32] *** Joins: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr)
[18:34:49] <toddaaro> how do you break our of a for loop early in rust? (I guess do loop now)
[18:35:01] <strcat> 'do' isn't a loop
[18:35:14] <strcat> it's just sugar for passing a block as a closure
[18:35:16] <toddaaro> do 5.times isn't like a for i<5?
[18:35:26] <strcat> times doesn't let you break out
[18:35:34] <toddaaro> how do I do something that does?
[18:35:43] <strcat> rusti: foreach _ in range(0, 5) { break }
[18:35:44] -rusti- ()
[18:35:56] <mihneadb> rusti: range(0,3)
[18:35:57] -rusti- {state: 0, stop: 3, one: 1}
[18:35:59] <toddaaro> well, my use case is to try doing something N times, and on first success return Some(...) or return None if I run out
[18:36:06] <toddaaro> so foreach is the appropriate use?
[18:36:12] <toddaaro> or is there a better construct
[18:36:16] <kmc> we have foreach??
[18:36:19] <mihneadb> rusti: let x = range(0,3)
[18:36:19] -rusti- <anon>:6:4: 6:5 error: expected `;` but found `}`
[18:36:19] -rusti- <anon>:6     };
[18:36:19] -rusti-              ^
[18:36:19] -rusti- application terminated with error code 101
[18:36:23] <mihneadb> rusti: let x = range(0,3);
[18:36:24] <sp3d> foreach is the interim name for the new for
[18:36:24] -rusti- <anon>:5:13: 5:14 warning: unused variable: `x` [-W unused-variable (default)]
[18:36:24] -rusti- <anon>:5          let x = range(0,3);
[18:36:24] -rusti-                       ^
[18:36:24] *** concrete.mozilla.org sets mode: +M 
[18:36:24] -rusti- ()
[18:36:34] <strcat> kmc: yes we are removing 'for' and renaming foreach to for
[18:36:43] <kmc> ok
[18:36:49] <kmc> so foreach was sugar for external iterators?
[18:36:53] <Ms2ger> Yep
[18:36:55] <toddaaro> strcat: can you return a value with break?
[18:36:58] <kmc> not documented in the manual I see :)
[18:37:06] <cmr> kmc: it didn't exist until the other day
[18:37:17] <cmr> kmc: it didn't exist until the other day
[18:37:17] <kmc> toddaaro: you can use actual 'return'
[18:37:29] *** brson sets mode: -M 
[18:37:31] <toddaaro> kmc: huh, I can never keep this straight
[18:37:31] <kmc> and it will return from the enclosing function, not the loop closure
[18:37:36] <strcat> kmc: it's documented 
[18:37:39] <strcat> in the iterator tutorial
[18:37:42] <kmc> heh
[18:37:46] <strcat> for loops are no longer documented because they're obsolete
[18:37:49] <kmc> but not in the language manual
[18:37:58] <kmc> is rusti automatically kept up-to-date with Rust master?
[18:38:03] <strcat> kmc: yes
[18:38:06] <cmr> updates daily
[18:38:11] <strcat> kmc: I have a repo with daily builds for arch linux and it uses those
[18:38:13] <toddaaro> ok, so I write a helper that takes N and makes the attempts, using early return via 'return' inside the foreach?
[18:38:24] <strcat> Name           : rust-git
[18:38:25] <strcat> Version        : 0.7.1131.gbbcce8d-1
[18:38:26] <kmc> cool
[18:38:30] <miloshadzic> isn't this an error in the docs? should be best case O(n log n) https://www.dropbox.com/s/qka2dsg6ugq8w02/Screen%20Shot%202013-08-02%20at%2020.32.41.png
[18:38:51] <strcat> toddaaro: that would work, or you could use a messy mutable variable ;p
[18:39:21] <engla> strcat: about "calling convention" for foreach, due to my idea it now takes   let __iter = &mut <iterator>.. Instead the user could pass &mut explicitly:   <<foreach x in &mut it>>  if the user wants to be able to keep using the iterator after the loop.  We need to experiment and think a bit here, to find something that works with Iterable
[18:39:56] <sfackler> miloshadzic: you'd have to check the implementation. I wouldn't be surprised if it special cased mostly sorted inputs
[18:40:12] <strcat> engla: it needs to be implemented with type checking though
[18:40:18] <strcat> the current duck typing isn't going to stay
[18:40:29] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:40:41] <strcat> so Iterable can only work if it can be represented as a trait both Iterables and Iterators (&mut references to them) can implement
[18:40:48] <engla> of course
[18:40:53] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[18:41:02] <strcat> I don't think it's going to work out but I'll be happy to be surprised
[18:41:13] <strcat> I think we'll end up just not implementing foreach with desugaring
[18:42:17] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[18:42:32] <engla> You don't think Iterable will work?
[18:42:38] <strcat> I think Iterable will work
[18:42:58] <strcat> I don't think you'll be able to make a layer working on both Iterable and Iterator the way foreach needs
[18:43:22] <engla> Ok that sounds like Iterable not working
[18:43:23] <strcat> it needs an &mut reference to the iterator, but an &self reference to the Iterable to get an Iterator by-value
[18:43:37] <strcat> engla: Iterable isn't primarily to make sugar for for loops
[18:43:53] <engla> ok great then
[18:43:54] <strcat> foreach isn't necessary at all, it's sugar
[18:44:33] <strcat> the iterators still have a long way to go
[18:44:37] <strcat> need a lot more &mut self
[18:44:52] <strcat> borrowck and rvalues make things a bit too painful atm :(
[18:47:06] *** Joins: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[18:47:40] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:48:45] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[18:51:23] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[18:51:46] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[18:52:03] <strcat> why is range_rev different than range?
[18:53:09] <strcat> range is [start, stop) and range_rev is (start, stop]
[18:53:35] <engla> don't know. but for the step=1 case you can just reverse the iterator
[18:53:42] <kimundi> seems to be pretty symetric
[18:53:43] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[18:53:43] <engla> because of that
[18:54:16] <strcat> kimundi: it's not how it works in any other language, that's an indication it's not what's expected
[18:54:50] <engla> "Switch over to new range_rev semantics; fix #5270."
[18:55:09] <engla> https://github.com/mozilla/rust/issues/5270
[18:56:05] <kimundi> Is there are solution for both having [a, b) instead of [a, b] ?
[18:56:32] *** Joins: sprog (Mibbit@moz-A67DEF8F.protectedgroup.com)
[18:56:35] *** Quits: nyx (cedalion@moz-FC228802.wp.shawcable.net) (Ping timeout)
[18:56:37] <engla> seems kind of symmetric if range(0, 10).invert() is the same as range_rev(10, 0)
[18:56:43] *** Quits: sprog (Mibbit@moz-A67DEF8F.protectedgroup.com) (User has been banned from Mozilla (no spamming here))
[18:56:45] <strcat> doesn't to me
[18:56:48] <strcat> (start, stop)
[18:56:49] <kimundi> kinda need both: allowing zero iterations and covering the whole type range
[18:56:59] <strcat> why?
[18:57:02] <joelteon> guys, is there any way I can watch progress on the new networking module
[18:57:32] <kimundi> joelteon: poll #rust with "Does networking work yet" :P
[18:57:42] <joelteon> guys, does networking work yet?
[18:57:58] <strcat> they're convenience functions, you can .map(|x| x - 1)
[18:58:25] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[18:58:34] <strcat> >>> for x in range(3, 0, -1): print(x)
[18:58:36] *** Joins: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com)
[18:58:37] <strcat> 3
[18:58:39] <strcat> 2
[18:58:41] <strcat> 1
[18:58:43] <strcat> same in D
[18:58:59] <strcat> it's *always* start, stop
[18:59:15] *** Joins: brendan (brendaneic@moz-CAD05D62.public.wayport.net)
[18:59:21] <strcat> not sometimes one_before_start, one_before_stop
[18:59:45] <engla> current behavior is  always [lo, hi)
[18:59:50] <engla> (hi, lo]
[19:00:05] <strcat> except it calls that parameter start
[19:00:07] <strcat> so it's not
[19:00:13] <strcat> and it's not the order it yields them
[19:00:35] <engla> it's called hi
[19:00:41] * strcat shrugs
[19:00:56] <strcat> not what the iterator versions are going to be, doesn't make sense to me at all
[19:00:58] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[19:01:15] <strcat> what if you need to include 'hi' in the descending one? it doesn't solve a problem
[19:01:33] <strcat> it replaces one problem with another at the expense of consistency and doing what's expected based on other languages
[19:01:34] <kimundi> I see two example scenarios: 1. iterate over all byte values with a u8 range counter: [0, 255]. 2. Calculate a range of values [m, n), where n can be <= m wich implies zero iterations.
[19:01:44] <strcat> neither of them can do the first
[19:02:32] <strcat> you either get [0, 255) or (255, 0] from the existing ones
[19:03:22] <kimundi> maybe we could say range(start, stop) == [start, stop] and count(start, stop-start) == [start, stop)
[19:03:43] <strcat> I just won't include range_rev
[19:04:22] <strcat> can have range, range_step and inclusive versions of each
[19:04:55] *** Quits: ecr (Thunderbir@moz-F724119C.uoregon.edu) (Quit: ecr)
[19:04:58] <kimundi> why is range non_inclusive anyway? I remeber beeing very confuset by that at first
[19:05:02] <cmr> joelteon: it'll be mentioned on TWiR, so just watch that :)
[19:05:09] <joelteon> what's that
[19:05:16] <bblum> ugh, i hate it when it's actually *impossible* to write a test case that exposes a race condition
[19:05:20] <cmr> this week in rust
[19:05:22] <joelteon> oh
[19:05:28] <cmr> http://cmr.github.io/blog/categories/this-week-in-rust/
[19:05:30] <joelteon> man I can't wait for it to come out, I want to get this project rolling
[19:05:36] <joelteon> rust is the most fun of any language to write
[19:05:57] <cde> do we Rust to live, or do we live to Rust?
[19:06:02] <joelteon> yes
[19:06:13] <cde> yes
[19:06:32] <bblum> there are other things in my life besides rust
[19:06:36] <kimundi> We're just standing around... kinda... corroding.
[19:06:41] *** Joins: nyx (cedalion@moz-FC228802.wp.shawcable.net)
[19:06:51] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[19:07:24] <cde> letting oxygen into our lives
[19:08:02] *** Quits: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP) (Quit: lkuper)
[19:08:38] <tikue> bblum: take your FUD elsewhere!
[19:09:37] <bblum> tikue: sure, i'll take it in to the office
[19:09:46] <tikue> sounds good to me xD
[19:10:42] <joelteon> every language should be like rust
[19:10:43] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[19:10:48] <joelteon> it should be so complicated that when you get your code right you feel like a genius
[19:12:09] <cde> well Haskell does also fit this niche tightly
[19:12:12] <Florob> Few less ICEs would be nice though.
[19:12:12] <bblum> joelteon: i know people whose heads would explode just from hearing you say that even in jest :P
[19:12:23] <joelteon> yeah
[19:12:28] <joelteon> cde: I've written too much haskell for that
[19:12:33] <joelteon> but I just started with rust, so it's like magic
[19:13:04] *** Quits: thomaslee (thomaslee@moz-6C3931E3.static.twtelecom.net) (Client exited)
[19:13:35] <cmr> I had the exact opposite impression when starting with rust...
[19:13:39] <cmr> "There's no magic!"
[19:14:35] <joelteon> well no, I know it's not magic
[19:14:43] <joelteon> but it *feels* like I'm doing magic
[19:15:21] <joelteon> it's a very important distinction :P
[19:15:25] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[19:16:33] *** mihneadb is now known as mihneadb|lunch
[19:17:53] *** ozten is now known as ozten|afk
[19:20:52] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[19:20:52] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[19:23:30] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Ping timeout)
[19:25:02] *** Quits: vosvos (vosvos@moz-9B8AD3A8.vinita.lt) (Quit: Leaving)
[19:27:09] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[19:27:11] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[19:30:16] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[19:31:58] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[19:31:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Zm1pyQ
[19:31:58] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[19:32:20] <bblum> toddaaro: when i get into the office, can you explain the need for a 2nd task to 'bootstrap' schedulers?
[19:32:31] *** Quits: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr) (Client exited)
[19:34:51] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[19:34:51] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/rRSBdQ
[19:34:51] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[19:34:51] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[19:34:51] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4uQ07g
[19:34:51] <ghrust> 13rust/06auto 147c15a12 15Patrick Walton: librustc: Introduce a new visitor type based on traits and port syntax to it....
[19:34:51] <ghrust> 13rust/06auto 144c1eb8e 15bors: auto merge of #8163 : pcwalton/rust/new-visitor, r=pcwalton...
[19:34:52] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[19:36:11] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[19:36:11] *** ChanServ sets mode: +qo graydon graydon
[19:38:01] <strcat> the current range looks broken to me
[19:38:12] *** Quits: KindOne (KindOne@187DC4EC.E114B4AE.EC6A1518.IP) (Ping timeout)
[19:38:19] <strcat> http://ix.io/71p
[19:38:24] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[19:38:31] <strcat> hm
[19:38:33] <strcat> well
[19:38:37] <strcat> I guess the double-negative cancels out
[19:38:43] <strcat> strange that it doesn't just use += step for both
[19:39:15] <cde> a double negative isn't a positive, because it consumes more energy, thus increasing entropy
[19:40:51] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[19:41:48] *** Joins: stepancheg (Mibbit@moz-58AD93C5.yandex.net)
[19:42:02] *** Joins: KindOne (KindOne@187DC4EC.E114B4AE.EC6A1518.IP)
[19:43:06] *** Quits: stepancheg (Mibbit@moz-58AD93C5.yandex.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:44:20] *** Quits: brendan (brendaneic@moz-CAD05D62.public.wayport.net) (Quit: brendan)
[19:44:38] <SimonSapin> Can I run only some tests from std::str?
[19:44:45] <SimonSapin> (The ones Iâ€™m adding)
[19:44:45] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[19:45:33] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[19:46:48] <engla> sure
[19:46:51] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[19:47:17] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[19:47:23] <engla> SimonSapin: from make use TESTNAME=keyword  and it will run the tests that match
[19:47:39] <engla> from the test executable itself, pass the keyword as the only argument
[19:47:51] <SimonSapin> so TESTNAME=foo make check?
[19:47:51] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[19:48:00] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:48:27] <engla> something like   make check-stage0-std TESTNAME=str
[19:48:36] <engla> is the simplest because it would build the least
[19:49:19] *** Joins: nano (nano@moz-972880B.superkabel.de)
[19:49:47] <SimonSapin> Is uint::range gone? What replaces it?
[19:50:06] <engla> range in prelude. strcat is working on this
[19:54:02] *** Quits: chii (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:54:19] *** Quits: Ms2ger (Ms2ger@moz-BA3429A8.adsl-dyn.isp.belgacom.be) (Quit: nn)
[19:56:55] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:57:32] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[19:57:55] *** ozten|afk is now known as ozten
[19:58:00] *** mihneadb|lunch is now known as mihneadb
[19:59:08] *** Quits: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net) (Ping timeout)
[19:59:21] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[20:00:48] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[20:01:10] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Quit: WeeChat 0.4.1)
[20:01:12] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:02:29] *** Joins: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net)
[20:02:35] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[20:03:15] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:04:50] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:07:01] *** Joins: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu)
[20:07:39] *** Quits: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu) (Quit: leaving)
[20:07:54] *** Joins: Sergio965 (sergiobz@7BC29AAF.C3A89135.3A99D594.IP)
[20:08:02] <Sergio965> Is the copy keyword gone for 0.8?
[20:08:14] *** Joins: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu)
[20:08:36] <cmr> rusti: let x = copy 5;
[20:08:36] -rusti- <anon>:5:22: 5:23 error: expected `;` but found `5`
[20:08:36] -rusti- <anon>:5          let x = copy 5;
[20:08:36] -rusti-                                ^
[20:08:36] -rusti- application terminated with error code 101
[20:08:37] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[20:08:49] <cmr> rusti: let copy = 4;
[20:08:50] -rusti- <anon>:5:13: 5:17 warning: unused variable: `copy` [-W unused-variable (default)]
[20:08:50] -rusti- <anon>:5          let copy = 4;
[20:08:50] -rusti-                       ^~~~
[20:08:50] -rusti- ()
[20:08:57] <cmr> strcat: did you fix that?
[20:09:07] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:09:11] <Sergio965> rusti: let x = 5.clone();
[20:09:12] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/TGYM
[20:09:38] <Sergio965> rusti: let x: int = 5.clone();
[20:09:39] <SimonSapin> Iâ€™m getting "error: unresolved name `range`" even though I have "use iterator::range;"
[20:09:39] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/eEMi
[20:10:14] <Sergio965> rusti: let x: int = 5.clone() as int;
[20:10:15] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/KRDe
[20:10:20] <Sergio965> :\
[20:10:24] *** Joins: brianm (brianm@D2D642B9.79695EE7.489C5759.IP)
[20:10:52] *** Quits: Deewiant (deewiant@moz-C015B7F8.iki.fi) (Ping timeout)
[20:11:03] <SimonSapin> â€¦ but only in tests
[20:11:40] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[20:11:55] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:11:55] <strcat> cmr: yes
[20:12:41] <cmr> rusti: let x = 5i.clone()
[20:12:41] -rusti- <anon>:6:4: 6:5 error: expected `;` but found `}`
[20:12:42] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[20:12:42] -rusti- <anon>:6     };
[20:12:42] -rusti-              ^
[20:12:42] -rusti- application terminated with error code 101
[20:12:45] <cmr> rusti: let x = 5i.clone(); x
[20:12:45] -rusti- 5
[20:12:49] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[20:12:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:13:05] <Sergio965> Why doesn't let x: int = 5.clone(); work? Shouldn't it infer the type?
[20:13:12] <cmr> rusti: let x: int = 5.clone();
[20:13:13] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/LTKJ
[20:13:17] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:13:33] <cmr> dunno, makes me wonder what the signature of Clone is though
[20:13:35] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[20:13:41] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[20:13:44] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:13:45] <cmr> Should work I think
[20:13:55] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Max SendQ exceeded)
[20:14:12] <pcwalton> Sergio965: cmr: it's because 5 could be int, uint, i8, u8, ...
[20:14:17] <pcwalton> try 5i.clone()
[20:14:22] <Sergio965> No it couldn't.
[20:14:35] <Sergio965> let x: int = 5, how could 5 be anything but int?
[20:14:36] <cmr> pcwalton: it's constrained by the type of `x`, or should be, I think
[20:14:56] <pcwalton> Sergio965: the type inference engine currently isn't that smart when it comes to method lookup
[20:14:58] *** Quits: brianm (brianm@D2D642B9.79695EE7.489C5759.IP) (Quit: Linkinus - http://linkinus.com)
[20:14:59] <strcat> I think we should remove the fallback to int when there are no hints altogether
[20:15:07] <pcwalton> mmm, I'm nervous about that
[20:15:09] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[20:15:12] <pcwalton> for i in range(0, 5) { ... }
[20:15:16] <pcwalton> super convenient
[20:15:19] <strcat> that's an int though, you probably want uint
[20:15:34] <Sergio965> pcwalton: Doesn't it do it for generics? IE, when I use transmute, doing let x: (uint, uint) = transmute(bla) as (uint, uint)?
[20:15:46] <pcwalton> Sergio965: it does, but when you use '.' it's not as smart as it could be
[20:15:47] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Connection reset by peer)
[20:15:50] <strcat> pcwalton: range(0i, 5) isn't much more inconvenient
[20:15:58] <pcwalton> mmm, I think it is
[20:15:58] <strcat> and you might have a hint inside the loop
[20:16:03] <pcwalton> yes, that is true
[20:16:04] <Sergio965> Sounds inconsistent.
[20:16:07] <pcwalton> it's worth experimenting with I guess
[20:16:08] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[20:16:17] <pcwalton> Sergio965: it is, but '.' method lookup is kind of magic in rust
[20:16:22] <pcwalton> we could potentially make it smarter
[20:16:27] <strcat> pcwalton: I just don't really like 'int' being the default
[20:16:34] *** Joins: brianm (brianm@D2D642B9.79695EE7.489C5759.IP)
[20:16:35] <pcwalton> '.' needs to search in the method set for the type
[20:16:40] <strcat> since imo you usually want uint or a big integer in most applications
[20:16:47] <pcwalton> so it has to know what type it has on the left hand side
[20:16:50] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[20:16:50] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144c1eb8e to 14f1c1f92: 02http://git.io/N3iJvQ
[20:16:50] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[20:16:53] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[20:16:53] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/VZvBBg
[20:16:53] <ghrust> 13rust/06auto 14076468f 15Huon Wilson: std: use ptr.offset where possible in the vec iterator....
[20:16:53] <ghrust> 13rust/06auto 1429000c0 15Huon Wilson: std: add benchmark for vec.mut_iter.
[20:16:53] <ghrust> 13rust/06auto 14a461776 15bors: auto merge of #8225 : huonw/rust/vec-iter, r=graydon...
[20:16:55] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[20:16:56] <Sergio965> pcwalton: And why doesn't it?
[20:17:03] <Sergio965> The information is there.
[20:17:04] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[20:17:17] <Sergio965> Is there a reason, or is it just not implemented?
[20:17:27] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Max SendQ exceeded)
[20:17:28] <pcwalton> I think it could end up really complicating typechecking in the general case
[20:17:37] <pcwalton> it could perhaps be done but I haven't thought about it :)
[20:17:44] <pcwalton> the information would have to flow backwards
[20:17:49] <pcwalton> let x: int = 5.clone()
[20:18:02] <Sergio965> Backwards?
[20:18:10] <Sergio965> If anything, let x: int = 5.clone() as int; should work.
[20:18:27] <cmr> Sergio965: no it shouldn't
[20:18:31] <cmr> then it is completely unconstrainted
[20:18:31] <Sergio965> Why?
[20:18:33] <pcwalton> information has to flow from x to the method lookup to constrain the set of namespaces to only those namespaces that have a method named "clone"
[20:18:36] <cmr> 5.clone() could return any numeric
[20:18:38] <pcwalton> that returns the type of x
[20:18:41] <cmr> because they can all be cast to int
[20:18:45] <pcwalton> that could be done in theory.
[20:18:52] <pcwalton> however it'd be pretty complex
[20:18:56] <Sergio965> cmr: This is how transmute associates its types.
[20:18:59] <pcwalton> so *this* should work:
[20:19:04] <pcwalton> let x: int = Clone::clone(5);
[20:19:13] <pcwalton> then it's clear *which* method is being invoked
[20:19:21] <pcwalton> however we don't have uniform method call syntax yet
[20:19:28] <strcat> rusti: let x: int = 5.clone(); x
[20:19:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QBgG
[20:19:31] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[20:19:38] <pcwalton> the problem is not the type of "clone", the Rust typechecker can infer that
[20:19:39] <pcwalton> th
[20:19:49] <pcwalton> the problem is that Rust doesn't know that there isn't *some other* method called "clone" that you wanted to call
[20:19:57] <pcwalton> unless it knows what's on the left hand side of the '.'
[20:20:02] <strcat> ah
[20:20:09] <strcat> that makes sense
[20:20:17] <strcat> so it shouldn't work
[20:20:31] <pcwalton> it could technically be made to work with a very customized method lookup
[20:20:36] <Sergio965> If I do let x: 5, what type does x get?
[20:20:41] <pcwalton> but '.' is scary enough already :)
[20:20:45] <Sergio965> er, let x = 5.
[20:20:52] <strcat> Sergio965: currently falls back to `int' but I think it's wrong to do that
[20:21:00] <pcwalton> Sergio965: depends on how x is used later
[20:21:06] <pcwalton> in the absence of hints, it defaults to int
[20:21:10] <strcat> 5 being int is totally okay if it wasn't also able to become all the other types
[20:21:14] <strcat> but... atm
[20:21:37] <strcat> let x = 5; foo(x); for i in range(0, x) {}
[20:21:42] <strcat> now lets say foo takes uint
[20:21:47] <strcat> so you're getting a range of uint
[20:22:03] <strcat> now at some point foo becomes unnecessary, and is removed - now you have a range of int
[20:22:26] <joelteon> so the new way to split strings is str.split_iter
[20:22:28] <strcat> I'm sure I accidentally caused that in some places with my conversion from uint::range to range but I tried not to
[20:22:39] <joelteon> is there an easy way yet to convert a StrSplitIterator to an owned vector, or do I have to use vec build
[20:22:52] <cmr> joelteon: .to_owned_vec()
[20:23:01] <cmr> (or .collect(), which that is sugar for)
[20:23:01] <Sergio965> rusti: let x = (5 as int).clone(); x
[20:23:02] -rusti- 5
[20:23:14] <strcat> rusti: 5i.clone()
[20:23:15] -rusti- 5
[20:23:18] <joelteon> oh that's MUCH easier
[20:23:25] <Sergio965> Hmm.
[20:23:27] <strcat> 5i is an int, 5u is a uint, 5 is generic
[20:23:35] <Sergio965> rusti: let x = 5; let y = x.clone(); y
[20:23:36] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/cBdQ
[20:23:42] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[20:23:57] <Sergio965> rusti: let x: int = 5; let y = x.clone(); y
[20:23:58] -rusti- 5
[20:24:11] <strcat> I think it's working as intended
[20:24:14] <strcat> the fallback is just confusing.
[20:24:16] <cmr> For https://github.com/cmr/rust-bench/blob/wip/worker/worker.rs I get `worker.rs:28:8: 28:24 error: failed to find an implementation of trait std::io::Writer for std::rt::io::mem::MemWriter
[20:24:25] <pcwalton> we could improve the error message
[20:24:26] <tikue> rusti: let x = 5i; let y = x.clone(); y
[20:24:27] -rusti- 5
[20:24:29] <pcwalton> to suggest what should be done
[20:24:30] <cmr> Yet, in https://github.com/cmr/rust-bench/blob/wip/task-distributor/distributor.rs, I don't.
[20:24:36] <cmr> (for read_u8)
[20:24:45] <strcat> pcwalton: well, if let x = 5; alone was always an error we wouldn't need to ;p
[20:24:48] <pcwalton> i.e. if you have an unconstrained type and that type is an integer suggest adding a sigil
[20:24:53] <cmr> I don't really want to use std::io at all, how can I avoid it?
[20:25:07] <brson> graydon: how do i make ssh-agent transport the buildbot key to scl3 so I can use it to log in to the ec2 bots?
[20:25:21] <brson> just ssh-adding it locally seemed to accomplish nothing
[20:25:26] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:25:45] <graydon> ssh -A
[20:25:52] <graydon> (forward agent)
[20:26:11] *** Joins: vladimir-lu (vladimir-l@moz-428433D9.cable.virginmedia.com)
[20:26:15] <brson> oh, nice. thanks
[20:26:29] *** Quits: MiguelD (kvirc@2ACDA535.A137FB69.46937063.IP) (Quit: KVIrc 4.1.3 Equilibrium http://www.kvirc.net/)
[20:26:48] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[20:27:52] <Sergio965> Is there some kind of debug mode flag for the compiler?
[20:27:57] *** Quits: bobbyrward (bobbyrward@moz-9EFC9C1E.midsouth.biz.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[20:28:02] <strcat> rusti: struct Foo { f: extern fn() }
[20:28:02] -rusti- ()
[20:28:05] <Sergio965> I'm getting an LLVM eror.
[20:28:07] <Sergio965> error*
[20:28:08] <cmr> Sergio965: -Z debug-info and -Z extra-debug-info
[20:28:11] <cmr> Oh, no
[20:28:15] <cmr> RUST_LOG=rustc=4 though
[20:28:19] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[20:28:30] *** Quits: vladimir-lu (vladimir-l@moz-428433D9.cable.virginmedia.com) (Quit: WeeChat 0.4.0)
[20:28:57] *** Joins: vladimir-lu (vladimir-l@moz-428433D9.cable.virginmedia.com)
[20:28:58] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:30:32] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[20:31:49] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[20:32:09] <strcat> rusti: struct Foo { f: extern fn() } fn bar() {} Foo { f: bar }
[20:32:09] -rusti- {f: }
[20:32:19] <strcat> rusti: struct Foo { f: extern fn() } fn bar() {} let x = Foo { f: bar } (x.f)()
[20:32:19] -rusti- <anon>:6:4: 6:5 error: expected `;` but found `}`
[20:32:20] -rusti- <anon>:6     };
[20:32:20] -rusti-              ^
[20:32:20] -rusti- application terminated with error code 101
[20:32:22] <strcat> rusti: struct Foo { f: extern fn() } fn bar() {} let x = Foo { f: bar }; (x.f)()
[20:32:23] -rusti- ()
[20:33:01] <tikue> strcat: why is extern keyword needed for this kind of thing
[20:33:11] <strcat> it's not needed, you could use &fn
[20:33:14] <olsonjeffery> error: type `condition::Trap<,rt::io::IoError,()>` does not implement any method in scope named `in`
[20:33:19] <tikue> strcat: wouldn't that require a lifetime
[20:33:21] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:33:23] <strcat> tikue: yes
[20:33:26] <tikue> strcat: I mean needed to move a fn into a struct
[20:33:27] <olsonjeffery> looking at other examples using this.. it looks  like i have everything pulled in...
[20:33:28] <strcat> extern means it has no env
[20:33:30] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[20:33:49] <strcat> tikue: because fn() is used for closures, extern fn() is used for functions without an environment
[20:33:49] <olsonjeffery> so kind of headscratcher
[20:34:07] <tikue> strcat: ok, thanks. why extern though? what does that convey
[20:34:42] <strcat> C functions are extern "C" fn
[20:34:50] <strcat> rust functions are extern "Rust" fn
[20:34:54] <strcat> it doesn't really convey anything
[20:34:58] <strcat> it's just the keyword reused for this
[20:35:09] <tikue> rusti: struct Foo { f: fn() } let x = Foo { f: || 1, }; (x.f)()
[20:35:10] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/XQch
[20:35:28] <tikue> strcat: fn() doesn't work to move a closure into a struct like that?
[20:35:37] <strcat> no, closures aren't usable that way
[20:35:39] <strcat> they have a dynamic size
[20:35:44] <tikue> ah
[20:35:57] <tikue> oh because they capture
[20:36:07] <cmr> Use ~fn or @fn ?
[20:36:11] *** Parts: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) ()
[20:36:15] <strcat> in C++ they're usable that way
[20:36:19] <strcat> because it gives each closure a unique type
[20:36:27] <strcat> so if you templated the struct it would let you do that
[20:36:31] <tikue> rusti: struct Foo<'self> { f: &'self fn() } let x = Foo { f: || 1, }; (x.f)()
[20:36:32] -rusti- <anon>:5:66: 5:67 error: mismatched types: expected `()` but found `<VI0>` (expected () but found integral variable)
[20:36:32] -rusti- <anon>:5          struct Foo<'self> { f: &'self fn() } let x = Foo { f: || 1, }; (x.f)()
[20:36:32] -rusti-                                                                            ^
[20:36:32] -rusti- error: aborting due to previous error
[20:36:34] -rusti- application terminated with error code 101
[20:36:39] *** Quits: bnicholson|pto (bnicholson@moz-3492C575.rcmdva.fios.verizon.net) (Ping timeout)
[20:37:02] <brson> olsonjeffery: `in` appears to be called `inside` now
[20:37:12] <cmr> rusti: struct Foo<'self> { f: &'self fn() -> int } let x = Foo { f: || 1, }; (x.f)()
[20:37:12] -rusti- 1
[20:38:04] <tikue> thx cmr
[20:38:06] <tikue> silly mistake
[20:38:33] <joelteon> how do I iterate over a ~[]
[20:38:50] <strcat> joelteon: iter()
[20:38:51] <olsonjeffery> brson: hm..curious wonder why the tests in rt::io::net::tcp aren't choking then..
[20:38:52] <strcat> joelteon: http://static.rust-lang.org/doc/tutorial-container.html#iterators
[20:38:53] <joelteon> or, rather, where's the definition of each? I can't find it
[20:38:57] <strcat> joelteon: there isn't one
[20:39:01] <cmr> joelteon: each doesn't exist anymore
[20:39:01] <joelteon> oh ok
[20:39:05] <joelteon> hmm
[20:39:11] <tikue> joelteon: let xs = ~[1, 2, 3]; foreach x in xs.iter() { printfln!("%d", *x); }
[20:39:11] <joelteon> oh, that makes sense
[20:39:13] <strcat> the iterator tutorial explains it all
[20:39:17] <tikue> rusti: let xs = ~[1, 2, 3]; foreach x in xs.iter() { printfln!("%d", *x); }
[20:39:18] -rusti- 1
[20:39:18] -rusti- 2
[20:39:18] -rusti- 3
[20:39:18] -rusti- ()
[20:39:27] <strcat> the doc bot didn't feel like updating it yet though
[20:39:30] <strcat> don't really know why
[20:39:33] <strcat> maybe s3 just lags
[20:39:43] <strcat> I did update them all to foreach...
[20:40:00] <strcat> at least I think I did ;p
[20:40:41] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[20:41:18] <brson> olsonjeffery: I guess we're on different branches. I see .inside everywhere
[20:41:32] <olsonjeffery> brson: i used inside and it worked
[20:41:44] <strcat> 'in' became a keyword
[20:41:59] <olsonjeffery> brson: ah! emacs revert-buffer strikes again
[20:42:05] <olsonjeffery> :/
[20:42:15] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[20:42:23] <SimonSapin> r? https://github.com/mozilla/rust/pull/8231
[20:42:24] <olsonjeffery> should add a hook to auto-revert whenever switching into a buffer w/ no pending changes
[20:42:42] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[20:42:46] <strcat> SimonSapin: I don't think we should have those
[20:42:50] <strcat> str isn't ascii, Ascii is
[20:43:08] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:43:13] *** Joins: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr)
[20:43:17] <kmc> these are operations on Unicode strings though
[20:43:19] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[20:43:37] <strcat> but they aren't operations that make sense on Unicode strings
[20:43:37] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:43:39] <SimonSapin> strcat: Servo needs ASCII case-insensitive matching on UTF-8 strings: http://dev.w3.org/csswg/css-syntax/#ascii-case-insensitive
[20:43:42] <kmc> mapping ASCII letters to upper/lower case and keeping all other letters the same
[20:43:49] <kmc> all other characters even
[20:44:00] <kmc> I think it does make sense; some protocols are specified this way (including CSS)
[20:44:15] *** Joins: fanix (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net)
[20:44:18] <strcat> you can convert str to an ascii reference as a no-op
[20:44:24] <SimonSapin> it may not be what you usually want for user data, but it is well-defined
[20:44:28] <kmc> strcat: not if it has non-ASCII characters
[20:44:31] <Sergio965> Where do the debug! statements go?
[20:44:39] <cmr> Sergio965: what do you mean?
[20:44:39] <Sergio965> How do I view their output, I suppose.
[20:44:40] <kmc> I think these methods are fine as long as the name makes it clear that it's not attempting Unicode case folding (which is fiendishly complex and requires external information, anyway)
[20:44:45] <cmr> Sergio965: RUST_LOG
[20:44:47] <SimonSapin> strcat: the ascii module rejects non-ASCII data
[20:44:54] <n0v> http://rs.deadlytowers.org/projects/outland/read <-- I'm trying to avoid using more than std, but I feel like there's got to be a better way of writing this. Actually, I possibly botched all three I have up at the moment. If anyone cares to take a look, it'd be appreciated. 
[20:44:55] <kmc> Sergio965: run your program with RUST_LOG=::help
[20:44:56] <strcat> to_ascii_lower_ignores_locale
[20:44:58] <strcat> ;\
[20:45:07] <kmc> Sergio965: that will print the modules/crates for which you can enable debugging output
[20:45:07] <SimonSapin> strcat: yes, by design
[20:45:11] <strcat> SimonSapin: not by design
[20:45:17] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[20:45:20] <SimonSapin> strcat: yes it is
[20:45:22] <strcat> locales still affect mapping ascii chars between case
[20:45:26] <strcat> turkish.
[20:45:26] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[20:45:40] <brson> to_ascii_lower does seem pretty specialized for this use case
[20:45:49] <SimonSapin> by design, CSSâ€™s case insensitivity of non-author-defined keywords does not depend on the locale
[20:45:59] <cmr> SimonSapin: Rust strings aren't CSS strings
[20:46:00] <brson> are there other places besides css that require this?
[20:46:25] <SimonSapin> http://encoding.spec.whatwg.org/
[20:46:31] <SimonSapin> HTML as well
[20:46:37] <fanix> I know it may seem crazy and maybe I misinformed but this thing, would it be possible to create something that transforms C + + code to Rust? Like Emscripten ...
[20:46:41] <Sergio965> So I'd do RUST_LOG=rustc::middle::trans::build ?
[20:46:46] <joelteon> is there a vec method that returns an owned head and tail in a tuple?
[20:46:47] <cmr> We should be using ICU for all of these sorts of things
[20:46:49] <cmr> fanix: not usefully.
[20:46:52] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:46:52] *** ChanServ sets mode: +o tjc
[20:47:03] <cmr> Sergio965: RUST_LOG=...=4
[20:47:14] *** Joins: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com)
[20:47:20] <strcat> SimonSapin: CSS is guaranteed to be UTF-8?
[20:47:24] <fanix> why not? It could create a OpenGl version for rust
[20:47:36] <Sergio965> cmr: Great. Thanks!
[20:47:38] <cmr> We already have opengl bindings
[20:47:39] <SimonSapin> strcat: internally, Servo uses UTF-8 strings
[20:47:50] <cmr> And because converting a low level language to a higher level language doesn't usefully work
[20:47:53] <strcat> SimonSapin: but what if the CSS is another encoding?
[20:47:56] <cmr> emscripten generates unusable javascript
[20:48:02] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[20:48:36] <SimonSapin> strcat: bytes we get from the network are first decoded into text per http://encoding.spec.whatwg.org/
[20:48:43] <fanix> Sure you are right, it was just a doubt
[20:48:45] <cmr> C++ doesn't map onto Rust very well, especially when you have templates
[20:48:52] *** Quits: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP) (Ping timeout)
[20:48:52] <cmr> Plus, we have rust-bindgen for just headers
[20:49:01] <SimonSapin> CSSÂ specifies how to pick an encoding (BOM, @charset, etc.)
[20:49:31] <SimonSapin> Servo uses Rustâ€™s str type for text, after decoding from bytes
[20:49:46] <joelteon> what am I doing wrong here? https://gist.github.com/joelteon/6143351
[20:49:53] <doomlord> i think you could convert some subset between both languages, a bit more than c bit no where near all of either
[20:49:57] <joelteon> I don't understand the error message
[20:50:10] <vladimir-lu> was there any decision on the 'in' for placement new etc?
[20:50:10] <Sergio965> The LLVM build fails building the following call: rust: ~"Call(Fn=*fn(*{i32, *tydesc, *i8, *i8, i8}, *{}, i32) -> *{i32, *tydesc, *i8, *i8, {i32, i32, [i8 x 0]}}, Args=~[~\"*{i32, *tydesc, *i8, *i8, i8}\", ~\"*i8\", ~\"i32\"])"
[20:50:17] <Sergio965> Does anyone see something wrong with that?
[20:50:22] <tjc> joelteon: change x to ref x
[20:50:26] <strcat> Sergio965: "Issued".lower() in a turkish locale does something different than an english locale
[20:50:27] <tjc> in the pattern, I mean
[20:50:30] <strcat> SimonSapin: *
[20:50:44] <SimonSapin> cmr: there is no such thing as CSS strings as a data structure. Servo is using Rust strings internally to implement CSS
[20:51:08] *** Quits: fanix (Mibbit@moz-11F9F15.red-83-37-58.dynamicip.rima-tde.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:51:11] <joelteon> tjc: doesn't that make (x,ys) type (&~str,&[~str])?
[20:51:30] <joelteon> is it not possible for me to take over ownership of the elements of that vector?
[20:51:53] <joelteon> or do I just add on a to_owned() call
[20:51:58] <SimonSapin> strcat: depending on the flavor of case folding you pick, yes. CSS specifies explicitly not to do this for CSS-defined keywords
[20:52:31] <tjc> joelteon: oh, hmm, good point.
[20:52:32] <strcat> SimonSapin: yes but rust strings are defined by the unicode standard, so it doesn't make sense to have things not following that
[20:52:43] <joelteon> I can own those items if I call to_owned on both of them
[20:52:51] <tjc> joelteon: the error message is saying "you can't move v[0] into x because the pattern x,..ys owns it"
[20:52:53] <SimonSapin> strcat: we can also have Unicode case folding
[20:52:54] <joelteon> I feel like I'm doing to_owned a lot, though. is that an antipattern?
[20:52:56] <tjc> joelteon: you can call to_owned, but that makes a copy
[20:53:03] <joelteon> yeah, smells like antipattern.
[20:53:16] <joelteon> hmm, so a pattern owns my strings.
[20:53:19] <tjc> nmatsakis: is this expected behavior for moving-out in a vector pattern? https://gist.github.com/joelteon/6143351
[20:53:31] <SimonSapin> strcat: ASCII-only case folding is well-defined on Unicode strings, even if itâ€™s often not what you want
[20:53:53] <doomlord> fanix i'm making something to generate c++ bindings, i'm trying to get some limited use of templates in collection classes passed across , i.e. views of c++ datastructures with vectors etc, but i can heavily rework my own c++ code for the limitations of my own bindings
[20:53:56] <joelteon> I feel like that should be possible, I just want to "eat" the vector
[20:54:00] <strcat> SimonSapin: but it's incorrect under some locales
[20:54:02] <doomlord> oh he quit
[20:54:17] <joelteon> if I had a linked list of char* in C, I would set x and ys to the first and the pointer to the list tail, and that's similar to what I want to do here
[20:54:21] <tjc> joelteon: I'm wondering if it's a borrow checker bug, but nmatsakis  would know for sure
[20:54:24] <joelteon> ok
[20:54:53] <SimonSapin> strcat: In CSS, we want MARGIN to be a valid property but not MARÄ°N, even in turkish locales
[20:54:53] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[20:55:02] <Sergio965> What is the "*{}" type?
[20:55:09] <SimonSapin> we certainly donâ€™t want web pages to render differently based on the userâ€™s locale
[20:55:13] <cmr> Sergio965: in LLVM? void pointer, kinda
[20:55:20] <SimonSapin> I mean, CSS to be interpreted differently
[20:55:22] <Sergio965> Yeah, in LLVM.
[20:55:27] <Sergio965> Void pointer, kind of?
[20:55:32] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[20:55:34] <strcat> SimonSapin: but why does an implementation detail in CSS need to be part of rust's str?
[20:55:46] <SimonSapin> strcat: "incorrect" really depends on what youâ€™re doing
[20:55:55] *** huseby is now known as husebyLUNCH
[20:55:55] <strcat> it's incorrect for the semantics implemented by str
[20:56:13] <SimonSapin> thatâ€™s why "ascii" is in the name
[20:56:19] <cmr> I don't think it's incorrect, it's just extremely limited useful
[20:56:33] <cmr> SimonSapin: You could add extension methods to str in servo
[20:56:35] <strcat> I don't think the str module should provide things not implementing unicode semantics
[20:56:39] <SimonSapin> strcat: it helps to have it in libstd because CSS, HTML, Encodings and other things all use it
[20:57:02] *** Joins: MiguelD (MiguelD@2ACDA535.A137FB69.46937063.IP)
[20:57:07] <SimonSapin> In Servo, different libraries all depend on it
[20:57:18] <SimonSapin> I could have a 20 lines library that they all depend on, but thatâ€™s silly
[20:57:22] <strcat> we don't need to make mistakes in web standards included in str though
[20:57:32] <olsonjeffery> so im on ubuntu x64.. and sometimes i want to re-run a test suite w/o rebuild (and there're no changes)
[20:57:37] <olsonjeffery> but it seems like the makefile is configured to just skip it..
[20:57:41] <engla> does str have a .mut_iter()? you could implement your own char -> char transformation there
[20:57:42] <olsonjeffery> is there a flag to force rerunning the test suite w/o rebuilding everything?
[20:57:48] <strcat> they shouldn't be doing something "case-insensitive" but only for ascii code points
[20:57:51] <SimonSapin> this is not a mistake, it has been discussed to death already
[20:58:03] <strcat> so why do they not just require the proper case?
[20:58:06] <strcat> it's anglo-centrism
[20:58:10] <strcat> doesn't belong in the standard lib imo
[20:58:41] <SimonSapin> it was a mistake to make CSSÂ case-insensitive, but we canâ€™t change that now
[20:58:43] <cmr> (and it's feature bloat. we have extension methods for a reason)
[20:58:50] <strcat> yeah but we can avoid including a mistake in CSS in str
[20:59:15] * engla realizes there is no way to provide mut_iter for str.
[20:59:22] <strcat> if there's a method there, someone is going to use it
[20:59:28] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:59:28] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[20:59:33] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[20:59:37] <olsonjeffery> i guess i should just run the testsuite bin, heh.
[20:59:55] <pcwalton> I think ASCII is fine
[20:59:57] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Ping timeout)
[21:00:03] <engla> traits make it possible to provide your own extension methods to str
[21:00:04] <vladimir-lu> cmr: did i miss something - we have extension methods?
[21:00:11] <vladimir-lu> cmr: ah ok, traits
[21:00:14] <pcwalton> we already have it in str, no?
[21:00:19] *** Quits: gazoombo (uid6629@moz-E77DEB21.irccloud.com) (Ping timeout)
[21:00:21] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[21:00:29] <cmr> We already have an Ascii, but it's separate from str
[21:00:32] <strcat> pcwalton: they were removed
[21:00:51] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[21:00:56] <Sergio965> It seems like the Rust compiler is incorrectly passing build parameters to LLVM. The function's parameters are: *fn(*{i32, *tydesc, *i8, *i8, i8}, *{}, i32), while the arguments are: *{i32, *tydesc, *i8, *i8, i8}, *i8, i32].
[21:01:01] *** Quits: Crnobog (uid1041@moz-E77DEB21.irccloud.com) (Ping timeout)
[21:01:10] <joelteon> meh
[21:01:11] *** Joins: Crnobog (uid1041@moz-E77DEB21.irccloud.com)
[21:01:14] *** Joins: ghaering (Mibbit@moz-A5AD043D.adsl.alicedsl.de)
[21:01:22] <kmc> strcat: do you really think it's a *mistake* that CSS does keyword case folding this way?
[21:01:24] <joelteon> what's the syntax for functions that take functions as arguments
[21:01:27] <strcat> kmc: yes, absolutely.
[21:01:39] <Sergio965> joelteon: fn x(a: &fn(..)) ...
[21:01:40] <kmc> joelteon: fn(x: fn(int) -> float)
[21:01:47] <kmc> er yeah &fn or ~fn
[21:01:49] <kmc> strcat: elaborate?
[21:01:52] <SimonSapin> strcat: itâ€™s the best CSS can do without breaking the web
[21:01:53] <pcwalton> hmm
[21:02:09] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:02:09] <strcat> SimonSapin: okay, so a css module can add an extension method to str for the hack it needs
[21:02:28] <bblum> hell yes, replacing all the old open coded destructors with use of 'finally' gives me a -2N +N diffstat
[21:02:29] <strcat> kmc: it doesn't make sense to implement case-insensitivity in any structured language
[21:02:44] <jdm> Sergio965: build parameters?
[21:02:49] <strcat> case-insensitivity varies per locale and it doesn't offer anything of value
[21:02:49] <Sergio965> --lib
[21:02:55] <kmc> yeah... I mean sometimes I wonder why people keep inventing new concrete syntax for things
[21:02:58] <kmc> ;)
[21:03:17] <SimonSapin> strcat: I agree CSS would have been better off case-sensitive, but it is 20 years too late now
[21:03:19] <pcwalton> how about we discuss this in the meeting
[21:03:20] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[21:03:26] <Sergio965> jdm: I mean, when it calls llvm::LLVMBuildCall.
[21:03:29] <pupoque> hi
[21:03:37] <Sergio965> jdm: In trans::build.
[21:03:38] <strcat> SimonSapin: I'm not saying you can't implement it... just that it doesn't belong on str
[21:03:45] <Sergio965> pupoque: hi.
[21:03:55] <strcat> str is supposed to provide operations that make sense for applications handling unicode correctly
[21:04:01] <strcat> it should guide you to implement a correct application
[21:04:02] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[21:04:03] <pupoque> are there global variables that can be used outside main() and other functions? like in C
[21:04:13] <cmr> pupoque: `static mut`, requires unsafe code
[21:04:21] <kmc> if you don't need them to vary then it's not unsafe
[21:04:25] <pcwalton> maybe we need a "libweb" :)
[21:04:26] <strcat> SimonSapin: does CSS allow interior NULs?
[21:04:30] <strcat> str does
[21:04:30] <kmc> pupoque: http://static.rust-lang.org/doc/rust.html#static-items
[21:04:38] <SimonSapin> strcat: would it be better with a longer and more scary-looking name?
[21:04:39] <pcwalton> this is going to come up again and again
[21:04:39] *** Quits: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com) (Ping timeout)
[21:04:44] <pcwalton> with URL parsing for example.
[21:04:47] <kmc> strcat: yeah, you are probably right re: guiding to correct implementations, and I've made that argument before in similar contexts
[21:04:49] <strcat> SimonSapin: I don't think it's an operation we should provide in the stdlib
[21:04:58] <SimonSapin> strcat: the CSS parser replaces any U+0000 with U+FFFD
[21:05:02] <strcat> it makes sense to implement to handle css/html, but not in str in general
[21:05:03] <pcwalton> bz has warned us that what the Web needs != what the spec says
[21:05:05] <pcwalton> regarding URLs
[21:05:14] <pupoque> kmc: thanks
[21:05:17] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:06:08] <SimonSapin> pcwalton: http://url.spec.whatwg.org/ attempts do document what the web needs for URLs
[21:06:39] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:06:49] <strcat> for the same reason I don't think we should have methods existing only to do an operation *and* a copy
[21:06:51] <engla> I'm looking at is_utf8 again, just to make it a bit faster (my previous change does a bit too much work). I don't intend to change what it accepts, but we have a bug saying we should deny surrogate chars
[21:07:06] <strcat> yes, many times you need to do .filter(...).to_owned_vec()
[21:07:23] <strcat> but making the lazy version more convenient than the one copying an entire vector is bad
[21:07:25] <strcat> er
[21:07:29] <strcat> more inconvenient*
[21:07:36] <engla> so, should we deny surrogate chars in ~str?  Python allows them in utf-8
[21:08:11] <kmc> they're not chars really
[21:08:14] <strcat> engla: any idea what Go does there?
[21:08:24] <cmr> THe utf-8 spec has been updated to deny surrogate chars hasn't it?
[21:08:26] <kmc> or code points even
[21:08:41] <engla> nope
[21:08:42] <mcpherrin> What does surrogates in utf-8 mean? Aren't they a UTF-16 encoding thing?
[21:08:45] <kmc> The official Unicode standard says that all UTF forms, including UTF-16, cannot encode these code points."
[21:08:56] <kmc> mcpherrin: yes but the corresponding code points in UCS/Unicode are reserved
[21:09:04] <engla> mcpherrin: right, but they have codepoints
[21:09:24] *** Quits: DasIch (dasich@moz-5EDA591.de) (Ping timeout)
[21:09:28] <mcpherrin> Oh, I see what you mean.
[21:09:37] <engla> it's easy to exclude this range in the change I'm doing so
[21:09:40] <toddaaro> rusti: let mut rng = rand::rng(); rng.gen()
[21:09:41] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/fcYd
[21:09:52] <strcat> engla: ideally we'd enforce the same things on all 'char'
[21:10:01] <kmc> see also https://en.wikipedia.org/wiki/CESU-8
[21:10:05] *** Joins: bnicholson (bnicholson@moz-835D504A.rcmdva.fios.verizon.net)
[21:10:10] <strcat> you should be able to take a char as a parameter and push it to str
[21:10:14] <engla> that's more difficult I guess
[21:10:17] <kmc> this is "take the broken thing Java and MySQL do and claim it as a standard retroactively"
[21:10:18] <toddaaro> rusti: use rand::{Rand}; let mut rng = rand::rng(); rng.gen()
[21:10:18] <strcat> and be guaranteed that it won't fail
[21:10:18] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/Uegb
[21:10:25] <engla> I mean str.rs is just library functions
[21:10:37] <strcat> engla: yeah fixing char and bool is harder
[21:10:43] <toddaaro> rusti: use std::rand::Rand; let mut rng = rand::rng(); rng.gen()
[21:10:44] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/PSgi
[21:11:23] <kmc> GHC also allows surrogate codepoints in Char :(
[21:11:39] <toddaaro> ok I give up on rusti, is the documentation for rand in rustdoc accurate? I got a "type `rand::IsaacRng` does not implement any method in scope named `gen_int_range` error
[21:11:52] <strcat> kmc: haskell is old, though
[21:12:04] <strcat> it doesn't follow best practices in prelude
[21:12:04] <ion> IIRC allowing surrogate codepoints in Char can cause the Helvetica scenario.
[21:12:07] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[21:12:20] <kmc> :D
[21:12:24] <kmc> strcat: yeah
[21:12:46] <cmr> rusti: use std::rand::RngUtil;  let mut rng = std::rand::rng(); rng.gen::<bool>()
[21:12:47] -rusti- true
[21:12:48] <kmc> I am definitely against allowing them in char; the only problem is whether this can be done efficiently
[21:12:54] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[21:13:07] <cmr> Correctness is more important than efficiency.
[21:13:08] <engla> kmc: surrogate halves? no problem
[21:13:14] <toddaaro> use std::rand::RngUtil;  let mut rng = std::rand::rng(); rng.gen_int_range(0,3)
[21:13:20] <strcat> kmc: well it doesn't necessarily need to be very efficient to turn an arbitrary uint into a char
[21:13:32] <toddaaro> rusti: use std::rand::RngUtil;  let mut rng = std::rand::rng(); rng.gen_int_range(0,3)
[21:13:33] <tikue> strcat: I completely agree with you about making the convenient version non-copying and lazy. however, are you arguing there shouldn't be, e.g., .filter_vec?
[21:13:33] -rusti- 1
[21:13:36] <kmc> cmr: qualitative statements like that are useless, you need to look at the degree of incorrectness vs the degree of inefficiency
[21:13:37] <strcat> the operations you need to be efficient are encoding char to utf-8 and decoding utf-8 to char
[21:13:38] <tikue> strcat: or even filterv?
[21:13:41] <strcat> and checking if [u8] is utf-8
[21:13:48] <strcat> tikue: definitely no
[21:13:48] <kmc> sometimes it is worth being a little wrong to be way fast
[21:13:50] <strcat> ~[] isn't special
[21:13:55] <strcat> there are going to be other kinds of vectors
[21:14:04] <strcat> we *do not* want to make one easier to use, instead of having people to choose the right one
[21:14:18] <tikue> strcat: fair enough. I know there are a lot of people who don't feel that way though
[21:14:19] <strcat> do you want a small vector? do you want a rope? or do you want a plain old dynamically array?
[21:14:23] <strcat> convenience shouldn't play a part
[21:14:32] <strcat> in fact, I'd bet that most of the time you want a small vector
[21:14:41] <strcat> certainly LLVM's codebase uses more small vectors that vectors
[21:14:42] <engla> strcat: I'm proposing to use unchecked indexing in is_utf8 since all accesses are range checked by the loop. Using iterators is hard since we skip 1-4 bytes each time
[21:14:42] <tikue> strcat: what is a small vector?
[21:14:46] <kmc> otherwise I might as well argue int should be a bignum (well, I have argued that the Haskell Prelude should have only bignums, but Haskell and Rust are different beasts :)
[21:14:52] <cmr> kmc: I disagree wholeheartedly. If str and char aren't really unicode, I don't care how fast they are.
[21:15:02] <strcat> tikue: a vector storing a fixed N amount in-place before it switches to making a heap allocation
[21:15:03] *** Quits: lmandel (lmandel@3E0B9D77.C1F57925.ADB88A9.IP) (Ping timeout)
[21:15:05] <strcat> because most strings are small
[21:15:05] <toddaaro> cmr: ah thanks, missing RngUtil was my issue
[21:15:16] <strcat> and most vectors are small
[21:15:17] <tikue> strcat: how do you construct a small vector?
[21:15:24] <strcat> tikue: rust doesn't have it as a type yet
[21:15:25] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[21:15:30] <strcat> partly because [] is so special-cased...
[21:15:34] <tikue> strcat: ah ok. is it planning on getting one?
[21:15:37] <strcat> yes
[21:15:44] <strcat> and it should be as convenient as []
[21:16:10] <strcat> ropes aren't common so that doesn't really matter
[21:16:38] <Sergio965> Is there some documentation on how the fmt! macro works?
[21:16:45] <cmr> Sergio965: nope
[21:16:51] <strcat> it's going to be removed
[21:16:55] <kmc> cmr: do you feel this way just about allowing codepoints corresponding to surrogates, or about allowing any unassigned codepoints?
[21:16:58] <Sergio965> Why's that?
[21:17:07] <strcat> because it's incredibly slow and not trait-based
[21:17:13] <Sergio965> I see.
[21:17:19] <Sergio965> Is there an alternative to it?
[21:17:24] <strcat> not yet
[21:17:25] *** Parts: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Leaving)
[21:17:35] <Sergio965> Is there a way to have variadic functions without using macros?
[21:17:38] <cmr> kmc: Unassigned codepoints probably shouldn't be allowed either
[21:17:40] <kmc> cmr: I think that in practice, forbidding surrogates is not a vital correctness property, given that it would be a runtime check anyway
[21:17:42] <cmr> Sergio965: take a vector :)
[21:17:51] <Sergio965> That's not a variadic function.
[21:17:51] <tikue> strcat: any idea what the syntax might look like for small vec?
[21:18:02] *** Joins: lmandel (lmandel@3E0B9D77.C1F57925.ADB88A9.IP)
[21:18:08] <strcat> Sergio965: rust doesn't have variadic functions, you have to use a vector
[21:18:09] <cmr> It's the only way to fake it type-safely, without some serious magic.
[21:18:28] <Sergio965> How did fmt! do it?
[21:18:34] <strcat> tikue: the same as vectors
[21:18:35] <kmc> it's a pretty extreme position to take that char is totally unacceptable and "not really unicode" just because it allows certain codepoints that, for the time being, the Unicode committee has not assigned
[21:18:47] <strcat> yeah we shouldn't do that
[21:18:54] <strcat> it needs to be forwards compatible
[21:18:55] *** Quits: eholk (eholk@moz-B0798A8B.uconnect.utah.edu) (Ping timeout)
[21:19:09] <tikue> strcat: so only different under the hood? or would you declare it as a different type?
[21:19:11] <cmr> I did say probably
[21:19:12] <Florob> surrogates are a different beast though. They are assigned
[21:19:18] <strcat> tikue: different type
[21:19:29] <cmr> but I'm sick of dealing with half-assed unicode
[21:19:30] <strcat> SVec<int> or whatever
[21:19:31] <tikue> i see
[21:19:36] <kmc> cmr: me too, I sympathize here
[21:19:44] <tikue> yuck :)
[21:19:46] <kmc> I spend a lot of time ranting about halfassed unicode
[21:19:57] <tikue> no one will want to use it if they have to write that every time heh
[21:20:18] <kmc> Florob: my understanding is that the codepoints are deliberately left unassigned, and they can't be represented in UTF-16 because those UTF-16 code units are used for surrogates
[21:20:29] <kmc> "code unit" meaning a 16-bit quantity specifically in the context of UTF-16
[21:20:38] *** Joins: io2 (io2@moz-537A0266.home.otenet.gr)
[21:20:40] <kmc> but I haven't read the specs recently
[21:20:54] *** Quits: robertknight (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com) (Ping timeout)
[21:20:55] <tikue> / let mut five_xs = [0, ..5]; let mut few_xs: SVec<int> = [0, ..5]; 
[21:20:55] <strcat> tikue: so they're not going to use any containers but the built-in vectors?
[21:20:56] <tikue> like that?
[21:21:08] <strcat> no it would be converted from ~[]
[21:21:11] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[21:21:12] <strcat> they aren't fixed-size
[21:21:21] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[21:21:27] <strcat> although you'd want it to infer the type of ~[]
[21:21:38] <strcat> to avoid a copy for small ones
[21:21:58] <tikue> ok
[21:22:04] *** Joins: Earnestly (earnest@CAE8D902.48DC5685.39C00A7A.IP)
[21:22:06] <strcat> small vectors would be an easy way of making rustc 50% faster
[21:22:14] <strcat> they're LLVM's secret sauce
[21:22:25] <Florob> kmc, They are assigned in the UnicodeTable.txt, specifically as surrogates. They can't be expressed in UTF-16, because UTF-16 is sort of the reason they exist. They are used to encode a codepoint in conjunction with the following code unit. (Or that is my understanding)
[21:22:35] <pcwalton> they lead to a lot of code bloat
[21:22:45] <pcwalton> a couple years ago every rust vector was a smallvector
[21:22:58] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[21:22:59] <pcwalton> ripping them out made rustc way faster
[21:23:21] * tikue sees completely contradicting statements
[21:24:02] <pcwalton> I'm skeptical of how much faster all the SmallVectors really make for LLVM
[21:24:09] <pcwalton> all the branches on "push" to the slow paths
[21:24:20] <strcat> pcwalton: the slow path won't be inlined
[21:24:37] <pcwalton> of course not but it still complicates register allocation and whatnot
[21:24:42] <strcat> it should be about the same size for the fast-path
[21:24:48] <pcwalton> you have to spill all the registers across the fast path and whatnot
[21:24:58] <pcwalton> you can try but I bet it won't make much of a difference
[21:25:07] <pcwalton> and I will eat my hat if it's 50% :)
[21:25:08] <cmr> Isn't there a no_prelude attribute?
[21:25:08] <strcat> pcwalton: there's already a fill == alloc branch
[21:25:15] <pcwalton> malloc is nowhere near 50%
[21:25:22] <cmr> Oh, no_implicit_prelude
[21:25:22] <pcwalton> malloc/free
[21:25:31] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[21:25:38] <pcwalton> besides, over 50% of rustc is LLVM passes
[21:25:49] <strcat> pcwalton: true, with optimization on
[21:25:51] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[21:25:51] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a461776 to 14f1c1f92: 02http://git.io/N3iJvQ
[21:25:51] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[21:25:52] <strcat> but we can fix that
[21:25:53] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[21:25:53] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/7dy5fw
[21:25:53] <ghrust> 13rust/06auto 14b9295b7 15Tim Chevalier: rustpkg: Eliminate a copy
[21:25:53] <ghrust> 13rust/06auto 14728c470 15Tim Chevalier: Makefiles: make rustpkgtest depend on rustpkg executable
[21:25:53] <ghrust> 13rust/06auto 1402af532 15Tim Chevalier: compiletest: Remove "remove me after snapshot" code
[21:25:54] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[21:26:02] <strcat> it's a *lot* better than it used to be already
[21:26:05] <pcwalton> yes
[21:26:06] <joelteon> I don't understand this "cannot borrow immutable dereference of & pointer as mutable"; I'm passing a ~str to a function that expects a ~str
[21:26:21] <tikue> joelteon: code?
[21:26:25] <pcwalton> currently rustc is really slow for me due to swapping :(
[21:26:30] <pcwalton> we need to drop the AST
[21:26:31] <joelteon> oh wait, no, it's my fault
[21:26:35] <cmr> pcwalton: how much memory do you have O_o
[21:26:40] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[21:26:43] <joelteon> I defined the method as read(&mut self) but self needs to be immutable
[21:26:48] <pcwalton> 4G
[21:26:52] <joelteon> or I need to figure out a different way to do this :D
[21:27:01] <tjc>  I have 16G and rustc is still slow for me :P
[21:27:10] <tjc> I don't think it's swapping -- no pageouts show up in `top`
[21:27:11] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:27:11] <tikue> tjc: same lol
[21:27:14] <strcat> aw the vector iterator fix bounced
[21:27:15] <kmc> same here
[21:27:23] <pcwalton> rustc is not *that* slow anymore
[21:27:23] <strcat> wonder if it was actually broken
[21:27:25] <strcat> it timed out
[21:27:38] <kmc> /usr/bin/time -v will also tell you about swaps
[21:27:45] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:27:55] <pcwalton> really, for how much code it compiles it's not terrible anymore
[21:28:08] <strcat> it's reasonable but we can make it way better
[21:28:16] <pcwalton> yes agreed
[21:28:28] * pcwalton just wants people to stop bashing the poor compiler :)
[21:28:31] <cde> can we define minimal subsets of rust for embedded systems?
[21:28:39] <pcwalton> cde: sure
[21:28:39] <kmc> cde: look at zero.rs
[21:28:42] <cmr> cde: don't need to
[21:28:43] <ion> Letâ€™s compile the poor bash instead.
[21:28:47] <toddaaro> rusti: use std::vec::map; [1,2,3].map(|n| n+1)
[21:28:48] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/gKdI
[21:28:56] <cmr> Can already be expressed with lang items
[21:29:00] <cde> cmr: embedded systems don't have 16G of memory ;)
[21:29:02] <joelteon> why does the read method require that self is mutable?
[21:29:14] <pcwalton> joelteon: in memory buffers
[21:29:20] <pcwalton> need to adjust the offset pointer
[21:29:24] <strcat> toddaaro: the map method on vectors is deprecated btw, it's going to be replaced by an iterable one
[21:29:25] <joelteon> oh, I see
[21:29:28] <pcwalton> I'm going to bring up turning off LLVM asserts at the Tuesday meeting
[21:29:36] <cmr> cde: so don't write code that requires 16G of memory!
[21:29:36] <joelteon> so what I need to do is make this function actually return a mutable object
[21:29:39] <kmc> cde: you don't need 16G to run a Rust program, just to compile Rust programs
[21:29:44] <joelteon> but ~mut Damn is not valid
[21:29:46] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[21:29:46] <kmc> (you don't really need that either, but eh)
[21:29:48] *** Joins: eholk (eholk@moz-B0798A8B.uconnect.utah.edu)
[21:29:52] *** Quits: acrichto (acrichto@moz-69F2E428.ugrad.cs.cmu.edu) (Quit: leaving)
[21:30:15] <kmc> hooray for cross compilers
[21:30:26] <strcat> well, you need 60MiB of memory to compile a rust program
[21:30:30] <toddaaro> strcat: iterable?
[21:30:31] <kmc> joelteon: did you pastebin the code?
[21:30:32] <strcat> to compile librustc you need 1.5GiB of memory
[21:30:37] <strcat> because it's huge
[21:30:38] <cde> kmc: one goal is to be fully self-hosting, that is the system must be able to recompile itself
[21:30:38] <joelteon> kmc: no, sorry, I'm thinking out loud
[21:30:42] <cmr> joelteon: all ~T are mutable, you don't need ~mut
[21:30:44] <joelteon> if I get stuck again I'll pastebin it
[21:30:55] <kmc> cde: when is that a design constraint for embedded systems, though?
[21:30:55] <joelteon> oh, they are?
[21:30:58] <joelteon> ok, cool
[21:31:11] <kmc> people writing C code to run on watches and washing machines typically don't require that the C compiler can run on your watch
[21:31:11] <strcat> cde: g++ uses more memory than an embedded system has to compile itself
[21:31:11] <cde> kmc: I'm designing Skynet.
[21:31:15] <kmc> haha
[21:31:17] <strcat> cde: it's not something rust can solve
[21:31:25] <cde> oh
[21:31:27] <pcwalton>  70 files changed, 4346 insertions(+), 3209 deletions(-)
[21:31:37] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[21:31:55] <kmc> (though if your watch is more powerful than a PDP-7 it should in principle be able to run a C compiler ;)
[21:32:04] <strcat> pcwalton: the range() thing was another tiny little speedup
[21:32:16] <strcat> not very significant. and there was a lot of noise from try builds so it's hard to see exactly
[21:32:29] <strcat> silly bots
[21:32:47] <strcat> 30s maybe ;p
[21:33:01] <toddaaro> strcat: what do I look at to see an example of the preffered map style?
[21:33:16] <strcat> toddaaro: the preferred style doesn't really exist yet due to compiler bugs
[21:33:18] <strcat> it would be...
[21:33:35] <toddaaro> strcat: ok, a style that works then, I'm not super picky
[21:33:43] <cmr> https://gist.github.com/cmr/466939861851c665b9b2 Why is it trying to find an implementation of std::io::Writer? The write_u8 method should be provided in std::rt::io::extensions
[21:33:44] <strcat> toddaaro: .iter().transform()
[21:33:49] <bblum> brson: https://github.com/mozilla/rust/pull/8234 makes all sync and arc tests pass, with THREADS=1 and without
[21:34:12] <strcat> will become just .map()
[21:34:12] <toddaaro> strcat: which thing in std::vec:: has those two?
[21:34:20] <pcwalton> brson: https://github.com/mozilla/rust/pull/8235
[21:34:21] <brson> bblum: sweet
[21:34:46] <strcat> rusti: let xs = [1, 2, 3]; foreach x in xs.iter().transform(|x| *x * 2) { printfln!("%?", x) }
[21:34:47] -rusti- 2
[21:34:47] -rusti- 4
[21:34:47] -rusti- 6
[21:34:47] -rusti- ()
[21:35:12] <strcat> toddaaro: the trait you mean?
[21:35:18] <toddaaro> strcat: yea
[21:35:24] <strcat> iter comes from ImmutableVector
[21:35:31] <strcat> transform comes from std::iterator::IteratorUtil
[21:35:38] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[21:35:43] <strcat> also...
[21:35:52] <strcat> eventually iter will come from std::iterator::Iterable
[21:36:01] <strcat> and map will be a default method
[21:36:07] <toddaaro> strcat: does MutableVector have an equivilant? or do the Immutable versions just work on mutables
[21:36:16] <strcat> toddaaro: it works on mutable things
[21:36:25] <strcat> ImmutableVector is really &[T]
[21:36:28] <strcat> so ~[] will coerce to it
[21:36:35] <toddaaro> ah cool
[21:36:40] <strcat> there's a mut_iter on &mut [T] for actually mutating one
[21:36:57] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[21:36:58] <strcat> rusti: let mut xs = [1, 2, 3, 4]; foreach x in xs.mut_iter() { *x += 1 } xs
[21:36:58] -rusti- [2, 3, 4, 5]
[21:37:05] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:37:07] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:37:21] <strcat> rusti: let xs = [1, 2, 3]; foreach x in xs.iter().skip(1).transform(|x| *x * 2) { printfln!("%?", x) }
[21:37:21] -rusti- 4
[21:37:21] -rusti- 6
[21:37:22] -rusti- ()
[21:37:59] <toddaaro> strcat: ok, thanks, think I'm set now
[21:37:59] *** Joins: mark_edward (quassel@moz-9631ECE3.public.wayport.net)
[21:38:04] <tikue> rusti: let xs = [1, 2, 3, 4]; foreach x in xs.consume_iter() { println("why doesn't this work?"); }
[21:38:04] -rusti- <anon>:5:45: 5:64 error: type `[<VI3>, .. 4]` does not implement any method in scope named `consume_iter`
[21:38:04] -rusti- <anon>:5          let xs = [1, 2, 3, 4]; foreach x in xs.consume_iter() { println("why doesn't this work?"); }
[21:38:05] -rusti-                                                       ^~~~~~~~~~~~~~~~~~~
[21:38:05] -rusti- error: aborting due to previous error
[21:38:05] -rusti- application terminated with error code 101
[21:38:12] <joelteon> ok, here's a good summary of my problem
[21:38:14] <strcat> tikue: only ~[] can be consumed
[21:38:14] <joelteon> https://gist.github.com/joelteon/6143351
[21:38:22] <strcat> tikue: [] is fixed-size, so you can't rip off pieces
[21:38:28] <tikue> strcat: oh duh
[21:38:38] <tikue> thcx
[21:38:39] <tikue> thx
[21:38:45] *** Quits: Sergio965 (sergiobz@7BC29AAF.C3A89135.3A99D594.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[21:38:57] <strcat> although if it depended on the drop flag existing, it could swap in init() (but it shouldn't)
[21:39:29] <goffrie_> strcat: if we could somehow have generics over lengths of vectors, would it then be possible to have consume_iter for []?
[21:39:48] <strcat> goffrie_: not without depending on an implementation detail that's hopefully going to change
[21:39:57] <brson> what's the correct way to expand ~ at the command line? I have a script that doesn't work if I pass an unexpanded ~/foo
[21:40:04] *** goffrie_ is now known as goffrie
[21:40:09] <joelteon> even if I make MagicBox hold a ~TcpStream instead, it can't borrow an immutable dereference of a ~ pointer as mutable
[21:40:10] <sp3d> brson: I think only shells expand it
[21:40:19] <joelteon> I thought ~ were mutable anyway?
[21:40:42] <tikue> joelteon: you can have an immutable variable pointing to a ~[]
[21:40:49] <strcat> joelteon: objects inherit mutability from their owner
[21:41:01] <tikue> rusti: let xs = ~[1, 2, 3]; xs = ~[4, 5, 6]; // error
[21:41:02] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/DTNe
[21:41:04] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:41:14] <joelteon> hmmmm
[21:41:21] <joelteon> what's the immutable owner here
[21:41:26] <bblum> brson: it's a bash builtin to expand; use $HOME otherwise if you can
[21:41:28] <tikue> rusti: let xs = ~[1, 2, 3]; xs.push(4); // no error
[21:41:29] -rusti- <anon>:5:30: 5:32 error: cannot borrow immutable local variable as mutable
[21:41:29] -rusti- <anon>:5          let xs = ~[1, 2, 3]; xs.push(4); // no error
[21:41:29] -rusti-                                        ^~
[21:41:29] -rusti- error: aborting due to previous error
[21:41:29] -rusti- application terminated with error code 101
[21:41:32] <tikue> haha oh
[21:41:32] <joelteon> box?
[21:41:33] <tikue> :P
[21:41:35] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:41:39] <bblum> and by bash i mean any shell
[21:41:43] <joelteon> it looks like box is immutable and b is mutable
[21:41:51] <joelteon> but why would that matter? b is the object I'm accessing
[21:42:12] <brson> bblum: thanks. $HOME works there
[21:42:16] <strcat> both b and box are immutable
[21:42:26] <joelteon> is b immutable because box is immutable?
[21:42:38] <strcat> joelteon: it's immutable because bindings are immutable by default
[21:42:55] <strcat> let mut b = b;
[21:43:09] <strcat> you're moving out of box though
[21:43:09] <kmc> brson: readlink -f
[21:43:11] <joelteon> huh...okay.
[21:43:26] <kmc> though I'm not sure that's supported on OS X
[21:43:27] <joelteon> that's a bit weird
[21:43:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:43:38] <kmc> anyway it's really the shell expanding it, but the canonicalization is good anyway
[21:43:44] <joelteon> can I ensure that b is mutable inside the pattern match, or not?
[21:43:45] <brson> I have accidentally created a directory called ~ in my home directory. last time this happened I ended up deleting my home directory my typing `rm ~`
[21:43:49] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:43:50] <brson> going to need to strategize about this
[21:43:54] <kmc> yikes
[21:43:57] <goffrie> brson: rm ./~
[21:43:57] <strcat> brson: tab completion
[21:43:59] <strcat> ;p
[21:44:06] <kmc> if you use rmdir it will fail if nonempty, no?
[21:44:10] <strcat> brson: it's also fun to make a file called '----' and need rm -- ----
[21:44:14] <kmc> yep
[21:44:16] <goffrie> oh yeah, directory, use rmdir
[21:44:22] <strcat> tab completion will save you
[21:44:30] <strcat> although bash doesn't do menu complete
[21:44:40] <goffrie> strcat: rm ./---- works :P
[21:44:49] <strcat> goffrie: true
[21:45:00] <strcat> but you can have things like *, ^, ~
[21:45:11] <goffrie> yeah, tab completion all the way there
[21:45:16] <goffrie> especially weird unicode characters
[21:45:38] <tikue> eatkinson: --->
[21:45:39] <tikue> rusti: fn foo(v: [int, ..5]) {}
[21:45:40] -rusti- <anon>:5:16: 5:17 warning: unused variable: `v` [-W unused-variable (default)]
[21:45:40] -rusti- <anon>:5          fn foo(v: [int, ..5]) {}
[21:45:41] -rusti-                          ^
[21:45:41] -rusti- ()
[21:46:09] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[21:46:21] <eatkinson> bblum: http://quotes.burntelectrons.org/
[21:46:24] <tikue> rusti: fn foo(v: [int, ..5]) { printfln!("the last int is %d", v[4]); } foo([0, 1, 2, 3, 4]);
[21:46:24] -rusti- the last int is 4
[21:46:25] -rusti- ()
[21:46:38] *** Joins: brendan (brendaneic@moz-CAD05D62.public.wayport.net)
[21:47:00] <strcat> although by doing that you're copying a 40-byte vector
[21:47:24] <tikue> oh that's no good
[21:47:25] <strcat> 40 bytes isn't really that big I guess. probably not past the point where pointers get faster
[21:47:26] <tikue> why would it copy
[21:47:32] <strcat> tikue: because you're passing by-value
[21:47:35] <tikue> right :(
[21:47:40] <strcat> [int, ..5] is a value
[21:47:43] <tikue> yea
[21:47:58] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[21:48:00] <strcat> you could pass &[int, ..5] but you'd probably just want &[int] to work on any vec
[21:48:05] <strcat> unless it *really* needed to be fixed-size
[21:48:44] <tikue> strcat: what if it was [~int, ..5]
[21:48:52] <strcat> still 40 bytes
[21:48:53] <eschweic> rusti: fn foo(v: &[int])Â {}
[21:48:54] -rusti- <anon>:5:26: 5:26 error: unknown start of token: 160
[21:48:54] -rusti- <anon>:5          fn foo(v: &[int])Â {}
[21:48:54] -rusti-                                    ^
[21:48:54] -rusti- application terminated with error code 101
[21:48:56] <strcat> now with indirection for the integers
[21:49:00] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[21:49:01] <tikue> strcat: can't it not copy that though
[21:49:02] <strcat> int and ~T are the same size
[21:49:10] <strcat> tikue: it will move it, moving is a shallow copy
[21:49:15] <strcat> by-value is *always* a shallow-copy
[21:49:18] <tikue> ah
[21:49:54] <tikue> rusti: fn foo(v: &[int]) {}
[21:49:55] -rusti- <anon>:5:16: 5:17 warning: unused variable: `v` [-W unused-variable (default)]
[21:49:55] -rusti- <anon>:5          fn foo(v: &[int]) {}
[21:49:57] -rusti-                          ^
[21:49:59] -rusti- ()
[21:50:09] <bblum> pcwalton: this bug may interest you? https://github.com/mozilla/rust/issues/8233
[21:50:15] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:50:21] <pcwalton> blech
[21:50:21] <pcwalton> ok
[21:50:27] <eschweic> tikue: wat
[21:50:32] <eschweic> why did yours compile?
[21:50:34] <tikue> eschweic: you had a unicode character somewhere in yours
[21:50:40] <tikue> eschweic: accidentally
[21:50:41] <eschweic> hahaha whops
[21:50:45] <cmr> bblum: that's a dupe..
[21:51:08] <bblum> cmr: is that so
[21:51:18] <bblum> please close it then :)
[21:51:44] * strcat is unsure how to write an efficient, generic range_step iterator
[21:51:52] <strcat> due to the overflow conditions it needs to check for
[21:52:55] *** Quits: brendan (brendaneic@moz-CAD05D62.public.wayport.net) (Quit: brendan)
[21:53:53] <cmr> RT people: is the `buf` of MemWriter/MemReader to be considered an implementation detail or is accessing it to get a &[u8] acceptible?
[21:54:03] *** Joins: azita (Azita@C828EC68.8E67A50A.508D426F.IP)
[21:54:36] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[21:55:33] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:55:36] *** Joins: Ralith (ralith@moz-DEBA35B4.wireless.sfu.ca)
[21:55:55] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:55:55] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146e190b0 to 14f1c1f92: 02http://git.io/N3iJvQ
[21:55:55] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:55:58] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[21:55:58] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/UVSXJQ
[21:55:58] <ghrust> 13rust/06auto 14be7738b 15Ben Blum: Add SendDeferred trait and use it to fix #8214.
[21:55:58] <ghrust> 13rust/06auto 14cde6ad3 15Ben Blum: Fix nasty double-free bug where a newrt chan could get killed after rescheduling but before suppressing_finalize.
[21:55:58] <ghrust> 13rust/06auto 14d30cca4 15Ben Blum: Fix embarrassing bug where 'unkillable' would unwind improperly when it receives a kill signal.
[21:56:00] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[21:56:14] <bblum> my embarrassment lies bare for all to see
[21:57:04] <engla> cmr: there is a decorator trait for that
[21:57:11] <engla> cmr: inner_ref right?
[21:57:23] <cmr> engla: Oh, I see now
[21:57:29] <cmr> Yeah
[21:57:36] <engla> I still don't know the answer to your question, but it's there
[21:57:58] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[21:58:02] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:59:27] *** Quits: Ralith (ralith@moz-DEBA35B4.wireless.sfu.ca) (Ping timeout)
[22:00:13] <cmr> Is there an operation that's the inverse of IterBytes? is this the purpose of encodable/decodable?
[22:00:15] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[22:00:25] <strcat> cmr: IterBytes is only for hashing, it should be renamed
[22:00:27] <joelteon> tjc: hang on--so is it possible to decompose an owned vector of owned objects into an owned object and an owned tail without copying everything, or no?
[22:00:53] <tjc> joelteon: I think it should be possible, but nmatsakis is the expert on the borrow checker. he may be AFK, though
[22:01:08] <joelteon> ok, cool, thanks
[22:01:24] *** Quits: ghaering (Mibbit@moz-A5AD043D.adsl.alicedsl.de) (Quit: http://www.mibbit.com ajax IRC Client)
[22:01:38] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[22:01:46] <toddaaro> rusti: ~[1,2,3].clone()
[22:01:48] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RGKb
[22:01:54] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[22:01:55] *** husebyLUNCH is now known as huseby
[22:01:59] <strcat> we need overflow checked functions
[22:02:05] <strcat> hrm
[22:02:26] <toddaaro> rusti: let x = ~[1,2,3]; x.clone()
[22:02:27] -rusti- ~[1, 2, 3]
[22:02:31] <strcat> foo.add_check(&bar) -> Option<T>
[22:02:34] <strcat> something like that..
[22:02:52] <strcat> and I guess for bigints they'd just be a wrapper and get inlined
[22:03:36] <nmatsakis> tjc: joelteon: going to bed right now, but I think that is not possible except via calling vec.pop() or what have you, the vec patterns always borrow atm
[22:03:44] <nmatsakis> ttyl
[22:03:46] <joelteon> ok
[22:03:53] <joelteon> should I put in a feature request or something?
[22:04:01] <olsonjeffery> hm. is there any way to get any kind of stack trace out of a rsied condition... ?
[22:04:16] <tjc> joelteon: it seems like a reasonable feature request, yeah. worth discussing, anyway. https://github.com/mozilla/rust/issues
[22:04:20] <olsonjeffery> i have some code that is barfing with an handled condition.. but im pretty sure im handling it.. not sure where to begin
[22:04:24] <tjc> olsonjeffery: in gdb, sure!
[22:04:27] <olsonjeffery> with an unhandled condition, even
[22:04:28] <sp3d> joelteon: there's vec::mut_split which might be able to do something like what you want
[22:04:28] *** Quits: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr) (Ping timeout)
[22:04:32] <strcat> olsonjeffery:  RUST_LOG=rustc=1,::rt::backtrace
[22:04:33] <olsonjeffery> tjc.. what should i break on?
[22:04:37] <strcat> olsonjeffery: er, that's for rustc ;p
[22:04:38] <sp3d> but if you /need/ owned... yeah
[22:04:43] <tjc> olsonjeffery: I think just upcall_fail, like usual?
[22:04:44] <strcat> olsonjeffery: but substitute your crate name there
[22:05:30] <cmr> How does one use extra::serialize? What is its purpose, when should it be used?
[22:05:48] * strcat prefers cerealize, much tastier
[22:06:04] <engla> I think Json uses it
[22:06:27] <toddaaro> strcat: (or anyone else) know what is up with this error? I'm trying to grab a cloneable thing inside an array and clone it, but it doesn't figure out the types: pastebin.mozilla.com/2767819
[22:06:38] *** Quits: mark_edward (quassel@moz-9631ECE3.public.wayport.net) (Ping timeout)
[22:06:48] <toddaaro> oh nevermind
[22:06:53] <toddaaro> I missed a missing ~
[22:07:14] *** Joins: mark_edward (quassel@moz-9631ECE3.public.wayport.net)
[22:07:15] <olsonjeffery> wow. gdb output is a lot more useful than i remember it being
[22:07:18] <toddaaro> but it would be cool if it looked up the type variables in the error message for this
[22:07:40] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[22:07:56] <strcat> olsonjeffery: bt full will even tell you the variables on the stack with debugging symbols on ;p
[22:08:07] <joelteon> I don't NEED owned, but it seems wasteful to copy strings that are only ever used in one place
[22:08:51] <strcat> joelteon: you can't split ~str into two ~str, if that's what you mean
[22:08:58] <joelteon> no, I know that
[22:09:09] <joelteon> but if I have a vector of ~str I don't want to copy the first one to use it elsewhere
[22:09:17] <joelteon> if I'm *only* using it in one place
[22:09:19] <strcat> you can pop it off
[22:09:22] <joelteon> yeah
[22:09:24] <joelteon> that's what I'm doing now
[22:09:33] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:10:06] <olsonjeffery> brson: so. i don't think we can use conditions in aio...
[22:10:28] <olsonjeffery> because the condition is likely raised in a different taskcontext than where it'd likely be handled...
[22:10:34] <olsonjeffery> or is there a way.. ?
[22:11:07] *** Joins: Deewiant (deewiant@moz-C015B7F8.iki.fi)
[22:12:27] <brson> olsonjeffery: do you have some code that shows the problem?
[22:12:37] <cmr> tjc: ping
[22:12:44] <tjc> cmr: pong
[22:12:44] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:12:51] <cmr> tjc: Two rustpkg items:
[22:13:11] <cmr> 1. Running 'rustpkg build' on https://github.com/cmr/rustdoc_ng tries to build the tests, which aren't meant for rustc consumption. Why?
[22:13:24] <tjc> cmr: hmm, let me take a look
[22:13:45] <strcat> iterator.rs:1545:11: 1545:16 error: mismatched types: expected `extern "Rust" fn(&A, &A) -> bool` but found `extern "Rust" fn(&A, &A) -> bool` (expected concrete lifetime, but found bound lifetime parameter &)
[22:13:47] <strcat> iterator.rs:1545 #[deriving(Clone, DeepClone)]
[22:13:49] <strcat> that's somewhat annoying
[22:13:56] <strcat> makes sense though
[22:14:09] * strcat tries forcing them to be the same region
[22:14:22] <tjc> cmr: I'll download it and try it, give me a few minutes
[22:14:33] <tjc> that surprises me, though, since I haven't implemented any actual test-running functionality in rustpkg yet
[22:14:35] <joelteon> is there a method on a vector of owned objects that provides an iterator on owned objects?
[22:14:52] <joelteon> i.e. I want to consume some vector and move all its contents somewhere
[22:14:57] <tjc> joelteon: yep, consume_iter
[22:14:58] <cmr> 2. There seems to be a bug where rustpkg ignores the #[link(name="foo")], both when building executables (for example, on rustdoc_ng it emits a "main" executable rather than "rustdoc_ng"), and installing (for rust-zmq, it tries to find librust_zmq-etc.so, even though it's built as libzmq)
[22:15:11] <tjc> cmr: (2) I believe, let me make a note to file an issue on that
[22:15:18] <olsonjeffery> brson: i think i can work around it
[22:15:21] <tjc> well, not that I don't believe you in re: (1), it's just more surprising :-)
[22:15:23] <cmr> I can file an issue
[22:15:25] <tjc> k
[22:15:25] <joelteon> tjc: awesome, thank you
[22:15:32] <tjc> joelteon: you're welcome
[22:15:38] <cmr> I just didn't want to open an issue about stuff that's known, fix in progress, etc
[22:15:40] <joelteon> you guys are the best
[22:15:48] <tjc> I know about it but I don't think I filed an issue yet
[22:16:24] <olsonjeffery> brson: the problem is that im (naively) raising the cond at the time when i get back the result from a tcp_connect attempt (in the async callback) .. so that's probably a different task than the user who'd handle the condition..
[22:16:34] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[22:16:54] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:17:05] <brson> olsonjeffery: yeah, that's probably in the scheduler task. I'm not sure what happens atm if the scheduler task fails - but it's bad!
[22:17:11] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:17:15] <toddaaro> brson: looking over the make check I started awhile ago and forgot about I noticed that a lot of tests in the run-fail folder failed
[22:17:19] <olsonjeffery> that's also when i send the value (the TcpStreamAsync) across a Promise .. so, i guess, instead id have a fn wrapper in the future or somewhere accordingly that checks the result for err and then raises in the user's task.. during the ref() call...
[22:17:24] <toddaaro> brson: like rt-log-trunc.rs
[22:17:25] <brson> toddaaro: oof
[22:17:34] <olsonjeffery> im still chewing on how to impl that. but i think it's doable..
[22:17:38] <toddaaro> brson: is that new? it looks like it didn't truncate and [...] the as
[22:18:11] <brson> toddaaro: logging in the new runtime doesn't make any effort to be the same as the old, and yeah, I didn't implement any truncation
[22:18:31] <toddaaro> brson: ah ok, so this is just ::work:: to port the failure tests
[22:18:34] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[22:18:35] <joelteon> is a(vec.pop(), vec.pop()) deterministic?
[22:18:54] <brson> toddaaro: are most of the failures just mismatched logs?
[22:19:01] <toddaaro> brson: looks like it
[22:19:06] <toddaaro> brson: ~10 tests
[22:19:09] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:19:14] <brson> I guess I haven't looked at the run-fail tests with newrt. oops
[22:19:48] <toddaaro> brson: oh, actually they look mostly ok, but some of your recent code adds a "name" line
[22:19:52] <tikue> joelteon: probably, but it's probably also an implementation detail (someone correct me if I'm wrong)
[22:19:53] <toddaaro> *field
[22:19:54] <olsonjeffery> brson: on the plus side.. its failing because of a raised PermissionDenied error and this is in the connect_error test in aio::net::tcp. so i guess half-yay for having it working
[22:20:08] <toddaaro> brson: and that isn't checked for in the error checks
[22:20:10] *** Quits: azita (Azita@C828EC68.8E67A50A.508D426F.IP) (Quit: azita)
[22:20:12] <olsonjeffery> just have to figure out some pattern to raise the condition in the task where the future is consumed
[22:20:12] <brson> olsonjeffery: lol
[22:21:59] *** Jeaye is now known as jeaye
[22:22:02] <kmc> joelteon: most languages make the order of evaluation of arguments unspecified (to facilitate optimization)
[22:22:07] <kmc> I don't see anything about it in the Rust manual
[22:22:11] <brson> graydon: what's the process for configuring a new type of builder?
[22:22:20] <joelteon> ok, I'll just put the first one in a temp variable
[22:23:13] <graydon> brson: what do you mean by "new type of builder"?
[22:23:22] <graydon> like another auto builder for a new platform?
[22:24:05] <brson> graydon: i guess? a builder that runs on ec2 and configures to cross-compile for android
[22:24:15] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[22:24:39] <graydon> I see
[22:24:50] <brson> i have a machine configured to build android and know how to turn it into an ami (or will re-figure that out0
[22:25:59] <graydon> brson: so this is a linux host that just happens to pass a couple interesting flags to configure?
[22:26:51] <brson> graydon: yes, it's based off the existing linux ami plus the android ndk
[22:26:59] <graydon> I would recommend adding a new entry to auto_platforms in master.cfg called, say, "linux-x-android"
[22:27:15] <graydon> or maybe "linux-64-x-android" ?
[22:27:45] <graydon> then scan down to the line 'for p in auto_platforms:'
[22:27:47] <graydon> that instantiates builders
[22:28:15] <graydon> it does something pretty crude, which is to look at the string name of the builder and fiddle the variant accordingly
[22:28:33] <graydon> like if it ends in '-vg' it adds "valgrind:True" to the properties for the build
[22:28:46] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[22:28:56] <graydon> you'll want to add a property "android:True"
[22:28:58] <graydon> but
[22:29:09] <graydon> you'll also need to change the ConfigCommand renderable
[22:29:19] <graydon> to whitelist --enable-android
[22:29:24] <graydon> (or whatever the configure flag is)
[22:29:31] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:29:35] <graydon> we only turn a whitelist of build properties into configure flags
[22:29:49] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[22:29:55] <graydon> it currently has "sharedstd", "valgrind", "helgrind", "docs", "optimize", ...
[22:30:02] <graydon> so you'll need to add to that line too
[22:30:08] <graydon> I can certainly do this if you're uncertain
[22:30:10] <graydon> I said I'd help!
[22:30:22] <graydon> just trying to spread the how-to-operate-our-buildbot nowhow
[22:30:37] <graydon> (we really need a lot more cross-checking of knowhow so we don't wind up producing bottlenecks)
[22:31:20] *** Joins: gazoombo (uid6629@moz-E77DEB21.irccloud.com)
[22:31:25] <graydon> oh, do you .. you want to direct this to a specific slave too, not just the general linux pool?
[22:32:06] <strcat> blech, I'll just remove for now
[22:32:21] <brson> graydon: I was going to make it it's own ami, but I can also update the linux ami to include the android ndk if you think that's better
[22:32:30] <strcat> it's impossible to write a generic range_step covering the things the special-cased one does
[22:32:49] <graydon> brson: it's fine to do on its own; you'll need to isolate to amazon in any case, which we don't have a mechanism for presently
[22:33:15] <brson> graydon: oh, are we not using linux on ec2 now?
[22:33:37] <graydon> brson: we are, but the way it works is that there's an M:N mapping between builders and slaves
[22:33:51] <graydon> brson: and artificially restricting a builder to a specific slave takes some extra work
[22:34:05] <graydon> they added a new mechanism for it in 0.8.8, lemme check to see how the new mechanism works
[22:34:13] <graydon> what I've been doing up until now is making the association manually
[22:34:23] <brson> graydon: i don't think it needs to be a specific slave. I can do whatever you're doing for the existing builders
[22:34:30] <brson> just a specific ami?
[22:34:33] <graydon> like if you look at how we do 'snap' and 'snaponly', I actually collect separate lists of slaves for different roles
[22:34:55] <graydon> same deal
[22:35:56] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[22:37:35] *** Quits: io2 (io2@moz-537A0266.home.otenet.gr) (Quit: )
[22:39:43] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[22:40:54] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[22:42:01] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[22:42:11] * olsonjeffery crosses fingers
[22:43:30] *** Quits: lmandel (lmandel@3E0B9D77.C1F57925.ADB88A9.IP) (Ping timeout)
[22:43:55] <graydon> brson: ok. so for assigning the slave I'd suggest making a slave in slave-list.txt called linux-x-android with your ami, and then modifying the platform_slaves() function to check for '-x-' in the builder name and if seen, return the builder name as slave name.
[22:44:09] *** Joins: lmandel (lmandel@3E0B9D77.C1F57925.ADB88A9.IP)
[22:44:27] <graydon> brson: platform_slaves() is the function we use to take a builder and return the set-of-slaves to assign to it. in your case you want 1:1, right? 1 new builder with 1 slave serving it.
[22:46:41] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[22:47:12] <goffrie> rusti: struct Foo; impl Foo { fn derp(&mut self) { let a = &mut self; } }
[22:47:12] -rusti- <anon>:5:61: 5:71 error: cannot borrow immutable self value as mutable
[22:47:13] -rusti- <anon>:5          struct Foo; impl Foo { fn derp(&mut self) { let a = &mut self; } }
[22:47:13] -rusti-                                                                       ^~~~~~~~~~
[22:47:13] -rusti- error: aborting due to previous error
[22:47:15] -rusti- application terminated with error code 101
[22:47:15] <goffrie> ^what's up with that?
[22:47:20] <brson> graydon: yes
[22:47:40] <graydon> brson: more-or-less follow what I am suggesting, then?
[22:48:13] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[22:48:15] <strcat> graydon: just going to remove 'for'
[22:48:19] <strcat> gone in libstd
[22:48:30] * strcat will convert the rest to 'do'
[22:48:47] <graydon> 	âƒ	brson: looks like you'll need to do a little more work in the ConfigCommand renderable to transform the 'android' property into the actual configure command you want to pass (--android-cross-path=... or something?)
[22:48:53] <graydon> strcat: awesome
[22:48:55] <brson> graydon: more-or-less, yes
[22:49:02] <brson> graydon: yeah, android-cross-path
[22:49:15] <strcat> graydon: range_step/range_rev are basically the only things left using it but... we can't replace them without more macro code gen hacks :(
[22:49:34] <strcat> we need versions of Add/Sub returning Option and checking for overflow
[22:51:15] *** Quits: MiguelD (MiguelD@2ACDA535.A137FB69.46937063.IP) (Ping timeout)
[22:51:26] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[22:51:33] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[22:51:38] * tjc whispers "Option monad"
[22:53:01] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[22:54:05] <kmc> is there any demangling tool for the $SP$$SP$$x3f kind of encoding?
[22:54:31] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:54:41] <kmc> I know the encoding from reading rustc, but an automatic decoder would be cool
[22:55:14] <brson> rustc's mangling needs a little more careful thought
[22:55:43] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:55:44] <brson> not that that answers your question
[22:56:52] *** Quits: mark_edward (quassel@moz-9631ECE3.public.wayport.net) (Ping timeout)
[22:56:54] *** Joins: mark_edward (quassel@moz-9631ECE3.public.wayport.net)
[22:56:56] <toddaaro> brson: how does the old runtime logging work? I went looking around for the truncate code there and I'm not spotting it
[22:57:02] <toddaaro> brson: is there a logging library in use?
[22:57:52] <toddaaro> brson: I modified the string matching to not have the "task" in front, so those tests pass now. that lets the strings match task <blah> ... and task ...
[22:58:03] <toddaaro> brson: but the truncate one is still up in the air
[22:58:05] <brson> toddaaro: it's in rust_log.cpp, and the truncation is done in rust_log::log
[22:58:56] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[22:59:03] *** Quits: mark_edward (quassel@moz-9631ECE3.public.wayport.net) (Ping timeout)
[22:59:29] <olsonjeffery> brson: does rtdebug choke if ran in task context?
[23:00:45] <joelteon> does rusti has the capability to interpret a source file and make its functions available in the console yet?
[23:00:47] <brson> olsonjeffery: it should not, no
[23:00:58] <olsonjeffery> rtdebug!, even
[23:00:58] <olsonjeffery> hm. prob not.
[23:01:00] <joelteon> hmm, that's an ambitious question.
[23:01:07] *** Joins: mark_edward (quassel@981AA104.E81F12CD.76F66111.IP)
[23:02:40] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[23:03:25] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:03:54] *** Joins: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com)
[23:04:03] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[23:04:06] <toddaaro> rusti: "5"+"120"
[23:04:07] -rusti- ~"5120"
[23:04:15] <bblum> no way, it should be 125
[23:04:19] <bblum> FILE A BUG
[23:04:26] <toddaaro> i know right
[23:04:49] <olsonjeffery> brson: is there a (relatively) small number of operations where the scheduler does an assert that it's in Scheduler context.. ?
[23:05:09] <olsonjeffery> that's the failure im seeing. trying to wrap my brain around it, because im not using any of the sync machinery where that pops up..
[23:05:14] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[23:05:20] *** Joins: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com)
[23:05:42] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:06:02] <toddaaro> olsonjeffery: I don't think is has any asserts like that right now, what exactly are you seeing from it?
[23:06:13] <toddaaro> olsonjeffery: (and how far behind master are you)
[23:06:53] <brson> graydon: can you look at these changes i've made to the script? https://gist.github.com/brson/6144166
[23:07:31] <brson> hm missing a space before --android-cross-path
[23:07:48] <graydon> brson: checking
[23:08:18] *** Joins: webber46 (webber46@moz-717E9C5B.cust.bredband2.com)
[23:08:57] *** Quits: webber46 (webber46@moz-717E9C5B.cust.bredband2.com) (Quit: webber46)
[23:09:29] <olsonjeffery> toddaaro: im not too far behind.. and year i know most of those were taken out
[23:09:33] <olsonjeffery> yeah*
[23:09:50] <enix> brson: I rebased my Sha2 & Sha1 changes again to account for the foreach work that broke the merge of my changes. I checked that all patches still compile and pass tests: https://github.com/mozilla/rust/pull/8174
[23:10:03] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[23:10:11] <graydon> brson: the changes to platform targets aren't right
[23:10:27] <graydon> close, but that's the all-platforms version (for builders that end in -all)
[23:10:36] <graydon> lemme tweak it a bit, I'm also ssh'ed in
[23:10:36] <graydon> sec
[23:10:42] <graydon> (are you done with it?
[23:10:44] <toddaaro> rusti: let x = "120"; x.len()
[23:10:44] -rusti- 3
[23:11:35] <brson> graydon: yes
[23:11:50] <toddaaro> rusti: let x: ~str = "120"; x.len()
[23:11:50] -rusti- <anon>:5:23: 5:28 error: mismatched types: expected `~str` but found `&'static str` (str storage differs: expected ~ but found &'static )
[23:11:50] -rusti- <anon>:5          let x: ~str = "120"; x.len()
[23:11:51] -rusti-                                 ^~~~~
[23:11:51] -rusti- error: aborting due to previous error
[23:11:51] -rusti- application terminated with error code 101
[23:11:52] <brson> enix: thanks, sorry for the trouble
[23:11:56] <toddaaro> rusti: let x: ~str = ~"120"; x.len()
[23:11:56] -rusti- 3
[23:12:01] <enix> np
[23:13:14] <toddaaro> how do I import len and substr on strings?
[23:13:19] <toddaaro> I can't figure out how
[23:13:35] <olsonjeffery> brson toddaaro  : this is a gist of what i got... sorry for the line nums, heh. i can upload my branch if needed. https://gist.github.com/olsonjeffery/6144194
[23:13:39] <toddaaro> I found a doc page, but it doesn't say what the thing to import is, use str doesn't work
[23:13:42] <cmr> I think that'd be the Container and StrSlice traits
[23:13:52] <strcat> toddaaro: you need the traits imported to use impls of them
[23:13:59] <strcat> it's because this stuff is in prelude
[23:14:14] <graydon> brson: I .. _think_ that ought to work? :)
[23:14:19] <strcat> so in libstd you have to import them (or use prelude::* if the module you're in doesn't have anything in prelude)
[23:14:23] <graydon> (saved changes I meant to)
[23:14:49] <sully> ok, I think I have figured out what is going wrong in the match codegen bug
[23:14:57] <olsonjeffery> heh. woah.
[23:15:02] <olsonjeffery> i did that all wrong, huh.
[23:15:13] <sully> now I need to figure out how to fix it
[23:15:13] <brson> graydon: this doesn't need to do the i686 build. can it be removed?
[23:15:16] <olsonjeffery> bind, not connect. woo-hoooooooooooo.
[23:16:04] <graydon> brson: the one for all_platform_targets is only if someone, in the future, makes a builder like this that ends in "-all"
[23:16:04] <toddaaro> strcat: does the rustdoc just not show traits for prelude stuff? or am I missing something?
[23:16:12] <strcat> toddaaro: you're missing something
[23:16:13] <brson> graydon: oh, ok
[23:16:19] <graydon> brson: IOW one that does a build-for-all-targets config
[23:16:19] <strcat> toddaaro: rustdoc doesn't put methods in the TOC
[23:16:33] <cmr> And rustdoc also don't list reexports
[23:16:43] <cmr> so there's nothing in the prelude, according to it
[23:16:44] <toddaaro> strcat: I'm at static.rust-lang.org/doc/core/files/str-rs.html
[23:16:51] <graydon> brson: the change for auto_paltform_targets() is the one that handles the single builder, single target case you're aiming for
[23:16:52] <cmr> toddaaro: ugh why, that's ancient
[23:16:55] <cmr> http://static.rust-lang.org/doc/std/index.html
[23:16:58] <toddaaro> cmr: google told me to
[23:17:07] <cmr> Google lies!
[23:17:08] <strcat> we need to rm those
[23:17:11] <olsonjeffery> yeah. i apparently was following from tcp_bind on autopilot. heh. i'm fired.
[23:17:12] <strcat> I have an issue open about it
[23:17:18] <olsonjeffery> mumble mumble
[23:17:29] <graydon> oh, just core/*
[23:17:30] <brson> that's got to be pre-0.1
[23:17:30] <graydon> ?
[23:17:39] <graydon> I'll delete them now
[23:17:43] <graydon> which issue?
[23:18:00] <strcat> graydon: https://github.com/mozilla/rust/issues/7476
[23:18:19] <strcat> I thought it would email you if I assigned you
[23:18:27] * strcat shrugs
[23:19:02] <tjc> github is being weird about sending emails lately
[23:19:10] <tjc> as in, I don't get them when people do things like comment on my pull requests
[23:19:20] <toddaaro> do you not get them, or do they get lost?
[23:19:23] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[23:19:27] <tjc> I don't get them
[23:19:32] <toddaaro> I've got a pile of ~11k from github I haven't dealt with
[23:19:36] <tjc> funny, because it used to send me too *much* email
[23:19:50] <strcat> because either you watch the repo and get 10000000 or it sends none
[23:19:52] <strcat> ;D
[23:19:57] <joelteon> what characters are permitted in function names?
[23:20:00] <strcat> it's supposed to send them if you're assigned/mentioned though
[23:20:02] <strcat> but it doesn't always
[23:20:14] <strcat> alright
[23:20:15] <cmr> joelteon: they are identifiers
[23:20:18] <strcat> no more for loops in std/extra/syntax/rustc
[23:20:22] <strcat> now the wonderful test suite.
[23:20:22] <tjc> that's the thing, I am watching the repo
[23:20:23] *** Quits: jensnockert (jensnocker@moz-61E1062F.tbcn.telia.com) (Input/output error)
[23:20:23] <cmr> That follow http://www.unicode.org/reports/tr31/ more-or-less
[23:20:27] <strcat> tjc: heh, weird
[23:20:29] <joelteon> ok
[23:20:31] <strcat> tjc: maybe watch/unwatch?
[23:20:33] <joelteon> cmr: oh, I found it
[23:20:33] <tikue> rusti: let s = "aeiou";
[23:20:34] -rusti- <anon>:5:13: 5:14 warning: unused variable: `s` [-W unused-variable (default)]
[23:20:34] -rusti- <anon>:5          let s = "aeiou";
[23:20:34] -rusti-                       ^
[23:20:34] -rusti- ()
[23:20:36] *** Quits: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP) (Ping timeout)
[23:20:38] <joelteon> ascii letters and underscores, ok
[23:20:39] <tjc> strcat: can't hurt, I'll try it
[23:20:40] <strcat> tjc: our issue search is also broken again
[23:20:42] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[23:20:44] <strcat> I have to ask them to clear the cache again
[23:20:47] <cmr> joelteon: and also a bunch of unicode letters
[23:20:48] *** Joins: km (quassel@FDBAF0A0.DBF71E41.29C67456.IP)
[23:20:49] <tjc> strcat: was it ever not broken? :P
[23:20:49] <strcat> like, their db caches it incorrectly
[23:20:52] <joelteon> oooooh, which ones
[23:20:56] <graydon> doc/core is gone now
[23:20:56] <strcat> tjc: yeah but it says issues are open
[23:20:58] <strcat> and then you click them
[23:21:00] <strcat> and they're closed.
[23:21:03] <cmr> joelteon: most of them.
[23:21:03] <strcat> annoys me so much
[23:21:03] <tjc> oh yeah
[23:21:04] <tikue> rusti: let s = "aeiou"; for c in s.iter() { printfln!("%?", c); }
[23:21:04] -rusti- <anon>:5:32: 5:34 error: expected `{` but found `in`
[23:21:04] -rusti- <anon>:5          let s = "aeiou"; for c in s.iter() { printfln!("%?", c); }
[23:21:05] -rusti-                                          ^~
[23:21:05] -rusti- application terminated with error code 101
[23:21:08] <joelteon> oh, solid
[23:21:10] <joelteon> ok
[23:21:10] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:21:16] <tikue> rusti: let s = "aeiou"; foreach c in s.iter() { printfln!("%?", c); }
[23:21:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/LgLS
[23:21:18] <cmr> joelteon: http://www.unicode.org/reports/tr31/#Default_Identifier_Syntax
[23:21:26] <strcat> tjc: they've told me "it's fixed" about 10 times now
[23:21:29] <tikue> rusti: let s = "aeiou"; foreach c in s.iter() { printfln!("%c", c); }
[23:21:30] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/HJfF
[23:21:40] <tikue> rusti: let s = "aeiou"; foreach &c in s.iter() { printfln!("%c", c); }
[23:21:41] -rusti- <anon>:5:34: 5:36 error: mismatched types: expected `char` but found an &-pointer pattern
[23:21:41] -rusti- <anon>:5          let s = "aeiou"; foreach &c in s.iter() { printfln!("%c", c); }
[23:21:41] -rusti-                                            ^~
[23:21:41] -rusti- error: aborting due to previous error
[23:21:42] -rusti- application terminated with error code 101
[23:21:48] <tikue> hm
[23:21:50] <tikue> that's nice
[23:21:53] *** Quits: doy (doy@moz-5FE28A32.akrasiac.org) (Ping timeout)
[23:22:09] *** Joins: doy (doy@moz-5FE28A32.akrasiac.org)
[23:22:12] <strcat> tjc: I think they just clear it assume it will never happen again :S
[23:22:25] <strcat> bugs? impossible! :)
[23:22:30] <tjc> strcat: github support sounds a lot like dreamhost support
[23:22:41] <tikue> rusti: let mut vowels = ~"aeiou"; vowels.push('y');
[23:22:41] -rusti- <anon>:5:36: 5:53 error: type `~str` does not implement any method in scope named `push`
[23:22:42] -rusti- <anon>:5          let mut vowels = ~"aeiou"; vowels.push('y');
[23:22:42] -rusti-                                              ^~~~~~~~~~~~~~~~~
[23:22:42] -rusti- error: aborting due to previous error
[23:22:42] -rusti- application terminated with error code 101
[23:24:19] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Connection reset by peer)
[23:25:15] <kimundi> cmr, kmc: Re earlier: are unassigned codepoints 'private custom usage' codpoints, or are those assigned/reserved?
[23:25:26] <strcat> all these for loops with returns in them >.<
[23:25:37] <kmc> I don't know all the details but I know there's a specific Private Use Area
[23:25:55] <kmc> the Consortium promises not to allocate new things there
[23:26:23] <brson> graydon: ok, this may be ready to go. what's the procedure for turning this baby on? is it going to kill the current build (which i want to finish)?
[23:26:40] <kimundi> Just curious if those would fall under forbidding them in char
[23:26:40] <graydon> brson: buildbot checkconfig then if nothing complains, buildbot reconfig
[23:26:53] <graydon> brson: won't kill so long as you reconfig rather than restart
[23:26:54] <kmc> that would be bad, I think
[23:26:58] <kimundi> HM, I have trobule with deriving(ToStr) in std: https://gist.github.com/Kimundi/e9c3a97903353cb7497f
[23:26:58] <graydon> restart will kill existing jobs
[23:27:10] <graydon> reconfig tries to hand off state between configs, usually successfully
[23:27:37] <joelteon> if you move a field of a struct, does the whole struct get moved?
[23:28:07] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[23:28:08] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[23:28:27] <kimundi> joelteon: Yes
[23:28:37] <joelteon> ok, that makes sense
[23:28:39] *** Joins: Ralith (ralith@moz-AB653EB1.wireless.sfu.ca)
[23:28:55] <kimundi> joelteon: Thou it would be more accurate to say thet the rest becomes inaccessible/destroyed
[23:29:03] <joelteon> ok
[23:29:04] <brson> graydon: I think it blew up
[23:29:24] <brson> the buildslaves list looks wrong for linux-64-x-android http://buildbot.rust-lang.org/buildslaves
[23:29:35] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:29:44] <brson> the fans on my minis turned off
[23:29:50] <brson> :-/
[23:30:23] <kimundi> Anyone know how to solve thet deriving ToStr ?
[23:30:52] <graydon> brson: they were all successful, no interrupts
[23:31:20] <graydon> brson: yeah, it added your new slave to all the linux builders as well; we didn't explicitly prohibit that
[23:31:52] <graydon> brson: though since they dispatch in order and I think it comes after all the others, it'll likely never activate for those builders
[23:31:59] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:31:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/UVSXJQ
[23:31:59] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:32:31] <graydon> let's see if it wakes up :)
[23:33:02] <bblum> yess, my fixes went in
[23:33:10] * strcat has slain 2000 for loops
[23:33:29] <strcat> I wonder how many are lurking in run-pass though
[23:33:37] <strcat> metadata/decoder.rs:917:46: 917:47 error: `again` outside of loop
[23:33:39] <strcat> uh
[23:33:39] <graydon> strcat: when you push this it's probably going to be the biggest single perf improvement push in our history :)
[23:33:51] <strcat> graydon: well I'm including the old ones in this ;p
[23:33:57] <strcat> that I already removed
[23:33:59] <graydon> change that message to 'loop', the 'again' keyword is obsolete
[23:34:01] <strcat> they're mostly all gone already
[23:34:17] <strcat> I didn't even know rust ever had 'again'
[23:34:21] <tikue> hey guys, when I try to use rustc outside of the stageX/ directory, I get weird compile errors. is this a known thing?
[23:34:23] <strcat> when I learned it, it had continue
[23:34:55] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[23:34:55] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/FsgGUw
[23:34:55] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[23:34:56] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:34:56] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/vhlwkQ
[23:34:56] <ghrust> 13rust/06auto 14f51795c 15Patrick Walton: librustc: Introduce a new visitor type based on traits and port syntax to it....
[23:34:56] <ghrust> 13rust/06auto 14c8f7a3f 15Patrick Walton: librustc: Disallow "unsafe" for external functions
[23:34:56] <ghrust> 13rust/06auto 14caca31a 15bors: auto merge of #8235 : pcwalton/rust/unsafe-extern-fns, r=brson...
[23:34:58] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:35:15] <ChrisMorgan> The first batch of for->foreach had a >9% compile time win.
[23:35:15] <tikue> https://gist.github.com/tkuehn/770e76aa651f64444658
[23:35:39] <strcat> rusti: loop;
[23:35:41] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/CfEg
[23:35:50] <strcat> rusti: { loop; }
[23:35:51] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/MJBT
[23:35:57] * strcat sighs
[23:35:58] <sp3d> ha
[23:36:06] <strcat> rusti: fn foo() { loop; }
[23:36:06] -rusti- <anon>:5:24: 5:25 error: `again` outside of loop
[23:36:06] -rusti- <anon>:5          fn foo() { loop; }
[23:36:06] -rusti-                                  ^
[23:36:06] -rusti- error: aborting due to previous error
[23:36:07] -rusti- application terminated with error code 101
[23:36:11] <strcat> oh well easy to fix
[23:36:14] <strcat> just funny
[23:36:44] <kimundi> Is there any trick to get #[deriving(ToStr)] to work in a std module?
[23:36:56] <brson> my android ami is initializig!
[23:37:06] <cmr> kimundi: it should Just Work :(
[23:37:16] <cmr> kimundi: do you need to use prelude::*?
[23:37:18] <strcat> graydon: I don't think this last push will help because I'm changing most to 'do'
[23:37:24] <strcat> mostly just ad-hoc iterators in librustc
[23:37:28] <strcat> or tests
[23:37:32] <kimundi> cmr: use prelude::* is already there
[23:37:35] <kimundi> cmr: https://gist.github.com/Kimundi/e9c3a97903353cb7497f
[23:38:01] <goffrie> rusti: macro_rules! m( (|$($x:pat),*|) => (()) ); m!( | | )
[23:38:02] -rusti- <anon>:5:58: 5:59 error: Local ambiguity: multiple parsing options: built-in NTs pat ('x') or 1 other options.
[23:38:02] -rusti- <anon>:5          macro_rules! m( (|$($x:pat),*|) => (()) ); m!( | | )
[23:38:02] -rusti-                                                                    ^
[23:38:02] -rusti- application terminated with error code 101
[23:38:05] <goffrie> ^ why doesn't that work :(
[23:39:12] <ChrisMorgan> goffrie: that looks to be exactly the same problem as I was demonstrating a couple of days agoâ€”phoney local ambiguity
[23:39:29] <goffrie> it's especially strange because $($x:pat)|+ is allowed and parses just fine
[23:39:33] <vladimir-lu> tikue: btw nice presentation
[23:39:41] <olsonjeffery> i have met a terrible fate, indeed
[23:39:51] <tikue> vladimir-lu: thank you :)
[23:40:08] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[23:40:28] <tikue> so it seems that if I try to compile from the bin/ directory, I get this error. If I cd .. and do bin/rustc example.rs then there's no problem
[23:40:37] *** Quits: Ralith (ralith@moz-AB653EB1.wireless.sfu.ca) (Ping timeout)
[23:40:51] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[23:40:53] <bblum> olsonjeffery: http://24.media.tumblr.com/tumblr_m8q4k1pzZI1rrasiro1_400.jpg
[23:40:59] <ChrisMorgan> rusti: macro_rules! m(($($x:ident)*/)=>())m!(/)       // goffrie: e.g. this one: clearly `/` isn't ident, but local ambiguity is cleamed
[23:40:59] -rusti- <anon>:5:47: 5:48 error: Local ambiguity: multiple parsing options: built-in NTs ident ('x') or 1 other options.
[23:40:59] -rusti- <anon>:5          macro_rules! m(($($x:ident)*/)=>())m!(/)       // goffrie: e.g. this one: clearly `/` isn't ident, but local ambiguity is cleamed
[23:40:59] -rusti-                                                         ^
[23:40:59] -rusti- application terminated with error code 101
[23:41:03] <ChrisMorgan> s/cleamed/claimed/
[23:41:15] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Quit: Lost terminal)
[23:41:57] <brson> graydon: the buildslaves sem to not be coming back up
[23:42:02] <graydon> :(
[23:42:14] <graydon> someone's flooding the buildbot with bogus login attempts
[23:42:22] <cmr> :(
[23:42:26] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[23:42:30] <tikue> who would do that
[23:42:32] <tikue> ?!
[23:42:42] <brson> graydon: could be my slave. I see lots of weird stuff in syslog
[23:42:43] <graydon> a robot that attacks everything randomly. like they do.
[23:42:55] <graydon> brson: oh, maybe
[23:43:38] <brendanc> if it's not coming in on port 80 (or 8010 or wherever you have webstatus parked), it's probably not a bot?
[23:43:56] <brson> hm, the timestamps aren't from right now though
[23:44:09] <graydon> brendanc: yeah, no, I guess it's from the new slave?
[23:44:18] <graydon> 2013-08-02 13:14:45-0700 [Broker,3531,127.0.0.1] invalid login from unknown user '<?xml'
[23:44:29] <graydon> that's not web-interface traffic, right?
[23:44:41] <olsonjeffery> oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.
[23:44:57] <graydon> that's someone trying to connect through the loopback interface that the stunnels terminate in
[23:45:07] <brendanc> yeah I think that's the slave interface
[23:45:23] <olsonjeffery> brson: can't send on a channel in SchedulerContext?
[23:45:30] <olsonjeffery> any workaround, there?
[23:45:40] <olsonjeffery> im sending on a promise to fulfill a future, in a libuv callback..
[23:46:07] <graydon> brson: when you say the slaves are not coming back up .. do you mean all of them or just yours?
[23:46:35] <brson> graydon: i'm not sure. mine definitely. the others mostly are Idle though they should be building
[23:46:41] <brson> mine's not connected
[23:46:47] <graydon> yeah, weird
[23:46:54] <olsonjeffery> i should say: the Promise<A> is a single variant enum that wraps a ChanOne<A>.. and im calling the fulfill(v: A) on it within a uv callback.. which just does self.send(v)
[23:46:58] <graydon> did you greatly increase treestabletimer or something?
[23:46:59] <graydon> hm
[23:47:13] <brson> i did not touch treestabletimer
[23:47:26] <graydon> is your bot trying to connect?
[23:47:39] <graydon> I am seeing 1 bogus connection attempt per second more or less, tailing the logs
[23:47:58] <brendanc> http://buildbot.rust-lang.org/builders/auto-linux-32-opt is linux-64-x-android supposed to be in the slave list for that builder?
[23:48:09] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[23:48:12] <brson> graydon: I'm not sure. twisted.log is empty. is there somewhere else i can look?
[23:48:19] <brendanc> wonder if the builders are idle because they've tried to schedule a build on a slave that isn't available
[23:48:24] <graydon> brendanc: no, but I'd have thought it is not a big deal if it is?
[23:48:41] <graydon> like they tried to schedule on linux-64-x-android?
[23:48:43] <graydon> guh
[23:48:52] <brendanc> or linux5 or linux6
[23:49:04] <graydon> no, I bet the nextSlave function is the culprit
[23:49:09] <graydon> it sorts then lexicographically
[23:49:21] <graydon> I bet linux-64-x-android is at the top of the list :(
[23:49:30] <graydon> the macs should be building though
[23:49:52] <brson> olsonjeffery: right now the only solution would be to schedule a task to send the message. making message sends work from SchedTasks is probably the right thing here
[23:49:52] *** Quits: syatchmenoff (syatchmeno@moz-87F0A991.hfc.comcastbusiness.net) (Quit: syatchmenoff)
[23:49:57] <brendanc> true
[23:49:57] *** Quits: tchoma (tchoma@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:50:07] <graydon> what are these bogus connect attempts?
[23:50:08] <graydon> grr
[23:50:08] <brson> olsonjeffery toddaaro: I'm not sure if message receives from SchedTasks is possible though
[23:50:12] <graydon> I have to go in 10 minutes
[23:50:23] <olsonjeffery> brson: that should be ok
[23:50:25] <graydon> brson: can we revert for the weekend? I'm about to go home
[23:50:30] <olsonjeffery> i don't think ill block in SchedulerContext
[23:50:31] <brson> graydon: yes
[23:50:37] <brson> i'll do so
[23:50:51] <graydon> brson: feel free to commit and then just checkout one-back-in-time
[23:50:54] <graydon> it's useful work in progress..
[23:51:40] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[23:51:45] <toddaaro> brson: github.com/mozilla/rust/pull/8241 - fixes the logging issues I found
[23:51:50] <olsonjeffery> just need to send data out..
[23:52:05] <olsonjeffery> brson toddaaro : how hard would it be to add that? could i take a whack at it, or should i wait?
[23:52:12] <olsonjeffery> (sending from SchedulerContext)
[23:52:13] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[23:52:14] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[23:52:14] <sully> hm, I think that properly implementing our quite expressive vector pattern matching...
[23:52:17] <sully> is tricky
[23:52:20] <sully> and we do not do it
[23:52:24] <olsonjeffery> this is in L95 in rt/comm.rs, btw
[23:52:28] <olsonjeffery> where the assert! is
[23:52:46] <brson> graydon: um, buildbot reconfig didn't remove the android slave
[23:53:00] <brson> it did remove the builder
[23:53:09] <brson> maybe i need to remove it from the slave list
[23:53:14] <graydon> brson: comment out the line in the slave list
[23:53:32] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[23:53:32] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[23:53:46] <brson> ok, it's reverted
[23:54:04] * brson crosses fingers
[23:54:31] *** Quits: brianm (brianm@D2D642B9.79695EE7.489C5759.IP) (Quit: Linkinus - http://linkinus.com)
[23:54:59] <brson> builders are still idle
[23:57:07] <graydon> restart then
[23:57:12] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[23:57:13] <graydon> sometimes reconfig doesn't do what it should
[23:57:14] <graydon> :(
[23:57:14] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[23:57:17] <brendanc> you'll kill your windows build
[23:57:19] <brson> olsonjeffery: the send case should be pretty easy. only the third case in that match should be affacted
[23:58:09] <brson> restart failed. woo
[23:58:10] <ChrisMorgan> I finally applied to join rust-dev mailing list (been passively monitoring it through pipermail), could I please be approved so that I can respond to "Help with a trivial TCP client example needed"?
[23:58:22] <brson> 'never saw process go away'. so i tried 'start'
[23:58:34] <brson> good lord I've broken things
[23:58:36] <brendanc> try stop first
[23:58:38] <brson> start failed
[23:58:57] <brendanc> possibly kill :)
[23:59:12] <brendanc> if it's hung that would explain why the builders aren't starting
[23:59:18] <brson> stop/start failed
[23:59:49] <brson> i see two python process that look like they're running buildbot
[23:59:56] <brendanc> kill em
