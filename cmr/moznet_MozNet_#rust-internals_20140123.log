[00:01:09] *** flaper87 is now known as flaper87|afk
[00:03:29] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:03:29] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 145624101 to 1440b3e91: 02http://git.io/k471pw
[00:03:29] <ghrust> 13rust/06try 1440b3e91 15Alex Crichton: Implement native timers...
[00:03:29] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:06:39] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:06:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148ce0c06 to 14fce7922: 02http://git.io/N3iJvQ
[00:06:39] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:15:56] <ktt3ja> pcwalton: can you stop bors from running on my PR? https://github.com/mozilla/rust/pull/11718  I haven't fixed existing tests and add new test cases.
[00:16:13] <pcwalton> I don't think I can
[00:16:14] <pcwalton> it'll just fail
[00:16:21] <dbaupp> ktt3ja: I think closing it works
[00:16:50] <Luqman> pcwalton: you can force stop builds in buildbot
[00:17:50] <acrichto> oh I got the buildbots
[00:17:56] <acrichto> sorry saw this after the comment
[00:20:12] <bstriecoin> ...has anyone else been offered bitcoin tips for making commits to the rust repo?
[00:20:18] <bstriecoin> or is that a club reserved for me and bors
[00:20:20] <dbaupp> bstriecoin: yes
[00:20:22] *** Joins: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[00:20:22] *** ChanServ sets mode: +qo brson brson
[00:20:29] <bstriecoin> hilarious
[00:20:32] <dbaupp> bstriecoin: assuming you're talking about http://tip4commit.com/projects/149 ?
[00:20:35] <bstriecoin> yeah
[00:20:44] <bstriecoin> bors must have *so much* bitcoin
[00:21:22] <sfackler> bstriecoin: I am the "proud" owner of .00095971 bitcoin
[00:21:36] <bstriecoin> but what is that in dogecoin?
[00:22:46] <dbaupp> pcwalton would have a lot from the hundreds of de-@mut-ing commits too.
[00:23:08] <bstriecoin> that's really the only reason that he's endured this whole process
[00:23:33] <dbaupp> to earn $2 of bitcoins
[00:23:47] <bstriecoin> well, it's $2 today
[00:23:54] <bstriecoin> tomorrow it could be $2000
[00:25:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:25:32] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 1440b3e91 to 1493a457d: 02http://git.io/k471pw
[00:25:32] <ghrust> 13rust/06try 1439c8cab 15Daniel Micay: libc: switch `free` to the proper signature...
[00:25:32] <ghrust> 13rust/06try 146b92f2a 15Daniel Micay: vec: make unsafe indexing functions higher-level
[00:25:32] <ghrust> 13rust/06try 14ff550b9 15Daniel Micay: add new vector representation as a library
[00:25:33] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:26:16] *** Quits: dbaupp (Thunderbir@32742E97.D5A1DCF.37681C44.IP) (Ping timeout)
[00:26:28] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:26:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 142f8f548 to 14fce7922: 02http://git.io/N3iJvQ
[00:26:28] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:26:29] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:26:30] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/HJ4njQ
[00:26:30] <ghrust> 13rust/06auto 1486b0564 15Hong Chulju: rustc/metadata: Removed stray debug statements
[00:26:30] <ghrust> 13rust/06auto 14c1eb17f 15bors: auto merge of #11701 : FeGs/rust/stray-debug-in-metadata, r=alexcrichton...
[00:26:30] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:30:42] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[00:31:29] <nate> does anyone know the status on https://github.com/mozilla/rust/issues/5172 ?
[00:31:39] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[00:31:48] <vadimcn> acrichto: If I am seeing "Unhandled condition: io_error: io::IoError{kind: IoUnavailable, desc: "I/O is unavailable",...", what would be the most likely cause?
[00:32:08] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[00:32:11] <vadimcn> something to do with TLS?
[00:33:10] <nate> I'm looking into submitting a PR for it but am not really sure if it's still an issue that needs to be fixed
[00:33:10] <acrichto> are you spinning up a SchedPool yourself?
[00:33:19] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[00:33:34] <acrichto> nate: I'd try to contact jld about that if I were you
[00:33:50] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[00:33:57] <acrichto> vadimcn: that'll happen if you're on a task that doesn't have an I/O factory, and currently the only way that can happen is when you're on a green simple task (I think)
[00:34:04] <acrichto> which is only early in the boot process for libgreen
[00:34:54] <vadimcn> acrichto: I'm trying to use current LLVM master
[00:35:09] <vadimcn> the program is basically a "hello world"
[00:35:16] <acrichto> whoa
[00:35:29] <acrichto> as in you rebased llvm and now you're getting this error?
[00:35:48] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:35:51] <vadimcn> yes
[00:35:56] <acrichto> weird
[00:35:57] * strcat blames stupid broken glue drops
[00:36:03] <Luqman> acrichto: so, the return codes for getaddrinfo don't match up with the usual errnos, EAI_AGAIN = -3 but EAGAIN = 11
[00:36:04] <vadimcn> I'm compiling for win64 too :)
[00:36:26] <strcat> vadimcn: it worked on the same revision before the upgrade, right?
[00:36:31] <acrichto> Luqman: aww man, io::OtherIoError is fine for now then
[00:36:41] <vadimcn> strcat: yes
[00:37:08] <acrichto> vadimcn: this is with libgreen or libnative?
[00:37:12] <strcat> ugh
[00:37:14] <strcat> what is wrong with try
[00:37:22] <strcat> I push something and it starts 5 builds
[00:37:23] <vadimcn> libgreen.  that's the default, right?
[00:37:24] <strcat> ???
[00:37:30] <strcat> yes
[00:37:33] <acrichto> vadimcn: yeah, are you enabling logging?
[00:37:47] <strcat> vadimcn: you could try using libnative to see if it's a green issue or something else
[00:37:56] <acrichto> oh I guess my try builds are probably lost somewhere in that storm then :\
[00:38:01] <strcat> well actually
[00:38:07] <strcat> using libnative for librustc was broken on windows iirc ;\
[00:38:11] <strcat> that's why cmr's PR didn't land
[00:38:13] <strcat> so nvm
[00:38:19] <acrichto> which pr?
[00:38:23] <nate> acrichto: ok, thanks
[00:38:33] <strcat> acrichto: his one switching the driver.rs thing to libnative
[00:38:41] <vadimcn> so I am guessing this has something to do with broken TLS?
[00:38:56] <acrichto> vadimcn: you should only see that is you successfully read TLS I think
[00:39:03] <strcat> acrichto: http://ix.io/a4e + incomplete fixes for windows
[00:39:08] <acrichto> but that does sound like alikely culprit
[00:39:27] <acrichto> was there a pr for this?
[00:39:30] <acrichto> or was that only run through try?
[00:39:37] <strcat> acrichto: PR
[00:39:48] <acrichto> what was the number?
[00:39:50] <strcat> acrichto: https://github.com/mozilla/rust/pull/11431
[00:39:57] <acrichto> thanks
[00:39:59] * strcat gives it a better title
[00:40:29] <strcat> hm
[00:40:33] <strcat> buildbot is really broken
[00:41:04] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[00:43:06] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[00:44:38] <vadimcn> acrichto: compiling with libnative doesn't do that, btw
[00:44:55] <acrichto> vadimcn: do you have a backtrace?
[00:46:21] <vadimcn> as in "set RUST_LOG=::rt::backtrace" ?
[00:46:57] <acrichto> gdb backtrace
[00:48:59] <vadimcn> nothing beyond Unwinder::begin_unwind()
[00:49:01] <vadimcn> :(
[00:50:04] <acrichto> my best guess is an attempt to log before the process has started
[00:50:19] <acrichto> you could see how far it gets
[00:50:25] <acrichto> green threads spin up a thread pool
[00:50:39] <acrichto> see if it ever reaches the point where it throws the main task into the thread pool
[00:51:13] <vadimcn> ok, thx
[00:51:46] <jld> nate: It's... sort of an issue?  It'd only manifest in 32-to-64-bit cross-compilation with types larger than 4 GiB.
[00:52:35] <strcat> pcwalton: btw the language benchmarks game has rust now
[00:52:43] <jld> nate: So it's a code cleanliness issue, but it's probably not breaking any programs anyone's written yet.
[00:52:57] <strcat> although it's not shown on the main summaries since it's missing benchmarks for most things
[00:53:03] <pcwalton> uh oh
[00:53:14] <strcat> pcwalton: extra::bigint makes us look really bad ;p
[00:53:21] <strcat> takes 30min to run the thing gmp does in 2s...
[00:53:30] <strcat> afaik rust can't use gmp for it if it has big ints
[00:53:39] * pcwalton wants to remove bigint
[00:53:55] <strcat> yes I wanted to have bigints in libstd but am for removing it now
[00:54:08] <strcat> if we can't put LGPL deps in libstd, shouldn't have bigints there
[00:54:44] <strcat> since nothing comes close to gmp and I don't want the defacto standard to become something really slow ;\
[00:55:18] <jld> nate: So it's not very high priority, but I don't think people would object to a PR that cleans that stuff up?
[00:56:41] <strcat> acrichto: brson actually already r+'ed it but I pushed a rebase ;p
[00:57:45] <acrichto> ah, r=me then
[00:57:47] <acrichto> or r=brson
[00:57:49] <acrichto> either way
[00:58:02] <acrichto> ~[T] vs Vec does make me uncomfortable though...
[00:58:44] <sfackler> strcat: we can't use LGPL stuff because we want to be able to statically link?
[00:58:49] <strcat> sfackler: well we can
[00:58:53] <strcat> but it adds restrictions
[00:59:00] <sfackler> right
[00:59:09] <strcat> proprietary code can link to lgpl libs, but they have to distribute linkable objects (an rlib)
[00:59:20] <strcat> which we probably don't want to force on people
[00:59:35] <strcat> so yes, it's easy enough for anyone to use rust-gmp, and 90% of proprietary applications can use it
[00:59:43] <strcat> but in libstd it's probably not a good idea
[01:00:00] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:00:00] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 1493a457d to 147746ab9: 02http://git.io/k471pw
[01:00:00] <ghrust> 13rust/06try 1429276d9 15Daniel Micay: add new vector representation as a library
[01:00:00] <ghrust> 13rust/06try 147746ab9 15Daniel Micay: hashmap: port to Vec<T>
[01:00:00] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:00:16] *** Joins: dbaupp (Thunderbir@32742E97.D5A1DCF.37681C44.IP)
[01:00:46] <strcat> lgpl's goal is to keep the library code free, which in GPL terms mean users can modify the source, recompile it and rebuild *or* relink the app against it
[01:01:11] <strcat> and even for dynamic libs, LGPL is pretty close to the same thing as static linking....
[01:01:21] <dbaupp> is there any scope for generic literals (either Haskell-like, or C++11-like) to make working with bigints reasonable?
[01:01:24] <strcat> cause inline functions longer than 10 lines could as static linking ;p
[01:01:34] <strcat> dbaupp: I opened an issue about it (well, two)
[01:03:05] <strcat> pcwalton: http://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=pidigits&lang=all&id=1&data=u64http://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=pidigits&lang=all&id=1&data=u64 ;p
[01:03:23] <strcat> er
[01:03:29] <strcat> http://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=pidigits&lang=all&id=1&data=u64 *
[01:03:38] <pcwalton> bleh
[01:03:55] <sfackler> haha
[01:03:56] <acrichto> lol we're at the very bottom
[01:04:08] <sfackler> by a factor of 1000 over C!
[01:04:08] <acrichto> like you can't even deduce anything from that
[01:04:47] <strcat> it's a good argument for not having extra::bigint though
[01:04:53] <strcat> these integers aren't even that big
[01:05:18] <strcat> gmp gets asymptotically faster if you use bigger and bigger ones
[01:05:21] <brson> it's not a good argument for not having extra::bigint. it may be a good argument for having a good extra::bigint
[01:05:31] <dbaupp> http://benchmarksgame.alioth.debian.org/u64/benchmark.php?test=fasta&lang=all&lang2=gpp&data=u64 is nicer :)
[01:05:43] <strcat> brson: I don't think it's realistic to catch up to gmp though
[01:05:53] <strcat> i.e. even python ends up 100x slower if you get big enough
[01:05:56] <strcat> with their mature bigints
[01:06:04] <strcat> and haskell
[01:06:09] <acrichto> dbaupp: whoa!
[01:06:17] <acrichto> that's awesome!
[01:06:43] <SiegeLord> You need bigint support to print floats properly :P
[01:06:45] <acrichto> seems odd that c++ is faster than c...
[01:06:53] <SiegeLord> So bigint might have to be in std ;)
[01:06:53] <strcat> acrichto: it's just whatever was submitted ;p
[01:07:02] <strcat> acrichto: you can consider C to mean "C or C++"
[01:07:25] <acrichto> does kinda break the credibility a little bit...
[01:07:32] <strcat> acrichto: I think C++ is allowed to use boost
[01:07:45] <strcat> so sometimes there are really mature libs
[01:07:51] <acrichto> good ol' boost
[01:08:09] <strcat> it doesn't show the rust source
[01:08:18] <strcat> ;s
[01:09:07] <brson> i think these benchmarks are really encouraging
[01:09:52] <strcat> I think rust could be at the top thanks to LLVM
[01:10:02] <pcwalton> this is mostly clang versus gcc :P
[01:10:19] <strcat> yeah but might as well abuse it to say rust is faster than C if we can ;p
[01:10:19] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[01:10:19] *** ChanServ sets mode: +ao dherman dherman
[01:10:26] <strcat> s/say/imply/
[01:10:58] * pcwalton didn't know Intel made a Fortran compiler
[01:11:22] <strcat> pcwalton: when people say fortran is fast, afaik they mean 'intel's fortran compiler is fast' :)
[01:11:30] <pcwalton> heh
[01:16:52] *** kimundi is now known as zz_kimundi
[01:17:25] *** Quits: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca) (Quit: canhtak)
[01:18:51] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:18:51] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 147746ab9 to 14faee3ff: 02http://git.io/k471pw
[01:18:52] <ghrust> 13rust/06try 148c763c7 15Daniel Micay: libc: switch `free` to the proper signature...
[01:18:52] <ghrust> 13rust/06try 147eb0270 15Daniel Micay: vec: make unsafe indexing functions higher-level
[01:18:52] <ghrust> 13rust/06try 14aefbb49 15Daniel Micay: add new vector representation as a library
[01:18:53] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:21:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:21:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c1eb17f to 14fce7922: 02http://git.io/N3iJvQ
[01:21:36] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:21:36] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[01:21:36] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/Tz0TWg
[01:21:36] <ghrust> 13rust/06auto 14102f490 15bors: auto merge of #11682 : thestinger/rust/vector, r=brson...
[01:21:37] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[01:25:35] <ktt3ja> hmm... I can't write tests for this since the test expects the note at the beginning of the span, whereas my `custom_span_note` puts the borrow at the end of the span... https://github.com/mozilla/rust/pull/11718
[01:25:51] <ktt3ja> s/borrow/arrow/
[01:28:56] <dbaupp> r? https://github.com/mozilla/rust/pull/11738 (I mentored, hence not reviewing myself :) )
[01:31:44] *** Quits: gwty (gwtypc@CE39F0FC.547B6514.137C914F.IP) (Connection reset by peer)
[01:35:41] *** Quits: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw) (Ping timeout)
[01:36:16] *** Joins: jyyou (jyyou@28A2398D.56303981.3A70C586.IP)
[01:36:17] <strcat> https://github.com/mozilla/rust/pull/11739 r?
[01:37:37] <acrichto> strcat: while you're at it, could you update the manpages?
[01:37:43] <strcat> hm
[01:37:44] <acrichto> looks like there's an rc extenion in man/rustc.1
[01:37:49] <strcat> oh
[01:38:12] <acrichto> just rc => rs
[01:38:40] <strcat> acrichto: done
[01:39:28] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:41:49] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[01:43:53] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[01:44:54] *** Joins: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca)
[02:01:40] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:01:40] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/RcMpPQ
[02:01:40] <ghrust> 13rust/06auto 14e3949b2 15bors: auto merge of #11682 : thestinger/rust/vector, r=brson...
[02:01:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:02:38] <Luqman> acrichto: mind taking a look again? https://github.com/mozilla/rust/pull/11732
[02:03:50] <acrichto> Luqman: oh heh you didn't have to go all out with a GetAddrInfoRequest, but no worries
[02:04:26] <Luqman> acrichto: well, i just named it getaddrinfo at first but that's what the function in the extern block is also called so :P
[02:04:37] <acrichto> hehe
[02:05:29] <acrichto> Luqman: nice work! wanna run it through try before bors?
[02:05:32] <acrichto> just to see if windows works
[02:05:33] <acrichto> mainly
[02:05:41] <Luqman> sure
[02:05:47] <acrichto> r=me on success though
[02:05:58] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:05:59] <ghrust> 01[13rust01] 15luqmana 04force-pushed 06try from 14faee3ff to 14e0a568a: 02http://git.io/k471pw
[02:05:59] <ghrust> 13rust/06try 145aa31c4 15Luqman Aden: libnative: Implement get_host_addresses.
[02:05:59] <ghrust> 13rust/06try 14e0a568a 15Luqman Aden: libstd: Use iotest! for for get_host_addresses.
[02:05:59] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:09:28] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:15:56] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[02:19:00] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:19:00] *** ChanServ sets mode: +ao dherman dherman
[02:39:52] <dbaupp> acrichto: can you delete the r+ on https://github.com/mozilla/rust/pull/11738 ? Unfortunately https://github.com/mozilla/rust/issues/11741 got in our way
[02:40:09] <dbaupp> (just going to xfail the test for now...)
[02:41:44] <acrichto> deleted
[02:41:56] <acrichto> dbaupp: feel free to r=you whenever you see fit
[02:42:33] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[02:42:36] <nate> jld: ok, cool. should the align_of and element_offset functions in trans::machine also return u64's?
[02:44:44] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[02:46:37] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:46:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e3949b2 to 14fce7922: 02http://git.io/N3iJvQ
[02:46:37] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:46:37] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:46:37] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/lozOnA
[02:46:37] <ghrust> 13rust/06auto 14530909f 15Alex Crichton: Implement std::rt::at_exit...
[02:46:37] <ghrust> 13rust/06auto 1440b3e91 15Alex Crichton: Implement native timers...
[02:46:37] <ghrust> 13rust/06auto 143dbd0f0 15bors: auto merge of #11294 : alexcrichton/rust/native-timer, r=brson...
[02:46:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:47:28] <sfackler> acrichto: can error-pattern match against the code sample or just the message?
[02:48:04] <acrichto> it's probably just the error message sadly
[02:48:09] <acrichto> which hm may not be that useful
[02:48:12] <sfackler> yeah
[02:48:27] <acrichto> oh well, I'll trust you
[02:48:35] <sfackler> I'm going to make an rpass tests with some larger macros and then call it a day
[02:49:01] <acrichto> want me to hold off the r+?
[02:49:44] <sfackler> eh, go for it if you want
[02:50:47] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:50:56] <acrichto> brson: if we're getting an llvm upgrade, we may want to go ahead and rebase
[02:51:05] <strcat> pcwalton: btw I think we could remove auto-slicing without a lot of pain... just need the indexing traits + implement the slice methods on ~[T] too via a generic impl
[02:51:27] <strcat> and then you wouldn't have the weird situation where foo(xs) with a vector doesn't use value semantics
[02:51:45] <strcat> would just as_slice on a few parameters
[02:52:22] * strcat will open an issue
[02:53:36] <jld> nate: I think so?
[02:54:42] <dbaupp> strcat: we'd need autoslicing for [,..] still (I think)
[02:54:52] <strcat> dbaupp: true
[02:54:59] <strcat> at least until we are able to impl methods on it
[02:55:13] <brson> acrichto: possibly, yeah
[02:55:27] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[02:55:54] <acrichto> brson: I did it about a week ago and it was a clean rebase, so there probably won't be too many problems
[02:56:20] <strcat> dbaupp: hmmm....
[02:56:26] * strcat will think about it more
[02:56:49] <brson> bbl
[03:00:19] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[03:01:41] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:01:41] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/RYDCMA
[03:01:41] <ghrust> 13rust/06auto 1497be99b 15Daniel Micay: libc: switch `free` to the proper signature...
[03:01:41] <ghrust> 13rust/06auto 14ce7d4fa 15Daniel Micay: vec: make unsafe indexing functions higher-level
[03:01:41] <ghrust> 13rust/06auto 1412a9688 15Daniel Micay: add new vector representation as a library
[03:01:42] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:15:15] *** Quits: jdm (jdm@moz-C07D5168.p2p.sfo1.mozilla.com) (Ping timeout)
[03:17:20] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Client exited)
[03:17:42] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[03:19:27] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[03:23:55] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[03:37:16] *** Quits: zz_kimundi (kimundi@moz-E1616236.dip0.t-ipconnect.de) (Ping timeout)
[03:41:13] *** Joins: zz_kimundi (kimundi@moz-8F8F3513.dip0.t-ipconnect.de)
[03:41:15] *** zz_kimundi is now known as kimundi
[03:43:20] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[03:45:25] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[03:46:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[03:46:31] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145ba49d5 to 14fce7922: 02http://git.io/N3iJvQ
[03:46:31] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[03:55:13] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:55:13] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14e0a568a to 14992e67b: 02http://git.io/k471pw
[03:55:13] <ghrust> 13rust/06try 14431eac1 15Alex Crichton: Implement clone() for TcpStream and UnixStream...
[03:55:13] <ghrust> 13rust/06try 14992e67b 15Alex Crichton: Document the TCP module
[03:55:13] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[04:03:35] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:03:35] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14992e67b to 144bc8b12: 02http://git.io/k471pw
[04:03:35] <ghrust> 13rust/06try 144bc8b12 15Alex Crichton: Document the TCP module
[04:03:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:11:57] <sfackler> acrichto: is there any way to pass along -L arguments to rustdoc tests?
[04:12:26] <acrichto> I thought the rustdoc tests just ran the command line manually?
[04:13:03] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[04:13:04] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 144bc8b12 to 14aed38ff: 02http://git.io/k471pw
[04:13:04] <ghrust> 13rust/06try 14aed38ff 15Alex Crichton: Document the TCP module
[04:13:04] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[04:13:35] <sfackler> I may have just forgotten to build >_>
[04:13:48] <sfackler> yep
[04:13:56] *** Quits: ktt3ja (ktt3ja@moz-85E2770C.hsd1.va.comcast.net) (Quit: Leaving)
[04:15:15] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:17:03] <sfackler> hmm, is it possible to use #[feature(foo)]; with rustdoc tests?
[04:17:26] <acrichto> oh rust*doc* test
[04:17:28] <sfackler> it looks like it automatically inserts extern mod statements before the test string
[04:17:33] <sfackler> yeah
[04:17:34] <acrichto> I thought you were talking about rustpkg
[04:17:40] <acrichto> hm
[04:17:41] <sfackler> oh, no
[04:17:47] <acrichto> I think it injects extern mod extra;
[04:17:51] <sfackler> the extern mod injection seems pretty sketchy
[04:18:05] <dbaupp> you can put your own extern mod extra in there, right?
[04:18:06] <acrichto> there's some sketchy logic for doc/ now
[04:18:19] <acrichto> yeah it should probaly not inject extra anyway
[04:18:27] <sfackler> dbaupp: yeah, but if the test string contains "extra" it shoves "extern mod extra" in at the top
[04:18:27] <dbaupp> (like, first line is `# extern mod extra;` and that will stop the default injection.)
[04:18:37] <acrichto> sfackler: but no, you can't pass -L to rustdoc
[04:18:42] <dbaupp> oh, srsly? that's weird :P
[04:18:46] <sfackler> acrichto: looks like it works?
[04:18:54] * acrichto is amazed
[04:18:57] <sfackler> rustdoc --test -L build -L submodules/rust-phf/build -L submodules/rust-openssl/build lib.rs
[04:19:04] <acrichto> what
[04:19:07] <acrichto> oh that way
[04:19:07] <acrichto> ah
[04:19:18] <acrichto> lol 
[04:19:29] <acrichto> so you can do this
[04:19:32] <acrichto> with #[feature]
[04:19:35] <acrichto> # #[feature]
[04:19:38] <acrichto> # extern mod extra;
[04:19:41] <acrichto> # extern mod mycrate;
[04:19:42] <acrichto> code()
[04:19:50] <Luqman> acrichto: so, gai_strerror is an inline function in a header in mingw32 :/
[04:19:51] <acrichto> "just a little sketchy"
[04:19:56] <acrichto> Luqman: of coures
[04:20:00] <acrichto> courese*
[04:20:24] <acrichto> __AW(gai_strerror) what
[04:20:24] <Luqman> but, it isn't in mingw64
[04:20:29] <sfackler> acrichto: it looks to me like this chunk is going to mess it up: https://github.com/mozilla/rust/blob/master/src/librustdoc/test.rs#L144-L149
[04:20:51] <acrichto> Luqman: looks like it's gai_strerrorA
[04:21:05] <acrichto> sfackler: yeah
[04:21:10] <acrichto> sfackler: oh wait hm
[04:21:12] <acrichto> you can't disable that
[04:21:17] <sfackler> yeah
[04:21:22] <acrichto> yeah that should probably be configurable somehow...
[04:21:33] <sfackler> or just remove that part?
[04:21:44] <acrichto> the cratename can't get removed
[04:21:45] <Luqman> acrichto: well it is, but in a header
[04:21:46] <acrichto> extra can get removed
[04:21:47] <Luqman> acrichto: http://sourceforge.net/p/mingw/mingw-org-wsl/ci/master/tree/include/ws2tcpip.h#l321
[04:21:48] <strcat> is gai_strerror thread-safe?
[04:21:54] <strcat> I assume it is
[04:21:56] <acrichto> Luqman: ugh, that's annoying, feel free to make a C shim
[04:22:08] <strcat> it's super annoying that normal strerror isn't though
[04:22:13] <sfackler> acrichto: why can't people just do # extern mod mycrate;?
[04:22:14] <acrichto> it calls FormatMessage
[04:22:15] <strcat> and I wouldn't be surprised if gai_strerror wasn't
[04:22:17] <strcat> stupid locales.
[04:22:32] <strcat> it dynamically loads/unloads locale crap so it can invalidate old strerror strings ;s
[04:22:34] <acrichto> sfackler: that'd need to be injected to literally every code example though which seems kinda painful
[04:22:34] <dbaupp> sfackler: because every code example would require it?
[04:22:47] <dbaupp> sfackler: and also you can't have extern mod directly inside a function
[04:22:52] <sfackler> oh yeah
[04:22:56] <dbaupp> sfackler: so every example would need fn main() {}
[04:23:03] <acrichto> Luqman: another option would be to copy the header file
[04:23:11] <acrichto> Luqman: I don't think it's changing that often
[04:23:12] <Luqman> strcat: it isn't thread safe on windows at least
[04:23:19] <sfackler> I guess I could just add every single feature gate to the prog string :P
[04:24:18] <strcat> acrichto: what do you think about adding the list of symbols marked as non-thread-safe in POSIX to a lint of extern stuff? maybe it's a silly idea
[04:24:48] <strcat> so it will yell at a call site and you remember to put a lock and silence it at the call site
[04:25:13] * strcat has a feeling we screw this up in at least a few places
[04:25:28] <acrichto> strcat: could we not emit the lint without an annotation?
[04:25:47] <strcat> acrichto: well I was thinking the lint would have this list internally
[04:25:56] <acrichto> oh just for libstd?
[04:25:59] <strcat> just copy-paste from POSIX 2008
[04:26:08] <strcat> acrichto: well, everywhere, just based on extern symbol names
[04:26:38] <acrichto> hm, but everywhere we used these functions we'd have to have #[allow(not_threadsafe_c_functions)] ?
[04:27:21] <strcat> acrichto: yes, since they generally shouldn't be used
[04:27:33] <strcat> you'd mark a specific function as allowing it and you'd have to use something like a lock
[04:27:40] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:27:55] <acrichto> I'd be curious if we have a number of these as-is today
[04:28:12] <strcat> we probably too, lots of stuff isn't thread-safe ;p
[04:28:16] <acrichto> it sounds like something we'd want part of our build process rather than baked into rustc though
[04:28:40] <acrichto> only b/c it forcibly has false positives
[04:28:53] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[04:29:16] <dbaupp> acrichto: why? people other than rustc hackers will like warnings about this
[04:29:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[04:29:35] <acrichto> the 100% false positive rate worries me
[04:29:42] <dbaupp> 100%?
[04:29:55] <acrichto> the compiler can't figure out if you're accessing the function safely
[04:30:03] <acrichto> you have to use an attribute to tell the compiler to be quiet
[04:30:17] <strcat> acrichto: pretty much like warn_unused_result
[04:30:26] <strcat> in most cases with this the compiler will be right
[04:30:29] <aatch> acrichto, isn't that fundamentally the same as unsafe anyway?
[04:30:32] <acrichto> well that's why we don't have warn_unused_result right now
[04:30:36] <strcat> there should probably be 1 call site in the entire codebase, protected by a lock, if any
[04:30:38] <acrichto> it is kinda
[04:30:45] <acrichto> what's the list of functions?
[04:31:06] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:32:17] <strcat> acrichto: http://ix.io/a4p in C/POSIX
[04:32:27] <strcat> but there are more platform-specific ones we have exposed
[04:32:33] <strcat> er sorry
[04:32:35] <strcat> wrong list
[04:32:37] <strcat> lol
[04:32:52] <strcat> acrichto: http://ix.io/a4q here
[04:32:53] <acrichto> accept()
[04:32:56] <acrichto> that would be terrifying
[04:33:30] <strcat> http://pubs.opengroup.org/onlinepubs/007908799/xsh/threads.html really ancient version, can't find it in POSIX 2008 so I used the linux doc (which refers to POSIX)
[04:34:31] <strcat> ones like getpwent are particularly bad
[04:34:31] <acrichto> it doesn't seem that bad
[04:34:34] <acrichto> adding the lint
[04:34:56] <acrichto> do most of the functions not have threadsafe variants?
[04:35:06] <aatch> acrichto, most of them *do*
[04:35:07] <sfackler> acrichto: I'm not totally sure I'm on board with making TcpStream clonable. It seems like just structs TcpWriter and TcpReader that wrap the internally clonable RtioWhatever is a safer interface
[04:35:10] <strcat> acrichto: well, most have widely available but non-standard thread-safe variants
[04:35:29] <strcat> acrichto: so if someone adds something like user info support, it would be really good to yell about it
[04:35:37] <strcat> so they remember to use the per-platform thread-safe versions
[04:35:48] <acrichto> sfackler: the selling point for me was A) fewer traits, and B) almost 0 cognitive burden
[04:36:00] <acrichto> strcat: eh, then sounds like too much effort to recommend a threadsafe variant
[04:36:16] <strcat> acrichto: well, they're usually just foo_r
[04:36:19] <strcat> lots are POSIX standard
[04:36:24] <aatch> re-entrant!
[04:36:25] <dbaupp> acrichto: it'll remind them to go and find the name of the threadsafe version
[04:36:28] <strcat> most are identical across platforms when POSIX doesn't specify it
[04:36:30] <sfackler> acrichto: why would there be more traits?
[04:36:52] <acrichto> sfackler: I guess there wouldn't be more traits, but there would definitely be more types
[04:36:54] <strcat> acrichto: we only support freebsd/linux/osx atm and those three are basically identical when it comes to this
[04:37:02] <strcat> it's when you need to support solaris/aix/hpux that it may be weird
[04:37:07] <acrichto> sfackler: which we're generally shying away from i.e. the Chan/SharedChan merge
[04:37:27] <sfackler> just struct TcpReader { inner: ~RtioTcpStream } and struct TcpWriter { inner: ~RtioTcpStream }
[04:37:35] <acrichto> strcat: yeah sounds like a lint seems not that bad
[04:37:48] <acrichto> sfackler: yeah, but you'd still have to define all the wrapper tcp inspection things
[04:38:27] <sfackler> is there anything other than peer_name and socket_name?
[04:38:35] <strcat> acrichto: example: libnative uses readdir
[04:38:38] <strcat> acrichto: needs readdir_r
[04:38:47] <acrichto> oops
[04:39:06] <strcat> anyway it's too hard to remember without a lint
[04:39:17] <acrichto> I agree
[04:39:35] <aatch> given that I've never heard of half the list, and most of the rest have thread-safe variants, I doubt people will hit it that often.
[04:40:07] <strcat> aatch: readdir! and the old name resolve ones
[04:40:09] <strcat> and the time ones
[04:40:20] <strcat> anyway the issue is that people default to the "easy" one without a weird output parameter
[04:41:00] <strcat> since you'll probably find it first ;p
[04:41:31] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:41:31] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/i5Q3lQ
[04:41:31] <ghrust> 13rust/06auto 14530909f 15Alex Crichton: Implement std::rt::at_exit...
[04:41:31] <ghrust> 13rust/06auto 14b8e4383 15Alex Crichton: Implement native timers...
[04:41:32] <ghrust> 13rust/06auto 147ea063e 15bors: auto merge of #11294 : alexcrichton/rust/native-timer, r=brson...
[04:41:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:41:48] <aatch> strcat, oh I get that, I meant more that it's not like you have to do all sorts of weird locking and/or add an attribute in order to get it to work most of the time.
[04:41:48] <strcat> lots of weird ephemeral failures today ;[
[04:41:52] <strcat> ah, yeah
[04:42:16] <strcat> acrichto: one day I'll comprehend why POSIX hash tables exist
[04:42:17] <aatch> changing to the re-entrant version is normally fairly easy.
[04:42:37] <strcat> literally the worst API I've ever seen in a library
[04:42:54] <strcat> hcreate/hsearch/hdestroy
[04:43:07] <strcat> well, it's more like "POSIX hash *table*" (no 's') as you have 1 per program
[04:43:12] <strcat> and the size is static, it can't grow
[04:43:20] <strcat> and not thread safe ofc
[04:43:29] <sfackler> haha, and it can only take string keys, right?
[04:43:43] <strcat> sfackler: yeah, NUL-terminated strings
[04:43:48] <strcat> not bytes + length
[04:43:54] <strcat> it's seriously disgusting
[04:44:30] <sfackler> you've really got to wonder how the committee sat down and said "yes, this is a good thing. We should put it into POSIX"
[04:44:50] <acrichto> sfackler: what's your main concern about clone() w/ tcp streams?
[04:45:20] <strcat> sfackler: there are also POSIX treemaps but they appear to be thread-safe and take a comparison function
[04:45:33] <strcat> they are unbalanced though
[04:45:43] <aatch> I mean some of it is understandable, but why on earth would you decide to make it fixed-size?!
[04:46:01] <sfackler> acrichto: I liked the way it still gave you the guarantee you only had one task reading or writing on any connection
[04:46:08] <strcat> aatch: well, fixed-size kind of makes sense, if you could at least make more than 1 internal global instance
[04:46:26] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[04:46:29] <strcat> aatch: as it could let you do memory management yourself
[04:46:41] <acrichto> sfackler: in terms of an invariant you know you only have one reader and one writer?
[04:46:46] <sfackler> yeah
[04:47:06] <strcat> aatch: anyway the API they use even does memory allocation internally
[04:47:10] <sfackler> you'd either have a) one TcpStream or b) one TcpReader and one TcpWriter
[04:47:12] <strcat> aatch: despite being fixed-size
[04:47:17] <strcat> aatch: since you call hcreate(size)
[04:47:19] <aatch> strcat, that's my point.
[04:47:51] <aatch> If it was fixed size, but you controlled that memory, it would be merely *bad*
[04:48:05] <acrichto> sfackler: but what if you're using a library that takes a TcpStream, but you only want to give it the Reader?
[04:48:33] <strcat> aatch: *shrug*
[04:48:38] <strcat> aatch: srand/rand are pretty bad too
[04:48:45] <strcat> so they added rand_r with an unsigned int seed
[04:48:52] <strcat> which is almost always 32-bit, so it's incredibly small
[04:49:09] <strcat> looks like they deprecated rand_r but not rand/srand
[04:49:13] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:49:13] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14aed38ff to 147fe06c2: 02http://git.io/k471pw
[04:49:13] <ghrust> 13rust/06try 14fee4732 15Alex Crichton: Implement clone() for TcpStream and UnixStream...
[04:49:13] <ghrust> 13rust/06try 147fe06c2 15Alex Crichton: Document the TCP module
[04:49:13] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:49:16] <sfackler> acrichto: as in you want to give it specifically a Reader + TCP stuff?
[04:49:26] <aatch> strcat, I just noticed that
[04:49:41] <acrichto> sfackler: perhaps, I'm not sure why you'd write a library that took a TcpStream and only a TcpStream, but I could imagine that it's plausible
[04:49:59] <strcat> aatch: anyway hard to comprehend why a bunch of hopefully smart people can't sit down and make a sane API for *that*
[04:50:01] <acrichto> sfackler: as in you know that the library only ever reads, but you want to be able to write as well
[04:50:14] <strcat> aatch: oh and POSIX locking is totally, utterly broken
[04:50:17] <sfackler> it should take a reader then! :P
[04:50:24] <strcat> aatch: BSD locking API is pretty broken too
[04:50:40] <strcat> there's no working file locking API on linux, OS X, windows, or freebsd
[04:50:41] <sfackler> and if it's reading, you _definitely_ don't want to be reading at the same time
[04:51:11] <sfackler> i'm also not sure how a clonable TcpStream would make this case any better?
[04:51:12] <strcat> aatch: I actually have 2 good blog posts bmarked about that ;p
[04:51:37] <aatch> I think I've read about some of the issues too.
[04:51:46] <acrichto> sfackler: I opted for cloning because a clone is such a common concept, whereas a split is seen nowhere else
[04:51:57] <strcat> aatch: https://www.samba.org/samba/news/articles/low_point/tale_two_stds_os2.html http://0pointer.de/blog/projects/locking.html http://0pointer.de/blog/projects/locking2
[04:52:02] <aatch> Like they all have file locking, but each is broken in subtle and different ways that makes it nigh-impossible to deal with, right?
[04:52:07] <strcat> aatch: yup!
[04:52:48] <sfackler> acrichto: chans and ports are kind of automatically split
[04:53:03] <acrichto> sfackler: you don't ever really fork them though
[04:53:12] <acrichto> I guess it is kinda similar though
[04:53:12] <sfackler> I mean, they come that way
[04:53:17] <sfackler> separate objects for reading and writing
[04:53:34] <acrichto> that's a good point
[04:53:41] <sfackler> imo it's a much easier sell to make chans/ports clonable since you don't have the framing issue
[04:54:04] <strcat> aatch: anyway there aren't even non-portable ways to do it sanely
[04:54:11] <strcat> so it's one of the best flaws of the computing world
[04:54:23] <cmr> what, file locking?
[04:54:39] <strcat> your best best is to make your own lock file and hope it's a screwed up network file system
[04:54:41] <strcat> cmr: yep
[04:54:45] <cmr> yeah.
[04:55:16] <strcat> if your progress dies, wooo, deadlock
[04:55:27] <strcat> you could put the pid in it to kill it, but now you have a really bad race condition
[04:55:46] <sfackler> acrichto: another option is to make connect return a (TcpReader, TcpWriter) :P
[04:55:47] <strcat> since signals between processes is basically a broken idea
[04:55:54] <sfackler> but that seems kind of silly
[04:55:57] <strcat> need pipes/sockets
[04:56:31] <acrichto> sfackler: perhaps, but yeah I think of a tcp stream as one object conceptually
[04:56:40] <sfackler> so do I
[04:56:52] <sfackler> I was kidding about the last one
[04:57:13] <sfackler> I guess if you implemented Stream for (TcpReader, TcpWriter) it would be usable-ish
[04:57:20] <acrichto> lol
[04:57:29] <acrichto> we may have that actually...
[04:57:43] <strcat> cmr: anyway this kind of stuff is why systemd exists... here's to hoping that debian switches to it in their current vote thing ;p
[04:57:49] <sfackler> there is still the impl Stream for Option<Stream> silliness
[04:57:49] <strcat> (looks like they will)
[04:58:12] <sfackler> or wahtever it is
[04:58:57] *** Quits: new_one (new_one@AB0375ED.32E41C6F.B3C0173E.IP) (Client exited)
[04:58:59] <acrichto> sfackler: that I still really like though
[04:59:11] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:59:16] <strcat> cmr: going to get stuff like a cgroup per .desktop file soon ;p
[04:59:31] <acrichto> sfackler: https://github.com/alexcrichton/rust/blob/bd5ecb3a699ff71e4257f1000d67f427ce4a6dc0/src/libstd/io/net/tcp.rs#L41-L46
[05:00:27] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[05:03:02] <strcat> cmr: and totally new dbus server + client! with a really nice API ;p
[05:03:13] <strcat> well, the server is the kernel
[05:03:36] <strcat> can have new rust dbus bindings ;), instead of horrific libdbus
[05:03:56] <strcat> I started down that path and gave up
[05:05:46] <aatch> Wow, somebody actually fixed the stupid "close any fd and any locks on that file are removed" behaviour in their kernel and literally nothing broke.
[05:06:00] <aatch> There was one message in the log, it was a bug in that program.
[05:06:22] <strcat> aatch: linux will probably do it
[05:06:29] <strcat> they care less about POSIX now
[05:06:44] <strcat> for example, fs.protected_hardlinks/fs.protected_symlinks exist now
[05:06:52] <strcat> they break POSIX but make the OS security sane
[05:07:01] <strcat> systemd enables them by default
[05:07:15] <strcat> they could add a sane_lock sysctl setting ;p
[05:07:22] <cmr> strcat: meh, I don't really have any interest in modern linux anymore.
[05:07:25] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[05:07:29] <strcat> cmr: why? ;p
[05:07:39] <cmr> strcat: because my OS will totes be better!
[05:07:45] <cmr> (such sarcasm)
[05:08:33] <strcat> and ubuntu will be the only mainstream distro without systemd and they enable sane hardlinks/symlinks too ;p
[05:09:52] *** Quits: nate (pinkeh@moz-B8462C56.members.linode.com) (Quit: .)
[05:11:11] <strcat> cmr: just make sure to not support POSIX :)
[05:11:16] *** Quits: Kxepal (Miranda@moz-83916904.pppoe.mtu-net.ru) (Ping timeout)
[05:13:38] *** Quits: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Ping timeout)
[05:14:45] *** Joins: Kxepal (Miranda@moz-20E4E5C2.pppoe.mtu-net.ru)
[05:19:59] *** Quits: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca) (Quit: canhtak)
[05:27:14] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:27:14] *** ChanServ sets mode: +ao dherman dherman
[05:36:09] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:37:08] *** Joins: brson (brson@moz-D434EC03.dsl.sca.megapath.net)
[05:37:08] *** ChanServ sets mode: +qo brson brson
[05:37:44] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[05:45:39] *** Quits: brson (brson@moz-D434EC03.dsl.sca.megapath.net) (Ping timeout)
[05:54:56] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:55:46] *** Joins: brson (brson@moz-D434EC03.dsl.sca.megapath.net)
[05:55:46] *** ChanServ sets mode: +qo brson brson
[05:56:32] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:56:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/i5Q3lQ
[05:56:32] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:58:03] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[05:59:46] <strcat> acrichto: does rustc actually build with --disable-rpath? used to break when it wasn't used during the build
[06:00:11] <acrichto> lol that was fast
[06:00:11] <strcat> ah a comment
[06:01:29] <strcat> acrichto: my wm shows the workspace as red and the window border as red on notices so... I often read emails and irc pings nearly instantly ;p
[06:01:30] <cmr> is the fail_ lang item used for all non-boundscheck failure?
[06:01:35] <strcat> cmr: no
[06:01:39] <cmr> k
[06:01:43] <strcat> sec
[06:01:44] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:01:44] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/D9u59g
[06:01:44] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:02:03] <strcat> cmr: it's used on / 0 and % 0
[06:02:11] <strcat> ah wait the @mut failures are gone
[06:02:12] <cmr> so useful ;(
[06:02:14] <strcat> maybe it does
[06:03:07] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[06:03:08] <strcat> acrichto: also made it beep if and only if I have a fullscreen thing open
[06:03:18] * strcat pondered making it turn on the thinklight
[06:03:31] <cmr> is that really what it's called? the thinklight?
[06:03:42] <strcat> cmr: yes the light on thinkpads above the screen
[06:03:46] <strcat> they've killed it off now though
[06:03:47] <cmr> lol
[06:03:55] * strcat likes it :(
[06:03:59] <strcat> can use it for notifications
[06:04:07] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[06:04:08] <strcat> make it turn on for notify, and off when you deal with it
[06:04:27] <strcat> the only other user-facing lights on the t530 are the disk activity one and the wifi one
[06:04:29] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[06:04:41] <strcat> low battery notifier is on the *back* of the screen ;\
[06:04:47] <cmr> super useful!
[06:04:49] <strcat> well
[06:04:59] <strcat> I could abuse the led used for mute, mic mute or the power led
[06:05:11] <strcat> the power led might actually be a good one to do
[06:05:23] <strcat> doesn't tell you anything useful other than "I'm asleep, not shut down"
[06:05:36] <cmr> disk activity is pretty useless too imo
[06:05:45] <cmr> usually I can *feel* the disk activity under my hands.
[06:05:49] <strcat> cmr: ssd
[06:05:52] <cmr> and for ssds who cares
[06:05:56] <acrichto> oh disk activity has always been my #1 diagnosis for any slowdown
[06:06:06] <acrichto> I've found that 99% of my slowdowns are b/c of high disk activity
[06:06:12] <strcat> acrichto: iotop is nice btw ;p
[06:06:18] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Quit: Textual IRC Client: www.textualapp.com)
[06:06:20] <strcat> much less so with an SSD though
[06:06:36] * acrichto has his mind blown
[06:06:44] <cmr> iftop is nice too
[06:07:10] <strcat> since instead of 100 I/O ops per second you get 100k
[06:07:45] <strcat> and 500MB/s read/write instead of 100...
[06:07:48] <strcat> cmr: meh
[06:07:51] <strcat> cmr: nethogs <3
[06:07:54] * cmr googles
[06:07:57] <strcat> iftop doesn't show applications
[06:08:16] <cmr> yeah but usually I can tell by the other hostname.
[06:08:31] <strcat> cmr: both are useful ;)
[06:08:38] <cmr> ohh nethogs looks really nice
[06:08:54] <strcat> cmr: systemd-cgtop is really nice too
[06:09:03] <strcat> once applications are nicely in cgroups... mmmm
[06:09:22] *** Quits: dbaupp (Thunderbir@32742E97.D5A1DCF.37681C44.IP) (Ping timeout)
[06:09:36] * strcat likes using it to watch the build mem usage
[06:09:55] <cmr> yeah I use it to monitor the builder + bencher
[06:10:20] <strcat> cmr: http://ix.io/7lx the non-deprecated way of making cgroups btw ;p
[06:10:36] <cmr> oh yay code
[06:10:44] <cmr> will port bencher as soon as it breaks.
[06:10:52] <strcat> cmr: it won't actually *break* for a while
[06:10:52] <cmr> :p
[06:10:57] <cmr> good! less work for me.
[06:11:01] <strcat> cmr: but this is nice since it cleans up automatically when you're done
[06:11:10] <cmr> yeah I use a context manager for that ;p
[06:11:13] <strcat> can't have leftover files if it exits early
[06:11:21] <strcat> cmr: ctrl-c
[06:11:25] <strcat> ;p
[06:11:41] <cmr> fair enough
[06:11:51] <strcat> cmr: well, the deprecated way will stay around for a *long* time outside of systemd/upstart
[06:12:05] <strcat> but if you use them, /sys/fs/cgroup/ will soon be read-only afaik
[06:13:01] * strcat has to port playpen to it
[06:13:16] <strcat> waiting til I can use sd-bus instead of awful libdbus/glib ;p
[06:14:08] <strcat> libdbus even apologizes for being so awful in the docs, many times :(
[06:14:28] <strcat> and asks you to please use glib/qt instead...
[06:15:29] <strcat> I have a failed rust-dbus using it, got too painful
[06:18:42] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:34:26] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[06:34:26] *** ChanServ sets mode: +ao pcwalton pcwalton
[06:34:33] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:35:53] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[06:46:27] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[07:10:00] *** Joins: dbaupp (Thunderbir@moz-A840EB3D.lns20.syd6.internode.on.net)
[07:16:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:16:36] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AnpE1g
[07:16:36] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:21:40] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:21:40] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/7fHB2w
[07:21:40] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:26:33] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:26:33] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/7fHB2w
[07:26:33] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:26:34] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:26:34] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/Y49bng
[07:26:34] <ghrust> 13rust/06auto 14802d41f 15Daniel Micay: libc: switch `free` to the proper signature...
[07:26:34] <ghrust> 13rust/06auto 1417d23b8 15Daniel Micay: vec: make unsafe indexing functions higher-level
[07:26:34] <ghrust> 13rust/06auto 141798de7 15Daniel Micay: add new vector representation as a library
[07:26:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:42:07] <acrichto> strcat: lol #11682 has the head commit in the middle of the commits
[07:42:09] <acrichto> go github
[07:42:32] <strcat> acrichto: I don't understand why either
[07:42:43] <strcat> it's all jumbled from when I split that commit into 3 commits
[07:43:06] <acrichto> "but chronological!"
[07:43:22] <strcat> do they actually use the authored date instead of the commit date?
[07:43:37] * strcat shrugs :)
[07:43:52] <strcat> if they do, you could hit it just via cherry-pick...
[07:44:08] <strcat> acrichto: it also put the comment before the commits
[07:44:16] <strcat> acrichto: they intend to do that in chronological order too
[07:44:23] <strcat> apparently it doesn't work
[07:44:39] <strcat> anyway beats me why they *want* it to be broken like this
[07:44:55] <acrichto> yeah...
[07:51:42] *** Joins: jdm (jdm@moz-BDD802ED.hfc.comcastbusiness.net)
[07:56:11] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[07:56:41] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:57:34] <eddyb> nmatsakis: morning :)
[07:58:31] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[08:02:30] <eddyb> nmatsakis: sorry for the excess extra refactoring, I tend to go OCD on small and medium sized blocks
[08:12:03] *** flaper87|afk is now known as flaper87
[08:14:19] <eddyb> cmr: this is even more deterministic, though it streams tons of strings before reaching the bad function. I can't go on without wondering how much memory we use to store strings
[08:17:35] <eddyb> cmr: err, I forgot to link it: https://gist.github.com/eddyb/085b994bf27d5d549e70
[08:17:59] <eddyb> #llvm is like "go build Debug already" ignoring the fact that this took me only a few minutes
[08:19:25] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[08:21:58] *** Quits: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com) (Ping timeout)
[08:22:48] *** Joins: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com)
[08:27:37] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[08:27:55] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Quit: Leaving...)
[08:28:37] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:28:37] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:28:46] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:39:41] <eddyb> this is very interesting... (NodeId, Span, Ident) is what causes that LLVM problem, nothing else
[08:40:02] <eddyb> if I remove NodeId or Ident, it compiles fine
[08:40:12] <eddyb> Span has an interesting nested structure to it
[08:41:40] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:41:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/Y49bng
[08:41:40] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:44:01] <eddyb> https://gist.github.com/eddyb/087c6989d116b354afe4 fwiw
[08:44:52] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:44:55] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:45:19] <eddyb> oh, it doesn't have to be recursive
[08:45:20] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:46:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:46:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0mSrSw
[08:46:33] <ghrust> 13rust/06auto 1486b0564 15Hong Chulju: rustc/metadata: Removed stray debug statements
[08:46:33] <ghrust> 13rust/06auto 14eab85de 15bors: auto merge of #11701 : FeGs/rust/stray-debug-in-metadata, r=alexcrichton...
[08:46:34] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:55:31] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[08:56:32] <eddyb> enum-iter-variant-1:                              ; No predecessors!
[08:56:35] <eddyb> hah, interesting
[08:57:08] *** Quits: brson (brson@moz-D434EC03.dsl.sca.megapath.net) (Quit: leaving)
[08:57:16] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:13:06] <acrichto> eddyb: do you know how to get a did from a ty::t?
[09:14:00] <acrichto> hm maybe all I want is struct/enum anyway
[09:14:08] <eddyb> acrichto: not all types have an ID of sorts attached to them. type aliases are expanded and erased during astconv
[09:14:30] <acrichto> Option<did>?
[09:14:46] <eddyb> struct/enum/function/method/closure might have IDs
[09:14:59] <acrichto> yeah this doesn't have a good answer
[09:15:03] <acrichto> I need a different question to ask
[09:25:59] <eddyb> nmatsakis: hahaha, this is the reverse
[09:26:53] <Diamond> self also has a did.
[09:27:05] <eddyb> Diamond: self? what self?
[09:27:14] <Diamond> ty::ty_self
[09:27:23] <eddyb> oh, Self not self
[09:27:33] <Diamond> right
[09:27:39] <eddyb> DefSelfTy
[09:27:59] <eddyb> (I removed DefSelf/ExprSelf, that's why I reacted like that)
[09:28:09] <eddyb> nmatsakis: in iter_structural_ty, variant_cx = iter_variant(..., causing variant_cx to be the wrong thing *to jump to*
[09:28:19] <Diamond> my repo must be behind the master
[09:29:05] <eddyb> Diamond: it's not merged yet
[09:29:12] <flaper87> I was looking into this the other day, I'm not sure there's an easy way to get did from ty::t
[09:30:48] *** Joins: rca (rcatolino@moz-9CC22131.adsl.proxad.net)
[09:31:42] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[09:31:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14eab85de to 1419e0cbe: 02http://git.io/N3iJvQ
[09:31:42] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[09:39:07] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[09:39:35] *** Joins: sigma (sigma@moz-1C81041B.range86-184.btcentralplus.com)
[09:57:45] *** Quits: sigma (sigma@moz-1C81041B.range86-184.btcentralplus.com) (Client exited)
[09:57:51] *** Joins: sigma (sigma@moz-1C81041B.range86-184.btcentralplus.com)
[09:59:18] <eddyb> Basic Block in function '_ZN3ext8deriving9decodable20decode_static_fields4anon7expr_fn2aZE' does not have terminator!
[10:29:17] *** Quits: sigma (sigma@moz-1C81041B.range86-184.btcentralplus.com) (Client exited)
[10:31:04] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[10:31:25] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[10:33:09] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[10:44:38] *** Quits: jdm (jdm@moz-BDD802ED.hfc.comcastbusiness.net) (Ping timeout)
[10:51:38] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:51:38] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/b0NRAA
[10:51:38] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:56:33] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[10:56:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pJ-yQA
[10:56:34] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[10:56:35] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[10:56:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Jqm_pg
[10:56:35] <ghrust> 13rust/06auto 14e350d65 15Steven Fackler: Redo exported macro serialization...
[10:56:35] <ghrust> 13rust/06auto 1410474a3 15bors: auto merge of #11720 : sfackler/rust/macro-export-source, r=alexcrichton...
[10:56:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[10:57:50] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[11:08:46] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:08:58] <dbaupp> strcat: do you happen to know what '[UR]' means?
[11:09:04] <strcat> no
[11:09:18] *** Quits: rca (rcatolino@moz-9CC22131.adsl.proxad.net) (Ping timeout)
[11:09:33] <strcat> dbaupp: you mean https://github.com/mozilla/rust/issues/11722 ?
[11:09:34] * dbaupp guess it may be a french abbreviation for 'feature request'
[11:09:58] <dbaupp> strcat: yeah, all the issues nicolasboulay has opened start with it
[11:10:41] * strcat is playing with http://criu.org/Main_Page
[11:11:04] <dbaupp> oh, that looks neat
[11:11:06] <strcat> snapshot arbitrary applications to disk ;]
[11:11:07] <dbaupp> is it working?
[11:11:43] <pnkfelix> strcat: how does that compare against http://dmtcp.sourceforge.net/ ?
[11:12:35] <pnkfelix> (crui is probably more polished, since it seems like it has commercial support)
[11:12:47] <pnkfelix> sed -e s/crui/criu/
[11:13:12] <strcat> dbaupp: not yet ;p
[11:13:29] * strcat might be doing something wrong...
[11:13:35] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Input/output error)
[11:14:11] <strcat> % zgrep CHECKPOINT /proc/config.gz
[11:14:13] <strcat> CONFIG_CHECKPOINT_RESTORE=y
[11:14:15] <strcat> ;s
[11:15:02] <strcat> pnkfelix: yeah I tried some of these a while back and they were really broken
[11:16:22] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[11:16:30] <strcat> (00.069534) Error (cr-dump.c:354): Task 10587 with SysVIPC shmem map @7f6980b25000 doesn't live in IPC ns
[11:16:32] <strcat> ;s
[11:17:23] <strcat> pnkfelix: my kernel might be too new, dunno.
[11:17:41] *** Joins: rca (rcatolino@moz-9CC22131.adsl.proxad.net)
[11:18:59] <dbaupp> oh, the new Vec landed
[11:19:03] * dbaupp hugs strcat
[11:19:42] * strcat realizes it put 100 .img files in the cwd
[11:20:44] <eddyb> dbaupp: time to rewrite libsyntax/librustc
[11:20:51] <eddyb> strcat: is it optimizes for 0 length?
[11:20:56] <strcat> eddyb: yes
[11:21:01] <eddyb> *optimized
[11:21:02] <strcat> eddyb: no allocation at 0 length
[11:21:10] <strcat> and shrink_to_fit will free() the allocation if it's 0 length
[11:21:14] <eddyb> strcat: time to remove syntax::opt_vec
[11:21:20] <strcat> yep!
[11:21:28] <eddyb> and ty_nil/TyNil
[11:21:33] <strcat> I already plugged it into HashMap
[11:21:36] <strcat> so it's already in wide use
[11:21:48] <strcat> although hashmap doesn't use push
[11:21:49] <strcat> so...
[11:22:03] <strcat> not really going to make a difference (code size is better, though)
[11:22:04] <eddyb> (the latter two exist *only* to prevent a vector allocation in ty_tup/TyTup)
[11:23:34] <strcat> pnkfelix: yeah it doesn't appear to work for me
[11:23:37] <strcat> something is wrong with it :(
[11:23:57] <pnkfelix> strcat: criu you mean?
[11:23:59] <strcat> yeah
[11:24:05] <pnkfelix> strcat: a shame
[11:24:06] <strcat> I have a feeling my kernel is too new for it
[11:24:15] <strcat> pnkfelix: I'm sure it does work on some environment ;p
[11:24:24] <strcat> 3.12.8-1-ARCH
[11:24:36] <strcat> but it's an enterprisy thing and maybe they don't track the kernel version closely
[11:24:46] <strcat> seems like it'd easily break too
[11:25:55] <strcat> eddyb: did you manage to remove take glue?
[11:26:23] <strcat> lets see if removing OptVec fixes perf magically...
[11:26:59] <eddyb> strcat: I've fixed the previous issue, but ext::deriving::decodable::decode_static_fields::anon::expr_fn::aZ is empty or something like that
[11:27:19] <strcat> ugh OptVec has a weird interface
[11:27:29] <strcat>     pub fn mapi_to_vec<B>(&self, op: |uint, &T| -> B) -> ~[B] {
[11:27:30] <strcat> :|
[11:27:34] <strcat> if something uses this...
[11:27:53] * strcat will start by changing it internally ;]
[11:28:03] <eddyb> and then it's easy to replace the uses with the internal code
[11:28:18] <eddyb> that's what I did to disentangle trans::closure and trans::glue
[11:39:53] *** Joins: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP)
[11:41:31] <eddyb> oh, save-temps should work now, it's a missing return or something similar
[11:41:40] <eddyb> rustc: /home/eddy/Projects/rust/src/llvm/lib/Bitcode/Writer/ValueEnumerator.cpp:135: unsigned int llvm::ValueEnumerator::getValueID(const llvm::Value*) const: Assertion `I != ValueMap.end() && "Value not in slotcalculator!"' failed.
[11:41:44] <eddyb> nope :(
[11:45:03] *** Quits: rca (rcatolino@moz-9CC22131.adsl.proxad.net) (Ping timeout)
[11:51:30] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:51:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1410474a3 to 14aa9cf4c: 02http://git.io/N3iJvQ
[11:51:30] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[11:52:30] <strcat> ugh
[11:52:31] <strcat> OptVec
[11:52:34] <strcat> forcing me to do work
[11:57:17] <strcat> eddyb: how important is the size of OptVec though?
[11:57:34] <eddyb> strcat: hmm?
[11:57:50] <strcat> enum { A, B(~[T]) } is 1 word
[11:57:56] <eddyb> riight
[11:58:01] <strcat> pays the price of an extra branch every time ofc
[11:58:08] <strcat> + the prices of ~[T]
[12:01:40] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[12:03:11] <dbaupp> strcat: btw, Vec<T>.as_slice().iter() seems to be slower than ~[T].iter()
[12:03:27] <strcat> same iterator ;\
[12:03:52] <dbaupp> yaeh, I don't understand it
[12:04:10] <dbaupp> but I converted the fasta benchmark to use Vec rather than ~[], and it's 20% slower
[12:04:28] <eddyb> .as_slice() should be cheaper than before :/
[12:04:40] <strcat> yeah before it does a division
[12:04:51] <eddyb> strcat: hmm?
[12:05:01] <strcat> sorry, poorly worded ;p
[12:05:06] <strcat> ~[T] as_slice does a division
[12:05:07] <kimundi> maybe different inline behaviors?
[12:05:27] <eddyb> dbaupp: can you reduce a benchmark?
[12:05:29] <strcat> ~[T] stores elements in bytes
[12:05:33] <strcat> element sizes*
[12:05:34] <strcat> er
[12:05:36] * strcat sighs
[12:06:08] <eddyb> dbaupp: if so, I can look at the IR for you
[12:06:31] <eddyb> it sounds more fun than this non-working soup of @
[12:07:08] <kimundi> hmmm.... @ soup makes me think of noodle soup :P
[12:08:05] <eddyb> I've fixed 2 unknown trans bugs and I'm looking at a third
[12:09:06] *** Joins: rca (rcatolino@moz-9CC22131.adsl.proxad.net)
[12:09:13] <dbaupp> eddyb: I can look at the IR too :P
[12:10:01] <dbaupp> err, what: https://gist.github.com/huonw/5b7782f98735776eb044
[12:10:10] <eddyb> dbaupp: I mean, if it's not obvious for you. though it's strcat's implementation and he knows better than me
[12:10:59] <dbaupp> eddyb: the only difference between v.iter() and v.as_slice().iter() is the library coercion to &[T]
[12:11:06] <dbaupp> the other coercion is done in the compiler
[12:11:23] <strcat> only way to find out what is happening is to look at the IR
[12:11:26] <dbaupp> (i.e. ~[T] to &[T] for the normal .iter().)
[12:11:28] <eddyb> dbaupp: dump the IR and gist the expr_fn functions associated with vec_ng and vec_old
[12:11:31] <strcat> apparently there is indirection in the library that's not eliminated
[12:11:47] <dbaupp> eddyb: you have the source there ;P
[12:11:50] <eddyb> dbaupp: also, can you move n = rng.gen() outside of the function?
[12:11:56] <strcat> dbaupp: make sure from_fn is inlined in both cases
[12:12:11] <strcat> it's not marked #[inline] in Vec, that could be the issue
[12:12:23] <eddyb> strcat: isn't it generic?
[12:12:26] <strcat> yes
[12:12:33] <strcat> doesn't mean LLVM will inline it
[12:12:37] <eddyb> hmm, okay
[12:12:38] <dbaupp> for vec_old, it's just doing the xorshift stuff
[12:12:43] <dbaupp> and no vector iteration
[12:12:43] <strcat> it doesn't know it can optimize out the closure until it's inlined
[12:12:50] <strcat> dbaupp: so is from_fn inlined?
[12:13:03] <eddyb> strcat: from_fn is outside of scope
[12:13:07] <strcat> not relevant
[12:13:09] <strcat> is from_fn inlined?
[12:13:33] <eddyb> unless you want to eliminate the entire vector allocation as a dead store
[12:13:41] <strcat> that's not what I'm talking about
[12:14:10] <dbaupp> makes no difference even if I put the ~[] from_fn inside an inline(never) function
[12:14:13] <eddyb> strcat: then from_fn shouldn't matter
[12:14:30] <strcat> eddyb: why not? if it doesn't get inlined it won't know how big it is statically
[12:14:42] <dbaupp> but, yes, the Vec::from_fn is inilined
[12:14:45] <eddyb> strcat: aaaah, dat
[12:14:50] <eddyb> *that. okay, I get it
[12:16:02] <strcat> dbaupp: can you paste the IR?
[12:16:22] * strcat doesn't have a build with Vec atm
[12:16:38] <strcat> dbaupp: just for the Vec<T> one
[12:16:57] <strcat> anyway from_fn is different between them
[12:17:09] <strcat> perhaps it's unable to figure out the length statically
[12:17:32] <eddyb> so your bet is on bounds checks?
[12:17:45] <strcat> no
[12:18:01] <strcat> there aren't bounds checks there
[12:19:06] <dbaupp> strcat: https://gist.github.com/huonw/8017bca33648c48d9dbf
[12:20:32] <eddyb> what's with the null check?
[12:21:28] <strcat> what do you mean?
[12:21:41] <eddyb> strcat: https://gist.github.com/huonw/8017bca33648c48d9dbf#file-gistfile2-ll-L50
[12:21:49] <eddyb> on every iteration
[12:22:42] <strcat> dbaupp: I think transmute on the slice might cause this
[12:23:07] <strcat> dbaupp: try with move_iter
[12:23:16] <strcat> well
[12:23:18] <strcat> that won't work
[12:23:35] <strcat> anyway I think the transmute to convert to a slice throws away the aliasing info
[12:24:30] <eddyb> dbaupp: what happens if you add --passes inline to the rustc command?
[12:25:11] <eddyb> (hoping to inline the closure into the main test function to benefit from statically resolving the captured Vec)
[12:25:49] <dbaupp> eddyb: can't do that
[12:25:59] <dbaupp> bh.iter() is inline(never)
[12:26:10] <dbaupp> it'll never be inlined.
[12:26:12] <eddyb> hmm?
[12:26:16] <eddyb> since when?
[12:26:28] <dbaupp> since it's a benchmarking harness?
[12:26:56] <eddyb> I mean, it inlined just fine for my in fmt tests
[12:27:08] <dbaupp> eddyb: benchmarks?
[12:27:24] <eddyb> yeah, the closure and the bh.iter logic, all inlined
[12:27:44] <dbaupp> nope, no change
[12:28:17] <strcat> dbaupp: implement iter directly on ~[T]
[12:28:20] <strcat> and see what happens
[12:28:20] <dbaupp> (also, I lied about it being inline(never))
[12:28:23] <strcat> er
[12:28:26] <dbaupp> strcat: already doing that
[12:28:26] <strcat> directly on Vec<T>
[12:29:54] <eddyb> dbaupp: oh, I know, LTO was doing it
[12:30:05] <eddyb> --passes inline was for something else
[12:30:48] <dbaupp> eddyb: makes sense
[12:34:41] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Input/output error)
[12:35:45] <dbaupp> strcat: afaik, no change :(
[12:36:18] <strcat> dbaupp: call set_len yourself too
[12:36:23] <strcat> after from_fn
[12:36:36] <eddyb> (maybe inside the closure?)
[12:37:02] * strcat can't understand why it wouldn't optimize out though
[12:37:05] <dbaupp> nothing just after from_fn
[12:37:19] <dbaupp> oh ... wait
[12:37:25] <dbaupp> I forgot to remove the .as_slice call
[12:37:29] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[12:37:32] <eddyb> hehe
[12:37:36] * dbaupp dumb
[12:38:23] <dbaupp> no change even without the call
[12:38:57] * eddyb is curious how much the vec_old benchmark does
[12:39:28] <strcat> dbaupp: even with set_len?
[12:39:42] <eddyb> (even with set_len inside the closure?)
[12:40:40] <dbaupp> strcat: no change with set_len inside the closure
[12:40:55] <dbaupp> eddyb: how much what?
[12:41:05] <eddyb> dbaupp: operations
[12:41:14] <eddyb> well, how many operations
[12:41:31] <dbaupp> right
[12:41:44] <dbaupp> If i through a println!("hi") instead of the return
[12:41:56] <eddyb> on my system, a noop benchmark is 3ns
[12:42:00] <dbaupp> then vec_ng takes 1000 ns/iter and vec_old is only 700 ns/iter
[12:42:25] <eddyb> dbaupp: I was thinking more of the IR, I'm not sure what vec_old optimizes to
[12:42:38] <dbaupp> (the print never executes)
[12:43:45] <strcat> anyway doesn't make sense that it's slower, something non-obvious going on there
[12:44:41] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[12:44:50] <dbaupp> the only difference I can see is the null check
[12:44:58] <dbaupp> (and the associated branch)
[12:45:01] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Connection reset by peer)
[12:45:02] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[12:45:18] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[12:46:42] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[12:47:02] <eddyb> dbaupp: heh, that's what I noticed
[12:47:11] <eddyb> not sure where that's coming from
[12:47:23] <dbaupp> ok, yep looks like they're line-for-line identical other than that
[12:47:32] <dbaupp> (and the %<n>'s being one larger.)
[12:47:46] <eddyb> must be lowering that's different
[12:47:58] <eddyb> (and maybe branch prediction)
[12:48:21] <dbaupp> oh
[12:48:23] * dbaupp has an idea
[12:49:17] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Input/output error)
[12:50:16] <dbaupp> (does bitcasting pointer to pointer lose aliasing info?)
[12:50:30] <strcat> dbaupp: doubt it
[12:50:37] <strcat> dbaupp: but storing a struct with a ptr and loading it does
[12:50:42] <strcat> and afaik that's what as_slice is doing
[12:51:39] <dbaupp> meh, my idea doesn't help :(
[12:52:18] <strcat> dbaupp: how did you implement iter()?
[12:52:42] <dbaupp> strcat: Items { ptr: self.ptr, end: self.ptr.offset(self.len), lifetime: None }
[12:52:48] <dbaupp> (with the appopriate casts)
[12:53:00] <dbaupp> (using vec::Items, after making the fields public.)
[12:53:16] <eddyb> still generates the null checks?
[12:53:22] <dbaupp> yes
[12:53:38] <eddyb> where from?
[12:53:55] <dbaupp> hm?
[12:54:07] <eddyb> the Option<&T> that the iterators are returning, maybe?
[12:54:23] <strcat> dbaupp: I don't understand why it doesn't optimize out then
[12:54:26] <strcat> makes very little sense
[12:54:34] <strcat> dbaupp: separate the from_fn part
[12:54:39] <strcat> dbaupp: so that both receive a pointer
[12:54:42] <strcat> nothing else
[12:54:44] <strcat> just a raw pointer
[12:54:49] <eddyb> LLVM must not be able to tell that the &T inside Some cannot be null
[12:55:06] <eddyb> and the null check is == None, basically
[12:55:10] <dbaupp> strcat: I don't understand what you mean?
[12:55:19] <dbaupp> eddyb: yeah, I think that's what it is
[12:55:22] <strcat> dbaupp: write the benchmark so that it operates on a raw pointer
[12:55:27] <strcat> turn the raw pointer into an iterator
[12:55:31] <strcat> dbaupp: hoist out the vector code
[12:55:38] <dbaupp> right
[12:56:04] <eddyb> is there a "nonull" for pointers?
[12:56:18] <strcat> eddyb: no
[12:56:20] <eddyb> pointers in arguments, that is
[12:56:48] <eddyb> strcat: I think the Some function we generate might botch optimizations
[12:57:02] <strcat> dbaupp: I think I know what the difference is
[12:57:18] <strcat> dbaupp: with ~[T], we generate an offset to the data
[12:57:21] <strcat> which is non-zero
[12:57:25] <strcat> so it knows it is non-null
[12:57:39] <strcat> self.len can be 0
[12:58:34] <eddyb> can we hoist out the null check or something?
[12:58:59] <strcat> the null check is the match in for 
[12:59:00] <dbaupp> I had Vec.iter() check for self.ptr == 0 explicitly (and fail!() if it did)... didn't help.
[12:59:16] <eddyb> strcat: i.e. explicitly return start: null, end: null when self.ptr == null
[12:59:20] <eddyb> dbaupp: that's a shame :(
[12:59:26] <dbaupp> eddyb: I did exactly that too
[12:59:30] <dbaupp> (both null)
[12:59:35] <dbaupp> also didn't help
[12:59:37] <eddyb> it might not understand pointer math that well
[12:59:43] <strcat> eddyb: not the problem
[12:59:54] <strcat> the match inside the for does a null check
[12:59:56] <eddyb> just like the length field of ~[T] can alias with indexing
[13:00:10] <strcat> eddyb: the problem is that ~[T] does an offset to the data
[13:00:15] <strcat> so LLVM knows the pointer is non-null
[13:00:58] <dbaupp> strcat: doing it in the benchmark with `p = v.as_ptr(); end = p.offset(len); while p < end { ... }` works fine with vec_ng
[13:01:37] <eddyb> strcat: oh, you mean it's sizeof(uint) * 2 when the original pointer is null?
[13:01:49] <strcat> eddyb: the original pointer is not null
[13:02:05] <eddyb> strcat: if it were null. nevermind
[13:02:10] <strcat> eddyb: that's UB
[13:02:16] <strcat> LLVM knows it doesn't happen
[13:02:58] <dbaupp> (it also works (as in, gets eliminated)if I have `if p.is_null() { break }` at the start of the while loop)
[13:03:38] <dbaupp> yup, and they're both 710 ns/iter
[13:04:02] <eddyb> dbaupp: that's what I wanted. can you show IR for the hoisted null check?
[13:04:21] <eddyb> maybe it's one of those logic things that LLVM can't do well
[13:05:32] <strcat> dbaupp: what if you start with a slice
[13:05:41] <strcat> dbaupp: original code, but with a slice
[13:05:47] <dbaupp> eddyb: which hoisted null check?
[13:05:49] <eddyb> if a & b {if a {...}} doesn't get optimized while if a {if {b {if a {...}}} does. && works in clang, but not in Rust (we must be doing something funky)
[13:06:02] <eddyb> dbaupp: the one in .iter()
[13:06:06] <dbaupp> eddyb: this one? https://gist.github.com/huonw/8017bca33648c48d9dbf#file-gistfile2-ll-L50
[13:06:27] <dbaupp> eddyb: oh, you mean when I check if self.ptr.is_null() explicitly?
[13:06:39] <eddyb> dbaupp: yes, hoping to prevent the inner null check
[13:07:26] <dbaupp> eddyb: it's no different to that gist
[13:08:14] <dbaupp> strcat: no change if I move the .as_slice() call outside the .iter(|| ) closure
[13:08:18] <dbaupp> (is that what you mean?)
[13:08:24] <strcat> dbaupp: nope
[13:08:30] <strcat> dbaupp: I mean don't use Vec or ~[T]
[13:08:34] <strcat> use a slice from the start
[13:08:48] <strcat> dbaupp: returned from a noinline function
[13:08:55] <strcat> so it can't see where the slice comes from
[13:09:07] <strcat> I want to know if this is a general iterator perf issue
[13:09:13] <strcat> I expect it is
[13:09:26] <strcat> it's just that ~[T] is doing an offset that proves to LLVM it is non-null
[13:09:58] <dbaupp> it has the null check too
[13:10:05] <dbaupp> (even when not in a noinline function)
[13:10:07] <strcat> alright so the issue isn't Vec<T>
[13:10:20] <strcat> the issue is the slice iterator
[13:10:22] <dbaupp> looks like it
[13:11:32] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[13:11:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/7SY_Cw
[13:11:32] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[13:13:33] <dbaupp> I'm filing a bug
[13:13:46] <strcat> dbaupp: can you paste the IR from a slice
[13:13:58] <strcat> I am just going to get angry and mark every borrowed ptr and slice as non-null
[13:14:14] <strcat> well, in parameters
[13:14:17] <strcat> hm
[13:14:26] <strcat> we probably don't guarantee that the slice (ptr, 0) is non-null
[13:15:37] * strcat is glad it's not Vec<T> at least
[13:15:49] <strcat> means there's an existing thing we can improve :)
[13:16:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:16:31] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/BQ6CfA
[13:16:31] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[13:16:32] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[13:16:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/sTnn9A
[13:16:32] <ghrust> 13rust/06auto 146ffe9da 15David Manescu: Feature gate #[simd]...
[13:16:32] <ghrust> 13rust/06auto 14f717a2c 15bors: auto merge of #11738 : dmanescu/rust/11721, r=alexcrichton...
[13:16:32] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[13:16:38] <eddyb> strcat: wait, so we have that capability?
[13:16:50] <strcat> hm?
[13:16:56] <strcat> I asked in LLVM
[13:16:57] <eddyb> strcat: wouldn't doing it for Some(&T) fix the inner null check?
[13:17:09] <strcat> eddyb: I don't really think it will work
[13:17:12] <strcat> I remember trying before...
[13:17:16] <eddyb> bleah
[13:17:30] <eddyb> this is capable of breaking in way more places than slices and iterators
[13:17:47] <dbaupp> strcat: https://github.com/mozilla/rust/issues/11751
[13:18:25] <strcat> eddyb: anyway I want to fix it in a general way
[13:18:25] <dbaupp> strcat: would it make sense to guarantee that (ptr, 0) is non-null?
[13:18:28] <eddyb> if a nullable pointer created from a non-null pointer doesn't optimized out null checks...
[13:18:35] <strcat> dbaupp: it's not really necessary for this
[13:18:53] <strcat> eddyb: LLVM is not nearly as smart as people think
[13:19:01] <strcat> really, you have to write good code ;p
[13:19:08] <eddyb> strcat: #[inline(never)] fn foo(x: &T) -> bool {Some(x) == None}
[13:19:16] <strcat> it has really dumb, simple optimizations that are *reliable*
[13:19:22] <eddyb> well, it's generic and you have to instantiate it
[13:19:46] <strcat> eddyb: yeah but we can fix this
[13:19:48] <eddyb> strcat: that above should be optimized to ret i8 1
[13:19:59] <strcat> and is it?
[13:20:13] <strcat> I know how to fix this
[13:20:13] <eddyb> well, I guess I can check, I didn't break *everything* in my local build
[13:20:48] <eddyb> strcat: it's not optimized, lol
[13:21:00] <eddyb> strcat: yeah, we need nonull on &T ASAP
[13:21:26] <dbaupp> (do we guarantee that &() is non-null?)
[13:21:44] *** Joins: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca)
[13:22:51] <eddyb> dbaupp: we can ignore zero-sized types when we nonull attributes, they don't pose a performance concern anyway, AFAIK, if we want to be on the safe side
[13:23:09] <strcat> dbaupp: no, we can skip it
[13:23:12] <strcat> zero-size types
[13:23:14] <strcat> can be skipped
[13:23:24] <dbaupp> ah, of course
[13:23:44] <eddyb> there was an issue I commented on, about &mut T being marked as noalias, and I was thinking of readonly for &T, but I didn't realize nonull wasn't there
[13:23:47] * dbaupp forgot that we (have to) monomorphise before LLVM
[13:24:33] *** Quits: Kxepal (Miranda@moz-20E4E5C2.pppoe.mtu-net.ru) (Quit: Kxepal)
[13:24:49] *** Joins: Kxepal (Miranda@moz-20E4E5C2.pppoe.mtu-net.ru)
[13:26:22] <eddyb>   %. = zext i1 %1 to i8
[13:26:42] <eddyb> what's with the %. btw? I mean, I know our IR is cryptic, but... a dot?
[13:27:31] <strcat> dot!
[13:27:50] <dbaupp> eddyb: I added that a few weeks ago, just to confuse people
[13:28:14] <dbaupp> ;P
[13:29:09] <strcat> ugh
[13:29:11] <strcat> what a pain.
[13:29:53] <strcat> dbaupp: alright so a really dumb fix would be adding it in the Some ctors
[13:29:59] <strcat> but I think we want it in general
[13:30:21] <eddyb> strcat: I think it's harder for slices than &T
[13:30:30] <strcat> yes not going to do it for slices
[13:30:31] <strcat> just &T
[13:30:33] <strcat> it's enough
[13:30:36] <strcat> Some(&T) is a function
[13:30:46] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[13:30:57] <strcat> it's really a huge PITA
[13:31:04] <strcat> watch inlining is going to destroy the info
[13:32:18] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Input/output error)
[13:32:51] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[13:32:59] <eddyb> strcat: putting info on arguments and returns sounds counter-intuitive IMO
[13:33:08] <strcat> why?
[13:33:15] <eddyb> strcat: the info should be in the type, so LLVM can just propagate it
[13:33:23] <strcat> LLVM doesn't have types
[13:33:25] <strcat> it has layouts
[13:33:31] <eddyb> *sigh* :(
[13:33:38] <strcat> as in 'it doesn't represent rust types'
[13:33:43] <strcat> LLVM types are just memory layouts
[13:33:57] <strcat> eddyb: *low-level* virtual machine
[13:34:06] <eddyb> strcat: does TBAA propagate?
[13:34:11] <strcat> eddyb: I guess
[13:34:17] <strcat> you can't say something is nonnull with tbaa
[13:34:22] <eddyb> :(((((
[13:34:35] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Ping timeout)
[13:35:09] <strcat> eddyb: don't worry, this is a problem for other languages on LLVM too
[13:35:21] <eddyb> strcat: but Rust is superior!
[13:35:24] <strcat> it's a place where rust can do better, yes
[13:51:42] *** Quits: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP) (Ping timeout)
[13:56:32] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:56:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f717a2c to 147cabd40: 02http://git.io/N3iJvQ
[13:56:32] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:56:38] <eddyb> Basic Block in function '_ZN3baz4anon7expr_fn2aEE' does not have terminator!
[13:56:46] <eddyb> WOOOO I can reproduce the third
[14:00:37] <kimundi> woho! :)
[14:01:11] *** Quits: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca) (Quit: canhtak)
[14:05:09] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[14:05:42] <eddyb> extra code gets generated to entry block, after the switch on the enum tag
[14:06:27] *** Quits: dbaupp (Thunderbir@moz-A840EB3D.lns20.syd6.internode.on.net) (Ping timeout)
[14:08:25] <eddyb> why does take_ty get called on function arguments?
[14:08:38] <eddyb> oh, wait, it's the destructing that I'm doing
[14:10:31] <eddyb> nmatsakis: in trans_closure, maybe_load_env doesn't get bcx, but fcx, and works on the entry block
[14:11:09] * bstriecoin puts on a skimpy outfit and cheers eddyb from the sidelines
[14:11:38] *** bstriecoin is now known as bstrie_cheersquad
[14:15:44] *** Joins: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca)
[14:32:16] <strcat> eddyb: go remove the transmutes from json.rs ;p
[14:32:22] <strcat> so we can put range metadata on chars!
[14:32:29] * strcat too lazy
[14:32:36] <cmr> heh
[14:32:36] <eddyb> oooh
[14:35:57] <eddyb> strcat: to remove asserts or something?
[14:36:40] <strcat> eddyb: *shrug*
[14:36:46] <strcat> I know it breaks json.rs if you put the asserts
[14:36:56] <eddyb> lol
[14:37:17] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[14:40:26] <eddyb> strcat: bleah. I didn't expect inlining a bunch of code with controlflow in it to be so hard
[14:41:40] <nmatsakis> eddyb: hey, I started reading your PR,
[14:42:00] <nmatsakis> eddyb: so far I think it looks very good. I want to digest it a bit more today.
[14:42:01] <eddyb> 3 bugs that end up triggering obscure LLVM errors, and that's the ones I've found
[14:42:07] <eddyb> nmatsakis: thanks :)
[14:42:55] <strcat> nmatsakis: any idea on where would be a good place to insert assertions to LLVM that ptrs are non-null?
[14:43:01] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[14:43:12] <nmatsakis> strcat: i.e., into the generated code?
[14:43:18] <eddyb> strcat: assertions? I thought you were going to add argument attributes
[14:43:32] <strcat> I asked about it in #llvm and the suggestion was to do if ptr == null { unreachable } which should be transformed into the knowledge in LLVM
[14:43:34] <strcat> nmatsakis: yes
[14:43:42] <eddyb> oooh
[14:43:46] <strcat> nmatsakis: we found a pretty bad optimization issue with iterators related to this
[14:43:58] <strcat> because Option<&T> is represented as a nullable ptr
[14:44:01] <nmatsakis> strcat: I see, I think in the code where Datum<Rvalue> is stored would be a good place
[14:44:18] <nmatsakis> basically the various places where Datum<Rvalue> are consumed
[14:44:39] <nmatsakis> those should always be non-NULL
[14:44:40] <eddyb> this might end up in IR bloat :S
[14:44:48] <nmatsakis> yes, it might, a more targeted place
[14:44:55] <nmatsakis> would be in the code that stores the arguments
[14:45:04] <strcat> eddyb: it is optimized out as dead afaik, we'll see what it does at --opt-level=0
[14:45:05] <nmatsakis> and fn return values
[14:45:06] <nmatsakis> perhaps
[14:45:14] <strcat> eddyb: early on
[14:45:24] <nmatsakis> strcat: you could conditionally insert it, as well.
[14:45:26] <strcat> in fact that's a problem, that it's optimized out early on, as inlining etc. might erase it
[14:45:27] <nmatsakis> i.e., only with -O3
[14:45:32] <strcat> just want to try it
[14:45:33] <strcat> nmatsakis: yeah
[14:47:19] <eddyb> strcat: oh, ok, feel free to look at the RAM usage for compiling stage2-rustc, if it helps performance
[14:48:16] <eddyb> I could've phrased that better, but you know what you mean
[14:48:55] <eddyb> aaand libsyntax compiles :D
[14:53:14] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[14:56:15] *** Joins: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP)
[14:56:20] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:56:26] <eddyb> cmr: not sure if this means anything http://huonw.github.io/isrustfastyet/mem/#7d79cc7,6d55211
[15:00:03] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[15:01:48] <eddyb> acrichto: oooh, you fixed LTO + green :D
[15:01:52] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[15:05:47] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Ping timeout)
[15:05:53] <eddyb> strcat, cmr: stage1 librustc.so is 44MB. stage2 is 43MB
[15:06:12] <strcat> eddyb: with which change?
[15:06:18] <strcat> or you just mean in general
[15:06:21] <eddyb> strcat: removing take_glue
[15:06:24] <strcat> oh
[15:06:43] <eddyb> well, moving it from tydesc to within the functions it was used in
[15:09:11] *** Joins: new_one (new_one@57C8A601.D0485D2E.B3C0173E.IP)
[15:11:04] <eddyb> https://github.com/mozilla/rust/pull/11723/commits still waiting on #11595
[15:13:00] <eddyb> strcat: 170KB actually
[15:13:14] <strcat> eddyb: now run opt -mergefunc on it
[15:13:21] <strcat> opt -mergefunc -inline
[15:13:52] <eddyb> strcat: why?
[15:13:58] <strcat> fun ;p
[15:14:03] <eddyb> it's smaller now, not lar- oh, ok
[15:14:10] <strcat> I just wish LLVM would hurry up and merge that
[15:14:17] <strcat> (the fix)
[15:14:20] <eddyb> but for that I need --save-temps, right?
[15:14:36] <strcat> eddyb: hm? 
[15:14:44] <strcat> eddyb: well, you can use --passes
[15:14:52] <eddyb> strcat: meh. I'm not willing to recompile two rustc stages
[15:16:25] <eddyb> nmatsakis: can you ping me when you're finished with reviewing https://github.com/mozilla/rust/pull/11595 so I can fix the nits (there's only that one formatting thing for now, right?)? thanks
[15:16:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[15:16:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qPMstQ
[15:16:35] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[15:16:48] <eddyb> strcat: then again, --passes is easy to add. comma separated?
[15:16:56] <strcat> eddyb: I think so
[15:17:30] <strcat> eddyb: anyway not important ;)
[15:17:41] <eddyb> make rustc-stage2 RUSTFLAGS="-Z time-passes --passes mergefunc,inline"
[15:18:03] <nmatsakis> eddyb: yep. 
[15:21:31] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[15:21:31] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/UeBSbg
[15:21:31] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[15:21:31] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[15:21:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ePw9bQ
[15:21:31] <ghrust> 13rust/06auto 1424c560a 15Andrew Chin: Set LD_LIBRARY_PATH on linux for c-dynamic-dylib test...
[15:21:31] <ghrust> 13rust/06auto 1428bc888 15bors: auto merge of #11742 : eminence/rust/dylib-test-fix, r=alexcrichton...
[15:21:31] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[15:22:09] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:23:33] *** Quits: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca) (Quit: canhtak)
[15:24:38] <eddyb> rustc: /home/rustbuild/src/rust-buildbot/slave/snap3-linux/build/src/llvm/lib/IR/Instructions.cpp:2352: static llvm::CastInst* llvm::CastInst::Create(llvm::Instruction::CastOps, llvm::Value*, llvm::Type*, const llvm::Twine&, llvm::Instruction*): Assertion `castIsValid(op, S, Ty) && "Invalid cast!"' failed.
[15:24:48] <eddyb> strcat: please tell me you didn't know this was going to happen?
[15:24:57] <eddyb> s/?//
[15:25:10] <strcat> eddyb: ugh >.<, I thought that one was fixed
[15:25:51] <strcat> eddyb: which lib is that on btw?
[15:25:58] <strcat> may have to make another bug report
[15:26:06] <eddyb> strcat: librustc
[15:26:17] <strcat> hm, before it only happened on libextra
[15:27:47] *** Joins: rca_ (rcatolino@moz-5E0A44D2.adsl.proxad.net)
[15:28:19] *** Joins: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca)
[15:29:14] *** Quits: rca (rcatolino@moz-9CC22131.adsl.proxad.net) (Ping timeout)
[15:37:37] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[15:39:23] *** Joins: jdm (jdm@moz-BDD802ED.hfc.comcastbusiness.net)
[15:41:03] <strcat> rusti: let x = (); let y = &x; let z: *int = y; z
[15:41:18] <strcat> .
[15:41:21] -rusti- pastebinned 7 lines of output: http://ix.io/a4M
[15:41:36] <strcat> rusti: let x = (); let y = &x; let z: *() = y; z
[15:41:36] -rusti- (0x7feb778cbd20 as *())
[15:41:41] <strcat> rusti: let x = (); let y = &x; let z: *() = y; z
[15:41:42] -rusti- (0x7f3c4f585d20 as *())
[15:41:47] * strcat wonders if that can be null
[15:42:00] <strcat> rusti: struct Foo; let x = Foo; let y = &x; let z: *Foo = y; z
[15:42:01] -rusti- (0x7f53cc326d20 as *())
[15:42:09] <eddyb> strcat: maybe &'static but I don't think we optimize it as such
[15:42:27] <strcat> I think I'm going to to leave out the assertion for zero-size types anyway
[15:42:28] <strcat> seems risky
[15:42:44] <eddyb> strcat: task-local depends on the address of &'static ZeroSizedKey, actually
[15:42:54] <strcat> hm
[15:43:26] <strcat> nmatsakis: http://llvm.org/docs/LangRef.html#llvm-objectsize-intrinsic aha! I never noticed this thing...
[15:43:58] <strcat> hm
[15:44:00] <strcat> actually no
[15:44:05] <strcat> that isn't anything like what I thought it was
[15:44:17] <strcat> meh ;p
[15:45:14] <strcat> it looked like a way to specify the size of an object.... *sigh*
[15:46:01] <eddyb> like that size correlation thing I mentioned a couple of days ago?"
[15:46:11] <strcat> maybe
[15:53:40] *** Joins: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se)
[15:56:21] *** Quits: jensnockert (jensnocker@moz-C4B24C3.customers.ownit.se) (Ping timeout)
[15:57:13] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[16:00:24] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Input/output error)
[16:00:51] *** Joins: jensnockert (jensnocker@moz-33279404.customers.ownit.se)
[16:02:38] *** Quits: jensnockert (jensnocker@moz-33279404.customers.ownit.se) (Ping timeout)
[16:03:41] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:03:41] *** ChanServ sets mode: +ao dherman dherman
[16:06:35] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[16:06:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1428bc888 to 14657e353: 02http://git.io/N3iJvQ
[16:06:35] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[16:21:29] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[16:21:29] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14400036d to 14657e353: 02http://git.io/N3iJvQ
[16:21:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[16:21:31] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:21:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MR5Y4Q
[16:21:31] <ghrust> 13rust/06auto 14410cbab 15Alex Crichton: Allow opting-out of rpath usage...
[16:21:31] <ghrust> 13rust/06auto 14cad664b 15bors: auto merge of #11744 : alexcrichton/rust/issue-5219, r=thestinger...
[16:21:32] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:30:51] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[16:33:57] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[16:34:07] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[16:34:19] *** vfetwnuncszu is now known as dcrewi
[16:36:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[16:36:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14cad664b to 14657e353: 02http://git.io/N3iJvQ
[16:36:35] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[16:36:36] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[16:36:36] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/c3nrwA
[16:36:36] <ghrust> 13rust/06auto 14410cbab 15Alex Crichton: Allow opting-out of rpath usage...
[16:36:36] <ghrust> 13rust/06auto 14d438280 15bors: auto merge of #11744 : alexcrichton/rust/issue-5219, r=thestinger...
[16:36:36] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[16:37:54] *** Quits: new_one (new_one@57C8A601.D0485D2E.B3C0173E.IP) (Ping timeout)
[16:57:51] *** Joins: nate (user@C3BA61EE.F9392C3A.CB3564DC.IP)
[16:59:52] *** Quits: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca) (Quit: canhtak)
[17:01:46] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[17:01:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Tn8clw
[17:01:47] <ghrust> 13rust/06auto 14410cbab 15Alex Crichton: Allow opting-out of rpath usage...
[17:01:47] <ghrust> 13rust/06auto 14d125676 15bors: auto merge of #11744 : alexcrichton/rust/issue-5219, r=thestinger...
[17:01:47] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[17:01:48] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[17:01:48] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d438280 to 14657e353: 02http://git.io/N3iJvQ
[17:01:48] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[17:07:10] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[17:11:30] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:11:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d125676 to 14657e353: 02http://git.io/N3iJvQ
[17:11:30] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:11:31] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:11:31] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/X8--Dg
[17:11:31] <ghrust> 13rust/06auto 14e70ca23 15Brian Anderson: native: Don't use timerfd on Android...
[17:11:31] <ghrust> 13rust/06auto 14fe3ef9c 15bors: auto merge of #11748 : brson/rust/timerfdandroid, r=alexcrichton...
[17:11:31] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:19:05] <strcat> eddyb: meh it's not working
[17:19:24] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Broken pipe)
[17:20:53] <eddyb> strcat: what isn't?
[17:21:08] <strcat> this non-null assertion
[17:21:11] <strcat> it optimizes out as dead code
[17:21:21] <strcat>   %is_null = icmp eq i64* %4, null
[17:21:22] <strcat>   br i1 %is_null, label %null-block, label %non-null-block
[17:21:24] <strcat> null-block:
[17:21:26] <strcat>   unreachable
[17:21:28] <strcat> non-null-block:
[17:21:35] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:21:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14fe3ef9c to 14657e353: 02http://git.io/N3iJvQ
[17:21:35] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:21:37] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:21:37] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/90IB7w
[17:21:37] <ghrust> 13rust/06auto 14cdd146b 15Ben Noordhuis: Add std::os::self_exe_name()
[17:21:37] <ghrust> 13rust/06auto 148cce35e 15Ben Noordhuis: Follow symlinks in sysroot...
[17:21:38] <ghrust> 13rust/06auto 1451103c8 15Ben Noordhuis: Make check-summary.py support file globbing...
[17:21:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:23:36] *** bstrie_cheersquad is now known as bstrie_erudecorp
[17:23:50] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[17:31:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[17:31:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14cd4b88a to 14657e353: 02http://git.io/N3iJvQ
[17:31:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[17:31:40] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:31:40] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0LUlfw
[17:31:40] <ghrust> 13rust/06auto 14d908e97 15Steven Fackler: Redo exported macro serialization...
[17:31:40] <ghrust> 13rust/06auto 14ca26658 15bors: auto merge of #11720 : sfackler/rust/macro-export-source, r=alexcrichton...
[17:31:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:38:16] *** Joins: canhtak (canhtak@moz-CEAFB489.wl.t.ulaval.ca)
[17:41:32] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:41:32] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ca26658 to 14657e353: 02http://git.io/N3iJvQ
[17:41:32] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:41:33] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:41:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/SFcy8A
[17:41:33] <ghrust> 13rust/06auto 14a3c5ed2 15aydin.kim: update llvm
[17:41:33] <ghrust> 13rust/06auto 140d00e1b 15bors: auto merge of #11743 : aydinkim/rust/work, r=alexcrichton...
[17:41:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:42:07] <acrichto> god I hate llvm upgrades
[17:42:13] <acrichto> literally everything always breaks
[17:42:27] <eddyb> acrichto: are you doing one?
[17:42:34] <acrichto> we have one active
[17:42:35] <acrichto> ^
[17:42:56] <acrichto> not a rebase though
[17:43:03] <acrichto> just an extra patch from samsung I think
[17:43:15] <eddyb> I have that one tiny patch, curious if it has any impact on rustc
[17:43:29] <strcat> acrichto: ugh. I can't figure out how to communicate that ptrs are non-null to LLVM :(
[17:43:40] <strcat> branch to unreachable is optimized out as dead due to http://llvm.org/bugs/show_bug.cgi?id=810
[17:43:49] <acrichto> really? I figured there'd be like a notnull attribute or something
[17:43:53] <strcat> nope
[17:43:59] <strcat> pub fn foo(x: &int) -> bool {
[17:44:01] <strcat>     Some(x) == None
[17:44:03] <strcat> }
[17:44:14] <strcat>   %2 = icmp eq i64* %1, null
[17:44:15] <acrichto> argh that's what we have rust for lol
[17:44:16] <strcat>   %. = zext i1 %2 to i8
[17:44:18] <strcat>   ret i8 %.
[17:44:19] <acrichto> we *know* that's not null
[17:44:43] <strcat> acrichto: this is hurting iterators in some cases :(
[17:44:52] <acrichto> yeah I saw
[17:44:55] * strcat sad
[17:45:21] <acrichto> is there like a no-op thing we can do?
[17:45:26] <acrichto> like add a nullptr somewhere and say noalias?
[17:45:31] <eddyb> it's really funny when it breaks obvious constant stuff. well, the pointer isn't constant
[17:45:33] <eddyb> acrichto: hahaha
[17:45:44] <strcat> acrichto: it will optimize out a no-op
[17:45:47] <acrichto> #llvm may no more
[17:45:52] <acrichto> know*
[17:45:56] <strcat> acrichto: yeah they said to branch to unreachable
[17:45:57] * acrichto needed more sleep
[17:45:58] <strcat> doesn't work
[17:46:00] <strcat> due to that bug
[17:46:09] <acrichto> aww
[17:46:12] <eddyb> I actually haven't thought of a global noalias null before
[17:46:20] <strcat> eddyb: null is already noalias
[17:46:25] <acrichto> who wants to make an  llvm patch!
[17:46:36] <strcat> but how to do it?
[17:46:41] <strcat> could add ptrs to range metadata
[17:47:03] <acrichto> so llvm seriously doesn't have a mode to say "I know this isn't null?"
[17:47:09] <acrichto> that's how C++ &-references work, right?
[17:47:29] <strcat> acrichto: yes
[17:47:31] <strcat> it's sad
[17:48:00] <acrichto> argh
[17:48:10] <acrichto> that's like a serious thing we should fix in llvm
[17:48:13] <strcat> acrichto: gcc even has a nonnull parameter attribute
[17:48:18] <strcat> and clang supports it, for warnings
[17:48:22] <eddyb> lol
[17:48:23] <strcat> but unlike gcc doesn't use it to optimize
[17:48:38] <eddyb> *warnings*
[17:48:47] <strcat> gcc uses it for warnings too ;p
[17:49:02] <acrichto> ugh
[17:49:03] <acrichto> cmon llm
[17:49:05] <acrichto> llvm*
[17:49:08] <acrichto> I thought you were better than that
[17:49:12] <strcat> causes the compiler to check that, in calls to my_memcpy, arguments dest and src are non-null. If the compiler determines that a null pointer is passed in an argument slot marked as non-null, and the -Wnonnull option is enabled, a warning is issued. The compiler may also choose to make optimizations based on the knowledge that certain function arguments will never be null. 
[17:49:14] <eddyb> strcat: so here's a thought. let's do the abort thing http://llvm.org/bugs/show_bug.cgi?id=810#c13
[17:49:38] <strcat> eddyb: can't just insert 100000000 aborts
[17:49:41] <strcat> it will be worse.
[17:49:54] <acrichto> they'd all get optimized away?
[17:49:56] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[17:50:03] <acrichto> or hm maybe they wouldn't
[17:50:04] <eddyb> strcat: then add an alwaysinline attribute on the fake abort and run always-inline again
[17:50:07] <strcat> acrichto: no, for the same reason it doesn't optimize away these checks
[17:50:13] <acrichto> yeah
[17:50:22] <eddyb> s/again//
[17:50:56] <eddyb> strcat: we can mark functions as pure, right?
[17:51:05] <strcat> eddyb: sure, it will remove the call to it then
[17:51:31] <strcat> anyway I dunno
[17:51:39] <strcat> I don't want to add branches everywhere
[17:51:39] <eddyb> strcat: I'm curious if that hack would actually work :D
[17:51:42] <strcat> it complicates datum.rs
[17:51:54] <strcat> you have to return new blocks
[17:52:00] <eddyb> strcat: there's a function in base.rs which creates datums for all arguments
[17:52:12] <strcat> I don't just want to do it for arguments
[17:52:24] <eddyb> that would fix the iterators, wouldn't it?
[17:52:31] <strcat> probably
[17:52:39] *** Joins: lpy_ (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[17:52:41] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[17:53:03] *** Quits: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP) (Connection reset by peer)
[17:53:19] <eddyb> strcat: I understand your reluctance. there's places that don't deal well with changing the block - see my 3 trans bugs
[17:53:52] *** Joins: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP)
[17:54:32] *** Quits: lpy_ (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[17:55:14] *** Quits: jdm (jdm@moz-BDD802ED.hfc.comcastbusiness.net) (Quit: Lost terminal)
[17:56:32] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:56:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/5-GOEw
[17:56:33] <ghrust> 13rust/06auto 14a3c5ed2 15aydin.kim: update llvm
[17:56:33] <ghrust> 13rust/06auto 14c6434ad 15bors: auto merge of #11743 : aydinkim/rust/work, r=alexcrichton...
[17:56:33] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:56:34] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[17:56:35] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140d00e1b to 14657e353: 02http://git.io/N3iJvQ
[17:56:35] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[17:57:52] <eddyb> pcwalton should get in here so I can tell him I can't rebase until https://github.com/mozilla/rust/pull/11595 gets merged
[17:58:18] <acrichto> if anyone sees the llvm PR fail again
[17:58:19] <acrichto> ping me
[17:58:32] <acrichto> I don't want to miss it this time
[18:02:00] <pnkfelix> acrichto: no triage mtg today, right?
[18:02:07] <acrichto> I don't think so
[18:02:14] <acrichto> due to BONUS TRIAGE
[18:02:23] <pnkfelix> acrichto: great, great.  I get to go home an hour early.  :)
[18:02:28] <acrichto> hehe
[18:03:47] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[18:03:47] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:04:03] <eddyb> [19:57] <eddyb> pcwalton should get in here so I can tell him I can't rebase until https://github.com/mozilla/rust/pull/11595 gets merged
[18:04:19] <pcwalton> yeah, I figured
[18:04:23] <pcwalton> 11595 needs a rebase too though :)
[18:05:31] <eddyb> pcwalton: that's waiting on nmatsakis to finish reading it, because I need to fix some nits, too
[18:05:36] <pcwalton> ok
[18:05:43] * pcwalton wants that to land :)
[18:08:41] *** Joins: jdm (jdm@moz-C07D5168.p2p.sfo1.mozilla.com)
[18:09:24] <acrichto> we should upgrade llvm by doing a try push and then force pushing to master
[18:09:28] <acrichto> it would be so much easier
[18:09:31] <acrichto> "just deal with it"
[18:10:34] <acrichto> pcwalton: interested in your thoughts on https://github.com/mozilla/rust/pull/11754
[18:11:08] <pcwalton> +a million
[18:11:24] *** Joins: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[18:11:24] *** ChanServ sets mode: +qo brson brson
[18:12:37] <eddyb> acrichto: #[must_use] sounds like what I was talking about when I implemented formatting with continuations :D
[18:12:47] <acrichto> howso?
[18:13:05] <eddyb> though you put it on types... hmm
[18:13:46] *** Joins: mankyKitty (Instantbir@moz-21AD3B58.rev.sfr.net)
[18:14:12] <eddyb> I guess I could have a newtype of a closure and put #[must_use] on that
[18:14:23] <acrichto> pcwalton: oh I found a typo in the description, unused_result is turned off by default
[18:16:14] <pcwalton> brson: nmatsakis: ^
[18:16:21] <pcwalton> if you guys say this is OK I'll just r+ it
[18:17:30] <eddyb> acrichto: oh, I know where I wanted must_use for *return values* - &Block in trans, there's code that assumes the function it called returns the same block (until someone like me rewrites it and gets bitten by it)
[18:18:16] <acrichto> eddyb: would #[warn(unused_result)] for middle::trans work?
[18:18:45] <eddyb> acrichto: does that work regardless of returned type?
[18:18:56] <acrichto> it ignores (), !, and bool
[18:19:01] <eddyb> heh
[18:19:12] <eddyb> acrichto: I wonder why bools especially
[18:19:26] <acrichto> oh hm maybe I should remove that
[18:19:30] <acrichto> the old for-loop protocol returned bool
[18:19:32] <eddyb> I guess I could try it, might blow up in my face
[18:19:33] <acrichto> there's still a lot of that in libstd
[18:19:46] <acrichto> I got to libsyntax with unused_result turned on by default before I gave up
[18:20:04] <acrichto> we should put #[warn(unused_result)] on std::os
[18:20:09] <acrichto> and things have have lots of libc calls
[18:20:16] <acrichto> I caught a few unused results here and there
[18:24:34] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[18:32:36] <cmr> acrichto: for #11756, all tests pass on linux/os x, but it explodes compiling stage1 std (runtime asserts)
[18:32:57] <acrichto> cmr: only for windows?
[18:33:03] <cmr> and freebsd
[18:33:06] <acrichto> wheeee
[18:33:38] <cmr> freebsd might just be a problem with our mmap bindings, though I didn't see any obvious problems, after I fixed 0-sized mappings
[18:34:31] <cmr> hm
[18:34:32] <cmr> one sec
[18:34:49] <cmr> the PR wasn't up to date, I never pushed my branch
[18:35:41] <cmr> https://github.com/cmr/rust/tree/guard_pages
[18:35:41] <strcat> meh, I'll just add a nonnull attribute to LLVM
[18:35:43] <cmr> sorry about that
[18:35:50] <acrichto> cmr: no worries
[18:36:41] <acrichto> oh god
[18:36:44] <acrichto> that's a lot of commits
[18:36:55] <cmr> yeah I hadn't squashed them yet
[18:37:10] <cmr> wanted it to be easy to bisect if I accidentally all the things
[18:37:57] <cmr> each commit represents a probably 30 minute try build :(
[18:38:05] <acrichto> :(
[18:38:24] <acrichto> man my freebsd vm probably has to build llvm :(
[18:40:36] <acrichto> woohoo something successfully upgraded llvm
[18:40:44] <acrichto> now the rest of the bots just need to not barf on themselves
[18:40:49] * acrichto looks at freebs
[18:40:50] * acrichto looks at freebsd
[18:50:15] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[18:53:32] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[18:54:51] <mankyKitty> acrichto: running the tests for that revert/flip/iter change now, should be pushed up in a few :D
[18:55:07] <acrichto> mankyKitty: awesome!
[18:55:20] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[18:55:37] *** Quits: nate (user@C3BA61EE.F9392C3A.CB3564DC.IP) (Quit: .)
[18:55:51] *** Joins: nate (pinkeh@moz-B8462C56.members.linode.com)
[18:56:33] <nate> jld: OK, I submitted a PR for 5172: https://github.com/mozilla/rust/pull/11759
[18:57:03] *** Quits: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP) (Ping timeout)
[18:57:50] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[18:58:34] <mankyKitty> is rustc-stage1 sufficient to run tests?
[18:58:46] <eddyb> mankyKitty: check-stage1
[18:59:03] <mankyKitty> eddyb: Wicked, thank you. 
[18:59:29] <eddyb> it works most of the time, though last time I tried it I got a weird error with phase(syntax) in one test
[18:59:32] *** Joins: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP)
[18:59:44] <eddyb> I guess that needs a snapshot (maybe it was before the current snapshot)
[19:00:04] <mankyKitty> yeah I just had that error too, for now I was assuming it was my machine.... OSX & LLVM = Funnies
[19:02:32] * acrichto shakes fist at flaky tests
[19:02:37] <acrichto> what is this even
[19:02:38] <acrichto> http://buildbot.rust-lang.org/builders/auto-mac-32-nopt-t/builds/1582/steps/test/logs/stdio
[19:02:56] *** Quits: gwty (gwtypc@C3BB3CEB.27BB4920.6BE1A500.IP) (Ping timeout)
[19:04:45] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:06:38] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[19:06:38] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c6434ad to 14657e353: 02http://git.io/N3iJvQ
[19:06:38] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[19:06:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[19:06:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Iap9kA
[19:06:39] <ghrust> 13rust/06auto 14a3c5ed2 15aydin.kim: update llvm
[19:06:39] <ghrust> 13rust/06auto 14bf75105 15bors: auto merge of #11743 : aydinkim/rust/work, r=alexcrichton...
[19:06:39] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[19:10:01] *** Joins: gwty (gwtypc@7482879B.EC11C8E0.8A00C703.IP)
[19:14:39] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[19:26:59] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Client exited)
[19:28:28] <mankyKitty> acrichto: is the gated-phase.rs one of those flaky tests? >.>
[19:29:19] <acrichto> I should be xfail'd at stage1
[19:29:25] <acrichto> or so I thought
[19:29:58] <mankyKitty> it's a compile-fail test failing for check-state1 for me at the moment? 
[19:31:18] <sfackler> eddyb: I may have missed an xfail-stage1 somewhere. do you remember what test it was?
[19:31:32] <eddyb> sfackler: read above :)
[19:31:41] <mankyKitty> sfackler: [compile-fail] compile-fail/gated-phase.rs
[19:32:08] <acrichto> cmr: looks like MAP_STACK in freebsd is just broken
[19:32:12] <acrichto> cmr: http://lists.freebsd.org/pipermail/freebsd-bugs/2011-July/044840.html
[19:32:23] *** Joins: TimAbraldes (quassel@moz-BF4D134B.hsd1.or.comcast.net)
[19:36:20] *** Quits: gwty (gwtypc@7482879B.EC11C8E0.8A00C703.IP) (Ping timeout)
[19:37:06] <sfackler> mankyKitty: gated-phase won't be flaky, it'll just never work at stage1 before a snapshot, but there is one now so it shouldn't be an issue
[19:38:26] *** Joins: gwty (gwtypc@33570BDB.CF90531.137C914F.IP)
[19:38:47] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[19:39:21] <brson> acrichto: why so many @bors: retry's today?
[19:39:36] <mankyKitty> sfackler: So a full build first, then the checks should be okay? It's the only test failure I'm seeing
[19:39:47] <acrichto> brson: llvm upgrade is wreaking havoc
[19:40:08] *** Quits: gwty (gwtypc@33570BDB.CF90531.137C914F.IP) (Ping timeout)
[19:40:13] <acrichto> brson: as usual the llvm upgrade failed the first time, but apparently llvm-mc didn't get built after it failed, so everything in the future died
[19:41:03] <sfackler> if it's the only test failure you're seeing then I'd just ignore it
[19:41:23] <mankyKitty> okey dokey
[19:41:27] <brson> acrichto: k. thanks for working through it
[19:41:30] <acrichto> brson: upgrading LLVM is turning out to be a constant huge pain which worries me
[19:42:21] *** Joins: gwty (gwtypc@33570BDB.CF90531.137C914F.IP)
[19:44:06] *** Quits: gwty (gwtypc@33570BDB.CF90531.137C914F.IP) (Ping timeout)
[19:46:01] *** Joins: gwty (gwtypc@3C59E75C.3E0F208F.137C914F.IP)
[19:47:48] <acrichto> zomg the bots
[19:48:00] * acrichto really wants to just merge this update
[19:48:36] <cmr> acrichto: damn. well, another cfg for freebsd without MAP_STACK is fine.
[19:48:50] <acrichto> cmr: yeah, moving over to windows now
[19:48:54] <acrichto> my vm is super slow :(
[19:49:03] <acrichto> oh it's on rustuv.dll!
[19:49:10] <acrichto> ./configure takes like 5 minutes
[19:49:45] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[19:51:33] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[19:51:33] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14bf75105 to 14657e353: 02http://git.io/N3iJvQ
[19:51:33] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[19:51:33] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:51:33] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/TrR5NA
[19:51:33] <ghrust> 13rust/06auto 14a3c5ed2 15aydin.kim: update llvm
[19:51:33] <ghrust> 13rust/06auto 14e14c606 15bors: auto merge of #11743 : aydinkim/rust/work, r=alexcrichton...
[19:51:33] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:54:18] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[19:56:01] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[20:03:13] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[20:05:30] *** bstrie_erudecorp is now known as bstrie_capn
[20:08:53] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[20:10:09] *** Joins: jensnock_ (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[20:10:53] <mankyKitty> acrichto: hey, sorry to bug you. I've rechecked my tests for the flip -> rev PR and pushed up my changes. Had some issues with rebase, could you give it the stink eye and see if it's okay please? :)
[20:22:45] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[20:24:14] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:25:33] <bstrie_capn> acrichto: so the unused result lint is really only for use with the Result type?
[20:25:53] <bstrie_capn> acrichto: cuz if so that's a great compromise and whoever came up with it should get kudos
[20:26:03] <acrichto> bstrie_capn: it'd only be turned on by default for Result, but you could turn it on for everything
[20:26:15] <acrichto> I like anything doing lots of C ffi should turn it on by default
[20:26:16] <bstrie_capn> ah, so like an attribute then?
[20:26:23] <bstrie_capn> #[warn_unused] or somesuch?
[20:26:29] <acrichto> mankyKitty: sure! I'll take a look, thanks again!
[20:26:32] <acrichto> #[warn(unused_result)]
[20:26:36] <acrichto> just a lint attribute
[20:26:49] <bstrie_capn> I meant on a type that you don't want to be unused
[20:26:55] <bstrie_capn> rather than just turning it on for all types in a crate
[20:27:09] <acrichto> oh #[must_use]
[20:27:10] <acrichto> on a type
[20:27:14] <bstrie_capn> cool
[20:27:16] <bstrie_capn> I like it
[20:27:18] <acrichto> that'll warn by default if your type isn't used
[20:28:08] <bstrie_capn> as long as I can ignore most things while getting warned if I ignore result, I'll be very happy :)
[20:28:46] <bstrie_capn> like, this is a legitimately great idea
[20:28:50] <bstrie_capn> and will help spur use of Result
[20:29:22] <bstrie_capn> and help keep it from succumbing to the same fate as Either
[20:29:49] <acrichto> hehe
[20:30:00] <acrichto> yeah I hope this ends up canonicalizing a small set of types which are used to transmit errors
[20:30:04] <bstrie_capn> like, maybe we just solved error handling forever
[20:30:08] <bstrie_capn> somebody write a paper
[20:30:14] <acrichto> lol
[20:32:10] <acrichto> argh this patch will never end
[20:32:44] *** Joins: new_one (new_one@C6D35DA1.641FCA23.B3C0173E.IP)
[20:35:42] *** Quits: jensnock_ (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[20:36:46] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[20:36:46] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e14c606 to 14657e353: 02http://git.io/N3iJvQ
[20:36:46] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[20:36:50] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:36:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/yxKyhg
[20:36:50] <ghrust> 13rust/06auto 14a3c5ed2 15aydin.kim: update llvm
[20:36:50] <ghrust> 13rust/06auto 14e0c3ed7 15bors: auto merge of #11743 : aydinkim/rust/work, r=alexcrichton...
[20:36:50] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:37:26] <acrichto> zomg I can run binaries on windows
[20:37:30] <acrichto> without copying them all over the place
[20:37:35] <acrichto> b/c there's no more dll deps
[20:37:37] <acrichto> this just made my day
[20:40:10] <mankyKitty> \o/
[20:41:32] <acrichto> mankyKitty: oh sorry just got around to looking at it, but it appears that a rebase has gone wrong
[20:41:37] <acrichto> mankyKitty: https://github.com/mozilla/rust/pull/11686/commits
[20:41:51] <acrichto> that should have a clean history of just your commits, but it appears that you've pulled in a few more
[20:42:09] <mankyKitty> acrichto: gah.. that's what I feared
[20:42:25] <acrichto> you may want to just amke a new branch and cherry-pick your commits
[20:42:37] <acrichto> then force-push to the same remote branch
[20:43:07] <mankyKitty> after a rebase on that branch? same procedure?
[20:43:49] <acrichto> kinda
[20:43:57] <acrichto> locally you'd create a new branch off of origin/master
[20:44:02] <acrichto> cherry-pick your commits onto that branch
[20:44:02] <mankyKitty> yep
[20:44:07] <acrichto> then force-push the local branch to the same remote branch
[20:44:26] <mankyKitty> ahh okay
[20:45:26] <mankyKitty> Sorry for git nubbins. We used it at the last place I worked but it was purely merge, we used rebase for a while but we kept breaking everything >.>
[20:46:32] <acrichto> no problem!
[20:46:38] <acrichto> it took me forever to get used to git
[20:49:58] <acrichto> cmr: hm so on windows it's failing in VirtualFree
[20:50:03] <acrichto> it's returning ERROR_INVALID_ADDRES
[20:51:38] <cmr> hm
[20:51:46] <cmr> is the stored address wrong?
[20:52:03] <acrichto> I don't tink so
[20:52:14] <acrichto> apparently there's a PAGE_GUARD thing though
[20:52:22] <acrichto> which you can pass to VirtualAlloc
[20:52:42] <acrichto> man windows has some really good docs
[20:53:10] <eddyb> acrichto: how else could you do anything :P?
[20:53:36] <acrichto> I know right lol
[20:54:56] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[20:55:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[20:55:49] <acrichto> oh nvmd PAGE_GUARD isn't what we want
[20:55:51] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[20:56:53] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[20:57:35] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[20:59:18] <bjz> pcwalton nmatsakis: posted some things on the module RFC that might be of interest https://github.com/mozilla/rust/issues/11745
[20:59:23] <mankyKitty> acrichto: almost there >< 
[20:59:30] <pcwalton> bjz: cool, will take a look :)
[21:00:22] <bjz> pcwalton: I found some interesting papers to do with finding common ground between ML-style modules and type classes
[21:01:22] *** Joins: dherman (dherman@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:01:23] *** ChanServ sets mode: +ao dherman dherman
[21:01:42] <acrichto> cmr: ok this is weird VirualFree(VirtualAlloc()) fails
[21:01:44] <mankyKitty> acrichto: woo, okay. Are you sure I should force push to the same remote branch? it's telling me everything is up to date 
[21:02:06] <acrichto> mankyKitty: make sure you're pushing the right local branch
[21:02:40] <mankyKitty> acrichto: I'm on the new one, attempt to push to original
[21:02:50] <bjz> pcwalton: I have a feeling like resolving the underlying stuff might help us on the way to sorting out paths and the static item syntax - but its just an intuition. You almost certainly have been thinking about this though, so I'm probably stepping on well-trodden ground.
[21:03:16] <acrichto> mankyKitty: that'd look like "git push your-remote local-branch-name:remote-branch-name
[21:03:17] <acrichto> "
[21:04:12] <mankyKitty> acrichto: ah, except for the local:remote, I was simply going "git push -f my-remote remote-branch-name"
[21:04:22] <mankyKitty> sorry ><
[21:04:45] <acrichto> hehe, git is not exactly the easiest thing in the world
[21:05:00] <acrichto> looks like there's still the extra commits there?
[21:05:15] <mankyKitty> it always makes sense once I get what I've done though.. which is nice
[21:05:20] <eddyb> git rebase --onto is a cool toy btw
[21:05:35] <mankyKitty> last workplace put the fear of rebase into me
[21:05:40] *** Quits: jdm (jdm@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Lost terminal)
[21:05:41] <mankyKitty> will have to read more about it
[21:06:06] <mankyKitty> HOLY SNAPPING BABY RAPTOR LASERS... okay so it worked
[21:06:39] * mankyKitty gone done un-f*ked it. :D
[21:07:14] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[21:08:20] <acrichto> cmr: "If the dwFreeType parameter is MEM_RELEASE, this parameter must be 0 (zero)."
[21:08:23] <acrichto> oh!
[21:08:38] <acrichto> bingo
[21:09:20] <acrichto> cmr: as in, apparently you're not supposed to specify the size in VirtualFree
[21:10:13] <bjz> pcwalton: playing with kinda 'weird' was of organising code, for example: https://gist.github.com/bjz/844c9dd78876e6006249
[21:10:27] <cmr> acrichto: oh.
[21:10:31] <cmr> acrichto: well, that'd do it.
[21:10:38] <acrichto> cmr: lol talk about fine print
[21:10:43] <acrichto> http://msdn.microsoft.com/en-us/library/windows/desktop/aa366803%28v=vs.85%29.aspx
[21:10:48] <acrichto> 0,             // Bytes of committed pages
[21:10:49] <acrichto> saw that
[21:10:54] <acrichto> and I was like what?!
[21:11:42] <acrichto> mankyKitty: looks like doc/guide-container.md needs another update
[21:11:59] <mankyKitty> acrichto: oh fudge
[21:12:01] <acrichto> mankyKitty: other than that, looks good to me!
[21:14:03] <bjz> pcwalton: and I've also experimented with the way where the MLs use something like, `semantic_thing.t` for types, which I gather Rust used to do along time ago. But I might just be bike-shedding here - dunno. Just trying to understand things better I guess, but playing around with various ways of looking at the stuff we already have.
[21:14:12] <bjz> s/but/by/
[21:14:15] <mankyKitty> I can just commit that and throw it up now can't I? Since I we fixed the git-astrophy? 
[21:15:00] <acrichto> mankyKitty: you could just amend a previous commit
[21:15:25] <mankyKitty> acrichto: zzzzz forgot, thanks
[21:17:09] <bjz> pcwalton: and of course many boats have already sailed, and you have to settle on something lest you be moving chairs around until the end of time - never finding 'the perfect way'
[21:19:40] <acrichto> mankyKitty: thanks for the awesome work!
[21:20:37] <mankyKitty> acrichto: You're extremely welcome. I hope I can contribute a lot more than just some name changes, even if it was a paper cut issue. Pushed fix for doco wording btw.
[21:21:45] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[21:21:45] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e0c3ed7 to 14657e353: 02http://git.io/N3iJvQ
[21:21:45] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[21:21:47] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:21:47] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MJd9ZA
[21:21:47] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[21:21:47] <ghrust> 13rust/06auto 143892f4e 15bors: auto merge of #11761 : alexcrichton/rust/epoll-eintr, r=alexcrichton
[21:21:47] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:22:01] *** Joins: tikue (tkuehn@268C2DFE.FAD414BA.D74CC41D.IP)
[21:22:28] <tikue> how about `channel() -> (Source, Port)`
[21:22:48] <tikue> kinda unwieldy i guess
[21:24:04] <bjz> tikue: I find the Chan/Port naming always hard to remember - ie. the which is the sender, which is the reciever
[21:24:16] <tikue> right
[21:24:16] <bjz> always have to look it up
[21:24:20] <tikue> that's why Source, Port would be nice
[21:24:30] <brson> `chan() -> (Source, Sink)`
[21:24:34] <bjz> yeah
[21:24:37] <tikue> except it's missing two metaphors
[21:24:39] <tikue> port is for ships
[21:24:42] <tikue> source is for streams
[21:24:57] <tikue> sink?
[21:25:11] <bjz> `Tap, Plughole`
[21:25:12] <tikue> like, where the water goes down?
[21:25:17] <bjz> xD
[21:25:42] <mankyKitty> chan() -> (Slurp, Barf) imo
[21:25:46] <tikue> `chan() -> (Source, Mouth)
[21:26:06] <tikue> which is kinda cool bc port can receive from multiple sources
[21:26:17] <tikue> and mouth is where a stream joins a river
[21:26:44] <bjz> brson: but do you recv *from* the Source or send *via* a Source
[21:26:53] <kimundi> wormhole() -> (In, Out) :P
[21:27:11] <tikue> bjz: you send via a channel or stream
[21:27:23] <tikue> bjz: the source is where anything flowing down a channel originates
[21:27:46] *** bstrie_capn is now known as bstrie_parenthetical
[21:27:47] <tikue> object.method() isn't do something to object, it's have object do something
[21:28:21] * bjz unidirectional channels can be confusing
[21:28:21] * bjz looks up the naming in the CML book
[21:29:56] *** Quits: mankyKitty (Instantbir@moz-21AD3B58.rev.sfr.net) (Quit: mankyKitty)
[21:30:06] <tikue> (Source, Conflux)
[21:30:36] *** Quits: new_one (new_one@C6D35DA1.641FCA23.B3C0173E.IP) (Ping timeout)
[21:32:27] *** Quits: TimAbraldes (quassel@moz-BF4D134B.hsd1.or.comcast.net) (Connection reset by peer)
[21:32:46] *** Joins: dbaupp (Thunderbir@moz-A840EB3D.lns20.syd6.internode.on.net)
[21:32:51] <bjz> so in the CML book, Reppy uses `channel<T>() -> (In<T>, Out<T>); fn recv<T>(In<T>) -> T; fn send<T>(Out<T>)` and 
[21:33:05] <tikue> no no no, not in and out
[21:33:12] <tikue> it's so generic and boring
[21:33:17] <bjz> comm::In is ok
[21:33:23] <tikue> :(
[21:33:33] <bjz> yeah, I know
[21:33:56] *** Joins: new_one (new_one@C6D35DA1.641FCA23.B3C0173E.IP)
[21:34:06] <tikue> idk about others but i typically import all the types i'm using to the local namespace
[21:34:08] <bjz> just trying to think of a name so that folks remember what to call send on, and what to call out on
[21:34:15] <tikue> so i wouldn't say comm::In often
[21:34:16] <bjz> InChan, OutChan
[21:34:42] <bjz> they are two ends of a channel
[21:35:05] <bjz> you send to an outgoing end, and recv through in incoming end
[21:35:20] <tikue> stream() -> (Source, Conflux) 
[21:35:36] <tikue> no ambiguity
[21:35:40] <bjz> (Entrance, Exit) :P
[21:35:58] <tikue> usually the same door ^
[21:36:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[21:36:43] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143892f4e to 14657e353: 02http://git.io/N3iJvQ
[21:36:43] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[21:36:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:36:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1czoBw
[21:36:46] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[21:36:46] <ghrust> 13rust/06auto 144699cb7 15bors: auto merge of #11761 : alexcrichton/rust/epoll-eintr, r=alexcrichton
[21:36:47] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:37:35] <bjz> flight() -> (Departures, Arrivals)
[21:37:55] <tikue> hmmm
[21:37:59] <bjz> xD
[21:38:00] <tikue> that's kinda cool actually
[21:38:02] <tikue> lol
[21:38:22] <tikue> Deparatures.sched()
[21:38:30] <tikue> Arrivals.land()
[21:38:38] <bjz> I think the thing you send to should come first, the thing you recv from should come last
[21:39:13] <tikue> you mean in the tuple?
[21:39:16] <bjz> yep
[21:39:23] <tikue> i have no opinion on that
[21:40:15] <bjz> I know that with concurrent stuff you can start recving before sending, but it might make more sense for us humans
[21:40:52] <bjz> the you will always rev the message after it is sent
[21:41:01] *** Quits: dbaupp (Thunderbir@moz-A840EB3D.lns20.syd6.internode.on.net) (Ping timeout)
[21:41:24] <bjz> so it would make more sense to have the sender before the recver 
[21:41:33] <bjz> I think
[21:41:52] <bjz> atm we have (Port, Chan), but I forget which one is which -_-
[21:42:11] <bjz> (me has even been playing arounf with concurrent stuff lately)
[21:42:43] <tikue> you said "send to" and "recv from" which to me are both port
[21:42:54] *** bstrie_parenthetical is now known as bstrie_remorse
[21:49:28] *** Joins: jdm (jdm@moz-C07D5168.p2p.sfo1.mozilla.com)
[21:51:53] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:51:54] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144699cb7 to 14657e353: 02http://git.io/N3iJvQ
[21:51:54] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:51:55] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[21:51:56] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/k0V6Tw
[21:51:56] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[21:51:56] <ghrust> 13rust/06auto 1464f35ef 15bors: auto merge of #11761 : alexcrichton/rust/epoll-eintr, r=alexcrichton
[21:51:56] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[21:54:33] <bstrie_remorse> now that we have loadable syntax extensions, are we actually using them for e.g. println! or are we still hardcoding those into libsyntax?
[21:54:51] <acrichto> not yet
[21:54:55] <acrichto> not yset using them
[21:55:02] <acrichto> I don't think there's a blocker for using them though
[21:55:04] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[21:55:05] <bstrie_remorse> is there a bug open for that?
[21:55:13] <acrichto> unsure
[21:55:23] <acrichto> other than the general "we shouldn't do this" I doubt it though
[21:55:29] * bstrie_remorse makes one
[21:55:34] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[21:55:53] <sfackler> acrichto: the span issue is a blocker imo, but hopefully my PR will fix that
[21:55:59] <sfackler> then we should be good to go
[21:56:01] <acrichto> ah yes that's right
[21:56:04] <acrichto> I r+'d that right?
[21:56:06] <sfackler> yep
[21:56:10] <acrichto> ugh these llvm upgrades
[21:56:12] <acrichto> I hate them so much
[21:56:33] <sfackler> extracting procedural macros to libstd will be hard, but the macro_rules ones should be super straightforward
[21:56:50] <acrichto> we should definitely start out with those
[21:56:59] <acrichto> it means I can export select! !
[21:57:05] <sfackler> woo!
[21:57:35] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[21:57:54] <bstrie_remorse> https://github.com/mozilla/rust/issues/11763
[21:58:59] <acrichto> bstrie_remorse: I'm going to edit out my typo
[21:59:01] <acrichto> :D
[21:59:34] *** Quits: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Ping timeout)
[22:00:14] <sfackler> bstrie_remorse: it was initially waiting on a snapshot
[22:00:50] <bstrie_remorse> ah ok
[22:00:57] <bstrie_remorse> well as long as someone remembers to do it :P
[22:02:04] <acrichto> we'll have to inject #[phase(syntax, link)] into the libstd injection
[22:02:07] <acrichto> but I think that's the only caveat
[22:02:11] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[22:02:38] <acrichto> "it should land today"
[22:02:41] <acrichto> sfackler you're optimistic
[22:05:20] *** Joins: brson (brson@moz-C07D5168.p2p.sfo1.mozilla.com)
[22:05:20] *** ChanServ sets mode: +qo brson brson
[22:05:36] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[22:06:18] *** Quits: tikue (tkuehn@268C2DFE.FAD414BA.D74CC41D.IP) (Quit: tikue)
[22:07:21] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[22:12:26] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:15:18] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[22:23:37] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[22:23:43] <cmr> acrichto: thanks <3
[22:23:51] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[22:24:08] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:24:11] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:24:51] <aatch> sfackler, is extracting procedural macros *possible*?
[22:25:23] <acrichto> with a dynamic snapshot, it should be in theory possible
[22:25:34] <acrichto> the compiler would compile something and then immediately dlopen() it
[22:25:53] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[22:27:34] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:34:00] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[22:34:17] *** Joins: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP)
[22:35:34] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[22:35:35] *** ChanServ sets mode: +ao pcwalton pcwalton
[22:40:57] <sfackler> aatch: maybe? they'd have to go into a new crate, but I think it'd be doable
[22:41:06] <sfackler> it may require distributing a dynamically linked snapshot
[22:41:48] <sfackler> acrichto: haha
[22:45:31] <acrichto> omg a windows bot succeeded!
[22:45:41] <acrichto> only 13 more to go...
[22:45:49] <acrichto> wow we run a lot of bots
[22:46:15] <aatch> don't we test on like 6 platforms?
[22:46:41] <aatch> linux32,linux64,mac32,mac64,windows and android?
[22:47:11] <acrichto> yeah it's crazy
[22:47:18] <acrichto> and we have like 4 configurations on each one
[22:47:19] <acrichto> kinda
[22:47:26] <acrichto> I guess only 3
[22:47:30] <acrichto> nopt
[22:47:31] <acrichto> nopt-t
[22:47:33] <acrichto> opt
[22:47:36] <acrichto> noptc
[22:47:38] <acrichto> nopt-c
[22:47:43] <acrichto> hm maybe it's a lot...
[22:49:20] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[22:49:43] <acrichto> ugh of coures the slowest mac is running 3 builds right now
[22:50:12] <acrichto> oh no that's a speedy one
[22:53:25] <sfackler> acrichto: the other thing to think about for pulling macros into libstd is what happens with #[no_std];
[22:55:58] *** Joins: dbaupp (Thunderbir@32742E97.D5A1DCF.37681C44.IP)
[22:56:19] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[22:56:45] *** Quits: new_one (new_one@C6D35DA1.641FCA23.B3C0173E.IP) (Client exited)
[22:57:56] <acrichto> aaaaaaaaaaaaaargh
[22:58:18] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
[22:58:24] <acrichto> I hate everthing about our test suite right now
[22:59:10] *** Quits: rca_ (rcatolino@moz-5E0A44D2.adsl.proxad.net) (Ping timeout)
[23:00:50] *** Quits: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP) (Ping timeout)
[23:01:38] *** Joins: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP)
[23:02:07] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[23:02:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/n92HTA
[23:02:07] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[23:02:07] <ghrust> 13rust/06auto 143c9fa9f 15bors: auto merge of #11761 : alexcrichton/rust/epoll-eintr, r=alexcrichton
[23:02:07] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[23:06:25] *** Joins: geoffhill (geoffhill@moz-95FF7399.members.linode.com)
[23:16:41] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:16:41] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143c9fa9f to 14657e353: 02http://git.io/N3iJvQ
[23:16:41] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:21:36] <acrichto> alright, if the entire queue is drained successfully, then we will have under 30 PRs
[23:21:40] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:21:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146416ba5 to 14657e353: 02http://git.io/N3iJvQ
[23:21:40] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:21:41] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[23:21:41] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/Gvkidg
[23:21:41] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[23:21:41] <ghrust> 13rust/06auto 14219478f 15Alex Crichton: Build llvm-extract (needed by codegen tests)
[23:21:41] <ghrust> 13rust/06auto 14be6fb8f 15aydin.kim: update llvm
[23:21:42] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[23:30:08] *** Joins: new_one (new_one@B3C76384.4BFECEA2.B3C0173E.IP)
[23:36:59] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:36:59] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14befa472 to 14657e353: 02http://git.io/N3iJvQ
[23:36:59] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:37:01] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:37:01] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/tL8eiw
[23:37:01] <ghrust> 13rust/06auto 14aa78da3 15Alex Crichton: Handle EINTR in epoll for native timers
[23:37:01] <ghrust> 13rust/06auto 14219478f 15Alex Crichton: Build llvm-extract (needed by codegen tests)
[23:37:02] <ghrust> 13rust/06auto 14be6fb8f 15aydin.kim: update llvm
[23:37:02] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:37:21] <brson> i'm glad so many pr's are approved
[23:38:01] <acrichto> hopefully something can land soon :\
[23:42:52] *** Quits: gwty (gwtypc@3C59E75C.3E0F208F.137C914F.IP) (Connection reset by peer)
[23:57:00] *** Joins: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP)
[23:59:04] *** Quits: lpy (lpy@6D018ABA.B31F127E.E99F7FDB.IP) (Ping timeout)
