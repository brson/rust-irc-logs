[00:00:16] <leonvv> tjc: Okay, thanks, will try it out!
[00:00:24] <jmgrosen> bjz: eh, leave the bugs for later :P
[00:00:37] <bjz> jmgrosen: bugs?
[00:00:48] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[00:00:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/zySq4Q
[00:00:48] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:01:11] <jmgrosen> bjz: i meant bug-fixing -- are bugs what you meant by stability? or am i just confused? o_O
[00:01:23] <bjz> jmgrosen: I mean stability from a design point of view
[00:01:57] <jmgrosen> bjz: oh -- well at this point lmath-rs didn't have many users anyway
[00:02:05] <jmgrosen> bjz: and rust users should expect instability :P
[00:02:07] <bjz> yeah
[00:02:18] <jmgrosen> ARGH
[00:02:22] <jmgrosen> still no full backtrace :(
[00:02:29] <bjz> probably because its been broken more often than not -_-
[00:02:39] *** Quits: jclements (jclements@moz-62D9F423.wireless.calpoly.edu) (Quit: jclements)
[00:03:02] <jmgrosen> well, should probably get started on homework‚Ä¶ :(
[00:03:06] <bjz> oki
[00:03:09] <bjz> gl
[00:03:16] <jmgrosen> i'll look at cgmath if i get a chance after i'm done
[00:03:20] <jmgrosen> signing off
[00:03:23] <bjz> sure
[00:03:24] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[00:04:59] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:05:47] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:05:48] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Qr6ktw
[00:05:48] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:05:51] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:05:51] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/SvhCww
[00:05:51] <ghrust> 13rust/06auto 140ea2a20 15Niko Matsakis: Add PointerKind to LpDeref
[00:05:51] <ghrust> 13rust/06auto 146b23d20 15Niko Matsakis: Prohibit assignment to `&mut` pointers that are found in frozen or borrowed locations....
[00:05:51] <ghrust> 13rust/06auto 1435a4177 15Niko Matsakis: Extend aliasability check to uncover `& &mut &mut` and the like
[00:05:53] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:08:11] <nmatsakis> it might be nice if you could use Foo(a, b) to match against structs
[00:08:14] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[00:08:26] <nmatsakis> but I guess it'd pose some challenges
[00:08:35] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[00:08:40] <nmatsakis> in the matter of value vs type namespace
[00:09:28] *** Joins: maik (maik___@moz-64456714.dip0.t-ipconnect.de)
[00:10:09] <tikue_> rusti: enum Foo { zero }; static z: uint = zero as uint;
[00:10:09] -rusti- ()
[00:10:40] <tikue_> does that work at the module level?
[00:10:48] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr)
[00:11:14] <bjz> rusti: struct A { x: int } let a = A { x: 1 }; let A { x } = a; x
[00:11:15] -rusti- 1
[00:11:21] <bjz> nmatsakis: ^
[00:11:25] <bjz> ?
[00:12:11] <nmatsakis> bjz: yes, I know about this shorthand
[00:12:40] <nmatsakis> bjz: but something you want something like `A { x: 0 }` which is just longer than `A(0)`
[00:12:44] <nmatsakis> *sometimes
[00:12:46] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[00:12:55] <tikue_> nmatsakis: i just wanted that literally a minute ago
[00:13:04] <tikue_> but i just wrote a constructor
[00:13:19] <bjz> nmatsakis: I wish you could do let a = A { 0 };
[00:13:34] <tikue_> using constructors isn't that much of a hassle
[00:13:56] <bjz> nmatsakis: I normally have A::new(0)
[00:14:03] <tikue_> me2
[00:14:11] <nmatsakis> writing a constructor is fine, but it doesn't work in a pattern
[00:14:29] <nmatsakis> anyway, it's not a big deal. it's just something that was causing me to reindent a lot :)
[00:14:50] <bjz> nmatsakis: If you can destructure like A { x }, then it's odd you can't construct like that
[00:15:18] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[00:15:29] <bjz> rusti: struct A { x: int } let a = A { x: 1 }; match a { A { x } => x }
[00:15:30] -rusti- 1
[00:15:40] <bjz> nmatsakis: if that makes sense
[00:15:58] <bjz> nmatsakis: like, I want Vec3 { 1, 2, 3 }
[00:16:11] <Florob> rusti: struct A { x: int } let a = A { x: 1 }; match a { A { y } => x }
[00:16:12] -rusti- <anon>:5:70: 5:71 error: unresolved name `x`. Did you mean `a`?
[00:16:12] -rusti- <anon>:5          struct A { x: int } let a = A { x: 1 }; match a { A { y } => x }
[00:16:12] -rusti-                                                                                ^
[00:16:13] -rusti- error: aborting due to previous error
[00:16:13] -rusti- application terminated with error code 101
[00:16:15] <nmatsakis> I see
[00:16:52] <bjz> nmatsakis: would also be nice if struct Foo(Vec3); allowed you to do Foo { 1, 2, 3 }
[00:16:53] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[00:17:35] <bjz> nmatsakis: dunno if that would push the syntax in bad ways though
[00:17:46] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:18:00] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[00:18:10] <bjz> nmatsakis: might paint you into a corner for future changes (can't think of what though)
[00:18:16] <tikue_> rusti: enum Category { A, B, C, D, NUM_CATEGORIES } type Categories = [Category, ..NUM_CATEGORIES as uint];
[00:18:17] -rusti- error: internal compiler error: node_id_to_type: no type for node `expr NUM_CATEGORIES as uint (id=16)`
[00:18:17] -rusti- application terminated with error code 101
[00:18:40] <nmatsakis> bjz: it would certainly complicate things
[00:18:43] <tikue_> rusti: enum Category { A, B, C, D, NUM_CATEGORIES } static NCATEGORIES: uint = NUM_CATEGORIES as uint; type Categories = [Category, ..NCATEGORIES];
[00:18:44] -rusti- error: internal compiler error: node_id_to_type: no type for node `expr NUM_CATEGORIES as uint (id=16)`
[00:18:44] -rusti- application terminated with error code 101
[00:19:26] <tikue_> rusti: enum Category { A, B, C, D, NUM_CATEGORIES } static NCATEGORIES: uint = NUM_CATEGORIES as uint;
[00:19:27] -rusti- ()
[00:19:29] <tikue_> weird
[00:19:49] <tikue_> any idea what's going on there
[00:21:05] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[00:21:44] <tikue_> rusti: enum Category { A, B, C, D, NUM_CATEGORIES } static NCATEGORIES: uint = NUM_CATEGORIES as uint; let v: [Category, ..NCATEGORIES] = [A, B, C, D];
[00:21:45] -rusti- error: internal compiler error: node_id_to_type: no type for node `expr NUM_CATEGORIES as uint (id=16)`
[00:21:45] -rusti- application terminated with error code 101
[00:21:57] <tikue_> rusti: enum Category { A, B, C, D, NUM_CATEGORIES } static NCATEGORIES: uint = NUM_CATEGORIES as uint; let v = [A, B, C, D];
[00:21:58] -rusti- <anon>:5:109: 5:110 warning: unused variable: `v` [-W unused-variable (default)]
[00:21:58] -rusti- <anon>:5          enum Category { A, B, C, D, NUM_CATEGORIES } static NCATEGORIES: uint = NUM_CATEGORIES as uint; let v = [A, B, C, D];
[00:21:58] -rusti-                                                                                                                       ^
[00:21:59] -rusti- ()
[00:23:08] *** Joins: eatkinson (eatkinson@moz-DACC1A92.dsl.bell.ca)
[00:24:14] *** Quits: jorendorff (jorendorff@moz-30F4FB9E.hfc.comcastbusiness.net) (Quit: jorendorff)
[00:24:59] *** Quits: eatkinson (eatkinson@moz-DACC1A92.dsl.bell.ca) (Quit: eatkinson)
[00:25:14] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[00:26:26] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[00:26:57] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:27:13] *** Quits: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Client exited)
[00:27:14] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[00:29:36] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[00:29:38] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[00:30:12] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[00:30:41] <tikue_> i don't get it
[00:30:45] *** Joins: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com)
[00:30:48] *** Joins: dbaupp (Thunderbir@368DC27E.D5A1DCF.37681C44.IP)
[00:30:54] <tikue_> why does it allow you create a static uint, but then not allow you to use it as a constant
[00:31:29] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[00:32:14] <tikue_> rusti: static n: uint = 3; let v: [uint, n] = [0, 1, 2];
[00:32:14] -rusti- <anon>:5:41: 5:42 error: expected `]` but found `,`
[00:32:14] -rusti- <anon>:5          static n: uint = 3; let v: [uint, n] = [0, 1, 2];
[00:32:15] -rusti-                                                   ^
[00:32:15] -rusti- application terminated with error code 101
[00:32:18] <bblum> tikue_: it's clearly confused about whether or not it wants to allow you to do it
[00:32:23] <dbaupp> strcat: btw, github allows you to write "fixes #xxx" as well as "closes ..." (and some other magic words too), and they can go in commits which will close the issue when it gets merged to master.
[00:32:25] <dbaupp> strcat: (in response to your point about it earlier)
[00:32:35] <tikue_> bblum: lol well it should let me do it :(
[00:32:44] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[00:32:50] <bblum> tikue_: sounds like it's bugfiling time
[00:33:43] <tikue_> rusti: static n: uint = 3; let v: [uint, ..n] = [0, 1, 2]; 
[00:33:44] -rusti- <anon>:5:33: 5:34 warning: unused variable: `v` [-W unused-variable (default)]
[00:33:44] -rusti- <anon>:5          static n: uint = 3; let v: [uint, ..n] = [0, 1, 2]; 
[00:33:44] -rusti-                                           ^
[00:33:44] -rusti- ()
[00:34:10] <tikue_> rusti: static n: uint = 3; let v: [uint, ..n] = [0, 1, 2]; v
[00:34:11] -rusti- [0, 1, 2]
[00:34:52] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[00:35:11] <brson> nmatsakis: I have a function that needs to call C and should always be inlined, and this can't be expressed because of https://github.com/mozilla/rust/issues/8801
[00:35:20] <tikue_> bblum: idk what to call this bug. any ideas?
[00:35:47] <brson> nmatsakis: maybe i can declare that function itself an extern "C" fn?
[00:36:20] <bblum> tikue_: whenever i get weird ices like that i just call it "ICE with <feature X> and <feature Y>"
[00:36:21] <brson> nmatsakis: some cases like this in the runtime too
[00:36:34] <tikue_> bblum: it doesn't always ice
[00:36:41] <nmatsakis> brson: huh. I didn't know that those two were not compat
[00:36:59] <bblum> tikue_: "Intermittent ICE with .."
[00:37:00] <nmatsakis> brson: I am surprised to see that #[fixd_stack_segment] adds a noinline---
[00:37:06] <nmatsakis> brson: that sounds kind of like a bug?
[00:37:14] <nmatsakis> brson: well I guess that's #8801 )
[00:37:15] <nmatsakis> =)
[00:37:25] <brson> :)
[00:37:33] <nmatsakis> let me see what happens if I just take that out..
[00:37:39] <nmatsakis> ....I vaguely recall now that I asked pcwalton about this...
[00:37:52] <pcwalton> I would like to remove it
[00:37:53] <nmatsakis> ..and he said that he added that as a safeguard because he didn't trust the LLVM code 
[00:37:57] <pcwalton> yes
[00:38:02] <brson> nmatsakis: so we still expect inlined fixed_stack_segment frames to sort of infect the functions they are inlined into?
[00:38:07] <nmatsakis> I did, yes
[00:38:11] <brson> that changes runtime semantics in surprising ways
[00:38:14] <nmatsakis> that's why I put #[fixed_stack_segment]; #[inline(never)];
[00:38:25] <nmatsakis> but I figured that sometimes you would want inlining
[00:38:29] <nmatsakis> ideally,
[00:38:37] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[00:38:38] <nmatsakis> you would only inline if caller already had the annotation?
[00:38:40] <nmatsakis> probably
[00:38:51] <brson> yeah, only if the caller expects a fixed stack
[00:39:01] <tikue_> bblum: https://gist.github.com/tikue/ac8eb1f75d8345099814
[00:39:07] <nmatsakis> if we generalized it into various options, rather than just "big",
[00:39:07] <brson> that still means inline(always) is incompatible
[00:39:17] <nmatsakis> well, I would interpret it as
[00:39:24] <nmatsakis> inline(always) -- if plausible :)
[00:39:30] <brson> i guess 'always' never actually means always
[00:39:30] <nmatsakis> I mean inline(always) doesn't really mean always even now
[00:39:47] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[00:39:57] <nmatsakis> anyway I was just going to say if we generalized fixed_stack_segment you would want to inline only if caller had your size or bigger
[00:40:30] <nmatsakis> brson: anyway, back to your immediate prob, you could declare the function itself as an extern "C" fn, but I don't think inlining will work..well, it might 
[00:40:44] <nmatsakis> I'm actually not 100% sure what will happen :)
[00:41:02] <nmatsakis> I guess it *will* be statically linked, so LLVM could inline it,
[00:41:08] <nmatsakis> what i'm not sure about is whether we are putting inline(never) on such fns
[00:41:21] <tikue_> it'd be kinda cool if for something like enum Foo { Bar, Baz } you could do Foo::length() or Foo.length
[00:41:32] <nmatsakis> yes
[00:41:50] <nmatsakis> there's been talk of a deriving mode for c-like enums that would impl a trait with methods like that...
[00:41:55] <nmatsakis> not sure what happened to that
[00:42:08] <nmatsakis> it'd be nice tho
[00:42:15] <tikue_> agreed
[00:42:22] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[00:43:16] <bblum> tikue_: well, that error looks "ok" (although not optimal obviously)
[00:43:28] <erickt> nmatsakis: I was actually starting to work on a ToInt/FromInt syntax extension for enums
[00:43:34] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[00:43:34] <tikue_> bblum: but isn't it wrong? it is a constant expr
[00:43:36] <erickt> nmatsakis: Is that what you're talking about?
[00:44:14] <erickt> nmatsakis: the issue number for ^ is https://github.com/mozilla/rust/issues/3868
[00:44:27] <bblum> tikue_: i mean, it's wrong; there might already be a bug open for that though
[00:44:59] <tikue_> ok
[00:45:52] <bblum> i dunno, search for it :P
[00:47:18] <nmatsakis> erickt: maybe that's what I'm thinking of, but I think there was another issue with a trait and a deriving mode,
[00:47:24] <nmatsakis> erickt: which seems like a better way to do it
[00:47:49] <erickt> nmatsakis: I got to run now, but I'll troll through the database before I keep working on it
[00:48:05] <erickt> thanks for the heads up
[00:48:25] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:49:11] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[00:49:45] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:49:51] *** Quits: heftig (heftig@moz-5B981C62.dip0.t-ipconnect.de) (Ping timeout)
[00:52:11] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[00:53:52] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[00:56:12] *** Quits: dbaupp (Thunderbir@368DC27E.D5A1DCF.37681C44.IP) (Ping timeout)
[00:57:00] *** Joins: heftig (heftig@moz-F7EAFED4.dip0.t-ipconnect.de)
[00:58:46] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[00:59:01] *** Joins: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP)
[00:59:22] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[01:02:17] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[01:02:21] <tikue_> rusti: struct Foo { a: uint } let v = [Foo { a: 0 }, Foo { a: 1 }, Foo { a: 2 }]; for Foo { ref a } in v.iter() { printfln!(a); }
[01:02:32] -rusti- pastebinned 7 lines of output: http://ix.io/7Cq
[01:02:51] <tikue_> what does found `ref` in ident position mean
[01:03:01] *** Quits: ChrisMorgan1 (chris@moz-5E3713DF.its.monash.edu.au) (Ping timeout)
[01:03:02] <tikue_> rusti: struct Foo { a: uint } let v = [Foo { a: 0 }, Foo { a: 1 }, Foo { a: 2 }]; for &Foo { a } in v.iter() { printfln!(a); }
[01:03:03] -rusti- 0
[01:03:03] -rusti- 1
[01:03:03] -rusti- 2
[01:03:03] -rusti- ()
[01:03:38] <tikue_> rusti: struct Foo { a: uint } let v = [Foo { a: 0 }, Foo { a: 1 }, Foo { a: 2 }]; for &Foo { a: ref a } in v.iter() { printfln!(a); }
[01:03:39] -rusti- &0
[01:03:40] -rusti- &1
[01:03:40] -rusti- &2
[01:03:40] -rusti- ()
[01:05:31] *** Quits: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz) (Quit: zzZZZ)
[01:05:40] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[01:06:12] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[01:07:21] *** Joins: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz)
[01:09:11] <achin> if i pull in the latest rust code from github, do i need to do anything more than "make" to build it?  or should i clean, reconfigure, and re-make?
[01:11:27] <Earnestly> Why do you call Arrays, Vectors in rust?
[01:12:12] <brson> achin: 'make' will suffice
[01:12:52] *** Quits: MrByte (MrByte@moz-147070D0.chy-wy.client.bresnan.net) (Connection reset by peer)
[01:12:55] *** Joins: MrByte (MrByte@moz-147070D0.chy-wy.client.bresnan.net)
[01:12:59] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:13:41] *** Quits: MauricioC (mauricioc@moz-2CFCD404.impa.br) (Ping timeout)
[01:13:47] *** Quits: MrByte (MrByte@moz-147070D0.chy-wy.client.bresnan.net) (Quit: )
[01:13:58] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[01:13:59] *** ChanServ sets mode: +o tjc
[01:14:19] *** Joins: MauricioC (mauricioc@moz-2CFCD404.impa.br)
[01:15:33] *** Quits: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net) (Quit: carllerche)
[01:15:45] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:15:45] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SvhCww
[01:15:45] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:16:46] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:17:23] *** Joins: MrByte (MrByte@moz-147070D0.chy-wy.client.bresnan.net)
[01:20:03] <tikue_> is there an idiom for when you match and only want to do something on one branch?
[01:20:09] <tikue_> and iignore all other branches
[01:20:43] <kmc> _ => {}
[01:20:46] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:20:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/TxMnmA
[01:20:46] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:20:48] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:20:48] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/SPJ1vw
[01:20:48] <ghrust> 13rust/06auto 14890b589 15Florian Hahn: Add test for #5783
[01:20:48] <ghrust> 13rust/06auto 143211713 15bors: auto merge of #8799 : fhahn/rust/ticket_5783, r=catamorphism...
[01:20:48] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:20:57] <tikue_> kmc: i meant, is there something better than match
[01:20:59] <kmc> I don't know of anything besides that, sorry
[01:21:00] <brson> I prefer _ => () because it's rounder
[01:21:04] <kmc> heh
[01:21:10] <tikue_> match is a bit verbose that's all
[01:21:13] <tikue_> for that use case
[01:21:14] <kmc> you could write a macro
[01:21:29] <kmc> but I almost feel like "_ => ()" is a better 'name' than whatever macro one would write
[01:24:46] <tikue_> true
[01:25:59] *** Quits: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[01:26:28] *** Quits: maik (maik___@moz-64456714.dip0.t-ipconnect.de) (Ping timeout)
[01:26:34] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Connection reset by peer)
[01:29:12] <bjz> Earnestly: Vector is the mathematical term for an ordered list for which the items are of all the same type
[01:30:06] <kmc> also in programming, vector sometimes implies that it will automatically resize as necessary, whereas arrays at their most basic do not
[01:30:08] <bjz> Earnestly: Like a tuple
[01:30:13] <bjz> yep
[01:30:42] <kmc> that's the usage in C++ for one, and Rust owes a lot to C++ (the good parts, we promise ;)
[01:30:54] <bjz> :)
[01:31:03] <Eridius> ChrisMorgan: you around?
[01:31:10] <bjz> kmc: except for the syntax /troll
[01:31:15] <ChrisMorgan> Yep.
[01:31:21] <Eridius> ChrisMorgan: how would `\\foo` be interpreted as a windows path?
[01:31:29] <kmc> that's a network path on windows
[01:31:30] <Eridius> Would that just get normalized to \foo, or what?
[01:31:42] <kmc> \\FILESERVER\path\to\warez
[01:31:47] <ChrisMorgan> That would refer to a server. It's not a complete path, not sure precisely how it would be handled.
[01:32:00] <Eridius> The docs I'm reading that mention UNC paths suggest both server and share are required
[01:32:06] <Eridius> i.e. \\foo\bar is a UNC path. But what about just \\foo?
[01:32:08] <kmc> bjz: yeah well, I'm not the biggest fan of Rust's concrete syntax, but it drops the worst parts of C++ synatx for sure :)
[01:32:23] <bjz> kmc: <> delimeters? :P
[01:32:24] <Earnestly> bjz: That is not what a vector in mathematics is.  An ùíè-ordered list of elmenets with the same size is a tuple.
[01:32:48] *** Joins: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[01:32:51] <Eridius> Earnestly: math != computer science
[01:32:53] <ChrisMorgan> Yeah, I don't know what it would be.
[01:32:57] <kmc> for one, the bizarre corner cases like 'typename' and sticking 'template' in the middle of an expression
[01:32:59] <Earnestly> Eridius: s/science//
[01:32:59] <Eridius> ChrisMorgan: darn. Thanks anyway
[01:33:10] <kmc> and the horribly ambiguous grammar generally
[01:33:10] <bjz> kmc: but most of it is ok
[01:33:16] <bjz> yeah
[01:33:30] <bjz> kmc: I'd rather have the semantics of Rust
[01:33:57] <kmc> one huge advantage of Rust is that it tries to have first-class support for C-ish things, *without* trying to be literally a superset of C at the syntactic level
[01:33:58] <Earnestly> bjz: the "vector" thing seems to have come from the std::vector in C++; I can't find references to it's new use of the word :\
[01:34:05] <kmc> (of course C++ doesn't even quite accomplish that)
[01:34:09] <bjz> Earnestly: true
[01:34:21] *** Quits: fyolnish (fyolnish@moz-B2073F52.uqwimax.jp) (Client exited)
[01:34:43] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[01:34:45] <bjz> Earnestly: I guess it makes more sense for [T,..n] vectors
[01:34:50] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:34:55] <Earnestly> bjz: So, it's very confusing to me.  Think vectors and scalars.  It's nothing important; just a bit of mental overhead converting "rust vector" to "array".
[01:34:56] <bjz> Earnestly: ie. fixed length lists
[01:35:06] <bjz> Earnestly: you get used to it
[01:35:10] <Earnestly> bjz: That's still not a vector :<
[01:35:27] <tikue_> kmc: what syntax don't you like
[01:35:32] <kmc> in Rust?
[01:35:36] <tikue_> yeah
[01:35:37] <bjz> Earnestly: it's just a name
[01:35:47] <tikue_> imo very few of rust's warts are syntax
[01:35:48] <Earnestly> Oh well.  I think computer science has lost it's crediability in the 80s anyway :P
[01:35:49] <kmc> I don't necessarily want to set off a round of bikeshedding...
[01:35:52] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[01:35:54] <kmc> none of it is particularly important
[01:35:55] <Earnestly> s/its
[01:36:20] <bjz> tikue_: the function decl/invocation syntax for one - I'm more a fan of the ISWIM style
[01:36:23] <tikue_> haha but i'm interested anyway kmc
[01:36:27] <kmc> BCPL syntax for an expression oriented language is weird
[01:36:28] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:36:31] <kmc> hi rusti
[01:36:47] <Earnestly> bjz: *shrug*; I think a name matters.  How often have you spent hours trying to figure out what a function does when the name contradicts it?
[01:36:58] <kmc> and I'm a big fan of layout syntax (as long as it's just sugar for a whitespace-independent form)
[01:37:13] <bjz> Earnestly: well, we should call fns procs then :)
[01:37:20] <kmc> the specialness of 'self' bothers me; it's not just a syntactic thing, but it manifests in syntax too
[01:37:22] <Earnestly> bjz: Yes
[01:37:32] <Earnestly> bjz: Unless it's pure :p
[01:37:32] <tikue_> bjz: what do you mean by iswim style? j/w
[01:37:34] <kmc> for example the & in f(&self) has an opposite meaning to the & in f(&x: T)
[01:37:42] <bjz> tikue_: curried
[01:37:46] <tikue_> ahh ok
[01:37:53] <bjz> tikue_: T -> U -> V
[01:37:55] <tikue_> yeah
[01:37:58] <kmc> foo::bar::<T>() is bad too, but I think people mostly agree with that
[01:38:03] <bjz> tikue_: a lot more powerful
[01:38:16] <bjz> tikue_: but yeah, I can live with it
[01:38:35] <bjz> tikue_: also, like: add 1 2
[01:38:44] <tikue_> bjz: i agree. it'd be nice to have currying. however you can still do equally expressive stuff with closures right?
[01:39:00] <bjz> tikue_: it gets very verbose though
[01:39:03] <tikue_> true
[01:39:09] <kmc> when we say a language is "curried" we just mean that its syntax encourages the curried style by default
[01:39:18] <kmc> in Haskell too you can write (A, B) -> C but it's not idiomatic
[01:39:38] <kmc> as long as you have first class functions you can do the same basic things, whatever the syntax
[01:39:42] <bjz> tikue_: add(x)(y) fn add(x: int) -> fn(y: int) -> int
[01:39:50] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[01:39:56] <kmc> (also sometimes "to curry" means to convert (A, B) -> C to A -> B -> C, which causes further confusion)
[01:40:03] <bjz> kmc: I liked this course: https://www.coursera.org/course/proglang
[01:40:14] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[01:40:22] <kmc> cool
[01:40:33] <bjz> kmc: he starts off doing functions with a single tuple argument
[01:40:44] <bjz> kmc: and then does the 'big reveal'
[01:40:44] <Earnestly> bjz: But I'm willing to accept "function";  "vector" is just blatantly wrong.  Oh well!  Just little annoying things heh.  :P
[01:41:00] <kmc> :D
[01:41:03] *** Joins: Ralith (ralith@114DA04D.CD83ED0A.BCDF04A6.IP)
[01:41:10] <bjz> kmc: it's nice for easing folks into the curried form
[01:41:26] <bjz> Earnestly: :)
[01:41:42] * kmc -> afk
[01:41:43] <kmc> ttyl
[01:41:47] <bjz> bye!
[01:41:48] <bjz> o/
[01:41:55] <tikue_> rusti: fn add(x: int) -> fn(y: int) -> int { |y| x + y }; add(1)(1)
[01:42:02] -rusti- pastebinned 6 lines of output: http://ix.io/7Ct
[01:42:11] <bjz> you need &fn
[01:42:21] <tikue_> rusti: fn add(x: int) -> &fn(y: int) -> int { |y| x + y }; add(1)(1)
[01:42:25] -rusti- pastebinned 17 lines of output: http://ix.io/7Cu
[01:42:31] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[01:42:37] <bjz> oh wait, maybe ~fn -_-
[01:42:39] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[01:42:39] <tikue_> rusti: fn add(x: int) -> ~fn(y: int) -> int { |y| x + y }; add(1)(1)
[01:42:41] -rusti- 2
[01:42:43] <tikue_> ha!
[01:42:44] <bjz> yay
[01:42:44] <tikue_> cool
[01:42:57] <bjz> yeah, but I would never do that in rust
[01:43:00] <tikue_> :(
[01:43:03] <tikue_> i know...
[01:43:08] <bjz> unless in specific cases
[01:43:31] <Earnestly> bjz: (I sort of like the history of these things; so figuring out where the terms came from is kinda fun.  It seems Rust just inhereited it from C++'s stdlib without thought and then twisted it to meaning "homogeneous array" with another name.)
[01:44:11] <bjz> Earnestly: yeah. I sympathise
[01:44:26] <bjz> Earnestly: it's a little late in the game though
[01:44:37] <Earnestly> Indeed, but that's fine.
[01:44:54] <bjz> Earnestly: maybe if you were hear two or three years ago... :P
[01:45:14] <bjz> *here
[01:45:24] *** tikue_ is now known as tikue_dinner
[01:46:43] <tikue_dinner> nmatsakis: is there an issue open for Enum.len() or something to that effect?
[01:48:09] <tikue_dinner> bblum: https://github.com/mozilla/rust/issues/5873
[01:48:43] <Earnestly> bjz: Do you know where the 'XXX' motif in code files came from? :P
[01:48:52] <bjz> ?
[01:48:57] <bjz> where?
[01:49:06] <Earnestly> bjz: E.g. "XXX: This code needs to be reworked", in the comments
[01:49:06] <tjc> Earnestly: It means somebody didn't want to make a bug tracker issue
[01:49:09] <tikue_dinner> bblum: it says it was fixed and closed. but it doesn't seem to be fixed at all
[01:49:11] <tjc> anywhere that appears, it should be a FIXME with a bug number
[01:49:12] <bjz> hehe
[01:49:13] <bjz> yeah
[01:49:14] <Earnestly> tjc: hehe
[01:49:19] <bjz> laziness
[01:49:19] <tjc> we have a script that checks that FIXMEs have bug numbers
[01:49:26] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[01:49:27] <bjz> look at the blame and yell at them
[01:49:44] <tjc> unless it's actually some poor innocent person who only reindented the code and didn't write the comment :-)
[01:49:58] <Earnestly> It's actually from radio communication, where you know SOS of course.  XXX was like SOS but less distressing.
[01:50:34] <tjc> Oh
[01:50:44] <tjc> maybe that is where it came from
[01:51:18] <Earnestly> I can't seem to find any other references; I always found it odd that editors would automatically highlight "XXX" as if it meant something.
[01:51:49] <Earnestly> Certainly not too much alcohol? :p
[01:52:59] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[01:53:04] <bblum> tikue_dinner: well reopen it
[01:53:13] <tikue_dinner> bblum: i can't
[01:53:25] <bblum> you don't have edit permissions?
[01:53:29] <tikue_dinner> bblum: not for rust no
[01:53:44] <bblum> ok there i reopened it for you
[01:53:48] <tikue_dinner> thx
[01:56:26] <ktt3ja> would it be fine to ask a Rust question here?
[01:56:50] <tikue_dinner> ktt3ja: absolutely
[01:57:08] <ktt3ja> I'm trying to figure out how to iterate through a vector
[01:57:15] <ktt3ja> http://pastebin.com/yjZ7dDBW
[01:57:34] <ktt3ja> I wrote the code from lines 1-5, but then I got the error on the lines below
[01:58:09] <tjc> ktt3ja: you have to give the vector you're iterating over a name:
[01:58:18] <tjc> let elements = ["a", "b", "c"]; and then your code
[01:58:26] <tjc> with for elements.iter().advance ...
[01:58:32] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[01:58:37] <tjc> (I assume you're using Rust 0.7...)
[01:58:43] <ktt3ja> yea
[01:58:53] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:59:02] <ktt3ja> my class is using Rust 0.7
[01:59:08] <tikue_dinner> ktt3ja: whoa! what class?!
[01:59:15] <ktt3ja> Operating System
[01:59:17] <tikue_dinner> omg
[01:59:24] <tikue_dinner> did that crazy devil go forward with his plans
[01:59:28] <tikue_dinner> haha that makes me so happy
[01:59:31] <tikue_dinner> you go to UVA ktt3ja ?
[01:59:37] <ktt3ja> yes
[01:59:49] <tikue_dinner> :) you're very very likely in the first class in history to be taught in rust
[01:59:51] <tjc> ah yes‚Ä¶ "Using Rust in an OS course"
[01:59:52] <tjc> heh
[02:00:05] <brson> lol
[02:00:11] <brson> that's exciting
[02:00:15] <klutzy> wow
[02:00:46] <tikue_dinner> thought i must say i feel bad that you have to use 0.7 :P 0.7 doesn't have ```for pat in iter``` :(
[02:01:10] <tjc> tikue_dinner: I don't think it will interfere with the students' understanding of operating systems :-)
[02:01:15] <tikue_dinner> haha true
[02:01:16] <ktt3ja> yea, I found that out around last hour
[02:01:25] <ktt3ja> the for each thing seems to be gone, too
[02:01:34] *** tikue_dinner is now known as tikue_hasnt_had_dinner_yet
[02:01:42] <jfbk> how's the class liking it?
[02:01:48] <tikue_hasnt_had_dinner_yet> ktt3ja: yeah you need to do for vec.iter().advance |pat| { }
[02:02:02] <mcpherrin> ktt3ja: foreach was just a stopgap while one `for` loop changed into the other.  Never released.
[02:02:03] *** Joins: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net)
[02:02:07] <ktt3ja> today was first day
[02:02:15] <ktt3ja> and we haven't had class yet since the professor got sick
[02:02:15] <mcpherrin> If that's what you mean by "the for each thing"
[02:02:29] <tikue_hasnt_had_dinner_yet> mcpherrin: i think he meant like vec.each() 
[02:02:29] *** Quits: MauricioC (mauricioc@moz-2CFCD404.impa.br) (Quit: Lost terminal)
[02:02:37] <mcpherrin> Oh!
[02:02:41] <ktt3ja> yes, I meant that
[02:03:04] <tikue_hasnt_had_dinner_yet> ktt3ja: #rust is absolutely the best place to come for rust questions. let the class know :P
[02:03:12] <brson> ktt3ja: yeah, you were right to come here
[02:03:14] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[02:03:24] <brson> bring your friends!
[02:03:38] *** Joins: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[02:03:39] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[02:04:00] <tikue_hasnt_had_dinner_yet> wouldn't a rust kernel be mostly unsafe code?
[02:04:56] <tikue_hasnt_had_dinner_yet> how do you do system calls in rust?
[02:05:04] <tjc> tikue_hasnt_had_dinner_yet: unsafe code :-)
[02:05:31] <tjc> tikue_hasnt_had_dinner_yet: I would guess that the way the assignments would work is that the students would be given a safe API to use, that the instructor wrote
[02:05:32] <tjc> but idk
[02:05:34] <bjz> ktt3ja: we need to make 300 users on #rust :D
[02:05:51] <tikue_hasnt_had_dinner_yet> tjc: ah, very interesting!  i could see that
[02:05:54] <mcpherrin> bjz: That's not too far away :P
[02:06:00] <bjz> ktt3ja: we're beginning to hove around 280
[02:06:08] <tjc> tikue_hasnt_had_dinner_yet: I can't find a syllabus online for the class, but I'd be very curious to see it!
[02:06:11] <bjz> *hover
[02:06:13] <tikue_hasnt_had_dinner_yet> tjc: same
[02:06:23] *** Joins: mmmm (mat@moz-345B5EBA.csclub.uwaterloo.ca)
[02:06:50] *** Joins: mmmmmm (mmm@moz-345B5EBA.csclub.uwaterloo.ca)
[02:06:51] <bjz> mmmm, got tired of being pinged?
[02:06:54] <Eridius> tjc: r? https://github.com/mozilla/rust/pull/8697
[02:07:03] <Eridius> tjc: note that I had to modify the existing tests. I explained why in a comment
[02:07:05] <ktt3ja> here's the class page
[02:07:06] <ktt3ja> http://www.cs.virginia.edu/~evans/cs4414/
[02:07:11] *** Quits: Aszarsha (Aszarsha@moz-16BFBC53.rev.numericable.fr) (Connection reset by peer)
[02:07:15] <tjc> Eridius: ok, looking
[02:07:18] <tjc> ktt3ja: thanks!
[02:07:25] *** Quits: mmmmmm (mmm@moz-345B5EBA.csclub.uwaterloo.ca) (Client exited)
[02:07:29] *** Quits: mmmm (mat@moz-345B5EBA.csclub.uwaterloo.ca) (Client exited)
[02:07:48] <bjz> :D http://www.cs.virginia.edu/~evans/cs4414-fall2013/pages/irc.html
[02:07:52] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[02:08:33] <bjz> ktt3ja: is the chat room on the uni system, or can we make ourselves available on there?
[02:08:45] <bjz> (if it's via IRC)
[02:08:59] <ktt3ja> I'm not sure
[02:09:10] <ktt3ja> I figured no one would be there since it's just the first day. I haven't tried going there
[02:09:38] <tjc> bjz: from that page, it looks like they're using irc.mozilla.org for the class channel too
[02:09:45] <tjc> (which seems totally fine since it's about Rust, which is a Mozilla project)
[02:09:47] <bjz> tjc: yeah
[02:09:53] <bjz> tjc: it's awesome
[02:10:08] <mcpherrin> bjz: I was really hoping the "criminals" link on that page would be to http://www.youtube.com/watch?v=O2rGTXHvPCQ
[02:10:11] * bjz loves the fact that #rust is active 24/7
[02:10:29] <mcpherrin> The channel definitely has different flavours at different times of day though.
[02:10:42] <tikue_hasnt_had_dinner_yet> true mcpherrin 
[02:10:44] <pcwalton> brson: r? https://github.com/mozilla/rust/pull/8802
[02:10:56] <bjz> mcpherrin: HA
[02:12:24] *** Quits: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:13:05] <bjz> mcpherrin: http://www.youtube.com/watch?v=hkDD03yeLnU
[02:13:08] <tjc> Eridius: r+'ed
[02:13:13] <Eridius> thanks
[02:13:26] <bjz> mcpherrin: of course you've seen that one
[02:13:36] <mcpherrin> Of course :)
[02:13:57] * bjz wants to distract the uni students with youtube videos
[02:14:14] <bjz> rust? pah
[02:14:31] <bjz> time for Maru
[02:14:48] <Eridius> mcpherrin: oh man, Numb3rs was great
[02:15:07] <Eridius> I think that same episode you linked includes obj-c code taken from Erica Sadun's Obj-C Cookbook as code that what's-her-name was "writing"
[02:15:08] <tjc> bjz: they're undergrads and it's night-time‚Ä¶ I suspect you can't possibly add to their distraction :-)
[02:15:37] <bjz> tjc: I'm un undergrad and Rust is more distracting than YT
[02:15:50] <tjc> bjz: Haha, well, that's what makes you special :-)
[02:15:51] <bjz> tjc: ktt3ja will be unleashing a monster
[02:16:05] <bjz> :P
[02:16:22] <bjz> (hopefully)
[02:16:24] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[02:16:52] *** Quits: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net) (Ping timeout)
[02:17:58] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[02:19:33] *** Joins: z0w0 (corrz@C3BC732A.9254B1A4.F22F0031.IP)
[02:20:02] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[02:22:42] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:28:44] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[02:30:48] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:30:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SPJ1vw
[02:30:48] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:30:58] <brson> does anybody know if the nullable option optimization actually translates types as pointers, or do they stay pointer-sized structs?
[02:32:14] *** Joins: maik (maik___@moz-64456714.dip0.t-ipconnect.de)
[02:32:22] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[02:32:48] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[02:33:14] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[02:33:50] <jeaye> gah, long nicks shift everything over
[02:35:15] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[02:35:45] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[02:35:46] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ZqRyHA
[02:35:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[02:35:47] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:35:47] <ghrust> 01[13rust01] 15bors pushed 14 new commits to 06auto: 02http://git.io/UAvcEg
[02:35:47] <ghrust> 13rust/06auto 145c35047 15Patrick Walton: librustc: Remove `&const` and `*const` from the language....
[02:35:47] <ghrust> 13rust/06auto 143b6314c 15Patrick Walton: librustc: Add support for type parameters in the middle of paths....
[02:35:47] <ghrust> 13rust/06auto 148693943 15Patrick Walton: librustc: Ensure that type parameters are in the right positions in paths....
[02:35:49] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:36:12] <maik> and const is gone
[02:36:23] <samx> My first try at making a rust library :-P    https://github.com/xasmx/rust-la
[02:36:44] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[02:37:18] <Eridius> hrm, the vim syntax file thinks \ at the end of a line comment will continue the comment to the next line
[02:37:25] <Eridius> ChrisMorgan: you show up in the blame. Any particular reason for that?
[02:37:49] <ChrisMorgan> Not sure if it was that way before I came along or not. Is it correct?
[02:37:58] <Eridius> I just tested and that does not appear to be the case
[02:38:20] <ChrisMorgan> Let's see: where is \ special at EOL? Is it only in a string?
[02:38:56] *** Quits: smj (Mibbit@moz-E56CAA08.dsl.bell.ca) (Quit: http://www.mibbit.com ajax IRC Client)
[02:40:05] <Eridius> looks like this actually dates back to a commit by pcwalton 3 years ago
[02:40:06] <Eridius> :O
[02:41:46] <ChrisMorgan> I presume L"..." used to be supported, also.
[02:41:49] <ChrisMorgan> It isn't now.
[02:41:54] <ChrisMorgan> I'm just fixing these up now.
[02:42:02] <Eridius> I would assume that's old syntax
[02:42:21] <Eridius> I was going to submit a PR for just the comment thing, but if you want to sneak other fixes in along with it, I'll defer to you
[02:42:22] <ChrisMorgan> \ doesn't work in char literals: '\ [new line] x'
[02:42:32] <ChrisMorgan> Eridius: yes, I'm changing a couple of other things with it.
[02:42:50] <Eridius> ok, I'll delete my branch then
[02:43:35] <tjc> wow, I just learned something horrible about git
[02:43:44] *** Quits: Aszarsha_ (Aszarsha@moz-16BFBC53.rev.numericable.fr) (Ping timeout)
[02:43:44] <Eridius> oh?
[02:43:55] *** Joins: MilesMi (miles@43BE83AA.82509CD.F3AB8A1.IP)
[02:44:01] <tjc> apparently if you do: git clone somegarbage foo/bar/baz
[02:44:07] <tjc> and the request to fetch somegarbage fails because it's not a repo
[02:44:10] <tjc> it creates foo/bar/baz anyway
[02:44:23] <jack> tjc: one of its many issues ;)
[02:44:34] <tjc> jack: Indeed, it's just that this issue just cost me an hour or two :-)
[02:44:47] <Eridius> tjc: hrm, well it creates foo/bar certainly
[02:45:00] <tjc> Eridius: possibly so, in my case the problem happens even if it just creates foo
[02:45:02] <Eridius> I think what it does is creates foo/bar/baz, attempts the clone, fails, and deletes baz, although I can't be 100% certain
[02:45:17] <tjc> Eridius: the problem I'm having might actually go away when your patch lands, because it has to do with whether a src/ directory exists or not
[02:45:22] <Eridius> hah
[02:45:27] <ChrisMorgan> And then it removes the directory you were cloning into, whether you want it to or not. (e.g. On a large clone if the network drops out briefly you may have to start all over again.)
[02:45:28] <tjc> but in the meantime, I'll add code to clean up after git
[02:45:29] <tjc> I guess
[02:45:42] <tjc> ChrisMorgan: Actually I think it will refuse to clone into a non-empty directory
[02:45:49] <Eridius> ChrisMorgan: if you're worried about that, you can `git init`, `git remote add ...`, `git fetch` instead
[02:46:02] <tjc> though possibly that was only fixed recently, I don't know
[02:46:16] <ChrisMorgan> tjc: I'm assuming a new clone into a non-empty directory
[02:46:32] <Eridius> tjc: random thought: clone it into a scratch dir in the workspace, then move it to the final location when finished?
[02:46:34] <ChrisMorgan> Eridius: I thought about that, but I expect fetch would be the same, that if it fails part way through it throws it all away?
[02:46:35] <tjc> ChrisMorgan: Yeah, that's what I mean. I guess I can go ahead and try it...
[02:46:39] <Eridius> although maybe that's not a great idea
[02:46:54] <tjc> Eridius: hmm, interesting point. though I'd still have to have code somewhere to clean up the directory if it doesn't end up being used
[02:46:56] <Eridius> ChrisMorgan: oh yeah, I guess a partial fetch probably won't keep the objects around. Although I don't know for certain
[02:47:00] <ChrisMorgan> Sorry, I meant "I'm assuming a new clone into a non-existent directory".
[02:47:09] <tjc> oh, I see
[02:47:28] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[02:48:30] *** Quits: zz_kimundi (kimundi@moz-C66626B7.dip0.t-ipconnect.de) (Ping timeout)
[02:50:52] <zeuxcg> rusti: fn read_struct<T>(reader: @Reader) -> T { unsafe { let buffer = reader.read_bytes(size_of::<T>()); *(vec::raw::to_ptr(buffer) as *T) } }
[02:50:55] -rusti- pastebinned 14 lines of output: http://ix.io/7CA
[02:51:09] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:51:14] <zeuxcg> rusti: fn read_struct<T>(reader: @std::io::Reader) -> T { unsafe { let buffer = reader.read_bytes(std::sys::size_of::<T>()); *(std::vec::raw::to_ptr(buffer) as *T) } }
[02:51:17] -rusti- pastebinned 5 lines of output: http://ix.io/7CB
[02:51:28] <zeuxcg> is there any way to make the above code work?
[02:51:31] *** Joins: huseby (huseby@8F761026.B5EF4AF6.E96CA9D8.IP)
[02:51:39] <zeuxcg> I can't use Clone because my struct has a fixed-size vector
[02:51:42] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[02:51:48] <zeuxcg> and deriving(Clone) does not work for those
[02:52:10] *** Joins: zz_kimundi (kimundi@moz-BC6B644B.dip0.t-ipconnect.de)
[02:52:27] *** zz_kimundi is now known as kimundi
[02:53:24] *** Quits: KindOne (KindOne@moz-CF41ACCB.dynamic.ip.windstream.net) (Ping timeout)
[02:54:20] <tjc> zeuxcg: do you really need your read_struct to have a totally generic return type?
[02:54:21] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:54:27] <tjc> as in, are you actually only going to read structs of one particular type?
[02:54:38] <zeuxcg> tjc: no, I need to read three types
[02:54:43] <zeuxcg> so I wanted to make a generic
[02:55:09] <tjc> zeuxcg: well, there are two ways
[02:55:27] <tjc> you could either use transmute instead of an "as" cast; or you could make a trait that all three of your types implement
[02:55:41] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Client exited)
[02:56:12] <zeuxcg> transmute to pointer?
[02:56:35] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[02:57:02] <tjc> yeah, transmute to ~T
[02:57:49] <tjc> of course, in that case you have to prove to yourself that the cast is valid -- the compiler won't help you, and you could get segfaults
[02:57:52] *** Joins: KindOne (KindOne@C93BC0E1.D40F8E6E.EC6A1518.IP)
[02:58:02] <zeuxcg> hmm, hold on
[03:01:46] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:04:16] <Eridius> how bizarre. When messing around with various windows paths at the command line, using `dir`, `dir C:\\foo\bar` was interepreted as a network path
[03:04:52] <tjc> Eridius: because of the extra backslash?
[03:04:57] <Eridius> yeah
[03:04:59] <tjc> windows is weird
[03:05:06] <Eridius> but I thought \\foo\bar as a UNC path had to be at the start
[03:05:11] <Eridius> so I have no idea what it was going to do with the C:
[03:05:13] <tjc> I thought so too
[03:05:46] *** Joins: lilybet (Mibbit@moz-4371E62F.hsd1.va.comcast.net)
[03:05:50] *** Quits: MilesMi (miles@43BE83AA.82509CD.F3AB8A1.IP) (Quit: )
[03:06:27] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[03:06:31] *** Quits: Sonarpulse (user@moz-A783576F.dsl.pltn13.pacbell.net) (Ping timeout)
[03:06:36] <ktt3ja> how do I overcome this problem?
[03:06:38] <ktt3ja> http://pastebin.com/yndq74Xn
[03:06:42] <zeuxcg> tjc:         let buffer = reader.read_bytes(size_of::<T>()); let ptr: ~[T] = transmute(buffer); ptr[0]
[03:06:47] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[03:06:58] *** Joins: student (chatzilla@moz-4371E62F.hsd1.va.comcast.net)
[03:06:58] <zeuxcg> tjc: so that works; pretty fragile though, I guess :)
[03:07:01] <zeuxcg> tjc: thanks!
[03:07:08] <tjc> zeuxcg: yup, fragile but it works
[03:07:20] <ktt3ja> (I'm sorry for not having a concrete question, but I'm very lost)
[03:07:23] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:07:27] <Eridius> ktt3ja: total is not mutable
[03:07:29] *** Parts: lilybet (Mibbit@moz-4371E62F.hsd1.va.comcast.net) ()
[03:07:33] <Eridius> neither is n
[03:07:44] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:07:44] <zeuxcg> also, @Reader works in the code above
[03:07:49] <zeuxcg> but &Reader gives me this:
[03:07:55] <tjc> if you wanted to go the traits route eventually, you would define some trait, call it S, that the types implement, and then your type signature would have <T:S> instead of just T
[03:07:58] <Eridius> ktt3ja: sadly, you're going to have to use `let mut total = 0.0; let mut n = 0` because the eventual syntax `let (mut total, mut n) = ...` doesn't work yet
[03:07:59] <tjc> zeuxcg: ^
[03:08:10] <zeuxcg> src/gfx/texture.rs:54:21: 54:55 error: failed to find an implementation of trait std::io::Reader for &std::io::Reader<no-bounds>
[03:08:10] <zeuxcg> src/gfx/texture.rs:54         let buffer = reader.read_bytes(size_of::<T>()); let ptr: ~[T] = transmute(buffer); ptr[0]
[03:08:23] *** Quits: student (chatzilla@moz-4371E62F.hsd1.va.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 16.0.2/20121024073032])
[03:08:35] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[03:08:49] <tjc> zeuxcg: you would want an &mut Reader, I think
[03:09:03] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:09:16] <zeuxcg> nah
[03:09:19] <zeuxcg> does not work either
[03:09:31] <zeuxcg> read_bytes is a method of ReaderUtil, not Reader
[03:09:38] <zeuxcg> maybe that's why...
[03:09:41] <ktt3ja> @Eridius: thanks, it works now :)
[03:09:56] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[03:10:07] <zeuxcg> no, that's not it either :-/
[03:10:08] <tjc> so‚Ä¶ do we not actually have a library function to rename a file yet?
[03:10:13] <tjc> other than in std::libc?
[03:10:41] <zeuxcg> rusti: fn readbytes(reader: &std::io::Reader) -> ~[u8] { reader.read_bytes(4) }
[03:10:41] -rusti- <anon>:5:59: 5:81 error: failed to find an implementation of trait std::io::Reader for &std::io::Reader<no-bounds>
[03:10:42] -rusti- <anon>:5          fn readbytes(reader: &std::io::Reader) -> ~[u8] { reader.read_bytes(4) }
[03:10:42] -rusti-                                                                     ^~~~~~~~~~~~~~~~~~~~~~
[03:10:42] -rusti- application terminated with error code 101
[03:10:50] <tjc> zeuxcg: probably a better way to go is like this:
[03:11:12] <tjc> fn read_struct<T, R: std::io::Reader>(reader: R) -> T ...
[03:11:22] <zeuxcg> I think I tried that, let me try again
[03:11:26] <tjc> ok
[03:12:11] *** Quits: bjz (brendanzab@AE0B7388.B8C2BBC3.F4A11E52.IP) (Quit: Leaving...)
[03:12:52] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[03:13:32] <zeuxcg> that works if I specialize it with @Reader at the call site
[03:13:43] <zeuxcg> I was trying reader: &R previously, which is why it did not work
[03:13:50] <tjc> ah, yeah
[03:14:03] <zeuxcg> so this is essentially just making the function generic
[03:14:20] <tjc> well, it's switching from dynamic dispatch to static dispatch
[03:14:23] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:14:23] <zeuxcg> yeah
[03:14:36] <zeuxcg> why does dynamic dispatch require a managed pointer though?
[03:14:47] <tjc> I think it's just a "not implemented yet" thing
[03:14:48] <maik> http://www.reddit.com/r/rust/comments/1l8hd4/first_university_computer_science_class_taught/ lol
[03:14:52] <tjc> let me see if I can find the issue on that
[03:15:02] *** mihneadb_ is now known as mihneadb
[03:15:34] <SiegeLord> Is that the same guy that posted on the ML?
[03:15:40] <tjc> SiegeLord: yes
[03:15:45] <SiegeLord> Sweet
[03:15:56] *** Quits: erick (erick@E1304535.2A7189BF.BE19388.IP) (Ping timeout)
[03:16:02] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[03:17:06] <tjc> zeuxcg: I can't find the issue right now; feel free to file an issue tracker issue if you'd like, and someone will either accept it or point out that it's a duplicate :-)
[03:17:13] <zeuxcg> great, I'll do that
[03:17:16] <zeuxcg> thanks for the help!
[03:17:41] <tjc> you're welcome!
[03:19:50] *** Joins: erick (erick@E1304535.2A7189BF.BE19388.IP)
[03:20:03] *** Joins: bjz (brendanzab@AE0B7388.B8C2BBC3.F4A11E52.IP)
[03:20:29] <bjz> zeuxcg: ping
[03:20:35] <zeuxcg> opened #8804, issue churn++
[03:21:20] <bjz> zeuxcg: I might have to get you to look at the matrix inversion after I copy it over
[03:21:37] <zeuxcg> sure
[03:22:37] <zeuxcg> the number of math libraries in rust grows by the minute :)
[03:23:15] <bjz> haha
[03:23:31] <zeuxcg> is the rust merge process documented somewhere?
[03:23:36] <bjz> zeuxcg: well, I'm feeling pretty good about this structure
[03:23:46] <zeuxcg> it would be cool to understand how the changes get merged to master and to auto
[03:23:56] <zeuxcg> merge and CI process
[03:24:05] <SiegeLord> Would this be the general idea of implementing flags for C functions (and others I guess) in Rust? https://gist.github.com/SiegeLord/6361820
[03:24:11] <klutzy> zeuxcg: https://github.com/mozilla/rust/wiki/Note-development-policy
[03:24:14] <tjc> zeuxcg: https://github.com/graydon/bors has the source code for the buildbot
[03:24:19] <tjc> I mean, not the buildbot, bors
[03:24:22] <tjc> they are separate things
[03:24:31] <strcat> SiegeLord: yes, there's a generic implementation in extra::enumset
[03:24:36] <strcat> won't work for every use case, but it's a start
[03:24:41] <SiegeLord> Does it support that use case?
[03:24:54] <strcat> SiegeLord: yes
[03:24:55] <zeuxcg> klutzy, tjc: thanks!
[03:25:07] <strcat> SiegeLord: I think so at least :), I haven't tried it yet
[03:25:14] <strcat> I just did what you have there for rust-magic
[03:26:05] <Luqman> rust-magic?
[03:26:25] <bjz> zeuxcg: http://buildbot.rust-lang.org/bors/bors.html
[03:26:33] <strcat> Luqman: libmagic binding ;p
[03:26:41] <SiegeLord> I don't think it does in its current form... you certainly can't do foo(A | B) with it atm
[03:26:57] *** Quits: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu) (Input/output error)
[03:27:06] <SiegeLord> Maybe it could be enhanced, I'm not sure
[03:27:10] <bjz> some graydon humour: http://buildbot.rust-lang.org/bors/
[03:27:13] <bjz> ^_^
[03:27:42] *** tikue_hasnt_had_dinner_yet is now known as tikue_
[03:29:10] *** Quits: maik (maik___@moz-64456714.dip0.t-ipconnect.de) (Ping timeout)
[03:30:17] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:30:46] <strcat> SiegeLord: he did one of the two original udacity courses (the one I didn't take but just curiously looked through), recognized his name
[03:32:16] <SiegeLord> It's pretty daring to use Rust atm, hopefully the class goes well
[03:32:20] *** Quits: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net) (Ping timeout)
[03:32:29] *** Joins: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net)
[03:33:59] <tikue_> very daring
[03:34:05] <tikue_> SiegeLord: but the syllabus looks pretty neat
[03:34:15] <tikue_> more of a 15-213 esque course than OS but 
[03:34:31] <tikue_> i think it'll be interesting at least
[03:34:46] <tikue_> i'm just wondering about file i/o
[03:34:49] *** Quits: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP) (Quit: klapaucius)
[03:34:55] <tikue_> that seems like that could be a pain point
[03:35:36] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[03:36:53] <acrichto> oh wow pcwalton just shaved 5 minutes off the test suite
[03:37:13] <Eridius> sweet
[03:37:45] <acrichto> I think that lazy loading is really helping small-file compilations
[03:38:09] *** Joins: XyMa (user@4F5647EE.12FF1288.B4C97B2.IP)
[03:40:48] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:40:48] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/UAvcEg
[03:40:48] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:44:02] <SiegeLord> Heh, output of --pretty expanded doesn't compile
[03:44:31] *** Joins: klapaucius (klapaucius@272B8F8B.5692770D.BB41F968.IP)
[03:45:13] <strcat> the pretty printer doesn't really work anymore
[03:45:31] <SiegeLord> The output does look kind of funny...
[03:45:42] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[03:45:42] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/xJ318A
[03:45:42] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[03:45:44] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:45:44] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/h_tKwA
[03:45:44] <ghrust> 13rust/06auto 14eafa63f 15Kevin Ballard: Handle `rustpkg build`, etc. when given no args properly...
[03:45:44] <ghrust> 13rust/06auto 14f22b4b1 15bors: auto merge of #8697 : kballard/rust/rustpkg-no-args, r=catamorphism...
[03:45:44] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:46:20] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[03:46:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:46:37] <SiegeLord> It does say that the prelude is used in every mod, and not in every crate
[03:46:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[03:46:50] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[03:46:53] <SiegeLord> I kind of wish extern mod std; was also in every mod
[03:47:06] <SiegeLord> But maybe that's too hard to turn off
[03:51:07] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[03:51:35] <acrichto> SiegeLord: having `extern mod std` would help much b/c you'd still have to `use std::X`?
[03:51:39] <acrichto> wouldn't*
[03:52:25] <SiegeLord> It does allow you to fully qualify stuff though
[03:52:35] <SiegeLord> Right now you can in the root module, but not within anywhere else
[03:52:51] <acrichto> oh you mean you have to use ::std ?
[03:52:58] *** Quits: eckzow (eckzow@moz-506D8496.members.linode.com) (Quit: leaving)
[03:53:27] <SiegeLord> rusti: let i: i32 = std::cast::transform(1.0f32); i
[03:53:28] -rusti- <anon>:5:22: 5:42 error: unresolved name `std::cast::transform`.
[03:53:28] -rusti- <anon>:5          let i: i32 = std::cast::transform(1.0f32); i
[03:53:28] -rusti-                                ^~~~~~~~~~~~~~~~~~~~
[03:53:28] -rusti- error: aborting due to previous error
[03:53:28] -rusti- application terminated with error code 101
[03:53:30] *** Quits: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:53:52] <acrichto> what's the source code of that?
[03:53:53] <tikue_> rusti: let i: i32 = ::std::cast::transform(1.0f32); i
[03:53:54] -rusti- <anon>:5:22: 5:44 error: unresolved name `std::cast::transform`.
[03:53:54] -rusti- <anon>:5          let i: i32 = ::std::cast::transform(1.0f32); i
[03:53:54] -rusti-                                ^~~~~~~~~~~~~~~~~~~~~~
[03:53:54] -rusti- error: aborting due to previous error
[03:53:54] -rusti- application terminated with error code 101
[03:54:14] <acrichto> rusti: unsafe { std::cast::transmute<uint, int>(3) }
[03:54:14] -rusti- <anon>:5:43: 5:44 error: expected one of `; }` but found `,`
[03:54:15] -rusti- <anon>:5          unsafe { std::cast::transmute<uint, int>(3) }
[03:54:15] -rusti-                                                     ^
[03:54:15] -rusti- application terminated with error code 101
[03:54:19] <acrichto> rusti: unsafe { std::cast::transmute::<uint, int>(3) }
[03:54:20] -rusti- 3
[03:54:38] <SiegeLord> Wtf was I thinking... anyway, that's what I wanted yes
[03:54:59] <acrichto> I know what you mean though, there are times that I've had to do ::module instead of using module directly
[03:55:25] <acrichto> I think that it's when you have `mod foo` at the top level and then in all your other modules you need ::foo instead of just referencing via `foo`, but I think that's ok
[03:55:38] <SiegeLord> Spent a few minutes wondering why none of my std:: things were resolving when I moved some things inside a module
[03:55:51] <acrichto> resolve is tricky :(
[03:56:52] <SiegeLord> And here's the flag thing with a macro: https://gist.github.com/SiegeLord/6361820
[03:56:59] <SiegeLord> macro rules!
[03:59:27] *** Quits: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net) (Quit: msingle)
[04:00:14] <sfackler> macro_rules! makes me laugh every time I see it
[04:01:42] <acrichto> we should switch the s to be macros_rule!
[04:02:53] <bjz> :)
[04:03:05] <bjz> jclements would like that
[04:03:07] <sfackler> +1
[04:03:32] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[04:03:55] <tikue_> rusti: let mut a = 1; let b = &a; a = 2;
[04:04:00] -rusti- pastebinned 8 lines of output: http://ix.io/7CG
[04:04:21] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:04:29] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Ping timeout)
[04:05:18] <sfackler> does anyone know what the translation of `FromStr::from_str::<Foo>(s)` is with pcwalton's changes? I thought it was `FromStr::<for Foo>::from_str(s)`, but that isn't working
[04:06:20] <brson> sfackler: That syntax isn't implemented yet. Currently the self type can't be named in a method call. You can write `let v: Foo = FromStr...`
[04:06:31] <brson> make inference do it
[04:06:49] <sfackler> thanks
[04:06:54] *** Quits: goffrie (goffrie@moz-26934CA8.dsl.ncf.ca) (Ping timeout)
[04:07:48] *** Joins: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[04:09:01] *** Joins: goffrie (goffrie@moz-A24EEB46.dsl.ncf.ca)
[04:09:03] <SiegeLord> For the purposes of casing, would flags count as statics (what they are implemented as) or enum-like constructors (which is what they somewhat resemble)?
[04:09:16] <sfackler> is there a bug for broken type inference in macros? I can't find one
[04:09:34] <heftig> will the <for Foo> stuff bring associated types?
[04:09:34] *** Quits: echristo (echristo@60A74940.D6CCE4AE.77834EAA.IP) (Ping timeout)
[04:09:56] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[04:10:03] <strcat> SiegeLord: I'd do it with the static naming convention
[04:10:48] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[04:13:28] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[04:13:46] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[04:15:06] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:17:26] <tikue_> bblum: what is the syntax for once fns when using -Z once-fns
[04:17:59] <tikue_> rusti: let (mut a, b) = (1u, 2u); a = 2u;
[04:18:06] <erickt> aatch / brson: ping
[04:18:07] -rusti- pastebinned 7 lines of output: http://ix.io/7CH
[04:18:19] <aatch> erickt, pong
[04:18:51] <tikue_> bblum: specifically, I want to ```do spawn { /* once fn here */ } ``` how do i do this
[04:19:01] <bblum> tikue_: unfortunately...
[04:19:10] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[04:19:17] <bblum> tikue_: once fns are defined where their type is declared
[04:19:24] <bblum> so the -Z flag will not help you with 'spawn'
[04:19:24] <tikue_> oh‚Ä¶ :((((
[04:19:35] <bblum> are you just doing your own personal project?
[04:19:39] <tikue_> ya
[04:19:39] <erickt> hey aatch! I was working on porting the llvm kaleidoscope demo to rust, and I was wondering if you are still working on your llvm bindings: https://github.com/Aatch/llvm-rs  
[04:19:45] <tikue_> just messing around
[04:20:07] * tikue_ should do hw 
[04:20:09] <bblum> tikue_: what you can do is, fn spawn(f: ~once fn()) { task::spawn(unsafe { cast::transmute(f) }) }
[04:20:19] <bblum> have your own wrapper :P
[04:20:41] <tikue_> bblum: what is that doing? transmuting f to a once fn?
[04:20:44] <Eridius> what's the status of once fns?
[04:20:45] <tikue_> i mean
[04:20:47] <bblum> from a once fn to a nononce fn
[04:20:53] <tikue_> ah ok
[04:21:07] <aatch> erickt, I havent touched them in a while.
[04:21:10] <bblum> now, actually,
[04:21:21] <bblum> when i added the -Z flag i made it only affect stack closures
[04:21:32] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[04:21:39] <bblum> on the premise that the macro plan will replace heap closures with onceable things anyway
[04:21:56] <bblum> so, really, the spawn in our libraries should have the once annotation on it
[04:22:06] <erickt> aatch: it's looking pretty good so far. I was just thinking about the same approach you've taken
[04:22:19] <bblum> this won't save you for, like, option functions that take stack closures, of course
[04:22:20] <tikue_> bblum: what's the status of the macro plan
[04:22:31] <bblum> tikue_: dunno, i don't think anybody started work on it
[04:23:15] <bblum> personally i suspect it might actually turn out to be too inconvenient to convert all the stdlib stuff to using it
[04:23:44] <tikue_> what does that mean bblum 
[04:23:47] <tikue_> that sounds nefarious
[04:23:55] <erickt> aatch: have you considered trying to get rust to use this wrapper?
[04:24:04] <erickt> aatch: librustc
[04:24:13] <bblum> tikue_: well, the macro plan has the downside of requiring the user to annotate all the captured variables in the closure
[04:24:27] <tikue_> ah >_<
[04:24:28] <aatch> erickt, I thought about it. There are some things that don't work very well at the moment, if I remember correctly.
[04:24:31] <tikue_> gah
[04:24:38] <aatch> Not that I can remember what they are.
[04:24:41] <erickt> aatch: what's that?
[04:24:43] <erickt> oh :)
[04:25:06] <tikue_> bblum: how would that be annotated? new syntax?
[04:25:22] <bblum> tikue_: it'd be a syntax extension so it can use whatever syntax it likes
[04:25:27] <tikue_> ah
[04:25:41] <bblum> something like, lambda!(capture list => arguments -> function body) i guess
[04:25:43] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:25:46] <Eridius> fn!()
[04:25:48] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[04:26:10] <tikue_> bblum: how does that interact with ``` do spawn ```
[04:26:17] <bblum> spawn will have its own macro
[04:26:21] <tikue_> ah
[04:26:26] <tikue_> i don't like it
[04:26:29] <tikue_> let's not do that
[04:26:31] <tikue_> :)
[04:26:33] <bblum> well, i don't either
[04:26:45] <tikue_> do spawn is one of rust's golden hens
[04:26:48] <tikue_> imo
[04:26:50] <Eridius> I agree
[04:26:54] <bblum> i as well
[04:26:55] <Eridius> I'm not a big fan of using macros for this
[04:26:58] <jmgrosen> is this the explicitly-capturing variables in closures discussion?
[04:27:07] <tikue_> jmgrosen: you betcha
[04:27:16] <jmgrosen> then i don't like it either
[04:27:24] <bblum> however, another argument for making spawn a macro is so that it can store file/line info for the task
[04:27:26] <tikue_> golden goose is the phrase i was looking for
[04:27:34] <jmgrosen> i'm definitely a fan of auto-capturing variables into closures
[04:27:34] <erickt> aatch: well I may submit a PR to update llvm-rs to HEAD and target my tutorial to use it. Let me know if you remember what problems you were running into it :)
[04:27:46] <bblum> though... i suppose now with task naming, file/line info would be redundant
[04:28:15] <jmgrosen> bjz: you're planning on eventually adding functions like perspective to cgmath-rs, right? just you haven't ported them over to your new model?
[04:28:16] <bblum> jmgrosen: Eridius: well, take it up with people who are still employed :P
[04:28:18] <aatch> erickt, I don't think I ran into any explicit problems... Except maybe related to function arguments.
[04:28:41] <Eridius> bblum: you should still have connections!
[04:28:51] <bblum> i have already made my case though
[04:28:51] <tikue_> bblum: rust is an open source project! 
[04:28:56] <Eridius> fork it!
[04:29:01] <bblum> um.
[04:29:02] <bblum> c.c
[04:29:12] <tikue_> bblum: employment is no barrier
[04:29:17] <bblum> if i forked it i would just be keeping functions the way they are today
[04:29:21] <aatch> erickt, There was something that broke because LLVM uses a temporary reference thing, I can't remember exactly the case though.
[04:29:27] <aatch> It was a bit out-there there.
[04:29:29] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[04:29:44] <tikue_> bblum: you would just let Cell::new(foo) be the idiom?
[04:29:52] <bblum> tikue_: well, no
[04:29:58] <bblum> but the code for once fns is in the compiler already
[04:30:03] <strcat> aatch: btw we probably need to add the thing to strip dead definitions again
[04:30:06] <strcat> the pass
[04:30:06] <bblum> all that would remain would be to annotate the stdlib with it
[04:30:10] <tikue_> ah right
[04:30:23] <strcat> since we're using a function pass and stuff now via the managers
[04:30:33] <erickt> aatch: I'll look out for it
[04:31:00] <strcat> it will be so great when they finally parallelize function passes...
[04:31:10] <bblum> tikue_: anyway, my plan is to wait for someone to try to implement the macro approach, and then participate in the discussion that ensues about what difficulties they encountered
[04:31:31] <tikue_> mm
[04:33:46] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:33:51] <aatch> erickt, I think some of the stuff I was "blocked" on was related to trait objects not really working.
[04:34:01] <erickt> that's fixed now :)
[04:34:16] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[04:34:32] <erickt> aatch: so one crazy idea I had for llvm bindings it to try to recover some of the type safety that gets lost in llvm-c
[04:34:47] <aatch> erickt, well that's what I was aiming for in mine too.
[04:34:59] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[04:35:08] <erickt> oh? How were you thinking about doing it?
[04:35:11] *** Joins: ayan (Mibbit@9484F20C.B83D78F.D61FB583.IP)
[04:35:28] *** Parts: ayan (Mibbit@9484F20C.B83D78F.D61FB583.IP) ()
[04:35:46] <aatch> Well in what I have at the moment, values are parameterised over a type.
[04:36:06] <aatch> So there's stuff like `Function` being a Global<ty::Function>;
[04:36:16] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:37:35] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[04:38:09] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[04:38:34] <aatch> erickt, things start to break down around functions and types and the similar, since that is all runtime-stuff.
[04:39:04] <erickt> aatch: Oh, interesting. I was thinking a similar idea, although maybe with less typarams
[04:39:20] <fread2281> can I access priv fields with unsafe code?
[04:40:19] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[04:40:30] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[04:40:32] <strcat> fread2281: indirectly
[04:40:33] <acrichto> fread2281: not without doing manual pointer arithmetic yourself
[04:40:57] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[04:41:04] <fread2281> acrichto: oh :(
[04:41:10] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[04:41:14] <aatch> erickt, well I'm not sure how much type safety you can keep without the params I have at the moment.
[04:41:16] * fread2281 thinks that would be a good feature
[04:41:17] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[04:41:17] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[04:41:50] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[04:41:59] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[04:42:11] <aatch> I need to make much of the type stuff I have at the moment use trait objects instead of a `Type` object.
[04:42:54] <bjz> jmgrosen: aye
[04:42:56] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[04:43:05] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[04:43:24] <erickt> aatch: I was thinking that to support a function like LLVMConstAdd which takes 2 ValueRefs in llvm-c but 2 Constant types in c++ that we have an empty `trait Constant {}` that a ConstInt struct implements. Then our wrapper function could be declared `fn const_add<T: Constant>(lhs: T, rhs: T) { ‚Ä¶ }`
[04:43:47] <jmgrosen> bjz: great -- and out of curiosity, where did you learn about those functions? i mean, how did you learn what they actually do/mean?
[04:43:49] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[04:44:01] <bjz> jmgrosen: which
[04:44:08] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[04:44:08] <bjz> jmgrosen: the maths functions?
[04:44:10] <erickt> aatch: maybe `Constant` would have to derive from a trait that provides a .to_value_ref() method or something
[04:44:16] <aatch> erickt, I think I did some of this stuff in another branch.
[04:44:17] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[04:44:25] <bjz> jmgrosen: inversion, multiplication determinants etc?
[04:44:37] <jmgrosen> bjz: no, the graphics ones like perspective
[04:44:53] <bjz> jmgrosen: http://www.amazon.com/gp/aw/d/1435458869
[04:45:07] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[04:45:38] <jmgrosen> bjz: that looks awesome, thanks!
[04:45:44] <erickt> aatch: did you find problems with that approach?
[04:45:50] <bjz> jmgrosen: http://www.mathfor3dgameprogramming.com/
[04:46:13] <aatch> erickt, a lot of code, I didn't get very far since I just ended up being overwhelmed.
[04:46:19] <bjz> jmgrosen: there are a few minor holes in it, and it comes from a mathematics point of view
[04:46:31] <bjz> jmgrosen: but I've found it very useful
[04:46:38] <aatch> The problem is trying to map a C++ heirarchy to the rust type system isn't very easy.
[04:46:53] <jmgrosen> bjz: yeah, it definitely sounds interesting -- i'll look into it!
[04:47:22] *** Joins: ahaxley (Mibbit@moz-ABE9BD2D.hsd1.ca.comcast.net)
[04:47:29] <bjz> jmgrosen: this is another good one: http://www.amazon.com/Math-Primer-Graphics-Development-Edition/dp/1568817231/ref=dp_ob_title_bk
[04:47:39] <erickt> aatch: yep, I can buy that. A couple years ago I experimented with the llvm/ocaml bindings to see if I could use their polymorphic variants to recapture some safety
[04:47:51] <erickt> I gave up pretty quickly though
[04:48:00] <bjz> jmgrosen: I've also looked a lots of maths libs for inspiration
[04:48:38] <jmgrosen> bjz: well, thanks for the pointers!
[04:48:43] <bjz> no worries
[04:48:56] <aatch> erickt, also, for most operations in LLVM, there is actually a restriction that the two operands have the same type.
[04:49:15] <Eridius> rusti: 3u
[04:49:19] -rusti- 3
[04:49:57] <erickt> aatch: I got to run now though, but I think we can do something nice here :)
[04:49:59] <Eridius> rusti: printfln!("%?", 3u)
[04:50:00] -rusti- 3
[04:50:00] -rusti- ()
[04:50:04] <Eridius> hrm, that's printing "3u" on my machine
[04:50:17] <erickt> aatch: I'll ping you tomorrow about it :) gnight!
[04:50:26] <aatch> erickt, do you have something already done I can look at for reference?
[04:50:28] <strcat> Eridius: the daily build happened before that landed
[04:50:30] <aatch> (just before you do)
[04:50:33] <aatch> go*
[04:50:46] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:50:46] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/h_tKwA
[04:50:46] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:50:51] <Eridius> strcat: why did that change? Seems odd that %? with any primitive numeric type would return something that doesn't parse as a number
[04:51:03] <strcat> Eridius: because that's what %? does?
[04:51:12] <strcat> it reprints it in a way that would parse as valid rust code
[04:51:18] <Eridius> ChrisMorgan: rust-http's generated code is now broken
[04:51:20] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[04:51:21] <strcat> it's reflection based on primitive rust type representations
[04:51:27] <strcat> it's *not* for anything but debugging
[04:51:35] <Eridius> ChrisMorgan: the status codes are now printed with the u suffix, but the status arg is a u16 instead of a uint
[04:51:39] <strcat> it's slow, and reveals internal details of types
[04:51:51] <Eridius> strcat: sadly rust-http is using it instead of %u when generating code >_<
[04:51:54] <strcat> imo it should be unsafe
[04:52:00] <strcat> because it violates privacy
[04:52:20] <strcat> makes any attempt at doing priv/pub useless when people are printing out internal reprs of your types ;p
[04:52:59] <strcat> rusti: let mut xs = std::hashmap::HashSet::new(); xs
[04:53:00] -rusti- <anon>:5:22: 5:48 error: cannot determine a type for this bounded type parameter: unconstrained type
[04:53:00] -rusti- <anon>:5          let mut xs = std::hashmap::HashSet::new(); xs
[04:53:00] -rusti-                                ^~~~~~~~~~~~~~~~~~~~~~~~~~
[04:53:01] -rusti- application terminated with error code 101
[04:53:05] <strcat> rusti: let mut xs = std::hashmap::HashSet::new(); xs.insert(5); xs
[04:53:09] -rusti- pastebinned 1 lines of output: http://ix.io/7CJ
[04:53:17] <strcat> that's not a public detail of hashmaps
[04:53:44] <strcat> sure, it's useful for debugging
[04:53:47] <strcat> but when else? ;p
[04:54:24] <ChrisMorgan> %u is only for uint, not u16, right?
[04:54:34] <strcat> ChrisMorgan: use the new format
[04:54:43] <Eridius> ChrisMorgan: yeah, but the code generator has them as uints. I just submitted a PR
[04:54:45] <Eridius> (to you)
[04:54:46] <strcat> rusti: format!("{} {}", 5, 6u)
[04:54:47] -rusti- ~"5 6"
[04:54:55] <strcat> rusti: format!("{1} {0} {1}", 5, 6u)
[04:54:56] -rusti- ~"6 5 6"
[04:55:02] <strcat> {} doesn't use reflection
[04:55:02] <Eridius> rusti: printfln!("%u", 3u16)
[04:55:04] <strcat> like %?
[04:55:05] -rusti- pastebinned 9 lines of output: http://ix.io/7CK
[04:55:21] <Eridius> ChrisMorgan: I didn't check to see if %? is used anywhere else btw, just looked at this one spot
[04:55:40] <strcat> anyway %? output can change day to day, it will never be stable
[04:55:43] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:55:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/gpCx2Q
[04:55:43] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:55:45] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:55:45] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/MxmSyg
[04:55:45] <ghrust> 13rust/06auto 14ed20425 15Alex Crichton: Upgrade libuv to the current master + our patches...
[04:55:45] <ghrust> 13rust/06auto 14b89e1c0 15Alex Crichton: Implement process bindings to libuv...
[04:55:45] <ghrust> 13rust/06auto 142ad05ae 15Alex Crichton: Fix various issues associated with building on windows
[04:55:47] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:55:49] <strcat> because it's private
[04:56:01] <SiegeLord> Anyone know where the source the Rust logo might be found?
[04:56:07] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[04:56:41] <Eridius> SiegeLord: possibly nowhere? the generated docs refer to it by absolute URL
[04:56:59] <SiegeLord> I guess it'd help to know the author and maybe ask him/her
[04:57:09] <SiegeLord> Maybe this is lost to the annals of time...
[04:57:11] <Eridius> there is src/etc/pkg/rust-logo.ico but of course that's 16x16
[04:57:14] <brson> SiegeLord: https://github.com/graydon/rust-www/tree/gh-pages/logos
[04:57:19] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[04:57:29] <SiegeLord> Aha, thanks brson 
[04:59:11] <bjz> rusti: struct V3([int, ..3]); V3([1, 2, 3]); V3[1]
[04:59:12] -rusti- <anon>:5:47: 5:51 error: cannot index a value of type `extern "Rust" fn([int, .. 3]) -> main::V3`
[04:59:12] -rusti- <anon>:5          struct V3([int, ..3]); V3([1, 2, 3]); V3[1]
[04:59:12] -rusti-                                                         ^~~~
[04:59:12] -rusti- error: aborting due to previous error
[04:59:12] -rusti- application terminated with error code 101
[04:59:29] <bjz> rusti: struct V3([int, ..3]); let v = V3([1, 2, 3]); v[1]
[04:59:30] -rusti- 2
[05:00:02] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:00:33] <jld> Is there an issue for "error: constant contains unimplemented expression type" on @strings?
[05:01:03] <bjz> rusti: struct V3([int, ..3]); let mut v = V3([1, 2, 3]); v[1] += 3; v[1]
[05:01:04] -rusti- 5
[05:01:30] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[05:01:53] <jld> ...on @string patterns, I mean?
[05:02:42] <bjz> rusti: fn f([x, _]: [int,..2]) -> int { x }
[05:02:42] -rusti- <anon>:5:14: 5:20 error: refutable pattern in function argument
[05:02:43] -rusti- <anon>:5          fn f([x, _]: [int,..2]) -> int { x }
[05:02:43] -rusti-                        ^~~~~~
[05:02:43] -rusti- error: aborting due to previous error
[05:02:43] -rusti- application terminated with error code 101
[05:02:51] <bjz> >:[
[05:04:21] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Connection reset by peer)
[05:04:25] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[05:05:23] <bjz> any word on this issue? https://github.com/mozilla/rust/issues/7784
[05:06:03] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[05:06:19] <Eridius> bjz: is that still valid? The case of refutable patterns was fixed
[05:06:28] <bjz> rusti: fn f([x, _]: [int,..2]) -> int { x }
[05:06:29] -rusti- <anon>:5:14: 5:20 error: refutable pattern in function argument
[05:06:29] -rusti- <anon>:5          fn f([x, _]: [int,..2]) -> int { x }
[05:06:30] -rusti-                        ^~~~~~
[05:06:30] -rusti- error: aborting due to previous error
[05:06:30] -rusti- application terminated with error code 101
[05:06:35] <bjz> Eridius: ^
[05:06:36] <Eridius> ah
[05:06:55] <Eridius> ok I guess the problem there isn't the same as with match. In this case it just considers the pattern itself to be refutable?
[05:08:30] <bjz> mm
[05:09:02] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[05:09:14] <bjz> rusti: match [1, 2] { [x,_] => x }
[05:09:15] -rusti- 1
[05:09:50] <strcat> heh
[05:09:57] <strcat> I wonder if that's broken
[05:10:02] <sfackler> is there a better way to do this? https://gist.github.com/sfackler/81c5a8ff9174be76932b
[05:10:18] <gavinb> bjz: so are you iimplementing algorithms from this book in Rust?
[05:10:19] <strcat> rusti: let xs = [~1, ~2]; match xs { [x, _] => x }
[05:10:20] -rusti- ~1
[05:10:22] <sfackler> I'd like to avoid the silly mut Option
[05:10:28] <strcat> rusti: let xs = [~1, ~2]; (match xs { [x, _] => x }, xs)
[05:10:34] <bjz> gavinb: well some of them
[05:10:40] <strcat> rusti: 2
[05:10:41] -rusti- pastebinned 8 lines of output: http://ix.io/7CM
[05:10:41] -rusti- 2
[05:11:16] <gavinb> bjz: for a game project, a 3D math library‚Ä¶? These are all topics of interest to me. :)
[05:11:51] <Eridius> rusti: let x; loop { x = 3; break; } x
[05:11:52] -rusti- 3
[05:12:05] <sfackler> oh cool
[05:12:08] <bjz> gavinb: yep
[05:12:12] <sfackler> i didn't know you could make an uninitialized value
[05:12:16] <Eridius> rusti: let x; loop { match Some(3) { None => (), Some(y) => { x = y; break; } }; x
[05:12:17] -rusti- <anon>:8:0: 8:1 error: file ended with unbalanced delimiters
[05:12:17] -rusti- <anon>:8 }
[05:12:17] -rusti-          ^
[05:12:17] -rusti- application terminated with error code 101
[05:12:20] <bjz> gavinb: https://github.com/bjz/cgmath-rs
[05:12:25] <Eridius> rusti: let x; loop { match Some(3) { None => (), Some(y) => { x = y; break; } } }; x
[05:12:26] -rusti- 3
[05:12:33] <Eridius> sfackler: only if you are guaranteed to initialize it before using it
[05:12:44] <Eridius> I was just checking if it was smart enough to realize that the only way past the loop is via the match arm that initializes it
[05:12:50] <Eridius> rusti: let x; loop { match Some(3) { None => (), Some(y) => { break; } } }; x
[05:12:53] -rusti- pastebinned 6 lines of output: http://ix.io/7CN
[05:13:02] <Eridius> rusti: let x: int; loop { match Some(3) { None => (), Some(y) => { break; } } }; x
[05:13:03] -rusti- <anon>:5:83: 5:84 error: use of possibly uninitialized variable: `x`
[05:13:03] -rusti- <anon>:5          let x: int; loop { match Some(3) { None => (), Some(y) => { break; } } }; x
[05:13:03] -rusti-                                                                                             ^
[05:13:03] -rusti- error: aborting due to previous error
[05:13:04] -rusti- application terminated with error code 101
[05:13:09] <Eridius> and apparently the answer is yes
[05:13:50] <sfackler> it'd be a bit cleaner if loop could return a value with break x; or something, but that seems pretty dubious
[05:13:52] <gavinb> bjz: looks great - I'm following
[05:14:10] <bjz> gavinb: if you want to help, let me know
[05:14:40] <strcat> sfackler: you can have uninit values as long as they are provable initialized in every branch leading up to a read
[05:14:44] <strcat> provably*
[05:14:45] <bjz> gavinb: it's been a long process, lots of redesigns. but I think I'm starting to converge on a good one
[05:15:09] <gavinb> bjz: cool, checking it out right now. I'd like to do some computational work in Rust. Looks really useful...
[05:15:31] <bjz> gavinb: are you doing cg or more scientific stuff?
[05:15:49] <Eridius> sfackler: btw you should stuff $conn into a variable before using it, because it might be an expression
[05:15:51] <bjz> gavinb: it's not really an n-dimensional one
[05:16:01] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[05:16:22] <sfackler> Eridius: good call
[05:16:47] <gavinb> bjz: most of my work is image processing and viz, and CG comes in really handy.
[05:17:07] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[05:17:10] *** Parts: jack (jack@moz-DF5A9AA3.members.linode.com) (ERC Version 5.3 (IRC client for Emacs))
[05:17:20] <sfackler> it'd be nice if there was a macro parameter type for the RHS of a match case, including the , if needed
[05:17:24] <bjz> gavinb: if you have any thoughts on how to make it more useful to you, let me know
[05:17:35] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[05:17:41] <bjz> gavinb: there is also: https://github.com/sebcrozet/nalgebra
[05:17:41] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Connection reset by peer)
[05:17:57] <bjz> gavinb: but I have take differant design descisions
[05:18:04] <bjz> *different
[05:18:29] <gavinb> bjz: I just got all excited about writing OpenCL bindings, and found someone already beat me to it...
[05:18:35] <bjz> heh
[05:18:40] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[05:18:58] <bjz> gavinb: now is the time to start making awesomeness
[05:19:02] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[05:19:24] <bjz> gavinb: this needs work: https://github.com/bjz/color-rs
[05:19:26] <gavinb> It looks like many critical pieces I would want are coming together though - OpenGL, glfw, OpenCL, 3D math, etc
[05:19:58] <bjz> gavinb: that's what I'm trying to help with. we really need solid graphics stuff
[05:20:30] <bjz> gavinb: an awesome bullet physics wrapper would be great too
[05:20:58] <bjz> gavinb: but that would mean writing a proper C API
[05:21:15] <bjz> the one that's there is pretty awful
[05:21:20] <gavinb> bjz: my stuff is pretty much scientific, though gamed is always fun too
[05:22:05] <gavinb> The colour stuff is heading in the right direction. It's nice to see they didn't confuse YUV and Y'CbCr. But the colour spaces are not represented (ie. Rec.601 vs Rec.709).
[05:23:53] <bjz> gavinb: that's what I need help with
[05:24:07] <bjz> gavinb: somebody who know's what they're doing :)
[05:24:21] <bjz> gavinb: it's mine
[05:24:38] <bjz> ;)
[05:24:58] <gavinb> bjz: ah cool :) well I'd be happy to offer my input then
[05:26:03] <gavinb> I work with this stuff, and can't use most libs coz they get so much stuff wrong or make major assumptions
[05:26:10] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[05:26:31] <Eridius> it occurs to me that sfackler's loop is actually a good example of what I'm now thinking of as an inverted iterator
[05:26:39] <bjz> gavinb: yeah
[05:26:42] <Eridius> he wanted to loop until he produced one value, as opposed to producing values until you emit one None
[05:27:13] *** Joins: jack (jack@moz-DF5A9AA3.members.linode.com)
[05:27:22] <gavinb> bjz: I will have a look and ping you some time
[05:27:22] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Connection reset by peer)
[05:27:29] <Eridius> I wonder if it would make sense to create a function that does exactly this, e.g. fn iterate<T>(f: &fn() -> Some<T>) { loop { match f() { None => loop, Some(x) => return x } } }
[05:28:07] <bjz> gavinb: we were thinking of using phantom types to represent the color spaces: https://github.com/bjz/color-rs/issues/1
[05:28:21] *** Joins: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au)
[05:29:41] <gavinb> bjz: that's a clever idea; provided the algorithms could easily adapt (eg. using different XYZ primaries, etc)
[05:30:05] <bjz> gavinb: was just an idea, not sure how practical it'd be
[05:31:19] <gavinb> bjz: then there's the very hairy question of pixel formats; ie. packing, etc. For example, the v210 video format is quite gnarly, with 10-bit words tightly packed into a sequence of blocks.
[05:31:31] <bjz> gavinb: aye
[05:31:38] <gavinb> Not even sure how to do this stuff in Rust; I tend to use SSE code for that anyway.
[05:31:51] <bjz> gavinb: might need a [u8,..n], then cast
[05:31:58] <bjz> :/
[05:33:06] <bjz> gavinb: but yeah, there's nothing stopping you making your own, and I could just use that :P
[05:33:16] <bjz> was just trying to get the ball rolling
[05:35:14] <gavinb> bjz: of course‚Ä¶ is this primarily intended for 2D graphics, 3D graphics, video, or other?
[05:37:01] *** Quits: sp3d (a@moz-6F12212B.fidnet.com) (Ping timeout)
[05:41:58] <ahaxley> the "destructors" section in the tutorial is kind of confusing. it seems more like an intro to heap allocation more than "this is where we teach about destructors"
[05:42:35] *** Joins: sp3d (a@moz-6F12212B.fidnet.com)
[05:43:17] <strcat> ahaxley: the tutorial as a whole needs to be rewritten, it's not good
[05:43:44] <strcat> out-of-date, wrong in many places, and lacking proper examples/information
[05:44:04] <strcat> known problem but just needs people to actually work on it
[05:44:05] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:44:08] <ahaxley> i've been able to follow it until the section about destructors, ownership, and boxing
[05:44:31] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[05:44:33] <ahaxley> like i can still figure stuff out but it's kind of rough waters
[05:44:43] <strcat> which is the first semantic thing it really covers
[05:45:45] <ahaxley> not sure what you mean by semantic
[05:45:54] <ahaxley> i'm familiar with the word, just missing context
[05:46:11] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[05:46:56] <bjz> gavinb: probably 2d/3d
[05:49:16] <strcat> ahaxley: as in it's the first part of the tutorial having to introduce more than just syntax, but it's not far enough in that the examples can be useful
[05:49:47] <ahaxley> ah
[05:50:16] <strcat> it's very hard to write that part in a way that's approachable for people with different language backgrounds
[05:50:19] * strcat shrugs
[05:51:10] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[05:51:16] <ahaxley> feels like it's written by someone who frequents ltu and is really into compilers :)
[05:51:29] <ahaxley> which makes sense. it's a pretty young language.
[05:51:34] <sfackler> does anyone have any idea what's going on with this compile error? i can't seem to replicate it in a minimal example: https://gist.github.com/sfackler/22b614b481ab2c92f969#file-gistfile2-txt
[05:51:37] <aatch> ahaxley, so one of the contributors.
[05:51:47] * strcat thinks it was me
[05:51:47] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:51:53] <strcat> but... it's way better than it was before
[05:52:21] <ahaxley> i don't mean to rag on it. it's helping me get my feet wet.
[05:52:24] <strcat> it used to be wrong, didn't have examples, and tried to explain it in terms of C++ which is easy but only helps a C++ programmer :P
[05:52:29] <strcat> I know it's still bad
[05:52:39] <strcat> just really hard to write that kind of documentation :)
[05:53:12] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:53:35] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[05:54:45] <aatch> rusti: info!("test")
[05:54:47] -rusti- ()
[05:55:00] <strcat> rusti: __log(2, "foo")
[05:55:01] -rusti- ()
[05:55:02] <strcat> rusti: __log(1, "foo")
[05:55:03] -rusti- "foo"
[05:55:03] -rusti- ()
[05:55:06] <strcat> ;p
[05:55:18] * strcat hates that ugly thing
[05:57:00] *** Joins: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net)
[05:57:29] <acrichto> libuv landed !!
[05:57:38] <klutzy> yey!
[05:57:40] <acrichto> 14th time's the charm
[05:58:35] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:58:40] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Ping timeout)
[05:58:51] *** Joins: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net)
[05:58:59] <acrichto> olsonjeffery: ^
[06:00:01] <brson> acrichto: \o/
[06:00:32] * acrichto awaits results in irfy
[06:00:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[06:00:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/MxmSyg
[06:00:39] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[06:00:49] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[06:01:07] <strcat> acrichto: the new process spawning stuff?
[06:01:27] <acrichto> a new backend at least
[06:01:34] <acrichto> (non-blocking libuv)
[06:02:13] <strcat> acrichto: any idea if it uses posix_spawn instead of fork (in some cases)?
[06:02:15] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Quit: dbaupp)
[06:02:22] <acrichto> I don't think so
[06:02:30] <acrichto> nope :(
[06:02:52] <strcat> meh
[06:03:02] <strcat> I feel like just writing that for rustc's call to the linker
[06:03:05] <acrichto> although I don't think that the libuv support for forking is at the highest of quality yet, and they'd probably be up for taking patches
[06:03:07] <strcat> it's always where it goes OOM
[06:03:13] <sfackler> ugh, the pat type in macros doesn't match A | B patterns
[06:03:27] <acrichto> strcat: what's the difference with posix_spawn?
[06:04:43] <strcat> acrichto: glibc's posix_spawn will not copy the page tables for simple (most) cases
[06:04:56] <strcat> as in it uses no more address space
[06:05:07] <strcat> before execve
[06:05:20] <acrichto> isn't there something which is essentially fork()/exec() but without the copying of fork
[06:05:25] <Eridius> posix_spawn
[06:05:25] *** Joins: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net)
[06:05:26] <strcat> the problem right now is that we use a ton of VM, and people have installs without swap + low overcommit rati
[06:05:27] <acrichto> it just directly creates a new process
[06:05:28] <strcat> ratio*
[06:05:35] <acrichto> yeah :(
[06:05:35] <strcat> acrichto: that's what posix_spawn is
[06:05:36] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:05:36] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Hp0rxg
[06:05:36] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:05:38] <acrichto> ah
[06:05:40] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:05:40] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/BUdDew
[06:05:40] <ghrust> 13rust/06auto 14da559b2 15Jason Fager: Replace HashUtil w/ default method on Hash
[06:05:40] <ghrust> 13rust/06auto 1478c5f97 15bors: auto merge of #8805 : jfager/rust/remove-hashutil, r=alexcrichton
[06:05:41] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:05:41] <acrichto> nvmd then
[06:05:44] <strcat> (vfork is deprecated)
[06:05:50] <acrichto> that was the name I was thinking of
[06:05:55] <Eridius> posix_spawn is faster than fork/exec, and also lets you specify which fds to preserve in the new process instead of having to mark everything CLOEXEC
[06:06:15] <acrichto> I wonder why libuv doesn't use it
[06:06:29] <strcat> well it doesn't handle all cases, so it depends on the power they expose
[06:06:40] <strcat> it handles 90% of sane cases
[06:06:46] <acrichto> what's it lacking?
[06:07:01] <strcat> well when you fork(), you can then set up weird stuff for the child process before you exec
[06:07:03] <dbaupp> did we enable windows tests?
[06:07:21] <strcat> setuid/setgid, namespaces, whatever
[06:07:41] <acrichto> oh that's unfortunate, libuv does do setuid/setguid
[06:07:55] <acrichto> although it seems like they could only resort to fork on those cases
[06:08:55] <jld> `error: Do-block body must return bool, but returns () here. Perhaps you meant to write a `for`-loop?`  No, I don't think I did, because I think those don't exist anymore.
[06:09:07] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:09:16] <strcat> I thought I removed that error msg
[06:09:18] * strcat shrugs
[06:09:27] <Eridius> I removed it
[06:09:30] <Eridius> jld: how old is your rustc?
[06:09:42] <strcat> oh I removed a different one
[06:09:45] <sfackler> rusti: let x: int; loop { x = 1; break; } x
[06:09:47] -rusti- 1
[06:10:15] <sfackler> rusti: let x: int; loop { match Some(1) { Some(x) => { x = 1; break;} None => () } x
[06:10:16] -rusti- <anon>:8:0: 8:1 error: file ended with unbalanced delimiters
[06:10:16] -rusti- <anon>:8 }
[06:10:16] -rusti-          ^
[06:10:16] -rusti- application terminated with error code 101
[06:10:23] <sfackler> rusti: let x: int; loop { match Some(1) { Some(x) => { x = 1; break;} None => () }} x
[06:10:24] -rusti- <anon>:5:86: 5:87 error: use of possibly uninitialized variable: `x`
[06:10:24] -rusti- <anon>:5          let x: int; loop { match Some(1) { Some(x) => { x = 1; break;} None => () }} x
[06:10:24] -rusti-                                                                                                ^
[06:10:24] -rusti- error: aborting due to previous error
[06:10:25] -rusti- application terminated with error code 101
[06:10:29] <jld> Eridius: Based on master as of Tue Aug 27 18:20:44 2013 -0700
[06:10:30] <Eridius> sfackler: didn't I try that exact same case earlier?
[06:10:32] <sfackler> rusti: let x; loop { match Some(1) { Some(x) => { x = 1; break;} None => () }} x
[06:10:42] -rusti- pastebinned 6 lines of output: http://ix.io/7CO
[06:10:57] <sfackler> rusti: let x; loop { match Some(1i) { Some(x) => { x = 1; break;} None => () }} x
[06:11:01] -rusti- pastebinned 6 lines of output: http://ix.io/7CP
[06:11:10] <acrichto> brson: why does the logging of the runtime take Either<~str, &'static str>, as in why not &str ?
[06:11:27] <Eridius> jld: hrm, I removed the error in 0450cde37b70e7c32a2d5d359836b737c5fdc657
[06:11:35] <sfackler> Eridius: I thought you did, but I'm running into issues where it starts complaining only when I specify a type for x
[06:11:58] <Eridius> sfackler: you shadowed x
[06:12:06] <Eridius> sfackler: which means you never actually set the outer uninitialized one
[06:12:22] <jld> Eridius: ...oh.  That error was from the stage0 compiler, which is older.
[06:12:25] <sfackler> rusti: let x: int; loop { match Some(3) { None => (), Some(y) => { x = y; break; } } }; x
[06:12:26] -rusti- 3
[06:12:27] <Eridius> jld: ahh
[06:12:31] <sfackler> hmm, maybe not
[06:13:12] <sfackler> gah, i'm an idiot
[06:13:38] <sfackler> woo, victory!
[06:13:41] <Eridius> \o/
[06:16:23] * jld continues porting rustc changes made in the time of @CrateContext.  borrowck errors!
[06:16:56] <brson> acrichto: the idea was that the logger might want to do more sophisticated things like send logs to another task. currently overdesigned for what it does
[06:17:21] <acrichto> brson: ok, cool
[06:17:41] <acrichto> also apparently whenever I attempt to make rustc faster I just make it regress :( http://huonw.github.io/isrustfastyet/buildbot/
[06:17:53] *** Quits: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz) (Quit: brb)
[06:18:37] <brson> acrichto: yikes. it did make unix faster. not sure what's going on with windows - it doesn't even run any process-spawning tests
[06:19:06] * strcat would guess noise
[06:19:11] <acrichto> 19 minutes of noise?
[06:19:19] <acrichto> with no noise previously in winodws at all
[06:19:20] <brson> acrichto: oh, the unix improvement was pcwalton :-)
[06:19:26] <acrichto> yeah :(
[06:19:33] <acrichto> I made linux slower it looks like
[06:19:37] <strcat> http://huonw.github.io/isrustfastyet/buildbot/all
[06:19:38] <acrichto> at least 32-bit
[06:20:10] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[06:20:15] <nielsle> rusti fn first<NoType>(args: (int, NoType)) -> int { args[0]}
[06:20:18] * dbaupp really should port /buildbot to d3 so that /all is useable
[06:20:40] *** Quits: ahaxley (Mibbit@moz-ABE9BD2D.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:20:51] <brson> acrichto: let's see what the next build does
[06:22:25] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[06:22:49] *** Joins: fabiand (fabiand@moz-FD30B0F9.adsl.alicedsl.de)
[06:23:25] *** Quits: ChrisMorgan (chris@moz-80C478D2.its.monash.edu.au) (Connection reset by peer)
[06:25:48] *** Quits: tikue_ (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net) (Quit: tikue_)
[06:26:37] *** Quits: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[06:26:44] *** Joins: geomyidae (geomyidae@DD6F7E3A.21468E9A.30200F38.IP)
[06:31:07] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[06:31:49] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[06:32:05] <zeuxcg> rusti: let str = ~"test"; do std::task::try { println(str); };
[06:32:10] -rusti- test
[06:32:10] -rusti- ()
[06:32:16] <zeuxcg> hrm
[06:32:34] <acrichto> brson: does try_unsafe_borrow return None in many normal situations?
[06:32:43] <zeuxcg> rusti: let str = ~"test"; do std::task::try { for i in range(0, 2) { println(str); }; };
[06:32:52] -rusti- pastebinned 6 lines of output: http://ix.io/7CQ
[06:33:15] <zeuxcg> rusti: let str = ~"test"; for i in range(0, 2) { do std::task::spawn { println(str); }; };
[06:33:18] -rusti- pastebinned 8 lines of output: http://ix.io/7CR
[06:33:57] <zeuxcg> rusti: let str = extra::arc::Arc::new("test"); for i in range(0, 2) { do std::task::spawn { println(str.unwrap()); }; };
[06:34:01] -rusti- pastebinned 11 lines of output: http://ix.io/7CS
[06:34:15] <zeuxcg> so...
[06:34:42] <zeuxcg> how do I make my last example work?
[06:35:01] <zeuxcg> I thought Arc type is specifically for sharing data between tasks
[06:35:05] <brson> acrichto: probably not currently. for a while the scheduler was not a task so it was used more frequently. now it will mostly only return None in 'runtimeless' scenarios
[06:35:07] <zeuxcg> but I can't capture it with a closure.
[06:35:58] <brson> zeuxcg: take a clone of the arc each time through the loop
[06:36:05] *** Quits: dolphinling (andrew@moz-80A1E448.uvm.edu) (Ping timeout)
[06:36:06] <brson> let str_clone = str.clone()
[06:36:09] <brson> then capture the clone
[06:36:14] <zeuxcg> ah!
[06:37:01] <acrichto> brson: I was looking into making fewer allocations while logging, and I wanted to use the new uv-based io but creating a handle to stderr requires an allocation. Do you think it'd be ok to cache an io::Writer instance in the task and otherwise if it's None just always allocate one?
[06:43:05] <brson> acrichto: it's probably worth trying, but there is going to be a significant performance tradeoff in the current system. I/O is 'homed' so logging will sometimes involve rescheduling on the home thread. logging is not necessarily expected to be perf and is off by default so maybe this is ok.
[06:43:21] <brson> acrichto: there's also the consideration that the IoFactory is in theory not always available
[06:43:36] <brson> acrichto: this will the case e.g. if we back a scheduler with the glfw event loop
[06:43:41] <brson> but I think go for it
[06:43:44] <brson> dogfooding is good
[06:44:25] <brson> another consideration is that Task needs to be as lightweight as possible and it's already pretty fat
[06:44:41] <brson> we're probably going to be coming back to this down the road to try to trim it down again
[06:44:43] *** Joins: dolphinling (andrew@moz-80A1E448.uvm.edu)
[06:44:43] <dbaupp> acrichto: can you just put it in TLS?
[06:45:05] <Eridius> cmr Seldaek: rustdoc_ng left the /*! in the docstring for http://seld.be/rustdoc/master/std/rt/index.html
[06:45:20] *** flaper87|afk is now known as flaper87
[06:45:34] <Eridius> also http://seld.be/rustdoc/master/std/rt/io/index.html has a rather.. unique.. docstring
[06:45:40] <acrichto> brson: oh hm, I could take dbaupp's approach and shove it in TLS possibly
[06:45:49] <acrichto> at least to make the task less fat
[06:46:00] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[06:46:21] <dbaupp> Eridius: http://seld.be/rustdoc/master/std/rt/io/trait.Seek.html (cmr, Seldaek)
[06:46:37] <acrichto> http://seld.be/rustdoc/master/std/fmt/index.html doesn't have a nice doc string at the top :(
[06:46:50] <acrichto> is https://github.com/mozilla/rust/blob/master/src/libstd/fmt/mod.rs not right?
[06:47:05] <dbaupp> acrichto: s/**/*/
[06:47:17] <dbaupp> it should be /*! ... */
[06:47:25] <brson> acrichto: probably move the entire Logger instance into TLS then. I think I prefer not to do that yet though
[06:47:28] <acrichto> dbaupp: oh ok
[06:47:42] <brson> tough call
[06:48:28] <acrichto> brson: hm, I was hoping to call std::fmt::write with some arguments so you don't have to allocate an intermediate format string
[06:48:37] <acrichto> but that requires using rt::io::Writer
[06:48:51] <brson> acrichto: go ahead and put it into the Logger in the Task, just not TLS
[06:48:56] *** Joins: napoleon (Mibbit@moz-9771C41D.e165.xgate.co.kr)
[06:48:56] <acrichto> ok
[06:49:05] <napoleon> a
[06:50:06] <dbaupp> acrichto: can you impl writer for logger?
[06:50:09] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Input/output error)
[06:51:34] <acrichto> dbaupp: that may also work, I think I'll poke around a bit and see what I can get to work
[06:52:00] <acrichto> this'll involve making a macro along the lines of format_args!("format {}", "string", |safe_precompiled_format_arguments| { })
[06:52:15] <acrichto> and then you can pass around the arguments to everything and eventually into std::fmt
[06:54:25] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[06:54:36] <zeuxcg> rusti: let str = extra::arc::Arc::new("test"); for i in range(0, 2) { do std::task::spawn { let x = str.clone(); println(x.unwrap()); }; };
[06:54:40] -rusti- pastebinned 8 lines of output: http://ix.io/7CT
[06:55:00] <zeuxcg> rusti: let str = extra::arc::Arc::new("test"); for i in range(0, 2) { let x = str.clone(); do std::task::spawn { println(x.unwrap()); }; };
[06:55:04] -rusti- pastebinned 5 lines of output: http://ix.io/7CU
[06:55:39] <zeuxcg> rusti: let str = extra::arc::Arc::new(~"test"); for i in range(0, 2) { let x = str.clone(); do std::task::spawn { println(x.unwrap()); }; };
[06:55:48] -rusti- pastebinned 5 lines of output: http://ix.io/7CV
[06:55:57] <dbaupp> rusti: let str = extra::arc::Arc::new(~"test"); for i in range(0, 2) { let x = str.clone(); do std::task::spawn { println(*x.get()); }; };
[06:55:59] -rusti- <anon>:5:54: 5:55 warning: unused variable: `i` [-W unused-variable (default)]
[06:55:59] -rusti- <anon>:5          let str = extra::arc::Arc::new(~"test"); for i in range(0, 2) { let x = str.clone(); do std::task::spawn { println(*x.get()); }; };
[06:55:59] -rusti-                                                                ^
[06:55:59] -rusti- test
[06:55:59] -rusti- test
[06:56:31] <dbaupp> rusti: let str = extra::arc::Arc::new(~"test"); for _ in range(0, 2) { let x = std::cell::Cell::new(str.clone()); do std::task::spawn { println(x.take().unwrap()); }; };
[06:56:33] -rusti- task <unnamed> failed at 'Another task is already unwrapping this Arc!', /build/rust-git/src/rust/src/libstd/unstable/sync.rs:178
[06:56:33] -rusti- task <unnamed> failed at 'killed by linked failure', /build/rust-git/src/rust/src/libstd/rt/kill.rs:627
[06:56:56] <dbaupp> (that's a runtime failure, not a compile failure)
[06:57:10] <zeuxcg> ah
[06:57:14] <zeuxcg> should've read the unwrap docs
[06:57:30] <zeuxcg> I thought it's like Result unwrap in that it just gives the value
[06:57:45] <zeuxcg> that's why it hangs for me
[06:57:47] <zeuxcg> thanks!
[06:59:04] <dbaupp> it does just give the value, but it moves, so it means the Arc is then invalid for all tasks (as it is shared)
[06:59:18] <zeuxcg> yeah
[06:59:21] *** Joins: jaen (jaen@moz-1485333B.neoplus.adsl.tpnet.pl)
[07:02:25] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:04:49] *** Parts: z0w0 (corrz@C3BC732A.9254B1A4.F22F0031.IP) ()
[07:05:19] <dbaupp> it looks like that wasn't noise
[07:05:25] <dbaupp> acrichto: ^
[07:06:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:06:56] <acrichto> yeah :(
[07:07:16] <gavinb> dbaupp: hey, I was bugging you the other day about 'use' and why you needed to import a trait by name in addition to the module.  I got cut off before finishing the conversation. Since then, I've read the docs on 'use', modules and crates, etc. And I cannot find any explanation of why/how this is required.
[07:08:44] <gavinb> I believe the example was why use std::rand::RngUtil; was required in addition to "use std::rand;" for the gen() method to work?
[07:09:58] <dbaupp> hm
[07:10:00] <gavinb> I thought that "use std::foo" would pull in all public structs, functions, symbols etc but you mentioned something about trait methods having to be at the root level to be visible? Is that right?
[07:10:17] <dbaupp> no, it pulls in the `foo` name
[07:10:26] *** Joins: [squiddy] (squiddy@moz-13793045.adsl.alicedsl.de)
[07:10:27] <dbaupp> which allos you to write foo::<pub thing>
[07:10:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:10:36] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/BUdDew
[07:10:36] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:10:45] <dbaupp> it doesn't introspect into `foo` at all.
[07:12:14] <dbaupp> say you did allow importing a mod to bring in all the traits, then `x.some_method()` would require checking every trait in every module in scope
[07:12:24] <gavinb> dbaupp: ok, but RngUtil is public, and in the same module as IsaacRng yet an extra use is required for the method to resolve?
[07:13:02] <Eridius> gavinb: you can't use a trait method unless the trait is in-scope
[07:13:03] <strcat> methods from traits resolve if the trait is in scope
[07:13:15] <strcat> there is no other magic, 'use' just imports a name into the current scope
[07:13:21] <dbaupp> gavinb: and you'd lose a whole pile of control, e.g. imagine if you'd also imported some other module with a trait that defined a method gen and impled it on IsaacRng
[07:13:45] <dbaupp> you wouldn't be able to import std::rand and that module in the same file and call gen.
[07:13:50] <Eridius> incidentally, what happens right now if 2 traits define the same method and both are in-scope?
[07:14:00] <gavinb> Hm, ok - it makes sense from that perspective.
[07:14:18] <strcat> Eridius: you can't use it
[07:14:19] <dbaupp> Eridius: it normally works if they aren't impl'd for the same type
[07:14:38] <dbaupp> but <T: Bound> Trait for T conflicts with everything
[07:14:48] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[07:14:52] <strcat> if there are two traits with a `foo` method impl'ed for int, if you bring both into scope you can't call `foo` in int
[07:15:01] <strcat> dbaupp: that's a bug though
[07:15:09] <gavinb> I guess it's just that as a dumb user, you see a method in std::rand you want to use it, you get a weird error and it's not obvious why calling a method in that very same module won't work.
[07:15:16] <dbaupp> rusti: trait Foo { fn method(&self) {} } trait Bar { fn method(&self) {} } impl Foo for int {} impl Bar for uint {} 1i.method()
[07:15:17] -rusti- ()
[07:15:22] <dbaupp> rusti: trait Foo { fn method(&self) {} } trait Bar { fn method(&self) {} } impl Foo for int {} impl Bar for uint {} 1u.method()
[07:15:23] -rusti- ()
[07:15:31] <dbaupp> rusti: trait Foo { fn method(&self) {} } trait Bar { fn method(&self) {} } impl Foo for uint {} impl Bar for uint {} 1u.method()
[07:15:47] <strcat> ix.io is really slow atm
[07:15:58] <dbaupp> gavinb: that's mostly a problem of bad tutorials & documentation, though, right?
[07:16:06] -rusti- pastebinned 7 lines of output: http://ix.io/7CX
[07:16:09] <dbaupp> (and bad error messages)
[07:16:19] <dbaupp> heh
[07:16:29] <gavinb> dbaupp: yeah I think an improved error message would help a lot
[07:17:36] <dbaupp> ooh, that ICE appears to be a default method bug
[07:19:48] * dbaupp files it
[07:20:52] *** Quits: eskatrem (user@moz-600D73A9.dyn.user.ono.com) (Client exited)
[07:21:27] <gavinb> rusti: use std::rand; let r=rand::rng(); let f=r.gen::<uint>();
[07:21:30] -rusti- <anon>:5:49: 5:65 error: type `std::rand::IsaacRng` does not implement any method in scope named `gen`
[07:21:30] -rusti- <anon>:5          use std::rand; let r=rand::rng(); let f=r.gen::<uint>();
[07:21:30] -rusti-                                                           ^~~~~~~~~~~~~~~~
[07:21:30] -rusti- error: aborting due to previous error
[07:21:31] -rusti- application terminated with error code 101
[07:21:57] <gavinb> rusti: use std::rand; use std::rand::RngUtil; let r=rand::rng(); let f=r.gen::<uint>();
[07:21:58] -rusti- <anon>:5:73: 5:74 error: cannot borrow immutable local variable as mutable
[07:21:58] -rusti- <anon>:5          use std::rand; use std::rand::RngUtil; let r=rand::rng(); let f=r.gen::<uint>();
[07:21:58] -rusti-                                                                                   ^
[07:21:58] -rusti- error: aborting due to previous error
[07:21:59] -rusti- application terminated with error code 101
[07:22:12] <gavinb> use std::rand; use std::rand::RngUtil; let mut r=rand::rng(); let f=r.gen::<uint>();
[07:22:44] <gavinb> rusti: use std::rand; use std::rand::RngUtil; let r=rand::rng(); let f=r.gen::<uint>();
[07:22:45] <dbaupp> rusti: use std::rand; use std::rand::RngUtil; let mut r=rand::rng(); let f=r.gen::<uint>(); f
[07:22:45] -rusti- <anon>:5:73: 5:74 error: cannot borrow immutable local variable as mutable
[07:22:47] -rusti- <anon>:5          use std::rand; use std::rand::RngUtil; let r=rand::rng(); let f=r.gen::<uint>();
[07:22:47] -rusti-                                                                                   ^
[07:22:47] -rusti- error: aborting due to previous error
[07:22:47] -rusti- application terminated with error code 101
[07:22:47] -rusti- 12148966322248197763
[07:23:09] <dbaupp> gavinb: (the error is your code)
[07:23:46] <dbaupp> rusti: use std::rand; use std::rand::RngUtil; let r=rand::task_rng(); let f=r.gen::<uint>();
[07:23:47] -rusti- <anon>:5:78: 5:79 error: cannot borrow immutable local variable as mutable
[07:23:47] -rusti- <anon>:5          use std::rand; use std::rand::RngUtil; let r=rand::task_rng(); let f=r.gen::<uint>();
[07:23:47] -rusti-                                                                                        ^
[07:23:47] -rusti- error: aborting due to previous error
[07:23:48] -rusti- application terminated with error code 101
[07:23:48] <gavinb> bloody clipboard didn't paste what I meant! :(
[07:24:04] <dbaupp> :/ that should really work.
[07:25:25] <dbaupp> rusti: trait Foo { fn x(&mut self) {} } impl Foo for uint {} impl<T: Foo> Foo for @mut T {} let y = @mut 1; y.x();
[07:25:26] -rusti- <anon>:5:110: 5:116 error: failed to find an implementation of trait main::Foo for int
[07:25:26] -rusti- <anon>:5          trait Foo { fn x(&mut self) {} } impl Foo for uint {} impl<T: Foo> Foo for @mut T {} let y = @mut 1; y.x();
[07:25:26] -rusti-                                                                                                                        ^~~~~~
[07:25:26] -rusti- application terminated with error code 101
[07:25:31] <dbaupp> rusti: trait Foo { fn x(&mut self) {} } impl Foo for uint {} impl<T: Foo> Foo for @mut T {} let y = @mut 1u; y.x();
[07:25:32] -rusti- <anon>:5:111: 5:112 error: cannot borrow immutable local variable as mutable
[07:25:32] -rusti- <anon>:5          trait Foo { fn x(&mut self) {} } impl Foo for uint {} impl<T: Foo> Foo for @mut T {} let y = @mut 1u; y.x();
[07:25:32] -rusti-                                                                                                                         ^
[07:25:35] -rusti- error: aborting due to previous error
[07:25:37] -rusti- application terminated with error code 101
[07:25:40] <dbaupp> rusti: trait Foo { fn x(&mut self) {} } impl Foo for uint {} let y = @mut 1u; y.x();
[07:25:42] -rusti- ()
[07:25:44] <dbaupp> :(
[07:25:52] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:26:53] <gavinb> Anyway, so the message: error: type `std::rand::IsaacRng` does not implement any method in scope named `gen` is confusing IMHO because it _is_ defined in that very same module (scope).
[07:27:35] <gavinb> Though I guess I am interpreting "scope" as "in the same scope as the IsaacRng declaration" whereas it means "in the top-level scope of your app".
[07:29:12] *** Joins: ofeldt- (ofeldt@moz-5DD5789D.dip0.t-ipconnect.de)
[07:29:52] *** Quits: ofeldt (ofeldt@moz-D77116F7.dip0.t-ipconnect.de) (Ping timeout)
[07:29:52] <dbaupp> yes
[07:30:33] <dbaupp> that's exactly what it is; the scope were you're calling the method, not the scope were the method/type is defined
[07:30:38] <dbaupp> *where
[07:31:06] *** Quits: [squiddy] (squiddy@moz-13793045.adsl.alicedsl.de) (Quit: Leaving)
[07:33:46] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[07:37:14] <zeuxcg> so I get a feeling that I'm doing something wrong
[07:37:17] <zeuxcg> https://github.com/zeux/oxid/blob/master/src/tools/materials.rs#L41
[07:37:21] <zeuxcg> it works.
[07:37:31] <zeuxcg> it's ugly as hell and full of clones and *smth.get()
[07:37:39] <zeuxcg> is it supposed to be like this? :-/
[07:38:19] <zeuxcg> I need to run a bunch of shell commands in parallel with output to temp folder, and then wait for all of them and concat the files they've written into another file.
[07:38:35] <gavinb> dbaupp: thanks, that clarifies it
[07:40:19] *** Joins: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de)
[07:41:05] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[07:41:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[07:43:13] <zeuxcg> as a random question - why do I need to constantly clone inside the inner closures? i.e. targetcolor.clone() etc.
[07:43:17] <zeuxcg> if I don't I get this:
[07:43:34] <zeuxcg> src/tools/materials.rs:67:35: 67:46 error: cannot move out of captured outer variable in a heap closure
[07:43:34] <zeuxcg> src/tools/materials.rs:67                     ~"-composite", targetcolor]);
[07:44:05] <zeuxcg> but why can't the compiler move the variable to the closure?
[07:44:20] <zeuxcg> seeing as it's only used in it, and is built using fmt!
[07:44:21] <dbaupp> zeuxcg: https://github.com/mozilla/rust/wiki/Doc-under-construction-FAQ#once-functions
[07:45:14] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[07:45:30] <zeuxcg> so this is still a bit weird.
[07:45:40] <dbaupp> yeah
[07:45:45] <zeuxcg> inside the closure body I only need this value as &str
[07:45:47] <zeuxcg> not ~str
[07:45:53] <dbaupp> the fact that process_status takes &[~str] is a bug
[07:46:02] <zeuxcg> oh wait, right
[07:46:05] <dbaupp> (which would meant that system could take &[&str])
[07:46:34] <dbaupp> and so you wouldn't have to move targetcolor into the vector (since ~str moves and requires an explicit copy)
[07:46:34] <zeuxcg> yeah, and then I could have constructed the closure without cloning, right?
[07:46:48] <dbaupp> yeah, I think so
[07:46:54] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[07:47:00] <dbaupp> hmm.
[07:47:33] <dbaupp> You can get rid of many of the clones using spawn_with
[07:48:02] <zeuxcg> yeah
[07:48:09] <dbaupp> do task::spawn_with((targetcolor, targetcolordds)) |(targetcolor, targetcolordds)| { .. } and then only the first clone is required
[07:48:31] <dbaupp> (and similarly for targetdxdy/targetdxdydds.)
[07:49:07] <dbaupp> I'm fairly sure the tfpath.clone()'s can be removed too
[07:49:25] <dbaupp> also, why task::try?
[07:50:44] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[07:51:19] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[07:52:04] <zeuxcg> I have an impression that one of the major offenders is [~str] inside process_status
[07:52:17] <dbaupp> I think let tfpath = std::cell::Cell::new(tf.to_str()); ... do task::try { let targetpath = tfpath.take(); for ... } & removing all the other tfpath/targetpath clones, and replacing *targetpath.get() with just targetpath
[07:52:17] <zeuxcg> task::try is supposed to wait until all child tasks, right?
[07:52:38] <dbaupp> no idea
[07:52:46] <zeuxcg> it's synchronous so it should
[07:53:05] <dbaupp> I don't think so; I think it's designed to catch failures:
[07:53:26] <dbaupp> rusti: (std::task::try(|| { 1 }), rusti: std::task::try(|| { fail!() }))
[07:53:26] -rusti- <anon>:5:41: 5:42 error: expected one of `, )` but found `:`
[07:53:26] -rusti- <anon>:5          (std::task::try(|| { 1 }), rusti: std::task::try(|| { fail!() }))
[07:53:26] -rusti-                                                   ^
[07:53:27] -rusti- application terminated with error code 101
[07:53:32] <dbaupp> rusti: (std::task::try(|| { 1 }), std::task::try(|| { fail!() }))
[07:53:37] -rusti- pastebinned 6 lines of output: http://ix.io/7CZ
[07:53:56] <dbaupp> rusti: (std::task::try(|| { 1u }), std::task::try(|| { fail!(); }))
[07:53:59] -rusti- pastebinned 6 lines of output: http://ix.io/7D0
[07:53:59] <zeuxcg> well, yeah
[07:54:03] <zeuxcg> but if it does not wait
[07:54:07] <dbaupp> rusti: (std::task::try(|| { 1u }), std::task::try(|| { if true {fail!();} }))
[07:54:08] <zeuxcg> then it can't really catch failures :)
[07:54:08] -rusti- task <unnamed> failed at 'explicit failure', <anon>:5
[07:54:08] -rusti- (Ok(1), Err(()))
[07:54:18] <dbaupp> maybe
[07:54:22] <zeuxcg> because what could happen is that one of the child tasks would fail
[07:54:34] <zeuxcg> anyway, that's the closest thing to a wait I found in the docs
[07:54:35] <dbaupp> rusti: (std::task::try(|| { 1u }), std::task::try(|| { do spawn { fail!(); } }))
[07:54:37] -rusti- task <unnamed> failed at 'explicit failure', <anon>:5
[07:54:46] <zeuxcg> I could do it through other means, but that'd be longer
[07:54:58] <dbaupp> I'm fairly sure it doesn't wait ^
[07:55:18] <dbaupp> it just catches failures directly in the closure it spawns.
[07:56:05] <zeuxcg> but then runaway tasks with errors are possible
[07:56:08] <dbaupp> yes
[07:57:50] <zeuxcg> okay
[08:01:46] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[08:02:10] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[08:04:14] <bjz> rusti: struct A { priv x: () } sys::size_of::<A>()
[08:04:19] -rusti- pastebinned 11 lines of output: http://ix.io/7D1
[08:04:28] <bjz> rusti: struct A { priv x: () } std::sys::size_of::<A>()
[08:04:29] -rusti- 0
[08:04:41] <bjz> rusti: struct A { priv _: () } std::sys::size_of::<A>()
[08:04:41] -rusti- <anon>:5:25: 5:26 error: expected ident
[08:04:41] -rusti- <anon>:5          struct A { priv _: () } std::sys::size_of::<A>()
[08:04:41] -rusti-                                   ^
[08:04:41] -rusti- application terminated with error code 101
[08:05:02] <bjz> rusti: struct A { t: int, priv xxx: () } std::sys::size_of::<A>()
[08:05:03] -rusti- 8
[08:05:10] <bjz> rusti: struct A { t: i8, priv xxx: () } std::sys::size_of::<A>()
[08:05:11] -rusti- 1
[08:05:31] *** Quits: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:06:16] *** Joins: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de)
[08:06:27] <zeuxcg> rusti: fn foo(_: &[&str]) {} foo(["a" + "b"]);
[08:06:27] -rusti- <anon>:5:35: 5:46 error: mismatched types: expected `&[&str]` but found `[~str, .. 1]` (str storage differs: expected & but found ~)
[08:06:27] -rusti- <anon>:5          fn foo(_: &[&str]) {} foo(["a" + "b"]);
[08:06:27] -rusti-                                             ^~~~~~~~~~~
[08:06:27] -rusti- error: aborting due to previous error
[08:06:28] -rusti- application terminated with error code 101
[08:06:51] <zeuxcg> ah right, ~str does not coerce to &str inside arrays
[08:06:53] <dbaupp> vadimcn: ping
[08:07:07] *** Quits: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:07:09] <dbaupp> rusti: fn foo(_: &[&str]) {} foo([("a" + "b").as_slice()]);
[08:07:12] <vadimcn> dbaupp: hi
[08:07:13] -rusti- pastebinned 11 lines of output: http://ix.io/7D2
[08:07:24] <dbaupp> vadimcn: for https://github.com/mozilla/rust/issues/8811, what are the failure messages?
[08:07:34] <dbaupp> and similarly for https://github.com/mozilla/rust/issues/8810?
[08:08:11] <vadimcn> mostly they crash the process
[08:08:43] <zeuxcg> dbaupp: thanks for your help, I need to get some sleep now :)
[08:09:13] <dbaupp> vadimcn: ah, could you make a note of this in the issues so that someone knows what they're looking for? :)
[08:09:21] <dbaupp> zeuxcg: np
[08:09:22] <vadimcn> I'm creating these as FIXME items so I can mark them ignored and enable the rest of libstd unit tests 
[08:10:19] <dbaupp> vadimcn: right; it's just if they get fixed "accidentally", and so someone is trying to work out if the bug is resolved or not (in the future) they'll want to know what they're looking for
[08:10:56] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[08:11:01] <dbaupp> even just a line "makes the process segfault" to guide the triager
[08:11:47] <dbaupp> also, yay for libstd unit tests working! :)
[08:12:42] *** Joins: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de)
[08:12:54] <vadimcn> dbaupp: ok, I'll these update issues later
[08:13:23] <dbaupp> sure :)
[08:13:25] *** Joins: victorporof (victorporo@DA4ABEAF.1DE10CA8.D8E68FF6.IP)
[08:14:28] *** Quits: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:15:12] *** Joins: dwhyte (dwhyte@DFA0622C.2732CD06.B7FCEB19.IP)
[08:19:27] *** Quits: RMF (RMF@moz-3ADFD14C.dsl.telepac.pt) (Ping timeout)
[08:22:00] *** Joins: Ms2ger (Ms2ger@moz-982ABA97.adsl-dyn.isp.belgacom.be)
[08:23:45] *** Joins: RMF (RMF@A3A10308.EB26598F.8D19547B.IP)
[08:26:41] <dbaupp> acrichto: did your work do enough to close https://github.com/mozilla/rust/issues/2625 ?
[08:26:55] <acrichto> dbaupp: sadly no
[08:27:02] <acrichto> the interface I think still needs a redesign
[08:27:06] <acrichto> it's just implemented differently now
[08:27:08] <dbaupp> ah ok
[08:29:15] *** Joins: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com)
[08:29:25] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:29:37] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[08:30:38] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[08:30:38] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/gSBeMw
[08:30:38] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[08:30:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:30:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/03Epig
[08:30:39] <ghrust> 13rust/06auto 148557219 15Florian Hahn: Add tests for ref in closure parameter list, closes #5239
[08:30:39] <ghrust> 13rust/06auto 14e44269a 15bors: auto merge of #8800 : fhahn/rust/ticket_5239, r=alexcrichton...
[08:30:39] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:32:05] *** Joins: sk (sk@60A96C0.50B2D8C.78DD174B.IP)
[08:32:40] <acrichto> dbaupp: so I've been playing around with the idea of passing around "varargs" of formatting strings/their arguments
[08:32:44] <acrichto> how bad is this syntax: https://gist.github.com/alexcrichton/6363588
[08:32:52] <acrichto> or does it just make no sense at all?
[08:34:09] <dbaupp> acrichto: weird, but kinda cool too
[08:34:24] <dbaupp> it'd be neat if it worked with `do`, but that might be asking for too much
[08:34:26] <acrichto> I wanted it to be let args = format_args!(...) but I don't think that it can work
[08:34:31] <acrichto> do macro!() {} doesn't parse :(
[08:34:36] <dbaupp> :/
[08:34:44] <acrichto> rusti: do debug!() {}
[08:34:44] -rusti- <anon>:5:12: 5:22 error: `do` must be followed by a block call
[08:34:45] -rusti- <anon>:5          do debug!() {}
[08:34:45] -rusti-                      ^~~~~~~~~~
[08:34:45] -rusti- application terminated with error code 101
[08:34:59] <dbaupp> :( macros should be allowed anywhere!
[08:35:13] <acrichto> I don't like the syntax, but I'm not sure of a way to get around this
[08:35:32] <acrichto> when formatting an argument T you have to pass around &T, but that means you've got a lifetime and if you specify something liek an immediate it's a very short lifetime
[08:35:41] <dbaupp> in any case, I don't think it's that bad, especially since it'll mostly be used internally (hopefully)
[08:35:56] <acrichto> this actually may be widely uses
[08:35:58] <acrichto> used*
[08:36:08] <acrichto> it means you can make your own functions which takes printf-like things very easily
[08:36:28] <dbaupp> ah; but only `fmt` still things, right?
[08:36:31] <dbaupp> *style
[08:36:36] <acrichto> yeah
[08:36:47] <dbaupp> i.e it wouldn't work very well for strftime would it?
[08:36:52] <acrichto> basically the idea is that it gives you an opaque struct which is pre-validated at compile time
[08:37:09] <acrichto> you then pass this opaque struct to the `fmt` module (safely, no unsafe blocks) and get the output somehow
[08:37:37] <acrichto> this would reduce code bloat for some possible logging systems b/c you don't have to generate the call to fmt::write at the callsite
[08:37:43] <acrichto> you can push it way down into a library
[08:37:48] *** Quits: huseby (huseby@8F761026.B5EF4AF6.E96CA9D8.IP) (Quit: Leaving)
[08:37:52] <acrichto> you just need to generate this opaque struct at the callsite
[08:37:54] *** AutomatedTester|AFK is now known as AutomatedTester
[08:39:09] <dbaupp> right, so format_args!("whatever", logging::internal_logger) would work?
[08:39:16] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[08:39:23] <dbaupp> (i.e. it's not wedded to the closure?)
[08:39:23] <acrichto> not quite
[08:39:27] <acrichto> I would want that to work
[08:39:49] <dbaupp> how are you parsing the closure?
[08:39:51] <acrichto> but syntactically you have to know when to stop parsing arguments and when to start parsing an expression to pass a list to
[08:40:07] <acrichto> oh I'm not right now, it would be `if parser.token == token::BAR`
[08:40:13] <dbaupp> ah
[08:40:41] <dbaupp> format_args!(formatter, "string", args ...) ?
[08:40:52] <acrichto> hmm... maybe
[08:40:58] <acrichto> well the impetus for making it an argument is https://gist.github.com/alexcrichton/6363649
[08:41:07] <acrichto> that fails to compile b/c the lifetime of &1 is too short
[08:41:22] <dbaupp> yeah
[08:41:28] <dbaupp> #3511 iirc
[08:41:30] <acrichto> that gist is roughly what the format_args!() call would translate to if it were "let args = format_args!()"
[08:41:35] <acrichto> I'm not sure if that would actually fix it
[08:41:41] <dbaupp> (cool, I did rc)
[08:42:24] <acrichto> I don't want to have to wait for that though :P
[08:42:39] <acrichto> I was hoping to use this in a new logging system
[08:42:43] <dbaupp> I'd *almost* suggest just ignoring the bug and just coping with the limited functionality for now.
[08:42:45] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:42:55] <acrichto> just having some wonky syntax?
[08:42:56] *** Joins: gavinb (gavinb@EC4E8079.9A310DCD.E8FB17D0.IP)
[08:42:59] <dbaupp> maybe?
[08:43:01] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Connection reset by peer)
[08:43:03] <dbaupp> I don't know.
[08:43:11] <acrichto> it would be a bit easier if I required it to always be a function
[08:43:22] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:43:32] <acrichto> as in format_args!(fn, "string", args)
[08:43:33] <dbaupp> you could get around it now via `format_args!("string", (args, args, ...), formatter)`
[08:43:39] <acrichto> eew
[08:43:43] <dbaupp> haha
[08:44:01] <dbaupp> why does format_args!(fn, "string", args) require it to always be a fn?
[08:44:20] <acrichto> it would syntactically translate to "fn(opaque_struct)"
[08:44:29] <dbaupp> right
[08:44:34] <acrichto> oh wait that's terrible as well b/c it's only usable if you have one argument...
[08:44:47] <dbaupp> why can't it be a closure too?
[08:44:56] <acrichto> rusti: |a| { println!("{}", a) }(2)
[08:45:01] -rusti- pastebinned 13 lines of output: http://ix.io/7D3
[08:45:17] <acrichto> what
[08:45:26] <acrichto> rusti: (|a| { println!("{}", a) })(2)
[08:45:27] -rusti- 2
[08:45:27] -rusti- ()
[08:45:31] <acrichto> hmm...
[08:45:35] <acrichto> that could work
[08:45:38] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[08:45:47] <acrichto> format_args!(|args| { ... }, "string", arg1, arg2, ...)
[08:46:21] <acrichto> I'll give that a go
[08:46:30] <dbaupp> does that include format_args!(foo::bar, "string", ...) ?
[08:46:46] <acrichto> I'm going to make it so
[08:46:51] <acrichto> it'll start out with parse_expr()
[08:46:55] <acrichto> and then just to a expr_call() on that
[08:47:08] <acrichto> which should all just translate correctly
[08:49:31] <acrichto> one thing that's nice though is that instead of debug!() == __log() it'll change to debug!() == log!(lvl, ...) == if lvl <= __log_level() { ::std::logging::log(fmt, format_args!()) }
[08:49:37] <acrichto> or at least the moral equivalent
[08:49:50] <acrichto> 0 allocations per log
[08:50:16] <acrichto> also one less lang item
[08:50:20] <acrichto> and less trans 
[08:50:25] <acrichto> well trans code to maintain
[08:54:34] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Ping timeout)
[08:56:15] *** Quits: gavinb (gavinb@EC4E8079.9A310DCD.E8FB17D0.IP) (Quit: gavinb)
[08:56:36] *** Joins: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au)
[08:58:37] *** Joins: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr)
[09:00:50] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[09:03:41] <dbaupp> much nicer
[09:04:58] <sebcrozet> Hi. I have this error when I compile the last rust: 'Error running GYP'
[09:05:05] <dbaupp> acrichto: ^
[09:07:24] *** Joins: kumel (kumel@BD9B35B2.60E2620B.EBFADDB2.IP)
[09:07:54] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[09:08:12] *** Parts: kumel (kumel@BD9B35B2.60E2620B.EBFADDB2.IP) ()
[09:08:20] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[09:10:50] <acrichto> sebcrozet: oh dear, what os?
[09:11:02] <sebcrozet> acrichto: arch linux
[09:11:09] <acrichto> what's the error?
[09:12:00] <sebcrozet> acrichto: http://pastebin.com/Ez4F6wxF
[09:12:19] <acrichto> whoa
[09:12:36] <acrichto> that's an out of date or too recent version of python
[09:12:39] <acrichto> I forget which is which
[09:13:07] <klutzy> py3?
[09:13:40] <sebcrozet> klutzy: I have python 3.3.2
[09:14:16] <acrichto> sebcrozet: try this https://gist.github.com/alexcrichton/6363949
[09:14:39] <Ms2ger> You'll need to get it to use python2
[09:14:46] <klutzy> sebcrozet: seems like the script is not py3 compatible
[09:15:00] <klutzy> print 'Error running GYP' <- especially this
[09:15:14] <klutzy> in py3, print is function, so it needs ()
[09:15:21] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:16:09] <sebcrozet> echristo: I think it is working.
[09:16:38] <acrichto> sebcrozet: what's it building now?
[09:17:36] <sebcrozet> acrichto: it is building libextra.so on stage0 now. So I think the libuv thing is done.
[09:18:10] <acrichto> awesome!
[09:18:39] <acrichto> sebcrozet: https://github.com/mozilla/rust/pull/8821
[09:18:49] <acrichto> thanks for reporting :)
[09:19:34] <sebcrozet> acrichto: thanks for fixing :)
[09:20:41] *** Quits: bjz (brendanzab@AE0B7388.B8C2BBC3.F4A11E52.IP) (Quit: Bye!)
[09:20:50] *** Joins: bjz (brendanzab@AE0B7388.B8C2BBC3.F4A11E52.IP)
[09:21:30] <acrichto> dbaupp: https://gist.github.com/alexcrichton/6364023
[09:21:45] <acrichto> dbaupp: it works!, and it doesn't look as godawful as I thought it would
[09:21:58] <acrichto> anyway it's 2:30am so I'm going to sleep now
[09:23:27] *** Quits: napoleon (Mibbit@moz-9771C41D.e165.xgate.co.kr) (Quit: http://www.mibbit.com ajax IRC Client)
[09:24:09] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[09:25:38] *** kimundi is now known as zz_kimundi
[09:27:39] <lucian> hmm, i'm getting "error: value may contain borrowed pointers", but i'm having a hard time reproducing in a smaller sample
[09:29:08] <lucian> so here https://github.com/lucian1900/persistent/blob/master/persistent.rs#L41 getting https://gist.github.com/lucian1900/6364095
[09:29:30] <lucian> ugh, line 24 in the first link
[09:31:38] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[09:31:50] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[09:32:03] *** Joins: ghaering (Mibbit@FF4EA6DF.7ACB71E6.8630996.IP)
[09:33:16] *** Quits: smvv (smvv@moz-A397289C.xlshosting.net) (Ping timeout)
[09:33:54] *** Quits: mmmonk (mmmonk@moz-F145F0FF.xlshosting.net) (Ping timeout)
[09:34:10] *** Joins: Florob (Florob@moz-39532932.de)
[09:34:49] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Quit: Ex-Chat)
[09:35:08] <sebcrozet> lucian: I think you have to add the 'static bound to T
[09:35:34] <lucian> sebcrozet: the one in the new method?
[09:36:24] <sebcrozet> lucian: impl<T: 'static + Eq> you neet that every time your Note<T> is put on an @-box.
[09:36:40] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[09:37:21] <lucian> hmm. but isn't that the statically allocated memory bound? this will get allocated at runtime all the time
[09:37:36] <dbaupp> acrichto: awesome!
[09:38:17] *** Joins: smvv (smvv@moz-A397289C.xlshosting.net)
[09:39:00] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[09:39:06] *** Joins: mmmonk (mmmonk@moz-F145F0FF.xlshosting.net)
[09:39:21] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[09:39:32] <sebcrozet> lucian: I dont think so. In http://static.rust-lang.org/doc/tutorial.html it says that 'static is to tell the compiler your data does not contain borrowed pointers.
[09:40:13] <dbaupp> sebcrozet: (it can contains &'static borrowed pointers)
[09:40:49] *** Quits: mmmonk (mmmonk@moz-F145F0FF.xlshosting.net) (Ping timeout)
[09:40:50] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:40:50] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e44269a to 1478c5f97: 02http://git.io/N3iJvQ
[09:40:50] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:40:52] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:40:52] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/mL1EVQ
[09:40:52] <ghrust> 13rust/06auto 1466a07b0 15Alex Crichton: Run gyp_uv with CFG_PYTHON instead of directly...
[09:40:52] <ghrust> 13rust/06auto 14592747a 15bors: auto merge of #8821 : alexcrichton/rust/fix-libuv-build, r=huonw...
[09:40:53] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:40:55] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } static foo: &'static str = &"foo"; test_static(foo)
[09:40:55] -rusti- ok
[09:40:56] -rusti- ()
[09:41:02] <sebcrozet> dbaupp: oh, yes.
[09:41:06] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(&x)
[09:41:06] -rusti- <anon>:5:71: 5:82 error: instantiating a type parameter with an incompatible type `&int`, which does not fulfill `'static`
[09:41:06] -rusti- <anon>:5          fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(&x)
[09:41:07] -rusti-                                                                                 ^~~~~~~~~~~
[09:41:07] -rusti- error: aborting due to previous error
[09:41:08] -rusti- application terminated with error code 101
[09:41:08] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[09:41:11] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(x)
[09:41:12] -rusti- ok
[09:41:12] -rusti- ()
[09:41:16] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(@x)
[09:41:17] -rusti- ok
[09:41:17] -rusti- ()
[09:41:21] <lucian> sebcrozet: hmm, that's confusing :( thanks, i'll give it a try
[09:41:25] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(~x)
[09:41:26] -rusti- ok
[09:41:26] -rusti- ()
[09:41:40] <dbaupp> rusti: fn test_static<T: 'static>(_: T) { println("ok") } let x = 1; test_static(@mut x)
[09:41:40] -rusti- ok
[09:41:41] -rusti- ()
[09:44:18] *** Joins: mmmonk (mmmonk@moz-F145F0FF.xlshosting.net)
[09:45:11] <lucian> sebcrozet: that does indeed fix the compiler error
[09:45:26] *** Quits: inf-groupoid (user@580120F5.8ED93E28.1C8C8CE9.IP) (Quit: ERC Version 5.3 (IRC client for Emacs))
[09:45:56] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[09:46:01] <lucian> but i don't fully understand why. it acts like a trait in this case
[09:46:11] <lucian> looks like it should be Static or something
[09:49:08] <sebcrozet> lucian: yes having a lifetime acting as a trait confuses me too.
[09:49:41] <lucian> i would give up @ in this case potentially for the nodes
[09:49:50] <lucian> it's only essential for the values in the nodes
[09:49:59] <lucian> but then the data structure is less useful
[09:50:13] <lucian> hmm, "trait Static: 'static {}" doesn't work
[09:50:35] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:52:52] <lucian> also, "ref" in patterns is confusing to me
[09:55:38] <sebcrozet> lucian: I think "ref something" instead of "&something" avoids ambiguity between "the pattern &something" and "I want to take a ref to the matched pattern"
[09:55:57] <lucian> yes, i realise. i just find it unfortunately confusing
[09:59:54] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[10:01:27] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:05:25] <fzzy> are rust's traits like interfaces in Go? do they differ somehow?
[10:05:34] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[10:06:06] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[10:06:35] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[10:08:15] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[10:08:23] <engla> they differ by traits must be explicitly impl'd
[10:08:38] <engla> also no type switches
[10:09:02] <fzzy> type switches?
[10:09:37] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Input/output error)
[10:09:48] <engla> the go feature
[10:12:51] <fzzy> oh you mean type assertions, something like `foo, ok := iface.(string)`?
[10:13:54] <engla> yes
[10:15:07] <engla> traits are like interfaces in other languages, but don't share Go's peculiar features
[10:15:17] <engla> I mean those features mostly unique to go
[10:17:55] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[10:20:35] <bjz> how does rust know to grow the stack segments?
[10:23:55] <nmatsakis> tikue: I'm not sure if there is an issue around Enum.len
[10:24:26] <nmatsakis> bjz: there is a header inserted on entry to every Rust fn to check that adequate stack spcae is avail
[10:24:59] <bjz> nmatsakis: what do you mean by "header"?
[10:25:08] <nmatsakis> bjz: I mean a little bit of code
[10:25:15] <bjz> cool
[10:25:16] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[10:25:31] <nmatsakis> bjz: that grabs stack limit from a thread-local register, compares current stack pointer, and possibly calls morstack
[10:25:35] <nmatsakis> *morestack
[10:27:17] <bjz> nmatsakis: so the header checks the space in the parent stack?
[10:31:22] *** flaper87 is now known as flaper87|afk
[10:31:37] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[10:35:12] <dbaupp> bjz: every function starts with https://gist.github.com/huonw/c56b9e90dc87ba0c6f76
[10:35:28] <dbaupp> (or something like that)
[10:36:50] <dbaupp> bjz: so the `cmpq` is the compare, and the `ja` skips the __morestack callq if there's enough space
[10:40:42] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[10:40:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14592747a to 1478c5f97: 02http://git.io/N3iJvQ
[10:40:42] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[10:40:44] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[10:40:44] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/OibKtg
[10:40:44] <ghrust> 13rust/06auto 1466a07b0 15Alex Crichton: Run gyp_uv with CFG_PYTHON instead of directly...
[10:40:44] <ghrust> 13rust/06auto 149bfdd42 15bors: auto merge of #8821 : alexcrichton/rust/fix-libuv-build, r=huonw...
[10:40:45] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[10:44:02] * dbaupp hopes that the segfault last time was spurious
[10:44:33] *** flaper87|afk is now known as flaper87
[10:45:12] <dbaupp> nmatsakis: ping
[10:49:54] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:51:34] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[10:52:46] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[10:59:18] <nmatsakis> dbaupp: pong
[10:59:45] <nmatsakis> bjz: sorry, missed that, yes header checks for space in the current stack segment.
[11:00:50] *** Quits: ghaering (Mibbit@FF4EA6DF.7ACB71E6.8630996.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:01:09] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[11:04:48] <dbaupp> nmatsakis: do you happen to remember what this issue was about https://github.com/mozilla/rust/issues/3366?
[11:04:59] <dbaupp> (I closed it preemptively)
[11:05:49] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[11:06:10] <nmatsakis> dbaupp: I think the message ought to say `instantiating type parameter T` rather than "a type parameter"
[11:06:45] <nmatsakis> if there are several, it can be helpful
[11:06:58] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[11:07:04] <leonvv> How can you retrieve a ~str from a &str, is this possible?
[11:07:15] <nmatsakis> dbaupp: but honestly you can probably just leave it closed
[11:07:38] <dbaupp> leonvv: .to_owned()
[11:07:39] <nmatsakis> leonvv: that is not possible. not all `&str` have a corresponding `~str` -- you can borrow strings from other places besides the exchange heap
[11:07:53] <nmatsakis> leonvv: however, to_owned() will create a new `~str` (as dbaupp pointed out)
[11:07:57] <Ms2ger> Not possible without copying
[11:08:14] <dbaupp> nmatsakis: ok, I'll leave it closed then
[11:08:14] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[11:08:43] <leonvv> .to_owned() worked, thanks all!
[11:08:49] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[11:11:54] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[11:19:21] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[11:19:54] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[11:21:24] *** Joins: Aszarsha (Aszarsha@moz-16BFBC53.rev.numericable.fr)
[11:22:41] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[11:26:59] *** zz_kimundi is now known as kimundi
[11:30:10] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[11:32:29] <k4nar> hi guys
[11:32:42] *** Quits: z0w0 (zack@moz-7E6DC3A.lnse2.woo.bigpond.net.au) (Client exited)
[11:32:43] <k4nar> does anyone work on a C++ FFI ?
[11:33:27] <cmr> k4nar: doomlord is/was working on an extremely limited one that requires changing or limiting the C++ source, but other than that no
[11:33:32] <cmr> https://github.com/mozilla/rust/issues/5853
[11:33:44] <k4nar> ok, thanks
[11:38:17] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[11:43:03] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[11:43:36] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[11:44:33] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[11:45:41] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:45:41] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/OibKtg
[11:45:41] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[11:53:43] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[11:55:50] *** AutomatedTester is now known as AutomatedTester|AFK
[11:58:03] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:58:33] *** flaper87 is now known as flaper87|afk
[12:02:13] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[12:02:43] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[12:03:01] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[12:04:16] *** kimundi is now known as zz_kimundi
[12:07:02] *** flaper87|afk is now known as flaper87
[12:15:38] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[12:15:38] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/jdBB-Q
[12:15:38] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:15:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:15:42] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/x1M7yw
[12:15:42] <ghrust> 13rust/06auto 14eaa5658 15klutzy: rustc: Use "main" entry point on Windows...
[12:15:42] <ghrust> 13rust/06auto 14f9f01a8 15bors: auto merge of #8806 : klutzy/rust/winmain, r=cmr...
[12:15:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:16:41] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:18:56] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[12:18:56] <ghrust> 01[13rust01] 15cmr merged 06master into 06snap-stage3: 02http://git.io/kKFRLA
[12:18:56] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[12:20:04] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[12:23:18] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[12:24:37] *** zz_kimundi is now known as kimundi
[12:26:19] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[12:29:48] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[12:30:09] *** Joins: inf-groupoid (user@580120F5.8ED93E28.1C8C8CE9.IP)
[12:31:42] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[12:38:40] *** Joins: fyolnish (fyolnish@moz-7FFDE6BE.uqwimax.jp)
[12:39:20] *** Quits: Liothen (liothen@moz-80EF0CD7.spkn.qwest.net) (Quit: Textual IRC Client: www.textualapp.com)
[12:41:35] <doomlord> k4nar https://github.com/dobkeratops/cpp2rust
[12:41:57] <k4nar> thanks
[12:41:58] <doomlord> very limited, i hasten to add, and probably requires manually correcting output
[12:42:14] <doomlord> i didn't try to adress overloading, which defeats it of course..
[12:42:43] <dbaupp> cmr: any particular cool new feature driving the snap? (or just because snaps are cool?)
[12:42:44] <doomlord> ... but i think you could spit out boilerplate based on double-dispatch with traits that emulates overloading?
[12:42:53] <cmr> dbaupp: format!
[12:43:03] <dbaupp> cmr: ooh, in the stdlib, you mean?
[12:43:14] <cmr> dbaupp: yeah
[12:43:33] <cmr> when running tidy I saw a note about format needing a snapshot
[12:43:40] <dbaupp> fwiw, I think we should let it stabilise a little more before using it because that makes snapping annoying
[12:44:01] <cmr> I don't plan on actually porting stuff to it
[12:44:02] <doomlord> k4nar i figure i can re-work my own C++ sources within the limits of my tool. it does let me have a rust view of C++ data with collection classes, and use similar calling syntax.
[12:44:09] <dbaupp> (well, actually I don't know how stable it currently is; but we should wait until it's set in concrete, etc.)
[12:44:22] * dbaupp thinks we might be waiting forever with that criterion
[12:46:26] <k4nar> doomlord: do you think it would be conseivable to make a Qt binding in Rust with http://techbase.kde.org/Development/Languages/Smoke and your tool ?
[12:46:46] <k4nar> it would be so cool
[12:46:50] <cmr> k4nar: you don't need that tool to use smoke
[12:46:51] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[12:46:59] <cmr> smoke is pure C
[12:47:18] <k4nar> cmr: oh, ok, I just looked quickly
[12:47:51] <k4nar> well, I'll try to do that maybe when I have some time
[12:48:17] <dbaupp> k4nar: just in case you didn't know about it: https://github.com/crabtw/rust-bindgen
[12:48:49] <k4nar> thank you
[12:56:17] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[12:56:51] *** Joins: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com)
[12:57:08] <Seldaek> bstrie: if you like to know how hard regions & stuff are to understand, you can try to explain it to me :p
[12:57:20] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[12:57:29] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[12:57:42] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[13:01:39] *** Quits: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP) (Ping timeout)
[13:01:44] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[13:02:39] <doomlord> k4nar - i thinkn qt bindings or *any* existing c++ library would be very hard
[13:02:50] <doomlord> i dont think major C++ libaries restrict themselves to a subset :)
[13:03:13] <k4nar> yes, I don't it's possible that way
[13:03:24] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[13:03:29] <k4nar> but with Smoke it doesn't seem that hard
[13:03:56] <k4nar> I guess it's worth a try
[13:04:07] <doomlord> another option people mention is swig, which can generate C wrappers for C++
[13:04:16] *** AutomatedTester|AFK is now known as AutomatedTester
[13:04:27] <doomlord> if you can get C wrappers, then you can use the more common rust bindgen tool
[13:04:55] *** Quits: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de) (Ping timeout)
[13:05:44] <doomlord> i've split my attention a bit so haven't been updating that in a while.
[13:05:56] <doomlord> (^haven't been updating cpp2rust)
[13:05:59] <kimundi> doomlord: Do you think the paragraphs I added 
[13:06:06] <doomlord> ah lets look
[13:06:08] <kimundi> whoops
[13:07:34] <tiffany> is there a way to get an error any more specific than task <unnamed> failed at 'index out of bounds: the len is 0 but the index is 0', frscript.rc:1
[13:08:07] <dbaupp> rusti: (~[1])[10]
[13:08:07] -rusti- task <unnamed> failed at 'index out of bounds: the len is 1 but the index is 10', <anon>:5
[13:08:07] -rusti- application terminated with error code 101
[13:08:29] <dbaupp> tiffany: compile without optimisatiosn
[13:08:45] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[13:08:50] <dbaupp> the bad error location is possibly because things are getting inlined.
[13:08:58] <tiffany> tried that, didn't work
[13:09:02] <dbaupp> oh :(
[13:09:16] <tiffany> oh wait
[13:09:35] <dbaupp> you can break on rust_begin_unwind in gdb to get a stack trace of the location (I think it works for array-out-of-bounds errors)
[13:09:40] <tiffany> oh, recompiling its dependency didn't work either
[13:09:48] <kimundi> doomlord:  anyway, I added a few paragraphs for makeing crate relative use paths and files more clear
[13:11:03] <dbaupp> tiffany: the other option is to put printfln!'s before every array[index]
[13:11:19] <tiffany> I think I found the problem
[13:14:46] <kimundi> doomlord: The docs are already merged and readable on rust-lang.org, but do you think its clear enough?
[13:15:05] *** Joins: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de)
[13:16:07] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Connection reset by peer)
[13:16:19] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[13:19:50] <dbaupp> mac is segfaulting in pretty: http://buildbot.rust-lang.org/builders/auto-mac-64-opt/builds/1152/steps/test/logs/stdio :(
[13:20:07] <doomlord> (sorry my laptop just shutdown :) )i  see minimal example, (crate)
[13:20:39] <dbaupp> and that pr is windows-only https://github.com/mozilla/rust/pull/8806
[13:20:42] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[13:20:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f9f01a8 to 149bfdd42: 02http://git.io/N3iJvQ
[13:20:42] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[13:20:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[13:20:43] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/tYrMtw
[13:20:43] <ghrust> 13rust/06auto 1414cdc26 15Corey Richardson: src/test/bench: restructure
[13:20:43] <ghrust> 13rust/06auto 148a07f57 15Corey Richardson: Teach compiletest to use multiple --src-base's
[13:20:44] <ghrust> 13rust/06auto 1443f851d 15Corey Richardson: Teach the makefile to use multiple src-base's
[13:20:46] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[13:26:04] <kimundi> doomlord: I added a a.rs, b.rs, c.rs nested module example under 'importing names', and added a few more 'use paths are crate relative' in general ;)
[13:26:11] <doomlord> ah great
[13:28:12] <dbaupp> https://github.com/mozilla/rust/pull/8823 r?
[13:31:30] <flaper87> bblum: ping when you're around :)
[13:33:35] * dbaupp isn't quite sure how he ended up having a branch called "6233" that fixes #7335 :/
[13:34:25] <nsf> dbaupp: what's in #6233?
[13:34:31] <nsf> maybe a dup issue
[13:34:42] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[13:35:00] <dbaupp> nsf: nah; i *think* it was just an issue i had open in another tab, and so i got the numbers mixed up
[13:35:12] <nsf> :D
[13:35:20] * dbaupp is bad at copy-paste
[13:40:42] *** Joins: jviereck1 (Adium@moz-418862B2.dip0.t-ipconnect.de)
[13:40:56] *** Quits: jviereck (Adium@moz-918782F3.dip0.t-ipconnect.de) (Ping timeout)
[13:41:17] <bjz> nmatsakis dbaupp: heh I have somebody who has created a task based concurrency system for C++11
[13:41:46] <engla> dbaupp: do you think rust test tasks can be 1 by default?
[13:41:46] <bjz> he was just curious about the stack sizes
[13:42:01] <bjz> nmatsakis dbaupp: "I like having deterministic memory usage. I preallocate 1000 tasks with some given stack size: i exactly know what the total memory usage is going to be."
[13:42:24] *** AutomatedTester is now known as AutomatedTester|AFK
[13:42:32] <bjz> "that means that I preallocate a number of tasks and when I'm done with a task I dont delete it but put it back"
[13:42:55] *** Joins: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net)
[13:43:38] <bjz> nmatsakis dbaupp: basically he wants to avoid allocation. how does Rust handle this?
[13:45:15] *** Joins: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP)
[13:48:08] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[13:49:44] *** Quits: dew (Instantbir@moz-D2FA52B6.static.stls.mo.charter.com) (Ping timeout)
[13:50:19] *** kimundi is now known as zz_kimundi
[13:51:49] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[13:51:54] *** Joins: Florob (Florob@moz-39532932.de)
[13:53:22] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:00:26] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[14:02:04] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[14:04:39] <tiffany> waht module is range from?
[14:08:28] <Ms2ger> Should be in the prelude
[14:10:28] *** Joins: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP)
[14:10:35] <bjz> tiffany: pretty sure it's in iter
[14:13:33] <engla> it's in std::iterator
[14:13:40] <tiffany> parse.rs:188:12: 188:16 error: wrong number of type arguments: expected 2 but found 0
[14:13:41] <tiffany> parse.rs:188 impl<'self> Mul for Pattern<'self> {
[14:13:43] <tiffany> what does that mean?
[14:13:50] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[14:15:18] *** Quits: fread2281 (zcarterc@moz-CB181B42.dia.static.qwest.net) (Ping timeout)
[14:16:26] <sebcrozet> tiffany: Mul needs two types parameters.
[14:16:49] <sebcrozet> tiffany: impl<'self> Mul<Pattern<'self>, Pattern<'self>> for Pattern<'self> {
[14:18:09] <sebcrozet> tiffany: the first parameter is the type of the object you multiply Self to, and the second is the type of the multiplication result.
[14:21:07] *** Quits: Mindless` (mindless@moz-9C38D3B4.net) (Ping timeout)
[14:21:21] <tiffany> uhh...
[14:21:39] <tiffany> I keep getting errors with mul() not having the right type now
[14:22:37] *** Joins: Mindless` (mindless@moz-9C38D3B4.net)
[14:23:27] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[14:23:43] *** sam113101 is now known as sam113101_afk
[14:24:38] <pnkfelix> hmm, I'm getting uv linkage problems on OS X builds of master.
[14:25:01] <pnkfelix> (but maybe I was playing fast and loose with the uv submodule.  Will clear that out and retry)
[14:25:33] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[14:25:44] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:25:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14dc3296a to 149bfdd42: 02http://git.io/N3iJvQ
[14:25:44] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:25:45] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:25:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/SlTrPg
[14:25:45] <ghrust> 13rust/06auto 14eaa5658 15klutzy: rustc: Use "main" entry point on Windows...
[14:25:45] <ghrust> 13rust/06auto 149708ef0 15bors: auto merge of #8806 : klutzy/rust/winmain, r=cmr...
[14:25:46] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:28:21] <sebcrozet> tiffany: can I see the erroneous code?
[14:28:42] <tiffany> the whole file or just the impl I'm trying to make?
[14:29:42] <sebcrozet> tiffany: the whole file.
[14:29:54] <tiffany> http://pastebin.com/u57YbY55
[14:30:37] *** Joins: alex_abreu (alex@moz-7421D6C9.mc.videotron.ca)
[14:31:34] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[14:31:39] *** Joins: fread2281 (zcarterc@moz-CB181B42.dia.static.qwest.net)
[14:31:42] *** Quits: jaen (jaen@moz-1485333B.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:32:14] <engla> tiffany: the type should be Pattern<'self>, not Pattern
[14:32:28] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Ping timeout)
[14:32:46] <tiffany> I tried that among other things already 
[14:34:04] *** Joins: sanxiyn (tinuviel@AE8B10D7.A92E374.57C4C441.IP)
[14:34:48] <tiffany> oh, I forgot about the return type
[14:35:28] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[14:36:10] <sebcrozet> tiffany: I am not sure, but I dont think you can make this work.
[14:37:29] <sebcrozet> tiffany: Because it would imply that all the 'self lifetimes are the same, which cannot be true.
[14:40:51] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:41:00] *** Quits: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com) (Quit: threecreepio)
[14:43:03] <tiffany> is there no way at all to implement a shorthand syntax for this then?
[14:47:25] <sebcrozet> tiffany: I dont understand lifetimes well enough to be sure; but I dont think so.
[14:47:50] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:49:01] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Ping timeout)
[14:51:43] <maik> is Result a Monad?
[14:52:59] <engla> there is no Monad trait and no real way to express it
[14:53:06] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[14:53:07] <Aetherspawn_BNC> Well, that's easy.
[14:53:14] <Aetherspawn_BNC> Does it look like a box to you?
[14:53:31] <engla> maik: it could be, just like Either a is a monad in haskell
[14:53:47] *** Joins: eholk (eholk@moz-F70D5031.hsd1.in.comcast.net)
[14:53:54] <Aetherspawn_BNC> `Maybe a` is probably a better example
[14:54:06] <Aetherspawn_BNC> (since I think that's what Result is?)
[14:54:20] <engla> no, Result and Either have the same shape
[14:54:23] <maik> I don't know what monads are I am just asking because I saw something similar that looked a lot like our Result.
[14:54:47] <Aetherspawn_BNC> Hehe, what do I know. I haven't gotten around to learning rust yet :P
[14:54:56] <engla> Aetherspawn_BNC: Maybe a is Option<T>
[14:55:18] *** sam113101_afk is now known as sam113101
[14:56:33] <engla> maik: the monadic operations are there for you.   unit is   x -> Ok(x);  bind is   Result<T, E> -> (fn(T) -> Result<U, E>) -> Result<U, E>   and that's the .chain() method
[14:58:10] <pnkfelix> acrichto: ping
[14:58:35] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[15:01:06] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[15:03:03] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[15:06:59] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[15:08:03] *** Quits: Ralith (ralith@114DA04D.CD83ED0A.BCDF04A6.IP) (Ping timeout)
[15:15:57] <olsonjeffery> acrichto: \o/
[15:16:48] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:23:40] <olsonjeffery> now for *another* probably ugly rebase ;)
[15:23:58] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:25:04] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[15:27:09] *** Quits: jviereck1 (Adium@moz-418862B2.dip0.t-ipconnect.de) (Quit: Leaving.)
[15:27:20] *** Joins: threecreepio (jdp@moz-71E164C9.cust.bredbandsbolaget.se)
[15:28:50] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[15:30:47] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[15:30:47] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SlTrPg
[15:30:47] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[15:31:04] <tiffany> I am really having a bad time writing this parser combinator library in rust so far
[15:31:26] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[15:34:56] <bstrie> tiffany: :(
[15:35:14] <bblum> flaper87: yes?
[15:35:22] <tiffany> I think I'm going to replace everywhere I use &Pattern in my pattern enum with ~str and use a hash table to look up rules
[15:36:28] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[15:36:51] <tiffany> the main things that make this significantly more painful than lpeg is that rules are ugly to define, you can't have recursive rules, and there isn't really a way to pass a grammar around
[15:37:09] <tiffany> lpeg is what I primarily based it on, having just used it to write a simple language a few days ago
[15:38:03] *** Quits: cowboyd (cowboyd@1D8844A7.1B729417.CEE440B6.IP) (Client exited)
[15:39:43] *** Quits: eholk (eholk@moz-F70D5031.hsd1.in.comcast.net) (Quit: eholk)
[15:40:24] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[15:43:05] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:44:23] <engla> tiffany: did you write the enum converter thing with lpeg?
[15:44:32] <tiffany> enum converter thing?
[15:44:51] <tiffany> oh, the thing on the subreddit, no
[15:44:57] <engla> yeah that ok.
[15:45:07] <tiffany> I'm currently reimplementing https://github.com/tiffany352/frscript in rust
[15:45:07] <engla> I saw that and I thought lpeg would be nice for Rust too
[15:45:23] <tiffany> and in order to do that I need some way to parse the language, so I'm writing a parser combinator library
[15:46:13] <bstrie> engla: nsf wrote that
[15:46:56] <nsf> engla: lpeg would be nice indeed
[15:47:11] <nsf> well, peg, lpeg stands for lua peg :)
[15:47:22] <nsf> rpeg :D
[15:47:24] <bstrie> rlpeg
[15:47:26] <bstrie> rust lua peg
[15:47:31] <maik> :D
[15:47:52] <maik> real life peg
[15:48:29] <bstrie> rogue like peg
[15:48:54] <engla> tiffany: you're writing a recursive datastructure using borrowed pointers. not sure how to do that and remain sane myself
[15:50:34] <tiffany> stack allocating them kind of sort of works
[15:50:41] <tiffany> you just can't have recursive rules
[15:51:11] <tiffany> and every rule must be individually named or you get lifetime errors
[15:51:47] <tiffany> like, let minus_sign = Literal("-"); let digit = Range('0','9'); let digits = More(digit); let number = Seq(~[minus_sign, digits]);
[15:53:17] *** Quits: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving)
[15:54:03] <jack> is it a known issue that rust build runs llvm configure which runs llvm/projects/sample configure?
[15:54:04] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[15:54:11] <jack> is there some reason to configure/build the samples?
[15:54:42] <bstrie> jack: never heard of such a thing
[15:55:04] <bstrie> almost certainly not?
[15:55:09] <jack> does rust somehow disable that normally, and it's gotten re-enabled in servo somehow?
[15:55:38] <bstrie> I've never delved into the build system enough to know
[15:57:07] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Ping timeout)
[15:59:02] <jack> hmm. straight rust head configures projects/sample too
[15:59:37] <bstrie> but are we actually building them?
[15:59:54] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:00:00] <bstrie> didn't see any artifacts in the llvm example directories
[16:00:34] <jack> maybe not. unfortunately the build failure i'm getting is during the configure step
[16:01:58] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[16:02:28] <bstrie> ah, thought this was just a perf thing...
[16:04:01] *** Joins: jclements (jclements@moz-62D9F423.wireless.calpoly.edu)
[16:05:30] <acrichto> pnkfelix: pong
[16:05:59] <maik> haha had you ever wrote something that was over 5k lines of code but you somewhat felt it was't right and you revisited you code. After 10 times revisiting your code you just ended up with 50 lines of code? :D
[16:06:24] <pnkfelix> acrichto: I've been having problems building the head on OS X.  It appears to have been injected by 9bfdd42703603f04681
[16:06:41] <pnkfelix> acrichto: i.e. alexcrichton/rust/fix-libuv-build
[16:06:59] <pnkfelix> acrichto: a bunch of link errors of the form:   "_uv_write", referenced from:
[16:06:59] <pnkfelix>       _rust_uv_write in rust_uv.o
[16:06:59] <pnkfelix>      (maybe you meant: _rust_uv_write)
[16:07:03] <acrichto> that's odd, it was supposed to fix the problems
[16:07:19] <acrichto> whoa 
[16:07:22] <acrichto> on which linking step?
[16:07:23] <pnkfelix> acrichto: starting off with ld: warning: ignoring file rt/x86_64-apple-darwin/stage0/libuv/libuv.a, file was built for archive which is not the architecture being linked (x86_64): rt/x86_64-apple-darwin/stage0/libuv/libuv.a
[16:07:37] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[16:07:37] *** ChanServ sets mode: +o tjc
[16:07:53] <acrichto> pnkfelix: and you're sure that it worked before that commit?
[16:07:56] <pnkfelix> acrichto: yeah
[16:08:15] <pnkfelix> acrichto: I switched up to the preceding bors merge commit ,and that built fine
[16:08:24] <maik> with Port, is it possible to always receive the last message? 
[16:08:46] <pnkfelix> acrichto: I haven't had time to look carefully at the problem yet.  I mostly wanted to ask you about the dialog you had with graydon et al on the ticket
[16:08:49] <acrichto> pnkfelix: could you drop a pastebin of the make output?
[16:09:00] <pnkfelix> acrichto: namely, what is the thing about "can you run xcodebuild -license" ?
[16:09:31] <acrichto> pnkfelix: when libuv got updated, its build system changed, and now it uses this gyp program externally to generate makefiles
[16:09:53] <acrichto> apparently gyp required you to accept the xcode license b/c it ran some xcode command, but it generates only makefiles
[16:10:17] <pnkfelix> acrichto: gist of the build transcript  : https://gist.github.com/pnkfelix/6367843
[16:11:14] <acrichto> pnkfelix: try disabling ccache
[16:11:26] <pnkfelix> acrichto: hmm, okay.
[16:11:41] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[16:12:04] *** Quits: sanxiyn (tinuviel@AE8B10D7.A92E374.57C4C441.IP) (Quit: Bye)
[16:12:26] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:12:55] *** dumitru is now known as dns
[16:13:03] *** dns is now known as dumitru
[16:17:38] <maik> hm
[16:18:12] <maik> if I want to recv only the latest message with a port, do I have to use the rt::comm? 
[16:20:45] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[16:21:17] <maik> that doesn't seem very flexible
[16:22:26] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:22:26] *** ChanServ sets mode: +o dherman
[16:24:15] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:24:19] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[16:24:39] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[16:26:27] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[16:27:29] *** Joins: Niessy (Mibbit@moz-E56CAA08.dsl.bell.ca)
[16:29:35] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Ping timeout)
[16:31:22] *** Joins: [squiddy] (squiddy@moz-34DADDC7.adsl.alicedsl.de)
[16:32:58] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[16:33:16] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:33:19] <Niessy> Hey guys how can I get this to compile? http://strcat.zapto.org:8000/
[16:33:35] <Niessy> If I remove Bar from Foo is works but is there a way to make it work without that?
[16:34:15] <maik> Niessy, you know that we can't see your code right :D?
[16:34:49] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[16:35:04] <Niessy> yeah I just realized
[16:35:07] <Niessy> I made a gist
[16:35:10] <Niessy> https://gist.github.com/Niessy/6368107
[16:35:35] <pnkfelix> acrichto: same problem with ccache disabled.
[16:36:12] <Niessy> ?
[16:36:27] <pnkfelix> acrichto: https://gist.github.com/pnkfelix/6368121
[16:36:34] <tjc> Niessy: can you paste the compile error you're getting, too?
[16:37:15] <sebcrozet> Niessy: you need to specify the lifetime for the impl: impl<'self> Foo<'self> {
[16:37:22] <acrichto> pnkfelix: let me try to reproduce locally
[16:37:28] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[16:37:56] <Niessy> foo.rs:12:5: 12:9 error: Illegal anonymous lifetime: anonymous lifetimes are not permitted here foo.rs:12 impl Foo {                ^~~~ error: aborting due to previous error
[16:38:05] <jorendorff> According to http://static.rust-lang.org/doc/tutorial-tasks.html#basics the third example should generate interleaved output
[16:38:15] <tjc> Niessy: Yeah, I think it's what sebcrozet said
[16:38:17] <jorendorff> but it doesn't - is there a way I can check that rust is using all my cores?
[16:38:55] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:39:06] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[16:39:21] <tjc> jorendorff: does changing the value of RUST_THREADS (environment variable) have any effect on the output?
[16:39:23] <maik> Niessy, yes you have to do impl <'self> Foo<'self> , I should probably add this to the tutorial
[16:39:27] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:39:33] <Niessy> ahh ok so I tried impl Foo<'self> but you need impl<'self> Foo<'self>
[16:39:36] <Niessy> yeah that works
[16:39:42] <acrichto> pnkfelix: what's the output of `file rt/x86_64-apple-darwin/stage0/libuv/libuv.a`
[16:40:00] <Niessy> thanks :D
[16:40:16] <pnkfelix> acrichto: rt/x86_64-apple-darwin/stage0/libuv/libuv.a: current ar archive random library
[16:40:16] <tjc> you're welcome!
[16:40:22] *** cade is now known as cade_away
[16:40:32] <jorendorff> tjc: if I set it to 8, there's no effect; if I set it to 80 I get "Abort trap: 6"
[16:40:42] <acrichto> pnkfelix: oh how about objdump -h, I'm curious what arch it was built as 
[16:40:52] <tjc> jorendorff: Hmm, so RUST_THREADS=2 ‚Ä¶ and RUST_THREADS=8 ‚Ä¶ produce exactly the same output?
[16:40:54] <pnkfelix> acrichto: (yeah I was thinking "that does not seem very helful..."))
[16:40:54] <tjc> that's curious
[16:41:20] <jorendorff> tjc: yes.
[16:41:23] <pnkfelix> acrichto: hmm, i don't have objdump in my path ...
[16:41:29] <Niessy> how come you need to have <'self> with the Impl that seems a bit verbose
[16:41:31] <acrichto> pnkfelix: gobjdump?
[16:41:35] <tjc> jorendorff: weird, I'll try running that example on my machine and see what happens
[16:41:37] <acrichto> pnkfelix: also you may be able to gdb it
[16:42:14] <tjc> Niessy: In more complicated scenarios, you might need more than one lifetime parameter, so declaring their names on the impl allows you to refer to them differently in the type
[16:43:12] <pnkfelix> acrichto: ah I think I need to use otool
[16:43:20] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[16:43:24] <tjc> jorendorff: Huh, I'm seeing the same results as you
[16:43:27] <acrichto> oh yeah I forgot about that
[16:43:40] <tjc> except that sometimes the order of 0 and 1 gets reversed
[16:43:42] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:44:06] <tjc> jorendorff: I can't think of anything -- you may want to ask brson when he gets in
[16:44:12] <jorendorff> thanks
[16:44:23] <tjc> maybe the scheduler is less random now
[16:46:27] <pnkfelix> acrichto: any idea which of otool's many options you could be interested in? I"ve tried a bunch but am not seeing any obvious indication of which arch it sees
[16:47:33] *** Quits: KindOne (KindOne@C93BC0E1.D40F8E6E.EC6A1518.IP) (Ping timeout)
[16:48:00] <pnkfelix> acrichto: I see "cputype" and "cpusubtype" columns in some of the output, but the entries are numeric, not self-describing text...
[16:48:18] <acrichto> pnkfelix: try "lipo -info"
[16:48:40] <pnkfelix> acrichto: aha: % lipo -info rt/x86_64-apple-darwin/stage0/libuv/libuv.a
[16:48:40] <pnkfelix> input file rt/x86_64-apple-darwin/stage0/libuv/libuv.a is not a fat file
[16:48:40] <pnkfelix> Non-fat file: rt/x86_64-apple-darwin/stage0/libuv/libuv.a is architecture: i386
[16:48:48] <pnkfelix> acrichto: That seems wrong.
[16:48:53] <acrichto> indeed
[16:49:06] <acrichto> can you remove the build directory for libuv and re-run with VERBOSE=1 ?
[16:49:12] <pnkfelix> acrichto: will do.
[16:50:16] <pnkfelix> acrichto: Is the build directory for libuv synonymous with "rt/" ?  Or should I be doing something more general (or more narrow) ?
[16:50:30] <acrichto> rt/$target/stage0/libuv should be sufficient
[16:51:30] <pnkfelix> acrichto: you sure you don't need me to re-run configure or anything?  (I've forgotten at what stage in the build process we run configure for clang and libuv ...)
[16:51:33] *** Joins: KindOne (KindOne@moz-4BE1FBCE.dynamic.ip.windstream.net)
[16:51:53] <acrichto> yeah I just wanna see how libuv is compiling its files
[16:52:44] <pnkfelix> acrichto: https://gist.github.com/pnkfelix/6368346
[16:52:56] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Ping timeout)
[16:53:20] <acrichto> -arch i386
[16:53:21] <acrichto> what
[16:53:38] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:54:32] *** Quits: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de) (Ping timeout)
[16:54:43] <olsonjeffery> ah, fresh loonix install
[16:54:51] <olsonjeffery> sadly, my attempt to update OSX crashed and burned
[16:54:58] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[16:55:28] <acrichto> pnkfelix: oooooh, so we're configuring gyp with target_arch=x86_64 and apparently gyp wants x64
[16:55:57] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[16:55:58] <olsonjeffery> *sad processor trombone*
[16:56:49] *** Quits: victorporof (victorporo@DA4ABEAF.1DE10CA8.D8E68FF6.IP) (Quit: victorporof)
[16:57:41] <acrichto> pnkfelix: is your gcc symlinked to something odd?
[16:58:02] <pnkfelix> acrichto: % which gcc 
[16:58:02] <pnkfelix> /usr/bin/gcc
[16:58:18] <pnkfelix> acrichto: % ls -l `which gcc`
[16:58:18] <pnkfelix> lrwxr-xr-x  1 root  wheel  12 Feb 12  2013 /usr/bin/gcc -> llvm-gcc-4.2
[16:58:22] <acrichto> huh, b/c my command line is also getting -arch i386 but it's producing x86_64 executables
[16:58:33] <acrichto> it's also compiling with -m64, but so is yours
[16:59:15] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (Ping timeout)
[16:59:28] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[16:59:30] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[16:59:39] <pnkfelix> acrichto: so, I see *a* place in gyp_uv where it converts 'x86_64' to 'x64' (in host_arch().  Can you point me to where we are passing in 'x86_64' instead of the 'x64' that you say gyp wants?
[17:00:01] <pnkfelix> acrichto: (i.e., is it somewhere in mk/rt.mk ?  Or...?)
[17:00:01] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[17:00:16] <acrichto> mk/rt.mk: 173
[17:00:21] <acrichto> line 173 that is
[17:00:31] <pnkfelix> acrichto: right, okay, the -Dtarget_arch then
[17:00:44] <jorendorff> I'm curious about the pipes -- are there any blocking (finite-buffer) versions?
[17:00:55] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:02:01] <pnkfelix> acrichto: too bad they haven't decoupled the normalization within host_arch() into a pure function separate from host_arch()...
[17:02:23] <acrichto> pnkfelix: yeah :(, this new build system for libuv is... interesting
[17:02:44] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[17:05:05] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[17:07:07] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[17:07:37] <pnkfelix> acrichto: gotta go.  I might be on later.  thanks for assisting.
[17:09:26] *** Quits: StarLight (StarLight@moz-3BE5D1FE.dynamic.avangarddsl.ru) (Connection reset by peer)
[17:09:55] <leonvv> Is there anyway to uppercase a string ?
[17:10:31] <tjc> leonvv: Yes, the standard library module std::str::ascii has those functions
[17:10:48] <leonvv> tjc: Okay, thanks!
[17:10:53] <tjc> you're welcome
[17:12:28] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[17:13:23] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[17:13:27] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[17:13:27] *** ChanServ sets mode: +o dherman
[17:13:36] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Connection reset by peer)
[17:13:42] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:13:56] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:14:40] *** Joins: StarLight (StarLight@moz-14932895.pppoe.avangarddsl.ru)
[17:14:58] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[17:16:14] *** Joins: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP)
[17:16:48] *** Joins: feduser (feduser@650B4444.AAE9A62C.650F25DA.IP)
[17:25:03] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[17:25:36] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[17:26:19] *** zz_kimundi is now known as kimundi
[17:27:14] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:29:41] <tjc> Just wrote some code that worked the first time I ran it
[17:29:48] <tjc> *scratches head* There must be *something* wrong here.
[17:30:04] *** Joins: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com)
[17:30:17] *** Quits: sgreenlay (sgreenlay@moz-E795FA5B.hsd1.wa.comcast.net) (Ping timeout)
[17:30:25] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[17:31:14] <jack> what hash does rust require for verifying the snapshot?
[17:31:25] <jack> and does rust require a specific version of pythong to do that check?
[17:31:28] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:31:28] *** ChanServ sets mode: +o pcwalton
[17:31:46] <tjc> jack: I assume it requires the hash in the snapshots.txt file
[17:31:54] *** Joins: sgreenlay (sgreenlay@moz-E795FA5B.hsd1.wa.comcast.net)
[17:32:12] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[17:32:17] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:32:28] *** Quits: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de) (Ping timeout)
[17:34:07] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[17:35:12] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[17:36:58] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[17:38:27] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[17:39:52] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[17:39:57] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[17:40:46] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[17:42:00] *** cade_away is now known as cade
[17:42:04] *** Joins: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de)
[17:43:30] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[17:44:51] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Quit: Ignore me!!)
[17:45:42] *** Joins: tikue_ (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net)
[17:48:27] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[17:48:41] *** Joins: jviereck1 (Adium@moz-418862B2.dip0.t-ipconnect.de)
[17:49:01] *** Quits: jviereck1 (Adium@moz-418862B2.dip0.t-ipconnect.de) (Max SendQ exceeded)
[17:49:10] <tikue_> do struct-like enums work yet?
[17:49:26] <tikue_> rusti: enum Foo { Bar { baz: uint } }
[17:49:27] -rusti- ()
[17:49:35] *** Quits: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de) (Ping timeout)
[17:49:49] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[17:49:52] <tikue_> rusti: enum Foo { Bar { baz: uint } } let foo = Bar { baz: 1 };
[17:49:53] -rusti- <anon>:5:44: 5:47 warning: unused variable: `foo` [-W unused-variable (default)]
[17:49:53] -rusti- <anon>:5          enum Foo { Bar { baz: uint } } let foo = Bar { baz: 1 };
[17:49:53] -rusti-                                                      ^~~
[17:49:53] -rusti- ()
[17:50:07] <tikue_> rusti: enum Foo { Bar { baz: uint } } let foo = Bar(1);
[17:50:08] -rusti- <anon>:5:50: 5:53 error: unresolved name `Bar`.
[17:50:08] -rusti- <anon>:5          enum Foo { Bar { baz: uint } } let foo = Bar(1);
[17:50:08] -rusti-                                                            ^~~
[17:50:08] -rusti- error: aborting due to previous error
[17:50:08] -rusti- application terminated with error code 101
[17:50:15] <tikue_> rusti: enum Foo { Bar { baz: uint } } let foo = Bar{1};
[17:50:15] -rusti- <anon>:5:53: 5:54 error: expected `;` but found `{`
[17:50:16] -rusti- <anon>:5          enum Foo { Bar { baz: uint } } let foo = Bar{1};
[17:50:16] -rusti-                                                               ^
[17:50:16] -rusti- application terminated with error code 101
[17:50:29] <sfackler> woah, i didn't know those existed
[17:50:58] <tikue_> rusti: enum Foo { Bar { baz: uint }, Barb(uint) }; let barb = Barb(1); let bar = Bar { baz: 1 };
[17:51:02] -rusti- pastebinned 7 lines of output: http://ix.io/7DB
[17:51:13] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:51:13] *** ChanServ sets mode: +o brson
[17:51:22] *** Joins: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[17:51:35] *** Quits: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Connection reset by peer)
[17:51:37] *** Quits: feduser (feduser@650B4444.AAE9A62C.650F25DA.IP) (Quit: Leaving)
[17:53:19] *** Joins: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de)
[17:53:36] *** Quits: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de) (Max SendQ exceeded)
[17:53:52] *** Quits: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP) (Ping timeout)
[17:53:53] *** Joins: Lovot (root@AE31FB56.8153C3BF.F3C9A2D9.IP)
[17:54:06] <olsonjeffery> acrichto: given all these libuv build issues on osx.. im glad i stayed on linux :)
[17:54:08] <olsonjeffery> fortune smiles
[17:54:15] <tikue_> https://gist.github.com/tikue/d1ab3d8bbc009bcfb1a6
[17:54:18] <tikue_> woops 
[17:54:20] <tikue_> wrong chan
[17:54:48] *** Joins: RayWizard (kvirc@E248DB08.9470356F.5B864609.IP)
[17:54:50] <brson> jorendorff: the statement about randomness in that tutorial is wrong. the new work stealing algorithm is much more deterministic, particularly in this simple test case
[17:54:59] *** Joins: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de)
[17:55:02] *** Quits: RayWizard (kvirc@E248DB08.9470356F.5B864609.IP) (Quit: KVIrc 4.1.3 Equilibrium http://www.kvirc.net/)
[17:55:10] <brson> jorendorff: i'll at least update that sentence
[17:56:05] <jorendorff> brson: thanks! i was also curious about whether a runaway process ever yields
[17:56:10] <tikue_> rusti: enum Foo { Bar, Baz(Bar) }
[17:56:10] -rusti- <anon>:5:29: 5:32 error: use of undeclared type name `Bar`
[17:56:11] -rusti- <anon>:5          enum Foo { Bar, Baz(Bar) }
[17:56:11] -rusti-                                       ^~~
[17:56:11] -rusti- error: aborting due to previous error
[17:56:11] -rusti- application terminated with error code 101
[17:56:27] <acrichto> olsonjeffery: the first issue was actually on arch linux
[17:56:57] *** Quits: jviereck (Adium@moz-418862B2.dip0.t-ipconnect.de) (Ping timeout)
[17:57:37] <brson> jorendorff: a task that infinite loops without ever sending messages or doing I/O or explicitly calling task::deschedule will not yield
[17:57:46] <jorendorff> but suppose it does send messages
[17:59:08] <jorendorff> i dunno, i have gotten some really weird results this morning but maybe it's all due to misuse
[17:59:44] <brson> jorendorff: it will yield, but depending on the workload it could still livelock or starve other tasks. it's a big weakness that we are currently using a strict work stealing algorithm a little incorrectly
[17:59:51] <brson> jorendorff: i'd be interested in your test cases
[18:00:43] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[18:00:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Zdhjsg
[18:00:43] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[18:00:43] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[18:00:43] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/mMyjpQ
[18:00:43] <ghrust> 13rust/06auto 14e3662b1 15Alex Crichton: Remove offset_inbounds for an unsafe offset function
[18:00:43] <ghrust> 13rust/06auto 1464ed372 15bors: auto merge of #8807 : alexcrichton/rust/remove-two-offsets, r=thestinger...
[18:00:44] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[18:00:50] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[18:01:09] <jorendorff> brson: well, https://gist.github.com/jorendorff/6369178
[18:02:32] <tikue_> rusti: enum Foo { Bar { id: uint }, Baz { id: uint } }; match Bar { id: 1 } { { id: ref id, _ } => id }
[18:02:34] -rusti- pastebinned 6 lines of output: http://ix.io/7DD
[18:02:54] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:02:55] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:03:57] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[18:03:57] *** ChanServ sets mode: +o dherman
[18:04:12] *** Quits: fabiand (fabiand@moz-FD30B0F9.adsl.alicedsl.de) (Quit: Verlassend)
[18:04:59] *** Joins: themgt (themgt@moz-F6F0180D.baf.movistar.cl)
[18:05:43] <brson> jorendorff: thanks! this is a good test of multiple problems with the current scheduler
[18:05:49] <jorendorff> yay
[18:06:01] <tikue_> rusti: enum Foo { Bar { id: uint }, Baz { id: uint } }; match Bar { id: 1 } { *{ id: ref id, _ } => id }
[18:06:01] -rusti- <anon>:5:80: 5:81 error: unexpected token: `*`
[18:06:01] -rusti- <anon>:5          enum Foo { Bar { id: uint }, Baz { id: uint } }; match Bar { id: 1 } { *{ id: ref id, _ } => id }
[18:06:01] -rusti-                                                                                          ^
[18:06:01] -rusti- application terminated with error code 101
[18:06:49] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[18:08:41] <jorendorff> brson: if I wanted a bounded-size pipe, and I wanted .send() to block if the pipe is full, is that something the library has? it seems possible to implement
[18:09:14] <brson> jorendorff: in the current implementation these two iloops that just send will never actually yield and if other threads fail to steal then the receivers never run. it's pretty bad
[18:09:38] <jorendorff> right, i'm not saying that as a fix
[18:09:40] <brson> jorendorff: there's not a bounded pipe currently but it would be easy to implement
[18:09:42] <jorendorff> i'm saying, separately
[18:09:45] <brson> understood
[18:09:46] <jorendorff> yeah - ok
[18:09:55] <jorendorff> i'll try it out later on
[18:11:59] <brson> i should try to fix this soon. kind of embarassing
[18:13:53] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[18:14:35] *** Joins: pauls (pauls@moz-7140CF01.ccs.neu.edu)
[18:15:14] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[18:16:01] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:16:01] *** ChanServ sets mode: +o pcwalton
[18:17:02] *** Quits: eagen (eagen@8737942B.7A99C13A.B7961A98.IP) (Ping timeout)
[18:18:51] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[18:19:24] <quasisphere> are the different Reader/Writer traits in std::io and std::rt::io going to be merged? I'm kinda missing read_line for sockets.
[18:22:28] <brson> quasisphere: not exactly, but there will at some point be a replacement for read_line and other string handling methods in rt::io
[18:22:31] <brson> todo
[18:22:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:23:28] <quasisphere> brson: ok, thanks
[18:23:31] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:24:50] *** Quits: pauls (pauls@moz-7140CF01.ccs.neu.edu) (Quit: Ignore me!!)
[18:25:44] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[18:26:18] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:28:04] *** Joins: pauls (pauls@moz-7140CF01.ccs.neu.edu)
[18:28:29] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[18:31:05] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[18:31:48] <brson> seems like we're unlikely to fix that memory or compiler perf regression
[18:32:24] <pcwalton> do we have any idea what the problem is?
[18:32:36] <pcwalton> I thought it had something to do with undefined behavior in our IR so LLVM wasn't inlining?
[18:32:49] *** Quits: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Quit: Leaving.)
[18:33:07] <brson> that was one problem, but strcat fixed it and it didn't change compile times
[18:33:19] <pcwalton> I thought it wasn't totally fixed
[18:33:23] <strcat> I fixed part of it
[18:33:27] <pcwalton> yeah
[18:33:32] <strcat> type_use still makes bitcasts LLVM doesn't like
[18:33:36] <strcat> the funny part is, mergefunc makes them too
[18:33:42] <strcat> probably why it's not the default
[18:33:50] <pcwalton> interesting
[18:33:57] <pcwalton> LLVM is incompatible with monomorphic collapse!
[18:34:08] <tjc> 0_o
[18:34:08] <strcat> pcwalton: well I think if you bitcast the parameters instead of the function it'd work
[18:34:13] <strcat> but mergefunc does the same thing as us
[18:34:13] <tjc> *any* monomorphic collapse?
[18:34:24] <pcwalton> strcat: iiiinteresting
[18:34:29] <strcat> (also bitcast doesn't work for everything so... it's a bit more complicated)
[18:34:31] <pcwalton> ISTM that's worth bringing up on llvm-dev
[18:35:03] <strcat> yeah I think it's a bug, although the lint pass complains about each one
[18:35:14] <strcat> seems like in some parts of their codebase they view it as valid, and invalid elsewhere ;p
[18:35:49] <strcat> there are something like 10000 lint warnings for libstd, and all but 300 are from monomorphize collapse
[18:35:59] <strcat> and of those 300 remaining ones, only 2 are for undef behaviour
[18:36:03] <pcwalton> I vote turning that off
[18:36:07] <pcwalton> monomorphic collapse
[18:36:21] <pcwalton> I mean, if it's producing undefined behavior then it's plain broken
[18:36:24] <pcwalton> and we're skating on thin ice
[18:36:47] <strcat> pcwalton: I don't think it's actually supposed to be undefined though
[18:36:52] <strcat> if mergefunc is using it...
[18:36:58] <pcwalton> we should really ask llvm-dev
[18:37:11] <tjc> So is mergefunc going to do for us most of what we were doing previously with monomorphic collapse?
[18:37:17] <pcwalton> tjc: it'll do everything and more
[18:37:23] <pcwalton> it'll do everything we did with type-use and more
[18:37:29] <tjc> pcwalton: cool, so we won't see any code blowup from disabling our own monomorphic collapse?
[18:37:34] <pcwalton> well
[18:37:36] <pcwalton> heh
[18:37:37] <strcat> tjc: http://llvm.org/docs/doxygen/html/MergeFunctions_8cpp_source.html it's pretty simple
[18:37:40] <pcwalton> *if* we were running mergefunc
[18:37:42] <strcat> it hashes functions based on their IR
[18:37:44] <pcwalton> but I think that resulted in crashes
[18:37:46] <strcat> then compares them and merges them
[18:37:53] <pcwalton> however that was a long time ago
[18:37:56] <pcwalton> we should try it again
[18:37:58] <tjc> well, supposing we can make it not crash :-)
[18:38:00] <strcat> if they're tagged with unnamed_addr, it totally removes them, otherwise it leaves a stub
[18:38:01] <pcwalton> yes
[18:38:10] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[18:38:17] <strcat> pcwalton: atm it results in an LLVM assert from an invalid cast
[18:38:28] <strcat> I didn't get to the point where I figured out if it was our fault or mergefunc's fault :(
[18:38:34] <pcwalton> bleh
[18:38:48] <strcat> those asserts are really a pain
[18:39:01] <pcwalton> can we maybe bisect the LLVM upgrade to figure out where the regression happened?
[18:39:03] <pcwalton> I know that's a lot of work
[18:39:07] <pcwalton> but it seems necessary
[18:39:22] <pcwalton> or just back it out
[18:39:24] <strcat> well I think they tried to fix mergefunc for 3.3
[18:39:41] <strcat> so I think it either made it stricter or introduced a new bug
[18:40:12] <strcat> pcwalton: afaik emscripten is using it
[18:40:16] <strcat> so it does work for someone
[18:40:20] <strcat> http://llvm.org/bugs/show_bug.cgi?id=15185
[18:40:24] <pcwalton>   CC(target) obj.target/libuv/src/unix/fsevents.o
[18:40:25] <pcwalton> ../../../../../src/libuv/src/unix/fsevents.c:80: error: initializer element is not constant
[18:40:26] <pcwalton> bluh?
[18:40:41] <acrichto> oh dear more libuv build issues :(
[18:41:03] <pcwalton> strcat: azakai says "it only works in llvm 3.3 and we're using llvm 3.2"
[18:41:11] <strcat> ah
[18:41:11] *** Quits: tikue_ (tkuehn@moz-FEADCD38.hsd1.pa.comcast.net) (Quit: tikue_)
[18:41:17] <strcat> Comment 2 Nick Lewycky 2013-02-06 16:40:37 CST
[18:41:19] <strcat> Why are you using, or trying to use mergefunc?
[18:41:21] <strcat> Comment 3 Chad Austin 2013-02-06 18:29:40 CST
[18:41:23] <strcat> mergefunc is a substantial win for reducing code size in Emscripten.
[18:41:25] <strcat> Comment 4 Nick Lewycky 2013-02-06 19:30:02 CST
[18:41:27] <strcat> Oh. I guess I should actually maintain it then, huh? Sorry, I'd been letting it bitrot since it isn't on by default for llvm.
[18:41:29] <strcat> funny little exchange
[18:41:42] *** Joins: kasey (Kasey@moz-569EFDE8.dhcp.trlk.ca.charter.com)
[18:41:52] <strcat> I'm not sure why the clang C++ people don't care more about it :s
[18:42:16] <fread2281> can I make a trait that has a method that says it should return some kind of Iterator over ints?
[18:42:18] <strcat> pcwalton: it looks like before it assumed there were no hash collisions
[18:42:19] <pcwalton> apparently it was fixed in 3.3
[18:42:21] <strcat> heh
[18:42:25] *** Joins: wilkie (wilkie@moz-CEF5E490.pitbpa.fios.verizon.net)
[18:42:34] <azakai_> might be mainly fixed for the emscripten case though, not sure
[18:42:47] <strcat> fread2281: well you can do '<T: Iterator<int>>'
[18:42:54] <azakai_> i think someone motivated by that worked on it
[18:43:20] <strcat> it really helps for C++ so it's surprising
[18:43:47] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[18:44:12] <azakai_> why would c++ have lots of dupes though?
[18:44:17] <strcat> templates
[18:44:23] <strcat> especially templated types
[18:44:38] <azakai_> but they would be different?
[18:44:47] <azakai_> for different types
[18:44:53] <strcat> azakai_: in many cases they won't be - they'll be the same size, and that might be all that matters
[18:45:03] <strcat> and you can have 1000 types that are really just an 'int32_t'
[18:45:17] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[18:45:17] <strcat> perhaps with slightly altered functionality
[18:45:36] <strcat> azakai_: like for a std::vector, all it cares about is the move/copy constructors and size
[18:45:51] <azakai_> hmm, clang should not emit two versions for those, i would hope. if the llvm ir is the same
[18:45:52] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:46:02] <azakai_> and linking should remove dupes across object files
[18:46:14] <strcat> well linking removes dupes based on names
[18:46:25] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[18:46:28] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:46:28] *** ChanServ sets mode: +o pcwalton
[18:46:34] <olsonjeffery> acrichto: can you explain to me the work you did with rt::uv::status_to_maybe_uv_error() ?
[18:46:58] <fzzy> can you overload operators like in c++?
[18:46:59] <azakai_> strcat: yes, names should be the same for the same types. hopefully
[18:47:09] <acrichto> olsonjeffery: libuv removed the uv_last_error function, all functions now return a proper error code that can be directly translated to a UvError, so I removed the watcher/loop arguments because they weren't necessary
[18:47:15] <strcat> azakai_: I mean wrappers around types though, so they won't be
[18:47:28] <olsonjeffery> acrichto: i see, thanks.
[18:47:36] <strcat> like http://www.boost.org/doc/libs/1_54_0/doc/html/boost_units.html
[18:47:52] <azakai_> strcat: could be, not sure i guess
[18:47:55] <strcat> but newtype wrapping with a struct is pretty common, even if it's just to change operator<
[18:48:04] <strcat> you might have 10 kinds of int pairs, each with their own operator<
[18:48:11] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[18:48:30] <strcat> (or similar things)
[18:48:50] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:49:00] <azakai_> surprising to me but i guess i don't know enough about c++ compiler internals
[18:49:48] <strcat> one of LLVM's design goals is not having to do any optimizations in the frontend
[18:49:51] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[18:50:09] <strcat> clang just has to decide the best way to return a value (since that's an ABI issue), and output as much info as possible
[18:50:15] <maik> anyone here with some experience with tasks in Rust? I ended up rewriting the whole task system for a simple thing... that kinda feels wrong 
[18:50:28] <strcat> other than that, it just does some dead simple dead code elimination when it's trivial
[18:51:16] <tjc> fzzy: Rust doesn't allow you to overload operators; it allows method overloading with traits, but that's only for identifiers
[18:53:31] *** Joins: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP)
[18:54:15] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Input/output error)
[18:54:20] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[18:55:01] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[18:55:17] *** Joins: carllerche (carllerche@1E2EB9E3.186539A3.965084DF.IP)
[18:56:25] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Client exited)
[18:56:48] *** Quits: sp3d (a@moz-6F12212B.fidnet.com) (Ping timeout)
[18:57:09] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[18:58:08] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[18:58:08] <SiegeLord> I'm confused... in what sense is implementing the std::ops traits not operator overloading?
[18:59:07] <strcat> azakai_: http://ix.io/7DQ really simple example
[18:59:20] <strcat> azakai_: becomes http://ix.io/7DR
[18:59:35] <tjc> SiegeLord: Well, that's true. It's only for a certain fixed sense of operators, though.
[18:59:46] <tjc> You can't define new non-alpha-numeric operator names like Haskell allows you to, for example
[18:59:52] <strcat> with -O3
[18:59:56] <azakai_> strcat: well they can't be merged, the types are different
[19:00:02] <SiegeLord> The original question was for C++, not Haskell ;)
[19:00:05] <strcat> azakai_: that's not true
[19:00:09] <strcat> LLVM types are only memory layout
[19:00:17] <azakai_> strcat: you need a very smart analysis to see otherwise
[19:00:30] <strcat> azakai_: mergefunc merges them, as will rust's type_use
[19:00:32] *** Quits: carllerche (carllerche@1E2EB9E3.186539A3.965084DF.IP) (Quit: carllerche)
[19:00:43] <tjc> SiegeLord: Does C++ allow you to define new non-alpha-numeric operator names (as opposed to overloading existing ones)?
[19:00:47] <tjc> I don't know if it does or not :-)
[19:00:50] <azakai_> strcat: merges them, and how are they called though? what type do callers now use?
[19:00:55] *** ozten is now known as ozten|afk
[19:00:58] <SiegeLord> tjc: It doesn't
[19:01:09] <strcat> azakai_: doesn't matter, the types aren't meaningful beyond memory layout
[19:01:18] <strcat> it will just bitcast the function call to the right signature
[19:01:19] <tjc> SiegeLord: Ah ok. Then maybe it's more similar to C++ than I claimed it was.
[19:01:33] <SiegeLord> Can only overloading a subset of existing ones, but I think in a way that's somewhat more ways than Rust allows
[19:01:34] <strcat> azakai_: LLVM types don't work like types in C
[19:02:11] <strcat> the only time the higher-level type system trickles down is for type-based alias analysis, where clang will output metadata nodes to loads/stores of ptrs
[19:02:22] *** Quits: fread2281 (zcarterc@moz-CB181B42.dia.static.qwest.net) (Ping timeout)
[19:02:44] <strcat> other than that it's just like assembly - operations matter, not types (LLVM doesn't distinguish even between signed/unsigned)
[19:03:00] <SiegeLord> Err... ignore the "in a way" bit
[19:03:26] <strcat> anyway there are significant wins from mergefunc
[19:03:52] <strcat> maybe not without LTO
[19:04:27] <pcwalton> strcat: all of clang's constant folding stuff is pretty much "optimization in the frontend" as far as I'm concerned ;)
[19:04:39] <strcat> pcwalton: well they need it for constexpr and so on
[19:04:42] <strcat> and templates
[19:04:44] <azakai_> strcat: but llvm will not let you call      void (i32*)         with  a double*
[19:04:50] <pcwalton> yeah, they need it
[19:04:58] <azakai_> strcat: you would need to bitcast the pointer
[19:05:04] <strcat> azakai_: yes, which mergefunc does
[19:05:28] <azakai_> strcat: so what does it change it to, i was asking? is there a "generic pointer"?
[19:05:45] <strcat> azakai_: it doesn't matter with LLVM types - it will just pick one
[19:05:48] <strcat> arbitrarily
[19:05:50] <azakai_> i see
[19:05:58] <azakai_> well, this would only work for trivial functions though
[19:06:23] <azakai_> and it would need to prove that only the size matters
[19:06:40] <strcat> all it does is compare the IR
[19:06:59] <strcat> it converts all pointers to integers first
[19:07:09] <strcat> normalizes GEP and adds/subs
[19:07:18] *** Joins: gandi (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:07:27] <azakai_> i see. well, seems like it would just catch trivial funcs though
[19:07:35] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[19:07:42] <azakai_> i could be wrong though
[19:07:56] <strcat> it catches any functions that are actually the same operations on types of the same size
[19:08:08] <strcat> it discards any actual types
[19:08:27] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[19:08:40] <strcat> a struct Foo { int *x, *y } will be treated just like Bar { float *x, *y }
[19:08:41] <azakai_> yeah, it seems those would be rare though
[19:08:47] *** Quits: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP) (Ping timeout)
[19:08:47] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr)
[19:08:53] <SiegeLord> fzzy: So basically you can overload all the binary and unary arithmetic operators as well as the indexing operator via traits
[19:08:56] *** Parts: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) ()
[19:09:59] *** Quits: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de) (Ping timeout)
[19:10:09] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[19:10:28] <brson> ecr: had lunch yet?
[19:10:28] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[19:10:42] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:10:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/mMyjpQ
[19:10:42] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:11:02] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[19:11:08] <ecr> brson: no, but I had a pretty late breakfast
[19:11:54] <brson> ecr: ok. we'll get lunch in 30 min or so
[19:12:17] *** Joins: Jesin (Jessin_@moz-5E8F07BF.cc.lehigh.edu)
[19:12:43] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Ping timeout)
[19:14:51] <quasisphere> is there a way to share a socket between two tasks? I'd like to have one task wait for data to arrive, while the other task does stuff of its own and occasionally writes data to the socket.
[19:15:40] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[19:15:41] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/tmI5yg
[19:15:41] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[19:15:45] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:15:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Q_hsWA
[19:15:45] <ghrust> 13rust/06auto 1439ec994 15Huon Wilson: Make the unit-test framework check RUST_TEST_TASKS over RUST_THREADS....
[19:15:45] <ghrust> 13rust/06auto 146916d80 15bors: auto merge of #8823 : huonw/rust/6233, r=brson...
[19:15:45] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:16:13] <quasisphere> (by a socket I mean TcpStream here)
[19:17:09] *** Quits: joone (joone@E10A1781.2160464A.A34EC3BB.IP) (Ping timeout)
[19:18:12] <brson> quasisphere: you can put it into an extra::arc::RWArc and share that
[19:18:24] *** Joins: joone (joone@E10A1781.2160464A.A34EC3BB.IP)
[19:18:34] <brson> i'm curious to know if that works
[19:19:35] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[19:19:42] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[19:20:33] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[19:21:12] <brson> vadimcn: thanks for all the reports on failing unit tests. are you planning to enable stdtest for check-fast?
[19:21:17] <brson> would love to start catching this stuff
[19:21:36] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:21:44] <strcat> Undefined behavior: Call argument type mismatches callee parameter type
[19:21:47] <strcat> from mergefunc
[19:21:49] <strcat> ;p
[19:21:55] *** Joins: michael_rb (michael_rb@moz-235781B9.sw.biz.rr.com)
[19:22:05] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[19:22:11] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[19:22:23] <strcat> http://ix.io/7DZ becomes http://ix.io/7E0
[19:24:02] <blarsen> Barring unsafe code, C bindings, etc, is it intended that Rust be provably type-safe and memory safe?
[19:24:07] <strcat> oh
[19:24:10] <strcat> instcombine fixes it
[19:24:26] <tjc> blarsen: That's the intent, yes
[19:24:38] <tjc> blarsen: nmatsakis has already done work on proving type safety/memory safety for a formalization of a Rust subset
[19:24:44] <blarsen> oooh
[19:24:52] * nmatsakis needs to do a lot more
[19:24:56] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[19:25:05] <nmatsakis> or maybe find a PhD intern who wants to do a lot more :)
[19:25:10] <tjc> heh
[19:25:10] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[19:25:17] <blarsen> machine-checked formalism?
[19:25:19] <strcat> pcwalton: I think we might just be doing the casts slightly wrong...
[19:25:21] <strcat> hm
[19:25:30] <strcat> instcombine removes the casts mergefunc + inline makes
[19:25:31] <pcwalton> interesting
[19:25:55] <tjc> blarsen: No, although lkuper (former PhD intern at Mozilla) did do some work on modeling a subset of Rust in PLT Redex
[19:26:04] <ecr> i'm vaguely interested, but i'm not sure if i could sway my advisers to fund it
[19:26:16] <strcat> pcwalton: ah nvm it's just a special case where it removes it
[19:26:20] <strcat> since it's a constant
[19:26:36] <strcat> so much for volatile
[19:26:49] <quasisphere> brson: got it to compile but it triggers a condition :)
[19:26:57] *** Quits: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving)
[19:27:04] <strcat> it won't remove the volatile variable but it will happily change the LLVM type :)
[19:28:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:28:15] <blarsen> it seems kind of tough to try to prove properties of Rust when the language is changing so quickly.  One would have to revise the proofs accordingly.
[19:28:21] *** Joins: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP)
[19:28:28] <tjc> blarsen: Yes, the proofs would have to choose a particular version of Rust and stick to that
[19:28:34] *** Quits: michael_rb (michael_rb@moz-235781B9.sw.biz.rr.com) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0.1/20130814063812])
[19:29:13] <strcat> pcwalton: ah nvm instcombine *does* fix it still
[19:29:17] <strcat>   %3 = call zeroext i1 bitcast (i1 (i32*)* @_Z3fooIPViEbT_ to i1 (double*)*)(double* %q)
[19:29:19] <strcat> becomes
[19:29:25] <strcat>   %3 = bitcast double* %q to i32*
[19:29:27] <strcat>   %4 = call zeroext i1 @_Z3fooIPViEbT_(i32* %3) #3
[19:29:45] <strcat> so I don't really understand why that isn't for rust
[19:29:47] <brson> nmatsakis: q about fixed_stack_segment: in this example i have the attribute on a function, but the ffi call is in a stack closure https://gist.github.com/brson/6370178
[19:29:49] <strcat> need to try a rustc sample...
[19:30:05] <nmatsakis> brson: yes, this is intentionally allowed
[19:30:11] <brson> nmatsakis: why does this work? is it because the lint mode assumes that if that closure is going to be called it will happen on the big segment?
[19:30:17] <nmatsakis> brson: yes
[19:30:29] <brson> nmatsakis: what if there are 2MB of stack frames between
[19:30:53] <nmatsakis> brson: well my assumption is that once you switch to fixed, you never want to switch stacks again
[19:30:54] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[19:30:54] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146916d80 to 1464ed372: 02http://git.io/N3iJvQ
[19:30:54] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[19:30:55] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:30:56] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JpYpIw
[19:30:56] <ghrust> 13rust/06auto 14d923f75 15Brian Anderson: doc: Remove statement about scheduling randomness...
[19:30:56] <ghrust> 13rust/06auto 149c33ef5 15bors: auto merge of #8828 : brson/rust/randomness, r=thestinger...
[19:30:56] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:31:02] <nmatsakis> brson: perhaps that assumption is bogus
[19:32:23] <brson> nmatsakis: it's probably a reasonable assumption, though we can (and naturally will) continue growing the stack once it switches back into rust frames
[19:32:54] <brson> we do have test cases for that
[19:33:43] <brson> maybe it would be better to just fail hard when we hit the end of the big stack, for consistency
[19:34:01] <nmatsakis> brson: did you see that RFC I posted? this was one of the things i was wrestling with
[19:34:07] <nmatsakis> I don't really know what's the right answer
[19:34:18] <nmatsakis> it'd be easy enough to change the lint to be stricter about closures
[19:34:28] <nmatsakis> though it can be annoying since we lack a way to annotate a closure
[19:34:38] <brson> no i didn't see it. i'll read it now
[19:35:19] <strcat> acrichto: hm, we run inline at -O1 instead of only doing always inline
[19:37:18] <nmatsakis> brson: https://github.com/mozilla/rust/issues/8822
[19:38:17] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[19:38:35] <blarsen> Hey, so normally, the scope of a 'let' expression is the remainder of the enclosing block.  So if I have 'let foo = 42', 'foo' is in scope for the remainder of the block.  Is there any way to kill 'foo'?
[19:38:50] <tjc> blarsen: you can move out of it
[19:39:04] <tjc> at least, if foo has a type that can't be copied cheaply
[19:39:20] <nmatsakis> blarsen: make a new block
[19:39:34] <nmatsakis> blarsen: ... { let foo = 42; ... } ...
[19:39:48] *** Joins: ZephyrSL (Mibbit@7182A81.141B8B26.4B2DF651.IP)
[19:39:48] <blarsen> so if foo has int type, I'm out of luck.  (can be copied cheaply)
[19:39:55] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[19:39:56] <nmatsakis> yes
[19:40:01] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[19:40:01] <nmatsakis> unless you can make a new block
[19:40:03] <blarsen> I'm just starting to play around
[19:40:22] <engla> something that doesn't copy can be killed with std::util::ignore(foo)
[19:40:33] <engla> or let _ = foo
[19:40:34] <jeaye> blarsen: fn main() { do_things(); { let foo = 42; do_with(foo); } do_without_foo(); }
[19:40:36] <tjc> Yeah, I figured there was probably a trick to do that too
[19:40:40] <kimundi> or just shaddwo the variable name with 'let foo = ();' or so :P
[19:40:40] <strcat> blarsen: well you could shadow it in the same scope, if you really wanted (it won't actually do anything)
[19:40:53] <strcat> you can shadow it in a way that there's no longer a name you can actually use
[19:40:54] <tjc> engla: won't let _ = foo just copy foo in this case, since int is copyable?
[19:41:01] <strcat> tjc: yes
[19:41:02] <engla> yes
[19:41:15] <strcat> rusti: enum Opaque {} let foo = 5; let foo: Opaque;
[19:41:16] <tjc> engla: Ah, that's what you said; never mind, I can't read :-)
[19:41:18] -rusti- pastebinned 7 lines of output: http://ix.io/7E6
[19:41:39] * strcat doesn't really understand *why* you'd do that
[19:41:42] <strcat> ;p
[19:42:06] <blarsen> I'm getting the hang of borrowed pointers and the "borrowed check".
[19:42:48] <engla> there was a question here some days ago. let x: ~T; let y = @*x;   this is never efficient right? It has to memcpy the value into a new allocation?
[19:43:12] <nmatsakis> it does memcpy
[19:43:21] <nmatsakis> whether that's inefficient...well that depends on T and a lot of ther things
[19:43:23] <SiegeLord> Hmm... can you not expand macros inside traits? I'm getting "unexpected token"
[19:43:24] <nmatsakis> *other things
[19:43:38] <nmatsakis> SiegeLord: I don't think you can expand a macro inside a trait
[19:43:48] <nmatsakis> SiegeLord: macros can generate top-level items or expressions, not arbitrary tokens
[19:43:54] <pauls> SiegeLord: macros can only expand as items, expressions, or statements.
[19:43:56] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[19:44:11] <SiegeLord> Well, does the trait function not count as an item?
[19:44:11] *** Quits: ZephyrSL (Mibbit@7182A81.141B8B26.4B2DF651.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:44:15] * nmatsakis always amused when pauls crops up at the mention of the word macro :)
[19:44:28] *** Joins: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com)
[19:44:30] <nmatsakis> SiegeLord: no, it does not, though arguably it should
[19:44:36] *** Joins: carllerche (carllerche@1E2EB9E3.186539A3.965084DF.IP)
[19:44:36] <Florob> Also I would expect constprop could propagate x's value to y's definition.
[19:45:04] <tiffany> how do you add to a hashmap?
[19:45:18] <strcat> Florob: it won't though
[19:45:33] <SiegeLord> Damn, it was such an awesome macro too
[19:45:36] <SiegeLord> Oh well
[19:45:45] <Florob> strcat, too bad really.
[19:45:50] <strcat> LLVM doesn't know what ~ and @ are, they call a non-inlined function from a dynamic library without readonly/readnone annotations
[19:45:59] <strcat> entirely opaque to it
[19:46:25] <strcat> in C, LLVM knows what malloc is and can deal with it a bit
[19:46:32] <strcat> it's a special cased function name
[19:46:42] *** Joins: ZephyrSL (Mibbit@7182A81.141B8B26.4B2DF651.IP)
[19:46:49] <SiegeLord> I wonder if I can still use it to generate code at the top level and then copy paste it into my trait...
[19:47:08] <strcat> also their malloc definition returns a noalias ptr
[19:47:19] <strcat> ours don't mark it that way
[19:47:49] <nmatsakis> SiegeLord: can you just generate the entire trait def'n?
[19:47:58] <nmatsakis> SiegeLord: that's what I've usually done in analogous situations
[19:48:25] <SiegeLord> Err... maybe, it'd need a macro that's even further beyond awesome
[19:48:48] <pauls> Yeeees. Yeeeeeesssssss.
[19:48:56] * pauls rubs his hands together.
[19:49:09] <nmatsakis> pauls: I kind of think we should remove this consuming of entire items and instead re-tokenize -- or better yet, just parse the item and discard it immediately, only preserving the set of tokens the parsing consumed
[19:49:13] <pauls> My plan is nearly complete!
[19:49:32] <blarsen> http://mibpaste.com/QV2gIS 
[19:49:43] <nmatsakis> pauls: it would make macros much more flexible with respect to where $(foo) can be expanded
[19:49:54] <blarsen> I'm trying to understand the borrowed pointer check.
[19:50:12] <pauls> nmatsakis: I'm not sure what you mean...
[19:50:23] <Florob> strcat, So... that is something like: ¬´r1 = owning_alloc(); *r1 = val; r2 = box_alloc(); *r2 = *r1;¬ª With absolutely no type and aliasing guarantees for the memory pointed to?
[19:50:43] <nmatsakis> blarsen: the Rust rule is that there should only be one pointer to any bit of mutable memory,
[19:50:49] <blarsen> I understand that the purpose of the "borrowed pointer check" has to do with memory safety (e.g., preventing certain kinds of dangling pointers)
[19:50:54] <strcat> Florob: LLVM doesn't have any awareness of pointer "types"
[19:50:55] <nmatsakis> blarsen: so when you do an &mut borrow, you give up the ability to modify the original
[19:50:58] <pauls> ...are you suggesting not using the `maybe_whole!` system in the parser, and just re-parsing always? 
[19:51:00] <blarsen> nmatsakis: right.
[19:51:06] <nmatsakis> blarsen: (for the lifetime of the pointer)
[19:51:12] <nmatsakis> blarsen: intuitively, you've lent it out
[19:51:15] <strcat> Florob: it makes no limitations on pointers based on their LLVM type
[19:51:18] <strcat> like C does
[19:51:24] <blarsen> nmatsakis: but I was hoping for a way to "kill off" the borrowed pointer for the remainder of the block
[19:51:34] <nmatsakis> blarsen: the only way to do that right now is to make a sub-block
[19:51:38] <SiegeLord> Can you match on the value of identifier in a macro? Kind of like match $i { int => ... float => ... }
[19:51:51] <blarsen> I was slightly surprised that shadowing the old binding didn't affect the borrowed pointer check
[19:51:52] <strcat> the aliasing rules in LLVM are an entirely separate concept from types
[19:51:52] <nmatsakis> blarsen: though it may be something we can add -- in certain scenarios -- in the future
[19:51:53] <blarsen> nmatsakis: gotcha
[19:51:59] <SiegeLord> Oh, maybe using some sort of recursive macro perhaps?
[19:52:04] <nmatsakis> blarsen: the borrow checker doesn't try to check how the pointer has moved around
[19:52:04] <pauls> SiegeLord: the macro parser distinguishes between different identifiers, yes.
[19:52:30] <strcat> Florob: and because the exchange_malloc (~) call isn't inlined, it's opaque
[19:52:31] <nmatsakis> blarsen: though ... I guess with &mut, since they can't be copied, we COULD be quite a bit more aggressive
[19:52:36] *** mihneadb is now known as mihneadb|burrito
[19:52:41] <strcat> Florob: it doesn't know that it's a malloc (something it understands)
[19:52:45] <strcat> the solution is likely to extend LLVM
[19:52:52] <strcat> and teach it attributes for malloc/free
[19:52:57] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:53:04] <pauls> nmatsakis: doing so would result in O(n^2) parses, with n being the depth of macro expansion
[19:53:11] <nmatsakis> blarsen: I hadn't thought about that before actually :) -- but I think the current status of the borrowck is that we are nailing down its rule, closing up some known holes, and then we'll probably expand its capabilities a bit
[19:53:15] <nmatsakis> pauls: I don't care
[19:53:23] <nmatsakis> pauls: it would also result in macros that work more often :)
[19:53:29] <pauls> (and it wouldn't help SiegeLord, since it wouldn't help us put `asdf!(...)` in more places)
[19:53:42] <nmatsakis> it would help SiegeLord
[19:53:45] <Florob> strcat, Doesn't it actually have those? At least clang provides annotation for malloc-like functions IIRC. I'd expect that to require some LLVM support
[19:53:49] <nmatsakis> pauls:  because he could write a macro like this
[19:54:08] <pauls> Mm, oh, right, the workaround is to turn those into `$asdf`s, yeah.
[19:54:17] *** Quits: ZephyrSL (Mibbit@7182A81.141B8B26.4B2DF651.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:54:18] <nmatsakis> pauls: macro_rules!(... => { trait Foo { /* generate some functions */; $(the_rest) } })
[19:54:22] <nmatsakis> pauls: yeah
[19:54:43] <blarsen> nmatsakis: yeah, I figured.  From a distance, it looks like rust is changing very rapidly, so I'm not surprised to run into rough parts
[19:54:43] <nmatsakis> pauls: I do recognize the advantage of the current system as well...
[19:55:16] <strcat> Florob: it ignores them, it only supports them because gcc has them
[19:56:34] <strcat> actually it translates __attribute__((malloc)) to noalias
[19:56:50] <strcat> but you lose the actual malloc knowledge (dead store elimination, etc.)
[19:56:55] <strcat> because it thinks the function has side effects
[19:57:45] <strcat> Florob: http://ix.io/7Ea -> http://ix.io/7Eb - if all you have is the definition of foo (not inlined), it loses the special cases for malloc
[19:58:08] <pauls> nmatsakis: maybe we could keep the current system and use the general approach as a fallback?
[19:58:13] * strcat shrugs
[19:58:17] <pauls> Or is that too much of a performance footgun?
[19:58:29] <strcat> it would need an actual function attribute for malloc and the other C functions it special cases
[19:58:48] <nmatsakis> pauls: one thing that might work
[19:58:51] <pauls> Ooh, actually, we might have trouble anyways, since we need to tell the parser how to aquire the tokens in the first place: what should it be looking for?
[19:59:02] <nmatsakis> pauls: is allowing a token-tree to be used more-or-less anywhere
[19:59:14] <nmatsakis> pauls: I don't get that, I feel like that's what token-trees are for...
[19:59:33] <nmatsakis> pauls: i.e., you should be able to write "{$extra:tt}" in your macro rules,
[19:59:41] <nmatsakis> pauls: and it would just consume everything up until the closing `}`
[19:59:54] <nmatsakis> pauls: then the question becomes how we can sort of generically "flatten out" token trees...
[20:00:07] <nmatsakis> pauls: perhaps by having the lexer, when it encounters a $(fo) with type TT,
[20:00:19] <nmatsakis> pauls: just recurse in and spit out the tokens
[20:00:25] <nmatsakis> pauls: "as if" they had been present in the stream
[20:00:28] <nmatsakis> pauls: does that make sense?
[20:00:55] <nmatsakis> pauls: (you could imagine a special method for those cases where you actually *want* to take a token-tree as a unit also)
[20:01:04] <nmatsakis> pauls: to avoid those O(n^2) blow-ups
[20:03:18] <pauls> nmatsakis: oh, only allowing `:tt` to be used in arbitrary positions fixes most of my technical worries.
[20:03:39] *** Joins: daise (other@1D8F7AC1.B4C4F762.F00C612C.IP)
[20:03:42] <daise> Hello.
[20:03:55] <daise> Are there an rss parser library?
[20:04:00] <pauls> Now my only worry is that we might not be able to aquire interesting `:tt`s, since we don't want them to be forced to start and end with parens.
[20:04:05] <jdm> daise: not that I'm aware.
[20:04:13] <daise> jdm: Meh.
[20:04:24] <nmatsakis> pauls: well, they shouldn't have to start end in many cases
[20:04:36] <pauls> And the macro parser is famously limited by the `fail!`-emittingness of the main parser.
[20:04:40] <nmatsakis> pauls: they just have to end with an unbalanced closing delimeter
[20:04:56] <pauls> nmatsakis: oh, because of lookahead. Good point.
[20:05:10] <daise> jdm: So the only option for is to use lib_x_for_get_feed + lib_y_for_parse_xml? Can you suggest lib_x and lib_y?
[20:05:22] <flaper87> bblum: back. sorry
[20:05:45] <flaper87> bblum: you suggested to have an implementation for both kinds in MutexArc
[20:06:03] <daise> for me*
[20:06:08] <flaper87> bblum: I wanted to know what the advantage of that is. I mean, why is it necessary to support both
[20:06:48] <bblum> flaper87: well, what is the upside and the downside of the way that it currently is?
[20:07:35] <bblum> flaper87: (hint: the documentation on mutexarc will tell you this)
[20:08:12] <daise> Guys, can you recommend library for getting something from iternets via http?
[20:08:15] *** Joins: zalzane (zalzane@moz-AF4054A5.socal.res.rr.com)
[20:08:22] <daise> And fast xml parser.
[20:08:39] <Ms2ger> Python
[20:08:41] * Ms2ger ducks
[20:08:56] <zalzane> why didnt you dorks put the official irc channel on freenode
[20:09:20] <strcat> because it's a mozilla project :P
[20:09:29] <lkuper> zalzane: irc.mozilla.org is where mozilla projects tend to live.
[20:09:29] <strcat> anyway, freenode is always going down and having service issues
[20:09:29] <flaper87> bblum: nesting, I guess
[20:09:37] <zalzane> ah
[20:09:51] <lkuper> daise: please remember that not everyone in the IRC channel is a guy.
[20:10:20] <bblum> lkuper: +1
[20:10:48] <Ms2ger> Or likes to be called a dull, slow-witted, or socially inept person
[20:10:52] <pepper_chico> oh noh‚Ä¶ that sexism stuff punching hard again
[20:11:18] <bblum> flaper87: right, but nesting is unsafe, so, the T:Send impl is unsafe but allows nesting, so a T:Send+Freeze impl would... (??)
[20:11:31] <SiegeLord> I think I'll just copy the pretty output for now... writing a giant macro seems too much work atm
[20:11:34] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:11:52] <daise> lkuper: Do you have any proofs?
[20:12:04] <daise> Boobs or gtfo.
[20:12:08] <rossm> I live in the south and around here we generally refer to people by using the gender-neutral term "ya'll". Online I've learned that raises eyebrows, and so I often use "guys" as a gender-neutral term. Maybe "you all" would be better?
[20:12:17] <zalzane> daise this isnt 4chan
[20:12:19] <pepper_chico> next time I enter a channel I'll start with: "Ladies and Gentlemen"
[20:12:41] <Ms2ger> pepper_chico, ladies, gentlemen, and anybody who doesn't identify as either, you mean :)
[20:12:48] <rossm> :)
[20:12:52] <lkuper> brson, dherman, nmatsakis, pcwalton: one of you mind kicking daise, please?  thanks.
[20:12:55] <pepper_chico> oh, true
[20:13:00] <SiegeLord> I called my girlfriend and her female roomates "guys" on a few occasions, and nobody batted an eye >.>
[20:13:14] <pepper_chico> these days thing are getting more complicated
[20:13:20] <pauls> Wow, I've never seen something like that happen on IRC before.
[20:13:20] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[20:13:31] <zalzane> youve never been in a ruby irc channel
[20:13:33] <pauls> Of course, the only other IRC channels I'm in are tiny.
[20:13:37] *** Quits: daise (other@1D8F7AC1.B4C4F762.F00C612C.IP) (Quit: leaving)
[20:13:42] <kmc> SiegeLord: sure not everyone minds it, some people do though, especially in contexts where there's a huge existing bias (programming)
[20:13:59] <rossm> yeah that is fair
[20:14:06] <SiegeLord> Screw rust, let's come up with a better natural language
[20:14:13] <kmc> lojban!
[20:14:18] <zalzane> cobol
[20:14:29] *** Quits: pepper_chico (pepper_chi@EF476D4E.D3DE4871.E4090502.IP) (Quit: Textual IRC Client: www.textualapp.com)
[20:16:16] <lkuper> I can't believe that actually just happened in #rust.  Holy shit.
[20:16:22] <flaper87> bblum: It would not allow nesting
[20:16:26] <bblum> lkuper: i am sorry he said that to you :(
[20:16:28] <erickt> :( I'm sorry lkuper 
[20:16:33] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[20:16:41] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[20:16:50] *** Joins: sp3d (a@moz-6F12212B.fidnet.com)
[20:16:50] <bblum> flaper87: and it would be safe!
[20:16:56] <flaper87> bblum: yup
[20:17:13] *** mihneadb|burrito is now known as mihneadb
[20:17:22] <erickt> I've found the rust community to be generally the nicest one I've interacted with, and I want to keep it that way
[20:17:30] <pauls> There are two kind of languages, ones that no one uses, and ones where people come to the official IRC channel to act like complete jerks.
[20:17:39] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[20:17:50] <bblum> pauls: that means we weren't a language before today
[20:18:09] <erickt> pauls: yay?
[20:18:11] <SiegeLord> We finally matured I guess!
[20:18:25] <bblum> i would prefer if we did not depend on assholes on the internet to be legitimized :X
[20:18:25] <flaper87> erickt: +! re community
[20:18:34] <bblum> flaper87: so, the major challenge of the issue is not necessarily to refactor the code, but to provide clear documentation as to why there are two different ones
[20:19:06] <flaper87> bblum: yeah, and under what circunstances one would be prefered
[20:19:09] <bblum> right
[20:19:21] <erickt> I for one like graydon's swift hammer of justice.
[20:19:55] <flaper87> bblum: thanks again for the guiding, I'll take a look at the implementation and figure out how to create the safe access impl
[20:20:08] <flaper87> if there's something I should know, shoot :P
[20:20:13] <kmc> I agree about the Rust community being very nice, although I would add that 'nice' and 'helpful' are not always the same thing (but I think we're helpful, too)
[20:20:18] <lkuper> erickt: yeah, but graydon can't be everywhere; we all need to help out
[20:20:23] <kmc> #haskell sometimes seems too nice to be helpful -- that's part of why I left
[20:20:49] <bblum> flaper87: no prob, just 'r?' me when you're ready
[20:20:54] <lkuper> hopefully rust can be both nice and helpful
[20:20:59] <bblum> daise should probably still get his hostmask banned, by the way
[20:21:17] <erickt> lkuper: agreed.
[20:21:27] <zalzane> pauls ive found that to be true
[20:21:35] <kmc> I hope so too
[20:21:38] <zalzane> you can also tell how much people actually like the language based on channel activity
[20:21:42] <kmc> it gets harder when you have 1000+ people in the channel vs 300
[20:21:49] <kmc> 300 is already a lot, though!
[20:21:55] <pauls> Maybe certain non-currently-Moz-employees (e.g. lkuper) should also have op powers.
[20:22:08] *** Quits: igl (igl@moz-A15582E8.adsl.alicedsl.de) (Quit: Leaving.)
[20:22:15] *** Joins: igl (igl@moz-A15582E8.adsl.alicedsl.de)
[20:22:47] <bblum> yeah i would be willing to wield ops
[20:23:54] <zalzane> rusty drama
[20:24:07] <bblum> which is different from rusti drama
[20:24:17] <zalzane> theres rusti drama?
[20:24:20] <strcat> give rusti op
[20:24:33] <rossm> rusti: drama
[20:24:33] -rusti- <anon>:5:9: 5:14 error: unresolved name `drama`.
[20:24:33] -rusti- <anon>:5          drama
[20:24:34] -rusti-                   ^~~~~
[20:24:34] -rusti- error: aborting due to previous error
[20:24:34] -rusti- application terminated with error code 101
[20:24:42] <lkuper> heh.
[20:24:48] <strcat> and then it kicks you for causing a compiler error
[20:24:51] <zalzane> oh is rusti the language's repl
[20:24:56] <rossm> yeah
[20:25:02] <rossm> extremely helpful in this setting
[20:25:19] *** Joins: victorporof (victorporo@moz-BAE8D951.pck.nerim.net)
[20:25:34] <lkuper> pauls: I wouldn't say no to that.
[20:26:05] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[20:26:33] <blarsen> Hey, with managed pointers (@-pointers), if the pointed-to type implements Drop, is there any guarantee of promptness for when the drop method is executed once the pointed-to object is unrooted?
[20:26:48] <strcat> worst-case, when the task ends
[20:27:05] <strcat> blarsen: use Rc/RcMut if you want deterministic cleanup
[20:27:06] <Ms2ger> I thought you didn't get to use Drop with @-pointers?
[20:27:18] <strcat> you can have types *inside* the @ ptr with a destructor
[20:27:28] <strcat> you just can't impl a destructor on a type containing @
[20:27:38] <Ms2ger> Aha
[20:27:39] *** ozten|afk is now known as ozten
[20:27:41] <bblum> you can't create @ pointers in a destructor, or if you can today, you shouldn't be able to
[20:32:10] *** Joins: miza (Mibbit@moz-4DD51325.home.otenet.gr)
[20:33:01] <kasey> Rust beginner here: Is there a function to separate a string in the standard library for v0.7? I can't seem to find any 
[20:33:45] *** Joins: eholk (eholk@moz-F70D5031.hsd1.in.comcast.net)
[20:33:52] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Client exited)
[20:33:54] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[20:33:57] <miza> hi
[20:34:35] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[20:35:16] <bblum> kasey: to separate based on what?
[20:35:43] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:35:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JpYpIw
[20:35:43] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:36:11] <kasey> Whitespace
[20:37:09] <kasey> I've tried this function: http://static.rust-lang.org/doc/0.7/std/str.html#function-each_split_within
[20:37:33] <kasey> But I can't get it working
[20:37:44] <bblum> kasey: have a look in http://static.rust-lang.org/doc/0.7/std/str.html - it looks like StrStrSplitIterator is what you want
[20:37:53] <bblum> each_split_within appears to split based on length
[20:38:12] <bblum> although i'm not sure strstrsplit iterator can split based on, e.g., regex
[20:38:18] <miza> fn random_method(vector: &[int]) -> ~[int] {  let mut sorted = vector;sorted }
[20:38:35] <miza> mismatched types: expected `~[int]` but found `&[int]` ([] storage differs: expected ~ but found &)
[20:38:40] <kasey> Okay thanks
[20:38:50] <miza> how can i resolve this problem
[20:39:08] <miza> i want to parse an array, do some staff on this and return it
[20:39:17] *** Joins: tikue_ (tkuehn@moz-BE1EFE7F.wv.cc.cmu.edu)
[20:39:28] *** Quits: andrew-d (andrew-d@6C6C9B53.23518FA3.CE794808.IP) (Ping timeout)
[20:39:31] <sfackler> do you want to mutate the original array or make a new one with changes?
[20:39:47] <miza> a new one
[20:40:02] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Ping timeout)
[20:40:13] <Ms2ger> .clone()?
[20:40:22] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[20:40:23] <sfackler> vector.to_unique() will copy the vector into a new ~[int].
[20:40:43] <sfackler> er, to_owned
[20:42:08] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:42:21] *** Joins: andrew-d (andrew-d@6C6C9B53.23518FA3.CE794808.IP)
[20:42:31] *** Quits: tcr_ (tcr@D26BCFC9.C2203064.EDCE493E.IP) (Client exited)
[20:42:44] <miza> to_owned is what i want
[20:42:51] <miza> thank you very much
[20:44:06] <miza> its little difficult to start with rust :/
[20:44:25] <miza> there isn't enough resources
[20:44:34] <pnkfelix> acrichto: I'm looking at your patch from #8826 now
[20:44:50] *** Quits: eholk (eholk@moz-F70D5031.hsd1.in.comcast.net) (Quit: eholk)
[20:45:01] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[20:45:38] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0.1/20130814063812])
[20:47:20] <sfackler> miza: yep :/ documentation is hard to keep up to date when things are changing so fast. hopefully the language will start stabilizing more soon
[20:47:32] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[20:48:37] <SiegeLord> Does anybody know if crabtw (author of rust-bindgen) comes on IRC?
[20:48:38] <miza> i am rubyst, but i want to play with something new
[20:48:44] <miza> an i like the concept of rust
[20:51:30] <SiegeLord> I really wish github didn't get rid of it's PM feature... 90% of people on there never leave their contact information in the readme >_<
[20:51:35] <SiegeLord> *its
[20:53:22] <sebcrozet> SiegeLord: fwiw, his mail is on its profile.
[20:53:40] <SiegeLord> Oh, I missed that... that'll do
[20:53:47] <kmc> you can usually get email from the commits themselves
[20:57:45] <Florob> kmc, Which I've seen result in "Where on earth did you even get my email!"
[20:58:23] <kmc> haha
[20:58:30] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[20:59:39] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:00:36] *** Quits: igl (igl@moz-A15582E8.adsl.alicedsl.de) (Ping timeout)
[21:01:57] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:01:57] *** ChanServ sets mode: +o tjc
[21:02:22] *** Joins: igl (igl@moz-74010307.adsl.alicedsl.de)
[21:03:01] <kmc> error: cannot implement a destructor on a structure with type parameters
[21:03:03] <kmc> strange limitation
[21:03:12] <kmc> are the rules and rationales for when destructors are allowed documented anywhere?
[21:03:14] <pcwalton> because we can't check whether it's Send
[21:03:16] <pcwalton> they're going to change
[21:03:22] <pcwalton> I think anyway
[21:03:28] <kmc> the type parameter might not even be used
[21:03:31] <kmc> or I could put a Send bound on it
[21:03:49] <pcwalton> you can't put bounds on type parameters in struct definitions
[21:03:51] <pcwalton> only in methods
[21:03:51] <pcwalton> '
[21:03:54] <kmc> so why do things with destructors have to be Send, or whatever the rule is?
[21:04:05] <pcwalton> to avoid cyclic destruction problems
[21:04:09] <kmc> pcwalton: what about impl<T: Send> Drop for Foo<T>
[21:04:11] <blarsen> Is order-of-evaluation of arguments in a call expression in Rust left-to-right, right-to-left, or unspecified?
[21:04:17] <kmc> ah
[21:04:23] <pcwalton> blarsen: LTr
[21:04:24] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Client exited)
[21:04:25] <pcwalton> LTR
[21:04:40] <kmc> that's interesting
[21:04:45] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[21:04:49] <blarsen> pcwalton: thank you!  so many otherwise respectable languages go the "unspecified" route.
[21:04:51] <pcwalton> kmc: can't do that, the destructor is internally tied to all instantiations of the struct regardless of type parameters
[21:04:51] <kmc> I think most languages leave it unspecified, for optimization purposes
[21:05:13] <blarsen> which makes your programs harder to reason about!
[21:05:15] <pcwalton> I think those optimizations are fairly dubious with SSA form
[21:05:22] <pnkfelix> kmc: I don't know about "most".  It is nonetheless one interesting common feature of both C and Scheme
[21:05:28] <kmc> :)
[21:05:35] <blarsen> and Lua and ocaml
[21:05:43] <kmc> pcwalton: how so?
[21:05:50] <pcwalton> it's just how it's implemented in the compiler
[21:05:59] <pcwalton> perhaps we could change that with more work
[21:06:01] <pcwalton> allowing bounds on destructors
[21:06:14] <kmc> I meant re: order of eval optimizations
[21:06:28] <kmc> the thing about dtors being independent of type parameters makes some sense
[21:06:36] <kmc> it would be confusing if it were not the case
[21:07:14] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (Ping timeout)
[21:07:30] <pcwalton> oh, ok
[21:07:57] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[21:08:14] <pcwalton> SSA form makes it pretty easy to detect when parameter evaluation is side effect free and so allows the compiler to easily reorder if the calling convention wants arguments to be evaluated RTL
[21:08:38] <kmc> blarsen: if you have to care about order of evaluation at all, your programs are already too hard to reason about! </fp_zealot>
[21:08:42] <pcwalton> you only get the LTR behavior if your program depends on it, basically
[21:08:47] <pcwalton> which is exactly what you want
[21:09:02] <kmc> that's cool
[21:09:03] <pcwalton> leaving argument order evaluation unspecified only really helps bad compilers :)
[21:09:06] <kmc> yeah
[21:09:13] <kmc> I kinda see that
[21:09:39] <kmc> C is designed to be implemented by bad / simple compilers
[21:10:01] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[21:10:25] *** pcwalton sets mode: +b *!*@1D8F7AC1.B4C4F7C2.F00C612C.IP
[21:10:27] <pnkfelix> There was some argument that will clinger used to provide that the operator in a function call should be evaluated last, but I never really bought into it.  Or at least never digested enough to believe it was worth the cost
[21:10:45] <blarsen> kmc: in an impure language, if order of evaluation is nailed down, then it's perfectly reasonable to write 'foo(bar(5), baz(42))'
[21:11:10] <blarsen> if order-of-evaluation isn't nailed down, then you shouldn't right such code.
[21:11:24] <brson> bors's queue is empty
[21:11:33] <blarsen> s/right/write
[21:11:37] <mcpherrin> brson: madness.
[21:12:02] <chandler> pnkfelix: if I remember right, his argument was specific to how larceny was implemented
[21:12:09] <kmc> is there something in the std lib to print a hex dump of a region of memory?
[21:12:47] <pnkfelix> chandler: ‚Ä¶ it certainly might have been informed by Larceny's implementation, but I don't remember him presenting it as quite so coupled ...
[21:13:09] <chandler> hence the "if I remember right". :-)
[21:13:21] <ecr> kmc: not that i'm aware of. you could probably do it by unsafely coercing a pointer to the first bit into a vector of u8 and then printing the vector
[21:13:35] <pnkfelix> chandler: I wish I could find a written version of the argument somewhere...
[21:13:59] * pnkfelix wonders if he was still taking notes at that point in the compiler course...
[21:14:00] *** Joins: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu)
[21:15:13] *** Quits: Ms2ger (Ms2ger@moz-982ABA97.adsl-dyn.isp.belgacom.be) (Quit: nn)
[21:15:39] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:15:39] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HEisYA
[21:15:39] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:15:39] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[21:15:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/xp_iHw
[21:15:39] <ghrust> 13rust/06auto 1406a7195 15Alex Crichton: Consolidate local_data implementations, and cleanup...
[21:15:39] <ghrust> 13rust/06auto 14da96b3e 15bors: auto merge of #8447 : alexcrichton/rust/local-data-merge, r=brson...
[21:15:40] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[21:16:46] *** Quits: [squiddy] (squiddy@moz-34DADDC7.adsl.alicedsl.de) (Input/output error)
[21:18:30] <pnkfelix> chandler: Certainly this datapoint is Larceny speciifc: http://compilers.iecc.com/comparch/article/95-08-080  :)
[21:19:08] <chandler> Yes, I just found that too.
[21:19:54] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[21:22:46] <pnkfelix> chandler: In hindsight, you're probably right, that he probably discussed the topic by doing a code walk through Larceny's (or rather Twobit's) parallel-assignment-optimization.
[21:26:02] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[21:28:46] <fhahn> is there a way to pass a rust function as a function pointer to a c function? I started working on converting rust_log.cpp to rust (https://github.com/mozilla/rust/issues/8703) but it seems this would require passing a rust function to iter_crate_map. 
[21:28:58] <kmc> you can pass an extern "C" fn for sure
[21:29:12] <fhahn> I tried: https://gist.github.com/fhahn/6370037
[21:29:13] <pnkfelix> chandler: you may have already seen this: Will posts here that even languages with a particular eval-order specified can still get some benefit (if they can determine purity).  So that seems to basically cede the point to what pcwalton said earlier.
[21:29:16] <brson> fhahn: i'd suggest just rewriting iter_crate_map at the same time
[21:29:18] <pnkfelix> chandler: http://compilers.iecc.com/comparch/article/97-05-210
[21:29:19] <kmc> an ~fn or &fn might have free variables and so can't be converted directly
[21:29:58] *** Joins: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[21:31:30] <strcat> you could make a function taking a pair of pointers and calling it as a closure
[21:31:48] <strcat> and then pass it to C
[21:31:59] * strcat shrugs
[21:32:07] <chandler> pnkfelix: Aha.
[21:32:07] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr)
[21:32:21] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[21:36:23] <fhahn> strcat: pass the closure to the c function?
[21:36:37] <strcat> as the user_data param
[21:36:52] <strcat> then in the actual function, call it
[21:36:53] <kimundi> strcat: Do you think advance has an future as an iterator adapter?
[21:37:01] <strcat> kimundi: not really
[21:39:24] <kimundi> strcat: I just tried to do .advance(println); as a quick debug output, that fell flat because it uses the bool-iterator protocol, so I'm wondering if it makes sense to change it to just iterate until the end
[21:39:37] <strcat> I don't think it makes to have it at all
[21:39:44] <strcat> there's the for loop for that
[21:39:48] <strcat> and fold
[21:40:14] *** Joins: eskatrem (user@moz-16BE768E.dyn.user.ono.com)
[21:40:35] <eskatrem> hey, is it possible to have the main function accept arguments?
[21:40:49] <kimundi> eskatrem: os::args()
[21:40:56] <kimundi> rusti: os::args()
[21:41:00] -rusti- pastebinned 11 lines of output: http://ix.io/7Eu
[21:41:06] <eskatrem> kimundi: thanks, I'll try
[21:41:19] <kimundi> rusti: ::std::os::args()
[21:41:20] -rusti- ~[~"./out"]
[21:41:40] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[21:41:44] *** Joins: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu)
[21:42:22] <tjc> Is anyone else having problems after rebasing off master, specifically because libuv won't build?
[21:42:33] <tjc> I deleted my build directory, ran `git submodule update` and sync repeatedly, but...
[21:42:35] <olsonjeffery> tjc: yes. lots of people, heh.
[21:42:37] <olsonjeffery> acrichto: ^
[21:42:44] <tjc> olsonjeffery: is there a workaround?
[21:42:54] <kimundi> strcat: It would be super usefull if rusti could somehow print a one line error summary :P "error: unresolved name; pastebinned 11 lines here: URL"
[21:42:55] <acrichto> tjc: what's the error?
[21:43:06] <tjc> acrichto: will gist it, 1 sec
[21:43:29] <tjc> acrichto: https://gist.github.com/catamorphism/6371725
[21:43:49] *** Quits: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu) (Ping timeout)
[21:43:49] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:43:54] <acrichto> what, how did that ever build period
[21:44:01] <pnkfelix> tjc: Issue #8826
[21:44:23] *** Joins: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu)
[21:44:26] <tjc> pnkfelix: Thanks
[21:44:31] <pnkfelix> tjc: acrichto and I are both looking into it
[21:44:34] <acrichto> tjc: wait do you have uv.h somewhere else on your systeM?
[21:44:37] <tjc> pnkfelix: Ok, great
[21:44:43] <tjc> acrichto: maybe, I'll check
[21:44:53] <acrichto> I think it may be  picking up the old uv.h header instead of the new one
[21:45:14] <tjc> acrichto: where do you think it would be? nothing in /usr/include or /usr/local/include
[21:45:38] <acrichto> find / -name uv.h 2> /dev/null  :)
[21:46:21] <tjc> acrichto: ok :-) waiting for that to finish
[21:46:24] <pnkfelix> or use whatever the appropriate flag to cc .. -H or whatever
[21:46:53] <pnkfelix> (to make it print out the headers it pulls in)
[21:47:14] <acrichto> oh I didn't know that was even a thing, that's convenient
[21:47:27] *** Quits: tikue_ (tkuehn@moz-BE1EFE7F.wv.cc.cmu.edu) (Quit: tikue_)
[21:47:42] <pnkfelix> acrichto: Yeah its super important for debugging certain kinds of problems, like #include issues
[21:48:07] <pnkfelix> acrichto: where the include guards can cause things to work out in ways you didn't expect
[21:48:32] <tjc> acrichto: well, I have uv.h in /usr/local/Cellar/node/0.6.15/include/node and in my other Rust workspaces, of course‚Ä¶ but I don't think it would be looking in there
[21:48:56] <acrichto> that's not symlinked by homebrew into /usr/local/include ?
[21:48:59] <fhahn> strcat: you mean pass the closure as *u8?
[21:49:03] <acrichto> oh wait that's node anyway nvmd
[21:49:07] <tjc> acrichto: Yeah
[21:49:32] <acrichto> tjc: if you cd into src/libuv, what's the revision at?
[21:49:33] <olsonjeffery> i guess i should be grateful that the build appears to be working w/o complaint for me on a fresh ubuntu install
[21:49:51] <brson> acrichto: the new libuv also doesn't build on os x 10.6, but the error seems pretty minor
[21:49:55] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[21:49:55] <strcat> fhahn: a C function taking a callback will take (void (*foo)(void *), void *user_data) at a minimum
[21:49:58] <acrichto> :(
[21:50:03] <tjc> acrichto: the revision is dfae9c3e958dc086d9c0ab068cd76d196c95a433
[21:50:11] <strcat> so to wrap it, you write a function accepting a closure as the user_data parameter
[21:50:12] <acrichto> tjc: that's not what it should be
[21:50:14] <strcat> and calling it
[21:50:28] <tjc> acrichto: hmm, ok. I already ran git submodule update and git submodule sync -- is there something else?
[21:50:29] <acrichto> tjc: did you accidentally commit an update to the uv module locally?
[21:50:31] <strcat> the wrapper passes that function as foo, and the closure it accepts as user_data
[21:50:34] <tjc> acrichto: let me see...
[21:50:46] <pnkfelix> acrichto, tjc: I've often had to blow away the libuv/ dir.  I don't think our build logic for updating it is robust.
[21:50:53] <tjc> acrichto: Oops, it was that again
[21:50:53] * strcat has had to do this 100 times with C++ lambdas, not yet in rust :)
[21:50:54] <acrichto> you can't git blame a submodule :(
[21:50:56] <tjc> *facepalm*
[21:51:04] <acrichto> pnkfelix: can you check as well?
[21:51:22] <pnkfelix> acrichto: If the libuv is out of sync?  Okay.
[21:51:27] *** Joins: tikue_ (tkuehn@moz-BE1EFE7F.wv.cc.cmu.edu)
[21:51:40] <acrichto> pnkfelix: only if you accidentally committed an update to libuv that brought it out of sync
[21:51:50] <pnkfelix> acrichto: I've almost certainly not done that.
[21:52:28] <pnkfelix> acrichto: src/libuv git log ‚àí1 : ef2bcd134164adcaa072dcb56e62b737fdcb075e
[21:52:47] <acrichto> oh ok, that's correct
[21:52:52] <pnkfelix> acrichto: (its your patch from yesterday)
[21:53:02] <acrichto> and the mk/rt.mk patch didn't help you?
[21:53:26] <olsonjeffery> yay, finally rebased and back in good shape.
[21:53:33] <pnkfelix> acrichto: No.  But I'm re-running it now with VERBOSE=1 and 'remake -j1 ‚Äîtrace', because it *seemed* like it should work.
[21:53:38] <olsonjeffery> now everyone else stop working in rt::io :P
[21:53:42] <tikue_> rusti: use std::hashmap::HashMap; let mut foo = HashMap::new(); foo.insert(0u, "zero"); foo
[21:53:45] -rusti- pastebinned 1 lines of output: http://ix.io/7Ev
[21:53:54] <pnkfelix> acrichto: So I'm hoping from that I'll be able to figure out how gyp_uv is being invocked.
[21:54:02] <ecr> olsonjeffery: nah, I'm going to go break it all :P
[21:54:09] <acrichto> pnkfelix: do you have gyp installed elsewhere?
[21:54:27] <pnkfelix> acrichto: Not according to `which`
[21:54:35] <olsonjeffery> D:<
[21:54:35] <acrichto> good enough for me
[21:54:40] <ecr> olsonjeffery: what are you rebasing anyway?
[21:55:02] <olsonjeffery> ecr: more file io work
[21:55:03] <olsonjeffery> adding stat
[21:55:10] <olsonjeffery> and fleshing out a FileInfo trait impl'd on Path
[21:55:20] <pnkfelix> acrichto: unfortunately i still have ccache disabled, and the build attempts to build LLVM before libuv
[21:55:22] <olsonjeffery> as the gateway into creating FileStreams and so on
[21:55:31] <pnkfelix> acrichto: maybe we should switch that order while libuv is under dev.  :)
[21:55:39] <olsonjeffery> ecr: i have a gist for it.. one moment
[21:55:56] <olsonjeffery> ecr: https://gist.github.com/olsonjeffery/6344357
[21:56:00] <acrichto> pnkfelix: try running make rt/x86_64-apple-darwin/stage0/libuv/libuv.a
[21:56:04] <acrichto> that shouldn't bulid llvm
[21:56:24] <olsonjeffery> ecr: the by-val self methods will probably become &self, based on discussion w/ brson
[21:56:33] <pnkfelix> acrichto: I'd rather just wait it out at this point.  I'd rather wait for the full transcript to analyze
[21:56:54] <olsonjeffery> and its only gonna be impl'd on Path, not PathLike and FileStream (which i thought would've been nice, but oh well)
[21:56:57] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[21:57:11] <ecr> neat
[21:57:33] <tikue_> i want to write a macro that takes a hashmap and a key and inserts a default value
[21:57:36] <tikue_> what should i call it
[21:58:52] <ecr> olsonjeffery: what's brson's reasoning for the &self and restricting it to Path?
[21:59:45] <ecr> tikue_: initialize_with_default ?
[22:00:19] <tikue_> ecr: well since the default is a constant, i'm gonna do init_<default> where default= the actual thing
[22:00:23] <tikue_> init_vec
[22:00:24] <tikue_> for example
[22:01:19] <ecr> make a macro that takes the default value and generates a macro with the value in the name :P
[22:01:28] <ecr> which then inserts it...
[22:01:43] <tikue_> lol
[22:01:47] <tikue_> :P
[22:02:06] <tikue_> let's not beat around the bush and just write a macro that writes the macro that generates the default macro
[22:03:04] <tikue_> what i really want to do is insert a default value into a hashmap for each variant of an enum
[22:03:09] <tikue_> so what i really want is an enum iterator
[22:03:11] *** Joins: sevvie (sevvierose@moz-8BC5868E.hfc.comcastbusiness.net)
[22:03:15] <ecr> magic! the macro that just does whatever you want, but only if you wish hard enough. type errors are a result of you not wishing hard enough.
[22:03:26] <olsonjeffery> ecr: ill let brson speak for himself.
[22:03:35] <tikue_> for varient in enum.iter() { my_hashmap.insert(enum, default); }
[22:03:46] <olsonjeffery> and the &self is something that i implied as being neccesary (for the sake of reusability) as a result of restricting the trait impl to Path
[22:03:50] <tikue_> for variant in enum.iter() { my_hashmap.insert(variant, default); }
[22:03:52] <tikue_> ^
[22:03:56] <tikue_> tell me how to do that pls :)
[22:04:14] <olsonjeffery> part of it was `let file_stream = "/some/path.txt".open(Create);` being too magical, i believe
[22:04:32] <tikue_> rusti: enum Foo { Bar, Baz } Foo::iter()
[22:04:35] <pnkfelix> tikue_: Maybe make a macro that defines the enum iterator alongside the enum definition?
[22:04:35] -rusti- pastebinned 11 lines of output: http://ix.io/7Ex
[22:04:42] <olsonjeffery> also having FileInfo impl'd atop FileStream seemed weird/wrong, i guess... 
[22:04:45] <tikue_> pnkfelix: i would love to write that macro. but how?
[22:05:02] <pnkfelix> tikue_: I bet I can whip it up.  Give me a sec.
[22:05:05] <olsonjeffery> and using by-val self for those methods would only really work if you had a working notion of only having one "active" stream for a file at a time
[22:05:18] <olsonjeffery> whether its a PathLike or a FileStream as the underlying impl
[22:06:18] <tikue_> pnkfelix: you're the bomb
[22:06:21] <olsonjeffery> so if you went `let fi = "/some/path";let stat fi.stat(); let stream = fi.create(); // fi gets consumed, here`
[22:06:58] <olsonjeffery> then `let read_stream = stream.open(Open, Read); // stream gets consumed at this point.. the fd is uv_close()'d then re-opened with different perms
[22:07:08] <olsonjeffery> so you go PathLike->FileStream->FileStream
[22:07:35] <olsonjeffery> all the while, throughout the transitions you have access to the FileInfo methods on any of those underlying impls..
[22:07:53] <fhahn> strcat: thanks I'll try tomorrow
[22:08:23] <ecr> hm. I think I'd need to delve a bit into file i/o before I can really have an informed opinion 
[22:09:04] <olsonjeffery> it's not a big deal, tbh. mostly i thought it was a pretty clever api. but clever isn't neccesarily what's best or most intuitive.
[22:09:51] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[22:10:28] *** Quits: huseby (huseby@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving)
[22:10:46] <strcat> pnkfelix: tikue_: technically we *do* have the machinery to visit fields or variants
[22:10:51] <strcat> but it's a huge pain to use
[22:10:59] <strcat> repr uses it (fmt's %?)
[22:11:03] <olsonjeffery> will possibly add a DirectoryInfo that'll work similarly to FileInfo, but with guards that would raise a condition if the underlying Path is a regular file.
[22:11:16] <strcat> but if you wanted you could make an iterator like that
[22:11:17] <tikue_> strcat: more of a pain than inserting a default value for 12 enum variants into a hashmap?
[22:11:22] <strcat> well not really an iterator
[22:11:29] <strcat> it couldn't be lazy
[22:11:44] <strcat> tikue_: well more of a pain if you're not going to do it 2000+ times
[22:11:46] <strcat> ;p
[22:11:49] <olsonjeffery> although, curiously, in the .net api FileInfo/DirectoryInfo have to be valid if the path doesn't exist
[22:11:57] <strcat> you'll need to define a whole huge TyVisitor implementation
[22:12:03] <tikue_> ah >_<
[22:12:03] <olsonjeffery> so you can do info.Create(); // in c#
[22:12:04] <strcat> and probably run it in a task with TLS for state
[22:12:10] <tikue_> o lawd
[22:12:35] <olsonjeffery> but doing file_info.create() on an already created diretory would be an error (as would it be for an already existant file) ..
[22:12:39] <olsonjeffery> blah blah.
[22:12:40] <zol> Can structs have static fields? 
[22:12:48] <tikue_> zol: what do you mean by static
[22:12:52] * olsonjeffery shuts up.
[22:12:53] <tikue_> zol: immutable?
[22:13:07] <zol> tikue_: I mean, all structs share the same instance of that field?
[22:13:11] <strcat> no
[22:13:12] <tikue_> ohh
[22:13:26] <eskatrem> hey, is there an example to use the function each_char ?
[22:13:36] <tikue_> eskatrem: what version of rust?
[22:13:44] <tikue_> and i assume you mean for a string?
[22:13:53] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[22:13:56] <pnkfelix> oh wait, maybe this is not so easy‚Ä¶ we still don't allow macros to expand into multiple items, do we?
[22:13:57] <ecr> olsonjeffery: a lot of existing apis don't always make much sense. there's a lot of "well we've always done it this way"
[22:14:01] <eskatrem> tikue: rust 0.8-pre (ce27752 2013-08-26 11:46:13 -0700)
[22:14:07] <eskatrem> and yes, for a string
[22:14:20] <zol> strcat: Hm, darned. Thanks. Do you know, on the top of your head, how I could accomplish something like that? I could make a static "getter" function instead, right? 
[22:14:20] <tikue_> rusti: let s = "abcdefg"; for char in s.iter() { printfln!(char); }
[22:14:22] -rusti- pastebinned 8 lines of output: http://ix.io/7EB
[22:14:30] <tikue_> eskatrem: ^
[22:14:30] <zol> strcat: in the "impl" of my struct? 
[22:14:32] <eskatrem> s.iter()...
[22:14:37] <ecr> personally, I'd rather go with something better than familiar, but I'd probably get overruled.
[22:14:41] <olsonjeffery> ecr: well, in this case, the desire is to model a pretty decent API (the .net System.IO api around file/directory manipulate)
[22:15:01] <eskatrem> tikue: is there a way to know that without asking here? the online doc seemed deprecated
[22:15:14] <olsonjeffery> imo, it's pretty decent (especially when stacked up against what's in the java standard library)
[22:16:26] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:17:07] <tikue_> eskatrem: the documentation is pretty shoddy right now, so #rust is definitely best place to go if the docs fail you (which they probably will a decent amount of the time). that being said...
[22:17:29] <tikue_> eskatrem: http://static.rust-lang.org/doc/std/str.html 
[22:17:53] <eskatrem> tikue: yep, I went there before asking here
[22:17:56] <tikue_> eskatrem: that lists iter has a function. however the for loop syntax itself isn't listed anywhere, afaik
[22:18:06] <pauls> pnkfelix: correct
[22:18:37] <tikue_> std::iterator is very helpful too eskatrem 
[22:18:52] <pnkfelix> pauls: any standard current workarounds?  E.g. expanding into a mod ?
[22:18:53] <strcat> zol: well there are static methods
[22:18:58] <strcat> just leave out the self paramter
[22:19:01] <eskatrem> tikue_: yes, thanks for the tipe
[22:19:01] <strcat> parameter*
[22:19:05] <eskatrem> tip
[22:19:21] <pauls> pnkfelix: I think so; I don't remember how one makes that work with import/export rules.
[22:19:22] <strcat> there's an iterator tutorial
[22:19:45] <strcat> it is pretty good if I may say so myself :P, just needs to be more comprehensive
[22:19:52] <zol> strcat: Right, forgot, thanks!
[22:19:56] <bjz> rusti: fn foo() -> &'self str { "hi" } foo()
[22:19:57] -rusti- error: internal compiler error: unexpected failure
[22:19:57] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[22:19:57] -rusti- note: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues
[22:19:57] -rusti- application terminated with error code 101
[22:20:04] <bjz> :/
[22:20:04] *** Joins: trevs (trevor@moz-5080A02E.mc.videotron.ca)
[22:20:06] <strcat> eskatrem: http://static.rust-lang.org/doc/tutorial-container.html#iterators
[22:20:15] <eskatrem> actually, I guess the real way for me to learn how to iterate on te char of a string would be to f*ing man up and read the source of rustc
[22:20:20] <bjz> rusti: fn foo() -> &'static str { "hi" } foo()
[22:20:21] -rusti- "hi"
[22:20:26] <strcat> bjz: well, you can't have 'self there ;p
[22:20:27] *** flaper87 is now known as flaper87|afk
[22:20:33] <strcat> generally with 'self you get an ICE instead of an error
[22:20:39] *** Joins: SingingBoyo (brandon@4DF3381A.51F4D838.4F048BDC.IP)
[22:20:40] <tikue_> eskatrem: the source has a lot of tests that help explain how to use the functions and such
[22:20:47] <tikue_> at the bottom of each .rs file basically
[22:20:57] <bjz> strcat: I guess it's going to be removed anyway
[22:21:18] <eskatrem> tikue_: ok, I will definitely check the test cases before asking
[22:21:19] <pnkfelix> tikue_: okay, i've got it.
[22:22:00] <tikue_> pnkfelix: no way! show me please :)
[22:22:07] <pnkfelix> tikue_: https://gist.github.com/pnkfelix/6372136
[22:22:20] <tikue_> eskatrem: eh, i ask a lot of questions here without checking the tests first‚Ä¶but you're right it's probably the best practice :P
[22:23:09] <pnkfelix> tikue_: As I discussed with pauls, since you cannot expand a macro into multiple items, I had to expand it into a module.  So the macro `enum_with_Iter` takes arguments for the module name (B in the example), the enum name (Bar), the iterator name (iterBar), and the enum variants ({x, y, z}).
[22:23:18] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[22:23:24] <eskatrem> tikue_: I played only very recently with rust, but I find it exciting to play with a language that is been built
[22:23:39] <tikue_> pnkfelix: looking at it now, trying to comprehend what it's doing heh
[22:24:25] <tikue_> pnkfelix: would that compile if at the top of the file you had use B::*
[22:24:27] <pnkfelix> tikue_: The Foo part at the top is just showing you roughly what I was trying to expand into, before I realized I would need to wrap the whole thing into a module.  That's the way I usually write macros: Make a couple examples of the expanded versions first.
[22:24:39] <tikue_> ahhh ok, that's what i thought, good to know
[22:25:11] <tikue_> thanks so much! that's really cool
[22:25:34] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[22:25:40] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[22:25:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/xp_iHw
[22:25:40] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[22:25:53] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:26:31] <pnkfelix> tikue_: Hmm.  Moving the `use B::*` to the top of the file makes it fail to compile; it says the import is unresolved.  Maybe it attempts to process the topmost `use` prior to macro expansion?  Not sure.
[22:26:41] *** Quits: XyMa (user@4F5647EE.12FF1288.B4C97B2.IP) (Ping timeout)
[22:26:55] <tikue_> pnkfelix: what if it's below macro_rules! but outside the fn main()
[22:26:59] <acrichto> the bors queue is the smallest I think I've ever seen it...
[22:27:00] <kmc> are struct fields in memory always in the same order as the definition (even in cases where the C ABI does not apply)?
[22:27:14] <ecr> kmc: I think so
[22:27:25] <pnkfelix> tikue_: No, there are strict rules about where `use` directives can occur.
[22:27:30] <tikue_> ahh i see
[22:27:38] <ecr> my understanding is that structs are laid out as they would be in C
[22:27:40] <tikue_> good to know
[22:28:14] <pnkfelix> tikue_: If it really bothers you, I think the easy work around is to put all the stuff after the macro definitions into their own module.
[22:28:24] <strcat> kmc: in cases where an ABI is not relevant, LLVM can and will do whatever it wants
[22:28:34] <strcat> although it won't actually reorder them, it will just split them into scalars
[22:28:34] <pcwalton> error: aborting due to 196 previous errors
[22:28:35] <pcwalton> whee
[22:28:43] <tikue_> pcwalton: what are you doing
[22:28:53] <pcwalton> converting fold to use default methods instead of @fn structs
[22:28:58] <pnkfelix> acrichto: ‚Ä¶ ummm ‚Ä¶ now rust builds successfully with your patch
[22:28:58] <strcat> kmc: there's an SROA pass (scalar replacement of aggregates) when it can determine the layout doesn't matter
[22:29:17] <tikue_> fold? like iter().fold() or something else?
[22:29:19] <pnkfelix> acrichto: ‚Ä¶ I'll make another note on #8826
[22:29:22] <pcwalton> AST folding
[22:29:25] <tikue_> oh ok ok
[22:29:26] <pcwalton> mainly used by the macro expander
[22:29:27] <acrichto> pnkfelix: yay! I mapped x86_64 => x64 and i686 => ia32 for gyp
[22:29:44] <zalzane> will rust 1.0 be freezing the syntax?
[22:29:47] <pcwalton> yes
[22:29:51] <tikue_> what do you derive for IterBytes
[22:30:13] *** Joins: fread2281 (zcarterc@moz-CB181B42.dia.static.qwest.net)
[22:30:21] <tikue_> IterBytes presumably :P
[22:30:23] * strcat sees 1.0 as meaning any breaking change to the syntax or core libraries would have to be accompanied with an automatic migration tool
[22:30:27] <ecr> well, the syntax could theoretically expand, but there aren't going to be any backwards incompatible changes post 1.0
[22:30:35] <strcat> for some definition of "core libraries" :P
[22:30:39] <strcat> (not all of libstd)
[22:30:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:30:39] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/z4e5TA
[22:30:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:30:41] <doomlord> will backwards compatable syntax changes still be possible after 1.0
[22:30:43] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[22:30:43] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/eEuRUA
[22:30:43] <ghrust> 13rust/06auto 14e9f6f3f 15Ben Blum: Parse and reserve typeof keyword. #3228
[22:30:43] <ghrust> 13rust/06auto 1402f93ca 15Ben Blum: Emit a better error for attempted unsafe-pointer-self. Close #8306.
[22:30:43] <ghrust> 13rust/06auto 147971c46 15bors: auto merge of #8718 : bblum/rust/typeof, r=pcwalton...
[22:30:45] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[22:31:03] <zalzane> poor little python
[22:32:47] <kmc> rusti: "foo" "bar"
[22:32:47] -rusti- <anon>:5:15: 5:20 error: expected one of `; }` but found `"bar"`
[22:32:47] -rusti- <anon>:5          "foo" "bar"
[22:32:47] -rusti-                         ^~~~~
[22:32:48] -rusti- application terminated with error code 101
[22:33:02] <kmc> in C those would get glued together; anything similar in Rust? for multi-line string literals in particular
[22:33:29] <pcwalton> how do I map_consume an option?
[22:33:55] <sp3d> kmc: "foo \" (newline) "bar" or something similar works
[22:33:59] <ecr> kmc: strings in Rust are already multi-line. you can end the line with a \ to ignore whitespace (and thus the newline)
[22:34:01] <pnkfelix> pcwalton: FYI, I dont know if Niko already mentioned this to you; there is only one client of oldvisit left, but the associated port causes odd problems: https://github.com/mozilla/rust/issues/8791
[22:34:08] <ecr> pcwalton: i believe the current name is map_move
[22:34:22] <pcwalton> wat
[22:34:41] <pcwalton> well, I'll need to fix that at some point
[22:34:50] <pnkfelix> or someone will need to, in any case.  :)
[22:35:02] <ecr> rusti: "hello
[22:35:02] <ecr> world"
[22:35:03] -rusti- <anon>:7:19: 7:20 error: unknown start of token: ?
[22:35:03] -rusti- <anon>:7     println(fmt!("%?", r))
[22:35:03] -rusti-                             ^
[22:35:03] -rusti- application terminated with error code 101
[22:35:12] <ecr> rusti: "hi"
[22:35:13] -rusti- "hi"
[22:35:24] <ecr> rusti: "hello \
[22:35:24] <ecr> world"
[22:35:24] -rusti- <anon>:7:19: 7:20 error: unknown start of token: ?
[22:35:24] -rusti- <anon>:7     println(fmt!("%?", r))
[22:35:24] -rusti-                             ^
[22:35:25] -rusti- application terminated with error code 101
[22:35:39] <ecr> hm, rusti doesn't seem to like multi-line strings very much
[22:35:42] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:35:59] <strcat> ecr: it treats a single irc message as the block
[22:36:12] <ecr> oh
[22:36:56] <pcwalton> the IRC protocol doesn't like multiline strings :)
[22:37:08] <pcwalton> there is still no escaping mechanism in 2013 I don't believe
[22:37:45] <pnkfelix> its like an poor man's approach to tweeting
[22:38:08] <tikue_> lol
[22:38:13] <ecr> poor? I have infinity characters! take that twitter!
[22:38:26] <benh> more like somewhat short of 512 characters :)
[22:38:37] <SingingBoyo> Well to be fair, why would a chat protocol need a newline escaping mechanism?
[22:38:49] <tikue_> because see above ^
[22:38:49] <tikue_> :P
[22:38:51] *** Joins: eholk (eholk@moz-F70D5031.hsd1.in.comcast.net)
[22:38:53] <strcat> every letter in the channel name reduces the size of messages you can send by 1 letter
[22:38:55] <strcat> for real
[22:38:55] <kmc> i worked at a startup making a chat product and we argued about this for basically infinite time
[22:39:09] <tikue_> lol
[22:39:30] <kmc> Zephyr (used mainly at MIT) is realtime chat but it has a culture of writing multi-line, even multi-paragraph messages
[22:39:46] <pnkfelix> ah, i kind of miss zsigs
[22:39:47] <kmc> basically due to the behavior of the most popular client
[22:39:49] <kmc> :)
[22:39:52] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Ping timeout)
[22:40:00] <benh> All chat products I can think of that aren't irc or some videogame-integrated chats allow multiline messages :(
[22:40:22] <zalzane> man there was this bot in a channel i used to frequent
[22:40:30] <zalzane> it had a javascript code evaluator
[22:40:37] <zalzane> nothing was sanitized
[22:40:43] <tikue_> rofl
[22:40:52] <zalzane> i got it to print \r\nQUIT\r\n and it quit and rejoined when it detected disconnect
[22:40:52] <tikue_> what kinda hijinks could you get into
[22:40:57] <tikue_> lol
[22:41:14] <zalzane> then i joined #cpp on freenode
[22:41:24] <zalzane> and asked them about automated memory management
[22:41:24] <benh> geordi :)))
[22:41:43] *** Parts: Defiler (wilson@moz-5531C57F.wb78.net) ()
[22:42:51] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[22:43:30] <Thiez> brson: when I run rustray on multiple cores I seem to get a lot of variation in performance, is there any reason the new runtime might act that way?
[22:43:37] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[22:44:13] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:45:03] <Thiez> for instance a few weeks ago rustray got 100% cpu on all of my 4 cpus, these days it seems to be somewhere between 60% and 100% per core
[22:46:00] <fread2281> Is extra::term the right place for a full terminal library? io::stdin,stdout seem inadequate due to input having special keys and output having cursor position. So I want to add IO handling to extra::term. Is this the right thing to do?
[22:46:19] <doomlord> http://scottjones.me/?p=116 <<< interesting article on an issue that drives me to rust
[22:46:34] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:47:06] <tjc> brson: r? https://github.com/mozilla/rust/pull/8831
[22:47:29] <fread2281> also are there any issues about expanding extra::term?
[22:47:44] <pnkfelix> doomlord: of course its not like we have tooling like this in place ...
[22:48:47] <doomlord> impl :)
[22:49:15] <strcat> tooling as in autocompletion
[22:49:41] <doomlord> yeah one half but not the other, i gues
[22:49:53] <doomlord> but nothing in theory precludes the autocomplete
[22:49:59] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[22:51:14] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[22:51:26] <doomlord> i think rust will get decent autocomplete before c++ gets extention methods
[22:51:54] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[22:52:22] <pnkfelix> for emacs, at least.  :)
[22:52:47] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:52:52] *** Joins: enix (enix@moz-3BC5FE84.hsd1.md.comcast.net)
[22:53:34] <adridu59> does android fall under #[cfg(unix)] ?
[22:53:46] <tikue_> rust's syntax highlighting for vim is a bit screwy
[22:54:11] <tikue_> rusti: enum Foo { Bar /* this is white */ , Baz(uint) /* this is blue */ }
[22:54:12] -rusti- ()
[22:55:01] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:55:21] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[22:55:32] <strcat> tikue_: works fine here
[22:55:35] <brson> Thiez: i don't know off hand why rustray wouldn't be underutilizing cores, though I imagine it's some kind of starvation issue due to the nature of your workload. I'm interested in test cases that perform badly. I generally expect cpu utilization in the new scheduler to be better than the old.
[22:55:42] <brson> i'm glad someone's maintaining rustray
[22:55:53] <tikue_> strcat: ah maybe i haven't updated mine recently
[22:55:54] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:55:56] <tikue_> where is it stored again?
[22:56:02] <strcat> src/etc/vim
[22:56:05] <tikue_> thx!
[22:56:08] <brson> Thiez: I'll put some time into fixing the worst cases in the scheduler next week after I finish doing some http work
[22:56:11] * strcat just has that stuff as part of his rust packages
[22:56:32] *** Quits: enix (enix@moz-3BC5FE84.hsd1.md.comcast.net) (Ping timeout)
[22:56:36] *** Joins: enix (enix@moz-3BC5FE84.hsd1.md.comcast.net)
[22:56:38] <brson> adridu59: yes
[22:56:39] <adridu59> where are preprocessor directives defined?
[22:56:59] *** Quits: eskatrem (user@moz-16BE768E.dyn.user.ono.com) (Client exited)
[22:57:02] <adridu59> (or its doc)
[22:57:05] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[22:57:37] <brson> adridu59: cfg values are defined in various places but the defaults are here https://github.com/mozilla/rust/blob/master/src/librustc/driver/driver.rs#L67
[22:57:53] <tikue_> strcat: what do you mean as part of your rust package?
[22:58:25] <tikue_> it's still broken for me *shrug*
[22:58:32] <tikue_> not broken but inconsistent
[22:58:37] <strcat> definitely works here on that example
[22:58:43] <adridu59> thanks brson
[22:59:15] <strcat> vim 7.4.0 and the vim files from yesterday
[22:59:25] <tikue_> strcat: http://imgur.com/oj0covS
[22:59:30] <tikue_> with gim
[22:59:31] <tikue_> gvim
[22:59:45] <strcat> tikue_: oh that's normal, it's because there's an inaccurate function detection regexp
[23:00:00] <strcat> it thinks TimeMsg is a function
[23:00:05] <tikue_> yeah i assumed that was why
[23:00:13] <tikue_> is it fixable?
[23:00:21] <strcat> I was against turning it on because I don't think it is :s
[23:00:26] <tikue_> ah :\
[23:00:28] <strcat> it was always around but never on
[23:00:46] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Quit: Leaving.)
[23:01:31] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[23:02:24] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[23:02:40] <tikue_> is there a way to search commit history for a particular file changed
[23:02:55] <maik> sebcrozet, <3
[23:03:10] <tjc> tikue_: you can do git log whatever.rs and that shows you the history only for that file
[23:03:15] <tjc> or git log -p if you want details
[23:03:19] <tjc> not sure if that's what you're looking for
[23:03:19] <tikue_> ah awesome, thank you
[23:03:23] <strcat> there's also --follow
[23:03:25] <tikue_> that is exactly what i'm looking for :)
[23:03:29] <strcat> to do fuzzy tracking of file moves
[23:03:30] <tjc> cool :-)
[23:03:47] <strcat> since we renamed the libs a few times ;p
[23:05:22] *** Quits: wilkie (wilkie@moz-CEF5E490.pitbpa.fios.verizon.net) (Ping timeout)
[23:06:15] *** Quits: Jesin (Jessin_@moz-5E8F07BF.cc.lehigh.edu) (Quit: Leaving)
[23:07:07] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[23:09:46] *** Joins: wilkie (wilkie@moz-CEF5E490.pitbpa.fios.verizon.net)
[23:11:36] <ecr> why do the vector iterator methods take self by value?
[23:12:00] <engla> ecr: a vector slice is small and copyable
[23:12:24] <engla> ecr: it copies implicitly
[23:12:53] <strcat> ecr: you mean all iterator adaptors?
[23:12:59] <strcat> they take self by-value so they can chain
[23:13:17] <strcat> you can write a by_ref adaptor
[23:13:21] <ecr> no, things like ImmutableVector::iter
[23:13:21] <engla> I assumed it was about   fn iter(self) -> VecIterator<'self, T>;
[23:13:32] <engla> self is a &[T] there ecr.
[23:13:37] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[23:14:07] <ecr> I guess engla's answer makes sense. I was thinking it was copying the whole vector or something, which just seems inefficient for immutable iterators and simply wrong for mutable ones
[23:14:34] <engla> a slice is just a pointer + a lenght. no need to make a pointer to that pointer
[23:14:44] *** Quits: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu) (Ping timeout)
[23:15:57] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[23:17:50] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[23:19:05] <adridu59> how would I go about tagetting unix but not android? I suppose: #[cfg(unix)] #[cfg(not(android)] ?
[23:20:36] <tikue_> rusti: enum Foo { Bar(uint), Baz } Bar(1u) == Bar(*)
[23:20:36] -rusti- <anon>:5:53: 5:54 error: unexpected token: `)`
[23:20:36] -rusti- <anon>:5          enum Foo { Bar(uint), Baz } Bar(1u) == Bar(*)
[23:20:36] -rusti-                                                               ^
[23:20:36] -rusti- application terminated with error code 101
[23:20:48] <tikue_> rusti: enum Foo { Bar(uint), Baz } Bar(1u) == Bar(_)
[23:20:48] -rusti- <anon>:5:52: 5:53 error: unexpected token: `_`
[23:20:48] -rusti- <anon>:5          enum Foo { Bar(uint), Baz } Bar(1u) == Bar(_)
[23:20:48] -rusti-                                                              ^
[23:20:48] -rusti- application terminated with error code 101
[23:20:48] <acrichto> adridu59: #[cfg(a)] #[cfg(b)] == a or b, #[cfg(a, b)] == a and b
[23:21:24] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:21:46] <adridu59> acrichto: is there a not directive?
[23:21:54] <acrichto> adridu59: yes
[23:22:11] <adridu59> acrichto: does it look like what I wrote?
[23:22:18] <acrichto> yep
[23:22:26] <adridu59> acrichto: ok, thank you!
[23:22:35] <acrichto> np :)
[23:23:15] *** Joins: huseby (huseby@8F761026.B5EF4AF6.E96CA9D8.IP)
[23:23:43] *** Quits: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr) (Quit: Gone)
[23:25:33] *** Joins: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu)
[23:25:52] *** Quits: jmgrosen (jmgrosen@moz-BF80C818.sbcc.edu) (Quit: jmgrosen)
[23:30:17] *** Quits: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de) (Client exited)
[23:31:12] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[23:31:42] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[23:32:07] <brson> adridu59: I don't think 'android' is a defined cfg though. #[cfg(unix, not(target_os = "android")] may be what you want
[23:33:56] *** kimundi is now known as zz_kimundi
[23:36:20] <tikue_> is there a way to enforce iteration order of a hashmap?
[23:37:34] <acrichto> tikue_: if you want a pre-defined ordering, you'd probably want to use TreeMap
[23:37:48] <tikue_> acrichto: oh ok thank you
[23:37:51] <acrichto> HashMap iteration depends on the hash keys its created with along with the insertion order of keys
[23:37:54] <adridu59> brson: :)
[23:38:12] *** Joins: mib_9uybip (mib_9uybip@95879FC5.102D9800.D35A31DF.IP)
[23:38:17] <tikue_> acrichto: how does TreeMap define the order?
[23:38:34] <acrichto> tikue_: the keys are require to implement Ord (or maybe TotalOrd, I forget)
[23:38:40] <engla> TotalOrd
[23:38:56] <acrichto> it's a balanced binary tree so they're iterated smallest-to-largest as defined by your ordering
[23:38:57] *** Quits: sp3d (a@moz-6F12212B.fidnet.com) (Ping timeout)
[23:38:59] <tikue_> acrichto: ahhh great, and then it iterates in ordeR?
[23:38:59] <acrichto> of the keys
[23:39:02] <tikue_> wonderful thanks!
[23:39:47] *** Quits: mib_9uybip (mib_9uybip@95879FC5.102D9800.D35A31DF.IP) (No route to host)
[23:39:53] *** Joins: mib_9uybip (mib_9uybip@95879FC5.102D9800.D35A31DF.IP)
[23:40:30] <mib_9uybip> hello
[23:40:36] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:40:36] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/eEuRUA
[23:40:36] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:41:03] <mib_9uybip> I have a question about the number reader methods in std::rt::io::extensions::ReaderByteConversions
[23:41:34] <mib_9uybip> read_u8 returns 0 if it can't read the byte
[23:41:46] <mib_9uybip> and the other multi-byte methods are based on readPu8
[23:41:47] <tikue_> why can't TotalOrd be derived for c-like enums?
[23:41:53] <mib_9uybip> sorry on read_u8
[23:42:16] <mib_9uybip> so if I read_be_u64 but it can't read 8 bytes, it'll just silently return the wrong value
[23:42:35] <pcwalton> mismatched types: expected `@mut @mut ext::base::MapChain<uint,ext::base::Transformer>` but found `@mut @mut @mut ext::base::MapChain<uint,ext::base::Transformer>`
[23:42:45] * pcwalton really doesn't understand how macro expansion works
[23:42:47] <pcwalton> @mut @mut @mut?
[23:42:51] <tikue_> lol
[23:43:05] <sfackler> mib_9uybip: it'll raise an io_error condition first, so it'll only return a bogus value if you trap the condition
[23:43:23] <mib_9uybip> doesn't seem to
[23:43:27] <tikue_> rusti: #[deriving(Eq, TotalOrd)] enum Foo { Bar, Baz }
[23:43:28] <mib_9uybip> read_bytes raises the condition
[23:43:28] -rusti- ()
[23:43:44] <tikue_> rusti: #[deriving(Eq, TotalOrd)] enum Foo { Bar, Baz } Bar < Baz
[23:43:45] -rusti- <anon>:5:57: 5:66 error: binary operation < cannot be applied to type `main::Foo`
[23:43:45] -rusti- <anon>:5          #[deriving(Eq, TotalOrd)] enum Foo { Bar, Baz } Bar < Baz
[23:43:45] -rusti-                                                                   ^~~~~~~~~
[23:43:45] -rusti- error: aborting due to previous error
[23:43:46] -rusti- application terminated with error code 101
[23:43:54] <mib_9uybip> but the various number reader functions are not based on read_bytes
[23:43:57] <tikue_> what does TotalOrd give you
[23:44:58] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[23:45:08] <acrichto> tikue_: .cmp
[23:45:12] <tikue_> ah
[23:45:29] <acrichto> also .equals
[23:45:35] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[23:45:35] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:45:36] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/KwUfWQ
[23:45:36] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:45:36] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:45:36] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/X-CKBw
[23:45:36] <ghrust> 13rust/06auto 144fd1e31 15Brian Anderson: rustc: Fix cstack lint for default methods. Closes #8753
[23:45:36] <ghrust> 13rust/06auto 147147e5e 15bors: auto merge of #8796 : brson/rust/cstack, r=catamorphism
[23:45:37] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:46:17] <mib_9uybip> e.g. MemReader::new(~[]).read_u8() simply returns 0 without raising any condition
[23:46:50] <mib_9uybip> I'm using 0.7 here, but looking at the code on github, it seems to use the same strategy
[23:47:02] *** Joins: wikkit (Mibbit@E8E479CF.380DC9C9.C755526F.IP)
[23:47:18] <mib_9uybip> rusti: std::rt::io::mem::MemReader::new(~[]).read_u8()
[23:47:18] -rusti- <anon>:5:9: 6:5 error: failed to find an implementation of trait std::io::Reader for std::rt::io::mem::MemReader
[23:47:19] -rusti- <anon>:5          std::rt::io::mem::MemReader::new(~[]).read_u8()
[23:47:19] -rusti- <anon>:6     };
[23:47:19] -rusti- application terminated with error code 101
[23:47:24] <acrichto> mib_9uybip: that may be a bug with MemReader
[23:47:25] *** Joins: maik (maik___@moz-7EDF7261.dip0.t-ipconnect.de)
[23:47:31] <sfackler> ah, it looks like MemReader behaves incorrectly
[23:47:41] <sfackler> error handling in rt::io is still in flux
[23:47:49] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[23:47:50] <sfackler> i think the current solution is not super great
[23:47:51] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:48:22] <mib_9uybip> MemReader doesn't implement read_u8 or any other number reader
[23:48:24] <sfackler> I believe the Reader contract states that read only returns None if it raises and handles an io_erorr
[23:48:31] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[23:48:35] <mib_9uybip> they're all implemented in ReaderByteConversions
[23:48:42] <ecr> mib_9uybip: read_byte calls read(), which will raise a condition if it encounters an error. (note that reading nothing is NOT an error). if it doesn't read anything (0 bytes), then it tries again. so, if read_byte returns it either 1) successfully read one byte wrapped in a Some or 2) encountered an error and raised an condition, which you trapped, and returns None.
[23:49:08] <ecr> if it never reads any data, but does not encounter an error, then it will loop forever
[23:49:15] <bjz> lbergstrom: commented on your glfw-rs PR: https://github.com/bjz/glfw-rs/pull/29
[23:49:19] <bjz> jeaye: https://github.com/bjz/glfw-rs/pull/29
[23:49:23] <bjz> :)
[23:50:41] <jeaye> :)
[23:51:00] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:51:13] <bjz> jeaye: should hopefully make things less buggy for you
[23:51:29] <bjz> jeaye: quite a bit more robust
[23:51:30] <jeaye> Things aren't that buggy!
[23:51:35] <bjz> :P
[23:51:39] <jeaye> What I'm blocked on is GL -_-
[23:51:40] <Eridius> well crap. I can't compile master right now
[23:51:43] <bjz> jeaye: ?
[23:51:50] <bjz> jeaye: what's wrong?
[23:52:00] <tikue_> i'm trying to use TreeMap::mutate_values() but it's telling me ```error: mismatched types: expected `()` but found `bool` (expected () but found bool)```
[23:52:02] <jeaye> I either have to update rust-opengles to use the new fn ptr shit, or I need to port all of my GL code to gl-rs
[23:52:18] <jeaye> Neither will be fun
[23:52:26] <ecr> mib_9uybip: if it encountered an error, but you trapped it, then read_u8 will return a 0. so the other read* functions COULD get filled with garbage values, but only if you've caught the condition. Therefore, you will be aware that something went wrong and you can either correct it, or throw away the read as garbage.
[23:52:27] <bjz> jeaye: you could just copy over the wrapper fns from es
[23:52:31] <tikue_> but when i remove the boolean return value it says ```error: Do-block body must return bool, but returns () here. Perhaps you meant to write a `for`-loop?
[23:52:32] <tikue_> ```
[23:52:36] <bjz> jeaye: and use gl-rs
[23:52:43] <ecr> :q
[23:52:46] <bjz> jeaye: just an idea
[23:52:51] <sfackler> ecr: it looks like ReaderByteConversions implementations are actually broken, at least with respect to MemReader
[23:52:56] <achin> is there any reason https://github.com/mozilla/rust/wiki/Rustpkg-schedule can't contain links to github issues (instead of just having the issue numbers as text) ?
[23:52:56] <mib_9uybip> I'm not trapping the condition in my code
[23:52:56] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[23:52:59] <sfackler> MemReader.read returns None on eof
[23:53:03] <jeaye> bjz: That's an interesting idea. Not one I'd considered.
[23:53:05] <maik> rusti: int::from_str(~20")
[23:53:05] -rusti- Bad system call
[23:53:05] -rusti- application terminated with error code 159
[23:53:06] <mib_9uybip> exactly
[23:53:09] <tjc> achin: no good reason, I was just in a hurry
[23:53:11] <sfackler> which the ReaderByteConversions things unpack as 0
[23:53:13] <maik> rusti: int::from_str(~"20")
[23:53:13] -rusti- Bad system call
[23:53:14] -rusti- application terminated with error code 159
[23:53:15] <bjz> jeaye: might be easier
[23:53:19] <sfackler> instead of failing
[23:53:23] <mib_9uybip> those number readers should be based on read_bytes, methinks
[23:53:29] <maik> rusti: 5
[23:53:29] -rusti- Bad system call
[23:53:29] -rusti- application terminated with error code 159
[23:53:36] <tikue_> rusti: 5u
[23:53:36] -rusti- Bad system call
[23:53:36] -rusti- application terminated with error code 159
[23:53:40] <tikue_> rusti: println("hi")
[23:53:40] -rusti- Bad system call
[23:53:41] -rusti- application terminated with error code 159
[23:53:41] <adridu59> tikue_: if you are doing a return, add explicit "return: myvar" statement
[23:53:43] <Eridius> stop taunting rusti
[23:53:43] <achin> tjc: ok,  i'll make that change, thanks
[23:53:46] <Eridius> strcat: rusti is broken
[23:53:53] <sfackler> mib_9u7bip: they are, just through some extra layers that do the wrong thing
[23:53:54] <ecr> Ah, that's likely because EOF isn't considered a read error. Really, this stuff is all probably going to change (especially error handling).
[23:53:58] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[23:53:58] *** ChanServ sets mode: +o pcwalton
[23:53:59] <strcat> Eridius: I know
[23:54:01] <sfackler> I really hope so
[23:54:04] <strcat> rust started using another syscall
[23:54:04] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[23:54:11] <tjc> achin: thanks!
[23:54:11] <strcat> let me set it to trap and print
[23:54:30] <adridu59> tikue_: you can't do an implicit return in a loop (assuming that's why you're trying to do because I don't have access to your code)
[23:54:35] <Eridius> tikue_: did you remove the bool from the right do-block?
[23:54:37] <bjz> h3r3tic: beeb
[23:54:40] <tikue_> adridu59: it's not a loop
[23:54:46] <bjz> h3r3tic: *beep
[23:54:47] <tikue_> Eridius: nope that was the problem thank you!
[23:54:52] <Eridius> haha
[23:54:52] <adridu59> tikue_ can you show the code?
[23:54:53] <strcat> eventfd2
[23:54:53] <tikue_> had to squelch the outer variable
[23:55:02] <mib_9uybip> so, it would be nice if read_be_u64 would raise a condition if it couldn't read 8 bytes
[23:55:09] <mib_9uybip> shall I file an issue for that?
[23:55:10] <tikue_> adridu59: the problem was that the method was returning a boolean and i didn't realize it
[23:55:11] <strcat> rusti: 2
[23:55:11] -rusti- Bad system call
[23:55:11] -rusti- application terminated with error code 159
[23:55:20] <strcat> rusti: 2
[23:55:21] -rusti- /usr/local/bin/irc.sh: 16: exec: ./out: not found
[23:55:21] -rusti- application terminated with error code 127
[23:55:24] <strcat> heh
[23:55:33] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:55:36] * strcat shrugs
[23:55:37] <sfackler> mib_9uybip: yeah.
[23:55:49] <tikue_> strcat: if i want to mutably iterate over all values of treemap, you just put ```true``` at the end of the closure right?
[23:55:52] <mib_9uybip> cool, cheers
[23:55:55] <ecr> mib_9uybip: can't hurt. once we have a coherent idea of how to handle errors in IO we can address it
[23:55:57] <strcat> tikue_: what closure?
[23:56:13] *** Quits: wikkit (Mibbit@E8E479CF.380DC9C9.C755526F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:56:14] <strcat> oh is that still not updated to an iterator? :\
[23:56:20] <tikue_> strcat: ```do treemap.mutate_values() |key, value| { /* mutate value */ true };
[23:56:25] <Eridius> yep, can't build master
[23:56:25] <tikue_> strcat: nope
[23:56:31] <adridu59> tikue_: I see, that error output could have been related to a lot of different stuff
[23:56:35] <sfackler> having read_u8_ raise an io_erorr is probably the most consistent solution for how rt::io works now
[23:56:35] <Eridius> ld: warning: ignoring file rt/x86_64-apple-darwin/stage0/libuv/libuv.a, file was built for archive which is not the architecture being linked (x86_64): rt/x86_64-apple-darwin/stage0/libuv/libuv.a
[23:56:42] <Eridius> followed by a ton of undefined references to libuv functions
[23:56:43] <strcat> rusti: 2
[23:56:44] -rusti- /usr/local/bin/irc.sh: 16: exec: ./out: not found
[23:56:44] -rusti- application terminated with error code 127
[23:56:46] <strcat> ;\
[23:56:53] *** Parts: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) ()
[23:56:57] <strcat> what changed about rust I wonder
[23:57:03] <Eridius> strcat: libuv upgrade maybe?
[23:57:10] * pcwalton is really annoyed by "file ended with unbalanced delimiters"
[23:57:11] <pnkfelix> Eridius: I think that's the problem acrichto and I were looking at
[23:57:16] <tikue_> does anyone else think that it'd be nice to have SyncChan / SyncPort / SyncStream
[23:57:17] <pcwalton> I want to fix that to say where the delimiter started...
[23:57:25] <strcat> Eridius: yeah but strace doesn't find anything
[23:57:28] <pnkfelix> Eridius: #8826
[23:57:46] <Eridius> hrm
[23:58:06] <pnkfelix> Eridius: maybe we shuold just try to land the patch from his gist
[23:58:33] <Eridius> just applied the patch and `make` failed again; gonna try clean build
[23:58:50] <Eridius> nope, still failing
[23:59:43] * Eridius runs git clean and re-configures, in case dependencies are not set up right
[23:59:48] <pnkfelix> Eridius: hmmmm.  It also failed for me on my first few tries.  I wonder if there was something else ...
[23:59:50] <tikue_> strcat: also there's no get_mut for treemap either. i'd put a patch in to add that heh
[23:59:55] <tikue_> (only find_mut)
[23:59:57] *** Joins: XyMa (user@4F5647EE.12FF1288.B4C97B2.IP)
