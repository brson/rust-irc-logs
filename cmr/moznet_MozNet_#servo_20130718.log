[00:00:04] <eatkinson> pcwalton: right but i need to paramaterize that over the view
[00:00:44] *** Joins: ghservo (ghservo@614D05BD.6A2AE50.F3114085.IP)
[00:00:44] <ghservo> 01[13servo01] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/YrXyhQ
[00:00:44] *** Parts: ghservo (ghservo@614D05BD.6A2AE50.F3114085.IP) ()
[00:00:44] *** Joins: ghservo (ghservo@9C8B94D4.6A2AE50.F3114085.IP)
[00:00:45] <ghservo> 01[13servo01] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/Z-y7qg
[00:00:45] <ghservo> 13servo/06auto 149c5ab15 15Eric Atkinson: Fix regression on clicking links
[00:00:45] <ghservo> 13servo/06auto 14e5fc648 15bors-servo: auto merge of #597 : eric93/servo/diplaylist-refactor, r=jdm
[00:00:45] *** Parts: ghservo (ghservo@9C8B94D4.6A2AE50.F3114085.IP) ()
[00:00:47] <pcwalton> eatkinson: bleh, you might need 3 type parameters
[00:00:59] <pcwalton> or 2
[00:01:45] <pcwalton> well, hmm
[00:01:48] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[00:02:13] <pcwalton> how about TreeChildAccessors { fn first_child(&self) -> Self; fn last_child(&self) -> Self; }
[00:02:24] <pcwalton> err
[00:02:39] <pcwalton> TreeChildAccessors<Result> { fn first_child(&self) -> Result; fn last_child(&self) -> Result; }
[00:02:46] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[00:02:53] <pcwalton> TreeSiblingAccessors<Result> { fn prev_sibling(&self) -> Result; fn next_sibling(&self) -> Result; }
[00:03:14] <pcwalton> actually I guess it can be
[00:03:28] <pcwalton> TreeSiblingAccessors { fn prev_sibling(&self) -> Self; fn next_sibling(&self) -> Self; }
[00:03:35] <pcwalton> TreeParentAccessor { fn parent(&self) -> Self; }
[00:03:42] <pcwalton> then the "single threaded view" is something like
[00:04:36] <pcwalton> impl TreeParentAccessor for FlowContext<SingleThreadedView> { fn parent(&self) -> FlowContext<SingleThreadedView> { ... } }
[00:05:09] <eatkinson> pcwalton: ok that's kind of what i was thinking
[00:05:10] <pcwalton> impl TreeParentAccessor for FlowContext<SingleThreadedView> { fn first_child(&self) -> FlowContext<SingleThreadedView> { ... } }
[00:05:38] <pcwalton> err, impl TreeChildAccessors<FlowContext<SingleThreadedView>> for FlowContext<SingleThreadedView> { ... }
[00:08:17] <eatkinson> pcwalton: how can we use that enforce that visitor functions only use the proper view?
[00:09:49] <eatkinson> pcwalton: actually, nvm. i think i have enough to go on
[00:10:16] <eatkinson> pcwalton: in other news, what do you think of a spin lock instead of an atomic counter for synchronizing on bottom-up traversals
[00:10:22] <eatkinson> pcwalton: ?
[00:10:28] <pcwalton> eatkinson: I don't have any intuition
[00:11:32] *** Joins: caitp-phone (androirc@165C574A.8C19BC3D.26E1259.IP)
[00:11:35] <eatkinson> pcwalton: ok
[00:13:27] *** Quits: caitp-phone (androirc@165C574A.8C19BC3D.26E1259.IP) (Ping timeout)
[00:13:56] *** Joins: caitp-phone (androirc@29CBD45.8C19BC3D.26E1259.IP)
[00:15:58] *** Quits: caitp-phone (androirc@29CBD45.8C19BC3D.26E1259.IP) (Ping timeout)
[00:23:13] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[00:24:42] *** Joins: ghservo (ghservo@F6EE6DE3.6A2AE50.F3114085.IP)
[00:24:42] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/Z-y7qg
[00:24:42] *** Parts: ghservo (ghservo@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:24:43] *** Joins: ghservo (ghservo@CFE85B59.6A2AE50.F3114085.IP)
[00:24:43] <ghservo> [13servo] 15bors-servo closed pull request #597: Fix regression on clicking links (06master...06diplaylist-refactor)  02http://git.io/OFUJkg
[00:24:43] *** Parts: ghservo (ghservo@CFE85B59.6A2AE50.F3114085.IP) ()
[00:27:32] <eatkinson> pcwalton: is this legal rust?
[00:27:49] <eatkinson> trait TraverseParallel<T:AccessParent<T>+AccessChild<T>+AccessSibling<T>, 
[00:27:49] <eatkinson>        V:AccessChild<VC:AccessChild<VC>+AccessSibling<VC>>> {
[00:27:50] <eatkinson> }
[00:30:18] <pcwalton> eatkinson: you need to move VC out
[00:31:00] <pcwalton> trait TraverseParallel<T:AccessParent<T>+AccessChild<T>+AccessSibling<T>,VC:AccessChild<VC>+AccessSibling<VC>,V:AccessChild<VC>>
[00:31:18] <pcwalton> you *should* also be able to use trait inheritance to get rid of all the +
[00:39:08] <kmc> jdm: r? https://github.com/mozilla/servo/pull/599
[00:40:36] <tikue> ok
[00:40:42] <tikue> I'm ready for eyes on my constellation.rs overhaul
[00:40:52] <tikue> actually, not quite yet
[00:41:00] <tikue> lol
[00:41:36] <jdm> heh
[00:41:53] <jdm> holy crap
[00:41:56] <jdm> that's quite a type signature
[00:42:19] <tikue> there's a your mom joke in there somewhere
[00:42:49] *** Joins: ghservo (ghservo@AC22872E.6A2AE50.F3114085.IP)
[00:42:49] <ghservo> 01[13servo01] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/AiLZwA
[00:42:49] *** Parts: ghservo (ghservo@AC22872E.6A2AE50.F3114085.IP) ()
[00:42:51] *** Joins: ghservo (ghservo@79968228.6A2AE50.F3114085.IP)
[00:42:51] <ghservo> 01[13servo01] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/VFgfBA
[00:42:51] <ghservo> 13servo/06auto 14da6460e 15Keegan McAllister: Bump protoArray size for WindowProxy...
[00:42:51] <ghservo> 13servo/06auto 14073f424 15bors-servo: auto merge of #599 : kmcallister/servo/proto-array, r=jdm...
[00:42:52] *** Parts: ghservo (ghservo@79968228.6A2AE50.F3114085.IP) ()
[00:48:51] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[01:03:46] *** Joins: ghservo (ghservo@1E8607E8.6A2AE50.F3114085.IP)
[01:03:47] <ghservo> [13servo] 15kmcallister closed issue #596: Bad memory access from WindowProxyBinding::GetProtoObject  02http://git.io/tOs9Dg
[01:03:47] *** Parts: ghservo (ghservo@1E8607E8.6A2AE50.F3114085.IP) ()
[01:06:41] *** Joins: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP)
[01:07:06] <kmc> jdm: I'm seeing another invalid memory access, in the Element dtor invoked from dom::bindings::element::finalize.  you have a comment "//XXXjdm We need separate finalizers for each specialty element type like headings", do you think lack of these specialized dtors could violate memory safety?
[01:08:27] <kmc> that dtor invokes the dtor for Option<@mut ()> and that's what does an invalid read
[01:08:40] <jdm> hrm
[01:09:09] <jdm> I wouldn't expect the general finalizer to violate memory safety
[01:09:35] <jdm> kmc: what's the Option that's being destructed?
[01:09:59] <jdm> ooh
[01:10:09] <jdm>     priv layout_data: Option<@mut ()>
[01:11:20] <kmc> I'm not sure which Option is being destructed but that's a likely one
[01:11:21] <jdm> I'm not sure off the top of my head why that would be causing an invalid access, though
[01:11:48] <kmc> what's the point of that field?
[01:12:02] <jdm> it's where the layout task stashes data
[01:12:46] <kmc> how does it stash data if the type inside is just ()? is there an unsafe cast somewhere?
[01:13:07] <kmc> ah, yes, there is
[01:13:36] <jdm> layout/aux.rs has all the answers
[01:15:55] *** Joins: mccr8 (mccr8@moz-5FEA0C74.dsl.dynamic.sonic.net)
[01:16:03] <tikue> I'm not done with iframe changes yet, and there are likely tons of compile errors scattered around still, but if anyone wants to start looking at main/constellation.rs, the structure I'm going for is finished (, if not yet usable). I could use some feedback on the general layout
[01:17:14] <jdm> link?
[01:17:57] <tikue> https://github.com/tkuehn/servo/blob/master/src/components/main/constellation.rs
[01:18:00] <tikue> jdm: 
[01:19:29] * tikue also hasn't rebased in a while. not sure if that matters
[01:27:55] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[01:31:19] *** Quits: eschweic1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:35:24] <tikue> jdm: when should the js context and js compartment be initialized? whenever a new page or iframe is being loaded?
[01:37:06] <jdm> yep
[01:37:33] <tikue> thx
[01:42:31] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[01:46:15] *** Quits: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:49:06] *** Joins: bz (bzbarsky@moz-A28C5395.bstnma.fios.verizon.net)
[01:49:37] *** Joins: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com)
[01:50:27] *** Quits: lmandel (lmandel@8B192B20.1F93A08E.ADB88A9.IP) (Quit: lmandel)
[01:52:47] *** Joins: lmandel (lmandel@8B192B20.1F93A08E.ADB88A9.IP)
[01:52:59] *** Quits: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:53:35] <jack> $ ./reftest ../src/test/ref/basic.list
[01:53:36] <jack>  
[01:53:37] <jack> running 1 test
[01:53:38] <jack> test hello_a.html / hello_b.html ... ok
[01:53:40] <jack>  
[01:53:42] <jack> result: ok. 1 passed; 0 failed; 0 ignored
[01:53:46] <jack>  
[01:53:49] <jack>  
[01:53:56] <jack> :)
[01:53:57] <tikue> \o/ 
[01:53:59] <tikue> jack
[01:57:43] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[02:04:29] *** Quits: sanxiyn (tinuviel@858F408C.B797260D.EF43EC08.IP) (Ping timeout)
[02:11:00] <tikue> does anyone know if the order in which messages are sent on a channel corresponds to a deterministic order in which they are received?
[02:11:19] <tikue> chan.send(1); chan.send(2); assert(port.recv() == 1)
[02:11:21] <tikue> something like that
[02:12:04] <pcwalton> jack: sweet
[02:13:15] <tikue> I'm worried about being like "hey script task, attach this new layout with id # N"
[02:13:23] <tikue> and then sending a message "hey script task, load this url with layout # N "
[02:13:33] <tikue> is there a race ther
[02:13:34] <tikue> there*
[02:13:55] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[02:15:10] <jdm> jack: :D
[02:15:49] <jdm> tikue: I'm pretty sure your only guaranteed same-order delivery for messages sent by the same task
[02:15:59] <tikue> jdm: that's all I need :)
[02:15:59] <jdm> argh you're
[02:17:26] *** Quits: dzbarsky1 (Adium@moz-A7CDB794.dia.static.qwest.net) (Quit: Leaving.)
[02:19:57] <tikue> if you do something like, `let mut bar = foo.bar;` does that copy bar or move it out of foo usually
[02:24:43] <jack> i'm not sure if you can move partially out of a struct
[02:25:06] <jdm> you can move out of a struct, but the struct becomes inaccessible after that iirc
[02:25:31] <tikue> kk
[02:26:18] *** Quits: jet (jet@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: jet)
[02:38:07] *** Joins: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com)
[02:46:23] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[02:46:39] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[02:47:17] <jack> wtf github? where's my PR notification?
[02:49:14] <tikue> jdm: any initial thoughts? anything sketching you out?
[02:49:24] <jdm> tikue: sorry, haven't looked at it yet
[02:49:29] <jdm> got distracted by urgent b2g stuff
[02:49:43] <tikue> jdm: no prob, it's not urgent, I'm working on the script task side of things right now
[02:54:17] <tikue> what does the js_context refer to? Why is there one per page? 
[02:54:27] <tikue> as opposed to one per runtime?
[02:56:35] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:01:29] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[03:09:30] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[03:15:24] *** Quits: jdm (jdm@moz-AC89B3C8.vlan445.asr1.yyz1.gblx.net) (Quit: Lost terminal)
[03:15:39] *** Quits: mccr8 (mccr8@moz-5FEA0C74.dsl.dynamic.sonic.net) (Quit: mccr8)
[03:16:36] <bz> That is an excellent question
[03:16:48] <bz> It _used_ to be that a jscontext was basically supposed to correspond to a thread
[03:16:54] <bz> which is what jsruntime is now
[03:17:03] <bz> but then the jsapi hung various stuff off the jscontext
[03:17:08] <bz> that ended up being needed per page
[03:17:12] <bz> like error reporters
[03:17:49] <bz> tikue: ^
[03:18:17] <bz> tikue: fwiw, bholley is working on eliminating those issues and switching all of mainthread DOM to a single JSContext in Gecko
[03:19:38] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[03:24:58] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[03:28:53] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[03:44:47] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[03:52:08] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[03:52:29] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Input/output error)
[04:16:23] *** Quits: jet (jet@moz-79F891EE.hsd1.ca.comcast.net) (Quit: jet)
[04:30:14] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[04:47:08] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:47:08] *** ChanServ sets mode: +qo dherman dherman
[04:48:26] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:48:51] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[04:53:32] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[04:59:48] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:59:49] *** ChanServ sets mode: +qo dherman dherman
[05:12:06] *** Quits: jet (jet@moz-79F891EE.hsd1.ca.comcast.net) (Quit: jet)
[05:14:41] *** Quits: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[05:21:09] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[05:31:14] *** Quits: jet (jet@moz-79F891EE.hsd1.ca.comcast.net) (Quit: jet)
[05:32:40] *** Quits: lmandel (lmandel@8B192B20.1F93A08E.ADB88A9.IP) (Quit: lmandel)
[05:39:19] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[05:55:45] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[05:57:33] *** Quits: duckinator (nick@moz-74B346B5.mostlyincorrect.info) (Ping timeout)
[05:57:54] *** Quits: toshok (toshok@moz-67C55A1F.com) (Ping timeout)
[05:58:03] *** Quits: jack (jack@moz-DF5A9AA3.members.linode.com) (Ping timeout)
[05:59:03] *** Joins: toshok (toshok@moz-67C55A1F.com)
[06:01:11] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[06:01:22] *** Joins: jack (jack@moz-DF5A9AA3.members.linode.com)
[06:01:22] *** ChanServ sets mode: +o jack
[06:01:25] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[06:02:57] *** Joins: duckinator (nick@moz-74B346B5.mostlyincorrect.info)
[06:04:45] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[06:06:10] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[06:17:53] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[06:19:58] *** Joins: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com)
[06:26:09] *** Quits: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[06:27:17] *** Quits: jet (jet@moz-79F891EE.hsd1.ca.comcast.net) (Quit: jet)
[06:28:13] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[06:42:19] *** Joins: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net)
[06:47:33] *** Quits: caitp- (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: caitp-)
[07:22:10] *** Joins: Adityab (Adityab@45CF776C.DC24CC58.16E13E53.IP)
[07:29:32] *** Quits: jet (jet@moz-79F891EE.hsd1.ca.comcast.net) (Quit: jet)
[07:54:41] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[08:00:26] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[08:02:34] *** Joins: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net)
[08:03:13] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[08:34:20] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[08:34:47] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[08:36:31] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[08:38:15] *** Joins: Debloper (debloper@moz-88FF8AE8.redhat.com)
[08:39:26] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:42:35] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[09:03:08] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[09:07:07] *** Joins: victorporof (victorporo@3692B70F.2484615.4A6B528C.IP)
[09:57:55] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[10:35:49] *** Quits: victorporof (victorporo@3692B70F.2484615.4A6B528C.IP) (Connection reset by peer)
[10:49:49] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Quit: Leaving.)
[10:50:10] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[10:57:35] *** Joins: Nefzaoui (chatzilla@373ADCEE.15DF432A.80E43DAF.IP)
[11:01:32] *** Joins: caitp- (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[12:00:09] *** Quits: Nefzaoui (chatzilla@373ADCEE.15DF432A.80E43DAF.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0a1/20130716030202])
[12:07:10] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[12:34:56] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[12:36:53] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[12:37:59] *** Quits: dzbarsky (Adium@moz-A7CDB794.dia.static.qwest.net) (Quit: Leaving.)
[12:41:39] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[13:01:29] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[13:09:42] *** bhearsum|afk is now known as bhearsum
[13:24:40] *** Joins: sankha93 (Instantbir@F240151E.4F548E43.F44414AF.IP)
[13:34:31] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[13:34:34] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[13:36:58] *** Quits: reyre (rick@B2D8AB09.33EE9F8A.1139E686.IP) (Quit: Leaving)
[13:37:21] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[14:19:46] <jack> jdm: r? https://github.com/mozilla/servo/pull/600
[14:20:15] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:20:15] *** ChanServ sets mode: +qo dherman dherman
[14:21:39] *** Quits: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net) (Ping timeout)
[14:22:15] *** Joins: ghservo (ghservo@79968228.6A2AE50.F3114085.IP)
[14:22:16] <ghservo> 01[13servo01] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/pQl_wA
[14:22:16] *** Parts: ghservo (ghservo@79968228.6A2AE50.F3114085.IP) ()
[14:22:23] *** Joins: ghservo (ghservo@C621748.6A2AE50.F3114085.IP)
[14:22:23] <ghservo> 01[13servo01] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/c51J4Q
[14:22:23] <ghservo> 13servo/06auto 14514d9ee 15Jason Yeo: Added mozharness config files
[14:22:23] <ghservo> 13servo/06auto 1449524a6 15bors-servo: auto merge of #594 : jsyeo/servo/add-MH-configs, r=metajack...
[14:22:24] *** Parts: ghservo (ghservo@C621748.6A2AE50.F3114085.IP) ()
[14:24:02] <bhearsum> yay
[14:24:07] <bhearsum> jyeo++
[14:26:01] <jyeo> :)
[14:26:48] <jyeo> bhearsum: and..lastly i have to hcange this right? http://mxr.mozilla.org/build/source/puppet/modules/buildmaster/files/servo/master.cfg#130
[14:27:31] <jack> bhearsum,jyeo: thanks for these changes!
[14:27:32] <bhearsum> yeah, but you need to be a little tricky about it - you need to use properties to make sure you grab the right branch/revision
[14:27:55] <bhearsum> jyeo: have you used WithProperties() before?
[14:28:14] <bhearsum> jack: 303 jyeo, but thanks :)
[14:28:21] <jyeo> bhearsum: nope...I'm touching puppet code for the first time. :(
[14:28:36] <jyeo> jack: np
[14:28:48] <bhearsum> jyeo: oh, this is buildbot code, it just happens to be stored in puppet
[14:29:00] <bhearsum> let's move to #releng to chat about this more
[14:29:59] <jyeo> bhearsum: yep...I feel bad spamming these strictly typed people with discussions about a dynamic language :P
[14:33:00] <jack> haha
[14:35:25] <bhearsum> haha
[14:45:49] *** Joins: ghservo (ghservo@24260B07.6A2AE50.F3114085.IP)
[14:45:49] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/c51J4Q
[14:45:49] *** Parts: ghservo (ghservo@24260B07.6A2AE50.F3114085.IP) ()
[14:47:40] *** Quits: sankha93 (Instantbir@F240151E.4F548E43.F44414AF.IP) (Client exited)
[14:50:16] *** Joins: ghservo (ghservo@FD7BC443.6A2AE50.F3114085.IP)
[14:50:16] <ghservo> 01[13servo01] 15bors-servo pushed 0 new commits to 06auto: 02http://git.io/Ijv7Dg
[14:50:16] *** Parts: ghservo (ghservo@FD7BC443.6A2AE50.F3114085.IP) ()
[14:50:20] *** Joins: ghservo (ghservo@614D05BD.6A2AE50.F3114085.IP)
[14:50:20] <ghservo> 01[13servo01] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/rbkPcA
[14:50:20] <ghservo> 13servo/06auto 14d695b2d 15eschweic: Refactor compositor to use messages rather than callbacks.
[14:50:20] <ghservo> 13servo/06auto 1409acdcc 15bors-servo: auto merge of #593 : eschweic/servo/windowing-messages, r=metajack...
[14:50:21] *** Parts: ghservo (ghservo@614D05BD.6A2AE50.F3114085.IP) ()
[14:51:23] *** Joins: sankha93 (Instantbir@E677A839.19E4BF68.25B273F5.IP)
[14:53:23] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[14:55:24] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:55:24] *** ChanServ sets mode: +qo dherman dherman
[14:55:55] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[14:57:22] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[14:59:05] *** Joins: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP)
[14:59:05] <ghservo> [13servo] 15jdm opened issue #601: Make the bindings protoArray use the autogenerated _ID_Count from PrototypeList  02http://git.io/oVFmng
[14:59:05] *** Parts: ghservo (ghservo@2EE61FCC.6A2AE50.F3114085.IP) ()
[15:06:35] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[15:10:09] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[15:12:30] *** Joins: ghservo (ghservo@AD60B2E3.6A2AE50.F3114085.IP)
[15:12:30] <ghservo> 01[13servo01] 15bors-servo merged 06auto into 06master: 02http://git.io/rbkPcA
[15:12:30] *** Parts: ghservo (ghservo@AD60B2E3.6A2AE50.F3114085.IP) ()
[15:24:37] *** Quits: Adityab (Adityab@45CF776C.DC24CC58.16E13E53.IP) (Ping timeout)
[15:25:44] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[15:31:07] *** Joins: mccr8 (mccr8@moz-BBE3ABD.mv.mozilla.com)
[15:48:46] *** Joins: Nefzaoui (chatzilla@373ADCEE.15DF432A.80E43DAF.IP)
[16:02:03] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[16:11:28] *** Joins: vodik_ (simon@moz-9EC368A5.dsl.bell.ca)
[16:17:41] *** Quits: caitp- (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Quit: caitp-)
[16:20:55] *** Joins: victorporof (victorporo@B7024D9D.5270B130.78DC9724.IP)
[16:21:19] *** Quits: victorporof (victorporo@B7024D9D.5270B130.78DC9724.IP) (Quit: victorporof)
[16:22:23] *** Joins: victorporof (victorporo@B7024D9D.5270B130.78DC9724.IP)
[16:23:14] *** Joins: jet (jet@moz-79F891EE.hsd1.ca.comcast.net)
[16:30:20] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[16:33:24] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[16:34:55] <jdm> inline storage seems like it should be really easy to achieve
[16:34:58] <jdm> I must be missing something
[16:38:35] <jack> sigh. task::yield() still makes the compositor take 100% cpu
[16:39:17] <jack> jdm: easy is good
[16:40:17] <jdm> evilpie pointed out that we can use reserved slots, which allocates a certain number of fixed slots and makes them inaccessible to the regular slot-using parts of spidermonkey
[16:40:24] <jdm> so we could just fill them with whatever we want
[16:41:20] <jack> what are all the slots?
[16:41:20] <jdm> then I guess I just need some kind of placement new in rust
[16:41:26] <jack> i know nothing about how the spidermonkey stuff works
[16:41:40] <jdm> slots are where JS object properties are stored
[16:41:53] <jdm> so objects are allocated with a certain number of fixed, inline slots
[16:42:00] <jdm> and all the rest are allocated dynamically
[16:42:07] <jack> for stuff like proto and such?
[16:42:19] <jdm> I don't think the proto is part of it
[16:42:26] <jdm> stuff like obj.x
[16:43:06] <jdm> gecko (and servo) use reserved slots for storing pointers to C++/Rust objects right now
[16:43:08] <jack> oh, so they are static for the object, but not fixed ahead of time. what gets assigned to a slot is based on what the object defines?
[16:43:16] <jdm> precisely
[16:43:37] <jdm> er, actually not static
[16:43:57] <jdm> when you do |obj.foo = "hi"| that assigns a slot to represent the foo value
[16:44:19] <jdm> and |delete obj.foo| frees it up
[16:44:19] <jack> so is there a limit to how many slots we can add?
[16:44:32] <jdm> no, since any that go beyond the fixed size are allocated dynamically
[16:44:56] <jack> do we control the fixed size? is there a limit on that?
[16:45:02] <jdm> yes and yes
[16:45:08] <jdm> looks like 16 is the maximum
[16:45:18] <jdm> where a slot is a JSVal
[16:45:31] <evilpie> wow that is a lot
[16:45:39] <jdm> yeah, I was surprised as well
[16:46:43] <jdm> there are different classes of allocations, like JSObject_Slot2, JSObject_Slot16, that are selected based on the number of reserved slots requests, afaict
[16:46:53] <jdm> s/requests/requested/
[16:48:35] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:48:53] <jack> we need 6 pionters for COW DOM right?
[16:49:01] *** Quits: Debloper (debloper@moz-88FF8AE8.redhat.com) (Quit: Leaving.)
[16:49:23] <jack> parent,prev_sib,next_sib,first_child,last_child,dirty_node
[16:50:33] <jdm> jack: for the base node that sounds right
[16:53:50] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[16:54:48] *** Joins: azakai_ (alon@moz-BBE3ABD.mv.mozilla.com)
[16:54:49] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[16:55:37] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Connection reset by peer)
[16:55:54] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[16:56:02] *** Quits: vodik_ (simon@moz-9EC368A5.dsl.bell.ca) (Quit: work)
[16:56:06] *** Quits: Nefzaoui (chatzilla@373ADCEE.15DF432A.80E43DAF.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0a1/20130716030202])
[16:57:12] <jack> will us taking these reserved slots result in less slots of real JS objects, and thus slower performance as they use dynamic slots?
[16:59:28] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[17:00:03] <bz> You'll need a flag word too
[17:00:05] <bz> or several
[17:00:12] <bz> Gecko has 128 bits of flags on nodes....
[17:00:33] <bz> (of which we use > 96, iirc)
[17:01:23] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:05:21] *** Joins: eholk (eholk@moz-466C519D.uconnect.utah.edu)
[17:06:14] <jack> so possibly 8 words then.
[17:06:42] <bz> You probably want a nodeinfo or similar too
[17:06:46] <jdm> jack: I'm pretty sure the difference is just an extra pointer dereference, and this is only for the wrappers of DOM objects too
[17:06:59] <jdm> I wouldn't expect those to feature highly in microbenchmarks
[17:07:09] <bz> jdm: you wouldn't?
[17:07:19] <jdm> bz: well, not in terms of setting non-dom properties on them
[17:07:25] <bz> jdm: you would expect wrong.
[17:07:28] <jdm> shoot
[17:07:45] <bz> jdm: Now what the microbenchmarks look like....
[17:08:01] <bz> jdm: the most common expando case people do is already somewhat slow-pathed in spidermonkey
[17:08:13] <bz> jdm: that being SETELEM with a string name
[17:08:31] <bz> jdm: so the performance of getting your slot is unlikely to be the gating factor
[17:12:09] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:12:09] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:13:42] <jack> so the answer is the slots we use do steal from JS code?
[17:13:53] <jdm> yes
[17:13:58] <bz> "maybe"
[17:14:11] <jdm> bz: oh?
[17:14:14] <bz> it's not clear to me how many fixed slots JS objects created via JS_NewObject get by default
[17:14:30] <bz> Typically, the JS engine uses TI to figure out how many fixed slots to give a new object...
[17:14:42] <jack> bz: SETELEM with a string name is foo["attrib"] = bar?
[17:14:42] <bz> based on how many slots ended up getting used for other objects at that allocation point
[17:15:05] <bz> jack: no, SETELEM with a string name is function f(arg) { foo[arg] = bar; }
[17:15:23] <bz> jack: foo["attrib"] with a string literal is desugared to f.attrib by the bytecode compiler
[17:15:27] <bz> jack: so gets a SETPROP
[17:15:38] <jack> ah
[17:15:46] <bz> But for JS_NewObject calls from C++ I expect they just pick some slot count
[17:15:55] * bz reads the code
[17:15:58] *** Parts: cmr (moznet@moz-EC676DFE.members.linode.com) (WeeChat 0.4.1)
