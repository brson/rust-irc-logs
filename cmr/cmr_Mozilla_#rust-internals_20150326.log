[00:01:02] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[00:07:23] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[00:15:32] <burntsushi> does anyone know if there is supposed to be a `impl From<String> for String` or similar? or at the very least, a `impl Into<String> for String`
[00:15:53] <burntsushi> (there is `impl<T> Into<Vec<T>> for Vec<T>`)
[00:16:03] <burntsushi> (for the new std::convert traits)
[00:16:25] <kmc> nrc|afk: hey I saw you're working on a strings library. did you see https://github.com/kmcallister/tendril ?
[00:16:31] <cmr> aturon: ^ this question (and forms of it) has come up a lot today.
[00:18:38] <nrc|afk> kmc: I had not, thanks for the link
[00:18:45] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:19:13] *** Quits: jyyou (jyyou@moz-nhbjfr.bo6r.4bjo.8900.2400.IP) (Ping timeout: 121 seconds)
[00:19:13] <kmc> we could possibly combine efforts
[00:19:19] <nrc|afk> kmc: "working on" is a bit strong :-) I needed some things and made them, I don't intend to put a lot more effort into it unless it is requested
[00:19:25] <kmc> ok, cool
[00:19:28] *** Joins: jxv (jxv___@moz-2celrt.res.rr.com)
[00:19:38] <nrc|afk> sure, feel free to steal stuff as a starting point
[00:19:53] <kmc> sounds good. and you're welcome to contribute to my library if/when it exists =)
[00:19:58] <nrc|afk> cool
[00:20:06] <nrc|afk> I agree, no point in dup'ing effort
[00:20:10] <kmc> if you want to chat about use cases or desired features I'd be interested to hear that, as well
[00:20:36] <aturon> cmr: yes the impls are minimal right now and reflexive impls are fine to add. Would do via blanket impl but has coherence issues
[00:20:44] <nrc|afk> my motivation has been RustFmt - I've needed some efficient ways to make files, i.e., big strings
[00:20:47] <aturon> Typing from phone so that's all for now
[00:21:05] <cmr> aturon: ok, thanks.
[00:21:13] <cmr> burntsushi: Add reflexive implementtions as necessary :)
[00:21:22] <cmr> #[derive(From)] should probably be a thing?
[00:21:22] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:21:54] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:21:56] <burntsushi> cmr, aturon: thanks! i figured coherence was probably why they got looked over.
[00:24:25] <burntsushi> i think we'd probably want `Into<Cow>` too?
[00:24:35] <burntsushi> (assuming `IntoCow` is really going away)
[00:25:06] <kmc> "and I thought they smelled bad on the outside"
[00:25:56] <burntsushi> :P
[00:27:54] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[00:28:04] *** Quits: eibwen (eibwen@moz-gkge9k.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[00:30:44] *** Joins: nawns (nawns@moz-0l6.cn2.211.128.IP)
[00:33:08] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[00:33:09] <cmr> kmc: lol, that's the best Cow joke I've seen so far
[00:34:32] *** Quits: swgillespie (swgillespie@moz-upj.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:35:20] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:36:34] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:36:50] <zwarich> cmr: most of the Cow jokes don't have enough meat
[00:37:00] <cmr> zwarich: nice try, though.
[00:37:02] <zwarich> so when you find a good one you have to milk it for all it's worth
[00:37:04] <zwarich> :(
[00:37:13] <cmr> :P
[00:39:10] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:42:08] *** Quits: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[00:42:35] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:45:30] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[00:45:42] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[00:45:58] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:46:20] *** Joins: mystor (mystor@moz-rrn.r78.15.130.IP)
[00:46:27] *** Joins: jyyou (jyyou@moz-nhbjfr.bo6r.4bjo.8900.2400.IP)
[00:49:05] <theme> Is it backwards-compatible to add a provided function to a trait?
[00:49:21] <theme> I'm not sure about how name resolution works
[00:51:22] <brson> theme: I believe it's considered backwards compatible, but most anything involving adding methods can lead to downstream resolution conflicts
[00:51:35] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:51:43] <theme> brson, I see a contradiction there O_o
[00:52:12] <huon> "strictly it is backwards in compatible, in practice it usually won't be an issue"
[00:52:44] <theme> uh... ok
[00:52:46] <bstrie> we need the document that lays all of this out
[00:53:06] <theme> What about (hypothetical) associated constants?
[00:53:40] <huon> don't know how they interact with trait objects
[00:53:46] <bstrie> aturon: what's the status of that document detailing exactly what backcompat in rust means
[00:54:34] <theme> huon, how does that matter?
[00:54:58] <theme> I'm more worried about struct fields
[00:55:13] <huon> why are struct fields related to struct fields?
[00:55:18] <huon> *associated constants
[00:55:25] <theme> huon, name clashes
[00:55:34] <huon> still don't see it... ?
[00:55:57] <theme> huon, `use`ing a trait makes you able to directly use a trait method as if it was an inherent method
[00:56:06] <theme> oh... wait a sec
[00:56:19] <theme> It's like a "static field"... so probably not going to clash
[00:56:30] <huon> anyway, associated constants are part of a trait
[00:56:44] <huon> their interaction with trait objects may make adding one backwards incompatible
[00:56:49] <theme> huon, so why are you worried about interaction with trait objects?
[00:56:51] <huon> I'm not sure we've planned this out enough
[00:57:08] <theme> ok...
[00:57:14] <huon> theme: i'm worried because I literally have no idea what the interaction will be
[00:57:19] <theme> huon, what if they have a default value?
[00:57:52] <huon> I believe default values of associated things only affect the `impl`s, not the uses
[00:58:33] <theme> huon, default methods already don't affect impls
[00:58:42] <theme> default type arguments too
[00:58:48] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[00:59:00] <huon> neither of those are "associated things" :)
[00:59:02] <theme> is there anything like default associated types yet?
[00:59:04] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:59:16] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[00:59:41] <aatch> theme, you mean like what we already have?
[01:00:12] <theme> aatch, well, that's what I'm asking
[01:00:38] <theme> I'm trying to figure out whether adding a default associated constant to a trait is backwards compatible
[01:01:00] <theme> so I am asking if we have default associated types
[01:01:12] <aatch> theme, assuming you mean being able to do `type Foo = T` in a trait, we've had for about as long as we've had associated types, if I remember correctly.
[01:01:44] <theme> aatch, is adding a default associated type backwards-compatible?
[01:01:55] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:02:39] <aatch> theme, probably.
[01:03:07] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:03:07] * theme experiments
[01:03:55] *** Quits: {-}grant ({0}grant@moz-k7fknj.mo.charter.com) (Ping timeout: 121 seconds)
[01:04:03] <huon> it's not backwards compatible
[01:04:17] <theme> huon, code example?
[01:04:32] <huon> I believe associated types have to be specified in trait objects at the moment
[01:04:42] *** Quits: yjv (yjv@moz-j0cdis.fios.verizon.net) (Connection closed)
[01:04:44] <theme> if it is, I have a huge trouble with my unsafe comparisons RFC
[01:04:45] <huon> (default assoc types don't actually work at all, afaik)
[01:05:34] <reem> huon: afaict adding default associated types would only let currently non-compiling code compile
[01:05:48] <reem> e.g. right now Box<Iterator> does not work, but if Item had a default it would work in the future
[01:05:56] <reem> Box<Iterator<Item=X>> works either way
[01:05:58] <theme> huon, yeah
[01:06:05] <theme> default associated doesn't work
[01:06:06] <theme> http://is.gd/nlzgtw
[01:06:21] <theme> reem, ^
[01:06:30] <theme> *default associated types*
[01:06:36] *** Joins: {-}grant ({0}grant@moz-k7fknj.mo.charter.com)
[01:06:45] <reem> theme: Ya, that's expected. It's not a feature we have today.
[01:06:50] <huon> reem: ah, so we're planning to have defaults default in trait objects?
[01:06:57] <theme> reem, I'm talking about backwards compatibility of adding a default associated type to a trait
[01:07:07] <huon> hm, wonder how that interacts with proposed assoc-type erasure...
[01:07:08] <theme> not adding a default to an associated type of a trait
[01:08:58] <reem> oooh
[01:09:22] <reem> I thought we were talking about adding the feature at all
[01:09:27] <reem> not adding specific defaults to types
[01:09:30] <theme> reem, is it *going* to be backwards compatible?
[01:09:30] <reem> traits*
[01:09:41] <reem> iirc it was delayed because it is back compat
[01:09:46] <reem> but I could be wrong
[01:09:53] <theme> I'm asking this because I want to add an associated constant to a trait post-1.0
[01:10:28] <theme> so I'm comparing it to another feature: associated types
[01:10:30] <reem> associated constants are very different from associated types at the implementation level
[01:10:41] <reem> associated constants can just go in the vtable for trait objects
[01:10:51] <reem> so you wouldn't need to specify them in trait objects anyway
[01:11:04] *** Quits: {-}grant ({0}grant@moz-k7fknj.mo.charter.com) (Ping timeout: 121 seconds)
[01:11:15] <theme> reem, I figured that they would be similar *conceptually*
[01:11:25] <reem> you need to specify associated types because they're types, so they're compile time constructs and can't be "vtabled" like methods and constants
[01:11:28] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:11:50] <theme> reem, wait... associated constants can go to the vtable?
[01:11:54] <reem> why not?
[01:11:57] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:12:05] <theme> I was *not* expecting that
[01:12:21] <reem> just statically allocate them and store a pointer to them in the vtable? unless I'm missing something important...
[01:12:35] <theme> reem, Actually, I missed that
[01:12:42] <aatch> reem, actually, I don't think that's right. Associated constants should fall into the same behaviour as associated methods.
[01:12:48] <aatch> associated functions*
[01:13:04] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[01:13:09] <theme> btw is it reasonable to have unsafe default associated constants?
[01:13:21] <theme> meaning that it is unsafe to change the default
[01:13:26] <reem> aatch: Right, which means they go in the vtable for trait objects
[01:13:27] <theme> *change from*
[01:13:31] <reem> aatch: Just like methods today
[01:13:31] <huon> theme: what is an unsafe constant?
[01:13:42] <huon> reem: it means they're object-unsafe
[01:14:00] <huon> theme: oh, i see
[01:14:42] <reem> Ah
[01:14:51] <theme> is that a reasonable idea?
[01:14:52] <reem> because in impl Trait for Trait the associated constant wouldn't be constant
[01:15:26] * theme thinks about renaming *that* to associated *statics*
[01:15:42] <theme> btw what is the status of this? gh23606
[01:15:42] <[o__o]> Implement associated constants: https://github.com/rust-lang/rust/pull/23606
[01:15:59] <aatch> reem, associated functions == static methods
[01:16:41] <reem> aatch: Oh I see that's why you corrected from methods.
[01:16:46] <reem> that makes a lot of sense
[01:17:23] <aatch> reem, conceptually they all more-or-less fall under the same heading of "associated items"
[01:17:54] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:17:59] <theme> How does quantheory's PR deal with object safety?
[01:18:27] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:18:46] *** Joins: srh (User@moz-p1jfmh.biz.rr.com)
[01:19:36] <reem> aatch: I've actually never understood why static methods that don't mention Self can't be called through a trait object
[01:19:59] <theme> reem, sounds like a bug to me
[01:20:23] <aatch> reem, because we don't know which one to call.
[01:20:29] <theme> O_o
[01:21:07] *** Quits: mystor (mystor@moz-rrn.r78.15.130.IP) (Connection closed)
[01:21:08] <aatch> reem, I mean, I guess we *could* put it in the vtable, but that seems weird to me.
[01:21:17] <huon> reem: breaks fn foo<T: Foo + ?Sized>() { T::static_method_from_foo() }
[01:21:18] <aatch> reem, also, what would it look like?
[01:21:23] <huon> can't call that with foo::<Foo>()
[01:21:57] <huon> (basically the impl Foo for Foo thing)
[01:22:13] <theme> can't we put that in the vtable?
[01:22:17] <theme> that's natural to me
[01:22:22] <huon> what vtable?
[01:22:30] <theme> huon, trait object vtable
[01:22:32] <aatch> theme, in huon's example, where's the vtable coming from?
[01:22:35] <huon> the `foo` function doesn't have a vtable
[01:22:45] <reem> aatch: I don't have a solution to huon's example, which explains why we don't allow this.
[01:22:48] <huon> *have access to a
[01:23:13] <theme> aatch, I don't expect that to work
[01:23:35] <huon> we need it to work to support trait objects in the way we want
[01:23:39] <theme> aatch, but I expect that to work if it is called like `value::static_method()`
[01:23:39] <huon> (impl Trait for Trait)
[01:23:47] <theme> or `value.static_method()`
[01:23:54] <aatch> theme, then it'll only work when you have an object, at which point you might as well just use a regular method.
[01:24:04] <theme> aatch, ah...
[01:24:07] <huon> basically we want T = Foo in T: ?Sized + Foo to work always
[01:24:16] <huon> http://huonw.github.io/blog/2015/01/object-safety/#motivation
[01:25:14] * theme reads
[01:26:05] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:26:37] <theme> so... are associated constants going to be object safe?
[01:26:52] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:27:02] <theme> sorry... but I'm confused by all this associated function / object safety thing
[01:27:39] <reem> no, associated constants are not object safe
[01:28:01] <theme> oh... wait
[01:28:19] <theme> then I have a problem
[01:28:37] <theme> Is PartialEq currently object safe, any way?
[01:28:41] <theme> I'm still not clear on that
[01:29:25] <cmr> playbot: let x: &PartialEq<Rhs = i32>;
[01:29:27] -playbot- output truncated; full output at: http://bit.ly/1CQf2NA
[01:29:36] <huon> it's not
[01:29:47] <theme> cmr, looks like a bug O_o
[01:30:08] <huon> oh, I suppose it is, but it's not usefully object safe
[01:30:14] <theme> let x: &(PartialEq<Rhs = i32>)
[01:30:21] <theme> playbot, let x: &(PartialEq<Rhs = i32>)
[01:30:21] -playbot- <anon>:15:5: 15:6 error: expected one of `+`, `;`, or `=`, found `}`
[01:30:22] -playbot- <anon>:15     });
[01:30:22] -playbot- output truncated; full output at: http://bit.ly/1HIjIEq
[01:30:26] <huon> playbot: let x: &PartialEq<i32> = &1;
[01:30:27] <theme> playbot, let x: &(PartialEq<Rhs = i32>);
[01:30:28] -playbot- ()
[01:30:29] -playbot- output truncated; full output at: http://bit.ly/1CQf7AT
[01:30:33] <huon> Rhs isn't an associated type!
[01:30:44] <theme> whoops
[01:30:46] <theme> lol
[01:31:02] * theme feels stupid
[01:31:08] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:31:34] <theme> reem, huon, so I have a problem here
[01:31:42] <aatch> So you can construct an object where the only thing you can do is compare it to values of a specific type, heh.
[01:32:11] <theme> I want to add a default associated constant to PartialEq post-1.0 T_T
[01:32:12] <reem> sounds moderately useful
[01:32:17] <huon> playbot: let x: &PartialEq<i32> = &1; *x == 1
[01:32:18] -playbot- true
[01:32:20] <huon> playbot: let x: &PartialEq<i32> = &1; *x == 2
[01:32:22] -playbot- false
[01:32:23] <huon> neat
[01:32:26] <reem> less useful than comparing it to anything comparable to some type, but that's the generics tradeoff
[01:32:33] <reem> generics/trait object*
[01:32:56] <aatch> theme, why?
[01:33:17] <theme> aatch, https://github.com/rust-lang/rfcs/pull/956#issuecomment-83856478
[01:33:29] <theme> actually, it was modified from huon's idea
[01:34:23] <theme> I'm quite surprised that this RFC didn't come up at the weekly meeting, given that so many people discussed it
[01:34:39] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:36:28] <aatch> Eh, I'm ok with them just being unsafe. The majority of implementations are generated by the compiler anyway.
[01:36:57] <theme> aatch, O_o
[01:37:12] <theme> aatch, I thought nobody would like that other than me
[01:37:18] <aatch> unsafe trait I mean.
[01:37:45] <erickt> acrichto: the bsd builder failed on your build :( http://buildbot.rust-lang.org/builders/auto-bsd-64-opt/builds/4166/steps/test/logs/stdio
[01:38:21] *** Quits: marcusklaas (marcus@moz-14bm7d.upc-g.chello.nl) (Client exited)
[01:38:57] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:39:27] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:43:00] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[01:44:18] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[01:45:05] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:46:58] *** Quits: srh (User@moz-p1jfmh.biz.rr.com) (Quit: Leaving)
[01:47:16] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[01:47:53] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[01:48:38] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[01:48:48] <sfackler> erickt: that's been happening for months
[01:49:34] *** Joins: reem (reem@moz-hl7lok.coob.q2h1.0009.2601.IP)
[01:49:34] <erickt> someone needs to invent a deterministic operating system
[01:53:02] *** Joins: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com)
[01:54:19] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[01:55:14] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[01:57:32] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[02:01:03] *** Quits: c74d (c74d3a4ebb6@moz-9ju4vo.mggc.hibn.4404.2002.IP) (Connection closed)
[02:01:30] *** Joins: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP)
[02:03:01] * WindowsBunny invents a brick
[02:03:11] <WindowsBunny> Totally deterministic
[02:04:41] <huon> doesn't have much 'operating' though
[02:05:02] *** Quits: nawns (nawns@moz-0l6.cn2.211.128.IP) (Client exited)
[02:07:12] <sfackler> as_path seems to be somewhat of a usability regression in certain contexts
[02:07:29] <sfackler> e.g. some_os_string.as_ref().join("foo.rs") doesn't work
[02:07:36] <sfackler> where s/as_ref/as_path/ did
[02:09:35] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:10:29] <sfackler> which now has to be split into 3 lines (!) if some_os_string is env::var_os("FOO").unwrap()
[02:12:54] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[02:14:06] <sfackler> i.e. https://github.com/sfackler/rust-postgres/commit/f680c44d8f57c64c36b1c41a54f12d9df5225d24#diff-a7b0a2dee0126cddf994326e705a91eaL1
[02:14:16] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[02:17:13] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[02:17:14] *** ChanServ sets mode: +o brson
[02:23:45] *** Quits: ytain_ (ytain@moz-ldmhhn.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[02:29:53] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:32:11] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[02:32:35] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[02:39:56] *** Quits: eddyb (eddyb@moz-ule.hlc.26.188.IP) (Ping timeout: 121 seconds)
[02:40:35] *** Joins: mystor_ (mystor@moz-ldavpp.home3.cgocable.net)
[02:42:29] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[02:51:23] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[02:53:35] *** Joins: hoverbea_ (hoverbear@moz-csaicn.gv.shawcable.net)
[02:54:40] *** Quits: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP) (Connection closed)
[02:55:05] *** Joins: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP)
[02:56:26] *** Quits: hoverbear (hoverbear@moz-csaicn.gv.shawcable.net) (Ping timeout: 121 seconds)
[03:06:33] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[03:08:00] *** Quits: reem (reem@moz-hl7lok.coob.q2h1.0009.2601.IP) (Connection closed)
[03:09:57] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[03:12:33] *** Quits: achernya (quassel@moz-8tbl8i.6686.inna.4830.2001.IP) (Ping timeout: 121 seconds)
[03:12:35] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[03:12:43] *** Joins: achernya (quassel@moz-i01917.mit.edu)
[03:14:27] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[03:16:38] *** Quits: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com) (Ping timeout: 121 seconds)
[03:19:59] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[03:20:30] *** Joins: {-}grant ({0}grant@moz-k7fknj.mo.charter.com)
[03:23:45] *** Quits: kimundi (kimundi@moz-b2ofg1.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:25:57] *** Joins: zz_kimundi (kimundi@moz-9s9t8j.dip0.t-ipconnect.de)
[03:25:58] *** zz_kimundi is now known as kimundi
[03:30:15] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-kddbau.dynamic.qsc.de) (Ping timeout: 121 seconds)
[03:49:50] <WindowsBunny> Why is MemoryMap marked deprecated? D:
[03:50:17] <WindowsBunny> and furthermore, why does it say the replacement is in std::env?
[03:55:08] <reem> std::os got a blanket deprecation redirecting to std::env
[04:04:04] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[04:08:34] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[04:10:23] *** Joins: marsel (user@moz-70g.6r9.234.188.IP)
[04:16:04] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[04:16:04] *** ChanServ sets mode: +o pcwalton
[04:21:33] *** Joins: eddyb (eddyb@moz-ule.hlc.26.188.IP)
[04:22:06] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Ping timeout: 121 seconds)
[04:24:48] *** Joins: yjv (yjv@moz-capr3f.wa.comcast.net)
[04:27:33] *** Joins: semarie (semarie@moz-72p.nhl.10.176.IP)
[04:29:56] *** theme is now known as move
[04:30:27] *** move is now known as move||{exprs}
[04:31:10] *** move||{exprs} is now known as theme
[04:37:34] <theme> Why isn't std::convert the same as the RFC?
[04:39:09] <theme> The design is here https://github.com/rust-lang/rfcs/blob/master/text/0529-conversion-traits.md#detailed-design
[04:39:26] <theme> the RFC describes As, AsMut, To, Into, From
[04:39:40] <theme> But std::convert has AsRef, AsMut, Into, From
[04:39:44] <theme> http://doc.rust-lang.org/nightly/std/convert/
[04:39:49] <theme> why don't they match?
[04:40:59] *** Quits: marsel (user@moz-70g.6r9.234.188.IP) (Ping timeout: 121 seconds)
[04:41:19] *** Quits: yjv (yjv@moz-capr3f.wa.comcast.net) (Quit: Leaving...)
[04:46:49] *** Quits: japaric (japaric@moz-lgr.14p.64.181.IP) (Quit: WeeChat 1.1.1)
[04:47:21] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[04:56:29] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[04:57:51] <Mutabah> theme: Naming patterns?
[04:57:55] <Mutabah> theme: Check the commit logs
[04:58:05] <theme> lemme see
[04:58:14] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[04:59:00] <theme> Why remove To?
[04:59:06] <Mutabah> theme: I would gess that To and From are basically the same
[04:59:49] <Mutabah> theme: And As became AsRef for naming reasons
[05:02:15] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[05:02:15] *** ChanServ sets mode: +o pcwalton
[05:02:44] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[05:07:25] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[05:09:11] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[05:11:52] *** Joins: marsel (user@moz-le0.end.162.188.IP)
[05:11:56] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[05:12:39] *** Quits: mystor_ (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[05:15:18] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[05:16:17] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[05:19:11] *** Quits: hoverbea_ (hoverbear@moz-csaicn.gv.shawcable.net) (Quit: Time to hibernate.... ZzZz...)
[05:19:11] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[05:21:54] *** Quits: {-}grant ({0}grant@moz-k7fknj.mo.charter.com) (Connection closed)
[05:22:23] *** Quits: O01eg (o01eg@moz-3pqblv.qive.3egh.2698.2a02.IP) (Client exited)
[05:36:19] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[05:40:51] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[05:41:39] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[05:42:31] *** Quits: zeiris (zeiris@moz-8jbmam.letter.agency) (Ping timeout: 121 seconds)
[05:42:32] *** Joins: zeiris (zeiris@moz-8jbmam.letter.agency)
[05:51:36] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[05:51:36] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[05:51:45] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[05:54:00] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:00:18] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[06:00:33] *** Quits: adu (ajr@moz-0foa9t.md.comcast.net) (Client exited)
[06:04:40] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[06:10:37] *** Joins: guewen (guewen@moz-ftf7u4.cust.swisscom.ch)
[06:16:47] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[06:17:16] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[06:22:34] *** Quits: njn (chatzilla@moz-mv909v.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0a1/20150322160652])
[06:25:12] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[06:28:07] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[06:30:30] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[06:31:26] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Connection closed)
[06:33:18] *** Quits: bpayton (bpayton@moz-ifileu.ph.cox.net) (A TLS packet with unexpected length was received.)
[06:35:00] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[06:36:57] *** Joins: mib_dl4lwy (Mibbit@moz-ull.qqj.213.67.IP)
[06:37:01] <mib_dl4lwy> http://www.officedepot.com/a/products/470635/HP-ENVY-5660-e-All-in/
[06:37:12] <mib_dl4lwy> http://www.officedepot.com/a/products/470635/HP-ENVY-5660-e-All-in/
[06:37:29] <mib_dl4lwy> How can someone who is almost 30 and never had a job get one? I have been applying(fast food, retail, entry level) just to be told I am not what they are looking for (We have reviewed your application for this position and will be proceeding with other candidates at this time.) or they are not hiring..
[06:39:36] <eddyb> mib_dl4lwy: how are you still here?
[06:40:50] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Ping timeout: 121 seconds)
[06:41:43] <eddyb> bstrie: do you not have ops?
[06:41:50] <bstrie> I do
[06:41:59] <bstrie> oh I see
[06:42:07] *** mib_dl4lwy was kicked by bstrie ()
[06:42:31] <eddyb> bstrie: and #rust-gamedev, but you're not even in there!
[06:42:33] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:42:47] <sfackler> what kind of spammer links to printers?
[06:43:19] <bstrie> desperate printer salesmen
[06:43:26] <bstrie> going door-to-door don't work so well these days
[06:43:33] <bstrie> gotta go knocking on channels instead
[06:45:11] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[06:45:45] *** Joins: bjz (bjz@moz-b43.1aa.161.202.IP)
[06:46:27] <sfackler> is there a reason we don't have something like http://doc.rust-lang.org/std/slice/trait.SliceConcatExt.html#tymethod.connect that takes an iterator?
[06:47:32] *** Quits: guewen (guewen@moz-ftf7u4.cust.swisscom.ch) (Ping timeout: 121 seconds)
[06:47:52] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[06:48:34] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[06:49:40] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[06:50:02] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[06:50:17] <eddyb> sfackler: it exists because it's more efficient than a folder
[06:50:40] <eddyb> I thought huon mentioned something that worked on iterators, and was more general
[06:51:21] <eddyb> maybe an adaptor that repeats something between other elements
[06:51:37] *** Joins: mib_dl4lwy (Mibbit@moz-ull.qqj.213.67.IP)
[06:53:04] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[06:53:38] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[06:56:01] <ChrisMorgan> eddyb: interleaving
[06:56:52] <eddyb> ChrisMorgan: so do we have .interleave(", ").collect()?
[06:57:42] <ChrisMorgan> I don’t believe we actually have it in the standard library, but it’d probably be of the form .interleave(iter::repeat(", ")).collect().
[06:58:57] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[06:59:05] <eddyb> ChrisMorgan: wouldn't that give you a ", " after each element?
[06:59:18] <eddyb> or maybe not. it seems confusing to take an iterator
[07:00:08] <ChrisMorgan> It’ll vary, precisely what you want. I guess I would expect a plain interleave to put a trailing comma too, which is not what is desired.
[07:00:36] <ChrisMorgan> Really, I suppose interleaving is flattened zipping; (1, 2, 3).zip((4, 5, 6)) => (1, 4), (2, 5), (3, 6), where (1, 2, 3).interleave((4, 5, 6)) => 1, 4, 2, 5, 3, 6.
[07:02:18] *** sunfish is now known as sunfish-away
[07:02:40] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[07:03:03] *** Joins: guewen (guewen@moz-ftf7u4.cust.swisscom.ch)
[07:04:19] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[07:04:28] <eddyb> ChrisMorgan: you can actually get that with zip and flat_map
[07:04:45] <eddyb> Some(a).into_iter().chain(Some(b).into_iter())
[07:05:26] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[07:12:58] *** Quits: semarie (semarie@moz-72p.nhl.10.176.IP) (A TLS packet with unexpected length was received.)
[07:13:10] *** Joins: semarie (semarie@moz-5gr25r.telostor.ca)
[07:14:09] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:22:52] *** Quits: bjz (bjz@moz-b43.1aa.161.202.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:24:39] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[07:24:43] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[07:25:09] <bstrie> `pub fn join_path(&self, p: ~Path) -> PathBuf {` HOW OLD IS THIS RFC
[07:25:53] <bstrie> oh I see, it's proposing syntax... gross :)
[07:26:17] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[07:27:20] *** Quits: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net) (Ping timeout: 121 seconds)
[07:29:11] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[07:30:10] *** Quits: jxv (jxv___@moz-2celrt.res.rr.com) (Quit: Leaving)
[07:30:48] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[07:34:11] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[07:34:29] *** Joins: marcusklaas (marcus@moz-14bm7d.upc-g.chello.nl)
[07:34:50] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[07:35:10] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[07:35:44] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[07:38:29] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[07:39:10] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[07:39:51] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[07:40:02] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:40:21] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[07:40:41] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[07:41:02] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[07:43:31] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[07:45:00] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[07:50:51] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Ping timeout: 121 seconds)
[07:52:28] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Connection closed)
[07:58:27] <eddyb> bstrie: for... what, &own?
[07:58:32] <eddyb> oh, no
[07:59:09] <eddyb> for<P where Path: From<P>>
[08:00:36] *** Joins: ptalbot (ptalbot@moz-g2mokk.ircam.fr)
[08:10:59] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[08:13:51] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[08:17:59] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[08:18:47] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[08:20:11] *** Joins: reem (reem@moz-cst05h.coob.q2h1.0009.2601.IP)
[08:20:54] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Connection closed)
[08:23:21] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[08:24:38] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[08:25:10] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (A TLS packet with unexpected length was received.)
[08:27:19] *** Quits: reem (reem@moz-cst05h.coob.q2h1.0009.2601.IP) (Connection closed)
[08:28:58] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[08:30:37] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Ping timeout: 121 seconds)
[08:33:24] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[08:34:29] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[08:36:00] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[08:36:11] *** Quits: Diamond (dick@moz-s67uin.ok.cox.net) (Ping timeout: 121 seconds)
[08:38:43] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[08:40:22] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[08:40:22] *** ChanServ sets mode: +o pnkfelix
[08:42:12] *** Joins: imperio (Mibbit@moz-psdrik.rev.sfr.net)
[08:43:22] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[08:44:56] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Quit: Leaving)
[08:45:02] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[08:47:40] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[08:48:00] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[08:48:57] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[08:51:01] *** Joins: Diamond (dick@moz-s67uin.ok.cox.net)
[08:52:10] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[08:54:34] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[08:57:52] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[08:58:19] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[08:58:57] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[09:02:20] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[09:02:34] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[09:07:05] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Connection closed)
[09:08:02] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[09:08:55] *** Joins: larhat (Adium@moz-8v4.af0.232.213.IP)
[09:09:06] *** Quits: larhat (Adium@moz-8v4.af0.232.213.IP) (Quit: Leaving.)
[09:11:34] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[09:12:30] *** Quits: marcusklaas (marcus@moz-14bm7d.upc-g.chello.nl) (Client exited)
[09:12:40] *** Joins: larhat (Adium@moz-8v4.af0.232.213.IP)
[09:13:00] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[09:16:11] *** Joins: mjboa_ (mike@moz-iddgte.dip0.t-ipconnect.de)
[09:17:30] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[09:17:50] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[09:19:34] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[09:21:35] *** Joins: eibwen (eibwen@moz-srkqmj.dip0.t-ipconnect.de)
[09:21:47] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[09:23:35] *** Joins: laumann (thomas@moz-1i4.hq0.225.130.IP)
[09:23:38] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[09:23:45] *** Quits: marsel (user@moz-le0.end.162.188.IP) (Ping timeout: 121 seconds)
[09:24:10] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[09:24:13] *** Quits: nrc|afk (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:25:32] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[09:27:16] *** Joins: kmcguire_ (kmcguire@moz-c955nf.res.rr.com)
[09:30:01] *** Quits: kmcguire (kmcguire@moz-c955nf.res.rr.com) (Ping timeout: 121 seconds)
[09:31:34] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (Ping timeout: 121 seconds)
[09:32:00] *** Joins: marcusklaas (marcus@moz-fid941.adsl.xs4all.nl)
[09:34:47] *** Joins: marsel (user@moz-ug8.56k.180.94.IP)
[09:35:16] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[09:42:45] <bstrie> I'm a little mad that I have to first implement PartialEq and Eq in order to implement Ord
[09:43:17] <eddyb> bstrie: can't derive?
[09:43:34] <bstrie> I'd be surprised, let me try
[09:43:37] <bstrie> it's a contrived example
[09:44:05] <eddyb> bstrie: what type is it?
[09:44:12] <bstrie> ...holy shit
[09:44:15] <bstrie> how does it know
[09:44:17] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Client exited)
[09:44:21] <eddyb> uhm...
[09:44:26] <bstrie> it's just `struct Foo { field: i32 }`
[09:44:26] <eddyb> bstrie: so it's something trivial?
[09:44:35] <eddyb> that's what deriving is for
[09:44:36] <bstrie> right, like I said, contrived
[09:44:43] <bstrie> I'm impressed
[09:45:03] <bstrie> and I'm still mad that implementing Ord forces you to redundantly implement PartialEq
[09:45:22] <bstrie> like, I'm already telling you when it's equal, you're just forcing me to tell you twice
[09:47:10] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[09:54:01] *** Quits: eddyb (eddyb@moz-ule.hlc.26.188.IP) (Ping timeout: 121 seconds)
[09:54:41] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[09:55:22] *** Quits: mib_dl4lwy (Mibbit@moz-ull.qqj.213.67.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:57:17] *** Quits: mjboa_ (mike@moz-iddgte.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[09:58:05] <bstrie> the output of these derived traits looks positively horrific
[09:58:40] <bstrie> I was trying to figure out the logic by which it was ordering a struct of two fields, but now I think I don't want to know
[09:59:37] <bstrie>                             if __test ==
[09:59:37] <bstrie>                                    ::std::option::Option::Some(::std::cmp::Ordering::Equal)
[09:59:40] <bstrie>                                {
[09:59:42] <bstrie>                                 ::std::option::Option::Some(::std::cmp::Ordering::Equal)
[09:59:45] <bstrie>                             } else { __test }
[10:00:32] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[10:01:37] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[10:02:04] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[10:03:20] <bstrie> so yeah, it just compares fields in the order they are defined
[10:03:35] <bstrie> which means that if you derive any of these traits, the order of your fields is now part of your public api
[10:03:47] <bstrie> that sounds problematic
[10:04:05] <pnkfelix> bstrie: what other option is there?
[10:04:19] <pnkfelix> bstrie: (for automatic deriving, that is)
[10:04:56] <pnkfelix> bstrie: i.e. one needs to decide how to prioritize between how one's fields compare...
[10:05:14] <pnkfelix> (having said that, I do see that there is a potential footgun there)
[10:05:19] <bstrie> pnkfelix: the option is to not allow anyone to derive Ord. not saying that's a good option, but the current behavior can also be a footgun
[10:07:09] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[10:10:08] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[10:11:14] *** Joins: arrrrrrr1 (arrrrrrrrs@moz-kddbau.dynamic.qsc.de)
[10:11:39] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[10:11:50] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[10:13:05] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[10:14:03] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[10:16:16] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-kddbau.dynamic.qsc.de) (Ping timeout: 121 seconds)
[10:21:51] <Mutabah> Is -1 a token in its own right, or is it unary - and 1?
[10:26:23] *** Quits: marsel (user@moz-ug8.56k.180.94.IP) (Ping timeout: 121 seconds)
[10:27:06] <pnkfelix> Mutabah: its unary - and 1
[10:27:13] * pnkfelix was just looking at this last night
[10:27:30] <pnkfelix> Mutabah: I don't know the motivation. It might make my life easier if that were parsed as a single token.
[10:27:40] <Mutabah> Kinda same here
[10:27:43] <Mutabah> but more complex lexing
[10:28:11] <pnkfelix> from what I saw, the lexer's already got practically all the info it needs
[10:28:17] <Mutabah> yeah
[10:28:53] *** Joins: minzh (minzh@moz-u8rq5v.citrix.com)
[10:29:16] <pnkfelix> https://github.com/rust-lang/rust/blob/master/src/libsyntax/parse/parser.rs#L1511
[10:29:41] <pnkfelix> the immediate difficulty is that the AST does not have a way to represent a negative literal.  :)
[10:30:13] <pnkfelix> (okay, fair, I'm looking at the parser; not the lexer...)
[10:33:06] *** Quits: minzh (minzh@moz-u8rq5v.citrix.com) (Ping timeout: 121 seconds)
[10:33:07] <laumann> trying to run "make check-stage1" I get some errors compiling rustdoc that should have been fixed here https://github.com/rust-lang/rust/pull/23674
[10:33:29] <imperio> Mutabah: are powersgang on github ? I hope my PR didn't offend you haha
[10:33:57] <Mutabah> imperio: Ah, so that was you :D
[10:34:05] <Mutabah> I know full well that I can't spell sometimes
[10:34:15] <Mutabah> Hence the name of my major project ;D
[10:34:27] <imperio> Don't worry, english isn't my native language so I share the feeling ^^
[10:34:47] <Mutabah> ... I'm West Aus born and bred... I should get it right
[10:34:58] <laumann> sorry, false alarm
[10:35:05] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[10:35:12] <Mutabah> pnkfelix: Funtime
[10:35:29] <Mutabah> Yeah, that's kinda what prompted my question
[10:35:53] <Mutabah> (mrustc also stores literals as u64, but I negated in AST at one point
[10:36:34] <imperio> Mutabah: I'm french. So I guess I should too ? (despite the fact that french are very bad for speaking foreign languages haha)
[10:36:34] * Mutabah is away (Dining)
[10:37:43] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[10:39:19] <pnkfelix> imperio: BTW there is french-speaking #rust-fr
[10:39:55] <pnkfelix> imperio: (or in my case, french-learning...)
[10:40:03] <imperio> pnkfelix: there're too much channels now
[10:40:24] <pnkfelix> imperio: well i figured you might like the one that caters to your language.  Its pretty low traffic.
[10:40:25] <imperio> pnkfelix: ya I know, I'll see you at the next rust meeting at paris normally (a shame you weren't there last time !)
[10:40:40] <pnkfelix> imperio: oh okay so you already know about the channel.
[10:42:12] *** Quits: kmcguire_ (kmcguire@moz-c955nf.res.rr.com) (Ping timeout: 121 seconds)
[10:42:57] <imperio> pnkfelix: I was referring to your french learning, it is in your profile's description on meetup website ^^
[10:43:07] <imperio> (creepy guy mode *on*)
[10:43:15] <pnkfelix> imperio: I trust that Simon managed it okay in my absence? Did he do the thing where he split it into multiple small groups?
[10:44:11] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[10:44:21] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[10:44:25] <imperio> pnkfelix: I stayed 2 hours and Then I had to leave (RER and some shitty paris' stuff..). But yes, it was very nice. When I left, he was about to split in groups, we were choosing topics
[10:44:56] <pnkfelix> imperio: oh, what happened for the first two hours?  Presentation(s)?
[10:45:13] *** Joins: killercu_ (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[10:46:20] <imperio> pnkfelix: presentations of some rust projects (next time I think I'll present some of mine, I was too shy for that unfortunately...), food, drink and conversations
[10:46:42] <pnkfelix> imperio: okay cool, I'm happy to hear that.
[10:47:27] <imperio> pnkfelix: don't worry, he did his *job* just fine and it was a pleasure for me to follow all this. I hope to see you here next time
[10:47:40] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[10:49:35] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[10:49:48] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[10:50:49] <pnkfelix> imperio: oh yes, i'm sure.  I'm quite happy to hear that people were presenting their projects
[10:51:17] <pnkfelix> imperio: I mean, I hope the small groups are fun for people, but I want to encourage people to advertise their projects.
[10:52:17] <imperio> pnkfelix: there were only one formal presentation. It was more, people said they needed something and others said to them "that lib does it". A lot of people who came didn't know rust so it was more natural to do it that way
[10:52:28] <pnkfelix> imperio: ah I see
[10:52:36] *** Joins: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com)
[10:53:09] <imperio> next time I present rgtk hehe
[10:54:48] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[10:57:13] *** Quits: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP) (Ping timeout: 121 seconds)
[11:00:06] *** Joins: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP)
[11:01:57] <bstrie> why does the following work: `fn foo(bar: &mut Vec<i32>) { let qux = &*bar; }`
[11:02:09] <bstrie> doesn't that violate the invariant that the &mut is the only way to refer to a thing
[11:04:10] <huon> because bar can't be used mutably while qux exists
[11:05:09] <bstrie> I figured that much out by experimentation, but I've been telling people that the mere existence of a &mut precludes & pointing to the same
[11:05:16] <bstrie> not sure how to explain this now
[11:06:01] <huon> you can only mutate via a &mut if it's guaranteed to be the unique usable path to that data
[11:06:28] <huon> key point being usable
[11:06:39] <pnkfelix> bstrie: you could distinguish between, i dunno, "usable" versus "frozen"
[11:07:29] <pnkfelix> bstrie: (where the `&mut` is temporarily frozen so that one cannot mutate via that path while the `&` exists)
[11:08:11] <bstrie> it just seems inconsistent with the fact that `let x = &mut foo; let y = &foo;` is a compiler error
[11:08:12] <pnkfelix> bstrie: but I admit this may be awkward.  I will think on it further.  (nmatsakis probably has some pithy way of putting it that I am forgetting.)
[11:08:21] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[11:08:34] <huon> imperio: pnkfelix: what's this "small groups" thing? (I'm running meetups here, so ideas for what to do is nice)
[11:08:44] <huon> bstrie: it's not inconsistent: if you go via `x`, it's fine
[11:08:57] <pnkfelix> huon: After we finish with presentation(s) at the meetup
[11:09:06] <pnkfelix> huon: we pass a pile of sticky notes around
[11:09:15] <imperio> huon: we pick subjects and then people join group who talk about the topic they're interested in
[11:09:20] <bstrie> huon: good point
[11:09:38] <pnkfelix> huon: and invite people to write down a topic they would feel comfortable "leading" (they need not be experts; they just need to be interested in it, and able to ask the right questions)
[11:09:40] <huon> bstrie: (that is, foo isn't directly connected to `x`)
[11:09:52] <pnkfelix> huon: then we take the pile of topics and put them up on a wall
[11:10:09] <pnkfelix> huon: and have everyone come up and put a mark on all the topics they would be interested in
[11:10:48] <pnkfelix> huon: (oh, first, before the marking, I as organizer have gone up and spoke about each of the topics out loud, in an attempt to clarify what the topic is for everyone)
[11:10:56] <imperio> pnkfelix: ah, that's different from last time. We didn't put a mark on topic we would be interested in.
[11:11:14] <pnkfelix> huon: and then after the marking, we take the top 3 to 5 topics and assign a table to each one of the topics
[11:11:46] <pnkfelix> imperio: Were there only a few post-its?  If there's <=5, then there's no need to vote
[11:12:18] <imperio> pnkfelix: I think it was that
[11:12:21] <pnkfelix> huon: anyway we've only started doing this very recently, but it seemed to work really well the time I did it.
[11:12:25] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[11:12:25] <huon> pnkfelix: ah, sounds great
[11:13:12] <pnkfelix> huon: (i walked around and sat with tables that seemed to be stalled. e.g. one table was "?Sized WTF"
[11:13:29] <pnkfelix> huon: so they sort of needed me to sit with them and tell them the tale of DST
[11:13:36] <huon> nice
[11:13:44] <huon> that sounds like a really interesting thing to do
[11:13:49] <pnkfelix> huon: which was a fun trip down memory lane
[11:13:53] * huon will try
[11:13:58] <imperio> huon: from the newbie point of view, it is
[11:14:35] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Quit: Leaving)
[11:14:43] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[11:14:43] *** Joins: ytain (ytain@moz-ldmhhn.dsl.teksavvy.com)
[11:14:56] <huon> do the discussions peter out quickly? or would it be good to have an hour (or more)?
[11:15:42] <pnkfelix> huon: I think it might depend on the topic
[11:16:11] <pnkfelix> huon: but you make a good point; perhaps it could make sense to have multiple rounds
[11:16:16] <imperio> huon: and on the group members' level
[11:16:21] <pnkfelix> huon: or maybe just let people move from table to table
[11:16:29] <pnkfelix> huon: (s/let/encourage/)
[11:17:37] <bstrie> anyone here familiar with the rand crate? I'm trying to figure out why the Sample and IndependentSample traits have methods that take &mut self http://doc.rust-lang.org/rand/rand/distributions/struct.WeightedChoice.html
[11:18:11] <bstrie> or really I'm trying to figure out why the constructor to WeightedChoice takes a &mut Vec, and that's my only lead so far
[11:18:16] <huon> Sample is a more general version of IndependentSample
[11:18:40] <huon> the Sample vs. IndependentSample distinction is irrelevant
[11:18:53] <bstrie> I'm just curious about the use of mutability
[11:19:00] <huon> it takes &mut because it fiddles with the list to be as fast as possible
[11:20:30] <bstrie> it would be nice to have that documented, as so far the only implementations I've looked at have all just delegated sample to ind_sample
[11:21:20] <huon> AFAIR, this does that too
[11:22:09] <huon> I want to change to to work with Vec<T> and &mut [T] etc.
[11:22:43] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[11:22:53] *** Joins: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP)
[11:27:13] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Ping timeout: 121 seconds)
[11:27:59] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[11:29:42] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:32:00] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[11:39:08] *** Joins: eddyb (eddyb@moz-ule.hlc.26.188.IP)
[11:47:41] *** Joins: jasdvfsaef (Mibbit@moz-r5p.f33.174.217.IP)
[11:57:49] *** Joins: marsel (user@moz-ieu.rhb.147.46.IP)
[12:01:29] <bstrie> hm, I have a &[T] and I'm trying to get a &mut [T]. normally to do & to &mut I'd just clone the referent, but [T] doesn't implement Clone...
[12:03:55] <eddyb> bstrie: don't even think about transmutting
[12:04:17] <bstrie> well I came in here to ask if there was any way to do this without resorting to unsafe :P
[12:06:27] <eddyb> bstrie: .iter().cloned().collect::<Vec<_>>()
[12:07:01] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[12:07:14] <bstrie> being able to avoid iterators was the second thing that I wanted to ask :P
[12:07:50] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[12:08:35] <eddyb> why?
[12:09:04] <bstrie> because it seems like that heap allocation should be avoidable
[12:09:12] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[12:09:23] <eddyb> bstrie: not physically possible
[12:09:28] <eddyb> where are you going to put the clones?
[12:10:12] <bstrie> on the stack, ideally :P
[12:11:57] <eddyb> bstrie: that's not ideal at all
[12:12:07] <eddyb> bstrie: the stack is quite limited in size
[12:12:11] <bstrie> we already have the &[T] on the stack
[12:12:26] <eddyb> why is it immutable?
[12:12:45] <bstrie> shrug, I'm helping someone weld APIs together
[12:12:46] <eddyb> (there is no way, not even an unsafe one, to do VLAs in Rust. you need language-level support - sorry!)
[12:13:14] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[12:13:14] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:13:39] *** Parts: jasdvfsaef (Mibbit@moz-r5p.f33.174.217.IP) ()
[12:14:04] *** Joins: petrochenkov (Mibbit@moz-r5p.f33.174.217.IP)
[12:14:10] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[12:15:23] <eddyb> (if there was, you could do `&mut [mem::uninitialized(); n]` and then write clones over)
[12:18:42] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Ping timeout: 121 seconds)
[12:22:43] *** Quits: marcusklaas (marcus@moz-fid941.adsl.xs4all.nl) (Client exited)
[12:26:00] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[12:30:14] *** Quits: petrochenkov (Mibbit@moz-r5p.f33.174.217.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:35:31] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[12:39:57] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[12:43:03] *** Joins: Guest63 (textual@moz-qfs.570.70.83.IP)
[12:43:14] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[12:48:30] *** Joins: bdero (bran@moz-9sokv2.mit.edu)
[12:49:05] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[12:52:13] <bstrie> nmatsakis: ping
[12:55:09] *** Quits: Kxepal (Miranda@moz-poo2t8.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[12:55:11] *** Joins: Kxepal (Miranda@moz-tpmras.pppoe.mtu-net.ru)
[12:57:05] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[12:57:27] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[13:00:07] *** Joins: arrrrrrr1 (arrrrrrrrs@moz-kddbau.dynamic.qsc.de)
[13:02:01] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[13:02:47] <nmatsakis> bstrie: yes
[13:02:52] *** Joins: quigglesd (Mibbit@moz-juv.9o3.252.72.IP)
[13:05:42] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[13:06:25] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[13:06:43] *** Quits: quigglesd (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:07:35] <bstrie> nmatsakis: regarding https://github.com/rust-lang/rust/issues/17884 , I'm content if complications keep a blanket impl from being feasible, but I'm wondering if as a stopgap we could just make #derive(Copy) automatically imply #derive(Clone)
[13:09:27] <nmatsakis> bstrie: I would like that. Ah, shoot, that reminds me, I also think that we should make `Copy: Clone`
[13:09:38] <nmatsakis> bstrie: and derive(Eq) => PartialEq
[13:09:39] <nmatsakis> and so on
[13:09:54] <nmatsakis> well, and Ord => PartialOrd
[13:10:03] <nmatsakis> are there any other similar cases ?
[13:10:27] <bstrie> those three are all things that would have made me happy today :)
[13:10:32] <nmatsakis> bstrie: as an aside, I have been working in the background semi-slowly on a design for specialization, which I think solves all of these problems...
[13:10:43] <nmatsakis> well, not ALL, but at least the copy clone one :)
[13:10:55] <nmatsakis> and is even backwards compat to boot
[13:14:29] *** Quits: Tobba|Laptop (Tobba@moz-1hh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[13:15:03] <bstrie> nmatsakis: what does `Copy: Clone` buy us?
[13:16:37] *** Quits: ptalbot (ptalbot@moz-g2mokk.ircam.fr) (Ping timeout: 121 seconds)
[13:19:30] <nmatsakis> bstrie: what sense does it make to have a type that is Copy but not Clone?
[13:19:46] <nmatsakis> Copy seems like a refinement on Clone
[13:20:07] <nmatsakis> Clone=="it can be cloned" and Copy=="moreover it can be done with just memcpy"
[13:20:28] <nmatsakis> why this matters: 
[13:20:35] <nmatsakis> we can make generic APIs that are T: Copy
[13:20:39] <nmatsakis> and later change them to T: Clone
[13:20:43] <nmatsakis> backwards compatibly
[13:22:38] <doener> mw: ping
[13:22:46] <mw> doener: pong
[13:26:15] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[13:26:15] *** ChanServ sets mode: +o pnkfelix
[13:26:37] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[13:27:35] <doener> mw: I was trying to print the value of some "static mut" in gdb and that fails with: No type "BLA" within class or namespace "foo_mod".
[13:27:41] <doener> mw: is that a known problem?
[13:27:51] *** Quits: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP) (Connection closed)
[13:28:13] <doener> gdb in fact tab-completed the name in the print command to foo_mod::BLA::hdee0508ffeba69f0haa which makes me extra confused
[13:28:46] <mw> so BLA is the name of the variable?
[13:28:47] *** Joins: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP)
[13:29:08] <doener> mw: yeah. mod foo_mod { pub static mut BLA: i32 = 32; }
[13:29:09] <mw> there have been problems like this
[13:29:18] <mw> let me take a look
[13:29:44] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[13:31:59] <mw> doener: does `p 'foo_mod::BLA' ` work? 
[13:32:10] *** Joins: ptalbot (ptalbot@moz-o7b.pls.102.129.IP)
[13:33:30] <doener> mw: `p 'foo_mod::BLA::stupid_hash' ` works
[13:34:07] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[13:34:18] <mw> doener: without the hash it doesn't?
[13:34:30] <doener> mw: no
[13:35:00] <doener> mw: that says: No symbol "foo_mod::BLA" in current context.
[13:35:34] <mw> doener: and if you additionally qualify with the crate name?
[13:35:52] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[13:36:06] <doener> mw: this is in the executable crate
[13:36:50] <mw> doener: you still have to add the crate name in front
[13:37:05] <mw> doener: at least that's what we do in the autotests
[13:37:15] <doener> oh, right, that works
[13:37:43] <mw> doener: I dimly remember GDB having problems with statics and namespaces, even with Clang generated C++ code, I think
[13:38:08] <doener> ok
[13:38:34] <doener> mw: anyway, this is enough for me for now. Thanks a lot!
[13:38:51] <mw> doener: you're most welcome :)
[13:40:29] *** Joins: marcusklaas (marcus@moz-ihcq83.q0lg.2sgh.0982.2001.IP)
[13:43:58] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[13:45:31] *** Quits: rovar (rovar@moz-m2j7h0.dyn.optonline.net) (NickServ (RECOVER command used by Guest762))
[13:45:31] *** Guest762 is now known as rovar
[13:45:44] *** Joins: rovar_ (rovar@moz-m2j7h0.dyn.optonline.net)
[13:48:24] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[13:50:27] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[13:57:37] *** Joins: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl)
[14:00:53] <mw>  doener: I just tried your example in C++ compiled with Clang 3.5 on Ubuntu and GDB can correctly resolve globals in namespaces there, so this is something we should be able to do too in theory. I'll see if I need to open an issue about that
[14:03:15] *** Quits: arrrrrrr1 (arrrrrrrrs@moz-kddbau.dynamic.qsc.de) (Client exited)
[14:03:54] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[14:06:09] *** Quits: ptalbot (ptalbot@moz-o7b.pls.102.129.IP) (Ping timeout: 121 seconds)
[14:10:42] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[14:18:52] *** Joins: ptalbot (ptalbot@moz-g2mokk.ircam.fr)
[14:19:59] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Ping timeout: 121 seconds)
[14:20:58] *** Quits: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP) (Connection closed)
[14:21:24] *** Joins: c74d (c74d3a4ebb6@moz-1rc5g6.mggc.hibn.4404.2002.IP)
[14:23:15] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:23:51] *** Joins: kushal (kdas@moz-s3u5m7.202.sitibroadband.in)
[14:32:01] *** Quits: bdero (bran@moz-9sokv2.mit.edu) (Ping timeout: 121 seconds)
[14:40:52] *** Quits: untitaker (untitaker@moz-0g9kb3.highway.telekom.at) (Ping timeout: 121 seconds)
[14:42:14] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[14:44:29] *** Joins: canhtak (canhtak@moz-kcs.u0t.149.5.IP)
[14:46:55] *** Joins: untitaker (untitaker@moz-goipkr.highway.telekom.at)
[14:48:56] *** Joins: bdero (bran@moz-u8a.gci.189.18.IP)
[14:51:36] *** Joins: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at)
[14:58:42] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[14:58:45] *** Quits: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at) (Connection closed)
[15:02:46] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[15:03:11] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:03:13] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[15:03:33] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:09:36] *** Joins: jasperfd (Mibbit@moz-juv.9o3.252.72.IP)
[15:10:34] *** Quits: jasperfd (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:10:51] *** sunfish-away is now known as sunfish
[15:12:44] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:13:32] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:14:14] *** Joins: mjboa (mike@moz-hs4k1n.dip0.t-ipconnect.de)
[15:15:18] *** Quits: aatch (james@moz-rkcq9l.0k7n.u6dj.e000.2406.IP) (Ping timeout: 121 seconds)
[15:21:03] <phaylon> I've been wondering, since rustc-serialize has been externed, is the intern serialize still in core because libsyntax needs something to test for the deriving stuff?
[15:21:34] <eddyb> phaylon: test? no
[15:21:37] <eddyb> phaylon: it's used by rustc
[15:22:10] <eddyb> dammit I need to clear that stuff up, too
[15:22:14] <eddyb> so much to do for beta :(
[15:22:37] <imperio> eddyb: need help ?
[15:23:01] <phaylon> eddyb: yea, I've been thinking about cleaning up the encoder/decoder traits, but it's a bit of a rabbit hole
[15:23:12] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:23:17] <eddyb> imperio: well, there's a way to use macros to generate the impls
[15:23:23] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:23:39] <eddyb> imperio: which would allow users of rustc_serialize (and the compiler itself) to stop depending on deriving
[15:24:11] <imperio> eddyb: ok, what do want me to do ?
[15:24:51] <eddyb> there would be a macro_rules macro that takes a struct/enum definition and emits the same definition (including attributes) but also implements the traits
[15:25:10] <eddyb> I wonder if lifetime/type arguments and bounds will cause issues
[15:26:40] <eddyb> imperio: the hard part is generating binding names for patterns: match *self { Foo(a, b, c) => {...} }. that can be done by zipping the unnamed field type list with a long list of identifiers (from a to z for example)
[15:27:13] *** sunfish is now known as sunfish-away
[15:27:31] <eddyb> imperio: I haven't tried yet to do it, but I believe it's possible
[15:27:42] <phaylon> hm, so if I were to do some cleaning up proposals of the encoder/decoder traits, that would mean it impacts libsyntax, libserialize, and rustc-serialize, correct?
[15:27:55] <phaylon> or am I missing parts?
[15:28:15] <eddyb> phaylon: and librustc. astencode specifically is a mess
[15:28:21] *** Joins: aatch (james@moz-4tpcve.pd7t.fvcm.e000.2406.IP)
[15:28:23] <phaylon> oh
[15:28:32] <phaylon> guess I know what stopped the last guy who tried :)
[15:30:56] *** Quits: bdero (bran@moz-u8a.gci.189.18.IP) (Ping timeout: 121 seconds)
[15:31:20] <imperio> eddyb: hum... Not a field I worked on yet. I can do some stuff on it but I'll need a lot of indication for it
[15:31:22] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[15:31:54] *** Quits: marsel (user@moz-ieu.rhb.147.46.IP) (Ping timeout: 121 seconds)
[15:31:57] <eddyb> imperio: if you're going to waste hours fiddling with macros I say it's not worth it
[15:32:02] <eddyb> (speaking from... experience :P)
[15:32:17] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:32:50] <imperio> ok then haha
[15:33:19] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[15:33:23] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:33:47] <imperio> It's a few days I didn't worked on rustc. I miss it :'(. All issues are almost solved or outdated
[15:35:14] *** Quits: guewen (guewen@moz-ftf7u4.cust.swisscom.ch) (Quit: Leaving...)
[15:35:33] *** sunfish-away is now known as sunfish
[15:36:37] <erickt> steveklabnik: ping
[15:37:06] <phaylon> eddyb: rustc is just using the serialization stuff, though, right?
[15:37:18] <gleb> when trying to compare `ref String` with a string literal in a pattern match guard I get `PartialEq<str> is not implemented for String` which gets fixed by taking a reference of the string literal (e.g. some_str == &"text")
[15:37:20] <steveklabnik> erickt: pong
[15:37:23] <phaylon> I'd hope an interface cleanup  wouldn't have too much impact there
[15:37:27] <gleb> should said implementation exist?
[15:37:50] <erickt> steveklabnik: howdy! just wanted to let you know https://github.com/rust-lang/rust/pull/23719 failed a build in case you didn't see it
[15:38:17] <steveklabnik> roger, thanks :)
[15:38:25] <steveklabnik> i hadn't done my 'check up on my PRs' yet, but i'll do that now :)
[15:38:32] <eddyb> phaylon: rustc is calling the methods directly and other nasty stuff
[15:38:49] <erickt> and gah! why is my build failing on bsd!
[15:39:02] <steveklabnik> erickt: oh no, but my commits have nothing do with a rustc_driver :(
[15:39:03] <phaylon> eddyb: oh, that... is suboptimal then
[15:39:18] <Rym> steveklabnik: are there any docs on usize vs u64/u32 for pointing people to? 
[15:39:20] <phaylon> let me guess, there also isn't an abstraction facility yet :)
[15:39:25] <erickt> steveklabnik: no, I don't think it's from you
[15:39:40] <steveklabnik> Rym: http://doc.rust-lang.org/nightly/std/primitive.usize.html etc
[15:40:01] <phaylon> with that amount of work, I'll probably first prep a pre-rfc for internals._. don't want to waste all that time with something non-realistic
[15:40:10] <eddyb> imperio, phaylon: I'm already stuck :)) http://is.gd/8SRNvf
[15:41:04] <Rym> steveklabnik: okay, but nothing explaining what usize represents? (aka native pointersize / max reachable memory?)
[15:41:09] <imperio> eddyb: oh, that's fine for the moment haha
[15:41:21] <steveklabnik> Rym: the usize page probably needs some work, that should say that on it
[15:41:40] <eddyb> imperio: I was trying to see if I can at least match all the grammar. I haven't even added type params yet :(
[15:41:55] <Rym> steveklabnik: okay, thanks anyway!
[15:42:19] <phaylon> eddyb: enums are going to be really ouch I think. and are what I actually set out to fix :)
[15:42:21] <imperio> that's what I saw, I was wondering why you didn't add it
[15:42:38] <eddyb> imperio: because it's already not working
[15:42:41] <eddyb> (try to run it)
[15:42:47] <erickt> does anyone have a bsd machine that could help me debug http://buildbot.rust-lang.org/builders/auto-bsd-64-opt/builds/4173/steps/test/logs/stdio?
[15:43:24] <phaylon> eddyb: I've been wondering if there could be a library using rustc to parse code, but then give a real-simple ast that's just for that kind of inflation
[15:43:41] <eddyb> phaylon: talk to erickt about that :P
[15:43:53] <erickt> phaylon: howdy!
[15:44:02] <phaylon> heh, I was quite sure I was not the first one :)
[15:44:09] <phaylon> erickt: hello!
[15:44:11] <erickt> I got a few projects that are foundational work for that
[15:44:18] <phaylon> nice, on github?
[15:44:40] <erickt> phaylon: https://github.com/erickt/rust-syntex, which extracts libsyntax in order to do codegen
[15:44:54] <erickt> phaylon: https://github.com/erickt/rust-aster, which provides a builder interface for making ast
[15:45:00] <imperio> eddyb: that's very weird, hold on, I take a deeper look at it !
[15:45:13] <eddyb> imperio: oh, I didn't think to try something
[15:45:13] <phaylon> I just did some thinking and note-taking. mostly inspired by the rustfmt parsing talks, if there could be a purely syntactical ast that can serve more purposes than just formatting
[15:45:23] <imperio> eddyb: please do
[15:45:26] <erickt> phaylon: and https://github.com/erickt/rust-quasi, which extracts the quasi quoter
[15:45:35] *** Joins: marsel (user@moz-ieu.rhb.147.46.IP)
[15:45:36] <phaylon> erickt: excellent, I'll have a look, thanks
[15:45:38] <eddyb> imperio: http://is.gd/97s1JY
[15:45:59] <eddyb> imperio: so passing the tt's is the problem
[15:46:05] <erickt> it's all still oriented towards generating ast, not parsing it
[15:46:20] *** Joins: aochagavia (Mibbit@moz-lia.kkh.107.145.IP)
[15:46:33] <imperio> eddyb: yes it was, I was looking for something further that
[15:46:45] <aochagavia> Anyone knows where a macro definition is parsed? (macro_rules!)
[15:46:52] *** Joins: bdero (bran@moz-9sokv2.mit.edu)
[15:47:01] <aochagavia> I have been looking in the lexer and parser, but was unable to find it
[15:47:07] <eddyb> aochagavia: libsyntax/ext/tt
[15:47:10] <eddyb> or something
[15:47:18] <phaylon> erickt: it's certainly a good step
[15:48:11] <eddyb> <anon>:18:43: 18:53 error: `$name:ident` is followed by a sequence repetition, which is not allowed for `ident` fragments
[15:48:13] <eddyb> :/
[15:48:21] <aochagavia> is it intended to allow matchers without parentheses? like macro_rules! example { $s:expr => $s; }
[15:48:34] <aochagavia> that is causing an ICE right now
[15:48:44] <eddyb> aochagavia: heh, I think someone mentioned that it is... kinda. idk
[15:48:55] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[15:49:05] <aochagavia> eddyb: the grammar in the reference only allows it parenthesised
[15:49:07] <steveklabnik> well it shouldn't ICE for sure
[15:49:23] *** Joins: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at)
[15:49:26] <eddyb> aochagavia: never trust the reference
[15:49:32] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[15:49:34] <phaylon> man, I did syntax extensions in perl. didn't expect the rust equivalent to reel me in as well. anyway, lots of reading to do :)
[15:49:51] <eddyb> imperio: http://is.gd/MOpjri lol, it's not in the struct macro :/
[15:49:52] <imperio> eddyb: http://is.gd/euoz02
[15:49:55] <aochagavia> eddyb: who should I trust then?
[15:50:13] <aochagavia> eddyb: I'll just allow it and see what the reviewer says
[15:50:38] <eddyb> imperio: omg I'm an idiot
[15:50:43] <eddyb> I wrote rest instead of $rest
[15:51:06] <eddyb> <anon>:19:30: 24:28 warning: struct is never used: `Foo`, #[warn(dead_code)] on by default
[15:51:11] <imperio> eddyb: I didn't even see that O.o
[15:51:22] <imperio> eddyb: then could my code have worked ? weird
[15:51:46] <eddyb> so the basics work: http://is.gd/z7rf2g
[15:52:00] *** Quits: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at) (Connection closed)
[15:52:39] <phaylon> might still go the pre-rfc route though. I'm a bit unsure if structures with named fields really should always provide the encoder/decoder with field position/structure len information
[15:52:49] <imperio> eddyb: have you take a look at my "fix" ? It's weird that it seems to work
[15:53:03] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:53:04] <phaylon> but gotta see what rustc uses that for first as well
[15:53:05] <eddyb> imperio: you're calling the struct macro, not the main one
[15:53:10] <imperio> however mine works in two step
[15:53:34] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:53:40] <eddyb> imperio: you're using serializable_struct
[15:53:51] <eddyb> imperio: not serializable
[15:54:04] <imperio> eddyb: erf, didn't work on the good one then haha
[15:54:27] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[15:56:11] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[15:57:14] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[15:57:51] *** Quits: laumann (thomas@moz-1i4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[15:58:03] *** Joins: mw (mw@moz-f1s7jp.vie.surfer.at)
[16:00:24] <eddyb> http://is.gd/gGEo1R
[16:00:26] <eddyb> hehehe
[16:00:42] *** Joins: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca)
[16:00:46] <eddyb> erickt: have you ever seen string literal tokens use for the interleave thing?
[16:00:52] <eddyb> *used
[16:01:27] <eddyb> self.0 and self.1 are hardcoded, and that's to be fixed. hmm
[16:02:14] <bstrie> eddyb: explain the hack
[16:02:23] <eddyb> bstrie: which one?
[16:02:27] <bstrie> line 1
[16:02:34] <bstrie> macro_rules! item { ($x:item) => { $x } } // HACK
[16:02:53] <eddyb> bstrie: I'm passing a bunch of token trees into that and they get parsed properly to an item
[16:02:54] <phaylon> eddyb: that is quite nice
[16:03:02] <eddyb> bstrie: because of some normalization
[16:03:02] <aochagavia> eddyb: I am trying to solve https://github.com/rust-lang/rust/issues/23701, could you help me a bit?
[16:03:03] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[16:03:28] <eddyb> bstrie: you can't just "return" token trees from a macro_rules macro, they're not flattened properly into tokens the parser understands :(
[16:03:43] <aochagavia> eddyb: it looks like when the TokenTree is a TtToken you get an ICE
[16:03:52] * eddyb wonders if his literature homework is worth fighting for
[16:03:56] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:04:22] <eddyb> aochagavia: follow check? cmr did that AFAIK
[16:05:58] <aochagavia> eddyb: what do you mean by follow check? (I am not a native english speaker)
[16:06:33] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[16:07:25] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:09:59] *** Quits: nottc (nottc@moz-md0.0k4.168.66.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:10:04] *** Quits: imperio (Mibbit@moz-psdrik.rev.sfr.net) (Quit: http://www.mibbit.com ajax IRC Client)
[16:10:12] <eddyb> aochagavia: it doesn't mean anything particularily interesting in English either
[16:10:32] <eddyb> aochagavia: but it checks, for example, that you do not write $foo:expr : in a macro
[16:10:52] <eddyb> aochagavia: because future features could add : to Rust expression syntax (type ascription)
[16:11:14] <eddyb> <anon>:7:40: 7:55 error: inconsistent lockstep iteration: '"fname"' has 21 items, but '"fty"' has 2
[16:11:35] <eddyb> fair enough, I need to zip them. but it's interesting that I can mix them even if they don't come from the same repetition
[16:14:27] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[16:14:41] <aochagavia> eddyb: does that happen before or after compiling a macro?
[16:15:04] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[16:15:26] <eddyb> <anon>:9:28: 9:39 error: `$fty0:ty` is followed by a sequence repetition, which is not allowed for `ty` fragments
[16:15:29] <eddyb> wtf
[16:15:38] <eddyb> aochagavia: macros are not "compiled"
[16:16:53] <aochagavia> eddyb: well, there is a `compile` function
[16:17:01] <aochagavia> eddyb: in macro_rules.rs
[16:17:14] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[16:17:15] <aochagavia> eddyb: I guess it's just a very bad name
[16:17:54] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[16:18:32] <eddyb> erickt: http://is.gd/68I4xa
[16:18:53] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:20:12] <eddyb> erickt: http://is.gd/eVXFw9
[16:20:21] <eddyb> type params tho
[16:20:51] <eddyb> I may be able to cook something up for the bound-less case
[16:24:27] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[16:25:06] *** Parts: mw (mw@moz-f1s7jp.vie.surfer.at) ("")
[16:25:12] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:26:16] *** Joins: bpayton (bpayton@moz-ifileu.ph.cox.net)
[16:28:23] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[16:28:36] *** Quits: aochagavia (Mibbit@moz-lia.kkh.107.145.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:29:14] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:29:30] *** Quits: Guest63 (textual@moz-qfs.570.70.83.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:33:35] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[16:34:09] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:34:42] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[16:34:53] *** Joins: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com)
[16:35:25] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[16:35:41] *** Joins: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at)
[16:36:04] <simukis> acrichto: ping https://github.com/rust-lang/rust/pull/23674#issuecomment-86458778
[16:36:17] *** Quits: marcusklaas (marcus@moz-ihcq83.q0lg.2sgh.0982.2001.IP) (Client exited)
[16:36:38] *** Quits: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at) (Connection closed)
[16:38:56] <acrichto> simukis: hm I had to revert that to land a rollup, although I didn't realize I was reverting that
[16:39:08] <acrichto> e.g. I got compile errors if they were removed
[16:39:17] <simukis> hmm, odd
[16:40:21] <simukis> acrichto: could this be stage0 vs stage1?
[16:40:34] *** Joins: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at)
[16:41:18] *** Quits: dinfuehr (dinfuehr@moz-ksecm6.tuwien.ac.at) (Connection closed)
[16:41:31] *** Quits: det (chris@moz-da97an.lv.cox.net) (Connection closed)
[16:42:18] <acrichto> simukis: if you compile rustdoc at stage0 perhaps, but that normally doesn't happen
[16:42:28] <simukis> acrichto: check-stage1
[16:42:30] <acrichto> rustdoc is only built with the stage1+ compiler so it should never need #[cfg(stage0)]
[16:42:37] <acrichto> yeah that may build rustdoc at the earlier stage
[16:43:45] <simukis> which suggests the proper fix is to to a snap
[16:45:30] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[16:46:50] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Ping timeout: 121 seconds)
[16:49:03] *** Joins: vhbit (textual@moz-u66.qv5.65.95.IP)
[16:50:04] <acrichto> simukis: https://github.com/rust-lang/rust/pull/23738
[16:50:45] <simukis> acrichto: thanks! that has been blocking my rebase for days now. I’ve even had forgotten about it until today
[16:53:44] *** Quits: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[16:53:57] *** Joins: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl)
[16:54:16] *** Quits: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[16:54:29] *** Joins: w66745 (Mibbit@moz-b11uqs.dynamic.upc.nl)
[16:54:49] *** Joins: O01eg (o01eg@moz-6rk0n4.pneq.4n8f.2698.2a02.IP)
[16:57:50] *** Joins: det (chris@moz-da97an.lv.cox.net)
[16:59:15] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[17:03:37] *** Quits: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[17:05:45] <Eridius> std::borrow::IntoCow was destabilized, saying it may be replaced by convert::Into, but it doesn't look like convert::Into works with Cow at the moment
[17:12:24] <simukis> *may* be replaced
[17:14:01] <Eridius> ugh, the new trivial_numeric_casts lint warns against things like `somei32 as c_int`
[17:14:20] <Eridius> which means I have to have a-priori knowledge that a given type is merely a type alias in order to avoid the cast
[17:14:23] <pnkfelix> hmm I thought that was explicitly discussed and going to be handled
[17:14:27] <pnkfelix> i.e. not warned on
[17:14:31] * pnkfelix goes to review
[17:14:53] <Eridius> and I'm concerned now that a type whose definition changes based on build configuration (e.g. I assume c_long does this) will require the "trivial" cast anyway
[17:15:03] <Eridius> pnkfelix: rust-lua sprouted a _ton_ of trivial numeric cast warnings
[17:15:15] <Eridius> because I cast between Rust fixed-length times (e.g. i32) and libc types (e.g. c_int) all over the place
[17:15:25] <simukis> doesn’t this lint warn because you should be using type ascription instead?
[17:15:32] <pnkfelix> oh I see, I think our "handling" was to distinguish "trivial numeric cast" from other "trivial casts"
[17:15:58] <pnkfelix> in other words rust-lua may want to just do `#![allow(trivial_numeric_cast)]`
[17:16:18] <Eridius> pnkfelix: yeah maybe I should. Still, I think maybe this lint should explicitly not warn you if you're casting between type aliases
[17:17:00] <Eridius> simukis: type ascription is correct if you're trying to constrain a type. But if you're converting between types then you need a cast instead. But if the types happen to be type aliases of each other then it will be deemed "trivial" :/
[17:18:53] <Eridius> yeah, trivial_numeric_casts is absolutely incorrect when using types like c_long because removing the cast will break compilation on some architectures
[17:19:18] *** Joins: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk)
[17:20:29] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[17:21:28] <Eridius> filed as rust-lang/rust#23739
[17:21:56] *** Quits: vhbit (textual@moz-u66.qv5.65.95.IP) (Quit: Textual IRC Client: www.textualapp.com)
[17:22:17] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[17:27:46] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[17:30:44] *** Quits: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[17:31:10] *** Joins: avikpal (avikpal@moz-t31.2fd.194.117.IP)
[17:32:39] *** Quits: avikpal (avikpal@moz-t31.2fd.194.117.IP) (Connection closed)
[17:33:37] *** Joins: avikpal (avikpal@moz-t31.2fd.194.117.IP)
[17:34:43] <eddyb> we could mark certain aliases as... non-total
[17:35:22] <eddyb> and special-case `as TypeAlias` to look for that attribute
[17:35:28] <eddyb> not sure I like it very much though
[17:37:05] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[17:37:29] *** Quits: canhtak (canhtak@moz-kcs.u0t.149.5.IP) (Client exited)
[17:39:38] <blaenk> damn I'm lucky eddyb liked that bound-targeting coercions idea cause he knows all the right people and knows what it would take to make it happen ;o seems like nmatsakis and aturon seem to be in favor too
[17:40:43] *** Joins: sprang (sprang@moz-2if.7vl.56.172.IP)
[17:42:10] <eddyb> blaenk: well, I've been playing with coercions and there's some room for improvement
[17:43:05] <blaenk> yeah also forgot you're all up in the coercions part of rustc, having implemented deref coercions etc iirc
[17:43:48] <eddyb> yeah. the way those work is repeatedly applying autoderef until the resulting type matches (or there's nothing left to deref)
[17:44:36] <blaenk> yeah. I remember back when I first mentioned the idea to you of btc (before you named it) I was wondering how you would know which 'list' of potential targets to coerce to
[17:44:39] <eddyb> you can replace the "type matches expected" with "type satisfies bounds associated with the expected inference type variable"
[17:44:46] <blaenk> ahhh
[17:47:22] <aturon> blaenk: yes, i think it's a lovely idea; kimundi and I had thought about a more limited version in the context of the Pattern API (limited to deref coercions only), but the full version seems more principled
[17:48:19] <blaenk> ooo
[17:48:32] <aturon> bstrie: sorry, in answer to your question yesterday about API evolution guidelines, the plan is to put out an RFC fairly soon after beta
[17:49:02] <bstrie> aturon: cool
[17:49:24] <eddyb> blaenk: unsizing coercions from &[T; N] to &[T] would work nicely as well
[17:49:48] <eddyb> blaenk: the unbounded ones are to trait objects, but I'm not sure how many usecases that has
[17:49:53] <aturon> acrichto: i don't know if you saw from huon, but the downfall of the `derive(From(u32))` idea is that you really want an `Option` return value, so `From` isn't really the right trait
[17:50:16] <aturon> (because you want to be able to write `MyEnum::from(some_int)`)
[17:50:25] <blaenk> eddyb: yeah I saw you mentioning &[T; N] to &[T] that's an awesome consequence I hadn't thought of
[17:50:38] <eddyb> oh, Type::from is actually a nice use of the traits :D
[17:50:56] <eddyb> blaenk: that's not deref coercions, but quite useful in a bunch of cases
[17:51:20] <aturon> eddyb: it's probably my favorite aspect of the new conversion traits -- got to deprecate a bunch of ad hoc conversion constructors, so instead you just use `Type::from` everywhere
[17:51:36] <eddyb> aturon: I'm not too happy about AsRef though
[17:51:47] <acrichto> aturon: oh grr
[17:51:54] <aturon> eddyb: why not?
[17:52:23] <eddyb> acrichto: maybe impl From<u32> for Option<MyEnum> would work?
[17:52:36] <eddyb> aturon: well, at least we shouldn't suggest replacing as_slice with as_ref
[17:52:51] <aturon> eddyb: it would work, but then `MyEnum::from` wouldn't
[17:52:56] <acrichto> what aturon said
[17:52:58] <eddyb> :(
[17:53:03] <aturon> eddyb: so, the suggestion was replacing AsSlice with AsRef
[17:53:12] <aturon> eddyb: maybe the deprecation message should be more clear
[17:53:24] <aturon> that is, the main use for `AsSlice`/`Str` has been generic programming over conversions
[17:53:28] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:53:29] *** ChanServ sets mode: +o brson
[17:53:31] *** Joins: yjv (yjv@moz-3kp.t7p.56.172.IP)
[17:53:32] <aturon> and *that* is intended to go via `AsRef` instead
[17:54:16] <aturon> (whereas as_slice can either be replaced by nothing via deref coercions, or [..] notation)
[17:54:33] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[17:54:48] <eddyb> aturon: okay, that makes more sense, I'm still surprised to hear about so many as_slice calls when they have been unnecessary for months now
[17:55:03] <eddyb> that's what happens when you don't deprecate early, I guess
[17:55:06] <aturon> eddyb: as was i
[17:55:26] <eddyb> woo learning experiences
[17:55:32] <nmatsakis> aturon: so is vec.as_ref() more-or-less equivalent to vec.as_slice() ?
[17:55:40] <nmatsakis> but less recommended than &vec[..]?
[17:55:44] <eddyb> nmatsakis: only with the right expected type
[17:55:44] <aturon> nmatsakis: no, it's not equivalent
[17:55:50] <aturon> what eddyb said :)
[17:55:50] <nmatsakis> ok that's what I expected
[17:56:43] <nmatsakis> carllerche was complaining that `&b"123"[..]` is significantly less good than `b"123".as_slice()`
[17:56:45] <aturon> nmatsakis: one piece of feedback i've been hearing a lot recently is about `b"blah"` which now produces a fixed-length array
[17:56:58] <nmatsakis> right
[17:57:03] <aturon> right, so the hope was that [..] would rarely be needed
[17:57:06] <nmatsakis> because coercions aren't quite roking well enough
[17:57:08] <nmatsakis> *working
[17:57:13] <aturon> yes
[17:57:14] <nmatsakis> b"123"[] would have been fine ;)
[17:57:17] <aturon> ha
[17:57:33] <eddyb> [..] looks like a pig snout
[17:57:34] <aturon> though having .. for a range is useful elsewhere, e.g. vec.drain(..)
[17:57:38] <eddyb> but I see nothing else wrong with it
[17:57:48] <nmatsakis> aturon: I'm not proposing a change :)
[17:57:57] <nmatsakis> I guess
[17:58:03] <nmatsakis> oh, well, &*b"123" doesn't work
[17:58:08] <nmatsakis> which looks kind of weird anyway
[17:58:16] <aturon> nmatsakis: but yes, i am worried about the complaint, which i've heard from many others as well
[17:58:19] <bstrie> nmatsakis: would you like me to file an issue for the Copy/Clone/Ord etc stuff from this morning?
[17:58:46] <aturon> bstrie: nmatsakis: oh, speaking of which, i presume we can't simply put in the inheritance without other changes to e.g. derive?
[17:58:47] <nmatsakis> bstrie: yeah, it's getting late to do such a change, I should try to prototype the Copy:Clone  thing in particular I guess
[17:59:03] <nmatsakis> aturon: you mean making Copy : Clone?
[17:59:10] <aturon> yeah
[17:59:13] <nmatsakis> I don't see why derive cares about that
[17:59:16] <bstrie> nmatsakis: I don't think it's too late to have derive copy automatically give you clone as well
[17:59:26] <nmatsakis> I don't either, just that sooner the better
[17:59:36] <bstrie> should it be an RFC?
[17:59:39] <aturon> nmatsakis: hm, i thought we had discussed some error handling
[17:59:40] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
[18:00:09] <aturon> but yeah, if you don't have the time to do it, i'd be glad to
[18:00:28] <nmatsakis> bstrie: that's what I was wondering
[18:00:35] <eddyb> I should write the RFC for future-proofing size_of *right now*
[18:00:41] <eddyb> before I forget about it
[18:00:44] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[18:00:45] <bstrie> eddyb: do it
[18:00:45] <nmatsakis> eddyb: what exatly did you have in mind?
[18:01:00] <bstrie> eddyb: did you ever write that rfc to remove static mut
[18:01:02] <nmatsakis> aturon: only trick part is that Copy is a builtin -- but I think ... it should be pretty easy to make the chagne
[18:01:03] *** Joins: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP)
[18:01:11] <eddyb> bstrie: pre-RFC waiting on const fn...
[18:01:18] <eddyb> bstrie: which won't be stable so the argument barely holds
[18:01:32] <nmatsakis> eddyb: oh, let me merge that, shoot
[18:01:40] <nmatsakis> I meant to do that yesterday
[18:01:57] <eddyb> TBH, brson wanted some changes to it
[18:02:23] <nmatsakis> eddyb: I mean, to be clear, idea was to merge RFC on experimental basis, but not to commit to const fn approach 
[18:02:40] <nmatsakis> which is not to say you can't make edits to it now
[18:02:45] <bstrie> nmatsakis: I'll write up the RFC today that only proposes the tag-along derives, thus leaving Copy: Clone for you :)
[18:02:46] <nmatsakis> just saying it'd be fine to make edits later too :)
[18:02:47] <aturon> sfackler: btw, i saw some worries yesterday about as_path, i have some revisions in the works that should help, but also keep in mind you can use e.g. `Path::from`
[18:02:57] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[18:03:05] <eddyb> nmatsakis: the trailing padding stuff. adding an mem::array_stride function that is defined as (&xs[1] as *const _ as usize) - (&xs[0] as *const _ as usize) and specifying ptr.offset does a similar thing
[18:03:11] <sfackler> aturon: oh yeah, good point
[18:03:14] <eddyb> that the size_of future-proofing
[18:03:41] <nmatsakis> eddyb: I see; that makes sense, tbh I forget anymore what sizeof returns in that respect
[18:03:52] <eddyb> nmatsakis: right now we do the C thing
[18:04:00] <aturon> sfackler: basically if as_ref is being used in a context other than T: AsRef<U>, then something is amiss; there is still scope for specific named conversions like `to_path_buf` etc, precisely for ergonomic reasons
[18:04:22] <aturon> sfackler: (though i do wish `thing.as<OtherType>()` could've worked out)
[18:04:41] <eddyb> aturon: overload as
[18:04:42] <nmatsakis> eddyb: which seems good for sizeof
[18:04:52] <nmatsakis> eddyb: at least I'd expect it to be equiv to the C operator
[18:04:57] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[18:04:59] <eddyb> nmatsakis: only for #[repr(C)]
[18:05:26] <aturon> eddyb: the main holdup was actually the :: requirement, which pushed it over the ergonomic edge imo (well, that and that you need a kind of double-dispatch)
[18:05:50] <eddyb> aturon: as in, `thing as OtherType` going through From
[18:06:01] <eddyb> too much?
[18:06:11] <aturon> eddyb: yeah, you could consider that. also https://github.com/aturon/rfcs/blob/conversion-traits/text/0000-conversion-traits.md#an-aside-codifying-the-generics-pattern-in-the-language
[18:06:39] <aturon> eddyb: (which, incidentally, might make it possible to use generics in a limited way for trait objects, since it would be resolved client-side)
[18:06:45] <eddyb> nmatsakis: having everything else C-like is locking us to certain layout choices
[18:07:26] <erickt> eddyb: hm? Oh, I think I've seen that hack somewhere for converting a token tree into an expression
[18:07:29] <blaenk> hahaha aturon awesome ~ use, also remember the idea of using it in return type position for the `impl Trait` thing, would be `~Trait`
[18:07:43] <aturon> blaenk: yep, i'm not sure which i like better :)
[18:07:45] <blaenk> either one use awesome use
[18:07:57] <blaenk> if there were a good way to resurrect it it'd be one of those
[18:08:04] <nmatsakis> eddyb: seems like we already state that the memory layout of tpyes that are not repr(C) is not stable
[18:08:15] <nmatsakis> eddyb: doesn't that imply that sizeof's return result is not stable?
[18:08:18] <eddyb> nmatsakis: I want a definition which involves "mutable bytes" or "bytes touched by an assignment"
[18:08:27] <erickt> eddyb: that's pretty nifty!
[18:08:42] <eddyb> nmatsakis: oh, yeah, but people are bound to use it for array strides... hmm...
[18:09:02] <eddyb> nmatsakis: maybe I don't need to write that RFC and I can pop that off the queue
[18:09:18] <nmatsakis> eddyb: well, wait, what I meant was
[18:09:30] <nmatsakis> eddyb: it's not guaranteed not to change between compiles or lang versions or something
[18:09:57] <nmatsakis> eddyb: ok, wait, I see what you're getting at
[18:10:16] <eddyb> I'm more worried about guarantees about the relationship between the minimal value, the padded one, size_of and array_stride
[18:10:24] <nmatsakis> eddyb: you're saying if people use it for array strides and assignments, then we are locked to those being the same thing 
[18:10:33] <nmatsakis> even if it changes over time
[18:10:36] <eddyb> I want minimal <= size_of <= padded <= array_stride
[18:10:40] <nmatsakis> hmm
[18:10:44] <brson> today i'm going to focus on upgrading rustup
[18:11:04] <brson> taskcluster-crater is still full of frustrating bugs
[18:11:08] *** Joins: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk)
[18:11:20] *** Quits: mceier (mceier@moz-fm89sb.dynamic.chello.pl) (Connection closed)
[18:11:36] <eddyb> brson: alien bugs hitch-hiking meteors?
[18:11:43] * eddyb shows himself out
[18:11:59] <erickt> Yay! my deriving fix for where clauses finally landed!
[18:12:51] *** Joins: mceier (mceier@moz-fm89sb.dynamic.chello.pl)
[18:13:27] *** Joins: det- (chris@moz-95dv1s.lv.cox.net)
[18:13:53] <kmc> ++
[18:14:05] <kmc> erickt: thereby fixing the first rust bug I ever filed
[18:14:15] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[18:14:25] <eddyb> erickt: no more privacy issues?
[18:14:48] <eddyb> I remember there was something blocking it which sounded really troubling
[18:15:36] <eddyb> I think I can avoid the problem entirely with Proxy<(T, U, V), ActualFieldType>
[18:16:09] *** Quits: det (chris@moz-da97an.lv.cox.net) (Ping timeout: 121 seconds)
[18:16:25] <eddyb> where struct Proxy<TypeParams, Data>(PhantomData<(TypeParams, Data)>);
[18:17:03] <eddyb> and it implements the trait if Data does, so a where clause on Proxy will imply that Data implies the trait
[18:18:30] <imperio> the last rustc update is terrible !
[18:18:45] <eddyb> nmatsakis: thereby subverting the whole "where clause must refer to type params" thing entirely
[18:18:48] <imperio> that's the moment we understand that we did shitty code. Always nice to see...
[18:18:56] <eddyb> nmatsakis: at least for specific traits
[18:19:06] <nmatsakis> eddyb: sorry, what?
[18:19:11] <imperio> eddyb: you solved your macro issue ?
[18:19:18] <nmatsakis> eddyb: what are you talking about exactly?
[18:19:38] *** Joins: det-- (chris@moz-hj9mnd.lv.cox.net)
[18:20:02] <eddyb> nmatsakis: `where i32: Copy` is disallowed
[18:20:15] <nmatsakis> eddyb: yes, I know, what about it?
[18:20:17] <eddyb> nmatsakis: I can subvert that
[18:20:28] <nmatsakis> eddyb: oh, that's no big deal, I want to lift that restriction anyway
[18:20:31] <eddyb> not sure what usefulness it has then
[18:20:33] <eddyb> nmatsakis: oh :|
[18:20:36] <nmatsakis> not much
[18:20:39] <nmatsakis> the more interesting question is
[18:20:43] <nmatsakis> can where clauses refer to private types in pub fns?
[18:21:07] <nmatsakis> I kind think they should be able to, but it's not 100% obvious
[18:21:09] <nmatsakis> *kind of 
[18:21:10] *** Quits: det- (chris@moz-95dv1s.lv.cox.net) (Ping timeout: 121 seconds)
[18:21:19] <nmatsakis> private traits too I guess
[18:21:22] <eddyb> pub fn?
[18:21:29] <nmatsakis> pub items really
[18:21:58] <eddyb> imperio: http://is.gd/LfKxs3
[18:22:29] <imperio> eddyb: wo ! nice one ! well done =d
[18:22:35] <eddyb> nmatsakis: is `struct Foo<T>;` entirely disallowed now?
[18:23:05] <eddyb> I guess not because of PhantomData
[18:23:29] *** Quits: ptalbot (ptalbot@moz-g2mokk.ircam.fr) (Ping timeout: 121 seconds)
[18:25:46] *** Joins: det- (chris@moz-qij3pi.lv.cox.net)
[18:25:56] <eddyb> no way, this was too easy o_O
[18:26:44] *** Quits: jmitchel_ (jmitchell@moz-o8p.pug.156.104.IP) (Quit: Textual IRC Client: www.textualapp.com)
[18:26:55] *** Quits: kushal (kdas@moz-s3u5m7.202.sitibroadband.in) (Quit: Leaving)
[18:27:01] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[18:27:23] <eddyb> erickt: http://is.gd/8Iwgfw
[18:28:10] *** Quits: det-- (chris@moz-hj9mnd.lv.cox.net) (Ping timeout: 121 seconds)
[18:29:18] *** Joins: marcusklaas (marcus@moz-2i0c3k.dynamic.ziggo.nl)
[18:30:42] *** Quits: munksgaa1d (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[18:31:12] *** Quits: yjv (yjv@moz-3kp.t7p.56.172.IP) (Quit: Leaving...)
[18:33:06] <eddyb> resulting URL above character limit for sharing. Length: 5757; Maximum: 5000
[18:33:08] <eddyb> dammit playpen
[18:34:23] <barosl> https://github.com/Dobiasd/programming-language-subreddits-and-their-choice-of-words#word-usage
[18:34:27] <barosl> > Cursing
[18:34:31] <barosl> I just lol'ed
[18:34:42] <eddyb> barosl: ncurses?
[18:34:47] <eddyb> logncurses
[18:34:58] <barosl> I curse ncurses too
[18:35:14] <eddyb> n²curses
[18:35:19] <barosl> Well, are there any alternatives?
[18:35:26] <eddyb> erickt, imperio, acrichto: https://gist.github.com/eddyb/97271f8121f036fd51aa
[18:35:41] <eddyb> it can handle the basic cases in structs
[18:35:57] <imperio> eddyb: like I said, nicely done
[18:36:07] <imperio> what remains to be done then ?
[18:36:21] <eddyb> enums
[18:36:54] <eddyb> I wonder if I should do struct differently so I can reuse that stuff for enums trivially
[18:36:57] *** Quits: marcusklaas (marcus@moz-2i0c3k.dynamic.ziggo.nl) (Client exited)
[18:37:24] <imperio> you can't use it on enums directly ?
[18:37:33] <eddyb> it only expects structs
[18:37:43] <imperio> erf
[18:37:44] <eddyb> it doesn't match enums at all
[18:38:25] <imperio> I test a stuff then with your code
[18:42:14] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Ping timeout: 121 seconds)
[18:43:52] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Quit: Leaving.)
[18:50:43] *** Joins: swgillespie (swgillespie@moz-upj.3un.220.167.IP)
[18:52:21] *** Joins: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com)
[18:52:21] *** ChanServ sets mode: +o pcwalton
[18:55:45] <kmc> what's the modern equivalent to #[cfg(not(ndebug))] ?
[18:56:59] *** Joins: mib_qzvowk (Mibbit@moz-juv.9o3.252.72.IP)
[18:57:41] <Gankro> parser/lang pros, approximately how bad would being able to do something like `iter.fold(0, +)` be? Basically (some?) operators can be passed as functions without having to pull in the trait.
[19:00:14] *** Quits: mib_qzvowk (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:01:44] <eddyb> can I even match an enum? I know I can handle { Foo, Bar(T) }. but what about struct variants?
[19:01:57] <eddyb> Gankro: write _ + _ at least
[19:02:19] <eddyb> or (+) or anything that isn't just a plus token
[19:02:25] <imperio> eddyb: why not in two steps ?
[19:02:42] <imperio> you declare your enum and then you call the macro
[19:02:48] <imperio> like that is quite easy
[19:02:50] <eddyb> imperio: the problem is that something has to match the whole contents of the enum
[19:02:54] <eddyb> imperio: oh, no, that's not acceptable
[19:03:05] <imperio> hum... So only on declaration
[19:03:20] <eddyb> imperio: it's supposed to be an in-place replacement
[19:04:11] <imperio> eddyb: true, but sometimes, A little step behind can make life a lot more easier
[19:04:53] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[19:05:43] <Gankro> eddyb: _ + _ is dancing with currying, but (+) doesn't seem too bad
[19:07:18] <sfackler> kmc: I think #[cfg(debug_assertions)]
[19:09:47] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[19:16:25] *** Quits: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com) (Client exited)
[19:16:44] *** Quits: sprang (sprang@moz-2if.7vl.56.172.IP) (Ping timeout: 121 seconds)
[19:17:34] *** Quits: ytain (ytain@moz-ldmhhn.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[19:20:02] *** Joins: Rym_ (y@moz-vsu.f6d.55.31.IP)
[19:20:48] *** Quits: Rym (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[19:21:09] <kmc> sfackler: thanks
[19:22:34] <blaenk> Gankro is there a lint for https://github.com/rust-lang/rfcs/blob/master/text/0921-entry_v3.md
[19:22:40] <blaenk> to remind me to use that new api when it gets merged
[19:22:50] <blaenk> if not to put it on my reminders or something
[19:23:29] <blaenk> oh yeah there is :)
[19:24:48] <blaenk> yesss glad quotes removed from extern crate
[19:24:50] <blaenk> that was always ugly
[19:25:10] <blaenk> I figured at first it was only necessary when you used uncommon characters, but actually it always had to be used
[19:25:25] <Gankro> blaenk: Yeah the old one is deprecated
[19:25:28] <blaenk> sweet
[19:25:39] <Gankro> Unless you're using the "raw" entry API
[19:25:50] <blaenk> an explicit match blah.entry(key) {} right
[19:25:55] <Gankro> yeah
[19:26:04] <blaenk> I'm using that once or twice, but I think the deprecation messages from the others will remind me about those too
[19:26:06] <blaenk> so it's fine
[19:26:11] <Gankro> cool
[19:26:37] <kmc> what is the expected performance of checked_{add,sub,mul} vs overflow_{add,sub,mul} (which signals overflow w/ bool)
[19:27:00] *** Quits: kaptainkayak (kaptainkaya@moz-iar.moo.170.107.IP) (Quit: ZNC - http://znc.in)
[19:27:19] <nmatsakis> kmc: unclear :)
[19:27:28] <kmc> okay :)
[19:27:40] <nmatsakis> I've been wondering if we can design some kind of type such that you can collapse multiple ops
[19:27:44] <nmatsakis> and only check for overflow when you extract
[19:27:56] <nmatsakis> which could then be better optimized by LLVM sometimes
[19:28:00] <kmc> any guidelines on when I should use one or the other? just convenience?
[19:28:02] <eddyb> nmatsakis: been there done that. can be vectorize if someone adds first-class saturated arithmetic to LLVM
[19:28:07] <nmatsakis> eddyb: yeah,I know, I remember
[19:28:08] <kmc> that would be cool, and sounds doable
[19:28:18] <eddyb> *vectorized
[19:28:22] <nmatsakis> what I don't know is whether we can set it up in such a way that LLVM actually *optimizes* it
[19:28:31] <kmc> why can't it be vectorized otherwise?
[19:28:32] <nmatsakis> probably, or at least for sure if we tweak llvm
[19:28:51] *** Quits: pitdicker (Paul@moz-328u1s.adsl.online.nl) (Quit: Leaving)
[19:29:00] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[19:29:07] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:29:17] <kmc> does SPIR-V have saturating arithmetic? =)
[19:29:20] <eddyb> kmc: there is no arithmetic-with-overflow-flag for SIMD
[19:29:26] <eddyb> at least not in SSE
[19:29:26] <nmatsakis> kmc: sorry, what? I forget the details but I remember eddyb had some kind of tweak to e.g. sum the numbers in a bool and detect overflow in the end result
[19:29:46] <kmc> eddyb: ah, but there are saturating ops?
[19:29:58] <eddyb> yeah, and you can compare normal add with saturating add, for example
[19:30:09] <kmc> *nod*
[19:30:13] <eddyb> you run at half capacity but still vectorized
[19:30:18] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[19:30:45] <kmc> it could be nearly as fast
[19:31:00] <kmc> if you are not saturating the simd units otherwise
[19:31:01] <eddyb> LLVM handles the i1 created from the intrinsics pretty well, if you just branch on it (it will use a conditional jump on the OF) in straight code
[19:31:26] <eddyb> but it has no clue how to vectorize it
[19:32:27] <nmatsakis> acrichto: given the reduced role of Reflect in this design, I think it should be moved to `std::marker`, thoughts?
[19:32:56] <eddyb> kmc: but if LLVM had first-class saturating arithmetic, then it could just vectorize that - it's still commutative and associative
[19:32:57] <nmatsakis> acrichto: it seems to be basically a marker trait we can use for intrinsics (like TypeId) that would otherwise operate on any type
[19:32:58] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[19:33:39] <eddyb> kmc: and you just need an optimization for comparing unvectorized add and saturated add (to turn into add_with_overflow)
[19:33:50] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[19:34:04] *** Joins: avikpal_ (avikpal@moz-24g.dga.79.112.IP)
[19:34:21] <eddyb> saturated add is actually implemented with overflow flags, I believe, atm
[19:36:28] *** Quits: bdero (bran@moz-9sokv2.mit.edu) (Ping timeout: 121 seconds)
[19:36:39] *** Quits: avikpal (avikpal@moz-t31.2fd.194.117.IP) (Ping timeout: 121 seconds)
[19:36:41] *** Quits: swgillespie (swgillespie@moz-upj.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:38:12] <freebroccolo> nmatsakis: do you have any thoughts about this (the overflow Sized thing)? https://github.com/rust-lang/rust/pull/23580#issuecomment-86293894
[19:38:54] <freebroccolo> I'm wondering if the overflow detection is intended to rule out cases like the one in the linked issue or if it's a bug
[19:39:12] <freebroccolo> If it's the former, it seems to rule out some valid use cases IMO
[19:39:36] *** Joins: jgallagher (john@moz-6ge.dhn.131.24.IP)
[19:40:35] *** Joins: avikpal (avikpal@moz-t31.2fd.194.117.IP)
[19:41:44] *** Joins: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com)
[19:41:44] *** ChanServ sets mode: +o pcwalton
[19:41:54] *** Quits: avikpal_ (avikpal@moz-24g.dga.79.112.IP) (Ping timeout: 121 seconds)
[19:41:55] <nmatsakis> freebroccolo: so I think this is a bug, I'm trying to find the issue where it was first reported
[19:42:09] *** Joins: avikpal_ (avikpal@moz-4l9.t2s.79.112.IP)
[19:43:07] <nmatsakis> freebroccolo: basically there is code that is supposed to detect this sort of case and it was failing due to some specifics of how it was implemented...
[19:43:10] <freebroccolo> nmatsakis: ah, okay. Well there's the issue I linked in that comment and someone else linked one from there… I didn't see an earlier one afaik
[19:44:43] <freebroccolo> good to know… is it an easy fix do you think?
[19:45:15] *** Joins: jxv (jxv___@moz-qneod7.pk6i.d98i.030a.2602.IP)
[19:45:29] *** Quits: avikpal (avikpal@moz-t31.2fd.194.117.IP) (Ping timeout: 121 seconds)
[19:46:26] *** Joins: mib_c8n63b (Mibbit@moz-juv.9o3.252.72.IP)
[19:46:35] <freebroccolo> ah, I see you commented just now, thanks
[19:46:39] <nmatsakis> freebroccolo: not super easy, but I'm not sure how hard, I remember that the cause was related to us creating an infinite sequences of types due to the way we do region inference; I'll have to investigate, but I think one of my in-progress branches for fixing an unrelated issue would probably fix it (or make it easy to fix)
[19:46:50] *** Joins: avikpal (avikpal@moz-t31.2fd.194.117.IP)
[19:47:07] <nmatsakis> freebroccolo: problem is I've probably got my hands full over next day or two, trying to finish up a few beta things, but I'll try to take some time to push that branch along
[19:47:24] <nmatsakis> (or at least investigate your problem more deeply, and the other overflow problems people are seeing)
[19:47:58] <freebroccolo> cool, no problem. Mostly just wondering if I needed to start thinking about a redesign :)
[19:48:06] <nmatsakis> I hve to say though despite the inconvenience for you, I'm glad I made the overflow error reporting less "silent"... since I'm not clear on why the overflow was being swalloed before, seems wrong
[19:48:27] *** Quits: larhat (Adium@moz-8v4.af0.232.213.IP) (Quit: Leaving.)
[19:48:56] <freebroccolo> yeah, that makes sense I think
[19:49:11] <nmatsakis> your case is definitely a bug I think; the other cases I see (e.g. on the linked issue) are less clear to me, I have to look them over 
[19:49:28] <nmatsakis> in particular I want to improve overflow error reporting so it can tell you the stack of things it was doing
[19:49:40] *** Joins: nawns (nawns@moz-0l6.cn2.211.128.IP)
[19:49:44] <nmatsakis> since the only way to get that info right now is to scrape it out of the logs
[19:49:45] <freebroccolo> is it because Sized should be handled specially? From the others it looked like maybe there was some interaction with how normalization/associated type projections work or something
[19:50:07] *** Quits: avikpal_ (avikpal@moz-4l9.t2s.79.112.IP) (Ping timeout: 121 seconds)
[19:50:16] <nmatsakis> yeah, your issue is somewhat specified to Sized I think (well, to the various traits that are automatically derived)
[19:50:19] <freebroccolo> oh, that would be pretty useful
[19:50:34] <nmatsakis> maybe I'll do that first
[19:50:37] <nmatsakis> (the improved msg)
[19:51:11] <nmatsakis> it'd be so much easier to understand these bug reports if they had a nice "stack trace" of what the compiler was trying to do
[19:56:01] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[19:56:21] <freebroccolo> yeah, that would be great. I've wanted something like that when I was just poking around trying to understand some of the internals before
[19:56:52] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[19:57:02] *** Quits: mib_c8n63b (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:57:13] *** Joins: ytain (ytain@moz-ldmhhn.dsl.teksavvy.com)
[19:58:48] *** Joins: hoverbear (hoverbear@moz-uc0lqo.wireless.uvic.ca)
[20:03:33] *** Joins: iopq (Mibbit@moz-uuic7b.ca.comcast.net)
[20:05:27] <nmatsakis> aturon: ok, so, coherence (you around?)
[20:06:29] <nmatsakis> aturon: next problem is that we have to show that &String: !FnMut, which would require that FnMut be declared inextensible, which would be unfortunate
[20:06:47] *** Joins: nrc|afk (nrc@moz-4bhi2i.xtra.co.nz)
[20:06:47] *** ChanServ sets mode: +o nrc|afk
[20:07:10] <nmatsakis> aturon: though if we added the impls we want to add (there's a catch there...), then we could call FnMut inextensible, and I Think things would work out
[20:07:19] *** Quits: hoverbear (hoverbear@moz-uc0lqo.wireless.uvic.ca) (Connection closed)
[20:07:20] *** Joins: hoverbea_ (hoverbear@moz-uc0lqo.wireless.uvic.ca)
[20:07:56] *** nrc|afk is now known as nrc
[20:09:28] *** Quits: hoverbea_ (hoverbear@moz-uc0lqo.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[20:10:43] *** Quits: jxv (jxv___@moz-qneod7.pk6i.d98i.030a.2602.IP) (Ping timeout: 121 seconds)
[20:11:42] *** Joins: sprang (sprang@moz-d0kmvi.12d9.sm5v.0009.2601.IP)
[20:15:54] <acrichto> nmatsakis: could we actually get by with an unstable trait actually?
[20:16:09] <acrichto> nmatsakis: e.g. for now you're supposed to bound by Any anyway, so you shouldn't ever actually need to mention Reflect
[20:16:57] <nmatsakis> acrichto: to some extent yes
[20:17:14] <nmatsakis> acrichto: I guess maybe the answer is just  "yes"
[20:17:18] <nmatsakis> not "to some extent"
[20:17:35] <nmatsakis> yeah, I think we can get buy with marking it unstable, which makes me happy
[20:17:39] <nmatsakis> *get by
[20:17:48] <nmatsakis> I didn't like declaring it stable 
[20:18:12] <acrichto> yay! :)
[20:18:31] <nmatsakis> things I hate: errors about unused imports etc that become errors in stage1 :)
[20:18:40] <nmatsakis> or rather I hate the experience of not noticing it until stage1
[20:19:14] <nmatsakis> aturon: were you following the discussion about Reflect? TL;DR I'm tweaking the design and we can leave it unstable I think, you write `T: Any` to gain access to "any-related" functionality
[20:20:25] <aturon> nmatsakis: catching up with backscroll, just a minute
[20:20:37] <nmatsakis> I think we were discussing it mostly in #rustc :)
[20:24:39] <aturon> nmatsakis: ok, so one basic question, if Reflect isn't stable, will that be enough for reem's use cases?
[20:24:39] *** Joins: swgillespie (swgillespie@moz-upj.3un.220.167.IP)
[20:24:56] <nmatsakis> I believe so
[20:25:03] <nmatsakis> there is never a reason to mention Reflect, basically
[20:25:12] <aturon> ok
[20:25:54] <aturon> that seems like a reasonable situation for beta
[20:26:40] <aturon> nmatsakis: re: coherence, is that coming up because of Pattern?
[20:28:06] <nmatsakis> aturon: yes
[20:28:11] <nmatsakis> that said
[20:28:20] <nmatsakis> I have (had?) a working impl of the blanket impls for Fn
[20:28:27] <nmatsakis> there was a slight ergonomic hit that we could overcome in the future tho
[20:28:39] <nmatsakis> that had to do with fns like fn foo(f: &mut FnMut())
[20:28:45] <nmatsakis> basically the way that the call operator currently is impl'd
[20:29:00] <nmatsakis> writing f() currently does FnMut::call_mut(f)
[20:29:08] <nmatsakis> but when I added the blanket impls
[20:29:09] <nmatsakis> it became
[20:29:15] <nmatsakis> FnMut::call_mut(&mut f)
[20:29:17] <nmatsakis> and hence you have to write
[20:29:22] <nmatsakis> fn foo(mut f: &mut FnMut())
[20:29:24] <phaylon> *confused* so, with RustcDecodable, a struct enum variant is always treated as a tuple enum variant, but a tuple struct is always treated as a normal struct?
[20:29:40] <nmatsakis> aturon: maybe better to add the impls now and try to fix that, just to "hold the place"
[20:29:42] <aturon> nmatsakis: ah, that's a lot of mut
[20:29:47] <nmatsakis> aturon: well, not that often
[20:29:50] <aturon> yeah
[20:29:53] <nmatsakis> in particular
[20:29:55] <nmatsakis> people usually write
[20:30:04] <nmatsakis> fn foo<F>(mut f: F) where F: FnMut()
[20:30:15] <nmatsakis> where you already needed a mut :)
[20:30:22] <aturon> (this reminds me, we never did the auto-ref sugar for closures...)
[20:30:25] <nmatsakis> sorry, what I meant is,
[20:30:28] <nmatsakis> it's a lot of mut,
[20:30:30] <nmatsakis> but it doesn't occur that much
[20:30:34] <aturon> right
[20:30:36] <nmatsakis> but yeah it's real ugly when it does
[20:30:52] <nmatsakis> yes, auto-ref sugar for closures...well, it's backwards compat,
[20:30:54] <nmatsakis> we can do it later.
[20:30:54] <aturon> i think that's fine, though tbh it's probably ok to seal the trait and still add the blanket for e.g. 1.1
[20:31:01] <nmatsakis> perhaps
[20:31:08] <aturon> yeah, that sugar could be 1.0 polish
[20:31:18] <nmatsakis> that's why I've not prioritized it
[20:31:25] <aturon> (i was hoping we'd have our closure story in really strong shape for 1.0, but i think there will still be a couple of papercuts)
[20:31:33] <aturon> ok, i should've figured it was on your radar :)
[20:32:01] *** Joins: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca)
[20:32:26] <nmatsakis> ok so 
[20:32:29] <nmatsakis> my branch for Copy: Clone
[20:32:30] *** Quits: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca) (Connection closed)
[20:32:33] <nmatsakis> is already finding a bunch of missing clone impls :)
[20:32:40] <nmatsakis> turned out to be easy to implement
[20:32:50] <nmatsakis> just had to to remove an if from the compiler and add it to the Copy declaration
[20:33:12] <aturon> excellent :) i don't know why this approach didn't occur to us much sooner, but it seems quite nice
[20:33:13] <nmatsakis> makes me want to pair this change with fixing #[derive(Copy)] so it also derives Clone
[20:33:23] <nmatsakis> because it's kind of tedious to udpate all these derive lines
[20:33:40] <WindowsBunny> nmatsakis: Please make Copy imply Clone
[20:33:43] <nmatsakis> who understands deriving? :)
[20:33:48] <nmatsakis> how hard can this be
[20:33:50] <aturon> nmatsakis: huon does
[20:33:51] * erickt raises hand
[20:33:52] <nmatsakis> huon: you're not around are you?
[20:33:55] <nmatsakis> erickt: you!
[20:34:05] <erickt> what's up?
[20:34:11] <nmatsakis> erickt: what do you think about modifying deriving so that if you write derive(Copy), it implies derive(Clone)
[20:34:18] <nmatsakis> same for Eq=>PartialEq
[20:34:20] <nmatsakis> Ord=>PartialOrd
[20:34:26] <nmatsakis> not an error if they are also listed explicitly
[20:34:28] <aturon> WindowsBunny: the change in question will make Copy inherit from Clone, so you're required to impl both and if you know T: Copy then you know T: Clone
[20:34:30] <nmatsakis> that'd be the way I'd do it I think
[20:34:44] <nmatsakis> but probably people will complain "more than one way to do it"...
[20:34:56] <erickt> nmatsakis: I've thought about doing that
[20:35:15] <nmatsakis> seems like a good idea to me at this point; there is some hit if you want to implement PartialOrd manually
[20:35:20] <nmatsakis> but I think that's pretty rare
[20:35:30] <nmatsakis> and we could fix it later if we wanted
[20:35:37] <nmatsakis> #[derive(Copy-Clone)] or something
[20:36:01] <simukis> https://github.com/rust-lang/rust/pull/23738 r+ p=over-nine-thousand please?
[20:36:03] <erickt> I don't think that'd be terribly hard
[20:36:24] <WindowsBunny> nmatsakis: I don't see how you'd want a manual Clone implementation when you have Copy
[20:36:43] <simukis> WindowsBunny: copy is not recursive.
[20:36:54] <nmatsakis> simukis: ? of course it is
[20:37:02] <nmatsakis> erickt: would you mind implementing it for me? :)
[20:37:06] <simukis> nmatsakis: it just memcpys bytes, no?
[20:37:06] <nmatsakis> erickt: or giving me a pointer
[20:37:12] <erickt> :)
[20:37:18] <nmatsakis> simukis: yes, but that covers all the types that are owned by the struct
[20:37:20] <erickt> I'll take it :)
[20:37:35] <simukis> nmatsakis: s/recursive/deep copy/
[20:37:38] <nmatsakis> simukis: (and you can't implement Copy for types where that's not equivalent to clone)
[20:37:54] <nmatsakis> in paricular all clones are "sheep clones"
[20:38:08] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[20:38:27] <nmatsakis> http://www.cs.uwm.edu/faculty/boyland/fool2012/papers/fool2012_submission_8.pdf
[20:38:28] <aturon> simukis: i think the point is that Copy types are precisely those for which a shallow memcpy is equivalent to a deep copy
[20:38:37] <nmatsakis> yes, perhaps a better way to put it
[20:38:44] <nmatsakis> basically Copy is: you can clone by memcpy'ing
[20:38:59] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Connection closed)
[20:39:02] <eddyb> nmatsakis: I wish we'd use OIBIT for Copy
[20:39:22] <nmatsakis> eddyb: I don't, I'm really happy with it being opt-in
[20:39:34] <eddyb> and/or implement it everywhere possible
[20:39:37] <nmatsakis> OIBIT is kind of a misnomer now isn't it...
[20:39:42] <eddyb> but you already know my stance on that
[20:39:57] <simukis> err, what OIBIT stands for again?
[20:39:58] <nmatsakis> since it really refers to "opt-out" cases
[20:40:01] * simukis forgot
[20:40:05] <eddyb> nmatsakis: could call it ORBIT. reminds me of a brand of chewing gum, *out of all the things*
[20:40:06] <nmatsakis> it stood originally for "opt-in built-in traits"
[20:40:28] <nmatsakis> but we changed the proposal so that copy is opt-in, but send/sync are neither opt-in nor builtin 
[20:40:44] <nmatsakis> and sized is builtin and not opt-in or opt-out :)
[20:41:05] * nmatsakis what a tangled web we weave
[20:41:44] <eddyb> nmatsakis: such is the curse of Mozilla
[20:42:04] <simukis> s/OIBIT/WT/
[20:42:07] <simukis> whatever traits
[20:42:09] <nmatsakis> aturon: I guess we'd need an RFC for the derive change / copy: clone
[20:42:09] <XMPPwocky> this would be simpler if we introduced copy / move constructors (and everything else would get 100x more complex, but still)
[20:42:21] <nmatsakis> true (on both counts)
[20:42:30] <nmatsakis> another change I don't regret...
[20:42:33] <aturon> nmatsakis: yeah, i was going to say that... :)
[20:42:42] <aturon> best to just do the inheritance for now, i think
[20:43:04] <aturon> carllerche: https://github.com/rust-lang/rust/pull/23753 should help with some of the ergonomic issues around AsRef (cc sfackler)
[20:43:04] <nmatsakis> aturon: I'll make an RFC for that specifically, but it's a much more breaking change (in practice) without the derive fix
[20:43:14] <nmatsakis> aturon: I guess I can probably use perl -p -i -e to fix it locally
[20:43:23] <nmatsakis> good ol perl pie
[20:43:40] <aturon> nmatsakis: yeah, understood. OTOH, such an RFC should also cover (Partial)Ord, etc
[20:44:04] *** Quits: avikpal (avikpal@moz-t31.2fd.194.117.IP) (Connection closed)
[20:44:22] <eddyb> nmatsakis: the sheep cloning paper is interesting
[20:44:29] <eddyb> nmatsakis: and then it starts using notations
[20:45:02] *** Quits: semarie (semarie@moz-5gr25r.telostor.ca) (A TLS packet with unexpected length was received.)
[20:45:06] <erickt> sheep cloning? Please tell it's something that'd let us have a Sheep type to go with the Cow type
[20:45:13] <erickt> that would make me so very happy
[20:45:30] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[20:45:56] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[20:46:22] <acrichto> nrc: ping
[20:46:31] <nrc> acrichto: pong
[20:46:40] <imperio> new ICE !
[20:46:54] <acrichto> nrc: re https://github.com/rust-lang/rust/issues/23739, my recollection of the discussion from awhile back was that this was going to be allow-by-default?
[20:47:01] <acrichto> I should try to dig up the notes though
[20:47:31] * nrc looks up RFC
[20:48:29] <acrichto> nrc: https://github.com/rust-lang/meeting-minutes/blob/master/weekly-meetings/2015-03-03.md#type-ascription
[20:48:30] <nmatsakis> aturon: confused, I thought you just said to exclude those?
[20:48:32] <acrichto> (towards the end)
[20:48:37] <eddyb> nmatsakis: wait, Clone is sheeply?
[20:48:45] <nmatsakis> eddyb: &T does not clone the T
[20:48:56] <nmatsakis> eddyb: Rc<T> does not clone the T
[20:48:59] <eddyb> if you have Vec<Box<Rc<T>>>
[20:49:08] <aturon> nmatsakis: hm? oh sorry, i misread your original statment
[20:49:09] <nmatsakis> you clone what you own, in other words
[20:49:24] <nrc> acrichto: hmm, my understanding of that was they would both be warn by default
[20:49:24] <aturon> nmatsakis: i was assuming that Copy: Clone could land as-is
[20:49:28] <acrichto> nrc: although reading the notes it appears that I misunderstood something
[20:49:32] <acrichto> yeah :P
[20:49:37] <aturon> nmatsakis: whereas the derive changes might want an RFC discussion
[20:49:41] <acrichto> well, I will open an RFC issue on this topic
[20:49:49] <nmatsakis> aturon: ah, I see
[20:49:56] <eddyb> "Mozilla Corporation" oh I see :P
[20:49:58] *** Joins: larhat (Adium@moz-fmfrc4.mfe0.h1q1.2168.2a02.IP)
[20:50:30] <nrc> acrichto: sounds good - I don't have strong feelings either way
[20:50:35] *** Joins: hyunsik (Mibbit@moz-3qgjl9.ca.comcast.net)
[20:50:35] *** Quits: hyunsik (Mibbit@moz-3qgjl9.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:50:47] <nmatsakis> my observation is that,
[20:50:51] <nmatsakis> although lints can be #[allow]'d,
[20:50:53] <nmatsakis> nobody wants to
[20:50:53] <aturon> nmatsakis: (in particular i think we should try to make Copy: Clone happen for beta, but i see why you might want to couple them together)
[20:51:12] <nmatsakis> aturon: yeah, well, I agree that Copy: Clone must happen for beta, whereas derive could
[20:54:11] <acrichto> nrc: https://github.com/rust-lang/rfcs/issues/1020
[20:54:14] <blaenk> yessssssssssssssssssssssss Copy: Clone or something
[20:54:46] <phaylon> hm. it seems librbml is also very relevant for all serialization work
[20:54:47] <blaenk> was surprised when something like that wasn't the case already a few weeks ago
[20:54:59] <nrc> acrichto: thanks
[20:55:12] <acrichto> nrc: :\ and the other one is a false positive too?
[20:55:19] <acrichto> nrc: this seems like a bad state of affairs :\
[20:55:30] <nrc> which other one?
[20:55:32] <aturon> blaenk: for a long time we thought about it in terms of having a blanket impl of Clone for Copy, but recently realized that just making Copy: Clone would go most of the way with relatively little pain (especially with #derive changes)
[20:55:41] <acrichto> nrc: https://github.com/rust-lang/rust/issues/23737
[20:55:41] <nmatsakis> aturon: ok, so, good news
[20:55:52] <blaenk> yeah I was thinking blanket impl at first too but someone said something about that not working for tuples, or something about tuples
[20:55:54] <nmatsakis> aturon: I made it through in my coherence branch into libsyntax with relatively minimal changes
[20:55:58] <acrichto> nrc: as in if this lint fires, shouldn't it be expected that the cast can be removed?
[20:56:02] <blaenk> that's great
[20:56:09] <aturon> nmatsakis: whew!
[20:56:13] <acrichto> nrc: I'm fine with type ascription replacing it, but this seems like the wrong place for the lint to fire in that case
[20:56:20] <nrc> acrichto: no, not necessarily - that's why it is "trivial" not "unnecessary"
[20:56:26] <blaenk> also I've been out of the loop can someone give me a quick update on these derive changes? or is info up somewhere? is it from the conversion traits rfc?
[20:56:33] *** Joins: tcurdt (tcurdt@moz-6rer5f.cust.swisscom.ch)
[20:56:34] <aturon> blaenk: yes, exactly, with things like tuples you end up with impl coherence problems (Clone gets impl'ed in multiple ways)
[20:56:41] <blaenk> ahhh okay
[20:56:59] <aturon> blaenk: the conversion is in the scrollback on this channel, TLDR is that `#[derive(Copy)]` should also derive Clone
[20:57:07] <nrc> acrichto: I should probably add a note to the warning (can you do that with lints?)
[20:57:09] <aturon> (and perhaps similarly for Ord, Eq)
[20:57:11] <blaenk> :DD
[20:57:20] <acrichto> nrc: I feel like the current state of affairs where #[allow] is sprayed all over the compiler/stdlib and forcing everyone else to add them as well is not good
[20:57:26] <acrichto> nrc: esp not good for beta at least
[20:57:40] <WindowsBunny> aturon: I'm against it for Ord and Eq, but I'm for it for Copy/Clone
[20:57:50] <acrichto> nrc: as in there are 41 allow(trivial) annotations in the source, and that seems like it's far too many for a lint
[20:58:02] <acrichto> nrc: at least my idea of a lint is that it has 0 false positives
[20:58:03] <aturon> WindowsBunny: ok, good to know (cc nmatsakis) -- this will go through an RFC
[20:58:20] <nmatsakis> yeah, that is (I think) acrichto's opinion as well
[20:58:38] <bstrie> nmatsakis: seems like people are talking about Copy: Clone, do you still need me to write up the deriving RFC?
[20:58:40] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[20:58:58] <nrc> acrichto: it shouldn't be needed that much - that is mostly because of history - we used to use `as` a lot for object casts and partly because of the future - many of those can be easily fixed, but I didn't because the fix would be easier/better with type ascription
[20:59:17] <nrc> (partly just laziness too)
[21:00:01] <nmatsakis> seems like we could leave the lint as allow and amp it up to warn when we get type ascription
[21:00:37] <nmatsakis> bstrie: yes, I think it'd be great to get that underway, I have a branch implementing the change that `trait Copy: Clone`
[21:00:59] <nrc> We could, I hope ascription lands soon and I don't mind the `allow`s all over the place - makes it easier to fix things once ascription lands
[21:02:00] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[21:02:00] *** ChanServ sets mode: +o pnkfelix
[21:02:56] <bstrie> nrc: what use cases would type ascription solve here?
[21:03:02] <acrichto> nrc: well specifically it's two pieces, one is where type ascription can be used, but for integer casts there's no recourse
[21:03:24] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:03:42] <acrichto> nrc: allows in the compiler are fine, but I'm way less comfortable to force everyone downstream to also decide whether the should use allow or not
[21:03:43] *** Joins: zmack (zmack@moz-4b0.o8l.26.188.IP)
[21:04:08] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:05:44] *** Joins: canhtak (canhtak@moz-ric.d2i.252.94.IP)
[21:07:16] <nrc> acrichto: type ascxription only helps the non-int case
[21:07:26] <nrc> I'm open to changing the int one to allow
[21:07:41] <nrc> I guess I'm more open to having allow in my code than others
[21:07:45] *** Quits: zmack (zmack@moz-4b0.o8l.26.188.IP) (Ping timeout: 121 seconds)
[21:08:26] <nrc> bstrie: there are edge cases (like the return value from a closure) where a cast is trivial, but removing it requires type asciption or a new variable (the latter is annoying)
[21:13:58] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[21:13:59] <blaenk> YESSS https://github.com/rust-lang/rfcs/pull/1011 good one acrichto. whole time I was using libc::exit and I was nervous/unsure about its use, just look at burntsushi's docopt.rs https://github.com/docopt/docopt.rs/blob/ef49af994b5824798e91a19de3ddf3685fb3f297/src/dopt.rs#L854
[21:14:51] <burntsushi> blaenk: oh happy day! ^_^ thanks acrichto!
[21:15:07] <blaenk> yuuppp
[21:15:34] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Ping timeout: 121 seconds)
[21:17:41] *** Joins: summerlight (summerlight@moz-99k.2mj.130.121.IP)
[21:18:43] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[21:20:26] <nrc> aturon: triage: I-needs-decision (1.0) won't work
[21:20:39] <nrc> aturon: triage bot only looks for P-* or I-nominated
[21:20:42] <aturon> nrc: ahha, what am i doing wrong?
[21:20:46] <aturon> i see
[21:20:52] <aturon> thanks!
[21:20:59] *** Joins: bdero (bran@moz-216hqv.oo5r.e4su.0006.2601.IP)
[21:21:09] <nrc> aturon: I did, I think, fix the bug you saw last week though - huon had it too, and I fixed a bug from the logging
[21:21:24] <nrc> so hopefully triage bot is more reliable now
[21:21:24] <aturon> nrc: ok cool, i will let you know if i notice any other problems
[21:21:28] <nrc> thanks
[21:21:45] <nmatsakis> aturon: ah, shoot, found a ... problem with Copy: Clone :)
[21:21:55] <aturon> nmatsakis: nothing is easy :)
[21:22:00] <nmatsakis> it's sort of solvable but
[21:22:10] <nmatsakis> the problem is that we don't have clone impls for some types that are copy, like fn(&int)
[21:22:29] <nmatsakis> I guess I can solve this
[21:22:32] <nmatsakis> by impl'ing Clone myself
[21:22:46] <nmatsakis> it's an interesting wrinkle -- derive(Copy) could generalize a smarter Clone impl as well
[21:23:10] <aturon> nmatsakis: ok, that doesn't sound so bad
[21:23:13] <nmatsakis> ok, just a wrinkle, no a blocker
[21:23:15] <nmatsakis> *not a blocker
[21:23:17] <aturon> nice to be finding these holes
[21:23:37] <nmatsakis> yeah, I knew about this, but didn't realize it would interact 
[21:26:23] *** Quits: apoelstra (username@moz-pvbasl.net) (Ping timeout: 121 seconds)
[21:27:50] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Ping timeout: 121 seconds)
[21:31:46] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Connection closed)
[21:37:29] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[21:41:58] *** Joins: gsingh93 (gulshan@moz-3fu4am.mi.comcast.net)
[21:42:19] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:44:17] *** Quits: geofft (geofft@moz-vfphq1.mit.edu) (Ping timeout: 121 seconds)
[21:44:53] *** Quits: achernya (quassel@moz-i01917.mit.edu) (Connection closed)
[21:44:54] *** Joins: achernya (quassel@moz-8tbl8i.6686.inna.4830.2001.IP)
[21:45:27] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[21:47:02] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:53:30] *** Joins: LinuxBunny (Retep998@moz-7f2st1.east.verizon.net)
[21:55:58] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[21:56:50] *** Quits: WindowsBunny (Peter@moz-7f2st1.east.verizon.net) (Ping timeout: 121 seconds)
[21:57:03] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[21:59:01] *** Joins: blaenk_ (blaenkdenum@moz-em283u.res.rr.com)
[22:01:58] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[22:02:40] *** Quits: larhat (Adium@moz-fmfrc4.mfe0.h1q1.2168.2a02.IP) (Quit: Leaving.)
[22:02:41] *** Joins: njn (chatzilla@moz-g8u.hke.217.203.IP)
[22:03:42] *** Joins: dinfuehr (dinfuehr@moz-j3o226.highway.telekom.at)
[22:06:01] *** Quits: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com) (Client exited)
[22:06:08] <huon> aturon: (reminder about #[derive(From)], although I'll be out all day today)
[22:07:32] *** Joins: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com)
[22:07:32] *** ChanServ sets mode: +o pcwalton
[22:11:40] *** Quits: killercu_ (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:15:38] <nmatsakis> aturon: https://github.com/nikomatsakis/rust/commit/c7916fa15a79fa2d1ee8c10c28688d965576976b <-- changes that wound up being needed for the #23086 fix
[22:17:23] <huseby> so I'm trying to get all of the tests in "make check" to pass on the bitrig build bot
[22:17:35] <huseby> it keeps hanging at this point:
[22:17:36] <huseby> test usize::tests::test_parse_bytes ... ok
[22:17:45] <huseby> I guess it's doing std tests?
[22:17:55] <huseby> does anybody know where the source is for these tests?
[22:18:04] <huseby> I've been grep'ing and can't find the exact test
[22:18:15] *** Quits: nawns (nawns@moz-0l6.cn2.211.128.IP) (Client exited)
[22:18:50] <brson> huseby: the tests for stdtest are in src/libstd
[22:19:13] <brson> huseby: you might set RUST_TEST_THREADS=1 to eliminate parallelism
[22:19:31] <brson> huseby: when there is only 1 test thread the test runner will print the name of the current test *before* running it
[22:19:51] <brson> that way you can see which one is dling
[22:20:55] *** Joins: reem (reem@moz-mvnlbo.coob.q2h1.0009.2601.IP)
[22:21:55] <simukis> (the stdout is line-buffered, though)
[22:23:00] *** Joins: Savago (Savago@moz-8hd.3b6.246.162.IP)
[22:23:39] *** Quits: bpayton (bpayton@moz-ifileu.ph.cox.net) (Quit: Leaving)
[22:24:50] *** Quits: canhtak (canhtak@moz-ric.d2i.252.94.IP) (Client exited)
[22:26:17] *** Joins: bugweiser (Mibbit@moz-juv.9o3.252.72.IP)
[22:27:50] <huseby> brson: is that an env var?
[22:27:59] <huseby> RUST_TEST_THREADS=1 gmake check
[22:28:01] <huseby> ?
[22:29:22] *** Quits: bugweiser (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:31:13] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[22:32:11] *** Quits: summerlight (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[22:32:33] <bluss> huseby: that should be it
[22:32:46] <huseby> bluss: thanks
[22:33:27] <bluss> huseby: to check, the `ok` should turn green in the terminal in single threaded mode :)
[22:34:05] <huseby> I'm on Bitrig
[22:34:16] <huseby> I don't think it knows what color is ;)
[22:34:40] <burntsushi> does anyone know if `NumCast` is going to be stabilized? (just want to know if i should work around it)
[22:36:51] *** Quits: blaenk_ (blaenkdenum@moz-em283u.res.rr.com) (Ping timeout: 121 seconds)
[22:36:52] <SimonSapin> Is this trivial cast really trivial? https://github.com/servo/string-cache/issues/76
[22:37:40] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:38:29] <cmr> SimonSapin: Well, &u64 coerces to *const u64 at the very least.
[22:38:36] <brson> here's a beta build http://static-rust-lang-org.s3-website-us-west-1.amazonaws.com/dist/rust-1.0.0-beta-x86_64-unknown-linux-gnu.tar.gz
[22:38:39] <cmr> I think that's the rule, coercions mean a cast is trivial.
[22:38:53] <cmr> brson: sweet, testing.
[22:38:55] <bluss> it was discussed before and it seems that the lint wants you to switch to type ascription
[22:39:28] <brson> on cursory review, the beta seems to feature gate correctly
[22:39:44] <brson> so any code that builds against it is 'stable'
[22:40:11] <brson> i'm going to run a test of all crates.io against it righ tnow
[22:43:03] *** Quits: reem (reem@moz-mvnlbo.coob.q2h1.0009.2601.IP) (Connection closed)
[22:43:23] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[22:44:33] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:44:34] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[22:46:26] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Client exited)
[22:47:43] *** Quits: tcurdt (tcurdt@moz-6rer5f.cust.swisscom.ch) (Quit: Textual IRC Client: www.textualapp.com)
[22:48:29] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[22:48:58] <aturon> huon: yep, talked to acrichto a bit about it, trying to figure out a backup plan
[22:49:26] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:50:02] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[22:50:05] <acrichto> nrc: ping
[22:50:30] <nrc> acrichto: pong
[22:50:48] <acrichto> nrc: what would you think about making both of the trivial cast lints to allow-by-defualt for now?
[22:50:54] <acrichto> once type ascription lands we can make trivial_casts warn-by-default
[22:51:00] <acrichto> after altering the message to recommend ascription instead
[22:51:45] <nrc> I wouldn't object to allow for now, as long as we switch back to warn before beta
[22:51:51] <nrc> (for non-numeric)
[22:52:03] <nrc> and given that is so few days, I wonder if it is worth it
[22:52:13] <nrc> (this assumes ascription lands soon)
[22:52:37] * frewsxcv did not have a good experience with 'trivial cast lint' https://github.com/servo/string-cache/pull/77/files#diff-b2f19aae263ed4855f61b15981d81b1bR49
[22:52:39] <nrc> the message should not recommend ascription though, since in most cases it is not requireed, but that is kind of bike-shedding
[22:52:46] <acrichto> nrc: I'd feel better if we switched the level to warn in the type ascription PR
[22:53:02] <acrichto> nrc: sure, but it should say something along the lines of "remove this or use type ascription instead"
[22:53:09] <nrc> yeah
[22:53:16] <acrichto> e.g. it should not mislead into thinking that it should always be able to be removed
[22:53:23] <nrc> right
[22:53:33] <acrichto> basically in mind mind whenever a lint fires it should have a clear and actionable thing to do
[22:53:42] <acrichto> in this case it would be (A) try removing, (B) use ascription
[22:54:13] <cmr> brson: https://gist.github.com/cmr/4eaa8f04599a60709ef1
[22:54:41] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:54:42] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:54:43] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:54:50] <nrc> so, I'm Ok with this. Depending on exactly how we feel about warnings and backwards compatability, it does mean we have some pressure to land type ascription for beta
[22:54:54] <cmr> does set u actually work with -z "$FOO"?
[22:54:55] <nrc> acrichto: ^
[22:55:11] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Ping timeout: 121 seconds)
[22:55:25] <cmr> brson: yeah, you can't check if something is unset with -u it seems?
[22:56:09] <acrichto> nrc: I feel either way we should switch to allow for both right now
[22:56:13] <acrichto> until type ascription lands
[22:56:20] <cmr> brson: http://stackoverflow.com/a/13864829 says use -z ${META+x}
[22:56:48] <brson> cmr: with -u i usually do [ -z "${FOO-}" ]
[22:56:54] <brson> that will check for unset-or-empty
[22:56:58] <cmr> ok
[22:57:07] <brson> cmr: what is the context? is something broke?
[22:57:20] <brson> oh i see
[22:57:25] <cmr> brson: not sure if it broke, but I'm testing your beta build.
[22:57:37] <nrc> acrichto: my only worry is I don't want people to get a bunch of these warnings *after* beta - people have tended to use a lot of trivial casts for creating trait objects
[22:57:38] <cmr> oh, it's even https://github.com/rust-lang/rust-installer/issues/22
[22:58:00] <brson> ok, I'll fix that
[22:58:28] <acrichto> nrc: how likely do you think it is that type ascription will land for beta?
[22:58:43] <cmr> brson: fyi https://github.com/rust-lang/rust-installer/pull/20 only closed #15
[22:58:48] <nrc> eddyb: ^^ ?
[22:59:00] <huseby> brson: RUST_TEST_THREADS=1 gmake check doesn't seem to be working
[22:59:01] <aturon> acrichto: even if it landed, i thought it was going to be unstable for a while?
[22:59:06] <huseby> it's not giving me green "ok"'s
[22:59:12] <huseby> and it's not printing out the test first
[22:59:16] <huseby> hrm :-/
[22:59:17] <acrichto> aturon: hm good point
[22:59:35] <huseby> oh wait
[22:59:40] <acrichto> nrc: I'm pretty uncomfortable with this situation of "oh if you can't remove the warning add #[allow]"
[22:59:41] <huseby> it probably is printing the name of the test first
[22:59:42] <nrc> acrichto: theoretically it just needs a rebase and a few small changes to disallow coercion in some places. but it's eddyb's patch, I'm not sure if he intends to try to land it
[22:59:54] <acrichto> nrc: I feel like that's not the culture we want to encourage
[23:00:14] <nrc> true
[23:00:57] <nrc> acrichto: well, lets change to allow for now, and if eddyb is too busy to rebase the ascription patch I'll try and do it next week
[23:01:02] <acrichto> nrc: well I think regardless we may want the numerics to go to allow-by-default
[23:01:06] <aturon> nmatsakis: so, the WIP looks pretty good -- it seems we managed to find a good middle path! that said, i definitely agree that the ability to specify (ref) or some other finer-grained control would be helpful
[23:01:12] <nrc> acrichto: yes, I agree with that
[23:01:12] <acrichto> nrc: I would be happier I think with a different message for trivial_casts
[23:01:16] <acrichto> nrc: but still at warn-by-default
[23:01:24] <cmr> brson: there also seems to be rpath issues with it? when I ./install.sh (putting it in /usr/local) and run "rustc" it can't find shared libraries.
[23:01:40] <acrichto> nrc: hm ok, do you want to do a patch for that or shall i?
[23:01:46] <nrc> acrichto: yeah, it would definitely benefit frm a better message
[23:01:58] <nrc> acrichto: I can do it
[23:02:03] <acrichto> nrc: ok, thanks!
[23:02:31] <aturon> huon: you around?
[23:04:35] <brson> cmr: uhuh
[23:05:12] *** Joins: WindowsBunny (Peter@moz-7f2st1.east.verizon.net)
[23:05:22] <brson> huseby: the name of that env var recently changed. it may still be RUST_TEST_TASKS on your rev
[23:05:35] <brson> cmr: i mean 'uh oh'
[23:06:49] <brson> cmr: r? https://github.com/rust-lang/rust-installer/pull/27
[23:07:05] *** Quits: kmcguire (kmcguire@moz-pg1gb9.biz.rr.com) (Ping timeout: 121 seconds)
[23:07:08] <cmr> brson: r+
[23:07:13] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[23:07:14] *** Joins: srh (User@moz-buk9lp.ph.cox.net)
[23:07:38] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[23:07:54] <brson> now to upgrade everything that uses rust-installer...
[23:07:59] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: Lost terminal)
[23:08:47] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[23:08:48] *** ChanServ sets mode: +o brson
[23:08:53] *** Quits: haxe (haxelion@moz-ap7alo.eu) (Ping timeout: 121 seconds)
[23:09:42] *** Quits: cdidd (cdidd@moz-671va2.broadband.corbina.ru) (Ping timeout: 121 seconds)
[23:10:25] <cmr> aturon: hah, nice pre-emption on https://github.com/rust-lang/rust/pull/23549#issuecomment-86749391, I was just about to ping you :)
[23:10:28] <aturon> acrichto: raw::TraitObject is coming up here and there
[23:10:34] <cmr> (this is preventing xml-rs from being stable)
[23:10:58] <aturon> cmr: thanks for the heads-up :) this is definitely one of the bigger stabilization bits that still needs to land
[23:11:48] <brson> acrichto: r? https://github.com/rust-lang/cargo/pull/1461
[23:12:12] <cmr> brson: do you have a recent dependency graph for crates.io? would be interesting to have such a graph, with annotations for the features each uses...
[23:12:26] *** Quits: dinfuehr (dinfuehr@moz-j3o226.highway.telekom.at) (Connection closed)
[23:12:47] <brson> acrichto: r? https://github.com/rust-lang/rust-packaging/pull/24
[23:13:56] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[23:14:12] <brson> cmr: not currently. my old tool for that is slightly bitrotted and the tool i'm working on right now doesn't do that yet
[23:14:31] <cmr> brson: would that be a valuable thing I could do for you?
[23:14:35] <acrichto> aturon: hm we don't have a great story for that
[23:14:47] <cmr> (I mean, I want it for myself too...)
[23:14:50] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[23:15:28] <aturon> acrichto: ok, let's add it to the queue; reem is using it in a few packages mentioned in his metabug, and i think carllerche is as well
[23:15:39] <acrichto> aturon: ok
[23:15:53] <brson> cmr: yes. you might look at https://github.com/brson/stabworld to get started. the dl-carge-packages.py script *does* work afair
[23:16:07] <cmr> brson: ok, I'll take a whack at it.
[23:16:09] <reem> you need it to emulate Any, which comes up a lot
[23:16:17] <reem> since Any + OtherTrait doesn't work
[23:17:02] <cmr> brson: aturon: are there any other high-value tasks I could help with, beyond stabilizing third-party crates?
[23:17:10] <blaenk> hey aturon should .as_ref() be preferred over &x[..] for String -> &str now?
[23:17:21] <blaenk> checked the conversion traits rfc but doesn't mention this AsRef stuff
[23:17:25] <aturon> reem: oh hm, i wonder if the work nmatsakis is doing will help
[23:17:28] <cmr> blaenk: you should just need to do &x in most cases.
[23:17:39] <blaenk> yeah I can't here cause it'll try to use &String
[23:17:56] <aturon> blaenk: ah, As from the RFC is AsRef, and &x[..] is preferable if & alone won't work
[23:18:02] <blaenk> sweet thanks
[23:18:03] <reem> aturon: I don't think so
[23:18:08] <aturon> blaenk: basically, as_ref should only be used in a context where you have some T: AsRef
[23:18:14] <blaenk> ohhh okay, awesome :D
[23:18:27] <aturon> (OTOH, SomeType::from(blah) is now a universal way to do conversion construction)
[23:18:30] <reem> The Reflect thing is different and the upcasting thing only doesn't make the situation with double trait objects worse
[23:18:35] <blaenk> yeah noticed that PathBuf::from
[23:18:40] <blaenk> that's pretty awesome imo
[23:18:53] <blaenk> waaay nicer than from_aturon(x) from_u8(x) etc
[23:19:03] <aturon> blaenk: lol
[23:19:24] <aturon> reem: right, ok. i'll see what we can do for raw
[23:19:34] <aturon> cmr: thanks for asking! let me dig around, i'll get back to you in a sec
[23:19:54] <cmr> aturon: np. I got some extra time in the next few days since I'm ahead on some schoolwork :)
[23:20:37] <brson> cmr: this one came up as worrisome today https://github.com/rust-lang/rust/issues/19051
[23:20:45] <reem> aturon: I discussed with nmatsakis a while ago and we agreed that you only need the data field, so it's possible to stabilize only that field.
[23:20:46] <brson> but it's not clear what to do
[23:21:07] <reem> aturon: Since we still want to modify the vtable representation, but the data is likely to not change.
[23:21:17] <aturon> cmr: there are some *extremely* high value rustdoc bugs...
[23:21:21] <aturon> cmr: https://github.com/rust-lang/rust/issues/21801
[23:21:35] <aturon> cmr: https://github.com/rust-lang/rust/issues/21310
[23:21:49] <aturon> cmr: https://github.com/rust-lang/rust/issues/20646
[23:21:49] <brson> yeah, rustdoc bugs are important
[23:22:07] <aturon> the first one in particular is causing the output to look pretty bad these days
[23:22:09] <cmr> alright, I can start on those.
[23:22:15] <aturon> and the others involve information just being dropped on the floor :-/
[23:22:26] <aturon> no one has had time to focus on these, and i think they may be pretty tricky...
[23:23:05] <cmr> hm, xcrate, that might be icky...
[23:23:09] <aturon> reem: ok, thanks! i'll chat with nmatsakis and acrichto, likely tomorrow
[23:23:13] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[23:23:16] *** Joins: Rym (y@moz-vsu.f6d.55.31.IP)
[23:23:56] <reem> A "deref methods" section for all methods from the target type would be amazing
[23:23:59] *** Quits: Rym_ (y@moz-vsu.f6d.55.31.IP) (Ping timeout: 121 seconds)
[23:24:02] <aturon> reem: actually, while i've got you here -- i wanted to look more into how you were using FromPrimitive/ToPrimitive
[23:24:06] <reem> sure
[23:24:14] <cmr> reem: that's a great idea, seeing Deref impls a lot is really nasty.
[23:24:15] <aturon> reem: but maybe you can quickly summarize, at a high level, why those traits make sense for you?
[23:24:17] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[23:24:18] <reem> For HTTP status codes
[23:24:27] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[23:24:34] <cmr> reem: could probably do some nice rendering for a lot of the std traits, actually.
[23:24:40] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Connection closed)
[23:25:02] *** Joins: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca)
[23:25:23] <reem> cmr: Ya. Deref comes up *a lot* because it adds a bunch of apparently undocumented methods.
[23:25:37] *** Quits: swgillespie (swgillespie@moz-upj.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:25:55] <cmr> Method availability in the presence of Deref is just a transitive closure, right?
[23:26:36] <aturon> cmr: basically, though we also auto-ref at each level
[23:27:02] <aturon> (and e.g. a trait impl on &YourType will be dispatched to)
[23:27:11] <cmr> ok
[23:27:19] <reem> those probably also don't show up on rustdoc
[23:27:32] *** Joins: swgillespie (swgillespie@moz-upj.3un.220.167.IP)
[23:27:46] <aturon> reem: can you elaborate a bit? one odd thing about the traits is that they couple *all* of the primitive types together. is that specifically desirable in this context, and why?
[23:27:59] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[23:28:14] *** Joins: nawns (nawns@moz-0l6.cn2.211.128.IP)
[23:28:36] <reem> aturon: FromPrimitive and ToPrimitive are the generic way to convert to "some numbers"
[23:28:39] <reem> right now
[23:29:07] <cmr> brson: another 1.0-possible-issue is that the std docs get generated with the rustc docs, so there are a *ton* of impls for internal types all over the place.
[23:29:10] <reem> it's not crucial but we'd have to provide a different set of methods to convert to primitives
[23:29:12] <cmr> brson: eg, consider http://static.rust-lang.org/doc/master/std/marker/trait.Copy.html ...
[23:29:21] <aturon> reem: hm, let me ask a different way: now we have generic From<T> and Into<T>, could you use From<u32>/Into<u32> etc?
[23:29:28] *** Quits: sigma (sigma@moz-ohog4c.range86-135.btcentralplus.com) (Ping timeout: 121 seconds)
[23:29:37] <reem> Ya, I think so
[23:29:41] <aturon> ah ok, great
[23:29:52] <aturon> (granted those aren't stable yet :)
[23:29:57] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:30:05] <reem> I'm not deadset on getting all these things stabilized, I'm happy to change code too
[23:30:08] <aturon> (but they will be soon, assuming no further problems show up; i have a PR to make a few minor improvements in queue already)
[23:30:26] <aturon> reem: yep, understood; and on my end, just trying to understand how various things are getting used
[23:30:44] <reem> So one thing I actually dislike about the conversion traits
[23:31:00] <reem> to me the ideal interface is type.into::<Other>()
[23:31:01] <blaenk> hey aturon I was wondering the other day, and now I wonder if it's changed since the conversion traits were added. is there a way I can generically accept &str and String and anything else knowing I'll convert it to a String, preferably with the implication that if I passed a String, nothing will be done, since I already have it?
[23:31:19] *** Joins: haxe (haxelion@moz-ap7alo.eu)
[23:31:25] <aturon> reem: right, so that was one design alternative if you wanted to try to replace *all* ad hoc conversion methods
[23:31:26] <blaenk> func("blah") and func("blah".to_string()) would work, internally "blah" would be .to_string()'ed, and the second one wouldn't do anything cause it's already a String
[23:31:31] <reem> but now we have to do let x: Other = type.into(); which reads strangely, *especially* when combined with method chaining
[23:31:35] <blaenk> right now I'm doing some Cow maneuvers
[23:31:39] <blaenk> actually that doesn't sound very good
[23:31:44] <aturon> blaenk: like, you want an owned string in the end?
[23:31:45] <blaenk> #outofcontext
[23:31:47] <blaenk> yes
[23:31:53] <aturon> Into<String> should do the trick
[23:31:56] <blaenk> :DD
[23:31:59] <aturon> in particular, there's an impl of that for &str
[23:32:14] <blaenk> I was doing something like
[23:32:15] <blaenk> pub fn creating<'a, P: ?Sized, S: IntoCow<'a, str>>(name: S, path: &P) -> Rule
[23:32:16] <reem> I just want to rejigger the API so that I put the type hint in ::<> instead of as a hint to the result
[23:32:22] <blaenk> and then name.into_cow().into_owned() lol
[23:32:32] <aturon> reem: yeah, unfortunately that requires doubling the number of traits
[23:32:38] <reem> the actual traits don't have to change, maybe you just add a trait the prelude that provides this convenience method
[23:32:40] <aturon> blaenk: haha :)
[23:33:00] <reem> aturon: Ya, but they're mostly invisible.
[23:33:21] <reem> aturon: And I think you might be able to use method-level where clauses to add only one trait to the prelude
[23:33:40] <aturon> reem: hm, you may be right
[23:33:52] <reem> that would be much better imo
[23:34:01] <aturon> well, i mean, it's a different design
[23:34:05] <reem> right now it's very hard to read vs. AsPath and as_path
[23:34:21] <aturon> reem: can you link me an example or two?
[23:34:21] <reem> because the type hint is very far from the invocation
[23:34:32] <aturon> i'm curious what's being converted into a path
[23:34:35] <reem> ya gimme a sec
[23:34:38] <aturon> in general, we provide specific named methods for this
[23:34:57] <aturon> like, we still have to_string, to_vec, etc
[23:35:15] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[23:35:19] <aturon> (and the RFC made a specific decision not to replace all of these with the generic forms, partly because of ::, partly because of the extra traits involved)
[23:35:23] <reem> aturon: https://github.com/sfackler/rust-postgres/commit/f680c44d8f57c64c36b1c41a54f12d9df5225d24
[23:35:51] <aturon> ok, that was os string
[23:36:03] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[23:36:10] <brson> cmr: yes, i would be fine just turning off docs for everything not under std
[23:36:12] <aturon> it was kind of random that as_path was callable from it in the first place, tbh :)
[23:36:26] <brson> cmr: that will help our dl sizes too
[23:36:41] <cmr> brson: a ton, I'm sure. the html source is not small.
[23:36:56] <reem> aturon: My complaint is less about this specific example and more about the location of the type hint and overall code readability
[23:37:04] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[23:37:05] <aturon> reem: the more idiomatic approach would be something like `Path::new(env::var_os("OUT_DIR").unwrap()).join("sqlstate.rs")`
[23:37:09] <reem> the current use of these traits encourages the hint to be far from the call to as_ref()
[23:37:23] <aturon> reem: so, the thing is, the intention is that as_ref would never be used in a context that needed hints
[23:37:46] <aturon> reem: IOW, if you're using it for *generics* only, you'll have T: AsRef<U>, and the target type is already known
[23:38:10] <aturon> reem: cases where you're calling it from a concrete type are indications that you should either be calling a constructor (like my suggestion above) or that we should offer a direct method, imo
[23:38:21] <reem> ime you still need to specify
[23:38:30] <aturon> reem: i'd love to see examples
[23:38:33] <reem> I think method dispatch does something strange there
[23:38:43] <aturon> reem: if that's the case, i'd be worried indeed
[23:39:24] <blaenk> hey aturon just to be sure, you mentioned Into<String>, but that doesn't currently exist right? http://doc.rust-lang.org/std/convert/trait.Into.html
[23:39:27] <blaenk> or is it a consequence of: impl<T, U> Into<U> for T where U: From<T>
[23:39:34] <blaenk> btw that's a pretty awesome blanket impl I think
[23:39:36] <blaenk> makes me proud
[23:39:45] <reem> Honestly I'd rather the type be explicit - you do T: Into<U> but Into doesn't provide the into method, it's provided by another trait, so you have to specify t_val.into::<U>().
[23:40:08] <blaenk> I'll try it np
[23:40:09] <reem> (and that method has a method-level where clause that Self: Into<U>)
[23:40:33] <reem> it makes the code much more readable for the type conversions to be explicit rather than inferred
[23:40:46] <aturon> reem: you want https://github.com/aturon/rfcs/blob/conversion-traits/text/0000-conversion-traits.md#alternatives basically
[23:41:03] <aturon> acrichto: dunno if you're following ^ at all...
[23:41:13] <blaenk> yesss I think that's the impl that enables it
[23:41:31] <acrichto> aturon: not currenly, not
[23:41:32] <reem> shift_view...?
[23:41:36] <reem> :P
[23:41:43] <aturon> reem: lol
[23:41:50] <aturon> reem: not the exact names of course, just the general setup
[23:41:57] <reem> bad PR for this alternative :P
[23:41:59] <aturon> blaenk: it looks like we may not have String: Into<String> right now
[23:42:08] <blaenk> yeah I was about to say
[23:42:14] <blaenk> http://is.gd/6umAsk
[23:42:30] <aturon> blaenk: sadly we can't have a blanket impl for that, it would conflict with some other impls
[23:42:32] <blaenk> would we benefit/woudl it be possible to have some sort of identity Into blanket impl
[23:42:36] <aturon> blaenk: however, i will add it to my revision
[23:42:37] <blaenk> ohhh
[23:42:43] <blaenk> what a shame ;_;
[23:42:44] <aturon> (add the concrete one, i mean)
[23:42:56] <reem> aturon: No joke, the names make it *much* harder to understand what this alternative actually is.
[23:42:56] <bstrie> ...are negative trait bounds implemented?
[23:42:59] <aturon> blaenk: my hope is that with specialization we'll be able to add it in the future
[23:43:02] <blaenk> yeah
[23:43:02] <cmr> bstrie: yes.
[23:43:09] <aturon> reem: ok, i will sketch out something better
[23:43:13] <reem> ShiftView/Transform are not terms I'm familiar with in rust, I have no intuition for what's going on
[23:43:15] <bstrie> wow, that one completely slipped past me
[23:43:16] <cmr> bstrie: or, no, probably not, sorry.
[23:43:21] <cmr> bstrie: negative impls are, not bounds.
[23:43:25] <reem> aturon: I would just do Into and IntoExt
[23:43:26] <blaenk> so we can't do impl Into<String> for String { } for every T cause of conflicts right
[23:43:35] <blaenk> impl<T> Into<T> for T {}
[23:43:43] <aturon> right
[23:43:44] <reem> AsRef AsRefExt also
[23:43:48] <blaenk> alright!
[23:43:54] <blaenk> guess I'll stick to my cow maneuvers
[23:43:59] <aturon> blaenk: but i'll add the one for String,
[23:44:06] <aturon> blaenk: so you should be able to move your code over soon
[23:44:20] *** Quits: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP) (Ping timeout: 121 seconds)
[23:45:24] <cmr> aturon: that lack of blanket impl is coming up a lot, and very soon that sort of issue will have a 6-week turnaround with no recourse.
[23:45:45] <aturon> cmr: :-/
[23:46:07] *** Quits: blaenk (blaenkdenum@moz-em283u.res.rr.com) (Connection closed)
[23:46:12] <cmr> It may be wise to do a pass over every public std type and implement it with a macro.
[23:46:19] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[23:46:38] * aturon cries a little, inside
[23:46:43] <cmr> I know right :(
[23:47:02] *** Joins: blaenk (blaenkdenum@moz-em283u.res.rr.com)
[23:47:10] <reem> why can't we add the blanket impl?
[23:47:16] <cmr> coherence
[23:47:20] <blaenk> im back
[23:47:29] <reem> why not add it in core?
[23:47:38] <aturon> reem: conflicts with https://github.com/rust-lang/rust/blob/master/src/libcore/convert.rs#L51-L63
[23:48:02] <reem> wow that really sucks
[23:48:05] <aturon> yep!
[23:48:07] <reem> I see no way around this at all
[23:48:19] <aturon> specialization is the long term way to deal with it
[23:48:26] <reem> ya but that's not gonna happen in six weeks
[23:48:30] <aturon> indeed
[23:48:32] <blaenk> dude I was just realizing while my net was down that this idiom is pretty common I think. you want to be able to accept say for example &Path (ref/borrowed) or PathBuf (owned). you ultimately want a PathBuf (owned), so you want to be able to pass both, but if you got the owned one, don't do anything
[23:48:42] <blaenk> compared to only accepting the ref/borrowed, and unconditionally re-creating an owned
[23:48:55] <blaenk> or maybe I've been doing it wrong all along
[23:49:21] <blaenk> cause for example normally you'd make a parameter &str, but in this case you definitely want a String in the end, so if the user already had a String, needless allocation
[23:49:25] <aturon> blaenk: yes, indeed! if you want the owned thing, using Into<T> should work great. and if you want borrowed, you can use AsRef<T> (but not take it as a reference), and people can still pass in owned data if they like, without having to take a ref
[23:49:37] <blaenk> but the reason you want &str is because it's much more universal and ergonomic, e.g. being able to pass str lits
[23:49:53] <brson> out of the first 39 crates I've tested on beta .... 2 passed!
[23:49:53] <cmr> blaenk: bingo.
[23:49:59] *** Joins: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP)
[23:49:59] <blaenk> yeah but the shame is the lack of the blanket impl on Into ;_;
[23:50:03] <brson> testing the top 200 crates
[23:50:07] <blaenk> we are this close to being able to do that sort of thing
[23:50:20] <cmr> brson: I suspect many of them might be needless #![feature]'s now.
[23:50:22] <blaenk> fn func<P: Into<PathBuf>(p: P) being able to take &Path and PathBuf
[23:50:32] <reem> blaenk: Cow is also basically the representation of that pattern on the value rather than type level
[23:50:38] <cmr> brson: I know a lot of crates try to build warning-free, which, for the past forever, has meant a bunch of feature gates.
[23:50:43] <blaenk> yeah, which is why I'm using Cow at the moment
[23:50:50] <blaenk> but it's some level of hoops lol
[23:50:57] <reem> I want a Cow at the type level, as a trait
[23:51:45] *** Joins: James_ (quassel@moz-d43h0f.range86-163.btcentralplus.com)
[23:52:24] <aturon> hm, so Cow is more useful when you're *not sure* if you need ownership
[23:52:36] *** Quits: hoverbear (hoverbear@moz-82h62u.wireless.uvic.ca) (Quit: This hovering bear zooms away!)
[23:52:41] <brson> cmr: I couldn't reproduce the dynamic linker error you reported after installing beta
[23:52:41] <aturon> (like, when that depends on dynamic info)
[23:52:45] <reem> alternatively you don't care about ownership
[23:52:47] <blaenk> I'm definitely sure I want ownership, but I have to (AFAIK) use cow to express this idiom. typing up a playpen
[23:53:01] <cmr> brson: do you have LD_LIBRARY_PATH set/did you install to /usr/local?
[23:53:04] <cmr> b 12
[23:53:08] <aturon> blaenk: once String: Into<String>, you should be able to just do Into<String>
[23:53:20] <brson> cmr: I did the default install to /usr/local, yeah. I don't have anything special configured for LD_LIBRARY_PATH
[23:53:35] <cmr> brson: ok, weird, I'm willing to chalk it up to my system being weird.
[23:53:40] <cmr> my dev vm can get pretty gnarly.
[23:53:48] <blaenk> yep that's the good thing, but what I was realizing is that this idiom is useful for many other types, like PathBuf, i.e. being able to take &Path and PathBuf
[23:53:49] <cmr> brson: thanks for looking into it
[23:53:54] <blaenk> which is why I lament the blanket impl :(
[23:53:58] <aturon> blaenk: yep, think we're on the same page
[23:54:06] *** Quits: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP) (Ping timeout: 121 seconds)
[23:55:24] *** Joins: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP)
[23:55:40] *** Quits: pcwalton (pcwalton@moz-qjbkeh.mtv2.mozilla.com) (Client exited)
[23:55:44] *** Joins: apoelstra (username@moz-pvbasl.net)
[23:58:07] <blaenk> aturon: I know you get what I mean but just to illustrate it further http://is.gd/RFIH88
[23:58:18] *** Quits: srh (User@moz-buk9lp.ph.cox.net) (Ping timeout: 121 seconds)
[23:58:35] <blaenk> that's how I'm currently using Cow to enable that. I think that it's doing what I want it to
[23:58:43] *** Quits: Kroisse (Kroisse@moz-t75tk5.krois.se) (Quit: Good bye :))
[23:59:26] *** Quits: bgamari (bgamari@moz-uvr07v.q402.fm1a.0470.2001.IP) (Ping timeout: 121 seconds)
