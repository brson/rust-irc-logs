[00:19:42] *** Quits: arielb1 (Ariel@moz-8gbedh.red.bezeqint.net) (Connection closed)
[00:20:15] *** Joins: aatch (james@moz-c6etfk.fosn.r6an.e000.2406.IP)
[01:00:20] *** Quits: brson (brson@moz-n5b.14a.129.78.IP) (Connection closed)
[01:00:37] *** kimundi is now known as zz_kimundi
[01:01:06] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[01:27:06] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[01:39:36] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[01:52:22] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:57:59] *** Joins: WindowsBunny1 (Peter@moz-vlal7g.east.verizon.net)
[02:00:47] *** WindowsBunny is now known as Guest26621
[02:00:47] *** WindowsBunny1 is now known as WindowsBunny
[02:01:25] *** Quits: Guest26621 (Peter@moz-vlal7g.east.verizon.net) (Ping timeout: 121 seconds)
[02:01:30] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Quit: Leaving)
[02:01:32] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[02:01:41] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[02:01:41] *** Quits: Tuba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[02:21:51] <eddyb> error: aborting due to 2 previous errors
[02:21:57] <eddyb> that used to be 3
[02:22:09] <eddyb> nmatsakis: so at the typeck/regionck level, TLS tcx checks out :D
[02:22:20] <eddyb> (with the right lifting helpers)
[02:26:48] *** Joins: hyperassociative_ (Mibbit@moz-gn0vp5.ca.comcast.net)
[02:26:55] *** Quits: hyperassociative_ (Mibbit@moz-gn0vp5.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:49:36] *** Quits: aatch (james@moz-c6etfk.fosn.r6an.e000.2406.IP) (Quit: Leaving)
[02:49:46] *** Joins: aatch (james@moz-c6etfk.fosn.r6an.e000.2406.IP)
[02:50:01] *** Quits: zz_kimundi (kimundi@moz-6qind6.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:51:41] *** Joins: zz_kimundi (kimundi@moz-0a7524.dip0.t-ipconnect.de)
[02:51:42] *** zz_kimundi is now known as kimundi
[02:59:42] *** Joins: frewsxcv (sid86219@moz-dneii9.brockwell.irccloud.com)
[03:37:54] *** Joins: theme (theme@moz-i3mhhb.asianet.co.th)
[04:28:21] *** Quits: theme (theme@moz-i3mhhb.asianet.co.th) (Quit: Leaving)
[04:53:22] *** Quits: aatch (james@moz-c6etfk.fosn.r6an.e000.2406.IP) (Connection closed)
[04:53:55] *** Joins: Rusticorn (Rusticorn@moz-ton.ucv.66.182.IP)
[05:03:48] *** Quits: Rusticorn (Rusticorn@moz-ton.ucv.66.182.IP) (Connection closed)
[05:03:56] *** Joins: Rusticorn (Rusticorn@moz-ton.ucv.66.182.IP)
[05:10:47] *** Quits: Rusticorn (Rusticorn@moz-ton.ucv.66.182.IP) (Quit: AndroIRC - Android IRC Client ( http://www.androirc.com ))
[05:32:28] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[05:47:00] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[06:42:39] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[06:51:22] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[07:07:52] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[07:09:34] *** kimundi is now known as zz_kimundi
[07:36:07] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[07:40:57] <doener> eddyb: not a regression. But coercion is a bit too eager to emit adjustments I'd say...
[07:43:58] <doener> eddyb: hrm, no, actually it's weird... "let x = &5 as *const i32" => no adjustment, "let x = &mut 5 as *const i32" => no adjustment, "let x: *const i32 = &mut 5 as *const i32" => adjustment
[07:48:19] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[07:57:39] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[08:19:50] <nrc> doener: you get an adjustment for coercions only, that includes trivial casts, but not for non-trivial casts. All the casts there are non-trivial, but there is also a coercion in the last one
[08:21:09] <doener> nrc: but it's a coercion from *const i32 to *const i32, I'd expect that to no-op
[08:22:12] <nrc> doener: oh right, yeah, there should not be no-op adjustments
[09:27:08] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[09:30:30] <madmalik> hi there! i would like to dip my toe into rustc... i thought that the lint part could be a good starting point. would you recommend trying to solve some easier issues in that areas to get started?
[09:32:53] <Manishearth> madmalik: I'm willing to mentor lints on https://github.com/Manishearth/rust-clippy/
[09:33:12] <Manishearth> which deals with rustc internals but you don't have to actualyl compile rustc
[09:33:21] <Manishearth> https://llogiq.github.io/2015/06/04/workflows.html might help
[09:34:18] <madmalik> thanks
[09:34:50] <madmalik> not having to compile rustc would be a win ^^
[09:35:26] <Manishearth> I found that writing lints in Servo was a great way to get acquainted with some of the internals
[09:38:38] <madmalik> i learned a little bit about the ast while working on rust-style
[09:41:50] <Manishearth> cool
[09:41:56] <Manishearth> also, rustfmt has a bunch of easy bugs
[09:42:09] <Manishearth> (almost all bugs on clippy are easy, though I should mark them as such)
[09:42:20] <madmalik> i'll look into that
[09:43:39] <nrc> https://github.com/nrc/rustfmt/issues
[09:43:43] <madmalik> is clippy something like a playground for lints before they go into rustc_lint or is it a completely separate project?
[09:43:57] <Manishearth> madmalik: completely separate
[09:44:16] <nrc> I haven't kept up with tagging stuff easy :-( There are a bunch of issues that are easy, but not tagged that way
[09:44:19] <Manishearth> madmalik: the rustc lint philosophy is that if it can be done outside, it should, but if a lot of folks want it, it may be included
[10:07:45] <eddyb> doener: oh, that's what it was!
[10:07:58] <eddyb> doener: how is *const T -> *const T even encoded?
[10:13:33] <eddyb> error: cannot extract an associated type from a higher-ranked trait bound in this context
[10:13:36] <eddyb> :(
[10:13:57] <eddyb> nmatsakis: why can't I just write for<'a> <T::Lifted as ty::Lift<'a>>::Lifted: UserString + TypeFoldable<'a>?
[10:14:09] <eddyb> wait, that's broken
[10:14:34] <eddyb> (I left ::Lifted on T by mistake)
[10:15:49] <eddyb> error: the trait `for<'a> util::ppaux::UserString` is not implemented for the type `<middle::ty::TraitRef<'_> as middle::ty::Lift<'a>>::Lifted`
[10:16:03] <eddyb> now that's not normalized :/
[10:16:28] <eddyb> it should be normalized to middle::ty::TraitRef<'a>
[10:56:38] <doener> hmm, http://buildbot.rust-lang.org/builders/auto-mac-64-opt/builds/5366/steps/test/logs/stdio -- I'm not sure about the rules here, but the new error message that caused the failure seems to be valid
[11:01:17] <doener> yeah, something's wrong there
[11:03:21] <doener> https://play.rust-lang.org/?gist=429db9505a5109c44e86&version=stable
[11:05:41] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[11:05:47] <bluss> a user in #rust found a soundness bug https://play.rust-lang.org/?gist=fa76d724916938b3f4e8&version=nightly
[11:06:03] <bluss> trait A : PartialEq<Foo> + PartialEq<Bar> { }  // this leads to trouble
[11:13:59] <bluss> is issue https://github.com/rust-lang/rust/issues/26339 ^
[11:14:57] *** zz_kimundi is now known as kimundi
[15:36:09] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[15:36:10] *** ChanServ sets mode: +qo brson brson
[15:45:26] *** Quits: doener (doener@moz-eku96m.hsi08.unitymediagroup.de) (Quit: leaving)
[16:35:41] *** Joins: nmatsakis_ (sid381@moz-32a8b5.0j4i.jtu0.0101.2620.IP)
[17:36:03] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[17:36:56] *** kimundi is now known as zz_kimundi
[17:37:01] *** zz_kimundi is now known as kimundi
[17:38:10] *** Joins: sigma (sigma@moz-uqk2kb.range86-146.btcentralplus.com)
[18:28:13] *** Quits: nmatsakis (nmatsakis@moz-no0.93r.245.63.IP) (Quit: leaving)
[18:28:14] *** nmatsakis_ is now known as nmatsakis
[18:28:38] *** Joins: arielb1 (Ariel@moz-lpse9v.red.bezeqint.net)
[18:31:09] *** ChanServ sets mode: +o nmatsakis
[19:02:39] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[19:19:15] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[19:40:48] *** Quits: sigma (sigma@moz-uqk2kb.range86-146.btcentralplus.com) (Ping timeout: 121 seconds)
[19:49:19] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[20:00:01] *** Joins: mihneadb (mihneadb@moz-k6cs38.lots.snn0.2f0b.2a02.IP)
[20:06:47] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[20:46:32] <nmatsakis> nrc: anyway, yeah, I'm a bit concerned to land such a change for 1.1. seems like a bad bet I guess.
[20:46:59] <nmatsakis> aturon: so to catch you up :)
[20:47:09] <nmatsakis> I implemented a change that gives a ... fairly precise warning about the object lifetime bound change
[20:47:17] <nmatsakis> I haven't tested it super aggressively but seems to work
[20:47:26] <nmatsakis> but I was thinking that I'd be a bit nervous to backport this to 1.1
[20:47:30] <nmatsakis> as it's mildly invasive
[20:47:34] <nmatsakis> and I fear causing ICEs or something
[20:47:55] <nmatsakis> naturally, triyng to issue a warning is much more invasive than the change itself, which is tiny
[20:47:59] <aturon> :)
[20:48:13] <nmatsakis> (I haven't tested it cross-crate, actually, should do that)
[20:48:18] <nmatsakis> anyway, I could also adapt this code of course
[20:48:21] <aturon> tbh, i still don't really understand the rationale of such a warning over something like `legacy`
[20:48:26] <nmatsakis> to give a better error message (rather than a warning)
[20:48:29] <aturon> in that it seems strictly more painful
[20:48:39] <nmatsakis> well, it means people's code works 
[20:48:44] <nmatsakis> but they can change to explicit annotations
[20:48:48] <nmatsakis> in the interim
[20:48:53] <nmatsakis> well, the warning is only issued
[20:48:59] <nmatsakis> if you would need an explicit annotation long term
[20:49:10] <aturon> ah i see
[20:49:31] <nmatsakis> so I guess it would be something like:
[20:49:33] <nmatsakis> you use somebody's crate
[20:49:35] <nmatsakis> you see warnings
[20:49:37] <nmatsakis> you e-mail them
[20:49:37] <aturon> so the benefit is you get to migrate slowly, without a big-hammer crate-level switch
[20:49:39] <nmatsakis> they fix before 1.2
[20:49:39] <nmatsakis> :)
[20:49:47] <aturon> seems reasonable
[20:49:51] <nmatsakis> (if we backported the warning)
[20:49:54] <aturon> right
[20:49:56] <nmatsakis> so I guess the question is:
[20:50:00] <nmatsakis> 1. backport to 1.1?
[20:50:06] <nmatsakis> 2. land with warning in 1.2, make the swich in 1.3?
[20:50:16] <nmatsakis> 3. land the switch in 1.2, but with better error message?
[20:50:24] <nmatsakis> (er, backport warning to 1.1)
[20:50:33] <nmatsakis> I feel nervous about 1 because risk,
[20:50:35] <aturon> i don't feel super comfortable with 1
[20:50:37] <nmatsakis> but nervous bout 2 because of long delay
[20:50:42] <nmatsakis> but maybe the delay isn't so bad
[20:50:51] <aturon> hm, in that you think people may ignore the warning?
[20:51:09] <nmatsakis> who knows what people will do
[20:51:18] <nmatsakis> yeah I guess
[20:51:24] <nmatsakis> or rather I guess that
[20:51:24] <aturon> well, trying to understand what you mean about "long delay"
[20:51:35] <nmatsakis> well, I was thinking maybe they ignore the warning,
[20:51:40] <nmatsakis> but i'm not sure that my thought made sense
[20:51:45] <nmatsakis> at least, if you assume they will NOT ignore the warning
[20:51:49] <nmatsakis> then the delay is no longer 
[20:51:57] <nmatsakis> than the current plan of landing the change in 1.2
[20:52:00] <aturon> do you imagine *also* having `legacy`?
[20:52:10] <nmatsakis> I'd rather not
[20:52:18] <nmatsakis> I can still land the legacy mechanism though
[20:52:24] <nmatsakis> or we could hold off and write an RFc
[20:52:30] <nmatsakis> and land it in 1.3 or whatever
[20:52:38] <nmatsakis> we could also include it, I don't really care
[20:52:45] <nmatsakis> I'd just rather not have a legacy switch if we didn't need one ;)
[20:52:48] <aturon> so one thing we don't know at this point is the breakdown of people likely to use 1.1 stable, 1.2 beta, vs nightly
[20:52:55] <nmatsakis> yes
[20:53:09] <nmatsakis> I would think that it would go in order of: 1.1 stable, nightly, 1.2 beta
[20:53:14] <nmatsakis> but I might have the first two wrong
[20:53:24] <aturon> yeah, i'm really not sure :)
[20:53:30] <acrichto> we could in theory issue 1.1.1
[20:53:38] <acrichto> e.g. a few weeks into 1.1
[20:53:39] <nmatsakis> also true
[20:53:45] <nmatsakis> right once the patch has had some testing
[20:53:46] <acrichto> after we have experience on 1.2 beta
[20:53:49] <aturon> well, so people using 1.1 stable,
[20:53:54] <aturon> are presumably going to switch to 1.2 stable when it comes out
[20:54:02] <aturon> in which case, they'll still have a full cycle of warnings
[20:54:05] <aturon> before the switch happens
[20:54:19] <nmatsakis> right
[20:54:21] <aturon> 6 weeks seems like enough warning?
[20:54:27] <nmatsakis> and I made the warning impossible to disable
[20:54:29] <nmatsakis> without editing your code ;)
[20:54:33] <nmatsakis> mostly because I was lazy,
[20:54:34] <acrichto> hehe
[20:54:37] <nmatsakis> but also because it seemed to make sense
[20:54:46] <nrc> agreed
[20:55:09] <aturon> so, i think i lean toward your option 2
[20:55:17] <nmatsakis> ok, yes, I am leaning that way right now too
[20:55:18] <aturon> warning at 1.2, switch at 1.3
[20:55:24] <nmatsakis> and I figure we'll change nightly over
[20:55:24] <nmatsakis> sooner
[20:55:25] <aturon> i'm on the fence about legacy --
[20:55:30] <aturon> well, or rather,
[20:55:42] <aturon> ideally this RFC would land together with policy that supports it
[20:55:48] <acrichto> r+
[20:55:49] <aturon> right now the policy modifications talk about legacy, etc
[20:56:17] <aturon> (and i still think that in general, a legacy switch is a way to ensure "hassle-free" updates)
[20:56:25] <nmatsakis> so I think we want a legacy attribute
[20:56:34] <nmatsakis> I just want to avoid using it as much as we can ;)
[20:56:52] <aturon> +1
[20:57:11] <aturon> so basically, i'm saying we should either provide such a switch for this case, or else we need some coherent story for when you don't need to do it
[20:57:25] <nrc> yeah, I want legacy, but not for this
[20:57:39] <aturon> (i continue to like the summary provided in https://github.com/rust-lang/rfcs/pull/1156#issuecomment-111990565)
[20:57:41] <nrc> every legacy we support will equal a tonne of pain in the compiler
[20:58:20] <aturon> note the policy outlined in that comment explicitly supports doing a warning only
[20:58:45] <aturon> well, modulo the final bullet (which is important in general)
[21:00:01] <nmatsakis> aturon: well, I envision legacy being used for cases where (a) signifcant usage is expected and/or (b) we can't provide a graceful warning transition
[21:00:07] <nmatsakis> er, significant breakage
[21:00:12] <nmatsakis> and/or the fix is involved
[21:00:22] <nmatsakis> in my ideal world, legacy's would also not last forever
[21:00:37] <nmatsakis> basically the legacy takes the place of the warning
[21:00:42] <nmatsakis> it is a less good way to create a smooth transition
[21:01:48] <nmatsakis> (but better than nothing)
[21:01:54] <aturon> that fits well with the whole LTS story we've been tossing around
[21:02:07] <aturon> that is, if such "course corrections" are limited to an LTS cycle, 
[21:02:16] <aturon> then if you go from LTS to LTS it's like it never happened :P
[21:02:23] <aturon> (and there are no lasting flags for evidence, either)
[21:08:03] <nmatsakis> aturon: nrc acrichto https://gist.github.com/nikomatsakis/31589326beb3ce6a64f5 ?
[21:08:51] <nmatsakis> that sums up my current thinking ;)
[21:11:51] <nrc> if that is meant to go into an RFC or something, then the last point about LTS is a bit out of place since no one has talked publicly about LTS releases
[21:19:40] <eddyb> oops, references are now printed as & T. something went wrong with one of my regexes, too
[21:26:23] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[21:38:15] *** kimundi is now known as zz_kimundi
[21:42:18] *** Quits: mihneadb (mihneadb@moz-k6cs38.lots.snn0.2f0b.2a02.IP) (Quit: Leaving)
[21:44:02] *** Quits: arielb1 (Ariel@moz-lpse9v.red.bezeqint.net) (Quit: Ex-Chat)
[21:56:04] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[22:35:02] *** Joins: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com)
[22:55:15] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:02:25] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Ping timeout: 121 seconds)
[23:16:16] *** Joins: mihneadb (mihneadb@moz-k6cs38.lots.snn0.2f0b.2a02.IP)
[23:24:01] <eddyb> nmatsakis: does rustc_driver use dummy values for node IDs?
[23:24:21] <eddyb> in testing, I mean, check-stageN-rustc_driver
[23:28:09] <eddyb> nmatsakis: I turned format!("unknown scope: {:?}.  Please report a bug.", scope) into tcx.sess.bug(&format!("unknown scope: {:?} while explaining region", scope))
[23:32:46] <eddyb> maybe it's the missing prefix and suffix that makes the test fail
[23:47:43] *** Quits: mihneadb (mihneadb@moz-k6cs38.lots.snn0.2f0b.2a02.IP) (Quit: Leaving)
