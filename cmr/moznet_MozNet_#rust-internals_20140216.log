[00:13:26] <brson> acrichto: how do you ingore-win32 an rmake test?
[00:13:37] <acrichto> brson: rmake just isn't run on win32
[00:13:45] <acrichto> at least not on the bots
[00:13:53] <brson> i'm removing check-fast
[00:13:55] <acrichto> if you run 'make check-stage2-rmake' on windows things will get real sad real fast
[00:13:58] <acrichto> oh dear
[00:14:11] <acrichto> I'd modify the python script to just not run anything on windows
[00:14:17] <brson> k
[00:14:21] <acrichto> they're essentially all ignore-win32 right now
[00:23:28] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[00:25:48] <brson> strcat: do we need to make any changes to the well behavedness of our iterators?
[00:26:13] <strcat> brson: hm?
[00:26:31] <strcat> you mean the thing on the mailing list?
[00:26:33] <strcat> dunno
[00:26:42] <cmr> I don't think we do
[00:26:47] * huon likes the current situation
[00:26:48] <cmr> we already had this discussion a while back..
[00:26:51] <strcat> it's not very important and we could always provide the guarantee in the future
[00:27:32] <huon> someone can explicit .fuse() the iterator if they absolutely *need* the guarantee
[00:27:36] *** kimundi is now known as zz_kimundi
[00:31:33] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[00:31:33] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/epTFlg
[00:31:33] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[00:36:29] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[00:36:29] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/XmcjVg
[00:36:29] <ghrust> 13rust/06auto 146667f90 15Alex Crichton: Update rustdoc testing to test all code blocks...
[00:36:29] <ghrust> 13rust/06auto 14e72ddbd 15Alex Crichton: Fix all code examples
[00:36:29] <ghrust> 13rust/06auto 140c62d9d 15bors: auto merge of #12298 : alexcrichton/rust/rustdoc-testing, r=sfackler...
[00:36:31] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[00:36:32] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[00:36:32] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/tVLcpA
[00:36:32] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[00:38:47] <huon> acrichto: could https://github.com/mozilla/rust/pull/12108 go on the meeting agenda?
[00:39:09] <acrichto> huon: already on there :)
[00:39:13] <acrichto> should have commented to that effect
[00:39:38] <huon> cool
[00:41:08] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[00:41:13] <acrichto> brson: #4139 may be the wrong issue link
[00:43:20] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:44:13] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[00:45:55] <brson> it is
[00:53:12] <Eridius> acrichto: I don't know what self.steals and self.cnt is, but in #12302, are you intending to increase the value of self.cnt when self.steals < self.cnt?
[00:53:13] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:53:17] <Eridius> because that's what you're doing
[00:55:40] *** Joins: lpy (lpy@3481A86.D40F0E75.E99F7FDB.IP)
[00:57:42] *** Quits: lpy (lpy@3481A86.D40F0E75.E99F7FDB.IP) (Ping timeout)
[01:07:21] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[01:07:27] *** Joins: lpy (lpy@3481A86.D40F0E75.E99F7FDB.IP)
[01:09:08] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:09:29] *** Quits: lpy (lpy@3481A86.D40F0E75.E99F7FDB.IP) (Ping timeout)
[01:12:17] <Eridius> acrichto: ah hah, I see, you already dropped cnt to 0 a few lines above
[01:13:32] *** Joins: tjc (tjc@5EA50096.518F69F6.B732EA24.IP)
[01:13:32] *** ChanServ sets mode: +o tjc
[01:13:46] <Luqman> acrichto: r? https://github.com/mozilla/rust/pull/12305
[01:15:01] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[01:15:11] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:15:13] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:15:42] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:15:48] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:16:02] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[01:16:22] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:16:26] *** Joins: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net)
[01:17:41] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:17:41] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:18:26] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[01:18:50] *** Joins: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net)
[01:24:49] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[01:51:31] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:51:31] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/XmcjVg
[01:51:31] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:56:32] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:56:32] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/wOKz-g
[01:56:32] <ghrust> 13rust/06auto 14b593189 15Alex Crichton: Allow configuration of uid/gid/detach on processes...
[01:56:32] <ghrust> 13rust/06auto 148cb1103 15bors: auto merge of #12085 : alexcrichton/rust/issue-12082, r=brson...
[01:56:33] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:56:36] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:56:36] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/cuphtg
[01:56:36] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[02:01:36] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[02:03:06] *** Joins: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net)
[02:08:13] *** Joins: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP)
[02:10:14] *** Quits: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP) (Ping timeout)
[02:15:36] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[02:16:23] *** Joins: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net)
[02:17:13] <huon> Could someone(s) vouch for me? https://mozillians.org/en-US/u/huon/
[02:18:27] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:18:34] <huon> thanks strcat
[02:21:37] <acrichto> Luqman: oop sorry about that :(
[02:21:50] <cmr> acrichto: https://github.com/mozilla/rust/pull/12186 cheater!
[02:22:05] <acrichto> cmr: ?
[02:22:23] <cmr> optimizing for benchmarks :P
[02:22:48] <acrichto> lol, that's something that I've always intended to implement anyway
[02:22:54] <cmr> sure, sure.
[02:24:47] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[02:25:50] <acrichto> our context switching isn't very fast, and my goal is to optimize evrything else so that's high up in the benchmarks
[02:26:54] <cmr> acrichto: your rollups negatively impacted the number of PRs merged this week.
[02:27:05] <cmr> we could have been in the 70s! instead we're at 64
[02:27:31] <huon> people will think we're slacking off! :'(
[02:27:36] <acrichto> you should count the merged PRs
[02:27:40] <acrichto> it was like 15 and 14 in the rollups
[02:27:51] *** Joins: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net)
[02:28:58] <Eridius> cmr: count PRs that were merged, not actual merges
[02:29:03] <Eridius> so if a PR was in the rollup, that's still a merged PR
[02:34:51] *** Joins: jdm (jdm@E595D12E.1196002C.7DBB297B.IP)
[02:37:58] <bstrie> huon: is that a photo of you on your mozillians page? if so, where it at?
[02:42:33] <huon> bstrie: yes; it's just above Bergen, Norway
[02:50:01] *** Quits: tjc (tjc@5EA50096.518F69F6.B732EA24.IP) (Quit: Textual IRC Client: www.textualapp.com)
[02:52:25] <cmr> bstrie: it's the same picture that's on github.
[02:52:31] <cmr> bstrie: haven't you stalked all the contributors???
[02:53:57] *** Quits: cgaebel (clark@moz-C3552556.nycmny.east.verizon.net) (Ping timeout)
[02:56:30] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[02:56:30] <ghrust> [13rust] 15bors 04force-pushed 06auto from 148cb1103 to 140c62d9d: 02http://git.io/N3iJvQ
[02:56:30] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[02:56:30] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[02:56:31] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/ff_JhA
[02:56:31] <ghrust> 13rust/06auto 1423fdbcf 15Steven Fackler: Add a method to LimitReader to return the limit...
[02:56:31] <ghrust> 13rust/06auto 1449ba513 15bors: auto merge of #12299 : sfackler/rust/limit-return, r=alexcrichton...
[02:56:31] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[02:58:24] <cmr> 86 pull requests O_o
[02:58:33] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:58:44] <cmr> I think that might be a record.
[02:59:48] <cmr> When I started TWiR, the norm was ~30-40
[03:00:07] <cmr> nope
[03:00:11] <cmr> that was just the first month or so...
[03:01:36] <cmr> Nope, tied for first with the week of 9/23/2013
[03:02:47] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:06:50] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:06:50] *** ChanServ sets mode: +qo brson brson
[03:07:10] *** Joins: brson_ (brson@85F686A5.7D4C7FED.7A1399C0.IP)
[03:08:38] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:08:57] *** Joins: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP)
[03:11:03] *** Quits: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP) (Ping timeout)
[03:11:12] *** Joins: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP)
[03:16:16] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[03:18:10] *** Quits: cgaebel (clark@ADA4DDE2.290DF317.EE6E63A5.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0/20140130123732])
[03:21:51] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[03:22:28] *** Quits: brson_ (brson@85F686A5.7D4C7FED.7A1399C0.IP) (Quit: leaving)
[03:22:32] *** Joins: brson (brson@85F686A5.7D4C7FED.7A1399C0.IP)
[03:22:32] *** ChanServ sets mode: +qo brson brson
[03:23:20] *** Quits: new_one (new_one@338D8DF9.4C461BEC.59A381B9.IP) (Quit: leaving)
[03:24:07] *** Joins: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP)
[03:30:25] *** Joins: brson_ (brson@moz-BBE3ABD.mv.mozilla.com)
[03:31:04] *** Quits: brson (brson@85F686A5.7D4C7FED.7A1399C0.IP) (Ping timeout)
[03:31:20] *** Quits: brson_ (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[03:31:38] *** Joins: brson (brson@E02A6CDD.75598729.B6A3AE99.IP)
[03:31:38] *** ChanServ sets mode: +qo brson brson
[03:37:54] *** Quits: gimpf (gimpf@moz-5FCD9CCC.adsl.highway.telekom.at) (Ping timeout)
[03:40:00] <cmr> acrichto: could we compile compiler-rt as bc and inject it directly into crates, as IR?
[03:41:06] <huon> cmr: i.e. manual LTO?
[03:41:24] <cmr> pretty much
[03:42:15] <acrichto> I don't it works like that though
[03:42:22] <acrichto> LLVM may not be smart enough to do that
[03:42:29] <acrichto> b/c the IR doesn't actually have function calls to compiler-rt
[03:42:30] <cmr> to do what?
[03:42:33] <cmr> oh.
[03:42:37] <cmr> oh yeah good point
[03:42:40] <cmr> codegen makes those.
[03:42:41] <acrichto> during lowering some instructions get translated as function calls
[03:43:04] <strcat> cmr: it shouldn't be
[03:43:17] <strcat> compiler-rt is something codegen will output calls to
[03:43:26] <cmr> right
[03:43:31] <cmr> there'd be no gain to having it as ir
[03:43:38] <cmr> the calls are emitted too late in the process.
[03:43:40] <strcat> it only uses it as a last resort anyway
[03:43:45] <strcat> I really doubt it gets used much on x86_64
[03:43:53] <strcat> would be interesting to see what actually gets pulled in from it
[03:47:13] *** Quits: jdm (jdm@E595D12E.1196002C.7DBB297B.IP) (Quit: Lost terminal)
[03:47:35] <cmr> eugh the sanitizers want type information
[03:54:52] *** Quits: zz_kimundi (kimundi@moz-39AAC267.dip0.t-ipconnect.de) (Ping timeout)
[03:58:32] *** Joins: zz_kimundi (kimundi@moz-914F75A4.dip0.t-ipconnect.de)
[03:58:34] *** zz_kimundi is now known as kimundi
[04:07:31] <Eridius> dammit, I really wish we had once stack closures. MutexArc.access() can't move out of its environment >_<
[04:11:33] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[04:11:33] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/ff_JhA
[04:11:33] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[04:13:26] *** Joins: brson_ (brson@moz-BBE3ABD.mv.mozilla.com)
[04:13:46] *** Quits: brson (brson@E02A6CDD.75598729.B6A3AE99.IP) (Ping timeout)
[04:15:48] <huon> Eridius: option dance \o/
[04:16:28] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:16:28] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/N2Ucgw
[04:16:29] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:18:26] <Eridius> huon: yeah :/
[04:18:26] <sfackler> Eridius: access should really just be rewritten to be RAII-y
[04:18:43] <Eridius> huon: also I needed to use .unsafe_access because I was wrapping a Chan<proc(..)>, which apparently isn't Send. Goddammit
[04:18:46] <Eridius> I mean Freeze
[04:19:17] <sfackler> I had an RFC on removing the silly unsafe_access thing
[04:19:31] <sfackler> I should bump it now that Rc doesn't try to statically prevent cycles
[04:19:32] <Eridius> sfackler: and replacing it with what? It exists to prevent nesting of MutexArcs
[04:19:36] <Eridius> ah
[04:19:46] <Eridius> in that case, makes sense
[04:22:13] <strcat> channels, etc. never prevented cycles anyway
[04:22:36] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:22:43] <strcat> I think it's to stop you from attempting to lock a mutex you've already locked
[04:23:30] <Eridius> yeah otherwise you could clone an arc and put it inside itself
[04:23:36] <Eridius> or.. maybe not
[04:23:38] <Eridius> you can't express that type
[04:23:48] <Eridius> but you could nest two different MutexArcs I guess..
[04:29:15] *** Quits: lpy (lpy@809E366F.9B88FD1B.E99F7FDB.IP) (Ping timeout)
[04:34:22] *** Joins: lpy (lpy@527E9448.E262279B.65042015.IP)
[04:36:56] *** Joins: brson (brson@E02A6CDD.75598729.B6A3AE99.IP)
[04:36:56] *** ChanServ sets mode: +qo brson brson
[04:38:11] *** Quits: brson_ (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:43:44] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:43:49] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:46:27] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[04:46:27] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14a5888df to 1449ba513: 02http://git.io/N3iJvQ
[04:46:27] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[04:46:27] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:46:27] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/sDSo3A
[04:46:27] <ghrust> 13rust/06auto 14615536a 15Luqman Aden: mk: Remove old flags to llc for arm.
[04:46:27] <ghrust> 13rust/06auto 14f3d4fe7 15bors: auto merge of #12305 : luqmana/rust/ub, r=sfackler...
[04:46:28] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:02:18] <erickt> acrichto: ping
[05:06:36] <acrichto> erickt: pong
[05:07:42] <erickt> acrichto: so just to clarify. You would like me to break up my PR into two. One that adds my new hash framework, and a follow on that replaces IterBytes with this framework 
[05:08:02] <acrichto> erickt: would that cut down on the cfg(stage0) stuff?
[05:08:09] <acrichto> I'm worried about the magnitude of duplication
[05:08:44] <erickt> acrichto: well for this PR. There will have to be one that's full of cfg(stage0), but splitting them in two should make it a little easier to review
[05:09:04] <acrichto> erickt: isn't the cfg(stage0) because we don't have deriving(Hash) right now?
[05:09:18] <erickt> true
[05:09:32] <erickt> sigh. I should have thought of that :)
[05:09:57] <acrichto> I was hoping that if we could snapshot deriving(Hash) that we wouldn't need cfg(stage0) at al
[05:10:55] <erickt> acrichto: I'll see what I can do
[05:11:02] <acrichto> thanks!
[05:12:12] <erickt> acrichto: Also, I wanted to chat about the number of traits. The reason why there are Hash, StreamState, StreamHash, and StreamHasher is to support completely custom hashing schemes that don't compute the hash over the bytes of the value 
[05:12:45] <acrichto> what's an example?
[05:12:47] <erickt> stream hashers need to thread some state object through each subcomponent of a value, which is why they get a state object
[05:13:14] <erickt> acrichto: https://github.com/mozilla/rust/pull/11863/files#diff-9e428a5cf51eac3927c751434d4d16eeR454
[05:13:43] <erickt> acrichto: say a value has a cached hash value. Say from a database
[05:14:15] <acrichto> hm, but there's no way to stick that in a hash map right now?
[05:15:09] <erickt> not that I could figure out. There must be some protocol between a hasher, like sip, and a hashee in order to compute the hash
[05:15:46] <acrichto> hm, so I guess for now, why is there a StreamState and a StreamHasher?
[05:16:01] <acrichto> I figured there would only be one?
[05:16:32] <erickt> acrichto: I explain why in this comment: https://github.com/mozilla/rust/pull/11863#issuecomment-35164428
[05:16:59] *** Quits: lpy (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[05:17:06] <erickt> acrichto: basically, HashMap needs a factory that can create the state object that'll be threaded through the values
[05:17:28] <acrichto> why does it need to be a factory?
[05:17:29] *** Joins: lpy (lpy@527E9448.E262279B.65042015.IP)
[05:17:34] <acrichto> why doesn't the hash map just have an internal SipState
[05:17:43] <acrichto> or rather whenever it needs to hash something it just creates a SipState
[05:17:51] <acrichto> and then passes that into the keys
[05:17:59] <acrichto> key.hash(&mut local_state);
[05:18:30] <erickt> acrichto: there are a couple ways you could do that. First, just tie HashMap to only work with SipState
[05:18:50] <acrichto> oh that's a good point
[05:19:19] <erickt> Second, HashMap could be created with a generic clonable StreamState. When you want to hash something you could clone it, but that opens you up to forgetting to clone 
[05:20:20] <erickt> Third, state objects could have a .reset() that resets the state to initial conditions. However, ou run into the same issue of forgetting to reset, and now there's no way to concurrently hash a set of values
[05:20:27] <acrichto> I guess my main concern is the number of traits. I am unconvinced we need all of them, but I'm also unconvinced that we should remove any of them
[05:20:42] <acrichto> if we could reduce the number without losing expressability that would be awesome
[05:21:31] <erickt> generally only creators of a HashMap-like structure should care about Hashers, so simplest thing would be to put them in a hash::hasher submodule.
[05:21:45] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[05:22:32] <erickt> Most users that want to hash a value should be reaching for #[deriving(Hash)], but if they want something custom, they then have to be aware of StreamState and StreamHash
[05:23:02] <acrichto> it seems like a little too much though
[05:23:12] <acrichto> if I were creating a custom hash, why would I want something other than Hash ?
[05:23:17] <acrichto> shouldn't that be all I have to look for?
[05:23:21] <acrichto> in the case of a precomputed hash
[05:23:34] <erickt> Or not. I'm using eddyb's default typarams so they could just do `impl Hash for Ty { â€¦ }`
[05:24:16] <acrichto> not exactly though b/c the type parameter is part of the function?
[05:24:27] <erickt> acrichto: Sure. That's what my `Custom` hash test does: https://github.com/mozilla/rust/pull/11863/files#diff-9e428a5cf51eac3927c751434d4d16eeR454
[05:24:50] <acrichto> but doesn't it seem awkward to have this () in there?
[05:25:40] <erickt> I'm open to alternatives, but I think I've exhausted all of them :)
[05:26:30] <erickt> I originally had Hash without a state object, and had the hasher as `trait Hasher<H: Hash> { }`. that worked great up until I had to support HashMap.find_equiv
[05:26:31] <acrichto> yeah I'm not saying that we should abandon this or anything, I'm just curious about the justification for all the complexity
[05:26:54] <acrichto> how did that make it harder?
[05:26:57] <erickt> .find_equiv requires us to have a hasher that can hash multiple types
[05:27:38] <erickt> but doing SipHasher<int> constrains us to only be able to hash ints
[05:29:15] <acrichto> but why is StreamState different from StreamHash?
[05:29:20] <acrichto> StreamHasher*
[05:29:27] <acrichto> it seems like there should only be one
[05:32:24] <erickt> acrichto: that was part of my argument here: https://botbot.me/mozilla/rust-internals/msg/10992014/
[05:33:07] <erickt> acrichto: I feel the best way to make a generic HashMap is to have a factory trait that produces the state that gets threaded through the values
[05:33:48] * cmr has an allergic reaction to the word 'factory'
[05:33:50] <acrichto> hmm, ok I will try to digest this
[05:34:04] <cmr> hah!
[05:34:07] <cmr> digest
[05:34:09] <cmr> hilarious
[05:34:12] <acrichto> oh lol
[05:34:12] <erickt> lol
[05:34:35] <erickt> cmr: that's why I called it a Hasher instead of a HashStateFactory
[05:36:17] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[05:38:07] <erickt> acrichto: the end result of all this is that there are a lot of unfortunate compromises in this approach. And while I'd hate to throw away this work, a valid option would be to just say it turns out we don't want to support completely custom hashing, but instead want to only support byte stream hashing
[05:38:30] <erickt> that would really simplify down a lot of this code
[05:38:45] <acrichto> hm, why wouldn't we want that?
[05:38:58] <acrichto> in theory if hashing a u64 was fast then you could just "hash a precomputed hash" to get a deterministic hash
[05:39:47] <erickt> sure, that's a valid argument
[05:40:01] <acrichto> interesting...
[05:40:15] <acrichto> how much would it simplify things?
[05:40:22] <erickt> we aren't haskell, so we don't need to make everything as generic as possible :)
[05:41:02] <erickt> I do feel though that most end users don't have to be aware of all this complication
[05:41:43] <erickt> Especially if we actually get `impl<T: StreamHash> Hash for T { â€¦ }` to work without preventing anyone else from implementing Hash
[05:42:09] <acrichto> hm, so brson has put this on the agenda for the next meeting
[05:42:16] <acrichto> I think this is a good point to discuss
[05:42:22] <acrichto> it doesn't seem like that much of a loss to me
[05:43:11] <erickt> what doesn't seem like much of a loss? Losing the ability to do completely custom hashers?
[05:43:47] <acrichto> yeah
[05:43:58] <acrichto> your stream state could always just be the identity function, right?
[05:44:10] <acrichto> so hashing the object would input the precomputed hash value
[05:44:16] <acrichto> and the state would just return that as the result?
[05:44:23] <acrichto> so it shouldn't be a perf loss
[05:44:44] *** Joins: gwty (gwtypc@9D5369FE.3032B930.49FF672.IP)
[05:46:24] <erickt> one downside to that would be you could accidentally use that identity hash state on a compound structure. Then the hash would just be the hash of the last thing hashed
[05:46:35] <acrichto> it's true
[05:46:46] <erickt> the advantage of the custom hasher is the type system would prevent you from doing that
[05:47:57] *** Quits: gwty (gwtypc@9D5369FE.3032B930.49FF672.IP) (Client exited)
[05:49:05] *** Quits: canhtak (canhtak@moz-843B48BB.wl.t.ulaval.ca) (Quit: canhtak)
[06:01:30] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[06:01:30] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/sDSo3A
[06:01:30] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[06:05:32] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[06:06:28] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[06:06:28] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/HuPy6w
[06:06:28] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[06:06:29] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[06:06:29] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/TmgANA
[06:06:29] <ghrust> 13rust/06auto 14fd57717 15Flavio Percoco: Add test and close #8893
[06:06:29] <ghrust> 13rust/06auto 145d4fd50 15bors: auto merge of #12301 : FlaPer87/rust/issue-8893, r=alexcrichton
[06:06:29] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[06:14:51] *** Quits: sully (sully@moz-45967CBE.emarhavil.com) (Ping timeout)
[06:16:20] *** Quits: bytbox (s@moz-AA99B23F.washdc.fios.verizon.net) (No route to host)
[06:17:00] *** Joins: bytbox (s@moz-AA99B23F.washdc.fios.verizon.net)
[06:23:08] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[06:23:30] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[06:29:14] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[06:40:24] *** Joins: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP)
[06:54:10] *** Quits: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP) (Quit: Leaving...)
[06:56:33] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[07:02:43] <brson> the "check-test" build target does nothing but check-stage2-rfail
[07:02:58] <cmr> I didn't even know that was a valid target.
[07:16:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[07:16:30] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/TmgANA
[07:16:30] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[07:18:02] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[07:21:33] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[07:21:33] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/n-arYg
[07:21:33] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[07:28:11] *** Quits: brson (brson@E02A6CDD.75598729.B6A3AE99.IP) (Ping timeout)
[07:28:58] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[07:28:59] *** ChanServ sets mode: +qo brson brson
[07:29:19] <brson> i'm restarting the android slave because i lost ssh access
[07:32:43] <brson> r? https://github.com/mozilla/rust/pull/12310
[07:35:11] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[07:36:29] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:36:29] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/n-arYg
[07:36:29] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:36:30] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[07:36:30] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/HJxI-g
[07:36:30] <ghrust> 13rust/06auto 14836ffb5 15Alex Crichton: Silence some unused import warnings
[07:36:30] <ghrust> 13rust/06auto 14bea7862 15Alex Crichton: Correctly reset steals when hitting MAX_STEALS...
[07:36:31] <ghrust> 13rust/06auto 14b36340b 15bors: auto merge of #12302 : alexcrichton/rust/issue-12295, r=brson...
[07:36:33] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[07:37:08] <brson> crate_type = "lib" should probably mean both
[07:40:51] *** Joins: eddyb (eddy@688E9026.F7C96DA2.FCAAE698.IP)
[07:45:12] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[07:45:22] *** Joins: brson (brson@59C3BD5D.9810012B.7A1399C0.IP)
[07:45:22] *** ChanServ sets mode: +qo brson brson
[08:00:23] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[08:07:03] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:14:23] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[08:26:19] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:26:21] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:26:48] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:29:46] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[08:34:26] <bjz> r? https://github.com/mozilla/rust/pull/12313
[08:35:10] <bjz> removed half of the tuple traits! \o/
[08:42:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:42:21] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:42:42] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:43:55] *** Joins: eibwen (kvirc@moz-A8A6C70C.dip0.t-ipconnect.de)
[08:45:57] <eddyb> strcat: you weren't around yesterday... it's rather easy to treat any tuple as a slice (if it has all the types identical) with variadic generics
[08:46:33] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[08:46:33] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/HJxI-g
[08:46:33] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[08:47:30] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[08:47:51] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[08:47:59] <eddyb> also, Index for tuples could return &Any. or there could be a get_as_ref method returning Option<&'a T>
[08:48:22] <eddyb> no need for the static if's and whatnot from D, we can implement all of this in the library :)
[08:49:36] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[08:51:37] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[08:51:38] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/v7FTSQ
[08:51:38] <ghrust> 13rust/06auto 14109673f 15Brian Anderson: mk: Remove check-notidy, check-full, check-test...
[08:51:38] <ghrust> 13rust/06auto 1458678dc 15Brian Anderson: mk: Fix typo, NO_MAKEFILE_DEPS -> NO_MKFILE_DEPS
[08:51:38] <ghrust> 13rust/06auto 146fe775e 15bors: auto merge of #12310 : brson/rust/mkfilecleanup, r=sfackler...
[08:51:40] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[08:53:57] <huon> r? https://github.com/mozilla/rust/pull/12314
[08:54:12] <huon> in particular, running the commands at the bottom of my comment there
[08:59:37] <eddyb> I've just realized that the fn method(_: Option<Self>) trick is inefficient
[08:59:51] <eddyb> I wish we had something like struct Phantom<T>; in the prelude
[09:00:31] <eddyb> (well, with variadic generics, it would be Phantom<Head, ..Tail> to support more than one type param)
[09:11:51] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[09:16:45] <bjz> huon: r? https://github.com/mozilla/rust/pull/12313
[09:18:24] <bjz> huon: oh wait
[09:18:41] <bjz> huon: I think we can get rid of the Immutable trait anyway
[09:18:45] <bjz> just a sec
[09:20:47] <eddyb> can't wait for variadic generics to obliterate std::tuple
[09:20:57] <bjz> eddyb: yeah
[09:21:25] <bjz> it's pretty ugly
[09:26:22] *** Joins: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com)
[09:27:30] <eddyb> bstrie: about last night... beware that you may be feeding my Messiah complex :P
[09:35:27] <jensnockert> eddyb: Was it we who discussed the vala-bindgen thingy?
[09:35:41] <eddyb> valabind :P
[09:36:21] <eddyb> jensnockert: I've opened an issue about it https://github.com/radare/valabind/issues/20
[09:36:28] <jensnockert> eddyb: And now I'm stuck wrapping clutter, so please be finished yesterday ;)
[09:36:37] <eddyb> >_>
[09:36:50] <eddyb> jensnockert: I wish I had time travel at my disposal
[09:37:02] <jensnockert> eddyb: Me too.
[09:37:34] <jensnockert> I'm amazed that clutter built instantly without whining on OS X
[09:38:21] <eddyb> a gtk+ hello world in Rust makes me thrilled with excitement :D
[09:38:46] <eddyb> I hate glib and I use kde, but C++ is way harder to bind in Rust
[09:39:10] <eddyb> and once you stop using C, you don't have to care for the glib nonsense anyways
[09:42:49] <bjz> r? https://github.com/mozilla/rust/pull/12313
[09:48:16] <jensnockert> bjz: <3
[09:52:31] <strcat> eddyb: gobject is the awful part
[09:54:29] <jensnockert> gobject is hard to wrap nicely.
[09:54:36] <eddyb> hmm, not sure I have support for gobject stuff in valabind
[09:54:58] <bjz> jensnockert: Should I merge Float and Real?
[09:55:12] <eddyb> Real is not real :)
[09:55:17] <bjz> indeed
[09:55:47] <eddyb> Rational? sure, BigNum/BigNum
[09:55:47] <jensnockert> Yeah, please do.
[09:56:10] <jensnockert> bjz: The distinction is arbitrary right now.
[09:56:16] <eddyb> good luck precisely representing transcendentals
[09:56:52] <bjz> eddyb: so?
[09:57:24] <jensnockert> eddyb: We'll just use base-e floating point in the future! (not)
[09:57:26] <bjz> jensnockert: we've learned loads haven't we?
[09:57:35] <jensnockert> bjz: I think so.
[09:57:47] <jensnockert> bjz: Especially about users.
[09:57:50] <eddyb> I wonder, do we impl<T: Add<T, T>> Add<Complex<T>, Complex<T>> for Complex<T>?
[09:58:57] <eddyb> this is the nastiest name I've seen in a while http://static.rust-lang.org/doc/master/num/complex/struct.Cmplx.html
[09:59:00] <jensnockert> eddyb: Preferably.
[09:59:18] <eddyb> impl<T: Clone + Num> *sigh*
[09:59:42] <jensnockert> SAVE ALL THE BYTES!
[10:00:21] *** Quits: lpy (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[10:00:28] <bjz> jensnockert: maybe we should organise a rally in front of the rust repo
[10:00:36] <eddyb> why would Add need Clone?
[10:00:50] *** Joins: lpy (lpy@527E9448.E262279B.65042015.IP)
[10:01:02] <jensnockert> eddyb: Because it sometimes needs to return a or b.
[10:01:18] <jensnockert> eddyb: Because floating-point addition is defined that way for NaN.
[10:01:27] <bjz> eddyb: blame huon for Cmplx
[10:01:29] <eddyb> http://static.rust-lang.org/doc/master/src/num/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libnum/complex.rs.html#112
[10:01:31] <bjz> xD
[10:01:36] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[10:01:37] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/v7FTSQ
[10:01:37] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[10:01:44] <eddyb> maybe Cmplx::new needs Clone, hmm
[10:02:03] <eddyb> no it doesn't http://static.rust-lang.org/doc/master/src/num/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libnum/complex.rs.html#39
[10:02:11] <jensnockert> Oh wait, it's too early in the morning.
[10:02:16] <bjz> eddyb: it moves
[10:02:18] <jensnockert> My trait-fu is gone.
[10:02:23] <jensnockert> No idea why it needs it.
[10:02:31] <jensnockert> I would have to look at the impl.
[10:02:34] <eddyb> it doesn't and we don't have a lint against unused trait bounds yet
[10:02:34] <bjz> no
[10:02:38] <bjz> yes
[10:02:43] <bjz> dw
[10:02:53] <eddyb> I may have heard someone is working on one
[10:03:12] <bjz> <3 lints
[10:03:33] <bjz> such an awesome idea
[10:03:41] <eddyb> this all started because I thought Complex<Complex<T>> makes (limited) sense
[10:03:49] <bjz> where do they come from?
[10:03:52] <bjz> lints?
[10:03:58] <bjz> any other langs?
[10:04:13] <bjz> as in, I know there are warnings
[10:04:39] <bjz> and that Go doesn't have lints, it just fmts things away
[10:05:04] <eddyb> you should be able to add two Complex<Complex<f64>> ([f64, ..4] basically)
[10:05:17] <eddyb> bjz: well... https://en.wikipedia.org/wiki/Lint_(software)
[10:05:42] <jensnockert> Oh dear, I just chocked on stars.
[10:05:58] <eddyb> Stephen C. Johnson... why does that sound familiar?
[10:06:22] <jensnockert> Clutters main function has the prototype ClutterInitError clutter_init(int *argc, char ***argv);
[10:06:35] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[10:06:35] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/qcBJyg
[10:06:35] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[10:06:39] <eddyb> jensnockert: haha
[10:06:39] <bjz> eddyb: the author?
[10:06:52] <eddyb> ahh, because of Cave Johnson
[10:07:13] <eddyb> jensnockert: I know what that does
[10:07:31] <eddyb> C is just so bad at abstracting things, pointers are incomprehensible sometimes
[10:07:37] <jensnockert> eddyb: Doesn't mean I'm less choking on it.
[10:08:05] <bjz> eddyb: C's pointers lack so much information
[10:08:11] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[10:09:09] <eddyb> *mut *mut *mut char => *mut *mut &str => *mut &mut [&str] ... hang on
[10:09:36] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Connection reset by peer)
[10:09:43] <eddyb> why does it need to be able to change the pointer? nevermind, it's fine
[10:09:46] <strcat> jensnockert: that's pretty normal
[10:09:47] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[10:09:53] <strcat> lets it extract the arguments it cares about
[10:10:04] <jensnockert> strcat: Yeah, but it still annoys me.
[10:10:15] <jensnockert> It annoys me that it is normal.
[10:10:17] <eddyb> yeah, it's like &mut &mut [&str] in Rust
[10:10:26] <strcat> I've seen a lot worse
[10:10:33] <strcat> jensnockert: well, C strings are a dumb anti-pattern
[10:10:34] <strcat> even in C!
[10:10:36] <strcat> ;p
[10:10:47] <jensnockert> strcat: Exactly! <3
[10:10:53] <eddyb> strcat: your name is a testimony to it
[10:11:21] <eddyb> jensnockert: to verify myself: it can change the pointer to the first argument, not only the contents of the arguments array
[10:12:05] <jensnockert> eddyb: Yeah, or that's what I think it does at least.
[10:13:14] <eddyb> Mul needs Add and Mul
[10:13:31] <strcat> it could work with nit * and char **
[10:13:37] <strcat> you can mutate the arguments array
[10:14:04] <eddyb> it's probably cheaper to just change the start to point to the last consumed argument
[10:14:11] <eddyb> and copy argv[0] there
[10:14:28] <eddyb> bjz: so it's technically possible to multiply two Complex<Complex<f64>>... interesting
[10:14:38] <strcat> eddyb: it doesn't necessarily consume them in order
[10:15:03] <strcat> you might have --foo bar --clutter-argument baz --whatever else
[10:15:16] <eddyb> I now wonder if this nonsense I'm thinking of has any meaning in maths
[10:15:19] <strcat> so it needs to remove the clutter switch + argument
[10:15:30] <strcat> it has to reorder it
[10:15:44] <eddyb> it wouldn't need *** then, would it?
[10:15:49] <strcat> ** works
[10:16:02] <strcat> don't know why they use the extra layer.
[10:16:16] <strcat> knowing gtk/gobject/glib, it likely mallocs a whole bunch of stuff
[10:16:19] <eddyb> hmm, it still has to traverse the entire array anyway... so O(N) isn't worse
[10:16:20] <strcat> points the pointer at that instead
[10:16:22] <strcat> and never frees it
[10:16:45] <eddyb> strcat: is clutter related to glib? I have no idea
[10:16:48] <strcat> and for good measure, it does a bunch of undefined reads and so on to confuse valgrind even more
[10:16:58] <eddyb> lol
[10:17:16] <eddyb> https://en.wikipedia.org/wiki/Clutter_(software) hmm
[10:17:32] <eddyb> anything with Wayland support is interesting
[10:17:37] <bjz> eddyb: https://en.wikipedia.org/wiki/Complex_number#Multiplication_and_division
[10:18:03] <strcat> eddyb: most gtk3/qt5 applications work natively in wayland already anyway
[10:18:42] <eddyb> I should check what state kf5 is in, maybe I can start replacing the kde4 apps I use with kf5 ones :D
[10:18:52] <strcat> eddyb: it uses glib/atk/pango/cairo so it's glib without gobject
[10:19:14] <jensnockert> Hurray, it starts \o/
[10:19:14] <bjz> eddyb: https://github.com/bjz/num-rs/blob/master/src/math/algebra.rs#L379-L381
[10:19:15] <strcat> well I hope it is at least
[10:19:31] <jensnockert> Doesn't do anything but hang, but still!
[10:19:46] <strcat> eddyb: vala makes heavy use of gobject though
[10:19:48] <strcat> it's awful
[10:20:07] <strcat> lets layer static typing on top of weak dynamic typing with enormous overhead! :(
[10:20:19] <eddyb> no kidding
[10:20:24] <eddyb> and it's not safe at all
[10:20:39] <jensnockert> Urgh, I feel hungover today, and I haven't had alcohol all weekâ€¦
[10:20:44] <eddyb> and valabind is abusing strings
[10:20:49] <eddyb> bjz: pub trait CommutativeRing: Ring + CommutativeMul <3
[10:20:49] * strcat shrugs
[10:20:56] <bjz> eddyb: complex numbers form a commutative ring, so you can definitely multiply them
[10:21:03] <jensnockert> I don't mind slow, I just want a cross-platform way to do game UIs.
[10:21:25] <eddyb> bjz: I was talking about Complex<Complex<Integer | Float>>
[10:21:26] <strcat> bjz: make sure to define abs as sqrt(pow(x, 2))
[10:21:37] <jensnockert> As long as I can hit 30 fps on a beefy rig doing mostly static 2d graphics I'm fine \o/
[10:21:37] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[10:21:37] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/cdJ9xw
[10:21:37] * strcat runs
[10:21:37] <ghrust> 13rust/06auto 14677602b 15Geoffroy Couprie: Implement Unix domain sockets in libnative
[10:21:37] <ghrust> 13rust/06auto 141ff6035 15Alex Crichton: Move unix pipes implementation to pipe_unix.rs...
[10:21:37] <ghrust> 13rust/06auto 142daed13 15Alex Crichton: Implement named pipes for windows, touch up unix...
[10:21:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[10:21:39] <jensnockert> Hurray for progress.
[10:22:01] *** Quits: brson (brson@59C3BD5D.9810012B.7A1399C0.IP) (Quit: leaving)
[10:22:01] <eddyb> strcat: not sure if you're serious... but that seems risky with limited precision
[10:22:14] <bjz> eddyb: Well, integers and real numbers are subsets of the set of complex numbers
[10:22:57] <eddyb> bjz: maybe you're dismissing the crazy thing I'm actually trying to say
[10:23:09] <bjz> eddyb: if you can multiply two complex numbers together, you can also multiply a complex number with any subset of the reals
[10:23:13] <eddyb> not Complex<f64> but Complex<Complex<f64>>
[10:23:23] <bjz> eddyb: ohhh
[10:23:43] <bjz> eddyb: I see, sorry
[10:23:46] <bjz> hmm
[10:24:19] <eddyb> I only missed about half an year of highschool maths :P
[10:24:38] <bjz> eddyb: "A complex number is a number that can be expressed in the form a + bi, where a and b are real numbers and i is the imaginary unit"
[10:25:14] <eddyb> https://github.com/bjz/num-rs I would much like this to be libnum
[10:25:37] <bjz> eddyb: so it has to be <T:RealThing> Complex<T>
[10:25:39] <eddyb> bjz: ohh, I know, I've seen what I'm talking about before
[10:26:02] <eddyb> what you've just quoted reminded me of j
[10:26:02] <bjz> https://en.wikipedia.org/wiki/Complex_number
[10:26:30] <eddyb> let's see if I remember (I hope I don't need to grep Three.js' source for the name)
[10:26:46] <bjz> eddyb: r? https://github.com/mozilla/rust/pull/12313
[10:27:06] <bjz> eddyb: I know it is still ugly, but it is certainly an improvement
[10:27:07] <eddyb> I don't have dem powerz
[10:28:01] <eddyb> I don't really like Pair :/
[10:28:28] <bjz> remove it?
[10:29:21] <eddyb> IMO we should have vN (value), rN (immutable ref) and maybe mN (mutable ref) methods on all tuples
[10:30:00] <eddyb> the swap method doesn't seem to be used anywhere, and can easily be done with pattern matching
[10:30:09] <bjz> val0, ref0, mut0?
[10:30:15] <eddyb> or that
[10:30:30] <bjz> I think that is clearer
[10:30:59] <eddyb> Pair seems to play favorites with (T, U), which we already use in a lot of places, with pattern matching
[10:31:15] <bjz> yep
[10:31:21] <bjz> ok, will do
[10:32:20] <eddyb> CloneableTuple<T, U> for (T, U) wait, we actually had a trait only for pairs?
[10:32:45] <eddyb> such a bad name
[10:33:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[10:34:00] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[10:34:05] <bjz> Yep
[10:34:44] <doener> hrm, we avoid using invoke when there are no cleanups to be executed, but also mark function with uwtable, which llvm treats as a signal not to replace invoke instrs with empty landing pads by call instrs
[10:34:59] <eddyb> doener: fixit!
[10:35:11] <doener> i.e. part of what we tell llvm not to do is what we do
[10:35:46] <doener> eddyb: my problem is that I don't know if there's actually anything wrong. Or why things are the way they are in the first place
[10:36:20] <doener> tried reading the x86_64 ABI that is mentioned in the uwtable docs, didn't help
[10:36:56] <doener> hm, let's see what C++ does for similar code...
[10:36:58] <eddyb> bjz: .swap() is only used in a test, first/second seem to be used in a few other places, including a benchmark and libnative
[10:37:09] <bjz> eddyb: indeed
[10:38:21] <eddyb> .ref0() and .ref1() look fine to me. we have pattern matching for nicer access to contents
[10:39:09] <eddyb> alternatively, find a way to generate "first, second, third, fourth, fifth, sixth, seventh" etc. names for all the valN we'd support
[10:39:37] <kimundi> better not ;)
[10:41:00] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[10:41:20] <eddyb> twelvehundredandsixtyfourth
[10:41:45] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[10:41:50] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[10:42:31] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:42:42] *** Joins: girl_16f (~Seviyorum@661CB986.4BC07F13.2A077A.IP)
[10:43:04] <girl_16f> http://www.palandokenrentacar.com/
[10:43:05] <girl_16f> http://www.palandokenrentacar.com/
[10:44:45] <doener> clang++ does the same thing, so I guess it's fine
[10:45:01] <girl_16f> http://www.palandokenrentacar.com/
[10:45:05] *** Quits: girl_16f (~Seviyorum@661CB986.4BC07F13.2A077A.IP) (Quit: )
[10:45:28] <eddyb> doener: as in, we're doing it wrong?
[10:45:54] <doener> eddyb: no, as in we're doing the same thing as clang++
[10:46:25] <eddyb> doener: does anything break if you remove uwtable?
[10:47:17] <doener> ABI-compliance, I guess 
[10:47:37] <eddyb> does LLVM have docs on it?
[10:48:41] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[10:48:48] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[10:49:40] <doener> eddyb: http://llvm.org/docs/LangRef.html#function-attributes -- at the end of that section
[10:50:31] <jensnockert> Amaze! So much white! A Rust clutter application that only almost crashes on startup!
[10:51:27] <eddyb> doener: does that prevent noop-landing-pad invoke -> call?
[10:51:46] <jensnockert> Oh, wait, I'm on the wrong thread!
[10:51:52] <jensnockert> To the right-thread-mobile!
[10:52:01] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[10:52:09] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[10:52:14] <eddyb> jensnockert: oh, I thought your nick had "sprocket" in it, just noticed it doesn't
[10:52:35] <jensnockert> eddyb: Sorry, no. :(
[10:52:58] <eddyb> doener: wouldn't that just output some extra information? why would it need to block optimizations?
[10:54:15] <doener> eddyb: http://llvm.org/docs/doxygen/html/SimplifyCFG_8cpp_source.html#l02841
[10:54:32] <jensnockert> Now it works \o/
[10:54:37] <jensnockert> Except that the colors are wrong.
[10:56:44] <eddyb> jensnockert: I hope it's not BGR
[10:56:46] <jensnockert> Oh, now it works.
[10:56:59] <jensnockert> eddyb: Nah, I just accidentally passed a struct instead of a pointer to a struct.
[10:57:10] <jensnockert> typedefs and all that jazz.
[10:58:25] <eddyb> doener: hmm, does this noop invoke result in worse code?
[10:58:26] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[10:58:51] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[10:58:55] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:59:06] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[10:59:21] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[10:59:41] *** Quits: mawuli (mawuli@moz-5ADAB167.com.gh) (Ping timeout)
[11:00:18] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[11:00:49] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:01:16] <eddyb> bjz: https://en.wikipedia.org/wiki/Quarternion
[11:01:29] <eddyb> that's where I remembered j from
[11:01:52] <bjz> yep
[11:02:45] <eddyb> does Complex<Complex<Num>> act like a Quarternion?
[11:03:05] <jensnockert> Now I'll just have to refactor a bit, and then publish a test application and claim I did something before it was cool.
[11:03:42] <bjz> eddyb: no
[11:03:56] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:04:07] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:04:08] <eddyb> bjz: only for addition and subtraction?
[11:04:13] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:04:21] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:04:53] <eddyb> bjz: https://en.wikipedia.org/wiki/Quarternion#Quaternions_as_pairs_of_complex_numbers
[11:04:54] *** Joins: mawuli (mawuli@moz-5ADAB167.com.gh)
[11:05:28] <bjz> hmm, I could be wrong
[11:05:44] <bjz> eddyb: I *think* complex numbers are a subset of the quaternions, where the coefficients of j and k are 0
[11:05:51] <bjz> but I could be wrong
[11:05:53] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:06:13] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[11:06:14] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:06:34] <bjz> or maybe 1
[11:06:55] *** Joins: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP)
[11:07:27] <bjz> http://www.proofwiki.org/wiki/Complex_Numbers_form_Subfield_of_Quaternions
[11:07:41] <bjz> But that does not mean Complex<Complex<Num>>
[11:08:04] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:08:10] <bjz> Just that Complex<Num> is also a quaternion
[11:08:21] <bjz> like Int is also a Real
[11:08:22] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:09:30] <eddyb> bjz: would the formula we use for multiplying two Complex<T> values not give the same result for Complex<Complex<T>> as for Quaternion<T>?
[11:09:51] <eddyb> because I'm pretty sure addition/subtraction would work fine
[11:09:56] <bjz> I dunno
[11:09:58] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[11:10:05] <bjz> haven't thought too much about it
[11:10:14] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:10:16] <eddyb> (and, of course, the next question would be "does Complex<Complex<Complex<T>>> mean anything?" :P)
[11:10:28] <eddyb> abstractions are fun!
[11:11:22] <bjz> Oh, I think what https://en.wikipedia.org/wiki/Cayley%E2%80%93Dickson_construction means is (Complex<T>, Complex<T>)
[11:11:39] <bjz> not Complex<Complex<T>>
[11:12:06] <bjz> oh wait
[11:12:10] <bjz> that is the same
[11:12:14] <eddyb> :D:D
[11:12:35] <eddyb> "More generally, the Cayleyâ€“Dickson construction takes any algebra with involution to another algebra with involution of twice the dimension"
[11:12:51] <bjz> but still, Complex<Complex<Num>> is not in the set of complex numbers
[11:13:00] <eddyb> I give you Complex<Complex<Complex<Num>>> https://en.wikipedia.org/wiki/Octonion
[11:13:30] <bjz> Complex<T> must have a T that is in the set of reals
[11:14:13] <eddyb> step 1: rename Cmplx<T> to CayDick<T>
[11:14:13] *** Quits: jdm (jdm@E54C2BDC.E901431C.388CF16F.IP) (Connection reset by peer)
[11:14:31] <bjz> I dunno, you'd probably have to ask huon 
[11:14:50] <huon> eddyb: clone is for http://static.rust-lang.org/doc/master/src/num/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libnum/complex.rs.html#55
[11:15:19] <eddyb> step 2: type Complex<T> = CayDick<T>; mod Complex {fn new<T: Num>(a: T, b: T) -> Complex<T> {CayDick::new(a, b)}}
[11:15:30] <bjz> I'm sure that Complex<Complex<Num>> would do interesting things, but it would probably not behave like a complex number, quaternion or octonian
[11:16:00] <eddyb> bjz: the last page you linked means it behaves like a quartenion
[11:16:30] <eddyb> s/means/explicitates/ (is that not a word? :()
[11:16:40] <eddyb> and Complex<Complex<Complex<Num>>> would behave like an octonion
[11:17:00] <huon> eddyb: not quite
[11:17:15] <huon> there's a conjugate that's missing from the normal multiplcation
[11:17:15] <eddyb> huon: but that's just one method, nothing else needs Clone
[11:17:25] <huon> eddyb: yes, that's correct
[11:17:33] <huon> eddyb: feel free to refactor it
[11:18:09] <eddyb> you'd see PRs if I wouldn't have other things to do, I'm just nitpicking
[11:18:19] *** Joins: gimpf (gimpf@moz-5A4B5CA4.adsl.highway.telekom.at)
[11:18:52] <eddyb> "The set of all automorphisms of O forms a group called G2. The group G2 is a simply connected, compact, real Lie group of dimension 14. This group is the smallest of the exceptional Lie groups and is isomorphic to the subgroup of Spin(7) that preserves any chosen particular vector in its 8-dimensional real spinor representation."
[11:19:12] <eddyb> last time I tried to understand these things, it had something to do with physics
[11:20:01] <eddyb> https://en.wikipedia.org/wiki/An_Exceptionally_Simple_Theory_of_Everything
[11:21:41] <doener> eddyb: I have a single test-case where it does, no idea how much that happens in practice. https://gist.github.com/dotdash/4a47beb475e70deaeceb
[11:22:16] <eddyb> looks bad
[11:22:33] <doener> eddyb: (to me) more interesting than the omitted landing pad is the shorter main function body in the generated assembly (because that's what my new call to lifetime.end makes possible ;-))
[11:23:10] <eddyb> I don't like the extra bitcast, I hope it's cheap
[11:23:19] <eddyb> llvm intrinsics should be generic :P
[11:23:20] <doener> I tried adding lifetime.end calls to the landing pad as well, but LLVM won't remove the store
[11:23:45] <eddyb> doener: can you use my rustfilt :)?
[11:24:01] <doener> eddyb: in terms of runtime performance, bitcasts are free
[11:24:18] <eddyb> I mean, IR in memory
[11:24:22] <eddyb> doener: https://gist.github.com/eddyb/3a233c4709018e92b866
[11:24:31] <doener> ok
[11:24:38] <eddyb> or at least c++filt, _ZN is bleah
[11:25:02] <eddyb> what's insertvalue?
[11:25:07] <eddyb> I haven't seen it before
[11:25:29] <doener> think record update
[11:26:04] <doener> updates the value (first operand) by putting the element (second operand) at the specified position (third operand)
[11:26:06] <eddyb> (also, example.rs :P)
[11:26:15] <doener> oops
[11:26:24] <eddyb> so it's a GEPi + store?
[11:27:08] <eddyb> this is what I'm used to seeing https://gist.github.com/dotdash/4a47beb475e70deaeceb#file-uwtable-ll-L4-L6
[11:27:26] <doener> yeah, that should be equivalent
[11:27:34] <eddyb> can insertvalue work with structures in SSA variables?
[11:27:54] <eddyb> that would be useful
[11:29:09] <doener> eddyb: yes, see http://llvm.org/docs/LangRef.html#insertvalue-instruction
[11:29:56] <eddyb> yes!
[11:30:15] <eddyb> I thought working with structures in SSA vars was hard/impossible
[11:30:59] <eddyb> just need to make trans::adt capable of using extract/insert value
[11:31:33] <doener> eddyb: updated the gist after rustfilt'ing
[11:32:22] <eddyb> doener: thanks, much better :D
[11:32:41] <eddyb> what's fca?
[11:33:27] <doener> some name chosen by some optimization pass I guess
[11:33:43] <eddyb> I was wondering which pass that was, actually
[11:34:09] <doener> ah, sorry... Clear sign for more coffee for me
[11:34:27] <huon> eddyb: first class aggregates
[11:34:42] <huon> eddyb: http://llvm.org/docs/Lexicon.html#f
[11:34:48] <eddyb> huon: ahh, I was guessing the "a" was "aggregates"
[11:35:02] <doener> SROA pass
[11:35:50] <huon> answer to "what LLVM passes does *x*?" is always SROA :P
[11:36:20] <eddyb> I think it's the largest pass in all of LLVM
[11:37:55] <huon> and the one that no-one understands
[11:39:12] <eddyb> doener: now that I know this can actually work... I wonder what actually breaks if I move all immutable args and locals (that don't require indirection) to SSA vars
[11:39:32] <eddyb> I guess I have to exclude those with dtors
[11:39:50] <eddyb> (I mean, those that require cleanup)
[11:46:29] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[11:49:14] <eddyb> doener: wait, libstd compiled when I did this previously... so we must have some support for it :/
[11:49:37] <eddyb> it just didn't run because it wasn't canceling cleanups (resulting in multiple frees)
[11:56:08] <bjz> eddyb: https://github.com/mozilla/rust/pull/12313
[11:57:58] <eddyb> https://github.com/mozilla/rust/pull/12313/files#diff-beb1a29909ccf762d822d4c7f2a6c80fR55 hehe
[11:58:46] <eddyb> bjz: why can't the *0 methods be on Tuple1?
[11:59:20] <bjz> Aren't they?
[11:59:25] <eddyb> and implement Tuple1 for all the other tuples as well. I guess it's not actually practical
[11:59:30] <eddyb> bjz: oh, I'm not reading this right then
[11:59:40] <huon> bjz: what are you doing???
[11:59:52] <bjz> eddyb: https://github.com/mozilla/rust/pull/12313/files#diff-beb1a29909ccf762d822d4c7f2a6c80fL207
[11:59:57] <huon> transmuting just to format more nicely??
[12:01:07] <bjz> huon: I tried to use a ($($x:ident),+), but the parser doesn't like `_` for idents :(
[12:01:27] <eddyb> tt, then?
[12:01:44] <bjz> eddyb: doesn't like interpolated tt?
[12:01:54] <eddyb> of course it doesn't
[12:01:57] <huon> bjz: there's a trick
[12:02:18] <huon> bjz: https://github.com/mozilla/rust/blob/master/src/libstd/trie.rs#L144-L150
[12:02:41] <huon> wrap things in a noop macro invocation then interpolated tt is fine
[12:03:15] <bjz> how do you put that in a patt?
[12:03:28] <bjz> I didn't think macro invocations could go in pats?
[12:04:06] <huon> wrap the whole match
[12:04:27] <bjz> woops
[12:04:33] <bjz> sorry, what?
[12:04:45] <huon> expr!(match foo { ($my_tt) => >.. })
[12:05:14] <bjz> ohh
[12:12:17] *** Joins: jdm (jdm@1C8A93DD.93D18199.388CF16F.IP)
[12:15:07] *** Joins: aepsil0n (eduard@moz-15CB80F2.hsi8.kabel-badenwuerttemberg.de)
[12:18:12] *** Quits: jdm (jdm@1C8A93DD.93D18199.388CF16F.IP) (Connection reset by peer)
[12:18:46] *** Joins: jdm (jdm@1C8A93DD.93D18199.388CF16F.IP)
[12:23:33] *** Quits: jdm (jdm@1C8A93DD.93D18199.388CF16F.IP) (Connection reset by peer)
[12:30:37] <bjz> huon: why does `($(x:tt),+) => $ret:expr` not match with `(a) => a`
[12:30:51] <bjz> sayas `error: no rules expected the token `a``
[12:31:06] <bjz> pointing to the first `a`
[12:31:17] <huon> weird
[12:31:39] * bjz is really annoyed at macro annoyingness
[12:31:43] <huon> oh, it's meant to be `$x: tt` without the parens?
[12:32:01] <bjz> ohhhh
[12:32:10] <bjz> ($($x:tt),+) => $ret:expr
[12:33:01] <bjz> missing a $
[12:33:28] <huon> oh, of course
[12:33:48] <bjz>  /Users/brendan/dev/rust/rust/src/libstd/tuple.rs:44:35: 44:44 error: attempted to repeat an expression containing no syntax variables matched as repeating at this depth
[12:33:49] <bjz>  /Users/brendan/dev/rust/rust/src/libstd/tuple.rs:44                             let ($(x:tt),+) = self;
[12:33:51] <bjz> :(
[12:34:02] <bjz> ohh
[12:34:05] <bjz> again
[12:39:36] <eddyb> bjz: shouldn't that be $($x),+?
[12:39:44] <bjz> yep
[12:39:55] <bjz> I know, I fixed it already
[12:54:20] *** Quits: mawuli (mawuli@moz-5ADAB167.com.gh) (Ping timeout)
[13:12:46] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[13:13:08] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[13:14:50] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[13:32:08] <aepsil0n> is there any plan for when 1.0 is supposed to be released? or just "when it's done"?
[13:35:25] <zxcdw> Hopefully before end of the year
[13:35:30] <zxcdw> no?
[13:37:59] <bjz> huon: still there?
[13:38:04] * huon wabes
[13:38:07] <huon> *waves
[13:38:22] * bjz wabes back
[13:38:32] <bjz> almost finished
[13:38:38] <bjz> just running tests
[13:40:13] <huon> awesome!
[13:46:01] <bjz> huon: done!
[13:47:36] <huon> bjz: looking
[13:47:43] <huon> (yay for cleanup \o/)
[13:48:48] <bjz> \o/
[13:51:13] <huon> bjz: very fancy implementation :)
[13:51:19] <bjz> heh
[13:51:31] <bjz> need to specialise for (a,) -_-#
[13:51:41] <bjz> makes things tricky
[13:52:12] <huon> rusti: let (a, b,) = (1, 2); (a, b)
[13:52:13] -rusti- (1, 2)
[13:52:26] <huon> bjz: you can just use a trailing comma everywhere
[13:52:31] <bjz> :o
[13:52:39] <huon> (e.g. turn $(...),+ into $(... , )+)
[13:53:14] <bjz> you can't do that?
[13:53:26] <bjz> macros always hate you
[13:53:53] <bjz> ohh
[13:53:54] <bjz> wait
[13:54:02] <bjz> in the expansion
[13:54:23] <bjz> just a sec
[13:58:50] <bjz> huon: https://github.com/mozilla/rust/pull/12313
[14:06:56] <bjz> huon: I tried that but I was getting an expansion depth error
[14:07:04] *** Joins: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP)
[14:07:10] <huon> bjz: ah, of course :'(
[14:07:12] * bjz just wants to go to bed
[14:07:14] <bjz> :D
[14:07:47] <huon> bjz: feel free, I'm too tired to give an r+ :)
[14:07:53] <bjz> :)
[14:08:13] <bjz> probably wise
[14:09:07] <huon> bjz: although you should update the PR description to match the new content (if you haven't already)
[14:09:24] <bjz> I have
[14:10:11] <bjz> huon: could you look in the morning?
[14:11:13] <huon> bjz: actually, I'll r+ now
[14:11:25] <huon> seems fine to me
[14:11:46] <bjz> ty for pushing me to improve it btw
[14:11:54] <bjz> much better than when I started
[14:12:04] <huon> ty for improving <3
[14:12:25] <huon> (both relative to the master branch and your previous iteration)
[14:12:29] <bjz> although hopefully it will be obliterated in the future :)
[14:13:08] <bjz> by a single trait that's generic over N tuples
[14:13:27] <bjz> dunno if that is possible, but it would be awesome
[14:18:35] <eddyb> you'd still need 12 traits
[14:18:47] <eddyb> but each one would have only one method and one impl
[14:27:27] <bjz> ah, oh well, that is a little nicer at least
[14:35:54] <SimonSapin> What makes `a = b` valid? Ie. what types are implicitly copyable?
[14:36:56] <eddyb> types that don't require cleanup
[14:37:07] <SimonSapin> so, anything without a destructor?
[14:37:16] <eddyb> yes
[14:37:28] <SimonSapin> is this the same as the Pod kind?
[14:37:43] <eddyb> that's what the Pod kind is for
[14:37:49] <SimonSapin> cool, thanks
[14:37:52] *** Joins: new_one (new_one@135E988A.AD901773.B3C0173E.IP)
[14:38:15] <eddyb> <T> T is assumed to move, not copy. <T: Pod> lets you copy it around, if you're working with generics
[14:38:30] <eddyb> Cell<T> for example, is only implemented for T: Pod
[14:43:57] *** Joins: jdm (jdm@moz-DB4A9C19.scl3.mozilla.com)
[14:45:16] <bjz> hmm, any idea why bors isn't picking up #12313? https://github.com/mozilla/rust/pull/12313 http://buildbot.rust-lang.org/bors/bors.html
[14:47:02] <edwardw> http://buildbot.rust-lang.org/console it seems that #12103 failed
[14:47:31] <edwardw> ignore me, that's not what bjz asked
[14:49:37] *** Joins: vasac (vasac@moz-EF63EF95.targo.rs)
[14:52:39] <edwardw> is bors still kicking and running? http://buildbot.rust-lang.org/console the last build is about half hour ago
[14:54:38] *** Parts: vasac (vasac@moz-EF63EF95.targo.rs) (Leaving)
[14:54:47] <tedh> is github showing the commits out of order?
[14:55:24] <bjz> edwardw: hm, I tried an r=huonw https://github.com/mozilla/rust/pull/12313
[14:55:44] <bjz> edwardw: doesn't seem to be finding it
[14:55:58] <edwardw> bjz: no, not dead again
[14:56:10] <bjz> ?
[14:56:55] <edwardw> bjz: does it pick up it now?
[14:57:09] <bjz> nope
[14:58:44] <edwardw> bjz: there was a rollup two (?) days ago duo to bors hiccup
[14:58:55] <edwardw> certainly don't want another one :)
[14:59:14] *** Joins: vasac (vasac@moz-EF63EF95.targo.rs)
[15:04:24] <bjz> acrichto: might have a bors issue here :(
[15:08:12] <tedh> the r+ should be on "Remove CloneableTuple and ImmutableTuple traits"
[15:09:02] <bjz> why?
[15:09:19] <tedh> it has to be on the last commit in the pull
[15:09:37] <bjz> oh, you are right about them being out of order
[15:09:39] <tedh> unfortunately gh shows them out of order in the pr view
[15:10:06] <bjz> mmyep
[15:11:35] <doener> eddyb: ok, some hours later, I've concluded for myself that the invoke/uwtable thing in llvm is wrong
[15:11:38] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[15:11:38] <ghrust> [13rust] 15bors 04force-pushed 06auto from 146de13f1 to 146fe775e: 02http://git.io/N3iJvQ
[15:11:38] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[15:11:40] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[15:11:40] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/RcRSeg
[15:11:40] <ghrust> 13rust/06auto 14bf6abf8 15Brendan Zabarauskas: Implement Show for 1-12 element tuples
[15:11:40] <ghrust> 13rust/06auto 146f39eb1 15Brendan Zabarauskas: Delegate ToStr implementation to Show for tuples
[15:11:40] <ghrust> 13rust/06auto 142cd7a29 15Brendan Zabarauskas: Merge ImmutableTuple* traits into their respective Tuple* trait
[15:11:42] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[15:11:49] <eddyb> doener: more LLVM fixes?
[15:13:07] <doener> eddyb: at least I'll prepare a patch. I'm not super sure that I perfectly understood the whole EH, but I'll at least try to get a patch and send that out
[15:13:37] *** Quits: vasac (vasac@moz-EF63EF95.targo.rs) (Quit: Leaving)
[15:13:46] <bjz> tedh: thanks!
[15:14:22] <eddyb> doener: do you have a clang testcase to attach to the patch?
[15:15:06] <doener> eddyb: not yet at testcase level of conciseness
[15:16:09] <doener> eddyb: shouldn't be hard to create though
[15:17:12] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:18:44] <doener> haha, just tricked myself because I only used my patched "opt", and forgot to also use the patched "llc"
[15:24:28] <doener> eddyb: oh, just re-read your question. I was thinking about a opt/llc testcase. Do you think I should have one for clang as well?
[15:25:00] <eddyb> doener: I meant, C++ code that produces noop landing pads
[15:25:34] <doener> class T { T::~T() {} }
[15:25:48] <eddyb> hmm, this might have an interesting impact
[15:26:39] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:26:45] <doener> create a function that has a T and calls something that might throw and you get an empty lp
[15:26:59] <eddyb> doener: before/after on the IR produced by that, ran through opt (I don't expect you to compile a new clang for this) would be nice to have
[15:33:14] *** Quits: Kxepal (Miranda@moz-C53A0561.pppoe.mtu-net.ru) (Ping timeout)
[15:37:24] *** Joins: Kxepal (Miranda@moz-C4CEC9D8.pppoe.mtu-net.ru)
[15:45:31] *** Joins: doomlord_ (servitor@moz-9B2006BF.range109-151.btcentralplus.com)
[15:46:25] *** Joins: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca)
[15:47:43] *** Quits: Kxepal (Miranda@moz-C4CEC9D8.pppoe.mtu-net.ru) (Quit: Kxepal)
[15:48:09] *** Joins: Kxepal (Miranda@moz-C4CEC9D8.pppoe.mtu-net.ru)
[15:48:39] <doener> eddyb: https://gist.github.com/dotdash/39dc06b35d532dd7eb6a
[15:49:09] <eddyb> doener: all the comments are from clang?
[15:49:14] *** Quits: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com) (Connection reset by peer)
[15:49:37] <doener> eddyb: hand-written .ll file
[15:49:45] <doener> comments are from opt/llc
[15:49:48] <eddyb> ahh
[15:50:04] <eddyb> there's too much noise in the resulting .s file :(
[15:50:13] <doener> added a diff to the gist
[15:50:17] <eddyb> ohh
[15:50:45] <eddyb> yeah, that's better :)
[15:51:00] <doener> the three big changes at the end are about empty landing pad, where there is no EH table at all
[15:51:34] <doener> the one around line 160 is an actual bug being fixed AFAICT
[15:52:43] <doener> in new.s there is an EH table entry for @both, which is marked uwtable, while in old.s there is none
[15:53:13] <eddyb> so what does actually need uwtable?
[15:53:43] <eddyb> oh, I read that wrong, so you made uwtable do what it's supposed to?
[15:54:09] <doener> Just uwtable was fine, but uwtable+nouwind was/is broken
[15:54:22] <eddyb> I see
[15:54:30] <doener> it didn't emit the EH table entry for that case
[15:59:07] <eddyb> doener: your fix makes sense, I would expect uwtable to conflict with nounwind if the previous behavior was intended
[15:59:33] <doener> eddyb: the expected behaviour is even documented ;-)
[16:00:04] <doener> eddyb: http://llvm.org/docs/doxygen/html/Attributes_8h_source.html#l00049
[16:00:16] <edwardw> for a compile-fail test, can I specify what the error message should be?
[16:01:44] <eddyb> edwardw: you have to
[16:02:15] <edwardw> eddyb: is that those //^ comments are for?
[16:02:19] <doener> yay, all existing llvm tests pass with my patch
[16:02:34] <eddyb> edwardw: // ~ERROR I think
[16:03:05] <edwardw> eddyb: got it
[16:05:30] *** Quits: japaric (japaric@8465B6C3.31BF4ADA.BFC118EE.IP) (Quit: WeeChat 0.4.2)
[16:06:51] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:08:48] *** Joins: japaric (japaric@8465B6C3.31BF4ADA.BFC118EE.IP)
[16:10:54] *** Joins: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com)
[16:13:04] *** Joins: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP)
[16:14:22] *** Quits: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com) (Connection reset by peer)
[16:14:29] *** Joins: jensnock_ (jensnocker@moz-B6129BAF.mobileonline.telia.com)
[16:15:04] <bstrie> eddyb: I'll feed whatever complex you want, just keep submitting awesome patches :P
[16:17:09] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[16:21:44] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[16:21:44] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/RcRSeg
[16:21:44] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[16:22:47] *** Parts: aepsil0n (eduard@moz-15CB80F2.hsi8.kabel-badenwuerttemberg.de) ()
[16:26:26] <eddyb> bstrie: far more productive would be to speed up my recovery
[16:27:08] <eddyb> can't really focus on anything, at least it seems to be wearing off
[16:28:15] <eibwen> I find it totally counter-intuitive that read() gives an error if it can only read 0 bytes, but doesn't when it can read 1 byte
[16:28:55] <eibwen> wouldn't two functions, read_exactly() which gives an error on short input and read_upto() which doesn't give an error on EOF be better?
[16:29:37] <eibwen> would a pull-request on something that fundamental be accepted?
[16:29:45] <eddyb> you should be able to implement read_exactly yourself
[16:30:20] <eibwen> yes.
[16:30:43] <eddyb> I would rather have it as an auxiliary method on all Reader's and on &mut Reader than a method in Reader itself
[16:31:08] <eddyb> (I don't think we want more vtable churn in those two traits)
[16:31:13] <eibwen> auxiliary method = method that is implemented in the trait?
[16:31:16] <eibwen> ok
[16:31:19] <eddyb> eibwen: the opposite
[16:31:40] <eddyb> unless you're referring to a default method, which would be unrelated
[16:31:54] <eibwen> a default method (I guess?)
[16:32:21] <eibwen> a method that is implemented within the trait, so classes implementing the trait can override it but don't have to
[16:32:38] <eddyb> s/classes/types/
[16:33:10] <eddyb> trait ReadExactly {fn read_exactly(self, ...) -> ... {...}} impl<R: Reader> ReadExactly for &mut R {...} impl ReadExactly for &mut Reader {...}
[16:34:29] <eddyb> it should work like a default method, but it's not part of the vtable (my point) and it can't be overriden (would you want to override it when its behavior is stricly defined?)
[16:35:15] <eibwen> ok, then a different question
[16:35:40] <eibwen> why are all those read_le_*, read_be_* defined in the trait rather than as default method?
[16:45:43] *** Quits: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP) (Ping timeout)
[16:45:44] *** Quits: new_one (new_one@135E988A.AD901773.B3C0173E.IP) (Quit: leaving)
[16:45:53] *** Quits: jensnock_ (jensnocker@moz-B6129BAF.mobileonline.telia.com) (Input/output error)
[16:46:24] *** Joins: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com)
[16:46:35] *** Quits: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com) (Connection reset by peer)
[16:49:51] *** Quits: dbussink (dbussink@moz-E0A5568C.bussink.me) (Ping timeout)
[16:50:23] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[16:51:59] <doener> eddyb: https://gist.github.com/dotdash/b8c626ab27b96bbcc177 -- does that make sense to you?
[16:53:11] <doener> the real change in on line 60, the rest is basically just renaming 
[16:53:47] *** Joins: dbussink (dbussink@moz-E0A5568C.bussink.me)
[16:54:27] <eddyb> (in theory a certain Reader could have an optimized read_exactly, but I'd rather see an example before agreeing to that)
[16:54:31] <eddyb> ^^ I forgot to send that message
[16:58:56] *** Quits: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP) (Ping timeout)
[17:00:24] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[17:02:33] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[17:03:34] *** Quits: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP) (Ping timeout)
[17:04:00] *** Joins: jxs (joaoxsouls@1FF12F4F.CDF09DE2.D6573861.IP)
[17:23:58] *** lpy is now known as lpy|afk
[17:28:57] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Client exited)
[17:33:49] *** Joins: mawuli (mawuli@moz-5ADAB167.com.gh)
[17:47:23] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[17:59:40] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[18:01:42] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[18:04:55] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[18:06:44] <doener> crap, the invoke->call replacement doesn't trigger another round in the CGSCC pass manager and the dse possibility is not exploited :-/
[18:07:37] <erickt> acrichto: I refactored my PR to not do #[cfg(stage0)] everywhere. I'll save transitioning to the new Hash framework for a future PR: https://github.com/mozilla/rust/pull/11863
[18:13:47] <bjz> Are folks ok about me moving Integer to libnum?
[18:14:05] <bjz> the methods seem a little superfluous for the std
[18:14:42] <eddyb> doener: lol
[18:16:16] <doener> eddyb: llvm just comes up with more and more ways to stop my lifetime stuff from being effective *sigh*
[18:19:55] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[18:34:07] <doener> eddyb: haha, had a look at your LinkedIn page, and now LinkedIn is in Romanian for me, without an obvious way to change it back to some language that I can read
[18:34:25] <eddyb> ouch and sorry
[18:34:41] <doener> nothing to be sorry about
[18:34:43] <eddyb> not sure how you even reached my (unused) LinkedIn profile
[18:35:00] <doener> Google results
[18:35:45] <doener> ok, killing the "lang" cookie helped
[18:35:53] <eddyb> good :)
[18:37:24] <eddyb> any particular reason you were googling me?
[18:37:44] <eddyb> something to do while LLVM is compiling :P?
[18:38:41] <doener> eddyb: it's actually weeks since I did that, when I first had a look at your GitHub page. My LinkedIn account is about as active as yours, so I didn't notice it any earlier
[18:38:56] <eddyb> ahh
[18:49:23] *** Quits: mawuli (mawuli@moz-5ADAB167.com.gh) (Ping timeout)
[19:00:33] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[19:02:28] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[19:03:11] *** Joins: mawuli (mawuli@moz-5ADAB167.com.gh)
[19:09:11] *** Joins: new_one (new_one@ECBE600.32E41C6F.B3C0173E.IP)
[19:16:10] <doener> eddyb: http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20140210/205131.html and http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20140210/205132.html
[19:17:07] *** Quits: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca) (Quit: canhtak)
[19:19:28] <eddyb> doener: so what's the result
[19:23:26] <doener> eddyb: basically what I've shown you earlier. Invokes with empty cleanups replaced by calls. I'll try to get some numbers as to how that affects the code from rustc
[19:28:09] <eddyb> ahh, okay. the first paragraph of the second email is confusing at first
[19:29:09] <doener> yeah, I'm not exactly happy with it either, but already rewrote it two times and then just hit "Send"
[19:30:53] <eddyb> I tend to forget to send at that point, and find it days later :P
[19:31:27] <doener> I really wanted to get that out. It's sunday evening, so the next five days I'll get next to nothing done WRT rust/llvm
[19:31:48] *** Joins: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca)
[19:34:55] <edwardw> I want to debug the ast tree after expansion. Is there a way to print that tree?
[19:36:00] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[19:36:07] <eddyb> --pretty=expanded
[19:36:21] <edwardw> thanks
[19:36:30] <eddyb> I hope you just need the expanded source
[19:36:42] <edwardw> I think so
[19:36:45] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[19:36:45] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/QSI4Iw
[19:36:45] <ghrust> 13rust/06auto 1458a2b7d 15Brian Anderson: doc: Reorganize the library index...
[19:36:45] <ghrust> 13rust/06auto 1413dc521 15bors: auto merge of #12312 : brson/rust/doc, r=alexcrichton...
[19:36:45] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[19:41:14] *** Quits: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca) (Quit: canhtak)
[19:42:00] <edwardw> It works but the identities are still printed as strings which makes identity renaming invisible
[19:42:41] <edwardw> which keeps the string name and only gives them a new id number
[19:43:00] <doener> eddyb: maybe with "identified" instead of "expanded"
[19:43:18] <edwardw> let me try
[19:43:31] <eddyb> edwardw: it's not a new "id"
[19:43:59] <eddyb> identified assigns node IDs, which are unrelated to Idents having distinct syntax contexts
[19:44:13] <doener> eddyb: librustc compiled with and without the llvm patch: https://gist.github.com/dotdash/5528b956f6a26efe2a81
[19:44:38] <edwardw> eddyb: I'm confused. token::fresh_name gives out a new name
[19:45:12] <eddyb> edwardw: token is also unrelated to hygiene
[19:46:02] <edwardw> eddyb: but that's how renaming let gets done. expand::expand_non_macro_stmt
[19:46:02] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[19:46:15] <Eridius> ugh, I think the makefiles have a problem
[19:46:23] * Eridius is using huon's is_utf8_iter branch
[19:46:36] <Eridius> `git checkout HEAD^; git make check-stage1-std` told me nothing had changed
[19:46:44] *** Joins: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca)
[19:46:44] <eddyb> token can do one of two things: give you a Name that has the same string, but different identity, or give you a random name that has both a different string and a different identity
[19:46:51] <Eridius> `make clean; make check-stage1-std` just errored out because no such file libuv.a
[19:47:01] <eddyb> edwardw: last I checked it was all about the SyntaxContext
[19:47:32] <edwardw> eddyb: okay, I'll dig a little deeper then
[19:48:19] *** Joins: jensnockert (jensnocker@moz-B6129BAF.mobileonline.telia.com)
[19:48:26] <rcxdude> is there a way to ignore a specific maketest with 'make check'?
[19:48:40] <Diamond> make check -k
[19:49:01] <Diamond> won't ignore it, but will keep going if it fails
[19:49:06] <rcxdude> ah, thanks
[19:50:12] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[19:50:50] <sfackler> rcxdude: try running "make" before "make check". i've run into issues where dependencies are out of date and break the linker
[19:53:25] <rcxdude> sfackler: I have been doing that.
[19:55:02] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[19:57:10] <eddyb> edwardw: now I'm confused as to what's going on
[19:57:34] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[19:57:36] <edwardw> eddyb: what?
[19:58:25] <edwardw> eddyb: what confused you?
[19:59:41] <eddyb> ohh, gensym will not reuse the RcStr, that's a bit sad
[20:00:57] <eddyb> edwardw: the hygiene
[20:01:10] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[20:03:11] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[20:03:58] <eddyb> edwardw: take a look at IdentRenamer::fold_ident
[20:04:11] <eddyb> it calls ast_util::new_rename
[20:04:12] <edwardw> eddyb: yep, I used that already
[20:04:31] <eddyb> and that deals with the SyntaxContext nonsense
[20:05:10] <edwardw> fresh_name generates a new name -> pair that with the old one -> fold_ident to generate new Ident
[20:05:41] <eddyb> edwardw: except Name isn't replaced
[20:05:44] <eddyb> *the Name
[20:06:16] <edwardw> eddyb: the SyntaxContext is extended
[20:07:58] <edwardw> I then used that new Ident to replace the old break/continue label and also walked the loop block to replace all occurrences of the old label  
[20:08:14] <edwardw> I thought it should work but didn't ;)
[20:08:34] <eddyb> you need to duplicate the same insane logic used for let
[20:08:52] <edwardw> I basically used that as a template, so yes
[20:09:01] <eddyb> what's breaking?
[20:09:25] <edwardw> nothing breaking, it simply didn't work hygienically as before
[20:10:37] <edwardw> https://github.com/edwardw/rust/commit/9054b8036e8710f300c2a6769bd01438aa440954 searching for expand.rs
[20:10:53] *** flaper87|afk is now known as flaper87
[20:11:02] <eddyb> what do you mean "as before"?
[20:11:25] <eddyb> did you modify resolve to actually use the renames?
[20:11:34] <edwardw> yes, I did
[20:11:48] <edwardw> mtwt_resolve()
[20:11:53] <eddyb> you might just be unlucky :/
[20:12:09] <edwardw> I think I'm on the right track, but alas
[20:13:39] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[20:14:07] <flaper87> edwardw: You added some renames for ExprForLoop, you'll need to do the same for ExprLoop as well
[20:14:30] <flaper87> edwardw: which tests are failing ?
[20:14:34] <edwardw> flaper87: that's in purpose, so I can see the difference between the two
[20:14:50] <edwardw> flaper87: if it works, then I can add the same logic for ExprLoop
[20:14:56] <edwardw> flaper87: all three
[20:14:58] <eddyb> ExprForLoop is actually replaced with ExprLoop by expand
[20:15:12] <flaper87> edwardw: what eddyb said :)
[20:15:27] <eddyb> experimenting on ExprLoop or ExprWhile is the safest thing
[20:15:41] <edwardw> I know. If the logic works, then I'll apply to the ExprLoop
[20:15:45] <flaper87> edwardw: that match there de-sugars ExprForLoop into ExprLoop
[20:15:52] <eddyb> depending on your insertion point, ExprForLoop might already be gone
[20:16:07] <eddyb> thus making your code never run
[20:16:11] <flaper87> eddyb: he's doing it right in the place where it's de-sugared
[20:16:16] <edwardw> I inserted at the point of expanding ExprForLoop
[20:16:18] <eddyb> flaper87: before or after?
[20:16:33] <eddyb> actually, let me scroll down
[20:16:45] <flaper87> mmh, it looks like before
[20:17:07] <eddyb> I wonder if for loop expansion doesn't break it somehow
[20:17:24] <eddyb> it's pretty hacky
[20:17:31] <edwardw> :D
[20:18:05] <eddyb> hmm, I wonder if the ident folder is a good idea
[20:18:34] <eddyb> that is, let a; 'a: loop {let a; break 'a;}
[20:18:45] <flaper87> eddyb: I think Ident could be reduced to Name (after syntax)
[20:18:58] <flaper87> there's a bug for that, which I was working on when we spot this issue
[20:19:17] <eddyb> flaper87: we can't have a different AST after libsyntax
[20:19:26] <eddyb> anyways, how can it distinguish between the named loops and the locals?
[20:20:41] <eddyb> or is it working by virtue of sheer brute force, like {let a = 0; let a = a; let a = a; let a = a;} would work?
[20:20:46] <edwardw> I didn't think of that. The loop label and the locals with same literal name are the same?
[20:20:48] <flaper87> eddyb: mmh, True that. Perhaps generating some names, dunno.
[20:20:57] <eddyb> I'm just afraid that there is no separation
[20:22:33] <eddyb> well, no, my example is bad
[20:22:52] <eddyb> you would have to use macros to actually get something scary
[20:23:18] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:24:50] <flaper87> eddyb: btw, you profiled rustc, didn't you?
[20:24:57] <eddyb> flaper87: cmr has the data
[20:25:04] <flaper87> eddyb: oh, I downloaded it :D
[20:25:10] <flaper87> I had forgotten about that
[20:25:17] <cmr> sup
[20:25:22] <eddyb> great, the SCTable comment cuts off "applying a mark to a tree containing 50 identifiers would otherwise generate"
[20:25:29] <flaper87> cmr: oh just saying bad things about you... don't worry
[20:25:30] <flaper87> :D
[20:27:39] <flaper87> you know what I hate about adding new rules to the language? Finding out the places were those rules have already been broken.
[20:27:46] <cmr> heh
[20:31:27] * eddyb hates hygiene more with every unidiomatic old and crusty line of code
[20:31:42] <eddyb> I mean, don't get me wrong, I find the theoretical concept great
[20:31:59] <eddyb> our implementation? no thanks
[20:32:53] <eddyb> and it claims to be an optimization over previous attempts? I dread to consider such times existed
[20:37:47] *** Quits: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP) (Quit: Leaving...)
[20:46:45] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[20:46:45] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/QSI4Iw
[20:46:45] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[20:48:50] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: Leaving)
[20:48:55] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:50:41] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[20:51:43] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[20:51:43] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/n8Numg
[20:51:43] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[20:51:45] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[20:51:45] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/zJZpSg
[20:51:45] <ghrust> 13rust/06auto 143a66548 15Simon Sapin: Ignore /build even if itâ€™s a symlink.
[20:51:45] <ghrust> 13rust/06auto 14425f574 15bors: auto merge of #12319 : SimonSapin/rust/build-symlink, r=alexcrichton
[20:51:45] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[20:52:08] <nrc> what is the preferred way to test something which requires C code? compile the C code add it to tthe test suite as run-pass? Or compile-error on the link failure (I don't actually care about the C code, I just want to be sure I get a link error, not a type error)?
[20:54:21] <cmr> nrc: the tests that do that sort of thing go in src/test/run-make
[20:54:30] <acrichto> nrc: you can modify rust_test_helpers.c inside of src/rt and then link against librustrt, or you could add it to run-make
[20:54:37] <acrichto> if you want to test for specific errors, don't use run-make
[20:54:44] <acrichto> if you want to test that it just succeeds, run-make is the best place for it
[20:55:22] <cmr> ah *passing* tests go in rmake
[20:55:30] <nrc> succeeds is what I need, so sounds like run-make is what I want
[20:55:57] <acrichto> yeah
[20:56:02] <acrichto> there's a few examples around in there
[20:56:28] <nrc> sweet. thanks acrichto and cmr!
[21:01:10] *** Quits: new_one (new_one@ECBE600.32E41C6F.B3C0173E.IP) (Client exited)
[21:02:02] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[21:03:57] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[21:06:01] *** Joins: larsberg (larsberg@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[21:08:08] <flaper87> damn, std::os::EXIT_STATUS is a mutable static holding a non-POD T_T
[21:09:07] <acrichto> flaper87: hm, that's unfortunate, it shouldn't become a 'static' though b/c then it'll get thrown in to rodata
[21:09:23] <cmr> it's a static mut?
[21:09:32] <cmr> why would that ever become rodata
[21:09:43] <acrichto> 'static' => rodata
[21:09:46] <acrichto> static mut => data
[21:09:53] <cmr> right
[21:10:16] <acrichto> flaper87: also I thought that the restrictions we wanted was that you didn't have a *destructor*, not that the value as non-pod
[21:10:32] <acrichto> atomics are the reason for that rule, we really do want static mut atomics and mutexes and such
[21:12:03] <flaper87> acrichto: well, according to Niko's comment, which we're using as reference for this change, static mut should be restricted to POD only. I'll re-read it just to make sure I got that right. Anyway, hiting this issue indeed made me think that we might want to allow non-POD w/o destructors
[21:12:19] <flaper87> acrichto: https://github.com/mozilla/rust/issues/10577#issuecomment-34269565
[21:12:34] <acrichto> flaper87: I think niko may have meant "no destructors" b/c we talked about this at a meeting and that's what we agreed on
[21:12:40] <flaper87> acrichto: oh well, you did comment after that
[21:12:53] <flaper87> acrichto: that makes it way easier :D
[21:14:17] *** Joins: brson (brson@E02A6CDD.75598729.B6A3AE99.IP)
[21:14:17] *** ChanServ sets mode: +qo brson brson
[21:15:41] <flaper87> acrichto: ok, just went through the whole meeting log again. I'll stick to what we just said: 'static mut w/o dtor'
[21:15:44] <flaper87> acrichto: thnx
[21:15:49] <acrichto> np
[21:16:51] *** Quits: brson (brson@E02A6CDD.75598729.B6A3AE99.IP) (Quit: leaving)
[21:16:56] *** Joins: brson (brson@E02A6CDD.75598729.B6A3AE99.IP)
[21:16:56] *** ChanServ sets mode: +qo brson brson
[21:17:59] <bjz> acrichto: thanks!
[21:20:59] *** Quits: jdm (jdm@moz-DB4A9C19.scl3.mozilla.com) (Input/output error)
[21:23:39] <bjz> in the documentation tests, how would I do: extern crate num;
[21:23:51] <bjz> ie. within ~~~ fences
[21:24:05] <bjz> it says, "error: "extern crate" declarations are not allowed here"
[21:24:24] <bjz> here is the code:
[21:24:26] <eddyb> you may need a main function
[21:24:31] <bjz>             /// ~~~
[21:24:31] <bjz>             /// # extern crate num;
[21:24:31] <bjz>             /// # use num::Integer;
[21:24:31] <bjz>             /// assert!(( 8i).div_floor(& 3) ==  2);
[21:24:42] <acrichto> # fn main() {
[21:24:42] <acrichto> ...
[21:24:43] <acrichto> # }
[21:24:47] <acrichto> bjz: ^
[21:24:51] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[21:24:59] <acrichto> you also don't need 'extern crate num;'
[21:25:05] <acrichto> that's injected automatically by rustdoc
[21:25:17] <bjz> oh ok
[21:25:21] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:25:21] <acrichto> unless it's a code example not inside libnum
[21:25:25] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[21:26:06] <bjz> acrichto: what do you think about moving Integer into libnum?
[21:26:13] <acrichto> yeah looking at that now
[21:26:15] <acrichto> it seems fine to me
[21:26:21] <bjz> https://github.com/mozilla/rust/pull/12326
[21:26:22] <acrichto> especially b/c I didn't know we had Int and Integer
[21:26:23] <acrichto> seems odd...
[21:26:26] <bjz> fixed it
[21:26:30] <acrichto> I am currently in favor
[21:26:37] <acrichto> could you change ~~~ to ``` ?
[21:26:41] <bjz> it made more sense when we had the other traits
[21:26:44] <acrichto> it appears my comment about that was lost
[21:27:02] <bjz> is that the accepted style?
[21:27:10] <acrichto> it's the predominant style
[21:27:14] <acrichto> and it's unfortunate having two in the codebase
[21:27:16] * bjz thinks ~~~ is pretty
[21:27:35] <bjz> acrichto: if I do a massive find/replace, can I keep it?
[21:27:35] <acrichto> I'm not saying ``` is better, it just seems more prevalent currently
[21:27:39] <bjz> xD
[21:27:45] <acrichto> my answer to that is yes
[21:27:49] <acrichto> but we should agree on it first
[21:27:54] <bjz> I want to also standardise the doc comments
[21:28:09] <acrichto> that would be nice!
[21:28:10] <bjz> to /// and //!, but we need to agree
[21:28:13] <acrichto> hehe
[21:28:15] <acrichto> niko hates //~
[21:28:20] <acrichto>  //! *
[21:28:21] <bjz> /~?
[21:28:25] <bjz> why?
[21:28:29] <acrichto> dunno
[21:28:31] <acrichto> I like it ;P
[21:28:45] * bjz thinks ///, //!, ~~~ look pretty
[21:29:04] <huon> having to prefix every line with /// / //! gets annoying for longer doc comments
[21:29:26] <acrichto> I agree, if my editor didn't insert it automatically it would be terrible
[21:30:23] * huon also hates having to manually indent code examples in doc comments
[21:31:32] <bjz> I like /// because it tends to lead to nicely uniform formatting
[21:32:10] <bjz> with /** you get stuff like: https://github.com/mozilla/rust/blob/master/src/libnum/bigint.rs#L11-L17
[21:32:26] <bjz> and: https://github.com/mozilla/rust/blob/master/src/libnum/bigint.rs#L456-L458
[21:32:38] <cmr> Yeah
[21:32:44] <cmr> I'm really warming up to /// and //!
[21:32:54] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[21:32:55] <bjz> and https://github.com/mozilla/rust/blob/master/src/libglob/lib.rs#L11-L24
[21:33:04] <bjz> it's too free-form
[21:33:40] <eddyb> at least "/// " is 4 characters, so code should indent nicely
[21:33:55] <eddyb> if the first space is ignored by rustdoc, that is
[21:33:55] <bjz> I'm not saying get rid of /* */  - it's good for commenting out code, but I would advocate using that for that only
[21:34:02] <bjz> eddyb: it is
[21:34:17] <bjz> eddyb: and that's another reason why I like it
[21:34:30] <huon> prefixing every line of a /** */ with * is the worst of both worlds :P
[21:34:37] <bjz> :)
[21:34:59] <bjz> three chracters as well :)
[21:35:02] <huon> https://github.com/mozilla/rust/blob/master/src/librustc/middle/borrowck/doc.rs
[21:35:11] *** Quits: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca) (Quit: canhtak)
[21:35:22] <huon> try writing that with /// :P
[21:35:26] *** Joins: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca)
[21:35:29] <bjz> heh, true
[21:35:44] <eddyb> that could just as well be borrowck.md
[21:35:49] <cmr> yeah
[21:36:02] <cmr> or you know
[21:36:04] <cmr> a paper :P
[21:36:09] <huon> but then it's not rendered nicely
[21:36:18] <eddyb> it would have the advantage of being renderable by github instead of that grey comment
[21:36:25] <huon> and having it in source seems very reasonable (since it's version dependent)
[21:36:30] <bjz> we need .lrs (literate rust)
[21:36:34] <bjz> :D
[21:36:38] <huon> http://static.rust-lang.org/doc/master/rustc/middle/borrowck/doc/index.html
[21:37:00] <eddyb> huon: hmm, I thought that wasn't picked up before... cool :D
[21:37:04] <bjz> huon: you do have a point
[21:37:21] <huon> eddyb: yeah, it was fixed
[21:37:25] * bjz doesn't know
[21:37:40] <eddyb> should we remove mentions of &const?
[21:37:40] <huon> in any case, we could have a .md in source and have rustdoc pick them up somehow
[21:38:17] <eddyb> or should we adapt it to maybe &T with T: Freeze?
[21:38:43] <eddyb> huon: #[doc_import("foo.md")];
[21:38:53] <huon> eddyb: but that's not a const borrow?
[21:39:17] <eddyb> well, it's a deeply immutable reference...
[21:39:24] <huon> const borrow doesn't mean that
[21:39:24] <eddyb> I have no idea if the semantics are similar
[21:39:46] <huon> const borrow is like C's const: can't be mutated through that reference, but someone else can mutate it
[21:39:48] <eddyb> "Because moves from a &const or @const lvalue are never legal" pffft really needs update
[21:40:22] <eddyb> "WARNING: We do not currently have const borrows in the language. If they are added back in, we must ensure that they are consistent with all of these examples."
[21:40:36] <eddyb> great, it's even more confusing!
[21:45:46] *** Quits: doomlord_ (servitor@moz-9B2006BF.range109-151.btcentralplus.com) (Quit: Leaving)
[21:51:58] *** Quits: larsberg (larsberg@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Quit: Leaving.)
[21:55:28] <nrc> what do I need to touch to persuade make to re-run run-make tests?
[21:58:45] <cmr> eddyb: moves from &const is never legal.
[22:01:41] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[22:01:41] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/zJZpSg
[22:01:41] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[22:01:47] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:02:40] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[22:04:31] *** Quits: mawuli (mawuli@moz-5ADAB167.com.gh) (Connection reset by peer)
[22:04:41] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[22:06:40] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[22:06:40] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/tkB8qQ
[22:06:40] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[22:06:41] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[22:06:41] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/2Rax7g
[22:06:41] <ghrust> 13rust/06auto 14cc5817d 15Alex Crichton: Add basic backtrace functionality...
[22:06:41] <ghrust> 13rust/06auto 143964820 15bors: auto merge of #12070 : alexcrichton/rust/backtrace, r=brson...
[22:06:41] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[22:08:00] <aatch> Ooo, backtraces
[22:08:01] *** Quits: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca) (Ping timeout)
[22:08:48] *** Joins: canhtak (canhtak@moz-D6541034.wl.t.ulaval.ca)
[22:10:34] *** Joins: mawuli (mawuli@moz-5ADAB167.com.gh)
[22:11:26] <eddyb> cmr: I thought moves from any & other than &move weren't legal...
[22:13:16] *** Quits: eddyb (eddy@688E9026.F7C96DA2.FCAAE698.IP) (Ping timeout)
[22:19:07] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[22:20:14] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:30:08] *** kimundi is now known as zz_kimundi
[22:30:42] <Eridius> Edwards: you can't move from &mut either. At best you can swap.
[22:30:55] <Eridius> dammit that was for eddyb
[22:30:56] <Eridius> ]but he's gone
[22:30:58] <Eridius> sorry Edwards
[22:36:41] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[22:36:41] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/IhvqvA
[22:36:41] <ghrust> 13rust/06auto 14f331f70 15Alex Crichton: Allow configuration of uid/gid/detach on processes...
[22:36:41] <ghrust> 13rust/06auto 1466c5f2e 15Alex Crichton: Upgrade libuv...
[22:36:41] <ghrust> 13rust/06auto 1400114a8 15bors: auto merge of #12085 : alexcrichton/rust/issue-12082, r=brson...
[22:36:43] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[22:53:57] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:54:02] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:54:15] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:54:23] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:55:56] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:56:03] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:56:15] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:56:16] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:56:40] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[22:56:40] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/YzbHzQ
[22:56:40] <ghrust> 13rust/06auto 14b1924c8 15Geoffroy Couprie: Implement Unix domain sockets in libnative
[22:56:40] <ghrust> 13rust/06auto 14799935e 15Alex Crichton: Move unix pipes implementation to pipe_unix.rs...
[22:56:41] <ghrust> 13rust/06auto 145953eb2 15Alex Crichton: Implement named pipes for windows, touch up unix...
[22:56:43] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[23:00:21] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[23:01:56] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:02:16] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:03:25] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[23:03:55] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:04:16] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:04:55] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Connection reset by peer)
[23:05:12] *** Joins: lpy|afk (lpy@527E9448.E262279B.65042015.IP)
[23:07:15] *** Quits: lpy|afk (lpy@527E9448.E262279B.65042015.IP) (Ping timeout)
[23:07:25] *** Joins: new_one (new_one@46BE517F.6D46D672.B3C0173E.IP)
[23:13:46] <bjz> jensnockert: ping
[23:14:03] <jensnockert> bjz: pong
[23:14:13] <bjz> https://github.com/mozilla/rust/pull/12331 ?
[23:14:23] <bjz> thoughts?
[23:15:00] <bjz> I thought it was a friendlier name
[23:15:08] <bjz> and clearer
[23:16:43] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[23:16:43] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14063b5a0 to 14425f574: 02http://git.io/N3iJvQ
[23:16:43] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[23:16:45] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[23:16:46] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/pXqCPg
[23:16:46] <ghrust> 13rust/06auto 14f331f70 15Alex Crichton: Allow configuration of uid/gid/detach on processes...
[23:16:46] <ghrust> 13rust/06auto 14679aaa5 15Alex Crichton: Upgrade libuv...
[23:16:46] <ghrust> 13rust/06auto 144003657 15bors: auto merge of #12085 : alexcrichton/rust/issue-12082, r=brson...
[23:16:48] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[23:18:50] <jensnockert> bjz: Never heard it called anything else but a popcount before, but the name is clear imho. Slight preference to popcount though.
[23:19:17] <jensnockert> bjz: Btw, I got clutter to mostly work with rust \o/
[23:19:37] * jensnockert mumbles something about silly gsignals.
[23:21:55] *** Quits: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP) (Ping timeout)
[23:22:47] *** Joins: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP)
[23:23:56] <flaper87> acrichto: https://github.com/mozilla/rust/issues/12332#issuecomment-35219723 Shouldn't the amtch complain about not all path options being covered?
[23:24:09] <flaper87> match*
[23:24:29] <acrichto> you mean warn about a lone _ case ?
[23:26:36] <flaper87> acrichto: no, I mean, in your example, wouldn't the compiler raise: "non-exhaustive patterns: XXX not covered"
[23:26:47] <flaper87> oh well, not if there's just 1 option
[23:27:02] <flaper87> s/option/possible match/
[23:27:11] <acrichto> not if you just bind the result
[23:27:15] <acrichto> you're not matching on anything
[23:27:21] <acrichto> you're just extenting the lifetime of the temporary
[23:27:51] <flaper87> right, then I was in fact ignoring something. I guess a lint would be enough
[23:29:02] <flaper87> although the case where I was suggesting raising an error is when using a lone _ case.
[23:29:05] <acrichto> I'm worried about false positives on that
[23:29:09] <acrichto> _ is super common
[23:29:16] <acrichto> it's a code smell if you're ignoring just one or two things
[23:29:29] <acrichto> but if you're ignoring half of the AST you don't want to have to turn off the warning everywhere
[23:32:02] <flaper87> agreed, it's ultra-super-low-prio. I mean, it'd be pretty obvious for developers when they're just matching a _ case that it's not quite useful. I'll change the description to suggest a lint and see if other folks think it makes sense
[23:32:50] <flaper87> it just feels weird that we don't say anything when the match bsaically doesn't match anything :D
[23:32:58] <acrichto> flaper87: https://github.com/mozilla/rust/issues/3482
[23:33:33] <flaper87> acrichto: erm, in that case I'll STFU and focus on finishing the static rules PR
[23:33:36] <flaper87> :D
[23:33:40] <acrichto> oh no worries
[23:35:23] *** Quits: new_one (new_one@46BE517F.6D46D672.B3C0173E.IP) (Ping timeout)
[23:36:53] <flaper87> acrichto: closed the bug and bumped the one oyu found... thanks :)
[23:37:05] <flaper87> you*
[23:37:32] *** Joins: new_one (new_one@46BE517F.6D46D672.B3C0173E.IP)
[23:42:13] *** Quits: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP) (Quit: Leaving)
[23:42:45] *** Joins: huon (Thunderbir@7B3DE86F.D5A1DCF.37681C44.IP)
[23:44:36] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[23:50:38] *** Quits: huon (Thunderbir@7B3DE86F.D5A1DCF.37681C44.IP) (Ping timeout)
[23:57:52] *** Quits: mawuli (mawuli@moz-5ADAB167.com.gh) (Ping timeout)
