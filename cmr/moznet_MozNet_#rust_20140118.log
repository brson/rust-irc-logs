[00:00:04] *** jorendorff is now known as jorendorff_away
[00:01:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:02:02] *** Joins: nulldata (chatzilla@moz-C5F891AC.seas-nve.net)
[00:02:59] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[00:03:01] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Input/output error)
[00:05:34] *** Joins: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com)
[00:06:15] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:06:41] *** Quits: bytewise (bytewise@moz-4B2383CA.adsl.alicedsl.de) (Quit: Leaving)
[00:06:51] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[00:06:53] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[00:08:05] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[00:08:06] *** Quits: io2 (io2@moz-871549F5.home.otenet.gr) (Ping timeout)
[00:08:15] *** Quits: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com) (Quit: )
[00:08:24] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[00:09:18] *** Joins: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com)
[00:09:30] *** Quits: luziie (lucy@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[00:10:05] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[00:10:31] *** Joins: luz (lucy@moz-CD18B14B.customer.cdi.no)
[00:12:13] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[00:12:42] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[00:12:53] *** Quits: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net) (Ping timeout)
[00:12:54] *** Joins: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net)
[00:12:59] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[00:15:45] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[00:16:33] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[00:19:00] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[00:19:32] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[00:19:36] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:19:38] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:20:10] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[00:20:44] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[00:20:57] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[00:21:03] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: willingc)
[00:24:24] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[00:25:35] *** Quits: ecr (chatzilla@moz-1FE08DA0.dhcp4.washington.edu) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0/20140113161826])
[00:26:06] *** Quits: Matthias247 (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de) (Connection reset by peer)
[00:26:47] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[00:27:01] *** Joins: new_one (new_one@9C883110.CCA5821A.B3C0173E.IP)
[00:29:49] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Client exited)
[00:30:19] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[00:31:02] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[00:31:51] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:33:10] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[00:33:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:33:35] *** Quits: TeXitoi (texitoi@moz-EA958D66.texitoi.eu) (Ping timeout)
[00:33:44] *** Joins: fuogo (Mibbit@moz-A80D4660.hsd1.pa.comcast.net)
[00:36:29] *** Joins: dylukes (dylukes@91FCCB57.8733FE32.E8393EEB.IP)
[00:36:58] *** Joins: TeXitoi (texitoi@moz-EA958D66.texitoi.eu)
[00:38:15] *** Quits: TylerE (Tyler@moz-6BD0CBDD.gvllcmtc01.gnvlnc.ab.dh.suddenlink.net) (Ping timeout)
[00:38:52] *** Quits: dylukes (dylukes@91FCCB57.8733FE32.E8393EEB.IP) (Quit: Textual IRC Client: www.textualapp.com)
[00:40:34] *** jorendorff_away is now known as jorendorff
[00:41:34] *** Quits: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP) (Quit: Leaving)
[00:47:28] *** jorendorff is now known as jorendorff_away
[00:49:23] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[00:52:19] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[00:53:44] *** Joins: igork (Adium@9C577557.7893D71C.6E0EE79F.IP)
[00:56:26] *** Parts: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) ()
[00:56:31] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[00:57:21] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[00:57:54] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[00:59:01] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Taking a nap.)
[00:59:18] *** Quits: kanru (kanru@moz-99690620.hinet-ip.hinet.net) (Ping timeout)
[01:00:45] <jmgrosen> should I try to make slicing a vec or str special in the compiler like indexing for those types is, or should I just always use the method?
[01:00:50] *** Joins: sedman (sedman@E4D2F0A.47298EC7.57E8EAD3.IP)
[01:01:29] <jmgrosen> special-casing it would be faster but more complicated
[01:01:45] <jmgrosen> slicing doesn't seem as intrinsic and indexing, though
[01:01:56] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[01:02:07] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[01:02:17] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[01:05:14] <kimundi> jmgrosen: Seeing how vectors and strings will change anyway because of DST, making them non-special is probably more future proof
[01:05:31] <kimundi> Can always be optimized later
[01:05:41] *** Joins: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au)
[01:05:43] <jmgrosen> alright, that sounds reasonable
[01:05:56] *** Quits: Mathuin (matthias@62DC781C.87D2502A.F90A1032.IP) (Ping timeout)
[01:07:38] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[01:07:49] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[01:08:17] *** Joins: dylukes (dylukes@7140BBE0.F921FECE.8C677E46.IP)
[01:09:08] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[01:10:21] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Quit: Leaving...)
[01:10:49] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[01:11:18] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:12:56] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Connection reset by peer)
[01:14:13] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[01:15:37] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[01:16:40] *** Joins: espindol_ (espindola@8EC99D26.4B7A7726.A2E931B1.IP)
[01:17:46] *** Quits: espindola (espindola@563D60BB.4B7A7726.A2E931B1.IP) (Ping timeout)
[01:18:41] *** Quits: espindol_ (espindola@8EC99D26.4B7A7726.A2E931B1.IP) (Connection reset by peer)
[01:18:45] *** Joins: espindola (espindola@8EC99D26.4B7A7726.A2E931B1.IP)
[01:19:18] *** Joins: espindol_ (espindola@8EC99D26.4B7A7726.A2E931B1.IP)
[01:19:18] *** Quits: espindola (espindola@8EC99D26.4B7A7726.A2E931B1.IP) (Connection reset by peer)
[01:20:59] *** Quits: espindol_ (espindola@8EC99D26.4B7A7726.A2E931B1.IP) (Ping timeout)
[01:21:00] <mitsuhiko> if i have a default implementation for a trait method, can i override that and call back to the default?
[01:21:34] <jmgrosen> mitsuhiko: I'm fairly certain that's a no
[01:22:09] <dbaupp> mitsuhiko: the pattern the main code bases uses is define a normal function and have the default method just call that directly
[01:22:21] <dbaupp> and then calling the "default" is just calling that function
[01:22:41] <SiegeLord> I'm guessing the unified method call syntax will ameliorate that
[01:22:51] <SiegeLord> Maybe
[01:22:59] <strcat> you won't be able to call free functions as methods
[01:23:24] <mitsuhiko> also, is there a way to get around "cannot call a generic method through an object"?
[01:23:31] <dbaupp> nope
[01:23:55] <mitsuhiko> bummer
[01:24:22] <dbaupp> you could have manually monomorphised version of that method
[01:24:48] <dbaupp> i.e. fn foo<T>(&self, x: T) { ... } fn foo_int(&self, x: int) { self.foo(x) } fn foo_f64(&self, x: f64) { self.foo(x) }
[01:24:51] <dbaupp> but obviously that's ugly
[01:25:25] *** Joins: espindola (espindola@563D60BB.4B7A7726.A2E931B1.IP)
[01:25:29] <mitsuhiko> what's the technical reason for this limitation?
[01:25:33] <dbaupp> (the other way is to use generics rather than trait objects, but, of course, this doesn't work always)
[01:25:41] <mitsuhiko> to be honest, maybe i'm doing it entirely wrong anyways
[01:25:42] <dbaupp> generic functions have to be monomorphised
[01:25:45] <jmgrosen> SiegeLord: I don't know if you saw this previously, but: https://gist.github.com/jmgrosen/f39b35f1b4d15af5d297
[01:25:53] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[01:25:57] <dbaupp> (i.e. a new copy of the code generated for each generic)
[01:25:57] <strcat> mitsuhiko: because when you call a generic fn, it has to be created based on the type parameters you used
[01:26:12] <strcat> mitsuhiko: rust can't possibly include them all in trait object vtables ;p
[01:26:13] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[01:26:13] *** ChanServ sets mode: +ao brson brson
[01:26:26] <strcat> mitsuhiko: trait objects need to be able to go between crates, they're a set ABI
[01:26:29] <mitsuhiko> i would not want that method to be virtual anyways
[01:26:33] <dbaupp> and you can't monomorphise a method when you've erased the type (because there's no way for it to know exactly which thing it needs to monomorphise)
[01:26:38] <strcat> mitsuhiko: well, don't use a trait object? :)
[01:26:49] <mitsuhiko> well, i need the methods in two places
[01:26:56] <mitsuhiko> i would have used macros but they cannot generate functions at the moment
[01:27:02] *** Quits: jadbaires (jadrian@moz-E16F2010.dsl.telepac.pt) (Quit: Konversation terminated!)
[01:27:09] *** Joins: jadbaires (jadrian@7A056CD5.AF63E717.6119BA41.IP)
[01:27:15] <mitsuhiko> in c++ i would have used non virtual inheritance i think
[01:27:21] *** Quits: sedman (sedman@E4D2F0A.47298EC7.57E8EAD3.IP) (Ping timeout)
[01:27:41] <strcat> mitsuhiko: trait inheritance?
[01:27:54] * strcat shrugs
[01:28:06] *** Joins: blaenk (blaenk@moz-C270A5EA.lsanca.dsl-w.verizon.net)
[01:28:31] <SiegeLord> jmgrosen: That looks good, although I'm a bit saddened that you're forced into only a single type of index for all 4 methods
[01:28:55] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Quit: Leaving.)
[01:29:00] <jmgrosen> so I'm mostly going off nmatsakis' recommendation for slices (https://github.com/mozilla/rust/issues/4160#issuecomment-28909198) except for a generic index type, and his Slice trait has an .as_slice(); this is the only method that vdc::Vector<T> has right now -- should I just make Vector be trait Vector<T>: Slice<uint, T> {} ?
[01:29:11] <jmgrosen> SiegeLord: what's the use case for different index types?
[01:29:29] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[01:29:41] <SiegeLord> I wanted to see if I could hack a stride into that syntax
[01:29:48] <jmgrosen> stride?
[01:29:51] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[01:29:51] <SiegeLord> So I'd use a tuple as one of the two indicies
[01:30:10] <mitsuhiko> strcat: hmm. how does that work>
[01:30:18] *** Quits: jadbaires (jadrian@7A056CD5.AF63E717.6119BA41.IP) (Client exited)
[01:30:28] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[01:30:30] <strcat> mitsuhiko: trait Foo { ... } trait Bar: Foo + ... { ... }
[01:30:31] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[01:30:41] <strcat> mitsuhiko: any type implement Bar has to impl Foo, and you can call methods from Foo in the default impls
[01:30:51] *** Quits: dbaupp (Thunderbir@moz-EE10A658.lns20.syd6.internode.on.net) (Ping timeout)
[01:31:04] <strcat> you could also 'impl<T: Foo> Bar for T {}' to make it implicit
[01:31:08] * strcat shrugs
[01:31:16] <SiegeLord> jmgrosen: Like in MATLAB if I had v = [1,2,3,4,5]; v[1:2:5] == [1,3,5]
[01:31:16] <strcat> I'm sure you'll figure out a good way ;p
[01:31:19] <nif> this is the third time my code has compiled today. the last time it compiled was, like, several days ago. I'm ecstatic.
[01:31:40] <SiegeLord> Obviously it's not something regular vectors would use, mostly thinking of a matrix librar
[01:31:41] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[01:31:44] <SiegeLord> *library
[01:31:53] <jmgrosen> SiegeLord: oh, so like python's third parameter, then?
[01:31:58] *** Joins: dbaupp (Thunderbir@moz-CD216EE4.lns20.syd6.internode.on.net)
[01:32:14] <SiegeLord> Yes, except they put the stride in the third parameter instead of the second
[01:32:15] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[01:32:16] <jmgrosen> yeah
[01:32:37] <SiegeLord> Well, it's not a big deal... it'd look ugly anyway [1..(1,5)] or something
[01:32:38] <jmgrosen> hm
[01:32:48] <dbaupp> nif: <3 compiling code
[01:32:49] <SiegeLord> Maybe something like .stride(1)[1..5] would be better anyway
[01:33:00] <SiegeLord> Or a macro, now that they are exportable
[01:33:19] <nif> :)
[01:33:35] <dbaupp> fwiw, the return value of Slice would need to be customisable, since &[] are contiguous blocks of memory
[01:33:43] <nif> idk if my stuff passes stage 2 or even works at all, but it compiles, darn it.
[01:33:55] <o11c> strides are no worth it
[01:34:40] <o11c> just have [start:end] and have a .stride(n) method on Iterator that you call afterwards
[01:34:43] <jmgrosen> SiegeLord: another thing is that right now all the methods have to return &'a [T]
[01:34:51] <jmgrosen> do you think I should change that to arbitrary T?
[01:34:53] <SiegeLord> Oh, I missed that
[01:35:22] <SiegeLord> I'd prefer an arbitrary T, naturally
[01:35:48] * jmgrosen wonders what nmatsakis thinks
[01:35:56] <mitsuhiko> strcat: but when the generic method is on the trait i have my problem again
[01:36:20] <SiegeLord> o11c: I dunno... [1..5].stride(2)[1..5].stride(2)[1..5].stride(2) is a far cry from [1:2:5,1:2:5,1:2:5]
[01:36:36] *** Quits: dbaupp (Thunderbir@moz-CD216EE4.lns20.syd6.internode.on.net) (Ping timeout)
[01:39:26] <o11c> SiegeLord: the former is *much* more readable
[01:39:39] <SiegeLord> Well, not to me :P
[01:39:59] <o11c> since there is no consensus on start:step:end or start:end:step, it's not worth the confusion
[01:40:15] <SiegeLord> Both MATLAB and Python manage anyway
[01:40:36] *** Quits: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au) (Connection reset by peer)
[01:40:46] *** Joins: dbaupp (Thunderbir@moz-54209D42.lns20.syd6.internode.on.net)
[01:41:01] <SiegeLord> It's not that scary to make a choice
[01:41:12] <SiegeLord> Even if there are several things to choose from
[01:41:43] *** Joins: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au)
[01:42:11] *** Joins: trevor (trevor@moz-F6C93216.hsd1.mn.comcast.net)
[01:42:31] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:43:12] *** Quits: nkoep (nik@moz-9D973323.pool.mediaways.net) (Client exited)
[01:44:14] <jmgrosen> SiegeLord: so you'd prefer something like https://gist.github.com/jmgrosen/d20af9374cf60155676c ?
[01:44:49] <SiegeLord> I wouldn't worry about the different index types, it just wont' work with this design
[01:45:01] <SiegeLord> I like the 'Result' though
[01:45:10] <jmgrosen> alright
[01:45:13] <dbaupp> fwiw, lifetimes don't work in traits yet
[01:45:48] <jmgrosen> well, it compiled :P
[01:46:07] <jmgrosen> what do you mean by not work?
[01:46:45] <dbaupp> warning: slippery ICE
[01:46:46] <dbaupp> :P
[01:47:03] <dbaupp> https://github.com/mozilla/rust/issues/5121
[01:47:29] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:48:02] <jmgrosen> huh, wonder how it compiled then o_O
[01:48:27] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[01:48:40] <dbaupp> presumably because you didn't use it in any function signatures
[01:48:43] *** Quits: fuogo (Mibbit@moz-A80D4660.hsd1.pa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:48:44] <dbaupp> just as a trait definition
[01:49:00] <igork> is there any rust nightly builds for os x?
[01:49:29] <jmgrosen> dbaupp: oh, I used it in an impl, but you're right that it doesn't work in functions
[01:49:44] <acrichto> igork: not yet, but we hope to get it done during this release cycle!
[01:50:03] <MrByte> Josh@home1
[01:50:10] <MrByte> Whoops.
[01:50:33] *** Quits: dylukes (dylukes@7140BBE0.F921FECE.8C677E46.IP) (Quit: Textual IRC Client: www.textualapp.com)
[01:50:35] <igork> acrichto: oh, cool. i will wait for it then
[01:51:10] <jmgrosen> dbaupp: what should I do, then? I can't declare Slice<uint, &'a [T]> without it >.<
[01:51:11] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[01:52:00] *** Joins: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au)
[01:52:23] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Quit: leaving)
[01:52:27] *** Quits: kris_ (kris@moz-5A7B69C7.math.ku.dk) (Ping timeout)
[01:52:29] *** Joins: kris_ (kris@moz-147EE6DF.diku.dk)
[01:52:29] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[01:52:30] *** ChanServ sets mode: +o acrichto
[01:52:54] <dbaupp> jmgrosen: yeah, you can ;P
[01:53:24] <dbaupp> jmgrosen: `trait Slice<A, Result> { ... } impl<'a, T> Slice<A, &'a [T]> for &'a [T] { ... }`
[01:53:37] <jmgrosen> oh, right, duh >.<
[01:53:39] <jmgrosen> :P
[01:53:40] <dbaupp> doesn't work types without built-in lifetimes though
[01:54:10] *** Joins: lahwran (lahwran@lahwran.net)
[01:54:46] <_achin> does rust have a void pointer type? (to be used with a forign function that returns a pointer to an opaque data type)
[01:55:07] *** Joins: leroux (leroux@moz-421CF1E4.dsl.bell.ca)
[01:55:33] * dbaupp normally uses *()
[01:55:37] <dbaupp> there's also *libc::c_void
[01:55:39] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:55:45] <dbaupp> and good old *u8 / *i8
[01:55:59] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:56:14] *** Quits: nif (nif@moz-8181E2AC.oberlin.net) (Quit: Konversation terminated!)
[01:56:17] <MrByte> I've always used *c_void, mostly because I feel like it best expresses what I'm trying to do with foreign functions.
[01:57:02] <strcat> it's not great to use *c_void for other opaque data types
[01:57:10] <strcat> then you lose basic type safety checks
[01:57:17] <strcat> enum OpaqueThing {}
[01:57:22] <strcat> *mut OpaqueThing
[01:57:41] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:57:41] <strcat> _achin: ^ is an actual uninhabited type, with a ptr to it
[01:57:51] <_achin> i see, ok let me try that.  thanks
[01:58:00] <strcat> which is how you should translate 'struct Foo;' from C without a definition
[01:58:13] <SiegeLord> Interesting... I just used struct Foo;
[01:58:30] <SiegeLord> You can't instantiate enum OpaqueThing though, right?
[01:58:33] <strcat> SiegeLord: that's a zero-size type, rust will let you make one by accident
[01:58:35] <strcat> SiegeLord: right
[01:58:50] <_achin> i suppose it's important to not be able to instantiate this thing
[01:59:38] *** Joins: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br)
[02:00:00] <SiegeLord> bindgen uses type Foo = c_void;
[02:00:11] <pepper_chico> there's no way to have mutable tuple values?
[02:00:12] <SiegeLord> You can probably instantiate c_void, right?
[02:00:21] *** Quits: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com) (Quit: ZNC - http://znc.in)
[02:00:44] <strcat> pepper_chico: you can have mutable tuple values
[02:00:47] <strcat> not sure what you mean
[02:00:55] *** Joins: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com)
[02:01:12] <pepper_chico> strcat, mutable elements of a tuple
[02:01:14] <strcat> they inherit mutability like other types
[02:01:26] *** Quits: mhl (mhl@moz-29483F85.merinet.pl) (Quit: Lost terminal)
[02:01:31] <pepper_chico> I tried to set them, to no avail...
[02:01:34] <SiegeLord> Oh actually... c_void is enum c_void { priv variant1, priv variant2 }
[02:01:40] <strcat> pepper_chico: how are you trying to set them?
[02:01:46] <strcat> rusti: let mut x = (1, 2); let (mut ref a, _) = x; *a = 10; x
[02:01:49] -rusti- pastebinned 9 lines of output: http://ix.io/9X8
[02:01:55] <pepper_chico> like, t.n0_ref() = 1
[02:01:57] <strcat> rusti: let mut x = (1, 2); let (ref mut a, _) = x; *a = 10; x
[02:01:58] -rusti- (10, 2)
[02:02:06] <strcat> pepper_chico: those methods return immutable ptrs, they're not a language feature
[02:02:06] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[02:02:09] <dbaupp> pepper_chico: that returns an immutable reference
[02:02:18] <strcat> there are no built-in methods
[02:02:27] <strcat> those are implemented with pattern matching internally
[02:02:41] *** Joins: dylukes (dylukes@moz-ED57011A.oakland.resnet.pitt.edu)
[02:02:43] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[02:02:46] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[02:02:56] <pepper_chico> ok, I know, they are an implementation of a trait
[02:02:59] <pepper_chico> a sorry
[02:03:01] <pepper_chico> I meant
[02:03:06] <pepper_chico> like, *t.n0_ref() = 1
[02:03:18] <pepper_chico> no way to have a mutable ref?
[02:03:25] <strcat> pepper_chico: you can have a mutable ref
[02:03:35] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[02:03:36] <strcat> pepper_chico: the type signature of n0_ref returns &T
[02:03:51] <strcat> that's just what it returns
[02:04:14] <strcat> rusti: let mut x = (1, 2); let (ref a, _) = x; *a
[02:04:15] -rusti- <anon>:10:13: 10:18 warning: variable does not need to be mutable, #[warn(unused_mut)] on by default
[02:04:15] -rusti- <anon>:10         let mut x = (1, 2); let (ref a, _) = x; *a
[02:04:15] -rusti-                       ^~~~~
[02:04:15] -rusti- 1
[02:04:17] <strcat> immutable ref
[02:04:20] <strcat> rusti: let x = (1, 2); let (ref a, _) = x; *a
[02:04:21] -rusti- 1
[02:04:32] <strcat> rusti: let mut x = (1, 2); let (ref mut a, _) = x; *a = 10; x
[02:04:33] -rusti- (10, 2)
[02:04:35] <strcat> mutable ref
[02:04:47] <strcat> rusti: let mut x = (1, 2); let (a, _) = x; a
[02:04:48] -rusti- <anon>:10:13: 10:18 warning: variable does not need to be mutable, #[warn(unused_mut)] on by default
[02:04:48] -rusti- <anon>:10         let mut x = (1, 2); let (a, _) = x; a
[02:04:48] -rusti-                       ^~~~~
[02:04:48] -rusti- 1
[02:04:54] <strcat> rusti: let x = (1, 2); let (a, _) = x; a
[02:04:55] -rusti- 1
[02:04:57] * strcat shrugs
[02:04:58] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[02:04:58] *** ChanServ sets mode: +o tjc
[02:04:59] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[02:05:01] <pepper_chico> ok guys I know I can use the language syntax to set tuple elements
[02:05:08] *** Parts: japaric (japaric@5F207A99.A347E168.F4D5766F.IP) (WeeChat 0.4.2)
[02:05:11] <pepper_chico> I'm talking about a convenience
[02:05:16] <pepper_chico> for that
[02:05:25] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[02:05:25] *** ChanServ sets mode: +ao brson brson
[02:05:27] <bstrie_disappeared_again> those methods are terrible, do not use them :)
[02:05:28] *** Joins: japaric (japaric@5F207A99.A347E168.F4D5766F.IP)
[02:05:33] <strcat> pepper_chico: we don't have those convenience methods
[02:05:35] <pepper_chico> like, .n0_mut_ref()
[02:05:44] *** bstrie_disappeared_again is now known as bstrie_oh_hai_there_siegelord
[02:05:49] <bstrie_oh_hai_there_siegelord> SiegeLord: get a better irc client!
[02:05:56] <strcat> I don't think we did those methods right anyway
[02:05:59] <pepper_chico> ok then, thanks anyway about the other matters ;-)
[02:06:03] <bstrie_oh_hai_there_siegelord> we ought to just remove them
[02:06:03] *** Joins: brianm (brianm@moz-8161EF8D.hsd1.ca.comcast.net)
[02:06:10] <strcat> it's weird that n0 uses Clone
[02:06:11] <SiegeLord> bstrie: I changed some settings ;)
[02:06:11] <bstrie_oh_hai_there_siegelord> really, there's no way we want to end up supporting them
[02:06:22] <SiegeLord> Now you appear as bstrie_oh_… to me :P
[02:06:26] <pepper_chico> what, remove n0_ref etc?
[02:06:30] <bstrie_oh_hai_there_siegelord> haha
[02:06:34] *** bstrie_oh_hai_there_siegelord is now known as bstrie_nope
[02:06:42] *** Joins: lahwran (lahwran@lahwran.net)
[02:06:50] <bstrie_nope> pepper_chico: yes. those methods are grody
[02:07:03] <pepper_chico> in truth... I don't know ther use of n0_ref, since there's n0() etc
[02:07:09] <pepper_chico> and ref is immutable
[02:07:14] <bstrie_nope> they only work up to like, ten or something
[02:07:21] <pepper_chico> ah yeah
[02:07:21] <bstrie_nope> and they just plain look ugly :)
[02:07:28] *** Joins: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP)
[02:07:29] <bstrie_nope> if we had syntax for it, that would be different
[02:07:29] <pepper_chico> I was discussing this previously
[02:07:41] *** Parts: japaric (japaric@5F207A99.A347E168.F4D5766F.IP) (WeeChat 0.4.2)
[02:07:42] <bstrie_nope> foo = (1,2,3,4); foo#2;
[02:07:43] <bstrie_nope> or something
[02:07:46] <pepper_chico> lack of numerical type parameter and variadics
[02:07:50] *** Joins: japaric (japaric@5F207A99.A347E168.F4D5766F.IP)
[02:07:52] <bstrie_nope> but we don't! so just use pattern matching :)
[02:07:56] <pepper_chico> same stuff c++ have gone through
[02:08:49] <strcat> pepper_chico: n0 uses Clone
[02:08:55] <strcat> it shouldn't be there
[02:09:08] <strcat> I remember voicing concerns about this but it landed anyway
[02:09:39] <bstrie_nope> I'd honestly be astonished if anyone could come up with a defense of those methods
[02:09:48] <pepper_chico> well anyway.... I building a tutorial, and I think I should just mention this methods lightly and focus on pattern matching
[02:09:54] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[02:10:01] <pepper_chico> and binding
[02:10:14] *** Quits: doomlord_ (servitor@moz-CA917A47.range86-184.btcentralplus.com) (Ping timeout)
[02:10:17] <pepper_chico> then....
[02:10:19] <bstrie_nope> don't mention those methods, they are a secret shame and should be eradicated :)
[02:10:37] <dbaupp> `tuple.0` would be neat
[02:10:48] <pepper_chico> c++ has get<N>()
[02:11:22] *** Joins: doomlord_ (servitor@moz-D9C46C01.range86-184.btcentralplus.com)
[02:11:24] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[02:11:29] <bstrie_nope> dbaupp: why do you need to index into a tuple?
[02:11:39] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[02:11:57] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[02:12:09] <pepper_chico> bstrie_nope, more convenient than the binding thing
[02:12:12] <strcat> and `int a; double b; std::tie(a, b) = foo();' instead of `let (a, b) = foo();` (and you can't make the C++ variables const!)
[02:12:15] *** Quits: doomlord_ (servitor@moz-D9C46C01.range86-184.btcentralplus.com) (Quit: Leaving)
[02:12:15] <strcat> ;p
[02:12:40] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[02:12:43] <strcat> pepper_chico: if the tuple is large enough that you're needing to remember indexes because matching isn't convenient, use a struct with named fields imo
[02:12:44] <dbaupp> bstrie_nope: because sometimes you only want one element of the return value
[02:12:55] <dbaupp> like `if some_tupley_function().0 == 1 { ... }`
[02:13:07] <bstrie_nope> pepper_chico: no, because pattern matching also lets you decide whether you want a reference or mutable reference to the value, without needing more methods and more syntax
[02:13:10] <dbaupp> but the methods are fine for that for me
[02:14:06] <bstrie_nope> dbaupp: that looks super gross :P
[02:14:10] <pepper_chico> bstrie_nope, with numerical type parameters, it would be just 2 or 4 convenience methods
[02:14:21] <pepper_chico> not, 1, 2, ... 12 methods...
[02:14:33] <bstrie_nope> what would you name them
[02:14:37] *** Quits: chromatic (chromatic@moz-28CBC7F4.hsd1.or.comcast.net) (Quit: Leaving)
[02:14:41] <bstrie_nope> .0_mut_ref?
[02:14:46] <bstrie_nope> that's hideous :)
[02:14:55] *** Quits: vmx (vmx@moz-3FAEC8A8.pools.arcor-ip.net) (Quit: Leaving)
[02:15:04] <strcat> well n0 would return a ref and n0_mut would return a mutable ref
[02:15:07] <strcat> if it was done sanely
[02:15:09] <strcat> ;p
[02:15:22] <pepper_chico> that's not a numerical type parameter, just the same kind of stuff that's already on std
[02:15:22] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[02:15:29] <bstrie_nope> the stuff in std is bad
[02:15:34] <bstrie_nope> it must be removed
[02:15:37] <dbaupp> bstrie_nope: they'd be l-values
[02:15:40] <bstrie_nope> .n0 is an abomination
[02:15:44] <dbaupp> so &mut tuple.0
[02:15:46] <dbaupp> etc.
[02:16:03] <dbaupp> (or rvalues.. whichever one x[0] and x.field are.)
[02:16:13] <pepper_chico> I don't like it either, but I'm talking about a different and shorter way of providing the same
[02:16:13] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[02:16:25] <dbaupp> strcat: .n0 moves out now
[02:16:29] <bstrie_nope> we don't need to succumb to the code golfers
[02:16:32] *** Quits: trevor (trevor@moz-F6C93216.hsd1.mn.comcast.net) (Ping timeout)
[02:16:33] *** Joins: robhobbes (Mibbit@moz-2741C540.slkc.qwest.net)
[02:16:34] <dbaupp> so it's not a complete abomination
[02:16:35] <dbaupp> bstrie_nope: lies
[02:16:40] <bstrie_nope> use one more line and be explicit about what you're trying to do
[02:16:42] <dbaupp> the purpose of Rust is code golfing
[02:16:43] <strcat> dbaupp: oh
[02:16:46] *** Quits: nulldata (chatzilla@moz-C5F891AC.seas-nve.net) (Ping timeout)
[02:16:49] * strcat shrugs
[02:16:59] *** Quits: blaenk (blaenk@moz-C270A5EA.lsanca.dsl-w.verizon.net) (Quit: Leaving)
[02:17:00] <dbaupp> we're not very good at our purpose, I guess.
[02:17:05] <strcat> rust is a pretty bad language for code golf ;p
[02:17:10] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:17:15] <strcat> you'd want to not worry about the very specific idea of safety in rust
[02:17:19] <dbaupp> at least we can compress whitespace :P
[02:17:22] <robhobbes> hey guys! question: how can I convert an owned string into a vector of u8?
[02:17:27] <dbaupp> .as_bytes()
[02:17:31] <dbaupp> or .into_bytes()
[02:17:33] <robhobbes> really?
[02:17:35] <robhobbes> that easy?
[02:17:41] <pepper_chico> if there was a sane way to have n(0) n(1) where the parameters numerical types resolved statically, it would be fine
[02:17:42] <dbaupp> for &[u8] and ~[u8] respectively
[02:17:45] <pepper_chico> for me at last
[02:18:04] <pepper_chico> were numerical*
[02:18:08] *** Joins: sellout (Adium@moz-76D71F1A.hlrn.qwest.net)
[02:18:09] <robhobbes> @dbaupp .as_bytes() will give me a borrowed vector?
[02:18:11] <dbaupp> robhobbes: yes (strings are utf8 encoded internally, and hence, those byte buffer are two)
[02:18:14] <dbaupp> robhobbes: yup
[02:18:23] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[02:18:27] <robhobbes> @dbaupp thanks!
[02:18:29] <dbaupp> robhobbes: http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html#tymethod.as_bytes
[02:18:45] <dbaupp> robhobbes: and http://static.rust-lang.org/doc/master/std/str/trait.OwnedStr.html#tymethod.into_bytes
[02:19:15] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[02:19:25] <dbaupp> pepper_chico: with numbers as generic parameters, we could do .n::<0>() like C++
[02:19:50] <pepper_chico> yeah, just what I'm saying..
[02:20:08] *** Quits: robhobbes (Mibbit@moz-2741C540.slkc.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:20:18] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[02:20:18] <bstrie_nope> good, that's ugly enough that nobody will be tempted to use it over saner methods :P
[02:20:23] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[02:20:39] <pepper_chico> that's the definition
[02:20:42] <pepper_chico> not the use
[02:20:57] <pepper_chico> or, whatever
[02:20:59] <pepper_chico> ...
[02:21:04] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[02:21:06] <pepper_chico> it doesn't exist anyway
[02:21:14] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Quit: )
[02:21:16] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[02:21:44] <bstrie_nope> it probably will, one day
[02:21:50] <bstrie_nope> I just don't think it deserves special syntax
[02:22:12] <pepper_chico> this afternoon a guy told me there was a guy working on numerical parameters, if it gets into the language, as I'm waiting for variadic too
[02:22:19] <bstrie_nope> lots of people want numeric type parameters
[02:22:23] <pepper_chico> I suppose that stuff will be available
[02:22:24] *** Joins: josh (josh@moz-4B9D2F6E.dhcp.stcd.mn.charter.com)
[02:22:25] <bstrie_nope> I'm sure it will get here eventually
[02:22:31] <bstrie_nope> not for 1.0, most likely
[02:22:38] <bstrie_nope> variadics will probably make it for 1.0
[02:22:56] <bstrie_nope> but numeric type parameters is, apparently, quite the thorny path
[02:23:02] <bstrie_nope> I keep hearing the word "fundeps" thrown around
[02:23:14] <bstrie_nope> and then a cold shadow of gloom passes over the chatroom
[02:23:32] <_achin> is there any #[] directive that will induce the --test arg to rustc?  (similar to how #[crate_type="lib"] induces --lib)
[02:23:36] *** Quits: muricula (kronquii@moz-2F636E0B.onid.oregonstate.edu) (Quit: Changing server)
[02:23:56] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[02:24:02] <bstrie_nope> _achin: hm, not that I know of
[02:24:12] *** Quits: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br) (Quit: Ex-Chat)
[02:24:34] <_achin> bstrie_nope: k thanks
[02:24:50] <SiegeLord> I wouldn't say crate_type induces it, as you can still do --lib even if you have a crate_type
[02:25:04] <bstrie_nope> _achin: make a bash alias :)
[02:25:13] <SiegeLord> For extra fun, try doing that with --dep-info
[02:25:16] <_achin> what happens in that case?  what directive is ignored? or is an error thrown?
[02:25:28] <bstrie_nope> I think command line overrides attribute
[02:25:29] <bstrie_nope> or
[02:25:31] <SiegeLord> Today, neither
[02:25:31] <bstrie_nope> the exact opposite
[02:25:40] <SiegeLord> They both remain
[02:26:05] <_achin> so if you hade crate_type=lib and did --rlib, you'd get both types built?
[02:26:11] <SiegeLord> Yes
[02:26:18] <_achin> neat.  i guess :P
[02:26:25] *** Parts: japaric (japaric@5F207A99.A347E168.F4D5766F.IP) (WeeChat 0.4.2)
[02:26:26] <SiegeLord> I think it's an issue and I hope to see it changed
[02:26:37] *** Joins: japaric (japaric@5F207A99.A347E168.F4D5766F.IP)
[02:26:38] <bstrie_nope> how weird
[02:26:41] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[02:27:14] <SiegeLord> Interestingly, if you do crate_type=lib and --lib and then look at dep-info you'll seem to observe that the library is created twice
[02:27:33] <SiegeLord> Hopefully that's not actually what happens, heh
[02:27:38] <_achin> at least it's consistant!
[02:28:24] <kimundi> "non-exhaustive patterns" said the compiler unhelpfully, while pointing at a 110 lines match body...
[02:28:52] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[02:30:29] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[02:31:49] *** Joins: nham (Mibbit@moz-2C6185F8.lightspeed.dybhfl.sbcglobal.net)
[02:32:10] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[02:32:25] <dbaupp> kimundi: it's your fault for having 110 lines of matching :P
[02:34:18] <kimundi> dbaupp: I'm writing a state machine for a tokenizer, those tend to get long :P
[02:34:31] <dbaupp> psh, delete the \n's
[02:34:41] *** Quits: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: It is tiem!)
[02:37:02] *** Joins: TylerE (Tyler@moz-6BD0CBDD.gvllcmtc01.gnvlnc.ab.dh.suddenlink.net)
[02:37:48] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[02:38:01] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[02:39:15] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[02:39:50] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Ping timeout)
[02:41:21] *** Quits: pcdummy (pcdummy@moz-CF4CA865.page4me.ch) (Ping timeout)
[02:41:21] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Textual IRC Client: www.textualapp.com)
[02:42:31] *** Joins: pcdummy (pcdummy@moz-CF4CA865.page4me.ch)
[02:42:39] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[02:43:06] *** Quits: josh (josh@moz-4B9D2F6E.dhcp.stcd.mn.charter.com) (Quit: josh)
[02:43:30] *** Joins: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net)
[02:43:36] *** jorendorff_away is now known as jorendorff
[02:46:46] *** Parts: a_m0d (a_m0d@moz-322A4DE4.acanac.net) ()
[02:50:25] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:51:05] *** Quits: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au) (Quit: http://www.mibbit.com ajax IRC Client)
[02:52:27] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[02:52:55] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[02:53:41] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:54:47] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[02:55:34] <diverse> SiegeLord: how about that 'mmmmmmmmmmmm' dude from earlier?
[02:56:01] <SiegeLord> What about him?
[02:57:05] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[02:57:41] *** Quits: dylukes (dylukes@moz-ED57011A.oakland.resnet.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:57:47] *** Joins: FalconSpy (falcon@moz-137EFD6A.dyn.optonline.net)
[02:57:55] *** Quits: FalconSpy (falcon@moz-137EFD6A.dyn.optonline.net) (Quit: FalconSpy)
[02:58:38] *** Joins: FalconSpy (falcon@moz-137EFD6A.dyn.optonline.net)
[02:59:00] *** Quits: FalconSpy (falcon@moz-137EFD6A.dyn.optonline.net) (Quit: )
[02:59:10] <diverse> SiegeLord: right after you said you were having limited reading space due to people in the channel with long usernames, that dude just logs in and screws you over, out of nowhere
[02:59:41] <SiegeLord> Some times the gods have to give you some mmmmmmmmmotivation to fix your problems
[03:00:58] *** Quits: igork (Adium@9C577557.7893D71C.6E0EE79F.IP) (Quit: Leaving.)
[03:01:07] <diverse> by 'gods' you mean bstrie?
[03:01:17] <SiegeLord> Hehe
[03:01:33] <mindcat> mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
[03:01:33] <SiegeLord> They work in mysterious ways
[03:01:42] <mindcat> hmm
[03:01:48] <diverse> hahaha
[03:04:14] *** jorendorff is now known as jorendorff_away
[03:04:40] <diverse> SiegeLord: how did you solve the problem?
[03:05:07] <kimundi> how do I disable a dead_assignment warning?
[03:05:25] <kimundi> nvmt, got it
[03:05:45] <diverse> kimundi: was it '#[allow(dead_assignment)]'?
[03:05:51] <kimundi> yes :P
[03:06:16] <diverse> Wow, that was a good guess on my part
[03:07:35] <SiegeLord> diverse: /set weechat.look.prefix_align_max 10 and /set weechat.bar.nicklist.size 12
[03:07:48] <SiegeLord> That said, Mozilla should just not allow 30 character long nicks :P
[03:08:37] <SiegeLord> Freenode allows up to 16, and I don't see anybody complaining ;)
[03:09:05] <mcpherrin> SiegeLord: I demand the right to my long string of 'm's :)
[03:09:07] <diverse> SiegeLord: ah, thanks man
[03:09:12] <mcpherrin> Freenode oppression!
[03:09:21] <diverse> mcpherrin: you were 'mmm...'?
[03:09:30] *** Quits: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com) (Client exited)
[03:09:51] <mcpherrin> My username at work is 'mm' and I tend to use long strings of m for test strings ;)
[03:09:51] *** Joins: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com)
[03:10:38] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[03:10:47] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[03:11:03] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[03:11:03] <SiegeLord> I also did /set weechat.look.prefix_align_more = "…" but that's a personal preference
[03:11:20] <SiegeLord> Maybe something more derogatory would fit there better ;)
[03:11:32] *** Quits: michaeljdennis (michaeljde@moz-72A64986.socal.res.rr.com) (Ping timeout)
[03:12:10] *** Quits: kimundi (kimundi@moz-646723D.dip0.t-ipconnect.de) (Ping timeout)
[03:12:11] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[03:12:25] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[03:13:05] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[03:15:17] *** Joins: kimundi (kimundi@moz-EAE0F638.dip0.t-ipconnect.de)
[03:15:42] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[03:16:58] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[03:17:07] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[03:17:12] *** Joins: quux00 (Mibbit@2972FE24.B82DA533.53C6B850.IP)
[03:17:49] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[03:19:01] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[03:19:06] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (Quit: ziad)
[03:20:00] *** kimundi is now known as zz_kimundi
[03:23:18] *** Joins: dylukes (dylukes@39BBA869.27FF3780.8C677E46.IP)
[03:24:17] *** Joins: orospakr (orospakr@moz-A57EF4CD.cpe.net.cable.rogers.com)
[03:26:40] *** zz_kimundi is now known as kimundi
[03:29:23] *** Quits: nfroidure (nfroidure@moz-13F41233.w90-18.abo.wanadoo.fr) (Ping timeout)
[03:29:39] *** Quits: ptc (Adium@moz-8F01578B.z72-46-65.customer.algx.net) (Quit: Leaving.)
[03:30:04] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[03:30:26] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[03:31:07] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[03:31:35] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[03:32:15] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[03:32:49] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[03:35:05] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[03:37:46] *** Joins: ferminter (Mibbit@moz-3213C615.wavecable.com)
[03:38:03] <ferminter> Is there anyone using rust on windows right now? I'm having trouble.
[03:38:53] <diverse> ferminter: Tobba uses Rust on windows, although he doesn't seem to be here atm. :(
[03:39:08] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[03:39:11] *** Quits: [o__o] (~o__o@moz-24EBFAC7.me) (Input/output error)
[03:39:14] <diverse> very smart dude
[03:39:33] <ferminter> I'm trying to run it from within the msys shell, but I get a "rust.exe has stopped working" window. It says the "Fault Module Name" is libstdc++-6.dll, but I continue to get this error after reinstalling mingw-libstd++, so I'm stumped.
[03:40:24] *** Joins: pilf (pilf@moz-E8842E0A.dsl.bell.ca)
[03:44:00] *** kimundi is now known as zz_kimundi
[03:44:11] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:46:13] <diverse> ferminter: it's not your fault, Rust will eventually get a good linker that would work on windows without any extra work, it will just take some time.
[03:46:45] <diverse> in the meantime I would wait for Tobba
[03:46:45] <geomyidae> "rust.exe" or "rustc.exe" ? what is rust.exe?
[03:47:28] <ferminter> Oh wait... that's a good point.
[03:47:55] <diverse> geomyidae: rustc, rust was a program that ran rustc for convience of testing but was removed a while ago. What version are you using?
[03:48:03] <ferminter> Surprise, surprise... rustc actually works. I don't really know what rust.exe is.
[03:48:21] <geomyidae> I'm not running windows atm :)
[03:48:39] <diverse> ferminter: rust.exe shouldn't be there, what version are you using?
[03:48:44] <ferminter> diverse: I'm using 0.9 now. I tried 0.8 a few months ago. Now it's a relic of ancient history. 
[03:49:07] *** Quits: espindola (espindola@563D60BB.4B7A7726.A2E931B1.IP) (Input/output error)
[03:49:12] <diverse> ferminter: yes, you are better off with 0.9. 0.8 is a dinosaur at this point.
[03:49:42] *** Joins: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au)
[03:51:51] *** Joins: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP)
[03:52:08] <strcat> ferminter: looks like you didn't fully remove 0.8 first
[03:53:37] <_achin> shoudln't #[link="foo"] cause -lfoo to be added to the linker args?
[03:54:05] *** Quits: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com) (Ping timeout)
[03:54:59] <_achin> (oops, i mean #[link(name="foo")])
[03:56:02] *** Parts: quux00 (Mibbit@2972FE24.B82DA533.53C6B850.IP) ()
[03:56:14] *** Quits: pilf (pilf@moz-E8842E0A.dsl.bell.ca) (Quit: pilf)
[03:57:13] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[03:59:58] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[04:00:53] *** Joins: josh (josh@moz-4B9D2F6E.dhcp.stcd.mn.charter.com)
[04:02:34] <ferminter> Isn't rustpkg abandoned?
[04:03:16] <SiegeLord> It doesn't have a driver, but it's not really abandoned
[04:03:29] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[04:03:31] <_achin> it's resting.  untill someone can pick it up
[04:03:34] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Quit: )
[04:04:05] <dbaupp> People are submitting patches to it
[04:04:46] <dbaupp> (e.g. there are 3 with 'rustpkg' in the name currently in the queue.)
[04:05:07] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:05:17] <ferminter> Okay... so should it be used in a makefile or not? And a how should I fix one that does if I can't use rustpkg right now?
[04:05:17] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[04:05:28] <_achin> and i've got 1 or 2 in the works for cosmetic stuff
[04:05:53] <dbaupp> invoking rustc directly should be relatively simple
[04:06:30] *** Joins: pilf (pilf@moz-E8842E0A.dsl.bell.ca)
[04:06:45] <dbaupp> just have to work out the correct things to run it on, and provide any -L arguments to find other non standard crates that it depends on
[04:07:03] <ferminter> Oh yeah, it is here, but I think I might be running into a platform problem on rust-openssl
[04:07:32] <ferminter> When trying to build, I get "ssl\mod.rs:493:1: 501:2 error: not all trait methods implemented, missing: `eof`"
[04:10:25] <dbaupp> ah
[04:10:33] *** Quits: pilf (pilf@moz-E8842E0A.dsl.bell.ca) (Quit: pilf)
[04:10:45] <dbaupp> sounds like you're using a different Rust version to the one that rust-openssl is using
[04:10:50] <dbaupp> are you on 0.9?
[04:11:03] <ferminter> Yes.
[04:11:04] <dbaupp> (I'd guess rust-openssl is up-to-date with master)
[04:11:24] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[04:11:26] <ferminter> I'm actually about to compile that.
[04:11:53] <dbaupp> ah, yes, http://www.rust-ci.org/sfackler/rust-openssl says it's passing with the latest master
[04:11:54] <ferminter> I'll see if it compiles on mingw without modification.
[04:12:41] <ChrisMorgan> ferminter: to use rust-openssl you need to either find an old changeset that works on 0.9 (e.g. by bisecting) or upgrade your Rust.
[04:13:10] <ferminter> The later sounds better to me. I'll probably need master later anyway.
[04:13:12] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[04:13:19] <ChrisMorgan> Yes, you want it.
[04:14:42] *** Quits: Earnestly (earnest@moz-E86D50FA.dyn.plus.net) (Ping timeout)
[04:15:26] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[04:17:09] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[04:18:51] *** Joins: sellout1 (Adium@moz-76D71F1A.hlrn.qwest.net)
[04:18:51] *** Joins: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net)
[04:19:03] *** Quits: sellout (Adium@moz-76D71F1A.hlrn.qwest.net) (Connection reset by peer)
[04:19:30] <dbaupp> sfackler: what does mphf stand for?
[04:19:36] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[04:19:59] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[04:20:19] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[04:21:16] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[04:21:16] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[04:21:40] <sfackler> dbaupp: minimal perfect hash function
[04:21:57] <sfackler> (aka I couldn't think of a better name)
[04:22:02] <strcat> dbaupp: http://cmph.sourceforge.net/
[04:22:27] *** Quits: TylerE (Tyler@moz-6BD0CBDD.gvllcmtc01.gnvlnc.ab.dh.suddenlink.net) (Connection reset by peer)
[04:22:38] *** Joins: TylerE (Tyler@moz-6BD0CBDD.gvllcmtc01.gnvlnc.ab.dh.suddenlink.net)
[04:23:05] *** Joins: gverilla_ (gverilla@moz-5AD3DE14.versanet.de)
[04:24:01] *** Quits: gverilla (gverilla@moz-72C95702.versanet.de) (Ping timeout)
[04:24:30] <dbaupp> thanks
[04:25:11] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:27:11] *** Joins: espindola (espindola@3AA6F601.53AE8582.A535BD55.IP)
[04:27:47] <erickt> ooh, now that we got external syntax extensions, we could totally make a cmph macro! 
[04:28:16] <sfackler> erickt: https://github.com/sfackler/rust-mphf
[04:28:18] <sfackler> :D
[04:28:25] <erickt> wooo
[04:28:51] *** Joins: prooftechnique (prooftechn@moz-1C9C6B71.hsd1.vt.comcast.net)
[04:29:45] <sfackler> hmm, if I have a Path, is there a way to force it to contain a /?
[04:29:59] <sfackler> i.e. if I have Path("asdf"), make it Path("./asdf")
[04:30:19] <erickt> sfackler: hehe. Eridius have been working through paths a lot this week
[04:30:21] <sfackler> doing Path::new(".").join(p) seems to renormalize to p
[04:30:26] <erickt> sfackler: there isn't
[04:30:36] <sfackler> hmm
[04:30:41] <erickt> sfackler: got a use case?
[04:30:57] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[04:31:06] <erickt> sfackler: we were debating over whether or not paths should auto-normalize
[04:31:10] <sfackler> erickt: If you give dlopen a filename without a /, it searches the normal dynamic linker paths instead of checking the cwd
[04:31:21] <sfackler> I guess a workaround could be os::get_cwd().join(p)
[04:33:55] *** Quits: dmac (Adium@moz-99EF2EE6.hfc.comcastbusiness.net) (Quit: Leaving.)
[04:35:00] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:37:05] *** Joins: pilf (pilf@moz-E8842E0A.dsl.bell.ca)
[04:37:25] <sfackler> erict: linux will do the same thing for executables
[04:37:30] <sfackler> erickt: ^
[04:39:03] <erickt> thanks. I'll bring it up with Eridius when he gets back
[04:41:23] *** Quits: espindola (espindola@3AA6F601.53AE8582.A535BD55.IP) (Quit: Leaving...)
[04:41:31] *** Joins: kk (kk@moz-1E39CA0.delta15.maxonline.com.sg)
[04:47:22] *** Quits: yuriks_ (yuriks@8E8458DA.1755AC6C.F6EE4B40.IP) (Ping timeout)
[04:47:24] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[04:48:16] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[04:51:33] *** Quits: orospakr (orospakr@moz-A57EF4CD.cpe.net.cable.rogers.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[04:51:35] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[04:51:43] <erickt> sfackler: do you know if a syntax extension has access to the `extern mod` and `use`-ed items?
[04:52:09] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:52:09] *** ChanServ sets mode: +ao dherman dherman
[04:52:46] <strcat> erickt: you only get a token tree
[04:52:54] <strcat> foo!(what you get) ;p
[04:53:04] <sfackler> erickt: mphf_map!("foo" => 10) just expands into MphfMap { entries: &'static [("foo", 10)] }
[04:53:21] <sfackler> so the user will need to "use mphf::MphfMap"
[04:53:21] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[04:53:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[04:54:08] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[04:55:21] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[04:55:29] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[04:56:02] <erickt> sfackler: actually what I was thinking was pretty different :)
[04:56:25] <erickt> sfackler: are you familiar with spark?
[04:56:31] <sfackler> nope
[04:56:52] <erickt> sfackler: it's like hadoop: http://spark.incubator.apache.org/
[04:57:05] <erickt> it has a much more user friendly approach though
[04:57:40] *** Joins: yuriks (yuriks@8E8458DA.1755AC6C.F6EE4B40.IP)
[04:57:45] <erickt> their model is they ship off a fn to a cluster of machines
[04:58:13] <erickt> that's doable with a jvm or R or python
[04:59:10] <erickt> I'd like to make a binding for rust
[05:00:23] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[05:00:26] *** Joins: Cevn (sameer@moz-A91223EF.hfc.comcastbusiness.net)
[05:00:43] <Eridius> why doesn't bytes!() return a &'static [u8]?
[05:00:55] <Eridius> with niko's recent lifetime changes, some of my bytes!() no longer works properly
[05:00:59] <erickt> and I was thinking that there might be some way of writing a syntax extension that allows you to write a `map!(|x| x + 5)` and compile that proc into a separate binary and send it off to the cluster
[05:02:41] <sfackler> it'd probably be possible if you're careful
[05:03:03] <sfackler> sending the AST would allow you to avoid worrying about platform independence if you JIT it
[05:03:36] <erickt> I doubt we could get it quite as seamless as a JVM language, but it might be comparatively reasonable
[05:04:58] *** Quits: sehugg (sehugg@moz-42540923.res.bhn.net) (Quit: )
[05:05:27] <erickt> Eridius: I'm betting it's just an oversight. I think the very first implementation of bytes!() allowed you to write `~bytes!()` and produce a `~[u8]`
[05:07:07] *** Joins: robhobbes (Mibbit@moz-2741C540.slkc.qwest.net)
[05:07:56] <robhobbes> hey guys, I don't understand this error "cannot move out of dereference of & pointer"
[05:08:18] *** Quits: Kxepal (Miranda@moz-5483AA93.pppoe.mtu-net.ru) (Ping timeout)
[05:08:29] <Eridius> erickt: I'm wondering right now hard it is to make it equivalent to { static b: &'static [u8] = ...; b }
[05:08:36] <erickt> robhobbes: that's because a `&T` pointer is a borrowed pointer, it doesn't own the memory that is pointing at it
[05:08:38] <Eridius> too bad ExtCtxt doesn't have docstrings
[05:09:44] *** Quits: josh (josh@moz-4B9D2F6E.dhcp.stcd.mn.charter.com) (Quit: josh)
[05:10:11] <robhobbes> @erickt So how do I access it?
[05:10:14] <sfackler> Eridius: hah, I ran into the same thing an hour or so ago, where this doesn't work but I think it should: "struct Foo { f: &'static [int] } let f = Foo { f: &'static [10] };"
[05:10:16] <dbaupp> Eridius: that should be pretty easy
[05:10:33] <dbaupp> well, relatively easy
[05:11:07] <erickt> robhobbes: you need to have ownership of the type. So that's either a `~T` type, or an unannotated `T` type
[05:11:30] <robhobbes> can I get ownership somehow?
[05:11:51] <erickt> robhobbes: got an example I could see?
[05:11:54] <robhobbes> still trying to wrap my head around this ownership idea. I'm getting the hang of it a little bit
[05:11:57] *** Joins: Kxepal (Miranda@moz-B7304D9C.pppoe.mtu-net.ru)
[05:11:57] <robhobbes> um
[05:12:00] <robhobbes> sure
[05:12:03] *** Joins: lukem (Mibbit@moz-2B891F75.dyn.iinet.net.au)
[05:12:06] <strcat> erickt: ~T isn't really a special-case, it works exactly like a struct/enum
[05:12:07] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[05:12:13] <strcat> and can be defined in a library as one
[05:12:15] <robhobbes> erickt: is pastebin okay?
[05:12:18] <erickt> sure
[05:12:27] <strcat> &/&mut are the exception in the language - they are a non-owning view
[05:13:49] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[05:14:09] <robhobbes> @erickt: http://pastebin.com/H0n7tGJX (the offending lines are 41,42,and 43)
[05:14:17] <erickt> strcat: with @ on it's way out we only really have 4 things. Values, ~, &, and &mut :)
[05:14:20] <robhobbes> bah, keep using the @ sign...
[05:15:41] <strcat> erickt: well @ is feature gated already
[05:15:43] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[05:15:53] <strcat> erickt: ~ does have value semantics
[05:15:57] <strcat> it's not a reference type
[05:16:07] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[05:16:22] <erickt> robhobbes: so you don't need to move here. Instead, try writing `AbsolutePath(ref i`) => …`
[05:16:23] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[05:16:24] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[05:16:45] <robhobbes> erickt: okay, I'll try that. thanks
[05:16:58] <erickt> robhobbes: actually that won't quite work
[05:17:05] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[05:17:46] <erickt> robhobbes: because your variant arms would return different types. so do `match … { AbsolutePath(ref i) => println!("{}", i), AbsoluteUri(ref i) => println!("{}", i), …`
[05:17:48] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[05:18:11] <lukem> hey all, just looking for information on calling objectiveC code in rust. I see rust-cocoa (which I can't seem to compile) has some traits to allow you to go "NSObject".send("message", arg); but was wondering if there are other ways, more lik eyou would define the externs for a C API?
[05:18:34] *** Quits: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP) (Ping timeout)
[05:18:43] <erickt> yeah, that would have been a better thing to say
[05:19:38] <erickt> lukem: I don't think we can natively call Objective C methods
[05:20:59] <robhobbes> erickt: so with the different types... I was hoping to actually store the resulting string in a variable. I was wanting the server to do different things depending on the value of the path, perhaps depending on some "routes" file
[05:21:01] <erickt> lukem: it's an official mozilla project, so I'm sure they'd be pretty responsive to a bug ticket
[05:21:06] <lukem> erickt: ahh ok. Hence the crazy things rust-cocoa does, or is that actually not working yet?
[05:21:21] <lukem> yeh ok
[05:21:49] <erickt> lukem: I've got no experience with it, but I do know servo runs on the mac, so I think it must be working at some level
[05:22:44] <strcat> you're not going to be able to make FFI calls to ObjC, you have to actually send messages
[05:22:56] <strcat> ObjC method calls aren't static calls
[05:23:34] <strcat> very unlikely that rust will ever support function calls as sugar for that
[05:24:01] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[05:24:07] <erickt> robhobbes: you can use the `format!()` macro instead of `println!()` to make the strings you want
[05:24:12] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[05:25:04] *** Quits: dylukes (dylukes@39BBA869.27FF3780.8C677E46.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:25:40] <robhobbes> erickt: is there documentation on format!()? can you give me a link?
[05:25:51] <ferminter> So `@` is on it's way out?
[05:26:25] <strcat> ferminter: it's feature gated already
[05:26:41] <dbaupp> robhobbes: http://static.rust-lang.org/doc/master/std/fmt/index.html is the full docs
[05:27:20] <Eridius> robhobbes: http://static.rust-lang.org/doc/master/std/fmt/index.html
[05:27:21] <Eridius> damn
[05:27:25] <robhobbes> dbaupp: thanks
[05:27:27] <robhobbes> haha
[05:27:27] <ferminter> strcat: Where does it say that?
[05:27:30] <robhobbes> thanks guys
[05:27:40] <strcat> ferminter: try using it, it won't work
[05:27:48] <robhobbes> I always appreciate the help I get here, btw.
[05:27:56] <dbaupp> Eridius: I'm afraid you're gonna have to step up your game
[05:28:27] <erickt> robhobbes: also, I bet rust-http would also accept a `ToStr` impl and a `std::fmt::Default` impl for RequestUri pull request if you are interested
[05:28:32] <ferminter> strcat: Okay. I expected that to be in the tutorial. ^_^
[05:29:00] <strcat> the tutorial doesn't get updated much
[05:29:02] <dbaupp> ferminter: the tutorial hasn't been updated for the removal of @, unfortunately :(
[05:29:10] <strcat> much of the tutorial and manual are out-of-date
[05:29:50] <robhobbes> erickt: good point. If I can figure out how to do it make those additions in the right way, I'll totally submit a pull-request.
[05:31:46] <ferminter> So why is `@` being gated? Was it too confusing?
[05:32:44] <pnkfelix> ferminter: its because (1.) the current implementation does not behave the way people expect GC's to behave (w.r.t. asymptotic space consumption), and
[05:33:11] <strcat> it leaks cycles, as it's just a poor implementation of refcounting
[05:33:14] <lukem> ok thanks 
[05:33:18] <pnkfelix> ferminter: more importantly (2.) the semantics of things like how it interacts with Drop are almost certainly going to change from the current implementation, and we don't want people writing code that depends on the current behavior.
[05:33:35] <ferminter> That's a good explanation. Thank you pnkfelix.
[05:33:44] <strcat> and special-casing one of gc, atomic refcounting and refcounting doesn't make much sense
[05:33:45] <erickt> sfackler: Eridius just pointed out to me that dlopen shouldn't take a Path. For example, "@executable_path/foo/bar" is treated specially by dlopen
[05:33:50] *** Quits: robhobbes (Mibbit@moz-2741C540.slkc.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:33:59] <strcat> they should all have the same level of support with the same API
[05:35:03] <erickt> ferminter / pnkfelix: don't forget (3.) it turns out we can implement smart pointers in the library, so removing @ simplifies the compiler
[05:35:30] <strcat> erickt: gc still needs compiler support
[05:35:37] <strcat> it won't really simplify the compiler
[05:35:50] <pnkfelix> erickt: I've seen that claim many times, but it depends heavily on what you mean by "implement X in the library"
[05:35:52] <strcat> what it does do is put the various kinds of smart pointers on equal footing
[05:36:11] <strcat> there's really no reason why rust should be picking gc above refcounting and atomic refcounting and jamming it into the syntax
[05:36:23] <strcat> considering that it won't work in freestanding rust anyway
[05:37:15] <strcat> users will find it much harder to learn the hard-wired syntax way of doing things and the library smart pointer API compared to just one
[05:37:26] <pnkfelix> strcat: The behavior of Gc<T> with respect to finalizers may end up being different enough from Rc<T>, Arc<T>, etc, that I'm not sure it will be fair to say that Gc<T> will have the same "API"
[05:37:28] <strcat> unnecessary semantic/syntax complexity
[05:37:30] <erickt> strcat: would it be fair to say then it would simplify type checking, but gc would need support in trans?
[05:37:47] <strcat> erickt: it simplifies the syntax
[05:38:02] <strcat> I don't think type-checking cares
[05:38:14] <strcat> it's not really about difficulty of implementation
[05:38:39] <strcat> pnkfelix: well, Rc and Arc have semantic differences too (non-sendable vs sendable) but I just mean the method API
[05:38:47] <dbaupp> pnkfelix: are your finaliser ideas similar to the ones in the blog post you linked me a while ago?
[05:38:53] <dbaupp> umm...
[05:39:03] <pnkfelix> dbaupp: its sort of matured since then.
[05:39:05] <dbaupp> pnkfelix: ah, this one: http://blog.pnkfx.org/blog/2013/01/29/implicit-versus-explicit-finalization/
[05:39:20] <pnkfelix> dbaupp: I'll send you some notes from a recent conversation I had with nmatsakis
[05:39:27] <erickt> ooh a new blog to track
[05:39:31] <strcat> pnkfelix: like, treemaps and hashmaps have the same API, but treemaps provide stronger guarantees (ordered iteration, ordered set intersection, union, difference, symmetric difference)
[05:39:46] <pnkfelix> erickt: yeah, I need to post updates there more often
[05:40:12] <dbaupp> pnkfelix: ah, awesome :)
[05:40:13] <strcat> and Gc will *probably* not be considered an affine type
[05:40:30] <pnkfelix> strcat: So, in the abstract, treemaps require orderable keys and hashmaps require hashable ones.
[05:40:39] <pnkfelix> strcat: Doesn't that mean that they have different API's ?
[05:40:48] <strcat> pnkfelix: same method API, different trait bounds
[05:40:55] <strcat> they implement the same Map trait
[05:41:08] <strcat> TreeMap provides non-type-checked guarantees
[05:41:20] <strcat> so yes, the API is different
[05:41:25] <strcat> but they share a common API
[05:41:40] <pnkfelix> strcat: okay, if that's what you mean by "same the same API", then I can buy that Gc<T> and Rc<T> are similarly analogous
[05:41:49] *** Joins: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP)
[05:42:04] <strcat> pnkfelix: yeah, I don't mean they are identical
[05:42:12] <strcat> just that they are nearly drop-in replacements for each other
[05:42:30] <strcat> while having special-cased syntax in the language would make that harder
[05:42:47] <strcat> especially with something like @mut where a library can't implement something functioning like it did
[05:43:10] <strcat> since you either need closures or RAII reference wrappers in a lib
[05:48:51] <sfackler> erickt: I'm not seeing any reference to "@path" in the dlopen man pages. is it a windows thing?
[05:49:17] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[05:49:22] *** Quits: new_one (new_one@9C883110.CCA5821A.B3C0173E.IP) (Quit: leaving)
[05:49:38] <erickt> sfackler: I couldn't find documentation for it either, but I did find references to it on http://stackoverflow.com/questions/5399012/overriding-executable-path-in-a-dll-loaded-with-dlopen
[05:50:32] <erickt> sfackler: ah, it's in `man dyld`: https://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man1/dyld.1.html
[05:51:01] <erickt> sfackler: not sure if linux has something analogous
[05:52:45] <strcat> erickt: rpaths
[05:52:59] <strcat> https://en.wikipedia.org/wiki/Rpath
[05:53:27] <strcat> keep in mind that absolute rpaths are huge security holes and rust uses them on all binaries...
[05:53:52] <strcat> most linux distributions ban that as part of policy
[05:54:02] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[05:54:36] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[05:55:20] *** Quits: kk (kk@moz-1E39CA0.delta15.maxonline.com.sg) (Quit: Leaving)
[05:55:55] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Ping timeout)
[05:56:25] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[05:56:46] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[05:57:34] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[05:57:56] <olsonjeffery> does the wiki have info on third-party nightly builds of rust in one place? id like to be able to link to in, in line with encouraging users to just work from master, heh.
[05:58:11] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[05:58:33] <strcat> olsonjeffery: https://github.com/mozilla/rust/wiki/Doc-packages,-editors,-and-other-tools
[05:59:24] <olsonjeffery> huh. the nuget nightly isn't on there.
[05:59:52] *** Joins: benjamin_ (benjamin@moz-BEBA2A6F.dip0.t-ipconnect.de)
[06:01:43] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:02:19] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[06:02:19] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Connection reset by peer)
[06:03:01] <dbaupp> flaper87|afk: \o/
[06:03:13] *** Joins: Jesin (Jesin@moz-A43618DF.res.lehigh.edu)
[06:03:51] *** Quits: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP) (Ping timeout)
[06:04:08] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[06:05:08] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[06:07:00] *** Quits: Jesin (Jesin@moz-A43618DF.res.lehigh.edu) (Input/output error)
[06:08:43] <Eridius> dbaupp: ok, I got bytes!() to emit a &'static [u8]. It was anything but easy. Am I overlooking something? https://gist.github.com/kballard/8486852
[06:09:01] <dbaupp> Oh, geeez
[06:09:10] <Eridius> I had to construct a pretty crazy item for the static. Also, I threw in DUMMY_NODE_ID because I wasn't sure how to actually get a NodeId
[06:09:35] <dbaupp> Eridius: there's .ty_ident
[06:09:49] <dbaupp> (and yes, DUMMY_NODE_ID is the correct one to use at that point)
[06:10:36] <Eridius> dbaupp: does it look like I did things correctly? Should I comment this up and submit it?
[06:10:49] *** Quits: nham (Mibbit@moz-2C6185F8.lightspeed.dybhfl.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:11:34] <dbaupp> Eridius: that looks reasonable to me
[06:11:43] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[06:11:46] <Eridius> ok, thanks
[06:11:53] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[06:12:53] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[06:13:09] <erickt1> Eridius / sfackler: hrm. If Path::new("./foo") always gets translated into Path::new("foo") that could also be surprising to users of `std::run` since it uses `execvp` which will search PATH for the executable instead of the local directory if there is not a '/' in the path
[06:13:10] *** Quits: claudiu (claudiu@moz-6F0C4397.thefacebook.com) (Input/output error)
[06:13:31] *** Joins: claudiu (claudiu@moz-6F0C4397.thefacebook.com)
[06:13:46] <Eridius> erickt1: execvp shouldn't be taking a Path either
[06:13:47] *** Joins: heftig_ (heftig@moz-7C22D8AB.dip0.t-ipconnect.de)
[06:13:57] *** Quits: lukem (Mibbit@moz-2B891F75.dyn.iinet.net.au) (Quit: http://www.mibbit.com ajax IRC Client)
[06:14:34] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[06:14:53] <erickt1> Eridius: oh, it doesn't. But then it does take a `&str` which it probably shouldn't either
[06:15:04] *** Quits: heftig (heftig@moz-2C0ABEE2.dip0.t-ipconnect.de) (Ping timeout)
[06:15:11] <Eridius> erickt1: yeah it should take a &[u8]
[06:15:13] *** Quits: claudiu (claudiu@moz-6F0C4397.thefacebook.com) (Ping timeout)
[06:15:30] <Eridius> although for convenience it would be nice if it could take both. BytesContainer should be genericized
[06:17:02] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[06:18:04] *** Quits: prooftechnique (prooftechn@moz-1C9C6B71.hsd1.vt.comcast.net) (Quit: )
[06:18:39] *** Joins: lucian_ (lucian@moz-8408FDFA.cable.virginm.net)
[06:18:40] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Connection reset by peer)
[06:18:55] <erickt1> Eridius: given that we've got std::str::Str as a trait that abstracts working with str-like things, we could move and rename `BytesContainer` into `std::vec::Bytes` and change all these syscalls to use it
[06:19:32] <Eridius> erickt1: that's plausible. One worry I have is BytesContainer has a .is_str() method, which is an optimization
[06:19:38] <Eridius> I'm not sure it belongs in a generic version
[06:20:05] <dbaupp> https://github.com/mozilla/rust/pull/11001 seems ready to go, any last minute objections?
[06:20:24] *** Quits: lucian_ (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[06:21:16] <erickt1> dbaupp: that looks great
[06:21:24] <Eridius> hrm, I'm not convinced that every single instance of Iter/Iterator needs to be expunged from the naming. Just most of them.
[06:21:36] <Eridius> but w/e
[06:22:07] <pzol> if I have an enum like enum Species { Orc, Goblin } and being in another crate I import Species by use Species... then how can I also "import" the Orc and the Goblin to be visible?
[06:22:34] <strcat>  pzol you don't need 'use'
[06:22:35] <strcat> it's optional
[06:22:55] <strcat> foo::Species will work as the type
[06:23:00] <strcat> foo::Orc and foo::Goblin will work too
[06:23:14] <strcat> if you want to create shorter aliases in the current scope, you can 'use' any of them
[06:23:43] <Eridius> dbaupp: dammit! This new version of bytes!() doesn't work as the value for a constant!
[06:23:46] <Eridius> >_<
[06:23:56] <Eridius> curious error though. "constant contains unimplemented expression type"
[06:24:08] <pzol> strcat aa ok, thanks... I wanted to access Species::Orc which obviously doesn't work
[06:25:11] <sfackler> Eridius: I think the right fix is to fix the lifetime checker to get the current implementation to work
[06:25:23] <sfackler> in non-statics
[06:25:46] <Eridius> sfackler: the lifetime checker was just modified by nico which is what's causing this problem in the first place
[06:26:25] <sfackler> right
[06:26:47] <sfackler> so we should bug nmatsakis 
[06:27:08] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[06:27:29] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[06:27:30] <Eridius> sfackler: I think what we really need is simply the ability to say `&'static [1u8]`, then we can make bytes!() evaluate to that
[06:27:48] <Eridius> but right now the 'static seems to be ignored when I do that
[06:28:18] <erickt1> Eridius: I only see `BytesContainer::is_str` used in `Path::push_many`. We could change `Path::push_many` to take a `<T: Bytes + IsStr>` trait
[06:29:42] <Eridius> erickt1: where IsStr is a trait private to path?
[06:29:50] <erickt1> yeah
[06:29:53] <Eridius> I suppose that's doable, although it means keeping the implementations of InStr in sync with the implementations of Bytes
[06:30:50] *** Joins: b1nd (b1nd@E3D8A436.45A6FC61.475248F5.IP)
[06:35:30] <Eridius> sfackler: filed as https://github.com/mozilla/rust/issues/11641
[06:36:45] <sfackler> Eridius: https://github.com/mozilla/rust/issues/11640 :P
[06:39:23] *** Joins: jnsk (Mibbit@moz-829EE15C.dsl.static.sonic.net)
[06:39:30] *** Quits: b1nd (b1nd@E3D8A436.45A6FC61.475248F5.IP) (Ping timeout)
[06:40:15] <Eridius> sfackler: dammit! You posted that after I hit New Issue >_<
[06:40:19] *** Joins: b1nd (b1nd@moz-A52EB2E5.lnse1.ken.bigpond.net.au)
[06:40:33] <Eridius> I like your example of 'static being ignored better
[06:40:47] <jnsk> hello! quick question about ownership/borrowing
[06:41:05] <jnsk> when you say let x = &5, what is the owner of the memory where 5 was put?
[06:41:14] <Eridius> a temporary
[06:41:25] <jnsk> ah
[06:41:34] <jnsk> how can you determine the lifetime of the temporary?
[06:41:40] <jnsk> is it the exact same as x?
[06:41:45] <Eridius> hah, niko just changed lifetimes of stuff like this. So it's a bit in flux
[06:42:00] <jnsk> ooh haha okay
[06:42:54] <jnsk> so it'd be similar to doing
[06:43:03] <pnkfelix> jnsk: http://smallcultfollowing.com/babysteps/blog/2014/01/09/rvalue-lifetimes-in-rust/
[06:43:19] <jnsk> oh thank you
[06:44:48] *** Joins: pyon (user@A16F2BE6.A9B419CB.1C8C8CE9.IP)
[06:44:55] <dbaupp> jnsk: if you were going to say "it's similar to `let tmp = 5; let x = &tmp;`", I think that's correct
[06:45:56] <jnsk> yea that's what I was thinking
[06:46:17] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Input/output error)
[06:46:18] <jnsk> thanks for the help and the reading
[06:47:02] *** Quits: Cevn (sameer@moz-A91223EF.hfc.comcastbusiness.net) (Ping timeout)
[06:47:37] <ferminter> Building rust on MinGw is taking forever. Could we please have a nightly buildbot or something?
[06:48:11] <sfackler> ferminter: there is one on nuget
[06:48:19] <ferminter> There is?
[06:48:34] <sfackler> http://www.nuget.org/packages/Rust/
[06:48:35] <dbaupp> https://www.nuget.org/packages/Rust/
[06:48:55] * dbaupp is apparently security conscious
[06:49:09] <dbaupp> (they're not official nightlies, fwiw.)
[06:49:20] <ferminter> I don't use nuget though. And there's that other thing.
[06:50:16] <brson> nightly builds are coming in 0.10 hopefully
[06:53:51] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[06:54:29] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[06:56:07] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[06:56:07] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Connection reset by peer)
[06:56:16] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[06:58:27] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[06:58:31] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[07:03:16] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:04:56] <Yurume> brson, I have a document about the installation of Windows unofficial nightlies (https://gist.github.com/lifthrasiir/8386766). I thought we are not endorsing nightlies currently and therefore I didn't post it in the wiki, but it seems to be just a matter of officiality.
[07:06:03] <strcat> Yurume: when brson says nightly builds are coming, I think he means official ones
[07:06:15] <brson> Yurume: I'm happy to have unofficial binaries documented on the wiki
[07:06:21] <brson> but not in the main docs
[07:06:32] <brson> and yeah, there will be oficial nightlry binaries eventually
[07:06:50] <Yurume> strcat, yeah, I thought the core team is inherently against the nightlies
[07:07:05] <strcat> I don't think they are against them
[07:07:08] <Yurume> I'm glad that that was just my misunderstanding
[07:07:22] <strcat> just against endorsing binaries by random people with unknown security measures in place
[07:07:46] <Yurume> I already have a warning about that though.
[07:07:47] <diverse> brson: that will be cool
[07:08:24] <strcat> Yurume: issues in them are also not fixable
[07:08:37] <Yurume> right
[07:09:03] <strcat> if someone finds a bug in the official arch package for example, they can report it to the arch bug tracker - not the rust one
[07:09:26] <strcat> if someone finds a bug in the unofficial arch nightly I have on arch's build server, they can bug me but they have nowhere to really get 'official' support
[07:09:31] * strcat shrugs
[07:09:47] <strcat> (and by bug in the package I mean non-upstream bug)
[07:10:12] <diverse> assuming the arch devs do some special patching?
[07:10:36] <strcat> arch doesn't apply patches that aren't upstream
[07:10:40] <strcat> can still have packaging bugs
[07:10:59] <strcat> https://github.com/thestinger/packages/blob/master/rust-git/PKGBUILD here's the nightly pkg for example
[07:11:13] <strcat> not installing some new text editor's support would be a bug, as one example
[07:11:19] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[07:11:23] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[07:11:30] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[07:11:36] <diverse> strcat: ah
[07:12:47] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[07:13:38] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[07:15:21] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[07:16:20] <Yurume> brson, https://github.com/mozilla/rust/wiki/Doc-how-to-install-an-unofficial-nightly-for-Windows
[07:16:21] *** Joins: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP)
[07:19:24] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[07:20:02] <ferminter> For future reverence reference, is there a tool that updates old rust code to the standards of a more recent version where reasonable?
[07:20:03] *** Joins: deen (deen@moz-7B78EB6B.dip0.t-ipconnect.de)
[07:20:15] <ferminter> --reverence---
[07:20:27] <strcat> no
[07:20:40] *** Quits: deen_ (deen@moz-E59E3C65.dip0.t-ipconnect.de) (Ping timeout)
[07:20:55] <ferminter> Darn.
[07:21:00] <ferminter> I might work on that.
[07:21:04] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[07:21:19] <ferminter> Would anyone use it, or is that just me?
[07:21:58] <madmoose> It seems popular in the Go community.
[07:22:31] <strcat> ferminter: it's too early to stall changes on adding support to a migration tool
[07:22:47] <ferminter> strcat: Never said anything about that.
[07:23:13] <strcat> well, that's what needs to happen to make it useful ;p
[07:23:23] <strcat> eventually it can
[07:23:51] <ferminter> I'd probably be more like me struggling to keep day every time there's a few new commits. 
[07:24:02] <ferminter> *keep up
[07:24:07] <strcat> the language doesn't have version markers and there are often 2-4 part changes
[07:24:11] <strcat> a -> b, b -> c
[07:24:21] <strcat> then c -> a after a snapshot
[07:25:41] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[07:28:26] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[07:29:46] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[07:30:53] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[07:33:32] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[07:35:49] *** Parts: kvanb (kvanb@moz-76614EE8.lns7.lon.bigpond.net.au) ()
[07:36:53] *** Joins: daschl (Adium@moz-DC6DE6E2.vie.surfer.at)
[07:38:13] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[07:38:23] *** Quits: ferminter (Mibbit@moz-3213C615.wavecable.com) (Quit: http://www.mibbit.com ajax IRC Client)
[07:42:50] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[07:43:57] *** Joins: kvanb (kvanb@moz-76614EE8.lns7.lon.bigpond.net.au)
[07:46:14] <wycats_> the macro loading eagle has landed
[07:47:41] <wycats_> sfackler: can haz loadable-deriving now?
[07:50:54] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Ping timeout)
[07:51:46] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[07:52:03] *** Quits: Sharp (Sharp@moz-EEC85237.hsd1.ca.comcast.net) (Ping timeout)
[07:53:38] <brson> here's an easy 1.0 bug for aspiring rustc hackers: https://github.com/mozilla/rust/issues/10877
[07:53:43] <brson> maybe somebody can sign up to mentor
[07:53:59] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[07:55:09] *** Quits: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP) (Ping timeout)
[07:56:00] *** Quits: pnathan (Adium@moz-A8921E45.tukw.qwest.net) (Quit: Leaving.)
[07:58:51] *** Quits: leroux (leroux@moz-421CF1E4.dsl.bell.ca) (Client exited)
[08:00:41] *** Joins: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP)
[08:02:24] *** Joins: cenphol (acrichton@47FEC4E3.FD743851.1428D117.IP)
[08:03:40] *** Joins: valve (chau@moz-C80B246.dip0.t-ipconnect.de)
[08:03:47] *** Parts: valve (chau@moz-C80B246.dip0.t-ipconnect.de) (Leaving)
[08:03:50] *** Quits: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au) (Quit: http://www.mibbit.com ajax IRC Client)
[08:04:02] *** Joins: valve (chau@moz-C80B246.dip0.t-ipconnect.de)
[08:04:08] *** Joins: eibwen (kvirc@moz-166DC175.dip0.t-ipconnect.de)
[08:04:19] <valve> sorry, but where is Rust game channel ?
[08:04:47] <dbaupp> valve: no idea, but not here :)
[08:04:59] <valve> dbaupp, weird
[08:08:07] *** Joins: mib_wxx20y (Mibbit@47DA9FE2.CA444390.DB1075D2.IP)
[08:08:51] *** Quits: mib_wxx20y (Mibbit@47DA9FE2.CA444390.DB1075D2.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:10:43] *** Quits: jnsk (Mibbit@moz-829EE15C.dsl.static.sonic.net) (Quit: http://www.mibbit.com ajax IRC Client)
[08:11:43] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[08:14:00] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Ping timeout)
[08:14:23] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[08:14:33] *** Quits: daschl (Adium@moz-DC6DE6E2.vie.surfer.at) (Quit: Leaving.)
[08:14:34] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[08:14:56] *** Parts: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) ()
[08:14:58] <Tobba> valve: try #playrust?
[08:15:03] *** Parts: cenphol (acrichton@47FEC4E3.FD743851.1428D117.IP) (WeeChat 0.4.2)
[08:15:56] <valve> Tobba: empty channel
[08:16:04] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[08:16:11] <Tobba> actually better question: why are you checking on moznet
[08:16:14] <Tobba> try freenode
[08:16:25] <valve> freenode channel told me to go here
[08:16:54] <Tobba> try #playrust on freenode/rizon/quakenet
[08:16:57] <Tobba> because this is hilariously wrong
[08:17:02] <valve> Topic for #rust is: This is NOT the official Rust channel! See #rust on irc.mozilla.org for that. You'll get help much faster.
[08:17:04] <valve> yup
[08:17:31] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[08:17:33] *** Quits: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[08:18:20] <zxcdw> valve: Try quakenet
[08:18:34] <valve> okay 
[08:18:42] <zxcdw> Weird that in 2014 somebody expects to find a channel for an online game :)
[08:18:50] <Tobba> well it has a subrediit
[08:18:52] <Tobba> and its quite popular
[08:19:01] <zxcdw> Well, but IRC, 2014.. :)
[08:19:02] <zxcdw> Not 2004
[08:19:17] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[08:19:18] <Tobba> hahahaha yes
[08:19:27] <Tobba> why did garry have to name his game the most confusing thing though
[08:19:48] <Tobba> this is asinine
[08:19:55] <mcpherrin> is it the same garry as garry's mod?
[08:19:59] <Tobba> yep
[08:20:09] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[08:20:11] <zxcdw> Oh, a fun fact then
[08:20:15] <Tobba> or well, facepunch studios, since they're a proper game studio now
[08:20:26] <mcpherrin> I played garry's mod ages ago
[08:20:34] <mcpherrin> I think I got it in some indie bundle 
[08:20:38] <mcpherrin> recently, the new version
[08:20:41] <mcpherrin> I should play again.
[08:20:45] <Tobba> heh
[08:20:55] <zxcdw> Wasn't facepunch some online community too? Or is it the same thing?
[08:20:58] *** Quits: valve (chau@moz-C80B246.dip0.t-ipconnect.de) (Quit: Leaving)
[08:20:59] <dbaupp> valve: (if it's not clear, this and the freenode channel are for the Rust programming language.)
[08:21:06] *** Joins: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP)
[08:21:09] <mcpherrin> there's a freenode #rust? woah.
[08:21:10] <Tobba> facepunch.com is a massive forum now
[08:21:15] <mcpherrin> is it worth being in?
[08:21:18] <Tobba> it used to just be the forum for basicaly gmod support
[08:21:32] <dbaupp> mcpherrin: it redirects people here
[08:21:35] <Tobba> now its basicaly a smaller somethingawful, although considerably more awful
[08:21:42] <mcpherrin> dbaupp: oh well then.
[08:21:45] <zxcdw> mcpherrin: Well, some 80+ users it seems
[08:21:54] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[08:23:18] <strcat> mcpherrin: it's technically against freenode policy as it isn't the official channel
[08:23:33] <Tobba> no reason not to have it just to redirect people though
[08:23:40] <Tobba> people tend to try freenode first for this kinda stuff
[08:23:42] <strcat> the correct name would be ##rust
[08:23:53] <mcpherrin> strcat: yeah but does anybody realllly follow those rules :p
[08:24:04] <strcat> mcpherrin: yes, they usually do
[08:24:12] <mcpherrin> strcat: I mean enforce*
[08:24:30] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[08:24:33] <mcpherrin> lots of people follow the rules, sure
[08:24:42] <strcat> they're enforced if someone asks an ircop to enforce it afaik
[08:26:13] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Quit: Leaving.)
[08:29:28] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[08:32:01] *** Joins: daschl (Adium@moz-DC6DE6E2.vie.surfer.at)
[08:38:41] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Connection reset by peer)
[08:38:41] *** Quits: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP) (Ping timeout)
[08:38:42] *** Quits: rootnode (rootnode@moz-7FAB5E8.ip1.george24.com) (Connection reset by peer)
[08:38:42] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Connection reset by peer)
[08:38:43] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[08:38:49] *** Quits: dcolish (dcolish@1DB472A5.BE69FB10.416A0103.IP) (Ping timeout)
[08:38:49] *** Quits: GeorgeH_ (George@moz-FB5F2302.hsd1.nj.comcast.net) (Ping timeout)
[08:38:49] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Ping timeout)
[08:38:54] *** Joins: rootnode (rootnode@moz-7FAB5E8.ip1.george24.com)
[08:39:01] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[08:39:14] *** Joins: dcolish (dcolish@1DB472A5.BE69FB10.416A0103.IP)
[08:39:22] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[08:39:26] *** Joins: GeorgeH_ (George@moz-FB5F2302.hsd1.nj.comcast.net)
[08:41:00] *** Quits: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net) (Ping timeout)
[08:41:01] *** Joins: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net)
[08:42:12] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[08:43:01] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:44:27] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[08:44:56] *** Joins: jackneill (jackneill@moz-E9D68037.pool.digikabel.hu)
[08:45:06] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:46:13] *** Quits: daschl (Adium@moz-DC6DE6E2.vie.surfer.at) (Quit: Leaving.)
[08:53:23] <ChrisMorgan> nmatsakis: these lifetime changes seem to have broken a very common usage of bytes!: https://travis-ci.org/chris-morgan/rust-http/builds/16894590
[08:53:48] <ChrisMorgan> e.g. `match x { Y => bytes!("Y"), Z => bytes!("Z") }` no longer works.
[08:54:32] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[08:55:20] *** Joins: daschl (Adium@moz-DC6DE6E2.vie.surfer.at)
[08:55:22] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:55:40] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[08:56:56] <ChrisMorgan> (For reference, bytes!("x") expands to &[120u8].)
[08:57:21] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[08:57:28] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[08:58:10] *** Joins: ssbr (~ssbr@moz-8EC4F450.lightspeed.sntcca.sbcglobal.net)
[08:58:26] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[08:58:46] *** Quits: canhtak (canhtak@moz-4B5B3414.wl.t.ulaval.ca) (Quit: canhtak)
[09:01:16] * ChrisMorgan must now rebuild Rust for comparison
[09:01:37] *** Quits: daschl (Adium@moz-DC6DE6E2.vie.surfer.at) (Quit: Leaving.)
[09:01:51] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[09:02:24] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[09:02:42] <eibwen> how do you open a file in rust?
[09:04:17] <eibwen> ah, I foudn std::io
[09:04:45] <dbaupp> ChrisMorgan: there's two bugs about that
[09:05:07] <dbaupp> ChrisMorgan: https://github.com/mozilla/rust/issues/11641 and https://github.com/mozilla/rust/issues/11640
[09:05:16] <ChrisMorgan> dbaupp: yep, I'd just found https://github.com/mozilla/rust/issues/11641 ☺
[09:05:34] *** Joins: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de)
[09:06:48] <ChrisMorgan> Ah well, rust-http ain't working on master for the moment.
[09:07:30] <ChrisMorgan> But I'm seriously concerned that that landed with such a fault—is there really nothing in the test suite that caught it?
[09:07:46] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[09:08:05] <dbaupp> apparently
[09:08:34] <TheHydroImpulse> ChrisMorgan which concurrency method does rust-http use? Does it use green or native?
[09:08:42] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[09:08:42] <ChrisMorgan> I say that of both of them—#11640 the more serious omission.
[09:09:00] <ChrisMorgan> TheHydroImpulse: up to you. It's just a library using libstd.
[09:09:31] <TheHydroImpulse> ChrisMorgan oh cool. Thanks
[09:09:38] <ChrisMorgan> TheHydroImpulse: any code which does not explicitly reference libgreen or libnative should work with either.
[09:10:50] <TheHydroImpulse> awesome
[09:11:56] <dbaupp> (although libnative is still missing a few things, so some programs will fail with "unimplemented" errors.)
[09:12:50] <ChrisMorgan> There are also other minor issues in libnative: the socket closing, for example, does not reportedly work consistently, so if you restart a rust-http server immediately the port may still be bound and you would need to wait for a timeout (or kill the phantom somehow, I don't know how that's done).
[09:13:28] *** Joins: benjamin__ (benjamin@moz-8E8A89E3.dip0.t-ipconnect.de)
[09:13:38] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[09:13:50] <TheHydroImpulse> ChrisMorgan good to know. Have you benchmarked rust-http using both methods? I heard libnative has much better performance in some situations. 
[09:14:15] *** Quits: benjamin_ (benjamin@moz-BEBA2A6F.dip0.t-ipconnect.de) (Ping timeout)
[09:14:34] <ChrisMorgan> I haven't benchmarked it with libnative, but someone did (I think it was cmr) and reported significantly better results, which took it distinctly ahead of Go.
[09:15:11] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[09:15:30] <TheHydroImpulse> oh cool. Thanks
[09:15:59] <ChrisMorgan> Found it: https://gist.github.com/cmr/39b82d46d6e10038f08c for libgreen and https://gist.github.com/cmr/00e196c8b842a2042ac5 for libnative (note some are missing because of the connection closing problem)
[09:16:13] <ChrisMorgan> (Higher is better.)
[09:16:40] <ChrisMorgan> And the changes to make it use libnative instead of libgreen: http://ix.io/9PS/diff
[09:17:04] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[09:17:59] <TheHydroImpulse> damn. That's pretty impressive. 
[09:18:40] *** Joins: Ms2ger (Ms2ger@53A418F8.CD932C3B.187A1082.IP)
[09:19:00] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[09:19:40] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[09:20:44] *** Joins: jestan (Mibbit@5D7658E.5F8DC0CF.EB06F97B.IP)
[09:20:53] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[09:21:24] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[09:22:29] <ChrisMorgan> TheHydroImpulse: bear in mind that rust-http is not complete and it is a low level thing. By the time it is complete and has a higher level layer on top of it, it *will* be slower. All else remaining constant, it won't be defeating Go *quite* so conclusively, though I still have good reason to expect it to be distinctly faster.
[09:22:45] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[09:23:26] <ChrisMorgan> Also I don't expect all else to remain constant—there are still doubtless performance optimisations that can take place in libnative and in rust-http.
[09:24:13] *** Quits: jestan (Mibbit@5D7658E.5F8DC0CF.EB06F97B.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:25:18] <strcat> ChrisMorgan: libnative is just providing the OS APIs
[09:25:40] <strcat> you could write the code in C or C++ and see if it really contributes any perf overhead
[09:25:51] *** Joins: mentero (mentero@moz-D61C6F02.proxnet.pl)
[09:25:58] <ChrisMorgan> strcat: well, very close to it, anyway. I think there's probably a little more juice that can be squeezed out of it somewhere in libnative and in Rust itself.
[09:26:03] <strcat> I doubt it has any significant overhead in terms of performance, but rather just significant size overhead from indirection
[09:26:30] <strcat> ChrisMorgan: there are certainly faster concurrency primitives
[09:26:30] <ChrisMorgan> strcat: when you're going all out for performance, 0.1% overhead is significant!
[09:26:41] <strcat> but talking strictly about I/O, it's just making calls to the low-level functions
[09:26:58] <strcat> so you can use memory-mapped I/O for files and get a huge speed-up
[09:27:05] <strcat> but there's no 'green' equivalent
[09:27:07] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[09:27:27] <ChrisMorgan> When I get to things like file serving I'll probably care about that.
[09:27:54] <strcat> ChrisMorgan: and sendfile, etc.
[09:27:54] <ChrisMorgan> Just at present TCP streams are the only really important part of I/O for me.
[09:27:56] <strcat> anyway
[09:28:19] <ChrisMorgan> Yeah, lots of good stuff for later ☺
[09:28:37] <strcat> ChrisMorgan: you won't get high-level memory mapped I/O from libstd as long as libgreen is around afaik
[09:28:58] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[09:29:09] <strcat> although, libgreen also can't handle a task deciding to do CPU work for a while
[09:29:14] <strcat> so blocking on page faults isn't really unique
[09:29:31] <strcat> ChrisMorgan: anyway I wouldn't expect libnative to gain much speed, is all ;p
[09:29:38] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[09:29:39] <strcat> for I/O
[09:30:16] <ChrisMorgan> It's busy confirming Rust as a nice fast high-level systems programming language ☺
[09:30:21] <strcat> can have way faster channels, and it could have better primitives for some patterns (multiple consumer queues), data structures that are more suitable in some cases, etc.
[09:30:30] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[09:30:50] <strcat> a bounded, non-blocking channel can be insanely faster ;p
[09:30:59] <eddyb> acrichto: why can't we just make the task interface an immutable static containing a &'static mut Trait?
[09:31:09] <eddyb> strcat: same for the default allocator in rust-core
[09:31:09] <strcat> but non-blocking is really a pain
[09:31:10] *** Joins: oberstet (quassel@moz-AA658818.dynamic.mnet-online.de)
[09:31:20] *** Quits: jsonnull (Thunderbir@E86DD23.582C899D.494A0F8B.IP) (Ping timeout)
[09:31:23] <eddyb> I believe weak trait references can be easily devirtualized
[09:31:35] <eibwen> what is green vs native?
[09:31:40] *** Joins: jsonnull (Thunderbir@E86DD23.582C899D.494A0F8B.IP)
[09:31:43] <strcat> eddyb: green/native are dynamic though
[09:31:44] <eddyb> inlined allocator without writing malloc/realloc/free
[09:31:50] *** Joins: mib_flkm2t (Mibbit@5D7658E.5F8DC0CF.EB06F97B.IP)
[09:31:54] *** Quits: hdevalence (quassel@moz-D125A39F.home3.cgocable.net) (Ping timeout)
[09:32:01] <eddyb> strcat: hmpf, can't we optimize the situation where they aren't used dynamically?
[09:32:06] <strcat> eddyb: you can have mixed native/green tasks
[09:32:16] <strcat> eddyb: it doesn't know if you do
[09:32:20] <strcat> dlopen rust lib
[09:32:23] <strcat> start using libgreen
[09:32:44] <strcat> unless it's an actual statically linked binary (which AFAIK rustc doesn't produce)
[09:32:56] *** Quits: mib_flkm2t (Mibbit@5D7658E.5F8DC0CF.EB06F97B.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:32:59] * strcat tries
[09:33:19] <dbaupp> Aren't the 'rlib' based binaries statically linked?
[09:33:35] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Connection reset by peer)
[09:33:35] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[09:34:01] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[09:34:04] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[09:34:05] <strcat> eddyb: any allocator with good handling of fragmentation, good time bounds and low memory overhead will be too large to inline ;p
[09:34:13] *** Quits: mentero (mentero@moz-D61C6F02.proxnet.pl) (Connection reset by peer)
[09:34:14] <strcat> eddyb: can certainly make a better allocator interface than malloc/free/realloc
[09:34:19] <eddyb> strcat: yes!
[09:34:23] <strcat> you want free and realloc to take a parameter with the old size
[09:34:37] <strcat> realloc and malloc should return the real allocated capacity
[09:34:46] <eddyb> strcat: thing is, allocators with size classes can benefit from inlining *up to a point*
[09:34:59] <strcat> malloc/realloc should have a parameter to ask for zeroed memory for the new part (not just calloc)
[09:35:11] <eddyb> I managed to force the inlining boundary such that any statically-sized allocation was one call without arguments :)
[09:35:38] <strcat> and you can have dynamic user-defined arenas like jemalloc...
[09:35:38] <ChrisMorgan> strcat: just at present rust-http is a thin layer on top of a TCP stream. Unfortunately it's not going to remain that way because of HTTP/1.1 pipelining and (more importantly) HTTP/2.0 with its multiple-simultaneous-requests-and-responses-per-stream multiplexing. Channels et al. will be important to rust-http performance also.
[09:36:11] <eddyb> strcat: I will try to implement the weak trait thing in rust-core when I get some time
[09:36:28] <strcat> ChrisMorgan: fast channels are arrays
[09:36:34] <strcat> the fastest ones won't support blocking
[09:36:50] <eddyb> acrichto: also, I want to rewrite std::fmt to use my string builder optimization for format! (and maybe optimize the case where the Writer type is known)
[09:36:52] <strcat> and if they aren't using a lock, they'll be bounded
[09:37:33] <strcat> although for multiple-producer/multiple-consumer, AFAIK you need double-word atomics for unfair and locking for fair
[09:37:36] * strcat shrugs
[09:37:42] * ChrisMorgan just needs speed. Speed. SPEED! SPEEEEED! ☺
[09:38:07] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Quit: Konversation terminated!)
[09:38:13] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[09:38:13] <strcat> ChrisMorgan: are you okay with having a timeout? as in, connections time out after 300s of waiting
[09:38:26] <dbaupp> eddyb: what's your string builder opt?
[09:38:36] <strcat> ChrisMorgan: or something smaller
[09:39:01] <eddyb> dbaupp: allocate once, at the deepest point of a recursion, instead of reallocating multiple times
[09:39:18] <eddyb> dbaupp: I've mentioned it a few times
[09:39:35] <dbaupp> well clearly I haven't been listening well enough
[09:39:36] <ChrisMorgan> strcat: methinks this discussion is a little too detailed for just at present given how far away the readiness for such optimisations is. I might get back to you in a few months or so!
[09:39:49] <dbaupp> how do you get away with only allocating late?
[09:40:09] <eddyb> dbaupp: by recursing to find the total length
[09:40:11] <strcat> ChrisMorgan: well this is less an optimization and more of a random other topic ;p
[09:40:25] <eddyb> dbaupp: when you go back up, you insert all the pieces
[09:40:28] <dbaupp> eddyb: hm... doesn't that mean you recur twice?
[09:40:28] <ChrisMorgan> strcat: oh, it'll become an optimisation question eventually.
[09:40:33] <eddyb> dbaupp: nope :)
[09:40:33] <dbaupp> oh... weird
[09:40:51] <eddyb> it's probably the fastest way you can do it. I haven't yet been told of anything similar
[09:41:20] <strcat> ChrisMorgan: there is certainly a lot of low-hanging fruit
[09:41:22] <eddyb> I mean, Haskell could have this pattern in 20 characters and ignore its importance
[09:41:27] <strcat> most of libstd is pretty slow
[09:41:30] <strcat> vectors
[09:41:35] <strcat> need to do *something* about hash tables
[09:41:41] <strcat> need to make std::trie not totally naive
[09:42:03] <strcat> and do something about trie/treemap in general due to the huge hit they pay to be safe code atm...
[09:42:24] <strcat> ring buffers basically depend on vector perf, as does the priority queue
[09:42:34] <strcat> well, the ring buffer in extra is slow
[09:42:49] <strcat> 2x as much memory usage, initializes eagerly, etc.
[09:43:08] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[09:43:40] * ChrisMorgan loves it when "super slow" and the likes mean "only twice as fast as Python/Ruby/JavaScript and using fully a quarter of the memory that they would"
[09:43:49] <strcat> ChrisMorgan: well
[09:43:51] <strcat> in this case
[09:44:05] <strcat> 'slow' means a hundred times faster than python/ruby/javascript
[09:44:08] * ChrisMorgan picks arbitrary meaningless figures and makes a statement which is false in various situations but is at least sometimes true
[09:44:27] <strcat> rust's vector is a fair bit slower than libstdc++'s vector
[09:44:31] <strcat> which is itself pretty bad
[09:44:39] <strcat> because C++ doesn't give it a lot to work with
[09:44:46] <eddyb> dbaupp: "Hello World, I have ".fmt_default(fmt::StringFormatter::new(), |f| 3.fmt_unsigned(f, |f| " wishes for you".fmt_string(f, |f| f.finish()))) == ~"Hello World, I have 3 wishes for you"
[09:44:47] <strcat> it can't even use realloc
[09:44:51] *** Joins: Matthias247 (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de)
[09:45:08] <strcat> libc++ vector is faster
[09:45:34] <strcat> rust-core's dead simple vector is much better than both and could be optimized a lot more via integration with an allocator ;p
[09:45:34] <eddyb> dbaupp: from format!("{}{:u} wishes for you", "Hello World, I have ", 3);
[09:46:20] <dbaupp> eddyb: the closures may kill it (for the moment)
[09:46:30] <eibwen> rusti: ""
[09:46:35] -rusti- ""
[09:46:36] *** Quits: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net) (Quit: zztr)
[09:47:08] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[09:47:15] <eddyb> dbaupp: replace StringFormatter with DynWriterFormatter and it works with &mut Writer, no intermediary allocations (but a virtual call for every write)
[09:47:55] <eibwen> strcat: vector does a bounds-check on every access, that'd be inherently slower than C++'s vectors
[09:48:04] <dbaupp> strcat: you/we could submit Vec<T> upstream, since ~[T]
[09:48:05] <strcat> eibwen: there are unchecked methods
[09:48:10] <dbaupp> eibwen: that's not the fundamental problem
[09:48:15] <dbaupp> *since ~[T] is changing
[09:48:19] <strcat> eibwen: compare 1:1...
[09:48:22] <eibwen> isn't branching the most fundamental problem?
[09:48:26] <strcat> std::vector::at exists
[09:48:28] <strcat> eibwen: no
[09:48:32] <strcat> it's not a problem, there are unchecked methods
[09:48:45] <eibwen> most of the time, you'll find yourself using the checked methods
[09:48:55] <eibwen> do the iterators use the unchecked methods?
[09:48:59] <strcat> no
[09:49:02] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:49:06] <strcat> iterators don't use indexing
[09:49:20] <strcat> checked or unchecked
[09:49:34] <strcat> eibwen: it doesn't matter what you use most of the time, because the unchecked methods are there
[09:49:36] <dbaupp> the problem is the data layout of the vectors: they're currently *{length, capacity, data...}
[09:49:40] <strcat> when you care about performance, they are there
[09:49:48] <strcat> you can use std::vector::at in C++
[09:49:55] <strcat> I don't care about apples to oranges comparisons
[09:50:00] <eddyb> idiomatic Rust can be safer and faster than C++
[09:50:05] <strcat> I care about push being 6x faster than it is now
[09:50:06] <dbaupp> C++ uses (and so should we) {length, capacity, *data...}
[09:50:43] <strcat> well, most C++ implementations do that
[09:50:45] <eddyb> under DST, ~[T] or Uniq<[T]> is an owned slice, so we will need Vec<T>
[09:50:45] <strcat> because it's sane ;p
[09:51:08] <strcat> dbaupp: it's really { allocator, capacity, length, *data } at least for C++11
[09:51:26] <strcat> but they probably optimize it away 
[09:51:33] <strcat> likely manually in the library code
[09:51:39] <dbaupp> strcat: true, but that's a detail that isn't totally relevant to this discussion :)
[09:51:39] <strcat> rust has zero-size types so it doesn't matter
[09:51:40] <eddyb> allocator is zero-sized most of the time, isn't it?
[09:51:51] <strcat> eddyb: C++ doesn't have zero-size types
[09:51:52] <eddyb> oh, right, C/C++ are dumb in that regard, I forget :P
[09:51:54] <dbaupp> C++ doesn't have zero-sized types?
[09:51:57] <strcat> dbaupp: no
[09:52:05] <dbaupp> not even say, int[0]
[09:52:07] <dbaupp> ?
[09:52:30] <eddyb> dbaupp: it's about out-of-bounds nonsense
[09:53:46] <strcat> dbaupp: that's a pointer though
[09:53:59] <strcat> not int*, but what it *is* is a pointer
[09:54:03] <eddyb> strcat: inside a structure
[09:54:10] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[09:54:19] <strcat> inside a structure as the last field for a variable-size type?
[09:54:22] <strcat> undefined behaviour
[09:54:22] *** Joins: claudiu (claudiu@moz-D5BFAAB5.hsd1.ca.comcast.net)
[09:54:35] <strcat> struct foo { int x; int y[]; } is valid C99 though
[09:54:41] <strcat> but I don't think it is valid C++, I may be wrong
[09:54:51] <strcat> they included some but not all of C99 in C++11
[09:55:05] <eddyb> dbaupp: thanks for https://github.com/mozilla/rust/pull/11217#issuecomment-32662565 :D I didn't think of the HashMap example, it's pretty ridiculous
[09:55:07] <strcat> no restrict, no variable-size arrays (although they are added in C++14), etc.
[09:55:09] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[09:55:32] <strcat> dbaupp: *shrug* ;p
[09:56:14] <eddyb> strcat: I want numbers in generics so I can do StackBackedVec<T, N> that is a growable vector with a fixed capacity N
[09:56:14] <dbaupp> strcat: so, is GCC lying when it says that `zero` is zero-sized for http://ix.io/9Xe/c ?
[09:56:26] <dbaupp> eddyb: np
[09:56:29] <strcat> dbaupp: int a[3] is a ptr
[09:56:40] <eddyb> dbaupp: taking a pointer to a zero-sized structure is UB-ish
[09:56:41] <strcat> int a[0] is a pointer too afaik
[09:56:49] <eddyb> dbaupp: it's inside whatever comes after it
[09:56:53] <strcat> it will coerce to int*
[09:56:57] <strcat> or degrade to it
[09:57:01] <strcat> depends on where it is
[09:57:49] <eddyb> I remember strcat mentioned two LLVM pointer usage modes, only one of them supporting zero-sized structures
[09:58:00] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[09:58:10] *** Quits: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[09:58:28] <dbaupp> Ah, -pedantic gives "warning: ISO C forbids zero-size array ‘x’"
[09:58:31] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Ping timeout)
[09:58:56] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Quit: Leaving.)
[09:59:22] <strcat> dbaupp: afaik, standard C/C++ requires that every value be uniquely addressable
[09:59:58] <dbaupp> Yeah, my brief googling just now seems to confirm that
[09:59:58] <strcat> dbaupp: empty union/struct is invalid, didn't know that 0-size arrays were but apparently they are!
[10:00:12] <dbaupp> anyway, back to our regularly scheduled Rust. :P
[10:01:29] <strcat> meh
[10:01:34] <strcat> freestanding rust did stop working
[10:02:10] <dbaupp> :(
[10:02:19] <dbaupp> the thing about eh_personality?
[10:02:33] <strcat> yes
[10:02:50] <eddyb> I wish I could just... disable things
[10:03:14] <eddyb> oh, oh, almost forgot (so many things to remember, so many things </gollum>)
[10:03:18] <strcat> so is iter being renamed to items?
[10:03:32] <eddyb> strcat: and add .values()? that sounds decent
[10:03:33] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[10:03:40] <dbaupp> It happened
[10:03:42] <strcat> I'm just asking if that's the plan
[10:03:45] <strcat> dbaupp: nope
[10:03:49] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[10:03:55] <strcat> dbaupp: VecIterator -> Items but the method is called iter
[10:03:55] <dbaupp> oh, the methods, you mean?
[10:03:57] <strcat> yes
[10:04:13] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[10:04:33] *** Joins: TisButMe (Mibbit@moz-85E31F67.w109-212.abo.wanadoo.fr)
[10:04:43] <eddyb> is there any point in having @T allocations go through a LocalHeap?
[10:04:51] <strcat> it adds a header
[10:04:52] <pzol> What data structure would be most efficient to represent a 3d (cube) map for a game? 
[10:05:01] <strcat> pzol: is it fixed in size after creation?
[10:05:08] <pzol> strcat yes
[10:05:42] <eddyb> [[[T, ..X], ..Y], ..Z] I would think
[10:05:52] * dbaupp would still just like to not even bother ref-counting for @ and just deallocate on task death
[10:05:58] <eddyb> (a fixed-size 3D matrix)
[10:06:01] <dbaupp> although that would presumably kill the bootstrap memory use
[10:06:05] *** Joins: ferminter (Mibbit@A8B22390.4B4F262F.1C37C358.IP)
[10:06:08] <eddyb> dbaupp: it keeps rustc memory usage in check
[10:06:22] <eddyb> strcat: that's not a point. you can add a header on a malloc'd memory area
[10:06:28] <dbaupp> eddyb: only just in check :P
[10:06:35] <strcat> eddyb: waste of time updating librustc for a deprecated thing
[10:06:37] <strcat> just add Deref
[10:06:40] <strcat> easier
[10:06:58] <strcat> there's code doing deref right next to the other ops
[10:07:00] <strcat> and they look up traits
[10:07:13] <strcat> once you have that, switch all of librustc to Rc
[10:07:13] <pzol> thx :)
[10:07:18] <eddyb> strcat: yeah, I know
[10:07:26] *** Quits: jsonnull (Thunderbir@E86DD23.582C899D.494A0F8B.IP) (Ping timeout)
[10:07:26] *** Quits: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[10:07:30] <strcat> then when we have a tracing gc, go and update the ones that form cycles (you can add a debug mode) to Gc
[10:07:38] <strcat> or break them with Weak, or just by not making them ;p
[10:07:49] <eddyb> AST won't use Rc ;)
[10:07:50] *** Quits: pauls (pauls@moz-7140CF01.ccs.neu.edu) (Ping timeout)
[10:07:56] <dbaupp> strcat: ... switching to Rc likely be a lot of work, since it's not Pod, right?
[10:08:00] *** Joins: jsonnull (Thunderbir@E86DD23.582C899D.494A0F8B.IP)
[10:08:08] <eddyb> dbaupp: not as much work as you'd think
[10:08:23] <strcat> dbaupp: busy-work
[10:08:25] <strcat> not any thinking
[10:08:28] <eddyb> dereference is the big issue
[10:08:41] <eddyb> strcat: I doubt there's > 100 occurrences
[10:08:42] <dbaupp> strcat: still, not fun :P
[10:08:48] <dbaupp> and rebasing...
[10:08:57] <strcat> eddyb: I bet there are because it passes unnecessarily by-@ instead of by-&
[10:08:58] <eddyb> things are passed by reference most of the time
[10:09:06] <eddyb> strcat: I fixed a lot of that
[10:09:12] <eddyb> when I disowned the visitor ;)
[10:09:14] <dbaupp> apparently pcwalton removed a lot of the @ from trans
[10:09:32] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[10:09:41] *** Quits: ferminter (Mibbit@A8B22390.4B4F262F.1C37C358.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:09:45] <eddyb> strcat: after my PR lands, I can go directly for Deref, just need to agree on a design with nmatsakis
[10:10:22] *** Joins: pauls (pauls@moz-7140CF01.ccs.neu.edu)
[10:10:39] <eddyb> I kinda want to have impl<'a> ImmDeref<'a, Ref<'a>> for RefCell and impl<'a> MutDeref<'a, RefMut<'a>> for RefCell
[10:10:58] *** Joins: rca (rcatolino@moz-AF428BD0.adsl.proxad.net)
[10:11:20] <eddyb> that way, you don't need to call any method at all to work with Rc<RefCell<T>>
[10:11:30] <strcat> eddyb: meh, too complex, think of the auto-deref implications
[10:11:39] * strcat shrugs
[10:11:41] <eddyb> what implications?
[10:11:53] <eddyb> branching *once* into two possible paths?
[10:11:55] <strcat> as in please don't make the existing complex system more complicated by adding new types of deref ;p
[10:11:58] <strcat> eddyb: yes
[10:12:01] <strcat> eddyb: the existing system already doesn't work
[10:12:08] <eddyb> (and choosing the least demanding one)
[10:12:14] <strcat> when it works and is actually well-specified, lets worry about extending it
[10:12:24] <eddyb> nmatsakis already talked about ImmDeref and MutDeref I think
[10:12:30] <strcat> eddyb: sounds simple but so does what we have now and it doesn't work ;p
[10:12:41] <strcat> the code is spread out
[10:13:15] <eddyb> strcat: the problem is that traits just don't work with arbitrary lifetimes :(
[10:13:28] <strcat> Iterator works
[10:13:30] <eddyb> the above trick with lifetimes is similar to the HKT transform
[10:13:53] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[10:13:57] <eddyb> strcat: o_O? it uses the HKT transform for lifetimes? but... I tried that with Visitor and it didn't work
[10:13:59] <Ms2ger> Iterator is pretty cool
[10:14:07] <strcat> eddyb: no
[10:14:10] <strcat> it's Iterator<A>
[10:14:13] <strcat> next -> Option<A>
[10:14:17] <eddyb> there's an issue somewhere about this being broken. somethin- NOT THAT
[10:14:19] <strcat> works fine with lifetimes
[10:14:29] * strcat shrugs
[10:14:35] <strcat> the key is to avoid having to say there's a lifetime at all
[10:14:37] <eddyb> strcat: except you can't relate the lifetime of self
[10:14:57] * strcat has a 'static lifetime, ofc
[10:15:09] <eddyb> trait ImmDeref<'a, T> {fn deref(&'a self) -> T;}
[10:15:53] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[10:16:28] <eddyb> strcat: or trait Add<'lhs, 'rhs, Rhs, Ret> {fn add(&'lhs self, &'rhs Rhs) -> Ret;}
[10:16:44] <eddyb> strcat: with that, you can create linked lists and DAGs on the stack using operators
[10:17:00] <strcat> operator overloading abuse
[10:17:03] <eddyb> let list = StackList::new() | a | b | c | d;
[10:17:14] <strcat> lets just having infix function call syntax and not abuse operators
[10:17:19] <eddyb> strcat: it's legitimate in the DAG case
[10:17:36] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[10:18:00] *** Joins: stomper (Mibbit@moz-4A19983C.ip227.fastwebnet.it)
[10:18:09] <eddyb> and all we need to do is to fix the trait+lifetimes issue and allow ommiting lifetimes (to get anonymous ones)
[10:18:39] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[10:19:31] <stomper> eddyb are you saying that lifetimes will not have to be specified as often?
[10:19:54] <eddyb> stomper: no, I'm talking about ommiting lifetimes in traits when you implement them - right now you can't have lifetimes in traits at all
[10:20:11] <eddyb> (it would allow us to add lifetimes to Add without requiring implementors to change anything)
[10:20:21] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:20:41] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:21:10] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[10:21:25] <eddyb> stomper: very rarely it's actually technically possible to be able to omit lifetimes (but you're still required to write them). I'm not aware of any such case, feel free to enlighten me
[10:21:32] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[10:21:39] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[10:21:43] <pzol> eddyb how would dynamically you initalize an array like [[[T, ..X], ..Y], ..Z] ?
[10:21:51] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:21:51] <eddyb> pzol: "dynamically"?
[10:22:10] <strcat> pzol: is the size known at compile-time?
[10:22:14] <eddyb> pzol: is the size static at compile-time or after creation?
[10:22:21] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:22:22] <pzol> strcat yeah
[10:22:28] <pzol> enum TileSet {Empty, Dirt }; let tile: TileSet = map[1][1][1];
[10:22:30] <eddyb> stomper: fn foo<'a>(&'a A) -> &'a B; will probably never change
[10:22:35] <pzol> let map = [[[TileSet, ..MAXX], ..MAXY], ..MAXZ];
[10:23:00] <pzol> that gives unresolved name `TileSet`
[10:23:02] <eddyb> pzol: that will require addressing like [z][y][x] - I hope you don't mind that
[10:23:16] <eddyb> pzol: replace TileSet with a value
[10:23:18] <strcat> pzol: the RHS is the expr, not the type
[10:23:19] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[10:23:20] <eddyb> like Empty
[10:23:34] <stomper> eddyb I was hoping that would change
[10:24:02] <strcat> stomper: that's as designed and the design isn't really negotiable
[10:24:05] <pzol> eddyb so generate an empty world and then changes the tiles during random generation?
[10:24:49] <strcat> stomper: you can't do it another way while still meeting the requirements
[10:24:52] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:24:55] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:24:59] <eibwen> error catching in IO seems to be ugly
[10:25:24] <pzol> eddyb when would I mind adressing using [z][y][x] ?? or what might be better?
[10:25:24] <strcat> one of those requirements being that inference is local to functions and you don't need the source of a function as a caller
[10:25:44] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:25:45] *** zz_kimundi is now known as kimundi
[10:25:59] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:27:41] <eddyb> pzol: I mean, it's not [x][y][z], it's [z][y][x], I hope it doesn't create problems for you
[10:27:52] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[10:27:54] <pzol> eddyb no :)
[10:28:37] <eddyb> pzol: you could maybe wrap it in a structure and implement Index<(uint, uint, uint)> so you can do map[(x, y, z)]
[10:28:59] <pzol> eddyb yeah... I was thinking of that
[10:29:06] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[10:29:36] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Quit: Leaving)
[10:29:42] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[10:31:59] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:32:11] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:35:15] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[10:35:24] *** Joins: calien (calien@moz-A9D07610.bstnma.fios.verizon.net)
[10:36:17] *** Quits: pyon (user@A16F2BE6.A9B419CB.1C8C8CE9.IP) (Quit: restart)
[10:37:20] *** Joins: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP)
[10:37:20] <calien> As of https://mail.mozilla.org/pipermail/rust-dev/2013-September/005627.html Minh Do and Jason Aten wrote that they were looking at renovating rusti. Three months later at https://mail.mozilla.org/pipermail/rust-dev/2014-January/007753.html the Rust 0.9 release notes state that "The `rust` and `rusti` commands have been removed, due to lack of maintenance." Is one to read that rusti might return
[10:37:22] <calien> if that senior thesis project succeeds, (x)or is that latter mail more 'final'?
[10:37:42] *** Joins: nfroidure (nfroidure@moz-5B08EA47.w90-18.abo.wanadoo.fr)
[10:39:19] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[10:39:20] <strcat> if someone actually writes a rusti that works as a REPL is expected to work and does so cross-platform ;p
[10:39:33] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[10:39:38] <strcat> calien: the latter email is unrelated
[10:39:40] *** Quits: pilf (pilf@moz-E8842E0A.dsl.bell.ca) (Quit: pilf)
[10:40:39] <strcat> calien: rusti was removed at some point, and then the release notes announced it 2+ months later afaik - someone planning to write a proper REPL wouldn't have gained much from the old rusti
[10:40:55] <calien> Good to know. I do understand, having read of the 0.7/0.8-era rusti's statelessly derived limitations that it wasn't a good base for a new version anyway.
[10:41:29] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[10:41:35] <strcat> it also used the old LLVM JIT without really having a good reason to be doing it
[10:41:42] <strcat> and that's going to be gone
[10:41:56] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[10:42:03] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Client exited)
[10:42:27] <calien> Well, some message in that thread pointed to some cling paper and/or presentation as a model of how to write a REPL of a more traditionally otherwise compiled language. cling uses LLVM...
[10:43:40] <calien> I read the presentation slides linked, anyway, and they didn't seem that informative beyond simply restating what others in the thread already had about acceptable limitations on functionality.
[10:43:40] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[10:44:05] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:44:06] <pzol> eddyb what's wrong with this: fn index(&self, index: (uint, uint, uint)) -> Option<TileSet> { } ? =>  method `index` has an incompatible type: expected &-ptr but found tuple
[10:44:25] <eddyb> pzol: take index by reference
[10:44:40] <eddyb> &(uint, uint, uint)
[10:44:45] <pzol> eddyb but why do i HAVE to ? 
[10:45:02] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[10:45:07] <stomper> how do i allocate a fixed-size vector where all elements have a default value?
[10:45:42] <eddyb> pzol: because it's impossible to have two versions of Index
[10:45:55] <eddyb> pzol: that's how it's defined, that's what you have to implement
[10:46:19] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[10:46:34] <pzol> eddyb right :) thanks
[10:47:14] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[10:47:16] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Quit: Leaving)
[10:47:17] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[10:47:33] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[10:48:40] <calien> strcat: in which case, how public if at all is progress on Minh Do/Jason Aten's attempt (or any others')?
[10:48:49] <strcat> none afaik
[10:48:52] <strcat> if there was any
[10:49:30] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[10:50:27] <stomper> How do I initialize this so that all elements have a default value? "let fsv : [uint, ..1024];"
[10:51:05] <strcat> [0, ..1024]
[10:51:22] <kimundi> Only works with Pod data though
[10:51:24] <stomper> oh.. that's nice
[10:51:36] <FreeFull> The d in Pod stands for data
[10:51:44] <kimundi> arg, damit!
[10:51:53] <Ms2ger> plain pod data?
[10:52:09] <kimundi> Pod types then :P
[10:52:21] <FreeFull> Or just Pod
[10:52:23] <kimundi> Ms2ger: Anything that does not move
[10:52:31] <kimundi> It gets the Pod kind
[10:52:37] * Ms2ger trolls :)
[10:53:15] <FreeFull> Pod is so old and plain
[10:55:36] *** Quits: victorporof (victorporo@E8417859.ADED4010.2B3D3D4.IP) (Quit: victorporof)
[10:56:19] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[10:56:29] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[10:56:51] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[10:57:40] <Tobba> is there any support for naked methods?
[10:58:23] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[10:58:31] <kimundi> Tobba: No, all methods either have to come from a trait of from a type impl, we only have bare functions
[10:58:35] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[10:58:42] <Tobba> well shit
[10:58:45] <Tobba> I'll use separate asm files then
[10:58:54] <Tobba> but that means I have to type mangled names
[10:58:56] <Tobba> so euuuuuuuuuuuuuuuuuuuugh
[10:59:01] * kimundi wonders how that follows
[10:59:24] <Tobba> like
[10:59:31] <Tobba> dunno what you think naked methods mean
[10:59:36] <Tobba> but __declspec__((naked))
[10:59:38] <kimundi> Maybe I misunderstood
[10:59:46] <kimundi> You mean no-mangled?
[10:59:47] <Tobba> LLVM has (very shit) support for them
[10:59:50] <Tobba> but it seems to work
[10:59:52] <Tobba> naked
[10:59:57] <Tobba> not non-mangled
[11:00:06] <Tobba> naked removes all epilogue and prologue
[11:00:50] <kimundi> Ah. No idea if we have a attribute for that, but I think we don'T. But if we had, it would probably be legal for both methods and functions
[11:01:10] <strcat> Tobba: you can at least unmangle the names so you don't have to type them...
[11:01:10] *** Quits: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP) (Ping timeout)
[11:01:20] <Tobba> I dont think I can unmangle the names of statics
[11:01:33] <strcat> if you can't it's a bug
[11:02:34] <Tobba> fair enough
[11:02:41] <Tobba> time to use nasm macros to "please kill me" levels
[11:03:11] <Tobba> though I already have some ridiclous stuff macro wise
[11:03:13] <Tobba> macro_rules! setExtendedState(($f:ident, $v:expr) => {unsafe{(*(::lib::mem::offset(::core::hal::thread_info[{let tr: u16; asm!("str $0" : "=r"(tr)); (tr-40)/16}].state as *u8, ::lib::mem::size_of::<::core::state::CoreState>() as int) as *mut ::state::ExtendedState)).$f = ($v)}})
[11:03:36] <Tobba> I have no idea if that even does the right thing
[11:05:13] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[11:05:55] <pzol> eddyb can you have a look at https://gist.github.com/pzol/8489002 it gives me a internal compiler error: sequence_element_type called on non-sequence value
[11:08:07] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[11:11:22] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[11:13:58] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[11:16:02] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[11:17:29] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[11:19:21] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[11:20:10] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[11:21:51] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[11:22:23] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[11:24:09] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[11:24:25] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[11:24:32] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[11:24:39] <stomper> is it possible to define a c-like enum where the underlying type is an u16?
[11:25:32] <strcat> #[repr(u16)] enum Foo { ... }
[11:25:44] <strcat> stomper: keep in mind you're only allowed to store the listed variants though
[11:25:47] <stomper> cool
[11:28:36] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[11:30:22] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[11:30:41] *** Quits: z0w0 (zack@moz-87AABEA0.lnse1.woo.bigpond.net.au) (Client exited)
[11:31:16] <pzol> does rust have implicit type conversion???
[11:32:11] <strcat> pzol: in some cases
[11:32:26] <pzol> strcat  can I define my own
[11:32:27] <pzol> ?
[11:32:30] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[11:32:34] <strcat> pzol: no
[11:32:40] <pzol> strcat ok, thanks
[11:33:29] *** Quits: benjamin__ (benjamin@moz-8E8A89E3.dip0.t-ipconnect.de) (Ping timeout)
[11:33:38] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[11:33:42] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[11:33:47] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[11:34:07] *** Quits: pcdummy (pcdummy@moz-CF4CA865.page4me.ch) (Ping timeout)
[11:35:12] *** Joins: Earnestly (earnest@moz-E86D50FA.dyn.plus.net)
[11:35:31] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[11:35:47] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[11:36:25] *** Joins: pcdummy (pcdummy@moz-CF4CA865.page4me.ch)
[11:36:48] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[11:37:21] *** Quits: rca (rcatolino@moz-AF428BD0.adsl.proxad.net) (Ping timeout)
[11:37:56] *** Joins: Ferreus (ferreus@moz-B5780FF1.pools.arcor-ip.net)
[11:39:52] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[11:39:56] *** Joins: rca (rcatolino@moz-AF428BD0.adsl.proxad.net)
[11:42:58] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:43:26] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[11:43:31] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[11:44:39] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[11:44:43] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[11:45:03] *** Quits: rca (rcatolino@moz-AF428BD0.adsl.proxad.net) (Ping timeout)
[11:51:38] *** Joins: olivernn (Mibbit@moz-7CE0F8.access.mtnbusiness.co.za)
[11:51:55] <dbaupp> pzol: the index trait doesn't give you assignment like that, unfortunately :(
[11:52:15] <dbaupp> pzol: you need https://github.com/mozilla/rust/issues/6515 to be fixed for that
[11:52:23] <pzol> dbaupp thanks!
[11:53:04] <dbaupp> pzol: also, you can write `fn index(&self, &(x, y, z): &XYZ) -> ...` i.e. pattern match straight in the defintion
[11:53:08] <dbaupp> *definition
[11:55:02] *** Quits: b1nd (b1nd@moz-A52EB2E5.lnse1.ken.bigpond.net.au) (Quit: Leaving)
[11:55:12] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Connection reset by peer)
[11:55:25] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Ping timeout)
[11:56:21] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[11:58:03] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[12:01:26] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[12:01:31] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[12:03:12] *** Joins: mouse (mouse@moz-84C52D4.nationalcablenetworks.ru)
[12:03:22] *** Joins: rca (rcatolino@moz-AF428BD0.adsl.proxad.net)
[12:04:58] *** Quits: olivernn (Mibbit@moz-7CE0F8.access.mtnbusiness.co.za) (Quit: http://www.mibbit.com ajax IRC Client)
[12:07:38] *** Quits: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de) (Input/output error)
[12:11:01] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[12:11:33] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[12:12:20] <eibwen> if I get something like "error: internal compiler error: node_id_to_type: no type for node `expr 2u (id=23)`"
[12:12:25] <eibwen> for compiler version 0.9
[12:12:39] <eibwen> and it tells me to report a bug. should I report it thought I don't use the dev version?
[12:13:16] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[12:13:25] <bjz> eibwen: try using master before posting an issue
[12:13:39] <bjz> eibwen: using master is recommended anyway
[12:14:17] <eibwen> ok
[12:14:22] <bjz> :)
[12:17:09] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[12:20:29] <ChrisMorgan> eibwen: that's the sort of thing that sometimes happens if you're trying to link with a crate that was built with an old version of rustc. If such should be the case, recompiling all relevant crates will fix it.
[12:20:35] *** Joins: mib_zyn2ow (Mibbit@7AA32BC5.FF3DB786.9FAABD76.IP)
[12:21:19] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[12:21:31] <eibwen> ChrisMorgan: it is a very simple program with just a few statements, "--pretty type"-printed
[12:21:54] <ChrisMorgan> Ah. You'll probably find it's already filed.
[12:22:09] <ChrisMorgan> The pretty printer is known to have various—ah—shortcomings.
[12:23:38] <dbaupp> if you're using fixed-length vectors it fails
[12:23:47] <dbaupp> (and println!() etc. create fixed length vectors)
[12:25:02] <dbaupp> https://github.com/mozilla/rust/issues/11487
[12:25:07] <eibwen> dbaupp: ok, thank you
[12:26:31] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[12:29:21] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[12:30:17] *** Quits: gwty (gwtypc@BB945ACB.C0910E88.137C914F.IP) (Connection reset by peer)
[12:31:03] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[12:31:05] *** Joins: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr)
[12:33:33] *** Joins: gwty (gwtypc@B797F58D.2BA2E9C0.4A82DA79.IP)
[12:34:02] *** Joins: nkoep (nik@moz-C2878545.pool.mediaways.net)
[12:34:06] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[12:35:52] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[12:36:26] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[12:49:20] *** Quits: TisButMe (Mibbit@moz-85E31F67.w109-212.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[12:50:04] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[12:53:29] *** Joins: biardjd (chatzilla@moz-BB97B490.washdc.fios.verizon.net)
[12:54:48] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[12:55:41] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[12:57:06] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[12:58:07] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[12:58:51] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[12:59:55] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[13:02:16] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[13:02:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:04:03] *** Quits: hays_ (quassel@moz-CD956DC5.washdc.east.verizon.net) (Ping timeout)
[13:04:28] <pzol> dbaupp kool! thanks
[13:05:27] <adridu59> dbaupp: stylistic PR got updated https://github.com/mozilla/rust/pull/11457
[13:05:32] *** Joins: hays (quassel@moz-F982FD30.washdc.east.verizon.net)
[13:06:11] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[13:06:32] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[13:06:45] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[13:06:58] *** Quits: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP) (Ping timeout)
[13:07:23] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[13:07:37] *** Joins: canhtak (canhtak@moz-4B5B3414.wl.t.ulaval.ca)
[13:09:37] *** Joins: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP)
[13:10:03] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[13:11:14] *** Quits: hays (quassel@moz-F982FD30.washdc.east.verizon.net) (Ping timeout)
[13:11:32] *** Joins: Alex_ (Alex@moz-10EFB6F0.range86-138.btcentralplus.com)
[13:12:48] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[13:12:51] *** Joins: hays (quassel@moz-11B9C997.washdc.east.verizon.net)
[13:12:54] *** Quits: ssbr (~ssbr@moz-8EC4F450.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[13:13:20] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:15:04] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[13:15:08] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[13:15:19] *** Quits: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[13:15:25] *** Quits: Alex_ (Alex@moz-10EFB6F0.range86-138.btcentralplus.com) (Quit: leaving)
[13:16:28] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[13:17:44] *** Joins: nulldata (chatzilla@moz-C5F891AC.seas-nve.net)
[13:18:23] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[13:18:54] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[13:23:40] *** Quits: hays (quassel@moz-11B9C997.washdc.east.verizon.net) (Ping timeout)
[13:24:38] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[13:24:54] *** Joins: Alex_ (Alex@moz-10EFB6F0.range86-138.btcentralplus.com)
[13:25:23] *** Joins: hays (quassel@moz-95A78BD8.washdc.east.verizon.net)
[13:25:31] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[13:25:39] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[13:26:08] *** Parts: mib_zyn2ow (Mibbit@7AA32BC5.FF3DB786.9FAABD76.IP) ()
[13:30:05] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[13:31:55] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[13:34:27] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[13:34:29] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[13:36:09] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[13:36:33] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[13:37:15] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[13:39:19] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[13:39:29] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[13:39:55] *** Joins: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr)
[13:40:12] <eibwen> how is a closure represented internally?
[13:42:20] <kimundi> eibwen: by a pair of (pointer to environment, pointer to function)
[13:42:34] <eibwen> thank you
[13:43:10] <kimundi> might be other way round though
[13:44:13] <eibwen> yea, whatever
[13:44:36] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[13:45:45] *** Quits: Thom (Thom@moz-382758D1.w80-9.abo.wanadoo.fr) (Broken pipe)
[13:46:01] *** Joins: Mowah (Mowah@moz-8548F376.cust.bredbandsbolaget.se)
[13:46:03] *** Quits: canhtak (canhtak@moz-4B5B3414.wl.t.ulaval.ca) (Quit: canhtak)
[13:46:19] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[13:48:25] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[13:48:46] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[13:49:32] *** Joins: sinma (sinma@moz-6A11C47C.fbx.proxad.net)
[13:50:31] *** Quits: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP) (Max SendQ exceeded)
[13:50:36] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[13:52:09] *** Quits: gwty (gwtypc@B797F58D.2BA2E9C0.4A82DA79.IP) (Ping timeout)
[13:56:41] <sinma> Are there a 0.10 planned before 1.0?
[13:57:01] * Earnestly hopes so
[13:57:03] <kimundi> sinma: Sure, it will likely get up to at least 0.11
[13:57:03] <strcat> sinma: yes
[13:58:15] *** Quits: rca (rcatolino@moz-AF428BD0.adsl.proxad.net) (Ping timeout)
[13:58:31] *** Joins: rca (rcatolino@moz-AF428BD0.adsl.proxad.net)
[13:59:28] *** Joins: jakerr (bluehex@moz-1095CD08.kanagawa.ocn.ne.jp)
[13:59:56] <johnsoft> good news
[14:01:41] *** Joins: jhasse (jhasse@moz-5C576802.ewe-ip-backbone.de)
[14:02:19] <jhasse> "Option<@mut listener::Listener>" How would I update that to a RefCell?
[14:06:07] *** Joins: mhl (mhl@moz-29483F85.merinet.pl)
[14:06:48] <ChrisMorgan> I believe @mut T is approximately equal to Gc<RefCell<T>>
[14:06:59] <sinma> kimundi, strcat: thx for the answer
[14:08:34] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[14:08:59] *** Quits: sigma1 (sigma@moz-1C81041B.range86-184.btcentralplus.com) (Ping timeout)
[14:09:01] <jhasse> Gc<RefCell<T>> gives me "reference to trait `listener::Listener` where a type is expected" :/
[14:09:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[14:10:02] *** Joins: sigma1 (sigma@moz-1C81041B.range86-184.btcentralplus.com)
[14:10:06] <diverse> sinma: if you check the master tutorial, you can see it being version '0.10-pre' just to let you know what's next
[14:10:28] <kimundi> If T is a Trait, then RefCell<T> does not work directly atm. Try RefCell<~T>
[14:10:43] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[14:13:47] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[14:14:01] <jhasse> kimundi: thx, works :) How do I access the fields of T inside the RefCell?
[14:14:18] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[14:14:19] <jhasse> .unwrap()?
[14:14:55] <kimundi> No idea :) Look at the docs for Gc and RefCell 
[14:14:57] *** Quits: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se) (Quit: Ex-Chat)
[14:15:28] <jhasse> ok will do
[14:15:33] <jhasse> this sure is confusing
[14:15:44] *** Quits: mouse (mouse@moz-84C52D4.nationalcablenetworks.ru) (Ping timeout)
[14:15:48] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[14:16:00] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[14:16:11] <kimundi> I think it ends up with something like .borrow().get() or so
[14:17:27] *** Quits: demize (kyrias@theos.kyriasis.com) (Ping timeout)
[14:17:44] *** Joins: Jesin (Jesin@moz-A43618DF.res.lehigh.edu)
[14:18:07] *** Joins: demize (kyrias@theos.kyriasis.com)
[14:18:15] <jhasse> yes. Or .borrow_mut().get()
[14:20:21] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:20:23] <Matthias247> borrow().with_mut()
[14:20:27] <Matthias247> for most cases
[14:20:37] <Matthias247> ultra verbose :(
[14:20:44] <jhasse> What is the difference?
[14:20:54] <jhasse> to .borrow_mut().get()
[14:21:07] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:21:33] <Matthias247> the first borrow targets the Rc, , so whether you wan't to change to content of the Rc or not
[14:21:51] <Matthias247> you don't want to change it, only access the content
[14:22:06] <Matthias247> get() returns you a copy of what is stored in the RefCell
[14:22:40] <Matthias247> if you want to modify what is in the refcell or call a method on a struct therein you net with_mut
[14:23:03] *** Quits: kvanb (kvanb@moz-76614EE8.lns7.lon.bigpond.net.au) (Quit: kvanb)
[14:23:20] <jhasse> oh ic
[14:23:23] <jhasse> thanks for explaining
[14:23:33] <Matthias247> so a Java/C# obj.callMethod() becomes obj.borrow().with_mut(|o| o.callMethod())
[14:24:05] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[14:25:01] <dbaupp> with the rvalue lifetime changes, it can also be `obj.borrow().borrow_mut().get().callMethod()`
[14:25:18] <dbaupp> and with the pointer traits, that will possibly become `obj.borrow_mut().callMethod()`
[14:26:31] <Matthias247> the last one seems an improvement :)
[14:26:38] <jhasse> Trying to use with_mut, now I get:
[14:26:39] <jhasse> error: type `std::cell::Ref<,log::Log>` does not implement any method in scope named `with_mut`
[14:27:21] <Matthias247> you seem to have one borrow() too much
[14:27:22] <dbaupp> looks like you have one too many .borrow()s
[14:28:31] <jhasse> ah, thx!
[14:28:42] <jhasse> how could you possible read that out of this error message? :D
[14:29:00] <Matthias247> I'm a little bit afraid that RefCell could cause some perfectly legal programs to fail, when you have some call hierarchy like a -> b -> c -> b
[14:29:15] <Matthias247> jhasse: because otherwise you wouldn't have a Ref<>
[14:29:57] <jhasse> ah ok
[14:30:51] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[14:32:11] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Quit: Leaving.)
[14:32:12] *** Parts: demize (kyrias@theos.kyriasis.com) ()
[14:32:35] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[14:33:38] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[14:33:45] <kimundi> Matthias247: Why would it fail?
[14:34:05] <Matthias247> kimundi: because b would be 2 times mutably borrowed
[14:34:33] <kimundi> Matthias247: Well, it would work as intended then :P
[14:34:37] <Matthias247> so if a has a rc<ref> to b and c has the same
[14:34:50] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[14:35:22] <kimundi> Then only one at a time may mutably borrow it
[14:35:22] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[14:35:31] <Matthias247> kimundi: yes. But I think that such chains happen in bigger systems. Especially if callbacks are involved
[14:36:21] <kimundi> Well, the rule is there for memory safety, so the  bigger systems need to be changed then :P
[14:36:30] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[14:36:35] *** Quits: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP) (Connection reset by peer)
[14:36:48] <Matthias247> the point is that it is not necessarily unsafe to do something like that
[14:37:02] *** Joins: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP)
[14:37:30] *** Quits: yoopo_ (6sun@842E0E4B.B14B69D6.4467248D.IP) (Quit: WeeChat 0.4.2)
[14:38:10] <Matthias247> in other languages it would be only unsafe if c manipulates something in b that a relies on. In Rust it would fail anyway
[14:39:24] <kimundi> Matthias247: So, then the issue is that you want more fain grained control - that is perfectly possible with todays Rust: Just don't put the whole type into a RefCell, but seperate fields of it
[14:39:48] *** Joins: eddyb (eddy@EDE07015.D51DAF03.FB866788.IP)
[14:39:48] <kimundi> Granted, that's not exactly convenient either
[14:40:11] <Matthias247> really: As soon is I would find it inconvient I would start moving to raw pointers all the way
[14:40:30] <dbaupp> The "real" fix is to not use RefCell ;P
[14:40:32] <Ms2ger> That sounds like a bad idea :)
[14:40:40] *** Quits: Ms2ger (Ms2ger@53A418F8.CD932C3B.187A1082.IP) (Quit: bbl)
[14:40:59] <kimundi> The Rules are an approximation anyway. They are there to guarantee 100% memory safety, at the expense of a lot of cases that would be safe otherwise.
[14:43:13] <Matthias247> dbaupp: I would propably prefer a simply Rc with would give me a mutable reference on deref. Although it's "unsafe"
[14:43:51] <dbaupp> it's not "unsafe" in quotes, it's plain unsafe.
[14:43:51] <kimundi> If you don'T mind wrapping your whole code in unsafe {} blocks :P
[14:44:25] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[14:44:26] *** Joins: mmalecki (maciej@DE8E8A22.9EBA3CD1.D6573861.IP)
[14:44:47] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[14:45:25] <Matthias247> if's the same unsafe than any most other refcounted languages are. :) But I see that Rust want's to prevent all possibilities of unsafeness
[14:46:24] <Matthias247> the thing i'm irritated is why unwrap exists and is not marked as unsafe. It's propably much more unsafe than a rc.get
[14:46:35] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[14:46:40] <dbaupp> Why?
[14:47:10] <dbaupp> Also, which .unwrap are you talking about?
[14:47:27] <Matthias247> because a lot of people will go the easy way and simply call unwrap() on Options/Results without  checking
[14:47:41] <dbaupp> that's not memory unsafe
[14:47:56] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[14:48:12] <dbaupp> i.e. there's no buffer-overflows, or remote-code-execution possible due to a failing .unwrap
[14:48:12] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Quit: Leaving)
[14:48:33] <dbaupp> (assuming the type system is sound and the stdlib `unsafe {}` is sound.)
[14:48:43] <kimundi> unwrap() on options is the same as borrow_mut() on RefCell: data integrity is checked at runtime, and in case of a violation the task fails cleanly
[14:48:46] <dbaupp> (the former seems reasonable, the latter less so.)
[14:49:04] <Matthias247> Rc directly returning a mut ref is also not I think. It only allows to mutate the object's data from another scope
[14:49:36] <dbaupp> Yes, that directly violates the core property of &mut
[14:49:59] <dbaupp> that any &mut is the only usable pointer to that piece of data
[14:50:26] <Matthias247> ok, the static analysis by the compiler for the current scope would then no longer be valid
[14:51:13] <dbaupp> Say you have x = Rc::new(~[1, 2]), then the reference y = &x.get()[0] would be invalidated by `*x.get() = ~[]`
[14:51:25] <kimundi> There are also plains for fork and join frameworks that would allow temporary sending a &mut to another task - that needs that non-alias invariant or it leads to data races
[14:51:28] <dbaupp> (since that would be forced to free the `~[1, 2]` vector)
[14:51:46] <dbaupp> bam, use after free via `y`.
[14:52:27] <eddyb> kimundi: *plans?
[14:52:37] <eddyb> that sounds really cool btw :D
[14:52:38] <kimundi> yes, plans. Sorry.
[14:52:47] <eddyb> splitting disjoint views into threads
[14:53:15] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[14:53:21] <eddyb> if you make it generic enough, it could even run on GPUs (need an open-source implementation and reuse their LLVM)
[14:53:41] <kimundi> http://smallcultfollowing.com/babysteps/blog/2013/06/11/data-parallelism-in-rust/
[14:53:54] <kimundi> And follow up: http://smallcultfollowing.com/babysteps/blog/2013/06/11/on-the-connection-between-memory-management-and-data-race-freedom/
[14:54:04] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[14:54:18] <eddyb> that was half an year ago :/
[14:54:32] <dbaupp> eddyb: that's not that old
[14:54:47] <kimundi> The closure syntax in it is though :P
[14:55:19] <eddyb> Share and Isolate?
[14:55:23] <eddyb> is one of those Send?
[14:55:40] <kimundi> eddyb: There is a hireachy with existing kinds somewhere buried in that post
[14:56:11] <dbaupp> "Relationship of Isolate and Share to existing bounds"
[14:56:19] <eddyb> oh nvm
[14:57:21] *** Quits: mhl (mhl@moz-29483F85.merinet.pl) (Quit: Lost terminal)
[15:00:22] *** Joins: jed (jed@moz-9E36FDA5.lightspeed.stlsmo.sbcglobal.net)
[15:00:29] *** Quits: jakerr (bluehex@moz-1095CD08.kanagawa.ocn.ne.jp) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:01:08] *** Joins: mentero (mentero@moz-D61C6F02.proxnet.pl)
[15:02:52] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[15:03:51] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[15:04:00] <johnsoft> let x = &1
[15:04:08] <johnsoft> great, i have a borrowed pointer to int
[15:04:17] <johnsoft> but who owns it, and when is it freed?
[15:05:12] <Matthias247> the current scope/stack I guess
[15:05:13] <kimundi> johnsoft: SOmething like that is sugar for "let tmp = 1; let x = &tmp;"
[15:05:43] <Matthias247> Could also relate to nikos latest change. Because 1 is an rvalue
[15:05:51] <kimundi> With the new rules for temporaries, tmp will live as long as x.
[15:06:16] <johnsoft> makes sense
[15:06:17] <eddyb> dbaupp: "MappedRegion is 2 or 3 words, so one is not going to notice a performance difference from the extra "copies" of passing it around by-value"
[15:06:20] <stomper> do I really have to define the Eq trait for a c-style enum?
[15:06:26] <eddyb> dbaupp: that's wrong, > register => passed by reference
[15:06:31] <johnsoft> rusti: fn x() -> &int { &1 }
[15:06:33] -rusti- pastebinned 13 lines of output: http://ix.io/9Xz
[15:06:36] <eddyb> stomper: #[deriving(Eq)]
[15:06:51] <kimundi> stomper: if you want to use == on it, yes. But you can just put a #[deriving(Eq)] annotation on it to have it automatically implemented
[15:07:06] <stomper> ok, thanks
[15:07:15] <stomper> shouldn't this be enabled by default?
[15:07:44] <eddyb> stomper: what if you wanted your own implementation?
[15:07:51] <kimundi> stomper: Not neccessarly - maybe you _don't_ want eq to work on your type
[15:07:57] <eddyb> then you couldn't have overwritten the built-in one
[15:07:59] <eddyb> or that
[15:08:48] <kimundi> In general, all trait implementations are opt-in - even Clone, which arguably would deserve a automatic implementation for Pod types way more than Eq
[15:11:00] *** flaper87|afk is now known as flaper87
[15:11:15] <johnsoft> except Send?
[15:11:51] <johnsoft> and Freeze, i think
[15:12:53] <kimundi> Those are kinds - which are automatically assigned markers - you can not implement them manually
[15:12:54] <eddyb> johnsoft: those are kinds
[15:13:25] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[15:14:10] * johnsoft nods and takes notes
[15:14:35] <kimundi> Granted, technically they are still traits in the type system, they just have an entirely reason to exists
[15:14:47] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[15:14:50] <kimundi> entirely different reason to exist*
[15:15:08] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[15:16:52] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[15:17:50] *** Joins: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr)
[15:18:26] <adridu59> hi guys, do you have an idea of what could be a good lab work to practise with pointers?
[15:19:48] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[15:21:58] <dbaupp> eddyb: semantically it's passed-by-value
[15:22:30] <eddyb> dbaupp: I mean, there's no performance difference between &self and self
[15:22:42] <dbaupp> eddyb: erm, so?
[15:22:51] <eddyb> dbaupp: maybe I didn't understand the context
[15:23:06] <dbaupp> eddyb: yes, seems like you didn't
[15:23:10] <eddyb> "performance difference from the extra "copies" of passing it around by-value"
[15:23:34] <eddyb> there wouldn't be no copies, unless LLVM is dumbed by something somewhere
[15:23:39] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[15:23:40] <eddyb> s/no//
[15:26:27] <dbaupp> eddyb: I can't tell if you're agreeing that ~ is unnecessary or not
[15:26:48] <dbaupp> in any case, I quoted copies like that for a reason.
[15:27:39] <eddyb> dbaupp: I am. and I saw the quotes, but I felt like it wasn't completely accurate. I can delete the comment if you want to
[15:30:28] *** Joins: olivernn (Mibbit@moz-7CE0F8.access.mtnbusiness.co.za)
[15:31:32] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[15:31:32] <dbaupp> eddyb: also https://gist.github.com/huonw/b7571a7b5998bfc7b9ac
[15:31:36] *** Joins: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca)
[15:31:40] <dbaupp> looks like a copy to me
[15:32:13] *** Quits: sinma (sinma@moz-6A11C47C.fbx.proxad.net) (Quit: Konversation terminated!)
[15:32:16] <eddyb> dbaupp: c++filt. -O3?
[15:32:37] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[15:32:39] <dbaupp> eddyb: -O
[15:32:41] <eddyb> *--opt-level=3
[15:32:41] <Matrixiumn> UGH.
[15:32:46] <Matrixiumn> Still having problems trying to compile rust.
[15:32:53] <eddyb> dbaupp: oh, inline(never)
[15:32:58] <dbaupp> eddyb: and you can tell the which one is foo and which is bar, right?
[15:32:59] <Matrixiumn> touch: cannot touch `/rustc': Permission denied
[15:32:59] <olivernn> Hi, I am trying to work with the semver module, I can parse a string into a Version but I can't access any of the fields because they are private? I'm using rust 0.9.
[15:33:06] <eddyb> dbaupp: barely :P
[15:33:19] <jed> u8 can no longer be casted as bool?
[15:33:22] *** Quits: maxli (maxli@moz-EE42E0E.student.cs.uwaterloo.ca) (Ping timeout)
[15:33:32] <dbaupp> jed: test != 0
[15:33:51] <eddyb> Matrixiumn: how did you run ./configure?
[15:33:57] <Matrixiumn> eddyb: Yes.
[15:34:01] <Matrixiumn> :O
[15:34:03] <Matrixiumn> Hey eddyb.
[15:34:07] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[15:34:13] <eddyb> Matrixiumn: I asked... how. as in, what did you put after "./configure"?
[15:34:22] <jed> sadly life is not so simple
[15:34:25] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[15:34:39] <Matrixiumn> Sorry, misread. :P ./configure --host=x86_64-unknown-linux-gnu --target=x86_64-unknown-linux-gnu --enable-clang  
[15:35:00] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[15:35:07] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[15:35:16] <eddyb> Matrixiumn: does it not pick up the host/target automatically?
[15:35:30] <Matrixiumn> eddyb: No. Lemme fetch the error for that.
[15:35:30] <eddyb> also, I've heard enable-clang breaking in the past - but not as bas as you say
[15:35:34] <dbaupp> eddyb: updated to use #[no_mangle] :P
[15:35:56] <eddyb> dbaupp: { i64, %tydesc*, i8*, i8*, i8 }* nocapture readnone that is gone in my branch ;)
[15:36:19] <Matrixiumn> hecking for i686-unknown-linux-gnu-clang... gcc -m32 checking for C compiler default output file name... configure: error: C compiler cannot create executables◦  
[15:36:22] <eddyb> dbaupp: thing is, bar shouldn't copy
[15:36:38] <eddyb> Matrixiumn: hehe. remove --enable-clang
[15:36:50] <eddyb> it's trying to use clang as gcc from the looks of it, and failing
[15:36:53] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[15:37:15] <Matrixiumn> eddyb: The last error came from a plain ./configure, sorry to be a nuisance...
[15:37:33] <eddyb> Matrixiumn: run: env | grep CC
[15:37:41] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:37:41] <dbaupp> eddyb: it *has* to copy
[15:37:59] <flaper87> eddyb: why shouldn't it copy?
[15:38:00] <eddyb> dbaupp: bar? no, it could pass the reference to its argument to foo directly
[15:38:05] <dbaupp> foo has ownership, so as far as a bar knows the argument will be modified
[15:38:30] <eddyb> dbaupp: those are not the rules ;)
[15:38:45] <eddyb> if foo modifies its argument, it has to copy it locally
[15:38:47] <dbaupp> well, what are the rules?
[15:38:56] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[15:39:09] <dbaupp> *clearly* that's not what is currently implemented, since that's not what the compiler is emitting
[15:39:16] <eddyb> dbaupp: try using "mut"
[15:39:23] <eddyb> and see what happens
[15:39:25] <Matrixiumn> eddyb: No output.
[15:39:40] <eddyb> Matrixiumn: weird, what's wrong with your system?
[15:39:49] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[15:39:51] <dbaupp> eddyb: nope, no change
[15:40:05] *** Quits: kris_ (kris@moz-147EE6DF.diku.dk) (Ping timeout)
[15:40:07] *** Joins: kris_ (kris@moz-5A7B69C7.math.ku.dk)
[15:40:08] <dbaupp> eddyb: changed the body of foo to `f.x += 1; f`, and the copy still happens in bar
[15:40:11] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[15:40:12] <Matrixiumn> eddyb: Nothing, I have compiled many things in the past.
[15:40:19] *** Quits: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com) (Ping timeout)
[15:40:38] <eddyb> dbaupp: err, it's not obvious. I have to think for a second
[15:40:38] *** Joins: LinearInterpol (RJones@moz-E6F82C3A.maine.res.rr.com)
[15:40:58] <eddyb> dbaupp: look at the LLVM IR without optimizations
[15:41:23] <eddyb> foo will copy its argument into an alloca before modifying it
[15:41:28] <dbaupp> eddyb: (remember that both foo and bar are public, and so are exposing the full Rust ABI)
[15:41:45] <dbaupp> nope, it doesn't
[15:41:47] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[15:41:56] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[15:42:08] <eddyb> when I tried to ellide those darn allocas for arguments, I've found out that they are only required for mutable bindings passed by value
[15:42:15] <dbaupp> in fact, the IR barely changes, except for all the junk intrinsic declarations that --opt-level=<anything> elides
[15:42:31] <eddyb> hmpf
[15:42:54] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[15:43:08] <Matrixiumn> :(
[15:43:10] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Connection reset by peer)
[15:43:44] <eddyb> dbaupp: so foo writes to its argument?
[15:44:00] <dbaupp> eddyb: yes
[15:44:16] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[15:44:19] <eddyb> dbaupp: what is Foo moves?
[15:44:23] <eddyb> *what if
[15:44:44] <dbaupp> eddyb: https://gist.github.com/huonw/49545c1dc87d5b08c6f1
[15:45:41] <eddyb> I guess what I'm expecting is bar to move its argument into foo
[15:45:57] *** Quits: sebcrozet (sebcrozet@moz-A855F6C0.w82-127.abo.wanadoo.fr) (Quit: Gone)
[15:46:13] <dbaupp> a "move" is just a rustc-level semantic
[15:46:22] <dbaupp> it means pretty much nothing to LLVM
[15:46:37] <dbaupp> (and yes, no change for a non-Pod Foo)
[15:46:41] <eddyb> o_O
[15:46:52] *** Joins: gwty (gwtypc@B797F58D.2BA2E9C0.4A82DA79.IP)
[15:46:57] <eddyb> dbaupp: I think we're missing an attribute on such larger-than-register arguments, even if I was wrong about the ownership
[15:48:11] <doener> eddyb,dbaupp: what's this about? I fail to get the full context from the backlog
[15:48:33] <eddyb> that is, functions like foo and bar get ownership of the structure they are passed by reference. LLVM should be able to understand that (noalias, maybe?)
[15:48:40] *** Quits: jhasse (jhasse@moz-5C576802.ewe-ip-backbone.de) (Quit: Verlassend)
[15:49:34] <eddyb> dbaupp: heh, it's marked as readonly here (by LLVM after optimizations): https://gist.github.com/huonw/b7571a7b5998bfc7b9ac#file-gistfile2-ll-L2
[15:49:45] <dbaupp> doener: eddyb is surprised by this memcpy https://gist.github.com/huonw/b7571a7b5998bfc7b9ac#file-gistfile2-ll-L16
[15:50:08] <dbaupp> doener: he was expecting it to only happen inside `foo` if necessary (i.e. if `foo` modified it's argument)
[15:50:16] <eddyb> dbaupp: not inside foo
[15:50:28] <eddyb> foo needs to copy to return, bar doesn't need to copy to pass
[15:50:54] <Matrixiumn> eddyb: Hmm, apparently it isn't meant to bet set. (Ubuntu 12 system, btw.)
[15:51:09] <eddyb> Matrixiumn: yeah, but how does configure get "clang" there?
[15:51:14] <eddyb> Matrixiumn: cc -v
[15:51:24] *** Quits: jed (jed@moz-9E36FDA5.lightspeed.stlsmo.sbcglobal.net) (Quit: leaving)
[15:51:26] <eddyb> so LLVM actually knows that (with the given code in foo) foo won't actually write to its argument. and bar won't write to its argument either. so why does it need to copy it?
[15:52:18] *** Quits: smarter (smarter@moz-9C03B7C7.cust.bluewin.ch) (Quit: )
[15:52:23] *** Joins: smarter (smarter@moz-9C03B7C7.cust.bluewin.ch)
[15:52:45] <eddyb> dbaupp: can you manually add "noalias" to the last argument of foo and bar and run "opt -O3 -S test.ll"?
[15:52:51] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[15:52:53] <dbaupp> eddyb: nope
[15:52:54] <dbaupp> bedtime
[15:53:03] <eddyb> okay, I'll do it myself
[15:53:12] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[15:53:16] <eddyb> dbaupp: thanks for showing me this, looks like a bug we can fix :D
[15:53:49] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[15:53:53] <dbaupp> "fixing" this will be changing the Rust ABI, fwiw.
[15:54:02] <Matrixiumn> eddyb: https://gist.github.com/c0e2c495b236addb6836
[15:54:17] <eddyb> dbaupp: Rust ABI is broken in places anyway
[15:54:33] <eddyb> Matrixiumn: hmpf. maybe our configure is broken
[15:54:51] <Matrixiumn> Hmm.
[15:55:08] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[15:56:09] *** Quits: olivernn (Mibbit@moz-7CE0F8.access.mtnbusiness.co.za) (Quit: http://www.mibbit.com ajax IRC Client)
[15:56:28] *** Quits: patpat (patpat@moz-85F8C52A.as13285.net) (Ping timeout)
[15:56:41] *** Joins: patpat (patpat@moz-85F8C52A.as13285.net)
[15:56:46] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[15:58:23] <eddyb> dbaupp: noalias doesn't help :(
[15:58:35] <eddyb> strcat isn't around, maybe he'd know
[15:58:58] <doener> eddyb: IIRC there's an issue about using "byval" instead of doing the copies ourselves
[15:59:14] *** Joins: AvianFlu (AvianFlu@moz-51534E77.c3-0.43d-ubr2.qens-43d.ny.cable.rcn.com)
[16:00:03] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[16:00:32] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[16:01:34] <doener> eddyb: FWIW: https://gist.github.com/dotdash/8492353 -- old version vs. byval version
[16:02:00] <doener> ... based on https://gist.github.com/huonw/b7571a7b5998bfc7b9ac#file-gistfile2-ll-L16
[16:02:29] <eddyb> doener: so it still copies?
[16:02:38] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[16:04:32] <eddyb> doener: maybe we should just implement this in trans, properly
[16:05:08] <eddyb> Rust ABI already moves ownership of such indirectly passed structures to the callee, we're just not taking advantage of it
[16:05:39] <eddyb> (I'm surprised moves also don't elide the copy. but that might be an issue with ZeroMem and cleanups)
[16:07:30] <doener> eddyb: About moves, yeah, it is. We still things like "if foo { move_it(x); }", where it is statically unknown whether the move happened
[16:07:39] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[16:07:54] <doener> byval issue is https://github.com/mozilla/rust/issues/10030
[16:08:04] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[16:08:20] <eddyb> doener: does your test have "readonly"?
[16:08:25] *** Quits: nulldata (chatzilla@moz-C5F891AC.seas-nve.net) (Ping timeout)
[16:08:32] <doener> yep
[16:08:53] <eddyb> it still copies :(
[16:09:09] <eddyb> it would be nice if the diff had full context
[16:09:56] <doener> https://gist.github.com/dotdash/8492353 -- full context diff in comment
[16:10:17] <Matrixiumn> eddyb: Should I, umm, submit a GitHub issue?
[16:10:20] <eddyb> doener: you can edit the diff
[16:10:22] <eddyb> Matrixiumn: sure
[16:10:26] <eddyb> doener: s/diff/gist
[16:10:29] *** Quits: patpat (patpat@moz-85F8C52A.as13285.net) (Connection reset by peer)
[16:10:31] <Matrixiumn> Okay. :)
[16:10:42] *** Joins: patpat (patpat@moz-85F8C52A.as13285.net)
[16:10:59] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[16:11:02] <doener> yeah, I just always look for the edit button on the left and then decide that it's easier to just comment :-/
[16:12:27] <eddyb> doener: byval passes the struct on the stack :(
[16:12:45] <eddyb> (which we don't want)
[16:13:15] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[16:13:17] *** Joins: valenting (Thunderbir@A64FDE7E.7E118222.89C0DD0D.IP)
[16:13:35] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Max SendQ exceeded)
[16:14:07] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[16:14:21] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Connection reset by peer)
[16:14:22] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[16:16:54] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[16:18:00] <doener> eddyb: Do you want to pass a pointer to the struct that already is on the stack (i.e. bar's argument), or do you want a clang-like optimization that uses two regs to pass the whole struct?
[16:18:19] <eddyb> doener: the former
[16:18:26] <eddyb> since it's obviously cheaper
[16:18:33] <Matrixiumn> eddyb: Sent. :)
[16:18:55] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[16:19:53] *** Joins: igork (Adium@9C577557.7893D71C.6E0EE79F.IP)
[16:20:36] *** Joins: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net)
[16:23:20] *** Joins: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de)
[16:25:35] <doener> eddyb: not necessarily. Avoiding the stack entirely should be even cheaper (bar's argument would of course have the same treatment and already live in registers).
[16:25:37] *** Joins: Daspeed (Mibbit@moz-A96FF35D.adsl.xs4all.nl)
[16:25:39] *** Joins: Fatalnix (bhodgins@moz-20A07419.ptldme.east.myfairpoint.net)
[16:25:41] <Fatalnix> Morning
[16:26:01] <adridu59> well it's not morning here
[16:26:14] <Fatalnix> neither is it here in half an hour.
[16:26:24] <doener> eddyb: also, wouldn't this only work within a compilation unit and be a job for LLVM? Cross-crate, what if foo() changes from not-writing to writing?
[16:26:26] <Fatalnix> I say morning even if I'm about to go to bed
[16:26:46] *** Quits: Daspeed (Mibbit@moz-A96FF35D.adsl.xs4all.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[16:27:00] <eddyb> doener: the caller of bar gives bar something that can be modified
[16:27:18] <eddyb> doener: the callers of bar and foo have to give up ownership of the reference
[16:28:17] <doener> eddyb: "struct Foo" in that example is implicitly copyable. bar() is free to use it after the call to foo
[16:28:23] <eddyb> doener: nope
[16:28:24] <Fatalnix> So I was trying to learn a little rust and wanted to load up some lib I found here: https://github.com/zonyitoo/rust-ini - Seems outdated and states invalid lifetime name: 'self is no longer a special lifetime - of course I don't know much about lifetime names yet.. heh.
[16:28:38] <Fatalnix> well, anything
[16:28:50] <eddyb> doener: see dbaupp's findings, foo can modify the structure pointed to by its pointer
[16:28:53] <adridu59> Fatalnix: so you're around NY or something
[16:29:07] <Fatalnix> adridu59: Maine
[16:29:14] <adridu59> Fatalnix: self as a lifetime keyword is forbidden, you just need to rename it to a or something
[16:29:27] <Fatalnix> huh
[16:29:43] <eddyb> 'a, that is
[16:29:59] <olsonjeffery> anyone here using flycheck w/ rust?
[16:30:09] <olsonjeffery> im not able to get the rust extension to work..
[16:30:12] <doener> eddyb: have a link? In the example I have, sure foo() is free to modify it's argument if one uses "mut f: Foo", after all, it's by-value, foo() has its own copy
[16:30:13] <adridu59> it has been forbidden because parsing was ambiguous; self has other uses
[16:30:24] <japaric> How do I cast an integer back to an enum? e.g. enum abc { a, b, c }; let x = a as int; let y = x as abc; x works, y fails
[16:30:31] <eddyb> doener: no, foo doesn't copy its argument
[16:30:47] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[16:30:50] <eddyb> doener: to use it, that is. it copies only to return it
[16:30:56] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[16:30:58] <doener> eddyb: pass by value is implemented in the caller
[16:31:26] <eddyb> doener: each call copies the value into an alloca an passes an unique pointer to that alloca
[16:32:06] <doener> yeah, because the struct does not qualify as an immediate and we don't have the clang-like optimization to split it into to registers
[16:32:13] <adridu59> is Rc cheaper than Arc?
[16:32:20] <eddyb> adridu59: yes
[16:32:20] <doener> so the caller has to copy the value and the callee gets a pointer
[16:32:25] <adridu59> else I'm assuming we would use Arc everywhere
[16:32:40] <eddyb> doener: yes. but the caller of bar already gave up ownership, so bar can just pass the pointer to foo
[16:32:46] <doener> eddyb: no
[16:32:52] <eddyb> yes :)
[16:33:12] <eddyb> it's not a &T or &mut T, it's "value by reference" and Rust has specific semantics
[16:33:23] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[16:33:25] <eddyb> if bar calls foo twice, it has to copy the value every time
[16:33:49] <eddyb> if foo modifies the value it gets, it modifies it on the stack of the caller (bar in this case)
[16:34:04] <doener> eddyb: yeah, because bar created the copies for foo
[16:34:10] *** Quits: patpat (patpat@moz-85F8C52A.as13285.net) (Ping timeout)
[16:34:15] *** Joins: patpat (patpat@moz-85F8C52A.as13285.net)
[16:34:20] <eddyb> doener: the caller of bar already made a copy
[16:34:31] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Quit: Tiarra 0.1+svn-39209: SIGINT received; exit)
[16:34:34] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[16:34:50] <Fatalnix> I'm compiling this lib wrong, heh
[16:35:04] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[16:35:09] <eddyb> doener: bar is free to modify the indirect structure it got, so is foo. bar doesn't need to copy its argument to give it to foo
[16:35:21] <Fatalnix> main not found.. looking at --hel
[16:35:24] <Fatalnix> help*
[16:35:26] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[16:35:34] <Fatalnix> oh --lib :D
[16:37:11] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[16:37:33] <doener> eddyb: that would make foo operate on the same copy of the struct as bar
[16:37:50] <eddyb> doener: yes
[16:38:23] <doener> eddyb: which is only valid if foo() doesn't modify the value, or bar() doesn't use it after foo() was called (and bar's caller doesn't use it anymore either, and so on)
[16:38:46] <eddyb> doener: bar's caller won't use it, it's a copy
[16:39:02] <eddyb> bar doesn't use it after calling foo, which is why it's a valid optimization
[16:40:35] <doener> eddyb: consider this: fn baz(f: Foo) { println!("{}", f.x); bar(f); println!("{}", f.x); }
[16:40:45] <doener> eddyb: that should print the same value twice
[16:40:51] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[16:40:56] <eddyb> gaah my mouse is broken
[16:40:56] <doener> eddyb: with your change, if foo() modifies the value, it won't
[16:41:05] <eddyb> doener: baz gives bar a copy
[16:41:11] <eddyb> that is what happens right now
[16:41:33] <eddyb> bar can't modify the argument of baz
[16:41:41] <eddyb> (because it doesn't get it)
[16:42:14] *** Joins: trevor (trevor@moz-F6C93216.hsd1.mn.comcast.net)
[16:42:35] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[16:43:30] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[16:43:55] *** Joins: nulldata (chatzilla@moz-C5F891AC.seas-nve.net)
[16:44:03] <Fatalnix> yeah I guess I'm just going to have to wait- I don't know enough about rust to fix this
[16:44:21] <doener> eddyb: ok, so if I understand that right, you want to elide the copy only if the function call is the last use of the calling function's argument?
[16:44:41] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[16:44:54] <eddyb> doener: or the function has the "readonly" attribute for that argument
[16:45:01] <eddyb> (both are true in this case)
[16:45:03] <flaper87> bjz: around ?
[16:45:17] *** Joins: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[16:45:51] <flaper87> eddyb: FWIW, I'm with you on that. What you're saying makes sense to me. I've no idea how to implement it, though. :P
[16:46:17] *** Quits: rca (rcatolino@moz-AF428BD0.adsl.proxad.net) (Ping timeout)
[16:46:30] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[16:46:48] <johnsoft> hmm, what's the rationale for "error: cannot implement a destructor on a structure that does not satisfy Send"
[16:46:58] <flaper87> eddyb: or I should say "fix it"
[16:47:04] <johnsoft> surely values aren't sent to another task to destruct
[16:48:18] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[16:48:54] <eddyb> johnsoft: you need #[unsafe_destructor]. I'm sure someone asked this last night (and someone else knew the rationale)
[16:49:07] <cmr> johnsoft: non-Send means you can make cycles, and cycles of destructors are unsafe.
[16:49:28] <cmr> (there's no safe order to call them in, you'd have references to invalid data, etc)
[16:50:35] *** Joins: rca (rcatolino@moz-AF428BD0.adsl.proxad.net)
[16:50:50] <johnsoft> makes sense (i think)
[16:50:59] *** Joins: new_one (new_one@moz-3F39CBBB.rice.edu)
[16:51:09] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[16:53:04] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[16:54:32] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[16:55:47] *** Quits: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net) (Quit: maxiepoo)
[16:55:50] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[16:57:16] *** Quits: trevor (trevor@moz-F6C93216.hsd1.mn.comcast.net) (Ping timeout)
[16:57:42] *** Joins: moostik (Icedove@moz-1FF02BE5.w92-151.abo.wanadoo.fr)
[16:59:06] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[17:00:17] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:00:53] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[17:02:37] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:05:29] *** Quits: gwty (gwtypc@B797F58D.2BA2E9C0.4A82DA79.IP) (Ping timeout)
[17:05:52] *** Quits: valenting (Thunderbir@A64FDE7E.7E118222.89C0DD0D.IP) (Ping timeout)
[17:07:59] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[17:09:27] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:10:14] <johnsoft> is there anything i can past to 'rustpkg install' to get it to generate an rlib?
[17:11:03] <cmr> does it take --rlib?
[17:11:44] <cmr> it still might not have been updated for rlibs.
[17:12:28] <johnsoft> it doesn't, no
[17:13:33] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[17:13:34] <johnsoft> so far i've been running rustc manually and passing the flag
[17:13:50] <johnsoft> but that doesn't work for https://github.com/erickt/rust-mustache.git
[17:14:16] <johnsoft> instead of libmustache-xxxx.* i get liblib-xxxx and i can't figure out how to get extern mod to see it
[17:14:30] <cmr> it needs a #[crate_id = "moustache"];
[17:14:58] <johnsoft> seems simple enough, i'll try it
[17:15:13] <cmr> (https://github.com/erickt/rust-mustache/pull/9)
[17:15:33] <cmr> bah typo.
[17:15:39] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[17:15:55] <johnsoft> geez that was fast
[17:16:08] <flaper87> cmr: r? https://github.com/mozilla/rust/pull/11649
[17:16:09] <johnsoft> thanks, i'll pull from there
[17:16:19] <cmr> https://github.com/erickt/rust-mustache/pull/10
[17:16:38] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[17:16:46] <cmr> flaper87: can you add benchmarks of pow, while you're at it?
[17:17:02] <flaper87> cmr: sure thing
[17:17:13] <cmr> If pow_with_uint is actually faster I'd like pow to be fixed before removing it.
[17:17:40] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[17:18:21] <flaper87> cmr: also, what do you think about pulling powf out of the Real trait? keeping it there seems inconsistent with pow. I'm torn there, TBH.
[17:18:25] <flaper87> let me add the benchmark
[17:18:33] <cmr> I have no opinion about that.
[17:18:47] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[17:19:45] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[17:20:04] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[17:20:13] <flaper87> cmr: src/test/bench/ <- there ?
[17:20:26] <cmr> no
[17:20:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:20:44] <cmr> https://github.com/mozilla/rust/wiki/Doc-unit-testing#benchmarking
[17:20:59] <cmr> put it in the tests module where pow is defined.
[17:21:09] <flaper87> cmr: cool, thanks
[17:21:57] *** Joins: jnsk (Mibbit@moz-829EE15C.dsl.static.sonic.net)
[17:22:23] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[17:22:29] <jnsk> hello, I have a question about borrowing mutable values
[17:23:00] <jnsk> when you have something like let mut x = 5; let mut y = &x; 
[17:23:29] <jnsk> is there any way to change the 5 to another value before y's lifetime is over?
[17:23:35] <cmr> no
[17:23:41] <cmr> x is said to be brozen.
[17:23:43] <cmr> *frozen
[17:23:47] <cmr> note that that's an immutable borr.
[17:23:48] <cmr> *borrow
[17:23:56] <eddyb> fix your keyboard :P
[17:24:15] <jnsk> I see haha. is there such a thing as a mutable borrow?
[17:24:17] <cmr> just because the slot is mutable doesn't mean its contents are; mutability isn't inherited for borrowed pointers, it's part of the type.
[17:24:18] <eddyb> jnsk: maybe if you assign y to a different reference, that may thaw x, but I'm not sure
[17:24:23] <cmr> yes, &mut x
[17:24:26] <eddyb> jnsk: yes, let y = &mut x;
[17:24:34] <cmr> but even then x can't be changed, only through y
[17:25:14] <jnsk> yea I understand that the owner can't do anything with it, but was unsure about what why could do
[17:25:20] <jnsk> y* not why haha
[17:25:52] *** Quits: mentero (mentero@moz-D61C6F02.proxnet.pl) (Ping timeout)
[17:25:59] <jnsk> is there a rule to determine whether it's actually mutable? what if it was let x = 5; let mut y = &mut x
[17:26:09] <cmr> not valid, compiler will reject.
[17:26:12] <jnsk> or the various other ways to put "mut" into the mix
[17:26:13] *** Joins: pzol (pzol@moz-553BEE64.dynamic.chello.pl)
[17:26:14] <cmr> can't mutably borrow immutable locals.
[17:26:27] <jnsk> oh okay
[17:26:30] <cmr> note that `let y = &mut x` is fine. y doesn't need to be mutable.
[17:26:43] <cmr> `let mut y` just means you can have a `y = whatever;` somewhere down the line.
[17:27:47] *** Joins: canhtak (canhtak@moz-4B5B3414.wl.t.ulaval.ca)
[17:28:05] <benh> or a `&mut y` ;)
[17:28:33] <jnsk> wait then is let x = 5; let y = &mut x; valid code then?
[17:28:41] <cmr> no
[17:28:53] <jnsk> x needs to be mutable to take a mutable reference right?
[17:28:57] <cmr> yes
[17:29:17] <jnsk> haha okay I get it now. thank you
[17:29:41] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:30:39] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[17:31:45] *** Quits: moostik (Icedove@moz-1FF02BE5.w92-151.abo.wanadoo.fr) (Ping timeout)
[17:33:14] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[17:33:47] *** Quits: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net) (Ping timeout)
[17:33:54] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[17:34:09] *** Quits: copumpkin (copumpkin@moz-FC353116.dyn.optonline.net) (Ping timeout)
[17:34:11] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[17:35:49] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[17:35:54] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[17:37:19] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[17:37:38] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[17:37:54] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[17:37:58] *** Joins: copumpkin (copumpkin@moz-FC353116.dyn.optonline.net)
[17:38:09] *** Joins: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net)
[17:38:12] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:38:17] <kimundi> Hm, how do I use Cell/RefCell these days to get around "error: cannot move out of captured outer variable"
[17:40:20] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[17:41:16] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[17:41:22] <pzol> Can't implement traits for enum variant, can I??
[17:41:28] <kimundi> no
[17:41:30] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[17:41:35] <cmr> pzol: no, because enum variants aren't types.
[17:41:36] <eddyb> pzol: no, you implement the trait for the enum *type*
[17:41:53] <pzol> cmr eddyb  bummer ;) 
[17:42:01] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[17:42:16] *** Joins: simon (simon@moz-35088AE9.dsl.bell.ca)
[17:42:16] <eddyb> it would mean refutable pattern matching outside of match statements
[17:42:24] <eddyb> (like Haskell)
[17:42:29] <pzol> cmr so what are enum variants if not types?
[17:42:36] <cmr> pzol: they're enum variants.
[17:42:40] <pzol> :D
[17:42:40] <eddyb> pzol: possible values
[17:42:52] <cmr> they're constructors and things you can match against.
[17:42:59] <pzol> even struct_variants?
[17:43:06] <kimundi> variants are a) possible values of a enum type b) type constructors for that possible value of a enum type
[17:43:06] <cmr> even those.
[17:43:19] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[17:43:45] <pzol> kimundi cmr thanks 
[17:43:49] *** Quits: nulldata (chatzilla@moz-C5F891AC.seas-nve.net) (Ping timeout)
[17:44:43] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 26.0/20131205075310])
[17:44:44] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[17:44:51] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[17:45:21] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[17:46:16] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[17:46:36] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[17:49:38] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[17:50:21] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[17:52:27] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Quit: Linkinus - http://linkinus.com)
[17:53:46] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[17:54:04] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[17:55:16] *** Joins: bjustin (bjustin@moz-4B914826.hsd1.mn.comcast.net)
[17:56:07] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:56:12] *** Quits: canhtak (canhtak@moz-4B5B3414.wl.t.ulaval.ca) (Quit: canhtak)
[17:57:11] *** Quits: jnsk (Mibbit@moz-829EE15C.dsl.static.sonic.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:57:13] *** Quits: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de) (Quit: Leaving.)
[17:57:31] *** Quits: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de) (Input/output error)
[17:58:03] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[17:58:30] *** Quits: io2 (io2@moz-871549F5.home.otenet.gr) (Ping timeout)
[17:58:48] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[18:00:54] *** Joins: io2 (io2@moz-871549F5.home.otenet.gr)
[18:01:56] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[18:07:40] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[18:07:40] *** ChanServ sets mode: +o acrichto
[18:07:53] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[18:08:00] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[18:08:03] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[18:10:25] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[18:10:59] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[18:10:59] *** ChanServ sets mode: +o jdm
[18:11:51] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[18:12:03] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[18:15:43] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[18:17:45] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[18:18:09] *** Quits: new_one (new_one@moz-3F39CBBB.rice.edu) (Client exited)
[18:19:45] *** Joins: dmac (Adium@moz-99EF2EE6.hfc.comcastbusiness.net)
[18:19:55] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[18:22:26] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[18:22:40] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[18:22:47] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[18:24:15] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[18:26:09] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Client exited)
[18:26:18] *** Parts: Alex_ (Alex@moz-10EFB6F0.range86-138.btcentralplus.com) ()
[18:26:31] *** Joins: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp)
[18:27:38] <stomper> why is b == () in   let a = ~[9,1,7,2]; 	let b = a.clone().sort(); 	println!("{:?}",b);
[18:27:55] *** Quits: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se) (Ping timeout)
[18:27:55] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[18:27:59] <cmr> stomper: sort is in-place.
[18:28:18] *** Quits: ssira (ssira@moz-DC71C200.kanagawa.ocn.ne.jp) (Ping timeout)
[18:28:28] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Ping timeout)
[18:28:40] *** Joins: dwrensha (chatzilla@moz-B23D2FF6.pitbpa.east.verizon.net)
[18:28:55] *** Joins: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se)
[18:29:04] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[18:29:20] *** Quits: simon (simon@moz-35088AE9.dsl.bell.ca) (Ping timeout)
[18:29:35] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[18:29:51] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[18:30:25] *** Joins: maxiepoo (mnew@moz-6F50ADE.hsd1.il.comcast.net)
[18:30:42] <stomper> can you explain what that means?
[18:31:07] <kimundi> stomper: It's not returning a new  value, but modifying the one sort is called one
[18:31:08] <cmr> it mutates the original list.
[18:31:12] <cmr> (https://en.wikipedia.org/wiki/In-place_algorithm)
[18:32:51] <stomper> but original list in this case is the clone of a. so why does    let mut c = a.clone(); 	c.sort();    work but not what I showed before?
[18:33:34] <cmr> so a.clone() returns a new list. .sort() mutates that list. that intermediate list is then discarded as it isn't stored anywhere.
[18:34:55] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[18:36:36] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[18:36:46] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[18:37:12] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[18:37:16] *** Joins: trevor_ (trevor@moz-F6C93216.hsd1.mn.comcast.net)
[18:37:30] *** Quits: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net) (Quit: I haz left.)
[18:37:31] *** Quits: trevor_ (trevor@moz-F6C93216.hsd1.mn.comcast.net) (Quit: leaving)
[18:37:52] *** Joins: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net)
[18:38:42] * geomyidae what does sort return in that case?
[18:39:36] <doener> unit, i.e. ()
[18:42:33] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Quit: leaving)
[18:42:58] <eddyb> http://www.reddit.com/r/haskell/comments/1pjjy5/odersky_the_trouble_with_types_strange_loop_2013/cd3bgcu WTF is Functor?
[18:43:06] <eddyb> I don't think we want something like that in Rust
[18:43:28] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[18:43:28] *** ChanServ sets mode: +o acrichto
[18:46:43] *** Joins: mhr (mhr@moz-EBDFD4F.cpe.net.cable.rogers.com)
[18:47:13] *** Joins: moostik (Icedove@moz-1FF02BE5.w92-151.abo.wanadoo.fr)
[18:48:20] <calien> Is it recommended, if one wants to play with Rust, to use master/nightly or 0.9?
[18:48:44] <eddyb> calien: master
[18:48:49] <bvssvni> calien: master
[18:49:11] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[18:49:49] <mhr> Currently doing some bare metal ARM programming here. Is there any way to prevent unwind tables from being output?
[18:50:17] <eddyb> mhr: don't use unwinding :P?
[18:51:02] <eddyb> it's... tricky. I don't think we have a way of disabling it
[18:51:12] <eddyb> LLVM strips most of it at --opt-level=3
[18:52:00] <mhr> eddyb: Oh I'm not using it, but llvm still outputs the unwind ARM directives which causes a small problem when I'm linking.
[18:52:17] <eddyb> mhr: what does the LLVM IR look like?
[18:52:34] <eddyb> mhr: and what optimization level are you compiling at?
[18:52:39] <doener> maybe related to the bug that showed up on the ML today?
[18:52:58] <doener> https://github.com/mozilla/rust/issues/11647
[18:53:20] <_achin> is there anyway to get the reference count on a std::rc::Rc ?
[18:53:35] *** Joins: mentero (mentero@moz-D61C6F02.proxnet.pl)
[18:53:53] <eddyb> _achin: what would you do with it?
[18:54:25] <mhr> eddyb: Compiling with -O. Maybe I can just pass fnoexceptions through --llvm-args?
[18:54:34] <_achin> debugging.  to inspect the values to confirm my understanding of what's happening behind the curtains
[18:54:44] *** Quits: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net) (Quit: I haz left.)
[18:54:53] *** Joins: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net)
[18:55:00] <eddyb> _achin: not really. you could maybe transmute_copy it to a *uint and dereference
[18:55:20] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[18:56:10] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[18:56:33] <_achin> ok, thanks
[18:56:46] <adridu59> acrichto: your PR will remove "task <main> failed at" and the likes, right?
[18:56:46] <eddyb> mhr: maybe. -O is --opt-level=2. compile with --opt-level=3 -S --emit-llvm and gist the outputted ll file
[18:58:09] *** Quits: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net) (Quit: I haz left.)
[18:58:18] *** Joins: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net)
[18:58:41] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[18:58:42] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[18:59:03] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[18:59:05] <acrichto> adridu59: yes
[18:59:19] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[18:59:42] *** Quits: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net) (Quit: I haz left.)
[18:59:50] *** Joins: a__ (a__@moz-56DB9895.nycmny.fios.verizon.net)
[19:00:11] *** Quits: oberstet (quassel@moz-AA658818.dynamic.mnet-online.de) (Client exited)
[19:00:43] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[19:02:12] *** Joins: nham (Mibbit@moz-2C6185F8.lightspeed.dybhfl.sbcglobal.net)
[19:02:34] <eddyb> acrichto: did you see my mention of weak symbols holding trait objects, earlier today?
[19:02:57] <adridu59> acrichto: I have a shell script that greps for "failed at" to catch failures automatically; what keywords should I grep against instead?
[19:03:00] <eddyb> strcat assured me that it's impossible to replace the Task interface with such a statically resolved version :(
[19:03:18] <FliPPeh> Wohoo, finally understood named lifetypes
[19:03:24] <acrichto> eddyb: sorry I lost the backscroll, what's this?
[19:03:38] <acrichto> adridu59: "^error: " I think
[19:03:47] <adridu59> acrichto: thanks!
[19:04:05] *** Quits: jackneill (jackneill@moz-E9D68037.pool.digikabel.hu) (Max SendQ exceeded)
[19:04:10] <eddyb> acrichto: basically a weak static foo: &Trait;
[19:04:21] <eddyb> and #[boot] could be #[weak_prefer="foo"]
[19:04:31] <acrichto> what would that solve?
[19:04:40] <acrichto> you'd still need to switch it out?
[19:04:41] *** Joins: jackneill (jackneill@moz-E9D68037.pool.digikabel.hu)
[19:04:43] *** Joins: depp (depp@500BAFC1.53465674.3C05E6CB.IP)
[19:04:44] <mhr> eddyb: https://gist.github.com/mhrheaume/27147227265f8e4c86b2
[19:04:49] <acrichto> or at least initialize it somewhere
[19:05:23] <eddyb> acrichto: "initialization" would be done by the linker. but it doesn't work in dynamic cases
[19:05:50] <eddyb> mhr: how do you get "no-split-stack"?
[19:06:12] <eddyb> also, c++filt will make the symbols easier to read
[19:06:14] <acrichto> eddyb: I must not be following here, I'm not even sure what this is for
[19:06:33] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Ping timeout)
[19:06:36] <nham> how do loop labels work? "foo: loop {" doesn't seem to work and I can't find an example via google
[19:07:18] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Ping timeout)
[19:07:32] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[19:07:59] <cmr> nham: 'foo
[19:08:30] <cmr> eddyb: what's wrong with functor?
[19:08:54] <eddyb> cmr: well, I don't know what it is. but I don't want that madness from Scala
[19:09:07] <eddyb> acrichto: okay, it won't work for libstd's task interface, but it would allow rust-core to be compiled as a crate and if the default allocator is a weak trait reference, a different crate can override it (and LTO should inline all the vtable calls)
[19:09:12] <depp> what madness from Scala?
[19:09:54] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
[19:10:05] <eddyb> depp: I linked a reddit comment. Ctrl+F Functor
[19:10:24] <depp> surry, I must have joined after you pasted the comment
[19:10:26] <nham> cmr: thanks
[19:10:29] <acrichto> eddyb: well I can tell you that "it won't work" is almost always wrong from what I've seen (there's almost always a way to do it), and we don't have allocators right now so I don't really understand how it interacts with globals/traits
[19:10:30] <sp3d> http://www.reddit.com/r/haskell/comments/1pjjy5/odersky_the_trouble_with_types_strange_loop_2013/cd3bgcu
[19:11:27] <eddyb> acrichto: it's about pluggable *statically resolved* interfaces
[19:11:52] <mhr> eddyb: Using the #[no_split_stack] attribute.
[19:12:01] <eddyb> mhr: I thought that didn't work anymore o_O
[19:12:13] <cmr> eddyb: of course it works.
[19:12:17] <cmr> we depend on it in unwinding.
[19:12:20] <eddyb> it gives you warnings, I didn't think to check if the side effect is still there
[19:12:34] <jsonnull> Are there any recommended packages for embedding a scripting language (such as JavaScript) with Rust?
[19:12:43] <eddyb> cool, so I could've made rustic boot with 0 C code
[19:12:59] <eddyb> jsonnull: we need v8 or SpiderMonkey bindings for JS
[19:13:12] <cmr> servo has sm stuff.
[19:13:27] <cmr> jsonnull: there are lua, python, and ruby bindings scattered about.
[19:13:49] <jsonnull> Thanks guys!
[19:13:52] <depp> I'd love to embed Rust in Rust, 'cause, you know...
[19:14:17] <eddyb> I would gladly provide very powerful v8 integration (done it in C++11 years ago) and with rust macros, defining a Rust function that can be called from JS, it should be very simple to the user
[19:14:19] <cmr> and sm: https://github.com/mozilla-servo/rust-mozjs
[19:14:39] *** Joins: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[19:14:42] <eddyb> my C++11 project never caught on, and I couldn't maintain it forever - but in Rust, it might kill Lua <3
[19:14:54] <cmr> eddyb: why? js is purely inferior :P
[19:15:08] <eddyb> JS is more expressive than Lua
[19:15:20] <mhr> eddyb: Yes, so my only problem now is getting rid of 'zk.o:(.ARM.exidx+0x0): undefined reference to `__aeabi_unwind_cpp_pr0'
[19:15:21] <eddyb> you can transpile Lua to JS but not the other way around
[19:15:30] * yusukesuzuki reply @nagoya313 そういえば VAIO Pro, 3 finger でマルチタップしたいとかそういう思いとかなく, ただ Linux 使いたいという思いならば普通に大変快適です.
[19:15:30] <cmr> you have it backwards.
[19:15:32] <mhr> eddyb: Which shows up when I'm linking.
[19:15:34] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[19:15:35] <cmr> you can't index by objects in js.
[19:15:52] <eddyb> cmr: wait, what?
[19:16:06] <eddyb> though proxies might allow you to do that anyway
[19:16:06] <mhr> Removing .fnstart, .fnend, .cantunwind from the assembly removes these references.
[19:16:16] <eddyb> cmr: Lua grew features like PHP
[19:16:22] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[19:16:25] <eddyb> mhr: weird
[19:16:40] <depp> Lua and JS both have bizarre object models
[19:16:54] <cmr> eddyb: In what way?
[19:16:58] <eddyb> still, ES6 with Rust syntax - can't get better
[19:17:25] <eddyb> cmr: basically all the stuff mentioned on the wikipedia page, that isn't basic
[19:18:05] *** Quits: igork (Adium@9C577557.7893D71C.6E0EE79F.IP) (Ping timeout)
[19:18:12] <cmr> define basic?
[19:18:14] <eddyb> cmr: https://en.wikipedia.org/wiki/Lua_(programming_language)#Metatables for example
[19:18:20] <eddyb> (not basic)
[19:18:48] *** Quits: mhr (mhr@moz-EBDFD4F.cpe.net.cable.rogers.com) (Quit: leaving)
[19:19:01] <eddyb> and embedders like this? https://en.wikipedia.org/wiki/Lua_(programming_language)#Example
[19:19:25] <flaper87> cmr: w/ benchmark https://github.com/mozilla/rust/pull/11649
[19:19:29] <cmr> what point are you trying to make?
[19:19:33] <flaper87> cmr: lemme know if that benchmark is good enough
[19:19:35] <flaper87> :)
[19:19:37] <flaper87> thanks
[19:19:59] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[19:20:01] <eddyb> cmr: that Lua is like taking ES3 and evolving it in a PHP way
[19:20:41] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[19:21:11] <flaper87> eddyb: there are things I can't stand from lua but there are more rants than real arguments against it (like indexes starting from 1 for isntance)
[19:21:31] <flaper87> I've used lua quite a bit and it's not *that* terrible, TBH. 
[19:21:43] <cmr> eddyb: And your support for that statement?
[19:21:52] <flaper87> actually, I'd love to see support for lua in nowdays browsers
[19:22:08] *** Joins: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru)
[19:22:17] <eddyb> flaper87: that's what I said when I had to use Python. then I got sick of its inflexibilities
[19:22:36] <cmr> metatables and the C API have been there in various forms since its inception.
[19:22:46] <cmr> it's simpler and more consistent now than it used to be
[19:22:50] <cmr> hardly the same path php took
[19:22:57] <flaper87> cmr: agreed
[19:23:04] <eddyb> cmr: I know I can't win a fight until I come up with something obviously superior from an user standpoint
[19:23:05] <flaper87> have you guys read the paper with the story of lua?
[19:23:09] <flaper87> I really enjoyed it
[19:23:49] <adridu59> when I pass an owned pointer to a function, will it copy the enclosed value or just the pointer?
[19:23:59] <cmr> adridu59: just the pointer.
[19:24:52] <adridu59> cmr: so what's the footprint difference between & and ~ when passing to a function? and in general?
[19:25:08] <cmr> adridu59: there is none.
[19:25:09] <depp> adridu59: & means that you borrow a reference and pass the borrowed reference
[19:25:11] <adridu59> I mean, are there runtime checks to ~
[19:25:22] <cmr> they have the same representation.
[19:26:29] <adridu59> a bad practise would be to use ~ on a stack allocated variable where you could use & instead, right?
[19:27:07] <kimundi> right
[19:27:09] <stomper> is there a way to make it stop counting the first time the predicate returns false? let v = [1,2,3,4,5,1,1,1]; 	let c = v.iter().count(|x| *x < 4);
[19:28:22] <depp> adridu59: v.iter().take_while(|x| *x < 4).len()
[19:28:30] <depp> er stomper 
[19:28:30] *** Joins: pseudoku (quassel@8267C749.3AABCBEA.520CDC98.IP)
[19:29:04] *** Quits: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se) (Ping timeout)
[19:29:13] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[19:29:15] *** Joins: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se)
[19:29:34] <pseudoku> will it be possible in the future to select over ports and tcp/upd streams like in erlang?
[19:29:51] <eddyb> pseudoku: we certainly hope so :)
[19:30:17] <pseudoku> eddyb: anyone working on it currently?
[19:30:59] * Matthias247 is trying his best
[19:31:49] <pseudoku> Mattias247: thanks for the effort! 
[19:32:42] <Matthias247> I even read the documentation how it looks like in Erlang ;)
[19:33:00] <eddyb> pseudoku: AFAIK acrichto is the go-to core dev for the runtime and such things
[19:33:46] <flaper87> cmr: thnx
[19:34:21] <pseudoku> Mattias247: yeah, erlang makes it as simple as setting a parameter when creating the socket. hope we could have a similarly clean/easy syntax
[19:34:41] <pseudoku> eddyb: thanks!
[19:35:43] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[19:37:21] *** Joins: twi1 (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[19:37:26] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[19:37:51] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Quit: Leaving.)
[19:38:12] * flaper87 doesn't know how that happens in Erlang
[19:38:17] <flaper87> Matthias247: mind sharing ?
[19:38:25] * flaper87 just went really lazy
[19:38:27] <flaper87> :P
[19:38:43] <adridu59> fwiw I'm looking for an idea of a exercise involving pointers (to reiterate); I shall probably look at things like rosetta-code or so
[19:39:03] *** Quits: twi1 (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[19:39:23] <olsonjeffery> acrichto: ping
[19:39:31] <Matthias247> propably better you look up the doku for yourself than asking me ;) But as far as I understood erlang supports two modes: In the first you would do blocking reads, In the other received messages would be automatically put in your process inbox just like messages from other processes
[19:39:56] <olsonjeffery> pseudoku: re: select.. a big "soft spot" in the rust stdlib is the ability to do heterogenuous select
[19:40:30] <olsonjeffery> select is implemented in several specific spots, seperately, for homogenuous types (select for chans, select for IO streams, select for pipes, etc)
[19:40:41] <olsonjeffery> i think the "holy grail" would be a way to unify that
[19:41:14] <Matthias247> currently there is only selector for channels (and timers that convert into channels)
[19:41:21] <olsonjeffery> but there are signifiagant impl hurdles to overcome, there.
[19:41:35] <olsonjeffery> Matthias247: really? i thought there was something for general IO. surprised there isn't.
[19:41:41] <Matthias247> nope, isn't
[19:41:42] <olsonjeffery> it's just a matter of writing it, in that case.
[19:41:55] <olsonjeffery> well, heh. that's obvious.
[19:41:58] <pseudoku> olsonjeffery: agreed. i'm currently writing a serious network app in rust and my whole design is twisted to bypass the lack of heterogenous select
[19:45:03] <Matthias247> I think I have now something that works quite good for rust. But I want to prototype it a little more to be certain
[19:45:12] <olsonjeffery> anyways, as Matthias247 says, acrichto is the go-to dev for that part of the code base. but tackling heterogenous select is a big problem because it requires compatible semantics amongst a bunch of dispirate types on different platforms
[19:45:27] <olsonjeffery> eg messaging is totally in the stdlib, with the except of the yield primitives that're in the runtime
[19:45:32] <olsonjeffery> all the IO impl is in the runtime
[19:45:51] <olsonjeffery> and the native IO has different underlying semantics based on the platform
[19:46:22] <pseudoku> doesn't servo need such mechanisms?
[19:46:35] <depp> some platforms don't have a good way to select on a real file, for example
[19:46:35] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[19:48:06] <olsonjeffery> i imagine a "band-aid" would be a sort of task-based select wrapper, the way you can farm a future's resolution out into another task
[19:48:06] <bascule> selecting on files is often broken or has weird semantics
[19:48:25] <bascule> a way to multiplex channels and I/O objects would be nice
[19:48:27] *** Joins: zeenix (zeenix@moz-B92AB3AA.range109-158.btcentralplus.com)
[19:48:30] <olsonjeffery> yeah. file IO is pretty much synchronous, period. libuv has a thread pool for file IO.
[19:48:44] *** Parts: zeenix (zeenix@moz-B92AB3AA.range109-158.btcentralplus.com) (Leaving)
[19:48:50] *** Joins: haberman (Mibbit@moz-DF9D49BB.hsd1.wa.comcast.net)
[19:49:04] <Matthias247> I would also in Rust stdlib only provide a synchronous API. If anybody thinks that does not work for him he can still spin up a threadpool
[19:49:17] <bascule> seems good
[19:49:24] <olsonjeffery> Matthias247: those're the current semantics of rust's IO traits
[19:49:32] <Matthias247> but doing every file IO async (like uv does) seems like overkill for most applications
[19:49:43] <olsonjeffery> some people want async, though, for high-perf scenarios like nginx
[19:49:49] <olsonjeffery> it's hard to please everyone
[19:49:53] <bascule> yeah it's nice to have both
[19:49:55] <olsonjeffery> but i think synchronous semantics has worked well so far
[19:49:56] <cmr> what's wrong with a separate crate providing it?
[19:50:05] <olsonjeffery> nothing's wrong with it
[19:50:06] <eddyb> I've seen node.js beaten by rust-http, didn't I?
[19:50:07] <bascule> my framework Celluloid(::IO) provides synchronous semantics exclusively right now
[19:50:10] <olsonjeffery> but that's the a point, a different rate
[19:50:10] <cmr> eddyb: yes.
[19:50:24] <olsonjeffery> cmr: i think a good async API is going to expose impl details of the underlying mechanmism
[19:50:28] <Matthias247> eddyb: now that were no fair benchmarks
[19:50:37] *** Quits: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se) (Connection reset by peer)
[19:50:41] <eddyb> at this point, we can almost say async IO is cute
[19:50:42] <depp> hah, you said "fair benchmark"
[19:50:48] <haberman> how can I print the type of a variable?
[19:50:50] <olsonjeffery> what's in std::io is great because we've successfully managed to paper over platform differences and get acceptable perf for 85% of applications at the same time
[19:50:52] <cmr> Matthias247: where there any egregious faults in the benchmark?
[19:50:56] <Matthias247> doing synchronous blocking IO has the lowest latency you can achieve
[19:50:58] <eddyb> haberman: you can trigger an error containing it
[19:51:06] <eddyb> haberman: like let () = value;
[19:51:09] <bascule> Matthias247: being able to mix-and-match libnative and libgreen is nice
[19:51:09] <Matthias247> and that is was rust-http is currently doing
[19:51:10] <depp> Matthias247: not always
[19:51:24] <bascule> Matthias247: can have libnative for low-latency, and libgreen for large numbers of mostly-idle connections
[19:51:34] <olsonjeffery> depends on the runtime and context
[19:51:37] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[19:51:47] <cmr> bascule: ahh, you're the author of celluloid? nice.
[19:51:48] <depp> synchronous vs asynchronous performance depends on ratio of active to total connections, among other things
[19:51:52] <bascule> cmr: yep
[19:51:55] <olsonjeffery> as bascule points out, libgreen would win out, at scale, for websocket type scenarios
[19:52:20] <Matthias247> bascule: my goal is to also enable libnative to support many connections ;)
[19:52:29] <bascule> :D
[19:52:39] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[19:52:55] <olsonjeffery> it'd be neat to disentangle libnative IO out from libnative's concurrency semantics
[19:53:02] <olsonjeffery> the way that librustuv is separated out from libgreen
[19:53:11] <Matthias247> depp: exactly. But if you benchmark a low number of connections that are each request->response->close then sync IO will win for sure
[19:53:14] <haberman> so if "x" is a value type, what is the difference between "let y = x" and "let y = *&x"?
[19:53:23] *** Quits: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com) (Quit: csherratt)
[19:53:31] <haberman> if x's type has a destructor, the second fails but the first succeeds
[19:53:43] <olsonjeffery> haberman: that's a copy
[19:53:48] <haberman> are both of those statements moving statements?
[19:53:56] <cmr> haberman: the first is a plain move, the second is trying to move out of the dereference of a borrowed pointer.
[19:54:30] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[19:54:31] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[19:54:36] <haberman> so moving out of a borrowed pointer isn't allowed?
[19:55:00] <cmr> for non-Pod types, no, since you don't have ownership of the referenced value.
[19:55:04] <depp> haberman: when you borrow a pointer you have to give it back :-)
[19:55:27] * bascule thinks "async" (i.e. callbacks, promises) is an antipattern that should only be used for microoptimizing
[19:55:32] <haberman> excellent, I think this helps me. :)
[19:55:46] <bascule> but that doesn't stop people from building Rails-like web frameworks in that style o_O
[19:56:09] <depp> bascule: yes, let's kill callbacks... 99% of the time
[19:56:12] <bascule> I think after you program in it long enough you get Stockholm Syndrome and your brain gets twisted (lolpun) into thinking it makes sense
[19:56:25] <Matthias247> I think it depends on language and frameworks. E.g. I think Dart has a really nice async integration due to their future semantics
[19:56:42] <Matthias247> But rust and callbacks absolutely don't match
[19:57:01] <bascule> people forget that they could be writing "sequential code, you know, the code you can read"
[19:58:01] <flaper87> bascule: hehe
[19:58:30] <olsonjeffery> ive mostly made peace with callback spaghetti in javascript
[19:58:31] <bascule> (from https://www.youtube.com/watch?v=bzkRVzciAZg)
[19:58:49] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[19:59:00] <bascule> once all the libraries are written promises/streams make the external facing APIs okay
[19:59:07] <bascule> but it's still built on top of a giant pile of async poo
[19:59:10] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[19:59:39] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[20:00:16] *** Quits: mentero (mentero@moz-D61C6F02.proxnet.pl) (Ping timeout)
[20:00:21] <olsonjeffery> async/await codegen trickery ala c# 5.0 is an option
[20:00:23] <bascule> Nodians seem to defend that stuff the way C++ people defend memory management
[20:00:30] <olsonjeffery> and F# is getting some mileage out of FRP
[20:00:38] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[20:00:38] <Matthias247> Can't understand the node.js hype. Not because of async or callbacks, but because i absolutely can't understand why anyone would like to use javascript in a server
[20:00:42] <bascule> "I don't ever do explicit frees in C++ anymore! the memory management situation is totally awesome"
[20:00:54] <eddyb> Matthias247: we didn't have Rust
[20:00:56] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:00:58] <bascule> then they create frameworks like Meteor
[20:01:06] <bascule> that use JS fibers wrapped on top of the async poo o_O
[20:01:16] <bascule> it's like the worst of all worlds
[20:01:21] <Matthias247> eddyb: now there are dozens of programming languages between JS and Rust
[20:01:24] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[20:01:27] <eddyb> olsonjeffery: in ES6, you can use generators to get nice await/async
[20:01:29] <bascule> the overhead of a stack, libraries written in callback/promise spaghetti
[20:02:00] <flaper87> bascule: yeah, and that makes some people say things like: "See? the barrier between the browser and the server has been broken"
[20:02:04] <olsonjeffery> to be fair, the first industrial websockets server API was in node.js .. for better or worse, node.js is useful because it has similar semantics to how javascript works in the browser
[20:02:07] <flaper87> (re meteor)
[20:02:12] <olsonjeffery> so its an impedence match-up, i guess.
[20:02:15] <bascule> flaper87: I like how they were all "security? oh, right..."
[20:02:48] <bascule> olsonjeffery: people don't want to "context switch" (although they have to to write secure applications)
[20:03:04] <Matthias247> olsonjeffery: I had one at the point  the specification was finalized in C++ ;)
[20:03:07] <olsonjeffery> bascule: you say that like its a bad thing
[20:03:14] <olsonjeffery> benefits and tradeoffs
[20:03:26] <bascule> olsonjeffery: well, sometimes they forget (e.g. Meteor's complete lack of security)
[20:03:35] *** Joins: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP)
[20:03:37] <bascule> they bolted on access control as an afterthought
[20:03:38] <bascule> whoops
[20:03:40] <eddyb> Matthias247: I am replacing previous uses of ES6 with Rust. sure, dozens of languages, but how many of them can you get me to like?
[20:04:12] <bascule> olsonjeffery: if you forget about security, it's definitely a bad thing
[20:04:12] <Matthias247> eddyb: I don't know. You are not me ;)
[20:04:13] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[20:04:30] <eddyb> Matthias247: needs to be fast, flexible, neat syntax
[20:04:34] <bascule> olsonjeffery: what bothers me most is the way it's described
[20:04:35] <Matthias247> eddyb: but I would for example use C# to do everthing that node does
[20:04:40] <bascule> not "I want to write everything in JavaScript"
[20:04:50] <bascule> but "I don't want to have to context switch when writing the client and server"
[20:04:50] <eddyb> Matthias247: "Microsoft"
[20:04:51] <bascule> o_O
[20:04:58] *** Joins: jed (jed@moz-9E36FDA5.lightspeed.stlsmo.sbcglobal.net)
[20:05:00] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Connection reset by peer)
[20:05:02] <Matthias247> eddyb: I knew the answer ;)
[20:05:07] *** Joins: ptc (Adium@6C906E9F.9ECAA4DB.BCDD830B.IP)
[20:05:24] <eddyb> Matthias247: also, I wanted something like Rust and I had no Rust
[20:05:29] <olsonjeffery> bascule: my point is that the security of node.js or server-side APIs is orthogonal to whether the lack of a context switch is valuable
[20:05:38] <eddyb> I abused C++11 in a couple places to get close
[20:05:45] <olsonjeffery> that meteor came first (or neccesitated) websockets is besides the point
[20:06:04] <Matthias247> But it has a nice clean syntax, is easy and fast to develop and you are free to choose if you wan't to go all callback style like node or use Tasks or something else
[20:06:07] <eddyb> Matthias247: also, that reminds me I tried using sweet.js (if you haven't seen it, it's basically Rust macros before Rust had macros, for JS) in my decompiler opcode definition nonsense. turns out ES6 does it better
[20:06:12] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[20:06:12] <bascule> olsonjeffery: the first release of Meteor shows what happens when people ignore security while trying to avoid context switching
[20:06:14] <olsonjeffery> meteor isn't bad because server-side JS is bad. meteor is bad because it's a poor model.
[20:06:28] <bascule> Meteor was more or less a self-inflected "SQL" (or rather Mongo) injection attack
[20:06:32] <eddyb> I haven't even heard about Meteor before
[20:06:54] <bascule> of course JavaScript in the browser is self-inflicted remote code execution
[20:06:55] <bascule> so whatever
[20:06:55] <bascule> lol
[20:07:17] <eddyb> bascule: blame GPU manufacturers
[20:07:25] <eddyb> (servo <3)
[20:07:42] <olsonjeffery> anyways. let's all agree that heterogenuous select would be swell and move on.
[20:08:02] <geomyidae>  speaking of which, is there actual work happening on that? a design doc? a google doc? etc?
[20:08:10] <Matthias247> olsonjeffery: I promise I will give an update about that tomorrow
[20:08:17] <geomyidae> oh :)
[20:08:20] <jed> so when I call a static function that's part of a trait which has a type parameter, how do I specify which implementation of the trait I want?
[20:08:33] <bascule> olsonjeffery: anyway, my point was when you're writing server code, you have to think of the client as a potential attacker
[20:08:46] <jed> for example: TraitName::func_name::<TypeParameter>(arg0) claims that a type parameter is missing.
[20:08:48] <cmr> jed: the only way right now is through type inference.
[20:08:53] *** Joins: ktt3ja (ktt3ja@moz-54586A12.washdc.fios.verizon.net)
[20:08:59] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[20:09:07] <cmr> in the future it will be TraitName::<for SomeType>::func_name
[20:09:31] <eddyb> Matthias247: I can do ES6-like generators in Rust, with loadable syntax extensions, they wouldn't be as efficient as they could eventually be, see https://github.com/mozilla/rust/issues/11455
[20:09:47] <eddyb> async/await, soon, maybe :)
[20:09:47] <jed> cmr: so even if my trait has only one impl, how should I spell this out?
[20:09:51] <Matthias247> I'm nearly done implementing something for TCP and want to do timers and channels next to see how it works\fs26
[20:10:09] *** Quits: pseudoku (quassel@8267C749.3AABCBEA.520CDC98.IP) (Client exited)
[20:10:11] <bascule> Matthias247: nice
[20:10:19] <bascule> a gen_fsm-alike would be nice
[20:10:20] <cmr> jed: the canonical workaround is to include an Option<Self> parameter in the method you want, and pass None::<SomeType>
[20:10:23] <bascule> I have those in Celluloid
[20:10:39] <jed> well I am glad I asked because I literally would have never figured that out
[20:10:49] <Matthias247> eddyb: I think with the "microtasks" there would be no need for async/await?
[20:11:05] <bascule> modeling network clients and servers (and particularly timeouts) as FSMs is <3
[20:11:30] <eddyb> Matthias247: microtasks sounds like one way to implement generators
[20:11:44] <Matthias247> eddyb: I mean the tasks in libgreen
[20:11:48] <eddyb> but no, this is more general than async stuff
[20:12:18] *** Quits: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net) (Ping timeout)
[20:12:20] <eddyb> you can't compare a state machine with a task
[20:12:29] *** Joins: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net)
[20:12:53] <bascule> you can build state machines on top of tasks, and use state machines to control how tasks talk to each other
[20:13:08] <eddyb> and then explode my brain?
[20:13:08] <bascule> particularly if they're talking with asynchronous protocols and you'd like fault tolerance
[20:13:12] <bascule> hahaha
[20:13:18] <Matthias247> of course it's something different. But the goals are similar. Give the programmer a more linear view of what happens
[20:13:19] <bascule> this is a pretty common way of building programs in Erlang
[20:13:30] <eddyb> bascule: *Erlang*
[20:13:33] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[20:13:46] * bascule likes Erlang ;) (kind of)
[20:14:00] <bascule> I hear they're finally getting maps
[20:14:01] <bascule> :O
[20:14:13] <eddyb> there is one ES6 trick I like that Rust can't really do atm, and it's tied in with syntax so you no macros will work. it's the quasi/template strings
[20:14:32] <erickt> is it possible to have a struct impl two different traits that have the same function declaration?
[20:14:55] <SiegeLord> Sure, why not
[20:15:04] <eddyb> optional_filter`foo ${embedded_expression} bar "${the_filter_could_escape_this + '"'}"`
[20:15:05] <SiegeLord> A tiny bit tricky to call it afterward
[20:15:32] <olsonjeffery> is the `bytes!` encoding utf8?
[20:15:38] <erickt> oh, silly me, I can just move the implementation of the trait
[20:15:58] <eddyb> you can `use` the trait in two different scopes
[20:16:19] <olsonjeffery> yeah, that.
[20:16:45] <Matthias247> I really don't think that async/await works good for Rust because it's mostly sugar for callbacks. And for those you somehow have to save the whole environment. If you want to do that in a safe way I excpect each type would have to become Rc<RefCell<T>>
[20:17:08] <depp> I'/me agrees
[20:17:26] <ktt3ja> erickt: can you show me an example?
[20:17:29] <depp> I use async/await in C# 5.0 heavily at work, and it has a lot of weird implications
[20:17:30] <eddyb> Matthias247: think generators, as in Python/ES6
[20:17:31] *** Joins: Jemaclus (Mibbit@moz-5A4BC30.hsd1.ca.comcast.net)
[20:18:14] <Matthias247> eddyb: unfortunatly I don't know these ;)
[20:18:16] <erickt> eddyb / ktt3ja: I'm extracting StrSlice::as_bytes into a trait
[20:18:56] <Matthias247> depp: I can imagine that. I'm really not sure what happens if another callback between the async and await manipualtes everything to a state you don't expect
[20:18:57] <eddyb> Matthias247: oh, so you don't know what I'm talking about :)? do you know any language using the "yield" keyword?
[20:19:29] <Matthias247> yeah, C#, but in a different way :-)
[20:19:30] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[20:19:42] <Matthias247> ok, also have seen a few lines of stackless python were it was used
[20:19:58] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[20:20:08] <erickt> ktt3ja: I'm guessing you can do a `impl<'a> Bytes for &'a str { fn as_bytes(&'a self) -> &'a [u8] { use str::StrSlice; self.as_bytes() } }`
[20:20:16] <depp> Matthias247: The big thing is you can't await inside a lock, which makes sense sort of, but it means that you have to carefully think if your code is IO-bound or CPU-bound and use different threading
[20:20:39] <depp> the nice thing about vanilla threading is that it don't matter if your thread is IO or CPU bound
[20:20:39] *** Quits: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net) (Ping timeout)
[20:21:05] <Matthias247> depp: I think the async/await most mostely done so that you can do all kinds of things on your main/UI loop and don't use locks :)
[20:21:16] <eddyb> Matthias247: fn *foo(start: int, stop: int) => Iterator<int> {for i in range(start, stop) {yield i * i;}} foo(start, stop) <=> range(start, stop).map(|i| i*i)
[20:21:23] <ktt3ja> erickt: heh
[20:21:30] <ktt3ja> erickt: k thanks
[20:21:49] <depp> Matthias247: yeah, but you can only do IO or use timers on the main thread, you can't do CPU stuff because it's cooperatively scheduled
[20:21:52] <eddyb> Matthias247: if you write a parser using generators, you get an iterator-like interface for free
[20:22:02] <depp> Matthias247: I don't actually use it for GUI stuff anyway
[20:22:09] <eddyb> in such a way that you can feed it one byte at a time and it will still work
[20:22:15] *** Quits: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se) (Connection reset by peer)
[20:22:45] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[20:23:04] <Matthias247> eddyb: thats basically the yield that also C# has. But for me this kind of another construct than async/await. Although both are implemented by compiling into state machines
[20:23:26] <eddyb> Matthias247: I've implemented a PNG decoder as a state machine, and it would be somewhat nicer with generators
[20:23:44] <eddyb> especially, I wouldn't have 4 enum variants for reading an u32
[20:23:59] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[20:24:01] *** Joins: eevee (eevee@moz-8DEBFFC9.lv.lv.cox.net)
[20:25:23] <Tobba> writing PNG decoders is awful
[20:25:26] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[20:25:29] <johnsoft> is there any kind of convenience initializer for HashMap?
[20:25:37] <cmr> johnsoft: HashMap::new() ?
[20:25:45] <olsonjeffery> heh, was just gonna say that..
[20:25:49] <jsonnull> Is there a way to find the current working directory that a rust executable is running in?
[20:25:50] <Matthias247> depp: but you could wrap your Do-Sth-In-Workerthread operation in an async-await that is started in the mainthread. I even think that's pretty simple
[20:25:52] <johnsoft> hah
[20:26:07] <johnsoft> i mean, pass in a vector of (K, V) or something like that
[20:26:19] <jsonnull> I need to reference a directory relative to the executable itself, as opposed to the directory I'm calling the executable from.
[20:26:21] <johnsoft> a one-liner withoullt cagin insert
[20:26:25] <cmr> jsonnull: std::os::getcwd
[20:26:36] <eddyb> Tobba: with generators it would be *beautiful*
[20:26:40] <johnsoft> *without calling
[20:26:43] *** Parts: ptc (Adium@6C906E9F.9ECAA4DB.BCDD830B.IP) ()
[20:26:50] <Tobba> specially when indexing gets involved
[20:26:51] <jsonnull> Will that get the directory the executable resides in, or the one I call it from?
[20:26:52] <Tobba> and 4BPP
[20:26:54] <Tobba> and zlib
[20:26:55] <cmr> johnsoft: [(a, b), (c, d)].iter().collect()
[20:27:18] <depp> Matthias247: But what's not simple is reasoning about what thread your async task is running on.
[20:27:28] <cmr> jsonnull: well cwd isn't exactly that, but I see what you want now, and it's not getcwd
[20:27:34] *** jorendorff_away is now known as jorendorff
[20:27:41] <flaper87> mmh, not sure how #[feature(globs)] works
[20:27:43] <johnsoft> a bit roundabout but works, thanks
[20:27:53] <cmr> jsonnull: why do you want that? there's no way to get the dir the executable resides in atm.
[20:27:54] <olsonjeffery> flaper87: needs a semicolon!
[20:27:54] <flaper87> I put it at the top of the crate but it doesn't seem to work
[20:27:59] <flaper87> olsonjeffery: damnit!
[20:28:01] <flaper87> thanks
[20:28:03] <flaper87> :D
[20:28:03] <Tobba> I should do a rust zlib port
[20:28:07] <eddyb> Tobba: well, maybe not the tight loops performing specialized conversions
[20:28:22] <SiegeLord> flaper87: Didn't it give a warning?
[20:28:22] <olsonjeffery> yeah. create/top-level attributes are weird.
[20:28:23] <Tobba> specially reading an arbitary bitstream
[20:28:25] <Tobba> is absolutely awful
[20:28:28] <olsonjeffery> many have stubbed their toe on it
[20:28:32] <eddyb> Tobba: I want to implement inflate in rust
[20:28:33] <Tobba> then when interlacing gets involved it gets beyond awful
[20:28:35] <olsonjeffery> SiegeLord: iirc the compiler error is not-at-all helpful
[20:28:37] <flaper87> SiegeLord: nope
[20:28:45] <eddyb> Tobba: I implemented interlacing in a nice way
[20:28:49] <flaper87> olsonjeffery: it is not at all, I'd say
[20:28:55] <flaper87> I'll look into it
[20:28:57] <olsonjeffery> it basically applies the attribute to the immediately following item
[20:29:01] <olsonjeffery> so it'll get swallowed up basically
[20:29:09] <olsonjeffery> but features have to be freestanding to actually work
[20:29:15] <jsonnull> cmr: I need to load a font resource from file, and I currently can't unless I'm particular about which directory I'm in when I call the executable.
[20:29:48] <SiegeLord> It gives the warning here... ::shrug::
[20:29:56] <eddyb> Tobba: you sound like you saw code much much worse than what I wrote :P
[20:30:26] <Tobba> yeah I've implemented a png loader
[20:30:38] <Tobba> when I had to load bits at an arbitary position, handle the palette with arbitary depth and shit
[20:30:42] <Tobba> it just got bad
[20:31:12] <eddyb> it's not arbitrary ;)
[20:31:14] <Matthias247> eddyb: the thing about ES6 is that it might get some nice high level features but that won't help when still the fundamentals (like object comparison) are broken :)
[20:31:28] <eddyb> how is object comparison broken?
[20:31:39] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[20:31:44] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[20:31:46] <Matthias247> by the stupid implicit conversions, most time into strings
[20:31:56] <eddyb> ah, you mean value comparisons
[20:32:01] *** Quits: nham (Mibbit@moz-2C6185F8.lightspeed.dybhfl.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:32:09] <eddyb> just use ===, it's also faster most of the time
[20:32:15] <Matthias247> if (0 == null)
[20:32:34] *** Joins: mib_9x3571 (Mibbit@moz-CC5F54A7.dip0.t-ipconnect.de)
[20:33:16] <Matthias247> or having to compare against null and undefined
[20:33:16] *** Quits: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se) (Connection reset by peer)
[20:33:24] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[20:33:55] *** Quits: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca) (Ping timeout)
[20:33:59] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[20:34:59] *** Joins: maxli (maxli@moz-F47DD19B.student.cs.uwaterloo.ca)
[20:36:17] *** Joins: c-a (c-a@moz-57C82A9.a163.priv.bahnhof.se)
[20:36:58] <johnsoft> rusti: let map = [(1, 2), (4, 5)].iter().collect();
[20:37:01] -rusti- pastebinned 6 lines of output: http://ix.io/9XT
[20:37:25] <johnsoft> do i also need to tell it the types somehow?
[20:37:46] <cmr> johnsoft: yes, try (1i, 2i)
[20:38:01] <cmr> (numeric literals can infer to any of the builtin numeric types)
[20:38:07] <jsonnull> cmr: I've found std::os::self_exe_path
[20:38:15] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[20:38:16] <johnsoft> rusti: let map = [(1i, 2i), (4i, 5i)].iter().collect();
[20:38:17] <olsonjeffery> rusti: let map: HashMap<int, uint> = [(1, 2), (4, 5)].iter().collect();
[20:38:20] -rusti- pastebinned 6 lines of output: http://ix.io/9XU
[20:38:20] -rusti- pastebinned 7 lines of output: http://ix.io/9XV
[20:38:29] *** jorendorff is now known as jorendorff_away
[20:38:38] <cmr> ah that too.
[20:38:48] <MrByte> How is [u8, ..16] represented in memory?
[20:38:56] <eddyb> MrByte: 16 consecutive bytes
[20:39:03] <johnsoft> what if I want to call func([...].iter().collect())
[20:39:07] <MrByte> No size information or anything?
[20:39:12] <cmr> MrByte: no
[20:39:14] <johnsoft> is there anything like haskell's :: operator?
[20:39:18] <MrByte> Alright.
[20:39:20] <kimundi> MrByte: The size information is part of the type
[20:39:27] <adridu59> ptr+length I assume?
[20:39:29] <MrByte> So then what I'm doing should be fine, then.
[20:39:36] <cmr> adridu59: not fixed-length arrays, no.
[20:39:39] <depp> johnsoft: closest thing is :
[20:39:40] <kimundi> [u8, ..16] is a different type than [u8, ..8] for example
[20:39:48] <olsonjeffery> MrByte: memory-layout compatibility w/ C structs/arrays is a goal for rust structs and contiguous data (like vevs)
[20:39:50] <olsonjeffery> vecs*
[20:39:56] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Ping timeout)
[20:40:01] <johnsoft> how would : be used?
[20:40:03] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Input/output error)
[20:40:36] <MrByte> Trying to work on a blog post about COM and was using Uuid, but I keep getting errors that the Uuid doesn't exist.  So just wanted to verify I wasn't doing something wrong in terms of memory layout.
[20:40:38] <kimundi> johnsoft: As in, let var : type;
[20:40:45] *** Joins: hdevalence (quassel@moz-D125A39F.home3.cgocable.net)
[20:40:49] <Matthias247> MrByte: it's the same as a char[16] in C if you wanted to know that ;)
[20:40:58] <johnsoft> ah so it can't be part of an expression then
[20:41:00] <cmr> MrByte: what error?
[20:41:00] <olsonjeffery> rusti: let map = { use std::hashmap::HashMap; let map: HashMap<int, uint> = [(1, 2), (4, 5)].iter().collect(); map }
[20:41:02] -rusti- pastebinned 6 lines of output: http://ix.io/9VA
[20:41:15] <adridu59> cmr: so it's stack allocated?
[20:41:19] <MrByte> COM error about the class id not being registered, even though it is.
[20:41:26] <kimundi> johnsoft: Nope. Though there was talk about ultimativly allowing : after any expression
[20:41:28] <cmr> ah ok
[20:41:48] *** Joins: quiggle (Mibbit@moz-FA92507D.hsi8.kabel-badenwuerttemberg.de)
[20:41:51] <geomyidae> sounds like an interesting blog post
[20:42:02] <kimundi> adridu59: If you put it unboxed on the stack, then yes
[20:42:06] <cmr> adridu59: not necessarily. Rc<[int, ..5]> or ~[int, ..5] are pointers to fixed-size arrays.
[20:42:07] <adridu59> so DST are ptr+length? do they have to be allocated contiguously?
[20:42:09] <johnsoft> i may have to lobby for a HashMap::from_pairs method
[20:42:25] <adridu59> cmr, kimundi: yea I meant the bare variant :)
[20:42:30] <eddyb> johnsoft: what would it do?
[20:42:33] <olsonjeffery> johnsoft: better yet, submit a PR
[20:42:41] <cmr> eddyb: pairs.iter().collect()
[20:42:55] <cmr> or it'd probably just take the iterator.
[20:42:59] <eddyb> cmr: we don't have a Hash- oh, new takes no argument, okay
[20:43:08] <eddyb> cmr: it should take an Iterable
[20:43:16] <MrByte> My eventual goal is a DirectX wrapper for rust.  While DirectX itself avoids all the hoops you jump through to get COM objects (it has its own factory methods), the objects still use COM interfaces/vtables.
[20:43:27] <eddyb> so it can take a slice, a vector or an iterator ;)
[20:43:45] <eddyb> MrByte: but... OpenGL :P
[20:43:45] <MrByte> So I figured I'd at least start with a basic COM class written in C# and work my way towards DirectX and blog about it as I go.
[20:44:25] <eddyb> about vtables, if you mimic Rust's trait ABI, you can get pretty far
[20:44:26] <MrByte> OpenGL is great, but having the option of DirectX is always nice.
[20:45:00] <johnsoft> olsonjeffery- I may just do that :)
[20:45:09] <depp> speak for yourself, I don't like having options
[20:45:12] <cmr> johnsoft: I suggest not.
[20:45:22] <cmr> johnsoft: Having even more wrappers for collect is unlikely to be accepted.
[20:45:28] *** Joins: leroux (leroux@moz-421CF1E4.dsl.bell.ca)
[20:45:46] <johnsoft> hash literals aren't a common enough case to be useful?
[20:46:06] <SiegeLord> I'd use a macro
[20:46:09] <eddyb> johnsoft: may cause abuse
[20:46:20] <cmr> the only thing that would get accepted (taking an Iterator<(A, B)>) isn't going to look like a hash literal.
[20:46:20] <eddyb> SiegeLord: maching => is possible, right?
[20:46:26] *** Joins: mib_lj4fxe (Mibbit@moz-FA92507D.hsi8.kabel-badenwuerttemberg.de)
[20:46:30] <SiegeLord> I'm sure
[20:46:38] *** Quits: mib_lj4fxe (Mibbit@moz-FA92507D.hsi8.kabel-badenwuerttemberg.de) (Quit: http://www.mibbit.com ajax IRC Client)
[20:46:44] <eddyb> : might be awkward when you have values
[20:46:46] <kimundi> adridu59: Under DST, pointers to unsized types would be represented either as a ptr+len pair for types that contain [T] as a field somewhere, or as ptr+vtableptr for trait objects. 
[20:46:58] <eddyb> [key]: value is too silly
[20:47:02] <johnsoft> cmr - that was the plan
[20:47:12] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Ping timeout)
[20:47:20] <eddyb> cmr: Iterable<(K, V)> pls
[20:47:29] <cmr> eddyb: it doesn't exist, go write it.
[20:47:39] <MrByte> Also... I'm loving the temporary lifetimes.  So much cleaner.
[20:47:55] *** Quits: pzol (pzol@moz-553BEE64.dynamic.chello.pl) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:48:11] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[20:48:16] <johnsoft> would something that could be used like HashMap::from_pairs(&[~"key", ~"value"]) be accepted?
[20:48:16] <bascule> https://www.mobilespan.com/content/chrome-is-the-new-c-runtime
[20:48:22] <adridu59> kimundi: so, it can't be fragmented on the heap?
[20:48:25] <bascule> ^^^ I want that, but with Rust and Servo ;)
[20:48:33] <eddyb> cmr: trait Iterable<T, I: Iterator<T>> {fn iter(&self) -> I;}
[20:48:37] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[20:48:43] <kimundi> adridu59: Not as is
[20:48:49] <eddyb> johnsoft: you missed ()?
[20:48:59] <Amaranth> bascule: Servo wouldn't have anything to do with it, really. He isn't talking about Chrome the browser but the libraries that it depends on
[20:49:07] <johnsoft> oops, yes i did
[20:49:11] <kimundi> adridu59: fragments on the heap don'T sound like a primitive type anyway :P
[20:49:15] <cmr> eddyb: not going to work, vec iterators need to borrow the vector.
[20:49:15] <bascule> Amaranth: I'm aware bro
[20:49:31] <Amaranth> ...did you just call me bro?
[20:49:33] <johnsoft> HashMap::from_pairs(&[(~"k", ~"v"), (~"K", ~"V")])
[20:49:37] <bascule> are you female?
[20:49:48] <bascule> if so, my apologies
[20:49:51] <eddyb> johnsoft: no need for &, I would think. depends
[20:50:08] <Matthias247> bascule: I thought it sounds like an awful workaround for C++ not having a good standard library :)
[20:50:09] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[20:50:14] <bascule> hahahaha
[20:50:19] <adridu59> kimundi: right
[20:50:40] <adridu59> kimundi: so theorically I could run out of memory because my heap is too fragmented
[20:50:46] <eddyb> cmr: needs DST and lifetime annotations on traits?
[20:51:09] <johnsoft> maybe i'll just drop an impl on the mailing list and let the politics sort themselves out without me
[20:51:12] <cmr> eddyb: I don't think it's possible at all.
[20:51:24] *** Joins: nif (nif@moz-8181E2AC.oberlin.net)
[20:51:26] <eddyb> cmr: never say never
[20:51:27] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[20:51:35] <kimundi> adridu59: Well, that is a problem with the allocator in general
[20:51:36] <cmr> I didn't.
[20:51:38] <Matthias247> besides that the codebase is propably that gigantic you don't want to have it in your average program
[20:52:29] <adridu59> kimundi: does the OS do something to defragment memory?
[20:52:44] <depp> adridu59: it's not memory fragmentation that you worry about
[20:52:59] <depp> adridu59: or rather, it's not RAM, it's address space fragmentation
[20:53:18] <depp> adridu59: the OS cannot defragment address space
[20:53:23] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[20:53:30] <adridu59> I see
[20:53:53] <depp> adridu59: if address space is defragmented, it is done by the runtime
[20:54:12] <eddyb> cmr: trait Iterable<'a, T, I: Iterator<T>> {fn iter(&'a self) -> I;} impl<'a, T> Iterable<'a, T, Items<'a, T>> for [T] {fn iter(&'a self) -> Items<'a, T> {self.items()}}
[20:54:16] <eddyb> cmr: did I miss anything?
[20:54:44] <cmr> eddyb: does that work?
[20:55:01] *** Quits: Jemaclus (Mibbit@moz-5A4BC30.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:55:02] <eddyb> cmr: with DST and lifetime annotations on traits, yes
[20:55:40] <cmr> hm, maybe.
[20:55:50] *** Joins: ptc (Adium@6C906E9F.9ECAA4DB.BCDD830B.IP)
[20:55:50] <eddyb> cmr: did you see my proposal for extending operator overloads? trait Add<'lhs, 'rhs, Rhs, Ret> {fn add(&'lhs self, &'rhs Rhs) -> Ret;}
[20:55:52] *** Parts: ptc (Adium@6C906E9F.9ECAA4DB.BCDD830B.IP) ()
[20:55:54] *** Joins: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br)
[20:56:04] <cmr> no
[20:56:12] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[20:56:25] <eddyb> and another example (that would be enabled by it) let list = StackList::new() | 1 | 2 | 5 | 6;
[20:56:41] <adridu59> depp: does Rust do that?
[20:56:45] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[20:56:49] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:56:51] <cmr> adridu59: no, it's not possible.
[20:56:52] <depp> adridu59: No, but there is no need.
[20:56:55] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[20:57:00] <cmr> adridu59: (with interior pointers, that is)
[20:57:09] <depp> adridu59: Modern allocators do not have problems with fragmentation.
[20:57:18] <adridu59> okay
[20:57:56] <depp> adridu59: unless your application especially tries to fragment memory, you will not succeed, and even then there is an upper limit to the amount of fragmentation you can get
[20:58:31] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[20:59:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[21:00:21] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[21:00:59] <bvssvni> is it possible to set noise percent when benchmarking?
[21:01:00] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[21:01:44] <adridu59> depp: it's allocated the "tetris way"?
[21:02:03] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[21:02:05] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Connection reset by peer)
[21:02:24] <pepper_chico> guys, can you explain me how rust deals with an inefficiency bit I'm stumbling upon, Rust now deprecated in-language GC boxes and pointers, now it's all library provided, since GC object are created using a mere generic function, at first, it seems (without mentioning optimization) there always will be a copy of arguments passed to Rc/Gc::new to the actual object to be construct in the heap, there's isn't direct construction in heap o
[21:02:24] <pepper_chico> f a new Rc/Gc object, there should always be such a copy-construction?
[21:02:44] <pepper_chico> what's the matter about this stuff?
[21:03:08] <eddyb> technically, if the Rc::new function is inlined, there is no copy
[21:03:10] <cmr> pepper_chico: we have placement-new for it.
[21:03:17] <cmr> pepper_chico: box(GC) expr;
[21:03:20] <kimundi> pepper_chico: We plan to introduce the "box" keywords as in-place allocation operator
[21:03:24] <eddyb> and the "box" operator should bypass that issue altogether
[21:03:26] <cmr> kimundi: already done :)
[21:03:35] <eddyb> cmr: poorly so :P
[21:03:36] <pepper_chico> hmm
[21:03:36] <cmr> rusti: box(GC) 42
[21:03:37] -rusti- std::gc::Gc<int>{ptr: @42}
[21:03:38] <pepper_chico> ah ok
[21:03:59] <kimundi> cmr: Well, is it actually implemented as opposed to just parsing?
[21:04:03] <cmr> kimundi: see ^
[21:04:10] <kimundi> ah, right
[21:04:10] <cmr> rusti: box(HEAP) 42
[21:04:13] -rusti- pastebinned 7 lines of output: http://ix.io/9XX
[21:04:18] <pepper_chico> wellm this stuff in not in the tutorial yet right?
[21:04:22] <sfackler> it is kind of hacky right now
[21:04:23] <cmr> pepper_chico: no
[21:04:28] <cmr> it is very hacky right now
[21:04:28] <pepper_chico> nor docs...
[21:04:30] <depp> adridu59: You can read jemalloc or tcmalloc source if you want all the answers.
[21:04:32] <pepper_chico> ok
[21:04:37] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[21:04:39] <cmr> pepper_chico: it's not fuly implemented yet.
[21:04:45] <pepper_chico> ok
[21:05:03] <adridu59> depp: some sort of preemptive alloc? rust doesn't use jemalloc anymore though
[21:05:12] <cmr> rusti: box(std::unique::HEAP) 42
[21:05:14] -rusti- pastebinned 13 lines of output: http://ix.io/9XY
[21:05:28] <cmr> ah owned
[21:05:33] <cmr> rusti: box(std::owned::HEAP) 42
[21:05:34] -rusti- ~42
[21:05:35] <cmr> yay
[21:05:35] <pepper_chico> cmr, but as of now, there're copies with Rc/Gc::new till this stuff is finished?
[21:05:38] <kimundi> rusti: box 42;
[21:05:39] -rusti- ()
[21:05:43] <cmr> pepper_chico: no, box works right now.
[21:05:46] <depp> adridu59: preemptive?  I don't know what that means in this context.  Anyway, jemalloc and tcmalloc are resources for learning about modern allocators, I didn't say they were used by Rust.
[21:05:55] <kimundi> rusti: box 42
[21:05:56] -rusti- ~42
[21:05:59] <adridu59> depp: k, thanks
[21:06:03] <eddyb> pepper_chico: the copies are there in *unoptimized* code
[21:06:27] <cmr> eddyb: what the optimizer does isn't relevant to the semantics of the language, which is what the original question was.
[21:06:45] <eddyb> original, the follow-up questions seem to care about performance
[21:06:56] <eddyb> cmr: good thing that HEAP isn't in prelude. I hate it :P
[21:07:06] <adridu59> so box is about avoiding copy for library type? mmh; hope ~ will stay nonetheless!
[21:07:22] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Connection reset by peer)
[21:07:28] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[21:07:29] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[21:07:29] *** ChanServ sets mode: +o jdm
[21:08:23] <eddyb> type ~<A=Heap>T = Uniq<T, A>;
[21:08:58] *** Joins: bitwalker (bitwalker@moz-1684082D.hsd1.mn.comcast.net)
[21:09:24] <eddyb> adridu59: not for allocating
[21:09:59] <adridu59> eddyb: not for heap?
[21:10:07] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[21:10:11] <pepper_chico> I was asking about the semantics indeed, hence I've put "not regarding optimization" between parentheses
[21:10:14] <eddyb> adridu59: hmm?
[21:10:48] <adridu59> eddyb: how would ~ not allocate?
[21:10:58] <eddyb> adridu59: ~ as an operator will be gone
[21:11:02] <adridu59> eddyb: oh you mean it won't be able to be used for it
[21:11:05] <adridu59> right
[21:11:11] <pepper_chico> cmr, you said that is working right now, you mean that, at tip of trunk, Rc::new/Gc::new take advantage of this?
[21:11:28] <eddyb> pepper_chico: no, box has only a primitive implementation
[21:11:32] <cmr> pepper_chico: no, you would use box(GC) instead of Gc::new
[21:11:42] <cmr> pepper_chico: Foo::new will always have the copy.
[21:11:47] <pepper_chico> so, Gc::new is to be deprecated?
[21:11:56] <pepper_chico> etc...
[21:11:58] <cmr> pepper_chico: box isn't implemented for Rc/anything besides Gc/~T yet.
[21:12:06] <cmr> yeah, probably
[21:12:07] <eddyb> the advantage exists at --opt-level=0, btw
[21:12:22] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[21:12:23] <pepper_chico> hmm, ok
[21:12:30] <adridu59> yea I think it's sad; I've seen that reasoning that "people use it too much" but I don't think we should avoid concise syntax because of what seem to be derps; we don't even have easy-to-approach docs for newcomers
[21:12:32] <eddyb> (at which you have bigger problems to aworry about)
[21:12:48] <pepper_chico> wow, it's the third iteration of Gc usage in rust? =)
[21:12:54] <pepper_chico> at last, what I recall of
[21:13:07] <cmr> pepper_chico: Gc::new was always transitory, but yes.
[21:13:19] <eddyb> we don't have Gc yet btw
[21:13:21] <pepper_chico> ok
[21:13:28] <eddyb> it's all smoke and mirrors :)
[21:13:36] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[21:13:57] <eddyb> adridu59: thing is, box should be able to infer the smart pointer type
[21:14:17] <adridu59> wasn't box(GC) to become box(Gc) for consistency? these uppercase chars are nasty anyways imo, much like box(HEAP) :p
[21:14:20] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[21:14:27] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[21:14:31] <eddyb> GC/HEAP are a temporary hack
[21:14:52] <adridu59> eddyb: similar to how proc() was introduced?
[21:14:59] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[21:15:07] <pepper_chico> what, ~ will be gone???
[21:15:09] <eddyb> adridu59: hmm?
[21:15:09] <pepper_chico> you mean
[21:15:17] <pepper_chico> ~42 will be gone?
[21:15:28] <adridu59> pepper_chico: yes unless for type annotations e.g. ~int
[21:15:37] <Tobba> wait what=
[21:15:49] <pepper_chico> I was thinking of it as ~<a constructor>
[21:15:54] <eddyb> pepper_chico: yes. why would you put an integer on the heap anyway?
[21:15:55] <adridu59> pepper_chico: supposed to be box 42 instead (short for box(HEAP))
[21:16:02] <eddyb> pepper_chico: it's not a constructor, it's a value
[21:16:09] <Tobba> thats probably a lot better though
[21:16:51] <adridu59> eddyb: well proc() was introduced because of type inference too or something
[21:16:57] <pepper_chico> eddyb, I was thinking that way, because thinking it just as a value, would also imply copy
[21:16:58] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[21:17:04] <pepper_chico> from value to heap
[21:17:06] <cmr> adridu59: no, proc is its own type etc.
[21:17:13] <eddyb> adridu59: no, do was removed because it was inferring closure/proc
[21:17:25] <eddyb> pepper_chico: value doesn't imply copy
[21:17:38] <adridu59> hmm ok
[21:18:07] <pepper_chico> eddyb, imply semantically a copy from stack value, to heap, and not direct initialization on the heap
[21:18:21] <eddyb> pepper_chico: semantically != what happens
[21:18:30] <eddyb> Rust is a dead horse without optimizations
[21:18:37] <adridu59> cmr: I am writing a chapter on ptr, ownership, lifetimes
[21:18:40] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[21:18:49] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[21:18:55] <eddyb> and we still run into missing/botched LLVM optimizations from time to time
[21:19:09] *** Quits: jackneill (jackneill@moz-E9D68037.pool.digikabel.hu) (Quit: WeeChat 0.4.1)
[21:19:09] <eddyb> pepper_chico: box is designed to make in-place initialization more explicit
[21:19:20] <adridu59> cmr: I'll show it to you once I have decent content
[21:19:22] <cmr> pepper_chico: `~foo` evaluates foo, the result is directly stored into the owned box.
[21:19:30] <cmr> pepper_chico: same with `box expr`
[21:20:01] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[21:20:31] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Ping timeout)
[21:20:31] <depp> how do I install a rust package locally?
[21:20:39] <pepper_chico> man, if the semantics can't be properly defined, and one would work based on potential optimization, I would not care much about the language, I hope the semantics to be defined, as c++ also has gone through, RVO/NRVO/copy-elision still exist, but there're move semantics
[21:20:44] *** Quits: Fatalnix (bhodgins@moz-20A07419.ptldme.east.myfairpoint.net) (Quit: Lost terminal)
[21:21:20] <cmr> pepper_chico: the semantics are defined (even if they're not fully documented in the manual yet)
[21:21:37] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Input/output error)
[21:22:05] <pepper_chico> that's what I'm most interested for the language to have =)
[21:22:13] <pepper_chico> not voodoo optimizations
[21:22:51] <eddyb> pepper_chico: you want semantics? function arguments are copied from the stack to the stack, before using them
[21:22:54] <depp> I'm trying to install a Rust library locally so I can just use it from other projects... "rustpkg install some-lib" installs it in the wrong place... not sure what to do
[21:23:20] <cmr> depp: don't use rustpkg, is the short answer.
[21:23:23] *** Joins: ofeldt (ofeldt@moz-41357ABF.dip0.t-ipconnect.de)
[21:23:23] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[21:23:42] <depp> cmr: Okay, is there a good template for using make or whatever?
[21:23:43] <eddyb> pepper_chico: LLVM optimizes that out, wherever applicable. it's similar to how modern C doesn't do exactly what it looks like
[21:23:51] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[21:23:51] *** ChanServ sets mode: +o jdm
[21:24:08] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[21:24:28] *** Quits: ofeldt- (ofeldt@moz-80858A6B.dip0.t-ipconnect.de) (Ping timeout)
[21:24:53] <pepper_chico> eddyb, I just expect a sane language where there's a minimum definition of the working, even though the compiler can optimize that out, the compiler optimization is not a standard
[21:24:59] <cmr> depp: https://github.com/SiegeLord/RustCMake is nice.
[21:25:16] <bitwalker> So I think I found a case where I can hang `rustpkg build`. I found what I was doing wrong, but it might catch other people new to the language (like me)
[21:25:27] <bitwalker> I built a simple demo of the problem here: https://github.com/bitwalker/rustpkg-bug
[21:25:31] <depp> gah CMake
[21:25:32] <SiegeLord> I'd note that it doesn't really answer the question of where to install a library
[21:25:33] *** Quits: quiggle (Mibbit@moz-FA92507D.hsi8.kabel-badenwuerttemberg.de) (Quit: http://www.mibbit.com ajax IRC Client)
[21:25:39] <bitwalker> See pubmod/mod.rs
[21:25:44] <eddyb> pepper_chico: what I'm trying to point out is that if you care for performance, you shouldn't be afraid of SmartPtr::new(x) "because it copies x" and believe you need an *operator* to have in-place initialization
[21:26:03] <SiegeLord> rustc looks in .rust/lib/<build-triple> iirc by default, and maybe a few other locations
[21:26:11] *** Joins: canhtak (canhtak@moz-6C22A50C.wl.t.ulaval.ca)
[21:26:13] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[21:26:20] <cmr> also the system linker paths.
[21:26:31] <cmr> i just build my deps manually and copy them to the cwd and -L .
[21:26:44] <SiegeLord> So /usr/local/lib would work?
[21:26:45] <depp> that's what I was hoping I wouldn't be doing
[21:26:45] <cmr> bitwalker: does it actually hang rustc?
[21:26:49] *** Joins: samx (sami@moz-77A1C177.pp.htv.fi)
[21:26:54] <cmr> bitwalker: or just rustpkg?
[21:27:00] <eddyb> pepper_chico: box using a Box trait can be implemented safely using value *copy* semantics, at which point, it's in-place if it's optimized so. to ensure in-place initialization *without optimizations* using safe code would be... close to impossible
[21:27:08] <adridu59> bitwalker: have you looked at opening an issue for it?
[21:27:10] <bitwalker> cmr: It hangs rustpkg for me, I can check if it hangs rustc
[21:27:24] <bitwalker> adridu59: I haven't yet, I wanted to make sure I'm not just doing something crazy stupid
[21:27:25] <pepper_chico> eddyb, and what the language standard would say about that, the compiler *may*/*is encouraged* to optimize the copy... my point is about guarantees
[21:27:29] <eddyb> pepper_chico: it's like asking for TCO. you're going to get it wherever applicable, so don't depend on it, but also don't think it never/rarely occurs
[21:27:54] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[21:28:00] *** Quits: adridu59 (Mibbit@moz-E1FF077C.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[21:28:01] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[21:28:02] <depp> not even Scheme requires TCO, technically
[21:28:02] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[21:28:05] <cmr> bitwalker: it's probably the bug with glob imports. don't use them like that :)
[21:28:09] <cmr> depp: yes it does.
[21:28:15] <cmr> depp: it's literally in the standard
[21:28:17] *** Quits: samx (sami@moz-77A1C177.pp.htv.fi) (Quit: This computer has gone to sleep)
[21:28:21] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[21:28:23] <depp> cmr: no, it just requires that you allow an unbounded number of active tail calls
[21:28:29] <cmr> is there a difference?
[21:28:53] <depp> cmr: you can do that without optimizing by allocating the stack frames as normal and GC'ing them
[21:29:11] <cmr> ok, sure
[21:29:17] <depp> IIRC some implementations did that
[21:29:29] <bitwalker> cmr: Yeah could be, it seemed like the problem was referencing the private module via the full path, instead of how I'm doing it in the "correct" version
[21:29:48] <bitwalker> It's definitely a bug in the way I'm doing things
[21:29:58] <bitwalker> But I figured the best case is to spit out an error of some kind rather than hang
[21:30:12] <pepper_chico> anyway, from beginning, I was trying to ask about language guarantees, removing compiler voodoo from equation, so
[21:30:24] <eddyb> pepper_chico: you're never going to get performance guarantees, unless it's a library type that is maintained to provide deterministic performance with certain constraints
[21:30:25] <pepper_chico> cmr, what you come in place of ~42?
[21:30:35] <cmr> Boreeas: box 42
[21:30:40] <cmr> erm, @pepper_chico 
[21:30:42] <eddyb> * pepper_chico
[21:30:43] <pepper_chico> s/you/will/
[21:31:01] <pepper_chico> ok
[21:31:14] <cmr> bitwalker: you're using feature flags, you don't get nice things :P
[21:31:52] <bitwalker> cmr: It looks like rustc catches the mistake just fine, for some reason rustpkg hangs though
[21:32:02] <cmr> bitwalker: ok, *that* is strange.
[21:32:31] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[21:33:11] <yuriks> how can I use transmute, size_of, etc. when I'm using #[no_std]?
[21:33:16] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[21:33:26] *** Joins: new_one (new_one@DE471074.940F5E39.B3C0173E.IP)
[21:33:37] <cmr> yuriks: https://github.com/thestinger/rust-core/blob/master/core/mem.rs
[21:33:38] <Matthias247> copy the source?
[21:33:41] <cmr> yuriks: as an example.
[21:34:09] <yuriks> is there any plan on making those features that don't depend on a runtime available somehow?
[21:34:22] <cmr> yuriks: they don't.
[21:34:35] <cmr> yuriks: they're intrinsics, you just need an extern block declaring them.
[21:34:36] <yuriks> (apart from using intrinsics directly, which I'm assuming is a compiler implementation detail)
[21:34:58] <Matthias247> maybe rust-core is something for you?
[21:35:06] <cmr> the "rust-intrinsics" pseudo-ABI is very likely to be standardized.
[21:35:30] <yuriks> cmr: ah
[21:35:45] <yuriks> Matthias247: I'll try it out, it looks helpful
[21:35:59] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[21:36:13] <bitwalker> cmr: Should I open an issue for that?
[21:36:47] <cmr> bitwalker: yes please :)
[21:37:04] <bitwalker> cmr: I'm brand new to rust, could you point me to the issue tracker?
[21:37:11] <cmr> bitwalker: https://github.com/mozilla/rust/issues
[21:37:18] <bitwalker> Thank you kindly sir
[21:37:32] *** Joins: ecl3ctic (Mibbit@moz-E1FAD64C.wzfv1.vic.bigpond.net.au)
[21:38:04] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[21:38:05] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[21:39:01] *** Joins: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au)
[21:39:58] *** Quits: twi (Adium@moz-512229A7.lns9.lon.bigpond.net.au) (Client exited)
[21:41:12] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Input/output error)
[21:42:33] *** Joins: ptc1 (Adium@moz-192425C4.nyc.res.rr.com)
[21:43:42] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:43:42] *** ChanServ sets mode: +ao brson brson
[21:44:18] *** Quits: ptc1 (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[21:44:30] <_Vi> Should [this](http://cosmic.mearie.org/2014/01/periodic-table-of-rust-types/) be linked directly from the appropriate section of the tutorial?
[21:45:13] <SiegeLord> Is there an IRC client that parses markdown somewhere out there?
[21:45:29] *** Quits: rca (rcatolino@moz-AF428BD0.adsl.proxad.net) (Ping timeout)
[21:45:50] <_Vi> (I just use Markdown as somewhat natural extension of plain text)
[21:46:19] *** Joins: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP)
[21:46:34] <o11c> the string should probably mention "static lifetime" ...
[21:46:36] *** Joins: ehelin (ehelin@moz-15302310.bredband.comhem.se)
[21:46:40] <SiegeLord> At least it isn't XML
[21:46:55] <eddyb> o11c: why strings in special?
[21:47:10] <eddyb> s/in special/in particular/
[21:47:18] <eddyb> (yay async brain)
[21:49:19] *** Quits: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se) (Ping timeout)
[21:49:30] *** Joins: o11c (ben@moz-C0FD33EF.a357.priv.bahnhof.se)
[21:49:40] <ehelin> hi all, does rustc have a flag similar to -fno-omit-framepointer?
[21:49:42] <o11c> eddyb: because it's relevant to the "fixed size" thing that people really want
[21:50:13] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[21:50:15] <eddyb> o11c: still don't get what you mean
[21:50:16] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[21:50:41] <eddyb> o11c: almost anything can have a 'static lifetime
[21:50:44] <o11c> I guess it *could* be useful for all objects though
[21:50:54] <ehelin> that is, can you tell rust programs to always use a frame pointer?
[21:50:57] <o11c> 'static is not mentioned as one of the possible ownerships already
[21:51:11] <eddyb> ehelin: it would have to be a LLVM flag
[21:51:17] <eddyb> o11c: aaah, ownership
[21:51:32] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[21:51:45] <eddyb> o11c: thing is, it's semantically equivalent to a non-owning &T that outlives everything else
[21:51:54] <eddyb> s/semantically//
[21:52:00] <o11c> eddyb: but people think of it differently
[21:52:01] <ehelin> eddyb: thanks! I'm very new to rust, can you pass LLVM options to rustc?
[21:52:14] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[21:52:25] <eddyb> ehelin: yes, but not all of them do something. rustc --help might get you started
[21:52:45] <eddyb> o11c: how so?
[21:52:54] *** Quits: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net) (Ping timeout)
[21:53:02] <o11c> eddyb: and, despite what the page currently says, it is quite possible to have a fixed-size UTF-8 string if it is compile-time constant
[21:53:06] <ehelin> eddyb: ok, thanks for your help, really appreciate it!
[21:53:26] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[21:53:27] <eddyb> o11c: it's a &'static str not a str
[21:53:44] <eddyb> o11c: it's under [T, ..n]
[21:54:06] <eddyb> fixed-size as in [u8, ..compile-time-constant] for strings
[21:54:12] *** Joins: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de)
[21:55:02] <eddyb> o11c: the storage of &'static str is not embedded in the type
[21:55:09] <eddyb> s/storage/storage size/
[21:55:15] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[21:55:49] <o11c> right
[21:56:10] <busylizzy> hi, guys. rustc tells me that this code is wrong: "self.cache.grow_fn(n - self.cache.len(), |_| option::None);". here self.cache is owned vector.
[21:56:20] <o11c> but I think that the current "fixed size storage" should point to the 'static
[21:56:45] <eddyb> o11c: it's about [T, ..n]
[21:56:53] <eddyb> &'static str has nothing to do with it
[21:57:04] <busylizzy> i assigned "n - self.cache.len()" to another variable to compile it
[21:57:06] *** Joins: cschneid (cschneid@moz-246E080D.hlrn.qwest.net)
[21:57:25] <eddyb> o11c: imagine a str<N> type that you can put inside structures, on the stack, etc. - that's what it talks about
[21:57:41] <busylizzy> but this limitation looks very strange to me. is this a bug?
[21:57:53] <eddyb> busylizzy: .len() borrows self.cache for the entirety of the statement
[21:58:24] <eddyb> busylizzy: if your rustc is less than a day old, it might be a limitation added by - nope, nevermind
[21:59:16] *** Joins: froglegstew (Mibbit@moz-C35C0C3E.hsd1.ca.comcast.net)
[21:59:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[21:59:21] <busylizzy> eddyb: so it's fixed? okay :)
[21:59:22] <eddyb> busylizzy: what happens is something like this: Vector::grow_fn(&mut self.cache, n - self.cache.len(), |_| None)
[21:59:49] <cmr> busylizzy: no, and it's not a bug.
[21:59:52] <eddyb> busylizzy: the mutable borrow exists when the first argument is evaluated
[22:00:03] <cmr> busylizzy: though we may redefine how we handle that case so that it becomes legal.
[22:00:13] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[22:00:22] <eddyb> the mutable borrow may be moved to the end of the argument evaluation order, but that complicates with Deref
[22:00:58] <eddyb> cmr: and nmatsakis' PR doesn't change it?
[22:01:00] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[22:01:16] <cmr> eddyb: not really, it just needs to assert that the retval of len doesn't have the same lifetime as the receiver.
[22:01:22] <cmr> if it doesn't, the borrows can't possibly overlap.
[22:01:24] <busylizzy> cmr: that's a pretty common case, i think. i often write code like this in other languages.
[22:01:26] <cmr> (re: complication)
[22:01:56] <eddyb> cmr: am I not right in that argument evaluation order thing?
[22:02:05] *** Quits: froglegstew (Mibbit@moz-C35C0C3E.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:02:07] <cmr> ie, the arg's lifetime can't be the lifetime of the receiver.
[22:02:32] <cmr> eddyb: not entirely no.
[22:02:32] <eddyb> cmr: you still need to change the evaluation of the receiver to the end. or at least the autoborrow
[22:02:53] <eddyb> cmr: if the receiver is a function call, it will be evaluated first
[22:03:01] <eddyb> rusti: let mut v = ~[]; v.grow_fn(10 - v.len(), |_| None); v
[22:03:05] -rusti- pastebinned 10 lines of output: http://ix.io/9RZ
[22:03:21] <eddyb> rusti: let mut v = ~[]; v.grow_fn(10 - v.len(), |_| 0); v
[22:03:24] -rusti- pastebinned 10 lines of output: http://ix.io/9XZ
[22:03:44] <cmr> eddyb: sure but for function calls it's not an issue.
[22:03:54] <cmr> eddyb: "receiver" is specifically method call; it's the object the method is called on.
[22:04:10] <eddyb> cmr: I mean foo().bar() will first call foo
[22:04:21] <cmr> ok
[22:04:23] <eddyb> rusti: let mut v = ~[]; (&mut v, 10 - v.len(), |_| 0)
[22:04:26] -rusti- pastebinned 10 lines of output: http://ix.io/9RZ
[22:04:36] <eddyb> rusti: let mut v = ~[]; (&mut v, 10 - v.len(), |_| 0);
[22:04:38] -rusti- pastebinned 7 lines of output: http://ix.io/9Y0
[22:04:45] <Tobba> 0=>{extern{fn _irq_tick_pic_isr0();}_irq_tick_pic_isr0},   1=>{extern{fn _irq_tick_pic_isr1();}_irq_tick_pic_isr1},    2=>{extern{fn _irq_tick_pic_isr2();}_irq_tick_pic_isr2},    3=>{extern{fn _irq_tick_pic_isr3();}_irq_tick_pic_isr3},
[22:04:48] <Tobba> I think I should make a macro for this
[22:04:51] <eddyb> bleah....
[22:05:09] <eddyb> rusti: let mut v = ~[false]; (&mut v, 10 - v.len(), |_| 0);
[22:05:11] -rusti- pastebinned 7 lines of output: http://ix.io/9Y1
[22:05:23] <eddyb> rusti: let mut v = ~[false]; (&mut v, 10 - v.len());
[22:05:23] -rusti- ()
[22:05:25] <busylizzy> Tobba: lol
[22:05:34] <eddyb> cmr: wait, that is weird
[22:05:36] <Tobba> thats 1/4 of it
[22:06:02] <eddyb> rusti: let mut v = ~[false]; println!("{:?} {:?}", &mut v, 10 - v.len());
[22:06:04] -rusti- pastebinned 18 lines of output: http://ix.io/9Y2
[22:06:19] <_achin> how come i "cannot implement a destructor on a structure that does not satisfy Send" ?
[22:06:41] <cmr> _achin: non-Send means it could form cycles, and destructor cycles are unsound.
[22:06:54] <eddyb> cmr: okay, same error. now, what if we evaluate the receiver in the same place (nothing would happen in this case), but auto-borrow after the arguments?
[22:07:40] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[22:07:48] <johnsoft> rusti: fn main() {let list: ~[~str] = ~[];use_iterator(~list.move_iter());}fn use_iterator<T>(it: ~Iterator<T>) {}
[22:07:51] -rusti- pastebinned 10 lines of output: http://ix.io/9Y3
[22:08:30] <_achin> hmmm.  i'm not sure i understand why a Send/non-Send implies anything about cycles
[22:08:38] <cmr> eddyb: well, it's a different error, because of what println expands to.
[22:09:05] *** Quits: bitwalker (bitwalker@moz-1684082D.hsd1.mn.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:09:21] *** flaper87 is now known as flaper87|afk
[22:10:05] <eddyb> rusti: let mut v = ~[false]; fn f<T, U>(x: T, y: U) {println!("{:?} {:?}", x, y);} f(&mut v, 10 - v.len());
[22:10:08] -rusti- pastebinned 10 lines of output: http://ix.io/9Y4
[22:10:08] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[22:10:09] <cmr> eddyb: it really just needs to know if one of the arguments has a borrow that overlaps with the actual call, I don't think auto-borrow has anything to do with it.
[22:10:10] *** Joins: jwang (Zealtron@931CA3C.CE6A8161.D5851B94.IP)
[22:10:22] <eddyb> cmr: yes it does
[22:10:36] <eddyb> cmr: the &mut autoborrow of v is what makes v.len() fail
[22:10:57] <eddyb> rusti: let mut v = ~[false]; fn f<T, U>(x: T, y: U) {println!("{:?} {:?}", x, y);} f(10 - v.len(), &mut v);
[22:10:59] -rusti- 9u &mut ~[false]
[22:10:59] -rusti- ()
[22:11:04] <eddyb> I move it to the end and it works :)
[22:11:13] <cmr> ah I see what you are saying now
[22:11:47] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[22:11:52] <cmr> that still doesn't help, because you could have a v.something_mut() in that call and it should still be allowed.
[22:12:18] <eddyb> cmr: what do you mean?
[22:12:21] *** Quits: dmac (Adium@moz-99EF2EE6.hfc.comcastbusiness.net) (Quit: Leaving.)
[22:12:23] <cmr> it should expand into { arg1 = expr1; arg2 = expr2; arg3 = expr3; ... ; foo(arg1, arg2, arg3, ...) }
[22:12:56] <eddyb> rusti: let mut v = ~[false]; fn f<T, U>(x: T, y: U) {println!("{:?} {:?}", x, y);} f(v.push(true), &mut v);
[22:12:58] -rusti- () &mut ~[false, true]
[22:12:58] -rusti- ()
[22:13:04] <eddyb> cmr: like that?
[22:13:07] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[22:13:13] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[22:13:53] *** Joins: enand (erik@67F9F6F9.5AF75EBF.841A3ED3.IP)
[22:14:02] <SiegeLord> I wonder... can a public trait inherit from a private trait? What does that mean for the methods declared in the private trait?
[22:14:15] *** Parts: jwang (Zealtron@931CA3C.CE6A8161.D5851B94.IP) ()
[22:14:19] <cmr> rusti: let mut v = ~[false]; fn f<T, U, V, A>(x: T, y: U, z: V, a: A) {println!("{:?} {:?}", x, y);} f(v.len(), v.push(true), v.swap(1, 2), &mut v);
[22:14:22] -rusti- pastebinned 8 lines of output: http://ix.io/9Y5
[22:14:26] *** Joins: ndeine (weechat@FEACE86F.DD5772EA.88820282.IP)
[22:14:32] <eddyb> TUVA
[22:14:34] <cmr> eddyb: ok, looks like it already does the analysis I thought it wasn't.
[22:15:09] <eddyb> I know what you've seen, &mut borrows poisoning entire scopes
[22:15:10] <cmr> SiegeLord: depends on how we decide https://github.com/mozilla/rust/issues/10573
[22:15:16] <eddyb> cmr: that was different, though
[22:16:00] <Tobba> oh god, that monster match I created
[22:16:05] <Tobba> ... maybe I should just use a lookup table
[22:16:25] <Tobba> the codegen is crying tears of branch instructions
[22:16:38] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[22:16:55] *** Joins: samx (sami@moz-D9F3E0AE.pp.htv.fi)
[22:17:03] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[22:17:16] <eddyb> Tobba: match is optimized like switch (in C, by clang)
[22:17:21] *** Joins: jwang (Zealtron@931CA3C.CE6A8161.D5851B94.IP)
[22:17:36] <cmr> eddyb: are you sure about that?
[22:17:43] <Tobba> rustc doesnt use libclang though?
[22:17:48] <cmr> how clang lowers switch could be very very different than how we lower match
[22:17:54] <cmr> and I suspect it is.
[22:17:56] *** Parts: jwang (Zealtron@931CA3C.CE6A8161.D5851B94.IP) ()
[22:18:00] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[22:18:02] <eddyb> bleah don't make me cry
[22:18:12] <eddyb> Tobba: rust uses LLVM
[22:18:13] <cmr> I don't think llvm does jump table etc optimizations
[22:18:23] <eddyb> cmr: yes it does. I hope it does
[22:18:32] <eddyb> it's a lowering mode, not even an optimization
[22:18:42] <eddyb> LLVM has a switch-like primitive
[22:18:43] <cmr> eddyb: "yes it does" followed by "I hope it does" is a very weak statement :p
[22:18:48] <eddyb> hehe
[22:19:05] <Tobba> wait a fucking minute
[22:19:06] <eddyb> Tobba: if all you do is return a different value from each one, it should be optimizable to a lookup table, no indirect branches
[22:19:11] <Tobba> I forgot to link to the file that contains those functions
[22:19:15] <Tobba> this shouldent even be linking, what the hell
[22:19:15] <SiegeLord> rusti: pub use std::not_there;
[22:19:18] -rusti- pastebinned 10 lines of output: http://ix.io/9Y6
[22:19:35] <pepper_chico> well, making rust was much faster this time than the last I tried
[22:19:41] <cmr> eddyb: I don't think we lower to switch
[22:19:49] <eddyb> cmr: it's not named "switch"
[22:19:49] <cmr> we might.
[22:19:54] <cmr> eddyb: yes it is?
[22:19:54] <eddyb> AFAIK
[22:20:02] <cmr> it definitely is
[22:20:09] <eddyb> my only excuse is that it's late
[22:20:52] <Tobba> and yep that monster switch was a horrid idea
[22:21:03] <Tobba> I'm not sure if I'm just doing it wrong or if the compiler broke down
[22:21:51] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[22:22:07] *** Quits: ehelin (ehelin@moz-15302310.bredband.comhem.se) (Quit: Lost terminal)
[22:22:17] <SiegeLord> Maybe I'm not doing it right... my goal is to provide a whole bunch of default methods that depend on a single implemented method. I want that implemented method to be private, however, so I put it into a private trait and inherit the public trait from it
[22:22:26] <cmr> ohh we do lower to switch for very simple C-like enum matches, that is good.
[22:22:59] <eddyb> cmr: pfft, I'm slower
[22:23:03] <eddyb> funny thing though: pub unsafe fn test(){*(0 as *mut uint) = match *(0 as *uint) {0 => 4, 1 => 5, 2 => 7, 3 => 12, 4 => 42, _ => 0};}
[22:23:08] <SiegeLord> Should I ditch trait inheritance and do an impl<Foo: PrivateTrait> Foo for PublicTrait; ?
[22:23:22] <eddyb> cmr: that compiles to just one function call. guess what it is?
[22:23:30] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[22:23:42] <cmr> eddyb: abort? :p
[22:23:49] <eddyb> trap
[22:23:59] <Tobba> hahahaha
[22:24:12] <eddyb> thing is... we don't need to check the return value of malloc
[22:24:12] <Tobba> LLVM is weird
[22:24:26] <Tobba> (that return value also triggers an exception)
[22:24:35] <Tobba> (the malloc check)
[22:24:45] <cmr> it optimizes to trap, doesn't lower to it.
[22:24:50] <eddyb> since we always initialize memory we allocate, it will write to 0 and according to LLVM, that's optimizable to an abort, which we do manually, so...
[22:25:13] <Tobba> I always forget how dumb llvm is with null pointers
[22:25:16] <eddyb> ^^ ignore that, it's a recursive line of thought
[22:25:24] <Tobba> in a lot of low level cases you actually have valid data at 0x0
[22:25:41] <Tobba> which ends very very badly when llvm does stuff like that
[22:25:44] <eddyb> @switch.table = private unnamed_addr constant [5 x i64] [i64 4, i64 5, i64 7, i64 12, i64 42]
[22:25:53] *** Quits: moostik (Icedove@moz-1FF02BE5.w92-151.abo.wanadoo.fr) (Ping timeout)
[22:26:00] <Tobba> yeah it doesnt do that if you use functions
[22:26:11] *** new_one is now known as new_one_afk
[22:26:15] <eddyb> Tobba: are those functions statically resolved?
[22:26:17] *** Quits: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br) (Quit: Ex-Chat)
[22:26:19] <Tobba> I also broke the optimizer
[22:26:22] <eddyb> pffft
[22:26:23] <Tobba> they're externs
[22:26:31] <Tobba> I dont even know what its optimizing it out to
[22:26:34] <Tobba> but its not very correct
[22:27:18] <Tobba> oh god the entire function is a trainwreck
[22:27:30] *** Quits: samx (sami@moz-D9F3E0AE.pp.htv.fi) (Quit: This computer has gone to sleep)
[22:27:49] <sfackler> ooh, rust-ci has new features
[22:28:00] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[22:28:21] <eddyb> Tobba: can I see the IR?
[22:28:44] <Tobba> the original is 198 lines of IR; most of which is just the match
[22:28:46] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[22:28:53] <Tobba> the optimized is 112 lines of trainwreck
[22:29:00] <eddyb> Tobba: --opt-level=3?
[22:29:05] <Tobba> yeah
[22:29:34] <Tobba> http://pastebin.com/Qyt5nbb0
[22:29:53] <eddyb> Tobba: gist even has LLVM highlighting
[22:30:04] <Tobba> actually, I think some of that is due to it inlining the update function
[22:30:10] <Tobba> but the match gets completely optimized out somehow
[22:30:42] <eddyb> Tobba: #[inline(never)] to keep boundaries
[22:30:49] <Tobba> in this case its fine
[22:30:58] <Tobba> it made a mess of the IR but who cares about that
[22:32:01] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[22:32:11] <eddyb> Tobba: also, my favorite way to do this is - --emit-llvm -S -o /dev/stdout | c++filt | less - it has nice symbols, too :P
[22:32:23] <Tobba> cant you just do -o -
[22:32:41] <eddyb> not sure...
[22:32:41] <Tobba> more portable
[22:32:46] *** Quits: mouse (mouse@moz-32DFB3CF.broadband.corbina.ru) (Ping timeout)
[22:33:37] <eddyb> Tobba: the times I've had to do rm -- - don't agree
[22:33:39] <Tobba> eugh, yep
[22:33:48] <Tobba> I figured out whats wrong
[22:34:16] <cmr> yes, you can.
[22:34:16] <Tobba> unsafe{idt[0x20+irq]}.setup
[22:34:23] <Tobba> this seems to have copied the IdtEntry to the stack
[22:34:24] <cmr> (-o -, that is)
[22:34:24] <Tobba> then set that up
[22:34:27] <Tobba> so LLVM just optimized it out
[22:36:01] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[22:36:39] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[22:37:46] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[22:40:16] *** Quits: elij (elij@E6C4342E.9D386EAF.AF7F4FE0.IP) (Ping timeout)
[22:41:21] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[22:41:24] <busylizzy> does anyone know is it planned to add to rust function overloading or default values for function arguments?
[22:41:57] <depp> I think there is resistance, but the problem is that the type system is already flexible enough to allow it
[22:42:15] <depp> at least it allows overloading
[22:42:38] <depp> but it requires writing extra code (traits)
[22:42:39] <cmr> busylizzy: overloading is a definite no right now, default values is a maybe.
[22:42:41] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[22:42:54] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[22:43:00] *** Joins: elij (elij@E6C4342E.9D386EAF.AF7F4FE0.IP)
[22:43:07] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[22:43:13] <depp> people got turned off overloading because C++ programmers abused it and now it's ruined for everyone :'-(
[22:43:48] <Tobba> hahahaha
[22:44:01] <Tobba> I kinda need overloading for what I'm doing, at least argument count wise
[22:44:03] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[22:44:22] <Tobba> I have have a function that can be called with up to 8 arbitary arguments
[22:44:23] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[22:44:32] <Tobba> so I *guess* if we get defaults I could abuse the shit out of that, but eh
[22:44:45] <depp> sounds like a messy function
[22:44:47] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[22:44:48] <Tobba> nah
[22:44:53] *** Quits: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: It is tiem!)
[22:44:53] <Tobba> its an RPC thing
[22:45:01] <Tobba> so it goes like "call function X with Y args"
[22:45:14] <Tobba> traits are perfect for it too
[22:45:26] <Tobba> I can abuse defaults for it if we get those though, so I guess
[22:45:34] <depp> you can't use variadics?
[22:45:41] *** Joins: reima (reima@moz-73FDA0CE.dip0.t-ipconnect.de)
[22:46:02] <depp> or wait, I forgot if those exist yet
[22:46:16] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[22:46:18] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[22:46:30] <Tobba> they dont
[22:46:54] <busylizzy> i like function overloading in c++. but this language is so difficult... i definitely would not want to develop a c++ compiler.
[22:48:02] <cmr> depp: variadic functions are a definite no, because they're not typesafe, and any typesafe formulation of them is going to involve too much magic and ugliness that just doing it explicitly as an array of an enum is better.
[22:48:02] <eddyb> Tobba: with variadics + traits you have function overloading ;)
[22:48:21] <Tobba> eddyb: I hope we get non-shite variadics then
[22:48:23] <depp> cmr: I thought variadic would be sugar for array anyway
[22:48:32] <eddyb> not really
[22:48:50] <Tobba> actually, for now I can probably implement a macro
[22:48:57] <Tobba> a very very hacky macro
[22:48:59] <MrByte> There.  Got my guid issue figured out (yay microsoft for not simply representing them as a 16-byte array) and now I can actually instantiate a COM object.
[22:49:01] <depp> I really just want to be able to express algebraic formulas using algebraic syntax
[22:49:03] <MrByte> Now to implement the vtable.
[22:49:31] <busylizzy> Tobba: it seems that you like macros ;)
[22:49:49] <Tobba> busylizzy: you like them until you come across shit like this
[22:49:50] <Tobba> macro_rules! setExtendedState(($f:ident, $v:expr) => {unsafe{(*(::lib::mem::offset(::core::hal::thread_info[{let tr: u16; asm!("str $0" : "=r"(tr)); (tr-40)/16}].state as *u8, ::lib::mem::size_of::<::core::state::CoreState>() as int) as *mut ::state::ExtendedState)).$f = ($v)}})
[22:49:59] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[22:50:01] <Tobba> ... I really need to rewrite that thing
[22:50:03] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[22:50:16] <SiegeLord> Whitespace and newlines are free ;)
[22:50:30] <eddyb> Tobba: fn foo<..Args: FooImpl>(..args: Args) {args.foo_impl()} trait FooImpl {fn foo_impl(&self);} impl FooImpl for (Arg1, Arg2) {fn foo_impl(&self){let &(arg1, arg2) = self; ....}}
[22:50:36] <depp> SiegeLord: where are you getting them?  I have to pay $.03 each here.
[22:50:42] <Tobba> eddyb: is that the plan?
[22:50:55] <SiegeLord> depp: My terminal makes them. I copy+paste them when needed
[22:50:56] <eddyb> Tobba: at least with my proposal, you could do it
[22:51:00] <Tobba> reasonable
[22:51:03] <Tobba> I just hope you can loop through it
[22:51:09] <Tobba> C++ has variadic templates but to loop through them you have to recurse
[22:51:23] <eddyb> erm... we also need to recurse, because they're tuples
[22:51:31] <Tobba> which usually ends in massive recursive templates causing compiler combustion
[22:51:33] <SiegeLord> You can also do non-template variadic functions via arrays of trait objects
[22:51:45] <SiegeLord> Now that trait objects can be created implicitly, it's not that bad looking now
[22:51:53] *** Quits: stomper (Mibbit@moz-4A19983C.ip227.fastwebnet.it) (Quit: http://www.mibbit.com ajax IRC Client)
[22:52:03] <eddyb> SiegeLord: except it's virtual compared to generic
[22:52:11] *** Joins: WebeWizard (Justin@moz-7CCD1DAE.ks.ks.cox.net)
[22:52:16] <WebeWizard> Wiizzaaarrrrrrrd
[22:52:21] <eddyb> Tobba: thing is, you can hide the trait specializations behind a macro, and still have simple function calls
[22:52:28] <Tobba> fair enough
[22:52:28] <cmr> eddyb: the correct term is static, not generic
[22:52:30] <Tobba> but yeah
[22:52:31] <SiegeLord> eddyb: Variadic generics = template bloat ;P
[22:52:33] <cmr> generic is a synonym for polymorphic
[22:52:38] <eddyb> err, sorry
[22:53:09] <eddyb> Tobba: it would end up looking like pattern matching. maybe we can implement pattern matching-based overloading, kinda like Haskell, with syntax extensions
[22:53:21] <Tobba> hm
[22:53:29] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[22:53:45] <Tobba> eddyb: by the way, I need some ideas on how to create the RPC interface stuff
[22:53:54] <Tobba> basicaly, I somehow need to set up a table of functions and their args
[22:53:57] <Tobba> in some user friendly way
[22:54:00] <eddyb> hehehe
[22:54:06] <Tobba> in C++ this was wrapper hell
[22:54:16] <eddyb> Tobba: I have just the thing. safe runtime interface polymorphism in like 10-20 lines
[22:54:36] <depp> How do I make Rust link against a native library when I use the native library through an rlib?
[22:54:37] <Tobba> aw yeah
[22:54:54] <cmr> eddyb, abstraction dealer.
[22:55:00] <cmr> (convicted abstraction dealer?)
[22:55:09] <eddyb> Tobba: it's like Any, but it can give you any number of trait references (that the implementor exposes) - or, if you want, Objective-C-like method calls
[22:55:20] <cmr> depp: native dependencies should be transitive now...
[22:55:33] <depp> I'm using 0.9, not master...
[22:55:35] <cmr> depp: but #[link(name = "somelib")]
[22:55:41] <cmr> it wouldn't have changed since then
[22:55:50] <eddyb> Tobba: I wanted to implement the latter, too, and post it on reddit for that sweet sweet karma
[22:55:58] <Tobba> hah
[22:56:04] <eddyb> type id = RWArc<Many>;
[22:56:15] <eddyb> I should wait for DST just to do that
[22:56:28] *** Joins: kvanb (kvanb@moz-76614EE8.lns7.lon.bigpond.net.au)
[22:56:29] <busylizzy> Tobba: what are you developing?
[22:56:36] <eddyb> objc!( [self "foo"] )
[22:56:37] <Tobba> kernel
[22:56:43] <busylizzy> wow
[22:56:46] <eddyb> or is that foo, without quotes?
[22:56:54] <eddyb> busylizzy: there's a bunch of kernels around
[22:56:56] <depp> I don't appear to be getting transitive linking...
[22:57:03] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[22:57:04] <cmr> depp: unfortunate :( can you open a bug?
[22:57:11] <Tobba> I think I've come reasonably far with mine though, I almost have multitasking
[22:57:12] <depp> okay
[22:57:14] <eddyb> the one I wanted to work on is postponed because it turns out I have to fix the compiler before using it
[22:57:24] <eddyb> Tobba: you're getting ahead :/
[22:57:25] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:57:26] <cmr> eddyb: hey, that's why I stopped work on mine too :P
[22:57:29] <Tobba> I just need to fix this tick ISR then I have preemptive multitasking
[22:57:36] <eddyb> Tobba: https://gist.github.com/eddyb/f828f8ce819a5f00d42d
[22:58:17] <eddyb> Tobba: usage examples - I should probably use operators instead of explicit function calls there, but that's the gist of it https://gist.github.com/eddyb/f828f8ce819a5f00d42d#file-many-rs-L55-L84
[22:58:27] <Tobba> then I need to fix that tree allocator (I added a sorta-bitmap allocator for 32-4K allocations)
[22:58:35] <Tobba> then I just need to port over my VGA driver, which is reasonably easy
[22:58:58] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[22:59:15] <eddyb> Tobba: I needed to fix rustc so my used-for-VBE BIOS emulator takes less than 2.2GB to compile, did I mention that?
[22:59:20] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[22:59:20] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[22:59:29] <Tobba> hahahaha holy shit
[22:59:32] <SiegeLord> Hmm... actually trait object coersion doesn't seem to work with array literals... that's a shame
[22:59:46] <Tobba> did you make a 8086 VM for running VBE? neat
[22:59:58] <_achin> if i want to extract some code from lib.rs and put it into foo.rs, but have code in foo.rs reference something from lib.rs, how do i do this?
[23:00:01] <Tobba> I've kinda wanted to do that but theres a *slight* possibility that it might attempt to enter pmode and die in a fire
[23:00:04] <eddyb> Tobba: the emulator is generated from opcode definitions intended for a decompiler
[23:00:19] <eddyb> s/intended/used in/
[23:00:25] <Tobba> so instead I just avoid VBE for now and write proper GPU drivers
[23:00:35] <sfackler> SiegeLord: https://github.com/mozilla/rust/issues/11205
[23:00:47] <sfackler> Luqman said he was going to get to it soonish I think
[23:00:51] <eddyb> Tobba: my emulator can't go into pmode
[23:00:51] <SiegeLord> Oh wow, that'd old eh
[23:00:55] <SiegeLord> Oh, great!
[23:01:00] <Tobba> eddyb: yeah
[23:01:00] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[23:01:05] <eddyb> Tobba: I can even have magic tokens
[23:01:14] <Tobba> neat
[23:01:27] <eddyb> so the stack can be SpecialValueStack(&[u8])
[23:01:35] *** Quits: zxcdw (r-a@5F0EDB29.B543C4DE.3933CC16.IP) (Ping timeout)
[23:02:00] <Tobba> apparently its not even that hard to get a framebuffer on modern GPUs
[23:02:09] <Tobba> although it'll probably only ever work on the GPU you test it against
[23:02:28] <depp> wait... before I submit a bug, is it possible that the library I'm using (GLFW) just doesn't link against the native library?
[23:02:35] <cmr> depp: yes.
[23:02:40] <eddyb> hehehe
[23:02:43] <cmr> depp: glfw-rs questions go to #rust-gamedev :P
[23:02:44] *** Quits: KindOne (KindOne@moz-DCBC5EC4.dynamic.ip.windstream.net) (Quit: ZNC 1.2 - http://znc.in)
[23:02:44] *** Quits: jed (jed@moz-9E36FDA5.lightspeed.stlsmo.sbcglobal.net) (Ping timeout)
[23:02:50] *** Joins: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br)
[23:02:53] <eddyb> Tobba: a small BIOS space starting around 0x0000 can be copied to the heap, and then you can allow the specific MMIO region belonging to the GPU
[23:03:09] *** Quits: depp (depp@500BAFC1.53465674.3C05E6CB.IP) (Quit: leaving)
[23:03:19] <Tobba> I think a lot of VBE BIOSes might attempt to enter protected mode though
[23:03:25] *** Joins: depp (depp@500BAFC1.53465674.3C05E6CB.IP)
[23:03:28] <Tobba> some can get you juicy 1080p resolutions
[23:03:49] <eddyb> Tobba: the 8086 emulator we had in pedigree didn't support protected mode
[23:03:58] <pepper_chico> cmr, hey, I was trying out the box syntax, box 42 works, box(GC) 42 works, but I was unable to get something for Rc, do you know about?
[23:04:09] <eddyb> it was some weird C thing. though I haven't tested it on real HW
[23:04:14] <eddyb> pepper_chico: it's not implemented yet
[23:04:15] <cmr> pepper_chico: as I said, it's only partially implemented right now, and there's nothing for Rc.
[23:04:16] <Tobba> eddyb: well yeah
[23:04:20] <Tobba> bochs has BGA
[23:04:29] <pepper_chico> ah
[23:04:30] <Tobba> which supports some p big resolutions but it wont actually need to access the framebuffer it creates
[23:04:33] <pepper_chico> ok then
[23:04:36] <pepper_chico> thanks
[23:04:49] <eddyb> Tobba: btw, with DST, you can allocate a RWArc<T>/Rc<RefCell<T>> and then cast it to RWArc<Trait> ;)
[23:05:56] <eddyb> Tobba: so you can keep a RWArc<IrqHandler> :D
[23:06:10] *** Quits: WebeWizard (Justin@moz-7CCD1DAE.ks.ks.cox.net) (Connection reset by peer)
[23:06:15] <Tobba> neat
[23:06:23] *** Quits: nif (nif@moz-8181E2AC.oberlin.net) (Quit: Konversation terminated!)
[23:06:52] <Tobba> but yeah some VBE BIOSes might attempt to use pmode to access PCI address space
[23:07:00] <Tobba> which will end... badly
[23:07:13] <eddyb> and I'm thinking trait Device: Many, RWArc<Device> for the device tree
[23:07:30] <Tobba> thats gonna be neat
[23:07:54] <Tobba> heck, depending on how hardcore the guy who wrote the VBE BIOS was it might even attempt to wait for an IRQ
[23:08:13] <Tobba> though I dont think that'll actually happen, you never know
[23:08:29] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[23:08:45] *** Quits: pepper_chico (pepper_chi@moz-13107F6.dsl.telesp.net.br) (Quit: Ex-Chat)
[23:08:51] <eddyb> Tobba: and then I can have an UsbDevice trait in a dynamically loaded module, and then go in the device tree and get an Option<&UsbDevice> for each of them
[23:09:10] <Tobba> ... DST will be amazing
[23:09:43] <eddyb> it's a really performant way of querying interfaces
[23:11:04] <eddyb> pedigree (in C++) had issues (we had to compile a RTTI static lib to have in the kernel), and we still had a non-exhaustive DeviceType enum inside the core code. eww
[23:11:22] *** Joins: WebeWizard (Justin@moz-7CCD1DAE.ks.ks.cox.net)
[23:11:27] <Tobba> ew
[23:11:47] <Tobba> oh shit I might be able to do something neat for handles with this, but I dunno
[23:11:59] <eddyb> Tobba: oh, and, resource management
[23:12:15] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[23:12:21] <Tobba> the idea is that basicaly for an object inside a driver or application, you can set up an interface which tells the kernel how that object can be interacted with, and expose it to other applications
[23:12:26] <eddyb> you can split memory and IO ranges so there are no overlapping uses
[23:13:14] <eddyb> Tobba: mhmm. traits are much better at this than methods queried by strings, because it's a lookup by TypeID
[23:13:24] <Tobba> its not by string actually
[23:13:26] <Tobba> its by method id
[23:13:32] <Tobba> so basicaly thats the idea
[23:13:53] <eddyb> Tobba: rust has builtin Type IDs
[23:13:55] <Tobba> I'm hoping that by abusing DST horribly or something I can do this in a non-fugly way
[23:14:03] <eddyb> but not method IDs
[23:14:03] <Tobba> yeah I know, how big are those?
[23:14:07] <eddyb> u64
[23:14:10] <Tobba> aw yeah
[23:14:15] <Tobba> in this case it doesnt matter
[23:14:18] <Tobba> I think
[23:14:31] <eddyb> Tobba: you can have one trait per method and it would still be fast :P
[23:14:49] <eddyb> (if that works for you)
[23:14:57] *** Quits: dwrensha (chatzilla@moz-B23D2FF6.pitbpa.east.verizon.net) (Ping timeout)
[23:15:09] <eddyb> Tobba: as we speak, lowering switch to static hash tables is being implemented in LLVM
[23:15:16] <Tobba> awesome
[23:15:59] <eddyb> oh, did I forget? cmr: my LLVM patch was committed: http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20140113/201946.html r199564
[23:16:13] <eddyb> acrichto: you might want to update the LLVM Rust uses ^^
[23:16:40] <Tobba> awesome
[23:17:05] <eddyb> (different patch. it does help devirtualize many things, including Many)
[23:18:24] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[23:18:40] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[23:19:02] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[23:19:20] <johnsoft> you guys will hate me for asking this
[23:19:30] <eddyb> johnsoft: please, go ahead
[23:19:52] <eddyb> I'm bored, feeling useless because all I'm doing is finishing the rest of season 6 (The Mentalist)
[23:20:01] *** Joins: KindOne (KindOne@moz-DCBC5EC4.dynamic.ip.windstream.net)
[23:20:02] <Tobba> the mentalist is great
[23:20:02] <johnsoft> is there any equivalent for void*/object/interface{} ?
[23:20:11] <eddyb> johnsoft: &Trait
[23:20:22] <eddyb> johnsoft: the whole Trait row http://cosmic.mearie.org/2014/01/periodic-table-of-rust-types/
[23:20:30] <benh> Any? *libc::c_void or w/e?
[23:20:37] <eddyb> wait, interface confused me
[23:20:42] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[23:20:50] <eddyb> johnsoft: an interface or an opaque object, or something intended to work with C?
[23:21:23] <johnsoft> interface{} is go's root object type
[23:21:26] <eddyb> we have trait objects, ~Any (which is one trait, that allows you to get back the value inside if you know the type), and *c_void
[23:21:29] <Tobba> hahaha, dbaupps posted that rust JIT thing on the reddit
[23:21:32] <Tobba> terry a. davis commented
[23:21:34] <eddyb> johnsoft: yes, what do you need it for?
[23:22:15] <johnsoft> i'm just curious about the rtti situation
[23:22:29] <nrc> does anyone have an example of code in the wild which uses extern mod to load a remote crate (e.g., from github)?
[23:22:34] <johnsoft> i was thinking of porting jinja2 to rust since I find mustache frustrating and limiting
[23:22:59] <eddyb> johnsoft: we have trait objects, which hide away data and provide virtual methods
[23:24:11] <johnsoft> I think what I actually meant was dynamic binding
[23:24:23] <johnsoft> which is a completely different thing, sorry
[23:24:35] <eddyb> johnsoft: can you provide an usage example?
[23:24:47] <johnsoft> sure
[23:25:05] <johnsoft> in a template I come across {{item.name}}
[23:25:12] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse_)
[23:25:18] <johnsoft> item is of type void* (or whatever)
[23:25:26] <johnsoft> reflection! that's the word!
[23:25:36] <eddyb> johnsoft: HashMap<~str, ~str> :P?
[23:25:51] <johnsoft> heh
[23:25:55] *** Joins: dwrensha (chatzilla@moz-B23D2FF6.pitbpa.east.verizon.net)
[23:26:00] <eddyb> oooh, I know what you want to do
[23:26:02] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[23:26:11] <eddyb> johnsoft: that's a job for either encoder/decoder or the type visitor
[23:26:33] <eddyb> both of those are compile-time resolved
[23:26:45] <johnsoft> neither of those things mean anything to me
[23:26:51] <johnsoft> but I like compile-time resolved
[23:26:56] <johnsoft> tell me more
[23:27:16] <eddyb> johnsoft: we have Encodable/Decodable traits which can be derived for abitrary structs
[23:27:42] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: Lost terminal)
[23:27:59] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:27:59] *** ChanServ sets mode: +ao brson brson
[23:28:01] <eddyb> johnsoft: we have JSON encoding/decoding implemented on top of it. but once the type implements Encodable/Decodable, it works with any Encoder/Decoder
[23:28:30] <cmr> eddyb: can you push through strcat's too? :p
[23:28:38] <eddyb> cmr: hmm?
[23:28:45] <cmr> eddyb: llvm patch
[23:28:47] <eddyb> oh, strcat's patch
[23:28:55] <eddyb> cmr: I don't even know where it is or what it does
[23:29:07] <eddyb> johnsoft: that would let you visit the contents of a value, though it's not on-demand
[23:29:16] <johnsoft> i can't find that in the docs anywhere
[23:29:23] <eddyb> johnsoft: really?
[23:29:40] <cmr> extra::serialize
[23:29:45] <eddyb> johnsoft: the type visitor is supposed to work with any value, needs no annotation, makes things like this work:
[23:30:05] <eddyb> rusti: struct Point{x:uint,y:uint}Some(Point{x:0, y:1})
[23:30:06] -rusti- Some(main::Point{x: 0u, y: 1u})
[23:30:40] <johnsoft> http://static.rust-lang.org/doc/0.9/extra/serialize/trait.Encoder.html
[23:30:54] <eddyb> johnsoft: but the type visitor is close to runtime reflection, it allows for things that are unused, and it might just go away, so Encodable/Decodable is the better choice
[23:31:21] <johnsoft> this doc page doesn't tell me much...
[23:31:31] <johnsoft> maybe read the json encoder source?
[23:31:32] <cmr> hah
[23:31:35] <cmr> not a single doc comment
[23:31:36] <cmr> that's awful
[23:31:55] <Tobba> where we're going, we dont need documentation
[23:31:59] *** Quits: mib_9x3571 (Mibbit@moz-CC5F54A7.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[23:32:37] *** Joins: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net)
[23:33:19] <eddyb> johnsoft: you would have to catch an emit_struct_field with the right name, and serialize its contents somehow
[23:33:30] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[23:33:39] <Matthias247> yay, timers and tcp working in parallel
[23:33:49] <eddyb> johnsoft: if you're comparing with static field names at compile time, it will be optimized to a field access
[23:33:51] <Matthias247> next stop -> channels :)
[23:33:53] <cmr> Matthias247: awesome!
[23:34:36] <eddyb> johnsoft: with syntax extensions, you can generate static code to do that item.name addressing with no reflection
[23:34:42] <Matthias247> cmr: but currently only in native and linux ;)
[23:34:48] <eddyb> johnsoft: from raw strings. actually, hang on a second
[23:34:56] <cmr> Matthias247: good enough for me!
[23:35:10] <Matthias247> but at least I have some ideas how it translates to the other things
[23:35:10] <eddyb> cmr: we can do ES6 template strings with syntax extensions \o/
[23:35:21] <eddyb> OMG RUST ALMIGHTY
[23:36:03] <johnsoft> heh, i think macros and syntax extensions are beyond me right now
[23:36:30] <eddyb> johnsoft: you need them for compiled templates
[23:36:54] <johnsoft> i'll play around with this though
[23:36:54] <eddyb> otherwise it will be several times slower than JS code doing the same
[23:37:05] <eddyb> (which JITs)
[23:37:14] <eddyb> cmr: quasi!r"foo${let x = 5; x*x}bar"
[23:37:30] <eddyb> apart from not using ``, I think we've got a winner :D
[23:37:50] <johnsoft> yeah true
[23:38:18] <johnsoft> but i think i should start simple and work my way up
[23:38:38] *** Quits: dmac (Adium@moz-94F55C3.hfc.comcastbusiness.net) (Ping timeout)
[23:38:41] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[23:38:51] <eddyb> johnsoft: then have fun with Encoder :D
[23:39:03] <johnsoft> i will! ty
[23:39:21] <eddyb> johnsoft: you might want to filter a field and then pass the contents to JsonEncoder - I'm curious how that would look like
[23:39:40] <johnsoft> filter a field?
[23:39:43] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[23:40:28] <eddyb> johnsoft: handle emit_struct_field, check if the name matches, if so, let it recurse
[23:40:37] <eddyb> (to give you the contents)
[23:41:06] <johnsoft> i have no idea what you're talking about
[23:41:16] <johnsoft> but i will in a few hours, give me some time :P
[23:41:26] <eddyb> johnsoft: take a look at the Encoder interface, the docs you linked
[23:41:43] <eddyb> rusti: Some(5).to_json()
[23:41:47] -rusti- pastebinned 7 lines of output: http://ix.io/9Y8
[23:41:49] <Matthias247> johnsoft: that also happens to me surprisingly often in this channel :)
[23:41:51] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[23:42:05] <eddyb> rusti: {use extra::json::ToJson; Some(5).to_json()}
[23:42:06] -rusti- Number(5f64)
[23:42:20] <eddyb> erm, what?
[23:42:26] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[23:42:34] <cmr> what?
[23:42:35] <eddyb> ooooh, it's not stringified
[23:42:43] <eddyb> rusti: {use extra::json::ToJson; Some(5).to_json().to_str()}
[23:42:44] -rusti- ~"5"
[23:42:56] <eddyb> rusti: {use extra::json::ToJson; None::<uint>.to_json().to_str()}
[23:42:57] -rusti- ~"null"
[23:43:11] <johnsoft> oh god a null
[23:43:14] <johnsoft> MAKE IT GO AWAY
[23:43:29] *** Joins: ptc (Adium@moz-192425C4.nyc.res.rr.com)
[23:43:31] <eddyb> rusti: {use extra::json::ToJson; Ok::<~str, ~str>(~"boo").to_json().to_str()}
[23:43:34] -rusti- pastebinned 7 lines of output: http://ix.io/9Y9
[23:43:43] <johnsoft> i'm in #rust, i thought i had seen my last null
[23:43:54] <eddyb> we don't have Encodable on Result?
[23:44:00] <eddyb> johnsoft: it's JSON :P
[23:44:14] *** Quits: squiddy (squiddy@moz-E1460A4B.adsl.alicedsl.de) (Quit: Leaving)
[23:44:37] <johnsoft> i know
[23:44:48] <johnsoft> it's everywhere, it can't be escaped
[23:44:55] <eddyb> rusti: {use extra::json::ToJson; enum Fruit<T>{Apple(T), Orange(T)} Apple(~"boo").to_json().to_str()}
[23:44:55] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[23:44:57] -rusti- pastebinned 7 lines of output: http://ix.io/9Ya
[23:45:09] <eddyb> rusti: {use extra::json::ToJson; #[deriving(Encodable)] enum Fruit<T>{Apple(T), Orange(T)} Apple(~"boo").to_json().to_str()}
[23:45:09] *** Quits: ptc (Adium@moz-192425C4.nyc.res.rr.com) (Ping timeout)
[23:45:11] -rusti- pastebinned 7 lines of output: http://ix.io/9Yb
[23:45:12] <eddyb> pls work
[23:45:43] <johnsoft> what I wonder is
[23:45:53] <eddyb> cmr: I'm using it wrong :/
[23:45:59] <cmr> eddyb: yes, you are.
[23:46:01] <johnsoft> serializing::Encoder is in ::extra, but requires compiler magic
[23:46:06] <cmr> http://static.rust-lang.org/doc/master/extra/json/trait.ToJson.html#tymethod.to_json
[23:46:10] <cmr> it's not for encodable things.
[23:46:15] <johnsoft> shouldn't it be in ::std?
[23:46:20] <cmr> johnsoft: nope.
[23:46:34] <cmr> the syntax extensions can live in libextra, now, and libstd is kept minimal.
[23:46:38] *** Quits: Matthias247 (Miranda@moz-BDD35EC0.hsi5.kabel-badenwuerttemberg.de) (Connection reset by peer)
[23:46:41] <johnsoft> what's the distinction?
[23:47:02] <cmr> libstd is for io, runtime, and widely-used utilities
[23:47:06] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[23:47:06] <cmr> extra is for everything else.
[23:47:15] <eddyb> cmr: I want to serialize an Encodable to a string
[23:47:17] <johnsoft> ok
[23:47:18] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[23:47:29] <johnsoft> extra is kind of a tacky name though
[23:47:42] <johnsoft> although it's probably too late to change it
[23:47:53] <cmr> eddyb: that's not what it does.
[23:48:03] <cmr> johnsoft: libstd used to be called libcore, and libextra libstd.
[23:48:04] <johnsoft> i think core and std would have made more sense
[23:48:07] <eddyb> cmr: I don't want to create a MemWriter myself :/
[23:48:10] <cmr> heh
[23:48:13] <eddyb> johnsoft: that's what we had
[23:48:17] <johnsoft> HAH
[23:48:20] <eddyb> s/we/before me/
[23:48:28] <cmr> johnsoft: libextra is going to be disolved.
[23:49:07] <johnsoft> cmr- huh?
[23:49:30] <eddyb> into multiple libraries
[23:49:30] <cmr> libextra is destined to die, to be replaced with many smaller crates managed with rustpkg.
[23:49:43] <johnsoft> ah, okay
[23:49:59] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[23:49:59] <johnsoft> so... Encodable *doesn't* need compiler magic?
[23:50:06] <cmr> nope.
[23:50:13] <cmr> you could write the Encodable/Decodable implementations by hand.
[23:50:19] <johnsoft> very cool
[23:50:29] <calien> still batteries included? That's a pretty distinctive aspect of a modern system language's library setup.
[23:50:43] <cmr> calien: yes, it will be batteries included.
[23:51:13] <johnsoft> i hope rustpkg gets figured out before then :P
[23:51:29] *** Quits: vadimg (vadimg@BCFFDE00.DF0A212.39C00A7A.IP) (Ping timeout)
[23:51:40] <bytbox> should std::vec::build take a proc instead of a closure? (I'm still not clear on when each is appropriate, but it's only called once, so...)
[23:51:41] <cmr> it will be.
[23:52:08] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[23:52:08] <johnsoft> naturally
[23:52:15] <cmr> bytbox: build should just plain be removed.
[23:52:17] <calien> cmr: in particular, that aspect of Rust should make it work /much/ better on Windows than lots of other languages dependent on their own packaging systems for a reasonably wide variety of software
[23:52:25] *** Quits: canhtak (canhtak@moz-6C22A50C.wl.t.ulaval.ca) (Quit: canhtak)
[23:52:40] <bytbox> cmr: hmm, ok
[23:52:44] *** Joins: Cevn (sameer@moz-FD022892.wireless.umd.edu)
[23:53:06] <calien> e.g., Ruby (different target audience, etc, I know) supposedly works on Windows. if one has a compiler, probably cygwin, etc installed too. i.e. as unix-like as feasible
[23:53:33] <johnsoft> ruby works on windows
[23:53:48] <johnsoft> it comes as an exe installer, you get gemtool and everything
[23:53:55] <calien> See comment. The core language works fine, but packaging system assuming compiler yadda yadda yadda
[23:54:08] <calien> right and gems often assume (...)
[23:54:25] <johnsoft> okay the gems, yeah
[23:54:38] *** Quits: Cevn (sameer@moz-FD022892.wireless.umd.edu) (Ping timeout)
[23:54:41] <eddyb> cmr: I meant, how can I use extra::json::Encoder without much fuss?
[23:54:44] <calien> In practice, ruby-as-used-in-the-wild does not work on Windows without making it as unix-like as feasible
[23:54:55] <cmr> eddyb: you can't, really. it's pretty fussy.
[23:54:58] <johnsoft> anything with native code or C extensions or whatever ruby calls it
[23:54:58] *** Quits: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net) (Ping timeout)
[23:55:00] <eddyb> a direct equivalent of JSON.serialize would be cool
[23:55:09] <eddyb> oh, wait, it uses a Writer not a builder
[23:55:09] <cmr> eddyb: add one? :)
[23:55:12] <calien> Thus, my comment regarding one advantage of Rust's being batteries included
[23:55:25] *** Joins: jviereck (Adium@moz-56DDD13.dip0.t-ipconnect.de)
[23:55:40] *** Quits: snerd (motk@moz-D21A06DF.members.linode.com) (Ping timeout)
[23:55:56] *** Joins: ziad (ziad@moz-5729CEA7.hsd1.ca.comcast.net)
[23:56:40] <eddyb> cmr: remember the fancy string builder I keep talking about?
[23:56:53] <cmr> eddyb: no? the es6 stuff.
[23:56:54] <eddyb> it might be time to implement it and use it across std and extra
[23:57:08] <eddyb> cmr: no, the stack abusing one, one single allocation of the right size
[23:57:26] <eddyb> (unlike whatever MemWriter does)
[23:57:32] <cmr> ah alloca?
[23:57:40] <eddyb> cmr: nope
[23:57:47] <cmr> then I don't remember at all
[23:58:08] <SiegeLord> I don't quite see how breaking up extra supports the idea of batteries being included at all
[23:58:24] <cmr> SiegeLord: well the idea is that we can ship more since it won't be a monolithic crate.
[23:58:33] *** Quits: kngl (Adium@E5907D90.770DEA4D.7C797F8E.IP) (Quit: Leaving.)
[23:58:40] *** Quits: haberman (Mibbit@moz-DF9D49BB.hsd1.wa.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:58:53] <eddyb> cmr: chaining substrings, recursion being used to efficiently add up the size, and then put the pieces in place
[23:59:02] <SiegeLord> So the extra chunks will still be included with the main distribution?
[23:59:07] <cmr> yeah.
[23:59:11] <cmr> at least for now.
[23:59:21] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[23:59:34] *** Joins: csherratt (csherratt@moz-8D848271.cpe.teksavvy.com)
