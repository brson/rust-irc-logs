[00:00:15] <strcat> kimundi: 'deref' is using a deprecated feature
[00:00:36] <strcat> I think .map(clone) will be fine
[00:00:47] <strcat> just need to wait for the method resolve fix and method reform
[00:00:58] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[00:01:46] <MaikKlein> can I ask git what files I have changed?
[00:01:51] <Eridius> strcat: I still think iterating over copies is going to be common enough (especially with vectors of numeric types) that it should have a more obvious solution
[00:01:52] <MaikKlein> and what lines I have changed?
[00:01:58] <Eridius> MaikKlein: `git status` and `git diff`?
[00:02:05] <MaikKlein> Eridius, thanks!
[00:02:11] <strcat> Eridius: .map(clone) is a more obvious solution than a bigger api
[00:02:20] <MaikKlein> i love git so much
[00:02:47] <Eridius> strcat: it feels odd to call clone() on a numeric type
[00:03:04] <strcat> Eridius: it might feel "odd" but Copy is deprecated
[00:03:08] <strcat> and will go away
[00:03:20] <strcat> and Clone will be renamed to Copy
[00:03:31] <kimundi> strcat: I get that map(clone) could work... But what is deprecated with dereferencing an borrowod pointer?
[00:03:46] <strcat> kimundi: that's using deprecated functionality, you can't deref a generic type to copy it
[00:04:17] <strcat> generics types aren't implicitly copyable, it'd be unsafe
[00:04:18] <Eridius> strcat: :(
[00:04:20] <kimundi> ah, right. would only work some types
[00:04:45] <strcat> Clone/DeepClone is how things are copied
[00:04:52] <kimundi> yeah, map(copy) would be the best then.
[00:04:53] <strcat> once we finally remove Copy, they can be called Copy/DeepCopy
[00:05:11] <MaikKlein> bjz, ok it's working now thanks, I make the PR
[00:09:20] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:09:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/vUX1eg
[00:09:20] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:09:59] <strcat> slightly less dependency on rpaths... yay :)
[00:12:18] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[00:12:18] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/C6wBSw
[00:12:18] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[00:12:20] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:12:21] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/rqY69w
[00:12:21] <ghrust> 13rust/06auto 141be9c98 15Daniel Micay: rm vec::uniq_len
[00:12:21] <ghrust> 13rust/06auto 142cd720b 15Daniel Micay: rm CopyableOrderedIter...
[00:12:21] <ghrust> 13rust/06auto 1465754a9 15Daniel Micay: fix test
[00:12:21] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:13:02] <MaikKlein> bjz, I sent it
[00:13:48] <bjz> MaikKlein: thanks!
[00:14:11] <nmatsakis> brson: still around?
[00:15:32] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (No route to host)
[00:15:35] <brson> nmatsakis: yesh
[00:15:54] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[00:16:03] <MaikKlein> bjz, and thanks  for all your effort that you are doing like lmath gl-rs glfw, I am trying to help as best as I can, even if it is not that much :(
[00:16:12] *** Quits: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr) (Quit: pyrac)
[00:21:43] <aatch> Almost done adding compiler support for all of the atomic operation/ordering combinations.
[00:21:46] <kyle2000> MaikKlein: you are giving us all hope which is one of the best kinds of help. the rust future keeps looking brighter and brighter thanks to your contributions.
[00:23:33] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[00:24:51] *** Joins: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net)
[00:26:14] <aatch> bblum, what do you think of having all of the atomic operations and orderings available? :D
[00:26:30] *** Quits: eholk (eholk@moz-E45742D4.public.wayport.net) (Quit: eholk)
[00:26:30] *** Quits: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[00:27:12] <MaikKlein> kyle2000, well I haven't done much yet :) but autocompletion is probably ready next week.
[00:27:24] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[00:27:50] <kyle2000> MaikKlein: i cannot wait! i just cannot wait! i am throbbing with so much excitement about your work. but put your studies first. they are more important.
[00:28:39] <MaikKlein> doener, are you studying CS in bielefeld?
[00:29:14] <MaikKlein> yeah I always find an excuse to learn rust instead of learning for my exams, stupid me :X
[00:29:27] *** Quits: tjc (tjc@moz-4ED25D08.tukw.qwest.net) (Quit: zzzzzzzzzz)
[00:31:36] <nmatsakis> brson: r? https://github.com/mozilla/rust/pull/7167
[00:31:41] <nmatsakis> brson: also, I think I was wrong about dead locks.
[00:31:57] <nmatsakis> brson: or else they went away :)
[00:34:38] <doener> MaikKlein: I finished in 2010
[00:34:47] *** Quits: koomi (koomi@moz-B2B8B6D1.superkabel.de) (Quit: WeeChat 0.4.1)
[00:35:53] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[00:36:25] <bjz> MaikKlein: helping to keep stuff building is a huge help
[00:36:37] <bjz> MaikKlein: so thanks :)
[00:37:00] <MaikKlein> bjz, you are welcome
[00:37:57] <steven_is_false> Is Rust eventually going to allow support for custom memory allocators?
[00:38:26] <strcat> steven_is_false: it does, we just don't have nice overloading for pointer-like things
[00:38:46] <MaikKlein> strcat, isn't that the purpose of the custom smart pointer proposal?
[00:38:46] <strcat> but you can implement custom allocators or things like arenas/refcounting
[00:38:55] <MaikKlein> oh
[00:38:58] <steven_is_false> strcat: Doesn't one have to use unsafe casting to do that though?
[00:39:01] <MaikKlein> wrong guy
[00:39:11] <strcat> steven_is_false: you can expose a safe interface
[00:39:21] <strcat> you can't really implement an allocator without unsafe
[00:39:26] <steven_is_false> strcat: Oh okay.
[00:39:54] <strcat> MaikKlein: I don't think the smart pointer proposal really deals with the problems that exist right now
[00:39:58] <strcat> Rc<T> is fine
[00:40:38] <strcat> the problems are the currently mandatory drop flag, lacking a way to deal with managed T, lacking a pointer trait for overloading deref/borrows
[00:41:07] <strcat> I don't like the @Ptr syntax because it's very arbitrary - what qualifies as an allocator?
[00:42:07] <strcat> and we can't have borrows from RcMut via sugar, it would mean a really, really magical trait
[00:42:26] <strcat> https://github.com/mozilla/rust/issues/7140
[00:42:37] <MaikKlein> does anyone know if this guy http://opensourcebridge.org/sessions/970 is also in the IRC?
[00:42:46] <strcat> anyway I don't think we should be adding features or syntactic sugar without a real need
[00:43:15] <aatch> strcat, that said, some sugar for smart pointer would be nice.
[00:43:18] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Ping timeout)
[00:43:26] *** Joins: alisdair (textual@moz-EA60A466.dedicated.allstream.net)
[00:43:32] <strcat> aatch: we need a pointer trait for overloading borrows
[00:43:39] <dbaupp> MaikKlein: tjc here and catamorphism on github
[00:44:01] <strcat> but I don't know why we'd want @Type Type2 as an arbitrary sigil
[00:44:07] <strcat> how do you pass a second type parameter to the allocator?
[00:44:27] <aatch> strcat, yep, I think borrowing is the only thing I'd really want
[00:44:36] <aatch> strcat, good point.
[00:44:57] <strcat> lots of allocators will want more type params for sizes
[00:44:59] <MaikKlein> dbaupp, thanks
[00:45:00] <Eridius> I just updated my vim rust support to the latest on master; why is the 100-column highlight and the conceal characters gone?
[00:45:01] <strcat> once we have associated consts
[00:45:09] <aatch> I'm not too bothered about the precise syntax for it though.
[00:45:23] <aatch> Eridius, because they were removed.
[00:45:25] <strcat> aatch: well I'm bothered by special casing allocators in a weird way :(
[00:45:32] <Eridius> aatch: gee, thanks
[00:45:38] <strcat> and assuming allocators all work like the current @ (which is a very bad basis)
[00:45:39] <aatch> Eridius, :P
[00:45:39] <Eridius> why were they removed is the question?
[00:45:56] <strcat> Eridius: colorcolumn is a user setting, not something a syntax file should set
[00:46:01] <doener> hm, now I got deadlocks
[00:46:16] <aatch> Eridius, well conceal characters either don't work or aren't liked.
[00:46:20] <Eridius> strcat: it was an ftplugin, not a syntax file
[00:46:25] <Eridius> aatch: whaa? I loved the conceal characters!
[00:46:26] *** Joins: deepdog (deepdog@moz-490E834C.client.mchsi.com)
[00:46:26] <aatch> I think you can turn them back on.
[00:46:38] *** Quits: deepdog (deepdog@moz-490E834C.client.mchsi.com) (Quit: Leaving)
[00:46:39] <aatch> They just aren't on by default.
[00:47:08] <aatch> Eridius, you can turn them back on.
[00:47:08] <Eridius> oh hrm, yeah I see g:rust_conceal now
[00:47:14] <Eridius> how do I turn that on before the syntax file is evaluated?
[00:47:22] <Eridius> stick it globally in vimrc?
[00:47:27] <aatch> Eridius, yep.
[00:48:03] <strcat> aatch: if you want to make trans 2x faster, make @ move by default ;p
[00:48:27] <aatch> strcat, and how would I do that?
[00:48:37] <strcat> magic
[00:51:47] <aatch> https://github.com/mozilla/rust/pull/7168 all of the atomics
[00:53:27] <MaikKlein> isn't @ unmoveable?
[00:53:29] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[00:53:40] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[00:53:42] <bstrie> aatch: I didn't say I would change the topic, I don't have the power to. I just said that the topic should be changed :P
[00:53:56] <aatch> bstrie, oh, sorry I must have mis-read
[00:54:25] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[00:54:26] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141e995e0 to 14c989b79: 02http://git.io/N3iJvQ
[00:54:26] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[00:54:26] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[00:54:26] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/IKeovg
[00:54:26] <ghrust> 13rust/06auto 14207e2b8 15Niko Matsakis: Partial fix for #7158: Save EDX in morestack on x86-32
[00:54:26] <ghrust> 13rust/06auto 1493231a9 15Niko Matsakis: correct ASM_COMMENTS Makefile option
[00:54:26] <ghrust> 13rust/06auto 14054c4af 15Niko Matsakis: Add copies to type params with Copy bound
[00:54:28] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[00:57:03] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[00:59:42] *** Joins: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net)
[01:01:26] *** Quits: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de) (Ping timeout)
[01:01:51] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[01:04:22] *** Quits: mleise (marco@moz-3468AB5B.pools.arcor-ip.net) (Quit: Leaving.)
[01:05:11] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[01:08:49] *** Quits: alisdair (textual@moz-EA60A466.dedicated.allstream.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:09:31] *** Joins: koomi (koomi@moz-9AE5526E.pools.arcor-ip.net)
[01:10:18] <aatch> Oh god, there is code in trans so old that it doesn't use the TypeKind constants...
[01:11:07] <steven_is_false> Which library module gives the finally methods?
[01:12:05] <dbaupp> steven_is_false: std::unstable::finally
[01:12:12] <steven_is_false> dbaupp: Thanks.
[01:19:15] *** Quits: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP) (Quit: (quit))
[01:20:06] *** Joins: KindOne (KindOne@moz-688C7E84.dynamic.ip.windstream.net)
[01:23:24] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[01:25:18] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Quit: Leaving)
[01:28:02] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.1)
[01:29:47] <Eridius> is there any way to sleep the current task, besides using libc::funcs::posix88::unistd::sleep()?
[01:30:16] *** Quits: mreedell (mreedell@moz-9950CA28.hsd1.pa.comcast.net) (Quit: Computer has gone to sleep.)
[01:30:22] <steven_is_false> Eridius: The relevant functionality in extra timer seems to be broken.
[01:30:28] <Eridius> :/
[01:30:44] <steven_is_false> What I do is use yield extra::time, and polling
[01:30:58] <strcat> Eridius: sleep won't just sleep the current task
[01:31:02] <steven_is_false> It's not a real solution but it works for now.
[01:31:08] <strcat> unless you're using 1:1 mapping with threads
[01:31:25] <Eridius> strcat: well I only have one task anyway
[01:31:46] <Eridius> although I'm very slightly surprised. Go treats all C calls as potentially blocking and runs them on their own OS thread
[01:32:08] <strcat> that would be way too slow
[01:32:08] <Eridius> steven_is_false: what do you mean, yield extra::time?
[01:32:13] <Eridius> strcat: heh yeah, it is kidna
[01:32:15] <Eridius> *kidna
[01:32:17] <Eridius> *kinda
[01:32:30] <strcat> especially since every allocation is an FFI call
[01:32:31] <steven_is_false> Eridius: std::ask:::yield, and the extra::time module
[01:32:35] <strcat> and plenty of other stuff
[01:32:44] <Eridius> steven_is_false: ah a missing comma. I thought you were yielding time somehow
[01:32:56] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[01:33:21] <steven_is_false> Eridius: The code to get the timer right is kinda complicated let me point you to the source code in my project
[01:33:32] <brson> somebody else converted the Cell ctors while I've been rebasing my patch for weeks. That is frustrating
[01:33:35] <Eridius> steven_is_false: this is going to busy-wait though, if other tasks aren't doing anything, right?
[01:33:46] * brson grumbles
[01:33:58] <strcat> nmatsakis: aw two tests failed :(
[01:34:06] <strcat> silly tutorial ones
[01:34:34] <steven_is_false> Eridius: I guess, logically it makes sense for task::yield to yield back to the os as well but right now all it does is hop over to the next task in the linked list of tasks
[01:34:46] <nmatsakis> strcat: with my pus?
[01:34:49] <nmatsakis> strcat: *push?
[01:34:53] <strcat> nmatsakis: yeah
[01:35:17] <Eridius> how do you lock a task to a thread?
[01:35:33] <Eridius> or rather, lock a thread to only running a given task? Or is that not possible?
[01:35:35] <nmatsakis> strcat: dang. :)
[01:35:40] <strcat> Eridius: you can
[01:35:41] * Eridius wants to use the unsafe sleep, because he's going to be sleeping for quite a while
[01:35:47] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Connection reset by peer)
[01:36:02] <steven_is_false> Eridius: Here's the relevant code http://gitorious.org/p-x/p-x/blobs/master/src/time.rs
[01:36:04] <strcat> Eridius: http://static.rust-lang.org/doc/std/task.html#function-spawn_sched
[01:36:18] <strcat> I don't know if it works right now
[01:36:21] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[01:36:21] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1470bb432 to 14c989b79: 02http://git.io/N3iJvQ
[01:36:21] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[01:36:21] <Eridius> hah
[01:36:23] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:36:23] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/r19ufw
[01:36:23] <ghrust> 13rust/06auto 141be9c98 15Daniel Micay: rm vec::uniq_len
[01:36:23] <ghrust> 13rust/06auto 142cd720b 15Daniel Micay: rm CopyableOrderedIter...
[01:36:23] <ghrust> 13rust/06auto 1465754a9 15Daniel Micay: fix test
[01:36:23] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:36:45] <strcat> but anyway, ThreadPerTask
[01:36:51] <Eridius> strcat: thanks
[01:37:10] <strcat> (assuming it works ;p)
[01:38:26] <aatch> Wow, the code for the x86-64 C ABI is awful.
[01:40:18] <nmatsakis> aatch: please do not touch that code
[01:40:24] <nmatsakis> aatch: nor the code in foreign if you can help it :)
[01:40:42] <aatch> nmatsakis, you working in there?
[01:40:43] <nmatsakis> aatch: in my branch, it's all ripped out (well, the x86-64 ABI code is still there,
[01:40:57] <nmatsakis> aatch: but if you change the interface, everything'll break)
[01:41:07] <nmatsakis> aatch: though I do agree it ... could use some work :)
[01:41:28] <aatch> nmatsakis, the interface is the same, just some renaming and refactoring.
[01:41:31] <nmatsakis> aatch: this is my branch that removes the foreign fn wrappers, which is ... lingering due to weird windows issues I do not understand.
[01:41:59] <nmatsakis> aatch: ok. it's going to be "fun" rebasing that branch in any case...
[01:42:20] <strcat> aatch: btw did you ever figure out why the mergefunc pass doesn't work?
[01:42:24] <strcat> we could really use it ;p
[01:42:28] <aatch> strcat, no idea.
[01:42:40] <aatch> The errors it caused were just weird.
[01:42:47] <aatch> and I couldn't reproduce it.
[01:42:51] * doener hates canaries
[01:42:53] <dbaupp> https://github.com/mozilla/rust/pull/7123 r?
[01:43:06] <doener> running the test suite over and over again is no fun at all :-/
[01:43:10] <aatch> All I can think was that it did something funky with HashMap
[01:43:15] <strcat> dbaupp: looking
[01:43:50] <strcat> dbaupp: IteratorUtil is in prelude now btw
[01:45:56] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Quit: leaving)
[01:47:36] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[01:48:15] <dbaupp> strcat: yup, ok, removing that now
[01:48:22] <strcat> hm
[01:48:42] * strcat is looking forward to the next fix for default methods
[01:48:49] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[01:48:49] <strcat> then we can add a size hint to Iterator
[01:49:17] <strcat> and wipe out all the things that predated collect()
[01:50:36] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[01:52:43] <steven_is_false> How should I refer to the Rust language toolchain in documentation
[01:53:15] <nmatsakis> strcat: I predict your PR will conflict with mine. Curse you.
[01:53:16] *** Quits: koomi (koomi@moz-9AE5526E.pools.arcor-ip.net) (Ping timeout)
[01:53:19] <nmatsakis> ;)
[01:53:21] <strcat> nmatsakis: heh :)
[01:53:32] * nmatsakis roots for some niggling test failure
[01:53:51] *** Joins: tjc (tjc@moz-7005EB78.hfc.comcastbusiness.net)
[01:53:51] *** ChanServ sets mode: +o tjc
[01:53:53] <strcat> possible, this is the 3rd attempt
[01:54:05] <strcat> it made it to the benchmarks last time
[01:54:12] <strcat> removing vec::each and BaseIter will be fine.
[01:54:17] <strcat> s/fine/fun/
[01:56:32] <steven_is_false> Which page is the is rust fast yet page?
[01:56:42] <doener> http://huonw.github.io/isrustfastyet/
[01:56:53] <steven_is_false> Thanks! doener
[01:57:31] *** Quits: tjc (tjc@moz-7005EB78.hfc.comcastbusiness.net) (Quit: zzzzzzzzzz)
[01:57:46] <dbaupp> doener: your glue code fix appeared to give a nice little speed-up! http://huonw.github.io/isrustfastyet/#998e41a
[01:58:46] <doener> dbaupp: I guess "appeared" is key there. Looking back a bit, it's just back to normal.
[01:59:12] <dbaupp> well, that's just because everyone else is making it slower ;)
[01:59:35] <doener> dbaupp: it definitely improved the generated code (the mentioned 13%), but made the llvm passes slower, because more inlining happens
[01:59:52] *** Quits: carter (carter@moz-12C317EF.nyc.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[02:00:06] <dbaupp> but that's good, so I'm not complaining
[02:00:28] <doener> dbaupp: https://mail.mozilla.org/pipermail/rust-dev/2013-June/004501.html -- this is more interesting
[02:00:53] <strcat> rusti: 2
[02:00:53] <dbaupp> yeah, I saw/am excited for that
[02:00:53] -rusti- 2
[02:01:08] <strcat> rusti: let xs = [1, 2, 3]; xs.iter().take_(2)
[02:01:09] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/MEDc
[02:01:14] <strcat> yay
[02:01:25] <doener> next time I'll just ask graydon for something to optimize right away... that change drops 300% as much time from the compilation as all my previous patches combined
[02:01:46] <Eridius> strcat: crap, rust: task failed at 'ThreadPerTask scheduling mode unimplemented'
[02:01:46] <dbaupp> strcat: yay?
[02:02:00] <dbaupp> doener: heh :)
[02:02:00] <strcat> dbaupp: it updated 
[02:02:05] <strcat> IteratorUtil in scope ;p
[02:02:10] <dbaupp> strcat: oh, right :D
[02:02:27] <doener> dbaupp: OTOH, having the pre-trans part down by 50% isn't that bad either
[02:02:38] <doener> well, 40%
[02:02:54] <strcat> old_iter is really weird
[02:03:01] <strcat> // Appends two generic sequences.
[02:03:03] <strcat> #[inline(always)]
[02:03:05] <strcat> pub fn append<T:Copy,IT:BaseIter<T>,BT:Buildable<T>>(lhs: &IT, rhs: &IT)
[02:03:07] <strcat>                                                   -> BT {
[02:03:13] <strcat> heh
[02:03:17] <dbaupp> doener: of coruse it's not
[02:03:32] <aatch> doener, btw, you able to see how big CrateContext::new() is compared to the old trans::trans_crate?
[02:03:57] <aatch> Since I'm sure that most of the bloat comes from the @-allocations
[02:04:40] <bblum> aatch: why, that would be splendid
[02:04:57] <dbaupp> strcat: that's disappearing in your next PR, right? ;P
[02:05:03] <strcat> dbaupp: yes
[02:05:09] <aatch> bblum, I've got a PR that adds in all the intrinsics.
[02:05:12] <strcat> dbaupp: I think I can get rid of all of old_iter in the next one
[02:05:17] <strcat> not that hard
[02:05:20] <dbaupp> awesome!
[02:05:22] <strcat> just a lot of conflicts to deal with
[02:05:36] <aatch> so you can do `atomic_and_acqrel` if you want :D
[02:05:45] <strcat> dbaupp: https://github.com/mozilla/rust/pull/7162 added some missing bits
[02:05:57] <strcat> Iterator is a full replacement now
[02:06:03] <aatch> bblum, https://github.com/mozilla/rust/pull/7168
[02:06:03] <strcat> all it's missing is the size hint
[02:06:16] <bblum> aatch: did you want me to r it?
[02:06:26] <bblum> oh, not necessary
[02:06:26] <aatch> bblum, you can if you want
[02:06:46] <aatch> Oh, pcwalton got to it.
[02:06:46] <strcat> dbaupp: ofc there are more things we need :)
[02:06:49] <doener> aatch: have to build the resepective versions, gimme 10 minutes or os
[02:07:08] <dbaupp> strcat: like 5898 being fixed ;)
[02:07:28] <strcat> dbaupp: range, repeat, cycle, accumulate (fold, but yielding the intermediate steps), etc.
[02:07:48] <dbaupp> strcat: ScanIterator does accumulate
[02:07:54] *** Quits: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[02:07:56] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[02:07:57] <strcat> dbaupp: oh :)
[02:08:22] <dbaupp> strcat: and join/bind/whatever you want to call it
[02:08:57] <dbaupp> has there been any progress on a new snapshot, btw?
[02:09:27] <strcat> master needs to be fixed
[02:11:06] <strcat> ugh
[02:11:14] <strcat> it seems cross-compiling depended on the absolute rpaths
[02:11:16] <strcat> I'll have to fix that
[02:11:48] *** Joins: kimundi_ (kimundi@moz-24378D0F.dip0.t-ipconnect.de)
[02:11:52] *** Quits: kimundi (kimundi@moz-5463FFDF.dip0.t-ipconnect.de) (Ping timeout)
[02:11:52] *** kimundi_ is now known as kimundi
[02:12:56] <Eridius> hrm, I'm surprised there's no Generator iterator which just takes a &'self fn() -> Option<A>
[02:13:41] <Eridius> could mock one up with the UnfoldrIterator by using () as the state but it feels odd
[02:14:38] <Eridius> although I guess an iteator that depends on captured state to do anything useful is maybe more esoteric than I'm thinking
[02:15:06] *** Quits: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com) (Quit: jrfeenst)
[02:15:35] <dbaupp> Eridius: especially when it can be mocked using UnfoldrIterator with () as the state ;)
[02:15:41] <Eridius> :P
[02:15:42] *** Quits: KindOne (KindOne@moz-688C7E84.dynamic.ip.windstream.net) (Ping timeout)
[02:16:11] *** Joins: tjc (tjc@moz-7005EB78.hfc.comcastbusiness.net)
[02:16:11] *** ChanServ sets mode: +o tjc
[02:16:53] <Eridius> dbaupp: I kind of think there should be an IteratorUtil.find(), although it can be mocked up with .skip_while().next()
[02:17:06] <strcat> Eridius: I added it
[02:17:17] <dbaupp> Eridius: https://github.com/mozilla/rust/pull/7162
[02:17:27] <dbaupp> strcat: you broke the tutorial :(
[02:17:28] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[02:17:30] <Eridius> hah nice :)
[02:17:32] <strcat> skip_while won't work because it would advance it one too far
[02:17:49] <strcat> nmatsakis: heh, mine failed on the tutorial too ;p
[02:17:57] <Eridius> strcat: skip_while returns the first element that isn't skipped
[02:18:00] *** Joins: doomlord1 (walter@moz-6651F8D4.range86-145.btcentralplus.com)
[02:18:12] <strcat> Eridius: ah sorry, nvm
[02:18:22] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[02:18:22] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1480453f4 to 14c989b79: 02http://git.io/N3iJvQ
[02:18:22] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[02:19:03] <Eridius> btw strcat, I didn't realize until right now that you were @thestinger ;)
[02:19:18] *** Parts: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com) ()
[02:19:34] <nmatsakis> strcat: d'oh
[02:19:51] *** Joins: KindOne (KindOne@moz-39B50FCB.dynamic.ip.windstream.net)
[02:20:03] <doener> aatch: seems that CrateContext::new got inlined. Still trans_crate dropped from 105319 to a mere (or shall I say puny?) 6546
[02:20:17] *** Quits: tjc (tjc@moz-7005EB78.hfc.comcastbusiness.net) (Quit: zzzzzzzzzz)
[02:20:39] <strcat> failures:
[02:20:41] <strcat>     [run-pass] x86_64-unknown-linux-gnu/test/doc-tutorial/generics_9.rs
[02:20:43] <strcat> heh
[02:22:02] <strcat> huh, I don't understand how the tutorial didn't already break
[02:22:15] <strcat> it adds an iter() and len() method to vec...
[02:22:19] <strcat> there's already iter...
[02:22:59] <doener> aatch: so, in a single function, you cut down librustc by 50% of what the landing pad optimization does on the whole crate
[02:23:16] <Eridius> crud: error: internal compiler error: ty::Region#subst(): Reference to self region when given substs with no self region: substs(self_r=None, self_ty=None, tps=[<V5>,<V6>])
[02:23:48] <strcat> I think that's just an unimplemented error message
[02:24:11] <strcat> meh the tutorial is really bad
[02:24:18] <strcat> it relies a lot on being able to define duplicate methods
[02:24:56] <dbaupp> Eridius: you've probably got a 'self without a &self argument (or on a impl without a 'self)
[02:25:04] <Eridius> dbaupp: I don't have either in my code
[02:25:06] <dbaupp> strcat: https://github.com/mozilla/rust/pull/7123 r?
[02:25:14] <dbaupp> Eridius: oh :S
[02:25:14] <strcat> dbaupp: &self doesn't implicitly have 'self
[02:25:17] <strcat> they're unrelated
[02:25:22] <Eridius> dbaupp: https://gist.github.com/kballard/7c5fdef9a317fd53d548 seems to be what's causing this
[02:25:48] <dbaupp> Eridius: I think there's been some problems with Unfoldr cross-crate
[02:25:59] <dbaupp> Does the unfoldr test work?
[02:26:01] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:26:42] <Eridius> dbaupp: what do you mean? If the test failed we'd know
[02:27:13] <dbaupp> Eridius: I mean, if you copy the test into a separate file so it's not in the std crate
[02:27:58] <Eridius> dbaupp: ah hah, no, triggers the same ICE
[02:28:41] <dbaupp> ok, I think I've found the bug
[02:29:09] *** Quits: doomlord1 (walter@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[02:29:19] <aatch> doener, wow
[02:30:44] <Eridius> dbaupp: hah, turns out using a for-loop with Counter::new(now, -1) was far simpler code anyway
[02:31:10] <strcat> rusti: 1u - 1i
[02:31:12] -rusti- <anon>:9:20: 9:22 error: mismatched types: expected `uint` but found `int` (expected uint but found int)
[02:31:12] -rusti- <anon>:9     let r = {  1u - 1i };
[02:31:12] -rusti-                              ^~
[02:31:12] -rusti- error: aborting due to previous error
[02:31:12] -rusti- application terminated with error code 101
[02:31:31] <doener> aatch: well, I guess effectively there were only a handful of functions that hugely benefit from the landing pad stuff. The old trans_crate (my stuff was before yours), mk_ctxt, and some minor ones. Tons of allocations in a single function aren't that common
[02:31:51] <strcat> doener: strange that LLVM doesn't do that itself
[02:32:25] <doener> strcat: there are function calls involved. It can't know that they're pure
[02:32:37] <strcat> doener: if they're internal it can
[02:32:43] <doener> well... "pure"
[02:32:49] *** Joins: doomlord1 (walter@moz-6651F8D4.range86-145.btcentralplus.com)
[02:32:56] <doener> strcat: allocations aren't internal, are they?
[02:33:21] <strcat> doener: they should be inlined to the point where it sees a call to malloc, for ~
[02:33:23] <strcat> and free
[02:33:31] *** Joins: tjc (tjc@moz-57C63245.tmodns.net)
[02:33:31] *** ChanServ sets mode: +o tjc
[02:33:38] <strcat> if they're not, it's a bug
[02:33:42] <strcat> along with the awful headers.
[02:35:37] *** Joins: KindTwo (KindOne@moz-49638CEA.dynamic.ip.windstream.net)
[02:35:50] *** Quits: KindOne (KindOne@moz-39B50FCB.dynamic.ip.windstream.net) (Ping timeout)
[02:35:55] *** KindTwo is now known as KindOne
[02:36:21] <aatch> doener, still, 90% improvement in size for that function. It's almost a pity it only gets called once
[02:37:41] *** Quits: tjc (tjc@moz-57C63245.tmodns.net) (Quit: zzzzzzzzzz)
[02:38:18] <doener> strcat: it inlines up to global_heap::free
[02:38:32] *** Joins: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP)
[02:38:32] *** Quits: goldfeld (Mibbit@moz-4C4BC521.dynamic.adsl.gvt.net.br) (Quit: http://www.mibbit.com ajax IRC Client)
[02:38:57] <strcat> doener: ok that's something we should fix
[02:39:04] <strcat> I kind of want to remove the atomic alloc counter too
[02:39:11] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[02:39:12] <strcat> it really hurts alloc time
[02:39:40] <strcat> and there are other ways to find leaks
[02:39:58] *** Quits: KindOne (KindOne@moz-49638CEA.dynamic.ip.windstream.net) (Connection reset by peer)
[02:42:19] <doener> aatch: your change is awesome, I just meant to say that _my_ change won't have as big an impact once we get rid of all those pointless indirections. Your refactoring is absolutely awesome
[02:43:06] <aatch> doener, actually, I'm still amazed at how big an impact it did have.
[02:43:41] <aatch> I didn't realize /quite/ how expensive allocations were.
[02:43:45] <flu_> why is it that all of the files in src/libextra/*.rs are sort of automagically made into modules? 
[02:43:55] <flu_> or how rather - not so much why
[02:44:04] <strcat> files are modules
[02:44:04] <aatch> flu_, what do you mean?
[02:44:36] <strcat> they're included with 'mod foo;' in the crate file
[02:44:37] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[02:44:37] <flu_> aatch: they are referenced with the file name as though it was a module - like extra::getopts for instance
[02:44:55] <strcat> flu_: modules *are* usually files
[02:45:07] <flu_> strcat: this might be what I'm asking about. I'll scope out the crate file
[02:45:12] <strcat> if you do 'mod foobar;'
[02:45:15] <strcat> it looks for foobar.rs
[02:46:05] <doener> aatch: I knew that it has a big impact, but only yesterday I realized _why_ that is.
[02:46:14] <dbaupp> and if you do 'mod foo { mod bar; }' it looks for foo/bar.rs
[02:46:19] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[02:47:25] <flu_> dbaupp: hmm. Ok. That's completely sensible, just trying to figure out the weirdly specific scoping used with files in libextra - like explicitly using stuff from core:: (which can't be explicitly referenced by a regular .rs file compliled with rustc)
[02:47:38] <flu_> dbaupp: also, you are the king of stack overflow wrt rust right now. haha
[02:47:57] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[02:47:59] <dbaupp> am I?
[02:48:00] * dbaupp checks
[02:48:20] <steven_is_false> How can one do multiline strings in Rust?
[02:48:29] <doener> flu_: core was renamed to std
[02:48:32] <dbaupp> oh, heh. brson is ahead though.
[02:48:39] <flu_> it's not a SO endorsed title, I just made it up for you since you have the best answers on the top N questions that I looked at
[02:48:46] <kyle2000> is it future safe to use the std::rt::io functionality?
[02:48:51] <doener> flu_: it's just aliased to core, because stage0 uses an old snapshot that still has core
[02:48:58] <flu_> doener: !! aha
[02:49:13] <dbaupp> flu_: oh, I was thinking of http://stackoverflow.com/tags/rust/topusers
[02:49:34] <dbaupp> steven_is_false: strings are mutliline by default
[02:49:41] <doener> steven_is_false: finish the line with \
[02:49:45] <doener> dbaupp: they are?
[02:49:59] <dbaupp> doener: yeah, you can break a string over multiple lines
[02:50:01] <steven_is_false> dbaupp: Right, I meant how do I get rid of the extra whitespace?
[02:50:05] <dbaupp> (which includes the \n)
[02:50:13] <dbaupp> steven_is_false: including the \n?
[02:50:22] <steven_is_false> dbaupp: Not including the \n
[02:50:24] <doener> dbaupp: what does a trailing backslash do, then?
[02:50:37] <dbaupp> steven_is_false: the you just have to unindent the text
[02:50:48] <steven_is_false> dbaupp: That's the only way?
[02:50:51] <dbaupp> doener: it "escapes" all the following whitespace
[02:51:09] <dbaupp> doener: "foo\<newline>   bar" = "foobar"
[02:51:15] <dbaupp> steven_is_false: yep
[02:51:28] <steven_is_false> dbaupp: Okay
[02:52:02] <flu_> doener: so it would be safe to assume that the addition to libextra I'm working on should use std:: rather than core:: ?
[02:53:18] <doener> flu_: if it goes into libextra, use "core", otherwise stage0 will fail. For testing your code outside of rustc, use std
[02:53:25] <flu_> got it
[02:53:42] <flu_> can't test with the code in place given that the compile times are a little burdensome atm
[02:53:47] <flu_> :-)
[02:54:00] <aatch> Workin' on it!
[02:54:09] <doener> aye
[02:54:09] <flu_> godspeed!
[02:55:10] <sp3d> huh, weird behavior with backslashes-escaping-newlines
[02:55:34] <sp3d> lines ending in \ seem to ignore the next line's whitespace... but if I end a line in \\\ it doesn't seem to
[02:58:21] <sp3d> oh, nvm
[03:00:24] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[03:00:24] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e579c65 to 14c989b79: 02http://git.io/N3iJvQ
[03:00:24] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[03:00:24] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[03:00:24] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/Yc8CFg
[03:00:24] <ghrust> 13rust/06auto 146c547e4 15Daniel Micay: rm vec::uniq_len
[03:00:24] <ghrust> 13rust/06auto 14e097d5e 15Daniel Micay: rm CopyableOrderedIter...
[03:00:24] <ghrust> 13rust/06auto 1452a38b8 15Daniel Micay: fix test
[03:00:24] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[03:01:17] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Quit: Leaving)
[03:01:57] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:09:19] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Quit: Computer has gone to sleep.)
[03:19:24] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[03:20:06] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[03:28:00] *** Joins: steveklabnik (steveklabn@moz-C4BA8769.public.wayport.net)
[03:33:10] *** Quits: joelteon (joel@moz-317E8D0C.io) (Ping timeout)
[03:33:55] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Ping timeout)
[03:35:23] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:41:39] *** Joins: joelteon (joel@moz-317E8D0C.io)
[03:42:24] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:42:25] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14134f410 to 14c989b79: 02http://git.io/N3iJvQ
[03:42:25] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:42:25] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[03:42:25] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/UIvfVg
[03:42:25] <ghrust> 13rust/06auto 141deebee 15Felix S. Klock II: Fix #3961 : use char range methods instead of byte offsets to detect whitespace.
[03:42:25] <ghrust> 13rust/06auto 140f4d5c2 15Felix S. Klock II: checkpoint block-comment-wchar state.
[03:42:25] <ghrust> 13rust/06auto 14b03a0b2 15Felix S. Klock II: make pp file conform to actual output, noting some oddities along the way.
[03:42:27] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[03:42:29] <strcat> ugh
[03:42:33] *** Joins: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[03:42:35] <strcat> the test failed because of an unused import.
[03:42:44] *** Quits: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[03:43:42] *** Joins: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP)
[03:45:34] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:46:11] <strcat> the iterator stuff needs to hurry up and land >.<
[03:49:11] <aatch> Initial refactoring done. Now to see all the places I missed.
[03:50:21] <steveklabnik> yeah, so my understanding is that it's replacing the specific ones?
[03:51:22] <dbaupp> steveklabnik: the iterators?
[03:51:47] <steveklabnik> yeah
[03:51:53] <steveklabnik> i was trying to iterate through a string recently
[03:51:58] <steveklabnik> and found that the 'each_bytes' was gone
[03:52:03] <steveklabnik> didn't do more digging into that yet
[03:52:25] <Eridius> iter_bytes() probably
[03:52:34] <dbaupp> yeah, they are hopefully entirely replacing the internal iterators (each_*)
[03:52:41] <steveklabnik> cool :)_
[03:52:44] <dbaupp> Eridius: .bytes_iter()
[03:52:49] *** Parts: dualhbridge (dad@5033F981.CB6B16F2.1EF4A660.IP) ()
[03:52:49] <Eridius> ah
[03:52:51] <steveklabnik> trying to do the matasano crypto stuff
[03:52:58] <aatch> rusti: "test".iter().advance(|&c| println(fmt!("%c", c)))
[03:52:59] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VebY
[03:53:01] <Eridius> steveklabnik: hah, I'm doing matasano in rust too
[03:53:05] <steveklabnik> first two were super easy, second is super hard. i dont know wtf i'm doing wrong, but i'll figure it out
[03:53:10] <steveklabnik> Eridius: how far are you?
[03:53:14] <Eridius> just did problem 22
[03:53:23] <steveklabnik> wow
[03:53:26] <steveklabnik> yeah, i'm on 3
[03:53:26] <dbaupp> rusti: "test".iter().advance(|&c| { println(fmt!("%c", c)); true })
[03:53:26] -rusti- <anon>:9:38: 9:40 error: mismatched types: expected `char` but found an &-pointer pattern
[03:53:27] -rusti- <anon>:9     let r = {  "test".iter().advance(|&c| { println(fmt!("%c", c)); true }) };
[03:53:27] -rusti-                                                ^~
[03:53:27] -rusti- error: aborting due to previous error
[03:53:27] -rusti- application terminated with error code 101
[03:53:42] <steveklabnik> i dont know why 'xor a byte against a string' is wrong for me, but i'm sure i'll figure it out
[03:53:50] <Eridius> steveklabnik: protip: keep a common module full of functions like the one that solves XOR, because you'll reuse them
[03:53:56] <Eridius> although you could wait to pull them into the module until you need to reuse
[03:54:13] <dbaupp> rusti: "test".iter().advance(|c| { println(fmt!("%c", c)); true }); "test".bytes_iter().advance(|b| { println(fmt!("%?", b)); true });
[03:54:15] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/cBWh
[03:54:29] <steveklabnik> Eridius: yeah, i should do that
[03:54:31] <steveklabnik> :)
[03:54:57] <Eridius> steveklabnik: so my module has methods that xor two ~[u8]'s and xor's a ~[u8] against a single u8
[03:55:25] * steveklabnik nods
[03:55:27] <Eridius> steveklabnik: btw, you need to be working in ~[u8] instead of ~str
[03:55:40] <steveklabnik> the first thing i was doing was converting the ~str into a ~[u8]
[03:55:49] <Eridius> because ~str requires its contenst to be valid utf-8, and when you're encrypting/decrypting things, you will often not have utf-8
[03:56:05] <Eridius> steveklabnik: yeah my .from_hex() method returns a ~[u8] directly
[03:56:07] <steveklabnik> ahhh, that makes sense. i just figured that it was easier
[03:56:17] <strcat> steveklabnik: I made a mailing list post about the iterator changes, dunno if you saw it
[03:56:23] <steveklabnik> yeah, that's what made me think of it
[03:56:27] <Eridius> anyway, my xor against a single byte iterates using `for v.mut_iter().advance |x| { ... }`, if that helps
[03:56:30] <steveklabnik> and i saw you mention it here
[03:57:07] * strcat wants to kill off all the remaining ones from vec
[03:57:11] <strcat> internal iterators
[03:57:19] <strcat> and then we can have a sane for loop...
[03:57:27] <steveklabnik> Eridius: cool, thanks
[03:57:36] <steveklabnik> strcat: i'll re-read the email :)_
[03:57:37] <steveklabnik> life has been busy
[03:57:43] <steveklabnik> i missed my 'contribute to the docs' last sunday
[03:57:46] <steveklabnik> :(
[03:57:50] <steveklabnik> hopefully back to it tomorrow
[03:58:59] <Eridius> btw steveklabnik, for doing AES-128 (which you will need), you can use https://github.com/kballard/rustcrypto
[03:59:15] <Eridius> it's my fork of randombit/rustcrypto, kept up-to-date with current incoming
[03:59:19] <steveklabnik> awesome, thanks!
[03:59:28] <aatch> Eridius, you mean master
[03:59:31] <Eridius> err yes
[03:59:36] <aatch> :D
[03:59:45] <Eridius> aatch: I think I still said "latest incoming" in my latest update today :/
[03:59:58] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[04:00:07] <steveklabnik> :)
[04:01:29] <Eridius> steveklabnik: usage of rustcrypt is `use crypto::symm::{AES_128_ECB, decrypt};` and `decrypt(AES_128_ECB, key, iv, input)`
[04:01:51] <Eridius> oh, plus `extern mod crypto` to actually pull it in, and the appropriate `-L` flag for rustc
[04:02:00] <steveklabnik> word
[04:02:06] <steveklabnik> i gotta run, but thanks for the suggestion/info
[04:02:07] <Eridius> well the iv is always ~[] for ECB
[04:04:13] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[04:05:27] *** Quits: steveklabnik (steveklabn@moz-C4BA8769.public.wayport.net) (Ping timeout)
[04:15:41] *** Joins: brson (brson@72B1AFF8.AD1E507F.3688B332.IP)
[04:15:41] *** ChanServ sets mode: +o brson
[04:23:29] *** Quits: brson (brson@72B1AFF8.AD1E507F.3688B332.IP) (Ping timeout)
[04:23:33] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[04:27:47] *** Joins: brson (brson@5F06B402.AD1E507F.3688B332.IP)
[04:27:47] *** ChanServ sets mode: +o brson
[04:29:31] *** Quits: dforsyth (dforsyth@AC76BBB4.5FDB5121.EE6E63A5.IP) (Quit: leaving)
[04:34:06] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:34:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/UIvfVg
[04:34:06] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:36:05] *** Joins: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP)
[04:37:05] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:37:05] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Jn1ENQ
[04:37:05] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:37:06] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[04:37:06] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/Bzbl1w
[04:37:06] <ghrust> 13rust/06auto 146c547e4 15Daniel Micay: rm vec::uniq_len
[04:37:06] <ghrust> 13rust/06auto 14e097d5e 15Daniel Micay: rm CopyableOrderedIter...
[04:37:06] <ghrust> 13rust/06auto 1452a38b8 15Daniel Micay: fix test
[04:37:06] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[04:45:32] *** Joins: tjc (tjc@moz-B867959A.redactedconsulting.com)
[04:45:32] *** ChanServ sets mode: +o tjc
[04:52:09] *** Quits: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net) (Quit: Leaving.)
[04:54:07] *** Quits: blitter (blitter@moz-FB45689C.dyn.centurytel.net) (Ping timeout)
[05:00:09] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[05:02:53] *** Joins: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net)
[05:06:24] <strcat> rusti: 5
[05:06:24] -rusti- 5
[05:10:17] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[05:13:10] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[05:16:58] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:18:39] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[05:18:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149722e2d to 14b9119ed: 02http://git.io/N3iJvQ
[05:18:39] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[05:18:40] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:18:40] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/9q7D_w
[05:18:40] <ghrust> 13rust/06auto 14eb5ac84 15Daniel Micay: iterator: add a `find` adaptor
[05:18:40] <ghrust> 13rust/06auto 142df66a8 15Daniel Micay: iterator: add a `position` adaptor
[05:18:40] <ghrust> 13rust/06auto 1479cd2db 15Daniel Micay: iterator: work around method resolve bug
[05:18:43] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:18:46] *** Quits: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net) (Quit: Leaving.)
[05:18:46] <strcat> ugh
[05:18:49] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Quit: Leaving.)
[05:18:54] <bstrie> bors has a lot of work to do
[05:19:19] *** Quits: igl1 (igl@moz-A9F2CE1E.adsl.alicedsl.de) (Connection reset by peer)
[05:26:38] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[05:28:49] *** Joins: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net)
[05:29:37] *** Quits: jmgrosen (jmgrosen@moz-AB5DF7A0.sb.sd.cox.net) (Quit: Textual IRC Client: www.textualapp.com)
[05:30:08] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Client exited)
[05:30:17] <strcat> bstrie: yep...
[05:30:20] <strcat> :)
[05:31:52] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:32:53] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[05:34:56] <aatch> Woo, down to 119 type errors
[05:41:27] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[05:50:09] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[05:53:25] *** Joins: ysuzuki (ysuzuki@moz-285468F7.net219126120.t-com.ne.jp)
[05:54:25] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:56:13] *** Joins: rajul (quassel@A2DDF553.812B5995.2051BA92.IP)
[05:59:07] *** Joins: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net)
[06:09:24] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[06:09:24] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/9q7D_w
[06:09:24] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[06:09:57] <brson> strcat: what's the replacement for .each_mut?
[06:10:01] *** Joins: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr)
[06:10:04] <strcat> brson: .mut_iter()
[06:10:42] <strcat> rusti: let mut xs = [1, 2, 3, 4, 5]; for xs.mut_iter().take_(2).advance |x| { *x = 0 }; xs
[06:10:44] -rusti- [0, 0, 3, 4, 5]
[06:12:22] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[06:12:23] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/so_n6A
[06:12:23] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[06:12:23] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:12:23] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/HBT-oA
[06:12:24] <ghrust> 13rust/06auto 146c547e4 15Daniel Micay: rm vec::uniq_len
[06:12:24] <ghrust> 13rust/06auto 14e097d5e 15Daniel Micay: rm CopyableOrderedIter...
[06:12:24] <ghrust> 13rust/06auto 1452a38b8 15Daniel Micay: fix test
[06:12:24] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:12:35] <strcat> rusti: let mut xs = [0, ..10]; for xs.mut_iter().enumerate().advance |(i, x)| { *x = i }; xs
[06:12:36] -rusti- <anon>:9:93: 9:94 error: mismatched types: expected `int` but found `uint` (expected int but found uint)
[06:12:36] -rusti- <anon>:9     let r = {  let mut xs = [0, ..10]; for xs.mut_iter().enumerate().advance |(i, x)| { *x = i }; xs };
[06:12:36] -rusti-                                                                                                       ^
[06:12:36] -rusti- error: aborting due to previous error
[06:12:37] -rusti- application terminated with error code 101
[06:12:43] <strcat> rusti: let mut xs = [0u, ..10]; for xs.mut_iter().enumerate().advance |(i, x)| { *x = i }; xs
[06:12:44] -rusti- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[06:13:20] <dbaupp> strcat: you got one through... hopefully this one passes this time :)
[06:13:52] <brson> strcat: thanks
[06:14:09] <aatch> 19 type errors to go!
[06:14:09] <brson> strcat: why do the vec iterators need to be implemented with unsafe pointers?
[06:14:28] <dbaupp> brson: speed
[06:14:33] <strcat> brson: they could be safely implemented with slices, but it's slower because then they need to bump the ptr and reduce the length
[06:14:47] <dbaupp> aatch: so close!
[06:14:52] <strcat> instead of just bumping the ptr
[06:15:20] <brson> strcat: if we change the `for` protocol we won't need `advance`?
[06:15:24] <strcat> brson: yeah
[06:15:31] <strcat> brson: and 'break' and 'return' will *always* work
[06:15:39] <strcat> unlike right now
[06:16:02] <strcat> so basically, .each will become .iter, .each_mut will become .mut_iter
[06:16:08] <strcat> but you'll be able to compose them with adaptors
[06:16:16] <strcat> or store them partway through iteration
[06:16:17] *** Quits: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net) (Quit: Leaving.)
[06:16:20] <strcat> clone them
[06:19:44] *** Quits: tjc (tjc@moz-B867959A.redactedconsulting.com) (Quit: zzzzzzzzzz)
[06:21:22] *** Joins: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net)
[06:21:26] *** Joins: jack1 (jack@moz-F1B36F9F.hsd1.nm.comcast.net)
[06:21:26] *** Quits: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net) (Connection reset by peer)
[06:22:08] <aatch> Hurrah! No more errors!
[06:22:17] <aatch> Tons of warnings.
[06:22:21] <aatch> But no errors!
[06:22:27] <Eridius> is there any QuickCheck-like functionality for rust?
[06:22:29] <dbaupp> aatch: \o/
[06:22:38] <dbaupp> aatch: bootstrapping?
[06:22:43] <dbaupp> Eridius: not yet
[06:22:45] <aatch> Lets see what I broke in trans that can't be detected at compile time.
[06:22:57] <brson> strcat: std::iterator is fantastic
[06:23:03] <strcat> brson: :)
[06:23:32] * dbaupp proposes naming it std::strcat in honour of his work
[06:24:00] <aatch> We should have big ascii-art comment with a cat at the top.
[06:25:33] <dbaupp> utf8-art ;)
[06:26:21] <strcat> brson: we could have a for loop like python that's aware of an Iterable trait and an Iterator one, so 'for [1, 2, 3] |x| { }' could work
[06:26:31] <strcat> it just has to try Iterator first and then fall back to Iterable to get one
[06:26:41] <strcat> ofc, I have to figure out how to define Iterable sanely ;p
[06:27:16] <strcat> or 'for' could have different syntax, dunno - doesn't have to look like a closure
[06:27:54] <strcat> python's is `for pattern in iterable_or_iterator:`
[06:28:06] <aatch> strcat, I found this on my journeys: https://github.com/mozilla/rust/issues/3670
[06:28:21] <aatch> I'm wondering if it's related to the mergefunc problems.
[06:29:29] <brson> strcat: for the 0.7 release will you write something about iterators for the detailed release notes?
[06:30:39] <strcat> brson: yeah, I will :), maybe even the start of a container/iterator tutorial
[06:31:23] <brson> thanks
[06:33:02] *** Quits: jack1 (jack@moz-F1B36F9F.hsd1.nm.comcast.net) (Quit: Leaving.)
[06:34:53] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[06:35:00] <aatch> rebase this commit is not going to be fun...
[06:35:09] <aatch> or series rather
[06:35:46] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[06:35:52] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[06:40:23] *** Joins: jack (jack@moz-F1B36F9F.hsd1.nm.comcast.net)
[06:41:28] <aatch> yay! dynamic borrow errors...
[06:43:16] <aatch> Or not, just a type
[06:43:21] <aatch> typo*
[06:44:06] <aatch> memcpy != memset
[06:48:45] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[06:50:52] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[07:01:17] <aatch> Ok, so I broke... something.
[07:02:15] <aatch> strcat, looks like 7149 passes
[07:02:18] <aatch> passed*
[07:02:32] <strcat> finally! ;p
[07:02:38] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[07:03:23] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[07:03:23] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/HBT-oA
[07:03:23] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[07:06:22] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:06:23] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hrrgNQ
[07:06:23] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:06:25] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:06:25] <ghrust> 01[13rust01] 15bors pushed 8 new commits to 06auto: 02http://git.io/0sFWdg
[07:06:25] <ghrust> 13rust/06auto 144b18fff 15Huon Wilson: std: convert str::{map,levdistance,subslice_offset} to methods....
[07:06:25] <ghrust> 13rust/06auto 14f188668 15Huon Wilson: std: convert str::to_utf16 to a method.
[07:06:25] <ghrust> 13rust/06auto 1442974d3 15Huon Wilson: std: simplify the string comparison implementations, using iterators.
[07:06:28] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:08:44] *** Joins: berak (chatzilla@64C3DDF4.4742BCFA.1A5CC7E5.IP)
[07:08:58] *** Parts: berak (chatzilla@64C3DDF4.4742BCFA.1A5CC7E5.IP) ()
[07:13:40] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:13:55] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[07:15:21] *** Joins: robert (robertknig@moz-C34822AC.range86-166.btcentralplus.com)
[07:17:09] <robert> The compiler doesn't complain if I declare two fns with the same name in the same impl, though I understand that rust doesn't support overloading?
[07:17:57] <dbaupp> robert: that is/was a bug, I think it was recently patched
[07:18:25] <dbaupp> robert: yep, https://github.com/mozilla/rust/pull/7064
[07:18:59] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[07:19:32] <robert> dbaupp: Thanks. Just updated repo. Noticed that auto was force-updated.  Does bors normally do that?
[07:19:37] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[07:20:10] <dbaupp> yeah, if a test run fails, it has to force push to overwrite with the next changeset for testing
[07:20:30] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[07:20:43] <robert> dbaupp: I don't quite follow.
[07:21:10] <robert> I thought that the branch would only be updated after a successful test run
[07:21:21] *** Quits: rajul (quassel@A2DDF553.812B5995.2051BA92.IP) (Ping timeout)
[07:21:22] <dbaupp> robert: auto is the branch that the buildbot runs the tests on, and so bors takes each pull request, and merges it into auto and sends it to the testers
[07:22:14] <dbaupp> if it passes, then master gets fast-forwarded to auto; if it fails, then bors "resets" auto by force pushing the next pull request to overwrite the failed one
[07:22:40] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:22:49] <robert> dbaupp: Should I be using 'master' instead of 'auto' then?
[07:23:04] <dbaupp> yeah
[07:23:29] <robert> I think I picked auto as master was a long way behind last I looked.  Looks up to date now though
[07:23:42] *** Parts: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP) (Leaving)
[07:24:07] <dbaupp> yup, until a few days ago, there was 'incoming', which was the branch that got ff'd to auto
[07:24:41] <dbaupp> and master would only get updated when incoming passed the full test suite on all platforms (the tests for each pr are less comprehensive)
[07:25:10] <dbaupp> but, incoming was deleted and development happens on master now.
[07:25:19] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:25:41] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[07:35:41] <Luqman> robert: that's been fixed!
[07:35:49] <Luqman> oh dbaupp mentioned that already :P
[07:36:40] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:37:24] <Eridius> dbaupp: if master was supposed to get updated regularly, why did it stay still for almost a month?
[07:38:09] <dbaupp> Eridius: because incoming was never fully green (and master still isn't)
[07:38:43] *** Joins: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP)
[07:39:18] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[07:39:30] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[07:39:46] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:41:08] <Eridius> dbaupp: :/
[07:41:36] *** Quits: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr) (Quit: pyrac)
[07:42:22] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[07:42:48] *** Joins: snearch (snearch@moz-839145EB.pool.mediaways.net)
[07:45:15] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[07:52:17] *** Joins: koomi (koomi@moz-9AE5526E.pools.arcor-ip.net)
[07:53:16] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[07:54:59] <strcat> rusti: 5
[07:55:04] -rusti- 5
[07:55:06] <strcat> rusti: 5
[07:55:08] -rusti- 5
[07:55:11] <Eridius> o_O
[07:55:36] <bjz> O_o
[07:56:06] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Ping timeout)
[07:57:18] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[07:57:18] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/0sFWdg
[07:57:18] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[07:57:27] <strcat> rusti: 5
[07:57:28] -rusti- error opening /dev/urandom: Operation not permittedAborted
[07:57:28] -rusti- application terminated with error code 134
[07:58:10] *** Quits: jaen (jaen@moz-4F5EDCFB.play-internet.pl) (Ping timeout)
[07:58:31] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[07:58:34] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:58:47] <strcat> heh rustc is missing an \n there
[07:58:48] <strcat> rusti: 2
[07:58:49] -rusti- error opening /dev/urandom: Operation not permittedAborted
[07:58:49] -rusti- application terminated with error code 134
[07:59:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[07:59:31] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:59:33] <strcat> rusti: 2
[07:59:34] -rusti- 2
[08:00:19] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[08:00:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hdTaxQ
[08:00:19] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[08:00:20] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[08:00:20] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/w8p71g
[08:00:20] <ghrust> 13rust/06auto 14ac83f4b 15Erick Tryzelaar: std: add a fixme to note performance issues in vec::from_elem.
[08:00:20] <ghrust> 13rust/06auto 14d1927d2 15bors: auto merge of #7137 : erickt/rust/from-elem-fixme, r=thestinger...
[08:00:20] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[08:03:05] <strcat> C makes error handling "fun" ;p
[08:03:10] <strcat> https://github.com/thestinger/playpen/blob/master/playpen.cc#L77 yay
[08:04:10] <strcat> there's a race between spawning the process and starting epoll though ;[
[08:08:23] <strcat> hrm
[08:08:27] * strcat doesn't understand the race
[08:09:16] <aatch> I broke the compiler... :(
[08:09:26] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[08:10:04] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[08:10:52] <strcat> aha
[08:10:55] <strcat> that's what I'm doing wrong
[08:10:57] <strcat> I'm silly
[08:11:38] <strcat> not a race...
[08:13:53] <aatch> wrong order?
[08:14:24] <strcat> was running atexit(kill_group) before cloning
[08:14:52] <strcat> so the child was erroneously running that atexit hook
[08:14:56] <strcat> if it exited before exec
[08:16:38] <Eridius> since we keep moving more things to methods, we really should update rustdoc to put trait methods in the index (not impls though, screw those things)
[08:16:56] <Eridius> (although having a link to the trait definition on an impl would be nice, if it's possible)
[08:18:08] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[08:18:13] <dbaupp> strcat: https://github.com/mozilla/rust/pull/7177 r?
[08:18:20] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Connection reset by peer)
[08:18:47] <strcat> dbaupp: huh, is that a compiler bug?
[08:18:54] <Eridius> dbaupp: would be nice to fix the compiler's bug
[08:18:59] <dbaupp> strcat: a combination
[08:19:18] <strcat> anyway, going to bed \o
[08:19:19] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[08:19:50] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: WeeChat 0.4.1)
[08:19:51] <Eridius> hmm, strcat r+'d #7160 7 hours ago. When is bors going to notice?
[08:20:17] <Blei> Eridius: it has noticed: http://buildbot.rust-lang.org/bors/bors.html
[08:20:17] <dbaupp> Eridius: after 5 other pr's go through, http://buildbot.rust-lang.org/bors/bors.html
[08:20:25] <Eridius> ahh
[08:20:47] <Eridius> what is bors written in?
[08:21:06] <aatch> Also, older prs get priority.
[08:21:52] *** Quits: robert (robertknig@moz-C34822AC.range86-166.btcentralplus.com) (Ping timeout)
[08:21:58] <Eridius> yeah understandable, I was just surprised bors hadn't commented that it saw approval. I figured it did that when it put the PR into its queue to be processed
[08:22:01] <Eridius> but I guess not
[08:22:36] <Blei> yikes, 10 line program, 1600 line llvm assembly
[08:22:58] <aatch> Blei, tell me about it.
[08:23:08] <aatch> (actually don't)
[08:23:42] <Ralith> to be fair, output code growth is a natural effect of genericness
[08:24:28] <aatch> Ralith, true, but I managed to shrink a function by over 90% by removing many of the allocations.
[08:24:41] <aatch> rustc isn't so good at producing llvm IR atm.
[08:25:06] <Blei> aatch: in the compiler or manually?
[08:25:13] <Ralith> aatch: yes, there's that too.
[08:25:22] <Ralith> but one shouldn't object to large output on principle.
[08:25:24] *** Quits: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[08:25:27] *** Joins: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[08:25:40] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[08:25:41] <Ralith> since in principle it can be the case that the output is not growing, but rather the input is shrinking.
[08:25:43] <aatch> Blei, what do you mean? I made the changes as part of a refactoring.
[08:25:50] <Blei> ah, great!
[08:26:27] <aatch> Blei, you know Graydon's stats about the function sizes?
[08:26:40] <Blei> i've read the mail, yeah
[08:26:53] <Blei> btw. do you know how he produced these stats? or the svg?
[08:27:11] <aatch> Well, one of them, trans_crate, is the one I fixed, size-wise.
[08:27:21] <aatch> he might be using some LLVM tools.
[08:27:39] <aatch> I know that opt can output a CFG as a dot file.
[08:28:02] <aatch> ~100000 -> ~6000 (don't know the units)
[08:28:06] <Blei> great, thanks
[08:28:17] <Blei> wow, that's quite the improvement
[08:28:42] <Blei> is it only a compile time speed up or is the resulting code better as well?
[08:28:51] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[08:29:14] <aatch> Blei, that function is only called once, so not a noticeable improvement.
[08:29:21] <aatch> unfortunately.
[08:30:20] <Blei> sure, but i assume your changes also affect other functions
[08:31:41] <aatch> Blei, it wasn't an code-gen fix.
[08:32:19] <aatch> I refactored the function and removed the code that caused the problem.
[08:33:09] <Blei> ah, ok.
[08:33:40] <Blei> btw. two more functions you can remove
[08:34:02] <Blei> do_spill_noroot, spill_if_immediate
[08:34:17] <aatch> Blei, hmm, may already have.
[08:34:35] <Blei> even better :)
[08:35:41] <aatch> At any rate I'm currently trying to figure where I introduced an error.
[08:36:25] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: Don't tell them I was here...)
[08:38:04] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Connection reset by peer)
[08:39:22] <Eridius> crap. latest rustc hits an ICE in previously-working code
[08:41:13] <Eridius> aww dammit it's the old "didn't recompile dependent crates" issue. Looks like my Makefile's clean target isn't cleaning one of my dependencies
[08:42:18] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[08:43:09] <Blei> heh, dot segfaulted
[08:43:09] <doener> aatch: the sizes was in bytes
[08:43:15] <doener> s/was/are/
[08:45:46] <aatch> doener, ah, thought so.
[08:46:55] <aatch> doener, in other news, glue emission strikes again!
[08:47:07] <doener> from "objdump -t librustc...so | grep trans_crate"
[08:47:10] <doener> hm?
[08:47:36] <aatch> I get an LLVM error after my refactoring of LLVM types in trans
[08:48:06] <aatch> conflicting types for the struct vs the initializer
[08:48:25] <aatch> in, of course, emit_tydescs
[08:48:45] <doener> let me know if you want me to have a look
[08:48:54] <aatch> Welp, looks like I fixed it.
[08:49:26] <doener> heh
[08:49:39] <aatch> I was adding an extra indirection that I didn't need.
[08:50:06] <aatch> for the glue fn, so I was getting "glue_fn**" instead of "glue_fn*"
[08:50:40] <doener> I did the a similar thing yesterday, all those "we get the value by ref" comments made me add an extra T_ptr, "just to make sure" :-)
[08:51:20] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:51:20] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/w8p71g
[08:51:20] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:52:02] <aatch> I am now very familiar with how terribly some^B^B^B^B most of trans is.
[08:53:40] <doener> how terrible most of trans _was_. Because... you fixed that, right?
[08:53:58] <aatch> doener, some of it.
[08:54:06] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[08:54:15] <aatch> This stage is mostly just making the code itself nicer.
[08:54:19] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:54:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/xIfMTg
[08:54:19] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:54:21] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:54:21] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/pkYacg
[08:54:21] <ghrust> 13rust/06auto 1407f5ab1 15Alex Crichton: Implement a deriving(Zero) attribute
[08:54:21] <ghrust> 13rust/06auto 14893c70d 15Alex Crichton: Add Zero impls for lots of common types
[08:54:21] <ghrust> 13rust/06auto 1408c1155 15bors: auto merge of #7142 : alexcrichton/rust/deriving-zero, r=pcwalton...
[08:54:23] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:54:24] <aatch> rather than making it functionally better.
[08:54:59] <aatch> So having a wrapper type for TypeRefs, implementing a lot of functions as methods on that type
[08:55:20] <aatch> putting all of that in it's own type_ module
[08:56:15] <doener> sounds good
[08:56:19] <aatch> Although I have gotten rid of a few dead paths, of the "will always be false, but LLVM doesn't know that" variety
[08:56:37] <aatch> but that just gets rid of a few compares+branches
[08:56:47] <aatch> so hardly a world-changing optmizations.
[08:57:08] <aatch> I am curious to see if I can fix this casting issue with tydescs though.
[08:57:26] <doener> which one is that?
[08:57:36] <aatch> Or glue fns, or whatever
[08:57:43] <aatch> the one that prevents the glue from being inlined.
[08:57:56] <doener> I fixed that
[08:58:13] <aatch> doener, you did? Is it in master?
[08:58:16] <doener> yes
[08:58:21] <aatch> Ah, cool.
[08:58:22] <doener> https://github.com/mozilla/rust/pull/7154
[08:58:26] <aatch> NEVERMIND THEN.
[08:58:45] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[08:59:13] * aatch makes sure he didn't accidentally undo those changes
[08:59:48] *** Joins: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr)
[08:59:54] <aatch> I did not.
[09:00:52] <Blei> aatch: while you're rewriting all of trans, you could remove addrspaces :3
[09:00:59] <cmr> heh
[09:01:00] <aatch> Blei, I have.
[09:01:10] <Blei> great!
[09:01:10] <aatch> at least most of it.
[09:01:23] <aatch> there might be some vestiges, but nothing proper.
[09:01:24] <Blei> all those addrspaces make the ubiquitous cast even harder to read
[09:01:40] <Blei> push it already XD
[09:01:49] <aatch> Blei, I'm close.
[09:02:18] <doener> aatch: you might want to let graydon know about that https://github.com/mozilla/rust/issues/7063
[09:02:20] <aatch> cmr, any reason why the glue fns have nil as a return type instead of void?
[09:02:50] <aatch> doener, rather
[09:04:06] <Blei> i wondered the same
[09:04:32] <doener> especially since they're casted to void in the emitted tydesc constants
[09:04:56] *** Quits: brson (brson@5F06B402.AD1E507F.3688B332.IP) (Ping timeout)
[09:10:41] *** Joins: brson (brson@5F06B402.AD1E507F.3688B332.IP)
[09:10:41] *** ChanServ sets mode: +o brson
[09:11:18] <aatch> huh. According the code, it shouldn't be trying to return a nil
[09:11:25] <aatch> since nil is immediate.
[09:13:30] <doener> hm?
[09:14:07] <aatch> Oh crap. it tries to return nil, /because/ nil is immediate.
[09:16:07] <doener> reminds me that I should try to finish my "kill nil" branch 
[09:20:25] <aatch> Well I'm hoping that I'm intepreting the way glue is built correctly and skipping to regular function finalizer to make it ret void instead of ret {}
[09:22:15] <aatch> I'm curious to see if that will allow it to optimize better than before.
[09:23:40] <Blei> argh, ~50% of all the llvm instructions are bitcasts
[09:23:48] <Blei> this is horrible to read
[09:23:59] <doener> aatch: oh, now that you mention it, it might actually make things worse
[09:24:09] <aatch> doener, really? why?
[09:24:58] <doener> aatch: when I tried to strip the allocas for nil return values (there aren't that many nil values after all) and had it return "ret {} nullinitialiser" directly, that broke tailcall optimization
[09:25:46] <aatch> doener, ah, but this is ret void, in the glue fn
[09:27:13] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[09:27:24] <doener> aatch: the glue returns nil, and when the function returns nil, a final glue call might get transformed into a jump. If the glue returns void, that breaks
[09:27:39] <doener> s/the function/another function/
[09:33:27] <aatch> doener, yeah, but should glue /always/ be inlined?
[09:33:56] <aatch> s/should/shouldn't/
[09:34:43] <doener> only some of it
[09:34:58] <doener> see set_glue_inlining
[09:35:29] <aatch> doener, where?
[09:35:42] <doener> in ty.rs
[09:35:42] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:35:52] <aatch> I found it in base.rs
[09:36:01] <doener> only glue for non-structural types is inlined
[09:36:17] <doener> err, right, I was already looking at type_is_structural
[09:37:42] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[09:43:09] <aatch> doener, hmm, looks like a lot of cases it just completely optimizes out the glue fns now
[09:43:35] <doener> yep, that's why the inlining was so important
[09:44:07] <doener> e.g. "let x = ~5; let y = x;" used to generate two calls to drop_glue. Now it's just one call to global_free
[09:45:17] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[09:45:17] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/pkYacg
[09:45:17] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[09:45:29] <aatch> hurrah, it looks like some of my other, minor, changes are paying off too.
[09:46:14] <aatch> mostly related to the names in LLVM IR
[09:46:43] <doener> yay!
[09:46:47] <aatch> like now a local struct, without any type params, is just `%struct.Foo`
[09:46:58] <aatch> makes it way easier to read stuff.
[09:48:19] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:48:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/JgLOtw
[09:48:19] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:48:19] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[09:48:19] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/SyUrqg
[09:48:19] <ghrust> 13rust/06auto 143f69e20 15Philipp BrÃ¼schweiler: trans::glue: don't allocate a pointer variable if it already exists...
[09:48:19] <ghrust> 13rust/06auto 14d0f88cd 15bors: auto merge of #7155 : Blei/rust/drop-glue-alloca, r=graydon...
[09:48:19] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[09:48:41] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[09:48:55] <aatch> I'm also trying to make more of the fixed types named, so I get to see `%str_slice` in the IR instead of {i8*, i64}
[09:49:00] <aatch> which is stupidly common.
[09:51:05] *** Quits: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP) (Client exited)
[09:51:10] *** Joins: spider-mario (spidermari@moz-B8FA2FF4.rev.sfr.net)
[09:53:59] <doener> aatch: I wonder if the addrspace removal allows llvm to finally remove that stupid "cmp" from vec::with_capacity...
[09:54:17] <cmr> what were addrspaces?
[09:54:20] <aatch> doener, example code? I'm testing stuff atm anyway.
[09:54:44] <aatch> cmr, infrastructure for garbage collection provided by LLVM
[09:55:02] <cmr> ah
[09:55:07] <aatch> but we aren't using LLVM's GC hooks, because they aren't very good.
[09:55:23] <cmr> yeah, I was going to say, LLVM doesn't seem to be in a very good position in the stack to be doing GC
[09:55:27] <aatch> but we still have/had addrspace code everywhere.
[09:56:00] *** Quits: brson (brson@5F06B402.AD1E507F.3688B332.IP) (Ping timeout)
[09:56:09] <aatch> if you look at the LLVM IR, you'll see a lot of stuff like `i8 addrspace(0)*`
[09:56:14] <aatch> Or something.
[09:56:23] *** Joins: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP)
[09:56:52] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Client exited)
[09:56:54] <Ralith> I have some proposals bouncing around my head for fixing LLVM's GC infrastructure
[09:56:57] <Ralith> I wish I had the time to work on them
[09:57:33] <doener> aatch: https://gist.github.com/dotdash/5791572 -- notived how it writes 32 to 40(%rax) and then goes to compare it against 799
[09:57:40] <doener> s/notived/notice/
[09:57:52] <Ralith> also, address spaces are not infrastructure for gc provided by LLVM; LLVM does not in and of itself associate them with GC in any way
[09:58:45] <kimundi> hm, this is troubling. runnng 'make check' I got a segfault on compiling stage1 rust tool. Directly trying it again didn't segfault though.
[09:59:14] <Blei> kimundi: was it a stack canary?
[09:59:15] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[09:59:23] <aatch> doener, it does not change it.
[09:59:34] <doener> currently I usually need to run "make check" at least three times before it finishes without killing birds
[09:59:48] <kimundi> Blei: No idea, it literally says make: *** [x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/bin/rust] Segmentation fault
[09:59:59] <dbaupp> doener: what platform?
[10:00:10] <doener> linux x86_64
[10:00:15] <aatch> except for me it does the cmp against 511
[10:00:21] <Blei> me too (linux x86_64)
[10:00:43] <doener> aatch: that looks... wrong
[10:00:49] <dbaupp> doener: hm, strange. same, but I only kill birdies occasionally. (like once every 5 make checks)
[10:01:10] <cmr> I hope the trans refactoring cleans up this mess... looks to me like subtly bad code is being generated
[10:01:15] <doener> dbaupp: for the glue inlining fix, it took me almost a dozen runs to get it through
[10:01:17] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[10:01:18] <cmr> (bad code as in native, not IR)
[10:01:19] <aatch> doener, ah, nvm I know why.
[10:01:44] <dbaupp> doener: o_O
[10:02:02] <doener> dbaupp: how many cores?
[10:02:16] <dbaupp> doener: 2 real, 4 hyperthreaded
[10:02:22] <doener> 4 real, 8 HT here
[10:02:33] <doener> guess that makes it easier to trigger?
[10:02:45] <dbaupp> that seems reasonable
[10:02:49] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[10:02:58] *** Joins: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net)
[10:03:17] <dbaupp> do they trigger if you run with RUST_THREAD=1 or something small?
[10:03:27] <aatch> doener, in the IR for that code, theres an `icmp ult i64 %11 800`
[10:03:52] <doener> dbaupp: env var or make var?
[10:03:53] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[10:04:23] <cmr> (it's RUST_THREADS isn't it?)
[10:04:24] <dbaupp> doener: either, I think (I always do `RUST_THREAD=1 make ...`, it might work the other way though.)
[10:04:36] <dbaupp> cmr: quite possibly
[10:05:01] <dbaupp> cmr: yup, it is
[10:05:35] <doener> oh, with a single thread it's also colored, nice
[10:06:14] *** Joins: heftig_ (heftig@moz-423FF5CE.dip0.t-ipconnect.de)
[10:07:11] *** Quits: heftig (heftig@moz-10C851D0.dip0.t-ipconnect.de) (Ping timeout)
[10:07:41] <doener> aatch: is there something special about that isn? I'm not terribly familiar with the IR
[10:08:05] <aatch> doener, I think I know where it comes from.
[10:08:22] *** Quits: orshem (orshem@4A7BDF54.6CC9726A.E3D28531.IP) (Quit: Leaving)
[10:08:27] <doener> from the check in vec::reserve, I just wonder why it doesn't get optimized away
[10:08:30] <aatch> I'm just saying that the check against 799, is actually a check against 800.
[10:08:52] <doener> ah
[10:09:11] <doener> yeah, it's the required allocation size in bytes
[10:11:17] <aatch> heh, I forgot to add in the function finalizing calls for my atomic stuff and the blocks don't get linked together.
[10:12:38] <aatch> Basic Block in function '_ZN8unstable10intrinsics17atomic_xsub_1671016_9de8d5589592d696_07preE' does not have terminator!
[10:12:44] <aatch> Thank you LLVM verifier
[10:13:42] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[10:14:28] <doener> dbaupp: got a dead canary with a single threaded run as well
[10:17:16] <dbaupp> doener: oh :(
[10:17:34] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[10:19:48] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[10:20:54] *** Joins: nano (nano@moz-972880B.superkabel.de)
[10:22:48] <aatch> This seems like a good sign, after my refactoring, I now get a ton of unused import and unused unsafe warnings.
[10:24:50] *** Joins: ___ (Mibbit@moz-E667CCDF.neoplus.adsl.tpnet.pl)
[10:24:51] *** Quits: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[10:25:21] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[10:25:42] *** Joins: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[10:25:47] <dbaupp> aatch: so it's bootstrapping?
[10:26:48] <aatch> dbaupp, yep.
[10:26:56] <dbaupp> awesome!
[10:27:28] <aatch> Well, I assume it does, I got most of the way before hitting an unrelated issue.
[10:28:32] <aatch> In general, if stage0 produces a working compiler, it works.
[10:31:16] *** Joins: mleise (marco@moz-3468AB5B.pools.arcor-ip.net)
[10:31:33] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[10:32:21] * aatch I am actually checking.
[10:32:28] * aatch fails at IRC
[10:34:44] *** Quits: ruediger (quassel@moz-C9B8D8D0.org) (Ping timeout)
[10:34:50] *** Joins: ruediger (quassel@moz-C9B8D8D0.org)
[10:38:07] <aatch> dbaupp, man there have been a lot of PRs go through today, looking at isrustfastyet
[10:38:08] <cmr> dbaupp: I'm going to spend some time this week setting up some benchmarking infrastructure. What data would be useful for proper graphing on isrustfastyet? I'm thinking compilation time, execution time, memory usage, commit SHA.
[10:38:28] <cmr> aatch: I think you mean there haven't been a lot of PRs going through the past week or two ;)
[10:38:40] <dbaupp> aatch: there's gonna be a whole lot more too
[10:38:54] <dbaupp> cmr: yeah
[10:39:24] <dbaupp> cmr: um
[10:39:54] <doener> yay, got handling for the shrinking of the landing pad, too :-)
[10:40:08] <dbaupp> cmr: it'd be neat to get the time/mem for each crate
[10:40:09] <cmr> Ohh, binary size.
[10:40:29] <aatch> Snapshot Compiler: trans:19.27s, LLVM Passes: 350s; Stage1: trans: 15.88s LLVM Passes: 296s <- compiling rustc
[10:40:30] <cmr> dbaupp: Sure. Want me to get the pass timing too?
[10:40:38] <aatch> We need a new snapshot...
[10:40:57] <dbaupp> cmr: heh, might as well `-Z time-passes -Z time-llvm-passes` I guess
[10:41:24] <dbaupp> aatch: make master greener! ;D
[10:41:37] <aatch> dbaupp, I tried.
[10:41:54] <Blei> argh, were are the llvm.lifetime.start instructions generated? am i blind?
[10:42:03] <doener> Blei: the inliner does that
[10:42:05] <aatch> Blei, they are generated by the inliner
[10:42:18] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[10:42:18] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SyUrqg
[10:42:18] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[10:42:24] <cmr> i686-unknown-linux-gnu/stage0/bin/rustc: error while loading shared libraries: libstd-6c65cf4b443341b1-0.7-pre.so: cannot open shared object file: No such file or directory
[10:42:27] <cmr> that's just weird
[10:42:32] <Blei> doener,  aatch: thanks
[10:42:35] <cmr> are the buildbots fried?
[10:42:40] <doener> Blei: if you want to look at the code without any inlining, use --passes ""
[10:43:01] <cmr> doener: how is that different than -Z no-opt ?
[10:43:21] <aatch> I really need to add some equivalent -Og, or make -Z no-opt actually do no optimizations
[10:43:41] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:43:44] <Blei> doener: thanks, i'll try that
[10:43:46] <aatch> currently -Z no-opt merely overrides any -O or --opt-level options
[10:43:55] <cmr> oh :\
[10:44:18] <Blei> this is so much more readable :D
[10:44:20] <doener> the "always inline" inliner is always active
[10:44:48] <doener> Blei: yep. Good thing that aatch made the passes configurable
[10:44:59] <dbaupp> cmr: I think the removal of absolute rpaths broke cross-compiling
[10:45:14] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[10:45:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/fdOhHA
[10:45:14] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[10:45:14] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[10:45:14] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/7RKF3g
[10:45:14] <ghrust> 13rust/06auto 14d22f417 15gareth: Add IterBytes impls for float/f32/f64. This allows creating...
[10:45:14] <ghrust> 13rust/06auto 14d1a2360 15bors: auto merge of #7156 : Dretch/rust/float-hash, r=graydon...
[10:45:14] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[10:45:19] <dbaupp> cmr: and i686 is cross compiled
[10:45:25] <aatch> I'm thinking of making "no optimizations" actually do a jump-threading and instcombine pass
[10:45:35] <aatch> after the always-inline
[10:47:05] <aatch> if only so some of the most dumbass optimizations are done all the time.
[10:48:40] <aatch> but I'd also make -Z no-opt only run the verifier.
[10:50:39] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Quit: Leaving)
[10:54:12] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[10:58:21] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[10:58:23] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[10:59:33] <doener> sweet, the landing pad fixes shave off almost 500k now
[10:59:49] <aatch> doener, nice
[11:00:19] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[11:01:25] *** Joins: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP)
[11:01:52] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[11:03:17] *** Quits: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP) (Ping timeout)
[11:04:40] *** Joins: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de)
[11:05:56] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[11:05:56] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[11:07:19] <aatch> Wow, there are a lot functions that used to have the entire body wrapped in an unsafe block, that don't need it at all.
[11:07:43] <cmr> aatch: What did you change that revealed all this unnecessary unsafe?
[11:08:24] <aatch> cmr, I did not reveal anything, my changes move a lot of the unsafe code to wrapper methods
[11:08:29] <cmr> ah
[11:11:09] *** Joins: jaen (jaen@moz-8F4F68E6.play-internet.pl)
[11:11:16] *** Quits: jaen (jaen@moz-8F4F68E6.play-internet.pl) (Quit: jaen)
[11:14:34] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Quit: Leaving)
[11:16:27] <kimundi> aatch: Just make sure you don't remove unsafe function declarations in place where it's not technically needed but the function still causes unsafe effects
[11:16:52] <MaikKlein> if I have forked a repo on github and the original repo has updated, how can I update my forked repo?
[11:16:57] <aatch> kimundi, I didn't remove any unsafe declarations.
[11:17:09] <aatch> MaikKlein, pull from upstream, then push to your fork.
[11:17:21] <kimundi> aatch: Ah, nevermind then :)
[11:17:39] <cmr> MaikKlein: You need to add a remote with the original repo (git remote add upstream https://github.com/user/repo.git), and 'git pull upstream branchname'
[11:17:42] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[11:17:48] <aatch> I made safe wrappers for things, mostly LLVM functions.
[11:19:02] *** Quits: jga (asdf@114D2B3A.FB5B5D5.B5524284.IP) (Client exited)
[11:19:19] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:19:21] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[11:20:20] <cmr> A ToStr deriving for enums would be useful. It'd just match var { varname => "varname", ... }
[11:20:44] <aatch> heh, current state of my trans-refactor branch relative to master: "39 changed files with 2,219 additions and 2,872 deletions"
[11:21:13] <doener> I have a whopping  2 files changed, 44 insertions(+), 21 deletions(-)
[11:22:04] <aatch> For perspective, there are 37 files in the trans module.
[11:22:06] <bjz_> aatch: always nice when deletions > additions
[11:22:17] <bjz_> aatch: what are you working on?
[11:22:18] <Jesse> kimundi: what's an example of something where you'd want a function to be marked unsafe but the compiler won't make you? (and does it warn about unnecessarily-unsafe functions, or only unnecessary unsafe blocks?)
[11:22:38] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[11:22:44] <aatch> bjz_, I just finished refactoring the way we handle LLVM types in the compiler.
[11:23:37] <aatch> So there is now an `Type` struct, that has static methods for constructing types, and methods for manipulating types themselves.
[11:23:45] <aatch> makes for much easier reading.
[11:23:47] <bjz_> aatch: nice!
[11:23:59] <kimundi> Jesse: Example are functions in std::str::raw. Those are all unsafe as they allow to invalidate the 'str contains utf8' invariant, but not all of them actually use unsafe code in their bodies
[11:24:00] <aatch> It also puts it all in it's own module, type_
[11:24:03] <MaikKlein> thanks @ all
[11:24:30] <bjz_> aatch: will that help with making it easier to add associated items?
[11:24:37] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[11:25:21] <Jesse> kimundi: hmm, i wonder if that str invariant should be pushed lower, so the compiler knows not to let you mess with str unsafely
[11:25:30] <kimundi> Jesse: When unneeded unsafe warnings got implemented, the person making that pull request just removed unsafe everywhere where it didn't need to be, but that also included places like in str::raw where it _should_ be
[11:25:49] <Jesse> kimundi: do we rely on that str invariant for safety, btw?
[11:25:49] <dbaupp> cmr: #[deriving(ToStr)] works
[11:25:54] <Jesse> *memory safety
[11:26:01] <cmr> dbaupp: It already exists?
[11:26:04] <dbaupp> cmr: at least, it should. it's the same as fmt!("%?", x)
[11:26:15] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Client exited)
[11:26:28] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:26:31] <cmr> dbaupp: Well preferably it'd avoid most of the magic reflection
[11:26:34] <aatch> bjz, no idea.
[11:26:35] <kimundi> Jesse: well, indirectly yes.
[11:26:59] <dbaupp> cmr: well, i don't see how it would work without it
[11:27:23] <kimundi> Jesse: having non-utf8 in a str the claims to contain utf8 can break random code that expects it to contain utf8, wich might result in memory unsafety :P
[11:27:27] <dbaupp> cmr: (and using the built-in reflection is *much* easier than doing it by hand.)
[11:27:38] <cmr> dbaupp: all it has to do is match on the variant.
[11:28:11] <aatch> bjz, the idea is that instead of lines like `T_ptr(T_ptr(T_int_ty(cx, ty)))`, you get `Type::int_from_ty(cx, ty).ptr_to().ptr_to()`
[11:28:16] <Jesse> kimundi: can code outside the str module cause str to become non-utf8, without calling any 'raw' or unsafe functions from the str module?
[11:28:26] <dbaupp> cmr: '#[deriving(ToStr)] enum A<T> { Foo(int, float), Bar { x: T, y: T} }' ?
[11:28:38] <cmr> dbaupp: Oh, right... forgot about those guys
[11:28:40] <kimundi> Jesse: NO, only by calling unsafe functions like transmute
[11:28:42] <bjz> aatch: ooh, much better
[11:28:55] <bjz> aatch: much more ideomatic
[11:29:12] <dbaupp> cmr: speaking of which... #[deriving(ToStr)] probably does the wrong thing for type parameters :/
[11:29:12] <aatch> bjz, Yeah, the idea is to try and make trans a bit more like actual rust code.
[11:29:13] * dbaupp checks
[11:29:19] <kimundi> Jesse: (Of course there can be bugs somewhere)
[11:29:31] <Jesse> kimundi: so how is the str module able to do it without the functions/blocks being marked unsafe?
[11:29:37] <bjz> aatch: there's so much to modernise :/
[11:29:57] <aatch> Since I feel that part of the problem is that because it's so hard to follow people don't mess with it much,
[11:30:13] <kimundi> Jesse: I don't know wich functions it where exactly, but it was definitly the case
[11:30:15] <aatch> so it never gets updated, so it gets more and more out of date style-wise
[11:30:31] <aatch> and therefore gets harder to follow.
[11:30:39] * kimundi tries to dig them out
[11:31:16] *** Joins: dherman (dherman@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[11:31:16] *** ChanServ sets mode: +o dherman
[11:31:59] <cmr> dbaupp: https://github.com/mozilla/rust/issues/7179
[11:32:03] <cmr> dbaupp: better now? ;)
[11:32:08] <dbaupp> Jesse: it can actually, `s.push_char((-1) as char);` but that's mainly a bug
[11:32:18] <bjz> aatch: indeed, and it'd be hard to make improvements
[11:32:47] <dbaupp> cmr: maybe the magic reflection should be/is optimised for C style enums?
[11:33:41] <cmr> dbaupp: it isn't now, I suppose it could be.
[11:33:46] <cmr> I don't really know hot it works
[11:34:11] <aatch> nobody does.
[11:34:12] <dbaupp> cmr: neither
[11:35:06] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Quit: WeeChat 0.4.2-dev)
[11:35:11] <cmr> How is it even possible to have reflection? Does using it add extra type headers to everything?
[11:35:35] <aatch> There is lazily emitted type information added.
[11:35:48] <aatch> but it's known at compile time what the types are.
[11:35:56] <aatch> do no type headers
[11:36:04] <aatch> s/do/so
[11:36:09] *** Quits: Voomer (Voomer@moz-E97E8EB7.br.br.cox.net) (Ping timeout)
[11:36:37] <kimundi> Urg I'm getting random compile-fail failure with 'failed with wrong exit code
[11:37:00] <kimundi> I'm on my ~ 6 attempt to clear that stage
[11:37:01] <dbaupp> cmr: also, https://github.com/mozilla/rust/issues/7180
[11:38:04] <dbaupp> kimundi: it's probably crashing (killing stack canaries, I guess)
[11:39:12] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[11:39:13] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/7RKF3g
[11:39:13] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[11:39:32] <Blei> argh, that double free isn't actually a double free but a heap corruption(?)
[11:39:55] <aatch> Blei, ??
[11:40:03] <Blei> https://github.com/mozilla/rust/issues/4355
[11:40:23] <Blei> i've been trying to debug what happens here
[11:41:14] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[11:42:16] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[11:42:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/7RCy0A
[11:42:16] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[11:42:17] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[11:42:17] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/AdbKwg
[11:42:17] <ghrust> 13rust/06auto 144ee99a1 15Philipp BrÃ¼schweiler: trans::glue: don't generate struct destructors in the free glue...
[11:42:17] <ghrust> 13rust/06auto 1403dff61 15bors: auto merge of #7159 : Blei/rust/free-glue-no-destructor, r=graydon...
[11:42:17] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[11:43:57] *** Quits: dherman (dherman@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Quit: dherman)
[11:45:07] *** Quits: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr) (Quit: pyrac)
[11:45:38] <kimundi> Jesse: I can't find a str::raw function where it is the case today, but I think it might have also been the case that the problem was that an unsafe function had an unsafe block in their body. ANd rather than reoving the block, the function annotation has been reoved, allowing to safely invalidate a str
[11:47:25] <kimundi> Jesse: But the problem can still happen elsewhere, so that's something to  be careful about.
[11:51:35] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[11:54:05] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Quit: Leaving)
[11:54:57] *** Joins: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr)
[11:57:06] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[12:02:25] <doener> Blei: the optimized IR definitely looks like a double free
[12:02:51] <Blei> yeah, it does...
[12:03:29] *** Quits: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[12:03:49] <Blei> no, i'm sure it's a double free
[12:07:05] *** Joins: nano (nano@moz-972880B.superkabel.de)
[12:08:15] <cmr> MaikKlein: How's the autocompletion stuff going?
[12:10:41] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: back later)
[12:17:04] *** Joins: Sorella (queen@B12A78F5.BA14766C.95C8B7C6.IP)
[12:18:11] *** Joins: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au)
[12:18:26] <Aetherspawn> can someone explain to me how tasks pool
[12:18:36] <Aetherspawn> is it like a big threadpool, and do they yield on IO actions, or is it possible to run out of task workers if they are all blocking and tasks pile up
[12:21:52] <doener> Blei: looks like the cleanup isn't correctly revoked
[12:22:01] <aatch> bwuh? https://github.com/mozilla/rust/issues/7181
[12:22:27] <doener> *lol*
[12:23:51] <cmr> Aetherspawn: afaik, right now, by default, rust uses n threads where n is the cpu count. tasks can yield explicitly, io and channel communications also yield.
[12:23:53] <aatch> "Hmm, vim doesn't seem to be working, better open an issue on PHP"
[12:24:04] <Blei> doener: actually, should this even matter? after all, there's the null-check in free
[12:24:16] <Blei> and if i read bar() correctly, the pointer is set to null there
[12:24:46] <cmr> Aetherspawn: but there's a new scheduler in the works and you can control how it (and the old one) work somehow, I don't know the details, you'll probably have to wait until brson gets on. Or ask on the ML :)
[12:25:21] <Aetherspawn> cmr, so when using something lke tcp read() I don't lose a task worker?
[12:25:32] <kimundi> Aetherspawn, and you will have the option to explicitly spawn tasks on a new thread, so you can decide how many tasks you want to run on how many threads.
[12:25:47] <cmr> Aetherspawn: you might right now due to poor implementation but if you do it's a bug
[12:26:39] <Aetherspawn> would yielding be done explicitly in the std lib in the rust code?
[12:26:55] <Aetherspawn> I actually went into the io.rs file in stdlib and ctrl+f'd yield and found nothing :(
[12:27:15] <cmr> I think the "real" io stuff is in rt/io, not sure...
[12:27:58] <dbaupp> cmr: not yet, the real stuff is still in libstd::io
[12:28:13] <kimundi> Aetherspawn: In the future you will use an task-blocking api io, but implemented asynchronly so that other tasks, even on the same thread, can continue to run.
[12:28:26] <dbaupp> (and possibly some in the C++ runtime in src/rt)
[12:29:04] <aatch> Episode 2: LLVM strikes back - https://github.com/mozilla/rust/pull/7182
[12:29:07] <MaikKlein> cmr, I haven't had time yet to do further research because I write 2 exams next week. But I am pretty certain that I got sth working next week
[12:29:15] <kimundi> Aetherspawn: And afaik for performance reasons yielding will only happen automatically on a) io and b) task communication
[12:29:26] <cmr> MaikKlein: Awesome! Not having too much trouble with the code?
[12:29:31] <aatch> Aetherspawn, `yeild` is in std::task
[12:29:34] <Blei> doener: ah, i think i see the problem
[12:29:38] <doener> Blei: that's just the copy of the pointer that bar() has
[12:29:46] <Blei> exactly
[12:30:03] <MaikKlein> cmr, no it was kinda okay, I did a lof of debuging with println though :X
[12:30:04] <kimundi> So if you have an loop that does neither of those things you have to call task::yield() periodically if you don't want to block other tasks
[12:30:04] <Aetherspawn> aatch, yes but I would expect if the yielding is part of the library
[12:30:07] <Blei> everyone has to use the same pointer, else this doesn't make sense
[12:30:08] <Aetherspawn> like how its implemented in haskell
[12:30:15] <Aetherspawn> that ctrl+f yield might return some results in io.rs
[12:30:26] <cmr> Aetherspawn: I imagine a lot of the new work is in a branch in brson's repo somewhere
[12:30:41] <Aetherspawn> ok, so its safe to assume at the moment that I /can/ run out of tasks?
[12:30:44] <cmr> Aetherspawn: The current state of io is *really* bad
[12:30:50] <Aetherspawn> OK
[12:30:54] <Aetherspawn> thanks guys
[12:30:58] <Aetherspawn> love rust :)
[12:31:00] <doener> Blei: then the memset wouldn't just stop the glue from freeing stuff, but also destroy the only pointer to it
[12:31:01] <aatch> Aetherspawn, you can't, realistically, run out of tasks
[12:31:06] <Aetherspawn> C + haskell is the perfect lovechild.
[12:31:12] <Aetherspawn> /s/tasks/workers/
[12:31:13] <kimundi> Aetherspawn: THe task sheduling and io implementation is currently partially implemented with c/c++ code.
[12:31:16] <Blei> doener: no, the pointer is copied in bar() and returned
[12:31:40] <Blei> isn't this (the memset) basically the implementation of moving ~ptrs?
[12:31:50] <Blei> i.e. what we were talking about yesterday
[12:31:52] <doener> Blei: Right. I was commenting on your "everyone has to use the same pointer"
[12:31:55] <dbaupp> aatch: woah, nice work
[12:31:55] <cmr> Aetherspawn: actually it looks like when all tasks are blocked, it somehow handles it, looking in rt/rust_sched_loop.cpp
[12:32:06] <cmr> src/rt that is
[12:32:07] <cmr> not libstd/rt
[12:32:25] <aatch> dbaupp, that was my weekend
[12:32:28] *** Quits: zq (p@moz-4C4640FD.com) (Client exited)
[12:32:46] <Aetherspawn> which function?
[12:32:52] <dbaupp> aatch: and an amazing weekend it was
[12:33:14] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[12:33:14] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AdbKwg
[12:33:14] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[12:33:19] <cmr> Aetherspawn: run_single_turn
[12:34:24] <aatch> Aetherspawn, it's best not to think about the implementation of tasks at the moment in Rust
[12:35:22] <Aetherspawn> :)
[12:35:27] <aatch> since it's being completely re-written and even the general style is completely settled (There is a strong argument for making fork-join the major type, with others being less easy)
[12:35:43] <doener> Blei: this might be due to the check in trans_call_inner here: https://github.com/mozilla/rust/blob/master/src/librustc/middle/trans/callee.rs#L591
[12:35:55] <doener> Blei: for ~self, the self_mode is ByRef
[12:36:10] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[12:36:10] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/vJN_8Q
[12:36:10] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[12:36:11] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:36:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/gXHixw
[12:36:11] <ghrust> 13rust/06auto 149c4f9bb 15Kevin Ballard: Fix terminfo::param %i op
[12:36:11] <ghrust> 13rust/06auto 14c154899 15bors: auto merge of #7160 : kballard/rust/terminfo-parm-i-fix, r=thestinger...
[12:36:11] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:37:02] <doener> Blei: err, no, wait, it gets the arg type wrong
[12:37:04] <aatch> Heh, so ignoring whitespace changes, that PR is actually "40 changed files with 1,755 additions and 2,408 deletions."
[12:37:18] <doener> Blei: it actually thinks it's passing a plain Foo!?
[12:37:29] <doener> rust: ~"trans_arg_expr(formal_arg_ty=(Foo), self_mode=ByRef, arg_expr=expr(41: (~Foo{data: ~[1, 2, 3],})), ret_flag=None)"
[12:37:52] <Blei> doener: there's lots of strange bitcasting going on
[12:38:17] <Blei> when calling bar(), &~Foo is cast to ~Foo, and then in bar(), ~Foo is cast to &~Foo
[12:38:29] <Blei> so i don't think that's the problem
[12:38:41] <Blei> except if you see the excessive casting as a problem XD
[12:39:41] <aatch> wow, I managed to type `git psuh` twice in a row.
[12:40:11] <cmr> I do reploy *all* *the* *time*
[12:40:13] *** Quits: ___ (Mibbit@moz-E667CCDF.neoplus.adsl.tpnet.pl) (Quit: http://www.mibbit.com ajax IRC Client)
[12:40:18] <cmr> (instead of deploy)
[12:40:28] <doener> Blei: because it's passed ByRef, and AFAICT, it shouldn't
[12:40:40] <doener> Blei: the self_ty on the method is wrong
[12:41:08] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[12:41:42] <Aetherspawn> either should have a to_str
[12:41:56] <aatch> Aetherspawn, why?
[12:42:10] <Aetherspawn> otherwise you have to match it to print it
[12:42:12] <Aetherspawn> unless you know a better way
[12:42:22] <cmr> fmt!("%?", foo)
[12:42:48] <cmr> I could see an impl<L: ToStr, R: ToStr> Either<L, R> { ... }
[12:43:06] <cmr> or impl ToStr for, rather
[12:43:42] <aatch> I don't think I understand the question. If I have an Either<BigStruct, ~int>, what would to_str do?
[12:43:53] <aatch> Also, it's not Either anymore.
[12:43:58] <aatch> it's Result.
[12:44:04] <cmr> aatch: call to_str on whatever you have
[12:44:06] <cmr> Either went away?
[12:44:19] <dbaupp> aatch: there's both
[12:44:26] <cmr> It's still there
[12:44:32] <Aetherspawn> is there Maybe?
[12:44:35] <aatch> Oh right, I'm thinking of Maybe -> Option
[12:44:37] <cmr> Aetherspawn: Option
[12:44:38] <Aetherspawn> while we're in haskell-land
[12:44:40] <aatch> Aetherspawn, Option
[12:44:44] <Aetherspawn> Oooh thats awesome.
[12:45:14] <aatch> Aetherspawn, btw, it's better think about that side of Rust from an MLish point of view
[12:49:51] <Aetherspawn> what parts of mingw does rust use on windows
[12:58:36] <Blei> doener: huh, apparently it's actually passed ByCopy, or i'm reading the debug output incorrectly
[12:58:46] <Blei> this explains why it uses a new pointer
[12:59:18] <Blei> hrm, it appears i'm reading the debug output incorrectly
[13:02:53] <doener> Blei: it's ByRef, so instead of passing ~self you get &~self
[13:03:17] <doener> Blei: it should be ByCopy. That would pass it as ~self and revoke the cleanup
[13:04:00] <Blei> but it needs the cleanup, no?
[13:04:17] <Blei> let a = ~"a"; if (somecond) { a.bar() }
[13:04:50] <doener> Blei: no. That's the cleanup for the one that's moved into the method. There's another drop for the value returned by the method
[13:05:10] <doener> Blei: and thus it first executes the drop for the returned value and then the free for the original one
[13:05:13] <doener> boom
[13:05:35] <doener> and I guess I just found that removing the free for structs might be wrong...
[13:05:51] <doener> cleanup_and_leave seems to call free directly
[13:05:52] <Blei> but it still needs the drop for the original value
[13:05:57] <Blei> see the code above
[13:06:46] <Blei> doener: in that case, the previous code was incorrect too, becaus it didn't free the struct fields if the struct didn't contain a destructor
[13:07:28] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[13:10:14] <doener> Blei: I mean that the cleanup calls the free _glue_ directly, but actually that only happens for boxes
[13:10:18] <doener> so all is good
[13:11:05] <Blei> doener: the free glue for structs didn't free the struct fields if the struct didn't implement a destructor
[13:13:35] <doener> Blei: and if the cleanup _had_ called the free glue for structs (as I mistakenly thought) and not the drop glue, then it wouldn't do that for structs _with_ destructors anymore (obviously, because it's gone ;-))
[13:13:37] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:13:58] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[13:14:13] <aatch> Man, addrspace-free IR is much easier to read
[13:15:38] *** Quits: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net) (Quit: to sleep!)
[13:16:55] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[13:17:45] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[13:18:09] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:23:12] <Aetherspawn> cargo is a better name than rust-pkg
[13:25:57] *** Joins: tef (tef@moz-67B68E00.printf.net)
[13:30:10] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:30:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/gXHixw
[13:30:10] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:30:25] *** Parts: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP) ()
[13:30:35] <cmr> A good day for landing PRs it seems
[13:31:12] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[13:33:11] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[13:33:11] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/T54Uwg
[13:33:11] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[13:33:16] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[13:33:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rt7cjA
[13:33:16] <ghrust> 13rust/06auto 140f9c191 15Brian Anderson: std: Remove doc references to reinterpret_cast
[13:33:16] <ghrust> 13rust/06auto 14ebca26c 15bors: auto merge of #7163 : brson/rust/reinterpret-cast, r=thestinger
[13:33:16] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[13:35:14] <doener> damn, the one I'm preparing would conflict with aatch's
[13:45:38] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[13:53:38] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[14:01:41] *** Quits: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au) (Quit: Leaving)
[14:02:27] *** cscottnet_away is now known as cscottnet
[14:03:01] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Quit: KVIrc 4.0.4 Insomnia http://www.kvirc.net/)
[14:03:50] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[14:10:46] *** Quits: MaikKlein (maik@moz-90469F77.dip0.t-ipconnect.de) (Ping timeout)
[14:11:18] *** Quits: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net) (Ping timeout)
[14:12:55] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[14:14:00] <cmr> How should I go about testing my patch that adds -W all/-D all etc?
[14:15:02] <cmr> in an automated fashion, that is.
[14:16:00] *** Joins: rajul (quassel@A2DDF553.812B5995.2051BA92.IP)
[14:24:11] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:24:11] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rt7cjA
[14:24:11] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:25:38] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Ping timeout)
[14:25:41] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[14:26:07] *** Quits: snearch (snearch@moz-839145EB.pool.mediaways.net) (Quit: Verlassend)
[14:27:08] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[14:27:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/1jd4JQ
[14:27:08] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:27:09] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[14:27:09] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/2mWQvQ
[14:27:09] <ghrust> 13rust/06auto 14c5f89e6 15Brian Anderson: More 0.7 release notes
[14:27:09] <ghrust> 13rust/06auto 14b95bb91 15bors: auto merge of #7165 : brson/rust/releasenotes, r=thestinger
[14:27:09] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[14:28:25] <Blei> cmr: add it to the makefile for stage 0 as discussed here: https://github.com/mozilla/rust/issues/6963
[14:28:33] <Blei> then everyone will notice when it breaks
[14:28:53] <cmr> Blei: Well I don't want to actually *use* it, just allow it in the first place
[14:30:03] *** Joins: Aetherspawn_BNC (uid6924@moz-A588D045.irccloud.com)
[14:31:06] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[14:33:04] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[14:34:26] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:39:24] *** Quits: spider-mario (spidermari@moz-B8FA2FF4.rev.sfr.net) (Input/output error)
[14:40:26] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[14:43:46] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[14:44:38] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[14:48:29] <bjz> nmatsakis: ping
[14:53:35] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[14:54:03] *** Joins: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP)
[14:55:34] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[14:55:51] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[14:56:10] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[15:01:16] *** Joins: jpf (jan@moz-A8C26A15.org)
[15:05:42] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[15:06:08] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[15:06:08] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b95bb91 to 14ebca26c: 02http://git.io/N3iJvQ
[15:06:08] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[15:13:48] *** Joins: steveklabnik (steveklabn@moz-CF62A06A.public.wayport.net)
[15:14:07] <doener> oh boy... took me almost an hour to realize that I accidently turned a vector copy into a slice copy, and that that was the reason for the dynamic borrow failure
[15:20:14] *** Quits: goffrie (goffrie@moz-5C4201F5.dsl.ncf.ca) (Ping timeout)
[15:29:37] *** Joins: TimoT (timot@CCA93178.A15B0514.898DC978.IP)
[15:31:25] *** Quits: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP) (Ping timeout)
[15:33:38] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[15:34:22] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[15:35:07] *** Joins: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP)
[15:35:42] *** Quits: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[15:38:41] *** Quits: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP) (Ping timeout)
[15:39:57] *** Quits: steveklabnik (steveklabn@moz-CF62A06A.public.wayport.net) (Ping timeout)
[15:43:25] *** Joins: steveklabnik (steveklabn@moz-CF62A06A.public.wayport.net)
[15:44:14] *** Quits: steveklabnik (steveklabn@moz-CF62A06A.public.wayport.net) (Quit: Lost terminal)
[15:48:19] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[15:49:16] *** Joins: themgt (themgt@moz-453E9466.phlapa.fios.verizon.net)
[15:49:19] *** Quits: themgt (themgt@moz-453E9466.phlapa.fios.verizon.net) (Quit: themgt)
[15:54:43] *** Joins: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP)
[15:55:19] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:57:02] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[15:57:08] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[15:57:08] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/EdK_Vw
[15:57:08] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[15:59:33] <Jesse> kimundi: if https://gist.github.com/Kimundi/5744578 were a wiki page i could fix your typos :P
[16:00:09] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[16:00:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/L2ldKg
[16:00:09] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[16:00:09] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[16:00:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0s3MCQ
[16:00:10] <ghrust> 13rust/06auto 141026fe8 15Ben Striegel: Delete some binary files from the test suite
[16:00:10] <ghrust> 13rust/06auto 14900de0f 15bors: auto merge of #7171 : bstrie/rust/delbin, r=thestinger
[16:00:10] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[16:00:27] <Jesse> kimundi: does the arena allocation at the top need lifetime annotations, tying the lifetime of `t' to the lifetime of `ar'?
[16:01:24] <kimundi> Jesse: Probably yes
[16:02:51] <Thiez> anyone have a good idea how to fix arena?
[16:03:07] <kimundi> Thiez: Rewrite it? :P
[16:03:26] <Thiez> I was hoping for something simpler :p
[16:03:43] <cmr> use an older versino of rust where it works? :p
[16:03:53] <cmr> (assuming it ever did)
[16:03:54] <Thiez> and it's not the code itself that's bad (I think :p), but the interface doesn't work with borrowing
[16:03:56] <kimundi> Thiez: Pretend it's fixed? ;)
[16:04:23] <Thiez> oh I have it working right now by chaning the interface to use &self, and casting to &mut self (and ofc annotating the struct with #[mutable]) but it's evil
[16:04:37] <Thiez> I was kind of hoping to get it to work properly...
[16:04:48] <kimundi> Thiez: Well I would probably do an mockup
[16:04:49] <Thiez> (running into this fixing shootout-binarytrees)
[16:05:06] <cmr> Thiez: you're fixing the benchmarks? <3
[16:05:19] <cmr> I was going to have to do that this week
[16:05:30] <Thiez> cmr: go ahead, I'll stop working :p
[16:05:42] *** Joins: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de)
[16:05:42] <cmr> no that's ok :p
[16:05:51] <Thiez> you're too kind :p
[16:06:07] <kimundi> Thiez: Well you could look at how Rc and RcMut are implemneted, and then adapt their design so that you get handles that are chained to the arena
[16:06:16] <cmr> Anyone around to r? https://github.com/mozilla/rust/pull/7185
[16:06:45] <Thiez> but srsly, taking &'a mut self, and returning &'a T is never going to work because as long as T lives, self will be borrowed as mut
[16:07:01] <Thiez> so it's never going to be pretty :(
[16:07:29] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[16:07:42] <acrichto> cmr: I don't think that's a very useful thing to add for linting
[16:07:50] <kimundi> Jesse: Ah, I just saw your first comment. You can fork the gist and link me to it for spelling mistakes :P
[16:07:58] <acrichto> cmr: most of the time there's lints you don't really care about, and turning them all off/on seems unnecessary
[16:08:00] <cmr> acrichto: I need it in my runner. I don't want any output from lints.
[16:08:06] <cmr> my benchmark runner, that is
[16:08:13] <acrichto> cmr: https://github.com/alexcrichton/rust/commit/b9f33d8f4a017be49c1496632d40e5369520c7f6
[16:08:26] <acrichto> what you want is something like that which suppresses all emitted warnings, not everything in general
[16:08:30] *** Quits: Jesin (Jessin_@5A8F6E3.9F7BDBDF.8B824544.IP) (Quit: Leaving)
[16:09:03] <acrichto> cmr: also it seems to muck with the source of all lint levels in a way that misleads the error message later on
[16:10:12] <Thiez> cmr: you're making a benchmark runner? awesome :)
[16:10:27] <cmr> acrichto: example? I don't see anything like that
[16:10:41] <acrichto> cmr: example of that commit?
[16:10:51] <cmr> acrichto: no, of misleading
[16:11:16] <cmr> acrichto: you're probably right about just the warnings though, I didn't realize you already had that
[16:11:20] <acrichto> cmr: oh I looked again at it and I saw that it's only at the top level, the `all` field wouldn't need to be located in the struct because the methods never read that (misled me when I first saw it)
[16:11:41] <acrichto> this may also be useful though, so someone else other than me should weigh in
[16:12:03] <acrichto> It seems though that you want to use `-A all` possible, and you would almost never want `-W all` and `-D all`
[16:12:08] <acrichto> possibly*
[16:12:18] <cmr> Yes, -W all and -D all are next to useless
[16:12:36] <acrichto> that part makes me a bit hesitant to have it, because they're still possible and people are still going to use them somewhere
[16:14:40] <acrichto> cmr: another unfortunate part of that is that #[allow(all)] doesn't work (as one would expect)
[16:15:54] <cmr> yeah
[16:17:17] <acrichto> cmr: I'll throw my comments on the pull, and a reviewer can look it over as well
[16:17:17] *** Quits: koomi (koomi@moz-9AE5526E.pools.arcor-ip.net) (Quit: WeeChat 0.4.1)
[16:17:42] <cmr> acrichto: much appreciated :) I agree with your critique, and having the "warnings" one is much more useful in general
[16:18:23] <cmr> There's also precedent in -Wall not being everything. gcc and clang both have extra flags for extra, not-really-useful warnings
[16:18:59] <acrichto> yeah
[16:20:09] *** Quits: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de) (Ping timeout)
[16:25:34] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[16:28:25] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[16:28:55] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[16:30:17] <doener> *sigh* it's basically impossible for me to run the testsuite
[16:31:16] <kimundi> doener: 'wrong error code' in compile-fail?
[16:31:51] <kimundi> Cause that's what prevents me to test my changes since I started today
[16:32:41] <doener> kimundi: dead canaries all over the place
[16:33:25] <kimundi> Hm, I don't get messages that talk about dead birds :P
[16:36:14] *** Joins: Guest_ (textual@moz-A3295542.nycmny.fios.verizon.net)
[16:39:54] *** Joins: koomi (koomi@moz-B2B8B6D1.superkabel.de)
[16:40:11] *** Joins: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk)
[16:42:54] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[16:46:41] *** Quits: koomi (koomi@moz-B2B8B6D1.superkabel.de) (Ping timeout)
[16:48:00] *** Joins: koomi (koomi@moz-B2B8B6D1.superkabel.de)
[16:48:51] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[16:53:14] *** Joins: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de)
[16:54:14] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[16:54:15] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/0s3MCQ
[16:54:15] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[16:55:07] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[16:56:17] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[16:57:11] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[16:57:11] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/MpfdDQ
[16:57:11] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[16:57:15] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[16:57:15] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/YW-QNQ
[16:57:15] <ghrust> 13rust/06auto 14461a79a 15Niko Matsakis: Partial fix for #7158: Save EDX in morestack on x86-32
[16:57:15] <ghrust> 13rust/06auto 14682bb41 15Niko Matsakis: correct ASM_COMMENTS Makefile option
[16:57:15] <ghrust> 13rust/06auto 14eb48c29 15Niko Matsakis: Add copies to type params with Copy bound
[16:57:17] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[16:58:59] <nmatsakis> bjz: pong
[16:59:12] <cmr> nmatsakis: could that have been the cause of the stack corruption too?
[16:59:24] <nmatsakis> cmr: you mean #7158?
[16:59:26] <cmr> yes
[16:59:42] <nmatsakis> cmr: I don't know how, but I guess I wouldn't rule it out.
[17:00:13] <nmatsakis> cmr: still I suspect not
[17:00:54] <cmr> nmatsakis: it seems unlikely to me too, didn't know if you had more insight into it
[17:01:48] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[17:03:06] <kimundi> erick, ping
[17:04:13] <kimundi> erickt, ping
[17:05:20] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[17:07:23] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:07:56] *** Joins: judder (maradukewa@85208D00.97F8E51D.E305BD61.IP)
[17:08:04] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[17:08:15] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:10:40] *** Joins: tjc (tjc@moz-E232F212.hfc.comcastbusiness.net)
[17:10:40] *** ChanServ sets mode: +o tjc
[17:11:47] *** Quits: Guest_ (textual@moz-A3295542.nycmny.fios.verizon.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:12:15] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[17:12:45] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[17:13:06] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[17:14:51] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[17:15:39] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[17:19:49] *** Quits: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de) (Ping timeout)
[17:31:15] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:42:17] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[17:43:39] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[17:44:12] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[17:50:31] *** Quits: rajul (quassel@A2DDF553.812B5995.2051BA92.IP) (Client exited)
[17:51:09] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[17:51:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/YW-QNQ
[17:51:09] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[17:54:08] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[17:54:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/JBZozg
[17:54:08] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[17:57:16] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[17:57:16] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/JBZozg
[17:57:16] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[17:57:16] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[17:57:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rufb8A
[17:57:16] <ghrust> 13rust/06auto 1453f6a4e 15Huon Wilson: std: fix UnfoldrIterator cross-crate.
[17:57:16] <ghrust> 13rust/06auto 14fd8aa9a 15bors: auto merge of #7177 : huonw/rust/unfold-fix, r=thestinger
[17:57:16] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[18:01:55] *** Joins: smvv (smvv@moz-A397289C.xlshosting.net)
[18:02:15] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[18:03:46] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[18:04:19] <steven_is_false> So I don't think the proposed syntactic sugar for writing pointer types is needed but I agree somewhat that there should be syntactic sugar for borrowing, and using instances of these pointer types, (although I think a lightweight thunk syntax could address creation of these pointer types.)
[18:05:27] <cmr> strcat had something to say about the sugar not adequately handling the semantic changes required, but he didn't elaborate
[18:05:40] <steven_is_false> cmr: Oh.
[18:05:40] *** Joins: gareth0 (gareth0@moz-D5BE989F.dynamic.dsl.as9105.com)
[18:07:11] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:07:37] *** Quits: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net) (Ping timeout)
[18:08:13] <steven_is_false> I wonder if better smart pointer syntax would mean better iterator syntax as well (because iterators are a type of smart pointer.)
[18:08:35] <cmr> rust iterators aren't smart pointers?
[18:09:10] <steven_is_false> cmr: foo.map isn't smart pointer style but external iterators are.
[18:09:19] <cmr> steven_is_false: how so?
[18:09:26] <cmr> maybe I don't understand smart pointers well enough
[18:09:45] <engla> cmr: nope. .next() both steps forward and gets the value
[18:09:46] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:09:59] <steven_is_false> cmr: It's corecursion versus recursion, or forsome a, a /\ (a -> f a) versus forall a, (f a -> a) -> a
[18:10:06] <kimundi> steven_is_false: Err how is an iteratior an smartpointer?
[18:10:21] <steven_is_false> kimundi: An iterator points to a location in the data structure.
[18:10:33] <steven_is_false> It can be dereferenced, and set (sometimes)
[18:11:45] <steven_is_false> I mean in C often one just uses a pointer directly, for (int * x = a; x != b; ++x) etc...
[18:12:04] <cmr> But rust iterators are nothing like that, or C++ iterators
[18:12:24] <cmr> They're just a uniform interface for accessing data in sequence, be it a RNG or a file or a collection.
[18:12:37] <kimundi> steven_is_false: If an iterator counts as smartpointer, then most datastructures are smartpointers :P
[18:12:56] <cmr> Accessing it mutates it, there is no "peek"
[18:13:05] <cmr> (or dereference)
[18:14:04] <steven_is_false> kimundi: Have you looked at the concept of a zipper? Most data structures (or slight variations of them) can be made into zippers, and then pointers.
[18:14:16] <kimundi> steven_is_false: My proposal talks about an definition of smartpointer where it's an box for an value responsible for tha allocation and deallocation of it's content
[18:14:42] <steven_is_false> kimundi: Yeah but some of it is lightweight borrowing syntax
[18:15:13] <kimundi> steven_is_false: The borrowning syntax isn't even relevant for my proposal. :P
[18:15:38] <steven_is_false> kimundi: You don't think it's important?
[18:16:14] <kimundi> Err, no I just don't see how its relevant
[18:16:26] <steven_is_false> kimundi: Okay, fair enough.
[18:17:13] <kimundi> An itererator is not an smartpointer as  would understand it because it's neither responsible for allocating memroy nor for cleaning it up.
[18:17:20] <kimundi> as I*
[18:17:43] <steven_is_false> kimundi: A borrowed pointer isn't responsible for allocating, or cleaning up memory.
[18:18:06] <kimundi> steven_is_false: Wich is why I wouldn't call it an smartpointer
[18:18:08] <cmr> Borrowed pointers aren't smart pointers either, they're just a compile-time enforcement of safety.
[18:18:10] *** Quits: tjc (tjc@moz-E232F212.hfc.comcastbusiness.net) (Quit: zzzzzzzzzz)
[18:18:39] <steven_is_false> cmr: Well borrowed pointers are dump pointers but they're still pointer types.
[18:18:39] <kimundi> Our current ~, @, Rc, Arc are smartpointer
[18:18:47] *** Joins: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP)
[18:19:09] <steven_is_false> Anyways it seems like the two main things you care about are allocation sugar, and Type sugar
[18:19:30] <steven_is_false> * by you I meant kimundi
[18:19:44] <kimundi> steven_is_false: That's basicall ythe only thing different fromn the other way the devs could do it.
[18:19:49] <kimundi> so yes.
[18:20:39] <steven_is_false> kimundi: So I agree that ar.allocate(|| bar()), or do ar.allocate { bar () } is kind of ugly. But I don't think GC<T> is that bad.
[18:21:05] <kimundi> It seems it's going to be either 'let foo: Gc<T> = new(Gc) bar()' or 'let foo: @Gc = @Gc bar()'
[18:21:25] <kimundi> Err, 'let foo: @Gc T = @Gc bar()'
[18:22:22] <steven_is_false> kimundi: How does new(GC) bar() address the arenas case?
[18:22:32] <kimundi> steven_is_false: Well I have an part in my proposal where I'm talking about why I think @Gc is potentially better
[18:22:59] <kimundi> steven_is_false: Dunno, Thats just what the devs have been throwing around on their own
[18:23:01] *** Joins: tjc (tjc@moz-E232F212.hfc.comcastbusiness.net)
[18:23:01] *** ChanServ sets mode: +o tjc
[18:23:09] *** Quits: judder (maradukewa@85208D00.97F8E51D.E305BD61.IP) (Ping timeout)
[18:23:38] <steven_is_false> kimundi: okay
[18:24:11] <steven_is_false> kimundi: Thanks for cleaning up what you most care about in regards to the smart pointers.
[18:25:21] <kimundi> I mostly think that the sisgils are a nice short concise way to express memory allocation types, and if we keep &'s and ~'s syntax it makes more sense for @ to be suagr that works the same
[18:25:39] <kimundi> Just with an additiondl identifier to choose wich smartpointer type you mean
[18:25:51] <steven_is_false> kimundi: okay
[18:27:59] <steven_is_false> kimundi: Actually, do you have any samples of code in particular that your working on where this kind of stuff would be useful?
[18:30:13] *** Parts: steven_is_false (steven@moz-144077DE.bchsia.telus.net) ()
[18:40:08] *** Joins: robert (robertknig@moz-C34822AC.range86-166.btcentralplus.com)
[18:40:16] *** Joins: fabiand (fabiand@AE7DF78A.B55F2281.3601B52B.IP)
[18:44:52] *** Joins: cr (anonymous@moz-6AFA0729.dip0.t-ipconnect.de)
[18:46:55] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[18:47:42] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[18:48:11] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[18:48:11] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rufb8A
[18:48:11] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[18:49:08] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[18:49:30] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:49:44] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[18:49:59] *** Quits: tjc (tjc@moz-E232F212.hfc.comcastbusiness.net) (Quit: zzzzzzzzzz)
[18:50:02] *** Quits: int3_ (int3_@F9CBAE8E.38B66F9B.A36C57B9.IP) (Client exited)
[18:50:08] *** Joins: kemurphy_ (Mibbit@A01051A9.6F669779.3D1CA460.IP)
[18:51:09] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[18:51:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/5WxU2g
[18:51:09] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[18:51:10] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[18:51:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/MbGulw
[18:51:10] <ghrust> 13rust/06auto 14642cd46 15BjÃ¶rn Steinbrink: Avoid quadratic growth of cleanup blocks...
[18:51:10] <ghrust> 13rust/06auto 1481506a6 15bors: auto merge of #7186 : dotdash/rust/landing_pads, r=pcwalton...
[18:51:11] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[18:52:45] <kemurphy_> is there any way to frob a global variable from a C library?
[18:53:05] <cmr> frob?
[18:57:08] <kemurphy_> er, manipulate
[18:57:17] <kemurphy_> read and write
[18:57:19] <kemurphy_> :P
[18:57:31] *** Quits: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com) (Input/output error)
[18:57:44] *** Joins: gavin (gavin@moz-DB4A9C19.scl3.mozilla.com)
[18:58:47] *** Joins: KindOne (KindOne@moz-7A029625.dynamic.ip.windstream.net)
[19:00:30] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[19:04:58] *** Quits: KindOne (KindOne@moz-7A029625.dynamic.ip.windstream.net) (Ping timeout)
[19:06:00] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[19:07:06] *** Quits: TimoT (timot@CCA93178.A15B0514.898DC978.IP) (Quit: Konversation terminated!)
[19:07:11] *** Joins: dualhbridge (dad@moz-9FEE6D3B.maine.res.rr.com)
[19:08:05] *** Joins: TimoT (timot@moz-524A8572.cust.telenor.se)
[19:09:29] *** Joins: KindOne (KindOne@567BA5E9.503E0241.EC6A1518.IP)
[19:11:00] *** Parts: dualhbridge (dad@moz-9FEE6D3B.maine.res.rr.com) ()
[19:11:36] *** Quits: kemurphy_ (Mibbit@A01051A9.6F669779.3D1CA460.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:14:07] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[19:14:36] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[19:15:53] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[19:23:43] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[19:25:56] *** Joins: int3_ (int3_@moz-2F88F820.googlewifi.com)
[19:27:16] *** Quits: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr) (Quit: pyrac)
[19:27:48] *** Quits: int3_ (int3_@moz-2F88F820.googlewifi.com) (Ping timeout)
[19:30:50] *** Joins: dpc (Mibbit@moz-86B6569C.hfc.comcastbusiness.net)
[19:30:57] <dpc> Hi there.
[19:31:07] <dpc> Any plans to fix rustpkg?
[19:31:32] <dpc> I miss cargo. It worked for me. :S
[19:31:43] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[19:33:25] <acrichto> dpc: it's being worked on by tjc and is slated to be ready-to-use by 0.7
[19:33:55] <acrichto> dpc: you can follow https://github.com/mozilla/rust/issues/5677 for more info
[19:34:47] *** Joins: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr)
[19:40:12] *** Quits: KindOne (KindOne@567BA5E9.503E0241.EC6A1518.IP) (Ping timeout)
[19:42:09] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[19:42:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/MbGulw
[19:42:09] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[19:42:09] *** Quits: eevee (eevee@moz-A643AA65.evrt.wa.frontiernet.net) (Connection reset by peer)
[19:42:39] *** Joins: eevee (eevee@moz-A643AA65.evrt.wa.frontiernet.net)
[19:44:09] *** Joins: KindOne (KindOne@87162786.9C5C45A3.EC6A1518.IP)
[19:48:09] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[19:48:58] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[19:52:56] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:53:53] <enix> I created a short, possibly invalid, rust program that makes the rust compiler crash with an assertion. I can open up an issue on GitHub, but I have no idea how to check if there is already an issue open for this: https://gist.github.com/DaGenix/5793174
[19:55:05] <pnkfelix> enix: try searching in the search bar at the top of the github page, to check for any obvious duplicates
[19:55:06] *** Joins: goffrie (goffrie@moz-E04A2B1C.dsl.ncf.ca)
[19:55:50] <pnkfelix> enix: but I would say, don't invest too much effort in trying to search; trust the dev's to tag duplicates as such during bug triage sessions
[19:57:01] <enix> ah, ok, cool
[19:57:23] <enix> i didn't realize that bar searched through issues, i assumed it was for files
[19:57:48] <enix> regardless, the first issue returned is for the exact same assertion, so, i guess I have nothing to open
[19:57:49] <enix> thanks!
[20:00:53] <robert> Is there an equivalent to exit(status_code) in Rust?
[20:01:15] *** Joins: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de)
[20:01:48] <robert> (Which terminates the process as well as setting the exit status)
[20:02:33] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[20:02:35] <kimundi> robert: os::set_exit_code() and then return from main
[20:02:40] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[20:03:04] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[20:03:04] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130612084701])
[20:03:28] *** Quits: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net) (Quit: bye!)
[20:03:42] *** Joins: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net)
[20:04:58] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[20:12:52] *** Quits: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de) (Ping timeout)
[20:15:38] <Jeaye> bjz: ping
[20:16:35] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[20:22:38] <Amanieu> nmatsakis: Thanks for the response, I now see more clearly what the problem is.
[20:22:57] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[20:23:23] <steven_is_false> Hello! Is there something similar to an each_mut method for vectors?
[20:24:18] <kimundi> steven_is_false: I think mut_iter() or iter_mut() can be used for that
[20:24:43] <steven_is_false> kimundi: Okay
[20:24:51] <robert> kimundi: Can this be done without returning from main()?  Would it be un-idiomatic to do so?
[20:25:21] <steven_is_false> How does one use an iterator
[20:27:57] <steven_is_false> rusti: do [1, 2, 3].iter.advance |&x| { println(fmt!(x)) }
[20:27:58] -rusti- <anon>:9:61: 9:62 error: first argument to fmt! must be a string literal.
[20:27:58] -rusti- <anon>:9     let r = {  do [1, 2, 3].iter.advance |&x| { println(fmt!(x)) } };
[20:27:58] -rusti-                                                                       ^
[20:27:58] -rusti- application terminated with error code 101
[20:29:21] <Eridius> whee, our ~str behavior lets me kill programs that use os::args() or os::env() by providing a badly-encoded argument or env var! (filed as #7188)
[20:32:54] <steven_is_false> rusti: do [1, 2, 3].iter.advance |&x| { println(fmt!("%?", x)) }
[20:32:56] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/FieJ
[20:33:09] <Blei> steven_is_false: use for instead
[20:33:19] <steven_is_false> Doh!
[20:33:34] <steven_is_false> rusti: for [1, 2, 3].iter().advance |&x| { println(fmt!("%?", x)) }
[20:33:36] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/XPHi
[20:35:27] <Jeaye> rusti: for [1, 2, 3].iter().advance |x| { println(fmt!("%?", x)); }
[20:35:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/FGIe
[20:35:43] <Jeaye> rusti: for ~[1, 2, 3].iter().advance |x| { println(fmt!("%?", x)); }
[20:35:44] -rusti- <anon>:9:37: 9:44 error: `for` must be followed by a block call
[20:35:44] -rusti- <anon>:9     let r = {  for ~[1, 2, 3].iter().advance |x| { println(fmt!("%?", x)); } };
[20:35:44] -rusti-                                               ^~~~~~~
[20:35:44] -rusti- application terminated with error code 101
[20:37:08] <Jeaye> rusti: use std::iterator::IteratorUtil; for ~[1, 2, 3].iter().advance |x| { println(fmt!("%?", x)); }
[20:37:09] -rusti- <anon>:9:70: 9:77 error: `for` must be followed by a block call
[20:37:09] -rusti- <anon>:9     let r = {  use std::iterator::IteratorUtil; for ~[1, 2, 3].iter().advance |x| { println(fmt!("%?", x)); } };
[20:37:09] -rusti-                                                                                ^~~~~~~
[20:37:09] -rusti- application terminated with error code 101
[20:37:23] * Jeaye gives up
[20:37:40] *** Joins: mcstar (mcstar@moz-D7A16997.monradsl.monornet.hu)
[20:37:50] <doomlord__> some people... just had someone trolling me on the subject of "fn "
[20:38:27] <doomlord__> they think typing "fn " infront of functions would render rust unusable... because its un-necasery typing , compared to C++ (LOL)
[20:38:53] <Blei> rusti: let a = [1,2];for a.iter().advance |&x| { println(x.to_str());}
[20:38:55] -rusti- 1
[20:38:55] -rusti- 2
[20:38:55] -rusti- ()
[20:42:24] *** Joins: SingingBoyo (brandon@moz-EAC7E73D.bchsia.telus.net)
[20:44:30] *** Quits: gareth0 (gareth0@moz-D5BE989F.dynamic.dsl.as9105.com) (Client exited)
[20:45:33] <Thiez> doomlord__: perhaps they'd like to compare the amount of typing performed when using function pointers
[20:46:14] <doomlord__> i've tried inviting this individual to this channel...
[20:46:22] <doomlord__> i tried explaining the 'mut vs const' tradeoff
[20:46:42] <doomlord__> personally i like 'fn' for the simple fact it makes grepping so much easier
[20:47:53] <Thiez> you sure have a point there
[20:48:50] <Thiez> and in rust we have great type inference which saves a lot of typing compared to C++ :p
[20:49:08] <doomlord__> there's auto in c++. (this person hates auto .. )
[20:49:52] <doomlord__> i think the type inference is comparable, but are there situations where rust infers better than c++? 
[20:50:16] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Ping timeout)
[20:50:31] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[20:50:51] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[20:51:00] <Thiez> I forgot all about auto
[20:51:10] <EXetoC> screw grepability. brainfuck ftw
[20:51:49] *** Quits: fabiand (fabiand@AE7DF78A.B55F2281.3601B52B.IP) (Quit: Verlassend)
[20:51:57] <doomlord__> although rust saves typing, "let" instead of "auto" .. :) i think there's enough saved characters there to account for the 'fn'
[20:52:34] <mcstar> auto does not necessarily enhance readability, but it makes it easier to shorten nested iterator types
[20:52:36] <mcstar> imho
[20:52:41] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[20:53:01] <EXetoC> yeah such a ridiculous argument. gotta look at the whole picture
[20:53:53] <doomlord__> auto makes it easier to refactor code, instead of typing the type out manually.. types at function level should be enough (some say,write short functions, the function names are explanatory..)
[20:54:17] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[20:58:19] <cyndis> c++ does not really have type inference; with auto, the type of the RHS must be completely known
[20:58:31] <cyndis> in rust, not so
[20:59:03] *** Quits: pyrac (pyrac@moz-80532F83.w92-149.abo.wanadoo.fr) (Quit: pyrac)
[21:00:06] <mcstar> how fast is the rust implementation? generally, numeric floating point performance
[21:00:23] <doomlord__> oh, if you say auto x=foo.bar; auto y=x.baz; .. that wouldn't work ?
[21:01:16] *** Joins: mark_edward (quassel@moz-4B552CB8.dynamic.utc.edu)
[21:01:22] <Thiez> mcstar: depends, I think we have a few floating point functions that defer to the C-library and are fairly slow as a consequence
[21:01:30] <Thiez> apart from that it's decent.
[21:01:47] <cyndis> that would, but for example in rust you can do let x = None or let x = ~[] which you can't do in c++
[21:02:27] <mcstar> what would the type of x be? in the first case? is None a value of an option type?
[21:02:32] <mark_edward> hey, im getting a weird error from the compiler
[21:02:34] <cyndis> or let (a,b) = task::stream() not having to specify the data type
[21:02:44] <mcstar> cyndis: ^
[21:02:54] <cyndis> yes
[21:03:08] <cyndis> Option can be None or Some(x)
[21:03:11] <mcstar> so what would it be? i assume it is a parametric type
[21:03:33] <cyndis> the compiler will infer it based on later code that uses the variable
[21:03:39] <mcstar> so i guess, rust would infer the type parameter from the further usage of x?
[21:03:43] <mark_edward> http://pastebin.com/9p4QGb6L
[21:03:44] <cyndis> yes
[21:04:13] <Thiez> mark_edward: nice, what version of rustc are you using?
[21:04:13] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[21:04:19] <Thiez> 0.6 or master?
[21:04:33] <mark_edward> rustc 0.6 (ae23beb 2013-06-16 09:54:59 -0700)
[21:04:35] <mark_edward> master
[21:04:39] <Thiez> is your program online?
[21:04:53] <mark_edward> no it isn't unfortunately
[21:05:01] <mark_edward> i'll put it on github
[21:05:04] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.1)
[21:05:06] <mcstar> cyndis: i dont think it is fair to compare c++'s auto to rust's type inference in this case, since c++ doesnt support type polymorphism, only as a template extension
[21:05:08] <mark_edward> it's several files
[21:06:02] <Thiez> mark_edward: I probably can't solve your problem, but this sounds like a bug that might interest the people who are cleaning up trans
[21:06:26] <cyndis> yes, but it isn't really correct to call `auto' type inference either
[21:07:04] <mark_edward> https://github.com/MarkJr94/rust_adventure
[21:08:32] <mark_edward> Thiez: there it is
[21:08:53] <Luqman> mark_edward: ~Traits are currently broken
[21:08:56] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[21:09:40] <mcstar> is there a big-ish mental overhead when you program using region pointers?
[21:09:45] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[21:10:04] <kimundi> mcstar: Nope it's all static analysis
[21:10:11] <mcstar> for example, when i program in a functional language like haskell, everything is so neat and easy
[21:10:15] <kimundi> mcstar: At runtime it's like a raw pointer
[21:10:48] <mark_edward> huh
[21:10:50] <mcstar> kimundi: im asking if it tasks your brain, while youre writing the program
[21:11:06] <mark_edward> Luqman: like completely? so trait stuff wont work?
[21:11:06] <kimundi> ah
[21:11:12] <kyle2000> in the rust source tree, what is /src/libstd/rt? is that like work that's still in progress?
[21:11:14] <kimundi> not really I'd say
[21:12:11] <Thiez> mark_edward: as Luqman said, ~Trait doesn't work at this time. If you change to @Trait it does work in this case.
[21:12:33] <mark_edward> Ok. isnt that a lot of overhead though?
[21:12:34] <mcstar> ^ thats what im worried about, so many kind of modifiers
[21:12:36] <Thiez> mark_edward: for now you could change all ~Monster to @Monster :)
[21:13:04] <kimundi> mcstar: It's not as bad as it looks
[21:13:08] <mcstar> and i read something about borrowing pointers
[21:13:10] <mark_edward> ok cool
[21:13:13] <Thiez> it's not that much overhead, especially since you're writing a text-adventure and not a fluid-simulator :p
[21:13:14] *** Joins: orshem (orshem@3545E24A.588A166C.E3D28531.IP)
[21:13:29] <mark_edward> Thiez: yeah you're right,
[21:13:38] <mark_edward> too many micro-optimizations
[21:13:41] <mcstar> what if i program computational fluid dynamics?
[21:13:53] <Thiez> mcstar: then you use fortran ;)
[21:13:53] <mark_edward> what's that saying? only optimizie once you find a protocol
[21:13:57] <mcstar> heh
[21:14:22] <mcstar> Thiez: well, we are moving towards gpu's, and we dont do CFD atm
[21:14:23] <Thiez> mark_edward: I agree it's nicer to use ~ where possible, so don't feel bad for trying that
[21:14:43] <Thiez> it's just that it's a little buggy atm
[21:14:47] <mark_edward> yeah, i hope this gets fixed soon
[21:14:53] <Thiez> we all do :)
[21:15:13] <kimundi> mcstar: If you have specific questions or worries, just ask. 
[21:15:44] <mcstar> well, not really, i dont have any, cause im not familiar with the language enogh
[21:15:46] <mcstar> enough*
[21:16:01] <mcstar> but a friend keeps telling me good things about it
[21:16:11] <mcstar> thestinger
[21:16:40] <mcstar> im just playing with a possibility of using it as a replacement for c++
[21:17:41] <kyle2000> mcstar: do you do a lot of hardcore c++? i'm in the same boat as you. i've been doing some of the hardest hardcore c++ i've ever done but i heard that rust was a good replacement. i generally like it but there are quirky things that i get caught up on sometimes.
[21:18:30] <mcstar> i wouldnt say i do hardcore c++, im mostly a computational scientist, and a hobby programmer
[21:19:08] <mcstar> but c++ is pretty outdated imho
[21:19:17] <mcstar> and i like functional programming
[21:19:24] <kimundi> mcstar: I'd say rust is a general improvement just because it can guarantee the safety of so many things at compile time.
[21:19:35] *** Joins: magg (magg@1BF27FFB.CC01697F.EB08AFC4.IP)
[21:19:37] <mcstar> that definitely sounds great
[21:19:39] *** Quits: magg (magg@1BF27FFB.CC01697F.EB08AFC4.IP) (Quit: magg)
[21:20:16] <mcstar> also, i heard it is still close to the metal..
[21:20:30] <mcstar> and it is/will be good in threading
[21:20:38] <kimundi> mcstar: for example, in rust you can make a heap allocation, pass a pointer around to it, and it will make sure at compiletime that the pointer is only accessible as long as the heap allocation exists
[21:21:06] <kimundi> (that's what broowed pointers are mostly all about)
[21:21:07] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[21:21:11] <mcstar> yes, i heard that, the problem is, that i dont see how this works
[21:21:21] <mcstar> is there a semi advanced article on this?
[21:21:26] <Eridius> mcstar: what don't you understand?
[21:21:34] <mcstar> one that doesnt go into impelemntation details, but tells the theory
[21:21:48] <mcstar> how pointer ownership tracking works
[21:21:51] <Eridius> mcstar: you don't need to understand the theory of regions, you just need to know that the compiler will yell at you if you violate a lifetime ;)
[21:21:51] <Blei> mcstar: http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html maybe this?
[21:21:55] <mcstar> or what do you call that
[21:22:23] *** Joins: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de)
[21:22:29] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (Quit: victorporof)
[21:22:48] <mcstar> does that tell me the theory, how the algorithm works in the compiler
[21:22:49] <mcstar> ?
[21:22:58] <Blei> mcstar: also: http://pcwalton.github.io/blog/2013/04/12/a-hard-case-for-memory-safety/
[21:23:10] <kimundi> mcstar, it tells you how to use the borrowed pointers
[21:23:45] <Blei> also http://pcwalton.github.io/blog/2013/03/18/an-overview-of-memory-management-in-rust/
[21:24:37] <mcstar> thanks, ill read those when ill have the time, and ill get back with questions
[21:24:46] *** Quits: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org) (Ping timeout)
[21:25:01] <Blei> mcstar: maybe start with the last one i pasted
[21:25:08] <mcstar> k
[21:25:50] <kyle2000> is the std::rt::io::ReaderUtil trait meant to be used in user code? or does the std::rt mean it should only be used by the runtime?
[21:27:35] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[21:28:05] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[21:29:23] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[21:33:19] <mcstar> btw, is there a GUI binding for rust?
[21:33:31] <mcstar> preferably qt :P
[21:34:05] <kyle2000> mcstar: MaikKlein might know. he was talking earlier about using Qt Creator to make a rust IDE.
[21:34:41] <mcstar> i dont even know whether rust supports OO, does it?
[21:34:46] <MaikKlein> qt isn't possibly atm
[21:34:49] <MaikKlein> yes it does
[21:34:52] <MaikKlein> @ mcstar 
[21:35:04] <Blei> eh, parts of OO
[21:35:06] <MaikKlein> you mean zeroMq right?
[21:35:23] <mcstar> me? object orientation
[21:35:28] <MaikKlein> oh
[21:35:31] <MaikKlein> :D
[21:35:39] <MaikKlein> some parts of OO
[21:36:01] <mcstar> im just asking, whether a close 1-to-1 wrapper over qt would work
[21:36:16] <mcstar> because if not, then i dont see a binding int he near/far future
[21:36:20] <mcstar> -t
[21:37:03] <kyle2000> mcstar: unless it has changed recently, the lack of inheritance like in c++ or java or C# in rust really get me rustled up. i think it would be real difficult to make a mapping to Qt without better inheritance.
[21:37:43] <MaikKlein> i think there is already some work on
[21:37:44] <Blei> you can probably model quite a lot of OO/inheritance with traits, once default methods work
[21:37:45] <MaikKlein> hm
[21:37:46] <mcstar> kyle2000: nice choice of word
[21:37:50] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[21:38:04] <MaikKlein> gtk
[21:38:38] <mcstar> im only asking about Qt because that is the one im most familiar with
[21:38:41] <jensnockert> Is there a way to make custom attributes that I can #[cfg(???)] on?
[21:38:50] <mcstar> and it is high quality
[21:38:53] <kyle2000> gtk+ is an ugly api with an ugly implementation with an ugly ui. qt would provide a much more professional ui.
[21:39:08] <MaikKlein> i think its only grk
[21:39:09] <MaikKlein> gtk*
[21:39:09] <Blei> but, alas, moc
[21:39:13] <MaikKlein> not gtk+
[21:39:41] <MaikKlein> but I agree I am also used to Qt
[21:39:55] <Blei> there are qt bindings for other languages, so that should be possible
[21:39:56] <Luqman> jensnockert: `rustc --cfg foo` then you can do #[cfg(foo)]
[21:40:06] <jensnockert> Luqman: Thanks.
[21:40:09] <mcstar> Blei: i think they all support O fully
[21:40:12] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130612084701])
[21:40:12] <mcstar> OO*
[21:40:29] <mcstar> and most of the bindings are autogenerated
[21:40:35] <MaikKlein> http://qthaskell.berlios.de/
[21:40:42] <mcstar> well thats outdated
[21:41:04] <mcstar> for haskell you must use gtk
[21:41:10] <mcstar> and stay in IO
[21:41:39] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[21:41:56] <mcstar> well, except for the FRP solutions, built on that
[21:42:41] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: gnight)
[21:42:52] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130612084701])
[21:43:03] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[21:45:18] *** Quits: TimoT (timot@moz-524A8572.cust.telenor.se) (Client exited)
[21:46:14] *** Joins: TimoT (timot@moz-524A8572.cust.telenor.se)
[21:46:18] *** Parts: steven_is_false (steven@moz-144077DE.bchsia.telus.net) ()
[21:46:45] <MaikKlein> I think Qt bindings are possible, someone said that it is just not possible to generate them atm.
[21:47:03] *** Quits: TimoT (timot@moz-524A8572.cust.telenor.se) (Client exited)
[21:48:24] <kyle2000> to me, rust proves that anything is possible. it was not long ago, before i discovered rust, that i thought there were limits to what computers could do. but now that i've been rusting for some time, i know that if it can be imagined, it can probably be done using rust. rust is like the incredible hulk. thanks to scientific discovery we now have something with the power to crush rocks and break trees.
[21:48:45] <mcstar> MaikKlein: well, a binding might be possible, but you have to ask, how comfortable that binding is? it has to fit the compositional model of the language
[21:48:47] <kimundi> lol
[21:48:49] *** Quits: koomi (koomi@moz-B2B8B6D1.superkabel.de) (Quit: WeeChat 0.4.1)
[21:49:31] <mcstar> the subtle troll
[21:49:53] <MaikKlein> mcstar, I have absolutley no information about this, I just picked that up in the IRC.
[21:50:01] *** Quits: robert (robertknig@moz-C34822AC.range86-166.btcentralplus.com) (Ping timeout)
[21:50:49] <mcstar> MaikKlein: well, im just saying, there is a problem bridging OO and functional paradigms, for example, im not familiar enough with rust, but i can imagine similar impedance mismatches
[21:51:13] <mcstar> imagine the possibility*
[21:51:48] <cmr> mcstar: A Qt binding would be possible, but it wouldn't be idiomatic rust (not in its current incarnation at least) because of its different memory management semantics.
[21:51:56] <kyle2000> mcstar: i'm thinking those will be a big problem too. i've used python bindings for c++ libraries and even with python's oo support being closer to c++'s there were still some mismatches and the libraries didn't feel pythonic.
[21:52:14] <kyle2000> i think the situation would indeed be much worse with rust.
[21:52:26] <cmr> mcstar: If/when custom smartpointers are a thing it should be fine.
[21:52:26] <kyle2000> but i still think it could be done. i have faith in rust.
[21:52:39] <cmr> Smoke bindings could be written but it wouldn't be as fast.
[21:52:52] <cmr> Also they'd be a huge PITA to write :)
[21:53:23] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Client exited)
[21:53:40] *** Joins: mib_u3gbb8 (Mibbit@moz-CF8BEBEF.dia.static.qwest.net)
[21:53:51] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[21:53:58] <MaikKlein> btw if you are doing research about a library and you find out that the hompage looks like from the 90s, do you still want to use that library?
[21:54:00] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:54:11] <mcstar> you might
[21:54:12] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[21:54:18] <mcstar> if there are no alternatives, for example
[21:54:29] <cmr> Or if the documentation is *really* good
[21:54:29] *** Quits: mib_u3gbb8 (Mibbit@moz-CF8BEBEF.dia.static.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:54:39] <mcstar> also, look at the sites of most of CL software
[21:54:48] <cmr> fftw isn't very hot
[21:54:49] <MaikKlein> cl?
[21:54:53] <mcstar> common lisp
[21:55:13] <mcstar> you shouldnt jusdge the quality of the software from the site desing/quality
[21:55:20] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[21:55:24] <mcstar> and even, last update timestamp
[21:55:27] <mcstar> :)
[21:55:37] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[21:55:37] <MaikKlein> i think fttw looks still nice
[21:55:53] <cmr> mcstar: yeah that last one bit me a lot doing lua work. "this library hasn't been updated in 5 years!" but it works perfectly
[21:56:04] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[21:56:45] <orshem> i've failed for the third time to build rust today
[21:56:46] <MaikKlein> but when I see sth like this http://www.fltk.org/index.php
[21:56:47] <MaikKlein> :X
[21:56:53] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[21:57:13] <cmr> I don't think it's that bad
[21:57:14] <orshem> apparently i'm a canary butcher
[21:57:28] <cmr> orshem: what hardware do you have and how many threads?
[21:57:34] <MaikKlein> well I know that I judge too fast
[21:57:44] <orshem> it's a ubuntu vm with 4GB of ram
[21:57:48] <cmr> Some people have been getting a lot of those, I think it's about time someone did a metaanalysis ;)
[21:58:07] <orshem> i ran make without -j
[21:58:09] <cmr> orshem: where in compilation does it die, and can you reliably reproduce it?
[21:58:20] <cmr> (the tests run multithreaded even without -j)
[21:58:37] <orshem> i've 4 cores, 8 ht
[21:58:40] <orshem> i think
[21:58:54] <bjz> Jeaye: hoy
[21:59:17] <cmr> doener: https://github.com/mozilla/rust/pull/7186 fantastic!
[21:59:44] <orshem> cmr: i've already closed the terminal
[21:59:49] <mcstar> MaikKlein: fltk is perfectly alright i think
[21:59:51] <orshem> i'll run it again now and see
[22:00:06] *** Joins: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org)
[22:00:14] <mcstar> also, there is a poll wrt exactly this...
[22:00:20] <mcstar> you might want to fill it out :)
[22:00:49] <mcstar> 25% loves it as it is
[22:02:12] <MaikKlein> I think http://www.rust-lang.org/ is perfect
[22:02:24] <MaikKlein> i love minimalistic design
[22:02:51] <doener> cmr: Thanks! Finally http://huonw.github.io/isrustfastyet/ is moving in the right direction :-)
[22:02:55] <cmr> doener: yup :)
[22:03:02] <cmr> SiegeLord: ping
[22:03:31] <cmr> SiegeLord: unping, sorry :)
[22:05:09] <mcstar> hm, why does the win testsuite take so little time?
[22:05:17] <cmr> mcstar: see note on bottom
[22:05:22] <MaikKlein> lol how often did it recompile from 15th - 16th 
[22:05:28] <mcstar> sry :)
[22:05:37] <MaikKlein> "The Windows tests are much faster because it runs a stripped down check-fast testsuite."
[22:05:40] <cmr> MaikKlein: that's today still. lots of PRs landed! :D
[22:05:48] <MaikKlein> oh right
[22:05:48] <MaikKlein> :D
[22:06:00] <MaikKlein> oh nice it's 17th now, at least in germany
[22:06:13] <MaikKlein> today is the rust talk right?
[22:06:19] <cmr> The tree has been on fire the past week, so not much work happened
[22:06:34] <cmr> Oh yeah, look at that
[22:06:47] <cmr> 23000UTC I think?
[22:06:49] <mcstar> is there a bot here with which i can leave messages?
[22:07:19] <cmr> mcstar: like a notepad? no
[22:07:27] <mcstar> no, messages, not notes
[22:07:33] <mcstar> to other ppl
[22:07:35] <cmr> messages for people?
[22:07:39] <cmr> oh, I dojn't think so, not sure
[22:07:41] <mcpherrin> There's a memoserv on the network
[22:07:57] <MaikKlein> at least all messages are recorded
[22:08:07] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[22:08:10] <MaikKlein> oh no rustprism
[22:08:16] <MaikKlein> jk
[22:09:00] *** Joins: koomi (koomi@moz-9AE5526E.pools.arcor-ip.net)
[22:09:22] *** Joins: brson (brson@5F06B402.AD1E507F.3688B332.IP)
[22:09:22] *** ChanServ sets mode: +o brson
[22:10:09] *** Quits: KindOne (KindOne@87162786.9C5C45A3.EC6A1518.IP) (Ping timeout)
[22:10:13] *** Joins: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP)
[22:10:42] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[22:11:58] *** Joins: KindOne (KindOne@87162786.9C5C45A3.EC6A1518.IP)
[22:11:59] *** Joins: jaen (jaen@moz-8F4F68E6.play-internet.pl)
[22:12:09] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[22:14:23] *** Quits: MaikKlein (maik@moz-85462C98.dip0.t-ipconnect.de) (Ping timeout)
[22:15:10] <kyle2000> are there any functions in the rust libraries for converting between big and little endianness? like the hton* functions in C? i'm seeing some in std::io::ReaderUtil, but it's like really excessive to have to get writers and readers involved, and i don't want to write them myself if they already exist.
[22:15:15] *** Joins: Alperrr (SohbetNet@59EAD3F6.FE07172A.AAC341FF.IP)
[22:16:55] <cmr> kyle2000: to_bytes
[22:17:08] <cmr> http://static.rust-lang.org/doc/std/to_bytes.html
[22:17:34] <cmr> Although that doesn't let you reconstruct a new value I guess
[22:19:43] <kyle2000> cmr: yeah they looked promising but i want to read in a u32 that i know is big endian from a reader using ReaderUtil's read_be_u32() but then convert it to a host-endian u32.
[22:20:04] <cmr> kyle2000: read_be_u32 converts it for you
[22:21:11] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Ping timeout)
[22:22:11] <jensnockert> kyle2000: I am currently adding it to std.
[22:22:58] <cmr> jensnockert: am I wrong? or do you mean apart from io
[22:23:06] <jensnockert> cmr: Apart from IO.
[22:23:26] <SimonSapin> In a parser, is ((char) -1) and acceptable way to represent "no character because EOF was reached", or should I really use Option<char>?
[22:23:39] <jensnockert> kyle2000: You can define something like https://gist.github.com/jensnockert/5f6378286aacf96a9044 and it will work alright.
[22:23:54] <SimonSapin> (char being 32 bit, -1 falls outside of Unicode)
[22:24:05] <cmr> SimonSapin: you need to use Option<char>, "-1 as char" is invalid.
[22:24:07] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:24:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/JqFLqg
[22:24:07] <ghrust> 13rust/06auto 14a6bc5dd 15Brian Anderson: More 0.7 release notes
[22:24:07] <ghrust> 13rust/06auto 14a4cc34f 15bors: auto merge of #7165 : brson/rust/releasenotes, r=thestinger
[22:24:07] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:24:44] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130612084701])
[22:25:29] *** Quits: doomlord1 (walter@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[22:28:12] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[22:28:13] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (Z:lined (Open Proxy found on your host. Please visit www.blitzed.org/proxy?ip=115.68.131.49 for more information.))
[22:30:09] <cmr> rusti: -1 as char
[22:30:10] -rusti- rust: task failed at 'assertion failed: s.len() <= pad', /build/rust-git/src/rust/src/libstd/char.rs:211
[22:30:10] -rusti- rust: domain main @0x7f9b3cc1f810 root task failed
[22:30:10] -rusti- application terminated with error code 101
[22:30:26] <cmr> And it fails now too!
[22:30:38] <cmr> Not.. the greatest failure, but at least it won't accept invalid program
[22:35:06] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[22:35:39] <kyle2000> jensnockert: thanks i will check that out.
[22:37:11] *** Quits: SimonSapin (simon@moz-73287A57.zone9.bethere.co.uk) (Ping timeout)
[22:38:07] <cmr> jensnockert: do you also convert io to use those? the current code is very slow and entirely endian-generic, rather than optimizing for the target endianness
[22:38:25] <jensnockert> cmr: I could.
[22:38:32] <jensnockert> cmr: Haven't really considered that.
[22:38:54] <jensnockert> cmr: I just wanted my silly uuid library to not have to include byte-swapping code.
[22:38:57] *** Parts: Eleeleth (anthony@moz-87BA63DD.me) ()
[22:39:29] *** Quits: Alperrr (SohbetNet@59EAD3F6.FE07172A.AAC341FF.IP) (Quit: ..)
[22:39:41] *** Joins: Voomer (Voomer@moz-E97E8EB7.br.br.cox.net)
[22:40:28] *** Quits: pnkfelix|rcirc (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[22:41:59] <Jesse> cmr: converting u32 to char should be a library function rather than an "as" expression, so it's clear you're doing something that can fail (or return None)
[22:43:17] *** Quits: jaen (jaen@moz-8F4F68E6.play-internet.pl) (Quit: WeeChat 0.4.1)
[22:43:23] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[22:43:34] <Jesse> cmr: btw does char reject surrogates? i think it should, because it doesn't make sense to append a surrogate to a str
[22:43:41] <engla> cmr: -1 as char only fails in the printing part
[22:43:55] <engla> rusti:  let c = -1 as char; ~"hi"
[22:43:56] -rusti- ~"hi"
[22:44:56] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[22:44:57] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Client exited)
[22:45:17] <orshem> cmr: third time the charm. now it worked. weird.
[22:45:36] <kimundi> Jesse: What do you mean with surrogates?
[22:45:39] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[22:45:44] <engla> rusti: std::str::from_char(-1 as char)
[22:45:46] -rusti- ~"\U7fffffff"
[22:45:47] <kimundi> A char is an unicode codepoint
[22:46:29] <engla> rusti: std::str::from_char(255 as char)
[22:46:31] -rusti- ~"\xff"
[22:46:39] <engla> that's another hole in the "utf-8 only" armor
[22:46:50] <kimundi> howso?
[22:47:18] <engla> the string ~"\U7fffffff"
[22:47:25] <kimundi> ah, yeah
[22:47:45] <engla> yeah sorry the 255 is fine
[22:48:03] <Jesse> kimundi: surrogates only make sense as the u16 values in a UTF-16 array
[22:48:27] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[22:48:46] <engla> I guess the code accepts 6-byte encodings in utf-8 deliberately
[22:48:49] <Aetherspawn_BNC> HSA stuff is out: http://hsafoundation.com/hsa-developer-tools/
[22:48:54] <engla> even though it's an extension to the standard
[22:49:06] <Aetherspawn_BNC> great llvm support, devs should consider what is required to make rust compatible.
[22:49:12] <Jesse> hmm https://en.wikipedia.org/wiki/UTF-8#Invalid_code_points
[22:50:04] <Thiez> r? https://github.com/mozilla/rust/pull/7193
[22:50:05] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[22:50:41] *** Quits: brson (brson@5F06B402.AD1E507F.3688B332.IP) (Ping timeout)
[22:52:51] *** Joins: jga (asdf@114D2B3A.FB5B5D5.B5524284.IP)
[22:53:03] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:53:09] *** Quits: orshem (orshem@3545E24A.588A166C.E3D28531.IP) (Quit: Leaving)
[22:54:26] <Jeaye> bjz: I have to use #[link_args="-lX11 -lXrandr -lXi -lXxf86vm"] in my code to get glfw linking on Linux; this should probably just be in glfw-rs.
[22:56:16] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[22:56:44] <cmr> Aetherspawn_BNC: Nice!
[22:58:39] <cmr> Aetherspawn_BNC: As long as it has LLVM-IR to HSAIL as part of LLVM itself, it should be trivial to add.
[22:58:51] <cmr> Although it might need platform support in the stdlib and runtime
[23:00:03] <cmr> Aetherspawn_BNC: Some slides claim one of HSAIL's goals is full C++ support, so it might be even easier than I guessed
[23:01:10] <jensnockert> I think it needs std support, but it would be awesome if we added it.
[23:03:45] <Aetherspawn_BNC> imo get the shootout stuff up faster
[23:04:06] <Aetherspawn_BNC> and then it becomes official that rust exists :P
[23:04:22] <cmr> Aetherspawn_BNC: I'm working on a benchmark runner for isrustfastyet as we speak :)
[23:04:56] <Thiez> cmr: might you be interested in adding rustray to those benchmarks?
[23:05:01] <Aetherspawn_BNC> cmr: ooh, goodie
[23:05:09] <cmr> Thiez: Absolutely, I was thinking about that last night, thanks for reminding me
[23:05:31] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[23:05:33] <Thiez> I've been using that as a benchmark myself :)
[23:05:37] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[23:08:12] <cmr> Thiez: building your branch, will test binarytrees
[23:09:53] <Thiez> cmr: nice, thanks
[23:12:09] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[23:12:09] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JqFLqg
[23:12:09] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[23:12:41] <dpc> Is it me that does not know how to use rustpkg or is it not really working yet?
[23:12:48] <cmr> dpc: both, probably.
[23:13:14] <cmr> dpc: it doesn't work like I (and you, probably) would expect it to, building the thing in current directory
[23:13:30] <cmr> dpc: https://github.com/mozilla/rust/blob/master/doc/rustpkg.md
[23:13:58] <dpc> cmr: I've seen this document and I think it's pretty bad. :D
[23:14:11] <dpc> But I also think that I kind of grasp the conception.
[23:14:31] <dpc> Though rustpkg does not seem to work with many small problems.
[23:14:43] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.1)
[23:14:45] <cmr> dpc: it's still heavily wip. I'm sure tjc would love constructive feedback though
[23:15:08] *** Joins: steven_is_false (steven@moz-144077DE.bchsia.telus.net)
[23:15:09] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[23:15:09] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/o6yGlg
[23:15:09] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[23:15:17] <dpc> The document is written from the perspective of some that already knows how rustpkg should work.
[23:15:30] <dpc> That's the biggest problem with it.
[23:15:33] <cmr> It's a reference manual, not an introduction.
[23:15:47] *** Joins: blitter (blitter@moz-FB45689C.dyn.centurytel.net)
[23:17:00] <dpc> Indeed. But reference manual could explain the basic concepts too, I think. :)
[23:18:01] <dpc> OK. So to the point. How do I make my program use some libarary that is sitting as *.so in some other directory?
[23:18:13] <dpc> rustc "-L../rust-sdl/" -o rustyhex main.rs
[23:18:16] <dpc> Is this OK?
[23:18:31] <cmr> rustc -L ../rust-sdl should work, but yes
[23:18:54] *** Joins: steven_is_false1 (steven@moz-144077DE.bchsia.telus.net)
[23:18:58] *** Quits: steven_is_false (steven@moz-144077DE.bchsia.telus.net) (Quit: Leaving.)
[23:19:06] <dpc> main.rs:1:0: 1:0 error: can't find crate for `std`
[23:19:42] <cmr> 1.31054ms of overhead in my benchmark mainloop, not bad
[23:20:22] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[23:21:13] *** Quits: kyle2000 (kyle2000@6EDB4D7A.341FCD98.3031298E.IP) (Quit: Leaving)
[23:21:17] <dpc> What's with this `std` create? :-/
[23:21:31] <cmr> dpc: that would be the stdlib. what version of rust are you using?
[23:21:43] <dpc> Yesterday's master.
[23:22:06] <cmr> dpc: is there a libstd*.so somewhere in your LD_LIBRARY_PATH/ldconfig'd path?
[23:22:10] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[23:22:10] *** ChanServ sets mode: +o brson
[23:22:32] <cmr> brson: Aetherspawn_BNC had/has some questions about the scheduler
[23:22:37] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:22:39] <dpc> Yes.
[23:22:48] <cmr> dpc: dunno what to say then, sorry :(
[23:22:54] <dpc>  /home/dawidc/opt/lib/libstd-6c65cf4b443341b1-0.7-pre.so
[23:23:11] <dpc>  /opt/ati-stream-sdk-v2.3-lnx64/lib/x86_64/:/home/dawidc/opt/lib
[23:23:51] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[23:24:06] <Aetherspawn_BNC> brson: does IO yielding work yet or is that a todo
[23:24:55] <cmr> Thiez: https://gist.github.com/cmr/79787e30d9adc0d213f8 is that the expected output?
[23:27:23] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[23:29:08] <Thiez> cmr: I think that is correct.
[23:30:06] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[23:32:22] <Thiez> cmr: yes, it looks like http://benchmarksgame.alioth.debian.org/u64/program.php?test=binarytrees&lang=gpp&id=6#log
[23:33:17] *** Joins: hjr3 (hradtke@moz-4717ACAE.lsanca.dsl-w.verizon.net)
[23:36:03] <cmr> Thiez: yay :)
[23:36:04] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Ping timeout)
[23:36:08] <steven_is_false1> What does everyone think of turning -W unused-import up to deny for the compiler?
[23:36:41] <cmr> steven_is_false1: acrichto has a PR for turning all of the warnings to deny for the compiler
[23:37:20] <steven_is_false1> cmr: That isn't possible for the unneeded unsafe warning though right?
[23:38:09] <cmr> It's actually just for the stdlib, my bad
[23:38:12] <cmr> https://github.com/mozilla/rust/pull/7113/files
[23:38:24] <aatch> steven_is_false1, don't like it.
[23:38:26] <steven_is_false1> cmr: Okay, well that's a start
[23:38:41] <aatch> for the compiler you get too much staged stuff.
[23:38:56] <aatch> and it's a much bigger hassle to deal with.
[23:38:56] <steven_is_false1> aatch: Okay.
[23:39:05] <aatch> I'm just one guy though.
[23:39:15] <cmr> aatch: adding a #[cfg(stage0)] etc isn't a big deal
[23:39:18] <brson> Aetherspawn_BNC: what are you thinking of by 'io yielding'? if you mean preemption, then no, and it isn't currently planned
[23:39:19] <cmr> I'm in favor of it
[23:39:33] <Aetherspawn_BNC> brson: I mean if I use tcp blocking read
[23:39:35] <cmr> also just one guy :)
[23:39:38] <Aetherspawn_BNC> am I gonna lose a whole task worker?
[23:40:05] <aatch> Aetherspawn_BNC, I think you have the wrong idea of the way rust tasks work.
[23:40:20] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[23:40:22] <brson> Aetherspawn_BNC: if you use the new scheduler and the preliminary tcp code in std::rt::io::net::tcp then it will not block a thread
[23:40:43] <Aetherspawn_BNC> ah gotcha, I'll go look at the new tcp stuff then :)
[23:40:45] <brson> Aetherspawn_BNC: there's a lot of work to do still before it's usable though
[23:41:22] <brson> Aetherspawn_BNC: by io branch currently is about a month ahead of master too
[23:41:37] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[23:43:31] <Thiez> brson: r+? https://github.com/mozilla/rust/pull/7193
[23:47:41] *** Quits: hjr3 (hradtke@moz-4717ACAE.lsanca.dsl-w.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[23:53:02] *** Joins: arink (arink@moz-39BF9408.hsd1.or.comcast.net)
[23:53:11] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[23:54:31] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[23:55:11] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Write error: Connection reset by peer)
[23:55:17] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[23:56:26] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[23:58:46] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Ping timeout)
[23:59:18] *** Quits: KindOne (KindOne@87162786.9C5C45A3.EC6A1518.IP) (Ping timeout)
