[00:03:29] *** Joins: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[00:03:29] *** ChanServ sets mode: +qo brson brson
[00:05:01] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[00:05:22] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[00:05:40] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[00:05:40] *** ChanServ sets mode: +ao pcwalton pcwalton
[00:06:06] *** Quits: glaebhoerl (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP) (Ping timeout)
[00:07:03] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[00:14:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:16:20] <acrichto> ugh my up-down-enter rampage keeps getting me to shut off my vms instead of ssh into them
[00:16:54] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[00:20:04] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[00:25:13] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[00:26:31] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[00:26:31] <ghrust> [13rust] 15bors 04force-pushed 06auto from 149c10883 to 14c24946e: 02http://git.io/N3iJvQ
[00:26:31] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[00:26:32] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[00:26:32] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/9bwdJg
[00:26:32] <ghrust> 13rust/06auto 147e85431 15Gary M. Josack: Remove references to guide-conditions...
[00:26:32] <ghrust> 13rust/06auto 143b09469 15bors: auto merge of #12539 : gmjosack/rust/master, r=alexcrichton...
[00:26:32] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[00:45:01] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Ping timeout)
[00:45:32] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[00:45:32] *** ChanServ sets mode: +ao pcwalton pcwalton
[00:46:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:03:33] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[01:08:44] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[01:10:46] *** Quits: Jesse (jruderman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Connection reset by peer)
[01:11:09] *** Joins: Jesse_ (jruderman@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[01:13:10] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[01:13:10] *** ChanServ sets mode: +ao pcwalton pcwalton
[01:14:18] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Ping timeout)
[01:14:42] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[01:14:42] *** ChanServ sets mode: +o tjc
[01:16:39] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:27:31] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:27:43] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[01:29:13] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[01:36:32] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[01:36:32] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/9bwdJg
[01:36:32] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[01:41:33] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[01:41:33] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/BL7OVA
[01:41:33] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[01:41:34] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[01:41:34] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/iDio4g
[01:41:34] <ghrust> 13rust/06auto 14294b27d 15Alex Crichton: Update LLVM...
[01:41:34] <ghrust> 13rust/06auto 142e1cfae 15bors: auto merge of #12548 : alexcrichton/rust/up-llvm, r=huonw,brson...
[01:41:34] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[01:42:36] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[01:48:29] *** kimundi is now known as zz_kimundi
[01:57:25] *** Quits: mawuli (mawuli@moz-36C70B7D.com.gh) (Ping timeout)
[01:57:41] *** Joins: mawuli (mawuli@moz-36C70B7D.com.gh)
[02:03:02] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[02:05:25] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140224030203])
[02:27:10] *** Joins: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[02:28:58] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[02:30:17] *** Quits: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Ping timeout)
[02:34:21] *** Quits: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[02:35:22] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[02:35:22] *** ChanServ sets mode: +ao pcwalton pcwalton
[02:54:21] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[02:56:30] *** Quits: mawuli (mawuli@moz-36C70B7D.com.gh) (Ping timeout)
[02:56:52] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[03:01:48] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: Textual IRC Client: www.textualapp.com)
[03:01:50] *** Joins: angdev (angdev@16F167B.4C57D258.D8E8354F.IP)
[03:02:13] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[03:07:03] *** Quits: zz_kimundi (kimundi@moz-75FC8F5B.dip0.t-ipconnect.de) (Ping timeout)
[03:10:31] *** Joins: zz_kimundi (kimundi@moz-66E7D193.dip0.t-ipconnect.de)
[03:10:33] *** zz_kimundi is now known as kimundi
[03:16:32] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[03:16:32] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/iDio4g
[03:16:32] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[03:18:33] *** Joins: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[03:20:31] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[03:21:34] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[03:21:34] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/NRmZeg
[03:21:35] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[03:27:46] *** Joins: geoffhill (geoffhill@moz-95FF7399.members.linode.com)
[03:29:11] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[03:31:37] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:42:38] *** Joins: newbie (kvirc@moz-E97035B0.dip0.t-ipconnect.de)
[03:52:56] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:52:56] *** ChanServ sets mode: +ao dherman dherman
[03:53:42] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[03:53:42] *** ChanServ sets mode: +o tjc
[03:53:49] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[03:53:56] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Quit: Leaving)
[03:56:29] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[03:58:44] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[03:58:44] *** ChanServ sets mode: +o tjc
[04:00:17] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[04:00:17] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:01:53] *** erickt is now known as wild_erickt
[04:02:25] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[04:04:58] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[04:10:29] *** Quits: wild_erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Ping timeout)
[04:10:50] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[04:11:55] *** Joins: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[04:12:09] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Quit: Sharp)
[04:14:08] *** Quits: Jesse_ (jruderman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: Jesse_)
[04:14:15] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:29:41] *** Quits: cgaebel (clark@moz-8E0C6BCA.nyc.res.rr.com) (Ping timeout)
[04:31:29] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[04:31:29] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/mks2kQ
[04:31:29] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[04:31:42] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[04:31:42] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:34:44] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[04:35:10] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[04:36:30] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[04:36:30] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/O_WSmA
[04:36:30] <ghrust> 13rust/06auto 1482747ed 15Jag Talon: tutorial: clearer explanation of freezing....
[04:36:30] <ghrust> 13rust/06auto 143216df8 15bors: auto merge of #12547 : jagtalon/rust/jag/rust/tutorial-freezing, r=pnkfelix...
[04:36:30] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[04:36:33] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[04:36:33] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/_zwYfg
[04:36:33] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[04:40:19] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[04:41:02] *** Quits: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw) (Ping timeout)
[04:41:07] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[04:44:44] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[04:45:06] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[04:51:18] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[05:09:22] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[05:09:53] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[05:15:17] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[05:17:39] *** Quits: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw) (Ping timeout)
[05:21:31] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[05:24:39] *** Quits: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[05:32:05] *** Joins: lpy (lpy@665181D6.D58093C6.8C13C571.IP)
[05:47:47] *** Quits: geoffhill (geoffhill@moz-95FF7399.members.linode.com) (Quit: )
[05:54:07] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Quit: huon)
[05:54:20] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[06:00:41] *** Joins: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP)
[06:01:41] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:04:24] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[06:04:24] *** ChanServ sets mode: +o tjc
[06:04:33] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[06:07:10] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:15:41] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[06:15:42] *** ChanServ sets mode: +o tjc
[06:21:03] <huon> nrc: btw, there's an issue about allowing `Foo { x: 1, .. y }` for any type y, as long as the fields of y have the same name and same type as fields from Foo
[06:21:41] <huon> which seems like it would work with what jdm suggests. (Saying it here rather than on the PR, because I can't find the issue)
[06:22:30] <nrc> huon: as in a subset of the fields of Foo?
[06:23:10] <nrc> that seems like a natural extension to the current situation
[06:23:40] <huon> yes
[06:24:21] <huon> (e.g., Foo { x: int, y: int, z: int} can be FSU'd from a Bar { y: int }, but not a Baz { y: int, w: f64 }.)
[06:25:02] <nrc> cool, having thought about it for a few minutes, I think that is the way to solve this, rather than anything special for super-structs
[06:26:26] <nrc> I might go further and say you can drop fields too. I.e., as long as the union of the specified fields and fields of the sub-expr are a super-set of the fields of the struct, then you are good
[06:34:26] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:36:10] *** Quits: lpy (lpy@665181D6.D58093C6.8C13C571.IP) (Client exited)
[06:43:31] <edwardw> r? https://github.com/mozilla/rust/pull/12563
[06:44:47] <huon> edwardw: you'll need to wait for jbclements' feedback on that one
[06:44:57] <edwardw> huon: sure
[06:44:59] <huon> (he implemented the current hygiene system, and may have some quibbles)
[06:45:09] <huon> awesome work, thought \o/
[06:45:13] <huon> *though
[06:45:15] <edwardw> hehe
[06:46:14] <edwardw> replacing @@ with Rc<RefCell<SomeType>> does make sense, doesn't it?
[06:47:05] <huon> @@ o_O?
[06:47:15] *** Joins: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[06:47:17] <huon> theoretically that could be replaced by Rc<...>
[06:47:29] <huon> (since it apparently doesn't need inner mutability)
[06:47:48] <edwardw> ah, I'm not aware of that
[06:47:50] <huon> but yeah, replacing it+++++
[06:48:20] <edwardw> (mtwt code used to have some @@)
[06:48:44] *** flaper87|afk is now known as flaper87
[06:48:47] <huon> I guess that probably used to be @mut @ or @@mut or something else slightly more sensible, but then got changed in the great de-@-muting
[06:49:27] <edwardw> I see, it is so weird in first glance
[06:50:06] <huon> it's weird at the n-th glance (for all n>=0) :P
[06:50:56] <edwardw> LOL
[06:52:46] *** Joins: glaebhoerl (glaebhoerl@moz-3590251D.kabelnet.hu)
[07:00:20] *** Quits: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[07:02:20] *** Joins: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[07:03:53] *** Quits: erickt (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[07:04:56] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[07:06:05] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[07:08:38] <eddyb> https://xkcd.com/now this solves all my timezone problems!
[07:10:39] <nrc> <3
[07:10:44] <edwardw> brilliant!
[07:10:44] <nrc> although it seems to be wrong
[07:10:52] <huon> it's right for me?
[07:11:10] <nrc> it says 6pm for NZ, but it is 8pm
[07:11:16] <nrc> I wonder if it is DST issues
[07:11:35] <huon> nrc: read the "new zealand" label in the outer ring
[07:11:42] <eddyb> NZ is at 8pm
[07:11:47] <huon> the map seems to not line up exactly
[07:11:53] <nrc> ah, ok, I was just going on the picture
[07:11:54] <edwardw> NZ is 8pm
[07:12:12] <nrc> I wonder if it will change with DST...
[07:12:43] <nrc> like southern hemisphere countries should change position relative to northern hemisphere ones
[07:13:26] <huon> heh, the countries warp the map as they go in and out of DST
[07:14:22] <nrc> are you anticipating? 
[07:14:24] *** Joins: lpy (lpy@665181D6.D58093C6.8C13C571.IP)
[07:14:37] * huon is hopinh
[07:14:39] <huon> g
[07:14:46] <nrc> ah
[07:14:51] <nrc> me too :-)
[07:15:04] <ChrisMorgan> huon: what, don't you think we're warped enough already?
[07:19:16] *** Joins: Jesse (jruderman@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[07:19:20] *** Joins: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[07:19:20] *** ChanServ sets mode: +qo brson brson
[07:22:35] *** Quits: angdev (angdev@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[07:23:22] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[07:23:32] *** Joins: newbie82 (kvirc@moz-98A4B5CB.dip0.t-ipconnect.de)
[07:23:37] <eddyb> http://huonw.github.io/isrustfastyet/mem/#2fe7bfe,8d6fef6 that looks like 20MB, but slower
[07:23:49] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[07:23:52] <eddyb> (though speed differences don't really matter because of the CPU jitter)
[07:24:06] *** Quits: newbie (kvirc@moz-E97035B0.dip0.t-ipconnect.de) (Ping timeout)
[07:25:09] *** Quits: lpy (lpy@665181D6.D58093C6.8C13C571.IP) (Ping timeout)
[07:28:57] *** Joins: lpy (lpy@665181D6.D58093C6.8C13C571.IP)
[07:31:38] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[07:31:38] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/oJ9c8g
[07:31:38] <ghrust> 13rust/06auto 1482747ed 15Jag Talon: tutorial: clearer explanation of freezing....
[07:31:38] <ghrust> 13rust/06auto 146c41f99 15bors: auto merge of #12547 : jagtalon/rust/jag/rust/tutorial-freezing, r=pnkfelix...
[07:31:38] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[07:35:22] *** Quits: Jesse (jruderman@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: Jesse)
[07:36:48] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[07:36:51] *** Quits: brson (brson@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Ping timeout)
[07:40:38] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[07:46:00] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[07:46:11] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[07:54:18] *** Quits: lpy (lpy@665181D6.D58093C6.8C13C571.IP) (Client exited)
[07:57:47] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[07:57:47] *** ChanServ sets mode: +ao pcwalton pcwalton
[08:04:31] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[08:04:56] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Quit: canhtak)
[08:05:28] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[08:06:02] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Quit: Sharp)
[08:07:59] *** Quits: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP) (Quit: Leaving...)
[08:20:55] *** Joins: mawuli (mawuli@moz-C2456CD.com.gh)
[08:25:36] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:31:22] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[08:33:48] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[08:34:04] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[08:34:04] *** ChanServ sets mode: +ao pcwalton pcwalton
[08:34:29] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[08:37:15] <eddyb> nmatsakis: I think I've figured out how to implement returning anonymous types, bound by iterators, with a minimal impact on the type system
[08:41:43] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[08:41:45] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:41:49] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[08:42:13] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[08:43:39] <eddyb> s/iterators/traits/
[08:43:53] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[08:46:41] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[08:46:41] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/oJ9c8g
[08:46:41] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[08:46:48] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[08:56:06] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[08:56:08] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Connection reset by peer)
[08:58:50] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[09:03:48] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:06:51] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[09:09:16] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[09:09:17] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Ping timeout)
[09:09:48] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:12:37] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[09:14:18] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[09:14:57] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[09:15:15] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[09:21:39] <flaper87> acrichto: lol! that's what I can GH's race-condition
[09:22:31] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[09:45:12] *** Quits: mawuli (mawuli@moz-C2456CD.com.gh) (Client exited)
[10:03:07] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[10:04:03] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[10:14:23] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:17:54] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[10:20:32] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[10:22:14] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[10:30:21] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[10:37:37] *** Joins: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de)
[10:38:38] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140225030201])
[10:56:35] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:58:30] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[10:59:55] *** eddyb is now known as grumpy_eddyb
[11:09:17] *** grumpy_eddyb is now known as eddyb
[11:21:17] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[11:23:48] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[11:23:50] *** Joins: meTaAU (admin@moz-4768FEFF.lns20.per1.internode.on.net)
[11:24:00] <eddyb> time to revert a lot of this *sigh* https://github.com/mozilla/rust/pull/12403/files
[11:24:38] <huon> eddyb: o_O why?
[11:25:09] <eddyb> huon: I've removed method_map_entry there, because it had only method_origin
[11:25:26] <eddyb> but now I have to add it back for it to hold a few more things
[11:25:28] <huon> oh, and you need it again for deref?
[11:25:47] <eddyb> for removing callee_id which helps with auto-deref
[11:38:06] *** Quits: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de) (Ping timeout)
[11:39:14] <eddyb> nmatsakis: is there any problem with moving the method_map to ty::ctxt, instead of dragging it around?
[11:40:13] <eddyb> there's like 5 passes holding a method_map alongside tcx
[11:50:21] <huon> cmr, eddyb: http://huonw.github.io/isrustfastyet/mem/#c9864ce,2fa7d6b,c6aaf2c,f8893ed unfortunately it's not perfectly consistent
[11:51:03] <eddyb> yeah, I don't know what's up with that
[11:57:39] *** Joins: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de)
[12:22:08] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[12:26:19] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[12:28:28] <eddyb> oh dear, debuginfo uses callee_id for scope maps
[12:28:51] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[12:29:35] <eddyb> ah, no, it's just auxiliary
[12:31:55] <eddyb> git rebase --onto parent/master HEAD~1 HEAD
[12:32:09] <eddyb> <3
[12:57:20] <Yurume> from Reddit:
[12:57:21] <Yurume> https://gist.github.com/anonymous/9217762#comment-1180084
[12:57:39] <Yurume> the first error message from this comment is quite misleading
[12:58:08] <Yurume> since one has to add `'static` bound to the function or impl, not the value or trait object type.
[12:58:10] <eddyb> you mean flan3002 from IRC
[12:58:12] <Yurume> yeah
[12:58:31] <Yurume> but I answered that in Reddit, so... :)
[12:58:55] <Yurume> "add `'static` bound to the type variable `T`" may be helpful
[13:00:13] <Yurume> hmm... check_durable already accepts `ty` anyway, so it might be simple
[13:02:13] <eddyb> why does LLVM have to change so much so often >_>?
[13:02:26] <eddyb> and I bet it will rebuild when I switch to the deref branch
[13:02:57] <Yurume> klutzy: I think you have another LLVM patch, don't you?
[13:03:29] <huon> do you have ccache?
[13:03:44] <eddyb> Yurume: (‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚îª
[13:04:21] <eddyb> huon: can I setup LLVM to use ccache without reconfiguring?
[13:04:58] <huon> ccache can be a global thing that just magically makes your C compilers do less work
[13:05:09] <huon> https://github.com/mozilla/rust/wiki/Note-ccache
[13:06:08] <eddyb> the bashrc method looks good :D
[13:06:25] <eddyb> or I could use ~/bin but it's filling up already
[13:06:46] <eddyb> 49 random scripts I've thrown in there
[13:08:08] <eddyb> pnkfelix: thank you :D https://github.com/mozilla/rust/issues/5121
[13:08:31] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[13:10:53] <eddyb> readlink (which gcc)
[13:10:54] <eddyb> /usr/bin/ccache
[13:11:26] <eddyb> though I'm guessing it won't have any visible effect until I have to recompile
[13:12:22] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Ping timeout)
[13:15:38] <pnkfelix> hmm, something's gone wrong with our make files, `make -j8` has started acting screwy on me again while `make -j1` works
[13:15:47] <eddyb> crap
[13:15:55] <pnkfelix> (... but do I bother trying to debug this, or just live with -j1 ...)
[13:16:03] *** Joins: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca)
[13:16:10] <eddyb> how do I make the current commit the HEAD of a branch?
[13:16:23] <ChrisMorgan> eddyb: git checkout branch-name
[13:16:28] <eddyb> the other way around
[13:16:31] * ChrisMorgan isn't quite clear what eddyb means
[13:16:47] <eddyb> overwrite branch with HEAD
[13:16:49] <ChrisMorgan> Ah. `git branch -D branch-name && git checkout -b branch-name` works.
[13:16:56] <eddyb> :S
[13:16:57] <eddyb> mkay
[13:16:59] <ChrisMorgan> Not sure if there's a better way.
[13:17:04] <ChrisMorgan> Oh, and that'll mess up the upstream setting.
[13:17:10] <eddyb> I don't have those
[13:17:29] <ChrisMorgan> So next time you try pushing, it'll say "did you mean git push --set-upstream-to origin branch-name?" or some such thing.
[13:17:31] <eddyb> I use git gui which has good defaults for pushing
[13:17:49] <huon> `git reset --hard REV` when branch-name is checked out
[13:17:54] <ChrisMorgan> I mean, seriously‚Äîit says "you meant this", and doesn't then *do* it for you.
[13:18:07] <pnkfelix> ChrisMorgan: Its what I do, but from looking at the man page now, maybe `git checkout -B branch-name` is better
[13:18:18] <eddyb> apparently rebase --onto really wants a branch name
[13:18:23] * ChrisMorgan abhors the way things like `git reset` and `git checkout` each do several wildly different things
[13:18:39] <eddyb> I used HEAD as its last argument and it left me in detached head state. much fun
[13:18:43] * ChrisMorgan isn't much of a fan of git, having tasted the nectar of hg
[13:18:53] *** Joins: angdev (angdev@16F167B.4C57D258.D8E8354F.IP)
[13:18:54] <ChrisMorgan> HEAD is defined by where you are.
[13:18:59] <doener> eddyb: git branch -f $name
[13:19:20] <doener> eddyb: "recreates" branch head name to point at the same commit that HEAD points to
[13:19:27] <Zr40> I'm glad my company got rid of hg half a year ago
[13:19:37] <Zr40> I for one don't miss hg's multiple head madness
[13:19:44] <eddyb> hydra?
[13:20:09] <eddyb> doener: thanks :D
[13:20:58] <pnkfelix> eddyb: ah, you didn't want to make branch-name be the current branch in the process?
[13:21:09] <eddyb> well, it already was
[13:21:26] * ChrisMorgan avoids taking the passing dog by the ear ;-)
[13:21:40] <eddyb> so I originally did `git rebase --onto parent/master HEAD~1 HEAD`
[13:21:50] <eddyb> when I should've done `git rebase --onto parent/master HEAD~1 kill-callee-id`
[13:22:58] * eddyb twiddles thumbs while LLVM compiles
[13:23:29] <eddyb> pnkfelix: wait, git gui still thinks I'm in detached head mode :(
[13:23:47] <pnkfelix> eddyb: sorry, I don't know git gui
[13:24:00] <eddyb> it's like a HUD for git :P
[13:24:06] <pnkfelix> eddyb: I would suggest doing `git checkout -b a-fresh-name`
[13:24:12] <eddyb> okay, so I still had to check out the branch
[13:24:18] <pnkfelix> to at least give your detached head a name to work with
[13:24:37] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[13:24:39] <eddyb> now it's back to normal
[13:24:50] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[13:25:08] * ChrisMorgan has not seen a Git GUI that actually does what is needed and makes it sufficiently easier
[13:25:40] <ChrisMorgan> Take rebasing, for example. Why, oh why do the GUIs not provide a direct manipulation interface over the revision graph? That would make such a thing *so* easy.
[13:26:11] * ChrisMorgan wishes he had time to make a Git GUI just to show how he thinks it should be done
[13:26:16] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[13:26:16] <eddyb> ChrisMorgan: well, git-gui gives me line-level change control (not that I use it much with rust *cough*) and simple pushing
[13:26:29] <eddyb> but yeah, it's just something primitive, no rebase interface
[13:26:51] <eddyb> https://github.com/eddyb/rust/commit/c1b4dde31136f01b8027be1ff514c9741861d081
[13:26:56] <eddyb> this got out of hand quick >_>
[13:27:56] <eddyb> still negative diff \o/
[13:28:33] <pnkfelix> eddyb: When are you going to start separating your refactoring commits (e.g. renamings) from the non-refactoring ones?
[13:29:24] <eddyb> oh, yeah, I know I can split some changes
[13:29:37] <eddyb> and now I want a git history manipulation GUI
[13:30:22] <pnkfelix> eddyb: For my workflow, I usually break these things up at the outset, rather than making all the changes and then having to split it into commits afterward
[13:30:34] <pnkfelix> eddyb: To each his/her own, of course.
[13:30:39] <eddyb> well, I can't do that :(
[13:30:59] <eddyb> the renaming was an impulsive change when I finally added MethodCallee
[13:31:10] <pnkfelix> eddyb: You cannot stash work in progress, do the renaming, and then unstash?
[13:31:30] <pnkfelix> eddyb: Or maybe you just mean "can't" as in "it is not natural to me"
[13:31:35] <eddyb> I don't think you can rebase with stashes
[13:31:41] *** Joins: edwardw (Mibbit@24D7341C.32602B75.B9C6B12A.IP)
[13:31:47] <eddyb> so I end up breaking everything when I use them
[13:32:02] <pnkfelix> eddyb: I meant "stash" more generally, i.e., make a temporary work branch
[13:32:23] <eddyb> that could work, but I'm pretty inefficient already
[13:32:36] <eddyb> you guys with your speed coding make me so ashamed :(
[13:32:41] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[13:33:11] <pnkfelix> eddyb: I don't know what you're talking about, its been ages since I put up a PR.  :(
[13:33:27] <pnkfelix> eddyb: (and with that, ... back to work, Felix!)
[13:33:42] <eddyb> what are you working on, then? a bunch of local branches?
[13:33:46] <pnkfelix> eddyb: yeah
[13:33:53] <eddyb> it's still something
[13:34:03] <pnkfelix> eddyb: local clones, really
[13:34:26] <pnkfelix> eddyb: each with their own set of branches
[13:34:28] <eddyb> hmpf, I really wish stashes would integrate better
[13:35:06] <eddyb> I would do git stash; and git pull --rebase parent master # if I could
[13:35:19] <eddyb> instead of amending a commit over and over just to rebase
[13:35:38] <edwardw> r? https://github.com/mozilla/rust/pull/12563
[13:36:43] <eddyb> edwardw: <3 cleanup
[13:37:02] <huon> eddyb: "refactor mtwt code" needs a better commit message
[13:37:26] <edwardw> ok
[13:37:34] <huon> (it should give an overview of the refactoring, and, most importantly, why it was done)
[13:37:35] <eddyb> s/mtwt/mtwt hygiene/ maybe
[13:38:08] <edwardw> sure
[13:38:43] <eddyb> and you removed some @? sweet
[13:39:08] <edwardw> actually @@ :D
[13:39:32] <eddyb> not sure why @@ was used in a few TLD maps
[13:39:53] <huon> probably used to be some form of @mut @ or something (which is still pretty weird)
[13:40:03] <edwardw> huon had a theory regarding de-mut-@
[13:40:08] <edwardw> yep that
[13:40:39] <eddyb> we could make interner-related functions return &'static str btw
[13:40:51] <eddyb> instead of the RcStr-based madness
[13:41:35] *** Quits: edwardw (Mibbit@24D7341C.32602B75.B9C6B12A.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:41:38] <eddyb> TLD is static, TLD owns the StrInterner, the StrInterner owns the RcStr's which own their data
[13:42:08] <eddyb> so technically you have &'static ~str, which you can borrow to &'static str
[13:42:31] <eddyb> but there's some mutability shenanigans involved
[13:42:35] <eddyb> so I could be wrong
[13:42:49] <huon> TLD isn't 'static
[13:42:55] <eddyb> huon: o_O
[13:42:58] <huon> (although it effectively is here)
[13:43:07] <huon> TLD gets cleaned up on task death
[13:43:20] <eddyb> 'static is task- wait, no, it isn't :/
[13:43:29] <huon> 'static is *permanent*, e.g., in the executable .text section
[13:43:35] <eddyb> 'static is Send which doesn't play nice with TLD
[13:43:43] <huon> (or .rodata or whatever it is.)
[13:43:51] <eddyb> anyways, I think the issue is that you need a Ref because of the RefCell's
[13:43:56] *** Joins: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP)
[13:44:02] <eddyb> and the data has the lifetime of the Ref
[13:44:14] <edwardw> got disconnected
[13:48:29] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[13:48:40] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:49:43] <edwardw> commit message amended
[13:50:46] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Ping timeout)
[13:50:48] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[13:54:06] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[13:56:52] <edwardw> something wrong with travis build?
[13:59:58] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:01:55] <eddyb> edwardw: it uses nightly LLVM
[14:02:42] <edwardw> ok
[14:04:27] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[14:06:07] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[14:07:08] *** Quits: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca) (Quit: canhtak)
[14:17:32] <eddyb> \o/ no ICEs with callee_id removed
[14:17:55] <eddyb> I guess I was cautious enough
[14:19:39] <edwardw> what is callee_id? IR stuff?
[14:19:47] <eddyb> AST
[14:21:56] <eddyb> nmatsakis: https://github.com/mozilla/rust/pull/12571
[14:22:10] <eddyb> I tried to write a nice description, didn't go so well
[14:26:14] <eddyb> anyone else can review, I guess
[14:42:55] *** Quits: glaebhoerl (glaebhoerl@moz-3590251D.kabelnet.hu) (Ping timeout)
[14:47:07] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[14:48:54] *** Joins: glaebhoerl (glaebhoerl@moz-3590251D.kabelnet.hu)
[14:51:45] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[14:57:56] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:01:41] <nmatsakis> I'm here
[15:01:43] * nmatsakis just arrived
[15:01:53] <nmatsakis> eddyb: exciting
[15:02:06] <eddyb> a wild nmatsakis appears \o\
[15:02:22] <nmatsakis> so beautifully factored 
[15:02:46] <nmatsakis> eddyb: if you want to do an awesome refactoring,
[15:03:02] <nmatsakis> somedy we should remove all the random encoding of the AST side data structures
[15:03:05] <nmatsakis> and replace with the encoding triat
[15:03:09] <nmatsakis> possibly using TLS if needed
[15:03:19] <eddyb> no kidding
[15:03:21] <nmatsakis> or else maybe refactored to carry some user data down, maybe via the encoder
[15:03:28] <nmatsakis> that's been The Plan forever but...
[15:03:31] <nmatsakis> ...not to mention tydecode
[15:03:44] <nmatsakis> I had a branch that removed that entirely and replaced it with automatic encoding, but it was slower :( never did get around to optimizing
[15:03:54] <eddyb> I think astencode emulates Encodable/Decodable perfectly in places :P
[15:04:02] <nmatsakis> it's supposed to
[15:04:04] <eddyb> tydecode/tyencode are optimized, I think
[15:04:05] <nmatsakis> but sometimes we get lazy
[15:04:12] <nmatsakis> I think the reason my version was slower,
[15:04:19] <nmatsakis> was that I didn't bother with the optimization for repeataed types
[15:04:25] <nmatsakis> the "abbrev" code
[15:04:29] <eddyb> oh?
[15:04:37] <eddyb> (we have such a thing? I didn't know)
[15:04:47] <nmatsakis> we do
[15:04:51] <eddyb> btw, I tried to split it into two commits, but the first one won't compile because git gui only offers line-level diff control
[15:05:06] <nmatsakis> it is two commits?
[15:05:14] <eddyb> https://github.com/mozilla/rust/pull/12571
[15:05:22] <nmatsakis> it's not so imp't (imo) that each commit compiles *necessarily*, though it is of course nice,
[15:05:29] <nmatsakis> it's still better to have the changes factored out
[15:05:35] <nmatsakis> maybe squash before pushing in the end
[15:05:44] <nmatsakis> it's unclear how effective git bisect will be for us
[15:07:08] *** lpy is now known as lpy|codeforces
[15:07:52] <eddyb> rebasing deref on top of kill-callee-id: revert *all the things*
[15:12:32] <nmatsakis> eddyb: r+
[15:12:50] <nmatsakis> I presume travis is mistaken
[15:13:00] <eddyb> nmatsakis: I think it's trans::common::node_id_to_substs that takes a bool
[15:13:15] <eddyb> that function also does some processing
[15:13:31] <eddyb> and travis has LLVM troubles again, yeah
[15:16:41] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[15:16:41] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/DLpMAg
[15:16:42] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[15:17:03] <nmatsakis> eddyb: er yes
[15:17:07] <nmatsakis> eddyb: my mistake
[15:17:16] <nmatsakis> eddyb: regardless :)
[15:17:22] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:18:10] <eddyb> might have enum ExprOrCalleeId {ExprId(NodeId), CalleeId(NodeId, /* deref count */ u32)} later on
[15:18:33] <eddyb> since we'll need the deref count for method map keys
[15:19:06] <eddyb> oh wow the queue is empty
[15:19:19] <eddyb> nmatsakis: thanks btw - really nice to have you around more :D
[15:22:39] <eddyb> okay, I've had it with MethodMap
[15:22:53] <eddyb> nmatsakis: any objections to moving MethodMap to ty::ctxt?
[15:23:19] <eddyb> it's going to be needed more, now that we don't store callee types in tcx
[15:24:30] <nmatsakis> eddyb: no, not really
[15:24:47] * nmatsakis wants to desugar method calls into plain fn calls
[15:25:02] <nmatsakis> but it's a long road to get nice lowering working
[15:25:29] <eddyb> problem is, with method calls, you have a function expression and a call expression
[15:25:37] <eddyb> and the function expression has its own type
[15:25:46] <eddyb> s/method calls/regular calls/
[15:26:31] <eddyb> and before type checking, you can't tell whether a + b is a simple add instruction or a method call
[15:28:22] <eddyb> https://github.com/mozilla/rust/pull/12566 I was going to comment that it needs to encode the pattern in metadata
[15:28:36] *** Joins: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net)
[15:28:51] <eddyb> but that's not actually the case, since the data in ExplicitSelf is extraneous
[15:32:36] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Quit: Leaving)
[15:36:24] <eddyb> nmatsakis: hmm, regionck implements mc::Typer and uses, presumably before writeback, might be safer to expose method_map through it
[15:38:58] <nmatsakis> eddyb: yes, before writeback, precisely so that it can redirect accesses away from tcx and into the fcx
[15:39:35] <nmatsakis> eddyb: my plan (for the desugaring) is to lower the AST into a CFG after type checking. But as I said, a LONG road from here to there.
[15:39:37] *** Quits: Kxepal (Miranda@moz-BAA7EE.pppoe.mtu-net.ru) (Ping timeout)
[15:40:07] <eddyb> nmatsakis: would that help borrowck & other analysis passes?
[15:41:38] <nmatsakis> eddyb: yes, dramatically, since the CFG could omit all kinds of things (like method calls) that are just complicating
[15:41:43] <nmatsakis> would presumably simplify trans too
[15:41:55] <nmatsakis> we'd have to do some work to make the error messages nice
[15:41:59] <nmatsakis> this has been pcwalton's concern
[15:42:07] <nmatsakis> but I think that's much easier (and less worrisome) than what we do today
[15:42:24] <eddyb> getting rid of all the weird control flow in trans would be great
[15:42:55] <eddyb> so typeck would become a normalization phase
[15:43:15] <eddyb> partially typed AST => fully typed CFG
[15:44:42] <nmatsakis> that is my idea
[15:44:51] <nmatsakis> and ideally the CFG is very close if not identical to what we use for formal proofs and so forth
[15:48:02] <kimundi> (CFG == cyclic free graph?)
[15:56:05] <nmatsakis> kimundi: control flow graph
[16:00:40] *** Quits: edwardw (edwardw@BB690835.D7DB55D8.50B134B9.IP) (Quit: Leaving...)
[16:01:47] <eddyb> I gotta run, I hope to have explicit overloaded derefs later today
[16:01:54] <eddyb> and auto-derefs tomorrow
[16:03:15] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[16:06:08] <cmr> huon: eddyb: I'm going to re-bench that cluster.
[16:06:18] <cmr> I think I may have accidentally booted into the wrong kernel for a period of time.
[16:11:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:14:59] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:23:49] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Quit: Leaving.)
[16:24:31] *** Joins: edwardw (edwardw@4112974A.B4358688.30F15291.IP)
[16:26:57] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[16:31:41] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[16:31:41] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/wIlWmg
[16:31:41] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[16:34:40] *** Quits: angdev (angdev@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzz‚Ä¶)
[16:36:37] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[16:36:37] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/ilEw2w
[16:36:37] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[16:36:38] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[16:36:38] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/6BceUg
[16:36:38] <ghrust> 13rust/06auto 143d3dae8 15Johannes L√∂thberg: tutorial: Missing tildes around .notrust block...
[16:36:38] <ghrust> 13rust/06auto 1486177db 15bors: auto merge of #12570 : kyrias/rust/master, r=cmr...
[16:36:39] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[16:38:43] *** Parts: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de) ()
[16:40:43] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:46:06] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:47:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:52:16] *** Quits: rcxdude (rcxdude@moz-394D851.nat.csx.cam.ac.uk) (Input/output error)
[16:53:24] <bstrie> for helping out with bors, maybe we could implement something like "r+ confident" to mark pulls that we believe have a very low likelihood of failing the test suite. then perhaps bors could roll them up automatically
[16:54:13] <bstrie> not a silver bullet, but it would help address the long-standing gripe about having to fully test doc changes/vim config changes
[16:55:17] *** Joins: Kxepal (Miranda@moz-E614A377.pppoe.mtu-net.ru)
[16:56:03] <bstrie> looking at the bors queue right now, I see several that, if accepted, would plausibly not break anything
[16:56:34] <bstrie> 12238, 12300, 12308, 12385
[16:56:39] <bstrie> I'm not even looking at the whole queue
[17:01:18] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[17:01:18] *** ChanServ sets mode: +o tjc
[17:01:58] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[17:03:18] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:03:56] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:05:11] <nmatsakis> bstrie: I think there's a bug on that in the bors repo
[17:14:53] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[17:16:18] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[17:16:18] *** ChanServ sets mode: +o tjc
[17:20:07] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[17:24:21] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[17:24:42] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[17:24:42] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:24:42] <eddyb> cmr: did I make any sense?
[17:28:19] <cmr> eddyb: in what
[17:29:04] <eddyb> cmr: comments on https://github.com/mozilla/rust/pull/12566
[17:34:23] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[17:37:22] *** Quits: glaebhoerl (glaebhoerl@moz-3590251D.kabelnet.hu) (Ping timeout)
[17:38:43] *** Quits: lpy|codeforces (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[17:40:28] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[17:40:49] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[17:42:31] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[17:43:14] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:45:39] <eddyb> I think we should rather return std::cell::Ref<'a, T> from methods, than @RefCell<T>
[17:51:39] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[17:51:39] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/6BceUg
[17:51:39] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[17:52:59] *** Joins: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu)
[17:53:00] *** Joins: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca)
[17:56:36] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[17:58:26] <acrichto> nmatsakis: ping
[17:59:47] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:01:05] <cmr> eeeeeeeeeeugh github
[18:01:12] <cmr> I open a tab from last night
[18:01:12] <nmatsakis> acrichto: pong
[18:01:16] <cmr> see some updates, make a comment
[18:01:21] <eddyb> lol
[18:01:25] <cmr> and then the rest of the updates, invalidating my comment, show up.
[18:01:27] <eddyb> (I know how this ends)
[18:02:30] <acrichto> nmatsakis: I'm a little confused on why we're moving from &mut T to &T in atomics and other concurrency things in general
[18:02:58] <acrichto> nmatsakis: I understand that &mut T aliases on other threads, but the compiler only cares about a single thread of execution, so I would think that &mut T would still be appropriate
[18:03:06] <eddyb> AtomicT is an atomic Cell<T>
[18:03:28] <eddyb> (that's how I understand it)
[18:03:44] <nmatsakis> that is how I think of it too,
[18:03:51] <nmatsakis> acrichto: I think there is some portion of self-inflicted problem here,
[18:03:59] <nmatsakis> in that &T is really about aliasability, not immutability,
[18:04:12] <acrichto> but why do we care about aliasing amongst threads?
[18:04:13] <eddyb> iff T: Freeze is it immutable
[18:04:15] <nmatsakis> and -- by default -- we have a rule that aliasable content is immutable.
[18:04:34] <eddyb> acrichto: think Arc<Atomic>, you can have it in multiple threads, but also on the same thread
[18:04:35] <nmatsakis> acrichto: the reason I can see to use &T vs &mut T,
[18:04:43] <nmatsakis> acrichto: is that &mut T is unnecessarily restrictive
[18:05:00] <nmatsakis> that's one reason anyway
[18:05:16] <acrichto> mk I'd buy that more than the aliasing argument
[18:05:27] <nmatsakis> now, in general, we obviously DO care about aliases on other threads
[18:05:40] <nmatsakis> as in, we don't want them :)
[18:05:48] <nmatsakis> or at least we don't want them if the data is mutable etc etc
[18:05:55] <acrichto> yeah
[18:06:01] <nmatsakis> but in this specific case, since the data is only mutable via an atomic primitives, it's kind of irrelevant
[18:06:01] <eddyb> you can share Arc<T> with another thread, that doesn't stop you from having multiple handles in one thread
[18:06:13] <acrichto> Arc<T> only hands out &T
[18:06:17] <acrichto> and it requires T: Freeze
[18:06:20] <eddyb> ohh
[18:06:26] <eddyb> I guess we need Share?
[18:06:27] <nmatsakis> acrichto: I don't think it needs to require T:Freeze
[18:06:33] <nmatsakis> it ought to be share
[18:06:40] <nmatsakis> and Arc should not be freeze (not sure if it is)
[18:06:42] <acrichto> I should read up more on Share
[18:06:49] <nmatsakis> really an arc could be implemented "safely" now
[18:06:58] <nmatsakis> or at least more safely
[18:07:03] <nmatsakis> in that it should embed an Atomic<Integer> as the ref count
[18:07:12] <eddyb> ohh
[18:07:15] <nmatsakis> I think a lot of the places we do mutablility hacks
[18:07:20] <nmatsakis> ought to be rewritten to use Cell / Atomic
[18:07:21] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:07:36] <nmatsakis> (e.g., arena)
[18:07:36] <eddyb> composability <3
[18:07:56] <acrichto> so the main reason for atomics to use &T is basically convenience
[18:08:02] <acrichto> you're not gaining anything if you use &mut T
[18:08:09] <acrichto> kinda like channel send/recv use &self instead of &mut self
[18:08:15] <acrichto> even though you're "modifying the channel"
[18:08:42] <eddyb> Rc<T> is really ImmUniq<(Cell<uint>, Cell<uint>, T)>
[18:08:46] <nmatsakis> yes
[18:09:00] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:09:01] <nmatsakis> acrichto: I tink so, but I think it's also a lie to use &mut T that might bite us eventually
[18:09:03] <eddyb> I wish we could be generic over Cell/Atomic
[18:09:09] <nmatsakis> acrichto: I don't quite know how but it seems bad to lie.
[18:09:34] <eddyb> if anything, it's a sin :P
[18:09:41] *** Joins: glaebhoerl (glaebhoerl@moz-3AF9327D.kabelnet.hu)
[18:09:46] <acrichto> mk, do you know why brson also made the intrinsics go from &mut T to *mut T?
[18:09:57] <acrichto> I would expect the intrinsics to take &T, and if not that, then *T
[18:10:15] <nmatsakis> acrichto: e.g., regarding the lieing bit, imagine we told LLVM "this is unaliased" and then it sees "oh, this is unaliased, I can convert this atomic op into a normal one"
[18:10:25] <nmatsakis> which would be perfectly reasonable
[18:10:44] <acrichto> I was talking to sunfish the other day and he mentioned that LLVM's view of the world is that there is only one thread
[18:10:56] <eddyb> acrichto: T is Freeze in that case (the inner type of the atomic)
[18:10:57] <acrichto> so it's true that there are no aliasing pointers to an atomic *on your thread*
[18:11:16] <eddyb> &T would end up having the wrong attributes, I would think
[18:11:18] <acrichto> I'd have to clarify with sunfish though
[18:11:18] <nmatsakis> acrichto: that's kind of how all compilers view the world,
[18:11:26] <nmatsakis> acrichto: but of course they DO have to think about other threads
[18:11:49] <sunfish> they think about other threads at synchronization constructs
[18:12:03] <acrichto> but would LLVM ever change an atomic to not an atomic?
[18:12:10] <acrichto> if we told it that the memory didn't alias any other local memory?
[18:12:10] *** Quits: glaebhoerl (glaebhoerl@moz-3AF9327D.kabelnet.hu) (Quit: )
[18:12:19] <eddyb> acrichto: they do have optimizations for atomics, I think
[18:12:21] <sunfish> if the address doesn't escape, it might
[18:12:45] <eddyb> I know strcat or someone else mentioned that because of some smart pointer in C++ std, they had to overhaul atomics
[18:12:59] <sunfish> I don't think a lack of local aliasing is sufficient for that, but non-escaping memory probably is
[18:13:09] <acrichto> nmatsakis: I'm basically uncomfortable saying that we need &T because otherwise it aliases, I'm fine with the change I just want to understand why
[18:13:13] <eddyb> just so they wouldn't visibly affect performance
[18:13:20] <acrichto> sunfish: makes sense
[18:13:35] <nmatsakis> acrichto: why does it make you uncomfortable to say we want &T because the data *is* aliased?
[18:13:45] <eddyb> (either unique_ptr or string)
[18:13:58] <eddyb> sunfish: "constructs" makes me think "golems"
[18:14:09] <acrichto> nmatsakis: I don't view aliasing on other threads as counting as aliased
[18:14:28] <nmatsakis> I think that's just ... wrong
[18:14:40] <eddyb> if it can alias from another thread, I don't see how you couldn't also alias in the same thread
[18:14:43] <cmr> it certainly is
[18:14:44] <acrichto> aliasing is necessary from the point of view of optimizations though, right?
[18:14:51] <cmr> that same argument could be applied to RWArc
[18:15:05] <cmr> they can hand out every thread a &mut, because they don't "count" as aliased...
[18:15:06] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Ping timeout)
[18:15:09] <nmatsakis> acrichto: I think from Rust's point of view, it's more the other way: aliasing within a thread is no different from aliasing between threads
[18:15:20] <nmatsakis> or I want to make this true as much as possible
[18:15:28] <nmatsakis> originally we started out kind of privileging the current thread,
[18:15:33] <nmatsakis> hence the existence of things like &const
[18:15:44] <nmatsakis> which are only safe
[18:15:48] <nmatsakis> if the alias doesn't escape the thread
[18:15:52] <nmatsakis> otherwise they induce data races
[18:16:04] <nmatsakis> but we've been removing &const and similar features 
[18:16:14] <eddyb> ahh, &const, thou hath left thy imprint throughout middle
[18:16:16] <nmatsakis> I hope to drive (I think?) the last nail in that coffin soon
[18:16:36] <nmatsakis> acrichto: the reason I suggested to brson he use *T and not &T is because of the immutability rules
[18:16:37] <acrichto> so the meaning of &mut will become: there is one and only one pointer in the entire world to this data and you're looking at it
[18:16:46] <nmatsakis> yes
[18:16:58] <nmatsakis> one active ptr
[18:16:58] * cmr thought it meant that
[18:17:05] <nmatsakis> cmr: it..almost does :)
[18:17:15] <nmatsakis> used to be that many read-only aliases were possible
[18:17:16] <eddyb> cmr: probably violated by parts of std
[18:17:21] <nmatsakis> @mut, &const, other local variables
[18:17:31] <nmatsakis> eddyb: well I'm just talking about safe code right now
[18:17:51] <eddyb> ask strcat, he knows all the wrongs that have been made :P
[18:17:52] <nmatsakis> cmr: but @mut is gone, &Const is gone, closures don't permit secret &const borrows anymore,
[18:18:04] <nmatsakis> but there is still one kind of aliasing, which was the subject that recent RFC I sent out
[18:18:16] <nmatsakis> acrichto: in particular, it just seems wrong to have a function take an &int and mutate it 
[18:18:30] <nmatsakis> acrichto: whether or not that fn is unsafe 
[18:18:30] <acrichto> makes sense, but why *mut T instead of *T?
[18:18:40] <eddyb> acrichto: T is Freeze
[18:19:04] <nmatsakis> acrichto: yeah, *mut T is prob the better choice
[18:19:19] <acrichto> that just seems so weird
[18:19:20] <nmatsakis> acrichto: I think he and I both consider those two to be the same,
[18:19:25] <acrichto> &mut T -> &T, but not *T
[18:19:35] <nmatsakis> though i'm starting to change my opinion on that, 
[18:19:39] <nmatsakis> based on huon's comments
[18:19:57] <nmatsakis> acrichto: what does "&mut T -> &T, but not *T" mean?
[18:20:17] <eddyb> AtomicT made immutable but not the intrinsics
[18:20:17] <nmatsakis> you can use trivially convert an &mut Tinto a *T
[18:20:20] <acrichto> we're switching atomcis from &mut T to &T, but the intrinsics are going from &mut T to *mut T, not to *T
[18:20:39] <nmatsakis> well, this is the whole point
[18:20:41] <eddyb> do we want to uphold any immutability guarantees for *T?
[18:20:42] <nmatsakis> that is, the wrapper types exist
[18:20:50] <nmatsakis> to insert mutability
[18:21:00] <nmatsakis> right now our type system doesn't premit one to label a field as "inherently mutable"
[18:21:05] <nmatsakis> isntead we do that by cheating (Cell, RefCell, Atomic)
[18:21:26] <nmatsakis> we could add similar rules to the type system
[18:21:27] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[18:21:33] <nmatsakis> you could label field as mut, volatile mut, and so on
[18:21:38] <acrichto> hm, so these types all mean "someone else can change this without you knowing"
[18:21:41] <cmr> eddyb: do you know the cause of recent drop in irsy?
[18:21:47] <eddyb> nope
[18:22:04] <nmatsakis> acrichto: yes, though I think of it as "this value can be changed even when aliased"
[18:22:17] <nmatsakis> acrichto: in genreal that is not safe so we have to limit it, that's the job of the wrappers, to moderate access
[18:22:26] <eddyb> cmr: "Remove references to guide-conditions" these will always crack me up =))
[18:22:36] <nmatsakis> acrichto: the kind of aliasing is controlled by Freeze vs Share
[18:22:39] <eddyb> cmr: almost every time the graph goes nuts, it's a doc change
[18:22:43] <nmatsakis> acrichto: that is, none of these types are Freeze,
[18:22:54] <acrichto> yeah
[18:22:58] <nmatsakis> acrichto: but those (like Cell) that are also not threadsafe, are also not Share, and hence are only concerned with intrathread aliasing
[18:23:14] <nmatsakis> acrichto: this is good that you're forcing me to try and put this into words 
[18:23:17] <nmatsakis> we should write this up
[18:23:20] <acrichto> lol
[18:23:26] <acrichto> so Atomics are Share?
[18:23:31] <eddyb> yupp
[18:23:32] <nmatsakis> I think they should be
[18:23:35] <eddyb> can't go wrong with atomics
[18:23:50] <nmatsakis> they are threadsafe even when aliased
[18:24:12] <eddyb> we need another periodic table
[18:24:15] <nmatsakis> which is kind of a weird phrase
[18:24:32] <nmatsakis> not sure if I'm drawing a meaningful distinction
[18:24:35] <nmatsakis> or maybe that's the same as threadsafe
[18:24:42] <nmatsakis> since what does threadsafe mean without aliasing
[18:24:58] <eddyb> for ref-counted smart pointers, cells and the kinds they interact with
[18:25:26] <nmatsakis> I am hoping to take some time this afternoon to write up the proposal to make builtin traits like Send, Freeze, and Share opt-in
[18:25:31] <eddyb> we can have an AtomicRefCell and a RWLock at the same time
[18:25:33] <nmatsakis> which I actually think will help make this a lot easier to reason about
[18:25:53] <eddyb> why would you ever want to make something Freeze?
[18:25:56] <nmatsakis> we do have an AtomicRefCell, we just call it RwLock
[18:26:04] <nmatsakis> most things are Freeze
[18:26:06] <eddyb> nmatsakis: distinct concept
[18:26:10] <nmatsakis> eddyb: not really
[18:26:20] <nmatsakis> how is it distinct?
[18:26:31] <nmatsakis> it seems the same to me...
[18:26:39] <eddyb> RwLock waits, RefCell (and presumably AtomicRefCell) fails
[18:26:45] <nmatsakis> eddyb: that's horribly racy
[18:26:49] <eddyb> less useful, but also less overhead
[18:26:50] <nmatsakis> I don't think it makes any sense
[18:26:51] <acrichto> that seems very non-useful
[18:26:58] <nmatsakis> you have to already know nobody has access
[18:27:00] <nmatsakis> before you try to gain access
[18:27:02] <nmatsakis> if you know that,
[18:27:06] <eddyb> well, someone mentioned it
[18:27:11] <nmatsakis> what are you worried about? :)
[18:27:19] * eddyb steps out
[18:27:21] <nmatsakis> :)
[18:27:27] <nmatsakis> sorry, don't mean to jump down your throat.
[18:27:34] <eddyb> should keep doing what I'm doing and not mess with threads
[18:27:37] <nmatsakis> I actually think it's interesting that the generalization of Cell is Atomic,
[18:27:42] <nmatsakis> but the generalization of RefCell is a lock
[18:27:51] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[18:27:51] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 14729bdd3 to 14f91de33: 02http://git.io/k471pw
[18:27:51] <ghrust> 13rust/06try 14f91de33 15Alex Crichton: windows file fixes...
[18:27:51] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[18:28:02] <eddyb> (don't want to get ran down by a race condition)
[18:28:06] <nmatsakis> truth is,
[18:28:18] <nmatsakis> you can't generalize Cell as easily -- I mean you can't apply it to arbitrary pod types
[18:28:23] <nmatsakis> at least not without a lock or moral equiv of one
[18:28:53] <eddyb> we can at least have Atomic<T: AtomicPrimitive>
[18:29:07] <eddyb> for some generic beauty
[18:29:30] <nmatsakis> sure
[18:29:32] <eddyb> and you could technically implement AtomicPrimitive for newtypes of primitives, forwarding all operations
[18:29:43] <nmatsakis> yes
[18:29:50] <acrichto> we can only really have Atomic<T> if sizeof(T) == sizeof(uint)
[18:29:53] <nmatsakis> and for arbitrary types, using a global lock :)
[18:30:15] <nmatsakis> (hey that's what a bus lock is anyway)
[18:30:15] <eddyb> acrichto: doesn't LLVM support all integer sizes?
[18:30:25] <acrichto> it does, platforms have dubious support though
[18:30:35] <acrichto> we're removing AtomicU64
[18:30:36] <eddyb> that's actually sad
[18:30:59] <nmatsakis> I think I don't like the name Freeze
[18:31:08] <eddyb> nmatsakis: IIICEEEE
[18:31:18] <nmatsakis> but we've been over this before...
[18:31:21] <eddyb> FREEEZE
[18:32:27] <eddyb> acrichto: could we #[cfg(arch)] impl AtomicPrimitive for T {...} for an arch that supports atomic operations on T?
[18:33:19] <acrichto> perhaps yeah
[18:33:22] <acrichto> with a private trait
[18:33:25] <eddyb> don't want to lose options where they are supported
[18:33:40] <acrichto> I don't like exposing platform-specific things too mcuh thoug
[18:33:46] <acrichto> it's too easy to build code for one platform and not another
[18:33:53] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Ping timeout)
[18:33:59] <eddyb> maybe mark the impl as experimental or something?
[18:34:10] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[18:34:31] <eddyb> #[warn="this doesn't work on all architectures, please consider using Atomic<uint>"]
[18:34:39] <acrichto> perhaps
[18:34:51] <eddyb> with a way of disabling it if you are willing to #[cfg] your (presumably) low-level code
[18:34:56] <eddyb> mkay, enough speculation
[18:35:12] <eddyb> I have real grunt work to do
[18:35:16] <nmatsakis> acrichto: so...was that helpful? make sense?
[18:35:42] <acrichto> nmatsakis: I am convinced, I'll have to stew on why &mut T is so bad for atomics a little longer though
[18:36:33] <acrichto> we really need the change that forbids statics that aren't Freeze
[18:36:46] <acrichto> otherwise I'm sure to accidentally write 'static FOO: AtomicUint'
[18:36:49] <nmatsakis> flaper87 is on it
[18:37:05] <acrichto> oh yay!
[18:37:43] <eddyb> it's so nice that we have the information in the type system :D
[18:38:43] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[18:43:04] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[18:46:36] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[18:46:36] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/NjFwlQ
[18:46:36] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[18:46:37] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[18:46:37] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/MlSMAA
[18:46:37] <ghrust> 13rust/06auto 1490f2d1d 15zslayton: Closes #12386. Removed 'pub mod' doc-comments in std::io's mod.rs file. Added summary doc-comments to test.rs, util.rs and stdio.rs.
[18:46:37] <ghrust> 13rust/06auto 145737d1f 15bors: auto merge of #12490 : zslayton/rust/doc-fix-12386, r=alexcrichton...
[18:46:38] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[18:47:20] <nmatsakis> acrichto: I feeling more and more persuaded about priv fields 
[18:47:29] <nmatsakis> acrichto: do you still feel we ough to be priv by default?
[18:47:47] <acrichto> yes
[18:48:05] <acrichto> I think struct Point is like the only counterexample
[18:48:28] <nmatsakis> acrichto: btw, regarding `&` vs `&mut` --
[18:48:38] <nmatsakis> some time back I was pushing to rename `&mut` to `&my`
[18:48:44] <nmatsakis> I called it "orienting around ownership"
[18:48:48] <nmatsakis> the idea was basically to explain everything
[18:48:52] <eddyb> hehe
[18:48:53] <nmatsakis> in terms of aliasability and non-aliasability
[18:49:02] <eddyb> I remember seeing &move T somewhere
[18:49:06] <nmatsakis> (that was different)
[18:49:10] <nmatsakis> I wanted to go further, actually,
[18:49:13] <nmatsakis> and just remove mutability decls
[18:49:18] <nmatsakis> and just say that anything uniquely references is mutable
[18:49:27] <nmatsakis> which I sitll kind of like :) but everything pushed against it
[18:49:36] <nmatsakis> in the end, the idea of writing "let my x = 5"
[18:49:40] <nmatsakis> to declare a mutable local variable
[18:49:42] <nmatsakis> seemed too weird
[18:49:45] <nmatsakis> and so the idea was dropped :)
[18:49:45] <eddyb> my x = 5;
[18:49:53] <acrichto> interesting
[18:49:58] <eddyb> like we didn't have enough perly sigils :P
[18:50:03] <nmatsakis> but I still think that *aliasability* and ownership is the real thing here
[18:50:10] <nmatsakis> our mutability controls are kind of layered on top
[18:50:31] <acrichto> it does seem that we're conflating the two unfortunately
[18:50:37] <nmatsakis> I see the current mutability rules as kind of a lint
[18:50:45] <nmatsakis> to help you avoid mutating locals you didn't mean to
[18:50:49] <eddyb> (which is nice)
[18:50:54] <nmatsakis> yes, it has value, it's caught some bugs for me
[18:51:29] <nmatsakis> I'm not arguing for &my anymore, just kind of saying that if you think about &mut not as "I can mutate this" but "I own this",
[18:51:34] <nmatsakis> or at least, "I have unique access to this",
[18:51:42] <nmatsakis> then it makes more sense why it's wrong to use it for atomics
[18:51:53] <acrichto> yeah
[18:52:59] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:54:05] <nmatsakis> acrichto: tihs is all quite relevant as we review rust pedagogy
[18:54:08] <nmatsakis> :)
[18:54:16] * eddyb wishes Option<()> and Result<T, ()> would let you do Some() and Err()
[18:54:23] <eddyb> Err(()) is just so odd
[18:57:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:00:17] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[19:04:31] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:04:31] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:05:27] <flaper87> acrichto: I'll push that change in a bit. check-stage2 running
[19:06:07] <acrichto> flaper87: \o/
[19:08:19] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Quit: Sharp)
[19:10:25] <flaper87> acrichto: nmatsakis https://github.com/mozilla/rust/pull/11979 there it is
[19:11:25] <cmr> nmatsakis: you said something about opt-in kinds?
[19:12:55] <nmatsakis> cmr: yes, i'm working on a proposal right now
[19:13:05] <cmr> ok.
[19:13:27] <cmr> I think this is probably a good idea, esp regarding our previous discussion about kind stability.
[19:13:40] <cmr> I'm a bit worried about annotation burden though
[19:13:42] <nmatsakis> cmr: yes I think it more-or-less solves that problem
[19:13:44] <eddyb> Rust: Alchemy
[19:13:49] <cmr> I'll wait for proposal though
[19:13:59] <nmatsakis> cmr: I'm trying to figure out how I can measure and predict the annotation burden
[19:14:13] <nmatsakis> cmr: I imagine one way to make things nicer might be to hvae something like #[deriving(Data)] that means:
[19:14:14] <eddyb> design-by-statistics
[19:14:23] <nmatsakis> derive Eq, Ord, Pod, Send, Freeze, etc
[19:14:26] <cmr> eddyb: that's serious, though..
[19:14:30] <nmatsakis> basically everything a "normal type" would have
[19:14:39] <cmr> nmatsakis: that sounds fine.
[19:14:39] <nmatsakis> well, a normal bit of data
[19:14:56] <cmr> as usual, I'm worried about crappy libraries not declaring kinds that they could implement but don't.
[19:15:07] <eddyb> this could lead to a deoptimization problem
[19:15:27] <flaper87> btw, can I have a badge for the average number of comments per PR?
[19:15:32] <eddyb> because you need Freeze to take advantage of &T
[19:15:40] <cmr> flaper87: we don't have badges yet!
[19:15:43] <flaper87> my PRs usually have >=30 comments :D
[19:15:50] <eddyb> nmatsakis: what if Freeze is only opt-out?
[19:15:51] <flaper87> cmr: I know, I'm joking :)
[19:16:09] <flaper87> and acrichto offered me a badge for the maximum number of failures in a aptch
[19:16:12] <flaper87> patch*
[19:16:18] <eddyb> not sure if you could make anything that's not Freeze become Freeze
[19:16:22] <nmatsakis> eddyb: freeze is one the main ones that should be opt in, imo
[19:16:59] <eddyb> where would you need to turn a non-Freeze into a Freeze?
[19:17:02] <eddyb> with the current situation
[19:17:03] <nmatsakis> (because I don't want code to be wrong by default, even if you use unsafe)
[19:17:37] <nmatsakis> eddyb: I don't understand the question
[19:17:38] <eddyb> yeah, but then you throw away the immutability guarantee that you can give to LLVM
[19:17:50] <eddyb> nmatsakis: ahh, I see your concerns
[19:18:09] <eddyb> I was thinking that if you have struct Foo(T); with non-Freeze T, you couldn't do anything to make Foo Freeze
[19:18:24] <eddyb> maybe we should have opt-in NonFreeze?
[19:18:36] <eddyb> no, that doesn't resolve your concerns
[19:18:42] <eddyb> (since it's what we have now XD)
[19:18:51] <nmatsakis> eddyb: it remains to be seen whta we "throw away"
[19:19:22] <eddyb> we should also take a look at what LLVM can do with immutability information
[19:19:48] <nmatsakis> what I mean is,
[19:19:56] <nmatsakis> if we say had #[deriving(Data)],
[19:20:02] <nmatsakis> and people use that most of the time because it's easy
[19:20:07] <nmatsakis> then they'd get Freeze.
[19:20:38] <eddyb> having that on every struct ever feels... a bit too much
[19:20:56] <nmatsakis> I doubt it'll be every struct ever.
[19:21:01] <nmatsakis> well, I don't know
[19:21:10] <eddyb> and then you have missing Freeze all over the place
[19:21:17] * nmatsakis shrugs
[19:21:21] <nmatsakis> the same situation arises with Eq
[19:21:21] <nmatsakis> and Ord
[19:21:26] <nmatsakis> and it seems to be ok
[19:21:31] <eddyb> not really
[19:21:41] <nmatsakis> in particular, many structs should be eq'd
[19:21:51] <eddyb> I understand Send and Share, you can make something thread-safe by wrapping it in some way
[19:21:52] <nmatsakis> similarly, I think many structs should not be pod,
[19:22:07] <nmatsakis> and so forth.
[19:22:14] *** Joins: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP)
[19:22:24] <nmatsakis> it's pretty unclear how imp't it is to be considered freeze 
[19:22:25] <eddyb> but you shouldn't be able to implement Freeze on a struct with fields that aren't
[19:22:30] <nmatsakis> oh, you won't
[19:22:42] <nmatsakis> at least not under my proposal
[19:22:49] <nmatsakis> if you impl Send, Freeze etc, the compiler still double checks you
[19:22:52] <eddyb> at least it's not a footgun
[19:23:19] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[19:23:31] <eddyb> nmatsakis: as I've said, it matters what we can get from LLVM (even in theory) from knowing that &T is immutable (iff T: Freeze)
[19:25:09] <cmr> the only thing I can see is "caching" reads and the side-effects that can imply.
[19:26:57] <eddyb> let's see what ccache does :D
[19:27:30] <nmatsakis> eddyb: all the more reason (in my mind) to make it opt-in; aggressive optimization means the price of being *wrong* is very high
[19:27:31] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:27:39] <eddyb> files in cache                      1768
[19:27:49] <nmatsakis> so I really don't know how I feel about having types be freeze-by-default when we can't check what unsafe code may be doing
[19:28:01] <nmatsakis> (I know neither is a guarantee...)
[19:28:45] <nmatsakis> I guess I hope that nobody ever implements their own interior mutability stuff
[19:28:56] <eddyb> we could have some lints about unsafe casts (like transmute or transmute_mut) performed on types that are Freeze
[19:28:56] <nmatsakis> we have Cell and RefCell
[19:29:09] <eddyb> we could have some lints about unsafe casts (like transmute or transmute_mut) performed on types that are Freeze
[19:29:13] <eddyb> errr
[19:29:19] <nmatsakis> eddyb: the problem is that what you really want to check is not whether the type you are transmuting is Freeze,
[19:29:37] <eddyb> (this is what happens when you have input lag and a pseudo-tiled workspace)
[19:29:39] <nmatsakis> eddyb: but whether the struct it points into is freeze, and you don't know that
[19:29:43] <eddyb> riiight
[19:30:01] <eddyb> huon, cmr: ccache only gives me cache misses :(
[19:30:10] <cmr> eddyb: bigger cache!
[19:30:24] <eddyb> 70MB/1GB
[19:30:43] <eddyb> it just added 400 files to the cache
[19:31:08] <eddyb> (is the LLVM build that fast?)
[19:37:29] <nmatsakis> eddyb: admittedly, variance inference is also "unsound by default" and I don't think I want to change that either, so maybe my argument is weak.
[19:37:45] <nmatsakis> (regarding Freeze specifically)
[19:38:00] <eddyb> Rust: only somewhat somehow maybe safe by default
[19:39:11] <nmatsakis> maybe we should have some core type, Mut<T>,
[19:39:15] <nmatsakis> where the only operation you can do,
[19:39:19] <nmatsakis> is to get back a *mut T to its contents
[19:39:40] <nmatsakis> it would be known to the compiler, or at least include the appropriate markers / whatever,
[19:39:43] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[19:39:46] <nmatsakis> and woudl be the building block for Cell, RefCell, etc
[19:39:51] <eddyb> oh, that is nice :D
[19:39:51] <nmatsakis> Atomic
[19:40:25] <eddyb> cache hit (preprocessed)             504
[19:40:41] <eddyb> cmr, huon: nevermind, I think there were extra LLVM changes :D
[19:40:45] <nmatsakis> ideally then *all* non-freeze things would include a ref to Mut<T> (maybe it's even wrong to do otherwise)
[19:41:17] <nmatsakis> acrichto: what do you think of that ^^ (see my comments starting at 11:39:11)
[19:41:52] <eddyb> I somehow wish code could be generic over Cell/Atomic/RefCell/RwLock but maybe it's overkill
[19:42:03] <nmatsakis> oh, that'll come.
[19:42:09] <eddyb> :D:D
[19:42:14] <eddyb> nmatsakis: HKT traits?
[19:42:18] <nmatsakis> I think it's best to have HKT for that yes
[19:42:27] * aatch wants HKT
[19:42:40] <eddyb> oh, did I tell you how you can do let x: ~str = ~("foo");?
[19:42:52] <acrichto> nmatsakis: seems reasonable, but it may just be one more layer, all code today that is non-freeze should be using atomics/cell/refcell,r ight?
[19:43:01] <acrichto> we may simplify those three, but are there more that we'd simplify?
[19:43:11] <eddyb> well, let x: ~str = box "foo";
[19:43:16] <acrichto> compiler knowledge would be interesting though
[19:43:23] <nmatsakis> acrichto: that's the question, but I imagine there might be,
[19:43:42] <nmatsakis> acrichto: those 4 types embody 4 safe patterns for dealing with aliasbale mutable but I guess there are more
[19:43:51] <aatch> I really want to be able to express a type with kind (* -> *) -> *
[19:44:18] <nmatsakis> acrichto: maybe not. I think Mut<T> becomes more interesting if we can guarantee that there is NO OTHER WAY to get a mutable pointer
[19:44:22] <eddyb> aatch: you can get some things done using generics smartly
[19:44:25] <nmatsakis> or at least, that's it's really, really hard.
[19:44:32] <acrichto> nmatsakis: I'd be up for it if the compiler had a reason for Mut<T> to exist
[19:44:40] <acrichto> that is a nice guarantee
[19:44:41] <aatch> eddyb, yeah, I know, but it gets really unwieldly, really fast
[19:44:53] <nmatsakis> acrichto: I guess as long as we have transmute , we cna't have much of a guarantee
[19:44:53] <eddyb> maybe we can start restricting transmutes?
[19:45:16] <eddyb> &T => &U with size_of::<T>() == size_of::<U>()
[19:45:24] <eddyb> and &mut T => &mut U
[19:45:27] <nmatsakis> acrichto: my main goal is to find some abstraction that's simple enough that we can ensure people reach for it when implementing something unsafe w/ interior mutability
[19:45:40] <nmatsakis> and I can't think of anything more general than Mut<T>
[19:45:43] <eddyb> and kill transmute_mut with Mut<T>
[19:45:49] <nmatsakis> yes, we could kill that
[19:45:50] <acrichto> nmatsakis: I think from a client side we're pretty set with Cell and friends today
[19:45:56] <acrichto> no one should reach for Mut<T> in thery
[19:45:57] <acrichto> theory*
[19:46:01] <acrichto> except for a few authors
[19:46:01] <nmatsakis> I guess that remains to be seen
[19:46:05] <nmatsakis> though even internally,
[19:46:11] <nmatsakis> it'd be more dry
[19:46:20] <nmatsakis> right now you need two markers: invariance, non-freeze
[19:46:39] <nmatsakis> but I hope you are right
[19:46:44] <nmatsakis> (as far as clients go)
[19:46:56] <eddyb> impl Box<&'static str> for ~str {...} and impl<T> Box<T> for ~T {...} don't really conflict
[19:47:17] <acrichto> oh hm I suppose cell/refcell do need invariance
[19:47:24] <acrichto> if Mut<T> encapsulated both that would be nice
[19:47:29] <acrichto> maybe should have something like this
[19:47:31] <eddyb> (sorry for interefering, but this is a nice ide I had)
[19:47:33] <acrichto> I would never remember the invariance one
[19:48:01] <eddyb> let x: ~&'static str = box "foo"; let y: ~str = box "bar"; would be both possible
[19:48:25] <eddyb> and this should scale to all smart pointers
[19:48:33] <nmatsakis> acrichto: yes I think we should have it, regardless of what we do with anything else. I'd be happy if we have something we can point people to as the single building block (and use internally)
[19:48:47] <acrichto> seems nice
[19:48:48] <nmatsakis> acrichto: though I agree that for 99% of clients, Cell/RefCell ought to be enough
[19:49:26] <nmatsakis> it also ensures that the Mut<T> contents are private
[19:49:35] <nmatsakis> though I guess that's an easy one to remember
[19:50:02] <acrichto> true
[19:51:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:55:13] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:57:13] *** Quits: edwardw (edwardw@4112974A.B4358688.30F15291.IP) (Quit: Leaving...)
[19:57:50] *** Joins: edwardw (Mibbit@4112974A.B4358688.30F15291.IP)
[20:00:01] *** Quits: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca) (Ping timeout)
[20:00:54] <eddyb> so to revert, I think unstaging the relevant lines and running git checkout HEAD -- src
[20:00:58] <eddyb> is enough to do the job
[20:03:20] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[20:03:26] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[20:03:28] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:07:32] <Eridius> eddyb: ?
[20:07:46] <Eridius> git checkout HEAD -- src will throw away all changes to src, staged and unstaged alike
[20:07:54] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:07:55] <Eridius> git checkout -- src will only throw away unstaged and will keep staged
[20:08:21] <Eridius> you can also say `git checkout -p HEAD -- src` to get a hunk-by-hunk revert interface, including editing, although it's a bit confusing because the diffs are all in verse
[20:08:22] <eddyb> well, unstaging and committing the rest
[20:08:24] <Eridius> *in reverse
[20:08:45] <eddyb> I'm using git gui, lets me pick line by line
[20:09:11] <strcat> -p lets you split hunks too
[20:10:32] <Eridius> sure, you can edit it
[20:10:35] <Eridius> it's just confusing
[20:11:34] <strcat> as long as I don't have to see a tk application ;P
[20:11:37] *** Joins: tjc (tjc@moz-C767A933.bad.hfc.comcastbusiness.net)
[20:11:38] *** ChanServ sets mode: +o tjc
[20:11:41] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[20:11:41] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/MlSMAA
[20:11:41] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[20:12:09] <eddyb> strcat: do you know any better GUI?
[20:12:20] <eddyb> I can't say I like the style
[20:12:37] <strcat> well, don't bother with gitg
[20:12:55] <strcat> it's really unresponsive and likes to crash
[20:13:13] <strcat> eddyb: tig is nice...
[20:13:20] <strcat> eddyb: I don't know if that's enough for you :P
[20:13:54] <eddyb> well, ChrisMorgan has high standards
[20:14:10] <eddyb> if I can edit a commit that's not HEAD, that's a bonus
[20:16:07] <eddyb> strcat: thanks, I already like it :D
[20:16:44] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[20:16:44] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/En7n4g
[20:16:44] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[20:16:44] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[20:16:45] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/w3kj3w
[20:16:45] <ghrust> 13rust/06auto 149083cb2 15Kang Seonghoon: rustc: Explicitly mention type params with missing `'static` bounds...
[20:16:45] <ghrust> 13rust/06auto 14b4d9238 15bors: auto merge of #12572 : lifthrasiir/rust/owned-ptr-static-bound, r=alexcrichton...
[20:16:45] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[20:16:54] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[20:16:54] *** ChanServ sets mode: +ao dherman dherman
[20:17:23] <nmatsakis> cmr: comments welcome https://gist.github.com/nikomatsakis/9237628
[20:17:31] * eddyb takes a peek
[20:17:38] <cmr> nmatsakis: will get to it in  a sec
[20:18:42] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[20:18:48] <eddyb> nmatsakis: the description for Send seems to not include thread-safe ownership
[20:19:10] <strcat> eddyb: the existing GUIs all seem based on forking git rather than libgit2, so they spend all their effort dealing with parsing/pipes
[20:19:18] <eddyb> lol
[20:19:18] <strcat> and break on git updates
[20:19:37] <eddyb> (which is what I know Send is about - like Arc<T> is Send even though it doesn't really own its contents)
[20:19:54] <strcat> could make a *really* nice libgit2 API for rust
[20:20:07] <eddyb> we might have someone attempting that already
[20:20:31] <nmatsakis> eddyb: I don't know what "threadsafe ownership" means
[20:21:08] <strcat> eddyb: maybe efl would work nicely as a rust gui toolkit
[20:21:21] <strcat> modern C...
[20:21:54] <eddyb> nmatsakis: T: Send means that you can move T to a different thread without breaking memory safety, AFAIK
[20:21:56] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[20:22:05] <eddyb> strcat: is that elementary?
[20:22:16] <acrichto> nmatsakis: that sounds fantastic, I would be very interested to learn about the impact it has
[20:22:36] <strcat> eddyb: yes, enlightenment foundation libraries
[20:23:02] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[20:25:23] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[20:25:23] *** ChanServ sets mode: +qo brson brson
[20:28:07] *** Parts: edwardw (Mibbit@4112974A.B4358688.30F15291.IP) ()
[20:33:52] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:33:57] <cmr> nmatsakis: looks good
[20:34:04] <cmr> nmatsakis: dangling link, though: [inv]
[20:34:37] <nmatsakis> cmr: yeah thanks, I think I want to update the "safety and unsafe code" section in light of the Mut<T> discussion acrichto and I were just having
[20:34:51] <nmatsakis> eddyb: yes, it does, I guess I think that's implied by ownership, but I'll add a note
[20:35:03] <eddyb> well, Arc has shared ownership
[20:35:26] <eddyb> depends how you define ownership, I guess
[20:35:26] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[20:35:32] <strcat> eddyb: I think efl would definitely work well from rust
[20:35:35] <strcat> looking through the APIs
[20:36:07] <eddyb> bah, can't push to github as of late
[20:36:14] * eddyb kicks the unicorn
[20:36:27] <strcat> although it does have the same init problem every GUI thing is going to have
[20:37:04] <eddyb> github doesn't seem to be down :/
[20:37:14] <eddyb> aaaand now it's slow to load
[20:37:27] * eddyb wanted to push the wip branch just in case he messes up
[20:38:43] <eddyb> okay, here it is, if anyone wants to taste the madness https://github.com/eddyb/rust/commit/e4b672e50f5f791d08f7b3eabb6c60636fb2a054
[20:39:16] <eddyb> (this is by far the most complicated git usage I've ever done)
[20:39:31] *** Quits: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca) (Ping timeout)
[20:39:49] <cmr> "Evil microsoft windows portability layer. "
[20:39:51] <cmr> that's awesome
[20:39:54] <cmr> (Evil being the name of the lib)
[20:43:58] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[20:43:58] *** ChanServ sets mode: +ao dherman dherman
[20:45:32] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[20:45:37] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[20:51:53] <cmr> eddyb: https://status.github.com/messages
[20:55:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:56:00] *** Joins: canhtak (canhtak@moz-251024EB.wl.t.ulaval.ca)
[20:59:18] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:01:16] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:01:16] *** ChanServ sets mode: +qo brson brson
[21:06:44] <eddyb> cmr: now I'm getting loads of cache hits :D
[21:07:00] <eddyb> (not sure what triggered a rebuild again :()
[21:07:23] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[21:07:23] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 14f91de33 to 149f32ce8: 02http://git.io/k471pw
[21:07:23] <ghrust> 13rust/06try 1443e4e89 15Alex Crichton: std: Small cleanup and test improvement...
[21:07:23] <ghrust> 13rust/06try 1447e18c8 15Alex Crichton: native: Improve windows file handling...
[21:07:23] <ghrust> 13rust/06try 1476863fd 15Alex Crichton: rustc: Use libnative for the compiler...
[21:07:25] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[21:12:27] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[21:13:26] <eddyb> nmatsakis: ahh, I won't be able to get you explicit deref today, I don't have tests :(
[21:13:46] <nmatsakis> eddyb: you're forgiven ;)
[21:13:54] <eddyb> but it will compile soon
[21:14:07] <eddyb> *sigh* so much time spent playing with spaghetti
[21:14:20] <nmatsakis> you're making very fast progress
[21:14:46] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[21:15:57] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[21:15:57] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:17:48] <eddyb> nmatsakis: I wouldn't call it fast, not at all "very fast", I guess progress is better than not getting anything done
[21:18:10] <eddyb> I think I know how to do mutable-aware method lookup... and it's very hacky
[21:18:25] <eddyb> basically, run two deref loops
[21:18:51] <eddyb> the first one tries mutable on everything, falling back to immutable
[21:19:07] <eddyb> if a candidate isn't found, try with only immutable
[21:19:15] <flaper87> acrichto: you had a patch for this https://travis-ci.org/mozilla/rust/builds/19683276 right ?
[21:19:27] <flaper87> well, at least for the PassWrapper thing
[21:19:47] <eddyb> nmatsakis: with the right combination of magic, it may even give nice errors for map.borrow().insert(k, v) for free :D
[21:20:27] <eddyb> I don't really know how strict the method lookup is for things like that
[21:21:18] <eddyb> we only care about mutability in typeck with overloaded derefs, everything else is going to get checked by borrowck, I would think
[21:22:11] <eddyb> nmatsakis: feel free to take a look around https://github.com/mozilla/rust/pull/12491
[21:29:40] <eddyb> struct Point {x: int, y: int} let x = RefCell::new(Point {x: 0, y: 0}); (*x.borrow_mut()).x = 4; print!("{:?} ", *x.borrow()); (*x.borrow_mut()).y += 3; println!("{:?}", *x.borrow());
[21:29:45] <eddyb> so this works :)
[21:31:44] <eddyb> and the other branch has some of the code in place that should be easy to modify to propagate mutability
[21:31:46] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[21:31:46] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/w3kj3w
[21:31:46] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[21:32:02] <eddyb> waaait I didn't fix regionck :/
[21:38:37] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[21:38:40] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[21:39:54] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[22:00:02] <eddyb> there, that should make travis happy :D
[22:05:52] <acrichto> flaper87: yeah I'm working on it
[22:05:54] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[22:08:35] <flaper87> acrichto: ok cool! thanks
[22:09:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:11:50] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:13:29] *** Joins: doomlord__ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[22:13:40] *** Quits: doomlord__ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Client exited)
[22:14:27] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[22:14:51] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:16:55] <SiegeLord> Re the opt-in kinds... it's going to really suck when a 3rd party library forgets to implement a kind
[22:17:24] <SiegeLord> With normal traits, you can wrap up a type into a local type... but I don't think that's possible with a kind, no?
[22:17:39] <eddyb> depends on the kind
[22:18:22] <SiegeLord> Like you forget to implement Pod... struct PodAttempt(NonPod); won't be Pod
[22:18:30] <SiegeLord> Unless you can just slap on the Pod kind no matter what
[22:18:43] <eddyb> no, the compiler wouldn't let you
[22:19:07] <SiegeLord> And same for Send, and a few others I imagine?
[22:19:39] <eddyb> Send should be forceable, I would think
[22:19:53] <eddyb> though... it might not need to be
[22:20:06] <eddyb> depends on how you implement things like Arc
[22:20:11] <SiegeLord> Unless the coherence rules are relaxed for these kinds
[22:20:23] <SiegeLord> In which case you can implement kinds on 3rd party types
[22:20:36] <eddyb> no
[22:21:12] <SiegeLord> No what
[22:21:23] <eddyb> coherence wouldn't be relaxed for kinds
[22:21:43] <SiegeLord> Well then it's a ticking issue... maybe there could be a lint for it then :P
[22:22:04] <SiegeLord> "This type could implement this kind... how about doing it, eh?"
[22:22:05] <eddyb> yeah, I was thinking you rather want #[allow(missing_kinds)]
[22:22:18] <eddyb> when you don't opt-in
[22:22:40] <eddyb> though the choice between allow and deriving... it's a bit verbose
[22:23:02] <eddyb> depends how many types can implement kinds they don't want to implement
[22:23:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:23:07] <eddyb> nmatsakis: ^^
[22:23:37] <SiegeLord> That seems like a complicated decision to have to make for every new type you write
[22:24:00] <SiegeLord> I'd personally just slap the deriving on everything and hope the lint reminds me when I forget
[22:24:23] <nmatsakis> SiegeLord:  to some extent, this is already an issue
[22:24:31] <nmatsakis> e.g. Eq, etc
[22:24:42] <SiegeLord> You can wrap a type and implement Eq on it
[22:24:48] <nmatsakis> eddyb: I'm planning to gather some statistics on that
[22:25:01] <SiegeLord> Since Eq doesn't care what type it is implemented on
[22:25:03] <nmatsakis> eddyb: or rather, on how my types impl traits they don't *need* :)
[22:25:22] <nmatsakis> I see
[22:25:29] <nmatsakis> that's true that Pod is not as forgiving
[22:25:29] <eddyb> nmatsakis: pretty graphs pls :D
[22:25:54] <nmatsakis> SiegeLord: I'll add that to the RFC as a comment
[22:26:16] <eddyb> a lint for Eq & friends seems valuable
[22:26:34] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:26:45] <nmatsakis> yes
[22:27:11] <eddyb> if it checks whether the deriving impl won't cause type errors (i.e. all non-generic fields implement the trait)
[22:27:23] <nmatsakis> (I'll be honest, I don't know what's best here. But obviously this can only be explored NOW.)
[22:27:39] <nmatsakis> (And I do think it's one of the lingering areas in the language with a lot of friction)
[22:27:54] *** Quits: tjc (tjc@moz-C767A933.bad.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[22:28:33] <eddyb> if only #[deriving(Data)] could be even smaller
[22:28:39] <eddyb> #data struct Foo {...}
[22:29:13] <eddyb> hmm
[22:29:22] <eddyb> #encodable #decodable struct Bar {...}
[22:29:27] <eddyb> there's a certain appeal to that
[22:31:47] <eddyb> acrichto: can we disable travis after the first LLVM failure?
[22:32:10] <eddyb> feels pointless to keep testing PRs only to fail
[22:32:53] <eddyb> unless you want to do something smart, like pin down the nightly package's version
[22:39:45] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[22:43:36] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[22:44:43] <huon> eddyb: ccache's biggest help is when you have to rebuild an LLVM you've already built previous (e.g. checked out an older branch), because then it'll pretty much all be in cache.
[22:45:17] <eddyb> huon: for some reason the second LLVM rebuilt today had to redo ~400 files
[22:45:26] <eddyb> but everything was taken from the cache
[22:46:32] <cmr> redo as in re-compile and re-cache?
[22:47:55] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[22:47:55] *** ChanServ sets mode: +o tjc
[22:51:00] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[22:54:10] <eddyb> cmr: re-compile and cache, those were cache misses
[22:54:53] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[22:54:53] *** ChanServ sets mode: +qo brson brson
[22:58:18] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[22:59:12] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Connection reset by peer)
[23:04:51] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[23:05:11] <acrichto> Eridius: ping
[23:05:46] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:07:59] <Eridius> acrichto: pong
[23:08:10] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[23:08:10] <ghrust> [13rust] 15alexcrichton pushed 1 new commit to 06try: 02http://git.io/YrrUtg
[23:08:10] <ghrust> 13rust/06try 14c7a8785 15Alex Crichton: attempted fixes
[23:08:10] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[23:08:11] <acrichto> Eridius: have you ever seen windows paths with \\?\ ?
[23:08:33] <Eridius> I don't use Windows, but \\?\ is necessary for, among other things, having paths that are longer than ~250 characters
[23:08:45] <acrichto> what would happen if I just strip it out?
[23:08:54] <Eridius> then you can change the interpretation of the path
[23:08:57] <acrichto> http://buildbot.rust-lang.org/builders/try-win/builds/907/steps/compile/logs/stdio
[23:08:58] <Eridius> \\?\ doesn't interpret . and ..
[23:09:01] <acrichto> I don't think gcc understands it
[23:09:11] <Eridius> so \\?\foo\bar\..\baz ~= \foo\baz
[23:09:38] <Eridius> acrichto: hrm well, I don't know how command-line stuff in Windows deals with paths
[23:09:39] <acrichto> is there any way to get it stripped?
[23:10:26] <Eridius> I suppose one could write a method that strips it and ensures the resulting path has the same meaning, which can be done by re-adding the \\?\ (after the stripped path is normalized) and seeing if you get the original path back
[23:10:33] <Eridius> if not, then some path component was reinterpreted differently
[23:10:57] <acrichto> does our path stuff handle this?
[23:11:00] <Eridius> although you can't just trim out the \\?\ directly because \\?\foo\bar doesn't have an equivalent without \\?\
[23:11:03] <acrichto> or is there a windows thing I need to call?
[23:11:07] <Eridius> you could do this sort of transformation for \\?\D:\ paths though
[23:11:10] <Eridius> no, we'd have to do this directly
[23:11:34] <acrichto> what if I'm guaranteed the drive is in front of it?
[23:11:38] <Eridius> it never occurred to me that there'd be cases where D:\foo works but \\?\D:\foo doesn't
[23:11:40] <acrichto> http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx
[23:11:50] <acrichto> hm wrong link
[23:11:51] <Eridius> there's 3 types of verbatim prefixes in WindowsPath
[23:11:54] <Eridius> one of them is for the drive variant
[23:12:16] <Eridius> if you ensure you have that particular prefix, you can do the transformation I mentioned before, where you strip the \\?\ and make sure no path component is reinterpreted differently
[23:12:18] <acrichto> http://msdn.microsoft.com/en-us/library/windows/desktop/aa364962%28v=vs.85%29.aspx
[23:12:20] <acrichto> that link
[23:12:31] <Eridius> I suppose what you could do is pull the drive letter out, and build a new path from .components()
[23:12:34] <acrichto> how do I know how to inerpret it?
[23:12:40] <Eridius> and then iterate over the .components() of both the old and new and make sure they're the same
[23:12:55] <acrichto> sounds like I'm just gonna strip it
[23:13:01] <acrichto> "Return the path with the drive letter. This is the default."
[23:13:07] <acrichto> sounds like it's absolute already
[23:13:10] <Eridius> uinlaterally stripping is dangerous
[23:13:18] <Eridius> there's no such thing as a non-absolute \\?\ path
[23:13:30] <sfackler> man, windows paths are messed up
[23:13:30] <Eridius> but there are \\?\ paths without a drive prefix
[23:13:36] <Eridius> acrichto: for example, \\server\share paths
[23:13:44] <Eridius> become \\?\UNC\server\share
[23:13:47] <Eridius> it's crazy
[23:14:06] <Eridius> acrichto: is this an emergency, or can it be fixed sometime tonight?
[23:14:14] <Eridius> sfackler: no kidding
[23:14:37] <acrichto> this is just for readlink() on windows
[23:14:46] <acrichto> I'm using GetFinalPathNameByHandle
[23:14:53] <acrichto> which states "Return the path with the drive letter. This is the default."
[23:14:58] <acrichto> but it has this weird \\?\ in front
[23:15:02] <acrichto> and I have no idea what that is
[23:15:12] <Eridius> I can write the function I mentioned before, a method on WindowsPath that returns Option<WindowsPath> and strips the verbatim prefix
[23:15:14] <acrichto> and when passed through to gcc it appears to die
[23:15:19] <Eridius> (where it returns None if it can't represent the same path without verbatim)
[23:15:27] <Eridius> but I won't have time until tonight
[23:15:31] <acrichto> why is it bad to strip it?
[23:15:36] <acrichto> I know it's an absolute path?
[23:15:38] <Eridius> because it changes the interpretation of the path
[23:15:48] <acrichto> how?
[23:15:56] <acrichto> I don't understand what this even is
[23:16:12] <Eridius> http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247.aspx
[23:16:23] <Eridius> welcome to the rabbit hole :)
[23:16:30] <acrichto> "To specify an extended-length path, use the "\\?\" prefix"
[23:16:41] <Eridius> \\?\ disables filesystem interpretation of the path
[23:16:51] <acrichto> "because the "\\?\" prefix may be expanded to a longer string by the system at run time"
[23:16:58] <acrichto> I don't want interpretation?
[23:17:03] <acrichto> this is coming from windows itself
[23:17:04] <Eridius> \\?\D:\foo\..\bar actually refers to a file "bar" inside a folder named ".." inside a folder "foo" inside D:
[23:17:08] <acrichto> why does it need to interpret anything?
[23:17:22] <Eridius> whereas D:\foo\..\bar is the same as D:\bar
[23:18:13] <Eridius> basically, you can take any standardized non-verbatim path, prefix \\?\, and get the equivalent verbatim. But you can't go the other way, because verbatim can represent things that non-verbatim can't
[23:18:25] <Eridius> sorry, make that any path with a drive letter
[23:18:38] <Eridius> \\server\share paths get turned into \\?\UNC\server\share but otherwse can be transformed the same way
[23:19:11] <acrichto>  jeez this is awful
[23:19:13] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[23:19:15] <Eridius> hah
[23:19:26] <Eridius> WindowsPath was a PITA to deal with
[23:19:38] <Eridius> and I still have the open issue about figuring out how volume-relative windows paths should be handled
[23:19:42] <Eridius> e.g. whether we should, in fact, handle them at all
[23:20:00] <erickt> acrichto: if Lovecraft designed APIs, he would have designed the windows path API
[23:20:05] <acrichto> lol
[23:20:17] <Eridius> anyway, I'll have time around ~9pm tonight to write the necessary function
[23:21:04] <acrichto> it'll probably take that long for it to finish testing anyway
[23:23:43] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:25:03] <erickt> acrichto: speaking of bors taking a while to run, jesse and I are planning to plan a testing hackathon in the next month or so. beyond things like writing a fuzzer and reducer, I also want us to see if we can figure out how to deal with our backlog problem
[23:25:37] <acrichto> erickt: awesome! I have a few ideas of how to speed things up
[23:25:53] <jdm> "planning to plan"
[23:26:36] *** Quits: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu) (Ping timeout)
[23:27:39] <erickt> :)
[23:28:37] <erickt> we had great fun last night talking about how useful it'd be to have a rust test case reducer
[23:29:22] <huon> like LLVM's bugpoint?
[23:29:34] <erickt> I know all the ICEs I've filed take 10-20 minutes to reduce down to the smallest demonstration
[23:29:39] <erickt> huon: exactly like bugpoint
[23:29:52] <huon> that'd be pretty cool
[23:30:10] <sfackler> one of the labs in the intro systems class at CMU had a test suite that used binary decision diagrams to generate a minimal, provably comprehensive set of test cases
[23:30:33] <sfackler> it'd totally be possible to do the same in Rust, but I'm not sure how restricted the set of functions would be
[23:30:35] <erickt> sfackler: jesse mentioned an algorithm like that
[23:30:36] <huon> (we could then have a bot running it on all github issues tagged ICE to try to distill them into the minimal test case)
[23:30:37] <sfackler> *functions it could test
[23:31:32] <erickt> and with the new fuzzer I'm trying to get jesse to write, we can have another bot that just randomly generates code and see what fails
[23:31:37] <huon> (getting that to work sanely in an automated fashion is probably near impossible anyway :( )
[23:31:57] <huon> yeah, just sits there for months running random data through the compiler
[23:33:13] <erickt> huon: I don't think it's that crazy. jesse's day job is creating test cases for firefox from an auto fuzzing/reducing sample code
[23:33:34] <huon> erickt: I meant running on the issues on github
[23:34:10] <huon> because the testcases won't necessarily compile correctly without human input (e.g. maybe it requires multiple files, or compiler flags)
[23:34:18] <erickt> we could add a `oh no, I ICE-ed! want me to submit this code and error to github?` prompt-and-submission to rustc
[23:34:27] <huon> (or there's a typo in the code)
[23:35:21] <huon> I'm nervous about that... we'd probably get a lot of dupes of issues (I guess we could try it, to see how bad it is.)
[23:35:22] <erickt> huon: or even better, it could prompt `I ICE'd! want me to reduce this code down to a small test case for a bug report?`
[23:35:48] <huon> yeah, that'd be cool
[23:36:22] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[23:36:22] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 14c7a8785 to 14ae8cc05: 02http://git.io/k471pw
[23:36:22] <ghrust> 13rust/06try 14ae8cc05 15Alex Crichton: attempted fixes
[23:36:22] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[23:36:48] <huon> erickt: btw, what time are the testing/doc meetups planned to be?
[23:37:10] <erickt> huon: I was hoping 12pm PST on 3/16
[23:38:04] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:38:04] *** ChanServ sets mode: +qo brson brson
[23:38:05] <erickt> but it's not locked in yet.
[23:39:08] <erickt> huon: that'd be a bit early for you though
[23:39:15] <huon> 6am, yeah
[23:39:50] <huon> (I assume it's going to be more than 2 hours?)
[23:39:52] <erickt> huon: would 9am work?
[23:40:15] <erickt> I was thinking 4 hours
[23:40:25] <huon> don't change the time just for me! If I really want to come to the whole thing I'll just wake up earlier :)
[23:40:32] <erickt> heh
[23:40:32] <erickt> ok
[23:40:42] <huon> I'm sure there's people in Europe who may want to join in
[23:42:08] <erickt> I figure the way we do the docathon there won't be any presentations, just maybe a google doc on a monitor of all the things we want written up
[23:42:23] <erickt> so people should feel free to come and go
[23:43:36] <huon> A style guide might be useful
[23:43:41] *** Quits: k4nar (quassel@moz-EE8DAF45.ip-91-121-75.eu) (Connection reset by peer)
[23:43:51] <erickt> steveklabnik: ping
[23:43:52] <huon> (at least for things like what an examples should have)
[23:44:03] <huon> and the correct use of plurals :/
[23:44:08] <erickt> yeah that would be really useful
[23:44:34] <huon> https://github.com/mozilla/rust/issues/4361
[23:44:46] <huon> https://github.com/mozilla/rust/issues/9403
[23:44:49] <huon> https://github.com/mozilla/rust/issues/11830
[23:47:07] <brson> erickt: the event tickets are filed for the 13th and the 16th, catering for both, pizza specifically on 16th. air mozilla for 13th is scheduled
[23:47:13] <brson> erickt: acrichto can't attend on the 16th
[23:47:19] <erickt> yay!
[23:47:20] <acrichto> :(
[23:47:21] <erickt> boo!
[23:47:23] <acrichto> lol
[23:47:38] <erickt> acrichto: where are your priorities?!
[23:47:45] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[23:47:47] * huon is happy to take acrichto's place... if someone arranges him a plane
[23:47:47] <acrichto> clearly not in the right place
[23:47:54] <erickt> clearly
[23:49:49] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Ping timeout)
[23:50:02] <erickt> brson: I just want to confirm with steveklabnik that that day works for him. If he says he can come, I'll send out the announcement tonight
[23:50:13] *** nrc is now known as nrc|afk
[23:50:36] <erickt> brson: I also have the speakers lined up too, so that'll also be out tonight. thanks for setting everything up again!
[23:54:22] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[23:55:18] *** Joins: ktt3ja (ktt3ja@moz-85E2770C.hsd1.va.comcast.net)
[23:55:32] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
