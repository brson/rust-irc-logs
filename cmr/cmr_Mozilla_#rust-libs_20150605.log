[00:01:14] <bluss> ok I think we have a segfault in LinkedList https://github.com/rust-lang/rust/issues/26021
[00:08:04] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:33:39] <Gankro> bluss:
[00:33:41] <Gankro> aw gone
[00:45:59] <Gankro> huon: What sort of comment are you looking for?
[00:56:15] <huon> Gankro: "the new list shouldn't point back to the end of the original one" or something
[00:56:26] <huon> or even just explain the two lines of code
[00:56:36] <huon> (the swap is also moderately non-obvious)
[00:57:55] <Gankro> huon: sure
[01:08:11] *** Joins: aatch (james@moz-5r41gb.6pd7.20lj.e000.2406.IP)
[01:41:38] <Gankro> acrichto: The linked list change doesn't need to be beta-nominated, the code is unstable.
[01:42:45] <acrichto> Gankro: the method is #[stable]?
[01:42:59] <Gankro> split_off and append are unstable
[01:43:25] <Gankro> wtf?
[01:43:26] <acrichto> Gankro: split_off on linked list has a #[stable] tag?
[01:43:35] <Gankro> when'd that happen!
[01:43:51] <Gankro> well ok then
[01:44:03] <acrichto> https://github.com/Gankro/rust/commit/b44ee371b8beea77aa1364460acbba14a8516559
[01:44:23] <acrichto> er no
[01:44:34] <acrichto> well before that somewhere most likely
[01:44:36] <acrichto> guh
[01:44:41] * acrichto is a helper
[02:50:57] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:59:22] *** Joins: kimundi_ (kimundi@moz-ghr.vgt.188.87.IP)
[03:01:54] *** Quits: kimundi (kimundi@moz-b6c.mnt.188.87.IP) (Ping timeout: 121 seconds)
[03:01:54] *** kimundi_ is now known as kimundi
[03:27:24] *** kimundi is now known as zz_kimundi
[05:06:51] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[05:13:19] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[05:22:12] <Gankro> *phew* finally updated enough of contain-rs stuff to stable to get blist working on stable. Stupid iter::cmp and hash::hash
[05:42:57] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:57:00] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[05:59:36] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[06:34:02] <Gankro> *tsk tsk* aturon, burning the midnight oil, are we?
[06:34:21] <aturon> good lord, you're watching your email like a hawk
[06:34:38] <aturon> and ... mostly feeling guilty about stuff blocked on me that i haven't managed to finish :P
[06:35:13] <Gankro> more of a convenient email updating/looking-at aliasing
[07:12:02] *** Quits: acharles (acharles@moz-ulbdcn.ca.comcast.net) (Ping timeout: 121 seconds)
[07:49:18] *** Quits: aatch (james@moz-5r41gb.6pd7.20lj.e000.2406.IP) (Connection closed)
[08:04:39] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[08:11:06] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Connection closed)
[08:13:40] *** Joins: acharles (acharles@moz-ulbdcn.ca.comcast.net)
[08:17:17] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[08:23:22] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[08:29:38] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[09:11:05] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[09:24:48] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[09:27:09] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[10:37:32] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[11:12:01] *** zz_kimundi is now known as kimundi
[11:22:23] *** Joins: killercup (killercup@moz-8bi.bjk.170.84.IP)
[12:36:47] *** Quits: killercup (killercup@moz-8bi.bjk.170.84.IP) (Connection closed)
[12:37:09] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[12:38:12] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Connection closed)
[12:38:26] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[12:55:20] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[13:42:15] *** Quits: cods (fred@moz-g6qd4k.net) (Ping timeout: 121 seconds)
[13:52:27] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[14:37:55] <bluss> libs team gave me r+ rights. crazy bastards. Thank you for trusting me with this responsibility!
[14:39:15] <huon> bluss: :)
[14:39:18] <huon> congrats!
[14:42:45] <Gankro> bluss: congrats!!!!!
[14:42:58] <Gankro> Now You Can Never Leave Us
[14:45:40] <bluss> thanks
[14:45:43] <bluss> wait, why not?
[15:00:04] <Gankro> That would be mean :_;
[15:36:18] <Gankro> bluss: brb, but can you try out `document.addEventListener("keyup", function (e){ console.log(e) });` and tell me what s/S/?/Esc spit out for you (maybe gist it)? I'm getting wonky results.
[15:38:58] <SimonSapin> acrichto: I just realized that all cases in current Unicode where char.to_lowercase().count() would be != 1 are conditional mappings, which we decided no to include
[15:39:16] <SimonSapin> so to_lowercase maybe could have returned char instead of an iterator
[15:39:34] <SimonSapin> but still, symmetry with to_uppercase is preferable
[15:39:42] <SimonSapin> and future Unicode versions might add more mappings
[15:43:16] <bluss> Gankro: from firefox https://gist.github.com/anonymous/f95c0f4526fbceb201b4
[15:43:35] <bluss> Gankro: keypress has charCode
[15:44:36] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[16:00:03] <aturon> SimonSapin: yeah, i think we would've stuck with an iterator even had we realized that
[16:00:29] <Gankro> bluss: hmm... it feels wrong to do stuff on keypress, but I suppose it could be acceptable
[16:01:21] <SimonSapin> I’m implementing that at the moment, as you might have guessed. Adding char::to_titlecase as well while I’m at it (it’s the same algorithm, just a different table) but not str::to_titlecase, since the latter require deciding what’s a "word"
[16:01:55] <bluss> Gankro: I am without sense for javascript, so better trust yourself
[16:02:21] <aturon> SimonSapin: thanks for doing that; it'll be great to bring the implementation actually in line with the spec we're giving
[16:03:16] <Gankro> bluss: without sense *is* javascript
[16:06:53] <SimonSapin> aturon: There is one contextual mapping that we could implemen in str::to_lowercase without language information, but I don’t know if it’s worth it
[16:08:22] <SimonSapin> Final_Sigma: C is preceded by a sequence consisting of a cased letter and then zero or more case-ignorable characters, and C is not followed by a sequence consisting of zero or more case-ignorable char-acters and then a cased letter
[16:08:33] <aturon> (sorry, i'm in a meeting now, will get back to you soon as i can)
[16:08:53] <SimonSapin> U+03A3 GREEK CAPITAL LETTER SIGMA maps to something different in that case
[16:09:27] <SimonSapin> no worries, I’m just thinking "out loud"
[16:13:17] <gleb> bluss: congrats! =)
[16:14:37] <bluss> gleb: thank you!
[16:43:20] <SimonSapin> filed https://github.com/rust-lang/rust/issues/26035
[16:50:12] <Gankro> I'd like to propose stabilising rc::try_unwrap
[16:50:23] <Gankro> It's necessary to soundly build a chain of Rc's
[17:31:29] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[17:33:56] <Gankro> acrichto: Any feelings on that?
[17:34:44] * acrichto looks
[17:35:38] <acrichto> Gankro: we'd probably want to move it to Rc::try_unwrap now
[17:35:42] <acrichto> at the very least
[17:35:53] <acrichto> and this would open the door to stabilizing a whole slew of Arc/Rc/Box flavorful methods
[17:36:03] <acrichto> e.g. if we provide any we may as well provide a bunch
[17:36:26] <acrichto> it's somewhat unclear to me how far we want to go
[17:36:37] <acrichto> in terms of stabilizing all the fancy methods
[17:36:46] <acrichto> Gankro: could you elaborate a little more on the use case?
[17:38:22] <Gankro> acrichto: Node{next: Option<Rc<Node>>} will blow the stack with recursive dtors unless you can de-rc the node when it's unique like you would with Box's unconditionally
[17:38:56] <acrichto> hmm
[17:39:19] <acrichto> I'd believe it
[17:42:10] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[17:43:50] <Gankro> acrichto: Alternatively, get my guaranteed dtor TCO ;)
[17:52:22] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:52:22] *** ChanServ sets mode: +qo brson brson
[17:56:41] <Gankro> acrichto: What's the motivation to put it on the type? That seems like an ergonomic regression until we can use methods as fns
[17:57:01] <Gankro> hmm... I suppose it does make the documentation more centralized
[17:57:29] <acrichto> Gankro: you already import Rc if you're working with it
[17:57:38] <acrichto> so use rc::{self, Rc} is actually more than you need
[17:57:43] <acrichto> so I would argue that it's an ergonomic improvement
[17:58:08] <Gankro> acrichto: Right, but I can't use Rc::try_unwrap and call it unqualified
[17:58:21] <Gankro> admittedly this is "rare" but something I like to ahve
[17:58:39] <acrichto> Gankro: these wouldn't be methods, just associated functions
[17:58:59] <Gankro> Does that change my claim?
[17:59:27] <acrichto> not sure what you mean by "call it unqualified"
[17:59:56] <bluss> oh you mean import `try_unrwap` into the namespace. Is that important though?
[18:00:08] <Gankro> use rc::try_unwrap; try_unwrap(some_rc)
[18:00:27] <acrichto> Gankro: ah, yeah that I would imagine is quite rare
[18:02:14] <Gankro> acrichto: I like it :(
[18:02:30] <acrichto> lol
[18:02:55] <Gankro> also: what precisely do I need to mark as deprecated in libcollections for bits? The two types? Everything individually?
[18:03:52] <acrichto> Gankro: I believe an annotation at the top of the module will do the trick
[18:03:57] <acrichto> deprecation is inherited, unlike stability
[18:04:00] <acrichto> or rather it should be
[18:04:03] <Gankro> #![deprecated] ?
[18:04:14] <acrichto> yeah
[18:04:21] <acrichto> with (reason = "...", since = "...")
[18:47:38] <aturon> Gankro: fwiw, in the long run we want to allow you to do things like `use Rc::try_unwrap;`
[18:47:55] <aturon> (and also for e.g. trait methods, which would be important UFCS-style)
[18:47:59] <aturon> imported*
[18:48:45] <Gankro> Yes, I know
[18:48:57] <Gankro> It is a teeny-tiny regression
[18:54:06] *** Quits: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com) (Connection closed)
[19:46:05] <Gankro> acrichto: Yeah that didn't work
[19:46:09] <Gankro> I don't understand deprecation
[19:46:35] <Gankro> Or at least, it's deprecated from the perspective of itself. But std docs still show it as "just" unstable
[20:16:10] <Gankro> aturon: how does stability even work?
[20:18:18] *** Joins: killercup (killercup@moz-0pf6i8.dip0.t-ipconnect.de)
[20:18:38] *** Quits: nmatsakis (nmatsakis@moz-no0.93r.245.63.IP) (Connection closed)
[20:18:59] *** Joins: nmatsakis (nmatsakis@moz-no0.93r.245.63.IP)
[20:18:59] *** ChanServ sets mode: +o nmatsakis
[20:56:54] *** Joins: SilverKey (SilverKey@moz-b7q751.biz.rr.com)
[20:57:45] *** Joins: WindowsBunny1 (Peter@moz-vlal7g.east.verizon.net)
[20:59:35] *** Quits: WindowsBunny (Peter@moz-vlal7g.east.verizon.net) (Ping timeout: 121 seconds)
[20:59:50] *** Joins: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com)
[21:04:16] *** Quits: SilverKey (SilverKey@moz-b7q751.biz.rr.com) (Quit: Cheerio!)
[21:32:48] <acrichto> Gankro: oh rustdoc isn't very smar
[21:32:49] <acrichto> smart*
[21:32:54] <acrichto> Gankro: I don't think rustdoc takes into account inheritance
[21:35:02] <aturon> Gankro: this is with something re-exported?
[21:35:35] <aturon> acrichto: you mean stability inheritance?
[21:35:43] <aturon> rustdoc should be incorporating that
[21:36:02] <aturon> because it's just reading out of the stability hashmap, which is populated using stability inheritance etc
[21:37:01] <Gankro> aturon I !deprecated libcollections/bits.rs in the hopes that would catchall bitvec and bitset
[21:37:07] <acrichto> aturon: oh hm...
[21:37:14] <acrichto> aturon: maybe it's prioritizing the stable tag on methods?
[21:37:24] <acrichto> Gankro: oh maybe I'm just bonkers then
[21:38:26] <aturon> Gankro: it looks like there are explicit stability markers throughout the files
[21:38:30] <aturon> so, to be clear:
[21:38:54] <aturon> the way this works is that if you set a stability level for some item (module, enum, etc) that's inherited by default
[21:39:02] <aturon> unless the level is "Stable" --
[21:39:17] <aturon> we don't inherit stable because we want it to be very clear at the local level when an API is stable
[21:39:21] <aturon> to avoid accidental breakage
[21:39:41] <aturon> "inheritance" means it's just a default, so if you apply additional attributes at a lower level, those override the default
[21:39:59] <aturon> oh but hm, it's possible that some of this changed with deprecation now being orthogonal to stable/unstable
[21:40:01] <aturon> brson: ^^
[21:40:24] <aturon> (there were some changes that brson made to this code once we went to release channels, and i'm not sure how it all plays out)
[21:40:35] <aturon> brson: concrete question: is the deprecated attribute inherited?
[21:41:29] <brson> aturon: no it is not
[21:41:33] <brson> afair
[21:41:41] <aturon> Gankro: ok, there's the answer
[21:43:31] <brson> it probably should. not a lot of chance to make mistakes with it
[21:44:53] <aturon> yeah, i tend to agree. there's also not a huge risk to making such a change since not much is deprecated at the moment. Gankro and acrichto, thoughts?
[21:45:44] <acrichto> yeah I'm fine changing the #[deprecated] attribute
[21:45:47] <acrichto> this is what we have nightlies for!
[21:45:51] <acrichto> (everyone will tell us if things break)
[21:48:35] <aturon> https://github.com/rust-lang/rust/issues/26040
[21:50:09] <Gankro> aturon: It would be easier, yes.
[21:51:38] <Gankro> aturon: I'd actually like to take a crack at implementation, if you can point me to the right place
[21:51:44] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[21:51:47] <aturon> Gankro: most definitely!
[21:51:57] <aturon> Manishearth: ^ you're off the hook
[21:52:38] <aturon> Gankro: https://github.com/rust-lang/rust/blob/master/src/librustc/middle/stability.rs#L53-L108
[21:53:15] <Manishearth> haha
[21:57:53] *** Quits: killercup (killercup@moz-0pf6i8.dip0.t-ipconnect.de) (Quit: Bye)
[22:26:22] <acrichto> oh wow we have a lot of beta-nominated T-libs issues
[22:27:46] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[22:28:45] <aturon> acrichto: maybe we should toss up a separate triage note on discuss?
[22:29:46] <acrichto> aturon: yeah may as well
[22:29:47] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[22:29:52] <acrichto> so many notes to discuss
[22:29:59] <acrichto> the firehose is just moving from github to discuss :\
[22:31:06] <aturon> hmm, i do hope that e.g. the reports at least manage to tease out the truly important highlights... but i hear you. (at least it's fed from github!)
[22:44:08] <Gankro> acrichto: What's the coles-notes advantage of subtrees over submodules?
[22:44:36] <acrichto> Gankro: if the submodule disappears the subtree can still work
[22:44:52] <acrichto> Gankro: there's no need for separate management of the subtree, it's "just there" when you clone the main repo
[22:45:07] <Gankro> acrichto: So it's litteral copy-paste modulo awareness of where it came from?
[22:45:26] <acrichto> Gankro: basically yeah, with some automated metadata in the commit message so `git subtree` can sort things out
[22:45:40] <Gankro> acrichto: Why have any submodules?
[22:46:16] <acrichto> Gankro: I'm not 100% sure, I was unaware of subtrees until yesterday, so the current submodules I believe are somewhat historical
[22:46:21] <acrichto> there's also different tradeoffs here and there
[22:46:30] <acrichto> with a subtree the subtree source can diverge from the upstream source
[22:46:39] <acrichto> whereas with a submodule they're always exactly the same (b/c it's pinned to a rev)
[22:47:15] <aturon> hm, submodules seem better for our goals here, then?
[22:47:16] <Gankro> acrichto: considering we already patch some of our submodules...
[22:47:57] <acrichto> aturon: I'm pretty worried about all these random submodules disappearing
[22:48:07] <acrichto> if we're going to add more and more for little dependencies
[22:48:15] <acrichto> weighty things like llvm/jemalloc/libuv we can maintain in rust-lang for sure
[22:48:20] <aturon> acrichto: what do you mean by "disappearing"?
[22:48:28] <acrichto> either the repo or the SHA in the repo disappears
[22:48:35] <acrichto> on the scale of years down the road
[22:48:54] <acrichto> in the sense of being able to check out an old Rust compiler and still being able to build it
[22:49:21] <aturon> i see. i guess the high-level bit for me is: the goal should be to remove redundancy and divergence. sounds like that will take a bit more discipline with subtrees.
[22:49:52] <aturon> and shouldn't be hard to set up infra to cache the contents of the SHA, which we could repoint to if needed?
[22:50:02] <acrichto> not retroactively though
[22:50:08] <acrichto> b/c the remote URL of the submodule is part of the git commit
[22:50:47] <aturon> hrmm ok, that does start to feel risky
[22:51:52] <acrichto> so we could just mirror everything
[22:52:00] <acrichto> but it ends up just being a not-so-great situation no matter what
[22:52:05] <acrichto> where we really just want Cargo to build Rust
[22:52:18] <Gankro> dooo iiiiit
[22:52:21] <aturon> +1
[22:52:58] <acrichto> but even that is fraught with problems
[22:53:07] <acrichto> for example our source tarball, when built, should never touch the network
[22:53:11] <acrichto> but Cargo likes to do that right now
[22:53:25] <acrichto> not to mention the whole cargo <-> rust circular dependency at that point
[23:16:08] <eternaleye> acrichto: Hm, 'git subtree' is _not_ in core git on my distro at least
[23:16:24] <eternaleye> acrichto: The subtree merge strategy is, but not the subcommand
[23:16:26] <acrichto> eternaleye: what version of git are you using?
[23:16:33] <eternaleye> acrichto: 2.3.1
[23:16:58] <eternaleye> acrichto: Perhaps your distro bundles apenwarr's addition?
[23:17:13] <acrichto> hm I read somewhere it was added in 1.7+
[23:17:37] <eternaleye> acrichto: I saw the same, but it may have been "added" by a distro
[23:17:39] <eternaleye> acrichto: Or added to contrib, and thus not always installed...
[23:18:05] <acrichto> hm, dunno
[23:21:32] <eternaleye> acrichto: Also, submodules aren't _that_ bad ergonomically on clone
[23:21:41] <eternaleye> acrichto: git clone --recursive is just plain nice
[23:21:59] <eternaleye> acrichto: (and should be the default IMO)
[23:22:05] <acrichto> eternaleye: my main worry is the "this repo disappeared" problem
[23:22:17] <acrichto> eternaleye: and you don't need git-subtree to check out a repo, just to add a subtree or update a subtree
[23:22:48] <eternaleye> acrichto: Yeah, but I worry that'd hurt in terms of developer on-ramp
[23:23:02] <eternaleye> acrichto: "Oh, you need <special tool X> to do that"
[23:23:30] <acrichto> eternaleye: no developer needs to touch the subtrees
[23:23:38] <eternaleye> acrichto: And IMO, that problem is a symptom, not the disease
[23:23:40] <acrichto> a subtree is just a special way of managing a directory in a git repo
[23:23:48] <acrichto> you can edit it at will (although you shouldn't)
[23:23:57] <eternaleye> acrichto: Cool URL's Don't Change, after all :P
[23:23:57] <acrichto> there's essentially 0 impact on new devs or anyone really working in rust-lang/rust
[23:25:01] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:26:56] <eternaleye> acrichto: It's the difference between "I made a change and need to either install a tool or prod someone else to get it updated in the other repo" vs "I need to use a tool I have, but may not know well in order to do it"
[23:27:19] <eternaleye> acrichto: It may not be a big difference, but it is one.
[23:27:25] <acrichto> sure
[23:27:51] <eternaleye> (And I've found "install something" to generally be the point of "whoah there")
[23:30:26] <eternaleye> Mm, yeah, looks like subtree is in contrib
[23:30:37] <eternaleye> So it won't necessarily be installed in general
[23:40:09] <Gankro> brew's git has subtree
[23:46:32] <eternaleye> Anyway, though - subtree being contrib does rather contradict the idea of submodules being "historical"
