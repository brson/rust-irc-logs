[00:24:58] <brson> edunham: please tell us if you do...
[00:30:56] <edunham> I have all the perms for creating accounts; PR to the site will be incoming soon to set up Travis stuff
[01:10:39] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Server shutdown)
[01:10:39] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (Server shutdown)
[01:10:39] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Server shutdown)
[01:10:40] *** Quits: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com) (*.net *.split)
[01:10:40] *** Quits: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[01:10:40] *** Quits: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP) (*.net *.split)
[01:10:40] *** Quits: simme (sid33727@moz-07u411.ealing.irccloud.com) (*.net *.split)
[01:10:40] *** Quits: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com) (*.net *.split)
[01:10:40] *** Quits: nrc (sid365@moz-3taf2s.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[01:10:40] *** Quits: WindowsBunny (Peter@moz-vlal7g.east.verizon.net) (*.net *.split)
[01:10:40] *** Quits: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com) (*.net *.split)
[01:10:40] *** Quits: edunham (edunham@moz-meu.gm8.131.104.IP) (*.net *.split)
[01:10:40] *** Quits: aji (alex@prickle.ajitek.net) (*.net *.split)
[01:10:46] *** Quits: Manishearth (manishearth@moz-uc30rq.anapnea.net) (Server shutdown)
[01:10:46] *** Quits: barosl (barosl@moz-tmp.qma.67.220.IP) (Server shutdown)
[01:10:46] *** Quits: xilec (Mibbit@moz-g6k.oht.161.46.IP) (Server shutdown)
[01:11:22] *** Joins: cmr (cmr@moz-35s2fm.members.linode.com)
[01:11:23] *** fripp.mozilla.org sets mode: -not cmr
[01:11:23] *** belew.mozilla.org sets mode: +nt 
[01:11:23] *** Joins: aji (alex@prickle.ajitek.net)
[01:11:23] *** belew.mozilla.org sets mode: +o aji
[01:11:44] *** Joins: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP)
[01:11:51] *** Joins: WindowsBunny (Peter@moz-vlal7g.east.verizon.net)
[01:11:54] *** fripp.mozilla.org sets mode: -not aji
[01:11:54] *** ircservices.mozilla.org sets mode: +nt 
[01:11:54] *** ChanServ changes topic to 'Rust Tools and Infrastructure subteam | https://botbot.me/mozilla/rust-tools/'
[01:11:54] *** ChanServ sets mode: +r 
[01:12:13] *** Joins: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com)
[01:12:13] *** ChanServ sets mode: +ao vadimcn vadimcn
[01:13:10] *** Joins: barosl (barosl@moz-tmp.qma.67.220.IP)
[01:13:17] *** Joins: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com)
[01:14:25] *** Joins: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com)
[01:15:14] *** Joins: simme (sid33727@moz-07u411.ealing.irccloud.com)
[01:15:43] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[01:15:43] *** ChanServ sets mode: +qo acrichto acrichto
[01:15:47] *** Joins: Manishearth (manishearth@moz-uc30rq.anapnea.net)
[01:15:47] *** ChanServ sets mode: +ao Manishearth Manishearth
[01:15:48] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[01:15:48] *** ChanServ sets mode: +ao brson brson
[01:15:54] *** Joins: edunham (edunham@moz-meu.gm8.131.104.IP)
[01:20:58] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[01:21:08] *** Joins: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP)
[01:21:16] *** Joins: nrc (sid365@moz-3taf2s.0j4i.jtu0.0101.2620.IP)
[01:21:17] *** ChanServ sets mode: +ao nrc nrc
[01:53:49] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[02:04:53] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:05:59] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[02:05:59] *** ChanServ sets mode: +ao brson brson
[02:07:52] <brson> acrichto edunham: I just completely hosed homu in dev while i was *attempting* to debug in prod
[02:09:16] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[02:25:17] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[02:27:37] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[02:40:36] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[03:22:38] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[05:42:32] *** Quits: barosl (barosl@moz-tmp.qma.67.220.IP) (Connection closed)
[07:17:16] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[09:59:45] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[11:16:59] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[12:58:55] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[13:06:23] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[13:06:25] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (A TLS packet with unexpected length was received.)
[13:10:38] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[17:15:46] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:15:46] *** ChanServ sets mode: +ao brson brson
[17:42:31] <brson> acrichto: do you know what is up with homu?
[18:01:08] <acrichto> brson: not sure, but you were poking it yesterday?
[18:01:12] <acrichto> brson: or was that only in dev?
[18:06:20] <brson> acrichto: i ruined dev and restarted prod. prod seemed to be moving when i went home but it's stuck again today
[18:06:37] <acrichto> brson: I restarted it this morning
[18:06:40] <acrichto> b/c it was stuck
[18:06:41] <acrichto> not sure why though
[18:06:45] <brson> gr what's going on?1
[18:06:56] * brson bites homu in the face
[18:07:16] <brson> that was violent, sorry
[18:07:22] <brson> i've got some pent up anger at homu
[18:10:08] <acrichto> brson: I'm going to restart homu and buildbot
[18:10:13] <acrichto> buildbot isn't picking up changes on the auto branch
[18:10:22] <brson> ok
[18:10:53] <acrichto>         exceptions.EnvironmentError: command on repourl git://github.com/rust-lang/rust.git failed with exit code 128: fatal: Couldn't find remote ref dist-snap
[18:10:56] <acrichto> brson: ^
[18:10:59] <acrichto> or maybe not
[18:11:03] <acrichto> we have a dist-snap branch?
[18:11:55] <brson> ah nrc was deleting branches yday
[18:12:06] <acrichto> looks like we don't use it anyway
[18:12:09] <brson> i think dist-snap is unused yes
[18:12:12] * acrichto restarts buildbot
[18:12:21] <brson> thanks
[18:13:15] <acrichto> brson: it'd be nice if we could add a github hook to prevent branches from being created
[18:13:18] <acrichto> just accidentally
[18:13:25] * acrichto wants to have permissions on all the things
[18:22:30] <edunham> https://github.com/rust-lang/rust-www/pull/149 and I need somebody with perms to push the travis button 
[18:22:56] <edunham> if "bring master up to date" and "make it push to s3" are too separate, i can redo as 2 PRs
[18:23:16] <acrichto> edunham: oh lemme just push gh-pages to master
[18:23:21] <acrichto> edunham: that should make the PR look nicer
[18:23:35] <edunham> yay, thanks :)
[18:24:53] <acrichto> edunham: ok done
[18:25:01] <acrichto> ah looks much nicer now
[18:25:10] <acrichto> you may want to rebase though
[18:25:15] <edunham> okay, np
[18:25:16] <acrichto> I just erased the 'first commit'
[18:25:34] <edunham> i'll just pull from the new master and cherry-pick the 2 commits on that i actually need xD
[18:25:46] <acrichto> edunham: switch also flipped
[18:25:49] *** Joins: xilec (Mibbit@moz-g6k.oht.161.46.IP)
[18:25:58] <edunham> acrichto: thanks!
[18:26:13] <acrichto> edunham: you may want to close and reopen?
[18:26:18] <acrichto> although a push may trigger travis
[18:26:22] <acrichto> I forget how it deals with that
[18:26:37] <edunham> travis doesn't actually do anything yet; one of my commits adds the .travis.yml
[18:34:24] <edunham> ok, https://github.com/rust-lang/rust-www/pull/150 much cleaner
[19:45:06] <brson> edunham: is the s3-deploy branch temporary or part of the plan?
[19:47:54] <brson> edunham: is this deployment going to invalidate cloudfront?
[19:48:25] <brson> it would be so cool if travis knows how to make that just work
[19:49:11] <edunham> brson: nah that branch was just temporary
[19:49:23] <edunham> though if you want a workflow where travis builds $otherbranch, i could make that happen
[19:50:16] <brson> edunham: nope
[19:50:29] <brson> edunham: do you actualy want that branch merged or was it just for review?
[19:50:33] <brson> (i merged it)
[19:50:39] <edunham> brson: merging it was correct :)
[19:51:30] <edunham> first step is verifying that travis still deploys to the s3 bucket when it's switched from my fork to rust-lang
[19:52:31] * edunham looks up whether we can automatically invalidate cloudfront when files change on the bucket
[19:54:11] <brson> macs are going down so i can move them elsewhere for the ww
[19:58:01] <edunham> one detail of auto-invalidation is that the first 1,000 individual objects invalidated per month are free but then there's a per-object charge
[19:58:34] <edunham> so automatic invalidations run infrequently are no big deal, but if it was a daily or multiple-per-day thing it could potentially get expensive
[19:58:50] <edunham> I'd prefer to start out with just a lower TTL on the objects
[20:03:41] <brson> i don't know. it's nice to see your stuff deployed quickly
[20:04:08] <brson> invalidations cost fractional pennies i think
[20:16:02] <edunham> ok yeah, we only have 50 paths in the site, so invalidating twice a day for a month would only be a $5 surcharge
[20:19:59] * edunham had previously done the math assuming significantly larger website
[20:21:23] <brson> the macs are not coming back up
[20:21:56] <brson> i bet this ethernet port is inactive
[20:25:41] <edunham> brson: so, I think we can kind of do invalidation via travis, with clever hax:
[20:25:58] <edunham> It's possible to invalidate via the API, http://docs.aws.amazon.com/AmazonCloudFront/latest/APIReference/CreateInvalidation.html , but you need an AWS authorization string.
[20:26:29] <edunham> It's possible to generate that authorization string, http://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html , but you need to have the secret access key available.
[20:27:00] <edunham> It's possible to make the secret access key available to Travis without it being usable to anyone else on GitHub using automated encryption: http://docs.travis-ci.com/user/encrypting-files/
[20:27:45] <brson> sounds like a lot of work...
[20:28:00] <brson> can the ruby invalidation script we've already got on the buildmaster help?
[20:28:00] <edunham> However, considering the complexity of getting Travis to publish invalidations, my recommendtaion would be to set a moderately short TTL and see whether there are any problems.
[20:28:08] <brson> ok
[20:28:32] <brson> mac5 is crawling
[20:28:40] <brson> mac3 still hasn't come back online
[20:29:15] <edunham> the only situations I can think of where it's critical that users see a version of the site that's newer than an hour ago are special cases, like if we have to change the signing key in a hurry
[20:29:36] <brson> edunham: when we deploy the release next week we will want to see it immediately
[20:29:55] <brson> we do enjoy the quick turnaround now, with people pointing out problems then immediately fixing them
[20:30:09] <edunham> okay
[20:30:37] <edunham> and figuring out how to automate that invalidation would probably be useful to others as well
[20:30:55] * edunham files that as a weekend sort of project
[20:33:16] <brson> macs are all back
[20:56:44] <aturon> brson: the idea you've been floating about switching what we store in metadata to speedup and allow more pipelining in compilation -- what's a good name for that?
[20:57:25] <acrichto> superscalar compilation
[20:57:40] <acrichto> SIMC -- single invocation multiple compilation
[20:57:46] <acrichto> (these are all terrible names)
[20:57:53] <aturon> lol
[20:58:37] <aturon> it'd help if i could remember more details about the idea offhand, but alas my cache is undergoing a lot of contention at the moment :P
[20:58:37] <edunham> parallelizability?
[20:59:05] <brson> aturon: delayed code generation maybe
[20:59:19] <aturon> perfect, thanks
[21:00:39] <brson> i have one concern about the viability of the idea
[21:01:22] <brson> one of the hopes is that by doing the code generation later we can merge monomorphizations and do much less code gen
[21:01:46] <brson> this may not pan out if presently most monomorphizations get immediately inlined and the standalone function discarded during codegen
[21:02:07] <brson> ah, it'll pay off for debug builds for sure
[21:03:12] <aturon> brson: in any case, it's probably a good idea to try to estimate the impact before sinking much into this -- but for now i'm just trying to collect various potential priorities in a single place
[21:13:12] *** Quits: simme (sid33727@moz-07u411.ealing.irccloud.com) (Quit: Connection closed for inactivity)
[21:59:10] <brson> taskcluster almost has windows support so next q we should be able to get windows coverage
[21:59:54] <acrichto> brson: \o/
[22:03:43] <brson> acrichto: was the missing dist-snap confusing homu? how?
[22:03:54] <acrichto> brson: I don't think so?
[22:04:00] <acrichto> I believe homu merged as it should have
[22:04:03] <acrichto> buildbot just never did anything
[22:04:10] <acrichto> making it look like homu was wedged
[22:04:27] <edunham> https://testsite.rust-lang.org/ Just Works and http redirects to https
[22:04:58] <acrichto> edunham: nice!
[22:05:07] <edunham> I'll see if I can't get those invalidations working, since switching the www dns at 3pm on a friday is inviting disaster
[22:05:14] <acrichto> :P
[22:05:18] <acrichto> that was my next q (invalidations)
[22:05:35] <edunham> I mean, on the one hand it'll be obnoxious to automate once
[22:06:07] <edunham> on the other hand,if I can get Travis invalidating objects, it'll be useful elsewhere
[22:21:47] <edunham> had to fix https://testsite.rust-lang.org/not_a_page first, but now it's working
[22:25:53] <huon> acrichto: SIMC is a great name :P
[22:36:22] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[23:09:36] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:49:25] *** Quits: xilec (Mibbit@moz-g6k.oht.161.46.IP) (Ping timeout: 121 seconds)
