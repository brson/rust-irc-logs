[00:00:01] <Crnobog> There's nowhere that says "in the std lib, here are the traits that are impl'd for str"
[00:00:02] <pcwalton> dbaupp: pong
[00:00:05] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[00:00:08] <engla> bblum: only way you can hold a reference to a node in the interior is via an iterator. Currently the .mut_iter() allows inserting elements in the interior
[00:00:17] <doomlord> i would rework my own C++ source to avoid them
[00:00:22] <dbaupp> pcwalton: aatch and I experimented with a trait-visitor previously, summary here: https://github.com/Aatch/rust/issues/2
[00:00:56] <bblum> engla: how about removing?
[00:01:00] <strcat> rusti: let xs = [1, 2]; let a: *int = &xs[0]; let b: *int = &xs[1]; b - a
[00:01:01] <doomlord> i might look at mapping std::array<T,N> to a rust side precompiled array2<T> array3<T> ... for small N
[00:01:02] -rusti- <anon>:7:70: 7:75 error: failed to find an implementation of trait std::num::Int for *int
[00:01:02] -rusti- <anon>:7          let xs = [1, 2]; let a: *int = &xs[0]; let b: *int = &xs[1]; b - a
[00:01:03] -rusti-                                                                                ^~~~~
[00:01:03] -rusti- application terminated with error code 101
[00:01:09] <engla> bblum: not implemented!
[00:01:18] <strcat> rusti: let xs = [1, 2]; let a: *int = &xs[0]; let b: *int = &xs[1]; (b as uint) - (a as uint)
[00:01:20] -rusti- 8
[00:01:30] <dbaupp> pcwalton: I found the thing that worked "best" was defining a new simple "lint-visitor" that didn't recurse and only handled a subset of ast nodes (i.e. the ones relevant to linting) and wrapping that with the proper visitor. 
[00:01:35] <doomlord> i can hard-code mappings for my own types :)
[00:02:46] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:03:53] <doomlord> cmr: but is the node_id of the thing under the cursor just the thing under the cursor, or the id of the underlying type (which in turn the defmap makes sense of)
[00:04:05] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[00:04:10] <graydon> r? someone https://github.com/mozilla/rust/pull/7980  (just some more benchmarks & scaffolding)
[00:04:17] <cmr> doomlord: just the thing under the cursor
[00:04:26] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:04:42] <doomlord> (i'll try just what you suggested now, previously i was writing all sorts of debug to comprehend the thing under the cursor... finding my way around)
[00:05:01] <cmr> doomlord: ast::Ty is the type of a field of the ast nodes that need it
[00:05:31] <cmr> but the type's id is separate from the node id itself
[00:05:32] *** Quits: mccr8 (mccr8@moz-BBE3ABD.mv.mozilla.com) (Quit: mccr8)
[00:06:02] <tjc> graydon: r+'ed
[00:06:10] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:06:13] <dbaupp> graydon: out of interest, doesn't LLVM optimise away the dead code in the iter { }'s?
[00:06:24] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[00:06:44] <doomlord> so i presume thats what i need ... so i do infact need to do all this drilling down through the ast nodes to get at that i guess
[00:07:08] <sully> oh, argh, how do I reenable debugging?
[00:07:15] <bblum> brson: yeah, i think comm simply doesn't need to reexport the select trait
[00:07:20] <cmr> sully: --cfg debug, --enable-debug to the configure script
[00:07:56] <graydon> dbaupp: I don't know. that would be unfortunate. they don't all benchmark to the same thing, but I suppose it's possible.
[00:08:25] <graydon> dbaupp: those are really just sketchwork so people feel like they can write benchmarks. I keep getting the "how do I write a benchmark" question. it should be pretty clear by now?
[00:08:41] <graydon> I am hoping it becomes as natural as unit testing. so far, not quite
[00:08:46] <ChrisMorgan> brson: have you seen what I've been doing with my HTTP server?
[00:09:16] <dbaupp> graydon: yeah, I've been using it quite a bit... it's very nice. :)
[00:09:31] <strcat> dbaupp: the trick to making it not optimize stuff out for benchmarks is #[inline(never)]
[00:09:40] <strcat> you put it in a never-inline utility fn
[00:09:43] <strcat> and then benchmark that
[00:09:56] <dbaupp> strcat: that's pretty annoying, in terms of usability.
[00:10:05] <graydon> dbaupp: I am trying to get the buildbot to upload the .json files that get saved from that. hopefully they will start to be available tonight.
[00:10:24] <strcat> dbaupp: sure, but otherwise it will treat most as no-ops ;p
[00:10:32] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:10:37] <strcat> once we don't have layers of wrapping around FFI calls at least
[00:10:51] <dbaupp> graydon: ok, cool, I assume it will keep historical ones, so I don't need to download them as they come?
[00:10:54] <strcat> and ideally some way of propagating readnone/readonly past crate boundaries
[00:10:57] <graydon> dbaupp: yes
[00:12:03] <graydon> dbaupp: they're going in static.rust-lang.org/build-metrics/<git-sha1>/<builder>/<slave>/<metricsfile>.json
[00:12:39] <graydon> easiest thing I could wire up. if we need to dispose of old ones at some point we can revisit.
[00:12:39] <dbaupp> strcat, graydon: I could imagine the .iter method taking a closure that returned -> T (or even just int) and doing something with it to allow the closure to make sure the code is not dead.
[00:12:47] <dbaupp> graydon: sounds good.
[00:13:04] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[00:13:45] <dbaupp> graydon: (although, unless there is a central directory of some sort, I'm going to have to poll all the different slaves. but that's not particularly a problem.)
[00:14:20] <graydon> dbaupp: I think you'll need to watch a specific slave if you want stable numbers
[00:14:44] <graydon> dbaupp: and/or I think we'll need to pin at least some perf tests to a specific slave
[00:14:46] <dbaupp> graydon: right, but I'm going to want to suck everything down
[00:15:19] <graydon> yeah, unfortunately
[00:15:25] <graydon> I could put them in tarballs if you prefer?
[00:15:29] <graydon> (or "as well"?)
[00:15:58] <dbaupp> I have no problem with whatever, the downloading-results part of the scripts is the simplest.
[00:16:06] <graydon> ok. let's try as-is.
[00:17:02] <brson> ChrisMorgan: no. is it cool?
[00:17:09] <ChrisMorgan> Currently at http://hg.chrismorgan.info/rusthttpserver
[00:17:46] <olsonjeffery> ive been wanting to see this
[00:17:49] <ChrisMorgan> I just saw your comment about consensus on the joyent parser at #6167
[00:17:52] *** Quits: ysuzuki (ysuzuki@moz-36FBA934.net124047241.t-com.ne.jp) (Ping timeout)
[00:18:37] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[00:18:37] <ChrisMorgan> "Consensus" sounds like there are multiple people involved in sorting this stuff out; who are they?
[00:19:11] <brson> ChrisMorgan: unless otherwise stated, when I say 'consensus' I usually mean that patrick and I agree :-/
[00:19:34] <ChrisMorgan> Patrick being pcwalton?
[00:20:05] <brson> well, that's not really true at all, but yes, in this case, that's what it means. pcwalton and I agree we should use joyent's parser
[00:20:13] <olsonjeffery> is it a goal to land this library in extra?
[00:20:16] <olsonjeffery> or will it remain separate?
[00:20:32] <olsonjeffery> the http server, that is.
[00:21:34] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[00:22:30] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[00:22:35] <bblum> is multithreaded LLVM the reason that stage1 rustc is like twice as slow as stage0?
[00:22:51] <ChrisMorgan> I was working on my own HTTP parser with that, visible from http://hg.chrismorgan.info/rusthttpserver/file/tip/src/librusthttpserver/request.rs#l79 (those two methods). Optimisations like making no allocations were something I was going to be heading towards. Hadn't come across the joyent parser.
[00:23:09] <cmr> ChrisMorgan: it's pretty good
[00:23:20] <cmr> can't handle generic http methods
[00:23:24] <ChrisMorgan> Well, I had come across it briefly, but not paid any attention to it at that time as I wasn't writing my server yet.
[00:23:26] <cmr> that's the only limitation I know of
[00:23:44] <cmr> (I have a patch to fix it... kinda broken, haven't gone back to look at it in a while)
[00:24:10] <ChrisMorgan> It's certainly making various optimisations along the same lines as the ones I had been considering.
[00:24:30] <dbaupp> bblum: we just had a snapshot, so stage0 and stage1 should be pretty close
[00:24:40] <bblum> dbaupp: just mid-today?
[00:24:49] <bblum> i only pulled this morning
[00:24:56] <bblum> the slowdown was definitely there on friday
[00:24:58] <strcat> and they're busy turning spdy into http2.0 ;p
[00:24:59] <bblum> and is there on my copy
[00:25:03] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[00:25:08] <dbaupp> bblum: (it was yesterday for me... different timezones.)
[00:25:20] <bblum> dbaupp: ok, i last pulled like 7 hours ago?
[00:25:27] <olsonjeffery> rm-std-net has been at the top for a while.. is the build wedged? or just slow-going?
[00:25:33] <dbaupp> bblum: I guess so
[00:25:42] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[00:25:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JQnSpA
[00:25:42] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[00:25:43] <olsonjeffery> pretty nifty to see that land.
[00:26:20] <dbaupp> bblum: https://github.com/mozilla/rust/commit/74f4badcab30c91b018f308d2c44641abed7d732
[00:26:47] <cmr> olsonjeffery: nice timing :p
[00:27:37] <ChrisMorgan> brson: anyway, my Rust HTTP server is there, or the beginnings of it. I have Grand Ideas for it and the framework that will follow.
[00:27:39] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[00:27:53] <dbaupp> bblum: (are you building with ./configure --disable-optimize or something?)
[00:28:01] <bblum> dbaupp: no
[00:28:04] <brson> ChrisMorgan, olsonjeffery: sorry, talking, one min
[00:28:21] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[00:28:35] <cmr> irsy saw a perf hit with multithreaded LLVM, but it wasn't 2x
[00:28:36] <toddaaro> hm? is rustc being slower than it should be?
[00:28:37] <ChrisMorgan> Why exactly is std::ascii in src/libstd/str/ascii.rs rather than src/libstd/ascii.rs?
[00:28:38] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[00:28:38] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/TP16Vg
[00:28:38] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[00:28:39] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:28:39] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/SRyt_Q
[00:28:39] <ghrust> 13rust/06auto 14921d991 15Jeff Olson: std: add RtioTimer and UvTimer impl atop rt::uv
[00:28:39] <ghrust> 13rust/06auto 145da29e3 15Jeff Olson: std: add rt::io::Timer
[00:28:39] <ghrust> 13rust/06auto 14155470f 15Jeff Olson: std: minor timer cleanup based on feedback
[00:28:40] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[00:28:43] <olsonjeffery> cmr: i like to think, quite self-deprecatingly, that going down the rabbit of those first several iterations of libuv integration precipitated the current, excellent newsched work
[00:28:46] <graydon> \o/ oldnet is dead
[00:28:49] <graydon> night all
[00:28:51] <olsonjeffery> rabbit-hole, even
[00:29:07] <graydon> olsonjeffery: that is absolutely true
[00:29:14] *** Quits: yonran (yonran@moz-962F33EB.acuitus.com) (Ping timeout)
[00:29:19] <MaikKlein1> I am nearly finish with https://github.com/mozilla/rust/pull/7969 can someone have a quick look and tell me if I made some mistakes?
[00:29:25] <graydon> your suffering provoked the current strategy. sorry :(
[00:29:45] <dbaupp> MaikKlein1: https://github.com/MaikKlein/rust/commit/631fc19f98db2023ecc11397f5a7960a7110cfe7 ;P
[00:29:54] <graydon> I mean, sorry it happened to you! but we wouldn't have realized it had to change unless someone had barged in there and discovered it
[00:29:54] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:29:55] <olsonjeffery> graydon: we all stand upon giant's shoulders
[00:30:02] <MaikKlein1> dbaupp, :D
[00:30:06] *** Quits: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP) (Quit: Leaving.)
[00:30:35] <dbaupp> MaikKlein1: also https://github.com/mozilla/rust/pull/7969/files#L4R179 could be `do result.chain |config| { ... }`, unless there's some reason why that doesn't work?
[00:31:05] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:31:06] <dbaupp> MaikKlein1: (looks good other than that.)
[00:31:27] <dbaupp> MaikKlein1: also, you already need to rebase it.
[00:31:28] <MaikKlein1> dbaupp, hm not really I just wrote it, I can make a change ofc
[00:31:29] *** Joins: Guest__ (textual@moz-E64A54F3.nyc.res.rr.com)
[00:31:37] <MaikKlein1> dbaupp, oh ok
[00:33:29] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[00:33:52] <MaikKlein1> dbaupp, what is the best way,? should I create a new branch and then update my master to the current master and merge my branch with the master? 
[00:34:01] * MaikKlein1 not sure if this was clear
[00:34:23] <cmr> MaikKlein1: fetch the mozilla ref, `git rebase -i mozilla/master` (or upstream or whatever you use)
[00:34:23] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Quit: jclements)
[00:34:23] <dbaupp> MaikKlein1: no, just a rebase is fine (http://git-scm.com/book/en/Git-Branching-Rebasing)
[00:34:56] <MaikKlein1> okay thanks
[00:35:27] <Diamond> Does std or extra have an XML encoder/decoder?
[00:35:33] <cmr> Diamond: no
[00:35:40] <Diamond> cmr: kk, thanks.
[00:37:11] *** Quits: Guest__ (textual@moz-E64A54F3.nyc.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:37:27] *** Joins: tavoe (Mibbit@moz-F85B6108.student.rit.edu)
[00:38:14] <MaikKlein1> oh the net folder is gone :)?
[00:39:07] <sully> hm
[00:39:17] <sully> it seems like there might be a test that fails if you enable debugging...?
[00:39:23] <sully> conditional-debug-macro-off
[00:39:33] <tavoe> I'm just digging into rust. I'm having a lot of trouble figuring out the difference between enums and structs
[00:39:46] <dbaupp> MaikKlein1: yeah, extra::net got deleted
[00:39:48] <dbaupp> sully: https://github.com/mozilla/rust/issues/7898
[00:39:59] <steven_is_false> How do I edit history deeper then the last commit in git? (I accidentally rebased with the >>>>>>>>>>>>>>>>>>>>>>>>>>>>> line still in it.)
[00:40:12] <dbaupp> steven_is_false: rebase -i
[00:40:17] <steven_is_false> dbaupp: Oh right.
[00:40:35] <cmr> tavoe: structs are single-layout record types, enums are "tagged unions", a variant id plus a variable-layout area that can fit every variant in the enum
[00:40:50] *** Joins: sp3d (a@moz-49806493.dhcp.stls.mo.charter.com)
[00:40:55] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[00:41:19] <dbaupp> steven_is_false: I guess `git rebase -i hashyouwanttoedit^` and put an e as the command on the first line
[00:41:34] <steven_is_false> Yep I've got it working
[00:41:45] <dbaupp> cool :)
[00:42:39] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Quit: ecr)
[00:43:27] <Thad> brson: hmm, so Dwarf2 only for now ?
[00:43:28] *** Quits: mye (mye@moz-4DC329CE.dip0.t-ipconnect.de) (Quit: mye)
[00:45:30] <tavoe> So. Ok. Whenever I deal with an instance of an enum, I need to deal with every potential form it may take?
[00:45:52] <cmr> tavoe: yes.
[00:46:57] *** Joins: huhlig-work (huhlig@moz-62A47D90.aoltw.net)
[00:47:00] <kmc> cmr: is there a compelling reason why structs aren't written as enums with only one ctor?
[00:47:00] <steven_is_false> Okay, so I had to rebase https://github.com/mozilla/rust/pull/7978 . That means someone else needs to r+ it again right?
[00:47:24] <huhlig-work> question. I am trying to understand a bit of rust code. What does foo: *() mean in terms of datatype?
[00:47:57] <shachaf> hi kmc
[00:48:19] <shachaf> Good to see that you're pushing the cause.
[00:48:27] <steven_is_false> huhlig-work: That's an unsafe pointer to a unit value.
[00:48:29] <cmr> huhlig-work: raw pointer to unit type (corresponds to void* in C)
[00:48:36] <huhlig-work> ahh
[00:48:38] <huhlig-work> ok
[00:48:40] <strcat> *() isn't really like *void
[00:48:46] <shachaf> kmc: I think the memory-layout argument is reasonable but the relationship should be closer to newtype-data in Haskell.
[00:48:57] <strcat> void isn't zero-size, it's an opaque type
[00:48:57] <shachaf> A restricted version of the same basic construct that gives you more guarantees.
[00:49:08] <strcat> enum Foo { } *Foo is like *void
[00:49:31] <cmr> kmc: because then your struct isn't a type, it's a variant of a different type.
[00:49:41] <huhlig-work> its basically just a pointer to random information though
[00:49:43] <shachaf> And also very often when people use structs they don't actually care about memory layout.
[00:49:53] <shachaf> Which seems annoying because maybe you lose some good optimizations or something.
[00:50:11] <steven_is_false> Arguable, *() is better than *void because *() is *(âˆƒA.A) whereas *void is *(âˆ€A.A) but in actual practise *void is safer to use.
[00:50:27] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[00:50:30] <strcat> you really want *SpecificOpaqueType most of the time
[00:50:40] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[00:50:41] *** Quits: eholk (eholk@223C5EED.83FFA18A.ABD5273E.IP) (Quit: eholk)
[00:50:48] <huhlig-work> steven_is_false, what is âˆƒ vs âˆ€?
[00:50:59] <strcat> steven_is_false: you can make arbitrary pointer casts in safe code anyway
[00:51:09] <steven_is_false> âˆƒ means forsome, or exists. âˆ€ means forall
[00:51:15] <huhlig-work> ahh ok
[00:51:16] <steven_is_false> They are universal quantifiers.
[00:51:25] <steven_is_false> I mean quantifiers.
[00:51:31] <steven_is_false> Only  is the univer
[00:51:34] <shachaf> steven_is_false: *void might let you read from it, which is a problem, but *() might let you write to it, which is also a problem.
[00:51:50] <shachaf> Neither seems really "correct" as such.
[00:51:55] <steven_is_false> shachaf: Don't you need *mut () for that?
[00:51:59] <shachaf> OK, true.
[00:52:03] <bjz> rusti: enum Foo;
[00:52:03] -rusti- <anon>:7:17: 7:18 error: expected `{` but found `;`
[00:52:04] -rusti- <anon>:7          enum Foo;
[00:52:04] -rusti-                           ^
[00:52:04] -rusti- application terminated with error code 101
[00:52:07] <bjz> rusti: enum Foo {}
[00:52:08] -rusti- ()
[00:52:10] <shachaf> I was translating a thought over from Haskell-land.
[00:52:27] <bjz> rusti: extern;
[00:52:27] -rusti- <anon>:7:15: 7:16 error: expected `{` or `mod` but found `;`
[00:52:27] -rusti- <anon>:7          extern;
[00:52:28] -rusti-                         ^
[00:52:28] -rusti- application terminated with error code 101
[00:52:32] <bjz> rusti: extern {}
[00:52:32] -rusti- ()
[00:52:38] <huhlig-work> I am assuming that pub struct Closure { code: *(), env: *()} is magical
[00:52:43] <shachaf> Anyway pointers are weird so I'd still say that neither is quite correct, but I don't know the right answer.
[00:52:47] <kmc> cmr: the one-ctor enum is a type though
[00:52:48] <dbaupp> huhlig-work: yes
[00:52:49] <shachaf> Maybe a specialized type.
[00:52:52] <bjz> rusti: struct Foo; impl Foo;
[00:52:53] -rusti- ()
[00:52:53] <kmc> and the ctor could have the same name as the type itself
[00:52:56] <kmc> which makes it much like a struct
[00:53:11] <cmr> kmc: ok, sure. what an awful interface though
[00:53:17] <kmc> why?
[00:53:30] *** Joins: lkuper (lkuper@8518F121.A402E718.C082B7DC.IP)
[00:53:32] <cmr> Why would I use an enum when I want a struct?
[00:53:34] <kmc> it's not like Haskell or OCaml has special syntax for algebraic data that happens to have only one constructor
[00:53:35] <shachaf> If it's an awful interface then enums should be made more convenient rather than replaced with a nearly-identical construct.
[00:53:50] <kmc> you just write an algebraic type and only give it one constructor
[00:53:59] <dbaupp> kmc: and then we could have this syntactic sugar for it, like, e.g., `struct Foo {x: int } ` == `enum Foo { Foo { x: int } }` ;P
[00:54:00] <cmr> structs don't replace enums, and enums always have a variant tag
[00:54:17] <dbaupp> cmr: single variant enums don't need the variant tag
[00:54:26] <shachaf> I thought enum representation wasn't defined anywhere and could be optimized freely.
[00:54:37] <kmc> well, why shouldn't the compiler optimize away the tag in the one-variant case? since it already does the much more specialized optimization for the layout of Option<@T>
[00:54:47] <cmr> good point
[00:54:56] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[00:55:04] <shachaf> The question is why you'd want to make a special case with a keyword and everything for 1-enums, as opposed to every other kind of enum.
[00:55:16] <cmr> I don't come from a haskell or ML background, and removing `struct` as a concept seems entirely backwards to me
[00:55:18] <shachaf> They're all just algebraic data.
[00:55:27] <cmr> (I don't even know what algebraic data means0
[00:55:41] <shachaf> It means "algebraic data type" when you forget to write one word. :-)
[00:55:52] <cmr> (that either)
[00:56:00] <kmc> "enum" is a pretty misleadingly suggestive name in Rust
[00:56:23] <shachaf> Algebraic data type means a sum of products. As in "enum", pretty much.
[00:56:32] <brson> ChrisMorgan olsonjeffery: the intent is to have both http client and servo code in a package in the officially supported package incubator, not necessarily in extra
[00:56:37] <brson> *server
[00:56:44] <brson> ChrisMorgan: does your http code also handle the client side?
[00:56:55] <MaikKlein1> ohoh I messed sth up in git :X
[00:56:57] * dbaupp thinks kmc and/or shachaf could send an email to the mailing list so that this can get a proper answer once and for all
[00:57:10] <ChrisMorgan> There will be a lot of shared code between a client and server, but I've only dealt with server thus far.
[00:57:12] <kmc> cmr: yeah, Rust's "enum" gives you general algebraic data.  any number of constructors, each with any number of fields
[00:57:12] <brson> ChrisMorgan: is the new tcp code working, uh, at all?
[00:57:19] <ChrisMorgan> brson: sure, I'm using it.
[00:57:26] <brson> that's pretty stunning
[00:57:33] <shachaf> dbaupp: Has no one brought it up before?
[00:57:48] *** Quits: BitPuffin (quassel@moz-1789B472.bredband.tre.se) (Ping timeout)
[00:57:54] <bjz> rusti: fn foo();
[00:57:54] -rusti- <anon>:7:17: 7:18 error: expected `{` but found `;`
[00:57:54] -rusti- <anon>:7          fn foo();
[00:57:55] -rusti-                           ^
[00:57:55] -rusti- application terminated with error code 101
[00:57:59] <bjz> rusti: fn foo() {}
[00:57:59] -rusti- ()
[00:58:01] <ChrisMorgan> I couldn't get it to work at first, but once I was told that I needed to set RUST_NEWRT=1... the code that I'd already written just started working immediately.
[00:58:08] <dbaupp> shachaf: not that I've seen, but I've only been around for 8 months or so (and I haven't been paying complete attention.)
[00:58:50] <bjz> rusti: trait Foo;
[00:58:50] -rusti- <anon>:7:18: 7:19 error: expected `{` but found `;`
[00:58:50] -rusti- <anon>:7          trait Foo;
[00:58:50] -rusti-                            ^
[00:58:51] -rusti- application terminated with error code 101
[00:58:52] <shachaf> I think both kmc's and my first reaction to tutorial.html was "why is struct such a special case?".
[00:58:58] <shachaf> But I shouldn't speak for kmc, anyway.
[00:59:00] <kmc> basically yes
[00:59:07] <bjz> rusti: trait Foo {} impl Foo for int;
[00:59:08] -rusti- ()
[00:59:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:59:24] <brson> ChrisMorgan: we also want servo to use the official http client library, so rust should eventually have pretty much the most baddass standard http library ever
[00:59:34] <ChrisMorgan> Yeah!
[01:00:11] <ChrisMorgan> I really do have grand plans for Rust HTTP, both client and server. For example, why use string typing for headers all the time?
[01:00:20] <kmc> cmr: so I think removing "struct" seems backwards only because the names "struct" and "enum" are meant to evoke similar-but-different things in C.  if you renamed "enum" to "data" then keeping only that might seem more reasonable
[01:01:11] <shachaf> I think a small syntactical change to not require naming the constructor and type separately -- as in struct -- could be nice.
[01:01:15] <kmc> (I don't actually care what the name is, just suggesting a thought experiment)
[01:01:18] <SiegeLord> What is wrong with interpreting `struct` as sugar for a single variant enum?
[01:01:29] <shachaf> SiegeLord: struct gives you memory layout guarantees.
[01:01:41] *** Joins: zslayton (Mibbit@moz-14AA87A9.nyc.res.rr.com)
[01:01:46] <kmc> Haskell and SML and OCaml use "data" and "datatype" and "type" respectively for what Rust calls "enum"
[01:01:49] <shachaf> (Which most of the time people don't actually care about when they use struct. At least, from the Rust code I've read.)
[01:01:53] *** Quits: lkuper (lkuper@8518F121.A402E718.C082B7DC.IP) (Quit: lkuper)
[01:02:16] <cmr> shachaf: so do struct variants
[01:02:22] *** Joins: jdeng (Mibbit@93ECFED8.A76EF962.BBBE4A37.IP)
[01:02:25] <kmc> really? heh
[01:02:36] <cmr> well, that might be an implementation detail
[01:02:37] <shachaf> struct variants?
[01:02:49] <cmr> but right now it's literally struct_variant_kind(@struct_def) in the ast
[01:03:18] <cmr> shachaf: yes, enum Foo { Bar {a: int, b: uint} } Bar is a struct variant
[01:03:23] <brson> Thad: yes, at the moment rust only supports dwarf
[01:03:23] <shachaf> Ah.
[01:03:27] <shachaf> I thought that was just syntactic.
[01:03:36] <shachaf> If it isn't then that's kind of weird.
[01:03:37] <cmr> It might be, but that's not how it is implemented
[01:03:49] <dbaupp> shachaf, kmc: I have this feeling that either struct needs to be removed entirely, or the current state of affairs maintained, e.g. having `enum Foo { x: int, y: int }` (as sugar for a single enum variant) would lead to a lot of confusion and bugs: "which struct do I need" / "why is this C code getting junk"
[01:03:56] *** Joins: scroy (roy@moz-F152D5C3.washdc.fios.verizon.net)
[01:04:02] <shachaf> cmr: Implementation and semantics are two different things. :-)
[01:04:11] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[01:04:12] <cmr> shachaf: not in rust, not right now :)
[01:04:20] <dbaupp> (of course, there may be other ways to get around this.)
[01:04:20] <kmc> that's too bad
[01:04:32] <shachaf> cmr: I don't really believe that.
[01:04:38] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[01:04:43] <kmc> even if you only have one compiler and no formal spec, it would be nice to separate "intentional features with guarantees" from "compiler quirks that may go away at any time"
[01:04:45] <shachaf> The distinction exists, even if it's mostly in people's heads.
[01:05:08] <Thad> brson: bummer... on mingw-builds...I only see seh or sjlj available for x64 architecture... and for x32, only dward and sjlj.   Does that mean I have to build my own specific toolchain then for Dwarf with x64 architecture !?!?  anyone ?
[01:05:39] <shachaf> dbaupp: I mentioned before that Haskell's data/newtype seems like one reasonable approach for this.
[01:05:58] <brson> Thad: no, even if you have a dwarf toolchain unwinding isn't going to work. unwinding is very platform/toolchain specific, so we can just have different implementations as needed
[01:06:00] <jensnockert> Thad: No, I don't think Dwarf is supported by LLVM on x86-64
[01:06:01] <dbaupp> shachaf: maybe, newtype would correspond to struct?
[01:06:04] <Luqman> Thad: dwarf will not work on win 64 afaik
[01:06:04] <shachaf> dbaupp: They have the same syntax, but a different memory representation, and newtype is restricted to have exactly one variant containing exactly one field.
[01:06:10] <shachaf> dbaupp: Right.
[01:06:19] * dbaupp has written quite a bit of Haskell
[01:06:26] <shachaf> dbaupp: OK. :-)
[01:07:01] <ChrisMorgan> Instead of request.headers["Last-Modified"] being a string, have request.last_modified be an extra::time::Tm, and instead of Accept-Encoding being ~"gzip, deflate", let it be more like request.accept_encoding == ~[Gzip, Deflate]. And so forth for *all* the known headers.
[01:07:03] <brson> Thad: the best approach to just get something working now is to conditionally compile all the stuff that doesn't exist on x64, leaving unwinding broken
[01:07:06] <kmc> but the particular distinction between one-ctor 'data' and 'newtype' doesn't make sense in Rust
[01:07:06] <dbaupp> shachaf: I don't quite see how that would be different to the current struct and enum situation?
[01:07:13] <brson> Thad: then implement graydon's return-unwinding strategy on all windows
[01:07:18] <bblum> brson: maybe your perspective will figure this out sooner than mine... so i have all my select tests passing, and all the other ones too, but then i tried adding an assertion in the "task resumes" point of recv() that packet.state == STATE_ONE (and a corresponding packet.state.store(STATE_ONE) in the "state was already STATE_ONE" branch of the 1st half of recv
[01:07:23] <shachaf> dbaupp: Well, using a one-variant enum has a different syntax from using a struct.
[01:07:31] <brson> Thad: in fact on both x32 and x64 windows we can just not compile any of the dwarf unwinding code
[01:07:32] <shachaf> dbaupp: And it's awkward enough that people don't do it.
[01:07:47] <cmr> And why would I? There's no real point to it :\
[01:07:55] <engla> but newtype structs are useful in rust, with autoderef they are easy to use
[01:07:57] <shachaf> Almost every struct I've seen in "real Rust code" could've been an enum.
[01:08:02] <bblum> brson: but then shared_port_stress test starts failing, sometimes on the assertion; sometimes it segfaults on that packet.state.store (packet == NULL), and sometimes on the assertion in ChanOne's destructor. What invariant did I violate?
[01:08:05] <dbaupp> cmr: gives the compiler more room to optimise (in theory)
[01:08:08] <jdeng> Regarding to this issue, https://github.com/mozilla/rust/issues/7743 when trying to replace ast::ident with ast::Name in ast::Lifetime, results in quote_item expansion error, do you have any hints?
[01:08:18] <cmr> dbaupp: what optimizations could be done?
[01:08:20] <dbaupp> jdeng: hi! (i'm huonw)
[01:08:26] <Thad> brson: righto, that's what I remember reading. OK... and so will the unwinding implementation (the future) , use some of seh as suggested by the ming guys ?
[01:08:29] <dbaupp> cmr: don't know. (hence the "in theory")
[01:08:31] <cmr> I could *maybe* see some stuff with PGO and reordering fields.
[01:08:34] <shachaf> cmr: E.g. reÃ¶rdering the fields.
[01:08:38] <cmr> But that would be very miniscule
[01:09:08] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[01:09:11] <dbaupp> cmr: I guess { x: u8, y: uint, z: u8 } could become {x :u8 , z: u8, y: uint} and save a word
[01:09:12] <Thad> brson: or is Graydon's patches completely re-inventing the wheel for Rust on x64 ?
[01:09:16] <shachaf> It's also just a question of making data type declarations more uniform.
[01:09:17] <jdeng> >Hi, huonw :-)
[01:09:37] <shachaf> Right no there's this ugly special case for 1-ary sums.
[01:09:40] <jdeng> I am new to IRC
[01:10:12] <brson> Thad: probably in the distant future. we're somewhat dependent on the tools llvm gives us. yes, graydon's patch is a wheel-reinvention and will impose a noticable perf hit on windows
[01:10:17] <dbaupp> jdeng: don't worry we're friendly :) (unfortunately, I personally can't help you more than I have on github.)
[01:10:48] <SiegeLord> I think the reorganization is a niche enough thing that could be relegated to a manual optimization...
[01:11:25] <SiegeLord> Or a lang item or something
[01:12:07] <dbaupp> shachaf: there will "always" have to be a special case for 1-ary sums. (Could you write an example of the data/newtype suggestion, I'm still unclear on the syntax.)
[01:12:47] <dbaupp> shachaf: (in the sense that there always needs to be some way to guarantee C layout for 1-ary sums.)
[01:13:13] <shachaf> dbaupp: I haven't thought about the syntax very much. :-)
[01:13:34] <dbaupp> shachaf: then what are you doing proposing changing it! :P
[01:13:34] <shachaf> But assuming you come up with some syntax for 1-ary enums, it'd be the same thing, just with a different keyword.
[01:14:00] <cmr> I'd be fine with an attribute for layout guarantees
[01:14:36] <dbaupp> ah, so what you're saying is that 1-ary enums should act like structs?
[01:14:46] <pcwalton> 1-ary enums do act like structs
[01:14:48] <brson> bblum: I'm not seeing anything obvious
[01:14:50] <dbaupp> (i.e. `.` accessors etc.)
[01:14:55] <pcwalton> 1-ary enums and structs are lowered into the same thing internally in trans, see trans/adt.rs
[01:14:57] <dbaupp> pcwalton: does . work?
[01:15:02] <pcwalton> oh, no
[01:15:06] <shachaf> So with the current enum syntax, which is a bit verbose for this, it might just be enum Foo { Foo { x: char, y: int } } --> cenum Foo { Foo { x: char, y: int } }
[01:15:08] <pcwalton> I'm just saying in codegen
[01:15:13] <shachaf> And you'd want . to work and so on.
[01:15:16] <shachaf> Like structs.
[01:15:46] <shachaf> So the only distinction would be that you're restricted to one variant (so the tag is eliminated) and you have a guarantee of the memory layout to be FFI-compatible.
[01:16:02] <cmr> shachaf: we don't need dedicated syntax for that
[01:16:08] <brson> bblum: though it's interesting that it's only SharedPort that's failing - i was a little worried about how correct SharedPort is. still, i don't know why anything in SharedPort specifically would be causing that error
[01:16:14] <cmr> #[layout="C"]
[01:16:20] <shachaf> cmr: Works for me!
[01:16:31] <engla> so the idea is to eliminate the overlap between enum and struct?
[01:16:32] <bblum> brson: yeah, SharedPort looked largely fine to me... tomorrow i'll give it a closer look
[01:16:38] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Connection reset by peer)
[01:16:45] <shachaf> engla: Right.
[01:16:55] <bblum> brson: either way i expect to have a select pull request tomorrow
[01:17:00] *** Quits: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:17:49] <MaikKlein1> what replaces extra::net?
[01:18:00] <olsonjeffery> MaikKlein1: std::rt::io
[01:18:01] <cmr> MaikKlein1: std::rt::io::net
[01:18:29] <Luqman> brson: will io eventually move out of std::rt to just std?
[01:18:29] <MaikKlein1> will it always be in rt?
[01:19:28] <brson> Luqman: yes
[01:19:40] <brson> once old std::io dies, rt::io will move up
[01:20:14] <cmr> brson: do you think this work will land by 0.8?
[01:20:19] <cmr> it seems that way to me
[01:20:26] <olsonjeffery> we need to figure out async
[01:21:03] <olsonjeffery> should std::rt have its own Future<T> that uses the scheduler, directly, instead of just spawning? or should extra::future move into std?
[01:21:16] <brson> cmr: I'm hopeful, yes, but we may not be able to purge all the old io code by then
[01:21:25] <olsonjeffery> sorry for segue, heh. still thinking about the earlier conversation
[01:21:25] *** Quits: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP) (Quit: Quitting)
[01:22:08] <brson> olsonjeffery: if async io requires futures then we'll need to put them in std. I'm not sure that extra::future is the true future of rust though. it's got some problems
[01:22:12] <olsonjeffery> brson: speaking of which.. so i read up a bit more.. and what c# 5.0 does is really germain to their language and runtime.. there's a novelty to the Task<T> parallel stuff because of the CLR's more traditional threading model..
[01:22:12] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Client exited)
[01:22:29] <olsonjeffery> but i think rust kind of sidesteps that because capital-T Tasks as a first-class concept
[01:23:29] <olsonjeffery> and, aside from pushing the Task<T> into the main-loop or another thread in a pool in an asp.net runtime context, all of the await/async stuff is compiler glue
[01:24:01] <brson> olsonjeffery: i suspect so. by integrating with the scheduler I hope we can have a similar model, and without creating a bunch of tasks too. when they put a task into a threadpool or whatever they do, we'll instead create a uv callback
[01:24:28] <brson> i have to go right now though. sorry. i'll be back later
[01:25:05] <olsonjeffery> cheers
[01:25:05] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[01:25:29] <shachaf> cmr: So this is the kind of thing people post to a mailing list?
[01:25:31] <ChrisMorgan> olsonjeffery: s/germain/germane/
[01:25:37] <cmr> shachaf: yes
[01:25:42] <ChrisMorgan> 'Tis a good word.
[01:25:45] <olsonjeffery> so it is.
[01:26:02] *** Quits: jdeng (Mibbit@93ECFED8.A76EF962.BBBE4A37.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[01:26:42] <strcat> rusti: std::uint::max
[01:26:43] -rusti- <anon>:7:9: 7:23 error: cannot determine a type for this bounded type parameter: unconstrained type
[01:26:43] -rusti- <anon>:7          std::uint::max
[01:26:43] -rusti-                   ^~~~~~~~~~~~~~
[01:26:43] -rusti- application terminated with error code 101
[01:27:10] <dbaupp> rusti: std::uint::max_bound
[01:27:11] -rusti- <anon>:7:9: 7:29 error: unresolved name `std::uint::max_bound`.
[01:27:11] -rusti- <anon>:7          std::uint::max_bound
[01:27:11] -rusti-                   ^~~~~~~~~~~~~~~~~~~~
[01:27:11] -rusti- error: aborting due to previous error
[01:27:11] -rusti- application terminated with error code 101
[01:27:11] *** Joins: vladimir-lu (vladimir-l@moz-428433D9.cable.virginmedia.com)
[01:27:25] <strcat> rusti: std::uint::max_value
[01:27:25] -rusti- 18446744073709551615
[01:30:51] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[01:30:52] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[01:31:57] <scroy> hey guys
[01:32:02] <scroy> http://ix.io/6Ot
[01:32:32] <scroy> trying to write a Y-combinator based on the Ocaml/Haskell versions here http://rosettacode.org/wiki/Y_combinator#OCaml
[01:34:20] <scroy> http://ix.io/6Ow with the error at the top
[01:34:29] <scroy> should have put that first
[01:35:37] <MaikKlein1> rusti: std::uint::max_value + 1
[01:35:38] -rusti- 0
[01:35:48] <scroy> so, I'm basically not following what type crimes i'm commiting
[01:35:53] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[01:36:29] <shachaf> Negative recursion is a type crime in the first place. :-)
[01:36:29] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:37:01] <scroy> more of a misdemeanor or ...?
[01:37:10] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[01:37:25] *** Joins: sigma (sigma@CB3F6051.C886FCFF.DF0EE696.IP)
[01:38:30] <scroy> so how do i get the closures to close? my strategy so far is to try various combinations of sigils...
[01:39:06] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[01:39:06] <engla> scroy: did you try using @fn:'static() as a type
[01:39:51] *** Quits: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[01:40:38] <MaikKlein1> scroy, you could try let f_ = @|x| ....
[01:40:50] *** Quits: RMF (RMF@moz-348663EF.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[01:41:23] <engla> oh
[01:41:26] <strcat> dbaupp: well I made a really crappy random access trait
[01:41:27] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Input/output error)
[01:41:39] <strcat> it's weird though because bounded ints don't exactly work well for possibly infinite things
[01:42:14] <dbaupp> strcat: right, yeah. :(
[01:42:25] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[01:42:35] <dbaupp> strcat: `RandomAccess<Accessor>`?
[01:42:42] <strcat> well that's kinda weird too.
[01:42:50] <strcat> dbaupp: traits don't work that well yet
[01:43:06] <strcat> it's not going to let me implement indexing for multiple types of accessors
[01:43:10] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[01:43:14] <dbaupp> strcat: in what way? (Accessor would be `uint` in the most common case.)
[01:43:15] <shachaf> scroy: Huh, it works.
[01:43:16] <dbaupp> strcat: oh
[01:43:49] <dbaupp> strcat: you can use the work around http://smallcultfollowing.com/babysteps/blog/2012/10/04/refining-traits-slash-impls/
[01:43:56] <shachaf> By works I mean runs out of stack, because I didn't write a proper fixed point function, just an infinte loop.
[01:44:00] <shachaf> But that's all I was going for. :-)
[01:44:00] <strcat> I don't feel like more workaroiunds
[01:44:02] <strcat> ;p
[01:44:04] <strcat> will just be uint-only for now
[01:44:16] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[01:44:24] <dbaupp> strcat: why do you need to implemented it for more than just uint, anyway?
[01:44:29] <dbaupp> *implement
[01:44:31] <strcat> doesn't really
[01:44:45] <strcat> just means it needs 'indexable' instead of 'len'
[01:45:00] <dbaupp> hm?
[01:45:36] <strcat> I'll send a PR and you'll see
[01:46:27] <scroy> shachaf: really? it won't compile for me
[01:46:50] <shachaf> scroy: No, I don't mean your code. I'm just a bit surprised I can make this sort of thing "work" at all.
[01:46:53] <scroy> MaikKlein1: did try that
[01:46:54] <shachaf> Let me see about making fix work.
[01:47:00] <strcat> dbaupp: because of ones like chain
[01:47:29] <dbaupp> strcat: oh, yes.
[01:48:58] <shachaf> scroy: I was just doing (\x -> runRec x x) (Rec (\x -> runRec x x))
[01:49:01] <shachaf> (Haskell syntax.)
[01:49:03] <scroy> engla: not sure how to use it. I am pretty new to this and still wrapping my head around lifetimes
[01:49:21] <strcat> dbaupp: https://github.com/mozilla/rust/pull/7982 I'm not sure if it makes sense
[01:49:24] <strcat> dbaupp: it works though
[01:49:48] <strcat> hm
[01:50:14] <strcat> ok so it's not exactly right
[01:50:22] * strcat has to think for a sec
[01:51:15] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[01:51:20] <strcat> yeah the docstring on indexable is wrong
[01:53:33] <strcat> dbaupp: alright fixed
[01:53:41] <strcat> thoughts?
[01:54:59] <dbaupp> looks good, although I'm slightly uncomfortable with keeping it fixed to `uint`
[01:55:04] *** Quits: int3_ (int3_@moz-7B0110AD.mv.mozilla.com) (Client exited)
[01:55:30] <dbaupp> e.g. it'd be nice to have RandomAccessIterator on HashMap<&str, T>
[01:55:41] <dbaupp> (but that can come later.)
[01:56:01] <strcat> dbaupp: accessing with a &str isn't random access though
[01:56:05] <strcat> it only makes sense as an integer
[01:56:08] <strcat> for the adaptors to make sense
[01:56:09] <dbaupp> why not?
[01:56:16] <strcat> because it needs to be countable
[01:56:21] <strcat> look at how chain works
[01:56:33] <dbaupp> (str is countable in the mathematical sense ;P )
[01:56:43] <dbaupp> but yeah, I take your point.
[01:57:20] <MaikKlein1> bjz, did you see the new spec for opengl 4.4 :)?
[01:57:32] <bjz> MaikKlein1: aye
[01:57:46] <strcat> dbaupp: well, it needs to correspond to an index where you know every enumerable value is contained until your index == the length
[01:57:52] <bjz> MaikKlein1: good to see they're trying to standardise things from 3.3+
[01:58:15] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[01:58:17] <bjz> MaikKlein1: not sure how applicable the other stuff is though
[01:58:17] <dbaupp> strcat: yeah, I agree, although we can restrict the RandomAccessIterator impl for chain to be things that make sense to chain.
[01:58:45] <strcat> dbaupp: well, I thought about it for quite a while and... it's tricky ;p
[01:58:46] <MaikKlein1> bjz, the PRT and bindless textures seems really cool
[01:58:53] <scroy> is there a way to inspect the types of expressions?
[01:58:53] <MaikKlein1> bjz, it is explained here http://www.anandtech.com/show/7161/khronos-siggraph-2013-opengl-44-opencl-20-opencl-12-spir-announced
[01:59:02] <bjz> MaikKlein1: what do they give you?
[01:59:09] <shachaf> scroy: OK, tell me when you figure out how to do it with a function. :-)
[01:59:11] <dbaupp> strcat: yes.
[01:59:28] <dbaupp> scroy: yeah, `let foo: () = the_expression;`
[01:59:36] <strcat> rusti: let xs = [1, 2, 3]; for xs.iter().cycle().advance |x| { }
[01:59:37] -rusti- <anon>:7:33: 7:51 error: type `std::vec::VecIterator<,<VI2>>` does not implement any method in scope named `cycle`
[01:59:37] -rusti- <anon>:7          let xs = [1, 2, 3]; for xs.iter().cycle().advance |x| { }
[01:59:37] -rusti-                                           ^~~~~~~~~~~~~~~~~~
[01:59:37] -rusti- error: aborting due to previous error
[01:59:37] -rusti- application terminated with error code 101
[01:59:45] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3]; for xs.iter().cycle().advance |x| { }
[01:59:51] -rusti- <anon>:7:82: 7:83 warning: unused variable: `x` [-W unused-variable (default)]
[01:59:51] -rusti- <anon>:7          use std::iterator::*; let xs = [1, 2, 3]; for xs.iter().cycle().advance |x| { }
[01:59:51] -rusti-                                                                                            ^
[01:59:51] -rusti- timeout triggered!
[01:59:54] <dbaupp> scroy: (it'll throw a compile error with the type if it's not ().)
[01:59:56] <MaikKlein1> bjz, afaik PRT mean that you can load only a partial texture, so you can have way bigger textures than you have memory
[02:00:11] <bjz> ahh nice
[02:00:12] <dbaupp> engla: yay! cycle landed!
[02:00:30] <dbaupp> scroy: (it's a ugly hack. ;p )
[02:00:31] <scroy> dbaupp: right not bad
[02:00:32] <engla> yes
[02:00:37] <scroy> all things considered.
[02:00:45] <MaikKlein1> bjz, and bindless textures is that the gpu has a pointer to the texture so you don't have to do any work on the CPU
[02:00:57] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3]; let ys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]; for xs.iter().cycle().zip(ys.iter()).advance |(x, y)| { printfln("%? %?", x, y) }
[02:00:58] <bjz> MaikKlein1: I don't really use textures though, so probably wont be as useful
[02:01:00] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/RISE
[02:01:11] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3]; let ys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]; for xs.iter().cycle().zip(ys.iter()).advance |(x, y)| { printfln("%? %?", x, y) }
[02:01:14] <strcat> ugh
[02:01:14] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/VKQH
[02:01:17] <strcat> rusti: use std::iterator::*; let xs = [1, 2, 3]; let ys = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]; for xs.iter().cycle().zip(ys.iter()).advance |(x, y)| { printfln!("%? %?", x, y) }
[02:01:19] <bjz> MaikKlein1: my stuff is all geometry
[02:01:20] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VjTP
[02:01:31] <bjz> MaikKlein1: and shaders
[02:02:02] <scroy> shachaf: there is actually a Y-combinator implemented on rosettacode: http://rosettacode.org/wiki/Y_combinator#Rust
[02:02:22] <scroy> but i wanted to try to make one in the same form as OCaml
[02:02:25] <strcat> dbaupp: with RandomAccess we could have generic sorts, for example
[02:02:30] <scroy> because it should be doable right?
[02:02:40] <strcat> dbaupp: there can be a trait inheriting from it adding 'swap
[02:02:43] <strcat> 'swap'
[02:02:53] <MaikKlein1> bjz, https://github.com/mozilla/rust/pull/6661 really takes some time :p
[02:02:54] <scroy> so could i... declare an inner fn instead of a lambda? lets see
[02:03:02] <dbaupp> strcat: yeah, it'll be pretty cool.
[02:03:10] <strcat> dbaupp: and then you could chain + sort two vectors (or a vector and deque)
[02:03:17] <strcat> and similar stuff
[02:03:28] <dbaupp> strcat: yeah, we've discussed this before :P
[02:03:32] * dbaupp is looking forward to it
[02:03:39] <strcat> yep
[02:03:46] <strcat> but bounded ints make it somewhat weird
[02:04:21] <bjz> MaikKlein1: :(
[02:04:21] <strcat> dbaupp: https://github.com/mozilla/rust/pull/7982 anyway, r?
[02:04:50] <dbaupp> strcat: why `idx`, btw?
[02:05:00] <strcat> dbaupp: index is taken by the index trait
[02:05:11] <dbaupp> ah.
[02:05:21] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[02:05:27] <shachaf> scroy: That's not really Y, is it?
[02:05:29] <strcat> and RandomAccessIterator could be implemented directly on vectors, etc.
[02:05:37] <strcat> so I didn't want a potentially conflicting name yet
[02:05:47] <dbaupp> yeah
[02:05:54] <scroy> shachaf: if it's declared inside the fix function, should still count
[02:06:36] <shachaf> scroy: That looks like it uses mutation?
[02:06:49] <shachaf> I don't think that's usually called Y.
[02:06:59] <shachaf> Maybe I'm wrong.
[02:07:00] <scroy> shachaf: oh, the rosettacode one? yeah!
[02:07:06] <scroy> that's what i was wondering
[02:07:16] <scroy> i'm not 100% sure
[02:08:36] <scroy> i mean, i'm not completely sure why it's done like that, but i think i assumed it's because the compiler needs closure1 to have some value before it's used in closure2
[02:08:55] <scroy> i didn't actually check though. should do that...
[02:09:19] <scroy> shachaf: at first i thought you meant declaring an inner function, im trying that now
[02:09:33] <strcat> the tutorial really sucks
[02:09:42] <strcat> it's ridiculously bad in parts :|
[02:10:00] <shachaf> strcat: What, tutorial.html?
[02:10:03] <strcat> yes
[02:10:14] <strcat> full of incorrect/dubious information
[02:10:22] <shachaf> I should stop looking things up in it, then.
[02:10:36] <shachaf> Is the manual (rust.html) OK?
[02:10:40] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[02:10:40] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/SRyt_Q
[02:10:40] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[02:10:41] <dbaupp> not really
[02:10:44] <strcat> shachaf: no that's worse
[02:12:02] <shachaf> help
[02:12:08] <shachaf> Is there a better thing to use for a general language reference?
[02:12:13] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[02:12:24] <strcat> #rust? ;p
[02:12:49] <strcat> the general tutorial/reference are just really out-of-date and bad
[02:13:14] <MaikKlein1> dbaupp, the "xxx_vec2" functions should also be methods right?
[02:13:41] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[02:13:41] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/XklyzQ
[02:13:41] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[02:13:42] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[02:13:42] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/1_bXsQ
[02:13:43] <ghrust> 13rust/06auto 145f208b8 15Steven Fackler: Switched bitv to external iterators
[02:13:43] <ghrust> 13rust/06auto 14b32a02c 15Steven Fackler: Derive Clone for bitv stuff
[02:13:43] <ghrust> 13rust/06auto 14d6923dd 15Steven Fackler: Removed unecessary indirection in Bitv...
[02:13:45] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[02:13:48] <scroy> not encouraging, strcat. so the best references are what ... IRC and reddit?
[02:13:56] <shachaf> strcat: I don't want to bug people with the same questions over and over again!
[02:13:57] <scroy> like, literally.
[02:14:09] <strcat> the tutorial needs to be rewritten
[02:14:15] <strcat> and I really mean rewritten, not updated
[02:14:53] <shachaf> scroy: Hey, I made it work.
[02:15:00] <shachaf> Hmm, only sort of.
[02:15:07] <shachaf> I made it work by hard-wiring f.
[02:15:08] <strcat> it's from a different era of rust and the minor updates that were done to it weren't kind the overall coherence
[02:15:09] <scroy> shachaf: show!
[02:15:16] <shachaf> Let me un-hard-wire f first!
[02:16:13] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[02:16:33] <shachaf> It's printing 120, though.
[02:16:35] <shachaf> It's something.
[02:16:48] <scroy> wow, that's good
[02:17:14] <scroy> i'm not having success declaring an inner fn
[02:17:43] <scroy> tbh, i'm not sure what the type signature is
[02:17:48] <shachaf> You might've figured out by now that I know approximately nothing about Rust. :-)
[02:17:56] <shachaf> Well, maybe a bit more than nothing. But not much.
[02:18:39] <scroy> it's ok shachaf, i'm easily impressed
[02:19:10] <shachaf> I just pretend everything is Haskell. I already managed to forget that Rust was strict while doing this.
[02:19:47] <pcwalton>  38 files changed, 2546 insertions(+), 1359 deletions(-)
[02:19:48] <pcwalton> whee
[02:20:29] <dbaupp> pcwalton: what change this time?
[02:20:40] <pcwalton> start of converting the visitor to be a trait
[02:20:42] <zxcdw> strcat: Any timeframe when the tutorial would be rewritten? As in, for 0.8 or for 1.0 perhaps? :P
[02:20:43] <pcwalton> it's on "visit-trait" in pcawlton
[02:20:51] <pcwalton> pcwalton
[02:20:58] <strcat> zxcdw: there aren't really time frames for things like that
[02:21:14] <dbaupp> haha, I'll have a look.
[02:21:18] *** Joins: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com)
[02:21:24] <strcat> and I don't feel like doing it on my own time because it's really boring
[02:22:11] <olsonjeffery> pcwalton: my newsched timer change landed.. are you ok w/ me closing #6435?
[02:22:29] <pcwalton> sure
[02:22:37] <olsonjeffery> i can wait to ask brson.. i get the impression that there isn't much else to add to the trait
[02:22:40] <pcwalton> though it's brson's bug
[02:23:45] *** Quits: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:24:31] *** Quits: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:24:52] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[02:25:02] <olsonjeffery> heh, nm. looks like bors already did it. huzzah.
[02:26:25] *** Joins: brendan (brendaneic@moz-C8E58A34.public.wayport.net)
[02:26:43] <shachaf> rustc's errors are frustrating.
[02:26:55] <scroy> shachaf: well said
[02:26:57] <shachaf> Or maybe it's just when you're doing weird type things.
[02:27:13] <MaikKlein1> what the heck does this mean :(  "error: method `to_either` has an incompatible type: expected type parameter but found type parameter"
[02:29:08] <shachaf> scroy: OK, got it
[02:29:18] <dbaupp> MaikKlein1: it means you should have a type parameter, but actually have a type parameter :P
[02:29:20] <dbaupp> MaikKlein1: code?
[02:29:55] <MaikKlein1> dbaupp, https://gist.github.com/MaikKlein/6059413
[02:29:57] <scroy> shachaf: really!
[02:30:06] <scroy> code?
[02:30:25] <dbaupp> MaikKlein1: you've swapped the type parameters
[02:30:29] <shachaf> One moment.
[02:30:33] *** Quits: brendan (brendaneic@moz-C8E58A34.public.wayport.net) (Ping timeout)
[02:30:38] <dbaupp> MaikKlein1: ToEither<U,T> ... - > Either<T,U>
[02:30:42] <dbaupp> *->
[02:30:45] <bjz> how stable is RcMut going to be?
[02:30:52] <MaikKlein1> dbaupp, oh, ups
[02:30:56] <dbaupp> bjz: in what sense? runtime-stability?
[02:30:58] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[02:31:13] <dbaupp> MaikKlein1: (it's worth filing a bug about that bad error message though.)
[02:31:20] <bjz> dbaupp: I'd like to try using it for that tls stuff I was working on
[02:31:34] <strcat> bjz: perfectly stable but it has the same dynamic freezing as @mut, if you care about that
[02:31:52] *** Joins: RMF (RMF@moz-348663EF.dsl.telepac.pt)
[02:32:53] <dbaupp> MaikKlein1: wait, don't worry https://github.com/mozilla/rust/issues/3404
[02:32:54] *** Quits: RMF (RMF@moz-348663EF.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[02:33:22] <MaikKlein1> dbaupp, okay
[02:34:03] <shachaf> scroy: http://shachaf.net/curry.txt
[02:34:35] <shachaf> Er, wrong link.
[02:34:40] <scroy> that's mean
[02:34:55] <shachaf> http://shachaf.net/curry.rs.txt
[02:35:14] <gavinb> shachaf: Is that about cooking or functional programming? I'm hungry and eager to hack.
[02:35:49] <shachaf> gavinb: It's Curry's paradox. Does that count?
[02:37:18] <scroy> shachaf: ah, this is cool
[02:37:46] <scroy> it's more like the C++ approach on rosettacode
[02:38:09] <shachaf> That type is so ugly I can hardly stand to look at it. :-(
[02:38:10] *** Quits: brianm_ (brianm@moz-D74EBD8D.hsd1.co.comcast.net) (Quit: Linkinus - http://linkinus.com)
[02:38:23] <shachaf> scroy: Is it? This is the same idea as the OCaml thing you linked to.
[02:38:24] <gavinb> shachaf: whoa! :)
[02:38:25] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[02:38:30] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[02:39:40] <shachaf> scroy: Rec is "mu" (bad name for it, since there are half a dozen different types that are called mu, and this one has no real claim to the name).
[02:39:41] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[02:39:45] <shachaf> (k.unRec) is (unroll(k)).
[02:39:52] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[02:40:31] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[02:40:40] *** Joins: Guest__ (textual@moz-E64A54F3.nyc.res.rr.com)
[02:40:44] <scroy> shachaf: right. let me do some refactoring to compare
[02:41:09] <sp3d> scroy: can any (all?) of those types be inferred?
[02:41:33] *** Quits: Guest__ (textual@moz-E64A54F3.nyc.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[02:41:57] <sp3d> well... I guess mostly I was wondering about r's type, and apparently no
[02:41:58] <scroy> sp3d: not the way i'm doing it but its the wrong approach
[02:42:53] <shachaf> I swapped the names of r and k, by the way.
[02:43:02] <shachaf> In retrospect, that might cause some confusion...
[02:43:27] <dbaupp> you can use `type F<T> = @fn(T) -> T;`, to make `fix<T>(f: F<F<T>>) -> F<T>`, which is nicer.
[02:43:53] <scroy> shachaf: and there's only one type parameter
[02:44:02] <shachaf> scroy: ?
[02:44:04] <scroy> wait, can this be done with 2?
[02:44:39] <scroy> can a Y combinator act on a (a -> b) or just (a -> a)?
[02:44:49] <scroy> should be (a -> b) right?
[02:45:16] <shachaf> Er, right.
[02:45:28] <shachaf> That restriction came from somewhere else. :-)
[02:45:40] <scroy> aha...
[02:46:34] <shachaf> OK, I uploaded a polymorphic version.
[02:46:52] <shachaf> In a non-strict language this just has the type fix :: (a -> a) -> a
[02:47:10] <shachaf> But you need to eta-expand it to fix :: ((a -> b) -> (a -> b)) -> (a -> b) here.
[02:48:01] <shachaf> (Eta-expand means convert "f" to "|x| f(x)".)
[02:49:06] <scroy> right. cool
[02:50:46] *** Quits: scroy (roy@moz-F152D5C3.washdc.fios.verizon.net) (Ping timeout)
[02:51:15] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[02:57:15] *** Quits: zz_kimundi (kimundi@moz-251673E5.dip0.t-ipconnect.de) (Ping timeout)
[02:58:05] *** Joins: brson (brson@DA348D07.AD1E507F.3688B332.IP)
[02:58:05] *** ChanServ sets mode: +o brson
[02:59:50] *** Joins: scroy (roy@moz-F152D5C3.washdc.fios.verizon.net)
[03:00:34] *** Joins: zz_kimundi (kimundi@moz-5EAC7DE2.dip0.t-ipconnect.de)
[03:01:00] *** zz_kimundi is now known as kimundi
[03:03:06] <scroy> is there a shortcut syntax for pattern matching, i.e. haskell let f (Just x) = ...
[03:03:13] <scroy> probably not right?
[03:03:27] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[03:03:36] <strcat> function parameters and 'let' statements are patterns
[03:03:48] <strcat> but they're limited to irrefutable patterns (always matching)
[03:04:14] <dbaupp> rusti: struct Foo(uint, uint); let Foo(a,b) = Foo(1,2); a + b
[03:04:15] -rusti- 3
[03:04:21] *** Quits: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu) (Quit: Leaving)
[03:04:58] <scroy> oh wow!
[03:05:01] <scroy> it does work!
[03:06:13] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Quit: eholk)
[03:08:49] <scroy> shachaf, thank you. it seems that i was doing everything wrong from the beginning
[03:09:03] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[03:09:29] <shachaf> scroy: So was I! :-)
[03:09:47] *** Parts: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) ()
[03:09:59] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[03:10:22] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[03:10:25] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:11:21] <scroy> good, then i'm on the right track
[03:14:41] *** Joins: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de)
[03:19:44] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[03:21:15] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[03:21:55] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Client exited)
[03:26:36] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[03:30:05] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[03:30:18] <bjz_> rusti: 512 as u8
[03:30:19] -rusti- 0
[03:31:48] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[03:32:38] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[03:32:41] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90.1 [Firefox 23.0/20130703181823])
[03:33:25] <scroy> is there an iota-like function? range(m, n) takes an iterator. i just want an array
[03:34:03] <dbaupp> rusti: std::vec::from_fn(5, |i| i + 10) // scroy
[03:34:03] -rusti- ~[10, 11, 12, 13, 14]
[03:34:24] <scroy> great!
[03:35:12] <dbaupp> although there is also the Counter external iterator (which is much closer to `[m..]` than vec::from_fn, since it's lazy)
[03:35:26] <dbaupp> (assuming you're coming from Haskell.)
[03:35:32] <scroy> ah. yes
[03:35:38] <scroy> laziness is always appreciated
[03:36:15] <strcat> dbaupp: there's no Range yet though
[03:36:34] <dbaupp> rusti: for std::iterator::Counter::new(5,1).take_(3).advance |i| { println(i.to_str()); }
[03:36:35] -rusti- 5
[03:36:35] -rusti- 6
[03:36:35] -rusti- 7
[03:36:35] -rusti- ()
[03:36:40] *** Parts: cataska (cataska@33ED961D.66EB4E1A.98A751AA.IP) (rcirc on GNU Emacs 23.4.1)
[03:36:52] <dbaupp> scroy: that allows you to .zip etc with other external iterators.
[03:37:31] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Ping timeout)
[03:37:41] <dbaupp> http://static.rust-lang.org/doc/core/iterator.html#trait-iteratorutil and http://static.rust-lang.org/doc/tutorial-container.html#iterators (if you haven't seen them before)
[03:37:50] <dbaupp> strcat: yes.
[03:39:01] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[03:40:10] <scroy> dbaupp: speaking of external iterators, that's the preferred paradigm now right?
[03:40:47] <scroy> dbaupp: why does int::range etc. use internal ones?
[03:40:52] <dbaupp> scroy: yes (it's essentially just the `for` syntax that's still stuck in the stone age at the moemnt ;P )
[03:40:59] <dbaupp> scroy: (oh, and those ones)
[03:41:20] <dbaupp> because they're hard to do generically; we want a generic Range(start, stop, step) type thing
[03:41:55] <dbaupp> and it's very tricky to get it to work generical in the presence of overflow
[03:41:59] <scroy> cool. i've found D's ranges to be a lot of fun
[03:42:02] *** Quits: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP) (Ping timeout)
[03:42:29] <scroy> sounds similar, but i'm not sure
[03:42:51] <dbaupp> yeah, it's fairly similar.
[03:44:33] <scroy> though sometimes i worry that i haven't suffered enough with C++ to appreciate these things
[03:46:01] <strcat> dbaupp: the internal ones are wrong though
[03:46:07] <strcat> it's not harder to do with external ones
[03:46:12] <dbaupp> strcat: which, ::range?
[03:46:14] <strcat> I just didn't want to contribute to having more bad things
[03:46:21] <strcat> dbaupp: yes, it's as bad as a simple external one would be
[03:46:34] <dbaupp> strcat: I thought the overflow bugs were fixed?
[03:46:40] <strcat> not really
[03:46:47] <dbaupp> example?
[03:46:51] <strcat> sec
[03:47:18] <jmsaunde> hm speaking of iterators - what does take_ conflict with (why is it take_)
[03:47:29] <jmsaunde> I noticed a few things there that were underscored - is the intent for that to be permanent?
[03:47:48] <strcat> jmsaunde: no it's not going to be permanent
[03:47:49] <dbaupp> jmsaunde: Cell.take
[03:47:53] <strcat> there's a method resolve bug
[03:48:00] <dbaupp> #5898
[03:48:35] <jmsaunde> oh does the compiler get confused by two method names with the same name in different types?
[03:48:46] <jmsaunde> (I can just read the bug desc - thanks)
[03:48:47] <strcat> in some cases
[03:49:10] <dbaupp> jmsaunde: when there is a `impl<T> SomeTrait for T`
[03:49:25] <jmsaunde> oh, ok
[03:51:16] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:55:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[03:55:39] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/1_bXsQ
[03:55:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[03:58:37] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[03:58:37] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/TAo-Yg
[03:58:37] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[03:58:38] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[03:58:39] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/LyyAgQ
[03:58:39] <ghrust> 13rust/06auto 149a99f5b 15Steven Stewart-Gallus: Cleanup libsyntax a bit
[03:58:39] <ghrust> 13rust/06auto 1443b1eab 15bors: auto merge of #7873 : sstewartgallus/rust/cleanup_syntax, r=alexcrichton
[03:58:39] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:03:17] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[04:07:20] *** Quits: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net) (Ping timeout)
[04:08:19] *** Joins: RMF (RMF@moz-348663EF.dsl.telepac.pt)
[04:09:29] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: He will be back!)
[04:09:34] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[04:09:57] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[04:17:48] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[04:21:34] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:21:52] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Quit: eholk)
[04:24:42] <bjz_> woo, perlin noise is working
[04:25:56] *** Joins: graydon (graydon@moz-1C52C8D0.cable.teksavvy.com)
[04:25:56] *** ChanServ sets mode: +qo graydon graydon
[04:25:58] <Jeaye> :)
[04:26:03] <Jeaye> bjz_: What's you using it for?
[04:26:09] *** Quits: graydon (graydon@moz-1C52C8D0.cable.teksavvy.com) (Quit: Leaving.)
[04:28:27] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[04:29:53] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[04:30:18] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[04:32:27] <Yurumechan> rusti: macro_rules! foo(($x:expr => $(($y:expr))|+) => ( $(println(fmt!("%? %?", $x, $y));)+ )) foo!(1 => (2+3)|(4+5));
[04:32:28] -rusti- 1 5
[04:32:28] -rusti- ()
[04:32:47] <bjz_> Jeaye: atm just a grid of symbols in the command line :P
[04:32:53] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[04:33:06] <Jeaye> That's still cool. :D
[04:33:13] <bjz_> Jeaye: but soon, landscapes
[04:33:21] <Jeaye> Ohh, for the game?
[04:33:28] <bjz_> will have to add simplex in the future
[04:33:30] <bjz_> yah
[04:33:41] <Jeaye> That's very exciting. I wish you well.
[04:34:08] <dbaupp> rusti: macro_rules! foo(($x:expr => $(($y:expr))|+) => ({ $(println(fmt!("%? %?", $x, $y));)+ })) foo!(1 => (2+3)|(4+5));
[04:34:11] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/OVSS
[04:34:46] *** Joins: nano (nano@moz-972880B.superkabel.de)
[04:34:59] <dbaupp> Yurumechan: the problem there is macros only expand to one thing, so the second one gets dropped
[04:35:11] <dbaupp> ... but fixing that breaks things too
[04:35:19] <dbaupp> rusti: macro_rules! foo(($x:expr => $(($y:expr))|+) => ({ $(println(fmt!(@"%? %?", $x, $y));)+ })) foo!(1 => (2+3)|(4+5));
[04:35:20] -rusti- <anon>:7:75: 7:83 error: first argument to fmt! must be a string literal.
[04:35:20] -rusti- <anon>:7          macro_rules! foo(($x:expr => $(($y:expr))|+) => ({ $(println(fmt!(@"%? %?", $x, $y));)+ })) foo!(1 => (2+3)|(4+5));
[04:35:20] -rusti-                                                                                     ^~~~~~~~
[04:35:20] -rusti- application terminated with error code 101
[04:35:34] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[04:37:39] <bjz_> Jeaye: like this: 31.media.tumblr.com/tumblr_m165bl19YG1qgurm4o1_1280.png
[04:38:22] <Jeaye> mmhmm
[04:38:24] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[04:38:26] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[04:38:31] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[04:38:54] *** Joins: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net)
[04:40:26] <Jeaye> bjz_: I've done a bit of terrain. Mostly things that look like http://www.riemers.net/images/finals/series4.jpg
[04:41:14] <Jeaye> Though my water never looks even as good as that.
[04:41:15] <Ralith> that would look pretty good if you fixed the textures
[04:41:22] <Ralith> and lighting
[04:41:35] <bjz_> ah nice
[04:41:36] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[04:41:41] <Ralith> bjz_: also, I hope by 'perlin noise' you mean 'simplex noise'
[04:41:44] <bjz_> I like the warer
[04:41:52] <jmgrosen> sent rust-opengles a PR to update for latest rust
[04:41:58] <bjz_> Ralith: I'm doing both
[04:42:11] <Jeaye> jmgrosen: They only update once in a while, when all of servo updates.
[04:42:11] <bjz_> Ralith: "improved" and simplex
[04:42:24] <Ralith> bjz_: why bother with not-simplex?
[04:42:26] <jmgrosen> Jeaye: aw, really? :/ well, sorry then
[04:42:43] <Jeaye> jmgrosen: Your PR is still appreciated and may just be used when it's time to update.
[04:42:44] <bjz_> Ralith: it was easier :)
[04:42:48] <Ralith> heh
[04:42:50] <Ralith> there is that
[04:43:06] <jmgrosen> Jeaye: alright, I'll just have to update it in my submodule then
[04:43:07] <bjz_> my poor brain needs to wrap my head around it
[04:43:37] <Jeaye> jmgrosen: Yeah, I've branched kind of far from rust-opengles and rust-stb-image since I never wait for them to update. >.<
[04:43:56] <Jeaye> bjz_: Will it be on Github?
[04:44:04] <bjz_> Jeaye: aye
[04:44:10] <Jeaye> Nice. :)
[04:45:56] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[04:52:09] <ChrisMorgan> This makes no sense to me:
[04:52:09] <ChrisMorgan> rusti: let n = ~[1, 2]; let mut i = n.iter(); i.next()
[04:52:13] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QHFS
[04:52:37] <ChrisMorgan> Why would n need to live outside that block?
[04:52:51] <strcat> because the vec iterator yields references
[04:52:56] <strcat> and next() returns a reference
[04:53:11] <ChrisMorgan> Ah! Yes, I had forgotten that.
[04:54:10] <ChrisMorgan> How do I get the number out of it, in such a case?
[04:54:13] <ChrisMorgan> rusti: let n = [1i, 2i]; let mut i = n.iter(); *(i.next())
[04:54:13] -rusti- <anon>:7:49: 8:5 error: can only dereference enums with a single variant which has a single argument
[04:54:13] -rusti- <anon>:7          let n = [1i, 2i]; let mut i = n.iter(); *(i.next())
[04:54:13] -rusti- <anon>:8     };
[04:54:13] -rusti- error: aborting due to previous error
[04:54:14] -rusti- application terminated with error code 101
[04:56:52] *** Quits: dew (Instantbir@moz-2C6F2E2.dhcp.stls.mo.charter.com) (Ping timeout)
[04:57:49] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[04:58:54] <dbaupp> rusti: let n = [1i, 2i]; let mut i = n.iter(); *(i.next().unwrap())
[04:58:55] -rusti- 1
[04:59:01] *** Joins: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net)
[04:59:09] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[04:59:13] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: He will be back!)
[04:59:17] *** Joins: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net)
[05:00:11] <scroy> how come rusti here does stuff that my cli rusti can't?
[05:00:31] <jmgrosen> scroy: how so?
[05:01:02] <scroy> http://ix.io/6OB
[05:01:17] <dbaupp> scroy: irc-rusti just dumps the input into `fn main() { let v = { input }; println(fmt!("%?", v)); }` and compiles it with normal rustc
[05:01:48] <scroy> so what does my rusti do?
[05:01:53] <dbaupp> black magic
[05:02:23] <dbaupp> it has to be able to preserve state between lines, which means it has to serialise values (the cause of that error)
[05:02:34] <dbaupp> and various other limitations :(
[05:02:37] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[05:03:18] <scroy> ah right. the state is king
[05:03:30] <Yurumechan> dbaupp : yeah, I just wanted to see if it causes a compile error or not as someone told me it didn't do the right thing.
[05:03:33] <scroy> the state must be preserved at all costs
[05:03:41] <kmc> my rusti crashes no matter what I type :(
[05:03:51] <dbaupp> kmc: oh, platform/version etc?
[05:04:04] <ChrisMorgan> Given a struct literal like S { foo: iter.next(), bar: iter.next() }, it seems that the iterator values are taken in source order (i.e. into foo then into bar). I hope this is guaranteed to be true?
[05:04:04] <Yurumechan> turns out to that his problem is indeed an inability to expand to multiple items.
[05:04:20] <kmc> rust 0.6, Debian GNU/Linux amd64
[05:04:25] <dbaupp> Yurumechan: yeah, it's annoying
[05:04:42] <kmc> the crash is "RuntimeDyldELF.cpp:221: void llvm::RuntimeDyldELF::resolveX86_64Relocation(uint8_t*, uint64_t, uint64_t, uint32_t, int64_t): Assertion `RealOffset <= (2147483647) && RealOffset >= (-2147483647-1)' failed."
[05:04:44] <dbaupp> kmc: ah! yeah, it was broken in 0.6, but it's fixed in 0.7.
[05:04:48] <kmc> ok good :)
[05:04:49] <ChrisMorgan> Why exactly does Option have both .get and .unwrap, which are identical in their code?
[05:05:17] <dbaupp> kmc: (which has a lot of improvements... you should update :) )
[05:05:25] <kmc> I will
[05:05:26] <dbaupp> ChrisMorgan: unwrap hasn't been removed yet.
[05:05:39] * ChrisMorgan wonders why that situation ever developed
[05:05:44] <kmc> I'm using 0.7ish for real work on Servo, I just have this 0.6 install also lying around
[05:06:33] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[05:06:43] <dbaupp> ChrisMorgan: .get() used to be <T:Copy> fn get(&self) -> T { copy out of Some }, but that was changed to get(self) -> T { move out of Some ]
[05:06:45] <dbaupp> *}
[05:06:54] <dbaupp> (in stages, I think.)
[05:07:13] <ChrisMorgan> Ah. That makes sense.
[05:07:54] *** Quits: geomyidae (cole@DD6F7E3A.21468E9A.30200F38.IP) (Ping timeout)
[05:10:11] <scroy> i've noticed executables are a lot smaller when you compile with -O
[05:12:11] <scroy> if i run nm on a .o made without -O, it shows a lot of "unstable" and "intrinsics" stuff that's not there with -O
[05:13:11] <strcat> scroy: without -O there's no optimization going on
[05:13:24] <scroy> strcat: I know... just wondering how it's related 
[05:13:40] <scroy> i mean, why all the extra symbols?
[05:13:42] <strcat> because optimization eliminates a lot of the code size
[05:13:50] <strcat> it inlines functions, it removes dead code
[05:15:16] <scroy> guess that makes sense
[05:15:27] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[05:24:19] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[05:25:09] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[05:33:11] *** Quits: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net) (Ping timeout)
[05:34:13] *** Joins: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net)
[05:38:21] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[05:39:00] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[05:40:42] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:40:42] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/LyyAgQ
[05:40:42] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:41:15] *** Joins: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP)
[05:41:31] *** Quits: joebobjoe (joebobjoe@55F2E07A.7F841963.2213276E.IP) (Quit: Textual IRC Client: www.textualapp.com)
[05:43:39] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[05:43:39] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Tldv6g
[05:43:39] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[05:43:40] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[05:43:40] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/tIoi2A
[05:43:40] <ghrust> 13rust/06auto 14a8870df 15Steven Stewart-Gallus: Minor cleanup of hashmap
[05:43:40] <ghrust> 13rust/06auto 144be2962 15bors: auto merge of #7875 : sstewartgallus/rust/fubar, r=alexcrichton
[05:43:40] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[05:44:03] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[05:47:13] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[05:49:16] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:49:37] <bjz_> rusti: unsafe { std::cast::transmute::<[int,..1],int>([1]) }
[05:49:37] -rusti- error: internal compiler error: unexpected failure
[05:49:37] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[05:49:38] -rusti- note: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues
[05:49:38] -rusti- application terminated with error code 101
[05:49:40] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[05:49:55] <bjz_> :P
[05:50:13] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[05:50:51] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[05:51:08] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[05:56:25] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[05:57:39] <bjz_> yay for tiny ice: https://github.com/mozilla/rust/issues/7988
[06:02:11] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[06:02:50] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:04:56] *** Joins: jaen (jaen@moz-25F38FEF.neoplus.adsl.tpnet.pl)
[06:05:00] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[06:08:23] <Jeaye> I'm hitting an ICE too
[06:08:30] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[06:08:31] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[06:10:38] <Jeaye> What's the RUST_LOG setting for ICE tracebacks?
[06:10:49] <dbaupp> ::rt::backtrace
[06:10:55] <Jeaye> thanks
[06:13:34] *** Joins: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net)
[06:13:43] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[06:13:43] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144be2962 to 1443b1eab: 02http://git.io/N3iJvQ
[06:13:43] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[06:13:45] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[06:13:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/bGbnkA
[06:13:45] <ghrust> 13rust/06auto 14a8870df 15Steven Stewart-Gallus: Minor cleanup of hashmap
[06:13:45] <ghrust> 13rust/06auto 140a5d1a1 15bors: auto merge of #7875 : sstewartgallus/rust/fubar, r=alexcrichton
[06:13:46] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[06:13:48] <aatch> Today I learned that my bosses had a proper server server machine lying around unused.
[06:14:21] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[06:15:09] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:15:46] <Jeaye> Seen this ICE yet? http://dpaste.com/1314266/
[06:17:35] <Jeaye> https://github.com/mozilla/rust/issues/931 
[06:17:40] <Jeaye> Closed 2 years ago
[06:19:40] *** Quits: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net) (Quit: eatkinson)
[06:19:40] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[06:20:07] *** Joins: yegor (primate@moz-7DA865BF.yandex.net)
[06:23:02] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[06:23:16] *** Joins: Khmar (user@A420B6CD.B01207CF.FA4E5DC4.IP)
[06:26:11] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[06:26:57] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[06:39:48] *** Joins: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP)
[06:39:48] *** ChanServ sets mode: +o dherman
[06:41:45] *** Quits: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net) (Connection reset by peer)
[06:42:37] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Connection reset by peer)
[06:43:54] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:44:12] *** Joins: int3_ (int3_@575E957D.D3786173.DD630FEE.IP)
[06:44:25] *** Joins: lkuper (lkuper@EEF90B16.A402E718.C082B7DC.IP)
[06:47:52] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[06:48:28] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[06:50:14] *** Quits: int3_ (int3_@575E957D.D3786173.DD630FEE.IP) (Client exited)
[06:52:07] <kemurphy> how do i go about adding a test to the test suite, and then running said test?
[06:55:32] <acrichto_> kemurphy: add it to src/test and then "make check-stage1 TESTNAME=<some substring of test>"
[06:58:51] <kemurphy> acrichto_: cool, thanks
[07:01:41] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[07:02:53] *** Quits: lkuper (lkuper@EEF90B16.A402E718.C082B7DC.IP) (Ping timeout)
[07:03:30] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[07:04:44] *** Joins: aruniiird (Mibbit@92D70115.B332A52C.E3D0A897.IP)
[07:08:01] *** Joins: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net)
[07:10:40] <dbaupp> aatch: are you trying to hint something?
[07:11:14] <aatch> dbaupp, not really. I'm just kinda bored waiting for stuff to build.
[07:11:28] <dbaupp> aatch: haha
[07:11:30] <aatch> dbaupp, I mention it because it was being used as a file server.
[07:11:40] <aatch> dbaupp, but has an Intel Xeon chip in it.
[07:11:57] <aatch> It's actually similarly specced to my work dev machine.
[07:12:05] <dbaupp> sounds like a severe case of overkill
[07:12:31] <aatch> dbaupp, yep, but it was even being used. So now it's our new CI server
[07:12:41] <aatch> wasn't*
[07:12:53] <dbaupp> oooh, bors-style?
[07:13:08] <dbaupp> or not that automated?
[07:13:12] <aatch> dbaupp, not quite. Just a buildbot setup.
[07:13:23] *** Quits: scroy (roy@moz-F152D5C3.washdc.fios.verizon.net) (Ping timeout)
[07:13:51] <dbaupp> nice
[07:13:56] <aatch> For one, I needed a debian machine to test HipHop anyway, since I'm pretty sure some of my changes would break it on debian.
[07:14:07] <aatch> And facebook test it on Ubuntu.
[07:14:43] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[07:15:05] <aatch> (Also, our servers are all debian)
[07:15:21] <dbaupp> right... and did it break?
[07:15:34] <aatch> dbaupp, surprisingly, no.
[07:15:49] <dbaupp> awesome!
[07:15:58] <aatch> Well, I reverted the commit that contained all of my changes to get it building on my machine.
[07:16:29] <dbaupp> ... ah
[07:16:38] *** Quits: brson (brson@DA348D07.AD1E507F.3688B332.IP) (Quit: leaving)
[07:17:30] *** Quits: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net) (Quit: kertap)
[07:18:21] <aatch> But I half expected to break anyway, because I've made other changes along the way, but other than a minor config issue (cmake not finding a header file) seems to be going fine.
[07:19:20] <aatch> We also got around to picking a server naming theme.
[07:19:28] <aatch> (Star Wars)
[07:21:05] <dbaupp> hahaha, how mainstream! :P
[07:22:01] <aatch> dbaupp, well we needed a decent sized domain that neither me nor the other dev was using or worked with.
[07:22:11] <aatch> cut down the choice quite quick.
[07:22:23] <dbaupp> right
[07:22:58] <aatch> So the CI machine is 'sarlacc', which is the big pit monster that eats Boba Fett
[07:23:08] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[07:23:54] <dbaupp> it's eating all your commits
[07:23:59] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[07:24:27] *** Joins: Ms2ger (Ms2ger@E699BE68.4A4AF98A.F15B0BB3.IP)
[07:26:02] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[07:26:35] <Khmar> Sarlac is also the main antagonist of a popular platformer game called "Blackthorne" released by Blizzard.
[07:26:50] <Khmar> s/popular/once popular/
[07:27:35] <kemurphy> aatch: find a reason to provision one named 'rancor' as well :P
[07:27:47] <pnkfelix> dbaupp: Have you looked at pcwalton's Visitor rewrite?  Did you get a feel for how far along it is?
[07:28:27] <aatch> kemurphy, so we have both monsters that Jabba the Hutt tries to feed Luke to?
[07:28:29] <dbaupp> pnkfelix: I haven't looked at it in detail (aatch^)
[07:28:37] <dbaupp> not yet anyway.
[07:29:30] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[07:30:20] <dbaupp> pnkfelix: why?
[07:30:43] <ChrisMorgan> One thing I'm *really* liking about Rust, in comparison with Python: if it compiles, I'm almost absolutely confident that it'll work, whereas in Python it really did need to be run before I could be confident I hadn't made a mistake somewhere.
[07:30:48] <kemurphy> aatch: it would just be amusing to have one for which 'rancor' is a fitting name. but also yes, the luke thing is good too.
[07:31:02] <pnkfelix> dbaupp: because I want to know whether I should just relinquish Issue 7081 to pcwalton
[07:31:30] <pnkfelix> dbaupp: (though I'm not clear on why he's using an @Trait object, so there's still some things to hash out.)
[07:31:33] <aatch> kemurphy, not sure if there is anything. The only new sever on the books is a web server for a new project.
[07:31:43] <dbaupp> pnkfelix: from what I've seen, I think I prefer aatch's design (but I haven't looked at either yours or pcwalton's much yet.)
[07:31:45] * kemurphy 's vm naming convention is pokemon-themed; the freebsd vm got "magmar"
[07:32:05] <dbaupp> ChrisMorgan: you should try Haskell ;P
[07:32:12] <ChrisMorgan> dbaupp: why?
[07:32:15] <pnkfelix> dbaupp: okay.  I mostly just asked you because I noticed pcwalton talking to you about it last night.
[07:32:19] <dbaupp> ChrisMorgan: it's like that but 6x more
[07:32:36] <ChrisMorgan> Why/how is that?
[07:32:38] *** Quits: mihneadb (mihneadb@moz-329F29A3.lightspeed.sntcca.sbcglobal.net) (Quit: Leaving)
[07:33:16] <ChrisMorgan> (I was disappointed when Rust removed typestateâ€”it was more like that, too.)
[07:33:20] <dbaupp> pnkfelix: yeah... I converted rustc::middle::lint to use aatch's visitor, so I have a small understanding of the requirements (in that area at least).
[07:33:57] <dbaupp> ChrisMorgan: because Haskell's type system allows you to encode more information in a less awkward way.
[07:34:31] *** Parts: yegor (primate@moz-7DA865BF.yandex.net) ()
[07:35:52] <kemurphy> for https://github.com/mozilla/rust/issues/1647, is there any sort of progress/consensus?
[07:37:20] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[07:37:40] *** Quits: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net) (Client exited)
[07:38:05] <kemurphy> would there be any interest in something like, say, enum Animal: u16 { Dog, Cat, Horse }
[07:38:44] <kemurphy> (and not specifying :u16 just defaults to what it currently does)
[07:39:03] <jensnockert> kemurphy: Yes.
[07:39:20] <doener> r? https://github.com/mozilla/rust/pull/7991
[07:39:44] <dbaupp> pnkfelix: ok, having looked at it now, I think I do prefer aatch's... I don't understand the use of `@mut self` *at all* (rather than just &mut self), nor the lack of default methods.
[07:40:22] <doener> thanks
[07:40:56] <dbaupp> pnkfelix: (looked at pcwalton's, that is.)
[07:41:42] <dbaupp> kemurphy: in theory, enums like that would get automatically shrunk to u8 (as the descriminant)
[07:41:46] <pnkfelix> dbaupp: I haven't looked at pcwalton's version carefully; I wouldn't be surprised if the lack of default methods was because they were not yet fixed in the snapshot at the time he developed it?  (I'm not sure if they are fixed in the most current snapshot, but I've heard that was taken pretty recently)
[07:42:38] <dbaupp> pnkfelix: possibly, but default methods have been fairly stable for a while now. (and yeah, yesterday)
[07:42:44] <kemurphy> dbaupp: not necessarily sure auto-shrinking would be a behavior that i'd want
[07:43:06] *** Joins: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net)
[07:43:14] <pnkfelix> dbaupp: not stable enough; I know I had to put some #[cfg(not(stage0))] directives in when I was workgin on this over the weekend
[07:43:15] <dbaupp> kemurphy: the memory layout of enums is purposefully unspecified to allow optimisations like that
[07:43:19] <jensnockert> dbaupp: Yeah, but in a binary format parser or something, you would want layout control.
[07:43:33] <pnkfelix> dbaupp: but yes, a snapshot from yesterday might do the trick
[07:43:42] <ChrisMorgan> There, I have decided: the newrt TCP is not safe with concurrent requests. It typically dies (SIGSEGV) within a few thousand requests, and occasionally hangs.
[07:43:47] <kemurphy> dbaupp: i'd also eventually want to be able to manually set discriminator values for tuple- and struct-like variants to interface with some C/asm stuff
[07:43:51] *** Quits: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net) (Client exited)
[07:44:02] <kemurphy> and that would require control over the width of the discriminator
[07:44:34] <dbaupp> pnkfelix: oh, ok. (aatch got things working several weeks ago with default methods: having the (equivalent of) visit::visit_item etc as additional default methods e.g. self.visit_item_contents)
[07:44:37] <pnkfelix> dbaupp: Reading over aatch's version now.  I didn't want to mix the traversal code in with the visit hooks in my own version, but now that I read his, I think I can see the appeal of it.
[07:44:37] <kemurphy> (auto-shrinking would be good for things where an exact width isn't specified though, i think)
[07:45:11] <pnkfelix> dbaupp: yes, I remember that now.  He and I discussed how his code managed to work while mine required more up-to-date default method support
[07:45:25] <dbaupp> pnkfelix: https://github.com/mozilla/rust/issues/7649 would make it clear that they aren't meant to be overrided
[07:45:32] *** Joins: geomyidae (cole@DD6F7E3A.21468E9A.30200F38.IP)
[07:45:36] <dbaupp> (mainly because the compiler wouldn't allow it.)
[07:45:52] <dbaupp> kemurphy: yes, `enum` isn't designed for that use case at all.
[07:45:55] <dbaupp> jensnockert: too ^
[07:45:56] <jensnockert> kemurphy: Yeah, I would totally want that.
[07:46:16] <dbaupp> https://github.com/mozilla/rust/issues/5492
[07:46:18] <pnkfelix> dbaupp: mmm.  issue 7649 seems like an anti-pattern to me; why make such a thing a trait method if you don't want it to be overridden?
[07:46:27] <pnkfelix> dbaupp: just so you get to use method invocation syntax?  bleah
[07:46:51] <dbaupp> pnkfelix: because impl<T: Blah> BlahUtil for T is even more of an antipattern
[07:47:14] <dbaupp> (but yeah, essentially to get method invocation syntax.)
[07:48:05] <kemurphy> dbaupp: sure, but is there any reason that use case couldn't be supported?
[07:48:46] <kemurphy> dbaupp: i feel like semantics could remain totally unchanged for when you don't specify a width on the enum
[07:49:10] <kemurphy> dbaupp: perhaps it's even reasonable to only allow setting discriminator values when a width is specified?
[07:49:28] <kemurphy> (for tuple- and struct-like variants)
[07:49:41] <dbaupp> kemurphy: no, not particular reason it couldn't be supported... but I think the consensus is for a macro that creates something like `struct Animal { field: u16 } static Cat: Animal = Animal { field: 0 }; static Dog: Animal = Animal { field: 1 }`
[07:50:01] <dbaupp> (with a `priv` on the field, so that arbitrary new values couldn't be created.)
[07:51:14] <dbaupp> doener: could you add a test for 7991?
[07:51:27] * dbaupp forgot that in his review
[07:51:32] * kemurphy would not be a fan of that, but i can understand the rationale
[07:52:39] <dbaupp> kemurphy: it could be something like `c_enum! Animal { Cat = 0, Dog = 0 }` (with a way of specifying the exact size)
[07:53:19] <dbaupp> kemurphy: I think there's even rumblings about deprecating the current enum Animal{ Cat = 0, Dog = 0 } syntax in favour of this, to make the representations more uniform.
[07:55:30] <kemurphy> dbaupp: presumably this could be extended to say, c_enum! Animal { Cat { weight: u16 } = 0x0, snake { length: u16 } }? 
[07:55:43] <kemurphy> er, snake { ... } = 0x1
[07:56:41] <dbaupp> kemurphy: maybe... I don't really know.
[07:58:10] <kemurphy> dbaupp: to me, it just seems like doing the whole macro thing would be a lot more work than just extending the enum syntax... reading through, it doesn't seem to be that difficult to implement. the necessary infrastructure is already there.
[07:58:52] <kemurphy> the only weirdness i think is alignment
[08:00:18] *** Joins: heftig (heftig@6835D69C.6FC4DE2F.FEC4A986.IP)
[08:01:23] <dbaupp> kemurphy: feel free to experiment with it :) (I don't have any opinion on whether it should or shouldn't exist: just regurgitating discussion I (vaguely) remember)
[08:01:54] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[08:02:00] <kemurphy> dbaupp: i'll hack something up and throw out a PR just to get opinions, then, i guess :)
[08:03:41] <kemurphy> is make check-stage1 TESTNAME=foo supposed to take some time?
[08:05:05] <kemurphy> seems to be thinking hard about "using metrics ratchet: tmp/check-stage1-T-x86_64-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass-full-metrics.json"
[08:05:32] <kemurphy> ah, and of course right after i say that, it finishes. never mind.
[08:07:23] <dbaupp> fwiw, the most basic macro is pretty easy to write: https://gist.github.com/huonw/ec113e97d5e65e62037b
[08:09:32] <pnkfelix> kemurphy: was it doing the microbenchmarking even when you do TESTNAME=foo?  That sounds like an oversight if so.
[08:10:18] <kemurphy> $ make check-stage1 TESTNAME=link-section
[08:10:25] <kemurphy> looks like it's doing a bunch of benchmarking with that
[08:11:24] <pnkfelix> kemurphy: the benchmarking code is pretty new; I wouldn't be surprised if there were issues like this.
[08:17:43] <pnkfelix> kemurphy: regarding the ongoing as_c_str() usage question
[08:17:59] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[08:19:47] <pnkfelix> kemurphy: the code for `as_c_str` makes copies of the given string, to null-terminate it.  So unless you know that the original string was already null-terminated, I don't see how who owns it is relevant.
[08:20:28] <pnkfelix> kemurphy: sed -e s/`as_c_str` makes copies/`as_c_str` might make copies/
[08:21:07] <kemurphy> pnkfelix: ah, fair enough. still, acrichto_ dug into llvm and found that the LLVMSetSection call makes a copy anyway
[08:21:09] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:22:15] <pnkfelix> kemurphy: oh really?  I thought I had checked about that, hmm.  Was acrichto_'s discovery discussed in this channel?  (I had reviewed the log earlier, about 3.5 hours ago, to see if anyone had clarified this)
[08:23:13] <kemurphy> pnkfelix: https://github.com/mozilla/rust/pull/7958#issuecomment-21390176
[08:23:37] <kemurphy> pnkfelix: i dug and couldn't find it either *shrug*
[08:23:45] <pnkfelix> kemurphy: ah, thanks for ptr
[08:25:08] <kemurphy> pnkfelix: np
[08:25:24] <kemurphy> hm, TESTNAME=foo seems to not look in run-fail?
[08:25:25] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[08:26:08] <kemurphy> something weird is going on, the make check-stage1 invocation immediately picks up where i killed benchmarking
[08:27:00] <kemurphy> is there like, make clean-test or something?
[08:27:17] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:27:31] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (Ping timeout)
[08:27:43] <dbaupp> kemurphy: you can touch the file you want to run
[08:28:01] <dbaupp> `make check-stage1-rfail TESTNAME=foo` btw.
[08:28:33] <kemurphy> dbaupp: beautiful, thanks
[08:28:34] <pnkfelix> dbaupp: I don't think that just touching the file always work; my experience is that when you use TESTNAME=bleah leaves behind artifacts that need to be cleaned up when you want to switch away from using TESTNAME=bleah
[08:29:21] <dbaupp> pnkfelix: yeah, it touches the tmp/*.ok file even with TESTNAME, you mean?
[08:29:29] <kemurphy> heh, so my failing test fails, but with a segfault rather than with a rust task failure
[08:29:35] <pnkfelix> dbaupp: but if you're planning on using the same TESTNAME=bleah in both cases, then I guess your suggestion is fine.  (I don't know which particular problem kemurphy is running into)
[08:29:46] *** Quits: gavinb (gavinb@moz-CA19A0CF.vic.adsl.internode.on.net) (Ping timeout)
[08:29:48] <pnkfelix> dbaupp: yes, the fact that it touches `tmp/*.ok` is what I meant
[08:30:20] <kemurphy> this causes "error: failure produced the wrong error code: 1"
[08:30:35] <kemurphy> how do i fix that?
[08:30:50] <kemurphy> (segfault is intended)
[08:31:32] <kemurphy> (or does the test suite not care about unsafe failures)
[08:31:44] <pnkfelix> â€¦ does our test infrastructure have the means to check for particular segfaults?
[08:32:16] <kemurphy> this particular test applies link_section=".rodata" to a static mut, and then writes to said static mut
[08:33:03] <kemurphy> interestingly enough, applying link_section=".data" to a fn didn't cause a W^X failure
[08:33:58] <pnkfelix> kemurphy: I think the relevant test runner source code is: src/compiletest/runtest.rs
[08:34:17] <pnkfelix> kemurphy: if you look there, you'll see that we've hard-coded the particular error code 101 as what we expect the runtime to produce
[08:34:41] <kemurphy> so there's really no way to detect segfault?
[08:34:46] <pnkfelix> kemurphy: so the question is â€¦ can we make your test produce that error code?  And/or generalize runtest.rs to catch this...
[08:35:36] <pnkfelix> kemurphy: I think some people may have asked about having access to user-specified signal handling, i.e. sigaction or what have you.  But I don't know where that stands
[08:35:36] <kemurphy> i don't think i can make the test produce anything other than 1, seeing as the kernel is killing it....
[08:36:08] <kemurphy> and the lack of signal handling means i can't do anything about it
[08:36:23] <pnkfelix> kemurphy: yeah so the other way to go would be to see if its worth generalizing runtest.rs to allow one to express cases like this
[08:36:45] <pnkfelix> kemurphy: but I am dubious about whether that would be worthwhile.
[08:37:01] <kemurphy> pnkfelix: i am inclined to think it's not worth it
[08:37:23] * kemurphy will scrap this test for now, it is super easy to recreate if runtest can handle it later on
[08:39:02] <kemurphy> okay, there's now a simple test at https://github.com/mozilla/rust/pull/7958
[08:39:25] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[08:40:44] <kemurphy> oh, i bet the test needs some OS-specific cfg attrs, actually
[08:41:20] <kemurphy> what do section names look like on windows and mac? /me doesn't have either of those platforms available at the moment
[08:43:09] <kemurphy> s/on windows and mac/in PE and mach-o/
[08:43:49] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[08:44:30] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:46:45] *** Quits: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP) (Quit: dherman)
[08:47:03] *** Quits: sigma (sigma@CB3F6051.C886FCFF.DF0EE696.IP) (Quit: Leaving.)
[08:47:33] *** Joins: Blub\w (wry@moz-813FDEF5.vps.tuwien.ac.at)
[08:47:45] *** Joins: sigma (sigma@CB3F6051.C886FCFF.DF0EE696.IP)
[08:53:22] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[08:54:12] *** Joins: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net)
[08:55:11] *** Joins: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de)
[08:55:58] *** Quits: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net) (Ping timeout)
[08:58:33] <dbaupp> r? https://github.com/mozilla/rust/pull/7992
[09:03:42] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[09:03:46] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[09:06:30] *** Quits: sigma (sigma@CB3F6051.C886FCFF.DF0EE696.IP) (Quit: Leaving.)
[09:07:03] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[09:07:20] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[09:10:49] *** Joins: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP)
[09:11:04] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[09:17:20] *** Joins: BitPuffin (quassel@moz-1789B472.bredband.tre.se)
[09:17:56] <kemurphy> is there any method in the parser to just parse a primitive type?
[09:18:16] <kemurphy> or alternatively, to ensure a parsed type is either an int or a uint
[09:18:49] <kemurphy> (or should i be looking in middle/ty.rs)
[09:18:58] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[09:27:20] *** Quits: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de) (Quit: mellum)
[09:27:59] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: ["Textual IRC Client: www.textualapp.com"])
[09:28:22] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[09:28:59] *** Joins: slaren (slaren@moz-89461CF2.red-83-38-70.dynamicip.rima-tde.net)
[09:29:41] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[09:30:05] <z0w0> dbaupp: r+
[09:30:40] <dbaupp> kemurphy: probably: parse any type and check it later.
[09:30:55] <dbaupp> z0w0: thanks
[09:31:42] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[09:31:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/bGbnkA
[09:31:43] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[09:32:31] <kemurphy> dbaupp: looks like i want the parse_ty, ast_ty_to_ty, ty_is_integral chain
[09:32:51] * dbaupp doesn't know
[09:33:01] <dbaupp> kemurphy: that looks very reasonable.
[09:33:49] <kemurphy> dbaupp: cool, sounds good
[09:34:42] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[09:34:42] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/e5SVQQ
[09:34:42] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[09:34:44] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[09:34:44] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Nz4c2w
[09:34:44] <ghrust> 13rust/06auto 14c062510 15Alex Crichton: Allow linking against crates with #[no_std]...
[09:34:44] <ghrust> 13rust/06auto 141968918 15bors: auto merge of #7924 : alexcrichton/rust/opt-lang-xcrate2, r=thestinger...
[09:34:45] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[09:36:16] *** Quits: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net) (Ping timeout)
[09:37:16] *** Joins: eternaleye (eternaleye@moz-76321711.hsd1.wa.comcast.net)
[09:38:12] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[09:40:48] *** Quits: Blub\w (wry@moz-813FDEF5.vps.tuwien.ac.at) (Quit: WeeChat 0.4.1)
[09:42:32] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Quit: WeeChat 0.4.2-dev)
[09:47:22] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[09:51:08] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[09:53:56] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Ping timeout)
[09:55:04] *** Quits: victorporof (victorporo@7EA800E4.67625325.D111398B.IP) (Connection reset by peer)
[09:55:08] *** Joins: victorporof (victorporo@7EA800E4.67625325.D111398B.IP)
[09:56:36] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[09:57:40] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[09:59:57] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Ping timeout)
[10:01:59] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[10:04:41] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[10:04:41] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 141968918 to 140a5d1a1: 02http://git.io/N3iJvQ
[10:04:41] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[10:04:43] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[10:04:43] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/mLZwFw
[10:04:43] <ghrust> 13rust/06auto 148eb6d2d 15Steven Fackler: Eliminated SmallIntSet...
[10:04:43] <ghrust> 13rust/06auto 14dfdb72d 15bors: auto merge of #7934 : sfackler/rust/smallintset, r=alexcrichton...
[10:04:43] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[10:04:47] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[10:07:43] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Quit: WeeChat 0.4.2-dev)
[10:12:01] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[10:17:30] *** Quits: Khmar (user@A420B6CD.B01207CF.FA4E5DC4.IP) (Ping timeout)
[10:17:59] <kemurphy> hm
[10:18:27] <kemurphy> rusti: enum Animal { Cat = 0u, Dog = 1u };
[10:18:28] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/dVga
[10:18:42] <kemurphy> :(
[10:19:07] <kemurphy> why is int a requirement there?
[10:19:31] <kemurphy> rusti: enum Animal { Cat = 0i, Dog = 1i };
[10:19:31] -rusti- ()
[10:20:24] <dbaupp> kemurphy: just because that's the way it is, probably
[10:20:51] <dbaupp> (i.e. it might not have been implemented like that on purpose, I don't know.)
[10:21:27] <pnkfelix> kemurphy: file an issue; that sounds like an easy one for a newcomer to chomp on
[10:21:34] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[10:21:43] <pnkfelix> kemurphy: (and I cannot think of a good reason to disallow it)
[10:23:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[10:27:02] <doener> dbaupp: sorry, been in a meeting
[10:30:53] <dbaupp> doener: ok :)
[10:32:13] <doener> dbaupp: where would I put that test?
[10:32:23] <dbaupp> src/test/run-pass
[10:32:43] <dbaupp> issue-<issue-number>.rs would work, I guess.
[10:33:34] * Ms2ger likes having test names be indicative of what they test
[10:33:58] <dbaupp> transmute-non-immediate-to-immediate.rs
[10:34:19] <Ms2ger> See? :)
[10:34:54] <dbaupp> Ms2ger: I'd r+ a pull request that changes all the issue-*.rs tests to be descriptive ;P
[10:35:13] * Ms2ger looks around
[10:35:14] <Ms2ger> Anyone? :)
[10:35:35] <dbaupp> (that said, having them linked to the issue is useful also.)
[10:35:51] <doener> I'm not going to rename it again :-p
[10:36:01] <doener> the issue is referenced in a commit at the top
[10:36:05] <doener> err, comment
[10:36:36] <dbaupp> yeah, that's good enough/better.
[10:36:58] <doener> PR updated
[10:37:30] <dbaupp> doener: r+'d
[10:37:51] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[10:37:59] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[10:38:00] <dbaupp> wow, Rust used to have `for .. in ..` loops! http://stackoverflow.com/questions/9271970/how-do-you-make-a-range-in-rust
[10:38:08] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:38:11] <doener> woah, the queue is huge again
[10:40:10] *** Quits: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP) (Quit: Leaving.)
[10:40:39] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[10:44:19] *** Joins: Khmar (user@A420B6CD.B01207CF.FA4E5DC4.IP)
[10:45:01] <doener> hm, the rustpkg tests sometimes deadlock here
[10:45:08] *** Quits: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP) (Quit: WeeChat 0.4.2-dev)
[10:46:08] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[10:48:45] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[10:48:54] <doener> "sometimes" == it's a different test each time that deadlocks
[10:48:57] *** Joins: Earnestly (earnest@2AB30F53.FB5005.2BCC804A.IP)
[10:49:51] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[10:51:46] <kemurphy> pnkfelix: actually, making it a uint has... a lot of fallout to worry about
[10:54:58] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[10:59:03] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[11:02:56] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[11:08:24] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[11:10:35] <doomlord> collection.map() is deprecated? that would be a shame to remove.. why not keep it as default implementation iter().map(..) or whatever it is. i'd always want to define that myself otherwise
[11:10:58] <doomlord> iter().transform(f).collect whatever it is
[11:11:33] <doomlord> each() was great aswell
[11:13:44] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[11:14:44] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:14:44] <pnkfelix> dbaupp: ^  I wonder this too
[11:15:42] <dbaupp> doomlord: I'm not sure about .map... the replacement is horrible at the moment, so I won't be the one removing it (and I won't be the one r+-ing such a pr either), so it should be fine to use.
[11:16:11] *** Joins: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au)
[11:16:45] <dbaupp> doomlord: the .each replacement will be getting nicer: once the for loop gets changed it'll be `for v.iter() |x| { ... }` or  `for x in v.iter() { .. }` (or something along those lines)
[11:17:22] <dbaupp> doomlord: and if/when we get an Iterable trait, this may become `for v |x| { .. }`/`for x in v { .. }` 
[11:18:15] <dbaupp> pnkfelix: ^
[11:18:54] <dbaupp> doomlord: wait, I may've misunderstood your .map question...
[11:19:42] <dbaupp> do you mean: you don't want it to be forcibly overriden by the iterator method called 'map' if it ever becomes `some_iterable.map()`?
[11:20:26] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Ping timeout)
[11:21:38] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[11:21:38] <doomlord> worried by the source comments i see :)
[11:21:50] <dbaupp> which ones?
[11:22:08] <kimundi> doomlord, dbaupp pnkfelix: There will be an iterable trait. container.iter().map() will be directly writeble with container.mad()
[11:22:16] <kimundi> err, map
[11:24:30] <doomlord> vec.rs:966 /// Deprecated, use iterators where possible    ... fn map<U>... self.iter.transform().collect() <<< of course I can see the value in the underlying iterators allowing composable behaviour, but its nice to have shortcuts for simple common cases 
[11:24:56] <doomlord> "iterable trait", ok sounds nice
[11:26:59] <doomlord> "for x in foo.bar"   ... is that going to be new sugar for    "for foo.bar |x| { .... " perhaps, i suppose it reads more naturally
[11:27:30] <kimundi> I was also in favor of convenince methods, but strcat kinda convinced me that they just lead to a giant unnecessary code explosion
[11:28:21] <kimundi> doomlord: The syntactic change of for is only because of the more important semantic chang that it will have
[11:28:39] <kimundi> It won't be sugar for a closure call anymore
[11:28:43] <dbaupp> that comment is mostly trying to say things that one used to write `let v = x.map(add_one); for v.each |y| { foo(y) }` can and should be `for v.iter().transform(add_one).advance |y| { foo(y); }` (especially combined with .filter and several .map's)
[11:28:58] <dbaupp> doomlord: (that syntax is one of the proposals.)
[11:29:04] <kimundi> Instead, it will be suger for a loop that repeatetly calls next() on an iterator
[11:29:04] <doomlord> ahh it really is a new loop construct
[11:29:29] <doomlord> ok i recall discussion on how "return"  worked
[11:30:53] *** Quits: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP) (Client exited)
[11:32:01] <doomlord> well, if you have a complex expression that can be done with composed iterations, fair enough, but  .map() is nice for simple cases ... unless you need the symbol for something else i hope it can be kept
[11:32:02] *** Joins: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP)
[11:32:21] <kimundi> Funny story, we have 'collect()' now because of a huge argument I had with strcat about removing 'to_vec()' on iterators, wich kinda goes into the same direction: functions that harcode specific cases that are already expressible by chaining the right things togethethor only bloat the source and the docs.
[11:33:01] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[11:34:05] <doomlord> is the compromise that its placed in a helper trait, rather than in the underlying functionality
[11:34:08] <kimundi> Better learn once how to 'container.map().collect()', than N times how to 'container.map_collect_self_t()' (or something like that)
[11:35:21] <doomlord> trait IteratorHelpers {   map<u>(&self,f) { self.iter().transform(f).collect()  map_reduce(&self,..) etc }  /* doesn't pollue the underlying collection */
[11:35:53] <kimundi> well, transform is going to be renamed to map
[11:36:31] *** Joins: mye (mye@moz-60013FCF.dip0.t-ipconnect.de)
[11:36:40] <kimundi> the current vec.map() would need another name anyway, like map_collect()
[11:36:49] <dbaupp> doomlord: it will be a default method on Iterable (if we can get Iterable to work), i.e. v.map(f).collect()
[11:37:01] <dbaupp> (to get a ~[T]
[11:37:02] <dbaupp> )
[11:37:59] *** Joins: LU324 (stuff@moz-A17E9A7B.dyn.embarqhsd.net)
[11:38:12] <kimundi> The important thing here is to guide user to do the right thing: If they can only chain together iterators together and only get a collection with collect(), then they're going to allocate at most once
[11:38:44] <kimundi> With helper funtcions that return an collection they are going to allocate N times
[11:40:45] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[11:40:53] <kimundi> something like 'string.map(...).filter(...).words().map(...)' used to be all over the code base... This code piece would allocate and fill 4 vectors.
[11:41:13] <doomlord> well if a pair or more of chained iterations is the most common case i can see the reasoning behind wanting "map" for that
[11:41:41] <doomlord> .map().filter().collect()     ...fair enough
[11:42:01] <doomlord> so in short you want the shorter name for something else more common
[11:42:03] * dbaupp thinks we need a way to return iterators more succinctly
[11:42:10] <kimundi> yeah
[11:42:38] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[11:43:14] <doomlord> and for my original use, i really just want a helper for .map().collect()   and it could be "mapped()" , "map_c" or something.. or even "transform()" :)
[11:43:36] <doomlord> i suppose a trailing collect is easy enough to type
[11:43:43] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[11:43:43] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/mLZwFw
[11:43:43] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[11:43:57] <dbaupp> why do you need it? are you returning a vector?
[11:44:06] <kimundi> doomlord: And if you really need it, can allways write a helper trait yourself
[11:44:30] <kimundi> We just shouldn't make it idiomatic by including it in the library
[11:44:53] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:45:44] <doomlord> ok well you've certainly convinced me 100% that the best use of .map() is to return sometthing composable.
[11:46:07] <doomlord> since the more complex expressions are more common, with mutliple iterations chained
[11:46:27] <doomlord> .map().collect() is ok
[11:46:38] <doomlord> probably easier than having another symbol
[11:46:43] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:46:43] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/jO9Pmg
[11:46:43] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:46:43] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[11:46:43] <ghrust> 01[13rust01] 15bors pushed 11 new commits to 06auto: 02http://git.io/MYUT_A
[11:46:43] <ghrust> 13rust/06auto 1460cb9c0 15blake2-ppc: serialize: implement Encodable for DList...
[11:46:43] <ghrust> 13rust/06auto 145336bdc 15blake2-ppc: dlist: Simplify match clauses to use Option methods...
[11:46:44] <ghrust> 13rust/06auto 1478d0cf1 15blake2-ppc: dlist: Factor out pop and push operations by list node...
[11:46:46] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[11:49:04] <doomlord> .string.map().fold().collect() .... fair enough]
[11:49:26] <engla> you can't collect to ~str at the moment
[11:50:01] <engla> I've written a patch to fix that but I'm not sure it's doing the right thing so I haven't submitted
[11:50:19] <engla> I thought that you should be able to collect an iterator of char, of &str or ~str or @str into ~str
[11:50:20] <dbaupp> engla: it takes a Iterator<char>, right? that should be correct?
[11:50:27] <engla> it takes all of those
[11:50:30] <dbaupp> oh
[11:50:32] <dbaupp> wow!
[11:50:52] <kimundi> engla: Well, if it works... :)
[11:51:08] <doomlord> (the particular bit of code i have at the minute  just uses .to_str() on the vector, something more intelligent would be possible eg customizing the separator)
[11:51:08] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[11:51:28] <dbaupp> engla: there's `StrVector` that should be converted to use iterators (although this makes it 50% slower.)
[11:51:34] <kimundi> engla: though... Probably should just work on char
[11:51:39] <kimundi> engla, 
[11:51:40] <dbaupp> engla: and so the .collect() function could just use char
[11:51:46] <engla> dbaupp: yeah strvector has an easier time because it's reiterable
[11:51:58] * dbaupp knows that
[11:52:00] <kimundi> engla: &str at co strike me more as ending in a ~[&str] et co
[11:52:04] <doomlord> elems.map(|&x|....).intersperse(",").flatten_to_str()... whatever
[11:52:06] * dbaupp wrote the current implementation
[11:52:12] <engla> kimundi: well you can choose yourself 
[11:52:17] <engla> what to collect into
[11:53:02] <engla> doomlord: sounds good
[11:53:22] <doomlord> i;m sidetracking myself :( back to my quest for a decent code navigation tool :)
[11:53:30] *** Quits: BitPuffin (quassel@moz-1789B472.bredband.tre.se) (Ping timeout)
[11:53:31] <kimundi> engla: Sure, but it's a bit confusing imo. something like a seperate flatten() method sounds better
[11:54:03] <kimundi> 'collect' shuold only iterate through all elements and push them into a new collecton, not more imo
[11:54:07] <engla> well someone said that char isn't always the best way to split up a string into parts and I took that to heart
[11:54:18] <engla> as in graphemes might be &str
[11:54:22] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[11:54:34] <dbaupp> engla: yeah, that's a good point
[11:54:44] * dbaupp always forgets about graphemes
[11:54:50] <kimundi> sure, a string can be split into bytes (u8), codepoints (char) and graphemes (&str)
[11:55:09] <kimundi> hmm... Okay this is tricky
[11:55:47] <engla> current diff https://gist.github.com/anonymous/b365055f701016cbd152  for collect to ~str
[11:56:03] <engla> str.rs is so big, can we put things into other files in libstd/str/ ?
[11:56:05] <kimundi> I think... the clean way would be 'struct Graph(&str)', and have collect for those.
[11:56:49] <dbaupp> engla: yes, split it up.
[11:57:04] <dbaupp> engla: (well, feel free to split things out as you see fit.)
[11:57:13] <engla> ok nice
[11:58:47] <engla> kimundi: ok I don't know. there are a lot of things you can do with string parts, and maybe it should just be iterator correspondances to StrVector
[12:02:58] <kimundi> Okay, thinking about it I'm pretty sure that Grapheme should be a newtype around &str: You get the additional invariant that the slice corresponds to one grapheme cluster
[12:03:11] *** Quits: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) (Client exited)
[12:13:33] <true_droid> is there a callable trait in Rust, similar to operator() in C++?
[12:15:20] <dbaupp> true_droid: no
[12:20:03] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[12:21:17] *** Quits: Khmar (user@A420B6CD.B01207CF.FA4E5DC4.IP) (Ping timeout)
[12:22:18] *** Joins: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de)
[12:32:34] *** Joins: AKP (AKP@9C75F0D7.70210EB.301675BC.IP)
[12:34:07] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[12:34:28] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[12:36:49] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[12:37:10] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[12:39:51] <doomlord> operator() is for emulating things you can do better with lambdas i think
[12:41:20] <engla> an arbitrary function signature in a trait is awkward (you'd need to use a tuple for the arguments)
[12:42:06] <engla> trait Callable<Args, Ret> {  fn call(Args) -> Ret }
[12:43:34] *** Quits: aruniiird (Mibbit@92D70115.B332A52C.E3D0A897.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:46:02] <doomlord> on this subject, something i always wished it was easier to do is capture /setup an argument function block for later application eg interface for remote procedure calls, messaging ssytems ... typicallly done with very messy x-macros
[12:46:40] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[12:46:41] <doomlord> setup or capture an function argument block^ ... having somethign to generate a struct of the function arguments, and vica versa call a functoin with that arguemnt struct
[12:47:36] <doomlord> if i ever to do anything like that again i'll probably make a code-generator with clang
[12:48:55] <doomlord> automatically spit out the appropriate structs with their constructors... foo(A , B b) .--->  struct foo_args{ A a; B b; foo_args(A& _a, B& _b){a=_a;b=_b;} operator(){foo(a,b) })
[12:49:52] <doomlord> i wonder what options you have for doing tht sort of thing in rust.   Is it something multi-element macros might make easier
[12:51:23] <doomlord> uses - network code, and exposing things to guis
[12:51:53] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[12:53:16] *** Joins: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP)
[12:53:20] *** Joins: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP)
[12:53:21] *** ChanServ sets mode: +o dherman
[12:53:26] *** Quits: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP) (Quit: dherman)
[12:56:09] *** kimundi is now known as zz_kimundi
[13:00:30] *** Quits: gavinb (gavinb@moz-9EC182F0.lowrp3.vic.optusnet.com.au) (Quit: gavinb)
[13:00:56] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:01:49] *** Joins: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de)
[13:04:06] *** Quits: AKP (AKP@9C75F0D7.70210EB.301675BC.IP) (Quit: )
[13:09:13] *** jyeo_afk is now known as jyeo
[13:10:59] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[13:18:38] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[13:19:03] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[13:23:37] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Quit: jclements)
[13:25:49] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[13:25:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/MYUT_A
[13:25:49] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[13:26:17] <MaikKlein1> what is the easiest way to delete some changed in an earlier commit? for example I need to delete my changes to extra::net https://github.com/mozilla/rust/pull/7969/files#r5337223
[13:26:31] <MaikKlein1> i am a bit scared that I mess sth up :(
[13:28:42] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:28:42] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qv9BZg
[13:28:42] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:28:42] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[13:28:43] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/2Ms7hQ
[13:28:43] <ghrust> 13rust/06auto 140a81a01 15Michael Woerister: Adapted `trans::common::{block, fn_ctxt, scope_info}` to new naming convention.
[13:28:43] <ghrust> 13rust/06auto 14b98d659 15bors: auto merge of #7848 : michaelwoerister/rust/trans_cleanup_1, r=jdm...
[13:28:43] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[13:30:04] *** zz_kimundi is now known as kimundi
[13:31:21] *** Quits: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP) (Ping timeout)
[13:32:51] <cyndis> make a local commit that removes the stuff, use that to fixup the offending commit using git rebase -i then force push to your remote branch
[13:34:02] <cyndis> or you can delete the offending commit using git rebase -i then redo the commit
[13:34:04] <cyndis> or something
[13:34:15] <doener> or just use rebase -i and set the commit to edit
[13:34:31] <doener> then it will stop after that commit, so you can amend it
[13:34:40] <cyndis> ah yeah, you can do that too..
[13:37:16] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:37:42] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[13:37:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b98d659 to 1469a237e: 02http://git.io/N3iJvQ
[13:37:42] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[13:37:44] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[13:37:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ubxmjw
[13:37:45] <ghrust> 13rust/06auto 141e37e0a 15Roy Crihfield: Make `rust-mode` derive from `prog-mode` if available
[13:37:45] <ghrust> 13rust/06auto 146ac9126 15bors: auto merge of #7948 : roysc/rust/master, r=pnkfelix...
[13:37:45] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[13:39:19] *** Quits: mark_edward (quassel@moz-4A9A2F15.dynamic.utc.edu) (Ping timeout)
[13:39:29] *** Joins: bent (chatzilla@moz-2CD73AA6.triad.res.rr.com)
[13:43:40] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[13:43:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146ac9126 to 1469a237e: 02http://git.io/N3iJvQ
[13:43:40] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[13:43:41] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[13:43:41] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/P4Z2EQ
[13:43:41] <ghrust> 13rust/06auto 1449014c8 15zslayton: Exposed previously hidden 'use' statements in the tutorial's sample code.
[13:43:41] <ghrust> 13rust/06auto 14efa2736 15bors: auto merge of #7954 : zslayton/rust/master, r=huonw...
[13:43:42] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[13:45:34] *** Quits: reyre (rick@B2D8AB09.33EE9F8A.1139E686.IP) (Quit: Leaving)
[13:46:04] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[13:47:08] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[13:49:40] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[13:49:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14efa2736 to 1469a237e: 02http://git.io/N3iJvQ
[13:49:40] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[13:49:41] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[13:49:41] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Cm5x-w
[13:49:41] <ghrust> 13rust/06auto 14f98f3b0 15Felix S. Klock II: Note incompatibility with global-whitespace-mode....
[13:49:41] <ghrust> 13rust/06auto 1476c44c5 15bors: auto merge of #7964 : pnkfelix/rust/fsk-issue3994-readme-note, r=huonw...
[13:49:41] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[13:52:18] <engla> uh ok, bors tripped on index.lock again
[13:52:21] <engla> uh oh
[13:53:07] *** kimundi is now known as zz_kimundi
[13:54:25] *** Joins: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP)
[13:54:25] *** ChanServ sets mode: +o dherman
[13:54:36] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[13:55:42] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[13:55:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1476c44c5 to 1469a237e: 02http://git.io/N3iJvQ
[13:55:42] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[13:55:42] *** Joins: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com)
[13:55:42] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[13:55:43] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/oWk2uQ
[13:55:43] <ghrust> 13rust/06auto 1419c8c7a 15Birunthan Mohanathas: Change 'print(fmt!(...))' to printf!/printfln! in src/lib*
[13:55:43] <ghrust> 13rust/06auto 14ce1a10d 15Birunthan Mohanathas: Change 'print(fmt!(...))' to printf!/printfln! in src/test/
[13:55:43] <ghrust> 13rust/06auto 1468f0c0a 15bors: auto merge of #7968 : poiru/rust/print-fmt-cleanup, r=brson...
[13:55:45] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[13:58:18] <dbaupp> engla: :(
[13:58:39] <engla> yeah
[13:59:46] <dbaupp> do you wanna open an issue ccing graydon?
[13:59:54] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:00:17] <engla> I can do that
[14:00:47] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[14:00:57] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[14:01:44] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[14:01:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1468f0c0a to 1469a237e: 02http://git.io/N3iJvQ
[14:01:44] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[14:01:45] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[14:01:45] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/gOmgiQ
[14:01:45] <ghrust> 13rust/06auto 14339295a 15Birunthan Mohanathas: Disallow non-comma-delimited arguments to fmt! and bytes!...
[14:01:45] <ghrust> 13rust/06auto 146f27cb7 15bors: auto merge of #7974 : poiru/rust/require-fmt-comma, r=bstrie...
[14:01:46] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[14:03:55] *** Quits: bent (chatzilla@moz-2CD73AA6.triad.res.rr.com) (Input/output error)
[14:04:05] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[14:04:35] *** Joins: bent (chatzilla@moz-2CD73AA6.triad.res.rr.com)
[14:05:33] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[14:07:44] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[14:07:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146f27cb7 to 1469a237e: 02http://git.io/N3iJvQ
[14:07:44] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[14:07:45] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[14:07:45] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/c9u16g
[14:07:45] <ghrust> 13rust/06auto 14bd0d750 15Steven Stewart-Gallus: Change concurrency primitives to standard naming conventions...
[14:07:45] <ghrust> 13rust/06auto 1460c54a9 15Steven Stewart-Gallus: Fix nits.
[14:07:45] <ghrust> 13rust/06auto 148e7fb46 15bors: auto merge of #7978 : sstewartgallus/rust/rename_arc, r=bblum...
[14:07:46] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[14:08:05] <engla> https://github.com/mozilla/rust/issues/7995
[14:08:21] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[14:08:24] <engla> well the issue doesn't say much but there it is
[14:10:33] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[14:10:45] <dbaupp> cool (in theory I just shutdown mac4 (which has the problem)... dunno if this'll work.)
[14:10:47] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[14:10:59] *** Quits: jaen (jaen@moz-25F38FEF.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:11:10] <dbaupp> ok, it's "Not connected"
[14:11:31] <doomlord> using the AST, i found myself wanting a universal node type - like in libclang , i'd built it by wrapping the existing ones; 
[14:11:38] <engla> I found the right builder web page with the right links after some looking around (for the issue)
[14:11:52] <engla> yeah the console displays it's just one system failing
[14:11:57] <doomlord> would another approach exist, like making a node type that is just a node id & reference to the parse context.. 
[14:12:40] <doomlord> e.g. between the node-id and parse context objects that exists, can one query the structure
[14:12:50] <doomlord> (query, travese)
[14:13:25] <doener> I wonder if there's a legitimate reason for SIGKILL instead of SIGTERM to interrupt the build
[14:13:55] <doener> I'd expect it to at least try SIGTERM first
[14:15:11] <dbaupp> aaand, it looks like bors may've crashed
[14:15:30] *** Joins: Blub\w (wry@moz-A4EB02BD.vps.tuwien.ac.at)
[14:16:13] <dbaupp> http://buildbot.rust-lang.org/builders/auto-linux-all-opt/builds/556/steps/configure/logs/stdio
[14:16:15] * dbaupp sighs
[14:16:32] <dbaupp> this is *exactly* what happened last time.
[14:17:31] <engla> yes
[14:17:47] <dbaupp> should we shutdown linux4 too?
[14:18:29] <Ms2ger> I've heard that linux4 should not usually be on
[14:18:47] * dbaupp turns it off
[14:18:49] <engla> I don't know about these things
[14:19:47] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[14:19:47] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148e7fb46 to 1469a237e: 02http://git.io/N3iJvQ
[14:19:47] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[14:19:47] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[14:19:48] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/Od5qsA
[14:19:48] <ghrust> 13rust/06auto 14bc2b78c 15Graydon Hoare: rt: Fix child-iteration bug in crate map.
[14:19:48] <ghrust> 13rust/06auto 14786318f 15Graydon Hoare: std: add #[cfg(test)] reference to extra so we can benchmark libstd.
[14:19:48] <ghrust> 13rust/06auto 14e5cbede 15Graydon Hoare: std: add preliminary str benchmark.
[14:19:50] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[14:20:17] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[14:20:38] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[14:21:51] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[14:22:21] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:22:30] *** Joins: Guest__ (textual@BBE7C46A.B4F11D08.8612FA94.IP)
[14:27:03] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[14:31:00] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[14:31:25] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[14:33:03] <dbaupp> doener: "BuildBot (0.8.5) working for the Rust project." :(
[14:34:06] <doener> argh
[14:34:23] <dbaupp> I think graydon said he needed to upgrade it anyway
[14:34:33] *** Joins: xLII (xarch@A6038EAF.BEC20239.F5CC85D7.IP)
[14:34:44] * dbaupp feels sorry for graydon spending all this time fighting buildbot
[14:35:08] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[14:35:26] <doener> he should crowdsource the work
[14:35:56] <doener> just remove all password checks and wait until world domination is achieved
[14:36:16] <bstrie> well, I mean
[14:36:26] <bstrie> there's nothing to stop any of us setting up our own aws build cluster
[14:36:36] <bstrie> and taking all the pull requests and merging them to our own rust fork
[14:36:39] <doener> $$$
[14:37:02] <bstrie> s/aws build cluster/your dad's old desktop from 1995
[14:37:03] <dbaupp> bstrie: "don't fork the repo, fork the merging"
[14:37:40] *** Quits: StarLight (StarLight@moz-3D9AA212.dynamic.avangarddsl.ru) (Ping timeout)
[14:38:01] <bstrie> I'm not sure if that was aimed at me or meant to encapsulate my sentiments :P
[14:39:03] <dbaupp> well, both?
[14:39:33] *** Quits: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP) (Quit: ëžœë¤ì€ ì‡ í‡´í–ˆìŠµë‹ˆë‹¤.)
[14:41:28] *** Joins: tcr (tcr@moz-B6F7E8EB.hfc.comcastbusiness.net)
[14:42:06] *** Joins: StarLight (StarLight@moz-391B9C89.dynamic.avangarddsl.ru)
[14:42:13] <cmr> jedestep: extra::net was removed yesterday
[14:42:17] <cmr> jedestep: very timely, eh?
[14:43:00] <bstrie> holy crap
[14:43:05] <bstrie> how awesome
[14:44:06] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Connection reset by peer)
[14:44:27] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[14:44:30] *** Quits: tcr (tcr@moz-B6F7E8EB.hfc.comcastbusiness.net) (Client exited)
[14:46:44] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[14:46:44] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1450f3e79 to 1469a237e: 02http://git.io/N3iJvQ
[14:46:44] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[14:46:46] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[14:46:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/CinS1g
[14:46:46] <ghrust> 13rust/06auto 141e37e0a 15Roy Crihfield: Make `rust-mode` derive from `prog-mode` if available
[14:46:46] <ghrust> 13rust/06auto 145130088 15bors: auto merge of #7948 : roysc/rust/master, r=pnkfelix...
[14:46:47] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[14:47:17] *** Quits: xLII (xarch@A6038EAF.BEC20239.F5CC85D7.IP) (Ping timeout)
[14:47:24] *** Quits: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net) (Ping timeout)
[14:48:37] *** Joins: tcr (tcr@D26BCFC9.C2203064.EDCE493E.IP)
[14:52:54] <cmr> acrichto_: really nice work with 7986, reviewing it now
[14:59:29] *** Joins: poiru (poiru@moz-C4357EA7.kapsi.fi)
[15:00:52] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:02:48] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[15:08:35] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: HSH)
[15:09:20] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[15:12:44] <jdm> what's the method that lets me iterate a numeric range from low to high?
[15:13:05] *** Joins: yonran (yonran@moz-962F33EB.acuitus.com)
[15:13:35] <bstrie> does int::range(0,10) still work?
[15:13:42] <jdm> it's not listed in the docs
[15:13:45] <jdm> but uint::range does
[15:13:46] <Ms2ger> I read "what's the monad..."
[15:13:48] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[15:13:49] <bstrie> might have gotten culled
[15:13:59] <cmr> it's generated by a macro, can't be listed in the docs
[15:14:04] <cmr> it's there though
[15:14:22] <jdm> or maybe it's uint::iterate
[15:14:24] <cmr> There's also a Counter in std::iterator if you want an external iterator
[15:14:30] <bstrie> rusti: for std::int::range(0, 3) |i| { error!(i); }
[15:14:31] -rusti- rust: ~"0"
[15:14:31] -rusti- rust: ~"1"
[15:14:31] -rusti- rust: ~"2"
[15:14:32] -rusti- ()
[15:14:36] <bstrie> there you go
[15:14:38] <pnkfelix> cmr: is there a bug against rustdoc and/or the macro system for that issue?
[15:14:44] * pnkfelix goes to look
[15:14:52] <cmr> pnkfelix: dunno but it's fixed in rustdoc_ng
[15:14:56] <jdm> nice
[15:15:08] <bstrie> cmr: what's the approach for documenting macros like that?
[15:15:09] <pnkfelix> cmr: what's the fix?
[15:15:21] <cmr> rustdoc_ng does macro expansion
[15:15:33] <cmr> So modules generated by macros will get documented
[15:15:35] <bstrie> so do you just stick a doc comment inside the macro itself?
[15:15:39] <cmr> Yes
[15:15:42] <bstrie> that's fine
[15:16:09] <cmr> I also want to add the ability to slap doc comments on macros themselves, but it's not useful to do that until they can be exported
[15:16:26] <cmr> so I'm not worrying about it (it's easy to support)
[15:16:39] <bstrie> I'm amused at the idea of defining the macros such that we're passing in string fragments to fill the blanks in doc comments
[15:17:54] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[15:19:26] <jedestep> cmr: I haven't tried any new RT stuff on a current master build, but as of 0.7 it was certainly not ready for primetime
[15:19:39] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[15:19:42] *** Joins: joey (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[15:19:52] <jedestep> I had to turn it off when compiling because it made rustc segfault on most of my files
[15:27:21] *** Quits: Blub\w (wry@moz-A4EB02BD.vps.tuwien.ac.at) (Quit: WeeChat 0.4.1)
[15:27:36] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:32:02] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:34:02] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Ping timeout)
[15:35:47] *** Quits: dherman (dherman@8A703D98.AE3E6FBC.FEA76598.IP) (Quit: dherman)
[15:36:27] *** Joins: nano (nano@moz-972880B.superkabel.de)
[15:36:36] *** Joins: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de)
[15:38:22] <bstrie> does it make sense to put trait bounds on traits definitions?
[15:38:33] <bstrie> like `trait Foo<A: Bar> { ... }`
[15:39:52] <cmr> bstrie: I think so?
[15:40:08] <cmr> for example if you want a trait that can use any given iterator
[15:41:09] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[15:41:09] *** ChanServ sets mode: +qo graydon graydon
[15:41:21] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:41:22] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:41:56] <cmr> graydon: the libstatgrab people couldn't get full consensus on relicensing, "So at this time the answer is no"
[15:42:05] <graydon> yeah
[15:42:11] <graydon> that's usually what happens when you try to relicense
[15:42:14] <cmr> yup
[15:42:39] <graydon> it's ok. I don't hold it against anyone. it'll still work fine as a rustpkg package or something. we just can't put that sort of thing in our stdlib.
[15:42:45] <cmr> right
[15:43:03] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[15:43:09] <bstrie> libstdlicenseconflict
[15:43:14] <graydon> yeah, maybe
[15:43:27] <bstrie> stdlicenseconflict::statgrab is quite a mouthful though
[15:43:39] <cmr> I'd rather make a homespun instrumentation thing than resort to that
[15:43:55] <graydon> I used to make most of my stuff gpl too. I really like the spirit of it.
[15:44:33] <cmr> (it's lgpl)
[15:46:24] <graydon> oh? the site says "unless otherwise mentioned, everything here is gpl"
[15:46:31] <graydon> I don't see any mention of libstatgrab being lgpl
[15:46:34] <pnkfelix> graydon: https://github.com/i-scream/libstatgrab/commit/52a2ca4665f94d15c677b0bb12adda397c653b95
[15:46:37] <cmr> it's in the distribution
[15:46:40] <graydon> in any case, we can't take either as stdlib dependencies :(
[15:46:47] <graydon> static linking :(
[15:47:01] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[15:47:03] <graydon> ah, ok
[15:47:31] <graydon> most people think lgpl is sufficient. I had to have a long chat with legal here to get into the finer details of its obligations to be sure we weren't going to be able to go with it.
[15:47:38] <graydon> sure would like to take a bunch of lgpl stuff!
[15:48:03] <graydon> but the relinking thing is a killer. you can't ship a compiler that requires all binaries be relinkable.
[15:50:28] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[15:50:30] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[15:50:38] <pnkfelix> graydon: I'm a little surprised that's the interpretation (that the derived output binaries have to be relinkable)?  I would have thought it would suffice for ship either a DLL or source for the library inquestion.
[15:50:51] <graydon> pnkfelix: yes
[15:50:53] <pnkfelix> sed -e s/for ship/to ship/'
[15:50:55] <graydon> pnkfelix: that's what it amounts to
[15:50:56] <cmr> graydon: off the top of your head do you know how to handle the issue mentioned in the commit message at https://github.com/cmr/rustdoc_ng/commit/c1b3b18ddb8d1a14c4d22d7229cde499e1ca0d4a
[15:51:01] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Quit: leaving)
[15:51:06] *** Joins: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP)
[15:51:30] <graydon> pnkfelix: it amounts to telling that if one of our downstream users wants to compile a program and link it statically, they either have to provide source or a bundle of .o files or a separate .dll-version
[15:51:30] <jack> pnkfelix: the freedom it protects is the freedom to modify the lgpl library and use the new modified version. if you can't relink, that freedom doesn't exist.
[15:51:42] <pnkfelix> graydon: oh, I see, they have to be able to relink their modified versions of the library 
[15:51:45] <graydon> yes
[15:52:15] <graydon> it's a freedom for downstream users of (say) libstatgrab to modify-and-use-modifications-in-place in all cases where libstatgrab is deployed
[15:52:18] <graydon> (or any other lgpl lib)
[15:52:27] <graydon> it means static linking is likely a no-go
[15:52:32] <graydon> and lots of people want static linking
[15:53:04] <graydon> it's not just a burden on us; it's a burden on anyone who links against our stdlib and picks up object files containing code under that license
[15:53:43] <graydon> since we compile crate-at-a-time...
[15:54:01] <graydon> (which might, incidentally, wind up a bit of a problem in static linking; we may need to do function-sections or something)
[15:55:02] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[15:57:21] <graydon> https://etherpad.mozilla.org/Meeting-weekly-2013-07-23
[15:57:23] <cmr> graydon: it also makes incremental compilation non-trivial
[15:57:28] <cmr> oh it's tuesday, I like tuesdays
[15:57:49] <pnkfelix> graydon: are we starting earlyZ!
[15:57:51] <pnkfelix> graydon: ?
[15:57:55] *** jdm is now known as jdm|f00ding
[15:57:59] * pnkfelix runs to find a quiet space
[15:58:12] <graydon> cmr: I know. we had to cut the boundary somewhere. if you want fast compiles you need a DAG somewhere, but if you've ever worked in a mandatory file-DAG language ... you may recognize how cramped it feels
[15:58:22] <cmr> Yeah, I know
[15:58:32] <cmr> I think it's a good solution, it just comes with its own bundle of problems
[15:58:33] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[15:58:41] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:59:33] *** Joins: pnkfelix1 (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:59:36] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Connection reset by peer)
[16:00:04] <graydon> besides, there _is_ an emergent unit of versioning and linkage that's larger than a file. we see it in every language. jars, .a/.so files, executables, assemblies..
[16:00:27] <cmr> I think it's doable to do partial compilation, maybe at the module boundary, but it'd require some rejiggering of a lot of things to not work over the whole crate at once I think
[16:00:34] <graydon> it's a good place to draw namespace-management boundaries too
[16:00:37] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[16:00:39] *** Quits: pnkfelix1 (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Connection reset by peer)
[16:01:10] <graydon> cmr: it's possible. tjc	once looked into it and .. there was a lot to do. it'd be a long trek to get it working.
[16:01:15] <cmr> yeah
[16:01:55] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[16:02:19] <kemurphy> r? https://github.com/mozilla/rust/pull/8000
[16:02:28] <cmr> Then again, maybe it's not a big deal to parse and typecheck the whole crate and so forth, at least not for a first cut, that's not the slow part of compilation right now
[16:02:47] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[16:03:20] *** Joins: xraycat (Adium@moz-C3F5D711.pool.mediaways.net)
[16:04:15] <graydon> http://static.rust-lang.org/build-metrics/51300889d16330500ecf68f9e18a80da3ce458c1/auto-linux-32-opt/linux2/check-stage2-T-i686-unknown-linux-gnu-H-i686-unknown-linux-gnu-extra-metrics.json
[16:04:20] <graydon> https://etherpad.mozilla.org/Meeting-weekly-2013-07-23 again
[16:04:29] <MaikKlein1> can someone answer my last comment at https://github.com/mozilla/rust/pull/7969 ?
[16:04:35] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:04:37] <MaikKlein1> don't want to mess up :x
[16:05:01] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[16:05:01] *** ChanServ sets mode: +o pcwalton
[16:05:06] <cmr> MaikKlein1: `git rebase -i mozilla/master`
[16:05:10] <olsonjeffery> im on the road to disneyland
[16:05:18] <cmr> (after fetching the remote)
[16:05:24] <olsonjeffery> but i decided to drop in on the second-happiest-place-on-earth
[16:05:26] <cmr> There will be merge conflicts, you'll need to fix them manually.
[16:05:43] <MaikKlein1> cmr, hm that's what I did, I used git mergetool with delete
[16:05:50] <MaikKlein1> cmr, but it is still in there
[16:06:47] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[16:06:50] <graydon> https://etherpad.mozilla.org/Meeting-weekly-2013-07-23 again
[16:06:59] *** Joins: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com)
[16:07:13] <MaikKlein1> cmr, oh I know what you mean now :X didn't use -i
[16:08:45] <cmr> graydon: Is this meeting going to be longer?
[16:08:54] <cmr> (than usual)
[16:09:15] <graydon> cmr: not that I'm aware of
[16:09:21] <cmr> that's a pretty big agenda then
[16:09:21] <olsonjeffery> that's quite an agenda
[16:09:32] <pnkfelix> cmr: we'll drop as needed
[16:10:26] *** Joins: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP)
[16:11:33] <kemurphy> cmr: thanks for the r+
[16:11:34] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[16:11:34] *** ChanServ sets mode: +o brson
[16:12:05] *** Quits: Nisstyre (wes@moz-FD86289.netflash.net) (Ping timeout)
[16:13:42] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[16:14:35] <graydon> http://static.rust-lang.org/build-metrics/51300889d16330500ecf68f9e18a80da3ce458c1/auto-linux-32-opt/linux2/check-stage2-T-i686-unknown-linux-gnu-H-i686-unknown-linux-gnu-extra-metrics.json
[16:14:53] *** Quits: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[16:19:17] *** Quits: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net) (Connection reset by peer)
[16:20:45] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:22:02] <cmr> graydon: re: small code compile time
[16:22:09] <graydon> cmr: yes?
[16:22:22] <cmr> for very small values of small, it's entirely dominated by metadata extraction from std/extra
[16:22:33] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[16:22:37] <graydon> cmr: I know
[16:22:40] <cmr> ok
[16:24:14] *** Joins: eevee (eevee@moz-58058235.evrt.wa.frontiernet.net)
[16:24:50] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:25:45] <graydon> cmr: we parse and load the entire crate metadata segment, not just the items required by the small file. that's _the_ problem.
[16:25:49] <graydon> it's just hard to fix
[16:28:44] *** Joins: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net)
[16:29:52] *** Joins: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net)
[16:29:55] *** Joins: engla (engla@moz-9B69FE7C.selucle.dyn.perspektivbredband.net)
[16:32:45] *** Joins: eholk (eholk@moz-192536EB.uconnect.utah.edu)
[16:33:37] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[16:34:43] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:35:36] *** Joins: erickt (erickt@8C9ECD8F.3A598286.F12515B4.IP)
[16:36:03] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Connection reset by peer)
[16:36:09] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Input/output error)
[16:36:21] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[16:36:42] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:37:02] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[16:37:07] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:37:12] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[16:37:36] *** Joins: metasyntax (tvenable@moz-63D9B3D.med-web.com)
[16:40:52] *** Joins: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr)
[16:42:24] *** Quits: xraycat (Adium@moz-C3F5D711.pool.mediaways.net) (Quit: Leaving.)
[16:45:32] *** sam113101 is now known as sam113101_afk
[16:46:53] *** Joins: achim (achim@48D08254.C47AE098.3170947E.IP)
[16:47:59] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:48:40] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:49:05] *** Joins: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP)
[16:50:59] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:51:39] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:53:11] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:53:54] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[16:54:30] *** Quits: joey (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:55:05] *** Quits: engla (engla@moz-9B69FE7C.selucle.dyn.perspektivbredband.net) (Ping timeout)
[16:55:54] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:56:27] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[16:58:10] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[16:59:42] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[16:59:48] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:01:24] *** Joins: steven_is_false (user@4728DAC8.6ECAE21.F39A8AA1.IP)
[17:02:14] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[17:03:13] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[17:03:22] *** Joins: tcsc (tcsc@moz-7246F5CD.hsd1.ma.comcast.net)
[17:03:35] <brson> nmatsakis: graydon : going to mtv-3 fail
[17:03:51] *** jdm|f00ding is now known as jdm
[17:03:52] <graydon> brson: hm?
[17:04:03] <graydon> oh right
[17:04:14] <bstrie> is "fail" the name of a conference room?
[17:04:16] <steven_is_false> How can I examine bors current status?
[17:04:39] *** Joins: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP)
[17:04:51] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:04:51] *** ChanServ sets mode: +o tjc
[17:04:54] <cmr> steven_is_false: http://buildbot.rust-lang.org/bors/bors.html
[17:05:01] <steven_is_false> cmr: Thanks!
[17:05:14] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[17:05:17] <steven_is_false> Why isn't it linked on the front page?
[17:05:25] <cmr> It's linked in the topic.
[17:05:26] <graydon> no good reason
[17:05:28] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:05:47] <steven_is_false> cmr: Doh!
[17:06:26] <graydon> nmatsakis: can you get into that room?
[17:06:33] <nmatsakis> graydon: no I was about to ask you the same, I don't see it listed
[17:06:35] <graydon> nmatsakis: I don't see it listed
[17:07:07] <nmatsakis> possibly it lacks Vidyo facilities?
[17:07:19] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:07:19] *** ChanServ sets mode: +o brson
[17:07:42] *** Joins: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com)
[17:07:45] <nmatsakis> brson: neither graydon nor I see FAIL in the Vidyo list
[17:08:14] <brson> nmatsakis: yeah, it is apparently only polycom :-S
[17:08:34] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[17:08:35] <graydon> oh
[17:08:45] <nmatsakis> :/
[17:08:45] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[17:09:10] <brson> i screwed this up. there are no vidyo rooms available now
[17:09:13] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[17:09:30] <graydon> dialing into polycom
[17:09:43] <nmatsakis> graydon: how do I do that?
[17:09:48] <graydon> sip
[17:09:59] <graydon> there's an extension in the meeting invite
[17:10:04] <graydon> nobody's answering though
[17:12:40] *** Joins: bugweiser (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[17:13:09] *** Joins: jaen (jaen@moz-B19D6AB4.play-internet.pl)
[17:13:13] *** Quits: jaen (jaen@moz-B19D6AB4.play-internet.pl) (Quit: jaen)
[17:13:31] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[17:13:50] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[17:14:04] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[17:14:16] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:14:22] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[17:15:01] *** sam113101_afk is now known as sam113101
[17:15:16] *** Quits: eatkinson (eatkinson@moz-AD233F1B.dia.static.qwest.net) (Quit: eatkinson)
[17:15:35] <brson> graydon: can you try again?
[17:15:44] <graydon> dialing
[17:16:52] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[17:17:46] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:18:42] *** Joins: Vert (quassel@8A83479C.391ACC8C.CAF63861.IP)
[17:21:19] *** Parts: steven_is_false (user@4728DAC8.6ECAE21.F39A8AA1.IP) (ERC Version 5.3 (IRC client for Emacs))
[17:21:23] *** Joins: dherman (dherman@A4E26FA6.5E7911EA.DA40C4B3.IP)
[17:21:23] *** ChanServ sets mode: +o dherman
[17:21:55] *** Quits: achim (achim@48D08254.C47AE098.3170947E.IP) (Ping timeout)
[17:22:33] <brson> nmatsakis: what's the status. do you know how to get into the conference?
[17:23:10] <nmatsakis> brson: No, I was trying various vaenues,
[17:23:11] *** Joins: bnicholson (bnicholson@moz-BBE3ABD.mv.mozilla.com)
[17:23:12] <nmatsakis> *avenues,
[17:23:23] <nmatsakis> brson: so far all of them have failed. That is, I called various phone numbers and entered the pin / conf #
[17:25:16] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[17:25:46] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[17:25:57] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[17:29:17] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:29:55] *** Quits: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net) (Quit: kertap)
[17:32:24] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:33:37] <pnkfelix> pcwalton: FYI i collected a summary of the different Visitor rewrites in Issue 7081
[17:33:45] <pcwalton> ok cool
[17:34:09] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[17:34:38] <pnkfelix> pcwalton: (i think we were a bunch of threads all blocking on the "do-default-methods-work" lock)
[17:36:11] *** Joins: themgt (themgt@moz-7834B2B9.cm.vtr.net)
[17:36:13] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:36:32] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[17:38:00] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:39:07] <pnkfelix> bblum: I saw that you mentioned some pitfalls with the library cleanup code I added to the build Makefiles.
[17:39:46] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[17:39:50] <pnkfelix> bblum: I think it would be feasible to delay the removal until after the new libraries are generated, if we added a way for the Makefiles to know what their names were.
[17:40:10] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:40:48] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[17:40:51] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:40:59] <pnkfelix> bblum: e.g. if we added a new command to the rust driver that, given a source crate, told you the filenames (including the hash) that rustc will output, and then called that from the Makefile.
[17:41:12] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:41:33] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:41:47] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:42:12] *** zz_kimundi is now known as kimundi
[17:42:25] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[17:42:43] <pnkfelix> (its something I've been thinking about doing for a while; I suspect that client projects using Makefiles with rust will want it, in case that rustpkg does not suit their needs.)
[17:43:28] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:46:23] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Quit: bye bye)
[17:47:01] <poiru> Someone mind @retry-ing https://github.com/mozilla/rust/pull/7974 ?
[17:47:35] *** Joins: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de)
[17:47:52] <poiru> cmr: Thanks!
[17:47:54] <cmr> np
[17:48:04] <cmr> I hope that builder isn't stuck :\
[17:48:53] *** Quits: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP) (Ping timeout)
[17:49:40] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:50:53] <true_droid> am I not using named lifetimes correctly? https://gist.github.com/alco/6064521
[17:51:03] <true_droid> rustc borrowed.rs just hangs, this is 0.7
[17:51:22] <true_droid> rustc â€”emit-llvm borrowed.rs does work, it produces a borrowed.bc file
[17:53:48] <tjc> true_droid: works for me
[17:54:07] <tjc> with something later than 0.7, though
[17:55:15] <bstrie> so I have a question involving advanced macro usage that is probably obvious to people who have ever used macros in a lispy language before
[17:55:17] *** Joins: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net)
[17:55:40] <pauls> bstrie: I need to go soon, but I'm eager to hear it.
[17:55:55] <bstrie> pauls: look at this issue: https://github.com/mozilla/rust/issues/4381
[17:56:03] <Ms2ger> (How do you find a lisp user?)
[17:56:09] <true_droid> tjc: ok, I'll have to wait for 0.8 then. I was simply trying to confirm that this code used named lifetimes correctly https://gist.github.com/alco/6064601
[17:56:10] <Ms2ger> (Don't worry, they'll tell you.)
[17:56:10] <bstrie> pauls: when the issue was made we had the `let x = 4, y = 2;` syntax
[17:56:17] <sully> what is the trait for comparing?
[17:56:23] <bstrie> pauls: nowadays you'd have to write `let x = 4; let y = 2;`
[17:56:30] <sully> ah, Ord, just like haskell
[17:56:34] <tjc> true_droid: it's strange that it would hang, though. what OS are you running?
[17:56:39] <bstrie> pauls: I'd like to have a macro that is invoked the same way as in the original test case
[17:57:07] <bstrie> pauls: but I'm not sure how to make that work
[17:57:13] <true_droid> tjc: OS X 10.8 (but installed rust while I was on 10.7). It just hangs with no CPU usage or memory growth, two rustc processes to be precie
[17:57:16] <true_droid> *precise
[17:57:18] <pauls> Bump the repeater parens out...
[17:57:26] <bstrie> repeater parens?
[17:57:41] <pauls> `$(let $var = $val;)+`
[17:57:59] <pauls> bstrie: it's a name I just made up for `$(...)*`
[17:58:02] <bstrie> pauls: wait, so that works even if there's only one val?
[17:58:05] <tjc> true_droid: can you try running rustc -Z time-passes borrowed.rs and see what stage it gets stuck at?
[17:58:21] <pauls> What's wrong with only one val?
[17:58:37] <bstrie> pauls: I figured it would choke! hadn't even considered that it wouldn't
[17:58:41] <bstrie> let me try
[17:58:59] *** Quits: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de) (Quit: mellum)
[17:59:18] <pauls> Oh, I see. Yes. The rules for `$(...)*` are called Macro By Example, and they happily repeat things that are singletons to make them match something else.
[17:59:20] <true_droid> tjc: https://gist.github.com/alco/6064521#file-gistfile2-txt-L1
[17:59:39] <pauls> Didn't even notice what was going on in the invocation.
[17:59:49] <cmr> it doesn't hang anywhere?
[18:00:00] <toddaaro> brson: where is the message send benchmark code for the result you mentioned? I'm curious what it does. It seems likely that there are a few obvious "unimplemented" level features in the scheduler responsible for some slowness.
[18:00:07] <cmr> that looks like all the passes to me
[18:00:15] <tjc> cmr: linking isn't there
[18:00:18] <cmr> ah
[18:01:00] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:01:06] <tjc> true_droid: when you say it hangsâ€¦ how long were you waiting before killing it?
[18:01:09] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[18:01:30] *** Quits: PeterSP (peter@moz-4DAF5777.bstnma.fios.verizon.net) (Ping timeout)
[18:02:37] <bstrie> pauls: ok, but I think now I'm running up against the inability to expand to more than one item :P
[18:02:41] <bstrie> pauls: thanks though
[18:06:01] <true_droid> tjc: it's still hanging since I posted the passes
[18:06:25] <true_droid> tjc: http://d.pr/i/83qk
[18:06:54] <true_droid> the picture doesn't change with time whatsoever
[18:07:07] <tjc> true_droid: try running it again like: RUST_LOG=rustc::back::link rustc borrowed.rs
[18:07:15] <tjc> that will print out some debugging info like what linker command it's calling
[18:07:51] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[18:07:52] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145130088 to 1469a237e: 02http://git.io/N3iJvQ
[18:07:52] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[18:08:14] <true_droid> tjc: https://gist.github.com/alco/6064521#file-gistfile3-txt-L1
[18:09:30] <tjc> true_droid: so the next thing to try isâ€¦ what happens if you run: cc, followed by the link arge that it printed out (the part after "args:")?
[18:09:58] <tjc> it's also a little weird that the link args mention both /usr/local/libâ€¦ and -- in the very last thing -- /usr/local/Cellar...
[18:10:03] <tjc> I would expect it to be all one or the other
[18:10:08] <tjc> dunno if that's the problem, though
[18:10:10] <bstrie> pauls: now, to work around the inability to expand to multiple items, I'm wondering if you know of a way to make a singleton pattern repeat exactly as many times as some other pattern such that `mlet!(x, y, z = 2)` can expand to `let (x,y,z) = (2,2,2);`
[18:10:29] *** Joins: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de)
[18:10:30] <bstrie> pauls: I've already tried putting the repeating pattern inside of a comment on the singleton side, but that doesn't seem to work :P
[18:10:50] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[18:10:50] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143bf6699 to 1469a237e: 02http://git.io/N3iJvQ
[18:10:50] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[18:11:13] <true_droid> tjc: rust is installed in /usr/local/Cellar/rust/0.7 and symlinked into /usr/local/lib, /usr/local/bin and so forth
[18:11:29] <tjc> true_droid: ah ok
[18:11:53] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[18:12:02] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:12:02] *** ChanServ sets mode: +o brson
[18:13:00] <true_droid> tjc: https://gist.github.com/alco/6064521#file-gistfile4-txt-L1
[18:13:13] <true_droid> oops, I might have missed cc
[18:13:14] <kmc> is there a bitset container for Rust? preferably one I can use with my own named enum for bits
[18:13:17] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[18:13:18] <brson> toddaaro: https://mail.mozilla.org/pipermail/rust-dev/2013-May/004127.html
[18:13:20] <tjc> true_droid: yeah, with cc in front
[18:13:20] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Quit: ZNC - http://znc.in)
[18:13:25] <true_droid> cc not found
[18:13:37] <tjc> hmm
[18:13:46] <cmr> kmc: Bitv
[18:14:06] <cmr> kmc: there's an EnumSet that needs to be moved to std/extra in the librustc source somewhere
[18:14:10] <tjc> true_droid: actually, that's probably why
[18:14:24] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:14:28] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[18:14:29] <tjc> but I'm not sure why it's trying to run `cc` when you don't have it
[18:14:43] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[18:14:44] <true_droid> tjc: should I try symlinking it to clang?
[18:14:49] <tjc> Oh, whoops, because it always runs that on Mac OS
[18:14:56] <tjc> true_droid: sure, try it
[18:15:13] <tjc> I'll file a bug on this
[18:17:39] <true_droid> does rust install llvm as part of its build? can't find it
[18:17:56] <bblum> pnkfelix: ah yes, that would be nice; i don't really know how it works
[18:17:59] <bblum> pnkfelix: i'm just a complainer
[18:18:13] <tjc> true_droid: it installs the llvm library, but not clang
[18:18:28] <true_droid> tjc: this is what I get when symlinking cc to my system-wide clang https://gist.github.com/alco/6064521#file-gistfile5-txt-L1
[18:18:35] <pauls> bstrie: hah, neat idea. Too bad the lexer kills the comment before it can work.
[18:18:39] <brson> I'll get a more organized meeting about linked failure together next week. sorry this one sucked
[18:19:01] <tjc> true_droid: I wonder if clang shells out to cc for linking, and then you get the same result
[18:19:02] <bblum> brson: i'll try to have some numbers to look at by then
[18:19:10] <tjc> true_droid: you probably have to install the xcode command-line tools
[18:19:13] <pauls> Maybe macros ought to be able to generate comments for rustdoc_ng anyways ( :
[18:19:20] <graydon> brson: no problem. I think we're all a bit overloaded as usual, and it was good to hear the current state of things.
[18:19:32] *** Joins: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de)
[18:19:41] <pauls> bstrie: You'll probably need a workaround; some kind of recursive macro. Icky, I'm afraid.
[18:19:42] <tjc> true_droid: see the OSX section of https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[18:19:47] <true_droid> tjc: I have them install. I'm using clang no problem for C++ code
[18:19:55] <tjc> true_droid: huh, ok
[18:20:02] <tjc> but `which cc` doesn't give you anything?
[18:20:24] *** Quits: MaikKlein1 (maik@moz-CE64528C.dip0.t-ipconnect.de) (Ping timeout)
[18:21:48] *** Joins: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP)
[18:21:52] *** Joins: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de)
[18:22:22] <bstrie> pauls: amusingly I've worked around it by generating code that looks like `let (x, y, z) = ({ let x = 0; "foo" }, { let y = 0; "foo" }, { let z = 0; "foo" });` but now I get all sorts of unused variable warnings :P
[18:22:36] <bstrie> pauls: does the ident-generator work yet so that I can stick underscores on the front of those?
[18:22:44] <bstrie> actually
[18:22:47] <pauls> bstrie: not that I know.
[18:22:54] <bstrie> maybe I can just do `let _ = x, let _ = y;
[18:22:57] <true_droid> tjc: I agree that's weird, but which -a only shows my symlink. Maybe there is something removed in OS X 10.8 I've only installed it today.
[18:23:13] <true_droid> tjc: hm, I think that might be the problem. Just tried a program without lifetimes and it failed too
[18:23:37] <true_droid> tjc: I though it hung only on that particular program, as I built with Rust yesterday no problem
[18:23:58] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:24:11] <bstrie> pauls: success! all it took was to generate hideous code like `let (x, y, z) = ({ let x = 0; let _ = x; "foo" }, { let y = 0; let _ = y; "foo" }, { let z = 0; let _ = z; "foo" });`
[18:24:18] <true_droid> tjc: yep, this is definitely a 10.8 issue
[18:24:22] <bstrie> huzzah for macro hacks
[18:24:24] <pauls> bstrie: yay!
[18:24:47] <bstrie> we can only hope those get optimized away :P
[18:25:00] <kmc> "For convenience, you can extract the contents of such a [newtype] struct with the dereference (*) unary operator"
[18:25:13] <kmc> hm, does this mean you can't use them to make abstract data, as in Haskell?
[18:25:32] *** Joins: igl (igl@moz-3FC23ABD.adsl.alicedsl.de)
[18:25:34] <true_droid> tjc: when the dev center comes back online, I'll try reinstalling the CLI tools. thanks for assistance
[18:25:36] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[18:25:40] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[18:25:42] <cmr> kmc: yeah (at least I think so)
[18:25:48] <cmr> kmc: you need to use a struct with a private field for that
[18:26:56] <kmc> makes sense
[18:28:00] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:29:41] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Ping timeout)
[18:29:52] <tjc> true_droid: Yeah, I wouldn't be surprised if you have to reinstall the CLI tools after upgrading OSX. Feel free to ask again if you have more issues after reinstalling!
[18:30:43] <tcsc> i'm writing a rust binding for a c++ library. I wrote a wrapper in c for it, but in order for it to link properly, i need to tell rust to link with the c++ standard library for the platform. I'm doing this via --link-args/Makefile, but is there a better way?
[18:31:51] <strcat> tcsc: #[link_args = "-lfoo"] as long as the linking is consistent cross-platform
[18:31:52] <Jeaye> tcsc: http://dpaste.com/1314862/
[18:31:58] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:32:33] <tcsc> strcat: well, i need -lc++ on Darwin and -lstdc++ elsewhere
[18:32:33] <nmatsakis> pcwalton: you never played any with windows, right? I have my windows box up and running and was going to see if I can't finally resolve this issue
[18:32:34] <strcat> Jeaye: I don't think #[nolink] does anything anymore
[18:32:48] <strcat> tcsc: you can't use -lc++
[18:32:55] <nmatsakis> pcwalton: believe it or not, with the boston heat wave, it was literally *too hot* to turn on the desktop last few weeks (the fans just couldn't handle it) :)
[18:33:04] <Jeaye> strcat: ^_^ Ok
[18:33:06] <strcat> tcsc: rust already links against libstdc++, including on OS X
[18:33:25] <Jeaye> nmatsakis: That's insane.
[18:33:44] <strcat> nmatsakis: I think you need AC ;p
[18:33:50] <Jeaye> Or a freezer
[18:34:05] <Jeaye> Put the desktop in the freezer
[18:34:20] <nmatsakis> I confess I did not consider that sol'n
[18:34:33] <strcat> toronto is usually 30C and 70-100% relative humidity in the summer
[18:34:33] <pcwalton> nmatsakis: I haven't tried to solve that issue
[18:34:38] <tcsc> strcat: hm. linking fails without --link-args -lstdc++
[18:34:41] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:34:46] <strcat> I think the whole thing about lakes moderating weather is propaganda spread by lakes
[18:34:47] <pcwalton> I installed windows
[18:34:54] <tcsc> looking for ___cxa_guard_acquire/release
[18:35:14] <kmc> tcsc: I believe the name of the c++ stdlib does vary between platforms :/
[18:35:29] <strcat> tcsc: I don't think you'll want to explicitly link against it at all
[18:35:34] <kmc> in fact clang++ is sometimes used with libc++ and sometimes with GNU's libstdc++
[18:35:36] <strcat> until rust isn't doing it by default
[18:36:07] <tcsc> strcat: yeah, i don't want to link against it
[18:37:00] <tcsc> but as it is, i can't compile unless I do
[18:37:09] <pcwalton> nmatsakis: but only fixed the bug preventing me from landing decopy, not your bug
[18:37:23] <nmatsakis> pcwalton: no worries, building now
[18:37:35] <nmatsakis> or rather, I am investigating now
[18:37:41] <cmr> What bug is this? 6661 again/still?
[18:37:43] <tcsc> could the problem be that it's a static library?
[18:38:34] <strcat> I don't know
[18:38:41] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:38:55] <strcat> on linux every rust binary is already linked against libstdc++, I assumed it was the same way elsewhere
[18:39:11] <strcat> because rust uses some C++ in the runtime and depends on the g++ exception ABI
[18:40:26] <tcsc> i'm on Darwin right now. a related problem i'm having is that #[link_args="-lfoo"] doesnt' work, but --link-args -lfoo does
[18:40:48] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Ping timeout)
[18:40:49] <strcat> I guess it depends on how the platform handles NEEDED vs. included through a dependency
[18:40:51] *** Joins: achim (achim@moz-DB4A378B.pools.arcor-ip.net)
[18:40:52] <tcsc> i also pass -L., as I'm trying to link agains libfoo.a in the same directory
[18:42:29] *** Quits: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de) (Quit: mellum)
[18:43:29] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[18:43:53] <nmatsakis> the windows make commands are so ... cumbersome
[18:44:10] *** Joins: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de)
[18:44:22] <cmr> Has anyone played with runtime plugins via the dynamic linker yet? I'm going to be doing so with rustdoc shortly, would like to see any prior work.
[18:44:28] <strcat> nmatsakis: is there any chance of having stack closures as something separate from &fn, so you could pass them by-value (as a move)?
[18:44:30] <tcsc> ah, actually, scratch that last problem, i had #[link_args] on the mod foo {} not the extern {}
[18:44:35] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:44:37] <kmc> default for module-level items is pub or priv?
[18:44:40] <nmatsakis> strcat: that's essentially the plan
[18:44:44] <cmr> kmc: priv
[18:44:48] <kmc> thanks
[18:44:49] <nmatsakis> strcat: afaik the plan of record is still to have the closure type be fn(), 
[18:44:56] *** Quits: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de) (Ping timeout)
[18:45:03] <nmatsakis> strcat: and then move any code using ~fn and @fn to object types
[18:46:07] <strcat> nmatsakis: or to a closure in a @/~ box I guess
[18:46:42] <bblum> brson: didn't the runtime used to crash when you finished with leaked memory in the exchange heap?
[18:46:54] <bblum> it seems i now have to use valgrind to find such bugs
[18:47:58] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:48:24] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[18:48:58] <strcat> bblum: I removed the counter with the justification being you can use valgrind, and we have valgrind buildbots now
[18:49:10] <bblum> strcat: um, i see
[18:49:35] <strcat> bblum: it was a 5-15% perf hit for malloc, and made it so you couldn't mix it with FFI
[18:49:46] * bblum nods
[18:49:51] <strcat> the small allocation code path is free of any locks/atomics
[18:50:04] <strcat> the most expensive part is our FFI overhead
[18:50:08] <strcat> (now)
[18:50:11] <bblum> presumably it still writes to contended cachelines though
[18:50:32] <strcat> bblum: well it uses thread-local arenas so if you aren't sending ~ it won't be
[18:50:40] <bblum> oh right
[18:50:46] <bblum> what's the best case for ~ look like?
[18:51:16] <strcat> bblum: well, it's better with jemalloc than the platform allocators
[18:51:19] <toddaaro> bblum: gist.github.com/toddaaro/6065065
[18:51:37] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[18:51:42] <strcat> and we aren't using jemalloc atm
[18:51:53] <strcat> glibc does the same thread-local arena strategy but they have locks on large allocations
[18:52:17] *** Quits: tcsc (tcsc@moz-7246F5CD.hsd1.ma.comcast.net) (Quit: computer sleeping)
[18:52:35] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[18:53:35] <bblum> strcat: do these allocators allocate new arenas each time a thread is spawned?
[18:53:45] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:53:45] <strcat> bblum: yes but at a certain point they start reusing arenas
[18:54:07] <strcat> you can override that though
[18:54:11] <bblum> oh so it heuristically buffers/recycles them or something
[18:55:25] <strcat> bblum: jemalloc uses thread-local caching for all allocations under 4MiB
[18:55:32] <bblum> brson: hmm, what do you think of making all the UnsafeArc functions not-unsafe? (because they return unsafe pointers, and the worst that happens with 'unwrap' is you fail or deadlock)
[18:55:38] <strcat> ones under 4K are considered small and it packs them tightly in arenas specific to the size
[18:55:42] <strcat> size class*
[18:56:15] <strcat> and they have an upper bound on fragmentation for small allocations (20-30% iirc?), + only 1-2% metadata overhead
[18:56:20] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[18:56:33] <strcat> for ones over 4MiB I think it just directly calls mmap
[18:56:51] <strcat> so that's still not a global lock - the kernel has fine-grained-ish locking for that
[18:57:16] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[18:57:38] <strcat> bblum: anyway I think small allocs should be 20-30ns but they're much slower atm :(
[18:57:41] <strcat> FFI overhead is painful
[18:57:53] *** Joins: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net)
[18:58:21] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Client exited)
[18:58:27] <steven_is_false> Hi! I while back I was working on a library for GADTs (basically this https://gist.github.com/sstewartgallus/5605948 but a bit improved now) and I was wondering what I should name the type?
[18:58:39] <steven_is_false> What should I name what is now Is<S, T>?
[18:58:43] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[18:58:45] <toddaaro> bblum: any ideas on the stack trace? it looks like drop on the kill handle is crashing in something with UnsafeAtomicRcBox
[19:00:05] <kimundi> Are any plans for/against adding visiblity modifiers to tuple and newtype structs? Anybody against me opening an issue?
[19:00:08] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[19:00:22] <cmr> kimundi: so like struct Foo(priv T, U) ?
[19:00:27] <kimundi> yes
[19:00:52] <kimundi> well
[19:01:11] <brson> bblum: agreed. not unsafe
[19:01:38] *** Joins: stoyan|home (stoyan.dim@38CC1780.107BD12.66DD6767.IP)
[19:01:39] <kimundi> seeing it written like this I noticed that priv could only work on newtype structs
[19:01:48] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[19:02:15] <kimundi> because you can only access the fields with pattern matching... and that does't work if some are private
[19:02:38] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[19:02:40] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[19:03:12] <kimundi> well, it could still work if all are private.
[19:03:24] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[19:03:33] <kimundi> Gonna open an issue...
[19:03:43] *** Quits: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Ping timeout)
[19:03:51] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[19:05:21] <strcat> kimundi: there are ways we could allow accessing fields without pattern-matching
[19:05:27] <strcat> x[const_expr_index]
[19:07:23] *** Joins: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net)
[19:07:52] <sully> ok, after having completely revamped how calls to supertrait methods from a default method work
[19:08:02] <sully> I now need to figure out whether this actually fixes any bugs
[19:08:14] <nmatsakis> kimundi: there was an issue, I believe we agreed it was not worth the effort.
[19:08:22] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:08:32] <sully> I am eliminating method_self and method_super
[19:08:36] <sully> and merging it all into method_param
[19:08:39] <nmatsakis> sully: horray!
[19:08:54] <sully> (also eliminating the vtable_self that I added a month or so ago)
[19:09:57] <cmr> Can a ~[~str] be auto-borrowed to &[&str]? Or generically ~[~T] to &[&T]?
[19:10:12] <nmatsakis> cmr: No.
[19:10:12] *** tikue is now known as benbouvier
[19:10:12] <cmr> Meh, I want iterators here, not vectors, nvm
[19:10:22] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Quit: ecr)
[19:10:39] <nmatsakis> cmr: well, at least it doesn't now, and it'd require some deeper changes to make it work
[19:10:55] <strcat> cmr: Iterator + DoubleEndedIterator + RandomAccessIterator should fit any use case where you'd want that
[19:11:06] <strcat> once they're done at least ;p
[19:11:11] <bblum> eatkinson: impl <T: Trait> Struct<T> { .... } 
[19:11:32] *** Quits: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP) (Quit: lkuper)
[19:12:07] *** Quits: bugweiser (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:12:34] <bblum> eatkinson: impl <T: Clone> Option<T> { fn get_clone(&self) -> T { match self { &Some(ref x) => x.clone(), None => fail!() } } }
[19:12:43] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[19:13:18] *** benbouvier is now known as tikue
[19:14:18] *** Joins: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch)
[19:14:35] *** Quits: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net) (Ping timeout)
[19:14:41] *** Quits: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch) (Client exited)
[19:15:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:16:42] *** Quits: int3_ (int3_@moz-921A965B.hsd1.ca.comcast.net) (Client exited)
[19:16:50] *** sam113101 is now known as sam113101_afk
[19:17:50] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[19:18:03] *** Quits: achim (achim@moz-DB4A378B.pools.arcor-ip.net) (Quit: Computer has gone to sleep.)
[19:18:49] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[19:19:17] *** Parts: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Leaving)
[19:19:25] *** sam113101_afk is now known as sam113101
[19:20:34] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[19:21:57] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[19:22:27] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[19:23:53] *** Quits: qmx (qmx@moz-D6C3C2E6.qmx.me) (Ping timeout)
[19:24:52] *** Joins: qmx (qmx@moz-D6C3C2E6.qmx.me)
[19:25:07] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Connection timed out)
[19:25:47] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:26:05] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:26:11] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[19:26:21] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:26:40] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:27:54] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:28:06] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:28:10] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[19:28:22] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:28:24] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:28:31] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:29:16] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:29:34] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:30:42] *** Joins: achim (achim@moz-DB4A378B.pools.arcor-ip.net)
[19:30:54] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:31:13] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Max SendQ exceeded)
[19:31:42] *** Joins: int3_ (int3_@moz-7B0110AD.mv.mozilla.com)
[19:32:08] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[19:32:12] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Quit: Leaving.)
[19:32:53] <tikue> rusti: struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b;
[19:32:57] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/PGRd
[19:33:15] <bblum> you should be able to cast::forget a POD without leaking memory, right?
[19:33:20] <tikue> rusti: struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b; a += 1;
[19:33:21] -rusti- <anon>:7:116: 7:122 error: binary operation + cannot be applied to type `&mut uint`
[19:33:22] -rusti- <anon>:7          struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b; a += 1;
[19:33:22] -rusti-                                                                                                                              ^~~~~~
[19:33:22] -rusti- error: aborting due to previous error
[19:33:23] -rusti- application terminated with error code 101
[19:33:31] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:33:34] *** Quits: stoyan|home (stoyan.dim@38CC1780.107BD12.66DD6767.IP) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[19:33:50] <tikue> rusti: struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b; *a = 1;
[19:33:53] -rusti- <anon>:7:100: 7:101 warning: unused variable: `b` [-W unused-variable (default)]
[19:33:53] -rusti- <anon>:7          struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b; *a = 1;
[19:33:53] -rusti-                                                                                                              ^
[19:33:53] -rusti- ()
[19:34:02] <tikue> rusti: struct Foo { a: uint, b: uint }; let mut foo = Foo { a: 0, b: 0 }; let a = &mut foo.a; let b = &mut foo.b; *a = 1; *b = 1;
[19:34:07] -rusti- ()
[19:34:20] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:34:29] *** Joins: stoyan|home (stoyan.dim@38CC1780.107BD12.66DD6767.IP)
[19:34:38] *** Joins: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net)
[19:34:39] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:35:10] *** Quits: zxcdw (r-a@858B320D.B543C4DE.3933CC16.IP) (Ping timeout)
[19:35:26] *** Joins: tcsc (tcsc@moz-7246F5CD.hsd1.ma.comcast.net)
[19:35:33] <kmc> i have a macro question, which boils down to: in an example like http://static.rust-lang.org/doc/0.7/tutorial-macros.html#multiplicity , if x were a syntax variable $x instead, how would you arrange for $x to repeat in each case while $sp iterates
[19:38:01] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[19:38:45] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[19:40:19] * pcwalton is reading about "lift"
[19:40:22] <pcwalton> in Template Haskell
[19:40:30] <pcwalton> I think that may be the magic ingredient we need to make our macro system support CTFE
[19:40:38] <pcwalton> D-style
[19:40:44] <kmc> what's CTFE?
[19:40:50] <pcwalton> compile time function evaluation
[19:42:30] <kmc> well TH is completely based around executing Haskell code at compile time
[19:42:38] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[19:42:39] *** Quits: RMF (RMF@moz-348663EF.dsl.telepac.pt) (Ping timeout)
[19:42:56] <kmc> 'lift' just turns a value (evaluated at compile time) into literal syntax for that value
[19:43:15] <kmc> so I don't really see it as a magic ingredient, but it is useful
[19:43:59] <bblum> pcwalton: hey, do you know how cast::forget works?
[19:44:11] <bblum> pcwalton: i have an odd memory leak resulting from using it on something that should be a POD...
[19:44:24] *** Parts: stoyan|home (stoyan.dim@38CC1780.107BD12.66DD6767.IP) ()
[19:45:12] *** Joins: joey (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP)
[19:45:15] *** Joins: zxcdw (r-a@858B320D.B543C4DE.3933CC16.IP)
[19:45:55] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:46:10] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:46:36] <pauls> kmc: so, like a cross-product instead of iterating in lockstep?
[19:48:44] <sully> oh no
[19:48:58] <kmc> that would do... one of them is only bound once
[19:49:14] <sully> I I fixed a bug and now things are failing in the borrow checker
[19:51:28] <pauls> kmc: oh, if you have (e.g.) $x := <1, 2, 3> while $y := 4, then `$( $x , $y );*` becomes `1,4 ; 2,4 ; 3,4`
[19:51:50] <pauls> You can throw in as many singletons as you like.
[19:52:31] <kmc> hm, well, that's not the behavior I'm seeing â€” I'll have a concrete example in a sec
[19:52:41] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[19:53:09] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:53:26] <sully> hm, actually, it fails with a borrow check error even without my fix
[19:53:42] *** Quits: eholk (eholk@moz-192536EB.uconnect.utah.edu) (Ping timeout)
[19:54:11] <kmc> pauls: http://pastebin.mozilla.org/2695406
[19:54:40] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[19:56:31] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:56:51] <pauls> kmc: Hm, it looks correct at first glance. I shall meditate on it, and take a keyboard break, as my computer is asking me to.
[19:57:25] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:58:16] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[19:58:19] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[20:00:05] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[20:00:55] *** Joins: eholk (eholk@moz-192536EB.uconnect.utah.edu)
[20:01:12] <kimundi> where do I find the mosr up to date borrowed pointer tutorial?
[20:01:32] <cmr> http://static.rust-lang.org/doc/tutorial-borrowed-ptr.html should always be up to date, unless the doc builder is broken.
[20:01:53] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[20:02:10] <pauls> kmc: http://pastebin.mozilla.org/2695438
[20:02:42] <kimundi> thx
[20:03:22] <pauls> You hit a trap regarding macros that expand into blocks... they need curly braces inside the grouping delimiters...
[20:03:23] <kmc> pauls: strange, do you know why that's needed?
[20:03:39] <kmc> hmm
[20:04:05] <pauls> ...but you don't get an error if there's leftover, unparsed bits at the end.
[20:04:26] <pauls> kmc: I forget why, and I wrote the code ) :
[20:04:28] <kmc> at the end of the LHS pattern?
[20:04:33] <Crnobog> is there an assertf macro or an assert macro I can use fmt! with?
[20:04:55] <cmr> Crnobog: assert!(expr, fmt!(...)) should work
[20:04:56] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Quit: jclements)
[20:04:57] <vladimir-lu> ah is there no has_next() on iterators in general?
[20:05:01] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[20:05:21] <pauls> kmc: at the end of the RHS - it seems like expansion is producing the right thing, but then the parsing of the result just stops when it's satisfied. This even should really get an error message.
[20:05:21] <cmr> vladimir-lu: no
[20:05:34] <kmc> strange
[20:05:35] <Crnobog> ah it seems I can do assert!(false, format, ...)
[20:05:42] <kmc> well, it works now, thanks for your help!
[20:05:46] <cmr> Crnobog: oh, nice, didn't know you could do that :)
[20:05:59] <bstrie> does scala have the same sort of type inference as rust?
[20:06:06] <bstrie> or does scala have C++-style type inference
[20:06:06] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[20:06:14] *** Joins: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP)
[20:06:32] <bstrie> hm, maybe I should ask in a scala channel :P
[20:06:36] <pauls> kmc: thanks for reporting the problem. I'm gonna file a bug, if we don't have one for this.
[20:06:41] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[20:06:46] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[20:06:47] <vladimir-lu> bstrie: rust seems similar to scala
[20:06:58] <vladimir-lu> bstrie: what do you mean by *same*?
[20:07:03] <Crnobog> also does anyone know if there's an arg I can pass to make check to run unit tests only?
[20:07:19] <vladimir-lu> rust test crate.rs
[20:07:22] <kmc> Scala type system is very complicated, it tries to do H-M inference but also deal with all the subtyping inherited from Java
[20:07:30] *** Joins: Jesin (Jessin_@moz-1B1307FF.eecs.lehigh.edu)
[20:07:37] <kmc> I don't know the details but Rust's type system seems much simpler; there's almost no subtyping
[20:07:54] <vladimir-lu> yeah, and we don't have implicits to worry about
[20:08:15] *** Quits: achim (achim@moz-DB4A378B.pools.arcor-ip.net) (Quit: Computer has gone to sleep.)
[20:09:36] <cmr> graydon: ping
[20:10:48] <bstrie> kmc: I hear that we also do hindley-milner but with a few extensions
[20:11:29] <bstrie> vladimir-lu kmc: do either of you know if hindley-milner also describes languages with whole-program type inference like ML?
[20:12:04] * vladimir-lu looks at a copy of TAPL
[20:12:57] <strcat> bstrie: I don't think it really matters
[20:13:08] <strcat> you could consider the top-level functions to all be nested in another
[20:13:20] <bstrie> ok
[20:13:29] <strcat> rust's limitation on inference is an artificial one afaik
[20:13:37] <vladimir-lu> actually it doesn't matter for another reason
[20:13:39] <strcat> although.... methods don't lend themselves well to that kind of inference
[20:13:45] <vladimir-lu> https://michid.wordpress.com/2010/01/29/scala-type-level-encoding-of-the-ski-calculus/
[20:13:50] <bstrie> I wasn't sure if it was accurate to describe all type inference algorithms as either "C++-style" or "HM"
[20:14:04] <strcat> in haskell if you have 'foo a b', you know 'foo' requires a specific type class
[20:14:08] <kmc> I'm not sure... I think it matters where you put the boundaries of "any remaining unification variables here become universally quantified"
[20:14:09] <vladimir-lu> not sure if the turing-completeness was verified formally, but the above is an attempt at proving scala's type inference is turing complete
[20:14:16] <kmc> but I'm pretty fuzzy about this stuff
[20:14:17] <strcat> in rust... a.foo(&b), could be more than one
[20:14:19] <vladimir-lu> bstrie: it's not
[20:14:32] <vladimir-lu> i mean in scala you can encode System F, you have existentials
[20:14:46] <strcat> bstrie: C++ is *very* different than a language like java or c
[20:16:17] <vladimir-lu> so my final answer is that scala's type system is based on System F (an extension of H-M), may be turing complete so goes way beyond rust's 
[20:16:23] <kmc> in Haskell you break top-level definitions into connected components and then do inference for each component separately
[20:16:25] <strcat> templated functions have their types inferred and that process is pretty powerful
[20:16:28] <bstrie> vladimir-lu: ok, thanks :)
[20:16:56] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[20:16:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/qdX2Kg
[20:16:56] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[20:16:59] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[20:17:01] <strcat> since it essentially recursively pattern matches on the types
[20:17:03] <kmc> I wouldn't call System F an extension of H-M.  the types produced by H-M are a subset of the types expressible in System F, but System F doesn't say anything about inference
[20:17:16] <vladimir-lu> yeah, you're right
[20:17:36] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[20:17:38] <vladimir-lu> that is a much better way to say it since System F is not a type-inference algorithm
[20:17:39] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[20:19:36] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[20:20:00] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[20:20:00] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/ZO0zEA
[20:20:00] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[20:20:01] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:20:01] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/D0_ZFA
[20:20:01] <ghrust> 13rust/06auto 1449014c8 15zslayton: Exposed previously hidden 'use' statements in the tutorial's sample code.
[20:20:01] <ghrust> 13rust/06auto 14e029c2d 15bors: auto merge of #7954 : zslayton/rust/master, r=huonw...
[20:20:01] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:22:23] *** Quits: dherman (dherman@A4E26FA6.5E7911EA.DA40C4B3.IP) (Quit: dherman)
[20:23:15] *** Quits: Ms2ger (Ms2ger@E699BE68.4A4AF98A.F15B0BB3.IP) (Quit: nn)
[20:23:29] <eatkinson> is it possible to bound a generic trait? e.g. trait MyTrait<T:MyOtherTrait> { â€¦ }
[20:24:29] <strcat> eatkinson: yes
[20:24:31] *** Joins: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP)
[20:24:55] <eatkinson> strcat: awesome thanks
[20:25:02] <strcat> it might not be implemented completely atm though
[20:29:47] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[20:31:39] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[20:32:15] <cmr> r? https://github.com/mozilla/rust/pull/8009
[20:32:18] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[20:34:25] *** sam113101 is now known as sam113101_afk
[20:34:31] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[20:36:01] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[20:36:33] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[20:37:25] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[20:38:48] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[20:38:51] <quasisphere> is it intended that I need to specify "extern mod std;" on top of a file that I'm loading from another file?
[20:39:22] <bstrie> quasisphere: you should never need that afaik...
[20:39:33] <bstrie> unless I am horribly mistaken
[20:39:39] <cmr> No, you shouldn't.
[20:39:53] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>; } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:39:55] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/LBjK
[20:40:06] <bstrie> quasisphere: what version of rust?
[20:40:29] <quasisphere> bstrie: should be quite recent (from git), haven't updated today, though
[20:40:33] <vladimir-lu> i assume i need to change how i'm borrowing the strings in the iterator
[20:40:38] <bstrie> quasisphere: as long as it isn't from march :)
[20:40:49] <quasisphere> no :)
[20:41:01] <bstrie> though it's possible you're in the arctic, and yesterday was december
[20:41:15] *** Quits: jfbk (textual@moz-EEA9CFB3.nyc.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[20:41:33] <bstrie> quasisphere: what do you mean "loading from another file"?
[20:41:54] <strcat> vladimir-lu: next() uses &mut self
[20:41:57] <strcat> that's why it's unhappy
[20:42:00] <bstrie> are you doing something super weird, like reading in a rust file and trying to manually feed it to the compiler?
[20:42:05] <bstrie> or are you just importing a module?
[20:42:08] <strcat> vladimir-lu: your 'iter' binding is immutable there
[20:42:12] <strcat> vladimir-lu: just do 'let mut iter = iter'
[20:42:25] <strcat> not sure if 'mut' works alone in patterns yet, probably no
[20:42:31] <quasisphere> bstrie: I just made this small crate consisting of two files: euler.rc and numbers.rs. In euler.rc I have specified "mod numbers;". I try to compile euler.rc with rustc --lib euler.rc, which fails when it tries to compile numbers.rs, unless I add "extern mod std;" to the top of numbers.rs.
[20:43:00] <bstrie> weird
[20:43:07] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[20:43:10] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[20:43:15] <strcat> quasisphere: what about 'use std;'
[20:43:23] <vladimir-lu> strcat: ah i didn't notice it in the docs
[20:43:24] <bstrie> quasisphere: we don't use .rc anymore, though changing to .rs shouldn't solve that problem
[20:43:41] <strcat> vladimir-lu: the next method you mean?
[20:43:46] <strcat> vladimir-lu: there's an iterator tutorial now
[20:43:49] <vladimir-lu> strcat: yep
[20:43:54] <quasisphere> strcat: seems to work as well
[20:44:06] <strcat> http://static.rust-lang.org/doc/tutorial-container.html#iterators
[20:44:13] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[20:44:25] *** Quits: nyx (nyx114@moz-86F96554.com) (NickServ (GHOST command used by cedalion))
[20:44:36] *** Joins: nyx114 (nyx114@337D90A6.170C4318.709ED47B.IP)
[20:44:59] *** Joins: nyx (cedalion@moz-FC228802.wp.shawcable.net)
[20:46:05] <quasisphere> bstrie: ah, thanks for the info. In fact I migrated to using rustpkg in between (thinking it might know how to build it better, it didn't), so now it is lib.rs :P
[20:46:13] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Quit: Leaving.)
[20:46:23] *** Joins: ecr (Thunderbir@moz-19C7F72B.uoregon.edu)
[20:46:27] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:46:27] *** ChanServ sets mode: +o tjc
[20:46:36] <bstrie> pcwalton: I have to question that life choices that brought you to using the G-word in a thread on go :P
[20:48:13] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[20:48:31] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>; } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:48:33] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/GJGU
[20:48:53] <vladimir-lu> loving the FooBar(&'self mut HashMapIterator<'self, ~str, ~str>)
[20:50:31] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[20:51:43] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>; bar(hm.iter()); } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:51:44] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/IWBA
[20:52:43] *** Joins: robertknight_ (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com)
[20:53:06] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>; bar(FooBar(hm.iter())); } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:53:07] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/UCFg
[20:53:29] <vladimir-lu> which version of rusti is this?
[20:54:08] *** Quits: lkuper (lkuper@5188CCE.A402E718.C082B7DC.IP) (Quit: lkuper)
[20:55:21] <cmr> rusti: std::run::run_program("rustc", [~"--version"])
[20:55:22] -rusti- <anon>:7:9: 7:30 error: unresolved name `std::run::run_program`.
[20:55:22] -rusti- <anon>:7          std::run::run_program("rustc", [~"--version"])
[20:55:22] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~
[20:55:22] -rusti- error: aborting due to previous error
[20:55:22] -rusti- application terminated with error code 101
[20:55:44] <cmr> rusti: std::run::process_output("rustc", [~"--version"])
[20:55:45] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/jcjO
[20:56:03] <cmr> rusti: std::str::from_bytes(std::run::process_output("rustc", [~"--version"]).output)
[20:56:04] -rusti- ~"rustc 0.8-pre (2f7d86f 2013-07-22 12:01:41 -0700)\nhost: x86_64-unknown-linux-gnu\n"
[20:56:23] <vladimir-lu> hmnn then why does it reject my iter() method?
[20:56:24] *** Quits: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net) (Ping timeout)
[20:56:55] <vladimir-lu> anyway i found the issue was at the call site - it can't mutably borrow an iterator if it's inside a function invocation 2 levels deep
[20:56:59] <vladimir-lu> you need a temp variable
[20:57:08] <cmr> vladimir-lu: you didn't apply HashMap::new
[20:57:12] *** Quits: robertknight_ (robertknig@moz-AB0E96D7.range86-162.btcentralplus.com) (Ping timeout)
[20:57:18] *** Joins: dherman (dherman@A4E26FA6.5E7911EA.DA40C4B3.IP)
[20:57:19] *** ChanServ sets mode: +o dherman
[20:57:32] <strcat> vladimir-lu: it's just rustc
[20:58:11] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>(); bar(FooBar(hm.iter())); } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:58:13] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/dOFD
[20:58:15] <vladimir-lu> interesting
[20:58:37] <vladimir-lu> use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>(); bar(FooBar(&mut hm.iter())); } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:58:40] <vladimir-lu> rusti: use std::hashmap::{HashMapIterator, HashMap}; enum Opt<'self> { FooBar(&'self mut HashMapIterator<'self, ~str, ~str>) } fn foo() { let hm = HashMap::new::<~str, ~str>(); bar(FooBar(&mut hm.iter())); } fn bar<'a>(opt: Opt<'a>) { match opt { FooBar(iter) => { let a = iter.next(); } } }
[20:58:41] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/GRCN
[20:58:50] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Ping timeout)
[20:58:58] *** Quits: joone (joone@moz-1C0E78E8.fm.intel.com) (Quit: Ex-Chat)
[20:59:01] <vladimir-lu> good (same error i got)
[20:59:01] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:00:19] *** Joins: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:00:19] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[21:00:38] <vladimir-lu> next question - is that behaviour ever going to change?
[21:01:08] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:01:42] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("ps", [~"ax"]).output))
[21:01:42] -rusti-   PID TTY      STAT   TIME COMMAND
[21:01:42] -rusti-     1 ?        Ssl    0:00 ./out
[21:01:43] -rusti-    13 ?        R      0:00 ps ax
[21:01:43] -rusti- ()
[21:01:52] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("rustc", [~"--version"]).output))
[21:01:53] -rusti- rustc 0.8-pre (2f7d86f 2013-07-22 12:01:41 -0700)
[21:01:53] -rusti- host: x86_64-unknown-linux-gnu
[21:01:53] -rusti- ()
[21:02:02] *** Quits: mschifer1 (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:02:04] *** Joins: lkuper (lkuper@EA56C73C.A402E718.C082B7DC.IP)
[21:02:15] *** Quits: lkuper (lkuper@EA56C73C.A402E718.C082B7DC.IP) (Quit: lkuper)
[21:02:16] *** Joins: lkuper (lkuper@EA56C73C.A402E718.C082B7DC.IP)
[21:02:23] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[21:02:28] *** Joins: joone (joone@moz-C50DC051.jf.intel.com)
[21:02:49] <cmr> rusti: fn broken(v: &'r [u8], i: uint, j: uint) -> &'r [u8] { v.slice(i, j) }
[21:02:50] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/TCZH
[21:02:59] <cmr> rusti: fn broken<'r>(v: &'r [u8], i: uint, j: uint) -> &'r [u8] { v.slice(i, j) }
[21:03:00] -rusti- ()
[21:04:14] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Ping timeout)
[21:05:30] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[21:07:33] *** cade is now known as cade_brb
[21:08:21] *** Quits: mark_edward (quassel@moz-4A5B1251.wisolt4.epbfi.com) (Ping timeout)
[21:11:59] <bblum> man
[21:12:05] <bblum> "fn foo() unsafe {" was so bad
[21:12:10] <bblum> but at least it avoided rightward drift
[21:12:20] *** Joins: doomlord_ (servitor@moz-13E69BC8.range86-180.btcentralplus.com)
[21:13:32] <strcat> bblum: I think it's fine if writing unsafe blocks is a bit ugly ;p
[21:13:44] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:13:45] *** cade_brb is now known as cade
[21:14:17] <doomlord_> r.e. unsafe blocks i was a little surprised  to find that type 't' in the compiler :)
[21:14:31] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[21:14:49] <graydon> pcwalton: am I correct in thinking that for each_path() to go away, we'd need to revise how resolve works to have some kind of a lazy path element?
[21:14:51] *** sam113101_afk is now known as sam113101
[21:15:29] <strcat> graydon: https://github.com/mozilla/rust/pull/7982 r? just the last 2 commits adding to the tutorial
[21:15:34] <strcat> (first is already r+'ed)
[21:17:30] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:20:06] *** Joins: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch)
[21:21:49] *** Joins: jviereck1 (Adium@moz-A034D4DA.dclient.hispeed.ch)
[21:21:56] *** Quits: jviereck1 (Adium@moz-A034D4DA.dclient.hispeed.ch) (Client exited)
[21:22:37] *** Quits: jviereck (Adium@moz-A034D4DA.dclient.hispeed.ch) (Ping timeout)
[21:22:40] *** Joins: mark_edward (quassel@moz-4A9A2F15.dynamic.utc.edu)
[21:22:45] <strcat> graydon: heh I did something weird making the hash change, just added r=graydon
[21:22:53] <graydon> ok
[21:23:05] <strcat> I guess if you amend and don't do anything it still changes the hash
[21:23:13] <strcat> commit time maybe
[21:23:30] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:24:00] <mark_edward> strcat: what does a vistor do?
[21:24:16] <strcat> a TyVisitor?
[21:24:25] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Ping timeout)
[21:24:31] <kemurphy> r? https://github.com/mozilla/rust/pull/7958 now that it has a test?
[21:26:47] <vladimir-lu> kemurphy: nice, are you planning to do anything with it?
[21:26:58] <strcat> mark_edward: you mean visitor?
[21:27:07] <mark_edward> strcat: yes
[21:27:31] <strcat> the TyVisitor thing lets you walk a type recursively
[21:27:41] <strcat> it's how %? in fmt! works, the implementation is in std::repr
[21:27:54] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Textual IRC Client: www.textualapp.com)
[21:28:31] <strcat> same pattern is used inside the compiler for other things though
[21:28:59] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[21:29:13] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:29:14] <strcat> it's somewhat bad that we allow it in safe code because it lets you walk private fields
[21:30:27] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[21:32:37] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:33:25] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[21:33:39] <bstrie> pcwalton: re: `unsafe extern`, I'd say forbid the unsafe. otherwise you run the risk of people thinking there's an actual difference between `unsafe extern` and `extern`
[21:33:43] <sfackler> is the reflection api going to eventually end up with functionality comparable to java's or go's?
[21:34:04] *** Joins: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net)
[21:35:57] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:38:04] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Quit: I haz left.)
[21:38:10] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[21:38:14] *** Joins: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net)
[21:38:49] *** Quits: themgt (themgt@moz-7834B2B9.cm.vtr.net) (Ping timeout)
[21:38:49] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:39:04] <strcat> sfackler: probably but most of it will have to be `unsafe`
[21:39:23] <strcat> fmt!("%?", x) technically should be, but we don't have a trait-based replacement yet
[21:40:04] <strcat> if you just wanted something like the type name or walking *public* fields I don't think there's any reason it couldn't be safe
[21:40:44] *** Joins: Ralith (ralith@moz-B73562C8.wireless.sfu.ca)
[21:41:28] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[21:42:05] <sfackler> i think you'd be okay with a safe API for method calls too if the implementation checked everything properly
[21:42:58] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:45:17] *** Quits: Ralith (ralith@moz-B73562C8.wireless.sfu.ca) (Ping timeout)
[21:45:56] <kmc> strcat: well even giving the type name will break the parametricity guarantees you get on polymorphic functions
[21:46:18] <strcat> kmc: it could be trait-based though
[21:46:21] <kmc> the type of 'map' is so generic that you already know from the type a lot of things it can't do
[21:46:24] <kmc> yeah
[21:46:30] <kmc> also I bet there are other ways to break parametricity in Rust currently
[21:46:32] <strcat> TypeName trait, automatically implemented for anything
[21:46:43] <strcat> kmc: well you know stuff like the size already
[21:46:46] <strcat> size_of, align_of
[21:47:04] <kmc> yeah
[21:47:11] <sfackler> kmc: what kind of parametricity guarantees?
[21:47:24] <strcat> kmc: but that's essentially because everything has a Sized bound implicitly atm
[21:47:32] <strcat> since we don't have dynamically sized types (yet)
[21:47:42] <kmc> you can get the raw address from a borrowed pointer regardless of the type of what it points to
[21:47:57] <vladimir-lu> yeah but you can't dereference it
[21:48:13] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:48:13] <kmc> sure but it still means that type variables aren't totally opaque
[21:48:21] <strcat> kmc: true but that's a pretty arbitrary number
[21:48:31] <kmc> still, totally reasonable and probably necessary in a language like Rust
[21:48:37] <strcat> you could make guesses about the alignment based on it
[21:48:47] <vladimir-lu> yeah, but there's nowhere that it stores its info
[21:48:50] <pauls> kmc: https://github.com/mozilla/rust/issues/8012
[21:48:52] <tjc> I don't think strict languages can have parametricity in the first place
[21:50:04] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[21:51:06] <kmc> sfackler: well given the generic Haskell function map :: (a -> b) -> [a] -> [b], since a,b are unbounded type variables, you know that 'map' won't be able to make up arbitrary 'b's, it can only get them by calling your function, and it can't inspect the 'a's and do something tricky based on their structure
[21:51:57] <kmc> in most languages this breaks due to some kind of global operation available on all values, e.g. reflection, or the methods of Object in Java
[21:52:01] <kmc> tjc: why not?
[21:52:03] <strcat> you would know that in rust too, as long as you're assuming no unsafe prefixed things in haskell or unsafe {} in rust
[21:52:08] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[21:52:13] <strcat> size/align/address aren't that much of a leak
[21:52:23] <kmc> pauls: thanks!
[21:52:24] <kmc> sure
[21:52:31] <strcat> well also pretending %? and reflection like that was unsafe
[21:52:35] <pauls> kmc: no problem!
[21:52:38] <tjc> kmc: parametricity relies on not being able to distinguish between lambda(x)._|_ and _|_
[21:52:40] <tjc> something like that
[21:53:03] <kmc> I don't know, maybe there's something stronger meant by "parametricity" that I'm not aware of
[21:53:07] <strcat> kmc: atm you can use fmt!("%?", x) on *anything* ;p
[21:53:17] <kmc> I think the reasoning about re: map holds just as well in a strict language
[21:53:21] <kmc> above*
[21:53:22] <strcat> it'll let you walk into private fields, private types, etc.
[21:53:26] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:53:35] <graydon> strcat: visibility is not a security system
[21:53:39] <kmc> even in Haskell you can do some things; you can force evaluation of a thunk without knowing its type, which could raise an exception too
[21:53:50] <strcat> graydon: not for security, but because priv fields aren't necessarily valid objects of the type they claim
[21:54:00] <kmc> in Haskell 1.4 the ability to force evaluation was in a typeclass but it's gone now
[21:54:02] <strcat> you could have a dangling & or something along those lines
[21:54:13] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[21:54:15] <graydon> yeah, it should at least tell you when you're walking into priv
[21:54:31] <graydon> but plenty of reasonable uses of reflection are supposed to ignore visibility
[21:54:53] <strcat> graydon: maybe, but it means all types always have to have valid objects in their fields
[21:54:59] <strcat> and I don't think that's true for all our types
[21:54:59] <kmc> don't remember why they made that change to Haskell
[21:55:03] <graydon> the type visitor was done a long time ago, could use a lot of cleanup
[21:55:03] <kmc> 1.4 was better in a lot of ways </hipster>
[21:55:37] <graydon> strcat: which bits wouldn't be? unsafe pointers, locked @, what else?
[21:55:40] <strcat> DVec used to store null in a ~[] field
[21:55:43] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:56:02] <kmc> graydon: do you see "unsafe" as purely a boundary between code that's trusted / untrusted in a security sense, or also as a way to discourage other behaviors that don't violate memory safety etc.
[21:56:02] <strcat> graydon: just unsafe usage of types, based on the assumption that the implementation doesn't currently care and the field is private
[21:56:23] <strcat> like, swapping something out with init()
[21:56:37] <strcat> because currently there's a drop flag, so it will still be safe during a failure
[21:56:51] <graydon> kmc: the latter. the language had a number of things in it initially designed to make it slightly-more-awkward to do bad things, and easy to prohibit them or make them visible to a project auditor.
[21:56:56] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:57:02] *** Joins: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP)
[21:57:05] <graydon> it still does. unsafe is one of those. mut also.
[21:57:11] <kmc> yeah
[21:57:30] <strcat> graydon: it doesn't recurse through * by default so that's fine
[21:57:38] <strcat> repr I mean
[21:57:45] <kmc> "unsafe" being all-or-nothing is kind of scary though; if I want to use fmt!("%?") then I also open that code up to unsafe memory access and stuff
[21:57:49] *** Joins: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de)
[21:58:09] <graydon> I don't think %? should be considered unsafe
[21:58:22] <kmc> the Haskell community has many things labeled as "unsafe" and constant arguments about which are worse than the others, and they aren't checked by compilers (except for the newish Safe Haskell stuff)
[21:58:38] <graydon> I think the implementation is, but it should avoid bits of memory that it's unsure about printing
[21:59:04] <strcat> graydon: well it can be safe if we say types have to store valid pointers, etc.
[21:59:10] <strcat> or use * if it's not always valid
[21:59:11] <engla> Today you can store zeroed-out values in ~[T], the only crashing bug with that is when it's traversed by %?
[21:59:20] <engla> (that I've found)
[21:59:23] *** Quits: Nefzaoui (chatzilla@284486A4.F0AB48C5.7D0E51E.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[21:59:23] <graydon> kmc: yeah, we've talked before about reducing unsafe { .. } to a per-form-of-unsafety attribute, a lint, like #[allow(pointer_dereference)]
[21:59:24] <strcat> graydon: but atm lifetimes are only allowed on & so there's sometimes no choice
[21:59:28] <kmc> *nod*
[21:59:46] <kmc> in Haskell some will say that if you have a compile-time constant that might change on recompilation, you should only expose it as an IO action (whose code is "return 37" or whatever)
[22:00:02] <graydon> kmc: but the thing is .. that's actually a lesser tax; you are more likely to put that in the top of a big module and then just write C-style pointer twiddling everywhere
[22:00:08] <kmc> yeah
[22:00:16] <vladimir-lu> you shouldn't need dereference on fmt!(%?)
[22:00:26] <graydon> kmc: having it expression-at-a-time makes it a little more likely you restrict yourself to just the bad bit? I think? maybe. I guess it's all just speculation on people's behavior
[22:00:26] <strcat> it derefs ~, &, @, @mut
[22:00:29] <kmc> there's a whole suite of fascinating user experience / sociology questions here
[22:00:31] <kmc> yep
[22:00:49] <kmc> don't know if it's been studied at all
[22:00:49] <strcat> rusti: fmt!("%?", @5)
[22:00:50] -rusti- ~"@5"
[22:00:52] *** Quits: bent (chatzilla@moz-2CD73AA6.triad.res.rr.com) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[22:01:08] <strcat> rusti: struct Foo { x: 5 } fmt!("%?", Foo { x: @5 })
[22:01:09] <vladimir-lu> i think if someone uses it, it should add a vtable (to all types that you're trying to print) so you can use a trait
[22:01:09] -rusti- <anon>:7:25: 7:26 error: expected type, found token LIT_INT_UNSUFFIXED(5)
[22:01:09] -rusti- <anon>:7          struct Foo { x: 5 } fmt!("%?", Foo { x: @5 })
[22:01:09] -rusti-                                   ^
[22:01:09] -rusti- application terminated with error code 101
[22:01:10] <graydon> strcat: I'd be comfortable with that statement. "if you store malformed data in an automatically managed value, you are breaking memory safety"
[22:01:42] <shachaf> kmc: Int :: IO *
[22:01:44] <graydon> vladimir-lu: curiously, we do not have (presently) the ability to QI. we haven't really done much with vtables.
[22:02:01] <graydon> it's possible that a QI will be appropriate at some point.
[22:02:19] <vladimir-lu> graydon: i know, but at least then you would allow people to shoot themselves in the foot *only if they want to*
[22:02:22] <graydon> it would be reasonably cheap. I think we have complete information about that.
[22:02:29] <strcat> graydon: sounds fine to make that restriction
[22:02:30] <vladimir-lu> otherwise making %? unsafe
[22:02:39] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:02:40] <strcat> graydon: it's just that right now we don't really
[22:02:46] <strcat> could be fixed
[22:02:49] <strcat> migrating stuff to *
[22:02:55] <graydon> strcat: yeah. that's a bug then.
[22:03:04] * vladimir-lu grumbles %? is going to be so hard to google
[22:03:16] <strcat> vladimir-lu: it won't be the common way of doing printing anyway
[22:03:21] <graydon> we'll be changing it with the rewrite to fmt
[22:03:26] <graydon> probably to {} or something
[22:03:29] <graydon> or {n}
[22:03:40] <strcat> graydon: I think the default should be a trait-based conversion
[22:03:42] <sp3d> speaking of hard-to-google, what's a "QI"?
[22:03:58] <eatkinson> rusti: trait MyTrait { fn asdf(uint); } fn <T:MyTrait>{ T::asdf(3); }
[22:03:58] <graydon> oh, QueryInterface
[22:03:58] -rusti- <anon>:7:45: 7:46 error: expected ident, found `<`
[22:03:58] -rusti- <anon>:7          trait MyTrait { fn asdf(uint); } fn <T:MyTrait>{ T::asdf(3); }
[22:03:58] -rusti-                                                       ^
[22:03:58] -rusti- application terminated with error code 101
[22:04:04] <sp3d> oh, thanks
[22:04:04] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (Quit: leaving)
[22:04:06] <strcat> graydon: even if not unsafe, you don't want to be depending on %? output
[22:04:16] <graydon> agreed
[22:04:20] <strcat> since it's non-public implementation details
[22:04:20] <vladimir-lu> mm i think strat is onto something
[22:04:26] <vladimir-lu> *strcat
[22:04:27] <vladimir-lu> damn
[22:04:41] <strcat> rusti: std::hashmap::HashSet::new::<int>()
[22:04:43] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/ThQJ
[22:04:51] <eatkinson> rusti: trait MyTrait { fn fun (uint); } fn other_fun <T:MyTrait>{ T::fun(3); }
[22:04:51] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[22:04:51] -rusti- <anon>:7:69: 7:70 error: unknown start of token: 28
[22:04:51] -rusti- <anon>:7          trait MyTrait { fn fun (uint); } fn other_fun <T:MyTrait>{ T::fun(3); }
[22:04:51] -rusti-                                                                               ^
[22:04:51] -rusti- application terminated with error code 101
[22:05:25] <graydon> QI is essentially the operation "I have this pointer + this typeinfo, can you give me back the pointer cast to a callable pointer-to-a-trait (with a vtable)"?
[22:05:42] <strcat> graydon: I guess I view the ability to access non-public stuff as "unsafe" even though it's not *memory unsafe*
[22:05:42] <eatkinson> rusti: trait MyTrait { fn fun (uint); } fn other_fun() <T:MyTrait>{ T::fun(3); }
[22:05:42] -rusti- <anon>:7:57: 7:58 error: expected `{` but found `<`
[22:05:42] -rusti- <anon>:7          trait MyTrait { fn fun (uint); } fn other_fun() <T:MyTrait>{ T::fun(3); }
[22:05:43] -rusti-                                                                   ^
[22:05:43] -rusti- application terminated with error code 101
[22:05:49] <graydon> and the runtime says either Yes, here you go, or No, that type doesn't have an impl for that trait
[22:05:50] <strcat> because your code could break without the library API changing
[22:06:11] <erickt> nmatsakis: ping
[22:06:16] <eatkinson> rusti: trait MyTrait { fn fun (uint); } fn other_fun<T:MyTrait>() { T::fun(3); }
[22:06:17] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QWOb
[22:06:18] <strcat> 'unsafe' in rust doesn't really mean something like that though
[22:06:40] *** Quits: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de) (Quit: mellum)
[22:06:52] <vladimir-lu> i mean as long as you can know the size of the type then there should be a way to print the bytes of the object
[22:07:15] *** Quits: kertap (kertap@moz-5AE34C97.b-ras3.mvw.galway.eircom.net) (Quit: kertap)
[22:07:22] <strcat> vladimir-lu: well you can, but it currently requires unsafe {}
[22:07:39] <strcat> and you'd only be printing out the shallow part of the object
[22:07:52] <eatkinson> rusti: trait MyTrait { fn fun (uint); } fn other_fun<T:MyTrait>() { T::fun(3); }
[22:07:53] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/MjED
[22:08:01] <eatkinson> why does rust thing T is a module in ^
[22:08:09] <eatkinson> s/thing/think
[22:09:04] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:09:15] <engla> T::fun is not supported
[22:09:24] *** Joins: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de)
[22:09:27] <strcat> I want enough low-level reflection stuff to write an equivalent to boost::any
[22:09:29] <engla> you need to use MyTrait::fun
[22:09:42] <strcat> I wonder if we already have enough with tydescs
[22:09:56] <graydon> strcat: almost
[22:10:04] <vladimir-lu> engla: haang on, surely trait doesn't have static methods?
[22:10:05] <eatkinson> engla: won't that do dynamic method dispatch?
[22:10:23] <graydon> strcat: long ago we had such a thing spec'ed in the language, but removed it when we became convinced it could be done in the libraries
[22:10:26] <engla> eatkinson: nope
[22:10:46] <graydon> strcat: assuming, well, assuming some kind of type-identity and/or QI on the tydescs to downcast
[22:10:55] <graydon> at the moment I think tydescs can't do identity queries
[22:11:00] <graydon> this type == that type
[22:11:06] <graydon> we should be able to do that and QI probably
[22:11:22] <engla> vladimir-lu: take for example the trait Zero with static method zero()
[22:11:43] <engla> rusti: std::num::Zero::zero::<f32>()
[22:11:44] -rusti- 0
[22:12:06] <strcat> floats are weird
[22:12:19] <strcat> rusti: (0.0).is_zero()
[22:12:20] -rusti- <anon>:7:9: 8:5 error: type `<VF0>` does not implement any method in scope named `is_zero`
[22:12:20] -rusti- <anon>:7          (0.0).is_zero()
[22:12:20] -rusti- <anon>:8     };
[22:12:20] -rusti- error: aborting due to previous error
[22:12:20] -rusti- application terminated with error code 101
[22:12:29] * strcat thought that existed
[22:12:38] <engla> Zero is not in the prelude
[22:12:45] <kmc> rusti: 1f/0f
[22:12:45] -rusti- inf
[22:12:47] <strcat> rusti: use std::num::Zero; (0.0).is_zero()
[22:12:48] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/VFcM
[22:12:53] <strcat> rusti: use std::num::Zero; (0.0f).is_zero()
[22:12:54] -rusti- true
[22:12:58] <strcat> rusti: use std::num::Zero; (-0.0f).is_zero()
[22:12:59] -rusti- true
[22:13:00] <kmc> rusti: let x = 0f/0f; x == x
[22:13:00] -rusti- false
[22:13:24] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[22:13:31] <strcat> not as bad as rust's bool at least ;]
[22:13:44] <strcat> but that's a codegen bug
[22:13:55] <kmc> ?
[22:14:04] <strcat> rusti: let b = 5 as bool; (b, b == true)
[22:14:05] -rusti- (true, false)
[22:14:11] <vladimir-lu> engla: yes ofc you're right, no &self
[22:14:13] <kmc> heh
[22:14:19] <kmc> NaN != NaN is correct, just bad ;P
[22:14:20] *** Quits: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP) (Quit: brendan)
[22:14:22] <strcat> it stores bool as i8, as it should
[22:14:25] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Connection reset by peer)
[22:14:31] <strcat> but it doesn't truncate down to i1 after a load
[22:14:50] <strcat> or zext it to i8 on a store
[22:15:00] <strcat> so 'as' just turns u8 -> bool as a no-op :|
[22:15:21] <engla> strcat: did you already try to use default methods in num after the snapshot?
[22:15:33] <strcat> engla: no I just tried with container::Container and ran into a bug
[22:15:49] <engla> ok
[22:16:04] <strcat> still have to narrow that down
[22:17:28] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:19:09] <strcat> graydon: if we actually switch from %s -> {} we'll have done the same thing as python ;p
[22:19:15] <strcat> at least we won't have to keep around both
[22:19:19] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[22:19:31] <graydon> I think {} is the only thing that works with nested conditionals in i18n format strings
[22:19:35] <graydon> which seem to be the consensus technique
[22:19:36] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:20:09] <strcat> graydon: and using params more than once or not at all
[22:20:15] <graydon> yes
[22:20:45] *** Quits: mellum (falk@moz-621B2CA2.dip0.t-ipconnect.de) (Quit: mellum)
[22:20:57] <graydon> it's much more humane and extensible. the % thing is familiar but I think, like the 8 bit charset and 32bit IP address, its day may be past.
[22:21:30] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[22:21:34] <graydon> change of topic: do &Traits work yet?
[22:21:48] *** Quits: int3_ (int3_@moz-7B0110AD.mv.mozilla.com) (Client exited)
[22:22:08] <strcat> graydon: a bit
[22:22:13] <strcat> I think they are weird with lifetimes
[22:22:16] <graydon> ah
[22:22:25] <strcat> and there's no &mut Trait?
[22:24:26] *** Quits: jedestep (jedestep@34641662.FB4DE631.66C78B76.IP) (Ping timeout)
[22:24:56] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[22:25:25] <sully> ok, I am going to have a hell of a PR coming up
[22:26:03] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[22:26:13] <graydon> sully: what's the story?
[22:26:48] <sully> well, probably not that big of one, objectively speaking
[22:26:53] <sully> but probably my biggest so far
[22:27:45] <tjc> so you're saying that once you land it, you're going to Disney World
[22:28:07] <sully> that reorganizes vtable.rs pretty heavily, and enhances the trait resolution algorithm
[22:28:26] <sully> and makes it so we actually check that an impl implements all of its super traits
[22:28:40] <sully> and stores a bunch of vtable resolution information for impls in metadata
[22:28:57] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[22:28:57] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/D0_ZFA
[22:28:57] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[22:29:12] <sully> reworks method and vtable resolution for self/super
[22:29:34] *** Quits: lkuper (lkuper@EA56C73C.A402E718.C082B7DC.IP) (Quit: lkuper)
[22:29:36] <sully> which fixes a ton of default method+inheritance bugs
[22:29:45] <erickt> +1
[22:30:16] <sully> oh, and, as a side effect of all of this
[22:30:35] <graydon> a pony?
[22:30:40] *** Quits: ecr (Thunderbir@moz-19C7F72B.uoregon.edu) (Quit: ecr)
[22:30:41] <sully> I think should let us get rid of all of the dummy type params in iterator.rs
[22:31:42] <graydon> \o/
[22:31:56] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Connection reset by peer)
[22:32:06] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:32:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/l0JkWg
[22:32:06] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:32:07] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[22:32:07] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/rAvN2A
[22:32:07] <ghrust> 13rust/06auto 1448dd728 15Graydon Hoare: extra: use deriving more in workcache, switch to treemaps.
[22:32:07] <ghrust> 13rust/06auto 14d5803e6 15Graydon Hoare: extra: access workcache db via RWARC.
[22:32:07] <ghrust> 13rust/06auto 149a093ab 15Graydon Hoare: extra: change workcache::Work::unwrap to move out of self.
[22:32:07] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:32:09] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[22:32:41] <sully> although I'm not completely sure about that, since I haven't tried to remove them
[22:32:45] <kemurphy> vladimir-lu: yeah, working on some bare-metal stuff that would be way easier with it
[22:33:25] <sully> also, our libraries had a bunch of impls where the supertraits were never implemented
[22:33:39] <graydon> sully: yeah, we expected that :(
[22:33:46] *** Quits: jasom (aidenn@moz-5F6FC7B3.sb.sd.cox.net) (Ping timeout)
[22:34:11] <sully> anyways, I think I am more clever than I was last summer
[22:34:26] <sully> since I thought a bunch about how to improve the vtable resolution
[22:34:55] <sully> and never came up with what I ended up doing
[22:35:16] <sully> although I sort of feel like this summer I wouldn't have been eager to push through the is_early hack
[22:35:24] <sully> and the two things need to work together
[22:37:31] *** Joins: int3_ (int3_@moz-7B0110AD.mv.mozilla.com)
[22:37:56] <sully> I was looking through the vtable code this summer
[22:37:58] <sully> and was like
[22:38:11] <sully> "what the... is this is_early stuff? this is an awful hack."
[22:38:15] <sully> "oh, that was me, wasn't it."
[22:38:54] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &mut foo.a; let b = &mut foo.b; *a = 1; *b = 1;
[22:38:54] -rusti- rust: task failed at 'borrowed at <anon>:7', <anon>:7
[22:38:55] -rusti- rust: domain main @0xc831b0 root task failed
[22:38:55] -rusti- application terminated with error code 101
[22:39:08] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &mut foo.a; *a =1;
[22:39:08] -rusti- ()
[22:39:12] *** Quits: joey (Mibbit@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:39:18] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &mut foo.a; *a =1; let b = &mut foo.b; *b = 1;
[22:39:19] -rusti- rust: task failed at 'borrowed at <anon>:7', <anon>:7
[22:39:19] -rusti- rust: domain main @0xa001b0 root task failed
[22:39:19] -rusti- application terminated with error code 101
[22:39:45] <graydon> sully: be kind to yourself; if I beat myself up over everything in rustc that makes me think that way I'd never get out of bed in the morning
[22:40:01] <sully> heh
[22:40:16] <graydon> (although at this point there's not _much_ of my code left. just the grotty stuff nobody wanted to touch)
[22:40:40] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &mut foo.a; *a =1; foo.a = 2; foo
[22:40:41] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/BFCQ
[22:40:55] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[22:40:55] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f32a532 to 14e029c2d: 02http://git.io/N3iJvQ
[22:40:55] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[22:41:04] <vladimir-lu> kemurphy: yeah, i think rust is a very interesting language for doing that
[22:41:23] <strcat> graydon: the ~fn take glue was the scariest thing I've seen in rustc, I'm sure it was wrong
[22:41:28] <strcat> luckily it's gone along with Copy ;p
[22:41:37] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[22:41:41] <strcat> at the very least it allocated the wrong amount of memory
[22:41:50] <strcat> and did uninitialized reads
[22:42:06] *** Joins: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com)
[22:42:07] <sully> was any of that my fault?
[22:42:09] <sully> it might have been.
[22:42:14] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &mut foo.a; let b = &mut foo.b;
[22:42:15] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/iEjT
[22:42:45] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let Foo {a, b} = foo; foo
[22:42:45] -rusti- <anon>:7:82: 7:92 error: mismatched types: expected `@mut main::Foo` but found struct
[22:42:46] -rusti- <anon>:7          struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let Foo {a, b} = foo; foo
[22:42:46] -rusti-                                                                                            ^~~~~~~~~~
[22:42:46] -rusti- error: internal compiler error: no type for node 24: local (id=24, name=a) in fcx 7fa78c250620
[22:42:48] -rusti- application terminated with error code 101
[22:43:10] *** Joins: dbaupp (Thunderbir@moz-712A1135.lns20.syd6.internode.on.net)
[22:43:41] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; {let a = &mut foo.a; *a = 1; } let b = &mut foo.b;
[22:43:41] -rusti- <anon>:7:113: 7:114 warning: unused variable: `b` [-W unused-variable (default)]
[22:43:41] -rusti- <anon>:7          struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; {let a = &mut foo.a; *a = 1; } let b = &mut foo.b;
[22:43:42] -rusti-                                                                                                                           ^
[22:43:42] -rusti- ()
[22:44:14] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0a2/20130723004004])
[22:44:28] <strcat> sully: dunno, all the glue code is pretty bad though
[22:44:40] *** Quits: saati (bjb@moz-11469F61.harmless.hu) (Ping timeout)
[22:44:43] <strcat> I think no one ever really copied ~fn so it didn't get any fixes
[22:44:48] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[22:45:08] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[22:45:32] <strcat> lets see if rusti still works with first iteration of the cgroup changes...
[22:45:33] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[22:45:34] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; {let a = &mut foo.a; *a = 1; } let b = &mut foo.b; *b = 2; foo
[22:45:34] -rusti- @{a: 1, b: 2}
[22:45:43] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[22:46:01] <graydon> tikue: what are you trying to figure out?
[22:46:28] <tikue> graydon: the best way to get around borrow check failures -- sorry for making a mess of #rust : \
[22:46:29] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:46:51] <graydon> np, just wondering if there's something we can get you through the process of figuring-out quicker :)
[22:46:54] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:47:06] <strcat> rusti: 2
[22:47:09] -rusti- 2
[22:47:11] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[22:48:50] <tikue> graydon: heh, well I just have a pretty deeply nested @mut struct, so I want to alias some fields without breaking everything. 
[22:49:00] <graydon> ah. that can get tricky.
[22:49:26] <tikue> :\ on the bright side I think I'm getting close to a decent solution hah
[22:49:30] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[22:50:11] *** Joins: saati (bjb@moz-11469F61.harmless.hu)
[22:53:08] <strcat> http://software.intel.com/en-us/articles/introduction-to-intel-memory-protection-extensions huh
[22:53:17] <strcat> they're actually adding hardware support for asan-like stuff
[22:53:41] <tikue> rusti: struct Foo { a: uint, b: uint }; let foo = @mut Foo { a: 0, b: 0, }; let a = &foo.a; let b = &foo.b;
[22:53:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/bUDW
[22:55:04] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[22:56:36] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:57:40] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[22:57:53] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[22:58:12] <tcsc> how well does the -Z debug-info/extra-debug-info option work?
[22:58:50] *** Joins: Nefzaoui (chatzilla@27107E87.E8FCA58B.2ED19BAB.IP)
[22:58:53] <sully> has the compiler gotten slower in the last week?
[22:59:04] <strcat> sully: possibly stage0 is slower after the snapshot
[22:59:06] *** Joins: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net)
[22:59:11] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:59:17] <strcat> because our LLVM is built with thread-safety now
[22:59:22] <strcat> I don't know why ;p
[22:59:23] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[22:59:34] <acrichto_> sully: http://huonw.github.io/isrustfastyet/
[22:59:50] <strcat> acrichto_: not updated for a while though
[22:59:57] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[22:59:58] <acrichto_> oh awww :(
[23:00:07] <strcat> bug cmr ;p
[23:00:09] <engla> the compile timings are updated
[23:00:15] *** Joins: vodik_ (simon@moz-CBE4BB13.cable.teksavvy.com)
[23:00:35] <strcat> ah right the buildbot ones
[23:00:44] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[23:02:13] *** Joins: novabyte (Instantbir@moz-43A3814E.mullvad.net)
[23:02:14] *** Quits: novabyte (Instantbir@moz-43A3814E.mullvad.net) (Quit: novabyte)
[23:02:15] *** Quits: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP) (Quit: Lost terminal)
[23:02:29] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:02:34] *** Quits: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de) (Ping timeout)
[23:02:45] <tikue> bblum: 
[23:02:50] <tikue> rusti: struct Foo { a: @mut uint, b: uint }; let foo = @mut Foo { a: @mut 0, b: 0, }; let a = foo.a; let b = &foo.b; *a = 1
[23:02:51] -rusti- <anon>:7:107: 7:108 warning: unused variable: `b` [-W unused-variable (default)]
[23:02:51] -rusti- <anon>:7          struct Foo { a: @mut uint, b: uint }; let foo = @mut Foo { a: @mut 0, b: 0, }; let a = foo.a; let b = &foo.b; *a = 1
[23:02:51] -rusti-                                                                                                                     ^
[23:02:51] -rusti- ()
[23:03:44] <bblum> rusti: let x = @mut Some(42); let y = x.get_ref(); *x = None; error!("%?", y);
[23:03:46] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/TKcA
[23:04:19] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[23:04:35] <bblum> rusti: let x = @mut Some(42); let y = x; let y = y.get_ref(); *x = None; error!("%?", y);
[23:04:35] -rusti- rust: task failed at 'borrowed at <anon>:7', <anon>:7
[23:04:36] -rusti- rust: domain main @0xbb21b0 root task failed
[23:04:36] -rusti- application terminated with error code 101
[23:04:40] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[23:05:12] *** Parts: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net) (Leaving)
[23:05:58] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:06:40] <ChrisMorgan> :-( Significant performance regression in my rusthttpserver with a fresh build of Rust. Takes three times as long to answer a request.
[23:06:45] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Quit: jclements)
[23:06:59] <strcat> ChrisMorgan: you could bisect it
[23:07:14] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[23:07:22] <strcat> ChrisMorgan: what was the last good version?
[23:07:34] <kmc> I'm trying to understand this error "cannot root managed value long enough", and why it appears if I remove the transmute at https://github.com/mozilla/servo/blob/master/src/components/main/css/node_util.rs#L31
[23:07:42] <vladimir-lu> ChrisMorgan: is it on github btw?
[23:07:43] <ChrisMorgan> strcat: simply takes too long; 40 minutes to rebuild Rust.
[23:07:59] <strcat> ChrisMorgan: I have daily builds going back to 0.7 if you can give me the code + test to check
[23:08:09] <ChrisMorgan> strcat: I had been using a build of rust from a week or so ago.
[23:08:14] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[23:09:50] <ChrisMorgan> strcat: code is at http://hg.chrismorgan.info/rusthttpserver; `make && RUST_NEWRT=1 examples/apache_fake` and, while it's running, `ab -n 10000 http://127.0.0.1:8001/`
[23:10:24] <ChrisMorgan> vladimir-lu: not on GitHub, but at http://hg.chrismorgan.info/rusthttpserver at present
[23:10:33] *** Joins: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de)
[23:11:30] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[23:11:31] *** Joins: RMF (RMF@moz-348663EF.dsl.telepac.pt)
[23:12:00] <ChrisMorgan> (Oh, you must be in the src directory, BTW.)
[23:12:58] <vladimir-lu> ChrisMorgan: cool, will take a look
[23:13:53] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[23:14:03] <nmatsakis> erickt: pong
[23:14:30] <jmgrosen> wait, the extra::net library was removed???
[23:15:13] <kimundi> what is the name of the ' symbol?
[23:15:13] <ChrisMorgan> jmgrosen: yep
[23:15:25] <kimundi> single quote?
[23:15:28] <engla> single quote
[23:15:32] <kimundi> thx
[23:15:41] <ChrisMorgan> jmgrosen: so, if you still need to use it, don't update Rust yet.
[23:15:46] <graydon> jmgrosen: yes, we've tried to be clear that that interface was deprecated and being replaced with the new std::rt::io layer
[23:15:57] <jmgrosen> graydon: but no file i/o yet?
[23:15:59] <engla> kimundi: also U+0027 APOSTROPHE  in unicode
[23:16:13] <graydon> jmgrosen: correct, it's TBD. patches welcome.
[23:16:24] <graydon> file i/o is still in std::io
[23:16:42] <graydon> that needs completion / rewriting to use std::rt::io abstractions
[23:16:51] <graydon> work in progress. sorry.
[23:17:04] <graydon> (they're doing great work!)
[23:17:10] <jmgrosen> graydon: so i can't use std::rt::io and std::io at the same time, right?
[23:17:10] <ChrisMorgan> graydon: it's true, though, that using std::io will die if running with RUST_NEWRT=1?
[23:17:26] *** Quits: Guest__ (textual@BBE7C46A.B4F11D08.8612FA94.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:17:41] <strcat> ChrisMorgan: how many req/s does it have now vs a week ago btw?
[23:17:43] * ChrisMorgan was going to make a file serving example for his HTTP server, but then recalled that he was now tied to newrt
[23:17:45] <graydon> jmgrosen: I don't know if they stomp on each other much
[23:18:04] <ChrisMorgan> strcat: on my machine, I was getting 2,300; now I'm getting 800
[23:18:25] * graydon wonders if I ought to write the file part of rt::io
[23:18:28] * strcat is getting 4485 with a build from yesterday, will try some more
[23:18:46] <jmgrosen> graydon: is the interface going to be similar to std::io?
[23:18:46] <strcat> and conveniently, the build server just finished the build for today
[23:19:10] <graydon> jmgrosen: outside? probably not. std::io is very old and based on very obsolete restrictions
[23:19:26] *** Quits: sigma (sigma@moz-BE11A887.range109-151.btcentralplus.com) (Client exited)
[23:19:27] <jmgrosen> graydon: great, i never really liked it anyway
[23:19:30] <engla> remove std::io and it will have to solve itself :D
[23:19:37] <strcat> ChrisMorgan: heh, it broke from today's changes
[23:19:39] <strcat> request.rs:2:4: 2:24 error: unresolved import: could not find `net` in `extra`.
[23:19:41] <strcat> request.rs:2 use extra::net::url::Url;
[23:19:47] <strcat> anyway I'll try an older one
[23:20:19] <ChrisMorgan> strcat: just change that line, I simply haven't committed the change myself.
[23:20:37] <engla> is std::rt::io going to be just libc stdio?
[23:20:45] <engla> the file io part
[23:21:04] <graydon> no
[23:21:13] <graydon> it's going to go through uv, like everything else
[23:21:14] *** Joins: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:21:15] *** Joins: jasom (aidenn@moz-5F6FC7B3.sb.sd.cox.net)
[23:21:21] <engla> ok
[23:22:54] <graydon> olsonjeffery: ping
[23:22:59] <ChrisMorgan> strcat: tip of my repository will now only work since the landing of #7883; -2 (the one before tip) will work for before that.
[23:23:11] <strcat> well I changed a clone to a copy
[23:23:53] <strcat> ChrisMorgan: at 0.7.521.gad212ec it's 4900/s instead of 4400/s
[23:24:55] *** Quits: vodik_ (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[23:24:59] <ChrisMorgan> Hmm, turns out I actually removed 0.7 compatibility with the second last commit, too...
[23:25:17] <strcat> 4800 at  0.7.424.g5cc4e51-1
[23:25:21] *** Quits: Vert (quassel@8A83479C.391ACC8C.CAF63861.IP) (Ping timeout)
[23:26:08] <ChrisMorgan> Bah, even when compiled successfully it doesn't run on 0.7, immediate SIGSEGV.
[23:26:58] <strcat> 5000/s at 0.7.375.g9fce8c9-1
[23:27:33] <strcat> dies at 0.7.186.g5aa0ca9-1
[23:27:36] <strcat> segfault
[23:27:45] <strcat> and 375 is the day after that
[23:27:55] <ChrisMorgan> strcat: have you tried today's build, with extra::net::url changed to extra::url?
[23:27:58] *** Quits: MaikKlein2 (maik@moz-FD97565C.dip0.t-ipconnect.de) (Ping timeout)
[23:28:04] <strcat> ChrisMorgan: not yet, I will
[23:28:09] *** Joins: brendan (brendaneic@35E90EE3.B8B12C49.396B22AD.IP)
[23:28:11] <strcat> -rw------- 1 root root 26M Jul  9 17:55 /var/cache/pacman/pkg/rust-git-0.7.186.g5aa0ca9-1-x86_64.pkg.tar.xz
[23:28:13] <strcat> -rw------- 1 root root 26M Jul 11 17:57 /var/cache/pacman/pkg/rust-git-0.7.375.g9fce8c9-1-x86_64.pkg.tar.xz
[23:28:16] <strcat> dies in between those
[23:28:18] <strcat> hm
[23:28:21] <strcat> why don't I have one from the 10th
[23:28:33] <ChrisMorgan> Compile time also seems to be in the vicinity of three times as slow on my fresh rustc build.
[23:28:34] <strcat> oh I do
[23:28:35] <strcat> I have 338
[23:29:03] <strcat> ChrisMorgan: I think that's from LLVM thread safety
[23:29:08] <strcat> maybe not
[23:29:19] <strcat> ChrisMorgan: are you on OS X?
[23:29:27] *** Joins: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net)
[23:29:27] *** Quits: deepdog (deepdog@moz-BE31AF27.hr.hr.cox.net) (Quit: deepdog)
[23:29:27] <ChrisMorgan> Ubuntu 13.04, 64-bit.
[23:29:34] <bblum> hmmm, type check takes half the time that llvm passes takes these days
[23:29:42] <bblum> and translation half of that
[23:29:49] <bblum> i didn't realize it was that unskewed
[23:29:51] <strcat> ChrisMorgan: it brokeb etween 0.7.186.g5aa0ca9 and 0.7.338.g8fa0973 btw
[23:29:56] <strcat> segfaults with 186
[23:30:22] <strcat> well, "unbroke" ;p
[23:32:00] <strcat> ChrisMorgan: I get 4500/s from today
[23:32:04] <strcat> so that's the same as yesterday
[23:32:07] <strcat> the peak was 5000/s
[23:32:13] <ChrisMorgan> Hmm, those executables are also now significantly larger than they were: 240KB instead of the 70-80KB I recall them (the apache_fake and hello_world binaries) being.
[23:32:43] <strcat> -rwx------ 1 strcat users 238K Jul 23 19:31 apache_fake
[23:32:45] <strcat> today
[23:33:30] <strcat> -rwx------ 1 strcat users 216K Jul 23 19:33 apache_fake
[23:33:32] <strcat> july 11th
[23:33:41] <strcat> ChrisMorgan: it's not a big regression here
[23:33:59] <ChrisMorgan> No, doesn't sound it, nor is your performance regression.
[23:34:23] <strcat> just 10-15%
[23:34:44] <ChrisMorgan> Hmm... anything else changed on my machine? It's been rebooted since them on account of the graphical shell falling apart overnight while Rust was building...
[23:35:43] <jmgrosen> wow, i wonder my binary for my own program is so large
[23:35:51] <jmgrosen> i thought it was just a rust thing
[23:36:05] <ChrisMorgan> s/them/then/
[23:36:26] <strcat> jmgrosen: run 'strip' on it
[23:36:54] <jmgrosen> strcat: ah, well that reduced it by ~15%, thanks
[23:36:56] <dherman> azakai: ping
[23:37:01] <jmgrosen> i suppose i should have thought of that
[23:37:02] <azakai> dherman: pong
[23:37:05] <strcat> jmgrosen: also are you using -O? it'll be huge without it
[23:37:12] <dherman> azakai: tc39 liked toFloat32!
[23:37:12] <jmgrosen> strcat: yes, i am
[23:37:14] <dherman> it'll be in ES6
[23:37:25] <azakai> dherman: oh good!
[23:40:19] <strcat> ChrisMorgan: having daily builds is nice though ;p
[23:40:20] <ChrisMorgan> cmr: I don't know what's different, but everything associated with Rust is enormously slower today. Build times is something like 4 times as long (even more so, without -O), HTTP server performance reduced to a third of its former glory, some executables trebled in size...
[23:42:17] <ChrisMorgan> I believe the performance regression to be happening without -O also, but I haven't run it without -O enough to be sure.
[23:42:19] <tjc> ChrisMorgan: did you accidentally disable optimization when building rustc?
[23:42:44] *** Joins: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP)
[23:43:07] <strcat> huh, I don't really understand what they've done to cgroups
[23:43:11] <ChrisMorgan> tjc: not that I can tell
[23:44:03] <strcat> I better not have to learn dbus ;p
[23:44:42] <ChrisMorgan> Well, I'll run my `git pull --ff-only mozilla master && git push && ./configure --prefix=/home/chris/opt/rust && make && make install` incantation again and see what happens with another fresh build of Rust.
[23:46:09] *** Quits: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net) (Quit: jclements)
[23:47:41] <erickt> nmatsakis: reping :)
[23:47:46] <bblum> reaping
[23:48:50] *** Quits: Uther (Instantbir@moz-1B244B05.hfc.dyn.abo.bbox.fr) (Ping timeout)
[23:50:41] *** Joins: vodik_ (simon@moz-CBE4BB13.cable.teksavvy.com)
[23:51:53] *** Joins: jclements (jclements@moz-98A7BA64.ngn.east.myfairpoint.net)
[23:53:22] <strcat> ohloh thinks bors writes code
[23:53:39] <strcat> I think when it learns to detect rust it will count every line he merged
[23:56:00] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[23:56:05] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[23:57:16] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[23:57:45] <ChrisMorgan> !
[23:58:12] *** vodik_ is now known as vodik
