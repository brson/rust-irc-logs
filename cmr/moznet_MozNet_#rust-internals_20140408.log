[00:00:00] <pnkfelix> nrc: how can you use `,` when that's already being used to delimit the parameters?
[00:00:26] <pnkfelix> nrc: should we switch to `;` instead of `,` in generic params?  :)
[00:00:38] <brson> acrichto: indeed the bots can't reach the internet now
[00:00:50] * pnkfelix isn't kidding, though there's probably no need
[00:01:40] <nrc> oh yeah true
[00:01:45] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[00:01:45] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/KwX6jQ
[00:01:45] <ghrust> 13rust/06auto 14016a4b0 15Kang Seonghoon: std: make vec!() macro handle a trailing comma...
[00:01:45] <ghrust> 13rust/06auto 14b19e1b3 15bors: auto merge of #13278 : lifthrasiir/rust/vec-macro-with-trailing-comma, r=alexcrichton...
[00:01:46] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[00:02:16] <brson> acrichto: ok, reverted the routing tables
[00:02:18] <nrc> maybe we should switch to ; for all arg lists and in enums and structs too and get proper uniformity
[00:02:26] <nrc> (mostly kidding)
[00:02:33] <pnkfelix> nrc: its not totally crazy
[00:02:40] <pnkfelix> nrc: but probably too late
[00:03:15] <pnkfelix> nrc: well, maybe not all arg lists
[00:03:32] <pnkfelix> nrc: function calls in particular, the extra ink from that dot in `;` can be hard on the eyes
[00:14:47] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:17:12] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[00:25:24] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Connection reset by peer)
[00:36:57] *** Quits: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu) (Quit: lkuper)
[00:38:30] *** Joins: rajaram_ (rajaram@A6310201.F9A5BBD6.BE4CF869.IP)
[00:43:26] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:44:19] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:44:36] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.3.1)
[00:59:06] <brson> larsberg: i see a bunch of rustc invocations that don't specify the target
[00:59:09] <brson> `/home/brian/dev/servo/build/arm-linux-androideabi/src/compiler/rust/x86_64-unknown-linux-gnu/stage2/bin/rustc -D unused-imports -O -g -L /home/brian/dev/servo/build/workspace/lib/arm-linux-androideabi  -L. /home/brian/dev/servo/src/support/egl/rust-egl/egl.rc --out-dir .
[01:00:37] <larsberg> brson: is that a new requirement? we didn't have to in the past, so far as I can tell. Also, per the gist, we don't work with or without it on the commandline (with it, I get "can't find crate for 'std'")
[01:01:05] <larsberg> https://gist.github.com/larsbergstrom/10021397/#comment-1206923
[01:01:20] <brson> larsberg: i don't know how else it would have worked without specifying the target ...
[01:03:00] <brson> larsberg: hm, i *did* get past glut
[01:03:29] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[01:03:55] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Connection reset by peer)
[01:03:57] <larsberg> brson: interesting, what failure did you get in egl? it might just be because I haven't been update the android-specific code for this (it's a new rust build I'm porting to)
[01:03:59] <brson> but it built for x86_64, not android
[01:04:02] <brson> hm, hm
[01:04:06] <larsberg> aha, yeah, that's what I'm seeing, too
[01:04:20] <larsberg> oh, you're probably on linux, which doesn't have the glut osx build failure
[01:04:37] *** Quits: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP) (Quit: Sharp)
[01:05:12] <brson> larsberg: i got through egl after making trivial code changes
[01:05:21] <brson> then failed at opengles
[01:05:27] <brson> all just trivial stuff, though
[01:05:31] <brson> not hitting the same errors as you
[01:05:40] <brson> going to try to modify the makefiles to pass --target
[01:05:46] <brson> can't see how this can work without
[01:06:39] <brson> arg, i really can't imagine how servo's android build worked before
[01:06:50] <brson> not understanding something
[01:07:02] <larsberg> brson: you should be able to add "CFG_RUSTC_FLAGS += --target arm-linux-android" in build/Makefile and it'll be propagated to all of the invocations of rustc
[01:07:41] <larsberg> (adding that gives me the missing 'std' crate error, though)
[01:07:52] <brson> k
[01:10:14] <larsberg> I do notice that your rust builders for android pass " --build=x86_64-unknown-linux-gnu --host=x86_64-unknown-linux-gnu" to configure - do we need those, too? 
[01:11:41] <brson> larsberg: no, they should default to the correct values
[01:12:02] <brson> ok, rebuilding with make VERBOSE=1 CFG_RUSTC_FLAGS="--target=arm-linux-androideabi -C android-cross-path=/home/brian/dev/ndk_standalone"
[01:12:31] *** Joins: Rym_ (y@AFF474A6.738C7AF9.51C6DE68.IP)
[01:12:42] <brson> larsberg: again I got all the way to gl2
[01:12:47] <brson> not hitting your error
[01:12:52] *** Quits: Rym (y@1F811F8A.7136637D.51C6DE68.IP) (Ping timeout)
[01:13:03] <brson> and this time it build ARM bins
[01:13:43] <brson> larsberg: does your rustlib directory contain an arm dir?
[01:14:09] <brson> larsberg: i'm hoping this is just a mismatch between various command line flags (I had to jump through hoops to get a build)
[01:14:17] <brson> bbiab
[01:14:31] <larsberg> brson: yes ./arm-linux-androideabi/src/compiler/rust/x86_64-apple-darwin/stage2/lib/rustlib/arm-linux-androideabi/lib/
[01:14:36] <larsberg> exists
[01:15:20] <larsberg> nice, thanks for jumping those hoops for us - I spent most of the weekend that I wasn't rebuilding rust+servo for the acid2 video twidding with it to no avail :-)
[01:19:05] <brson> larsberg: I've discovered that the rust build didn't produce an android liblog. probably a bug in the rust makefiles that makes it not finish the build for secondary targets
[01:19:10] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[01:19:17] *** Quits: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[01:21:34] <brson> er, actually, this rust doesn't have liblog
[01:21:47] <brson> seeing some inconsistencies between what version of rust the code expects and what i actually have ...
[01:22:02] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:22:20] <larsberg> oh, sorry, I'm in the middle of a port to a newer rust we already landed in Servo (3/21) and the sources that worked with an android for rust around 2/24-ish.
[01:22:45] <brson> ok
[01:22:52] <larsberg> These sources are an attempt to rebase on that update of servo, so I'd not be surprised if the android-specific code expects an older rust
[01:24:47] *** Joins: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP)
[01:24:47] *** Quits: japaric (japaric@7A559B69.743D7231.BFC118EE.IP) (Ping timeout)
[01:25:06] <larsberg> brson: OK, I think that should unblock me - thanks!
[01:25:22] <brson> larsberg: wait, I haven't figured anything out yet ...
[01:25:25] <larsberg> I'll try not to steal half your day again anytime soon :-)
[01:25:29] <brson> trying to reconfigure and rebuild
[01:25:32] <larsberg> --target arm-linux-androideabi ?
[01:25:41] <brson> larsberg: these are the two commands i've used https://gist.github.com/brson/10080561
[01:25:46] <brson> and it *appears* to be successful
[01:25:51] <brson> trying again now
[01:25:55] *** Quits: Rym_ (y@AFF474A6.738C7AF9.51C6DE68.IP) (Ping timeout)
[01:26:09] <brson> using your branch + various minor hacks to .rs files
[01:27:22] *** Joins: japaric (japaric@5046D5AC.E00EBC6F.F29ED47E.IP)
[01:27:54] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[01:28:06] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[01:32:12] <larsberg> brson: awesome - sorry I seem to have missed out on a bunch of flags
[01:32:43] *** Quits: km (quassel@moz-777F24DE.kevinmehall.com) (Client exited)
[01:35:09] <larsberg> I'm seeing the same additional success when adding in those flags
[01:37:09] *** Joins: km (quassel@moz-777F24DE.kevinmehall.com)
[01:37:42] <brson> larsberg: actually, i had to add an intermediate step to bulid rustc https://gist.github.com/brson/10080561
[01:38:52] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:39:29] <larsberg> brson: Aha, I think those are changes I can fix up in our Servo makefiles. Thanks a ton for tracking this down!
[01:41:47] *** Quits: blank_name (blank_name@69FB4306.94CCB18F.53C6B850.IP) (Ping timeout)
[01:47:59] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[01:48:03] *** Joins: enix_ (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[01:49:11] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[01:51:13] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[01:52:16] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:52:34] * strcat will make http://ix.io/byp into an RFC soon
[01:53:22] <cmr> +1
[01:53:54] <nrc> how do I convert an ast::Ty into a ty::t?
[01:54:03] <nrc> not the first time, I assume it is cached somewhere
[01:54:05] <cmr> what I would give for a hoogle.
[01:54:28] *** Quits: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP) (Ping timeout)
[01:54:35] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:55:06] *** Joins: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP)
[01:56:00] <strcat> jemalloc 3.6.0 doesn't seem to work with valgrind at all
[01:56:03] <strcat> oh well
[01:56:41] <cmr> nrc: there's mk_t which takes a sty, which appears to use a cache.
[01:56:47] <cmr> haven't seen how to get the sty yet
[01:57:06] *** Quits: victorporof (victorporo@moz-1C281963.dsl.bell.ca) (Quit: victorporof)
[01:57:52] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[01:57:54] <nrc> my money was on node_id_to_type, which has the right sig
[01:58:06] <nrc> but it doesn't work, perhaps I'm using the wrong node id
[01:59:26] <strcat> nrc: cross-crate nonsense mangles all the numbers
[01:59:27] <strcat> ;p
[02:00:30] <nrc> oh bleurg, I hadn't thought of cross-crate :-(
[02:01:55] *** Quits: km (quassel@moz-777F24DE.kevinmehall.com) (Client exited)
[02:02:04] *** Joins: km (quassel@moz-777F24DE.kevinmehall.com)
[02:02:27] <nrc> wait, I don't think that should affect things - I'm walking the ast and looking up a typ I find along the way in the current ccx.tcx - so it is always the same crate
[02:02:44] <nrc> (even if the actual type comes from another)
[02:04:41] <strcat> ccx includes stuff from other crates
[02:05:00] <strcat> nrc: crate context really means 'everything trans needs state for' ;p
[02:05:15] <strcat> (unless it was shoved in the 'type context' instead)
[02:08:11] *** Joins: blank_name (blank_name@69FB4306.94CCB18F.53C6B850.IP)
[02:08:58] <cmr> Eridius: https://github.com/rust-lang/rfcs/pull/38
[02:10:42] *** Joins: yoshi (Mibbit@87176A7B.5941EA70.CC1A2609.IP)
[02:10:43] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: Leaving)
[02:13:46] <cmr> strcat: I find the requirement for alignment to be smaller than some large page size to be reasonably but difficult to fulfill in practice. I imagine it'd usually just be getting the alignment from some compiler intrinsic?
[02:14:10] <strcat> cmr: alignment should always be a known constant in the caller
[02:15:08] <strcat> jemalloc has UB for overly large alignment
[02:15:20] <strcat> doesn't seem worth saying allocators have to deal with it since it's a constant
[02:15:46] <strcat> and I can't think of a use case for > page size alignment :), maybe I'm wrong to think that there's none
[02:16:01] <strcat> (where page size is the *huge* page size, not 4k0
[02:16:07] *** Quits: yoshi (Mibbit@87176A7B.5941EA70.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:16:07] <cmr> no, I definitely agree that there's no use case
[02:16:30] <strcat> LLVM and jemalloc also both use a 32-bit alignment
[02:16:39] <strcat> so I copied that
[02:16:44] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Quit: leaving)
[02:17:03] <cmr> I'm just confused as to what the alignment should *be*, usually, when using the allocator. std::mem::align_of::<T>() ?
[02:19:55] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[02:19:56] *** ChanServ sets mode: +qo brson brson
[02:22:54] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[02:23:57] <nrc> GAH! hoisted by my own petard - this Nullable in liblibc thing is a royal PITA
[02:26:39] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[02:26:41] * cmr learns a new phrase
[02:26:57] <cmr> nrc: sorry :(
[02:27:33] <cmr> nrc: you could replace uses of Nullable with a *u8 and simple have callsites transmute
[02:27:36] <cmr> but that's sad :(
[02:27:58] *** Quits: zz_kimundi (kimundi@moz-5680B20B.dip0.t-ipconnect.de) (Ping timeout)
[02:28:04] <nrc> It's OK, it just means I have to implement some of the DST extensions now instead of later
[02:28:34] <cmr> ah
[02:29:45] <nrc> I hope, anyway
[02:29:56] *** Joins: erickt (erickt@B91004E7.345B955C.2321E71E.IP)
[02:29:59] <ChrisMorgan> The phrase is actually "hoist by his own petard" rather than "hoisted â€¦".
[02:30:57] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[02:32:00] *** Joins: zz_kimundi (kimundi@moz-D4C3C471.dip0.t-ipconnect.de)
[02:32:01] *** zz_kimundi is now known as kimundi
[02:33:51] <nrc> heh, close
[02:37:56] <ChrisMorgan> (But the other form is certainly common.)
[02:38:30] * nrc learns
[02:39:24] *** Quits: Jesse_ (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse_)
[02:39:30] <ChrisMorgan> https://books.google.com/ngrams/graph?content=hoist+by+his+own+petard%2Choisted+by+his+own+petard&year_start=1800&year_end=2008&corpus=15&smoothing=3
[02:40:03] <cmr> it appears the petard was invented somewhere around 1829
[02:40:14] <cmr> :p
[02:40:49] *** Joins: aatch|mobile (aatch@moz-F2813A2B.hfc.comcastbusiness.net)
[02:42:14] <cmr> nope
[02:44:15] *** Quits: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net) (Ping timeout)
[02:52:52] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:54:34] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[02:54:42] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:58:46] *** Joins: zeuxcg (zeuxcg@moz-2B528B55.mycingular.net)
[03:03:10] *** Joins: napoleon (Mibbit@87176A7B.5941EA70.CC1A2609.IP)
[03:05:32] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Quit: leaving)
[03:06:38] *** Quits: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP) (Ping timeout)
[03:07:21] *** Joins: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP)
[03:08:26] *** Quits: napoleon (Mibbit@87176A7B.5941EA70.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:09:57] *** Quits: zeuxcg (zeuxcg@moz-2B528B55.mycingular.net) (Client exited)
[03:15:04] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Quit: Leaving.)
[03:18:24] *** Joins: LINA707 (LINA707@moz-6EEA6D42.pools.arcor-ip.net)
[03:19:41] *** Quits: enix_ (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[03:20:16] <LINA707> compete in Stratego  JUMBASTIC  http://ow.ly/vusaO
[03:20:26] *** Quits: LINA707 (LINA707@moz-6EEA6D42.pools.arcor-ip.net) (Client exited)
[03:20:30] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[03:25:07] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[03:26:47] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[03:26:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14b19e1b3 to 149a33330: 02http://git.io/N3iJvQ
[03:26:48] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[03:28:17] *** Quits: Nekit1234007_ (Nekit12340@E757D5FA.7796E3F4.4707F662.IP) (Quit: )
[03:28:24] <acrichto> r? https://github.com/mozilla/rust/pull/13393
[03:28:30] <acrichto> bsd keeps deadlocking :(
[03:33:30] <sfackler> acrichto: any idea why the deadlocks started showing up all the sudden?
[03:33:42] <acrichto> that always baffles me
[03:33:55] <acrichto> it may have been some code elsewhere in the system shifted *just enough* to expose it
[03:34:06] <acrichto> but I have no idea really :\
[03:34:08] <sfackler> :(
[03:34:31] <acrichto> I almost know that I'm wrong though
[03:34:36] <acrichto> pthread_atfork exists for a reason
[03:35:27] * strcat is just about to propose using jemalloc again so...
[03:35:33] <strcat> although not like we did before
[03:37:30] <strcat> how do you make a footnote in github markdown?
[03:38:10] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[03:38:45] <sfackler> strcat: search for footnote here: http://daringfireball.net/projects/markdown/syntax
[03:39:09] <strcat> hm, github doesn't really turn those into proper footnotes though
[03:39:11] <strcat> that's what I tried ;s
[03:40:23] <sfackler> I mean, they aren't really footnotes, they're just links at the bottom :P
[03:40:26] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[03:40:31] <sfackler> or does it not even generate the links?
[03:40:41] <strcat> sfackler: it puts the links but the fragment to jump to them is broken
[03:40:44] <strcat> ;s
[03:45:25] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[03:45:55] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[03:46:37] *** Quits: rajaram_ (rajaram@A6310201.F9A5BBD6.BE4CF869.IP) (Ping timeout)
[03:47:07] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Ping timeout)
[03:59:16] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[04:00:29] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[04:02:13] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[04:02:56] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:04:21] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[04:04:39] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:05:47] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:06:33] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:10:47] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:10:47] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:11:07] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:12:11] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:12:29] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:14:08] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[04:14:12] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:16:38] *** Joins: japaric_ (japaric@188A38D3.DC1425E6.84437BC5.IP)
[04:17:00] *** Quits: japaric (japaric@5046D5AC.E00EBC6F.F29ED47E.IP) (Ping timeout)
[04:21:49] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[04:21:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 146f1d461 to 149a33330: 02http://git.io/N3iJvQ
[04:21:49] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[04:21:50] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[04:21:50] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/DtDIKQ
[04:21:50] <ghrust> 13rust/06auto 147da2109 15Alex Crichton: native: Try hard to not malloc on a forked child...
[04:21:50] <ghrust> 13rust/06auto 14e415c25 15bors: auto merge of #13393 : alexcrichton/rust/hopefully-fix-bsd, r=sfackler...
[04:21:51] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[04:24:50] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Quit: Leaving.)
[04:29:14] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:31:45] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:31:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:31:56] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[04:32:08] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[04:36:35] *** Quits: sfackler (sfackler@moz-AEECCEBA.com) (Connection reset by peer)
[04:38:25] *** Joins: sfackler (sfackler@moz-AEECCEBA.com)
[04:38:34] *** Quits: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com) (Quit: leaving)
[04:40:21] *** Quits: sfackler (sfackler@moz-AEECCEBA.com) (Quit: ZNC - http://znc.in)
[04:41:26] *** Joins: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com)
[04:41:32] *** Joins: sfackler (sfackler@moz-AEECCEBA.com)
[04:41:34] *** Quits: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP) (Ping timeout)
[04:41:57] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[04:42:06] *** Joins: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP)
[05:06:49] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[05:07:18] *** Joins: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de)
[05:08:40] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[05:09:52] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:09:52] *** ChanServ sets mode: +o tjc
[05:10:01] *** Quits: intuxicated (intuxicate@D028818A.A6A1F366.DA0107E2.IP) (Quit: Leaving)
[05:11:38] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Ping timeout)
[05:19:13] *** Joins: rajaram_ (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[05:30:16] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[05:33:28] *** Joins: edwardw (Mibbit@E9739E5B.EE06708D.4BFBD933.IP)
[05:38:20] *** Joins: NiccosSystem (NiccosSyst@moz-ED196BB4.customer.lyse.net)
[05:40:44] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[05:43:56] *** Joins: lpy (lpy@6B9892DD.F09091A8.1348A864.IP)
[05:45:10] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:45:10] *** ChanServ sets mode: +o tjc
[05:45:13] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[05:45:14] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[05:47:25] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[05:48:51] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[05:53:34] *** Quits: lpy (lpy@6B9892DD.F09091A8.1348A864.IP) (Client exited)
[05:54:07] *** Quits: gimpf (gimpf@moz-81AEB0B7.adsl.highway.telekom.at) (Ping timeout)
[05:57:36] *** Quits: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[06:03:48] *** Joins: ggherdov_ (sid11402@moz-E77DEB21.irccloud.com)
[06:04:18] *** Quits: herrwolfe45 (uid26657@moz-E77DEB21.irccloud.com) (Ping timeout)
[06:05:14] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:05:44] *** Quits: erickt (erickt@B91004E7.345B955C.2321E71E.IP) (Ping timeout)
[06:07:20] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:08:52] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[06:08:52] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/DtDIKQ
[06:08:52] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[06:09:43] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[06:10:49] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[06:10:49] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/LTq0-w
[06:10:49] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[06:10:52] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[06:10:52] <ghrust> [13rust] 15bors pushed 18 new commits to 06auto: 02http://git.io/ptkv_A
[06:10:52] <ghrust> 13rust/06auto 149539b95 15Alex Crichton: rustc: Remove absolute rpaths...
[06:10:52] <ghrust> 13rust/06auto 14076277a 15Jim Radford: sync: remove unsafe and add Send+Share to Deref (enabled by autoderef vtables)
[06:10:53] <ghrust> 13rust/06auto 14582c249 15Tobba: Made libflate functions return Options instead of outright failing
[06:10:55] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[06:11:02] *** Joins: newbie (kvirc@moz-4CF128CE.dip0.t-ipconnect.de)
[06:11:13] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[06:11:36] *** Quits: eibwen (kvirc@moz-CB454DA4.dip0.t-ipconnect.de) (Ping timeout)
[06:11:48] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[06:11:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14630ff00 to 14e415c25: 02http://git.io/N3iJvQ
[06:11:48] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[06:11:52] *** Joins: herrwolfe45 (sid26657@moz-E77DEB21.irccloud.com)
[06:12:11] *** Joins: gimpf (gimpf@moz-5F26EB36.adsl.highway.telekom.at)
[06:12:12] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[06:13:04] *** Joins: luziiie (luziie@moz-CD18B14B.customer.cdi.no)
[06:13:41] *** Quits: luziie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[06:14:30] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:14:33] *** Joins: luziie (luziie@moz-CD18B14B.customer.cdi.no)
[06:14:55] *** Quits: luziiie (luziie@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[06:18:16] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[06:18:17] *** ChanServ sets mode: +o tjc
[06:27:30] <eddyb> rusti: let _: proc() = ||{};
[06:27:31] -rusti- <anon>:11:25: 11:29 error: mismatched types: expected `proc()` but found `once ||` (expected ~ closure, found & closure)
[06:27:31] -rusti- <anon>:11         let _: proc() = ||{};
[06:27:31] -rusti-                                   ^~~~
[06:27:31] -rusti- error: aborting due to previous error
[06:27:31] -rusti- playpen: application terminated with error code 101
[06:27:59] <eddyb> whoa whoa what's with "once" there?
[06:28:30] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[06:28:51] <Eridius> nice error
[06:29:32] <sfackler> eddyb: proc() used to be once ~fn
[06:29:40] <eddyb> sfackler: do we infer onceness?
[06:29:59] <eddyb> and I'm pretty sure it was ~once fn
[06:31:37] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[06:32:57] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[06:36:34] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Quit: Leaving.)
[06:38:26] <eddyb> ast::Sigil, your days are numbered
[06:43:01] *** Quits: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP) (Ping timeout)
[06:43:24] *** Joins: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP)
[06:44:48] *** flaper87|afk is now known as flaper87
[06:59:07] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:00:38] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[07:00:58] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:02:52] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[07:06:48] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[07:06:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 145376c2c to 14e415c25: 02http://git.io/N3iJvQ
[07:06:48] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[07:06:52] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[07:06:52] <ghrust> [13rust] 15bors pushed 17 new commits to 06auto: 02http://git.io/3Nc-ZQ
[07:06:52] <ghrust> 13rust/06auto 14dc49018 15Jim Radford: sync: remove unsafe and add Send+Share to Deref (enabled by autoderef vtables)
[07:06:52] <ghrust> 13rust/06auto 14bc234ae 15Tobba: Made libflate functions return Options instead of outright failing
[07:06:52] <ghrust> 13rust/06auto 14c83afb9 15Alex Crichton: doc: Document flavorful variations of paths...
[07:06:54] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[07:08:04] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:09:47] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:09:55] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[07:10:35] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:10:49] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[07:11:40] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[07:16:49] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:16:49] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Q8pYcQ
[07:16:49] <ghrust> 13rust/06auto 144f5b443 15Alex Crichton: Register new snapshots
[07:16:49] <ghrust> 13rust/06auto 1482cd6d8 15bors: auto merge of #13387 : alexcrichton/rust/snapshots, r=brson...
[07:16:49] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:16:53] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:16:53] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14cbac5e5 to 14e415c25: 02http://git.io/N3iJvQ
[07:16:53] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:18:50] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Ping timeout)
[07:24:40] <vadimcn> So I want to break makefile dependencies so that building stage1 target libstd doesn't re-bootstrap compiler from scratch.   Any hints which makefile I need to tweak?
[07:26:16] *** flaper87 is now known as flaper87|afk
[07:26:32] <acrichto> vadimcn: https://github.com/mozilla/rust/blob/master/mk/target.mk#L154-L168
[07:26:39] <acrichto> if you comment out the lines with 0 it shoudl wokr
[07:26:52] <acrichto> I was doing that awhile back
[07:32:13] <eddyb> snapshots? 'a || is gone?
[07:34:00] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[07:35:11] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[07:37:03] *** newbie is now known as eibwen
[07:40:23] <vadimcn> acrichto: seems to work, thanks!
[07:47:41] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Client exited)
[08:02:18] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[08:08:23] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[08:09:55] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[08:10:12] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[08:10:59] *** Quits: edwardw (Mibbit@E9739E5B.EE06708D.4BFBD933.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:12:10] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[08:26:45] *** kimundi is now known as zz_kimundi
[08:30:38] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[08:32:03] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[08:36:26] *** Joins: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP)
[08:39:38] *** Joins: mib_2vn8n2 (Mibbit@87176A7B.5941EA70.CC1A2609.IP)
[08:41:50] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[08:41:51] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[08:41:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1482cd6d8 to 14e415c25: 02http://git.io/N3iJvQ
[08:41:51] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[08:41:52] *** Quits: mib_2vn8n2 (Mibbit@87176A7B.5941EA70.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:41:53] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[08:41:53] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/CqwScQ
[08:41:53] <ghrust> 13rust/06auto 14dacb549 15JustAPerson: Add test for #11881...
[08:41:53] <ghrust> 13rust/06auto 14ee5c677 15bors: auto merge of #13276 : JustAPerson/rust/master, r=huonw...
[08:41:54] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[08:42:23] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[08:43:49] *** Quits: Rym (y@E4C6AF78.969AC7B.51C6DE68.IP) (Ping timeout)
[08:51:13] *** Quits: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP) (Ping timeout)
[08:56:08] *** Quits: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de) (Ping timeout)
[09:08:25] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[09:10:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[09:15:52] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:15:52] *** ChanServ sets mode: +o pnkfelix
[09:19:17] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[09:21:00] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[09:24:12] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[09:32:05] *** Joins: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP)
[09:32:53] *** Quits: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com) (Connection reset by peer)
[09:38:13] *** Quits: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP) (Quit: Konversation terminated!)
[09:38:21] *** Joins: _eddyb_ (eddy@9C8921DE.97C485DB.D608C900.IP)
[09:40:48] *** _eddyb_ is now known as eddyb
[09:51:47] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[09:53:04] *** flaper87|afk is now known as flaper87
[09:54:29] *** Joins: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com)
[10:03:44] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Quit: I'm sure it's perfectly safe)
[10:04:04] <SimonSapin> http://static.rust-lang.org/doc/master/src/std/home/rustbuild/src/rust-buildbot/slave/nightly-linux/build/src/libstd/io/mod.rs.html#916-919 I think we should be able to write `|v| self.write(v)` as just `self.write`. In other words, when a method is used in an expression for anything but calling it, it could be coerced to a closure. Does that sound like a terrible idea, or is worth an
[10:04:06] <SimonSapin> RFC?
[10:04:55] <pnkfelix> SimonSapin: the main problem I see with that is that it hides the cost of the coercion.
[10:05:02] <pnkfelix> SimonSapin: but that doesn't mean its not worth an RFC
[10:05:23] *** Quits: KokaKiwi (kokakiwi@moz-D674DAC6.kokakiwi.net) (Ping timeout)
[10:05:25] *** Quits: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP) (Connection reset by peer)
[10:05:38] <pnkfelix> SimonSapin: (and I do admit that I've been recently annoyed by having to eta-exapnd)
[10:05:44] <pnkfelix> *eta-expand
[10:05:56] <SimonSapin> eta?
[10:06:00] *** Joins: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP)
[10:06:09] *** Joins: mcpherrin (mcpherrin@moz-33D521D6.hsd1.ca.comcast.net)
[10:06:10] *** Joins: KokaKiwi (kokakiwi@moz-D674DAC6.kokakiwi.net)
[10:06:16] <pnkfelix> SimonSapin: its the term in the lambda-calculus
[10:06:22] <SimonSapin> ok
[10:06:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:06:32] <SimonSapin> is this kind of coercion very costly?
[10:06:35] <pnkfelix> SimonSapin: for converting `f` to `|x| f(x)`
[10:06:47] <eddyb> the coercion has 0 cost
[10:06:51] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[10:06:52] <pnkfelix> SimonSapin: I don't know off-hand.
[10:07:05] <eddyb> as long as the method call takes &self or &mut self
[10:08:21] <eddyb> SimonSapin: the low-level part of the implementation is trivial. regionck and borrowck interactions are more complicated
[10:08:24] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[10:08:55] <pnkfelix> I suppose that is another problem with it
[10:08:57] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:09:36] <eddyb> SimonSapin: there's also the possibility of changing single-word-capture closures to store the capture without indirection, allowing more useful patterns
[10:10:24] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[10:10:27] <eddyb> like, fn add(x: int) -> |int|:'static -> int {|y| x + y}
[10:10:28] <SimonSapin> eddyb: isnâ€™t all of that orthogonal to the syntactic sugar?
[10:11:10] <eddyb> SimonSapin: then the syntactic sugar for x.foo is equivalent to |...| x.foo(...)
[10:11:26] <eddyb> otherwise, it's a special case
[10:11:50] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[10:11:50] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ee5c677 to 14e415c25: 02http://git.io/N3iJvQ
[10:11:50] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[10:11:51] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[10:11:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/EadFBg
[10:11:51] <ghrust> 13rust/06auto 149643189 15Nick Cameron: Allow inheritance between structs....
[10:11:51] <ghrust> 13rust/06auto 1495d9a1b 15bors: auto merge of #12562 : nick29581/rust/fields, r=nikomatsakis...
[10:11:51] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[10:12:01] <eddyb> uh oh are we merging that?
[10:12:46] * eddyb hopes he won't see various projects using it - then again, it could be a learning experience :P
[10:15:43] <flaper87> eddyb: at least it is feature gated
[10:15:55] <eddyb> SimonSapin: oh, and, it would be a hack on top of ExprIndex, if we do it before CFG becomes the norm
[10:16:23] <SimonSapin> eddyb: I have no idea what youâ€™re talking about :)
[10:16:29] <SimonSapin> but Iâ€™ll write the RFC
[10:17:52] <eddyb> SimonSapin: if you do, could you also mention the more general extension to closures with one capture?
[10:19:26] <eddyb> SimonSapin: oh, and, strcat has a different form of the same feature - `x.foo(_)` as sugar for `|y| x.foo(y)` - but he says that requires unboxed closures (no idea why)
[10:20:31] <eddyb> SimonSapin: even if you aren't going to put that information into the RFC, I wanted to make sure you knew about related movements *shrug*
[10:21:56] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Ping timeout)
[10:25:04] *** Quits: canhtak (canhtak@moz-7FC55BCE.wl.t.ulaval.ca) (Quit: canhtak)
[10:25:26] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140407030203])
[10:25:30] <cmr> eddyb: strcat does not have that proposal.
[10:25:39] <cmr> what he mentioned was partially applied closures.
[10:26:59] <SimonSapin> eddyb: these things sounds like separate proposals, so Iâ€™ll leave it to you to mention them in RFC comments if theyâ€™re relevant
[10:27:33] *** Joins: victorporof (victorporo@moz-1C281963.dsl.bell.ca)
[10:27:48] <eddyb> cmr: oh?
[10:28:04] * eddyb tries to sound informed but he really is not
[10:31:31] <eibwen> eddyb: the single-word capture is dangerous, i64 would work on 64bit platforms but not on 32bit platforms
[10:31:46] <eibwen> same problem for 16bit system if rust tries to support them
[10:32:07] <cmr> which I totally want it to.
[10:32:12] <eddyb> eibwen: you could only allow pointers and int/uint
[10:32:36] <eibwen> mh yea that might work
[10:32:36] <eddyb> but yeah, it's trickier than a regular layout optimization because it changes lifetime semantics
[10:33:34] <eibwen> but it would allow some useful things with Iterator::map()
[10:33:44] <cmr> (what's being discussed?)
[10:33:45] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[10:34:41] <eibwen> cmr: [12:09:36] <eddyb> SimonSapin: there's also the possibility of changing single-word-capture closures to store the capture without indirection, allowing more useful patterns
[10:34:56] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[10:40:23] <huon> pnkfelix: btw, I saw what you were saying about the grammar a few hours ago (i guess it would've been last night for you); either A? B? T: ... or A+B? T:... seem reasonable to me.
[10:40:38] <huon> (Although it's a little weird having "bounds" on both sides of a type.)
[10:41:06] <huon> (but that's a "problem" with any of these proposals, not unique to the `?` syntax.)
[10:41:15] <pnkfelix> huon: yeah, it is weird, though the fact that they serve dual roles makes it somehow make sense it my head
[10:41:22] <pnkfelix> huon: i.e. the things aren't bounds
[10:41:29] <pnkfelix> huon: they are anti-bounds.  capabilities.
[10:42:03] <pnkfelix> (capabilities in terms of what types the parameter can be instantiated with, that is.  It ends up introducing more restrictions on your code itself, of course)
[10:42:28] <huon> Trait bounds are essentially capabilities in that sense too, aren't they?
[10:42:42] <huon> but yeah, I don't have a particular problem with these inverse bounds
[10:42:58] <pnkfelix> huon: no.  A bound on the RHS is *restricting* the universe of possible types you instantiate
[10:43:08] <pnkfelix> huon: while an entry on the LHS is *expanding* the universe
[10:43:12] <pnkfelix> huon: thus they are duals.
[10:43:33] <pnkfelix> huon: "capabilities" is not great terminology
[10:43:56] <pnkfelix> huon: since putting a bound on the RHS is increasing the set of methods you can call in the generic code itself.
[10:44:04] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[10:44:42] <flaper87> pnkfelix: huon I missed that part of the convo last night, under what context will `A? B? T:` will be used?
[10:44:44] <pnkfelix> huon: this is analogous to the classic problem with explaining the word "subclass" to newcomers, which is the argument I think Stroustrup gives for avoiding the word "subclass"
[10:44:50] <pnkfelix> flaper87: its for DST
[10:45:05] <pnkfelix> flaper87: nrc doesn't like `<type T>`
[10:45:20] <pnkfelix> flaper87: (as the syntax for saying "T could be unsized")
[10:45:29] <pnkfelix> flaper87: and I don't like `<unsized T>`
[10:45:42] <pnkfelix> (since I think it reads as saying "T is always unsized")
[10:45:48] <huon> pnkfelix: I was just meaning a trait bound restricts what types that a parameter can be instantiated with, and introduces more restrictions on the code
[10:46:07] <flaper87> pnkfelix: yeah, I agree w.r.t `unsized T`
[10:46:21] <flaper87> pnkfelix: what's nrc argument against `type T` ? 
[10:46:26] <pnkfelix> flaper87: So during brainstorming, we came up with `<Sized? T>`
[10:46:34] <pnkfelix> flaper87: I'll find the ticket
[10:46:40] <huon> (which is the brief definition you gave, obviously a transient IRC convo isn't necessarily when one will be most precise :) )
[10:46:55] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[10:46:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/uhsYNA
[10:46:55] <ghrust> 13rust/06auto 14016a4b0 15Kang Seonghoon: std: make vec!() macro handle a trailing comma...
[10:46:55] <ghrust> 13rust/06auto 14be864e3 15bors: auto merge of #13278 : lifthrasiir/rust/vec-macro-with-trailing-comma, r=alexcrichton...
[10:46:55] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[10:46:59] <pnkfelix> flaper87: https://github.com/mozilla/rust/pull/13375
[10:47:08] <pnkfelix> flaper87: in particular https://github.com/mozilla/rust/pull/13375#issuecomment-39788974
[10:47:14] <flaper87> pnkfelix: I'll go through it! Thanks :)
[10:47:46] <eddyb> is that like !Sized?
[10:48:04] <eddyb> though !Sized had the issue of implying "only unsized"
[10:48:07] <huon> eddyb: not-necessarily-Sized
[10:48:09] <huon> yeah, exactly
[10:48:21] <huon> ("optionally Sized")
[10:48:33] <eddyb> what about <T: ?Sized>?
[10:48:46] <pnkfelix> eddyb: no, I don't want these things on the RHS of the colon
[10:48:50] <eddyb> pnkfelix: okay
[10:49:06] <eddyb> (I guess there's a very good reason for that)
[10:49:16] <pnkfelix> eddyb: Its basically what huon and i were discussing above
[10:49:33] <pnkfelix> eddyb: these things on the LHS are dual to the things on the RHS
[10:49:48] <pnkfelix> eddyb: So I want them segregated.
[10:49:53] <eddyb> yeah, I saw that, I was just wondering
[10:50:06] <eddyb> the LHS reminds me of C/C++ type grammar
[10:50:17] <eddyb> *the LHS form
[10:51:15] <pnkfelix> eddyb: yeah.  I think the `<A? B? T: X+Y>` form is easier for humans to parse than nrc's `<A+B? T: X+Y>`
[10:51:19] <flaper87> I guess things like `<Send? T: Send>` should be invalid (or simply mean `<T: Send>`
[10:51:32] <flaper87> (assuming that acuatlly makes sense)
[10:51:39] <pnkfelix> flaper87: its not invalid; a macro could expand into it,.
[10:51:44] <pnkfelix> flaper87: it does make sense
[10:51:49] <eddyb> flaper87: it makes perfect sense
[10:51:55] <pnkfelix> flaper87: but it basically just denoted `<T: Send>`, as you said.
[10:52:16] <flaper87> pnkfelix: exactly, we could warn about that
[10:52:20] <eddyb> actually, nevermind, glb/lub doesn't apply
[10:52:24] <pnkfelix> flaper87: yeah a lint would be fine.
[10:53:28] <eddyb> so the default is <T: Sized> and you can toggle it off with <Sized? T>?
[10:53:42] *** Joins: sigma (sigma@moz-D5CE1DA5.range86-135.btcentralplus.com)
[10:53:46] <pnkfelix> eddyb: that's right
[10:53:48] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[10:53:55] <eddyb> and <T: Unsized> would be used to restrict T to only unsized types
[10:54:04] <pnkfelix> eddyb: <Sized? T: Unsized>, I think.
[10:54:11] <eddyb> it's not bad and it avoids adding the unsized keyword
[10:54:25] <flaper87> eddyb: at the cost of a new token
[10:54:26] <pnkfelix> eddyb: well I thought `<type T>` had the same benefit.
[10:54:29] <eddyb> pnkfelix: oh, right, <T: Unsized> would be <T: Sized+Unsized> :))
[10:54:35] <flaper87> but that's fine, I think
[10:54:37] <huon> (? as a token would be nice for macros.)
[10:54:49] <eddyb> print?(maybe?)
[10:54:50] <flaper87> (agreed)
[10:54:51] <huon> (fsvo nice, of course)
[10:54:54] * pnkfelix is still surprised we had managed to avoid using `?` for something
[10:55:06] <eddyb> wait, we don't have it?
[10:55:10] <flaper87> nope
[10:55:12] <huon> `c!(a ? x : y)`
[10:55:21] <eddyb> rusti: c!(a ? x : y)
[10:55:21] -rusti- <anon>:11:14: 11:15 error: unknown start of token: ?
[10:55:22] -rusti- <anon>:11         c!(a ? x : y)
[10:55:22] -rusti-                        ^
[10:55:22] -rusti- playpen: application terminated with error code 101
[10:55:25] <eddyb> oh wow
[10:55:52] <eddyb> that's an important one for some kinds of regular expressions
[10:55:53] <pnkfelix> I guess that's part of why people kept suggesting we use it for Option sugar
[10:56:25] <huon> Most suggestions I've seen haven't mentioned anything at the token/parsing level (although maybe they're thinking it)
[10:56:37] <huon> (iirc)
[10:56:44] <pnkfelix> huon: right, I just meant, there wasn't any obvious counter-use for ?
[10:56:50] <huon> ah, yes
[10:56:50] <pnkfelix> huon: because there couldn't be any.  :)
[10:57:42] <huon> (I think some mainstream other languages (Java, C#?) are adopting/have adopted null-safe ? syntax.)
[10:57:52] * huon likes null-safe type systems :)
[10:58:37] <eddyb> a?.b is a.and_then(_.b) I think
[10:58:38] <flaper87> I *think* ruby uses `?` I just don't know what for
[10:58:47] <eddyb> flaper87: methods returning bools
[10:58:57] <eddyb> (or is that a different language?)
[10:58:58] <flaper87> eddyb: there you go! Thanks
[10:59:05] <flaper87> I think you're right
[10:59:15] <eddyb> flaper87.am_i?
[10:59:26] <flaper87> LOL
[10:59:28] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Ping timeout)
[10:59:54] <eddyb> Ruby is such a silly language sometimes. at least it's not broken
[11:00:19] *** Joins: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de)
[11:05:42] <Zr40> ? in ruby is a convention, not syntax
[11:06:43] <huon> oh, it's a legal part of identifiers?
[11:06:55] <huon> (or just the trailing character?)
[11:07:19] <mcpherrin> I really wish Rust allowed ? in identifiers; it would make the Schemer in me happy
[11:07:33] <Zr40> just the trailing character
[11:07:37] <Zr40> same with !
[11:07:39] <huon> mcpherrin: `-` as well?
[11:08:07] <mcpherrin> huon: Well I can't have everything :P
[11:08:19] * huon gives mcpherrin everything, just to spite him
[11:08:23] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[11:08:38] <mcpherrin> huon: I, uh, what, okay.
[11:08:45] <huon> (or her, my apologies, if so.)
[11:09:15] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[11:09:23] <huon> mcpherrin: send me your address, you're gonna get a rather large delivery in a few days
[11:09:48] <eddyb> huon: bobcats. it's going to be bobcats, isn't it?
[11:10:10] <mcpherrin> 935 Pennsylvania Ave NW, Washington, DC 20535
[11:10:24] <sigma> ahh, so eddyb is secretely xkcd's black hat dude
[11:10:25] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[11:10:28] <sigma> it all makes sense now
[11:11:01] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[11:11:37] <huon> mcpherrin: oh, erm, seems I don't quite have a box large enough, I'll have to postpone...
[11:11:38] <huon> ;P
[11:12:17] <pnkfelix> huon: I'm sure mcpherrin will accept your delivery in installments
[11:12:37] <huon> mcpherrin: is partial deliveries ok?
[11:13:02] <huon> I'll send you one box tomorrow, half the next day, then a third, a quarter... eventually you'll get everything.
[11:14:16] <mcpherrin> huon: a finite sequence would be better...
[11:14:57] <mcpherrin> But at least make the series converge.
[11:15:10] <pnkfelix> lets all sing in harmonicity
[11:15:42] <Zr40> after 20000 deliveries, you still only have 10 complete boxes
[11:18:16] *** Joins: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP)
[11:19:42] <mcpherrin> huon: Is the set of things you send me something?  If so, how do you send it to me?
[11:19:50] <huon> mcpherrin: shipping you "everything" requires a lot of things ;P 
[11:20:08] <mcpherrin> Since a package cannot contain itself.
[11:20:09] <huon> anyway, fixing linux problems by using windows is the worst :/
[11:20:15] * huon frowns at vidyo
[11:22:25] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:30:44] <vhbit> have 2 problems on linking stage with cross-compiling
[11:30:44] <vhbit> 1. rustc compiles to the correct arch but tries to link with a host one and definitely fails
[11:30:44] <vhbit> 2. if I try to link using clang with all native libraries I get a lot of unresolved symbols of kind __sync_val_compare_and_swap_4 (i.e. atomic operations). Should it be fixed/configured on LLVM or Rust side?
[11:32:51] <eddyb> vhbit: what are the host/target triples?
[11:32:59] <klutzy> vhbit: rustc -C linker=<cross-linker>?
[11:33:20] <vhbit> host x86_64-apple-darwin, target arm-apple-ios
[11:34:09] <vhbit> @klutzy will try once recompile finishes
[11:34:36] *** zz_kimundi is now known as kimundi
[11:36:09] <klutzy> if you are compiling cross-compiler with `configure --target=...`, makefile should pass  `-C linker=` option to rustc
[11:36:14] <klutzy> if not, it may be broken
[11:36:27] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[11:37:24] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:53:03] *** Quits: rajaram_ (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[11:53:27] *** Joins: rajaram_ (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[11:54:32] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[11:58:24] *** Quits: rajaram_ (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[12:01:52] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[12:01:52] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/OiTDyg
[12:01:52] <ghrust> 13rust/06auto 142627c33 15Dmitry Promsky: Made 'make install' include libs for additional targets
[12:01:52] <ghrust> 13rust/06auto 14d1cb1d4 15bors: auto merge of #13314 : dmski/rust/android, r=alexcrichton...
[12:01:52] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[12:01:54] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[12:01:54] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14be864e3 to 14e415c25: 02http://git.io/N3iJvQ
[12:01:54] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[12:05:17] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Connection reset by peer)
[12:05:36] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[12:07:55] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:08:24] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[12:08:27] *** Joins: Nekit1234007 (Nekit12340@66BD5FB7.C629D74E.4707F662.IP)
[12:09:22] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[12:09:42] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:10:25] *** Quits: kaeso (kaeso@moz-F21FF626.unstable.it) (Quit: ZNC - http://znc.sourceforge.net)
[12:10:26] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[12:10:36] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[12:10:37] *** Joins: kaeso (kaeso@moz-F21FF626.unstable.it)
[12:10:48] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[12:10:58] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[12:14:33] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[12:15:57] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[12:22:02] <vhbit> klutzy, unfortunately even with supplied linker it tries to link against host arch
[12:22:02] <vhbit> I'm using the following command: rustc --target=arm-apple-ios -C linker=<long path to clang> -C ar=<long path to clang> hello.rs 
[12:22:03] <vhbit> it is almost the same as in stage2 compile but without configuration options/warnings/outdir
[12:24:42] <vhbit> anyway, what about question 2? I've provided all the libraries to the linker and still no luck
[12:24:55] <vhbit> are those atomic operations somehow "special" functions?
[12:42:38] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[12:42:59] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[12:43:43] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[12:44:42] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[12:44:50] <eddyb> vhbit: those functions are used when the hardware doesn't support certain instructions
[12:45:11] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[13:07:04] <vhbit> eddyb: aha, so I have to implement them... I wonder why android port on arm hasn't required them
[13:07:06] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[13:07:45] <eddyb> vhbit: because they're usually supported in hardware ;)
[13:07:58] <eddyb> and they probably are eve in this case - maybe the triple is incomplete?
[13:08:26] <eddyb> android has "arm-linux-androideabi" - the "eabi" at the end might be relevant
[13:09:15] <vhbit> triple is a little bit different from usual ones, but I'll check if I can pass additional target parameters (cpu/fpu) to get them
[13:14:11] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:18:05] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[13:21:52] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[13:21:52] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/ezkVTw
[13:21:52] <ghrust> 13rust/06auto 14aa8c4be 15Huon Wilson: std: use a `match` in `assert_eq!` to extend the lifetime of the args....
[13:21:52] <ghrust> 13rust/06auto 14fb714a3 15Huon Wilson: collections: replace all ~[T] with Vec<T>.
[13:21:53] <ghrust> 13rust/06auto 14cf6b52b 15bors: auto merge of #13350 : huonw/rust/devec-collections, r=alexcrichton...
[13:21:55] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[13:23:11] <eddyb> huon: :D
[13:23:27] <eddyb> there's a couple tests of mine with comments about the assert_eq issue
[13:23:52] <huon> yeah, I got sufficiently annoyed by it (after months of hitting it) to finally fix it :)
[13:24:02] * huon hopes that patch lands
[13:32:37] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:33:11] *** Quits: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP) (Input/output error)
[13:37:04] *** Joins: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP)
[13:45:38] *** Joins: rajaram_ (rajaram@5881197.FFE33577.BE90E62C.IP)
[13:54:24] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[13:54:43] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[13:55:34] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[13:55:50] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[13:56:02] *** Quits: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de) (Ping timeout)
[13:56:06] *** vfetwnuncszu is now known as dcrewi
[13:57:53] *** Joins: _eddyb_ (eddy@9C8921DE.97C485DB.D608C900.IP)
[13:58:26] *** Quits: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP) (Ping timeout)
[13:58:46] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[13:58:59] <_eddyb_> huh
[13:59:02] *** _eddyb_ is now known as eddyb
[13:59:22] <eddyb> why does rustdoc convert AST nodes to its *isomorphic* types?
[13:59:32] <eddyb> I would've understood if there was any difference at all
[13:59:53] <eddyb> it just clones the AST into... something similar
[14:00:52] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[14:01:05] *** vfetwnuncszu is now known as dcrewi
[14:04:33] <cmr> eddyb: because the AST used @ everywhere and had poor names.
[14:04:51] <eddyb> aaand that's a good reason to duplicate it?
[14:05:19] <eddyb> it might have been at the time, but it turns into "clone every field"
[14:06:07] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[14:07:13] <cmr> rustdoc's cleaned AST also contains no spans, patterns, and resolves everything (rather than including indirect references), including xcrate
[14:07:23] <cmr> not saying it couldn't be better
[14:07:28] <cmr> but that was my reasoning 10 months ago
[14:07:49] <eddyb> not sure if this is cleaned
[14:07:52] <eddyb> cmr: visit_ast.rs
[14:07:58] <cmr> that's different
[14:08:05] <eddyb> so what *is* that?
[14:08:13] <cmr> some glue crap
[14:08:29] <cmr> rather than having ~[Item]
[14:08:33] <cmr> it splits it into buckets
[14:08:34] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:08:37] <cmr> per item type.
[14:08:58] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[14:09:18] <eddyb> cmr: but why doesn't it work with the regular AST?
[14:10:28] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[14:10:28] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:10:33] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[14:10:40] *** vfetwnuncszu is now known as dcrewi
[14:11:09] <cmr> I just said why.
[14:11:45] <eddyb> aaaah, I see it now
[14:13:31] <eddyb> cmr: but compare doctree::Variant with ast::Variant - oh, wait, nevermind, the former doesn't have disr_expr
[14:14:11] *** Joins: chris_ (chrido@moz-42731205.eduroam.dynamic.rbg.tum.de)
[14:14:56] <cmr> ideally consumes the AST, keeping only items and dropping all expression.s
[14:21:20] <eddyb> cmr: it's a visitor though, and it doesn't take ownership :/
[14:21:51] * cmr shrugs
[14:22:05] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[14:24:17] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[14:31:51] *** Joins: canhtak (canhtak@moz-7FC55BCE.wl.t.ulaval.ca)
[14:34:05] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:44:37] *** Quits: canhtak (canhtak@moz-7FC55BCE.wl.t.ulaval.ca) (Quit: canhtak)
[14:45:21] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Client exited)
[14:48:43] *** Quits: chris_ (chrido@moz-42731205.eduroam.dynamic.rbg.tum.de) (Ping timeout)
[14:50:53] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[14:51:18] *** Quits: japaric_ (japaric@188A38D3.DC1425E6.84437BC5.IP) (Ping timeout)
[14:51:53] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[14:51:53] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Xr4OYw
[14:51:54] <ghrust> 13rust/06auto 14e6b1cc6 15Joseph Crail: Fix spelling errors in comments.
[14:51:54] <ghrust> 13rust/06auto 14e429b53 15bors: auto merge of #13369 : jbcrail/rust/fix-spelling, r=alexcrichton...
[14:51:54] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[14:51:56] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[14:51:56] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14cf6b52b to 14e415c25: 02http://git.io/N3iJvQ
[14:51:56] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[14:52:57] *** Joins: japaric_ (japaric@268E2D5C.A347E168.F4D5766F.IP)
[14:53:58] *** Joins: canhtak (canhtak@moz-7FC55BCE.wl.t.ulaval.ca)
[14:56:00] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[15:01:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:02:16] * cmr weeps tears as everything is rebuilt when adding a dep to crates.mk
[15:05:32] <eddyb> make check-stage0-syntax
[15:05:37] * eddyb hopes it works
[15:05:59] <eddyb> at least I fixed fourcc and hexfloat
[15:06:55] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[15:08:52] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[15:09:31] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:12:05] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Client exited)
[15:12:59] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[15:16:53] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[15:16:54] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14e429b53 to 14e415c25: 02http://git.io/N3iJvQ
[15:16:54] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[15:16:54] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[15:16:54] <ghrust> [13rust] 15bors pushed 17 new commits to 06auto: 02http://git.io/xBLf8A
[15:16:54] <ghrust> 13rust/06auto 14dc49018 15Jim Radford: sync: remove unsafe and add Send+Share to Deref (enabled by autoderef vtables)
[15:16:54] <ghrust> 13rust/06auto 14bc234ae 15Tobba: Made libflate functions return Options instead of outright failing
[15:16:54] <ghrust> 13rust/06auto 14c83afb9 15Alex Crichton: doc: Document flavorful variations of paths...
[15:16:56] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[15:17:36] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[15:18:18] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[15:18:31] *** vfetwnuncszu is now known as dcrewi
[15:20:14] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[15:22:35] *** Quits: aatch|mobile (aatch@moz-F2813A2B.hfc.comcastbusiness.net) (Ping timeout)
[15:23:18] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[15:23:24] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[15:23:31] *** vfetwnuncszu is now known as dcrewi
[15:24:06] *** Joins: aatch|mobile (aatch@moz-F2813A2B.hfc.comcastbusiness.net)
[15:25:35] *** Joins: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de)
[15:26:00] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[15:29:52] <eddyb> https://github.com/mozilla/rust/pull/13387/files this looks surprisingly easy
[15:30:19] *** Quits: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com) (Client exited)
[15:30:42] * eddyb wonders if &'a |..A| -> R would look better now
[15:30:54] <eddyb> better than |..A|:'a -> R, that is
[15:32:30] <eddyb> test result: ok. 23 passed; 0 failed; 0 ignored; 3 measured
[15:32:32] <eddyb> lovely
[15:37:32] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[15:37:34] <eddyb> cmr: rebased https://github.com/mozilla/rust/pull/13316
[15:37:43] <eddyb> and hopefully fixed everything
[15:40:41] <cmr> eddyb: remind me again why P<T> and not just ~T, given that it's just owned now?
[15:40:58] <eddyb> it doesn't support mutability
[15:41:41] <cmr> well, P<RefCell<T>>
[15:41:53] <eddyb> to move out of P<T> you have to use either and_then or map. map can be optimized to be in-place
[15:42:19] <eddyb> and ~ has the same maintenance issue @ had, in case we want to use an arena. P<T> -> P<'a, T> is lower cost than other combinations
[15:42:27] <cmr> good.
[15:42:33] <cmr> now, add comments explaining all that :p
[15:43:00] <eddyb> oh, right, I didn't add "maintainability" to the benefits
[15:43:17] <eddyb> cmr: thanks, I knew I was missing items :D
[15:50:38] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[15:52:10] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Quit: Leaving.)
[15:53:22] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[15:56:13] <eddyb> whoa whoa. mini heart attack, losing my changes with an accidental Ctrl+W - but chrome remembered them
[16:00:22] <eddyb> cmr: good enough now?
[16:00:43] <cmr> eddyb: when I said comment, I meant comment in the source.
[16:00:51] <eddyb> haha
[16:01:03] <cmr> ideally that entire "Benefits" block would be in the source
[16:01:27] <eddyb> Raison d'existance
[16:01:38] <eddyb> (if my pig french works)
[16:01:42] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[16:02:24] <eddyb> wait, no, "pig latin" is not what I thought it was. ignore that
[16:02:43] <cmr> lol
[16:03:59] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[16:06:12] <eddyb> cmr: I think this is what I was thinking of https://en.wikipedia.org/wiki/Vulgar_Latin
[16:10:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:13:40] *** Quits: japaric_ (japaric@268E2D5C.A347E168.F4D5766F.IP) (Ping timeout)
[16:20:44] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[16:29:01] *** Joins: edwardw (edwardw@6ED525DA.BF27AFA4.B9C6B12A.IP)
[16:30:39] *** Quits: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP) (Quit: )
[16:30:57] *** Quits: rajaram_ (rajaram@5881197.FFE33577.BE90E62C.IP) (Ping timeout)
[16:31:32] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[16:31:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:32:05] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[16:33:09] *** Quits: chris_ (chrido@moz-EFE921CE.informatik.tu-muenchen.de) (Ping timeout)
[16:39:21] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[16:39:47] *** Quits: eddyb (eddy@9C8921DE.97C485DB.D608C900.IP) (Ping timeout)
[16:44:41] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[16:44:53] *** vfetwnuncszu is now known as dcrewi
[16:46:13] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[16:47:36] *** Joins: Rym (y@FD5C494E.63D4476A.51C6DE68.IP)
[16:51:14] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[16:52:19] *** Quits: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu) (Quit: leaving)
[16:52:31] *** Joins: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu)
[16:52:38] *** Quits: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu) (Quit: leaving)
[16:53:36] *** Joins: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu)
[16:55:14] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[16:55:23] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[16:55:23] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/xBLf8A
[16:55:24] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[16:57:33] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[16:57:33] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/V7AesA
[16:57:33] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[16:57:34] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[16:57:34] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/FIM-Og
[16:57:34] <ghrust> 13rust/06auto 149539b95 15Alex Crichton: rustc: Remove absolute rpaths...
[16:57:34] <ghrust> 13rust/06auto 14dfcffca 15bors: auto merge of #13396 : alexcrichton/rust/abs-rpaths, r=sfackler...
[16:57:34] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[17:01:43] *** Quits: edwardw (edwardw@6ED525DA.BF27AFA4.B9C6B12A.IP) (Quit: Leaving...)
[17:01:46] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:02:47] *** Joins: edwardw (edwardw@C3D32C6E.E4C8743.30C05AB6.IP)
[17:07:11] *** Quits: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu) (Input/output error)
[17:12:20] *** Joins: doomlord_ (servitor@moz-56F8DA57.range86-148.btcentralplus.com)
[17:12:58] *** Joins: arrdem (arrdem@moz-2E1DB1F9.ece.utexas.edu)
[17:18:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:20:37] *** Quits: Rym (y@FD5C494E.63D4476A.51C6DE68.IP) (Quit: WeeChat 0.4.3)
[17:21:20] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:21:20] *** ChanServ sets mode: +o pnkfelix
[17:21:45] <herrwolfe45> Raison d'etre?
[17:23:16] <aatch|mobile> "Reason to be" 
[17:27:27] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[17:37:57] <cmr> r? https://github.com/mozilla/rust/pull/13401
[17:38:04] <cmr> aatch|mobile: also what brings you this side of the pacific?
[17:38:08] *** Joins: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com)
[17:39:34] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Quit: leaving)
[17:44:19] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[17:46:28] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[17:46:29] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14dfcffca to 1402f5121: 02http://git.io/N3iJvQ
[17:46:29] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[17:46:30] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[17:46:30] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/z-Jb8A
[17:46:30] <ghrust> 13rust/06auto 147619b78 15Simon Sapin: Update an obsolete comment about conditions
[17:46:30] <ghrust> 13rust/06auto 148bc1a37 15bors: auto merge of #13399 : SimonSapin/rust/patch-8, r=cmr
[17:46:30] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[17:54:25] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:56:56] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:57:30] *** Quits: NiccosSystem (NiccosSyst@moz-ED196BB4.customer.lyse.net) (Quit: Leaving)
[18:07:56] *** Quits: aatch|mobile (aatch@moz-F2813A2B.hfc.comcastbusiness.net) (Ping timeout)
[18:12:46] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[18:18:54] *** Joins: intuxicated (intuxicate@D028818A.A6A1F366.DA0107E2.IP)
[18:23:59] *** Quits: Nekit1234007 (Nekit12340@66BD5FB7.C629D74E.4707F662.IP) (Ping timeout)
[18:26:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:28:12] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:33:20] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[18:33:35] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[18:42:56] *** Joins: Nekit1234007 (Nekit12340@66BD5FB7.C629D74E.4707F662.IP)
[18:43:30] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[18:43:30] *** ChanServ sets mode: +qo brson brson
[18:43:32] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Quit: brson)
[18:43:33] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[18:43:35] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[18:43:35] *** ChanServ sets mode: +qo brson brson
[18:44:43] *** Quits: vhbit (vhbit@8BB49AD.FA5504CB.888F138E.IP) (Quit: My Mac Pro has gone to sleep. ZZZzzzâ€¦)
[18:44:44] *** Joins: japaric (japaric@268E2D5C.A347E168.F4D5766F.IP)
[18:45:53] <brson> libclibc needs a big refactor. they way it's modularized is a nightmare
[18:46:01] <brson> er liblibc
[18:47:23] <Eridius> brson: ideally it would be generated based on the headers of the target architecture
[18:47:55] <Eridius> and would have a single dummy implementation for documentation purposes (which is gonna be problematic for win32 vs everything else, but maybe just modularize those differences)
[18:50:20] <strcat> we need that to support other libcs
[18:50:28] <strcat> it's not realistic to write all of their ABIs in there
[18:50:35] <strcat> especially ones that are unlike glibc and do not provide ABI stability
[18:50:48] <Eridius> and right now it's a royal PITA to add new things to libc because of the need to find the proper values for all supported OS/arch combinations
[18:51:12] <strcat> it's a bigger problem for non-libc libraries though
[18:51:20] <strcat> since libc is usually a stable ABI
[18:51:32] <strcat> libpng/libjpeg/openssl, etc. not so much
[18:51:37] <Eridius> I would love to see some sort of syntax extension that lets you basically interleave C expressions and have all such expressions within a single file be effectively combined into a single compilation unit (e.g. for imports, etc to work)
[18:52:02] <strcat> Eridius: imo libclang should basically be integrated with resolve
[18:52:10] <Eridius> strcat: resolve?
[18:52:23] <strcat> as in name resolution
[18:52:28] <Eridius> oh
[18:52:37] <Eridius> that would be neat. Would that handle macros properly?
[18:52:43] <strcat> it can read a header, turn it into rust crate metadata and then resolve the names
[18:52:54] <strcat> Eridius: well I don't really know how to handle macros properly
[18:53:02] <strcat> it could turn trivial things like #define FOO 1 into a constant
[18:53:15] <Eridius> being able to write arbitrary C code would be useful for doing any sort of glue (e.g. when you need to invoke macro functions, not just read values), but that's orthoogonal to this issue
[18:53:27] <sfackler> you could probably get it to turn C macros into Rust macros
[18:53:34] <Eridius> macros are my biggest worry for any sort of automated work like this (including rust-bindgen)
[18:53:40] <strcat> C macros aren't hygienic though
[18:53:41] <strcat> etc.
[18:53:44] <Eridius> sfackler: doesn't help though, for example all of the libc constants are #defines
[18:53:46] <sfackler> yeah
[18:53:52] <Eridius> I had to manually port Lua macros to Rust for rust-lua
[18:53:55] <strcat> Eridius: well defines to integers are easy
[18:53:59] <strcat> clang will expand the macros for you
[18:54:10] <strcat> then you just output constants based on the type of the literal
[18:54:22] <strcat> ones like jemalloc's MALLOCX_ALIGN are hard
[18:54:33] <Eridius> yeah, #define FOO 1 is easy enough
[18:54:42] *** Joins: aatch|mobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP)
[18:54:48] <strcat> #  if LG_SIZEOF_PTR == 2
[18:54:50] <strcat> #    define MALLOCX_ALIGN(a) (ffs(a)-1)
[18:54:52] <strcat> #  else
[18:54:54] <strcat> #    define MALLOCX_ALIGN(a)      \
[18:54:56] <strcat>   ((a < (size_t)INT_MAX) ? ffs(a)-1 : ffs(a>>32)+31)
[18:54:57] <Eridius> and hopefully #define O_NONBLOCK 04000 would properly recognize that as atomic instead of emitting the token 04000
[18:54:58] <strcat> imo it's not the end of the world if we don't handle that
[18:55:00] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Quit: leaving)
[18:55:09] <strcat> we can handle 99% of cases without handling non-trivial macros
[18:55:12] <Yurume> is the signature-based search in rustdoc desirable?
[18:55:27] <Eridius> strcat: sure, although this gets back to me wanting to be able to run arbitrary C expressions
[18:55:45] <Eridius> strcat: if I can have a C expression that creates a constant integral value from an arbitrary macro, it can then emit the resulting constant value
[18:56:17] <Eridius> though I'm not entirely sure how to actually write that syntactically. Maybe just require that an arbitrary C expression used this way be a compile-time constant value
[18:56:28] <Eridius> cconst!{ O_NONBLOCK }
[18:56:29] *** Quits: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP) (Client exited)
[18:56:53] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[18:58:33] *** Quits: jaras (textual@1CDC5701.A48867D7.52E4E107.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[19:00:04] *** Joins: aatchmobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP)
[19:00:05] *** Quits: aatch|mobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP) (Connection reset by peer)
[19:02:16] <acrichto> rusti: use std::c_str; mod foo { use c_str::CString; }
[19:02:20] -rusti- pastebinned 8 lines of output: http://ix.io/bzo
[19:02:26] <acrichto> rustilite: use std::c_str; mod foo { use c_str::CString; } fn main() {}
[19:02:27] -rustilite- <anon>:1:31: 1:45 warning: unused import, #[warn(unused_imports)] on by default
[19:02:27] -rustilite- <anon>:1 use std::c_str; mod foo { use c_str::CString; } fn main() {}
[19:02:27] -rustilite-                                        ^~~~~~~~~~~~~~
[19:02:31] <acrichto> that's terrifying
[19:02:56] * strcat doesn't find it terrifying
[19:03:05] <pnkfelix> does anybody have an objection if I generalized `rustc --pretty=foo` to respect the `-o` parameter?
[19:04:01] <Eridius> acrichto: that's not terrifying, but it is wacky
[19:04:12] <acrichto> it's blatantly not valid
[19:04:33] <Eridius> acrichto: oh sure, but it's not terrifying, it just suggests that the unused_import lint forgets to do anything if there's no items to process
[19:04:51] <acrichto> no it's chaining through private imports
[19:04:54] <acrichto> the lint is fine
[19:04:55] <Eridius> aand I think I just misread the output
[19:04:58] <Eridius> sigh
[19:05:01] <Eridius> apparently I'm not awake yet
[19:05:12] <Eridius> yep, definitely misread
[19:05:58] <Eridius> btw acrichto, I'm going on my honeymoon in 2 days. So if you want to try to resolve the PRs we've been arguing over lately, that needs to happen today or tomorrow
[19:06:17] <acrichto> ok
[19:06:30] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[19:06:30] <ghrust> [13rust] 15bors 04force-pushed 06auto from 148bc1a37 to 1402f5121: 02http://git.io/N3iJvQ
[19:06:30] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[19:06:32] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[19:06:32] <ghrust> [13rust] 15bors pushed 5 new commits to 06auto: 02http://git.io/gJ-qjQ
[19:06:32] <ghrust> 13rust/06auto 149539b95 15Alex Crichton: rustc: Remove absolute rpaths...
[19:06:32] <ghrust> 13rust/06auto 1483ae17d 15Alex Crichton: rustc: Don't rpath to librustrt.dylib...
[19:06:33] <ghrust> 13rust/06auto 143690dc0 15Alex Crichton: rustc: Add a realpath utility function...
[19:06:35] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[19:07:48] * eddyb tries to figure out what the English form of the congratulatory message is. oh well
[19:07:54] <eddyb> Eridius: congratz :D
[19:08:08] <Eridius> :D
[19:09:36] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[19:13:16] *** Joins: ktt3ja (ktt3ja@moz-8D2A07E1.hsd1.va.comcast.net)
[19:16:09] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[19:16:39] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[19:16:39] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14d149e45 to 1402f5121: 02http://git.io/N3iJvQ
[19:16:39] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[19:16:39] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[19:16:39] <ghrust> [13rust] 15bors pushed 5 new commits to 06auto: 02http://git.io/qecEFA
[19:16:39] <ghrust> 13rust/06auto 149539b95 15Alex Crichton: rustc: Remove absolute rpaths...
[19:16:39] <ghrust> 13rust/06auto 1483ae17d 15Alex Crichton: rustc: Don't rpath to librustrt.dylib...
[19:16:41] <ghrust> 13rust/06auto 143690dc0 15Alex Crichton: rustc: Add a realpath utility function...
[19:16:42] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[19:19:22] *** Quits: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP) (Ping timeout)
[19:23:25] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[19:25:18] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[19:26:30] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[19:26:30] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14277723c to 1402f5121: 02http://git.io/N3iJvQ
[19:26:30] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[19:26:31] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[19:26:31] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/4FAHcQ
[19:26:31] <ghrust> 13rust/06auto 147619b78 15Simon Sapin: Update an obsolete comment about conditions
[19:26:31] <ghrust> 13rust/06auto 14c7c44c5 15bors: auto merge of #13399 : SimonSapin/rust/patch-8, r=cmr
[19:26:31] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[19:26:53] *** Joins: mib_58ntvh (Mibbit@87176A7B.5941EA70.CC1A2609.IP)
[19:29:48] *** Quits: mib_58ntvh (Mibbit@87176A7B.5941EA70.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[19:37:03] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[19:37:21] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:39:37] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[19:40:57] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[19:41:56] * eddyb looks towards cmr's general direction, thinking of graphs
[19:42:26] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[19:42:49] <eddyb> but I just pushed and I have no idea if it compiles
[19:43:40] <cmr> building
[19:45:15] <eddyb> see you all next morning :)
[19:49:37] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[20:08:50] *** Quits: intuxicated (intuxicate@D028818A.A6A1F366.DA0107E2.IP) (Quit: Leaving)
[20:10:36] *** Joins: zwarich (zwarich@A89ECEB1.A86FC3A7.DE9B45B6.IP)
[20:13:52] <eddyb> cmr: nice, I rebased without breaking anything \o/ (me -> bed)
[20:17:34] <jdm> can anybody help me with inscrutable lifetime problems? https://gist.github.com/jdm/10176997
[20:17:39] <jdm> that's a minimal testcase right there
[20:18:03] <cmr> (aren't most lifetime problems inscrutable? otherwise they wouldn't be a problem...)
[20:18:04] *** Quits: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[20:19:02] <eddyb> jdm: new_body: Option<JSRef>  // give that an explicit lifetime and check errors again
[20:19:14] <strcat> cmr: meh
[20:19:16] <eddyb> jdm: 'static works
[20:19:23] <eddyb> (for diagnosis)
[20:19:26] <strcat> it's pretty much always clear to me why the compiler thinks there's a problem
[20:19:33] <strcat> I just don't always agree or know how to express it differently ;p
[20:20:07] <eddyb> jdm: pretty sure it wants inner.root_ref() to live as long as new_body
[20:20:16] <jdm> eddyb: 'static gets rid of some errors, and a generic lifetime doesn't change anything
[20:20:23] * jdm doubts that he wants 'static though
[20:20:32] <eddyb> jdm: I wanted to see errors with it, though
[20:20:36] <cmr> that program shouldn't even make it that far, it should complain about incomplete type Option<JSRef>
[20:20:46] <cmr> (in that, it should never be infering the lifetime of the argument)
[20:20:51] <eddyb> jdm: because it should show up instead of "anonymous lifetime"
[20:20:57] <eddyb> cmr: it's not inferred, it's anon
[20:20:57] <jdm> ah, ok
[20:21:05] <eddyb> cmr: which is perfectly fine
[20:21:14] <jdm> eddyb: https://pastebin.mozilla.org/4778095
[20:21:19] <eddyb> jdm: Option<T> is not covariant wrt T, and I think Eq triggers the error
[20:21:39] <jdm> you are correct that it compiles without the ==
[20:21:43] <eddyb> jdm: try to move the comparison inside the map callback
[20:21:53] <jdm> eddyb: that doesn't mean the same, though :/
[20:22:09] <eddyb> jdm: pattern match?
[20:22:16] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[20:22:33] <jdm> pattern matching did work when tried it before
[20:22:40] <eddyb> jdm: it wants the same lifetime on both sides of the ==
[20:22:44] <jdm> made me throw up a little bit in my mouth, of course
[20:22:49] <eddyb> jdm: hmm, try switching the arguments around
[20:22:57] <eddyb> s/arguments/sides of ==
[20:22:58] <jdm> eddyb: oh, maybe I need to be explicit in the Eq definition
[20:23:07] <eddyb> jdm: what's the definition?
[20:23:11] <jdm> another inferred JSRef
[20:23:19] <eddyb> you can't :(
[20:23:43] <eddyb> jdm: is JSRef<'a> contravariant wrt 'a?
[20:23:55] <cmr> eddyb: you have all the code right in front of you
[20:24:03] <jdm> you'll need to use a smaller word than contravariant
[20:24:03] * eddyb looks again
[20:24:34] <eddyb> why "chain"? we have marker::LifetimeContravariant :P
[20:24:39] <eddyb> (the answer is yes)
[20:24:48] <eddyb> jdm: does it work without Option around the JSRef's?
[20:25:35] <eddyb> replace(&mut bed, replace(&mut me, pnkfelix))
[20:25:45] <eddyb> (as it seems to be a variance issue)
[20:25:50] <cmr> it isn't.
[20:26:24] <eddyb> rusti: fn foo(x: &uint, y: &uint) -> bool {Some(x) == Some(y)}
[20:26:28] -rusti- pastebinned 11 lines of output: http://ix.io/bzv
[20:26:46] <eddyb> cmr: can I go to sleep now?
[20:27:14] <cmr> but it isn't a variance issue, there's nothing one can do to fix this.
[20:27:24] <eddyb> jdm: pretty sure your issue reduces to that tiny test case above
[20:27:30] <jdm> cmr: can you elaborate?
[20:27:41] <eddyb> cmr: should Option<T> not be covariant wrt T?
[20:27:56] <cmr> eddyb: it's about Eq, not Option.
[20:28:00] <cmr> Eq says:
[20:28:01] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[20:28:01] <cmr>     fn eq(&self, other: &Self) -> bool;
[20:28:07] <eddyb> rusti: fn foo(x: &uint, y: &uint) -> bool {(x,) == (y,)}
[20:28:09] -rusti- pastebinned 8 lines of output: http://ix.io/bzw
[20:28:11] <cmr> thus if you have Anything<'a>
[20:28:19] <cmr> and try to compare with Anything<'b>
[20:28:22] <cmr> it will never succeed.
[20:28:56] <eddyb> oooh. but not the obvious reason you are thinking of
[20:29:01] <pnkfelix> looking
[20:29:33] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) {x == y} fn foo(x: &uint, y: &uint) -> bool {eq((x,), (y,))}
[20:29:37] <eddyb> pls work
[20:29:40] -rusti- pastebinned 8 lines of output: http://ix.io/bzy
[20:29:51] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq((x,), (y,))}
[20:29:56] -rusti- pastebinned 7 lines of output: http://ix.io/bzz
[20:30:05] <eddyb> cmr: \o/
[20:30:14] <eddyb> cmr: it's our method lookup
[20:30:17] <eddyb> *our dumb
[20:30:41] <eddyb> it uses the LHS type with no care for coercions or variance
[20:30:53] *** Quits: gimpf (gimpf@moz-5F26EB36.adsl.highway.telekom.at) (Quit: Leaving.)
[20:30:57] <cmr> Yes I know :p
[20:31:03] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq(Some(x), Some(y))}
[20:31:09] -rusti- pastebinned 11 lines of output: http://ix.io/bzA
[20:31:17] <eddyb> cmr: i.e. Eq isn't broken, the way we use it is
[20:31:32] <eddyb> jdm: great, you have not one, but two issues :P
[20:31:36] <jdm> D:
[20:32:01] <eddyb> == method lookup and Option's variance
[20:32:12] <eddyb> (or lack thereof)
[20:32:43] <jdm> so the solution is to pattern match?
[20:32:47] * jdm has a sad
[20:32:52] <cmr> the *workaround* is to pattern match :p
[20:33:11] <eddyb> jdm: the solution is to fix rustc :)
[20:33:16] * flaper87 is back and tries to catch up
[20:33:28] <jdm> do we have an sense of when that fixing might happen?
[20:33:56] <eddyb> jdm: I'm really curious what nmatsakis has done with the place (method lookup). we'll have to see
[20:33:59] <cmr> I don't see a way this could be fixed.
[20:34:07] <eddyb> cmr: the variance issue, or eq?
[20:34:18] <cmr> Option.
[20:34:51] <eddyb> yeah, if you think about &mut Option<T>... it's not safe to have covariance wrt T
[20:34:52] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Quit: leaving)
[20:35:20] * flaper87 had to read eddyb example twice before understanding what he was trying to show
[20:35:26] <flaper87> I know, I'm dumb
[20:35:31] <cmr> it must be invariant with respect to the type.
[20:35:33] <cmr> always.
[20:35:54] <eddyb> cmr: yeah, that sucks
[20:36:14] <eddyb> I was thinking of some rules with &Option<T> and no Unsafe - but it's not easy
[20:36:40] <cmr> eddyb: if you stay awake a few minutes more you'll have P graphs
[20:36:57] <eddyb> I better not be late to work tomorrow :P
[20:37:37] <eddyb> jdm: hmm, I wonder if .map(|x| x) fixes the variance issue
[20:37:57] <jdm> that gives me move errors, I'm pretty sure
[20:38:04] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq(Some(x).map(|x| x), Some(y))}
[20:38:07] -rusti- pastebinned 11 lines of output: http://ix.io/bzD
[20:38:57] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq(Some(x).map(|x| x), Some(y).map(|x| x))}
[20:38:59] -rusti- pastebinned 11 lines of output: http://ix.io/bzE
[20:39:04] <pnkfelix> strcat: what do you think of extending rusti to include the input source code when it posts something to ix.io ?
[20:39:16] <eddyb> meh. I wish the constructors would work
[20:39:41] <eddyb> I guess we are too eager there
[20:39:50] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq(Some(x).map(|x| &*x), Some(y).map(|x| &*x))}
[20:39:53] -rusti- pastebinned 7 lines of output: http://ix.io/bzF
[20:40:05] <eddyb> jdm: ^^ check that out :D
[20:40:10] <strcat> pnkfelix: hm, it could, but I think a nicer pastebin would work better
[20:40:11] <jdm> oh my lord
[20:40:23] <strcat> if rusti was actually on a proper server like I want it to be, it could have a pastebin to itself
[20:40:28] <eddyb> rusti: fn eq<T: Eq>(x: T, y: T) -> bool {x == y} fn foo(x: &uint, y: &uint) -> bool {eq(Some(&*x), Some(&*y))}
[20:40:31] -rusti- pastebinned 7 lines of output: http://ix.io/bzH
[20:40:44] <eddyb> jdm: reborrows force lifetime inference
[20:40:59] <eddyb> jdm: otherwise you get invariant types
[20:41:26] <jdm> oh my lord
[20:42:09] <jdm> yeah, that made it compile
[20:42:14] <jdm>         old_body.as_ref().map(|inner| inner.root_ref()).as_ref().map(|a| &*a) == new_body.as_ref().map(|a| &*a);
[20:42:22] <jdm> I mean, I hate myself a little bit :P
[20:42:36] <eddyb> haha
[20:43:57] <eddyb> lifetimes aren't as important as types are, during the first part of type checking... hmm
[20:44:05] <eddyb> maybe we should use lifetime inference almost everywher
[20:44:08] <eddyb> *everywhere
[20:44:17] *** Joins: ecr (chatzilla@moz-10C88DA7.dyn.cs.washington.edu)
[20:44:21] <eddyb> that would make even Some(x) == Some(y) compile
[20:44:44] <eddyb> rusti: fn _foo(x: &uint, y: &uint) -> bool {Some(&*x) == Some(&*y)}
[20:44:45] -rusti- <anon>:11:9: 11:69 warning: code is never used: `_foo`, #[warn(dead_code)] on by default
[20:44:45] -rusti- <anon>:11         fn _foo(x: &uint, y: &uint) -> bool {Some(&*x) == Some(&*y)}
[20:44:45] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[20:44:45] -rusti- ()
[20:44:56] <cmr> eddyb: http://i.imgur.com/LMPpdBO.png
[20:45:02] <cmr> eddyb: getting a comparison graph...
[20:45:21] <eddyb> it doesn't seem... amazing. yet
[20:47:26] <eddyb> cmr: is that without the --cfg flag?
[20:47:39] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:47:47] <cmr> yes.
[20:47:54] <cmr> still waiting for the other builds
[20:48:13] <eddyb> things like cfg stripping should benefit from allocation space reuse
[20:48:49] <cmr> that's going to be another ~20 minutes
[20:48:55] <cmr> so you should sleep if you need to.
[20:49:20] <eddyb> okay, good night (or... day)
[20:49:36] *** Quits: edwardw (edwardw@C3D32C6E.E4C8743.30C05AB6.IP) (Quit: Leaving...)
[20:49:51] <eddyb> jdm: thanks for showing us your issue, I now have an idea on how to fix it :D
[20:49:59] <jdm> cool :)
[20:50:59] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:51:39] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[20:55:52] *** Quits: aatchmobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP) (Connection reset by peer)
[20:55:53] *** Joins: aatchmobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP)
[20:59:20] <pnkfelix> wow, hit an ICE "just" trying to pretty-print src/librustc/lib.rs
[20:59:31] <larsberg> welp, that mail explains why I couldn't vidyo into the rust room for the meeting!
[20:59:38] <ecr> gah. why do you do this to me PLT Redex
[21:00:20] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[21:00:24] <larsberg> ecr: bug robby findler or his group? I think he currently has two grad students and an undergrad hacking on redex stuff right now at nwu :-)
[21:01:40] <nrc> ecr: use latex instead :-)
[21:01:41] <huon> pnkfelix: I think #[deriving(Encodable)] possibly makes it sad
[21:02:32] <ecr> larsberg: that's probably overkill. I'm using a match in a judgment to do key lookup in a map. Have two maps with different types, so I have two judgments. One judgment works fine. The other won't match anything. It's messing with my head
[21:02:45] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[21:04:07] <larsberg> ecr: OK, well don't be shy :-) When I last talked with him, they were looking for more examples to use some new automatic testing techniques on, so it would probably be a reasonable trade! Sorry I can't help - I roomed with in grad school someone who worked on redex (casey klein), but never got deep into it
[21:04:16] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[21:05:07] <ecr> larsberg: I might ping them after all. Either I'm missing something obvious or it's a bug.
[21:06:46] <huon> larsberg: I take it that vidyo is down?
[21:06:49] <larsberg> ecr: cool, let me know if you want an introduction, though they're pretty approachable!
[21:06:53] <ecr> nevermind. it was obvious >.<
[21:07:10] <ecr> I copy pasted a test and forgot to change the nonterminal for the judgment output
[21:07:16] <larsberg> huon: yes, there's a security issue with vidyo. we're chatting on #research about alternatives... maybe a google hangout
[21:07:27] <ecr> larsberg: I'll keep that in mind :)
[21:07:44] <larsberg> ecr: maybe I'll point them at you instead the next time I run into Robby :-)
[21:07:54] <huon> larsberg: thanks
[21:08:04] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[21:08:04] *** ChanServ sets mode: +o pnkfelix
[21:14:26] <nrc> thanks again cmr! One day that PR will actually land, I have faith
[21:14:45] <cmr> Don't worry, you still have a better track record than acrichto 
[21:15:44] <huon> do we have a leader board for "most bounces" (and "most consecutive PRs without bouncing")? :P
[21:16:13] <brson> that would be cool
[21:16:24] <cmr> brson: I'd appreciate it if you looked over https://etherpad.mozilla.org/VDM304DpBn
[21:16:35] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[21:16:35] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14c7c44c5 to 1402f5121: 02http://git.io/N3iJvQ
[21:16:35] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[21:16:35] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[21:16:35] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/28vbQQ
[21:16:35] <ghrust> 13rust/06auto 145bb97bd 15Nick Cameron: Allow inheritance between structs....
[21:16:35] <ghrust> 13rust/06auto 14a0bd277 15bors: auto merge of #12562 : nick29581/rust/fields, r=nikomatsakis...
[21:16:36] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[21:16:49] <brson> cmr: nice!
[21:16:58] <cmr> (also, https://twistedmatrix.com/highscores)
[21:16:58] <brson> this replaces the one in-tree?
[21:17:08] <brson> and incorporates the stuff from that big issue?
[21:17:27] <cmr> brson: I've purposefully exlcuded many things from the big issue.
[21:17:36] <cmr> I created this pad to serve as an actual FAQ of things from #rust
[21:17:47] <cmr> essentially, questions I'm tired of answering :p
[21:17:55] <brson> ok
[21:18:16] <brson> what's https://twistedmatrix.com/highscores? even though it tries, it's not very self-explainy
[21:19:16] <cmr> some silly thing the twisted project set up, for some purpose unknown to me.
[21:19:20] <cmr> but it looks cool.
[21:20:49] <SimonSapin> #13399 https://twitter.com/servomemes/status/438495326258077696
[21:21:50] <flaper87> lol
[21:23:23] <larsberg> the best thing is that the "@bors: retry" comments are a wonderful long-lived mark of shame for those retries
[21:24:17] *** Joins: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com)
[21:28:56] *** Joins: Nekit1234007_ (Nekit12340@2C52E860.2FD3B5C9.4707F662.IP)
[21:29:07] <pnkfelix> huon: i think you may be right about `#[deriving(Encodable)]`.  how did you guess that?
[21:29:36] *** Quits: Nekit1234007 (Nekit12340@66BD5FB7.C629D74E.4707F662.IP) (Ping timeout)
[21:29:57] * huon is wearing his wizard hat
[21:30:17] <huon> pnkfelix: I remembered https://github.com/mozilla/rust/issues/12685
[21:34:10] <brson> cmr: i left some comments after 'brson:' tags, and also just tweaked some of the prose
[21:34:26] <cmr> I watched
[21:34:29] <cmr> (<3 etherpad)
[21:35:17] <cmr> brson: I'm inclined to remove the sections on exceptions and int/uint
[21:35:39] <cmr> because they are pretty unclear.
[21:35:50] <cmr> and our story is still changing there.
[21:37:41] <brson> cmr: though difficult, they are also important topics with legit FAQs
[21:37:48] <brson> would be nice to have strong answers
[21:38:09] <cmr> yes, and I think we'll need that
[21:38:18] <cmr> btw I'm very strongly against stack overflow failing.
[21:38:26] <brson> ok
[21:39:13] <cmr> there's no possible way to implement it without the current stack check prelude plus enough of a "red zone" for destructors to run in the little stack space that is left.
[21:39:33] <cmr> no nice way, that is
[21:44:09] <strcat> cmr: you also have to change LLvm
[21:44:19] <strcat> it doesn't view unwinding from *anywhere* as possible
[21:44:32] <strcat> have to get rid of nounwind completely
[21:44:32] <cmr> it's not "anywhere"
[21:44:35] <cmr> it's just function boundaries.
[21:45:11] <strcat> depends on how it's done
[21:45:24] <strcat> and even at function boundaries is enough to be UB in LLVM's model of code
[21:45:40] <strcat> __morestack isn't allowed to throw, it has to succeed in whatever it does (getting more stack) or die
[21:46:11] <jdm> /home/jdm/sdb/servo/src/components/script/dom/htmlimageelement.rs:153:67: 153:80 error: cannot borrow immutable dereference of `&`-pointer `*abstract_self` as mutable
[21:46:14] <jdm> /home/jdm/sdb/servo/src/components/script/dom/htmlimageelement.rs:153         let elem: &mut JSRef<Element> = ElementCast::from_mut_ref(abstract_self); ^~~~~~~~~~~~~
[21:46:17] <jdm> I don't understand this error
[21:46:32] <jdm> I'm not dereferencing abstract_self
[21:46:38] <huon> jdm: what type is abstract_self?
[21:46:42] *** Quits: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com) (Input/output error)
[21:46:47] <jdm> &mut JSRef<...>
[21:46:57] <jdm> oh
[21:46:57] <jdm> durr
[21:46:59] <jdm> it's &JSRef
[21:47:05] <jdm> rustc, you're letting me down
[21:47:22] <huon> rusti: fn foo(x: &mut int) {} foo(&1)
[21:47:22] -rusti- <anon>:11:36: 11:38 error: cannot borrow immutable dereference of `&`-pointer as mutable
[21:47:22] -rusti- <anon>:11         fn foo(x: &mut int) {} foo(&1)
[21:47:23] -rusti-                                              ^~
[21:47:23] -rusti- error: aborting due to previous error
[21:47:23] -rusti- playpen: application terminated with error code 101
[21:47:24] <jdm> that feels like it should be a type error, not one that shows up during the lifetime phase
[21:47:35] <cmr> jdm: same thing, really.
[21:48:13] <jdm> cmr: the different phases give me hints as to where to look to resolve errors
[21:48:27] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:48:36] <cmr> borrow checking is part of the type system.
[21:48:55] <cmr> is what I mean
[21:49:31] <pnkfelix> cmr: but there are certainly phases, and its easy to observe them during interactively attempting to placate rustc
[21:49:42] <pnkfelix> cmr: that's what I *think* jdm is noting...
[21:49:45] <jdm> it just seems unintuitive that we can't show that &mut is required and we have a & type instead
[21:49:55] <jdm> rather than attempting to borrow & to &mut
[21:50:06] <jdm> pnkfelix: right
[21:50:08] <pnkfelix> is this a case where it is attempting to auto-insert an auto-borrow ?
[21:50:36] <pnkfelix> and that's why it is thus delaying the failure until borrowcke?
[21:50:51] <jdm> sounds plausible
[21:50:58] <pnkfelix> Maybe we could be smarter about where/how we auto-borrow. Not sure, i don't know that code yet.
[21:51:08] <pnkfelix> okay bed time for bonzo
[21:51:10] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:53:29] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.3.1)
[21:54:47] *** Quits: victorporof (victorporo@moz-1C281963.dsl.bell.ca) (Quit: victorporof)
[21:56:21] *** Joins: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com)
[21:58:05] <brson> acrichto: did you fill in the names of all the slaves manually??
[21:58:19] <brson> really wish buildbot would do that itself
[21:58:20] *** Quits: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com) (Client exited)
[21:58:56] <acrichto> brson: I only did so in a local .ssh/config
[21:59:01] <acrichto> is it filled out somewhere else?
[21:59:04] <acrichto> oh wait those
[21:59:05] <acrichto> yes
[21:59:08] <acrichto> do they not persist?
[21:59:29] <acrichto> I found it helpful when I was organizing some things this morning
[22:00:45] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:02:16] *** Quits: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP) (Client exited)
[22:03:39] <brson> acrichto: nope, they'll all be deleted
[22:05:28] <acrichto> aww
[22:05:30] <acrichto> oh well
[22:06:32] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[22:06:32] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14a0bd277 to 1402f5121: 02http://git.io/N3iJvQ
[22:06:32] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[22:06:32] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[22:06:32] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/XmavNQ
[22:06:32] <ghrust> 13rust/06auto 147619b78 15Simon Sapin: Update an obsolete comment about conditions
[22:06:32] <ghrust> 13rust/06auto 148801d89 15bors: auto merge of #13399 : SimonSapin/rust/patch-8, r=cmr
[22:06:33] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[22:07:31] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[22:08:00] *** Joins: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com)
[22:13:31] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[22:14:25] <nrc> why does typeck/check/_match.rs have the underscore in it?
[22:14:38] <nrc> because match is a keyword
[22:14:52] <nrc> but don't we usually prefer mtch or something?
[22:15:10] <huon> yeah, writing `mod match;` wouldn't work
[22:15:32] <Eridius> huon: #[path="match.rs"] mod _match; would
[22:15:36] <Eridius> although I don't know if there's any real reason to do that
[22:15:46] <Eridius> aside from `ls` listing _match.rs in an unexpected location
[22:16:08] <Eridius> huon: also isn't the standard convention to suffix the _ instead of prefix it, when trying to avoid keywords? match_ would make more sense to me
[22:16:46] <brson> there's no consensus here. postfix underscore is more common. pcwalton *hates* post-underscores though
[22:17:32] <huon> Eridius: I have no opinion either way, I was just pointing out the problem with `match.rs` (yes the #[path] works, but then the file name and module name don't match)
[22:17:32] *** Quits: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP) (Client exited)
[22:18:19] *** kimundi is now known as zz_kimundi
[22:18:25] <Eridius> brson: oh? huh
[22:18:54] <Eridius> brson: I tend to think of underscore prefix as meaning "private", whereas I have conceal turned on in vim so underscore suffix gets rendered as ` (when not editing that line), which makes a lot more sense
[22:19:07] *** Quits: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[22:19:10] <steveklabnik> i also hate postfix underscores
[22:19:18] <Eridius> steveklabnik: and you like prefix underscores?
[22:19:28] <huon> 'm_atch', best of both worlds
[22:19:30] <steveklabnik> i like them better, but i generally dislike them too
[22:19:47] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[22:19:50] <brson> Eridius: yeah, I think of foo_ as foo'
[22:19:51] *** Joins: sunfish (chatzilla@moz-62518563.mtv2.mozilla.com)
[22:20:10] <lkuper> it's inconsistent -- there's also middle::trans::type_
[22:21:41] <mcpherrin> underscores are ugly, should include a leading space
[22:21:50] <mcpherrin> " match.rs"
[22:22:14] <Eridius> mmmmatch.rs
[22:22:51] <nrc> I don't mind postfix underscores - prefix looks like an unused variable so my first assumption was that _match.rs was a file which was not used
[22:22:52] <mcpherrin> We'd do Match.rs at my employer
[22:22:58] <flaper87> Eridius: why not matchhhhh.rs ?
[22:23:41] <flaper87> nrc: I thought that too when I first looked at it
[22:25:08] *** Joins: ecr_ (chatzilla@moz-67D6C824.dhcp4.washington.edu)
[22:25:40] <Eridius> How about â„‡match
[22:25:45] <Eridius> (that's EULER CONSTANT)
[22:25:46] *** Quits: ecr (chatzilla@moz-10C88DA7.dyn.cs.washington.edu) (Ping timeout)
[22:25:55] *** ecr_ is now known as ecr
[22:27:12] <Eridius> ooh Âµ is XID_Start.
[22:27:18] <Eridius> rusti: let Âµs = 30; Âµs
[22:27:22] -rusti- pastebinned 14 lines of output: http://ix.io/bA2
[22:27:27] <Eridius> dammit!
[22:27:31] <Eridius> I thought we used XID_Start
[22:27:36] <Eridius> why is it feature-gated?
[22:27:36] <huon> look at those nice spans though
[22:27:42] <Eridius> oooh you're right
[22:27:44] <huon> <3 nrc for fixing it properly
[22:27:56] <huon> Eridius: the spans were utterly broken previously
[22:28:02] <Eridius> how do the spans determine the width of non-ASCII codepoints?
[22:28:03] <huon> the compiler ICE'd occasionally
[22:28:04] <Eridius> yeah I'm aware
[22:28:10] <Eridius> oh I didn't realize it ICE'd, but I've seen the broken spans
[22:28:11] <huon> and we should be normalising
[22:28:45] <Eridius> ok yeah, normalizing seems reasonable, either NFC or NFD (I don't think it matters which) should work
[22:28:48] <huon> (the ICE was if it was trying to display an error message that happened to put the incorrectly computed byte positions into the middle of a multibyte character)
[22:29:00] <mcpherrin> that suggestion should probably say #![feature(non_ascii_idents)]
[22:29:10] <huon> the width is just done by counting codepoints
[22:29:10] <Eridius> possibly NFC though to make it simpler, so Ã© is a single char as XID_Start
[22:29:13] <huon> i.e. it's incorrect
[22:29:22] <Eridius> codepoints? ugh
[22:29:27] <huon> https://github.com/mozilla/rust/issues/2253
[22:29:31] <Eridius> rusti: let Ã©s = 30; Ã©s
[22:29:34] <huon> we don't have anything better, yet ;P
[22:29:34] -rusti- pastebinned 14 lines of output: http://ix.io/bA3
[22:29:41] <Eridius> hrm, that should have been decomposed. 
[22:30:07] *** Joins: zeuxcg (zeuxcg@1828591B.F9F834F5.C943C01E.IP)
[22:30:10] <Eridius> hrm that issue says NFKC. Do we really want the compatibility normalization?
[22:30:18] <huon> no idea
[22:31:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (No route to host)
[22:33:25] <Eridius> ok here's a good example. ï¬ is the LATIN SMALL LIGATURE FI. NFD and NFC keep it as that. NFKD and NFKC turn that into "fi"
[22:33:39] <Eridius> so do we want ï¬ll and fill to be distinct or not?
[22:33:59] * Eridius reads UAX #31
[22:34:13] <mcpherrin> why is a ligature in unicode :S
[22:34:27] <mcpherrin> Shouldn't that be something the text renderer does?
[22:34:45] <Eridius> I don't know. This ligature comes from Unicode 1.1
[22:35:23] <huon> rusti: let ï¬;
[22:35:26] -rusti- pastebinned 8 lines of output: http://ix.io/bA6
[22:35:36] <huon> it's XID_start, at least.
[22:35:39] <Eridius> yeah
[22:36:06] <Eridius> I would expect anything whose decomposed form starts with XID_Start to be XID_Start
[22:36:33] <Eridius> one problem with decomposed is e.g. ACUTE ACCENT is not XID_Start or XID_Continue, but when combined with, say, "e", the result "Ã©" is both
[22:36:47] <Eridius> which is why I suspect it will be easier if we normalize to NFC or NFKC
[22:36:49] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:36:49] <strcat> hm
[22:37:02] * strcat is unsure how to add a feature gate for a new float/integer type
[22:37:23] <huon> strcat: default_type_param_usage does something you could copy
[22:37:32] <huon> (register a flag that is checked later in compilation)
[22:37:43] <Eridius> and I know there are exceptions to composition (e.g. characters that decompose into a sequence, but will never be produced by composing any sequence), but I am hoping that either these exception characters aren't XID_{Start,Continue}, or the entire decomposed sequence is
[22:38:13] <Eridius> mcpherrin: Unicode's FAQ says the existing ligatures exist for compatibility and round-tripping with non-unicode character sets, but their use is discouraged
[22:38:21] <Eridius> and Unicode will never add any new ligatures
[22:38:45] <huon> rusti: let tÍ—ÍªÍ†Í£Ì½Í£Í—Í¢Ì¦ÌžÌ£Ì¼Í–Í•Ì—eÌ€Ì‡Ì”Ì‘ÌƒÌ½Ì¢Ì¦sÍ¨ÍÌ²Ì–Ì¦tÌŠÍ‹ÌŽÌ”Í‹Ì¾Í¯ÍÌ«;
[22:38:48] -rusti- pastebinned 8 lines of output: http://ix.io/bA7
[22:38:53] <Eridius> hahaha
[22:39:07] <Eridius> huon: you should add a test case for that!
[22:39:16] <huon> https://github.com/mozilla/rust/issues/8706
[22:39:22] <Eridius> hehe
[22:40:34] *** Joins: zucchini (Mibbit@87176A7B.5941EA70.CC1A2609.IP)
[22:40:52] <strcat> huon: hm
[22:41:14] <strcat> it's alright to ignore ligatures isn't it? it's monospace fonts
[22:41:25] <strcat> just need to check the width 
[22:41:29] <strcat> 0 1 or 2
[22:41:39] <huon> yeah, I guess so
[22:42:20] <Eridius> that seems potentially reasonable to me, although I believe that e.g. Thai may actually have characters that combine with the next character instead of the preceding one. Though I may be misremembering
[22:42:42] <huon> we just need the width tables then (assuming that codepoint width is a property of an individual codepoint, and surrounding ones can't change it)
[22:42:42] <Eridius> I don't know if that actually really matters for anything
[22:43:01] <cmr> this is why I hate strings.
[22:43:20] <Eridius> incidentally, mosh won't display some unicode characters because it can't figure out their width :/
[22:43:23] <nrc> Eridius:  if you can imagine it, unicode does it. I think Tamil is the most complex in terms of combining
[22:43:36] <Eridius> I don't know if it's because it has a baked-in table that's out of date, or if it's relying on an OS-provided function that's out of date
[22:43:48] * huon imagines dragons flying through air
[22:43:53] <Eridius> although I think it's actually most likely relying on an OS function on the remote side, which is out of date, even though my local side knows how to display it
[22:45:02] <Eridius> hrm, argument in favor of NFKC (as oppose to NFC): fullwidth vs halfwidth characters
[22:45:07] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:45:10] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:45:10] *** ChanServ sets mode: +o tjc
[22:46:50] <Eridius> oh hey, I actually read something wrong. U+0301 COMBINING ACUTE ACCENT does in fact have XID_Continue. it turns out I was looking at U+00B4 ACUTE ACCENT, which doesn't
[22:46:51] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[22:47:12] <Eridius> which suggests that for any XID_Start that decomposes into something else, the combining characters will have XID_Continue
[22:47:38] <Eridius> looks like XID_Continue includes "spacing combining marks (Mc)". Not certain how that's defined, but it is suggestive
[22:48:48] <strcat> huon: still not really sure where I'd gate it ;s
[22:49:16] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[22:49:29] <huon> strcat: lint?
[22:49:46] <huon> strcat: or just typechecking, whenever you come across an f128?
[22:50:00] <strcat> as in I should do a lint instead of a feature gate? that would work...
[22:50:06] * strcat shrugs
[22:50:19] <strcat> well it'd still be controlled by the feature gate I guess
[22:51:40] *** Quits: aatchmobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP) (Connection reset by peer)
[22:51:44] *** Joins: aatchmobile (aatch@8ECC4BFC.EC83738C.D8D85ABD.IP)
[22:52:02] <flaper87> nrc: ping
[22:52:17] <nrc> flaper87: hi
[22:52:21] <Eridius> oh that's interesting. Any string which is an identifier (XID_Start XID_Continue*) is also an identifier under all 4 normalization forms. But the reverse isn't necessarily true
[22:52:36] <Eridius> there are strings that are identifiers under the various normalization forms that aren't an identifier when not normalized
[22:52:46] <flaper87> nrc: hey, I'm reviewing your DST patch and I was wondering why this: https://github.com/mozilla/rust/pull/13398/files#diff-31c6a728eb925b9f6b0124e93948d270R3502
[22:52:57] <flaper87> it's not obvious to me
[22:53:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:53:13] <nrc> It is to support smart pointers
[22:53:20] <Eridius> sorry, the untrue bit only applies to compatibility normalization. NFC/NFD do preserve the attribute in both directions
[22:53:33] *** Quits: zucchini (Mibbit@87176A7B.5941EA70.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:53:39] <nrc> it is safe to allow as long as the struct becomes unsized since we don't need to align anything after it
[22:53:42] <nrc> flaper87: ^
[22:54:31] <flaper87> nrc: oh, ok! got it
[22:54:34] <flaper87> thanks 
[22:56:04] <nrc> np, thanks for reviewing the patch
[22:57:50] <strcat> huon: lol, should I feature gate it in trans? :s
[22:58:01] * strcat can't find a good spot that will catch all of them
[22:58:12] <Eridius> rusti: let eÌ;
[22:58:15] -rusti- pastebinned 8 lines of output: http://ix.io/bAd
[22:58:22] <Eridius> ok that one was decomposed. yay.
[22:58:37] <huon> strcat: type checking doesn't catch them?
[22:58:43] <Eridius> let ï¼¡;
[22:58:47] <Eridius> rusti: let A;
[22:58:48] -rusti- <anon>:11:13: 11:14 error: cannot determine a type for this local variable: unconstrained type
[22:58:48] <Eridius> ack
[22:58:48] -rusti- <anon>:11         let A;
[22:58:49] -rusti-                       ^
[22:58:49] -rusti- error: aborting due to previous error
[22:58:49] -rusti- playpen: application terminated with error code 101
[22:58:50] <Eridius> rusti: let ï¼¡;
[22:58:53] -rusti- pastebinned 8 lines of output: http://ix.io/bAe
[22:59:04] <Eridius> ok awesome, it definitely doesn't know widths
[22:59:32] <Eridius> I take it the fix, then was to map spans to codepoint lengths instead of byte lengths?
[23:00:05] <huon> not really
[23:00:26] <Eridius> no? the spans used to be wacky for any non-ASCII. Now it seems it's only wacky when there are codepoints with a width != 1
[23:00:30] <huon> it was mainly just getting it to record multibyte characters correctly
[23:00:48] <Eridius> is span printing the only reason for the non-ascii identifier feature gate? Or are there other issues too?
[23:01:12] <huon> normalization
[23:01:19] <Eridius> oh right, you said that
[23:03:11] *** Joins: victorporof (victorporo@moz-1C281963.dsl.bell.ca)
[23:03:31] <huon> Eridius: ( https://github.com/mozilla/rust/commit/8812e8ad4957e3e201dabb62c6c3a8e0b10333a7#diff-c5bde8c46eebaa8f5890c6f3700793b3R463 is the thing that fixed the spans)
[23:04:33] <Eridius> I see
[23:04:48] <huon> (in light of that, s/record/consider/)
[23:10:46] <acrichto> brson: do you think we'll drop mingw32 support when moving to mingw64?
[23:10:59] <brson> acrichto: i do
[23:11:22] <Eridius> hrm, XID_Start and XID_Continue tables, expressed as a densely-packed array of ranges, would take almost 12kB of memory
[23:11:37] <Eridius> (as of the latest Unicode standard)
[23:11:57] <nrc> why does the local decl in `fn f<X>(x1: ~X) { let y = *x1; }` get inferred a fresh type var, rather tan using `X`?
[23:12:11] <strcat> huon: on the positive side it works without any effort
[23:12:16] <strcat> just need to link to libquadmath
[23:12:25] <strcat> maybe I should just find a permissively licensed lib instead of feature gating ;s
[23:12:31] <huon> \o/
[23:12:41] <strcat> compiler-rt has some
[23:12:43] <strcat> but it's missing a lot
[23:12:44] <huon> i128, u128 and f128?
[23:12:47] <Eridius> nrc: I would assume that the type of y depends on whether y is used in a context that would invoke autoderef
[23:12:52] <strcat> huon: no just f128
[23:12:57] <vadimcn> Does rustc currently have an option to disable segmented stacks prologue generation?
[23:12:57] <huon> strcat: oh, ok
[23:13:04] <strcat> i128 on 32-bit is probably quite rarely supported afaik
[23:13:10] <Eridius> but I guess I don't know that for a fact
[23:13:13] <strcat> would need a lot of compiler-rt work
[23:15:25] <brson> vadimcn: i don't think so; we probably should, though we've rejected such patches in the past
[23:16:14] <vadimcn> brson: I want to disable it for some experimentation.   Any idea where does it get set in rustc? 
[23:16:40] <acrichto> vadimcn: https://github.com/mozilla/rust/blob/master/src/librustc/back/link.rs#L176
[23:17:57] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:19:29] <brson> acrichto: we could have multiply-toolchained windows bots if we desire
[23:19:45] <brson> seems like mingw-w64 is winning though
[23:20:16] <acrichto> I'm fine with that
[23:20:23] <acrichto> sounds reasonable to me (dropping mingw32
[23:20:24] <acrichto> )
[23:20:29] *** Joins: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net)
[23:20:38] <acrichto> I don't think anyone's ever been happy that we support mingw32 and nothing else
[23:20:50] <acrichto> or rather that we support specifically mingw32
[23:21:44] <strcat> mingw32 is really broken so it's annoying to support
[23:21:55] <strcat> with mingw64 we can un-xfail a lot of tests
[23:21:58] <acrichto> zomg something passed bors!
[23:22:07] <strcat> floating point works properly, #[thread_local] works properly
[23:22:09] <acrichto> we now have a corrected comment
[23:22:17] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Ping timeout)
[23:23:29] <strcat> huon: hm, I screwed up a span
[23:23:32] <strcat> ;\
[23:23:36] <strcat> because f128 is 3 chars
[23:23:40] <strcat> (the 128)
[23:23:42] * strcat sighs
[23:23:59] <strcat> of all things
[23:24:24] <strcat> I really hate this parser code, so much state
[23:25:22] <huon> this is spurious, right? http://buildbot.rust-lang.org/builders/auto-win-32-nopt-t/builds/4341/steps/test/logs/stdio
[23:25:22] *** Quits: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com) (Quit: Leaving.)
[23:25:37] <strcat> acrichto: btw we actually *have* to use jemalloc again if we want to support alignment well
[23:25:57] <acrichto> I'd believe that, I think we definitely should use jemalloc again
[23:26:01] <Eridius> rustilite: #![crate_id="fÃ³Ã³"] fn main() {}
[23:26:04] <acrichto> we just shouldn't override malloc/free symbols
[23:26:11] <acrichto> huon: yes
[23:26:19] <huon> acrichto: thanks
[23:26:25] <acrichto> huon: oh sorry, I thought I got all those
[23:26:31] <strcat> acrichto: https://github.com/rust-lang/rfcs/pull/39/files#diff-87f88279549d2ef86add46366b9fd4c1R100
[23:26:33] <Eridius> rustilite: #![crate_id="fÃ³Ã³"] fn main() { println!("success"); }
[23:26:34] -rustilite- success
[23:26:37] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[23:26:37] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/XmavNQ
[23:26:37] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[23:27:13] <strcat> acrichto: although there are some things about jemalloc I want to improve ;p
[23:27:19] <strcat> maybe I'll submit a little patch or two
[23:27:32] * strcat wants to be able to skip the rbtree lookup for the span
[23:27:48] <strcat> O(1) free! (well, sort of)
[23:28:42] *** Quits: fhahn (fhahn@moz-7924DB5C.vie.surfer.at) (Ping timeout)
[23:29:06] <strcat> oh good luckily there's nextnextch already
[23:29:11] <strcat> I wish we used a parser generator
[23:30:00] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:30:07] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[23:31:41] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[23:31:41] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/eZT2xA
[23:31:41] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[23:33:32] *** Joins: radford (Adium@moz-9E6BD4E4.static.mtpk.ca.charter.com)
[23:33:51] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[23:34:16] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[23:35:45] <huon> acrichto: np, I got in the next slot anyway :)
[23:35:53] <huon> oh, erm
[23:35:55] * huon rebases
[23:36:00] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[23:36:35] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[23:36:35] <ghrust> [13rust] 15bors pushed 5 new commits to 06auto: 02http://git.io/4WCJ_g
[23:36:35] <ghrust> 13rust/06auto 149539b95 15Alex Crichton: rustc: Remove absolute rpaths...
[23:36:35] <ghrust> 13rust/06auto 1483ae17d 15Alex Crichton: rustc: Don't rpath to librustrt.dylib...
[23:36:36] <ghrust> 13rust/06auto 143690dc0 15Alex Crichton: rustc: Add a realpath utility function...
[23:36:38] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[23:36:40] <acrichto> :(
[23:37:52] <strcat> uh
[23:38:04] <strcat> I didn't realize LLVM could lower most of this stuff itself
[23:38:34] <strcat> http://sprunge.us/FfIf compiles fine
[23:38:41] <strcat> without libquadmath
[23:39:03] <huon> what's the output look like?
[23:39:27] <strcat> acrichto: when was our compiler-rt last updated?
[23:39:56] <strcat> callq__addtf3@PLT
[23:39:58] <strcat> ah nvm
[23:40:13] <huon> oh, huh, walk_dir is really slow. it calls .shift() on a vector for each call
[23:40:25] <strcat> not sure where addtf3 comes from
[23:40:32] <strcat> https://github.com/llvm-mirror/compiler-rt/tree/master/lib/builtins
[23:41:09] <strcat> ah
[23:41:11] <strcat> libgcc
[23:42:11] <strcat> at least compiler-rt from trunk can do the comparisons itself...
[23:42:36] *** Joins: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net)
[23:42:42] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[23:43:27] *** flaper87 is now known as flaper87|afk
[23:46:42] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[23:46:42] *** ChanServ sets mode: +o tjc
[23:47:44] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:47:56] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[23:48:53] <huon> ( https://github.com/mozilla/rust/issues/13411 fwiw)
[23:49:39] * strcat wonders if feature gating only the non-portable operators on it makes sense...
[23:49:46] <strcat> but it will be pretty useless atm
[23:52:56] <huon> bjz: nice picture
[23:54:15] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[23:54:15] *** ChanServ sets mode: +o tjc
[23:54:20] <bjz> huon: ^_^
[23:56:04] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:57:25] <nrc> flaper87|afk: ping?
[23:57:43] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[23:57:43] *** ChanServ sets mode: +o tjc
[23:58:59] <nrc> nmatsakis: ping
[23:59:48] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Ping timeout)
